<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance</title>
<!--Generated on Fri Jul 12 23:43:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="IP identifiers,  side channels,  comparative analysis,  probability theory" lang="en" name="keywords"/>
<base href="/html/2406.06483v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S1" title="In A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2" title="In A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS1" title="In 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>IP Packet Fragmentation and Reassembly</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS2" title="In 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>IPID Selection Methods</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS2.SSS1" title="In 2.2. IPID Selection Methods ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Counter-Based Selection Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS2.SSS2" title="In 2.2. IPID Selection Methods ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>PRNG-Based Selection Methods</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3" title="In 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Current Implementations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3.SSS0.Px1" title="In 2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Windows</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3.SSS0.Px2" title="In 2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Linux</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3.SSS0.Px3" title="In 2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">OpenBSD</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3.SSS0.Px4" title="In 2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">FreeBSD</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3.SSS0.Px5" title="In 2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">macOS/XNU</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3" title="In A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Measurements and Attacks</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1" title="In 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Probe Comparisons</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS1" title="In 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Idle Scans</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS2" title="In 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Triangular Spamming</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS3" title="In 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.3 </span>On-Path NAT Measurements</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS4" title="In 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.4 </span>Canary Fragments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS5" title="In 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.5 </span>Bucket Leaks</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS5.Px1" title="In 3.1.5. Bucket Leaks ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Non-Idle Port Scans</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS5.Px2" title="In 3.1.5. Bucket Leaks ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Hybrid Leaks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS5.Px3" title="In 3.1.5. Bucket Leaks ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Device Fingerprinting</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS6" title="In 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.6 </span>TCP Injection Attacks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS7" title="In 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.7 </span>Covert Channels</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2" title="In 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Fragment Injections</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2.SSS1" title="In 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>DNS Attacks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2.SSS2" title="In 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>NAT Packet Interception</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2.SSS3" title="In 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Shifting NTP Time</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4" title="In A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Comparative Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS1" title="In 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Mathematical Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS2" title="In 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Analyzing Correctness</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS3" title="In 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Analyzing Security</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS4" title="In 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Analyzing Performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5" title="In A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Recommendations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S6" title="In A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1" title="In A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Analytical Derivations</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1" title="In Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Correctness Derivations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS1" title="In A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.1 </span>Globally Incrementing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS2" title="In A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.2 </span>Per-Connection and Per-Destination</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS3" title="In A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.3 </span>Per-Bucket (Linux)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS4" title="In A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.4 </span>PRNG (searchable queue of size <math alttext="k" class="ltx_Math" display="inline"><semantics><mi>k</mi><annotation-xml encoding="MathML-Content"><ci>𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math>)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS5" title="In A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.5 </span>PRNG (iterated Knuth shuffle reserving <math alttext="k" class="ltx_Math" display="inline"><semantics><mi>k</mi><annotation-xml encoding="MathML-Content"><ci>𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math> IPIDs)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS6" title="In A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.6 </span>PRNG (pure, no reserved IPIDs)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2" title="In Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Security Derivations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2.SSS1" title="In A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.1 </span>Globally Incrementing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2.SSS2" title="In A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.2 </span>Per-Connection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2.SSS3" title="In A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.3 </span>Per-Destination</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2.SSS4" title="In A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.4 </span>Per-Bucket (Linux)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2.SSS5" title="In A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.5 </span>PRNG (searchable queue of size <math alttext="k" class="ltx_Math" display="inline"><semantics><mi>k</mi><annotation-xml encoding="MathML-Content"><ci>𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math>)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2.SSS6" title="In A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.6 </span>PRNG (iterated Knuth shuffle reserving <math alttext="k" class="ltx_Math" display="inline"><semantics><mi>k</mi><annotation-xml encoding="MathML-Content"><ci>𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math> IPIDs)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2.SSS7" title="In A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.7 </span>PRNG (pure, no reserved IPIDs)</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A2" title="In A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Benchmark Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A2.SS0.SSS0.Px1" title="In Appendix B Benchmark Implementation Details ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Globally Incrementing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A2.SS0.SSS0.Px2" title="In Appendix B Benchmark Implementation Details ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Per-Connection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A2.SS0.SSS0.Px3" title="In Appendix B Benchmark Implementation Details ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Per-Destination</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A2.SS0.SSS0.Px4" title="In Appendix B Benchmark Implementation Details ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">Per-Bucket (Linux)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A2.SS0.SSS0.Px5" title="In Appendix B Benchmark Implementation Details ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_title">PRNG-based Methods</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Joshua J. Daymude
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/https://orcid.org/0000-0001-7294-5626" title="ORCID identifier">https://orcid.org/0000-0001-7294-5626</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Arizona State University</span><span class="ltx_text ltx_affiliation_department" id="id2.2.id2">Biodesign Center for Biocomputing, Security and Society</span><span class="ltx_text ltx_affiliation_department" id="id3.3.id3">School of Computing and Augmented Intelligence</span><span class="ltx_text ltx_affiliation_streetaddress" id="id4.4.id4">727 E. Tyler St.</span><span class="ltx_text ltx_affiliation_city" id="id5.5.id5">Tempe</span><span class="ltx_text ltx_affiliation_state" id="id6.6.id6">AZ</span><span class="ltx_text ltx_affiliation_postcode" id="id7.7.id7">85281</span><span class="ltx_text ltx_affiliation_country" id="id8.8.id8">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jdaymude@asu.edu">jdaymude@asu.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Antonio M. Espinoza
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/https://orcid.org/0009-0003-3175-2029" title="ORCID identifier">https://orcid.org/0009-0003-3175-2029</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">Eastern Washington University</span><span class="ltx_text ltx_affiliation_department" id="id10.2.id2">College of Science, Technology, Engineering, and Mathematics</span><span class="ltx_text ltx_affiliation_streetaddress" id="id11.3.id3">601 E Riverside Ave.</span><span class="ltx_text ltx_affiliation_city" id="id12.4.id4">Spokane</span><span class="ltx_text ltx_affiliation_state" id="id13.5.id5">WA</span><span class="ltx_text ltx_affiliation_postcode" id="id14.6.id6">99202</span><span class="ltx_text ltx_affiliation_country" id="id15.7.id7">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:aespinoza17@ewu.edu">aespinoza17@ewu.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sean Bergen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/https://orcid.org/0009-0004-3570-5120" title="ORCID identifier">https://orcid.org/0009-0004-3570-5120</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Arizona State University</span><span class="ltx_text ltx_affiliation_department" id="id17.2.id2">Biodesign Center for Biocomputing, Security and Society</span><span class="ltx_text ltx_affiliation_department" id="id18.3.id3">School of Computing and Augmented Intelligence</span><span class="ltx_text ltx_affiliation_streetaddress" id="id19.4.id4">727 E. Tyler St.</span><span class="ltx_text ltx_affiliation_city" id="id20.5.id5">Tempe</span><span class="ltx_text ltx_affiliation_state" id="id21.6.id6">AZ</span><span class="ltx_text ltx_affiliation_postcode" id="id22.7.id7">85281</span><span class="ltx_text ltx_affiliation_country" id="id23.8.id8">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:sbergen2@asu.edu">sbergen2@asu.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Benjamin Mixon–Baca
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id24.1.id1">Arizona State University</span><span class="ltx_text ltx_affiliation_department" id="id25.2.id2">Biodesign Center for Biocomputing, Security and Society</span><span class="ltx_text ltx_affiliation_department" id="id26.3.id3">School of Computing and Augmented Intelligence</span><span class="ltx_text ltx_affiliation_streetaddress" id="id27.4.id4">727 E. Tyler St.</span><span class="ltx_text ltx_affiliation_city" id="id28.5.id5">Tempe</span><span class="ltx_text ltx_affiliation_state" id="id29.6.id6">AZ</span><span class="ltx_text ltx_affiliation_postcode" id="id30.7.id7">85281</span><span class="ltx_text ltx_affiliation_country" id="id31.8.id8">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:bmixonba@asu.edu">bmixonba@asu.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jeffrey Knockel
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id32.1.id1">University of Toronto</span><span class="ltx_text ltx_affiliation_department" id="id33.2.id2">Citizen Lab, Munk School of Global Affairs &amp; Public Policy</span><span class="ltx_text ltx_affiliation_city" id="id34.3.id3">Toronto</span><span class="ltx_text ltx_affiliation_country" id="id35.4.id4">Canada</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jeff@citizenlab.ca">jeff@citizenlab.ca</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jedidiah R. Crandall
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/https://orcid.org/0000-0001-7864-2992" title="ORCID identifier">https://orcid.org/0000-0001-7864-2992</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id36.1.id1">Arizona State University</span><span class="ltx_text ltx_affiliation_department" id="id37.2.id2">Biodesign Center for Biocomputing, Security and Society</span><span class="ltx_text ltx_affiliation_department" id="id38.3.id3">School of Computing and Augmented Intelligence</span><span class="ltx_text ltx_affiliation_streetaddress" id="id39.4.id4">727 E. Tyler St.</span><span class="ltx_text ltx_affiliation_city" id="id40.5.id5">Tempe</span><span class="ltx_text ltx_affiliation_state" id="id41.6.id6">AZ</span><span class="ltx_text ltx_affiliation_postcode" id="id42.7.id7">85281</span><span class="ltx_text ltx_affiliation_country" id="id43.8.id8">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jedimaestro@asu.edu">jedimaestro@asu.edu</a>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id44.id1">The battle for a more secure Internet is waged on many fronts, including the most basic of networking protocols.
Our focus is the <span class="ltx_text ltx_font_italic" id="id44.id1.1">IPv4 Identifier</span> (IPID), an IPv4 header field as old as the Internet with an equally long history as an exploited side channel for scanning network properties, inferring off-path connections, and poisoning DNS caches.
This article taxonomizes the 25-year history of IPID-based exploits and the corresponding changes to IPID selection methods.
By mathematically analyzing these methods’ correctness and security and empirically evaluating their performance, we reveal recommendations for best practice as well as shortcomings of current operating system implementations, emphasizing the value of systematic evaluations in network security.</p>
</div>
<div class="ltx_keywords">IP identifiers, side channels, comparative analysis, probability theory
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Security and privacy Network security</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Networks Routing protocols</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journal" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>CSUR</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">There is ongoing interplay between operating system (OS) developers implementing basic networking protocols, such as IP and TCP, and security researchers discovering side channels and vulnerabilities in those diverse implementations.
A prime example is IP fragmentation and reassembly, a staple of Internet functionality for over forty years <cite class="ltx_cite ltx_citemacro_citep">(Postel, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib54" title="">1981</a>)</cite>.
When an IPv4 packet is too large for the next link of its routing path, it is <span class="ltx_text ltx_font_italic" id="S1.p1.1.1">fragmented</span>; a destination machine then <span class="ltx_text ltx_font_italic" id="S1.p1.1.2">reassembles</span> fragments it receives based on their <span class="ltx_text ltx_font_italic" id="S1.p1.1.3">IPv4 Identifiers</span> (IPIDs), a 16-bit header field.
OSes are free to assign IPIDs to packets however they want, so long as they avoid causing ambiguous reassembly by sending multiple packets with the same IPID to the same destination close in time.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite early concerns about IP fragmentation’s performance impacts <cite class="ltx_cite ltx_citemacro_citep">(Kent and Mogul, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib33" title="">1987</a>)</cite> and later concerns about its vulnerabilities <cite class="ltx_cite ltx_citemacro_citep">(Herzberg and Shulman, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib28" title="">2013a</a>; Gilad and Herzberg, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib25" title="">2013</a>)</cite>, its central role in the Internet—and in DNS in particular—continues to drive the discovery of new vulnerabilities in IPID selection methods.
Since 1998, numerous exploits have abused these methods to poison DNS caches <cite class="ltx_cite ltx_citemacro_citep">(Herzberg and Shulman, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib28" title="">2013a</a>; Palmer and Somers, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib51" title="">2019</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib63" title="">2020</a>)</cite>, hijack TCP connections <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib21" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib22" title="">2022</a>; Gilad and Herzberg, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib24" title="">2012</a>)</cite>, launch denial-of-service (DoS) attacks <cite class="ltx_cite ltx_citemacro_citep">(Malhotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib44" title="">2016</a>)</cite>, scan ports <cite class="ltx_cite ltx_citemacro_citep">(antirez, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib3" title="">1998</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib61" title="">2018</a>)</cite>, detect and measure connections <cite class="ltx_cite ltx_citemacro_citep">(Knockel and Crandall, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib39" title="">2014</a>; Alexander et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib2" title="">2019</a>)</cite>, detect Internet censorship <cite class="ltx_cite ltx_citemacro_citep">(Ensafi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib18" title="">2014</a>)</cite>, and create covert channels <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite>—all from off-path vantage points requiring nothing more than an active Internet connection.
Understanding the aims and necessary conditions of these diverse exploits is critical for proactively securing the menagerie of existing IPID selection methods from further misuse.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The purpose of this survey is two-fold.
First, we taxonomize the 25-year history of off-path IPID-based exploits and the subsequent changes to IPID selection methods across all major OSes.
This taxonomy categorizes every known exploit as either a <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">probe comparison</span> that tracks changes in IPIDs over time to infer information about other machines, or a <span class="ltx_text ltx_font_italic" id="S1.p3.1.2">fragment injection</span> that uses guessed IPIDs to trick a target machine into replacing legitimate fragments with malicious ones during reassembly.
For each class of exploits, we identify the archetypal approach and resulting necessary conditions for success, thus distilling the key properties of (in)secure IPID selection methods.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Second, we perform a unifying comparative analysis of all <span class="ltx_ERROR undefined" id="S1.p4.1.1">\replaced</span>sevensix major IPID selection methods across three qualities: <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">correctness</span> (does the method support unambiguous fragment reassembly?), <span class="ltx_text ltx_font_italic" id="S1.p4.1.3">security</span> (are sequences of IPID values sufficiently difficult to predict?), and <span class="ltx_text ltx_font_italic" id="S1.p4.1.4">performance</span> (what are the method’s time and space complexities?).
By parameterizing this analysis in terms of a machine’s expected rate of traffic and number of CPUs, we reveal tradeoffs among the selection methods for different use cases (e.g., a high-traffic DNS server vs. a low-traffic home computer). Among these evaluations, the most surprising is that globally incrementing selection—the first, simplest, and most dismissed of all IPID selection methods—is in fact the most secure and performant choice for non-connection-bound packets when the rate of outgoing packets is high.
We conclude by proposing a new approach to IPID selection that shifts away from OSes implementing a single method that necessarily compromises at least one of correctness, security, or performance across different use cases, instead embracing multiple implementations that end users can choose from (e.g., as a network setting) based on their expected rates of traffic.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The remainder of this paper is organized as follows.
Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2" title="2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a> introduces IP fragmentation and reassembly, the <span class="ltx_ERROR undefined" id="S1.p5.1.1">\replaced</span>sevensix primary IPID selection methods, and their current OS implementations.
Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3" title="3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3</span></a> reviews the history of exploits using IPIDs for measurements or malicious attacks and the corresponding changes to selection methods.
Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4" title="4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4</span></a> presents our comparative analysis of IPID selection methods’ correctness, security, and performance.
We synthesize these evaluations as recommendations for a new approach to IPID selection in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5" title="5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">5</span></a>; readers seeking to quickly digest “what’s new” should skip to this section and refer to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a> as a visual summary of our proposed approach.
Finally, we conclude in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S6" title="6. Conclusion ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Background</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We begin by reviewing how IPIDs are used, the established methods for selecting IPIDs, and the current OS implementations of those selection methods.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>IP Packet Fragmentation and Reassembly</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">The IPID is a 16-bit IP header field used for packet reassembly (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.F1" title="Figure 1 ‣ 2.1. IP Packet Fragmentation and Reassembly ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">1</span></a>).
Every IP packet is assigned an IPID by its sender.
If ever a packet is too large for some link of its routing path, an intermediate router breaks it into <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.1">fragments</span> that inherit the IPID of their packet.
As the packet’s destination receives these fragments in its <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.2">reassembly buffer</span> (also known as the <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.3">fragmentation cache</span>), it uses their IPIDs to group them by packet and inspects their <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.4">Flags</span> and <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.5">Fragment Offset</span> IP header fields to determine whether all of the packet’s fragments have arrived and in what order they should be reassembled.
This continues until the packet is reassembled or a timeout of 15–120 seconds is reached <cite class="ltx_cite ltx_citemacro_citep">(Braden, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib9" title="">1989</a>; Postel, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib54" title="">1981</a>)</cite>.
The main restriction concerning IPID selection is that IPIDs must be “unique” to avoid ambiguous reassembly <cite class="ltx_cite ltx_citemacro_citep">(Postel, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib54" title="">1981</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="234" id="S2.F1.g1" src="x1.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.3.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text ltx_font_italic" id="S2.F1.4.2" style="font-size:90%;">Anatomy of an IPv4 Packet Header.<span class="ltx_text ltx_font_upright" id="S2.F1.4.2.1">
The 16-bit Identification field is the packet’s IPID.
The Flags and Fragment Offset fields are also used in IP fragmentation and reassembly.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">IP fragmentation is not always necessary.
For example, if a sender knows a path’s maximum transmission unit (MTU)—e.g., as part of a TCP connection—it can resize its packets prior to sending them.
Such packets can be made <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.1">atomic</span> to discourage IP fragmentation, setting their <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.2">Don’t Fragment</span> (DF) flag to <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p2.1.3">true</span>, their <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.4">More Fragments</span> (MF) flag to <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p2.1.5">false</span>, and their <span class="ltx_text ltx_font_italic" id="S2.SS1.p2.1.6">Fragment Offset</span> to 0.
IPIDs have no utility in atomic packets and are thus ignored and allowed to be any value <cite class="ltx_cite ltx_citemacro_citep">(Touch, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib60" title="">2013</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>IPID Selection Methods</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">In this section, we detail the <span class="ltx_ERROR undefined" id="S2.SS2.p1.1.1">\replaced</span>sevensix existing methods for selecting packets’ IPIDs.
These methods fall into two categories: counter-based (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS2.SSS1" title="2.2.1. Counter-Based Selection Methods ‣ 2.2. IPID Selection Methods ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.2.1</span></a>) and PRNG-based (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS2.SSS2" title="2.2.2. PRNG-Based Selection Methods ‣ 2.2. IPID Selection Methods ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.2.2</span></a>).</p>
</div>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1. </span>Counter-Based Selection Methods</h4>
<div class="ltx_para" id="S2.SS2.SSS1.p1">
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S2.I1.i1.p1.1.1">Globally incrementing</span> IPID selection is the earliest and simplest method.
Each machine maintains a single, sequentially-incrementing, 16-bit counter for all IPID generation.
Whenever a machine sends a packet, it increments its global counter (modulo <math alttext="2^{16}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><msup id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml"><mn id="S2.I1.i1.p1.1.m1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.2.cmml">2</mn><mn id="S2.I1.i1.p1.1.m1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><apply id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">superscript</csymbol><cn id="S2.I1.i1.p1.1.m1.1.1.2.cmml" type="integer" xref="S2.I1.i1.p1.1.m1.1.1.2">2</cn><cn id="S2.I1.i1.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.i1.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>) and uses the resulting value as the packet’s IPID.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.1.1">Per-connection</span> IPID selection generalizes globally incrementing selection by maintaining one sequentially-incrementing 16-bit counter per active <span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.1.2">connection</span>, i.e., a 5-tuple specifying the source and destination IP addresses, source and destination ports, and protocol number.
Each connection counter is initialized with a random value when the connection is established and subsequently assigns IPIDs to packets by incrementing by one, modulo <math alttext="2^{16}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><msup id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mn id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml">2</mn><mn id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">superscript</csymbol><cn id="S2.I1.i2.p1.1.m1.1.1.2.cmml" type="integer" xref="S2.I1.i2.p1.1.m1.1.1.2">2</cn><cn id="S2.I1.i2.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.i2.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S2.I1.i3.p1.1.1">Per-destination</span> IPID selection is analogous to per-connection selection, but with one counter per pair of source and destination IP addresses.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.1"><span class="ltx_text ltx_font_italic" id="S2.I1.i4.p1.1.1">Per-bucket</span> IPID selection is similar to per-connection and per-destination selection, but with one counter per “bucket”.
Packets are typically mapped to buckets by hashing their IP header information (e.g., source and destination IP addresses or the protocol number) with cryptographic information like secret keys.
Some implementations of per-bucket selection use sequentially-incrementing bucket counters, analogous to the above methods, while others inject some stochasticity.
These variations are detailed by OS in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3" title="2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.3</span></a>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2. </span>PRNG-Based Selection Methods</h4>
<div class="ltx_para" id="S2.SS2.SSS2.p1">
<p class="ltx_p" id="S2.SS2.SSS2.p1.4">Methods based on <span class="ltx_text ltx_font_italic" id="S2.SS2.SSS2.p1.4.1">pseudorandom number generation</span> (PRNGs) select IPID values at random from among the <math alttext="2^{16}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.1.m1.1"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><msup id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml"><mn id="S2.SS2.SSS2.p1.1.m1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml">2</mn><mn id="S2.SS2.SSS2.p1.1.m1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1">superscript</csymbol><cn id="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S2.SS2.SSS2.p1.1.m1.1.1.2">2</cn><cn id="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> possible values <span class="ltx_ERROR undefined" id="S2.SS2.SSS2.p1.4.2">\added</span>often while avoiding recently selected IPIDs whose reuse could cause ambiguous reassembly.
One method is to generate IPID values with a well-seeded PRNG algorithm while maintaining a <span class="ltx_text ltx_font_italic" id="S2.SS2.SSS2.p1.4.3">searchable queue</span> storing the last <math alttext="k\geq 0" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.2.m2.1"><semantics id="S2.SS2.SSS2.p1.2.m2.1a"><mrow id="S2.SS2.SSS2.p1.2.m2.1.1" xref="S2.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p1.2.m2.1.1.2" xref="S2.SS2.SSS2.p1.2.m2.1.1.2.cmml">k</mi><mo id="S2.SS2.SSS2.p1.2.m2.1.1.1" xref="S2.SS2.SSS2.p1.2.m2.1.1.1.cmml">≥</mo><mn id="S2.SS2.SSS2.p1.2.m2.1.1.3" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.2.m2.1b"><apply id="S2.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1"><geq id="S2.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.1"></geq><ci id="S2.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.2">𝑘</ci><cn id="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.2.m2.1c">k\geq 0</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.2.m2.1d">italic_k ≥ 0</annotation></semantics></math> unique IPIDs.
When an IPID is requested, the PRNG generates values until one is found that is not already in the queue; this new value is then inserted into the queue and used as the next IPID.
The size of the searchable queue varies by implementation, but is typically chosen between <span class="ltx_text ltx_number" id="S2.SS2.SSS2.p1.4.4">4,096</span> and <span class="ltx_text ltx_number" id="S2.SS2.SSS2.p1.4.5">32,768</span> (i.e., <math alttext="2^{12}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.3.m3.1"><semantics id="S2.SS2.SSS2.p1.3.m3.1a"><msup id="S2.SS2.SSS2.p1.3.m3.1.1" xref="S2.SS2.SSS2.p1.3.m3.1.1.cmml"><mn id="S2.SS2.SSS2.p1.3.m3.1.1.2" xref="S2.SS2.SSS2.p1.3.m3.1.1.2.cmml">2</mn><mn id="S2.SS2.SSS2.p1.3.m3.1.1.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.3.cmml">12</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.3.m3.1b"><apply id="S2.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1">superscript</csymbol><cn id="S2.SS2.SSS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S2.SS2.SSS2.p1.3.m3.1.1.2">2</cn><cn id="S2.SS2.SSS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p1.3.m3.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.3.m3.1c">2^{12}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.3.m3.1d">2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="2^{15}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.4.m4.1"><semantics id="S2.SS2.SSS2.p1.4.m4.1a"><msup id="S2.SS2.SSS2.p1.4.m4.1.1" xref="S2.SS2.SSS2.p1.4.m4.1.1.cmml"><mn id="S2.SS2.SSS2.p1.4.m4.1.1.2" xref="S2.SS2.SSS2.p1.4.m4.1.1.2.cmml">2</mn><mn id="S2.SS2.SSS2.p1.4.m4.1.1.3" xref="S2.SS2.SSS2.p1.4.m4.1.1.3.cmml">15</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.4.m4.1b"><apply id="S2.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m4.1.1">superscript</csymbol><cn id="S2.SS2.SSS2.p1.4.m4.1.1.2.cmml" type="integer" xref="S2.SS2.SSS2.p1.4.m4.1.1.2">2</cn><cn id="S2.SS2.SSS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p1.4.m4.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.4.m4.1c">2^{15}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.4.m4.1d">2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT</annotation></semantics></math>) to provide a good tradeoff between entropy and non-repetition.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p2">
<p class="ltx_p" id="S2.SS2.SSS2.p2.3">Another method uses an <span class="ltx_text ltx_font_italic" id="S2.SS2.SSS2.p2.3.1">iterated Knuth shuffle</span> <cite class="ltx_cite ltx_citemacro_citep">(Knuth, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib40" title="">1969</a>)</cite> (also known as the Durstenfeld algorithm for random permutations or the Fisher–Yates shuffle).
Initially, a random permutation of all <math alttext="2^{16}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.1.m1.1"><semantics id="S2.SS2.SSS2.p2.1.m1.1a"><msup id="S2.SS2.SSS2.p2.1.m1.1.1" xref="S2.SS2.SSS2.p2.1.m1.1.1.cmml"><mn id="S2.SS2.SSS2.p2.1.m1.1.1.2" xref="S2.SS2.SSS2.p2.1.m1.1.1.2.cmml">2</mn><mn id="S2.SS2.SSS2.p2.1.m1.1.1.3" xref="S2.SS2.SSS2.p2.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.1.m1.1b"><apply id="S2.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1">superscript</csymbol><cn id="S2.SS2.SSS2.p2.1.m1.1.1.2.cmml" type="integer" xref="S2.SS2.SSS2.p2.1.m1.1.1.2">2</cn><cn id="S2.SS2.SSS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> IPID values is generated by a standard Knuth shuffle.
When an IPID is requested, the next value in the permutation is used.
That value is then swapped into a position chosen uniformly at random from among the previous <math alttext="2^{16}-k" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.2.m2.1"><semantics id="S2.SS2.SSS2.p2.2.m2.1a"><mrow id="S2.SS2.SSS2.p2.2.m2.1.1" xref="S2.SS2.SSS2.p2.2.m2.1.1.cmml"><msup id="S2.SS2.SSS2.p2.2.m2.1.1.2" xref="S2.SS2.SSS2.p2.2.m2.1.1.2.cmml"><mn id="S2.SS2.SSS2.p2.2.m2.1.1.2.2" xref="S2.SS2.SSS2.p2.2.m2.1.1.2.2.cmml">2</mn><mn id="S2.SS2.SSS2.p2.2.m2.1.1.2.3" xref="S2.SS2.SSS2.p2.2.m2.1.1.2.3.cmml">16</mn></msup><mo id="S2.SS2.SSS2.p2.2.m2.1.1.1" xref="S2.SS2.SSS2.p2.2.m2.1.1.1.cmml">−</mo><mi id="S2.SS2.SSS2.p2.2.m2.1.1.3" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.2.m2.1b"><apply id="S2.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1"><minus id="S2.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.1"></minus><apply id="S2.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.2">superscript</csymbol><cn id="S2.SS2.SSS2.p2.2.m2.1.1.2.2.cmml" type="integer" xref="S2.SS2.SSS2.p2.2.m2.1.1.2.2">2</cn><cn id="S2.SS2.SSS2.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S2.SS2.SSS2.p2.2.m2.1.1.2.3">16</cn></apply><ci id="S2.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.2.m2.1c">2^{16}-k</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.2.m2.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k</annotation></semantics></math> positions in the permutation (including its own), ensuring that it will not be selected again within the next <math alttext="k" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.3.m3.1"><semantics id="S2.SS2.SSS2.p2.3.m3.1a"><mi id="S2.SS2.SSS2.p2.3.m3.1.1" xref="S2.SS2.SSS2.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.3.m3.1b"><ci id="S2.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.3.m3.1d">italic_k</annotation></semantics></math> requests for IPIDs.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p3">
<span class="ltx_ERROR undefined" id="S2.SS2.SSS2.p3.3">\added</span>
<p class="ltx_p" id="S2.SS2.SSS2.p3.2"><span class="ltx_text ltx_font_italic" id="S2.SS2.SSS2.p3.2.1">Pure PRNG selection</span> simply generates IPIDs from among the <math alttext="2^{16}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.1.m1.1"><semantics id="S2.SS2.SSS2.p3.1.m1.1a"><msup id="S2.SS2.SSS2.p3.1.m1.1.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.cmml"><mn id="S2.SS2.SSS2.p3.1.m1.1.1.2" xref="S2.SS2.SSS2.p3.1.m1.1.1.2.cmml">2</mn><mn id="S2.SS2.SSS2.p3.1.m1.1.1.3" xref="S2.SS2.SSS2.p3.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.1.m1.1b"><apply id="S2.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1">superscript</csymbol><cn id="S2.SS2.SSS2.p3.1.m1.1.1.2.cmml" type="integer" xref="S2.SS2.SSS2.p3.1.m1.1.1.2">2</cn><cn id="S2.SS2.SSS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p3.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> possible values uniformly at random, regardless of possibly repeating IPIDs.
This is functionally equivalent to the previous two methods with <math alttext="k=0" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.2.m2.1"><semantics id="S2.SS2.SSS2.p3.2.m2.1a"><mrow id="S2.SS2.SSS2.p3.2.m2.1.1" xref="S2.SS2.SSS2.p3.2.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p3.2.m2.1.1.2" xref="S2.SS2.SSS2.p3.2.m2.1.1.2.cmml">k</mi><mo id="S2.SS2.SSS2.p3.2.m2.1.1.1" xref="S2.SS2.SSS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS2.SSS2.p3.2.m2.1.1.3" xref="S2.SS2.SSS2.p3.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.2.m2.1b"><apply id="S2.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1"><eq id="S2.SS2.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1.1"></eq><ci id="S2.SS2.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1.2">𝑘</ci><cn id="S2.SS2.SSS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.2.m2.1c">k=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.2.m2.1d">italic_k = 0</annotation></semantics></math>, but has no need for their data structures ensuring non-repetition.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Current Implementations</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In this section, we survey current implementations of IPID selection across popular OSes.</p>
</div>
<section class="ltx_paragraph" id="S2.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Windows</h5>
<div class="ltx_para" id="S2.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS3.SSS0.Px1.p1.4">Source code for Windows 8, 10, and 11 is not publicly available, though reverse-engineering efforts revealed that until related issues were patched in 2019, Windows 8 and 10 used per-bucket IPID selection based on the Toeplitz hash function with <span class="ltx_text ltx_number" id="S2.SS3.SSS0.Px1.p1.4.1">8,192</span> (i.e., <math alttext="2^{13}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS3.SSS0.Px1.p1.1.m1.1a"><msup id="S2.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="S2.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">2</mn><mn id="S2.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S2.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">13</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS0.Px1.p1.1.m1.1.1">superscript</csymbol><cn id="S2.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" type="integer" xref="S2.SS3.SSS0.Px1.p1.1.m1.1.1.2">2</cn><cn id="S2.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS0.Px1.p1.1.m1.1.1.3">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px1.p1.1.m1.1c">2^{13}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px1.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 13 end_POSTSUPERSCRIPT</annotation></semantics></math>) buckets <cite class="ltx_cite ltx_citemacro_citep">(Klein and Pinkas, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib38" title="">2019</a>)</cite>.
Recent analysis shows that Windows Server (v1903) uses per-destination IPID selection <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite>.
Specifically, Windows maintains a <span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px1.p1.4.2">\replaced</span>“PathSet” (i.e., a hash table)hash table of sequentially incrementing counters indexed by source and destination IP address pairs, adding <span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px1.p1.4.3">\replaced</span>a new counternew entries whenever a packet’s destination is not already in the <span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px1.p1.4.4">\replaced</span>PathSethash table.
<span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px1.p1.4.5">\replaced</span>The PathSet’s size is checked every 0.5 s: if it has grown beyond its “purge threshold”—<span class="ltx_text ltx_number" id="S2.SS3.SSS0.Px1.p1.4.6">4,096</span> (i.e., <math alttext="2^{12}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS3.SSS0.Px1.p1.2.m2.1a"><msup id="S2.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="S2.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S2.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">2</mn><mn id="S2.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S2.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">12</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S2.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS0.Px1.p1.2.m2.1.1">superscript</csymbol><cn id="S2.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" type="integer" xref="S2.SS3.SSS0.Px1.p1.2.m2.1.1.2">2</cn><cn id="S2.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS0.Px1.p1.2.m2.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px1.p1.2.m2.1c">2^{12}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px1.p1.2.m2.1d">2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math>) counters in Windows 10 or <span class="ltx_text ltx_number" id="S2.SS3.SSS0.Px1.p1.4.7">32,768</span> (i.e., <math alttext="2^{15}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS3.SSS0.Px1.p1.3.m3.1a"><msup id="S2.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mn id="S2.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S2.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml">2</mn><mn id="S2.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S2.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">15</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S2.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S2.SS3.SSS0.Px1.p1.3.m3.1.1">superscript</csymbol><cn id="S2.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" type="integer" xref="S2.SS3.SSS0.Px1.p1.3.m3.1.1.2">2</cn><cn id="S2.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" type="integer" xref="S2.SS3.SSS0.Px1.p1.3.m3.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px1.p1.3.m3.1c">2^{15}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px1.p1.3.m3.1d">2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT</annotation></semantics></math>) in Windows Server—or more than <span class="ltx_text ltx_number" id="S2.SS3.SSS0.Px1.p1.4.8">5,000</span> counters have been added since the last check, a “purge sequence” removes up to <math alttext="\max\{\numprint{1000},\text{\# added since last check}\}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px1.p1.4.m4.4"><semantics id="S2.SS3.SSS0.Px1.p1.4.m4.4a"><mrow id="S2.SS3.SSS0.Px1.p1.4.m4.4.5.2" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.5.1.cmml"><mi id="S2.SS3.SSS0.Px1.p1.4.m4.3.3" xref="S2.SS3.SSS0.Px1.p1.4.m4.3.3.cmml">max</mi><mo id="S2.SS3.SSS0.Px1.p1.4.m4.4.5.2a" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.5.1.cmml">⁡</mo><mrow id="S2.SS3.SSS0.Px1.p1.4.m4.4.5.2.1" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.5.1.cmml"><mo id="S2.SS3.SSS0.Px1.p1.4.m4.4.5.2.1.1" stretchy="false" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.5.1.cmml">{</mo><mrow id="S2.SS3.SSS0.Px1.p1.4.m4.2.2.4" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.5.1.cmml"><mn id="S2.SS3.SSS0.Px1.p1.4.m4.1.1.1.1" xref="S2.SS3.SSS0.Px1.p1.4.m4.2.2.3.cmml">1</mn><mo id="S2.SS3.SSS0.Px1.p1.4.m4.2.2.4.1" xref="S2.SS3.SSS0.Px1.p1.4.m4.2.2.3.cmml">,</mo><mn id="S2.SS3.SSS0.Px1.p1.4.m4.2.2.2.2" xref="S2.SS3.SSS0.Px1.p1.4.m4.2.2.3.cmml">000</mn></mrow><mo id="S2.SS3.SSS0.Px1.p1.4.m4.4.5.2.1.2" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.5.1.cmml">,</mo><mtext id="S2.SS3.SSS0.Px1.p1.4.m4.4.4" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.4a.cmml"># added since last check</mtext><mo id="S2.SS3.SSS0.Px1.p1.4.m4.4.5.2.1.3" stretchy="false" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.5.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px1.p1.4.m4.4b"><apply id="S2.SS3.SSS0.Px1.p1.4.m4.4.5.1.cmml" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.5.2"><max id="S2.SS3.SSS0.Px1.p1.4.m4.3.3.cmml" xref="S2.SS3.SSS0.Px1.p1.4.m4.3.3"></max><cn id="S2.SS3.SSS0.Px1.p1.4.m4.2.2.3.cmml" type="integer" xref="S2.SS3.SSS0.Px1.p1.4.m4.1.1.1.1">1000</cn><ci id="S2.SS3.SSS0.Px1.p1.4.m4.4.4a.cmml" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.4"><mtext id="S2.SS3.SSS0.Px1.p1.4.m4.4.4.cmml" xref="S2.SS3.SSS0.Px1.p1.4.m4.4.4"># added since last check</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px1.p1.4.m4.4c">\max\{\numprint{1000},\text{\# added since last check}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px1.p1.4.m4.4d">roman_max { 1 , 000 , # added since last check }</annotation></semantics></math> “stale” counters.
Counters are considered “stale” depending on when they were last accessed and the PathSet’s size: if the PathSet’s size is between once and twice its purge threshold, then counters accessed longer than 10 s (Windows 10) or 60 s (Windows Server) ago are considered stale; if the PathSet’s size is more than twice its purge threshold, all counters are considered stale <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib37" title="">2024</a>)</cite>.When this table grows too large or too quickly, a “purge sequence” scans over the table and removes any “stale” counters accessed longer than 10–60 s ago.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Linux</h5>
<div class="ltx_para" id="S2.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS3.SSS0.Px2.p1.2">The current Linux kernel (<a class="ltx_ref ltx_href" href="https://elixir.bootlin.com/linux/v6.9/source/include/net/ip.h#L542" title="">v6.9</a>) uses either per-connection or per-bucket IPID selection depending on the connection type.
Packets sent via established sockets use per-connection selection, initializing connection counters with a random value generated by <span class="ltx_text ltx_font_typewriter" id="S2.SS3.SSS0.Px2.p1.2.1">prandom_u32</span> after the connection is established.
Atomic packets sent outside of sockets and any RST response to an unsolicited packet (e.g., a stray SYN/ACK) are assigned IPID zero <cite class="ltx_cite ltx_citemacro_citep">(Alexander et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib2" title="">2019</a>)</cite>.
All other packets use per-bucket selection with <span class="ltx_text ltx_number" id="S2.SS3.SSS0.Px2.p1.2.2">2,048</span> to <span class="ltx_text ltx_number" id="S2.SS3.SSS0.Px2.p1.2.3">262,144</span> (i.e., <math alttext="2^{11}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S2.SS3.SSS0.Px2.p1.1.m1.1a"><msup id="S2.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S2.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S2.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S2.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">2</mn><mn id="S2.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S2.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">11</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S2.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><cn id="S2.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" type="integer" xref="S2.SS3.SSS0.Px2.p1.1.m1.1.1.2">2</cn><cn id="S2.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS0.Px2.p1.1.m1.1.1.3">11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px2.p1.1.m1.1c">2^{11}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px2.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 11 end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="2^{18}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S2.SS3.SSS0.Px2.p1.2.m2.1a"><msup id="S2.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S2.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mn id="S2.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S2.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml">2</mn><mn id="S2.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S2.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml">18</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S2.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS0.Px2.p1.2.m2.1.1">superscript</csymbol><cn id="S2.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" type="integer" xref="S2.SS3.SSS0.Px2.p1.2.m2.1.1.2">2</cn><cn id="S2.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS0.Px2.p1.2.m2.1.1.3">18</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px2.p1.2.m2.1c">2^{18}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px2.p1.2.m2.1d">2 start_POSTSUPERSCRIPT 18 end_POSTSUPERSCRIPT</annotation></semantics></math>) buckets, depending on the sender’s RAM.
Buckets are located using SipHash-2-4 to hash the packet’s destination IP address, source IP address, protocol number, and a <span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px2.p1.2.4">\replaced</span>128-bit64-bit random key.
Instead of incrementing bucket counters sequentially, Linux increments by a value chosen uniformly at random from 1 to the number of system ticks since the bucket counter was last incremented.
These stochastic increments were designed to add noise to unused bucket counters that adversaries could otherwise take advantage of.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS3.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">OpenBSD</h5>
<div class="ltx_para" id="S2.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS3.SSS0.Px3.p1.2">OpenBSD (<a class="ltx_ref ltx_href" href="https://github.com/openbsd/src/blob/085f25454964baa8e68d1053b787c22afc566ce9/sys/netinet/ip_id.c" title="">v7.5</a>) implements PRNG IPID selection using an iterated Knuth shuffle with <math alttext="k=\numprint{32768}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px3.p1.1.m1.2"><semantics id="S2.SS3.SSS0.Px3.p1.1.m1.2a"><mrow id="S2.SS3.SSS0.Px3.p1.1.m1.2.3" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.3.cmml"><mi id="S2.SS3.SSS0.Px3.p1.1.m1.2.3.2" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.3.2.cmml">k</mi><mo id="S2.SS3.SSS0.Px3.p1.1.m1.2.3.1" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.3.1.cmml">=</mo><mrow id="S2.SS3.SSS0.Px3.p1.1.m1.2.2.4" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.3.cmml"><mn id="S2.SS3.SSS0.Px3.p1.1.m1.1.1.1.1" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.2.3.cmml">32</mn><mo id="S2.SS3.SSS0.Px3.p1.1.m1.2.2.4.1" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.2.3.cmml">,</mo><mn id="S2.SS3.SSS0.Px3.p1.1.m1.2.2.2.2" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.2.3.cmml">768</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px3.p1.1.m1.2b"><apply id="S2.SS3.SSS0.Px3.p1.1.m1.2.3.cmml" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.3"><eq id="S2.SS3.SSS0.Px3.p1.1.m1.2.3.1.cmml" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.3.1"></eq><ci id="S2.SS3.SSS0.Px3.p1.1.m1.2.3.2.cmml" xref="S2.SS3.SSS0.Px3.p1.1.m1.2.3.2">𝑘</ci><cn id="S2.SS3.SSS0.Px3.p1.1.m1.2.2.3.cmml" type="integer" xref="S2.SS3.SSS0.Px3.p1.1.m1.1.1.1.1">32768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px3.p1.1.m1.2c">k=\numprint{32768}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px3.p1.1.m1.2d">italic_k = 32 , 768</annotation></semantics></math> (i.e., <math alttext="2^{15}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px3.p1.2.m2.1"><semantics id="S2.SS3.SSS0.Px3.p1.2.m2.1a"><msup id="S2.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S2.SS3.SSS0.Px3.p1.2.m2.1.1.cmml"><mn id="S2.SS3.SSS0.Px3.p1.2.m2.1.1.2" xref="S2.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml">2</mn><mn id="S2.SS3.SSS0.Px3.p1.2.m2.1.1.3" xref="S2.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml">15</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px3.p1.2.m2.1b"><apply id="S2.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS0.Px3.p1.2.m2.1.1">superscript</csymbol><cn id="S2.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml" type="integer" xref="S2.SS3.SSS0.Px3.p1.2.m2.1.1.2">2</cn><cn id="S2.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS0.Px3.p1.2.m2.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px3.p1.2.m2.1c">2^{15}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px3.p1.2.m2.1d">2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT</annotation></semantics></math>).
Random swap indices are generated using <span class="ltx_text ltx_font_typewriter" id="S2.SS3.SSS0.Px3.p1.2.1">arc4rand</span>.
OpenBSD never assigns zero as an IPID: if zero is next in the permutation, it is swapped as usual but not returned.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS3.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">FreeBSD</h5>
<div class="ltx_para" id="S2.SS3.SSS0.Px4.p1">
<p class="ltx_p" id="S2.SS3.SSS0.Px4.p1.2">FreeBSD (<a class="ltx_ref ltx_href" href="https://github.com/freebsd/freebsd-src/blob/release/14.0.0/sys/netinet/ip_id.c" title="">v14.0</a>) assigns IPID zero to all atomic packets and uses globally incrementing selection for non-atomic packets.
FreeBSD includes a configuration option to use PRNG selection with a searchable queue of size <math alttext="k=\numprint{8192}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px4.p1.1.m1.2"><semantics id="S2.SS3.SSS0.Px4.p1.1.m1.2a"><mrow id="S2.SS3.SSS0.Px4.p1.1.m1.2.3" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.3.cmml"><mi id="S2.SS3.SSS0.Px4.p1.1.m1.2.3.2" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.3.2.cmml">k</mi><mo id="S2.SS3.SSS0.Px4.p1.1.m1.2.3.1" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.3.1.cmml">=</mo><mrow id="S2.SS3.SSS0.Px4.p1.1.m1.2.2.4" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.3.cmml"><mn id="S2.SS3.SSS0.Px4.p1.1.m1.1.1.1.1" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.2.3.cmml">8</mn><mo id="S2.SS3.SSS0.Px4.p1.1.m1.2.2.4.1" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.2.3.cmml">,</mo><mn id="S2.SS3.SSS0.Px4.p1.1.m1.2.2.2.2" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.2.3.cmml">192</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px4.p1.1.m1.2b"><apply id="S2.SS3.SSS0.Px4.p1.1.m1.2.3.cmml" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.3"><eq id="S2.SS3.SSS0.Px4.p1.1.m1.2.3.1.cmml" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.3.1"></eq><ci id="S2.SS3.SSS0.Px4.p1.1.m1.2.3.2.cmml" xref="S2.SS3.SSS0.Px4.p1.1.m1.2.3.2">𝑘</ci><cn id="S2.SS3.SSS0.Px4.p1.1.m1.2.2.3.cmml" type="integer" xref="S2.SS3.SSS0.Px4.p1.1.m1.1.1.1.1">8192</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px4.p1.1.m1.2c">k=\numprint{8192}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px4.p1.1.m1.2d">italic_k = 8 , 192</annotation></semantics></math> (i.e., <math alttext="2^{13}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px4.p1.2.m2.1"><semantics id="S2.SS3.SSS0.Px4.p1.2.m2.1a"><msup id="S2.SS3.SSS0.Px4.p1.2.m2.1.1" xref="S2.SS3.SSS0.Px4.p1.2.m2.1.1.cmml"><mn id="S2.SS3.SSS0.Px4.p1.2.m2.1.1.2" xref="S2.SS3.SSS0.Px4.p1.2.m2.1.1.2.cmml">2</mn><mn id="S2.SS3.SSS0.Px4.p1.2.m2.1.1.3" xref="S2.SS3.SSS0.Px4.p1.2.m2.1.1.3.cmml">13</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px4.p1.2.m2.1b"><apply id="S2.SS3.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS0.Px4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS0.Px4.p1.2.m2.1.1">superscript</csymbol><cn id="S2.SS3.SSS0.Px4.p1.2.m2.1.1.2.cmml" type="integer" xref="S2.SS3.SSS0.Px4.p1.2.m2.1.1.2">2</cn><cn id="S2.SS3.SSS0.Px4.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS0.Px4.p1.2.m2.1.1.3">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px4.p1.2.m2.1c">2^{13}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px4.p1.2.m2.1d">2 start_POSTSUPERSCRIPT 13 end_POSTSUPERSCRIPT</annotation></semantics></math>) instead, though it is disabled by default to minimize performance impact.
This disabled code uses <span class="ltx_text ltx_font_typewriter" id="S2.SS3.SSS0.Px4.p1.2.1">arc4rand</span> as its PRNG.
As in OpenBSD, zero is treated as a special IPID that is never returned.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS3.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">macOS/XNU</h5>
<div class="ltx_para" id="S2.SS3.SSS0.Px5.p1">
<p class="ltx_p" id="S2.SS3.SSS0.Px5.p1.1">Although most source code for macOS is not publicly available, its network stack uses the open source XNU kernel (<span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px5.p1.1.1">\replaced</span><a class="ltx_ref ltx_href" href="https://github.com/apple-oss-distributions/xnu/blob/xnu-8792.41.9/bsd/netinet/ip_id.c" title="">v8792.41.9</a><a class="ltx_ref ltx_href" href="https://github.com/apple/darwin-xnu/blob/2ff845c2e033bd0ff64b5b6aa6063a1f8f65aa32/bsd/netinet/ip_id.c" title="">v7195.121.3</a>)<span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px5.p1.1.2">\deleted</span> which borrows heavily from FreeBSD.
As in FreeBSD, macOS/XNU assigns zero as the IPID of all atomic packets<span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px5.p1.1.3">\deleted</span> and includes a configuration option to use either globally incrementing or PRNG selection with a searchable queue of size <span class="ltx_text ltx_number" id="S2.SS3.SSS0.Px5.p1.1.4">4,096</span> (i.e., <math alttext="2^{12}" class="ltx_Math" display="inline" id="S2.SS3.SSS0.Px5.p1.1.m1.1"><semantics id="S2.SS3.SSS0.Px5.p1.1.m1.1a"><msup id="S2.SS3.SSS0.Px5.p1.1.m1.1.1" xref="S2.SS3.SSS0.Px5.p1.1.m1.1.1.cmml"><mn id="S2.SS3.SSS0.Px5.p1.1.m1.1.1.2" xref="S2.SS3.SSS0.Px5.p1.1.m1.1.1.2.cmml">2</mn><mn id="S2.SS3.SSS0.Px5.p1.1.m1.1.1.3" xref="S2.SS3.SSS0.Px5.p1.1.m1.1.1.3.cmml">12</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS0.Px5.p1.1.m1.1b"><apply id="S2.SS3.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS0.Px5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS0.Px5.p1.1.m1.1.1">superscript</csymbol><cn id="S2.SS3.SSS0.Px5.p1.1.m1.1.1.2.cmml" type="integer" xref="S2.SS3.SSS0.Px5.p1.1.m1.1.1.2">2</cn><cn id="S2.SS3.SSS0.Px5.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS0.Px5.p1.1.m1.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS0.Px5.p1.1.m1.1c">2^{12}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS0.Px5.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math>) for non-atomic packets. Unlike FreeBSD, XNU sets PRNG selection as its default, though the exact PRNG algorithm being used is excluded from the publicly available source code.
<span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px5.p1.1.5">\added</span>For non-atomic packets, macOS recently adopted pure PRNG selection, generating 16-bit values uniformly at random and then salting them with a packet-specific value; notably, this implementation does not include mechanisms for avoiding repeated IPIDs.
As in the BSDs, zero is treated as a special IPID that is never returned.
<span class="ltx_ERROR undefined" id="S2.SS3.SSS0.Px5.p1.1.6">\deleted</span>By probing a machine running macOS 12 (Monterey), we confirmed that atomic packets are always assigned IPID zero and non-atomic packets appear to have random IPIDs.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Measurements and Attacks</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we present a history of IPID-based exploits and the corresponding OS implementation changes they influenced (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a> for an overview).
Notably, many vulnerabilities remained exploitable long after disclosure due to delays in patching and updating to the latest versions.
We categorize these exploits as either <span class="ltx_text ltx_font_italic" id="S3.p1.1.1">probe comparisons</span> (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1" title="3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a>) or <span class="ltx_text ltx_font_italic" id="S3.p1.1.2">fragment injections</span> (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2" title="3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a>) based on how they use IPIDs to achieve their goals.
Within these categories, we distinguish between <span class="ltx_text ltx_font_italic" id="S3.p1.1.3">measurements</span> which infer information about other machines and <span class="ltx_text ltx_font_italic" id="S3.p1.1.4">attacks</span> which maliciously affect target systems—often by leveraging information learned from measurements.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="294" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.3.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text ltx_font_italic" id="S3.F2.4.2" style="font-size:90%;">Timeline of IPID Measurements, Attacks, and Selection Methods.<span class="ltx_text ltx_font_upright" id="S3.F2.4.2.1">
Each OS implementation of IPID selection varies over time in response to disclosed measurements and attacks (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3" title="3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3</span></a>), categorized either as probe comparisons (circles) or fragment injections (squares).
Since 2000, Linux has implemented two methods, one for atomic packets (per-connection) and one for non-atomic packets (per-destination or per-bucket).
FreeBSD has implemented various PRNG-based methods (dashed lines) but always disables them by default.
Minor patches that did not change selection methods (e.g., a different hash function in per-bucket selection or Linux’s fixes for specific packet types) are not shown.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.12">Network exploits by a machine <math alttext="M" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_M</annotation></semantics></math> against target machines <math alttext="A" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_A</annotation></semantics></math> and <math alttext="B" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">italic_B</annotation></semantics></math> are performed from one of three vantage points: off-path, on-path, or in-path <cite class="ltx_cite ltx_citemacro_citep">(Marczak et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib45" title="">2015</a>)</cite>.
If <math alttext="M" class="ltx_Math" display="inline" id="S3.p2.4.m4.1"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.1d">italic_M</annotation></semantics></math> is <span class="ltx_text ltx_font_italic" id="S3.p2.12.1">off-path</span>, <math alttext="M" class="ltx_Math" display="inline" id="S3.p2.5.m5.1"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.1d">italic_M</annotation></semantics></math> does not receive any traffic between <math alttext="A" class="ltx_Math" display="inline" id="S3.p2.6.m6.1"><semantics id="S3.p2.6.m6.1a"><mi id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m6.1d">italic_A</annotation></semantics></math> and <math alttext="B" class="ltx_Math" display="inline" id="S3.p2.7.m7.1"><semantics id="S3.p2.7.m7.1a"><mi id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><ci id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m7.1d">italic_B</annotation></semantics></math>.
Instead, <math alttext="M" class="ltx_Math" display="inline" id="S3.p2.8.m8.1"><semantics id="S3.p2.8.m8.1a"><mi id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><ci id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.m8.1d">italic_M</annotation></semantics></math> must actively <span class="ltx_text ltx_font_italic" id="S3.p2.12.2">probe</span> these machines by sending them packets and inspecting their responses to learn anything about their states.
An <span class="ltx_text ltx_font_italic" id="S3.p2.12.3">on-path</span> machine passively receives all traffic between <math alttext="A" class="ltx_Math" display="inline" id="S3.p2.9.m9.1"><semantics id="S3.p2.9.m9.1a"><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.m9.1d">italic_A</annotation></semantics></math> and <math alttext="B" class="ltx_Math" display="inline" id="S3.p2.10.m10.1"><semantics id="S3.p2.10.m10.1a"><mi id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.1b"><ci id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.p2.10.m10.1d">italic_B</annotation></semantics></math> but cannot modify it directly; an <span class="ltx_text ltx_font_italic" id="S3.p2.12.4">in-path</span> machine (i.e., a “man-in-the-middle”) receives and can modify all traffic between <math alttext="A" class="ltx_Math" display="inline" id="S3.p2.11.m11.1"><semantics id="S3.p2.11.m11.1a"><mi id="S3.p2.11.m11.1.1" xref="S3.p2.11.m11.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.p2.11.m11.1b"><ci id="S3.p2.11.m11.1.1.cmml" xref="S3.p2.11.m11.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m11.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.p2.11.m11.1d">italic_A</annotation></semantics></math> and <math alttext="B" class="ltx_Math" display="inline" id="S3.p2.12.m12.1"><semantics id="S3.p2.12.m12.1a"><mi id="S3.p2.12.m12.1.1" xref="S3.p2.12.m12.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.p2.12.m12.1b"><ci id="S3.p2.12.m12.1.1.cmml" xref="S3.p2.12.m12.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m12.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.p2.12.m12.1d">italic_B</annotation></semantics></math>.
For example, if an ISP were to forward copies of its traffic to its government, the ISP is in-path and the government is on-path.
We are primarily concerned with off-path exploits, since these rely on side channels like IPIDs for information.
They are also the most powerful in practice, since they are usable by any unprivileged adversary without ISP or nation-state control over network infrastructure.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Probe Comparisons</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">A <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.1.1">probe comparison</span> tracks changes in IPIDs over time to infer information about other machines.
As such, most probe comparisons are measurements.
The inferred information is typically binary: whether a target port is open or closed, a firewall is performing egress or ingress filtering, a guessed secret value is correct or incorrect, and so on.
Probe comparisons come in many forms, but the archetypal approach for an off-path measurer or attacker works as follows:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">Probe the target machine’s relevant IPID, obtaining value <math alttext="x" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1"><semantics id="S3.I1.i1.p1.1.m1.1a"><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.1d">italic_x</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">Interact with the target machine such that its IPID values change one way if the inferred information is “true” (e.g., the target port is open, a firewall is performing egress filtering, a guessed secret value is correct, etc.) and some other way otherwise.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(3)</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">Probe the target machine’s relevant IPID again, obtaining a new value <math alttext="y" class="ltx_Math" display="inline" id="S3.I1.i3.p1.1.m1.1"><semantics id="S3.I1.i3.p1.1.m1.1a"><mi id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><ci id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.1.m1.1d">italic_y</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(4)</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.2">Based on the interactions in Step (2), compare <math alttext="x" class="ltx_Math" display="inline" id="S3.I1.i4.p1.1.m1.1"><semantics id="S3.I1.i4.p1.1.m1.1a"><mi id="S3.I1.i4.p1.1.m1.1.1" xref="S3.I1.i4.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.1.m1.1b"><ci id="S3.I1.i4.p1.1.m1.1.1.cmml" xref="S3.I1.i4.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i4.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i4.p1.1.m1.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S3.I1.i4.p1.2.m2.1"><semantics id="S3.I1.i4.p1.2.m2.1a"><mi id="S3.I1.i4.p1.2.m2.1.1" xref="S3.I1.i4.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.2.m2.1b"><ci id="S3.I1.i4.p1.2.m2.1.1.cmml" xref="S3.I1.i4.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i4.p1.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i4.p1.2.m2.1d">italic_y</annotation></semantics></math> to gather evidence about whether the inferred information is “true”.
Repeat Steps (1)–(3) as needed to gain statistical confidence.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S3.SS1.p1.2">From this outline, we can characterize two necessary conditions for successful probe comparisons:</p>
<ol class="ltx_enumerate" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(PC1)</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1">A measurer or attacker must be able to probe and interact with a target machine’s relevant IPID selection mechanism, either directly or indirectly, in a timely manner.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(PC2)</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1">A measurer or attacker must be able to correlate its interactions with the target machine to observable changes in the target machine’s IPID values.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">The remainder of this section summarizes seven probe comparison exploits, including idle scans (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS1" title="3.1.1. Idle Scans ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>), triangular spamming (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS2" title="3.1.2. Triangular Spamming ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.2</span></a>), on-path NAT measurements (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS3" title="3.1.3. On-Path NAT Measurements ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.3</span></a>), canary fragments (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS4" title="3.1.4. Canary Fragments ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.4</span></a>), bucket leaks (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS5" title="3.1.5. Bucket Leaks ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.5</span></a>), TCP injection attacks (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS6" title="3.1.6. TCP Injection Attacks ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.6</span></a>), and covert channels (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS7" title="3.1.7. Covert Channels ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.7</span></a>).</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1. </span>Idle Scans</h4>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="1282" id="S3.F3.sf1.g1" src="x3.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.sf1.4.2.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S3.F3.sf1.2.1" style="font-size:90%;">The targeted port on <math alttext="T" class="ltx_Math" display="inline" id="S3.F3.sf1.2.1.m1.1"><semantics id="S3.F3.sf1.2.1.m1.1b"><mi id="S3.F3.sf1.2.1.m1.1.1" xref="S3.F3.sf1.2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.2.1.m1.1c"><ci id="S3.F3.sf1.2.1.m1.1.1.cmml" xref="S3.F3.sf1.2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.2.1.m1.1d">T</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf1.2.1.m1.1e">italic_T</annotation></semantics></math> is closed.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="1282" id="S3.F3.sf2.g1" src="x4.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.sf2.4.2.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S3.F3.sf2.2.1" style="font-size:90%;">The targeted port on <math alttext="T" class="ltx_Math" display="inline" id="S3.F3.sf2.2.1.m1.1"><semantics id="S3.F3.sf2.2.1.m1.1b"><mi id="S3.F3.sf2.2.1.m1.1.1" xref="S3.F3.sf2.2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.F3.sf2.2.1.m1.1c"><ci id="S3.F3.sf2.2.1.m1.1.1.cmml" xref="S3.F3.sf2.2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf2.2.1.m1.1d">T</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf2.2.1.m1.1e">italic_T</annotation></semantics></math> is open.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.39.19.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text ltx_font_italic" id="S3.F3.36.18" style="font-size:90%;">Idle Scan Execution.<span class="ltx_text ltx_font_upright" id="S3.F3.36.18.18">
In an idle scan, a measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.F3.19.1.1.m1.1"><semantics id="S3.F3.19.1.1.m1.1b"><mi id="S3.F3.19.1.1.m1.1.1" xref="S3.F3.19.1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F3.19.1.1.m1.1c"><ci id="S3.F3.19.1.1.m1.1.1.cmml" xref="S3.F3.19.1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.19.1.1.m1.1d">M</annotation><annotation encoding="application/x-llamapun" id="S3.F3.19.1.1.m1.1e">italic_M</annotation></semantics></math> is testing whether a target port on another machine <math alttext="T" class="ltx_Math" display="inline" id="S3.F3.20.2.2.m2.1"><semantics id="S3.F3.20.2.2.m2.1b"><mi id="S3.F3.20.2.2.m2.1.1" xref="S3.F3.20.2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.F3.20.2.2.m2.1c"><ci id="S3.F3.20.2.2.m2.1.1.cmml" xref="S3.F3.20.2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.20.2.2.m2.1d">T</annotation><annotation encoding="application/x-llamapun" id="S3.F3.20.2.2.m2.1e">italic_T</annotation></semantics></math> is open.
Measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.F3.21.3.3.m3.1"><semantics id="S3.F3.21.3.3.m3.1b"><mi id="S3.F3.21.3.3.m3.1.1" xref="S3.F3.21.3.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F3.21.3.3.m3.1c"><ci id="S3.F3.21.3.3.m3.1.1.cmml" xref="S3.F3.21.3.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.21.3.3.m3.1d">M</annotation><annotation encoding="application/x-llamapun" id="S3.F3.21.3.3.m3.1e">italic_M</annotation></semantics></math> first probes the zombie machine <math alttext="Z" class="ltx_Math" display="inline" id="S3.F3.22.4.4.m4.1"><semantics id="S3.F3.22.4.4.m4.1b"><mi id="S3.F3.22.4.4.m4.1.1" xref="S3.F3.22.4.4.m4.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.F3.22.4.4.m4.1c"><ci id="S3.F3.22.4.4.m4.1.1.cmml" xref="S3.F3.22.4.4.m4.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.22.4.4.m4.1d">Z</annotation><annotation encoding="application/x-llamapun" id="S3.F3.22.4.4.m4.1e">italic_Z</annotation></semantics></math>’s current IPID, <math alttext="x" class="ltx_Math" display="inline" id="S3.F3.23.5.5.m5.1"><semantics id="S3.F3.23.5.5.m5.1b"><mi id="S3.F3.23.5.5.m5.1.1" xref="S3.F3.23.5.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.F3.23.5.5.m5.1c"><ci id="S3.F3.23.5.5.m5.1.1.cmml" xref="S3.F3.23.5.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.23.5.5.m5.1d">x</annotation><annotation encoding="application/x-llamapun" id="S3.F3.23.5.5.m5.1e">italic_x</annotation></semantics></math>.
It then spoofs a SYN packet to the target machine <math alttext="T" class="ltx_Math" display="inline" id="S3.F3.24.6.6.m6.1"><semantics id="S3.F3.24.6.6.m6.1b"><mi id="S3.F3.24.6.6.m6.1.1" xref="S3.F3.24.6.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.F3.24.6.6.m6.1c"><ci id="S3.F3.24.6.6.m6.1.1.cmml" xref="S3.F3.24.6.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.24.6.6.m6.1d">T</annotation><annotation encoding="application/x-llamapun" id="S3.F3.24.6.6.m6.1e">italic_T</annotation></semantics></math> that appears to have come from <math alttext="Z" class="ltx_Math" display="inline" id="S3.F3.25.7.7.m7.1"><semantics id="S3.F3.25.7.7.m7.1b"><mi id="S3.F3.25.7.7.m7.1.1" xref="S3.F3.25.7.7.m7.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.F3.25.7.7.m7.1c"><ci id="S3.F3.25.7.7.m7.1.1.cmml" xref="S3.F3.25.7.7.m7.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.25.7.7.m7.1d">Z</annotation><annotation encoding="application/x-llamapun" id="S3.F3.25.7.7.m7.1e">italic_Z</annotation></semantics></math>.
(a) If the target port on <math alttext="T" class="ltx_Math" display="inline" id="S3.F3.26.8.8.m8.1"><semantics id="S3.F3.26.8.8.m8.1b"><mi id="S3.F3.26.8.8.m8.1.1" xref="S3.F3.26.8.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.F3.26.8.8.m8.1c"><ci id="S3.F3.26.8.8.m8.1.1.cmml" xref="S3.F3.26.8.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.26.8.8.m8.1d">T</annotation><annotation encoding="application/x-llamapun" id="S3.F3.26.8.8.m8.1e">italic_T</annotation></semantics></math> is closed (red X), then <math alttext="T" class="ltx_Math" display="inline" id="S3.F3.27.9.9.m9.1"><semantics id="S3.F3.27.9.9.m9.1b"><mi id="S3.F3.27.9.9.m9.1.1" xref="S3.F3.27.9.9.m9.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.F3.27.9.9.m9.1c"><ci id="S3.F3.27.9.9.m9.1.1.cmml" xref="S3.F3.27.9.9.m9.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.27.9.9.m9.1d">T</annotation><annotation encoding="application/x-llamapun" id="S3.F3.27.9.9.m9.1e">italic_T</annotation></semantics></math> does not respond and <math alttext="M" class="ltx_Math" display="inline" id="S3.F3.28.10.10.m10.1"><semantics id="S3.F3.28.10.10.m10.1b"><mi id="S3.F3.28.10.10.m10.1.1" xref="S3.F3.28.10.10.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F3.28.10.10.m10.1c"><ci id="S3.F3.28.10.10.m10.1.1.cmml" xref="S3.F3.28.10.10.m10.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.28.10.10.m10.1d">M</annotation><annotation encoding="application/x-llamapun" id="S3.F3.28.10.10.m10.1e">italic_M</annotation></semantics></math>’s final probe of <math alttext="Z" class="ltx_Math" display="inline" id="S3.F3.29.11.11.m11.1"><semantics id="S3.F3.29.11.11.m11.1b"><mi id="S3.F3.29.11.11.m11.1.1" xref="S3.F3.29.11.11.m11.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.F3.29.11.11.m11.1c"><ci id="S3.F3.29.11.11.m11.1.1.cmml" xref="S3.F3.29.11.11.m11.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.29.11.11.m11.1d">Z</annotation><annotation encoding="application/x-llamapun" id="S3.F3.29.11.11.m11.1e">italic_Z</annotation></semantics></math>’s IPID is <math alttext="x+1\bmod 2^{16}" class="ltx_Math" display="inline" id="S3.F3.30.12.12.m12.1"><semantics id="S3.F3.30.12.12.m12.1b"><mrow id="S3.F3.30.12.12.m12.1.1" xref="S3.F3.30.12.12.m12.1.1.cmml"><mrow id="S3.F3.30.12.12.m12.1.1.2" xref="S3.F3.30.12.12.m12.1.1.2.cmml"><mi id="S3.F3.30.12.12.m12.1.1.2.2" xref="S3.F3.30.12.12.m12.1.1.2.2.cmml">x</mi><mo id="S3.F3.30.12.12.m12.1.1.2.1" xref="S3.F3.30.12.12.m12.1.1.2.1.cmml">+</mo><mn id="S3.F3.30.12.12.m12.1.1.2.3" xref="S3.F3.30.12.12.m12.1.1.2.3.cmml">1</mn></mrow><mo id="S3.F3.30.12.12.m12.1.1.1" xref="S3.F3.30.12.12.m12.1.1.1.cmml">mod</mo><msup id="S3.F3.30.12.12.m12.1.1.3" xref="S3.F3.30.12.12.m12.1.1.3.cmml"><mn id="S3.F3.30.12.12.m12.1.1.3.2" xref="S3.F3.30.12.12.m12.1.1.3.2.cmml">2</mn><mn id="S3.F3.30.12.12.m12.1.1.3.3" xref="S3.F3.30.12.12.m12.1.1.3.3.cmml">16</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.30.12.12.m12.1c"><apply id="S3.F3.30.12.12.m12.1.1.cmml" xref="S3.F3.30.12.12.m12.1.1"><csymbol cd="latexml" id="S3.F3.30.12.12.m12.1.1.1.cmml" xref="S3.F3.30.12.12.m12.1.1.1">modulo</csymbol><apply id="S3.F3.30.12.12.m12.1.1.2.cmml" xref="S3.F3.30.12.12.m12.1.1.2"><plus id="S3.F3.30.12.12.m12.1.1.2.1.cmml" xref="S3.F3.30.12.12.m12.1.1.2.1"></plus><ci id="S3.F3.30.12.12.m12.1.1.2.2.cmml" xref="S3.F3.30.12.12.m12.1.1.2.2">𝑥</ci><cn id="S3.F3.30.12.12.m12.1.1.2.3.cmml" type="integer" xref="S3.F3.30.12.12.m12.1.1.2.3">1</cn></apply><apply id="S3.F3.30.12.12.m12.1.1.3.cmml" xref="S3.F3.30.12.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.F3.30.12.12.m12.1.1.3.1.cmml" xref="S3.F3.30.12.12.m12.1.1.3">superscript</csymbol><cn id="S3.F3.30.12.12.m12.1.1.3.2.cmml" type="integer" xref="S3.F3.30.12.12.m12.1.1.3.2">2</cn><cn id="S3.F3.30.12.12.m12.1.1.3.3.cmml" type="integer" xref="S3.F3.30.12.12.m12.1.1.3.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.30.12.12.m12.1d">x+1\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.30.12.12.m12.1e">italic_x + 1 roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>.
(b) Otherwise, if the target port on <math alttext="T" class="ltx_Math" display="inline" id="S3.F3.31.13.13.m13.1"><semantics id="S3.F3.31.13.13.m13.1b"><mi id="S3.F3.31.13.13.m13.1.1" xref="S3.F3.31.13.13.m13.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.F3.31.13.13.m13.1c"><ci id="S3.F3.31.13.13.m13.1.1.cmml" xref="S3.F3.31.13.13.m13.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.31.13.13.m13.1d">T</annotation><annotation encoding="application/x-llamapun" id="S3.F3.31.13.13.m13.1e">italic_T</annotation></semantics></math> is open (blue circle), the resulting interaction between <math alttext="T" class="ltx_Math" display="inline" id="S3.F3.32.14.14.m14.1"><semantics id="S3.F3.32.14.14.m14.1b"><mi id="S3.F3.32.14.14.m14.1.1" xref="S3.F3.32.14.14.m14.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.F3.32.14.14.m14.1c"><ci id="S3.F3.32.14.14.m14.1.1.cmml" xref="S3.F3.32.14.14.m14.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.32.14.14.m14.1d">T</annotation><annotation encoding="application/x-llamapun" id="S3.F3.32.14.14.m14.1e">italic_T</annotation></semantics></math> and <math alttext="Z" class="ltx_Math" display="inline" id="S3.F3.33.15.15.m15.1"><semantics id="S3.F3.33.15.15.m15.1b"><mi id="S3.F3.33.15.15.m15.1.1" xref="S3.F3.33.15.15.m15.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.F3.33.15.15.m15.1c"><ci id="S3.F3.33.15.15.m15.1.1.cmml" xref="S3.F3.33.15.15.m15.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.33.15.15.m15.1d">Z</annotation><annotation encoding="application/x-llamapun" id="S3.F3.33.15.15.m15.1e">italic_Z</annotation></semantics></math> causes <math alttext="M" class="ltx_Math" display="inline" id="S3.F3.34.16.16.m16.1"><semantics id="S3.F3.34.16.16.m16.1b"><mi id="S3.F3.34.16.16.m16.1.1" xref="S3.F3.34.16.16.m16.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F3.34.16.16.m16.1c"><ci id="S3.F3.34.16.16.m16.1.1.cmml" xref="S3.F3.34.16.16.m16.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.34.16.16.m16.1d">M</annotation><annotation encoding="application/x-llamapun" id="S3.F3.34.16.16.m16.1e">italic_M</annotation></semantics></math>’s final probe of <math alttext="Z" class="ltx_Math" display="inline" id="S3.F3.35.17.17.m17.1"><semantics id="S3.F3.35.17.17.m17.1b"><mi id="S3.F3.35.17.17.m17.1.1" xref="S3.F3.35.17.17.m17.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.F3.35.17.17.m17.1c"><ci id="S3.F3.35.17.17.m17.1.1.cmml" xref="S3.F3.35.17.17.m17.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.35.17.17.m17.1d">Z</annotation><annotation encoding="application/x-llamapun" id="S3.F3.35.17.17.m17.1e">italic_Z</annotation></semantics></math>’s IPID to be <math alttext="x+2\bmod 2^{16}" class="ltx_Math" display="inline" id="S3.F3.36.18.18.m18.1"><semantics id="S3.F3.36.18.18.m18.1b"><mrow id="S3.F3.36.18.18.m18.1.1" xref="S3.F3.36.18.18.m18.1.1.cmml"><mrow id="S3.F3.36.18.18.m18.1.1.2" xref="S3.F3.36.18.18.m18.1.1.2.cmml"><mi id="S3.F3.36.18.18.m18.1.1.2.2" xref="S3.F3.36.18.18.m18.1.1.2.2.cmml">x</mi><mo id="S3.F3.36.18.18.m18.1.1.2.1" xref="S3.F3.36.18.18.m18.1.1.2.1.cmml">+</mo><mn id="S3.F3.36.18.18.m18.1.1.2.3" xref="S3.F3.36.18.18.m18.1.1.2.3.cmml">2</mn></mrow><mo id="S3.F3.36.18.18.m18.1.1.1" xref="S3.F3.36.18.18.m18.1.1.1.cmml">mod</mo><msup id="S3.F3.36.18.18.m18.1.1.3" xref="S3.F3.36.18.18.m18.1.1.3.cmml"><mn id="S3.F3.36.18.18.m18.1.1.3.2" xref="S3.F3.36.18.18.m18.1.1.3.2.cmml">2</mn><mn id="S3.F3.36.18.18.m18.1.1.3.3" xref="S3.F3.36.18.18.m18.1.1.3.3.cmml">16</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.36.18.18.m18.1c"><apply id="S3.F3.36.18.18.m18.1.1.cmml" xref="S3.F3.36.18.18.m18.1.1"><csymbol cd="latexml" id="S3.F3.36.18.18.m18.1.1.1.cmml" xref="S3.F3.36.18.18.m18.1.1.1">modulo</csymbol><apply id="S3.F3.36.18.18.m18.1.1.2.cmml" xref="S3.F3.36.18.18.m18.1.1.2"><plus id="S3.F3.36.18.18.m18.1.1.2.1.cmml" xref="S3.F3.36.18.18.m18.1.1.2.1"></plus><ci id="S3.F3.36.18.18.m18.1.1.2.2.cmml" xref="S3.F3.36.18.18.m18.1.1.2.2">𝑥</ci><cn id="S3.F3.36.18.18.m18.1.1.2.3.cmml" type="integer" xref="S3.F3.36.18.18.m18.1.1.2.3">2</cn></apply><apply id="S3.F3.36.18.18.m18.1.1.3.cmml" xref="S3.F3.36.18.18.m18.1.1.3"><csymbol cd="ambiguous" id="S3.F3.36.18.18.m18.1.1.3.1.cmml" xref="S3.F3.36.18.18.m18.1.1.3">superscript</csymbol><cn id="S3.F3.36.18.18.m18.1.1.3.2.cmml" type="integer" xref="S3.F3.36.18.18.m18.1.1.3.2">2</cn><cn id="S3.F3.36.18.18.m18.1.1.3.3.cmml" type="integer" xref="S3.F3.36.18.18.m18.1.1.3.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.36.18.18.m18.1d">x+2\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.36.18.18.m18.1e">italic_x + 2 roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.20">The earliest known IPID-based measurement is the <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS1.p1.20.1">idle scan</span> which exploits the predictability of globally incrementing IPIDs to reveal off-path connections <cite class="ltx_cite ltx_citemacro_citep">(antirez, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib3" title="">1998</a>; de Vivo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib16" title="">1999</a>; Handley et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib27" title="">2001</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>A).
An off-path measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.1.m1.1"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mi id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.1.m1.1d">italic_M</annotation></semantics></math> can learn whether a target machine <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.2.m2.1"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mi id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><ci id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.2.m2.1d">italic_T</annotation></semantics></math> has a certain port open by probing the IPIDs of an intermediate “zombie” machine <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.3.m3.1"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><mi id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><ci id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.3.m3.1d">italic_Z</annotation></semantics></math> with low traffic rates (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F3" title="Figure 3 ‣ 3.1.1. Idle Scans ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3</span></a>).
First, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.4.m4.1"><semantics id="S3.SS1.SSS1.p1.4.m4.1a"><mi id="S3.SS1.SSS1.p1.4.m4.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.4.m4.1b"><ci id="S3.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.4.m4.1d">italic_M</annotation></semantics></math> sends <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.5.m5.1"><semantics id="S3.SS1.SSS1.p1.5.m5.1a"><mi id="S3.SS1.SSS1.p1.5.m5.1.1" xref="S3.SS1.SSS1.p1.5.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m5.1b"><ci id="S3.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m5.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.5.m5.1d">italic_Z</annotation></semantics></math> an unsolicited SYN/ACK packet, to which <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.6.m6.1"><semantics id="S3.SS1.SSS1.p1.6.m6.1a"><mi id="S3.SS1.SSS1.p1.6.m6.1.1" xref="S3.SS1.SSS1.p1.6.m6.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m6.1b"><ci id="S3.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m6.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.6.m6.1d">italic_Z</annotation></semantics></math> replies with an RST packet that contains its current IPID, say <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.7.m7.1"><semantics id="S3.SS1.SSS1.p1.7.m7.1a"><mi id="S3.SS1.SSS1.p1.7.m7.1.1" xref="S3.SS1.SSS1.p1.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.7.m7.1b"><ci id="S3.SS1.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.7.m7.1d">italic_x</annotation></semantics></math>.
Machine <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.8.m8.1"><semantics id="S3.SS1.SSS1.p1.8.m8.1a"><mi id="S3.SS1.SSS1.p1.8.m8.1.1" xref="S3.SS1.SSS1.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.8.m8.1b"><ci id="S3.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.8.m8.1d">italic_M</annotation></semantics></math> then sends a spoofed SYN packet to <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.9.m9.1"><semantics id="S3.SS1.SSS1.p1.9.m9.1a"><mi id="S3.SS1.SSS1.p1.9.m9.1.1" xref="S3.SS1.SSS1.p1.9.m9.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.9.m9.1b"><ci id="S3.SS1.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS1.p1.9.m9.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.9.m9.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.9.m9.1d">italic_T</annotation></semantics></math> appearing to originate from <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.10.m10.1"><semantics id="S3.SS1.SSS1.p1.10.m10.1a"><mi id="S3.SS1.SSS1.p1.10.m10.1.1" xref="S3.SS1.SSS1.p1.10.m10.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.10.m10.1b"><ci id="S3.SS1.SSS1.p1.10.m10.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m10.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.10.m10.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.10.m10.1d">italic_Z</annotation></semantics></math> that specifies the target port it wants to scan.
If this port is closed, nothing comes of this spoofed packet (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F3.sf1" title="In Figure 3 ‣ 3.1.1. Idle Scans ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3(a)</span></a>); otherwise, if it is open, <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.11.m11.1"><semantics id="S3.SS1.SSS1.p1.11.m11.1a"><mi id="S3.SS1.SSS1.p1.11.m11.1.1" xref="S3.SS1.SSS1.p1.11.m11.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.11.m11.1b"><ci id="S3.SS1.SSS1.p1.11.m11.1.1.cmml" xref="S3.SS1.SSS1.p1.11.m11.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.11.m11.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.11.m11.1d">italic_T</annotation></semantics></math> replies to <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.12.m12.1"><semantics id="S3.SS1.SSS1.p1.12.m12.1a"><mi id="S3.SS1.SSS1.p1.12.m12.1.1" xref="S3.SS1.SSS1.p1.12.m12.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.12.m12.1b"><ci id="S3.SS1.SSS1.p1.12.m12.1.1.cmml" xref="S3.SS1.SSS1.p1.12.m12.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.12.m12.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.12.m12.1d">italic_Z</annotation></semantics></math> with a SYN/ACK, which in turn causes <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.13.m13.1"><semantics id="S3.SS1.SSS1.p1.13.m13.1a"><mi id="S3.SS1.SSS1.p1.13.m13.1.1" xref="S3.SS1.SSS1.p1.13.m13.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.13.m13.1b"><ci id="S3.SS1.SSS1.p1.13.m13.1.1.cmml" xref="S3.SS1.SSS1.p1.13.m13.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.13.m13.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.13.m13.1d">italic_Z</annotation></semantics></math> to reply to <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.14.m14.1"><semantics id="S3.SS1.SSS1.p1.14.m14.1a"><mi id="S3.SS1.SSS1.p1.14.m14.1.1" xref="S3.SS1.SSS1.p1.14.m14.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.14.m14.1b"><ci id="S3.SS1.SSS1.p1.14.m14.1.1.cmml" xref="S3.SS1.SSS1.p1.14.m14.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.14.m14.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.14.m14.1d">italic_T</annotation></semantics></math> with an RST containing an incremented IPID (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F3.sf2" title="In Figure 3 ‣ 3.1.1. Idle Scans ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3(b)</span></a>).
Finally, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.15.m15.1"><semantics id="S3.SS1.SSS1.p1.15.m15.1a"><mi id="S3.SS1.SSS1.p1.15.m15.1.1" xref="S3.SS1.SSS1.p1.15.m15.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.15.m15.1b"><ci id="S3.SS1.SSS1.p1.15.m15.1.1.cmml" xref="S3.SS1.SSS1.p1.15.m15.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.15.m15.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.15.m15.1d">italic_M</annotation></semantics></math> again sends <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.16.m16.1"><semantics id="S3.SS1.SSS1.p1.16.m16.1a"><mi id="S3.SS1.SSS1.p1.16.m16.1.1" xref="S3.SS1.SSS1.p1.16.m16.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.16.m16.1b"><ci id="S3.SS1.SSS1.p1.16.m16.1.1.cmml" xref="S3.SS1.SSS1.p1.16.m16.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.16.m16.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.16.m16.1d">italic_Z</annotation></semantics></math> an unsolicited SYN/ACK and inspects the incremented IPID <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.17.m17.1"><semantics id="S3.SS1.SSS1.p1.17.m17.1a"><mi id="S3.SS1.SSS1.p1.17.m17.1.1" xref="S3.SS1.SSS1.p1.17.m17.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.17.m17.1b"><ci id="S3.SS1.SSS1.p1.17.m17.1.1.cmml" xref="S3.SS1.SSS1.p1.17.m17.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.17.m17.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.17.m17.1d">italic_y</annotation></semantics></math> of the RST reply.
If <math alttext="y\equiv x+2\bmod 2^{16}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.18.m18.1"><semantics id="S3.SS1.SSS1.p1.18.m18.1a"><mrow id="S3.SS1.SSS1.p1.18.m18.1.1" xref="S3.SS1.SSS1.p1.18.m18.1.1.cmml"><mi id="S3.SS1.SSS1.p1.18.m18.1.1.2" xref="S3.SS1.SSS1.p1.18.m18.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS1.p1.18.m18.1.1.1" xref="S3.SS1.SSS1.p1.18.m18.1.1.1.cmml">≡</mo><mrow id="S3.SS1.SSS1.p1.18.m18.1.1.3" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.cmml"><mrow id="S3.SS1.SSS1.p1.18.m18.1.1.3.2" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.2.cmml"><mi id="S3.SS1.SSS1.p1.18.m18.1.1.3.2.2" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.2.2.cmml">x</mi><mo id="S3.SS1.SSS1.p1.18.m18.1.1.3.2.1" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.SSS1.p1.18.m18.1.1.3.2.3" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.2.3.cmml">2</mn></mrow><mo id="S3.SS1.SSS1.p1.18.m18.1.1.3.1" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.1.cmml">mod</mo><msup id="S3.SS1.SSS1.p1.18.m18.1.1.3.3" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.3.cmml"><mn id="S3.SS1.SSS1.p1.18.m18.1.1.3.3.2" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.3.2.cmml">2</mn><mn id="S3.SS1.SSS1.p1.18.m18.1.1.3.3.3" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.18.m18.1b"><apply id="S3.SS1.SSS1.p1.18.m18.1.1.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1"><equivalent id="S3.SS1.SSS1.p1.18.m18.1.1.1.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.1"></equivalent><ci id="S3.SS1.SSS1.p1.18.m18.1.1.2.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.2">𝑦</ci><apply id="S3.SS1.SSS1.p1.18.m18.1.1.3.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.3"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.18.m18.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.1">modulo</csymbol><apply id="S3.SS1.SSS1.p1.18.m18.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.2"><plus id="S3.SS1.SSS1.p1.18.m18.1.1.3.2.1.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.2.1"></plus><ci id="S3.SS1.SSS1.p1.18.m18.1.1.3.2.2.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.2.2">𝑥</ci><cn id="S3.SS1.SSS1.p1.18.m18.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.2.3">2</cn></apply><apply id="S3.SS1.SSS1.p1.18.m18.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.18.m18.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.3">superscript</csymbol><cn id="S3.SS1.SSS1.p1.18.m18.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.3.2">2</cn><cn id="S3.SS1.SSS1.p1.18.m18.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.18.m18.1.1.3.3.3">16</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.18.m18.1c">y\equiv x+2\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.18.m18.1d">italic_y ≡ italic_x + 2 roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.19.m19.1"><semantics id="S3.SS1.SSS1.p1.19.m19.1a"><mi id="S3.SS1.SSS1.p1.19.m19.1.1" xref="S3.SS1.SSS1.p1.19.m19.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.19.m19.1b"><ci id="S3.SS1.SSS1.p1.19.m19.1.1.cmml" xref="S3.SS1.SSS1.p1.19.m19.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.19.m19.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.19.m19.1d">italic_M</annotation></semantics></math> concludes the target port is open; otherwise, if <math alttext="y\equiv x+1\bmod 2^{16}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.20.m20.1"><semantics id="S3.SS1.SSS1.p1.20.m20.1a"><mrow id="S3.SS1.SSS1.p1.20.m20.1.1" xref="S3.SS1.SSS1.p1.20.m20.1.1.cmml"><mi id="S3.SS1.SSS1.p1.20.m20.1.1.2" xref="S3.SS1.SSS1.p1.20.m20.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS1.p1.20.m20.1.1.1" xref="S3.SS1.SSS1.p1.20.m20.1.1.1.cmml">≡</mo><mrow id="S3.SS1.SSS1.p1.20.m20.1.1.3" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.cmml"><mrow id="S3.SS1.SSS1.p1.20.m20.1.1.3.2" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.2.cmml"><mi id="S3.SS1.SSS1.p1.20.m20.1.1.3.2.2" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.2.2.cmml">x</mi><mo id="S3.SS1.SSS1.p1.20.m20.1.1.3.2.1" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.SSS1.p1.20.m20.1.1.3.2.3" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.SSS1.p1.20.m20.1.1.3.1" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.1.cmml">mod</mo><msup id="S3.SS1.SSS1.p1.20.m20.1.1.3.3" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.3.cmml"><mn id="S3.SS1.SSS1.p1.20.m20.1.1.3.3.2" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.3.2.cmml">2</mn><mn id="S3.SS1.SSS1.p1.20.m20.1.1.3.3.3" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.20.m20.1b"><apply id="S3.SS1.SSS1.p1.20.m20.1.1.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1"><equivalent id="S3.SS1.SSS1.p1.20.m20.1.1.1.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.1"></equivalent><ci id="S3.SS1.SSS1.p1.20.m20.1.1.2.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.2">𝑦</ci><apply id="S3.SS1.SSS1.p1.20.m20.1.1.3.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.3"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.20.m20.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.1">modulo</csymbol><apply id="S3.SS1.SSS1.p1.20.m20.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.2"><plus id="S3.SS1.SSS1.p1.20.m20.1.1.3.2.1.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.2.1"></plus><ci id="S3.SS1.SSS1.p1.20.m20.1.1.3.2.2.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.2.2">𝑥</ci><cn id="S3.SS1.SSS1.p1.20.m20.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.2.3">1</cn></apply><apply id="S3.SS1.SSS1.p1.20.m20.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.20.m20.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.3">superscript</csymbol><cn id="S3.SS1.SSS1.p1.20.m20.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.3.2">2</cn><cn id="S3.SS1.SSS1.p1.20.m20.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.20.m20.1.1.3.3.3">16</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.20.m20.1c">y\equiv x+1\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.20.m20.1d">italic_y ≡ italic_x + 1 roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, it concludes the port is closed or filtered.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p2">
<p class="ltx_p" id="S3.SS1.SSS1.p2.1">As a result of the idle scan’s disclosure, OpenBSD, FreeBSD, and XNU replaced their globally incrementing IPIDs with PRNG selection using Linear Congruential Generators (LCGs) <span class="ltx_ERROR undefined" id="S3.SS1.SSS1.p2.1.1">\added</span>with additional complication layers.
These implementations lasted until 2007 when Klein <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib34" title="">2007</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>E) demonstrated that the “random” values produced by LCGs could be predicted, once again making idle scans possible.
In response, OpenBSD replaced LCGs with an iterated Knuth shuffle (see OpenBSD commit <a class="ltx_ref ltx_href" href="https://github.com/openbsd/src/commit/4fd19fd8c5fe0efc775193f1f0ab218383fe8fcd" title="">4fd19f</a>) while FreeBSD—and later, XNU—chose PRNG selection using searchable queues (see FreeBSD commit <a class="ltx_ref ltx_href" href="https://github.com/freebsd/freebsd-src/commit/361021cc6ee359629b21df3e29c14544d05a38ff" title="">361021</a> and XNU commit <a class="ltx_ref ltx_href" href="https://github.com/apple/darwin-xnu/commit/ff3a0c1e9808972592661c365ab368466b31ab20" title="">ff3a0c</a>).
These implementations remain largely unchanged since their appearances in 2008.
Linux took a different approach, implementing a hybrid of per-connection selection (for atomic packets) and per-destination selection (for non-atomic packets).
Windows retained globally incrementing IPIDs until Windows 8, which was released in 2012 <cite class="ltx_cite ltx_citemacro_citep">(Orevi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib49" title="">2018</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p3">
<p class="ltx_p" id="S3.SS1.SSS1.p3.1">Despite these changes, delayed patching gave ample opportunity for the idle scan’s wide adoption and refinement.
Nmap integrated it as a scanning option in 2001 <cite class="ltx_cite ltx_citemacro_citep">(Lyon, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib43" title="">2009</a>)</cite>.
Chen et al. <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib15" title="">2005</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>C) introduced an extension that additionally inferred packet loss, duplication, and arrival order; server traffic rates; and the number of servers in a load-balanced deployment.
Later, Ensafi et al. <cite class="ltx_cite ltx_citemacro_citep">(Ensafi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib18" title="">2014</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>L) improved the idle scan to detect off-path SYN/ACK and RST filtering between machines <cite class="ltx_cite ltx_citemacro_citep">(Ensafi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib19" title="">2010</a>)</cite>, which in turn was leveraged for Internet-wide censorship measurement <cite class="ltx_cite ltx_citemacro_citep">(Ensafi, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib17" title="">2014</a>; Ensafi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib20" title="">2015</a>; Pearce et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib53" title="">2017</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>P).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2. </span>Triangular Spamming</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">Qian et al. <cite class="ltx_cite ltx_citemacro_citep">(Qian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib56" title="">2010</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>F) formalized <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS2.p1.1.1">triangular spamming</span>, a technique for email spam where a high-bandwidth spammer uses low-bandwidth relay bots to send spam to a target mail server.
By spoofing spam from the relay bots to the mail server, the spammer conceals its own IP address, thus protecting itself from IP block-listing.
For this attack to succeed, the relay bot(s) must receive any SMTP responses from the mail server (typically sent on port 25) and forward them to the spammer (using some other port).
ISPs commonly mitigate spam by blocking outgoing SMTP traffic on port 25 (i.e., egress filtering), stopping machines behind their firewall from participating in spam as relay bots.
Thus, identifying potential relay bot(s) for triangular spamming reduces to finding ISPs that do not block incoming (i.e., ingress) SMTP traffic.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS2.p2">
<p class="ltx_p" id="S3.SS1.SSS2.p2.11">If a potential relay bot <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.1.m1.1"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><mi id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><ci id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.1.m1.1d">italic_R</annotation></semantics></math> uses globally incrementing IPIDs, this can be determined using a simple probe comparison.
The attacker <math alttext="A" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.2.m2.1"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><mi id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><ci id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.2.m2.1d">italic_A</annotation></semantics></math> first probes <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.3.m3.1"><semantics id="S3.SS1.SSS2.p2.3.m3.1a"><mi id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.1b"><ci id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.3.m3.1d">italic_R</annotation></semantics></math> with an unsolicited SYN/ACK on port 80 and records the IPID <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.4.m4.1"><semantics id="S3.SS1.SSS2.p2.4.m4.1a"><mi id="S3.SS1.SSS2.p2.4.m4.1.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m4.1b"><ci id="S3.SS1.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.4.m4.1d">italic_x</annotation></semantics></math> of the RST reply.
It then sends a large burst of <math alttext="s\gg 1" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.5.m5.1"><semantics id="S3.SS1.SSS2.p2.5.m5.1a"><mrow id="S3.SS1.SSS2.p2.5.m5.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.1.1.2" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.cmml">s</mi><mo id="S3.SS1.SSS2.p2.5.m5.1.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.1.cmml">≫</mo><mn id="S3.SS1.SSS2.p2.5.m5.1.1.3" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m5.1b"><apply id="S3.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.1">much-greater-than</csymbol><ci id="S3.SS1.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.2">𝑠</ci><cn id="S3.SS1.SSS2.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.SS1.SSS2.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m5.1c">s\gg 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.5.m5.1d">italic_s ≫ 1</annotation></semantics></math> probes on port 25 which—if inbound traffic is not blocked by the ISP—each increment the global IPID counter on <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.6.m6.1"><semantics id="S3.SS1.SSS2.p2.6.m6.1a"><mi id="S3.SS1.SSS2.p2.6.m6.1.1" xref="S3.SS1.SSS2.p2.6.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.6.m6.1b"><ci id="S3.SS1.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.6.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.6.m6.1d">italic_R</annotation></semantics></math>.
Finally, <math alttext="A" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.7.m7.1"><semantics id="S3.SS1.SSS2.p2.7.m7.1a"><mi id="S3.SS1.SSS2.p2.7.m7.1.1" xref="S3.SS1.SSS2.p2.7.m7.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.7.m7.1b"><ci id="S3.SS1.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m7.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.7.m7.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.7.m7.1d">italic_A</annotation></semantics></math> again probes <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.8.m8.1"><semantics id="S3.SS1.SSS2.p2.8.m8.1a"><mi id="S3.SS1.SSS2.p2.8.m8.1.1" xref="S3.SS1.SSS2.p2.8.m8.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.8.m8.1b"><ci id="S3.SS1.SSS2.p2.8.m8.1.1.cmml" xref="S3.SS1.SSS2.p2.8.m8.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.8.m8.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.8.m8.1d">italic_R</annotation></semantics></math> on port 80 to obtain its updated IPID <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.9.m9.1"><semantics id="S3.SS1.SSS2.p2.9.m9.1a"><mi id="S3.SS1.SSS2.p2.9.m9.1.1" xref="S3.SS1.SSS2.p2.9.m9.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.9.m9.1b"><ci id="S3.SS1.SSS2.p2.9.m9.1.1.cmml" xref="S3.SS1.SSS2.p2.9.m9.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.9.m9.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.9.m9.1d">italic_y</annotation></semantics></math>.
If <math alttext="y\approx x+1\bmod 2^{16}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.10.m10.1"><semantics id="S3.SS1.SSS2.p2.10.m10.1a"><mrow id="S3.SS1.SSS2.p2.10.m10.1.1" xref="S3.SS1.SSS2.p2.10.m10.1.1.cmml"><mi id="S3.SS1.SSS2.p2.10.m10.1.1.2" xref="S3.SS1.SSS2.p2.10.m10.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS2.p2.10.m10.1.1.1" xref="S3.SS1.SSS2.p2.10.m10.1.1.1.cmml">≈</mo><mrow id="S3.SS1.SSS2.p2.10.m10.1.1.3" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.cmml"><mrow id="S3.SS1.SSS2.p2.10.m10.1.1.3.2" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.2.cmml"><mi id="S3.SS1.SSS2.p2.10.m10.1.1.3.2.2" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.2.2.cmml">x</mi><mo id="S3.SS1.SSS2.p2.10.m10.1.1.3.2.1" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.SSS2.p2.10.m10.1.1.3.2.3" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.SSS2.p2.10.m10.1.1.3.1" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.1.cmml">mod</mo><msup id="S3.SS1.SSS2.p2.10.m10.1.1.3.3" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.3.cmml"><mn id="S3.SS1.SSS2.p2.10.m10.1.1.3.3.2" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.3.2.cmml">2</mn><mn id="S3.SS1.SSS2.p2.10.m10.1.1.3.3.3" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.10.m10.1b"><apply id="S3.SS1.SSS2.p2.10.m10.1.1.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1"><approx id="S3.SS1.SSS2.p2.10.m10.1.1.1.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.1"></approx><ci id="S3.SS1.SSS2.p2.10.m10.1.1.2.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.2">𝑦</ci><apply id="S3.SS1.SSS2.p2.10.m10.1.1.3.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.3"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.10.m10.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.1">modulo</csymbol><apply id="S3.SS1.SSS2.p2.10.m10.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.2"><plus id="S3.SS1.SSS2.p2.10.m10.1.1.3.2.1.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.2.1"></plus><ci id="S3.SS1.SSS2.p2.10.m10.1.1.3.2.2.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.2.2">𝑥</ci><cn id="S3.SS1.SSS2.p2.10.m10.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.2.3">1</cn></apply><apply id="S3.SS1.SSS2.p2.10.m10.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.10.m10.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.3">superscript</csymbol><cn id="S3.SS1.SSS2.p2.10.m10.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.3.2">2</cn><cn id="S3.SS1.SSS2.p2.10.m10.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.SSS2.p2.10.m10.1.1.3.3.3">16</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.10.m10.1c">y\approx x+1\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.10.m10.1d">italic_y ≈ italic_x + 1 roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, the ISP is likely blocking inbound traffic; otherwise, if <math alttext="y\approx x+s\bmod 2^{16}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.11.m11.1"><semantics id="S3.SS1.SSS2.p2.11.m11.1a"><mrow id="S3.SS1.SSS2.p2.11.m11.1.1" xref="S3.SS1.SSS2.p2.11.m11.1.1.cmml"><mi id="S3.SS1.SSS2.p2.11.m11.1.1.2" xref="S3.SS1.SSS2.p2.11.m11.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS2.p2.11.m11.1.1.1" xref="S3.SS1.SSS2.p2.11.m11.1.1.1.cmml">≈</mo><mrow id="S3.SS1.SSS2.p2.11.m11.1.1.3" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.cmml"><mrow id="S3.SS1.SSS2.p2.11.m11.1.1.3.2" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.2.cmml"><mi id="S3.SS1.SSS2.p2.11.m11.1.1.3.2.2" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.2.2.cmml">x</mi><mo id="S3.SS1.SSS2.p2.11.m11.1.1.3.2.1" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.2.1.cmml">+</mo><mi id="S3.SS1.SSS2.p2.11.m11.1.1.3.2.3" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.2.3.cmml">s</mi></mrow><mo id="S3.SS1.SSS2.p2.11.m11.1.1.3.1" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.1.cmml">mod</mo><msup id="S3.SS1.SSS2.p2.11.m11.1.1.3.3" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.3.cmml"><mn id="S3.SS1.SSS2.p2.11.m11.1.1.3.3.2" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.3.2.cmml">2</mn><mn id="S3.SS1.SSS2.p2.11.m11.1.1.3.3.3" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.11.m11.1b"><apply id="S3.SS1.SSS2.p2.11.m11.1.1.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1"><approx id="S3.SS1.SSS2.p2.11.m11.1.1.1.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.1"></approx><ci id="S3.SS1.SSS2.p2.11.m11.1.1.2.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.2">𝑦</ci><apply id="S3.SS1.SSS2.p2.11.m11.1.1.3.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.3"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.11.m11.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.1">modulo</csymbol><apply id="S3.SS1.SSS2.p2.11.m11.1.1.3.2.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.2"><plus id="S3.SS1.SSS2.p2.11.m11.1.1.3.2.1.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.2.1"></plus><ci id="S3.SS1.SSS2.p2.11.m11.1.1.3.2.2.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.2.2">𝑥</ci><ci id="S3.SS1.SSS2.p2.11.m11.1.1.3.2.3.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.2.3">𝑠</ci></apply><apply id="S3.SS1.SSS2.p2.11.m11.1.1.3.3.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.11.m11.1.1.3.3.1.cmml" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.3">superscript</csymbol><cn id="S3.SS1.SSS2.p2.11.m11.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.3.2">2</cn><cn id="S3.SS1.SSS2.p2.11.m11.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.SSS2.p2.11.m11.1.1.3.3.3">16</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.11.m11.1c">y\approx x+s\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.11.m11.1d">italic_y ≈ italic_x + italic_s roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, the relay bot is receiving packets on port 25 and can be used in triangular spamming.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3. </span>On-Path NAT Measurements</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.1">It was once assumed that <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS3.p1.1.1">network address translation</span> (NAT) <cite class="ltx_cite ltx_citemacro_citep">(Srisuresh and Holdrege, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib59" title="">1999</a>)</cite> obfuscated devices in a local network behind a shared public IP address, stopping external observers on the public network from counting or identifying NATted devices or distinguishing their traffic.
However, early NAT devices did not change outgoing packets’ IPIDs.
Bellovin <cite class="ltx_cite ltx_citemacro_citep">(Bellovin, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib7" title="">2002</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>B) showed how this could be exploited for on-path measurement (e.g., by an ISP that sees all NATted traffic but doesn’t manipulate it) if consecutive IPIDs assigned by the same NATted device are correlated.
Notably, this on-path vantage point eliminates the need for probe comparison’s probing and interaction steps, simplifying it to comparing IPIDs over time.
First, the on-path measurer collects all traffic from a target NAT over a period of time.
It then builds sequences of IPIDs that likely originated from the same NATted device by inspecting packets’ IPIDs in time order and either appending them to the “best match” existing sequence or starting a new sequence if none match.
The resulting number of sequences is often a good approximation of the number of NATted devices.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS3.p2">
<p class="ltx_p" id="S3.SS1.SSS3.p2.1">Bellovin’s matching rules for constructing IPID sequences are based on globally incrementing IPIDs, but could easily extend to any counter-based method by changing parameters.
Thus, the paper’s suggested mitigations included using a PRNG-based selection method.
Surprisingly, this protection alone is insufficient; Mongkolluksamee et al. <cite class="ltx_cite ltx_citemacro_citep">(Mongkolluksamee et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib48" title="">2012</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>I) later extended this on-path measurement to uniquely identify NATted devices and their OSes across all IPID selection methods by additionally observing patterns in the TCP sequence number and source port.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4. </span>Canary Fragments</h4>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="465" id="S3.F4.g1" src="x5.png" width="498"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.13.6.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text ltx_font_italic" id="S3.F4.10.5" style="font-size:90%;">Canary Fragments Execution.<span class="ltx_text ltx_font_upright" id="S3.F4.10.5.5">
If a server <math alttext="S" class="ltx_Math" display="inline" id="S3.F4.6.1.1.m1.1"><semantics id="S3.F4.6.1.1.m1.1b"><mi id="S3.F4.6.1.1.m1.1.1" xref="S3.F4.6.1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F4.6.1.1.m1.1c"><ci id="S3.F4.6.1.1.m1.1.1.cmml" xref="S3.F4.6.1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.6.1.1.m1.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F4.6.1.1.m1.1e">italic_S</annotation></semantics></math> uses a sequentially incrementing counter for its IPIDs, a measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.F4.7.2.2.m2.1"><semantics id="S3.F4.7.2.2.m2.1b"><mi id="S3.F4.7.2.2.m2.1.1" xref="S3.F4.7.2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.F4.7.2.2.m2.1c"><ci id="S3.F4.7.2.2.m2.1.1.cmml" xref="S3.F4.7.2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.7.2.2.m2.1d">M</annotation><annotation encoding="application/x-llamapun" id="S3.F4.7.2.2.m2.1e">italic_M</annotation></semantics></math> can count packets sent from <math alttext="S" class="ltx_Math" display="inline" id="S3.F4.8.3.3.m3.1"><semantics id="S3.F4.8.3.3.m3.1b"><mi id="S3.F4.8.3.3.m3.1.1" xref="S3.F4.8.3.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F4.8.3.3.m3.1c"><ci id="S3.F4.8.3.3.m3.1.1.cmml" xref="S3.F4.8.3.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.8.3.3.m3.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F4.8.3.3.m3.1e">italic_S</annotation></semantics></math> to a client <math alttext="C" class="ltx_Math" display="inline" id="S3.F4.9.4.4.m4.1"><semantics id="S3.F4.9.4.4.m4.1b"><mi id="S3.F4.9.4.4.m4.1.1" xref="S3.F4.9.4.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.F4.9.4.4.m4.1c"><ci id="S3.F4.9.4.4.m4.1.1.cmml" xref="S3.F4.9.4.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.9.4.4.m4.1d">C</annotation><annotation encoding="application/x-llamapun" id="S3.F4.9.4.4.m4.1e">italic_C</annotation></semantics></math> by planting canary fragments with a range of guessed IPIDs in the reassembly buffer of <math alttext="C" class="ltx_Math" display="inline" id="S3.F4.10.5.5.m5.1"><semantics id="S3.F4.10.5.5.m5.1b"><mi id="S3.F4.10.5.5.m5.1.1" xref="S3.F4.10.5.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.F4.10.5.5.m5.1c"><ci id="S3.F4.10.5.5.m5.1.1.cmml" xref="S3.F4.10.5.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.10.5.5.m5.1d">C</annotation><annotation encoding="application/x-llamapun" id="S3.F4.10.5.5.m5.1e">italic_C</annotation></semantics></math> and later querying whether they were evicted.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.23">For 14 years, Linux’s per-destination IPIDs for non-atomic packets seemed impervious to probe comparisons.
If an off-path measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.1.m1.1"><semantics id="S3.SS1.SSS4.p1.1.m1.1a"><mi id="S3.SS1.SSS4.p1.1.m1.1.1" xref="S3.SS1.SSS4.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.1.m1.1b"><ci id="S3.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.1.m1.1d">italic_M</annotation></semantics></math> probes the per-destination counter on a server <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.2.m2.1"><semantics id="S3.SS1.SSS4.p1.2.m2.1a"><mi id="S3.SS1.SSS4.p1.2.m2.1.1" xref="S3.SS1.SSS4.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.2.m2.1b"><ci id="S3.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS4.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.2.m2.1d">italic_S</annotation></semantics></math> for some client <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.3.m3.1"><semantics id="S3.SS1.SSS4.p1.3.m3.1a"><mi id="S3.SS1.SSS4.p1.3.m3.1.1" xref="S3.SS1.SSS4.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.3.m3.1b"><ci id="S3.SS1.SSS4.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS4.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.3.m3.1d">italic_C</annotation></semantics></math> by spoofing a packet from <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.4.m4.1"><semantics id="S3.SS1.SSS4.p1.4.m4.1a"><mi id="S3.SS1.SSS4.p1.4.m4.1.1" xref="S3.SS1.SSS4.p1.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.4.m4.1b"><ci id="S3.SS1.SSS4.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS4.p1.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.4.m4.1d">italic_C</annotation></semantics></math> to <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.5.m5.1"><semantics id="S3.SS1.SSS4.p1.5.m5.1a"><mi id="S3.SS1.SSS4.p1.5.m5.1.1" xref="S3.SS1.SSS4.p1.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.5.m5.1b"><ci id="S3.SS1.SSS4.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS4.p1.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.5.m5.1d">italic_S</annotation></semantics></math>, the server <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.6.m6.1"><semantics id="S3.SS1.SSS4.p1.6.m6.1a"><mi id="S3.SS1.SSS4.p1.6.m6.1.1" xref="S3.SS1.SSS4.p1.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.6.m6.1b"><ci id="S3.SS1.SSS4.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS4.p1.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.6.m6.1d">italic_S</annotation></semantics></math> replies to <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.7.m7.1"><semantics id="S3.SS1.SSS4.p1.7.m7.1a"><mi id="S3.SS1.SSS4.p1.7.m7.1.1" xref="S3.SS1.SSS4.p1.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.7.m7.1b"><ci id="S3.SS1.SSS4.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS4.p1.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.7.m7.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.7.m7.1d">italic_C</annotation></semantics></math>, not <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.8.m8.1"><semantics id="S3.SS1.SSS4.p1.8.m8.1a"><mi id="S3.SS1.SSS4.p1.8.m8.1.1" xref="S3.SS1.SSS4.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.8.m8.1b"><ci id="S3.SS1.SSS4.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS4.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.8.m8.1d">italic_M</annotation></semantics></math>.
But this intuition also reveals a weakness: every increment of a per-destination counter is caused by a packet sent to its unique destination.
Knockel and Crandall <cite class="ltx_cite ltx_citemacro_citep">(Knockel and Crandall, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib39" title="">2014</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>N) recognized that this could be abused to detect if <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.9.m9.1"><semantics id="S3.SS1.SSS4.p1.9.m9.1a"><mi id="S3.SS1.SSS4.p1.9.m9.1.1" xref="S3.SS1.SSS4.p1.9.m9.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.9.m9.1b"><ci id="S3.SS1.SSS4.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS4.p1.9.m9.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.9.m9.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.9.m9.1d">italic_S</annotation></semantics></math> and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.10.m10.1"><semantics id="S3.SS1.SSS4.p1.10.m10.1a"><mi id="S3.SS1.SSS4.p1.10.m10.1.1" xref="S3.SS1.SSS4.p1.10.m10.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.10.m10.1b"><ci id="S3.SS1.SSS4.p1.10.m10.1.1.cmml" xref="S3.SS1.SSS4.p1.10.m10.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.10.m10.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.10.m10.1d">italic_C</annotation></semantics></math> are communicating and, if so, count the number of ICMP, UDP, or TCP packets exchanged between them.
First, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.11.m11.1"><semantics id="S3.SS1.SSS4.p1.11.m11.1a"><mi id="S3.SS1.SSS4.p1.11.m11.1.1" xref="S3.SS1.SSS4.p1.11.m11.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.11.m11.1b"><ci id="S3.SS1.SSS4.p1.11.m11.1.1.cmml" xref="S3.SS1.SSS4.p1.11.m11.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.11.m11.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.11.m11.1d">italic_M</annotation></semantics></math> fills the reassembly buffer of <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.12.m12.1"><semantics id="S3.SS1.SSS4.p1.12.m12.1a"><mi id="S3.SS1.SSS4.p1.12.m12.1.1" xref="S3.SS1.SSS4.p1.12.m12.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.12.m12.1b"><ci id="S3.SS1.SSS4.p1.12.m12.1.1.cmml" xref="S3.SS1.SSS4.p1.12.m12.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.12.m12.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.12.m12.1d">italic_C</annotation></semantics></math> with <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS4.p1.23.1">canary fragments</span> containing guessed IPIDs that appear to originate from <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.13.m13.1"><semantics id="S3.SS1.SSS4.p1.13.m13.1a"><mi id="S3.SS1.SSS4.p1.13.m13.1.1" xref="S3.SS1.SSS4.p1.13.m13.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.13.m13.1b"><ci id="S3.SS1.SSS4.p1.13.m13.1.1.cmml" xref="S3.SS1.SSS4.p1.13.m13.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.13.m13.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.13.m13.1d">italic_S</annotation></semantics></math> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F4" title="Figure 4 ‣ 3.1.4. Canary Fragments ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4</span></a>).
Second, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.14.m14.1"><semantics id="S3.SS1.SSS4.p1.14.m14.1a"><mi id="S3.SS1.SSS4.p1.14.m14.1.1" xref="S3.SS1.SSS4.p1.14.m14.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.14.m14.1b"><ci id="S3.SS1.SSS4.p1.14.m14.1.1.cmml" xref="S3.SS1.SSS4.p1.14.m14.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.14.m14.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.14.m14.1d">italic_M</annotation></semantics></math> spoofs large ICMP ECHO requests from <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.15.m15.1"><semantics id="S3.SS1.SSS4.p1.15.m15.1a"><mi id="S3.SS1.SSS4.p1.15.m15.1.1" xref="S3.SS1.SSS4.p1.15.m15.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.15.m15.1b"><ci id="S3.SS1.SSS4.p1.15.m15.1.1.cmml" xref="S3.SS1.SSS4.p1.15.m15.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.15.m15.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.15.m15.1d">italic_C</annotation></semantics></math> to <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.16.m16.1"><semantics id="S3.SS1.SSS4.p1.16.m16.1a"><mi id="S3.SS1.SSS4.p1.16.m16.1.1" xref="S3.SS1.SSS4.p1.16.m16.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.16.m16.1b"><ci id="S3.SS1.SSS4.p1.16.m16.1.1.cmml" xref="S3.SS1.SSS4.p1.16.m16.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.16.m16.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.16.m16.1d">italic_S</annotation></semantics></math> which become fragmented ICMP ECHO responses from <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.17.m17.1"><semantics id="S3.SS1.SSS4.p1.17.m17.1a"><mi id="S3.SS1.SSS4.p1.17.m17.1.1" xref="S3.SS1.SSS4.p1.17.m17.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.17.m17.1b"><ci id="S3.SS1.SSS4.p1.17.m17.1.1.cmml" xref="S3.SS1.SSS4.p1.17.m17.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.17.m17.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.17.m17.1d">italic_S</annotation></semantics></math> to <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.18.m18.1"><semantics id="S3.SS1.SSS4.p1.18.m18.1a"><mi id="S3.SS1.SSS4.p1.18.m18.1.1" xref="S3.SS1.SSS4.p1.18.m18.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.18.m18.1b"><ci id="S3.SS1.SSS4.p1.18.m18.1.1.cmml" xref="S3.SS1.SSS4.p1.18.m18.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.18.m18.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.18.m18.1d">italic_C</annotation></semantics></math>.
If any canary has an IPID matching an ECHO response, it is evicted from the reassembly buffer.
Finally, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.19.m19.1"><semantics id="S3.SS1.SSS4.p1.19.m19.1a"><mi id="S3.SS1.SSS4.p1.19.m19.1.1" xref="S3.SS1.SSS4.p1.19.m19.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.19.m19.1b"><ci id="S3.SS1.SSS4.p1.19.m19.1.1.cmml" xref="S3.SS1.SSS4.p1.19.m19.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.19.m19.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.19.m19.1d">italic_M</annotation></semantics></math> “queries” the reassembly buffer of <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.20.m20.1"><semantics id="S3.SS1.SSS4.p1.20.m20.1a"><mi id="S3.SS1.SSS4.p1.20.m20.1.1" xref="S3.SS1.SSS4.p1.20.m20.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.20.m20.1b"><ci id="S3.SS1.SSS4.p1.20.m20.1.1.cmml" xref="S3.SS1.SSS4.p1.20.m20.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.20.m20.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.20.m20.1d">italic_C</annotation></semantics></math> to determine if many canaries are missing; if so, their guessed IPIDs were correct.
By repeating this measurement over time and tracking the change in IPIDs, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.21.m21.1"><semantics id="S3.SS1.SSS4.p1.21.m21.1a"><mi id="S3.SS1.SSS4.p1.21.m21.1.1" xref="S3.SS1.SSS4.p1.21.m21.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.21.m21.1b"><ci id="S3.SS1.SSS4.p1.21.m21.1.1.cmml" xref="S3.SS1.SSS4.p1.21.m21.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.21.m21.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.21.m21.1d">italic_M</annotation></semantics></math> can count the number of packets sent from <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.22.m22.1"><semantics id="S3.SS1.SSS4.p1.22.m22.1a"><mi id="S3.SS1.SSS4.p1.22.m22.1.1" xref="S3.SS1.SSS4.p1.22.m22.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.22.m22.1b"><ci id="S3.SS1.SSS4.p1.22.m22.1.1.cmml" xref="S3.SS1.SSS4.p1.22.m22.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.22.m22.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.22.m22.1d">italic_S</annotation></semantics></math> to <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.23.m23.1"><semantics id="S3.SS1.SSS4.p1.23.m23.1a"><mi id="S3.SS1.SSS4.p1.23.m23.1.1" xref="S3.SS1.SSS4.p1.23.m23.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.23.m23.1b"><ci id="S3.SS1.SSS4.p1.23.m23.1.1.cmml" xref="S3.SS1.SSS4.p1.23.m23.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.23.m23.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.23.m23.1d">italic_C</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS4.p2">
<p class="ltx_p" id="S3.SS1.SSS4.p2.1">When canary fragments were disclosed, the Linux developers had already been working to replace per-destination selection—due to its large performance impact on modern servers—with per-bucket selection using a Jenkins hash of the destination IP address (see Linux commit <a class="ltx_ref ltx_href" href="https://github.com/torvalds/linux/commit/73f156a6e8c1074ac6327e0abd1169e95eb66463" title="">73f156</a>).
To curb canary fragments’ abuse of per-destination counters’ perfect increments-to-packets correlation, they also added the stochastic increments described in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3" title="2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.3</span></a> and included the source IP address and protocol number in the bucket hash input (see Linux commit <a class="ltx_ref ltx_href" href="https://github.com/torvalds/linux/commit/04ca6973f7c1a0d8537f2d9906a0cf8e69886d75" title="">04ca69</a>).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.5. </span>Bucket Leaks</h4>
<div class="ltx_para" id="S3.SS1.SSS5.p1">
<p class="ltx_p" id="S3.SS1.SSS5.p1.8">Conceptually, per-bucket selection blends globally incrementing selection’s noisiness of shared counters with per-destination selection’s difficulty of direct probing, but in practice compromises on both.
Recall that a bucket hash function <math alttext="h" class="ltx_Math" display="inline" id="S3.SS1.SSS5.p1.1.m1.1"><semantics id="S3.SS1.SSS5.p1.1.m1.1a"><mi id="S3.SS1.SSS5.p1.1.m1.1.1" xref="S3.SS1.SSS5.p1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.1.m1.1b"><ci id="S3.SS1.SSS5.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS5.p1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.p1.1.m1.1d">italic_h</annotation></semantics></math> hashes packets to buckets using a packet’s source and destination IP addresses <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.SSS5.p1.2.m2.1"><semantics id="S3.SS1.SSS5.p1.2.m2.1a"><mi id="S3.SS1.SSS5.p1.2.m2.1.1" xref="S3.SS1.SSS5.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.2.m2.1b"><ci id="S3.SS1.SSS5.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS5.p1.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.p1.2.m2.1d">italic_s</annotation></semantics></math> and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.SSS5.p1.3.m3.1"><semantics id="S3.SS1.SSS5.p1.3.m3.1a"><mi id="S3.SS1.SSS5.p1.3.m3.1.1" xref="S3.SS1.SSS5.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.3.m3.1b"><ci id="S3.SS1.SSS5.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS5.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.p1.3.m3.1d">italic_d</annotation></semantics></math>, the protocol number <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.SSS5.p1.4.m4.1"><semantics id="S3.SS1.SSS5.p1.4.m4.1a"><mi id="S3.SS1.SSS5.p1.4.m4.1.1" xref="S3.SS1.SSS5.p1.4.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.4.m4.1b"><ci id="S3.SS1.SSS5.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS5.p1.4.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.4.m4.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.p1.4.m4.1d">italic_p</annotation></semantics></math>, and a secret key <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.SSS5.p1.5.m5.1"><semantics id="S3.SS1.SSS5.p1.5.m5.1a"><mi id="S3.SS1.SSS5.p1.5.m5.1.1" xref="S3.SS1.SSS5.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.5.m5.1b"><ci id="S3.SS1.SSS5.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS5.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.p1.5.m5.1d">italic_k</annotation></semantics></math>.
If a measurer controls an IP address <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.p1.6.m6.1"><semantics id="S3.SS1.SSS5.p1.6.m6.1a"><msup id="S3.SS1.SSS5.p1.6.m6.1.1" xref="S3.SS1.SSS5.p1.6.m6.1.1.cmml"><mi id="S3.SS1.SSS5.p1.6.m6.1.1.2" xref="S3.SS1.SSS5.p1.6.m6.1.1.2.cmml">d</mi><mo id="S3.SS1.SSS5.p1.6.m6.1.1.3" xref="S3.SS1.SSS5.p1.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.6.m6.1b"><apply id="S3.SS1.SSS5.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS5.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.SSS5.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS5.p1.6.m6.1.1.2">𝑑</ci><ci id="S3.SS1.SSS5.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS5.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.6.m6.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.p1.6.m6.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> such that <math alttext="h(s,d,p,k)=h(s,d^{\prime},p,k)" class="ltx_Math" display="inline" id="S3.SS1.SSS5.p1.7.m7.8"><semantics id="S3.SS1.SSS5.p1.7.m7.8a"><mrow id="S3.SS1.SSS5.p1.7.m7.8.8" xref="S3.SS1.SSS5.p1.7.m7.8.8.cmml"><mrow id="S3.SS1.SSS5.p1.7.m7.8.8.3" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.cmml"><mi id="S3.SS1.SSS5.p1.7.m7.8.8.3.2" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.2.cmml">h</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.3.1" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.1.cmml">⁢</mo><mrow id="S3.SS1.SSS5.p1.7.m7.8.8.3.3.2" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.3.1.cmml"><mo id="S3.SS1.SSS5.p1.7.m7.8.8.3.3.2.1" stretchy="false" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.3.1.cmml">(</mo><mi id="S3.SS1.SSS5.p1.7.m7.1.1" xref="S3.SS1.SSS5.p1.7.m7.1.1.cmml">s</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.3.3.2.2" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.p1.7.m7.2.2" xref="S3.SS1.SSS5.p1.7.m7.2.2.cmml">d</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.3.3.2.3" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.p1.7.m7.3.3" xref="S3.SS1.SSS5.p1.7.m7.3.3.cmml">p</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.3.3.2.4" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.p1.7.m7.4.4" xref="S3.SS1.SSS5.p1.7.m7.4.4.cmml">k</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.3.3.2.5" stretchy="false" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.SSS5.p1.7.m7.8.8.2" xref="S3.SS1.SSS5.p1.7.m7.8.8.2.cmml">=</mo><mrow id="S3.SS1.SSS5.p1.7.m7.8.8.1" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.cmml"><mi id="S3.SS1.SSS5.p1.7.m7.8.8.1.3" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.3.cmml">h</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.1.2" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.2.cmml">⁢</mo><mrow id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.2.cmml"><mo id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.2" stretchy="false" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.2.cmml">(</mo><mi id="S3.SS1.SSS5.p1.7.m7.5.5" xref="S3.SS1.SSS5.p1.7.m7.5.5.cmml">s</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.3" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.2.cmml">,</mo><msup id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.cmml"><mi id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.2" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.2.cmml">d</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.3" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.4" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.2.cmml">,</mo><mi id="S3.SS1.SSS5.p1.7.m7.6.6" xref="S3.SS1.SSS5.p1.7.m7.6.6.cmml">p</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.5" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.2.cmml">,</mo><mi id="S3.SS1.SSS5.p1.7.m7.7.7" xref="S3.SS1.SSS5.p1.7.m7.7.7.cmml">k</mi><mo id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.6" stretchy="false" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.7.m7.8b"><apply id="S3.SS1.SSS5.p1.7.m7.8.8.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8"><eq id="S3.SS1.SSS5.p1.7.m7.8.8.2.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.2"></eq><apply id="S3.SS1.SSS5.p1.7.m7.8.8.3.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.3"><times id="S3.SS1.SSS5.p1.7.m7.8.8.3.1.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.1"></times><ci id="S3.SS1.SSS5.p1.7.m7.8.8.3.2.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.2">ℎ</ci><vector id="S3.SS1.SSS5.p1.7.m7.8.8.3.3.1.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.3.3.2"><ci id="S3.SS1.SSS5.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS5.p1.7.m7.1.1">𝑠</ci><ci id="S3.SS1.SSS5.p1.7.m7.2.2.cmml" xref="S3.SS1.SSS5.p1.7.m7.2.2">𝑑</ci><ci id="S3.SS1.SSS5.p1.7.m7.3.3.cmml" xref="S3.SS1.SSS5.p1.7.m7.3.3">𝑝</ci><ci id="S3.SS1.SSS5.p1.7.m7.4.4.cmml" xref="S3.SS1.SSS5.p1.7.m7.4.4">𝑘</ci></vector></apply><apply id="S3.SS1.SSS5.p1.7.m7.8.8.1.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.1"><times id="S3.SS1.SSS5.p1.7.m7.8.8.1.2.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.2"></times><ci id="S3.SS1.SSS5.p1.7.m7.8.8.1.3.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.3">ℎ</ci><vector id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.2.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1"><ci id="S3.SS1.SSS5.p1.7.m7.5.5.cmml" xref="S3.SS1.SSS5.p1.7.m7.5.5">𝑠</ci><apply id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1">superscript</csymbol><ci id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.2.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.2">𝑑</ci><ci id="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.3.cmml" xref="S3.SS1.SSS5.p1.7.m7.8.8.1.1.1.1.3">′</ci></apply><ci id="S3.SS1.SSS5.p1.7.m7.6.6.cmml" xref="S3.SS1.SSS5.p1.7.m7.6.6">𝑝</ci><ci id="S3.SS1.SSS5.p1.7.m7.7.7.cmml" xref="S3.SS1.SSS5.p1.7.m7.7.7">𝑘</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.7.m7.8c">h(s,d,p,k)=h(s,d^{\prime},p,k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.p1.7.m7.8d">italic_h ( italic_s , italic_d , italic_p , italic_k ) = italic_h ( italic_s , italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_p , italic_k )</annotation></semantics></math>, it can exploit this <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS5.p1.8.1">hash collision</span> to probe the per-bucket counter assigning IPIDs to machine <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.SSS5.p1.8.m8.1"><semantics id="S3.SS1.SSS5.p1.8.m8.1a"><mi id="S3.SS1.SSS5.p1.8.m8.1.1" xref="S3.SS1.SSS5.p1.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.p1.8.m8.1b"><ci id="S3.SS1.SSS5.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS5.p1.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.p1.8.m8.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.p1.8.m8.1d">italic_d</annotation></semantics></math>.
Below, we summarize three bucket hash collisions and the probe comparison measurements they enable.</p>
</div>
<section class="ltx_paragraph" id="S3.SS1.SSS5.Px1">
<h5 class="ltx_title ltx_title_paragraph">Non-Idle Port Scans</h5>
<div class="ltx_para" id="S3.SS1.SSS5.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS5.Px1.p1.22">Zhang et al. <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib61" title="">2018</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>Q) introduced the first method for discovering bucket hash collisions and used it to perform off-path port scans without an idle machine.
To find a hash collision, a measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.1.m1.1"><semantics id="S3.SS1.SSS5.Px1.p1.1.m1.1a"><mi id="S3.SS1.SSS5.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS5.Px1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.1.m1.1b"><ci id="S3.SS1.SSS5.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.1.m1.1d">italic_M</annotation></semantics></math> first sends an unsolicited SYN/ACK to a server <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.2.m2.1"><semantics id="S3.SS1.SSS5.Px1.p1.2.m2.1a"><mi id="S3.SS1.SSS5.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS5.Px1.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.2.m2.1b"><ci id="S3.SS1.SSS5.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.2.m2.1d">italic_S</annotation></semantics></math> and records the RST reply’s IPID, say <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.3.m3.1"><semantics id="S3.SS1.SSS5.Px1.p1.3.m3.1a"><mi id="S3.SS1.SSS5.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS5.Px1.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.3.m3.1b"><ci id="S3.SS1.SSS5.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.3.m3.1d">italic_x</annotation></semantics></math>, which is drawn from bucket <math alttext="b_{M}=h(S,M,p,k)" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.4.m4.4"><semantics id="S3.SS1.SSS5.Px1.p1.4.m4.4a"><mrow id="S3.SS1.SSS5.Px1.p1.4.m4.4.5" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.cmml"><msub id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.cmml"><mi id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.2" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.2.cmml">b</mi><mi id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.3" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.3.cmml">M</mi></msub><mo id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.1" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.cmml"><mi id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.2" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.2.cmml">h</mi><mo id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.1" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.1.cmml">⁢</mo><mrow id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.2" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.1.cmml"><mo id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.2.1" stretchy="false" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.1.cmml">(</mo><mi id="S3.SS1.SSS5.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS5.Px1.p1.4.m4.1.1.cmml">S</mi><mo id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.2.2" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.Px1.p1.4.m4.2.2" xref="S3.SS1.SSS5.Px1.p1.4.m4.2.2.cmml">M</mi><mo id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.2.3" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.Px1.p1.4.m4.3.3" xref="S3.SS1.SSS5.Px1.p1.4.m4.3.3.cmml">p</mi><mo id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.2.4" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.Px1.p1.4.m4.4.4" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.4.cmml">k</mi><mo id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.2.5" stretchy="false" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.4.m4.4b"><apply id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5"><eq id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.1.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.1"></eq><apply id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.1.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.2.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.2">𝑏</ci><ci id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.3.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.2.3">𝑀</ci></apply><apply id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3"><times id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.1"></times><ci id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.2.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.2">ℎ</ci><vector id="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.5.3.3.2"><ci id="S3.SS1.SSS5.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.1.1">𝑆</ci><ci id="S3.SS1.SSS5.Px1.p1.4.m4.2.2.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.2.2">𝑀</ci><ci id="S3.SS1.SSS5.Px1.p1.4.m4.3.3.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.3.3">𝑝</ci><ci id="S3.SS1.SSS5.Px1.p1.4.m4.4.4.cmml" xref="S3.SS1.SSS5.Px1.p1.4.m4.4.4">𝑘</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.4.m4.4c">b_{M}=h(S,M,p,k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.4.m4.4d">italic_b start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT = italic_h ( italic_S , italic_M , italic_p , italic_k )</annotation></semantics></math>.
Measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.5.m5.1"><semantics id="S3.SS1.SSS5.Px1.p1.5.m5.1a"><mi id="S3.SS1.SSS5.Px1.p1.5.m5.1.1" xref="S3.SS1.SSS5.Px1.p1.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.5.m5.1b"><ci id="S3.SS1.SSS5.Px1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.5.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.5.m5.1d">italic_M</annotation></semantics></math> then spoofs a SYN/ACK to <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.6.m6.1"><semantics id="S3.SS1.SSS5.Px1.p1.6.m6.1a"><mi id="S3.SS1.SSS5.Px1.p1.6.m6.1.1" xref="S3.SS1.SSS5.Px1.p1.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.6.m6.1b"><ci id="S3.SS1.SSS5.Px1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.6.m6.1d">italic_S</annotation></semantics></math> that appears to originate from the client <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.7.m7.1"><semantics id="S3.SS1.SSS5.Px1.p1.7.m7.1a"><mi id="S3.SS1.SSS5.Px1.p1.7.m7.1.1" xref="S3.SS1.SSS5.Px1.p1.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.7.m7.1b"><ci id="S3.SS1.SSS5.Px1.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.7.m7.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.7.m7.1d">italic_C</annotation></semantics></math> that <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.8.m8.1"><semantics id="S3.SS1.SSS5.Px1.p1.8.m8.1a"><mi id="S3.SS1.SSS5.Px1.p1.8.m8.1.1" xref="S3.SS1.SSS5.Px1.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.8.m8.1b"><ci id="S3.SS1.SSS5.Px1.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.8.m8.1d">italic_M</annotation></semantics></math> is trying to collide with.
Server <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.9.m9.1"><semantics id="S3.SS1.SSS5.Px1.p1.9.m9.1a"><mi id="S3.SS1.SSS5.Px1.p1.9.m9.1.1" xref="S3.SS1.SSS5.Px1.p1.9.m9.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.9.m9.1b"><ci id="S3.SS1.SSS5.Px1.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.9.m9.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.9.m9.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.9.m9.1d">italic_S</annotation></semantics></math> replies to <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.10.m10.1"><semantics id="S3.SS1.SSS5.Px1.p1.10.m10.1a"><mi id="S3.SS1.SSS5.Px1.p1.10.m10.1.1" xref="S3.SS1.SSS5.Px1.p1.10.m10.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.10.m10.1b"><ci id="S3.SS1.SSS5.Px1.p1.10.m10.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.10.m10.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.10.m10.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.10.m10.1d">italic_C</annotation></semantics></math> with an RST whose IPID is drawn from bucket <math alttext="b_{C}=h(S,C,p,k)" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.11.m11.4"><semantics id="S3.SS1.SSS5.Px1.p1.11.m11.4a"><mrow id="S3.SS1.SSS5.Px1.p1.11.m11.4.5" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.cmml"><msub id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.cmml"><mi id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.2" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.2.cmml">b</mi><mi id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.3" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.3.cmml">C</mi></msub><mo id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.1" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.1.cmml">=</mo><mrow id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.cmml"><mi id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.2" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.2.cmml">h</mi><mo id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.1" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.1.cmml">⁢</mo><mrow id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.2" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.1.cmml"><mo id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.2.1" stretchy="false" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.1.cmml">(</mo><mi id="S3.SS1.SSS5.Px1.p1.11.m11.1.1" xref="S3.SS1.SSS5.Px1.p1.11.m11.1.1.cmml">S</mi><mo id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.2.2" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.Px1.p1.11.m11.2.2" xref="S3.SS1.SSS5.Px1.p1.11.m11.2.2.cmml">C</mi><mo id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.2.3" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.Px1.p1.11.m11.3.3" xref="S3.SS1.SSS5.Px1.p1.11.m11.3.3.cmml">p</mi><mo id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.2.4" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.1.cmml">,</mo><mi id="S3.SS1.SSS5.Px1.p1.11.m11.4.4" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.4.cmml">k</mi><mo id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.2.5" stretchy="false" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.11.m11.4b"><apply id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5"><eq id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.1.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.1"></eq><apply id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.1.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.2.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.2">𝑏</ci><ci id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.3.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.2.3">𝐶</ci></apply><apply id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3"><times id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.1"></times><ci id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.2.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.2">ℎ</ci><vector id="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.5.3.3.2"><ci id="S3.SS1.SSS5.Px1.p1.11.m11.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.1.1">𝑆</ci><ci id="S3.SS1.SSS5.Px1.p1.11.m11.2.2.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.2.2">𝐶</ci><ci id="S3.SS1.SSS5.Px1.p1.11.m11.3.3.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.3.3">𝑝</ci><ci id="S3.SS1.SSS5.Px1.p1.11.m11.4.4.cmml" xref="S3.SS1.SSS5.Px1.p1.11.m11.4.4">𝑘</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.11.m11.4c">b_{C}=h(S,C,p,k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.11.m11.4d">italic_b start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT = italic_h ( italic_S , italic_C , italic_p , italic_k )</annotation></semantics></math>.
Finally, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.12.m12.1"><semantics id="S3.SS1.SSS5.Px1.p1.12.m12.1a"><mi id="S3.SS1.SSS5.Px1.p1.12.m12.1.1" xref="S3.SS1.SSS5.Px1.p1.12.m12.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.12.m12.1b"><ci id="S3.SS1.SSS5.Px1.p1.12.m12.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.12.m12.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.12.m12.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.12.m12.1d">italic_M</annotation></semantics></math> again probes bucket <math alttext="b_{M}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.13.m13.1"><semantics id="S3.SS1.SSS5.Px1.p1.13.m13.1a"><msub id="S3.SS1.SSS5.Px1.p1.13.m13.1.1" xref="S3.SS1.SSS5.Px1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p1.13.m13.1.1.2" xref="S3.SS1.SSS5.Px1.p1.13.m13.1.1.2.cmml">b</mi><mi id="S3.SS1.SSS5.Px1.p1.13.m13.1.1.3" xref="S3.SS1.SSS5.Px1.p1.13.m13.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.13.m13.1b"><apply id="S3.SS1.SSS5.Px1.p1.13.m13.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p1.13.m13.1.1.2">𝑏</ci><ci id="S3.SS1.SSS5.Px1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.SSS5.Px1.p1.13.m13.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.13.m13.1c">b_{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.13.m13.1d">italic_b start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.14.m14.1"><semantics id="S3.SS1.SSS5.Px1.p1.14.m14.1a"><mi id="S3.SS1.SSS5.Px1.p1.14.m14.1.1" xref="S3.SS1.SSS5.Px1.p1.14.m14.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.14.m14.1b"><ci id="S3.SS1.SSS5.Px1.p1.14.m14.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.14.m14.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.14.m14.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.14.m14.1d">italic_S</annotation></semantics></math> to obtain IPID <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.15.m15.1"><semantics id="S3.SS1.SSS5.Px1.p1.15.m15.1a"><mi id="S3.SS1.SSS5.Px1.p1.15.m15.1.1" xref="S3.SS1.SSS5.Px1.p1.15.m15.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.15.m15.1b"><ci id="S3.SS1.SSS5.Px1.p1.15.m15.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.15.m15.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.15.m15.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.15.m15.1d">italic_y</annotation></semantics></math>.
Importantly, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.16.m16.1"><semantics id="S3.SS1.SSS5.Px1.p1.16.m16.1a"><mi id="S3.SS1.SSS5.Px1.p1.16.m16.1.1" xref="S3.SS1.SSS5.Px1.p1.16.m16.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.16.m16.1b"><ci id="S3.SS1.SSS5.Px1.p1.16.m16.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.16.m16.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.16.m16.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.16.m16.1d">italic_M</annotation></semantics></math> sends all three SYN/ACKs in rapid succession to avoid the per-bucket counter’s stochastic increments.
If <math alttext="y\equiv x+2\bmod 2^{16}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.17.m17.1"><semantics id="S3.SS1.SSS5.Px1.p1.17.m17.1a"><mrow id="S3.SS1.SSS5.Px1.p1.17.m17.1.1" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.2" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.1" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.1.cmml">≡</mo><mrow id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.cmml"><mrow id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.cmml"><mi id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.2" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.2.cmml">x</mi><mo id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.1" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.3" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.3.cmml">2</mn></mrow><mo id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.1" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.1.cmml">mod</mo><msup id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.cmml"><mn id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.2" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.2.cmml">2</mn><mn id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.3" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.17.m17.1b"><apply id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1"><equivalent id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.1"></equivalent><ci id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.2">𝑦</ci><apply id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3"><csymbol cd="latexml" id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.1">modulo</csymbol><apply id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2"><plus id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.1.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.1"></plus><ci id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.2.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.2.3">2</cn></apply><apply id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3">superscript</csymbol><cn id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.2">2</cn><cn id="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p1.17.m17.1.1.3.3.3">16</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.17.m17.1c">y\equiv x+2\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.17.m17.1d">italic_y ≡ italic_x + 2 roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.18.m18.1"><semantics id="S3.SS1.SSS5.Px1.p1.18.m18.1a"><mi id="S3.SS1.SSS5.Px1.p1.18.m18.1.1" xref="S3.SS1.SSS5.Px1.p1.18.m18.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.18.m18.1b"><ci id="S3.SS1.SSS5.Px1.p1.18.m18.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.18.m18.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.18.m18.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.18.m18.1d">italic_M</annotation></semantics></math> concludes that <math alttext="b_{M}=b_{C}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.19.m19.1"><semantics id="S3.SS1.SSS5.Px1.p1.19.m19.1a"><mrow id="S3.SS1.SSS5.Px1.p1.19.m19.1.1" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.cmml"><msub id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.cmml"><mi id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.2" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.2.cmml">b</mi><mi id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.3" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.3.cmml">M</mi></msub><mo id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.1" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.1.cmml">=</mo><msub id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.cmml"><mi id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.2" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.2.cmml">b</mi><mi id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.3" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.3.cmml">C</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.19.m19.1b"><apply id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1"><eq id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.1"></eq><apply id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.1.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.2.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.2">𝑏</ci><ci id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.3.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.2.3">𝑀</ci></apply><apply id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.2.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.2">𝑏</ci><ci id="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.3.cmml" xref="S3.SS1.SSS5.Px1.p1.19.m19.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.19.m19.1c">b_{M}=b_{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.19.m19.1d">italic_b start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT = italic_b start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT</annotation></semantics></math>; otherwise, if <math alttext="y\equiv x+1\bmod 2^{16}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.20.m20.1"><semantics id="S3.SS1.SSS5.Px1.p1.20.m20.1a"><mrow id="S3.SS1.SSS5.Px1.p1.20.m20.1.1" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.2" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.2.cmml">y</mi><mo id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.1" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.1.cmml">≡</mo><mrow id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.cmml"><mrow id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.cmml"><mi id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.2" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.2.cmml">x</mi><mo id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.1" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.1.cmml">+</mo><mn id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.3" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.3.cmml">1</mn></mrow><mo id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.1" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.1.cmml">mod</mo><msup id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.cmml"><mn id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.2" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.2.cmml">2</mn><mn id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.3" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.20.m20.1b"><apply id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1"><equivalent id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.1"></equivalent><ci id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.2">𝑦</ci><apply id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3"><csymbol cd="latexml" id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.1">modulo</csymbol><apply id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2"><plus id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.1.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.1"></plus><ci id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.2.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.2.3">1</cn></apply><apply id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.1.cmml" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3">superscript</csymbol><cn id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.2">2</cn><cn id="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p1.20.m20.1.1.3.3.3">16</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.20.m20.1c">y\equiv x+1\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.20.m20.1d">italic_y ≡ italic_x + 1 roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.21.m21.1"><semantics id="S3.SS1.SSS5.Px1.p1.21.m21.1a"><mi id="S3.SS1.SSS5.Px1.p1.21.m21.1.1" xref="S3.SS1.SSS5.Px1.p1.21.m21.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.21.m21.1b"><ci id="S3.SS1.SSS5.Px1.p1.21.m21.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.21.m21.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.21.m21.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.21.m21.1d">italic_M</annotation></semantics></math> and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p1.22.m22.1"><semantics id="S3.SS1.SSS5.Px1.p1.22.m22.1a"><mi id="S3.SS1.SSS5.Px1.p1.22.m22.1.1" xref="S3.SS1.SSS5.Px1.p1.22.m22.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p1.22.m22.1b"><ci id="S3.SS1.SSS5.Px1.p1.22.m22.1.1.cmml" xref="S3.SS1.SSS5.Px1.p1.22.m22.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p1.22.m22.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p1.22.m22.1d">italic_C</annotation></semantics></math> are likely hashing into different buckets.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS5.Px1.p2">
<p class="ltx_p" id="S3.SS1.SSS5.Px1.p2.7">On failing to find a hash collision, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p2.1.m1.1"><semantics id="S3.SS1.SSS5.Px1.p2.1.m1.1a"><mi id="S3.SS1.SSS5.Px1.p2.1.m1.1.1" xref="S3.SS1.SSS5.Px1.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p2.1.m1.1b"><ci id="S3.SS1.SSS5.Px1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p2.1.m1.1d">italic_M</annotation></semantics></math> can repeat this process with a different IP address it controls.
The probability of finding a hash collision for one of <math alttext="B" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p2.2.m2.1"><semantics id="S3.SS1.SSS5.Px1.p2.2.m2.1a"><mi id="S3.SS1.SSS5.Px1.p2.2.m2.1.1" xref="S3.SS1.SSS5.Px1.p2.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p2.2.m2.1b"><ci id="S3.SS1.SSS5.Px1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p2.2.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p2.2.m2.1d">italic_B</annotation></semantics></math> buckets when controlling <math alttext="D" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p2.3.m3.1"><semantics id="S3.SS1.SSS5.Px1.p2.3.m3.1a"><mi id="S3.SS1.SSS5.Px1.p2.3.m3.1.1" xref="S3.SS1.SSS5.Px1.p2.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p2.3.m3.1b"><ci id="S3.SS1.SSS5.Px1.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p2.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p2.3.m3.1d">italic_D</annotation></semantics></math> IP addresses is <math alttext="1-(1-1/B)^{D}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p2.4.m4.1"><semantics id="S3.SS1.SSS5.Px1.p2.4.m4.1a"><mrow id="S3.SS1.SSS5.Px1.p2.4.m4.1.1" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.cmml"><mn id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.3" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.3.cmml">1</mn><mo id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.2" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.2.cmml">−</mo><msup id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.cmml"><mrow id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.cmml"><mo id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.cmml"><mn id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.cmml"><mn id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.2" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.1" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.1.cmml">/</mo><mi id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.3" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.3.cmml">B</mi></mrow></mrow><mo id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.3" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p2.4.m4.1b"><apply id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1"><minus id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.2"></minus><cn id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.3">1</cn><apply id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1"><minus id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.1"></minus><cn id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.2">1</cn><apply id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3"><divide id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.1"></divide><cn id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.2">1</cn><ci id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.1.1.1.3.3">𝐵</ci></apply></apply><ci id="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.3.cmml" xref="S3.SS1.SSS5.Px1.p2.4.m4.1.1.1.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p2.4.m4.1c">1-(1-1/B)^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p2.4.m4.1d">1 - ( 1 - 1 / italic_B ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, which is over <math alttext="63\%" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p2.5.m5.1"><semantics id="S3.SS1.SSS5.Px1.p2.5.m5.1a"><mrow id="S3.SS1.SSS5.Px1.p2.5.m5.1.1" xref="S3.SS1.SSS5.Px1.p2.5.m5.1.1.cmml"><mn id="S3.SS1.SSS5.Px1.p2.5.m5.1.1.2" xref="S3.SS1.SSS5.Px1.p2.5.m5.1.1.2.cmml">63</mn><mo id="S3.SS1.SSS5.Px1.p2.5.m5.1.1.1" xref="S3.SS1.SSS5.Px1.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p2.5.m5.1b"><apply id="S3.SS1.SSS5.Px1.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.5.m5.1.1"><csymbol cd="latexml" id="S3.SS1.SSS5.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.5.m5.1.1.1">percent</csymbol><cn id="S3.SS1.SSS5.Px1.p2.5.m5.1.1.2.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p2.5.m5.1.1.2">63</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p2.5.m5.1c">63\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p2.5.m5.1d">63 %</annotation></semantics></math> when <math alttext="D\approx B" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p2.6.m6.1"><semantics id="S3.SS1.SSS5.Px1.p2.6.m6.1a"><mrow id="S3.SS1.SSS5.Px1.p2.6.m6.1.1" xref="S3.SS1.SSS5.Px1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p2.6.m6.1.1.2" xref="S3.SS1.SSS5.Px1.p2.6.m6.1.1.2.cmml">D</mi><mo id="S3.SS1.SSS5.Px1.p2.6.m6.1.1.1" xref="S3.SS1.SSS5.Px1.p2.6.m6.1.1.1.cmml">≈</mo><mi id="S3.SS1.SSS5.Px1.p2.6.m6.1.1.3" xref="S3.SS1.SSS5.Px1.p2.6.m6.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p2.6.m6.1b"><apply id="S3.SS1.SSS5.Px1.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.6.m6.1.1"><approx id="S3.SS1.SSS5.Px1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.6.m6.1.1.1"></approx><ci id="S3.SS1.SSS5.Px1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p2.6.m6.1.1.2">𝐷</ci><ci id="S3.SS1.SSS5.Px1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS5.Px1.p2.6.m6.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p2.6.m6.1c">D\approx B</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p2.6.m6.1d">italic_D ≈ italic_B</annotation></semantics></math> for the typical range of <math alttext="B\in[2^{11},2^{18}]" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p2.7.m7.2"><semantics id="S3.SS1.SSS5.Px1.p2.7.m7.2a"><mrow id="S3.SS1.SSS5.Px1.p2.7.m7.2.2" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.cmml"><mi id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.4" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.4.cmml">B</mi><mo id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.3" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.3.cmml">∈</mo><mrow id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.3.cmml"><mo id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.3" stretchy="false" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.3.cmml">[</mo><msup id="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1" xref="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.cmml"><mn id="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.2" xref="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.2.cmml">2</mn><mn id="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.3" xref="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.3.cmml">11</mn></msup><mo id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.4" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.3.cmml">,</mo><msup id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.cmml"><mn id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.2" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.2.cmml">2</mn><mn id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.3" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.3.cmml">18</mn></msup><mo id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.5" stretchy="false" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p2.7.m7.2b"><apply id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.cmml" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2"><in id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.3.cmml" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.3"></in><ci id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.4.cmml" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.4">𝐵</ci><interval closure="closed" id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.3.cmml" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2"><apply id="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1">superscript</csymbol><cn id="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.2">2</cn><cn id="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p2.7.m7.1.1.1.1.1.3">11</cn></apply><apply id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.cmml" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2">superscript</csymbol><cn id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.2.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.2">2</cn><cn id="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p2.7.m7.2.2.2.2.2.3">18</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p2.7.m7.2c">B\in[2^{11},2^{18}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p2.7.m7.2d">italic_B ∈ [ 2 start_POSTSUPERSCRIPT 11 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT 18 end_POSTSUPERSCRIPT ]</annotation></semantics></math>.
<span class="ltx_ERROR undefined" id="S3.SS1.SSS5.Px1.p2.7.1">\added</span>At the time this scan was discovered, similar collision probabilities were achievable with fewer IPv4 addresses when targeting dual-stack machines (those with both IPv4 and IPv6 addresses), since it is relatively easy to obtain a large block of IPv6 addresses and the same counters <span class="ltx_ERROR undefined" id="S3.SS1.SSS5.Px1.p2.7.2">\replaced</span>wereare used for both per-bucket IPIDs and IPv6 <span class="ltx_ERROR undefined" id="S3.SS1.SSS5.Px1.p2.7.3">\replaced</span>“fragment identifiers”“flow labels”.
<span class="ltx_ERROR undefined" id="S3.SS1.SSS5.Px1.p2.7.4">\added</span>Now, Linux generates purely random, non-zero IPv6 fragment IDs (see Linux commit <a class="ltx_ref ltx_href" href="https://github.com/torvalds/linux/commit/62f20e068ccc50d6ab66fdb72ba90da2b9418c99" title="">62f20e</a>), mitigating this dual-stack weakness and related issues <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS5.Px1.p3">
<p class="ltx_p" id="S3.SS1.SSS5.Px1.p3.25">Once a collision is found, the remainder of the port scan operates like an idle scan (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS1" title="3.1.1. Idle Scans ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>) with added statistical inference to overcome per-bucket counters’ stochastic increments.
Measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.1.m1.1"><semantics id="S3.SS1.SSS5.Px1.p3.1.m1.1a"><mi id="S3.SS1.SSS5.Px1.p3.1.m1.1.1" xref="S3.SS1.SSS5.Px1.p3.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.1.m1.1b"><ci id="S3.SS1.SSS5.Px1.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.1.m1.1d">italic_M</annotation></semantics></math> first probes the server <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.2.m2.1"><semantics id="S3.SS1.SSS5.Px1.p3.2.m2.1a"><mi id="S3.SS1.SSS5.Px1.p3.2.m2.1.1" xref="S3.SS1.SSS5.Px1.p3.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.2.m2.1b"><ci id="S3.SS1.SSS5.Px1.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.2.m2.1d">italic_S</annotation></semantics></math> with the typical SYN/ACK to obtain the per-bucket IPID <math alttext="x_{1}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.3.m3.1"><semantics id="S3.SS1.SSS5.Px1.p3.3.m3.1a"><msub id="S3.SS1.SSS5.Px1.p3.3.m3.1.1" xref="S3.SS1.SSS5.Px1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p3.3.m3.1.1.2" xref="S3.SS1.SSS5.Px1.p3.3.m3.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.3.m3.1.1.3" xref="S3.SS1.SSS5.Px1.p3.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.3.m3.1b"><apply id="S3.SS1.SSS5.Px1.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.3.m3.1.1.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.3.m3.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.3.m3.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> at time <math alttext="t_{1}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.4.m4.1"><semantics id="S3.SS1.SSS5.Px1.p3.4.m4.1a"><msub id="S3.SS1.SSS5.Px1.p3.4.m4.1.1" xref="S3.SS1.SSS5.Px1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p3.4.m4.1.1.2" xref="S3.SS1.SSS5.Px1.p3.4.m4.1.1.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.4.m4.1.1.3" xref="S3.SS1.SSS5.Px1.p3.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.4.m4.1b"><apply id="S3.SS1.SSS5.Px1.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.4.m4.1.1.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.4.m4.1c">t_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.4.m4.1d">italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
It then spoofs a SYN packet to the client <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.5.m5.1"><semantics id="S3.SS1.SSS5.Px1.p3.5.m5.1a"><mi id="S3.SS1.SSS5.Px1.p3.5.m5.1.1" xref="S3.SS1.SSS5.Px1.p3.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.5.m5.1b"><ci id="S3.SS1.SSS5.Px1.p3.5.m5.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.5.m5.1d">italic_C</annotation></semantics></math> from <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.6.m6.1"><semantics id="S3.SS1.SSS5.Px1.p3.6.m6.1a"><mi id="S3.SS1.SSS5.Px1.p3.6.m6.1.1" xref="S3.SS1.SSS5.Px1.p3.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.6.m6.1b"><ci id="S3.SS1.SSS5.Px1.p3.6.m6.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.6.m6.1d">italic_S</annotation></semantics></math>.
As in the idle scan, this has no effect if the target port on <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.7.m7.1"><semantics id="S3.SS1.SSS5.Px1.p3.7.m7.1a"><mi id="S3.SS1.SSS5.Px1.p3.7.m7.1.1" xref="S3.SS1.SSS5.Px1.p3.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.7.m7.1b"><ci id="S3.SS1.SSS5.Px1.p3.7.m7.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.7.m7.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.7.m7.1d">italic_C</annotation></semantics></math> is closed; otherwise, if it is open, <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.8.m8.1"><semantics id="S3.SS1.SSS5.Px1.p3.8.m8.1a"><mi id="S3.SS1.SSS5.Px1.p3.8.m8.1.1" xref="S3.SS1.SSS5.Px1.p3.8.m8.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.8.m8.1b"><ci id="S3.SS1.SSS5.Px1.p3.8.m8.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.8.m8.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.8.m8.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.8.m8.1d">italic_C</annotation></semantics></math> responds to <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.9.m9.1"><semantics id="S3.SS1.SSS5.Px1.p3.9.m9.1a"><mi id="S3.SS1.SSS5.Px1.p3.9.m9.1.1" xref="S3.SS1.SSS5.Px1.p3.9.m9.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.9.m9.1b"><ci id="S3.SS1.SSS5.Px1.p3.9.m9.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.9.m9.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.9.m9.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.9.m9.1d">italic_S</annotation></semantics></math> with a SYN/ACK, which in turn causes <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.10.m10.1"><semantics id="S3.SS1.SSS5.Px1.p3.10.m10.1a"><mi id="S3.SS1.SSS5.Px1.p3.10.m10.1.1" xref="S3.SS1.SSS5.Px1.p3.10.m10.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.10.m10.1b"><ci id="S3.SS1.SSS5.Px1.p3.10.m10.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.10.m10.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.10.m10.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.10.m10.1d">italic_S</annotation></semantics></math> to respond to <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.11.m11.1"><semantics id="S3.SS1.SSS5.Px1.p3.11.m11.1a"><mi id="S3.SS1.SSS5.Px1.p3.11.m11.1.1" xref="S3.SS1.SSS5.Px1.p3.11.m11.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.11.m11.1b"><ci id="S3.SS1.SSS5.Px1.p3.11.m11.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.11.m11.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.11.m11.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.11.m11.1d">italic_C</annotation></semantics></math> at time <math alttext="t_{2}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.12.m12.1"><semantics id="S3.SS1.SSS5.Px1.p3.12.m12.1a"><msub id="S3.SS1.SSS5.Px1.p3.12.m12.1.1" xref="S3.SS1.SSS5.Px1.p3.12.m12.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p3.12.m12.1.1.2" xref="S3.SS1.SSS5.Px1.p3.12.m12.1.1.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.12.m12.1.1.3" xref="S3.SS1.SSS5.Px1.p3.12.m12.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.12.m12.1b"><apply id="S3.SS1.SSS5.Px1.p3.12.m12.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.12.m12.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.12.m12.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.12.m12.1.1.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.12.m12.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.12.m12.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.12.m12.1c">t_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.12.m12.1d">italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> with an RST containing IPID <math alttext="x_{2}=x_{1}+\mathcal{U}_{[1,t_{2}-t_{1}]}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.13.m13.2"><semantics id="S3.SS1.SSS5.Px1.p3.13.m13.2a"><mrow id="S3.SS1.SSS5.Px1.p3.13.m13.2.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.cmml"><msub id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.cmml"><mi id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.3.cmml">2</mn></msub><mo id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.1" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.1.cmml">=</mo><mrow id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.cmml"><msub id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.cmml"><mi id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.3.cmml">1</mn></msub><mo id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.1" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.1.cmml">+</mo><msub id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3.2.cmml">𝒰</mi><mrow id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.3.cmml"><mo id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.2" stretchy="false" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.3.cmml">[</mo><mn id="S3.SS1.SSS5.Px1.p3.13.m13.1.1.1.1" xref="S3.SS1.SSS5.Px1.p3.13.m13.1.1.1.1.cmml">1</mn><mo id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.3.cmml">,</mo><mrow id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.cmml"><msub id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.cmml"><mi id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.3.cmml">2</mn></msub><mo id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.1" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.1.cmml">−</mo><msub id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.cmml"><mi id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.2" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.3" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.4" stretchy="false" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.3.cmml">]</mo></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.13.m13.2b"><apply id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3"><eq id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.1"></eq><apply id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.2.3">2</cn></apply><apply id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3"><plus id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.1"></plus><apply id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.2.3">1</cn></apply><apply id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.3.3.3.2">𝒰</ci><interval closure="closed" id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.3.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2"><cn id="S3.SS1.SSS5.Px1.p3.13.m13.1.1.1.1.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.13.m13.1.1.1.1">1</cn><apply id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1"><minus id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.1"></minus><apply id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.2.3">2</cn></apply><apply id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.13.m13.2.2.2.2.1.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.13.m13.2c">x_{2}=x_{1}+\mathcal{U}_{[1,t_{2}-t_{1}]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.13.m13.2d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + caligraphic_U start_POSTSUBSCRIPT [ 1 , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] end_POSTSUBSCRIPT</annotation></semantics></math>.
Finally, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.14.m14.1"><semantics id="S3.SS1.SSS5.Px1.p3.14.m14.1a"><mi id="S3.SS1.SSS5.Px1.p3.14.m14.1.1" xref="S3.SS1.SSS5.Px1.p3.14.m14.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.14.m14.1b"><ci id="S3.SS1.SSS5.Px1.p3.14.m14.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.14.m14.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.14.m14.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.14.m14.1d">italic_M</annotation></semantics></math> probes <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.15.m15.1"><semantics id="S3.SS1.SSS5.Px1.p3.15.m15.1a"><mi id="S3.SS1.SSS5.Px1.p3.15.m15.1.1" xref="S3.SS1.SSS5.Px1.p3.15.m15.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.15.m15.1b"><ci id="S3.SS1.SSS5.Px1.p3.15.m15.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.15.m15.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.15.m15.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.15.m15.1d">italic_S</annotation></semantics></math> again to obtain IPID <math alttext="x_{3}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.16.m16.1"><semantics id="S3.SS1.SSS5.Px1.p3.16.m16.1a"><msub id="S3.SS1.SSS5.Px1.p3.16.m16.1.1" xref="S3.SS1.SSS5.Px1.p3.16.m16.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p3.16.m16.1.1.2" xref="S3.SS1.SSS5.Px1.p3.16.m16.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.16.m16.1.1.3" xref="S3.SS1.SSS5.Px1.p3.16.m16.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.16.m16.1b"><apply id="S3.SS1.SSS5.Px1.p3.16.m16.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.16.m16.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.16.m16.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.16.m16.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.16.m16.1.1.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.16.m16.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.16.m16.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.16.m16.1c">x_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.16.m16.1d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> at time <math alttext="t_{3}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.17.m17.1"><semantics id="S3.SS1.SSS5.Px1.p3.17.m17.1a"><msub id="S3.SS1.SSS5.Px1.p3.17.m17.1.1" xref="S3.SS1.SSS5.Px1.p3.17.m17.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p3.17.m17.1.1.2" xref="S3.SS1.SSS5.Px1.p3.17.m17.1.1.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.17.m17.1.1.3" xref="S3.SS1.SSS5.Px1.p3.17.m17.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.17.m17.1b"><apply id="S3.SS1.SSS5.Px1.p3.17.m17.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.17.m17.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.17.m17.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.17.m17.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.17.m17.1.1.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.17.m17.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.17.m17.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.17.m17.1c">t_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.17.m17.1d">italic_t start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>.
If the target port on <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.18.m18.1"><semantics id="S3.SS1.SSS5.Px1.p3.18.m18.1a"><mi id="S3.SS1.SSS5.Px1.p3.18.m18.1.1" xref="S3.SS1.SSS5.Px1.p3.18.m18.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.18.m18.1b"><ci id="S3.SS1.SSS5.Px1.p3.18.m18.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.18.m18.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.18.m18.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.18.m18.1d">italic_C</annotation></semantics></math> is closed, then <math alttext="x_{3}-x_{1}=\mathcal{U}_{[1,t_{3}-t_{1}]}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.19.m19.2"><semantics id="S3.SS1.SSS5.Px1.p3.19.m19.2a"><mrow id="S3.SS1.SSS5.Px1.p3.19.m19.2.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.cmml"><mrow id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.cmml"><msub id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.cmml"><mi id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.3.cmml">3</mn></msub><mo id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.1" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.1.cmml">−</mo><msub id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.cmml"><mi id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.1" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.1.cmml">=</mo><msub id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3.2.cmml">𝒰</mi><mrow id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.3.cmml"><mo id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.2" stretchy="false" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.3.cmml">[</mo><mn id="S3.SS1.SSS5.Px1.p3.19.m19.1.1.1.1" xref="S3.SS1.SSS5.Px1.p3.19.m19.1.1.1.1.cmml">1</mn><mo id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.3.cmml">,</mo><mrow id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.cmml"><msub id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.cmml"><mi id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.3.cmml">3</mn></msub><mo id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.1" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.1.cmml">−</mo><msub id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.cmml"><mi id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.2" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.3" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.4" stretchy="false" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.3.cmml">]</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.19.m19.2b"><apply id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3"><eq id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.1"></eq><apply id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2"><minus id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.1"></minus><apply id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.2.3">3</cn></apply><apply id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.2.3.3">1</cn></apply></apply><apply id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.3.3.2">𝒰</ci><interval closure="closed" id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.3.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2"><cn id="S3.SS1.SSS5.Px1.p3.19.m19.1.1.1.1.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.19.m19.1.1.1.1">1</cn><apply id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1"><minus id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.1"></minus><apply id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.2.3">3</cn></apply><apply id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.19.m19.2.2.2.2.1.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.19.m19.2c">x_{3}-x_{1}=\mathcal{U}_{[1,t_{3}-t_{1}]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.19.m19.2d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT - italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = caligraphic_U start_POSTSUBSCRIPT [ 1 , italic_t start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] end_POSTSUBSCRIPT</annotation></semantics></math>; otherwise, the additional IPID <math alttext="x_{2}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.20.m20.1"><semantics id="S3.SS1.SSS5.Px1.p3.20.m20.1a"><msub id="S3.SS1.SSS5.Px1.p3.20.m20.1.1" xref="S3.SS1.SSS5.Px1.p3.20.m20.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p3.20.m20.1.1.2" xref="S3.SS1.SSS5.Px1.p3.20.m20.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.20.m20.1.1.3" xref="S3.SS1.SSS5.Px1.p3.20.m20.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.20.m20.1b"><apply id="S3.SS1.SSS5.Px1.p3.20.m20.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.20.m20.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.20.m20.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.20.m20.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.20.m20.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.20.m20.1.1.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.20.m20.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.20.m20.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.20.m20.1c">x_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.20.m20.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> generated when <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.21.m21.1"><semantics id="S3.SS1.SSS5.Px1.p3.21.m21.1a"><mi id="S3.SS1.SSS5.Px1.p3.21.m21.1.1" xref="S3.SS1.SSS5.Px1.p3.21.m21.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.21.m21.1b"><ci id="S3.SS1.SSS5.Px1.p3.21.m21.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.21.m21.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.21.m21.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.21.m21.1d">italic_C</annotation></semantics></math> and <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.22.m22.1"><semantics id="S3.SS1.SSS5.Px1.p3.22.m22.1a"><mi id="S3.SS1.SSS5.Px1.p3.22.m22.1.1" xref="S3.SS1.SSS5.Px1.p3.22.m22.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.22.m22.1b"><ci id="S3.SS1.SSS5.Px1.p3.22.m22.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.22.m22.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.22.m22.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.22.m22.1d">italic_S</annotation></semantics></math> completed the SYN handshake means <math alttext="x_{3}-x_{1}=\mathcal{U}_{[1,t_{2}-t_{1}]}+\mathcal{U}_{[1,t_{3}-t_{2}]}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.23.m23.4"><semantics id="S3.SS1.SSS5.Px1.p3.23.m23.4a"><mrow id="S3.SS1.SSS5.Px1.p3.23.m23.4.5" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.cmml"><mrow id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.cmml"><msub id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.cmml"><mi id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.3.cmml">3</mn></msub><mo id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.1.cmml">−</mo><msub id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.cmml"><mi id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.1.cmml">=</mo><mrow id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.cmml"><msub id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2.2.cmml">𝒰</mi><mrow id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.3.cmml"><mo id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.2" stretchy="false" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.3.cmml">[</mo><mn id="S3.SS1.SSS5.Px1.p3.23.m23.1.1.1.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.1.1.1.1.cmml">1</mn><mo id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.3.cmml">,</mo><mrow id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.cmml"><msub id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.cmml"><mi id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.3.cmml">2</mn></msub><mo id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.1.cmml">−</mo><msub id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.cmml"><mi id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.4" stretchy="false" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.3.cmml">]</mo></mrow></msub><mo id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.1.cmml">+</mo><msub id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3.2.cmml">𝒰</mi><mrow id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.3.cmml"><mo id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.2" stretchy="false" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.3.cmml">[</mo><mn id="S3.SS1.SSS5.Px1.p3.23.m23.3.3.1.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.3.3.1.1.cmml">1</mn><mo id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.3.cmml">,</mo><mrow id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.cmml"><msub id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.cmml"><mi id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.3.cmml">3</mn></msub><mo id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.1" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.1.cmml">−</mo><msub id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.cmml"><mi id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.2" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.2.cmml">t</mi><mn id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.3" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.3.cmml">2</mn></msub></mrow><mo id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.4" stretchy="false" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.3.cmml">]</mo></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.23.m23.4b"><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5"><eq id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.1"></eq><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2"><minus id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.1"></minus><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.2.3">3</cn></apply><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.2.3.3">1</cn></apply></apply><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3"><plus id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.1"></plus><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.2.2">𝒰</ci><interval closure="closed" id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.3.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2"><cn id="S3.SS1.SSS5.Px1.p3.23.m23.1.1.1.1.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.23.m23.1.1.1.1">1</cn><apply id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1"><minus id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.1"></minus><apply id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.2.3">2</cn></apply><apply id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.23.m23.2.2.2.2.1.3.3">1</cn></apply></apply></interval></apply><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.5.3.3.2">𝒰</ci><interval closure="closed" id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.3.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2"><cn id="S3.SS1.SSS5.Px1.p3.23.m23.3.3.1.1.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.23.m23.3.3.1.1">1</cn><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1"><minus id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.1"></minus><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.2.3">3</cn></apply><apply id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.1.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.2.cmml" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.2">𝑡</ci><cn id="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.23.m23.4.4.2.2.1.3.3">2</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.23.m23.4c">x_{3}-x_{1}=\mathcal{U}_{[1,t_{2}-t_{1}]}+\mathcal{U}_{[1,t_{3}-t_{2}]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.23.m23.4d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT - italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = caligraphic_U start_POSTSUBSCRIPT [ 1 , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] end_POSTSUBSCRIPT + caligraphic_U start_POSTSUBSCRIPT [ 1 , italic_t start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] end_POSTSUBSCRIPT</annotation></semantics></math>.
These two distributions are distinct, so the status of the target port can be inferred by repeating measurements of <math alttext="x_{1}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.24.m24.1"><semantics id="S3.SS1.SSS5.Px1.p3.24.m24.1a"><msub id="S3.SS1.SSS5.Px1.p3.24.m24.1.1" xref="S3.SS1.SSS5.Px1.p3.24.m24.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p3.24.m24.1.1.2" xref="S3.SS1.SSS5.Px1.p3.24.m24.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.24.m24.1.1.3" xref="S3.SS1.SSS5.Px1.p3.24.m24.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.24.m24.1b"><apply id="S3.SS1.SSS5.Px1.p3.24.m24.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.24.m24.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.24.m24.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.24.m24.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.24.m24.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.24.m24.1.1.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.24.m24.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.24.m24.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.24.m24.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.24.m24.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="x_{3}" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px1.p3.25.m25.1"><semantics id="S3.SS1.SSS5.Px1.p3.25.m25.1a"><msub id="S3.SS1.SSS5.Px1.p3.25.m25.1.1" xref="S3.SS1.SSS5.Px1.p3.25.m25.1.1.cmml"><mi id="S3.SS1.SSS5.Px1.p3.25.m25.1.1.2" xref="S3.SS1.SSS5.Px1.p3.25.m25.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS5.Px1.p3.25.m25.1.1.3" xref="S3.SS1.SSS5.Px1.p3.25.m25.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px1.p3.25.m25.1b"><apply id="S3.SS1.SSS5.Px1.p3.25.m25.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.25.m25.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px1.p3.25.m25.1.1.1.cmml" xref="S3.SS1.SSS5.Px1.p3.25.m25.1.1">subscript</csymbol><ci id="S3.SS1.SSS5.Px1.p3.25.m25.1.1.2.cmml" xref="S3.SS1.SSS5.Px1.p3.25.m25.1.1.2">𝑥</ci><cn id="S3.SS1.SSS5.Px1.p3.25.m25.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px1.p3.25.m25.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px1.p3.25.m25.1c">x_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px1.p3.25.m25.1d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> and applying an appropriate statistical test.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS5.Px2">
<h5 class="ltx_title ltx_title_paragraph">Hybrid Leaks</h5>
<div class="ltx_para" id="S3.SS1.SSS5.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS5.Px2.p1.24">Alexander et al. <cite class="ltx_cite ltx_citemacro_citep">(Alexander et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib2" title="">2019</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>S) introduced <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS5.Px2.p1.24.1">hybrid leaks</span>, a measurement that detects active TCP connections between a Linux server <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.1.m1.1"><semantics id="S3.SS1.SSS5.Px2.p1.1.m1.1a"><mi id="S3.SS1.SSS5.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS5.Px2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.1.m1.1b"><ci id="S3.SS1.SSS5.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.1.m1.1d">italic_S</annotation></semantics></math> and any of its clients <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.2.m2.1"><semantics id="S3.SS1.SSS5.Px2.p1.2.m2.1a"><mi id="S3.SS1.SSS5.Px2.p1.2.m2.1.1" xref="S3.SS1.SSS5.Px2.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.2.m2.1b"><ci id="S3.SS1.SSS5.Px2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.2.m2.1d">italic_C</annotation></semantics></math> by differentiating between Linux’s hybrid modes of per-bucket and per-connection selection.
First, a measurer <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.3.m3.1"><semantics id="S3.SS1.SSS5.Px2.p1.3.m3.1a"><mi id="S3.SS1.SSS5.Px2.p1.3.m3.1.1" xref="S3.SS1.SSS5.Px2.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.3.m3.1b"><ci id="S3.SS1.SSS5.Px2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.3.m3.1d">italic_M</annotation></semantics></math> finds a hash collision with <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.4.m4.1"><semantics id="S3.SS1.SSS5.Px2.p1.4.m4.1a"><mi id="S3.SS1.SSS5.Px2.p1.4.m4.1.1" xref="S3.SS1.SSS5.Px2.p1.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.4.m4.1b"><ci id="S3.SS1.SSS5.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.4.m4.1d">italic_C</annotation></semantics></math> on <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.5.m5.1"><semantics id="S3.SS1.SSS5.Px2.p1.5.m5.1a"><mi id="S3.SS1.SSS5.Px2.p1.5.m5.1.1" xref="S3.SS1.SSS5.Px2.p1.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.5.m5.1b"><ci id="S3.SS1.SSS5.Px2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.5.m5.1d">italic_S</annotation></semantics></math> using a simplified version of the Zhang et al. <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib61" title="">2018</a>)</cite> method described above.
It then sends an unsolicited SYN/ACK to <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.6.m6.1"><semantics id="S3.SS1.SSS5.Px2.p1.6.m6.1a"><mi id="S3.SS1.SSS5.Px2.p1.6.m6.1.1" xref="S3.SS1.SSS5.Px2.p1.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.6.m6.1b"><ci id="S3.SS1.SSS5.Px2.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.6.m6.1d">italic_S</annotation></semantics></math> and obtains the current per-bucket IPID <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.7.m7.1"><semantics id="S3.SS1.SSS5.Px2.p1.7.m7.1a"><mi id="S3.SS1.SSS5.Px2.p1.7.m7.1.1" xref="S3.SS1.SSS5.Px2.p1.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.7.m7.1b"><ci id="S3.SS1.SSS5.Px2.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.7.m7.1d">italic_x</annotation></semantics></math> from the RST reply.
Next, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.8.m8.1"><semantics id="S3.SS1.SSS5.Px2.p1.8.m8.1a"><mi id="S3.SS1.SSS5.Px2.p1.8.m8.1.1" xref="S3.SS1.SSS5.Px2.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.8.m8.1b"><ci id="S3.SS1.SSS5.Px2.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.8.m8.1d">italic_M</annotation></semantics></math> spoofs <math alttext="s&gt;1" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.9.m9.1"><semantics id="S3.SS1.SSS5.Px2.p1.9.m9.1a"><mrow id="S3.SS1.SSS5.Px2.p1.9.m9.1.1" xref="S3.SS1.SSS5.Px2.p1.9.m9.1.1.cmml"><mi id="S3.SS1.SSS5.Px2.p1.9.m9.1.1.2" xref="S3.SS1.SSS5.Px2.p1.9.m9.1.1.2.cmml">s</mi><mo id="S3.SS1.SSS5.Px2.p1.9.m9.1.1.1" xref="S3.SS1.SSS5.Px2.p1.9.m9.1.1.1.cmml">&gt;</mo><mn id="S3.SS1.SSS5.Px2.p1.9.m9.1.1.3" xref="S3.SS1.SSS5.Px2.p1.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.9.m9.1b"><apply id="S3.SS1.SSS5.Px2.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.9.m9.1.1"><gt id="S3.SS1.SSS5.Px2.p1.9.m9.1.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.9.m9.1.1.1"></gt><ci id="S3.SS1.SSS5.Px2.p1.9.m9.1.1.2.cmml" xref="S3.SS1.SSS5.Px2.p1.9.m9.1.1.2">𝑠</ci><cn id="S3.SS1.SSS5.Px2.p1.9.m9.1.1.3.cmml" type="integer" xref="S3.SS1.SSS5.Px2.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.9.m9.1c">s&gt;1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.9.m9.1d">italic_s &gt; 1</annotation></semantics></math> SYN/ACKs from <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.10.m10.1"><semantics id="S3.SS1.SSS5.Px2.p1.10.m10.1a"><mi id="S3.SS1.SSS5.Px2.p1.10.m10.1.1" xref="S3.SS1.SSS5.Px2.p1.10.m10.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.10.m10.1b"><ci id="S3.SS1.SSS5.Px2.p1.10.m10.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.10.m10.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.10.m10.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.10.m10.1d">italic_C</annotation></semantics></math> to <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.11.m11.1"><semantics id="S3.SS1.SSS5.Px2.p1.11.m11.1a"><mi id="S3.SS1.SSS5.Px2.p1.11.m11.1.1" xref="S3.SS1.SSS5.Px2.p1.11.m11.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.11.m11.1b"><ci id="S3.SS1.SSS5.Px2.p1.11.m11.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.11.m11.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.11.m11.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.11.m11.1d">italic_S</annotation></semantics></math> containing a guessed source port and a standard TCP destination port (i.e., 80 or 443).
If <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.12.m12.1"><semantics id="S3.SS1.SSS5.Px2.p1.12.m12.1a"><mi id="S3.SS1.SSS5.Px2.p1.12.m12.1.1" xref="S3.SS1.SSS5.Px2.p1.12.m12.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.12.m12.1b"><ci id="S3.SS1.SSS5.Px2.p1.12.m12.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.12.m12.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.12.m12.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.12.m12.1d">italic_S</annotation></semantics></math> and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.13.m13.1"><semantics id="S3.SS1.SSS5.Px2.p1.13.m13.1a"><mi id="S3.SS1.SSS5.Px2.p1.13.m13.1.1" xref="S3.SS1.SSS5.Px2.p1.13.m13.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.13.m13.1b"><ci id="S3.SS1.SSS5.Px2.p1.13.m13.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.13.m13.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.13.m13.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.13.m13.1d">italic_C</annotation></semantics></math> have an active TCP connection on those ports, <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.14.m14.1"><semantics id="S3.SS1.SSS5.Px2.p1.14.m14.1a"><mi id="S3.SS1.SSS5.Px2.p1.14.m14.1.1" xref="S3.SS1.SSS5.Px2.p1.14.m14.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.14.m14.1b"><ci id="S3.SS1.SSS5.Px2.p1.14.m14.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.14.m14.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.14.m14.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.14.m14.1d">italic_S</annotation></semantics></math> replies to <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.15.m15.1"><semantics id="S3.SS1.SSS5.Px2.p1.15.m15.1a"><mi id="S3.SS1.SSS5.Px2.p1.15.m15.1.1" xref="S3.SS1.SSS5.Px2.p1.15.m15.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.15.m15.1b"><ci id="S3.SS1.SSS5.Px2.p1.15.m15.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.15.m15.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.15.m15.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.15.m15.1d">italic_C</annotation></semantics></math> with a single “challenge ACK” whose IPID is drawn from their per-connection counter.
Otherwise, <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.16.m16.1"><semantics id="S3.SS1.SSS5.Px2.p1.16.m16.1a"><mi id="S3.SS1.SSS5.Px2.p1.16.m16.1.1" xref="S3.SS1.SSS5.Px2.p1.16.m16.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.16.m16.1b"><ci id="S3.SS1.SSS5.Px2.p1.16.m16.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.16.m16.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.16.m16.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.16.m16.1d">italic_S</annotation></semantics></math> replies to <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.17.m17.1"><semantics id="S3.SS1.SSS5.Px2.p1.17.m17.1a"><mi id="S3.SS1.SSS5.Px2.p1.17.m17.1.1" xref="S3.SS1.SSS5.Px2.p1.17.m17.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.17.m17.1b"><ci id="S3.SS1.SSS5.Px2.p1.17.m17.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.17.m17.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.17.m17.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.17.m17.1d">italic_C</annotation></semantics></math> with <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.18.m18.1"><semantics id="S3.SS1.SSS5.Px2.p1.18.m18.1a"><mi id="S3.SS1.SSS5.Px2.p1.18.m18.1.1" xref="S3.SS1.SSS5.Px2.p1.18.m18.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.18.m18.1b"><ci id="S3.SS1.SSS5.Px2.p1.18.m18.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.18.m18.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.18.m18.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.18.m18.1d">italic_s</annotation></semantics></math> RST packets whose IPIDs each increment the per-bucket counter.
Finally, <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.19.m19.1"><semantics id="S3.SS1.SSS5.Px2.p1.19.m19.1a"><mi id="S3.SS1.SSS5.Px2.p1.19.m19.1.1" xref="S3.SS1.SSS5.Px2.p1.19.m19.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.19.m19.1b"><ci id="S3.SS1.SSS5.Px2.p1.19.m19.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.19.m19.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.19.m19.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.19.m19.1d">italic_M</annotation></semantics></math> probes the updated per-bucket IPID <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.20.m20.1"><semantics id="S3.SS1.SSS5.Px2.p1.20.m20.1a"><mi id="S3.SS1.SSS5.Px2.p1.20.m20.1.1" xref="S3.SS1.SSS5.Px2.p1.20.m20.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.20.m20.1b"><ci id="S3.SS1.SSS5.Px2.p1.20.m20.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.20.m20.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.20.m20.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.20.m20.1d">italic_y</annotation></semantics></math>.
Assuming <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.21.m21.1"><semantics id="S3.SS1.SSS5.Px2.p1.21.m21.1a"><mi id="S3.SS1.SSS5.Px2.p1.21.m21.1.1" xref="S3.SS1.SSS5.Px2.p1.21.m21.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.21.m21.1b"><ci id="S3.SS1.SSS5.Px2.p1.21.m21.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.21.m21.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.21.m21.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.21.m21.1d">italic_M</annotation></semantics></math> sends its packets fast enough to avoid the per-bucket counter’s stochastic increments, <math alttext="y-x\bmod 2^{16}&lt;s" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.22.m22.1"><semantics id="S3.SS1.SSS5.Px2.p1.22.m22.1a"><mrow id="S3.SS1.SSS5.Px2.p1.22.m22.1.1" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.cmml"><mrow id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.cmml"><mrow id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.cmml"><mi id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.2" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.2.cmml">y</mi><mo id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.1" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.1.cmml">−</mo><mi id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.3" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.3.cmml">x</mi></mrow><mo id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.1" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.1.cmml">mod</mo><msup id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.cmml"><mn id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.2" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.2.cmml">2</mn><mn id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.3" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.3.cmml">16</mn></msup></mrow><mo id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.1" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.1.cmml">&lt;</mo><mi id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.3" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.22.m22.1b"><apply id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1"><lt id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.1"></lt><apply id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2"><csymbol cd="latexml" id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.1.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.1">modulo</csymbol><apply id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2"><minus id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.1.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.1"></minus><ci id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.2.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.2">𝑦</ci><ci id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.3.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.2.3">𝑥</ci></apply><apply id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.1.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3">superscript</csymbol><cn id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.2.cmml" type="integer" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.2">2</cn><cn id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.3.cmml" type="integer" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.2.3.3">16</cn></apply></apply><ci id="S3.SS1.SSS5.Px2.p1.22.m22.1.1.3.cmml" xref="S3.SS1.SSS5.Px2.p1.22.m22.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.22.m22.1c">y-x\bmod 2^{16}&lt;s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.22.m22.1d">italic_y - italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT &lt; italic_s</annotation></semantics></math> is evidence that <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.23.m23.1"><semantics id="S3.SS1.SSS5.Px2.p1.23.m23.1a"><mi id="S3.SS1.SSS5.Px2.p1.23.m23.1.1" xref="S3.SS1.SSS5.Px2.p1.23.m23.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.23.m23.1b"><ci id="S3.SS1.SSS5.Px2.p1.23.m23.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.23.m23.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.23.m23.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.23.m23.1d">italic_S</annotation></semantics></math> and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS5.Px2.p1.24.m24.1"><semantics id="S3.SS1.SSS5.Px2.p1.24.m24.1a"><mi id="S3.SS1.SSS5.Px2.p1.24.m24.1.1" xref="S3.SS1.SSS5.Px2.p1.24.m24.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS5.Px2.p1.24.m24.1b"><ci id="S3.SS1.SSS5.Px2.p1.24.m24.1.1.cmml" xref="S3.SS1.SSS5.Px2.p1.24.m24.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS5.Px2.p1.24.m24.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS5.Px2.p1.24.m24.1d">italic_C</annotation></semantics></math> have an active connection.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS5.Px2.p2">
<p class="ltx_p" id="S3.SS1.SSS5.Px2.p2.1">Linux mitigated this probe comparison measurement—and others depending on unsolicited SYN/ACK probes and their RST replies <cite class="ltx_cite ltx_citemacro_citep">(antirez, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib3" title="">1998</a>; lkm, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib42" title="">2007</a>; Qian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib56" title="">2010</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib61" title="">2018</a>)</cite>—by replying to any unsolicited SYN/ACK with an RST whose IPID is zero (see Linux commit <a class="ltx_ref ltx_href" href="https://github.com/torvalds/linux/commit/431280eebed9f5079553daf003011097763e71fd" title="">431280</a>).</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS5.Px3">
<h5 class="ltx_title ltx_title_paragraph">Device Fingerprinting</h5>
<div class="ltx_para" id="S3.SS1.SSS5.Px3.p1">
<p class="ltx_p" id="S3.SS1.SSS5.Px3.p1.1">Klein and Pinkas <cite class="ltx_cite ltx_citemacro_citep">(Klein and Pinkas, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib38" title="">2019</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>U) exfiltrated the secret keys Windows and Linux used in their bucket hashes, enabling a measurer to fingerprint and track a device as well as predict all per-bucket counters’ IPIDs.
In response, Linux increased their key size to 128 bits and updated their hash function to SipHash-2-4, which remains their current implementation (see Linux commit <a class="ltx_ref ltx_href" href="https://github.com/torvalds/linux/commit/df453700e8d81b1bdafdf684365ee2b9431fb702" title="">df4537</a>).
Notably, Windows chose to address this issue by replacing per-bucket selection with per-destination <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite> which, as already discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS4" title="3.1.4. Canary Fragments ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.4</span></a>, has a high performance impact and has been exploited successfully before <cite class="ltx_cite ltx_citemacro_citep">(Knockel and Crandall, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib39" title="">2014</a>; Malhotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib44" title="">2016</a>)</cite>.
Since Windows is closed-source, it remains unclear if analogous measurements would succeed against their current implementation.</p>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS6">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.6. </span>TCP Injection Attacks</h4>
<div class="ltx_para" id="S3.SS1.SSS6.p1">
<p class="ltx_p" id="S3.SS1.SSS6.p1.4">In a <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS6.p1.4.1">TCP injection attack</span>, an attacker inserts malicious traffic into an active TCP connection between a client and server.
To do so, the attacker needs to know the client and server’s IP addresses and TCP ports along with the current TCP sequence number of the machine the attacker is spoofing.
Most attacks assume the two IP addresses are known and the server is using a standard port for TCP (e.g., 80 or 443), leaving the client’s port and sequence number as the two unknowns.
But if the client uses globally incrementing IPIDs, an off-path attacker can learn the client’s port and sequence number through a port comparison guess-and-check <cite class="ltx_cite ltx_citemacro_citep">(lkm, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib42" title="">2007</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>D).
The attacker (1) probes the client’s IPID, say <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.SSS6.p1.1.m1.1"><semantics id="S3.SS1.SSS6.p1.1.m1.1a"><mi id="S3.SS1.SSS6.p1.1.m1.1.1" xref="S3.SS1.SSS6.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS6.p1.1.m1.1b"><ci id="S3.SS1.SSS6.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS6.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS6.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS6.p1.1.m1.1d">italic_x</annotation></semantics></math>, (2) sends packets that are specifically crafted to make the client increment its IPID if and only if its guessed port or sequence number is correct, (3) probes the client’s new IPID, say <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.SSS6.p1.2.m2.1"><semantics id="S3.SS1.SSS6.p1.2.m2.1a"><mi id="S3.SS1.SSS6.p1.2.m2.1.1" xref="S3.SS1.SSS6.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS6.p1.2.m2.1b"><ci id="S3.SS1.SSS6.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS6.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS6.p1.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS6.p1.2.m2.1d">italic_y</annotation></semantics></math>, and (4) compares <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.SSS6.p1.3.m3.1"><semantics id="S3.SS1.SSS6.p1.3.m3.1a"><mi id="S3.SS1.SSS6.p1.3.m3.1.1" xref="S3.SS1.SSS6.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS6.p1.3.m3.1b"><ci id="S3.SS1.SSS6.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS6.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS6.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS6.p1.3.m3.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.SSS6.p1.4.m4.1"><semantics id="S3.SS1.SSS6.p1.4.m4.1a"><mi id="S3.SS1.SSS6.p1.4.m4.1.1" xref="S3.SS1.SSS6.p1.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS6.p1.4.m4.1b"><ci id="S3.SS1.SSS6.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS6.p1.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS6.p1.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS6.p1.4.m4.1d">italic_y</annotation></semantics></math> to determine the accuracy of its guess.
Just like for idle scans (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS1" title="3.1.1. Idle Scans ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>), this attack’s second step depends critically on the connection having little traffic, since other packets incrementing the client’s IPID would confuse the results.
However, Gilad and Herzberg <cite class="ltx_cite ltx_citemacro_citep">(Gilad and Herzberg, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib24" title="">2012</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib26" title="">2014</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>J,M) showed that with a “puppet” on the client (e.g., a malicious script in a browser sandbox), this attack can succeed even on noisier connections.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS6.p2">
<p class="ltx_p" id="S3.SS1.SSS6.p2.1">Naturally, the defense against this guess-and-check technique and the resulting TCP injections is to use an IPID selection method that is less predictable or harder for an attacker to access.
However, this must be done on all machines involved in the connection, not just the client.
Qian and Mao <cite class="ltx_cite ltx_citemacro_citep">(Qian and Mao, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib55" title="">2012</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>H) showed that even if a client’s IPIDs are difficult to predict, a firewall or middlebox using globally incrementing IPIDs can leak the sequence numbers necessary for TCP injection.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS6.p3">
<p class="ltx_p" id="S3.SS1.SSS6.p3.1">The state-of-the-art attacks remained specific to globally incrementing IPIDs for 13 years, until Feng et al. <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib21" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib22" title="">2022</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>W,Y) introduced their novel <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS6.p3.1.1">downgrade attacks</span> to achieve TCP injection against Linux’s hybrid per-connection/per-bucket IPIDs.
Recall that when guess-and-checking the client’s TCP port and sequence numbers, the attacker needs to probe the client’s relevant IPIDs.
But it is impossible for the attacker to probe the per-connection counter specific to this client–server’s active TCP connection unless it had the very information it’s trying to leak.
Instead, Feng et al. observe that per-connection selection can be downgraded to per-bucket selection by spoofing ICMP “Fragmentation Needed” packets from the client to the server, tricking it into clearing its responses’ DF flags and thus demoting otherwise atomic packets to non-atomic.
The client’s corresponding bucket counter can then be identified and probed using the hash collision techniques described in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS5" title="3.1.5. Bucket Leaks ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.5</span></a>, and an appropriately modified version of the above guess-and-check technique will leak the client port and sequence number(s) needed for TCP injection.
Linux mitigated this issue in a case-specific manner, replacing per-bucket selection with an IPID generated by <span class="ltx_text ltx_font_typewriter" id="S3.SS1.SSS6.p3.1.2">prandom_u32</span> only for SYN/ACKs that are large enough to be fragmented (see Linux commit <a class="ltx_ref ltx_href" href="https://github.com/torvalds/linux/commit/970a5a3ea86da637471d3cd04d513a0755aba4bf" title="">970a5a</a>).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS7">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.7. </span>Covert Channels</h4>
<div class="ltx_para" id="S3.SS1.SSS7.p1">
<p class="ltx_p" id="S3.SS1.SSS7.p1.1">A <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS7.p1.1.1">covert channel</span> is an attack that transfers data between two processes or machines that are not supposed to be able to communicate, e.g., a privileged program leaking data to an unprivileged user <cite class="ltx_cite ltx_citemacro_citep">(Lampson, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib41" title="">1973</a>)</cite>.
Klein <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>Z) recently demonstrated that both counter-based and PRNG-based IPIDs can be used as covert channels to transmit information from a sender within an isolated network to any external receiver.
Although the details differ across OSes and IPID selection methods, the main idea is for the isolated sender to force its outside-facing firewall or host machine to either send a number of packets (signalling a 1 bit) or not (signalling a 0 bit), which the external receiver can view via probe comparison of the firewall/host’s IPIDs.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS7.p2">
<p class="ltx_p" id="S3.SS1.SSS7.p2.9">Perhaps the most surprising of these covert channels uses PRNG selection with a searchable queue of size <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.1.m1.1"><semantics id="S3.SS1.SSS7.p2.1.m1.1a"><mi id="S3.SS1.SSS7.p2.1.m1.1.1" xref="S3.SS1.SSS7.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.1.m1.1b"><ci id="S3.SS1.SSS7.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS7.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.1.m1.1d">italic_k</annotation></semantics></math>, since PRNG IPIDs’ unpredictability is not a defense in this case.
First, the receiver quickly sends <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.2.m2.1"><semantics id="S3.SS1.SSS7.p2.2.m2.1a"><mi id="S3.SS1.SSS7.p2.2.m2.1.1" xref="S3.SS1.SSS7.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.2.m2.1b"><ci id="S3.SS1.SSS7.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS7.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.2.m2.1d">italic_k</annotation></semantics></math> probes to the firewall/host so that the replies’ IPIDs <math alttext="x_{1},\ldots,x_{k}" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.3.m3.3"><semantics id="S3.SS1.SSS7.p2.3.m3.3a"><mrow id="S3.SS1.SSS7.p2.3.m3.3.3.2" xref="S3.SS1.SSS7.p2.3.m3.3.3.3.cmml"><msub id="S3.SS1.SSS7.p2.3.m3.2.2.1.1" xref="S3.SS1.SSS7.p2.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.SSS7.p2.3.m3.2.2.1.1.2" xref="S3.SS1.SSS7.p2.3.m3.2.2.1.1.2.cmml">x</mi><mn id="S3.SS1.SSS7.p2.3.m3.2.2.1.1.3" xref="S3.SS1.SSS7.p2.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS7.p2.3.m3.3.3.2.3" xref="S3.SS1.SSS7.p2.3.m3.3.3.3.cmml">,</mo><mi id="S3.SS1.SSS7.p2.3.m3.1.1" mathvariant="normal" xref="S3.SS1.SSS7.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.SSS7.p2.3.m3.3.3.2.4" xref="S3.SS1.SSS7.p2.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS1.SSS7.p2.3.m3.3.3.2.2" xref="S3.SS1.SSS7.p2.3.m3.3.3.2.2.cmml"><mi id="S3.SS1.SSS7.p2.3.m3.3.3.2.2.2" xref="S3.SS1.SSS7.p2.3.m3.3.3.2.2.2.cmml">x</mi><mi id="S3.SS1.SSS7.p2.3.m3.3.3.2.2.3" xref="S3.SS1.SSS7.p2.3.m3.3.3.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.3.m3.3b"><list id="S3.SS1.SSS7.p2.3.m3.3.3.3.cmml" xref="S3.SS1.SSS7.p2.3.m3.3.3.2"><apply id="S3.SS1.SSS7.p2.3.m3.2.2.1.1.cmml" xref="S3.SS1.SSS7.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS7.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.SSS7.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS7.p2.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.SSS7.p2.3.m3.2.2.1.1.2">𝑥</ci><cn id="S3.SS1.SSS7.p2.3.m3.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.SSS7.p2.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS7.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS7.p2.3.m3.1.1">…</ci><apply id="S3.SS1.SSS7.p2.3.m3.3.3.2.2.cmml" xref="S3.SS1.SSS7.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS7.p2.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.SSS7.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS7.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.SSS7.p2.3.m3.3.3.2.2.2">𝑥</ci><ci id="S3.SS1.SSS7.p2.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.SSS7.p2.3.m3.3.3.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.3.m3.3c">x_{1},\ldots,x_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.3.m3.3d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are exactly those in the searchable queue.
The isolated sender then communicates a 0 or 1 bit as described above.
Finally, the receiver sends another <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.4.m4.1"><semantics id="S3.SS1.SSS7.p2.4.m4.1a"><mi id="S3.SS1.SSS7.p2.4.m4.1.1" xref="S3.SS1.SSS7.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.4.m4.1b"><ci id="S3.SS1.SSS7.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS7.p2.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.4.m4.1d">italic_k</annotation></semantics></math> probes to the firewall/host to obtain IPIDs <math alttext="y_{1},\ldots,y_{k}" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.5.m5.3"><semantics id="S3.SS1.SSS7.p2.5.m5.3a"><mrow id="S3.SS1.SSS7.p2.5.m5.3.3.2" xref="S3.SS1.SSS7.p2.5.m5.3.3.3.cmml"><msub id="S3.SS1.SSS7.p2.5.m5.2.2.1.1" xref="S3.SS1.SSS7.p2.5.m5.2.2.1.1.cmml"><mi id="S3.SS1.SSS7.p2.5.m5.2.2.1.1.2" xref="S3.SS1.SSS7.p2.5.m5.2.2.1.1.2.cmml">y</mi><mn id="S3.SS1.SSS7.p2.5.m5.2.2.1.1.3" xref="S3.SS1.SSS7.p2.5.m5.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS7.p2.5.m5.3.3.2.3" xref="S3.SS1.SSS7.p2.5.m5.3.3.3.cmml">,</mo><mi id="S3.SS1.SSS7.p2.5.m5.1.1" mathvariant="normal" xref="S3.SS1.SSS7.p2.5.m5.1.1.cmml">…</mi><mo id="S3.SS1.SSS7.p2.5.m5.3.3.2.4" xref="S3.SS1.SSS7.p2.5.m5.3.3.3.cmml">,</mo><msub id="S3.SS1.SSS7.p2.5.m5.3.3.2.2" xref="S3.SS1.SSS7.p2.5.m5.3.3.2.2.cmml"><mi id="S3.SS1.SSS7.p2.5.m5.3.3.2.2.2" xref="S3.SS1.SSS7.p2.5.m5.3.3.2.2.2.cmml">y</mi><mi id="S3.SS1.SSS7.p2.5.m5.3.3.2.2.3" xref="S3.SS1.SSS7.p2.5.m5.3.3.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.5.m5.3b"><list id="S3.SS1.SSS7.p2.5.m5.3.3.3.cmml" xref="S3.SS1.SSS7.p2.5.m5.3.3.2"><apply id="S3.SS1.SSS7.p2.5.m5.2.2.1.1.cmml" xref="S3.SS1.SSS7.p2.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS7.p2.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.SSS7.p2.5.m5.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS7.p2.5.m5.2.2.1.1.2.cmml" xref="S3.SS1.SSS7.p2.5.m5.2.2.1.1.2">𝑦</ci><cn id="S3.SS1.SSS7.p2.5.m5.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.SSS7.p2.5.m5.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS7.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS7.p2.5.m5.1.1">…</ci><apply id="S3.SS1.SSS7.p2.5.m5.3.3.2.2.cmml" xref="S3.SS1.SSS7.p2.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS7.p2.5.m5.3.3.2.2.1.cmml" xref="S3.SS1.SSS7.p2.5.m5.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS7.p2.5.m5.3.3.2.2.2.cmml" xref="S3.SS1.SSS7.p2.5.m5.3.3.2.2.2">𝑦</ci><ci id="S3.SS1.SSS7.p2.5.m5.3.3.2.2.3.cmml" xref="S3.SS1.SSS7.p2.5.m5.3.3.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.5.m5.3c">y_{1},\ldots,y_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.5.m5.3d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
If there is overlap between the <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.6.m6.1"><semantics id="S3.SS1.SSS7.p2.6.m6.1a"><msub id="S3.SS1.SSS7.p2.6.m6.1.1" xref="S3.SS1.SSS7.p2.6.m6.1.1.cmml"><mi id="S3.SS1.SSS7.p2.6.m6.1.1.2" xref="S3.SS1.SSS7.p2.6.m6.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS7.p2.6.m6.1.1.3" xref="S3.SS1.SSS7.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.6.m6.1b"><apply id="S3.SS1.SSS7.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS7.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS7.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS7.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS7.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS7.p2.6.m6.1.1.2">𝑥</ci><ci id="S3.SS1.SSS7.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS7.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.6.m6.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>’s and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.7.m7.1"><semantics id="S3.SS1.SSS7.p2.7.m7.1a"><msub id="S3.SS1.SSS7.p2.7.m7.1.1" xref="S3.SS1.SSS7.p2.7.m7.1.1.cmml"><mi id="S3.SS1.SSS7.p2.7.m7.1.1.2" xref="S3.SS1.SSS7.p2.7.m7.1.1.2.cmml">y</mi><mi id="S3.SS1.SSS7.p2.7.m7.1.1.3" xref="S3.SS1.SSS7.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.7.m7.1b"><apply id="S3.SS1.SSS7.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS7.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS7.p2.7.m7.1.1.1.cmml" xref="S3.SS1.SSS7.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS7.p2.7.m7.1.1.2.cmml" xref="S3.SS1.SSS7.p2.7.m7.1.1.2">𝑦</ci><ci id="S3.SS1.SSS7.p2.7.m7.1.1.3.cmml" xref="S3.SS1.SSS7.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.7.m7.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.7.m7.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>’s, some packets must have been sent between the two sets of probes to evict the original members in the queue, likely indicating that the sender communicated a 1 bit; otherwise, if the <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.8.m8.1"><semantics id="S3.SS1.SSS7.p2.8.m8.1a"><msub id="S3.SS1.SSS7.p2.8.m8.1.1" xref="S3.SS1.SSS7.p2.8.m8.1.1.cmml"><mi id="S3.SS1.SSS7.p2.8.m8.1.1.2" xref="S3.SS1.SSS7.p2.8.m8.1.1.2.cmml">x</mi><mi id="S3.SS1.SSS7.p2.8.m8.1.1.3" xref="S3.SS1.SSS7.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.8.m8.1b"><apply id="S3.SS1.SSS7.p2.8.m8.1.1.cmml" xref="S3.SS1.SSS7.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS7.p2.8.m8.1.1.1.cmml" xref="S3.SS1.SSS7.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.SSS7.p2.8.m8.1.1.2.cmml" xref="S3.SS1.SSS7.p2.8.m8.1.1.2">𝑥</ci><ci id="S3.SS1.SSS7.p2.8.m8.1.1.3.cmml" xref="S3.SS1.SSS7.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.8.m8.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.8.m8.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>’s and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS7.p2.9.m9.1"><semantics id="S3.SS1.SSS7.p2.9.m9.1a"><msub id="S3.SS1.SSS7.p2.9.m9.1.1" xref="S3.SS1.SSS7.p2.9.m9.1.1.cmml"><mi id="S3.SS1.SSS7.p2.9.m9.1.1.2" xref="S3.SS1.SSS7.p2.9.m9.1.1.2.cmml">y</mi><mi id="S3.SS1.SSS7.p2.9.m9.1.1.3" xref="S3.SS1.SSS7.p2.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS7.p2.9.m9.1b"><apply id="S3.SS1.SSS7.p2.9.m9.1.1.cmml" xref="S3.SS1.SSS7.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS7.p2.9.m9.1.1.1.cmml" xref="S3.SS1.SSS7.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.SSS7.p2.9.m9.1.1.2.cmml" xref="S3.SS1.SSS7.p2.9.m9.1.1.2">𝑦</ci><ci id="S3.SS1.SSS7.p2.9.m9.1.1.3.cmml" xref="S3.SS1.SSS7.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS7.p2.9.m9.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS7.p2.9.m9.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>’s are disjoint, the sender likely communicated a 0 bit.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS7.p3">
<p class="ltx_p" id="S3.SS1.SSS7.p3.1">All major OSes except Windows and OpenBSD released patches for these covert channels.
<span class="ltx_ERROR undefined" id="S3.SS1.SSS7.p3.1.1">\added</span>In particular, macOS mitigated this issue by removing the searchable queue from its PRNG selection, abandoning the idea of reserving IPIDs for non-repetition altogether (see XNU <a class="ltx_ref ltx_href" href="https://github.com/apple-oss-distributions/xnu/blob/xnu-8019.61.5/bsd/netinet/ip_id.c" title="">v8019.61.5</a>, which introduced the change, and <a class="ltx_ref ltx_href" href="https://github.com/apple-oss-distributions/xnu/blob/xnu-8792.41.9/bsd/netinet/ip_id.c" title="">v8792.41.9</a>, which fixed a minor bug for avoiding IPID zero).</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Fragment Injections</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">In <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.1">fragment injection</span>, the attacker plants one or more malicious fragments appearing to originate from some trusted source in a target machine’s reassembly buffer.
If any of these fragments’ IPIDs match that of a legitimate fragmented packet from the trusted source, a malicious fragment may replace a legitimate one during reassembly.
This technique has been used to poison DNS caches and forge domain validation certificates (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2.SSS1" title="3.2.1. DNS Attacks ‣ 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>), intercept traffic behind a NAT (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2.SSS2" title="3.2.2. NAT Packet Interception ‣ 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>), and shift time on NTP clients (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2.SSS3" title="3.2.3. Shifting NTP Time ‣ 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.2.3</span></a>).
The general template for fragment injection is:</p>
<ol class="ltx_enumerate" id="S3.I3">
<li class="ltx_item" id="S3.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S3.I3.i1.p1">
<p class="ltx_p" id="S3.I3.i1.p1.1">Ensure traffic from the trusted source to the target machine will be fragmented (e.g., by spoofing an ICMP “Fragmentation Needed” packet from the target to the source).</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S3.I3.i2.p1">
<p class="ltx_p" id="S3.I3.i2.p1.1">Predict the IPID(s) that the trusted source will assign to the packets targeted for fragment injection, potentially using the probe comparisons outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1" title="3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(3)</span>
<div class="ltx_para" id="S3.I3.i3.p1">
<p class="ltx_p" id="S3.I3.i3.p1.1">If needed, use path MTU discovery or other measurement methods to learn the necessary parameters for crafting malicious fragments.</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(4)</span>
<div class="ltx_para" id="S3.I3.i4.p1">
<p class="ltx_p" id="S3.I3.i4.p1.1">Spoof malicious fragments from the trusted source to the target machine.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S3.SS2.p1.2">There is one salient necessary condition for successful fragment injections:</p>
<ol class="ltx_enumerate" id="S3.I4">
<li class="ltx_item" id="S3.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(FI1)</span>
<div class="ltx_para" id="S3.I4.i1.p1">
<p class="ltx_p" id="S3.I4.i1.p1.1">An attacker must be able to guess, with reasonable probability, the IPID(s) that the trusted source will assign to the packets targeted for fragment injection.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Fragment injections can be viewed as a special case of <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.1.1">(de)fragmentation attacks</span>, exploits that abuse a machine’s reassembly buffer size, fragment eviction policy, or reassembly strategy for unintended behavior.
For example, a denial of service attack known as “teardrop” abused the fact that older reassembly methods would fail if fragments overlapped by a few bits (<a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-1999-0015" title="">CVE-1999-0015</a>).
Similar attacks were successful across every major OS at some point in time (e.g., <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-1999-0052" title="">CVE-1999-0052</a>, <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-1999-0157" title="">CVE-1999-0157</a>, <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-1999-0431" title="">CVE-1999-0431</a>, <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-2000-0305" title="">CVE-2000-0305</a>, and <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-2004-0744" title="">CVE-2004-0744</a>), and modern fragmentation attacks continue to be a concern for IP stack implementations (e.g., <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-2020-3373" title="">CVE-2020-3373</a>, <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-2020-28041" title="">CVE-2020-28041</a>, <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-2021-3905" title="">CVE-2021-3905</a>, and <a class="ltx_ref ltx_href" href="https://www.cve.org/CVERecord?id=CVE-2023-24821" title="">CVE-2023-24821</a>).
We focus specifically on fragment injections since these depend critically on IPID selection methods and their predictability.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span>DNS Attacks</h4>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="410" id="S3.F5.g1" src="x6.png" width="582"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.25.11.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text ltx_font_italic" id="S3.F5.20.10" style="font-size:90%;">DNS Cache Poisoning Execution.<span class="ltx_text ltx_font_upright" id="S3.F5.20.10.10">
In this attack, an attacker <math alttext="A" class="ltx_Math" display="inline" id="S3.F5.11.1.1.m1.1"><semantics id="S3.F5.11.1.1.m1.1b"><mi id="S3.F5.11.1.1.m1.1.1" xref="S3.F5.11.1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.F5.11.1.1.m1.1c"><ci id="S3.F5.11.1.1.m1.1.1.cmml" xref="S3.F5.11.1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.11.1.1.m1.1d">A</annotation><annotation encoding="application/x-llamapun" id="S3.F5.11.1.1.m1.1e">italic_A</annotation></semantics></math> is redirecting traffic for a specific domain (e.g., <span class="ltx_text ltx_font_typewriter" id="S3.F5.20.10.10.1">abc.xyz.org</span>) to an IP address of its choosing.
First, <math alttext="A" class="ltx_Math" display="inline" id="S3.F5.12.2.2.m2.1"><semantics id="S3.F5.12.2.2.m2.1b"><mi id="S3.F5.12.2.2.m2.1.1" xref="S3.F5.12.2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.F5.12.2.2.m2.1c"><ci id="S3.F5.12.2.2.m2.1.1.cmml" xref="S3.F5.12.2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.12.2.2.m2.1d">A</annotation><annotation encoding="application/x-llamapun" id="S3.F5.12.2.2.m2.1e">italic_A</annotation></semantics></math> probes the DNS name server <math alttext="S" class="ltx_Math" display="inline" id="S3.F5.13.3.3.m3.1"><semantics id="S3.F5.13.3.3.m3.1b"><mi id="S3.F5.13.3.3.m3.1.1" xref="S3.F5.13.3.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F5.13.3.3.m3.1c"><ci id="S3.F5.13.3.3.m3.1.1.cmml" xref="S3.F5.13.3.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.13.3.3.m3.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F5.13.3.3.m3.1e">italic_S</annotation></semantics></math>’s current IPID, <math alttext="x" class="ltx_Math" display="inline" id="S3.F5.14.4.4.m4.1"><semantics id="S3.F5.14.4.4.m4.1b"><mi id="S3.F5.14.4.4.m4.1.1" xref="S3.F5.14.4.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.F5.14.4.4.m4.1c"><ci id="S3.F5.14.4.4.m4.1.1.cmml" xref="S3.F5.14.4.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.14.4.4.m4.1d">x</annotation><annotation encoding="application/x-llamapun" id="S3.F5.14.4.4.m4.1e">italic_x</annotation></semantics></math>.
It then spoofs a DNS response fragment containing its chosen IP address to the DNS resolver <math alttext="R" class="ltx_Math" display="inline" id="S3.F5.15.5.5.m5.1"><semantics id="S3.F5.15.5.5.m5.1b"><mi id="S3.F5.15.5.5.m5.1.1" xref="S3.F5.15.5.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.F5.15.5.5.m5.1c"><ci id="S3.F5.15.5.5.m5.1.1.cmml" xref="S3.F5.15.5.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.15.5.5.m5.1d">R</annotation><annotation encoding="application/x-llamapun" id="S3.F5.15.5.5.m5.1e">italic_R</annotation></semantics></math> that appears to have originated from <math alttext="S" class="ltx_Math" display="inline" id="S3.F5.16.6.6.m6.1"><semantics id="S3.F5.16.6.6.m6.1b"><mi id="S3.F5.16.6.6.m6.1.1" xref="S3.F5.16.6.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F5.16.6.6.m6.1c"><ci id="S3.F5.16.6.6.m6.1.1.cmml" xref="S3.F5.16.6.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.16.6.6.m6.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F5.16.6.6.m6.1e">italic_S</annotation></semantics></math>; critically, this fragment’s IPID must match whatever IPID <math alttext="f(x)" class="ltx_Math" display="inline" id="S3.F5.17.7.7.m7.1"><semantics id="S3.F5.17.7.7.m7.1b"><mrow id="S3.F5.17.7.7.m7.1.2" xref="S3.F5.17.7.7.m7.1.2.cmml"><mi id="S3.F5.17.7.7.m7.1.2.2" xref="S3.F5.17.7.7.m7.1.2.2.cmml">f</mi><mo id="S3.F5.17.7.7.m7.1.2.1" xref="S3.F5.17.7.7.m7.1.2.1.cmml">⁢</mo><mrow id="S3.F5.17.7.7.m7.1.2.3.2" xref="S3.F5.17.7.7.m7.1.2.cmml"><mo id="S3.F5.17.7.7.m7.1.2.3.2.1" stretchy="false" xref="S3.F5.17.7.7.m7.1.2.cmml">(</mo><mi id="S3.F5.17.7.7.m7.1.1" xref="S3.F5.17.7.7.m7.1.1.cmml">x</mi><mo id="S3.F5.17.7.7.m7.1.2.3.2.2" stretchy="false" xref="S3.F5.17.7.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F5.17.7.7.m7.1c"><apply id="S3.F5.17.7.7.m7.1.2.cmml" xref="S3.F5.17.7.7.m7.1.2"><times id="S3.F5.17.7.7.m7.1.2.1.cmml" xref="S3.F5.17.7.7.m7.1.2.1"></times><ci id="S3.F5.17.7.7.m7.1.2.2.cmml" xref="S3.F5.17.7.7.m7.1.2.2">𝑓</ci><ci id="S3.F5.17.7.7.m7.1.1.cmml" xref="S3.F5.17.7.7.m7.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.17.7.7.m7.1d">f(x)</annotation><annotation encoding="application/x-llamapun" id="S3.F5.17.7.7.m7.1e">italic_f ( italic_x )</annotation></semantics></math> that <math alttext="S" class="ltx_Math" display="inline" id="S3.F5.18.8.8.m8.1"><semantics id="S3.F5.18.8.8.m8.1b"><mi id="S3.F5.18.8.8.m8.1.1" xref="S3.F5.18.8.8.m8.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F5.18.8.8.m8.1c"><ci id="S3.F5.18.8.8.m8.1.1.cmml" xref="S3.F5.18.8.8.m8.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.18.8.8.m8.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F5.18.8.8.m8.1e">italic_S</annotation></semantics></math> will use in its later DNS response.
When <math alttext="S" class="ltx_Math" display="inline" id="S3.F5.19.9.9.m9.1"><semantics id="S3.F5.19.9.9.m9.1b"><mi id="S3.F5.19.9.9.m9.1.1" xref="S3.F5.19.9.9.m9.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F5.19.9.9.m9.1c"><ci id="S3.F5.19.9.9.m9.1.1.cmml" xref="S3.F5.19.9.9.m9.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.19.9.9.m9.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F5.19.9.9.m9.1e">italic_S</annotation></semantics></math> responds to a DNS request for <span class="ltx_text ltx_font_typewriter" id="S3.F5.20.10.10.2">abc.xyz.org</span>, its fragment containing the authentic IP address will be discarded in favor of the spoofed fragment with the same IPID already in <math alttext="R" class="ltx_Math" display="inline" id="S3.F5.20.10.10.m10.1"><semantics id="S3.F5.20.10.10.m10.1b"><mi id="S3.F5.20.10.10.m10.1.1" xref="S3.F5.20.10.10.m10.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.F5.20.10.10.m10.1c"><ci id="S3.F5.20.10.10.m10.1.1.cmml" xref="S3.F5.20.10.10.m10.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.20.10.10.m10.1d">R</annotation><annotation encoding="application/x-llamapun" id="S3.F5.20.10.10.m10.1e">italic_R</annotation></semantics></math>’s reassembly buffer, causing the reassembled DNS response to contain the attacker’s chosen IP address.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">In <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS1.p1.1.1">DNS cache poisoning</span>, an attacker redirects traffic to an IP address of its choosing by replacing a DNS resolver’s cache entry for a valid domain name <cite class="ltx_cite ltx_citemacro_citep">(Schuba, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib57" title="">1993</a>)</cite>.
The first cache poisoning attacks exploited the predictability of globally incrementing DNS transaction IDs (TXIDs) in the BIND protocol to trick DNS servers into accepting spoofed DNS replies <cite class="ltx_cite ltx_citemacro_citep">(Arce and Kargieman, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib4" title="">1997</a>)</cite>.
But forging entire DNS replies is not necessary for poisoning.
Instead, Herzberg and Shulman <cite class="ltx_cite ltx_citemacro_citep">(Herzberg and Shulman, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib28" title="">2013a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib29" title="">b</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>K) showed that poisoning can be achieved by placing spoofed fragments of a DNS response in a DNS resolver’s reassembly buffer.
If any of these fragments’ IPIDs match that of the real DNS response—which is easily guessed for globally incrementing or per-destination selection—a spoofed fragment will be reassembled with the rest of the DNS response, poisoning the cache (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F5" title="Figure 5 ‣ 3.2.1. DNS Attacks ‣ 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">5</span></a> for details).</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">Palmer and Somers <cite class="ltx_cite ltx_citemacro_citep">(Palmer and Somers, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib51" title="">2019</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>T) later refined DNS cache poisoning to succeed on its “first try”—i.e., with a single spoofed fragment—and Zheng et al. <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib63" title="">2020</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>V) adapted it to work against DNS forwarders.
Klein <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib35" title="">2021</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>X) revealed a weakness in the PRNG that Linux used to initialize its per-connection counters and generate per-bucket’s stochastic increments, making DNS cache poisoning possible with per-connection and per-bucket IPIDs as well (see Linux commit <a class="ltx_ref ltx_href" href="https://github.com/torvalds/linux/commit/f227e3ec3b5cad859ad15666874405e8c1bbc1d4" title="">f227e3</a>).
Finally, beyond using DNS cache poisoning to redirect traffic, Brandt et al. <cite class="ltx_cite ltx_citemacro_citep">(Brandt et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib10" title="">2018</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>R) poisoned certificate authorities to obtain fraudulent certificates for arbitrary domains.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span>NAT Packet Interception</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.13">Gilad and Herzberg <cite class="ltx_cite ltx_citemacro_citep">(Gilad and Herzberg, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib23" title="">2011</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib25" title="">2013</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>G) observed that when an external sender <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_S</annotation></semantics></math> using per-destination IPIDs communicates with a NATted receiver, it treats the NAT device as its destination and thus draws from the same per-destination counter for all machines behind the same NAT.
Thus, if an off-path attacker <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_A</annotation></semantics></math> controls one of the NATted machines <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mi id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><ci id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">italic_M</annotation></semantics></math>, it is easy to obtain the sender’s per-destination IPIDs: <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><mi id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><ci id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">italic_M</annotation></semantics></math> simply pings <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.5.m5.1"><semantics id="S3.SS2.SSS2.p1.5.m5.1a"><mi id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m5.1b"><ci id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.5.m5.1d">italic_S</annotation></semantics></math> and reports the reply’s IPID to <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.6.m6.1"><semantics id="S3.SS2.SSS2.p1.6.m6.1a"><mi id="S3.SS2.SSS2.p1.6.m6.1.1" xref="S3.SS2.SSS2.p1.6.m6.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.6.m6.1b"><ci id="S3.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.6.m6.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.6.m6.1d">italic_A</annotation></semantics></math>.
Attacker <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.7.m7.1"><semantics id="S3.SS2.SSS2.p1.7.m7.1a"><mi id="S3.SS2.SSS2.p1.7.m7.1.1" xref="S3.SS2.SSS2.p1.7.m7.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.7.m7.1b"><ci id="S3.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.7.m7.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.7.m7.1d">italic_A</annotation></semantics></math> also needs the destination port that the NAT uses to map traffic from <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.8.m8.1"><semantics id="S3.SS2.SSS2.p1.8.m8.1a"><mi id="S3.SS2.SSS2.p1.8.m8.1.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.8.m8.1b"><ci id="S3.SS2.SSS2.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.8.m8.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.8.m8.1d">italic_S</annotation></semantics></math> to <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.9.m9.1"><semantics id="S3.SS2.SSS2.p1.9.m9.1a"><mi id="S3.SS2.SSS2.p1.9.m9.1.1" xref="S3.SS2.SSS2.p1.9.m9.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.9.m9.1b"><ci id="S3.SS2.SSS2.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.9.m9.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.9.m9.1d">italic_M</annotation></semantics></math>, which <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.10.m10.1"><semantics id="S3.SS2.SSS2.p1.10.m10.1a"><mi id="S3.SS2.SSS2.p1.10.m10.1.1" xref="S3.SS2.SSS2.p1.10.m10.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.10.m10.1b"><ci id="S3.SS2.SSS2.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.10.m10.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.10.m10.1d">italic_A</annotation></semantics></math> obtains by spoofing packets from <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.11.m11.1"><semantics id="S3.SS2.SSS2.p1.11.m11.1a"><mi id="S3.SS2.SSS2.p1.11.m11.1.1" xref="S3.SS2.SSS2.p1.11.m11.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.11.m11.1b"><ci id="S3.SS2.SSS2.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS2.p1.11.m11.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.11.m11.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.11.m11.1d">italic_S</annotation></semantics></math> to the NAT with different guessed destination ports until one of them gets to <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.12.m12.1"><semantics id="S3.SS2.SSS2.p1.12.m12.1a"><mi id="S3.SS2.SSS2.p1.12.m12.1.1" xref="S3.SS2.SSS2.p1.12.m12.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.12.m12.1b"><ci id="S3.SS2.SSS2.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS2.p1.12.m12.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.12.m12.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.12.m12.1d">italic_M</annotation></semantics></math>, who reports the correct destination port back to <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.13.m13.1"><semantics id="S3.SS2.SSS2.p1.13.m13.1a"><mi id="S3.SS2.SSS2.p1.13.m13.1.1" xref="S3.SS2.SSS2.p1.13.m13.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.13.m13.1b"><ci id="S3.SS2.SSS2.p1.13.m13.1.1.cmml" xref="S3.SS2.SSS2.p1.13.m13.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.13.m13.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.13.m13.1d">italic_A</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.16">Attacker <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.1.m1.1"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mi id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><ci id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.1d">italic_A</annotation></semantics></math> can use these exfiltrated parameters to intercept traffic sent from <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.2.m2.1"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><mi id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><ci id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.2.m2.1d">italic_S</annotation></semantics></math> to any receiver <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.3.m3.1"><semantics id="S3.SS2.SSS2.p2.3.m3.1a"><mi id="S3.SS2.SSS2.p2.3.m3.1.1" xref="S3.SS2.SSS2.p2.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m3.1b"><ci id="S3.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.3.m3.1d">italic_R</annotation></semantics></math> behind the NAT.
Suppose a legitimate packet sent by <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.4.m4.1"><semantics id="S3.SS2.SSS2.p2.4.m4.1a"><mi id="S3.SS2.SSS2.p2.4.m4.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m4.1b"><ci id="S3.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.4.m4.1d">italic_S</annotation></semantics></math> is fragmented as <math alttext="(f_{1},f_{2})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.5.m5.2"><semantics id="S3.SS2.SSS2.p2.5.m5.2a"><mrow id="S3.SS2.SSS2.p2.5.m5.2.2.2" xref="S3.SS2.SSS2.p2.5.m5.2.2.3.cmml"><mo id="S3.SS2.SSS2.p2.5.m5.2.2.2.3" stretchy="false" xref="S3.SS2.SSS2.p2.5.m5.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS2.p2.5.m5.1.1.1.1" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.5.m5.1.1.1.1.2" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.5.m5.1.1.1.1.3" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p2.5.m5.2.2.2.4" xref="S3.SS2.SSS2.p2.5.m5.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.p2.5.m5.2.2.2.2" xref="S3.SS2.SSS2.p2.5.m5.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p2.5.m5.2.2.2.2.2" xref="S3.SS2.SSS2.p2.5.m5.2.2.2.2.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.5.m5.2.2.2.2.3" xref="S3.SS2.SSS2.p2.5.m5.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS2.p2.5.m5.2.2.2.5" stretchy="false" xref="S3.SS2.SSS2.p2.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.5.m5.2b"><interval closure="open" id="S3.SS2.SSS2.p2.5.m5.2.2.3.cmml" xref="S3.SS2.SSS2.p2.5.m5.2.2.2"><apply id="S3.SS2.SSS2.p2.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.1.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.5.m5.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.5.m5.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.p2.5.m5.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p2.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.5.m5.2.2.2.2.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.5.m5.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.5.m5.2.2.2.2.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.5.m5.2c">(f_{1},f_{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.5.m5.2d">( italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="f_{1}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.6.m6.1"><semantics id="S3.SS2.SSS2.p2.6.m6.1a"><msub id="S3.SS2.SSS2.p2.6.m6.1.1" xref="S3.SS2.SSS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.SSS2.p2.6.m6.1.1.2" xref="S3.SS2.SSS2.p2.6.m6.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.6.m6.1.1.3" xref="S3.SS2.SSS2.p2.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.6.m6.1b"><apply id="S3.SS2.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.p2.6.m6.1.1.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.6.m6.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.6.m6.1c">f_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.6.m6.1d">italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> contains the destination port for <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.7.m7.1"><semantics id="S3.SS2.SSS2.p2.7.m7.1a"><mi id="S3.SS2.SSS2.p2.7.m7.1.1" xref="S3.SS2.SSS2.p2.7.m7.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.7.m7.1b"><ci id="S3.SS2.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p2.7.m7.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.7.m7.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.7.m7.1d">italic_R</annotation></semantics></math> and <math alttext="f_{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.8.m8.1"><semantics id="S3.SS2.SSS2.p2.8.m8.1a"><msub id="S3.SS2.SSS2.p2.8.m8.1.1" xref="S3.SS2.SSS2.p2.8.m8.1.1.cmml"><mi id="S3.SS2.SSS2.p2.8.m8.1.1.2" xref="S3.SS2.SSS2.p2.8.m8.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.8.m8.1.1.3" xref="S3.SS2.SSS2.p2.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.8.m8.1b"><apply id="S3.SS2.SSS2.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.SSS2.p2.8.m8.1.1.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.8.m8.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.8.m8.1c">f_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.8.m8.1d">italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> contains the payload.
Using the predicted IPID, <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.9.m9.1"><semantics id="S3.SS2.SSS2.p2.9.m9.1a"><mi id="S3.SS2.SSS2.p2.9.m9.1.1" xref="S3.SS2.SSS2.p2.9.m9.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.9.m9.1b"><ci id="S3.SS2.SSS2.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS2.p2.9.m9.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.9.m9.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.9.m9.1d">italic_A</annotation></semantics></math> plants a spoofed second fragment <math alttext="f_{2}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.10.m10.1"><semantics id="S3.SS2.SSS2.p2.10.m10.1a"><msubsup id="S3.SS2.SSS2.p2.10.m10.1.1" xref="S3.SS2.SSS2.p2.10.m10.1.1.cmml"><mi id="S3.SS2.SSS2.p2.10.m10.1.1.2.2" xref="S3.SS2.SSS2.p2.10.m10.1.1.2.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.10.m10.1.1.2.3" xref="S3.SS2.SSS2.p2.10.m10.1.1.2.3.cmml">2</mn><mo id="S3.SS2.SSS2.p2.10.m10.1.1.3" xref="S3.SS2.SSS2.p2.10.m10.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.10.m10.1b"><apply id="S3.SS2.SSS2.p2.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.p2.10.m10.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.10.m10.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.10.m10.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.10.m10.1.1.2.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.10.m10.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.10.m10.1.1.2.3">2</cn></apply><ci id="S3.SS2.SSS2.p2.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.p2.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.10.m10.1c">f_{2}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.10.m10.1d">italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> that is designed to reassemble with and discard the legitimate <math alttext="f_{1}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.11.m11.1"><semantics id="S3.SS2.SSS2.p2.11.m11.1a"><msub id="S3.SS2.SSS2.p2.11.m11.1.1" xref="S3.SS2.SSS2.p2.11.m11.1.1.cmml"><mi id="S3.SS2.SSS2.p2.11.m11.1.1.2" xref="S3.SS2.SSS2.p2.11.m11.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.11.m11.1.1.3" xref="S3.SS2.SSS2.p2.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.11.m11.1b"><apply id="S3.SS2.SSS2.p2.11.m11.1.1.cmml" xref="S3.SS2.SSS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.11.m11.1.1.1.cmml" xref="S3.SS2.SSS2.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.11.m11.1.1.2.cmml" xref="S3.SS2.SSS2.p2.11.m11.1.1.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.11.m11.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.11.m11.1c">f_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.11.m11.1d">italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> when it arrives.
It then spoofs a new first fragment <math alttext="f_{1}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.12.m12.1"><semantics id="S3.SS2.SSS2.p2.12.m12.1a"><msubsup id="S3.SS2.SSS2.p2.12.m12.1.1" xref="S3.SS2.SSS2.p2.12.m12.1.1.cmml"><mi id="S3.SS2.SSS2.p2.12.m12.1.1.2.2" xref="S3.SS2.SSS2.p2.12.m12.1.1.2.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.12.m12.1.1.2.3" xref="S3.SS2.SSS2.p2.12.m12.1.1.2.3.cmml">1</mn><mo id="S3.SS2.SSS2.p2.12.m12.1.1.3" xref="S3.SS2.SSS2.p2.12.m12.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.12.m12.1b"><apply id="S3.SS2.SSS2.p2.12.m12.1.1.cmml" xref="S3.SS2.SSS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.12.m12.1.1.1.cmml" xref="S3.SS2.SSS2.p2.12.m12.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.12.m12.1.1.2.cmml" xref="S3.SS2.SSS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.12.m12.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.12.m12.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.12.m12.1.1.2.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.12.m12.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.12.m12.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS2.p2.12.m12.1.1.3.cmml" xref="S3.SS2.SSS2.p2.12.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.12.m12.1c">f_{1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.12.m12.1d">italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> containing the destination port for <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.13.m13.1"><semantics id="S3.SS2.SSS2.p2.13.m13.1a"><mi id="S3.SS2.SSS2.p2.13.m13.1.1" xref="S3.SS2.SSS2.p2.13.m13.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.13.m13.1b"><ci id="S3.SS2.SSS2.p2.13.m13.1.1.cmml" xref="S3.SS2.SSS2.p2.13.m13.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.13.m13.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.13.m13.1d">italic_M</annotation></semantics></math>, the attacker-controlled NATted machine.
When the legitimate <math alttext="f_{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.14.m14.1"><semantics id="S3.SS2.SSS2.p2.14.m14.1a"><msub id="S3.SS2.SSS2.p2.14.m14.1.1" xref="S3.SS2.SSS2.p2.14.m14.1.1.cmml"><mi id="S3.SS2.SSS2.p2.14.m14.1.1.2" xref="S3.SS2.SSS2.p2.14.m14.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.14.m14.1.1.3" xref="S3.SS2.SSS2.p2.14.m14.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.14.m14.1b"><apply id="S3.SS2.SSS2.p2.14.m14.1.1.cmml" xref="S3.SS2.SSS2.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.14.m14.1.1.1.cmml" xref="S3.SS2.SSS2.p2.14.m14.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.14.m14.1.1.2.cmml" xref="S3.SS2.SSS2.p2.14.m14.1.1.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.14.m14.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.14.m14.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.14.m14.1c">f_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.14.m14.1d">italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> arrives, the NAT reassembles it with <math alttext="f_{1}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.15.m15.1"><semantics id="S3.SS2.SSS2.p2.15.m15.1a"><msubsup id="S3.SS2.SSS2.p2.15.m15.1.1" xref="S3.SS2.SSS2.p2.15.m15.1.1.cmml"><mi id="S3.SS2.SSS2.p2.15.m15.1.1.2.2" xref="S3.SS2.SSS2.p2.15.m15.1.1.2.2.cmml">f</mi><mn id="S3.SS2.SSS2.p2.15.m15.1.1.2.3" xref="S3.SS2.SSS2.p2.15.m15.1.1.2.3.cmml">1</mn><mo id="S3.SS2.SSS2.p2.15.m15.1.1.3" xref="S3.SS2.SSS2.p2.15.m15.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.15.m15.1b"><apply id="S3.SS2.SSS2.p2.15.m15.1.1.cmml" xref="S3.SS2.SSS2.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.15.m15.1.1.1.cmml" xref="S3.SS2.SSS2.p2.15.m15.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.15.m15.1.1.2.cmml" xref="S3.SS2.SSS2.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.15.m15.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.15.m15.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.15.m15.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.15.m15.1.1.2.2">𝑓</ci><cn id="S3.SS2.SSS2.p2.15.m15.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p2.15.m15.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS2.p2.15.m15.1.1.3.cmml" xref="S3.SS2.SSS2.p2.15.m15.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.15.m15.1c">f_{1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.15.m15.1d">italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and delivers it to <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p2.16.m16.1"><semantics id="S3.SS2.SSS2.p2.16.m16.1a"><mi id="S3.SS2.SSS2.p2.16.m16.1.1" xref="S3.SS2.SSS2.p2.16.m16.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.16.m16.1b"><ci id="S3.SS2.SSS2.p2.16.m16.1.1.cmml" xref="S3.SS2.SSS2.p2.16.m16.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.16.m16.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.16.m16.1d">italic_M</annotation></semantics></math>, completing the interception.
Generalized versions of this attack achieve off-path denials of service against inter-gateway tunnels when the attacker has puppet scripts behind both endpoints.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3. </span>Shifting NTP Time</h4>
<div class="ltx_para" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.2">Malhotra et al. <cite class="ltx_cite ltx_citemacro_citep">(Malhotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib44" title="">2016</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.F2" title="Figure 2 ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>O) discovered an off-path attack leveraging predictable IPIDs to inject traffic into Network Time Protocol (NTP) client–server connections and shift time on NTP clients.
An attacker first spoofs an ICMP “Fragmentation Needed” packet from the target NTP client to its NTP server.
It then uses the puppet technique of Gilad and Herzberg <cite class="ltx_cite ltx_citemacro_citep">(Gilad and Herzberg, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib23" title="">2011</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib25" title="">2013</a>)</cite> or the canary fragments technique of Knockel and Crandall <cite class="ltx_cite ltx_citemacro_citep">(Knockel and Crandall, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib39" title="">2014</a>)</cite> to accurately predict the server’s per-destination IPIDs.
This allows the attacker to spoof overlapping fragments from the server to the client containing phony timestamps which—depending on the client’s reassembly policy for overlapping fragments—may get reassembled into the final packet.
This attack was never explicitly patched, though Malhotra et al. report that only <math alttext="\approx 0.2\%" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.1.m1.1"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><mrow id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml"></mi><mo id="S3.SS2.SSS3.p1.1.m1.1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.1.cmml">≈</mo><mrow id="S3.SS2.SSS3.p1.1.m1.1.1.3" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml"><mn id="S3.SS2.SSS3.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.2.cmml">0.2</mn><mo id="S3.SS2.SSS3.p1.1.m1.1.1.3.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><apply id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1"><approx id="S3.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.1"></approx><csymbol cd="latexml" id="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2">absent</csymbol><apply id="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.1">percent</csymbol><cn id="S3.SS2.SSS3.p1.1.m1.1.1.3.2.cmml" type="float" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">\approx 0.2\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.1d">≈ 0.2 %</annotation></semantics></math> of NTP servers and <math alttext="\approx 1.3\%" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.2.m2.1"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><mrow id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p1.2.m2.1.1.2" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml"></mi><mo id="S3.SS2.SSS3.p1.2.m2.1.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.1.cmml">≈</mo><mrow id="S3.SS2.SSS3.p1.2.m2.1.1.3" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml"><mn id="S3.SS2.SSS3.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.2.cmml">1.3</mn><mo id="S3.SS2.SSS3.p1.2.m2.1.1.3.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><apply id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1"><approx id="S3.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.1"></approx><csymbol cd="latexml" id="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.2">absent</csymbol><apply id="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.1">percent</csymbol><cn id="S3.SS2.SSS3.p1.2.m2.1.1.3.2.cmml" type="float" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.2">1.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">\approx 1.3\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.2.m2.1d">≈ 1.3 %</annotation></semantics></math> of tested NTP clients were vulnerable in 2016.
These numbers have likely only decreased as globally incrementing and per-destination IPIDs become less common.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Comparative Analysis</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3" title="3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3</span></a> chronicled the co-evolution of IPID selection methods’ OS implementations and the diverse measurements and attacks that exploited them.
In this section, we present a unifying mathematical model of IPID selection (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS1" title="4.1. Mathematical Model ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.1</span></a>) and use it to compare and evaluate the methods’ <span class="ltx_text ltx_font_italic" id="S4.p1.1.1">correctness</span> (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS2" title="4.2. Analyzing Correctness ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.2</span></a>), <span class="ltx_text ltx_font_italic" id="S4.p1.1.2">security</span> (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS3" title="4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.3</span></a>), and <span class="ltx_text ltx_font_italic" id="S4.p1.1.3">performance</span> (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS4" title="4.4. Analyzing Performance ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.4</span></a>).
By parameterizing this comparison by a machine’s expected rate of traffic, we reveal each selection method’s relative (dis)advantages across a spectrum of use cases.
These evaluations form the basis of our discussion and recommendations in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5" title="5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">Several works surveyed in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3" title="3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3</span></a> include formal modeling of IPID selection <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib15" title="">2005</a>; Herzberg and Shulman, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib28" title="">2013a</a>; Ensafi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib18" title="">2014</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib61" title="">2018</a>; Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite>, but focus only on the exploit or target selection method at hand.
Similar modeling efforts exist for TCP sequence numbers, where security is analyzed only with respect to specific exploits (e.g., <cite class="ltx_cite ltx_citemacro_citep">(Qian and Mao, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib55" title="">2012</a>; Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib12" title="">2016</a>; Medeiros et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib47" title="">2010</a>; Zhao and Shi, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib62" title="">2013</a>)</cite>) and performance analyses focus primarily on congestion control (e.g., <cite class="ltx_cite ltx_citemacro_citep">(Mathis et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib46" title="">1997</a>; Padhye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib50" title="">1998</a>; Cardwell et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib13" title="">2000</a>)</cite>).
Our goal, in contrast, is to evaluate all <span class="ltx_ERROR undefined" id="S4.p2.1.1">\replaced</span>sevensix IPID selection methods on level footing, providing an intuitive synthesis for practitioners weighing the tradeoffs of different methods.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Mathematical Model</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.6">We model a server <math alttext="S" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_S</annotation></semantics></math> communicating with one or more clients and analyze properties of the IPIDs it assigns to outgoing packets.
To capture the stochastic nature of network traffic, we assume <math alttext="S" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_S</annotation></semantics></math> sends packets with non-trivial IPIDs according to a Poisson process with rate <math alttext="\lambda&gt;0" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">λ</mi><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">&gt;</mo><mn id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><gt id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></gt><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝜆</ci><cn id="S4.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\lambda&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_λ &gt; 0</annotation></semantics></math>.
We define the “unit time” of this Poisson process as the average time for a packet sent by <math alttext="S" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_S</annotation></semantics></math> to be routed to its destination and have all its fragments either reassembled or evicted from the destination’s reassembly buffer.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>In practice, unit time can range from <math alttext="\sim" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mo id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><csymbol cd="latexml" id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">\sim</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">∼</annotation></semantics></math>10 ms (a fast ping) to 120 s (the longest recommended reassembly timeout <cite class="ltx_cite ltx_citemacro_citep">(Postel, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib54" title="">1981</a>; Braden, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib9" title="">1989</a>)</cite>). Assuming a unit time of 10 ms and an average packet size of <span class="ltx_text ltx_number" id="footnote1.1">1,500</span> bytes, 1 Kbps translates to <math alttext="\lambda\approx 2^{-10.2}" class="ltx_Math" display="inline" id="footnote1.m2.1"><semantics id="footnote1.m2.1b"><mrow id="footnote1.m2.1.1" xref="footnote1.m2.1.1.cmml"><mi id="footnote1.m2.1.1.2" xref="footnote1.m2.1.1.2.cmml">λ</mi><mo id="footnote1.m2.1.1.1" xref="footnote1.m2.1.1.1.cmml">≈</mo><msup id="footnote1.m2.1.1.3" xref="footnote1.m2.1.1.3.cmml"><mn id="footnote1.m2.1.1.3.2" xref="footnote1.m2.1.1.3.2.cmml">2</mn><mrow id="footnote1.m2.1.1.3.3" xref="footnote1.m2.1.1.3.3.cmml"><mo id="footnote1.m2.1.1.3.3b" xref="footnote1.m2.1.1.3.3.cmml">−</mo><mn id="footnote1.m2.1.1.3.3.2" xref="footnote1.m2.1.1.3.3.2.cmml">10.2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m2.1c"><apply id="footnote1.m2.1.1.cmml" xref="footnote1.m2.1.1"><approx id="footnote1.m2.1.1.1.cmml" xref="footnote1.m2.1.1.1"></approx><ci id="footnote1.m2.1.1.2.cmml" xref="footnote1.m2.1.1.2">𝜆</ci><apply id="footnote1.m2.1.1.3.cmml" xref="footnote1.m2.1.1.3"><csymbol cd="ambiguous" id="footnote1.m2.1.1.3.1.cmml" xref="footnote1.m2.1.1.3">superscript</csymbol><cn id="footnote1.m2.1.1.3.2.cmml" type="integer" xref="footnote1.m2.1.1.3.2">2</cn><apply id="footnote1.m2.1.1.3.3.cmml" xref="footnote1.m2.1.1.3.3"><minus id="footnote1.m2.1.1.3.3.1.cmml" xref="footnote1.m2.1.1.3.3"></minus><cn id="footnote1.m2.1.1.3.3.2.cmml" type="float" xref="footnote1.m2.1.1.3.3.2">10.2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.1d">\lambda\approx 2^{-10.2}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m2.1e">italic_λ ≈ 2 start_POSTSUPERSCRIPT - 10.2 end_POSTSUPERSCRIPT</annotation></semantics></math>, 1 Mbps translates to <math alttext="\lambda\approx 2^{-0.3}" class="ltx_Math" display="inline" id="footnote1.m3.1"><semantics id="footnote1.m3.1b"><mrow id="footnote1.m3.1.1" xref="footnote1.m3.1.1.cmml"><mi id="footnote1.m3.1.1.2" xref="footnote1.m3.1.1.2.cmml">λ</mi><mo id="footnote1.m3.1.1.1" xref="footnote1.m3.1.1.1.cmml">≈</mo><msup id="footnote1.m3.1.1.3" xref="footnote1.m3.1.1.3.cmml"><mn id="footnote1.m3.1.1.3.2" xref="footnote1.m3.1.1.3.2.cmml">2</mn><mrow id="footnote1.m3.1.1.3.3" xref="footnote1.m3.1.1.3.3.cmml"><mo id="footnote1.m3.1.1.3.3b" xref="footnote1.m3.1.1.3.3.cmml">−</mo><mn id="footnote1.m3.1.1.3.3.2" xref="footnote1.m3.1.1.3.3.2.cmml">0.3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m3.1c"><apply id="footnote1.m3.1.1.cmml" xref="footnote1.m3.1.1"><approx id="footnote1.m3.1.1.1.cmml" xref="footnote1.m3.1.1.1"></approx><ci id="footnote1.m3.1.1.2.cmml" xref="footnote1.m3.1.1.2">𝜆</ci><apply id="footnote1.m3.1.1.3.cmml" xref="footnote1.m3.1.1.3"><csymbol cd="ambiguous" id="footnote1.m3.1.1.3.1.cmml" xref="footnote1.m3.1.1.3">superscript</csymbol><cn id="footnote1.m3.1.1.3.2.cmml" type="integer" xref="footnote1.m3.1.1.3.2">2</cn><apply id="footnote1.m3.1.1.3.3.cmml" xref="footnote1.m3.1.1.3.3"><minus id="footnote1.m3.1.1.3.3.1.cmml" xref="footnote1.m3.1.1.3.3"></minus><cn id="footnote1.m3.1.1.3.3.2.cmml" type="float" xref="footnote1.m3.1.1.3.3.2">0.3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m3.1d">\lambda\approx 2^{-0.3}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m3.1e">italic_λ ≈ 2 start_POSTSUPERSCRIPT - 0.3 end_POSTSUPERSCRIPT</annotation></semantics></math>, 1 Gbps translates to <math alttext="\lambda\approx 2^{9.7}" class="ltx_Math" display="inline" id="footnote1.m4.1"><semantics id="footnote1.m4.1b"><mrow id="footnote1.m4.1.1" xref="footnote1.m4.1.1.cmml"><mi id="footnote1.m4.1.1.2" xref="footnote1.m4.1.1.2.cmml">λ</mi><mo id="footnote1.m4.1.1.1" xref="footnote1.m4.1.1.1.cmml">≈</mo><msup id="footnote1.m4.1.1.3" xref="footnote1.m4.1.1.3.cmml"><mn id="footnote1.m4.1.1.3.2" xref="footnote1.m4.1.1.3.2.cmml">2</mn><mn id="footnote1.m4.1.1.3.3" xref="footnote1.m4.1.1.3.3.cmml">9.7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m4.1c"><apply id="footnote1.m4.1.1.cmml" xref="footnote1.m4.1.1"><approx id="footnote1.m4.1.1.1.cmml" xref="footnote1.m4.1.1.1"></approx><ci id="footnote1.m4.1.1.2.cmml" xref="footnote1.m4.1.1.2">𝜆</ci><apply id="footnote1.m4.1.1.3.cmml" xref="footnote1.m4.1.1.3"><csymbol cd="ambiguous" id="footnote1.m4.1.1.3.1.cmml" xref="footnote1.m4.1.1.3">superscript</csymbol><cn id="footnote1.m4.1.1.3.2.cmml" type="integer" xref="footnote1.m4.1.1.3.2">2</cn><cn id="footnote1.m4.1.1.3.3.cmml" type="float" xref="footnote1.m4.1.1.3.3">9.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m4.1d">\lambda\approx 2^{9.7}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m4.1e">italic_λ ≈ 2 start_POSTSUPERSCRIPT 9.7 end_POSTSUPERSCRIPT</annotation></semantics></math>, 100 Gbps translates to <math alttext="\lambda\approx 2^{16.3}" class="ltx_Math" display="inline" id="footnote1.m5.1"><semantics id="footnote1.m5.1b"><mrow id="footnote1.m5.1.1" xref="footnote1.m5.1.1.cmml"><mi id="footnote1.m5.1.1.2" xref="footnote1.m5.1.1.2.cmml">λ</mi><mo id="footnote1.m5.1.1.1" xref="footnote1.m5.1.1.1.cmml">≈</mo><msup id="footnote1.m5.1.1.3" xref="footnote1.m5.1.1.3.cmml"><mn id="footnote1.m5.1.1.3.2" xref="footnote1.m5.1.1.3.2.cmml">2</mn><mn id="footnote1.m5.1.1.3.3" xref="footnote1.m5.1.1.3.3.cmml">16.3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m5.1c"><apply id="footnote1.m5.1.1.cmml" xref="footnote1.m5.1.1"><approx id="footnote1.m5.1.1.1.cmml" xref="footnote1.m5.1.1.1"></approx><ci id="footnote1.m5.1.1.2.cmml" xref="footnote1.m5.1.1.2">𝜆</ci><apply id="footnote1.m5.1.1.3.cmml" xref="footnote1.m5.1.1.3"><csymbol cd="ambiguous" id="footnote1.m5.1.1.3.1.cmml" xref="footnote1.m5.1.1.3">superscript</csymbol><cn id="footnote1.m5.1.1.3.2.cmml" type="integer" xref="footnote1.m5.1.1.3.2">2</cn><cn id="footnote1.m5.1.1.3.3.cmml" type="float" xref="footnote1.m5.1.1.3.3">16.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m5.1d">\lambda\approx 2^{16.3}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m5.1e">italic_λ ≈ 2 start_POSTSUPERSCRIPT 16.3 end_POSTSUPERSCRIPT</annotation></semantics></math>, and 1 Tbps translates to <math alttext="\lambda\approx 2^{19.7}" class="ltx_Math" display="inline" id="footnote1.m6.1"><semantics id="footnote1.m6.1b"><mrow id="footnote1.m6.1.1" xref="footnote1.m6.1.1.cmml"><mi id="footnote1.m6.1.1.2" xref="footnote1.m6.1.1.2.cmml">λ</mi><mo id="footnote1.m6.1.1.1" xref="footnote1.m6.1.1.1.cmml">≈</mo><msup id="footnote1.m6.1.1.3" xref="footnote1.m6.1.1.3.cmml"><mn id="footnote1.m6.1.1.3.2" xref="footnote1.m6.1.1.3.2.cmml">2</mn><mn id="footnote1.m6.1.1.3.3" xref="footnote1.m6.1.1.3.3.cmml">19.7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m6.1c"><apply id="footnote1.m6.1.1.cmml" xref="footnote1.m6.1.1"><approx id="footnote1.m6.1.1.1.cmml" xref="footnote1.m6.1.1.1"></approx><ci id="footnote1.m6.1.1.2.cmml" xref="footnote1.m6.1.1.2">𝜆</ci><apply id="footnote1.m6.1.1.3.cmml" xref="footnote1.m6.1.1.3"><csymbol cd="ambiguous" id="footnote1.m6.1.1.3.1.cmml" xref="footnote1.m6.1.1.3">superscript</csymbol><cn id="footnote1.m6.1.1.3.2.cmml" type="integer" xref="footnote1.m6.1.1.3.2">2</cn><cn id="footnote1.m6.1.1.3.3.cmml" type="float" xref="footnote1.m6.1.1.3.3">19.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m6.1d">\lambda\approx 2^{19.7}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m6.1e">italic_λ ≈ 2 start_POSTSUPERSCRIPT 19.7 end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></span></span>
This time interval is important for two reasons.
First, it is the window of uncertainty for adversaries trying to correlate IPIDs obtained by probing <math alttext="S" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_S</annotation></semantics></math> (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1" title="3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1</span></a>), since other packets that <math alttext="S" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_S</annotation></semantics></math> sends in the unit time between its reply to some probe and when that reply is received will further change its current IPID value.
Second, this is the interval during which fragments in the same reassembly buffer with the same IPIDs may interact, as required for fragment injections (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2" title="3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a>).</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">Poisson processes are classically used in network traffic models that prioritize analytical elegance over high-fidelity representation and prediction.
Specifically, packet interarrival times are adequately captured by simple Poisson processes when aggregating large-scale traffic, though traffic patterns do exhibit long-range dependence, self-similarity, and other non-stochastic properties <cite class="ltx_cite ltx_citemacro_citep">(Karagiannis et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib32" title="">2004</a>)</cite>.
Alternative traffic models such as Markov Modulated Poisson Processes <cite class="ltx_cite ltx_citemacro_citep">(Bhat, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib8" title="">1994</a>; Bali and Frost, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib5" title="">2007</a>)</cite> and autoregression models <cite class="ltx_cite ltx_citemacro_citep">(Hosking, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib30" title="">1981</a>; Paxson and Floyd, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib52" title="">1995</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib14" title="">2000</a>)</cite> can better capture these time-dependent properties, but are less amenable to the unifying comparative analysis we perform.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Analyzing Correctness</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.4">The intended function of IPIDs is to support unambiguous packet reassembly after IP fragmentation (see Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS1" title="2.1. IP Packet Fragmentation and Reassembly ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.1</span></a>), so any measure of an IPID selection method’s correctness should capture its ability to assign distinct IPIDs to packets whose fragments would otherwise be indistinguishable—i.e., those with the same source and destination IP addresses, source and destination ports (if applicable), and protocol number.
Formally, we say the server <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_S</annotation></semantics></math> produces a <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.4.1">collision</span> at a client <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_C</annotation></semantics></math> if two fragments in the reassembly buffer of <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_C</annotation></semantics></math> belong to different packets sent by <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_S</annotation></semantics></math> but have the same IPID and protocol number.
We analyze each selection method’s correctness in terms of its <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.4.2">worst-case probability of producing a collision</span>, establishing a basis for fair comparison across both counter-based and PRNG-based methods.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.15">In the worst case, all packets sent by <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_S</annotation></semantics></math> are sent to the same client <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_C</annotation></semantics></math> via the same protocol and are fragmented in transit; thus, every packet has the potential to cause a collision.
Recall from Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS1" title="4.1. Mathematical Model ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.1</span></a> that we assume outgoing traffic from <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_S</annotation></semantics></math> occurs according to a Poisson process with rate <math alttext="\lambda&gt;0" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">λ</mi><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><gt id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></gt><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝜆</ci><cn id="S4.SS2.p2.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p2.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\lambda&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_λ &gt; 0</annotation></semantics></math>.
Let <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><mi id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">italic_N</annotation></semantics></math> be the corresponding random variable counting the number of packets “simultaneously in transit” from <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_S</annotation></semantics></math> to <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m7.1"><semantics id="S4.SS2.p2.7.m7.1a"><mi id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m7.1d">italic_C</annotation></semantics></math>, i.e., those sent by <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p2.8.m8.1"><semantics id="S4.SS2.p2.8.m8.1a"><mi id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><ci id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.8.m8.1d">italic_S</annotation></semantics></math> that have not yet been reassembled or evicted by <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.p2.9.m9.1"><semantics id="S4.SS2.p2.9.m9.1a"><mi id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><ci id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.9.m9.1d">italic_C</annotation></semantics></math>.
Then <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p2.10.m10.1"><semantics id="S4.SS2.p2.10.m10.1a"><mi id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><ci id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.10.m10.1d">italic_N</annotation></semantics></math> is Poisson-distributed, characterized by probability mass function <math alttext="\mathrm{pmf}(N,\lambda)=\lambda^{N}e^{-\lambda}/N!" class="ltx_Math" display="inline" id="S4.SS2.p2.11.m11.2"><semantics id="S4.SS2.p2.11.m11.2a"><mrow id="S4.SS2.p2.11.m11.2.3" xref="S4.SS2.p2.11.m11.2.3.cmml"><mrow id="S4.SS2.p2.11.m11.2.3.2" xref="S4.SS2.p2.11.m11.2.3.2.cmml"><mi id="S4.SS2.p2.11.m11.2.3.2.2" xref="S4.SS2.p2.11.m11.2.3.2.2.cmml">pmf</mi><mo id="S4.SS2.p2.11.m11.2.3.2.1" xref="S4.SS2.p2.11.m11.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.11.m11.2.3.2.3.2" xref="S4.SS2.p2.11.m11.2.3.2.3.1.cmml"><mo id="S4.SS2.p2.11.m11.2.3.2.3.2.1" stretchy="false" xref="S4.SS2.p2.11.m11.2.3.2.3.1.cmml">(</mo><mi id="S4.SS2.p2.11.m11.1.1" xref="S4.SS2.p2.11.m11.1.1.cmml">N</mi><mo id="S4.SS2.p2.11.m11.2.3.2.3.2.2" xref="S4.SS2.p2.11.m11.2.3.2.3.1.cmml">,</mo><mi id="S4.SS2.p2.11.m11.2.2" xref="S4.SS2.p2.11.m11.2.2.cmml">λ</mi><mo id="S4.SS2.p2.11.m11.2.3.2.3.2.3" stretchy="false" xref="S4.SS2.p2.11.m11.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.11.m11.2.3.1" xref="S4.SS2.p2.11.m11.2.3.1.cmml">=</mo><mrow id="S4.SS2.p2.11.m11.2.3.3" xref="S4.SS2.p2.11.m11.2.3.3.cmml"><mrow id="S4.SS2.p2.11.m11.2.3.3.2" xref="S4.SS2.p2.11.m11.2.3.3.2.cmml"><msup id="S4.SS2.p2.11.m11.2.3.3.2.2" xref="S4.SS2.p2.11.m11.2.3.3.2.2.cmml"><mi id="S4.SS2.p2.11.m11.2.3.3.2.2.2" xref="S4.SS2.p2.11.m11.2.3.3.2.2.2.cmml">λ</mi><mi id="S4.SS2.p2.11.m11.2.3.3.2.2.3" xref="S4.SS2.p2.11.m11.2.3.3.2.2.3.cmml">N</mi></msup><mo id="S4.SS2.p2.11.m11.2.3.3.2.1" xref="S4.SS2.p2.11.m11.2.3.3.2.1.cmml">⁢</mo><msup id="S4.SS2.p2.11.m11.2.3.3.2.3" xref="S4.SS2.p2.11.m11.2.3.3.2.3.cmml"><mi id="S4.SS2.p2.11.m11.2.3.3.2.3.2" xref="S4.SS2.p2.11.m11.2.3.3.2.3.2.cmml">e</mi><mrow id="S4.SS2.p2.11.m11.2.3.3.2.3.3" xref="S4.SS2.p2.11.m11.2.3.3.2.3.3.cmml"><mo id="S4.SS2.p2.11.m11.2.3.3.2.3.3a" xref="S4.SS2.p2.11.m11.2.3.3.2.3.3.cmml">−</mo><mi id="S4.SS2.p2.11.m11.2.3.3.2.3.3.2" xref="S4.SS2.p2.11.m11.2.3.3.2.3.3.2.cmml">λ</mi></mrow></msup></mrow><mo id="S4.SS2.p2.11.m11.2.3.3.1" xref="S4.SS2.p2.11.m11.2.3.3.1.cmml">/</mo><mrow id="S4.SS2.p2.11.m11.2.3.3.3" xref="S4.SS2.p2.11.m11.2.3.3.3.cmml"><mi id="S4.SS2.p2.11.m11.2.3.3.3.2" xref="S4.SS2.p2.11.m11.2.3.3.3.2.cmml">N</mi><mo id="S4.SS2.p2.11.m11.2.3.3.3.1" xref="S4.SS2.p2.11.m11.2.3.3.3.1.cmml">!</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m11.2b"><apply id="S4.SS2.p2.11.m11.2.3.cmml" xref="S4.SS2.p2.11.m11.2.3"><eq id="S4.SS2.p2.11.m11.2.3.1.cmml" xref="S4.SS2.p2.11.m11.2.3.1"></eq><apply id="S4.SS2.p2.11.m11.2.3.2.cmml" xref="S4.SS2.p2.11.m11.2.3.2"><times id="S4.SS2.p2.11.m11.2.3.2.1.cmml" xref="S4.SS2.p2.11.m11.2.3.2.1"></times><ci id="S4.SS2.p2.11.m11.2.3.2.2.cmml" xref="S4.SS2.p2.11.m11.2.3.2.2">pmf</ci><interval closure="open" id="S4.SS2.p2.11.m11.2.3.2.3.1.cmml" xref="S4.SS2.p2.11.m11.2.3.2.3.2"><ci id="S4.SS2.p2.11.m11.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1">𝑁</ci><ci id="S4.SS2.p2.11.m11.2.2.cmml" xref="S4.SS2.p2.11.m11.2.2">𝜆</ci></interval></apply><apply id="S4.SS2.p2.11.m11.2.3.3.cmml" xref="S4.SS2.p2.11.m11.2.3.3"><divide id="S4.SS2.p2.11.m11.2.3.3.1.cmml" xref="S4.SS2.p2.11.m11.2.3.3.1"></divide><apply id="S4.SS2.p2.11.m11.2.3.3.2.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2"><times id="S4.SS2.p2.11.m11.2.3.3.2.1.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.1"></times><apply id="S4.SS2.p2.11.m11.2.3.3.2.2.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.2.3.3.2.2.1.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.2">superscript</csymbol><ci id="S4.SS2.p2.11.m11.2.3.3.2.2.2.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.2.2">𝜆</ci><ci id="S4.SS2.p2.11.m11.2.3.3.2.2.3.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.2.3">𝑁</ci></apply><apply id="S4.SS2.p2.11.m11.2.3.3.2.3.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.2.3.3.2.3.1.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.3">superscript</csymbol><ci id="S4.SS2.p2.11.m11.2.3.3.2.3.2.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.3.2">𝑒</ci><apply id="S4.SS2.p2.11.m11.2.3.3.2.3.3.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.3.3"><minus id="S4.SS2.p2.11.m11.2.3.3.2.3.3.1.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.3.3"></minus><ci id="S4.SS2.p2.11.m11.2.3.3.2.3.3.2.cmml" xref="S4.SS2.p2.11.m11.2.3.3.2.3.3.2">𝜆</ci></apply></apply></apply><apply id="S4.SS2.p2.11.m11.2.3.3.3.cmml" xref="S4.SS2.p2.11.m11.2.3.3.3"><factorial id="S4.SS2.p2.11.m11.2.3.3.3.1.cmml" xref="S4.SS2.p2.11.m11.2.3.3.3.1"></factorial><ci id="S4.SS2.p2.11.m11.2.3.3.3.2.cmml" xref="S4.SS2.p2.11.m11.2.3.3.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m11.2c">\mathrm{pmf}(N,\lambda)=\lambda^{N}e^{-\lambda}/N!</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.11.m11.2d">roman_pmf ( italic_N , italic_λ ) = italic_λ start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT - italic_λ end_POSTSUPERSCRIPT / italic_N !</annotation></semantics></math> and expected value <math alttext="\mathrm{E}\left[N\right]=\lambda" class="ltx_Math" display="inline" id="S4.SS2.p2.12.m12.1"><semantics id="S4.SS2.p2.12.m12.1a"><mrow id="S4.SS2.p2.12.m12.1.2" xref="S4.SS2.p2.12.m12.1.2.cmml"><mrow id="S4.SS2.p2.12.m12.1.2.2" xref="S4.SS2.p2.12.m12.1.2.2.cmml"><mi id="S4.SS2.p2.12.m12.1.2.2.2" mathvariant="normal" xref="S4.SS2.p2.12.m12.1.2.2.2.cmml">E</mi><mo id="S4.SS2.p2.12.m12.1.2.2.1" xref="S4.SS2.p2.12.m12.1.2.2.1.cmml">⁢</mo><mrow id="S4.SS2.p2.12.m12.1.2.2.3.2" xref="S4.SS2.p2.12.m12.1.2.2.3.1.cmml"><mo id="S4.SS2.p2.12.m12.1.2.2.3.2.1" xref="S4.SS2.p2.12.m12.1.2.2.3.1.1.cmml">[</mo><mi id="S4.SS2.p2.12.m12.1.1" xref="S4.SS2.p2.12.m12.1.1.cmml">N</mi><mo id="S4.SS2.p2.12.m12.1.2.2.3.2.2" xref="S4.SS2.p2.12.m12.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.SS2.p2.12.m12.1.2.1" xref="S4.SS2.p2.12.m12.1.2.1.cmml">=</mo><mi id="S4.SS2.p2.12.m12.1.2.3" xref="S4.SS2.p2.12.m12.1.2.3.cmml">λ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m12.1b"><apply id="S4.SS2.p2.12.m12.1.2.cmml" xref="S4.SS2.p2.12.m12.1.2"><eq id="S4.SS2.p2.12.m12.1.2.1.cmml" xref="S4.SS2.p2.12.m12.1.2.1"></eq><apply id="S4.SS2.p2.12.m12.1.2.2.cmml" xref="S4.SS2.p2.12.m12.1.2.2"><times id="S4.SS2.p2.12.m12.1.2.2.1.cmml" xref="S4.SS2.p2.12.m12.1.2.2.1"></times><ci id="S4.SS2.p2.12.m12.1.2.2.2.cmml" xref="S4.SS2.p2.12.m12.1.2.2.2">E</ci><apply id="S4.SS2.p2.12.m12.1.2.2.3.1.cmml" xref="S4.SS2.p2.12.m12.1.2.2.3.2"><csymbol cd="latexml" id="S4.SS2.p2.12.m12.1.2.2.3.1.1.cmml" xref="S4.SS2.p2.12.m12.1.2.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS2.p2.12.m12.1.1.cmml" xref="S4.SS2.p2.12.m12.1.1">𝑁</ci></apply></apply><ci id="S4.SS2.p2.12.m12.1.2.3.cmml" xref="S4.SS2.p2.12.m12.1.2.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m12.1c">\mathrm{E}\left[N\right]=\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.12.m12.1d">roman_E [ italic_N ] = italic_λ</annotation></semantics></math>.
Formally, the worst-case probability of <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p2.13.m13.1"><semantics id="S4.SS2.p2.13.m13.1a"><mi id="S4.SS2.p2.13.m13.1.1" xref="S4.SS2.p2.13.m13.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m13.1b"><ci id="S4.SS2.p2.13.m13.1.1.cmml" xref="S4.SS2.p2.13.m13.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m13.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.13.m13.1d">italic_S</annotation></semantics></math> producing a collision at <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.p2.14.m14.1"><semantics id="S4.SS2.p2.14.m14.1a"><mi id="S4.SS2.p2.14.m14.1.1" xref="S4.SS2.p2.14.m14.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m14.1b"><ci id="S4.SS2.p2.14.m14.1.1.cmml" xref="S4.SS2.p2.14.m14.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.m14.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.14.m14.1d">italic_C</annotation></semantics></math> as a function of <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p2.15.m15.1"><semantics id="S4.SS2.p2.15.m15.1a"><mi id="S4.SS2.p2.15.m15.1.1" xref="S4.SS2.p2.15.m15.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m15.1b"><ci id="S4.SS2.p2.15.m15.1.1.cmml" xref="S4.SS2.p2.15.m15.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m15.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.15.m15.1d">italic_λ</annotation></semantics></math> is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx1">
<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{Pr}\left[\text{collision}\right]" class="ltx_Math" display="inline" id="S4.Ex1.m1.1"><semantics id="S4.Ex1.m1.1a"><mrow id="S4.Ex1.m1.1.2" xref="S4.Ex1.m1.1.2.cmml"><mi id="S4.Ex1.m1.1.2.2" xref="S4.Ex1.m1.1.2.2.cmml">Pr</mi><mo id="S4.Ex1.m1.1.2.1" xref="S4.Ex1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.Ex1.m1.1.2.3.2" xref="S4.Ex1.m1.1.2.3.1.cmml"><mo id="S4.Ex1.m1.1.2.3.2.1" xref="S4.Ex1.m1.1.2.3.1.1.cmml">[</mo><mtext id="S4.Ex1.m1.1.1" xref="S4.Ex1.m1.1.1a.cmml">collision</mtext><mo id="S4.Ex1.m1.1.2.3.2.2" xref="S4.Ex1.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.1b"><apply id="S4.Ex1.m1.1.2.cmml" xref="S4.Ex1.m1.1.2"><times id="S4.Ex1.m1.1.2.1.cmml" xref="S4.Ex1.m1.1.2.1"></times><ci id="S4.Ex1.m1.1.2.2.cmml" xref="S4.Ex1.m1.1.2.2">Pr</ci><apply id="S4.Ex1.m1.1.2.3.1.cmml" xref="S4.Ex1.m1.1.2.3.2"><csymbol cd="latexml" id="S4.Ex1.m1.1.2.3.1.1.cmml" xref="S4.Ex1.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.Ex1.m1.1.1a.cmml" xref="S4.Ex1.m1.1.1"><mtext id="S4.Ex1.m1.1.1.cmml" xref="S4.Ex1.m1.1.1">collision</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.1c">\displaystyle\mathrm{Pr}\left[\text{collision}\right]</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.1d">roman_Pr [ collision ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=1}^{\infty}\mathrm{Pr}\left[\text{collision}\mid N=n%
\right]\cdot\mathrm{Pr}\left[N=n\right]" class="ltx_Math" display="inline" id="S4.Ex1.m2.2"><semantics id="S4.Ex1.m2.2a"><mrow id="S4.Ex1.m2.2.2" xref="S4.Ex1.m2.2.2.cmml"><mi id="S4.Ex1.m2.2.2.4" xref="S4.Ex1.m2.2.2.4.cmml"></mi><mo id="S4.Ex1.m2.2.2.3" xref="S4.Ex1.m2.2.2.3.cmml">=</mo><mrow id="S4.Ex1.m2.2.2.2" xref="S4.Ex1.m2.2.2.2.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.2.2.2.3" xref="S4.Ex1.m2.2.2.2.3.cmml"><munderover id="S4.Ex1.m2.2.2.2.3a" xref="S4.Ex1.m2.2.2.2.3.cmml"><mo id="S4.Ex1.m2.2.2.2.3.2.2" movablelimits="false" xref="S4.Ex1.m2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.Ex1.m2.2.2.2.3.2.3" xref="S4.Ex1.m2.2.2.2.3.2.3.cmml"><mi id="S4.Ex1.m2.2.2.2.3.2.3.2" xref="S4.Ex1.m2.2.2.2.3.2.3.2.cmml">n</mi><mo id="S4.Ex1.m2.2.2.2.3.2.3.1" xref="S4.Ex1.m2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.Ex1.m2.2.2.2.3.2.3.3" xref="S4.Ex1.m2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex1.m2.2.2.2.3.3" mathvariant="normal" xref="S4.Ex1.m2.2.2.2.3.3.cmml">∞</mi></munderover></mstyle><mrow id="S4.Ex1.m2.2.2.2.2" xref="S4.Ex1.m2.2.2.2.2.cmml"><mrow id="S4.Ex1.m2.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.cmml"><mrow id="S4.Ex1.m2.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.cmml"><mi id="S4.Ex1.m2.1.1.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.1.3.cmml">Pr</mi><mo id="S4.Ex1.m2.1.1.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mtext id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2a.cmml">collision</mtext><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1.cmml">∣</mo><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S4.Ex1.m2.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="S4.Ex1.m2.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.Ex1.m2.1.1.1.1.1.2" rspace="0.222em" xref="S4.Ex1.m2.1.1.1.1.1.2.cmml">⋅</mo><mi id="S4.Ex1.m2.1.1.1.1.1.3" xref="S4.Ex1.m2.1.1.1.1.1.3.cmml">Pr</mi></mrow><mo id="S4.Ex1.m2.2.2.2.2.3" xref="S4.Ex1.m2.2.2.2.2.3.cmml">⁢</mo><mrow id="S4.Ex1.m2.2.2.2.2.2.1" xref="S4.Ex1.m2.2.2.2.2.2.2.cmml"><mo id="S4.Ex1.m2.2.2.2.2.2.1.2" xref="S4.Ex1.m2.2.2.2.2.2.2.1.cmml">[</mo><mrow id="S4.Ex1.m2.2.2.2.2.2.1.1" xref="S4.Ex1.m2.2.2.2.2.2.1.1.cmml"><mi id="S4.Ex1.m2.2.2.2.2.2.1.1.2" xref="S4.Ex1.m2.2.2.2.2.2.1.1.2.cmml">N</mi><mo id="S4.Ex1.m2.2.2.2.2.2.1.1.1" xref="S4.Ex1.m2.2.2.2.2.2.1.1.1.cmml">=</mo><mi id="S4.Ex1.m2.2.2.2.2.2.1.1.3" xref="S4.Ex1.m2.2.2.2.2.2.1.1.3.cmml">n</mi></mrow><mo id="S4.Ex1.m2.2.2.2.2.2.1.3" xref="S4.Ex1.m2.2.2.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m2.2b"><apply id="S4.Ex1.m2.2.2.cmml" xref="S4.Ex1.m2.2.2"><eq id="S4.Ex1.m2.2.2.3.cmml" xref="S4.Ex1.m2.2.2.3"></eq><csymbol cd="latexml" id="S4.Ex1.m2.2.2.4.cmml" xref="S4.Ex1.m2.2.2.4">absent</csymbol><apply id="S4.Ex1.m2.2.2.2.cmml" xref="S4.Ex1.m2.2.2.2"><apply id="S4.Ex1.m2.2.2.2.3.cmml" xref="S4.Ex1.m2.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.2.2.3.1.cmml" xref="S4.Ex1.m2.2.2.2.3">superscript</csymbol><apply id="S4.Ex1.m2.2.2.2.3.2.cmml" xref="S4.Ex1.m2.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.2.2.3.2.1.cmml" xref="S4.Ex1.m2.2.2.2.3">subscript</csymbol><sum id="S4.Ex1.m2.2.2.2.3.2.2.cmml" xref="S4.Ex1.m2.2.2.2.3.2.2"></sum><apply id="S4.Ex1.m2.2.2.2.3.2.3.cmml" xref="S4.Ex1.m2.2.2.2.3.2.3"><eq id="S4.Ex1.m2.2.2.2.3.2.3.1.cmml" xref="S4.Ex1.m2.2.2.2.3.2.3.1"></eq><ci id="S4.Ex1.m2.2.2.2.3.2.3.2.cmml" xref="S4.Ex1.m2.2.2.2.3.2.3.2">𝑛</ci><cn id="S4.Ex1.m2.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.Ex1.m2.2.2.2.3.2.3.3">1</cn></apply></apply><infinity id="S4.Ex1.m2.2.2.2.3.3.cmml" xref="S4.Ex1.m2.2.2.2.3.3"></infinity></apply><apply id="S4.Ex1.m2.2.2.2.2.cmml" xref="S4.Ex1.m2.2.2.2.2"><times id="S4.Ex1.m2.2.2.2.2.3.cmml" xref="S4.Ex1.m2.2.2.2.2.3"></times><apply id="S4.Ex1.m2.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1"><ci id="S4.Ex1.m2.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.2">⋅</ci><apply id="S4.Ex1.m2.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1"><times id="S4.Ex1.m2.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.2"></times><ci id="S4.Ex1.m2.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.3">Pr</ci><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1"><eq id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2"><mtext id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2">collision</mtext></ci><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3">𝑁</ci></apply><ci id="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><ci id="S4.Ex1.m2.1.1.1.1.1.3.cmml" xref="S4.Ex1.m2.1.1.1.1.1.3">Pr</ci></apply><apply id="S4.Ex1.m2.2.2.2.2.2.2.cmml" xref="S4.Ex1.m2.2.2.2.2.2.1"><csymbol cd="latexml" id="S4.Ex1.m2.2.2.2.2.2.2.1.cmml" xref="S4.Ex1.m2.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S4.Ex1.m2.2.2.2.2.2.1.1.cmml" xref="S4.Ex1.m2.2.2.2.2.2.1.1"><eq id="S4.Ex1.m2.2.2.2.2.2.1.1.1.cmml" xref="S4.Ex1.m2.2.2.2.2.2.1.1.1"></eq><ci id="S4.Ex1.m2.2.2.2.2.2.1.1.2.cmml" xref="S4.Ex1.m2.2.2.2.2.2.1.1.2">𝑁</ci><ci id="S4.Ex1.m2.2.2.2.2.2.1.1.3.cmml" xref="S4.Ex1.m2.2.2.2.2.2.1.1.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m2.2c">\displaystyle=\sum_{n=1}^{\infty}\mathrm{Pr}\left[\text{collision}\mid N=n%
\right]\cdot\mathrm{Pr}\left[N=n\right]</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m2.2d">= ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_Pr [ collision ∣ italic_N = italic_n ] ⋅ roman_Pr [ italic_N = italic_n ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=1}^{\infty}\mathrm{Pr}\left[\text{collision}\mid N=n%
\right]\cdot\mathrm{pmf}(n,\lambda)," class="ltx_Math" display="inline" id="S4.E1.m1.3"><semantics id="S4.E1.m1.3a"><mrow id="S4.E1.m1.3.3.1" xref="S4.E1.m1.3.3.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.3" xref="S4.E1.m1.3.3.1.1.3.cmml"></mi><mo id="S4.E1.m1.3.3.1.1.2" xref="S4.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E1.m1.3.3.1.1.1" xref="S4.E1.m1.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E1.m1.3.3.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.2.cmml"><munderover id="S4.E1.m1.3.3.1.1.1.2a" xref="S4.E1.m1.3.3.1.1.1.2.cmml"><mo id="S4.E1.m1.3.3.1.1.1.2.2.2" movablelimits="false" xref="S4.E1.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E1.m1.3.3.1.1.1.2.2.3" xref="S4.E1.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S4.E1.m1.3.3.1.1.1.2.2.3.2" xref="S4.E1.m1.3.3.1.1.1.2.2.3.2.cmml">n</mi><mo id="S4.E1.m1.3.3.1.1.1.2.2.3.1" xref="S4.E1.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E1.m1.3.3.1.1.1.2.2.3.3" xref="S4.E1.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E1.m1.3.3.1.1.1.2.3" mathvariant="normal" xref="S4.E1.m1.3.3.1.1.1.2.3.cmml">∞</mi></munderover></mstyle><mrow id="S4.E1.m1.3.3.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.cmml">Pr</mi><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mtext id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2a.cmml">collision</mtext><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml">∣</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E1.m1.3.3.1.1.1.1.1.2" rspace="0.222em" xref="S4.E1.m1.3.3.1.1.1.1.1.2.cmml">⋅</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.3.cmml">pmf</mi></mrow><mo id="S4.E1.m1.3.3.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.3.2" xref="S4.E1.m1.3.3.1.1.1.1.3.1.cmml"><mo id="S4.E1.m1.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.1.3.1.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">n</mi><mo id="S4.E1.m1.3.3.1.1.1.1.3.2.2" xref="S4.E1.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">λ</mi><mo id="S4.E1.m1.3.3.1.1.1.1.3.2.3" stretchy="false" xref="S4.E1.m1.3.3.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E1.m1.3.3.1.2" xref="S4.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.3b"><apply id="S4.E1.m1.3.3.1.1.cmml" xref="S4.E1.m1.3.3.1"><eq id="S4.E1.m1.3.3.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="S4.E1.m1.3.3.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.3">absent</csymbol><apply id="S4.E1.m1.3.3.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1"><apply id="S4.E1.m1.3.3.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.1.2.1.cmml" xref="S4.E1.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S4.E1.m1.3.3.1.1.1.2.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.1.2.2.1.cmml" xref="S4.E1.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S4.E1.m1.3.3.1.1.1.2.2.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2.2.2"></sum><apply id="S4.E1.m1.3.3.1.1.1.2.2.3.cmml" xref="S4.E1.m1.3.3.1.1.1.2.2.3"><eq id="S4.E1.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S4.E1.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S4.E1.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S4.E1.m1.3.3.1.1.1.2.2.3.2">𝑛</ci><cn id="S4.E1.m1.3.3.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E1.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><infinity id="S4.E1.m1.3.3.1.1.1.2.3.cmml" xref="S4.E1.m1.3.3.1.1.1.2.3"></infinity></apply><apply id="S4.E1.m1.3.3.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1"><times id="S4.E1.m1.3.3.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.2"></times><apply id="S4.E1.m1.3.3.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1"><ci id="S4.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.2">⋅</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1"><times id="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2"></times><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3">Pr</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><eq id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2"><mtext id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">collision</mtext></ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑁</ci></apply><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><ci id="S4.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.3">pmf</ci></apply><interval closure="open" id="S4.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.3.2"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝑛</ci><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝜆</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.3c">\displaystyle=\sum_{n=1}^{\infty}\mathrm{Pr}\left[\text{collision}\mid N=n%
\right]\cdot\mathrm{pmf}(n,\lambda),</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.3d">= ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_Pr [ collision ∣ italic_N = italic_n ] ⋅ roman_pmf ( italic_n , italic_λ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.21">where <math alttext="\mathrm{Pr}\left[\text{collision}\mid N=n\right]" class="ltx_Math" display="inline" id="S4.SS2.p2.16.m1.1"><semantics id="S4.SS2.p2.16.m1.1a"><mrow id="S4.SS2.p2.16.m1.1.1" xref="S4.SS2.p2.16.m1.1.1.cmml"><mi id="S4.SS2.p2.16.m1.1.1.3" xref="S4.SS2.p2.16.m1.1.1.3.cmml">Pr</mi><mo id="S4.SS2.p2.16.m1.1.1.2" xref="S4.SS2.p2.16.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.16.m1.1.1.1.1" xref="S4.SS2.p2.16.m1.1.1.1.2.cmml"><mo id="S4.SS2.p2.16.m1.1.1.1.1.2" xref="S4.SS2.p2.16.m1.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS2.p2.16.m1.1.1.1.1.1" xref="S4.SS2.p2.16.m1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.16.m1.1.1.1.1.1.2" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2.cmml"><mtext id="S4.SS2.p2.16.m1.1.1.1.1.1.2.2" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2.2a.cmml">collision</mtext><mo id="S4.SS2.p2.16.m1.1.1.1.1.1.2.1" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2.1.cmml">∣</mo><mi id="S4.SS2.p2.16.m1.1.1.1.1.1.2.3" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="S4.SS2.p2.16.m1.1.1.1.1.1.1" xref="S4.SS2.p2.16.m1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.SS2.p2.16.m1.1.1.1.1.1.3" xref="S4.SS2.p2.16.m1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S4.SS2.p2.16.m1.1.1.1.1.3" xref="S4.SS2.p2.16.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.m1.1b"><apply id="S4.SS2.p2.16.m1.1.1.cmml" xref="S4.SS2.p2.16.m1.1.1"><times id="S4.SS2.p2.16.m1.1.1.2.cmml" xref="S4.SS2.p2.16.m1.1.1.2"></times><ci id="S4.SS2.p2.16.m1.1.1.3.cmml" xref="S4.SS2.p2.16.m1.1.1.3">Pr</ci><apply id="S4.SS2.p2.16.m1.1.1.1.2.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.16.m1.1.1.1.2.1.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p2.16.m1.1.1.1.1.1.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.1"><eq id="S4.SS2.p2.16.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.1.1"></eq><apply id="S4.SS2.p2.16.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.SS2.p2.16.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2.1">conditional</csymbol><ci id="S4.SS2.p2.16.m1.1.1.1.1.1.2.2a.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2.2"><mtext id="S4.SS2.p2.16.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2.2">collision</mtext></ci><ci id="S4.SS2.p2.16.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.1.2.3">𝑁</ci></apply><ci id="S4.SS2.p2.16.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.16.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.m1.1c">\mathrm{Pr}\left[\text{collision}\mid N=n\right]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.16.m1.1d">roman_Pr [ collision ∣ italic_N = italic_n ]</annotation></semantics></math> is the probability that any of the <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p2.17.m2.1"><semantics id="S4.SS2.p2.17.m2.1a"><mi id="S4.SS2.p2.17.m2.1.1" xref="S4.SS2.p2.17.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.17.m2.1b"><ci id="S4.SS2.p2.17.m2.1.1.cmml" xref="S4.SS2.p2.17.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.17.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.17.m2.1d">italic_n</annotation></semantics></math> distinct packets simultaneously in transit from <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p2.18.m3.1"><semantics id="S4.SS2.p2.18.m3.1a"><mi id="S4.SS2.p2.18.m3.1.1" xref="S4.SS2.p2.18.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.18.m3.1b"><ci id="S4.SS2.p2.18.m3.1.1.cmml" xref="S4.SS2.p2.18.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.18.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.18.m3.1d">italic_S</annotation></semantics></math> to <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.p2.19.m4.1"><semantics id="S4.SS2.p2.19.m4.1a"><mi id="S4.SS2.p2.19.m4.1.1" xref="S4.SS2.p2.19.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.19.m4.1b"><ci id="S4.SS2.p2.19.m4.1.1.cmml" xref="S4.SS2.p2.19.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.19.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.19.m4.1d">italic_C</annotation></semantics></math> are assigned the same IPID (which varies by IPID selection method) and <math alttext="\mathrm{Pr}\left[N=n\right]=\mathrm{pmf}(n,\lambda)" class="ltx_Math" display="inline" id="S4.SS2.p2.20.m5.3"><semantics id="S4.SS2.p2.20.m5.3a"><mrow id="S4.SS2.p2.20.m5.3.3" xref="S4.SS2.p2.20.m5.3.3.cmml"><mrow id="S4.SS2.p2.20.m5.3.3.1" xref="S4.SS2.p2.20.m5.3.3.1.cmml"><mi id="S4.SS2.p2.20.m5.3.3.1.3" xref="S4.SS2.p2.20.m5.3.3.1.3.cmml">Pr</mi><mo id="S4.SS2.p2.20.m5.3.3.1.2" xref="S4.SS2.p2.20.m5.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.20.m5.3.3.1.1.1" xref="S4.SS2.p2.20.m5.3.3.1.1.2.cmml"><mo id="S4.SS2.p2.20.m5.3.3.1.1.1.2" xref="S4.SS2.p2.20.m5.3.3.1.1.2.1.cmml">[</mo><mrow id="S4.SS2.p2.20.m5.3.3.1.1.1.1" xref="S4.SS2.p2.20.m5.3.3.1.1.1.1.cmml"><mi id="S4.SS2.p2.20.m5.3.3.1.1.1.1.2" xref="S4.SS2.p2.20.m5.3.3.1.1.1.1.2.cmml">N</mi><mo id="S4.SS2.p2.20.m5.3.3.1.1.1.1.1" xref="S4.SS2.p2.20.m5.3.3.1.1.1.1.1.cmml">=</mo><mi id="S4.SS2.p2.20.m5.3.3.1.1.1.1.3" xref="S4.SS2.p2.20.m5.3.3.1.1.1.1.3.cmml">n</mi></mrow><mo id="S4.SS2.p2.20.m5.3.3.1.1.1.3" xref="S4.SS2.p2.20.m5.3.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.SS2.p2.20.m5.3.3.2" xref="S4.SS2.p2.20.m5.3.3.2.cmml">=</mo><mrow id="S4.SS2.p2.20.m5.3.3.3" xref="S4.SS2.p2.20.m5.3.3.3.cmml"><mi id="S4.SS2.p2.20.m5.3.3.3.2" xref="S4.SS2.p2.20.m5.3.3.3.2.cmml">pmf</mi><mo id="S4.SS2.p2.20.m5.3.3.3.1" xref="S4.SS2.p2.20.m5.3.3.3.1.cmml">⁢</mo><mrow id="S4.SS2.p2.20.m5.3.3.3.3.2" xref="S4.SS2.p2.20.m5.3.3.3.3.1.cmml"><mo id="S4.SS2.p2.20.m5.3.3.3.3.2.1" stretchy="false" xref="S4.SS2.p2.20.m5.3.3.3.3.1.cmml">(</mo><mi id="S4.SS2.p2.20.m5.1.1" xref="S4.SS2.p2.20.m5.1.1.cmml">n</mi><mo id="S4.SS2.p2.20.m5.3.3.3.3.2.2" xref="S4.SS2.p2.20.m5.3.3.3.3.1.cmml">,</mo><mi id="S4.SS2.p2.20.m5.2.2" xref="S4.SS2.p2.20.m5.2.2.cmml">λ</mi><mo id="S4.SS2.p2.20.m5.3.3.3.3.2.3" stretchy="false" xref="S4.SS2.p2.20.m5.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.20.m5.3b"><apply id="S4.SS2.p2.20.m5.3.3.cmml" xref="S4.SS2.p2.20.m5.3.3"><eq id="S4.SS2.p2.20.m5.3.3.2.cmml" xref="S4.SS2.p2.20.m5.3.3.2"></eq><apply id="S4.SS2.p2.20.m5.3.3.1.cmml" xref="S4.SS2.p2.20.m5.3.3.1"><times id="S4.SS2.p2.20.m5.3.3.1.2.cmml" xref="S4.SS2.p2.20.m5.3.3.1.2"></times><ci id="S4.SS2.p2.20.m5.3.3.1.3.cmml" xref="S4.SS2.p2.20.m5.3.3.1.3">Pr</ci><apply id="S4.SS2.p2.20.m5.3.3.1.1.2.cmml" xref="S4.SS2.p2.20.m5.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.20.m5.3.3.1.1.2.1.cmml" xref="S4.SS2.p2.20.m5.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p2.20.m5.3.3.1.1.1.1.cmml" xref="S4.SS2.p2.20.m5.3.3.1.1.1.1"><eq id="S4.SS2.p2.20.m5.3.3.1.1.1.1.1.cmml" xref="S4.SS2.p2.20.m5.3.3.1.1.1.1.1"></eq><ci id="S4.SS2.p2.20.m5.3.3.1.1.1.1.2.cmml" xref="S4.SS2.p2.20.m5.3.3.1.1.1.1.2">𝑁</ci><ci id="S4.SS2.p2.20.m5.3.3.1.1.1.1.3.cmml" xref="S4.SS2.p2.20.m5.3.3.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S4.SS2.p2.20.m5.3.3.3.cmml" xref="S4.SS2.p2.20.m5.3.3.3"><times id="S4.SS2.p2.20.m5.3.3.3.1.cmml" xref="S4.SS2.p2.20.m5.3.3.3.1"></times><ci id="S4.SS2.p2.20.m5.3.3.3.2.cmml" xref="S4.SS2.p2.20.m5.3.3.3.2">pmf</ci><interval closure="open" id="S4.SS2.p2.20.m5.3.3.3.3.1.cmml" xref="S4.SS2.p2.20.m5.3.3.3.3.2"><ci id="S4.SS2.p2.20.m5.1.1.cmml" xref="S4.SS2.p2.20.m5.1.1">𝑛</ci><ci id="S4.SS2.p2.20.m5.2.2.cmml" xref="S4.SS2.p2.20.m5.2.2">𝜆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.20.m5.3c">\mathrm{Pr}\left[N=n\right]=\mathrm{pmf}(n,\lambda)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.20.m5.3d">roman_Pr [ italic_N = italic_n ] = roman_pmf ( italic_n , italic_λ )</annotation></semantics></math> follows from <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p2.21.m6.1"><semantics id="S4.SS2.p2.21.m6.1a"><mi id="S4.SS2.p2.21.m6.1.1" xref="S4.SS2.p2.21.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.21.m6.1b"><ci id="S4.SS2.p2.21.m6.1.1.cmml" xref="S4.SS2.p2.21.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.21.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.21.m6.1d">italic_N</annotation></semantics></math> being Poisson-distributed.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="373" id="S4.F6.g1" src="x7.png" width="498"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F6.7.3.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text ltx_font_italic" id="S4.F6.4.2" style="font-size:90%;">Comparison of IPID Selection Methods’ Correctness.<span class="ltx_text ltx_font_upright" id="S4.F6.4.2.2">
Worst-case collision probabilities for globally incrementing (dark blue, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E8" title="In A.1.1. Globally Incrementing ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">8</span></a>), per-connection (olive, also Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E8" title="In A.1.1. Globally Incrementing ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">8</span></a>), per-destination (pink, also Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E8" title="In A.1.1. Globally Incrementing ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">8</span></a>), per-bucket (teal, simulation), and PRNG-based (orange, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.Ex2" title="A.1.4. PRNG (searchable queue of size 𝑘) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.1.4</span></a>) IPID selection as a function of <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.F6.3.1.1.m1.1"><semantics id="S4.F6.3.1.1.m1.1b"><mi id="S4.F6.3.1.1.m1.1.1" xref="S4.F6.3.1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.F6.3.1.1.m1.1c"><ci id="S4.F6.3.1.1.m1.1.1.cmml" xref="S4.F6.3.1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.3.1.1.m1.1d">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.F6.3.1.1.m1.1e">italic_λ</annotation></semantics></math>, the Poisson rate of packet transmission.
The total number of distinct IPIDs, <math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.F6.4.2.2.m2.1"><semantics id="S4.F6.4.2.2.m2.1b"><msup id="S4.F6.4.2.2.m2.1.1" xref="S4.F6.4.2.2.m2.1.1.cmml"><mn id="S4.F6.4.2.2.m2.1.1.2" xref="S4.F6.4.2.2.m2.1.1.2.cmml">2</mn><mn id="S4.F6.4.2.2.m2.1.1.3" xref="S4.F6.4.2.2.m2.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.F6.4.2.2.m2.1c"><apply id="S4.F6.4.2.2.m2.1.1.cmml" xref="S4.F6.4.2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.F6.4.2.2.m2.1.1.1.cmml" xref="S4.F6.4.2.2.m2.1.1">superscript</csymbol><cn id="S4.F6.4.2.2.m2.1.1.2.cmml" type="integer" xref="S4.F6.4.2.2.m2.1.1.2">2</cn><cn id="S4.F6.4.2.2.m2.1.1.3.cmml" type="integer" xref="S4.F6.4.2.2.m2.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.4.2.2.m2.1d">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.F6.4.2.2.m2.1e">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, is shown as a black dotted line.
Note that the collision probabilities of the four counter-based methods coincide.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.3">In Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1" title="A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.1</span></a>, we derive these worst-case collision probabilities for all <span class="ltx_ERROR undefined" id="S4.SS2.p3.3.1">\replaced</span>sevensix IPID selection methods.
The results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.F6" title="Figure 6 ‣ 4.2. Analyzing Correctness ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">6</span></a>.
Globally incrementing, per-connection, and per-destination selection all increment sequentially, so their collision probabilities are effectively zero until there are so many packets simultaneously in transit that it is probable to exhaust all <math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><msup id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mn id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">2</mn><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">superscript</csymbol><cn id="S4.SS2.p3.1.m1.1.1.2.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.2">2</cn><cn id="S4.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> IPIDs and reuse at least one.
Perhaps more surprising is that per-bucket selection has nearly identical collision probabilities to the other counter-based methods even though its stochastic increments may skip some IPID values, cycle back around, and cause a collision in fewer than <math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><msup id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mn id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">2</mn><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">superscript</csymbol><cn id="S4.SS2.p3.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.p3.2.m2.1.1.2">2</cn><cn id="S4.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p3.2.m2.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> packets.
To understand why, recall that a per-bucket counter’s increment value is chosen uniformly at random from 1 to the number of system ticks since the counter was last incremented (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3" title="2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.3</span></a>).
Any traffic rate <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_λ</annotation></semantics></math> that generates enough packets to cause a probable collision also requests IPIDs so frequently that the per-bucket counter effectively increments sequentially.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.14">PRNG-based methods yield non-negligible collision probabilities at slower traffic rates <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_λ</annotation></semantics></math> than the counter-based methods do, with larger numbers <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">italic_k</annotation></semantics></math> of IPIDs stored for non-repetition corresponding to better collision avoidance.
<span class="ltx_ERROR undefined" id="S4.SS2.p4.14.1">\added</span>Pure PRNG selection (<math alttext="k=0" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">k</mi><mo id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><eq id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1"></eq><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">𝑘</ci><cn id="S4.SS2.p4.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p4.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">k=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">italic_k = 0</annotation></semantics></math>) yields particularly poor correctness, succumbing to the birthday paradox: when <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m4.1"><semantics id="S4.SS2.p4.4.m4.1a"><mi id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><ci id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.1d">italic_n</annotation></semantics></math> packets (“people”) are assigned IPIDs uniformly at random from among the <math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m5.1"><semantics id="S4.SS2.p4.5.m5.1a"><msup id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mn id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">2</mn><mn id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">superscript</csymbol><cn id="S4.SS2.p4.5.m5.1.1.2.cmml" type="integer" xref="S4.SS2.p4.5.m5.1.1.2">2</cn><cn id="S4.SS2.p4.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p4.5.m5.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m5.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> possible values (“birthdays”), it becomes quite likely that multiple packets have the same IPID.
At <math alttext="\lambda=2^{5}" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m6.1"><semantics id="S4.SS2.p4.6.m6.1a"><mrow id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml"><mi id="S4.SS2.p4.6.m6.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2.cmml">λ</mi><mo id="S4.SS2.p4.6.m6.1.1.1" xref="S4.SS2.p4.6.m6.1.1.1.cmml">=</mo><msup id="S4.SS2.p4.6.m6.1.1.3" xref="S4.SS2.p4.6.m6.1.1.3.cmml"><mn id="S4.SS2.p4.6.m6.1.1.3.2" xref="S4.SS2.p4.6.m6.1.1.3.2.cmml">2</mn><mn id="S4.SS2.p4.6.m6.1.1.3.3" xref="S4.SS2.p4.6.m6.1.1.3.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><apply id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1"><eq id="S4.SS2.p4.6.m6.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1"></eq><ci id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2">𝜆</ci><apply id="S4.SS2.p4.6.m6.1.1.3.cmml" xref="S4.SS2.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.1.1.3.1.cmml" xref="S4.SS2.p4.6.m6.1.1.3">superscript</csymbol><cn id="S4.SS2.p4.6.m6.1.1.3.2.cmml" type="integer" xref="S4.SS2.p4.6.m6.1.1.3.2">2</cn><cn id="S4.SS2.p4.6.m6.1.1.3.3.cmml" type="integer" xref="S4.SS2.p4.6.m6.1.1.3.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">\lambda=2^{5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m6.1d">italic_λ = 2 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math> (<math alttext="\approx 40~{}\text{Mbps}" class="ltx_Math" display="inline" id="S4.SS2.p4.7.m7.1"><semantics id="S4.SS2.p4.7.m7.1a"><mrow id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml"><mi id="S4.SS2.p4.7.m7.1.1.2" xref="S4.SS2.p4.7.m7.1.1.2.cmml"></mi><mo id="S4.SS2.p4.7.m7.1.1.1" xref="S4.SS2.p4.7.m7.1.1.1.cmml">≈</mo><mrow id="S4.SS2.p4.7.m7.1.1.3" xref="S4.SS2.p4.7.m7.1.1.3.cmml"><mn id="S4.SS2.p4.7.m7.1.1.3.2" xref="S4.SS2.p4.7.m7.1.1.3.2.cmml">40</mn><mo id="S4.SS2.p4.7.m7.1.1.3.1" lspace="0.330em" xref="S4.SS2.p4.7.m7.1.1.3.1.cmml">⁢</mo><mtext id="S4.SS2.p4.7.m7.1.1.3.3" xref="S4.SS2.p4.7.m7.1.1.3.3a.cmml">Mbps</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><apply id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1"><approx id="S4.SS2.p4.7.m7.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1.1"></approx><csymbol cd="latexml" id="S4.SS2.p4.7.m7.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1.2">absent</csymbol><apply id="S4.SS2.p4.7.m7.1.1.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3"><times id="S4.SS2.p4.7.m7.1.1.3.1.cmml" xref="S4.SS2.p4.7.m7.1.1.3.1"></times><cn id="S4.SS2.p4.7.m7.1.1.3.2.cmml" type="integer" xref="S4.SS2.p4.7.m7.1.1.3.2">40</cn><ci id="S4.SS2.p4.7.m7.1.1.3.3a.cmml" xref="S4.SS2.p4.7.m7.1.1.3.3"><mtext id="S4.SS2.p4.7.m7.1.1.3.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3.3">Mbps</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">\approx 40~{}\text{Mbps}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.7.m7.1d">≈ 40 Mbps</annotation></semantics></math>), there is a 1% chance of collision; at <math alttext="\lambda=2^{7}" class="ltx_Math" display="inline" id="S4.SS2.p4.8.m8.1"><semantics id="S4.SS2.p4.8.m8.1a"><mrow id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml"><mi id="S4.SS2.p4.8.m8.1.1.2" xref="S4.SS2.p4.8.m8.1.1.2.cmml">λ</mi><mo id="S4.SS2.p4.8.m8.1.1.1" xref="S4.SS2.p4.8.m8.1.1.1.cmml">=</mo><msup id="S4.SS2.p4.8.m8.1.1.3" xref="S4.SS2.p4.8.m8.1.1.3.cmml"><mn id="S4.SS2.p4.8.m8.1.1.3.2" xref="S4.SS2.p4.8.m8.1.1.3.2.cmml">2</mn><mn id="S4.SS2.p4.8.m8.1.1.3.3" xref="S4.SS2.p4.8.m8.1.1.3.3.cmml">7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b"><apply id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1"><eq id="S4.SS2.p4.8.m8.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1.1"></eq><ci id="S4.SS2.p4.8.m8.1.1.2.cmml" xref="S4.SS2.p4.8.m8.1.1.2">𝜆</ci><apply id="S4.SS2.p4.8.m8.1.1.3.cmml" xref="S4.SS2.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.3.1.cmml" xref="S4.SS2.p4.8.m8.1.1.3">superscript</csymbol><cn id="S4.SS2.p4.8.m8.1.1.3.2.cmml" type="integer" xref="S4.SS2.p4.8.m8.1.1.3.2">2</cn><cn id="S4.SS2.p4.8.m8.1.1.3.3.cmml" type="integer" xref="S4.SS2.p4.8.m8.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">\lambda=2^{7}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.8.m8.1d">italic_λ = 2 start_POSTSUPERSCRIPT 7 end_POSTSUPERSCRIPT</annotation></semantics></math> (<math alttext="\approx 150~{}\text{Mbps}" class="ltx_Math" display="inline" id="S4.SS2.p4.9.m9.1"><semantics id="S4.SS2.p4.9.m9.1a"><mrow id="S4.SS2.p4.9.m9.1.1" xref="S4.SS2.p4.9.m9.1.1.cmml"><mi id="S4.SS2.p4.9.m9.1.1.2" xref="S4.SS2.p4.9.m9.1.1.2.cmml"></mi><mo id="S4.SS2.p4.9.m9.1.1.1" xref="S4.SS2.p4.9.m9.1.1.1.cmml">≈</mo><mrow id="S4.SS2.p4.9.m9.1.1.3" xref="S4.SS2.p4.9.m9.1.1.3.cmml"><mn id="S4.SS2.p4.9.m9.1.1.3.2" xref="S4.SS2.p4.9.m9.1.1.3.2.cmml">150</mn><mo id="S4.SS2.p4.9.m9.1.1.3.1" lspace="0.330em" xref="S4.SS2.p4.9.m9.1.1.3.1.cmml">⁢</mo><mtext id="S4.SS2.p4.9.m9.1.1.3.3" xref="S4.SS2.p4.9.m9.1.1.3.3a.cmml">Mbps</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m9.1b"><apply id="S4.SS2.p4.9.m9.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1"><approx id="S4.SS2.p4.9.m9.1.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1.1"></approx><csymbol cd="latexml" id="S4.SS2.p4.9.m9.1.1.2.cmml" xref="S4.SS2.p4.9.m9.1.1.2">absent</csymbol><apply id="S4.SS2.p4.9.m9.1.1.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3"><times id="S4.SS2.p4.9.m9.1.1.3.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3.1"></times><cn id="S4.SS2.p4.9.m9.1.1.3.2.cmml" type="integer" xref="S4.SS2.p4.9.m9.1.1.3.2">150</cn><ci id="S4.SS2.p4.9.m9.1.1.3.3a.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3"><mtext id="S4.SS2.p4.9.m9.1.1.3.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3.3">Mbps</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m9.1c">\approx 150~{}\text{Mbps}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.9.m9.1d">≈ 150 Mbps</annotation></semantics></math>), this probability increases to 10%.
<span class="ltx_ERROR undefined" id="S4.SS2.p4.14.2">\replaced</span>Methods that reserve <math alttext="k\gg 0" class="ltx_Math" display="inline" id="S4.SS2.p4.10.m10.1"><semantics id="S4.SS2.p4.10.m10.1a"><mrow id="S4.SS2.p4.10.m10.1.1" xref="S4.SS2.p4.10.m10.1.1.cmml"><mi id="S4.SS2.p4.10.m10.1.1.2" xref="S4.SS2.p4.10.m10.1.1.2.cmml">k</mi><mo id="S4.SS2.p4.10.m10.1.1.1" xref="S4.SS2.p4.10.m10.1.1.1.cmml">≫</mo><mn id="S4.SS2.p4.10.m10.1.1.3" xref="S4.SS2.p4.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m10.1b"><apply id="S4.SS2.p4.10.m10.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1"><csymbol cd="latexml" id="S4.SS2.p4.10.m10.1.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1.1">much-greater-than</csymbol><ci id="S4.SS2.p4.10.m10.1.1.2.cmml" xref="S4.SS2.p4.10.m10.1.1.2">𝑘</ci><cn id="S4.SS2.p4.10.m10.1.1.3.cmml" type="integer" xref="S4.SS2.p4.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.10.m10.1c">k\gg 0</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.10.m10.1d">italic_k ≫ 0</annotation></semantics></math> IPIDs for non-repetition achieve negligible collision probabilities until transmission rates become relatively fast (<math alttext="\lambda\geq k" class="ltx_Math" display="inline" id="S4.SS2.p4.11.m11.1"><semantics id="S4.SS2.p4.11.m11.1a"><mrow id="S4.SS2.p4.11.m11.1.1" xref="S4.SS2.p4.11.m11.1.1.cmml"><mi id="S4.SS2.p4.11.m11.1.1.2" xref="S4.SS2.p4.11.m11.1.1.2.cmml">λ</mi><mo id="S4.SS2.p4.11.m11.1.1.1" xref="S4.SS2.p4.11.m11.1.1.1.cmml">≥</mo><mi id="S4.SS2.p4.11.m11.1.1.3" xref="S4.SS2.p4.11.m11.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.11.m11.1b"><apply id="S4.SS2.p4.11.m11.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1"><geq id="S4.SS2.p4.11.m11.1.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1.1"></geq><ci id="S4.SS2.p4.11.m11.1.1.2.cmml" xref="S4.SS2.p4.11.m11.1.1.2">𝜆</ci><ci id="S4.SS2.p4.11.m11.1.1.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.11.m11.1c">\lambda\geq k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.11.m11.1d">italic_λ ≥ italic_k</annotation></semantics></math>).Nevertheless, even with the smallest <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p4.12.m12.1"><semantics id="S4.SS2.p4.12.m12.1a"><mi id="S4.SS2.p4.12.m12.1.1" xref="S4.SS2.p4.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.12.m12.1b"><ci id="S4.SS2.p4.12.m12.1.1.cmml" xref="S4.SS2.p4.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.12.m12.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.12.m12.1d">italic_k</annotation></semantics></math> we analyzed (macOS, <math alttext="k=\numprint{4096}=2^{12}" class="ltx_Math" display="inline" id="S4.SS2.p4.13.m13.2"><semantics id="S4.SS2.p4.13.m13.2a"><mrow id="S4.SS2.p4.13.m13.2.3" xref="S4.SS2.p4.13.m13.2.3.cmml"><mi id="S4.SS2.p4.13.m13.2.3.2" xref="S4.SS2.p4.13.m13.2.3.2.cmml">k</mi><mo id="S4.SS2.p4.13.m13.2.3.3" xref="S4.SS2.p4.13.m13.2.3.3.cmml">=</mo><mrow id="S4.SS2.p4.13.m13.2.2.4" xref="S4.SS2.p4.13.m13.2.3.cmml"><mn id="S4.SS2.p4.13.m13.1.1.1.1" xref="S4.SS2.p4.13.m13.2.2.3.cmml">4</mn><mo id="S4.SS2.p4.13.m13.2.2.4.1" xref="S4.SS2.p4.13.m13.2.2.3.cmml">,</mo><mn id="S4.SS2.p4.13.m13.2.2.2.2" xref="S4.SS2.p4.13.m13.2.2.3.cmml">096</mn></mrow><mo id="S4.SS2.p4.13.m13.2.3.4" xref="S4.SS2.p4.13.m13.2.3.4.cmml">=</mo><msup id="S4.SS2.p4.13.m13.2.3.5" xref="S4.SS2.p4.13.m13.2.3.5.cmml"><mn id="S4.SS2.p4.13.m13.2.3.5.2" xref="S4.SS2.p4.13.m13.2.3.5.2.cmml">2</mn><mn id="S4.SS2.p4.13.m13.2.3.5.3" xref="S4.SS2.p4.13.m13.2.3.5.3.cmml">12</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.13.m13.2b"><apply id="S4.SS2.p4.13.m13.2.3.cmml" xref="S4.SS2.p4.13.m13.2.3"><and id="S4.SS2.p4.13.m13.2.3a.cmml" xref="S4.SS2.p4.13.m13.2.3"></and><apply id="S4.SS2.p4.13.m13.2.3b.cmml" xref="S4.SS2.p4.13.m13.2.3"><eq id="S4.SS2.p4.13.m13.2.3.3.cmml" xref="S4.SS2.p4.13.m13.2.3.3"></eq><ci id="S4.SS2.p4.13.m13.2.3.2.cmml" xref="S4.SS2.p4.13.m13.2.3.2">𝑘</ci><cn id="S4.SS2.p4.13.m13.2.2.3.cmml" type="integer" xref="S4.SS2.p4.13.m13.1.1.1.1">4096</cn></apply><apply id="S4.SS2.p4.13.m13.2.3c.cmml" xref="S4.SS2.p4.13.m13.2.3"><eq id="S4.SS2.p4.13.m13.2.3.4.cmml" xref="S4.SS2.p4.13.m13.2.3.4"></eq><share href="https://arxiv.org/html/2406.06483v2#S4.SS2.p4.13.m13.2.2.cmml" id="S4.SS2.p4.13.m13.2.3d.cmml" xref="S4.SS2.p4.13.m13.2.3"></share><apply id="S4.SS2.p4.13.m13.2.3.5.cmml" xref="S4.SS2.p4.13.m13.2.3.5"><csymbol cd="ambiguous" id="S4.SS2.p4.13.m13.2.3.5.1.cmml" xref="S4.SS2.p4.13.m13.2.3.5">superscript</csymbol><cn id="S4.SS2.p4.13.m13.2.3.5.2.cmml" type="integer" xref="S4.SS2.p4.13.m13.2.3.5.2">2</cn><cn id="S4.SS2.p4.13.m13.2.3.5.3.cmml" type="integer" xref="S4.SS2.p4.13.m13.2.3.5.3">12</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.13.m13.2c">k=\numprint{4096}=2^{12}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.13.m13.2d">italic_k = 4 , 096 = 2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math>), PRNG selection avoids collisions until transmission rates become relatively fast (<math alttext="\lambda&gt;2^{11}" class="ltx_Math" display="inline" id="S4.SS2.p4.14.m14.1"><semantics id="S4.SS2.p4.14.m14.1a"><mrow id="S4.SS2.p4.14.m14.1.1" xref="S4.SS2.p4.14.m14.1.1.cmml"><mi id="S4.SS2.p4.14.m14.1.1.2" xref="S4.SS2.p4.14.m14.1.1.2.cmml">λ</mi><mo id="S4.SS2.p4.14.m14.1.1.1" xref="S4.SS2.p4.14.m14.1.1.1.cmml">&gt;</mo><msup id="S4.SS2.p4.14.m14.1.1.3" xref="S4.SS2.p4.14.m14.1.1.3.cmml"><mn id="S4.SS2.p4.14.m14.1.1.3.2" xref="S4.SS2.p4.14.m14.1.1.3.2.cmml">2</mn><mn id="S4.SS2.p4.14.m14.1.1.3.3" xref="S4.SS2.p4.14.m14.1.1.3.3.cmml">11</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.14.m14.1b"><apply id="S4.SS2.p4.14.m14.1.1.cmml" xref="S4.SS2.p4.14.m14.1.1"><gt id="S4.SS2.p4.14.m14.1.1.1.cmml" xref="S4.SS2.p4.14.m14.1.1.1"></gt><ci id="S4.SS2.p4.14.m14.1.1.2.cmml" xref="S4.SS2.p4.14.m14.1.1.2">𝜆</ci><apply id="S4.SS2.p4.14.m14.1.1.3.cmml" xref="S4.SS2.p4.14.m14.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.14.m14.1.1.3.1.cmml" xref="S4.SS2.p4.14.m14.1.1.3">superscript</csymbol><cn id="S4.SS2.p4.14.m14.1.1.3.2.cmml" type="integer" xref="S4.SS2.p4.14.m14.1.1.3.2">2</cn><cn id="S4.SS2.p4.14.m14.1.1.3.3.cmml" type="integer" xref="S4.SS2.p4.14.m14.1.1.3.3">11</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.14.m14.1c">\lambda&gt;2^{11}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.14.m14.1d">italic_λ &gt; 2 start_POSTSUPERSCRIPT 11 end_POSTSUPERSCRIPT</annotation></semantics></math>).
This is especially appropriate for macOS, which is rarely used for high-traffic servers.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Analyzing Security</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.2">Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3" title="3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3</span></a> categorized numerous IPID-based exploits as probe comparisons and fragment injections.
As highlighted by Conditions <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.I2.i2" title="item PC2 ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">PC2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.I4.i1" title="item FI1 ‣ 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">FI1</span></a>, the fundamental issue of <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.2.1">predictability</span> in IPID generation underlies the success of both types of exploits.
With this motivation, we analyze each selection method’s security in terms of its <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.2.2">probability of an adversarial guess</span> which, informally, is the ability of an off-path adversary <math alttext="A" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_A</annotation></semantics></math> to guess the next IPID a server <math alttext="S" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_S</annotation></semantics></math> will assign in real time.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.13">Formally, consider an off-path adversary <math alttext="A" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_A</annotation></semantics></math> trying to predict the next IPID generated by a particular IPID resource <math alttext="i\in\{1,\ldots,r\}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.3"><semantics id="S4.SS3.p2.2.m2.3a"><mrow id="S4.SS3.p2.2.m2.3.4" xref="S4.SS3.p2.2.m2.3.4.cmml"><mi id="S4.SS3.p2.2.m2.3.4.2" xref="S4.SS3.p2.2.m2.3.4.2.cmml">i</mi><mo id="S4.SS3.p2.2.m2.3.4.1" xref="S4.SS3.p2.2.m2.3.4.1.cmml">∈</mo><mrow id="S4.SS3.p2.2.m2.3.4.3.2" xref="S4.SS3.p2.2.m2.3.4.3.1.cmml"><mo id="S4.SS3.p2.2.m2.3.4.3.2.1" stretchy="false" xref="S4.SS3.p2.2.m2.3.4.3.1.cmml">{</mo><mn id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">1</mn><mo id="S4.SS3.p2.2.m2.3.4.3.2.2" xref="S4.SS3.p2.2.m2.3.4.3.1.cmml">,</mo><mi id="S4.SS3.p2.2.m2.2.2" mathvariant="normal" xref="S4.SS3.p2.2.m2.2.2.cmml">…</mi><mo id="S4.SS3.p2.2.m2.3.4.3.2.3" xref="S4.SS3.p2.2.m2.3.4.3.1.cmml">,</mo><mi id="S4.SS3.p2.2.m2.3.3" xref="S4.SS3.p2.2.m2.3.3.cmml">r</mi><mo id="S4.SS3.p2.2.m2.3.4.3.2.4" stretchy="false" xref="S4.SS3.p2.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.3b"><apply id="S4.SS3.p2.2.m2.3.4.cmml" xref="S4.SS3.p2.2.m2.3.4"><in id="S4.SS3.p2.2.m2.3.4.1.cmml" xref="S4.SS3.p2.2.m2.3.4.1"></in><ci id="S4.SS3.p2.2.m2.3.4.2.cmml" xref="S4.SS3.p2.2.m2.3.4.2">𝑖</ci><set id="S4.SS3.p2.2.m2.3.4.3.1.cmml" xref="S4.SS3.p2.2.m2.3.4.3.2"><cn id="S4.SS3.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS3.p2.2.m2.1.1">1</cn><ci id="S4.SS3.p2.2.m2.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2">…</ci><ci id="S4.SS3.p2.2.m2.3.3.cmml" xref="S4.SS3.p2.2.m2.3.3">𝑟</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.3c">i\in\{1,\ldots,r\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.3d">italic_i ∈ { 1 , … , italic_r }</annotation></semantics></math> (i.e., a counter or PRNG) on <math alttext="S" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">italic_S</annotation></semantics></math>.
We assume <math alttext="A" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_A</annotation></semantics></math> knows—but cannot influence—both the rate <math alttext="\lambda&gt;0" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m5.1"><semantics id="S4.SS3.p2.5.m5.1a"><mrow id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml"><mi id="S4.SS3.p2.5.m5.1.1.2" xref="S4.SS3.p2.5.m5.1.1.2.cmml">λ</mi><mo id="S4.SS3.p2.5.m5.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.cmml">&gt;</mo><mn id="S4.SS3.p2.5.m5.1.1.3" xref="S4.SS3.p2.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1"><gt id="S4.SS3.p2.5.m5.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1"></gt><ci id="S4.SS3.p2.5.m5.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1.2">𝜆</ci><cn id="S4.SS3.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.SS3.p2.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">\lambda&gt;0</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m5.1d">italic_λ &gt; 0</annotation></semantics></math> of all outgoing traffic from <math alttext="S" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m6.1"><semantics id="S4.SS3.p2.6.m6.1a"><mi id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><ci id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m6.1d">italic_S</annotation></semantics></math> and the rate <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m7.1"><semantics id="S4.SS3.p2.7.m7.1a"><msub id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml"><mi id="S4.SS3.p2.7.m7.1.1.2" xref="S4.SS3.p2.7.m7.1.1.2.cmml">λ</mi><mi id="S4.SS3.p2.7.m7.1.1.3" xref="S4.SS3.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><apply id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.1.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p2.7.m7.1.1.2.cmml" xref="S4.SS3.p2.7.m7.1.1.2">𝜆</ci><ci id="S4.SS3.p2.7.m7.1.1.3.cmml" xref="S4.SS3.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m7.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of only those packets whose IPIDs are assigned by resource <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m8.1"><semantics id="S4.SS3.p2.8.m8.1a"><mi id="S4.SS3.p2.8.m8.1.1" xref="S4.SS3.p2.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.1b"><ci id="S4.SS3.p2.8.m8.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m8.1d">italic_i</annotation></semantics></math>.
For globally incrementing and PRNG selection in which <math alttext="r=1" class="ltx_Math" display="inline" id="S4.SS3.p2.9.m9.1"><semantics id="S4.SS3.p2.9.m9.1a"><mrow id="S4.SS3.p2.9.m9.1.1" xref="S4.SS3.p2.9.m9.1.1.cmml"><mi id="S4.SS3.p2.9.m9.1.1.2" xref="S4.SS3.p2.9.m9.1.1.2.cmml">r</mi><mo id="S4.SS3.p2.9.m9.1.1.1" xref="S4.SS3.p2.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.9.m9.1.1.3" xref="S4.SS3.p2.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m9.1b"><apply id="S4.SS3.p2.9.m9.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1"><eq id="S4.SS3.p2.9.m9.1.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1.1"></eq><ci id="S4.SS3.p2.9.m9.1.1.2.cmml" xref="S4.SS3.p2.9.m9.1.1.2">𝑟</ci><cn id="S4.SS3.p2.9.m9.1.1.3.cmml" type="integer" xref="S4.SS3.p2.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m9.1c">r=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.9.m9.1d">italic_r = 1</annotation></semantics></math>, we have <math alttext="\lambda=\lambda_{i}" class="ltx_Math" display="inline" id="S4.SS3.p2.10.m10.1"><semantics id="S4.SS3.p2.10.m10.1a"><mrow id="S4.SS3.p2.10.m10.1.1" xref="S4.SS3.p2.10.m10.1.1.cmml"><mi id="S4.SS3.p2.10.m10.1.1.2" xref="S4.SS3.p2.10.m10.1.1.2.cmml">λ</mi><mo id="S4.SS3.p2.10.m10.1.1.1" xref="S4.SS3.p2.10.m10.1.1.1.cmml">=</mo><msub id="S4.SS3.p2.10.m10.1.1.3" xref="S4.SS3.p2.10.m10.1.1.3.cmml"><mi id="S4.SS3.p2.10.m10.1.1.3.2" xref="S4.SS3.p2.10.m10.1.1.3.2.cmml">λ</mi><mi id="S4.SS3.p2.10.m10.1.1.3.3" xref="S4.SS3.p2.10.m10.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m10.1b"><apply id="S4.SS3.p2.10.m10.1.1.cmml" xref="S4.SS3.p2.10.m10.1.1"><eq id="S4.SS3.p2.10.m10.1.1.1.cmml" xref="S4.SS3.p2.10.m10.1.1.1"></eq><ci id="S4.SS3.p2.10.m10.1.1.2.cmml" xref="S4.SS3.p2.10.m10.1.1.2">𝜆</ci><apply id="S4.SS3.p2.10.m10.1.1.3.cmml" xref="S4.SS3.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.10.m10.1.1.3.1.cmml" xref="S4.SS3.p2.10.m10.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.10.m10.1.1.3.2.cmml" xref="S4.SS3.p2.10.m10.1.1.3.2">𝜆</ci><ci id="S4.SS3.p2.10.m10.1.1.3.3.cmml" xref="S4.SS3.p2.10.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m10.1c">\lambda=\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.10.m10.1d">italic_λ = italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>; for the selection methods with <math alttext="r\geq 1" class="ltx_Math" display="inline" id="S4.SS3.p2.11.m11.1"><semantics id="S4.SS3.p2.11.m11.1a"><mrow id="S4.SS3.p2.11.m11.1.1" xref="S4.SS3.p2.11.m11.1.1.cmml"><mi id="S4.SS3.p2.11.m11.1.1.2" xref="S4.SS3.p2.11.m11.1.1.2.cmml">r</mi><mo id="S4.SS3.p2.11.m11.1.1.1" xref="S4.SS3.p2.11.m11.1.1.1.cmml">≥</mo><mn id="S4.SS3.p2.11.m11.1.1.3" xref="S4.SS3.p2.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m11.1b"><apply id="S4.SS3.p2.11.m11.1.1.cmml" xref="S4.SS3.p2.11.m11.1.1"><geq id="S4.SS3.p2.11.m11.1.1.1.cmml" xref="S4.SS3.p2.11.m11.1.1.1"></geq><ci id="S4.SS3.p2.11.m11.1.1.2.cmml" xref="S4.SS3.p2.11.m11.1.1.2">𝑟</ci><cn id="S4.SS3.p2.11.m11.1.1.3.cmml" type="integer" xref="S4.SS3.p2.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m11.1c">r\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.11.m11.1d">italic_r ≥ 1</annotation></semantics></math> counters, we have <math alttext="\lambda\geq\lambda_{i}\geq 0" class="ltx_Math" display="inline" id="S4.SS3.p2.12.m12.1"><semantics id="S4.SS3.p2.12.m12.1a"><mrow id="S4.SS3.p2.12.m12.1.1" xref="S4.SS3.p2.12.m12.1.1.cmml"><mi id="S4.SS3.p2.12.m12.1.1.2" xref="S4.SS3.p2.12.m12.1.1.2.cmml">λ</mi><mo id="S4.SS3.p2.12.m12.1.1.3" xref="S4.SS3.p2.12.m12.1.1.3.cmml">≥</mo><msub id="S4.SS3.p2.12.m12.1.1.4" xref="S4.SS3.p2.12.m12.1.1.4.cmml"><mi id="S4.SS3.p2.12.m12.1.1.4.2" xref="S4.SS3.p2.12.m12.1.1.4.2.cmml">λ</mi><mi id="S4.SS3.p2.12.m12.1.1.4.3" xref="S4.SS3.p2.12.m12.1.1.4.3.cmml">i</mi></msub><mo id="S4.SS3.p2.12.m12.1.1.5" xref="S4.SS3.p2.12.m12.1.1.5.cmml">≥</mo><mn id="S4.SS3.p2.12.m12.1.1.6" xref="S4.SS3.p2.12.m12.1.1.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m12.1b"><apply id="S4.SS3.p2.12.m12.1.1.cmml" xref="S4.SS3.p2.12.m12.1.1"><and id="S4.SS3.p2.12.m12.1.1a.cmml" xref="S4.SS3.p2.12.m12.1.1"></and><apply id="S4.SS3.p2.12.m12.1.1b.cmml" xref="S4.SS3.p2.12.m12.1.1"><geq id="S4.SS3.p2.12.m12.1.1.3.cmml" xref="S4.SS3.p2.12.m12.1.1.3"></geq><ci id="S4.SS3.p2.12.m12.1.1.2.cmml" xref="S4.SS3.p2.12.m12.1.1.2">𝜆</ci><apply id="S4.SS3.p2.12.m12.1.1.4.cmml" xref="S4.SS3.p2.12.m12.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m12.1.1.4.1.cmml" xref="S4.SS3.p2.12.m12.1.1.4">subscript</csymbol><ci id="S4.SS3.p2.12.m12.1.1.4.2.cmml" xref="S4.SS3.p2.12.m12.1.1.4.2">𝜆</ci><ci id="S4.SS3.p2.12.m12.1.1.4.3.cmml" xref="S4.SS3.p2.12.m12.1.1.4.3">𝑖</ci></apply></apply><apply id="S4.SS3.p2.12.m12.1.1c.cmml" xref="S4.SS3.p2.12.m12.1.1"><geq id="S4.SS3.p2.12.m12.1.1.5.cmml" xref="S4.SS3.p2.12.m12.1.1.5"></geq><share href="https://arxiv.org/html/2406.06483v2#S4.SS3.p2.12.m12.1.1.4.cmml" id="S4.SS3.p2.12.m12.1.1d.cmml" xref="S4.SS3.p2.12.m12.1.1"></share><cn id="S4.SS3.p2.12.m12.1.1.6.cmml" type="integer" xref="S4.SS3.p2.12.m12.1.1.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m12.1c">\lambda\geq\lambda_{i}\geq 0</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.12.m12.1d">italic_λ ≥ italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math>.
We further assume that <math alttext="A" class="ltx_Math" display="inline" id="S4.SS3.p2.13.m13.1"><semantics id="S4.SS3.p2.13.m13.1a"><mi id="S4.SS3.p2.13.m13.1.1" xref="S4.SS3.p2.13.m13.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m13.1b"><ci id="S4.SS3.p2.13.m13.1.1.cmml" xref="S4.SS3.p2.13.m13.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m13.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.13.m13.1d">italic_A</annotation></semantics></math> can probe any IPID resource for its current IPID value except a per-connection counter, as no known exploits have demonstrated that this is possible for an off-path adversary.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.4">We allow <math alttext="A" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_A</annotation></semantics></math> a budget of <math alttext="g\geq 1" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mrow id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">g</mi><mo id="S4.SS3.p3.2.m2.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.cmml">≥</mo><mn id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><geq id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1"></geq><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑔</ci><cn id="S4.SS3.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">g\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_g ≥ 1</annotation></semantics></math> guesses and assume <math alttext="A" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><mi id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_A</annotation></semantics></math> always guesses the <math alttext="g" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">italic_g</annotation></semantics></math> maximum-likelihood IPIDs given the information available to it.
Thus, the probability of a successful adversarial guess is</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\mathrm{Pr}\left[\text{next IPID}\in G\right]=\max_{G\subset[2^{16}]~{}:~{}|G|%
=g}\left\{\sum_{x\in G}\mathrm{Pr}\left[\text{next IPID}=x\right]\right\}," class="ltx_Math" display="block" id="S4.E2.m1.6"><semantics id="S4.E2.m1.6a"><mrow id="S4.E2.m1.6.6.1" xref="S4.E2.m1.6.6.1.1.cmml"><mrow id="S4.E2.m1.6.6.1.1" xref="S4.E2.m1.6.6.1.1.cmml"><mrow id="S4.E2.m1.6.6.1.1.5" xref="S4.E2.m1.6.6.1.1.5.cmml"><mi id="S4.E2.m1.6.6.1.1.5.2" xref="S4.E2.m1.6.6.1.1.5.2.cmml">Pr</mi><mo id="S4.E2.m1.6.6.1.1.5.1" xref="S4.E2.m1.6.6.1.1.5.1.cmml">⁢</mo><mrow id="S4.E2.m1.6.6.1.1.5.3.2" xref="S4.E2.m1.6.6.1.1.5.3.1.cmml"><mo id="S4.E2.m1.6.6.1.1.5.3.2.1" xref="S4.E2.m1.6.6.1.1.5.3.1.1.cmml">[</mo><mtext id="S4.E2.m1.5.5" xref="S4.E2.m1.5.5a.cmml">adv. guess</mtext><mo id="S4.E2.m1.6.6.1.1.5.3.2.2" xref="S4.E2.m1.6.6.1.1.5.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E2.m1.6.6.1.1.6" xref="S4.E2.m1.6.6.1.1.6.cmml">=</mo><mrow id="S4.E2.m1.6.6.1.1.1" xref="S4.E2.m1.6.6.1.1.1.cmml"><mrow id="S4.E2.m1.6.6.1.1.1.3" xref="S4.E2.m1.6.6.1.1.1.3.cmml"><munder id="S4.E2.m1.6.6.1.1.1.3.1" xref="S4.E2.m1.6.6.1.1.1.3.1.cmml"><mi id="S4.E2.m1.6.6.1.1.1.3.1.2" xref="S4.E2.m1.6.6.1.1.1.3.1.2.cmml">max</mi><mrow id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><mrow id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml"><mi id="S4.E2.m1.2.2.2.2.3" xref="S4.E2.m1.2.2.2.2.3.cmml">G</mi><mo id="S4.E2.m1.2.2.2.2.2" xref="S4.E2.m1.2.2.2.2.2.cmml">⊂</mo><mrow id="S4.E2.m1.2.2.2.2.1.1" xref="S4.E2.m1.2.2.2.2.1.2.cmml"><mo id="S4.E2.m1.2.2.2.2.1.1.2" stretchy="false" xref="S4.E2.m1.2.2.2.2.1.2.1.cmml">[</mo><msup id="S4.E2.m1.2.2.2.2.1.1.1" xref="S4.E2.m1.2.2.2.2.1.1.1.cmml"><mn id="S4.E2.m1.2.2.2.2.1.1.1.2" xref="S4.E2.m1.2.2.2.2.1.1.1.2.cmml">2</mn><mn id="S4.E2.m1.2.2.2.2.1.1.1.3" xref="S4.E2.m1.2.2.2.2.1.1.1.3.cmml">16</mn></msup><mo id="S4.E2.m1.2.2.2.2.1.1.3" rspace="0.508em" stretchy="false" xref="S4.E2.m1.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E2.m1.2.2.2.3" rspace="0.508em" xref="S4.E2.m1.2.2.2.3.cmml">:</mo><mrow id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.4.cmml"><mrow id="S4.E2.m1.2.2.2.4.2.2" xref="S4.E2.m1.2.2.2.4.2.1.cmml"><mo id="S4.E2.m1.2.2.2.4.2.2.1" stretchy="false" xref="S4.E2.m1.2.2.2.4.2.1.1.cmml">|</mo><mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">G</mi><mo id="S4.E2.m1.2.2.2.4.2.2.2" stretchy="false" xref="S4.E2.m1.2.2.2.4.2.1.1.cmml">|</mo></mrow><mo id="S4.E2.m1.2.2.2.4.1" xref="S4.E2.m1.2.2.2.4.1.cmml">=</mo><mi id="S4.E2.m1.2.2.2.4.3" xref="S4.E2.m1.2.2.2.4.3.cmml">g</mi></mrow></mrow></munder><mo id="S4.E2.m1.6.6.1.1.1.3a" lspace="0.167em" xref="S4.E2.m1.6.6.1.1.1.3.cmml">⁡</mo><mi id="S4.E2.m1.6.6.1.1.1.3.2" xref="S4.E2.m1.6.6.1.1.1.3.2.cmml">Pr</mi></mrow><mo id="S4.E2.m1.6.6.1.1.1.2" xref="S4.E2.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.6.6.1.1.1.1.1" xref="S4.E2.m1.6.6.1.1.1.1.2.cmml"><mo id="S4.E2.m1.6.6.1.1.1.1.1.2" xref="S4.E2.m1.6.6.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E2.m1.6.6.1.1.1.1.1.1" xref="S4.E2.m1.6.6.1.1.1.1.1.1.cmml"><mtext id="S4.E2.m1.6.6.1.1.1.1.1.1.2" xref="S4.E2.m1.6.6.1.1.1.1.1.1.2a.cmml">next IPID</mtext><mo id="S4.E2.m1.6.6.1.1.1.1.1.1.1" xref="S4.E2.m1.6.6.1.1.1.1.1.1.1.cmml">∈</mo><mi id="S4.E2.m1.6.6.1.1.1.1.1.1.3" xref="S4.E2.m1.6.6.1.1.1.1.1.1.3.cmml">G</mi></mrow><mo id="S4.E2.m1.6.6.1.1.1.1.1.3" xref="S4.E2.m1.6.6.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E2.m1.6.6.1.1.7" xref="S4.E2.m1.6.6.1.1.7.cmml">=</mo><mrow id="S4.E2.m1.6.6.1.1.3.2" xref="S4.E2.m1.6.6.1.1.3.3.cmml"><munder id="S4.E2.m1.6.6.1.1.2.1.1" xref="S4.E2.m1.6.6.1.1.2.1.1.cmml"><mi id="S4.E2.m1.6.6.1.1.2.1.1.2" xref="S4.E2.m1.6.6.1.1.2.1.1.2.cmml">max</mi><mrow id="S4.E2.m1.4.4.2" xref="S4.E2.m1.4.4.2.cmml"><mrow id="S4.E2.m1.4.4.2.2" xref="S4.E2.m1.4.4.2.2.cmml"><mi id="S4.E2.m1.4.4.2.2.3" xref="S4.E2.m1.4.4.2.2.3.cmml">G</mi><mo id="S4.E2.m1.4.4.2.2.2" xref="S4.E2.m1.4.4.2.2.2.cmml">⊂</mo><mrow id="S4.E2.m1.4.4.2.2.1.1" xref="S4.E2.m1.4.4.2.2.1.2.cmml"><mo id="S4.E2.m1.4.4.2.2.1.1.2" stretchy="false" xref="S4.E2.m1.4.4.2.2.1.2.1.cmml">[</mo><msup id="S4.E2.m1.4.4.2.2.1.1.1" xref="S4.E2.m1.4.4.2.2.1.1.1.cmml"><mn id="S4.E2.m1.4.4.2.2.1.1.1.2" xref="S4.E2.m1.4.4.2.2.1.1.1.2.cmml">2</mn><mn id="S4.E2.m1.4.4.2.2.1.1.1.3" xref="S4.E2.m1.4.4.2.2.1.1.1.3.cmml">16</mn></msup><mo id="S4.E2.m1.4.4.2.2.1.1.3" rspace="0.508em" stretchy="false" xref="S4.E2.m1.4.4.2.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E2.m1.4.4.2.3" rspace="0.508em" xref="S4.E2.m1.4.4.2.3.cmml">:</mo><mrow id="S4.E2.m1.4.4.2.4" xref="S4.E2.m1.4.4.2.4.cmml"><mrow id="S4.E2.m1.4.4.2.4.2.2" xref="S4.E2.m1.4.4.2.4.2.1.cmml"><mo id="S4.E2.m1.4.4.2.4.2.2.1" stretchy="false" xref="S4.E2.m1.4.4.2.4.2.1.1.cmml">|</mo><mi id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml">G</mi><mo id="S4.E2.m1.4.4.2.4.2.2.2" stretchy="false" xref="S4.E2.m1.4.4.2.4.2.1.1.cmml">|</mo></mrow><mo id="S4.E2.m1.4.4.2.4.1" xref="S4.E2.m1.4.4.2.4.1.cmml">=</mo><mi id="S4.E2.m1.4.4.2.4.3" xref="S4.E2.m1.4.4.2.4.3.cmml">g</mi></mrow></mrow></munder><mo id="S4.E2.m1.6.6.1.1.3.2a" xref="S4.E2.m1.6.6.1.1.3.3.cmml">⁡</mo><mrow id="S4.E2.m1.6.6.1.1.3.2.2" xref="S4.E2.m1.6.6.1.1.3.3.cmml"><mo id="S4.E2.m1.6.6.1.1.3.2.2.2" xref="S4.E2.m1.6.6.1.1.3.3.cmml">{</mo><mrow id="S4.E2.m1.6.6.1.1.3.2.2.1" xref="S4.E2.m1.6.6.1.1.3.2.2.1.cmml"><munder id="S4.E2.m1.6.6.1.1.3.2.2.1.2" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.cmml"><mo id="S4.E2.m1.6.6.1.1.3.2.2.1.2.2" lspace="0em" movablelimits="false" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.2.cmml">∑</mo><mrow id="S4.E2.m1.6.6.1.1.3.2.2.1.2.3" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.cmml"><mi id="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.2" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.2.cmml">x</mi><mo id="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.1" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.1.cmml">∈</mo><mi id="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.3" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.3.cmml">G</mi></mrow></munder><mrow id="S4.E2.m1.6.6.1.1.3.2.2.1.1" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.cmml"><mi id="S4.E2.m1.6.6.1.1.3.2.2.1.1.3" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.3.cmml">Pr</mi><mo id="S4.E2.m1.6.6.1.1.3.2.2.1.1.2" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.2.cmml"><mo id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.2" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.2.1.cmml">[</mo><mrow id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.cmml"><mtext id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.2" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.2a.cmml">next IPID</mtext><mo id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.1" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.1.cmml">=</mo><mi id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.3" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.3" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E2.m1.6.6.1.1.3.2.2.3" xref="S4.E2.m1.6.6.1.1.3.3.cmml">}</mo></mrow></mrow></mrow><mo id="S4.E2.m1.6.6.1.2" xref="S4.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.6b"><apply id="S4.E2.m1.6.6.1.1.cmml" xref="S4.E2.m1.6.6.1"><and id="S4.E2.m1.6.6.1.1a.cmml" xref="S4.E2.m1.6.6.1"></and><apply id="S4.E2.m1.6.6.1.1b.cmml" xref="S4.E2.m1.6.6.1"><eq id="S4.E2.m1.6.6.1.1.6.cmml" xref="S4.E2.m1.6.6.1.1.6"></eq><apply id="S4.E2.m1.6.6.1.1.5.cmml" xref="S4.E2.m1.6.6.1.1.5"><times id="S4.E2.m1.6.6.1.1.5.1.cmml" xref="S4.E2.m1.6.6.1.1.5.1"></times><ci id="S4.E2.m1.6.6.1.1.5.2.cmml" xref="S4.E2.m1.6.6.1.1.5.2">Pr</ci><apply id="S4.E2.m1.6.6.1.1.5.3.1.cmml" xref="S4.E2.m1.6.6.1.1.5.3.2"><csymbol cd="latexml" id="S4.E2.m1.6.6.1.1.5.3.1.1.cmml" xref="S4.E2.m1.6.6.1.1.5.3.2.1">delimited-[]</csymbol><ci id="S4.E2.m1.5.5a.cmml" xref="S4.E2.m1.5.5"><mtext id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">adv. guess</mtext></ci></apply></apply><apply id="S4.E2.m1.6.6.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1"><times id="S4.E2.m1.6.6.1.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.1.2"></times><apply id="S4.E2.m1.6.6.1.1.1.3.cmml" xref="S4.E2.m1.6.6.1.1.1.3"><apply id="S4.E2.m1.6.6.1.1.1.3.1.cmml" xref="S4.E2.m1.6.6.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.1.3.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1.3.1">subscript</csymbol><max id="S4.E2.m1.6.6.1.1.1.3.1.2.cmml" xref="S4.E2.m1.6.6.1.1.1.3.1.2"></max><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><ci id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3">:</ci><apply id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2"><subset id="S4.E2.m1.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2.2"></subset><ci id="S4.E2.m1.2.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.2.3">𝐺</ci><apply id="S4.E2.m1.2.2.2.2.1.2.cmml" xref="S4.E2.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.E2.m1.2.2.2.2.1.2.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.E2.m1.2.2.2.2.1.1.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E2.m1.2.2.2.2.1.1.1">superscript</csymbol><cn id="S4.E2.m1.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S4.E2.m1.2.2.2.2.1.1.1.2">2</cn><cn id="S4.E2.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.E2.m1.2.2.2.2.1.1.1.3">16</cn></apply></apply></apply><apply id="S4.E2.m1.2.2.2.4.cmml" xref="S4.E2.m1.2.2.2.4"><eq id="S4.E2.m1.2.2.2.4.1.cmml" xref="S4.E2.m1.2.2.2.4.1"></eq><apply id="S4.E2.m1.2.2.2.4.2.1.cmml" xref="S4.E2.m1.2.2.2.4.2.2"><abs id="S4.E2.m1.2.2.2.4.2.1.1.cmml" xref="S4.E2.m1.2.2.2.4.2.2.1"></abs><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝐺</ci></apply><ci id="S4.E2.m1.2.2.2.4.3.cmml" xref="S4.E2.m1.2.2.2.4.3">𝑔</ci></apply></apply></apply><ci id="S4.E2.m1.6.6.1.1.1.3.2.cmml" xref="S4.E2.m1.6.6.1.1.1.3.2">Pr</ci></apply><apply id="S4.E2.m1.6.6.1.1.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.6.6.1.1.1.1.2.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E2.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1.1"><in id="S4.E2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1.1.1"></in><ci id="S4.E2.m1.6.6.1.1.1.1.1.1.2a.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1.1.2"><mtext id="S4.E2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1.1.2">next IPID</mtext></ci><ci id="S4.E2.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.6.6.1.1.1.1.1.1.3">𝐺</ci></apply></apply></apply></apply><apply id="S4.E2.m1.6.6.1.1c.cmml" xref="S4.E2.m1.6.6.1"><eq id="S4.E2.m1.6.6.1.1.7.cmml" xref="S4.E2.m1.6.6.1.1.7"></eq><share href="https://arxiv.org/html/2406.06483v2#S4.E2.m1.6.6.1.1.1.cmml" id="S4.E2.m1.6.6.1.1d.cmml" xref="S4.E2.m1.6.6.1"></share><apply id="S4.E2.m1.6.6.1.1.3.3.cmml" xref="S4.E2.m1.6.6.1.1.3.2"><apply id="S4.E2.m1.6.6.1.1.2.1.1.cmml" xref="S4.E2.m1.6.6.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.2.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.2.1.1">subscript</csymbol><max id="S4.E2.m1.6.6.1.1.2.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.2.1.1.2"></max><apply id="S4.E2.m1.4.4.2.cmml" xref="S4.E2.m1.4.4.2"><ci id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2.3">:</ci><apply id="S4.E2.m1.4.4.2.2.cmml" xref="S4.E2.m1.4.4.2.2"><subset id="S4.E2.m1.4.4.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2"></subset><ci id="S4.E2.m1.4.4.2.2.3.cmml" xref="S4.E2.m1.4.4.2.2.3">𝐺</ci><apply id="S4.E2.m1.4.4.2.2.1.2.cmml" xref="S4.E2.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="S4.E2.m1.4.4.2.2.1.2.1.cmml" xref="S4.E2.m1.4.4.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.E2.m1.4.4.2.2.1.1.1.cmml" xref="S4.E2.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E2.m1.4.4.2.2.1.1.1">superscript</csymbol><cn id="S4.E2.m1.4.4.2.2.1.1.1.2.cmml" type="integer" xref="S4.E2.m1.4.4.2.2.1.1.1.2">2</cn><cn id="S4.E2.m1.4.4.2.2.1.1.1.3.cmml" type="integer" xref="S4.E2.m1.4.4.2.2.1.1.1.3">16</cn></apply></apply></apply><apply id="S4.E2.m1.4.4.2.4.cmml" xref="S4.E2.m1.4.4.2.4"><eq id="S4.E2.m1.4.4.2.4.1.cmml" xref="S4.E2.m1.4.4.2.4.1"></eq><apply id="S4.E2.m1.4.4.2.4.2.1.cmml" xref="S4.E2.m1.4.4.2.4.2.2"><abs id="S4.E2.m1.4.4.2.4.2.1.1.cmml" xref="S4.E2.m1.4.4.2.4.2.2.1"></abs><ci id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1">𝐺</ci></apply><ci id="S4.E2.m1.4.4.2.4.3.cmml" xref="S4.E2.m1.4.4.2.4.3">𝑔</ci></apply></apply></apply><apply id="S4.E2.m1.6.6.1.1.3.2.2.1.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1"><apply id="S4.E2.m1.6.6.1.1.3.2.2.1.2.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.3.2.2.1.2.1.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2">subscript</csymbol><sum id="S4.E2.m1.6.6.1.1.3.2.2.1.2.2.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.2"></sum><apply id="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.3"><in id="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.1.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.1"></in><ci id="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.2.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.2">𝑥</ci><ci id="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.3.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.2.3.3">𝐺</ci></apply></apply><apply id="S4.E2.m1.6.6.1.1.3.2.2.1.1.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1"><times id="S4.E2.m1.6.6.1.1.3.2.2.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.2"></times><ci id="S4.E2.m1.6.6.1.1.3.2.2.1.1.3.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.3">Pr</ci><apply id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.2.1.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1"><eq id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.1"></eq><ci id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.2a.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.2"><mtext id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.2">next IPID</mtext></ci><ci id="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.3.cmml" xref="S4.E2.m1.6.6.1.1.3.2.2.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.6c">\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\mathrm{Pr}\left[\text{next IPID}\in G\right]=\max_{G\subset[2^{16}]~{}:~{}|G|%
=g}\left\{\sum_{x\in G}\mathrm{Pr}\left[\text{next IPID}=x\right]\right\},</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.6d">roman_Pr [ adv. guess ] = roman_max start_POSTSUBSCRIPT italic_G ⊂ [ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] : | italic_G | = italic_g end_POSTSUBSCRIPT roman_Pr [ next IPID ∈ italic_G ] = roman_max start_POSTSUBSCRIPT italic_G ⊂ [ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] : | italic_G | = italic_g end_POSTSUBSCRIPT { ∑ start_POSTSUBSCRIPT italic_x ∈ italic_G end_POSTSUBSCRIPT roman_Pr [ next IPID = italic_x ] } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p3.10">where <math alttext="[2^{16}]=\{0,\ldots,2^{16}-1\}" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m1.4"><semantics id="S4.SS3.p3.5.m1.4a"><mrow id="S4.SS3.p3.5.m1.4.4" xref="S4.SS3.p3.5.m1.4.4.cmml"><mrow id="S4.SS3.p3.5.m1.3.3.1.1" xref="S4.SS3.p3.5.m1.3.3.1.2.cmml"><mo id="S4.SS3.p3.5.m1.3.3.1.1.2" stretchy="false" xref="S4.SS3.p3.5.m1.3.3.1.2.1.cmml">[</mo><msup id="S4.SS3.p3.5.m1.3.3.1.1.1" xref="S4.SS3.p3.5.m1.3.3.1.1.1.cmml"><mn id="S4.SS3.p3.5.m1.3.3.1.1.1.2" xref="S4.SS3.p3.5.m1.3.3.1.1.1.2.cmml">2</mn><mn id="S4.SS3.p3.5.m1.3.3.1.1.1.3" xref="S4.SS3.p3.5.m1.3.3.1.1.1.3.cmml">16</mn></msup><mo id="S4.SS3.p3.5.m1.3.3.1.1.3" stretchy="false" xref="S4.SS3.p3.5.m1.3.3.1.2.1.cmml">]</mo></mrow><mo id="S4.SS3.p3.5.m1.4.4.3" xref="S4.SS3.p3.5.m1.4.4.3.cmml">=</mo><mrow id="S4.SS3.p3.5.m1.4.4.2.1" xref="S4.SS3.p3.5.m1.4.4.2.2.cmml"><mo id="S4.SS3.p3.5.m1.4.4.2.1.2" stretchy="false" xref="S4.SS3.p3.5.m1.4.4.2.2.cmml">{</mo><mn id="S4.SS3.p3.5.m1.1.1" xref="S4.SS3.p3.5.m1.1.1.cmml">0</mn><mo id="S4.SS3.p3.5.m1.4.4.2.1.3" xref="S4.SS3.p3.5.m1.4.4.2.2.cmml">,</mo><mi id="S4.SS3.p3.5.m1.2.2" mathvariant="normal" xref="S4.SS3.p3.5.m1.2.2.cmml">…</mi><mo id="S4.SS3.p3.5.m1.4.4.2.1.4" xref="S4.SS3.p3.5.m1.4.4.2.2.cmml">,</mo><mrow id="S4.SS3.p3.5.m1.4.4.2.1.1" xref="S4.SS3.p3.5.m1.4.4.2.1.1.cmml"><msup id="S4.SS3.p3.5.m1.4.4.2.1.1.2" xref="S4.SS3.p3.5.m1.4.4.2.1.1.2.cmml"><mn id="S4.SS3.p3.5.m1.4.4.2.1.1.2.2" xref="S4.SS3.p3.5.m1.4.4.2.1.1.2.2.cmml">2</mn><mn id="S4.SS3.p3.5.m1.4.4.2.1.1.2.3" xref="S4.SS3.p3.5.m1.4.4.2.1.1.2.3.cmml">16</mn></msup><mo id="S4.SS3.p3.5.m1.4.4.2.1.1.1" xref="S4.SS3.p3.5.m1.4.4.2.1.1.1.cmml">−</mo><mn id="S4.SS3.p3.5.m1.4.4.2.1.1.3" xref="S4.SS3.p3.5.m1.4.4.2.1.1.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.5.m1.4.4.2.1.5" stretchy="false" xref="S4.SS3.p3.5.m1.4.4.2.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m1.4b"><apply id="S4.SS3.p3.5.m1.4.4.cmml" xref="S4.SS3.p3.5.m1.4.4"><eq id="S4.SS3.p3.5.m1.4.4.3.cmml" xref="S4.SS3.p3.5.m1.4.4.3"></eq><apply id="S4.SS3.p3.5.m1.3.3.1.2.cmml" xref="S4.SS3.p3.5.m1.3.3.1.1"><csymbol cd="latexml" id="S4.SS3.p3.5.m1.3.3.1.2.1.cmml" xref="S4.SS3.p3.5.m1.3.3.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p3.5.m1.3.3.1.1.1.cmml" xref="S4.SS3.p3.5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m1.3.3.1.1.1.1.cmml" xref="S4.SS3.p3.5.m1.3.3.1.1.1">superscript</csymbol><cn id="S4.SS3.p3.5.m1.3.3.1.1.1.2.cmml" type="integer" xref="S4.SS3.p3.5.m1.3.3.1.1.1.2">2</cn><cn id="S4.SS3.p3.5.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.SS3.p3.5.m1.3.3.1.1.1.3">16</cn></apply></apply><set id="S4.SS3.p3.5.m1.4.4.2.2.cmml" xref="S4.SS3.p3.5.m1.4.4.2.1"><cn id="S4.SS3.p3.5.m1.1.1.cmml" type="integer" xref="S4.SS3.p3.5.m1.1.1">0</cn><ci id="S4.SS3.p3.5.m1.2.2.cmml" xref="S4.SS3.p3.5.m1.2.2">…</ci><apply id="S4.SS3.p3.5.m1.4.4.2.1.1.cmml" xref="S4.SS3.p3.5.m1.4.4.2.1.1"><minus id="S4.SS3.p3.5.m1.4.4.2.1.1.1.cmml" xref="S4.SS3.p3.5.m1.4.4.2.1.1.1"></minus><apply id="S4.SS3.p3.5.m1.4.4.2.1.1.2.cmml" xref="S4.SS3.p3.5.m1.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m1.4.4.2.1.1.2.1.cmml" xref="S4.SS3.p3.5.m1.4.4.2.1.1.2">superscript</csymbol><cn id="S4.SS3.p3.5.m1.4.4.2.1.1.2.2.cmml" type="integer" xref="S4.SS3.p3.5.m1.4.4.2.1.1.2.2">2</cn><cn id="S4.SS3.p3.5.m1.4.4.2.1.1.2.3.cmml" type="integer" xref="S4.SS3.p3.5.m1.4.4.2.1.1.2.3">16</cn></apply><cn id="S4.SS3.p3.5.m1.4.4.2.1.1.3.cmml" type="integer" xref="S4.SS3.p3.5.m1.4.4.2.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m1.4c">[2^{16}]=\{0,\ldots,2^{16}-1\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m1.4d">[ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] = { 0 , … , 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - 1 }</annotation></semantics></math> denotes the set of all possible IPIDs, <math alttext="G" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m2.1"><semantics id="S4.SS3.p3.6.m2.1a"><mi id="S4.SS3.p3.6.m2.1.1" xref="S4.SS3.p3.6.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m2.1b"><ci id="S4.SS3.p3.6.m2.1.1.cmml" xref="S4.SS3.p3.6.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m2.1d">italic_G</annotation></semantics></math> is a set of <math alttext="g" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m3.1"><semantics id="S4.SS3.p3.7.m3.1a"><mi id="S4.SS3.p3.7.m3.1.1" xref="S4.SS3.p3.7.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m3.1b"><ci id="S4.SS3.p3.7.m3.1.1.cmml" xref="S4.SS3.p3.7.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m3.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m3.1d">italic_g</annotation></semantics></math> distinct IPIDs, and <math alttext="\mathrm{Pr}\left[\text{next IPID}=x\right]" class="ltx_Math" display="inline" id="S4.SS3.p3.8.m4.1"><semantics id="S4.SS3.p3.8.m4.1a"><mrow id="S4.SS3.p3.8.m4.1.1" xref="S4.SS3.p3.8.m4.1.1.cmml"><mi id="S4.SS3.p3.8.m4.1.1.3" xref="S4.SS3.p3.8.m4.1.1.3.cmml">Pr</mi><mo id="S4.SS3.p3.8.m4.1.1.2" xref="S4.SS3.p3.8.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p3.8.m4.1.1.1.1" xref="S4.SS3.p3.8.m4.1.1.1.2.cmml"><mo id="S4.SS3.p3.8.m4.1.1.1.1.2" xref="S4.SS3.p3.8.m4.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p3.8.m4.1.1.1.1.1" xref="S4.SS3.p3.8.m4.1.1.1.1.1.cmml"><mtext id="S4.SS3.p3.8.m4.1.1.1.1.1.2" xref="S4.SS3.p3.8.m4.1.1.1.1.1.2a.cmml">next IPID</mtext><mo id="S4.SS3.p3.8.m4.1.1.1.1.1.1" xref="S4.SS3.p3.8.m4.1.1.1.1.1.1.cmml">=</mo><mi id="S4.SS3.p3.8.m4.1.1.1.1.1.3" xref="S4.SS3.p3.8.m4.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.SS3.p3.8.m4.1.1.1.1.3" xref="S4.SS3.p3.8.m4.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m4.1b"><apply id="S4.SS3.p3.8.m4.1.1.cmml" xref="S4.SS3.p3.8.m4.1.1"><times id="S4.SS3.p3.8.m4.1.1.2.cmml" xref="S4.SS3.p3.8.m4.1.1.2"></times><ci id="S4.SS3.p3.8.m4.1.1.3.cmml" xref="S4.SS3.p3.8.m4.1.1.3">Pr</ci><apply id="S4.SS3.p3.8.m4.1.1.1.2.cmml" xref="S4.SS3.p3.8.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p3.8.m4.1.1.1.2.1.cmml" xref="S4.SS3.p3.8.m4.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p3.8.m4.1.1.1.1.1.cmml" xref="S4.SS3.p3.8.m4.1.1.1.1.1"><eq id="S4.SS3.p3.8.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.8.m4.1.1.1.1.1.1"></eq><ci id="S4.SS3.p3.8.m4.1.1.1.1.1.2a.cmml" xref="S4.SS3.p3.8.m4.1.1.1.1.1.2"><mtext id="S4.SS3.p3.8.m4.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.8.m4.1.1.1.1.1.2">next IPID</mtext></ci><ci id="S4.SS3.p3.8.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.8.m4.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m4.1c">\mathrm{Pr}\left[\text{next IPID}=x\right]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.8.m4.1d">roman_Pr [ next IPID = italic_x ]</annotation></semantics></math> is the probability that <math alttext="x" class="ltx_Math" display="inline" id="S4.SS3.p3.9.m5.1"><semantics id="S4.SS3.p3.9.m5.1a"><mi id="S4.SS3.p3.9.m5.1.1" xref="S4.SS3.p3.9.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m5.1b"><ci id="S4.SS3.p3.9.m5.1.1.cmml" xref="S4.SS3.p3.9.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.9.m5.1d">italic_x</annotation></semantics></math> is the next IPID generated by resource <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.p3.10.m6.1"><semantics id="S4.SS3.p3.10.m6.1a"><mi id="S4.SS3.p3.10.m6.1.1" xref="S4.SS3.p3.10.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m6.1b"><ci id="S4.SS3.p3.10.m6.1.1.cmml" xref="S4.SS3.p3.10.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.10.m6.1d">italic_i</annotation></semantics></math> (which varies among IPID selection methods).</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="346" id="S4.F7.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F7.23.11.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text ltx_font_italic" id="S4.F7.20.10" style="font-size:90%;">Comparison of IPID Selection Methods’ Security.<span class="ltx_text ltx_font_upright" id="S4.F7.20.10.10">
Adversarial guess probabilities with <math alttext="g=1" class="ltx_Math" display="inline" id="S4.F7.11.1.1.m1.1"><semantics id="S4.F7.11.1.1.m1.1b"><mrow id="S4.F7.11.1.1.m1.1.1" xref="S4.F7.11.1.1.m1.1.1.cmml"><mi id="S4.F7.11.1.1.m1.1.1.2" xref="S4.F7.11.1.1.m1.1.1.2.cmml">g</mi><mo id="S4.F7.11.1.1.m1.1.1.1" xref="S4.F7.11.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.F7.11.1.1.m1.1.1.3" xref="S4.F7.11.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F7.11.1.1.m1.1c"><apply id="S4.F7.11.1.1.m1.1.1.cmml" xref="S4.F7.11.1.1.m1.1.1"><eq id="S4.F7.11.1.1.m1.1.1.1.cmml" xref="S4.F7.11.1.1.m1.1.1.1"></eq><ci id="S4.F7.11.1.1.m1.1.1.2.cmml" xref="S4.F7.11.1.1.m1.1.1.2">𝑔</ci><cn id="S4.F7.11.1.1.m1.1.1.3.cmml" type="integer" xref="S4.F7.11.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.11.1.1.m1.1d">g=1</annotation><annotation encoding="application/x-llamapun" id="S4.F7.11.1.1.m1.1e">italic_g = 1</annotation></semantics></math> guess for globally incrementing (dark blue, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E14" title="In A.2.1. Globally Incrementing ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">14</span></a>), per-connection (olive, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E15" title="In A.2.2. Per-Connection ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">15</span></a>), per-destination (pink, also Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E14" title="In A.2.1. Globally Incrementing ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">14</span></a>), per-bucket (teal, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E17" title="In A.2.4. Per-Bucket (Linux) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">17</span></a> with simulation), and PRNG-based (orange, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E19" title="In A.2.5. PRNG (searchable queue of size 𝑘) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">19</span></a>) IPID selection as a function of <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.F7.12.2.2.m2.1"><semantics id="S4.F7.12.2.2.m2.1b"><mi id="S4.F7.12.2.2.m2.1.1" xref="S4.F7.12.2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.F7.12.2.2.m2.1c"><ci id="S4.F7.12.2.2.m2.1.1.cmml" xref="S4.F7.12.2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.12.2.2.m2.1d">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.F7.12.2.2.m2.1e">italic_λ</annotation></semantics></math>, the Poisson rate of packet transmission.
For selection methods that use <math alttext="r\geq 1" class="ltx_Math" display="inline" id="S4.F7.13.3.3.m3.1"><semantics id="S4.F7.13.3.3.m3.1b"><mrow id="S4.F7.13.3.3.m3.1.1" xref="S4.F7.13.3.3.m3.1.1.cmml"><mi id="S4.F7.13.3.3.m3.1.1.2" xref="S4.F7.13.3.3.m3.1.1.2.cmml">r</mi><mo id="S4.F7.13.3.3.m3.1.1.1" xref="S4.F7.13.3.3.m3.1.1.1.cmml">≥</mo><mn id="S4.F7.13.3.3.m3.1.1.3" xref="S4.F7.13.3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F7.13.3.3.m3.1c"><apply id="S4.F7.13.3.3.m3.1.1.cmml" xref="S4.F7.13.3.3.m3.1.1"><geq id="S4.F7.13.3.3.m3.1.1.1.cmml" xref="S4.F7.13.3.3.m3.1.1.1"></geq><ci id="S4.F7.13.3.3.m3.1.1.2.cmml" xref="S4.F7.13.3.3.m3.1.1.2">𝑟</ci><cn id="S4.F7.13.3.3.m3.1.1.3.cmml" type="integer" xref="S4.F7.13.3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.13.3.3.m3.1d">r\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.F7.13.3.3.m3.1e">italic_r ≥ 1</annotation></semantics></math> counters, we compare the case where traffic is uniformly distributed to each counter <math alttext="i" class="ltx_Math" display="inline" id="S4.F7.14.4.4.m4.1"><semantics id="S4.F7.14.4.4.m4.1b"><mi id="S4.F7.14.4.4.m4.1.1" xref="S4.F7.14.4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.F7.14.4.4.m4.1c"><ci id="S4.F7.14.4.4.m4.1.1.cmml" xref="S4.F7.14.4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.14.4.4.m4.1d">i</annotation><annotation encoding="application/x-llamapun" id="S4.F7.14.4.4.m4.1e">italic_i</annotation></semantics></math> with rate <math alttext="\lambda_{i}=\lambda/r" class="ltx_Math" display="inline" id="S4.F7.15.5.5.m5.1"><semantics id="S4.F7.15.5.5.m5.1b"><mrow id="S4.F7.15.5.5.m5.1.1" xref="S4.F7.15.5.5.m5.1.1.cmml"><msub id="S4.F7.15.5.5.m5.1.1.2" xref="S4.F7.15.5.5.m5.1.1.2.cmml"><mi id="S4.F7.15.5.5.m5.1.1.2.2" xref="S4.F7.15.5.5.m5.1.1.2.2.cmml">λ</mi><mi id="S4.F7.15.5.5.m5.1.1.2.3" xref="S4.F7.15.5.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S4.F7.15.5.5.m5.1.1.1" xref="S4.F7.15.5.5.m5.1.1.1.cmml">=</mo><mrow id="S4.F7.15.5.5.m5.1.1.3" xref="S4.F7.15.5.5.m5.1.1.3.cmml"><mi id="S4.F7.15.5.5.m5.1.1.3.2" xref="S4.F7.15.5.5.m5.1.1.3.2.cmml">λ</mi><mo id="S4.F7.15.5.5.m5.1.1.3.1" xref="S4.F7.15.5.5.m5.1.1.3.1.cmml">/</mo><mi id="S4.F7.15.5.5.m5.1.1.3.3" xref="S4.F7.15.5.5.m5.1.1.3.3.cmml">r</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F7.15.5.5.m5.1c"><apply id="S4.F7.15.5.5.m5.1.1.cmml" xref="S4.F7.15.5.5.m5.1.1"><eq id="S4.F7.15.5.5.m5.1.1.1.cmml" xref="S4.F7.15.5.5.m5.1.1.1"></eq><apply id="S4.F7.15.5.5.m5.1.1.2.cmml" xref="S4.F7.15.5.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.F7.15.5.5.m5.1.1.2.1.cmml" xref="S4.F7.15.5.5.m5.1.1.2">subscript</csymbol><ci id="S4.F7.15.5.5.m5.1.1.2.2.cmml" xref="S4.F7.15.5.5.m5.1.1.2.2">𝜆</ci><ci id="S4.F7.15.5.5.m5.1.1.2.3.cmml" xref="S4.F7.15.5.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S4.F7.15.5.5.m5.1.1.3.cmml" xref="S4.F7.15.5.5.m5.1.1.3"><divide id="S4.F7.15.5.5.m5.1.1.3.1.cmml" xref="S4.F7.15.5.5.m5.1.1.3.1"></divide><ci id="S4.F7.15.5.5.m5.1.1.3.2.cmml" xref="S4.F7.15.5.5.m5.1.1.3.2">𝜆</ci><ci id="S4.F7.15.5.5.m5.1.1.3.3.cmml" xref="S4.F7.15.5.5.m5.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.15.5.5.m5.1d">\lambda_{i}=\lambda/r</annotation><annotation encoding="application/x-llamapun" id="S4.F7.15.5.5.m5.1e">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_λ / italic_r</annotation></semantics></math> (left) and the worst-case scenario when traffic is allocated to <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="S4.F7.16.6.6.m6.1"><semantics id="S4.F7.16.6.6.m6.1b"><msub id="S4.F7.16.6.6.m6.1.1" xref="S4.F7.16.6.6.m6.1.1.cmml"><mi id="S4.F7.16.6.6.m6.1.1.2" xref="S4.F7.16.6.6.m6.1.1.2.cmml">λ</mi><mi id="S4.F7.16.6.6.m6.1.1.3" xref="S4.F7.16.6.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F7.16.6.6.m6.1c"><apply id="S4.F7.16.6.6.m6.1.1.cmml" xref="S4.F7.16.6.6.m6.1.1"><csymbol cd="ambiguous" id="S4.F7.16.6.6.m6.1.1.1.cmml" xref="S4.F7.16.6.6.m6.1.1">subscript</csymbol><ci id="S4.F7.16.6.6.m6.1.1.2.cmml" xref="S4.F7.16.6.6.m6.1.1.2">𝜆</ci><ci id="S4.F7.16.6.6.m6.1.1.3.cmml" xref="S4.F7.16.6.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.16.6.6.m6.1d">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.F7.16.6.6.m6.1e">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> such that the adversarial guess probability is maximized (right).
The total number of distinct IPIDs, <math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.F7.17.7.7.m7.1"><semantics id="S4.F7.17.7.7.m7.1b"><msup id="S4.F7.17.7.7.m7.1.1" xref="S4.F7.17.7.7.m7.1.1.cmml"><mn id="S4.F7.17.7.7.m7.1.1.2" xref="S4.F7.17.7.7.m7.1.1.2.cmml">2</mn><mn id="S4.F7.17.7.7.m7.1.1.3" xref="S4.F7.17.7.7.m7.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.F7.17.7.7.m7.1c"><apply id="S4.F7.17.7.7.m7.1.1.cmml" xref="S4.F7.17.7.7.m7.1.1"><csymbol cd="ambiguous" id="S4.F7.17.7.7.m7.1.1.1.cmml" xref="S4.F7.17.7.7.m7.1.1">superscript</csymbol><cn id="S4.F7.17.7.7.m7.1.1.2.cmml" type="integer" xref="S4.F7.17.7.7.m7.1.1.2">2</cn><cn id="S4.F7.17.7.7.m7.1.1.3.cmml" type="integer" xref="S4.F7.17.7.7.m7.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.17.7.7.m7.1d">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.F7.17.7.7.m7.1e">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, is shown as a black dotted line.
An extended version of this figure showing <math alttext="g=10" class="ltx_Math" display="inline" id="S4.F7.18.8.8.m8.1"><semantics id="S4.F7.18.8.8.m8.1b"><mrow id="S4.F7.18.8.8.m8.1.1" xref="S4.F7.18.8.8.m8.1.1.cmml"><mi id="S4.F7.18.8.8.m8.1.1.2" xref="S4.F7.18.8.8.m8.1.1.2.cmml">g</mi><mo id="S4.F7.18.8.8.m8.1.1.1" xref="S4.F7.18.8.8.m8.1.1.1.cmml">=</mo><mn id="S4.F7.18.8.8.m8.1.1.3" xref="S4.F7.18.8.8.m8.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F7.18.8.8.m8.1c"><apply id="S4.F7.18.8.8.m8.1.1.cmml" xref="S4.F7.18.8.8.m8.1.1"><eq id="S4.F7.18.8.8.m8.1.1.1.cmml" xref="S4.F7.18.8.8.m8.1.1.1"></eq><ci id="S4.F7.18.8.8.m8.1.1.2.cmml" xref="S4.F7.18.8.8.m8.1.1.2">𝑔</ci><cn id="S4.F7.18.8.8.m8.1.1.3.cmml" type="integer" xref="S4.F7.18.8.8.m8.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.18.8.8.m8.1d">g=10</annotation><annotation encoding="application/x-llamapun" id="S4.F7.18.8.8.m8.1e">italic_g = 10</annotation></semantics></math> and <math alttext="g=100" class="ltx_Math" display="inline" id="S4.F7.19.9.9.m9.1"><semantics id="S4.F7.19.9.9.m9.1b"><mrow id="S4.F7.19.9.9.m9.1.1" xref="S4.F7.19.9.9.m9.1.1.cmml"><mi id="S4.F7.19.9.9.m9.1.1.2" xref="S4.F7.19.9.9.m9.1.1.2.cmml">g</mi><mo id="S4.F7.19.9.9.m9.1.1.1" xref="S4.F7.19.9.9.m9.1.1.1.cmml">=</mo><mn id="S4.F7.19.9.9.m9.1.1.3" xref="S4.F7.19.9.9.m9.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F7.19.9.9.m9.1c"><apply id="S4.F7.19.9.9.m9.1.1.cmml" xref="S4.F7.19.9.9.m9.1.1"><eq id="S4.F7.19.9.9.m9.1.1.1.cmml" xref="S4.F7.19.9.9.m9.1.1.1"></eq><ci id="S4.F7.19.9.9.m9.1.1.2.cmml" xref="S4.F7.19.9.9.m9.1.1.2">𝑔</ci><cn id="S4.F7.19.9.9.m9.1.1.3.cmml" type="integer" xref="S4.F7.19.9.9.m9.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.19.9.9.m9.1d">g=100</annotation><annotation encoding="application/x-llamapun" id="S4.F7.19.9.9.m9.1e">italic_g = 100</annotation></semantics></math> adversarial guesses is given in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2" title="A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.2</span></a>, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.F10" title="Figure 10 ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">10</span></a>.
The absolute adversarial guess probabilities increase for larger <math alttext="g" class="ltx_Math" display="inline" id="S4.F7.20.10.10.m10.1"><semantics id="S4.F7.20.10.10.m10.1b"><mi id="S4.F7.20.10.10.m10.1.1" xref="S4.F7.20.10.10.m10.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.F7.20.10.10.m10.1c"><ci id="S4.F7.20.10.10.m10.1.1.cmml" xref="S4.F7.20.10.10.m10.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.20.10.10.m10.1d">g</annotation><annotation encoding="application/x-llamapun" id="S4.F7.20.10.10.m10.1e">italic_g</annotation></semantics></math>, but the comparisons among methods remain the same.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.8">In Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS2" title="A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.2</span></a>, we derive adversarial guess probabilities for the <span class="ltx_ERROR undefined" id="S4.SS3.p4.8.1">\replaced</span>sevensix IPID selection methods as a function of <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><msub id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2" xref="S4.SS3.p4.1.m1.1.1.2.cmml">λ</mi><mi id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2">𝜆</ci><ci id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
To facilitate a fair comparison of results across selection methods, we visualize the results in two ways.
We first consider the “uniform case” where the <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.1"><semantics id="S4.SS3.p4.2.m2.1a"><mi id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.1d">italic_λ</annotation></semantics></math>-rate traffic is evenly distributed over all <math alttext="r" class="ltx_Math" display="inline" id="S4.SS3.p4.3.m3.1"><semantics id="S4.SS3.p4.3.m3.1a"><mi id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><ci id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.3.m3.1d">italic_r</annotation></semantics></math> IPID resources of <math alttext="S" class="ltx_Math" display="inline" id="S4.SS3.p4.4.m4.1"><semantics id="S4.SS3.p4.4.m4.1a"><mi id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><ci id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.4.m4.1d">italic_S</annotation></semantics></math>, yielding <math alttext="\lambda_{i}=\lambda/r" class="ltx_Math" display="inline" id="S4.SS3.p4.5.m5.1"><semantics id="S4.SS3.p4.5.m5.1a"><mrow id="S4.SS3.p4.5.m5.1.1" xref="S4.SS3.p4.5.m5.1.1.cmml"><msub id="S4.SS3.p4.5.m5.1.1.2" xref="S4.SS3.p4.5.m5.1.1.2.cmml"><mi id="S4.SS3.p4.5.m5.1.1.2.2" xref="S4.SS3.p4.5.m5.1.1.2.2.cmml">λ</mi><mi id="S4.SS3.p4.5.m5.1.1.2.3" xref="S4.SS3.p4.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p4.5.m5.1.1.1" xref="S4.SS3.p4.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS3.p4.5.m5.1.1.3" xref="S4.SS3.p4.5.m5.1.1.3.cmml"><mi id="S4.SS3.p4.5.m5.1.1.3.2" xref="S4.SS3.p4.5.m5.1.1.3.2.cmml">λ</mi><mo id="S4.SS3.p4.5.m5.1.1.3.1" xref="S4.SS3.p4.5.m5.1.1.3.1.cmml">/</mo><mi id="S4.SS3.p4.5.m5.1.1.3.3" xref="S4.SS3.p4.5.m5.1.1.3.3.cmml">r</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.5.m5.1b"><apply id="S4.SS3.p4.5.m5.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1"><eq id="S4.SS3.p4.5.m5.1.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1.1"></eq><apply id="S4.SS3.p4.5.m5.1.1.2.cmml" xref="S4.SS3.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.5.m5.1.1.2.1.cmml" xref="S4.SS3.p4.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS3.p4.5.m5.1.1.2.2.cmml" xref="S4.SS3.p4.5.m5.1.1.2.2">𝜆</ci><ci id="S4.SS3.p4.5.m5.1.1.2.3.cmml" xref="S4.SS3.p4.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p4.5.m5.1.1.3.cmml" xref="S4.SS3.p4.5.m5.1.1.3"><divide id="S4.SS3.p4.5.m5.1.1.3.1.cmml" xref="S4.SS3.p4.5.m5.1.1.3.1"></divide><ci id="S4.SS3.p4.5.m5.1.1.3.2.cmml" xref="S4.SS3.p4.5.m5.1.1.3.2">𝜆</ci><ci id="S4.SS3.p4.5.m5.1.1.3.3.cmml" xref="S4.SS3.p4.5.m5.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.5.m5.1c">\lambda_{i}=\lambda/r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.5.m5.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_λ / italic_r</annotation></semantics></math> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.F7" title="Figure 7 ‣ 4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">7</span></a>, left).
For per-connection, per-destination, and per-bucket selection where <math alttext="r\geq 1" class="ltx_Math" display="inline" id="S4.SS3.p4.6.m6.1"><semantics id="S4.SS3.p4.6.m6.1a"><mrow id="S4.SS3.p4.6.m6.1.1" xref="S4.SS3.p4.6.m6.1.1.cmml"><mi id="S4.SS3.p4.6.m6.1.1.2" xref="S4.SS3.p4.6.m6.1.1.2.cmml">r</mi><mo id="S4.SS3.p4.6.m6.1.1.1" xref="S4.SS3.p4.6.m6.1.1.1.cmml">≥</mo><mn id="S4.SS3.p4.6.m6.1.1.3" xref="S4.SS3.p4.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.6.m6.1b"><apply id="S4.SS3.p4.6.m6.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1"><geq id="S4.SS3.p4.6.m6.1.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1.1"></geq><ci id="S4.SS3.p4.6.m6.1.1.2.cmml" xref="S4.SS3.p4.6.m6.1.1.2">𝑟</ci><cn id="S4.SS3.p4.6.m6.1.1.3.cmml" type="integer" xref="S4.SS3.p4.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.6.m6.1c">r\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.6.m6.1d">italic_r ≥ 1</annotation></semantics></math>, this represents a baseline setting where all active connections or destinations generate roughly the same amount of traffic or where the bucket hash function distributes a similar amount of traffic to each bucket.
We then consider the “worst case” where <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="S4.SS3.p4.7.m7.1"><semantics id="S4.SS3.p4.7.m7.1a"><msub id="S4.SS3.p4.7.m7.1.1" xref="S4.SS3.p4.7.m7.1.1.cmml"><mi id="S4.SS3.p4.7.m7.1.1.2" xref="S4.SS3.p4.7.m7.1.1.2.cmml">λ</mi><mi id="S4.SS3.p4.7.m7.1.1.3" xref="S4.SS3.p4.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.7.m7.1b"><apply id="S4.SS3.p4.7.m7.1.1.cmml" xref="S4.SS3.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.1.1.1.cmml" xref="S4.SS3.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p4.7.m7.1.1.2.cmml" xref="S4.SS3.p4.7.m7.1.1.2">𝜆</ci><ci id="S4.SS3.p4.7.m7.1.1.3.cmml" xref="S4.SS3.p4.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.7.m7.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.7.m7.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> takes on whatever value is both feasible with respect to the total rate <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p4.8.m8.1"><semantics id="S4.SS3.p4.8.m8.1a"><mi id="S4.SS3.p4.8.m8.1.1" xref="S4.SS3.p4.8.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.8.m8.1b"><ci id="S4.SS3.p4.8.m8.1.1.cmml" xref="S4.SS3.p4.8.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.8.m8.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.8.m8.1d">italic_λ</annotation></semantics></math> and maximizes the adversarial guess probability (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.F7" title="Figure 7 ‣ 4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">7</span></a>, right), i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lambda_{i}=\left\{\begin{array}[]{cl}\lambda&amp;\text{if $r=1$};\\
\arg\max_{0\leq\lambda_{i}\leq\lambda}\{\mathrm{Pr}\left[\text{adv.\ guess}%
\right]\}&amp;\text{if $r&gt;1$}.\end{array}\right." class="ltx_Math" display="block" id="S4.E3.m1.5"><semantics id="S4.E3.m1.5a"><mrow id="S4.E3.m1.5.6" xref="S4.E3.m1.5.6.cmml"><msub id="S4.E3.m1.5.6.2" xref="S4.E3.m1.5.6.2.cmml"><mi id="S4.E3.m1.5.6.2.2" xref="S4.E3.m1.5.6.2.2.cmml">λ</mi><mi id="S4.E3.m1.5.6.2.3" xref="S4.E3.m1.5.6.2.3.cmml">i</mi></msub><mo id="S4.E3.m1.5.6.1" xref="S4.E3.m1.5.6.1.cmml">=</mo><mrow id="S4.E3.m1.5.6.3.2" xref="S4.E3.m1.5.6.3.1.cmml"><mo id="S4.E3.m1.5.6.3.2.1" xref="S4.E3.m1.5.6.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E3.m1.5.5" rowspacing="0pt" xref="S4.E3.m1.5.5.cmml"><mtr id="S4.E3.m1.5.5a" xref="S4.E3.m1.5.5.cmml"><mtd id="S4.E3.m1.5.5b" xref="S4.E3.m1.5.5.cmml"><mi id="S4.E3.m1.1.1.1.2.1" xref="S4.E3.m1.1.1.1.2.1.cmml">λ</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.5.5c" xref="S4.E3.m1.5.5.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1b.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1b.cmml"><mtext id="S4.E3.m1.1.1.1.1.1.1.1a" xref="S4.E3.m1.1.1.1.1.1.1.1a.cmml">if </mtext><mrow id="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml">r</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml">1</mn></mrow></mrow><mo id="S4.E3.m1.1.1.1.1.1.3.1" xref="S4.E3.m1.1.1.1.1.1.1.1b.cmml">;</mo></mrow></mtd></mtr><mtr id="S4.E3.m1.5.5d" xref="S4.E3.m1.5.5.cmml"><mtd id="S4.E3.m1.5.5e" xref="S4.E3.m1.5.5.cmml"><mrow id="S4.E3.m1.5.5.5.4.3" xref="S4.E3.m1.5.5.5.4.3.cmml"><mi id="S4.E3.m1.5.5.5.4.3.4" xref="S4.E3.m1.5.5.5.4.3.4.cmml">arg</mi><mo id="S4.E3.m1.5.5.5.4.3a" lspace="0.167em" xref="S4.E3.m1.5.5.5.4.3.cmml">⁡</mo><mrow id="S4.E3.m1.5.5.5.4.3.3.2" xref="S4.E3.m1.5.5.5.4.3.3.3.cmml"><msub id="S4.E3.m1.4.4.4.3.2.2.1.1" xref="S4.E3.m1.4.4.4.3.2.2.1.1.cmml"><mi id="S4.E3.m1.4.4.4.3.2.2.1.1.2" xref="S4.E3.m1.4.4.4.3.2.2.1.1.2.cmml">max</mi><mrow id="S4.E3.m1.4.4.4.3.2.2.1.1.3" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.cmml"><mn id="S4.E3.m1.4.4.4.3.2.2.1.1.3.2" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.2.cmml">0</mn><mo id="S4.E3.m1.4.4.4.3.2.2.1.1.3.3" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.3.cmml">≤</mo><msub id="S4.E3.m1.4.4.4.3.2.2.1.1.3.4" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.cmml"><mi id="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.2" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.2.cmml">λ</mi><mi id="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.3" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.3.cmml">i</mi></msub><mo id="S4.E3.m1.4.4.4.3.2.2.1.1.3.5" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.5.cmml">≤</mo><mi id="S4.E3.m1.4.4.4.3.2.2.1.1.3.6" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.6.cmml">λ</mi></mrow></msub><mo id="S4.E3.m1.5.5.5.4.3.3.2a" xref="S4.E3.m1.5.5.5.4.3.3.3.cmml">⁡</mo><mrow id="S4.E3.m1.5.5.5.4.3.3.2.2" xref="S4.E3.m1.5.5.5.4.3.3.3.cmml"><mo id="S4.E3.m1.5.5.5.4.3.3.2.2.2" stretchy="false" xref="S4.E3.m1.5.5.5.4.3.3.3.cmml">{</mo><mrow id="S4.E3.m1.5.5.5.4.3.3.2.2.1" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.cmml"><mi id="S4.E3.m1.5.5.5.4.3.3.2.2.1.2" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.2.cmml">Pr</mi><mo id="S4.E3.m1.5.5.5.4.3.3.2.2.1.1" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.1.cmml">⁢</mo><mrow id="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.2" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.1.cmml"><mo id="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.2.1" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.1.1.cmml">[</mo><mtext id="S4.E3.m1.3.3.3.2.1.1" xref="S4.E3.m1.3.3.3.2.1.1a.cmml">adv. guess</mtext><mo id="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.2.2" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E3.m1.5.5.5.4.3.3.2.2.3" stretchy="false" xref="S4.E3.m1.5.5.5.4.3.3.3.cmml">}</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.5.5f" xref="S4.E3.m1.5.5.cmml"><mrow id="S4.E3.m1.2.2.2.1.1.3" xref="S4.E3.m1.2.2.2.1.1.1.1b.cmml"><mrow id="S4.E3.m1.2.2.2.1.1.1.1" xref="S4.E3.m1.2.2.2.1.1.1.1b.cmml"><mtext id="S4.E3.m1.2.2.2.1.1.1.1a" xref="S4.E3.m1.2.2.2.1.1.1.1a.cmml">if </mtext><mrow id="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1" xref="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.cmml"><mi id="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.2" xref="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.2.cmml">r</mi><mo id="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.1" xref="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.3" xref="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.3.cmml">1</mn></mrow></mrow><mo id="S4.E3.m1.2.2.2.1.1.3.1" lspace="0em" xref="S4.E3.m1.2.2.2.1.1.1.1b.cmml">.</mo></mrow></mtd></mtr></mtable><mi id="S4.E3.m1.5.6.3.2.2" xref="S4.E3.m1.5.6.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.5b"><apply id="S4.E3.m1.5.6.cmml" xref="S4.E3.m1.5.6"><eq id="S4.E3.m1.5.6.1.cmml" xref="S4.E3.m1.5.6.1"></eq><apply id="S4.E3.m1.5.6.2.cmml" xref="S4.E3.m1.5.6.2"><csymbol cd="ambiguous" id="S4.E3.m1.5.6.2.1.cmml" xref="S4.E3.m1.5.6.2">subscript</csymbol><ci id="S4.E3.m1.5.6.2.2.cmml" xref="S4.E3.m1.5.6.2.2">𝜆</ci><ci id="S4.E3.m1.5.6.2.3.cmml" xref="S4.E3.m1.5.6.2.3">𝑖</ci></apply><apply id="S4.E3.m1.5.6.3.1.cmml" xref="S4.E3.m1.5.6.3.2"><csymbol cd="latexml" id="S4.E3.m1.5.6.3.1.1.cmml" xref="S4.E3.m1.5.6.3.2.1">cases</csymbol><matrix id="S4.E3.m1.5.5.cmml" xref="S4.E3.m1.5.5"><matrixrow id="S4.E3.m1.5.5a.cmml" xref="S4.E3.m1.5.5"><ci id="S4.E3.m1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.2.1">𝜆</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1b.cmml" xref="S4.E3.m1.1.1.1.1.1.3"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.3"><mtext id="S4.E3.m1.1.1.1.1.1.1.1a.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1a">if </mtext><mrow id="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1"><mi id="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.2">r</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.1">=</mo><mn id="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.m1.1.1.3">1</mn></mrow></mrow></ci></matrixrow><matrixrow id="S4.E3.m1.5.5b.cmml" xref="S4.E3.m1.5.5"><apply id="S4.E3.m1.5.5.5.4.3.cmml" xref="S4.E3.m1.5.5.5.4.3"><arg id="S4.E3.m1.5.5.5.4.3.4.cmml" xref="S4.E3.m1.5.5.5.4.3.4"></arg><apply id="S4.E3.m1.5.5.5.4.3.3.3.cmml" xref="S4.E3.m1.5.5.5.4.3.3.2"><apply id="S4.E3.m1.4.4.4.3.2.2.1.1.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.3.2.2.1.1.1.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1">subscript</csymbol><max id="S4.E3.m1.4.4.4.3.2.2.1.1.2.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.2"></max><apply id="S4.E3.m1.4.4.4.3.2.2.1.1.3.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3"><and id="S4.E3.m1.4.4.4.3.2.2.1.1.3a.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3"></and><apply id="S4.E3.m1.4.4.4.3.2.2.1.1.3b.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3"><leq id="S4.E3.m1.4.4.4.3.2.2.1.1.3.3.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.3"></leq><cn id="S4.E3.m1.4.4.4.3.2.2.1.1.3.2.cmml" type="integer" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.2">0</cn><apply id="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.4"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.1.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.4">subscript</csymbol><ci id="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.2.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.2">𝜆</ci><ci id="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.3.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.4.3">𝑖</ci></apply></apply><apply id="S4.E3.m1.4.4.4.3.2.2.1.1.3c.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3"><leq id="S4.E3.m1.4.4.4.3.2.2.1.1.3.5.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.5"></leq><share href="https://arxiv.org/html/2406.06483v2#S4.E3.m1.4.4.4.3.2.2.1.1.3.4.cmml" id="S4.E3.m1.4.4.4.3.2.2.1.1.3d.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3"></share><ci id="S4.E3.m1.4.4.4.3.2.2.1.1.3.6.cmml" xref="S4.E3.m1.4.4.4.3.2.2.1.1.3.6">𝜆</ci></apply></apply></apply><apply id="S4.E3.m1.5.5.5.4.3.3.2.2.1.cmml" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1"><times id="S4.E3.m1.5.5.5.4.3.3.2.2.1.1.cmml" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.1"></times><ci id="S4.E3.m1.5.5.5.4.3.3.2.2.1.2.cmml" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.2">Pr</ci><apply id="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.1.cmml" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.2"><csymbol cd="latexml" id="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.1.1.cmml" xref="S4.E3.m1.5.5.5.4.3.3.2.2.1.3.2.1">delimited-[]</csymbol><ci id="S4.E3.m1.3.3.3.2.1.1a.cmml" xref="S4.E3.m1.3.3.3.2.1.1"><mtext id="S4.E3.m1.3.3.3.2.1.1.cmml" xref="S4.E3.m1.3.3.3.2.1.1">adv. guess</mtext></ci></apply></apply></apply></apply><ci id="S4.E3.m1.2.2.2.1.1.1.1b.cmml" xref="S4.E3.m1.2.2.2.1.1.3"><mrow id="S4.E3.m1.2.2.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.1.1.3"><mtext id="S4.E3.m1.2.2.2.1.1.1.1a.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1a">if </mtext><mrow id="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1"><mi id="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.2">r</mi><mo id="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.1">&gt;</mo><mn id="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1.m1.1.1.3">1</mn></mrow></mrow></ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.5c">\lambda_{i}=\left\{\begin{array}[]{cl}\lambda&amp;\text{if $r=1$};\\
\arg\max_{0\leq\lambda_{i}\leq\lambda}\{\mathrm{Pr}\left[\text{adv.\ guess}%
\right]\}&amp;\text{if $r&gt;1$}.\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.5d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { start_ARRAY start_ROW start_CELL italic_λ end_CELL start_CELL if italic_r = 1 ; end_CELL end_ROW start_ROW start_CELL roman_arg roman_max start_POSTSUBSCRIPT 0 ≤ italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≤ italic_λ end_POSTSUBSCRIPT { roman_Pr [ adv. guess ] } end_CELL start_CELL if italic_r &gt; 1 . end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<span class="ltx_ERROR undefined" id="S4.SS3.p4.16">\added</span>
<p class="ltx_p" id="S4.SS3.p4.15">These worst case <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="S4.SS3.p4.9.m1.1"><semantics id="S4.SS3.p4.9.m1.1a"><msub id="S4.SS3.p4.9.m1.1.1" xref="S4.SS3.p4.9.m1.1.1.cmml"><mi id="S4.SS3.p4.9.m1.1.1.2" xref="S4.SS3.p4.9.m1.1.1.2.cmml">λ</mi><mi id="S4.SS3.p4.9.m1.1.1.3" xref="S4.SS3.p4.9.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.9.m1.1b"><apply id="S4.SS3.p4.9.m1.1.1.cmml" xref="S4.SS3.p4.9.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.9.m1.1.1.1.cmml" xref="S4.SS3.p4.9.m1.1.1">subscript</csymbol><ci id="S4.SS3.p4.9.m1.1.1.2.cmml" xref="S4.SS3.p4.9.m1.1.1.2">𝜆</ci><ci id="S4.SS3.p4.9.m1.1.1.3.cmml" xref="S4.SS3.p4.9.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.9.m1.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.9.m1.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>’s capture the many ways <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p4.10.m2.1"><semantics id="S4.SS3.p4.10.m2.1a"><mi id="S4.SS3.p4.10.m2.1.1" xref="S4.SS3.p4.10.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.10.m2.1b"><ci id="S4.SS3.p4.10.m2.1.1.cmml" xref="S4.SS3.p4.10.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.10.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.10.m2.1d">italic_λ</annotation></semantics></math> total traffic can be allocated among <math alttext="r" class="ltx_Math" display="inline" id="S4.SS3.p4.11.m3.1"><semantics id="S4.SS3.p4.11.m3.1a"><mi id="S4.SS3.p4.11.m3.1.1" xref="S4.SS3.p4.11.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.11.m3.1b"><ci id="S4.SS3.p4.11.m3.1.1.cmml" xref="S4.SS3.p4.11.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.11.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.11.m3.1d">italic_r</annotation></semantics></math> different IPID resources (e.g., bucket counters) surfacing the allocation that makes a given resource maximally predictable.
For example, is it easier to predict a given bucket counter <math alttext="b" class="ltx_Math" display="inline" id="S4.SS3.p4.12.m4.1"><semantics id="S4.SS3.p4.12.m4.1a"><mi id="S4.SS3.p4.12.m4.1.1" xref="S4.SS3.p4.12.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.12.m4.1b"><ci id="S4.SS3.p4.12.m4.1.1.cmml" xref="S4.SS3.p4.12.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.12.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.12.m4.1d">italic_b</annotation></semantics></math> when <math alttext="b" class="ltx_Math" display="inline" id="S4.SS3.p4.13.m5.1"><semantics id="S4.SS3.p4.13.m5.1a"><mi id="S4.SS3.p4.13.m5.1.1" xref="S4.SS3.p4.13.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.13.m5.1b"><ci id="S4.SS3.p4.13.m5.1.1.cmml" xref="S4.SS3.p4.13.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.13.m5.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.13.m5.1d">italic_b</annotation></semantics></math> is responsible for nearly all <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p4.14.m6.1"><semantics id="S4.SS3.p4.14.m6.1a"><mi id="S4.SS3.p4.14.m6.1.1" xref="S4.SS3.p4.14.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.14.m6.1b"><ci id="S4.SS3.p4.14.m6.1.1.cmml" xref="S4.SS3.p4.14.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.14.m6.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.14.m6.1d">italic_λ</annotation></semantics></math> traffic, or when <math alttext="b" class="ltx_Math" display="inline" id="S4.SS3.p4.15.m7.1"><semantics id="S4.SS3.p4.15.m7.1a"><mi id="S4.SS3.p4.15.m7.1.1" xref="S4.SS3.p4.15.m7.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.15.m7.1b"><ci id="S4.SS3.p4.15.m7.1.1.cmml" xref="S4.SS3.p4.15.m7.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.15.m7.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.15.m7.1d">italic_b</annotation></semantics></math> assigns very few IPIDs with the rest of the traffic being handled by other buckets?
Together, the uniform case emphasizes how the number of IPID resources impacts security while the worst case captures the fundamental predictability of any one IPID resource.</p>
</div>
<div class="ltx_para" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.2">An IPID selection method is <span class="ltx_text ltx_font_italic" id="S4.SS3.p5.2.1">optimally secure</span> if its probability of an adversarial guess is exactly <math alttext="g/2^{16}" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.1"><semantics id="S4.SS3.p5.1.m1.1a"><mrow id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">g</mi><mo id="S4.SS3.p5.1.m1.1.1.1" xref="S4.SS3.p5.1.m1.1.1.1.cmml">/</mo><msup id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml"><mn id="S4.SS3.p5.1.m1.1.1.3.2" xref="S4.SS3.p5.1.m1.1.1.3.2.cmml">2</mn><mn id="S4.SS3.p5.1.m1.1.1.3.3" xref="S4.SS3.p5.1.m1.1.1.3.3.cmml">16</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><divide id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1.1"></divide><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝑔</ci><apply id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.3.1.cmml" xref="S4.SS3.p5.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS3.p5.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS3.p5.1.m1.1.1.3.2">2</cn><cn id="S4.SS3.p5.1.m1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p5.1.m1.1.1.3.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">g/2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.1d">italic_g / 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, i.e., if the adversary can do no better than make its <math alttext="g" class="ltx_Math" display="inline" id="S4.SS3.p5.2.m2.1"><semantics id="S4.SS3.p5.2.m2.1a"><mi id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><ci id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.2.m2.1d">italic_g</annotation></semantics></math> distinct guesses uniformly at random over all possible IPIDs.
Per-connection <span class="ltx_ERROR undefined" id="S4.SS3.p5.2.2">\added</span>and pure PRNG selection <span class="ltx_ERROR undefined" id="S4.SS3.p5.2.3">\replaced</span>areis thus the only optimally secure method<span class="ltx_ERROR undefined" id="S4.SS3.p5.2.4">\added</span>s, though <span class="ltx_ERROR undefined" id="S4.SS3.p5.2.5">\replaced</span>per-connection’s optimalitythis depends on the potentially precarious assumption that an off-path adversary can never infer the status of another machine’s connection counter or downgrade per-connection selection to some less secure method.
In contrast, the PRNG-based methods achieve (near-)optimal security based only on the assumption of a sufficiently random, correctly implemented, and well-seeded PRNG algorithm.</p>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.5">Our model confirms the probable success of idle scan attacks <cite class="ltx_cite ltx_citemacro_citep">(antirez, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib3" title="">1998</a>; Ensafi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib18" title="">2014</a>)</cite>, predicting near-certain adversarial guesses for globally incrementing selection on any quiet channel (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.F7" title="Figure 7 ‣ 4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">7</span></a>, <math alttext="0&lt;\lambda&lt;1" class="ltx_Math" display="inline" id="S4.SS3.p6.1.m1.1"><semantics id="S4.SS3.p6.1.m1.1a"><mrow id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml"><mn id="S4.SS3.p6.1.m1.1.1.2" xref="S4.SS3.p6.1.m1.1.1.2.cmml">0</mn><mo id="S4.SS3.p6.1.m1.1.1.3" xref="S4.SS3.p6.1.m1.1.1.3.cmml">&lt;</mo><mi id="S4.SS3.p6.1.m1.1.1.4" xref="S4.SS3.p6.1.m1.1.1.4.cmml">λ</mi><mo id="S4.SS3.p6.1.m1.1.1.5" xref="S4.SS3.p6.1.m1.1.1.5.cmml">&lt;</mo><mn id="S4.SS3.p6.1.m1.1.1.6" xref="S4.SS3.p6.1.m1.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><apply id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1"><and id="S4.SS3.p6.1.m1.1.1a.cmml" xref="S4.SS3.p6.1.m1.1.1"></and><apply id="S4.SS3.p6.1.m1.1.1b.cmml" xref="S4.SS3.p6.1.m1.1.1"><lt id="S4.SS3.p6.1.m1.1.1.3.cmml" xref="S4.SS3.p6.1.m1.1.1.3"></lt><cn id="S4.SS3.p6.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.p6.1.m1.1.1.2">0</cn><ci id="S4.SS3.p6.1.m1.1.1.4.cmml" xref="S4.SS3.p6.1.m1.1.1.4">𝜆</ci></apply><apply id="S4.SS3.p6.1.m1.1.1c.cmml" xref="S4.SS3.p6.1.m1.1.1"><lt id="S4.SS3.p6.1.m1.1.1.5.cmml" xref="S4.SS3.p6.1.m1.1.1.5"></lt><share href="https://arxiv.org/html/2406.06483v2#S4.SS3.p6.1.m1.1.1.4.cmml" id="S4.SS3.p6.1.m1.1.1d.cmml" xref="S4.SS3.p6.1.m1.1.1"></share><cn id="S4.SS3.p6.1.m1.1.1.6.cmml" type="integer" xref="S4.SS3.p6.1.m1.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">0&lt;\lambda&lt;1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.1.m1.1d">0 &lt; italic_λ &lt; 1</annotation></semantics></math>).
It also confirms that Linux’s addition of stochastic increments to per-bucket selection obfuscates otherwise predictable counter statuses in very quiet buckets (<math alttext="\lambda&lt;2^{-12}" class="ltx_Math" display="inline" id="S4.SS3.p6.2.m2.1"><semantics id="S4.SS3.p6.2.m2.1a"><mrow id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml"><mi id="S4.SS3.p6.2.m2.1.1.2" xref="S4.SS3.p6.2.m2.1.1.2.cmml">λ</mi><mo id="S4.SS3.p6.2.m2.1.1.1" xref="S4.SS3.p6.2.m2.1.1.1.cmml">&lt;</mo><msup id="S4.SS3.p6.2.m2.1.1.3" xref="S4.SS3.p6.2.m2.1.1.3.cmml"><mn id="S4.SS3.p6.2.m2.1.1.3.2" xref="S4.SS3.p6.2.m2.1.1.3.2.cmml">2</mn><mrow id="S4.SS3.p6.2.m2.1.1.3.3" xref="S4.SS3.p6.2.m2.1.1.3.3.cmml"><mo id="S4.SS3.p6.2.m2.1.1.3.3a" xref="S4.SS3.p6.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS3.p6.2.m2.1.1.3.3.2" xref="S4.SS3.p6.2.m2.1.1.3.3.2.cmml">12</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.1b"><apply id="S4.SS3.p6.2.m2.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1"><lt id="S4.SS3.p6.2.m2.1.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1.1"></lt><ci id="S4.SS3.p6.2.m2.1.1.2.cmml" xref="S4.SS3.p6.2.m2.1.1.2">𝜆</ci><apply id="S4.SS3.p6.2.m2.1.1.3.cmml" xref="S4.SS3.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.1.1.3.1.cmml" xref="S4.SS3.p6.2.m2.1.1.3">superscript</csymbol><cn id="S4.SS3.p6.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS3.p6.2.m2.1.1.3.2">2</cn><apply id="S4.SS3.p6.2.m2.1.1.3.3.cmml" xref="S4.SS3.p6.2.m2.1.1.3.3"><minus id="S4.SS3.p6.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.p6.2.m2.1.1.3.3"></minus><cn id="S4.SS3.p6.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.SS3.p6.2.m2.1.1.3.3.2">12</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.1c">\lambda&lt;2^{-12}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.2.m2.1d">italic_λ &lt; 2 start_POSTSUPERSCRIPT - 12 end_POSTSUPERSCRIPT</annotation></semantics></math> for worst-case traffic; <math alttext="\lambda&lt;2^{-1}" class="ltx_Math" display="inline" id="S4.SS3.p6.3.m3.1"><semantics id="S4.SS3.p6.3.m3.1a"><mrow id="S4.SS3.p6.3.m3.1.1" xref="S4.SS3.p6.3.m3.1.1.cmml"><mi id="S4.SS3.p6.3.m3.1.1.2" xref="S4.SS3.p6.3.m3.1.1.2.cmml">λ</mi><mo id="S4.SS3.p6.3.m3.1.1.1" xref="S4.SS3.p6.3.m3.1.1.1.cmml">&lt;</mo><msup id="S4.SS3.p6.3.m3.1.1.3" xref="S4.SS3.p6.3.m3.1.1.3.cmml"><mn id="S4.SS3.p6.3.m3.1.1.3.2" xref="S4.SS3.p6.3.m3.1.1.3.2.cmml">2</mn><mrow id="S4.SS3.p6.3.m3.1.1.3.3" xref="S4.SS3.p6.3.m3.1.1.3.3.cmml"><mo id="S4.SS3.p6.3.m3.1.1.3.3a" xref="S4.SS3.p6.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS3.p6.3.m3.1.1.3.3.2" xref="S4.SS3.p6.3.m3.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.3.m3.1b"><apply id="S4.SS3.p6.3.m3.1.1.cmml" xref="S4.SS3.p6.3.m3.1.1"><lt id="S4.SS3.p6.3.m3.1.1.1.cmml" xref="S4.SS3.p6.3.m3.1.1.1"></lt><ci id="S4.SS3.p6.3.m3.1.1.2.cmml" xref="S4.SS3.p6.3.m3.1.1.2">𝜆</ci><apply id="S4.SS3.p6.3.m3.1.1.3.cmml" xref="S4.SS3.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p6.3.m3.1.1.3.1.cmml" xref="S4.SS3.p6.3.m3.1.1.3">superscript</csymbol><cn id="S4.SS3.p6.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS3.p6.3.m3.1.1.3.2">2</cn><apply id="S4.SS3.p6.3.m3.1.1.3.3.cmml" xref="S4.SS3.p6.3.m3.1.1.3.3"><minus id="S4.SS3.p6.3.m3.1.1.3.3.1.cmml" xref="S4.SS3.p6.3.m3.1.1.3.3"></minus><cn id="S4.SS3.p6.3.m3.1.1.3.3.2.cmml" type="integer" xref="S4.SS3.p6.3.m3.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.3.m3.1c">\lambda&lt;2^{-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.3.m3.1d">italic_λ &lt; 2 start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> for uniform traffic).
However, this obfuscation quickly dissipates as the rate of traffic increases.
Surprisingly, per-bucket selection is easier to predict than globally incrementing selection even at relatively low traffic rates (<math alttext="\lambda&gt;2^{2}" class="ltx_Math" display="inline" id="S4.SS3.p6.4.m4.1"><semantics id="S4.SS3.p6.4.m4.1a"><mrow id="S4.SS3.p6.4.m4.1.1" xref="S4.SS3.p6.4.m4.1.1.cmml"><mi id="S4.SS3.p6.4.m4.1.1.2" xref="S4.SS3.p6.4.m4.1.1.2.cmml">λ</mi><mo id="S4.SS3.p6.4.m4.1.1.1" xref="S4.SS3.p6.4.m4.1.1.1.cmml">&gt;</mo><msup id="S4.SS3.p6.4.m4.1.1.3" xref="S4.SS3.p6.4.m4.1.1.3.cmml"><mn id="S4.SS3.p6.4.m4.1.1.3.2" xref="S4.SS3.p6.4.m4.1.1.3.2.cmml">2</mn><mn id="S4.SS3.p6.4.m4.1.1.3.3" xref="S4.SS3.p6.4.m4.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.4.m4.1b"><apply id="S4.SS3.p6.4.m4.1.1.cmml" xref="S4.SS3.p6.4.m4.1.1"><gt id="S4.SS3.p6.4.m4.1.1.1.cmml" xref="S4.SS3.p6.4.m4.1.1.1"></gt><ci id="S4.SS3.p6.4.m4.1.1.2.cmml" xref="S4.SS3.p6.4.m4.1.1.2">𝜆</ci><apply id="S4.SS3.p6.4.m4.1.1.3.cmml" xref="S4.SS3.p6.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p6.4.m4.1.1.3.1.cmml" xref="S4.SS3.p6.4.m4.1.1.3">superscript</csymbol><cn id="S4.SS3.p6.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS3.p6.4.m4.1.1.3.2">2</cn><cn id="S4.SS3.p6.4.m4.1.1.3.3.cmml" type="integer" xref="S4.SS3.p6.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.4.m4.1c">\lambda&gt;2^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.4.m4.1d">italic_λ &gt; 2 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> for worst-case traffic; <math alttext="\lambda&gt;2^{7}" class="ltx_Math" display="inline" id="S4.SS3.p6.5.m5.1"><semantics id="S4.SS3.p6.5.m5.1a"><mrow id="S4.SS3.p6.5.m5.1.1" xref="S4.SS3.p6.5.m5.1.1.cmml"><mi id="S4.SS3.p6.5.m5.1.1.2" xref="S4.SS3.p6.5.m5.1.1.2.cmml">λ</mi><mo id="S4.SS3.p6.5.m5.1.1.1" xref="S4.SS3.p6.5.m5.1.1.1.cmml">&gt;</mo><msup id="S4.SS3.p6.5.m5.1.1.3" xref="S4.SS3.p6.5.m5.1.1.3.cmml"><mn id="S4.SS3.p6.5.m5.1.1.3.2" xref="S4.SS3.p6.5.m5.1.1.3.2.cmml">2</mn><mn id="S4.SS3.p6.5.m5.1.1.3.3" xref="S4.SS3.p6.5.m5.1.1.3.3.cmml">7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.5.m5.1b"><apply id="S4.SS3.p6.5.m5.1.1.cmml" xref="S4.SS3.p6.5.m5.1.1"><gt id="S4.SS3.p6.5.m5.1.1.1.cmml" xref="S4.SS3.p6.5.m5.1.1.1"></gt><ci id="S4.SS3.p6.5.m5.1.1.2.cmml" xref="S4.SS3.p6.5.m5.1.1.2">𝜆</ci><apply id="S4.SS3.p6.5.m5.1.1.3.cmml" xref="S4.SS3.p6.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p6.5.m5.1.1.3.1.cmml" xref="S4.SS3.p6.5.m5.1.1.3">superscript</csymbol><cn id="S4.SS3.p6.5.m5.1.1.3.2.cmml" type="integer" xref="S4.SS3.p6.5.m5.1.1.3.2">2</cn><cn id="S4.SS3.p6.5.m5.1.1.3.3.cmml" type="integer" xref="S4.SS3.p6.5.m5.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.5.m5.1c">\lambda&gt;2^{7}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.5.m5.1d">italic_λ &gt; 2 start_POSTSUPERSCRIPT 7 end_POSTSUPERSCRIPT</annotation></semantics></math> for uniform traffic), revealing a subtle but significant security advantage to having all IPIDs assigned by a single resource.
Per-destination selection inherits the worst of both of these methods: it has multiple counters that always increment by one, rendering it the most predictable of all methods over all <span class="ltx_ERROR undefined" id="S4.SS3.p6.5.1">\added</span>but the most extreme traffic rates.
Thus, like per-connection selection, its “security” lies not in its resilience to prediction but in the difficulty of accessing its counters, which has been subverted before<span class="ltx_ERROR undefined" id="S4.SS3.p6.5.2">\deleted</span> <cite class="ltx_cite ltx_citemacro_citep">(Knockel and Crandall, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib39" title="">2014</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Analyzing Performance</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.3">Our final dimension of comparison is performance, measured in both time and space complexity.
We perform this analysis in the context of multi-core servers where CPUs may contend over IPID resources.
To assess time complexity, we benchmarked each IPID selection method in ten independent trials per number of CPUs <math alttext="c\in\{1,2,\ldots,128\}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.4"><semantics id="S4.SS4.p1.1.m1.4a"><mrow id="S4.SS4.p1.1.m1.4.5" xref="S4.SS4.p1.1.m1.4.5.cmml"><mi id="S4.SS4.p1.1.m1.4.5.2" xref="S4.SS4.p1.1.m1.4.5.2.cmml">c</mi><mo id="S4.SS4.p1.1.m1.4.5.1" xref="S4.SS4.p1.1.m1.4.5.1.cmml">∈</mo><mrow id="S4.SS4.p1.1.m1.4.5.3.2" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml"><mo id="S4.SS4.p1.1.m1.4.5.3.2.1" stretchy="false" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">{</mo><mn id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">1</mn><mo id="S4.SS4.p1.1.m1.4.5.3.2.2" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.1.m1.2.2" xref="S4.SS4.p1.1.m1.2.2.cmml">2</mn><mo id="S4.SS4.p1.1.m1.4.5.3.2.3" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">,</mo><mi id="S4.SS4.p1.1.m1.3.3" mathvariant="normal" xref="S4.SS4.p1.1.m1.3.3.cmml">…</mi><mo id="S4.SS4.p1.1.m1.4.5.3.2.4" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.1.m1.4.4" xref="S4.SS4.p1.1.m1.4.4.cmml">128</mn><mo id="S4.SS4.p1.1.m1.4.5.3.2.5" stretchy="false" xref="S4.SS4.p1.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.4b"><apply id="S4.SS4.p1.1.m1.4.5.cmml" xref="S4.SS4.p1.1.m1.4.5"><in id="S4.SS4.p1.1.m1.4.5.1.cmml" xref="S4.SS4.p1.1.m1.4.5.1"></in><ci id="S4.SS4.p1.1.m1.4.5.2.cmml" xref="S4.SS4.p1.1.m1.4.5.2">𝑐</ci><set id="S4.SS4.p1.1.m1.4.5.3.1.cmml" xref="S4.SS4.p1.1.m1.4.5.3.2"><cn id="S4.SS4.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS4.p1.1.m1.1.1">1</cn><cn id="S4.SS4.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS4.p1.1.m1.2.2">2</cn><ci id="S4.SS4.p1.1.m1.3.3.cmml" xref="S4.SS4.p1.1.m1.3.3">…</ci><cn id="S4.SS4.p1.1.m1.4.4.cmml" type="integer" xref="S4.SS4.p1.1.m1.4.4">128</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.4c">c\in\{1,2,\ldots,128\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.4d">italic_c ∈ { 1 , 2 , … , 128 }</annotation></semantics></math> on a 128-core (dual-socket AMD EPYC 7713 Zen3), 512 GiB node on Arizona State University’s Sol supercomputer <cite class="ltx_cite ltx_citemacro_citep">(Jennewein et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib31" title="">2023</a>)</cite>.
In each trial, we count the number of IPIDs each of the <math alttext="c" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_c</annotation></semantics></math> CPUs assigns to packets in a 10 second period when concurrently and repeatedly scanning over a CAIDA trace of <math alttext="\sim" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mo id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><csymbol cd="latexml" id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">∼</annotation></semantics></math>29 million packets <cite class="ltx_cite ltx_citemacro_citep">(CAIDA, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib11" title="">2019</a>)</cite>.
Details of our IPID selection method implementations are given in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A2" title="Appendix B Benchmark Implementation Details ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="346" id="S4.F8.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F8.6.2.1" style="font-size:90%;">Figure 8</span>. </span><span class="ltx_text ltx_font_italic" id="S4.F8.2.1" style="font-size:90%;">IPID Selection Methods’ Time Complexities.<span class="ltx_text ltx_font_upright" id="S4.F8.2.1.1">
Average IPID request time per CPU (left) and IPID throughput per second for all CPUs combined (right, right inset) as a function of the number of CPUs concurrently assigning IPIDs via globally incrementing (dark blue), per-connection (olive), per-destination (pink), per-bucket (teal), and PRNG-based (orange) IPID selection.
Per-bucket is implemented in two ways: those marked “Linux” (teal, solid and dashed) mimic Linux’s actual implementation where bucket counters and last access timestamps are individually atomic but allow race conditions between them, while those marked “Linux<sup class="ltx_sup" id="S4.F8.2.1.1.1">∗</sup>” (teal, dotted and starred) maintain per-bucket locks.
Values are shown as means (lines) and standard deviations (error tubes) over ten independent trials per IPID selection method and number of CPUs.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.2">The average IPID request times and packet throughput rates for each method are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.F8" title="Figure 8 ‣ 4.4. Analyzing Performance ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">8</span></a>.
Unsurprisingly, per-connection selection is very fast (less than 0.1 <math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_μ</annotation></semantics></math>s per IPID request regardless of the number of CPUs).
When Linux gets IPIDs for connection-bound packets, it operates in the context of a socket data structure that at most one CPU is accessing per time.
Thus, obtaining an IPID is as simple as incrementing the socket’s counter without any need to locate the counter via hashing or manage concurrency control.
<span class="ltx_ERROR undefined" id="S4.SS4.p2.2.1">\added</span>Pure PRNG selection is similarly fast regardless of scale, since each CPU gets its own RNG context.
The other methods require concurrency control to protect access to their shared IPID resources, causing their IPID request times to increase with the number of contending CPUs.
Among these methods, globally incrementing selection (implemented as a single atomic counter) is the fastest, even when all 128 CPUs contend over it.
Surprisingly, it outperforms even the per-bucket implementations whose primary reason for maintaining numerous buckets is to improve performance by reducing contention.
Globally incrementing selection is also desirably opportunistic, performing almost as well as per-connection selection in scenarios with very little contention (<math alttext="1\leq c\leq 4" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mn id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">1</mn><mo id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml">≤</mo><mi id="S4.SS4.p2.2.m2.1.1.4" xref="S4.SS4.p2.2.m2.1.1.4.cmml">c</mi><mo id="S4.SS4.p2.2.m2.1.1.5" xref="S4.SS4.p2.2.m2.1.1.5.cmml">≤</mo><mn id="S4.SS4.p2.2.m2.1.1.6" xref="S4.SS4.p2.2.m2.1.1.6.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><and id="S4.SS4.p2.2.m2.1.1a.cmml" xref="S4.SS4.p2.2.m2.1.1"></and><apply id="S4.SS4.p2.2.m2.1.1b.cmml" xref="S4.SS4.p2.2.m2.1.1"><leq id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3"></leq><cn id="S4.SS4.p2.2.m2.1.1.2.cmml" type="integer" xref="S4.SS4.p2.2.m2.1.1.2">1</cn><ci id="S4.SS4.p2.2.m2.1.1.4.cmml" xref="S4.SS4.p2.2.m2.1.1.4">𝑐</ci></apply><apply id="S4.SS4.p2.2.m2.1.1c.cmml" xref="S4.SS4.p2.2.m2.1.1"><leq id="S4.SS4.p2.2.m2.1.1.5.cmml" xref="S4.SS4.p2.2.m2.1.1.5"></leq><share href="https://arxiv.org/html/2406.06483v2#S4.SS4.p2.2.m2.1.1.4.cmml" id="S4.SS4.p2.2.m2.1.1d.cmml" xref="S4.SS4.p2.2.m2.1.1"></share><cn id="S4.SS4.p2.2.m2.1.1.6.cmml" type="integer" xref="S4.SS4.p2.2.m2.1.1.6">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">1\leq c\leq 4</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">1 ≤ italic_c ≤ 4</annotation></semantics></math>).
Per-destination <span class="ltx_ERROR undefined" id="S4.SS4.p2.2.2">\added</span>selection and PRNG-based <span class="ltx_ERROR undefined" id="S4.SS4.p2.2.3">\replaced</span>methods that reserve IPIDs for non-repetitionselection have similarly poor performance, as their implementations rely on locking a single global resource (the hash table of destination counters, the searchable queue, or the shuffled permutation).</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.22.4.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text ltx_font_italic" id="S4.T1.6.3" style="font-size:90%;">IPID Selection Methods’ Space Complexities.<span class="ltx_text ltx_font_upright" id="S4.T1.6.3.3">
Where relevant, <math alttext="r\geq 1" class="ltx_Math" display="inline" id="S4.T1.4.1.1.m1.1"><semantics id="S4.T1.4.1.1.m1.1b"><mrow id="S4.T1.4.1.1.m1.1.1" xref="S4.T1.4.1.1.m1.1.1.cmml"><mi id="S4.T1.4.1.1.m1.1.1.2" xref="S4.T1.4.1.1.m1.1.1.2.cmml">r</mi><mo id="S4.T1.4.1.1.m1.1.1.1" xref="S4.T1.4.1.1.m1.1.1.1.cmml">≥</mo><mn id="S4.T1.4.1.1.m1.1.1.3" xref="S4.T1.4.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.1.1.m1.1c"><apply id="S4.T1.4.1.1.m1.1.1.cmml" xref="S4.T1.4.1.1.m1.1.1"><geq id="S4.T1.4.1.1.m1.1.1.1.cmml" xref="S4.T1.4.1.1.m1.1.1.1"></geq><ci id="S4.T1.4.1.1.m1.1.1.2.cmml" xref="S4.T1.4.1.1.m1.1.1.2">𝑟</ci><cn id="S4.T1.4.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.4.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.1.1.m1.1d">r\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.1.1.m1.1e">italic_r ≥ 1</annotation></semantics></math> is the number of IPID resources (i.e., counters or PRNGs), and <math alttext="k" class="ltx_Math" display="inline" id="S4.T1.5.2.2.m2.1"><semantics id="S4.T1.5.2.2.m2.1b"><mi id="S4.T1.5.2.2.m2.1.1" xref="S4.T1.5.2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.2.2.m2.1c"><ci id="S4.T1.5.2.2.m2.1.1.cmml" xref="S4.T1.5.2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.2.2.m2.1d">k</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.2.2.m2.1e">italic_k</annotation></semantics></math> is the number of IPIDs that PRNG-based methods reserve for non-repetition.
<sup class="ltx_sup" id="S4.T1.6.3.3.1">∗</sup>The Windows implementation of per-destination selection technically has unbounded space complexity, but this table lists the expected memory usage for Windows Server v1904 (see text).</span></span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.18">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.18.13.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T1.18.13.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.18.13.1.1.1">Selection Method</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T1.18.13.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.18.13.1.2.1">#16-bit Counters/IPIDs</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T1.18.13.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.18.13.1.3.1">Other Data</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T1.18.13.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.18.13.1.4.1">Memory</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.18.14.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.18.14.2.1">Globally Incrementing</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.18.14.2.2">1</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.18.14.2.3">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.18.14.2.4">2 bytes</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.7.1.2">Per-Connection</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.7.1.1">
<math alttext="r\geq 1" class="ltx_Math" display="inline" id="S4.T1.7.1.1.m1.1"><semantics id="S4.T1.7.1.1.m1.1a"><mrow id="S4.T1.7.1.1.m1.1.1" xref="S4.T1.7.1.1.m1.1.1.cmml"><mi id="S4.T1.7.1.1.m1.1.1.2" xref="S4.T1.7.1.1.m1.1.1.2.cmml">r</mi><mo id="S4.T1.7.1.1.m1.1.1.1" xref="S4.T1.7.1.1.m1.1.1.1.cmml">≥</mo><mn id="S4.T1.7.1.1.m1.1.1.3" xref="S4.T1.7.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.1.1.m1.1b"><apply id="S4.T1.7.1.1.m1.1.1.cmml" xref="S4.T1.7.1.1.m1.1.1"><geq id="S4.T1.7.1.1.m1.1.1.1.cmml" xref="S4.T1.7.1.1.m1.1.1.1"></geq><ci id="S4.T1.7.1.1.m1.1.1.2.cmml" xref="S4.T1.7.1.1.m1.1.1.2">𝑟</ci><cn id="S4.T1.7.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.7.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.1.1.m1.1c">r\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.1.1.m1.1d">italic_r ≥ 1</annotation></semantics></math> active connections</th>
<td class="ltx_td ltx_align_left" id="S4.T1.7.1.3">N/A</td>
<td class="ltx_td ltx_align_left" id="S4.T1.7.1.4">Unbounded</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.12.6.6">Per-Destination <span class="ltx_ERROR undefined" id="S4.T1.12.6.6.1">\added</span>(Windows)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.10.4.3">
<span class="ltx_ERROR undefined" id="S4.T1.10.4.3.1">\replaced</span><math alttext="r\leq 2^{15}" class="ltx_Math" display="inline" id="S4.T1.8.2.1.m1.1"><semantics id="S4.T1.8.2.1.m1.1a"><mrow id="S4.T1.8.2.1.m1.1.1" xref="S4.T1.8.2.1.m1.1.1.cmml"><mi id="S4.T1.8.2.1.m1.1.1.2" xref="S4.T1.8.2.1.m1.1.1.2.cmml">r</mi><mo id="S4.T1.8.2.1.m1.1.1.1" xref="S4.T1.8.2.1.m1.1.1.1.cmml">≤</mo><msup id="S4.T1.8.2.1.m1.1.1.3" xref="S4.T1.8.2.1.m1.1.1.3.cmml"><mn id="S4.T1.8.2.1.m1.1.1.3.2" xref="S4.T1.8.2.1.m1.1.1.3.2.cmml">2</mn><mn id="S4.T1.8.2.1.m1.1.1.3.3" xref="S4.T1.8.2.1.m1.1.1.3.3.cmml">15</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.2.1.m1.1b"><apply id="S4.T1.8.2.1.m1.1.1.cmml" xref="S4.T1.8.2.1.m1.1.1"><leq id="S4.T1.8.2.1.m1.1.1.1.cmml" xref="S4.T1.8.2.1.m1.1.1.1"></leq><ci id="S4.T1.8.2.1.m1.1.1.2.cmml" xref="S4.T1.8.2.1.m1.1.1.2">𝑟</ci><apply id="S4.T1.8.2.1.m1.1.1.3.cmml" xref="S4.T1.8.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.8.2.1.m1.1.1.3.1.cmml" xref="S4.T1.8.2.1.m1.1.1.3">superscript</csymbol><cn id="S4.T1.8.2.1.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.8.2.1.m1.1.1.3.2">2</cn><cn id="S4.T1.8.2.1.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.8.2.1.m1.1.1.3.3">15</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.2.1.m1.1c">r\leq 2^{15}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.2.1.m1.1d">italic_r ≤ 2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT</annotation></semantics></math><math alttext="r\geq 1" class="ltx_Math" display="inline" id="S4.T1.9.3.2.m2.1"><semantics id="S4.T1.9.3.2.m2.1a"><mrow id="S4.T1.9.3.2.m2.1.1" xref="S4.T1.9.3.2.m2.1.1.cmml"><mi id="S4.T1.9.3.2.m2.1.1.2" xref="S4.T1.9.3.2.m2.1.1.2.cmml">r</mi><mo id="S4.T1.9.3.2.m2.1.1.1" xref="S4.T1.9.3.2.m2.1.1.1.cmml">≥</mo><mn id="S4.T1.9.3.2.m2.1.1.3" xref="S4.T1.9.3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.9.3.2.m2.1b"><apply id="S4.T1.9.3.2.m2.1.1.cmml" xref="S4.T1.9.3.2.m2.1.1"><geq id="S4.T1.9.3.2.m2.1.1.1.cmml" xref="S4.T1.9.3.2.m2.1.1.1"></geq><ci id="S4.T1.9.3.2.m2.1.1.2.cmml" xref="S4.T1.9.3.2.m2.1.1.2">𝑟</ci><cn id="S4.T1.9.3.2.m2.1.1.3.cmml" type="integer" xref="S4.T1.9.3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.3.2.m2.1c">r\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.3.2.m2.1d">italic_r ≥ 1</annotation></semantics></math> active destinations<sup class="ltx_sup" id="S4.T1.10.4.3.2">∗</sup>
</th>
<td class="ltx_td ltx_align_left" id="S4.T1.11.5.4">
<span class="ltx_ERROR undefined" id="S4.T1.11.5.4.1">\replaced</span><math alttext="r" class="ltx_Math" display="inline" id="S4.T1.11.5.4.m1.1"><semantics id="S4.T1.11.5.4.m1.1a"><mi id="S4.T1.11.5.4.m1.1.1" xref="S4.T1.11.5.4.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.T1.11.5.4.m1.1b"><ci id="S4.T1.11.5.4.m1.1.1.cmml" xref="S4.T1.11.5.4.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.5.4.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.5.4.m1.1d">italic_r</annotation></semantics></math> 32-bit timesN/A</td>
<td class="ltx_td ltx_align_left" id="S4.T1.12.6.5">
<span class="ltx_ERROR undefined" id="S4.T1.12.6.5.1">\replaced</span><math alttext="\leq 192~{}\text{KiB}^{*}" class="ltx_Math" display="inline" id="S4.T1.12.6.5.m1.1"><semantics id="S4.T1.12.6.5.m1.1a"><mrow id="S4.T1.12.6.5.m1.1.1" xref="S4.T1.12.6.5.m1.1.1.cmml"><mi id="S4.T1.12.6.5.m1.1.1.2" xref="S4.T1.12.6.5.m1.1.1.2.cmml"></mi><mo id="S4.T1.12.6.5.m1.1.1.1" xref="S4.T1.12.6.5.m1.1.1.1.cmml">≤</mo><mrow id="S4.T1.12.6.5.m1.1.1.3" xref="S4.T1.12.6.5.m1.1.1.3.cmml"><mn id="S4.T1.12.6.5.m1.1.1.3.2" xref="S4.T1.12.6.5.m1.1.1.3.2.cmml">192</mn><mo id="S4.T1.12.6.5.m1.1.1.3.1" lspace="0.330em" xref="S4.T1.12.6.5.m1.1.1.3.1.cmml">⁢</mo><msup id="S4.T1.12.6.5.m1.1.1.3.3" xref="S4.T1.12.6.5.m1.1.1.3.3.cmml"><mtext id="S4.T1.12.6.5.m1.1.1.3.3.2" xref="S4.T1.12.6.5.m1.1.1.3.3.2a.cmml">KiB</mtext><mo id="S4.T1.12.6.5.m1.1.1.3.3.3" xref="S4.T1.12.6.5.m1.1.1.3.3.3.cmml">∗</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.12.6.5.m1.1b"><apply id="S4.T1.12.6.5.m1.1.1.cmml" xref="S4.T1.12.6.5.m1.1.1"><leq id="S4.T1.12.6.5.m1.1.1.1.cmml" xref="S4.T1.12.6.5.m1.1.1.1"></leq><csymbol cd="latexml" id="S4.T1.12.6.5.m1.1.1.2.cmml" xref="S4.T1.12.6.5.m1.1.1.2">absent</csymbol><apply id="S4.T1.12.6.5.m1.1.1.3.cmml" xref="S4.T1.12.6.5.m1.1.1.3"><times id="S4.T1.12.6.5.m1.1.1.3.1.cmml" xref="S4.T1.12.6.5.m1.1.1.3.1"></times><cn id="S4.T1.12.6.5.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.12.6.5.m1.1.1.3.2">192</cn><apply id="S4.T1.12.6.5.m1.1.1.3.3.cmml" xref="S4.T1.12.6.5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.T1.12.6.5.m1.1.1.3.3.1.cmml" xref="S4.T1.12.6.5.m1.1.1.3.3">superscript</csymbol><ci id="S4.T1.12.6.5.m1.1.1.3.3.2a.cmml" xref="S4.T1.12.6.5.m1.1.1.3.3.2"><mtext id="S4.T1.12.6.5.m1.1.1.3.3.2.cmml" xref="S4.T1.12.6.5.m1.1.1.3.3.2">KiB</mtext></ci><times id="S4.T1.12.6.5.m1.1.1.3.3.3.cmml" xref="S4.T1.12.6.5.m1.1.1.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.6.5.m1.1c">\leq 192~{}\text{KiB}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.6.5.m1.1d">≤ 192 KiB start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>Unbounded</td>
</tr>
<tr class="ltx_tr" id="S4.T1.14.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.14.8.3">Per-Bucket (Linux)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.13.7.1">
<math alttext="r\in[2^{11},2^{18}]" class="ltx_Math" display="inline" id="S4.T1.13.7.1.m1.2"><semantics id="S4.T1.13.7.1.m1.2a"><mrow id="S4.T1.13.7.1.m1.2.2" xref="S4.T1.13.7.1.m1.2.2.cmml"><mi id="S4.T1.13.7.1.m1.2.2.4" xref="S4.T1.13.7.1.m1.2.2.4.cmml">r</mi><mo id="S4.T1.13.7.1.m1.2.2.3" xref="S4.T1.13.7.1.m1.2.2.3.cmml">∈</mo><mrow id="S4.T1.13.7.1.m1.2.2.2.2" xref="S4.T1.13.7.1.m1.2.2.2.3.cmml"><mo id="S4.T1.13.7.1.m1.2.2.2.2.3" stretchy="false" xref="S4.T1.13.7.1.m1.2.2.2.3.cmml">[</mo><msup id="S4.T1.13.7.1.m1.1.1.1.1.1" xref="S4.T1.13.7.1.m1.1.1.1.1.1.cmml"><mn id="S4.T1.13.7.1.m1.1.1.1.1.1.2" xref="S4.T1.13.7.1.m1.1.1.1.1.1.2.cmml">2</mn><mn id="S4.T1.13.7.1.m1.1.1.1.1.1.3" xref="S4.T1.13.7.1.m1.1.1.1.1.1.3.cmml">11</mn></msup><mo id="S4.T1.13.7.1.m1.2.2.2.2.4" xref="S4.T1.13.7.1.m1.2.2.2.3.cmml">,</mo><msup id="S4.T1.13.7.1.m1.2.2.2.2.2" xref="S4.T1.13.7.1.m1.2.2.2.2.2.cmml"><mn id="S4.T1.13.7.1.m1.2.2.2.2.2.2" xref="S4.T1.13.7.1.m1.2.2.2.2.2.2.cmml">2</mn><mn id="S4.T1.13.7.1.m1.2.2.2.2.2.3" xref="S4.T1.13.7.1.m1.2.2.2.2.2.3.cmml">18</mn></msup><mo id="S4.T1.13.7.1.m1.2.2.2.2.5" stretchy="false" xref="S4.T1.13.7.1.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.13.7.1.m1.2b"><apply id="S4.T1.13.7.1.m1.2.2.cmml" xref="S4.T1.13.7.1.m1.2.2"><in id="S4.T1.13.7.1.m1.2.2.3.cmml" xref="S4.T1.13.7.1.m1.2.2.3"></in><ci id="S4.T1.13.7.1.m1.2.2.4.cmml" xref="S4.T1.13.7.1.m1.2.2.4">𝑟</ci><interval closure="closed" id="S4.T1.13.7.1.m1.2.2.2.3.cmml" xref="S4.T1.13.7.1.m1.2.2.2.2"><apply id="S4.T1.13.7.1.m1.1.1.1.1.1.cmml" xref="S4.T1.13.7.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.T1.13.7.1.m1.1.1.1.1.1.1.cmml" xref="S4.T1.13.7.1.m1.1.1.1.1.1">superscript</csymbol><cn id="S4.T1.13.7.1.m1.1.1.1.1.1.2.cmml" type="integer" xref="S4.T1.13.7.1.m1.1.1.1.1.1.2">2</cn><cn id="S4.T1.13.7.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.T1.13.7.1.m1.1.1.1.1.1.3">11</cn></apply><apply id="S4.T1.13.7.1.m1.2.2.2.2.2.cmml" xref="S4.T1.13.7.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.T1.13.7.1.m1.2.2.2.2.2.1.cmml" xref="S4.T1.13.7.1.m1.2.2.2.2.2">superscript</csymbol><cn id="S4.T1.13.7.1.m1.2.2.2.2.2.2.cmml" type="integer" xref="S4.T1.13.7.1.m1.2.2.2.2.2.2">2</cn><cn id="S4.T1.13.7.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S4.T1.13.7.1.m1.2.2.2.2.2.3">18</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.7.1.m1.2c">r\in[2^{11},2^{18}]</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.7.1.m1.2d">italic_r ∈ [ 2 start_POSTSUPERSCRIPT 11 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT 18 end_POSTSUPERSCRIPT ]</annotation></semantics></math> buckets</th>
<td class="ltx_td ltx_align_left" id="S4.T1.14.8.2">
<math alttext="r" class="ltx_Math" display="inline" id="S4.T1.14.8.2.m1.1"><semantics id="S4.T1.14.8.2.m1.1a"><mi id="S4.T1.14.8.2.m1.1.1" xref="S4.T1.14.8.2.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.T1.14.8.2.m1.1b"><ci id="S4.T1.14.8.2.m1.1.1.cmml" xref="S4.T1.14.8.2.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.8.2.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.T1.14.8.2.m1.1d">italic_r</annotation></semantics></math> 32-bit times</td>
<td class="ltx_td ltx_align_left" id="S4.T1.14.8.4">
<span class="ltx_ERROR undefined" id="S4.T1.14.8.4.1">\added</span>12 <span class="ltx_text" id="S4.T1.14.8.4.2">KiB</span>–1.5 <span class="ltx_text" id="S4.T1.14.8.4.3">MiB</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.16.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.16.10.3">PRNG (searchable queue)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.9.1">
<math alttext="k\in[2^{12},2^{15}]" class="ltx_Math" display="inline" id="S4.T1.15.9.1.m1.2"><semantics id="S4.T1.15.9.1.m1.2a"><mrow id="S4.T1.15.9.1.m1.2.2" xref="S4.T1.15.9.1.m1.2.2.cmml"><mi id="S4.T1.15.9.1.m1.2.2.4" xref="S4.T1.15.9.1.m1.2.2.4.cmml">k</mi><mo id="S4.T1.15.9.1.m1.2.2.3" xref="S4.T1.15.9.1.m1.2.2.3.cmml">∈</mo><mrow id="S4.T1.15.9.1.m1.2.2.2.2" xref="S4.T1.15.9.1.m1.2.2.2.3.cmml"><mo id="S4.T1.15.9.1.m1.2.2.2.2.3" stretchy="false" xref="S4.T1.15.9.1.m1.2.2.2.3.cmml">[</mo><msup id="S4.T1.15.9.1.m1.1.1.1.1.1" xref="S4.T1.15.9.1.m1.1.1.1.1.1.cmml"><mn id="S4.T1.15.9.1.m1.1.1.1.1.1.2" xref="S4.T1.15.9.1.m1.1.1.1.1.1.2.cmml">2</mn><mn id="S4.T1.15.9.1.m1.1.1.1.1.1.3" xref="S4.T1.15.9.1.m1.1.1.1.1.1.3.cmml">12</mn></msup><mo id="S4.T1.15.9.1.m1.2.2.2.2.4" xref="S4.T1.15.9.1.m1.2.2.2.3.cmml">,</mo><msup id="S4.T1.15.9.1.m1.2.2.2.2.2" xref="S4.T1.15.9.1.m1.2.2.2.2.2.cmml"><mn id="S4.T1.15.9.1.m1.2.2.2.2.2.2" xref="S4.T1.15.9.1.m1.2.2.2.2.2.2.cmml">2</mn><mn id="S4.T1.15.9.1.m1.2.2.2.2.2.3" xref="S4.T1.15.9.1.m1.2.2.2.2.2.3.cmml">15</mn></msup><mo id="S4.T1.15.9.1.m1.2.2.2.2.5" stretchy="false" xref="S4.T1.15.9.1.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.15.9.1.m1.2b"><apply id="S4.T1.15.9.1.m1.2.2.cmml" xref="S4.T1.15.9.1.m1.2.2"><in id="S4.T1.15.9.1.m1.2.2.3.cmml" xref="S4.T1.15.9.1.m1.2.2.3"></in><ci id="S4.T1.15.9.1.m1.2.2.4.cmml" xref="S4.T1.15.9.1.m1.2.2.4">𝑘</ci><interval closure="closed" id="S4.T1.15.9.1.m1.2.2.2.3.cmml" xref="S4.T1.15.9.1.m1.2.2.2.2"><apply id="S4.T1.15.9.1.m1.1.1.1.1.1.cmml" xref="S4.T1.15.9.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.T1.15.9.1.m1.1.1.1.1.1.1.cmml" xref="S4.T1.15.9.1.m1.1.1.1.1.1">superscript</csymbol><cn id="S4.T1.15.9.1.m1.1.1.1.1.1.2.cmml" type="integer" xref="S4.T1.15.9.1.m1.1.1.1.1.1.2">2</cn><cn id="S4.T1.15.9.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.T1.15.9.1.m1.1.1.1.1.1.3">12</cn></apply><apply id="S4.T1.15.9.1.m1.2.2.2.2.2.cmml" xref="S4.T1.15.9.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.T1.15.9.1.m1.2.2.2.2.2.1.cmml" xref="S4.T1.15.9.1.m1.2.2.2.2.2">superscript</csymbol><cn id="S4.T1.15.9.1.m1.2.2.2.2.2.2.cmml" type="integer" xref="S4.T1.15.9.1.m1.2.2.2.2.2.2">2</cn><cn id="S4.T1.15.9.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S4.T1.15.9.1.m1.2.2.2.2.2.3">15</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.9.1.m1.2c">k\in[2^{12},2^{15}]</annotation><annotation encoding="application/x-llamapun" id="S4.T1.15.9.1.m1.2d">italic_k ∈ [ 2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT ]</annotation></semantics></math> reserved IPIDs</th>
<td class="ltx_td ltx_align_left" id="S4.T1.16.10.2">
<math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.T1.16.10.2.m1.1"><semantics id="S4.T1.16.10.2.m1.1a"><msup id="S4.T1.16.10.2.m1.1.1" xref="S4.T1.16.10.2.m1.1.1.cmml"><mn id="S4.T1.16.10.2.m1.1.1.2" xref="S4.T1.16.10.2.m1.1.1.2.cmml">2</mn><mn id="S4.T1.16.10.2.m1.1.1.3" xref="S4.T1.16.10.2.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T1.16.10.2.m1.1b"><apply id="S4.T1.16.10.2.m1.1.1.cmml" xref="S4.T1.16.10.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.16.10.2.m1.1.1.1.cmml" xref="S4.T1.16.10.2.m1.1.1">superscript</csymbol><cn id="S4.T1.16.10.2.m1.1.1.2.cmml" type="integer" xref="S4.T1.16.10.2.m1.1.1.2">2</cn><cn id="S4.T1.16.10.2.m1.1.1.3.cmml" type="integer" xref="S4.T1.16.10.2.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.10.2.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.16.10.2.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> lookup bits</td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.10.4">16–72 <span class="ltx_text" id="S4.T1.16.10.4.1">KiB</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.18.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.18.12.3">PRNG (iterated shuffle)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.17.11.1">
<math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.T1.17.11.1.m1.1"><semantics id="S4.T1.17.11.1.m1.1a"><msup id="S4.T1.17.11.1.m1.1.1" xref="S4.T1.17.11.1.m1.1.1.cmml"><mn id="S4.T1.17.11.1.m1.1.1.2" xref="S4.T1.17.11.1.m1.1.1.2.cmml">2</mn><mn id="S4.T1.17.11.1.m1.1.1.3" xref="S4.T1.17.11.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T1.17.11.1.m1.1b"><apply id="S4.T1.17.11.1.m1.1.1.cmml" xref="S4.T1.17.11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.17.11.1.m1.1.1.1.cmml" xref="S4.T1.17.11.1.m1.1.1">superscript</csymbol><cn id="S4.T1.17.11.1.m1.1.1.2.cmml" type="integer" xref="S4.T1.17.11.1.m1.1.1.2">2</cn><cn id="S4.T1.17.11.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.17.11.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.11.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.17.11.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> IPIDs in shuffle</th>
<td class="ltx_td ltx_align_left" id="S4.T1.18.12.4">one 16-bit index</td>
<td class="ltx_td ltx_align_left" id="S4.T1.18.12.2">
<math alttext="\approx" class="ltx_Math" display="inline" id="S4.T1.18.12.2.m1.1"><semantics id="S4.T1.18.12.2.m1.1a"><mo id="S4.T1.18.12.2.m1.1.1" xref="S4.T1.18.12.2.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S4.T1.18.12.2.m1.1b"><approx id="S4.T1.18.12.2.m1.1.1.cmml" xref="S4.T1.18.12.2.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.12.2.m1.1c">\approx</annotation><annotation encoding="application/x-llamapun" id="S4.T1.18.12.2.m1.1d">≈</annotation></semantics></math> 128 KiB</td>
</tr>
<tr class="ltx_tr" id="S4.T1.18.15.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.18.15.3.1">
<span class="ltx_ERROR undefined" id="S4.T1.18.15.3.1.1">\added</span>PRNG (pure)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.18.15.3.2">
<span class="ltx_ERROR undefined" id="S4.T1.18.15.3.2.1">\added</span>N/A</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.18.15.3.3">
<span class="ltx_ERROR undefined" id="S4.T1.18.15.3.3.1">\added</span>N/A</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.18.15.3.4">
<span class="ltx_ERROR undefined" id="S4.T1.18.15.3.4.1">\added</span>None</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.11">For space complexity, we consider all data structures that a selection method stores between IPID requests (see Table <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.T1" title="Table 1 ‣ 4.4. Analyzing Performance ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">1</span></a>).
Globally incrementing selection stores a single 16-bit counter.
Per-connection and per-destination selection store one 16-bit counter per active connection or destination, respectively.
There are <math alttext="\sim" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><mo id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><csymbol cd="latexml" id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">∼</annotation></semantics></math>3.7 billion unreserved IP addresses and thus there could be at most as many destination counters; the maximum number of connection counters is even larger since connections also consider source and destination ports and protocol numbers.
In practice, Windows fixes a <span class="ltx_ERROR undefined" id="S4.SS4.p3.11.1">\replaced</span>purge threshold—<math alttext="2^{12}" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><msup id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml"><mn id="S4.SS4.p3.2.m2.1.1.2" xref="S4.SS4.p3.2.m2.1.1.2.cmml">2</mn><mn id="S4.SS4.p3.2.m2.1.1.3" xref="S4.SS4.p3.2.m2.1.1.3.cmml">12</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">superscript</csymbol><cn id="S4.SS4.p3.2.m2.1.1.2.cmml" type="integer" xref="S4.SS4.p3.2.m2.1.1.2">2</cn><cn id="S4.SS4.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS4.p3.2.m2.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">2^{12}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math> destination counters in Windows 10 and <math alttext="2^{15}" class="ltx_Math" display="inline" id="S4.SS4.p3.3.m3.1"><semantics id="S4.SS4.p3.3.m3.1a"><msup id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml"><mn id="S4.SS4.p3.3.m3.1.1.2" xref="S4.SS4.p3.3.m3.1.1.2.cmml">2</mn><mn id="S4.SS4.p3.3.m3.1.1.3" xref="S4.SS4.p3.3.m3.1.1.3.cmml">15</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><apply id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.1.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1">superscript</csymbol><cn id="S4.SS4.p3.3.m3.1.1.2.cmml" type="integer" xref="S4.SS4.p3.3.m3.1.1.2">2</cn><cn id="S4.SS4.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS4.p3.3.m3.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">2^{15}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.3.m3.1d">2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT</annotation></semantics></math> in Windows Server—that puts a soft limit“large” upper limit on the number of destination counters <span class="ltx_ERROR undefined" id="S4.SS4.p3.11.2">\added</span>and 32-bit last access timestamps it stores before purging stale counters, <span class="ltx_ERROR undefined" id="S4.SS4.p3.11.3">\added</span>though this limit can briefly be surpassed between purge sequences <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib37" title="">2024</a>)</cite>.
Linux treats connection counters as acceptably small members of its socket data structures, and implements per-bucket selection by storing one 16-bit counter and one 32-bit last access timestamp for each of its <math alttext="2^{11}" class="ltx_Math" display="inline" id="S4.SS4.p3.4.m4.1"><semantics id="S4.SS4.p3.4.m4.1a"><msup id="S4.SS4.p3.4.m4.1.1" xref="S4.SS4.p3.4.m4.1.1.cmml"><mn id="S4.SS4.p3.4.m4.1.1.2" xref="S4.SS4.p3.4.m4.1.1.2.cmml">2</mn><mn id="S4.SS4.p3.4.m4.1.1.3" xref="S4.SS4.p3.4.m4.1.1.3.cmml">11</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.4.m4.1b"><apply id="S4.SS4.p3.4.m4.1.1.cmml" xref="S4.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.4.m4.1.1.1.cmml" xref="S4.SS4.p3.4.m4.1.1">superscript</csymbol><cn id="S4.SS4.p3.4.m4.1.1.2.cmml" type="integer" xref="S4.SS4.p3.4.m4.1.1.2">2</cn><cn id="S4.SS4.p3.4.m4.1.1.3.cmml" type="integer" xref="S4.SS4.p3.4.m4.1.1.3">11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.4.m4.1c">2^{11}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.4.m4.1d">2 start_POSTSUPERSCRIPT 11 end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="2^{18}" class="ltx_Math" display="inline" id="S4.SS4.p3.5.m5.1"><semantics id="S4.SS4.p3.5.m5.1a"><msup id="S4.SS4.p3.5.m5.1.1" xref="S4.SS4.p3.5.m5.1.1.cmml"><mn id="S4.SS4.p3.5.m5.1.1.2" xref="S4.SS4.p3.5.m5.1.1.2.cmml">2</mn><mn id="S4.SS4.p3.5.m5.1.1.3" xref="S4.SS4.p3.5.m5.1.1.3.cmml">18</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.5.m5.1b"><apply id="S4.SS4.p3.5.m5.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.5.m5.1.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1">superscript</csymbol><cn id="S4.SS4.p3.5.m5.1.1.2.cmml" type="integer" xref="S4.SS4.p3.5.m5.1.1.2">2</cn><cn id="S4.SS4.p3.5.m5.1.1.3.cmml" type="integer" xref="S4.SS4.p3.5.m5.1.1.3">18</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.5.m5.1c">2^{18}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.5.m5.1d">2 start_POSTSUPERSCRIPT 18 end_POSTSUPERSCRIPT</annotation></semantics></math> buckets.
PRNG selection using a searchable queue of size <math alttext="k\in[2^{12},2^{15}]" class="ltx_Math" display="inline" id="S4.SS4.p3.6.m6.2"><semantics id="S4.SS4.p3.6.m6.2a"><mrow id="S4.SS4.p3.6.m6.2.2" xref="S4.SS4.p3.6.m6.2.2.cmml"><mi id="S4.SS4.p3.6.m6.2.2.4" xref="S4.SS4.p3.6.m6.2.2.4.cmml">k</mi><mo id="S4.SS4.p3.6.m6.2.2.3" xref="S4.SS4.p3.6.m6.2.2.3.cmml">∈</mo><mrow id="S4.SS4.p3.6.m6.2.2.2.2" xref="S4.SS4.p3.6.m6.2.2.2.3.cmml"><mo id="S4.SS4.p3.6.m6.2.2.2.2.3" stretchy="false" xref="S4.SS4.p3.6.m6.2.2.2.3.cmml">[</mo><msup id="S4.SS4.p3.6.m6.1.1.1.1.1" xref="S4.SS4.p3.6.m6.1.1.1.1.1.cmml"><mn id="S4.SS4.p3.6.m6.1.1.1.1.1.2" xref="S4.SS4.p3.6.m6.1.1.1.1.1.2.cmml">2</mn><mn id="S4.SS4.p3.6.m6.1.1.1.1.1.3" xref="S4.SS4.p3.6.m6.1.1.1.1.1.3.cmml">12</mn></msup><mo id="S4.SS4.p3.6.m6.2.2.2.2.4" xref="S4.SS4.p3.6.m6.2.2.2.3.cmml">,</mo><msup id="S4.SS4.p3.6.m6.2.2.2.2.2" xref="S4.SS4.p3.6.m6.2.2.2.2.2.cmml"><mn id="S4.SS4.p3.6.m6.2.2.2.2.2.2" xref="S4.SS4.p3.6.m6.2.2.2.2.2.2.cmml">2</mn><mn id="S4.SS4.p3.6.m6.2.2.2.2.2.3" xref="S4.SS4.p3.6.m6.2.2.2.2.2.3.cmml">15</mn></msup><mo id="S4.SS4.p3.6.m6.2.2.2.2.5" stretchy="false" xref="S4.SS4.p3.6.m6.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.6.m6.2b"><apply id="S4.SS4.p3.6.m6.2.2.cmml" xref="S4.SS4.p3.6.m6.2.2"><in id="S4.SS4.p3.6.m6.2.2.3.cmml" xref="S4.SS4.p3.6.m6.2.2.3"></in><ci id="S4.SS4.p3.6.m6.2.2.4.cmml" xref="S4.SS4.p3.6.m6.2.2.4">𝑘</ci><interval closure="closed" id="S4.SS4.p3.6.m6.2.2.2.3.cmml" xref="S4.SS4.p3.6.m6.2.2.2.2"><apply id="S4.SS4.p3.6.m6.1.1.1.1.1.cmml" xref="S4.SS4.p3.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS4.p3.6.m6.1.1.1.1.1">superscript</csymbol><cn id="S4.SS4.p3.6.m6.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS4.p3.6.m6.1.1.1.1.1.2">2</cn><cn id="S4.SS4.p3.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS4.p3.6.m6.1.1.1.1.1.3">12</cn></apply><apply id="S4.SS4.p3.6.m6.2.2.2.2.2.cmml" xref="S4.SS4.p3.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p3.6.m6.2.2.2.2.2.1.cmml" xref="S4.SS4.p3.6.m6.2.2.2.2.2">superscript</csymbol><cn id="S4.SS4.p3.6.m6.2.2.2.2.2.2.cmml" type="integer" xref="S4.SS4.p3.6.m6.2.2.2.2.2.2">2</cn><cn id="S4.SS4.p3.6.m6.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS4.p3.6.m6.2.2.2.2.2.3">15</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.6.m6.2c">k\in[2^{12},2^{15}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.6.m6.2d">italic_k ∈ [ 2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT ]</annotation></semantics></math> stores the last <math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p3.7.m7.1"><semantics id="S4.SS4.p3.7.m7.1a"><mi id="S4.SS4.p3.7.m7.1.1" xref="S4.SS4.p3.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.7.m7.1b"><ci id="S4.SS4.p3.7.m7.1.1.cmml" xref="S4.SS4.p3.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.7.m7.1d">italic_k</annotation></semantics></math> IPID values generated by the PRNG, plus any data structure used to make searching fast; for example, FreeBSD and XNU search their queues in constant time by storing an array of <math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.SS4.p3.8.m8.1"><semantics id="S4.SS4.p3.8.m8.1a"><msup id="S4.SS4.p3.8.m8.1.1" xref="S4.SS4.p3.8.m8.1.1.cmml"><mn id="S4.SS4.p3.8.m8.1.1.2" xref="S4.SS4.p3.8.m8.1.1.2.cmml">2</mn><mn id="S4.SS4.p3.8.m8.1.1.3" xref="S4.SS4.p3.8.m8.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.8.m8.1b"><apply id="S4.SS4.p3.8.m8.1.1.cmml" xref="S4.SS4.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.8.m8.1.1.1.cmml" xref="S4.SS4.p3.8.m8.1.1">superscript</csymbol><cn id="S4.SS4.p3.8.m8.1.1.2.cmml" type="integer" xref="S4.SS4.p3.8.m8.1.1.2">2</cn><cn id="S4.SS4.p3.8.m8.1.1.3.cmml" type="integer" xref="S4.SS4.p3.8.m8.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.8.m8.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.8.m8.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> bits where the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS4.p3.9.m9.1"><semantics id="S4.SS4.p3.9.m9.1a"><mi id="S4.SS4.p3.9.m9.1.1" xref="S4.SS4.p3.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.9.m9.1b"><ci id="S4.SS4.p3.9.m9.1.1.cmml" xref="S4.SS4.p3.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.9.m9.1d">italic_i</annotation></semantics></math>-th bit is 1 if and only if IPID <math alttext="i" class="ltx_Math" display="inline" id="S4.SS4.p3.10.m10.1"><semantics id="S4.SS4.p3.10.m10.1a"><mi id="S4.SS4.p3.10.m10.1.1" xref="S4.SS4.p3.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.10.m10.1b"><ci id="S4.SS4.p3.10.m10.1.1.cmml" xref="S4.SS4.p3.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.10.m10.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.10.m10.1d">italic_i</annotation></semantics></math> is currently in the queue.
<span class="ltx_ERROR undefined" id="S4.SS4.p3.11.4">\deleted</span>Finally, PRNG selection using the iterated Knuth shuffle stores the current permutation of all <math alttext="2^{16}" class="ltx_Math" display="inline" id="S4.SS4.p3.11.m11.1"><semantics id="S4.SS4.p3.11.m11.1a"><msup id="S4.SS4.p3.11.m11.1.1" xref="S4.SS4.p3.11.m11.1.1.cmml"><mn id="S4.SS4.p3.11.m11.1.1.2" xref="S4.SS4.p3.11.m11.1.1.2.cmml">2</mn><mn id="S4.SS4.p3.11.m11.1.1.3" xref="S4.SS4.p3.11.m11.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.11.m11.1b"><apply id="S4.SS4.p3.11.m11.1.1.cmml" xref="S4.SS4.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.11.m11.1.1.1.cmml" xref="S4.SS4.p3.11.m11.1.1">superscript</csymbol><cn id="S4.SS4.p3.11.m11.1.1.2.cmml" type="integer" xref="S4.SS4.p3.11.m11.1.1.2">2</cn><cn id="S4.SS4.p3.11.m11.1.1.3.cmml" type="integer" xref="S4.SS4.p3.11.m11.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.11.m11.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.11.m11.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> IPID values plus one 16-bit index for the next value in the permutation.
<span class="ltx_ERROR undefined" id="S4.SS4.p3.11.5">\added</span>Finally, pure PRNG selection does not store any information between IPID requests other than the state of its PRNG.</p>
</div>
<div class="ltx_para" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1">Taken together, <span class="ltx_ERROR undefined" id="S4.SS4.p4.1.1">\replaced</span>pure PRNGglobally incrementing selection outperforms all but per-connection selection in terms of time and <span class="ltx_ERROR undefined" id="S4.SS4.p4.1.2">\replaced</span>does not use any memory beyond its PRNG stateuses the minimum possible amount of memory; <span class="ltx_ERROR undefined" id="S4.SS4.p4.1.3">\added</span>globally incrementing selection is the runner-up, outperforming the remaining methods while only using 2 bytes of memory.
Per-destination selection (with an upper limit on destination counters) and the <span class="ltx_ERROR undefined" id="S4.SS4.p4.1.4">\added</span>non-repeating PRNG-based methods have moderate memory footprints, but their global locks are prohibitive performance bottlenecks that cannot be removed without threatening their correctness or security guarantees.
Finally, per-bucket selection achieves competitive IPID request times at the cost of potentially large (but bounded) memory usage.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Recommendations</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Which IPID selection method is best?
As is the case for most worthwhile questions, it depends.
In this section, we synthesize insights from prior literature with the correctness, security, and performance evaluations of Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4" title="4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4</span></a> into concrete recommendations for IPID selection best practices.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Many have argued for avoiding fragmentation altogether by explicitly marking packets as atomic when possible <cite class="ltx_cite ltx_citemacro_citep">(Kent and Mogul, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib33" title="">1987</a>; Bellovin, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib6" title="">1989</a>; Gilad and Herzberg, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib23" title="">2011</a>; Herzberg and Shulman, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib28" title="">2013a</a>; Malhotra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib44" title="">2016</a>)</cite>, e.g., when packets are small or the path MTU is discovered as part of a TCP connection.
This best practice is already widely adopted.
All five OSes we reviewed make packets atomic <span class="ltx_ERROR undefined" id="S5.p2.1.1">\added</span>when possible, and 82.4% of packets in the CAIDA trace we used for benchmarking <cite class="ltx_cite ltx_citemacro_citep">(CAIDA, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib11" title="">2019</a>)</cite> and an estimated 99% of all network traffic is not fragmented <cite class="ltx_cite ltx_citemacro_citep">(Shannon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib58" title="">2002</a>)</cite>.</p>
</div>
<div class="ltx_theorem ltx_theorem_recommend" id="Thmrecommend1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Recommendation 1.</h6>
<div class="ltx_para" id="Thmrecommend1.p1">
<p class="ltx_p" id="Thmrecommend1.p1.3"><span class="ltx_text ltx_font_italic" id="Thmrecommend1.p1.3.3">Any IP packet that can avoid fragmentation (e.g., with a known path MTU) should be made atomic with <math alttext="\text{DF}=\textsc{true}" class="ltx_Math" display="inline" id="Thmrecommend1.p1.1.1.m1.1"><semantics id="Thmrecommend1.p1.1.1.m1.1a"><mrow id="Thmrecommend1.p1.1.1.m1.1.1" xref="Thmrecommend1.p1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="Thmrecommend1.p1.1.1.m1.1.1.2" xref="Thmrecommend1.p1.1.1.m1.1.1.2a.cmml">DF</mtext><mo id="Thmrecommend1.p1.1.1.m1.1.1.1" xref="Thmrecommend1.p1.1.1.m1.1.1.1.cmml">=</mo><mtext class="ltx_font_smallcaps" id="Thmrecommend1.p1.1.1.m1.1.1.3" xref="Thmrecommend1.p1.1.1.m1.1.1.3a.cmml">true</mtext></mrow><annotation-xml encoding="MathML-Content" id="Thmrecommend1.p1.1.1.m1.1b"><apply id="Thmrecommend1.p1.1.1.m1.1.1.cmml" xref="Thmrecommend1.p1.1.1.m1.1.1"><eq id="Thmrecommend1.p1.1.1.m1.1.1.1.cmml" xref="Thmrecommend1.p1.1.1.m1.1.1.1"></eq><ci id="Thmrecommend1.p1.1.1.m1.1.1.2a.cmml" xref="Thmrecommend1.p1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_italic" id="Thmrecommend1.p1.1.1.m1.1.1.2.cmml" xref="Thmrecommend1.p1.1.1.m1.1.1.2">DF</mtext></ci><ci id="Thmrecommend1.p1.1.1.m1.1.1.3a.cmml" xref="Thmrecommend1.p1.1.1.m1.1.1.3"><mtext class="ltx_font_smallcaps" id="Thmrecommend1.p1.1.1.m1.1.1.3.cmml" xref="Thmrecommend1.p1.1.1.m1.1.1.3">true</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmrecommend1.p1.1.1.m1.1c">\text{DF}=\textsc{true}</annotation><annotation encoding="application/x-llamapun" id="Thmrecommend1.p1.1.1.m1.1d">DF = true</annotation></semantics></math>, <math alttext="\text{MF}=\textsc{false}" class="ltx_Math" display="inline" id="Thmrecommend1.p1.2.2.m2.1"><semantics id="Thmrecommend1.p1.2.2.m2.1a"><mrow id="Thmrecommend1.p1.2.2.m2.1.1" xref="Thmrecommend1.p1.2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="Thmrecommend1.p1.2.2.m2.1.1.2" xref="Thmrecommend1.p1.2.2.m2.1.1.2a.cmml">MF</mtext><mo id="Thmrecommend1.p1.2.2.m2.1.1.1" xref="Thmrecommend1.p1.2.2.m2.1.1.1.cmml">=</mo><mtext class="ltx_font_smallcaps" id="Thmrecommend1.p1.2.2.m2.1.1.3" xref="Thmrecommend1.p1.2.2.m2.1.1.3a.cmml">false</mtext></mrow><annotation-xml encoding="MathML-Content" id="Thmrecommend1.p1.2.2.m2.1b"><apply id="Thmrecommend1.p1.2.2.m2.1.1.cmml" xref="Thmrecommend1.p1.2.2.m2.1.1"><eq id="Thmrecommend1.p1.2.2.m2.1.1.1.cmml" xref="Thmrecommend1.p1.2.2.m2.1.1.1"></eq><ci id="Thmrecommend1.p1.2.2.m2.1.1.2a.cmml" xref="Thmrecommend1.p1.2.2.m2.1.1.2"><mtext class="ltx_mathvariant_italic" id="Thmrecommend1.p1.2.2.m2.1.1.2.cmml" xref="Thmrecommend1.p1.2.2.m2.1.1.2">MF</mtext></ci><ci id="Thmrecommend1.p1.2.2.m2.1.1.3a.cmml" xref="Thmrecommend1.p1.2.2.m2.1.1.3"><mtext class="ltx_font_smallcaps" id="Thmrecommend1.p1.2.2.m2.1.1.3.cmml" xref="Thmrecommend1.p1.2.2.m2.1.1.3">false</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmrecommend1.p1.2.2.m2.1c">\text{MF}=\textsc{false}</annotation><annotation encoding="application/x-llamapun" id="Thmrecommend1.p1.2.2.m2.1d">MF = false</annotation></semantics></math>, and <math alttext="\textit{Fragment Offset}=0" class="ltx_Math" display="inline" id="Thmrecommend1.p1.3.3.m3.1"><semantics id="Thmrecommend1.p1.3.3.m3.1a"><mrow id="Thmrecommend1.p1.3.3.m3.1.1" xref="Thmrecommend1.p1.3.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="Thmrecommend1.p1.3.3.m3.1.1.2" xref="Thmrecommend1.p1.3.3.m3.1.1.2a.cmml">Fragment Offset</mtext><mo id="Thmrecommend1.p1.3.3.m3.1.1.1" xref="Thmrecommend1.p1.3.3.m3.1.1.1.cmml">=</mo><mn id="Thmrecommend1.p1.3.3.m3.1.1.3" xref="Thmrecommend1.p1.3.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmrecommend1.p1.3.3.m3.1b"><apply id="Thmrecommend1.p1.3.3.m3.1.1.cmml" xref="Thmrecommend1.p1.3.3.m3.1.1"><eq id="Thmrecommend1.p1.3.3.m3.1.1.1.cmml" xref="Thmrecommend1.p1.3.3.m3.1.1.1"></eq><ci id="Thmrecommend1.p1.3.3.m3.1.1.2a.cmml" xref="Thmrecommend1.p1.3.3.m3.1.1.2"><mtext class="ltx_mathvariant_italic" id="Thmrecommend1.p1.3.3.m3.1.1.2.cmml" xref="Thmrecommend1.p1.3.3.m3.1.1.2">Fragment Offset</mtext></ci><cn id="Thmrecommend1.p1.3.3.m3.1.1.3.cmml" type="integer" xref="Thmrecommend1.p1.3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmrecommend1.p1.3.3.m3.1c">\textit{Fragment Offset}=0</annotation><annotation encoding="application/x-llamapun" id="Thmrecommend1.p1.3.3.m3.1d">Fragment Offset = 0</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">But making packets atomic does not obviate the question of how their IPIDs should be assigned.
RFC 6864 <cite class="ltx_cite ltx_citemacro_citep">(Touch, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib60" title="">2013</a>)</cite> states that an atomic packet’s IPID can be any value and should be ignored by subsequent machines.
This latitude presents a previously unleveraged opportunity to secure not only the atomic packets—e.g., in the case of forced fragmentation (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2" title="3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.2</span></a>)—but also the packets that may not be able to avoid fragmentation, such as DNS and QUIC traffic sent via UDP.
As we saw in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4" title="4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4</span></a>, the security and performance of various IPID selection methods depend on the rate <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.p3.1.m1.1"><semantics id="S5.p3.1.m1.1a"><mi id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><ci id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.p3.1.m1.1d">italic_λ</annotation></semantics></math> of IPID assignment.
Choosing whether to assign IPIDs to atomic packets using a fixed value (as FreeBSD, macOS, and Linux do), a dedicated selection method (as Linux does), or the same selection method as for non-atomic packets (as OpenBSD does) changes those methods’ effective IPID assignment rates, thus also changing their expected security and performance.</p>
</div>
<div class="ltx_para" id="S5.p4">
<p class="ltx_p" id="S5.p4.1">We propose a new approach to IPID selection based on user choice instead of OS developer hard-coding.
Our analyses in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4" title="4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4</span></a> showed that although there is no universally “best” IPID selection method for every use case across all three dimensions of correctness, security, and performance, different methods achieve desirable tradeoffs for specific ranges of outgoing traffic.
Thus, in this new approach, OSes would implement several IPID selection methods and expose this choice as a network setting.
Users or system administrators would then estimate their rates of traffic to determine their use case and choose methods that best suit their needs, as we describe below.</p>
</div>
<div class="ltx_theorem ltx_theorem_recommend" id="Thmrecommend2">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Recommendation 2.</h6>
<div class="ltx_para" id="Thmrecommend2.p1">
<p class="ltx_p" id="Thmrecommend2.p1.1"><span class="ltx_text ltx_font_italic" id="Thmrecommend2.p1.1.1">OS implementations should make IPID selection configurable (e.g., as a network setting), enabling end users and system administrators to choose selection methods for their connection-bound and non-connection-bound packets.
Per-connection selection for connection-bound traffic and per-bucket selection for all other traffic can be used as the default configuration.</span></p>
</div>
</div>
<figure class="ltx_figure" id="S5.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="473" id="S5.F9.g1" src="x10.png" width="498"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F9.7.3.1" style="font-size:90%;">Figure 9</span>. </span><span class="ltx_text ltx_font_italic" id="S5.F9.4.2" style="font-size:90%;">Recommended IPID Selection Method(s) by Use Case.<span class="ltx_text ltx_font_upright" id="S5.F9.4.2.2">
Depending on a machine’s rates of total outgoing packets <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.F9.3.1.1.m1.1"><semantics id="S5.F9.3.1.1.m1.1b"><mi id="S5.F9.3.1.1.m1.1.1" xref="S5.F9.3.1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F9.3.1.1.m1.1c"><ci id="S5.F9.3.1.1.m1.1.1.cmml" xref="S5.F9.3.1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F9.3.1.1.m1.1d">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.F9.3.1.1.m1.1e">italic_λ</annotation></semantics></math> and non-connection-bound (non-CB) packets <math alttext="\lambda_{n}" class="ltx_Math" display="inline" id="S5.F9.4.2.2.m2.1"><semantics id="S5.F9.4.2.2.m2.1b"><msub id="S5.F9.4.2.2.m2.1.1" xref="S5.F9.4.2.2.m2.1.1.cmml"><mi id="S5.F9.4.2.2.m2.1.1.2" xref="S5.F9.4.2.2.m2.1.1.2.cmml">λ</mi><mi id="S5.F9.4.2.2.m2.1.1.3" xref="S5.F9.4.2.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F9.4.2.2.m2.1c"><apply id="S5.F9.4.2.2.m2.1.1.cmml" xref="S5.F9.4.2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.F9.4.2.2.m2.1.1.1.cmml" xref="S5.F9.4.2.2.m2.1.1">subscript</csymbol><ci id="S5.F9.4.2.2.m2.1.1.2.cmml" xref="S5.F9.4.2.2.m2.1.1.2">𝜆</ci><ci id="S5.F9.4.2.2.m2.1.1.3.cmml" xref="S5.F9.4.2.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F9.4.2.2.m2.1d">\lambda_{n}</annotation><annotation encoding="application/x-llamapun" id="S5.F9.4.2.2.m2.1e">italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, globally incrementing (dark blue), per-bucket (teal), or PRNG-based selection (orange) may provide the best correctness-security-performance tradeoff.
Connection-bound (CB) packets can be handled separately with per-connection selection (white hatching) or combined with the rest depending on what provides the best tradeoffs.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S5.p5">
<p class="ltx_p" id="S5.p5.4">Suppose, then, that an end user or system administrator can estimate their Poisson outgoing packet rate as <math alttext="\lambda=\lambda_{c}+\lambda_{n}" class="ltx_Math" display="inline" id="S5.p5.1.m1.1"><semantics id="S5.p5.1.m1.1a"><mrow id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml"><mi id="S5.p5.1.m1.1.1.2" xref="S5.p5.1.m1.1.1.2.cmml">λ</mi><mo id="S5.p5.1.m1.1.1.1" xref="S5.p5.1.m1.1.1.1.cmml">=</mo><mrow id="S5.p5.1.m1.1.1.3" xref="S5.p5.1.m1.1.1.3.cmml"><msub id="S5.p5.1.m1.1.1.3.2" xref="S5.p5.1.m1.1.1.3.2.cmml"><mi id="S5.p5.1.m1.1.1.3.2.2" xref="S5.p5.1.m1.1.1.3.2.2.cmml">λ</mi><mi id="S5.p5.1.m1.1.1.3.2.3" xref="S5.p5.1.m1.1.1.3.2.3.cmml">c</mi></msub><mo id="S5.p5.1.m1.1.1.3.1" xref="S5.p5.1.m1.1.1.3.1.cmml">+</mo><msub id="S5.p5.1.m1.1.1.3.3" xref="S5.p5.1.m1.1.1.3.3.cmml"><mi id="S5.p5.1.m1.1.1.3.3.2" xref="S5.p5.1.m1.1.1.3.3.2.cmml">λ</mi><mi id="S5.p5.1.m1.1.1.3.3.3" xref="S5.p5.1.m1.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><apply id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1"><eq id="S5.p5.1.m1.1.1.1.cmml" xref="S5.p5.1.m1.1.1.1"></eq><ci id="S5.p5.1.m1.1.1.2.cmml" xref="S5.p5.1.m1.1.1.2">𝜆</ci><apply id="S5.p5.1.m1.1.1.3.cmml" xref="S5.p5.1.m1.1.1.3"><plus id="S5.p5.1.m1.1.1.3.1.cmml" xref="S5.p5.1.m1.1.1.3.1"></plus><apply id="S5.p5.1.m1.1.1.3.2.cmml" xref="S5.p5.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.p5.1.m1.1.1.3.2.1.cmml" xref="S5.p5.1.m1.1.1.3.2">subscript</csymbol><ci id="S5.p5.1.m1.1.1.3.2.2.cmml" xref="S5.p5.1.m1.1.1.3.2.2">𝜆</ci><ci id="S5.p5.1.m1.1.1.3.2.3.cmml" xref="S5.p5.1.m1.1.1.3.2.3">𝑐</ci></apply><apply id="S5.p5.1.m1.1.1.3.3.cmml" xref="S5.p5.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.p5.1.m1.1.1.3.3.1.cmml" xref="S5.p5.1.m1.1.1.3.3">subscript</csymbol><ci id="S5.p5.1.m1.1.1.3.3.2.cmml" xref="S5.p5.1.m1.1.1.3.3.2">𝜆</ci><ci id="S5.p5.1.m1.1.1.3.3.3.cmml" xref="S5.p5.1.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">\lambda=\lambda_{c}+\lambda_{n}</annotation><annotation encoding="application/x-llamapun" id="S5.p5.1.m1.1d">italic_λ = italic_λ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\lambda_{c}" class="ltx_Math" display="inline" id="S5.p5.2.m2.1"><semantics id="S5.p5.2.m2.1a"><msub id="S5.p5.2.m2.1.1" xref="S5.p5.2.m2.1.1.cmml"><mi id="S5.p5.2.m2.1.1.2" xref="S5.p5.2.m2.1.1.2.cmml">λ</mi><mi id="S5.p5.2.m2.1.1.3" xref="S5.p5.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.2.m2.1b"><apply id="S5.p5.2.m2.1.1.cmml" xref="S5.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p5.2.m2.1.1.1.cmml" xref="S5.p5.2.m2.1.1">subscript</csymbol><ci id="S5.p5.2.m2.1.1.2.cmml" xref="S5.p5.2.m2.1.1.2">𝜆</ci><ci id="S5.p5.2.m2.1.1.3.cmml" xref="S5.p5.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.2.m2.1c">\lambda_{c}</annotation><annotation encoding="application/x-llamapun" id="S5.p5.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the Poisson rate of connection-bound packets and <math alttext="\lambda_{n}" class="ltx_Math" display="inline" id="S5.p5.3.m3.1"><semantics id="S5.p5.3.m3.1a"><msub id="S5.p5.3.m3.1.1" xref="S5.p5.3.m3.1.1.cmml"><mi id="S5.p5.3.m3.1.1.2" xref="S5.p5.3.m3.1.1.2.cmml">λ</mi><mi id="S5.p5.3.m3.1.1.3" xref="S5.p5.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p5.3.m3.1b"><apply id="S5.p5.3.m3.1.1.cmml" xref="S5.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p5.3.m3.1.1.1.cmml" xref="S5.p5.3.m3.1.1">subscript</csymbol><ci id="S5.p5.3.m3.1.1.2.cmml" xref="S5.p5.3.m3.1.1.2">𝜆</ci><ci id="S5.p5.3.m3.1.1.3.cmml" xref="S5.p5.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.3.m3.1c">\lambda_{n}</annotation><annotation encoding="application/x-llamapun" id="S5.p5.3.m3.1d">italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> is the Poisson rate of all other packets (i.e., non-atomic and non-connection-bound atomic packets).
We can use our evaluations from Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4" title="4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4</span></a> to partition the space of rates <math alttext="(\lambda,\lambda_{n})" class="ltx_Math" display="inline" id="S5.p5.4.m4.2"><semantics id="S5.p5.4.m4.2a"><mrow id="S5.p5.4.m4.2.2.1" xref="S5.p5.4.m4.2.2.2.cmml"><mo id="S5.p5.4.m4.2.2.1.2" stretchy="false" xref="S5.p5.4.m4.2.2.2.cmml">(</mo><mi id="S5.p5.4.m4.1.1" xref="S5.p5.4.m4.1.1.cmml">λ</mi><mo id="S5.p5.4.m4.2.2.1.3" xref="S5.p5.4.m4.2.2.2.cmml">,</mo><msub id="S5.p5.4.m4.2.2.1.1" xref="S5.p5.4.m4.2.2.1.1.cmml"><mi id="S5.p5.4.m4.2.2.1.1.2" xref="S5.p5.4.m4.2.2.1.1.2.cmml">λ</mi><mi id="S5.p5.4.m4.2.2.1.1.3" xref="S5.p5.4.m4.2.2.1.1.3.cmml">n</mi></msub><mo id="S5.p5.4.m4.2.2.1.4" stretchy="false" xref="S5.p5.4.m4.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.4.m4.2b"><interval closure="open" id="S5.p5.4.m4.2.2.2.cmml" xref="S5.p5.4.m4.2.2.1"><ci id="S5.p5.4.m4.1.1.cmml" xref="S5.p5.4.m4.1.1">𝜆</ci><apply id="S5.p5.4.m4.2.2.1.1.cmml" xref="S5.p5.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S5.p5.4.m4.2.2.1.1.1.cmml" xref="S5.p5.4.m4.2.2.1.1">subscript</csymbol><ci id="S5.p5.4.m4.2.2.1.1.2.cmml" xref="S5.p5.4.m4.2.2.1.1.2">𝜆</ci><ci id="S5.p5.4.m4.2.2.1.1.3.cmml" xref="S5.p5.4.m4.2.2.1.1.3">𝑛</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.4.m4.2c">(\lambda,\lambda_{n})</annotation><annotation encoding="application/x-llamapun" id="S5.p5.4.m4.2d">( italic_λ , italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math> by use case and identify the best IPID selection method(s) for each.
See Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a> for a visual summary.</p>
</div>
<div class="ltx_theorem ltx_theorem_recommend" id="Thmrecommend3">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Recommendation 3.</h6>
<div class="ltx_para" id="Thmrecommend3.p1">
<p class="ltx_p" id="Thmrecommend3.p1.1"><span class="ltx_text ltx_font_italic" id="Thmrecommend3.p1.1.1">IPID selection method(s) should be chosen based on a machine’s expected rates of total outgoing traffic and non-connection-bound outgoing traffic according to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a>.</span></p>
</div>
</div>
<div class="ltx_para" id="S5.p6">
<p class="ltx_p" id="S5.p6.1">In some of the use cases we describe below, it will be advantageous to assign IPIDs to connection-bound traffic separately from the rest (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a>, white hatching).
In these situations, connection-bound atomic packets should be assigned IPIDs using per-connection selection, storing connection counters in the corresponding socket data structures.
This is preferable to assigning them a fixed IPID value (e.g., zero) since it acts as a low-cost implementation of Postel’s law—“be conservative in what you send, be liberal in what you accept”—hedging against forced fragmentation by a malicious adversary or other machines fragmenting packets downstream in violation of RFC 6848.</p>
</div>
<div class="ltx_para" id="S5.p7">
<p class="ltx_p" id="S5.p7.1">It remains to determine, for each use case, the best selection method for non-connection-bound packets and whether this method should also be used for connection-bound packets.</p>
<ol class="ltx_enumerate" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.2"><span class="ltx_text ltx_font_italic" id="S5.I1.i1.p1.2.1">Slow Overall</span> (e.g., printers, edge devices, IoT).
If the total outgoing packet rate is slow (<math alttext="\lambda_{n}\leq\lambda\leq 2^{0}\approx" class="ltx_Math" display="inline" id="S5.I1.i1.p1.1.m1.1"><semantics id="S5.I1.i1.p1.1.m1.1a"><mrow id="S5.I1.i1.p1.1.m1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.cmml"><msub id="S5.I1.i1.p1.1.m1.1.1.2" xref="S5.I1.i1.p1.1.m1.1.1.2.cmml"><mi id="S5.I1.i1.p1.1.m1.1.1.2.2" xref="S5.I1.i1.p1.1.m1.1.1.2.2.cmml">λ</mi><mi id="S5.I1.i1.p1.1.m1.1.1.2.3" xref="S5.I1.i1.p1.1.m1.1.1.2.3.cmml">n</mi></msub><mo id="S5.I1.i1.p1.1.m1.1.1.3" xref="S5.I1.i1.p1.1.m1.1.1.3.cmml">≤</mo><mi id="S5.I1.i1.p1.1.m1.1.1.4" xref="S5.I1.i1.p1.1.m1.1.1.4.cmml">λ</mi><mo id="S5.I1.i1.p1.1.m1.1.1.5" xref="S5.I1.i1.p1.1.m1.1.1.5.cmml">≤</mo><msup id="S5.I1.i1.p1.1.m1.1.1.6" xref="S5.I1.i1.p1.1.m1.1.1.6.cmml"><mn id="S5.I1.i1.p1.1.m1.1.1.6.2" xref="S5.I1.i1.p1.1.m1.1.1.6.2.cmml">2</mn><mn id="S5.I1.i1.p1.1.m1.1.1.6.3" xref="S5.I1.i1.p1.1.m1.1.1.6.3.cmml">0</mn></msup><mo id="S5.I1.i1.p1.1.m1.1.1.7" xref="S5.I1.i1.p1.1.m1.1.1.7.cmml">≈</mo><mi id="S5.I1.i1.p1.1.m1.1.1.8" xref="S5.I1.i1.p1.1.m1.1.1.8.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.1.m1.1b"><apply id="S5.I1.i1.p1.1.m1.1.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1"><and id="S5.I1.i1.p1.1.m1.1.1a.cmml" xref="S5.I1.i1.p1.1.m1.1.1"></and><apply id="S5.I1.i1.p1.1.m1.1.1b.cmml" xref="S5.I1.i1.p1.1.m1.1.1"><leq id="S5.I1.i1.p1.1.m1.1.1.3.cmml" xref="S5.I1.i1.p1.1.m1.1.1.3"></leq><apply id="S5.I1.i1.p1.1.m1.1.1.2.cmml" xref="S5.I1.i1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="S5.I1.i1.p1.1.m1.1.1.2.2">𝜆</ci><ci id="S5.I1.i1.p1.1.m1.1.1.2.3.cmml" xref="S5.I1.i1.p1.1.m1.1.1.2.3">𝑛</ci></apply><ci id="S5.I1.i1.p1.1.m1.1.1.4.cmml" xref="S5.I1.i1.p1.1.m1.1.1.4">𝜆</ci></apply><apply id="S5.I1.i1.p1.1.m1.1.1c.cmml" xref="S5.I1.i1.p1.1.m1.1.1"><leq id="S5.I1.i1.p1.1.m1.1.1.5.cmml" xref="S5.I1.i1.p1.1.m1.1.1.5"></leq><share href="https://arxiv.org/html/2406.06483v2#S5.I1.i1.p1.1.m1.1.1.4.cmml" id="S5.I1.i1.p1.1.m1.1.1d.cmml" xref="S5.I1.i1.p1.1.m1.1.1"></share><apply id="S5.I1.i1.p1.1.m1.1.1.6.cmml" xref="S5.I1.i1.p1.1.m1.1.1.6"><csymbol cd="ambiguous" id="S5.I1.i1.p1.1.m1.1.1.6.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1.6">superscript</csymbol><cn id="S5.I1.i1.p1.1.m1.1.1.6.2.cmml" type="integer" xref="S5.I1.i1.p1.1.m1.1.1.6.2">2</cn><cn id="S5.I1.i1.p1.1.m1.1.1.6.3.cmml" type="integer" xref="S5.I1.i1.p1.1.m1.1.1.6.3">0</cn></apply></apply><apply id="S5.I1.i1.p1.1.m1.1.1e.cmml" xref="S5.I1.i1.p1.1.m1.1.1"><approx id="S5.I1.i1.p1.1.m1.1.1.7.cmml" xref="S5.I1.i1.p1.1.m1.1.1.7"></approx><share href="https://arxiv.org/html/2406.06483v2#S5.I1.i1.p1.1.m1.1.1.6.cmml" id="S5.I1.i1.p1.1.m1.1.1f.cmml" xref="S5.I1.i1.p1.1.m1.1.1"></share><csymbol cd="latexml" id="S5.I1.i1.p1.1.m1.1.1.8.cmml" xref="S5.I1.i1.p1.1.m1.1.1.8">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.1.m1.1c">\lambda_{n}\leq\lambda\leq 2^{0}\approx</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i1.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ≤ italic_λ ≤ 2 start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ≈</annotation></semantics></math> 1 Mbps), our analysis shows that all methods are <span class="ltx_ERROR undefined" id="S5.I1.i1.p1.2.2">\replaced</span>likelyalmost surely correct; per-bucket and PRNG-based selection achieve near-optimal security; and PRNG-based selection is faster than per-bucket selection as there is little to no CPU contention over IPID resources at these slow rates.
Thus, PRNG-based selection can be used efficiently for all packets, regardless of whether they’re connection-bound (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a>, solid orange).
The specific choice of PRNG-based method can be left up to user preference.
<span class="ltx_ERROR undefined" id="S5.I1.i1.p1.2.3">\added</span>Pure PRNG selection has the best performance and security but much worse correctness; between the non-repeating methods, searchable queues use less memory while iterated Knuth shuffles have shorter request times, and larger numbers of reserved IPIDs <math alttext="k" class="ltx_Math" display="inline" id="S5.I1.i1.p1.2.m2.1"><semantics id="S5.I1.i1.p1.2.m2.1a"><mi id="S5.I1.i1.p1.2.m2.1.1" xref="S5.I1.i1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.2.m2.1b"><ci id="S5.I1.i1.p1.2.m2.1.1.cmml" xref="S5.I1.i1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i1.p1.2.m2.1d">italic_k</annotation></semantics></math> achieve better correctness at the cost of slightly worse security.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.2"><span class="ltx_text ltx_font_italic" id="S5.I1.i2.p1.2.1">Slow Non-Connection-Bound, Moderate Connection-Bound</span> (e.g., home computers, HTTPS servers handling exclusively TCP traffic).
If only the non-connection-bound traffic rate is slow (<math alttext="\lambda_{n}\leq 2^{0}\approx" class="ltx_Math" display="inline" id="S5.I1.i2.p1.1.m1.1"><semantics id="S5.I1.i2.p1.1.m1.1a"><mrow id="S5.I1.i2.p1.1.m1.1.1" xref="S5.I1.i2.p1.1.m1.1.1.cmml"><msub id="S5.I1.i2.p1.1.m1.1.1.2" xref="S5.I1.i2.p1.1.m1.1.1.2.cmml"><mi id="S5.I1.i2.p1.1.m1.1.1.2.2" xref="S5.I1.i2.p1.1.m1.1.1.2.2.cmml">λ</mi><mi id="S5.I1.i2.p1.1.m1.1.1.2.3" xref="S5.I1.i2.p1.1.m1.1.1.2.3.cmml">n</mi></msub><mo id="S5.I1.i2.p1.1.m1.1.1.3" xref="S5.I1.i2.p1.1.m1.1.1.3.cmml">≤</mo><msup id="S5.I1.i2.p1.1.m1.1.1.4" xref="S5.I1.i2.p1.1.m1.1.1.4.cmml"><mn id="S5.I1.i2.p1.1.m1.1.1.4.2" xref="S5.I1.i2.p1.1.m1.1.1.4.2.cmml">2</mn><mn id="S5.I1.i2.p1.1.m1.1.1.4.3" xref="S5.I1.i2.p1.1.m1.1.1.4.3.cmml">0</mn></msup><mo id="S5.I1.i2.p1.1.m1.1.1.5" xref="S5.I1.i2.p1.1.m1.1.1.5.cmml">≈</mo><mi id="S5.I1.i2.p1.1.m1.1.1.6" xref="S5.I1.i2.p1.1.m1.1.1.6.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.1.m1.1b"><apply id="S5.I1.i2.p1.1.m1.1.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1"><and id="S5.I1.i2.p1.1.m1.1.1a.cmml" xref="S5.I1.i2.p1.1.m1.1.1"></and><apply id="S5.I1.i2.p1.1.m1.1.1b.cmml" xref="S5.I1.i2.p1.1.m1.1.1"><leq id="S5.I1.i2.p1.1.m1.1.1.3.cmml" xref="S5.I1.i2.p1.1.m1.1.1.3"></leq><apply id="S5.I1.i2.p1.1.m1.1.1.2.cmml" xref="S5.I1.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.I1.i2.p1.1.m1.1.1.2.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.I1.i2.p1.1.m1.1.1.2.2.cmml" xref="S5.I1.i2.p1.1.m1.1.1.2.2">𝜆</ci><ci id="S5.I1.i2.p1.1.m1.1.1.2.3.cmml" xref="S5.I1.i2.p1.1.m1.1.1.2.3">𝑛</ci></apply><apply id="S5.I1.i2.p1.1.m1.1.1.4.cmml" xref="S5.I1.i2.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S5.I1.i2.p1.1.m1.1.1.4.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1.4">superscript</csymbol><cn id="S5.I1.i2.p1.1.m1.1.1.4.2.cmml" type="integer" xref="S5.I1.i2.p1.1.m1.1.1.4.2">2</cn><cn id="S5.I1.i2.p1.1.m1.1.1.4.3.cmml" type="integer" xref="S5.I1.i2.p1.1.m1.1.1.4.3">0</cn></apply></apply><apply id="S5.I1.i2.p1.1.m1.1.1c.cmml" xref="S5.I1.i2.p1.1.m1.1.1"><approx id="S5.I1.i2.p1.1.m1.1.1.5.cmml" xref="S5.I1.i2.p1.1.m1.1.1.5"></approx><share href="https://arxiv.org/html/2406.06483v2#S5.I1.i2.p1.1.m1.1.1.4.cmml" id="S5.I1.i2.p1.1.m1.1.1d.cmml" xref="S5.I1.i2.p1.1.m1.1.1"></share><csymbol cd="latexml" id="S5.I1.i2.p1.1.m1.1.1.6.cmml" xref="S5.I1.i2.p1.1.m1.1.1.6">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.1.m1.1c">\lambda_{n}\leq 2^{0}\approx</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i2.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ≤ 2 start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ≈</annotation></semantics></math> 1 Mbps) but the overall rate is too fast for <span class="ltx_ERROR undefined" id="S5.I1.i2.p1.2.2">\added</span>pure PRNG selection to be correct and for non-repeating PRNG-based methods to be efficient (<math alttext="\lambda&gt;2^{0}\approx" class="ltx_Math" display="inline" id="S5.I1.i2.p1.2.m2.1"><semantics id="S5.I1.i2.p1.2.m2.1a"><mrow id="S5.I1.i2.p1.2.m2.1.1" xref="S5.I1.i2.p1.2.m2.1.1.cmml"><mi id="S5.I1.i2.p1.2.m2.1.1.2" xref="S5.I1.i2.p1.2.m2.1.1.2.cmml">λ</mi><mo id="S5.I1.i2.p1.2.m2.1.1.3" xref="S5.I1.i2.p1.2.m2.1.1.3.cmml">&gt;</mo><msup id="S5.I1.i2.p1.2.m2.1.1.4" xref="S5.I1.i2.p1.2.m2.1.1.4.cmml"><mn id="S5.I1.i2.p1.2.m2.1.1.4.2" xref="S5.I1.i2.p1.2.m2.1.1.4.2.cmml">2</mn><mn id="S5.I1.i2.p1.2.m2.1.1.4.3" xref="S5.I1.i2.p1.2.m2.1.1.4.3.cmml">0</mn></msup><mo id="S5.I1.i2.p1.2.m2.1.1.5" xref="S5.I1.i2.p1.2.m2.1.1.5.cmml">≈</mo><mi id="S5.I1.i2.p1.2.m2.1.1.6" xref="S5.I1.i2.p1.2.m2.1.1.6.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.2.m2.1b"><apply id="S5.I1.i2.p1.2.m2.1.1.cmml" xref="S5.I1.i2.p1.2.m2.1.1"><and id="S5.I1.i2.p1.2.m2.1.1a.cmml" xref="S5.I1.i2.p1.2.m2.1.1"></and><apply id="S5.I1.i2.p1.2.m2.1.1b.cmml" xref="S5.I1.i2.p1.2.m2.1.1"><gt id="S5.I1.i2.p1.2.m2.1.1.3.cmml" xref="S5.I1.i2.p1.2.m2.1.1.3"></gt><ci id="S5.I1.i2.p1.2.m2.1.1.2.cmml" xref="S5.I1.i2.p1.2.m2.1.1.2">𝜆</ci><apply id="S5.I1.i2.p1.2.m2.1.1.4.cmml" xref="S5.I1.i2.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S5.I1.i2.p1.2.m2.1.1.4.1.cmml" xref="S5.I1.i2.p1.2.m2.1.1.4">superscript</csymbol><cn id="S5.I1.i2.p1.2.m2.1.1.4.2.cmml" type="integer" xref="S5.I1.i2.p1.2.m2.1.1.4.2">2</cn><cn id="S5.I1.i2.p1.2.m2.1.1.4.3.cmml" type="integer" xref="S5.I1.i2.p1.2.m2.1.1.4.3">0</cn></apply></apply><apply id="S5.I1.i2.p1.2.m2.1.1c.cmml" xref="S5.I1.i2.p1.2.m2.1.1"><approx id="S5.I1.i2.p1.2.m2.1.1.5.cmml" xref="S5.I1.i2.p1.2.m2.1.1.5"></approx><share href="https://arxiv.org/html/2406.06483v2#S5.I1.i2.p1.2.m2.1.1.4.cmml" id="S5.I1.i2.p1.2.m2.1.1d.cmml" xref="S5.I1.i2.p1.2.m2.1.1"></share><csymbol cd="latexml" id="S5.I1.i2.p1.2.m2.1.1.6.cmml" xref="S5.I1.i2.p1.2.m2.1.1.6">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.2.m2.1c">\lambda&gt;2^{0}\approx</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i2.p1.2.m2.1d">italic_λ &gt; 2 start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ≈</annotation></semantics></math> 1 Mbps), then the connection-bound traffic should be handled separately with per-connection selection so the remaining rate is slow enough to use <span class="ltx_ERROR undefined" id="S5.I1.i2.p1.2.3">\added</span>a non-repeating PRNG-based method efficiently (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a>, hatched orange).
This achieves near-optimal security for all packet types with high performance.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(3)</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i3.p1.1.1">Moderate Overall</span> (e.g., home computers, general purpose servers).
In the region of moderate traffic rates (<math alttext="2^{0}&lt;\lambda,\lambda_{n}&lt;2^{10}\approx" class="ltx_Math" display="inline" id="S5.I1.i3.p1.1.m1.3"><semantics id="S5.I1.i3.p1.1.m1.3a"><mrow id="S5.I1.i3.p1.1.m1.3.3.2" xref="S5.I1.i3.p1.1.m1.3.3.3.cmml"><mrow id="S5.I1.i3.p1.1.m1.2.2.1.1" xref="S5.I1.i3.p1.1.m1.2.2.1.1.cmml"><msup id="S5.I1.i3.p1.1.m1.2.2.1.1.2" xref="S5.I1.i3.p1.1.m1.2.2.1.1.2.cmml"><mn id="S5.I1.i3.p1.1.m1.2.2.1.1.2.2" xref="S5.I1.i3.p1.1.m1.2.2.1.1.2.2.cmml">2</mn><mn id="S5.I1.i3.p1.1.m1.2.2.1.1.2.3" xref="S5.I1.i3.p1.1.m1.2.2.1.1.2.3.cmml">0</mn></msup><mo id="S5.I1.i3.p1.1.m1.2.2.1.1.1" xref="S5.I1.i3.p1.1.m1.2.2.1.1.1.cmml">&lt;</mo><mi id="S5.I1.i3.p1.1.m1.1.1" xref="S5.I1.i3.p1.1.m1.1.1.cmml">λ</mi></mrow><mo id="S5.I1.i3.p1.1.m1.3.3.2.3" xref="S5.I1.i3.p1.1.m1.3.3.3a.cmml">,</mo><mrow id="S5.I1.i3.p1.1.m1.3.3.2.2" xref="S5.I1.i3.p1.1.m1.3.3.2.2.cmml"><msub id="S5.I1.i3.p1.1.m1.3.3.2.2.2" xref="S5.I1.i3.p1.1.m1.3.3.2.2.2.cmml"><mi id="S5.I1.i3.p1.1.m1.3.3.2.2.2.2" xref="S5.I1.i3.p1.1.m1.3.3.2.2.2.2.cmml">λ</mi><mi id="S5.I1.i3.p1.1.m1.3.3.2.2.2.3" xref="S5.I1.i3.p1.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S5.I1.i3.p1.1.m1.3.3.2.2.3" xref="S5.I1.i3.p1.1.m1.3.3.2.2.3.cmml">&lt;</mo><msup id="S5.I1.i3.p1.1.m1.3.3.2.2.4" xref="S5.I1.i3.p1.1.m1.3.3.2.2.4.cmml"><mn id="S5.I1.i3.p1.1.m1.3.3.2.2.4.2" xref="S5.I1.i3.p1.1.m1.3.3.2.2.4.2.cmml">2</mn><mn id="S5.I1.i3.p1.1.m1.3.3.2.2.4.3" xref="S5.I1.i3.p1.1.m1.3.3.2.2.4.3.cmml">10</mn></msup><mo id="S5.I1.i3.p1.1.m1.3.3.2.2.5" xref="S5.I1.i3.p1.1.m1.3.3.2.2.5.cmml">≈</mo><mi id="S5.I1.i3.p1.1.m1.3.3.2.2.6" xref="S5.I1.i3.p1.1.m1.3.3.2.2.6.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i3.p1.1.m1.3b"><apply id="S5.I1.i3.p1.1.m1.3.3.3.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2"><csymbol cd="ambiguous" id="S5.I1.i3.p1.1.m1.3.3.3a.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S5.I1.i3.p1.1.m1.2.2.1.1.cmml" xref="S5.I1.i3.p1.1.m1.2.2.1.1"><lt id="S5.I1.i3.p1.1.m1.2.2.1.1.1.cmml" xref="S5.I1.i3.p1.1.m1.2.2.1.1.1"></lt><apply id="S5.I1.i3.p1.1.m1.2.2.1.1.2.cmml" xref="S5.I1.i3.p1.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.I1.i3.p1.1.m1.2.2.1.1.2.1.cmml" xref="S5.I1.i3.p1.1.m1.2.2.1.1.2">superscript</csymbol><cn id="S5.I1.i3.p1.1.m1.2.2.1.1.2.2.cmml" type="integer" xref="S5.I1.i3.p1.1.m1.2.2.1.1.2.2">2</cn><cn id="S5.I1.i3.p1.1.m1.2.2.1.1.2.3.cmml" type="integer" xref="S5.I1.i3.p1.1.m1.2.2.1.1.2.3">0</cn></apply><ci id="S5.I1.i3.p1.1.m1.1.1.cmml" xref="S5.I1.i3.p1.1.m1.1.1">𝜆</ci></apply><apply id="S5.I1.i3.p1.1.m1.3.3.2.2.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2"><and id="S5.I1.i3.p1.1.m1.3.3.2.2a.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2"></and><apply id="S5.I1.i3.p1.1.m1.3.3.2.2b.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2"><lt id="S5.I1.i3.p1.1.m1.3.3.2.2.3.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.3"></lt><apply id="S5.I1.i3.p1.1.m1.3.3.2.2.2.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.I1.i3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S5.I1.i3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.2.2">𝜆</ci><ci id="S5.I1.i3.p1.1.m1.3.3.2.2.2.3.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.2.3">𝑛</ci></apply><apply id="S5.I1.i3.p1.1.m1.3.3.2.2.4.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.4"><csymbol cd="ambiguous" id="S5.I1.i3.p1.1.m1.3.3.2.2.4.1.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.4">superscript</csymbol><cn id="S5.I1.i3.p1.1.m1.3.3.2.2.4.2.cmml" type="integer" xref="S5.I1.i3.p1.1.m1.3.3.2.2.4.2">2</cn><cn id="S5.I1.i3.p1.1.m1.3.3.2.2.4.3.cmml" type="integer" xref="S5.I1.i3.p1.1.m1.3.3.2.2.4.3">10</cn></apply></apply><apply id="S5.I1.i3.p1.1.m1.3.3.2.2c.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2"><approx id="S5.I1.i3.p1.1.m1.3.3.2.2.5.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.5"></approx><share href="https://arxiv.org/html/2406.06483v2#S5.I1.i3.p1.1.m1.3.3.2.2.4.cmml" id="S5.I1.i3.p1.1.m1.3.3.2.2d.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2"></share><csymbol cd="latexml" id="S5.I1.i3.p1.1.m1.3.3.2.2.6.cmml" xref="S5.I1.i3.p1.1.m1.3.3.2.2.6">absent</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i3.p1.1.m1.3c">2^{0}&lt;\lambda,\lambda_{n}&lt;2^{10}\approx</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i3.p1.1.m1.3d">2 start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT &lt; italic_λ , italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT &lt; 2 start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT ≈</annotation></semantics></math> 1 Gbps), the performance bottleneck of per-destination and <span class="ltx_ERROR undefined" id="S5.I1.i3.p1.1.2">\added</span>non-repeating PRNG-based selections’ global locks cause them to scale poorly <span class="ltx_ERROR undefined" id="S5.I1.i3.p1.1.3">\added</span>and pure PRNG selection’s collision probabilities become unacceptably high.
Globally incrementing and per-bucket selection perform much better, and per-bucket’s stochastic increments yield better security guarantees than global’s sequential increments for these moderate rates.
Those stochastic increments add the most noise for low traffic buckets, so connection-bound traffic should be handled separately with per-connection selection (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a>, hatched teal).</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(4)</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.2"><span class="ltx_text ltx_font_italic" id="S5.I1.i4.p1.2.1">Moderate Non-Connection-Bound, Fast Connection-Bound</span> (e.g., busy general purpose servers).
In this use case, we reach perhaps the most surprising result of our analysis: reports of globally incrementing selection’s disadvantages are greatly exaggerated.
Globally incrementing selection not only scales better than all other methods under high contention (other than per-connection <span class="ltx_ERROR undefined" id="S5.I1.i4.p1.2.2">\added</span>and pure PRNG), but also overtakes per-bucket selection in security (recall Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS3" title="4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.3</span></a> for details).
Thus, if the non-connection-bound packet rate is not fast enough to take advantage of globally incrementing selection alone (<math alttext="\lambda_{n}&lt;2^{10}\approx" class="ltx_Math" display="inline" id="S5.I1.i4.p1.1.m1.1"><semantics id="S5.I1.i4.p1.1.m1.1a"><mrow id="S5.I1.i4.p1.1.m1.1.1" xref="S5.I1.i4.p1.1.m1.1.1.cmml"><msub id="S5.I1.i4.p1.1.m1.1.1.2" xref="S5.I1.i4.p1.1.m1.1.1.2.cmml"><mi id="S5.I1.i4.p1.1.m1.1.1.2.2" xref="S5.I1.i4.p1.1.m1.1.1.2.2.cmml">λ</mi><mi id="S5.I1.i4.p1.1.m1.1.1.2.3" xref="S5.I1.i4.p1.1.m1.1.1.2.3.cmml">n</mi></msub><mo id="S5.I1.i4.p1.1.m1.1.1.3" xref="S5.I1.i4.p1.1.m1.1.1.3.cmml">&lt;</mo><msup id="S5.I1.i4.p1.1.m1.1.1.4" xref="S5.I1.i4.p1.1.m1.1.1.4.cmml"><mn id="S5.I1.i4.p1.1.m1.1.1.4.2" xref="S5.I1.i4.p1.1.m1.1.1.4.2.cmml">2</mn><mn id="S5.I1.i4.p1.1.m1.1.1.4.3" xref="S5.I1.i4.p1.1.m1.1.1.4.3.cmml">10</mn></msup><mo id="S5.I1.i4.p1.1.m1.1.1.5" xref="S5.I1.i4.p1.1.m1.1.1.5.cmml">≈</mo><mi id="S5.I1.i4.p1.1.m1.1.1.6" xref="S5.I1.i4.p1.1.m1.1.1.6.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.1.m1.1b"><apply id="S5.I1.i4.p1.1.m1.1.1.cmml" xref="S5.I1.i4.p1.1.m1.1.1"><and id="S5.I1.i4.p1.1.m1.1.1a.cmml" xref="S5.I1.i4.p1.1.m1.1.1"></and><apply id="S5.I1.i4.p1.1.m1.1.1b.cmml" xref="S5.I1.i4.p1.1.m1.1.1"><lt id="S5.I1.i4.p1.1.m1.1.1.3.cmml" xref="S5.I1.i4.p1.1.m1.1.1.3"></lt><apply id="S5.I1.i4.p1.1.m1.1.1.2.cmml" xref="S5.I1.i4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.I1.i4.p1.1.m1.1.1.2.1.cmml" xref="S5.I1.i4.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.I1.i4.p1.1.m1.1.1.2.2.cmml" xref="S5.I1.i4.p1.1.m1.1.1.2.2">𝜆</ci><ci id="S5.I1.i4.p1.1.m1.1.1.2.3.cmml" xref="S5.I1.i4.p1.1.m1.1.1.2.3">𝑛</ci></apply><apply id="S5.I1.i4.p1.1.m1.1.1.4.cmml" xref="S5.I1.i4.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S5.I1.i4.p1.1.m1.1.1.4.1.cmml" xref="S5.I1.i4.p1.1.m1.1.1.4">superscript</csymbol><cn id="S5.I1.i4.p1.1.m1.1.1.4.2.cmml" type="integer" xref="S5.I1.i4.p1.1.m1.1.1.4.2">2</cn><cn id="S5.I1.i4.p1.1.m1.1.1.4.3.cmml" type="integer" xref="S5.I1.i4.p1.1.m1.1.1.4.3">10</cn></apply></apply><apply id="S5.I1.i4.p1.1.m1.1.1c.cmml" xref="S5.I1.i4.p1.1.m1.1.1"><approx id="S5.I1.i4.p1.1.m1.1.1.5.cmml" xref="S5.I1.i4.p1.1.m1.1.1.5"></approx><share href="https://arxiv.org/html/2406.06483v2#S5.I1.i4.p1.1.m1.1.1.4.cmml" id="S5.I1.i4.p1.1.m1.1.1d.cmml" xref="S5.I1.i4.p1.1.m1.1.1"></share><csymbol cd="latexml" id="S5.I1.i4.p1.1.m1.1.1.6.cmml" xref="S5.I1.i4.p1.1.m1.1.1.6">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.1.m1.1c">\lambda_{n}&lt;2^{10}\approx</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT &lt; 2 start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT ≈</annotation></semantics></math> 1 Gbps) but the total outgoing packet rate is (<math alttext="\lambda\geq 2^{10}\approx" class="ltx_Math" display="inline" id="S5.I1.i4.p1.2.m2.1"><semantics id="S5.I1.i4.p1.2.m2.1a"><mrow id="S5.I1.i4.p1.2.m2.1.1" xref="S5.I1.i4.p1.2.m2.1.1.cmml"><mi id="S5.I1.i4.p1.2.m2.1.1.2" xref="S5.I1.i4.p1.2.m2.1.1.2.cmml">λ</mi><mo id="S5.I1.i4.p1.2.m2.1.1.3" xref="S5.I1.i4.p1.2.m2.1.1.3.cmml">≥</mo><msup id="S5.I1.i4.p1.2.m2.1.1.4" xref="S5.I1.i4.p1.2.m2.1.1.4.cmml"><mn id="S5.I1.i4.p1.2.m2.1.1.4.2" xref="S5.I1.i4.p1.2.m2.1.1.4.2.cmml">2</mn><mn id="S5.I1.i4.p1.2.m2.1.1.4.3" xref="S5.I1.i4.p1.2.m2.1.1.4.3.cmml">10</mn></msup><mo id="S5.I1.i4.p1.2.m2.1.1.5" xref="S5.I1.i4.p1.2.m2.1.1.5.cmml">≈</mo><mi id="S5.I1.i4.p1.2.m2.1.1.6" xref="S5.I1.i4.p1.2.m2.1.1.6.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.2.m2.1b"><apply id="S5.I1.i4.p1.2.m2.1.1.cmml" xref="S5.I1.i4.p1.2.m2.1.1"><and id="S5.I1.i4.p1.2.m2.1.1a.cmml" xref="S5.I1.i4.p1.2.m2.1.1"></and><apply id="S5.I1.i4.p1.2.m2.1.1b.cmml" xref="S5.I1.i4.p1.2.m2.1.1"><geq id="S5.I1.i4.p1.2.m2.1.1.3.cmml" xref="S5.I1.i4.p1.2.m2.1.1.3"></geq><ci id="S5.I1.i4.p1.2.m2.1.1.2.cmml" xref="S5.I1.i4.p1.2.m2.1.1.2">𝜆</ci><apply id="S5.I1.i4.p1.2.m2.1.1.4.cmml" xref="S5.I1.i4.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S5.I1.i4.p1.2.m2.1.1.4.1.cmml" xref="S5.I1.i4.p1.2.m2.1.1.4">superscript</csymbol><cn id="S5.I1.i4.p1.2.m2.1.1.4.2.cmml" type="integer" xref="S5.I1.i4.p1.2.m2.1.1.4.2">2</cn><cn id="S5.I1.i4.p1.2.m2.1.1.4.3.cmml" type="integer" xref="S5.I1.i4.p1.2.m2.1.1.4.3">10</cn></apply></apply><apply id="S5.I1.i4.p1.2.m2.1.1c.cmml" xref="S5.I1.i4.p1.2.m2.1.1"><approx id="S5.I1.i4.p1.2.m2.1.1.5.cmml" xref="S5.I1.i4.p1.2.m2.1.1.5"></approx><share href="https://arxiv.org/html/2406.06483v2#S5.I1.i4.p1.2.m2.1.1.4.cmml" id="S5.I1.i4.p1.2.m2.1.1d.cmml" xref="S5.I1.i4.p1.2.m2.1.1"></share><csymbol cd="latexml" id="S5.I1.i4.p1.2.m2.1.1.6.cmml" xref="S5.I1.i4.p1.2.m2.1.1.6">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.2.m2.1c">\lambda\geq 2^{10}\approx</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.2.m2.1d">italic_λ ≥ 2 start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT ≈</annotation></semantics></math> 1 Gbps), then all traffic should be lumped together under globally incrementing selection (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a>, solid dark blue).</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(5)</span>
<div class="ltx_para" id="S5.I1.i5.p1">
<p class="ltx_p" id="S5.I1.i5.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I1.i5.p1.1.1">Fast Non-Connection-Bound</span> (e.g., DNS servers).
By the same logic as in the previous case, if the non-connection-bound packet rate is fast enough to benefit from globally incrementing selection on its own (<math alttext="\lambda_{n}\geq 2^{10}\approx" class="ltx_Math" display="inline" id="S5.I1.i5.p1.1.m1.1"><semantics id="S5.I1.i5.p1.1.m1.1a"><mrow id="S5.I1.i5.p1.1.m1.1.1" xref="S5.I1.i5.p1.1.m1.1.1.cmml"><msub id="S5.I1.i5.p1.1.m1.1.1.2" xref="S5.I1.i5.p1.1.m1.1.1.2.cmml"><mi id="S5.I1.i5.p1.1.m1.1.1.2.2" xref="S5.I1.i5.p1.1.m1.1.1.2.2.cmml">λ</mi><mi id="S5.I1.i5.p1.1.m1.1.1.2.3" xref="S5.I1.i5.p1.1.m1.1.1.2.3.cmml">n</mi></msub><mo id="S5.I1.i5.p1.1.m1.1.1.3" xref="S5.I1.i5.p1.1.m1.1.1.3.cmml">≥</mo><msup id="S5.I1.i5.p1.1.m1.1.1.4" xref="S5.I1.i5.p1.1.m1.1.1.4.cmml"><mn id="S5.I1.i5.p1.1.m1.1.1.4.2" xref="S5.I1.i5.p1.1.m1.1.1.4.2.cmml">2</mn><mn id="S5.I1.i5.p1.1.m1.1.1.4.3" xref="S5.I1.i5.p1.1.m1.1.1.4.3.cmml">10</mn></msup><mo id="S5.I1.i5.p1.1.m1.1.1.5" xref="S5.I1.i5.p1.1.m1.1.1.5.cmml">≈</mo><mi id="S5.I1.i5.p1.1.m1.1.1.6" xref="S5.I1.i5.p1.1.m1.1.1.6.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i5.p1.1.m1.1b"><apply id="S5.I1.i5.p1.1.m1.1.1.cmml" xref="S5.I1.i5.p1.1.m1.1.1"><and id="S5.I1.i5.p1.1.m1.1.1a.cmml" xref="S5.I1.i5.p1.1.m1.1.1"></and><apply id="S5.I1.i5.p1.1.m1.1.1b.cmml" xref="S5.I1.i5.p1.1.m1.1.1"><geq id="S5.I1.i5.p1.1.m1.1.1.3.cmml" xref="S5.I1.i5.p1.1.m1.1.1.3"></geq><apply id="S5.I1.i5.p1.1.m1.1.1.2.cmml" xref="S5.I1.i5.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.I1.i5.p1.1.m1.1.1.2.1.cmml" xref="S5.I1.i5.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.I1.i5.p1.1.m1.1.1.2.2.cmml" xref="S5.I1.i5.p1.1.m1.1.1.2.2">𝜆</ci><ci id="S5.I1.i5.p1.1.m1.1.1.2.3.cmml" xref="S5.I1.i5.p1.1.m1.1.1.2.3">𝑛</ci></apply><apply id="S5.I1.i5.p1.1.m1.1.1.4.cmml" xref="S5.I1.i5.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="S5.I1.i5.p1.1.m1.1.1.4.1.cmml" xref="S5.I1.i5.p1.1.m1.1.1.4">superscript</csymbol><cn id="S5.I1.i5.p1.1.m1.1.1.4.2.cmml" type="integer" xref="S5.I1.i5.p1.1.m1.1.1.4.2">2</cn><cn id="S5.I1.i5.p1.1.m1.1.1.4.3.cmml" type="integer" xref="S5.I1.i5.p1.1.m1.1.1.4.3">10</cn></apply></apply><apply id="S5.I1.i5.p1.1.m1.1.1c.cmml" xref="S5.I1.i5.p1.1.m1.1.1"><approx id="S5.I1.i5.p1.1.m1.1.1.5.cmml" xref="S5.I1.i5.p1.1.m1.1.1.5"></approx><share href="https://arxiv.org/html/2406.06483v2#S5.I1.i5.p1.1.m1.1.1.4.cmml" id="S5.I1.i5.p1.1.m1.1.1d.cmml" xref="S5.I1.i5.p1.1.m1.1.1"></share><csymbol cd="latexml" id="S5.I1.i5.p1.1.m1.1.1.6.cmml" xref="S5.I1.i5.p1.1.m1.1.1.6">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i5.p1.1.m1.1c">\lambda_{n}\geq 2^{10}\approx</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i5.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ≥ 2 start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT ≈</annotation></semantics></math> 1 Gbps), then it should do so.
To avoid unnecessarily burdening the single global counter and its cache coherency protocol, the connection-bound traffic can use per-connection selection (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a>, hatched dark blue).</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S5.p8">
<p class="ltx_p" id="S5.p8.2">Altogether, we recommend that OSes implement four IPID selection methods: globally incrementing, per-connection, per-bucket, and a <span class="ltx_ERROR undefined" id="S5.p8.2.1">\added</span>non-repeating PRNG-based method.
(Notably, per-destination selection is never recommended, owing to its <span class="ltx_ERROR undefined" id="S5.p8.2.2">\added</span>poor performance and historically poor security regardless of use case.)
Against the benefits of secure and high-performance IPID selection configurable for each machine’s specific use case, the costs of this proposed approach are small: some added code complexity and slight memory footprint inflation.
For example, Linux already implements both per-connection and per-bucket selection; adding globally incrementing selection and a <span class="ltx_ERROR undefined" id="S5.p8.2.3">\added</span>non-repeating PRNG-based method would only use <span class="ltx_ERROR undefined" id="S5.p8.2.4">\replaced</span>16–128 KiB10–129 KiB (<math alttext="&lt;0.6" class="ltx_Math" display="inline" id="S5.p8.1.m1.1"><semantics id="S5.p8.1.m1.1a"><mrow id="S5.p8.1.m1.1.1" xref="S5.p8.1.m1.1.1.cmml"><mi id="S5.p8.1.m1.1.1.2" xref="S5.p8.1.m1.1.1.2.cmml"></mi><mo id="S5.p8.1.m1.1.1.1" xref="S5.p8.1.m1.1.1.1.cmml">&lt;</mo><mn id="S5.p8.1.m1.1.1.3" xref="S5.p8.1.m1.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p8.1.m1.1b"><apply id="S5.p8.1.m1.1.1.cmml" xref="S5.p8.1.m1.1.1"><lt id="S5.p8.1.m1.1.1.1.cmml" xref="S5.p8.1.m1.1.1.1"></lt><csymbol cd="latexml" id="S5.p8.1.m1.1.1.2.cmml" xref="S5.p8.1.m1.1.1.2">absent</csymbol><cn id="S5.p8.1.m1.1.1.3.cmml" type="float" xref="S5.p8.1.m1.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.1.m1.1c">&lt;0.6</annotation><annotation encoding="application/x-llamapun" id="S5.p8.1.m1.1d">&lt; 0.6</annotation></semantics></math>–<math alttext="9\%" class="ltx_Math" display="inline" id="S5.p8.2.m2.1"><semantics id="S5.p8.2.m2.1a"><mrow id="S5.p8.2.m2.1.1" xref="S5.p8.2.m2.1.1.cmml"><mn id="S5.p8.2.m2.1.1.2" xref="S5.p8.2.m2.1.1.2.cmml">9</mn><mo id="S5.p8.2.m2.1.1.1" xref="S5.p8.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p8.2.m2.1b"><apply id="S5.p8.2.m2.1.1.cmml" xref="S5.p8.2.m2.1.1"><csymbol cd="latexml" id="S5.p8.2.m2.1.1.1.cmml" xref="S5.p8.2.m2.1.1.1">percent</csymbol><cn id="S5.p8.2.m2.1.1.2.cmml" type="integer" xref="S5.p8.2.m2.1.1.2">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.2.m2.1c">9\%</annotation><annotation encoding="application/x-llamapun" id="S5.p8.2.m2.1d">9 %</annotation></semantics></math>) more memory.<span class="ltx_ERROR undefined" id="S5.p8.2.5">\deleted</span>, depending on the PRNG-based method.</p>
</div>
<div class="ltx_para" id="S5.p9">
<p class="ltx_p" id="S5.p9.1">Our final recommendation is a word of caution.
In an effort to avoid creating new side channels when addressing old ones, we advise against <span class="ltx_ERROR undefined" id="S5.p9.1.1">\replaced</span>dynamically updating IPID selection methods based on real-time traffic ratesmonitoring traffic rates and updating the corresponding IPID selection methods automatically, in real time.
In this setting, <span class="ltx_ERROR undefined" id="S5.p9.1.2">\replaced</span>an off-path observer could influence a target’s selection method by varying its probe rate or infer information from sudden changes in a target’s IPID distribution <cite class="ltx_cite ltx_citemacro_citep">(Mongkolluksamee et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib48" title="">2012</a>)</cite>if an off-path observer saw a target’s IPID distribution suddenly change <cite class="ltx_cite ltx_citemacro_citep">(Mongkolluksamee et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib48" title="">2012</a>)</cite>, it would betray a change in traffic rates.
<span class="ltx_ERROR undefined" id="S5.p9.1.3">\added</span>Instead, if different selection methods are preferable at different times (e.g., because traffic rates vary due to diurnal patterns or weekdays vs. weekends vs. holidays), OSes could support user-defined IPID selection method schedules.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this survey, we collected a complete history of IPID-based exploits and the corresponding OS changes to IPID selection, categorizing these off-path measurements and attacks as either <span class="ltx_text ltx_font_italic" id="S6.p1.1.1">probe comparisons</span> aiming to infer information about other machines through changes in IPIDs over time or <span class="ltx_text ltx_font_italic" id="S6.p1.1.2">fragment injections</span> aiming to replace legitimate fragments with malicious ones during reassembly, causing packets to be corrupted or discarded.
We then presented the first comparative analysis of all <span class="ltx_ERROR undefined" id="S6.p1.1.3">\replaced</span>sevensix IPID selection methods, formally analyzing their relative correctness and security and empirically evaluating their performance.
Of these evaluations, the most surprising is that globally incrementing selection—the first, simplest, and most dismissed of all IPID selection methods—is in fact the most secure and performant choice for non-connection-bound packets when the rates of outgoing packets are very high.
Finally, we proposed a new approach to IPID selection that shifts the focus from developers making the “best” choice for their OS to users making the best choice for their use case across different ranges of total outgoing packet rates and non-connection-bound outgoing packet rates (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S5.F9" title="Figure 9 ‣ 5. Recommendations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a>).
It is our hope that further comparative analyses and theoretical evaluations of <span class="ltx_ERROR undefined" id="S6.p1.1.4">\deleted</span>other basic networking protocols will reveal similar best practices that can strengthen the correctness, security, and performance of all Internet-connected devices.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Software Artifacts</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Source code for the comparative analysis and performance benchmark in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4" title="4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4</span></a> is available at
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/DaymudeLab/IPIDSurvey-Code" title="">https://github.com/DaymudeLab/IPIDSurvey-Code</a>.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
<span class="ltx_ERROR undefined" id="Sx1.1.1">\added</span>We are deeply grateful to Amit Klein for his detailed, constructive feedback and his elaboration on the current macOS and Windows implementations.
J.J.D. is supported by the Momental Foundation’s Mistletoe Research Fellowship, the ASU Biodesign Institute, and the National Science Foundation (CCF-2312537).
A.M.E. is supported by DARPA (N6600120C4020).
S.B. is supported by the ASU Fulton Fellowship.
B.M–B. and J.R.C. are supported in part by the National Science Foundation (CNS-2141547).

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alexander et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Geoffrey Alexander,
Antonio M. Espinoza, and Jedidiah R.
Crandall. 2019.

</span>
<span class="ltx_bibblock">Detecting TCP/IP Connections via IPID Hash
Collisions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proceedings on Privacy Enhancing
Technologies</em> 2019, 4
(2019), 311–328.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.2478/popets-2019-0071" title="">https://doi.org/10.2478/popets-2019-0071</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">antirez (1998)</span>
<span class="ltx_bibblock">
antirez.
1998.

</span>
<span class="ltx_bibblock">New TCP Scan Method.

</span>
<span class="ltx_bibblock">Bugtraq Mailing List.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://seclists.org/bugtraq/1998/Dec/79" title="">https://seclists.org/bugtraq/1998/Dec/79</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arce and Kargieman (1997)</span>
<span class="ltx_bibblock">
Ivan Arce and Emiliano
Kargieman. 1997.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">BIND Vulnerabilities and Solutions</em>.

</span>
<span class="ltx_bibblock">Security Advisory. Secure
Networks Inc. and CORE Seguridad de la Informacion.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://marc.info/?l=best-of-security&amp;m=96843707620680" title="">https://marc.info/?l=best-of-security&amp;m=96843707620680</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bali and Frost (2007)</span>
<span class="ltx_bibblock">
Soshant Bali and
Victor S. Frost. 2007.

</span>
<span class="ltx_bibblock">An Algorithm for Fitting MMPP to IP Traffic
Traces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">IEEE Communications Letters</em>
11, 2 (2007),
207–209.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/LCOMM.2007.061619" title="">https://doi.org/10.1109/LCOMM.2007.061619</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bellovin (1989)</span>
<span class="ltx_bibblock">
Steven M. Bellovin.
1989.

</span>
<span class="ltx_bibblock">Security Problems in the TCP/IP Protocol Suite.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">ACM SIGCOMM Computer Communication Review</em>
19, 2 (1989),
32–48.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/378444.378449" title="">https://doi.org/10.1145/378444.378449</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bellovin (2002)</span>
<span class="ltx_bibblock">
Steven M. Bellovin.
2002.

</span>
<span class="ltx_bibblock">A Technique for Counting NATted Hosts. In
<em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 2nd ACM SIGCOMM Workshop on
Internet Measurment</em>. ACM, 267–272.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/637201.637243" title="">https://doi.org/10.1145/637201.637243</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhat (1994)</span>
<span class="ltx_bibblock">
Vasanthakumar N. Bhat.
1994.

</span>
<span class="ltx_bibblock">Renewal Approximations of the Switched Poisson
Processes and Their Applications to Queueing Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">The Journal of the Operational Research
Society</em> 45, 3 (1994),
345–353.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.2307/2584168" title="">https://doi.org/10.2307/2584168</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Braden (1989)</span>
<span class="ltx_bibblock">
R. Braden.
1989.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Requirements for Internet Hosts -
Communication Layers</em>.

</span>
<span class="ltx_bibblock">RFC 1122. RFC Editor.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.17487/RFC1122" title="">https://doi.org/10.17487/RFC1122</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brandt et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Markus Brandt, Tianxiang
Dai, Amit Klein, Haya Shulman, and
Michael Waidner. 2018.

</span>
<span class="ltx_bibblock">Domain Validation++ For MitM-Resilient PKI. In
<em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 2018 ACM SIGSAC Conference on
Computer and Communications Security</em>. ACM,
2060–2076.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3243734.3243790" title="">https://doi.org/10.1145/3243734.3243790</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">CAIDA (2019)</span>
<span class="ltx_bibblock">
CAIDA. 2019.

</span>
<span class="ltx_bibblock">The CAIDA UCSD Anonymized Internet Traces - 2019.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.caida.org/catalog/datasets/passive_dataset/" title="">https://www.caida.org/catalog/datasets/passive_dataset/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yue Cao, Zhiyun Qian,
Zhongjie Wang, Tuan Dao,
Srikanth V. Krishnamurthy, and Lisa M.
Marvel. 2016.

</span>
<span class="ltx_bibblock">Off-Path TCP Exploits: Global Rate Limit
Considered Dangerous. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">25th USENIX Security
Symposium (USENIX Security 16)</em>. USENIX Association,
209–225.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cardwell et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2000)</span>
<span class="ltx_bibblock">
Neal Cardwell, Stefan
Savage, and Thomas Anderson.
2000.

</span>
<span class="ltx_bibblock">Modeling TCP Latency. In
<em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">IEEE INFOCOM 2000 - IEEE Conference on Computer
Communications</em>, Vol. 3. IEEE,
1742–1751.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/INFCOM.2000.832574" title="">https://doi.org/10.1109/INFCOM.2000.832574</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2000)</span>
<span class="ltx_bibblock">
Bor-Sen Chen, Sen-Chueh
Peng, and Ku-Chen Wang.
2000.

</span>
<span class="ltx_bibblock">Traffic Modeling, Prediction, and Congestion
Control for High-Speed Networks: A Fuzzy AR Approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">IEEE Transactions on Fuzzy Systems</em>
8, 5 (2000),
491–508.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/91.873574" title="">https://doi.org/10.1109/91.873574</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2005)</span>
<span class="ltx_bibblock">
Weifeng Chen, Yong Huang,
Bruno F. Ribeiro, Kyoungwon Suh,
Honggang Zhang, Edmundo de Souza e
Silva, Jim Kurose, and Don Towsley.
2005.

</span>
<span class="ltx_bibblock">Exploiting the IPID Field to Infer Network Path
and End-System Characteristics. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Passive and
Active Network Measurement</em> <em class="ltx_emph ltx_font_italic" id="bib.bib15.4.2">(Lecture Notes in
Computer Science, Vol. 3431)</em>.
Springer, 108–120.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-540-31966-5_9" title="">https://doi.org/10.1007/978-3-540-31966-5_9</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">de Vivo et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (1999)</span>
<span class="ltx_bibblock">
Marco de Vivo, Eddy
Carrasco, Germinal Isern, and
Gabriela O. de Vivo. 1999.

</span>
<span class="ltx_bibblock">A Review of Port Scanning Techniques.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">ACM SIGCOMM Computer Communication Review</em>
29, 2 (1999),
41–48.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/505733.505737" title="">https://doi.org/10.1145/505733.505737</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ensafi (2014)</span>
<span class="ltx_bibblock">
Roya Ensafi.
2014.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Advanced Network Inference Techniques Based on
Network Protocol Stack Information Leaks</em>.

</span>
<span class="ltx_bibblock">Ph. D. Dissertation.
University of New Mexico, Albequerque,
NM, USA.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ensafi et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Roya Ensafi, Jeffrey
Knockel, Geoffrey Alexander, and
Jedidiah R. Crandall. 2014.

</span>
<span class="ltx_bibblock">Detecting Intentional Packet Drops on the Internet
via TCP/IP Side Channels. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Passive and Active
Measurement</em> <em class="ltx_emph ltx_font_italic" id="bib.bib18.4.2">(Lecture Notes in Computer Science,
Vol. 8362)</em>. Springer,
109–118.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-319-04918-2_11" title="">https://doi.org/10.1007/978-3-319-04918-2_11</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ensafi et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Roya Ensafi, Jong Chun
Park, Deepak Kapur, and Jedidiah R.
Crandall. 2010.

</span>
<span class="ltx_bibblock">Idle Port Scanning and Non-Interference Analysis
of Network Protocol Stacks Using Model Checking. In
<em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">19th USENIX Security Symposium (USENIX Security
10)</em>. USENIX Association, 1–16.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ensafi et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Roya Ensafi, Philipp
Winter, Abdullah Mueen, and Jedidiah R.
Crandall. 2015.

</span>
<span class="ltx_bibblock">Analyzing the Great Firewall of China Over Space
and Time. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings on Privacy Enhancing
Technologies</em>, Vol. 2015. 61–76.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1515/popets-2015-0005" title="">https://doi.org/10.1515/popets-2015-0005</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xuewei Feng, Chuanpu Fu,
Qi Li, Kun Sun, and Ke
Xu. 2020.

</span>
<span class="ltx_bibblock">Off-Path TCP Exploits of the Mixed IPID
Assignment. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 2020 ACM SIGSAC
Conference on Computer and Communications Security</em>.
ACM, 1323–1335.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3372297.3417884" title="">https://doi.org/10.1145/3372297.3417884</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xuewei Feng, Qi Li,
Kun Sun, Chuanpu Fu, and
Ke Xu. 2022.

</span>
<span class="ltx_bibblock">Off-Path TCP Hijacking Attacks via the Side
Channel of Downgraded IPID.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">IEEE/ACM Transactions on Networking</em>
30, 1 (2022),
409–422.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TNET.2021.3115517" title="">https://doi.org/10.1109/TNET.2021.3115517</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gilad and Herzberg (2011)</span>
<span class="ltx_bibblock">
Yossi Gilad and Amir
Herzberg. 2011.

</span>
<span class="ltx_bibblock">Fragmentation Considered Vulnerable: Blindly
Intercepting and Discarding Fragments. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">5th
USENIX Workshop on Offensive Technologies (WOOT 11)</em>.
USENIX Association, 1–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gilad and Herzberg (2012)</span>
<span class="ltx_bibblock">
Yossi Gilad and Amir
Herzberg. 2012.

</span>
<span class="ltx_bibblock">Off-Path Attacking the Web. In
<em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">6th USENIX Workshop on Offensive Technologies (WOOT
12)</em>. USENIX Association, 1–12.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gilad and Herzberg (2013)</span>
<span class="ltx_bibblock">
Yossi Gilad and Amir
Herzberg. 2013.

</span>
<span class="ltx_bibblock">Fragmentation Considered Vulnerable.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">ACM Transactions on Information and System
Security</em> 15, 4 (2013),
16:1–16:31.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2445566.2445568" title="">https://doi.org/10.1145/2445566.2445568</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gilad and Herzberg (2014)</span>
<span class="ltx_bibblock">
Yossi Gilad and Amir
Herzberg. 2014.

</span>
<span class="ltx_bibblock">Off-Path TCP Injection Attacks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">ACM Transactions on Information and System
Security</em> 16, 4 (2014),
1–32.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2597173" title="">https://doi.org/10.1145/2597173</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Handley et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2001)</span>
<span class="ltx_bibblock">
Mark Handley, Vern
Paxson, and Christian Kreibich.
2001.

</span>
<span class="ltx_bibblock">Network Intrusion Detection: Evasion, Traffic
Normalization, and End-to-End Protocol Semantics. In
<em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">10th USENIX Security Symposium (USENIX Security
01)</em>. USENIX Association, 1–17.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Herzberg and Shulman (2013a)</span>
<span class="ltx_bibblock">
Amir Herzberg and Haya
Shulman. 2013a.

</span>
<span class="ltx_bibblock">Fragmentation Considered Poisonous, or:
One-Domain-to-Rule-Them-All.org. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">2013 IEEE
Conference on Communications and Network Security (CNS)</em>.
IEEE, 224–232.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/CNS.2013.6682711" title="">https://doi.org/10.1109/CNS.2013.6682711</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Herzberg and Shulman (2013b)</span>
<span class="ltx_bibblock">
Amir Herzberg and Haya
Shulman. 2013b.

</span>
<span class="ltx_bibblock">Vulnerable Delegation of DNS Resolution. In
<em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Computer Security – ESORICS 2013</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib29.2.2">(Lecture Notes in Computer Science,
Vol. 8134)</em>. Springer,
219–236.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-642-40203-6_13" title="">https://doi.org/10.1007/978-3-642-40203-6_13</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hosking (1981)</span>
<span class="ltx_bibblock">
J. R. M. Hosking.
1981.

</span>
<span class="ltx_bibblock">Fractional Differencing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Biometrika</em> 68,
1 (1981), 165–176.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1093/biomet/68.1.165" title="">https://doi.org/10.1093/biomet/68.1.165</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jennewein et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Douglas M. Jennewein,
Johnathan Lee, Chris Kurtz,
William Dizon, Ian Shaeffer,
Alan Chapman, Alejandro Chiquete,
Josh Burks, Amber Carlson,
Natalie Mason, Arhat Kobawala,
Thirugnanam Jagadeesan, Praful Bhargav
Basani, Torey Battelle, Rebecca Belshe,
Deb McCaffrey, Marisa Brazil,
Chaitanya Inumella, Kirby Kuznia,
Jade Buzinski, Dhruvil Deepakbhai Shah,
Sean M. Dudley, Gil Speyer, and
Jason Yalim. 2023.

</span>
<span class="ltx_bibblock">The Sol Supercomputer at Arizona State
University. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Practice and Experience in
Advanced Research Computing</em>. ACM,
Portland, OR, USA, 296–301.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3569951.3597573" title="">https://doi.org/10.1145/3569951.3597573</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karagiannis et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2004)</span>
<span class="ltx_bibblock">
Thomas Karagiannis, Mart
Molle, and Michalis Faloutsos.
2004.

</span>
<span class="ltx_bibblock">Long-Range Dependence: Ten Years of Internet
Traffic Modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">IEEE Internet Computing</em>
8, 5 (2004),
57–64.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/MIC.2004.46" title="">https://doi.org/10.1109/MIC.2004.46</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kent and Mogul (1987)</span>
<span class="ltx_bibblock">
Christopher A. Kent and
Jeffrey C. Mogul. 1987.

</span>
<span class="ltx_bibblock">Fragmentation Considered Harmful.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">SIGCOMM Computer Communication Review</em>
17, 5 (1987),
390–401.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/55483.55524" title="">https://doi.org/10.1145/55483.55524</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klein (2007)</span>
<span class="ltx_bibblock">
Amit Klein.
2007.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">OpenBSD DNS Cache Poisoning and Multiple
O/S Predictable IP ID Vulnerability</em>.

</span>
<span class="ltx_bibblock">Technical Report.
Trusteer. 1–48 pages.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klein (2021)</span>
<span class="ltx_bibblock">
Amit Klein.
2021.

</span>
<span class="ltx_bibblock">Cross Layer Attacks and How to Use Them (for DNS
Cache Poisoning, Device Tracking and More). In
<em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">2021 IEEE Symposium on Security and Privacy (SP)</em>.
IEEE, 1179–1196.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/SP40001.2021.00054" title="">https://doi.org/10.1109/SP40001.2021.00054</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klein (2022)</span>
<span class="ltx_bibblock">
Amit Klein.
2022.

</span>
<span class="ltx_bibblock">Subverting Stateful Firewalls with Protocol
States. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 2022 Network and
Distributed System Security Symposium</em>. Internet
Society, 1–18.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.14722/ndss.2022.23037" title="">https://doi.org/10.14722/ndss.2022.23037</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klein (2024)</span>
<span class="ltx_bibblock">
Amit Klein.
2024.

</span>
<span class="ltx_bibblock">Private Communication.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klein and Pinkas (2019)</span>
<span class="ltx_bibblock">
Amit Klein and Benny
Pinkas. 2019.

</span>
<span class="ltx_bibblock">From IP ID to Device ID and KASLR Bypass. In
<em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">28th USENIX Security Symposium (USENIX Security
19)</em>. USENIX Association, 1063–1080.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Knockel and Crandall (2014)</span>
<span class="ltx_bibblock">
Jeffrey Knockel and
Jedidiah R. Crandall. 2014.

</span>
<span class="ltx_bibblock">Counting Packets Sent Between Arbitrary Internet
Hosts. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">4th USENIX Workshop on Free and Open
Communications on the Internet (FOCI 14)</em>. USENIX
Association, 1–8.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Knuth (1969)</span>
<span class="ltx_bibblock">
Donald E. Knuth.
1969.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">The Art of Computer Programming. Vol. 2,
Seminumerical Algorithms</em>. Vol. 2.

</span>
<span class="ltx_bibblock">Addison-Wesley, Reading, MA,
USA.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lampson (1973)</span>
<span class="ltx_bibblock">
Butler W. Lampson.
1973.

</span>
<span class="ltx_bibblock">A Note on the Confinement Problem.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Commun. ACM</em> 16,
10 (1973), 613–615.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/362375.362389" title="">https://doi.org/10.1145/362375.362389</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">lkm (2007)</span>
<span class="ltx_bibblock">
lkm. 2007.

</span>
<span class="ltx_bibblock">Remote Blind TCP/IP Spoofing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Phrack Magazine</em> 64
(2007), 13.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://phrack.org/issues/64/13.html#article" title="">http://phrack.org/issues/64/13.html#article</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lyon (2009)</span>
<span class="ltx_bibblock">
Gordon “Fyodor” Lyon.
2009.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Nmap Network Scanning: The Official Nmap
Project Guide to Network Discovery and Security Scanning</em>.

</span>
<span class="ltx_bibblock">Nmap Project, Sunnyvale, CA.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Malhotra et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Aanchal Malhotra, Isaac E.
Cohen, Erik Brakke, and Sharon
Goldberg. 2016.

</span>
<span class="ltx_bibblock">Attacking the Network Time Protocol. In
<em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of the 2016 Network and Distributed
System Security Symposium</em>. Internet Society,
1–15.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.14722/ndss.2016.23090" title="">https://doi.org/10.14722/ndss.2016.23090</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Marczak et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Bill Marczak, Nicholas
Weaver, Jakub Dalek, Roya Ensafi,
David Fifield, Sarah McKune,
Arn Rey, John Scott-Raliton,
Ron Deibert, and Vern Paxson.
2015.

</span>
<span class="ltx_bibblock">An Analysis of China’s “Great Cannon”. In
<em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">5th USENIX Workshop on Free and Open Communications
on the Internet (FOCI 15)</em>. USENIX Association,
1–11.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mathis et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (1997)</span>
<span class="ltx_bibblock">
Matthew Mathis, Jeffrey
Semke, Jamshid Mahdavi, and Teunis
Ott. 1997.

</span>
<span class="ltx_bibblock">The Macroscopic Behavior of the TCP Congestion
Avoidance Algorithm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">ACM SIGCOMM Computer Communication Review</em>
27, 3 (1997),
67–82.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/263932.264023" title="">https://doi.org/10.1145/263932.264023</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Medeiros et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
João Paulo S. Medeiros,
Agostinho M. Brito, and Paulo S.
Motta Pires. 2010.

</span>
<span class="ltx_bibblock">An Effective TCP/IP Fingerprinting Technique Based
on Strange Attractors Classification. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Data
Privacy Management and Autonomous Spontaneous Security</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib47.4.2">(Lecture Notes in Computer Science,
Vol. 5939)</em>. Springer,
208–221.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-642-11207-2_16" title="">https://doi.org/10.1007/978-3-642-11207-2_16</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mongkolluksamee et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Sophon Mongkolluksamee,
Kensuke Fukuda, and Panita
Pongpaibool. 2012.

</span>
<span class="ltx_bibblock">Counting NATted Hosts by Observing TCP/IP Field
Behaviors. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">2012 IEEE International Conference
on Communications (ICC)</em>. IEEE,
1265–1270.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ICC.2012.6364596" title="">https://doi.org/10.1109/ICC.2012.6364596</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Orevi et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Liran Orevi, Amir
Herzberg, and Haim Zlatokrilov.
2018.

</span>
<span class="ltx_bibblock">DNS-DNS: DNS-Based De-NAT Scheme. In
<em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Cryptology and Network Security</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib49.4.2">(Lecture Notes in Computer Science,
Vol. 11124)</em>. Springer,
69–88.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-3-030-00434-7_4" title="">https://doi.org/10.1007/978-3-030-00434-7_4</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Padhye et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (1998)</span>
<span class="ltx_bibblock">
Jitendra Padhye, Victor
Firoiu, Don Towsley, and Jim Kurose.
1998.

</span>
<span class="ltx_bibblock">Modeling TCP Throughput: A Simple Model and Its
Empirical Validation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">ACM SIGCOMM Computer Communication Review</em>
28, 4 (1998),
303–314.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/285243.285291" title="">https://doi.org/10.1145/285243.285291</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Palmer and Somers (2019)</span>
<span class="ltx_bibblock">
Travis Palmer and Brian
Somers. 2019.

</span>
<span class="ltx_bibblock">”First-Try” DNS Cache Poisoning with IPv4 and IPv6
Fragmentation.

</span>
<span class="ltx_bibblock">DEF CON 27.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://media.defcon.org/DEF%20CON%2027/DEF%20CON%2027%20presentations/DEFCON-27-Travis-Palmer-First-try-DNS-Cache-Poisoning-with-IPv4-and-IPv6-Fragmentation.pdf" title="">https://media.defcon.org/DEF%20CON%2027/DEF%20CON%2027%20presentations/DEFCON-27-Travis-Palmer-First-try-DNS-Cache-Poisoning-with-IPv4-and-IPv6-Fragmentation.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paxson and Floyd (1995)</span>
<span class="ltx_bibblock">
Vern Paxson and Sally
Floyd. 1995.

</span>
<span class="ltx_bibblock">Wide Area Traffic: The Failure of Poisson
Modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">IEEE/ACM Transactions on Networking</em>
3, 3 (1995),
226–244.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/90.392383" title="">https://doi.org/10.1109/90.392383</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pearce et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Paul Pearce, Roya Ensafi,
Frank Li, Nick Feamster, and
Vern Paxson. 2017.

</span>
<span class="ltx_bibblock">Augur: Internet-Wide Detection of Connectivity
Disruptions. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">2017 IEEE Symposium on Security
and Privacy (SP)</em>. IEEE, 427–443.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/SP.2017.55" title="">https://doi.org/10.1109/SP.2017.55</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Postel (1981)</span>
<span class="ltx_bibblock">
Jon Postel.
1981.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Internet Protocol</em>.

</span>
<span class="ltx_bibblock">RFC 791. RFC Editor.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.17487/RFC0791" title="">https://doi.org/10.17487/RFC0791</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian and Mao (2012)</span>
<span class="ltx_bibblock">
Zhiyun Qian and
Z. Morley Mao. 2012.

</span>
<span class="ltx_bibblock">Off-Path TCP Sequence Number Inference Attack -
How Firewall Middleboxes Reduce Security. In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">2012
IEEE Symposium on Security and Privacy</em>. IEEE,
347–361.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/SP.2012.29" title="">https://doi.org/10.1109/SP.2012.29</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Zhiyun Qian, Z. Morley
Mao, Yinglian Xie, and Fang Yu.
2010.

</span>
<span class="ltx_bibblock">Investigation of Triangular Spamming: A Stealthy
and Efficient Spamming Technique. In <em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">2010 IEEE
Symposium on Security and Privacy</em>. IEEE,
207–222.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/SP.2010.42" title="">https://doi.org/10.1109/SP.2010.42</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schuba (1993)</span>
<span class="ltx_bibblock">
Christoph Schuba.
1993.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">Addressing Weaknesses in the Domain Name
System Protocol</em>.

</span>
<span class="ltx_bibblock">Master’s thesis. Purdue
University, West Lafayette, IN, USA.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shannon et al<span class="ltx_text" id="bib.bib58.2.2.1">.</span> (2002)</span>
<span class="ltx_bibblock">
Colleen Shannon, David
Moore, and K. C. Claffy.
2002.

</span>
<span class="ltx_bibblock">Beyond Folklore: Observations on Fragmented
Traffic.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.3.1">IEEE/ACM Transactions on Networking</em>
10, 6 (2002),
709–720.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TNET.2002.805028" title="">https://doi.org/10.1109/TNET.2002.805028</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srisuresh and Holdrege (1999)</span>
<span class="ltx_bibblock">
P. Srisuresh and M.
Holdrege. 1999.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">IP Network Address Translator (NAT)
Terminology and Considerations</em>.

</span>
<span class="ltx_bibblock">RFC 2663. RFC Editor.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.17487/rfc2663" title="">https://doi.org/10.17487/rfc2663</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touch (2013)</span>
<span class="ltx_bibblock">
J. Touch. 2013.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Updated Specification of the IPv4 ID
Field</em>.

</span>
<span class="ltx_bibblock">RFC 6864. RFC Editor.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.17487/RFC6864" title="">https://doi.org/10.17487/RFC6864</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib61.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Xu Zhang, Jeffrey
Knockel, and Jedidiah R. Crandall.
2018.

</span>
<span class="ltx_bibblock">ONIS: Inferring TCP/IP-Based Trust Relationships
Completely Off-Path. In <em class="ltx_emph ltx_font_italic" id="bib.bib61.3.1">IEEE INFOCOM 2018 - IEEE
Conference on Computer Communications</em>. IEEE,
2069–2077.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/INFOCOM.2018.8486426" title="">https://doi.org/10.1109/INFOCOM.2018.8486426</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao and Shi (2013)</span>
<span class="ltx_bibblock">
Hong Zhao and Yun-Qing
Shi. 2013.

</span>
<span class="ltx_bibblock">Detecting Covert Channels in Computer Networks
Based on Chaos Theory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">IEEE Transactions on Information Forensics
and Security</em> 8, 2
(2013), 273–282.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TIFS.2012.2231861" title="">https://doi.org/10.1109/TIFS.2012.2231861</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib63.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiaofeng Zheng, Chaoyi
Lu, Jian Peng, Qiushi Yang,
Dongjie Zhou, Baojun Liu,
Keyu Man, Shuang Hao,
Haixin Duan, and Zhiyun Qian.
2020.

</span>
<span class="ltx_bibblock">Poison Over Troubled Forwarders: A Cache Poisoning
Attack Targeting DNS Forwarding Devices. In <em class="ltx_emph ltx_font_italic" id="bib.bib63.3.1">29th
USENIX Security Symposium (USENIX Security 20)</em>. USENIX
Association, 577–593.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Analytical Derivations</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1. </span>Correctness Derivations</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.12">To capture the stochastic nature of network traffic, we assume a server <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">italic_S</annotation></semantics></math> sends packets according to a Poisson process with rate <math alttext="\lambda&gt;0" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><mrow id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">λ</mi><mo id="A1.SS1.p1.2.m2.1.1.1" xref="A1.SS1.p1.2.m2.1.1.1.cmml">&gt;</mo><mn id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><gt id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1.1"></gt><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝜆</ci><cn id="A1.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS1.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\lambda&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">italic_λ &gt; 0</annotation></semantics></math>.
We further assume a worst-case scenario in which <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.p1.3.m3.1"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m3.1d">italic_S</annotation></semantics></math> sends all its packets to the same client <math alttext="C" class="ltx_Math" display="inline" id="A1.SS1.p1.4.m4.1"><semantics id="A1.SS1.p1.4.m4.1a"><mi id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><ci id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m4.1d">italic_C</annotation></semantics></math> using the same protocol, every packet is fragmented, and the reassembly buffer of <math alttext="C" class="ltx_Math" display="inline" id="A1.SS1.p1.5.m5.1"><semantics id="A1.SS1.p1.5.m5.1a"><mi id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.1b"><ci id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.5.m5.1d">italic_C</annotation></semantics></math> has unlimited size; thus, every packet has the potential to cause a collision.
Let <math alttext="N" class="ltx_Math" display="inline" id="A1.SS1.p1.6.m6.1"><semantics id="A1.SS1.p1.6.m6.1a"><mi id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><ci id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.6.m6.1d">italic_N</annotation></semantics></math> be the corresponding random variable counting the number of packets “simultaneously in transit” from <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.p1.7.m7.1"><semantics id="A1.SS1.p1.7.m7.1a"><mi id="A1.SS1.p1.7.m7.1.1" xref="A1.SS1.p1.7.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m7.1b"><ci id="A1.SS1.p1.7.m7.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m7.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.7.m7.1d">italic_S</annotation></semantics></math> to <math alttext="C" class="ltx_Math" display="inline" id="A1.SS1.p1.8.m8.1"><semantics id="A1.SS1.p1.8.m8.1a"><mi id="A1.SS1.p1.8.m8.1.1" xref="A1.SS1.p1.8.m8.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.m8.1b"><ci id="A1.SS1.p1.8.m8.1.1.cmml" xref="A1.SS1.p1.8.m8.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m8.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.8.m8.1d">italic_C</annotation></semantics></math>—i.e., those sent by <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.p1.9.m9.1"><semantics id="A1.SS1.p1.9.m9.1a"><mi id="A1.SS1.p1.9.m9.1.1" xref="A1.SS1.p1.9.m9.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.m9.1b"><ci id="A1.SS1.p1.9.m9.1.1.cmml" xref="A1.SS1.p1.9.m9.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.m9.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.9.m9.1d">italic_S</annotation></semantics></math> whose fragments have not yet been reassembled or evicted by <math alttext="C" class="ltx_Math" display="inline" id="A1.SS1.p1.10.m10.1"><semantics id="A1.SS1.p1.10.m10.1a"><mi id="A1.SS1.p1.10.m10.1.1" xref="A1.SS1.p1.10.m10.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.10.m10.1b"><ci id="A1.SS1.p1.10.m10.1.1.cmml" xref="A1.SS1.p1.10.m10.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.10.m10.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.10.m10.1d">italic_C</annotation></semantics></math>—and let unit time be calibrated such that <math alttext="\mathrm{E}\left[N\right]=\lambda" class="ltx_Math" display="inline" id="A1.SS1.p1.11.m11.1"><semantics id="A1.SS1.p1.11.m11.1a"><mrow id="A1.SS1.p1.11.m11.1.2" xref="A1.SS1.p1.11.m11.1.2.cmml"><mrow id="A1.SS1.p1.11.m11.1.2.2" xref="A1.SS1.p1.11.m11.1.2.2.cmml"><mi id="A1.SS1.p1.11.m11.1.2.2.2" mathvariant="normal" xref="A1.SS1.p1.11.m11.1.2.2.2.cmml">E</mi><mo id="A1.SS1.p1.11.m11.1.2.2.1" xref="A1.SS1.p1.11.m11.1.2.2.1.cmml">⁢</mo><mrow id="A1.SS1.p1.11.m11.1.2.2.3.2" xref="A1.SS1.p1.11.m11.1.2.2.3.1.cmml"><mo id="A1.SS1.p1.11.m11.1.2.2.3.2.1" xref="A1.SS1.p1.11.m11.1.2.2.3.1.1.cmml">[</mo><mi id="A1.SS1.p1.11.m11.1.1" xref="A1.SS1.p1.11.m11.1.1.cmml">N</mi><mo id="A1.SS1.p1.11.m11.1.2.2.3.2.2" xref="A1.SS1.p1.11.m11.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.SS1.p1.11.m11.1.2.1" xref="A1.SS1.p1.11.m11.1.2.1.cmml">=</mo><mi id="A1.SS1.p1.11.m11.1.2.3" xref="A1.SS1.p1.11.m11.1.2.3.cmml">λ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.11.m11.1b"><apply id="A1.SS1.p1.11.m11.1.2.cmml" xref="A1.SS1.p1.11.m11.1.2"><eq id="A1.SS1.p1.11.m11.1.2.1.cmml" xref="A1.SS1.p1.11.m11.1.2.1"></eq><apply id="A1.SS1.p1.11.m11.1.2.2.cmml" xref="A1.SS1.p1.11.m11.1.2.2"><times id="A1.SS1.p1.11.m11.1.2.2.1.cmml" xref="A1.SS1.p1.11.m11.1.2.2.1"></times><ci id="A1.SS1.p1.11.m11.1.2.2.2.cmml" xref="A1.SS1.p1.11.m11.1.2.2.2">E</ci><apply id="A1.SS1.p1.11.m11.1.2.2.3.1.cmml" xref="A1.SS1.p1.11.m11.1.2.2.3.2"><csymbol cd="latexml" id="A1.SS1.p1.11.m11.1.2.2.3.1.1.cmml" xref="A1.SS1.p1.11.m11.1.2.2.3.2.1">delimited-[]</csymbol><ci id="A1.SS1.p1.11.m11.1.1.cmml" xref="A1.SS1.p1.11.m11.1.1">𝑁</ci></apply></apply><ci id="A1.SS1.p1.11.m11.1.2.3.cmml" xref="A1.SS1.p1.11.m11.1.2.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.11.m11.1c">\mathrm{E}\left[N\right]=\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.11.m11.1d">roman_E [ italic_N ] = italic_λ</annotation></semantics></math>.
Then <math alttext="N" class="ltx_Math" display="inline" id="A1.SS1.p1.12.m12.1"><semantics id="A1.SS1.p1.12.m12.1a"><mi id="A1.SS1.p1.12.m12.1.1" xref="A1.SS1.p1.12.m12.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.12.m12.1b"><ci id="A1.SS1.p1.12.m12.1.1.cmml" xref="A1.SS1.p1.12.m12.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.12.m12.1c">N</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.12.m12.1d">italic_N</annotation></semantics></math> is Poisson-distributed, characterized by probability mass, cumulative distribution, and survival functions:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx2">
<tbody id="A1.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{pmf}(N,\lambda)" class="ltx_Math" display="inline" id="A1.E4.m1.2"><semantics id="A1.E4.m1.2a"><mrow id="A1.E4.m1.2.3" xref="A1.E4.m1.2.3.cmml"><mi id="A1.E4.m1.2.3.2" xref="A1.E4.m1.2.3.2.cmml">pmf</mi><mo id="A1.E4.m1.2.3.1" xref="A1.E4.m1.2.3.1.cmml">⁢</mo><mrow id="A1.E4.m1.2.3.3.2" xref="A1.E4.m1.2.3.3.1.cmml"><mo id="A1.E4.m1.2.3.3.2.1" stretchy="false" xref="A1.E4.m1.2.3.3.1.cmml">(</mo><mi id="A1.E4.m1.1.1" xref="A1.E4.m1.1.1.cmml">N</mi><mo id="A1.E4.m1.2.3.3.2.2" xref="A1.E4.m1.2.3.3.1.cmml">,</mo><mi id="A1.E4.m1.2.2" xref="A1.E4.m1.2.2.cmml">λ</mi><mo id="A1.E4.m1.2.3.3.2.3" stretchy="false" xref="A1.E4.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E4.m1.2b"><apply id="A1.E4.m1.2.3.cmml" xref="A1.E4.m1.2.3"><times id="A1.E4.m1.2.3.1.cmml" xref="A1.E4.m1.2.3.1"></times><ci id="A1.E4.m1.2.3.2.cmml" xref="A1.E4.m1.2.3.2">pmf</ci><interval closure="open" id="A1.E4.m1.2.3.3.1.cmml" xref="A1.E4.m1.2.3.3.2"><ci id="A1.E4.m1.1.1.cmml" xref="A1.E4.m1.1.1">𝑁</ci><ci id="A1.E4.m1.2.2.cmml" xref="A1.E4.m1.2.2">𝜆</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E4.m1.2c">\displaystyle\mathrm{pmf}(N,\lambda)</annotation><annotation encoding="application/x-llamapun" id="A1.E4.m1.2d">roman_pmf ( italic_N , italic_λ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\lambda^{N}e^{-\lambda}}{N!}" class="ltx_Math" display="inline" id="A1.E4.m2.1"><semantics id="A1.E4.m2.1a"><mrow id="A1.E4.m2.1.1" xref="A1.E4.m2.1.1.cmml"><mi id="A1.E4.m2.1.1.2" xref="A1.E4.m2.1.1.2.cmml"></mi><mo id="A1.E4.m2.1.1.1" xref="A1.E4.m2.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E4.m2.1.1.3" xref="A1.E4.m2.1.1.3.cmml"><mfrac id="A1.E4.m2.1.1.3a" xref="A1.E4.m2.1.1.3.cmml"><mrow id="A1.E4.m2.1.1.3.2" xref="A1.E4.m2.1.1.3.2.cmml"><msup id="A1.E4.m2.1.1.3.2.2" xref="A1.E4.m2.1.1.3.2.2.cmml"><mi id="A1.E4.m2.1.1.3.2.2.2" xref="A1.E4.m2.1.1.3.2.2.2.cmml">λ</mi><mi id="A1.E4.m2.1.1.3.2.2.3" xref="A1.E4.m2.1.1.3.2.2.3.cmml">N</mi></msup><mo id="A1.E4.m2.1.1.3.2.1" xref="A1.E4.m2.1.1.3.2.1.cmml">⁢</mo><msup id="A1.E4.m2.1.1.3.2.3" xref="A1.E4.m2.1.1.3.2.3.cmml"><mi id="A1.E4.m2.1.1.3.2.3.2" xref="A1.E4.m2.1.1.3.2.3.2.cmml">e</mi><mrow id="A1.E4.m2.1.1.3.2.3.3" xref="A1.E4.m2.1.1.3.2.3.3.cmml"><mo id="A1.E4.m2.1.1.3.2.3.3a" xref="A1.E4.m2.1.1.3.2.3.3.cmml">−</mo><mi id="A1.E4.m2.1.1.3.2.3.3.2" xref="A1.E4.m2.1.1.3.2.3.3.2.cmml">λ</mi></mrow></msup></mrow><mrow id="A1.E4.m2.1.1.3.3" xref="A1.E4.m2.1.1.3.3.cmml"><mi id="A1.E4.m2.1.1.3.3.2" xref="A1.E4.m2.1.1.3.3.2.cmml">N</mi><mo id="A1.E4.m2.1.1.3.3.1" xref="A1.E4.m2.1.1.3.3.1.cmml">!</mo></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E4.m2.1b"><apply id="A1.E4.m2.1.1.cmml" xref="A1.E4.m2.1.1"><eq id="A1.E4.m2.1.1.1.cmml" xref="A1.E4.m2.1.1.1"></eq><csymbol cd="latexml" id="A1.E4.m2.1.1.2.cmml" xref="A1.E4.m2.1.1.2">absent</csymbol><apply id="A1.E4.m2.1.1.3.cmml" xref="A1.E4.m2.1.1.3"><divide id="A1.E4.m2.1.1.3.1.cmml" xref="A1.E4.m2.1.1.3"></divide><apply id="A1.E4.m2.1.1.3.2.cmml" xref="A1.E4.m2.1.1.3.2"><times id="A1.E4.m2.1.1.3.2.1.cmml" xref="A1.E4.m2.1.1.3.2.1"></times><apply id="A1.E4.m2.1.1.3.2.2.cmml" xref="A1.E4.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E4.m2.1.1.3.2.2.1.cmml" xref="A1.E4.m2.1.1.3.2.2">superscript</csymbol><ci id="A1.E4.m2.1.1.3.2.2.2.cmml" xref="A1.E4.m2.1.1.3.2.2.2">𝜆</ci><ci id="A1.E4.m2.1.1.3.2.2.3.cmml" xref="A1.E4.m2.1.1.3.2.2.3">𝑁</ci></apply><apply id="A1.E4.m2.1.1.3.2.3.cmml" xref="A1.E4.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E4.m2.1.1.3.2.3.1.cmml" xref="A1.E4.m2.1.1.3.2.3">superscript</csymbol><ci id="A1.E4.m2.1.1.3.2.3.2.cmml" xref="A1.E4.m2.1.1.3.2.3.2">𝑒</ci><apply id="A1.E4.m2.1.1.3.2.3.3.cmml" xref="A1.E4.m2.1.1.3.2.3.3"><minus id="A1.E4.m2.1.1.3.2.3.3.1.cmml" xref="A1.E4.m2.1.1.3.2.3.3"></minus><ci id="A1.E4.m2.1.1.3.2.3.3.2.cmml" xref="A1.E4.m2.1.1.3.2.3.3.2">𝜆</ci></apply></apply></apply><apply id="A1.E4.m2.1.1.3.3.cmml" xref="A1.E4.m2.1.1.3.3"><factorial id="A1.E4.m2.1.1.3.3.1.cmml" xref="A1.E4.m2.1.1.3.3.1"></factorial><ci id="A1.E4.m2.1.1.3.3.2.cmml" xref="A1.E4.m2.1.1.3.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E4.m2.1c">\displaystyle=\frac{\lambda^{N}e^{-\lambda}}{N!}</annotation><annotation encoding="application/x-llamapun" id="A1.E4.m2.1d">= divide start_ARG italic_λ start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT - italic_λ end_POSTSUPERSCRIPT end_ARG start_ARG italic_N ! end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{cdf}(N,\lambda)" class="ltx_Math" display="inline" id="A1.E5.m1.2"><semantics id="A1.E5.m1.2a"><mrow id="A1.E5.m1.2.3" xref="A1.E5.m1.2.3.cmml"><mi id="A1.E5.m1.2.3.2" xref="A1.E5.m1.2.3.2.cmml">cdf</mi><mo id="A1.E5.m1.2.3.1" xref="A1.E5.m1.2.3.1.cmml">⁢</mo><mrow id="A1.E5.m1.2.3.3.2" xref="A1.E5.m1.2.3.3.1.cmml"><mo id="A1.E5.m1.2.3.3.2.1" stretchy="false" xref="A1.E5.m1.2.3.3.1.cmml">(</mo><mi id="A1.E5.m1.1.1" xref="A1.E5.m1.1.1.cmml">N</mi><mo id="A1.E5.m1.2.3.3.2.2" xref="A1.E5.m1.2.3.3.1.cmml">,</mo><mi id="A1.E5.m1.2.2" xref="A1.E5.m1.2.2.cmml">λ</mi><mo id="A1.E5.m1.2.3.3.2.3" stretchy="false" xref="A1.E5.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m1.2b"><apply id="A1.E5.m1.2.3.cmml" xref="A1.E5.m1.2.3"><times id="A1.E5.m1.2.3.1.cmml" xref="A1.E5.m1.2.3.1"></times><ci id="A1.E5.m1.2.3.2.cmml" xref="A1.E5.m1.2.3.2">cdf</ci><interval closure="open" id="A1.E5.m1.2.3.3.1.cmml" xref="A1.E5.m1.2.3.3.2"><ci id="A1.E5.m1.1.1.cmml" xref="A1.E5.m1.1.1">𝑁</ci><ci id="A1.E5.m1.2.2.cmml" xref="A1.E5.m1.2.2">𝜆</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m1.2c">\displaystyle\mathrm{cdf}(N,\lambda)</annotation><annotation encoding="application/x-llamapun" id="A1.E5.m1.2d">roman_cdf ( italic_N , italic_λ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=0}^{N}\mathrm{pmf}(n,\lambda)" class="ltx_Math" display="inline" id="A1.E5.m2.2"><semantics id="A1.E5.m2.2a"><mrow id="A1.E5.m2.2.3" xref="A1.E5.m2.2.3.cmml"><mi id="A1.E5.m2.2.3.2" xref="A1.E5.m2.2.3.2.cmml"></mi><mo id="A1.E5.m2.2.3.1" xref="A1.E5.m2.2.3.1.cmml">=</mo><mrow id="A1.E5.m2.2.3.3" xref="A1.E5.m2.2.3.3.cmml"><mstyle displaystyle="true" id="A1.E5.m2.2.3.3.1" xref="A1.E5.m2.2.3.3.1.cmml"><munderover id="A1.E5.m2.2.3.3.1a" xref="A1.E5.m2.2.3.3.1.cmml"><mo id="A1.E5.m2.2.3.3.1.2.2" movablelimits="false" xref="A1.E5.m2.2.3.3.1.2.2.cmml">∑</mo><mrow id="A1.E5.m2.2.3.3.1.2.3" xref="A1.E5.m2.2.3.3.1.2.3.cmml"><mi id="A1.E5.m2.2.3.3.1.2.3.2" xref="A1.E5.m2.2.3.3.1.2.3.2.cmml">n</mi><mo id="A1.E5.m2.2.3.3.1.2.3.1" xref="A1.E5.m2.2.3.3.1.2.3.1.cmml">=</mo><mn id="A1.E5.m2.2.3.3.1.2.3.3" xref="A1.E5.m2.2.3.3.1.2.3.3.cmml">0</mn></mrow><mi id="A1.E5.m2.2.3.3.1.3" xref="A1.E5.m2.2.3.3.1.3.cmml">N</mi></munderover></mstyle><mrow id="A1.E5.m2.2.3.3.2" xref="A1.E5.m2.2.3.3.2.cmml"><mi id="A1.E5.m2.2.3.3.2.2" xref="A1.E5.m2.2.3.3.2.2.cmml">pmf</mi><mo id="A1.E5.m2.2.3.3.2.1" xref="A1.E5.m2.2.3.3.2.1.cmml">⁢</mo><mrow id="A1.E5.m2.2.3.3.2.3.2" xref="A1.E5.m2.2.3.3.2.3.1.cmml"><mo id="A1.E5.m2.2.3.3.2.3.2.1" stretchy="false" xref="A1.E5.m2.2.3.3.2.3.1.cmml">(</mo><mi id="A1.E5.m2.1.1" xref="A1.E5.m2.1.1.cmml">n</mi><mo id="A1.E5.m2.2.3.3.2.3.2.2" xref="A1.E5.m2.2.3.3.2.3.1.cmml">,</mo><mi id="A1.E5.m2.2.2" xref="A1.E5.m2.2.2.cmml">λ</mi><mo id="A1.E5.m2.2.3.3.2.3.2.3" stretchy="false" xref="A1.E5.m2.2.3.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E5.m2.2b"><apply id="A1.E5.m2.2.3.cmml" xref="A1.E5.m2.2.3"><eq id="A1.E5.m2.2.3.1.cmml" xref="A1.E5.m2.2.3.1"></eq><csymbol cd="latexml" id="A1.E5.m2.2.3.2.cmml" xref="A1.E5.m2.2.3.2">absent</csymbol><apply id="A1.E5.m2.2.3.3.cmml" xref="A1.E5.m2.2.3.3"><apply id="A1.E5.m2.2.3.3.1.cmml" xref="A1.E5.m2.2.3.3.1"><csymbol cd="ambiguous" id="A1.E5.m2.2.3.3.1.1.cmml" xref="A1.E5.m2.2.3.3.1">superscript</csymbol><apply id="A1.E5.m2.2.3.3.1.2.cmml" xref="A1.E5.m2.2.3.3.1"><csymbol cd="ambiguous" id="A1.E5.m2.2.3.3.1.2.1.cmml" xref="A1.E5.m2.2.3.3.1">subscript</csymbol><sum id="A1.E5.m2.2.3.3.1.2.2.cmml" xref="A1.E5.m2.2.3.3.1.2.2"></sum><apply id="A1.E5.m2.2.3.3.1.2.3.cmml" xref="A1.E5.m2.2.3.3.1.2.3"><eq id="A1.E5.m2.2.3.3.1.2.3.1.cmml" xref="A1.E5.m2.2.3.3.1.2.3.1"></eq><ci id="A1.E5.m2.2.3.3.1.2.3.2.cmml" xref="A1.E5.m2.2.3.3.1.2.3.2">𝑛</ci><cn id="A1.E5.m2.2.3.3.1.2.3.3.cmml" type="integer" xref="A1.E5.m2.2.3.3.1.2.3.3">0</cn></apply></apply><ci id="A1.E5.m2.2.3.3.1.3.cmml" xref="A1.E5.m2.2.3.3.1.3">𝑁</ci></apply><apply id="A1.E5.m2.2.3.3.2.cmml" xref="A1.E5.m2.2.3.3.2"><times id="A1.E5.m2.2.3.3.2.1.cmml" xref="A1.E5.m2.2.3.3.2.1"></times><ci id="A1.E5.m2.2.3.3.2.2.cmml" xref="A1.E5.m2.2.3.3.2.2">pmf</ci><interval closure="open" id="A1.E5.m2.2.3.3.2.3.1.cmml" xref="A1.E5.m2.2.3.3.2.3.2"><ci id="A1.E5.m2.1.1.cmml" xref="A1.E5.m2.1.1">𝑛</ci><ci id="A1.E5.m2.2.2.cmml" xref="A1.E5.m2.2.2">𝜆</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E5.m2.2c">\displaystyle=\sum_{n=0}^{N}\mathrm{pmf}(n,\lambda)</annotation><annotation encoding="application/x-llamapun" id="A1.E5.m2.2d">= ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_pmf ( italic_n , italic_λ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{sf}(N,\lambda)" class="ltx_Math" display="inline" id="A1.E6.m1.2"><semantics id="A1.E6.m1.2a"><mrow id="A1.E6.m1.2.3" xref="A1.E6.m1.2.3.cmml"><mi id="A1.E6.m1.2.3.2" xref="A1.E6.m1.2.3.2.cmml">sf</mi><mo id="A1.E6.m1.2.3.1" xref="A1.E6.m1.2.3.1.cmml">⁢</mo><mrow id="A1.E6.m1.2.3.3.2" xref="A1.E6.m1.2.3.3.1.cmml"><mo id="A1.E6.m1.2.3.3.2.1" stretchy="false" xref="A1.E6.m1.2.3.3.1.cmml">(</mo><mi id="A1.E6.m1.1.1" xref="A1.E6.m1.1.1.cmml">N</mi><mo id="A1.E6.m1.2.3.3.2.2" xref="A1.E6.m1.2.3.3.1.cmml">,</mo><mi id="A1.E6.m1.2.2" xref="A1.E6.m1.2.2.cmml">λ</mi><mo id="A1.E6.m1.2.3.3.2.3" stretchy="false" xref="A1.E6.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E6.m1.2b"><apply id="A1.E6.m1.2.3.cmml" xref="A1.E6.m1.2.3"><times id="A1.E6.m1.2.3.1.cmml" xref="A1.E6.m1.2.3.1"></times><ci id="A1.E6.m1.2.3.2.cmml" xref="A1.E6.m1.2.3.2">sf</ci><interval closure="open" id="A1.E6.m1.2.3.3.1.cmml" xref="A1.E6.m1.2.3.3.2"><ci id="A1.E6.m1.1.1.cmml" xref="A1.E6.m1.1.1">𝑁</ci><ci id="A1.E6.m1.2.2.cmml" xref="A1.E6.m1.2.2">𝜆</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m1.2c">\displaystyle\mathrm{sf}(N,\lambda)</annotation><annotation encoding="application/x-llamapun" id="A1.E6.m1.2d">roman_sf ( italic_N , italic_λ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=N+1}^{\infty}\mathrm{pmf}(n,\lambda)=1-\mathrm{cdf}(N,\lambda)" class="ltx_Math" display="inline" id="A1.E6.m2.4"><semantics id="A1.E6.m2.4a"><mrow id="A1.E6.m2.4.5" xref="A1.E6.m2.4.5.cmml"><mi id="A1.E6.m2.4.5.2" xref="A1.E6.m2.4.5.2.cmml"></mi><mo id="A1.E6.m2.4.5.3" xref="A1.E6.m2.4.5.3.cmml">=</mo><mrow id="A1.E6.m2.4.5.4" xref="A1.E6.m2.4.5.4.cmml"><mstyle displaystyle="true" id="A1.E6.m2.4.5.4.1" xref="A1.E6.m2.4.5.4.1.cmml"><munderover id="A1.E6.m2.4.5.4.1a" xref="A1.E6.m2.4.5.4.1.cmml"><mo id="A1.E6.m2.4.5.4.1.2.2" movablelimits="false" xref="A1.E6.m2.4.5.4.1.2.2.cmml">∑</mo><mrow id="A1.E6.m2.4.5.4.1.2.3" xref="A1.E6.m2.4.5.4.1.2.3.cmml"><mi id="A1.E6.m2.4.5.4.1.2.3.2" xref="A1.E6.m2.4.5.4.1.2.3.2.cmml">n</mi><mo id="A1.E6.m2.4.5.4.1.2.3.1" xref="A1.E6.m2.4.5.4.1.2.3.1.cmml">=</mo><mrow id="A1.E6.m2.4.5.4.1.2.3.3" xref="A1.E6.m2.4.5.4.1.2.3.3.cmml"><mi id="A1.E6.m2.4.5.4.1.2.3.3.2" xref="A1.E6.m2.4.5.4.1.2.3.3.2.cmml">N</mi><mo id="A1.E6.m2.4.5.4.1.2.3.3.1" xref="A1.E6.m2.4.5.4.1.2.3.3.1.cmml">+</mo><mn id="A1.E6.m2.4.5.4.1.2.3.3.3" xref="A1.E6.m2.4.5.4.1.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="A1.E6.m2.4.5.4.1.3" mathvariant="normal" xref="A1.E6.m2.4.5.4.1.3.cmml">∞</mi></munderover></mstyle><mrow id="A1.E6.m2.4.5.4.2" xref="A1.E6.m2.4.5.4.2.cmml"><mi id="A1.E6.m2.4.5.4.2.2" xref="A1.E6.m2.4.5.4.2.2.cmml">pmf</mi><mo id="A1.E6.m2.4.5.4.2.1" xref="A1.E6.m2.4.5.4.2.1.cmml">⁢</mo><mrow id="A1.E6.m2.4.5.4.2.3.2" xref="A1.E6.m2.4.5.4.2.3.1.cmml"><mo id="A1.E6.m2.4.5.4.2.3.2.1" stretchy="false" xref="A1.E6.m2.4.5.4.2.3.1.cmml">(</mo><mi id="A1.E6.m2.1.1" xref="A1.E6.m2.1.1.cmml">n</mi><mo id="A1.E6.m2.4.5.4.2.3.2.2" xref="A1.E6.m2.4.5.4.2.3.1.cmml">,</mo><mi id="A1.E6.m2.2.2" xref="A1.E6.m2.2.2.cmml">λ</mi><mo id="A1.E6.m2.4.5.4.2.3.2.3" stretchy="false" xref="A1.E6.m2.4.5.4.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E6.m2.4.5.5" xref="A1.E6.m2.4.5.5.cmml">=</mo><mrow id="A1.E6.m2.4.5.6" xref="A1.E6.m2.4.5.6.cmml"><mn id="A1.E6.m2.4.5.6.2" xref="A1.E6.m2.4.5.6.2.cmml">1</mn><mo id="A1.E6.m2.4.5.6.1" xref="A1.E6.m2.4.5.6.1.cmml">−</mo><mrow id="A1.E6.m2.4.5.6.3" xref="A1.E6.m2.4.5.6.3.cmml"><mi id="A1.E6.m2.4.5.6.3.2" xref="A1.E6.m2.4.5.6.3.2.cmml">cdf</mi><mo id="A1.E6.m2.4.5.6.3.1" xref="A1.E6.m2.4.5.6.3.1.cmml">⁢</mo><mrow id="A1.E6.m2.4.5.6.3.3.2" xref="A1.E6.m2.4.5.6.3.3.1.cmml"><mo id="A1.E6.m2.4.5.6.3.3.2.1" stretchy="false" xref="A1.E6.m2.4.5.6.3.3.1.cmml">(</mo><mi id="A1.E6.m2.3.3" xref="A1.E6.m2.3.3.cmml">N</mi><mo id="A1.E6.m2.4.5.6.3.3.2.2" xref="A1.E6.m2.4.5.6.3.3.1.cmml">,</mo><mi id="A1.E6.m2.4.4" xref="A1.E6.m2.4.4.cmml">λ</mi><mo id="A1.E6.m2.4.5.6.3.3.2.3" stretchy="false" xref="A1.E6.m2.4.5.6.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E6.m2.4b"><apply id="A1.E6.m2.4.5.cmml" xref="A1.E6.m2.4.5"><and id="A1.E6.m2.4.5a.cmml" xref="A1.E6.m2.4.5"></and><apply id="A1.E6.m2.4.5b.cmml" xref="A1.E6.m2.4.5"><eq id="A1.E6.m2.4.5.3.cmml" xref="A1.E6.m2.4.5.3"></eq><csymbol cd="latexml" id="A1.E6.m2.4.5.2.cmml" xref="A1.E6.m2.4.5.2">absent</csymbol><apply id="A1.E6.m2.4.5.4.cmml" xref="A1.E6.m2.4.5.4"><apply id="A1.E6.m2.4.5.4.1.cmml" xref="A1.E6.m2.4.5.4.1"><csymbol cd="ambiguous" id="A1.E6.m2.4.5.4.1.1.cmml" xref="A1.E6.m2.4.5.4.1">superscript</csymbol><apply id="A1.E6.m2.4.5.4.1.2.cmml" xref="A1.E6.m2.4.5.4.1"><csymbol cd="ambiguous" id="A1.E6.m2.4.5.4.1.2.1.cmml" xref="A1.E6.m2.4.5.4.1">subscript</csymbol><sum id="A1.E6.m2.4.5.4.1.2.2.cmml" xref="A1.E6.m2.4.5.4.1.2.2"></sum><apply id="A1.E6.m2.4.5.4.1.2.3.cmml" xref="A1.E6.m2.4.5.4.1.2.3"><eq id="A1.E6.m2.4.5.4.1.2.3.1.cmml" xref="A1.E6.m2.4.5.4.1.2.3.1"></eq><ci id="A1.E6.m2.4.5.4.1.2.3.2.cmml" xref="A1.E6.m2.4.5.4.1.2.3.2">𝑛</ci><apply id="A1.E6.m2.4.5.4.1.2.3.3.cmml" xref="A1.E6.m2.4.5.4.1.2.3.3"><plus id="A1.E6.m2.4.5.4.1.2.3.3.1.cmml" xref="A1.E6.m2.4.5.4.1.2.3.3.1"></plus><ci id="A1.E6.m2.4.5.4.1.2.3.3.2.cmml" xref="A1.E6.m2.4.5.4.1.2.3.3.2">𝑁</ci><cn id="A1.E6.m2.4.5.4.1.2.3.3.3.cmml" type="integer" xref="A1.E6.m2.4.5.4.1.2.3.3.3">1</cn></apply></apply></apply><infinity id="A1.E6.m2.4.5.4.1.3.cmml" xref="A1.E6.m2.4.5.4.1.3"></infinity></apply><apply id="A1.E6.m2.4.5.4.2.cmml" xref="A1.E6.m2.4.5.4.2"><times id="A1.E6.m2.4.5.4.2.1.cmml" xref="A1.E6.m2.4.5.4.2.1"></times><ci id="A1.E6.m2.4.5.4.2.2.cmml" xref="A1.E6.m2.4.5.4.2.2">pmf</ci><interval closure="open" id="A1.E6.m2.4.5.4.2.3.1.cmml" xref="A1.E6.m2.4.5.4.2.3.2"><ci id="A1.E6.m2.1.1.cmml" xref="A1.E6.m2.1.1">𝑛</ci><ci id="A1.E6.m2.2.2.cmml" xref="A1.E6.m2.2.2">𝜆</ci></interval></apply></apply></apply><apply id="A1.E6.m2.4.5c.cmml" xref="A1.E6.m2.4.5"><eq id="A1.E6.m2.4.5.5.cmml" xref="A1.E6.m2.4.5.5"></eq><share href="https://arxiv.org/html/2406.06483v2#A1.E6.m2.4.5.4.cmml" id="A1.E6.m2.4.5d.cmml" xref="A1.E6.m2.4.5"></share><apply id="A1.E6.m2.4.5.6.cmml" xref="A1.E6.m2.4.5.6"><minus id="A1.E6.m2.4.5.6.1.cmml" xref="A1.E6.m2.4.5.6.1"></minus><cn id="A1.E6.m2.4.5.6.2.cmml" type="integer" xref="A1.E6.m2.4.5.6.2">1</cn><apply id="A1.E6.m2.4.5.6.3.cmml" xref="A1.E6.m2.4.5.6.3"><times id="A1.E6.m2.4.5.6.3.1.cmml" xref="A1.E6.m2.4.5.6.3.1"></times><ci id="A1.E6.m2.4.5.6.3.2.cmml" xref="A1.E6.m2.4.5.6.3.2">cdf</ci><interval closure="open" id="A1.E6.m2.4.5.6.3.3.1.cmml" xref="A1.E6.m2.4.5.6.3.3.2"><ci id="A1.E6.m2.3.3.cmml" xref="A1.E6.m2.3.3">𝑁</ci><ci id="A1.E6.m2.4.4.cmml" xref="A1.E6.m2.4.4">𝜆</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m2.4c">\displaystyle=\sum_{n=N+1}^{\infty}\mathrm{pmf}(n,\lambda)=1-\mathrm{cdf}(N,\lambda)</annotation><annotation encoding="application/x-llamapun" id="A1.E6.m2.4d">= ∑ start_POSTSUBSCRIPT italic_n = italic_N + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_pmf ( italic_n , italic_λ ) = 1 - roman_cdf ( italic_N , italic_λ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<section class="ltx_subsubsection" id="A1.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.1. </span>Globally Incrementing</h4>
<div class="ltx_para" id="A1.SS1.SSS1.p1">
<p class="ltx_p" id="A1.SS1.SSS1.p1.3">Globally incrementing IPIDs increment sequentially, so the only way for a collision to occur is if all possible IPID values are exhausted and at least one is reused.
Thus, the probability of <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.1.m1.1"><semantics id="A1.SS1.SSS1.p1.1.m1.1a"><mi id="A1.SS1.SSS1.p1.1.m1.1.1" xref="A1.SS1.SSS1.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.1.m1.1b"><ci id="A1.SS1.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.1.m1.1d">italic_S</annotation></semantics></math> producing a collision at <math alttext="C" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.2.m2.1"><semantics id="A1.SS1.SSS1.p1.2.m2.1a"><mi id="A1.SS1.SSS1.p1.2.m2.1.1" xref="A1.SS1.SSS1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.2.m2.1b"><ci id="A1.SS1.SSS1.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.2.m2.1d">italic_C</annotation></semantics></math> among <math alttext="N=n" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.3.m3.1"><semantics id="A1.SS1.SSS1.p1.3.m3.1a"><mrow id="A1.SS1.SSS1.p1.3.m3.1.1" xref="A1.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="A1.SS1.SSS1.p1.3.m3.1.1.2" xref="A1.SS1.SSS1.p1.3.m3.1.1.2.cmml">N</mi><mo id="A1.SS1.SSS1.p1.3.m3.1.1.1" xref="A1.SS1.SSS1.p1.3.m3.1.1.1.cmml">=</mo><mi id="A1.SS1.SSS1.p1.3.m3.1.1.3" xref="A1.SS1.SSS1.p1.3.m3.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.3.m3.1b"><apply id="A1.SS1.SSS1.p1.3.m3.1.1.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1"><eq id="A1.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.1"></eq><ci id="A1.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.2">𝑁</ci><ci id="A1.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="A1.SS1.SSS1.p1.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.3.m3.1c">N=n</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.3.m3.1d">italic_N = italic_n</annotation></semantics></math> packets simultaneously in transit is</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{collision}\mid N=n\right]=\left\{\begin{array}[]{ll}0&amp;%
\text{if $n\leq 2^{16}$};\\
1&amp;\text{otherwise}.\end{array}\right." class="ltx_Math" display="block" id="A1.E7.m1.3"><semantics id="A1.E7.m1.3a"><mrow id="A1.E7.m1.3.3" xref="A1.E7.m1.3.3.cmml"><mrow id="A1.E7.m1.3.3.1" xref="A1.E7.m1.3.3.1.cmml"><mi id="A1.E7.m1.3.3.1.3" xref="A1.E7.m1.3.3.1.3.cmml">Pr</mi><mo id="A1.E7.m1.3.3.1.2" xref="A1.E7.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.E7.m1.3.3.1.1.1" xref="A1.E7.m1.3.3.1.1.2.cmml"><mo id="A1.E7.m1.3.3.1.1.1.2" xref="A1.E7.m1.3.3.1.1.2.1.cmml">[</mo><mrow id="A1.E7.m1.3.3.1.1.1.1" xref="A1.E7.m1.3.3.1.1.1.1.cmml"><mrow id="A1.E7.m1.3.3.1.1.1.1.2" xref="A1.E7.m1.3.3.1.1.1.1.2.cmml"><mtext id="A1.E7.m1.3.3.1.1.1.1.2.2" xref="A1.E7.m1.3.3.1.1.1.1.2.2a.cmml">collision</mtext><mo id="A1.E7.m1.3.3.1.1.1.1.2.1" xref="A1.E7.m1.3.3.1.1.1.1.2.1.cmml">∣</mo><mi id="A1.E7.m1.3.3.1.1.1.1.2.3" xref="A1.E7.m1.3.3.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="A1.E7.m1.3.3.1.1.1.1.1" xref="A1.E7.m1.3.3.1.1.1.1.1.cmml">=</mo><mi id="A1.E7.m1.3.3.1.1.1.1.3" xref="A1.E7.m1.3.3.1.1.1.1.3.cmml">n</mi></mrow><mo id="A1.E7.m1.3.3.1.1.1.3" xref="A1.E7.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E7.m1.3.3.2" xref="A1.E7.m1.3.3.2.cmml">=</mo><mrow id="A1.E7.m1.3.3.3.2" xref="A1.E7.m1.3.3.3.1.cmml"><mo id="A1.E7.m1.3.3.3.2.1" xref="A1.E7.m1.3.3.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A1.E7.m1.2.2" rowspacing="0pt" xref="A1.E7.m1.2.2.cmml"><mtr id="A1.E7.m1.2.2a" xref="A1.E7.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E7.m1.2.2b" xref="A1.E7.m1.2.2.cmml"><mn id="A1.E7.m1.1.1.1.2.1" xref="A1.E7.m1.1.1.1.2.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E7.m1.2.2c" xref="A1.E7.m1.2.2.cmml"><mrow id="A1.E7.m1.1.1.1.1.1.3" xref="A1.E7.m1.1.1.1.1.1.1.1b.cmml"><mrow id="A1.E7.m1.1.1.1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.1b.cmml"><mtext id="A1.E7.m1.1.1.1.1.1.1.1a" xref="A1.E7.m1.1.1.1.1.1.1.1a.cmml">if </mtext><mrow id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.2" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml">n</mi><mo id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml">≤</mo><msup id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml"><mn id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.2" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml">2</mn><mn id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.3" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.E7.m1.1.1.1.1.1.3.1" xref="A1.E7.m1.1.1.1.1.1.1.1b.cmml">;</mo></mrow></mtd></mtr><mtr id="A1.E7.m1.2.2d" xref="A1.E7.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E7.m1.2.2e" xref="A1.E7.m1.2.2.cmml"><mn id="A1.E7.m1.2.2.2.2.1" xref="A1.E7.m1.2.2.2.2.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E7.m1.2.2f" xref="A1.E7.m1.2.2.cmml"><mrow id="A1.E7.m1.2.2.2.1.1.3" xref="A1.E7.m1.2.2.2.1.1.1a.cmml"><mtext id="A1.E7.m1.2.2.2.1.1.1" xref="A1.E7.m1.2.2.2.1.1.1.cmml">otherwise</mtext><mo id="A1.E7.m1.2.2.2.1.1.3.1" lspace="0em" xref="A1.E7.m1.2.2.2.1.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable><mi id="A1.E7.m1.3.3.3.2.2" xref="A1.E7.m1.3.3.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.3b"><apply id="A1.E7.m1.3.3.cmml" xref="A1.E7.m1.3.3"><eq id="A1.E7.m1.3.3.2.cmml" xref="A1.E7.m1.3.3.2"></eq><apply id="A1.E7.m1.3.3.1.cmml" xref="A1.E7.m1.3.3.1"><times id="A1.E7.m1.3.3.1.2.cmml" xref="A1.E7.m1.3.3.1.2"></times><ci id="A1.E7.m1.3.3.1.3.cmml" xref="A1.E7.m1.3.3.1.3">Pr</ci><apply id="A1.E7.m1.3.3.1.1.2.cmml" xref="A1.E7.m1.3.3.1.1.1"><csymbol cd="latexml" id="A1.E7.m1.3.3.1.1.2.1.cmml" xref="A1.E7.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="A1.E7.m1.3.3.1.1.1.1.cmml" xref="A1.E7.m1.3.3.1.1.1.1"><eq id="A1.E7.m1.3.3.1.1.1.1.1.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1"></eq><apply id="A1.E7.m1.3.3.1.1.1.1.2.cmml" xref="A1.E7.m1.3.3.1.1.1.1.2"><csymbol cd="latexml" id="A1.E7.m1.3.3.1.1.1.1.2.1.cmml" xref="A1.E7.m1.3.3.1.1.1.1.2.1">conditional</csymbol><ci id="A1.E7.m1.3.3.1.1.1.1.2.2a.cmml" xref="A1.E7.m1.3.3.1.1.1.1.2.2"><mtext id="A1.E7.m1.3.3.1.1.1.1.2.2.cmml" xref="A1.E7.m1.3.3.1.1.1.1.2.2">collision</mtext></ci><ci id="A1.E7.m1.3.3.1.1.1.1.2.3.cmml" xref="A1.E7.m1.3.3.1.1.1.1.2.3">𝑁</ci></apply><ci id="A1.E7.m1.3.3.1.1.1.1.3.cmml" xref="A1.E7.m1.3.3.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="A1.E7.m1.3.3.3.1.cmml" xref="A1.E7.m1.3.3.3.2"><csymbol cd="latexml" id="A1.E7.m1.3.3.3.1.1.cmml" xref="A1.E7.m1.3.3.3.2.1">cases</csymbol><matrix id="A1.E7.m1.2.2.cmml" xref="A1.E7.m1.2.2"><matrixrow id="A1.E7.m1.2.2a.cmml" xref="A1.E7.m1.2.2"><cn id="A1.E7.m1.1.1.1.2.1.cmml" type="integer" xref="A1.E7.m1.1.1.1.2.1">0</cn><ci id="A1.E7.m1.1.1.1.1.1.1.1b.cmml" xref="A1.E7.m1.1.1.1.1.1.3"><mrow id="A1.E7.m1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1.3"><mtext id="A1.E7.m1.1.1.1.1.1.1.1a.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1a">if </mtext><mrow id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1"><mi id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.2">n</mi><mo id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.1">≤</mo><msup id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3"><mn id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.2">2</mn><mn id="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1.m1.1.1.3.3">16</mn></msup></mrow></mrow></ci></matrixrow><matrixrow id="A1.E7.m1.2.2b.cmml" xref="A1.E7.m1.2.2"><cn id="A1.E7.m1.2.2.2.2.1.cmml" type="integer" xref="A1.E7.m1.2.2.2.2.1">1</cn><ci id="A1.E7.m1.2.2.2.1.1.1a.cmml" xref="A1.E7.m1.2.2.2.1.1.3"><mtext id="A1.E7.m1.2.2.2.1.1.1.cmml" xref="A1.E7.m1.2.2.2.1.1.1">otherwise</mtext></ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.3c">\mathrm{Pr}\left[\text{collision}\mid N=n\right]=\left\{\begin{array}[]{ll}0&amp;%
\text{if $n\leq 2^{16}$};\\
1&amp;\text{otherwise}.\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="A1.E7.m1.3d">roman_Pr [ collision ∣ italic_N = italic_n ] = { start_ARRAY start_ROW start_CELL 0 end_CELL start_CELL if italic_n ≤ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ; end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL otherwise . end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS1.p1.4">Substituting Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E7" title="In A.1.1. Globally Incrementing ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">7</span></a> into Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.Ex1" title="4.2. Analyzing Correctness ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.2</span></a> yields</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{collision}\right]=\sum_{n=2^{16}+1}^{\infty}\mathrm{pmf%
}(n,\lambda)=\mathrm{sf}(2^{16},\lambda)." class="ltx_Math" display="block" id="A1.E8.m1.5"><semantics id="A1.E8.m1.5a"><mrow id="A1.E8.m1.5.5.1" xref="A1.E8.m1.5.5.1.1.cmml"><mrow id="A1.E8.m1.5.5.1.1" xref="A1.E8.m1.5.5.1.1.cmml"><mrow id="A1.E8.m1.5.5.1.1.3" xref="A1.E8.m1.5.5.1.1.3.cmml"><mi id="A1.E8.m1.5.5.1.1.3.2" xref="A1.E8.m1.5.5.1.1.3.2.cmml">Pr</mi><mo id="A1.E8.m1.5.5.1.1.3.1" xref="A1.E8.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="A1.E8.m1.5.5.1.1.3.3.2" xref="A1.E8.m1.5.5.1.1.3.3.1.cmml"><mo id="A1.E8.m1.5.5.1.1.3.3.2.1" xref="A1.E8.m1.5.5.1.1.3.3.1.1.cmml">[</mo><mtext id="A1.E8.m1.1.1" xref="A1.E8.m1.1.1a.cmml">collision</mtext><mo id="A1.E8.m1.5.5.1.1.3.3.2.2" xref="A1.E8.m1.5.5.1.1.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E8.m1.5.5.1.1.4" rspace="0.111em" xref="A1.E8.m1.5.5.1.1.4.cmml">=</mo><mrow id="A1.E8.m1.5.5.1.1.5" xref="A1.E8.m1.5.5.1.1.5.cmml"><munderover id="A1.E8.m1.5.5.1.1.5.1" xref="A1.E8.m1.5.5.1.1.5.1.cmml"><mo id="A1.E8.m1.5.5.1.1.5.1.2.2" movablelimits="false" xref="A1.E8.m1.5.5.1.1.5.1.2.2.cmml">∑</mo><mrow id="A1.E8.m1.5.5.1.1.5.1.2.3" xref="A1.E8.m1.5.5.1.1.5.1.2.3.cmml"><mi id="A1.E8.m1.5.5.1.1.5.1.2.3.2" xref="A1.E8.m1.5.5.1.1.5.1.2.3.2.cmml">n</mi><mo id="A1.E8.m1.5.5.1.1.5.1.2.3.1" xref="A1.E8.m1.5.5.1.1.5.1.2.3.1.cmml">=</mo><mrow id="A1.E8.m1.5.5.1.1.5.1.2.3.3" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.cmml"><msup id="A1.E8.m1.5.5.1.1.5.1.2.3.3.2" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.cmml"><mn id="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.2" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.2.cmml">2</mn><mn id="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.3" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.3.cmml">16</mn></msup><mo id="A1.E8.m1.5.5.1.1.5.1.2.3.3.1" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.1.cmml">+</mo><mn id="A1.E8.m1.5.5.1.1.5.1.2.3.3.3" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="A1.E8.m1.5.5.1.1.5.1.3" mathvariant="normal" xref="A1.E8.m1.5.5.1.1.5.1.3.cmml">∞</mi></munderover><mrow id="A1.E8.m1.5.5.1.1.5.2" xref="A1.E8.m1.5.5.1.1.5.2.cmml"><mi id="A1.E8.m1.5.5.1.1.5.2.2" xref="A1.E8.m1.5.5.1.1.5.2.2.cmml">pmf</mi><mo id="A1.E8.m1.5.5.1.1.5.2.1" xref="A1.E8.m1.5.5.1.1.5.2.1.cmml">⁢</mo><mrow id="A1.E8.m1.5.5.1.1.5.2.3.2" xref="A1.E8.m1.5.5.1.1.5.2.3.1.cmml"><mo id="A1.E8.m1.5.5.1.1.5.2.3.2.1" stretchy="false" xref="A1.E8.m1.5.5.1.1.5.2.3.1.cmml">(</mo><mi id="A1.E8.m1.2.2" xref="A1.E8.m1.2.2.cmml">n</mi><mo id="A1.E8.m1.5.5.1.1.5.2.3.2.2" xref="A1.E8.m1.5.5.1.1.5.2.3.1.cmml">,</mo><mi id="A1.E8.m1.3.3" xref="A1.E8.m1.3.3.cmml">λ</mi><mo id="A1.E8.m1.5.5.1.1.5.2.3.2.3" stretchy="false" xref="A1.E8.m1.5.5.1.1.5.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E8.m1.5.5.1.1.6" xref="A1.E8.m1.5.5.1.1.6.cmml">=</mo><mrow id="A1.E8.m1.5.5.1.1.1" xref="A1.E8.m1.5.5.1.1.1.cmml"><mi id="A1.E8.m1.5.5.1.1.1.3" xref="A1.E8.m1.5.5.1.1.1.3.cmml">sf</mi><mo id="A1.E8.m1.5.5.1.1.1.2" xref="A1.E8.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A1.E8.m1.5.5.1.1.1.1.1" xref="A1.E8.m1.5.5.1.1.1.1.2.cmml"><mo id="A1.E8.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="A1.E8.m1.5.5.1.1.1.1.2.cmml">(</mo><msup id="A1.E8.m1.5.5.1.1.1.1.1.1" xref="A1.E8.m1.5.5.1.1.1.1.1.1.cmml"><mn id="A1.E8.m1.5.5.1.1.1.1.1.1.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.2.cmml">2</mn><mn id="A1.E8.m1.5.5.1.1.1.1.1.1.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.3.cmml">16</mn></msup><mo id="A1.E8.m1.5.5.1.1.1.1.1.3" xref="A1.E8.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="A1.E8.m1.4.4" xref="A1.E8.m1.4.4.cmml">λ</mi><mo id="A1.E8.m1.5.5.1.1.1.1.1.4" stretchy="false" xref="A1.E8.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E8.m1.5.5.1.2" lspace="0em" xref="A1.E8.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.5b"><apply id="A1.E8.m1.5.5.1.1.cmml" xref="A1.E8.m1.5.5.1"><and id="A1.E8.m1.5.5.1.1a.cmml" xref="A1.E8.m1.5.5.1"></and><apply id="A1.E8.m1.5.5.1.1b.cmml" xref="A1.E8.m1.5.5.1"><eq id="A1.E8.m1.5.5.1.1.4.cmml" xref="A1.E8.m1.5.5.1.1.4"></eq><apply id="A1.E8.m1.5.5.1.1.3.cmml" xref="A1.E8.m1.5.5.1.1.3"><times id="A1.E8.m1.5.5.1.1.3.1.cmml" xref="A1.E8.m1.5.5.1.1.3.1"></times><ci id="A1.E8.m1.5.5.1.1.3.2.cmml" xref="A1.E8.m1.5.5.1.1.3.2">Pr</ci><apply id="A1.E8.m1.5.5.1.1.3.3.1.cmml" xref="A1.E8.m1.5.5.1.1.3.3.2"><csymbol cd="latexml" id="A1.E8.m1.5.5.1.1.3.3.1.1.cmml" xref="A1.E8.m1.5.5.1.1.3.3.2.1">delimited-[]</csymbol><ci id="A1.E8.m1.1.1a.cmml" xref="A1.E8.m1.1.1"><mtext id="A1.E8.m1.1.1.cmml" xref="A1.E8.m1.1.1">collision</mtext></ci></apply></apply><apply id="A1.E8.m1.5.5.1.1.5.cmml" xref="A1.E8.m1.5.5.1.1.5"><apply id="A1.E8.m1.5.5.1.1.5.1.cmml" xref="A1.E8.m1.5.5.1.1.5.1"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.5.1.1.cmml" xref="A1.E8.m1.5.5.1.1.5.1">superscript</csymbol><apply id="A1.E8.m1.5.5.1.1.5.1.2.cmml" xref="A1.E8.m1.5.5.1.1.5.1"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.5.1.2.1.cmml" xref="A1.E8.m1.5.5.1.1.5.1">subscript</csymbol><sum id="A1.E8.m1.5.5.1.1.5.1.2.2.cmml" xref="A1.E8.m1.5.5.1.1.5.1.2.2"></sum><apply id="A1.E8.m1.5.5.1.1.5.1.2.3.cmml" xref="A1.E8.m1.5.5.1.1.5.1.2.3"><eq id="A1.E8.m1.5.5.1.1.5.1.2.3.1.cmml" xref="A1.E8.m1.5.5.1.1.5.1.2.3.1"></eq><ci id="A1.E8.m1.5.5.1.1.5.1.2.3.2.cmml" xref="A1.E8.m1.5.5.1.1.5.1.2.3.2">𝑛</ci><apply id="A1.E8.m1.5.5.1.1.5.1.2.3.3.cmml" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3"><plus id="A1.E8.m1.5.5.1.1.5.1.2.3.3.1.cmml" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.1"></plus><apply id="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.cmml" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.2"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.1.cmml" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.2">superscript</csymbol><cn id="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.2.cmml" type="integer" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.2">2</cn><cn id="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.3.cmml" type="integer" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.2.3">16</cn></apply><cn id="A1.E8.m1.5.5.1.1.5.1.2.3.3.3.cmml" type="integer" xref="A1.E8.m1.5.5.1.1.5.1.2.3.3.3">1</cn></apply></apply></apply><infinity id="A1.E8.m1.5.5.1.1.5.1.3.cmml" xref="A1.E8.m1.5.5.1.1.5.1.3"></infinity></apply><apply id="A1.E8.m1.5.5.1.1.5.2.cmml" xref="A1.E8.m1.5.5.1.1.5.2"><times id="A1.E8.m1.5.5.1.1.5.2.1.cmml" xref="A1.E8.m1.5.5.1.1.5.2.1"></times><ci id="A1.E8.m1.5.5.1.1.5.2.2.cmml" xref="A1.E8.m1.5.5.1.1.5.2.2">pmf</ci><interval closure="open" id="A1.E8.m1.5.5.1.1.5.2.3.1.cmml" xref="A1.E8.m1.5.5.1.1.5.2.3.2"><ci id="A1.E8.m1.2.2.cmml" xref="A1.E8.m1.2.2">𝑛</ci><ci id="A1.E8.m1.3.3.cmml" xref="A1.E8.m1.3.3">𝜆</ci></interval></apply></apply></apply><apply id="A1.E8.m1.5.5.1.1c.cmml" xref="A1.E8.m1.5.5.1"><eq id="A1.E8.m1.5.5.1.1.6.cmml" xref="A1.E8.m1.5.5.1.1.6"></eq><share href="https://arxiv.org/html/2406.06483v2#A1.E8.m1.5.5.1.1.5.cmml" id="A1.E8.m1.5.5.1.1d.cmml" xref="A1.E8.m1.5.5.1"></share><apply id="A1.E8.m1.5.5.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1"><times id="A1.E8.m1.5.5.1.1.1.2.cmml" xref="A1.E8.m1.5.5.1.1.1.2"></times><ci id="A1.E8.m1.5.5.1.1.1.3.cmml" xref="A1.E8.m1.5.5.1.1.1.3">sf</ci><interval closure="open" id="A1.E8.m1.5.5.1.1.1.1.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1"><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1">superscript</csymbol><cn id="A1.E8.m1.5.5.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E8.m1.5.5.1.1.1.1.1.1.2">2</cn><cn id="A1.E8.m1.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E8.m1.5.5.1.1.1.1.1.1.3">16</cn></apply><ci id="A1.E8.m1.4.4.cmml" xref="A1.E8.m1.4.4">𝜆</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.5c">\mathrm{Pr}\left[\text{collision}\right]=\sum_{n=2^{16}+1}^{\infty}\mathrm{pmf%
}(n,\lambda)=\mathrm{sf}(2^{16},\lambda).</annotation><annotation encoding="application/x-llamapun" id="A1.E8.m1.5d">roman_Pr [ collision ] = ∑ start_POSTSUBSCRIPT italic_n = 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_pmf ( italic_n , italic_λ ) = roman_sf ( 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT , italic_λ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.2. </span>Per-Connection and Per-Destination</h4>
<div class="ltx_para" id="A1.SS1.SSS2.p1">
<p class="ltx_p" id="A1.SS1.SSS2.p1.2">Per-connection and per-destination counters also increment sequentially and thus must exhaust all IPID values before a collision can occur.
Thus, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E8" title="In A.1.1. Globally Incrementing ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">8</span></a> also describes the probability of <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.1.m1.1"><semantics id="A1.SS1.SSS2.p1.1.m1.1a"><mi id="A1.SS1.SSS2.p1.1.m1.1.1" xref="A1.SS1.SSS2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.1.m1.1b"><ci id="A1.SS1.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.1.m1.1d">italic_S</annotation></semantics></math> producing a collision at <math alttext="C" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.2.m2.1"><semantics id="A1.SS1.SSS2.p1.2.m2.1a"><mi id="A1.SS1.SSS2.p1.2.m2.1.1" xref="A1.SS1.SSS2.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.2.m2.1b"><ci id="A1.SS1.SSS2.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.2.m2.1d">italic_C</annotation></semantics></math> when using per-connection or per-destination selection.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.3. </span>Per-Bucket (Linux)</h4>
<div class="ltx_para" id="A1.SS1.SSS3.p1">
<p class="ltx_p" id="A1.SS1.SSS3.p1.13">All packets sent from <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.1.m1.1"><semantics id="A1.SS1.SSS3.p1.1.m1.1a"><mi id="A1.SS1.SSS3.p1.1.m1.1.1" xref="A1.SS1.SSS3.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.1.m1.1b"><ci id="A1.SS1.SSS3.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS3.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.1.m1.1d">italic_S</annotation></semantics></math> to <math alttext="C" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.2.m2.1"><semantics id="A1.SS1.SSS3.p1.2.m2.1a"><mi id="A1.SS1.SSS3.p1.2.m2.1.1" xref="A1.SS1.SSS3.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.2.m2.1b"><ci id="A1.SS1.SSS3.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS3.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.2.m2.1d">italic_C</annotation></semantics></math> via the same protocol are hashed to the same bucket, so the total number of buckets has no bearing on the probability of collision.
However, bucket counters are not sequentially incrementing like those in the above methods.
Instead, Linux’s stochastic increments make it possible to skip IPID values, cycle back around, and collide in fewer than <math alttext="2^{16}" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.3.m3.1"><semantics id="A1.SS1.SSS3.p1.3.m3.1a"><msup id="A1.SS1.SSS3.p1.3.m3.1.1" xref="A1.SS1.SSS3.p1.3.m3.1.1.cmml"><mn id="A1.SS1.SSS3.p1.3.m3.1.1.2" xref="A1.SS1.SSS3.p1.3.m3.1.1.2.cmml">2</mn><mn id="A1.SS1.SSS3.p1.3.m3.1.1.3" xref="A1.SS1.SSS3.p1.3.m3.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.3.m3.1b"><apply id="A1.SS1.SSS3.p1.3.m3.1.1.cmml" xref="A1.SS1.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS3.p1.3.m3.1.1.1.cmml" xref="A1.SS1.SSS3.p1.3.m3.1.1">superscript</csymbol><cn id="A1.SS1.SSS3.p1.3.m3.1.1.2.cmml" type="integer" xref="A1.SS1.SSS3.p1.3.m3.1.1.2">2</cn><cn id="A1.SS1.SSS3.p1.3.m3.1.1.3.cmml" type="integer" xref="A1.SS1.SSS3.p1.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.3.m3.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.3.m3.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> packets.
Let <math alttext="\Delta" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.4.m4.1"><semantics id="A1.SS1.SSS3.p1.4.m4.1a"><mi id="A1.SS1.SSS3.p1.4.m4.1.1" mathvariant="normal" xref="A1.SS1.SSS3.p1.4.m4.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.4.m4.1b"><ci id="A1.SS1.SSS3.p1.4.m4.1.1.cmml" xref="A1.SS1.SSS3.p1.4.m4.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.4.m4.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.4.m4.1d">roman_Δ</annotation></semantics></math> be a random variable representing the number of system ticks since <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.5.m5.1"><semantics id="A1.SS1.SSS3.p1.5.m5.1a"><mi id="A1.SS1.SSS3.p1.5.m5.1.1" xref="A1.SS1.SSS3.p1.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.5.m5.1b"><ci id="A1.SS1.SSS3.p1.5.m5.1.1.cmml" xref="A1.SS1.SSS3.p1.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.5.m5.1d">italic_S</annotation></semantics></math> last sent a packet; thus, the next bucket increment is chosen uniformly at random from <math alttext="\{1,\ldots,\Delta\}" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.6.m6.3"><semantics id="A1.SS1.SSS3.p1.6.m6.3a"><mrow id="A1.SS1.SSS3.p1.6.m6.3.4.2" xref="A1.SS1.SSS3.p1.6.m6.3.4.1.cmml"><mo id="A1.SS1.SSS3.p1.6.m6.3.4.2.1" stretchy="false" xref="A1.SS1.SSS3.p1.6.m6.3.4.1.cmml">{</mo><mn id="A1.SS1.SSS3.p1.6.m6.1.1" xref="A1.SS1.SSS3.p1.6.m6.1.1.cmml">1</mn><mo id="A1.SS1.SSS3.p1.6.m6.3.4.2.2" xref="A1.SS1.SSS3.p1.6.m6.3.4.1.cmml">,</mo><mi id="A1.SS1.SSS3.p1.6.m6.2.2" mathvariant="normal" xref="A1.SS1.SSS3.p1.6.m6.2.2.cmml">…</mi><mo id="A1.SS1.SSS3.p1.6.m6.3.4.2.3" xref="A1.SS1.SSS3.p1.6.m6.3.4.1.cmml">,</mo><mi id="A1.SS1.SSS3.p1.6.m6.3.3" mathvariant="normal" xref="A1.SS1.SSS3.p1.6.m6.3.3.cmml">Δ</mi><mo id="A1.SS1.SSS3.p1.6.m6.3.4.2.4" stretchy="false" xref="A1.SS1.SSS3.p1.6.m6.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.6.m6.3b"><set id="A1.SS1.SSS3.p1.6.m6.3.4.1.cmml" xref="A1.SS1.SSS3.p1.6.m6.3.4.2"><cn id="A1.SS1.SSS3.p1.6.m6.1.1.cmml" type="integer" xref="A1.SS1.SSS3.p1.6.m6.1.1">1</cn><ci id="A1.SS1.SSS3.p1.6.m6.2.2.cmml" xref="A1.SS1.SSS3.p1.6.m6.2.2">…</ci><ci id="A1.SS1.SSS3.p1.6.m6.3.3.cmml" xref="A1.SS1.SSS3.p1.6.m6.3.3">Δ</ci></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.6.m6.3c">\{1,\ldots,\Delta\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.6.m6.3d">{ 1 , … , roman_Δ }</annotation></semantics></math>.
Since packet transmissions occur according to a Poisson process with rate <math alttext="\lambda" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.7.m7.1"><semantics id="A1.SS1.SSS3.p1.7.m7.1a"><mi id="A1.SS1.SSS3.p1.7.m7.1.1" xref="A1.SS1.SSS3.p1.7.m7.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.7.m7.1b"><ci id="A1.SS1.SSS3.p1.7.m7.1.1.cmml" xref="A1.SS1.SSS3.p1.7.m7.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.7.m7.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.7.m7.1d">italic_λ</annotation></semantics></math>, <math alttext="\Delta" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.8.m8.1"><semantics id="A1.SS1.SSS3.p1.8.m8.1a"><mi id="A1.SS1.SSS3.p1.8.m8.1.1" mathvariant="normal" xref="A1.SS1.SSS3.p1.8.m8.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.8.m8.1b"><ci id="A1.SS1.SSS3.p1.8.m8.1.1.cmml" xref="A1.SS1.SSS3.p1.8.m8.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.8.m8.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.8.m8.1d">roman_Δ</annotation></semantics></math> is exponentially distributed with mean <math alttext="t/\lambda" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.9.m9.1"><semantics id="A1.SS1.SSS3.p1.9.m9.1a"><mrow id="A1.SS1.SSS3.p1.9.m9.1.1" xref="A1.SS1.SSS3.p1.9.m9.1.1.cmml"><mi id="A1.SS1.SSS3.p1.9.m9.1.1.2" xref="A1.SS1.SSS3.p1.9.m9.1.1.2.cmml">t</mi><mo id="A1.SS1.SSS3.p1.9.m9.1.1.1" xref="A1.SS1.SSS3.p1.9.m9.1.1.1.cmml">/</mo><mi id="A1.SS1.SSS3.p1.9.m9.1.1.3" xref="A1.SS1.SSS3.p1.9.m9.1.1.3.cmml">λ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.9.m9.1b"><apply id="A1.SS1.SSS3.p1.9.m9.1.1.cmml" xref="A1.SS1.SSS3.p1.9.m9.1.1"><divide id="A1.SS1.SSS3.p1.9.m9.1.1.1.cmml" xref="A1.SS1.SSS3.p1.9.m9.1.1.1"></divide><ci id="A1.SS1.SSS3.p1.9.m9.1.1.2.cmml" xref="A1.SS1.SSS3.p1.9.m9.1.1.2">𝑡</ci><ci id="A1.SS1.SSS3.p1.9.m9.1.1.3.cmml" xref="A1.SS1.SSS3.p1.9.m9.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.9.m9.1c">t/\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.9.m9.1d">italic_t / italic_λ</annotation></semantics></math>, where <math alttext="t&gt;0" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.10.m10.1"><semantics id="A1.SS1.SSS3.p1.10.m10.1a"><mrow id="A1.SS1.SSS3.p1.10.m10.1.1" xref="A1.SS1.SSS3.p1.10.m10.1.1.cmml"><mi id="A1.SS1.SSS3.p1.10.m10.1.1.2" xref="A1.SS1.SSS3.p1.10.m10.1.1.2.cmml">t</mi><mo id="A1.SS1.SSS3.p1.10.m10.1.1.1" xref="A1.SS1.SSS3.p1.10.m10.1.1.1.cmml">&gt;</mo><mn id="A1.SS1.SSS3.p1.10.m10.1.1.3" xref="A1.SS1.SSS3.p1.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.10.m10.1b"><apply id="A1.SS1.SSS3.p1.10.m10.1.1.cmml" xref="A1.SS1.SSS3.p1.10.m10.1.1"><gt id="A1.SS1.SSS3.p1.10.m10.1.1.1.cmml" xref="A1.SS1.SSS3.p1.10.m10.1.1.1"></gt><ci id="A1.SS1.SSS3.p1.10.m10.1.1.2.cmml" xref="A1.SS1.SSS3.p1.10.m10.1.1.2">𝑡</ci><cn id="A1.SS1.SSS3.p1.10.m10.1.1.3.cmml" type="integer" xref="A1.SS1.SSS3.p1.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.10.m10.1c">t&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.10.m10.1d">italic_t &gt; 0</annotation></semantics></math> is the number of system ticks per unit time.
For this analysis, we set <math alttext="t=3" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.11.m11.1"><semantics id="A1.SS1.SSS3.p1.11.m11.1a"><mrow id="A1.SS1.SSS3.p1.11.m11.1.1" xref="A1.SS1.SSS3.p1.11.m11.1.1.cmml"><mi id="A1.SS1.SSS3.p1.11.m11.1.1.2" xref="A1.SS1.SSS3.p1.11.m11.1.1.2.cmml">t</mi><mo id="A1.SS1.SSS3.p1.11.m11.1.1.1" xref="A1.SS1.SSS3.p1.11.m11.1.1.1.cmml">=</mo><mn id="A1.SS1.SSS3.p1.11.m11.1.1.3" xref="A1.SS1.SSS3.p1.11.m11.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.11.m11.1b"><apply id="A1.SS1.SSS3.p1.11.m11.1.1.cmml" xref="A1.SS1.SSS3.p1.11.m11.1.1"><eq id="A1.SS1.SSS3.p1.11.m11.1.1.1.cmml" xref="A1.SS1.SSS3.p1.11.m11.1.1.1"></eq><ci id="A1.SS1.SSS3.p1.11.m11.1.1.2.cmml" xref="A1.SS1.SSS3.p1.11.m11.1.1.2">𝑡</ci><cn id="A1.SS1.SSS3.p1.11.m11.1.1.3.cmml" type="integer" xref="A1.SS1.SSS3.p1.11.m11.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.11.m11.1c">t=3</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.11.m11.1d">italic_t = 3</annotation></semantics></math>, assuming that packets spend <math alttext="\sim" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.12.m12.1"><semantics id="A1.SS1.SSS3.p1.12.m12.1a"><mo id="A1.SS1.SSS3.p1.12.m12.1.1" xref="A1.SS1.SSS3.p1.12.m12.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.12.m12.1b"><csymbol cd="latexml" id="A1.SS1.SSS3.p1.12.m12.1.1.cmml" xref="A1.SS1.SSS3.p1.12.m12.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.12.m12.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.12.m12.1d">∼</annotation></semantics></math>10 ms in transit and there are <math alttext="\sim" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.13.m13.1"><semantics id="A1.SS1.SSS3.p1.13.m13.1a"><mo id="A1.SS1.SSS3.p1.13.m13.1.1" xref="A1.SS1.SSS3.p1.13.m13.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.13.m13.1b"><csymbol cd="latexml" id="A1.SS1.SSS3.p1.13.m13.1.1.cmml" xref="A1.SS1.SSS3.p1.13.m13.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.13.m13.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.13.m13.1d">∼</annotation></semantics></math>300 ticks/s.<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>The assumption of 300 system ticks/s is consistent with Arch Linux’s implementation. Ubuntu is slightly slower, at 250 ticks/s. We chose Arch’s larger value because it generates larger stochastic increments and thus higher probabilities of collision, suitable for a worst-case analysis.</span></span></span></p>
</div>
<div class="ltx_para" id="A1.SS1.SSS3.p2">
<p class="ltx_p" id="A1.SS1.SSS3.p2.1">Unfortunately, even with these carefully constructed assumptions, <math alttext="\mathrm{Pr}\left[\text{collision}\mid N=n\right]" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p2.1.m1.1"><semantics id="A1.SS1.SSS3.p2.1.m1.1a"><mrow id="A1.SS1.SSS3.p2.1.m1.1.1" xref="A1.SS1.SSS3.p2.1.m1.1.1.cmml"><mi id="A1.SS1.SSS3.p2.1.m1.1.1.3" xref="A1.SS1.SSS3.p2.1.m1.1.1.3.cmml">Pr</mi><mo id="A1.SS1.SSS3.p2.1.m1.1.1.2" xref="A1.SS1.SSS3.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.SSS3.p2.1.m1.1.1.1.1" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.2.cmml"><mo id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.2" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml"><mrow id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.cmml"><mtext id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2a.cmml">collision</mtext><mo id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.1" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.1.cmml">∣</mo><mi id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.3" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.1" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.1.cmml">=</mo><mi id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.3" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.3" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p2.1.m1.1b"><apply id="A1.SS1.SSS3.p2.1.m1.1.1.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1"><times id="A1.SS1.SSS3.p2.1.m1.1.1.2.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.2"></times><ci id="A1.SS1.SSS3.p2.1.m1.1.1.3.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.3">Pr</ci><apply id="A1.SS1.SSS3.p2.1.m1.1.1.1.2.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.SSS3.p2.1.m1.1.1.1.2.1.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1"><eq id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.1"></eq><apply id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.1">conditional</csymbol><ci id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2a.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2"><mtext id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.2">collision</mtext></ci><ci id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.2.3">𝑁</ci></apply><ci id="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS3.p2.1.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p2.1.m1.1c">\mathrm{Pr}\left[\text{collision}\mid N=n\right]</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p2.1.m1.1d">roman_Pr [ collision ∣ italic_N = italic_n ]</annotation></semantics></math> is challenging to bound analytically—let alone to calculate explicitly—because each event is dependent on all others.
Specifically, whether a new IPID produces a collision depends on the stochastic increments that produced all preceding IPIDs.
Thus, for the sake of comparison with other methods, we estimate these conditional probabilities by simulating the generation of IPIDs via stochastic increments and then computing the overall probability of collision using Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.Ex1" title="4.2. Analyzing Correctness ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.2</span></a>.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>A careful reader might observe that the infinite sum in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.Ex1" title="4.2. Analyzing Correctness ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.2</span></a> cannot be computed directly. Our simulations instead use the finite interval of <math alttext="n\subset[0,\infty)" class="ltx_Math" display="inline" id="footnote3.m1.2"><semantics id="footnote3.m1.2b"><mrow id="footnote3.m1.2.3" xref="footnote3.m1.2.3.cmml"><mi id="footnote3.m1.2.3.2" xref="footnote3.m1.2.3.2.cmml">n</mi><mo id="footnote3.m1.2.3.1" xref="footnote3.m1.2.3.1.cmml">⊂</mo><mrow id="footnote3.m1.2.3.3.2" xref="footnote3.m1.2.3.3.1.cmml"><mo id="footnote3.m1.2.3.3.2.1" stretchy="false" xref="footnote3.m1.2.3.3.1.cmml">[</mo><mn id="footnote3.m1.1.1" xref="footnote3.m1.1.1.cmml">0</mn><mo id="footnote3.m1.2.3.3.2.2" xref="footnote3.m1.2.3.3.1.cmml">,</mo><mi id="footnote3.m1.2.2" mathvariant="normal" xref="footnote3.m1.2.2.cmml">∞</mi><mo id="footnote3.m1.2.3.3.2.3" stretchy="false" xref="footnote3.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m1.2c"><apply id="footnote3.m1.2.3.cmml" xref="footnote3.m1.2.3"><subset id="footnote3.m1.2.3.1.cmml" xref="footnote3.m1.2.3.1"></subset><ci id="footnote3.m1.2.3.2.cmml" xref="footnote3.m1.2.3.2">𝑛</ci><interval closure="closed-open" id="footnote3.m1.2.3.3.1.cmml" xref="footnote3.m1.2.3.3.2"><cn id="footnote3.m1.1.1.cmml" type="integer" xref="footnote3.m1.1.1">0</cn><infinity id="footnote3.m1.2.2.cmml" xref="footnote3.m1.2.2"></infinity></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m1.2d">n\subset[0,\infty)</annotation><annotation encoding="application/x-llamapun" id="footnote3.m1.2e">italic_n ⊂ [ 0 , ∞ )</annotation></semantics></math> containing all non-negligible Poisson probability mass; i.e., all <math alttext="n" class="ltx_Math" display="inline" id="footnote3.m2.1"><semantics id="footnote3.m2.1b"><mi id="footnote3.m2.1.1" xref="footnote3.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="footnote3.m2.1c"><ci id="footnote3.m2.1.1.cmml" xref="footnote3.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m2.1d">n</annotation><annotation encoding="application/x-llamapun" id="footnote3.m2.1e">italic_n</annotation></semantics></math> such that <math alttext="\mathrm{pmf}(n,\lambda)&gt;\numprint{5e-324}" class="ltx_Math" display="inline" id="footnote3.m3.2"><semantics id="footnote3.m3.2b"><mrow id="footnote3.m3.2.3" xref="footnote3.m3.2.3.cmml"><mrow id="footnote3.m3.2.3.2" xref="footnote3.m3.2.3.2.cmml"><mi id="footnote3.m3.2.3.2.2" xref="footnote3.m3.2.3.2.2.cmml">pmf</mi><mo id="footnote3.m3.2.3.2.1" xref="footnote3.m3.2.3.2.1.cmml">⁢</mo><mrow id="footnote3.m3.2.3.2.3.2" xref="footnote3.m3.2.3.2.3.1.cmml"><mo id="footnote3.m3.2.3.2.3.2.1" stretchy="false" xref="footnote3.m3.2.3.2.3.1.cmml">(</mo><mi id="footnote3.m3.1.1" xref="footnote3.m3.1.1.cmml">n</mi><mo id="footnote3.m3.2.3.2.3.2.2" xref="footnote3.m3.2.3.2.3.1.cmml">,</mo><mi id="footnote3.m3.2.2" xref="footnote3.m3.2.2.cmml">λ</mi><mo id="footnote3.m3.2.3.2.3.2.3" stretchy="false" xref="footnote3.m3.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="footnote3.m3.2.3.1" xref="footnote3.m3.2.3.1.cmml">&gt;</mo><mrow id="footnote3.m3.2.3.3.2" xref="footnote3.m3.2.3.cmml"><mn id="footnote3.m3.2.3.3.2.2" xref="footnote3.m3.2.3.3.1.cmml">5</mn><mo id="footnote3.m3.2.3.3.2.1" xref="footnote3.m3.2.3.3.1.cmml">⁢</mo><mi id="footnote3.m3.2.3.3.2.3" mathvariant="normal" xref="footnote3.m3.2.3.3.1.cmml">×</mi><mo id="footnote3.m3.2.3.3.2.1b" xref="footnote3.m3.2.3.3.1.cmml">⁢</mo><msup id="footnote3.m3.2.3.3.2.4" xref="footnote3.m3.2.3.cmml"><mn id="footnote3.m3.2.3.3.2.4.2" xref="footnote3.m3.2.3.3.1.cmml">10</mn><mrow id="footnote3.m3.2.3.3.2.4.3" xref="footnote3.m3.2.3.cmml"><mo id="footnote3.m3.2.3.3.2.4.3b" xref="footnote3.m3.2.3.3.1.cmml">−</mo><mn id="footnote3.m3.2.3.3.2.4.3.2" xref="footnote3.m3.2.3.3.1.cmml">324</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m3.2c"><apply id="footnote3.m3.2.3.cmml" xref="footnote3.m3.2.3"><gt id="footnote3.m3.2.3.1.cmml" xref="footnote3.m3.2.3.1"></gt><apply id="footnote3.m3.2.3.2.cmml" xref="footnote3.m3.2.3.2"><times id="footnote3.m3.2.3.2.1.cmml" xref="footnote3.m3.2.3.2.1"></times><ci id="footnote3.m3.2.3.2.2.cmml" xref="footnote3.m3.2.3.2.2">pmf</ci><interval closure="open" id="footnote3.m3.2.3.2.3.1.cmml" xref="footnote3.m3.2.3.2.3.2"><ci id="footnote3.m3.1.1.cmml" xref="footnote3.m3.1.1">𝑛</ci><ci id="footnote3.m3.2.2.cmml" xref="footnote3.m3.2.2">𝜆</ci></interval></apply><cn id="footnote3.m3.2.3.3.1.cmml" type="float" xref="footnote3.m3.2.3.3.2.2">5e-324</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m3.2d">\mathrm{pmf}(n,\lambda)&gt;\numprint{5e-324}</annotation><annotation encoding="application/x-llamapun" id="footnote3.m3.2e">roman_pmf ( italic_n , italic_λ ) &gt; 5 × 10 start_POSTSUPERSCRIPT - 324 end_POSTSUPERSCRIPT</annotation></semantics></math>. We reuse this trick when evaluating Eqs. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E14" title="In A.2.1. Globally Incrementing ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">14</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E17" title="In A.2.4. Per-Bucket (Linux) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">17</span></a>.</span></span></span></p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.4. </span>PRNG (searchable queue of size <math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.SSS4.1.m1.1"><semantics id="A1.SS1.SSS4.1.m1.1b"><mi id="A1.SS1.SSS4.1.m1.1.1" xref="A1.SS1.SSS4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.1.m1.1c"><ci id="A1.SS1.SSS4.1.m1.1.1.cmml" xref="A1.SS1.SSS4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.1.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.1.m1.1e">italic_k</annotation></semantics></math>)</h4>
<div class="ltx_para" id="A1.SS1.SSS4.p1">
<p class="ltx_p" id="A1.SS1.SSS4.p1.11">For the purposes of analysis, we assume that the PRNG algorithm in use sufficiently approximates a uniform distribution over all possible IPID values; i.e., any given IPID is chosen with probability <math alttext="1/2^{16}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.1.m1.1"><semantics id="A1.SS1.SSS4.p1.1.m1.1a"><mrow id="A1.SS1.SSS4.p1.1.m1.1.1" xref="A1.SS1.SSS4.p1.1.m1.1.1.cmml"><mn id="A1.SS1.SSS4.p1.1.m1.1.1.2" xref="A1.SS1.SSS4.p1.1.m1.1.1.2.cmml">1</mn><mo id="A1.SS1.SSS4.p1.1.m1.1.1.1" xref="A1.SS1.SSS4.p1.1.m1.1.1.1.cmml">/</mo><msup id="A1.SS1.SSS4.p1.1.m1.1.1.3" xref="A1.SS1.SSS4.p1.1.m1.1.1.3.cmml"><mn id="A1.SS1.SSS4.p1.1.m1.1.1.3.2" xref="A1.SS1.SSS4.p1.1.m1.1.1.3.2.cmml">2</mn><mn id="A1.SS1.SSS4.p1.1.m1.1.1.3.3" xref="A1.SS1.SSS4.p1.1.m1.1.1.3.3.cmml">16</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.1.m1.1b"><apply id="A1.SS1.SSS4.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS4.p1.1.m1.1.1"><divide id="A1.SS1.SSS4.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS4.p1.1.m1.1.1.1"></divide><cn id="A1.SS1.SSS4.p1.1.m1.1.1.2.cmml" type="integer" xref="A1.SS1.SSS4.p1.1.m1.1.1.2">1</cn><apply id="A1.SS1.SSS4.p1.1.m1.1.1.3.cmml" xref="A1.SS1.SSS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p1.1.m1.1.1.3.1.cmml" xref="A1.SS1.SSS4.p1.1.m1.1.1.3">superscript</csymbol><cn id="A1.SS1.SSS4.p1.1.m1.1.1.3.2.cmml" type="integer" xref="A1.SS1.SSS4.p1.1.m1.1.1.3.2">2</cn><cn id="A1.SS1.SSS4.p1.1.m1.1.1.3.3.cmml" type="integer" xref="A1.SS1.SSS4.p1.1.m1.1.1.3.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.1.m1.1c">1/2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.1.m1.1d">1 / 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>.
In the setting where no recent IPIDs are stored (i.e., when <math alttext="k=0" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.2.m2.1"><semantics id="A1.SS1.SSS4.p1.2.m2.1a"><mrow id="A1.SS1.SSS4.p1.2.m2.1.1" xref="A1.SS1.SSS4.p1.2.m2.1.1.cmml"><mi id="A1.SS1.SSS4.p1.2.m2.1.1.2" xref="A1.SS1.SSS4.p1.2.m2.1.1.2.cmml">k</mi><mo id="A1.SS1.SSS4.p1.2.m2.1.1.1" xref="A1.SS1.SSS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS1.SSS4.p1.2.m2.1.1.3" xref="A1.SS1.SSS4.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.2.m2.1b"><apply id="A1.SS1.SSS4.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS4.p1.2.m2.1.1"><eq id="A1.SS1.SSS4.p1.2.m2.1.1.1.cmml" xref="A1.SS1.SSS4.p1.2.m2.1.1.1"></eq><ci id="A1.SS1.SSS4.p1.2.m2.1.1.2.cmml" xref="A1.SS1.SSS4.p1.2.m2.1.1.2">𝑘</ci><cn id="A1.SS1.SSS4.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.2.m2.1c">k=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.2.m2.1d">italic_k = 0</annotation></semantics></math>) and the number of packets simultaneously in transit is <math alttext="N=n" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.3.m3.1"><semantics id="A1.SS1.SSS4.p1.3.m3.1a"><mrow id="A1.SS1.SSS4.p1.3.m3.1.1" xref="A1.SS1.SSS4.p1.3.m3.1.1.cmml"><mi id="A1.SS1.SSS4.p1.3.m3.1.1.2" xref="A1.SS1.SSS4.p1.3.m3.1.1.2.cmml">N</mi><mo id="A1.SS1.SSS4.p1.3.m3.1.1.1" xref="A1.SS1.SSS4.p1.3.m3.1.1.1.cmml">=</mo><mi id="A1.SS1.SSS4.p1.3.m3.1.1.3" xref="A1.SS1.SSS4.p1.3.m3.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.3.m3.1b"><apply id="A1.SS1.SSS4.p1.3.m3.1.1.cmml" xref="A1.SS1.SSS4.p1.3.m3.1.1"><eq id="A1.SS1.SSS4.p1.3.m3.1.1.1.cmml" xref="A1.SS1.SSS4.p1.3.m3.1.1.1"></eq><ci id="A1.SS1.SSS4.p1.3.m3.1.1.2.cmml" xref="A1.SS1.SSS4.p1.3.m3.1.1.2">𝑁</ci><ci id="A1.SS1.SSS4.p1.3.m3.1.1.3.cmml" xref="A1.SS1.SSS4.p1.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.3.m3.1c">N=n</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.3.m3.1d">italic_N = italic_n</annotation></semantics></math>, the probability of <math alttext="S" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.4.m4.1"><semantics id="A1.SS1.SSS4.p1.4.m4.1a"><mi id="A1.SS1.SSS4.p1.4.m4.1.1" xref="A1.SS1.SSS4.p1.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.4.m4.1b"><ci id="A1.SS1.SSS4.p1.4.m4.1.1.cmml" xref="A1.SS1.SSS4.p1.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.4.m4.1d">italic_S</annotation></semantics></math> producing a collision at <math alttext="C" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.5.m5.1"><semantics id="A1.SS1.SSS4.p1.5.m5.1a"><mi id="A1.SS1.SSS4.p1.5.m5.1.1" xref="A1.SS1.SSS4.p1.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.5.m5.1b"><ci id="A1.SS1.SSS4.p1.5.m5.1.1.cmml" xref="A1.SS1.SSS4.p1.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.5.m5.1d">italic_C</annotation></semantics></math> reduces to the birthday problem with <math alttext="n" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.6.m6.1"><semantics id="A1.SS1.SSS4.p1.6.m6.1a"><mi id="A1.SS1.SSS4.p1.6.m6.1.1" xref="A1.SS1.SSS4.p1.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.6.m6.1b"><ci id="A1.SS1.SSS4.p1.6.m6.1.1.cmml" xref="A1.SS1.SSS4.p1.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.6.m6.1d">italic_n</annotation></semantics></math> “people” (the packets) and <math alttext="2^{16}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.7.m7.1"><semantics id="A1.SS1.SSS4.p1.7.m7.1a"><msup id="A1.SS1.SSS4.p1.7.m7.1.1" xref="A1.SS1.SSS4.p1.7.m7.1.1.cmml"><mn id="A1.SS1.SSS4.p1.7.m7.1.1.2" xref="A1.SS1.SSS4.p1.7.m7.1.1.2.cmml">2</mn><mn id="A1.SS1.SSS4.p1.7.m7.1.1.3" xref="A1.SS1.SSS4.p1.7.m7.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.7.m7.1b"><apply id="A1.SS1.SSS4.p1.7.m7.1.1.cmml" xref="A1.SS1.SSS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p1.7.m7.1.1.1.cmml" xref="A1.SS1.SSS4.p1.7.m7.1.1">superscript</csymbol><cn id="A1.SS1.SSS4.p1.7.m7.1.1.2.cmml" type="integer" xref="A1.SS1.SSS4.p1.7.m7.1.1.2">2</cn><cn id="A1.SS1.SSS4.p1.7.m7.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p1.7.m7.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.7.m7.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.7.m7.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> “days” (the IPIDs).<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The OpenBSD, FreeBSD, and macOS implementations of PRNG selection reserve zero as a special IPID that is never returned (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3" title="2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.3</span></a>). This detail is omitted for clarity, but is easily addressed by replacing <math alttext="2^{16}" class="ltx_Math" display="inline" id="footnote4.m1.1"><semantics id="footnote4.m1.1b"><msup id="footnote4.m1.1.1" xref="footnote4.m1.1.1.cmml"><mn id="footnote4.m1.1.1.2" xref="footnote4.m1.1.1.2.cmml">2</mn><mn id="footnote4.m1.1.1.3" xref="footnote4.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="footnote4.m1.1c"><apply id="footnote4.m1.1.1.cmml" xref="footnote4.m1.1.1"><csymbol cd="ambiguous" id="footnote4.m1.1.1.1.cmml" xref="footnote4.m1.1.1">superscript</csymbol><cn id="footnote4.m1.1.1.2.cmml" type="integer" xref="footnote4.m1.1.1.2">2</cn><cn id="footnote4.m1.1.1.3.cmml" type="integer" xref="footnote4.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m1.1d">2^{16}</annotation><annotation encoding="application/x-llamapun" id="footnote4.m1.1e">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> total IPIDs with <math alttext="2^{16}-1" class="ltx_Math" display="inline" id="footnote4.m2.1"><semantics id="footnote4.m2.1b"><mrow id="footnote4.m2.1.1" xref="footnote4.m2.1.1.cmml"><msup id="footnote4.m2.1.1.2" xref="footnote4.m2.1.1.2.cmml"><mn id="footnote4.m2.1.1.2.2" xref="footnote4.m2.1.1.2.2.cmml">2</mn><mn id="footnote4.m2.1.1.2.3" xref="footnote4.m2.1.1.2.3.cmml">16</mn></msup><mo id="footnote4.m2.1.1.1" xref="footnote4.m2.1.1.1.cmml">−</mo><mn id="footnote4.m2.1.1.3" xref="footnote4.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote4.m2.1c"><apply id="footnote4.m2.1.1.cmml" xref="footnote4.m2.1.1"><minus id="footnote4.m2.1.1.1.cmml" xref="footnote4.m2.1.1.1"></minus><apply id="footnote4.m2.1.1.2.cmml" xref="footnote4.m2.1.1.2"><csymbol cd="ambiguous" id="footnote4.m2.1.1.2.1.cmml" xref="footnote4.m2.1.1.2">superscript</csymbol><cn id="footnote4.m2.1.1.2.2.cmml" type="integer" xref="footnote4.m2.1.1.2.2">2</cn><cn id="footnote4.m2.1.1.2.3.cmml" type="integer" xref="footnote4.m2.1.1.2.3">16</cn></apply><cn id="footnote4.m2.1.1.3.cmml" type="integer" xref="footnote4.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m2.1d">2^{16}-1</annotation><annotation encoding="application/x-llamapun" id="footnote4.m2.1e">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - 1</annotation></semantics></math> non-zero IPIDs.</span></span></span>
More generally, with a searchable queue of size <math alttext="k\geq 0" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.8.m8.1"><semantics id="A1.SS1.SSS4.p1.8.m8.1a"><mrow id="A1.SS1.SSS4.p1.8.m8.1.1" xref="A1.SS1.SSS4.p1.8.m8.1.1.cmml"><mi id="A1.SS1.SSS4.p1.8.m8.1.1.2" xref="A1.SS1.SSS4.p1.8.m8.1.1.2.cmml">k</mi><mo id="A1.SS1.SSS4.p1.8.m8.1.1.1" xref="A1.SS1.SSS4.p1.8.m8.1.1.1.cmml">≥</mo><mn id="A1.SS1.SSS4.p1.8.m8.1.1.3" xref="A1.SS1.SSS4.p1.8.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.8.m8.1b"><apply id="A1.SS1.SSS4.p1.8.m8.1.1.cmml" xref="A1.SS1.SSS4.p1.8.m8.1.1"><geq id="A1.SS1.SSS4.p1.8.m8.1.1.1.cmml" xref="A1.SS1.SSS4.p1.8.m8.1.1.1"></geq><ci id="A1.SS1.SSS4.p1.8.m8.1.1.2.cmml" xref="A1.SS1.SSS4.p1.8.m8.1.1.2">𝑘</ci><cn id="A1.SS1.SSS4.p1.8.m8.1.1.3.cmml" type="integer" xref="A1.SS1.SSS4.p1.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.8.m8.1c">k\geq 0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.8.m8.1d">italic_k ≥ 0</annotation></semantics></math>, we are guaranteed that the next IPID will be distinct from the last <math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.9.m9.1"><semantics id="A1.SS1.SSS4.p1.9.m9.1a"><mi id="A1.SS1.SSS4.p1.9.m9.1.1" xref="A1.SS1.SSS4.p1.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.9.m9.1b"><ci id="A1.SS1.SSS4.p1.9.m9.1.1.cmml" xref="A1.SS1.SSS4.p1.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.9.m9.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.9.m9.1d">italic_k</annotation></semantics></math> generated IPIDs.
If <math alttext="n&gt;k" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.10.m10.1"><semantics id="A1.SS1.SSS4.p1.10.m10.1a"><mrow id="A1.SS1.SSS4.p1.10.m10.1.1" xref="A1.SS1.SSS4.p1.10.m10.1.1.cmml"><mi id="A1.SS1.SSS4.p1.10.m10.1.1.2" xref="A1.SS1.SSS4.p1.10.m10.1.1.2.cmml">n</mi><mo id="A1.SS1.SSS4.p1.10.m10.1.1.1" xref="A1.SS1.SSS4.p1.10.m10.1.1.1.cmml">&gt;</mo><mi id="A1.SS1.SSS4.p1.10.m10.1.1.3" xref="A1.SS1.SSS4.p1.10.m10.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.10.m10.1b"><apply id="A1.SS1.SSS4.p1.10.m10.1.1.cmml" xref="A1.SS1.SSS4.p1.10.m10.1.1"><gt id="A1.SS1.SSS4.p1.10.m10.1.1.1.cmml" xref="A1.SS1.SSS4.p1.10.m10.1.1.1"></gt><ci id="A1.SS1.SSS4.p1.10.m10.1.1.2.cmml" xref="A1.SS1.SSS4.p1.10.m10.1.1.2">𝑛</ci><ci id="A1.SS1.SSS4.p1.10.m10.1.1.3.cmml" xref="A1.SS1.SSS4.p1.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.10.m10.1c">n&gt;k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.10.m10.1d">italic_n &gt; italic_k</annotation></semantics></math>, the remaining <math alttext="n-k" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.11.m11.1"><semantics id="A1.SS1.SSS4.p1.11.m11.1a"><mrow id="A1.SS1.SSS4.p1.11.m11.1.1" xref="A1.SS1.SSS4.p1.11.m11.1.1.cmml"><mi id="A1.SS1.SSS4.p1.11.m11.1.1.2" xref="A1.SS1.SSS4.p1.11.m11.1.1.2.cmml">n</mi><mo id="A1.SS1.SSS4.p1.11.m11.1.1.1" xref="A1.SS1.SSS4.p1.11.m11.1.1.1.cmml">−</mo><mi id="A1.SS1.SSS4.p1.11.m11.1.1.3" xref="A1.SS1.SSS4.p1.11.m11.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.11.m11.1b"><apply id="A1.SS1.SSS4.p1.11.m11.1.1.cmml" xref="A1.SS1.SSS4.p1.11.m11.1.1"><minus id="A1.SS1.SSS4.p1.11.m11.1.1.1.cmml" xref="A1.SS1.SSS4.p1.11.m11.1.1.1"></minus><ci id="A1.SS1.SSS4.p1.11.m11.1.1.2.cmml" xref="A1.SS1.SSS4.p1.11.m11.1.1.2">𝑛</ci><ci id="A1.SS1.SSS4.p1.11.m11.1.1.3.cmml" xref="A1.SS1.SSS4.p1.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.11.m11.1c">n-k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.11.m11.1d">italic_n - italic_k</annotation></semantics></math> IPIDs may collide with any newly generated IPID according to the birthday problem, yielding</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{collision}\mid N=n\right]=\left\{\begin{array}[]{ll}0&amp;%
\text{if $n\leq k$};\\
1-\prod_{i=0}^{n-k-1}\left(1-\frac{i}{2^{16}-k}\right)&amp;\text{if $k&lt;n\leq 2^{16%
}$};\\
1&amp;\text{if $n&gt;2^{16}$}.\end{array}\right." class="ltx_Math" display="block" id="A1.E9.m1.5"><semantics id="A1.E9.m1.5a"><mrow id="A1.E9.m1.5.5" xref="A1.E9.m1.5.5.cmml"><mrow id="A1.E9.m1.5.5.1" xref="A1.E9.m1.5.5.1.cmml"><mi id="A1.E9.m1.5.5.1.3" xref="A1.E9.m1.5.5.1.3.cmml">Pr</mi><mo id="A1.E9.m1.5.5.1.2" xref="A1.E9.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.5.5.1.1.1" xref="A1.E9.m1.5.5.1.1.2.cmml"><mo id="A1.E9.m1.5.5.1.1.1.2" xref="A1.E9.m1.5.5.1.1.2.1.cmml">[</mo><mrow id="A1.E9.m1.5.5.1.1.1.1" xref="A1.E9.m1.5.5.1.1.1.1.cmml"><mrow id="A1.E9.m1.5.5.1.1.1.1.2" xref="A1.E9.m1.5.5.1.1.1.1.2.cmml"><mtext id="A1.E9.m1.5.5.1.1.1.1.2.2" xref="A1.E9.m1.5.5.1.1.1.1.2.2a.cmml">collision</mtext><mo id="A1.E9.m1.5.5.1.1.1.1.2.1" xref="A1.E9.m1.5.5.1.1.1.1.2.1.cmml">∣</mo><mi id="A1.E9.m1.5.5.1.1.1.1.2.3" xref="A1.E9.m1.5.5.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="A1.E9.m1.5.5.1.1.1.1.1" xref="A1.E9.m1.5.5.1.1.1.1.1.cmml">=</mo><mi id="A1.E9.m1.5.5.1.1.1.1.3" xref="A1.E9.m1.5.5.1.1.1.1.3.cmml">n</mi></mrow><mo id="A1.E9.m1.5.5.1.1.1.3" xref="A1.E9.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E9.m1.5.5.2" xref="A1.E9.m1.5.5.2.cmml">=</mo><mrow id="A1.E9.m1.5.5.3.2" xref="A1.E9.m1.5.5.3.1.cmml"><mo id="A1.E9.m1.5.5.3.2.1" xref="A1.E9.m1.5.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A1.E9.m1.4.4" rowspacing="0pt" xref="A1.E9.m1.4.4.cmml"><mtr id="A1.E9.m1.4.4a" xref="A1.E9.m1.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E9.m1.4.4b" xref="A1.E9.m1.4.4.cmml"><mn id="A1.E9.m1.1.1.1.2.1" xref="A1.E9.m1.1.1.1.2.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E9.m1.4.4c" xref="A1.E9.m1.4.4.cmml"><mrow id="A1.E9.m1.1.1.1.1.1.3" xref="A1.E9.m1.1.1.1.1.1.1.1b.cmml"><mrow id="A1.E9.m1.1.1.1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1b.cmml"><mtext id="A1.E9.m1.1.1.1.1.1.1.1a" xref="A1.E9.m1.1.1.1.1.1.1.1a.cmml">if </mtext><mrow id="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.2" xref="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml">n</mi><mo id="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.1" xref="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml">≤</mo><mi id="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.3" xref="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml">k</mi></mrow></mrow><mo id="A1.E9.m1.1.1.1.1.1.3.1" xref="A1.E9.m1.1.1.1.1.1.1.1b.cmml">;</mo></mrow></mtd></mtr><mtr id="A1.E9.m1.4.4d" xref="A1.E9.m1.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E9.m1.4.4e" xref="A1.E9.m1.4.4.cmml"><mrow id="A1.E9.m1.4.4.4.2.1" xref="A1.E9.m1.4.4.4.2.1.cmml"><mn id="A1.E9.m1.4.4.4.2.1.3" xref="A1.E9.m1.4.4.4.2.1.3.cmml">1</mn><mo id="A1.E9.m1.4.4.4.2.1.2" xref="A1.E9.m1.4.4.4.2.1.2.cmml">−</mo><mrow id="A1.E9.m1.4.4.4.2.1.1" xref="A1.E9.m1.4.4.4.2.1.1.cmml"><mstyle displaystyle="false" id="A1.E9.m1.4.4.4.2.1.1.2" xref="A1.E9.m1.4.4.4.2.1.1.2.cmml"><msubsup id="A1.E9.m1.4.4.4.2.1.1.2a" xref="A1.E9.m1.4.4.4.2.1.1.2.cmml"><mo id="A1.E9.m1.4.4.4.2.1.1.2.2.2" xref="A1.E9.m1.4.4.4.2.1.1.2.2.2.cmml">∏</mo><mrow id="A1.E9.m1.4.4.4.2.1.1.2.2.3" xref="A1.E9.m1.4.4.4.2.1.1.2.2.3.cmml"><mi id="A1.E9.m1.4.4.4.2.1.1.2.2.3.2" xref="A1.E9.m1.4.4.4.2.1.1.2.2.3.2.cmml">i</mi><mo id="A1.E9.m1.4.4.4.2.1.1.2.2.3.1" xref="A1.E9.m1.4.4.4.2.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E9.m1.4.4.4.2.1.1.2.2.3.3" xref="A1.E9.m1.4.4.4.2.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A1.E9.m1.4.4.4.2.1.1.2.3" xref="A1.E9.m1.4.4.4.2.1.1.2.3.cmml"><mi id="A1.E9.m1.4.4.4.2.1.1.2.3.2" xref="A1.E9.m1.4.4.4.2.1.1.2.3.2.cmml">n</mi><mo id="A1.E9.m1.4.4.4.2.1.1.2.3.1" xref="A1.E9.m1.4.4.4.2.1.1.2.3.1.cmml">−</mo><mi id="A1.E9.m1.4.4.4.2.1.1.2.3.3" xref="A1.E9.m1.4.4.4.2.1.1.2.3.3.cmml">k</mi><mo id="A1.E9.m1.4.4.4.2.1.1.2.3.1a" xref="A1.E9.m1.4.4.4.2.1.1.2.3.1.cmml">−</mo><mn id="A1.E9.m1.4.4.4.2.1.1.2.3.4" xref="A1.E9.m1.4.4.4.2.1.1.2.3.4.cmml">1</mn></mrow></msubsup></mstyle><mrow id="A1.E9.m1.4.4.4.2.1.1.1.1" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.cmml"><mo id="A1.E9.m1.4.4.4.2.1.1.1.1.2" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.4.4.4.2.1.1.1.1.1" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.cmml"><mn id="A1.E9.m1.4.4.4.2.1.1.1.1.1.2" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E9.m1.4.4.4.2.1.1.1.1.1.1" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="false" id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.cmml"><mfrac id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3a" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.cmml"><mi id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.2" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.2.cmml">i</mi><mrow id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.cmml"><msup id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.cmml"><mn id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.2" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.2.cmml">2</mn><mn id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.3" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.3.cmml">16</mn></msup><mo id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.1" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.1.cmml">−</mo><mi id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.3" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.3.cmml">k</mi></mrow></mfrac></mstyle></mrow><mo id="A1.E9.m1.4.4.4.2.1.1.1.1.3" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E9.m1.4.4f" xref="A1.E9.m1.4.4.cmml"><mrow id="A1.E9.m1.2.2.2.1.1.3" xref="A1.E9.m1.2.2.2.1.1.1.1b.cmml"><mrow id="A1.E9.m1.2.2.2.1.1.1.1" xref="A1.E9.m1.2.2.2.1.1.1.1b.cmml"><mtext id="A1.E9.m1.2.2.2.1.1.1.1a" xref="A1.E9.m1.2.2.2.1.1.1.1a.cmml">if </mtext><mrow id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.cmml"><mi id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.2" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.2.cmml">k</mi><mo id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.3" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.3.cmml">&lt;</mo><mi id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.4" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.4.cmml">n</mi><mo id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.5" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.5.cmml">≤</mo><msup id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.cmml"><mn id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.2" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.2.cmml">2</mn><mn id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.3" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.E9.m1.2.2.2.1.1.3.1" xref="A1.E9.m1.2.2.2.1.1.1.1b.cmml">;</mo></mrow></mtd></mtr><mtr id="A1.E9.m1.4.4g" xref="A1.E9.m1.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E9.m1.4.4h" xref="A1.E9.m1.4.4.cmml"><mn id="A1.E9.m1.3.3.3.2.1" xref="A1.E9.m1.3.3.3.2.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E9.m1.4.4i" xref="A1.E9.m1.4.4.cmml"><mrow id="A1.E9.m1.3.3.3.1.1.3" xref="A1.E9.m1.3.3.3.1.1.1.1b.cmml"><mrow id="A1.E9.m1.3.3.3.1.1.1.1" xref="A1.E9.m1.3.3.3.1.1.1.1b.cmml"><mtext id="A1.E9.m1.3.3.3.1.1.1.1a" xref="A1.E9.m1.3.3.3.1.1.1.1a.cmml">if </mtext><mrow id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.cmml"><mi id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.2" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.2.cmml">n</mi><mo id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.1" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.1.cmml">&gt;</mo><msup id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.cmml"><mn id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.2" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.2.cmml">2</mn><mn id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.3" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.E9.m1.3.3.3.1.1.3.1" lspace="0em" xref="A1.E9.m1.3.3.3.1.1.1.1b.cmml">.</mo></mrow></mtd></mtr></mtable><mi id="A1.E9.m1.5.5.3.2.2" xref="A1.E9.m1.5.5.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.5b"><apply id="A1.E9.m1.5.5.cmml" xref="A1.E9.m1.5.5"><eq id="A1.E9.m1.5.5.2.cmml" xref="A1.E9.m1.5.5.2"></eq><apply id="A1.E9.m1.5.5.1.cmml" xref="A1.E9.m1.5.5.1"><times id="A1.E9.m1.5.5.1.2.cmml" xref="A1.E9.m1.5.5.1.2"></times><ci id="A1.E9.m1.5.5.1.3.cmml" xref="A1.E9.m1.5.5.1.3">Pr</ci><apply id="A1.E9.m1.5.5.1.1.2.cmml" xref="A1.E9.m1.5.5.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.5.5.1.1.2.1.cmml" xref="A1.E9.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="A1.E9.m1.5.5.1.1.1.1.cmml" xref="A1.E9.m1.5.5.1.1.1.1"><eq id="A1.E9.m1.5.5.1.1.1.1.1.cmml" xref="A1.E9.m1.5.5.1.1.1.1.1"></eq><apply id="A1.E9.m1.5.5.1.1.1.1.2.cmml" xref="A1.E9.m1.5.5.1.1.1.1.2"><csymbol cd="latexml" id="A1.E9.m1.5.5.1.1.1.1.2.1.cmml" xref="A1.E9.m1.5.5.1.1.1.1.2.1">conditional</csymbol><ci id="A1.E9.m1.5.5.1.1.1.1.2.2a.cmml" xref="A1.E9.m1.5.5.1.1.1.1.2.2"><mtext id="A1.E9.m1.5.5.1.1.1.1.2.2.cmml" xref="A1.E9.m1.5.5.1.1.1.1.2.2">collision</mtext></ci><ci id="A1.E9.m1.5.5.1.1.1.1.2.3.cmml" xref="A1.E9.m1.5.5.1.1.1.1.2.3">𝑁</ci></apply><ci id="A1.E9.m1.5.5.1.1.1.1.3.cmml" xref="A1.E9.m1.5.5.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="A1.E9.m1.5.5.3.1.cmml" xref="A1.E9.m1.5.5.3.2"><csymbol cd="latexml" id="A1.E9.m1.5.5.3.1.1.cmml" xref="A1.E9.m1.5.5.3.2.1">cases</csymbol><matrix id="A1.E9.m1.4.4.cmml" xref="A1.E9.m1.4.4"><matrixrow id="A1.E9.m1.4.4a.cmml" xref="A1.E9.m1.4.4"><cn id="A1.E9.m1.1.1.1.2.1.cmml" type="integer" xref="A1.E9.m1.1.1.1.2.1">0</cn><ci id="A1.E9.m1.1.1.1.1.1.1.1b.cmml" xref="A1.E9.m1.1.1.1.1.1.3"><mrow id="A1.E9.m1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.3"><mtext id="A1.E9.m1.1.1.1.1.1.1.1a.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1a">if </mtext><mrow id="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1"><mi id="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.2">n</mi><mo id="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.1">≤</mo><mi id="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="A1.E9.m1.1.1.1.1.1.1.1.m1.1.1.3">k</mi></mrow></mrow></ci></matrixrow><matrixrow id="A1.E9.m1.4.4b.cmml" xref="A1.E9.m1.4.4"><apply id="A1.E9.m1.4.4.4.2.1.cmml" xref="A1.E9.m1.4.4.4.2.1"><minus id="A1.E9.m1.4.4.4.2.1.2.cmml" xref="A1.E9.m1.4.4.4.2.1.2"></minus><cn id="A1.E9.m1.4.4.4.2.1.3.cmml" type="integer" xref="A1.E9.m1.4.4.4.2.1.3">1</cn><apply id="A1.E9.m1.4.4.4.2.1.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1"><apply id="A1.E9.m1.4.4.4.2.1.1.2.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.4.2.1.1.2.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2">superscript</csymbol><apply id="A1.E9.m1.4.4.4.2.1.1.2.2.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.4.2.1.1.2.2.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.E9.m1.4.4.4.2.1.1.2.2.2.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2.2.2">product</csymbol><apply id="A1.E9.m1.4.4.4.2.1.1.2.2.3.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2.2.3"><eq id="A1.E9.m1.4.4.4.2.1.1.2.2.3.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2.2.3.1"></eq><ci id="A1.E9.m1.4.4.4.2.1.1.2.2.3.2.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2.2.3.2">𝑖</ci><cn id="A1.E9.m1.4.4.4.2.1.1.2.2.3.3.cmml" type="integer" xref="A1.E9.m1.4.4.4.2.1.1.2.2.3.3">0</cn></apply></apply><apply id="A1.E9.m1.4.4.4.2.1.1.2.3.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2.3"><minus id="A1.E9.m1.4.4.4.2.1.1.2.3.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2.3.1"></minus><ci id="A1.E9.m1.4.4.4.2.1.1.2.3.2.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2.3.2">𝑛</ci><ci id="A1.E9.m1.4.4.4.2.1.1.2.3.3.cmml" xref="A1.E9.m1.4.4.4.2.1.1.2.3.3">𝑘</ci><cn id="A1.E9.m1.4.4.4.2.1.1.2.3.4.cmml" type="integer" xref="A1.E9.m1.4.4.4.2.1.1.2.3.4">1</cn></apply></apply><apply id="A1.E9.m1.4.4.4.2.1.1.1.1.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1"><minus id="A1.E9.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.1"></minus><cn id="A1.E9.m1.4.4.4.2.1.1.1.1.1.2.cmml" type="integer" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.2">1</cn><apply id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3"><divide id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3"></divide><ci id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.2.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.2">𝑖</ci><apply id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3"><minus id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.1"></minus><apply id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.1.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2">superscript</csymbol><cn id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.2.cmml" type="integer" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.2">2</cn><cn id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.2.3">16</cn></apply><ci id="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.3.cmml" xref="A1.E9.m1.4.4.4.2.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply></apply><ci id="A1.E9.m1.2.2.2.1.1.1.1b.cmml" xref="A1.E9.m1.2.2.2.1.1.3"><mrow id="A1.E9.m1.2.2.2.1.1.1.1.cmml" xref="A1.E9.m1.2.2.2.1.1.3"><mtext id="A1.E9.m1.2.2.2.1.1.1.1a.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1a">if </mtext><mrow id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1"><mi id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.2.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.2">k</mi><mo id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.3.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.3">&lt;</mo><mi id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.4.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.4">n</mi><mo id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.5.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.5">≤</mo><msup id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6"><mn id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.2.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.2">2</mn><mn id="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.3.cmml" xref="A1.E9.m1.2.2.2.1.1.1.1.m1.1.1.6.3">16</mn></msup></mrow></mrow></ci></matrixrow><matrixrow id="A1.E9.m1.4.4c.cmml" xref="A1.E9.m1.4.4"><cn id="A1.E9.m1.3.3.3.2.1.cmml" type="integer" xref="A1.E9.m1.3.3.3.2.1">1</cn><ci id="A1.E9.m1.3.3.3.1.1.1.1b.cmml" xref="A1.E9.m1.3.3.3.1.1.3"><mrow id="A1.E9.m1.3.3.3.1.1.1.1.cmml" xref="A1.E9.m1.3.3.3.1.1.3"><mtext id="A1.E9.m1.3.3.3.1.1.1.1a.cmml" xref="A1.E9.m1.3.3.3.1.1.1.1a">if </mtext><mrow id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.cmml" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1"><mi id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.2.cmml" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.2">n</mi><mo id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.1.cmml" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.1">&gt;</mo><msup id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.cmml" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3"><mn id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.2.cmml" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.2">2</mn><mn id="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.3.cmml" xref="A1.E9.m1.3.3.3.1.1.1.1.m1.1.1.3.3">16</mn></msup></mrow></mrow></ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.5c">\mathrm{Pr}\left[\text{collision}\mid N=n\right]=\left\{\begin{array}[]{ll}0&amp;%
\text{if $n\leq k$};\\
1-\prod_{i=0}^{n-k-1}\left(1-\frac{i}{2^{16}-k}\right)&amp;\text{if $k&lt;n\leq 2^{16%
}$};\\
1&amp;\text{if $n&gt;2^{16}$}.\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="A1.E9.m1.5d">roman_Pr [ collision ∣ italic_N = italic_n ] = { start_ARRAY start_ROW start_CELL 0 end_CELL start_CELL if italic_n ≤ italic_k ; end_CELL end_ROW start_ROW start_CELL 1 - ∏ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n - italic_k - 1 end_POSTSUPERSCRIPT ( 1 - divide start_ARG italic_i end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k end_ARG ) end_CELL start_CELL if italic_k &lt; italic_n ≤ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ; end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL if italic_n &gt; 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT . end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS4.p1.12">Substituting Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E9" title="In A.1.4. PRNG (searchable queue of size 𝑘) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">9</span></a> into Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.Ex1" title="4.2. Analyzing Correctness ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.2</span></a> yields</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx3">
<tbody id="A1.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{Pr}\left[\text{collision}\right]" class="ltx_Math" display="inline" id="A1.Ex2.m1.1"><semantics id="A1.Ex2.m1.1a"><mrow id="A1.Ex2.m1.1.2" xref="A1.Ex2.m1.1.2.cmml"><mi id="A1.Ex2.m1.1.2.2" xref="A1.Ex2.m1.1.2.2.cmml">Pr</mi><mo id="A1.Ex2.m1.1.2.1" xref="A1.Ex2.m1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex2.m1.1.2.3.2" xref="A1.Ex2.m1.1.2.3.1.cmml"><mo id="A1.Ex2.m1.1.2.3.2.1" xref="A1.Ex2.m1.1.2.3.1.1.cmml">[</mo><mtext id="A1.Ex2.m1.1.1" xref="A1.Ex2.m1.1.1a.cmml">collision</mtext><mo id="A1.Ex2.m1.1.2.3.2.2" xref="A1.Ex2.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2.m1.1b"><apply id="A1.Ex2.m1.1.2.cmml" xref="A1.Ex2.m1.1.2"><times id="A1.Ex2.m1.1.2.1.cmml" xref="A1.Ex2.m1.1.2.1"></times><ci id="A1.Ex2.m1.1.2.2.cmml" xref="A1.Ex2.m1.1.2.2">Pr</ci><apply id="A1.Ex2.m1.1.2.3.1.cmml" xref="A1.Ex2.m1.1.2.3.2"><csymbol cd="latexml" id="A1.Ex2.m1.1.2.3.1.1.cmml" xref="A1.Ex2.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="A1.Ex2.m1.1.1a.cmml" xref="A1.Ex2.m1.1.1"><mtext id="A1.Ex2.m1.1.1.cmml" xref="A1.Ex2.m1.1.1">collision</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m1.1c">\displaystyle\mathrm{Pr}\left[\text{collision}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2.m1.1d">roman_Pr [ collision ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=k+1}^{2^{16}}\left(1-\prod_{i=0}^{n-k-1}\left(1-\frac{i}%
{2^{16}-k}\right)\right)\cdot\mathrm{pmf}(n,\lambda)+\sum_{n=2^{16}+1}^{\infty%
}\mathrm{pmf}(n,\lambda)" class="ltx_Math" display="inline" id="A1.Ex2.m2.5"><semantics id="A1.Ex2.m2.5a"><mrow id="A1.Ex2.m2.5.5" xref="A1.Ex2.m2.5.5.cmml"><mi id="A1.Ex2.m2.5.5.3" xref="A1.Ex2.m2.5.5.3.cmml"></mi><mo id="A1.Ex2.m2.5.5.2" xref="A1.Ex2.m2.5.5.2.cmml">=</mo><mrow id="A1.Ex2.m2.5.5.1" xref="A1.Ex2.m2.5.5.1.cmml"><mrow id="A1.Ex2.m2.5.5.1.1" xref="A1.Ex2.m2.5.5.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex2.m2.5.5.1.1.2" xref="A1.Ex2.m2.5.5.1.1.2.cmml"><munderover id="A1.Ex2.m2.5.5.1.1.2a" xref="A1.Ex2.m2.5.5.1.1.2.cmml"><mo id="A1.Ex2.m2.5.5.1.1.2.2.2" movablelimits="false" xref="A1.Ex2.m2.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="A1.Ex2.m2.5.5.1.1.2.2.3" xref="A1.Ex2.m2.5.5.1.1.2.2.3.cmml"><mi id="A1.Ex2.m2.5.5.1.1.2.2.3.2" xref="A1.Ex2.m2.5.5.1.1.2.2.3.2.cmml">n</mi><mo id="A1.Ex2.m2.5.5.1.1.2.2.3.1" xref="A1.Ex2.m2.5.5.1.1.2.2.3.1.cmml">=</mo><mrow id="A1.Ex2.m2.5.5.1.1.2.2.3.3" xref="A1.Ex2.m2.5.5.1.1.2.2.3.3.cmml"><mi id="A1.Ex2.m2.5.5.1.1.2.2.3.3.2" xref="A1.Ex2.m2.5.5.1.1.2.2.3.3.2.cmml">k</mi><mo id="A1.Ex2.m2.5.5.1.1.2.2.3.3.1" xref="A1.Ex2.m2.5.5.1.1.2.2.3.3.1.cmml">+</mo><mn id="A1.Ex2.m2.5.5.1.1.2.2.3.3.3" xref="A1.Ex2.m2.5.5.1.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><msup id="A1.Ex2.m2.5.5.1.1.2.3" xref="A1.Ex2.m2.5.5.1.1.2.3.cmml"><mn id="A1.Ex2.m2.5.5.1.1.2.3.2" xref="A1.Ex2.m2.5.5.1.1.2.3.2.cmml">2</mn><mn id="A1.Ex2.m2.5.5.1.1.2.3.3" xref="A1.Ex2.m2.5.5.1.1.2.3.3.cmml">16</mn></msup></munderover></mstyle><mrow id="A1.Ex2.m2.5.5.1.1.1" xref="A1.Ex2.m2.5.5.1.1.1.cmml"><mrow id="A1.Ex2.m2.5.5.1.1.1.1" xref="A1.Ex2.m2.5.5.1.1.1.1.cmml"><mrow id="A1.Ex2.m2.5.5.1.1.1.1.1.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.cmml"><mn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.cmml"><munderover id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2a" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml">∏</mo><mrow id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mi id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.3.cmml">k</mi><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.1a" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.4" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.4.cmml">1</mn></mrow></munderover></mstyle><mrow id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3a" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mrow id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><msup id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">2</mn><mn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">16</mn></msup><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mi id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">k</mi></mrow></mfrac></mstyle></mrow><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex2.m2.5.5.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex2.m2.5.5.1.1.1.1.2" rspace="0.222em" xref="A1.Ex2.m2.5.5.1.1.1.1.2.cmml">⋅</mo><mi id="A1.Ex2.m2.5.5.1.1.1.1.3" xref="A1.Ex2.m2.5.5.1.1.1.1.3.cmml">pmf</mi></mrow><mo id="A1.Ex2.m2.5.5.1.1.1.2" xref="A1.Ex2.m2.5.5.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex2.m2.5.5.1.1.1.3.2" xref="A1.Ex2.m2.5.5.1.1.1.3.1.cmml"><mo id="A1.Ex2.m2.5.5.1.1.1.3.2.1" stretchy="false" xref="A1.Ex2.m2.5.5.1.1.1.3.1.cmml">(</mo><mi id="A1.Ex2.m2.1.1" xref="A1.Ex2.m2.1.1.cmml">n</mi><mo id="A1.Ex2.m2.5.5.1.1.1.3.2.2" xref="A1.Ex2.m2.5.5.1.1.1.3.1.cmml">,</mo><mi id="A1.Ex2.m2.2.2" xref="A1.Ex2.m2.2.2.cmml">λ</mi><mo id="A1.Ex2.m2.5.5.1.1.1.3.2.3" stretchy="false" xref="A1.Ex2.m2.5.5.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex2.m2.5.5.1.2" xref="A1.Ex2.m2.5.5.1.2.cmml">+</mo><mrow id="A1.Ex2.m2.5.5.1.3" xref="A1.Ex2.m2.5.5.1.3.cmml"><mstyle displaystyle="true" id="A1.Ex2.m2.5.5.1.3.1" xref="A1.Ex2.m2.5.5.1.3.1.cmml"><munderover id="A1.Ex2.m2.5.5.1.3.1a" xref="A1.Ex2.m2.5.5.1.3.1.cmml"><mo id="A1.Ex2.m2.5.5.1.3.1.2.2" movablelimits="false" xref="A1.Ex2.m2.5.5.1.3.1.2.2.cmml">∑</mo><mrow id="A1.Ex2.m2.5.5.1.3.1.2.3" xref="A1.Ex2.m2.5.5.1.3.1.2.3.cmml"><mi id="A1.Ex2.m2.5.5.1.3.1.2.3.2" xref="A1.Ex2.m2.5.5.1.3.1.2.3.2.cmml">n</mi><mo id="A1.Ex2.m2.5.5.1.3.1.2.3.1" xref="A1.Ex2.m2.5.5.1.3.1.2.3.1.cmml">=</mo><mrow id="A1.Ex2.m2.5.5.1.3.1.2.3.3" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.cmml"><msup id="A1.Ex2.m2.5.5.1.3.1.2.3.3.2" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.cmml"><mn id="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.2" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.2.cmml">2</mn><mn id="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.3" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.3.cmml">16</mn></msup><mo id="A1.Ex2.m2.5.5.1.3.1.2.3.3.1" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.1.cmml">+</mo><mn id="A1.Ex2.m2.5.5.1.3.1.2.3.3.3" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="A1.Ex2.m2.5.5.1.3.1.3" mathvariant="normal" xref="A1.Ex2.m2.5.5.1.3.1.3.cmml">∞</mi></munderover></mstyle><mrow id="A1.Ex2.m2.5.5.1.3.2" xref="A1.Ex2.m2.5.5.1.3.2.cmml"><mi id="A1.Ex2.m2.5.5.1.3.2.2" xref="A1.Ex2.m2.5.5.1.3.2.2.cmml">pmf</mi><mo id="A1.Ex2.m2.5.5.1.3.2.1" xref="A1.Ex2.m2.5.5.1.3.2.1.cmml">⁢</mo><mrow id="A1.Ex2.m2.5.5.1.3.2.3.2" xref="A1.Ex2.m2.5.5.1.3.2.3.1.cmml"><mo id="A1.Ex2.m2.5.5.1.3.2.3.2.1" stretchy="false" xref="A1.Ex2.m2.5.5.1.3.2.3.1.cmml">(</mo><mi id="A1.Ex2.m2.3.3" xref="A1.Ex2.m2.3.3.cmml">n</mi><mo id="A1.Ex2.m2.5.5.1.3.2.3.2.2" xref="A1.Ex2.m2.5.5.1.3.2.3.1.cmml">,</mo><mi id="A1.Ex2.m2.4.4" xref="A1.Ex2.m2.4.4.cmml">λ</mi><mo id="A1.Ex2.m2.5.5.1.3.2.3.2.3" stretchy="false" xref="A1.Ex2.m2.5.5.1.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2.m2.5b"><apply id="A1.Ex2.m2.5.5.cmml" xref="A1.Ex2.m2.5.5"><eq id="A1.Ex2.m2.5.5.2.cmml" xref="A1.Ex2.m2.5.5.2"></eq><csymbol cd="latexml" id="A1.Ex2.m2.5.5.3.cmml" xref="A1.Ex2.m2.5.5.3">absent</csymbol><apply id="A1.Ex2.m2.5.5.1.cmml" xref="A1.Ex2.m2.5.5.1"><plus id="A1.Ex2.m2.5.5.1.2.cmml" xref="A1.Ex2.m2.5.5.1.2"></plus><apply id="A1.Ex2.m2.5.5.1.1.cmml" xref="A1.Ex2.m2.5.5.1.1"><apply id="A1.Ex2.m2.5.5.1.1.2.cmml" xref="A1.Ex2.m2.5.5.1.1.2"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.1.2.1.cmml" xref="A1.Ex2.m2.5.5.1.1.2">superscript</csymbol><apply id="A1.Ex2.m2.5.5.1.1.2.2.cmml" xref="A1.Ex2.m2.5.5.1.1.2"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.1.2.2.1.cmml" xref="A1.Ex2.m2.5.5.1.1.2">subscript</csymbol><sum id="A1.Ex2.m2.5.5.1.1.2.2.2.cmml" xref="A1.Ex2.m2.5.5.1.1.2.2.2"></sum><apply id="A1.Ex2.m2.5.5.1.1.2.2.3.cmml" xref="A1.Ex2.m2.5.5.1.1.2.2.3"><eq id="A1.Ex2.m2.5.5.1.1.2.2.3.1.cmml" xref="A1.Ex2.m2.5.5.1.1.2.2.3.1"></eq><ci id="A1.Ex2.m2.5.5.1.1.2.2.3.2.cmml" xref="A1.Ex2.m2.5.5.1.1.2.2.3.2">𝑛</ci><apply id="A1.Ex2.m2.5.5.1.1.2.2.3.3.cmml" xref="A1.Ex2.m2.5.5.1.1.2.2.3.3"><plus id="A1.Ex2.m2.5.5.1.1.2.2.3.3.1.cmml" xref="A1.Ex2.m2.5.5.1.1.2.2.3.3.1"></plus><ci id="A1.Ex2.m2.5.5.1.1.2.2.3.3.2.cmml" xref="A1.Ex2.m2.5.5.1.1.2.2.3.3.2">𝑘</ci><cn id="A1.Ex2.m2.5.5.1.1.2.2.3.3.3.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.2.2.3.3.3">1</cn></apply></apply></apply><apply id="A1.Ex2.m2.5.5.1.1.2.3.cmml" xref="A1.Ex2.m2.5.5.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.1.2.3.1.cmml" xref="A1.Ex2.m2.5.5.1.1.2.3">superscript</csymbol><cn id="A1.Ex2.m2.5.5.1.1.2.3.2.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.2.3.2">2</cn><cn id="A1.Ex2.m2.5.5.1.1.2.3.3.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.2.3.3">16</cn></apply></apply><apply id="A1.Ex2.m2.5.5.1.1.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1"><times id="A1.Ex2.m2.5.5.1.1.1.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.2"></times><apply id="A1.Ex2.m2.5.5.1.1.1.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1"><ci id="A1.Ex2.m2.5.5.1.1.1.1.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.2">⋅</ci><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1"><minus id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.2"></minus><cn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.3">1</cn><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1"><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.2">product</csymbol><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3"><eq id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3"><minus id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.3">𝑘</ci><cn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.4.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.2.3.4">1</cn></apply></apply><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1"><minus id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><divide id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3"></divide><ci id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><apply id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2">superscript</csymbol><cn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">2</cn><cn id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">16</cn></apply><ci id="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply></apply><ci id="A1.Ex2.m2.5.5.1.1.1.1.3.cmml" xref="A1.Ex2.m2.5.5.1.1.1.1.3">pmf</ci></apply><interval closure="open" id="A1.Ex2.m2.5.5.1.1.1.3.1.cmml" xref="A1.Ex2.m2.5.5.1.1.1.3.2"><ci id="A1.Ex2.m2.1.1.cmml" xref="A1.Ex2.m2.1.1">𝑛</ci><ci id="A1.Ex2.m2.2.2.cmml" xref="A1.Ex2.m2.2.2">𝜆</ci></interval></apply></apply><apply id="A1.Ex2.m2.5.5.1.3.cmml" xref="A1.Ex2.m2.5.5.1.3"><apply id="A1.Ex2.m2.5.5.1.3.1.cmml" xref="A1.Ex2.m2.5.5.1.3.1"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.3.1.1.cmml" xref="A1.Ex2.m2.5.5.1.3.1">superscript</csymbol><apply id="A1.Ex2.m2.5.5.1.3.1.2.cmml" xref="A1.Ex2.m2.5.5.1.3.1"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.3.1.2.1.cmml" xref="A1.Ex2.m2.5.5.1.3.1">subscript</csymbol><sum id="A1.Ex2.m2.5.5.1.3.1.2.2.cmml" xref="A1.Ex2.m2.5.5.1.3.1.2.2"></sum><apply id="A1.Ex2.m2.5.5.1.3.1.2.3.cmml" xref="A1.Ex2.m2.5.5.1.3.1.2.3"><eq id="A1.Ex2.m2.5.5.1.3.1.2.3.1.cmml" xref="A1.Ex2.m2.5.5.1.3.1.2.3.1"></eq><ci id="A1.Ex2.m2.5.5.1.3.1.2.3.2.cmml" xref="A1.Ex2.m2.5.5.1.3.1.2.3.2">𝑛</ci><apply id="A1.Ex2.m2.5.5.1.3.1.2.3.3.cmml" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3"><plus id="A1.Ex2.m2.5.5.1.3.1.2.3.3.1.cmml" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.1"></plus><apply id="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.cmml" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.2"><csymbol cd="ambiguous" id="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.1.cmml" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.2">superscript</csymbol><cn id="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.2.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.2">2</cn><cn id="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.3.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.2.3">16</cn></apply><cn id="A1.Ex2.m2.5.5.1.3.1.2.3.3.3.cmml" type="integer" xref="A1.Ex2.m2.5.5.1.3.1.2.3.3.3">1</cn></apply></apply></apply><infinity id="A1.Ex2.m2.5.5.1.3.1.3.cmml" xref="A1.Ex2.m2.5.5.1.3.1.3"></infinity></apply><apply id="A1.Ex2.m2.5.5.1.3.2.cmml" xref="A1.Ex2.m2.5.5.1.3.2"><times id="A1.Ex2.m2.5.5.1.3.2.1.cmml" xref="A1.Ex2.m2.5.5.1.3.2.1"></times><ci id="A1.Ex2.m2.5.5.1.3.2.2.cmml" xref="A1.Ex2.m2.5.5.1.3.2.2">pmf</ci><interval closure="open" id="A1.Ex2.m2.5.5.1.3.2.3.1.cmml" xref="A1.Ex2.m2.5.5.1.3.2.3.2"><ci id="A1.Ex2.m2.3.3.cmml" xref="A1.Ex2.m2.3.3">𝑛</ci><ci id="A1.Ex2.m2.4.4.cmml" xref="A1.Ex2.m2.4.4">𝜆</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2.m2.5c">\displaystyle=\sum_{n=k+1}^{2^{16}}\left(1-\prod_{i=0}^{n-k-1}\left(1-\frac{i}%
{2^{16}-k}\right)\right)\cdot\mathrm{pmf}(n,\lambda)+\sum_{n=2^{16}+1}^{\infty%
}\mathrm{pmf}(n,\lambda)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2.m2.5d">= ∑ start_POSTSUBSCRIPT italic_n = italic_k + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ( 1 - ∏ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n - italic_k - 1 end_POSTSUPERSCRIPT ( 1 - divide start_ARG italic_i end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k end_ARG ) ) ⋅ roman_pmf ( italic_n , italic_λ ) + ∑ start_POSTSUBSCRIPT italic_n = 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_pmf ( italic_n , italic_λ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=k+1}^{2^{16}}\left(1-\prod_{i=0}^{n-k-1}\left(1-\frac{i}%
{2^{16}-k}\right)\right)\cdot\mathrm{pmf}(n,\lambda)+\mathrm{sf}(2^{16},%
\lambda)." class="ltx_Math" display="inline" id="A1.E10.m1.4"><semantics id="A1.E10.m1.4a"><mrow id="A1.E10.m1.4.4.1" xref="A1.E10.m1.4.4.1.1.cmml"><mrow id="A1.E10.m1.4.4.1.1" xref="A1.E10.m1.4.4.1.1.cmml"><mi id="A1.E10.m1.4.4.1.1.4" xref="A1.E10.m1.4.4.1.1.4.cmml"></mi><mo id="A1.E10.m1.4.4.1.1.3" xref="A1.E10.m1.4.4.1.1.3.cmml">=</mo><mrow id="A1.E10.m1.4.4.1.1.2" xref="A1.E10.m1.4.4.1.1.2.cmml"><mrow id="A1.E10.m1.4.4.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E10.m1.4.4.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.2.cmml"><munderover id="A1.E10.m1.4.4.1.1.1.1.2a" xref="A1.E10.m1.4.4.1.1.1.1.2.cmml"><mo id="A1.E10.m1.4.4.1.1.1.1.2.2.2" movablelimits="false" xref="A1.E10.m1.4.4.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.2.2.3" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.cmml"><mi id="A1.E10.m1.4.4.1.1.1.1.2.2.3.2" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.2.cmml">n</mi><mo id="A1.E10.m1.4.4.1.1.1.1.2.2.3.1" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.1.cmml">=</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.2.2.3.3" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.cmml"><mi id="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.2" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.2.cmml">k</mi><mo id="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.1" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.1.cmml">+</mo><mn id="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.3" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><msup id="A1.E10.m1.4.4.1.1.1.1.2.3" xref="A1.E10.m1.4.4.1.1.1.1.2.3.cmml"><mn id="A1.E10.m1.4.4.1.1.1.1.2.3.2" xref="A1.E10.m1.4.4.1.1.1.1.2.3.2.cmml">2</mn><mn id="A1.E10.m1.4.4.1.1.1.1.2.3.3" xref="A1.E10.m1.4.4.1.1.1.1.2.3.3.cmml">16</mn></msup></munderover></mstyle><mrow id="A1.E10.m1.4.4.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.cmml"><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><munderover id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2a" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">∏</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">k</mi><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.1a" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.4" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml">1</mn></mrow></munderover></mstyle><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3a" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mrow id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><msup id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">2</mn><mn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">16</mn></msup><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">k</mi></mrow></mfrac></mstyle></mrow><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E10.m1.4.4.1.1.1.1.1.1.2" rspace="0.222em" xref="A1.E10.m1.4.4.1.1.1.1.1.1.2.cmml">⋅</mo><mi id="A1.E10.m1.4.4.1.1.1.1.1.1.3" xref="A1.E10.m1.4.4.1.1.1.1.1.1.3.cmml">pmf</mi></mrow><mo id="A1.E10.m1.4.4.1.1.1.1.1.2" xref="A1.E10.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E10.m1.4.4.1.1.1.1.1.3.2" xref="A1.E10.m1.4.4.1.1.1.1.1.3.1.cmml"><mo id="A1.E10.m1.4.4.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E10.m1.4.4.1.1.1.1.1.3.1.cmml">(</mo><mi id="A1.E10.m1.1.1" xref="A1.E10.m1.1.1.cmml">n</mi><mo id="A1.E10.m1.4.4.1.1.1.1.1.3.2.2" xref="A1.E10.m1.4.4.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E10.m1.2.2" xref="A1.E10.m1.2.2.cmml">λ</mi><mo id="A1.E10.m1.4.4.1.1.1.1.1.3.2.3" stretchy="false" xref="A1.E10.m1.4.4.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E10.m1.4.4.1.1.2.3" xref="A1.E10.m1.4.4.1.1.2.3.cmml">+</mo><mrow id="A1.E10.m1.4.4.1.1.2.2" xref="A1.E10.m1.4.4.1.1.2.2.cmml"><mi id="A1.E10.m1.4.4.1.1.2.2.3" xref="A1.E10.m1.4.4.1.1.2.2.3.cmml">sf</mi><mo id="A1.E10.m1.4.4.1.1.2.2.2" xref="A1.E10.m1.4.4.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E10.m1.4.4.1.1.2.2.1.1" xref="A1.E10.m1.4.4.1.1.2.2.1.2.cmml"><mo id="A1.E10.m1.4.4.1.1.2.2.1.1.2" stretchy="false" xref="A1.E10.m1.4.4.1.1.2.2.1.2.cmml">(</mo><msup id="A1.E10.m1.4.4.1.1.2.2.1.1.1" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.cmml"><mn id="A1.E10.m1.4.4.1.1.2.2.1.1.1.2" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.2.cmml">2</mn><mn id="A1.E10.m1.4.4.1.1.2.2.1.1.1.3" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.3.cmml">16</mn></msup><mo id="A1.E10.m1.4.4.1.1.2.2.1.1.3" xref="A1.E10.m1.4.4.1.1.2.2.1.2.cmml">,</mo><mi id="A1.E10.m1.3.3" xref="A1.E10.m1.3.3.cmml">λ</mi><mo id="A1.E10.m1.4.4.1.1.2.2.1.1.4" stretchy="false" xref="A1.E10.m1.4.4.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E10.m1.4.4.1.2" lspace="0em" xref="A1.E10.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.4b"><apply id="A1.E10.m1.4.4.1.1.cmml" xref="A1.E10.m1.4.4.1"><eq id="A1.E10.m1.4.4.1.1.3.cmml" xref="A1.E10.m1.4.4.1.1.3"></eq><csymbol cd="latexml" id="A1.E10.m1.4.4.1.1.4.cmml" xref="A1.E10.m1.4.4.1.1.4">absent</csymbol><apply id="A1.E10.m1.4.4.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.2"><plus id="A1.E10.m1.4.4.1.1.2.3.cmml" xref="A1.E10.m1.4.4.1.1.2.3"></plus><apply id="A1.E10.m1.4.4.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1"><apply id="A1.E10.m1.4.4.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2">superscript</csymbol><apply id="A1.E10.m1.4.4.1.1.1.1.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.2.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2">subscript</csymbol><sum id="A1.E10.m1.4.4.1.1.1.1.2.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.2.2"></sum><apply id="A1.E10.m1.4.4.1.1.1.1.2.2.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3"><eq id="A1.E10.m1.4.4.1.1.1.1.2.2.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.1"></eq><ci id="A1.E10.m1.4.4.1.1.1.1.2.2.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.2">𝑛</ci><apply id="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.3"><plus id="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.1"></plus><ci id="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.2">𝑘</ci><cn id="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.3.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.2.2.3.3.3">1</cn></apply></apply></apply><apply id="A1.E10.m1.4.4.1.1.1.1.2.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.2.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.2.3">superscript</csymbol><cn id="A1.E10.m1.4.4.1.1.1.1.2.3.2.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.2.3.2">2</cn><cn id="A1.E10.m1.4.4.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.2.3.3">16</cn></apply></apply><apply id="A1.E10.m1.4.4.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1"><times id="A1.E10.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.2"></times><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1"><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.2">⋅</ci><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1"><minus id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.2"></minus><cn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3">1</cn><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1"><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2">product</csymbol><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3"><eq id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3"><minus id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑘</ci><cn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.4">1</cn></apply></apply><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><divide id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3"></divide><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><apply id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">superscript</csymbol><cn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.2">2</cn><cn id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.3">16</cn></apply><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply></apply><ci id="A1.E10.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.1.3">pmf</ci></apply><interval closure="open" id="A1.E10.m1.4.4.1.1.1.1.1.3.1.cmml" xref="A1.E10.m1.4.4.1.1.1.1.1.3.2"><ci id="A1.E10.m1.1.1.cmml" xref="A1.E10.m1.1.1">𝑛</ci><ci id="A1.E10.m1.2.2.cmml" xref="A1.E10.m1.2.2">𝜆</ci></interval></apply></apply><apply id="A1.E10.m1.4.4.1.1.2.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2"><times id="A1.E10.m1.4.4.1.1.2.2.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2.2"></times><ci id="A1.E10.m1.4.4.1.1.2.2.3.cmml" xref="A1.E10.m1.4.4.1.1.2.2.3">sf</ci><interval closure="open" id="A1.E10.m1.4.4.1.1.2.2.1.2.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1.1"><apply id="A1.E10.m1.4.4.1.1.2.2.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1">superscript</csymbol><cn id="A1.E10.m1.4.4.1.1.2.2.1.1.1.2.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.2">2</cn><cn id="A1.E10.m1.4.4.1.1.2.2.1.1.1.3.cmml" type="integer" xref="A1.E10.m1.4.4.1.1.2.2.1.1.1.3">16</cn></apply><ci id="A1.E10.m1.3.3.cmml" xref="A1.E10.m1.3.3">𝜆</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.4c">\displaystyle=\sum_{n=k+1}^{2^{16}}\left(1-\prod_{i=0}^{n-k-1}\left(1-\frac{i}%
{2^{16}-k}\right)\right)\cdot\mathrm{pmf}(n,\lambda)+\mathrm{sf}(2^{16},%
\lambda).</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.4d">= ∑ start_POSTSUBSCRIPT italic_n = italic_k + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ( 1 - ∏ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n - italic_k - 1 end_POSTSUPERSCRIPT ( 1 - divide start_ARG italic_i end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k end_ARG ) ) ⋅ roman_pmf ( italic_n , italic_λ ) + roman_sf ( 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT , italic_λ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.5. </span>PRNG (iterated Knuth shuffle reserving <math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.SSS5.1.m1.1"><semantics id="A1.SS1.SSS5.1.m1.1b"><mi id="A1.SS1.SSS5.1.m1.1.1" xref="A1.SS1.SSS5.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.1.m1.1c"><ci id="A1.SS1.SSS5.1.m1.1.1.cmml" xref="A1.SS1.SSS5.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.1.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.1.m1.1e">italic_k</annotation></semantics></math> IPIDs)</h4>
<div class="ltx_para" id="A1.SS1.SSS5.p1">
<p class="ltx_p" id="A1.SS1.SSS5.p1.3">Supposing the permutation of all <math alttext="2^{16}" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p1.1.m1.1"><semantics id="A1.SS1.SSS5.p1.1.m1.1a"><msup id="A1.SS1.SSS5.p1.1.m1.1.1" xref="A1.SS1.SSS5.p1.1.m1.1.1.cmml"><mn id="A1.SS1.SSS5.p1.1.m1.1.1.2" xref="A1.SS1.SSS5.p1.1.m1.1.1.2.cmml">2</mn><mn id="A1.SS1.SSS5.p1.1.m1.1.1.3" xref="A1.SS1.SSS5.p1.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p1.1.m1.1b"><apply id="A1.SS1.SSS5.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS5.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS5.p1.1.m1.1.1">superscript</csymbol><cn id="A1.SS1.SSS5.p1.1.m1.1.1.2.cmml" type="integer" xref="A1.SS1.SSS5.p1.1.m1.1.1.2">2</cn><cn id="A1.SS1.SSS5.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS1.SSS5.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p1.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> IPIDs is initialized uniformly at random and any returned IPID is swapped into a position chosen uniformly at random from among the <math alttext="2^{16}-k" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p1.2.m2.1"><semantics id="A1.SS1.SSS5.p1.2.m2.1a"><mrow id="A1.SS1.SSS5.p1.2.m2.1.1" xref="A1.SS1.SSS5.p1.2.m2.1.1.cmml"><msup id="A1.SS1.SSS5.p1.2.m2.1.1.2" xref="A1.SS1.SSS5.p1.2.m2.1.1.2.cmml"><mn id="A1.SS1.SSS5.p1.2.m2.1.1.2.2" xref="A1.SS1.SSS5.p1.2.m2.1.1.2.2.cmml">2</mn><mn id="A1.SS1.SSS5.p1.2.m2.1.1.2.3" xref="A1.SS1.SSS5.p1.2.m2.1.1.2.3.cmml">16</mn></msup><mo id="A1.SS1.SSS5.p1.2.m2.1.1.1" xref="A1.SS1.SSS5.p1.2.m2.1.1.1.cmml">−</mo><mi id="A1.SS1.SSS5.p1.2.m2.1.1.3" xref="A1.SS1.SSS5.p1.2.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p1.2.m2.1b"><apply id="A1.SS1.SSS5.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS5.p1.2.m2.1.1"><minus id="A1.SS1.SSS5.p1.2.m2.1.1.1.cmml" xref="A1.SS1.SSS5.p1.2.m2.1.1.1"></minus><apply id="A1.SS1.SSS5.p1.2.m2.1.1.2.cmml" xref="A1.SS1.SSS5.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS5.p1.2.m2.1.1.2.1.cmml" xref="A1.SS1.SSS5.p1.2.m2.1.1.2">superscript</csymbol><cn id="A1.SS1.SSS5.p1.2.m2.1.1.2.2.cmml" type="integer" xref="A1.SS1.SSS5.p1.2.m2.1.1.2.2">2</cn><cn id="A1.SS1.SSS5.p1.2.m2.1.1.2.3.cmml" type="integer" xref="A1.SS1.SSS5.p1.2.m2.1.1.2.3">16</cn></apply><ci id="A1.SS1.SSS5.p1.2.m2.1.1.3.cmml" xref="A1.SS1.SSS5.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p1.2.m2.1c">2^{16}-k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p1.2.m2.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k</annotation></semantics></math> previous positions in the permutation (including its own), the probability that any given IPID <math alttext="x" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p1.3.m3.1"><semantics id="A1.SS1.SSS5.p1.3.m3.1a"><mi id="A1.SS1.SSS5.p1.3.m3.1.1" xref="A1.SS1.SSS5.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p1.3.m3.1b"><ci id="A1.SS1.SSS5.p1.3.m3.1.1.cmml" xref="A1.SS1.SSS5.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p1.3.m3.1d">italic_x</annotation></semantics></math> will be returned next is</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{next IPID}=x\right]=\left\{\begin{array}[]{ll}0&amp;\text{%
if $x\in$ last $k$ IPIDs};\\
\frac{1}{2^{16}-k}&amp;\text{otherwise}.\end{array}\right." class="ltx_Math" display="block" id="A1.E11.m1.4"><semantics id="A1.E11.m1.4a"><mrow id="A1.E11.m1.4.4" xref="A1.E11.m1.4.4.cmml"><mrow id="A1.E11.m1.4.4.1" xref="A1.E11.m1.4.4.1.cmml"><mi id="A1.E11.m1.4.4.1.3" xref="A1.E11.m1.4.4.1.3.cmml">Pr</mi><mo id="A1.E11.m1.4.4.1.2" xref="A1.E11.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.1.1.1" xref="A1.E11.m1.4.4.1.1.2.cmml"><mo id="A1.E11.m1.4.4.1.1.1.2" xref="A1.E11.m1.4.4.1.1.2.1.cmml">[</mo><mrow id="A1.E11.m1.4.4.1.1.1.1" xref="A1.E11.m1.4.4.1.1.1.1.cmml"><mtext id="A1.E11.m1.4.4.1.1.1.1.2" xref="A1.E11.m1.4.4.1.1.1.1.2a.cmml">next IPID</mtext><mo id="A1.E11.m1.4.4.1.1.1.1.1" xref="A1.E11.m1.4.4.1.1.1.1.1.cmml">=</mo><mi id="A1.E11.m1.4.4.1.1.1.1.3" xref="A1.E11.m1.4.4.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E11.m1.4.4.1.1.1.3" xref="A1.E11.m1.4.4.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E11.m1.4.4.2" xref="A1.E11.m1.4.4.2.cmml">=</mo><mrow id="A1.E11.m1.4.4.3.2" xref="A1.E11.m1.4.4.3.1.cmml"><mo id="A1.E11.m1.4.4.3.2.1" xref="A1.E11.m1.4.4.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A1.E11.m1.3.3" rowspacing="0pt" xref="A1.E11.m1.3.3.cmml"><mtr id="A1.E11.m1.3.3a" xref="A1.E11.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E11.m1.3.3b" xref="A1.E11.m1.3.3.cmml"><mn id="A1.E11.m1.2.2.2.3.1" xref="A1.E11.m1.2.2.2.3.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E11.m1.3.3c" xref="A1.E11.m1.3.3.cmml"><mrow id="A1.E11.m1.2.2.2.2.2.4" xref="A1.E11.m1.2.2.2.2.2.2.2d.cmml"><mrow id="A1.E11.m1.2.2.2.2.2.2.2" xref="A1.E11.m1.2.2.2.2.2.2.2d.cmml"><mtext id="A1.E11.m1.2.2.2.2.2.2.2a" xref="A1.E11.m1.2.2.2.2.2.2.2a.cmml">if </mtext><mrow id="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1" xref="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.2" xref="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml">x</mi><mo id="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml">∈</mo><mi id="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.3" xref="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><mtext id="A1.E11.m1.2.2.2.2.2.2.2b" xref="A1.E11.m1.2.2.2.2.2.2.2a.cmml"> last </mtext><mi id="A1.E11.m1.2.2.2.2.2.2.2.m2.1.1" xref="A1.E11.m1.2.2.2.2.2.2.2.m2.1.1.cmml">k</mi><mtext id="A1.E11.m1.2.2.2.2.2.2.2c" xref="A1.E11.m1.2.2.2.2.2.2.2a.cmml"> IPIDs</mtext></mrow><mo id="A1.E11.m1.2.2.2.2.2.4.1" xref="A1.E11.m1.2.2.2.2.2.2.2d.cmml">;</mo></mrow></mtd></mtr><mtr id="A1.E11.m1.3.3d" xref="A1.E11.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E11.m1.3.3e" xref="A1.E11.m1.3.3.cmml"><mstyle displaystyle="false" id="A1.E11.m1.3.3.3.2.1" xref="A1.E11.m1.3.3.3.2.1.cmml"><mfrac id="A1.E11.m1.3.3.3.2.1a" xref="A1.E11.m1.3.3.3.2.1.cmml"><mn id="A1.E11.m1.3.3.3.2.1.2" xref="A1.E11.m1.3.3.3.2.1.2.cmml">1</mn><mrow id="A1.E11.m1.3.3.3.2.1.3" xref="A1.E11.m1.3.3.3.2.1.3.cmml"><msup id="A1.E11.m1.3.3.3.2.1.3.2" xref="A1.E11.m1.3.3.3.2.1.3.2.cmml"><mn id="A1.E11.m1.3.3.3.2.1.3.2.2" xref="A1.E11.m1.3.3.3.2.1.3.2.2.cmml">2</mn><mn id="A1.E11.m1.3.3.3.2.1.3.2.3" xref="A1.E11.m1.3.3.3.2.1.3.2.3.cmml">16</mn></msup><mo id="A1.E11.m1.3.3.3.2.1.3.1" xref="A1.E11.m1.3.3.3.2.1.3.1.cmml">−</mo><mi id="A1.E11.m1.3.3.3.2.1.3.3" xref="A1.E11.m1.3.3.3.2.1.3.3.cmml">k</mi></mrow></mfrac></mstyle></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E11.m1.3.3f" xref="A1.E11.m1.3.3.cmml"><mrow id="A1.E11.m1.3.3.3.1.1.3" xref="A1.E11.m1.3.3.3.1.1.1a.cmml"><mtext id="A1.E11.m1.3.3.3.1.1.1" xref="A1.E11.m1.3.3.3.1.1.1.cmml">otherwise</mtext><mo id="A1.E11.m1.3.3.3.1.1.3.1" lspace="0em" xref="A1.E11.m1.3.3.3.1.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable><mi id="A1.E11.m1.4.4.3.2.2" xref="A1.E11.m1.4.4.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.4b"><apply id="A1.E11.m1.4.4.cmml" xref="A1.E11.m1.4.4"><eq id="A1.E11.m1.4.4.2.cmml" xref="A1.E11.m1.4.4.2"></eq><apply id="A1.E11.m1.4.4.1.cmml" xref="A1.E11.m1.4.4.1"><times id="A1.E11.m1.4.4.1.2.cmml" xref="A1.E11.m1.4.4.1.2"></times><ci id="A1.E11.m1.4.4.1.3.cmml" xref="A1.E11.m1.4.4.1.3">Pr</ci><apply id="A1.E11.m1.4.4.1.1.2.cmml" xref="A1.E11.m1.4.4.1.1.1"><csymbol cd="latexml" id="A1.E11.m1.4.4.1.1.2.1.cmml" xref="A1.E11.m1.4.4.1.1.1.2">delimited-[]</csymbol><apply id="A1.E11.m1.4.4.1.1.1.1.cmml" xref="A1.E11.m1.4.4.1.1.1.1"><eq id="A1.E11.m1.4.4.1.1.1.1.1.cmml" xref="A1.E11.m1.4.4.1.1.1.1.1"></eq><ci id="A1.E11.m1.4.4.1.1.1.1.2a.cmml" xref="A1.E11.m1.4.4.1.1.1.1.2"><mtext id="A1.E11.m1.4.4.1.1.1.1.2.cmml" xref="A1.E11.m1.4.4.1.1.1.1.2">next IPID</mtext></ci><ci id="A1.E11.m1.4.4.1.1.1.1.3.cmml" xref="A1.E11.m1.4.4.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="A1.E11.m1.4.4.3.1.cmml" xref="A1.E11.m1.4.4.3.2"><csymbol cd="latexml" id="A1.E11.m1.4.4.3.1.1.cmml" xref="A1.E11.m1.4.4.3.2.1">cases</csymbol><matrix id="A1.E11.m1.3.3.cmml" xref="A1.E11.m1.3.3"><matrixrow id="A1.E11.m1.3.3a.cmml" xref="A1.E11.m1.3.3"><cn id="A1.E11.m1.2.2.2.3.1.cmml" type="integer" xref="A1.E11.m1.2.2.2.3.1">0</cn><ci id="A1.E11.m1.2.2.2.2.2.2.2d.cmml" xref="A1.E11.m1.2.2.2.2.2.4"><mrow id="A1.E11.m1.2.2.2.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2.2.4"><mtext id="A1.E11.m1.2.2.2.2.2.2.2a.cmml" xref="A1.E11.m1.2.2.2.2.2.2.2a">if </mtext><mrow id="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1"><mi id="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.2">x</mi><mo id="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.1">∈</mo><mi id="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="A1.E11.m1.1.1.1.1.1.1.1.m1.1.1.3"></mi></mrow><mtext id="A1.E11.m1.2.2.2.2.2.2.2b.cmml" xref="A1.E11.m1.2.2.2.2.2.2.2a"> last </mtext><mi id="A1.E11.m1.2.2.2.2.2.2.2.m2.1.1.cmml" xref="A1.E11.m1.2.2.2.2.2.2.2.m2.1.1">k</mi><mtext id="A1.E11.m1.2.2.2.2.2.2.2c.cmml" xref="A1.E11.m1.2.2.2.2.2.2.2a"> IPIDs</mtext></mrow></ci></matrixrow><matrixrow id="A1.E11.m1.3.3b.cmml" xref="A1.E11.m1.3.3"><apply id="A1.E11.m1.3.3.3.2.1.cmml" xref="A1.E11.m1.3.3.3.2.1"><divide id="A1.E11.m1.3.3.3.2.1.1.cmml" xref="A1.E11.m1.3.3.3.2.1"></divide><cn id="A1.E11.m1.3.3.3.2.1.2.cmml" type="integer" xref="A1.E11.m1.3.3.3.2.1.2">1</cn><apply id="A1.E11.m1.3.3.3.2.1.3.cmml" xref="A1.E11.m1.3.3.3.2.1.3"><minus id="A1.E11.m1.3.3.3.2.1.3.1.cmml" xref="A1.E11.m1.3.3.3.2.1.3.1"></minus><apply id="A1.E11.m1.3.3.3.2.1.3.2.cmml" xref="A1.E11.m1.3.3.3.2.1.3.2"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.2.1.3.2.1.cmml" xref="A1.E11.m1.3.3.3.2.1.3.2">superscript</csymbol><cn id="A1.E11.m1.3.3.3.2.1.3.2.2.cmml" type="integer" xref="A1.E11.m1.3.3.3.2.1.3.2.2">2</cn><cn id="A1.E11.m1.3.3.3.2.1.3.2.3.cmml" type="integer" xref="A1.E11.m1.3.3.3.2.1.3.2.3">16</cn></apply><ci id="A1.E11.m1.3.3.3.2.1.3.3.cmml" xref="A1.E11.m1.3.3.3.2.1.3.3">𝑘</ci></apply></apply><ci id="A1.E11.m1.3.3.3.1.1.1a.cmml" xref="A1.E11.m1.3.3.3.1.1.3"><mtext id="A1.E11.m1.3.3.3.1.1.1.cmml" xref="A1.E11.m1.3.3.3.1.1.1">otherwise</mtext></ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.4c">\mathrm{Pr}\left[\text{next IPID}=x\right]=\left\{\begin{array}[]{ll}0&amp;\text{%
if $x\in$ last $k$ IPIDs};\\
\frac{1}{2^{16}-k}&amp;\text{otherwise}.\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.4d">roman_Pr [ next IPID = italic_x ] = { start_ARRAY start_ROW start_CELL 0 end_CELL start_CELL if italic_x ∈ last italic_k IPIDs ; end_CELL end_ROW start_ROW start_CELL divide start_ARG 1 end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k end_ARG end_CELL start_CELL otherwise . end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS5.p1.8">This implies that the next IPID appears uniform at random over all IPIDs except the last <math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p1.4.m1.1"><semantics id="A1.SS1.SSS5.p1.4.m1.1a"><mi id="A1.SS1.SSS5.p1.4.m1.1.1" xref="A1.SS1.SSS5.p1.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p1.4.m1.1b"><ci id="A1.SS1.SSS5.p1.4.m1.1.1.cmml" xref="A1.SS1.SSS5.p1.4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p1.4.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p1.4.m1.1d">italic_k</annotation></semantics></math> returned.
So, just as for a searchable queue of size <math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p1.5.m2.1"><semantics id="A1.SS1.SSS5.p1.5.m2.1a"><mi id="A1.SS1.SSS5.p1.5.m2.1.1" xref="A1.SS1.SSS5.p1.5.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p1.5.m2.1b"><ci id="A1.SS1.SSS5.p1.5.m2.1.1.cmml" xref="A1.SS1.SSS5.p1.5.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p1.5.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p1.5.m2.1d">italic_k</annotation></semantics></math>, no IPID will collide with any of the last <math alttext="k" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p1.6.m3.1"><semantics id="A1.SS1.SSS5.p1.6.m3.1a"><mi id="A1.SS1.SSS5.p1.6.m3.1.1" xref="A1.SS1.SSS5.p1.6.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p1.6.m3.1b"><ci id="A1.SS1.SSS5.p1.6.m3.1.1.cmml" xref="A1.SS1.SSS5.p1.6.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p1.6.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p1.6.m3.1d">italic_k</annotation></semantics></math> returned IPIDs and, if <math alttext="n&gt;k" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p1.7.m4.1"><semantics id="A1.SS1.SSS5.p1.7.m4.1a"><mrow id="A1.SS1.SSS5.p1.7.m4.1.1" xref="A1.SS1.SSS5.p1.7.m4.1.1.cmml"><mi id="A1.SS1.SSS5.p1.7.m4.1.1.2" xref="A1.SS1.SSS5.p1.7.m4.1.1.2.cmml">n</mi><mo id="A1.SS1.SSS5.p1.7.m4.1.1.1" xref="A1.SS1.SSS5.p1.7.m4.1.1.1.cmml">&gt;</mo><mi id="A1.SS1.SSS5.p1.7.m4.1.1.3" xref="A1.SS1.SSS5.p1.7.m4.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p1.7.m4.1b"><apply id="A1.SS1.SSS5.p1.7.m4.1.1.cmml" xref="A1.SS1.SSS5.p1.7.m4.1.1"><gt id="A1.SS1.SSS5.p1.7.m4.1.1.1.cmml" xref="A1.SS1.SSS5.p1.7.m4.1.1.1"></gt><ci id="A1.SS1.SSS5.p1.7.m4.1.1.2.cmml" xref="A1.SS1.SSS5.p1.7.m4.1.1.2">𝑛</ci><ci id="A1.SS1.SSS5.p1.7.m4.1.1.3.cmml" xref="A1.SS1.SSS5.p1.7.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p1.7.m4.1c">n&gt;k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p1.7.m4.1d">italic_n &gt; italic_k</annotation></semantics></math>, the remaining <math alttext="n-k" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p1.8.m5.1"><semantics id="A1.SS1.SSS5.p1.8.m5.1a"><mrow id="A1.SS1.SSS5.p1.8.m5.1.1" xref="A1.SS1.SSS5.p1.8.m5.1.1.cmml"><mi id="A1.SS1.SSS5.p1.8.m5.1.1.2" xref="A1.SS1.SSS5.p1.8.m5.1.1.2.cmml">n</mi><mo id="A1.SS1.SSS5.p1.8.m5.1.1.1" xref="A1.SS1.SSS5.p1.8.m5.1.1.1.cmml">−</mo><mi id="A1.SS1.SSS5.p1.8.m5.1.1.3" xref="A1.SS1.SSS5.p1.8.m5.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p1.8.m5.1b"><apply id="A1.SS1.SSS5.p1.8.m5.1.1.cmml" xref="A1.SS1.SSS5.p1.8.m5.1.1"><minus id="A1.SS1.SSS5.p1.8.m5.1.1.1.cmml" xref="A1.SS1.SSS5.p1.8.m5.1.1.1"></minus><ci id="A1.SS1.SSS5.p1.8.m5.1.1.2.cmml" xref="A1.SS1.SSS5.p1.8.m5.1.1.2">𝑛</ci><ci id="A1.SS1.SSS5.p1.8.m5.1.1.3.cmml" xref="A1.SS1.SSS5.p1.8.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p1.8.m5.1c">n-k</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p1.8.m5.1d">italic_n - italic_k</annotation></semantics></math> IPIDs may collide with any newly returned IPID according to the birthday problem.
Thus, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.Ex2" title="A.1.4. PRNG (searchable queue of size 𝑘) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.1.4</span></a> also describes the collision probability for this method.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS6">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.6. </span>PRNG (pure, no reserved IPIDs)</h4>
<div class="ltx_para" id="A1.SS1.SSS6.p1">
<span class="ltx_ERROR undefined" id="A1.SS1.SSS6.p1.3">\added</span>
<p class="ltx_p" id="A1.SS1.SSS6.p1.2">It is easily seen that pure PRNG selection—generating IPIDs uniformly at random over all <math alttext="2^{16}" class="ltx_Math" display="inline" id="A1.SS1.SSS6.p1.1.m1.1"><semantics id="A1.SS1.SSS6.p1.1.m1.1a"><msup id="A1.SS1.SSS6.p1.1.m1.1.1" xref="A1.SS1.SSS6.p1.1.m1.1.1.cmml"><mn id="A1.SS1.SSS6.p1.1.m1.1.1.2" xref="A1.SS1.SSS6.p1.1.m1.1.1.2.cmml">2</mn><mn id="A1.SS1.SSS6.p1.1.m1.1.1.3" xref="A1.SS1.SSS6.p1.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS6.p1.1.m1.1b"><apply id="A1.SS1.SSS6.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS6.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS6.p1.1.m1.1.1">superscript</csymbol><cn id="A1.SS1.SSS6.p1.1.m1.1.1.2.cmml" type="integer" xref="A1.SS1.SSS6.p1.1.m1.1.1.2">2</cn><cn id="A1.SS1.SSS6.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS1.SSS6.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS6.p1.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS6.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> possible values—is a special case of the previous two methods when <math alttext="k=0" class="ltx_Math" display="inline" id="A1.SS1.SSS6.p1.2.m2.1"><semantics id="A1.SS1.SSS6.p1.2.m2.1a"><mrow id="A1.SS1.SSS6.p1.2.m2.1.1" xref="A1.SS1.SSS6.p1.2.m2.1.1.cmml"><mi id="A1.SS1.SSS6.p1.2.m2.1.1.2" xref="A1.SS1.SSS6.p1.2.m2.1.1.2.cmml">k</mi><mo id="A1.SS1.SSS6.p1.2.m2.1.1.1" xref="A1.SS1.SSS6.p1.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS1.SSS6.p1.2.m2.1.1.3" xref="A1.SS1.SSS6.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS6.p1.2.m2.1b"><apply id="A1.SS1.SSS6.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS6.p1.2.m2.1.1"><eq id="A1.SS1.SSS6.p1.2.m2.1.1.1.cmml" xref="A1.SS1.SSS6.p1.2.m2.1.1.1"></eq><ci id="A1.SS1.SSS6.p1.2.m2.1.1.2.cmml" xref="A1.SS1.SSS6.p1.2.m2.1.1.2">𝑘</ci><cn id="A1.SS1.SSS6.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS1.SSS6.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS6.p1.2.m2.1c">k=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS6.p1.2.m2.1d">italic_k = 0</annotation></semantics></math>.
Simplifying Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.Ex2" title="A.1.4. PRNG (searchable queue of size 𝑘) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.1.4</span></a> for this case yields</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{collision}\right]=\sum_{n=1}^{2^{16}}\left(1-\prod_{i=0%
}^{n-1}\left(1-\frac{i}{2^{16}}\right)\right)\cdot\mathrm{pmf}(n,\lambda)+%
\mathrm{sf}(2^{16},\lambda)." class="ltx_Math" display="block" id="A1.E12.m1.5"><semantics id="A1.E12.m1.5a"><mrow id="A1.E12.m1.5.5.1" xref="A1.E12.m1.5.5.1.1.cmml"><mrow id="A1.E12.m1.5.5.1.1" xref="A1.E12.m1.5.5.1.1.cmml"><mrow id="A1.E12.m1.5.5.1.1.4" xref="A1.E12.m1.5.5.1.1.4.cmml"><mi id="A1.E12.m1.5.5.1.1.4.2" xref="A1.E12.m1.5.5.1.1.4.2.cmml">Pr</mi><mo id="A1.E12.m1.5.5.1.1.4.1" xref="A1.E12.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="A1.E12.m1.5.5.1.1.4.3.2" xref="A1.E12.m1.5.5.1.1.4.3.1.cmml"><mo id="A1.E12.m1.5.5.1.1.4.3.2.1" xref="A1.E12.m1.5.5.1.1.4.3.1.1.cmml">[</mo><mtext id="A1.E12.m1.1.1" xref="A1.E12.m1.1.1a.cmml">collision</mtext><mo id="A1.E12.m1.5.5.1.1.4.3.2.2" xref="A1.E12.m1.5.5.1.1.4.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E12.m1.5.5.1.1.3" rspace="0.111em" xref="A1.E12.m1.5.5.1.1.3.cmml">=</mo><mrow id="A1.E12.m1.5.5.1.1.2" xref="A1.E12.m1.5.5.1.1.2.cmml"><mrow id="A1.E12.m1.5.5.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.cmml"><munderover id="A1.E12.m1.5.5.1.1.1.1.2" xref="A1.E12.m1.5.5.1.1.1.1.2.cmml"><mo id="A1.E12.m1.5.5.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="A1.E12.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E12.m1.5.5.1.1.1.1.2.2.3" xref="A1.E12.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="A1.E12.m1.5.5.1.1.1.1.2.2.3.2" xref="A1.E12.m1.5.5.1.1.1.1.2.2.3.2.cmml">n</mi><mo id="A1.E12.m1.5.5.1.1.1.1.2.2.3.1" xref="A1.E12.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E12.m1.5.5.1.1.1.1.2.2.3.3" xref="A1.E12.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msup id="A1.E12.m1.5.5.1.1.1.1.2.3" xref="A1.E12.m1.5.5.1.1.1.1.2.3.cmml"><mn id="A1.E12.m1.5.5.1.1.1.1.2.3.2" xref="A1.E12.m1.5.5.1.1.1.1.2.3.2.cmml">2</mn><mn id="A1.E12.m1.5.5.1.1.1.1.2.3.3" xref="A1.E12.m1.5.5.1.1.1.1.2.3.3.cmml">16</mn></msup></munderover><mrow id="A1.E12.m1.5.5.1.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.1.cmml"><mrow id="A1.E12.m1.5.5.1.1.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2" rspace="0.055em" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">∏</mo><mrow id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><msup id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">2</mn><mn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">16</mn></msup></mfrac></mrow><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E12.m1.5.5.1.1.1.1.1.1.2" rspace="0.222em" xref="A1.E12.m1.5.5.1.1.1.1.1.1.2.cmml">⋅</mo><mi id="A1.E12.m1.5.5.1.1.1.1.1.1.3" xref="A1.E12.m1.5.5.1.1.1.1.1.1.3.cmml">pmf</mi></mrow><mo id="A1.E12.m1.5.5.1.1.1.1.1.2" xref="A1.E12.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.5.5.1.1.1.1.1.3.2" xref="A1.E12.m1.5.5.1.1.1.1.1.3.1.cmml"><mo id="A1.E12.m1.5.5.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E12.m1.5.5.1.1.1.1.1.3.1.cmml">(</mo><mi id="A1.E12.m1.2.2" xref="A1.E12.m1.2.2.cmml">n</mi><mo id="A1.E12.m1.5.5.1.1.1.1.1.3.2.2" xref="A1.E12.m1.5.5.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E12.m1.3.3" xref="A1.E12.m1.3.3.cmml">λ</mi><mo id="A1.E12.m1.5.5.1.1.1.1.1.3.2.3" stretchy="false" xref="A1.E12.m1.5.5.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E12.m1.5.5.1.1.2.3" xref="A1.E12.m1.5.5.1.1.2.3.cmml">+</mo><mrow id="A1.E12.m1.5.5.1.1.2.2" xref="A1.E12.m1.5.5.1.1.2.2.cmml"><mi id="A1.E12.m1.5.5.1.1.2.2.3" xref="A1.E12.m1.5.5.1.1.2.2.3.cmml">sf</mi><mo id="A1.E12.m1.5.5.1.1.2.2.2" xref="A1.E12.m1.5.5.1.1.2.2.2.cmml">⁢</mo><mrow id="A1.E12.m1.5.5.1.1.2.2.1.1" xref="A1.E12.m1.5.5.1.1.2.2.1.2.cmml"><mo id="A1.E12.m1.5.5.1.1.2.2.1.1.2" stretchy="false" xref="A1.E12.m1.5.5.1.1.2.2.1.2.cmml">(</mo><msup id="A1.E12.m1.5.5.1.1.2.2.1.1.1" xref="A1.E12.m1.5.5.1.1.2.2.1.1.1.cmml"><mn id="A1.E12.m1.5.5.1.1.2.2.1.1.1.2" xref="A1.E12.m1.5.5.1.1.2.2.1.1.1.2.cmml">2</mn><mn id="A1.E12.m1.5.5.1.1.2.2.1.1.1.3" xref="A1.E12.m1.5.5.1.1.2.2.1.1.1.3.cmml">16</mn></msup><mo id="A1.E12.m1.5.5.1.1.2.2.1.1.3" xref="A1.E12.m1.5.5.1.1.2.2.1.2.cmml">,</mo><mi id="A1.E12.m1.4.4" xref="A1.E12.m1.4.4.cmml">λ</mi><mo id="A1.E12.m1.5.5.1.1.2.2.1.1.4" stretchy="false" xref="A1.E12.m1.5.5.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E12.m1.5.5.1.2" lspace="0em" xref="A1.E12.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.5b"><apply id="A1.E12.m1.5.5.1.1.cmml" xref="A1.E12.m1.5.5.1"><eq id="A1.E12.m1.5.5.1.1.3.cmml" xref="A1.E12.m1.5.5.1.1.3"></eq><apply id="A1.E12.m1.5.5.1.1.4.cmml" xref="A1.E12.m1.5.5.1.1.4"><times id="A1.E12.m1.5.5.1.1.4.1.cmml" xref="A1.E12.m1.5.5.1.1.4.1"></times><ci id="A1.E12.m1.5.5.1.1.4.2.cmml" xref="A1.E12.m1.5.5.1.1.4.2">Pr</ci><apply id="A1.E12.m1.5.5.1.1.4.3.1.cmml" xref="A1.E12.m1.5.5.1.1.4.3.2"><csymbol cd="latexml" id="A1.E12.m1.5.5.1.1.4.3.1.1.cmml" xref="A1.E12.m1.5.5.1.1.4.3.2.1">delimited-[]</csymbol><ci id="A1.E12.m1.1.1a.cmml" xref="A1.E12.m1.1.1"><mtext id="A1.E12.m1.1.1.cmml" xref="A1.E12.m1.1.1">collision</mtext></ci></apply></apply><apply id="A1.E12.m1.5.5.1.1.2.cmml" xref="A1.E12.m1.5.5.1.1.2"><plus id="A1.E12.m1.5.5.1.1.2.3.cmml" xref="A1.E12.m1.5.5.1.1.2.3"></plus><apply id="A1.E12.m1.5.5.1.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1"><apply id="A1.E12.m1.5.5.1.1.1.1.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.1.1.1.1.2.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="A1.E12.m1.5.5.1.1.1.1.2.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.1.1.1.1.2.2.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="A1.E12.m1.5.5.1.1.1.1.2.2.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2.2.2"></sum><apply id="A1.E12.m1.5.5.1.1.1.1.2.2.3.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2.2.3"><eq id="A1.E12.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="A1.E12.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2.2.3.2">𝑛</ci><cn id="A1.E12.m1.5.5.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="A1.E12.m1.5.5.1.1.1.1.2.3.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.1.1.1.1.2.3.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.2.3">superscript</csymbol><cn id="A1.E12.m1.5.5.1.1.1.1.2.3.2.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.2.3.2">2</cn><cn id="A1.E12.m1.5.5.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.2.3.3">16</cn></apply></apply><apply id="A1.E12.m1.5.5.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1"><times id="A1.E12.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.2"></times><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1"><ci id="A1.E12.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.2">⋅</ci><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1"><minus id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.2"></minus><cn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.3">1</cn><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1"><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2">product</csymbol><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3"><eq id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3"><minus id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑛</ci><cn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><divide id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3"></divide><ci id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><cn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">2</cn><cn id="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">16</cn></apply></apply></apply></apply></apply><ci id="A1.E12.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.1.3">pmf</ci></apply><interval closure="open" id="A1.E12.m1.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.5.5.1.1.1.1.1.3.2"><ci id="A1.E12.m1.2.2.cmml" xref="A1.E12.m1.2.2">𝑛</ci><ci id="A1.E12.m1.3.3.cmml" xref="A1.E12.m1.3.3">𝜆</ci></interval></apply></apply><apply id="A1.E12.m1.5.5.1.1.2.2.cmml" xref="A1.E12.m1.5.5.1.1.2.2"><times id="A1.E12.m1.5.5.1.1.2.2.2.cmml" xref="A1.E12.m1.5.5.1.1.2.2.2"></times><ci id="A1.E12.m1.5.5.1.1.2.2.3.cmml" xref="A1.E12.m1.5.5.1.1.2.2.3">sf</ci><interval closure="open" id="A1.E12.m1.5.5.1.1.2.2.1.2.cmml" xref="A1.E12.m1.5.5.1.1.2.2.1.1"><apply id="A1.E12.m1.5.5.1.1.2.2.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="A1.E12.m1.5.5.1.1.2.2.1.1.1">superscript</csymbol><cn id="A1.E12.m1.5.5.1.1.2.2.1.1.1.2.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.2.2.1.1.1.2">2</cn><cn id="A1.E12.m1.5.5.1.1.2.2.1.1.1.3.cmml" type="integer" xref="A1.E12.m1.5.5.1.1.2.2.1.1.1.3">16</cn></apply><ci id="A1.E12.m1.4.4.cmml" xref="A1.E12.m1.4.4">𝜆</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.5c">\mathrm{Pr}\left[\text{collision}\right]=\sum_{n=1}^{2^{16}}\left(1-\prod_{i=0%
}^{n-1}\left(1-\frac{i}{2^{16}}\right)\right)\cdot\mathrm{pmf}(n,\lambda)+%
\mathrm{sf}(2^{16},\lambda).</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.5d">roman_Pr [ collision ] = ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ( 1 - ∏ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n - 1 end_POSTSUPERSCRIPT ( 1 - divide start_ARG italic_i end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT end_ARG ) ) ⋅ roman_pmf ( italic_n , italic_λ ) + roman_sf ( 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT , italic_λ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2. </span>Security Derivations</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.14">Recall from Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS3" title="4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.3</span></a> that we model an off-path adversary <math alttext="A" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mi id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">italic_A</annotation></semantics></math> trying to predict the next IPID generated by a particular IPID resource <math alttext="i\in\{1,\ldots,r\}" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m2.3"><semantics id="A1.SS2.p1.2.m2.3a"><mrow id="A1.SS2.p1.2.m2.3.4" xref="A1.SS2.p1.2.m2.3.4.cmml"><mi id="A1.SS2.p1.2.m2.3.4.2" xref="A1.SS2.p1.2.m2.3.4.2.cmml">i</mi><mo id="A1.SS2.p1.2.m2.3.4.1" xref="A1.SS2.p1.2.m2.3.4.1.cmml">∈</mo><mrow id="A1.SS2.p1.2.m2.3.4.3.2" xref="A1.SS2.p1.2.m2.3.4.3.1.cmml"><mo id="A1.SS2.p1.2.m2.3.4.3.2.1" stretchy="false" xref="A1.SS2.p1.2.m2.3.4.3.1.cmml">{</mo><mn id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml">1</mn><mo id="A1.SS2.p1.2.m2.3.4.3.2.2" xref="A1.SS2.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="A1.SS2.p1.2.m2.2.2" mathvariant="normal" xref="A1.SS2.p1.2.m2.2.2.cmml">…</mi><mo id="A1.SS2.p1.2.m2.3.4.3.2.3" xref="A1.SS2.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="A1.SS2.p1.2.m2.3.3" xref="A1.SS2.p1.2.m2.3.3.cmml">r</mi><mo id="A1.SS2.p1.2.m2.3.4.3.2.4" stretchy="false" xref="A1.SS2.p1.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.3b"><apply id="A1.SS2.p1.2.m2.3.4.cmml" xref="A1.SS2.p1.2.m2.3.4"><in id="A1.SS2.p1.2.m2.3.4.1.cmml" xref="A1.SS2.p1.2.m2.3.4.1"></in><ci id="A1.SS2.p1.2.m2.3.4.2.cmml" xref="A1.SS2.p1.2.m2.3.4.2">𝑖</ci><set id="A1.SS2.p1.2.m2.3.4.3.1.cmml" xref="A1.SS2.p1.2.m2.3.4.3.2"><cn id="A1.SS2.p1.2.m2.1.1.cmml" type="integer" xref="A1.SS2.p1.2.m2.1.1">1</cn><ci id="A1.SS2.p1.2.m2.2.2.cmml" xref="A1.SS2.p1.2.m2.2.2">…</ci><ci id="A1.SS2.p1.2.m2.3.3.cmml" xref="A1.SS2.p1.2.m2.3.3">𝑟</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.3c">i\in\{1,\ldots,r\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m2.3d">italic_i ∈ { 1 , … , italic_r }</annotation></semantics></math> (i.e., a counter or PRNG) on a server <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.p1.3.m3.1"><semantics id="A1.SS2.p1.3.m3.1a"><mi id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><ci id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m3.1d">italic_S</annotation></semantics></math>.
Server <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.p1.4.m4.1"><semantics id="A1.SS2.p1.4.m4.1a"><mi id="A1.SS2.p1.4.m4.1.1" xref="A1.SS2.p1.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m4.1b"><ci id="A1.SS2.p1.4.m4.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.4.m4.1d">italic_S</annotation></semantics></math> sends packets according to a Poisson process with rate <math alttext="\lambda&gt;0" class="ltx_Math" display="inline" id="A1.SS2.p1.5.m5.1"><semantics id="A1.SS2.p1.5.m5.1a"><mrow id="A1.SS2.p1.5.m5.1.1" xref="A1.SS2.p1.5.m5.1.1.cmml"><mi id="A1.SS2.p1.5.m5.1.1.2" xref="A1.SS2.p1.5.m5.1.1.2.cmml">λ</mi><mo id="A1.SS2.p1.5.m5.1.1.1" xref="A1.SS2.p1.5.m5.1.1.1.cmml">&gt;</mo><mn id="A1.SS2.p1.5.m5.1.1.3" xref="A1.SS2.p1.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m5.1b"><apply id="A1.SS2.p1.5.m5.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1"><gt id="A1.SS2.p1.5.m5.1.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1.1"></gt><ci id="A1.SS2.p1.5.m5.1.1.2.cmml" xref="A1.SS2.p1.5.m5.1.1.2">𝜆</ci><cn id="A1.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="A1.SS2.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m5.1c">\lambda&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.5.m5.1d">italic_λ &gt; 0</annotation></semantics></math> and its IPID resources <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p1.6.m6.1"><semantics id="A1.SS2.p1.6.m6.1a"><mi id="A1.SS2.p1.6.m6.1.1" xref="A1.SS2.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.6.m6.1b"><ci id="A1.SS2.p1.6.m6.1.1.cmml" xref="A1.SS2.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.6.m6.1d">italic_i</annotation></semantics></math> assign IPIDs with rates <math alttext="\lambda\geq\lambda_{i}\geq 0" class="ltx_Math" display="inline" id="A1.SS2.p1.7.m7.1"><semantics id="A1.SS2.p1.7.m7.1a"><mrow id="A1.SS2.p1.7.m7.1.1" xref="A1.SS2.p1.7.m7.1.1.cmml"><mi id="A1.SS2.p1.7.m7.1.1.2" xref="A1.SS2.p1.7.m7.1.1.2.cmml">λ</mi><mo id="A1.SS2.p1.7.m7.1.1.3" xref="A1.SS2.p1.7.m7.1.1.3.cmml">≥</mo><msub id="A1.SS2.p1.7.m7.1.1.4" xref="A1.SS2.p1.7.m7.1.1.4.cmml"><mi id="A1.SS2.p1.7.m7.1.1.4.2" xref="A1.SS2.p1.7.m7.1.1.4.2.cmml">λ</mi><mi id="A1.SS2.p1.7.m7.1.1.4.3" xref="A1.SS2.p1.7.m7.1.1.4.3.cmml">i</mi></msub><mo id="A1.SS2.p1.7.m7.1.1.5" xref="A1.SS2.p1.7.m7.1.1.5.cmml">≥</mo><mn id="A1.SS2.p1.7.m7.1.1.6" xref="A1.SS2.p1.7.m7.1.1.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.7.m7.1b"><apply id="A1.SS2.p1.7.m7.1.1.cmml" xref="A1.SS2.p1.7.m7.1.1"><and id="A1.SS2.p1.7.m7.1.1a.cmml" xref="A1.SS2.p1.7.m7.1.1"></and><apply id="A1.SS2.p1.7.m7.1.1b.cmml" xref="A1.SS2.p1.7.m7.1.1"><geq id="A1.SS2.p1.7.m7.1.1.3.cmml" xref="A1.SS2.p1.7.m7.1.1.3"></geq><ci id="A1.SS2.p1.7.m7.1.1.2.cmml" xref="A1.SS2.p1.7.m7.1.1.2">𝜆</ci><apply id="A1.SS2.p1.7.m7.1.1.4.cmml" xref="A1.SS2.p1.7.m7.1.1.4"><csymbol cd="ambiguous" id="A1.SS2.p1.7.m7.1.1.4.1.cmml" xref="A1.SS2.p1.7.m7.1.1.4">subscript</csymbol><ci id="A1.SS2.p1.7.m7.1.1.4.2.cmml" xref="A1.SS2.p1.7.m7.1.1.4.2">𝜆</ci><ci id="A1.SS2.p1.7.m7.1.1.4.3.cmml" xref="A1.SS2.p1.7.m7.1.1.4.3">𝑖</ci></apply></apply><apply id="A1.SS2.p1.7.m7.1.1c.cmml" xref="A1.SS2.p1.7.m7.1.1"><geq id="A1.SS2.p1.7.m7.1.1.5.cmml" xref="A1.SS2.p1.7.m7.1.1.5"></geq><share href="https://arxiv.org/html/2406.06483v2#A1.SS2.p1.7.m7.1.1.4.cmml" id="A1.SS2.p1.7.m7.1.1d.cmml" xref="A1.SS2.p1.7.m7.1.1"></share><cn id="A1.SS2.p1.7.m7.1.1.6.cmml" type="integer" xref="A1.SS2.p1.7.m7.1.1.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.7.m7.1c">\lambda\geq\lambda_{i}\geq 0</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.7.m7.1d">italic_λ ≥ italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math> where <math alttext="\sum_{i=1}^{r}\lambda_{i}=\lambda" class="ltx_Math" display="inline" id="A1.SS2.p1.8.m8.1"><semantics id="A1.SS2.p1.8.m8.1a"><mrow id="A1.SS2.p1.8.m8.1.1" xref="A1.SS2.p1.8.m8.1.1.cmml"><mrow id="A1.SS2.p1.8.m8.1.1.2" xref="A1.SS2.p1.8.m8.1.1.2.cmml"><msubsup id="A1.SS2.p1.8.m8.1.1.2.1" xref="A1.SS2.p1.8.m8.1.1.2.1.cmml"><mo id="A1.SS2.p1.8.m8.1.1.2.1.2.2" xref="A1.SS2.p1.8.m8.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.SS2.p1.8.m8.1.1.2.1.2.3" xref="A1.SS2.p1.8.m8.1.1.2.1.2.3.cmml"><mi id="A1.SS2.p1.8.m8.1.1.2.1.2.3.2" xref="A1.SS2.p1.8.m8.1.1.2.1.2.3.2.cmml">i</mi><mo id="A1.SS2.p1.8.m8.1.1.2.1.2.3.1" xref="A1.SS2.p1.8.m8.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.SS2.p1.8.m8.1.1.2.1.2.3.3" xref="A1.SS2.p1.8.m8.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p1.8.m8.1.1.2.1.3" xref="A1.SS2.p1.8.m8.1.1.2.1.3.cmml">r</mi></msubsup><msub id="A1.SS2.p1.8.m8.1.1.2.2" xref="A1.SS2.p1.8.m8.1.1.2.2.cmml"><mi id="A1.SS2.p1.8.m8.1.1.2.2.2" xref="A1.SS2.p1.8.m8.1.1.2.2.2.cmml">λ</mi><mi id="A1.SS2.p1.8.m8.1.1.2.2.3" xref="A1.SS2.p1.8.m8.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="A1.SS2.p1.8.m8.1.1.1" xref="A1.SS2.p1.8.m8.1.1.1.cmml">=</mo><mi id="A1.SS2.p1.8.m8.1.1.3" xref="A1.SS2.p1.8.m8.1.1.3.cmml">λ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.8.m8.1b"><apply id="A1.SS2.p1.8.m8.1.1.cmml" xref="A1.SS2.p1.8.m8.1.1"><eq id="A1.SS2.p1.8.m8.1.1.1.cmml" xref="A1.SS2.p1.8.m8.1.1.1"></eq><apply id="A1.SS2.p1.8.m8.1.1.2.cmml" xref="A1.SS2.p1.8.m8.1.1.2"><apply id="A1.SS2.p1.8.m8.1.1.2.1.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS2.p1.8.m8.1.1.2.1.1.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1">superscript</csymbol><apply id="A1.SS2.p1.8.m8.1.1.2.1.2.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS2.p1.8.m8.1.1.2.1.2.1.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1">subscript</csymbol><sum id="A1.SS2.p1.8.m8.1.1.2.1.2.2.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1.2.2"></sum><apply id="A1.SS2.p1.8.m8.1.1.2.1.2.3.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1.2.3"><eq id="A1.SS2.p1.8.m8.1.1.2.1.2.3.1.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1.2.3.1"></eq><ci id="A1.SS2.p1.8.m8.1.1.2.1.2.3.2.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1.2.3.2">𝑖</ci><cn id="A1.SS2.p1.8.m8.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.SS2.p1.8.m8.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="A1.SS2.p1.8.m8.1.1.2.1.3.cmml" xref="A1.SS2.p1.8.m8.1.1.2.1.3">𝑟</ci></apply><apply id="A1.SS2.p1.8.m8.1.1.2.2.cmml" xref="A1.SS2.p1.8.m8.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p1.8.m8.1.1.2.2.1.cmml" xref="A1.SS2.p1.8.m8.1.1.2.2">subscript</csymbol><ci id="A1.SS2.p1.8.m8.1.1.2.2.2.cmml" xref="A1.SS2.p1.8.m8.1.1.2.2.2">𝜆</ci><ci id="A1.SS2.p1.8.m8.1.1.2.2.3.cmml" xref="A1.SS2.p1.8.m8.1.1.2.2.3">𝑖</ci></apply></apply><ci id="A1.SS2.p1.8.m8.1.1.3.cmml" xref="A1.SS2.p1.8.m8.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.8.m8.1c">\sum_{i=1}^{r}\lambda_{i}=\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.8.m8.1d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_λ</annotation></semantics></math>.
Here, we analyze the probability of an adversarial guess against a particular resource <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p1.9.m9.1"><semantics id="A1.SS2.p1.9.m9.1a"><mi id="A1.SS2.p1.9.m9.1.1" xref="A1.SS2.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.9.m9.1b"><ci id="A1.SS2.p1.9.m9.1.1.cmml" xref="A1.SS2.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.9.m9.1d">italic_i</annotation></semantics></math> as a function of <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="A1.SS2.p1.10.m10.1"><semantics id="A1.SS2.p1.10.m10.1a"><msub id="A1.SS2.p1.10.m10.1.1" xref="A1.SS2.p1.10.m10.1.1.cmml"><mi id="A1.SS2.p1.10.m10.1.1.2" xref="A1.SS2.p1.10.m10.1.1.2.cmml">λ</mi><mi id="A1.SS2.p1.10.m10.1.1.3" xref="A1.SS2.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.10.m10.1b"><apply id="A1.SS2.p1.10.m10.1.1.cmml" xref="A1.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.10.m10.1.1.1.cmml" xref="A1.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="A1.SS2.p1.10.m10.1.1.2.cmml" xref="A1.SS2.p1.10.m10.1.1.2">𝜆</ci><ci id="A1.SS2.p1.10.m10.1.1.3.cmml" xref="A1.SS2.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.10.m10.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.10.m10.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
Let <math alttext="N_{i}" class="ltx_Math" display="inline" id="A1.SS2.p1.11.m11.1"><semantics id="A1.SS2.p1.11.m11.1a"><msub id="A1.SS2.p1.11.m11.1.1" xref="A1.SS2.p1.11.m11.1.1.cmml"><mi id="A1.SS2.p1.11.m11.1.1.2" xref="A1.SS2.p1.11.m11.1.1.2.cmml">N</mi><mi id="A1.SS2.p1.11.m11.1.1.3" xref="A1.SS2.p1.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.11.m11.1b"><apply id="A1.SS2.p1.11.m11.1.1.cmml" xref="A1.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.11.m11.1.1.1.cmml" xref="A1.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="A1.SS2.p1.11.m11.1.1.2.cmml" xref="A1.SS2.p1.11.m11.1.1.2">𝑁</ci><ci id="A1.SS2.p1.11.m11.1.1.3.cmml" xref="A1.SS2.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.11.m11.1c">N_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.11.m11.1d">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> be the Poisson-distributed random variable counting the number of packets <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.p1.12.m12.1"><semantics id="A1.SS2.p1.12.m12.1a"><mi id="A1.SS2.p1.12.m12.1.1" xref="A1.SS2.p1.12.m12.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.12.m12.1b"><ci id="A1.SS2.p1.12.m12.1.1.cmml" xref="A1.SS2.p1.12.m12.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.12.m12.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.12.m12.1d">italic_S</annotation></semantics></math> sent in the last unit time whose IPIDs were assigned by resource <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p1.13.m13.1"><semantics id="A1.SS2.p1.13.m13.1a"><mi id="A1.SS2.p1.13.m13.1.1" xref="A1.SS2.p1.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.13.m13.1b"><ci id="A1.SS2.p1.13.m13.1.1.cmml" xref="A1.SS2.p1.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.13.m13.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.13.m13.1d">italic_i</annotation></semantics></math>, and let time be calibrated such that <math alttext="\mathrm{E}\left[N_{i}\right]=\lambda_{i}" class="ltx_Math" display="inline" id="A1.SS2.p1.14.m14.1"><semantics id="A1.SS2.p1.14.m14.1a"><mrow id="A1.SS2.p1.14.m14.1.1" xref="A1.SS2.p1.14.m14.1.1.cmml"><mrow id="A1.SS2.p1.14.m14.1.1.1" xref="A1.SS2.p1.14.m14.1.1.1.cmml"><mi id="A1.SS2.p1.14.m14.1.1.1.3" mathvariant="normal" xref="A1.SS2.p1.14.m14.1.1.1.3.cmml">E</mi><mo id="A1.SS2.p1.14.m14.1.1.1.2" xref="A1.SS2.p1.14.m14.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p1.14.m14.1.1.1.1.1" xref="A1.SS2.p1.14.m14.1.1.1.1.2.cmml"><mo id="A1.SS2.p1.14.m14.1.1.1.1.1.2" xref="A1.SS2.p1.14.m14.1.1.1.1.2.1.cmml">[</mo><msub id="A1.SS2.p1.14.m14.1.1.1.1.1.1" xref="A1.SS2.p1.14.m14.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p1.14.m14.1.1.1.1.1.1.2" xref="A1.SS2.p1.14.m14.1.1.1.1.1.1.2.cmml">N</mi><mi id="A1.SS2.p1.14.m14.1.1.1.1.1.1.3" xref="A1.SS2.p1.14.m14.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p1.14.m14.1.1.1.1.1.3" xref="A1.SS2.p1.14.m14.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.SS2.p1.14.m14.1.1.2" xref="A1.SS2.p1.14.m14.1.1.2.cmml">=</mo><msub id="A1.SS2.p1.14.m14.1.1.3" xref="A1.SS2.p1.14.m14.1.1.3.cmml"><mi id="A1.SS2.p1.14.m14.1.1.3.2" xref="A1.SS2.p1.14.m14.1.1.3.2.cmml">λ</mi><mi id="A1.SS2.p1.14.m14.1.1.3.3" xref="A1.SS2.p1.14.m14.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.14.m14.1b"><apply id="A1.SS2.p1.14.m14.1.1.cmml" xref="A1.SS2.p1.14.m14.1.1"><eq id="A1.SS2.p1.14.m14.1.1.2.cmml" xref="A1.SS2.p1.14.m14.1.1.2"></eq><apply id="A1.SS2.p1.14.m14.1.1.1.cmml" xref="A1.SS2.p1.14.m14.1.1.1"><times id="A1.SS2.p1.14.m14.1.1.1.2.cmml" xref="A1.SS2.p1.14.m14.1.1.1.2"></times><ci id="A1.SS2.p1.14.m14.1.1.1.3.cmml" xref="A1.SS2.p1.14.m14.1.1.1.3">E</ci><apply id="A1.SS2.p1.14.m14.1.1.1.1.2.cmml" xref="A1.SS2.p1.14.m14.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p1.14.m14.1.1.1.1.2.1.cmml" xref="A1.SS2.p1.14.m14.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.SS2.p1.14.m14.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.14.m14.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.14.m14.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.14.m14.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p1.14.m14.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.14.m14.1.1.1.1.1.1.2">𝑁</ci><ci id="A1.SS2.p1.14.m14.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.14.m14.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="A1.SS2.p1.14.m14.1.1.3.cmml" xref="A1.SS2.p1.14.m14.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p1.14.m14.1.1.3.1.cmml" xref="A1.SS2.p1.14.m14.1.1.3">subscript</csymbol><ci id="A1.SS2.p1.14.m14.1.1.3.2.cmml" xref="A1.SS2.p1.14.m14.1.1.3.2">𝜆</ci><ci id="A1.SS2.p1.14.m14.1.1.3.3.cmml" xref="A1.SS2.p1.14.m14.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.14.m14.1c">\mathrm{E}\left[N_{i}\right]=\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.14.m14.1d">roman_E [ italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="A1.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="484" id="A1.F10.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F10.17.8.1" style="font-size:90%;">Figure 10</span>. </span><span class="ltx_text ltx_font_italic" id="A1.F10.14.7" style="font-size:90%;">Comparison of IPID Selection Methods’ Security with Multiple Adversarial Guesses.<span class="ltx_text ltx_font_upright" id="A1.F10.14.7.7">
Adversarial guess probabilities for <math alttext="g\in\{1,10,100\}" class="ltx_Math" display="inline" id="A1.F10.8.1.1.m1.3"><semantics id="A1.F10.8.1.1.m1.3b"><mrow id="A1.F10.8.1.1.m1.3.4" xref="A1.F10.8.1.1.m1.3.4.cmml"><mi id="A1.F10.8.1.1.m1.3.4.2" xref="A1.F10.8.1.1.m1.3.4.2.cmml">g</mi><mo id="A1.F10.8.1.1.m1.3.4.1" xref="A1.F10.8.1.1.m1.3.4.1.cmml">∈</mo><mrow id="A1.F10.8.1.1.m1.3.4.3.2" xref="A1.F10.8.1.1.m1.3.4.3.1.cmml"><mo id="A1.F10.8.1.1.m1.3.4.3.2.1" stretchy="false" xref="A1.F10.8.1.1.m1.3.4.3.1.cmml">{</mo><mn id="A1.F10.8.1.1.m1.1.1" xref="A1.F10.8.1.1.m1.1.1.cmml">1</mn><mo id="A1.F10.8.1.1.m1.3.4.3.2.2" xref="A1.F10.8.1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.F10.8.1.1.m1.2.2" xref="A1.F10.8.1.1.m1.2.2.cmml">10</mn><mo id="A1.F10.8.1.1.m1.3.4.3.2.3" xref="A1.F10.8.1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.F10.8.1.1.m1.3.3" xref="A1.F10.8.1.1.m1.3.3.cmml">100</mn><mo id="A1.F10.8.1.1.m1.3.4.3.2.4" stretchy="false" xref="A1.F10.8.1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.8.1.1.m1.3c"><apply id="A1.F10.8.1.1.m1.3.4.cmml" xref="A1.F10.8.1.1.m1.3.4"><in id="A1.F10.8.1.1.m1.3.4.1.cmml" xref="A1.F10.8.1.1.m1.3.4.1"></in><ci id="A1.F10.8.1.1.m1.3.4.2.cmml" xref="A1.F10.8.1.1.m1.3.4.2">𝑔</ci><set id="A1.F10.8.1.1.m1.3.4.3.1.cmml" xref="A1.F10.8.1.1.m1.3.4.3.2"><cn id="A1.F10.8.1.1.m1.1.1.cmml" type="integer" xref="A1.F10.8.1.1.m1.1.1">1</cn><cn id="A1.F10.8.1.1.m1.2.2.cmml" type="integer" xref="A1.F10.8.1.1.m1.2.2">10</cn><cn id="A1.F10.8.1.1.m1.3.3.cmml" type="integer" xref="A1.F10.8.1.1.m1.3.3">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.8.1.1.m1.3d">g\in\{1,10,100\}</annotation><annotation encoding="application/x-llamapun" id="A1.F10.8.1.1.m1.3e">italic_g ∈ { 1 , 10 , 100 }</annotation></semantics></math> guesses for globally incrementing (dark blue, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E14" title="In A.2.1. Globally Incrementing ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">14</span></a>), per-connection (olive, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E15" title="In A.2.2. Per-Connection ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">15</span></a>), per-destination (pink, also Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E14" title="In A.2.1. Globally Incrementing ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">14</span></a>), per-bucket (teal, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E17" title="In A.2.4. Per-Bucket (Linux) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">17</span></a> with simulation), and PRNG-based (orange, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E19" title="In A.2.5. PRNG (searchable queue of size 𝑘) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">19</span></a>) IPID selection as a function of <math alttext="\lambda" class="ltx_Math" display="inline" id="A1.F10.9.2.2.m2.1"><semantics id="A1.F10.9.2.2.m2.1b"><mi id="A1.F10.9.2.2.m2.1.1" xref="A1.F10.9.2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.F10.9.2.2.m2.1c"><ci id="A1.F10.9.2.2.m2.1.1.cmml" xref="A1.F10.9.2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.9.2.2.m2.1d">\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.F10.9.2.2.m2.1e">italic_λ</annotation></semantics></math>, the Poisson rate of packet transmission.
For selection methods that use <math alttext="r\geq 1" class="ltx_Math" display="inline" id="A1.F10.10.3.3.m3.1"><semantics id="A1.F10.10.3.3.m3.1b"><mrow id="A1.F10.10.3.3.m3.1.1" xref="A1.F10.10.3.3.m3.1.1.cmml"><mi id="A1.F10.10.3.3.m3.1.1.2" xref="A1.F10.10.3.3.m3.1.1.2.cmml">r</mi><mo id="A1.F10.10.3.3.m3.1.1.1" xref="A1.F10.10.3.3.m3.1.1.1.cmml">≥</mo><mn id="A1.F10.10.3.3.m3.1.1.3" xref="A1.F10.10.3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.10.3.3.m3.1c"><apply id="A1.F10.10.3.3.m3.1.1.cmml" xref="A1.F10.10.3.3.m3.1.1"><geq id="A1.F10.10.3.3.m3.1.1.1.cmml" xref="A1.F10.10.3.3.m3.1.1.1"></geq><ci id="A1.F10.10.3.3.m3.1.1.2.cmml" xref="A1.F10.10.3.3.m3.1.1.2">𝑟</ci><cn id="A1.F10.10.3.3.m3.1.1.3.cmml" type="integer" xref="A1.F10.10.3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.10.3.3.m3.1d">r\geq 1</annotation><annotation encoding="application/x-llamapun" id="A1.F10.10.3.3.m3.1e">italic_r ≥ 1</annotation></semantics></math> counters, we compare the case where traffic is uniformly distributed to each counter <math alttext="i" class="ltx_Math" display="inline" id="A1.F10.11.4.4.m4.1"><semantics id="A1.F10.11.4.4.m4.1b"><mi id="A1.F10.11.4.4.m4.1.1" xref="A1.F10.11.4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.F10.11.4.4.m4.1c"><ci id="A1.F10.11.4.4.m4.1.1.cmml" xref="A1.F10.11.4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.11.4.4.m4.1d">i</annotation><annotation encoding="application/x-llamapun" id="A1.F10.11.4.4.m4.1e">italic_i</annotation></semantics></math> with rate <math alttext="\lambda_{i}=\lambda/r" class="ltx_Math" display="inline" id="A1.F10.12.5.5.m5.1"><semantics id="A1.F10.12.5.5.m5.1b"><mrow id="A1.F10.12.5.5.m5.1.1" xref="A1.F10.12.5.5.m5.1.1.cmml"><msub id="A1.F10.12.5.5.m5.1.1.2" xref="A1.F10.12.5.5.m5.1.1.2.cmml"><mi id="A1.F10.12.5.5.m5.1.1.2.2" xref="A1.F10.12.5.5.m5.1.1.2.2.cmml">λ</mi><mi id="A1.F10.12.5.5.m5.1.1.2.3" xref="A1.F10.12.5.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="A1.F10.12.5.5.m5.1.1.1" xref="A1.F10.12.5.5.m5.1.1.1.cmml">=</mo><mrow id="A1.F10.12.5.5.m5.1.1.3" xref="A1.F10.12.5.5.m5.1.1.3.cmml"><mi id="A1.F10.12.5.5.m5.1.1.3.2" xref="A1.F10.12.5.5.m5.1.1.3.2.cmml">λ</mi><mo id="A1.F10.12.5.5.m5.1.1.3.1" xref="A1.F10.12.5.5.m5.1.1.3.1.cmml">/</mo><mi id="A1.F10.12.5.5.m5.1.1.3.3" xref="A1.F10.12.5.5.m5.1.1.3.3.cmml">r</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.12.5.5.m5.1c"><apply id="A1.F10.12.5.5.m5.1.1.cmml" xref="A1.F10.12.5.5.m5.1.1"><eq id="A1.F10.12.5.5.m5.1.1.1.cmml" xref="A1.F10.12.5.5.m5.1.1.1"></eq><apply id="A1.F10.12.5.5.m5.1.1.2.cmml" xref="A1.F10.12.5.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.F10.12.5.5.m5.1.1.2.1.cmml" xref="A1.F10.12.5.5.m5.1.1.2">subscript</csymbol><ci id="A1.F10.12.5.5.m5.1.1.2.2.cmml" xref="A1.F10.12.5.5.m5.1.1.2.2">𝜆</ci><ci id="A1.F10.12.5.5.m5.1.1.2.3.cmml" xref="A1.F10.12.5.5.m5.1.1.2.3">𝑖</ci></apply><apply id="A1.F10.12.5.5.m5.1.1.3.cmml" xref="A1.F10.12.5.5.m5.1.1.3"><divide id="A1.F10.12.5.5.m5.1.1.3.1.cmml" xref="A1.F10.12.5.5.m5.1.1.3.1"></divide><ci id="A1.F10.12.5.5.m5.1.1.3.2.cmml" xref="A1.F10.12.5.5.m5.1.1.3.2">𝜆</ci><ci id="A1.F10.12.5.5.m5.1.1.3.3.cmml" xref="A1.F10.12.5.5.m5.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.12.5.5.m5.1d">\lambda_{i}=\lambda/r</annotation><annotation encoding="application/x-llamapun" id="A1.F10.12.5.5.m5.1e">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_λ / italic_r</annotation></semantics></math> (top) and the worst-case scenario when traffic is allocated to <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="A1.F10.13.6.6.m6.1"><semantics id="A1.F10.13.6.6.m6.1b"><msub id="A1.F10.13.6.6.m6.1.1" xref="A1.F10.13.6.6.m6.1.1.cmml"><mi id="A1.F10.13.6.6.m6.1.1.2" xref="A1.F10.13.6.6.m6.1.1.2.cmml">λ</mi><mi id="A1.F10.13.6.6.m6.1.1.3" xref="A1.F10.13.6.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.F10.13.6.6.m6.1c"><apply id="A1.F10.13.6.6.m6.1.1.cmml" xref="A1.F10.13.6.6.m6.1.1"><csymbol cd="ambiguous" id="A1.F10.13.6.6.m6.1.1.1.cmml" xref="A1.F10.13.6.6.m6.1.1">subscript</csymbol><ci id="A1.F10.13.6.6.m6.1.1.2.cmml" xref="A1.F10.13.6.6.m6.1.1.2">𝜆</ci><ci id="A1.F10.13.6.6.m6.1.1.3.cmml" xref="A1.F10.13.6.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.13.6.6.m6.1d">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.F10.13.6.6.m6.1e">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> such that the adversarial guess probability is maximized (bottom).
The total number of distinct IPIDs, <math alttext="2^{16}" class="ltx_Math" display="inline" id="A1.F10.14.7.7.m7.1"><semantics id="A1.F10.14.7.7.m7.1b"><msup id="A1.F10.14.7.7.m7.1.1" xref="A1.F10.14.7.7.m7.1.1.cmml"><mn id="A1.F10.14.7.7.m7.1.1.2" xref="A1.F10.14.7.7.m7.1.1.2.cmml">2</mn><mn id="A1.F10.14.7.7.m7.1.1.3" xref="A1.F10.14.7.7.m7.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A1.F10.14.7.7.m7.1c"><apply id="A1.F10.14.7.7.m7.1.1.cmml" xref="A1.F10.14.7.7.m7.1.1"><csymbol cd="ambiguous" id="A1.F10.14.7.7.m7.1.1.1.cmml" xref="A1.F10.14.7.7.m7.1.1">superscript</csymbol><cn id="A1.F10.14.7.7.m7.1.1.2.cmml" type="integer" xref="A1.F10.14.7.7.m7.1.1.2">2</cn><cn id="A1.F10.14.7.7.m7.1.1.3.cmml" type="integer" xref="A1.F10.14.7.7.m7.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.14.7.7.m7.1d">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.F10.14.7.7.m7.1e">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>, is shown as a black dotted line.</span></span></figcaption>
</figure>
<section class="ltx_subsubsection" id="A1.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1. </span>Globally Incrementing</h4>
<div class="ltx_para" id="A1.SS2.SSS1.p1">
<p class="ltx_p" id="A1.SS2.SSS1.p1.11">Globally incrementing selection uses one global counter for all IPID generation, so <math alttext="r=1" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.1.m1.1"><semantics id="A1.SS2.SSS1.p1.1.m1.1a"><mrow id="A1.SS2.SSS1.p1.1.m1.1.1" xref="A1.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="A1.SS2.SSS1.p1.1.m1.1.1.2" xref="A1.SS2.SSS1.p1.1.m1.1.1.2.cmml">r</mi><mo id="A1.SS2.SSS1.p1.1.m1.1.1.1" xref="A1.SS2.SSS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS2.SSS1.p1.1.m1.1.1.3" xref="A1.SS2.SSS1.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.1.m1.1b"><apply id="A1.SS2.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS1.p1.1.m1.1.1"><eq id="A1.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSS1.p1.1.m1.1.1.1"></eq><ci id="A1.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="A1.SS2.SSS1.p1.1.m1.1.1.2">𝑟</ci><cn id="A1.SS2.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.SSS1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.1.m1.1c">r=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.1.m1.1d">italic_r = 1</annotation></semantics></math> and <math alttext="\lambda_{i}=\lambda" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.2.m2.1"><semantics id="A1.SS2.SSS1.p1.2.m2.1a"><mrow id="A1.SS2.SSS1.p1.2.m2.1.1" xref="A1.SS2.SSS1.p1.2.m2.1.1.cmml"><msub id="A1.SS2.SSS1.p1.2.m2.1.1.2" xref="A1.SS2.SSS1.p1.2.m2.1.1.2.cmml"><mi id="A1.SS2.SSS1.p1.2.m2.1.1.2.2" xref="A1.SS2.SSS1.p1.2.m2.1.1.2.2.cmml">λ</mi><mi id="A1.SS2.SSS1.p1.2.m2.1.1.2.3" xref="A1.SS2.SSS1.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p1.2.m2.1.1.1" xref="A1.SS2.SSS1.p1.2.m2.1.1.1.cmml">=</mo><mi id="A1.SS2.SSS1.p1.2.m2.1.1.3" xref="A1.SS2.SSS1.p1.2.m2.1.1.3.cmml">λ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.2.m2.1b"><apply id="A1.SS2.SSS1.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1"><eq id="A1.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.1"></eq><apply id="A1.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.2.m2.1.1.2.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS2.SSS1.p1.2.m2.1.1.2.2.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.2.2">𝜆</ci><ci id="A1.SS2.SSS1.p1.2.m2.1.1.2.3.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="A1.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.2.m2.1c">\lambda_{i}=\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_λ</annotation></semantics></math>.
The adversary <math alttext="A" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.3.m3.1"><semantics id="A1.SS2.SSS1.p1.3.m3.1a"><mi id="A1.SS2.SSS1.p1.3.m3.1.1" xref="A1.SS2.SSS1.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.3.m3.1b"><ci id="A1.SS2.SSS1.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.3.m3.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.3.m3.1d">italic_A</annotation></semantics></math> can check the status of this counter by probing <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.4.m4.1"><semantics id="A1.SS2.SSS1.p1.4.m4.1a"><mi id="A1.SS2.SSS1.p1.4.m4.1.1" xref="A1.SS2.SSS1.p1.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.4.m4.1b"><ci id="A1.SS2.SSS1.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS1.p1.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.4.m4.1d">italic_S</annotation></semantics></math> and examining the resulting IPID.
This tells <math alttext="A" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.5.m5.1"><semantics id="A1.SS2.SSS1.p1.5.m5.1a"><mi id="A1.SS2.SSS1.p1.5.m5.1.1" xref="A1.SS2.SSS1.p1.5.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.5.m5.1b"><ci id="A1.SS2.SSS1.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS1.p1.5.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.5.m5.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.5.m5.1d">italic_A</annotation></semantics></math> the status of the global counter one unit time ago, when the reply was sent; w.l.o.g., suppose the IPID of this reply was 0.
Since the global counter increments once per packet sent by <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.6.m6.1"><semantics id="A1.SS2.SSS1.p1.6.m6.1a"><mi id="A1.SS2.SSS1.p1.6.m6.1.1" xref="A1.SS2.SSS1.p1.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.6.m6.1b"><ci id="A1.SS2.SSS1.p1.6.m6.1.1.cmml" xref="A1.SS2.SSS1.p1.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.6.m6.1d">italic_S</annotation></semantics></math> and there have been <math alttext="N_{i}=N" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.7.m7.1"><semantics id="A1.SS2.SSS1.p1.7.m7.1a"><mrow id="A1.SS2.SSS1.p1.7.m7.1.1" xref="A1.SS2.SSS1.p1.7.m7.1.1.cmml"><msub id="A1.SS2.SSS1.p1.7.m7.1.1.2" xref="A1.SS2.SSS1.p1.7.m7.1.1.2.cmml"><mi id="A1.SS2.SSS1.p1.7.m7.1.1.2.2" xref="A1.SS2.SSS1.p1.7.m7.1.1.2.2.cmml">N</mi><mi id="A1.SS2.SSS1.p1.7.m7.1.1.2.3" xref="A1.SS2.SSS1.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS2.SSS1.p1.7.m7.1.1.1" xref="A1.SS2.SSS1.p1.7.m7.1.1.1.cmml">=</mo><mi id="A1.SS2.SSS1.p1.7.m7.1.1.3" xref="A1.SS2.SSS1.p1.7.m7.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.7.m7.1b"><apply id="A1.SS2.SSS1.p1.7.m7.1.1.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1"><eq id="A1.SS2.SSS1.p1.7.m7.1.1.1.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.1"></eq><apply id="A1.SS2.SSS1.p1.7.m7.1.1.2.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.7.m7.1.1.2.1.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="A1.SS2.SSS1.p1.7.m7.1.1.2.2.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.2.2">𝑁</ci><ci id="A1.SS2.SSS1.p1.7.m7.1.1.2.3.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.2.3">𝑖</ci></apply><ci id="A1.SS2.SSS1.p1.7.m7.1.1.3.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.7.m7.1c">N_{i}=N</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.7.m7.1d">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_N</annotation></semantics></math> packets sent by <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.8.m8.1"><semantics id="A1.SS2.SSS1.p1.8.m8.1a"><mi id="A1.SS2.SSS1.p1.8.m8.1.1" xref="A1.SS2.SSS1.p1.8.m8.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.8.m8.1b"><ci id="A1.SS2.SSS1.p1.8.m8.1.1.cmml" xref="A1.SS2.SSS1.p1.8.m8.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.8.m8.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.8.m8.1d">italic_S</annotation></semantics></math> in the last unit time, the current status of the global counter is <math alttext="N\bmod 2^{16}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.9.m9.1"><semantics id="A1.SS2.SSS1.p1.9.m9.1a"><mrow id="A1.SS2.SSS1.p1.9.m9.1.1" xref="A1.SS2.SSS1.p1.9.m9.1.1.cmml"><mi id="A1.SS2.SSS1.p1.9.m9.1.1.2" xref="A1.SS2.SSS1.p1.9.m9.1.1.2.cmml">N</mi><mo id="A1.SS2.SSS1.p1.9.m9.1.1.1" xref="A1.SS2.SSS1.p1.9.m9.1.1.1.cmml">mod</mo><msup id="A1.SS2.SSS1.p1.9.m9.1.1.3" xref="A1.SS2.SSS1.p1.9.m9.1.1.3.cmml"><mn id="A1.SS2.SSS1.p1.9.m9.1.1.3.2" xref="A1.SS2.SSS1.p1.9.m9.1.1.3.2.cmml">2</mn><mn id="A1.SS2.SSS1.p1.9.m9.1.1.3.3" xref="A1.SS2.SSS1.p1.9.m9.1.1.3.3.cmml">16</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.9.m9.1b"><apply id="A1.SS2.SSS1.p1.9.m9.1.1.cmml" xref="A1.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="latexml" id="A1.SS2.SSS1.p1.9.m9.1.1.1.cmml" xref="A1.SS2.SSS1.p1.9.m9.1.1.1">modulo</csymbol><ci id="A1.SS2.SSS1.p1.9.m9.1.1.2.cmml" xref="A1.SS2.SSS1.p1.9.m9.1.1.2">𝑁</ci><apply id="A1.SS2.SSS1.p1.9.m9.1.1.3.cmml" xref="A1.SS2.SSS1.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.9.m9.1.1.3.1.cmml" xref="A1.SS2.SSS1.p1.9.m9.1.1.3">superscript</csymbol><cn id="A1.SS2.SSS1.p1.9.m9.1.1.3.2.cmml" type="integer" xref="A1.SS2.SSS1.p1.9.m9.1.1.3.2">2</cn><cn id="A1.SS2.SSS1.p1.9.m9.1.1.3.3.cmml" type="integer" xref="A1.SS2.SSS1.p1.9.m9.1.1.3.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.9.m9.1c">N\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.9.m9.1d">italic_N roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> and the next IPID will be <math alttext="N+1\bmod 2^{16}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.10.m10.1"><semantics id="A1.SS2.SSS1.p1.10.m10.1a"><mrow id="A1.SS2.SSS1.p1.10.m10.1.1" xref="A1.SS2.SSS1.p1.10.m10.1.1.cmml"><mrow id="A1.SS2.SSS1.p1.10.m10.1.1.2" xref="A1.SS2.SSS1.p1.10.m10.1.1.2.cmml"><mi id="A1.SS2.SSS1.p1.10.m10.1.1.2.2" xref="A1.SS2.SSS1.p1.10.m10.1.1.2.2.cmml">N</mi><mo id="A1.SS2.SSS1.p1.10.m10.1.1.2.1" xref="A1.SS2.SSS1.p1.10.m10.1.1.2.1.cmml">+</mo><mn id="A1.SS2.SSS1.p1.10.m10.1.1.2.3" xref="A1.SS2.SSS1.p1.10.m10.1.1.2.3.cmml">1</mn></mrow><mo id="A1.SS2.SSS1.p1.10.m10.1.1.1" xref="A1.SS2.SSS1.p1.10.m10.1.1.1.cmml">mod</mo><msup id="A1.SS2.SSS1.p1.10.m10.1.1.3" xref="A1.SS2.SSS1.p1.10.m10.1.1.3.cmml"><mn id="A1.SS2.SSS1.p1.10.m10.1.1.3.2" xref="A1.SS2.SSS1.p1.10.m10.1.1.3.2.cmml">2</mn><mn id="A1.SS2.SSS1.p1.10.m10.1.1.3.3" xref="A1.SS2.SSS1.p1.10.m10.1.1.3.3.cmml">16</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.10.m10.1b"><apply id="A1.SS2.SSS1.p1.10.m10.1.1.cmml" xref="A1.SS2.SSS1.p1.10.m10.1.1"><csymbol cd="latexml" id="A1.SS2.SSS1.p1.10.m10.1.1.1.cmml" xref="A1.SS2.SSS1.p1.10.m10.1.1.1">modulo</csymbol><apply id="A1.SS2.SSS1.p1.10.m10.1.1.2.cmml" xref="A1.SS2.SSS1.p1.10.m10.1.1.2"><plus id="A1.SS2.SSS1.p1.10.m10.1.1.2.1.cmml" xref="A1.SS2.SSS1.p1.10.m10.1.1.2.1"></plus><ci id="A1.SS2.SSS1.p1.10.m10.1.1.2.2.cmml" xref="A1.SS2.SSS1.p1.10.m10.1.1.2.2">𝑁</ci><cn id="A1.SS2.SSS1.p1.10.m10.1.1.2.3.cmml" type="integer" xref="A1.SS2.SSS1.p1.10.m10.1.1.2.3">1</cn></apply><apply id="A1.SS2.SSS1.p1.10.m10.1.1.3.cmml" xref="A1.SS2.SSS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.10.m10.1.1.3.1.cmml" xref="A1.SS2.SSS1.p1.10.m10.1.1.3">superscript</csymbol><cn id="A1.SS2.SSS1.p1.10.m10.1.1.3.2.cmml" type="integer" xref="A1.SS2.SSS1.p1.10.m10.1.1.3.2">2</cn><cn id="A1.SS2.SSS1.p1.10.m10.1.1.3.3.cmml" type="integer" xref="A1.SS2.SSS1.p1.10.m10.1.1.3.3">16</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.10.m10.1c">N+1\bmod 2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.10.m10.1d">italic_N + 1 roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math>.
Thus, the probability that the next IPID is <math alttext="x" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.11.m11.1"><semantics id="A1.SS2.SSS1.p1.11.m11.1a"><mi id="A1.SS2.SSS1.p1.11.m11.1.1" xref="A1.SS2.SSS1.p1.11.m11.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.11.m11.1b"><ci id="A1.SS2.SSS1.p1.11.m11.1.1.cmml" xref="A1.SS2.SSS1.p1.11.m11.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.11.m11.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.11.m11.1d">italic_x</annotation></semantics></math> is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx4">
<tbody id="A1.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{Pr}\left[\text{next IPID}=x\right]" class="ltx_Math" display="inline" id="A1.Ex3.m1.1"><semantics id="A1.Ex3.m1.1a"><mrow id="A1.Ex3.m1.1.1" xref="A1.Ex3.m1.1.1.cmml"><mi id="A1.Ex3.m1.1.1.3" xref="A1.Ex3.m1.1.1.3.cmml">Pr</mi><mo id="A1.Ex3.m1.1.1.2" xref="A1.Ex3.m1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex3.m1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.2.cmml"><mo id="A1.Ex3.m1.1.1.1.1.2" xref="A1.Ex3.m1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex3.m1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.cmml"><mtext id="A1.Ex3.m1.1.1.1.1.1.2" xref="A1.Ex3.m1.1.1.1.1.1.2a.cmml">next IPID</mtext><mo id="A1.Ex3.m1.1.1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.1.1.cmml">=</mo><mi id="A1.Ex3.m1.1.1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex3.m1.1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex3.m1.1b"><apply id="A1.Ex3.m1.1.1.cmml" xref="A1.Ex3.m1.1.1"><times id="A1.Ex3.m1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.2"></times><ci id="A1.Ex3.m1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.3">Pr</ci><apply id="A1.Ex3.m1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex3.m1.1.1.1.2.1.cmml" xref="A1.Ex3.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex3.m1.1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1"><eq id="A1.Ex3.m1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1.1.1"></eq><ci id="A1.Ex3.m1.1.1.1.1.1.2a.cmml" xref="A1.Ex3.m1.1.1.1.1.1.2"><mtext id="A1.Ex3.m1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.1.1.2">next IPID</mtext></ci><ci id="A1.Ex3.m1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex3.m1.1c">\displaystyle\mathrm{Pr}\left[\text{next IPID}=x\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex3.m1.1d">roman_Pr [ next IPID = italic_x ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{Pr}\left[N+1\equiv x\bmod 2^{16}\right]" class="ltx_Math" display="inline" id="A1.Ex3.m2.1"><semantics id="A1.Ex3.m2.1a"><mrow id="A1.Ex3.m2.1.1" xref="A1.Ex3.m2.1.1.cmml"><mi id="A1.Ex3.m2.1.1.3" xref="A1.Ex3.m2.1.1.3.cmml"></mi><mo id="A1.Ex3.m2.1.1.2" xref="A1.Ex3.m2.1.1.2.cmml">=</mo><mrow id="A1.Ex3.m2.1.1.1" xref="A1.Ex3.m2.1.1.1.cmml"><mi id="A1.Ex3.m2.1.1.1.3" xref="A1.Ex3.m2.1.1.1.3.cmml">Pr</mi><mo id="A1.Ex3.m2.1.1.1.2" xref="A1.Ex3.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex3.m2.1.1.1.1.1" xref="A1.Ex3.m2.1.1.1.1.2.cmml"><mo id="A1.Ex3.m2.1.1.1.1.1.2" xref="A1.Ex3.m2.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex3.m2.1.1.1.1.1.1" xref="A1.Ex3.m2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex3.m2.1.1.1.1.1.1.2" xref="A1.Ex3.m2.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex3.m2.1.1.1.1.1.1.2.2" xref="A1.Ex3.m2.1.1.1.1.1.1.2.2.cmml">N</mi><mo id="A1.Ex3.m2.1.1.1.1.1.1.2.1" xref="A1.Ex3.m2.1.1.1.1.1.1.2.1.cmml">+</mo><mn id="A1.Ex3.m2.1.1.1.1.1.1.2.3" xref="A1.Ex3.m2.1.1.1.1.1.1.2.3.cmml">1</mn></mrow><mo id="A1.Ex3.m2.1.1.1.1.1.1.1" xref="A1.Ex3.m2.1.1.1.1.1.1.1.cmml">≡</mo><mrow id="A1.Ex3.m2.1.1.1.1.1.1.3" xref="A1.Ex3.m2.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex3.m2.1.1.1.1.1.1.3.2" xref="A1.Ex3.m2.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="A1.Ex3.m2.1.1.1.1.1.1.3.1" xref="A1.Ex3.m2.1.1.1.1.1.1.3.1.cmml">mod</mo><msup id="A1.Ex3.m2.1.1.1.1.1.1.3.3" xref="A1.Ex3.m2.1.1.1.1.1.1.3.3.cmml"><mn id="A1.Ex3.m2.1.1.1.1.1.1.3.3.2" xref="A1.Ex3.m2.1.1.1.1.1.1.3.3.2.cmml">2</mn><mn id="A1.Ex3.m2.1.1.1.1.1.1.3.3.3" xref="A1.Ex3.m2.1.1.1.1.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.Ex3.m2.1.1.1.1.1.3" xref="A1.Ex3.m2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex3.m2.1b"><apply id="A1.Ex3.m2.1.1.cmml" xref="A1.Ex3.m2.1.1"><eq id="A1.Ex3.m2.1.1.2.cmml" xref="A1.Ex3.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex3.m2.1.1.3.cmml" xref="A1.Ex3.m2.1.1.3">absent</csymbol><apply id="A1.Ex3.m2.1.1.1.cmml" xref="A1.Ex3.m2.1.1.1"><times id="A1.Ex3.m2.1.1.1.2.cmml" xref="A1.Ex3.m2.1.1.1.2"></times><ci id="A1.Ex3.m2.1.1.1.3.cmml" xref="A1.Ex3.m2.1.1.1.3">Pr</ci><apply id="A1.Ex3.m2.1.1.1.1.2.cmml" xref="A1.Ex3.m2.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex3.m2.1.1.1.1.2.1.cmml" xref="A1.Ex3.m2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex3.m2.1.1.1.1.1.1.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1"><equivalent id="A1.Ex3.m2.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.1"></equivalent><apply id="A1.Ex3.m2.1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.2"><plus id="A1.Ex3.m2.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.2.1"></plus><ci id="A1.Ex3.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.2.2">𝑁</ci><cn id="A1.Ex3.m2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex3.m2.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.Ex3.m2.1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.Ex3.m2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.3.1">modulo</csymbol><ci id="A1.Ex3.m2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.3.2">𝑥</ci><apply id="A1.Ex3.m2.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex3.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex3.m2.1.1.1.1.1.1.3.3">superscript</csymbol><cn id="A1.Ex3.m2.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.Ex3.m2.1.1.1.1.1.1.3.3.2">2</cn><cn id="A1.Ex3.m2.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex3.m2.1.1.1.1.1.1.3.3.3">16</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex3.m2.1c">\displaystyle=\mathrm{Pr}\left[N+1\equiv x\bmod 2^{16}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex3.m2.1d">= roman_Pr [ italic_N + 1 ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=0}^{\infty}\mathrm{Pr}\left[N+1\equiv x\bmod 2^{16}\mid N%
=n\right]\cdot\mathrm{Pr}\left[N=n\right]" class="ltx_Math" display="inline" id="A1.Ex4.m1.2"><semantics id="A1.Ex4.m1.2a"><mrow id="A1.Ex4.m1.2.2" xref="A1.Ex4.m1.2.2.cmml"><mi id="A1.Ex4.m1.2.2.4" xref="A1.Ex4.m1.2.2.4.cmml"></mi><mo id="A1.Ex4.m1.2.2.3" xref="A1.Ex4.m1.2.2.3.cmml">=</mo><mrow id="A1.Ex4.m1.2.2.2" xref="A1.Ex4.m1.2.2.2.cmml"><mstyle displaystyle="true" id="A1.Ex4.m1.2.2.2.3" xref="A1.Ex4.m1.2.2.2.3.cmml"><munderover id="A1.Ex4.m1.2.2.2.3a" xref="A1.Ex4.m1.2.2.2.3.cmml"><mo id="A1.Ex4.m1.2.2.2.3.2.2" movablelimits="false" xref="A1.Ex4.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="A1.Ex4.m1.2.2.2.3.2.3" xref="A1.Ex4.m1.2.2.2.3.2.3.cmml"><mi id="A1.Ex4.m1.2.2.2.3.2.3.2" xref="A1.Ex4.m1.2.2.2.3.2.3.2.cmml">n</mi><mo id="A1.Ex4.m1.2.2.2.3.2.3.1" xref="A1.Ex4.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="A1.Ex4.m1.2.2.2.3.2.3.3" xref="A1.Ex4.m1.2.2.2.3.2.3.3.cmml">0</mn></mrow><mi id="A1.Ex4.m1.2.2.2.3.3" mathvariant="normal" xref="A1.Ex4.m1.2.2.2.3.3.cmml">∞</mi></munderover></mstyle><mrow id="A1.Ex4.m1.2.2.2.2" xref="A1.Ex4.m1.2.2.2.2.cmml"><mrow id="A1.Ex4.m1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.cmml"><mrow id="A1.Ex4.m1.1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex4.m1.1.1.1.1.1.1.3" xref="A1.Ex4.m1.1.1.1.1.1.1.3.cmml">Pr</mi><mo id="A1.Ex4.m1.1.1.1.1.1.1.2" xref="A1.Ex4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex4.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">N</mi><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">+</mo><mn id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></mrow><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml">≡</mo><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">x</mi><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.1.cmml">mod</mo><mrow id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.cmml"><msup id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.cmml"><mn id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.2" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.2.cmml">2</mn><mn id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.cmml">16</mn></msup><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.1" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">∣</mo><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.3" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">N</mi></mrow></mrow><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.5" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.5.cmml">=</mo><mi id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.6" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.6.cmml">n</mi></mrow><mo id="A1.Ex4.m1.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.Ex4.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex4.m1.1.1.1.1.1.2" rspace="0.222em" xref="A1.Ex4.m1.1.1.1.1.1.2.cmml">⋅</mo><mi id="A1.Ex4.m1.1.1.1.1.1.3" xref="A1.Ex4.m1.1.1.1.1.1.3.cmml">Pr</mi></mrow><mo id="A1.Ex4.m1.2.2.2.2.3" xref="A1.Ex4.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="A1.Ex4.m1.2.2.2.2.2.1" xref="A1.Ex4.m1.2.2.2.2.2.2.cmml"><mo id="A1.Ex4.m1.2.2.2.2.2.1.2" xref="A1.Ex4.m1.2.2.2.2.2.2.1.cmml">[</mo><mrow id="A1.Ex4.m1.2.2.2.2.2.1.1" xref="A1.Ex4.m1.2.2.2.2.2.1.1.cmml"><mi id="A1.Ex4.m1.2.2.2.2.2.1.1.2" xref="A1.Ex4.m1.2.2.2.2.2.1.1.2.cmml">N</mi><mo id="A1.Ex4.m1.2.2.2.2.2.1.1.1" xref="A1.Ex4.m1.2.2.2.2.2.1.1.1.cmml">=</mo><mi id="A1.Ex4.m1.2.2.2.2.2.1.1.3" xref="A1.Ex4.m1.2.2.2.2.2.1.1.3.cmml">n</mi></mrow><mo id="A1.Ex4.m1.2.2.2.2.2.1.3" xref="A1.Ex4.m1.2.2.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex4.m1.2b"><apply id="A1.Ex4.m1.2.2.cmml" xref="A1.Ex4.m1.2.2"><eq id="A1.Ex4.m1.2.2.3.cmml" xref="A1.Ex4.m1.2.2.3"></eq><csymbol cd="latexml" id="A1.Ex4.m1.2.2.4.cmml" xref="A1.Ex4.m1.2.2.4">absent</csymbol><apply id="A1.Ex4.m1.2.2.2.cmml" xref="A1.Ex4.m1.2.2.2"><apply id="A1.Ex4.m1.2.2.2.3.cmml" xref="A1.Ex4.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex4.m1.2.2.2.3.1.cmml" xref="A1.Ex4.m1.2.2.2.3">superscript</csymbol><apply id="A1.Ex4.m1.2.2.2.3.2.cmml" xref="A1.Ex4.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex4.m1.2.2.2.3.2.1.cmml" xref="A1.Ex4.m1.2.2.2.3">subscript</csymbol><sum id="A1.Ex4.m1.2.2.2.3.2.2.cmml" xref="A1.Ex4.m1.2.2.2.3.2.2"></sum><apply id="A1.Ex4.m1.2.2.2.3.2.3.cmml" xref="A1.Ex4.m1.2.2.2.3.2.3"><eq id="A1.Ex4.m1.2.2.2.3.2.3.1.cmml" xref="A1.Ex4.m1.2.2.2.3.2.3.1"></eq><ci id="A1.Ex4.m1.2.2.2.3.2.3.2.cmml" xref="A1.Ex4.m1.2.2.2.3.2.3.2">𝑛</ci><cn id="A1.Ex4.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="A1.Ex4.m1.2.2.2.3.2.3.3">0</cn></apply></apply><infinity id="A1.Ex4.m1.2.2.2.3.3.cmml" xref="A1.Ex4.m1.2.2.2.3.3"></infinity></apply><apply id="A1.Ex4.m1.2.2.2.2.cmml" xref="A1.Ex4.m1.2.2.2.2"><times id="A1.Ex4.m1.2.2.2.2.3.cmml" xref="A1.Ex4.m1.2.2.2.2.3"></times><apply id="A1.Ex4.m1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1"><ci id="A1.Ex4.m1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.2">⋅</ci><apply id="A1.Ex4.m1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1"><times id="A1.Ex4.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.2"></times><ci id="A1.Ex4.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.3">Pr</ci><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1"><and id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1a.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1"></and><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1b.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1"><equivalent id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.3"></equivalent><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2"><plus id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.1"></plus><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2">𝑁</ci><cn id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="latexml" id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.1">modulo</csymbol><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.2">𝑥</ci><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3"><csymbol cd="latexml" id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.1">conditional</csymbol><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.1.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2">superscript</csymbol><cn id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.2.cmml" type="integer" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.2">2</cn><cn id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.cmml" type="integer" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.2.3">16</cn></apply><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.3.3">𝑁</ci></apply></apply></apply><apply id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1c.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1"><eq id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2406.06483v2#A1.Ex4.m1.1.1.1.1.1.1.1.1.1.4.cmml" id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1d.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1"></share><ci id="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="A1.Ex4.m1.1.1.1.1.1.1.1.1.1.6">𝑛</ci></apply></apply></apply></apply><ci id="A1.Ex4.m1.1.1.1.1.1.3.cmml" xref="A1.Ex4.m1.1.1.1.1.1.3">Pr</ci></apply><apply id="A1.Ex4.m1.2.2.2.2.2.2.cmml" xref="A1.Ex4.m1.2.2.2.2.2.1"><csymbol cd="latexml" id="A1.Ex4.m1.2.2.2.2.2.2.1.cmml" xref="A1.Ex4.m1.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="A1.Ex4.m1.2.2.2.2.2.1.1.cmml" xref="A1.Ex4.m1.2.2.2.2.2.1.1"><eq id="A1.Ex4.m1.2.2.2.2.2.1.1.1.cmml" xref="A1.Ex4.m1.2.2.2.2.2.1.1.1"></eq><ci id="A1.Ex4.m1.2.2.2.2.2.1.1.2.cmml" xref="A1.Ex4.m1.2.2.2.2.2.1.1.2">𝑁</ci><ci id="A1.Ex4.m1.2.2.2.2.2.1.1.3.cmml" xref="A1.Ex4.m1.2.2.2.2.2.1.1.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex4.m1.2c">\displaystyle=\sum_{n=0}^{\infty}\mathrm{Pr}\left[N+1\equiv x\bmod 2^{16}\mid N%
=n\right]\cdot\mathrm{Pr}\left[N=n\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex4.m1.2d">= ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_Pr [ italic_N + 1 ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ∣ italic_N = italic_n ] ⋅ roman_Pr [ italic_N = italic_n ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=0}^{\infty}\mathrm{Pr}\left[n+1\equiv x\bmod 2^{16}%
\right]\cdot\mathrm{pmf}(n,\lambda)," class="ltx_Math" display="inline" id="A1.E13.m1.3"><semantics id="A1.E13.m1.3a"><mrow id="A1.E13.m1.3.3.1" xref="A1.E13.m1.3.3.1.1.cmml"><mrow id="A1.E13.m1.3.3.1.1" xref="A1.E13.m1.3.3.1.1.cmml"><mi id="A1.E13.m1.3.3.1.1.3" xref="A1.E13.m1.3.3.1.1.3.cmml"></mi><mo id="A1.E13.m1.3.3.1.1.2" xref="A1.E13.m1.3.3.1.1.2.cmml">=</mo><mrow id="A1.E13.m1.3.3.1.1.1" xref="A1.E13.m1.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E13.m1.3.3.1.1.1.2" xref="A1.E13.m1.3.3.1.1.1.2.cmml"><munderover id="A1.E13.m1.3.3.1.1.1.2a" xref="A1.E13.m1.3.3.1.1.1.2.cmml"><mo id="A1.E13.m1.3.3.1.1.1.2.2.2" movablelimits="false" xref="A1.E13.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E13.m1.3.3.1.1.1.2.2.3" xref="A1.E13.m1.3.3.1.1.1.2.2.3.cmml"><mi id="A1.E13.m1.3.3.1.1.1.2.2.3.2" xref="A1.E13.m1.3.3.1.1.1.2.2.3.2.cmml">n</mi><mo id="A1.E13.m1.3.3.1.1.1.2.2.3.1" xref="A1.E13.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E13.m1.3.3.1.1.1.2.2.3.3" xref="A1.E13.m1.3.3.1.1.1.2.2.3.3.cmml">0</mn></mrow><mi id="A1.E13.m1.3.3.1.1.1.2.3" mathvariant="normal" xref="A1.E13.m1.3.3.1.1.1.2.3.cmml">∞</mi></munderover></mstyle><mrow id="A1.E13.m1.3.3.1.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.cmml"><mrow id="A1.E13.m1.3.3.1.1.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.1.cmml"><mrow id="A1.E13.m1.3.3.1.1.1.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.1.1.cmml"><mi id="A1.E13.m1.3.3.1.1.1.1.1.1.3" xref="A1.E13.m1.3.3.1.1.1.1.1.1.3.cmml">Pr</mi><mo id="A1.E13.m1.3.3.1.1.1.1.1.1.2" xref="A1.E13.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">n</mi><mo id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml">+</mo><mn id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></mrow><mo id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">≡</mo><mrow id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">mod</mo><msup id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">2</mn><mn id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E13.m1.3.3.1.1.1.1.1.2" rspace="0.222em" xref="A1.E13.m1.3.3.1.1.1.1.1.2.cmml">⋅</mo><mi id="A1.E13.m1.3.3.1.1.1.1.1.3" xref="A1.E13.m1.3.3.1.1.1.1.1.3.cmml">pmf</mi></mrow><mo id="A1.E13.m1.3.3.1.1.1.1.2" xref="A1.E13.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.3.3.1.1.1.1.3.2" xref="A1.E13.m1.3.3.1.1.1.1.3.1.cmml"><mo id="A1.E13.m1.3.3.1.1.1.1.3.2.1" stretchy="false" xref="A1.E13.m1.3.3.1.1.1.1.3.1.cmml">(</mo><mi id="A1.E13.m1.1.1" xref="A1.E13.m1.1.1.cmml">n</mi><mo id="A1.E13.m1.3.3.1.1.1.1.3.2.2" xref="A1.E13.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="A1.E13.m1.2.2" xref="A1.E13.m1.2.2.cmml">λ</mi><mo id="A1.E13.m1.3.3.1.1.1.1.3.2.3" stretchy="false" xref="A1.E13.m1.3.3.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E13.m1.3.3.1.2" xref="A1.E13.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.3b"><apply id="A1.E13.m1.3.3.1.1.cmml" xref="A1.E13.m1.3.3.1"><eq id="A1.E13.m1.3.3.1.1.2.cmml" xref="A1.E13.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="A1.E13.m1.3.3.1.1.3.cmml" xref="A1.E13.m1.3.3.1.1.3">absent</csymbol><apply id="A1.E13.m1.3.3.1.1.1.cmml" xref="A1.E13.m1.3.3.1.1.1"><apply id="A1.E13.m1.3.3.1.1.1.2.cmml" xref="A1.E13.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.1.1.1.2.1.cmml" xref="A1.E13.m1.3.3.1.1.1.2">superscript</csymbol><apply id="A1.E13.m1.3.3.1.1.1.2.2.cmml" xref="A1.E13.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.1.1.1.2.2.1.cmml" xref="A1.E13.m1.3.3.1.1.1.2">subscript</csymbol><sum id="A1.E13.m1.3.3.1.1.1.2.2.2.cmml" xref="A1.E13.m1.3.3.1.1.1.2.2.2"></sum><apply id="A1.E13.m1.3.3.1.1.1.2.2.3.cmml" xref="A1.E13.m1.3.3.1.1.1.2.2.3"><eq id="A1.E13.m1.3.3.1.1.1.2.2.3.1.cmml" xref="A1.E13.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="A1.E13.m1.3.3.1.1.1.2.2.3.2.cmml" xref="A1.E13.m1.3.3.1.1.1.2.2.3.2">𝑛</ci><cn id="A1.E13.m1.3.3.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E13.m1.3.3.1.1.1.2.2.3.3">0</cn></apply></apply><infinity id="A1.E13.m1.3.3.1.1.1.2.3.cmml" xref="A1.E13.m1.3.3.1.1.1.2.3"></infinity></apply><apply id="A1.E13.m1.3.3.1.1.1.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1"><times id="A1.E13.m1.3.3.1.1.1.1.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.2"></times><apply id="A1.E13.m1.3.3.1.1.1.1.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1"><ci id="A1.E13.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.2">⋅</ci><apply id="A1.E13.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1"><times id="A1.E13.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.2"></times><ci id="A1.E13.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.3">Pr</ci><apply id="A1.E13.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1"><equivalent id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1"></equivalent><apply id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2"><plus id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.1"></plus><ci id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑛</ci><cn id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.1">modulo</csymbol><ci id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><cn id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2">2</cn><cn id="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3">16</cn></apply></apply></apply></apply></apply><ci id="A1.E13.m1.3.3.1.1.1.1.1.3.cmml" xref="A1.E13.m1.3.3.1.1.1.1.1.3">pmf</ci></apply><interval closure="open" id="A1.E13.m1.3.3.1.1.1.1.3.1.cmml" xref="A1.E13.m1.3.3.1.1.1.1.3.2"><ci id="A1.E13.m1.1.1.cmml" xref="A1.E13.m1.1.1">𝑛</ci><ci id="A1.E13.m1.2.2.cmml" xref="A1.E13.m1.2.2">𝜆</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.3c">\displaystyle=\sum_{n=0}^{\infty}\mathrm{Pr}\left[n+1\equiv x\bmod 2^{16}%
\right]\cdot\mathrm{pmf}(n,\lambda),</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.3d">= ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_Pr [ italic_n + 1 ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] ⋅ roman_pmf ( italic_n , italic_λ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.SSS1.p1.13">where <math alttext="\mathrm{Pr}\left[N=n\right]=\mathrm{pmf}(n,\lambda)" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.12.m1.3"><semantics id="A1.SS2.SSS1.p1.12.m1.3a"><mrow id="A1.SS2.SSS1.p1.12.m1.3.3" xref="A1.SS2.SSS1.p1.12.m1.3.3.cmml"><mrow id="A1.SS2.SSS1.p1.12.m1.3.3.1" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.cmml"><mi id="A1.SS2.SSS1.p1.12.m1.3.3.1.3" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.3.cmml">Pr</mi><mo id="A1.SS2.SSS1.p1.12.m1.3.3.1.2" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.2.cmml"><mo id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.2" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.2.1.cmml">[</mo><mrow id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.cmml"><mi id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.2" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.2.cmml">N</mi><mo id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.1" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.1.cmml">=</mo><mi id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.3" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.3.cmml">n</mi></mrow><mo id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.3" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.SS2.SSS1.p1.12.m1.3.3.2" xref="A1.SS2.SSS1.p1.12.m1.3.3.2.cmml">=</mo><mrow id="A1.SS2.SSS1.p1.12.m1.3.3.3" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.cmml"><mi id="A1.SS2.SSS1.p1.12.m1.3.3.3.2" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.2.cmml">pmf</mi><mo id="A1.SS2.SSS1.p1.12.m1.3.3.3.1" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.1.cmml">⁢</mo><mrow id="A1.SS2.SSS1.p1.12.m1.3.3.3.3.2" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.3.1.cmml"><mo id="A1.SS2.SSS1.p1.12.m1.3.3.3.3.2.1" stretchy="false" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.3.1.cmml">(</mo><mi id="A1.SS2.SSS1.p1.12.m1.1.1" xref="A1.SS2.SSS1.p1.12.m1.1.1.cmml">n</mi><mo id="A1.SS2.SSS1.p1.12.m1.3.3.3.3.2.2" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.3.1.cmml">,</mo><mi id="A1.SS2.SSS1.p1.12.m1.2.2" xref="A1.SS2.SSS1.p1.12.m1.2.2.cmml">λ</mi><mo id="A1.SS2.SSS1.p1.12.m1.3.3.3.3.2.3" stretchy="false" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.12.m1.3b"><apply id="A1.SS2.SSS1.p1.12.m1.3.3.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3"><eq id="A1.SS2.SSS1.p1.12.m1.3.3.2.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.2"></eq><apply id="A1.SS2.SSS1.p1.12.m1.3.3.1.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1"><times id="A1.SS2.SSS1.p1.12.m1.3.3.1.2.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.2"></times><ci id="A1.SS2.SSS1.p1.12.m1.3.3.1.3.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.3">Pr</ci><apply id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.2.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1"><csymbol cd="latexml" id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.2.1.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1"><eq id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.1.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.1"></eq><ci id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.2.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.2">𝑁</ci><ci id="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.3.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="A1.SS2.SSS1.p1.12.m1.3.3.3.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.3"><times id="A1.SS2.SSS1.p1.12.m1.3.3.3.1.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.1"></times><ci id="A1.SS2.SSS1.p1.12.m1.3.3.3.2.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.2">pmf</ci><interval closure="open" id="A1.SS2.SSS1.p1.12.m1.3.3.3.3.1.cmml" xref="A1.SS2.SSS1.p1.12.m1.3.3.3.3.2"><ci id="A1.SS2.SSS1.p1.12.m1.1.1.cmml" xref="A1.SS2.SSS1.p1.12.m1.1.1">𝑛</ci><ci id="A1.SS2.SSS1.p1.12.m1.2.2.cmml" xref="A1.SS2.SSS1.p1.12.m1.2.2">𝜆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.12.m1.3c">\mathrm{Pr}\left[N=n\right]=\mathrm{pmf}(n,\lambda)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.12.m1.3d">roman_Pr [ italic_N = italic_n ] = roman_pmf ( italic_n , italic_λ )</annotation></semantics></math> follows from the fact that <math alttext="N" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.13.m2.1"><semantics id="A1.SS2.SSS1.p1.13.m2.1a"><mi id="A1.SS2.SSS1.p1.13.m2.1.1" xref="A1.SS2.SSS1.p1.13.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.13.m2.1b"><ci id="A1.SS2.SSS1.p1.13.m2.1.1.cmml" xref="A1.SS2.SSS1.p1.13.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.13.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.13.m2.1d">italic_N</annotation></semantics></math> is Poisson-distributed.
Substituting Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.Ex3" title="A.2.1. Globally Incrementing ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.2.1</span></a> into Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.E2" title="In 4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a> yields</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\left\{\sum_{x\in G}\sum_{n=0}^{\infty}\mathrm{Pr}\left[n+1\equiv x\bmod 2^{16%
}\right]\cdot\mathrm{pmf}(n,\lambda)\right\}." class="ltx_Math" display="block" id="A1.E14.m1.6"><semantics id="A1.E14.m1.6a"><mrow id="A1.E14.m1.6.6.1" xref="A1.E14.m1.6.6.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1" xref="A1.E14.m1.6.6.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1.4" xref="A1.E14.m1.6.6.1.1.4.cmml"><mi id="A1.E14.m1.6.6.1.1.4.2" xref="A1.E14.m1.6.6.1.1.4.2.cmml">Pr</mi><mo id="A1.E14.m1.6.6.1.1.4.1" xref="A1.E14.m1.6.6.1.1.4.1.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.1.1.4.3.2" xref="A1.E14.m1.6.6.1.1.4.3.1.cmml"><mo id="A1.E14.m1.6.6.1.1.4.3.2.1" xref="A1.E14.m1.6.6.1.1.4.3.1.1.cmml">[</mo><mtext id="A1.E14.m1.3.3" xref="A1.E14.m1.3.3a.cmml">adv. guess</mtext><mo id="A1.E14.m1.6.6.1.1.4.3.2.2" xref="A1.E14.m1.6.6.1.1.4.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.3" xref="A1.E14.m1.6.6.1.1.3.cmml">=</mo><mrow id="A1.E14.m1.6.6.1.1.2.2" xref="A1.E14.m1.6.6.1.1.2.3.cmml"><munder id="A1.E14.m1.6.6.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.1.1.1.cmml"><mi id="A1.E14.m1.6.6.1.1.1.1.1.2" xref="A1.E14.m1.6.6.1.1.1.1.1.2.cmml">max</mi><mrow id="A1.E14.m1.2.2.2" xref="A1.E14.m1.2.2.2.cmml"><mrow id="A1.E14.m1.2.2.2.2" xref="A1.E14.m1.2.2.2.2.cmml"><mi id="A1.E14.m1.2.2.2.2.3" xref="A1.E14.m1.2.2.2.2.3.cmml">G</mi><mo id="A1.E14.m1.2.2.2.2.2" xref="A1.E14.m1.2.2.2.2.2.cmml">⊂</mo><mrow id="A1.E14.m1.2.2.2.2.1.1" xref="A1.E14.m1.2.2.2.2.1.2.cmml"><mo id="A1.E14.m1.2.2.2.2.1.1.2" stretchy="false" xref="A1.E14.m1.2.2.2.2.1.2.1.cmml">[</mo><msup id="A1.E14.m1.2.2.2.2.1.1.1" xref="A1.E14.m1.2.2.2.2.1.1.1.cmml"><mn id="A1.E14.m1.2.2.2.2.1.1.1.2" xref="A1.E14.m1.2.2.2.2.1.1.1.2.cmml">2</mn><mn id="A1.E14.m1.2.2.2.2.1.1.1.3" xref="A1.E14.m1.2.2.2.2.1.1.1.3.cmml">16</mn></msup><mo id="A1.E14.m1.2.2.2.2.1.1.3" rspace="0.508em" stretchy="false" xref="A1.E14.m1.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E14.m1.2.2.2.3" rspace="0.508em" xref="A1.E14.m1.2.2.2.3.cmml">:</mo><mrow id="A1.E14.m1.2.2.2.4" xref="A1.E14.m1.2.2.2.4.cmml"><mrow id="A1.E14.m1.2.2.2.4.2.2" xref="A1.E14.m1.2.2.2.4.2.1.cmml"><mo id="A1.E14.m1.2.2.2.4.2.2.1" stretchy="false" xref="A1.E14.m1.2.2.2.4.2.1.1.cmml">|</mo><mi id="A1.E14.m1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.cmml">G</mi><mo id="A1.E14.m1.2.2.2.4.2.2.2" stretchy="false" xref="A1.E14.m1.2.2.2.4.2.1.1.cmml">|</mo></mrow><mo id="A1.E14.m1.2.2.2.4.1" xref="A1.E14.m1.2.2.2.4.1.cmml">=</mo><mi id="A1.E14.m1.2.2.2.4.3" xref="A1.E14.m1.2.2.2.4.3.cmml">g</mi></mrow></mrow></munder><mo id="A1.E14.m1.6.6.1.1.2.2a" xref="A1.E14.m1.6.6.1.1.2.3.cmml">⁡</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2" xref="A1.E14.m1.6.6.1.1.2.3.cmml"><mo id="A1.E14.m1.6.6.1.1.2.2.2.2" xref="A1.E14.m1.6.6.1.1.2.3.cmml">{</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.cmml"><munder id="A1.E14.m1.6.6.1.1.2.2.2.1.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.cmml"><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.2.cmml">∑</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.2.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.cmml"><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.2.cmml">x</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.1.cmml">∈</mo><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.3.cmml">G</mi></mrow></munder><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.cmml"><munderover id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.cmml"><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.2" movablelimits="false" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.cmml"><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.2.cmml">n</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.3.cmml">0</mn></mrow><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.3" mathvariant="normal" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.3.cmml">∞</mi></munderover><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.cmml"><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.3.cmml">Pr</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.2.cmml"><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml">n</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml">+</mo><mn id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></mrow><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.1.cmml">≡</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.1" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml">mod</mo><msup id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">2</mn><mn id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.2" rspace="0.222em" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.2.cmml">⋅</mo><mi id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.3" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.3.cmml">pmf</mi></mrow><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.1.cmml"><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.2.1" stretchy="false" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.1.cmml">(</mo><mi id="A1.E14.m1.4.4" xref="A1.E14.m1.4.4.cmml">n</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.2.2" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.1.cmml">,</mo><mi id="A1.E14.m1.5.5" xref="A1.E14.m1.5.5.cmml">λ</mi><mo id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.2.3" stretchy="false" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E14.m1.6.6.1.1.2.2.2.3" xref="A1.E14.m1.6.6.1.1.2.3.cmml">}</mo></mrow></mrow></mrow><mo id="A1.E14.m1.6.6.1.2" lspace="0em" xref="A1.E14.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.6b"><apply id="A1.E14.m1.6.6.1.1.cmml" xref="A1.E14.m1.6.6.1"><eq id="A1.E14.m1.6.6.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.3"></eq><apply id="A1.E14.m1.6.6.1.1.4.cmml" xref="A1.E14.m1.6.6.1.1.4"><times id="A1.E14.m1.6.6.1.1.4.1.cmml" xref="A1.E14.m1.6.6.1.1.4.1"></times><ci id="A1.E14.m1.6.6.1.1.4.2.cmml" xref="A1.E14.m1.6.6.1.1.4.2">Pr</ci><apply id="A1.E14.m1.6.6.1.1.4.3.1.cmml" xref="A1.E14.m1.6.6.1.1.4.3.2"><csymbol cd="latexml" id="A1.E14.m1.6.6.1.1.4.3.1.1.cmml" xref="A1.E14.m1.6.6.1.1.4.3.2.1">delimited-[]</csymbol><ci id="A1.E14.m1.3.3a.cmml" xref="A1.E14.m1.3.3"><mtext id="A1.E14.m1.3.3.cmml" xref="A1.E14.m1.3.3">adv. guess</mtext></ci></apply></apply><apply id="A1.E14.m1.6.6.1.1.2.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2"><apply id="A1.E14.m1.6.6.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1">subscript</csymbol><max id="A1.E14.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.1.1.1.2"></max><apply id="A1.E14.m1.2.2.2.cmml" xref="A1.E14.m1.2.2.2"><ci id="A1.E14.m1.2.2.2.3.cmml" xref="A1.E14.m1.2.2.2.3">:</ci><apply id="A1.E14.m1.2.2.2.2.cmml" xref="A1.E14.m1.2.2.2.2"><subset id="A1.E14.m1.2.2.2.2.2.cmml" xref="A1.E14.m1.2.2.2.2.2"></subset><ci id="A1.E14.m1.2.2.2.2.3.cmml" xref="A1.E14.m1.2.2.2.2.3">𝐺</ci><apply id="A1.E14.m1.2.2.2.2.1.2.cmml" xref="A1.E14.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E14.m1.2.2.2.2.1.2.1.cmml" xref="A1.E14.m1.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.E14.m1.2.2.2.2.1.1.1.cmml" xref="A1.E14.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.2.2.2.2.1.1.1.1.cmml" xref="A1.E14.m1.2.2.2.2.1.1.1">superscript</csymbol><cn id="A1.E14.m1.2.2.2.2.1.1.1.2.cmml" type="integer" xref="A1.E14.m1.2.2.2.2.1.1.1.2">2</cn><cn id="A1.E14.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="A1.E14.m1.2.2.2.2.1.1.1.3">16</cn></apply></apply></apply><apply id="A1.E14.m1.2.2.2.4.cmml" xref="A1.E14.m1.2.2.2.4"><eq id="A1.E14.m1.2.2.2.4.1.cmml" xref="A1.E14.m1.2.2.2.4.1"></eq><apply id="A1.E14.m1.2.2.2.4.2.1.cmml" xref="A1.E14.m1.2.2.2.4.2.2"><abs id="A1.E14.m1.2.2.2.4.2.1.1.cmml" xref="A1.E14.m1.2.2.2.4.2.2.1"></abs><ci id="A1.E14.m1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1">𝐺</ci></apply><ci id="A1.E14.m1.2.2.2.4.3.cmml" xref="A1.E14.m1.2.2.2.4.3">𝑔</ci></apply></apply></apply><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1"><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.2.2.2.1.2.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2">subscript</csymbol><sum id="A1.E14.m1.6.6.1.1.2.2.2.1.2.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.2"></sum><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.3"><in id="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.1"></in><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.2">𝑥</ci><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.2.3.3">𝐺</ci></apply></apply><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1"><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2">superscript</csymbol><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2">subscript</csymbol><sum id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.2"></sum><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3"><eq id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.1"></eq><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.2">𝑛</ci><cn id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.3.cmml" type="integer" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.2.3.3">0</cn></apply></apply><infinity id="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.2.3"></infinity></apply><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1"><times id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.2"></times><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1"><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.2">⋅</ci><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1"><times id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.2"></times><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.3">Pr</ci><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1"><equivalent id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.1"></equivalent><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2"><plus id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1"></plus><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2">𝑛</ci><cn id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.1">modulo</csymbol><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><cn id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.2">2</cn><cn id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.3">16</cn></apply></apply></apply></apply></apply><ci id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.3.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.1.3">pmf</ci></apply><interval closure="open" id="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.1.cmml" xref="A1.E14.m1.6.6.1.1.2.2.2.1.1.1.3.2"><ci id="A1.E14.m1.4.4.cmml" xref="A1.E14.m1.4.4">𝑛</ci><ci id="A1.E14.m1.5.5.cmml" xref="A1.E14.m1.5.5">𝜆</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.6c">\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\left\{\sum_{x\in G}\sum_{n=0}^{\infty}\mathrm{Pr}\left[n+1\equiv x\bmod 2^{16%
}\right]\cdot\mathrm{pmf}(n,\lambda)\right\}.</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.6d">roman_Pr [ adv. guess ] = roman_max start_POSTSUBSCRIPT italic_G ⊂ [ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] : | italic_G | = italic_g end_POSTSUBSCRIPT { ∑ start_POSTSUBSCRIPT italic_x ∈ italic_G end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_Pr [ italic_n + 1 ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] ⋅ roman_pmf ( italic_n , italic_λ ) } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.2. </span>Per-Connection</h4>
<div class="ltx_para" id="A1.SS2.SSS2.p1">
<p class="ltx_p" id="A1.SS2.SSS2.p1.10">Per-connection selection defines one randomly initialized counter <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.1.m1.1"><semantics id="A1.SS2.SSS2.p1.1.m1.1a"><mi id="A1.SS2.SSS2.p1.1.m1.1.1" xref="A1.SS2.SSS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.1.m1.1b"><ci id="A1.SS2.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.1.m1.1d">italic_i</annotation></semantics></math> per connection, which is specific to the IP addresses and ports of <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.2.m2.1"><semantics id="A1.SS2.SSS2.p1.2.m2.1a"><mi id="A1.SS2.SSS2.p1.2.m2.1.1" xref="A1.SS2.SSS2.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.2.m2.1b"><ci id="A1.SS2.SSS2.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS2.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.2.m2.1d">italic_S</annotation></semantics></math> and its client <math alttext="C" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.3.m3.1"><semantics id="A1.SS2.SSS2.p1.3.m3.1a"><mi id="A1.SS2.SSS2.p1.3.m3.1.1" xref="A1.SS2.SSS2.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.3.m3.1b"><ci id="A1.SS2.SSS2.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS2.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.3.m3.1d">italic_C</annotation></semantics></math>.
There are no known methods for the adversary <math alttext="A\not\in\{S,C\}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.4.m4.2"><semantics id="A1.SS2.SSS2.p1.4.m4.2a"><mrow id="A1.SS2.SSS2.p1.4.m4.2.3" xref="A1.SS2.SSS2.p1.4.m4.2.3.cmml"><mi id="A1.SS2.SSS2.p1.4.m4.2.3.2" xref="A1.SS2.SSS2.p1.4.m4.2.3.2.cmml">A</mi><mo id="A1.SS2.SSS2.p1.4.m4.2.3.1" xref="A1.SS2.SSS2.p1.4.m4.2.3.1.cmml">∉</mo><mrow id="A1.SS2.SSS2.p1.4.m4.2.3.3.2" xref="A1.SS2.SSS2.p1.4.m4.2.3.3.1.cmml"><mo id="A1.SS2.SSS2.p1.4.m4.2.3.3.2.1" stretchy="false" xref="A1.SS2.SSS2.p1.4.m4.2.3.3.1.cmml">{</mo><mi id="A1.SS2.SSS2.p1.4.m4.1.1" xref="A1.SS2.SSS2.p1.4.m4.1.1.cmml">S</mi><mo id="A1.SS2.SSS2.p1.4.m4.2.3.3.2.2" xref="A1.SS2.SSS2.p1.4.m4.2.3.3.1.cmml">,</mo><mi id="A1.SS2.SSS2.p1.4.m4.2.2" xref="A1.SS2.SSS2.p1.4.m4.2.2.cmml">C</mi><mo id="A1.SS2.SSS2.p1.4.m4.2.3.3.2.3" stretchy="false" xref="A1.SS2.SSS2.p1.4.m4.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.4.m4.2b"><apply id="A1.SS2.SSS2.p1.4.m4.2.3.cmml" xref="A1.SS2.SSS2.p1.4.m4.2.3"><notin id="A1.SS2.SSS2.p1.4.m4.2.3.1.cmml" xref="A1.SS2.SSS2.p1.4.m4.2.3.1"></notin><ci id="A1.SS2.SSS2.p1.4.m4.2.3.2.cmml" xref="A1.SS2.SSS2.p1.4.m4.2.3.2">𝐴</ci><set id="A1.SS2.SSS2.p1.4.m4.2.3.3.1.cmml" xref="A1.SS2.SSS2.p1.4.m4.2.3.3.2"><ci id="A1.SS2.SSS2.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS2.p1.4.m4.1.1">𝑆</ci><ci id="A1.SS2.SSS2.p1.4.m4.2.2.cmml" xref="A1.SS2.SSS2.p1.4.m4.2.2">𝐶</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.4.m4.2c">A\not\in\{S,C\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.4.m4.2d">italic_A ∉ { italic_S , italic_C }</annotation></semantics></math> to obtain any information about the connection counter <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.5.m5.1"><semantics id="A1.SS2.SSS2.p1.5.m5.1a"><mi id="A1.SS2.SSS2.p1.5.m5.1.1" xref="A1.SS2.SSS2.p1.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.5.m5.1b"><ci id="A1.SS2.SSS2.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS2.p1.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.5.m5.1d">italic_S</annotation></semantics></math> uses to assign IPIDs to packets sent to <math alttext="C" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.6.m6.1"><semantics id="A1.SS2.SSS2.p1.6.m6.1a"><mi id="A1.SS2.SSS2.p1.6.m6.1.1" xref="A1.SS2.SSS2.p1.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.6.m6.1b"><ci id="A1.SS2.SSS2.p1.6.m6.1.1.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.6.m6.1c">C</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.6.m6.1d">italic_C</annotation></semantics></math>.
Thus, regardless of the rate <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.7.m7.1"><semantics id="A1.SS2.SSS2.p1.7.m7.1a"><msub id="A1.SS2.SSS2.p1.7.m7.1.1" xref="A1.SS2.SSS2.p1.7.m7.1.1.cmml"><mi id="A1.SS2.SSS2.p1.7.m7.1.1.2" xref="A1.SS2.SSS2.p1.7.m7.1.1.2.cmml">λ</mi><mi id="A1.SS2.SSS2.p1.7.m7.1.1.3" xref="A1.SS2.SSS2.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.7.m7.1b"><apply id="A1.SS2.SSS2.p1.7.m7.1.1.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.1">subscript</csymbol><ci id="A1.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.1.2">𝜆</ci><ci id="A1.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.7.m7.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.7.m7.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, adversary <math alttext="A" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.8.m8.1"><semantics id="A1.SS2.SSS2.p1.8.m8.1a"><mi id="A1.SS2.SSS2.p1.8.m8.1.1" xref="A1.SS2.SSS2.p1.8.m8.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.8.m8.1b"><ci id="A1.SS2.SSS2.p1.8.m8.1.1.cmml" xref="A1.SS2.SSS2.p1.8.m8.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.8.m8.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.8.m8.1d">italic_A</annotation></semantics></math> can do no better than make <math alttext="g" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.9.m9.1"><semantics id="A1.SS2.SSS2.p1.9.m9.1a"><mi id="A1.SS2.SSS2.p1.9.m9.1.1" xref="A1.SS2.SSS2.p1.9.m9.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.9.m9.1b"><ci id="A1.SS2.SSS2.p1.9.m9.1.1.cmml" xref="A1.SS2.SSS2.p1.9.m9.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.9.m9.1c">g</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.9.m9.1d">italic_g</annotation></semantics></math> distinct guesses uniformly at random over all <math alttext="2^{16}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.10.m10.1"><semantics id="A1.SS2.SSS2.p1.10.m10.1a"><msup id="A1.SS2.SSS2.p1.10.m10.1.1" xref="A1.SS2.SSS2.p1.10.m10.1.1.cmml"><mn id="A1.SS2.SSS2.p1.10.m10.1.1.2" xref="A1.SS2.SSS2.p1.10.m10.1.1.2.cmml">2</mn><mn id="A1.SS2.SSS2.p1.10.m10.1.1.3" xref="A1.SS2.SSS2.p1.10.m10.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.10.m10.1b"><apply id="A1.SS2.SSS2.p1.10.m10.1.1.cmml" xref="A1.SS2.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.10.m10.1.1.1.cmml" xref="A1.SS2.SSS2.p1.10.m10.1.1">superscript</csymbol><cn id="A1.SS2.SSS2.p1.10.m10.1.1.2.cmml" type="integer" xref="A1.SS2.SSS2.p1.10.m10.1.1.2">2</cn><cn id="A1.SS2.SSS2.p1.10.m10.1.1.3.cmml" type="integer" xref="A1.SS2.SSS2.p1.10.m10.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.10.m10.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.10.m10.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> possible IPIDs:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\left\{\sum_{x\in G}\mathrm{Pr}\left[\text{next IPID}=x\right]\right\}=\max_{G%
\subset[2^{16}]~{}:~{}|G|=g}\left\{\sum_{x\in G}\frac{1}{2^{16}}\right\}=\frac%
{g}{2^{16}}." class="ltx_Math" display="block" id="A1.E15.m1.6"><semantics id="A1.E15.m1.6a"><mrow id="A1.E15.m1.6.6.1" xref="A1.E15.m1.6.6.1.1.cmml"><mrow id="A1.E15.m1.6.6.1.1" xref="A1.E15.m1.6.6.1.1.cmml"><mrow id="A1.E15.m1.6.6.1.1.6" xref="A1.E15.m1.6.6.1.1.6.cmml"><mi id="A1.E15.m1.6.6.1.1.6.2" xref="A1.E15.m1.6.6.1.1.6.2.cmml">Pr</mi><mo id="A1.E15.m1.6.6.1.1.6.1" xref="A1.E15.m1.6.6.1.1.6.1.cmml">⁢</mo><mrow id="A1.E15.m1.6.6.1.1.6.3.2" xref="A1.E15.m1.6.6.1.1.6.3.1.cmml"><mo id="A1.E15.m1.6.6.1.1.6.3.2.1" xref="A1.E15.m1.6.6.1.1.6.3.1.1.cmml">[</mo><mtext id="A1.E15.m1.5.5" xref="A1.E15.m1.5.5a.cmml">adv. guess</mtext><mo id="A1.E15.m1.6.6.1.1.6.3.2.2" xref="A1.E15.m1.6.6.1.1.6.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E15.m1.6.6.1.1.7" xref="A1.E15.m1.6.6.1.1.7.cmml">=</mo><mrow id="A1.E15.m1.6.6.1.1.2.2" xref="A1.E15.m1.6.6.1.1.2.3.cmml"><munder id="A1.E15.m1.6.6.1.1.1.1.1" xref="A1.E15.m1.6.6.1.1.1.1.1.cmml"><mi id="A1.E15.m1.6.6.1.1.1.1.1.2" xref="A1.E15.m1.6.6.1.1.1.1.1.2.cmml">max</mi><mrow id="A1.E15.m1.2.2.2" xref="A1.E15.m1.2.2.2.cmml"><mrow id="A1.E15.m1.2.2.2.2" xref="A1.E15.m1.2.2.2.2.cmml"><mi id="A1.E15.m1.2.2.2.2.3" xref="A1.E15.m1.2.2.2.2.3.cmml">G</mi><mo id="A1.E15.m1.2.2.2.2.2" xref="A1.E15.m1.2.2.2.2.2.cmml">⊂</mo><mrow id="A1.E15.m1.2.2.2.2.1.1" xref="A1.E15.m1.2.2.2.2.1.2.cmml"><mo id="A1.E15.m1.2.2.2.2.1.1.2" stretchy="false" xref="A1.E15.m1.2.2.2.2.1.2.1.cmml">[</mo><msup id="A1.E15.m1.2.2.2.2.1.1.1" xref="A1.E15.m1.2.2.2.2.1.1.1.cmml"><mn id="A1.E15.m1.2.2.2.2.1.1.1.2" xref="A1.E15.m1.2.2.2.2.1.1.1.2.cmml">2</mn><mn id="A1.E15.m1.2.2.2.2.1.1.1.3" xref="A1.E15.m1.2.2.2.2.1.1.1.3.cmml">16</mn></msup><mo id="A1.E15.m1.2.2.2.2.1.1.3" rspace="0.508em" stretchy="false" xref="A1.E15.m1.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E15.m1.2.2.2.3" rspace="0.508em" xref="A1.E15.m1.2.2.2.3.cmml">:</mo><mrow id="A1.E15.m1.2.2.2.4" xref="A1.E15.m1.2.2.2.4.cmml"><mrow id="A1.E15.m1.2.2.2.4.2.2" xref="A1.E15.m1.2.2.2.4.2.1.cmml"><mo id="A1.E15.m1.2.2.2.4.2.2.1" stretchy="false" xref="A1.E15.m1.2.2.2.4.2.1.1.cmml">|</mo><mi id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml">G</mi><mo id="A1.E15.m1.2.2.2.4.2.2.2" stretchy="false" xref="A1.E15.m1.2.2.2.4.2.1.1.cmml">|</mo></mrow><mo id="A1.E15.m1.2.2.2.4.1" xref="A1.E15.m1.2.2.2.4.1.cmml">=</mo><mi id="A1.E15.m1.2.2.2.4.3" xref="A1.E15.m1.2.2.2.4.3.cmml">g</mi></mrow></mrow></munder><mo id="A1.E15.m1.6.6.1.1.2.2a" xref="A1.E15.m1.6.6.1.1.2.3.cmml">⁡</mo><mrow id="A1.E15.m1.6.6.1.1.2.2.2" xref="A1.E15.m1.6.6.1.1.2.3.cmml"><mo id="A1.E15.m1.6.6.1.1.2.2.2.2" xref="A1.E15.m1.6.6.1.1.2.3.cmml">{</mo><mrow id="A1.E15.m1.6.6.1.1.2.2.2.1" xref="A1.E15.m1.6.6.1.1.2.2.2.1.cmml"><munder id="A1.E15.m1.6.6.1.1.2.2.2.1.2" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.cmml"><mo id="A1.E15.m1.6.6.1.1.2.2.2.1.2.2" lspace="0em" movablelimits="false" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.2.cmml">∑</mo><mrow id="A1.E15.m1.6.6.1.1.2.2.2.1.2.3" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.cmml"><mi id="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.2" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.2.cmml">x</mi><mo id="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.1" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.1.cmml">∈</mo><mi id="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.3" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.3.cmml">G</mi></mrow></munder><mrow id="A1.E15.m1.6.6.1.1.2.2.2.1.1" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.cmml"><mi id="A1.E15.m1.6.6.1.1.2.2.2.1.1.3" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.3.cmml">Pr</mi><mo id="A1.E15.m1.6.6.1.1.2.2.2.1.1.2" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.2.cmml">⁢</mo><mrow id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.2.cmml"><mo id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.2" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.2.1.cmml">[</mo><mrow id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.cmml"><mtext id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.2" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.2a.cmml">next IPID</mtext><mo id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.1" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.cmml">=</mo><mi id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.3" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.3" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E15.m1.6.6.1.1.2.2.2.3" xref="A1.E15.m1.6.6.1.1.2.3.cmml">}</mo></mrow></mrow><mo id="A1.E15.m1.6.6.1.1.8" xref="A1.E15.m1.6.6.1.1.8.cmml">=</mo><mrow id="A1.E15.m1.6.6.1.1.4.2" xref="A1.E15.m1.6.6.1.1.4.3.cmml"><munder id="A1.E15.m1.6.6.1.1.3.1.1" xref="A1.E15.m1.6.6.1.1.3.1.1.cmml"><mi id="A1.E15.m1.6.6.1.1.3.1.1.2" xref="A1.E15.m1.6.6.1.1.3.1.1.2.cmml">max</mi><mrow id="A1.E15.m1.4.4.2" xref="A1.E15.m1.4.4.2.cmml"><mrow id="A1.E15.m1.4.4.2.2" xref="A1.E15.m1.4.4.2.2.cmml"><mi id="A1.E15.m1.4.4.2.2.3" xref="A1.E15.m1.4.4.2.2.3.cmml">G</mi><mo id="A1.E15.m1.4.4.2.2.2" xref="A1.E15.m1.4.4.2.2.2.cmml">⊂</mo><mrow id="A1.E15.m1.4.4.2.2.1.1" xref="A1.E15.m1.4.4.2.2.1.2.cmml"><mo id="A1.E15.m1.4.4.2.2.1.1.2" stretchy="false" xref="A1.E15.m1.4.4.2.2.1.2.1.cmml">[</mo><msup id="A1.E15.m1.4.4.2.2.1.1.1" xref="A1.E15.m1.4.4.2.2.1.1.1.cmml"><mn id="A1.E15.m1.4.4.2.2.1.1.1.2" xref="A1.E15.m1.4.4.2.2.1.1.1.2.cmml">2</mn><mn id="A1.E15.m1.4.4.2.2.1.1.1.3" xref="A1.E15.m1.4.4.2.2.1.1.1.3.cmml">16</mn></msup><mo id="A1.E15.m1.4.4.2.2.1.1.3" rspace="0.508em" stretchy="false" xref="A1.E15.m1.4.4.2.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E15.m1.4.4.2.3" rspace="0.508em" xref="A1.E15.m1.4.4.2.3.cmml">:</mo><mrow id="A1.E15.m1.4.4.2.4" xref="A1.E15.m1.4.4.2.4.cmml"><mrow id="A1.E15.m1.4.4.2.4.2.2" xref="A1.E15.m1.4.4.2.4.2.1.cmml"><mo id="A1.E15.m1.4.4.2.4.2.2.1" stretchy="false" xref="A1.E15.m1.4.4.2.4.2.1.1.cmml">|</mo><mi id="A1.E15.m1.3.3.1.1" xref="A1.E15.m1.3.3.1.1.cmml">G</mi><mo id="A1.E15.m1.4.4.2.4.2.2.2" stretchy="false" xref="A1.E15.m1.4.4.2.4.2.1.1.cmml">|</mo></mrow><mo id="A1.E15.m1.4.4.2.4.1" xref="A1.E15.m1.4.4.2.4.1.cmml">=</mo><mi id="A1.E15.m1.4.4.2.4.3" xref="A1.E15.m1.4.4.2.4.3.cmml">g</mi></mrow></mrow></munder><mo id="A1.E15.m1.6.6.1.1.4.2a" xref="A1.E15.m1.6.6.1.1.4.3.cmml">⁡</mo><mrow id="A1.E15.m1.6.6.1.1.4.2.2" xref="A1.E15.m1.6.6.1.1.4.3.cmml"><mo id="A1.E15.m1.6.6.1.1.4.2.2.2" xref="A1.E15.m1.6.6.1.1.4.3.cmml">{</mo><mrow id="A1.E15.m1.6.6.1.1.4.2.2.1" xref="A1.E15.m1.6.6.1.1.4.2.2.1.cmml"><munder id="A1.E15.m1.6.6.1.1.4.2.2.1.1" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.cmml"><mo id="A1.E15.m1.6.6.1.1.4.2.2.1.1.2" lspace="0em" movablelimits="false" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.2.cmml">∑</mo><mrow id="A1.E15.m1.6.6.1.1.4.2.2.1.1.3" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.cmml"><mi id="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.2" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.2.cmml">x</mi><mo id="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.1" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.1.cmml">∈</mo><mi id="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.3" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.3.cmml">G</mi></mrow></munder><mfrac id="A1.E15.m1.6.6.1.1.4.2.2.1.2" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.cmml"><mn id="A1.E15.m1.6.6.1.1.4.2.2.1.2.2" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.2.cmml">1</mn><msup id="A1.E15.m1.6.6.1.1.4.2.2.1.2.3" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.cmml"><mn id="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.2" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.2.cmml">2</mn><mn id="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.3" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.3.cmml">16</mn></msup></mfrac></mrow><mo id="A1.E15.m1.6.6.1.1.4.2.2.3" xref="A1.E15.m1.6.6.1.1.4.3.cmml">}</mo></mrow></mrow><mo id="A1.E15.m1.6.6.1.1.9" xref="A1.E15.m1.6.6.1.1.9.cmml">=</mo><mfrac id="A1.E15.m1.6.6.1.1.10" xref="A1.E15.m1.6.6.1.1.10.cmml"><mi id="A1.E15.m1.6.6.1.1.10.2" xref="A1.E15.m1.6.6.1.1.10.2.cmml">g</mi><msup id="A1.E15.m1.6.6.1.1.10.3" xref="A1.E15.m1.6.6.1.1.10.3.cmml"><mn id="A1.E15.m1.6.6.1.1.10.3.2" xref="A1.E15.m1.6.6.1.1.10.3.2.cmml">2</mn><mn id="A1.E15.m1.6.6.1.1.10.3.3" xref="A1.E15.m1.6.6.1.1.10.3.3.cmml">16</mn></msup></mfrac></mrow><mo id="A1.E15.m1.6.6.1.2" lspace="0em" xref="A1.E15.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.6b"><apply id="A1.E15.m1.6.6.1.1.cmml" xref="A1.E15.m1.6.6.1"><and id="A1.E15.m1.6.6.1.1a.cmml" xref="A1.E15.m1.6.6.1"></and><apply id="A1.E15.m1.6.6.1.1b.cmml" xref="A1.E15.m1.6.6.1"><eq id="A1.E15.m1.6.6.1.1.7.cmml" xref="A1.E15.m1.6.6.1.1.7"></eq><apply id="A1.E15.m1.6.6.1.1.6.cmml" xref="A1.E15.m1.6.6.1.1.6"><times id="A1.E15.m1.6.6.1.1.6.1.cmml" xref="A1.E15.m1.6.6.1.1.6.1"></times><ci id="A1.E15.m1.6.6.1.1.6.2.cmml" xref="A1.E15.m1.6.6.1.1.6.2">Pr</ci><apply id="A1.E15.m1.6.6.1.1.6.3.1.cmml" xref="A1.E15.m1.6.6.1.1.6.3.2"><csymbol cd="latexml" id="A1.E15.m1.6.6.1.1.6.3.1.1.cmml" xref="A1.E15.m1.6.6.1.1.6.3.2.1">delimited-[]</csymbol><ci id="A1.E15.m1.5.5a.cmml" xref="A1.E15.m1.5.5"><mtext id="A1.E15.m1.5.5.cmml" xref="A1.E15.m1.5.5">adv. guess</mtext></ci></apply></apply><apply id="A1.E15.m1.6.6.1.1.2.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2"><apply id="A1.E15.m1.6.6.1.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1">subscript</csymbol><max id="A1.E15.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.1.1.1.2"></max><apply id="A1.E15.m1.2.2.2.cmml" xref="A1.E15.m1.2.2.2"><ci id="A1.E15.m1.2.2.2.3.cmml" xref="A1.E15.m1.2.2.2.3">:</ci><apply id="A1.E15.m1.2.2.2.2.cmml" xref="A1.E15.m1.2.2.2.2"><subset id="A1.E15.m1.2.2.2.2.2.cmml" xref="A1.E15.m1.2.2.2.2.2"></subset><ci id="A1.E15.m1.2.2.2.2.3.cmml" xref="A1.E15.m1.2.2.2.2.3">𝐺</ci><apply id="A1.E15.m1.2.2.2.2.1.2.cmml" xref="A1.E15.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E15.m1.2.2.2.2.1.2.1.cmml" xref="A1.E15.m1.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.E15.m1.2.2.2.2.1.1.1.cmml" xref="A1.E15.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.2.2.2.2.1.1.1.1.cmml" xref="A1.E15.m1.2.2.2.2.1.1.1">superscript</csymbol><cn id="A1.E15.m1.2.2.2.2.1.1.1.2.cmml" type="integer" xref="A1.E15.m1.2.2.2.2.1.1.1.2">2</cn><cn id="A1.E15.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="A1.E15.m1.2.2.2.2.1.1.1.3">16</cn></apply></apply></apply><apply id="A1.E15.m1.2.2.2.4.cmml" xref="A1.E15.m1.2.2.2.4"><eq id="A1.E15.m1.2.2.2.4.1.cmml" xref="A1.E15.m1.2.2.2.4.1"></eq><apply id="A1.E15.m1.2.2.2.4.2.1.cmml" xref="A1.E15.m1.2.2.2.4.2.2"><abs id="A1.E15.m1.2.2.2.4.2.1.1.cmml" xref="A1.E15.m1.2.2.2.4.2.2.1"></abs><ci id="A1.E15.m1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1">𝐺</ci></apply><ci id="A1.E15.m1.2.2.2.4.3.cmml" xref="A1.E15.m1.2.2.2.4.3">𝑔</ci></apply></apply></apply><apply id="A1.E15.m1.6.6.1.1.2.2.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1"><apply id="A1.E15.m1.6.6.1.1.2.2.2.1.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.2.2.2.1.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2">subscript</csymbol><sum id="A1.E15.m1.6.6.1.1.2.2.2.1.2.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.2"></sum><apply id="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.3"><in id="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.1"></in><ci id="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.2">𝑥</ci><ci id="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.2.3.3">𝐺</ci></apply></apply><apply id="A1.E15.m1.6.6.1.1.2.2.2.1.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1"><times id="A1.E15.m1.6.6.1.1.2.2.2.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.2"></times><ci id="A1.E15.m1.6.6.1.1.2.2.2.1.1.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.3">Pr</ci><apply id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1"><csymbol cd="latexml" id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.2.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1"><eq id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.1"></eq><ci id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.2a.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.2"><mtext id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.2">next IPID</mtext></ci><ci id="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.3.cmml" xref="A1.E15.m1.6.6.1.1.2.2.2.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E15.m1.6.6.1.1c.cmml" xref="A1.E15.m1.6.6.1"><eq id="A1.E15.m1.6.6.1.1.8.cmml" xref="A1.E15.m1.6.6.1.1.8"></eq><share href="https://arxiv.org/html/2406.06483v2#A1.E15.m1.6.6.1.1.2.cmml" id="A1.E15.m1.6.6.1.1d.cmml" xref="A1.E15.m1.6.6.1"></share><apply id="A1.E15.m1.6.6.1.1.4.3.cmml" xref="A1.E15.m1.6.6.1.1.4.2"><apply id="A1.E15.m1.6.6.1.1.3.1.1.cmml" xref="A1.E15.m1.6.6.1.1.3.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.3.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.3.1.1">subscript</csymbol><max id="A1.E15.m1.6.6.1.1.3.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.3.1.1.2"></max><apply id="A1.E15.m1.4.4.2.cmml" xref="A1.E15.m1.4.4.2"><ci id="A1.E15.m1.4.4.2.3.cmml" xref="A1.E15.m1.4.4.2.3">:</ci><apply id="A1.E15.m1.4.4.2.2.cmml" xref="A1.E15.m1.4.4.2.2"><subset id="A1.E15.m1.4.4.2.2.2.cmml" xref="A1.E15.m1.4.4.2.2.2"></subset><ci id="A1.E15.m1.4.4.2.2.3.cmml" xref="A1.E15.m1.4.4.2.2.3">𝐺</ci><apply id="A1.E15.m1.4.4.2.2.1.2.cmml" xref="A1.E15.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="A1.E15.m1.4.4.2.2.1.2.1.cmml" xref="A1.E15.m1.4.4.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.E15.m1.4.4.2.2.1.1.1.cmml" xref="A1.E15.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.4.4.2.2.1.1.1.1.cmml" xref="A1.E15.m1.4.4.2.2.1.1.1">superscript</csymbol><cn id="A1.E15.m1.4.4.2.2.1.1.1.2.cmml" type="integer" xref="A1.E15.m1.4.4.2.2.1.1.1.2">2</cn><cn id="A1.E15.m1.4.4.2.2.1.1.1.3.cmml" type="integer" xref="A1.E15.m1.4.4.2.2.1.1.1.3">16</cn></apply></apply></apply><apply id="A1.E15.m1.4.4.2.4.cmml" xref="A1.E15.m1.4.4.2.4"><eq id="A1.E15.m1.4.4.2.4.1.cmml" xref="A1.E15.m1.4.4.2.4.1"></eq><apply id="A1.E15.m1.4.4.2.4.2.1.cmml" xref="A1.E15.m1.4.4.2.4.2.2"><abs id="A1.E15.m1.4.4.2.4.2.1.1.cmml" xref="A1.E15.m1.4.4.2.4.2.2.1"></abs><ci id="A1.E15.m1.3.3.1.1.cmml" xref="A1.E15.m1.3.3.1.1">𝐺</ci></apply><ci id="A1.E15.m1.4.4.2.4.3.cmml" xref="A1.E15.m1.4.4.2.4.3">𝑔</ci></apply></apply></apply><apply id="A1.E15.m1.6.6.1.1.4.2.2.1.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1"><apply id="A1.E15.m1.6.6.1.1.4.2.2.1.1.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.4.2.2.1.1.1.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1">subscript</csymbol><sum id="A1.E15.m1.6.6.1.1.4.2.2.1.1.2.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.2"></sum><apply id="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.3"><in id="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.1.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.1"></in><ci id="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.2.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.2">𝑥</ci><ci id="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.3.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.1.3.3">𝐺</ci></apply></apply><apply id="A1.E15.m1.6.6.1.1.4.2.2.1.2.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2"><divide id="A1.E15.m1.6.6.1.1.4.2.2.1.2.1.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2"></divide><cn id="A1.E15.m1.6.6.1.1.4.2.2.1.2.2.cmml" type="integer" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.2">1</cn><apply id="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.3"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.1.cmml" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.3">superscript</csymbol><cn id="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.2.cmml" type="integer" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.2">2</cn><cn id="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.3.cmml" type="integer" xref="A1.E15.m1.6.6.1.1.4.2.2.1.2.3.3">16</cn></apply></apply></apply></apply></apply><apply id="A1.E15.m1.6.6.1.1e.cmml" xref="A1.E15.m1.6.6.1"><eq id="A1.E15.m1.6.6.1.1.9.cmml" xref="A1.E15.m1.6.6.1.1.9"></eq><share href="https://arxiv.org/html/2406.06483v2#A1.E15.m1.6.6.1.1.4.cmml" id="A1.E15.m1.6.6.1.1f.cmml" xref="A1.E15.m1.6.6.1"></share><apply id="A1.E15.m1.6.6.1.1.10.cmml" xref="A1.E15.m1.6.6.1.1.10"><divide id="A1.E15.m1.6.6.1.1.10.1.cmml" xref="A1.E15.m1.6.6.1.1.10"></divide><ci id="A1.E15.m1.6.6.1.1.10.2.cmml" xref="A1.E15.m1.6.6.1.1.10.2">𝑔</ci><apply id="A1.E15.m1.6.6.1.1.10.3.cmml" xref="A1.E15.m1.6.6.1.1.10.3"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.1.1.10.3.1.cmml" xref="A1.E15.m1.6.6.1.1.10.3">superscript</csymbol><cn id="A1.E15.m1.6.6.1.1.10.3.2.cmml" type="integer" xref="A1.E15.m1.6.6.1.1.10.3.2">2</cn><cn id="A1.E15.m1.6.6.1.1.10.3.3.cmml" type="integer" xref="A1.E15.m1.6.6.1.1.10.3.3">16</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.6c">\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\left\{\sum_{x\in G}\mathrm{Pr}\left[\text{next IPID}=x\right]\right\}=\max_{G%
\subset[2^{16}]~{}:~{}|G|=g}\left\{\sum_{x\in G}\frac{1}{2^{16}}\right\}=\frac%
{g}{2^{16}}.</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.6d">roman_Pr [ adv. guess ] = roman_max start_POSTSUBSCRIPT italic_G ⊂ [ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] : | italic_G | = italic_g end_POSTSUBSCRIPT { ∑ start_POSTSUBSCRIPT italic_x ∈ italic_G end_POSTSUBSCRIPT roman_Pr [ next IPID = italic_x ] } = roman_max start_POSTSUBSCRIPT italic_G ⊂ [ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] : | italic_G | = italic_g end_POSTSUBSCRIPT { ∑ start_POSTSUBSCRIPT italic_x ∈ italic_G end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT end_ARG } = divide start_ARG italic_g end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.SSS2.p2">
<p class="ltx_p" id="A1.SS2.SSS2.p2.4">Recall from Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS6" title="3.1.6. TCP Injection Attacks ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.6</span></a> that downgrade attacks can force <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.1.m1.1"><semantics id="A1.SS2.SSS2.p2.1.m1.1a"><mi id="A1.SS2.SSS2.p2.1.m1.1.1" xref="A1.SS2.SSS2.p2.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.1.m1.1b"><ci id="A1.SS2.SSS2.p2.1.m1.1.1.cmml" xref="A1.SS2.SSS2.p2.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.1.m1.1d">italic_S</annotation></semantics></math> to use some selection method other than per-connection if one exists <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib21" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib22" title="">2022</a>)</cite>.
In this case, the probability of an adversarial guess reduces to that of the downgraded selection method.
Alternatively, if some future method enables <math alttext="A" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.2.m2.1"><semantics id="A1.SS2.SSS2.p2.2.m2.1a"><mi id="A1.SS2.SSS2.p2.2.m2.1.1" xref="A1.SS2.SSS2.p2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.2.m2.1b"><ci id="A1.SS2.SSS2.p2.2.m2.1.1.cmml" xref="A1.SS2.SSS2.p2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.2.m2.1d">italic_A</annotation></semantics></math> to probe connection counters, the probability of an adversarial guess reduces to that of globally incrementing selection (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E14" title="In A.2.1. Globally Incrementing ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">14</span></a>), but with <math alttext="\lambda" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.3.m3.1"><semantics id="A1.SS2.SSS2.p2.3.m3.1a"><mi id="A1.SS2.SSS2.p2.3.m3.1.1" xref="A1.SS2.SSS2.p2.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.3.m3.1b"><ci id="A1.SS2.SSS2.p2.3.m3.1.1.cmml" xref="A1.SS2.SSS2.p2.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.3.m3.1d">italic_λ</annotation></semantics></math> replaced by <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.4.m4.1"><semantics id="A1.SS2.SSS2.p2.4.m4.1a"><msub id="A1.SS2.SSS2.p2.4.m4.1.1" xref="A1.SS2.SSS2.p2.4.m4.1.1.cmml"><mi id="A1.SS2.SSS2.p2.4.m4.1.1.2" xref="A1.SS2.SSS2.p2.4.m4.1.1.2.cmml">λ</mi><mi id="A1.SS2.SSS2.p2.4.m4.1.1.3" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.4.m4.1b"><apply id="A1.SS2.SSS2.p2.4.m4.1.1.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.2">𝜆</ci><ci id="A1.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.4.m4.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.4.m4.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.3. </span>Per-Destination</h4>
<div class="ltx_para" id="A1.SS2.SSS3.p1">
<p class="ltx_p" id="A1.SS2.SSS3.p1.5">Per-destination selection uses one counter <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p1.1.m1.1"><semantics id="A1.SS2.SSS3.p1.1.m1.1a"><mi id="A1.SS2.SSS3.p1.1.m1.1.1" xref="A1.SS2.SSS3.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p1.1.m1.1b"><ci id="A1.SS2.SSS3.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS3.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p1.1.m1.1d">italic_i</annotation></semantics></math> per destination IP address and protocol number.
As we reviewed in Sections <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS1.SSS4" title="3.1.4. Canary Fragments ‣ 3.1. Probe Comparisons ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.1.4</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2.SSS1" title="3.2.1. DNS Attacks ‣ 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S3.SS2.SSS2" title="3.2.2. NAT Packet Interception ‣ 3.2. Fragment Injections ‣ 3. Measurements and Attacks ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">3.2.2</span></a>, there <span class="ltx_ERROR undefined" id="A1.SS2.SSS3.p1.5.1">\replaced</span>have been many successfulare several established methods for probing destination counters <cite class="ltx_cite ltx_citemacro_citep">(Gilad and Herzberg, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib23" title="">2011</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib25" title="">2013</a>; Herzberg and Shulman, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib28" title="">2013a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib29" title="">b</a>; Knockel and Crandall, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib39" title="">2014</a>)</cite>, <span class="ltx_ERROR undefined" id="A1.SS2.SSS3.p1.5.2">\added</span>each specific to a particular OS implementation that was patched after disclosure.
<span class="ltx_ERROR undefined" id="A1.SS2.SSS3.p1.5.3">\added</span>For the purposes of this analysis, we assume the adversary can probe destination counters, focusing on the fundamental security of per-destination selection over the difficulty of accessing its counters.
The adversary can then use this information just as it did for globally incrementing selection to make inferences about the sequentially incrementing counter, so Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E14" title="In A.2.1. Globally Incrementing ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">14</span></a>—after replacing <math alttext="\lambda" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p1.2.m2.1"><semantics id="A1.SS2.SSS3.p1.2.m2.1a"><mi id="A1.SS2.SSS3.p1.2.m2.1.1" xref="A1.SS2.SSS3.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p1.2.m2.1b"><ci id="A1.SS2.SSS3.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS3.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p1.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p1.2.m2.1d">italic_λ</annotation></semantics></math> with <math alttext="\lambda_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p1.3.m3.1"><semantics id="A1.SS2.SSS3.p1.3.m3.1a"><msub id="A1.SS2.SSS3.p1.3.m3.1.1" xref="A1.SS2.SSS3.p1.3.m3.1.1.cmml"><mi id="A1.SS2.SSS3.p1.3.m3.1.1.2" xref="A1.SS2.SSS3.p1.3.m3.1.1.2.cmml">λ</mi><mi id="A1.SS2.SSS3.p1.3.m3.1.1.3" xref="A1.SS2.SSS3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p1.3.m3.1b"><apply id="A1.SS2.SSS3.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="A1.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="A1.SS2.SSS3.p1.3.m3.1.1.2">𝜆</ci><ci id="A1.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="A1.SS2.SSS3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p1.3.m3.1c">\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p1.3.m3.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>—also describes the probability of an adversarial guess for per-destination selection.
<span class="ltx_ERROR undefined" id="A1.SS2.SSS3.p1.5.4">\added</span>In Figs. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.F7" title="Figure 7 ‣ 4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.F10" title="Figure 10 ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">10</span></a>, we plot per-destination’s adversarial guess probabilities for <math alttext="r=2^{12}" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p1.4.m4.1"><semantics id="A1.SS2.SSS3.p1.4.m4.1a"><mrow id="A1.SS2.SSS3.p1.4.m4.1.1" xref="A1.SS2.SSS3.p1.4.m4.1.1.cmml"><mi id="A1.SS2.SSS3.p1.4.m4.1.1.2" xref="A1.SS2.SSS3.p1.4.m4.1.1.2.cmml">r</mi><mo id="A1.SS2.SSS3.p1.4.m4.1.1.1" xref="A1.SS2.SSS3.p1.4.m4.1.1.1.cmml">=</mo><msup id="A1.SS2.SSS3.p1.4.m4.1.1.3" xref="A1.SS2.SSS3.p1.4.m4.1.1.3.cmml"><mn id="A1.SS2.SSS3.p1.4.m4.1.1.3.2" xref="A1.SS2.SSS3.p1.4.m4.1.1.3.2.cmml">2</mn><mn id="A1.SS2.SSS3.p1.4.m4.1.1.3.3" xref="A1.SS2.SSS3.p1.4.m4.1.1.3.3.cmml">12</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p1.4.m4.1b"><apply id="A1.SS2.SSS3.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS3.p1.4.m4.1.1"><eq id="A1.SS2.SSS3.p1.4.m4.1.1.1.cmml" xref="A1.SS2.SSS3.p1.4.m4.1.1.1"></eq><ci id="A1.SS2.SSS3.p1.4.m4.1.1.2.cmml" xref="A1.SS2.SSS3.p1.4.m4.1.1.2">𝑟</ci><apply id="A1.SS2.SSS3.p1.4.m4.1.1.3.cmml" xref="A1.SS2.SSS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p1.4.m4.1.1.3.1.cmml" xref="A1.SS2.SSS3.p1.4.m4.1.1.3">superscript</csymbol><cn id="A1.SS2.SSS3.p1.4.m4.1.1.3.2.cmml" type="integer" xref="A1.SS2.SSS3.p1.4.m4.1.1.3.2">2</cn><cn id="A1.SS2.SSS3.p1.4.m4.1.1.3.3.cmml" type="integer" xref="A1.SS2.SSS3.p1.4.m4.1.1.3.3">12</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p1.4.m4.1c">r=2^{12}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p1.4.m4.1d">italic_r = 2 start_POSTSUPERSCRIPT 12 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="r=2^{15}" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p1.5.m5.1"><semantics id="A1.SS2.SSS3.p1.5.m5.1a"><mrow id="A1.SS2.SSS3.p1.5.m5.1.1" xref="A1.SS2.SSS3.p1.5.m5.1.1.cmml"><mi id="A1.SS2.SSS3.p1.5.m5.1.1.2" xref="A1.SS2.SSS3.p1.5.m5.1.1.2.cmml">r</mi><mo id="A1.SS2.SSS3.p1.5.m5.1.1.1" xref="A1.SS2.SSS3.p1.5.m5.1.1.1.cmml">=</mo><msup id="A1.SS2.SSS3.p1.5.m5.1.1.3" xref="A1.SS2.SSS3.p1.5.m5.1.1.3.cmml"><mn id="A1.SS2.SSS3.p1.5.m5.1.1.3.2" xref="A1.SS2.SSS3.p1.5.m5.1.1.3.2.cmml">2</mn><mn id="A1.SS2.SSS3.p1.5.m5.1.1.3.3" xref="A1.SS2.SSS3.p1.5.m5.1.1.3.3.cmml">15</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p1.5.m5.1b"><apply id="A1.SS2.SSS3.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS3.p1.5.m5.1.1"><eq id="A1.SS2.SSS3.p1.5.m5.1.1.1.cmml" xref="A1.SS2.SSS3.p1.5.m5.1.1.1"></eq><ci id="A1.SS2.SSS3.p1.5.m5.1.1.2.cmml" xref="A1.SS2.SSS3.p1.5.m5.1.1.2">𝑟</ci><apply id="A1.SS2.SSS3.p1.5.m5.1.1.3.cmml" xref="A1.SS2.SSS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p1.5.m5.1.1.3.1.cmml" xref="A1.SS2.SSS3.p1.5.m5.1.1.3">superscript</csymbol><cn id="A1.SS2.SSS3.p1.5.m5.1.1.3.2.cmml" type="integer" xref="A1.SS2.SSS3.p1.5.m5.1.1.3.2">2</cn><cn id="A1.SS2.SSS3.p1.5.m5.1.1.3.3.cmml" type="integer" xref="A1.SS2.SSS3.p1.5.m5.1.1.3.3">15</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p1.5.m5.1c">r=2^{15}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p1.5.m5.1d">italic_r = 2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT</annotation></semantics></math> active destinations since these are the purge thresholds for Windows 10 and Windows Server, respectively <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib37" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.4. </span>Per-Bucket (Linux)</h4>
<div class="ltx_para" id="A1.SS2.SSS4.p1">
<p class="ltx_p" id="A1.SS2.SSS4.p1.5">Per-bucket selection uses one counter per bucket.
We assume the adversary <math alttext="A" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p1.1.m1.1"><semantics id="A1.SS2.SSS4.p1.1.m1.1a"><mi id="A1.SS2.SSS4.p1.1.m1.1.1" xref="A1.SS2.SSS4.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p1.1.m1.1b"><ci id="A1.SS2.SSS4.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS4.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p1.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p1.1.m1.1d">italic_A</annotation></semantics></math> can probe any bucket counter <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p1.2.m2.1"><semantics id="A1.SS2.SSS4.p1.2.m2.1a"><mi id="A1.SS2.SSS4.p1.2.m2.1.1" xref="A1.SS2.SSS4.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p1.2.m2.1b"><ci id="A1.SS2.SSS4.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS4.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p1.2.m2.1d">italic_i</annotation></semantics></math> on server <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p1.3.m3.1"><semantics id="A1.SS2.SSS4.p1.3.m3.1a"><mi id="A1.SS2.SSS4.p1.3.m3.1.1" xref="A1.SS2.SSS4.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p1.3.m3.1b"><ci id="A1.SS2.SSS4.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS4.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p1.3.m3.1d">italic_S</annotation></semantics></math> that it desires by constructing a packet that hashes to that particular bucket.<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><span class="ltx_ERROR undefined" id="footnote5.1">\added</span>Supposing that the bucket hash function appears to assign packets to buckets uniformly at random, the probability that at least one of an adversary’s <math alttext="a" class="ltx_Math" display="inline" id="footnote5.m1.1"><semantics id="footnote5.m1.1b"><mi id="footnote5.m1.1.1" xref="footnote5.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="footnote5.m1.1c"><ci id="footnote5.m1.1.1.cmml" xref="footnote5.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m1.1d">a</annotation><annotation encoding="application/x-llamapun" id="footnote5.m1.1e">italic_a</annotation></semantics></math> IPv4 addresses will hash into a target bucket among <math alttext="r" class="ltx_Math" display="inline" id="footnote5.m2.1"><semantics id="footnote5.m2.1b"><mi id="footnote5.m2.1.1" xref="footnote5.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="footnote5.m2.1c"><ci id="footnote5.m2.1.1.cmml" xref="footnote5.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m2.1d">r</annotation><annotation encoding="application/x-llamapun" id="footnote5.m2.1e">italic_r</annotation></semantics></math> total buckets is <math alttext="1-(1-1/r)^{a}" class="ltx_Math" display="inline" id="footnote5.m3.1"><semantics id="footnote5.m3.1b"><mrow id="footnote5.m3.1.1" xref="footnote5.m3.1.1.cmml"><mn id="footnote5.m3.1.1.3" xref="footnote5.m3.1.1.3.cmml">1</mn><mo id="footnote5.m3.1.1.2" xref="footnote5.m3.1.1.2.cmml">−</mo><msup id="footnote5.m3.1.1.1" xref="footnote5.m3.1.1.1.cmml"><mrow id="footnote5.m3.1.1.1.1.1" xref="footnote5.m3.1.1.1.1.1.1.cmml"><mo id="footnote5.m3.1.1.1.1.1.2" stretchy="false" xref="footnote5.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="footnote5.m3.1.1.1.1.1.1" xref="footnote5.m3.1.1.1.1.1.1.cmml"><mn id="footnote5.m3.1.1.1.1.1.1.2" xref="footnote5.m3.1.1.1.1.1.1.2.cmml">1</mn><mo id="footnote5.m3.1.1.1.1.1.1.1" xref="footnote5.m3.1.1.1.1.1.1.1.cmml">−</mo><mrow id="footnote5.m3.1.1.1.1.1.1.3" xref="footnote5.m3.1.1.1.1.1.1.3.cmml"><mn id="footnote5.m3.1.1.1.1.1.1.3.2" xref="footnote5.m3.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="footnote5.m3.1.1.1.1.1.1.3.1" xref="footnote5.m3.1.1.1.1.1.1.3.1.cmml">/</mo><mi id="footnote5.m3.1.1.1.1.1.1.3.3" xref="footnote5.m3.1.1.1.1.1.1.3.3.cmml">r</mi></mrow></mrow><mo id="footnote5.m3.1.1.1.1.1.3" stretchy="false" xref="footnote5.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="footnote5.m3.1.1.1.3" xref="footnote5.m3.1.1.1.3.cmml">a</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="footnote5.m3.1c"><apply id="footnote5.m3.1.1.cmml" xref="footnote5.m3.1.1"><minus id="footnote5.m3.1.1.2.cmml" xref="footnote5.m3.1.1.2"></minus><cn id="footnote5.m3.1.1.3.cmml" type="integer" xref="footnote5.m3.1.1.3">1</cn><apply id="footnote5.m3.1.1.1.cmml" xref="footnote5.m3.1.1.1"><csymbol cd="ambiguous" id="footnote5.m3.1.1.1.2.cmml" xref="footnote5.m3.1.1.1">superscript</csymbol><apply id="footnote5.m3.1.1.1.1.1.1.cmml" xref="footnote5.m3.1.1.1.1.1"><minus id="footnote5.m3.1.1.1.1.1.1.1.cmml" xref="footnote5.m3.1.1.1.1.1.1.1"></minus><cn id="footnote5.m3.1.1.1.1.1.1.2.cmml" type="integer" xref="footnote5.m3.1.1.1.1.1.1.2">1</cn><apply id="footnote5.m3.1.1.1.1.1.1.3.cmml" xref="footnote5.m3.1.1.1.1.1.1.3"><divide id="footnote5.m3.1.1.1.1.1.1.3.1.cmml" xref="footnote5.m3.1.1.1.1.1.1.3.1"></divide><cn id="footnote5.m3.1.1.1.1.1.1.3.2.cmml" type="integer" xref="footnote5.m3.1.1.1.1.1.1.3.2">1</cn><ci id="footnote5.m3.1.1.1.1.1.1.3.3.cmml" xref="footnote5.m3.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply><ci id="footnote5.m3.1.1.1.3.cmml" xref="footnote5.m3.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m3.1d">1-(1-1/r)^{a}</annotation><annotation encoding="application/x-llamapun" id="footnote5.m3.1e">1 - ( 1 - 1 / italic_r ) start_POSTSUPERSCRIPT italic_a end_POSTSUPERSCRIPT</annotation></semantics></math>. Even after Linux increased its maximum number of buckets to <math alttext="r=\numprint{262144}" class="ltx_Math" display="inline" id="footnote5.m4.2"><semantics id="footnote5.m4.2b"><mrow id="footnote5.m4.2.3" xref="footnote5.m4.2.3.cmml"><mi id="footnote5.m4.2.3.2" xref="footnote5.m4.2.3.2.cmml">r</mi><mo id="footnote5.m4.2.3.1" xref="footnote5.m4.2.3.1.cmml">=</mo><mrow id="footnote5.m4.2.2.4" xref="footnote5.m4.2.3.cmml"><mn id="footnote5.m4.1.1.1.1" xref="footnote5.m4.2.2.3.cmml">262</mn><mo id="footnote5.m4.2.2.4.1" xref="footnote5.m4.2.2.3.cmml">,</mo><mn id="footnote5.m4.2.2.2.2" xref="footnote5.m4.2.2.3.cmml">144</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote5.m4.2c"><apply id="footnote5.m4.2.3.cmml" xref="footnote5.m4.2.3"><eq id="footnote5.m4.2.3.1.cmml" xref="footnote5.m4.2.3.1"></eq><ci id="footnote5.m4.2.3.2.cmml" xref="footnote5.m4.2.3.2">𝑟</ci><cn id="footnote5.m4.2.2.3.cmml" type="integer" xref="footnote5.m4.1.1.1.1">262144</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m4.2d">r=\numprint{262144}</annotation><annotation encoding="application/x-llamapun" id="footnote5.m4.2e">italic_r = 262 , 144</annotation></semantics></math> (i.e., <math alttext="2^{1}8" class="ltx_Math" display="inline" id="footnote5.m5.1"><semantics id="footnote5.m5.1b"><mrow id="footnote5.m5.1.1" xref="footnote5.m5.1.1.cmml"><msup id="footnote5.m5.1.1.2" xref="footnote5.m5.1.1.2.cmml"><mn id="footnote5.m5.1.1.2.2" xref="footnote5.m5.1.1.2.2.cmml">2</mn><mn id="footnote5.m5.1.1.2.3" xref="footnote5.m5.1.1.2.3.cmml">1</mn></msup><mo id="footnote5.m5.1.1.1" xref="footnote5.m5.1.1.1.cmml">⁢</mo><mn id="footnote5.m5.1.1.3" xref="footnote5.m5.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote5.m5.1c"><apply id="footnote5.m5.1.1.cmml" xref="footnote5.m5.1.1"><times id="footnote5.m5.1.1.1.cmml" xref="footnote5.m5.1.1.1"></times><apply id="footnote5.m5.1.1.2.cmml" xref="footnote5.m5.1.1.2"><csymbol cd="ambiguous" id="footnote5.m5.1.1.2.1.cmml" xref="footnote5.m5.1.1.2">superscript</csymbol><cn id="footnote5.m5.1.1.2.2.cmml" type="integer" xref="footnote5.m5.1.1.2.2">2</cn><cn id="footnote5.m5.1.1.2.3.cmml" type="integer" xref="footnote5.m5.1.1.2.3">1</cn></apply><cn id="footnote5.m5.1.1.3.cmml" type="integer" xref="footnote5.m5.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m5.1d">2^{1}8</annotation><annotation encoding="application/x-llamapun" id="footnote5.m5.1e">2 start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT 8</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite>, an adversary controlling <math alttext="a=\numprint{10000}" class="ltx_Math" display="inline" id="footnote5.m6.2"><semantics id="footnote5.m6.2b"><mrow id="footnote5.m6.2.3" xref="footnote5.m6.2.3.cmml"><mi id="footnote5.m6.2.3.2" xref="footnote5.m6.2.3.2.cmml">a</mi><mo id="footnote5.m6.2.3.1" xref="footnote5.m6.2.3.1.cmml">=</mo><mrow id="footnote5.m6.2.2.4" xref="footnote5.m6.2.3.cmml"><mn id="footnote5.m6.1.1.1.1" xref="footnote5.m6.2.2.3.cmml">10</mn><mo id="footnote5.m6.2.2.4.1" xref="footnote5.m6.2.2.3.cmml">,</mo><mn id="footnote5.m6.2.2.2.2" xref="footnote5.m6.2.2.3.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote5.m6.2c"><apply id="footnote5.m6.2.3.cmml" xref="footnote5.m6.2.3"><eq id="footnote5.m6.2.3.1.cmml" xref="footnote5.m6.2.3.1"></eq><ci id="footnote5.m6.2.3.2.cmml" xref="footnote5.m6.2.3.2">𝑎</ci><cn id="footnote5.m6.2.2.3.cmml" type="integer" xref="footnote5.m6.1.1.1.1">10000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m6.2d">a=\numprint{10000}</annotation><annotation encoding="application/x-llamapun" id="footnote5.m6.2e">italic_a = 10 , 000</annotation></semantics></math> IPv4 addresses has a 3.74% chance of finding a hash collision, <math alttext="a=\numprint{100000}" class="ltx_Math" display="inline" id="footnote5.m7.2"><semantics id="footnote5.m7.2b"><mrow id="footnote5.m7.2.3" xref="footnote5.m7.2.3.cmml"><mi id="footnote5.m7.2.3.2" xref="footnote5.m7.2.3.2.cmml">a</mi><mo id="footnote5.m7.2.3.1" xref="footnote5.m7.2.3.1.cmml">=</mo><mrow id="footnote5.m7.2.2.4" xref="footnote5.m7.2.3.cmml"><mn id="footnote5.m7.1.1.1.1" xref="footnote5.m7.2.2.3.cmml">100</mn><mo id="footnote5.m7.2.2.4.1" xref="footnote5.m7.2.2.3.cmml">,</mo><mn id="footnote5.m7.2.2.2.2" xref="footnote5.m7.2.2.3.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote5.m7.2c"><apply id="footnote5.m7.2.3.cmml" xref="footnote5.m7.2.3"><eq id="footnote5.m7.2.3.1.cmml" xref="footnote5.m7.2.3.1"></eq><ci id="footnote5.m7.2.3.2.cmml" xref="footnote5.m7.2.3.2">𝑎</ci><cn id="footnote5.m7.2.2.3.cmml" type="integer" xref="footnote5.m7.1.1.1.1">100000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m7.2d">a=\numprint{100000}</annotation><annotation encoding="application/x-llamapun" id="footnote5.m7.2e">italic_a = 100 , 000</annotation></semantics></math> yields a 31.7% chance, and <math alttext="a=\numprint{1000000}" class="ltx_Math" display="inline" id="footnote5.m8.3"><semantics id="footnote5.m8.3b"><mrow id="footnote5.m8.3.4" xref="footnote5.m8.3.4.cmml"><mi id="footnote5.m8.3.4.2" xref="footnote5.m8.3.4.2.cmml">a</mi><mo id="footnote5.m8.3.4.1" xref="footnote5.m8.3.4.1.cmml">=</mo><mrow id="footnote5.m8.3.3.5" xref="footnote5.m8.3.4.cmml"><mn id="footnote5.m8.1.1.1.1" xref="footnote5.m8.3.3.4.cmml">1</mn><mo id="footnote5.m8.3.3.5.1" xref="footnote5.m8.3.3.4.cmml">,</mo><mn id="footnote5.m8.2.2.2.2" xref="footnote5.m8.3.3.4.cmml">000</mn><mo id="footnote5.m8.3.3.5.2" xref="footnote5.m8.3.3.4.cmml">,</mo><mn id="footnote5.m8.3.3.3.3" xref="footnote5.m8.3.3.4.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote5.m8.3c"><apply id="footnote5.m8.3.4.cmml" xref="footnote5.m8.3.4"><eq id="footnote5.m8.3.4.1.cmml" xref="footnote5.m8.3.4.1"></eq><ci id="footnote5.m8.3.4.2.cmml" xref="footnote5.m8.3.4.2">𝑎</ci><cn id="footnote5.m8.3.3.4.cmml" type="integer" xref="footnote5.m8.1.1.1.1">1000000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote5.m8.3d">a=\numprint{1000000}</annotation><annotation encoding="application/x-llamapun" id="footnote5.m8.3e">italic_a = 1 , 000 , 000</annotation></semantics></math> yields a 97.8% chance. These counts are similar to the sizes of large observed botnets. Machines with less RAM have fewer buckets, yielding higher hash collision probabilities at lower IP address counts.</span></span></span>
W.l.o.g., suppose the IPID of this reply is 0.
The bucket counter’s current value depends on the number and timing of packets that hashed into this bucket in the unit time that elapsed since <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p1.4.m4.1"><semantics id="A1.SS2.SSS4.p1.4.m4.1a"><mi id="A1.SS2.SSS4.p1.4.m4.1.1" xref="A1.SS2.SSS4.p1.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p1.4.m4.1b"><ci id="A1.SS2.SSS4.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS4.p1.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p1.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p1.4.m4.1d">italic_S</annotation></semantics></math> replied to <math alttext="A" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p1.5.m5.1"><semantics id="A1.SS2.SSS4.p1.5.m5.1a"><mi id="A1.SS2.SSS4.p1.5.m5.1.1" xref="A1.SS2.SSS4.p1.5.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p1.5.m5.1b"><ci id="A1.SS2.SSS4.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS4.p1.5.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p1.5.m5.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p1.5.m5.1d">italic_A</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS2.SSS4.p2">
<p class="ltx_p" id="A1.SS2.SSS4.p2.9">Recall that, for this method, <math alttext="N_{i}\geq 0" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.1.m1.1"><semantics id="A1.SS2.SSS4.p2.1.m1.1a"><mrow id="A1.SS2.SSS4.p2.1.m1.1.1" xref="A1.SS2.SSS4.p2.1.m1.1.1.cmml"><msub id="A1.SS2.SSS4.p2.1.m1.1.1.2" xref="A1.SS2.SSS4.p2.1.m1.1.1.2.cmml"><mi id="A1.SS2.SSS4.p2.1.m1.1.1.2.2" xref="A1.SS2.SSS4.p2.1.m1.1.1.2.2.cmml">N</mi><mi id="A1.SS2.SSS4.p2.1.m1.1.1.2.3" xref="A1.SS2.SSS4.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS2.SSS4.p2.1.m1.1.1.1" xref="A1.SS2.SSS4.p2.1.m1.1.1.1.cmml">≥</mo><mn id="A1.SS2.SSS4.p2.1.m1.1.1.3" xref="A1.SS2.SSS4.p2.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.1.m1.1b"><apply id="A1.SS2.SSS4.p2.1.m1.1.1.cmml" xref="A1.SS2.SSS4.p2.1.m1.1.1"><geq id="A1.SS2.SSS4.p2.1.m1.1.1.1.cmml" xref="A1.SS2.SSS4.p2.1.m1.1.1.1"></geq><apply id="A1.SS2.SSS4.p2.1.m1.1.1.2.cmml" xref="A1.SS2.SSS4.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p2.1.m1.1.1.2.1.cmml" xref="A1.SS2.SSS4.p2.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS2.SSS4.p2.1.m1.1.1.2.2.cmml" xref="A1.SS2.SSS4.p2.1.m1.1.1.2.2">𝑁</ci><ci id="A1.SS2.SSS4.p2.1.m1.1.1.2.3.cmml" xref="A1.SS2.SSS4.p2.1.m1.1.1.2.3">𝑖</ci></apply><cn id="A1.SS2.SSS4.p2.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.SSS4.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.1.m1.1c">N_{i}\geq 0</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math> is the number of packets sent by <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.2.m2.1"><semantics id="A1.SS2.SSS4.p2.2.m2.1a"><mi id="A1.SS2.SSS4.p2.2.m2.1.1" xref="A1.SS2.SSS4.p2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.2.m2.1b"><ci id="A1.SS2.SSS4.p2.2.m2.1.1.cmml" xref="A1.SS2.SSS4.p2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.2.m2.1d">italic_S</annotation></semantics></math> with IPIDs assigned by bucket counter <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.3.m3.1"><semantics id="A1.SS2.SSS4.p2.3.m3.1a"><mi id="A1.SS2.SSS4.p2.3.m3.1.1" xref="A1.SS2.SSS4.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.3.m3.1b"><ci id="A1.SS2.SSS4.p2.3.m3.1.1.cmml" xref="A1.SS2.SSS4.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.3.m3.1d">italic_i</annotation></semantics></math> per unit time.
For each <math alttext="j\in\{1,\ldots,N_{i}\}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.4.m4.3"><semantics id="A1.SS2.SSS4.p2.4.m4.3a"><mrow id="A1.SS2.SSS4.p2.4.m4.3.3" xref="A1.SS2.SSS4.p2.4.m4.3.3.cmml"><mi id="A1.SS2.SSS4.p2.4.m4.3.3.3" xref="A1.SS2.SSS4.p2.4.m4.3.3.3.cmml">j</mi><mo id="A1.SS2.SSS4.p2.4.m4.3.3.2" xref="A1.SS2.SSS4.p2.4.m4.3.3.2.cmml">∈</mo><mrow id="A1.SS2.SSS4.p2.4.m4.3.3.1.1" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.2.cmml"><mo id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.2" stretchy="false" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.2.cmml">{</mo><mn id="A1.SS2.SSS4.p2.4.m4.1.1" xref="A1.SS2.SSS4.p2.4.m4.1.1.cmml">1</mn><mo id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.3" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.2.cmml">,</mo><mi id="A1.SS2.SSS4.p2.4.m4.2.2" mathvariant="normal" xref="A1.SS2.SSS4.p2.4.m4.2.2.cmml">…</mi><mo id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.4" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.2.cmml">,</mo><msub id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.cmml"><mi id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.2" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.2.cmml">N</mi><mi id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.3" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.5" stretchy="false" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.4.m4.3b"><apply id="A1.SS2.SSS4.p2.4.m4.3.3.cmml" xref="A1.SS2.SSS4.p2.4.m4.3.3"><in id="A1.SS2.SSS4.p2.4.m4.3.3.2.cmml" xref="A1.SS2.SSS4.p2.4.m4.3.3.2"></in><ci id="A1.SS2.SSS4.p2.4.m4.3.3.3.cmml" xref="A1.SS2.SSS4.p2.4.m4.3.3.3">𝑗</ci><set id="A1.SS2.SSS4.p2.4.m4.3.3.1.2.cmml" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.1"><cn id="A1.SS2.SSS4.p2.4.m4.1.1.cmml" type="integer" xref="A1.SS2.SSS4.p2.4.m4.1.1">1</cn><ci id="A1.SS2.SSS4.p2.4.m4.2.2.cmml" xref="A1.SS2.SSS4.p2.4.m4.2.2">…</ci><apply id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.cmml" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.1.cmml" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.2.cmml" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.2">𝑁</ci><ci id="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.3.cmml" xref="A1.SS2.SSS4.p2.4.m4.3.3.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.4.m4.3c">j\in\{1,\ldots,N_{i}\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.4.m4.3d">italic_j ∈ { 1 , … , italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>, let <math alttext="c_{j}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.5.m5.1"><semantics id="A1.SS2.SSS4.p2.5.m5.1a"><msub id="A1.SS2.SSS4.p2.5.m5.1.1" xref="A1.SS2.SSS4.p2.5.m5.1.1.cmml"><mi id="A1.SS2.SSS4.p2.5.m5.1.1.2" xref="A1.SS2.SSS4.p2.5.m5.1.1.2.cmml">c</mi><mi id="A1.SS2.SSS4.p2.5.m5.1.1.3" xref="A1.SS2.SSS4.p2.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.5.m5.1b"><apply id="A1.SS2.SSS4.p2.5.m5.1.1.cmml" xref="A1.SS2.SSS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p2.5.m5.1.1.1.cmml" xref="A1.SS2.SSS4.p2.5.m5.1.1">subscript</csymbol><ci id="A1.SS2.SSS4.p2.5.m5.1.1.2.cmml" xref="A1.SS2.SSS4.p2.5.m5.1.1.2">𝑐</ci><ci id="A1.SS2.SSS4.p2.5.m5.1.1.3.cmml" xref="A1.SS2.SSS4.p2.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.5.m5.1c">c_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.5.m5.1d">italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> be the increment value of bucket counter <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.6.m6.1"><semantics id="A1.SS2.SSS4.p2.6.m6.1a"><mi id="A1.SS2.SSS4.p2.6.m6.1.1" xref="A1.SS2.SSS4.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.6.m6.1b"><ci id="A1.SS2.SSS4.p2.6.m6.1.1.cmml" xref="A1.SS2.SSS4.p2.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.6.m6.1d">italic_i</annotation></semantics></math> resulting in the IPID of the <math alttext="j" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.7.m7.1"><semantics id="A1.SS2.SSS4.p2.7.m7.1a"><mi id="A1.SS2.SSS4.p2.7.m7.1.1" xref="A1.SS2.SSS4.p2.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.7.m7.1b"><ci id="A1.SS2.SSS4.p2.7.m7.1.1.cmml" xref="A1.SS2.SSS4.p2.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.7.m7.1d">italic_j</annotation></semantics></math>-th packet sent after the reply to <math alttext="A" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.8.m8.1"><semantics id="A1.SS2.SSS4.p2.8.m8.1a"><mi id="A1.SS2.SSS4.p2.8.m8.1.1" xref="A1.SS2.SSS4.p2.8.m8.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.8.m8.1b"><ci id="A1.SS2.SSS4.p2.8.m8.1.1.cmml" xref="A1.SS2.SSS4.p2.8.m8.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.8.m8.1c">A</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.8.m8.1d">italic_A</annotation></semantics></math>.
Thus, the probability that the next IPID is <math alttext="x" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.9.m9.1"><semantics id="A1.SS2.SSS4.p2.9.m9.1a"><mi id="A1.SS2.SSS4.p2.9.m9.1.1" xref="A1.SS2.SSS4.p2.9.m9.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.9.m9.1b"><ci id="A1.SS2.SSS4.p2.9.m9.1.1.cmml" xref="A1.SS2.SSS4.p2.9.m9.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.9.m9.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.9.m9.1d">italic_x</annotation></semantics></math> is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx5">
<tbody id="A1.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{Pr}\left[\text{next IPID}=x\right]" class="ltx_Math" display="inline" id="A1.Ex5.m1.1"><semantics id="A1.Ex5.m1.1a"><mrow id="A1.Ex5.m1.1.1" xref="A1.Ex5.m1.1.1.cmml"><mi id="A1.Ex5.m1.1.1.3" xref="A1.Ex5.m1.1.1.3.cmml">Pr</mi><mo id="A1.Ex5.m1.1.1.2" xref="A1.Ex5.m1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex5.m1.1.1.1.1" xref="A1.Ex5.m1.1.1.1.2.cmml"><mo id="A1.Ex5.m1.1.1.1.1.2" xref="A1.Ex5.m1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex5.m1.1.1.1.1.1" xref="A1.Ex5.m1.1.1.1.1.1.cmml"><mtext id="A1.Ex5.m1.1.1.1.1.1.2" xref="A1.Ex5.m1.1.1.1.1.1.2a.cmml">next IPID</mtext><mo id="A1.Ex5.m1.1.1.1.1.1.1" xref="A1.Ex5.m1.1.1.1.1.1.1.cmml">=</mo><mi id="A1.Ex5.m1.1.1.1.1.1.3" xref="A1.Ex5.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.Ex5.m1.1.1.1.1.3" xref="A1.Ex5.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m1.1b"><apply id="A1.Ex5.m1.1.1.cmml" xref="A1.Ex5.m1.1.1"><times id="A1.Ex5.m1.1.1.2.cmml" xref="A1.Ex5.m1.1.1.2"></times><ci id="A1.Ex5.m1.1.1.3.cmml" xref="A1.Ex5.m1.1.1.3">Pr</ci><apply id="A1.Ex5.m1.1.1.1.2.cmml" xref="A1.Ex5.m1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex5.m1.1.1.1.2.1.cmml" xref="A1.Ex5.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex5.m1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.1.1.1.1.1"><eq id="A1.Ex5.m1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.1.1.1.1.1.1"></eq><ci id="A1.Ex5.m1.1.1.1.1.1.2a.cmml" xref="A1.Ex5.m1.1.1.1.1.1.2"><mtext id="A1.Ex5.m1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.1.1.1.1.1.2">next IPID</mtext></ci><ci id="A1.Ex5.m1.1.1.1.1.1.3.cmml" xref="A1.Ex5.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m1.1c">\displaystyle\mathrm{Pr}\left[\text{next IPID}=x\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m1.1d">roman_Pr [ next IPID = italic_x ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{Pr}\left[\sum_{j=1}^{N_{i}+1}c_{j}\equiv x\bmod 2^{16}\right]" class="ltx_Math" display="inline" id="A1.Ex5.m2.1"><semantics id="A1.Ex5.m2.1a"><mrow id="A1.Ex5.m2.1.1" xref="A1.Ex5.m2.1.1.cmml"><mi id="A1.Ex5.m2.1.1.3" xref="A1.Ex5.m2.1.1.3.cmml"></mi><mo id="A1.Ex5.m2.1.1.2" xref="A1.Ex5.m2.1.1.2.cmml">=</mo><mrow id="A1.Ex5.m2.1.1.1" xref="A1.Ex5.m2.1.1.1.cmml"><mi id="A1.Ex5.m2.1.1.1.3" xref="A1.Ex5.m2.1.1.1.3.cmml">Pr</mi><mo id="A1.Ex5.m2.1.1.1.2" xref="A1.Ex5.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex5.m2.1.1.1.1.1" xref="A1.Ex5.m2.1.1.1.1.2.cmml"><mo id="A1.Ex5.m2.1.1.1.1.1.2" xref="A1.Ex5.m2.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex5.m2.1.1.1.1.1.1" xref="A1.Ex5.m2.1.1.1.1.1.1.cmml"><mrow id="A1.Ex5.m2.1.1.1.1.1.1.2" xref="A1.Ex5.m2.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A1.Ex5.m2.1.1.1.1.1.1.2.1" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.cmml"><munderover id="A1.Ex5.m2.1.1.1.1.1.1.2.1a" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.cmml"><mo id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.2" movablelimits="false" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.cmml"><mi id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.2" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.1" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.3" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.cmml"><msub id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.cmml"><mi id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.2" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.2.cmml">N</mi><mi id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.3" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.3.cmml">i</mi></msub><mo id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.1" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.1.cmml">+</mo><mn id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.3" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.3.cmml">1</mn></mrow></munderover></mstyle><msub id="A1.Ex5.m2.1.1.1.1.1.1.2.2" xref="A1.Ex5.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex5.m2.1.1.1.1.1.1.2.2.2" xref="A1.Ex5.m2.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="A1.Ex5.m2.1.1.1.1.1.1.2.2.3" xref="A1.Ex5.m2.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub></mrow><mo id="A1.Ex5.m2.1.1.1.1.1.1.1" xref="A1.Ex5.m2.1.1.1.1.1.1.1.cmml">≡</mo><mrow id="A1.Ex5.m2.1.1.1.1.1.1.3" xref="A1.Ex5.m2.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex5.m2.1.1.1.1.1.1.3.2" xref="A1.Ex5.m2.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="A1.Ex5.m2.1.1.1.1.1.1.3.1" xref="A1.Ex5.m2.1.1.1.1.1.1.3.1.cmml">mod</mo><msup id="A1.Ex5.m2.1.1.1.1.1.1.3.3" xref="A1.Ex5.m2.1.1.1.1.1.1.3.3.cmml"><mn id="A1.Ex5.m2.1.1.1.1.1.1.3.3.2" xref="A1.Ex5.m2.1.1.1.1.1.1.3.3.2.cmml">2</mn><mn id="A1.Ex5.m2.1.1.1.1.1.1.3.3.3" xref="A1.Ex5.m2.1.1.1.1.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.Ex5.m2.1.1.1.1.1.3" xref="A1.Ex5.m2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m2.1b"><apply id="A1.Ex5.m2.1.1.cmml" xref="A1.Ex5.m2.1.1"><eq id="A1.Ex5.m2.1.1.2.cmml" xref="A1.Ex5.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.Ex5.m2.1.1.3.cmml" xref="A1.Ex5.m2.1.1.3">absent</csymbol><apply id="A1.Ex5.m2.1.1.1.cmml" xref="A1.Ex5.m2.1.1.1"><times id="A1.Ex5.m2.1.1.1.2.cmml" xref="A1.Ex5.m2.1.1.1.2"></times><ci id="A1.Ex5.m2.1.1.1.3.cmml" xref="A1.Ex5.m2.1.1.1.3">Pr</ci><apply id="A1.Ex5.m2.1.1.1.1.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex5.m2.1.1.1.1.2.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex5.m2.1.1.1.1.1.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1"><equivalent id="A1.Ex5.m2.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.1"></equivalent><apply id="A1.Ex5.m2.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2"><apply id="A1.Ex5.m2.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.Ex5.m2.1.1.1.1.1.1.2.1.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.2"></sum><apply id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3"><eq id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.1"></eq><ci id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.2">𝑗</ci><cn id="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><apply id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3"><plus id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.1"></plus><apply id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2"><csymbol cd="ambiguous" id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2">subscript</csymbol><ci id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.2">𝑁</ci><ci id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.3.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.2.3">𝑖</ci></apply><cn id="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.3.cmml" type="integer" xref="A1.Ex5.m2.1.1.1.1.1.1.2.1.3.3">1</cn></apply></apply><apply id="A1.Ex5.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex5.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.Ex5.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="A1.Ex5.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></apply><apply id="A1.Ex5.m2.1.1.1.1.1.1.3.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.Ex5.m2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.3.1">modulo</csymbol><ci id="A1.Ex5.m2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.3.2">𝑥</ci><apply id="A1.Ex5.m2.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex5.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex5.m2.1.1.1.1.1.1.3.3">superscript</csymbol><cn id="A1.Ex5.m2.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.Ex5.m2.1.1.1.1.1.1.3.3.2">2</cn><cn id="A1.Ex5.m2.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.Ex5.m2.1.1.1.1.1.1.3.3.3">16</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m2.1c">\displaystyle=\mathrm{Pr}\left[\sum_{j=1}^{N_{i}+1}c_{j}\equiv x\bmod 2^{16}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m2.1d">= roman_Pr [ ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + 1 end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=0}^{\infty}\mathrm{Pr}\left[\sum_{j=1}^{N_{i}+1}c_{j}%
\equiv x\bmod 2^{16}\mid N_{i}=n\right]\cdot\mathrm{Pr}\left[N=n\right]" class="ltx_Math" display="inline" id="A1.Ex6.m1.2"><semantics id="A1.Ex6.m1.2a"><mrow id="A1.Ex6.m1.2.2" xref="A1.Ex6.m1.2.2.cmml"><mi id="A1.Ex6.m1.2.2.4" xref="A1.Ex6.m1.2.2.4.cmml"></mi><mo id="A1.Ex6.m1.2.2.3" xref="A1.Ex6.m1.2.2.3.cmml">=</mo><mrow id="A1.Ex6.m1.2.2.2" xref="A1.Ex6.m1.2.2.2.cmml"><mstyle displaystyle="true" id="A1.Ex6.m1.2.2.2.3" xref="A1.Ex6.m1.2.2.2.3.cmml"><munderover id="A1.Ex6.m1.2.2.2.3a" xref="A1.Ex6.m1.2.2.2.3.cmml"><mo id="A1.Ex6.m1.2.2.2.3.2.2" movablelimits="false" xref="A1.Ex6.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="A1.Ex6.m1.2.2.2.3.2.3" xref="A1.Ex6.m1.2.2.2.3.2.3.cmml"><mi id="A1.Ex6.m1.2.2.2.3.2.3.2" xref="A1.Ex6.m1.2.2.2.3.2.3.2.cmml">n</mi><mo id="A1.Ex6.m1.2.2.2.3.2.3.1" xref="A1.Ex6.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="A1.Ex6.m1.2.2.2.3.2.3.3" xref="A1.Ex6.m1.2.2.2.3.2.3.3.cmml">0</mn></mrow><mi id="A1.Ex6.m1.2.2.2.3.3" mathvariant="normal" xref="A1.Ex6.m1.2.2.2.3.3.cmml">∞</mi></munderover></mstyle><mrow id="A1.Ex6.m1.2.2.2.2" xref="A1.Ex6.m1.2.2.2.2.cmml"><mrow id="A1.Ex6.m1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.cmml"><mrow id="A1.Ex6.m1.1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.1.3" xref="A1.Ex6.m1.1.1.1.1.1.1.3.cmml">Pr</mi><mo id="A1.Ex6.m1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex6.m1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml"><munderover id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1a" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml"><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.2" movablelimits="false" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.cmml"><msub id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.2.cmml">N</mi><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.3.cmml">i</mi></msub><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.1.cmml">+</mo><mn id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.3.cmml">1</mn></mrow></munderover></mstyle><msub id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub></mrow><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.3.cmml">≡</mo><mrow id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">x</mi><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.1.cmml">mod</mo><mrow id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.cmml"><msup id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.cmml"><mn id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.2.cmml">2</mn><mn id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.cmml">16</mn></msup><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.1" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">∣</mo><msub id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.cmml"><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.2" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.2.cmml">N</mi><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.3" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.5" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.5.cmml">=</mo><mi id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.6" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.6.cmml">n</mi></mrow><mo id="A1.Ex6.m1.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.Ex6.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex6.m1.1.1.1.1.1.2" rspace="0.222em" xref="A1.Ex6.m1.1.1.1.1.1.2.cmml">⋅</mo><mi id="A1.Ex6.m1.1.1.1.1.1.3" xref="A1.Ex6.m1.1.1.1.1.1.3.cmml">Pr</mi></mrow><mo id="A1.Ex6.m1.2.2.2.2.3" xref="A1.Ex6.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="A1.Ex6.m1.2.2.2.2.2.1" xref="A1.Ex6.m1.2.2.2.2.2.2.cmml"><mo id="A1.Ex6.m1.2.2.2.2.2.1.2" xref="A1.Ex6.m1.2.2.2.2.2.2.1.cmml">[</mo><mrow id="A1.Ex6.m1.2.2.2.2.2.1.1" xref="A1.Ex6.m1.2.2.2.2.2.1.1.cmml"><mi id="A1.Ex6.m1.2.2.2.2.2.1.1.2" xref="A1.Ex6.m1.2.2.2.2.2.1.1.2.cmml">N</mi><mo id="A1.Ex6.m1.2.2.2.2.2.1.1.1" xref="A1.Ex6.m1.2.2.2.2.2.1.1.1.cmml">=</mo><mi id="A1.Ex6.m1.2.2.2.2.2.1.1.3" xref="A1.Ex6.m1.2.2.2.2.2.1.1.3.cmml">n</mi></mrow><mo id="A1.Ex6.m1.2.2.2.2.2.1.3" xref="A1.Ex6.m1.2.2.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.2b"><apply id="A1.Ex6.m1.2.2.cmml" xref="A1.Ex6.m1.2.2"><eq id="A1.Ex6.m1.2.2.3.cmml" xref="A1.Ex6.m1.2.2.3"></eq><csymbol cd="latexml" id="A1.Ex6.m1.2.2.4.cmml" xref="A1.Ex6.m1.2.2.4">absent</csymbol><apply id="A1.Ex6.m1.2.2.2.cmml" xref="A1.Ex6.m1.2.2.2"><apply id="A1.Ex6.m1.2.2.2.3.cmml" xref="A1.Ex6.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.2.2.2.3.1.cmml" xref="A1.Ex6.m1.2.2.2.3">superscript</csymbol><apply id="A1.Ex6.m1.2.2.2.3.2.cmml" xref="A1.Ex6.m1.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.2.2.2.3.2.1.cmml" xref="A1.Ex6.m1.2.2.2.3">subscript</csymbol><sum id="A1.Ex6.m1.2.2.2.3.2.2.cmml" xref="A1.Ex6.m1.2.2.2.3.2.2"></sum><apply id="A1.Ex6.m1.2.2.2.3.2.3.cmml" xref="A1.Ex6.m1.2.2.2.3.2.3"><eq id="A1.Ex6.m1.2.2.2.3.2.3.1.cmml" xref="A1.Ex6.m1.2.2.2.3.2.3.1"></eq><ci id="A1.Ex6.m1.2.2.2.3.2.3.2.cmml" xref="A1.Ex6.m1.2.2.2.3.2.3.2">𝑛</ci><cn id="A1.Ex6.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="A1.Ex6.m1.2.2.2.3.2.3.3">0</cn></apply></apply><infinity id="A1.Ex6.m1.2.2.2.3.3.cmml" xref="A1.Ex6.m1.2.2.2.3.3"></infinity></apply><apply id="A1.Ex6.m1.2.2.2.2.cmml" xref="A1.Ex6.m1.2.2.2.2"><times id="A1.Ex6.m1.2.2.2.2.3.cmml" xref="A1.Ex6.m1.2.2.2.2.3"></times><apply id="A1.Ex6.m1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1"><ci id="A1.Ex6.m1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.2">⋅</ci><apply id="A1.Ex6.m1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1"><times id="A1.Ex6.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.2"></times><ci id="A1.Ex6.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.3">Pr</ci><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.Ex6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1"><and id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1a.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1"></and><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1b.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1"><equivalent id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.3"></equivalent><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2"><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.2"></sum><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3"><eq id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.1"></eq><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.2">𝑗</ci><cn id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3"><plus id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.1"></plus><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2">subscript</csymbol><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.2">𝑁</ci><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.2.3">𝑖</ci></apply><cn id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.1.3.3">1</cn></apply></apply><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></apply><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="latexml" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.1">modulo</csymbol><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.2">𝑥</ci><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3"><csymbol cd="latexml" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.1">conditional</csymbol><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2">superscript</csymbol><cn id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.2.cmml" type="integer" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.2">2</cn><cn id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.cmml" type="integer" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.2.3">16</cn></apply><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3">subscript</csymbol><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.2">𝑁</ci><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1c.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1"><eq id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2406.06483v2#A1.Ex6.m1.1.1.1.1.1.1.1.1.1.4.cmml" id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1d.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1"></share><ci id="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1.1.1.1.6">𝑛</ci></apply></apply></apply></apply><ci id="A1.Ex6.m1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3">Pr</ci></apply><apply id="A1.Ex6.m1.2.2.2.2.2.2.cmml" xref="A1.Ex6.m1.2.2.2.2.2.1"><csymbol cd="latexml" id="A1.Ex6.m1.2.2.2.2.2.2.1.cmml" xref="A1.Ex6.m1.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="A1.Ex6.m1.2.2.2.2.2.1.1.cmml" xref="A1.Ex6.m1.2.2.2.2.2.1.1"><eq id="A1.Ex6.m1.2.2.2.2.2.1.1.1.cmml" xref="A1.Ex6.m1.2.2.2.2.2.1.1.1"></eq><ci id="A1.Ex6.m1.2.2.2.2.2.1.1.2.cmml" xref="A1.Ex6.m1.2.2.2.2.2.1.1.2">𝑁</ci><ci id="A1.Ex6.m1.2.2.2.2.2.1.1.3.cmml" xref="A1.Ex6.m1.2.2.2.2.2.1.1.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m1.2c">\displaystyle=\sum_{n=0}^{\infty}\mathrm{Pr}\left[\sum_{j=1}^{N_{i}+1}c_{j}%
\equiv x\bmod 2^{16}\mid N_{i}=n\right]\cdot\mathrm{Pr}\left[N=n\right]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex6.m1.2d">= ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_Pr [ ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + 1 end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ∣ italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_n ] ⋅ roman_Pr [ italic_N = italic_n ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{n=0}^{\infty}\mathrm{Pr}\left[\sum_{j=1}^{n+1}c_{j}\equiv x%
\bmod 2^{16}\right]\cdot\mathrm{pmf}(n,\lambda_{i})," class="ltx_Math" display="inline" id="A1.E16.m1.2"><semantics id="A1.E16.m1.2a"><mrow id="A1.E16.m1.2.2.1" xref="A1.E16.m1.2.2.1.1.cmml"><mrow id="A1.E16.m1.2.2.1.1" xref="A1.E16.m1.2.2.1.1.cmml"><mi id="A1.E16.m1.2.2.1.1.4" xref="A1.E16.m1.2.2.1.1.4.cmml"></mi><mo id="A1.E16.m1.2.2.1.1.3" xref="A1.E16.m1.2.2.1.1.3.cmml">=</mo><mrow id="A1.E16.m1.2.2.1.1.2" xref="A1.E16.m1.2.2.1.1.2.cmml"><mstyle displaystyle="true" id="A1.E16.m1.2.2.1.1.2.3" xref="A1.E16.m1.2.2.1.1.2.3.cmml"><munderover id="A1.E16.m1.2.2.1.1.2.3a" xref="A1.E16.m1.2.2.1.1.2.3.cmml"><mo id="A1.E16.m1.2.2.1.1.2.3.2.2" movablelimits="false" xref="A1.E16.m1.2.2.1.1.2.3.2.2.cmml">∑</mo><mrow id="A1.E16.m1.2.2.1.1.2.3.2.3" xref="A1.E16.m1.2.2.1.1.2.3.2.3.cmml"><mi id="A1.E16.m1.2.2.1.1.2.3.2.3.2" xref="A1.E16.m1.2.2.1.1.2.3.2.3.2.cmml">n</mi><mo id="A1.E16.m1.2.2.1.1.2.3.2.3.1" xref="A1.E16.m1.2.2.1.1.2.3.2.3.1.cmml">=</mo><mn id="A1.E16.m1.2.2.1.1.2.3.2.3.3" xref="A1.E16.m1.2.2.1.1.2.3.2.3.3.cmml">0</mn></mrow><mi id="A1.E16.m1.2.2.1.1.2.3.3" mathvariant="normal" xref="A1.E16.m1.2.2.1.1.2.3.3.cmml">∞</mi></munderover></mstyle><mrow id="A1.E16.m1.2.2.1.1.2.2" xref="A1.E16.m1.2.2.1.1.2.2.cmml"><mrow id="A1.E16.m1.2.2.1.1.1.1.1" xref="A1.E16.m1.2.2.1.1.1.1.1.cmml"><mrow id="A1.E16.m1.2.2.1.1.1.1.1.1" xref="A1.E16.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.2.2.1.1.1.1.1.1.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.3.cmml">Pr</mi><mo id="A1.E16.m1.2.2.1.1.1.1.1.1.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml"><munderover id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1a" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml"><mo id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.2" movablelimits="false" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.cmml"><mi id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.1" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.cmml"><mi id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.2.cmml">n</mi><mo id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.1" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.1.cmml">+</mo><mn id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.3.cmml">1</mn></mrow></munderover></mstyle><msub id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub></mrow><mo id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">≡</mo><mrow id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">mod</mo><msup id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">2</mn><mn id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E16.m1.2.2.1.1.1.1.1.2" rspace="0.222em" xref="A1.E16.m1.2.2.1.1.1.1.1.2.cmml">⋅</mo><mi id="A1.E16.m1.2.2.1.1.1.1.1.3" xref="A1.E16.m1.2.2.1.1.1.1.1.3.cmml">pmf</mi></mrow><mo id="A1.E16.m1.2.2.1.1.2.2.3" xref="A1.E16.m1.2.2.1.1.2.2.3.cmml">⁢</mo><mrow id="A1.E16.m1.2.2.1.1.2.2.2.1" xref="A1.E16.m1.2.2.1.1.2.2.2.2.cmml"><mo id="A1.E16.m1.2.2.1.1.2.2.2.1.2" stretchy="false" xref="A1.E16.m1.2.2.1.1.2.2.2.2.cmml">(</mo><mi id="A1.E16.m1.1.1" xref="A1.E16.m1.1.1.cmml">n</mi><mo id="A1.E16.m1.2.2.1.1.2.2.2.1.3" xref="A1.E16.m1.2.2.1.1.2.2.2.2.cmml">,</mo><msub id="A1.E16.m1.2.2.1.1.2.2.2.1.1" xref="A1.E16.m1.2.2.1.1.2.2.2.1.1.cmml"><mi id="A1.E16.m1.2.2.1.1.2.2.2.1.1.2" xref="A1.E16.m1.2.2.1.1.2.2.2.1.1.2.cmml">λ</mi><mi id="A1.E16.m1.2.2.1.1.2.2.2.1.1.3" xref="A1.E16.m1.2.2.1.1.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A1.E16.m1.2.2.1.1.2.2.2.1.4" stretchy="false" xref="A1.E16.m1.2.2.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E16.m1.2.2.1.2" xref="A1.E16.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.2b"><apply id="A1.E16.m1.2.2.1.1.cmml" xref="A1.E16.m1.2.2.1"><eq id="A1.E16.m1.2.2.1.1.3.cmml" xref="A1.E16.m1.2.2.1.1.3"></eq><csymbol cd="latexml" id="A1.E16.m1.2.2.1.1.4.cmml" xref="A1.E16.m1.2.2.1.1.4">absent</csymbol><apply id="A1.E16.m1.2.2.1.1.2.cmml" xref="A1.E16.m1.2.2.1.1.2"><apply id="A1.E16.m1.2.2.1.1.2.3.cmml" xref="A1.E16.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.2.2.1.1.2.3.1.cmml" xref="A1.E16.m1.2.2.1.1.2.3">superscript</csymbol><apply id="A1.E16.m1.2.2.1.1.2.3.2.cmml" xref="A1.E16.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A1.E16.m1.2.2.1.1.2.3.2.1.cmml" xref="A1.E16.m1.2.2.1.1.2.3">subscript</csymbol><sum id="A1.E16.m1.2.2.1.1.2.3.2.2.cmml" xref="A1.E16.m1.2.2.1.1.2.3.2.2"></sum><apply id="A1.E16.m1.2.2.1.1.2.3.2.3.cmml" xref="A1.E16.m1.2.2.1.1.2.3.2.3"><eq id="A1.E16.m1.2.2.1.1.2.3.2.3.1.cmml" xref="A1.E16.m1.2.2.1.1.2.3.2.3.1"></eq><ci id="A1.E16.m1.2.2.1.1.2.3.2.3.2.cmml" xref="A1.E16.m1.2.2.1.1.2.3.2.3.2">𝑛</ci><cn id="A1.E16.m1.2.2.1.1.2.3.2.3.3.cmml" type="integer" xref="A1.E16.m1.2.2.1.1.2.3.2.3.3">0</cn></apply></apply><infinity id="A1.E16.m1.2.2.1.1.2.3.3.cmml" xref="A1.E16.m1.2.2.1.1.2.3.3"></infinity></apply><apply id="A1.E16.m1.2.2.1.1.2.2.cmml" xref="A1.E16.m1.2.2.1.1.2.2"><times id="A1.E16.m1.2.2.1.1.2.2.3.cmml" xref="A1.E16.m1.2.2.1.1.2.2.3"></times><apply id="A1.E16.m1.2.2.1.1.1.1.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1"><ci id="A1.E16.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.2">⋅</ci><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1"><times id="A1.E16.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.2"></times><ci id="A1.E16.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.3">Pr</ci><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E16.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1"><equivalent id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1"></equivalent><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2"><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.2"></sum><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3"><eq id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.1"></eq><ci id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.2">𝑗</ci><cn id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3"><plus id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.1"></plus><ci id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.2">𝑛</ci><cn id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.3.cmml" type="integer" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.3.3">1</cn></apply></apply><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></apply><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.1">modulo</csymbol><ci id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><cn id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.2">2</cn><cn id="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E16.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.3">16</cn></apply></apply></apply></apply></apply><ci id="A1.E16.m1.2.2.1.1.1.1.1.3.cmml" xref="A1.E16.m1.2.2.1.1.1.1.1.3">pmf</ci></apply><interval closure="open" id="A1.E16.m1.2.2.1.1.2.2.2.2.cmml" xref="A1.E16.m1.2.2.1.1.2.2.2.1"><ci id="A1.E16.m1.1.1.cmml" xref="A1.E16.m1.1.1">𝑛</ci><apply id="A1.E16.m1.2.2.1.1.2.2.2.1.1.cmml" xref="A1.E16.m1.2.2.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.2.2.1.1.2.2.2.1.1.1.cmml" xref="A1.E16.m1.2.2.1.1.2.2.2.1.1">subscript</csymbol><ci id="A1.E16.m1.2.2.1.1.2.2.2.1.1.2.cmml" xref="A1.E16.m1.2.2.1.1.2.2.2.1.1.2">𝜆</ci><ci id="A1.E16.m1.2.2.1.1.2.2.2.1.1.3.cmml" xref="A1.E16.m1.2.2.1.1.2.2.2.1.1.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.2c">\displaystyle=\sum_{n=0}^{\infty}\mathrm{Pr}\left[\sum_{j=1}^{n+1}c_{j}\equiv x%
\bmod 2^{16}\right]\cdot\mathrm{pmf}(n,\lambda_{i}),</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.2d">= ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_Pr [ ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n + 1 end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] ⋅ roman_pmf ( italic_n , italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.SSS4.p2.11">where <math alttext="\mathrm{Pr}\left[N_{i}=n\right]=\mathrm{pmf}(n,\lambda_{i})" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.10.m1.3"><semantics id="A1.SS2.SSS4.p2.10.m1.3a"><mrow id="A1.SS2.SSS4.p2.10.m1.3.3" xref="A1.SS2.SSS4.p2.10.m1.3.3.cmml"><mrow id="A1.SS2.SSS4.p2.10.m1.2.2.1" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.cmml"><mi id="A1.SS2.SSS4.p2.10.m1.2.2.1.3" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.3.cmml">Pr</mi><mo id="A1.SS2.SSS4.p2.10.m1.2.2.1.2" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.2.cmml"><mo id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.2" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.cmml"><msub id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.cmml"><mi id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.2" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.2.cmml">N</mi><mi id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.3" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.1" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.1.cmml">=</mo><mi id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.3" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.3.cmml">n</mi></mrow><mo id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.3" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.SS2.SSS4.p2.10.m1.3.3.3" xref="A1.SS2.SSS4.p2.10.m1.3.3.3.cmml">=</mo><mrow id="A1.SS2.SSS4.p2.10.m1.3.3.2" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.cmml"><mi id="A1.SS2.SSS4.p2.10.m1.3.3.2.3" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.3.cmml">pmf</mi><mo id="A1.SS2.SSS4.p2.10.m1.3.3.2.2" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.2.cmml">⁢</mo><mrow id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.2.cmml"><mo id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.2" stretchy="false" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.2.cmml">(</mo><mi id="A1.SS2.SSS4.p2.10.m1.1.1" xref="A1.SS2.SSS4.p2.10.m1.1.1.cmml">n</mi><mo id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.3" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.2.cmml">,</mo><msub id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.cmml"><mi id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.2" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.2.cmml">λ</mi><mi id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.3" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.4" stretchy="false" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.10.m1.3b"><apply id="A1.SS2.SSS4.p2.10.m1.3.3.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3"><eq id="A1.SS2.SSS4.p2.10.m1.3.3.3.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.3"></eq><apply id="A1.SS2.SSS4.p2.10.m1.2.2.1.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1"><times id="A1.SS2.SSS4.p2.10.m1.2.2.1.2.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.2"></times><ci id="A1.SS2.SSS4.p2.10.m1.2.2.1.3.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.3">Pr</ci><apply id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.2.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1"><csymbol cd="latexml" id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.2.1.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1"><eq id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.1.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.1"></eq><apply id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.1.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.2.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.2">𝑁</ci><ci id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.3.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.3.cmml" xref="A1.SS2.SSS4.p2.10.m1.2.2.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="A1.SS2.SSS4.p2.10.m1.3.3.2.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.2"><times id="A1.SS2.SSS4.p2.10.m1.3.3.2.2.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.2"></times><ci id="A1.SS2.SSS4.p2.10.m1.3.3.2.3.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.3">pmf</ci><interval closure="open" id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.2.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1"><ci id="A1.SS2.SSS4.p2.10.m1.1.1.cmml" xref="A1.SS2.SSS4.p2.10.m1.1.1">𝑛</ci><apply id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.1.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.2.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.2">𝜆</ci><ci id="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.3.cmml" xref="A1.SS2.SSS4.p2.10.m1.3.3.2.1.1.1.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.10.m1.3c">\mathrm{Pr}\left[N_{i}=n\right]=\mathrm{pmf}(n,\lambda_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.10.m1.3d">roman_Pr [ italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_n ] = roman_pmf ( italic_n , italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> follows from the fact that <math alttext="N_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p2.11.m2.1"><semantics id="A1.SS2.SSS4.p2.11.m2.1a"><msub id="A1.SS2.SSS4.p2.11.m2.1.1" xref="A1.SS2.SSS4.p2.11.m2.1.1.cmml"><mi id="A1.SS2.SSS4.p2.11.m2.1.1.2" xref="A1.SS2.SSS4.p2.11.m2.1.1.2.cmml">N</mi><mi id="A1.SS2.SSS4.p2.11.m2.1.1.3" xref="A1.SS2.SSS4.p2.11.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p2.11.m2.1b"><apply id="A1.SS2.SSS4.p2.11.m2.1.1.cmml" xref="A1.SS2.SSS4.p2.11.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p2.11.m2.1.1.1.cmml" xref="A1.SS2.SSS4.p2.11.m2.1.1">subscript</csymbol><ci id="A1.SS2.SSS4.p2.11.m2.1.1.2.cmml" xref="A1.SS2.SSS4.p2.11.m2.1.1.2">𝑁</ci><ci id="A1.SS2.SSS4.p2.11.m2.1.1.3.cmml" xref="A1.SS2.SSS4.p2.11.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p2.11.m2.1c">N_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p2.11.m2.1d">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is Poisson-distributed.
Substituting Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.Ex5" title="A.2.4. Per-Bucket (Linux) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.2.4</span></a> into Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.E2" title="In 4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a> yields</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\left\{\sum_{x\in G}\sum_{n=0}^{\infty}\mathrm{Pr}\left[\sum_{j=1}^{n+1}c_{j}%
\equiv x\bmod 2^{16}\right]\cdot\mathrm{pmf}(n,\lambda_{i})\right\}." class="ltx_Math" display="block" id="A1.E17.m1.5"><semantics id="A1.E17.m1.5a"><mrow id="A1.E17.m1.5.5.1" xref="A1.E17.m1.5.5.1.1.cmml"><mrow id="A1.E17.m1.5.5.1.1" xref="A1.E17.m1.5.5.1.1.cmml"><mrow id="A1.E17.m1.5.5.1.1.4" xref="A1.E17.m1.5.5.1.1.4.cmml"><mi id="A1.E17.m1.5.5.1.1.4.2" xref="A1.E17.m1.5.5.1.1.4.2.cmml">Pr</mi><mo id="A1.E17.m1.5.5.1.1.4.1" xref="A1.E17.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="A1.E17.m1.5.5.1.1.4.3.2" xref="A1.E17.m1.5.5.1.1.4.3.1.cmml"><mo id="A1.E17.m1.5.5.1.1.4.3.2.1" xref="A1.E17.m1.5.5.1.1.4.3.1.1.cmml">[</mo><mtext id="A1.E17.m1.3.3" xref="A1.E17.m1.3.3a.cmml">adv. guess</mtext><mo id="A1.E17.m1.5.5.1.1.4.3.2.2" xref="A1.E17.m1.5.5.1.1.4.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E17.m1.5.5.1.1.3" xref="A1.E17.m1.5.5.1.1.3.cmml">=</mo><mrow id="A1.E17.m1.5.5.1.1.2.2" xref="A1.E17.m1.5.5.1.1.2.3.cmml"><munder id="A1.E17.m1.5.5.1.1.1.1.1" xref="A1.E17.m1.5.5.1.1.1.1.1.cmml"><mi id="A1.E17.m1.5.5.1.1.1.1.1.2" xref="A1.E17.m1.5.5.1.1.1.1.1.2.cmml">max</mi><mrow id="A1.E17.m1.2.2.2" xref="A1.E17.m1.2.2.2.cmml"><mrow id="A1.E17.m1.2.2.2.2" xref="A1.E17.m1.2.2.2.2.cmml"><mi id="A1.E17.m1.2.2.2.2.3" xref="A1.E17.m1.2.2.2.2.3.cmml">G</mi><mo id="A1.E17.m1.2.2.2.2.2" xref="A1.E17.m1.2.2.2.2.2.cmml">⊂</mo><mrow id="A1.E17.m1.2.2.2.2.1.1" xref="A1.E17.m1.2.2.2.2.1.2.cmml"><mo id="A1.E17.m1.2.2.2.2.1.1.2" stretchy="false" xref="A1.E17.m1.2.2.2.2.1.2.1.cmml">[</mo><msup id="A1.E17.m1.2.2.2.2.1.1.1" xref="A1.E17.m1.2.2.2.2.1.1.1.cmml"><mn id="A1.E17.m1.2.2.2.2.1.1.1.2" xref="A1.E17.m1.2.2.2.2.1.1.1.2.cmml">2</mn><mn id="A1.E17.m1.2.2.2.2.1.1.1.3" xref="A1.E17.m1.2.2.2.2.1.1.1.3.cmml">16</mn></msup><mo id="A1.E17.m1.2.2.2.2.1.1.3" rspace="0.508em" stretchy="false" xref="A1.E17.m1.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E17.m1.2.2.2.3" rspace="0.508em" xref="A1.E17.m1.2.2.2.3.cmml">:</mo><mrow id="A1.E17.m1.2.2.2.4" xref="A1.E17.m1.2.2.2.4.cmml"><mrow id="A1.E17.m1.2.2.2.4.2.2" xref="A1.E17.m1.2.2.2.4.2.1.cmml"><mo id="A1.E17.m1.2.2.2.4.2.2.1" stretchy="false" xref="A1.E17.m1.2.2.2.4.2.1.1.cmml">|</mo><mi id="A1.E17.m1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.cmml">G</mi><mo id="A1.E17.m1.2.2.2.4.2.2.2" stretchy="false" xref="A1.E17.m1.2.2.2.4.2.1.1.cmml">|</mo></mrow><mo id="A1.E17.m1.2.2.2.4.1" xref="A1.E17.m1.2.2.2.4.1.cmml">=</mo><mi id="A1.E17.m1.2.2.2.4.3" xref="A1.E17.m1.2.2.2.4.3.cmml">g</mi></mrow></mrow></munder><mo id="A1.E17.m1.5.5.1.1.2.2a" xref="A1.E17.m1.5.5.1.1.2.3.cmml">⁡</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2" xref="A1.E17.m1.5.5.1.1.2.3.cmml"><mo id="A1.E17.m1.5.5.1.1.2.2.2.2" xref="A1.E17.m1.5.5.1.1.2.3.cmml">{</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.cmml"><munder id="A1.E17.m1.5.5.1.1.2.2.2.1.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.cmml"><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.3.2" lspace="0em" movablelimits="false" rspace="0em" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.2.cmml">∑</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.3.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.cmml"><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.2.cmml">x</mi><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.1.cmml">∈</mo><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.3.cmml">G</mi></mrow></munder><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.cmml"><munderover id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.cmml"><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.2" movablelimits="false" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.2.cmml">∑</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.cmml"><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.2.cmml">n</mi><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.1.cmml">=</mo><mn id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.3.cmml">0</mn></mrow><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.3" mathvariant="normal" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.3.cmml">∞</mi></munderover><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.cmml"><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.cmml"><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.cmml"><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.3.cmml">Pr</mi><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2.cmml"><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><munderover id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml"><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.2" lspace="0em" movablelimits="false" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.cmml"><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.cmml"><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.2.cmml">n</mi><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.1.cmml">+</mo><mn id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.3.cmml">1</mn></mrow></munderover><msub id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub></mrow><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.1.cmml">≡</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml">mod</mo><msup id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">2</mn><mn id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.3" rspace="0.055em" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.2" rspace="0.222em" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml">⋅</mo><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.3.cmml">pmf</mi></mrow><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.3.cmml">⁢</mo><mrow id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.2.cmml"><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.2" stretchy="false" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.2.cmml">(</mo><mi id="A1.E17.m1.4.4" xref="A1.E17.m1.4.4.cmml">n</mi><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.2.cmml">,</mo><msub id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.cmml"><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.2" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.2.cmml">λ</mi><mi id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.3" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.4" stretchy="false" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E17.m1.5.5.1.1.2.2.2.3" xref="A1.E17.m1.5.5.1.1.2.3.cmml">}</mo></mrow></mrow></mrow><mo id="A1.E17.m1.5.5.1.2" lspace="0em" xref="A1.E17.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.5b"><apply id="A1.E17.m1.5.5.1.1.cmml" xref="A1.E17.m1.5.5.1"><eq id="A1.E17.m1.5.5.1.1.3.cmml" xref="A1.E17.m1.5.5.1.1.3"></eq><apply id="A1.E17.m1.5.5.1.1.4.cmml" xref="A1.E17.m1.5.5.1.1.4"><times id="A1.E17.m1.5.5.1.1.4.1.cmml" xref="A1.E17.m1.5.5.1.1.4.1"></times><ci id="A1.E17.m1.5.5.1.1.4.2.cmml" xref="A1.E17.m1.5.5.1.1.4.2">Pr</ci><apply id="A1.E17.m1.5.5.1.1.4.3.1.cmml" xref="A1.E17.m1.5.5.1.1.4.3.2"><csymbol cd="latexml" id="A1.E17.m1.5.5.1.1.4.3.1.1.cmml" xref="A1.E17.m1.5.5.1.1.4.3.2.1">delimited-[]</csymbol><ci id="A1.E17.m1.3.3a.cmml" xref="A1.E17.m1.3.3"><mtext id="A1.E17.m1.3.3.cmml" xref="A1.E17.m1.3.3">adv. guess</mtext></ci></apply></apply><apply id="A1.E17.m1.5.5.1.1.2.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2"><apply id="A1.E17.m1.5.5.1.1.1.1.1.cmml" xref="A1.E17.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E17.m1.5.5.1.1.1.1.1">subscript</csymbol><max id="A1.E17.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.E17.m1.5.5.1.1.1.1.1.2"></max><apply id="A1.E17.m1.2.2.2.cmml" xref="A1.E17.m1.2.2.2"><ci id="A1.E17.m1.2.2.2.3.cmml" xref="A1.E17.m1.2.2.2.3">:</ci><apply id="A1.E17.m1.2.2.2.2.cmml" xref="A1.E17.m1.2.2.2.2"><subset id="A1.E17.m1.2.2.2.2.2.cmml" xref="A1.E17.m1.2.2.2.2.2"></subset><ci id="A1.E17.m1.2.2.2.2.3.cmml" xref="A1.E17.m1.2.2.2.2.3">𝐺</ci><apply id="A1.E17.m1.2.2.2.2.1.2.cmml" xref="A1.E17.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E17.m1.2.2.2.2.1.2.1.cmml" xref="A1.E17.m1.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.E17.m1.2.2.2.2.1.1.1.cmml" xref="A1.E17.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.2.2.1.1.1.1.cmml" xref="A1.E17.m1.2.2.2.2.1.1.1">superscript</csymbol><cn id="A1.E17.m1.2.2.2.2.1.1.1.2.cmml" type="integer" xref="A1.E17.m1.2.2.2.2.1.1.1.2">2</cn><cn id="A1.E17.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="A1.E17.m1.2.2.2.2.1.1.1.3">16</cn></apply></apply></apply><apply id="A1.E17.m1.2.2.2.4.cmml" xref="A1.E17.m1.2.2.2.4"><eq id="A1.E17.m1.2.2.2.4.1.cmml" xref="A1.E17.m1.2.2.2.4.1"></eq><apply id="A1.E17.m1.2.2.2.4.2.1.cmml" xref="A1.E17.m1.2.2.2.4.2.2"><abs id="A1.E17.m1.2.2.2.4.2.1.1.cmml" xref="A1.E17.m1.2.2.2.4.2.2.1"></abs><ci id="A1.E17.m1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1">𝐺</ci></apply><ci id="A1.E17.m1.2.2.2.4.3.cmml" xref="A1.E17.m1.2.2.2.4.3">𝑔</ci></apply></apply></apply><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1"><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3">subscript</csymbol><sum id="A1.E17.m1.5.5.1.1.2.2.2.1.3.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.2"></sum><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.3"><in id="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.1"></in><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.2">𝑥</ci><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.3.3.3">𝐺</ci></apply></apply><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2"><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3">superscript</csymbol><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3">subscript</csymbol><sum id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.2"></sum><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3"><eq id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.1"></eq><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.2">𝑛</ci><cn id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.2.3.3">0</cn></apply></apply><infinity id="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.3.3"></infinity></apply><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2"><times id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.3"></times><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1"><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.2">⋅</ci><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1"><times id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.2"></times><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.3">Pr</ci><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1"><equivalent id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.1"></equivalent><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2"><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.2"></sum><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3"><eq id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.1"></eq><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.2">𝑗</ci><cn id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3"><plus id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.1"></plus><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.2">𝑛</ci><cn id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.1.3.3">1</cn></apply></apply><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></apply><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.1">modulo</csymbol><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><cn id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.2">2</cn><cn id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.1.3.3.3">16</cn></apply></apply></apply></apply></apply><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.1.1.1.3">pmf</ci></apply><interval closure="open" id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1"><ci id="A1.E17.m1.4.4.cmml" xref="A1.E17.m1.4.4">𝑛</ci><apply id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.1.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1">subscript</csymbol><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.2.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.2">𝜆</ci><ci id="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.3.cmml" xref="A1.E17.m1.5.5.1.1.2.2.2.1.2.2.2.1.1.3">𝑖</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.5c">\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\left\{\sum_{x\in G}\sum_{n=0}^{\infty}\mathrm{Pr}\left[\sum_{j=1}^{n+1}c_{j}%
\equiv x\bmod 2^{16}\right]\cdot\mathrm{pmf}(n,\lambda_{i})\right\}.</annotation><annotation encoding="application/x-llamapun" id="A1.E17.m1.5d">roman_Pr [ adv. guess ] = roman_max start_POSTSUBSCRIPT italic_G ⊂ [ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] : | italic_G | = italic_g end_POSTSUBSCRIPT { ∑ start_POSTSUBSCRIPT italic_x ∈ italic_G end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_n = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT roman_Pr [ ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n + 1 end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] ⋅ roman_pmf ( italic_n , italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.SSS4.p3">
<p class="ltx_p" id="A1.SS2.SSS4.p3.9">Unlike globally incrementing selection where each <math alttext="c_{j}=1" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.1.m1.1"><semantics id="A1.SS2.SSS4.p3.1.m1.1a"><mrow id="A1.SS2.SSS4.p3.1.m1.1.1" xref="A1.SS2.SSS4.p3.1.m1.1.1.cmml"><msub id="A1.SS2.SSS4.p3.1.m1.1.1.2" xref="A1.SS2.SSS4.p3.1.m1.1.1.2.cmml"><mi id="A1.SS2.SSS4.p3.1.m1.1.1.2.2" xref="A1.SS2.SSS4.p3.1.m1.1.1.2.2.cmml">c</mi><mi id="A1.SS2.SSS4.p3.1.m1.1.1.2.3" xref="A1.SS2.SSS4.p3.1.m1.1.1.2.3.cmml">j</mi></msub><mo id="A1.SS2.SSS4.p3.1.m1.1.1.1" xref="A1.SS2.SSS4.p3.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS2.SSS4.p3.1.m1.1.1.3" xref="A1.SS2.SSS4.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.1.m1.1b"><apply id="A1.SS2.SSS4.p3.1.m1.1.1.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1"><eq id="A1.SS2.SSS4.p3.1.m1.1.1.1.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1.1"></eq><apply id="A1.SS2.SSS4.p3.1.m1.1.1.2.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.1.m1.1.1.2.1.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS2.SSS4.p3.1.m1.1.1.2.2.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1.2.2">𝑐</ci><ci id="A1.SS2.SSS4.p3.1.m1.1.1.2.3.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1.2.3">𝑗</ci></apply><cn id="A1.SS2.SSS4.p3.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.SSS4.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.1.m1.1c">c_{j}=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 1</annotation></semantics></math>, each per-bucket increment <math alttext="c_{j}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.2.m2.1"><semantics id="A1.SS2.SSS4.p3.2.m2.1a"><msub id="A1.SS2.SSS4.p3.2.m2.1.1" xref="A1.SS2.SSS4.p3.2.m2.1.1.cmml"><mi id="A1.SS2.SSS4.p3.2.m2.1.1.2" xref="A1.SS2.SSS4.p3.2.m2.1.1.2.cmml">c</mi><mi id="A1.SS2.SSS4.p3.2.m2.1.1.3" xref="A1.SS2.SSS4.p3.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.2.m2.1b"><apply id="A1.SS2.SSS4.p3.2.m2.1.1.cmml" xref="A1.SS2.SSS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.2.m2.1.1.1.cmml" xref="A1.SS2.SSS4.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.SSS4.p3.2.m2.1.1.2.cmml" xref="A1.SS2.SSS4.p3.2.m2.1.1.2">𝑐</ci><ci id="A1.SS2.SSS4.p3.2.m2.1.1.3.cmml" xref="A1.SS2.SSS4.p3.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.2.m2.1c">c_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is chosen uniformly at random from a range <math alttext="\{1,\ldots,\Delta_{j}\}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.3.m3.3"><semantics id="A1.SS2.SSS4.p3.3.m3.3a"><mrow id="A1.SS2.SSS4.p3.3.m3.3.3.1" xref="A1.SS2.SSS4.p3.3.m3.3.3.2.cmml"><mo id="A1.SS2.SSS4.p3.3.m3.3.3.1.2" stretchy="false" xref="A1.SS2.SSS4.p3.3.m3.3.3.2.cmml">{</mo><mn id="A1.SS2.SSS4.p3.3.m3.1.1" xref="A1.SS2.SSS4.p3.3.m3.1.1.cmml">1</mn><mo id="A1.SS2.SSS4.p3.3.m3.3.3.1.3" xref="A1.SS2.SSS4.p3.3.m3.3.3.2.cmml">,</mo><mi id="A1.SS2.SSS4.p3.3.m3.2.2" mathvariant="normal" xref="A1.SS2.SSS4.p3.3.m3.2.2.cmml">…</mi><mo id="A1.SS2.SSS4.p3.3.m3.3.3.1.4" xref="A1.SS2.SSS4.p3.3.m3.3.3.2.cmml">,</mo><msub id="A1.SS2.SSS4.p3.3.m3.3.3.1.1" xref="A1.SS2.SSS4.p3.3.m3.3.3.1.1.cmml"><mi id="A1.SS2.SSS4.p3.3.m3.3.3.1.1.2" mathvariant="normal" xref="A1.SS2.SSS4.p3.3.m3.3.3.1.1.2.cmml">Δ</mi><mi id="A1.SS2.SSS4.p3.3.m3.3.3.1.1.3" xref="A1.SS2.SSS4.p3.3.m3.3.3.1.1.3.cmml">j</mi></msub><mo id="A1.SS2.SSS4.p3.3.m3.3.3.1.5" stretchy="false" xref="A1.SS2.SSS4.p3.3.m3.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.3.m3.3b"><set id="A1.SS2.SSS4.p3.3.m3.3.3.2.cmml" xref="A1.SS2.SSS4.p3.3.m3.3.3.1"><cn id="A1.SS2.SSS4.p3.3.m3.1.1.cmml" type="integer" xref="A1.SS2.SSS4.p3.3.m3.1.1">1</cn><ci id="A1.SS2.SSS4.p3.3.m3.2.2.cmml" xref="A1.SS2.SSS4.p3.3.m3.2.2">…</ci><apply id="A1.SS2.SSS4.p3.3.m3.3.3.1.1.cmml" xref="A1.SS2.SSS4.p3.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.3.m3.3.3.1.1.1.cmml" xref="A1.SS2.SSS4.p3.3.m3.3.3.1.1">subscript</csymbol><ci id="A1.SS2.SSS4.p3.3.m3.3.3.1.1.2.cmml" xref="A1.SS2.SSS4.p3.3.m3.3.3.1.1.2">Δ</ci><ci id="A1.SS2.SSS4.p3.3.m3.3.3.1.1.3.cmml" xref="A1.SS2.SSS4.p3.3.m3.3.3.1.1.3">𝑗</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.3.m3.3c">\{1,\ldots,\Delta_{j}\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.3.m3.3d">{ 1 , … , roman_Δ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT }</annotation></semantics></math>, where—as for our analysis of per-bucket collision probabilities in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS3" title="A.1.3. Per-Bucket (Linux) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.1.3</span></a>—<math alttext="\Delta_{j}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.4.m4.1"><semantics id="A1.SS2.SSS4.p3.4.m4.1a"><msub id="A1.SS2.SSS4.p3.4.m4.1.1" xref="A1.SS2.SSS4.p3.4.m4.1.1.cmml"><mi id="A1.SS2.SSS4.p3.4.m4.1.1.2" mathvariant="normal" xref="A1.SS2.SSS4.p3.4.m4.1.1.2.cmml">Δ</mi><mi id="A1.SS2.SSS4.p3.4.m4.1.1.3" xref="A1.SS2.SSS4.p3.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.4.m4.1b"><apply id="A1.SS2.SSS4.p3.4.m4.1.1.cmml" xref="A1.SS2.SSS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.4.m4.1.1.1.cmml" xref="A1.SS2.SSS4.p3.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.SSS4.p3.4.m4.1.1.2.cmml" xref="A1.SS2.SSS4.p3.4.m4.1.1.2">Δ</ci><ci id="A1.SS2.SSS4.p3.4.m4.1.1.3.cmml" xref="A1.SS2.SSS4.p3.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.4.m4.1c">\Delta_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.4.m4.1d">roman_Δ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is an exponentially distributed random variable with mean <math alttext="t/\lambda_{i}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.5.m5.1"><semantics id="A1.SS2.SSS4.p3.5.m5.1a"><mrow id="A1.SS2.SSS4.p3.5.m5.1.1" xref="A1.SS2.SSS4.p3.5.m5.1.1.cmml"><mi id="A1.SS2.SSS4.p3.5.m5.1.1.2" xref="A1.SS2.SSS4.p3.5.m5.1.1.2.cmml">t</mi><mo id="A1.SS2.SSS4.p3.5.m5.1.1.1" xref="A1.SS2.SSS4.p3.5.m5.1.1.1.cmml">/</mo><msub id="A1.SS2.SSS4.p3.5.m5.1.1.3" xref="A1.SS2.SSS4.p3.5.m5.1.1.3.cmml"><mi id="A1.SS2.SSS4.p3.5.m5.1.1.3.2" xref="A1.SS2.SSS4.p3.5.m5.1.1.3.2.cmml">λ</mi><mi id="A1.SS2.SSS4.p3.5.m5.1.1.3.3" xref="A1.SS2.SSS4.p3.5.m5.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.5.m5.1b"><apply id="A1.SS2.SSS4.p3.5.m5.1.1.cmml" xref="A1.SS2.SSS4.p3.5.m5.1.1"><divide id="A1.SS2.SSS4.p3.5.m5.1.1.1.cmml" xref="A1.SS2.SSS4.p3.5.m5.1.1.1"></divide><ci id="A1.SS2.SSS4.p3.5.m5.1.1.2.cmml" xref="A1.SS2.SSS4.p3.5.m5.1.1.2">𝑡</ci><apply id="A1.SS2.SSS4.p3.5.m5.1.1.3.cmml" xref="A1.SS2.SSS4.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.5.m5.1.1.3.1.cmml" xref="A1.SS2.SSS4.p3.5.m5.1.1.3">subscript</csymbol><ci id="A1.SS2.SSS4.p3.5.m5.1.1.3.2.cmml" xref="A1.SS2.SSS4.p3.5.m5.1.1.3.2">𝜆</ci><ci id="A1.SS2.SSS4.p3.5.m5.1.1.3.3.cmml" xref="A1.SS2.SSS4.p3.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.5.m5.1c">t/\lambda_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.5.m5.1d">italic_t / italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="t=3" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.6.m6.1"><semantics id="A1.SS2.SSS4.p3.6.m6.1a"><mrow id="A1.SS2.SSS4.p3.6.m6.1.1" xref="A1.SS2.SSS4.p3.6.m6.1.1.cmml"><mi id="A1.SS2.SSS4.p3.6.m6.1.1.2" xref="A1.SS2.SSS4.p3.6.m6.1.1.2.cmml">t</mi><mo id="A1.SS2.SSS4.p3.6.m6.1.1.1" xref="A1.SS2.SSS4.p3.6.m6.1.1.1.cmml">=</mo><mn id="A1.SS2.SSS4.p3.6.m6.1.1.3" xref="A1.SS2.SSS4.p3.6.m6.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.6.m6.1b"><apply id="A1.SS2.SSS4.p3.6.m6.1.1.cmml" xref="A1.SS2.SSS4.p3.6.m6.1.1"><eq id="A1.SS2.SSS4.p3.6.m6.1.1.1.cmml" xref="A1.SS2.SSS4.p3.6.m6.1.1.1"></eq><ci id="A1.SS2.SSS4.p3.6.m6.1.1.2.cmml" xref="A1.SS2.SSS4.p3.6.m6.1.1.2">𝑡</ci><cn id="A1.SS2.SSS4.p3.6.m6.1.1.3.cmml" type="integer" xref="A1.SS2.SSS4.p3.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.6.m6.1c">t=3</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.6.m6.1d">italic_t = 3</annotation></semantics></math> is the number of system ticks per unit time.
This again makes formal analysis difficult; we thus use simulations to estimate <math alttext="\mathrm{Pr}\left[\sum_{j=1}^{n+1}c_{j}\equiv x\bmod 2^{16}\right]" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.7.m7.1"><semantics id="A1.SS2.SSS4.p3.7.m7.1a"><mrow id="A1.SS2.SSS4.p3.7.m7.1.1" xref="A1.SS2.SSS4.p3.7.m7.1.1.cmml"><mi id="A1.SS2.SSS4.p3.7.m7.1.1.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.3.cmml">Pr</mi><mo id="A1.SS2.SSS4.p3.7.m7.1.1.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.SSS4.p3.7.m7.1.1.1.1" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.2.cmml"><mo id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.2.1.cmml">[</mo><mrow id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.cmml"><mrow id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.cmml"><msubsup id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.cmml"><mo id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.2" lspace="0em" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.cmml"><mi id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.2.cmml">j</mi><mo id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.1" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.cmml"><mi id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.2.cmml">n</mi><mo id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.1" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.1.cmml">+</mo><mn id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.3.cmml">1</mn></mrow></msubsup><msub id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.cmml"><mi id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.3.cmml">j</mi></msub></mrow><mo id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.1" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.1.cmml">≡</mo><mrow id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.cmml"><mi id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.2.cmml">x</mi><mo id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.1" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.1.cmml">mod</mo><msup id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.cmml"><mn id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.2" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.2.cmml">2</mn><mn id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.3.cmml">16</mn></msup></mrow></mrow><mo id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.3" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.7.m7.1b"><apply id="A1.SS2.SSS4.p3.7.m7.1.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1"><times id="A1.SS2.SSS4.p3.7.m7.1.1.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.2"></times><ci id="A1.SS2.SSS4.p3.7.m7.1.1.3.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.3">Pr</ci><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.SSS4.p3.7.m7.1.1.1.2.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1"><equivalent id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.1"></equivalent><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2"><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1">superscript</csymbol><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1">subscript</csymbol><sum id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.2"></sum><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3"><eq id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.1"></eq><ci id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.2">𝑗</ci><cn id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3"><plus id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.1"></plus><ci id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.2">𝑛</ci><cn id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.3.cmml" type="integer" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.1.3.3">1</cn></apply></apply><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.2">𝑐</ci><ci id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.3.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.2.2.3">𝑗</ci></apply></apply><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.1">modulo</csymbol><ci id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.2.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.2">𝑥</ci><apply id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.1.cmml" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3">superscript</csymbol><cn id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.2.cmml" type="integer" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.2">2</cn><cn id="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.SS2.SSS4.p3.7.m7.1.1.1.1.1.3.3.3">16</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.7.m7.1c">\mathrm{Pr}\left[\sum_{j=1}^{n+1}c_{j}\equiv x\bmod 2^{16}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.7.m7.1d">roman_Pr [ ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n + 1 end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ≡ italic_x roman_mod 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ]</annotation></semantics></math> via sampling and then compute the overall probability of an adversarial guess using Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E17" title="In A.2.4. Per-Bucket (Linux) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">17</span></a>.
<span class="ltx_ERROR undefined" id="A1.SS2.SSS4.p3.9.1">\added</span>In Figs. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.F7" title="Figure 7 ‣ 4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.F10" title="Figure 10 ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">10</span></a>, we plot these adversarial guess probabilities for <math alttext="r=2^{11}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.8.m8.1"><semantics id="A1.SS2.SSS4.p3.8.m8.1a"><mrow id="A1.SS2.SSS4.p3.8.m8.1.1" xref="A1.SS2.SSS4.p3.8.m8.1.1.cmml"><mi id="A1.SS2.SSS4.p3.8.m8.1.1.2" xref="A1.SS2.SSS4.p3.8.m8.1.1.2.cmml">r</mi><mo id="A1.SS2.SSS4.p3.8.m8.1.1.1" xref="A1.SS2.SSS4.p3.8.m8.1.1.1.cmml">=</mo><msup id="A1.SS2.SSS4.p3.8.m8.1.1.3" xref="A1.SS2.SSS4.p3.8.m8.1.1.3.cmml"><mn id="A1.SS2.SSS4.p3.8.m8.1.1.3.2" xref="A1.SS2.SSS4.p3.8.m8.1.1.3.2.cmml">2</mn><mn id="A1.SS2.SSS4.p3.8.m8.1.1.3.3" xref="A1.SS2.SSS4.p3.8.m8.1.1.3.3.cmml">11</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.8.m8.1b"><apply id="A1.SS2.SSS4.p3.8.m8.1.1.cmml" xref="A1.SS2.SSS4.p3.8.m8.1.1"><eq id="A1.SS2.SSS4.p3.8.m8.1.1.1.cmml" xref="A1.SS2.SSS4.p3.8.m8.1.1.1"></eq><ci id="A1.SS2.SSS4.p3.8.m8.1.1.2.cmml" xref="A1.SS2.SSS4.p3.8.m8.1.1.2">𝑟</ci><apply id="A1.SS2.SSS4.p3.8.m8.1.1.3.cmml" xref="A1.SS2.SSS4.p3.8.m8.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.8.m8.1.1.3.1.cmml" xref="A1.SS2.SSS4.p3.8.m8.1.1.3">superscript</csymbol><cn id="A1.SS2.SSS4.p3.8.m8.1.1.3.2.cmml" type="integer" xref="A1.SS2.SSS4.p3.8.m8.1.1.3.2">2</cn><cn id="A1.SS2.SSS4.p3.8.m8.1.1.3.3.cmml" type="integer" xref="A1.SS2.SSS4.p3.8.m8.1.1.3.3">11</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.8.m8.1c">r=2^{11}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.8.m8.1d">italic_r = 2 start_POSTSUPERSCRIPT 11 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="r=2^{18}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.9.m9.1"><semantics id="A1.SS2.SSS4.p3.9.m9.1a"><mrow id="A1.SS2.SSS4.p3.9.m9.1.1" xref="A1.SS2.SSS4.p3.9.m9.1.1.cmml"><mi id="A1.SS2.SSS4.p3.9.m9.1.1.2" xref="A1.SS2.SSS4.p3.9.m9.1.1.2.cmml">r</mi><mo id="A1.SS2.SSS4.p3.9.m9.1.1.1" xref="A1.SS2.SSS4.p3.9.m9.1.1.1.cmml">=</mo><msup id="A1.SS2.SSS4.p3.9.m9.1.1.3" xref="A1.SS2.SSS4.p3.9.m9.1.1.3.cmml"><mn id="A1.SS2.SSS4.p3.9.m9.1.1.3.2" xref="A1.SS2.SSS4.p3.9.m9.1.1.3.2.cmml">2</mn><mn id="A1.SS2.SSS4.p3.9.m9.1.1.3.3" xref="A1.SS2.SSS4.p3.9.m9.1.1.3.3.cmml">18</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.9.m9.1b"><apply id="A1.SS2.SSS4.p3.9.m9.1.1.cmml" xref="A1.SS2.SSS4.p3.9.m9.1.1"><eq id="A1.SS2.SSS4.p3.9.m9.1.1.1.cmml" xref="A1.SS2.SSS4.p3.9.m9.1.1.1"></eq><ci id="A1.SS2.SSS4.p3.9.m9.1.1.2.cmml" xref="A1.SS2.SSS4.p3.9.m9.1.1.2">𝑟</ci><apply id="A1.SS2.SSS4.p3.9.m9.1.1.3.cmml" xref="A1.SS2.SSS4.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS4.p3.9.m9.1.1.3.1.cmml" xref="A1.SS2.SSS4.p3.9.m9.1.1.3">superscript</csymbol><cn id="A1.SS2.SSS4.p3.9.m9.1.1.3.2.cmml" type="integer" xref="A1.SS2.SSS4.p3.9.m9.1.1.3.2">2</cn><cn id="A1.SS2.SSS4.p3.9.m9.1.1.3.3.cmml" type="integer" xref="A1.SS2.SSS4.p3.9.m9.1.1.3.3">18</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.9.m9.1c">r=2^{18}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.9.m9.1d">italic_r = 2 start_POSTSUPERSCRIPT 18 end_POSTSUPERSCRIPT</annotation></semantics></math> buckets since these are Linux’s minimum and maximum number of buckets, respectively.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.5. </span>PRNG (searchable queue of size <math alttext="k" class="ltx_Math" display="inline" id="A1.SS2.SSS5.1.m1.1"><semantics id="A1.SS2.SSS5.1.m1.1b"><mi id="A1.SS2.SSS5.1.m1.1.1" xref="A1.SS2.SSS5.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS5.1.m1.1c"><ci id="A1.SS2.SSS5.1.m1.1.1.cmml" xref="A1.SS2.SSS5.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS5.1.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS5.1.m1.1e">italic_k</annotation></semantics></math>)</h4>
<div class="ltx_para" id="A1.SS2.SSS5.p1">
<p class="ltx_p" id="A1.SS2.SSS5.p1.5">We again assume (as in our correctness analysis in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS4" title="A.1.4. PRNG (searchable queue of size 𝑘) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.1.4</span></a>) that the PRNG algorithm in use sufficiently approximates a uniform distribution over all <math alttext="2^{16}" class="ltx_Math" display="inline" id="A1.SS2.SSS5.p1.1.m1.1"><semantics id="A1.SS2.SSS5.p1.1.m1.1a"><msup id="A1.SS2.SSS5.p1.1.m1.1.1" xref="A1.SS2.SSS5.p1.1.m1.1.1.cmml"><mn id="A1.SS2.SSS5.p1.1.m1.1.1.2" xref="A1.SS2.SSS5.p1.1.m1.1.1.2.cmml">2</mn><mn id="A1.SS2.SSS5.p1.1.m1.1.1.3" xref="A1.SS2.SSS5.p1.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS5.p1.1.m1.1b"><apply id="A1.SS2.SSS5.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS5.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSS5.p1.1.m1.1.1">superscript</csymbol><cn id="A1.SS2.SSS5.p1.1.m1.1.1.2.cmml" type="integer" xref="A1.SS2.SSS5.p1.1.m1.1.1.2">2</cn><cn id="A1.SS2.SSS5.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.SSS5.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS5.p1.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS5.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> IPIDs.
We additionally assume that, in the worst case, the adversary knows the IPIDs of the last <math alttext="k" class="ltx_Math" display="inline" id="A1.SS2.SSS5.p1.2.m2.1"><semantics id="A1.SS2.SSS5.p1.2.m2.1a"><mi id="A1.SS2.SSS5.p1.2.m2.1.1" xref="A1.SS2.SSS5.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS5.p1.2.m2.1b"><ci id="A1.SS2.SSS5.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS5.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS5.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS5.p1.2.m2.1d">italic_k</annotation></semantics></math> packets <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS5.p1.3.m3.1"><semantics id="A1.SS2.SSS5.p1.3.m3.1a"><mi id="A1.SS2.SSS5.p1.3.m3.1.1" xref="A1.SS2.SSS5.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS5.p1.3.m3.1b"><ci id="A1.SS2.SSS5.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS5.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS5.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS5.p1.3.m3.1d">italic_S</annotation></semantics></math> sent; i.e., it knows which IPIDs are in the searchable queue.
It is easy to see that, regardless of the rate <math alttext="\lambda" class="ltx_Math" display="inline" id="A1.SS2.SSS5.p1.4.m4.1"><semantics id="A1.SS2.SSS5.p1.4.m4.1a"><mi id="A1.SS2.SSS5.p1.4.m4.1.1" xref="A1.SS2.SSS5.p1.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS5.p1.4.m4.1b"><ci id="A1.SS2.SSS5.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS5.p1.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS5.p1.4.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS5.p1.4.m4.1d">italic_λ</annotation></semantics></math>, the probability that the next IPID is <math alttext="x" class="ltx_Math" display="inline" id="A1.SS2.SSS5.p1.5.m5.1"><semantics id="A1.SS2.SSS5.p1.5.m5.1a"><mi id="A1.SS2.SSS5.p1.5.m5.1.1" xref="A1.SS2.SSS5.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS5.p1.5.m5.1b"><ci id="A1.SS2.SSS5.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS5.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS5.p1.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS5.p1.5.m5.1d">italic_x</annotation></semantics></math> is</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(18)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{next IPID}=x\right]=\left\{\begin{array}[]{ll}0&amp;\text{%
if $x\in$ queue};\\
\frac{1}{2^{16}-k}&amp;\text{otherwise}.\end{array}\right." class="ltx_Math" display="block" id="A1.E18.m1.3"><semantics id="A1.E18.m1.3a"><mrow id="A1.E18.m1.3.3" xref="A1.E18.m1.3.3.cmml"><mrow id="A1.E18.m1.3.3.1" xref="A1.E18.m1.3.3.1.cmml"><mi id="A1.E18.m1.3.3.1.3" xref="A1.E18.m1.3.3.1.3.cmml">Pr</mi><mo id="A1.E18.m1.3.3.1.2" xref="A1.E18.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.3.3.1.1.1" xref="A1.E18.m1.3.3.1.1.2.cmml"><mo id="A1.E18.m1.3.3.1.1.1.2" xref="A1.E18.m1.3.3.1.1.2.1.cmml">[</mo><mrow id="A1.E18.m1.3.3.1.1.1.1" xref="A1.E18.m1.3.3.1.1.1.1.cmml"><mtext id="A1.E18.m1.3.3.1.1.1.1.2" xref="A1.E18.m1.3.3.1.1.1.1.2a.cmml">next IPID</mtext><mo id="A1.E18.m1.3.3.1.1.1.1.1" xref="A1.E18.m1.3.3.1.1.1.1.1.cmml">=</mo><mi id="A1.E18.m1.3.3.1.1.1.1.3" xref="A1.E18.m1.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E18.m1.3.3.1.1.1.3" xref="A1.E18.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E18.m1.3.3.2" xref="A1.E18.m1.3.3.2.cmml">=</mo><mrow id="A1.E18.m1.3.3.3.2" xref="A1.E18.m1.3.3.3.1.cmml"><mo id="A1.E18.m1.3.3.3.2.1" xref="A1.E18.m1.3.3.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="A1.E18.m1.2.2" rowspacing="0pt" xref="A1.E18.m1.2.2.cmml"><mtr id="A1.E18.m1.2.2a" xref="A1.E18.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.2.2b" xref="A1.E18.m1.2.2.cmml"><mn id="A1.E18.m1.1.1.1.2.1" xref="A1.E18.m1.1.1.1.2.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.2.2c" xref="A1.E18.m1.2.2.cmml"><mrow id="A1.E18.m1.1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.1.1.1c.cmml"><mrow id="A1.E18.m1.1.1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.1c.cmml"><mtext id="A1.E18.m1.1.1.1.1.1.1.1a" xref="A1.E18.m1.1.1.1.1.1.1.1a.cmml">if </mtext><mrow id="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.2" xref="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml">x</mi><mo id="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml">∈</mo><mi id="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.3" xref="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><mtext id="A1.E18.m1.1.1.1.1.1.1.1b" xref="A1.E18.m1.1.1.1.1.1.1.1a.cmml"> queue</mtext></mrow><mo id="A1.E18.m1.1.1.1.1.1.3.1" xref="A1.E18.m1.1.1.1.1.1.1.1c.cmml">;</mo></mrow></mtd></mtr><mtr id="A1.E18.m1.2.2d" xref="A1.E18.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.2.2e" xref="A1.E18.m1.2.2.cmml"><mstyle displaystyle="false" id="A1.E18.m1.2.2.2.2.1" xref="A1.E18.m1.2.2.2.2.1.cmml"><mfrac id="A1.E18.m1.2.2.2.2.1a" xref="A1.E18.m1.2.2.2.2.1.cmml"><mn id="A1.E18.m1.2.2.2.2.1.2" xref="A1.E18.m1.2.2.2.2.1.2.cmml">1</mn><mrow id="A1.E18.m1.2.2.2.2.1.3" xref="A1.E18.m1.2.2.2.2.1.3.cmml"><msup id="A1.E18.m1.2.2.2.2.1.3.2" xref="A1.E18.m1.2.2.2.2.1.3.2.cmml"><mn id="A1.E18.m1.2.2.2.2.1.3.2.2" xref="A1.E18.m1.2.2.2.2.1.3.2.2.cmml">2</mn><mn id="A1.E18.m1.2.2.2.2.1.3.2.3" xref="A1.E18.m1.2.2.2.2.1.3.2.3.cmml">16</mn></msup><mo id="A1.E18.m1.2.2.2.2.1.3.1" xref="A1.E18.m1.2.2.2.2.1.3.1.cmml">−</mo><mi id="A1.E18.m1.2.2.2.2.1.3.3" xref="A1.E18.m1.2.2.2.2.1.3.3.cmml">k</mi></mrow></mfrac></mstyle></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E18.m1.2.2f" xref="A1.E18.m1.2.2.cmml"><mrow id="A1.E18.m1.2.2.2.1.1.3" xref="A1.E18.m1.2.2.2.1.1.1a.cmml"><mtext id="A1.E18.m1.2.2.2.1.1.1" xref="A1.E18.m1.2.2.2.1.1.1.cmml">otherwise</mtext><mo id="A1.E18.m1.2.2.2.1.1.3.1" lspace="0em" xref="A1.E18.m1.2.2.2.1.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable><mi id="A1.E18.m1.3.3.3.2.2" xref="A1.E18.m1.3.3.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.3b"><apply id="A1.E18.m1.3.3.cmml" xref="A1.E18.m1.3.3"><eq id="A1.E18.m1.3.3.2.cmml" xref="A1.E18.m1.3.3.2"></eq><apply id="A1.E18.m1.3.3.1.cmml" xref="A1.E18.m1.3.3.1"><times id="A1.E18.m1.3.3.1.2.cmml" xref="A1.E18.m1.3.3.1.2"></times><ci id="A1.E18.m1.3.3.1.3.cmml" xref="A1.E18.m1.3.3.1.3">Pr</ci><apply id="A1.E18.m1.3.3.1.1.2.cmml" xref="A1.E18.m1.3.3.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.3.3.1.1.2.1.cmml" xref="A1.E18.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="A1.E18.m1.3.3.1.1.1.1.cmml" xref="A1.E18.m1.3.3.1.1.1.1"><eq id="A1.E18.m1.3.3.1.1.1.1.1.cmml" xref="A1.E18.m1.3.3.1.1.1.1.1"></eq><ci id="A1.E18.m1.3.3.1.1.1.1.2a.cmml" xref="A1.E18.m1.3.3.1.1.1.1.2"><mtext id="A1.E18.m1.3.3.1.1.1.1.2.cmml" xref="A1.E18.m1.3.3.1.1.1.1.2">next IPID</mtext></ci><ci id="A1.E18.m1.3.3.1.1.1.1.3.cmml" xref="A1.E18.m1.3.3.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="A1.E18.m1.3.3.3.1.cmml" xref="A1.E18.m1.3.3.3.2"><csymbol cd="latexml" id="A1.E18.m1.3.3.3.1.1.cmml" xref="A1.E18.m1.3.3.3.2.1">cases</csymbol><matrix id="A1.E18.m1.2.2.cmml" xref="A1.E18.m1.2.2"><matrixrow id="A1.E18.m1.2.2a.cmml" xref="A1.E18.m1.2.2"><cn id="A1.E18.m1.1.1.1.2.1.cmml" type="integer" xref="A1.E18.m1.1.1.1.2.1">0</cn><ci id="A1.E18.m1.1.1.1.1.1.1.1c.cmml" xref="A1.E18.m1.1.1.1.1.1.3"><mrow id="A1.E18.m1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.3"><mtext id="A1.E18.m1.1.1.1.1.1.1.1a.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1a">if </mtext><mrow id="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1"><mi id="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.2">x</mi><mo id="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.1">∈</mo><mi id="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.m1.1.1.3"></mi></mrow><mtext id="A1.E18.m1.1.1.1.1.1.1.1b.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1a"> queue</mtext></mrow></ci></matrixrow><matrixrow id="A1.E18.m1.2.2b.cmml" xref="A1.E18.m1.2.2"><apply id="A1.E18.m1.2.2.2.2.1.cmml" xref="A1.E18.m1.2.2.2.2.1"><divide id="A1.E18.m1.2.2.2.2.1.1.cmml" xref="A1.E18.m1.2.2.2.2.1"></divide><cn id="A1.E18.m1.2.2.2.2.1.2.cmml" type="integer" xref="A1.E18.m1.2.2.2.2.1.2">1</cn><apply id="A1.E18.m1.2.2.2.2.1.3.cmml" xref="A1.E18.m1.2.2.2.2.1.3"><minus id="A1.E18.m1.2.2.2.2.1.3.1.cmml" xref="A1.E18.m1.2.2.2.2.1.3.1"></minus><apply id="A1.E18.m1.2.2.2.2.1.3.2.cmml" xref="A1.E18.m1.2.2.2.2.1.3.2"><csymbol cd="ambiguous" id="A1.E18.m1.2.2.2.2.1.3.2.1.cmml" xref="A1.E18.m1.2.2.2.2.1.3.2">superscript</csymbol><cn id="A1.E18.m1.2.2.2.2.1.3.2.2.cmml" type="integer" xref="A1.E18.m1.2.2.2.2.1.3.2.2">2</cn><cn id="A1.E18.m1.2.2.2.2.1.3.2.3.cmml" type="integer" xref="A1.E18.m1.2.2.2.2.1.3.2.3">16</cn></apply><ci id="A1.E18.m1.2.2.2.2.1.3.3.cmml" xref="A1.E18.m1.2.2.2.2.1.3.3">𝑘</ci></apply></apply><ci id="A1.E18.m1.2.2.2.1.1.1a.cmml" xref="A1.E18.m1.2.2.2.1.1.3"><mtext id="A1.E18.m1.2.2.2.1.1.1.cmml" xref="A1.E18.m1.2.2.2.1.1.1">otherwise</mtext></ci></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.3c">\mathrm{Pr}\left[\text{next IPID}=x\right]=\left\{\begin{array}[]{ll}0&amp;\text{%
if $x\in$ queue};\\
\frac{1}{2^{16}-k}&amp;\text{otherwise}.\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m1.3d">roman_Pr [ next IPID = italic_x ] = { start_ARRAY start_ROW start_CELL 0 end_CELL start_CELL if italic_x ∈ queue ; end_CELL end_ROW start_ROW start_CELL divide start_ARG 1 end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k end_ARG end_CELL start_CELL otherwise . end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.SSS5.p1.7">Substituting Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E18" title="In A.2.5. PRNG (searchable queue of size 𝑘) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">18</span></a> into Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.E2" title="In 4.3. Analyzing Security ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2</span></a>, we find that the adversary can do no better than make <math alttext="g" class="ltx_Math" display="inline" id="A1.SS2.SSS5.p1.6.m1.1"><semantics id="A1.SS2.SSS5.p1.6.m1.1a"><mi id="A1.SS2.SSS5.p1.6.m1.1.1" xref="A1.SS2.SSS5.p1.6.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS5.p1.6.m1.1b"><ci id="A1.SS2.SSS5.p1.6.m1.1.1.cmml" xref="A1.SS2.SSS5.p1.6.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS5.p1.6.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS5.p1.6.m1.1d">italic_g</annotation></semantics></math> distinct guesses uniformly at random over the <math alttext="2^{16}-k" class="ltx_Math" display="inline" id="A1.SS2.SSS5.p1.7.m2.1"><semantics id="A1.SS2.SSS5.p1.7.m2.1a"><mrow id="A1.SS2.SSS5.p1.7.m2.1.1" xref="A1.SS2.SSS5.p1.7.m2.1.1.cmml"><msup id="A1.SS2.SSS5.p1.7.m2.1.1.2" xref="A1.SS2.SSS5.p1.7.m2.1.1.2.cmml"><mn id="A1.SS2.SSS5.p1.7.m2.1.1.2.2" xref="A1.SS2.SSS5.p1.7.m2.1.1.2.2.cmml">2</mn><mn id="A1.SS2.SSS5.p1.7.m2.1.1.2.3" xref="A1.SS2.SSS5.p1.7.m2.1.1.2.3.cmml">16</mn></msup><mo id="A1.SS2.SSS5.p1.7.m2.1.1.1" xref="A1.SS2.SSS5.p1.7.m2.1.1.1.cmml">−</mo><mi id="A1.SS2.SSS5.p1.7.m2.1.1.3" xref="A1.SS2.SSS5.p1.7.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS5.p1.7.m2.1b"><apply id="A1.SS2.SSS5.p1.7.m2.1.1.cmml" xref="A1.SS2.SSS5.p1.7.m2.1.1"><minus id="A1.SS2.SSS5.p1.7.m2.1.1.1.cmml" xref="A1.SS2.SSS5.p1.7.m2.1.1.1"></minus><apply id="A1.SS2.SSS5.p1.7.m2.1.1.2.cmml" xref="A1.SS2.SSS5.p1.7.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS5.p1.7.m2.1.1.2.1.cmml" xref="A1.SS2.SSS5.p1.7.m2.1.1.2">superscript</csymbol><cn id="A1.SS2.SSS5.p1.7.m2.1.1.2.2.cmml" type="integer" xref="A1.SS2.SSS5.p1.7.m2.1.1.2.2">2</cn><cn id="A1.SS2.SSS5.p1.7.m2.1.1.2.3.cmml" type="integer" xref="A1.SS2.SSS5.p1.7.m2.1.1.2.3">16</cn></apply><ci id="A1.SS2.SSS5.p1.7.m2.1.1.3.cmml" xref="A1.SS2.SSS5.p1.7.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS5.p1.7.m2.1c">2^{16}-k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS5.p1.7.m2.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k</annotation></semantics></math> non-queued IPIDs:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(19)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\left\{\sum_{x\in G}\mathrm{Pr}\left[\text{next IPID}=x\right]\right\}=\min%
\left\{\frac{g}{2^{16}-k},1\right\}." class="ltx_Math" display="block" id="A1.E19.m1.7"><semantics id="A1.E19.m1.7a"><mrow id="A1.E19.m1.7.7.1" xref="A1.E19.m1.7.7.1.1.cmml"><mrow id="A1.E19.m1.7.7.1.1" xref="A1.E19.m1.7.7.1.1.cmml"><mrow id="A1.E19.m1.7.7.1.1.4" xref="A1.E19.m1.7.7.1.1.4.cmml"><mi id="A1.E19.m1.7.7.1.1.4.2" xref="A1.E19.m1.7.7.1.1.4.2.cmml">Pr</mi><mo id="A1.E19.m1.7.7.1.1.4.1" xref="A1.E19.m1.7.7.1.1.4.1.cmml">⁢</mo><mrow id="A1.E19.m1.7.7.1.1.4.3.2" xref="A1.E19.m1.7.7.1.1.4.3.1.cmml"><mo id="A1.E19.m1.7.7.1.1.4.3.2.1" xref="A1.E19.m1.7.7.1.1.4.3.1.1.cmml">[</mo><mtext id="A1.E19.m1.3.3" xref="A1.E19.m1.3.3a.cmml">adv. guess</mtext><mo id="A1.E19.m1.7.7.1.1.4.3.2.2" xref="A1.E19.m1.7.7.1.1.4.3.1.1.cmml">]</mo></mrow></mrow><mo id="A1.E19.m1.7.7.1.1.5" xref="A1.E19.m1.7.7.1.1.5.cmml">=</mo><mrow id="A1.E19.m1.7.7.1.1.2.2" xref="A1.E19.m1.7.7.1.1.2.3.cmml"><munder id="A1.E19.m1.7.7.1.1.1.1.1" xref="A1.E19.m1.7.7.1.1.1.1.1.cmml"><mi id="A1.E19.m1.7.7.1.1.1.1.1.2" xref="A1.E19.m1.7.7.1.1.1.1.1.2.cmml">max</mi><mrow id="A1.E19.m1.2.2.2" xref="A1.E19.m1.2.2.2.cmml"><mrow id="A1.E19.m1.2.2.2.2" xref="A1.E19.m1.2.2.2.2.cmml"><mi id="A1.E19.m1.2.2.2.2.3" xref="A1.E19.m1.2.2.2.2.3.cmml">G</mi><mo id="A1.E19.m1.2.2.2.2.2" xref="A1.E19.m1.2.2.2.2.2.cmml">⊂</mo><mrow id="A1.E19.m1.2.2.2.2.1.1" xref="A1.E19.m1.2.2.2.2.1.2.cmml"><mo id="A1.E19.m1.2.2.2.2.1.1.2" stretchy="false" xref="A1.E19.m1.2.2.2.2.1.2.1.cmml">[</mo><msup id="A1.E19.m1.2.2.2.2.1.1.1" xref="A1.E19.m1.2.2.2.2.1.1.1.cmml"><mn id="A1.E19.m1.2.2.2.2.1.1.1.2" xref="A1.E19.m1.2.2.2.2.1.1.1.2.cmml">2</mn><mn id="A1.E19.m1.2.2.2.2.1.1.1.3" xref="A1.E19.m1.2.2.2.2.1.1.1.3.cmml">16</mn></msup><mo id="A1.E19.m1.2.2.2.2.1.1.3" rspace="0.508em" stretchy="false" xref="A1.E19.m1.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E19.m1.2.2.2.3" rspace="0.508em" xref="A1.E19.m1.2.2.2.3.cmml">:</mo><mrow id="A1.E19.m1.2.2.2.4" xref="A1.E19.m1.2.2.2.4.cmml"><mrow id="A1.E19.m1.2.2.2.4.2.2" xref="A1.E19.m1.2.2.2.4.2.1.cmml"><mo id="A1.E19.m1.2.2.2.4.2.2.1" stretchy="false" xref="A1.E19.m1.2.2.2.4.2.1.1.cmml">|</mo><mi id="A1.E19.m1.1.1.1.1" xref="A1.E19.m1.1.1.1.1.cmml">G</mi><mo id="A1.E19.m1.2.2.2.4.2.2.2" stretchy="false" xref="A1.E19.m1.2.2.2.4.2.1.1.cmml">|</mo></mrow><mo id="A1.E19.m1.2.2.2.4.1" xref="A1.E19.m1.2.2.2.4.1.cmml">=</mo><mi id="A1.E19.m1.2.2.2.4.3" xref="A1.E19.m1.2.2.2.4.3.cmml">g</mi></mrow></mrow></munder><mo id="A1.E19.m1.7.7.1.1.2.2a" xref="A1.E19.m1.7.7.1.1.2.3.cmml">⁡</mo><mrow id="A1.E19.m1.7.7.1.1.2.2.2" xref="A1.E19.m1.7.7.1.1.2.3.cmml"><mo id="A1.E19.m1.7.7.1.1.2.2.2.2" xref="A1.E19.m1.7.7.1.1.2.3.cmml">{</mo><mrow id="A1.E19.m1.7.7.1.1.2.2.2.1" xref="A1.E19.m1.7.7.1.1.2.2.2.1.cmml"><munder id="A1.E19.m1.7.7.1.1.2.2.2.1.2" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.cmml"><mo id="A1.E19.m1.7.7.1.1.2.2.2.1.2.2" lspace="0em" movablelimits="false" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.2.cmml">∑</mo><mrow id="A1.E19.m1.7.7.1.1.2.2.2.1.2.3" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.cmml"><mi id="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.2" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.2.cmml">x</mi><mo id="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.1" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.1.cmml">∈</mo><mi id="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.3" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.3.cmml">G</mi></mrow></munder><mrow id="A1.E19.m1.7.7.1.1.2.2.2.1.1" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.cmml"><mi id="A1.E19.m1.7.7.1.1.2.2.2.1.1.3" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.3.cmml">Pr</mi><mo id="A1.E19.m1.7.7.1.1.2.2.2.1.1.2" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.2.cmml"><mo id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.2" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.2.1.cmml">[</mo><mrow id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.cmml"><mtext id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.2" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.2a.cmml">next IPID</mtext><mo id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.1" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.1.cmml">=</mo><mi id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.3" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.3" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E19.m1.7.7.1.1.2.2.2.3" xref="A1.E19.m1.7.7.1.1.2.3.cmml">}</mo></mrow></mrow><mo id="A1.E19.m1.7.7.1.1.6" xref="A1.E19.m1.7.7.1.1.6.cmml">=</mo><mrow id="A1.E19.m1.7.7.1.1.7.2" xref="A1.E19.m1.7.7.1.1.7.1.cmml"><mi id="A1.E19.m1.4.4" xref="A1.E19.m1.4.4.cmml">min</mi><mo id="A1.E19.m1.7.7.1.1.7.2a" xref="A1.E19.m1.7.7.1.1.7.1.cmml">⁡</mo><mrow id="A1.E19.m1.7.7.1.1.7.2.1" xref="A1.E19.m1.7.7.1.1.7.1.cmml"><mo id="A1.E19.m1.7.7.1.1.7.2.1.1" xref="A1.E19.m1.7.7.1.1.7.1.cmml">{</mo><mfrac id="A1.E19.m1.5.5" xref="A1.E19.m1.5.5.cmml"><mi id="A1.E19.m1.5.5.2" xref="A1.E19.m1.5.5.2.cmml">g</mi><mrow id="A1.E19.m1.5.5.3" xref="A1.E19.m1.5.5.3.cmml"><msup id="A1.E19.m1.5.5.3.2" xref="A1.E19.m1.5.5.3.2.cmml"><mn id="A1.E19.m1.5.5.3.2.2" xref="A1.E19.m1.5.5.3.2.2.cmml">2</mn><mn id="A1.E19.m1.5.5.3.2.3" xref="A1.E19.m1.5.5.3.2.3.cmml">16</mn></msup><mo id="A1.E19.m1.5.5.3.1" xref="A1.E19.m1.5.5.3.1.cmml">−</mo><mi id="A1.E19.m1.5.5.3.3" xref="A1.E19.m1.5.5.3.3.cmml">k</mi></mrow></mfrac><mo id="A1.E19.m1.7.7.1.1.7.2.1.2" xref="A1.E19.m1.7.7.1.1.7.1.cmml">,</mo><mn id="A1.E19.m1.6.6" xref="A1.E19.m1.6.6.cmml">1</mn><mo id="A1.E19.m1.7.7.1.1.7.2.1.3" xref="A1.E19.m1.7.7.1.1.7.1.cmml">}</mo></mrow></mrow></mrow><mo id="A1.E19.m1.7.7.1.2" lspace="0em" xref="A1.E19.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E19.m1.7b"><apply id="A1.E19.m1.7.7.1.1.cmml" xref="A1.E19.m1.7.7.1"><and id="A1.E19.m1.7.7.1.1a.cmml" xref="A1.E19.m1.7.7.1"></and><apply id="A1.E19.m1.7.7.1.1b.cmml" xref="A1.E19.m1.7.7.1"><eq id="A1.E19.m1.7.7.1.1.5.cmml" xref="A1.E19.m1.7.7.1.1.5"></eq><apply id="A1.E19.m1.7.7.1.1.4.cmml" xref="A1.E19.m1.7.7.1.1.4"><times id="A1.E19.m1.7.7.1.1.4.1.cmml" xref="A1.E19.m1.7.7.1.1.4.1"></times><ci id="A1.E19.m1.7.7.1.1.4.2.cmml" xref="A1.E19.m1.7.7.1.1.4.2">Pr</ci><apply id="A1.E19.m1.7.7.1.1.4.3.1.cmml" xref="A1.E19.m1.7.7.1.1.4.3.2"><csymbol cd="latexml" id="A1.E19.m1.7.7.1.1.4.3.1.1.cmml" xref="A1.E19.m1.7.7.1.1.4.3.2.1">delimited-[]</csymbol><ci id="A1.E19.m1.3.3a.cmml" xref="A1.E19.m1.3.3"><mtext id="A1.E19.m1.3.3.cmml" xref="A1.E19.m1.3.3">adv. guess</mtext></ci></apply></apply><apply id="A1.E19.m1.7.7.1.1.2.3.cmml" xref="A1.E19.m1.7.7.1.1.2.2"><apply id="A1.E19.m1.7.7.1.1.1.1.1.cmml" xref="A1.E19.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E19.m1.7.7.1.1.1.1.1.1.cmml" xref="A1.E19.m1.7.7.1.1.1.1.1">subscript</csymbol><max id="A1.E19.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.E19.m1.7.7.1.1.1.1.1.2"></max><apply id="A1.E19.m1.2.2.2.cmml" xref="A1.E19.m1.2.2.2"><ci id="A1.E19.m1.2.2.2.3.cmml" xref="A1.E19.m1.2.2.2.3">:</ci><apply id="A1.E19.m1.2.2.2.2.cmml" xref="A1.E19.m1.2.2.2.2"><subset id="A1.E19.m1.2.2.2.2.2.cmml" xref="A1.E19.m1.2.2.2.2.2"></subset><ci id="A1.E19.m1.2.2.2.2.3.cmml" xref="A1.E19.m1.2.2.2.2.3">𝐺</ci><apply id="A1.E19.m1.2.2.2.2.1.2.cmml" xref="A1.E19.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E19.m1.2.2.2.2.1.2.1.cmml" xref="A1.E19.m1.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="A1.E19.m1.2.2.2.2.1.1.1.cmml" xref="A1.E19.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E19.m1.2.2.2.2.1.1.1.1.cmml" xref="A1.E19.m1.2.2.2.2.1.1.1">superscript</csymbol><cn id="A1.E19.m1.2.2.2.2.1.1.1.2.cmml" type="integer" xref="A1.E19.m1.2.2.2.2.1.1.1.2">2</cn><cn id="A1.E19.m1.2.2.2.2.1.1.1.3.cmml" type="integer" xref="A1.E19.m1.2.2.2.2.1.1.1.3">16</cn></apply></apply></apply><apply id="A1.E19.m1.2.2.2.4.cmml" xref="A1.E19.m1.2.2.2.4"><eq id="A1.E19.m1.2.2.2.4.1.cmml" xref="A1.E19.m1.2.2.2.4.1"></eq><apply id="A1.E19.m1.2.2.2.4.2.1.cmml" xref="A1.E19.m1.2.2.2.4.2.2"><abs id="A1.E19.m1.2.2.2.4.2.1.1.cmml" xref="A1.E19.m1.2.2.2.4.2.2.1"></abs><ci id="A1.E19.m1.1.1.1.1.cmml" xref="A1.E19.m1.1.1.1.1">𝐺</ci></apply><ci id="A1.E19.m1.2.2.2.4.3.cmml" xref="A1.E19.m1.2.2.2.4.3">𝑔</ci></apply></apply></apply><apply id="A1.E19.m1.7.7.1.1.2.2.2.1.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1"><apply id="A1.E19.m1.7.7.1.1.2.2.2.1.2.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2"><csymbol cd="ambiguous" id="A1.E19.m1.7.7.1.1.2.2.2.1.2.1.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2">subscript</csymbol><sum id="A1.E19.m1.7.7.1.1.2.2.2.1.2.2.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.2"></sum><apply id="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.3"><in id="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.1.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.1"></in><ci id="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.2.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.2">𝑥</ci><ci id="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.3.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.2.3.3">𝐺</ci></apply></apply><apply id="A1.E19.m1.7.7.1.1.2.2.2.1.1.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1"><times id="A1.E19.m1.7.7.1.1.2.2.2.1.1.2.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.2"></times><ci id="A1.E19.m1.7.7.1.1.2.2.2.1.1.3.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.3">Pr</ci><apply id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1"><csymbol cd="latexml" id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.2.1.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1"><eq id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.1"></eq><ci id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.2a.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.2"><mtext id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.2">next IPID</mtext></ci><ci id="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.3.cmml" xref="A1.E19.m1.7.7.1.1.2.2.2.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply><apply id="A1.E19.m1.7.7.1.1c.cmml" xref="A1.E19.m1.7.7.1"><eq id="A1.E19.m1.7.7.1.1.6.cmml" xref="A1.E19.m1.7.7.1.1.6"></eq><share href="https://arxiv.org/html/2406.06483v2#A1.E19.m1.7.7.1.1.2.cmml" id="A1.E19.m1.7.7.1.1d.cmml" xref="A1.E19.m1.7.7.1"></share><apply id="A1.E19.m1.7.7.1.1.7.1.cmml" xref="A1.E19.m1.7.7.1.1.7.2"><min id="A1.E19.m1.4.4.cmml" xref="A1.E19.m1.4.4"></min><apply id="A1.E19.m1.5.5.cmml" xref="A1.E19.m1.5.5"><divide id="A1.E19.m1.5.5.1.cmml" xref="A1.E19.m1.5.5"></divide><ci id="A1.E19.m1.5.5.2.cmml" xref="A1.E19.m1.5.5.2">𝑔</ci><apply id="A1.E19.m1.5.5.3.cmml" xref="A1.E19.m1.5.5.3"><minus id="A1.E19.m1.5.5.3.1.cmml" xref="A1.E19.m1.5.5.3.1"></minus><apply id="A1.E19.m1.5.5.3.2.cmml" xref="A1.E19.m1.5.5.3.2"><csymbol cd="ambiguous" id="A1.E19.m1.5.5.3.2.1.cmml" xref="A1.E19.m1.5.5.3.2">superscript</csymbol><cn id="A1.E19.m1.5.5.3.2.2.cmml" type="integer" xref="A1.E19.m1.5.5.3.2.2">2</cn><cn id="A1.E19.m1.5.5.3.2.3.cmml" type="integer" xref="A1.E19.m1.5.5.3.2.3">16</cn></apply><ci id="A1.E19.m1.5.5.3.3.cmml" xref="A1.E19.m1.5.5.3.3">𝑘</ci></apply></apply><cn id="A1.E19.m1.6.6.cmml" type="integer" xref="A1.E19.m1.6.6">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m1.7c">\mathrm{Pr}\left[\text{adv.\ guess}\right]=\max_{G\subset[2^{16}]~{}:~{}|G|=g}%
\left\{\sum_{x\in G}\mathrm{Pr}\left[\text{next IPID}=x\right]\right\}=\min%
\left\{\frac{g}{2^{16}-k},1\right\}.</annotation><annotation encoding="application/x-llamapun" id="A1.E19.m1.7d">roman_Pr [ adv. guess ] = roman_max start_POSTSUBSCRIPT italic_G ⊂ [ 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT ] : | italic_G | = italic_g end_POSTSUBSCRIPT { ∑ start_POSTSUBSCRIPT italic_x ∈ italic_G end_POSTSUBSCRIPT roman_Pr [ next IPID = italic_x ] } = roman_min { divide start_ARG italic_g end_ARG start_ARG 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k end_ARG , 1 } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS6">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.6. </span>PRNG (iterated Knuth shuffle reserving <math alttext="k" class="ltx_Math" display="inline" id="A1.SS2.SSS6.1.m1.1"><semantics id="A1.SS2.SSS6.1.m1.1b"><mi id="A1.SS2.SSS6.1.m1.1.1" xref="A1.SS2.SSS6.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS6.1.m1.1c"><ci id="A1.SS2.SSS6.1.m1.1.1.cmml" xref="A1.SS2.SSS6.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS6.1.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS6.1.m1.1e">italic_k</annotation></semantics></math> IPIDs)</h4>
<div class="ltx_para" id="A1.SS2.SSS6.p1">
<p class="ltx_p" id="A1.SS2.SSS6.p1.5">We again assume the worst-case scenario that the adversary knows the IPIDs of the last <math alttext="k" class="ltx_Math" display="inline" id="A1.SS2.SSS6.p1.1.m1.1"><semantics id="A1.SS2.SSS6.p1.1.m1.1a"><mi id="A1.SS2.SSS6.p1.1.m1.1.1" xref="A1.SS2.SSS6.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS6.p1.1.m1.1b"><ci id="A1.SS2.SSS6.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS6.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS6.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS6.p1.1.m1.1d">italic_k</annotation></semantics></math> packets that <math alttext="S" class="ltx_Math" display="inline" id="A1.SS2.SSS6.p1.2.m2.1"><semantics id="A1.SS2.SSS6.p1.2.m2.1a"><mi id="A1.SS2.SSS6.p1.2.m2.1.1" xref="A1.SS2.SSS6.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS6.p1.2.m2.1b"><ci id="A1.SS2.SSS6.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS6.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS6.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS6.p1.2.m2.1d">italic_S</annotation></semantics></math> sent; i.e., it knows which IPIDs cannot be returned next.
In Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS5" title="A.1.5. PRNG (iterated Knuth shuffle reserving 𝑘 IPIDs) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.1.5</span></a>, we showed that the next IPID generated by an iterated Knuth shuffle is equally likely to be any IPID except the last <math alttext="k" class="ltx_Math" display="inline" id="A1.SS2.SSS6.p1.3.m3.1"><semantics id="A1.SS2.SSS6.p1.3.m3.1a"><mi id="A1.SS2.SSS6.p1.3.m3.1.1" xref="A1.SS2.SSS6.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS6.p1.3.m3.1b"><ci id="A1.SS2.SSS6.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS6.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS6.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS6.p1.3.m3.1d">italic_k</annotation></semantics></math> returned (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E11" title="In A.1.5. PRNG (iterated Knuth shuffle reserving 𝑘 IPIDs) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">11</span></a>), implying that the adversary can do no better than make <math alttext="g" class="ltx_Math" display="inline" id="A1.SS2.SSS6.p1.4.m4.1"><semantics id="A1.SS2.SSS6.p1.4.m4.1a"><mi id="A1.SS2.SSS6.p1.4.m4.1.1" xref="A1.SS2.SSS6.p1.4.m4.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS6.p1.4.m4.1b"><ci id="A1.SS2.SSS6.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS6.p1.4.m4.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS6.p1.4.m4.1c">g</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS6.p1.4.m4.1d">italic_g</annotation></semantics></math> distinct guesses uniformly at random over the <math alttext="2^{16}-k" class="ltx_Math" display="inline" id="A1.SS2.SSS6.p1.5.m5.1"><semantics id="A1.SS2.SSS6.p1.5.m5.1a"><mrow id="A1.SS2.SSS6.p1.5.m5.1.1" xref="A1.SS2.SSS6.p1.5.m5.1.1.cmml"><msup id="A1.SS2.SSS6.p1.5.m5.1.1.2" xref="A1.SS2.SSS6.p1.5.m5.1.1.2.cmml"><mn id="A1.SS2.SSS6.p1.5.m5.1.1.2.2" xref="A1.SS2.SSS6.p1.5.m5.1.1.2.2.cmml">2</mn><mn id="A1.SS2.SSS6.p1.5.m5.1.1.2.3" xref="A1.SS2.SSS6.p1.5.m5.1.1.2.3.cmml">16</mn></msup><mo id="A1.SS2.SSS6.p1.5.m5.1.1.1" xref="A1.SS2.SSS6.p1.5.m5.1.1.1.cmml">−</mo><mi id="A1.SS2.SSS6.p1.5.m5.1.1.3" xref="A1.SS2.SSS6.p1.5.m5.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS6.p1.5.m5.1b"><apply id="A1.SS2.SSS6.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS6.p1.5.m5.1.1"><minus id="A1.SS2.SSS6.p1.5.m5.1.1.1.cmml" xref="A1.SS2.SSS6.p1.5.m5.1.1.1"></minus><apply id="A1.SS2.SSS6.p1.5.m5.1.1.2.cmml" xref="A1.SS2.SSS6.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS6.p1.5.m5.1.1.2.1.cmml" xref="A1.SS2.SSS6.p1.5.m5.1.1.2">superscript</csymbol><cn id="A1.SS2.SSS6.p1.5.m5.1.1.2.2.cmml" type="integer" xref="A1.SS2.SSS6.p1.5.m5.1.1.2.2">2</cn><cn id="A1.SS2.SSS6.p1.5.m5.1.1.2.3.cmml" type="integer" xref="A1.SS2.SSS6.p1.5.m5.1.1.2.3">16</cn></apply><ci id="A1.SS2.SSS6.p1.5.m5.1.1.3.cmml" xref="A1.SS2.SSS6.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS6.p1.5.m5.1c">2^{16}-k</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS6.p1.5.m5.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - italic_k</annotation></semantics></math> unreserved IPIDs.
Thus, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E19" title="In A.2.5. PRNG (searchable queue of size 𝑘) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">19</span></a> also describes the probability of adversarial guess for this method.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS7">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.7. </span>PRNG (pure, no reserved IPIDs)</h4>
<div class="ltx_para" id="A1.SS2.SSS7.p1">
<span class="ltx_ERROR undefined" id="A1.SS2.SSS7.p1.4">\added</span>
<p class="ltx_p" id="A1.SS2.SSS7.p1.3">As in our correctness analysis (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.SS1.SSS6" title="A.1.6. PRNG (pure, no reserved IPIDs) ‣ A.1. Correctness Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">A.1.6</span></a>), it is easily seen that pure PRNG selection is a special case of the other PRNG-based methods when <math alttext="k=0" class="ltx_Math" display="inline" id="A1.SS2.SSS7.p1.1.m1.1"><semantics id="A1.SS2.SSS7.p1.1.m1.1a"><mrow id="A1.SS2.SSS7.p1.1.m1.1.1" xref="A1.SS2.SSS7.p1.1.m1.1.1.cmml"><mi id="A1.SS2.SSS7.p1.1.m1.1.1.2" xref="A1.SS2.SSS7.p1.1.m1.1.1.2.cmml">k</mi><mo id="A1.SS2.SSS7.p1.1.m1.1.1.1" xref="A1.SS2.SSS7.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS2.SSS7.p1.1.m1.1.1.3" xref="A1.SS2.SSS7.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS7.p1.1.m1.1b"><apply id="A1.SS2.SSS7.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS7.p1.1.m1.1.1"><eq id="A1.SS2.SSS7.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSS7.p1.1.m1.1.1.1"></eq><ci id="A1.SS2.SSS7.p1.1.m1.1.1.2.cmml" xref="A1.SS2.SSS7.p1.1.m1.1.1.2">𝑘</ci><cn id="A1.SS2.SSS7.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS2.SSS7.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS7.p1.1.m1.1c">k=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS7.p1.1.m1.1d">italic_k = 0</annotation></semantics></math>.
Since every IPID is chosen uniformly at random from among all <math alttext="2^{16}" class="ltx_Math" display="inline" id="A1.SS2.SSS7.p1.2.m2.1"><semantics id="A1.SS2.SSS7.p1.2.m2.1a"><msup id="A1.SS2.SSS7.p1.2.m2.1.1" xref="A1.SS2.SSS7.p1.2.m2.1.1.cmml"><mn id="A1.SS2.SSS7.p1.2.m2.1.1.2" xref="A1.SS2.SSS7.p1.2.m2.1.1.2.cmml">2</mn><mn id="A1.SS2.SSS7.p1.2.m2.1.1.3" xref="A1.SS2.SSS7.p1.2.m2.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS7.p1.2.m2.1b"><apply id="A1.SS2.SSS7.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS7.p1.2.m2.1.1.1.cmml" xref="A1.SS2.SSS7.p1.2.m2.1.1">superscript</csymbol><cn id="A1.SS2.SSS7.p1.2.m2.1.1.2.cmml" type="integer" xref="A1.SS2.SSS7.p1.2.m2.1.1.2">2</cn><cn id="A1.SS2.SSS7.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.SSS7.p1.2.m2.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS7.p1.2.m2.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS7.p1.2.m2.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> possible values, the adversary can do no better than guess at random.
Thus, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#A1.E19" title="In A.2.5. PRNG (searchable queue of size 𝑘) ‣ A.2. Security Derivations ‣ Appendix A Analytical Derivations ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">19</span></a> (with <math alttext="k=0" class="ltx_Math" display="inline" id="A1.SS2.SSS7.p1.3.m3.1"><semantics id="A1.SS2.SSS7.p1.3.m3.1a"><mrow id="A1.SS2.SSS7.p1.3.m3.1.1" xref="A1.SS2.SSS7.p1.3.m3.1.1.cmml"><mi id="A1.SS2.SSS7.p1.3.m3.1.1.2" xref="A1.SS2.SSS7.p1.3.m3.1.1.2.cmml">k</mi><mo id="A1.SS2.SSS7.p1.3.m3.1.1.1" xref="A1.SS2.SSS7.p1.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS2.SSS7.p1.3.m3.1.1.3" xref="A1.SS2.SSS7.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS7.p1.3.m3.1b"><apply id="A1.SS2.SSS7.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS7.p1.3.m3.1.1"><eq id="A1.SS2.SSS7.p1.3.m3.1.1.1.cmml" xref="A1.SS2.SSS7.p1.3.m3.1.1.1"></eq><ci id="A1.SS2.SSS7.p1.3.m3.1.1.2.cmml" xref="A1.SS2.SSS7.p1.3.m3.1.1.2">𝑘</ci><cn id="A1.SS2.SSS7.p1.3.m3.1.1.3.cmml" type="integer" xref="A1.SS2.SSS7.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS7.p1.3.m3.1c">k=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS7.p1.3.m3.1d">italic_k = 0</annotation></semantics></math>) also describes the probability of adversarial guess for this method.</p>
</div>
</section>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Benchmark Implementation Details</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#alg1" title="Algorithm 1 ‣ Appendix B Benchmark Implementation Details ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">1</span></a> details our implementations of the various IPID selection methods for the benchmarking results reported in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S4.SS4" title="4.4. Analyzing Performance ‣ 4. Comparative Analysis ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">4.4</span></a>.
We give some context for our design decisions below.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Benchmark Implementations of Multi-Core IPID Selection Methods</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text" id="alg1.l1.2" style="font-size:90%;">Let </span><math alttext="c" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" mathsize="90%" xref="alg1.l1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_c</annotation></semantics></math><span class="ltx_text" id="alg1.l1.3" style="font-size:90%;"> be a 16-bit atomic global counter.
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg1.l2.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l2.4" style="font-size:90%;">GloballyIncrementing</span><span class="ltx_text" id="alg1.l2.5" style="font-size:90%;">( )
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text" id="alg1.l3.2" style="font-size:90%;">    Atomically fetch-and-add </span><math alttext="v\leftarrow c" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" mathsize="90%" xref="alg1.l3.m1.1.1.2.cmml">v</mi><mo id="alg1.l3.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mi id="alg1.l3.m1.1.1.3" mathsize="90%" xref="alg1.l3.m1.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑣</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">v\leftarrow c</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_v ← italic_c</annotation></semantics></math><span class="ltx_text" id="alg1.l3.3" style="font-size:90%;"> and </span><math alttext="c\leftarrow c+1" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mrow id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2" mathsize="90%" xref="alg1.l3.m2.1.1.2.cmml">c</mi><mo id="alg1.l3.m2.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l3.m2.1.1.1.cmml">←</mo><mrow id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml"><mi id="alg1.l3.m2.1.1.3.2" mathsize="90%" xref="alg1.l3.m2.1.1.3.2.cmml">c</mi><mo id="alg1.l3.m2.1.1.3.1" mathsize="90%" xref="alg1.l3.m2.1.1.3.1.cmml">+</mo><mn id="alg1.l3.m2.1.1.3.3" mathsize="90%" xref="alg1.l3.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><ci id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1.1">←</ci><ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">𝑐</ci><apply id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3"><plus id="alg1.l3.m2.1.1.3.1.cmml" xref="alg1.l3.m2.1.1.3.1"></plus><ci id="alg1.l3.m2.1.1.3.2.cmml" xref="alg1.l3.m2.1.1.3.2">𝑐</ci><cn id="alg1.l3.m2.1.1.3.3.cmml" type="integer" xref="alg1.l3.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">c\leftarrow c+1</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_c ← italic_c + 1</annotation></semantics></math><span class="ltx_text" id="alg1.l3.4" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text" id="alg1.l4.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l4.3" style="font-size:90%;">return</span><span class="ltx_text" id="alg1.l4.4" style="font-size:90%;"> </span><math alttext="v+1" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" mathsize="90%" xref="alg1.l4.m1.1.1.2.cmml">v</mi><mo id="alg1.l4.m1.1.1.1" mathsize="90%" xref="alg1.l4.m1.1.1.1.cmml">+</mo><mn id="alg1.l4.m1.1.1.3" mathsize="90%" xref="alg1.l4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><plus id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></plus><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑣</ci><cn id="alg1.l4.m1.1.1.3.cmml" type="integer" xref="alg1.l4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">v+1</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_v + 1</annotation></semantics></math><span class="ltx_text" id="alg1.l4.5" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg1.l5.2" style="font-size:90%;">Let </span><math alttext="x" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" mathsize="90%" xref="alg1.l5.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg1.l5.3" style="font-size:90%;"> be a local 16-bit counter.
Note that this estimates per-connection’s performance, not its IPIDs.
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l6.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg1.l6.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l6.4" style="font-size:90%;">PerConnection</span><span class="ltx_text" id="alg1.l6.5" style="font-size:90%;">( )
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text" id="alg1.l7.2" style="font-size:90%;">    Instantiate a counter </span><math alttext="x" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" mathsize="90%" xref="alg1.l7.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg1.l7.3" style="font-size:90%;"> and set </span><math alttext="x\leftarrow x+1" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mrow id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mi id="alg1.l7.m2.1.1.2" mathsize="90%" xref="alg1.l7.m2.1.1.2.cmml">x</mi><mo id="alg1.l7.m2.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l7.m2.1.1.1.cmml">←</mo><mrow id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml"><mi id="alg1.l7.m2.1.1.3.2" mathsize="90%" xref="alg1.l7.m2.1.1.3.2.cmml">x</mi><mo id="alg1.l7.m2.1.1.3.1" mathsize="90%" xref="alg1.l7.m2.1.1.3.1.cmml">+</mo><mn id="alg1.l7.m2.1.1.3.3" mathsize="90%" xref="alg1.l7.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><ci id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1.1">←</ci><ci id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2">𝑥</ci><apply id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3"><plus id="alg1.l7.m2.1.1.3.1.cmml" xref="alg1.l7.m2.1.1.3.1"></plus><ci id="alg1.l7.m2.1.1.3.2.cmml" xref="alg1.l7.m2.1.1.3.2">𝑥</ci><cn id="alg1.l7.m2.1.1.3.3.cmml" type="integer" xref="alg1.l7.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">x\leftarrow x+1</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_x ← italic_x + 1</annotation></semantics></math><span class="ltx_text" id="alg1.l7.4" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text" id="alg1.l8.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l8.3" style="font-size:90%;">return</span><span class="ltx_text" id="alg1.l8.4" style="font-size:90%;"> </span><math alttext="x" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" mathsize="90%" xref="alg1.l8.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg1.l8.5" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg1.l9.2" style="font-size:90%;">Let </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mi id="alg1.l9.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l9.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l9.3" style="font-size:90%;"> be a lock, </span><span class="ltx_ERROR undefined" id="alg1.l9.4">\added</span><math alttext="h" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mi id="alg1.l9.m2.1.1" mathsize="90%" xref="alg1.l9.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_h</annotation></semantics></math><span class="ltx_text" id="alg1.l9.5" style="font-size:90%;"> be a hash table of (16-bit destination counter, 32-bit last access time) pairs indexed by </span><math alttext="(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})" class="ltx_Math" display="inline" id="alg1.l9.m3.2"><semantics id="alg1.l9.m3.2a"><mrow id="alg1.l9.m3.2.2.2" xref="alg1.l9.m3.2.2.3.cmml"><mo id="alg1.l9.m3.2.2.2.3" maxsize="90%" minsize="90%" xref="alg1.l9.m3.2.2.3.cmml">(</mo><msub id="alg1.l9.m3.1.1.1.1" xref="alg1.l9.m3.1.1.1.1.cmml"><mtext id="alg1.l9.m3.1.1.1.1.2" mathsize="90%" xref="alg1.l9.m3.1.1.1.1.2a.cmml">src</mtext><mtext id="alg1.l9.m3.1.1.1.1.3" mathsize="90%" xref="alg1.l9.m3.1.1.1.1.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l9.m3.2.2.2.4" mathsize="90%" xref="alg1.l9.m3.2.2.3.cmml">,</mo><msub id="alg1.l9.m3.2.2.2.2" xref="alg1.l9.m3.2.2.2.2.cmml"><mtext id="alg1.l9.m3.2.2.2.2.2" mathsize="90%" xref="alg1.l9.m3.2.2.2.2.2a.cmml">dst</mtext><mtext id="alg1.l9.m3.2.2.2.2.3" mathsize="90%" xref="alg1.l9.m3.2.2.2.2.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l9.m3.2.2.2.5" maxsize="90%" minsize="90%" xref="alg1.l9.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.2b"><interval closure="open" id="alg1.l9.m3.2.2.3.cmml" xref="alg1.l9.m3.2.2.2"><apply id="alg1.l9.m3.1.1.1.1.cmml" xref="alg1.l9.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.1.1.1.cmml" xref="alg1.l9.m3.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m3.1.1.1.1.2a.cmml" xref="alg1.l9.m3.1.1.1.1.2"><mtext id="alg1.l9.m3.1.1.1.1.2.cmml" mathsize="90%" xref="alg1.l9.m3.1.1.1.1.2">src</mtext></ci><ci id="alg1.l9.m3.1.1.1.1.3a.cmml" xref="alg1.l9.m3.1.1.1.1.3"><mtext id="alg1.l9.m3.1.1.1.1.3.cmml" mathsize="63%" xref="alg1.l9.m3.1.1.1.1.3">ipaddr</mtext></ci></apply><apply id="alg1.l9.m3.2.2.2.2.cmml" xref="alg1.l9.m3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m3.2.2.2.2.1.cmml" xref="alg1.l9.m3.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m3.2.2.2.2.2a.cmml" xref="alg1.l9.m3.2.2.2.2.2"><mtext id="alg1.l9.m3.2.2.2.2.2.cmml" mathsize="90%" xref="alg1.l9.m3.2.2.2.2.2">dst</mtext></ci><ci id="alg1.l9.m3.2.2.2.2.3a.cmml" xref="alg1.l9.m3.2.2.2.2.3"><mtext id="alg1.l9.m3.2.2.2.2.3.cmml" mathsize="63%" xref="alg1.l9.m3.2.2.2.2.3">ipaddr</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.2c">(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m3.2d">( src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT , dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l9.6" style="font-size:90%;"> pairs, and </span><math alttext="t_{\text{purge}}" class="ltx_Math" display="inline" id="alg1.l9.m4.1"><semantics id="alg1.l9.m4.1a"><msub id="alg1.l9.m4.1.1" xref="alg1.l9.m4.1.1.cmml"><mi id="alg1.l9.m4.1.1.2" mathsize="90%" xref="alg1.l9.m4.1.1.2.cmml">t</mi><mtext id="alg1.l9.m4.1.1.3" mathsize="90%" xref="alg1.l9.m4.1.1.3a.cmml">purge</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m4.1b"><apply id="alg1.l9.m4.1.1.cmml" xref="alg1.l9.m4.1.1"><csymbol cd="ambiguous" id="alg1.l9.m4.1.1.1.cmml" xref="alg1.l9.m4.1.1">subscript</csymbol><ci id="alg1.l9.m4.1.1.2.cmml" xref="alg1.l9.m4.1.1.2">𝑡</ci><ci id="alg1.l9.m4.1.1.3a.cmml" xref="alg1.l9.m4.1.1.3"><mtext id="alg1.l9.m4.1.1.3.cmml" mathsize="63%" xref="alg1.l9.m4.1.1.3">purge</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m4.1c">t_{\text{purge}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m4.1d">italic_t start_POSTSUBSCRIPT purge end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l9.7" style="font-size:90%;"> be the timestamp of the last purge sequence.
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l10.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg1.l10.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l10.4" style="font-size:90%;">PerDestination</span><span class="ltx_text" id="alg1.l10.5" style="font-size:90%;">(</span><math alttext="\text{src}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mtext id="alg1.l10.m1.1.1.2" mathsize="90%" xref="alg1.l10.m1.1.1.2a.cmml">src</mtext><mtext id="alg1.l10.m1.1.1.3" mathsize="90%" xref="alg1.l10.m1.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2a.cmml" xref="alg1.l10.m1.1.1.2"><mtext id="alg1.l10.m1.1.1.2.cmml" mathsize="90%" xref="alg1.l10.m1.1.1.2">src</mtext></ci><ci id="alg1.l10.m1.1.1.3a.cmml" xref="alg1.l10.m1.1.1.3"><mtext id="alg1.l10.m1.1.1.3.cmml" mathsize="63%" xref="alg1.l10.m1.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\text{src}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l10.6" style="font-size:90%;">, </span><math alttext="\text{dst}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l10.m2.1"><semantics id="alg1.l10.m2.1a"><msub id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mtext id="alg1.l10.m2.1.1.2" mathsize="90%" xref="alg1.l10.m2.1.1.2a.cmml">dst</mtext><mtext id="alg1.l10.m2.1.1.3" mathsize="90%" xref="alg1.l10.m2.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1">subscript</csymbol><ci id="alg1.l10.m2.1.1.2a.cmml" xref="alg1.l10.m2.1.1.2"><mtext id="alg1.l10.m2.1.1.2.cmml" mathsize="90%" xref="alg1.l10.m2.1.1.2">dst</mtext></ci><ci id="alg1.l10.m2.1.1.3a.cmml" xref="alg1.l10.m2.1.1.3"><mtext id="alg1.l10.m2.1.1.3.cmml" mathsize="63%" xref="alg1.l10.m2.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\text{dst}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l10.7" style="font-size:90%;">)
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text" id="alg1.l11.2" style="font-size:90%;">    Lock </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mi id="alg1.l11.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l11.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l11.3" style="font-size:90%;"> </span><span class="ltx_ERROR undefined" id="alg1.l11.4">\added</span><span class="ltx_text" id="alg1.l11.5" style="font-size:90%;">and get the current time </span><math alttext="t_{\text{now}}" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><msub id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" mathsize="90%" xref="alg1.l11.m2.1.1.2.cmml">t</mi><mtext id="alg1.l11.m2.1.1.3" mathsize="90%" xref="alg1.l11.m2.1.1.3a.cmml">now</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝑡</ci><ci id="alg1.l11.m2.1.1.3a.cmml" xref="alg1.l11.m2.1.1.3"><mtext id="alg1.l11.m2.1.1.3.cmml" mathsize="63%" xref="alg1.l11.m2.1.1.3">now</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">t_{\text{now}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l11.6" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text" id="alg1.l12.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l12.3" style="font-size:90%;">if</span><span class="ltx_text" id="alg1.l12.4" style="font-size:90%;"> </span><span class="ltx_ERROR undefined" id="alg1.l12.5">\added</span><math alttext="t_{\text{now}}-t_{\text{purge}}\geq 0.5~{}\text{s}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><msub id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml"><mi id="alg1.l12.m1.1.1.2.2.2" mathsize="90%" xref="alg1.l12.m1.1.1.2.2.2.cmml">t</mi><mtext id="alg1.l12.m1.1.1.2.2.3" mathsize="90%" xref="alg1.l12.m1.1.1.2.2.3a.cmml">now</mtext></msub><mo id="alg1.l12.m1.1.1.2.1" mathsize="90%" xref="alg1.l12.m1.1.1.2.1.cmml">−</mo><msub id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml"><mi id="alg1.l12.m1.1.1.2.3.2" mathsize="90%" xref="alg1.l12.m1.1.1.2.3.2.cmml">t</mi><mtext id="alg1.l12.m1.1.1.2.3.3" mathsize="90%" xref="alg1.l12.m1.1.1.2.3.3a.cmml">purge</mtext></msub></mrow><mo id="alg1.l12.m1.1.1.1" mathsize="90%" xref="alg1.l12.m1.1.1.1.cmml">≥</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mn id="alg1.l12.m1.1.1.3.2" mathsize="90%" xref="alg1.l12.m1.1.1.3.2.cmml">0.5</mn><mo id="alg1.l12.m1.1.1.3.1" lspace="0.300em" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mtext id="alg1.l12.m1.1.1.3.3" mathsize="90%" xref="alg1.l12.m1.1.1.3.3a.cmml">s</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><geq id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></geq><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><minus id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2.1"></minus><apply id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.2.1.cmml" xref="alg1.l12.m1.1.1.2.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.2.cmml" xref="alg1.l12.m1.1.1.2.2.2">𝑡</ci><ci id="alg1.l12.m1.1.1.2.2.3a.cmml" xref="alg1.l12.m1.1.1.2.2.3"><mtext id="alg1.l12.m1.1.1.2.2.3.cmml" mathsize="63%" xref="alg1.l12.m1.1.1.2.2.3">now</mtext></ci></apply><apply id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.3.2">𝑡</ci><ci id="alg1.l12.m1.1.1.2.3.3a.cmml" xref="alg1.l12.m1.1.1.2.3.3"><mtext id="alg1.l12.m1.1.1.2.3.3.cmml" mathsize="63%" xref="alg1.l12.m1.1.1.2.3.3">purge</mtext></ci></apply></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><times id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"></times><cn id="alg1.l12.m1.1.1.3.2.cmml" type="float" xref="alg1.l12.m1.1.1.3.2">0.5</cn><ci id="alg1.l12.m1.1.1.3.3a.cmml" xref="alg1.l12.m1.1.1.3.3"><mtext id="alg1.l12.m1.1.1.3.3.cmml" mathsize="90%" xref="alg1.l12.m1.1.1.3.3">s</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">t_{\text{now}}-t_{\text{purge}}\geq 0.5~{}\text{s}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT purge end_POSTSUBSCRIPT ≥ 0.5 s</annotation></semantics></math><span class="ltx_text" id="alg1.l12.6" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l12.7" style="font-size:90%;">then</span><span class="ltx_text" id="alg1.l12.8" style="font-size:90%;"> </span><span class="ltx_ERROR undefined" id="alg1.l12.9">\added</span><span class="ltx_text" id="alg1.l12.10" style="font-size:90%;">initiate a purge sequence (see Section </span><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3" style="font-size:90%;" title="2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.3</span></a><span class="ltx_text" id="alg1.l12.11" style="font-size:90%;">) and update </span><math alttext="t_{\text{purge}}\leftarrow t_{\text{now}}" class="ltx_Math" display="inline" id="alg1.l12.m2.1"><semantics id="alg1.l12.m2.1a"><mrow id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><msub id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml"><mi id="alg1.l12.m2.1.1.2.2" mathsize="90%" xref="alg1.l12.m2.1.1.2.2.cmml">t</mi><mtext id="alg1.l12.m2.1.1.2.3" mathsize="90%" xref="alg1.l12.m2.1.1.2.3a.cmml">purge</mtext></msub><mo id="alg1.l12.m2.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l12.m2.1.1.1.cmml">←</mo><msub id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml"><mi id="alg1.l12.m2.1.1.3.2" mathsize="90%" xref="alg1.l12.m2.1.1.3.2.cmml">t</mi><mtext id="alg1.l12.m2.1.1.3.3" mathsize="90%" xref="alg1.l12.m2.1.1.3.3a.cmml">now</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><ci id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1.1">←</ci><apply id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.2.1.cmml" xref="alg1.l12.m2.1.1.2">subscript</csymbol><ci id="alg1.l12.m2.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.2.2">𝑡</ci><ci id="alg1.l12.m2.1.1.2.3a.cmml" xref="alg1.l12.m2.1.1.2.3"><mtext id="alg1.l12.m2.1.1.2.3.cmml" mathsize="63%" xref="alg1.l12.m2.1.1.2.3">purge</mtext></ci></apply><apply id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.3.1.cmml" xref="alg1.l12.m2.1.1.3">subscript</csymbol><ci id="alg1.l12.m2.1.1.3.2.cmml" xref="alg1.l12.m2.1.1.3.2">𝑡</ci><ci id="alg1.l12.m2.1.1.3.3a.cmml" xref="alg1.l12.m2.1.1.3.3"><mtext id="alg1.l12.m2.1.1.3.3.cmml" mathsize="63%" xref="alg1.l12.m2.1.1.3.3">now</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">t_{\text{purge}}\leftarrow t_{\text{now}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.1d">italic_t start_POSTSUBSCRIPT purge end_POSTSUBSCRIPT ← italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l12.12" style="font-size:90%;">.
    </span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text" id="alg1.l13.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l13.3" style="font-size:90%;">if</span><span class="ltx_text" id="alg1.l13.4" style="font-size:90%;"> </span><math alttext="(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})\not\in h" class="ltx_Math" display="inline" id="alg1.l13.m1.2"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml"><mrow id="alg1.l13.m1.2.2.2.2" xref="alg1.l13.m1.2.2.2.3.cmml"><mo id="alg1.l13.m1.2.2.2.2.3" maxsize="90%" minsize="90%" xref="alg1.l13.m1.2.2.2.3.cmml">(</mo><msub id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mtext id="alg1.l13.m1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.1.2a.cmml">src</mtext><mtext id="alg1.l13.m1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.1.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l13.m1.2.2.2.2.4" mathsize="90%" xref="alg1.l13.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l13.m1.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.cmml"><mtext id="alg1.l13.m1.2.2.2.2.2.2" mathsize="90%" xref="alg1.l13.m1.2.2.2.2.2.2a.cmml">dst</mtext><mtext id="alg1.l13.m1.2.2.2.2.2.3" mathsize="90%" xref="alg1.l13.m1.2.2.2.2.2.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l13.m1.2.2.2.2.5" maxsize="90%" minsize="90%" xref="alg1.l13.m1.2.2.2.3.cmml">)</mo></mrow><mo id="alg1.l13.m1.2.2.3" mathsize="90%" xref="alg1.l13.m1.2.2.3.cmml">∉</mo><mi id="alg1.l13.m1.2.2.4" mathsize="90%" xref="alg1.l13.m1.2.2.4.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2"><notin id="alg1.l13.m1.2.2.3.cmml" xref="alg1.l13.m1.2.2.3"></notin><interval closure="open" id="alg1.l13.m1.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2"><apply id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.2a.cmml" xref="alg1.l13.m1.1.1.1.1.1.2"><mtext id="alg1.l13.m1.1.1.1.1.1.2.cmml" mathsize="90%" xref="alg1.l13.m1.1.1.1.1.1.2">src</mtext></ci><ci id="alg1.l13.m1.1.1.1.1.1.3a.cmml" xref="alg1.l13.m1.1.1.1.1.1.3"><mtext id="alg1.l13.m1.1.1.1.1.1.3.cmml" mathsize="63%" xref="alg1.l13.m1.1.1.1.1.1.3">ipaddr</mtext></ci></apply><apply id="alg1.l13.m1.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.2.2a.cmml" xref="alg1.l13.m1.2.2.2.2.2.2"><mtext id="alg1.l13.m1.2.2.2.2.2.2.cmml" mathsize="90%" xref="alg1.l13.m1.2.2.2.2.2.2">dst</mtext></ci><ci id="alg1.l13.m1.2.2.2.2.2.3a.cmml" xref="alg1.l13.m1.2.2.2.2.2.3"><mtext id="alg1.l13.m1.2.2.2.2.2.3.cmml" mathsize="63%" xref="alg1.l13.m1.2.2.2.2.2.3">ipaddr</mtext></ci></apply></interval><ci id="alg1.l13.m1.2.2.4.cmml" xref="alg1.l13.m1.2.2.4">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})\not\in h</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.2d">( src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT , dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT ) ∉ italic_h</annotation></semantics></math><span class="ltx_text" id="alg1.l13.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l13.6" style="font-size:90%;">then</span><span class="ltx_text" id="alg1.l13.7" style="font-size:90%;"> insert </span><math alttext="h[(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})]\leftarrow(\text{%
random IPID},\added{t_{\text{now}}})" class="ltx_Math" display="inline" id="alg1.l13.m2.3"><semantics id="alg1.l13.m2.3a"><mrow id="alg1.l13.m2.3.3" xref="alg1.l13.m2.3.3.cmml"><mrow id="alg1.l13.m2.2.2.1" xref="alg1.l13.m2.2.2.1.cmml"><mi id="alg1.l13.m2.2.2.1.3" mathsize="90%" xref="alg1.l13.m2.2.2.1.3.cmml">h</mi><mo id="alg1.l13.m2.2.2.1.2" xref="alg1.l13.m2.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l13.m2.2.2.1.1.1" xref="alg1.l13.m2.2.2.1.1.2.cmml"><mo id="alg1.l13.m2.2.2.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l13.m2.2.2.1.1.2.1.cmml">[</mo><mrow id="alg1.l13.m2.2.2.1.1.1.1.2" xref="alg1.l13.m2.2.2.1.1.1.1.3.cmml"><mo id="alg1.l13.m2.2.2.1.1.1.1.2.3" maxsize="90%" minsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.3.cmml">(</mo><msub id="alg1.l13.m2.2.2.1.1.1.1.1.1" xref="alg1.l13.m2.2.2.1.1.1.1.1.1.cmml"><mtext id="alg1.l13.m2.2.2.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.1.1.2a.cmml">src</mtext><mtext id="alg1.l13.m2.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.1.1.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l13.m2.2.2.1.1.1.1.2.4" mathsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.3.cmml">,</mo><msub id="alg1.l13.m2.2.2.1.1.1.1.2.2" xref="alg1.l13.m2.2.2.1.1.1.1.2.2.cmml"><mtext id="alg1.l13.m2.2.2.1.1.1.1.2.2.2" mathsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.2.2.2a.cmml">dst</mtext><mtext id="alg1.l13.m2.2.2.1.1.1.1.2.2.3" mathsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.2.2.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l13.m2.2.2.1.1.1.1.2.5" maxsize="90%" minsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l13.m2.2.2.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l13.m2.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l13.m2.3.3.3" mathsize="90%" stretchy="false" xref="alg1.l13.m2.3.3.3.cmml">←</mo><mrow id="alg1.l13.m2.3.3.2.1" xref="alg1.l13.m2.3.3.2.2.cmml"><mo id="alg1.l13.m2.3.3.2.1.2" maxsize="90%" minsize="90%" xref="alg1.l13.m2.3.3.2.2.cmml">(</mo><mtext id="alg1.l13.m2.1.1" mathsize="90%" xref="alg1.l13.m2.1.1a.cmml">random IPID</mtext><mo id="alg1.l13.m2.3.3.2.1.3" mathsize="90%" xref="alg1.l13.m2.3.3.2.2.cmml">,</mo><mrow id="alg1.l13.m2.3.3.2.1.1" xref="alg1.l13.m2.3.3.2.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="alg1.l13.m2.3.3.2.1.1.2" xref="alg1.l13.m2.3.3.2.1.1.2b.cmml"><mtext id="alg1.l13.m2.3.3.2.1.1.2a" xref="alg1.l13.m2.3.3.2.1.1.2b.cmml">\added</mtext></merror><mo id="alg1.l13.m2.3.3.2.1.1.1" xref="alg1.l13.m2.3.3.2.1.1.1.cmml">⁢</mo><msub id="alg1.l13.m2.3.3.2.1.1.3" xref="alg1.l13.m2.3.3.2.1.1.3.cmml"><mi id="alg1.l13.m2.3.3.2.1.1.3.2" mathsize="90%" xref="alg1.l13.m2.3.3.2.1.1.3.2.cmml">t</mi><mtext id="alg1.l13.m2.3.3.2.1.1.3.3" mathsize="90%" xref="alg1.l13.m2.3.3.2.1.1.3.3a.cmml">now</mtext></msub></mrow><mo id="alg1.l13.m2.3.3.2.1.4" maxsize="90%" minsize="90%" xref="alg1.l13.m2.3.3.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.3b"><apply id="alg1.l13.m2.3.3.cmml" xref="alg1.l13.m2.3.3"><ci id="alg1.l13.m2.3.3.3.cmml" xref="alg1.l13.m2.3.3.3">←</ci><apply id="alg1.l13.m2.2.2.1.cmml" xref="alg1.l13.m2.2.2.1"><times id="alg1.l13.m2.2.2.1.2.cmml" xref="alg1.l13.m2.2.2.1.2"></times><ci id="alg1.l13.m2.2.2.1.3.cmml" xref="alg1.l13.m2.2.2.1.3">ℎ</ci><apply id="alg1.l13.m2.2.2.1.1.2.cmml" xref="alg1.l13.m2.2.2.1.1.1"><csymbol cd="latexml" id="alg1.l13.m2.2.2.1.1.2.1.cmml" xref="alg1.l13.m2.2.2.1.1.1.2">delimited-[]</csymbol><interval closure="open" id="alg1.l13.m2.2.2.1.1.1.1.3.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.2"><apply id="alg1.l13.m2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m2.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m2.2.2.1.1.1.1.1.1.2a.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.1.1.2"><mtext id="alg1.l13.m2.2.2.1.1.1.1.1.1.2.cmml" mathsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.1.1.2">src</mtext></ci><ci id="alg1.l13.m2.2.2.1.1.1.1.1.1.3a.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.1.1.3"><mtext id="alg1.l13.m2.2.2.1.1.1.1.1.1.3.cmml" mathsize="63%" xref="alg1.l13.m2.2.2.1.1.1.1.1.1.3">ipaddr</mtext></ci></apply><apply id="alg1.l13.m2.2.2.1.1.1.1.2.2.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l13.m2.2.2.1.1.1.1.2.2.1.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l13.m2.2.2.1.1.1.1.2.2.2a.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.2.2.2"><mtext id="alg1.l13.m2.2.2.1.1.1.1.2.2.2.cmml" mathsize="90%" xref="alg1.l13.m2.2.2.1.1.1.1.2.2.2">dst</mtext></ci><ci id="alg1.l13.m2.2.2.1.1.1.1.2.2.3a.cmml" xref="alg1.l13.m2.2.2.1.1.1.1.2.2.3"><mtext id="alg1.l13.m2.2.2.1.1.1.1.2.2.3.cmml" mathsize="63%" xref="alg1.l13.m2.2.2.1.1.1.1.2.2.3">ipaddr</mtext></ci></apply></interval></apply></apply><interval closure="open" id="alg1.l13.m2.3.3.2.2.cmml" xref="alg1.l13.m2.3.3.2.1"><ci id="alg1.l13.m2.1.1a.cmml" xref="alg1.l13.m2.1.1"><mtext id="alg1.l13.m2.1.1.cmml" mathsize="90%" xref="alg1.l13.m2.1.1">random IPID</mtext></ci><apply id="alg1.l13.m2.3.3.2.1.1.cmml" xref="alg1.l13.m2.3.3.2.1.1"><times id="alg1.l13.m2.3.3.2.1.1.1.cmml" xref="alg1.l13.m2.3.3.2.1.1.1"></times><ci id="alg1.l13.m2.3.3.2.1.1.2b.cmml" xref="alg1.l13.m2.3.3.2.1.1.2"><merror class="ltx_ERROR undefined undefined" id="alg1.l13.m2.3.3.2.1.1.2.cmml" xref="alg1.l13.m2.3.3.2.1.1.2"><mtext id="alg1.l13.m2.3.3.2.1.1.2a.cmml" xref="alg1.l13.m2.3.3.2.1.1.2">\added</mtext></merror></ci><apply id="alg1.l13.m2.3.3.2.1.1.3.cmml" xref="alg1.l13.m2.3.3.2.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m2.3.3.2.1.1.3.1.cmml" xref="alg1.l13.m2.3.3.2.1.1.3">subscript</csymbol><ci id="alg1.l13.m2.3.3.2.1.1.3.2.cmml" xref="alg1.l13.m2.3.3.2.1.1.3.2">𝑡</ci><ci id="alg1.l13.m2.3.3.2.1.1.3.3a.cmml" xref="alg1.l13.m2.3.3.2.1.1.3.3"><mtext id="alg1.l13.m2.3.3.2.1.1.3.3.cmml" mathsize="63%" xref="alg1.l13.m2.3.3.2.1.1.3.3">now</mtext></ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.3c">h[(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})]\leftarrow(\text{%
random IPID},\added{t_{\text{now}}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m2.3d">italic_h [ ( src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT , dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT ) ] ← ( random IPID , italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l13.8" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text" id="alg1.l14.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l14.3" style="font-size:90%;">else</span><span class="ltx_text" id="alg1.l14.4" style="font-size:90%;"> </span><math alttext="h[(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})]\leftarrow(\text{%
counter}(h[(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})])+1,\added{%
t_{\text{now}}})" class="ltx_Math" display="inline" id="alg1.l14.m1.3"><semantics id="alg1.l14.m1.3a"><mrow id="alg1.l14.m1.3.3" xref="alg1.l14.m1.3.3.cmml"><mrow id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.1.1.1.3.cmml">h</mi><mo id="alg1.l14.m1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.2.cmml"><mo id="alg1.l14.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l14.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l14.m1.1.1.1.1.1.1.2.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg1.l14.m1.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="alg1.l14.m1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2a.cmml">src</mtext><mtext id="alg1.l14.m1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l14.m1.1.1.1.1.1.1.2.4" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg1.l14.m1.1.1.1.1.1.1.2.2" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.cmml"><mtext id="alg1.l14.m1.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.2a.cmml">dst</mtext><mtext id="alg1.l14.m1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l14.m1.1.1.1.1.1.1.2.5" maxsize="90%" minsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l14.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l14.m1.3.3.4" mathsize="90%" stretchy="false" xref="alg1.l14.m1.3.3.4.cmml">←</mo><mrow id="alg1.l14.m1.3.3.3.2" xref="alg1.l14.m1.3.3.3.3.cmml"><mo id="alg1.l14.m1.3.3.3.2.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.3.3.3.3.cmml">(</mo><mrow id="alg1.l14.m1.2.2.2.1.1" xref="alg1.l14.m1.2.2.2.1.1.cmml"><mrow id="alg1.l14.m1.2.2.2.1.1.1" xref="alg1.l14.m1.2.2.2.1.1.1.cmml"><mtext id="alg1.l14.m1.2.2.2.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.3a.cmml">counter</mtext><mo id="alg1.l14.m1.2.2.2.1.1.1.2" xref="alg1.l14.m1.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l14.m1.2.2.2.1.1.1.1.1" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.cmml"><mo id="alg1.l14.m1.2.2.2.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l14.m1.2.2.2.1.1.1.1.1.1" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.3.cmml">h</mi><mo id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.2" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">src</mtext><mtext id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.4" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mtext id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.2a.cmml">dst</mtext><mtext id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.5" maxsize="90%" minsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l14.m1.2.2.2.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l14.m1.2.2.2.1.1.2" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.2.cmml">+</mo><mn id="alg1.l14.m1.2.2.2.1.1.3" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.3.cmml">1</mn></mrow><mo id="alg1.l14.m1.3.3.3.2.4" mathsize="90%" xref="alg1.l14.m1.3.3.3.3.cmml">,</mo><mrow id="alg1.l14.m1.3.3.3.2.2" xref="alg1.l14.m1.3.3.3.2.2.cmml"><merror class="ltx_ERROR undefined undefined" id="alg1.l14.m1.3.3.3.2.2.2" xref="alg1.l14.m1.3.3.3.2.2.2b.cmml"><mtext id="alg1.l14.m1.3.3.3.2.2.2a" xref="alg1.l14.m1.3.3.3.2.2.2b.cmml">\added</mtext></merror><mo id="alg1.l14.m1.3.3.3.2.2.1" xref="alg1.l14.m1.3.3.3.2.2.1.cmml">⁢</mo><msub id="alg1.l14.m1.3.3.3.2.2.3" xref="alg1.l14.m1.3.3.3.2.2.3.cmml"><mi id="alg1.l14.m1.3.3.3.2.2.3.2" mathsize="90%" xref="alg1.l14.m1.3.3.3.2.2.3.2.cmml">t</mi><mtext id="alg1.l14.m1.3.3.3.2.2.3.3" mathsize="90%" xref="alg1.l14.m1.3.3.3.2.2.3.3a.cmml">now</mtext></msub></mrow><mo id="alg1.l14.m1.3.3.3.2.5" maxsize="90%" minsize="90%" xref="alg1.l14.m1.3.3.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.3b"><apply id="alg1.l14.m1.3.3.cmml" xref="alg1.l14.m1.3.3"><ci id="alg1.l14.m1.3.3.4.cmml" xref="alg1.l14.m1.3.3.4">←</ci><apply id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"><times id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.2"></times><ci id="alg1.l14.m1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.3">ℎ</ci><apply id="alg1.l14.m1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l14.m1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.2">delimited-[]</csymbol><interval closure="open" id="alg1.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2"><apply id="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2"><mtext id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.cmml" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2">src</mtext></ci><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3"><mtext id="alg1.l14.m1.1.1.1.1.1.1.1.1.3.cmml" mathsize="63%" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3">ipaddr</mtext></ci></apply><apply id="alg1.l14.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.2.2.2a.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.2"><mtext id="alg1.l14.m1.1.1.1.1.1.1.2.2.2.cmml" mathsize="90%" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.2">dst</mtext></ci><ci id="alg1.l14.m1.1.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.3"><mtext id="alg1.l14.m1.1.1.1.1.1.1.2.2.3.cmml" mathsize="63%" xref="alg1.l14.m1.1.1.1.1.1.1.2.2.3">ipaddr</mtext></ci></apply></interval></apply></apply><interval closure="open" id="alg1.l14.m1.3.3.3.3.cmml" xref="alg1.l14.m1.3.3.3.2"><apply id="alg1.l14.m1.2.2.2.1.1.cmml" xref="alg1.l14.m1.2.2.2.1.1"><plus id="alg1.l14.m1.2.2.2.1.1.2.cmml" xref="alg1.l14.m1.2.2.2.1.1.2"></plus><apply id="alg1.l14.m1.2.2.2.1.1.1.cmml" xref="alg1.l14.m1.2.2.2.1.1.1"><times id="alg1.l14.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.2"></times><ci id="alg1.l14.m1.2.2.2.1.1.1.3a.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.3"><mtext id="alg1.l14.m1.2.2.2.1.1.1.3.cmml" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.3">counter</mtext></ci><apply id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1"><times id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.2"></times><ci id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.3">ℎ</ci><apply id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><interval closure="open" id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2"><apply id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><mtext id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2">src</mtext></ci><ci id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="63%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3">ipaddr</mtext></ci></apply><apply id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.2a.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.2"><mtext id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" mathsize="90%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.2">dst</mtext></ci><ci id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.3"><mtext id="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" mathsize="63%" xref="alg1.l14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.3">ipaddr</mtext></ci></apply></interval></apply></apply></apply><cn id="alg1.l14.m1.2.2.2.1.1.3.cmml" type="integer" xref="alg1.l14.m1.2.2.2.1.1.3">1</cn></apply><apply id="alg1.l14.m1.3.3.3.2.2.cmml" xref="alg1.l14.m1.3.3.3.2.2"><times id="alg1.l14.m1.3.3.3.2.2.1.cmml" xref="alg1.l14.m1.3.3.3.2.2.1"></times><ci id="alg1.l14.m1.3.3.3.2.2.2b.cmml" xref="alg1.l14.m1.3.3.3.2.2.2"><merror class="ltx_ERROR undefined undefined" id="alg1.l14.m1.3.3.3.2.2.2.cmml" xref="alg1.l14.m1.3.3.3.2.2.2"><mtext id="alg1.l14.m1.3.3.3.2.2.2a.cmml" xref="alg1.l14.m1.3.3.3.2.2.2">\added</mtext></merror></ci><apply id="alg1.l14.m1.3.3.3.2.2.3.cmml" xref="alg1.l14.m1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.3.3.3.2.2.3.1.cmml" xref="alg1.l14.m1.3.3.3.2.2.3">subscript</csymbol><ci id="alg1.l14.m1.3.3.3.2.2.3.2.cmml" xref="alg1.l14.m1.3.3.3.2.2.3.2">𝑡</ci><ci id="alg1.l14.m1.3.3.3.2.2.3.3a.cmml" xref="alg1.l14.m1.3.3.3.2.2.3.3"><mtext id="alg1.l14.m1.3.3.3.2.2.3.3.cmml" mathsize="63%" xref="alg1.l14.m1.3.3.3.2.2.3.3">now</mtext></ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.3c">h[(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})]\leftarrow(\text{%
counter}(h[(\text{src}_{\text{ipaddr}},\text{dst}_{\text{ipaddr}})])+1,\added{%
t_{\text{now}}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.3d">italic_h [ ( src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT , dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT ) ] ← ( counter ( italic_h [ ( src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT , dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT ) ] ) + 1 , italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l14.5" style="font-size:90%;">.
    </span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text" id="alg1.l15.2" style="font-size:90%;">    Store </span><math alttext="v\leftarrow\text{counter}(h[(\text{src}_{\text{ipaddr}},\text{dst}_{\text{%
ipaddr}})])" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.3" mathsize="90%" xref="alg1.l15.m1.1.1.3.cmml">v</mi><mo id="alg1.l15.m1.1.1.2" mathsize="90%" stretchy="false" xref="alg1.l15.m1.1.1.2.cmml">←</mo><mrow id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><mtext id="alg1.l15.m1.1.1.1.3" mathsize="90%" xref="alg1.l15.m1.1.1.1.3a.cmml">counter</mtext><mo id="alg1.l15.m1.1.1.1.2" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l15.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.3.cmml">h</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml"><mo id="alg1.l15.m1.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.3" maxsize="90%" minsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">src</mtext><mtext id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.4" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mtext id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.2a.cmml">dst</mtext><mtext id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.3a.cmml">ipaddr</mtext></msub><mo id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.5" maxsize="90%" minsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l15.m1.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l15.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">←</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝑣</ci><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><times id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.2"></times><ci id="alg1.l15.m1.1.1.1.3a.cmml" xref="alg1.l15.m1.1.1.1.3"><mtext id="alg1.l15.m1.1.1.1.3.cmml" mathsize="90%" xref="alg1.l15.m1.1.1.1.3">counter</mtext></ci><apply id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1"><times id="alg1.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3">ℎ</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l15.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><interval closure="open" id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2"><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2"><mtext id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2">src</mtext></ci><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="63%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3">ipaddr</mtext></ci></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.2a.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.2"><mtext id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" mathsize="90%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.2">dst</mtext></ci><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.3"><mtext id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" mathsize="63%" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.2.2.3">ipaddr</mtext></ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">v\leftarrow\text{counter}(h[(\text{src}_{\text{ipaddr}},\text{dst}_{\text{%
ipaddr}})])</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_v ← counter ( italic_h [ ( src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT , dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT ) ] )</annotation></semantics></math><span class="ltx_text" id="alg1.l15.3" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span><span class="ltx_text" id="alg1.l16.2" style="font-size:90%;">    Unlock </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mi id="alg1.l16.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l16.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><ci id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l16.3" style="font-size:90%;"> and </span><span class="ltx_text ltx_font_bold" id="alg1.l16.4" style="font-size:90%;">return</span><span class="ltx_text" id="alg1.l16.5" style="font-size:90%;"> </span><math alttext="v" class="ltx_Math" display="inline" id="alg1.l16.m2.1"><semantics id="alg1.l16.m2.1a"><mi id="alg1.l16.m2.1.1" mathsize="90%" xref="alg1.l16.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m2.1d">italic_v</annotation></semantics></math><span class="ltx_text" id="alg1.l16.6" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text" id="alg1.l17.2" style="font-size:90%;">Let </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mi id="alg1.l17.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l17.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><ci id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l17.3" style="font-size:90%;"> be an array of </span><math alttext="r" class="ltx_Math" display="inline" id="alg1.l17.m2.1"><semantics id="alg1.l17.m2.1a"><mi id="alg1.l17.m2.1.1" mathsize="90%" xref="alg1.l17.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.m2.1b"><ci id="alg1.l17.m2.1.1.cmml" xref="alg1.l17.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m2.1d">italic_r</annotation></semantics></math><span class="ltx_text" id="alg1.l17.4" style="font-size:90%;"> bucket locks, </span><math alttext="h" class="ltx_Math" display="inline" id="alg1.l17.m3.1"><semantics id="alg1.l17.m3.1a"><mi id="alg1.l17.m3.1.1" mathsize="90%" xref="alg1.l17.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.m3.1b"><ci id="alg1.l17.m3.1.1.cmml" xref="alg1.l17.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m3.1d">italic_h</annotation></semantics></math><span class="ltx_text" id="alg1.l17.5" style="font-size:90%;"> be an array of </span><math alttext="r" class="ltx_Math" display="inline" id="alg1.l17.m4.1"><semantics id="alg1.l17.m4.1a"><mi id="alg1.l17.m4.1.1" mathsize="90%" xref="alg1.l17.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.m4.1b"><ci id="alg1.l17.m4.1.1.cmml" xref="alg1.l17.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m4.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m4.1d">italic_r</annotation></semantics></math><span class="ltx_text" id="alg1.l17.6" style="font-size:90%;"> 16-bit bucket counters, </span><math alttext="t" class="ltx_Math" display="inline" id="alg1.l17.m5.1"><semantics id="alg1.l17.m5.1a"><mi id="alg1.l17.m5.1.1" mathsize="90%" xref="alg1.l17.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.m5.1b"><ci id="alg1.l17.m5.1.1.cmml" xref="alg1.l17.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m5.1d">italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l17.7" style="font-size:90%;"> be an array of </span><math alttext="r" class="ltx_Math" display="inline" id="alg1.l17.m6.1"><semantics id="alg1.l17.m6.1a"><mi id="alg1.l17.m6.1.1" mathsize="90%" xref="alg1.l17.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.m6.1b"><ci id="alg1.l17.m6.1.1.cmml" xref="alg1.l17.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m6.1d">italic_r</annotation></semantics></math><span class="ltx_text" id="alg1.l17.8" style="font-size:90%;"> 32-bit last access times, and </span><math alttext="key" class="ltx_Math" display="inline" id="alg1.l17.m7.1"><semantics id="alg1.l17.m7.1a"><mrow id="alg1.l17.m7.1.1" xref="alg1.l17.m7.1.1.cmml"><mi id="alg1.l17.m7.1.1.2" mathsize="90%" xref="alg1.l17.m7.1.1.2.cmml">k</mi><mo id="alg1.l17.m7.1.1.1" xref="alg1.l17.m7.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m7.1.1.3" mathsize="90%" xref="alg1.l17.m7.1.1.3.cmml">e</mi><mo id="alg1.l17.m7.1.1.1a" xref="alg1.l17.m7.1.1.1.cmml">⁢</mo><mi id="alg1.l17.m7.1.1.4" mathsize="90%" xref="alg1.l17.m7.1.1.4.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m7.1b"><apply id="alg1.l17.m7.1.1.cmml" xref="alg1.l17.m7.1.1"><times id="alg1.l17.m7.1.1.1.cmml" xref="alg1.l17.m7.1.1.1"></times><ci id="alg1.l17.m7.1.1.2.cmml" xref="alg1.l17.m7.1.1.2">𝑘</ci><ci id="alg1.l17.m7.1.1.3.cmml" xref="alg1.l17.m7.1.1.3">𝑒</ci><ci id="alg1.l17.m7.1.1.4.cmml" xref="alg1.l17.m7.1.1.4">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m7.1c">key</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m7.1d">italic_k italic_e italic_y</annotation></semantics></math><span class="ltx_text" id="alg1.l17.9" style="font-size:90%;"> be a randomly generated </span><span class="ltx_ERROR undefined" id="alg1.l17.10">\replaced</span><span class="ltx_text" id="alg1.l17.11" style="font-size:90%;">128-bit64-bit hash key.
</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l18.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg1.l18.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l18.4" style="font-size:90%;">PerBucketMutex</span><span class="ltx_text" id="alg1.l18.5" style="font-size:90%;">(</span><math alttext="\text{src}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><msub id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mtext id="alg1.l18.m1.1.1.2" mathsize="90%" xref="alg1.l18.m1.1.1.2a.cmml">src</mtext><mtext id="alg1.l18.m1.1.1.3" mathsize="90%" xref="alg1.l18.m1.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.2a.cmml" xref="alg1.l18.m1.1.1.2"><mtext id="alg1.l18.m1.1.1.2.cmml" mathsize="90%" xref="alg1.l18.m1.1.1.2">src</mtext></ci><ci id="alg1.l18.m1.1.1.3a.cmml" xref="alg1.l18.m1.1.1.3"><mtext id="alg1.l18.m1.1.1.3.cmml" mathsize="63%" xref="alg1.l18.m1.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\text{src}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l18.6" style="font-size:90%;">, </span><math alttext="\text{dst}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l18.m2.1"><semantics id="alg1.l18.m2.1a"><msub id="alg1.l18.m2.1.1" xref="alg1.l18.m2.1.1.cmml"><mtext id="alg1.l18.m2.1.1.2" mathsize="90%" xref="alg1.l18.m2.1.1.2a.cmml">dst</mtext><mtext id="alg1.l18.m2.1.1.3" mathsize="90%" xref="alg1.l18.m2.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l18.m2.1b"><apply id="alg1.l18.m2.1.1.cmml" xref="alg1.l18.m2.1.1"><csymbol cd="ambiguous" id="alg1.l18.m2.1.1.1.cmml" xref="alg1.l18.m2.1.1">subscript</csymbol><ci id="alg1.l18.m2.1.1.2a.cmml" xref="alg1.l18.m2.1.1.2"><mtext id="alg1.l18.m2.1.1.2.cmml" mathsize="90%" xref="alg1.l18.m2.1.1.2">dst</mtext></ci><ci id="alg1.l18.m2.1.1.3a.cmml" xref="alg1.l18.m2.1.1.3"><mtext id="alg1.l18.m2.1.1.3.cmml" mathsize="63%" xref="alg1.l18.m2.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m2.1c">\text{dst}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m2.1d">dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l18.7" style="font-size:90%;">, </span><span class="ltx_text ltx_markedasmath" id="alg1.l18.8" style="font-size:90%;">prot_num</span><span class="ltx_text" id="alg1.l18.9" style="font-size:90%;">)
</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span><span class="ltx_text" id="alg1.l19.2" style="font-size:90%;">    Compute </span><math alttext="j\leftarrow" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" mathsize="90%" xref="alg1.l19.m1.1.1.2.cmml">j</mi><mo id="alg1.l19.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l19.m1.1.1.1.cmml">←</mo><mi id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><ci id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1">←</ci><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝑗</ci><csymbol cd="latexml" id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">j\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">italic_j ←</annotation></semantics></math><span class="ltx_text" id="alg1.l19.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l19.4" style="font-size:90%;">SipHash</span><span class="ltx_text" id="alg1.l19.5" style="font-size:90%;">(</span><math alttext="\text{dst}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l19.m2.1"><semantics id="alg1.l19.m2.1a"><msub id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml"><mtext id="alg1.l19.m2.1.1.2" mathsize="90%" xref="alg1.l19.m2.1.1.2a.cmml">dst</mtext><mtext id="alg1.l19.m2.1.1.3" mathsize="90%" xref="alg1.l19.m2.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><apply id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.cmml" xref="alg1.l19.m2.1.1">subscript</csymbol><ci id="alg1.l19.m2.1.1.2a.cmml" xref="alg1.l19.m2.1.1.2"><mtext id="alg1.l19.m2.1.1.2.cmml" mathsize="90%" xref="alg1.l19.m2.1.1.2">dst</mtext></ci><ci id="alg1.l19.m2.1.1.3a.cmml" xref="alg1.l19.m2.1.1.3"><mtext id="alg1.l19.m2.1.1.3.cmml" mathsize="63%" xref="alg1.l19.m2.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">\text{dst}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m2.1d">dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l19.6" style="font-size:90%;">, </span><math alttext="\text{src}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l19.m3.1"><semantics id="alg1.l19.m3.1a"><msub id="alg1.l19.m3.1.1" xref="alg1.l19.m3.1.1.cmml"><mtext id="alg1.l19.m3.1.1.2" mathsize="90%" xref="alg1.l19.m3.1.1.2a.cmml">src</mtext><mtext id="alg1.l19.m3.1.1.3" mathsize="90%" xref="alg1.l19.m3.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m3.1b"><apply id="alg1.l19.m3.1.1.cmml" xref="alg1.l19.m3.1.1"><csymbol cd="ambiguous" id="alg1.l19.m3.1.1.1.cmml" xref="alg1.l19.m3.1.1">subscript</csymbol><ci id="alg1.l19.m3.1.1.2a.cmml" xref="alg1.l19.m3.1.1.2"><mtext id="alg1.l19.m3.1.1.2.cmml" mathsize="90%" xref="alg1.l19.m3.1.1.2">src</mtext></ci><ci id="alg1.l19.m3.1.1.3a.cmml" xref="alg1.l19.m3.1.1.3"><mtext id="alg1.l19.m3.1.1.3.cmml" mathsize="63%" xref="alg1.l19.m3.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m3.1c">\text{src}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m3.1d">src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l19.7" style="font-size:90%;">, </span><span class="ltx_text ltx_markedasmath" id="alg1.l19.8" style="font-size:90%;">prot_num</span><span class="ltx_text" id="alg1.l19.9" style="font-size:90%;">, </span><math alttext="key" class="ltx_Math" display="inline" id="alg1.l19.m5.1"><semantics id="alg1.l19.m5.1a"><mrow id="alg1.l19.m5.1.1" xref="alg1.l19.m5.1.1.cmml"><mi id="alg1.l19.m5.1.1.2" mathsize="90%" xref="alg1.l19.m5.1.1.2.cmml">k</mi><mo id="alg1.l19.m5.1.1.1" xref="alg1.l19.m5.1.1.1.cmml">⁢</mo><mi id="alg1.l19.m5.1.1.3" mathsize="90%" xref="alg1.l19.m5.1.1.3.cmml">e</mi><mo id="alg1.l19.m5.1.1.1a" xref="alg1.l19.m5.1.1.1.cmml">⁢</mo><mi id="alg1.l19.m5.1.1.4" mathsize="90%" xref="alg1.l19.m5.1.1.4.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m5.1b"><apply id="alg1.l19.m5.1.1.cmml" xref="alg1.l19.m5.1.1"><times id="alg1.l19.m5.1.1.1.cmml" xref="alg1.l19.m5.1.1.1"></times><ci id="alg1.l19.m5.1.1.2.cmml" xref="alg1.l19.m5.1.1.2">𝑘</ci><ci id="alg1.l19.m5.1.1.3.cmml" xref="alg1.l19.m5.1.1.3">𝑒</ci><ci id="alg1.l19.m5.1.1.4.cmml" xref="alg1.l19.m5.1.1.4">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m5.1c">key</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m5.1d">italic_k italic_e italic_y</annotation></semantics></math><span class="ltx_text" id="alg1.l19.10" style="font-size:90%;">) mod </span><math alttext="r" class="ltx_Math" display="inline" id="alg1.l19.m6.1"><semantics id="alg1.l19.m6.1a"><mi id="alg1.l19.m6.1.1" mathsize="90%" xref="alg1.l19.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m6.1b"><ci id="alg1.l19.m6.1.1.cmml" xref="alg1.l19.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m6.1d">italic_r</annotation></semantics></math><span class="ltx_text" id="alg1.l19.11" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span><span class="ltx_text" id="alg1.l20.2" style="font-size:90%;">    Lock </span><math alttext="\ell[j]" class="ltx_Math" display="inline" id="alg1.l20.m1.1"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.2" xref="alg1.l20.m1.1.2.cmml"><mi id="alg1.l20.m1.1.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l20.m1.1.2.2.cmml">ℓ</mi><mo id="alg1.l20.m1.1.2.1" xref="alg1.l20.m1.1.2.1.cmml">⁢</mo><mrow id="alg1.l20.m1.1.2.3.2" xref="alg1.l20.m1.1.2.3.1.cmml"><mo id="alg1.l20.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l20.m1.1.2.3.1.1.cmml">[</mo><mi id="alg1.l20.m1.1.1" mathsize="90%" xref="alg1.l20.m1.1.1.cmml">j</mi><mo id="alg1.l20.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l20.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.2.cmml" xref="alg1.l20.m1.1.2"><times id="alg1.l20.m1.1.2.1.cmml" xref="alg1.l20.m1.1.2.1"></times><ci id="alg1.l20.m1.1.2.2.cmml" xref="alg1.l20.m1.1.2.2">ℓ</ci><apply id="alg1.l20.m1.1.2.3.1.cmml" xref="alg1.l20.m1.1.2.3.2"><csymbol cd="latexml" id="alg1.l20.m1.1.2.3.1.1.cmml" xref="alg1.l20.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">\ell[j]</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.1d">roman_ℓ [ italic_j ]</annotation></semantics></math><span class="ltx_text" id="alg1.l20.3" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span><span class="ltx_text" id="alg1.l21.2" style="font-size:90%;">    Get the current time </span><math alttext="t_{\text{now}}" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><msub id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" mathsize="90%" xref="alg1.l21.m1.1.1.2.cmml">t</mi><mtext id="alg1.l21.m1.1.1.3" mathsize="90%" xref="alg1.l21.m1.1.1.3a.cmml">now</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1">subscript</csymbol><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝑡</ci><ci id="alg1.l21.m1.1.1.3a.cmml" xref="alg1.l21.m1.1.1.3"><mtext id="alg1.l21.m1.1.1.3.cmml" mathsize="63%" xref="alg1.l21.m1.1.1.3">now</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">t_{\text{now}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l21.3" style="font-size:90%;"> and generate a random increment </span><math alttext="inc\leftarrow\mathcal{U}(1,\max\{1,t_{\text{now}}-t[j]\})" class="ltx_Math" display="inline" id="alg1.l21.m2.5"><semantics id="alg1.l21.m2.5a"><mrow id="alg1.l21.m2.5.5" xref="alg1.l21.m2.5.5.cmml"><mrow id="alg1.l21.m2.5.5.3" xref="alg1.l21.m2.5.5.3.cmml"><mi id="alg1.l21.m2.5.5.3.2" mathsize="90%" xref="alg1.l21.m2.5.5.3.2.cmml">i</mi><mo id="alg1.l21.m2.5.5.3.1" xref="alg1.l21.m2.5.5.3.1.cmml">⁢</mo><mi id="alg1.l21.m2.5.5.3.3" mathsize="90%" xref="alg1.l21.m2.5.5.3.3.cmml">n</mi><mo id="alg1.l21.m2.5.5.3.1a" xref="alg1.l21.m2.5.5.3.1.cmml">⁢</mo><mi id="alg1.l21.m2.5.5.3.4" mathsize="90%" xref="alg1.l21.m2.5.5.3.4.cmml">c</mi></mrow><mo id="alg1.l21.m2.5.5.2" mathsize="90%" stretchy="false" xref="alg1.l21.m2.5.5.2.cmml">←</mo><mrow id="alg1.l21.m2.5.5.1" xref="alg1.l21.m2.5.5.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m2.5.5.1.3" mathsize="90%" xref="alg1.l21.m2.5.5.1.3.cmml">𝒰</mi><mo id="alg1.l21.m2.5.5.1.2" xref="alg1.l21.m2.5.5.1.2.cmml">⁢</mo><mrow id="alg1.l21.m2.5.5.1.1.1" xref="alg1.l21.m2.5.5.1.1.2.cmml"><mo id="alg1.l21.m2.5.5.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l21.m2.5.5.1.1.2.cmml">(</mo><mn id="alg1.l21.m2.4.4" mathsize="90%" xref="alg1.l21.m2.4.4.cmml">1</mn><mo id="alg1.l21.m2.5.5.1.1.1.3" mathsize="90%" xref="alg1.l21.m2.5.5.1.1.2.cmml">,</mo><mrow id="alg1.l21.m2.5.5.1.1.1.1.1" xref="alg1.l21.m2.5.5.1.1.1.1.2.cmml"><mi id="alg1.l21.m2.2.2" mathsize="90%" xref="alg1.l21.m2.2.2.cmml">max</mi><mo id="alg1.l21.m2.5.5.1.1.1.1.1a" xref="alg1.l21.m2.5.5.1.1.1.1.2.cmml">⁡</mo><mrow id="alg1.l21.m2.5.5.1.1.1.1.1.1" xref="alg1.l21.m2.5.5.1.1.1.1.2.cmml"><mo id="alg1.l21.m2.5.5.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.2.cmml">{</mo><mn id="alg1.l21.m2.3.3" mathsize="90%" xref="alg1.l21.m2.3.3.cmml">1</mn><mo id="alg1.l21.m2.5.5.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.2.cmml">,</mo><mrow id="alg1.l21.m2.5.5.1.1.1.1.1.1.1" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.cmml"><msub id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.2.cmml">t</mi><mtext id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.3a.cmml">now</mtext></msub><mo id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.1" mathsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.1" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.2" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.1.1.cmml">[</mo><mi id="alg1.l21.m2.1.1" mathsize="90%" xref="alg1.l21.m2.1.1.cmml">j</mi><mo id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="alg1.l21.m2.5.5.1.1.1.1.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l21.m2.5.5.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="alg1.l21.m2.5.5.1.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l21.m2.5.5.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.5b"><apply id="alg1.l21.m2.5.5.cmml" xref="alg1.l21.m2.5.5"><ci id="alg1.l21.m2.5.5.2.cmml" xref="alg1.l21.m2.5.5.2">←</ci><apply id="alg1.l21.m2.5.5.3.cmml" xref="alg1.l21.m2.5.5.3"><times id="alg1.l21.m2.5.5.3.1.cmml" xref="alg1.l21.m2.5.5.3.1"></times><ci id="alg1.l21.m2.5.5.3.2.cmml" xref="alg1.l21.m2.5.5.3.2">𝑖</ci><ci id="alg1.l21.m2.5.5.3.3.cmml" xref="alg1.l21.m2.5.5.3.3">𝑛</ci><ci id="alg1.l21.m2.5.5.3.4.cmml" xref="alg1.l21.m2.5.5.3.4">𝑐</ci></apply><apply id="alg1.l21.m2.5.5.1.cmml" xref="alg1.l21.m2.5.5.1"><times id="alg1.l21.m2.5.5.1.2.cmml" xref="alg1.l21.m2.5.5.1.2"></times><ci id="alg1.l21.m2.5.5.1.3.cmml" xref="alg1.l21.m2.5.5.1.3">𝒰</ci><interval closure="open" id="alg1.l21.m2.5.5.1.1.2.cmml" xref="alg1.l21.m2.5.5.1.1.1"><cn id="alg1.l21.m2.4.4.cmml" type="integer" xref="alg1.l21.m2.4.4">1</cn><apply id="alg1.l21.m2.5.5.1.1.1.1.2.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1"><max id="alg1.l21.m2.2.2.cmml" xref="alg1.l21.m2.2.2"></max><cn id="alg1.l21.m2.3.3.cmml" type="integer" xref="alg1.l21.m2.3.3">1</cn><apply id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1"><minus id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.3.cmml" mathsize="63%" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.2.3">now</mtext></ci></apply><apply id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3"><times id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.1"></times><ci id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.2"><csymbol cd="latexml" id="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.1.1.cmml" xref="alg1.l21.m2.5.5.1.1.1.1.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1">𝑗</ci></apply></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.5c">inc\leftarrow\mathcal{U}(1,\max\{1,t_{\text{now}}-t[j]\})</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m2.5d">italic_i italic_n italic_c ← caligraphic_U ( 1 , roman_max { 1 , italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT - italic_t [ italic_j ] } )</annotation></semantics></math><span class="ltx_text" id="alg1.l21.4" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span><span class="ltx_text" id="alg1.l22.2" style="font-size:90%;">    Update </span><math alttext="h[j]\leftarrow h[j]+inc" class="ltx_Math" display="inline" id="alg1.l22.m1.2"><semantics id="alg1.l22.m1.2a"><mrow id="alg1.l22.m1.2.3" xref="alg1.l22.m1.2.3.cmml"><mrow id="alg1.l22.m1.2.3.2" xref="alg1.l22.m1.2.3.2.cmml"><mi id="alg1.l22.m1.2.3.2.2" mathsize="90%" xref="alg1.l22.m1.2.3.2.2.cmml">h</mi><mo id="alg1.l22.m1.2.3.2.1" xref="alg1.l22.m1.2.3.2.1.cmml">⁢</mo><mrow id="alg1.l22.m1.2.3.2.3.2" xref="alg1.l22.m1.2.3.2.3.1.cmml"><mo id="alg1.l22.m1.2.3.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l22.m1.2.3.2.3.1.1.cmml">[</mo><mi id="alg1.l22.m1.1.1" mathsize="90%" xref="alg1.l22.m1.1.1.cmml">j</mi><mo id="alg1.l22.m1.2.3.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l22.m1.2.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l22.m1.2.3.1" mathsize="90%" stretchy="false" xref="alg1.l22.m1.2.3.1.cmml">←</mo><mrow id="alg1.l22.m1.2.3.3" xref="alg1.l22.m1.2.3.3.cmml"><mrow id="alg1.l22.m1.2.3.3.2" xref="alg1.l22.m1.2.3.3.2.cmml"><mi id="alg1.l22.m1.2.3.3.2.2" mathsize="90%" xref="alg1.l22.m1.2.3.3.2.2.cmml">h</mi><mo id="alg1.l22.m1.2.3.3.2.1" xref="alg1.l22.m1.2.3.3.2.1.cmml">⁢</mo><mrow id="alg1.l22.m1.2.3.3.2.3.2" xref="alg1.l22.m1.2.3.3.2.3.1.cmml"><mo id="alg1.l22.m1.2.3.3.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l22.m1.2.3.3.2.3.1.1.cmml">[</mo><mi id="alg1.l22.m1.2.2" mathsize="90%" xref="alg1.l22.m1.2.2.cmml">j</mi><mo id="alg1.l22.m1.2.3.3.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l22.m1.2.3.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l22.m1.2.3.3.1" mathsize="90%" xref="alg1.l22.m1.2.3.3.1.cmml">+</mo><mrow id="alg1.l22.m1.2.3.3.3" xref="alg1.l22.m1.2.3.3.3.cmml"><mi id="alg1.l22.m1.2.3.3.3.2" mathsize="90%" xref="alg1.l22.m1.2.3.3.3.2.cmml">i</mi><mo id="alg1.l22.m1.2.3.3.3.1" xref="alg1.l22.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l22.m1.2.3.3.3.3" mathsize="90%" xref="alg1.l22.m1.2.3.3.3.3.cmml">n</mi><mo id="alg1.l22.m1.2.3.3.3.1a" xref="alg1.l22.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l22.m1.2.3.3.3.4" mathsize="90%" xref="alg1.l22.m1.2.3.3.3.4.cmml">c</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.2b"><apply id="alg1.l22.m1.2.3.cmml" xref="alg1.l22.m1.2.3"><ci id="alg1.l22.m1.2.3.1.cmml" xref="alg1.l22.m1.2.3.1">←</ci><apply id="alg1.l22.m1.2.3.2.cmml" xref="alg1.l22.m1.2.3.2"><times id="alg1.l22.m1.2.3.2.1.cmml" xref="alg1.l22.m1.2.3.2.1"></times><ci id="alg1.l22.m1.2.3.2.2.cmml" xref="alg1.l22.m1.2.3.2.2">ℎ</ci><apply id="alg1.l22.m1.2.3.2.3.1.cmml" xref="alg1.l22.m1.2.3.2.3.2"><csymbol cd="latexml" id="alg1.l22.m1.2.3.2.3.1.1.cmml" xref="alg1.l22.m1.2.3.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">𝑗</ci></apply></apply><apply id="alg1.l22.m1.2.3.3.cmml" xref="alg1.l22.m1.2.3.3"><plus id="alg1.l22.m1.2.3.3.1.cmml" xref="alg1.l22.m1.2.3.3.1"></plus><apply id="alg1.l22.m1.2.3.3.2.cmml" xref="alg1.l22.m1.2.3.3.2"><times id="alg1.l22.m1.2.3.3.2.1.cmml" xref="alg1.l22.m1.2.3.3.2.1"></times><ci id="alg1.l22.m1.2.3.3.2.2.cmml" xref="alg1.l22.m1.2.3.3.2.2">ℎ</ci><apply id="alg1.l22.m1.2.3.3.2.3.1.cmml" xref="alg1.l22.m1.2.3.3.2.3.2"><csymbol cd="latexml" id="alg1.l22.m1.2.3.3.2.3.1.1.cmml" xref="alg1.l22.m1.2.3.3.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l22.m1.2.2.cmml" xref="alg1.l22.m1.2.2">𝑗</ci></apply></apply><apply id="alg1.l22.m1.2.3.3.3.cmml" xref="alg1.l22.m1.2.3.3.3"><times id="alg1.l22.m1.2.3.3.3.1.cmml" xref="alg1.l22.m1.2.3.3.3.1"></times><ci id="alg1.l22.m1.2.3.3.3.2.cmml" xref="alg1.l22.m1.2.3.3.3.2">𝑖</ci><ci id="alg1.l22.m1.2.3.3.3.3.cmml" xref="alg1.l22.m1.2.3.3.3.3">𝑛</ci><ci id="alg1.l22.m1.2.3.3.3.4.cmml" xref="alg1.l22.m1.2.3.3.3.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.2c">h[j]\leftarrow h[j]+inc</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m1.2d">italic_h [ italic_j ] ← italic_h [ italic_j ] + italic_i italic_n italic_c</annotation></semantics></math><span class="ltx_text" id="alg1.l22.3" style="font-size:90%;"> and </span><math alttext="t[j]\leftarrow t_{\text{now}}" class="ltx_Math" display="inline" id="alg1.l22.m2.1"><semantics id="alg1.l22.m2.1a"><mrow id="alg1.l22.m2.1.2" xref="alg1.l22.m2.1.2.cmml"><mrow id="alg1.l22.m2.1.2.2" xref="alg1.l22.m2.1.2.2.cmml"><mi id="alg1.l22.m2.1.2.2.2" mathsize="90%" xref="alg1.l22.m2.1.2.2.2.cmml">t</mi><mo id="alg1.l22.m2.1.2.2.1" xref="alg1.l22.m2.1.2.2.1.cmml">⁢</mo><mrow id="alg1.l22.m2.1.2.2.3.2" xref="alg1.l22.m2.1.2.2.3.1.cmml"><mo id="alg1.l22.m2.1.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l22.m2.1.2.2.3.1.1.cmml">[</mo><mi id="alg1.l22.m2.1.1" mathsize="90%" xref="alg1.l22.m2.1.1.cmml">j</mi><mo id="alg1.l22.m2.1.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l22.m2.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l22.m2.1.2.1" mathsize="90%" stretchy="false" xref="alg1.l22.m2.1.2.1.cmml">←</mo><msub id="alg1.l22.m2.1.2.3" xref="alg1.l22.m2.1.2.3.cmml"><mi id="alg1.l22.m2.1.2.3.2" mathsize="90%" xref="alg1.l22.m2.1.2.3.2.cmml">t</mi><mtext id="alg1.l22.m2.1.2.3.3" mathsize="90%" xref="alg1.l22.m2.1.2.3.3a.cmml">now</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m2.1b"><apply id="alg1.l22.m2.1.2.cmml" xref="alg1.l22.m2.1.2"><ci id="alg1.l22.m2.1.2.1.cmml" xref="alg1.l22.m2.1.2.1">←</ci><apply id="alg1.l22.m2.1.2.2.cmml" xref="alg1.l22.m2.1.2.2"><times id="alg1.l22.m2.1.2.2.1.cmml" xref="alg1.l22.m2.1.2.2.1"></times><ci id="alg1.l22.m2.1.2.2.2.cmml" xref="alg1.l22.m2.1.2.2.2">𝑡</ci><apply id="alg1.l22.m2.1.2.2.3.1.cmml" xref="alg1.l22.m2.1.2.2.3.2"><csymbol cd="latexml" id="alg1.l22.m2.1.2.2.3.1.1.cmml" xref="alg1.l22.m2.1.2.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l22.m2.1.1.cmml" xref="alg1.l22.m2.1.1">𝑗</ci></apply></apply><apply id="alg1.l22.m2.1.2.3.cmml" xref="alg1.l22.m2.1.2.3"><csymbol cd="ambiguous" id="alg1.l22.m2.1.2.3.1.cmml" xref="alg1.l22.m2.1.2.3">subscript</csymbol><ci id="alg1.l22.m2.1.2.3.2.cmml" xref="alg1.l22.m2.1.2.3.2">𝑡</ci><ci id="alg1.l22.m2.1.2.3.3a.cmml" xref="alg1.l22.m2.1.2.3.3"><mtext id="alg1.l22.m2.1.2.3.3.cmml" mathsize="63%" xref="alg1.l22.m2.1.2.3.3">now</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m2.1c">t[j]\leftarrow t_{\text{now}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m2.1d">italic_t [ italic_j ] ← italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l22.4" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">23:</span></span><span class="ltx_text" id="alg1.l23.2" style="font-size:90%;">    Store </span><math alttext="v\leftarrow h[j]" class="ltx_Math" display="inline" id="alg1.l23.m1.1"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.2" xref="alg1.l23.m1.1.2.cmml"><mi id="alg1.l23.m1.1.2.2" mathsize="90%" xref="alg1.l23.m1.1.2.2.cmml">v</mi><mo id="alg1.l23.m1.1.2.1" mathsize="90%" stretchy="false" xref="alg1.l23.m1.1.2.1.cmml">←</mo><mrow id="alg1.l23.m1.1.2.3" xref="alg1.l23.m1.1.2.3.cmml"><mi id="alg1.l23.m1.1.2.3.2" mathsize="90%" xref="alg1.l23.m1.1.2.3.2.cmml">h</mi><mo id="alg1.l23.m1.1.2.3.1" xref="alg1.l23.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l23.m1.1.2.3.3.2" xref="alg1.l23.m1.1.2.3.3.1.cmml"><mo id="alg1.l23.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l23.m1.1.2.3.3.1.1.cmml">[</mo><mi id="alg1.l23.m1.1.1" mathsize="90%" xref="alg1.l23.m1.1.1.cmml">j</mi><mo id="alg1.l23.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l23.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.2.cmml" xref="alg1.l23.m1.1.2"><ci id="alg1.l23.m1.1.2.1.cmml" xref="alg1.l23.m1.1.2.1">←</ci><ci id="alg1.l23.m1.1.2.2.cmml" xref="alg1.l23.m1.1.2.2">𝑣</ci><apply id="alg1.l23.m1.1.2.3.cmml" xref="alg1.l23.m1.1.2.3"><times id="alg1.l23.m1.1.2.3.1.cmml" xref="alg1.l23.m1.1.2.3.1"></times><ci id="alg1.l23.m1.1.2.3.2.cmml" xref="alg1.l23.m1.1.2.3.2">ℎ</ci><apply id="alg1.l23.m1.1.2.3.3.1.cmml" xref="alg1.l23.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg1.l23.m1.1.2.3.3.1.1.cmml" xref="alg1.l23.m1.1.2.3.3.2.1">delimited-[]</csymbol><ci id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">v\leftarrow h[j]</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.1d">italic_v ← italic_h [ italic_j ]</annotation></semantics></math><span class="ltx_text" id="alg1.l23.3" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l24.1.1.1" style="font-size:80%;">24:</span></span><span class="ltx_text" id="alg1.l24.2" style="font-size:90%;">    Unlock </span><math alttext="\ell[j]" class="ltx_Math" display="inline" id="alg1.l24.m1.1"><semantics id="alg1.l24.m1.1a"><mrow id="alg1.l24.m1.1.2" xref="alg1.l24.m1.1.2.cmml"><mi id="alg1.l24.m1.1.2.2" mathsize="90%" mathvariant="normal" xref="alg1.l24.m1.1.2.2.cmml">ℓ</mi><mo id="alg1.l24.m1.1.2.1" xref="alg1.l24.m1.1.2.1.cmml">⁢</mo><mrow id="alg1.l24.m1.1.2.3.2" xref="alg1.l24.m1.1.2.3.1.cmml"><mo id="alg1.l24.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l24.m1.1.2.3.1.1.cmml">[</mo><mi id="alg1.l24.m1.1.1" mathsize="90%" xref="alg1.l24.m1.1.1.cmml">j</mi><mo id="alg1.l24.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l24.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.2.cmml" xref="alg1.l24.m1.1.2"><times id="alg1.l24.m1.1.2.1.cmml" xref="alg1.l24.m1.1.2.1"></times><ci id="alg1.l24.m1.1.2.2.cmml" xref="alg1.l24.m1.1.2.2">ℓ</ci><apply id="alg1.l24.m1.1.2.3.1.cmml" xref="alg1.l24.m1.1.2.3.2"><csymbol cd="latexml" id="alg1.l24.m1.1.2.3.1.1.cmml" xref="alg1.l24.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">\ell[j]</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.1d">roman_ℓ [ italic_j ]</annotation></semantics></math><span class="ltx_text" id="alg1.l24.3" style="font-size:90%;"> and </span><span class="ltx_text ltx_font_bold" id="alg1.l24.4" style="font-size:90%;">return</span><span class="ltx_text" id="alg1.l24.5" style="font-size:90%;"> </span><math alttext="v" class="ltx_Math" display="inline" id="alg1.l24.m2.1"><semantics id="alg1.l24.m2.1a"><mi id="alg1.l24.m2.1.1" mathsize="90%" xref="alg1.l24.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l24.m2.1b"><ci id="alg1.l24.m2.1.1.cmml" xref="alg1.l24.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m2.1d">italic_v</annotation></semantics></math><span class="ltx_text" id="alg1.l24.6" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l25.1.1.1" style="font-size:80%;">25:</span></span><span class="ltx_text" id="alg1.l25.2" style="font-size:90%;">Let </span><math alttext="h" class="ltx_Math" display="inline" id="alg1.l25.m1.1"><semantics id="alg1.l25.m1.1a"><mi id="alg1.l25.m1.1.1" mathsize="90%" xref="alg1.l25.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><ci id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.1d">italic_h</annotation></semantics></math><span class="ltx_text" id="alg1.l25.3" style="font-size:90%;"> be an array of </span><math alttext="r" class="ltx_Math" display="inline" id="alg1.l25.m2.1"><semantics id="alg1.l25.m2.1a"><mi id="alg1.l25.m2.1.1" mathsize="90%" xref="alg1.l25.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l25.m2.1b"><ci id="alg1.l25.m2.1.1.cmml" xref="alg1.l25.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m2.1d">italic_r</annotation></semantics></math><span class="ltx_text" id="alg1.l25.4" style="font-size:90%;"> 16-bit atomic bucket counters, </span><math alttext="t" class="ltx_Math" display="inline" id="alg1.l25.m3.1"><semantics id="alg1.l25.m3.1a"><mi id="alg1.l25.m3.1.1" mathsize="90%" xref="alg1.l25.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l25.m3.1b"><ci id="alg1.l25.m3.1.1.cmml" xref="alg1.l25.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m3.1d">italic_t</annotation></semantics></math><span class="ltx_text" id="alg1.l25.5" style="font-size:90%;"> be an array of </span><math alttext="r" class="ltx_Math" display="inline" id="alg1.l25.m4.1"><semantics id="alg1.l25.m4.1a"><mi id="alg1.l25.m4.1.1" mathsize="90%" xref="alg1.l25.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l25.m4.1b"><ci id="alg1.l25.m4.1.1.cmml" xref="alg1.l25.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m4.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m4.1d">italic_r</annotation></semantics></math><span class="ltx_text" id="alg1.l25.6" style="font-size:90%;"> 32-bit atomic last access times, and </span><math alttext="key" class="ltx_Math" display="inline" id="alg1.l25.m5.1"><semantics id="alg1.l25.m5.1a"><mrow id="alg1.l25.m5.1.1" xref="alg1.l25.m5.1.1.cmml"><mi id="alg1.l25.m5.1.1.2" mathsize="90%" xref="alg1.l25.m5.1.1.2.cmml">k</mi><mo id="alg1.l25.m5.1.1.1" xref="alg1.l25.m5.1.1.1.cmml">⁢</mo><mi id="alg1.l25.m5.1.1.3" mathsize="90%" xref="alg1.l25.m5.1.1.3.cmml">e</mi><mo id="alg1.l25.m5.1.1.1a" xref="alg1.l25.m5.1.1.1.cmml">⁢</mo><mi id="alg1.l25.m5.1.1.4" mathsize="90%" xref="alg1.l25.m5.1.1.4.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m5.1b"><apply id="alg1.l25.m5.1.1.cmml" xref="alg1.l25.m5.1.1"><times id="alg1.l25.m5.1.1.1.cmml" xref="alg1.l25.m5.1.1.1"></times><ci id="alg1.l25.m5.1.1.2.cmml" xref="alg1.l25.m5.1.1.2">𝑘</ci><ci id="alg1.l25.m5.1.1.3.cmml" xref="alg1.l25.m5.1.1.3">𝑒</ci><ci id="alg1.l25.m5.1.1.4.cmml" xref="alg1.l25.m5.1.1.4">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m5.1c">key</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m5.1d">italic_k italic_e italic_y</annotation></semantics></math><span class="ltx_text" id="alg1.l25.7" style="font-size:90%;"> be a randomly generated </span><span class="ltx_ERROR undefined" id="alg1.l25.8">\replaced</span><span class="ltx_text" id="alg1.l25.9" style="font-size:90%;">128-bit64-bit hash key.
</span>
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l26.1.1.1" style="font-size:80%;">26:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l26.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg1.l26.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l26.4" style="font-size:90%;">PerBucketLinux</span><span class="ltx_text" id="alg1.l26.5" style="font-size:90%;">(</span><math alttext="\text{src}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l26.m1.1"><semantics id="alg1.l26.m1.1a"><msub id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml"><mtext id="alg1.l26.m1.1.1.2" mathsize="90%" xref="alg1.l26.m1.1.1.2a.cmml">src</mtext><mtext id="alg1.l26.m1.1.1.3" mathsize="90%" xref="alg1.l26.m1.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><apply id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.cmml" xref="alg1.l26.m1.1.1">subscript</csymbol><ci id="alg1.l26.m1.1.1.2a.cmml" xref="alg1.l26.m1.1.1.2"><mtext id="alg1.l26.m1.1.1.2.cmml" mathsize="90%" xref="alg1.l26.m1.1.1.2">src</mtext></ci><ci id="alg1.l26.m1.1.1.3a.cmml" xref="alg1.l26.m1.1.1.3"><mtext id="alg1.l26.m1.1.1.3.cmml" mathsize="63%" xref="alg1.l26.m1.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">\text{src}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m1.1d">src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l26.6" style="font-size:90%;">, </span><math alttext="\text{dst}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l26.m2.1"><semantics id="alg1.l26.m2.1a"><msub id="alg1.l26.m2.1.1" xref="alg1.l26.m2.1.1.cmml"><mtext id="alg1.l26.m2.1.1.2" mathsize="90%" xref="alg1.l26.m2.1.1.2a.cmml">dst</mtext><mtext id="alg1.l26.m2.1.1.3" mathsize="90%" xref="alg1.l26.m2.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l26.m2.1b"><apply id="alg1.l26.m2.1.1.cmml" xref="alg1.l26.m2.1.1"><csymbol cd="ambiguous" id="alg1.l26.m2.1.1.1.cmml" xref="alg1.l26.m2.1.1">subscript</csymbol><ci id="alg1.l26.m2.1.1.2a.cmml" xref="alg1.l26.m2.1.1.2"><mtext id="alg1.l26.m2.1.1.2.cmml" mathsize="90%" xref="alg1.l26.m2.1.1.2">dst</mtext></ci><ci id="alg1.l26.m2.1.1.3a.cmml" xref="alg1.l26.m2.1.1.3"><mtext id="alg1.l26.m2.1.1.3.cmml" mathsize="63%" xref="alg1.l26.m2.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m2.1c">\text{dst}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m2.1d">dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l26.7" style="font-size:90%;">, </span><span class="ltx_text ltx_markedasmath" id="alg1.l26.8" style="font-size:90%;">prot_num</span><span class="ltx_text" id="alg1.l26.9" style="font-size:90%;">)
</span>
</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l27.1.1.1" style="font-size:80%;">27:</span></span><span class="ltx_text" id="alg1.l27.2" style="font-size:90%;">    Compute </span><math alttext="j\leftarrow" class="ltx_Math" display="inline" id="alg1.l27.m1.1"><semantics id="alg1.l27.m1.1a"><mrow id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml"><mi id="alg1.l27.m1.1.1.2" mathsize="90%" xref="alg1.l27.m1.1.1.2.cmml">j</mi><mo id="alg1.l27.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l27.m1.1.1.1.cmml">←</mo><mi id="alg1.l27.m1.1.1.3" xref="alg1.l27.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b"><apply id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1"><ci id="alg1.l27.m1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1">←</ci><ci id="alg1.l27.m1.1.1.2.cmml" xref="alg1.l27.m1.1.1.2">𝑗</ci><csymbol cd="latexml" id="alg1.l27.m1.1.1.3.cmml" xref="alg1.l27.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.1c">j\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m1.1d">italic_j ←</annotation></semantics></math><span class="ltx_text" id="alg1.l27.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l27.4" style="font-size:90%;">SipHash</span><span class="ltx_text" id="alg1.l27.5" style="font-size:90%;">(</span><math alttext="\text{dst}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l27.m2.1"><semantics id="alg1.l27.m2.1a"><msub id="alg1.l27.m2.1.1" xref="alg1.l27.m2.1.1.cmml"><mtext id="alg1.l27.m2.1.1.2" mathsize="90%" xref="alg1.l27.m2.1.1.2a.cmml">dst</mtext><mtext id="alg1.l27.m2.1.1.3" mathsize="90%" xref="alg1.l27.m2.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l27.m2.1b"><apply id="alg1.l27.m2.1.1.cmml" xref="alg1.l27.m2.1.1"><csymbol cd="ambiguous" id="alg1.l27.m2.1.1.1.cmml" xref="alg1.l27.m2.1.1">subscript</csymbol><ci id="alg1.l27.m2.1.1.2a.cmml" xref="alg1.l27.m2.1.1.2"><mtext id="alg1.l27.m2.1.1.2.cmml" mathsize="90%" xref="alg1.l27.m2.1.1.2">dst</mtext></ci><ci id="alg1.l27.m2.1.1.3a.cmml" xref="alg1.l27.m2.1.1.3"><mtext id="alg1.l27.m2.1.1.3.cmml" mathsize="63%" xref="alg1.l27.m2.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m2.1c">\text{dst}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m2.1d">dst start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l27.6" style="font-size:90%;">, </span><math alttext="\text{src}_{\text{ipaddr}}" class="ltx_Math" display="inline" id="alg1.l27.m3.1"><semantics id="alg1.l27.m3.1a"><msub id="alg1.l27.m3.1.1" xref="alg1.l27.m3.1.1.cmml"><mtext id="alg1.l27.m3.1.1.2" mathsize="90%" xref="alg1.l27.m3.1.1.2a.cmml">src</mtext><mtext id="alg1.l27.m3.1.1.3" mathsize="90%" xref="alg1.l27.m3.1.1.3a.cmml">ipaddr</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l27.m3.1b"><apply id="alg1.l27.m3.1.1.cmml" xref="alg1.l27.m3.1.1"><csymbol cd="ambiguous" id="alg1.l27.m3.1.1.1.cmml" xref="alg1.l27.m3.1.1">subscript</csymbol><ci id="alg1.l27.m3.1.1.2a.cmml" xref="alg1.l27.m3.1.1.2"><mtext id="alg1.l27.m3.1.1.2.cmml" mathsize="90%" xref="alg1.l27.m3.1.1.2">src</mtext></ci><ci id="alg1.l27.m3.1.1.3a.cmml" xref="alg1.l27.m3.1.1.3"><mtext id="alg1.l27.m3.1.1.3.cmml" mathsize="63%" xref="alg1.l27.m3.1.1.3">ipaddr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m3.1c">\text{src}_{\text{ipaddr}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m3.1d">src start_POSTSUBSCRIPT ipaddr end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l27.7" style="font-size:90%;">, </span><span class="ltx_text ltx_markedasmath" id="alg1.l27.8" style="font-size:90%;">prot_num</span><span class="ltx_text" id="alg1.l27.9" style="font-size:90%;">, </span><math alttext="key" class="ltx_Math" display="inline" id="alg1.l27.m5.1"><semantics id="alg1.l27.m5.1a"><mrow id="alg1.l27.m5.1.1" xref="alg1.l27.m5.1.1.cmml"><mi id="alg1.l27.m5.1.1.2" mathsize="90%" xref="alg1.l27.m5.1.1.2.cmml">k</mi><mo id="alg1.l27.m5.1.1.1" xref="alg1.l27.m5.1.1.1.cmml">⁢</mo><mi id="alg1.l27.m5.1.1.3" mathsize="90%" xref="alg1.l27.m5.1.1.3.cmml">e</mi><mo id="alg1.l27.m5.1.1.1a" xref="alg1.l27.m5.1.1.1.cmml">⁢</mo><mi id="alg1.l27.m5.1.1.4" mathsize="90%" xref="alg1.l27.m5.1.1.4.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m5.1b"><apply id="alg1.l27.m5.1.1.cmml" xref="alg1.l27.m5.1.1"><times id="alg1.l27.m5.1.1.1.cmml" xref="alg1.l27.m5.1.1.1"></times><ci id="alg1.l27.m5.1.1.2.cmml" xref="alg1.l27.m5.1.1.2">𝑘</ci><ci id="alg1.l27.m5.1.1.3.cmml" xref="alg1.l27.m5.1.1.3">𝑒</ci><ci id="alg1.l27.m5.1.1.4.cmml" xref="alg1.l27.m5.1.1.4">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m5.1c">key</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m5.1d">italic_k italic_e italic_y</annotation></semantics></math><span class="ltx_text" id="alg1.l27.10" style="font-size:90%;">) mod </span><math alttext="r" class="ltx_Math" display="inline" id="alg1.l27.m6.1"><semantics id="alg1.l27.m6.1a"><mi id="alg1.l27.m6.1.1" mathsize="90%" xref="alg1.l27.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l27.m6.1b"><ci id="alg1.l27.m6.1.1.cmml" xref="alg1.l27.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m6.1d">italic_r</annotation></semantics></math><span class="ltx_text" id="alg1.l27.11" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l28.1.1.1" style="font-size:80%;">28:</span></span><span class="ltx_text" id="alg1.l28.2" style="font-size:90%;">    Atomically swap the current time </span><math alttext="t_{\text{now}}\to t[j]" class="ltx_Math" display="inline" id="alg1.l28.m1.1"><semantics id="alg1.l28.m1.1a"><mrow id="alg1.l28.m1.1.2" xref="alg1.l28.m1.1.2.cmml"><msub id="alg1.l28.m1.1.2.2" xref="alg1.l28.m1.1.2.2.cmml"><mi id="alg1.l28.m1.1.2.2.2" mathsize="90%" xref="alg1.l28.m1.1.2.2.2.cmml">t</mi><mtext id="alg1.l28.m1.1.2.2.3" mathsize="90%" xref="alg1.l28.m1.1.2.2.3a.cmml">now</mtext></msub><mo id="alg1.l28.m1.1.2.1" mathsize="90%" stretchy="false" xref="alg1.l28.m1.1.2.1.cmml">→</mo><mrow id="alg1.l28.m1.1.2.3" xref="alg1.l28.m1.1.2.3.cmml"><mi id="alg1.l28.m1.1.2.3.2" mathsize="90%" xref="alg1.l28.m1.1.2.3.2.cmml">t</mi><mo id="alg1.l28.m1.1.2.3.1" xref="alg1.l28.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l28.m1.1.2.3.3.2" xref="alg1.l28.m1.1.2.3.3.1.cmml"><mo id="alg1.l28.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l28.m1.1.2.3.3.1.1.cmml">[</mo><mi id="alg1.l28.m1.1.1" mathsize="90%" xref="alg1.l28.m1.1.1.cmml">j</mi><mo id="alg1.l28.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l28.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.1b"><apply id="alg1.l28.m1.1.2.cmml" xref="alg1.l28.m1.1.2"><ci id="alg1.l28.m1.1.2.1.cmml" xref="alg1.l28.m1.1.2.1">→</ci><apply id="alg1.l28.m1.1.2.2.cmml" xref="alg1.l28.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.1.2.2.1.cmml" xref="alg1.l28.m1.1.2.2">subscript</csymbol><ci id="alg1.l28.m1.1.2.2.2.cmml" xref="alg1.l28.m1.1.2.2.2">𝑡</ci><ci id="alg1.l28.m1.1.2.2.3a.cmml" xref="alg1.l28.m1.1.2.2.3"><mtext id="alg1.l28.m1.1.2.2.3.cmml" mathsize="63%" xref="alg1.l28.m1.1.2.2.3">now</mtext></ci></apply><apply id="alg1.l28.m1.1.2.3.cmml" xref="alg1.l28.m1.1.2.3"><times id="alg1.l28.m1.1.2.3.1.cmml" xref="alg1.l28.m1.1.2.3.1"></times><ci id="alg1.l28.m1.1.2.3.2.cmml" xref="alg1.l28.m1.1.2.3.2">𝑡</ci><apply id="alg1.l28.m1.1.2.3.3.1.cmml" xref="alg1.l28.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg1.l28.m1.1.2.3.3.1.1.cmml" xref="alg1.l28.m1.1.2.3.3.2.1">delimited-[]</csymbol><ci id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.1c">t_{\text{now}}\to t[j]</annotation><annotation encoding="application/x-llamapun" id="alg1.l28.m1.1d">italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT → italic_t [ italic_j ]</annotation></semantics></math><span class="ltx_text" id="alg1.l28.3" style="font-size:90%;"> with the previous time </span><math alttext="t_{\text{old}}\leftarrow t[j]" class="ltx_Math" display="inline" id="alg1.l28.m2.1"><semantics id="alg1.l28.m2.1a"><mrow id="alg1.l28.m2.1.2" xref="alg1.l28.m2.1.2.cmml"><msub id="alg1.l28.m2.1.2.2" xref="alg1.l28.m2.1.2.2.cmml"><mi id="alg1.l28.m2.1.2.2.2" mathsize="90%" xref="alg1.l28.m2.1.2.2.2.cmml">t</mi><mtext id="alg1.l28.m2.1.2.2.3" mathsize="90%" xref="alg1.l28.m2.1.2.2.3a.cmml">old</mtext></msub><mo id="alg1.l28.m2.1.2.1" mathsize="90%" stretchy="false" xref="alg1.l28.m2.1.2.1.cmml">←</mo><mrow id="alg1.l28.m2.1.2.3" xref="alg1.l28.m2.1.2.3.cmml"><mi id="alg1.l28.m2.1.2.3.2" mathsize="90%" xref="alg1.l28.m2.1.2.3.2.cmml">t</mi><mo id="alg1.l28.m2.1.2.3.1" xref="alg1.l28.m2.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l28.m2.1.2.3.3.2" xref="alg1.l28.m2.1.2.3.3.1.cmml"><mo id="alg1.l28.m2.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l28.m2.1.2.3.3.1.1.cmml">[</mo><mi id="alg1.l28.m2.1.1" mathsize="90%" xref="alg1.l28.m2.1.1.cmml">j</mi><mo id="alg1.l28.m2.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l28.m2.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m2.1b"><apply id="alg1.l28.m2.1.2.cmml" xref="alg1.l28.m2.1.2"><ci id="alg1.l28.m2.1.2.1.cmml" xref="alg1.l28.m2.1.2.1">←</ci><apply id="alg1.l28.m2.1.2.2.cmml" xref="alg1.l28.m2.1.2.2"><csymbol cd="ambiguous" id="alg1.l28.m2.1.2.2.1.cmml" xref="alg1.l28.m2.1.2.2">subscript</csymbol><ci id="alg1.l28.m2.1.2.2.2.cmml" xref="alg1.l28.m2.1.2.2.2">𝑡</ci><ci id="alg1.l28.m2.1.2.2.3a.cmml" xref="alg1.l28.m2.1.2.2.3"><mtext id="alg1.l28.m2.1.2.2.3.cmml" mathsize="63%" xref="alg1.l28.m2.1.2.2.3">old</mtext></ci></apply><apply id="alg1.l28.m2.1.2.3.cmml" xref="alg1.l28.m2.1.2.3"><times id="alg1.l28.m2.1.2.3.1.cmml" xref="alg1.l28.m2.1.2.3.1"></times><ci id="alg1.l28.m2.1.2.3.2.cmml" xref="alg1.l28.m2.1.2.3.2">𝑡</ci><apply id="alg1.l28.m2.1.2.3.3.1.cmml" xref="alg1.l28.m2.1.2.3.3.2"><csymbol cd="latexml" id="alg1.l28.m2.1.2.3.3.1.1.cmml" xref="alg1.l28.m2.1.2.3.3.2.1">delimited-[]</csymbol><ci id="alg1.l28.m2.1.1.cmml" xref="alg1.l28.m2.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m2.1c">t_{\text{old}}\leftarrow t[j]</annotation><annotation encoding="application/x-llamapun" id="alg1.l28.m2.1d">italic_t start_POSTSUBSCRIPT old end_POSTSUBSCRIPT ← italic_t [ italic_j ]</annotation></semantics></math><span class="ltx_text" id="alg1.l28.4" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l29">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l29.1.1.1" style="font-size:80%;">29:</span></span><span class="ltx_text" id="alg1.l29.2" style="font-size:90%;">    Generate a random increment </span><math alttext="inc\leftarrow\mathcal{U}(1,\max\{1,t_{\text{now}}-t_{\text{old}}\})" class="ltx_Math" display="inline" id="alg1.l29.m1.4"><semantics id="alg1.l29.m1.4a"><mrow id="alg1.l29.m1.4.4" xref="alg1.l29.m1.4.4.cmml"><mrow id="alg1.l29.m1.4.4.3" xref="alg1.l29.m1.4.4.3.cmml"><mi id="alg1.l29.m1.4.4.3.2" mathsize="90%" xref="alg1.l29.m1.4.4.3.2.cmml">i</mi><mo id="alg1.l29.m1.4.4.3.1" xref="alg1.l29.m1.4.4.3.1.cmml">⁢</mo><mi id="alg1.l29.m1.4.4.3.3" mathsize="90%" xref="alg1.l29.m1.4.4.3.3.cmml">n</mi><mo id="alg1.l29.m1.4.4.3.1a" xref="alg1.l29.m1.4.4.3.1.cmml">⁢</mo><mi id="alg1.l29.m1.4.4.3.4" mathsize="90%" xref="alg1.l29.m1.4.4.3.4.cmml">c</mi></mrow><mo id="alg1.l29.m1.4.4.2" mathsize="90%" stretchy="false" xref="alg1.l29.m1.4.4.2.cmml">←</mo><mrow id="alg1.l29.m1.4.4.1" xref="alg1.l29.m1.4.4.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l29.m1.4.4.1.3" mathsize="90%" xref="alg1.l29.m1.4.4.1.3.cmml">𝒰</mi><mo id="alg1.l29.m1.4.4.1.2" xref="alg1.l29.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l29.m1.4.4.1.1.1" xref="alg1.l29.m1.4.4.1.1.2.cmml"><mo id="alg1.l29.m1.4.4.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l29.m1.4.4.1.1.2.cmml">(</mo><mn id="alg1.l29.m1.3.3" mathsize="90%" xref="alg1.l29.m1.3.3.cmml">1</mn><mo id="alg1.l29.m1.4.4.1.1.1.3" mathsize="90%" xref="alg1.l29.m1.4.4.1.1.2.cmml">,</mo><mrow id="alg1.l29.m1.4.4.1.1.1.1.1" xref="alg1.l29.m1.4.4.1.1.1.1.2.cmml"><mi id="alg1.l29.m1.1.1" mathsize="90%" xref="alg1.l29.m1.1.1.cmml">max</mi><mo id="alg1.l29.m1.4.4.1.1.1.1.1a" xref="alg1.l29.m1.4.4.1.1.1.1.2.cmml">⁡</mo><mrow id="alg1.l29.m1.4.4.1.1.1.1.1.1" xref="alg1.l29.m1.4.4.1.1.1.1.2.cmml"><mo id="alg1.l29.m1.4.4.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l29.m1.4.4.1.1.1.1.2.cmml">{</mo><mn id="alg1.l29.m1.2.2" mathsize="90%" xref="alg1.l29.m1.2.2.cmml">1</mn><mo id="alg1.l29.m1.4.4.1.1.1.1.1.1.3" mathsize="90%" xref="alg1.l29.m1.4.4.1.1.1.1.2.cmml">,</mo><mrow id="alg1.l29.m1.4.4.1.1.1.1.1.1.1" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">t</mi><mtext id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.3a.cmml">now</mtext></msub><mo id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.1" mathsize="90%" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">t</mi><mtext id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.3a.cmml">old</mtext></msub></mrow><mo id="alg1.l29.m1.4.4.1.1.1.1.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l29.m1.4.4.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="alg1.l29.m1.4.4.1.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l29.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l29.m1.4b"><apply id="alg1.l29.m1.4.4.cmml" xref="alg1.l29.m1.4.4"><ci id="alg1.l29.m1.4.4.2.cmml" xref="alg1.l29.m1.4.4.2">←</ci><apply id="alg1.l29.m1.4.4.3.cmml" xref="alg1.l29.m1.4.4.3"><times id="alg1.l29.m1.4.4.3.1.cmml" xref="alg1.l29.m1.4.4.3.1"></times><ci id="alg1.l29.m1.4.4.3.2.cmml" xref="alg1.l29.m1.4.4.3.2">𝑖</ci><ci id="alg1.l29.m1.4.4.3.3.cmml" xref="alg1.l29.m1.4.4.3.3">𝑛</ci><ci id="alg1.l29.m1.4.4.3.4.cmml" xref="alg1.l29.m1.4.4.3.4">𝑐</ci></apply><apply id="alg1.l29.m1.4.4.1.cmml" xref="alg1.l29.m1.4.4.1"><times id="alg1.l29.m1.4.4.1.2.cmml" xref="alg1.l29.m1.4.4.1.2"></times><ci id="alg1.l29.m1.4.4.1.3.cmml" xref="alg1.l29.m1.4.4.1.3">𝒰</ci><interval closure="open" id="alg1.l29.m1.4.4.1.1.2.cmml" xref="alg1.l29.m1.4.4.1.1.1"><cn id="alg1.l29.m1.3.3.cmml" type="integer" xref="alg1.l29.m1.3.3">1</cn><apply id="alg1.l29.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1"><max id="alg1.l29.m1.1.1.cmml" xref="alg1.l29.m1.1.1"></max><cn id="alg1.l29.m1.2.2.cmml" type="integer" xref="alg1.l29.m1.2.2">1</cn><apply id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1"><minus id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.3"><mtext id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" mathsize="63%" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.2.3">now</mtext></ci></apply><apply id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.3a.cmml" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.3"><mtext id="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" mathsize="63%" xref="alg1.l29.m1.4.4.1.1.1.1.1.1.1.3.3">old</mtext></ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l29.m1.4c">inc\leftarrow\mathcal{U}(1,\max\{1,t_{\text{now}}-t_{\text{old}}\})</annotation><annotation encoding="application/x-llamapun" id="alg1.l29.m1.4d">italic_i italic_n italic_c ← caligraphic_U ( 1 , roman_max { 1 , italic_t start_POSTSUBSCRIPT now end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT old end_POSTSUBSCRIPT } )</annotation></semantics></math><span class="ltx_text" id="alg1.l29.3" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l30">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l30.1.1.1" style="font-size:80%;">30:</span></span><span class="ltx_text" id="alg1.l30.2" style="font-size:90%;">    Atomically fetch-and-add </span><math alttext="v\leftarrow h[j]" class="ltx_Math" display="inline" id="alg1.l30.m1.1"><semantics id="alg1.l30.m1.1a"><mrow id="alg1.l30.m1.1.2" xref="alg1.l30.m1.1.2.cmml"><mi id="alg1.l30.m1.1.2.2" mathsize="90%" xref="alg1.l30.m1.1.2.2.cmml">v</mi><mo id="alg1.l30.m1.1.2.1" mathsize="90%" stretchy="false" xref="alg1.l30.m1.1.2.1.cmml">←</mo><mrow id="alg1.l30.m1.1.2.3" xref="alg1.l30.m1.1.2.3.cmml"><mi id="alg1.l30.m1.1.2.3.2" mathsize="90%" xref="alg1.l30.m1.1.2.3.2.cmml">h</mi><mo id="alg1.l30.m1.1.2.3.1" xref="alg1.l30.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l30.m1.1.2.3.3.2" xref="alg1.l30.m1.1.2.3.3.1.cmml"><mo id="alg1.l30.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l30.m1.1.2.3.3.1.1.cmml">[</mo><mi id="alg1.l30.m1.1.1" mathsize="90%" xref="alg1.l30.m1.1.1.cmml">j</mi><mo id="alg1.l30.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l30.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l30.m1.1b"><apply id="alg1.l30.m1.1.2.cmml" xref="alg1.l30.m1.1.2"><ci id="alg1.l30.m1.1.2.1.cmml" xref="alg1.l30.m1.1.2.1">←</ci><ci id="alg1.l30.m1.1.2.2.cmml" xref="alg1.l30.m1.1.2.2">𝑣</ci><apply id="alg1.l30.m1.1.2.3.cmml" xref="alg1.l30.m1.1.2.3"><times id="alg1.l30.m1.1.2.3.1.cmml" xref="alg1.l30.m1.1.2.3.1"></times><ci id="alg1.l30.m1.1.2.3.2.cmml" xref="alg1.l30.m1.1.2.3.2">ℎ</ci><apply id="alg1.l30.m1.1.2.3.3.1.cmml" xref="alg1.l30.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg1.l30.m1.1.2.3.3.1.1.cmml" xref="alg1.l30.m1.1.2.3.3.2.1">delimited-[]</csymbol><ci id="alg1.l30.m1.1.1.cmml" xref="alg1.l30.m1.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m1.1c">v\leftarrow h[j]</annotation><annotation encoding="application/x-llamapun" id="alg1.l30.m1.1d">italic_v ← italic_h [ italic_j ]</annotation></semantics></math><span class="ltx_text" id="alg1.l30.3" style="font-size:90%;"> and </span><math alttext="h[j]\leftarrow h[j]+inc" class="ltx_Math" display="inline" id="alg1.l30.m2.2"><semantics id="alg1.l30.m2.2a"><mrow id="alg1.l30.m2.2.3" xref="alg1.l30.m2.2.3.cmml"><mrow id="alg1.l30.m2.2.3.2" xref="alg1.l30.m2.2.3.2.cmml"><mi id="alg1.l30.m2.2.3.2.2" mathsize="90%" xref="alg1.l30.m2.2.3.2.2.cmml">h</mi><mo id="alg1.l30.m2.2.3.2.1" xref="alg1.l30.m2.2.3.2.1.cmml">⁢</mo><mrow id="alg1.l30.m2.2.3.2.3.2" xref="alg1.l30.m2.2.3.2.3.1.cmml"><mo id="alg1.l30.m2.2.3.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l30.m2.2.3.2.3.1.1.cmml">[</mo><mi id="alg1.l30.m2.1.1" mathsize="90%" xref="alg1.l30.m2.1.1.cmml">j</mi><mo id="alg1.l30.m2.2.3.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l30.m2.2.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l30.m2.2.3.1" mathsize="90%" stretchy="false" xref="alg1.l30.m2.2.3.1.cmml">←</mo><mrow id="alg1.l30.m2.2.3.3" xref="alg1.l30.m2.2.3.3.cmml"><mrow id="alg1.l30.m2.2.3.3.2" xref="alg1.l30.m2.2.3.3.2.cmml"><mi id="alg1.l30.m2.2.3.3.2.2" mathsize="90%" xref="alg1.l30.m2.2.3.3.2.2.cmml">h</mi><mo id="alg1.l30.m2.2.3.3.2.1" xref="alg1.l30.m2.2.3.3.2.1.cmml">⁢</mo><mrow id="alg1.l30.m2.2.3.3.2.3.2" xref="alg1.l30.m2.2.3.3.2.3.1.cmml"><mo id="alg1.l30.m2.2.3.3.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l30.m2.2.3.3.2.3.1.1.cmml">[</mo><mi id="alg1.l30.m2.2.2" mathsize="90%" xref="alg1.l30.m2.2.2.cmml">j</mi><mo id="alg1.l30.m2.2.3.3.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l30.m2.2.3.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l30.m2.2.3.3.1" mathsize="90%" xref="alg1.l30.m2.2.3.3.1.cmml">+</mo><mrow id="alg1.l30.m2.2.3.3.3" xref="alg1.l30.m2.2.3.3.3.cmml"><mi id="alg1.l30.m2.2.3.3.3.2" mathsize="90%" xref="alg1.l30.m2.2.3.3.3.2.cmml">i</mi><mo id="alg1.l30.m2.2.3.3.3.1" xref="alg1.l30.m2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l30.m2.2.3.3.3.3" mathsize="90%" xref="alg1.l30.m2.2.3.3.3.3.cmml">n</mi><mo id="alg1.l30.m2.2.3.3.3.1a" xref="alg1.l30.m2.2.3.3.3.1.cmml">⁢</mo><mi id="alg1.l30.m2.2.3.3.3.4" mathsize="90%" xref="alg1.l30.m2.2.3.3.3.4.cmml">c</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l30.m2.2b"><apply id="alg1.l30.m2.2.3.cmml" xref="alg1.l30.m2.2.3"><ci id="alg1.l30.m2.2.3.1.cmml" xref="alg1.l30.m2.2.3.1">←</ci><apply id="alg1.l30.m2.2.3.2.cmml" xref="alg1.l30.m2.2.3.2"><times id="alg1.l30.m2.2.3.2.1.cmml" xref="alg1.l30.m2.2.3.2.1"></times><ci id="alg1.l30.m2.2.3.2.2.cmml" xref="alg1.l30.m2.2.3.2.2">ℎ</ci><apply id="alg1.l30.m2.2.3.2.3.1.cmml" xref="alg1.l30.m2.2.3.2.3.2"><csymbol cd="latexml" id="alg1.l30.m2.2.3.2.3.1.1.cmml" xref="alg1.l30.m2.2.3.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l30.m2.1.1.cmml" xref="alg1.l30.m2.1.1">𝑗</ci></apply></apply><apply id="alg1.l30.m2.2.3.3.cmml" xref="alg1.l30.m2.2.3.3"><plus id="alg1.l30.m2.2.3.3.1.cmml" xref="alg1.l30.m2.2.3.3.1"></plus><apply id="alg1.l30.m2.2.3.3.2.cmml" xref="alg1.l30.m2.2.3.3.2"><times id="alg1.l30.m2.2.3.3.2.1.cmml" xref="alg1.l30.m2.2.3.3.2.1"></times><ci id="alg1.l30.m2.2.3.3.2.2.cmml" xref="alg1.l30.m2.2.3.3.2.2">ℎ</ci><apply id="alg1.l30.m2.2.3.3.2.3.1.cmml" xref="alg1.l30.m2.2.3.3.2.3.2"><csymbol cd="latexml" id="alg1.l30.m2.2.3.3.2.3.1.1.cmml" xref="alg1.l30.m2.2.3.3.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l30.m2.2.2.cmml" xref="alg1.l30.m2.2.2">𝑗</ci></apply></apply><apply id="alg1.l30.m2.2.3.3.3.cmml" xref="alg1.l30.m2.2.3.3.3"><times id="alg1.l30.m2.2.3.3.3.1.cmml" xref="alg1.l30.m2.2.3.3.3.1"></times><ci id="alg1.l30.m2.2.3.3.3.2.cmml" xref="alg1.l30.m2.2.3.3.3.2">𝑖</ci><ci id="alg1.l30.m2.2.3.3.3.3.cmml" xref="alg1.l30.m2.2.3.3.3.3">𝑛</ci><ci id="alg1.l30.m2.2.3.3.3.4.cmml" xref="alg1.l30.m2.2.3.3.3.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m2.2c">h[j]\leftarrow h[j]+inc</annotation><annotation encoding="application/x-llamapun" id="alg1.l30.m2.2d">italic_h [ italic_j ] ← italic_h [ italic_j ] + italic_i italic_n italic_c</annotation></semantics></math><span class="ltx_text" id="alg1.l30.4" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l31">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l31.1.1.1" style="font-size:80%;">31:</span></span><span class="ltx_text" id="alg1.l31.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l31.3" style="font-size:90%;">return</span><span class="ltx_text" id="alg1.l31.4" style="font-size:90%;"> </span><math alttext="v+inc" class="ltx_Math" display="inline" id="alg1.l31.m1.1"><semantics id="alg1.l31.m1.1a"><mrow id="alg1.l31.m1.1.1" xref="alg1.l31.m1.1.1.cmml"><mi id="alg1.l31.m1.1.1.2" mathsize="90%" xref="alg1.l31.m1.1.1.2.cmml">v</mi><mo id="alg1.l31.m1.1.1.1" mathsize="90%" xref="alg1.l31.m1.1.1.1.cmml">+</mo><mrow id="alg1.l31.m1.1.1.3" xref="alg1.l31.m1.1.1.3.cmml"><mi id="alg1.l31.m1.1.1.3.2" mathsize="90%" xref="alg1.l31.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l31.m1.1.1.3.1" xref="alg1.l31.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l31.m1.1.1.3.3" mathsize="90%" xref="alg1.l31.m1.1.1.3.3.cmml">n</mi><mo id="alg1.l31.m1.1.1.3.1a" xref="alg1.l31.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l31.m1.1.1.3.4" mathsize="90%" xref="alg1.l31.m1.1.1.3.4.cmml">c</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.1b"><apply id="alg1.l31.m1.1.1.cmml" xref="alg1.l31.m1.1.1"><plus id="alg1.l31.m1.1.1.1.cmml" xref="alg1.l31.m1.1.1.1"></plus><ci id="alg1.l31.m1.1.1.2.cmml" xref="alg1.l31.m1.1.1.2">𝑣</ci><apply id="alg1.l31.m1.1.1.3.cmml" xref="alg1.l31.m1.1.1.3"><times id="alg1.l31.m1.1.1.3.1.cmml" xref="alg1.l31.m1.1.1.3.1"></times><ci id="alg1.l31.m1.1.1.3.2.cmml" xref="alg1.l31.m1.1.1.3.2">𝑖</ci><ci id="alg1.l31.m1.1.1.3.3.cmml" xref="alg1.l31.m1.1.1.3.3">𝑛</ci><ci id="alg1.l31.m1.1.1.3.4.cmml" xref="alg1.l31.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.1c">v+inc</annotation><annotation encoding="application/x-llamapun" id="alg1.l31.m1.1d">italic_v + italic_i italic_n italic_c</annotation></semantics></math><span class="ltx_text" id="alg1.l31.5" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l32">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l32.1.1.1" style="font-size:80%;">32:</span></span><span class="ltx_text" id="alg1.l32.2" style="font-size:90%;">Let </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l32.m1.1"><semantics id="alg1.l32.m1.1a"><mi id="alg1.l32.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l32.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l32.m1.1b"><ci id="alg1.l32.m1.1.1.cmml" xref="alg1.l32.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l32.3" style="font-size:90%;"> be a lock, </span><math alttext="q" class="ltx_Math" display="inline" id="alg1.l32.m2.1"><semantics id="alg1.l32.m2.1a"><mi id="alg1.l32.m2.1.1" mathsize="90%" xref="alg1.l32.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg1.l32.m2.1b"><ci id="alg1.l32.m2.1.1.cmml" xref="alg1.l32.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m2.1d">italic_q</annotation></semantics></math><span class="ltx_text" id="alg1.l32.4" style="font-size:90%;"> be a queue of the last </span><math alttext="k" class="ltx_Math" display="inline" id="alg1.l32.m3.1"><semantics id="alg1.l32.m3.1a"><mi id="alg1.l32.m3.1.1" mathsize="90%" xref="alg1.l32.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l32.m3.1b"><ci id="alg1.l32.m3.1.1.cmml" xref="alg1.l32.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m3.1d">italic_k</annotation></semantics></math><span class="ltx_text" id="alg1.l32.5" style="font-size:90%;"> IPIDs, and </span><math alttext="m" class="ltx_Math" display="inline" id="alg1.l32.m4.1"><semantics id="alg1.l32.m4.1a"><mi id="alg1.l32.m4.1.1" mathsize="90%" xref="alg1.l32.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l32.m4.1b"><ci id="alg1.l32.m4.1.1.cmml" xref="alg1.l32.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m4.1d">italic_m</annotation></semantics></math><span class="ltx_text" id="alg1.l32.6" style="font-size:90%;"> be an array of </span><math alttext="2^{16}" class="ltx_Math" display="inline" id="alg1.l32.m5.1"><semantics id="alg1.l32.m5.1a"><msup id="alg1.l32.m5.1.1" xref="alg1.l32.m5.1.1.cmml"><mn id="alg1.l32.m5.1.1.2" mathsize="90%" xref="alg1.l32.m5.1.1.2.cmml">2</mn><mn id="alg1.l32.m5.1.1.3" mathsize="90%" xref="alg1.l32.m5.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l32.m5.1b"><apply id="alg1.l32.m5.1.1.cmml" xref="alg1.l32.m5.1.1"><csymbol cd="ambiguous" id="alg1.l32.m5.1.1.1.cmml" xref="alg1.l32.m5.1.1">superscript</csymbol><cn id="alg1.l32.m5.1.1.2.cmml" type="integer" xref="alg1.l32.m5.1.1.2">2</cn><cn id="alg1.l32.m5.1.1.3.cmml" type="integer" xref="alg1.l32.m5.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m5.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m5.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l32.7" style="font-size:90%;"> membership tracking bits.
</span>
</div>
<div class="ltx_listingline" id="alg1.l33">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l33.1.1.1" style="font-size:80%;">33:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l33.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg1.l33.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l33.4" style="font-size:90%;">PrngSearchableQueue</span><span class="ltx_text" id="alg1.l33.5" style="font-size:90%;">( )
</span>
</div>
<div class="ltx_listingline" id="alg1.l34">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l34.1.1.1" style="font-size:80%;">34:</span></span><span class="ltx_text" id="alg1.l34.2" style="font-size:90%;">    Lock </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l34.m1.1"><semantics id="alg1.l34.m1.1a"><mi id="alg1.l34.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l34.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l34.m1.1b"><ci id="alg1.l34.m1.1.1.cmml" xref="alg1.l34.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l34.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l34.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l34.3" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l35">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l35.1.1.1" style="font-size:80%;">35:</span></span><span class="ltx_text" id="alg1.l35.2" style="font-size:90%;">    Repeatedly generate IPID values </span><math alttext="v\leftarrow\mathcal{U}(0,2^{16}-1)" class="ltx_Math" display="inline" id="alg1.l35.m1.2"><semantics id="alg1.l35.m1.2a"><mrow id="alg1.l35.m1.2.2" xref="alg1.l35.m1.2.2.cmml"><mi id="alg1.l35.m1.2.2.3" mathsize="90%" xref="alg1.l35.m1.2.2.3.cmml">v</mi><mo id="alg1.l35.m1.2.2.2" mathsize="90%" stretchy="false" xref="alg1.l35.m1.2.2.2.cmml">←</mo><mrow id="alg1.l35.m1.2.2.1" xref="alg1.l35.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l35.m1.2.2.1.3" mathsize="90%" xref="alg1.l35.m1.2.2.1.3.cmml">𝒰</mi><mo id="alg1.l35.m1.2.2.1.2" xref="alg1.l35.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l35.m1.2.2.1.1.1" xref="alg1.l35.m1.2.2.1.1.2.cmml"><mo id="alg1.l35.m1.2.2.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l35.m1.2.2.1.1.2.cmml">(</mo><mn id="alg1.l35.m1.1.1" mathsize="90%" xref="alg1.l35.m1.1.1.cmml">0</mn><mo id="alg1.l35.m1.2.2.1.1.1.3" mathsize="90%" xref="alg1.l35.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg1.l35.m1.2.2.1.1.1.1" xref="alg1.l35.m1.2.2.1.1.1.1.cmml"><msup id="alg1.l35.m1.2.2.1.1.1.1.2" xref="alg1.l35.m1.2.2.1.1.1.1.2.cmml"><mn id="alg1.l35.m1.2.2.1.1.1.1.2.2" mathsize="90%" xref="alg1.l35.m1.2.2.1.1.1.1.2.2.cmml">2</mn><mn id="alg1.l35.m1.2.2.1.1.1.1.2.3" mathsize="90%" xref="alg1.l35.m1.2.2.1.1.1.1.2.3.cmml">16</mn></msup><mo id="alg1.l35.m1.2.2.1.1.1.1.1" mathsize="90%" xref="alg1.l35.m1.2.2.1.1.1.1.1.cmml">−</mo><mn id="alg1.l35.m1.2.2.1.1.1.1.3" mathsize="90%" xref="alg1.l35.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l35.m1.2.2.1.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l35.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l35.m1.2b"><apply id="alg1.l35.m1.2.2.cmml" xref="alg1.l35.m1.2.2"><ci id="alg1.l35.m1.2.2.2.cmml" xref="alg1.l35.m1.2.2.2">←</ci><ci id="alg1.l35.m1.2.2.3.cmml" xref="alg1.l35.m1.2.2.3">𝑣</ci><apply id="alg1.l35.m1.2.2.1.cmml" xref="alg1.l35.m1.2.2.1"><times id="alg1.l35.m1.2.2.1.2.cmml" xref="alg1.l35.m1.2.2.1.2"></times><ci id="alg1.l35.m1.2.2.1.3.cmml" xref="alg1.l35.m1.2.2.1.3">𝒰</ci><interval closure="open" id="alg1.l35.m1.2.2.1.1.2.cmml" xref="alg1.l35.m1.2.2.1.1.1"><cn id="alg1.l35.m1.1.1.cmml" type="integer" xref="alg1.l35.m1.1.1">0</cn><apply id="alg1.l35.m1.2.2.1.1.1.1.cmml" xref="alg1.l35.m1.2.2.1.1.1.1"><minus id="alg1.l35.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l35.m1.2.2.1.1.1.1.1"></minus><apply id="alg1.l35.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l35.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l35.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l35.m1.2.2.1.1.1.1.2">superscript</csymbol><cn id="alg1.l35.m1.2.2.1.1.1.1.2.2.cmml" type="integer" xref="alg1.l35.m1.2.2.1.1.1.1.2.2">2</cn><cn id="alg1.l35.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="alg1.l35.m1.2.2.1.1.1.1.2.3">16</cn></apply><cn id="alg1.l35.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l35.m1.2.2.1.1.1.1.3">1</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l35.m1.2c">v\leftarrow\mathcal{U}(0,2^{16}-1)</annotation><annotation encoding="application/x-llamapun" id="alg1.l35.m1.2d">italic_v ← caligraphic_U ( 0 , 2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - 1 )</annotation></semantics></math><span class="ltx_text" id="alg1.l35.3" style="font-size:90%;"> until </span><math alttext="v\neq 0" class="ltx_Math" display="inline" id="alg1.l35.m2.1"><semantics id="alg1.l35.m2.1a"><mrow id="alg1.l35.m2.1.1" xref="alg1.l35.m2.1.1.cmml"><mi id="alg1.l35.m2.1.1.2" mathsize="90%" xref="alg1.l35.m2.1.1.2.cmml">v</mi><mo id="alg1.l35.m2.1.1.1" mathsize="90%" xref="alg1.l35.m2.1.1.1.cmml">≠</mo><mn id="alg1.l35.m2.1.1.3" mathsize="90%" xref="alg1.l35.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l35.m2.1b"><apply id="alg1.l35.m2.1.1.cmml" xref="alg1.l35.m2.1.1"><neq id="alg1.l35.m2.1.1.1.cmml" xref="alg1.l35.m2.1.1.1"></neq><ci id="alg1.l35.m2.1.1.2.cmml" xref="alg1.l35.m2.1.1.2">𝑣</ci><cn id="alg1.l35.m2.1.1.3.cmml" type="integer" xref="alg1.l35.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l35.m2.1c">v\neq 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l35.m2.1d">italic_v ≠ 0</annotation></semantics></math><span class="ltx_text" id="alg1.l35.4" style="font-size:90%;"> and </span><math alttext="m[v]=\textsc{false}" class="ltx_Math" display="inline" id="alg1.l35.m3.1"><semantics id="alg1.l35.m3.1a"><mrow id="alg1.l35.m3.1.2" xref="alg1.l35.m3.1.2.cmml"><mrow id="alg1.l35.m3.1.2.2" xref="alg1.l35.m3.1.2.2.cmml"><mi id="alg1.l35.m3.1.2.2.2" mathsize="90%" xref="alg1.l35.m3.1.2.2.2.cmml">m</mi><mo id="alg1.l35.m3.1.2.2.1" xref="alg1.l35.m3.1.2.2.1.cmml">⁢</mo><mrow id="alg1.l35.m3.1.2.2.3.2" xref="alg1.l35.m3.1.2.2.3.1.cmml"><mo id="alg1.l35.m3.1.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l35.m3.1.2.2.3.1.1.cmml">[</mo><mi id="alg1.l35.m3.1.1" mathsize="90%" xref="alg1.l35.m3.1.1.cmml">v</mi><mo id="alg1.l35.m3.1.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l35.m3.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l35.m3.1.2.1" mathsize="90%" xref="alg1.l35.m3.1.2.1.cmml">=</mo><mtext class="ltx_font_smallcaps" id="alg1.l35.m3.1.2.3" mathsize="90%" xref="alg1.l35.m3.1.2.3a.cmml">false</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l35.m3.1b"><apply id="alg1.l35.m3.1.2.cmml" xref="alg1.l35.m3.1.2"><eq id="alg1.l35.m3.1.2.1.cmml" xref="alg1.l35.m3.1.2.1"></eq><apply id="alg1.l35.m3.1.2.2.cmml" xref="alg1.l35.m3.1.2.2"><times id="alg1.l35.m3.1.2.2.1.cmml" xref="alg1.l35.m3.1.2.2.1"></times><ci id="alg1.l35.m3.1.2.2.2.cmml" xref="alg1.l35.m3.1.2.2.2">𝑚</ci><apply id="alg1.l35.m3.1.2.2.3.1.cmml" xref="alg1.l35.m3.1.2.2.3.2"><csymbol cd="latexml" id="alg1.l35.m3.1.2.2.3.1.1.cmml" xref="alg1.l35.m3.1.2.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l35.m3.1.1.cmml" xref="alg1.l35.m3.1.1">𝑣</ci></apply></apply><ci id="alg1.l35.m3.1.2.3a.cmml" xref="alg1.l35.m3.1.2.3"><mtext class="ltx_font_smallcaps" id="alg1.l35.m3.1.2.3.cmml" mathsize="90%" xref="alg1.l35.m3.1.2.3">false</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l35.m3.1c">m[v]=\textsc{false}</annotation><annotation encoding="application/x-llamapun" id="alg1.l35.m3.1d">italic_m [ italic_v ] = false</annotation></semantics></math><span class="ltx_text" id="alg1.l35.5" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l36">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l36.1.1.1" style="font-size:80%;">36:</span></span><span class="ltx_text" id="alg1.l36.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l36.3" style="font-size:90%;">if</span><span class="ltx_text" id="alg1.l36.4" style="font-size:90%;"> </span><math alttext="|q|=k" class="ltx_Math" display="inline" id="alg1.l36.m1.1"><semantics id="alg1.l36.m1.1a"><mrow id="alg1.l36.m1.1.2" xref="alg1.l36.m1.1.2.cmml"><mrow id="alg1.l36.m1.1.2.2.2" xref="alg1.l36.m1.1.2.2.1.cmml"><mo id="alg1.l36.m1.1.2.2.2.1" maxsize="90%" minsize="90%" xref="alg1.l36.m1.1.2.2.1.1.cmml">|</mo><mi id="alg1.l36.m1.1.1" mathsize="90%" xref="alg1.l36.m1.1.1.cmml">q</mi><mo id="alg1.l36.m1.1.2.2.2.2" maxsize="90%" minsize="90%" xref="alg1.l36.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="alg1.l36.m1.1.2.1" mathsize="90%" xref="alg1.l36.m1.1.2.1.cmml">=</mo><mi id="alg1.l36.m1.1.2.3" mathsize="90%" xref="alg1.l36.m1.1.2.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l36.m1.1b"><apply id="alg1.l36.m1.1.2.cmml" xref="alg1.l36.m1.1.2"><eq id="alg1.l36.m1.1.2.1.cmml" xref="alg1.l36.m1.1.2.1"></eq><apply id="alg1.l36.m1.1.2.2.1.cmml" xref="alg1.l36.m1.1.2.2.2"><abs id="alg1.l36.m1.1.2.2.1.1.cmml" xref="alg1.l36.m1.1.2.2.2.1"></abs><ci id="alg1.l36.m1.1.1.cmml" xref="alg1.l36.m1.1.1">𝑞</ci></apply><ci id="alg1.l36.m1.1.2.3.cmml" xref="alg1.l36.m1.1.2.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l36.m1.1c">|q|=k</annotation><annotation encoding="application/x-llamapun" id="alg1.l36.m1.1d">| italic_q | = italic_k</annotation></semantics></math><span class="ltx_text" id="alg1.l36.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l36.6" style="font-size:90%;">then</span><span class="ltx_text" id="alg1.l36.7" style="font-size:90%;"> dequeue the last IPID </span><math alttext="u" class="ltx_Math" display="inline" id="alg1.l36.m2.1"><semantics id="alg1.l36.m2.1a"><mi id="alg1.l36.m2.1.1" mathsize="90%" xref="alg1.l36.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg1.l36.m2.1b"><ci id="alg1.l36.m2.1.1.cmml" xref="alg1.l36.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l36.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="alg1.l36.m2.1d">italic_u</annotation></semantics></math><span class="ltx_text" id="alg1.l36.8" style="font-size:90%;"> from </span><math alttext="q" class="ltx_Math" display="inline" id="alg1.l36.m3.1"><semantics id="alg1.l36.m3.1a"><mi id="alg1.l36.m3.1.1" mathsize="90%" xref="alg1.l36.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg1.l36.m3.1b"><ci id="alg1.l36.m3.1.1.cmml" xref="alg1.l36.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l36.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg1.l36.m3.1d">italic_q</annotation></semantics></math><span class="ltx_text" id="alg1.l36.9" style="font-size:90%;"> and set </span><math alttext="m[u]=\textsc{false}" class="ltx_Math" display="inline" id="alg1.l36.m4.1"><semantics id="alg1.l36.m4.1a"><mrow id="alg1.l36.m4.1.2" xref="alg1.l36.m4.1.2.cmml"><mrow id="alg1.l36.m4.1.2.2" xref="alg1.l36.m4.1.2.2.cmml"><mi id="alg1.l36.m4.1.2.2.2" mathsize="90%" xref="alg1.l36.m4.1.2.2.2.cmml">m</mi><mo id="alg1.l36.m4.1.2.2.1" xref="alg1.l36.m4.1.2.2.1.cmml">⁢</mo><mrow id="alg1.l36.m4.1.2.2.3.2" xref="alg1.l36.m4.1.2.2.3.1.cmml"><mo id="alg1.l36.m4.1.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l36.m4.1.2.2.3.1.1.cmml">[</mo><mi id="alg1.l36.m4.1.1" mathsize="90%" xref="alg1.l36.m4.1.1.cmml">u</mi><mo id="alg1.l36.m4.1.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l36.m4.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l36.m4.1.2.1" mathsize="90%" xref="alg1.l36.m4.1.2.1.cmml">=</mo><mtext class="ltx_font_smallcaps" id="alg1.l36.m4.1.2.3" mathsize="90%" xref="alg1.l36.m4.1.2.3a.cmml">false</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l36.m4.1b"><apply id="alg1.l36.m4.1.2.cmml" xref="alg1.l36.m4.1.2"><eq id="alg1.l36.m4.1.2.1.cmml" xref="alg1.l36.m4.1.2.1"></eq><apply id="alg1.l36.m4.1.2.2.cmml" xref="alg1.l36.m4.1.2.2"><times id="alg1.l36.m4.1.2.2.1.cmml" xref="alg1.l36.m4.1.2.2.1"></times><ci id="alg1.l36.m4.1.2.2.2.cmml" xref="alg1.l36.m4.1.2.2.2">𝑚</ci><apply id="alg1.l36.m4.1.2.2.3.1.cmml" xref="alg1.l36.m4.1.2.2.3.2"><csymbol cd="latexml" id="alg1.l36.m4.1.2.2.3.1.1.cmml" xref="alg1.l36.m4.1.2.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l36.m4.1.1.cmml" xref="alg1.l36.m4.1.1">𝑢</ci></apply></apply><ci id="alg1.l36.m4.1.2.3a.cmml" xref="alg1.l36.m4.1.2.3"><mtext class="ltx_font_smallcaps" id="alg1.l36.m4.1.2.3.cmml" mathsize="90%" xref="alg1.l36.m4.1.2.3">false</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l36.m4.1c">m[u]=\textsc{false}</annotation><annotation encoding="application/x-llamapun" id="alg1.l36.m4.1d">italic_m [ italic_u ] = false</annotation></semantics></math><span class="ltx_text" id="alg1.l36.10" style="font-size:90%;">.
    </span>
</div>
<div class="ltx_listingline" id="alg1.l37">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l37.1.1.1" style="font-size:80%;">37:</span></span><span class="ltx_text" id="alg1.l37.2" style="font-size:90%;">    Enqueue </span><math alttext="v" class="ltx_Math" display="inline" id="alg1.l37.m1.1"><semantics id="alg1.l37.m1.1a"><mi id="alg1.l37.m1.1.1" mathsize="90%" xref="alg1.l37.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l37.m1.1b"><ci id="alg1.l37.m1.1.1.cmml" xref="alg1.l37.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l37.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l37.m1.1d">italic_v</annotation></semantics></math><span class="ltx_text" id="alg1.l37.3" style="font-size:90%;"> into </span><math alttext="q" class="ltx_Math" display="inline" id="alg1.l37.m2.1"><semantics id="alg1.l37.m2.1a"><mi id="alg1.l37.m2.1.1" mathsize="90%" xref="alg1.l37.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg1.l37.m2.1b"><ci id="alg1.l37.m2.1.1.cmml" xref="alg1.l37.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l37.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg1.l37.m2.1d">italic_q</annotation></semantics></math><span class="ltx_text" id="alg1.l37.4" style="font-size:90%;"> and set </span><math alttext="m[v]=\textsc{true}" class="ltx_Math" display="inline" id="alg1.l37.m3.1"><semantics id="alg1.l37.m3.1a"><mrow id="alg1.l37.m3.1.2" xref="alg1.l37.m3.1.2.cmml"><mrow id="alg1.l37.m3.1.2.2" xref="alg1.l37.m3.1.2.2.cmml"><mi id="alg1.l37.m3.1.2.2.2" mathsize="90%" xref="alg1.l37.m3.1.2.2.2.cmml">m</mi><mo id="alg1.l37.m3.1.2.2.1" xref="alg1.l37.m3.1.2.2.1.cmml">⁢</mo><mrow id="alg1.l37.m3.1.2.2.3.2" xref="alg1.l37.m3.1.2.2.3.1.cmml"><mo id="alg1.l37.m3.1.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l37.m3.1.2.2.3.1.1.cmml">[</mo><mi id="alg1.l37.m3.1.1" mathsize="90%" xref="alg1.l37.m3.1.1.cmml">v</mi><mo id="alg1.l37.m3.1.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l37.m3.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l37.m3.1.2.1" mathsize="90%" xref="alg1.l37.m3.1.2.1.cmml">=</mo><mtext class="ltx_font_smallcaps" id="alg1.l37.m3.1.2.3" mathsize="90%" xref="alg1.l37.m3.1.2.3a.cmml">true</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l37.m3.1b"><apply id="alg1.l37.m3.1.2.cmml" xref="alg1.l37.m3.1.2"><eq id="alg1.l37.m3.1.2.1.cmml" xref="alg1.l37.m3.1.2.1"></eq><apply id="alg1.l37.m3.1.2.2.cmml" xref="alg1.l37.m3.1.2.2"><times id="alg1.l37.m3.1.2.2.1.cmml" xref="alg1.l37.m3.1.2.2.1"></times><ci id="alg1.l37.m3.1.2.2.2.cmml" xref="alg1.l37.m3.1.2.2.2">𝑚</ci><apply id="alg1.l37.m3.1.2.2.3.1.cmml" xref="alg1.l37.m3.1.2.2.3.2"><csymbol cd="latexml" id="alg1.l37.m3.1.2.2.3.1.1.cmml" xref="alg1.l37.m3.1.2.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l37.m3.1.1.cmml" xref="alg1.l37.m3.1.1">𝑣</ci></apply></apply><ci id="alg1.l37.m3.1.2.3a.cmml" xref="alg1.l37.m3.1.2.3"><mtext class="ltx_font_smallcaps" id="alg1.l37.m3.1.2.3.cmml" mathsize="90%" xref="alg1.l37.m3.1.2.3">true</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l37.m3.1c">m[v]=\textsc{true}</annotation><annotation encoding="application/x-llamapun" id="alg1.l37.m3.1d">italic_m [ italic_v ] = true</annotation></semantics></math><span class="ltx_text" id="alg1.l37.5" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l38">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l38.1.1.1" style="font-size:80%;">38:</span></span><span class="ltx_text" id="alg1.l38.2" style="font-size:90%;">    Unlock </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l38.m1.1"><semantics id="alg1.l38.m1.1a"><mi id="alg1.l38.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l38.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l38.m1.1b"><ci id="alg1.l38.m1.1.1.cmml" xref="alg1.l38.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l38.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l38.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l38.3" style="font-size:90%;"> and </span><span class="ltx_text ltx_font_bold" id="alg1.l38.4" style="font-size:90%;">return</span><span class="ltx_text" id="alg1.l38.5" style="font-size:90%;"> </span><math alttext="v" class="ltx_Math" display="inline" id="alg1.l38.m2.1"><semantics id="alg1.l38.m2.1a"><mi id="alg1.l38.m2.1.1" mathsize="90%" xref="alg1.l38.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l38.m2.1b"><ci id="alg1.l38.m2.1.1.cmml" xref="alg1.l38.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l38.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l38.m2.1d">italic_v</annotation></semantics></math><span class="ltx_text" id="alg1.l38.6" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l39">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l39.1.1.1" style="font-size:80%;">39:</span></span><span class="ltx_text" id="alg1.l39.2" style="font-size:90%;">Let </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l39.m1.1"><semantics id="alg1.l39.m1.1a"><mi id="alg1.l39.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l39.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l39.m1.1b"><ci id="alg1.l39.m1.1.1.cmml" xref="alg1.l39.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l39.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l39.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l39.3" style="font-size:90%;"> be a lock, </span><math alttext="p" class="ltx_Math" display="inline" id="alg1.l39.m2.1"><semantics id="alg1.l39.m2.1a"><mi id="alg1.l39.m2.1.1" mathsize="90%" xref="alg1.l39.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="alg1.l39.m2.1b"><ci id="alg1.l39.m2.1.1.cmml" xref="alg1.l39.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l39.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="alg1.l39.m2.1d">italic_p</annotation></semantics></math><span class="ltx_text" id="alg1.l39.4" style="font-size:90%;"> be the current permutation of IPIDs, and </span><math alttext="k" class="ltx_Math" display="inline" id="alg1.l39.m3.1"><semantics id="alg1.l39.m3.1a"><mi id="alg1.l39.m3.1.1" mathsize="90%" xref="alg1.l39.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l39.m3.1b"><ci id="alg1.l39.m3.1.1.cmml" xref="alg1.l39.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l39.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg1.l39.m3.1d">italic_k</annotation></semantics></math><span class="ltx_text" id="alg1.l39.5" style="font-size:90%;"> be the number of reserved IPIDs.
</span>
</div>
<div class="ltx_listingline" id="alg1.l40">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l40.1.1.1" style="font-size:80%;">40:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l40.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg1.l40.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg1.l40.4" style="font-size:90%;">PrngKnuthShuffle</span><span class="ltx_text" id="alg1.l40.5" style="font-size:90%;">( )
</span>
</div>
<div class="ltx_listingline" id="alg1.l41">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l41.1.1.1" style="font-size:80%;">41:</span></span><span class="ltx_text" id="alg1.l41.2" style="font-size:90%;">    Lock </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l41.m1.1"><semantics id="alg1.l41.m1.1a"><mi id="alg1.l41.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l41.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l41.m1.1b"><ci id="alg1.l41.m1.1.1.cmml" xref="alg1.l41.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l41.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l41.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l41.3" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l42">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l42.1.1.1" style="font-size:80%;">42:</span></span><span class="ltx_text" id="alg1.l42.2" style="font-size:90%;">    Let </span><math alttext="v" class="ltx_Math" display="inline" id="alg1.l42.m1.1"><semantics id="alg1.l42.m1.1a"><mi id="alg1.l42.m1.1.1" mathsize="90%" xref="alg1.l42.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l42.m1.1b"><ci id="alg1.l42.m1.1.1.cmml" xref="alg1.l42.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l42.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l42.m1.1d">italic_v</annotation></semantics></math><span class="ltx_text" id="alg1.l42.3" style="font-size:90%;"> be the next IPID in the permutation. 
</span>
</div>
<div class="ltx_listingline" id="alg1.l43">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l43.1.1.1" style="font-size:80%;">43:</span></span><span class="ltx_text" id="alg1.l43.2" style="font-size:90%;">    Swap </span><math alttext="v" class="ltx_Math" display="inline" id="alg1.l43.m1.1"><semantics id="alg1.l43.m1.1a"><mi id="alg1.l43.m1.1.1" mathsize="90%" xref="alg1.l43.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l43.m1.1b"><ci id="alg1.l43.m1.1.1.cmml" xref="alg1.l43.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l43.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l43.m1.1d">italic_v</annotation></semantics></math><span class="ltx_text" id="alg1.l43.3" style="font-size:90%;"> with the IPID </span><math alttext="j\leftarrow\mathcal{U}(0,k-1)" class="ltx_Math" display="inline" id="alg1.l43.m2.2"><semantics id="alg1.l43.m2.2a"><mrow id="alg1.l43.m2.2.2" xref="alg1.l43.m2.2.2.cmml"><mi id="alg1.l43.m2.2.2.3" mathsize="90%" xref="alg1.l43.m2.2.2.3.cmml">j</mi><mo id="alg1.l43.m2.2.2.2" mathsize="90%" stretchy="false" xref="alg1.l43.m2.2.2.2.cmml">←</mo><mrow id="alg1.l43.m2.2.2.1" xref="alg1.l43.m2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l43.m2.2.2.1.3" mathsize="90%" xref="alg1.l43.m2.2.2.1.3.cmml">𝒰</mi><mo id="alg1.l43.m2.2.2.1.2" xref="alg1.l43.m2.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l43.m2.2.2.1.1.1" xref="alg1.l43.m2.2.2.1.1.2.cmml"><mo id="alg1.l43.m2.2.2.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l43.m2.2.2.1.1.2.cmml">(</mo><mn id="alg1.l43.m2.1.1" mathsize="90%" xref="alg1.l43.m2.1.1.cmml">0</mn><mo id="alg1.l43.m2.2.2.1.1.1.3" mathsize="90%" xref="alg1.l43.m2.2.2.1.1.2.cmml">,</mo><mrow id="alg1.l43.m2.2.2.1.1.1.1" xref="alg1.l43.m2.2.2.1.1.1.1.cmml"><mi id="alg1.l43.m2.2.2.1.1.1.1.2" mathsize="90%" xref="alg1.l43.m2.2.2.1.1.1.1.2.cmml">k</mi><mo id="alg1.l43.m2.2.2.1.1.1.1.1" mathsize="90%" xref="alg1.l43.m2.2.2.1.1.1.1.1.cmml">−</mo><mn id="alg1.l43.m2.2.2.1.1.1.1.3" mathsize="90%" xref="alg1.l43.m2.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l43.m2.2.2.1.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l43.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l43.m2.2b"><apply id="alg1.l43.m2.2.2.cmml" xref="alg1.l43.m2.2.2"><ci id="alg1.l43.m2.2.2.2.cmml" xref="alg1.l43.m2.2.2.2">←</ci><ci id="alg1.l43.m2.2.2.3.cmml" xref="alg1.l43.m2.2.2.3">𝑗</ci><apply id="alg1.l43.m2.2.2.1.cmml" xref="alg1.l43.m2.2.2.1"><times id="alg1.l43.m2.2.2.1.2.cmml" xref="alg1.l43.m2.2.2.1.2"></times><ci id="alg1.l43.m2.2.2.1.3.cmml" xref="alg1.l43.m2.2.2.1.3">𝒰</ci><interval closure="open" id="alg1.l43.m2.2.2.1.1.2.cmml" xref="alg1.l43.m2.2.2.1.1.1"><cn id="alg1.l43.m2.1.1.cmml" type="integer" xref="alg1.l43.m2.1.1">0</cn><apply id="alg1.l43.m2.2.2.1.1.1.1.cmml" xref="alg1.l43.m2.2.2.1.1.1.1"><minus id="alg1.l43.m2.2.2.1.1.1.1.1.cmml" xref="alg1.l43.m2.2.2.1.1.1.1.1"></minus><ci id="alg1.l43.m2.2.2.1.1.1.1.2.cmml" xref="alg1.l43.m2.2.2.1.1.1.1.2">𝑘</ci><cn id="alg1.l43.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="alg1.l43.m2.2.2.1.1.1.1.3">1</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l43.m2.2c">j\leftarrow\mathcal{U}(0,k-1)</annotation><annotation encoding="application/x-llamapun" id="alg1.l43.m2.2d">italic_j ← caligraphic_U ( 0 , italic_k - 1 )</annotation></semantics></math><span class="ltx_text" id="alg1.l43.4" style="font-size:90%;"> positions behind it in </span><math alttext="p" class="ltx_Math" display="inline" id="alg1.l43.m3.1"><semantics id="alg1.l43.m3.1a"><mi id="alg1.l43.m3.1.1" mathsize="90%" xref="alg1.l43.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="alg1.l43.m3.1b"><ci id="alg1.l43.m3.1.1.cmml" xref="alg1.l43.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l43.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="alg1.l43.m3.1d">italic_p</annotation></semantics></math><span class="ltx_text" id="alg1.l43.5" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l44">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l44.1.1.1" style="font-size:80%;">44:</span></span><span class="ltx_text" id="alg1.l44.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l44.3" style="font-size:90%;">if</span><span class="ltx_text" id="alg1.l44.4" style="font-size:90%;"> </span><math alttext="v=0" class="ltx_Math" display="inline" id="alg1.l44.m1.1"><semantics id="alg1.l44.m1.1a"><mrow id="alg1.l44.m1.1.1" xref="alg1.l44.m1.1.1.cmml"><mi id="alg1.l44.m1.1.1.2" mathsize="90%" xref="alg1.l44.m1.1.1.2.cmml">v</mi><mo id="alg1.l44.m1.1.1.1" mathsize="90%" xref="alg1.l44.m1.1.1.1.cmml">=</mo><mn id="alg1.l44.m1.1.1.3" mathsize="90%" xref="alg1.l44.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l44.m1.1b"><apply id="alg1.l44.m1.1.1.cmml" xref="alg1.l44.m1.1.1"><eq id="alg1.l44.m1.1.1.1.cmml" xref="alg1.l44.m1.1.1.1"></eq><ci id="alg1.l44.m1.1.1.2.cmml" xref="alg1.l44.m1.1.1.2">𝑣</ci><cn id="alg1.l44.m1.1.1.3.cmml" type="integer" xref="alg1.l44.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l44.m1.1c">v=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l44.m1.1d">italic_v = 0</annotation></semantics></math><span class="ltx_text" id="alg1.l44.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l44.6" style="font-size:90%;">then</span><span class="ltx_text" id="alg1.l44.7" style="font-size:90%;"> go to Line </span><a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#alg1.l42" style="font-size:90%;" title="In Algorithm 1 ‣ Appendix B Benchmark Implementation Details ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">42</span></a><span class="ltx_text" id="alg1.l44.8" style="font-size:90%;">.
</span>
</div>
<div class="ltx_listingline" id="alg1.l45">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l45.1.1.1" style="font-size:80%;">45:</span></span><span class="ltx_text" id="alg1.l45.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l45.3" style="font-size:90%;">else</span><span class="ltx_text" id="alg1.l45.4" style="font-size:90%;"> unlock </span><math alttext="\ell" class="ltx_Math" display="inline" id="alg1.l45.m1.1"><semantics id="alg1.l45.m1.1a"><mi id="alg1.l45.m1.1.1" mathsize="90%" mathvariant="normal" xref="alg1.l45.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.l45.m1.1b"><ci id="alg1.l45.m1.1.1.cmml" xref="alg1.l45.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l45.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="alg1.l45.m1.1d">roman_ℓ</annotation></semantics></math><span class="ltx_text" id="alg1.l45.5" style="font-size:90%;"> and </span><span class="ltx_text ltx_font_bold" id="alg1.l45.6" style="font-size:90%;">return</span><span class="ltx_text" id="alg1.l45.7" style="font-size:90%;"> </span><math alttext="v" class="ltx_Math" display="inline" id="alg1.l45.m2.1"><semantics id="alg1.l45.m2.1a"><mi id="alg1.l45.m2.1.1" mathsize="90%" xref="alg1.l45.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l45.m2.1b"><ci id="alg1.l45.m2.1.1.cmml" xref="alg1.l45.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l45.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l45.m2.1d">italic_v</annotation></semantics></math><span class="ltx_text" id="alg1.l45.8" style="font-size:90%;">.
    </span>
</div>
</div>
</figure>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Globally Incrementing</h5>
<div class="ltx_para" id="A2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px1.p1.1">We assume the single global counter shared by all CPUs is atomic, meaning it can be accessed and incremented by any one CPU without explicit locking.
Specifically, we use C++’s <span class="ltx_text ltx_font_typewriter" id="A2.SS0.SSS0.Px1.p1.1.1">std::atomic&lt;uint16_t&gt;</span> which implements the necessary cache coherency protocols.</p>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Per-Connection</h5>
<div class="ltx_para" id="A2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px2.p1.1">In practice, Linux handles TCP (connection-bound) traffic in sockets, and each socket data structure contains its own sequentially-incrementing counter.
Any time a thread is setting up a packet as part of a TCP connection, it’s responding to a system call that already provided the socket structure as context.
So there’s no cost to “locating” the connection counter via some kind of hash function, like there is in per-destination and per-bucket selection.
Moreover, there’s essentially no situation in which multiple cores would be contending over the same socket simultaneously.
So from the perspective of our performance benchmark, the complexity of requesting a per-connection IPID is as simple as standing up a <span class="ltx_text ltx_font_typewriter" id="A2.SS0.SSS0.Px2.p1.1.1">uint16_t</span> and incrementing it.</p>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Per-Destination</h5>
<div class="ltx_para" id="A2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px3.p1.2">We model our per-destination implementation based on the recent Windows reverse-engineering efforts of Klein <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite>, maintaining a hash table of <span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px3.p1.2.1">\replaced</span>(16-bit counter, 32-bit timestamp) pairs16-bit counters indexed by source and destination IP address pairs.
Following the “purge sequences” that Windows <span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px3.p1.2.2">\added</span>Server (v1904) uses to limit its hash table sizes, we fix <span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px3.p1.2.3">\replaced</span>a purge threshold of <math alttext="r=2^{15}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px3.p1.1.m1.1"><semantics id="A2.SS0.SSS0.Px3.p1.1.m1.1a"><mrow id="A2.SS0.SSS0.Px3.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.2" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml">r</mi><mo id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.1" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><msup id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml"><mn id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.2" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.2.cmml">2</mn><mn id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.3" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.3.cmml">15</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1"><eq id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.1"></eq><ci id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.2">𝑟</ci><apply id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.1.cmml" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3">superscript</csymbol><cn id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.2.cmml" type="integer" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.2">2</cn><cn id="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.3.cmml" type="integer" xref="A2.SS0.SSS0.Px3.p1.1.m1.1.1.3.3">15</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px3.p1.1.m1.1c">r=2^{15}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px3.p1.1.m1.1d">italic_r = 2 start_POSTSUPERSCRIPT 15 end_POSTSUPERSCRIPT</annotation></semantics></math> entries <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib37" title="">2024</a>)</cite>the hash table’s maximum capacity at <math alttext="r=2^{18}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="A2.SS0.SSS0.Px3.p1.2.m2.1a"><mrow id="A2.SS0.SSS0.Px3.p1.2.m2.1.1" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">r</mi><mo id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.1" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml">=</mo><msup id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml"><mn id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.2" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml">2</mn><mn id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.3" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.cmml">18</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1"><eq id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.1"></eq><ci id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.2">𝑟</ci><apply id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3">superscript</csymbol><cn id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml" type="integer" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.2">2</cn><cn id="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.cmml" type="integer" xref="A2.SS0.SSS0.Px3.p1.2.m2.1.1.3.3">18</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px3.p1.2.m2.1c">r=2^{18}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px3.p1.2.m2.1d">italic_r = 2 start_POSTSUPERSCRIPT 18 end_POSTSUPERSCRIPT</annotation></semantics></math> entries (akin to the largest number of buckets that Linux stores).
<span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px3.p1.2.4">\replaced</span>Purge sequences are initiated and stale entries are removed as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#S2.SS3" title="2.3. Current Implementations ‣ 2. Background ‣ A Taxonomy and Comparative Analysis of IPv4 ID Selection Correctness, Security, and Performance"><span class="ltx_text ltx_ref_tag">2.3</span></a>.However, we omit the entries’ last access timestamps that Windows uses to determine if an entry is “stale” since our benchmark assigns IPIDs to packets as fast as physically possible instead of reflecting typical traffic patterns.
Instead, during a purge sequence, we simply delete each entry with a fixed probability (50%) to mimic the removal of stale entries.
Because adding, removing, and updating destination counters are not thread-safe, we lock the entire hash table for each IPID request.
Klein does not report on how Windows handles concurrency <cite class="ltx_cite ltx_citemacro_citep">(Klein, <a class="ltx_ref" href="https://arxiv.org/html/2406.06483v2#bib.bib36" title="">2022</a>)</cite>, and this appears to the be only solution that eliminates all race conditions.</p>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Per-Bucket (Linux)</h5>
<div class="ltx_para" id="A2.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px4.p1.1">For each of the <math alttext="r" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px4.p1.1.m1.1"><semantics id="A2.SS0.SSS0.Px4.p1.1.m1.1a"><mi id="A2.SS0.SSS0.Px4.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px4.p1.1.m1.1b"><ci id="A2.SS0.SSS0.Px4.p1.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px4.p1.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px4.p1.1.m1.1d">italic_r</annotation></semantics></math> buckets, we maintain a counter and a last access timestamp.
Following Linux’s implementation, we locate the bucket for a given packet using the SipHash-2-4 hash function on the packet’s destination and source IP addresses, the protocol number, and a randomly generated <span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px4.p1.1.1">\replaced</span>128-bit64-bit hash key.
A stochastic increment is generated using the difference between the current time and the last access timestamp, after which the increment is applied and the timestamp is updated.
Because multiple packets may simultaneously hash to the same bucket, some concurrency control is needed.
Unlike in per-destination selection, however, multiple buckets can be accessed concurrently, avoiding the need for a global lock.
We benchmarked two versions of per-bucket’s concurrency control: one which protects each bucket with a lock, and another that follows Linux’s actual implementation in making each bucket’s counter and last access timestamp individually atomic.
The latter allows a race condition where concurrent accesses to the same bucket could generate stochastic increments based on the same last access timestep and then atomically apply them to the same bucket counter.
This does not necessarily pose significant issues for correctness or security, but may change the statistical properties of the IPID sequences slightly.</p>
</div>
</section>
<section class="ltx_paragraph" id="A2.SS0.SSS0.Px5">
<h5 class="ltx_title ltx_title_paragraph">PRNG-based Methods</h5>
<div class="ltx_para" id="A2.SS0.SSS0.Px5.p1">
<p class="ltx_p" id="A2.SS0.SSS0.Px5.p1.1">Our implementation of PRNG selection with a searchable queue directly follows FreeBSD<span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px5.p1.1.1">\deleted</span> and macOS’s implementation<span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px5.p1.1.2">\deleted</span>s, and our implementation of the iterated Knuth shuffle follows OpenBSD’s.
Both of these methods coordinate multiple instructions that must be made atomically: e.g., testing membership of a new IPID in the queue and then enqueuing it, or swapping two IPIDs in the permutation before advancing the permutation’s start index.
To eliminate race conditions, we lock access to the associated data structures for each IPID request.
<span class="ltx_ERROR undefined" id="A2.SS0.SSS0.Px5.p1.1.3">\added</span>Our implementation of pure PRNG selection follows the macOS/XNU implementation, first reducing a 64-bit salt to a 16-bit salt, and then applying this reduced salt to an IPID chosen uniformly at random from among all <math alttext="2^{16}" class="ltx_Math" display="inline" id="A2.SS0.SSS0.Px5.p1.1.m1.1"><semantics id="A2.SS0.SSS0.Px5.p1.1.m1.1a"><msup id="A2.SS0.SSS0.Px5.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px5.p1.1.m1.1.1.cmml"><mn id="A2.SS0.SSS0.Px5.p1.1.m1.1.1.2" xref="A2.SS0.SSS0.Px5.p1.1.m1.1.1.2.cmml">2</mn><mn id="A2.SS0.SSS0.Px5.p1.1.m1.1.1.3" xref="A2.SS0.SSS0.Px5.p1.1.m1.1.1.3.cmml">16</mn></msup><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px5.p1.1.m1.1b"><apply id="A2.SS0.SSS0.Px5.p1.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS0.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="A2.SS0.SSS0.Px5.p1.1.m1.1.1">superscript</csymbol><cn id="A2.SS0.SSS0.Px5.p1.1.m1.1.1.2.cmml" type="integer" xref="A2.SS0.SSS0.Px5.p1.1.m1.1.1.2">2</cn><cn id="A2.SS0.SSS0.Px5.p1.1.m1.1.1.3.cmml" type="integer" xref="A2.SS0.SSS0.Px5.p1.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px5.p1.1.m1.1c">2^{16}</annotation><annotation encoding="application/x-llamapun" id="A2.SS0.SSS0.Px5.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT</annotation></semantics></math> values.
Since this method does not keep state, concurrency issues can be sidestepped by giving each thread its own random number generator.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Jul 12 23:43:54 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
