<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1912.13075] Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters</title><meta property="og:description" content="Federated learning is a distributed, privacy-aware learning scenario which trains a single model on data belonging to several clients. Each client trains a local model on its data and the local models are then aggregat…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1912.13075">

<!--Generated on Sat Mar  2 13:07:33 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hesham Mostafa 
<br class="ltx_break">Artificial Intelligence Products Group
<br class="ltx_break">Intel Corporation
<br class="ltx_break">San Diego, California
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">hesham.mostafa@intel.com</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Federated learning is a distributed, privacy-aware learning scenario which trains a single model on data belonging to several clients. Each client trains a local model on its data and the local models are then aggregated by a central party.
Current federated learning methods struggle in cases with heterogeneous client-side data distributions which can quickly lead to divergent local models and a collapse in performance. Careful hyper-parameter tuning is particularly important in these cases but traditional automated hyper-parameter tuning methods would require several training trials which is often impractical in a federated learning setting. We describe a two-pronged solution to the issues of robustness and hyper-parameter tuning in federated learning settings. We propose a novel representation matching scheme that reduces the divergence of local models by ensuring the feature representations in the global (aggregate) model can be derived from the locally learned representations. We also propose an online hyper-parameter tuning scheme which uses an online version of the REINFORCE algorithm to find a hyper-parameter distribution that maximizes the expected improvements in training loss. We show on several benchmarks that our two-part scheme of local representation matching and global adaptive hyper-parameters significantly improves performance and training robustness.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction </h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">The size of the data used to train machine learning models is steadily increasing, and the privacy concerns associated with storing and managing this data are becoming more pressing. Offloading model training to the data owners is an attractive solution to address both scalability and privacy concerns. This gives rise to the Federated Learning (FL) setting <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite> where several clients collaboratively train a model without disclosing their data. In synchronous FL, training proceeds in rounds where at the beginning of each round, a central party sends the latest version of the model to the clients. The clients (or a subset of them) train the received model on their local datasets and then communicate the resulting models to the central party at the end of the round. The central party aggregates the client models (typically by averaging them) to obtain the new version of the model which it then communicates to the clients in the next round.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">The FL setting poses a unique set of challenges compared to standard stochastic gradient descent (SGD) learning on a monolithic dataset. In real-world settings, data from each client may be drawn from different distributions, and this heterogeneity can lead the local learning processes to diverge from each other, harming the convergence rate and final performance of the aggregate model. We address this challenge in two ways: (1) adaptive on-line tuning of hyper-parameters; and (2) adding a regularization term that punishes divergent representation learning across clients.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Traditional hyper-parameter tuning schemes, such as random search <cite class="ltx_cite ltx_citemacro_citep">(Bergstra &amp; Bengio, <a href="#bib.bib2" title="" class="ltx_ref">2012</a>)</cite> or Bayesian methods <cite class="ltx_cite ltx_citemacro_citep">(Bergstra et al., <a href="#bib.bib3" title="" class="ltx_ref">2011</a>; Snoek et al., <a href="#bib.bib24" title="" class="ltx_ref">2012</a>)</cite>, require several training runs to evaluate the fitness of different hyper-parameters. This is impractical in the FL setting, which strives to minimize unnecessary communication. To address this issue, we formulate the hyper-parameter selection problem as an online reinforcement learning (RL) problem: in each round, the learners perform an action by selecting particular hyper-parameter values, and at the end of the round get a reward which is the relative reduction in training loss. We then update the hyper-parameter selection policy online to maximize the rewards.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Unlike centralized SGD, where there is a single trajectory of parameter updates, the FL setting has many local parameter trajectories, one per each active client. Even though they share the same initial point, these trajectories could significantly diverge. Averaging the endpoints of these divergent trajectories at the end of a training round would then result in a poor model <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib29" title="" class="ltx_ref">2018</a>)</cite>. Clients with heterogeneous data distributions exacerbate this effect as each client could quickly learn representations specific to its local dataset. We introduce a scheme that mitigates the problem of divergent representations: each client uses the representations it learns to reconstruct the representations in the initial model it receives. A client is thus discouraged from learning representations that are too specific and that discard information about the globally learned representations. We show that this representation matching scheme significantly improves robustness and accuracy in the presence of heterogeneous client-side data distributions.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">We evaluate the performance of our two-part scheme, representation matching and online hyper-parameter adjustments, on image classification tasks: MNIST, CIFAR10; and on a keyword spotting (KWS) task. We show that for homogeneous client-side data distributions, our scheme consistently improves accuracy. For heterogeneous clients, in addition to improving accuracy, our scheme improves training robustness and stops catastrophic training failures without having to manually tune hyper-parameters for each task.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">The simplest automated hyper-parameter tuning methods execute random searches in hyper-parameter space to find the best-performing hyper-parameters <cite class="ltx_cite ltx_citemacro_citep">(Bergstra &amp; Bengio, <a href="#bib.bib2" title="" class="ltx_ref">2012</a>)</cite>. Random search is outperformed by Bayesian methods <cite class="ltx_cite ltx_citemacro_citep">(Bergstra et al., <a href="#bib.bib3" title="" class="ltx_ref">2011</a>; Snoek et al., <a href="#bib.bib24" title="" class="ltx_ref">2012</a>)</cite> that use the performance of previously selected hyper-parameters to inform the choice of new hyper-parameter to try. In these methods, the fitness of a hyper-parameter choice is the post-training validation accuracy. Running the training process to completion in order to evaluate the hyper-parameter fitness is computationally intensive. This motivates running partial training runs instead <cite class="ltx_cite ltx_citemacro_citep">(Klein et al., <a href="#bib.bib11" title="" class="ltx_ref">2016</a>; Li et al., <a href="#bib.bib13" title="" class="ltx_ref">2016</a>)</cite>. However, in FL settings with tight communication budgets, running several (partial) training runs to select the right hyper-parameters could still be impractical.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p">Hyper-parameters can be optimized using gradient descent to minimize the final validation loss. To avoid storing the entire training trajectory in order to evaluate the hyper-gradients,  <cite class="ltx_cite ltx_citemacro_citet">Maclaurin et al. (<a href="#bib.bib16" title="" class="ltx_ref">2015</a>)</cite> uses reversible learning dynamics to allow the entire training trajectory to be reconstructed from the final model. Alternatively, the hyper-gradients can be calculated in a forward manner, albeit at an increased memory overhead <cite class="ltx_cite ltx_citemacro_citep">(Franceschi et al., <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite>. Using the hyper-gradient to optimize hyper-parameters is an iterative process that requires several standard training runs (hyper-iterations), again making this approach impractical in a communication-constrained FL setting. Hyper-parameters can be optimized using SGD in tandem with model parameters through the use of hyper-networks <cite class="ltx_cite ltx_citemacro_citep">(Ha et al., <a href="#bib.bib8" title="" class="ltx_ref">2016</a>; Lorraine &amp; Duvenaud, <a href="#bib.bib15" title="" class="ltx_ref">2018</a>)</cite> which map hyper-parameters to optimal model parameters. It is unclear how hyper-networks can be learned in a FL setting as we are interested in choosing hyper-parameters that result in the best <span id="S2.p2.1.1" class="ltx_text ltx_font_italic">post-aggregation</span> model and not the hyper-parameters chosen by any particular client to optimize its own model on its own dataset.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p">The hyper-parameter tuning approaches most related to ours are those based on RL methods.  <cite class="ltx_cite ltx_citemacro_citet">Daniel et al. (<a href="#bib.bib4" title="" class="ltx_ref">2016</a>); Jomaa et al. (<a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite> learn policies and/or state-action values that are then used to select good hyper-parameters. However, several training runs are needed to learn the policies and the action values. Perhaps the closest approach to ours is the method in <cite class="ltx_cite ltx_citemacro_citet">Xu et al. (<a href="#bib.bib27" title="" class="ltx_ref">2017</a>)</cite> which trains an actor-critic network in tandem with the main model and uses it to select actions (hyper-parameter choices) that maximize the expected reduction in training loss. It is unclear how this approach can be applied in a FL setting as the training process on each client has no access to the loss of interest which is the loss of the post-aggregation model.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p">FL typically struggles when the client-side data distributions are significantly different <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2016</a>; Zhao et al., <a href="#bib.bib29" title="" class="ltx_ref">2018</a>)</cite> as this causes the parameter trajectories to significantly diverge across different clients. This severely degrades the performance of the averaged model <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib29" title="" class="ltx_ref">2018</a>)</cite>. One straightforward solution is to reduce the SGD steps each client takes between the synchronization (model averaging) points. More frequent model synchronization, however, increases communication volume. Various compression methods <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al., <a href="#bib.bib22" title="" class="ltx_ref">2019</a>; Konečnỳ et al., <a href="#bib.bib12" title="" class="ltx_ref">2016</a>)</cite> are able to compress the model updates, which makes it possible to synchronize more frequently and mitigate the effect of heterogeneous data distributions.  <cite class="ltx_cite ltx_citemacro_citet">Sattler et al. (<a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite> takes the extreme case of synchronizing after every SGD step, which reduces the FL setting to standard SGD. An alternative solution is to mix the datasets of the different clients to obtain more homogeneous client-side data distributions <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib29" title="" class="ltx_ref">2018</a>)</cite>. This, however, compromises the privacy of the clients’ data.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>methods</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.30" class="ltx_p">We build upon the federated averaging (FedAvg) algorithm  <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite> and introduce two novel aspects to it: global adaptive hyper-parameters and local (per-client) representation matching. We first give an informal description of the complete algorithm. We consider a synchronous FedAvg setting with <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">K</annotation></semantics></math> clients, where <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="{\bf D}_{k}" display="inline"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">𝐃</mi><mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝐃</ci><ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">{\bf D}_{k}</annotation></semantics></math> is the dataset local to client <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">k</annotation></semantics></math>. Training proceeds in rounds. Figure <a href="#S3.F1" title="Figure 1 ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the steps involved in training round <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">t</annotation></semantics></math>. The server maintains a distribution <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="P({\mathcal{H}}|{\bf\psi})" display="inline"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">​</mo><mrow id="S3.p1.5.m5.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.5.m5.1.1.1.1.2" xref="S3.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.5.m5.1.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1.1.1.1.2" xref="S3.p1.5.m5.1.1.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S3.p1.5.m5.1.1.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml">|</mo><mi id="S3.p1.5.m5.1.1.1.1.1.3" xref="S3.p1.5.m5.1.1.1.1.1.3.cmml">ψ</mi></mrow><mo stretchy="false" id="S3.p1.5.m5.1.1.1.1.3" xref="S3.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><times id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2"></times><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝑃</ci><apply id="S3.p1.5.m5.1.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1"><csymbol cd="latexml" id="S3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.p1.5.m5.1.1.1.1.1.2">ℋ</ci><ci id="S3.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.p1.5.m5.1.1.1.1.1.3">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">P({\mathcal{H}}|{\bf\psi})</annotation></semantics></math> over the space of hyper-parameters <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="{\mathcal{H}}" display="inline"><semantics id="S3.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">{\mathcal{H}}</annotation></semantics></math>. At the beginning of round <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p1.7.m7.1a"><mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">t</annotation></semantics></math> (Fig. <a href="#S3.F1.sf1" title="In Figure 1 ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>), the selected clients receive the most recent model parameters from the server, <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="{\bf w}_{t}" display="inline"><semantics id="S3.p1.8.m8.1a"><msub id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">𝐰</mi><mi id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">𝐰</ci><ci id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">{\bf w}_{t}</annotation></semantics></math>, together with training hyper-parameters <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="{\bf h}_{t}" display="inline"><semantics id="S3.p1.9.m9.1a"><msub id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml"><mi id="S3.p1.9.m9.1.1.2" xref="S3.p1.9.m9.1.1.2.cmml">𝐡</mi><mi id="S3.p1.9.m9.1.1.3" xref="S3.p1.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1.2">𝐡</ci><ci id="S3.p1.9.m9.1.1.3.cmml" xref="S3.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">{\bf h}_{t}</annotation></semantics></math> sampled from <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="P({\mathcal{H}}|{\bf\psi}_{t})" display="inline"><semantics id="S3.p1.10.m10.1a"><mrow id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml"><mi id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m10.1.1.2" xref="S3.p1.10.m10.1.1.2.cmml">​</mo><mrow id="S3.p1.10.m10.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.10.m10.1.1.1.1.2" xref="S3.p1.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.10.m10.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.10.m10.1.1.1.1.1.2" xref="S3.p1.10.m10.1.1.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S3.p1.10.m10.1.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.10.m10.1.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.1.3.cmml"><mi id="S3.p1.10.m10.1.1.1.1.1.3.2" xref="S3.p1.10.m10.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.p1.10.m10.1.1.1.1.1.3.3" xref="S3.p1.10.m10.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.p1.10.m10.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1"><times id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1.2"></times><ci id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3">𝑃</ci><apply id="S3.p1.10.m10.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1"><csymbol cd="latexml" id="S3.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p1.10.m10.1.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.2">ℋ</ci><apply id="S3.p1.10.m10.1.1.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.1.3.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.10.m10.1.1.1.1.1.3.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.p1.10.m10.1.1.1.1.1.3.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">P({\mathcal{H}}|{\bf\psi}_{t})</annotation></semantics></math>. Client <math id="S3.p1.11.m11.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.11.m11.1a"><mi id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><ci id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">i</annotation></semantics></math> uses two copies of <math id="S3.p1.12.m12.1" class="ltx_Math" alttext="{\bf w}_{t}" display="inline"><semantics id="S3.p1.12.m12.1a"><msub id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml"><mi id="S3.p1.12.m12.1.1.2" xref="S3.p1.12.m12.1.1.2.cmml">𝐰</mi><mi id="S3.p1.12.m12.1.1.3" xref="S3.p1.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><apply id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.p1.12.m12.1.1.1.cmml" xref="S3.p1.12.m12.1.1">subscript</csymbol><ci id="S3.p1.12.m12.1.1.2.cmml" xref="S3.p1.12.m12.1.1.2">𝐰</ci><ci id="S3.p1.12.m12.1.1.3.cmml" xref="S3.p1.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">{\bf w}_{t}</annotation></semantics></math> to initialize two models: a fixed model <math id="S3.p1.13.m13.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.p1.13.m13.1a"><msup id="S3.p1.13.m13.1.1" xref="S3.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.13.m13.1.1.2" xref="S3.p1.13.m13.1.1.2.cmml">ℳ</mi><mi id="S3.p1.13.m13.1.1.3" xref="S3.p1.13.m13.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><apply id="S3.p1.13.m13.1.1.cmml" xref="S3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.cmml" xref="S3.p1.13.m13.1.1">superscript</csymbol><ci id="S3.p1.13.m13.1.1.2.cmml" xref="S3.p1.13.m13.1.1.2">ℳ</ci><ci id="S3.p1.13.m13.1.1.3.cmml" xref="S3.p1.13.m13.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">{\mathcal{M}}^{F}</annotation></semantics></math> and a trainable model <math id="S3.p1.14.m14.1" class="ltx_Math" alttext="{\mathcal{M}}_{t}^{i}" display="inline"><semantics id="S3.p1.14.m14.1a"><msubsup id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.14.m14.1.1.2.2" xref="S3.p1.14.m14.1.1.2.2.cmml">ℳ</mi><mi id="S3.p1.14.m14.1.1.2.3" xref="S3.p1.14.m14.1.1.2.3.cmml">t</mi><mi id="S3.p1.14.m14.1.1.3" xref="S3.p1.14.m14.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><apply id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.cmml" xref="S3.p1.14.m14.1.1">superscript</csymbol><apply id="S3.p1.14.m14.1.1.2.cmml" xref="S3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.2.1.cmml" xref="S3.p1.14.m14.1.1">subscript</csymbol><ci id="S3.p1.14.m14.1.1.2.2.cmml" xref="S3.p1.14.m14.1.1.2.2">ℳ</ci><ci id="S3.p1.14.m14.1.1.2.3.cmml" xref="S3.p1.14.m14.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.14.m14.1.1.3.cmml" xref="S3.p1.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">{\mathcal{M}}_{t}^{i}</annotation></semantics></math>. The parameters <math id="S3.p1.15.m15.1" class="ltx_Math" alttext="{\bf w}_{t}^{i}" display="inline"><semantics id="S3.p1.15.m15.1a"><msubsup id="S3.p1.15.m15.1.1" xref="S3.p1.15.m15.1.1.cmml"><mi id="S3.p1.15.m15.1.1.2.2" xref="S3.p1.15.m15.1.1.2.2.cmml">𝐰</mi><mi id="S3.p1.15.m15.1.1.2.3" xref="S3.p1.15.m15.1.1.2.3.cmml">t</mi><mi id="S3.p1.15.m15.1.1.3" xref="S3.p1.15.m15.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.15.m15.1b"><apply id="S3.p1.15.m15.1.1.cmml" xref="S3.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.p1.15.m15.1.1.1.cmml" xref="S3.p1.15.m15.1.1">superscript</csymbol><apply id="S3.p1.15.m15.1.1.2.cmml" xref="S3.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.p1.15.m15.1.1.2.1.cmml" xref="S3.p1.15.m15.1.1">subscript</csymbol><ci id="S3.p1.15.m15.1.1.2.2.cmml" xref="S3.p1.15.m15.1.1.2.2">𝐰</ci><ci id="S3.p1.15.m15.1.1.2.3.cmml" xref="S3.p1.15.m15.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.15.m15.1.1.3.cmml" xref="S3.p1.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m15.1c">{\bf w}_{t}^{i}</annotation></semantics></math> of <math id="S3.p1.16.m16.1" class="ltx_Math" alttext="{\mathcal{M}}_{t}^{i}" display="inline"><semantics id="S3.p1.16.m16.1a"><msubsup id="S3.p1.16.m16.1.1" xref="S3.p1.16.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.16.m16.1.1.2.2" xref="S3.p1.16.m16.1.1.2.2.cmml">ℳ</mi><mi id="S3.p1.16.m16.1.1.2.3" xref="S3.p1.16.m16.1.1.2.3.cmml">t</mi><mi id="S3.p1.16.m16.1.1.3" xref="S3.p1.16.m16.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.16.m16.1b"><apply id="S3.p1.16.m16.1.1.cmml" xref="S3.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.1.1.1.cmml" xref="S3.p1.16.m16.1.1">superscript</csymbol><apply id="S3.p1.16.m16.1.1.2.cmml" xref="S3.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.1.1.2.1.cmml" xref="S3.p1.16.m16.1.1">subscript</csymbol><ci id="S3.p1.16.m16.1.1.2.2.cmml" xref="S3.p1.16.m16.1.1.2.2">ℳ</ci><ci id="S3.p1.16.m16.1.1.2.3.cmml" xref="S3.p1.16.m16.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.16.m16.1.1.3.cmml" xref="S3.p1.16.m16.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m16.1c">{\mathcal{M}}_{t}^{i}</annotation></semantics></math> are trained using SGD (Fig. <a href="#S3.F1.sf2" title="In Figure 1 ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>). Client <math id="S3.p1.17.m17.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.17.m17.1a"><mi id="S3.p1.17.m17.1.1" xref="S3.p1.17.m17.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.17.m17.1b"><ci id="S3.p1.17.m17.1.1.cmml" xref="S3.p1.17.m17.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m17.1c">i</annotation></semantics></math> maintains a set of local parameters <math id="S3.p1.18.m18.1" class="ltx_Math" alttext="{\bf\theta}_{t}^{i}" display="inline"><semantics id="S3.p1.18.m18.1a"><msubsup id="S3.p1.18.m18.1.1" xref="S3.p1.18.m18.1.1.cmml"><mi id="S3.p1.18.m18.1.1.2.2" xref="S3.p1.18.m18.1.1.2.2.cmml">θ</mi><mi id="S3.p1.18.m18.1.1.2.3" xref="S3.p1.18.m18.1.1.2.3.cmml">t</mi><mi id="S3.p1.18.m18.1.1.3" xref="S3.p1.18.m18.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.18.m18.1b"><apply id="S3.p1.18.m18.1.1.cmml" xref="S3.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.1.cmml" xref="S3.p1.18.m18.1.1">superscript</csymbol><apply id="S3.p1.18.m18.1.1.2.cmml" xref="S3.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.2.1.cmml" xref="S3.p1.18.m18.1.1">subscript</csymbol><ci id="S3.p1.18.m18.1.1.2.2.cmml" xref="S3.p1.18.m18.1.1.2.2">𝜃</ci><ci id="S3.p1.18.m18.1.1.2.3.cmml" xref="S3.p1.18.m18.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.18.m18.1.1.3.cmml" xref="S3.p1.18.m18.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m18.1c">{\bf\theta}_{t}^{i}</annotation></semantics></math> that it uses to map the activations in <math id="S3.p1.19.m19.1" class="ltx_Math" alttext="{\mathcal{M}}_{t}^{i}" display="inline"><semantics id="S3.p1.19.m19.1a"><msubsup id="S3.p1.19.m19.1.1" xref="S3.p1.19.m19.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.19.m19.1.1.2.2" xref="S3.p1.19.m19.1.1.2.2.cmml">ℳ</mi><mi id="S3.p1.19.m19.1.1.2.3" xref="S3.p1.19.m19.1.1.2.3.cmml">t</mi><mi id="S3.p1.19.m19.1.1.3" xref="S3.p1.19.m19.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.19.m19.1b"><apply id="S3.p1.19.m19.1.1.cmml" xref="S3.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S3.p1.19.m19.1.1.1.cmml" xref="S3.p1.19.m19.1.1">superscript</csymbol><apply id="S3.p1.19.m19.1.1.2.cmml" xref="S3.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S3.p1.19.m19.1.1.2.1.cmml" xref="S3.p1.19.m19.1.1">subscript</csymbol><ci id="S3.p1.19.m19.1.1.2.2.cmml" xref="S3.p1.19.m19.1.1.2.2">ℳ</ci><ci id="S3.p1.19.m19.1.1.2.3.cmml" xref="S3.p1.19.m19.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.19.m19.1.1.3.cmml" xref="S3.p1.19.m19.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m19.1c">{\mathcal{M}}_{t}^{i}</annotation></semantics></math> to the activations in <math id="S3.p1.20.m20.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.p1.20.m20.1a"><msup id="S3.p1.20.m20.1.1" xref="S3.p1.20.m20.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.20.m20.1.1.2" xref="S3.p1.20.m20.1.1.2.cmml">ℳ</mi><mi id="S3.p1.20.m20.1.1.3" xref="S3.p1.20.m20.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.20.m20.1b"><apply id="S3.p1.20.m20.1.1.cmml" xref="S3.p1.20.m20.1.1"><csymbol cd="ambiguous" id="S3.p1.20.m20.1.1.1.cmml" xref="S3.p1.20.m20.1.1">superscript</csymbol><ci id="S3.p1.20.m20.1.1.2.cmml" xref="S3.p1.20.m20.1.1.2">ℳ</ci><ci id="S3.p1.20.m20.1.1.3.cmml" xref="S3.p1.20.m20.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.20.m20.1c">{\mathcal{M}}^{F}</annotation></semantics></math>. <math id="S3.p1.21.m21.1" class="ltx_Math" alttext="{\bf\theta}_{t}^{i}" display="inline"><semantics id="S3.p1.21.m21.1a"><msubsup id="S3.p1.21.m21.1.1" xref="S3.p1.21.m21.1.1.cmml"><mi id="S3.p1.21.m21.1.1.2.2" xref="S3.p1.21.m21.1.1.2.2.cmml">θ</mi><mi id="S3.p1.21.m21.1.1.2.3" xref="S3.p1.21.m21.1.1.2.3.cmml">t</mi><mi id="S3.p1.21.m21.1.1.3" xref="S3.p1.21.m21.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.21.m21.1b"><apply id="S3.p1.21.m21.1.1.cmml" xref="S3.p1.21.m21.1.1"><csymbol cd="ambiguous" id="S3.p1.21.m21.1.1.1.cmml" xref="S3.p1.21.m21.1.1">superscript</csymbol><apply id="S3.p1.21.m21.1.1.2.cmml" xref="S3.p1.21.m21.1.1"><csymbol cd="ambiguous" id="S3.p1.21.m21.1.1.2.1.cmml" xref="S3.p1.21.m21.1.1">subscript</csymbol><ci id="S3.p1.21.m21.1.1.2.2.cmml" xref="S3.p1.21.m21.1.1.2.2">𝜃</ci><ci id="S3.p1.21.m21.1.1.2.3.cmml" xref="S3.p1.21.m21.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.21.m21.1.1.3.cmml" xref="S3.p1.21.m21.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.21.m21.1c">{\bf\theta}_{t}^{i}</annotation></semantics></math> and <math id="S3.p1.22.m22.1" class="ltx_Math" alttext="{\bf w}_{t}^{i}" display="inline"><semantics id="S3.p1.22.m22.1a"><msubsup id="S3.p1.22.m22.1.1" xref="S3.p1.22.m22.1.1.cmml"><mi id="S3.p1.22.m22.1.1.2.2" xref="S3.p1.22.m22.1.1.2.2.cmml">𝐰</mi><mi id="S3.p1.22.m22.1.1.2.3" xref="S3.p1.22.m22.1.1.2.3.cmml">t</mi><mi id="S3.p1.22.m22.1.1.3" xref="S3.p1.22.m22.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.22.m22.1b"><apply id="S3.p1.22.m22.1.1.cmml" xref="S3.p1.22.m22.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m22.1.1.1.cmml" xref="S3.p1.22.m22.1.1">superscript</csymbol><apply id="S3.p1.22.m22.1.1.2.cmml" xref="S3.p1.22.m22.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m22.1.1.2.1.cmml" xref="S3.p1.22.m22.1.1">subscript</csymbol><ci id="S3.p1.22.m22.1.1.2.2.cmml" xref="S3.p1.22.m22.1.1.2.2">𝐰</ci><ci id="S3.p1.22.m22.1.1.2.3.cmml" xref="S3.p1.22.m22.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.22.m22.1.1.3.cmml" xref="S3.p1.22.m22.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.22.m22.1c">{\bf w}_{t}^{i}</annotation></semantics></math> are simultaneously trained to minimize a two-component loss: the first component is the standard training loss of <math id="S3.p1.23.m23.1" class="ltx_Math" alttext="{\mathcal{M}}_{t}^{i}" display="inline"><semantics id="S3.p1.23.m23.1a"><msubsup id="S3.p1.23.m23.1.1" xref="S3.p1.23.m23.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.23.m23.1.1.2.2" xref="S3.p1.23.m23.1.1.2.2.cmml">ℳ</mi><mi id="S3.p1.23.m23.1.1.2.3" xref="S3.p1.23.m23.1.1.2.3.cmml">t</mi><mi id="S3.p1.23.m23.1.1.3" xref="S3.p1.23.m23.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.23.m23.1b"><apply id="S3.p1.23.m23.1.1.cmml" xref="S3.p1.23.m23.1.1"><csymbol cd="ambiguous" id="S3.p1.23.m23.1.1.1.cmml" xref="S3.p1.23.m23.1.1">superscript</csymbol><apply id="S3.p1.23.m23.1.1.2.cmml" xref="S3.p1.23.m23.1.1"><csymbol cd="ambiguous" id="S3.p1.23.m23.1.1.2.1.cmml" xref="S3.p1.23.m23.1.1">subscript</csymbol><ci id="S3.p1.23.m23.1.1.2.2.cmml" xref="S3.p1.23.m23.1.1.2.2">ℳ</ci><ci id="S3.p1.23.m23.1.1.2.3.cmml" xref="S3.p1.23.m23.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.23.m23.1.1.3.cmml" xref="S3.p1.23.m23.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.23.m23.1c">{\mathcal{M}}_{t}^{i}</annotation></semantics></math> on <math id="S3.p1.24.m24.1" class="ltx_Math" alttext="{\bf D}_{i}" display="inline"><semantics id="S3.p1.24.m24.1a"><msub id="S3.p1.24.m24.1.1" xref="S3.p1.24.m24.1.1.cmml"><mi id="S3.p1.24.m24.1.1.2" xref="S3.p1.24.m24.1.1.2.cmml">𝐃</mi><mi id="S3.p1.24.m24.1.1.3" xref="S3.p1.24.m24.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.24.m24.1b"><apply id="S3.p1.24.m24.1.1.cmml" xref="S3.p1.24.m24.1.1"><csymbol cd="ambiguous" id="S3.p1.24.m24.1.1.1.cmml" xref="S3.p1.24.m24.1.1">subscript</csymbol><ci id="S3.p1.24.m24.1.1.2.cmml" xref="S3.p1.24.m24.1.1.2">𝐃</ci><ci id="S3.p1.24.m24.1.1.3.cmml" xref="S3.p1.24.m24.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.24.m24.1c">{\bf D}_{i}</annotation></semantics></math> (for example, the cross-entropy loss); the second component is the mean squared difference between the activations in <math id="S3.p1.25.m25.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.p1.25.m25.1a"><msup id="S3.p1.25.m25.1.1" xref="S3.p1.25.m25.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.25.m25.1.1.2" xref="S3.p1.25.m25.1.1.2.cmml">ℳ</mi><mi id="S3.p1.25.m25.1.1.3" xref="S3.p1.25.m25.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.25.m25.1b"><apply id="S3.p1.25.m25.1.1.cmml" xref="S3.p1.25.m25.1.1"><csymbol cd="ambiguous" id="S3.p1.25.m25.1.1.1.cmml" xref="S3.p1.25.m25.1.1">superscript</csymbol><ci id="S3.p1.25.m25.1.1.2.cmml" xref="S3.p1.25.m25.1.1.2">ℳ</ci><ci id="S3.p1.25.m25.1.1.3.cmml" xref="S3.p1.25.m25.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.25.m25.1c">{\mathcal{M}}^{F}</annotation></semantics></math> and the activations reconstructed from <math id="S3.p1.26.m26.1" class="ltx_Math" alttext="{\mathcal{M}}_{t}^{i}" display="inline"><semantics id="S3.p1.26.m26.1a"><msubsup id="S3.p1.26.m26.1.1" xref="S3.p1.26.m26.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.26.m26.1.1.2.2" xref="S3.p1.26.m26.1.1.2.2.cmml">ℳ</mi><mi id="S3.p1.26.m26.1.1.2.3" xref="S3.p1.26.m26.1.1.2.3.cmml">t</mi><mi id="S3.p1.26.m26.1.1.3" xref="S3.p1.26.m26.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.26.m26.1b"><apply id="S3.p1.26.m26.1.1.cmml" xref="S3.p1.26.m26.1.1"><csymbol cd="ambiguous" id="S3.p1.26.m26.1.1.1.cmml" xref="S3.p1.26.m26.1.1">superscript</csymbol><apply id="S3.p1.26.m26.1.1.2.cmml" xref="S3.p1.26.m26.1.1"><csymbol cd="ambiguous" id="S3.p1.26.m26.1.1.2.1.cmml" xref="S3.p1.26.m26.1.1">subscript</csymbol><ci id="S3.p1.26.m26.1.1.2.2.cmml" xref="S3.p1.26.m26.1.1.2.2">ℳ</ci><ci id="S3.p1.26.m26.1.1.2.3.cmml" xref="S3.p1.26.m26.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.26.m26.1.1.3.cmml" xref="S3.p1.26.m26.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.26.m26.1c">{\mathcal{M}}_{t}^{i}</annotation></semantics></math> using <math id="S3.p1.27.m27.1" class="ltx_Math" alttext="{\bf\theta}_{t}^{i}" display="inline"><semantics id="S3.p1.27.m27.1a"><msubsup id="S3.p1.27.m27.1.1" xref="S3.p1.27.m27.1.1.cmml"><mi id="S3.p1.27.m27.1.1.2.2" xref="S3.p1.27.m27.1.1.2.2.cmml">θ</mi><mi id="S3.p1.27.m27.1.1.2.3" xref="S3.p1.27.m27.1.1.2.3.cmml">t</mi><mi id="S3.p1.27.m27.1.1.3" xref="S3.p1.27.m27.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.27.m27.1b"><apply id="S3.p1.27.m27.1.1.cmml" xref="S3.p1.27.m27.1.1"><csymbol cd="ambiguous" id="S3.p1.27.m27.1.1.1.cmml" xref="S3.p1.27.m27.1.1">superscript</csymbol><apply id="S3.p1.27.m27.1.1.2.cmml" xref="S3.p1.27.m27.1.1"><csymbol cd="ambiguous" id="S3.p1.27.m27.1.1.2.1.cmml" xref="S3.p1.27.m27.1.1">subscript</csymbol><ci id="S3.p1.27.m27.1.1.2.2.cmml" xref="S3.p1.27.m27.1.1.2.2">𝜃</ci><ci id="S3.p1.27.m27.1.1.2.3.cmml" xref="S3.p1.27.m27.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.27.m27.1.1.3.cmml" xref="S3.p1.27.m27.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.27.m27.1c">{\bf\theta}_{t}^{i}</annotation></semantics></math>. We denote this second component as the representation matching loss. In the final step in the round (Fig. <a href="#S3.F1.sf3" title="In Figure 1 ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a>), each participating client sends its final model parameters, <math id="S3.p1.28.m28.1" class="ltx_Math" alttext="{\bf w}_{t}^{i}" display="inline"><semantics id="S3.p1.28.m28.1a"><msubsup id="S3.p1.28.m28.1.1" xref="S3.p1.28.m28.1.1.cmml"><mi id="S3.p1.28.m28.1.1.2.2" xref="S3.p1.28.m28.1.1.2.2.cmml">𝐰</mi><mi id="S3.p1.28.m28.1.1.2.3" xref="S3.p1.28.m28.1.1.2.3.cmml">t</mi><mi id="S3.p1.28.m28.1.1.3" xref="S3.p1.28.m28.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.28.m28.1b"><apply id="S3.p1.28.m28.1.1.cmml" xref="S3.p1.28.m28.1.1"><csymbol cd="ambiguous" id="S3.p1.28.m28.1.1.1.cmml" xref="S3.p1.28.m28.1.1">superscript</csymbol><apply id="S3.p1.28.m28.1.1.2.cmml" xref="S3.p1.28.m28.1.1"><csymbol cd="ambiguous" id="S3.p1.28.m28.1.1.2.1.cmml" xref="S3.p1.28.m28.1.1">subscript</csymbol><ci id="S3.p1.28.m28.1.1.2.2.cmml" xref="S3.p1.28.m28.1.1.2.2">𝐰</ci><ci id="S3.p1.28.m28.1.1.2.3.cmml" xref="S3.p1.28.m28.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.28.m28.1.1.3.cmml" xref="S3.p1.28.m28.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.28.m28.1c">{\bf w}_{t}^{i}</annotation></semantics></math>, to the central server. The server aggregates the model parameters, and uses the loss of the resulting model to update the parameters <math id="S3.p1.29.m29.1" class="ltx_Math" alttext="{\bf\psi}" display="inline"><semantics id="S3.p1.29.m29.1a"><mi id="S3.p1.29.m29.1.1" xref="S3.p1.29.m29.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.29.m29.1b"><ci id="S3.p1.29.m29.1.1.cmml" xref="S3.p1.29.m29.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.29.m29.1c">{\bf\psi}</annotation></semantics></math> of the hyper-parameter distribution, <math id="S3.p1.30.m30.1" class="ltx_Math" alttext="P({\mathcal{H}}|{\bf\psi})" display="inline"><semantics id="S3.p1.30.m30.1a"><mrow id="S3.p1.30.m30.1.1" xref="S3.p1.30.m30.1.1.cmml"><mi id="S3.p1.30.m30.1.1.3" xref="S3.p1.30.m30.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.p1.30.m30.1.1.2" xref="S3.p1.30.m30.1.1.2.cmml">​</mo><mrow id="S3.p1.30.m30.1.1.1.1" xref="S3.p1.30.m30.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.30.m30.1.1.1.1.2" xref="S3.p1.30.m30.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.30.m30.1.1.1.1.1" xref="S3.p1.30.m30.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.30.m30.1.1.1.1.1.2" xref="S3.p1.30.m30.1.1.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S3.p1.30.m30.1.1.1.1.1.1" xref="S3.p1.30.m30.1.1.1.1.1.1.cmml">|</mo><mi id="S3.p1.30.m30.1.1.1.1.1.3" xref="S3.p1.30.m30.1.1.1.1.1.3.cmml">ψ</mi></mrow><mo stretchy="false" id="S3.p1.30.m30.1.1.1.1.3" xref="S3.p1.30.m30.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.30.m30.1b"><apply id="S3.p1.30.m30.1.1.cmml" xref="S3.p1.30.m30.1.1"><times id="S3.p1.30.m30.1.1.2.cmml" xref="S3.p1.30.m30.1.1.2"></times><ci id="S3.p1.30.m30.1.1.3.cmml" xref="S3.p1.30.m30.1.1.3">𝑃</ci><apply id="S3.p1.30.m30.1.1.1.1.1.cmml" xref="S3.p1.30.m30.1.1.1.1"><csymbol cd="latexml" id="S3.p1.30.m30.1.1.1.1.1.1.cmml" xref="S3.p1.30.m30.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p1.30.m30.1.1.1.1.1.2.cmml" xref="S3.p1.30.m30.1.1.1.1.1.2">ℋ</ci><ci id="S3.p1.30.m30.1.1.1.1.1.3.cmml" xref="S3.p1.30.m30.1.1.1.1.1.3">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.30.m30.1c">P({\mathcal{H}}|{\bf\psi})</annotation></semantics></math>.</p>
</div>
<figure id="S3.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x1.png" id="S3.F1.sf1.g1" class="ltx_graphics ltx_img_landscape" width="422" height="333" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x2.png" id="S3.F1.sf2.g1" class="ltx_graphics ltx_img_landscape" width="422" height="333" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F1.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x3.png" id="S3.F1.sf3.g1" class="ltx_graphics ltx_img_landscape" width="422" height="333" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The three steps in a federated learning round. (<a href="#S3.F1.sf1" title="In Figure 1 ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>) The server communicates the latest model parameters <math id="S3.F1.7.m1.1" class="ltx_Math" alttext="{\bf w}_{t}" display="inline"><semantics id="S3.F1.7.m1.1b"><msub id="S3.F1.7.m1.1.1" xref="S3.F1.7.m1.1.1.cmml"><mi id="S3.F1.7.m1.1.1.2" xref="S3.F1.7.m1.1.1.2.cmml">𝐰</mi><mi id="S3.F1.7.m1.1.1.3" xref="S3.F1.7.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.7.m1.1c"><apply id="S3.F1.7.m1.1.1.cmml" xref="S3.F1.7.m1.1.1"><csymbol cd="ambiguous" id="S3.F1.7.m1.1.1.1.cmml" xref="S3.F1.7.m1.1.1">subscript</csymbol><ci id="S3.F1.7.m1.1.1.2.cmml" xref="S3.F1.7.m1.1.1.2">𝐰</ci><ci id="S3.F1.7.m1.1.1.3.cmml" xref="S3.F1.7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.7.m1.1d">{\bf w}_{t}</annotation></semantics></math> and the training hyper-parameters <math id="S3.F1.8.m2.1" class="ltx_Math" alttext="{\bf h}_{t}" display="inline"><semantics id="S3.F1.8.m2.1b"><msub id="S3.F1.8.m2.1.1" xref="S3.F1.8.m2.1.1.cmml"><mi id="S3.F1.8.m2.1.1.2" xref="S3.F1.8.m2.1.1.2.cmml">𝐡</mi><mi id="S3.F1.8.m2.1.1.3" xref="S3.F1.8.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.8.m2.1c"><apply id="S3.F1.8.m2.1.1.cmml" xref="S3.F1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.F1.8.m2.1.1.1.cmml" xref="S3.F1.8.m2.1.1">subscript</csymbol><ci id="S3.F1.8.m2.1.1.2.cmml" xref="S3.F1.8.m2.1.1.2">𝐡</ci><ci id="S3.F1.8.m2.1.1.3.cmml" xref="S3.F1.8.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.8.m2.1d">{\bf h}_{t}</annotation></semantics></math> to each client. (<a href="#S3.F1.sf2" title="In Figure 1 ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>) client <math id="S3.F1.9.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.F1.9.m3.1b"><mi id="S3.F1.9.m3.1.1" xref="S3.F1.9.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.F1.9.m3.1c"><ci id="S3.F1.9.m3.1.1.cmml" xref="S3.F1.9.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.9.m3.1d">i</annotation></semantics></math> trains the model parameters <math id="S3.F1.10.m4.1" class="ltx_Math" alttext="{\bf w}_{t}^{i}" display="inline"><semantics id="S3.F1.10.m4.1b"><msubsup id="S3.F1.10.m4.1.1" xref="S3.F1.10.m4.1.1.cmml"><mi id="S3.F1.10.m4.1.1.2.2" xref="S3.F1.10.m4.1.1.2.2.cmml">𝐰</mi><mi id="S3.F1.10.m4.1.1.2.3" xref="S3.F1.10.m4.1.1.2.3.cmml">t</mi><mi id="S3.F1.10.m4.1.1.3" xref="S3.F1.10.m4.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F1.10.m4.1c"><apply id="S3.F1.10.m4.1.1.cmml" xref="S3.F1.10.m4.1.1"><csymbol cd="ambiguous" id="S3.F1.10.m4.1.1.1.cmml" xref="S3.F1.10.m4.1.1">superscript</csymbol><apply id="S3.F1.10.m4.1.1.2.cmml" xref="S3.F1.10.m4.1.1"><csymbol cd="ambiguous" id="S3.F1.10.m4.1.1.2.1.cmml" xref="S3.F1.10.m4.1.1">subscript</csymbol><ci id="S3.F1.10.m4.1.1.2.2.cmml" xref="S3.F1.10.m4.1.1.2.2">𝐰</ci><ci id="S3.F1.10.m4.1.1.2.3.cmml" xref="S3.F1.10.m4.1.1.2.3">𝑡</ci></apply><ci id="S3.F1.10.m4.1.1.3.cmml" xref="S3.F1.10.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.10.m4.1d">{\bf w}_{t}^{i}</annotation></semantics></math> and the representation matching parameters <math id="S3.F1.11.m5.1" class="ltx_Math" alttext="{\bf\theta}_{t}^{i}" display="inline"><semantics id="S3.F1.11.m5.1b"><msubsup id="S3.F1.11.m5.1.1" xref="S3.F1.11.m5.1.1.cmml"><mi id="S3.F1.11.m5.1.1.2.2" xref="S3.F1.11.m5.1.1.2.2.cmml">θ</mi><mi id="S3.F1.11.m5.1.1.2.3" xref="S3.F1.11.m5.1.1.2.3.cmml">t</mi><mi id="S3.F1.11.m5.1.1.3" xref="S3.F1.11.m5.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F1.11.m5.1c"><apply id="S3.F1.11.m5.1.1.cmml" xref="S3.F1.11.m5.1.1"><csymbol cd="ambiguous" id="S3.F1.11.m5.1.1.1.cmml" xref="S3.F1.11.m5.1.1">superscript</csymbol><apply id="S3.F1.11.m5.1.1.2.cmml" xref="S3.F1.11.m5.1.1"><csymbol cd="ambiguous" id="S3.F1.11.m5.1.1.2.1.cmml" xref="S3.F1.11.m5.1.1">subscript</csymbol><ci id="S3.F1.11.m5.1.1.2.2.cmml" xref="S3.F1.11.m5.1.1.2.2">𝜃</ci><ci id="S3.F1.11.m5.1.1.2.3.cmml" xref="S3.F1.11.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.F1.11.m5.1.1.3.cmml" xref="S3.F1.11.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.11.m5.1d">{\bf\theta}_{t}^{i}</annotation></semantics></math> to minimize the classification loss and the matching loss. (<a href="#S3.F1.sf3" title="In Figure 1 ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a>) Each client sends back the updated model parameters to the server. The server aggregates the received parameters, evaluates the loss of the aggregate model, and updates the parameters of the hyper-parameter distribution, <math id="S3.F1.12.m6.1" class="ltx_Math" alttext="{\bf\psi}" display="inline"><semantics id="S3.F1.12.m6.1b"><mi id="S3.F1.12.m6.1.1" xref="S3.F1.12.m6.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.F1.12.m6.1c"><ci id="S3.F1.12.m6.1.1.cmml" xref="S3.F1.12.m6.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.12.m6.1d">{\bf\psi}</annotation></semantics></math>, based on the history of the aggregate losses.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Representation Matching</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.20" class="ltx_p">We now describe the representation matching scheme. For an example model, Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.1 Representation Matching ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates how the local parameters <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="{\bf\theta}^{i}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msup id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝜃</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">{\bf\theta}^{i}</annotation></semantics></math> in client <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">i</annotation></semantics></math> are used to map the activations of the model being trained, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="{\mathcal{M}}^{i}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msup id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">ℳ</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">{\mathcal{M}}^{i}</annotation></semantics></math>,to the activations of the fixed model <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">ℳ</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">{\mathcal{M}}^{F}</annotation></semantics></math>. <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="{\mathcal{M}}^{i}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msup id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">ℳ</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">{\mathcal{M}}^{i}</annotation></semantics></math> is parameterized by <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="{\bf w}^{i}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msup id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐰</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">{\bf w}^{i}</annotation></semantics></math> while <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><msup id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">ℳ</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">{\mathcal{M}}^{F}</annotation></semantics></math> is parameterized by <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="{\bf w}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">{\bf w}</annotation></semantics></math> which was received from the server at the beginning of training. To simplify notation, we dropped the index of the round, <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">t</annotation></semantics></math>. Given a data point <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="{\bf x}\sim{\bf D}_{i}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">𝐱</mi><mo id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.cmml">∼</mo><msub id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">𝐃</mi><mi id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="latexml" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1">similar-to</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝐱</ci><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">𝐃</ci><ci id="S3.SS1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">{\bf x}\sim{\bf D}_{i}</annotation></semantics></math>, <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="{\bf x}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">{\bf x}</annotation></semantics></math> is fed to <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="{\mathcal{M}}^{i}" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><msup id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">ℳ</ci><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">{\mathcal{M}}^{i}</annotation></semantics></math> and <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><msup id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">superscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">ℳ</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">{\mathcal{M}}^{F}</annotation></semantics></math> to obtain the layer activations <math id="S3.SS1.p1.14.m14.4" class="ltx_Math" alttext="[{\bf a}_{1}(x;{\bf w}^{i}),\ldots{\bf a}_{M}(x;{\bf w}^{i})]" display="inline"><semantics id="S3.SS1.p1.14.m14.4a"><mrow id="S3.SS1.p1.14.m14.4.4.2" xref="S3.SS1.p1.14.m14.4.4.3.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m14.4.4.2.3" xref="S3.SS1.p1.14.m14.4.4.3.cmml">[</mo><mrow id="S3.SS1.p1.14.m14.3.3.1.1" xref="S3.SS1.p1.14.m14.3.3.1.1.cmml"><msub id="S3.SS1.p1.14.m14.3.3.1.1.3" xref="S3.SS1.p1.14.m14.3.3.1.1.3.cmml"><mi id="S3.SS1.p1.14.m14.3.3.1.1.3.2" xref="S3.SS1.p1.14.m14.3.3.1.1.3.2.cmml">𝐚</mi><mn id="S3.SS1.p1.14.m14.3.3.1.1.3.3" xref="S3.SS1.p1.14.m14.3.3.1.1.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.3.3.1.1.2" xref="S3.SS1.p1.14.m14.3.3.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.14.m14.3.3.1.1.1.1" xref="S3.SS1.p1.14.m14.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m14.3.3.1.1.1.1.2" xref="S3.SS1.p1.14.m14.3.3.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">x</mi><mo id="S3.SS1.p1.14.m14.3.3.1.1.1.1.3" xref="S3.SS1.p1.14.m14.3.3.1.1.1.2.cmml">;</mo><msup id="S3.SS1.p1.14.m14.3.3.1.1.1.1.1" xref="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.2" xref="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.3" xref="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.SS1.p1.14.m14.3.3.1.1.1.1.4" xref="S3.SS1.p1.14.m14.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.14.m14.4.4.2.4" xref="S3.SS1.p1.14.m14.4.4.3.cmml">,</mo><mrow id="S3.SS1.p1.14.m14.4.4.2.2" xref="S3.SS1.p1.14.m14.4.4.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.14.m14.4.4.2.2.3" xref="S3.SS1.p1.14.m14.4.4.2.2.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.4.4.2.2.2" xref="S3.SS1.p1.14.m14.4.4.2.2.2.cmml">​</mo><msub id="S3.SS1.p1.14.m14.4.4.2.2.4" xref="S3.SS1.p1.14.m14.4.4.2.2.4.cmml"><mi id="S3.SS1.p1.14.m14.4.4.2.2.4.2" xref="S3.SS1.p1.14.m14.4.4.2.2.4.2.cmml">𝐚</mi><mi id="S3.SS1.p1.14.m14.4.4.2.2.4.3" xref="S3.SS1.p1.14.m14.4.4.2.2.4.3.cmml">M</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.4.4.2.2.2a" xref="S3.SS1.p1.14.m14.4.4.2.2.2.cmml">​</mo><mrow id="S3.SS1.p1.14.m14.4.4.2.2.1.1" xref="S3.SS1.p1.14.m14.4.4.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m14.4.4.2.2.1.1.2" xref="S3.SS1.p1.14.m14.4.4.2.2.1.2.cmml">(</mo><mi id="S3.SS1.p1.14.m14.2.2" xref="S3.SS1.p1.14.m14.2.2.cmml">x</mi><mo id="S3.SS1.p1.14.m14.4.4.2.2.1.1.3" xref="S3.SS1.p1.14.m14.4.4.2.2.1.2.cmml">;</mo><msup id="S3.SS1.p1.14.m14.4.4.2.2.1.1.1" xref="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.2" xref="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.3" xref="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.SS1.p1.14.m14.4.4.2.2.1.1.4" xref="S3.SS1.p1.14.m14.4.4.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.p1.14.m14.4.4.2.5" xref="S3.SS1.p1.14.m14.4.4.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.4b"><interval closure="closed" id="S3.SS1.p1.14.m14.4.4.3.cmml" xref="S3.SS1.p1.14.m14.4.4.2"><apply id="S3.SS1.p1.14.m14.3.3.1.1.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1"><times id="S3.SS1.p1.14.m14.3.3.1.1.2.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.2"></times><apply id="S3.SS1.p1.14.m14.3.3.1.1.3.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.3.3.1.1.3.1.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.14.m14.3.3.1.1.3.2.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.3.2">𝐚</ci><cn type="integer" id="S3.SS1.p1.14.m14.3.3.1.1.3.3.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.3.3">1</cn></apply><list id="S3.SS1.p1.14.m14.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.1.1"><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">𝑥</ci><apply id="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.2">𝐰</ci><ci id="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.3.3.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S3.SS1.p1.14.m14.4.4.2.2.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2"><times id="S3.SS1.p1.14.m14.4.4.2.2.2.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.2"></times><ci id="S3.SS1.p1.14.m14.4.4.2.2.3.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.3">…</ci><apply id="S3.SS1.p1.14.m14.4.4.2.2.4.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.4.4.2.2.4.1.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.4">subscript</csymbol><ci id="S3.SS1.p1.14.m14.4.4.2.2.4.2.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.4.2">𝐚</ci><ci id="S3.SS1.p1.14.m14.4.4.2.2.4.3.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.4.3">𝑀</ci></apply><list id="S3.SS1.p1.14.m14.4.4.2.2.1.2.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.1.1"><ci id="S3.SS1.p1.14.m14.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2">𝑥</ci><apply id="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.2">𝐰</ci><ci id="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.4.4.2.2.1.1.1.3">𝑖</ci></apply></list></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.4c">[{\bf a}_{1}(x;{\bf w}^{i}),\ldots{\bf a}_{M}(x;{\bf w}^{i})]</annotation></semantics></math> and <math id="S3.SS1.p1.15.m15.7" class="ltx_Math" alttext="[{\bf a}_{1}(x;{\bf w}),\ldots,{\bf a}_{M}(x;{\bf w})]" display="inline"><semantics id="S3.SS1.p1.15.m15.7a"><mrow id="S3.SS1.p1.15.m15.7.7.2" xref="S3.SS1.p1.15.m15.7.7.3.cmml"><mo stretchy="false" id="S3.SS1.p1.15.m15.7.7.2.3" xref="S3.SS1.p1.15.m15.7.7.3.cmml">[</mo><mrow id="S3.SS1.p1.15.m15.6.6.1.1" xref="S3.SS1.p1.15.m15.6.6.1.1.cmml"><msub id="S3.SS1.p1.15.m15.6.6.1.1.2" xref="S3.SS1.p1.15.m15.6.6.1.1.2.cmml"><mi id="S3.SS1.p1.15.m15.6.6.1.1.2.2" xref="S3.SS1.p1.15.m15.6.6.1.1.2.2.cmml">𝐚</mi><mn id="S3.SS1.p1.15.m15.6.6.1.1.2.3" xref="S3.SS1.p1.15.m15.6.6.1.1.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.15.m15.6.6.1.1.1" xref="S3.SS1.p1.15.m15.6.6.1.1.1.cmml">​</mo><mrow id="S3.SS1.p1.15.m15.6.6.1.1.3.2" xref="S3.SS1.p1.15.m15.6.6.1.1.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.15.m15.6.6.1.1.3.2.1" xref="S3.SS1.p1.15.m15.6.6.1.1.3.1.cmml">(</mo><mi id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">x</mi><mo id="S3.SS1.p1.15.m15.6.6.1.1.3.2.2" xref="S3.SS1.p1.15.m15.6.6.1.1.3.1.cmml">;</mo><mi id="S3.SS1.p1.15.m15.2.2" xref="S3.SS1.p1.15.m15.2.2.cmml">𝐰</mi><mo stretchy="false" id="S3.SS1.p1.15.m15.6.6.1.1.3.2.3" xref="S3.SS1.p1.15.m15.6.6.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.15.m15.7.7.2.4" xref="S3.SS1.p1.15.m15.7.7.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.15.m15.5.5" xref="S3.SS1.p1.15.m15.5.5.cmml">…</mi><mo id="S3.SS1.p1.15.m15.7.7.2.5" xref="S3.SS1.p1.15.m15.7.7.3.cmml">,</mo><mrow id="S3.SS1.p1.15.m15.7.7.2.2" xref="S3.SS1.p1.15.m15.7.7.2.2.cmml"><msub id="S3.SS1.p1.15.m15.7.7.2.2.2" xref="S3.SS1.p1.15.m15.7.7.2.2.2.cmml"><mi id="S3.SS1.p1.15.m15.7.7.2.2.2.2" xref="S3.SS1.p1.15.m15.7.7.2.2.2.2.cmml">𝐚</mi><mi id="S3.SS1.p1.15.m15.7.7.2.2.2.3" xref="S3.SS1.p1.15.m15.7.7.2.2.2.3.cmml">M</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.15.m15.7.7.2.2.1" xref="S3.SS1.p1.15.m15.7.7.2.2.1.cmml">​</mo><mrow id="S3.SS1.p1.15.m15.7.7.2.2.3.2" xref="S3.SS1.p1.15.m15.7.7.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.15.m15.7.7.2.2.3.2.1" xref="S3.SS1.p1.15.m15.7.7.2.2.3.1.cmml">(</mo><mi id="S3.SS1.p1.15.m15.3.3" xref="S3.SS1.p1.15.m15.3.3.cmml">x</mi><mo id="S3.SS1.p1.15.m15.7.7.2.2.3.2.2" xref="S3.SS1.p1.15.m15.7.7.2.2.3.1.cmml">;</mo><mi id="S3.SS1.p1.15.m15.4.4" xref="S3.SS1.p1.15.m15.4.4.cmml">𝐰</mi><mo stretchy="false" id="S3.SS1.p1.15.m15.7.7.2.2.3.2.3" xref="S3.SS1.p1.15.m15.7.7.2.2.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.p1.15.m15.7.7.2.6" xref="S3.SS1.p1.15.m15.7.7.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.7b"><list id="S3.SS1.p1.15.m15.7.7.3.cmml" xref="S3.SS1.p1.15.m15.7.7.2"><apply id="S3.SS1.p1.15.m15.6.6.1.1.cmml" xref="S3.SS1.p1.15.m15.6.6.1.1"><times id="S3.SS1.p1.15.m15.6.6.1.1.1.cmml" xref="S3.SS1.p1.15.m15.6.6.1.1.1"></times><apply id="S3.SS1.p1.15.m15.6.6.1.1.2.cmml" xref="S3.SS1.p1.15.m15.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.6.6.1.1.2.1.cmml" xref="S3.SS1.p1.15.m15.6.6.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.15.m15.6.6.1.1.2.2.cmml" xref="S3.SS1.p1.15.m15.6.6.1.1.2.2">𝐚</ci><cn type="integer" id="S3.SS1.p1.15.m15.6.6.1.1.2.3.cmml" xref="S3.SS1.p1.15.m15.6.6.1.1.2.3">1</cn></apply><list id="S3.SS1.p1.15.m15.6.6.1.1.3.1.cmml" xref="S3.SS1.p1.15.m15.6.6.1.1.3.2"><ci id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">𝑥</ci><ci id="S3.SS1.p1.15.m15.2.2.cmml" xref="S3.SS1.p1.15.m15.2.2">𝐰</ci></list></apply><ci id="S3.SS1.p1.15.m15.5.5.cmml" xref="S3.SS1.p1.15.m15.5.5">…</ci><apply id="S3.SS1.p1.15.m15.7.7.2.2.cmml" xref="S3.SS1.p1.15.m15.7.7.2.2"><times id="S3.SS1.p1.15.m15.7.7.2.2.1.cmml" xref="S3.SS1.p1.15.m15.7.7.2.2.1"></times><apply id="S3.SS1.p1.15.m15.7.7.2.2.2.cmml" xref="S3.SS1.p1.15.m15.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.7.7.2.2.2.1.cmml" xref="S3.SS1.p1.15.m15.7.7.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.15.m15.7.7.2.2.2.2.cmml" xref="S3.SS1.p1.15.m15.7.7.2.2.2.2">𝐚</ci><ci id="S3.SS1.p1.15.m15.7.7.2.2.2.3.cmml" xref="S3.SS1.p1.15.m15.7.7.2.2.2.3">𝑀</ci></apply><list id="S3.SS1.p1.15.m15.7.7.2.2.3.1.cmml" xref="S3.SS1.p1.15.m15.7.7.2.2.3.2"><ci id="S3.SS1.p1.15.m15.3.3.cmml" xref="S3.SS1.p1.15.m15.3.3">𝑥</ci><ci id="S3.SS1.p1.15.m15.4.4.cmml" xref="S3.SS1.p1.15.m15.4.4">𝐰</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.7c">[{\bf a}_{1}(x;{\bf w}),\ldots,{\bf a}_{M}(x;{\bf w})]</annotation></semantics></math>, respectively. These are not all the model activations, but only the <math id="S3.SS1.p1.16.m16.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.16.m16.1a"><mi id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">M</annotation></semantics></math> activations we are interested in matching. The activations in the two models are matched by a set of matching layers parameterized by <math id="S3.SS1.p1.17.m17.1" class="ltx_Math" alttext="{\bf\theta}^{i}" display="inline"><semantics id="S3.SS1.p1.17.m17.1a"><msup id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml"><mi id="S3.SS1.p1.17.m17.1.1.2" xref="S3.SS1.p1.17.m17.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.17.m17.1.1.3" xref="S3.SS1.p1.17.m17.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><apply id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m17.1.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">superscript</csymbol><ci id="S3.SS1.p1.17.m17.1.1.2.cmml" xref="S3.SS1.p1.17.m17.1.1.2">𝜃</ci><ci id="S3.SS1.p1.17.m17.1.1.3.cmml" xref="S3.SS1.p1.17.m17.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">{\bf\theta}^{i}</annotation></semantics></math> (<math id="S3.SS1.p1.18.m18.3" class="ltx_Math" alttext="{\bf\theta}^{i}\equiv[{\bf\theta}_{1}^{i},{\bf\theta}_{2}^{i},{\bf\theta}_{3}^{i}]" display="inline"><semantics id="S3.SS1.p1.18.m18.3a"><mrow id="S3.SS1.p1.18.m18.3.3" xref="S3.SS1.p1.18.m18.3.3.cmml"><msup id="S3.SS1.p1.18.m18.3.3.5" xref="S3.SS1.p1.18.m18.3.3.5.cmml"><mi id="S3.SS1.p1.18.m18.3.3.5.2" xref="S3.SS1.p1.18.m18.3.3.5.2.cmml">θ</mi><mi id="S3.SS1.p1.18.m18.3.3.5.3" xref="S3.SS1.p1.18.m18.3.3.5.3.cmml">i</mi></msup><mo id="S3.SS1.p1.18.m18.3.3.4" xref="S3.SS1.p1.18.m18.3.3.4.cmml">≡</mo><mrow id="S3.SS1.p1.18.m18.3.3.3.3" xref="S3.SS1.p1.18.m18.3.3.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.18.m18.3.3.3.3.4" xref="S3.SS1.p1.18.m18.3.3.3.4.cmml">[</mo><msubsup id="S3.SS1.p1.18.m18.1.1.1.1.1" xref="S3.SS1.p1.18.m18.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.18.m18.1.1.1.1.1.2.2" xref="S3.SS1.p1.18.m18.1.1.1.1.1.2.2.cmml">θ</mi><mn id="S3.SS1.p1.18.m18.1.1.1.1.1.2.3" xref="S3.SS1.p1.18.m18.1.1.1.1.1.2.3.cmml">1</mn><mi id="S3.SS1.p1.18.m18.1.1.1.1.1.3" xref="S3.SS1.p1.18.m18.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS1.p1.18.m18.3.3.3.3.5" xref="S3.SS1.p1.18.m18.3.3.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.18.m18.2.2.2.2.2" xref="S3.SS1.p1.18.m18.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.18.m18.2.2.2.2.2.2.2" xref="S3.SS1.p1.18.m18.2.2.2.2.2.2.2.cmml">θ</mi><mn id="S3.SS1.p1.18.m18.2.2.2.2.2.2.3" xref="S3.SS1.p1.18.m18.2.2.2.2.2.2.3.cmml">2</mn><mi id="S3.SS1.p1.18.m18.2.2.2.2.2.3" xref="S3.SS1.p1.18.m18.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS1.p1.18.m18.3.3.3.3.6" xref="S3.SS1.p1.18.m18.3.3.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.18.m18.3.3.3.3.3" xref="S3.SS1.p1.18.m18.3.3.3.3.3.cmml"><mi id="S3.SS1.p1.18.m18.3.3.3.3.3.2.2" xref="S3.SS1.p1.18.m18.3.3.3.3.3.2.2.cmml">θ</mi><mn id="S3.SS1.p1.18.m18.3.3.3.3.3.2.3" xref="S3.SS1.p1.18.m18.3.3.3.3.3.2.3.cmml">3</mn><mi id="S3.SS1.p1.18.m18.3.3.3.3.3.3" xref="S3.SS1.p1.18.m18.3.3.3.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.18.m18.3.3.3.3.7" xref="S3.SS1.p1.18.m18.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.3b"><apply id="S3.SS1.p1.18.m18.3.3.cmml" xref="S3.SS1.p1.18.m18.3.3"><equivalent id="S3.SS1.p1.18.m18.3.3.4.cmml" xref="S3.SS1.p1.18.m18.3.3.4"></equivalent><apply id="S3.SS1.p1.18.m18.3.3.5.cmml" xref="S3.SS1.p1.18.m18.3.3.5"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.3.3.5.1.cmml" xref="S3.SS1.p1.18.m18.3.3.5">superscript</csymbol><ci id="S3.SS1.p1.18.m18.3.3.5.2.cmml" xref="S3.SS1.p1.18.m18.3.3.5.2">𝜃</ci><ci id="S3.SS1.p1.18.m18.3.3.5.3.cmml" xref="S3.SS1.p1.18.m18.3.3.5.3">𝑖</ci></apply><list id="S3.SS1.p1.18.m18.3.3.3.4.cmml" xref="S3.SS1.p1.18.m18.3.3.3.3"><apply id="S3.SS1.p1.18.m18.1.1.1.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.18.m18.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m18.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1.1.2.2">𝜃</ci><cn type="integer" id="S3.SS1.p1.18.m18.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.p1.18.m18.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.18.m18.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.18.m18.2.2.2.2.2.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.18.m18.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.18.m18.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2.2.2.2">𝜃</ci><cn type="integer" id="S3.SS1.p1.18.m18.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.18.m18.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.18.m18.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.18.m18.3.3.3.3.3.cmml" xref="S3.SS1.p1.18.m18.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.3.3.3.3.3.1.cmml" xref="S3.SS1.p1.18.m18.3.3.3.3.3">superscript</csymbol><apply id="S3.SS1.p1.18.m18.3.3.3.3.3.2.cmml" xref="S3.SS1.p1.18.m18.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.3.3.3.3.3.2.1.cmml" xref="S3.SS1.p1.18.m18.3.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.18.m18.3.3.3.3.3.2.2.cmml" xref="S3.SS1.p1.18.m18.3.3.3.3.3.2.2">𝜃</ci><cn type="integer" id="S3.SS1.p1.18.m18.3.3.3.3.3.2.3.cmml" xref="S3.SS1.p1.18.m18.3.3.3.3.3.2.3">3</cn></apply><ci id="S3.SS1.p1.18.m18.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.18.m18.3.3.3.3.3.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.3c">{\bf\theta}^{i}\equiv[{\bf\theta}_{1}^{i},{\bf\theta}_{2}^{i},{\bf\theta}_{3}^{i}]</annotation></semantics></math> in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.1 Representation Matching ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). Instead of deriving the activations of one layer in <math id="S3.SS1.p1.19.m19.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.SS1.p1.19.m19.1a"><msup id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.19.m19.1.1.2" xref="S3.SS1.p1.19.m19.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.19.m19.1.1.3" xref="S3.SS1.p1.19.m19.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.1b"><apply id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.1.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">superscript</csymbol><ci id="S3.SS1.p1.19.m19.1.1.2.cmml" xref="S3.SS1.p1.19.m19.1.1.2">ℳ</ci><ci id="S3.SS1.p1.19.m19.1.1.3.cmml" xref="S3.SS1.p1.19.m19.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.1c">{\mathcal{M}}^{F}</annotation></semantics></math> from the activations of the corresponding layer in <math id="S3.SS1.p1.20.m20.1" class="ltx_Math" alttext="{\mathcal{M}}^{i}" display="inline"><semantics id="S3.SS1.p1.20.m20.1a"><msup id="S3.SS1.p1.20.m20.1.1" xref="S3.SS1.p1.20.m20.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.20.m20.1.1.2" xref="S3.SS1.p1.20.m20.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.20.m20.1.1.3" xref="S3.SS1.p1.20.m20.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m20.1b"><apply id="S3.SS1.p1.20.m20.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.1.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1">superscript</csymbol><ci id="S3.SS1.p1.20.m20.1.1.2.cmml" xref="S3.SS1.p1.20.m20.1.1.2">ℳ</ci><ci id="S3.SS1.p1.20.m20.1.1.3.cmml" xref="S3.SS1.p1.20.m20.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m20.1c">{\mathcal{M}}^{i}</annotation></semantics></math>, we found performance significantly improves if the activations of one layer are instead derived from the activations of the next layer of interest above it. As shown in the representative example in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.1 Representation Matching ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the activations/layers of interest are the input layer, the point-wise non-linearity layers and the top layer. We use convolutional matching layers if the input has spatial information (such as within a convolutional stack), and fully-connected matching layers otherwise. To reverse a pooling operation, we follow the scheme in  <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite> and unpool pooled activations using the pooling positions used during the pooling operation as shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.1 Representation Matching ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.2" class="ltx_p">Given a training point and label <math id="S3.SS1.p2.1.m1.2" class="ltx_Math" alttext="({\bf x},y)\sim{\bf D}_{i}" display="inline"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.3" xref="S3.SS1.p2.1.m1.2.3.cmml"><mrow id="S3.SS1.p2.1.m1.2.3.2.2" xref="S3.SS1.p2.1.m1.2.3.2.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.2.3.2.2.1" xref="S3.SS1.p2.1.m1.2.3.2.1.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝐱</mi><mo id="S3.SS1.p2.1.m1.2.3.2.2.2" xref="S3.SS1.p2.1.m1.2.3.2.1.cmml">,</mo><mi id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.2.3.2.2.3" xref="S3.SS1.p2.1.m1.2.3.2.1.cmml">)</mo></mrow><mo id="S3.SS1.p2.1.m1.2.3.1" xref="S3.SS1.p2.1.m1.2.3.1.cmml">∼</mo><msub id="S3.SS1.p2.1.m1.2.3.3" xref="S3.SS1.p2.1.m1.2.3.3.cmml"><mi id="S3.SS1.p2.1.m1.2.3.3.2" xref="S3.SS1.p2.1.m1.2.3.3.2.cmml">𝐃</mi><mi id="S3.SS1.p2.1.m1.2.3.3.3" xref="S3.SS1.p2.1.m1.2.3.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><apply id="S3.SS1.p2.1.m1.2.3.cmml" xref="S3.SS1.p2.1.m1.2.3"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.2.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.1">similar-to</csymbol><interval closure="open" id="S3.SS1.p2.1.m1.2.3.2.1.cmml" xref="S3.SS1.p2.1.m1.2.3.2.2"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐱</ci><ci id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2">𝑦</ci></interval><apply id="S3.SS1.p2.1.m1.2.3.3.cmml" xref="S3.SS1.p2.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.3.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.3.3.2.cmml" xref="S3.SS1.p2.1.m1.2.3.3.2">𝐃</ci><ci id="S3.SS1.p2.1.m1.2.3.3.3.cmml" xref="S3.SS1.p2.1.m1.2.3.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">({\bf x},y)\sim{\bf D}_{i}</annotation></semantics></math>, we define the matching loss at client <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">i</annotation></semantics></math> as:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.8" class="ltx_Math" alttext="{\mathcal{L}}_{M}^{i}({\bf x};{\bf w}^{i},{\bf w},{\bf\theta}^{i})=\sum\limits_{j=1}^{j=M-1}||f_{j}({\bf a}_{j+1}(x;{\bf w}^{i});{\bf\theta}_{j}^{i})-{\bf a}_{j}(x;{\bf w})||_{2}^{2}" display="block"><semantics id="S3.E1.m1.8a"><mrow id="S3.E1.m1.8.8" xref="S3.E1.m1.8.8.cmml"><mrow id="S3.E1.m1.7.7.2" xref="S3.E1.m1.7.7.2.cmml"><msubsup id="S3.E1.m1.7.7.2.4" xref="S3.E1.m1.7.7.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.2.4.2.2" xref="S3.E1.m1.7.7.2.4.2.2.cmml">ℒ</mi><mi id="S3.E1.m1.7.7.2.4.2.3" xref="S3.E1.m1.7.7.2.4.2.3.cmml">M</mi><mi id="S3.E1.m1.7.7.2.4.3" xref="S3.E1.m1.7.7.2.4.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.2.3" xref="S3.E1.m1.7.7.2.3.cmml">​</mo><mrow id="S3.E1.m1.7.7.2.2.2" xref="S3.E1.m1.7.7.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.2.2.2.3" xref="S3.E1.m1.7.7.2.2.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝐱</mi><mo id="S3.E1.m1.7.7.2.2.2.4" xref="S3.E1.m1.7.7.2.2.3.cmml">;</mo><msup id="S3.E1.m1.6.6.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E1.m1.6.6.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.E1.m1.7.7.2.2.2.5" xref="S3.E1.m1.7.7.2.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝐰</mi><mo id="S3.E1.m1.7.7.2.2.2.6" xref="S3.E1.m1.7.7.2.2.3.cmml">,</mo><msup id="S3.E1.m1.7.7.2.2.2.2" xref="S3.E1.m1.7.7.2.2.2.2.cmml"><mi id="S3.E1.m1.7.7.2.2.2.2.2" xref="S3.E1.m1.7.7.2.2.2.2.2.cmml">θ</mi><mi id="S3.E1.m1.7.7.2.2.2.2.3" xref="S3.E1.m1.7.7.2.2.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E1.m1.7.7.2.2.2.7" xref="S3.E1.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.8.8.4" xref="S3.E1.m1.8.8.4.cmml">=</mo><mrow id="S3.E1.m1.8.8.3" xref="S3.E1.m1.8.8.3.cmml"><munderover id="S3.E1.m1.8.8.3.2" xref="S3.E1.m1.8.8.3.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E1.m1.8.8.3.2.2.2" xref="S3.E1.m1.8.8.3.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.8.8.3.2.2.3" xref="S3.E1.m1.8.8.3.2.2.3.cmml"><mi id="S3.E1.m1.8.8.3.2.2.3.2" xref="S3.E1.m1.8.8.3.2.2.3.2.cmml">j</mi><mo id="S3.E1.m1.8.8.3.2.2.3.1" xref="S3.E1.m1.8.8.3.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.8.8.3.2.2.3.3" xref="S3.E1.m1.8.8.3.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.8.8.3.2.3" xref="S3.E1.m1.8.8.3.2.3.cmml"><mi id="S3.E1.m1.8.8.3.2.3.2" xref="S3.E1.m1.8.8.3.2.3.2.cmml">j</mi><mo id="S3.E1.m1.8.8.3.2.3.1" xref="S3.E1.m1.8.8.3.2.3.1.cmml">=</mo><mrow id="S3.E1.m1.8.8.3.2.3.3" xref="S3.E1.m1.8.8.3.2.3.3.cmml"><mi id="S3.E1.m1.8.8.3.2.3.3.2" xref="S3.E1.m1.8.8.3.2.3.3.2.cmml">M</mi><mo id="S3.E1.m1.8.8.3.2.3.3.1" xref="S3.E1.m1.8.8.3.2.3.3.1.cmml">−</mo><mn id="S3.E1.m1.8.8.3.2.3.3.3" xref="S3.E1.m1.8.8.3.2.3.3.3.cmml">1</mn></mrow></mrow></munderover><msubsup id="S3.E1.m1.8.8.3.1" xref="S3.E1.m1.8.8.3.1.cmml"><mrow id="S3.E1.m1.8.8.3.1.1.1.1" xref="S3.E1.m1.8.8.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.3.1.1.1.1.2" xref="S3.E1.m1.8.8.3.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.8.8.3.1.1.1.1.1" xref="S3.E1.m1.8.8.3.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.8.8.3.1.1.1.1.1.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.8.8.3.1.1.1.1.1.2.4" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.cmml"><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.2.cmml">f</mi><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.3.1.1.1.1.1.2.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐚</mi><mrow id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">j</mi><mo id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">x</mi><mo id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msup id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.4" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.3.cmml">;</mo><msubsup id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.3.cmml">j</mi><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.5" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.8.8.3.1.1.1.1.1.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E1.m1.8.8.3.1.1.1.1.1.4" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.cmml"><msub id="S3.E1.m1.8.8.3.1.1.1.1.1.4.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.cmml"><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.2.cmml">𝐚</mi><mi id="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.3.1.1.1.1.1.4.1" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.1.cmml">​</mo><mrow id="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.2.1" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.1.cmml">(</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">x</mi><mo id="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.2.2" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.1.cmml">;</mo><mi id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">𝐰</mi><mo stretchy="false" id="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.2.3" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E1.m1.8.8.3.1.1.1.1.3" xref="S3.E1.m1.8.8.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.8.8.3.1.1.3" xref="S3.E1.m1.8.8.3.1.1.3.cmml">2</mn><mn id="S3.E1.m1.8.8.3.1.3" xref="S3.E1.m1.8.8.3.1.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.8b"><apply id="S3.E1.m1.8.8.cmml" xref="S3.E1.m1.8.8"><eq id="S3.E1.m1.8.8.4.cmml" xref="S3.E1.m1.8.8.4"></eq><apply id="S3.E1.m1.7.7.2.cmml" xref="S3.E1.m1.7.7.2"><times id="S3.E1.m1.7.7.2.3.cmml" xref="S3.E1.m1.7.7.2.3"></times><apply id="S3.E1.m1.7.7.2.4.cmml" xref="S3.E1.m1.7.7.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.2.4.1.cmml" xref="S3.E1.m1.7.7.2.4">superscript</csymbol><apply id="S3.E1.m1.7.7.2.4.2.cmml" xref="S3.E1.m1.7.7.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.2.4.2.1.cmml" xref="S3.E1.m1.7.7.2.4">subscript</csymbol><ci id="S3.E1.m1.7.7.2.4.2.2.cmml" xref="S3.E1.m1.7.7.2.4.2.2">ℒ</ci><ci id="S3.E1.m1.7.7.2.4.2.3.cmml" xref="S3.E1.m1.7.7.2.4.2.3">𝑀</ci></apply><ci id="S3.E1.m1.7.7.2.4.3.cmml" xref="S3.E1.m1.7.7.2.4.3">𝑖</ci></apply><list id="S3.E1.m1.7.7.2.2.3.cmml" xref="S3.E1.m1.7.7.2.2.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐱</ci><apply id="S3.E1.m1.6.6.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.6.6.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.2">𝐰</ci><ci id="S3.E1.m1.6.6.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐰</ci><apply id="S3.E1.m1.7.7.2.2.2.2.cmml" xref="S3.E1.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.2.2.2.2.1.cmml" xref="S3.E1.m1.7.7.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.7.7.2.2.2.2.2.cmml" xref="S3.E1.m1.7.7.2.2.2.2.2">𝜃</ci><ci id="S3.E1.m1.7.7.2.2.2.2.3.cmml" xref="S3.E1.m1.7.7.2.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S3.E1.m1.8.8.3.cmml" xref="S3.E1.m1.8.8.3"><apply id="S3.E1.m1.8.8.3.2.cmml" xref="S3.E1.m1.8.8.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.2.1.cmml" xref="S3.E1.m1.8.8.3.2">superscript</csymbol><apply id="S3.E1.m1.8.8.3.2.2.cmml" xref="S3.E1.m1.8.8.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.2.2.1.cmml" xref="S3.E1.m1.8.8.3.2">subscript</csymbol><sum id="S3.E1.m1.8.8.3.2.2.2.cmml" xref="S3.E1.m1.8.8.3.2.2.2"></sum><apply id="S3.E1.m1.8.8.3.2.2.3.cmml" xref="S3.E1.m1.8.8.3.2.2.3"><eq id="S3.E1.m1.8.8.3.2.2.3.1.cmml" xref="S3.E1.m1.8.8.3.2.2.3.1"></eq><ci id="S3.E1.m1.8.8.3.2.2.3.2.cmml" xref="S3.E1.m1.8.8.3.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E1.m1.8.8.3.2.2.3.3.cmml" xref="S3.E1.m1.8.8.3.2.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.8.8.3.2.3.cmml" xref="S3.E1.m1.8.8.3.2.3"><eq id="S3.E1.m1.8.8.3.2.3.1.cmml" xref="S3.E1.m1.8.8.3.2.3.1"></eq><ci id="S3.E1.m1.8.8.3.2.3.2.cmml" xref="S3.E1.m1.8.8.3.2.3.2">𝑗</ci><apply id="S3.E1.m1.8.8.3.2.3.3.cmml" xref="S3.E1.m1.8.8.3.2.3.3"><minus id="S3.E1.m1.8.8.3.2.3.3.1.cmml" xref="S3.E1.m1.8.8.3.2.3.3.1"></minus><ci id="S3.E1.m1.8.8.3.2.3.3.2.cmml" xref="S3.E1.m1.8.8.3.2.3.3.2">𝑀</ci><cn type="integer" id="S3.E1.m1.8.8.3.2.3.3.3.cmml" xref="S3.E1.m1.8.8.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E1.m1.8.8.3.1.cmml" xref="S3.E1.m1.8.8.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.1.2.cmml" xref="S3.E1.m1.8.8.3.1">superscript</csymbol><apply id="S3.E1.m1.8.8.3.1.1.cmml" xref="S3.E1.m1.8.8.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.1.1.2.cmml" xref="S3.E1.m1.8.8.3.1">subscript</csymbol><apply id="S3.E1.m1.8.8.3.1.1.1.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.8.8.3.1.1.1.2.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1"><minus id="S3.E1.m1.8.8.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.3"></minus><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2"><times id="S3.E1.m1.8.8.3.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.3"></times><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.2">𝑓</ci><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.4.3">𝑗</ci></apply><list id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2"><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.2">𝐚</ci><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3"><plus id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.2">𝑗</ci><cn type="integer" id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><list id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑥</ci><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.2">𝜃</ci><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.2.3">𝑗</ci></apply><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.4.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4"><times id="S3.E1.m1.8.8.3.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.1"></times><apply id="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.2.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.2">𝐚</ci><ci id="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.3.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.2.3">𝑗</ci></apply><list id="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.1.cmml" xref="S3.E1.m1.8.8.3.1.1.1.1.1.4.3.2"><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑥</ci><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">𝐰</ci></list></apply></apply></apply><cn type="integer" id="S3.E1.m1.8.8.3.1.1.3.cmml" xref="S3.E1.m1.8.8.3.1.1.3">2</cn></apply><cn type="integer" id="S3.E1.m1.8.8.3.1.3.cmml" xref="S3.E1.m1.8.8.3.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.8c">{\mathcal{L}}_{M}^{i}({\bf x};{\bf w}^{i},{\bf w},{\bf\theta}^{i})=\sum\limits_{j=1}^{j=M-1}||f_{j}({\bf a}_{j+1}(x;{\bf w}^{i});{\bf\theta}_{j}^{i})-{\bf a}_{j}(x;{\bf w})||_{2}^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.5" class="ltx_p">where <math id="S3.SS1.p2.3.m1.1" class="ltx_Math" alttext="f_{j}" display="inline"><semantics id="S3.SS1.p2.3.m1.1a"><msub id="S3.SS1.p2.3.m1.1.1" xref="S3.SS1.p2.3.m1.1.1.cmml"><mi id="S3.SS1.p2.3.m1.1.1.2" xref="S3.SS1.p2.3.m1.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.3.m1.1.1.3" xref="S3.SS1.p2.3.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m1.1b"><apply id="S3.SS1.p2.3.m1.1.1.cmml" xref="S3.SS1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m1.1.1.1.cmml" xref="S3.SS1.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m1.1.1.2.cmml" xref="S3.SS1.p2.3.m1.1.1.2">𝑓</ci><ci id="S3.SS1.p2.3.m1.1.1.3.cmml" xref="S3.SS1.p2.3.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m1.1c">f_{j}</annotation></semantics></math> denotes the <math id="S3.SS1.p2.4.m2.1" class="ltx_Math" alttext="j^{th}" display="inline"><semantics id="S3.SS1.p2.4.m2.1a"><msup id="S3.SS1.p2.4.m2.1.1" xref="S3.SS1.p2.4.m2.1.1.cmml"><mi id="S3.SS1.p2.4.m2.1.1.2" xref="S3.SS1.p2.4.m2.1.1.2.cmml">j</mi><mrow id="S3.SS1.p2.4.m2.1.1.3" xref="S3.SS1.p2.4.m2.1.1.3.cmml"><mi id="S3.SS1.p2.4.m2.1.1.3.2" xref="S3.SS1.p2.4.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m2.1.1.3.1" xref="S3.SS1.p2.4.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.4.m2.1.1.3.3" xref="S3.SS1.p2.4.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m2.1b"><apply id="S3.SS1.p2.4.m2.1.1.cmml" xref="S3.SS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m2.1.1.1.cmml" xref="S3.SS1.p2.4.m2.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m2.1.1.2.cmml" xref="S3.SS1.p2.4.m2.1.1.2">𝑗</ci><apply id="S3.SS1.p2.4.m2.1.1.3.cmml" xref="S3.SS1.p2.4.m2.1.1.3"><times id="S3.SS1.p2.4.m2.1.1.3.1.cmml" xref="S3.SS1.p2.4.m2.1.1.3.1"></times><ci id="S3.SS1.p2.4.m2.1.1.3.2.cmml" xref="S3.SS1.p2.4.m2.1.1.3.2">𝑡</ci><ci id="S3.SS1.p2.4.m2.1.1.3.3.cmml" xref="S3.SS1.p2.4.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m2.1c">j^{th}</annotation></semantics></math> matching layer. The per-point training loss at client <math id="S3.SS1.p2.5.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.5.m3.1a"><mi id="S3.SS1.p2.5.m3.1.1" xref="S3.SS1.p2.5.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m3.1b"><ci id="S3.SS1.p2.5.m3.1.1.cmml" xref="S3.SS1.p2.5.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m3.1c">i</annotation></semantics></math> is:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.12" class="ltx_Math" alttext="{\mathcal{L}}^{i}({\bf x},y;{\bf w}^{i},{\bf w},{\bf\theta}^{i})={\mathcal{L}}_{C}({\bf a}_{M}({\bf x};{\bf w}^{i});y)+{\mathcal{L}}_{M}^{i}({\bf x};{\bf w}^{i},{\bf w},{\bf\theta}^{i})" display="block"><semantics id="S3.E2.m1.12a"><mrow id="S3.E2.m1.12.12" xref="S3.E2.m1.12.12.cmml"><mrow id="S3.E2.m1.9.9.2" xref="S3.E2.m1.9.9.2.cmml"><msup id="S3.E2.m1.9.9.2.4" xref="S3.E2.m1.9.9.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.9.9.2.4.2" xref="S3.E2.m1.9.9.2.4.2.cmml">ℒ</mi><mi id="S3.E2.m1.9.9.2.4.3" xref="S3.E2.m1.9.9.2.4.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="S3.E2.m1.9.9.2.3" xref="S3.E2.m1.9.9.2.3.cmml">​</mo><mrow id="S3.E2.m1.9.9.2.2.2" xref="S3.E2.m1.9.9.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.9.9.2.2.2.3" xref="S3.E2.m1.9.9.2.2.3.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝐱</mi><mo id="S3.E2.m1.9.9.2.2.2.4" xref="S3.E2.m1.9.9.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">y</mi><mo id="S3.E2.m1.9.9.2.2.2.5" xref="S3.E2.m1.9.9.2.2.3.cmml">;</mo><msup id="S3.E2.m1.8.8.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E2.m1.8.8.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.E2.m1.9.9.2.2.2.6" xref="S3.E2.m1.9.9.2.2.3.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝐰</mi><mo id="S3.E2.m1.9.9.2.2.2.7" xref="S3.E2.m1.9.9.2.2.3.cmml">,</mo><msup id="S3.E2.m1.9.9.2.2.2.2" xref="S3.E2.m1.9.9.2.2.2.2.cmml"><mi id="S3.E2.m1.9.9.2.2.2.2.2" xref="S3.E2.m1.9.9.2.2.2.2.2.cmml">θ</mi><mi id="S3.E2.m1.9.9.2.2.2.2.3" xref="S3.E2.m1.9.9.2.2.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E2.m1.9.9.2.2.2.8" xref="S3.E2.m1.9.9.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.12.12.6" xref="S3.E2.m1.12.12.6.cmml">=</mo><mrow id="S3.E2.m1.12.12.5" xref="S3.E2.m1.12.12.5.cmml"><mrow id="S3.E2.m1.10.10.3.1" xref="S3.E2.m1.10.10.3.1.cmml"><msub id="S3.E2.m1.10.10.3.1.3" xref="S3.E2.m1.10.10.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.10.10.3.1.3.2" xref="S3.E2.m1.10.10.3.1.3.2.cmml">ℒ</mi><mi id="S3.E2.m1.10.10.3.1.3.3" xref="S3.E2.m1.10.10.3.1.3.3.cmml">C</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.10.10.3.1.2" xref="S3.E2.m1.10.10.3.1.2.cmml">​</mo><mrow id="S3.E2.m1.10.10.3.1.1.1" xref="S3.E2.m1.10.10.3.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.3.1.1.1.2" xref="S3.E2.m1.10.10.3.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.10.10.3.1.1.1.1" xref="S3.E2.m1.10.10.3.1.1.1.1.cmml"><msub id="S3.E2.m1.10.10.3.1.1.1.1.3" xref="S3.E2.m1.10.10.3.1.1.1.1.3.cmml"><mi id="S3.E2.m1.10.10.3.1.1.1.1.3.2" xref="S3.E2.m1.10.10.3.1.1.1.1.3.2.cmml">𝐚</mi><mi id="S3.E2.m1.10.10.3.1.1.1.1.3.3" xref="S3.E2.m1.10.10.3.1.1.1.1.3.3.cmml">M</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.10.10.3.1.1.1.1.2" xref="S3.E2.m1.10.10.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.10.10.3.1.1.1.1.1.1" xref="S3.E2.m1.10.10.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.3.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.3.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">𝐱</mi><mo id="S3.E2.m1.10.10.3.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.3.1.1.1.1.1.2.cmml">;</mo><msup id="S3.E2.m1.10.10.3.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E2.m1.10.10.3.1.1.1.1.1.1.4" xref="S3.E2.m1.10.10.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.3.1.1.1.3" xref="S3.E2.m1.10.10.3.1.1.2.cmml">;</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">y</mi><mo stretchy="false" id="S3.E2.m1.10.10.3.1.1.1.4" xref="S3.E2.m1.10.10.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.12.12.5.4" xref="S3.E2.m1.12.12.5.4.cmml">+</mo><mrow id="S3.E2.m1.12.12.5.3" xref="S3.E2.m1.12.12.5.3.cmml"><msubsup id="S3.E2.m1.12.12.5.3.4" xref="S3.E2.m1.12.12.5.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.12.12.5.3.4.2.2" xref="S3.E2.m1.12.12.5.3.4.2.2.cmml">ℒ</mi><mi id="S3.E2.m1.12.12.5.3.4.2.3" xref="S3.E2.m1.12.12.5.3.4.2.3.cmml">M</mi><mi id="S3.E2.m1.12.12.5.3.4.3" xref="S3.E2.m1.12.12.5.3.4.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.12.12.5.3.3" xref="S3.E2.m1.12.12.5.3.3.cmml">​</mo><mrow id="S3.E2.m1.12.12.5.3.2.2" xref="S3.E2.m1.12.12.5.3.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.12.12.5.3.2.2.3" xref="S3.E2.m1.12.12.5.3.2.3.cmml">(</mo><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">𝐱</mi><mo id="S3.E2.m1.12.12.5.3.2.2.4" xref="S3.E2.m1.12.12.5.3.2.3.cmml">;</mo><msup id="S3.E2.m1.11.11.4.2.1.1.1" xref="S3.E2.m1.11.11.4.2.1.1.1.cmml"><mi id="S3.E2.m1.11.11.4.2.1.1.1.2" xref="S3.E2.m1.11.11.4.2.1.1.1.2.cmml">𝐰</mi><mi id="S3.E2.m1.11.11.4.2.1.1.1.3" xref="S3.E2.m1.11.11.4.2.1.1.1.3.cmml">i</mi></msup><mo id="S3.E2.m1.12.12.5.3.2.2.5" xref="S3.E2.m1.12.12.5.3.2.3.cmml">,</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">𝐰</mi><mo id="S3.E2.m1.12.12.5.3.2.2.6" xref="S3.E2.m1.12.12.5.3.2.3.cmml">,</mo><msup id="S3.E2.m1.12.12.5.3.2.2.2" xref="S3.E2.m1.12.12.5.3.2.2.2.cmml"><mi id="S3.E2.m1.12.12.5.3.2.2.2.2" xref="S3.E2.m1.12.12.5.3.2.2.2.2.cmml">θ</mi><mi id="S3.E2.m1.12.12.5.3.2.2.2.3" xref="S3.E2.m1.12.12.5.3.2.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E2.m1.12.12.5.3.2.2.7" xref="S3.E2.m1.12.12.5.3.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.12b"><apply id="S3.E2.m1.12.12.cmml" xref="S3.E2.m1.12.12"><eq id="S3.E2.m1.12.12.6.cmml" xref="S3.E2.m1.12.12.6"></eq><apply id="S3.E2.m1.9.9.2.cmml" xref="S3.E2.m1.9.9.2"><times id="S3.E2.m1.9.9.2.3.cmml" xref="S3.E2.m1.9.9.2.3"></times><apply id="S3.E2.m1.9.9.2.4.cmml" xref="S3.E2.m1.9.9.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.9.9.2.4.1.cmml" xref="S3.E2.m1.9.9.2.4">superscript</csymbol><ci id="S3.E2.m1.9.9.2.4.2.cmml" xref="S3.E2.m1.9.9.2.4.2">ℒ</ci><ci id="S3.E2.m1.9.9.2.4.3.cmml" xref="S3.E2.m1.9.9.2.4.3">𝑖</ci></apply><vector id="S3.E2.m1.9.9.2.2.3.cmml" xref="S3.E2.m1.9.9.2.2.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐱</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑦</ci><apply id="S3.E2.m1.8.8.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2">𝐰</ci><ci id="S3.E2.m1.8.8.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝐰</ci><apply id="S3.E2.m1.9.9.2.2.2.2.cmml" xref="S3.E2.m1.9.9.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.9.9.2.2.2.2.1.cmml" xref="S3.E2.m1.9.9.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.9.9.2.2.2.2.2.cmml" xref="S3.E2.m1.9.9.2.2.2.2.2">𝜃</ci><ci id="S3.E2.m1.9.9.2.2.2.2.3.cmml" xref="S3.E2.m1.9.9.2.2.2.2.3">𝑖</ci></apply></vector></apply><apply id="S3.E2.m1.12.12.5.cmml" xref="S3.E2.m1.12.12.5"><plus id="S3.E2.m1.12.12.5.4.cmml" xref="S3.E2.m1.12.12.5.4"></plus><apply id="S3.E2.m1.10.10.3.1.cmml" xref="S3.E2.m1.10.10.3.1"><times id="S3.E2.m1.10.10.3.1.2.cmml" xref="S3.E2.m1.10.10.3.1.2"></times><apply id="S3.E2.m1.10.10.3.1.3.cmml" xref="S3.E2.m1.10.10.3.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.3.1.3.1.cmml" xref="S3.E2.m1.10.10.3.1.3">subscript</csymbol><ci id="S3.E2.m1.10.10.3.1.3.2.cmml" xref="S3.E2.m1.10.10.3.1.3.2">ℒ</ci><ci id="S3.E2.m1.10.10.3.1.3.3.cmml" xref="S3.E2.m1.10.10.3.1.3.3">𝐶</ci></apply><list id="S3.E2.m1.10.10.3.1.1.2.cmml" xref="S3.E2.m1.10.10.3.1.1.1"><apply id="S3.E2.m1.10.10.3.1.1.1.1.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1"><times id="S3.E2.m1.10.10.3.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.2"></times><apply id="S3.E2.m1.10.10.3.1.1.1.1.3.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.3.1.1.1.1.3.1.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.10.10.3.1.1.1.1.3.2.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.3.2">𝐚</ci><ci id="S3.E2.m1.10.10.3.1.1.1.1.3.3.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.3.3">𝑀</ci></apply><list id="S3.E2.m1.10.10.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.1.1"><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝐱</ci><apply id="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.10.10.3.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝑦</ci></list></apply><apply id="S3.E2.m1.12.12.5.3.cmml" xref="S3.E2.m1.12.12.5.3"><times id="S3.E2.m1.12.12.5.3.3.cmml" xref="S3.E2.m1.12.12.5.3.3"></times><apply id="S3.E2.m1.12.12.5.3.4.cmml" xref="S3.E2.m1.12.12.5.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.5.3.4.1.cmml" xref="S3.E2.m1.12.12.5.3.4">superscript</csymbol><apply id="S3.E2.m1.12.12.5.3.4.2.cmml" xref="S3.E2.m1.12.12.5.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.5.3.4.2.1.cmml" xref="S3.E2.m1.12.12.5.3.4">subscript</csymbol><ci id="S3.E2.m1.12.12.5.3.4.2.2.cmml" xref="S3.E2.m1.12.12.5.3.4.2.2">ℒ</ci><ci id="S3.E2.m1.12.12.5.3.4.2.3.cmml" xref="S3.E2.m1.12.12.5.3.4.2.3">𝑀</ci></apply><ci id="S3.E2.m1.12.12.5.3.4.3.cmml" xref="S3.E2.m1.12.12.5.3.4.3">𝑖</ci></apply><list id="S3.E2.m1.12.12.5.3.2.3.cmml" xref="S3.E2.m1.12.12.5.3.2.2"><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">𝐱</ci><apply id="S3.E2.m1.11.11.4.2.1.1.1.cmml" xref="S3.E2.m1.11.11.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.11.11.4.2.1.1.1.1.cmml" xref="S3.E2.m1.11.11.4.2.1.1.1">superscript</csymbol><ci id="S3.E2.m1.11.11.4.2.1.1.1.2.cmml" xref="S3.E2.m1.11.11.4.2.1.1.1.2">𝐰</ci><ci id="S3.E2.m1.11.11.4.2.1.1.1.3.cmml" xref="S3.E2.m1.11.11.4.2.1.1.1.3">𝑖</ci></apply><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝐰</ci><apply id="S3.E2.m1.12.12.5.3.2.2.2.cmml" xref="S3.E2.m1.12.12.5.3.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.5.3.2.2.2.1.cmml" xref="S3.E2.m1.12.12.5.3.2.2.2">superscript</csymbol><ci id="S3.E2.m1.12.12.5.3.2.2.2.2.cmml" xref="S3.E2.m1.12.12.5.3.2.2.2.2">𝜃</ci><ci id="S3.E2.m1.12.12.5.3.2.2.2.3.cmml" xref="S3.E2.m1.12.12.5.3.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.12c">{\mathcal{L}}^{i}({\bf x},y;{\bf w}^{i},{\bf w},{\bf\theta}^{i})={\mathcal{L}}_{C}({\bf a}_{M}({\bf x};{\bf w}^{i});y)+{\mathcal{L}}_{M}^{i}({\bf x};{\bf w}^{i},{\bf w},{\bf\theta}^{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.7" class="ltx_p">where <math id="S3.SS1.p2.6.m1.1" class="ltx_Math" alttext="{\mathcal{L}}_{C}" display="inline"><semantics id="S3.SS1.p2.6.m1.1a"><msub id="S3.SS1.p2.6.m1.1.1" xref="S3.SS1.p2.6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m1.1.1.2" xref="S3.SS1.p2.6.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS1.p2.6.m1.1.1.3" xref="S3.SS1.p2.6.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m1.1b"><apply id="S3.SS1.p2.6.m1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m1.1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m1.1.1.2.cmml" xref="S3.SS1.p2.6.m1.1.1.2">ℒ</ci><ci id="S3.SS1.p2.6.m1.1.1.3.cmml" xref="S3.SS1.p2.6.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m1.1c">{\mathcal{L}}_{C}</annotation></semantics></math> is the cross-entropy loss and <math id="S3.SS1.p2.7.m2.2" class="ltx_Math" alttext="{\bf a}_{M}({\bf x};{\bf w}^{i})" display="inline"><semantics id="S3.SS1.p2.7.m2.2a"><mrow id="S3.SS1.p2.7.m2.2.2" xref="S3.SS1.p2.7.m2.2.2.cmml"><msub id="S3.SS1.p2.7.m2.2.2.3" xref="S3.SS1.p2.7.m2.2.2.3.cmml"><mi id="S3.SS1.p2.7.m2.2.2.3.2" xref="S3.SS1.p2.7.m2.2.2.3.2.cmml">𝐚</mi><mi id="S3.SS1.p2.7.m2.2.2.3.3" xref="S3.SS1.p2.7.m2.2.2.3.3.cmml">M</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m2.2.2.2" xref="S3.SS1.p2.7.m2.2.2.2.cmml">​</mo><mrow id="S3.SS1.p2.7.m2.2.2.1.1" xref="S3.SS1.p2.7.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m2.2.2.1.1.2" xref="S3.SS1.p2.7.m2.2.2.1.2.cmml">(</mo><mi id="S3.SS1.p2.7.m2.1.1" xref="S3.SS1.p2.7.m2.1.1.cmml">𝐱</mi><mo id="S3.SS1.p2.7.m2.2.2.1.1.3" xref="S3.SS1.p2.7.m2.2.2.1.2.cmml">;</mo><msup id="S3.SS1.p2.7.m2.2.2.1.1.1" xref="S3.SS1.p2.7.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.7.m2.2.2.1.1.1.2" xref="S3.SS1.p2.7.m2.2.2.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.7.m2.2.2.1.1.1.3" xref="S3.SS1.p2.7.m2.2.2.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.SS1.p2.7.m2.2.2.1.1.4" xref="S3.SS1.p2.7.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m2.2b"><apply id="S3.SS1.p2.7.m2.2.2.cmml" xref="S3.SS1.p2.7.m2.2.2"><times id="S3.SS1.p2.7.m2.2.2.2.cmml" xref="S3.SS1.p2.7.m2.2.2.2"></times><apply id="S3.SS1.p2.7.m2.2.2.3.cmml" xref="S3.SS1.p2.7.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m2.2.2.3.1.cmml" xref="S3.SS1.p2.7.m2.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.7.m2.2.2.3.2.cmml" xref="S3.SS1.p2.7.m2.2.2.3.2">𝐚</ci><ci id="S3.SS1.p2.7.m2.2.2.3.3.cmml" xref="S3.SS1.p2.7.m2.2.2.3.3">𝑀</ci></apply><list id="S3.SS1.p2.7.m2.2.2.1.2.cmml" xref="S3.SS1.p2.7.m2.2.2.1.1"><ci id="S3.SS1.p2.7.m2.1.1.cmml" xref="S3.SS1.p2.7.m2.1.1">𝐱</ci><apply id="S3.SS1.p2.7.m2.2.2.1.1.1.cmml" xref="S3.SS1.p2.7.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.7.m2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.7.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.7.m2.2.2.1.1.1.2">𝐰</ci><ci id="S3.SS1.p2.7.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.7.m2.2.2.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m2.2c">{\bf a}_{M}({\bf x};{\bf w}^{i})</annotation></semantics></math> is the top layer activation in the trainable model.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/1912.13075/assets/x4.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="211" height="145" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span> Illustration of representation matching using a model with one convolutional layer and two fully connected layers. Layers whose activations are used in the matching loss are shown in red. The matching layers map the activations in <math id="S3.F2.3.m1.1" class="ltx_Math" alttext="{\mathcal{M}}^{i}" display="inline"><semantics id="S3.F2.3.m1.1b"><msup id="S3.F2.3.m1.1.1" xref="S3.F2.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F2.3.m1.1.1.2" xref="S3.F2.3.m1.1.1.2.cmml">ℳ</mi><mi id="S3.F2.3.m1.1.1.3" xref="S3.F2.3.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.3.m1.1c"><apply id="S3.F2.3.m1.1.1.cmml" xref="S3.F2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.3.m1.1.1.1.cmml" xref="S3.F2.3.m1.1.1">superscript</csymbol><ci id="S3.F2.3.m1.1.1.2.cmml" xref="S3.F2.3.m1.1.1.2">ℳ</ci><ci id="S3.F2.3.m1.1.1.3.cmml" xref="S3.F2.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.m1.1d">{\mathcal{M}}^{i}</annotation></semantics></math> to the activations in <math id="S3.F2.4.m2.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.F2.4.m2.1b"><msup id="S3.F2.4.m2.1.1" xref="S3.F2.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F2.4.m2.1.1.2" xref="S3.F2.4.m2.1.1.2.cmml">ℳ</mi><mi id="S3.F2.4.m2.1.1.3" xref="S3.F2.4.m2.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.4.m2.1c"><apply id="S3.F2.4.m2.1.1.cmml" xref="S3.F2.4.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.4.m2.1.1.1.cmml" xref="S3.F2.4.m2.1.1">superscript</csymbol><ci id="S3.F2.4.m2.1.1.2.cmml" xref="S3.F2.4.m2.1.1.2">ℳ</ci><ci id="S3.F2.4.m2.1.1.3.cmml" xref="S3.F2.4.m2.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.m2.1d">{\mathcal{M}}^{F}</annotation></semantics></math>.</figcaption>
</figure>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.2" class="ltx_p">Our representation matching architecture is similar in some respects to auto-encoding architectures, particularly ladder networks <cite class="ltx_cite ltx_citemacro_citep">(Rasmus et al., <a href="#bib.bib20" title="" class="ltx_ref">2015</a>)</cite>. Unlike ladder networks, however, we do not reconstruct the activations of a non-noisy model from a noisy model but rather, reconstruct the activations of the most recent aggregate model from the activations of the model while it is being trained on a local dataset. This has a regularizing influence as it stops the clients from learning representations that are too specific to their local datasets. This should also ameliorate the effect of model divergence in the clients as all client models have to learn representations that are mappable to a common set of representations defined by the common aggregate model. Additional regularization comes about because a layer’s activations are used to reconstruct the activations of a layer below it. A similar technique was used in what-where autoencoders <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite>, and was shown to significantly improve accuracy. Our approach is fundamentally distinct, however, as we use the activations in one one model, <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="{\mathcal{M}}^{i}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msup id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">ℳ</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">{\mathcal{M}}^{i}</annotation></semantics></math>, to reconstruct the activations in a different model, <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="{\mathcal{M}}^{F}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msup id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">F</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">ℳ</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">{\mathcal{M}}^{F}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.1" class="ltx_p">Our representation matching scheme is similar in spirit to the techniques used to learn invariant feature representations for domain adaptation where the goal is to minimize the discrepancy between the distributions of features extracted from different domains. However, current techniques for learning domain-invariant features<cite class="ltx_cite ltx_citemacro_citep">(Ganin et al., <a href="#bib.bib6" title="" class="ltx_ref">2016</a>; Shen et al., <a href="#bib.bib23" title="" class="ltx_ref">2017</a>)</cite> are incompatible with the FL setting as they require the learner to have access to data from different domains (clients in our case) in order to match the feature distributions across these domains.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Adaptive hyper-parameters</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.9" class="ltx_p">At each round, the server provides the clients with training hyper-parameters. The hyper-parameters <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="{\bf h}_{t}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝐡</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐡</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{\bf h}_{t}</annotation></semantics></math> provided in round <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">t</annotation></semantics></math> are a sample from <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="P({\mathcal{H}}|{\bf\psi}_{t})" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.3.m3.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.1.1.1.1.2" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.3.m3.1.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.p1.3.m3.1.1.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S3.SS2.p1.3.m3.1.1.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.1.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.SS2.p1.3.m3.1.1.1.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p1.3.m3.1.1.1.1.3" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><times id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"></times><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑃</ci><apply id="S3.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.2">ℋ</ci><apply id="S3.SS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">P({\mathcal{H}}|{\bf\psi}_{t})</annotation></semantics></math>. Let <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="L_{t}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">L</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝐿</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">L_{t}</annotation></semantics></math> be the loss of the aggregate model at the beginning of round <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">t</annotation></semantics></math> on a representative set of data points (we describe in the next subsection practical schemes for evaluating <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="L_{t}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">L</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝐿</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">L_{t}</annotation></semantics></math>). We define the <span id="S3.SS2.p1.9.1" class="ltx_text ltx_font_italic">reward</span> received for choosing hyper-parameter <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="{\bf h}_{t}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">𝐡</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝐡</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">{\bf h}_{t}</annotation></semantics></math> as
<math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="r_{t}=(L_{t}-L_{t+1})/L_{t}" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mrow id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><msub id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.3.2" xref="S3.SS2.p1.8.m8.1.1.3.2.cmml">r</mi><mi id="S3.SS2.p1.8.m8.1.1.3.3" xref="S3.SS2.p1.8.m8.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">=</mo><mrow id="S3.SS2.p1.8.m8.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.cmml"><mrow id="S3.SS2.p1.8.m8.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m8.1.1.1.1.1.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.8.m8.1.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.2.cmml">L</mi><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.2.cmml">L</mi><mrow id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S3.SS2.p1.8.m8.1.1.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.p1.8.m8.1.1.1.2" xref="S3.SS2.p1.8.m8.1.1.1.2.cmml">/</mo><msub id="S3.SS2.p1.8.m8.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.3.2" xref="S3.SS2.p1.8.m8.1.1.1.3.2.cmml">L</mi><mi id="S3.SS2.p1.8.m8.1.1.1.3.3" xref="S3.SS2.p1.8.m8.1.1.1.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><eq id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2"></eq><apply id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.3.2">𝑟</ci><ci id="S3.SS2.p1.8.m8.1.1.3.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1"><divide id="S3.SS2.p1.8.m8.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.2"></divide><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1"><minus id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1"></minus><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.2">𝐿</ci><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.2">𝐿</ci><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3"><plus id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS2.p1.8.m8.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.3.2">𝐿</ci><ci id="S3.SS2.p1.8.m8.1.1.1.3.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">r_{t}=(L_{t}-L_{t+1})/L_{t}</annotation></semantics></math>.
The use of relative loss reduction is motivated by the desire to have the scale of rewards unchanged throughout training. At round <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mi id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">t</annotation></semantics></math>, the goal is to maximize:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="J_{t}={\mathbb{E}}_{P({\bf h}_{t}|{\bf\psi}_{t})}[r_{t}]" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msub id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml"><mi id="S3.E3.m1.2.2.3.2" xref="S3.E3.m1.2.2.3.2.cmml">J</mi><mi id="S3.E3.m1.2.2.3.3" xref="S3.E3.m1.2.2.3.3.cmml">t</mi></msub><mo id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><msub id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.3.cmml"><mi id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.2.2.1.3.2.cmml">𝔼</mi><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.2.1.cmml">[</mo><msub id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">r</mi><mi id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"></eq><apply id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.3.1.cmml" xref="S3.E3.m1.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.3.2.cmml" xref="S3.E3.m1.2.2.3.2">𝐽</ci><ci id="S3.E3.m1.2.2.3.3.cmml" xref="S3.E3.m1.2.2.3.3">𝑡</ci></apply><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><times id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.2"></times><apply id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.3.1.cmml" xref="S3.E3.m1.2.2.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.3.2.cmml" xref="S3.E3.m1.2.2.1.3.2">𝔼</ci><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝑃</ci><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">𝑟</ci><ci id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">J_{t}={\mathbb{E}}_{P({\bf h}_{t}|{\bf\psi}_{t})}[r_{t}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.10" class="ltx_p">Taking the derivative of <math id="S3.SS2.p1.10.m1.1" class="ltx_Math" alttext="J_{t}" display="inline"><semantics id="S3.SS2.p1.10.m1.1a"><msub id="S3.SS2.p1.10.m1.1.1" xref="S3.SS2.p1.10.m1.1.1.cmml"><mi id="S3.SS2.p1.10.m1.1.1.2" xref="S3.SS2.p1.10.m1.1.1.2.cmml">J</mi><mi id="S3.SS2.p1.10.m1.1.1.3" xref="S3.SS2.p1.10.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m1.1b"><apply id="S3.SS2.p1.10.m1.1.1.cmml" xref="S3.SS2.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m1.1.1.1.cmml" xref="S3.SS2.p1.10.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m1.1.1.2.cmml" xref="S3.SS2.p1.10.m1.1.1.2">𝐽</ci><ci id="S3.SS2.p1.10.m1.1.1.3.cmml" xref="S3.SS2.p1.10.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m1.1c">J_{t}</annotation></semantics></math> and approximating it with a one-sample Monte Carlo estimate, we obtain</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\displaystyle\nabla_{{\bf\psi}_{t}}J_{t}" display="inline"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msub id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">∇</mo><msub id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E4.m1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.3.3.cmml">t</mi></msub></msub><msub id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.2.2" xref="S3.E4.m1.1.1.2.2.cmml">J</mi><mi id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2">∇</ci><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2">𝜓</ci><ci id="S3.E4.m1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2.2">𝐽</ci><ci id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle\nabla_{{\bf\psi}_{t}}J_{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m2.2" class="ltx_Math" alttext="\displaystyle={\mathbb{E}}_{P({\bf h}_{t}|{\bf\psi}_{t})}[r_{t}\nabla_{{\bf\psi}_{t}}log(P({\bf h}_{t}|{\bf\psi}_{t}))]" display="inline"><semantics id="S3.E4.m2.2a"><mrow id="S3.E4.m2.2.2" xref="S3.E4.m2.2.2.cmml"><mi id="S3.E4.m2.2.2.3" xref="S3.E4.m2.2.2.3.cmml"></mi><mo id="S3.E4.m2.2.2.2" xref="S3.E4.m2.2.2.2.cmml">=</mo><mrow id="S3.E4.m2.2.2.1" xref="S3.E4.m2.2.2.1.cmml"><msub id="S3.E4.m2.2.2.1.3" xref="S3.E4.m2.2.2.1.3.cmml"><mi id="S3.E4.m2.2.2.1.3.2" xref="S3.E4.m2.2.2.1.3.2.cmml">𝔼</mi><mrow id="S3.E4.m2.1.1.1" xref="S3.E4.m2.1.1.1.cmml"><mi id="S3.E4.m2.1.1.1.3" xref="S3.E4.m2.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.1.1.1.2" xref="S3.E4.m2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m2.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m2.1.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.cmml"><msub id="S3.E4.m2.1.1.1.1.1.1.2" xref="S3.E4.m2.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m2.1.1.1.1.1.1.2.2" xref="S3.E4.m2.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E4.m2.1.1.1.1.1.1.2.3" xref="S3.E4.m2.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E4.m2.1.1.1.1.1.1.1" xref="S3.E4.m2.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E4.m2.1.1.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m2.1.1.1.1.1.1.3.2" xref="S3.E4.m2.1.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E4.m2.1.1.1.1.1.1.3.3" xref="S3.E4.m2.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E4.m2.1.1.1.1.1.3" xref="S3.E4.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m2.2.2.1.2" xref="S3.E4.m2.2.2.1.2.cmml">​</mo><mrow id="S3.E4.m2.2.2.1.1.1" xref="S3.E4.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m2.2.2.1.1.1.2" xref="S3.E4.m2.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m2.2.2.1.1.1.1" xref="S3.E4.m2.2.2.1.1.1.1.cmml"><msub id="S3.E4.m2.2.2.1.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.1.3.cmml"><mi id="S3.E4.m2.2.2.1.1.1.1.3.2" xref="S3.E4.m2.2.2.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E4.m2.2.2.1.1.1.1.3.3" xref="S3.E4.m2.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E4.m2.2.2.1.1.1.1.2" xref="S3.E4.m2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m2.2.2.1.1.1.1.4" xref="S3.E4.m2.2.2.1.1.1.1.4.cmml"><msub id="S3.E4.m2.2.2.1.1.1.1.4.1" xref="S3.E4.m2.2.2.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S3.E4.m2.2.2.1.1.1.1.4.1.2" xref="S3.E4.m2.2.2.1.1.1.1.4.1.2.cmml">∇</mo><msub id="S3.E4.m2.2.2.1.1.1.1.4.1.3" xref="S3.E4.m2.2.2.1.1.1.1.4.1.3.cmml"><mi id="S3.E4.m2.2.2.1.1.1.1.4.1.3.2" xref="S3.E4.m2.2.2.1.1.1.1.4.1.3.2.cmml">ψ</mi><mi id="S3.E4.m2.2.2.1.1.1.1.4.1.3.3" xref="S3.E4.m2.2.2.1.1.1.1.4.1.3.3.cmml">t</mi></msub></msub><mrow id="S3.E4.m2.2.2.1.1.1.1.4.2" xref="S3.E4.m2.2.2.1.1.1.1.4.2.cmml"><mi id="S3.E4.m2.2.2.1.1.1.1.4.2.2" xref="S3.E4.m2.2.2.1.1.1.1.4.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.2.2.1.1.1.1.4.2.1" xref="S3.E4.m2.2.2.1.1.1.1.4.2.1.cmml">​</mo><mi id="S3.E4.m2.2.2.1.1.1.1.4.2.3" xref="S3.E4.m2.2.2.1.1.1.1.4.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.2.2.1.1.1.1.4.2.1a" xref="S3.E4.m2.2.2.1.1.1.1.4.2.1.cmml">​</mo><mi id="S3.E4.m2.2.2.1.1.1.1.4.2.4" xref="S3.E4.m2.2.2.1.1.1.1.4.2.4.cmml">g</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m2.2.2.1.1.1.1.2a" xref="S3.E4.m2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m2.2.2.1.1.1.1.1.1" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m2.2.2.1.1.1.1.1.1.2" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.2.2.1.1.1.1.1.1.1" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.2.2.1.1.1.1.1.1.1.2" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m2.2.2.1.1.1.1.1.1.3" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m2.2.2.1.1.1.3" xref="S3.E4.m2.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.2b"><apply id="S3.E4.m2.2.2.cmml" xref="S3.E4.m2.2.2"><eq id="S3.E4.m2.2.2.2.cmml" xref="S3.E4.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.E4.m2.2.2.3.cmml" xref="S3.E4.m2.2.2.3">absent</csymbol><apply id="S3.E4.m2.2.2.1.cmml" xref="S3.E4.m2.2.2.1"><times id="S3.E4.m2.2.2.1.2.cmml" xref="S3.E4.m2.2.2.1.2"></times><apply id="S3.E4.m2.2.2.1.3.cmml" xref="S3.E4.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.3.1.cmml" xref="S3.E4.m2.2.2.1.3">subscript</csymbol><ci id="S3.E4.m2.2.2.1.3.2.cmml" xref="S3.E4.m2.2.2.1.3.2">𝔼</ci><apply id="S3.E4.m2.1.1.1.cmml" xref="S3.E4.m2.1.1.1"><times id="S3.E4.m2.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.2"></times><ci id="S3.E4.m2.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.3">𝑃</ci><apply id="S3.E4.m2.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S3.E4.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E4.m2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m2.1.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.E4.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E4.m2.2.2.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E4.m2.2.2.1.1.2.1.cmml" xref="S3.E4.m2.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m2.2.2.1.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1"><times id="S3.E4.m2.2.2.1.1.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.2"></times><apply id="S3.E4.m2.2.2.1.1.1.1.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.1.1.3.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m2.2.2.1.1.1.1.3.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.3.2">𝑟</ci><ci id="S3.E4.m2.2.2.1.1.1.1.3.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E4.m2.2.2.1.1.1.1.4.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4"><apply id="S3.E4.m2.2.2.1.1.1.1.4.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.1.1.4.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.1">subscript</csymbol><ci id="S3.E4.m2.2.2.1.1.1.1.4.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.1.2">∇</ci><apply id="S3.E4.m2.2.2.1.1.1.1.4.1.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.1.1.4.1.3.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.1.3">subscript</csymbol><ci id="S3.E4.m2.2.2.1.1.1.1.4.1.3.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.1.3.2">𝜓</ci><ci id="S3.E4.m2.2.2.1.1.1.1.4.1.3.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.1.3.3">𝑡</ci></apply></apply><apply id="S3.E4.m2.2.2.1.1.1.1.4.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.2"><times id="S3.E4.m2.2.2.1.1.1.1.4.2.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.2.1"></times><ci id="S3.E4.m2.2.2.1.1.1.1.4.2.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.2.2">𝑙</ci><ci id="S3.E4.m2.2.2.1.1.1.1.4.2.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.2.3">𝑜</ci><ci id="S3.E4.m2.2.2.1.1.1.1.4.2.4.cmml" xref="S3.E4.m2.2.2.1.1.1.1.4.2.4">𝑔</ci></apply></apply><apply id="S3.E4.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1"><times id="S3.E4.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.3">𝑃</ci><apply id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.2c">\displaystyle={\mathbb{E}}_{P({\bf h}_{t}|{\bf\psi}_{t})}[r_{t}\nabla_{{\bf\psi}_{t}}log(P({\bf h}_{t}|{\bf\psi}_{t}))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\displaystyle\approx r_{t}\nabla_{{\bf\psi}_{t}}log(P({\bf h}_{t}|{\bf\psi}_{t}))\quad where\quad{{\bf h}_{t}\sim P({\bf h}_{t}|{\bf\psi}_{t})}" display="inline"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.3.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.4.cmml"></mi><mo id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml">≈</mo><mrow id="S3.E5.m1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.3.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.1.1.1.4.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.1.4.1" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S3.E5.m1.1.1.1.1.1.1.1.4.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.2.cmml">∇</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.4.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.2.cmml">ψ</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.3.cmml">t</mi></msub></msub><mrow id="S3.E5.m1.1.1.1.1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.4.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.4.2.1" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.4.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.4.2.1a" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.4.2.4" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.4.cmml">g</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.2a" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mspace width="1em" id="S3.E5.m1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.2.3.cmml"></mspace><mrow id="S3.E5.m1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.2.2.2.1" xref="S3.E5.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.2.2.2.1a" xref="S3.E5.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.2.2.2.4" xref="S3.E5.m1.1.1.1.1.2.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.2.2.2.1b" xref="S3.E5.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.2.2.2.5" xref="S3.E5.m1.1.1.1.1.2.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.2.2.2.1c" xref="S3.E5.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.2.2.2.6" xref="S3.E5.m1.1.1.1.1.2.2.2.6.cmml">e</mi></mrow></mrow></mrow><mspace width="1em" id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.3a.cmml"></mspace><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml"><msub id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.3.2" xref="S3.E5.m1.2.2.2.2.3.2.cmml">𝐡</mi><mi id="S3.E5.m1.2.2.2.2.3.3" xref="S3.E5.m1.2.2.2.2.3.3.cmml">t</mi></msub><mo id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml">∼</mo><mrow id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.3" xref="S3.E5.m1.2.2.2.2.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.1.2" xref="S3.E5.m1.2.2.2.2.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.2.2.1.1.1" xref="S3.E5.m1.2.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.2.1.1.1.2" xref="S3.E5.m1.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.2.2.1.1.1.1" xref="S3.E5.m1.2.2.2.2.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2.cmml"><mi id="S3.E5.m1.2.2.2.2.1.1.1.1.2.2" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E5.m1.2.2.2.2.1.1.1.1.2.3" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E5.m1.2.2.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.2.2.1.1.1.1.1.cmml">|</mo><msub id="S3.E5.m1.2.2.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.2.2.1.1.1.1.3.2" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E5.m1.2.2.2.2.1.1.1.1.3.3" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E5.m1.2.2.2.2.1.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3a.cmml" xref="S3.E5.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><approx id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"></approx><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.4">absent</csymbol><list id="S3.E5.m1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2"><apply id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4"><apply id="S3.E5.m1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.4.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.4.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.2">∇</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.2">𝜓</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.1.3.3">𝑡</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2"><times id="S3.E5.m1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.2">𝑙</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.3">𝑜</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.4.2.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4.2.4">𝑔</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3">𝑃</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E5.m1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2"><times id="S3.E5.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.1"></times><ci id="S3.E5.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2">𝑤</ci><ci id="S3.E5.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.3">ℎ</ci><ci id="S3.E5.m1.1.1.1.1.2.2.2.4.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.4">𝑒</ci><ci id="S3.E5.m1.1.1.1.1.2.2.2.5.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.5">𝑟</ci><ci id="S3.E5.m1.1.1.1.1.2.2.2.6.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.6">𝑒</ci></apply></list></apply><apply id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2">similar-to</csymbol><apply id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.3.2">𝐡</ci><ci id="S3.E5.m1.2.2.2.2.3.3.cmml" xref="S3.E5.m1.2.2.2.2.3.3">𝑡</ci></apply><apply id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1"><times id="S3.E5.m1.2.2.2.2.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.2"></times><ci id="S3.E5.m1.2.2.2.2.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.3">𝑃</ci><apply id="S3.E5.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S3.E5.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2.2">𝐡</ci><ci id="S3.E5.m1.2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E5.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3.2">𝜓</ci><ci id="S3.E5.m1.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\displaystyle\approx r_{t}\nabla_{{\bf\psi}_{t}}log(P({\bf h}_{t}|{\bf\psi}_{t}))\quad where\quad{{\bf h}_{t}\sim P({\bf h}_{t}|{\bf\psi}_{t})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.14" class="ltx_p">The score-function or REINFORCE gradient estimator <cite class="ltx_cite ltx_citemacro_citep">(Williams, <a href="#bib.bib26" title="" class="ltx_ref">1992</a>)</cite> in Eq. <a href="#S3.E5" title="In 3.2 Adaptive hyper-parameters ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> can be readily evaluated and can be used to update <math id="S3.SS2.p1.11.m1.1" class="ltx_Math" alttext="{\bf\psi}_{t}" display="inline"><semantics id="S3.SS2.p1.11.m1.1a"><msub id="S3.SS2.p1.11.m1.1.1" xref="S3.SS2.p1.11.m1.1.1.cmml"><mi id="S3.SS2.p1.11.m1.1.1.2" xref="S3.SS2.p1.11.m1.1.1.2.cmml">ψ</mi><mi id="S3.SS2.p1.11.m1.1.1.3" xref="S3.SS2.p1.11.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m1.1b"><apply id="S3.SS2.p1.11.m1.1.1.cmml" xref="S3.SS2.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m1.1.1.1.cmml" xref="S3.SS2.p1.11.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m1.1.1.2.cmml" xref="S3.SS2.p1.11.m1.1.1.2">𝜓</ci><ci id="S3.SS2.p1.11.m1.1.1.3.cmml" xref="S3.SS2.p1.11.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m1.1c">{\bf\psi}_{t}</annotation></semantics></math>. However, the variance of this gradient estimator can be quite high <cite class="ltx_cite ltx_citemacro_citep">(Rezende et al., <a href="#bib.bib21" title="" class="ltx_ref">2014</a>)</cite>, especially since we are using a single-sample estimate. To reduce variance, we introduce a reward baseline <cite class="ltx_cite ltx_citemacro_citep">(Greensmith et al., <a href="#bib.bib7" title="" class="ltx_ref">2004</a>)</cite> which is the weighted average reward in an interval <math id="S3.SS2.p1.12.m2.2" class="ltx_Math" alttext="[t-Z,t+Z]" display="inline"><semantics id="S3.SS2.p1.12.m2.2a"><mrow id="S3.SS2.p1.12.m2.2.2.2" xref="S3.SS2.p1.12.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.12.m2.2.2.2.3" xref="S3.SS2.p1.12.m2.2.2.3.cmml">[</mo><mrow id="S3.SS2.p1.12.m2.1.1.1.1" xref="S3.SS2.p1.12.m2.1.1.1.1.cmml"><mi id="S3.SS2.p1.12.m2.1.1.1.1.2" xref="S3.SS2.p1.12.m2.1.1.1.1.2.cmml">t</mi><mo id="S3.SS2.p1.12.m2.1.1.1.1.1" xref="S3.SS2.p1.12.m2.1.1.1.1.1.cmml">−</mo><mi id="S3.SS2.p1.12.m2.1.1.1.1.3" xref="S3.SS2.p1.12.m2.1.1.1.1.3.cmml">Z</mi></mrow><mo id="S3.SS2.p1.12.m2.2.2.2.4" xref="S3.SS2.p1.12.m2.2.2.3.cmml">,</mo><mrow id="S3.SS2.p1.12.m2.2.2.2.2" xref="S3.SS2.p1.12.m2.2.2.2.2.cmml"><mi id="S3.SS2.p1.12.m2.2.2.2.2.2" xref="S3.SS2.p1.12.m2.2.2.2.2.2.cmml">t</mi><mo id="S3.SS2.p1.12.m2.2.2.2.2.1" xref="S3.SS2.p1.12.m2.2.2.2.2.1.cmml">+</mo><mi id="S3.SS2.p1.12.m2.2.2.2.2.3" xref="S3.SS2.p1.12.m2.2.2.2.2.3.cmml">Z</mi></mrow><mo stretchy="false" id="S3.SS2.p1.12.m2.2.2.2.5" xref="S3.SS2.p1.12.m2.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m2.2b"><interval closure="closed" id="S3.SS2.p1.12.m2.2.2.3.cmml" xref="S3.SS2.p1.12.m2.2.2.2"><apply id="S3.SS2.p1.12.m2.1.1.1.1.cmml" xref="S3.SS2.p1.12.m2.1.1.1.1"><minus id="S3.SS2.p1.12.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.12.m2.1.1.1.1.1"></minus><ci id="S3.SS2.p1.12.m2.1.1.1.1.2.cmml" xref="S3.SS2.p1.12.m2.1.1.1.1.2">𝑡</ci><ci id="S3.SS2.p1.12.m2.1.1.1.1.3.cmml" xref="S3.SS2.p1.12.m2.1.1.1.1.3">𝑍</ci></apply><apply id="S3.SS2.p1.12.m2.2.2.2.2.cmml" xref="S3.SS2.p1.12.m2.2.2.2.2"><plus id="S3.SS2.p1.12.m2.2.2.2.2.1.cmml" xref="S3.SS2.p1.12.m2.2.2.2.2.1"></plus><ci id="S3.SS2.p1.12.m2.2.2.2.2.2.cmml" xref="S3.SS2.p1.12.m2.2.2.2.2.2">𝑡</ci><ci id="S3.SS2.p1.12.m2.2.2.2.2.3.cmml" xref="S3.SS2.p1.12.m2.2.2.2.2.3">𝑍</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m2.2c">[t-Z,t+Z]</annotation></semantics></math> centered around <math id="S3.SS2.p1.13.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.13.m3.1a"><mi id="S3.SS2.p1.13.m3.1.1" xref="S3.SS2.p1.13.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m3.1b"><ci id="S3.SS2.p1.13.m3.1.1.cmml" xref="S3.SS2.p1.13.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m3.1c">t</annotation></semantics></math>. The update equation for <math id="S3.SS2.p1.14.m4.1" class="ltx_Math" alttext="{\bf\psi}_{t}" display="inline"><semantics id="S3.SS2.p1.14.m4.1a"><msub id="S3.SS2.p1.14.m4.1.1" xref="S3.SS2.p1.14.m4.1.1.cmml"><mi id="S3.SS2.p1.14.m4.1.1.2" xref="S3.SS2.p1.14.m4.1.1.2.cmml">ψ</mi><mi id="S3.SS2.p1.14.m4.1.1.3" xref="S3.SS2.p1.14.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m4.1b"><apply id="S3.SS2.p1.14.m4.1.1.cmml" xref="S3.SS2.p1.14.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m4.1.1.1.cmml" xref="S3.SS2.p1.14.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.14.m4.1.1.2.cmml" xref="S3.SS2.p1.14.m4.1.1.2">𝜓</ci><ci id="S3.SS2.p1.14.m4.1.1.3.cmml" xref="S3.SS2.p1.14.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m4.1c">{\bf\psi}_{t}</annotation></semantics></math> is:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="{\bf\psi}_{t+1}\leftarrow{\bf\psi}_{t}-\eta_{H}(r_{t}-{\bar{r}}_{t})\nabla_{{\bf\psi}_{t}}log(P({\bf h}_{t}|{\bf\psi}_{t}))\quad where\quad{\bar{r}}_{t}=\gamma_{Z}\sum\limits_{\begin{subarray}{c}\tau=t-Z\\
\tau\neq t\end{subarray}}^{\tau=t+Z}(Z+1-|\tau-t|)r_{\tau}" display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.2" xref="S3.E6.m1.3.3.3.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.4" xref="S3.E6.m1.2.2.1.1.4.cmml"><mi id="S3.E6.m1.2.2.1.1.4.2" xref="S3.E6.m1.2.2.1.1.4.2.cmml">ψ</mi><mrow id="S3.E6.m1.2.2.1.1.4.3" xref="S3.E6.m1.2.2.1.1.4.3.cmml"><mi id="S3.E6.m1.2.2.1.1.4.3.2" xref="S3.E6.m1.2.2.1.1.4.3.2.cmml">t</mi><mo id="S3.E6.m1.2.2.1.1.4.3.1" xref="S3.E6.m1.2.2.1.1.4.3.1.cmml">+</mo><mn id="S3.E6.m1.2.2.1.1.4.3.3" xref="S3.E6.m1.2.2.1.1.4.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml">←</mo><mrow id="S3.E6.m1.2.2.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.3.cmml"><mrow id="S3.E6.m1.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.1.1.4" xref="S3.E6.m1.2.2.1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.4.2" xref="S3.E6.m1.2.2.1.1.1.1.1.4.2.cmml">ψ</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.4.3" xref="S3.E6.m1.2.2.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E6.m1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.cmml"><msub id="S3.E6.m1.2.2.1.1.1.1.1.2.4" xref="S3.E6.m1.2.2.1.1.1.1.1.2.4.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.4.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.4.2.cmml">η</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.4.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.4.3.cmml">H</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.2.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2.cmml">r</mi><mo id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.2.3a" xref="S3.E6.m1.2.2.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.2.5" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.cmml"><msub id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.cmml"><mo rspace="0.167em" id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.2.cmml">∇</mo><msub id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.2.cmml">ψ</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.3.cmml">t</mi></msub></msub><mrow id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.1" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.1a" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.4" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.4.cmml">g</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.2.3b" xref="S3.E6.m1.2.2.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mspace width="1em" id="S3.E6.m1.2.2.1.1.2.2.3" xref="S3.E6.m1.2.2.1.1.2.3.cmml"></mspace><mrow id="S3.E6.m1.2.2.1.1.2.2.2" xref="S3.E6.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E6.m1.2.2.1.1.2.2.2.2" xref="S3.E6.m1.2.2.1.1.2.2.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.2.2.1" xref="S3.E6.m1.2.2.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.2.2.2.3" xref="S3.E6.m1.2.2.1.1.2.2.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.2.2.1a" xref="S3.E6.m1.2.2.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.2.2.2.4" xref="S3.E6.m1.2.2.1.1.2.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.2.2.1b" xref="S3.E6.m1.2.2.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.2.2.2.5" xref="S3.E6.m1.2.2.1.1.2.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.2.2.1c" xref="S3.E6.m1.2.2.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E6.m1.2.2.1.1.2.2.2.6" xref="S3.E6.m1.2.2.1.1.2.2.2.6.cmml">e</mi></mrow></mrow></mrow><mspace width="1em" id="S3.E6.m1.3.3.2.3" xref="S3.E6.m1.3.3.3a.cmml"></mspace><mrow id="S3.E6.m1.3.3.2.2" xref="S3.E6.m1.3.3.2.2.cmml"><msub id="S3.E6.m1.3.3.2.2.3" xref="S3.E6.m1.3.3.2.2.3.cmml"><mover accent="true" id="S3.E6.m1.3.3.2.2.3.2" xref="S3.E6.m1.3.3.2.2.3.2.cmml"><mi id="S3.E6.m1.3.3.2.2.3.2.2" xref="S3.E6.m1.3.3.2.2.3.2.2.cmml">r</mi><mo id="S3.E6.m1.3.3.2.2.3.2.1" xref="S3.E6.m1.3.3.2.2.3.2.1.cmml">¯</mo></mover><mi id="S3.E6.m1.3.3.2.2.3.3" xref="S3.E6.m1.3.3.2.2.3.3.cmml">t</mi></msub><mo id="S3.E6.m1.3.3.2.2.2" xref="S3.E6.m1.3.3.2.2.2.cmml">=</mo><mrow id="S3.E6.m1.3.3.2.2.1" xref="S3.E6.m1.3.3.2.2.1.cmml"><msub id="S3.E6.m1.3.3.2.2.1.3" xref="S3.E6.m1.3.3.2.2.1.3.cmml"><mi id="S3.E6.m1.3.3.2.2.1.3.2" xref="S3.E6.m1.3.3.2.2.1.3.2.cmml">γ</mi><mi id="S3.E6.m1.3.3.2.2.1.3.3" xref="S3.E6.m1.3.3.2.2.1.3.3.cmml">Z</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.2.2.1.2" xref="S3.E6.m1.3.3.2.2.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.2.2.1.1" xref="S3.E6.m1.3.3.2.2.1.1.cmml"><munderover id="S3.E6.m1.3.3.2.2.1.1.2" xref="S3.E6.m1.3.3.2.2.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.3.3.2.2.1.1.2.2.2" xref="S3.E6.m1.3.3.2.2.1.1.2.2.2.cmml">∑</mo><mtable rowspacing="0pt" id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.2.cmml"><mtr id="S3.E6.m1.1.1.1.1.1.1a" xref="S3.E6.m1.1.1.1.2.cmml"><mtd id="S3.E6.m1.1.1.1.1.1.1b" xref="S3.E6.m1.1.1.1.2.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml">τ</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">Z</mi></mrow></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.1.1c" xref="S3.E6.m1.1.1.1.2.cmml"><mtd id="S3.E6.m1.1.1.1.1.1.1d" xref="S3.E6.m1.1.1.1.2.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.2.1.1" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.2.cmml">τ</mi><mo id="S3.E6.m1.1.1.1.1.1.1.2.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.1.cmml">≠</mo><mi id="S3.E6.m1.1.1.1.1.1.1.2.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.3.cmml">t</mi></mrow></mtd></mtr></mtable><mrow id="S3.E6.m1.3.3.2.2.1.1.2.3" xref="S3.E6.m1.3.3.2.2.1.1.2.3.cmml"><mi id="S3.E6.m1.3.3.2.2.1.1.2.3.2" xref="S3.E6.m1.3.3.2.2.1.1.2.3.2.cmml">τ</mi><mo id="S3.E6.m1.3.3.2.2.1.1.2.3.1" xref="S3.E6.m1.3.3.2.2.1.1.2.3.1.cmml">=</mo><mrow id="S3.E6.m1.3.3.2.2.1.1.2.3.3" xref="S3.E6.m1.3.3.2.2.1.1.2.3.3.cmml"><mi id="S3.E6.m1.3.3.2.2.1.1.2.3.3.2" xref="S3.E6.m1.3.3.2.2.1.1.2.3.3.2.cmml">t</mi><mo id="S3.E6.m1.3.3.2.2.1.1.2.3.3.1" xref="S3.E6.m1.3.3.2.2.1.1.2.3.3.1.cmml">+</mo><mi id="S3.E6.m1.3.3.2.2.1.1.2.3.3.3" xref="S3.E6.m1.3.3.2.2.1.1.2.3.3.3.cmml">Z</mi></mrow></mrow></munderover><mrow id="S3.E6.m1.3.3.2.2.1.1.1" xref="S3.E6.m1.3.3.2.2.1.1.1.cmml"><mrow id="S3.E6.m1.3.3.2.2.1.1.1.1.1" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.2.2.1.1.1.1.1.2" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.2" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.2.cmml">Z</mi><mo id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.1" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.3" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mo id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.2.cmml">τ</mi><mo id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></mrow><mo stretchy="false" id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.3.3.2.2.1.1.1.1.1.3" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.2.2.1.1.1.2" xref="S3.E6.m1.3.3.2.2.1.1.1.2.cmml">​</mo><msub id="S3.E6.m1.3.3.2.2.1.1.1.3" xref="S3.E6.m1.3.3.2.2.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.2.2.1.1.1.3.2" xref="S3.E6.m1.3.3.2.2.1.1.1.3.2.cmml">r</mi><mi id="S3.E6.m1.3.3.2.2.1.1.1.3.3" xref="S3.E6.m1.3.3.2.2.1.1.1.3.3.cmml">τ</mi></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3a.cmml" xref="S3.E6.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1.1"><ci id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3">←</ci><apply id="S3.E6.m1.2.2.1.1.4.cmml" xref="S3.E6.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.4.1.cmml" xref="S3.E6.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.4.2.cmml" xref="S3.E6.m1.2.2.1.1.4.2">𝜓</ci><apply id="S3.E6.m1.2.2.1.1.4.3.cmml" xref="S3.E6.m1.2.2.1.1.4.3"><plus id="S3.E6.m1.2.2.1.1.4.3.1.cmml" xref="S3.E6.m1.2.2.1.1.4.3.1"></plus><ci id="S3.E6.m1.2.2.1.1.4.3.2.cmml" xref="S3.E6.m1.2.2.1.1.4.3.2">𝑡</ci><cn type="integer" id="S3.E6.m1.2.2.1.1.4.3.3.cmml" xref="S3.E6.m1.2.2.1.1.4.3.3">1</cn></apply></apply><list id="S3.E6.m1.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.2"><apply id="S3.E6.m1.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1"><minus id="S3.E6.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.3"></minus><apply id="S3.E6.m1.2.2.1.1.1.1.1.4.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.4.2">𝜓</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.4.3">𝑡</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2"><times id="S3.E6.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.3"></times><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.4.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.2.4.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.4.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.4.2">𝜂</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.4.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.4.3">𝐻</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1"><minus id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1">¯</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2">𝑟</ci></apply><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.5.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5"><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.2">∇</ci><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.2">𝜓</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.1.3.3">𝑡</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2"><times id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.1"></times><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.2">𝑙</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.3">𝑜</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.4.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.5.2.4">𝑔</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1"><times id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.2"></times><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.3">𝑃</ci><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.2">𝐡</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2"><times id="S3.E6.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.1"></times><ci id="S3.E6.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.2">𝑤</ci><ci id="S3.E6.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.3">ℎ</ci><ci id="S3.E6.m1.2.2.1.1.2.2.2.4.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.4">𝑒</ci><ci id="S3.E6.m1.2.2.1.1.2.2.2.5.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.5">𝑟</ci><ci id="S3.E6.m1.2.2.1.1.2.2.2.6.cmml" xref="S3.E6.m1.2.2.1.1.2.2.2.6">𝑒</ci></apply></list></apply><apply id="S3.E6.m1.3.3.2.2.cmml" xref="S3.E6.m1.3.3.2.2"><eq id="S3.E6.m1.3.3.2.2.2.cmml" xref="S3.E6.m1.3.3.2.2.2"></eq><apply id="S3.E6.m1.3.3.2.2.3.cmml" xref="S3.E6.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.2.3.1.cmml" xref="S3.E6.m1.3.3.2.2.3">subscript</csymbol><apply id="S3.E6.m1.3.3.2.2.3.2.cmml" xref="S3.E6.m1.3.3.2.2.3.2"><ci id="S3.E6.m1.3.3.2.2.3.2.1.cmml" xref="S3.E6.m1.3.3.2.2.3.2.1">¯</ci><ci id="S3.E6.m1.3.3.2.2.3.2.2.cmml" xref="S3.E6.m1.3.3.2.2.3.2.2">𝑟</ci></apply><ci id="S3.E6.m1.3.3.2.2.3.3.cmml" xref="S3.E6.m1.3.3.2.2.3.3">𝑡</ci></apply><apply id="S3.E6.m1.3.3.2.2.1.cmml" xref="S3.E6.m1.3.3.2.2.1"><times id="S3.E6.m1.3.3.2.2.1.2.cmml" xref="S3.E6.m1.3.3.2.2.1.2"></times><apply id="S3.E6.m1.3.3.2.2.1.3.cmml" xref="S3.E6.m1.3.3.2.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.2.1.3.1.cmml" xref="S3.E6.m1.3.3.2.2.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.2.2.1.3.2.cmml" xref="S3.E6.m1.3.3.2.2.1.3.2">𝛾</ci><ci id="S3.E6.m1.3.3.2.2.1.3.3.cmml" xref="S3.E6.m1.3.3.2.2.1.3.3">𝑍</ci></apply><apply id="S3.E6.m1.3.3.2.2.1.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1"><apply id="S3.E6.m1.3.3.2.2.1.1.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.2.1.1.2.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2">superscript</csymbol><apply id="S3.E6.m1.3.3.2.2.1.1.2.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.2.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2">subscript</csymbol><sum id="S3.E6.m1.3.3.2.2.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2.2.2"></sum><list id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><matrix id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><matrixrow id="S3.E6.m1.1.1.1.1.1.1a.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"></eq><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2">𝜏</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3">𝑍</ci></apply></apply></matrixrow><matrixrow id="S3.E6.m1.1.1.1.1.1.1b.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1"><neq id="S3.E6.m1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.1"></neq><ci id="S3.E6.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.2">𝜏</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.1.1.3">𝑡</ci></apply></matrixrow></matrix></list></apply><apply id="S3.E6.m1.3.3.2.2.1.1.2.3.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2.3"><eq id="S3.E6.m1.3.3.2.2.1.1.2.3.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2.3.1"></eq><ci id="S3.E6.m1.3.3.2.2.1.1.2.3.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2.3.2">𝜏</ci><apply id="S3.E6.m1.3.3.2.2.1.1.2.3.3.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2.3.3"><plus id="S3.E6.m1.3.3.2.2.1.1.2.3.3.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2.3.3.1"></plus><ci id="S3.E6.m1.3.3.2.2.1.1.2.3.3.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2.3.3.2">𝑡</ci><ci id="S3.E6.m1.3.3.2.2.1.1.2.3.3.3.cmml" xref="S3.E6.m1.3.3.2.2.1.1.2.3.3.3">𝑍</ci></apply></apply></apply><apply id="S3.E6.m1.3.3.2.2.1.1.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1"><times id="S3.E6.m1.3.3.2.2.1.1.1.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.2"></times><apply id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1"><minus id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.2"></minus><apply id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3"><plus id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.1"></plus><ci id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.2">𝑍</ci><cn type="integer" id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1"><abs id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1"><minus id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.2">𝜏</ci><ci id="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E6.m1.3.3.2.2.1.1.1.3.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.2.2.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.2.2.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.3.2">𝑟</ci><ci id="S3.E6.m1.3.3.2.2.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.2.2.1.1.1.3.3">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">{\bf\psi}_{t+1}\leftarrow{\bf\psi}_{t}-\eta_{H}(r_{t}-{\bar{r}}_{t})\nabla_{{\bf\psi}_{t}}log(P({\bf h}_{t}|{\bf\psi}_{t}))\quad where\quad{\bar{r}}_{t}=\gamma_{Z}\sum\limits_{\begin{subarray}{c}\tau=t-Z\\
\tau\neq t\end{subarray}}^{\tau=t+Z}(Z+1-|\tau-t|)r_{\tau}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.17" class="ltx_p">where <math id="S3.SS2.p1.15.m1.1" class="ltx_Math" alttext="\eta_{H}" display="inline"><semantics id="S3.SS2.p1.15.m1.1a"><msub id="S3.SS2.p1.15.m1.1.1" xref="S3.SS2.p1.15.m1.1.1.cmml"><mi id="S3.SS2.p1.15.m1.1.1.2" xref="S3.SS2.p1.15.m1.1.1.2.cmml">η</mi><mi id="S3.SS2.p1.15.m1.1.1.3" xref="S3.SS2.p1.15.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m1.1b"><apply id="S3.SS2.p1.15.m1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m1.1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.15.m1.1.1.2.cmml" xref="S3.SS2.p1.15.m1.1.1.2">𝜂</ci><ci id="S3.SS2.p1.15.m1.1.1.3.cmml" xref="S3.SS2.p1.15.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m1.1c">\eta_{H}</annotation></semantics></math> is the hyper learning rate and <math id="S3.SS2.p1.16.m2.1" class="ltx_Math" alttext="\gamma_{Z}" display="inline"><semantics id="S3.SS2.p1.16.m2.1a"><msub id="S3.SS2.p1.16.m2.1.1" xref="S3.SS2.p1.16.m2.1.1.cmml"><mi id="S3.SS2.p1.16.m2.1.1.2" xref="S3.SS2.p1.16.m2.1.1.2.cmml">γ</mi><mi id="S3.SS2.p1.16.m2.1.1.3" xref="S3.SS2.p1.16.m2.1.1.3.cmml">Z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m2.1b"><apply id="S3.SS2.p1.16.m2.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.16.m2.1.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.16.m2.1.1.2.cmml" xref="S3.SS2.p1.16.m2.1.1.2">𝛾</ci><ci id="S3.SS2.p1.16.m2.1.1.3.cmml" xref="S3.SS2.p1.16.m2.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m2.1c">\gamma_{Z}</annotation></semantics></math> a normalizing constant. We weigh nearby rewards more heavily than distant rewards when calculating the baseline in round <math id="S3.SS2.p1.17.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.17.m3.1a"><mi id="S3.SS2.p1.17.m3.1.1" xref="S3.SS2.p1.17.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m3.1b"><ci id="S3.SS2.p1.17.m3.1.1.cmml" xref="S3.SS2.p1.17.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m3.1c">t</annotation></semantics></math>. A causal version of Eq. <a href="#S3.E6" title="In 3.2 Adaptive hyper-parameters ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> that only depends on past rewards is:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.2" class="ltx_Math" alttext="{\bf\psi}_{t+1}\leftarrow{\bf\psi}_{t}-\eta_{H}\sum\limits_{\tau=t-Z}^{\tau=t}(r_{\tau}-{\hat{r}}_{t})\nabla_{{\bf\psi}_{\tau}}log(P({\bf h}_{\tau}|{\bf\psi}_{\tau}))\quad where\quad{\hat{r}}_{t}=\frac{1}{Z+1}\sum\limits_{\tau=t-Z}^{\tau=t}r_{\tau}" display="block"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.3.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.4.cmml"><mi id="S3.E7.m1.1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.1.4.2.cmml">ψ</mi><mrow id="S3.E7.m1.1.1.1.1.4.3" xref="S3.E7.m1.1.1.1.1.4.3.cmml"><mi id="S3.E7.m1.1.1.1.1.4.3.2" xref="S3.E7.m1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.4.3.1" xref="S3.E7.m1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S3.E7.m1.1.1.1.1.4.3.3" xref="S3.E7.m1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml">←</mo><mrow id="S3.E7.m1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.2.3.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.1.1.1.1.4.2.cmml">ψ</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.4.3" xref="S3.E7.m1.1.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.2.4" xref="S3.E7.m1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.4.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.4.2.cmml">η</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.4.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.4.3.cmml">H</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.cmml"><munderover id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mo movablelimits="false" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml">τ</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.2.cmml">t</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.1.cmml">−</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.cmml">Z</mi></mrow></mrow><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.2.cmml">τ</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.1.cmml">=</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.3.cmml">t</mi></mrow></munderover><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">r</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.cmml"><mo rspace="0.167em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.2.cmml">∇</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.2.cmml">ψ</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.3.cmml">τ</mi></msub></msub><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.1a" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.4" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.4.cmml">g</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3a" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mspace width="1em" id="S3.E7.m1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.2.3.cmml"></mspace><mrow id="S3.E7.m1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2.2.2.1" xref="S3.E7.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.1.1.1.1.2.2.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2.2.2.1a" xref="S3.E7.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.2.2.2.4" xref="S3.E7.m1.1.1.1.1.2.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2.2.2.1b" xref="S3.E7.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.2.2.2.5" xref="S3.E7.m1.1.1.1.1.2.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.2.2.2.1c" xref="S3.E7.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.2.2.2.6" xref="S3.E7.m1.1.1.1.1.2.2.2.6.cmml">e</mi></mrow></mrow></mrow><mspace width="1em" id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.3a.cmml"></mspace><mrow id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml"><msub id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><mover accent="true" id="S3.E7.m1.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml">r</mi><mo id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E7.m1.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.1.cmml">=</mo><mrow id="S3.E7.m1.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.3.cmml"><mfrac id="S3.E7.m1.2.2.2.2.3.2" xref="S3.E7.m1.2.2.2.2.3.2.cmml"><mn id="S3.E7.m1.2.2.2.2.3.2.2" xref="S3.E7.m1.2.2.2.2.3.2.2.cmml">1</mn><mrow id="S3.E7.m1.2.2.2.2.3.2.3" xref="S3.E7.m1.2.2.2.2.3.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.3.2.3.2" xref="S3.E7.m1.2.2.2.2.3.2.3.2.cmml">Z</mi><mo id="S3.E7.m1.2.2.2.2.3.2.3.1" xref="S3.E7.m1.2.2.2.2.3.2.3.1.cmml">+</mo><mn id="S3.E7.m1.2.2.2.2.3.2.3.3" xref="S3.E7.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.3.1" xref="S3.E7.m1.2.2.2.2.3.1.cmml">​</mo><mrow id="S3.E7.m1.2.2.2.2.3.3" xref="S3.E7.m1.2.2.2.2.3.3.cmml"><munderover id="S3.E7.m1.2.2.2.2.3.3.1" xref="S3.E7.m1.2.2.2.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E7.m1.2.2.2.2.3.3.1.2.2" xref="S3.E7.m1.2.2.2.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.2.2.2.2.3.3.1.2.3" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.3.3.1.2.3.2" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.2.cmml">τ</mi><mo id="S3.E7.m1.2.2.2.2.3.3.1.2.3.1" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.1.cmml">=</mo><mrow id="S3.E7.m1.2.2.2.2.3.3.1.2.3.3" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.cmml"><mi id="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.2" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.2.cmml">t</mi><mo id="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.1" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.1.cmml">−</mo><mi id="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.3" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.3.cmml">Z</mi></mrow></mrow><mrow id="S3.E7.m1.2.2.2.2.3.3.1.3" xref="S3.E7.m1.2.2.2.2.3.3.1.3.cmml"><mi id="S3.E7.m1.2.2.2.2.3.3.1.3.2" xref="S3.E7.m1.2.2.2.2.3.3.1.3.2.cmml">τ</mi><mo id="S3.E7.m1.2.2.2.2.3.3.1.3.1" xref="S3.E7.m1.2.2.2.2.3.3.1.3.1.cmml">=</mo><mi id="S3.E7.m1.2.2.2.2.3.3.1.3.3" xref="S3.E7.m1.2.2.2.2.3.3.1.3.3.cmml">t</mi></mrow></munderover><msub id="S3.E7.m1.2.2.2.2.3.3.2" xref="S3.E7.m1.2.2.2.2.3.3.2.cmml"><mi id="S3.E7.m1.2.2.2.2.3.3.2.2" xref="S3.E7.m1.2.2.2.2.3.3.2.2.cmml">r</mi><mi id="S3.E7.m1.2.2.2.2.3.3.2.3" xref="S3.E7.m1.2.2.2.2.3.3.2.3.cmml">τ</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.3a.cmml" xref="S3.E7.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><ci id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3">←</ci><apply id="S3.E7.m1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.4.2.cmml" xref="S3.E7.m1.1.1.1.1.4.2">𝜓</ci><apply id="S3.E7.m1.1.1.1.1.4.3.cmml" xref="S3.E7.m1.1.1.1.1.4.3"><plus id="S3.E7.m1.1.1.1.1.4.3.1.cmml" xref="S3.E7.m1.1.1.1.1.4.3.1"></plus><ci id="S3.E7.m1.1.1.1.1.4.3.2.cmml" xref="S3.E7.m1.1.1.1.1.4.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.1.1.1.1.4.3.3.cmml" xref="S3.E7.m1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S3.E7.m1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2"><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><minus id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3"></minus><apply id="S3.E7.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.4.2">𝜓</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.4.3">𝑡</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2"><times id="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.4.2">𝜂</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.4.3">𝐻</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2"><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3"><eq id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.2">𝜏</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3"><minus id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.1"></minus><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.2">𝑡</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3">𝑍</ci></apply></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3"><eq id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.1"></eq><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.2">𝜏</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.3.3.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2"><times id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑟</ci></apply><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4"><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.2">∇</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.2">𝜓</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.3">𝜏</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2"><times id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.1"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.2">𝑙</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.3">𝑜</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.4.2.4">𝑔</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.3">𝑃</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.2">𝐡</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E7.m1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2"><times id="S3.E7.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.1"></times><ci id="S3.E7.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2">𝑤</ci><ci id="S3.E7.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.3">ℎ</ci><ci id="S3.E7.m1.1.1.1.1.2.2.2.4.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.4">𝑒</ci><ci id="S3.E7.m1.1.1.1.1.2.2.2.5.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.5">𝑟</ci><ci id="S3.E7.m1.1.1.1.1.2.2.2.6.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.6">𝑒</ci></apply></list></apply><apply id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2"><eq id="S3.E7.m1.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.1"></eq><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2"><ci id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1">^</ci><ci id="S3.E7.m1.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2">𝑟</ci></apply><ci id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E7.m1.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.3"><times id="S3.E7.m1.2.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.3.1"></times><apply id="S3.E7.m1.2.2.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.3.2"><divide id="S3.E7.m1.2.2.2.2.3.2.1.cmml" xref="S3.E7.m1.2.2.2.2.3.2"></divide><cn type="integer" id="S3.E7.m1.2.2.2.2.3.2.2.cmml" xref="S3.E7.m1.2.2.2.2.3.2.2">1</cn><apply id="S3.E7.m1.2.2.2.2.3.2.3.cmml" xref="S3.E7.m1.2.2.2.2.3.2.3"><plus id="S3.E7.m1.2.2.2.2.3.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.3.2.3.1"></plus><ci id="S3.E7.m1.2.2.2.2.3.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.3.2.3.2">𝑍</ci><cn type="integer" id="S3.E7.m1.2.2.2.2.3.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E7.m1.2.2.2.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.3.3"><apply id="S3.E7.m1.2.2.2.2.3.3.1.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.3.3.1.1.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1">superscript</csymbol><apply id="S3.E7.m1.2.2.2.2.3.3.1.2.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.3.3.1.2.1.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1">subscript</csymbol><sum id="S3.E7.m1.2.2.2.2.3.3.1.2.2.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.2.2"></sum><apply id="S3.E7.m1.2.2.2.2.3.3.1.2.3.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3"><eq id="S3.E7.m1.2.2.2.2.3.3.1.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.1"></eq><ci id="S3.E7.m1.2.2.2.2.3.3.1.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.2">𝜏</ci><apply id="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.3"><minus id="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.1.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.1"></minus><ci id="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.2.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.2">𝑡</ci><ci id="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.3.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.2.3.3.3">𝑍</ci></apply></apply></apply><apply id="S3.E7.m1.2.2.2.2.3.3.1.3.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.3"><eq id="S3.E7.m1.2.2.2.2.3.3.1.3.1.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.3.1"></eq><ci id="S3.E7.m1.2.2.2.2.3.3.1.3.2.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.3.2">𝜏</ci><ci id="S3.E7.m1.2.2.2.2.3.3.1.3.3.cmml" xref="S3.E7.m1.2.2.2.2.3.3.1.3.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.3.3.2.cmml" xref="S3.E7.m1.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.3.3.2.1.cmml" xref="S3.E7.m1.2.2.2.2.3.3.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.3.3.2.2.cmml" xref="S3.E7.m1.2.2.2.2.3.3.2.2">𝑟</ci><ci id="S3.E7.m1.2.2.2.2.3.3.2.3.cmml" xref="S3.E7.m1.2.2.2.2.3.3.2.3">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">{\bf\psi}_{t+1}\leftarrow{\bf\psi}_{t}-\eta_{H}\sum\limits_{\tau=t-Z}^{\tau=t}(r_{\tau}-{\hat{r}}_{t})\nabla_{{\bf\psi}_{\tau}}log(P({\bf h}_{\tau}|{\bf\psi}_{\tau}))\quad where\quad{\hat{r}}_{t}=\frac{1}{Z+1}\sum\limits_{\tau=t-Z}^{\tau=t}r_{\tau}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.20" class="ltx_p">which is the update equation for <math id="S3.SS2.p1.18.m1.1" class="ltx_Math" alttext="{\bf\psi}" display="inline"><semantics id="S3.SS2.p1.18.m1.1a"><mi id="S3.SS2.p1.18.m1.1.1" xref="S3.SS2.p1.18.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m1.1b"><ci id="S3.SS2.p1.18.m1.1.1.cmml" xref="S3.SS2.p1.18.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m1.1c">{\bf\psi}</annotation></semantics></math> that we use. Even though we are using RL terminology, there are several fundamental differences between our problem and traditional RL problems. First, the setting is non-stationary as the same action in different rounds could lead to a different reward distribution. For example, large learning rates are appropriate towards the beginning of training but would increase the loss towards the end of training. In our scheme, this is reflected in the design of the baseline which weighs nearby rewards more heavily as these provide a more accurate baseline of the rewards at the current state of the learning problem. This non-stationary behavior can be modeled as a partially-observable Markov decision process <cite class="ltx_cite ltx_citemacro_citep">(Jaakkola et al., <a href="#bib.bib9" title="" class="ltx_ref">1995</a>)</cite>. While several techniques can be used to learn policies in non-stationary settings <cite class="ltx_cite ltx_citemacro_citep">(Padakandla et al., <a href="#bib.bib18" title="" class="ltx_ref">2019</a>; Abdallah &amp; Kaisers, <a href="#bib.bib1" title="" class="ltx_ref">2016</a>)</cite>, these methods are not online and require several trajectories (training runs in our case) to optimize the policy.
The second difference from traditional RL methods is that we do not seek to maximize the (discounted) sum of rewards, but rather, at each round <math id="S3.SS2.p1.19.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.19.m2.1a"><mi id="S3.SS2.p1.19.m2.1.1" xref="S3.SS2.p1.19.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.19.m2.1b"><ci id="S3.SS2.p1.19.m2.1.1.cmml" xref="S3.SS2.p1.19.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m2.1c">t</annotation></semantics></math>, we seek to maximize the rewards in a small interval <math id="S3.SS2.p1.20.m3.2" class="ltx_Math" alttext="[t-Z,t]" display="inline"><semantics id="S3.SS2.p1.20.m3.2a"><mrow id="S3.SS2.p1.20.m3.2.2.1" xref="S3.SS2.p1.20.m3.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p1.20.m3.2.2.1.2" xref="S3.SS2.p1.20.m3.2.2.2.cmml">[</mo><mrow id="S3.SS2.p1.20.m3.2.2.1.1" xref="S3.SS2.p1.20.m3.2.2.1.1.cmml"><mi id="S3.SS2.p1.20.m3.2.2.1.1.2" xref="S3.SS2.p1.20.m3.2.2.1.1.2.cmml">t</mi><mo id="S3.SS2.p1.20.m3.2.2.1.1.1" xref="S3.SS2.p1.20.m3.2.2.1.1.1.cmml">−</mo><mi id="S3.SS2.p1.20.m3.2.2.1.1.3" xref="S3.SS2.p1.20.m3.2.2.1.1.3.cmml">Z</mi></mrow><mo id="S3.SS2.p1.20.m3.2.2.1.3" xref="S3.SS2.p1.20.m3.2.2.2.cmml">,</mo><mi id="S3.SS2.p1.20.m3.1.1" xref="S3.SS2.p1.20.m3.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p1.20.m3.2.2.1.4" xref="S3.SS2.p1.20.m3.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m3.2b"><interval closure="closed" id="S3.SS2.p1.20.m3.2.2.2.cmml" xref="S3.SS2.p1.20.m3.2.2.1"><apply id="S3.SS2.p1.20.m3.2.2.1.1.cmml" xref="S3.SS2.p1.20.m3.2.2.1.1"><minus id="S3.SS2.p1.20.m3.2.2.1.1.1.cmml" xref="S3.SS2.p1.20.m3.2.2.1.1.1"></minus><ci id="S3.SS2.p1.20.m3.2.2.1.1.2.cmml" xref="S3.SS2.p1.20.m3.2.2.1.1.2">𝑡</ci><ci id="S3.SS2.p1.20.m3.2.2.1.1.3.cmml" xref="S3.SS2.p1.20.m3.2.2.1.1.3">𝑍</ci></apply><ci id="S3.SS2.p1.20.m3.1.1.cmml" xref="S3.SS2.p1.20.m3.1.1">𝑡</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m3.2c">[t-Z,t]</annotation></semantics></math> which is what allows us to formulate an online algorithm.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Full Algorithm and Practical Considerations</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p">Algorithm <a href="#alg1" title="Algorithm 1 ‣ Choosing the form of 𝑃⁢(ℋ|𝜓) ‣ 3.3 Full Algorithm and Practical Considerations ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> describes the FedAvg algorithm with our two contributions: representation matching and adaptive hyper-parameters. There are a couple of practical considerations that we address here:</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Evaluating the loss of the aggregate model:</h4>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px1.p1.1" class="ltx_p">After each round, the server needs to evaluate the loss of the aggregate model in order to obtain the reward signal (Line 15 in algorithm <a href="#alg1" title="Algorithm 1 ‣ Choosing the form of 𝑃⁢(ℋ|𝜓) ‣ 3.3 Full Algorithm and Practical Considerations ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). This could be done in two ways:1) The server maintains a small validation set on which it evaluates the loss. This validation set has to be representative of the clients’ data. Unlike the scheme in  <cite class="ltx_cite ltx_citemacro_citet">Zhao et al. (<a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite>, this validation set is not shared with the clients and can be collected from them in a secure way to avoid revealing the origin of each data point. 2) At the start of a round, the clients themselves evaluate the loss of the aggregate model on a small part of their training data and then send the scalar loss to the server. The server averages these losses to obtain an estimate of the loss. This estimate is good if the fraction of participating clients in the round is high, which would make the evaluated loss more representative of the loss across all clients. In our experiments, we use the first approach.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Choosing the form of <math id="S3.SS3.SSS0.Px2.1.m1.1" class="ltx_Math" alttext="P({\mathcal{H}}|{\bf\psi})" display="inline"><semantics id="S3.SS3.SSS0.Px2.1.m1.1b"><mrow id="S3.SS3.SSS0.Px2.1.m1.1.1" xref="S3.SS3.SSS0.Px2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.1.m1.1.1.3" xref="S3.SS3.SSS0.Px2.1.m1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.1.m1.1.1.2" xref="S3.SS3.SSS0.Px2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.3.cmml">ψ</mi></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.1.m1.1c"><apply id="S3.SS3.SSS0.Px2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.1.m1.1.1"><times id="S3.SS3.SSS0.Px2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.1.m1.1.1.2"></times><ci id="S3.SS3.SSS0.Px2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.1.m1.1.1.3">𝑃</ci><apply id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.2">ℋ</ci><ci id="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.1.m1.1.1.1.1.1.3">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.1.m1.1d">P({\mathcal{H}}|{\bf\psi})</annotation></semantics></math>
</h4>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px2.p1.17" class="ltx_p">: For <math id="S3.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">D</annotation></semantics></math> hyper-parameters, we use a discrete D-dimensional hyper-parameter space. For the <math id="S3.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="p^{th}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.1a"><msup id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml">p</mi><mrow id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.2">𝑝</ci><apply id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3"><times id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.1c">p^{th}</annotation></semantics></math> hyper-parameter, we have a finite set of allowable values <math id="S3.SS3.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="{\mathcal{H}}_{p}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">ℋ</mi><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.2">ℋ</ci><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">{\mathcal{H}}_{p}</annotation></semantics></math>. <math id="S3.SS3.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="{\mathcal{H}}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.4.m4.1c">{\mathcal{H}}</annotation></semantics></math> is a D-dimensional grid containing all possible combinations of the allowed values of the <math id="S3.SS3.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.5.m5.1c">D</annotation></semantics></math> hyper-parameter. <math id="S3.SS3.SSS0.Px2.p1.6.m6.2" class="ltx_Math" alttext="|{\mathcal{H}}|=\prod_{p=1}^{D}|{\mathcal{H}}_{p}|" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.6.m6.2a"><mrow id="S3.SS3.SSS0.Px2.p1.6.m6.2.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.cmml"><mrow id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.2.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.cmml">ℋ</mi><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.2.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.1.1.cmml">|</mo></mrow><mo rspace="0.111em" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.cmml">=</mo><mrow id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.cmml"><msubsup id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.cmml"><mo rspace="0em" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.2.cmml">∏</mo><mrow id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.2.cmml">p</mi><mo id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.3.cmml">D</mi></msubsup><mrow id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2.1.cmml">|</mo><msub id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.2.cmml">ℋ</mi><mi id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.3.cmml">p</mi></msub><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.6.m6.2b"><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2"><eq id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.2"></eq><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.2"><abs id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.3.2.1"></abs><ci id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1">ℋ</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1"><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.2">product</csymbol><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3"><eq id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.1"></eq><ci id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.2">𝑝</ci><cn type="integer" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.2.3">𝐷</ci></apply><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1"><abs id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.2"></abs><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.2">ℋ</ci><ci id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.1.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.6.m6.2c">|{\mathcal{H}}|=\prod_{p=1}^{D}|{\mathcal{H}}_{p}|</annotation></semantics></math>. For <math id="S3.SS3.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="P({\mathcal{H}}|{\bf\psi})" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.7.m7.1a"><mrow id="S3.SS3.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.3.cmml">ψ</mi></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.7.m7.1b"><apply id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1"><times id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.2"></times><ci id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.3">𝑃</ci><apply id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.2">ℋ</ci><ci id="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m7.1.1.1.1.1.3">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.7.m7.1c">P({\mathcal{H}}|{\bf\psi})</annotation></semantics></math> we use a D-dimensional discrete Gaussian. Let <math id="S3.SS3.SSS0.Px2.p1.8.m8.1" class="ltx_math_unparsed" alttext="\mathcal{N}(\bullet|{\bf\mu},{\bf A})" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.8.m8.1a"><mrow id="S3.SS3.SSS0.Px2.p1.8.m8.1b"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.8.m8.1.1">𝒩</mi><mrow id="S3.SS3.SSS0.Px2.p1.8.m8.1.2"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.8.m8.1.2.1">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.8.m8.1.2.2">∙</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.SSS0.Px2.p1.8.m8.1.2.3">|</mo><mi id="S3.SS3.SSS0.Px2.p1.8.m8.1.2.4">μ</mi><mo id="S3.SS3.SSS0.Px2.p1.8.m8.1.2.5">,</mo><mi id="S3.SS3.SSS0.Px2.p1.8.m8.1.2.6">𝐀</mi><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.8.m8.1.2.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.8.m8.1c">\mathcal{N}(\bullet|{\bf\mu},{\bf A})</annotation></semantics></math> be a standard(continuous) D-dimensional Gaussian with mean <math id="S3.SS3.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="{\bf\mu}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.9.m9.1a"><mi id="S3.SS3.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.9.m9.1b"><ci id="S3.SS3.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.9.m9.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.9.m9.1c">{\bf\mu}</annotation></semantics></math> and precision <math id="S3.SS3.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="{\bf A}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.10.m10.1a"><mi id="S3.SS3.SSS0.Px2.p1.10.m10.1.1" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.10.m10.1b"><ci id="S3.SS3.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.10.m10.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.10.m10.1c">{\bf A}</annotation></semantics></math>. Let <math id="S3.SS3.SSS0.Px2.p1.11.m11.3" class="ltx_Math" alttext="{\bf h}_{j}=(h_{j}^{1},\ldots,h_{j}^{D})" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.11.m11.3a"><mrow id="S3.SS3.SSS0.Px2.p1.11.m11.3.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.cmml"><msub id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.cmml"><mi id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.2" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.2.cmml">𝐡</mi><mi id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.3.cmml">j</mi></msub><mo id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.3.cmml">=</mo><mrow id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.3.cmml">(</mo><msubsup id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.2.cmml">h</mi><mi id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.3.cmml">j</mi><mn id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.4" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.SSS0.Px2.p1.11.m11.1.1" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.5" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.2" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.2.cmml">h</mi><mi id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.3.cmml">j</mi><mi id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.3" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.3.cmml">D</mi></msubsup><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.6" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.11.m11.3b"><apply id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3"><eq id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.3"></eq><apply id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.2">𝐡</ci><ci id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.4.3">𝑗</ci></apply><vector id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2"><apply id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.2">ℎ</ci><ci id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS3.SSS0.Px2.p1.11.m11.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.2">ℎ</ci><ci id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.2.3">𝑗</ci></apply><ci id="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.11.m11.3.3.2.2.2.3">𝐷</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.11.m11.3c">{\bf h}_{j}=(h_{j}^{1},\ldots,h_{j}^{D})</annotation></semantics></math> be a point on the grid <math id="S3.SS3.SSS0.Px2.p1.12.m12.1" class="ltx_Math" alttext="{\mathcal{H}}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.12.m12.1.1" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.12.m12.1b"><ci id="S3.SS3.SSS0.Px2.p1.12.m12.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.12.m12.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.12.m12.1c">{\mathcal{H}}</annotation></semantics></math>. <math id="S3.SS3.SSS0.Px2.p1.13.m13.4" class="ltx_Math" alttext="P({\bf h}_{j}|{\bf\psi})=\frac{1}{{\bf Z}}{\mathcal{N}}({\bf h}_{j}|{\bf\mu},{\bf A})" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.13.m13.4a"><mrow id="S3.SS3.SSS0.Px2.p1.13.m13.4.4" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.cmml"><mrow id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.cmml"><msub id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.3.cmml">ψ</mi></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.3.cmml">=</mo><mrow id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.cmml"><mfrac id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.cmml"><mn id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.2.cmml">1</mn><mi id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.3.cmml">𝐙</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.4" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.2a" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.cmml"><msub id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.3.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.13.m13.1.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1.cmml">μ</mi><mo id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.3.2.1" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.13.m13.2.2" xref="S3.SS3.SSS0.Px2.p1.13.m13.2.2.cmml">𝐀</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.13.m13.4b"><apply id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4"><eq id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.3"></eq><apply id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1"><times id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.2"></times><ci id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.3">𝑃</ci><apply id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.2">𝐡</ci><ci id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.3.3.1.1.1.1.3">𝜓</ci></apply></apply><apply id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2"><times id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.2"></times><apply id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3"><divide id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3"></divide><cn type="integer" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.2">1</cn><ci id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.3.3">𝐙</ci></apply><ci id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.4.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.4">𝒩</ci><apply id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.1">conditional</csymbol><apply id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.2">𝐡</ci><ci id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.2.3">𝑗</ci></apply><list id="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.4.4.2.1.1.1.3.2"><ci id="S3.SS3.SSS0.Px2.p1.13.m13.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.1.1">𝜇</ci><ci id="S3.SS3.SSS0.Px2.p1.13.m13.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.13.m13.2.2">𝐀</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.13.m13.4c">P({\bf h}_{j}|{\bf\psi})=\frac{1}{{\bf Z}}{\mathcal{N}}({\bf h}_{j}|{\bf\mu},{\bf A})</annotation></semantics></math> where <math id="S3.SS3.SSS0.Px2.p1.14.m14.2" class="ltx_Math" alttext="{\bf\psi}=\{{\bf\mu},{\bf A}\}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.14.m14.2a"><mrow id="S3.SS3.SSS0.Px2.p1.14.m14.2.3" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.2" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.2.cmml">ψ</mi><mo id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.1" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.1.cmml">=</mo><mrow id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.2" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.2.1" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.1.cmml">{</mo><mi id="S3.SS3.SSS0.Px2.p1.14.m14.1.1" xref="S3.SS3.SSS0.Px2.p1.14.m14.1.1.cmml">μ</mi><mo id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.2.2" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.14.m14.2.2" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.2.cmml">𝐀</mi><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.2.3" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.14.m14.2b"><apply id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3"><eq id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.1"></eq><ci id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.2">𝜓</ci><set id="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.3.3.2"><ci id="S3.SS3.SSS0.Px2.p1.14.m14.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m14.1.1">𝜇</ci><ci id="S3.SS3.SSS0.Px2.p1.14.m14.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.14.m14.2.2">𝐀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.14.m14.2c">{\bf\psi}=\{{\bf\mu},{\bf A}\}</annotation></semantics></math> and <math id="S3.SS3.SSS0.Px2.p1.15.m15.3" class="ltx_Math" alttext="{\bf Z}=\sum_{{\bf h}\in{\mathcal{H}}}{\mathcal{N}}({\bf h}|{\bf\mu},{\bf A})" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.15.m15.3a"><mrow id="S3.SS3.SSS0.Px2.p1.15.m15.3.3" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.3" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.3.cmml">𝐙</mi><mo rspace="0.111em" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.2.cmml">=</mo><mrow id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.cmml"><msub id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.cmml"><mo id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.2.cmml">𝐡</mi><mo id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.1" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.3" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.3.cmml">ℋ</mi></mrow></msub><mrow id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.3" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.2.cmml">𝐡</mi><mo fence="false" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.3.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.3.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.15.m15.1.1" xref="S3.SS3.SSS0.Px2.p1.15.m15.1.1.cmml">μ</mi><mo id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.3.2.1" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.15.m15.2.2" xref="S3.SS3.SSS0.Px2.p1.15.m15.2.2.cmml">𝐀</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.3" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.15.m15.3b"><apply id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3"><eq id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.2"></eq><ci id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.3">𝐙</ci><apply id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1"><apply id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2">subscript</csymbol><sum id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.2"></sum><apply id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3"><in id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.1"></in><ci id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.2">𝐡</ci><ci id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.2.3.3">ℋ</ci></apply></apply><apply id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1"><times id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.2"></times><ci id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.3">𝒩</ci><apply id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.2">𝐡</ci><list id="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.3.3.1.1.1.1.1.3.2"><ci id="S3.SS3.SSS0.Px2.p1.15.m15.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.1.1">𝜇</ci><ci id="S3.SS3.SSS0.Px2.p1.15.m15.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.15.m15.2.2">𝐀</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.15.m15.3c">{\bf Z}=\sum_{{\bf h}\in{\mathcal{H}}}{\mathcal{N}}({\bf h}|{\bf\mu},{\bf A})</annotation></semantics></math>. Since different hyper-parameters can have different scales, we shift and normalize the allowed values for each hyper-parameter so that they have zero mean and are in the range <math id="S3.SS3.SSS0.Px2.p1.16.m16.2" class="ltx_Math" alttext="[-0.5,0.5]" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.16.m16.2a"><mrow id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.2.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.2" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.2.cmml">[</mo><mrow id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1.cmml"><mo id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1a" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1.cmml">−</mo><mn id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1.2.cmml">0.5</mn></mrow><mo id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.3" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.2.cmml">,</mo><mn id="S3.SS3.SSS0.Px2.p1.16.m16.1.1" xref="S3.SS3.SSS0.Px2.p1.16.m16.1.1.cmml">0.5</mn><mo stretchy="false" id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.4" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.16.m16.2b"><interval closure="closed" id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1"><apply id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1"><minus id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1"></minus><cn type="float" id="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.16.m16.2.2.1.1.2">0.5</cn></apply><cn type="float" id="S3.SS3.SSS0.Px2.p1.16.m16.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.16.m16.1.1">0.5</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.16.m16.2c">[-0.5,0.5]</annotation></semantics></math> before constructing the grid. The grid of hyper-parameters <math id="S3.SS3.SSS0.Px2.p1.17.m17.1" class="ltx_Math" alttext="{\mathcal{H}}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p1.17.m17.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p1.17.m17.1.1" xref="S3.SS3.SSS0.Px2.p1.17.m17.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.17.m17.1b"><ci id="S3.SS3.SSS0.Px2.p1.17.m17.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.17.m17.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.17.m17.1c">{\mathcal{H}}</annotation></semantics></math> thus has zero-mean and the same scale in all dimensions. This increase the stability of the hyper-parameter tuning algorithm as the optimization space is uniform in all directions.</p>
</div>
<div id="S3.SS3.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.SSS0.Px2.p2.1" class="ltx_p">We choose a discrete hyper-parameter space <math id="S3.SS3.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="{\mathcal{H}}" display="inline"><semantics id="S3.SS3.SSS0.Px2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.1.m1.1c">{\mathcal{H}}</annotation></semantics></math> to force different hyper-parameter choices to be significantly different, which would provide more distinct reward signals to the online REINFORCE algorithm. The choice of a uni-modal distribution, such as the discrete Gaussian, encourages hyper-parameter exploration to focus on areas around the mode. This embodies the inductive bias that
the optimal hyper-parameter in one round is close to the optimal hyper-parameter in the previous round.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.12.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated averaging with representation matching and online hyper-parameter tuning. Setting with <math id="alg1.6.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.6.m1.1b"><mi id="alg1.6.m1.1.1" xref="alg1.6.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m1.1c"><ci id="alg1.6.m1.1.1.cmml" xref="alg1.6.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m1.1d">T</annotation></semantics></math> training rounds, <math id="alg1.7.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.7.m2.1b"><mi id="alg1.7.m2.1.1" xref="alg1.7.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.7.m2.1c"><ci id="alg1.7.m2.1.1.cmml" xref="alg1.7.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m2.1d">K</annotation></semantics></math> clients, <math id="alg1.8.m3.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="alg1.8.m3.1b"><msub id="alg1.8.m3.1.1" xref="alg1.8.m3.1.1.cmml"><mi id="alg1.8.m3.1.1.2" xref="alg1.8.m3.1.1.2.cmml">n</mi><mi id="alg1.8.m3.1.1.3" xref="alg1.8.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.8.m3.1c"><apply id="alg1.8.m3.1.1.cmml" xref="alg1.8.m3.1.1"><csymbol cd="ambiguous" id="alg1.8.m3.1.1.1.cmml" xref="alg1.8.m3.1.1">subscript</csymbol><ci id="alg1.8.m3.1.1.2.cmml" xref="alg1.8.m3.1.1.2">𝑛</ci><ci id="alg1.8.m3.1.1.3.cmml" xref="alg1.8.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m3.1d">n_{k}</annotation></semantics></math> datapoints per client, <math id="alg1.9.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.9.m4.1b"><mi id="alg1.9.m4.1.1" xref="alg1.9.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.9.m4.1c"><ci id="alg1.9.m4.1.1.cmml" xref="alg1.9.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m4.1d">N</annotation></semantics></math> total datapoints, and a fraction <math id="alg1.10.m5.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.10.m5.1b"><mi id="alg1.10.m5.1.1" xref="alg1.10.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m5.1c"><ci id="alg1.10.m5.1.1.cmml" xref="alg1.10.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m5.1d">C</annotation></semantics></math> of clients participating in each round</figcaption>
<div id="alg1.13" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>initialize <math id="alg1.l1.m1.1" class="ltx_Math" alttext="{\bf w}_{1}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">𝐰</mi><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝐰</ci><cn type="integer" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">{\bf w}_{1}</annotation></semantics></math> and <math id="alg1.l1.m2.3" class="ltx_Math" alttext="\theta^{1}_{1},\ldots,\theta^{K}_{1}" display="inline"><semantics id="alg1.l1.m2.3a"><mrow id="alg1.l1.m2.3.3.2" xref="alg1.l1.m2.3.3.3.cmml"><msubsup id="alg1.l1.m2.2.2.1.1" xref="alg1.l1.m2.2.2.1.1.cmml"><mi id="alg1.l1.m2.2.2.1.1.2.2" xref="alg1.l1.m2.2.2.1.1.2.2.cmml">θ</mi><mn id="alg1.l1.m2.2.2.1.1.3" xref="alg1.l1.m2.2.2.1.1.3.cmml">1</mn><mn id="alg1.l1.m2.2.2.1.1.2.3" xref="alg1.l1.m2.2.2.1.1.2.3.cmml">1</mn></msubsup><mo id="alg1.l1.m2.3.3.2.3" xref="alg1.l1.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">…</mi><mo id="alg1.l1.m2.3.3.2.4" xref="alg1.l1.m2.3.3.3.cmml">,</mo><msubsup id="alg1.l1.m2.3.3.2.2" xref="alg1.l1.m2.3.3.2.2.cmml"><mi id="alg1.l1.m2.3.3.2.2.2.2" xref="alg1.l1.m2.3.3.2.2.2.2.cmml">θ</mi><mn id="alg1.l1.m2.3.3.2.2.3" xref="alg1.l1.m2.3.3.2.2.3.cmml">1</mn><mi id="alg1.l1.m2.3.3.2.2.2.3" xref="alg1.l1.m2.3.3.2.2.2.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.3b"><list id="alg1.l1.m2.3.3.3.cmml" xref="alg1.l1.m2.3.3.2"><apply id="alg1.l1.m2.2.2.1.1.cmml" xref="alg1.l1.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.1.cmml" xref="alg1.l1.m2.2.2.1.1">subscript</csymbol><apply id="alg1.l1.m2.2.2.1.1.2.cmml" xref="alg1.l1.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.2.1.cmml" xref="alg1.l1.m2.2.2.1.1">superscript</csymbol><ci id="alg1.l1.m2.2.2.1.1.2.2.cmml" xref="alg1.l1.m2.2.2.1.1.2.2">𝜃</ci><cn type="integer" id="alg1.l1.m2.2.2.1.1.2.3.cmml" xref="alg1.l1.m2.2.2.1.1.2.3">1</cn></apply><cn type="integer" id="alg1.l1.m2.2.2.1.1.3.cmml" xref="alg1.l1.m2.2.2.1.1.3">1</cn></apply><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">…</ci><apply id="alg1.l1.m2.3.3.2.2.cmml" xref="alg1.l1.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m2.3.3.2.2.1.cmml" xref="alg1.l1.m2.3.3.2.2">subscript</csymbol><apply id="alg1.l1.m2.3.3.2.2.2.cmml" xref="alg1.l1.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m2.3.3.2.2.2.1.cmml" xref="alg1.l1.m2.3.3.2.2">superscript</csymbol><ci id="alg1.l1.m2.3.3.2.2.2.2.cmml" xref="alg1.l1.m2.3.3.2.2.2.2">𝜃</ci><ci id="alg1.l1.m2.3.3.2.2.2.3.cmml" xref="alg1.l1.m2.3.3.2.2.2.3">𝐾</ci></apply><cn type="integer" id="alg1.l1.m2.3.3.2.2.3.cmml" xref="alg1.l1.m2.3.3.2.2.3">1</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.3c">\theta^{1}_{1},\ldots,\theta^{K}_{1}</annotation></semantics></math> and <math id="alg1.l1.m3.1" class="ltx_Math" alttext="{\bf\psi}_{1}" display="inline"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">ψ</mi><mn id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝜓</ci><cn type="integer" id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">{\bf\psi}_{1}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="L_{1}\leftarrow Loss({\bf w}_{1})" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">L</mi><mn id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">←</mo><mrow id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.1.2" xref="alg1.l2.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l2.m1.1.1.1.4" xref="alg1.l2.m1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.1.2a" xref="alg1.l2.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l2.m1.1.1.1.5" xref="alg1.l2.m1.1.1.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.1.2b" xref="alg1.l2.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l2.m1.1.1.1.6" xref="alg1.l2.m1.1.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.1.2c" xref="alg1.l2.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l2.m1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.1.2.cmml">𝐰</mi><mn id="alg1.l2.m1.1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l2.m1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">←</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3">subscript</csymbol><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝐿</ci><cn type="integer" id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">1</cn></apply><apply id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"><times id="alg1.l2.m1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.2"></times><ci id="alg1.l2.m1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.3">𝐿</ci><ci id="alg1.l2.m1.1.1.1.4.cmml" xref="alg1.l2.m1.1.1.1.4">𝑜</ci><ci id="alg1.l2.m1.1.1.1.5.cmml" xref="alg1.l2.m1.1.1.1.5">𝑠</ci><ci id="alg1.l2.m1.1.1.1.6.cmml" xref="alg1.l2.m1.1.1.1.6">𝑠</ci><apply id="alg1.l2.m1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.2">𝐰</ci><cn type="integer" id="alg1.l2.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">L_{1}\leftarrow Loss({\bf w}_{1})</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span><span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">t</annotation></semantics></math>=<math id="alg1.l3.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="alg1.l3.m2.1a"><mn id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><cn type="integer" id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">1</annotation></semantics></math> to <math id="alg1.l3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l3.m3.1a"><mi id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><ci id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">T</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <math id="alg1.l4.m1.1" class="ltx_math_unparsed" alttext="{\bf h}_{t}\sim P(\bullet|{\bf\psi}_{t})" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1b"><msub id="alg1.l4.m1.1.1"><mi id="alg1.l4.m1.1.1.2">𝐡</mi><mi id="alg1.l4.m1.1.1.3">t</mi></msub><mo id="alg1.l4.m1.1.2">∼</mo><mi id="alg1.l4.m1.1.3">P</mi><mrow id="alg1.l4.m1.1.4"><mo stretchy="false" id="alg1.l4.m1.1.4.1">(</mo><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.4.2">∙</mo><mo fence="false" rspace="0.167em" stretchy="false" id="alg1.l4.m1.1.4.3">|</mo><msub id="alg1.l4.m1.1.4.4"><mi id="alg1.l4.m1.1.4.4.2">ψ</mi><mi id="alg1.l4.m1.1.4.4.3">t</mi></msub><mo stretchy="false" id="alg1.l4.m1.1.4.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">{\bf h}_{t}\sim P(\bullet|{\bf\psi}_{t})</annotation></semantics></math> <span id="alg1.l4.1" class="ltx_text" style="float:right;"><math id="alg1.l4.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l4.1.m1.1a"><mo id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\triangleright</annotation></semantics></math> Sample a set of hyper-parameters
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math id="alg1.l5.m1.1" class="ltx_Math" alttext="S_{t}\leftarrow" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">S</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑆</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">S_{t}\leftarrow</annotation></semantics></math>(random selection of <math id="alg1.l5.m2.1" class="ltx_Math" alttext="CK" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m2.1.1.1" xref="alg1.l5.m2.1.1.1.cmml">​</mo><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><times id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1"></times><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝐶</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">CK</annotation></semantics></math> clients)

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <span id="alg1.l6.3" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l6.m1.1" class="ltx_Math" alttext="i\in S_{t}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">i</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">∈</mo><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">S</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><in id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></in><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑖</ci><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝑆</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">i\in S_{t}</annotation></semantics></math> <span id="alg1.l6.4" class="ltx_text ltx_font_bold">do</span> <span id="alg1.l6.2" class="ltx_text" style="float:right;"><math id="alg1.l6.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation></semantics></math> Run in parallel in each client in <math id="alg1.l6.2.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="alg1.l6.2.m2.1a"><msub id="alg1.l6.2.m2.1.1" xref="alg1.l6.2.m2.1.1.cmml"><mi id="alg1.l6.2.m2.1.1.2" xref="alg1.l6.2.m2.1.1.2.cmml">S</mi><mi id="alg1.l6.2.m2.1.1.3" xref="alg1.l6.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.2.m2.1b"><apply id="alg1.l6.2.m2.1.1.cmml" xref="alg1.l6.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.2.m2.1.1.1.cmml" xref="alg1.l6.2.m2.1.1">subscript</csymbol><ci id="alg1.l6.2.m2.1.1.2.cmml" xref="alg1.l6.2.m2.1.1.2">𝑆</ci><ci id="alg1.l6.2.m2.1.1.3.cmml" xref="alg1.l6.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.2.m2.1c">S_{t}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>         <math id="alg1.l7.m1.1" class="ltx_Math" alttext="{\bf w}_{t}^{i}\leftarrow{\bf w}_{t}" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msubsup id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2.2" xref="alg1.l7.m1.1.1.2.2.2.cmml">𝐰</mi><mi id="alg1.l7.m1.1.1.2.2.3" xref="alg1.l7.m1.1.1.2.2.3.cmml">t</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">𝐰</mi><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">superscript</csymbol><apply id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.2.cmml" xref="alg1.l7.m1.1.1.2.2.2">𝐰</ci><ci id="alg1.l7.m1.1.1.2.2.3.cmml" xref="alg1.l7.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝐰</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">{\bf w}_{t}^{i}\leftarrow{\bf w}_{t}</annotation></semantics></math> <span id="alg1.l7.1" class="ltx_text" style="float:right;"><math id="alg1.l7.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation></semantics></math> Receive model parameters from server
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>         <span id="alg1.l8.3" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l8.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">n</annotation></semantics></math>=<math id="alg1.l8.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="alg1.l8.m2.1a"><mn id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><cn type="integer" id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">1</annotation></semantics></math> to <math id="alg1.l8.m3.1" class="ltx_Math" alttext="n\_iterations({\bf h}_{t})" display="inline"><semantics id="alg1.l8.m3.1a"><mrow id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml"><mi id="alg1.l8.m3.1.1.3" xref="alg1.l8.m3.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi mathvariant="normal" id="alg1.l8.m3.1.1.4" xref="alg1.l8.m3.1.1.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2a" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.5" xref="alg1.l8.m3.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2b" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.6" xref="alg1.l8.m3.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2c" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.7" xref="alg1.l8.m3.1.1.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2d" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.8" xref="alg1.l8.m3.1.1.8.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2e" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.9" xref="alg1.l8.m3.1.1.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2f" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.10" xref="alg1.l8.m3.1.1.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2g" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.11" xref="alg1.l8.m3.1.1.11.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2h" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.12" xref="alg1.l8.m3.1.1.12.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2i" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.13" xref="alg1.l8.m3.1.1.13.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2j" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mi id="alg1.l8.m3.1.1.14" xref="alg1.l8.m3.1.1.14.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m3.1.1.2k" xref="alg1.l8.m3.1.1.2.cmml">​</mo><mrow id="alg1.l8.m3.1.1.1.1" xref="alg1.l8.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m3.1.1.1.1.2" xref="alg1.l8.m3.1.1.1.1.1.cmml">(</mo><msub id="alg1.l8.m3.1.1.1.1.1" xref="alg1.l8.m3.1.1.1.1.1.cmml"><mi id="alg1.l8.m3.1.1.1.1.1.2" xref="alg1.l8.m3.1.1.1.1.1.2.cmml">𝐡</mi><mi id="alg1.l8.m3.1.1.1.1.1.3" xref="alg1.l8.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l8.m3.1.1.1.1.3" xref="alg1.l8.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b"><apply id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1"><times id="alg1.l8.m3.1.1.2.cmml" xref="alg1.l8.m3.1.1.2"></times><ci id="alg1.l8.m3.1.1.3.cmml" xref="alg1.l8.m3.1.1.3">𝑛</ci><ci id="alg1.l8.m3.1.1.4.cmml" xref="alg1.l8.m3.1.1.4">_</ci><ci id="alg1.l8.m3.1.1.5.cmml" xref="alg1.l8.m3.1.1.5">𝑖</ci><ci id="alg1.l8.m3.1.1.6.cmml" xref="alg1.l8.m3.1.1.6">𝑡</ci><ci id="alg1.l8.m3.1.1.7.cmml" xref="alg1.l8.m3.1.1.7">𝑒</ci><ci id="alg1.l8.m3.1.1.8.cmml" xref="alg1.l8.m3.1.1.8">𝑟</ci><ci id="alg1.l8.m3.1.1.9.cmml" xref="alg1.l8.m3.1.1.9">𝑎</ci><ci id="alg1.l8.m3.1.1.10.cmml" xref="alg1.l8.m3.1.1.10">𝑡</ci><ci id="alg1.l8.m3.1.1.11.cmml" xref="alg1.l8.m3.1.1.11">𝑖</ci><ci id="alg1.l8.m3.1.1.12.cmml" xref="alg1.l8.m3.1.1.12">𝑜</ci><ci id="alg1.l8.m3.1.1.13.cmml" xref="alg1.l8.m3.1.1.13">𝑛</ci><ci id="alg1.l8.m3.1.1.14.cmml" xref="alg1.l8.m3.1.1.14">𝑠</ci><apply id="alg1.l8.m3.1.1.1.1.1.cmml" xref="alg1.l8.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m3.1.1.1.1.1.1.cmml" xref="alg1.l8.m3.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m3.1.1.1.1.1.2.cmml" xref="alg1.l8.m3.1.1.1.1.1.2">𝐡</ci><ci id="alg1.l8.m3.1.1.1.1.1.3.cmml" xref="alg1.l8.m3.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">n\_iterations({\bf h}_{t})</annotation></semantics></math> <span id="alg1.l8.4" class="ltx_text ltx_font_bold">do</span> <span id="alg1.l8.2" class="ltx_text" style="float:right;"><math id="alg1.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation></semantics></math> Number of SGD iterations as defined in <math id="alg1.l8.2.m2.1" class="ltx_Math" alttext="{\bf h}_{t}" display="inline"><semantics id="alg1.l8.2.m2.1a"><msub id="alg1.l8.2.m2.1.1" xref="alg1.l8.2.m2.1.1.cmml"><mi id="alg1.l8.2.m2.1.1.2" xref="alg1.l8.2.m2.1.1.2.cmml">𝐡</mi><mi id="alg1.l8.2.m2.1.1.3" xref="alg1.l8.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.2.m2.1b"><apply id="alg1.l8.2.m2.1.1.cmml" xref="alg1.l8.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.2.m2.1.1.1.cmml" xref="alg1.l8.2.m2.1.1">subscript</csymbol><ci id="alg1.l8.2.m2.1.1.2.cmml" xref="alg1.l8.2.m2.1.1.2">𝐡</ci><ci id="alg1.l8.2.m2.1.1.3.cmml" xref="alg1.l8.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.2.m2.1c">{\bf h}_{t}</annotation></semantics></math>
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>              <math id="alg1.l9.m1.3" class="ltx_Math" alttext="({\bf X},Y)\leftarrow sample({\bf D}_{i})" display="inline"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml"><mrow id="alg1.l9.m1.3.3.3.2" xref="alg1.l9.m1.3.3.3.1.cmml"><mo stretchy="false" id="alg1.l9.m1.3.3.3.2.1" xref="alg1.l9.m1.3.3.3.1.cmml">(</mo><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">𝐗</mi><mo id="alg1.l9.m1.3.3.3.2.2" xref="alg1.l9.m1.3.3.3.1.cmml">,</mo><mi id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml">Y</mi><mo stretchy="false" id="alg1.l9.m1.3.3.3.2.3" xref="alg1.l9.m1.3.3.3.1.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l9.m1.3.3.2" xref="alg1.l9.m1.3.3.2.cmml">←</mo><mrow id="alg1.l9.m1.3.3.1" xref="alg1.l9.m1.3.3.1.cmml"><mi id="alg1.l9.m1.3.3.1.3" xref="alg1.l9.m1.3.3.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.1.2" xref="alg1.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg1.l9.m1.3.3.1.4" xref="alg1.l9.m1.3.3.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.1.2a" xref="alg1.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg1.l9.m1.3.3.1.5" xref="alg1.l9.m1.3.3.1.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.1.2b" xref="alg1.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg1.l9.m1.3.3.1.6" xref="alg1.l9.m1.3.3.1.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.1.2c" xref="alg1.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg1.l9.m1.3.3.1.7" xref="alg1.l9.m1.3.3.1.7.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.1.2d" xref="alg1.l9.m1.3.3.1.2.cmml">​</mo><mi id="alg1.l9.m1.3.3.1.8" xref="alg1.l9.m1.3.3.1.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.1.2e" xref="alg1.l9.m1.3.3.1.2.cmml">​</mo><mrow id="alg1.l9.m1.3.3.1.1.1" xref="alg1.l9.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.3.3.1.1.1.2" xref="alg1.l9.m1.3.3.1.1.1.1.cmml">(</mo><msub id="alg1.l9.m1.3.3.1.1.1.1" xref="alg1.l9.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l9.m1.3.3.1.1.1.1.2" xref="alg1.l9.m1.3.3.1.1.1.1.2.cmml">𝐃</mi><mi id="alg1.l9.m1.3.3.1.1.1.1.3" xref="alg1.l9.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l9.m1.3.3.1.1.1.3" xref="alg1.l9.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3"><ci id="alg1.l9.m1.3.3.2.cmml" xref="alg1.l9.m1.3.3.2">←</ci><interval closure="open" id="alg1.l9.m1.3.3.3.1.cmml" xref="alg1.l9.m1.3.3.3.2"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝐗</ci><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">𝑌</ci></interval><apply id="alg1.l9.m1.3.3.1.cmml" xref="alg1.l9.m1.3.3.1"><times id="alg1.l9.m1.3.3.1.2.cmml" xref="alg1.l9.m1.3.3.1.2"></times><ci id="alg1.l9.m1.3.3.1.3.cmml" xref="alg1.l9.m1.3.3.1.3">𝑠</ci><ci id="alg1.l9.m1.3.3.1.4.cmml" xref="alg1.l9.m1.3.3.1.4">𝑎</ci><ci id="alg1.l9.m1.3.3.1.5.cmml" xref="alg1.l9.m1.3.3.1.5">𝑚</ci><ci id="alg1.l9.m1.3.3.1.6.cmml" xref="alg1.l9.m1.3.3.1.6">𝑝</ci><ci id="alg1.l9.m1.3.3.1.7.cmml" xref="alg1.l9.m1.3.3.1.7">𝑙</ci><ci id="alg1.l9.m1.3.3.1.8.cmml" xref="alg1.l9.m1.3.3.1.8">𝑒</ci><apply id="alg1.l9.m1.3.3.1.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l9.m1.3.3.1.1.1.1.2">𝐃</ci><ci id="alg1.l9.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l9.m1.3.3.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">({\bf X},Y)\leftarrow sample({\bf D}_{i})</annotation></semantics></math> <span id="alg1.l9.1" class="ltx_text" style="float:right;"><math id="alg1.l9.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l9.1.m1.1a"><mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\triangleright</annotation></semantics></math> Sample a training mini-batch
</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>              <math id="alg1.l10.m1.12" class="ltx_Math" alttext="[{\bf w}_{t}^{i},{\bf\theta}_{t}^{i}]\leftarrow[{\bf w}_{t}^{i},{\bf\theta}_{t}^{i}]-\eta({\bf h}_{t})\nabla_{[{\bf w}_{t}^{i},{\bf\theta}_{t}^{i}]}{\mathcal{L}}_{i}({\bf X},Y;{\bf w}_{t}^{i},{\bf w}_{t},{\bf\theta}_{t}^{i})" display="inline"><semantics id="alg1.l10.m1.12a"><mrow id="alg1.l10.m1.12.12" xref="alg1.l10.m1.12.12.cmml"><mrow id="alg1.l10.m1.6.6.2.2" xref="alg1.l10.m1.6.6.2.3.cmml"><mo stretchy="false" id="alg1.l10.m1.6.6.2.2.3" xref="alg1.l10.m1.6.6.2.3.cmml">[</mo><msubsup id="alg1.l10.m1.5.5.1.1.1" xref="alg1.l10.m1.5.5.1.1.1.cmml"><mi id="alg1.l10.m1.5.5.1.1.1.2.2" xref="alg1.l10.m1.5.5.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l10.m1.5.5.1.1.1.2.3" xref="alg1.l10.m1.5.5.1.1.1.2.3.cmml">t</mi><mi id="alg1.l10.m1.5.5.1.1.1.3" xref="alg1.l10.m1.5.5.1.1.1.3.cmml">i</mi></msubsup><mo id="alg1.l10.m1.6.6.2.2.4" xref="alg1.l10.m1.6.6.2.3.cmml">,</mo><msubsup id="alg1.l10.m1.6.6.2.2.2" xref="alg1.l10.m1.6.6.2.2.2.cmml"><mi id="alg1.l10.m1.6.6.2.2.2.2.2" xref="alg1.l10.m1.6.6.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l10.m1.6.6.2.2.2.2.3" xref="alg1.l10.m1.6.6.2.2.2.2.3.cmml">t</mi><mi id="alg1.l10.m1.6.6.2.2.2.3" xref="alg1.l10.m1.6.6.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l10.m1.6.6.2.2.5" xref="alg1.l10.m1.6.6.2.3.cmml">]</mo></mrow><mo stretchy="false" id="alg1.l10.m1.12.12.9" xref="alg1.l10.m1.12.12.9.cmml">←</mo><mrow id="alg1.l10.m1.12.12.8" xref="alg1.l10.m1.12.12.8.cmml"><mrow id="alg1.l10.m1.8.8.4.2.2" xref="alg1.l10.m1.8.8.4.2.3.cmml"><mo stretchy="false" id="alg1.l10.m1.8.8.4.2.2.3" xref="alg1.l10.m1.8.8.4.2.3.cmml">[</mo><msubsup id="alg1.l10.m1.7.7.3.1.1.1" xref="alg1.l10.m1.7.7.3.1.1.1.cmml"><mi id="alg1.l10.m1.7.7.3.1.1.1.2.2" xref="alg1.l10.m1.7.7.3.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l10.m1.7.7.3.1.1.1.2.3" xref="alg1.l10.m1.7.7.3.1.1.1.2.3.cmml">t</mi><mi id="alg1.l10.m1.7.7.3.1.1.1.3" xref="alg1.l10.m1.7.7.3.1.1.1.3.cmml">i</mi></msubsup><mo id="alg1.l10.m1.8.8.4.2.2.4" xref="alg1.l10.m1.8.8.4.2.3.cmml">,</mo><msubsup id="alg1.l10.m1.8.8.4.2.2.2" xref="alg1.l10.m1.8.8.4.2.2.2.cmml"><mi id="alg1.l10.m1.8.8.4.2.2.2.2.2" xref="alg1.l10.m1.8.8.4.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l10.m1.8.8.4.2.2.2.2.3" xref="alg1.l10.m1.8.8.4.2.2.2.2.3.cmml">t</mi><mi id="alg1.l10.m1.8.8.4.2.2.2.3" xref="alg1.l10.m1.8.8.4.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l10.m1.8.8.4.2.2.5" xref="alg1.l10.m1.8.8.4.2.3.cmml">]</mo></mrow><mo id="alg1.l10.m1.12.12.8.7" xref="alg1.l10.m1.12.12.8.7.cmml">−</mo><mrow id="alg1.l10.m1.12.12.8.6" xref="alg1.l10.m1.12.12.8.6.cmml"><mi id="alg1.l10.m1.12.12.8.6.6" xref="alg1.l10.m1.12.12.8.6.6.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.12.12.8.6.5" xref="alg1.l10.m1.12.12.8.6.5.cmml">​</mo><mrow id="alg1.l10.m1.9.9.5.3.1.1" xref="alg1.l10.m1.9.9.5.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.9.9.5.3.1.1.2" xref="alg1.l10.m1.9.9.5.3.1.1.1.cmml">(</mo><msub id="alg1.l10.m1.9.9.5.3.1.1.1" xref="alg1.l10.m1.9.9.5.3.1.1.1.cmml"><mi id="alg1.l10.m1.9.9.5.3.1.1.1.2" xref="alg1.l10.m1.9.9.5.3.1.1.1.2.cmml">𝐡</mi><mi id="alg1.l10.m1.9.9.5.3.1.1.1.3" xref="alg1.l10.m1.9.9.5.3.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l10.m1.9.9.5.3.1.1.3" xref="alg1.l10.m1.9.9.5.3.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="alg1.l10.m1.12.12.8.6.5a" xref="alg1.l10.m1.12.12.8.6.5.cmml">​</mo><mrow id="alg1.l10.m1.12.12.8.6.7" xref="alg1.l10.m1.12.12.8.6.7.cmml"><msub id="alg1.l10.m1.12.12.8.6.7.1" xref="alg1.l10.m1.12.12.8.6.7.1.cmml"><mo rspace="0.167em" id="alg1.l10.m1.12.12.8.6.7.1.2" xref="alg1.l10.m1.12.12.8.6.7.1.2.cmml">∇</mo><mrow id="alg1.l10.m1.2.2.2.2" xref="alg1.l10.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.3.cmml">[</mo><msubsup id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.2.2" xref="alg1.l10.m1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l10.m1.1.1.1.1.1.2.3" xref="alg1.l10.m1.1.1.1.1.1.2.3.cmml">t</mi><mi id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="alg1.l10.m1.2.2.2.2.4" xref="alg1.l10.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l10.m1.2.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.2.3.cmml">t</mi><mi id="alg1.l10.m1.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l10.m1.2.2.2.2.5" xref="alg1.l10.m1.2.2.2.3.cmml">]</mo></mrow></msub><msub id="alg1.l10.m1.12.12.8.6.7.2" xref="alg1.l10.m1.12.12.8.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.12.12.8.6.7.2.2" xref="alg1.l10.m1.12.12.8.6.7.2.2.cmml">ℒ</mi><mi id="alg1.l10.m1.12.12.8.6.7.2.3" xref="alg1.l10.m1.12.12.8.6.7.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l10.m1.12.12.8.6.5b" xref="alg1.l10.m1.12.12.8.6.5.cmml">​</mo><mrow id="alg1.l10.m1.12.12.8.6.4.3" xref="alg1.l10.m1.12.12.8.6.4.4.cmml"><mo stretchy="false" id="alg1.l10.m1.12.12.8.6.4.3.4" xref="alg1.l10.m1.12.12.8.6.4.4.cmml">(</mo><mi id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml">𝐗</mi><mo id="alg1.l10.m1.12.12.8.6.4.3.5" xref="alg1.l10.m1.12.12.8.6.4.4.cmml">,</mo><mi id="alg1.l10.m1.4.4" xref="alg1.l10.m1.4.4.cmml">Y</mi><mo id="alg1.l10.m1.12.12.8.6.4.3.6" xref="alg1.l10.m1.12.12.8.6.4.4.cmml">;</mo><msubsup id="alg1.l10.m1.10.10.6.4.2.1.1" xref="alg1.l10.m1.10.10.6.4.2.1.1.cmml"><mi id="alg1.l10.m1.10.10.6.4.2.1.1.2.2" xref="alg1.l10.m1.10.10.6.4.2.1.1.2.2.cmml">𝐰</mi><mi id="alg1.l10.m1.10.10.6.4.2.1.1.2.3" xref="alg1.l10.m1.10.10.6.4.2.1.1.2.3.cmml">t</mi><mi id="alg1.l10.m1.10.10.6.4.2.1.1.3" xref="alg1.l10.m1.10.10.6.4.2.1.1.3.cmml">i</mi></msubsup><mo id="alg1.l10.m1.12.12.8.6.4.3.7" xref="alg1.l10.m1.12.12.8.6.4.4.cmml">,</mo><msub id="alg1.l10.m1.11.11.7.5.3.2.2" xref="alg1.l10.m1.11.11.7.5.3.2.2.cmml"><mi id="alg1.l10.m1.11.11.7.5.3.2.2.2" xref="alg1.l10.m1.11.11.7.5.3.2.2.2.cmml">𝐰</mi><mi id="alg1.l10.m1.11.11.7.5.3.2.2.3" xref="alg1.l10.m1.11.11.7.5.3.2.2.3.cmml">t</mi></msub><mo id="alg1.l10.m1.12.12.8.6.4.3.8" xref="alg1.l10.m1.12.12.8.6.4.4.cmml">,</mo><msubsup id="alg1.l10.m1.12.12.8.6.4.3.3" xref="alg1.l10.m1.12.12.8.6.4.3.3.cmml"><mi id="alg1.l10.m1.12.12.8.6.4.3.3.2.2" xref="alg1.l10.m1.12.12.8.6.4.3.3.2.2.cmml">θ</mi><mi id="alg1.l10.m1.12.12.8.6.4.3.3.2.3" xref="alg1.l10.m1.12.12.8.6.4.3.3.2.3.cmml">t</mi><mi id="alg1.l10.m1.12.12.8.6.4.3.3.3" xref="alg1.l10.m1.12.12.8.6.4.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l10.m1.12.12.8.6.4.3.9" xref="alg1.l10.m1.12.12.8.6.4.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.12b"><apply id="alg1.l10.m1.12.12.cmml" xref="alg1.l10.m1.12.12"><ci id="alg1.l10.m1.12.12.9.cmml" xref="alg1.l10.m1.12.12.9">←</ci><interval closure="closed" id="alg1.l10.m1.6.6.2.3.cmml" xref="alg1.l10.m1.6.6.2.2"><apply id="alg1.l10.m1.5.5.1.1.1.cmml" xref="alg1.l10.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.5.5.1.1.1.1.cmml" xref="alg1.l10.m1.5.5.1.1.1">superscript</csymbol><apply id="alg1.l10.m1.5.5.1.1.1.2.cmml" xref="alg1.l10.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.5.5.1.1.1.2.1.cmml" xref="alg1.l10.m1.5.5.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.5.5.1.1.1.2.2.cmml" xref="alg1.l10.m1.5.5.1.1.1.2.2">𝐰</ci><ci id="alg1.l10.m1.5.5.1.1.1.2.3.cmml" xref="alg1.l10.m1.5.5.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.5.5.1.1.1.3.cmml" xref="alg1.l10.m1.5.5.1.1.1.3">𝑖</ci></apply><apply id="alg1.l10.m1.6.6.2.2.2.cmml" xref="alg1.l10.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.6.6.2.2.2.1.cmml" xref="alg1.l10.m1.6.6.2.2.2">superscript</csymbol><apply id="alg1.l10.m1.6.6.2.2.2.2.cmml" xref="alg1.l10.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.6.6.2.2.2.2.1.cmml" xref="alg1.l10.m1.6.6.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.6.6.2.2.2.2.2.cmml" xref="alg1.l10.m1.6.6.2.2.2.2.2">𝜃</ci><ci id="alg1.l10.m1.6.6.2.2.2.2.3.cmml" xref="alg1.l10.m1.6.6.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.6.6.2.2.2.3.cmml" xref="alg1.l10.m1.6.6.2.2.2.3">𝑖</ci></apply></interval><apply id="alg1.l10.m1.12.12.8.cmml" xref="alg1.l10.m1.12.12.8"><minus id="alg1.l10.m1.12.12.8.7.cmml" xref="alg1.l10.m1.12.12.8.7"></minus><interval closure="closed" id="alg1.l10.m1.8.8.4.2.3.cmml" xref="alg1.l10.m1.8.8.4.2.2"><apply id="alg1.l10.m1.7.7.3.1.1.1.cmml" xref="alg1.l10.m1.7.7.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.7.7.3.1.1.1.1.cmml" xref="alg1.l10.m1.7.7.3.1.1.1">superscript</csymbol><apply id="alg1.l10.m1.7.7.3.1.1.1.2.cmml" xref="alg1.l10.m1.7.7.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.7.7.3.1.1.1.2.1.cmml" xref="alg1.l10.m1.7.7.3.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.7.7.3.1.1.1.2.2.cmml" xref="alg1.l10.m1.7.7.3.1.1.1.2.2">𝐰</ci><ci id="alg1.l10.m1.7.7.3.1.1.1.2.3.cmml" xref="alg1.l10.m1.7.7.3.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.7.7.3.1.1.1.3.cmml" xref="alg1.l10.m1.7.7.3.1.1.1.3">𝑖</ci></apply><apply id="alg1.l10.m1.8.8.4.2.2.2.cmml" xref="alg1.l10.m1.8.8.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.8.8.4.2.2.2.1.cmml" xref="alg1.l10.m1.8.8.4.2.2.2">superscript</csymbol><apply id="alg1.l10.m1.8.8.4.2.2.2.2.cmml" xref="alg1.l10.m1.8.8.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.8.8.4.2.2.2.2.1.cmml" xref="alg1.l10.m1.8.8.4.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.8.8.4.2.2.2.2.2.cmml" xref="alg1.l10.m1.8.8.4.2.2.2.2.2">𝜃</ci><ci id="alg1.l10.m1.8.8.4.2.2.2.2.3.cmml" xref="alg1.l10.m1.8.8.4.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.8.8.4.2.2.2.3.cmml" xref="alg1.l10.m1.8.8.4.2.2.2.3">𝑖</ci></apply></interval><apply id="alg1.l10.m1.12.12.8.6.cmml" xref="alg1.l10.m1.12.12.8.6"><times id="alg1.l10.m1.12.12.8.6.5.cmml" xref="alg1.l10.m1.12.12.8.6.5"></times><ci id="alg1.l10.m1.12.12.8.6.6.cmml" xref="alg1.l10.m1.12.12.8.6.6">𝜂</ci><apply id="alg1.l10.m1.9.9.5.3.1.1.1.cmml" xref="alg1.l10.m1.9.9.5.3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.9.9.5.3.1.1.1.1.cmml" xref="alg1.l10.m1.9.9.5.3.1.1">subscript</csymbol><ci id="alg1.l10.m1.9.9.5.3.1.1.1.2.cmml" xref="alg1.l10.m1.9.9.5.3.1.1.1.2">𝐡</ci><ci id="alg1.l10.m1.9.9.5.3.1.1.1.3.cmml" xref="alg1.l10.m1.9.9.5.3.1.1.1.3">𝑡</ci></apply><apply id="alg1.l10.m1.12.12.8.6.7.cmml" xref="alg1.l10.m1.12.12.8.6.7"><apply id="alg1.l10.m1.12.12.8.6.7.1.cmml" xref="alg1.l10.m1.12.12.8.6.7.1"><csymbol cd="ambiguous" id="alg1.l10.m1.12.12.8.6.7.1.1.cmml" xref="alg1.l10.m1.12.12.8.6.7.1">subscript</csymbol><ci id="alg1.l10.m1.12.12.8.6.7.1.2.cmml" xref="alg1.l10.m1.12.12.8.6.7.1.2">∇</ci><interval closure="closed" id="alg1.l10.m1.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2"><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.l10.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l10.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="alg1.l10.m1.12.12.8.6.7.2.cmml" xref="alg1.l10.m1.12.12.8.6.7.2"><csymbol cd="ambiguous" id="alg1.l10.m1.12.12.8.6.7.2.1.cmml" xref="alg1.l10.m1.12.12.8.6.7.2">subscript</csymbol><ci id="alg1.l10.m1.12.12.8.6.7.2.2.cmml" xref="alg1.l10.m1.12.12.8.6.7.2.2">ℒ</ci><ci id="alg1.l10.m1.12.12.8.6.7.2.3.cmml" xref="alg1.l10.m1.12.12.8.6.7.2.3">𝑖</ci></apply></apply><vector id="alg1.l10.m1.12.12.8.6.4.4.cmml" xref="alg1.l10.m1.12.12.8.6.4.3"><ci id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3">𝐗</ci><ci id="alg1.l10.m1.4.4.cmml" xref="alg1.l10.m1.4.4">𝑌</ci><apply id="alg1.l10.m1.10.10.6.4.2.1.1.cmml" xref="alg1.l10.m1.10.10.6.4.2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.6.4.2.1.1.1.cmml" xref="alg1.l10.m1.10.10.6.4.2.1.1">superscript</csymbol><apply id="alg1.l10.m1.10.10.6.4.2.1.1.2.cmml" xref="alg1.l10.m1.10.10.6.4.2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.10.10.6.4.2.1.1.2.1.cmml" xref="alg1.l10.m1.10.10.6.4.2.1.1">subscript</csymbol><ci id="alg1.l10.m1.10.10.6.4.2.1.1.2.2.cmml" xref="alg1.l10.m1.10.10.6.4.2.1.1.2.2">𝐰</ci><ci id="alg1.l10.m1.10.10.6.4.2.1.1.2.3.cmml" xref="alg1.l10.m1.10.10.6.4.2.1.1.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.10.10.6.4.2.1.1.3.cmml" xref="alg1.l10.m1.10.10.6.4.2.1.1.3">𝑖</ci></apply><apply id="alg1.l10.m1.11.11.7.5.3.2.2.cmml" xref="alg1.l10.m1.11.11.7.5.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.11.11.7.5.3.2.2.1.cmml" xref="alg1.l10.m1.11.11.7.5.3.2.2">subscript</csymbol><ci id="alg1.l10.m1.11.11.7.5.3.2.2.2.cmml" xref="alg1.l10.m1.11.11.7.5.3.2.2.2">𝐰</ci><ci id="alg1.l10.m1.11.11.7.5.3.2.2.3.cmml" xref="alg1.l10.m1.11.11.7.5.3.2.2.3">𝑡</ci></apply><apply id="alg1.l10.m1.12.12.8.6.4.3.3.cmml" xref="alg1.l10.m1.12.12.8.6.4.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.12.12.8.6.4.3.3.1.cmml" xref="alg1.l10.m1.12.12.8.6.4.3.3">superscript</csymbol><apply id="alg1.l10.m1.12.12.8.6.4.3.3.2.cmml" xref="alg1.l10.m1.12.12.8.6.4.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.12.12.8.6.4.3.3.2.1.cmml" xref="alg1.l10.m1.12.12.8.6.4.3.3">subscript</csymbol><ci id="alg1.l10.m1.12.12.8.6.4.3.3.2.2.cmml" xref="alg1.l10.m1.12.12.8.6.4.3.3.2.2">𝜃</ci><ci id="alg1.l10.m1.12.12.8.6.4.3.3.2.3.cmml" xref="alg1.l10.m1.12.12.8.6.4.3.3.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.12.12.8.6.4.3.3.3.cmml" xref="alg1.l10.m1.12.12.8.6.4.3.3.3">𝑖</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.12c">[{\bf w}_{t}^{i},{\bf\theta}_{t}^{i}]\leftarrow[{\bf w}_{t}^{i},{\bf\theta}_{t}^{i}]-\eta({\bf h}_{t})\nabla_{[{\bf w}_{t}^{i},{\bf\theta}_{t}^{i}]}{\mathcal{L}}_{i}({\bf X},Y;{\bf w}_{t}^{i},{\bf w}_{t},{\bf\theta}_{t}^{i})</annotation></semantics></math> <span id="alg1.l10.2" class="ltx_text" style="float:right;"><math id="alg1.l10.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation></semantics></math> <math id="alg1.l10.2.m2.1" class="ltx_Math" alttext="{\mathcal{L}}_{i}" display="inline"><semantics id="alg1.l10.2.m2.1a"><msub id="alg1.l10.2.m2.1.1" xref="alg1.l10.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.2.m2.1.1.2" xref="alg1.l10.2.m2.1.1.2.cmml">ℒ</mi><mi id="alg1.l10.2.m2.1.1.3" xref="alg1.l10.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.2.m2.1b"><apply id="alg1.l10.2.m2.1.1.cmml" xref="alg1.l10.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.2.m2.1.1.1.cmml" xref="alg1.l10.2.m2.1.1">subscript</csymbol><ci id="alg1.l10.2.m2.1.1.2.cmml" xref="alg1.l10.2.m2.1.1.2">ℒ</ci><ci id="alg1.l10.2.m2.1.1.3.cmml" xref="alg1.l10.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.2.m2.1c">{\mathcal{L}}_{i}</annotation></semantics></math> as defined in Eq. <a href="#S3.E2" title="In 3.1 Representation Matching ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>
</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>         <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>         <math id="alg1.l12.m1.1" class="ltx_Math" alttext="{\bf\theta}_{t+1}^{i}\leftarrow{\bf\theta}_{t}^{i}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msubsup id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2.2" xref="alg1.l12.m1.1.1.2.2.2.cmml">θ</mi><mrow id="alg1.l12.m1.1.1.2.2.3" xref="alg1.l12.m1.1.1.2.2.3.cmml"><mi id="alg1.l12.m1.1.1.2.2.3.2" xref="alg1.l12.m1.1.1.2.2.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.2.2.3.1" xref="alg1.l12.m1.1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.2.2.3.3" xref="alg1.l12.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><msubsup id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l12.m1.1.1.3.2.3" xref="alg1.l12.m1.1.1.3.2.3.cmml">t</mi><mi id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml">i</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">superscript</csymbol><apply id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.2.1.cmml" xref="alg1.l12.m1.1.1.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.2.cmml" xref="alg1.l12.m1.1.1.2.2.2">𝜃</ci><apply id="alg1.l12.m1.1.1.2.2.3.cmml" xref="alg1.l12.m1.1.1.2.2.3"><plus id="alg1.l12.m1.1.1.2.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.2.3.1"></plus><ci id="alg1.l12.m1.1.1.2.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l12.m1.1.1.2.2.3.3.cmml" xref="alg1.l12.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">superscript</csymbol><apply id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2">𝜃</ci><ci id="alg1.l12.m1.1.1.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">{\bf\theta}_{t+1}^{i}\leftarrow{\bf\theta}_{t}^{i}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <math id="alg1.l14.m1.1" class="ltx_Math" alttext="{\bf w}_{t+1}\leftarrow{\bf w}_{t}+\sum\limits_{i\in S_{t}}\frac{n_{k}}{N}({\bf w}_{t}^{i}-{\bf w}_{t})" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">𝐰</mi><mrow id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml"><mi id="alg1.l14.m1.1.1.3.3.2" xref="alg1.l14.m1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l14.m1.1.1.3.3.1" xref="alg1.l14.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l14.m1.1.1.3.3.3" xref="alg1.l14.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">←</mo><mrow id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml"><msub id="alg1.l14.m1.1.1.1.3" xref="alg1.l14.m1.1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.3.2.cmml">𝐰</mi><mi id="alg1.l14.m1.1.1.1.3.3" xref="alg1.l14.m1.1.1.1.3.3.cmml">t</mi></msub><mo rspace="0.055em" id="alg1.l14.m1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml"><munder id="alg1.l14.m1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.2.cmml"><mo movablelimits="false" id="alg1.l14.m1.1.1.1.1.2.2" xref="alg1.l14.m1.1.1.1.1.2.2.cmml">∑</mo><mrow id="alg1.l14.m1.1.1.1.1.2.3" xref="alg1.l14.m1.1.1.1.1.2.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.2.3.2" xref="alg1.l14.m1.1.1.1.1.2.3.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.1.1.2.3.1" xref="alg1.l14.m1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="alg1.l14.m1.1.1.1.1.2.3.3" xref="alg1.l14.m1.1.1.1.1.2.3.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.2.3.3.2" xref="alg1.l14.m1.1.1.1.1.2.3.3.2.cmml">S</mi><mi id="alg1.l14.m1.1.1.1.1.2.3.3.3" xref="alg1.l14.m1.1.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></munder><mrow id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.cmml"><mfrac id="alg1.l14.m1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.3.cmml"><msub id="alg1.l14.m1.1.1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.3.2.2" xref="alg1.l14.m1.1.1.1.1.1.3.2.2.cmml">n</mi><mi id="alg1.l14.m1.1.1.1.1.1.3.2.3" xref="alg1.l14.m1.1.1.1.1.1.3.2.3.cmml">k</mi></msub><mi id="alg1.l14.m1.1.1.1.1.1.3.3" xref="alg1.l14.m1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="alg1.l14.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="alg1.l14.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l14.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">←</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">𝐰</ci><apply id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3"><plus id="alg1.l14.m1.1.1.3.3.1.cmml" xref="alg1.l14.m1.1.1.3.3.1"></plus><ci id="alg1.l14.m1.1.1.3.3.2.cmml" xref="alg1.l14.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l14.m1.1.1.3.3.3.cmml" xref="alg1.l14.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"><plus id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.2"></plus><apply id="alg1.l14.m1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.3.2">𝐰</ci><ci id="alg1.l14.m1.1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1"><apply id="alg1.l14.m1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.2">subscript</csymbol><sum id="alg1.l14.m1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.2.2"></sum><apply id="alg1.l14.m1.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.2.3"><in id="alg1.l14.m1.1.1.1.1.2.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.2.3.1"></in><ci id="alg1.l14.m1.1.1.1.1.2.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.2.3.2">𝑖</ci><apply id="alg1.l14.m1.1.1.1.1.2.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.2.3.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.2.3.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.2.3.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.2.3.3.2">𝑆</ci><ci id="alg1.l14.m1.1.1.1.1.2.3.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l14.m1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1"><times id="alg1.l14.m1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.2"></times><apply id="alg1.l14.m1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.3"><divide id="alg1.l14.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.3"></divide><apply id="alg1.l14.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.3.2.2">𝑛</ci><ci id="alg1.l14.m1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="alg1.l14.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1"><minus id="alg1.l14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.2">𝐰</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">{\bf w}_{t+1}\leftarrow{\bf w}_{t}+\sum\limits_{i\in S_{t}}\frac{n_{k}}{N}({\bf w}_{t}^{i}-{\bf w}_{t})</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>     <math id="alg1.l15.m1.1" class="ltx_Math" alttext="L_{t+1}\leftarrow Loss({\bf w}_{t+1})" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msub id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">L</mi><mrow id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml"><mi id="alg1.l15.m1.1.1.3.3.2" xref="alg1.l15.m1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l15.m1.1.1.3.3.1" xref="alg1.l15.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l15.m1.1.1.3.3.3" xref="alg1.l15.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">←</mo><mrow id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.2" xref="alg1.l15.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l15.m1.1.1.1.4" xref="alg1.l15.m1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.2a" xref="alg1.l15.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l15.m1.1.1.1.5" xref="alg1.l15.m1.1.1.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.2b" xref="alg1.l15.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l15.m1.1.1.1.6" xref="alg1.l15.m1.1.1.1.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.2c" xref="alg1.l15.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.cmml">𝐰</mi><mrow id="alg1.l15.m1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">←</ci><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">𝐿</ci><apply id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3"><plus id="alg1.l15.m1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.3.1"></plus><ci id="alg1.l15.m1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><times id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.2"></times><ci id="alg1.l15.m1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.3">𝐿</ci><ci id="alg1.l15.m1.1.1.1.4.cmml" xref="alg1.l15.m1.1.1.1.4">𝑜</ci><ci id="alg1.l15.m1.1.1.1.5.cmml" xref="alg1.l15.m1.1.1.1.5">𝑠</ci><ci id="alg1.l15.m1.1.1.1.6.cmml" xref="alg1.l15.m1.1.1.1.6">𝑠</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2">𝐰</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3"><plus id="alg1.l15.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.1"></plus><ci id="alg1.l15.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">L_{t+1}\leftarrow Loss({\bf w}_{t+1})</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <math id="alg1.l16.m1.1" class="ltx_Math" alttext="r_{t}\leftarrow(L_{t}-L_{t+1})/L_{t}" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><msub id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml">r</mi><mi id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">←</mo><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mrow id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l16.m1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.2.2" xref="alg1.l16.m1.1.1.1.1.1.1.2.2.cmml">L</mi><mi id="alg1.l16.m1.1.1.1.1.1.1.2.3" xref="alg1.l16.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l16.m1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.1.1.1.3.2.cmml">L</mi><mrow id="alg1.l16.m1.1.1.1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l16.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l16.m1.1.1.1.1.1.1.3.3.1" xref="alg1.l16.m1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l16.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l16.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">/</mo><msub id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.3.2.cmml">L</mi><mi id="alg1.l16.m1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">←</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2">𝑟</ci><ci id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><divide id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></divide><apply id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><minus id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"></minus><apply id="alg1.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2.2">𝐿</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l16.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3.2">𝐿</ci><apply id="alg1.l16.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3.3"><plus id="alg1.l16.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l16.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l16.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.2">𝐿</ci><ci id="alg1.l16.m1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">r_{t}\leftarrow(L_{t}-L_{t+1})/L_{t}</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>     <math id="alg1.l17.m1.2" class="ltx_Math" alttext="Z^{\prime}\leftarrow min(Z,t-1)" display="inline"><semantics id="alg1.l17.m1.2a"><mrow id="alg1.l17.m1.2.2" xref="alg1.l17.m1.2.2.cmml"><msup id="alg1.l17.m1.2.2.3" xref="alg1.l17.m1.2.2.3.cmml"><mi id="alg1.l17.m1.2.2.3.2" xref="alg1.l17.m1.2.2.3.2.cmml">Z</mi><mo id="alg1.l17.m1.2.2.3.3" xref="alg1.l17.m1.2.2.3.3.cmml">′</mo></msup><mo stretchy="false" id="alg1.l17.m1.2.2.2" xref="alg1.l17.m1.2.2.2.cmml">←</mo><mrow id="alg1.l17.m1.2.2.1" xref="alg1.l17.m1.2.2.1.cmml"><mi id="alg1.l17.m1.2.2.1.3" xref="alg1.l17.m1.2.2.1.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.2.2.1.2" xref="alg1.l17.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l17.m1.2.2.1.4" xref="alg1.l17.m1.2.2.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.2.2.1.2a" xref="alg1.l17.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l17.m1.2.2.1.5" xref="alg1.l17.m1.2.2.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.2.2.1.2b" xref="alg1.l17.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l17.m1.2.2.1.1.1" xref="alg1.l17.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l17.m1.2.2.1.1.1.2" xref="alg1.l17.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml">Z</mi><mo id="alg1.l17.m1.2.2.1.1.1.3" xref="alg1.l17.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg1.l17.m1.2.2.1.1.1.1" xref="alg1.l17.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l17.m1.2.2.1.1.1.1.2" xref="alg1.l17.m1.2.2.1.1.1.1.2.cmml">t</mi><mo id="alg1.l17.m1.2.2.1.1.1.1.1" xref="alg1.l17.m1.2.2.1.1.1.1.1.cmml">−</mo><mn id="alg1.l17.m1.2.2.1.1.1.1.3" xref="alg1.l17.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l17.m1.2.2.1.1.1.4" xref="alg1.l17.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.2b"><apply id="alg1.l17.m1.2.2.cmml" xref="alg1.l17.m1.2.2"><ci id="alg1.l17.m1.2.2.2.cmml" xref="alg1.l17.m1.2.2.2">←</ci><apply id="alg1.l17.m1.2.2.3.cmml" xref="alg1.l17.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.3.1.cmml" xref="alg1.l17.m1.2.2.3">superscript</csymbol><ci id="alg1.l17.m1.2.2.3.2.cmml" xref="alg1.l17.m1.2.2.3.2">𝑍</ci><ci id="alg1.l17.m1.2.2.3.3.cmml" xref="alg1.l17.m1.2.2.3.3">′</ci></apply><apply id="alg1.l17.m1.2.2.1.cmml" xref="alg1.l17.m1.2.2.1"><times id="alg1.l17.m1.2.2.1.2.cmml" xref="alg1.l17.m1.2.2.1.2"></times><ci id="alg1.l17.m1.2.2.1.3.cmml" xref="alg1.l17.m1.2.2.1.3">𝑚</ci><ci id="alg1.l17.m1.2.2.1.4.cmml" xref="alg1.l17.m1.2.2.1.4">𝑖</ci><ci id="alg1.l17.m1.2.2.1.5.cmml" xref="alg1.l17.m1.2.2.1.5">𝑛</ci><interval closure="open" id="alg1.l17.m1.2.2.1.1.2.cmml" xref="alg1.l17.m1.2.2.1.1.1"><ci id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1">𝑍</ci><apply id="alg1.l17.m1.2.2.1.1.1.1.cmml" xref="alg1.l17.m1.2.2.1.1.1.1"><minus id="alg1.l17.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l17.m1.2.2.1.1.1.1.1"></minus><ci id="alg1.l17.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l17.m1.2.2.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l17.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l17.m1.2.2.1.1.1.1.3">1</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.2c">Z^{\prime}\leftarrow min(Z,t-1)</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <math id="alg1.l18.m1.2" class="ltx_Math" alttext="{\bf\psi}_{t+1}\leftarrow{\bf\psi}_{t}-\eta_{H}\sum\limits_{\tau=t-Z^{\prime}}^{\tau=t}(r_{\tau}-{\hat{r}}_{t})\nabla_{{\bf\psi}_{\tau}}log(P({\bf h}_{\tau}|{\bf\psi}_{\tau}))\quad where\quad{\hat{r}}_{t}=\frac{1}{Z^{\prime}+1}\sum\limits_{\tau=t-Z^{\prime}}^{\tau=t}r_{\tau}" display="inline"><semantics id="alg1.l18.m1.2a"><mrow id="alg1.l18.m1.2.2.2" xref="alg1.l18.m1.2.2.3.cmml"><mrow id="alg1.l18.m1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.cmml"><msub id="alg1.l18.m1.1.1.1.1.4" xref="alg1.l18.m1.1.1.1.1.4.cmml"><mi id="alg1.l18.m1.1.1.1.1.4.2" xref="alg1.l18.m1.1.1.1.1.4.2.cmml">ψ</mi><mrow id="alg1.l18.m1.1.1.1.1.4.3" xref="alg1.l18.m1.1.1.1.1.4.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.4.3.2" xref="alg1.l18.m1.1.1.1.1.4.3.2.cmml">t</mi><mo id="alg1.l18.m1.1.1.1.1.4.3.1" xref="alg1.l18.m1.1.1.1.1.4.3.1.cmml">+</mo><mn id="alg1.l18.m1.1.1.1.1.4.3.3" xref="alg1.l18.m1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.3.cmml">←</mo><mrow id="alg1.l18.m1.1.1.1.1.2.2" xref="alg1.l18.m1.1.1.1.1.2.3.cmml"><mrow id="alg1.l18.m1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.4" xref="alg1.l18.m1.1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.4.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.4.2.cmml">ψ</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.1.4.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="alg1.l18.m1.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.2.4" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.4.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.4.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.4.2.cmml">η</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.4.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.4.3.cmml">H</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.cmml"><munderover id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mo movablelimits="false" rspace="0em" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml">τ</mi><mo id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.2.cmml">t</mi><mo id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.1.cmml">−</mo><msup id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.2.cmml">Z</mi><mo id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.3.cmml">′</mo></msup></mrow></mrow><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.2.cmml">τ</mi><mo id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.1.cmml">=</mo><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.3.cmml">t</mi></mrow></munderover><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">r</mi><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.cmml"><mo rspace="0.167em" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.2.cmml">∇</mo><msub id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.2.cmml">ψ</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.3.cmml">τ</mi></msub></msub><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.1.cmml">​</mo><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.1a" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.1.cmml">​</mo><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.4" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.4.cmml">g</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.3a" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml">(</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.2.cmml">​</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml"><msub id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo fence="false" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mspace width="1em" id="alg1.l18.m1.1.1.1.1.2.2.3" xref="alg1.l18.m1.1.1.1.1.2.3.cmml"></mspace><mrow id="alg1.l18.m1.1.1.1.1.2.2.2" xref="alg1.l18.m1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l18.m1.1.1.1.1.2.2.2.2" xref="alg1.l18.m1.1.1.1.1.2.2.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.2.2.2.1" xref="alg1.l18.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="alg1.l18.m1.1.1.1.1.2.2.2.3" xref="alg1.l18.m1.1.1.1.1.2.2.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.2.2.2.1a" xref="alg1.l18.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="alg1.l18.m1.1.1.1.1.2.2.2.4" xref="alg1.l18.m1.1.1.1.1.2.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.2.2.2.1b" xref="alg1.l18.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="alg1.l18.m1.1.1.1.1.2.2.2.5" xref="alg1.l18.m1.1.1.1.1.2.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.1.1.2.2.2.1c" xref="alg1.l18.m1.1.1.1.1.2.2.2.1.cmml">​</mo><mi id="alg1.l18.m1.1.1.1.1.2.2.2.6" xref="alg1.l18.m1.1.1.1.1.2.2.2.6.cmml">e</mi></mrow></mrow></mrow><mspace width="1em" id="alg1.l18.m1.2.2.2.3" xref="alg1.l18.m1.2.2.3a.cmml"></mspace><mrow id="alg1.l18.m1.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.cmml"><msub id="alg1.l18.m1.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l18.m1.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.2.cmml">r</mi><mo id="alg1.l18.m1.2.2.2.2.2.2.1" xref="alg1.l18.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l18.m1.2.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.2.3.cmml">t</mi></msub><mo id="alg1.l18.m1.2.2.2.2.1" xref="alg1.l18.m1.2.2.2.2.1.cmml">=</mo><mrow id="alg1.l18.m1.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.3.cmml"><mfrac id="alg1.l18.m1.2.2.2.2.3.2" xref="alg1.l18.m1.2.2.2.2.3.2.cmml"><mn id="alg1.l18.m1.2.2.2.2.3.2.2" xref="alg1.l18.m1.2.2.2.2.3.2.2.cmml">1</mn><mrow id="alg1.l18.m1.2.2.2.2.3.2.3" xref="alg1.l18.m1.2.2.2.2.3.2.3.cmml"><msup id="alg1.l18.m1.2.2.2.2.3.2.3.2" xref="alg1.l18.m1.2.2.2.2.3.2.3.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.3.2.3.2.2" xref="alg1.l18.m1.2.2.2.2.3.2.3.2.2.cmml">Z</mi><mo id="alg1.l18.m1.2.2.2.2.3.2.3.2.3" xref="alg1.l18.m1.2.2.2.2.3.2.3.2.3.cmml">′</mo></msup><mo id="alg1.l18.m1.2.2.2.2.3.2.3.1" xref="alg1.l18.m1.2.2.2.2.3.2.3.1.cmml">+</mo><mn id="alg1.l18.m1.2.2.2.2.3.2.3.3" xref="alg1.l18.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l18.m1.2.2.2.2.3.1" xref="alg1.l18.m1.2.2.2.2.3.1.cmml">​</mo><mrow id="alg1.l18.m1.2.2.2.2.3.3" xref="alg1.l18.m1.2.2.2.2.3.3.cmml"><munderover id="alg1.l18.m1.2.2.2.2.3.3.1" xref="alg1.l18.m1.2.2.2.2.3.3.1.cmml"><mo movablelimits="false" id="alg1.l18.m1.2.2.2.2.3.3.1.2.2" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l18.m1.2.2.2.2.3.3.1.2.3" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.cmml"><mi id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.2" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.2.cmml">τ</mi><mo id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.1" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.1.cmml">=</mo><mrow id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.cmml"><mi id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.2" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.2.cmml">t</mi><mo id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.1" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.1.cmml">−</mo><msup id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.cmml"><mi id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.2" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.2.cmml">Z</mi><mo id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.3" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.3.cmml">′</mo></msup></mrow></mrow><mrow id="alg1.l18.m1.2.2.2.2.3.3.1.3" xref="alg1.l18.m1.2.2.2.2.3.3.1.3.cmml"><mi id="alg1.l18.m1.2.2.2.2.3.3.1.3.2" xref="alg1.l18.m1.2.2.2.2.3.3.1.3.2.cmml">τ</mi><mo id="alg1.l18.m1.2.2.2.2.3.3.1.3.1" xref="alg1.l18.m1.2.2.2.2.3.3.1.3.1.cmml">=</mo><mi id="alg1.l18.m1.2.2.2.2.3.3.1.3.3" xref="alg1.l18.m1.2.2.2.2.3.3.1.3.3.cmml">t</mi></mrow></munderover><msub id="alg1.l18.m1.2.2.2.2.3.3.2" xref="alg1.l18.m1.2.2.2.2.3.3.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.3.3.2.2" xref="alg1.l18.m1.2.2.2.2.3.3.2.2.cmml">r</mi><mi id="alg1.l18.m1.2.2.2.2.3.3.2.3" xref="alg1.l18.m1.2.2.2.2.3.3.2.3.cmml">τ</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.2b"><apply id="alg1.l18.m1.2.2.3.cmml" xref="alg1.l18.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.3a.cmml" xref="alg1.l18.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l18.m1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1"><ci id="alg1.l18.m1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.3">←</ci><apply id="alg1.l18.m1.1.1.1.1.4.cmml" xref="alg1.l18.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.4.1.cmml" xref="alg1.l18.m1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.4.2.cmml" xref="alg1.l18.m1.1.1.1.1.4.2">𝜓</ci><apply id="alg1.l18.m1.1.1.1.1.4.3.cmml" xref="alg1.l18.m1.1.1.1.1.4.3"><plus id="alg1.l18.m1.1.1.1.1.4.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.4.3.1"></plus><ci id="alg1.l18.m1.1.1.1.1.4.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.4.3.2">𝑡</ci><cn type="integer" id="alg1.l18.m1.1.1.1.1.4.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="alg1.l18.m1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.2.2"><apply id="alg1.l18.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1"><minus id="alg1.l18.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.3"></minus><apply id="alg1.l18.m1.1.1.1.1.1.1.1.4.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.4.2">𝜓</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.4.3">𝑡</ci></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2"><times id="alg1.l18.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.3"></times><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.4.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.4.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.4.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.4.2">𝜂</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.4.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.4.3">𝐻</ci></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2"><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.2"></sum><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3"><eq id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.2">𝜏</ci><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3"><minus id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.1"></minus><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.2">𝑡</ci><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3">superscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.2">𝑍</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.2.3.3.3.3">′</ci></apply></apply></apply></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3"><eq id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.1"></eq><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.2">𝜏</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.3.3.3">𝑡</ci></apply></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2"><times id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.3"></times><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑟</ci></apply><ci id="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4"><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.2">∇</ci><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.2">𝜓</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.1.3.3">𝜏</ci></apply></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2"><times id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.1"></times><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.2">𝑙</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.3">𝑜</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.4.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.4.2.4">𝑔</ci></apply></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1"><times id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.2"></times><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.3">𝑃</ci><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1"><csymbol cd="latexml" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.2">𝐡</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.2">𝜓</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.1.3.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply><apply id="alg1.l18.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.2.2.2"><times id="alg1.l18.m1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.2.2.2.1"></times><ci id="alg1.l18.m1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l18.m1.1.1.1.1.2.2.2.2">𝑤</ci><ci id="alg1.l18.m1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l18.m1.1.1.1.1.2.2.2.3">ℎ</ci><ci id="alg1.l18.m1.1.1.1.1.2.2.2.4.cmml" xref="alg1.l18.m1.1.1.1.1.2.2.2.4">𝑒</ci><ci id="alg1.l18.m1.1.1.1.1.2.2.2.5.cmml" xref="alg1.l18.m1.1.1.1.1.2.2.2.5">𝑟</ci><ci id="alg1.l18.m1.1.1.1.1.2.2.2.6.cmml" xref="alg1.l18.m1.1.1.1.1.2.2.2.6">𝑒</ci></apply></list></apply><apply id="alg1.l18.m1.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2"><eq id="alg1.l18.m1.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.1"></eq><apply id="alg1.l18.m1.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l18.m1.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2"><ci id="alg1.l18.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.1">^</ci><ci id="alg1.l18.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.2">𝑟</ci></apply><ci id="alg1.l18.m1.2.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l18.m1.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.3"><times id="alg1.l18.m1.2.2.2.2.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.1"></times><apply id="alg1.l18.m1.2.2.2.2.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.2"><divide id="alg1.l18.m1.2.2.2.2.3.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.2"></divide><cn type="integer" id="alg1.l18.m1.2.2.2.2.3.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.2.2">1</cn><apply id="alg1.l18.m1.2.2.2.2.3.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.2.3"><plus id="alg1.l18.m1.2.2.2.2.3.2.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.2.3.1"></plus><apply id="alg1.l18.m1.2.2.2.2.3.2.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.2.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.3.2.3.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.2.3.2">superscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.3.2.3.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.2.3.2.2">𝑍</ci><ci id="alg1.l18.m1.2.2.2.2.3.2.3.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.2.3.2.3">′</ci></apply><cn type="integer" id="alg1.l18.m1.2.2.2.2.3.2.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="alg1.l18.m1.2.2.2.2.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.3"><apply id="alg1.l18.m1.2.2.2.2.3.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.3.3.1.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1">superscript</csymbol><apply id="alg1.l18.m1.2.2.2.2.3.3.1.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.3.3.1.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1">subscript</csymbol><sum id="alg1.l18.m1.2.2.2.2.3.3.1.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.2"></sum><apply id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3"><eq id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.1"></eq><ci id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.2">𝜏</ci><apply id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3"><minus id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.1"></minus><ci id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.2">𝑡</ci><apply id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3">superscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.2">𝑍</ci><ci id="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.2.3.3.3.3">′</ci></apply></apply></apply></apply><apply id="alg1.l18.m1.2.2.2.2.3.3.1.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.3"><eq id="alg1.l18.m1.2.2.2.2.3.3.1.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.3.1"></eq><ci id="alg1.l18.m1.2.2.2.2.3.3.1.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.3.2">𝜏</ci><ci id="alg1.l18.m1.2.2.2.2.3.3.1.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l18.m1.2.2.2.2.3.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.3.3.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.2">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.3.3.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.2.2">𝑟</ci><ci id="alg1.l18.m1.2.2.2.2.3.3.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.3.3.2.3">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.2c">{\bf\psi}_{t+1}\leftarrow{\bf\psi}_{t}-\eta_{H}\sum\limits_{\tau=t-Z^{\prime}}^{\tau=t}(r_{\tau}-{\hat{r}}_{t})\nabla_{{\bf\psi}_{\tau}}log(P({\bf h}_{\tau}|{\bf\psi}_{\tau}))\quad where\quad{\hat{r}}_{t}=\frac{1}{Z^{\prime}+1}\sum\limits_{\tau=t-Z^{\prime}}^{\tau=t}r_{\tau}</annotation></semantics></math>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span><span id="alg1.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental results</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.7" class="ltx_p">We evaluate the performance of our two-part scheme on the MNIST and CIFAR10 image classification datasets, and on a KWS task using the speech commands dataset <cite class="ltx_cite ltx_citemacro_citep">(Warden, <a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite>. We restrict the KWS task to only ten keywords. In all experiments, we use ten clients and use one of two data distributions: <span id="S4.p1.7.1" class="ltx_text ltx_font_bold">iid</span> where the dataset is split randomly across the ten clients, and <span id="S4.p1.7.2" class="ltx_text ltx_font_bold">non-iid</span> where each client only has data points belonging to one of the ten classes. We use our online hyper-parameter tuning scheme to tune the learning rate and the number of SGD iterations (see algorithm <a href="#alg1" title="Algorithm 1 ‣ Choosing the form of 𝑃⁢(ℋ|𝜓) ‣ 3.3 Full Algorithm and Practical Considerations ‣ 3 methods ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). In all experiments, we use the same hyper-hyper-parameters controlling the hyper-parameter tuning process which are the hyper-learning rate <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="{\eta}_{H}" display="inline"><semantics id="S4.p1.1.m1.1a"><msub id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mi id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">η</mi><mi id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">𝜂</ci><ci id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">{\eta}_{H}</annotation></semantics></math>, the hyper-parameter grid <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="{\mathcal{H}}" display="inline"><semantics id="S4.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">{\mathcal{H}}</annotation></semantics></math>, and the REINFORCE baseline interval <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S4.p1.3.m3.1a"><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">Z</annotation></semantics></math>. One exception is the KWS task where we modify the grid <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="{\mathcal{H}}" display="inline"><semantics id="S4.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">{\mathcal{H}}</annotation></semantics></math> to reduce the number of allowed SGD iterations per round to reflect the smaller size of the dataset. A batch size of 64 is used throughout. In all experiments, we add an entropy regularization (ER) term <cite class="ltx_cite ltx_citemacro_citep">(Pereyra et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> to the client losses during training. For client <math id="S4.p1.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p1.5.m5.1a"><mi id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><ci id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">i</annotation></semantics></math> in round <math id="S4.p1.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.p1.6.m6.1a"><mi id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><ci id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">t</annotation></semantics></math> with input <math id="S4.p1.7.m7.1" class="ltx_Math" alttext="{\bf x}" display="inline"><semantics id="S4.p1.7.m7.1a"><mi id="S4.p1.7.m7.1.1" xref="S4.p1.7.m7.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.p1.7.m7.1b"><ci id="S4.p1.7.m7.1.1.cmml" xref="S4.p1.7.m7.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m7.1c">{\bf x}</annotation></semantics></math>, the ER loss term has the form:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.5" class="ltx_Math" alttext="{\mathcal{L}}_{ER}({\bf x},{\bf w}_{t}^{i})=max\left(0,H_{min}-H(softmax({\bf a}_{M}({\bf x};{\bf w}_{t}^{i})))\right)" display="block"><semantics id="S4.E8.m1.5a"><mrow id="S4.E8.m1.5.5" xref="S4.E8.m1.5.5.cmml"><mrow id="S4.E8.m1.4.4.1" xref="S4.E8.m1.4.4.1.cmml"><msub id="S4.E8.m1.4.4.1.3" xref="S4.E8.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.4.4.1.3.2" xref="S4.E8.m1.4.4.1.3.2.cmml">ℒ</mi><mrow id="S4.E8.m1.4.4.1.3.3" xref="S4.E8.m1.4.4.1.3.3.cmml"><mi id="S4.E8.m1.4.4.1.3.3.2" xref="S4.E8.m1.4.4.1.3.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.4.4.1.3.3.1" xref="S4.E8.m1.4.4.1.3.3.1.cmml">​</mo><mi id="S4.E8.m1.4.4.1.3.3.3" xref="S4.E8.m1.4.4.1.3.3.3.cmml">R</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.4.4.1.2" xref="S4.E8.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E8.m1.4.4.1.1.1" xref="S4.E8.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.4.4.1.1.1.2" xref="S4.E8.m1.4.4.1.1.2.cmml">(</mo><mi id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">𝐱</mi><mo id="S4.E8.m1.4.4.1.1.1.3" xref="S4.E8.m1.4.4.1.1.2.cmml">,</mo><msubsup id="S4.E8.m1.4.4.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.cmml"><mi id="S4.E8.m1.4.4.1.1.1.1.2.2" xref="S4.E8.m1.4.4.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S4.E8.m1.4.4.1.1.1.1.2.3" xref="S4.E8.m1.4.4.1.1.1.1.2.3.cmml">t</mi><mi id="S4.E8.m1.4.4.1.1.1.1.3" xref="S4.E8.m1.4.4.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.E8.m1.4.4.1.1.1.4" xref="S4.E8.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.5.5.3" xref="S4.E8.m1.5.5.3.cmml">=</mo><mrow id="S4.E8.m1.5.5.2" xref="S4.E8.m1.5.5.2.cmml"><mi id="S4.E8.m1.5.5.2.3" xref="S4.E8.m1.5.5.2.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.2" xref="S4.E8.m1.5.5.2.2.cmml">​</mo><mi id="S4.E8.m1.5.5.2.4" xref="S4.E8.m1.5.5.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.2a" xref="S4.E8.m1.5.5.2.2.cmml">​</mo><mi id="S4.E8.m1.5.5.2.5" xref="S4.E8.m1.5.5.2.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.2b" xref="S4.E8.m1.5.5.2.2.cmml">​</mo><mrow id="S4.E8.m1.5.5.2.1.1" xref="S4.E8.m1.5.5.2.1.2.cmml"><mo id="S4.E8.m1.5.5.2.1.1.2" xref="S4.E8.m1.5.5.2.1.2.cmml">(</mo><mn id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml">0</mn><mo id="S4.E8.m1.5.5.2.1.1.3" xref="S4.E8.m1.5.5.2.1.2.cmml">,</mo><mrow id="S4.E8.m1.5.5.2.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.cmml"><msub id="S4.E8.m1.5.5.2.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.3.cmml"><mi id="S4.E8.m1.5.5.2.1.1.1.3.2" xref="S4.E8.m1.5.5.2.1.1.1.3.2.cmml">H</mi><mrow id="S4.E8.m1.5.5.2.1.1.1.3.3" xref="S4.E8.m1.5.5.2.1.1.1.3.3.cmml"><mi id="S4.E8.m1.5.5.2.1.1.1.3.3.2" xref="S4.E8.m1.5.5.2.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.3.3.1" xref="S4.E8.m1.5.5.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E8.m1.5.5.2.1.1.1.3.3.3" xref="S4.E8.m1.5.5.2.1.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.3.3.1a" xref="S4.E8.m1.5.5.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E8.m1.5.5.2.1.1.1.3.3.4" xref="S4.E8.m1.5.5.2.1.1.1.3.3.4.cmml">n</mi></mrow></msub><mo id="S4.E8.m1.5.5.2.1.1.1.2" xref="S4.E8.m1.5.5.2.1.1.1.2.cmml">−</mo><mrow id="S4.E8.m1.5.5.2.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.cmml"><mi id="S4.E8.m1.5.5.2.1.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.2" xref="S4.E8.m1.5.5.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.5.5.2.1.1.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.2" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.4" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2a" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.5" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2b" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.6" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2c" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.7" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2d" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.8" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2e" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.9" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2f" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐚</mi><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml">𝐱</mi><mo id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msubsup id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.3" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.5.5.2.1.1.4" xref="S4.E8.m1.5.5.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.5b"><apply id="S4.E8.m1.5.5.cmml" xref="S4.E8.m1.5.5"><eq id="S4.E8.m1.5.5.3.cmml" xref="S4.E8.m1.5.5.3"></eq><apply id="S4.E8.m1.4.4.1.cmml" xref="S4.E8.m1.4.4.1"><times id="S4.E8.m1.4.4.1.2.cmml" xref="S4.E8.m1.4.4.1.2"></times><apply id="S4.E8.m1.4.4.1.3.cmml" xref="S4.E8.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.3.1.cmml" xref="S4.E8.m1.4.4.1.3">subscript</csymbol><ci id="S4.E8.m1.4.4.1.3.2.cmml" xref="S4.E8.m1.4.4.1.3.2">ℒ</ci><apply id="S4.E8.m1.4.4.1.3.3.cmml" xref="S4.E8.m1.4.4.1.3.3"><times id="S4.E8.m1.4.4.1.3.3.1.cmml" xref="S4.E8.m1.4.4.1.3.3.1"></times><ci id="S4.E8.m1.4.4.1.3.3.2.cmml" xref="S4.E8.m1.4.4.1.3.3.2">𝐸</ci><ci id="S4.E8.m1.4.4.1.3.3.3.cmml" xref="S4.E8.m1.4.4.1.3.3.3">𝑅</ci></apply></apply><interval closure="open" id="S4.E8.m1.4.4.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1"><ci id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">𝐱</ci><apply id="S4.E8.m1.4.4.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1">superscript</csymbol><apply id="S4.E8.m1.4.4.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.4.4.1.1.1.1.2.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.2.2">𝐰</ci><ci id="S4.E8.m1.4.4.1.1.1.1.2.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E8.m1.4.4.1.1.1.1.3.cmml" xref="S4.E8.m1.4.4.1.1.1.1.3">𝑖</ci></apply></interval></apply><apply id="S4.E8.m1.5.5.2.cmml" xref="S4.E8.m1.5.5.2"><times id="S4.E8.m1.5.5.2.2.cmml" xref="S4.E8.m1.5.5.2.2"></times><ci id="S4.E8.m1.5.5.2.3.cmml" xref="S4.E8.m1.5.5.2.3">𝑚</ci><ci id="S4.E8.m1.5.5.2.4.cmml" xref="S4.E8.m1.5.5.2.4">𝑎</ci><ci id="S4.E8.m1.5.5.2.5.cmml" xref="S4.E8.m1.5.5.2.5">𝑥</ci><interval closure="open" id="S4.E8.m1.5.5.2.1.2.cmml" xref="S4.E8.m1.5.5.2.1.1"><cn type="integer" id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3">0</cn><apply id="S4.E8.m1.5.5.2.1.1.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1"><minus id="S4.E8.m1.5.5.2.1.1.1.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.2"></minus><apply id="S4.E8.m1.5.5.2.1.1.1.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.1.1.1.3.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.5.5.2.1.1.1.3.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.3.2">𝐻</ci><apply id="S4.E8.m1.5.5.2.1.1.1.3.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.3.3"><times id="S4.E8.m1.5.5.2.1.1.1.3.3.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.3.3.1"></times><ci id="S4.E8.m1.5.5.2.1.1.1.3.3.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.3.3.2">𝑚</ci><ci id="S4.E8.m1.5.5.2.1.1.1.3.3.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.3.3.3">𝑖</ci><ci id="S4.E8.m1.5.5.2.1.1.1.3.3.4.cmml" xref="S4.E8.m1.5.5.2.1.1.1.3.3.4">𝑛</ci></apply></apply><apply id="S4.E8.m1.5.5.2.1.1.1.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1"><times id="S4.E8.m1.5.5.2.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.2"></times><ci id="S4.E8.m1.5.5.2.1.1.1.1.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.3">𝐻</ci><apply id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1"><times id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.2"></times><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.3">𝑠</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.4">𝑜</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.5.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.5">𝑓</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.6.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.6">𝑡</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.7.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.7">𝑚</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.8.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.8">𝑎</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.9.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.9">𝑥</ci><apply id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1"><times id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.2">𝐚</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑀</ci></apply><list id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">𝐱</ci><apply id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.5.5.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.5c">{\mathcal{L}}_{ER}({\bf x},{\bf w}_{t}^{i})=max\left(0,H_{min}-H(softmax({\bf a}_{M}({\bf x};{\bf w}_{t}^{i})))\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.p1.11" class="ltx_p">where <math id="S4.p1.8.m1.1" class="ltx_Math" alttext="H(\bullet)" display="inline"><semantics id="S4.p1.8.m1.1a"><mrow id="S4.p1.8.m1.1.2" xref="S4.p1.8.m1.1.2.cmml"><mi id="S4.p1.8.m1.1.2.2" xref="S4.p1.8.m1.1.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S4.p1.8.m1.1.2.1" xref="S4.p1.8.m1.1.2.1.cmml">​</mo><mrow id="S4.p1.8.m1.1.2.3.2" xref="S4.p1.8.m1.1.2.cmml"><mo stretchy="false" id="S4.p1.8.m1.1.2.3.2.1" xref="S4.p1.8.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.p1.8.m1.1.1" xref="S4.p1.8.m1.1.1.cmml">∙</mo><mo stretchy="false" id="S4.p1.8.m1.1.2.3.2.2" xref="S4.p1.8.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.8.m1.1b"><apply id="S4.p1.8.m1.1.2.cmml" xref="S4.p1.8.m1.1.2"><times id="S4.p1.8.m1.1.2.1.cmml" xref="S4.p1.8.m1.1.2.1"></times><ci id="S4.p1.8.m1.1.2.2.cmml" xref="S4.p1.8.m1.1.2.2">𝐻</ci><ci id="S4.p1.8.m1.1.1.cmml" xref="S4.p1.8.m1.1.1">∙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.8.m1.1c">H(\bullet)</annotation></semantics></math> is the entropy operator and <math id="S4.p1.9.m2.1" class="ltx_Math" alttext="{\bf a}_{M}" display="inline"><semantics id="S4.p1.9.m2.1a"><msub id="S4.p1.9.m2.1.1" xref="S4.p1.9.m2.1.1.cmml"><mi id="S4.p1.9.m2.1.1.2" xref="S4.p1.9.m2.1.1.2.cmml">𝐚</mi><mi id="S4.p1.9.m2.1.1.3" xref="S4.p1.9.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.9.m2.1b"><apply id="S4.p1.9.m2.1.1.cmml" xref="S4.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S4.p1.9.m2.1.1.1.cmml" xref="S4.p1.9.m2.1.1">subscript</csymbol><ci id="S4.p1.9.m2.1.1.2.cmml" xref="S4.p1.9.m2.1.1.2">𝐚</ci><ci id="S4.p1.9.m2.1.1.3.cmml" xref="S4.p1.9.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.9.m2.1c">{\bf a}_{M}</annotation></semantics></math> the top layer activity. <math id="S4.p1.10.m3.1" class="ltx_Math" alttext="{\mathcal{L}}_{ER}" display="inline"><semantics id="S4.p1.10.m3.1a"><msub id="S4.p1.10.m3.1.1" xref="S4.p1.10.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.10.m3.1.1.2" xref="S4.p1.10.m3.1.1.2.cmml">ℒ</mi><mrow id="S4.p1.10.m3.1.1.3" xref="S4.p1.10.m3.1.1.3.cmml"><mi id="S4.p1.10.m3.1.1.3.2" xref="S4.p1.10.m3.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.p1.10.m3.1.1.3.1" xref="S4.p1.10.m3.1.1.3.1.cmml">​</mo><mi id="S4.p1.10.m3.1.1.3.3" xref="S4.p1.10.m3.1.1.3.3.cmml">R</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p1.10.m3.1b"><apply id="S4.p1.10.m3.1.1.cmml" xref="S4.p1.10.m3.1.1"><csymbol cd="ambiguous" id="S4.p1.10.m3.1.1.1.cmml" xref="S4.p1.10.m3.1.1">subscript</csymbol><ci id="S4.p1.10.m3.1.1.2.cmml" xref="S4.p1.10.m3.1.1.2">ℒ</ci><apply id="S4.p1.10.m3.1.1.3.cmml" xref="S4.p1.10.m3.1.1.3"><times id="S4.p1.10.m3.1.1.3.1.cmml" xref="S4.p1.10.m3.1.1.3.1"></times><ci id="S4.p1.10.m3.1.1.3.2.cmml" xref="S4.p1.10.m3.1.1.3.2">𝐸</ci><ci id="S4.p1.10.m3.1.1.3.3.cmml" xref="S4.p1.10.m3.1.1.3.3">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.10.m3.1c">{\mathcal{L}}_{ER}</annotation></semantics></math> penalizes highly confident (low entropy) output distributions when their entropy falls below <math id="S4.p1.11.m4.1" class="ltx_Math" alttext="H_{min}" display="inline"><semantics id="S4.p1.11.m4.1a"><msub id="S4.p1.11.m4.1.1" xref="S4.p1.11.m4.1.1.cmml"><mi id="S4.p1.11.m4.1.1.2" xref="S4.p1.11.m4.1.1.2.cmml">H</mi><mrow id="S4.p1.11.m4.1.1.3" xref="S4.p1.11.m4.1.1.3.cmml"><mi id="S4.p1.11.m4.1.1.3.2" xref="S4.p1.11.m4.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.p1.11.m4.1.1.3.1" xref="S4.p1.11.m4.1.1.3.1.cmml">​</mo><mi id="S4.p1.11.m4.1.1.3.3" xref="S4.p1.11.m4.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.p1.11.m4.1.1.3.1a" xref="S4.p1.11.m4.1.1.3.1.cmml">​</mo><mi id="S4.p1.11.m4.1.1.3.4" xref="S4.p1.11.m4.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p1.11.m4.1b"><apply id="S4.p1.11.m4.1.1.cmml" xref="S4.p1.11.m4.1.1"><csymbol cd="ambiguous" id="S4.p1.11.m4.1.1.1.cmml" xref="S4.p1.11.m4.1.1">subscript</csymbol><ci id="S4.p1.11.m4.1.1.2.cmml" xref="S4.p1.11.m4.1.1.2">𝐻</ci><apply id="S4.p1.11.m4.1.1.3.cmml" xref="S4.p1.11.m4.1.1.3"><times id="S4.p1.11.m4.1.1.3.1.cmml" xref="S4.p1.11.m4.1.1.3.1"></times><ci id="S4.p1.11.m4.1.1.3.2.cmml" xref="S4.p1.11.m4.1.1.3.2">𝑚</ci><ci id="S4.p1.11.m4.1.1.3.3.cmml" xref="S4.p1.11.m4.1.1.3.3">𝑖</ci><ci id="S4.p1.11.m4.1.1.3.4.cmml" xref="S4.p1.11.m4.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.11.m4.1c">H_{min}</annotation></semantics></math>. This loss term significantly improves the performance of the FedAvg algorithm in the presence of non-iid client data.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.3" class="ltx_p">As a comparison baseline, we run experiments with a fixed decay schedule for both the learning rate and the number of SGD iterations per round. As a baseline for our representation matching scheme, we run experiments where each client’s training loss is augmented with a term that penalizes weight divergence between the client model parameters and the initial parameters received from the server. For client <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">i</annotation></semantics></math> in round <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.p2.2.m2.1a"><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">t</annotation></semantics></math>, this weight divergence (WD) loss term has the form <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="||{\bf w}_{t}-{\bf w}_{t}^{i}||_{2}^{2}" display="inline"><semantics id="S4.p2.3.m3.1a"><msubsup id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mrow id="S4.p2.3.m3.1.1.1.1.1" xref="S4.p2.3.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.p2.3.m3.1.1.1.1.1.2" xref="S4.p2.3.m3.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.p2.3.m3.1.1.1.1.1.1" xref="S4.p2.3.m3.1.1.1.1.1.1.cmml"><msub id="S4.p2.3.m3.1.1.1.1.1.1.2" xref="S4.p2.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S4.p2.3.m3.1.1.1.1.1.1.2.2" xref="S4.p2.3.m3.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S4.p2.3.m3.1.1.1.1.1.1.2.3" xref="S4.p2.3.m3.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S4.p2.3.m3.1.1.1.1.1.1.1" xref="S4.p2.3.m3.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.p2.3.m3.1.1.1.1.1.1.3" xref="S4.p2.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S4.p2.3.m3.1.1.1.1.1.1.3.2.2" xref="S4.p2.3.m3.1.1.1.1.1.1.3.2.2.cmml">𝐰</mi><mi id="S4.p2.3.m3.1.1.1.1.1.1.3.2.3" xref="S4.p2.3.m3.1.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="S4.p2.3.m3.1.1.1.1.1.1.3.3" xref="S4.p2.3.m3.1.1.1.1.1.1.3.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S4.p2.3.m3.1.1.1.1.1.3" xref="S4.p2.3.m3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.p2.3.m3.1.1.1.3" xref="S4.p2.3.m3.1.1.1.3.cmml">2</mn><mn id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1">superscript</csymbol><apply id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.2.cmml" xref="S4.p2.3.m3.1.1">subscript</csymbol><apply id="S4.p2.3.m3.1.1.1.1.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S4.p2.3.m3.1.1.1.1.2.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2">norm</csymbol><apply id="S4.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1"><minus id="S4.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.1"></minus><apply id="S4.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.p2.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.2.2">𝐰</ci><ci id="S4.p2.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.p2.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.p2.3.m3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.3.2.2">𝐰</ci><ci id="S4.p2.3.m3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.p2.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S4.p2.3.m3.1.1.1.3.cmml" xref="S4.p2.3.m3.1.1.1.3">2</cn></apply><cn type="integer" id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">||{\bf w}_{t}-{\bf w}_{t}^{i}||_{2}^{2}</annotation></semantics></math>. This penalty function was introduced into the FL setting by the FedProx algorithm <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2018</a>)</cite> to mitigate the effect of model divergence.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.3" class="ltx_p">We report results for the standard FedAvg algorithm (FA), FedAvg with a weight divergence loss term in the clients (FA+WD), and FedAvg augmented with adaptive hyper-parameters(AH) and/or representation matching (RM). We consider two values for <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">C</annotation></semantics></math> (the fraction of clients participating in each round): <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="C=0.5" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">C</mi><mo id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><eq id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1"></eq><ci id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">𝐶</ci><cn type="float" id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">C=0.5</annotation></semantics></math> and <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="C=1.0" display="inline"><semantics id="S4.p3.3.m3.1a"><mrow id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">C</mi><mo id="S4.p3.3.m3.1.1.1" xref="S4.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><eq id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1.1"></eq><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝐶</ci><cn type="float" id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">C=1.0</annotation></semantics></math>. For the baselines, FA and FA+WD, we manually tuned the hyper-parameters decay schedule to obtain best accuracy. This tuning was done separately for the <span id="S4.p3.3.1" class="ltx_text ltx_font_bold">iid</span> and <span id="S4.p3.3.2" class="ltx_text ltx_font_bold">non-iid</span> cases . All experiments were repeated 3 times.</p>
</div>
<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">MNIST</h4>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px1.p1.2" class="ltx_p">: We use a fully-connected network with two hidden layers with 100 neurons each. As shown in table <a href="#S4.T1" title="Table 1 ‣ MNIST ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the best performing algorithm is FA+AH. The use of representation matching causes a slight degradation in performance (FA+RM+AH and FA+RM). It is interesting to look at the trajectory of the mean <math id="S4.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="{\bf\mu}" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.1.m1.1c">{\bf\mu}</annotation></semantics></math> of the discrete Gaussian hyper-parameter distribution <math id="S4.SS0.SSS0.Px1.p1.2.m2.3" class="ltx_Math" alttext="P({\mathcal{H}}|{\bf\mu},{\bf A})" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.2.m2.3a"><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.3.3" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.cmml"><mi id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.3" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.2.cmml">​</mo><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.3.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.3.1.cmml"><mi id="S4.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">μ</mi><mo id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.3.2.1" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="S4.SS0.SSS0.Px1.p1.2.m2.2.2" xref="S4.SS0.SSS0.Px1.p1.2.m2.2.2.cmml">𝐀</mi></mrow></mrow><mo stretchy="false" id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.3" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.2.m2.3b"><apply id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3"><times id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.2"></times><ci id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.3.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.3">𝑃</ci><apply id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1"><csymbol cd="latexml" id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.2">ℋ</ci><list id="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.3.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.3.3.1.1.1.3.2"><ci id="S4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.1.1">𝜇</ci><ci id="S4.SS0.SSS0.Px1.p1.2.m2.2.2.cmml" xref="S4.SS0.SSS0.Px1.p1.2.m2.2.2">𝐀</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.2.m2.3c">P({\mathcal{H}}|{\bf\mu},{\bf A})</annotation></semantics></math>. This is shown in the first column of Fig. <a href="#S4.F3" title="Figure 3 ‣ Keyword spotting task ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> for the <span id="S4.SS0.SSS0.Px1.p1.2.1" class="ltx_text ltx_font_bold">iid</span> and <span id="S4.SS0.SSS0.Px1.p1.2.2" class="ltx_text ltx_font_bold">non-iid</span> cases. In the <span id="S4.SS0.SSS0.Px1.p1.2.3" class="ltx_text ltx_font_bold">non-iid</span> case, the online REINFORCE algorithm pushes the mean learning rate down as it detects that a smaller learning rate yields greater loss reductions, while in the <span id="S4.SS0.SSS0.Px1.p1.2.4" class="ltx_text ltx_font_bold">iid</span> case, the mean learning rate is pushed up instead. This aligns with what a practitioner would do to ensure convergence in the more challenging <span id="S4.SS0.SSS0.Px1.p1.2.5" class="ltx_text ltx_font_bold">non-iid</span> case. The REINFORCE algorithm chooses to keep the mean number of SGD iterations per round relatively high for most of the training run. As shown in table <a href="#S4.T1" title="Table 1 ‣ MNIST ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, these choices yield slightly better accuracy (FA+AH) than the fixed training schedule used in the standard FA algorithm.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>MNIST accuracy figures</figcaption>
<table id="S4.T1.20.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.20.20.21.1" class="ltx_tr">
<th id="S4.T1.20.20.21.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r"></th>
<th id="S4.T1.20.20.21.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">
<table id="S4.T1.20.20.21.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.20.20.21.1.2.1.1" class="ltx_tr">
<td id="S4.T1.20.20.21.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Data</td>
</tr>
<tr id="S4.T1.20.20.21.1.2.1.2" class="ltx_tr">
<td id="S4.T1.20.20.21.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Distribution</td>
</tr>
</table>
</th>
<th id="S4.T1.20.20.21.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA</th>
<th id="S4.T1.20.20.21.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+WD</th>
<th id="S4.T1.20.20.21.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+RM+AH</th>
<th id="S4.T1.20.20.21.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+RM</th>
<th id="S4.T1.20.20.21.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+AH</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.5.5.5" class="ltx_tr">
<th id="S4.T1.5.5.5.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T1.5.5.5.6.1" class="ltx_text">C=1.0</span></th>
<th id="S4.T1.5.5.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">iid</th>
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="97.9\pm 0.1" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mn id="S4.T1.1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.1.m1.1.1.2.cmml">97.9</mn><mo id="S4.T1.1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2">97.9</cn><cn type="float" id="S4.T1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">97.9\pm 0.1</annotation></semantics></math></td>
<td id="S4.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="97.9\pm 0.005" display="inline"><semantics id="S4.T1.2.2.2.2.m1.1a"><mrow id="S4.T1.2.2.2.2.m1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.cmml"><mn id="S4.T1.2.2.2.2.m1.1.1.2" xref="S4.T1.2.2.2.2.m1.1.1.2.cmml">97.9</mn><mo id="S4.T1.2.2.2.2.m1.1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.2.2.2.2.m1.1.1.3" xref="S4.T1.2.2.2.2.m1.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.2.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.2.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.2.m1.1.1.2">97.9</cn><cn type="float" id="S4.T1.2.2.2.2.m1.1.1.3.cmml" xref="S4.T1.2.2.2.2.m1.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.1c">97.9\pm 0.005</annotation></semantics></math></td>
<td id="S4.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T1.3.3.3.3.m1.1" class="ltx_Math" alttext="97.9\pm 0.06" display="inline"><semantics id="S4.T1.3.3.3.3.m1.1a"><mrow id="S4.T1.3.3.3.3.m1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.cmml"><mn id="S4.T1.3.3.3.3.m1.1.1.2" xref="S4.T1.3.3.3.3.m1.1.1.2.cmml">97.9</mn><mo id="S4.T1.3.3.3.3.m1.1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.3.3.3.3.m1.1.1.3" xref="S4.T1.3.3.3.3.m1.1.1.3.cmml">0.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.m1.1b"><apply id="S4.T1.3.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.3.3.3.3.m1.1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.3.3.3.3.m1.1.1.2.cmml" xref="S4.T1.3.3.3.3.m1.1.1.2">97.9</cn><cn type="float" id="S4.T1.3.3.3.3.m1.1.1.3.cmml" xref="S4.T1.3.3.3.3.m1.1.1.3">0.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.m1.1c">97.9\pm 0.06</annotation></semantics></math></td>
<td id="S4.T1.4.4.4.4" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T1.4.4.4.4.m1.1" class="ltx_Math" alttext="97.8\pm 0.06" display="inline"><semantics id="S4.T1.4.4.4.4.m1.1a"><mrow id="S4.T1.4.4.4.4.m1.1.1" xref="S4.T1.4.4.4.4.m1.1.1.cmml"><mn id="S4.T1.4.4.4.4.m1.1.1.2" xref="S4.T1.4.4.4.4.m1.1.1.2.cmml">97.8</mn><mo id="S4.T1.4.4.4.4.m1.1.1.1" xref="S4.T1.4.4.4.4.m1.1.1.1.cmml">±</mo><mn id="S4.T1.4.4.4.4.m1.1.1.3" xref="S4.T1.4.4.4.4.m1.1.1.3.cmml">0.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.4.m1.1b"><apply id="S4.T1.4.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.4.m1.1.1"><csymbol cd="latexml" id="S4.T1.4.4.4.4.m1.1.1.1.cmml" xref="S4.T1.4.4.4.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.4.4.4.4.m1.1.1.2.cmml" xref="S4.T1.4.4.4.4.m1.1.1.2">97.8</cn><cn type="float" id="S4.T1.4.4.4.4.m1.1.1.3.cmml" xref="S4.T1.4.4.4.4.m1.1.1.3">0.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.4.m1.1c">97.8\pm 0.06</annotation></semantics></math></td>
<td id="S4.T1.5.5.5.5" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T1.5.5.5.5.m1.1" class="ltx_Math" alttext="{\bf 98.0\pm 0.04}" display="inline"><semantics id="S4.T1.5.5.5.5.m1.1a"><mrow id="S4.T1.5.5.5.5.m1.1.1" xref="S4.T1.5.5.5.5.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.5.5.5.5.m1.1.1.2" xref="S4.T1.5.5.5.5.m1.1.1.2.cmml">98.0</mn><mo id="S4.T1.5.5.5.5.m1.1.1.1" xref="S4.T1.5.5.5.5.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.5.5.5.5.m1.1.1.3" xref="S4.T1.5.5.5.5.m1.1.1.3.cmml">0.04</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.5.m1.1b"><apply id="S4.T1.5.5.5.5.m1.1.1.cmml" xref="S4.T1.5.5.5.5.m1.1.1"><csymbol cd="latexml" id="S4.T1.5.5.5.5.m1.1.1.1.cmml" xref="S4.T1.5.5.5.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.5.5.5.5.m1.1.1.2.cmml" xref="S4.T1.5.5.5.5.m1.1.1.2">98.0</cn><cn type="float" id="S4.T1.5.5.5.5.m1.1.1.3.cmml" xref="S4.T1.5.5.5.5.m1.1.1.3">0.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.5.m1.1c">{\bf 98.0\pm 0.04}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.10.10.10" class="ltx_tr">
<th id="S4.T1.10.10.10.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">non-iid</th>
<td id="S4.T1.6.6.6.1" class="ltx_td ltx_align_center"><math id="S4.T1.6.6.6.1.m1.1" class="ltx_Math" alttext="94.7\pm 0.07" display="inline"><semantics id="S4.T1.6.6.6.1.m1.1a"><mrow id="S4.T1.6.6.6.1.m1.1.1" xref="S4.T1.6.6.6.1.m1.1.1.cmml"><mn id="S4.T1.6.6.6.1.m1.1.1.2" xref="S4.T1.6.6.6.1.m1.1.1.2.cmml">94.7</mn><mo id="S4.T1.6.6.6.1.m1.1.1.1" xref="S4.T1.6.6.6.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.6.6.6.1.m1.1.1.3" xref="S4.T1.6.6.6.1.m1.1.1.3.cmml">0.07</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.1.m1.1b"><apply id="S4.T1.6.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.6.6.6.1.m1.1.1.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.6.6.6.1.m1.1.1.2.cmml" xref="S4.T1.6.6.6.1.m1.1.1.2">94.7</cn><cn type="float" id="S4.T1.6.6.6.1.m1.1.1.3.cmml" xref="S4.T1.6.6.6.1.m1.1.1.3">0.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.1.m1.1c">94.7\pm 0.07</annotation></semantics></math></td>
<td id="S4.T1.7.7.7.2" class="ltx_td ltx_align_center"><math id="S4.T1.7.7.7.2.m1.1" class="ltx_Math" alttext="94.8\pm 0.2" display="inline"><semantics id="S4.T1.7.7.7.2.m1.1a"><mrow id="S4.T1.7.7.7.2.m1.1.1" xref="S4.T1.7.7.7.2.m1.1.1.cmml"><mn id="S4.T1.7.7.7.2.m1.1.1.2" xref="S4.T1.7.7.7.2.m1.1.1.2.cmml">94.8</mn><mo id="S4.T1.7.7.7.2.m1.1.1.1" xref="S4.T1.7.7.7.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.7.7.7.2.m1.1.1.3" xref="S4.T1.7.7.7.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.2.m1.1b"><apply id="S4.T1.7.7.7.2.m1.1.1.cmml" xref="S4.T1.7.7.7.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.7.7.7.2.m1.1.1.1.cmml" xref="S4.T1.7.7.7.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.7.7.7.2.m1.1.1.2.cmml" xref="S4.T1.7.7.7.2.m1.1.1.2">94.8</cn><cn type="float" id="S4.T1.7.7.7.2.m1.1.1.3.cmml" xref="S4.T1.7.7.7.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.2.m1.1c">94.8\pm 0.2</annotation></semantics></math></td>
<td id="S4.T1.8.8.8.3" class="ltx_td ltx_align_center"><math id="S4.T1.8.8.8.3.m1.1" class="ltx_Math" alttext="94.7\pm 0.08" display="inline"><semantics id="S4.T1.8.8.8.3.m1.1a"><mrow id="S4.T1.8.8.8.3.m1.1.1" xref="S4.T1.8.8.8.3.m1.1.1.cmml"><mn id="S4.T1.8.8.8.3.m1.1.1.2" xref="S4.T1.8.8.8.3.m1.1.1.2.cmml">94.7</mn><mo id="S4.T1.8.8.8.3.m1.1.1.1" xref="S4.T1.8.8.8.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.8.8.8.3.m1.1.1.3" xref="S4.T1.8.8.8.3.m1.1.1.3.cmml">0.08</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.3.m1.1b"><apply id="S4.T1.8.8.8.3.m1.1.1.cmml" xref="S4.T1.8.8.8.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.8.8.8.3.m1.1.1.1.cmml" xref="S4.T1.8.8.8.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.8.8.8.3.m1.1.1.2.cmml" xref="S4.T1.8.8.8.3.m1.1.1.2">94.7</cn><cn type="float" id="S4.T1.8.8.8.3.m1.1.1.3.cmml" xref="S4.T1.8.8.8.3.m1.1.1.3">0.08</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.3.m1.1c">94.7\pm 0.08</annotation></semantics></math></td>
<td id="S4.T1.9.9.9.4" class="ltx_td ltx_align_center"><math id="S4.T1.9.9.9.4.m1.1" class="ltx_Math" alttext="94.5\pm 0.3" display="inline"><semantics id="S4.T1.9.9.9.4.m1.1a"><mrow id="S4.T1.9.9.9.4.m1.1.1" xref="S4.T1.9.9.9.4.m1.1.1.cmml"><mn id="S4.T1.9.9.9.4.m1.1.1.2" xref="S4.T1.9.9.9.4.m1.1.1.2.cmml">94.5</mn><mo id="S4.T1.9.9.9.4.m1.1.1.1" xref="S4.T1.9.9.9.4.m1.1.1.1.cmml">±</mo><mn id="S4.T1.9.9.9.4.m1.1.1.3" xref="S4.T1.9.9.9.4.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.4.m1.1b"><apply id="S4.T1.9.9.9.4.m1.1.1.cmml" xref="S4.T1.9.9.9.4.m1.1.1"><csymbol cd="latexml" id="S4.T1.9.9.9.4.m1.1.1.1.cmml" xref="S4.T1.9.9.9.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.9.9.9.4.m1.1.1.2.cmml" xref="S4.T1.9.9.9.4.m1.1.1.2">94.5</cn><cn type="float" id="S4.T1.9.9.9.4.m1.1.1.3.cmml" xref="S4.T1.9.9.9.4.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.4.m1.1c">94.5\pm 0.3</annotation></semantics></math></td>
<td id="S4.T1.10.10.10.5" class="ltx_td ltx_align_center"><math id="S4.T1.10.10.10.5.m1.1" class="ltx_Math" alttext="{\bf 95.5\pm 0.04}" display="inline"><semantics id="S4.T1.10.10.10.5.m1.1a"><mrow id="S4.T1.10.10.10.5.m1.1.1" xref="S4.T1.10.10.10.5.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.10.10.10.5.m1.1.1.2" xref="S4.T1.10.10.10.5.m1.1.1.2.cmml">95.5</mn><mo id="S4.T1.10.10.10.5.m1.1.1.1" xref="S4.T1.10.10.10.5.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.10.10.10.5.m1.1.1.3" xref="S4.T1.10.10.10.5.m1.1.1.3.cmml">0.04</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.10.5.m1.1b"><apply id="S4.T1.10.10.10.5.m1.1.1.cmml" xref="S4.T1.10.10.10.5.m1.1.1"><csymbol cd="latexml" id="S4.T1.10.10.10.5.m1.1.1.1.cmml" xref="S4.T1.10.10.10.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.10.10.10.5.m1.1.1.2.cmml" xref="S4.T1.10.10.10.5.m1.1.1.2">95.5</cn><cn type="float" id="S4.T1.10.10.10.5.m1.1.1.3.cmml" xref="S4.T1.10.10.10.5.m1.1.1.3">0.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.10.5.m1.1c">{\bf 95.5\pm 0.04}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.15.15.15" class="ltx_tr">
<th id="S4.T1.15.15.15.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T1.15.15.15.6.1" class="ltx_text">C=0.5</span></th>
<th id="S4.T1.15.15.15.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">iid</th>
<td id="S4.T1.11.11.11.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.11.11.11.1.m1.1" class="ltx_Math" alttext="97.4\pm 0.06" display="inline"><semantics id="S4.T1.11.11.11.1.m1.1a"><mrow id="S4.T1.11.11.11.1.m1.1.1" xref="S4.T1.11.11.11.1.m1.1.1.cmml"><mn id="S4.T1.11.11.11.1.m1.1.1.2" xref="S4.T1.11.11.11.1.m1.1.1.2.cmml">97.4</mn><mo id="S4.T1.11.11.11.1.m1.1.1.1" xref="S4.T1.11.11.11.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.11.11.11.1.m1.1.1.3" xref="S4.T1.11.11.11.1.m1.1.1.3.cmml">0.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.11.1.m1.1b"><apply id="S4.T1.11.11.11.1.m1.1.1.cmml" xref="S4.T1.11.11.11.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.11.11.11.1.m1.1.1.1.cmml" xref="S4.T1.11.11.11.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.11.11.11.1.m1.1.1.2.cmml" xref="S4.T1.11.11.11.1.m1.1.1.2">97.4</cn><cn type="float" id="S4.T1.11.11.11.1.m1.1.1.3.cmml" xref="S4.T1.11.11.11.1.m1.1.1.3">0.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.11.1.m1.1c">97.4\pm 0.06</annotation></semantics></math></td>
<td id="S4.T1.12.12.12.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.12.12.12.2.m1.1" class="ltx_Math" alttext="97.3\pm 0.03" display="inline"><semantics id="S4.T1.12.12.12.2.m1.1a"><mrow id="S4.T1.12.12.12.2.m1.1.1" xref="S4.T1.12.12.12.2.m1.1.1.cmml"><mn id="S4.T1.12.12.12.2.m1.1.1.2" xref="S4.T1.12.12.12.2.m1.1.1.2.cmml">97.3</mn><mo id="S4.T1.12.12.12.2.m1.1.1.1" xref="S4.T1.12.12.12.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.12.12.12.2.m1.1.1.3" xref="S4.T1.12.12.12.2.m1.1.1.3.cmml">0.03</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.12.2.m1.1b"><apply id="S4.T1.12.12.12.2.m1.1.1.cmml" xref="S4.T1.12.12.12.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.12.12.12.2.m1.1.1.1.cmml" xref="S4.T1.12.12.12.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.12.12.12.2.m1.1.1.2.cmml" xref="S4.T1.12.12.12.2.m1.1.1.2">97.3</cn><cn type="float" id="S4.T1.12.12.12.2.m1.1.1.3.cmml" xref="S4.T1.12.12.12.2.m1.1.1.3">0.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.12.2.m1.1c">97.3\pm 0.03</annotation></semantics></math></td>
<td id="S4.T1.13.13.13.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.13.13.13.3.m1.1" class="ltx_Math" alttext="98.1\pm 0.06" display="inline"><semantics id="S4.T1.13.13.13.3.m1.1a"><mrow id="S4.T1.13.13.13.3.m1.1.1" xref="S4.T1.13.13.13.3.m1.1.1.cmml"><mn id="S4.T1.13.13.13.3.m1.1.1.2" xref="S4.T1.13.13.13.3.m1.1.1.2.cmml">98.1</mn><mo id="S4.T1.13.13.13.3.m1.1.1.1" xref="S4.T1.13.13.13.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.13.13.13.3.m1.1.1.3" xref="S4.T1.13.13.13.3.m1.1.1.3.cmml">0.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.13.3.m1.1b"><apply id="S4.T1.13.13.13.3.m1.1.1.cmml" xref="S4.T1.13.13.13.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.13.13.13.3.m1.1.1.1.cmml" xref="S4.T1.13.13.13.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.13.13.13.3.m1.1.1.2.cmml" xref="S4.T1.13.13.13.3.m1.1.1.2">98.1</cn><cn type="float" id="S4.T1.13.13.13.3.m1.1.1.3.cmml" xref="S4.T1.13.13.13.3.m1.1.1.3">0.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.13.3.m1.1c">98.1\pm 0.06</annotation></semantics></math></td>
<td id="S4.T1.14.14.14.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.14.14.14.4.m1.1" class="ltx_Math" alttext="97.4\pm 0.05" display="inline"><semantics id="S4.T1.14.14.14.4.m1.1a"><mrow id="S4.T1.14.14.14.4.m1.1.1" xref="S4.T1.14.14.14.4.m1.1.1.cmml"><mn id="S4.T1.14.14.14.4.m1.1.1.2" xref="S4.T1.14.14.14.4.m1.1.1.2.cmml">97.4</mn><mo id="S4.T1.14.14.14.4.m1.1.1.1" xref="S4.T1.14.14.14.4.m1.1.1.1.cmml">±</mo><mn id="S4.T1.14.14.14.4.m1.1.1.3" xref="S4.T1.14.14.14.4.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.14.4.m1.1b"><apply id="S4.T1.14.14.14.4.m1.1.1.cmml" xref="S4.T1.14.14.14.4.m1.1.1"><csymbol cd="latexml" id="S4.T1.14.14.14.4.m1.1.1.1.cmml" xref="S4.T1.14.14.14.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.14.14.14.4.m1.1.1.2.cmml" xref="S4.T1.14.14.14.4.m1.1.1.2">97.4</cn><cn type="float" id="S4.T1.14.14.14.4.m1.1.1.3.cmml" xref="S4.T1.14.14.14.4.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.14.4.m1.1c">97.4\pm 0.05</annotation></semantics></math></td>
<td id="S4.T1.15.15.15.5" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.15.15.15.5.m1.1" class="ltx_Math" alttext="{\bf 98.2\pm 0.01}" display="inline"><semantics id="S4.T1.15.15.15.5.m1.1a"><mrow id="S4.T1.15.15.15.5.m1.1.1" xref="S4.T1.15.15.15.5.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.15.15.15.5.m1.1.1.2" xref="S4.T1.15.15.15.5.m1.1.1.2.cmml">98.2</mn><mo id="S4.T1.15.15.15.5.m1.1.1.1" xref="S4.T1.15.15.15.5.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.15.15.15.5.m1.1.1.3" xref="S4.T1.15.15.15.5.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.15.5.m1.1b"><apply id="S4.T1.15.15.15.5.m1.1.1.cmml" xref="S4.T1.15.15.15.5.m1.1.1"><csymbol cd="latexml" id="S4.T1.15.15.15.5.m1.1.1.1.cmml" xref="S4.T1.15.15.15.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.15.15.15.5.m1.1.1.2.cmml" xref="S4.T1.15.15.15.5.m1.1.1.2">98.2</cn><cn type="float" id="S4.T1.15.15.15.5.m1.1.1.3.cmml" xref="S4.T1.15.15.15.5.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.15.5.m1.1c">{\bf 98.2\pm 0.01}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.20.20.20" class="ltx_tr">
<th id="S4.T1.20.20.20.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">non-iid</th>
<td id="S4.T1.16.16.16.1" class="ltx_td ltx_align_center"><math id="S4.T1.16.16.16.1.m1.1" class="ltx_Math" alttext="92.1\pm 0.8" display="inline"><semantics id="S4.T1.16.16.16.1.m1.1a"><mrow id="S4.T1.16.16.16.1.m1.1.1" xref="S4.T1.16.16.16.1.m1.1.1.cmml"><mn id="S4.T1.16.16.16.1.m1.1.1.2" xref="S4.T1.16.16.16.1.m1.1.1.2.cmml">92.1</mn><mo id="S4.T1.16.16.16.1.m1.1.1.1" xref="S4.T1.16.16.16.1.m1.1.1.1.cmml">±</mo><mn id="S4.T1.16.16.16.1.m1.1.1.3" xref="S4.T1.16.16.16.1.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.16.16.16.1.m1.1b"><apply id="S4.T1.16.16.16.1.m1.1.1.cmml" xref="S4.T1.16.16.16.1.m1.1.1"><csymbol cd="latexml" id="S4.T1.16.16.16.1.m1.1.1.1.cmml" xref="S4.T1.16.16.16.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.16.16.16.1.m1.1.1.2.cmml" xref="S4.T1.16.16.16.1.m1.1.1.2">92.1</cn><cn type="float" id="S4.T1.16.16.16.1.m1.1.1.3.cmml" xref="S4.T1.16.16.16.1.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.16.16.1.m1.1c">92.1\pm 0.8</annotation></semantics></math></td>
<td id="S4.T1.17.17.17.2" class="ltx_td ltx_align_center"><math id="S4.T1.17.17.17.2.m1.1" class="ltx_Math" alttext="92.0\pm 0.4" display="inline"><semantics id="S4.T1.17.17.17.2.m1.1a"><mrow id="S4.T1.17.17.17.2.m1.1.1" xref="S4.T1.17.17.17.2.m1.1.1.cmml"><mn id="S4.T1.17.17.17.2.m1.1.1.2" xref="S4.T1.17.17.17.2.m1.1.1.2.cmml">92.0</mn><mo id="S4.T1.17.17.17.2.m1.1.1.1" xref="S4.T1.17.17.17.2.m1.1.1.1.cmml">±</mo><mn id="S4.T1.17.17.17.2.m1.1.1.3" xref="S4.T1.17.17.17.2.m1.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.17.17.17.2.m1.1b"><apply id="S4.T1.17.17.17.2.m1.1.1.cmml" xref="S4.T1.17.17.17.2.m1.1.1"><csymbol cd="latexml" id="S4.T1.17.17.17.2.m1.1.1.1.cmml" xref="S4.T1.17.17.17.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.17.17.17.2.m1.1.1.2.cmml" xref="S4.T1.17.17.17.2.m1.1.1.2">92.0</cn><cn type="float" id="S4.T1.17.17.17.2.m1.1.1.3.cmml" xref="S4.T1.17.17.17.2.m1.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.17.17.2.m1.1c">92.0\pm 0.4</annotation></semantics></math></td>
<td id="S4.T1.18.18.18.3" class="ltx_td ltx_align_center"><math id="S4.T1.18.18.18.3.m1.1" class="ltx_Math" alttext="92.5\pm 0.1" display="inline"><semantics id="S4.T1.18.18.18.3.m1.1a"><mrow id="S4.T1.18.18.18.3.m1.1.1" xref="S4.T1.18.18.18.3.m1.1.1.cmml"><mn id="S4.T1.18.18.18.3.m1.1.1.2" xref="S4.T1.18.18.18.3.m1.1.1.2.cmml">92.5</mn><mo id="S4.T1.18.18.18.3.m1.1.1.1" xref="S4.T1.18.18.18.3.m1.1.1.1.cmml">±</mo><mn id="S4.T1.18.18.18.3.m1.1.1.3" xref="S4.T1.18.18.18.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.18.18.18.3.m1.1b"><apply id="S4.T1.18.18.18.3.m1.1.1.cmml" xref="S4.T1.18.18.18.3.m1.1.1"><csymbol cd="latexml" id="S4.T1.18.18.18.3.m1.1.1.1.cmml" xref="S4.T1.18.18.18.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.18.18.18.3.m1.1.1.2.cmml" xref="S4.T1.18.18.18.3.m1.1.1.2">92.5</cn><cn type="float" id="S4.T1.18.18.18.3.m1.1.1.3.cmml" xref="S4.T1.18.18.18.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.18.18.3.m1.1c">92.5\pm 0.1</annotation></semantics></math></td>
<td id="S4.T1.19.19.19.4" class="ltx_td ltx_align_center"><math id="S4.T1.19.19.19.4.m1.1" class="ltx_Math" alttext="91.6\pm 0.3" display="inline"><semantics id="S4.T1.19.19.19.4.m1.1a"><mrow id="S4.T1.19.19.19.4.m1.1.1" xref="S4.T1.19.19.19.4.m1.1.1.cmml"><mn id="S4.T1.19.19.19.4.m1.1.1.2" xref="S4.T1.19.19.19.4.m1.1.1.2.cmml">91.6</mn><mo id="S4.T1.19.19.19.4.m1.1.1.1" xref="S4.T1.19.19.19.4.m1.1.1.1.cmml">±</mo><mn id="S4.T1.19.19.19.4.m1.1.1.3" xref="S4.T1.19.19.19.4.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.19.19.19.4.m1.1b"><apply id="S4.T1.19.19.19.4.m1.1.1.cmml" xref="S4.T1.19.19.19.4.m1.1.1"><csymbol cd="latexml" id="S4.T1.19.19.19.4.m1.1.1.1.cmml" xref="S4.T1.19.19.19.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.19.19.19.4.m1.1.1.2.cmml" xref="S4.T1.19.19.19.4.m1.1.1.2">91.6</cn><cn type="float" id="S4.T1.19.19.19.4.m1.1.1.3.cmml" xref="S4.T1.19.19.19.4.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.19.19.4.m1.1c">91.6\pm 0.3</annotation></semantics></math></td>
<td id="S4.T1.20.20.20.5" class="ltx_td ltx_align_center"><math id="S4.T1.20.20.20.5.m1.1" class="ltx_Math" alttext="{\bf 93.2\pm 0.8}" display="inline"><semantics id="S4.T1.20.20.20.5.m1.1a"><mrow id="S4.T1.20.20.20.5.m1.1.1" xref="S4.T1.20.20.20.5.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.20.20.20.5.m1.1.1.2" xref="S4.T1.20.20.20.5.m1.1.1.2.cmml">93.2</mn><mo id="S4.T1.20.20.20.5.m1.1.1.1" xref="S4.T1.20.20.20.5.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T1.20.20.20.5.m1.1.1.3" xref="S4.T1.20.20.20.5.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.20.20.20.5.m1.1b"><apply id="S4.T1.20.20.20.5.m1.1.1.cmml" xref="S4.T1.20.20.20.5.m1.1.1"><csymbol cd="latexml" id="S4.T1.20.20.20.5.m1.1.1.1.cmml" xref="S4.T1.20.20.20.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T1.20.20.20.5.m1.1.1.2.cmml" xref="S4.T1.20.20.20.5.m1.1.1.2">93.2</cn><cn type="float" id="S4.T1.20.20.20.5.m1.1.1.3.cmml" xref="S4.T1.20.20.20.5.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.20.20.5.m1.1c">{\bf 93.2\pm 0.8}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">CIFAR10</h4>

<div id="S4.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px2.p1.1" class="ltx_p">: We use a network with two convolutional layers (with 32 and 64 feature maps and 5x5 kernels) followed by two fully connected layers (with 1024 and 10 neurons). 2x2 max pooling was used after each convolutional layer. As shown in table <a href="#S4.T2" title="Table 2 ‣ CIFAR10 ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the use of representation matching yields a significant improvement in accuracy for the <span id="S4.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_bold">non-iid</span> case while slightly improving performance in the <span id="S4.SS0.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_bold">iid</span> case. The benefit of adaptive hyper-parameters over a fixed hyper-parameter schedule are more equivocal. The evolution of adaptive hyper-parameters is shown in the second column of Fig. <a href="#S4.F3" title="Figure 3 ‣ Keyword spotting task ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Unlike the MNIST case, the REINFORCE algorithm chooses to push down the learning rate for the <span id="S4.SS0.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_bold">iid</span> case as well which actually leads to better performance in the <span id="S4.SS0.SSS0.Px2.p1.1.4" class="ltx_text ltx_font_bold">iid</span> case compared to the fixed schedule (FA vs. FA+AH and FA+RM+AH vs. FA+RM in table <a href="#S4.T2" title="Table 2 ‣ CIFAR10 ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). In the <span id="S4.SS0.SSS0.Px2.p1.1.5" class="ltx_text ltx_font_bold">non-iid</span> case, the fixed schedule performs better, though.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>CIFAR10 accuracy figures </figcaption>
<table id="S4.T2.20.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.20.20.21.1" class="ltx_tr">
<th id="S4.T2.20.20.21.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r"></th>
<th id="S4.T2.20.20.21.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">
<table id="S4.T2.20.20.21.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.20.20.21.1.2.1.1" class="ltx_tr">
<td id="S4.T2.20.20.21.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Data</td>
</tr>
<tr id="S4.T2.20.20.21.1.2.1.2" class="ltx_tr">
<td id="S4.T2.20.20.21.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Distribution</td>
</tr>
</table>
</th>
<th id="S4.T2.20.20.21.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA</th>
<th id="S4.T2.20.20.21.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+WD</th>
<th id="S4.T2.20.20.21.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+RM+AH</th>
<th id="S4.T2.20.20.21.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+RM</th>
<th id="S4.T2.20.20.21.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+AH</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.5.5.5" class="ltx_tr">
<th id="S4.T2.5.5.5.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T2.5.5.5.6.1" class="ltx_text">C=1.0</span></th>
<th id="S4.T2.5.5.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">iid</th>
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="81.9\pm 0.3" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mn id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml">81.9</mn><mo id="S4.T2.1.1.1.1.m1.1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">±</mo><mn id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">81.9</cn><cn type="float" id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">81.9\pm 0.3</annotation></semantics></math></td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="81.4\pm 0.2" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mrow id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml"><mn id="S4.T2.2.2.2.2.m1.1.1.2" xref="S4.T2.2.2.2.2.m1.1.1.2.cmml">81.4</mn><mo id="S4.T2.2.2.2.2.m1.1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.1.cmml">±</mo><mn id="S4.T2.2.2.2.2.m1.1.1.3" xref="S4.T2.2.2.2.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2">81.4</cn><cn type="float" id="S4.T2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">81.4\pm 0.2</annotation></semantics></math></td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="{\bf 84.3\pm 0.1}" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mrow id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.3.3.3.3.m1.1.1.2" xref="S4.T2.3.3.3.3.m1.1.1.2.cmml">84.3</mn><mo id="S4.T2.3.3.3.3.m1.1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.3.3.3.3.m1.1.1.3" xref="S4.T2.3.3.3.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><apply id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.3.3.3.3.m1.1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.3.3.3.3.m1.1.1.2.cmml" xref="S4.T2.3.3.3.3.m1.1.1.2">84.3</cn><cn type="float" id="S4.T2.3.3.3.3.m1.1.1.3.cmml" xref="S4.T2.3.3.3.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">{\bf 84.3\pm 0.1}</annotation></semantics></math></td>
<td id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T2.4.4.4.4.m1.1" class="ltx_Math" alttext="83.5\pm 0.1" display="inline"><semantics id="S4.T2.4.4.4.4.m1.1a"><mrow id="S4.T2.4.4.4.4.m1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.cmml"><mn id="S4.T2.4.4.4.4.m1.1.1.2" xref="S4.T2.4.4.4.4.m1.1.1.2.cmml">83.5</mn><mo id="S4.T2.4.4.4.4.m1.1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.1.cmml">±</mo><mn id="S4.T2.4.4.4.4.m1.1.1.3" xref="S4.T2.4.4.4.4.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.m1.1b"><apply id="S4.T2.4.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1"><csymbol cd="latexml" id="S4.T2.4.4.4.4.m1.1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.4.4.4.4.m1.1.1.2.cmml" xref="S4.T2.4.4.4.4.m1.1.1.2">83.5</cn><cn type="float" id="S4.T2.4.4.4.4.m1.1.1.3.cmml" xref="S4.T2.4.4.4.4.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.m1.1c">83.5\pm 0.1</annotation></semantics></math></td>
<td id="S4.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T2.5.5.5.5.m1.1" class="ltx_Math" alttext="83.4\pm 1.2" display="inline"><semantics id="S4.T2.5.5.5.5.m1.1a"><mrow id="S4.T2.5.5.5.5.m1.1.1" xref="S4.T2.5.5.5.5.m1.1.1.cmml"><mn id="S4.T2.5.5.5.5.m1.1.1.2" xref="S4.T2.5.5.5.5.m1.1.1.2.cmml">83.4</mn><mo id="S4.T2.5.5.5.5.m1.1.1.1" xref="S4.T2.5.5.5.5.m1.1.1.1.cmml">±</mo><mn id="S4.T2.5.5.5.5.m1.1.1.3" xref="S4.T2.5.5.5.5.m1.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.5.m1.1b"><apply id="S4.T2.5.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1"><csymbol cd="latexml" id="S4.T2.5.5.5.5.m1.1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.5.5.5.5.m1.1.1.2.cmml" xref="S4.T2.5.5.5.5.m1.1.1.2">83.4</cn><cn type="float" id="S4.T2.5.5.5.5.m1.1.1.3.cmml" xref="S4.T2.5.5.5.5.m1.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.5.m1.1c">83.4\pm 1.2</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.10.10.10" class="ltx_tr">
<th id="S4.T2.10.10.10.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">non-iid</th>
<td id="S4.T2.6.6.6.1" class="ltx_td ltx_align_center"><math id="S4.T2.6.6.6.1.m1.1" class="ltx_Math" alttext="44.2\pm 0.9" display="inline"><semantics id="S4.T2.6.6.6.1.m1.1a"><mrow id="S4.T2.6.6.6.1.m1.1.1" xref="S4.T2.6.6.6.1.m1.1.1.cmml"><mn id="S4.T2.6.6.6.1.m1.1.1.2" xref="S4.T2.6.6.6.1.m1.1.1.2.cmml">44.2</mn><mo id="S4.T2.6.6.6.1.m1.1.1.1" xref="S4.T2.6.6.6.1.m1.1.1.1.cmml">±</mo><mn id="S4.T2.6.6.6.1.m1.1.1.3" xref="S4.T2.6.6.6.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.1.m1.1b"><apply id="S4.T2.6.6.6.1.m1.1.1.cmml" xref="S4.T2.6.6.6.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.6.6.6.1.m1.1.1.1.cmml" xref="S4.T2.6.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.6.6.6.1.m1.1.1.2.cmml" xref="S4.T2.6.6.6.1.m1.1.1.2">44.2</cn><cn type="float" id="S4.T2.6.6.6.1.m1.1.1.3.cmml" xref="S4.T2.6.6.6.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.1.m1.1c">44.2\pm 0.9</annotation></semantics></math></td>
<td id="S4.T2.7.7.7.2" class="ltx_td ltx_align_center"><math id="S4.T2.7.7.7.2.m1.1" class="ltx_Math" alttext="44.3\pm 0.8" display="inline"><semantics id="S4.T2.7.7.7.2.m1.1a"><mrow id="S4.T2.7.7.7.2.m1.1.1" xref="S4.T2.7.7.7.2.m1.1.1.cmml"><mn id="S4.T2.7.7.7.2.m1.1.1.2" xref="S4.T2.7.7.7.2.m1.1.1.2.cmml">44.3</mn><mo id="S4.T2.7.7.7.2.m1.1.1.1" xref="S4.T2.7.7.7.2.m1.1.1.1.cmml">±</mo><mn id="S4.T2.7.7.7.2.m1.1.1.3" xref="S4.T2.7.7.7.2.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.2.m1.1b"><apply id="S4.T2.7.7.7.2.m1.1.1.cmml" xref="S4.T2.7.7.7.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.7.7.7.2.m1.1.1.1.cmml" xref="S4.T2.7.7.7.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.7.7.7.2.m1.1.1.2.cmml" xref="S4.T2.7.7.7.2.m1.1.1.2">44.3</cn><cn type="float" id="S4.T2.7.7.7.2.m1.1.1.3.cmml" xref="S4.T2.7.7.7.2.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.2.m1.1c">44.3\pm 0.8</annotation></semantics></math></td>
<td id="S4.T2.8.8.8.3" class="ltx_td ltx_align_center"><math id="S4.T2.8.8.8.3.m1.1" class="ltx_Math" alttext="52.4\pm 2.2" display="inline"><semantics id="S4.T2.8.8.8.3.m1.1a"><mrow id="S4.T2.8.8.8.3.m1.1.1" xref="S4.T2.8.8.8.3.m1.1.1.cmml"><mn id="S4.T2.8.8.8.3.m1.1.1.2" xref="S4.T2.8.8.8.3.m1.1.1.2.cmml">52.4</mn><mo id="S4.T2.8.8.8.3.m1.1.1.1" xref="S4.T2.8.8.8.3.m1.1.1.1.cmml">±</mo><mn id="S4.T2.8.8.8.3.m1.1.1.3" xref="S4.T2.8.8.8.3.m1.1.1.3.cmml">2.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.3.m1.1b"><apply id="S4.T2.8.8.8.3.m1.1.1.cmml" xref="S4.T2.8.8.8.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.8.8.8.3.m1.1.1.1.cmml" xref="S4.T2.8.8.8.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.8.8.8.3.m1.1.1.2.cmml" xref="S4.T2.8.8.8.3.m1.1.1.2">52.4</cn><cn type="float" id="S4.T2.8.8.8.3.m1.1.1.3.cmml" xref="S4.T2.8.8.8.3.m1.1.1.3">2.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.3.m1.1c">52.4\pm 2.2</annotation></semantics></math></td>
<td id="S4.T2.9.9.9.4" class="ltx_td ltx_align_center"><math id="S4.T2.9.9.9.4.m1.1" class="ltx_Math" alttext="{\bf 52.9\pm 0.05}" display="inline"><semantics id="S4.T2.9.9.9.4.m1.1a"><mrow id="S4.T2.9.9.9.4.m1.1.1" xref="S4.T2.9.9.9.4.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.9.9.9.4.m1.1.1.2" xref="S4.T2.9.9.9.4.m1.1.1.2.cmml">52.9</mn><mo id="S4.T2.9.9.9.4.m1.1.1.1" xref="S4.T2.9.9.9.4.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.9.9.9.4.m1.1.1.3" xref="S4.T2.9.9.9.4.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.4.m1.1b"><apply id="S4.T2.9.9.9.4.m1.1.1.cmml" xref="S4.T2.9.9.9.4.m1.1.1"><csymbol cd="latexml" id="S4.T2.9.9.9.4.m1.1.1.1.cmml" xref="S4.T2.9.9.9.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.9.9.9.4.m1.1.1.2.cmml" xref="S4.T2.9.9.9.4.m1.1.1.2">52.9</cn><cn type="float" id="S4.T2.9.9.9.4.m1.1.1.3.cmml" xref="S4.T2.9.9.9.4.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.4.m1.1c">{\bf 52.9\pm 0.05}</annotation></semantics></math></td>
<td id="S4.T2.10.10.10.5" class="ltx_td ltx_align_center"><math id="S4.T2.10.10.10.5.m1.1" class="ltx_Math" alttext="44.8\pm 5.8" display="inline"><semantics id="S4.T2.10.10.10.5.m1.1a"><mrow id="S4.T2.10.10.10.5.m1.1.1" xref="S4.T2.10.10.10.5.m1.1.1.cmml"><mn id="S4.T2.10.10.10.5.m1.1.1.2" xref="S4.T2.10.10.10.5.m1.1.1.2.cmml">44.8</mn><mo id="S4.T2.10.10.10.5.m1.1.1.1" xref="S4.T2.10.10.10.5.m1.1.1.1.cmml">±</mo><mn id="S4.T2.10.10.10.5.m1.1.1.3" xref="S4.T2.10.10.10.5.m1.1.1.3.cmml">5.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.5.m1.1b"><apply id="S4.T2.10.10.10.5.m1.1.1.cmml" xref="S4.T2.10.10.10.5.m1.1.1"><csymbol cd="latexml" id="S4.T2.10.10.10.5.m1.1.1.1.cmml" xref="S4.T2.10.10.10.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.10.10.10.5.m1.1.1.2.cmml" xref="S4.T2.10.10.10.5.m1.1.1.2">44.8</cn><cn type="float" id="S4.T2.10.10.10.5.m1.1.1.3.cmml" xref="S4.T2.10.10.10.5.m1.1.1.3">5.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.5.m1.1c">44.8\pm 5.8</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.15.15.15" class="ltx_tr">
<th id="S4.T2.15.15.15.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T2.15.15.15.6.1" class="ltx_text">C=0.5</span></th>
<th id="S4.T2.15.15.15.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">iid</th>
<td id="S4.T2.11.11.11.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.11.11.11.1.m1.1" class="ltx_Math" alttext="76.8\pm 0.3" display="inline"><semantics id="S4.T2.11.11.11.1.m1.1a"><mrow id="S4.T2.11.11.11.1.m1.1.1" xref="S4.T2.11.11.11.1.m1.1.1.cmml"><mn id="S4.T2.11.11.11.1.m1.1.1.2" xref="S4.T2.11.11.11.1.m1.1.1.2.cmml">76.8</mn><mo id="S4.T2.11.11.11.1.m1.1.1.1" xref="S4.T2.11.11.11.1.m1.1.1.1.cmml">±</mo><mn id="S4.T2.11.11.11.1.m1.1.1.3" xref="S4.T2.11.11.11.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.1.m1.1b"><apply id="S4.T2.11.11.11.1.m1.1.1.cmml" xref="S4.T2.11.11.11.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.11.11.11.1.m1.1.1.1.cmml" xref="S4.T2.11.11.11.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.11.11.11.1.m1.1.1.2.cmml" xref="S4.T2.11.11.11.1.m1.1.1.2">76.8</cn><cn type="float" id="S4.T2.11.11.11.1.m1.1.1.3.cmml" xref="S4.T2.11.11.11.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.1.m1.1c">76.8\pm 0.3</annotation></semantics></math></td>
<td id="S4.T2.12.12.12.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.12.12.12.2.m1.1" class="ltx_Math" alttext="76.6\pm 0.2" display="inline"><semantics id="S4.T2.12.12.12.2.m1.1a"><mrow id="S4.T2.12.12.12.2.m1.1.1" xref="S4.T2.12.12.12.2.m1.1.1.cmml"><mn id="S4.T2.12.12.12.2.m1.1.1.2" xref="S4.T2.12.12.12.2.m1.1.1.2.cmml">76.6</mn><mo id="S4.T2.12.12.12.2.m1.1.1.1" xref="S4.T2.12.12.12.2.m1.1.1.1.cmml">±</mo><mn id="S4.T2.12.12.12.2.m1.1.1.3" xref="S4.T2.12.12.12.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.2.m1.1b"><apply id="S4.T2.12.12.12.2.m1.1.1.cmml" xref="S4.T2.12.12.12.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.12.12.12.2.m1.1.1.1.cmml" xref="S4.T2.12.12.12.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.12.12.12.2.m1.1.1.2.cmml" xref="S4.T2.12.12.12.2.m1.1.1.2">76.6</cn><cn type="float" id="S4.T2.12.12.12.2.m1.1.1.3.cmml" xref="S4.T2.12.12.12.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.2.m1.1c">76.6\pm 0.2</annotation></semantics></math></td>
<td id="S4.T2.13.13.13.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.13.13.13.3.m1.1" class="ltx_Math" alttext="{\bf 79.2\pm 1.9}" display="inline"><semantics id="S4.T2.13.13.13.3.m1.1a"><mrow id="S4.T2.13.13.13.3.m1.1.1" xref="S4.T2.13.13.13.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.13.13.13.3.m1.1.1.2" xref="S4.T2.13.13.13.3.m1.1.1.2.cmml">79.2</mn><mo id="S4.T2.13.13.13.3.m1.1.1.1" xref="S4.T2.13.13.13.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.13.13.13.3.m1.1.1.3" xref="S4.T2.13.13.13.3.m1.1.1.3.cmml">1.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.13.3.m1.1b"><apply id="S4.T2.13.13.13.3.m1.1.1.cmml" xref="S4.T2.13.13.13.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.13.13.13.3.m1.1.1.1.cmml" xref="S4.T2.13.13.13.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.13.13.13.3.m1.1.1.2.cmml" xref="S4.T2.13.13.13.3.m1.1.1.2">79.2</cn><cn type="float" id="S4.T2.13.13.13.3.m1.1.1.3.cmml" xref="S4.T2.13.13.13.3.m1.1.1.3">1.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.13.3.m1.1c">{\bf 79.2\pm 1.9}</annotation></semantics></math></td>
<td id="S4.T2.14.14.14.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.14.14.14.4.m1.1" class="ltx_Math" alttext="76.0\pm 0.2" display="inline"><semantics id="S4.T2.14.14.14.4.m1.1a"><mrow id="S4.T2.14.14.14.4.m1.1.1" xref="S4.T2.14.14.14.4.m1.1.1.cmml"><mn id="S4.T2.14.14.14.4.m1.1.1.2" xref="S4.T2.14.14.14.4.m1.1.1.2.cmml">76.0</mn><mo id="S4.T2.14.14.14.4.m1.1.1.1" xref="S4.T2.14.14.14.4.m1.1.1.1.cmml">±</mo><mn id="S4.T2.14.14.14.4.m1.1.1.3" xref="S4.T2.14.14.14.4.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.14.4.m1.1b"><apply id="S4.T2.14.14.14.4.m1.1.1.cmml" xref="S4.T2.14.14.14.4.m1.1.1"><csymbol cd="latexml" id="S4.T2.14.14.14.4.m1.1.1.1.cmml" xref="S4.T2.14.14.14.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.14.14.14.4.m1.1.1.2.cmml" xref="S4.T2.14.14.14.4.m1.1.1.2">76.0</cn><cn type="float" id="S4.T2.14.14.14.4.m1.1.1.3.cmml" xref="S4.T2.14.14.14.4.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.14.4.m1.1c">76.0\pm 0.2</annotation></semantics></math></td>
<td id="S4.T2.15.15.15.5" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T2.15.15.15.5.m1.1" class="ltx_Math" alttext="82.0\pm 1.04" display="inline"><semantics id="S4.T2.15.15.15.5.m1.1a"><mrow id="S4.T2.15.15.15.5.m1.1.1" xref="S4.T2.15.15.15.5.m1.1.1.cmml"><mn id="S4.T2.15.15.15.5.m1.1.1.2" xref="S4.T2.15.15.15.5.m1.1.1.2.cmml">82.0</mn><mo id="S4.T2.15.15.15.5.m1.1.1.1" xref="S4.T2.15.15.15.5.m1.1.1.1.cmml">±</mo><mn id="S4.T2.15.15.15.5.m1.1.1.3" xref="S4.T2.15.15.15.5.m1.1.1.3.cmml">1.04</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.15.5.m1.1b"><apply id="S4.T2.15.15.15.5.m1.1.1.cmml" xref="S4.T2.15.15.15.5.m1.1.1"><csymbol cd="latexml" id="S4.T2.15.15.15.5.m1.1.1.1.cmml" xref="S4.T2.15.15.15.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.15.15.15.5.m1.1.1.2.cmml" xref="S4.T2.15.15.15.5.m1.1.1.2">82.0</cn><cn type="float" id="S4.T2.15.15.15.5.m1.1.1.3.cmml" xref="S4.T2.15.15.15.5.m1.1.1.3">1.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.15.5.m1.1c">82.0\pm 1.04</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.20.20.20" class="ltx_tr">
<th id="S4.T2.20.20.20.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">non-iid</th>
<td id="S4.T2.16.16.16.1" class="ltx_td ltx_align_center"><math id="S4.T2.16.16.16.1.m1.1" class="ltx_Math" alttext="33.4\pm 1.0" display="inline"><semantics id="S4.T2.16.16.16.1.m1.1a"><mrow id="S4.T2.16.16.16.1.m1.1.1" xref="S4.T2.16.16.16.1.m1.1.1.cmml"><mn id="S4.T2.16.16.16.1.m1.1.1.2" xref="S4.T2.16.16.16.1.m1.1.1.2.cmml">33.4</mn><mo id="S4.T2.16.16.16.1.m1.1.1.1" xref="S4.T2.16.16.16.1.m1.1.1.1.cmml">±</mo><mn id="S4.T2.16.16.16.1.m1.1.1.3" xref="S4.T2.16.16.16.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.16.1.m1.1b"><apply id="S4.T2.16.16.16.1.m1.1.1.cmml" xref="S4.T2.16.16.16.1.m1.1.1"><csymbol cd="latexml" id="S4.T2.16.16.16.1.m1.1.1.1.cmml" xref="S4.T2.16.16.16.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.16.16.16.1.m1.1.1.2.cmml" xref="S4.T2.16.16.16.1.m1.1.1.2">33.4</cn><cn type="float" id="S4.T2.16.16.16.1.m1.1.1.3.cmml" xref="S4.T2.16.16.16.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.16.1.m1.1c">33.4\pm 1.0</annotation></semantics></math></td>
<td id="S4.T2.17.17.17.2" class="ltx_td ltx_align_center"><math id="S4.T2.17.17.17.2.m1.1" class="ltx_Math" alttext="34.4\pm 0.9" display="inline"><semantics id="S4.T2.17.17.17.2.m1.1a"><mrow id="S4.T2.17.17.17.2.m1.1.1" xref="S4.T2.17.17.17.2.m1.1.1.cmml"><mn id="S4.T2.17.17.17.2.m1.1.1.2" xref="S4.T2.17.17.17.2.m1.1.1.2.cmml">34.4</mn><mo id="S4.T2.17.17.17.2.m1.1.1.1" xref="S4.T2.17.17.17.2.m1.1.1.1.cmml">±</mo><mn id="S4.T2.17.17.17.2.m1.1.1.3" xref="S4.T2.17.17.17.2.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.17.17.17.2.m1.1b"><apply id="S4.T2.17.17.17.2.m1.1.1.cmml" xref="S4.T2.17.17.17.2.m1.1.1"><csymbol cd="latexml" id="S4.T2.17.17.17.2.m1.1.1.1.cmml" xref="S4.T2.17.17.17.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.17.17.17.2.m1.1.1.2.cmml" xref="S4.T2.17.17.17.2.m1.1.1.2">34.4</cn><cn type="float" id="S4.T2.17.17.17.2.m1.1.1.3.cmml" xref="S4.T2.17.17.17.2.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.17.17.2.m1.1c">34.4\pm 0.9</annotation></semantics></math></td>
<td id="S4.T2.18.18.18.3" class="ltx_td ltx_align_center"><math id="S4.T2.18.18.18.3.m1.1" class="ltx_Math" alttext="39.8\pm 3.8" display="inline"><semantics id="S4.T2.18.18.18.3.m1.1a"><mrow id="S4.T2.18.18.18.3.m1.1.1" xref="S4.T2.18.18.18.3.m1.1.1.cmml"><mn id="S4.T2.18.18.18.3.m1.1.1.2" xref="S4.T2.18.18.18.3.m1.1.1.2.cmml">39.8</mn><mo id="S4.T2.18.18.18.3.m1.1.1.1" xref="S4.T2.18.18.18.3.m1.1.1.1.cmml">±</mo><mn id="S4.T2.18.18.18.3.m1.1.1.3" xref="S4.T2.18.18.18.3.m1.1.1.3.cmml">3.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.18.18.18.3.m1.1b"><apply id="S4.T2.18.18.18.3.m1.1.1.cmml" xref="S4.T2.18.18.18.3.m1.1.1"><csymbol cd="latexml" id="S4.T2.18.18.18.3.m1.1.1.1.cmml" xref="S4.T2.18.18.18.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.18.18.18.3.m1.1.1.2.cmml" xref="S4.T2.18.18.18.3.m1.1.1.2">39.8</cn><cn type="float" id="S4.T2.18.18.18.3.m1.1.1.3.cmml" xref="S4.T2.18.18.18.3.m1.1.1.3">3.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.18.18.3.m1.1c">39.8\pm 3.8</annotation></semantics></math></td>
<td id="S4.T2.19.19.19.4" class="ltx_td ltx_align_center"><math id="S4.T2.19.19.19.4.m1.1" class="ltx_Math" alttext="{\bf 43.3\pm 0.8}" display="inline"><semantics id="S4.T2.19.19.19.4.m1.1a"><mrow id="S4.T2.19.19.19.4.m1.1.1" xref="S4.T2.19.19.19.4.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.19.19.19.4.m1.1.1.2" xref="S4.T2.19.19.19.4.m1.1.1.2.cmml">43.3</mn><mo id="S4.T2.19.19.19.4.m1.1.1.1" xref="S4.T2.19.19.19.4.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T2.19.19.19.4.m1.1.1.3" xref="S4.T2.19.19.19.4.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.19.19.19.4.m1.1b"><apply id="S4.T2.19.19.19.4.m1.1.1.cmml" xref="S4.T2.19.19.19.4.m1.1.1"><csymbol cd="latexml" id="S4.T2.19.19.19.4.m1.1.1.1.cmml" xref="S4.T2.19.19.19.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.19.19.19.4.m1.1.1.2.cmml" xref="S4.T2.19.19.19.4.m1.1.1.2">43.3</cn><cn type="float" id="S4.T2.19.19.19.4.m1.1.1.3.cmml" xref="S4.T2.19.19.19.4.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.19.19.4.m1.1c">{\bf 43.3\pm 0.8}</annotation></semantics></math></td>
<td id="S4.T2.20.20.20.5" class="ltx_td ltx_align_center"><math id="S4.T2.20.20.20.5.m1.1" class="ltx_Math" alttext="19.8\pm 7.0" display="inline"><semantics id="S4.T2.20.20.20.5.m1.1a"><mrow id="S4.T2.20.20.20.5.m1.1.1" xref="S4.T2.20.20.20.5.m1.1.1.cmml"><mn id="S4.T2.20.20.20.5.m1.1.1.2" xref="S4.T2.20.20.20.5.m1.1.1.2.cmml">19.8</mn><mo id="S4.T2.20.20.20.5.m1.1.1.1" xref="S4.T2.20.20.20.5.m1.1.1.1.cmml">±</mo><mn id="S4.T2.20.20.20.5.m1.1.1.3" xref="S4.T2.20.20.20.5.m1.1.1.3.cmml">7.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.20.20.20.5.m1.1b"><apply id="S4.T2.20.20.20.5.m1.1.1.cmml" xref="S4.T2.20.20.20.5.m1.1.1"><csymbol cd="latexml" id="S4.T2.20.20.20.5.m1.1.1.1.cmml" xref="S4.T2.20.20.20.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T2.20.20.20.5.m1.1.1.2.cmml" xref="S4.T2.20.20.20.5.m1.1.1.2">19.8</cn><cn type="float" id="S4.T2.20.20.20.5.m1.1.1.3.cmml" xref="S4.T2.20.20.20.5.m1.1.1.3">7.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.20.20.5.m1.1c">19.8\pm 7.0</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Keyword spotting task</h4>

<div id="S4.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px3.p1.1" class="ltx_p">: We calculate the mel spectrogram for each speech command to obtain a 32x32 input to our network. The network we use has four convolutional layers with 3x3 kernels and 64 feature maps each (with 2x2 max pooling after each pair), followed by two fully connected layers of 1024 and 10 neurons. In this deeper network, representation matching is essential in the <span id="S4.SS0.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_bold">non-iid</span> case as shown in table <a href="#S4.T3" title="Table 3 ‣ Keyword spotting task ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> since training consistently fails in its absence. It might be possible that with fine tuning of hyper-parameters, training would be possible in the <span id="S4.SS0.SSS0.Px3.p1.1.2" class="ltx_text ltx_font_bold">non-iid</span> case. However, representation matching obviates the need for such fine tuning. FA+RM+AH consistently outperforms all other methods indicating the hyper-parameters schedule found by the REINFORCE algorithm (third column in Fig. <a href="#S4.F3" title="Figure 3 ‣ Keyword spotting task ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) is better than the fixed schedule.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Keyword spotting task accuracy figures </figcaption>
<table id="S4.T3.20.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.20.20.21.1" class="ltx_tr">
<th id="S4.T3.20.20.21.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r"></th>
<th id="S4.T3.20.20.21.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">
<table id="S4.T3.20.20.21.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.20.20.21.1.2.1.1" class="ltx_tr">
<td id="S4.T3.20.20.21.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Data</td>
</tr>
<tr id="S4.T3.20.20.21.1.2.1.2" class="ltx_tr">
<td id="S4.T3.20.20.21.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Distribution</td>
</tr>
</table>
</th>
<th id="S4.T3.20.20.21.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA</th>
<th id="S4.T3.20.20.21.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+WD</th>
<th id="S4.T3.20.20.21.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+RM+AH</th>
<th id="S4.T3.20.20.21.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+RM</th>
<th id="S4.T3.20.20.21.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+AH</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.5.5.5" class="ltx_tr">
<th id="S4.T3.5.5.5.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T3.5.5.5.6.1" class="ltx_text">C=1.0</span></th>
<th id="S4.T3.5.5.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">iid</th>
<td id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="93.0\pm 0.2" display="inline"><semantics id="S4.T3.1.1.1.1.m1.1a"><mrow id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml"><mn id="S4.T3.1.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.1.m1.1.1.2.cmml">93.0</mn><mo id="S4.T3.1.1.1.1.m1.1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.1.cmml">±</mo><mn id="S4.T3.1.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.1.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.1.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2">93.0</cn><cn type="float" id="S4.T3.1.1.1.1.m1.1.1.3.cmml" xref="S4.T3.1.1.1.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">93.0\pm 0.2</annotation></semantics></math></td>
<td id="S4.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T3.2.2.2.2.m1.1" class="ltx_Math" alttext="93.5\pm 0.2" display="inline"><semantics id="S4.T3.2.2.2.2.m1.1a"><mrow id="S4.T3.2.2.2.2.m1.1.1" xref="S4.T3.2.2.2.2.m1.1.1.cmml"><mn id="S4.T3.2.2.2.2.m1.1.1.2" xref="S4.T3.2.2.2.2.m1.1.1.2.cmml">93.5</mn><mo id="S4.T3.2.2.2.2.m1.1.1.1" xref="S4.T3.2.2.2.2.m1.1.1.1.cmml">±</mo><mn id="S4.T3.2.2.2.2.m1.1.1.3" xref="S4.T3.2.2.2.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m1.1b"><apply id="S4.T3.2.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.2.2.2.2.m1.1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.2.2.2.2.m1.1.1.2.cmml" xref="S4.T3.2.2.2.2.m1.1.1.2">93.5</cn><cn type="float" id="S4.T3.2.2.2.2.m1.1.1.3.cmml" xref="S4.T3.2.2.2.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m1.1c">93.5\pm 0.2</annotation></semantics></math></td>
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T3.3.3.3.3.m1.1" class="ltx_Math" alttext="{\bf 94.4\pm 0.2}" display="inline"><semantics id="S4.T3.3.3.3.3.m1.1a"><mrow id="S4.T3.3.3.3.3.m1.1.1" xref="S4.T3.3.3.3.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.3.3.3.3.m1.1.1.2" xref="S4.T3.3.3.3.3.m1.1.1.2.cmml">94.4</mn><mo id="S4.T3.3.3.3.3.m1.1.1.1" xref="S4.T3.3.3.3.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.3.3.3.3.m1.1.1.3" xref="S4.T3.3.3.3.3.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.m1.1b"><apply id="S4.T3.3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.3.3.3.3.m1.1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.3.3.3.3.m1.1.1.2.cmml" xref="S4.T3.3.3.3.3.m1.1.1.2">94.4</cn><cn type="float" id="S4.T3.3.3.3.3.m1.1.1.3.cmml" xref="S4.T3.3.3.3.3.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.m1.1c">{\bf 94.4\pm 0.2}</annotation></semantics></math></td>
<td id="S4.T3.4.4.4.4" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T3.4.4.4.4.m1.1" class="ltx_Math" alttext="92.9\pm 0.3" display="inline"><semantics id="S4.T3.4.4.4.4.m1.1a"><mrow id="S4.T3.4.4.4.4.m1.1.1" xref="S4.T3.4.4.4.4.m1.1.1.cmml"><mn id="S4.T3.4.4.4.4.m1.1.1.2" xref="S4.T3.4.4.4.4.m1.1.1.2.cmml">92.9</mn><mo id="S4.T3.4.4.4.4.m1.1.1.1" xref="S4.T3.4.4.4.4.m1.1.1.1.cmml">±</mo><mn id="S4.T3.4.4.4.4.m1.1.1.3" xref="S4.T3.4.4.4.4.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.4.m1.1b"><apply id="S4.T3.4.4.4.4.m1.1.1.cmml" xref="S4.T3.4.4.4.4.m1.1.1"><csymbol cd="latexml" id="S4.T3.4.4.4.4.m1.1.1.1.cmml" xref="S4.T3.4.4.4.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.4.4.4.4.m1.1.1.2.cmml" xref="S4.T3.4.4.4.4.m1.1.1.2">92.9</cn><cn type="float" id="S4.T3.4.4.4.4.m1.1.1.3.cmml" xref="S4.T3.4.4.4.4.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.4.m1.1c">92.9\pm 0.3</annotation></semantics></math></td>
<td id="S4.T3.5.5.5.5" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T3.5.5.5.5.m1.1" class="ltx_Math" alttext="94.0\pm 0.4" display="inline"><semantics id="S4.T3.5.5.5.5.m1.1a"><mrow id="S4.T3.5.5.5.5.m1.1.1" xref="S4.T3.5.5.5.5.m1.1.1.cmml"><mn id="S4.T3.5.5.5.5.m1.1.1.2" xref="S4.T3.5.5.5.5.m1.1.1.2.cmml">94.0</mn><mo id="S4.T3.5.5.5.5.m1.1.1.1" xref="S4.T3.5.5.5.5.m1.1.1.1.cmml">±</mo><mn id="S4.T3.5.5.5.5.m1.1.1.3" xref="S4.T3.5.5.5.5.m1.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.5.m1.1b"><apply id="S4.T3.5.5.5.5.m1.1.1.cmml" xref="S4.T3.5.5.5.5.m1.1.1"><csymbol cd="latexml" id="S4.T3.5.5.5.5.m1.1.1.1.cmml" xref="S4.T3.5.5.5.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.5.5.5.5.m1.1.1.2.cmml" xref="S4.T3.5.5.5.5.m1.1.1.2">94.0</cn><cn type="float" id="S4.T3.5.5.5.5.m1.1.1.3.cmml" xref="S4.T3.5.5.5.5.m1.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.5.m1.1c">94.0\pm 0.4</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.10.10.10" class="ltx_tr">
<th id="S4.T3.10.10.10.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">non-iid</th>
<td id="S4.T3.6.6.6.1" class="ltx_td ltx_align_center"><math id="S4.T3.6.6.6.1.m1.1" class="ltx_Math" alttext="28.4\pm 7.2" display="inline"><semantics id="S4.T3.6.6.6.1.m1.1a"><mrow id="S4.T3.6.6.6.1.m1.1.1" xref="S4.T3.6.6.6.1.m1.1.1.cmml"><mn id="S4.T3.6.6.6.1.m1.1.1.2" xref="S4.T3.6.6.6.1.m1.1.1.2.cmml">28.4</mn><mo id="S4.T3.6.6.6.1.m1.1.1.1" xref="S4.T3.6.6.6.1.m1.1.1.1.cmml">±</mo><mn id="S4.T3.6.6.6.1.m1.1.1.3" xref="S4.T3.6.6.6.1.m1.1.1.3.cmml">7.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.6.1.m1.1b"><apply id="S4.T3.6.6.6.1.m1.1.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.6.6.6.1.m1.1.1.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.6.6.6.1.m1.1.1.2.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2">28.4</cn><cn type="float" id="S4.T3.6.6.6.1.m1.1.1.3.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3">7.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.6.1.m1.1c">28.4\pm 7.2</annotation></semantics></math></td>
<td id="S4.T3.7.7.7.2" class="ltx_td ltx_align_center"><math id="S4.T3.7.7.7.2.m1.1" class="ltx_Math" alttext="29.9\pm 7.3" display="inline"><semantics id="S4.T3.7.7.7.2.m1.1a"><mrow id="S4.T3.7.7.7.2.m1.1.1" xref="S4.T3.7.7.7.2.m1.1.1.cmml"><mn id="S4.T3.7.7.7.2.m1.1.1.2" xref="S4.T3.7.7.7.2.m1.1.1.2.cmml">29.9</mn><mo id="S4.T3.7.7.7.2.m1.1.1.1" xref="S4.T3.7.7.7.2.m1.1.1.1.cmml">±</mo><mn id="S4.T3.7.7.7.2.m1.1.1.3" xref="S4.T3.7.7.7.2.m1.1.1.3.cmml">7.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.7.2.m1.1b"><apply id="S4.T3.7.7.7.2.m1.1.1.cmml" xref="S4.T3.7.7.7.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.7.7.7.2.m1.1.1.1.cmml" xref="S4.T3.7.7.7.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.7.7.7.2.m1.1.1.2.cmml" xref="S4.T3.7.7.7.2.m1.1.1.2">29.9</cn><cn type="float" id="S4.T3.7.7.7.2.m1.1.1.3.cmml" xref="S4.T3.7.7.7.2.m1.1.1.3">7.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.7.2.m1.1c">29.9\pm 7.3</annotation></semantics></math></td>
<td id="S4.T3.8.8.8.3" class="ltx_td ltx_align_center"><math id="S4.T3.8.8.8.3.m1.1" class="ltx_Math" alttext="{\bf 81.1\pm 0.5}" display="inline"><semantics id="S4.T3.8.8.8.3.m1.1a"><mrow id="S4.T3.8.8.8.3.m1.1.1" xref="S4.T3.8.8.8.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.8.8.8.3.m1.1.1.2" xref="S4.T3.8.8.8.3.m1.1.1.2.cmml">81.1</mn><mo id="S4.T3.8.8.8.3.m1.1.1.1" xref="S4.T3.8.8.8.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.8.8.8.3.m1.1.1.3" xref="S4.T3.8.8.8.3.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.8.3.m1.1b"><apply id="S4.T3.8.8.8.3.m1.1.1.cmml" xref="S4.T3.8.8.8.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.8.8.8.3.m1.1.1.1.cmml" xref="S4.T3.8.8.8.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.8.8.8.3.m1.1.1.2.cmml" xref="S4.T3.8.8.8.3.m1.1.1.2">81.1</cn><cn type="float" id="S4.T3.8.8.8.3.m1.1.1.3.cmml" xref="S4.T3.8.8.8.3.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.8.3.m1.1c">{\bf 81.1\pm 0.5}</annotation></semantics></math></td>
<td id="S4.T3.9.9.9.4" class="ltx_td ltx_align_center"><math id="S4.T3.9.9.9.4.m1.1" class="ltx_Math" alttext="79.2\pm 0.6" display="inline"><semantics id="S4.T3.9.9.9.4.m1.1a"><mrow id="S4.T3.9.9.9.4.m1.1.1" xref="S4.T3.9.9.9.4.m1.1.1.cmml"><mn id="S4.T3.9.9.9.4.m1.1.1.2" xref="S4.T3.9.9.9.4.m1.1.1.2.cmml">79.2</mn><mo id="S4.T3.9.9.9.4.m1.1.1.1" xref="S4.T3.9.9.9.4.m1.1.1.1.cmml">±</mo><mn id="S4.T3.9.9.9.4.m1.1.1.3" xref="S4.T3.9.9.9.4.m1.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.9.9.9.4.m1.1b"><apply id="S4.T3.9.9.9.4.m1.1.1.cmml" xref="S4.T3.9.9.9.4.m1.1.1"><csymbol cd="latexml" id="S4.T3.9.9.9.4.m1.1.1.1.cmml" xref="S4.T3.9.9.9.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.9.9.9.4.m1.1.1.2.cmml" xref="S4.T3.9.9.9.4.m1.1.1.2">79.2</cn><cn type="float" id="S4.T3.9.9.9.4.m1.1.1.3.cmml" xref="S4.T3.9.9.9.4.m1.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.9.9.4.m1.1c">79.2\pm 0.6</annotation></semantics></math></td>
<td id="S4.T3.10.10.10.5" class="ltx_td ltx_align_center"><math id="S4.T3.10.10.10.5.m1.1" class="ltx_Math" alttext="9.8\pm 0.2" display="inline"><semantics id="S4.T3.10.10.10.5.m1.1a"><mrow id="S4.T3.10.10.10.5.m1.1.1" xref="S4.T3.10.10.10.5.m1.1.1.cmml"><mn id="S4.T3.10.10.10.5.m1.1.1.2" xref="S4.T3.10.10.10.5.m1.1.1.2.cmml">9.8</mn><mo id="S4.T3.10.10.10.5.m1.1.1.1" xref="S4.T3.10.10.10.5.m1.1.1.1.cmml">±</mo><mn id="S4.T3.10.10.10.5.m1.1.1.3" xref="S4.T3.10.10.10.5.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.10.10.10.5.m1.1b"><apply id="S4.T3.10.10.10.5.m1.1.1.cmml" xref="S4.T3.10.10.10.5.m1.1.1"><csymbol cd="latexml" id="S4.T3.10.10.10.5.m1.1.1.1.cmml" xref="S4.T3.10.10.10.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.10.10.10.5.m1.1.1.2.cmml" xref="S4.T3.10.10.10.5.m1.1.1.2">9.8</cn><cn type="float" id="S4.T3.10.10.10.5.m1.1.1.3.cmml" xref="S4.T3.10.10.10.5.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.10.10.5.m1.1c">9.8\pm 0.2</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.15.15.15" class="ltx_tr">
<th id="S4.T3.15.15.15.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T3.15.15.15.6.1" class="ltx_text">C=0.5</span></th>
<th id="S4.T3.15.15.15.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">iid</th>
<td id="S4.T3.11.11.11.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T3.11.11.11.1.m1.1" class="ltx_Math" alttext="91.4\pm 0.3" display="inline"><semantics id="S4.T3.11.11.11.1.m1.1a"><mrow id="S4.T3.11.11.11.1.m1.1.1" xref="S4.T3.11.11.11.1.m1.1.1.cmml"><mn id="S4.T3.11.11.11.1.m1.1.1.2" xref="S4.T3.11.11.11.1.m1.1.1.2.cmml">91.4</mn><mo id="S4.T3.11.11.11.1.m1.1.1.1" xref="S4.T3.11.11.11.1.m1.1.1.1.cmml">±</mo><mn id="S4.T3.11.11.11.1.m1.1.1.3" xref="S4.T3.11.11.11.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.11.11.11.1.m1.1b"><apply id="S4.T3.11.11.11.1.m1.1.1.cmml" xref="S4.T3.11.11.11.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.11.11.11.1.m1.1.1.1.cmml" xref="S4.T3.11.11.11.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.11.11.11.1.m1.1.1.2.cmml" xref="S4.T3.11.11.11.1.m1.1.1.2">91.4</cn><cn type="float" id="S4.T3.11.11.11.1.m1.1.1.3.cmml" xref="S4.T3.11.11.11.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.11.11.1.m1.1c">91.4\pm 0.3</annotation></semantics></math></td>
<td id="S4.T3.12.12.12.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T3.12.12.12.2.m1.1" class="ltx_Math" alttext="93.0\pm 0.4" display="inline"><semantics id="S4.T3.12.12.12.2.m1.1a"><mrow id="S4.T3.12.12.12.2.m1.1.1" xref="S4.T3.12.12.12.2.m1.1.1.cmml"><mn id="S4.T3.12.12.12.2.m1.1.1.2" xref="S4.T3.12.12.12.2.m1.1.1.2.cmml">93.0</mn><mo id="S4.T3.12.12.12.2.m1.1.1.1" xref="S4.T3.12.12.12.2.m1.1.1.1.cmml">±</mo><mn id="S4.T3.12.12.12.2.m1.1.1.3" xref="S4.T3.12.12.12.2.m1.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.12.12.12.2.m1.1b"><apply id="S4.T3.12.12.12.2.m1.1.1.cmml" xref="S4.T3.12.12.12.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.12.12.12.2.m1.1.1.1.cmml" xref="S4.T3.12.12.12.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.12.12.12.2.m1.1.1.2.cmml" xref="S4.T3.12.12.12.2.m1.1.1.2">93.0</cn><cn type="float" id="S4.T3.12.12.12.2.m1.1.1.3.cmml" xref="S4.T3.12.12.12.2.m1.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.12.12.2.m1.1c">93.0\pm 0.4</annotation></semantics></math></td>
<td id="S4.T3.13.13.13.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T3.13.13.13.3.m1.1" class="ltx_Math" alttext="{\bf 94.3\pm 0.1}" display="inline"><semantics id="S4.T3.13.13.13.3.m1.1a"><mrow id="S4.T3.13.13.13.3.m1.1.1" xref="S4.T3.13.13.13.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.13.13.13.3.m1.1.1.2" xref="S4.T3.13.13.13.3.m1.1.1.2.cmml">94.3</mn><mo id="S4.T3.13.13.13.3.m1.1.1.1" xref="S4.T3.13.13.13.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.13.13.13.3.m1.1.1.3" xref="S4.T3.13.13.13.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.13.13.13.3.m1.1b"><apply id="S4.T3.13.13.13.3.m1.1.1.cmml" xref="S4.T3.13.13.13.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.13.13.13.3.m1.1.1.1.cmml" xref="S4.T3.13.13.13.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.13.13.13.3.m1.1.1.2.cmml" xref="S4.T3.13.13.13.3.m1.1.1.2">94.3</cn><cn type="float" id="S4.T3.13.13.13.3.m1.1.1.3.cmml" xref="S4.T3.13.13.13.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.13.13.3.m1.1c">{\bf 94.3\pm 0.1}</annotation></semantics></math></td>
<td id="S4.T3.14.14.14.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T3.14.14.14.4.m1.1" class="ltx_Math" alttext="91.0\pm 0.2" display="inline"><semantics id="S4.T3.14.14.14.4.m1.1a"><mrow id="S4.T3.14.14.14.4.m1.1.1" xref="S4.T3.14.14.14.4.m1.1.1.cmml"><mn id="S4.T3.14.14.14.4.m1.1.1.2" xref="S4.T3.14.14.14.4.m1.1.1.2.cmml">91.0</mn><mo id="S4.T3.14.14.14.4.m1.1.1.1" xref="S4.T3.14.14.14.4.m1.1.1.1.cmml">±</mo><mn id="S4.T3.14.14.14.4.m1.1.1.3" xref="S4.T3.14.14.14.4.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.14.14.14.4.m1.1b"><apply id="S4.T3.14.14.14.4.m1.1.1.cmml" xref="S4.T3.14.14.14.4.m1.1.1"><csymbol cd="latexml" id="S4.T3.14.14.14.4.m1.1.1.1.cmml" xref="S4.T3.14.14.14.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.14.14.14.4.m1.1.1.2.cmml" xref="S4.T3.14.14.14.4.m1.1.1.2">91.0</cn><cn type="float" id="S4.T3.14.14.14.4.m1.1.1.3.cmml" xref="S4.T3.14.14.14.4.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.14.14.4.m1.1c">91.0\pm 0.2</annotation></semantics></math></td>
<td id="S4.T3.15.15.15.5" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T3.15.15.15.5.m1.1" class="ltx_Math" alttext="93.2\pm 0.4" display="inline"><semantics id="S4.T3.15.15.15.5.m1.1a"><mrow id="S4.T3.15.15.15.5.m1.1.1" xref="S4.T3.15.15.15.5.m1.1.1.cmml"><mn id="S4.T3.15.15.15.5.m1.1.1.2" xref="S4.T3.15.15.15.5.m1.1.1.2.cmml">93.2</mn><mo id="S4.T3.15.15.15.5.m1.1.1.1" xref="S4.T3.15.15.15.5.m1.1.1.1.cmml">±</mo><mn id="S4.T3.15.15.15.5.m1.1.1.3" xref="S4.T3.15.15.15.5.m1.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.15.15.15.5.m1.1b"><apply id="S4.T3.15.15.15.5.m1.1.1.cmml" xref="S4.T3.15.15.15.5.m1.1.1"><csymbol cd="latexml" id="S4.T3.15.15.15.5.m1.1.1.1.cmml" xref="S4.T3.15.15.15.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.15.15.15.5.m1.1.1.2.cmml" xref="S4.T3.15.15.15.5.m1.1.1.2">93.2</cn><cn type="float" id="S4.T3.15.15.15.5.m1.1.1.3.cmml" xref="S4.T3.15.15.15.5.m1.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.15.15.5.m1.1c">93.2\pm 0.4</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.20.20.20" class="ltx_tr">
<th id="S4.T3.20.20.20.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">non-iid</th>
<td id="S4.T3.16.16.16.1" class="ltx_td ltx_align_center"><math id="S4.T3.16.16.16.1.m1.1" class="ltx_Math" alttext="11.45\pm 1.7" display="inline"><semantics id="S4.T3.16.16.16.1.m1.1a"><mrow id="S4.T3.16.16.16.1.m1.1.1" xref="S4.T3.16.16.16.1.m1.1.1.cmml"><mn id="S4.T3.16.16.16.1.m1.1.1.2" xref="S4.T3.16.16.16.1.m1.1.1.2.cmml">11.45</mn><mo id="S4.T3.16.16.16.1.m1.1.1.1" xref="S4.T3.16.16.16.1.m1.1.1.1.cmml">±</mo><mn id="S4.T3.16.16.16.1.m1.1.1.3" xref="S4.T3.16.16.16.1.m1.1.1.3.cmml">1.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.16.16.16.1.m1.1b"><apply id="S4.T3.16.16.16.1.m1.1.1.cmml" xref="S4.T3.16.16.16.1.m1.1.1"><csymbol cd="latexml" id="S4.T3.16.16.16.1.m1.1.1.1.cmml" xref="S4.T3.16.16.16.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.16.16.16.1.m1.1.1.2.cmml" xref="S4.T3.16.16.16.1.m1.1.1.2">11.45</cn><cn type="float" id="S4.T3.16.16.16.1.m1.1.1.3.cmml" xref="S4.T3.16.16.16.1.m1.1.1.3">1.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.16.16.16.1.m1.1c">11.45\pm 1.7</annotation></semantics></math></td>
<td id="S4.T3.17.17.17.2" class="ltx_td ltx_align_center"><math id="S4.T3.17.17.17.2.m1.1" class="ltx_Math" alttext="11.8\pm 2.7" display="inline"><semantics id="S4.T3.17.17.17.2.m1.1a"><mrow id="S4.T3.17.17.17.2.m1.1.1" xref="S4.T3.17.17.17.2.m1.1.1.cmml"><mn id="S4.T3.17.17.17.2.m1.1.1.2" xref="S4.T3.17.17.17.2.m1.1.1.2.cmml">11.8</mn><mo id="S4.T3.17.17.17.2.m1.1.1.1" xref="S4.T3.17.17.17.2.m1.1.1.1.cmml">±</mo><mn id="S4.T3.17.17.17.2.m1.1.1.3" xref="S4.T3.17.17.17.2.m1.1.1.3.cmml">2.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.17.17.17.2.m1.1b"><apply id="S4.T3.17.17.17.2.m1.1.1.cmml" xref="S4.T3.17.17.17.2.m1.1.1"><csymbol cd="latexml" id="S4.T3.17.17.17.2.m1.1.1.1.cmml" xref="S4.T3.17.17.17.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.17.17.17.2.m1.1.1.2.cmml" xref="S4.T3.17.17.17.2.m1.1.1.2">11.8</cn><cn type="float" id="S4.T3.17.17.17.2.m1.1.1.3.cmml" xref="S4.T3.17.17.17.2.m1.1.1.3">2.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.17.17.17.2.m1.1c">11.8\pm 2.7</annotation></semantics></math></td>
<td id="S4.T3.18.18.18.3" class="ltx_td ltx_align_center"><math id="S4.T3.18.18.18.3.m1.1" class="ltx_Math" alttext="{\bf 74.9\pm 2.5}" display="inline"><semantics id="S4.T3.18.18.18.3.m1.1a"><mrow id="S4.T3.18.18.18.3.m1.1.1" xref="S4.T3.18.18.18.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.18.18.18.3.m1.1.1.2" xref="S4.T3.18.18.18.3.m1.1.1.2.cmml">74.9</mn><mo id="S4.T3.18.18.18.3.m1.1.1.1" xref="S4.T3.18.18.18.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.T3.18.18.18.3.m1.1.1.3" xref="S4.T3.18.18.18.3.m1.1.1.3.cmml">2.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.18.18.18.3.m1.1b"><apply id="S4.T3.18.18.18.3.m1.1.1.cmml" xref="S4.T3.18.18.18.3.m1.1.1"><csymbol cd="latexml" id="S4.T3.18.18.18.3.m1.1.1.1.cmml" xref="S4.T3.18.18.18.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.18.18.18.3.m1.1.1.2.cmml" xref="S4.T3.18.18.18.3.m1.1.1.2">74.9</cn><cn type="float" id="S4.T3.18.18.18.3.m1.1.1.3.cmml" xref="S4.T3.18.18.18.3.m1.1.1.3">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.18.18.18.3.m1.1c">{\bf 74.9\pm 2.5}</annotation></semantics></math></td>
<td id="S4.T3.19.19.19.4" class="ltx_td ltx_align_center"><math id="S4.T3.19.19.19.4.m1.1" class="ltx_Math" alttext="60.7\pm 3.3" display="inline"><semantics id="S4.T3.19.19.19.4.m1.1a"><mrow id="S4.T3.19.19.19.4.m1.1.1" xref="S4.T3.19.19.19.4.m1.1.1.cmml"><mn id="S4.T3.19.19.19.4.m1.1.1.2" xref="S4.T3.19.19.19.4.m1.1.1.2.cmml">60.7</mn><mo id="S4.T3.19.19.19.4.m1.1.1.1" xref="S4.T3.19.19.19.4.m1.1.1.1.cmml">±</mo><mn id="S4.T3.19.19.19.4.m1.1.1.3" xref="S4.T3.19.19.19.4.m1.1.1.3.cmml">3.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.19.19.19.4.m1.1b"><apply id="S4.T3.19.19.19.4.m1.1.1.cmml" xref="S4.T3.19.19.19.4.m1.1.1"><csymbol cd="latexml" id="S4.T3.19.19.19.4.m1.1.1.1.cmml" xref="S4.T3.19.19.19.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.19.19.19.4.m1.1.1.2.cmml" xref="S4.T3.19.19.19.4.m1.1.1.2">60.7</cn><cn type="float" id="S4.T3.19.19.19.4.m1.1.1.3.cmml" xref="S4.T3.19.19.19.4.m1.1.1.3">3.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.19.19.19.4.m1.1c">60.7\pm 3.3</annotation></semantics></math></td>
<td id="S4.T3.20.20.20.5" class="ltx_td ltx_align_center"><math id="S4.T3.20.20.20.5.m1.1" class="ltx_Math" alttext="10.0\pm 0.3" display="inline"><semantics id="S4.T3.20.20.20.5.m1.1a"><mrow id="S4.T3.20.20.20.5.m1.1.1" xref="S4.T3.20.20.20.5.m1.1.1.cmml"><mn id="S4.T3.20.20.20.5.m1.1.1.2" xref="S4.T3.20.20.20.5.m1.1.1.2.cmml">10.0</mn><mo id="S4.T3.20.20.20.5.m1.1.1.1" xref="S4.T3.20.20.20.5.m1.1.1.1.cmml">±</mo><mn id="S4.T3.20.20.20.5.m1.1.1.3" xref="S4.T3.20.20.20.5.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.20.20.20.5.m1.1b"><apply id="S4.T3.20.20.20.5.m1.1.1.cmml" xref="S4.T3.20.20.20.5.m1.1.1"><csymbol cd="latexml" id="S4.T3.20.20.20.5.m1.1.1.1.cmml" xref="S4.T3.20.20.20.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T3.20.20.20.5.m1.1.1.2.cmml" xref="S4.T3.20.20.20.5.m1.1.1.2">10.0</cn><cn type="float" id="S4.T3.20.20.20.5.m1.1.1.3.cmml" xref="S4.T3.20.20.20.5.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.20.20.20.5.m1.1c">10.0\pm 0.3</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x5.png" id="S4.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="422" height="282" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x6.png" id="S4.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="422" height="282" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x7.png" id="S4.F3.3.g1" class="ltx_graphics ltx_img_landscape" width="422" height="282" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x8.png" id="S4.F3.4.g1" class="ltx_graphics ltx_img_landscape" width="422" height="282" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x9.png" id="S4.F3.5.g1" class="ltx_graphics ltx_img_landscape" width="422" height="282" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1912.13075/assets/x10.png" id="S4.F3.6.g1" class="ltx_graphics ltx_img_landscape" width="422" height="282" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Evolution of the mean of the hyper-parameter distribution <math id="S4.F3.9.m1.1" class="ltx_Math" alttext="P(\mathcal{H}|{\bf\psi})" display="inline"><semantics id="S4.F3.9.m1.1b"><mrow id="S4.F3.9.m1.1.1" xref="S4.F3.9.m1.1.1.cmml"><mi id="S4.F3.9.m1.1.1.3" xref="S4.F3.9.m1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.F3.9.m1.1.1.2" xref="S4.F3.9.m1.1.1.2.cmml">​</mo><mrow id="S4.F3.9.m1.1.1.1.1" xref="S4.F3.9.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.F3.9.m1.1.1.1.1.2" xref="S4.F3.9.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.F3.9.m1.1.1.1.1.1" xref="S4.F3.9.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F3.9.m1.1.1.1.1.1.2" xref="S4.F3.9.m1.1.1.1.1.1.2.cmml">ℋ</mi><mo fence="false" id="S4.F3.9.m1.1.1.1.1.1.1" xref="S4.F3.9.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.F3.9.m1.1.1.1.1.1.3" xref="S4.F3.9.m1.1.1.1.1.1.3.cmml">ψ</mi></mrow><mo stretchy="false" id="S4.F3.9.m1.1.1.1.1.3" xref="S4.F3.9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.9.m1.1c"><apply id="S4.F3.9.m1.1.1.cmml" xref="S4.F3.9.m1.1.1"><times id="S4.F3.9.m1.1.1.2.cmml" xref="S4.F3.9.m1.1.1.2"></times><ci id="S4.F3.9.m1.1.1.3.cmml" xref="S4.F3.9.m1.1.1.3">𝑃</ci><apply id="S4.F3.9.m1.1.1.1.1.1.cmml" xref="S4.F3.9.m1.1.1.1.1"><csymbol cd="latexml" id="S4.F3.9.m1.1.1.1.1.1.1.cmml" xref="S4.F3.9.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.F3.9.m1.1.1.1.1.1.2.cmml" xref="S4.F3.9.m1.1.1.1.1.1.2">ℋ</ci><ci id="S4.F3.9.m1.1.1.1.1.1.3.cmml" xref="S4.F3.9.m1.1.1.1.1.1.3">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.9.m1.1d">P(\mathcal{H}|{\bf\psi})</annotation></semantics></math> for the iid and non-iid cases. Results taken from the FA+RM+AH algorithm when <math id="S4.F3.10.m2.1" class="ltx_Math" alttext="C=1.0" display="inline"><semantics id="S4.F3.10.m2.1b"><mrow id="S4.F3.10.m2.1.1" xref="S4.F3.10.m2.1.1.cmml"><mi id="S4.F3.10.m2.1.1.2" xref="S4.F3.10.m2.1.1.2.cmml">C</mi><mo id="S4.F3.10.m2.1.1.1" xref="S4.F3.10.m2.1.1.1.cmml">=</mo><mn id="S4.F3.10.m2.1.1.3" xref="S4.F3.10.m2.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.10.m2.1c"><apply id="S4.F3.10.m2.1.1.cmml" xref="S4.F3.10.m2.1.1"><eq id="S4.F3.10.m2.1.1.1.cmml" xref="S4.F3.10.m2.1.1.1"></eq><ci id="S4.F3.10.m2.1.1.2.cmml" xref="S4.F3.10.m2.1.1.2">𝐶</ci><cn type="float" id="S4.F3.10.m2.1.1.3.cmml" xref="S4.F3.10.m2.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.10.m2.1d">C=1.0</annotation></semantics></math>. The evolution of the means are shown separately for the learning rate (first row) and for the number of SGD steps per round (second row), with one column each for the MNIST, CIFAR10, and keyword spotting (KWS) tasks. During training, the means are forced to stay within the ranges defined by the hyper-parameter grid.</figcaption>
</figure>
</section>
<section id="S4.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Communication and computational overhead</h4>

<div id="S4.SS0.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px4.p1.2" class="ltx_p">: Our representation matching scheme does not introduce any communication overhead between the clients and the central server. The adaptive hyper-parameters scheme introduces a negligible communication overhead for sending two scalar hyper-parameters to the clients each round. As for computational overhead, we quantify the wall-clock run-time<span id="footnotex1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Experiments were run on a machine with a single TitanXP GPU, 32G of RAM, and an Intel Xeon E5-2699A processor.</span></span></span> for training a client for 30 SGD iterations or mini-batches (mini-batch size of 64). Where adaptive hyper-parameters are used, we also include the time needed to execute the adaptive hyper-parameter tuning procedure. The results are shown in table <a href="#S4.T4" title="Table 4 ‣ Communication and computational overhead ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We note that the overhead of our hyper-parameter tuning procedure is negligible (FA vs. FA+AH) and is typically less than <math id="S4.SS0.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="2\%" display="inline"><semantics id="S4.SS0.SSS0.Px4.p1.1.m1.1a"><mrow id="S4.SS0.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px4.p1.1.m1.1.1.cmml"><mn id="S4.SS0.SSS0.Px4.p1.1.m1.1.1.2" xref="S4.SS0.SSS0.Px4.p1.1.m1.1.1.2.cmml">2</mn><mo id="S4.SS0.SSS0.Px4.p1.1.m1.1.1.1" xref="S4.SS0.SSS0.Px4.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px4.p1.1.m1.1b"><apply id="S4.SS0.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px4.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS0.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S4.SS0.SSS0.Px4.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS0.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="S4.SS0.SSS0.Px4.p1.1.m1.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px4.p1.1.m1.1c">2\%</annotation></semantics></math>. This negligible computational overhead is primarily the cost of a single inference pass to evaluate the loss <math id="S4.SS0.SSS0.Px4.p1.2.m2.1" class="ltx_Math" alttext="L_{t}" display="inline"><semantics id="S4.SS0.SSS0.Px4.p1.2.m2.1a"><msub id="S4.SS0.SSS0.Px4.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px4.p1.2.m2.1.1.cmml"><mi id="S4.SS0.SSS0.Px4.p1.2.m2.1.1.2" xref="S4.SS0.SSS0.Px4.p1.2.m2.1.1.2.cmml">L</mi><mi id="S4.SS0.SSS0.Px4.p1.2.m2.1.1.3" xref="S4.SS0.SSS0.Px4.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px4.p1.2.m2.1b"><apply id="S4.SS0.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S4.SS0.SSS0.Px4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="S4.SS0.SSS0.Px4.p1.2.m2.1.1.2">𝐿</ci><ci id="S4.SS0.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="S4.SS0.SSS0.Px4.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px4.p1.2.m2.1c">L_{t}</annotation></semantics></math> on a very small subset of the training set. The representation matching scheme is more demanding as as it requires optimizing a more complicated loss during each SGD iteration at the client.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Wall-clock run-time in seconds. Mean and std. from 200 trials.</figcaption>
<table id="S4.T4.15.15" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.15.15.16.1" class="ltx_tr">
<th id="S4.T4.15.15.16.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">
<table id="S4.T4.15.15.16.1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.15.15.16.1.1.1.1" class="ltx_tr">
<td id="S4.T4.15.15.16.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Task</td>
</tr>
</table>
</th>
<th id="S4.T4.15.15.16.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA</th>
<th id="S4.T4.15.15.16.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+WD</th>
<th id="S4.T4.15.15.16.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+RM+AH</th>
<th id="S4.T4.15.15.16.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+RM</th>
<th id="S4.T4.15.15.16.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column">FA+AH</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.5.5.5" class="ltx_tr">
<th id="S4.T4.5.5.5.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">MNIST</th>
<td id="S4.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="0.39\pm 0.007" display="inline"><semantics id="S4.T4.1.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml"><mn id="S4.T4.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.m1.1.1.2.cmml">0.39</mn><mo id="S4.T4.1.1.1.1.m1.1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">±</mo><mn id="S4.T4.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.1.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2">0.39</cn><cn type="float" id="S4.T4.1.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">0.39\pm 0.007</annotation></semantics></math></td>
<td id="S4.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T4.2.2.2.2.m1.1" class="ltx_Math" alttext="0.41\pm 0.008" display="inline"><semantics id="S4.T4.2.2.2.2.m1.1a"><mrow id="S4.T4.2.2.2.2.m1.1.1" xref="S4.T4.2.2.2.2.m1.1.1.cmml"><mn id="S4.T4.2.2.2.2.m1.1.1.2" xref="S4.T4.2.2.2.2.m1.1.1.2.cmml">0.41</mn><mo id="S4.T4.2.2.2.2.m1.1.1.1" xref="S4.T4.2.2.2.2.m1.1.1.1.cmml">±</mo><mn id="S4.T4.2.2.2.2.m1.1.1.3" xref="S4.T4.2.2.2.2.m1.1.1.3.cmml">0.008</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.m1.1b"><apply id="S4.T4.2.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1"><csymbol cd="latexml" id="S4.T4.2.2.2.2.m1.1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.2.2.2.2.m1.1.1.2.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2">0.41</cn><cn type="float" id="S4.T4.2.2.2.2.m1.1.1.3.cmml" xref="S4.T4.2.2.2.2.m1.1.1.3">0.008</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.m1.1c">0.41\pm 0.008</annotation></semantics></math></td>
<td id="S4.T4.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T4.3.3.3.3.m1.1" class="ltx_Math" alttext="0.43\pm 0.007" display="inline"><semantics id="S4.T4.3.3.3.3.m1.1a"><mrow id="S4.T4.3.3.3.3.m1.1.1" xref="S4.T4.3.3.3.3.m1.1.1.cmml"><mn id="S4.T4.3.3.3.3.m1.1.1.2" xref="S4.T4.3.3.3.3.m1.1.1.2.cmml">0.43</mn><mo id="S4.T4.3.3.3.3.m1.1.1.1" xref="S4.T4.3.3.3.3.m1.1.1.1.cmml">±</mo><mn id="S4.T4.3.3.3.3.m1.1.1.3" xref="S4.T4.3.3.3.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.3.m1.1b"><apply id="S4.T4.3.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1"><csymbol cd="latexml" id="S4.T4.3.3.3.3.m1.1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.3.3.3.3.m1.1.1.2.cmml" xref="S4.T4.3.3.3.3.m1.1.1.2">0.43</cn><cn type="float" id="S4.T4.3.3.3.3.m1.1.1.3.cmml" xref="S4.T4.3.3.3.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.3.m1.1c">0.43\pm 0.007</annotation></semantics></math></td>
<td id="S4.T4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T4.4.4.4.4.m1.1" class="ltx_Math" alttext="0.42\pm 0.007" display="inline"><semantics id="S4.T4.4.4.4.4.m1.1a"><mrow id="S4.T4.4.4.4.4.m1.1.1" xref="S4.T4.4.4.4.4.m1.1.1.cmml"><mn id="S4.T4.4.4.4.4.m1.1.1.2" xref="S4.T4.4.4.4.4.m1.1.1.2.cmml">0.42</mn><mo id="S4.T4.4.4.4.4.m1.1.1.1" xref="S4.T4.4.4.4.4.m1.1.1.1.cmml">±</mo><mn id="S4.T4.4.4.4.4.m1.1.1.3" xref="S4.T4.4.4.4.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.4.m1.1b"><apply id="S4.T4.4.4.4.4.m1.1.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1"><csymbol cd="latexml" id="S4.T4.4.4.4.4.m1.1.1.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.4.4.4.4.m1.1.1.2.cmml" xref="S4.T4.4.4.4.4.m1.1.1.2">0.42</cn><cn type="float" id="S4.T4.4.4.4.4.m1.1.1.3.cmml" xref="S4.T4.4.4.4.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.4.m1.1c">0.42\pm 0.007</annotation></semantics></math></td>
<td id="S4.T4.5.5.5.5" class="ltx_td ltx_align_center ltx_border_tt"><math id="S4.T4.5.5.5.5.m1.1" class="ltx_Math" alttext="0.39\pm 0.007" display="inline"><semantics id="S4.T4.5.5.5.5.m1.1a"><mrow id="S4.T4.5.5.5.5.m1.1.1" xref="S4.T4.5.5.5.5.m1.1.1.cmml"><mn id="S4.T4.5.5.5.5.m1.1.1.2" xref="S4.T4.5.5.5.5.m1.1.1.2.cmml">0.39</mn><mo id="S4.T4.5.5.5.5.m1.1.1.1" xref="S4.T4.5.5.5.5.m1.1.1.1.cmml">±</mo><mn id="S4.T4.5.5.5.5.m1.1.1.3" xref="S4.T4.5.5.5.5.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.5.m1.1b"><apply id="S4.T4.5.5.5.5.m1.1.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1"><csymbol cd="latexml" id="S4.T4.5.5.5.5.m1.1.1.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.5.5.5.5.m1.1.1.2.cmml" xref="S4.T4.5.5.5.5.m1.1.1.2">0.39</cn><cn type="float" id="S4.T4.5.5.5.5.m1.1.1.3.cmml" xref="S4.T4.5.5.5.5.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.5.m1.1c">0.39\pm 0.007</annotation></semantics></math></td>
</tr>
<tr id="S4.T4.10.10.10" class="ltx_tr">
<th id="S4.T4.10.10.10.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">CIFAR10</th>
<td id="S4.T4.6.6.6.1" class="ltx_td ltx_align_center"><math id="S4.T4.6.6.6.1.m1.1" class="ltx_Math" alttext="0.50\pm 0.02" display="inline"><semantics id="S4.T4.6.6.6.1.m1.1a"><mrow id="S4.T4.6.6.6.1.m1.1.1" xref="S4.T4.6.6.6.1.m1.1.1.cmml"><mn id="S4.T4.6.6.6.1.m1.1.1.2" xref="S4.T4.6.6.6.1.m1.1.1.2.cmml">0.50</mn><mo id="S4.T4.6.6.6.1.m1.1.1.1" xref="S4.T4.6.6.6.1.m1.1.1.1.cmml">±</mo><mn id="S4.T4.6.6.6.1.m1.1.1.3" xref="S4.T4.6.6.6.1.m1.1.1.3.cmml">0.02</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.6.1.m1.1b"><apply id="S4.T4.6.6.6.1.m1.1.1.cmml" xref="S4.T4.6.6.6.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.6.6.6.1.m1.1.1.1.cmml" xref="S4.T4.6.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.6.6.6.1.m1.1.1.2.cmml" xref="S4.T4.6.6.6.1.m1.1.1.2">0.50</cn><cn type="float" id="S4.T4.6.6.6.1.m1.1.1.3.cmml" xref="S4.T4.6.6.6.1.m1.1.1.3">0.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.6.1.m1.1c">0.50\pm 0.02</annotation></semantics></math></td>
<td id="S4.T4.7.7.7.2" class="ltx_td ltx_align_center"><math id="S4.T4.7.7.7.2.m1.1" class="ltx_Math" alttext="0.54\pm 0.01" display="inline"><semantics id="S4.T4.7.7.7.2.m1.1a"><mrow id="S4.T4.7.7.7.2.m1.1.1" xref="S4.T4.7.7.7.2.m1.1.1.cmml"><mn id="S4.T4.7.7.7.2.m1.1.1.2" xref="S4.T4.7.7.7.2.m1.1.1.2.cmml">0.54</mn><mo id="S4.T4.7.7.7.2.m1.1.1.1" xref="S4.T4.7.7.7.2.m1.1.1.1.cmml">±</mo><mn id="S4.T4.7.7.7.2.m1.1.1.3" xref="S4.T4.7.7.7.2.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.7.2.m1.1b"><apply id="S4.T4.7.7.7.2.m1.1.1.cmml" xref="S4.T4.7.7.7.2.m1.1.1"><csymbol cd="latexml" id="S4.T4.7.7.7.2.m1.1.1.1.cmml" xref="S4.T4.7.7.7.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.7.7.7.2.m1.1.1.2.cmml" xref="S4.T4.7.7.7.2.m1.1.1.2">0.54</cn><cn type="float" id="S4.T4.7.7.7.2.m1.1.1.3.cmml" xref="S4.T4.7.7.7.2.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.7.2.m1.1c">0.54\pm 0.01</annotation></semantics></math></td>
<td id="S4.T4.8.8.8.3" class="ltx_td ltx_align_center"><math id="S4.T4.8.8.8.3.m1.1" class="ltx_Math" alttext="0.67\pm 0.02" display="inline"><semantics id="S4.T4.8.8.8.3.m1.1a"><mrow id="S4.T4.8.8.8.3.m1.1.1" xref="S4.T4.8.8.8.3.m1.1.1.cmml"><mn id="S4.T4.8.8.8.3.m1.1.1.2" xref="S4.T4.8.8.8.3.m1.1.1.2.cmml">0.67</mn><mo id="S4.T4.8.8.8.3.m1.1.1.1" xref="S4.T4.8.8.8.3.m1.1.1.1.cmml">±</mo><mn id="S4.T4.8.8.8.3.m1.1.1.3" xref="S4.T4.8.8.8.3.m1.1.1.3.cmml">0.02</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.8.8.8.3.m1.1b"><apply id="S4.T4.8.8.8.3.m1.1.1.cmml" xref="S4.T4.8.8.8.3.m1.1.1"><csymbol cd="latexml" id="S4.T4.8.8.8.3.m1.1.1.1.cmml" xref="S4.T4.8.8.8.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.8.8.8.3.m1.1.1.2.cmml" xref="S4.T4.8.8.8.3.m1.1.1.2">0.67</cn><cn type="float" id="S4.T4.8.8.8.3.m1.1.1.3.cmml" xref="S4.T4.8.8.8.3.m1.1.1.3">0.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.8.8.3.m1.1c">0.67\pm 0.02</annotation></semantics></math></td>
<td id="S4.T4.9.9.9.4" class="ltx_td ltx_align_center"><math id="S4.T4.9.9.9.4.m1.1" class="ltx_Math" alttext="0.66\pm 0.02" display="inline"><semantics id="S4.T4.9.9.9.4.m1.1a"><mrow id="S4.T4.9.9.9.4.m1.1.1" xref="S4.T4.9.9.9.4.m1.1.1.cmml"><mn id="S4.T4.9.9.9.4.m1.1.1.2" xref="S4.T4.9.9.9.4.m1.1.1.2.cmml">0.66</mn><mo id="S4.T4.9.9.9.4.m1.1.1.1" xref="S4.T4.9.9.9.4.m1.1.1.1.cmml">±</mo><mn id="S4.T4.9.9.9.4.m1.1.1.3" xref="S4.T4.9.9.9.4.m1.1.1.3.cmml">0.02</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.9.9.9.4.m1.1b"><apply id="S4.T4.9.9.9.4.m1.1.1.cmml" xref="S4.T4.9.9.9.4.m1.1.1"><csymbol cd="latexml" id="S4.T4.9.9.9.4.m1.1.1.1.cmml" xref="S4.T4.9.9.9.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.9.9.9.4.m1.1.1.2.cmml" xref="S4.T4.9.9.9.4.m1.1.1.2">0.66</cn><cn type="float" id="S4.T4.9.9.9.4.m1.1.1.3.cmml" xref="S4.T4.9.9.9.4.m1.1.1.3">0.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.9.9.4.m1.1c">0.66\pm 0.02</annotation></semantics></math></td>
<td id="S4.T4.10.10.10.5" class="ltx_td ltx_align_center"><math id="S4.T4.10.10.10.5.m1.1" class="ltx_Math" alttext="0.51\pm 0.02" display="inline"><semantics id="S4.T4.10.10.10.5.m1.1a"><mrow id="S4.T4.10.10.10.5.m1.1.1" xref="S4.T4.10.10.10.5.m1.1.1.cmml"><mn id="S4.T4.10.10.10.5.m1.1.1.2" xref="S4.T4.10.10.10.5.m1.1.1.2.cmml">0.51</mn><mo id="S4.T4.10.10.10.5.m1.1.1.1" xref="S4.T4.10.10.10.5.m1.1.1.1.cmml">±</mo><mn id="S4.T4.10.10.10.5.m1.1.1.3" xref="S4.T4.10.10.10.5.m1.1.1.3.cmml">0.02</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.10.10.10.5.m1.1b"><apply id="S4.T4.10.10.10.5.m1.1.1.cmml" xref="S4.T4.10.10.10.5.m1.1.1"><csymbol cd="latexml" id="S4.T4.10.10.10.5.m1.1.1.1.cmml" xref="S4.T4.10.10.10.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.10.10.10.5.m1.1.1.2.cmml" xref="S4.T4.10.10.10.5.m1.1.1.2">0.51</cn><cn type="float" id="S4.T4.10.10.10.5.m1.1.1.3.cmml" xref="S4.T4.10.10.10.5.m1.1.1.3">0.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.10.10.5.m1.1c">0.51\pm 0.02</annotation></semantics></math></td>
</tr>
<tr id="S4.T4.15.15.15" class="ltx_tr">
<th id="S4.T4.15.15.15.6" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">KWS</th>
<td id="S4.T4.11.11.11.1" class="ltx_td ltx_align_center"><math id="S4.T4.11.11.11.1.m1.1" class="ltx_Math" alttext="1.83\pm 0.05" display="inline"><semantics id="S4.T4.11.11.11.1.m1.1a"><mrow id="S4.T4.11.11.11.1.m1.1.1" xref="S4.T4.11.11.11.1.m1.1.1.cmml"><mn id="S4.T4.11.11.11.1.m1.1.1.2" xref="S4.T4.11.11.11.1.m1.1.1.2.cmml">1.83</mn><mo id="S4.T4.11.11.11.1.m1.1.1.1" xref="S4.T4.11.11.11.1.m1.1.1.1.cmml">±</mo><mn id="S4.T4.11.11.11.1.m1.1.1.3" xref="S4.T4.11.11.11.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.11.11.11.1.m1.1b"><apply id="S4.T4.11.11.11.1.m1.1.1.cmml" xref="S4.T4.11.11.11.1.m1.1.1"><csymbol cd="latexml" id="S4.T4.11.11.11.1.m1.1.1.1.cmml" xref="S4.T4.11.11.11.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.11.11.11.1.m1.1.1.2.cmml" xref="S4.T4.11.11.11.1.m1.1.1.2">1.83</cn><cn type="float" id="S4.T4.11.11.11.1.m1.1.1.3.cmml" xref="S4.T4.11.11.11.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.11.11.11.1.m1.1c">1.83\pm 0.05</annotation></semantics></math></td>
<td id="S4.T4.12.12.12.2" class="ltx_td ltx_align_center"><math id="S4.T4.12.12.12.2.m1.1" class="ltx_Math" alttext="1.96\pm 0.05" display="inline"><semantics id="S4.T4.12.12.12.2.m1.1a"><mrow id="S4.T4.12.12.12.2.m1.1.1" xref="S4.T4.12.12.12.2.m1.1.1.cmml"><mn id="S4.T4.12.12.12.2.m1.1.1.2" xref="S4.T4.12.12.12.2.m1.1.1.2.cmml">1.96</mn><mo id="S4.T4.12.12.12.2.m1.1.1.1" xref="S4.T4.12.12.12.2.m1.1.1.1.cmml">±</mo><mn id="S4.T4.12.12.12.2.m1.1.1.3" xref="S4.T4.12.12.12.2.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.12.12.12.2.m1.1b"><apply id="S4.T4.12.12.12.2.m1.1.1.cmml" xref="S4.T4.12.12.12.2.m1.1.1"><csymbol cd="latexml" id="S4.T4.12.12.12.2.m1.1.1.1.cmml" xref="S4.T4.12.12.12.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.12.12.12.2.m1.1.1.2.cmml" xref="S4.T4.12.12.12.2.m1.1.1.2">1.96</cn><cn type="float" id="S4.T4.12.12.12.2.m1.1.1.3.cmml" xref="S4.T4.12.12.12.2.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.12.12.12.2.m1.1c">1.96\pm 0.05</annotation></semantics></math></td>
<td id="S4.T4.13.13.13.3" class="ltx_td ltx_align_center"><math id="S4.T4.13.13.13.3.m1.1" class="ltx_Math" alttext="2.03\pm 0.04" display="inline"><semantics id="S4.T4.13.13.13.3.m1.1a"><mrow id="S4.T4.13.13.13.3.m1.1.1" xref="S4.T4.13.13.13.3.m1.1.1.cmml"><mn id="S4.T4.13.13.13.3.m1.1.1.2" xref="S4.T4.13.13.13.3.m1.1.1.2.cmml">2.03</mn><mo id="S4.T4.13.13.13.3.m1.1.1.1" xref="S4.T4.13.13.13.3.m1.1.1.1.cmml">±</mo><mn id="S4.T4.13.13.13.3.m1.1.1.3" xref="S4.T4.13.13.13.3.m1.1.1.3.cmml">0.04</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.13.13.13.3.m1.1b"><apply id="S4.T4.13.13.13.3.m1.1.1.cmml" xref="S4.T4.13.13.13.3.m1.1.1"><csymbol cd="latexml" id="S4.T4.13.13.13.3.m1.1.1.1.cmml" xref="S4.T4.13.13.13.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.13.13.13.3.m1.1.1.2.cmml" xref="S4.T4.13.13.13.3.m1.1.1.2">2.03</cn><cn type="float" id="S4.T4.13.13.13.3.m1.1.1.3.cmml" xref="S4.T4.13.13.13.3.m1.1.1.3">0.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.13.13.13.3.m1.1c">2.03\pm 0.04</annotation></semantics></math></td>
<td id="S4.T4.14.14.14.4" class="ltx_td ltx_align_center"><math id="S4.T4.14.14.14.4.m1.1" class="ltx_Math" alttext="2.01\pm 0.04" display="inline"><semantics id="S4.T4.14.14.14.4.m1.1a"><mrow id="S4.T4.14.14.14.4.m1.1.1" xref="S4.T4.14.14.14.4.m1.1.1.cmml"><mn id="S4.T4.14.14.14.4.m1.1.1.2" xref="S4.T4.14.14.14.4.m1.1.1.2.cmml">2.01</mn><mo id="S4.T4.14.14.14.4.m1.1.1.1" xref="S4.T4.14.14.14.4.m1.1.1.1.cmml">±</mo><mn id="S4.T4.14.14.14.4.m1.1.1.3" xref="S4.T4.14.14.14.4.m1.1.1.3.cmml">0.04</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.14.14.14.4.m1.1b"><apply id="S4.T4.14.14.14.4.m1.1.1.cmml" xref="S4.T4.14.14.14.4.m1.1.1"><csymbol cd="latexml" id="S4.T4.14.14.14.4.m1.1.1.1.cmml" xref="S4.T4.14.14.14.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.14.14.14.4.m1.1.1.2.cmml" xref="S4.T4.14.14.14.4.m1.1.1.2">2.01</cn><cn type="float" id="S4.T4.14.14.14.4.m1.1.1.3.cmml" xref="S4.T4.14.14.14.4.m1.1.1.3">0.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.14.14.14.4.m1.1c">2.01\pm 0.04</annotation></semantics></math></td>
<td id="S4.T4.15.15.15.5" class="ltx_td ltx_align_center"><math id="S4.T4.15.15.15.5.m1.1" class="ltx_Math" alttext="1.85\pm 0.05" display="inline"><semantics id="S4.T4.15.15.15.5.m1.1a"><mrow id="S4.T4.15.15.15.5.m1.1.1" xref="S4.T4.15.15.15.5.m1.1.1.cmml"><mn id="S4.T4.15.15.15.5.m1.1.1.2" xref="S4.T4.15.15.15.5.m1.1.1.2.cmml">1.85</mn><mo id="S4.T4.15.15.15.5.m1.1.1.1" xref="S4.T4.15.15.15.5.m1.1.1.1.cmml">±</mo><mn id="S4.T4.15.15.15.5.m1.1.1.3" xref="S4.T4.15.15.15.5.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.15.15.15.5.m1.1b"><apply id="S4.T4.15.15.15.5.m1.1.1.cmml" xref="S4.T4.15.15.15.5.m1.1.1"><csymbol cd="latexml" id="S4.T4.15.15.15.5.m1.1.1.1.cmml" xref="S4.T4.15.15.15.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S4.T4.15.15.15.5.m1.1.1.2.cmml" xref="S4.T4.15.15.15.5.m1.1.1.2">1.85</cn><cn type="float" id="S4.T4.15.15.15.5.m1.1.1.3.cmml" xref="S4.T4.15.15.15.5.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.15.15.15.5.m1.1c">1.85\pm 0.05</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We described two additions to the FedAvg algorithm: representation matching and adaptive hyper-parameters. We compared representation matching (FA+RM) against a scheme based on penalizing weight divergence (FA+WD) and FA+RM came out on top by a significant margin in the more difficult tasks we tried: CIFAR10 and KWS. We compared our adaptive hyper-parameter scheme against a fixed hyper-parameter schedule chosen based on experience. In most cases, adaptive hyper-parameters outperform the fixed-schedule scheme. The combination of our two new additions (FA+RM+AH) slightly improves performance compared to standard FA in the small MNIST network and significantly improves performance on the deeper networks used in CIFAR10 and KWS.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p">The hyper-parameter schedule chosen by our REINFORCE algorithm exhibits some easily interpretable behavior such as reducing the learning rate in the more difficult <span id="S5.p2.1.1" class="ltx_text ltx_font_bold">non-iid</span> cases. However, we see some behavior that does not have an immediately obvious interpretation. For example, in order to maximize rewards in the <span id="S5.p2.1.2" class="ltx_text ltx_font_bold">non-iid</span> case, reducing the learning rate is more important than reducing the number of SGD iterations per round as can be seen in Fig. <a href="#S4.F3" title="Figure 3 ‣ Keyword spotting task ‣ 4 Experimental results ‣ Robust Federated Learning Through Representation Matching and Adaptive Hyper-parameters" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. It is important to note that at each round, our online REINFORCE algorithm only seeks to maximize the loss improvement in the last few rounds. Moreover, our algorithm continuously samples hyper-parameters around the mean to determine the direction of highest reward. These noisy hyper-parameter choices could prove problematic in settings that depend on highly tuned schedules and which have no room for online exploration of hyper-parameters. We thus expect our scheme would be outperformed by traditional automated hyper-parameter tuning methods that tune hyper-parameters to maximize the final validation loss. However, our scheme is significantly more efficient as it does not require repeated training and introduces only a small computational overhead in each round.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abdallah &amp; Kaisers (2016)</span>
<span class="ltx_bibblock">
Sherief Abdallah and Michael Kaisers.

</span>
<span class="ltx_bibblock">Addressing environment non-stationarity by repeating q-learning
updates.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, 17(1):1582–1612, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bergstra &amp; Bengio (2012)</span>
<span class="ltx_bibblock">
James Bergstra and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Random search for hyper-parameter optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 13(Feb):281–305, 2012.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bergstra et al. (2011)</span>
<span class="ltx_bibblock">
J.S. Bergstra, Rémi Bardenet, Yoshua Bengio, and Balázs Kégl.

</span>
<span class="ltx_bibblock">Algorithms for hyper-parameter optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, pp. 2546–2554, 2011.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Daniel et al. (2016)</span>
<span class="ltx_bibblock">
Christian Daniel, Jonathan Taylor, and Sebastian Nowozin.

</span>
<span class="ltx_bibblock">Learning step size controllers for robust neural network training.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Thirtieth AAAI Conference on Artificial Intelligence</em>, 2016.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Franceschi et al. (2017)</span>
<span class="ltx_bibblock">
Luca Franceschi, Michele Donini, Paolo Frasconi, and Massimiliano Pontil.

</span>
<span class="ltx_bibblock">Forward and reverse gradient-based hyperparameter optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 34th International Conference on Machine
Learning-Volume 70</em>, pp.  1165–1173. JMLR. org, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ganin et al. (2016)</span>
<span class="ltx_bibblock">
Yaroslav Ganin, Evgeniya Ustinova, Hana Ajakan, Pascal Germain, Hugo
Larochelle, François Laviolette, Mario Marchand, and Victor Lempitsky.

</span>
<span class="ltx_bibblock">Domain-adversarial training of neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">The Journal of Machine Learning Research</em>, 17(1):2096–2030, 2016.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Greensmith et al. (2004)</span>
<span class="ltx_bibblock">
Evan Greensmith, P.L. Bartlett, and Jonathan Baxter.

</span>
<span class="ltx_bibblock">Variance reduction techniques for gradient estimates in reinforcement
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 5(Nov):1471–1530, 2004.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ha et al. (2016)</span>
<span class="ltx_bibblock">
David Ha, Andrew Dai, and Q.V. Le.

</span>
<span class="ltx_bibblock">Hypernetworks.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1609.09106</em>, 2016.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jaakkola et al. (1995)</span>
<span class="ltx_bibblock">
Tommi Jaakkola, S.P. Singh, and M.I. Jordan.

</span>
<span class="ltx_bibblock">Reinforcement learning algorithm for partially observable markov
decision problems.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, pp. 345–352, 1995.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jomaa et al. (2019)</span>
<span class="ltx_bibblock">
H.S. Jomaa, Josif Grabocka, and Lars Schmidt-Thieme.

</span>
<span class="ltx_bibblock">Hyp-rl: Hyperparameter optimization by reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.11527</em>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klein et al. (2016)</span>
<span class="ltx_bibblock">
Aaron Klein, Stefan Falkner, Simon Bartels, Philipp Hennig, and Frank Hutter.

</span>
<span class="ltx_bibblock">Fast bayesian optimization of machine learning hyperparameters on
large datasets.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1605.07079</em>, 2016.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečnỳ et al. (2016)</span>
<span class="ltx_bibblock">
Jakub Konečnỳ, H.B. McMahan, F.X. Yu, Peter Richtárik, A.T.
Suresh, and Dave Bacon.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2016)</span>
<span class="ltx_bibblock">
Lisha Li, Kevin Jamieson, Giulia DeSalvo, Afshin Rostamizadeh, and Ameet
Talwalkar.

</span>
<span class="ltx_bibblock">Hyperband: A novel bandit-based approach to hyperparameter
optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1603.06560</em>, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2018)</span>
<span class="ltx_bibblock">
Tian Li, A.K. Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.06127</em>, 2018.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lorraine &amp; Duvenaud (2018)</span>
<span class="ltx_bibblock">
Jonathan Lorraine and David Duvenaud.

</span>
<span class="ltx_bibblock">Stochastic hyperparameter optimization through hypernetworks.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1802.09419</em>, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maclaurin et al. (2015)</span>
<span class="ltx_bibblock">
Dougal Maclaurin, David Duvenaud, and Ryan Adams.

</span>
<span class="ltx_bibblock">Gradient-based hyperparameter optimization through reversible
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 2113–2122, 2015.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2016)</span>
<span class="ltx_bibblock">
H.B. McMahan, Eider Moore, Daniel Ramage, Seth Hampson, et al.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1602.05629</em>, 2016.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Padakandla et al. (2019)</span>
<span class="ltx_bibblock">
Sindhu Padakandla, Shalabh Bhatnagar, et al.

</span>
<span class="ltx_bibblock">Reinforcement learning in non-stationary environments.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1905.03970</em>, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pereyra et al. (2017)</span>
<span class="ltx_bibblock">
Gabriel Pereyra, George Tucker, Jan Chorowski, Łukasz Kaiser, and Geoffrey
Hinton.

</span>
<span class="ltx_bibblock">Regularizing neural networks by penalizing confident output
distributions.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1701.06548</em>, 2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rasmus et al. (2015)</span>
<span class="ltx_bibblock">
Antti Rasmus, Mathias Berglund, Mikko Honkala, Harri Valpola, and Tapani Raiko.

</span>
<span class="ltx_bibblock">Semi-supervised learning with ladder networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, pp. 3546–3554, 2015.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rezende et al. (2014)</span>
<span class="ltx_bibblock">
D.J. Rezende, Shakir Mohamed, and Daan Wierstra.

</span>
<span class="ltx_bibblock">Stochastic backpropagation and approximate inference in deep
generative models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">ICML</em>, pp.  1278–1286, 2014.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. (2019)</span>
<span class="ltx_bibblock">
Felix Sattler, Simon Wiedemann, Klaus-Robert Müller, and Wojciech Samek.

</span>
<span class="ltx_bibblock">Robust and communication-efficient federated learning from non-iid
data.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1903.02891</em>, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2017)</span>
<span class="ltx_bibblock">
Jian Shen, Yanru Qu, Weinan Zhang, and Yong Yu.

</span>
<span class="ltx_bibblock">Wasserstein distance guided representation learning for domain
adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1707.01217</em>, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Snoek et al. (2012)</span>
<span class="ltx_bibblock">
Jasper Snoek, Hugo Larochelle, and R.P. Adams.

</span>
<span class="ltx_bibblock">Practical bayesian optimization of machine learning algorithms.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, pp. 2951–2959, 2012.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Warden (2018)</span>
<span class="ltx_bibblock">
Pete Warden.

</span>
<span class="ltx_bibblock">Speech commands: A dataset for limited-vocabulary speech recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1804.03209</em>, 2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams (1992)</span>
<span class="ltx_bibblock">
R.J. Williams.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following algorithms for connectionist
reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Machine learning</em>, 8(3-4):229–256, 1992.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2017)</span>
<span class="ltx_bibblock">
Chang Xu, Tao Qin, Gang Wang, and Tie-Yan Liu.

</span>
<span class="ltx_bibblock">Reinforcement learning for learning rate control.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1705.11159</em>, 2017.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2015)</span>
<span class="ltx_bibblock">
J.J. Zhao, Michael Mathieu, Ross Goroshin, and Yann LeCun.

</span>
<span class="ltx_bibblock">Stacked what-where auto-encoders.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1506.02351</em>, 2015.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1912.13074" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1912.13075" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1912.13075">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1912.13075" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1912.13076" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 13:07:33 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
