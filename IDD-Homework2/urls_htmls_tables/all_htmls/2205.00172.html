<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2205.00172] FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation</title><meta property="og:description" content="Federated learning provides a privacy guarantee for generating good deep learning models on distributed clients with different kinds of data. Nevertheless, dealing with non-IID data is one of the most challenging probl…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2205.00172">

<!--Generated on Mon Mar 11 17:01:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning provides a privacy guarantee for generating good deep learning models on distributed clients with different kinds of data. Nevertheless, dealing with non-IID data is one of the most challenging problems for federated learning. Researchers have proposed a variety of methods to eliminate the negative influence of non-IIDness. However, they only focus on the non-IID data provided that the universal class distribution is balanced. In many real-world applications, the universal class distribution is long-tailed, which causes the model seriously biased. Therefore, this paper studies the joint problem of non-IID and long-tailed data in federated learning and proposes a corresponding solution called Federated Ensemble Distillation with Imbalance Calibration (FEDIC). To deal with non-IID data, FEDIC uses model ensemble to take advantage of the diversity of models trained on non-IID data. Then, a new distillation method with logit adjustment and calibration gating network is proposed to solve the long-tail problem effectively. We evaluate FEDIC on CIFAR-10-LT, CIFAR-100-LT, and ImageNet-LT with a highly non-IID experimental setting, in comparison with the state-of-the-art methods of federated learning and long-tail learning. Our code is available at <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self" style="color:#FF00FF;">https://github.com/shangxinyi/FEDIC</span><span id="id1.id1.1" class="ltx_text" style="color:#000000;">.</span></p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— </span></span>
Federated learning, Non-IID, Long-tailed learning, Distillation</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2205.00172/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="369" height="328" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Fig. 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">An example of federated learning application for the task of gallery tagging on mobile phones. The majority class in each client is shown in parentheses.
</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In recent years, an increasing number of deep learning techniques have been deployed in mobile devices to handle data from different sources, e.g., cameras, microphones, GPS, and other sensors. These data play a key role in generating strong predictive models to provide better services to the users. However, transmitting user data to the server would bring high privacy risks for both the service providers and mobile users <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Recently, federated learning has received increasing attention due to its capacity for distributed machine learning with privacy protection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Data privacy is guaranteed by storing data and training model locally on each client.
The global model on the server is produced by aggregating local models transmitted from clients without the requirement of any data from them <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
However, data heterogeneity is still a major challenge in federated learning.
Since the data in each client may be drawn from different distributions without meeting the requirement of IID <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>,
training on this kind of data results in poor generalization ability of the global model.
</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In the literature, a number of methods have been proposed to deal with non-IID data in federated learning. They can be roughly categorized into client-side methods and server-side methods, respectively. The former aims to improve the local training process. Most of them regularize the local training process such that the diversity of client models can be limited <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. The latter adopts specific model aggregation mechanisms to alleviate the negative influence of data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Some recent works have adopted knowledge distillation on the server <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The knowledge is transfered from an ensemble model, which is built by local models, to the global model. There are also some other methods that focus on optimization strategy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> on the server.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Although the abovementioned methods solve the data non-IIDness problem to some extent, they generally assume that the universal class distribution is balanced,
which may not be true from a practical perspective.
As shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, if we consider the overall clients, a few classes like scenery have a large number of samples, while many classes like pet or food only take a small portion. Building a classification model on this kind of distribution is termed long-tail learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, which has been extensively studied in recent years. Some methods origin from the traditional imbalance learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, where the re-sampling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> or re-weighing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> techniques are adopted to alleviate the imbalance influence. The other methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> take advantage of the uniqueness of the deep learning model and focus on the representation learning.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The existing solutions for non-IID data in federated learning generally perform poorly on the tail classes due to the lack of consideration of the universal long-tail distribution. The global class distribution is long-tailed such that each client only holds a few tail classes, which makes local models perform poorly on the tail classes. Therefore, the global model aggregated by biased local models is also biased.
There are also some methods specifically designed for federated learning on imbalanced data. One strategy is to adopt client selection to match complementary clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. However, some clients may lose the chance to participate in model aggregation on the server if they cannot be matched with other clients. Recently, ratio loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> has been proposed to estimate the global imbalance status to help improve local optimization. However, the performance of ratio loss is dropped as the degree of data non-IIDness increases.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this paper, we study the problem of federated learning on non-IID and long-tailed data, and correspondingly propose an effective server-side method called Federated Ensemble Distillation with Imbalance Calibration (FEDIC) without prior knowledge of global class distribution. In FEDIC, the knowledge distillation technique is adopted on the server to transfer the knowledge from the ensemble model to the global model.
However, in the long-tailed setting, the ensemble model may still be biased towards the head classes. Subsequently, the transferred knowledge may not be helpful.
We therefore propose a novel ensemble calibration method to eliminate the bias of the ensemble model before conducting knowledge distillation.
Specifically, we first propose a new logit adjustment to reconstruct the ensemble model from the perspectives of clients and classes, respectively. Then, a calibration gating network is proposed to fuse the adjusted logits based on ensemble representations effectively. The final ensemble model generalizes well on both head and tail classes after calibration.
The contributions of this paper can be summarized as follows:
</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">This paper is a pioneering work in federated learning to study the joint problems of the data non-IIDness and long-tail learning.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a new ensemble calibration method by logit adjustment and calibration gating network techniques to effectively make the output of the ensemble model unbiased.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We propose an effective server-side federated learning method FEDIC, which utilizes the knowledge distillation technique to enhance the robustness of the global model on both non-IID and long-tailed data.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2205.00172/assets/x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="204" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Fig. 2</span>: </span><span id="S1.F2.3.2" class="ltx_text" style="font-size:90%;">The framework of FEDIC on the server.
</span></figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Proposed method</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we first describe the problem setting with some basic notations and then introduce FEDIC for federated learning on non-IID and long-tailed data.

</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Problem Setting</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.17" class="ltx_p">In this paper, the learning scenario is based on a typical federated learning system with <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients holding potentially non-IID local datasets <math id="S2.SS1.p1.2.m2.4" class="ltx_Math" alttext="\mathcal{D}^{1},\mathcal{D}^{2},...,\mathcal{D}^{K}" display="inline"><semantics id="S2.SS1.p1.2.m2.4a"><mrow id="S2.SS1.p1.2.m2.4.4.3" xref="S2.SS1.p1.2.m2.4.4.4.cmml"><msup id="S2.SS1.p1.2.m2.2.2.1.1" xref="S2.SS1.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.2.2.1.1.2" xref="S2.SS1.p1.2.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="S2.SS1.p1.2.m2.2.2.1.1.3" xref="S2.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msup><mo id="S2.SS1.p1.2.m2.4.4.3.4" xref="S2.SS1.p1.2.m2.4.4.4.cmml">,</mo><msup id="S2.SS1.p1.2.m2.3.3.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.3.3.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.cmml">𝒟</mi><mn id="S2.SS1.p1.2.m2.3.3.2.2.3" xref="S2.SS1.p1.2.m2.3.3.2.2.3.cmml">2</mn></msup><mo id="S2.SS1.p1.2.m2.4.4.3.5" xref="S2.SS1.p1.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS1.p1.2.m2.4.4.3.6" xref="S2.SS1.p1.2.m2.4.4.4.cmml">,</mo><msup id="S2.SS1.p1.2.m2.4.4.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.4.4.3.3.2" xref="S2.SS1.p1.2.m2.4.4.3.3.2.cmml">𝒟</mi><mi id="S2.SS1.p1.2.m2.4.4.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.4b"><list id="S2.SS1.p1.2.m2.4.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4.3"><apply id="S2.SS1.p1.2.m2.2.2.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1">superscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.2">𝒟</ci><cn type="integer" id="S2.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S2.SS1.p1.2.m2.3.3.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2">superscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2">𝒟</ci><cn type="integer" id="S2.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">…</ci><apply id="S2.SS1.p1.2.m2.4.4.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.4.4.3.3.1.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3">superscript</csymbol><ci id="S2.SS1.p1.2.m2.4.4.3.3.2.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.2">𝒟</ci><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.4c">\mathcal{D}^{1},\mathcal{D}^{2},...,\mathcal{D}^{K}</annotation></semantics></math>, respectively. The goal is to obtain a global model on the server over the union of all these datasets <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}\triangleq\bigcup_{k\leq K}\mathcal{D}^{k}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">𝒟</mi><mo rspace="0.111em" id="S2.SS1.p1.3.m3.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.cmml">≜</mo><mrow id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml"><msub id="S2.SS1.p1.3.m3.1.1.3.1" xref="S2.SS1.p1.3.m3.1.1.3.1.cmml"><mo id="S2.SS1.p1.3.m3.1.1.3.1.2" xref="S2.SS1.p1.3.m3.1.1.3.1.2.cmml">⋃</mo><mrow id="S2.SS1.p1.3.m3.1.1.3.1.3" xref="S2.SS1.p1.3.m3.1.1.3.1.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.3.1.3.2" xref="S2.SS1.p1.3.m3.1.1.3.1.3.2.cmml">k</mi><mo id="S2.SS1.p1.3.m3.1.1.3.1.3.1" xref="S2.SS1.p1.3.m3.1.1.3.1.3.1.cmml">≤</mo><mi id="S2.SS1.p1.3.m3.1.1.3.1.3.3" xref="S2.SS1.p1.3.m3.1.1.3.1.3.3.cmml">K</mi></mrow></msub><msup id="S2.SS1.p1.3.m3.1.1.3.2" xref="S2.SS1.p1.3.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1.3.2.2" xref="S2.SS1.p1.3.m3.1.1.3.2.2.cmml">𝒟</mi><mi id="S2.SS1.p1.3.m3.1.1.3.2.3" xref="S2.SS1.p1.3.m3.1.1.3.2.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><ci id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1">≜</ci><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝒟</ci><apply id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3"><apply id="S2.SS1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1">subscript</csymbol><union id="S2.SS1.p1.3.m3.1.1.3.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1.2"></union><apply id="S2.SS1.p1.3.m3.1.1.3.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1.3"><leq id="S2.SS1.p1.3.m3.1.1.3.1.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1.3.1"></leq><ci id="S2.SS1.p1.3.m3.1.1.3.1.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1.3.2">𝑘</ci><ci id="S2.SS1.p1.3.m3.1.1.3.1.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1.3.3">𝐾</ci></apply></apply><apply id="S2.SS1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.3.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.3.2">superscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.3.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.3.2.2">𝒟</ci><ci id="S2.SS1.p1.3.m3.1.1.3.2.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathcal{D}\triangleq\bigcup_{k\leq K}\mathcal{D}^{k}</annotation></semantics></math> without access to any data <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}^{k}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msup id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝒟</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\mathcal{D}^{k}</annotation></semantics></math> on the <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">k</annotation></semantics></math>-th client. The setting difference in this paper is that <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathcal{D}</annotation></semantics></math> is drawn from a long-tailed distribution <math id="S2.SS1.p1.7.m7.2" class="ltx_Math" alttext="(\mathcal{X},\mathcal{Y})" display="inline"><semantics id="S2.SS1.p1.7.m7.2a"><mrow id="S2.SS1.p1.7.m7.2.3.2" xref="S2.SS1.p1.7.m7.2.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.2.3.2.1" xref="S2.SS1.p1.7.m7.2.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">𝒳</mi><mo id="S2.SS1.p1.7.m7.2.3.2.2" xref="S2.SS1.p1.7.m7.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.2.2" xref="S2.SS1.p1.7.m7.2.2.cmml">𝒴</mi><mo stretchy="false" id="S2.SS1.p1.7.m7.2.3.2.3" xref="S2.SS1.p1.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.2b"><interval closure="open" id="S2.SS1.p1.7.m7.2.3.1.cmml" xref="S2.SS1.p1.7.m7.2.3.2"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝒳</ci><ci id="S2.SS1.p1.7.m7.2.2.cmml" xref="S2.SS1.p1.7.m7.2.2">𝒴</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.2c">(\mathcal{X},\mathcal{Y})</annotation></semantics></math>, <math id="S2.SS1.p1.8.m8.3" class="ltx_Math" alttext="\mathcal{Y}\in\{1,...,C\}" display="inline"><semantics id="S2.SS1.p1.8.m8.3a"><mrow id="S2.SS1.p1.8.m8.3.4" xref="S2.SS1.p1.8.m8.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m8.3.4.2" xref="S2.SS1.p1.8.m8.3.4.2.cmml">𝒴</mi><mo id="S2.SS1.p1.8.m8.3.4.1" xref="S2.SS1.p1.8.m8.3.4.1.cmml">∈</mo><mrow id="S2.SS1.p1.8.m8.3.4.3.2" xref="S2.SS1.p1.8.m8.3.4.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.8.m8.3.4.3.2.1" xref="S2.SS1.p1.8.m8.3.4.3.1.cmml">{</mo><mn id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">1</mn><mo id="S2.SS1.p1.8.m8.3.4.3.2.2" xref="S2.SS1.p1.8.m8.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.8.m8.2.2" xref="S2.SS1.p1.8.m8.2.2.cmml">…</mi><mo id="S2.SS1.p1.8.m8.3.4.3.2.3" xref="S2.SS1.p1.8.m8.3.4.3.1.cmml">,</mo><mi id="S2.SS1.p1.8.m8.3.3" xref="S2.SS1.p1.8.m8.3.3.cmml">C</mi><mo stretchy="false" id="S2.SS1.p1.8.m8.3.4.3.2.4" xref="S2.SS1.p1.8.m8.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.3b"><apply id="S2.SS1.p1.8.m8.3.4.cmml" xref="S2.SS1.p1.8.m8.3.4"><in id="S2.SS1.p1.8.m8.3.4.1.cmml" xref="S2.SS1.p1.8.m8.3.4.1"></in><ci id="S2.SS1.p1.8.m8.3.4.2.cmml" xref="S2.SS1.p1.8.m8.3.4.2">𝒴</ci><set id="S2.SS1.p1.8.m8.3.4.3.1.cmml" xref="S2.SS1.p1.8.m8.3.4.3.2"><cn type="integer" id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">1</cn><ci id="S2.SS1.p1.8.m8.2.2.cmml" xref="S2.SS1.p1.8.m8.2.2">…</ci><ci id="S2.SS1.p1.8.m8.3.3.cmml" xref="S2.SS1.p1.8.m8.3.3">𝐶</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.3c">\mathcal{Y}\in\{1,...,C\}</annotation></semantics></math>, which is unknown in advance. The model in federated learning is typically a neural network <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="\phi_{\mathbf{w}}" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><msub id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">𝐰</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">italic-ϕ</ci><ci id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\phi_{\mathbf{w}}</annotation></semantics></math> with parameters <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><mi id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><ci id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathbf{w}</annotation></semantics></math>. <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="\phi_{\mathbf{w}}" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><msub id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">𝐰</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2">italic-ϕ</ci><ci id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">\phi_{\mathbf{w}}</annotation></semantics></math> has two components: 1) a feature extractor <math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="f_{\mathbf{w}}" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><msub id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml"><mi id="S2.SS1.p1.12.m12.1.1.2" xref="S2.SS1.p1.12.m12.1.1.2.cmml">f</mi><mi id="S2.SS1.p1.12.m12.1.1.3" xref="S2.SS1.p1.12.m12.1.1.3.cmml">𝐰</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2">𝑓</ci><ci id="S2.SS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">f_{\mathbf{w}}</annotation></semantics></math>, mapping each sample <math id="S2.SS1.p1.13.m13.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS1.p1.13.m13.1a"><mi id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><ci id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">\mathbf{x}</annotation></semantics></math> to a <math id="S2.SS1.p1.14.m14.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS1.p1.14.m14.1a"><mi id="S2.SS1.p1.14.m14.1.1" xref="S2.SS1.p1.14.m14.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m14.1b"><ci id="S2.SS1.p1.14.m14.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m14.1c">d</annotation></semantics></math>-dim representation vector; 2) a classifier <math id="S2.SS1.p1.15.m15.1" class="ltx_Math" alttext="h_{\mathbf{w}}" display="inline"><semantics id="S2.SS1.p1.15.m15.1a"><msub id="S2.SS1.p1.15.m15.1.1" xref="S2.SS1.p1.15.m15.1.1.cmml"><mi id="S2.SS1.p1.15.m15.1.1.2" xref="S2.SS1.p1.15.m15.1.1.2.cmml">h</mi><mi id="S2.SS1.p1.15.m15.1.1.3" xref="S2.SS1.p1.15.m15.1.1.3.cmml">𝐰</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m15.1b"><apply id="S2.SS1.p1.15.m15.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.1.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S2.SS1.p1.15.m15.1.1.2.cmml" xref="S2.SS1.p1.15.m15.1.1.2">ℎ</ci><ci id="S2.SS1.p1.15.m15.1.1.3.cmml" xref="S2.SS1.p1.15.m15.1.1.3">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m15.1c">h_{\mathbf{w}}</annotation></semantics></math>, typically being a fully-connected layer which outputs logits to denote class confidence scores. The parameters of client <math id="S2.SS1.p1.16.m16.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p1.16.m16.1a"><mi id="S2.SS1.p1.16.m16.1.1" xref="S2.SS1.p1.16.m16.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m16.1b"><ci id="S2.SS1.p1.16.m16.1.1.cmml" xref="S2.SS1.p1.16.m16.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m16.1c">k</annotation></semantics></math>’s local model are denoted as <math id="S2.SS1.p1.17.m17.1" class="ltx_Math" alttext="\mathbf{w}_{k}" display="inline"><semantics id="S2.SS1.p1.17.m17.1a"><msub id="S2.SS1.p1.17.m17.1.1" xref="S2.SS1.p1.17.m17.1.1.cmml"><mi id="S2.SS1.p1.17.m17.1.1.2" xref="S2.SS1.p1.17.m17.1.1.2.cmml">𝐰</mi><mi id="S2.SS1.p1.17.m17.1.1.3" xref="S2.SS1.p1.17.m17.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m17.1b"><apply id="S2.SS1.p1.17.m17.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.17.m17.1.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1">subscript</csymbol><ci id="S2.SS1.p1.17.m17.1.1.2.cmml" xref="S2.SS1.p1.17.m17.1.1.2">𝐰</ci><ci id="S2.SS1.p1.17.m17.1.1.3.cmml" xref="S2.SS1.p1.17.m17.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m17.1c">\mathbf{w}_{k}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Proposed Method</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">FEDIC is a server-side method based on FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> without intervening in the local training process on each client. It is based on an intuitive idea: The ensemble of the local client models has better generalization ability than the global model produced by parameter averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Since the local models are trained on non-IID data, their prediction results are highly diverse, which is one of the most important factors that make the ensemble model work better than a single model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. However, due to model heterogeneity, the ensemble model cannot be transmitted to the clients for further updating. Therefore, it is straightforward to leverage knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> to transfer the generalization ability from the ensemble model to the global model. Then, the distilled global model is transmitted to each client for further updating.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.5" class="ltx_p">Specifically, on the server, we can construct the ensemble model as the teacher model:</p>
<table id="S4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\displaystyle\phi^{t}(\mathbf{x})=\sum_{k=1}^{K}e_{k}\phi_{\mathbf{w}_{k}}(\mathbf{x})," display="inline"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><msup id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.cmml">ϕ</mi><mi id="S2.E1.m1.3.3.1.1.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.1" xref="S2.E1.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.3.2.1" xref="S2.E1.m1.3.3.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.3.2.2" xref="S2.E1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E1.m1.3.3.1.1.3.1" xref="S2.E1.m1.3.3.1.1.3.1.cmml"><munderover id="S2.E1.m1.3.3.1.1.3.1a" xref="S2.E1.m1.3.3.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E1.m1.3.3.1.1.3.1.2.2" xref="S2.E1.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.3.1.2.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.1.2.3.2" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.3.3.1.1.3.1.2.3.1" xref="S2.E1.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.3.3.1.1.3.1.2.3.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.3.3.1.1.3.1.3" xref="S2.E1.m1.3.3.1.1.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S2.E1.m1.3.3.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml"><msub id="S2.E1.m1.3.3.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.2.cmml">e</mi><mi id="S2.E1.m1.3.3.1.1.3.2.2.3" xref="S2.E1.m1.3.3.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.3.2.1" xref="S2.E1.m1.3.3.1.1.3.2.1.cmml">​</mo><msub id="S2.E1.m1.3.3.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.3.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.3.2" xref="S2.E1.m1.3.3.1.1.3.2.3.2.cmml">ϕ</mi><msub id="S2.E1.m1.3.3.1.1.3.2.3.3" xref="S2.E1.m1.3.3.1.1.3.2.3.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.2" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2.cmml">𝐰</mi><mi id="S2.E1.m1.3.3.1.1.3.2.3.3.3" xref="S2.E1.m1.3.3.1.1.3.2.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.3.2.1a" xref="S2.E1.m1.3.3.1.1.3.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.3.2.4.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.3.2.4.2.1" xref="S2.E1.m1.3.3.1.1.3.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">𝐱</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.3.2.4.2.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"></eq><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><times id="S2.E1.m1.3.3.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1"></times><apply id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2">superscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2">italic-ϕ</ci><ci id="S2.E1.m1.3.3.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.3">𝑡</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐱</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"><apply id="S2.E1.m1.3.3.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.3.1.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.3.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.2"></sum><apply id="S2.E1.m1.3.3.1.1.3.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3"><eq id="S2.E1.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S2.E1.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.3.3.1.1.3.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.3.3.1.1.3.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.3">𝐾</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2"><times id="S2.E1.m1.3.3.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.1"></times><apply id="S2.E1.m1.3.3.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2">𝑒</ci><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3">𝑘</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.2">italic-ϕ</ci><apply id="S2.E1.m1.3.3.1.1.3.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.2">𝐰</ci><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3.3">𝑘</ci></apply></apply><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\displaystyle\phi^{t}(\mathbf{x})=\sum_{k=1}^{K}e_{k}\phi_{\mathbf{w}_{k}}(\mathbf{x}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.3" class="ltx_p">where <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="e_{k}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">e</mi><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑒</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">e_{k}</annotation></semantics></math> is the ensemble weight for client <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">k</annotation></semantics></math>’s local model. Then, we can obtain the global model <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\mathbf{w}</annotation></semantics></math> as the corresponding student model <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>For better notation representation, we ignore the superscript <math id="footnote1.m1.1" class="ltx_Math" alttext="(t)" display="inline"><semantics id="footnote1.m1.1b"><mrow id="footnote1.m1.1.2.2"><mo stretchy="false" id="footnote1.m1.1.2.2.1">(</mo><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">t</mi><mo stretchy="false" id="footnote1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">(t)</annotation></semantics></math> to denote the model in the <math id="footnote1.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="footnote1.m2.1b"><mi id="footnote1.m2.1.1" xref="footnote1.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="footnote1.m2.1c"><ci id="footnote1.m2.1.1.cmml" xref="footnote1.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.1d">t</annotation></semantics></math>-th round, which is usually adopted in federated learning literature.</span></span></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>:</p>
<table id="S4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{w}" display="inline"><semantics id="S2.E2.m1.1a"><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\mathbf{w}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{k=1}^{K}\frac{|\mathcal{D}^{k}|}{|\mathcal{D}|}\mathbf{w}_{k}," display="inline"><semantics id="S2.E2.m2.3a"><mrow id="S2.E2.m2.3.3.1" xref="S2.E2.m2.3.3.1.1.cmml"><mrow id="S2.E2.m2.3.3.1.1" xref="S2.E2.m2.3.3.1.1.cmml"><mi id="S2.E2.m2.3.3.1.1.2" xref="S2.E2.m2.3.3.1.1.2.cmml"></mi><mo id="S2.E2.m2.3.3.1.1.1" xref="S2.E2.m2.3.3.1.1.1.cmml">=</mo><mrow id="S2.E2.m2.3.3.1.1.3" xref="S2.E2.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E2.m2.3.3.1.1.3.1" xref="S2.E2.m2.3.3.1.1.3.1.cmml"><munderover id="S2.E2.m2.3.3.1.1.3.1a" xref="S2.E2.m2.3.3.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E2.m2.3.3.1.1.3.1.2.2" xref="S2.E2.m2.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E2.m2.3.3.1.1.3.1.2.3" xref="S2.E2.m2.3.3.1.1.3.1.2.3.cmml"><mi id="S2.E2.m2.3.3.1.1.3.1.2.3.2" xref="S2.E2.m2.3.3.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.E2.m2.3.3.1.1.3.1.2.3.1" xref="S2.E2.m2.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E2.m2.3.3.1.1.3.1.2.3.3" xref="S2.E2.m2.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m2.3.3.1.1.3.1.3" xref="S2.E2.m2.3.3.1.1.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S2.E2.m2.3.3.1.1.3.2" xref="S2.E2.m2.3.3.1.1.3.2.cmml"><mstyle displaystyle="true" id="S2.E2.m2.2.2" xref="S2.E2.m2.2.2.cmml"><mfrac id="S2.E2.m2.2.2a" xref="S2.E2.m2.2.2.cmml"><mrow id="S2.E2.m2.1.1.1.1" xref="S2.E2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m2.1.1.1.1.2" xref="S2.E2.m2.1.1.1.2.1.cmml">|</mo><msup id="S2.E2.m2.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m2.1.1.1.1.1.2" xref="S2.E2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.E2.m2.1.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S2.E2.m2.1.1.1.1.3" xref="S2.E2.m2.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S2.E2.m2.2.2.2.3" xref="S2.E2.m2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E2.m2.2.2.2.3.1" xref="S2.E2.m2.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m2.2.2.2.1" xref="S2.E2.m2.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S2.E2.m2.2.2.2.3.2" xref="S2.E2.m2.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2.m2.3.3.1.1.3.2.1" xref="S2.E2.m2.3.3.1.1.3.2.1.cmml">​</mo><msub id="S2.E2.m2.3.3.1.1.3.2.2" xref="S2.E2.m2.3.3.1.1.3.2.2.cmml"><mi id="S2.E2.m2.3.3.1.1.3.2.2.2" xref="S2.E2.m2.3.3.1.1.3.2.2.2.cmml">𝐰</mi><mi id="S2.E2.m2.3.3.1.1.3.2.2.3" xref="S2.E2.m2.3.3.1.1.3.2.2.3.cmml">k</mi></msub></mrow></mrow></mrow><mo id="S2.E2.m2.3.3.1.2" xref="S2.E2.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.3b"><apply id="S2.E2.m2.3.3.1.1.cmml" xref="S2.E2.m2.3.3.1"><eq id="S2.E2.m2.3.3.1.1.1.cmml" xref="S2.E2.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S2.E2.m2.3.3.1.1.2.cmml" xref="S2.E2.m2.3.3.1.1.2">absent</csymbol><apply id="S2.E2.m2.3.3.1.1.3.cmml" xref="S2.E2.m2.3.3.1.1.3"><apply id="S2.E2.m2.3.3.1.1.3.1.cmml" xref="S2.E2.m2.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2.m2.3.3.1.1.3.1.1.cmml" xref="S2.E2.m2.3.3.1.1.3.1">superscript</csymbol><apply id="S2.E2.m2.3.3.1.1.3.1.2.cmml" xref="S2.E2.m2.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2.m2.3.3.1.1.3.1.2.1.cmml" xref="S2.E2.m2.3.3.1.1.3.1">subscript</csymbol><sum id="S2.E2.m2.3.3.1.1.3.1.2.2.cmml" xref="S2.E2.m2.3.3.1.1.3.1.2.2"></sum><apply id="S2.E2.m2.3.3.1.1.3.1.2.3.cmml" xref="S2.E2.m2.3.3.1.1.3.1.2.3"><eq id="S2.E2.m2.3.3.1.1.3.1.2.3.1.cmml" xref="S2.E2.m2.3.3.1.1.3.1.2.3.1"></eq><ci id="S2.E2.m2.3.3.1.1.3.1.2.3.2.cmml" xref="S2.E2.m2.3.3.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E2.m2.3.3.1.1.3.1.2.3.3.cmml" xref="S2.E2.m2.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E2.m2.3.3.1.1.3.1.3.cmml" xref="S2.E2.m2.3.3.1.1.3.1.3">𝐾</ci></apply><apply id="S2.E2.m2.3.3.1.1.3.2.cmml" xref="S2.E2.m2.3.3.1.1.3.2"><times id="S2.E2.m2.3.3.1.1.3.2.1.cmml" xref="S2.E2.m2.3.3.1.1.3.2.1"></times><apply id="S2.E2.m2.2.2.cmml" xref="S2.E2.m2.2.2"><divide id="S2.E2.m2.2.2.3.cmml" xref="S2.E2.m2.2.2"></divide><apply id="S2.E2.m2.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1"><abs id="S2.E2.m2.1.1.1.2.1.cmml" xref="S2.E2.m2.1.1.1.1.2"></abs><apply id="S2.E2.m2.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m2.1.1.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S2.E2.m2.1.1.1.1.1.3.cmml" xref="S2.E2.m2.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S2.E2.m2.2.2.2.2.cmml" xref="S2.E2.m2.2.2.2.3"><abs id="S2.E2.m2.2.2.2.2.1.cmml" xref="S2.E2.m2.2.2.2.3.1"></abs><ci id="S2.E2.m2.2.2.2.1.cmml" xref="S2.E2.m2.2.2.2.1">𝒟</ci></apply></apply><apply id="S2.E2.m2.3.3.1.1.3.2.2.cmml" xref="S2.E2.m2.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m2.3.3.1.1.3.2.2.1.cmml" xref="S2.E2.m2.3.3.1.1.3.2.2">subscript</csymbol><ci id="S2.E2.m2.3.3.1.1.3.2.2.2.cmml" xref="S2.E2.m2.3.3.1.1.3.2.2.2">𝐰</ci><ci id="S2.E2.m2.3.3.1.1.3.2.2.3.cmml" xref="S2.E2.m2.3.3.1.1.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.3c">\displaystyle=\sum_{k=1}^{K}\frac{|\mathcal{D}^{k}|}{|\mathcal{D}|}\mathbf{w}_{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\phi^{s}(\mathbf{x})" display="inline"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.2" xref="S2.E3.m1.1.2.cmml"><msup id="S2.E3.m1.1.2.2" xref="S2.E3.m1.1.2.2.cmml"><mi id="S2.E3.m1.1.2.2.2" xref="S2.E3.m1.1.2.2.2.cmml">ϕ</mi><mi id="S2.E3.m1.1.2.2.3" xref="S2.E3.m1.1.2.2.3.cmml">s</mi></msup><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.2.1" xref="S2.E3.m1.1.2.1.cmml">​</mo><mrow id="S2.E3.m1.1.2.3.2" xref="S2.E3.m1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.1.2.3.2.1" xref="S2.E3.m1.1.2.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E3.m1.1.2.3.2.2" xref="S2.E3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.2.cmml" xref="S2.E3.m1.1.2"><times id="S2.E3.m1.1.2.1.cmml" xref="S2.E3.m1.1.2.1"></times><apply id="S2.E3.m1.1.2.2.cmml" xref="S2.E3.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.2.2.1.cmml" xref="S2.E3.m1.1.2.2">superscript</csymbol><ci id="S2.E3.m1.1.2.2.2.cmml" xref="S2.E3.m1.1.2.2.2">italic-ϕ</ci><ci id="S2.E3.m1.1.2.2.3.cmml" xref="S2.E3.m1.1.2.2.3">𝑠</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\phi^{s}(\mathbf{x})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.2" class="ltx_Math" alttext="\displaystyle=\phi_{\mathbf{w}}(\mathbf{x})." display="inline"><semantics id="S2.E3.m2.2a"><mrow id="S2.E3.m2.2.2.1" xref="S2.E3.m2.2.2.1.1.cmml"><mrow id="S2.E3.m2.2.2.1.1" xref="S2.E3.m2.2.2.1.1.cmml"><mi id="S2.E3.m2.2.2.1.1.2" xref="S2.E3.m2.2.2.1.1.2.cmml"></mi><mo id="S2.E3.m2.2.2.1.1.1" xref="S2.E3.m2.2.2.1.1.1.cmml">=</mo><mrow id="S2.E3.m2.2.2.1.1.3" xref="S2.E3.m2.2.2.1.1.3.cmml"><msub id="S2.E3.m2.2.2.1.1.3.2" xref="S2.E3.m2.2.2.1.1.3.2.cmml"><mi id="S2.E3.m2.2.2.1.1.3.2.2" xref="S2.E3.m2.2.2.1.1.3.2.2.cmml">ϕ</mi><mi id="S2.E3.m2.2.2.1.1.3.2.3" xref="S2.E3.m2.2.2.1.1.3.2.3.cmml">𝐰</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m2.2.2.1.1.3.1" xref="S2.E3.m2.2.2.1.1.3.1.cmml">​</mo><mrow id="S2.E3.m2.2.2.1.1.3.3.2" xref="S2.E3.m2.2.2.1.1.3.cmml"><mo stretchy="false" id="S2.E3.m2.2.2.1.1.3.3.2.1" xref="S2.E3.m2.2.2.1.1.3.cmml">(</mo><mi id="S2.E3.m2.1.1" xref="S2.E3.m2.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E3.m2.2.2.1.1.3.3.2.2" xref="S2.E3.m2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E3.m2.2.2.1.2" xref="S2.E3.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.2b"><apply id="S2.E3.m2.2.2.1.1.cmml" xref="S2.E3.m2.2.2.1"><eq id="S2.E3.m2.2.2.1.1.1.cmml" xref="S2.E3.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S2.E3.m2.2.2.1.1.2.cmml" xref="S2.E3.m2.2.2.1.1.2">absent</csymbol><apply id="S2.E3.m2.2.2.1.1.3.cmml" xref="S2.E3.m2.2.2.1.1.3"><times id="S2.E3.m2.2.2.1.1.3.1.cmml" xref="S2.E3.m2.2.2.1.1.3.1"></times><apply id="S2.E3.m2.2.2.1.1.3.2.cmml" xref="S2.E3.m2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.1.1.3.2.1.cmml" xref="S2.E3.m2.2.2.1.1.3.2">subscript</csymbol><ci id="S2.E3.m2.2.2.1.1.3.2.2.cmml" xref="S2.E3.m2.2.2.1.1.3.2.2">italic-ϕ</ci><ci id="S2.E3.m2.2.2.1.1.3.2.3.cmml" xref="S2.E3.m2.2.2.1.1.3.2.3">𝐰</ci></apply><ci id="S2.E3.m2.1.1.cmml" xref="S2.E3.m2.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.2c">\displaystyle=\phi_{\mathbf{w}}(\mathbf{x}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.4" class="ltx_p">However, when the universal class distribution is long-tailed, the generalization ability of the ensemble model on the tail classes is also poor. As a result,it cannot provide a helpful guide to the student model on the tail classes.
Therefore, we propose to utilize a small auxiliary dataset <math id="S2.SS2.p2.4.m1.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S2.SS2.p2.4.m1.1a"><msub id="S2.SS2.p2.4.m1.1.1" xref="S2.SS2.p2.4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m1.1.1.2" xref="S2.SS2.p2.4.m1.1.1.2.cmml">𝒟</mi><mrow id="S2.SS2.p2.4.m1.1.1.3" xref="S2.SS2.p2.4.m1.1.1.3.cmml"><mi id="S2.SS2.p2.4.m1.1.1.3.2" xref="S2.SS2.p2.4.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m1.1.1.3.1" xref="S2.SS2.p2.4.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.4.m1.1.1.3.3" xref="S2.SS2.p2.4.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m1.1.1.3.1a" xref="S2.SS2.p2.4.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p2.4.m1.1.1.3.4" xref="S2.SS2.p2.4.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m1.1b"><apply id="S2.SS2.p2.4.m1.1.1.cmml" xref="S2.SS2.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m1.1.1.1.cmml" xref="S2.SS2.p2.4.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m1.1.1.2.cmml" xref="S2.SS2.p2.4.m1.1.1.2">𝒟</ci><apply id="S2.SS2.p2.4.m1.1.1.3.cmml" xref="S2.SS2.p2.4.m1.1.1.3"><times id="S2.SS2.p2.4.m1.1.1.3.1.cmml" xref="S2.SS2.p2.4.m1.1.1.3.1"></times><ci id="S2.SS2.p2.4.m1.1.1.3.2.cmml" xref="S2.SS2.p2.4.m1.1.1.3.2">𝑎</ci><ci id="S2.SS2.p2.4.m1.1.1.3.3.cmml" xref="S2.SS2.p2.4.m1.1.1.3.3">𝑢</ci><ci id="S2.SS2.p2.4.m1.1.1.3.4.cmml" xref="S2.SS2.p2.4.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m1.1c">\mathcal{D}_{aux}</annotation></semantics></math> on the server, which is labeled and balanced in order to calibrate the ensemble model against the long-tail distribution. The main reason of utilizing the auxiliary data is that the global imbalance degree is unknown for both the server and clients, which makes most of the methods for long-tailed learning are infeasible.
It is worth noting that all auxiliary data is collected independently on the server and there is no data transmission or data sharing in our problem setting.
The model architecture of FEDIC on the server is shown in Fig. <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. In the following, we will describe two core components of FEDIC in detail.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S2.T1.8.2.1" class="ltx_text ltx_font_bold" style="font-size:113%;">Table 1</span>: </span><span id="S2.T1.2.1" class="ltx_text" style="font-size:113%;">Top-1 test accuracy (<math id="S2.T1.2.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S2.T1.2.1.m1.1b"><mo id="S2.T1.2.1.m1.1.1" xref="S2.T1.2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S2.T1.2.1.m1.1c"><csymbol cd="latexml" id="S2.T1.2.1.m1.1.1.cmml" xref="S2.T1.2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.1.m1.1d">\%</annotation></semantics></math>) for FEDIC and compared FL methods on CIFAR-10/100-LT with different IFs.</span></figcaption>
<table id="S2.T1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S2.T1.3.2.1" class="ltx_tr">
<th id="S2.T1.3.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S2.T1.3.2.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S2.T1.3.2.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="3"><span id="S2.T1.3.2.1.3.1" class="ltx_text" style="font-size:80%;">CIFAR-10-LT</span></td>
<td id="S2.T1.3.2.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="3"><span id="S2.T1.3.2.1.4.1" class="ltx_text" style="font-size:80%;">CIFAR-100-LT</span></td>
</tr>
<tr id="S2.T1.3.3.2" class="ltx_tr">
<th id="S2.T1.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.3.2.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Family</span></th>
<th id="S2.T1.3.3.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.3.2.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Method</span></th>
<td id="S2.T1.3.3.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.3.2.3.1" class="ltx_text" style="font-size:80%;">IF=100</span></td>
<td id="S2.T1.3.3.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.3.2.4.1" class="ltx_text" style="font-size:80%;">IF=50</span></td>
<td id="S2.T1.3.3.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.3.2.5.1" class="ltx_text" style="font-size:80%;">IF=10</span></td>
<td id="S2.T1.3.3.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.3.2.6.1" class="ltx_text" style="font-size:80%;">IF=100</span></td>
<td id="S2.T1.3.3.2.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.3.2.7.1" class="ltx_text" style="font-size:80%;">IF=50</span></td>
<td id="S2.T1.3.3.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.3.2.8.1" class="ltx_text" style="font-size:80%;">IF=10</span></td>
</tr>
<tr id="S2.T1.3.4.3" class="ltx_tr">
<th id="S2.T1.3.4.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S2.T1.3.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S2.T1.3.4.3.2.1" class="ltx_text" style="font-size:80%;">FedAvg</span></th>
<td id="S2.T1.3.4.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.4.3.3.1" class="ltx_text" style="font-size:80%;">52.12</span></td>
<td id="S2.T1.3.4.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.4.3.4.1" class="ltx_text" style="font-size:80%;">52.43</span></td>
<td id="S2.T1.3.4.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.4.3.5.1" class="ltx_text" style="font-size:80%;">59.97</span></td>
<td id="S2.T1.3.4.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.4.3.6.1" class="ltx_text" style="font-size:80%;">25.81</span></td>
<td id="S2.T1.3.4.3.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.4.3.7.1" class="ltx_text" style="font-size:80%;">28.19</span></td>
<td id="S2.T1.3.4.3.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S2.T1.3.4.3.8.1" class="ltx_text" style="font-size:80%;">38.22</span></td>
</tr>
<tr id="S2.T1.3.5.4" class="ltx_tr">
<th id="S2.T1.3.5.4.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S2.T1.3.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.5.4.2.1" class="ltx_text" style="font-size:80%;">FedAvgM</span></th>
<td id="S2.T1.3.5.4.3" class="ltx_td ltx_align_center"><span id="S2.T1.3.5.4.3.1" class="ltx_text" style="font-size:80%;">53.64</span></td>
<td id="S2.T1.3.5.4.4" class="ltx_td ltx_align_center"><span id="S2.T1.3.5.4.4.1" class="ltx_text" style="font-size:80%;">54.42</span></td>
<td id="S2.T1.3.5.4.5" class="ltx_td ltx_align_center"><span id="S2.T1.3.5.4.5.1" class="ltx_text" style="font-size:80%;">59.52</span></td>
<td id="S2.T1.3.5.4.6" class="ltx_td ltx_align_center"><span id="S2.T1.3.5.4.6.1" class="ltx_text" style="font-size:80%;">25.11</span></td>
<td id="S2.T1.3.5.4.7" class="ltx_td ltx_align_center"><span id="S2.T1.3.5.4.7.1" class="ltx_text" style="font-size:80%;">28.82</span></td>
<td id="S2.T1.3.5.4.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S2.T1.3.5.4.8.1" class="ltx_text" style="font-size:80%;">38.77</span></td>
</tr>
<tr id="S2.T1.3.6.5" class="ltx_tr">
<th id="S2.T1.3.6.5.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S2.T1.3.6.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.6.5.2.1" class="ltx_text" style="font-size:80%;">FedProx</span></th>
<td id="S2.T1.3.6.5.3" class="ltx_td ltx_align_center"><span id="S2.T1.3.6.5.3.1" class="ltx_text" style="font-size:80%;">52.75</span></td>
<td id="S2.T1.3.6.5.4" class="ltx_td ltx_align_center"><span id="S2.T1.3.6.5.4.1" class="ltx_text" style="font-size:80%;">55.07</span></td>
<td id="S2.T1.3.6.5.5" class="ltx_td ltx_align_center"><span id="S2.T1.3.6.5.5.1" class="ltx_text" style="font-size:80%;">60.44</span></td>
<td id="S2.T1.3.6.5.6" class="ltx_td ltx_align_center"><span id="S2.T1.3.6.5.6.1" class="ltx_text" style="font-size:80%;">25.43</span></td>
<td id="S2.T1.3.6.5.7" class="ltx_td ltx_align_center"><span id="S2.T1.3.6.5.7.1" class="ltx_text" style="font-size:80%;">27.77</span></td>
<td id="S2.T1.3.6.5.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S2.T1.3.6.5.8.1" class="ltx_text" style="font-size:80%;">38.45</span></td>
</tr>
<tr id="S2.T1.3.7.6" class="ltx_tr">
<th id="S2.T1.3.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.7.6.1.1" class="ltx_text" style="font-size:80%;">FL methods</span></th>
<th id="S2.T1.3.7.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.7.6.2.1" class="ltx_text" style="font-size:80%;">FedNova</span></th>
<td id="S2.T1.3.7.6.3" class="ltx_td ltx_align_center"><span id="S2.T1.3.7.6.3.1" class="ltx_text" style="font-size:80%;">52.93</span></td>
<td id="S2.T1.3.7.6.4" class="ltx_td ltx_align_center"><span id="S2.T1.3.7.6.4.1" class="ltx_text" style="font-size:80%;">56.53</span></td>
<td id="S2.T1.3.7.6.5" class="ltx_td ltx_align_center"><span id="S2.T1.3.7.6.5.1" class="ltx_text" style="font-size:80%;">61.58</span></td>
<td id="S2.T1.3.7.6.6" class="ltx_td ltx_align_center"><span id="S2.T1.3.7.6.6.1" class="ltx_text" style="font-size:80%;">26.81</span></td>
<td id="S2.T1.3.7.6.7" class="ltx_td ltx_align_center"><span id="S2.T1.3.7.6.7.1" class="ltx_text" style="font-size:80%;">28.91</span></td>
<td id="S2.T1.3.7.6.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S2.T1.3.7.6.8.1" class="ltx_text" style="font-size:80%;">39.62</span></td>
</tr>
<tr id="S2.T1.3.8.7" class="ltx_tr">
<th id="S2.T1.3.8.7.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S2.T1.3.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S2.T1.3.8.7.2.1" class="ltx_text" style="font-size:80%;">FedDF</span></th>
<td id="S2.T1.3.8.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.8.7.3.1" class="ltx_text" style="font-size:80%;">50.33</span></td>
<td id="S2.T1.3.8.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.8.7.4.1" class="ltx_text" style="font-size:80%;">52.58</span></td>
<td id="S2.T1.3.8.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.8.7.5.1" class="ltx_text" style="font-size:80%;">58.84</span></td>
<td id="S2.T1.3.8.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.8.7.6.1" class="ltx_text" style="font-size:80%;">25.60</span></td>
<td id="S2.T1.3.8.7.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.8.7.7.1" class="ltx_text" style="font-size:80%;">28.79</span></td>
<td id="S2.T1.3.8.7.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S2.T1.3.8.7.8.1" class="ltx_text" style="font-size:80%;">38.60</span></td>
</tr>
<tr id="S2.T1.3.9.8" class="ltx_tr">
<th id="S2.T1.3.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.9.8.1.1" class="ltx_text" style="font-size:80%;">Distillation-based FL methods</span></th>
<th id="S2.T1.3.9.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.9.8.2.1" class="ltx_text" style="font-size:80%;">FedBE</span></th>
<td id="S2.T1.3.9.8.3" class="ltx_td ltx_align_center"><span id="S2.T1.3.9.8.3.1" class="ltx_text" style="font-size:80%;">44.05</span></td>
<td id="S2.T1.3.9.8.4" class="ltx_td ltx_align_center"><span id="S2.T1.3.9.8.4.1" class="ltx_text" style="font-size:80%;">50.66</span></td>
<td id="S2.T1.3.9.8.5" class="ltx_td ltx_align_center"><span id="S2.T1.3.9.8.5.1" class="ltx_text" style="font-size:80%;">53.53</span></td>
<td id="S2.T1.3.9.8.6" class="ltx_td ltx_align_center"><span id="S2.T1.3.9.8.6.1" class="ltx_text" style="font-size:80%;">22.46</span></td>
<td id="S2.T1.3.9.8.7" class="ltx_td ltx_align_center"><span id="S2.T1.3.9.8.7.1" class="ltx_text" style="font-size:80%;">23.77</span></td>
<td id="S2.T1.3.9.8.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S2.T1.3.9.8.8.1" class="ltx_text" style="font-size:80%;">33.53</span></td>
</tr>
<tr id="S2.T1.3.10.9" class="ltx_tr">
<th id="S2.T1.3.10.9.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S2.T1.3.10.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S2.T1.3.10.9.2.1" class="ltx_text" style="font-size:80%;">Fed-Focal Loss</span></th>
<td id="S2.T1.3.10.9.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.10.9.3.1" class="ltx_text" style="font-size:80%;">49.66</span></td>
<td id="S2.T1.3.10.9.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.10.9.4.1" class="ltx_text" style="font-size:80%;">52.02</span></td>
<td id="S2.T1.3.10.9.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.10.9.5.1" class="ltx_text" style="font-size:80%;">59.68</span></td>
<td id="S2.T1.3.10.9.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.10.9.6.1" class="ltx_text" style="font-size:80%;">24.66</span></td>
<td id="S2.T1.3.10.9.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.3.10.9.7.1" class="ltx_text" style="font-size:80%;">26.04</span></td>
<td id="S2.T1.3.10.9.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S2.T1.3.10.9.8.1" class="ltx_text" style="font-size:80%;">35.54</span></td>
</tr>
<tr id="S2.T1.3.11.10" class="ltx_tr">
<th id="S2.T1.3.11.10.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S2.T1.3.11.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.11.10.2.1" class="ltx_text" style="font-size:80%;">Ratio Loss</span></th>
<td id="S2.T1.3.11.10.3" class="ltx_td ltx_align_center"><span id="S2.T1.3.11.10.3.1" class="ltx_text" style="font-size:80%;">54.15</span></td>
<td id="S2.T1.3.11.10.4" class="ltx_td ltx_align_center"><span id="S2.T1.3.11.10.4.1" class="ltx_text" style="font-size:80%;">57.77</span></td>
<td id="S2.T1.3.11.10.5" class="ltx_td ltx_align_center"><span id="S2.T1.3.11.10.5.1" class="ltx_text" style="font-size:80%;">60.58</span></td>
<td id="S2.T1.3.11.10.6" class="ltx_td ltx_align_center"><span id="S2.T1.3.11.10.6.1" class="ltx_text" style="font-size:80%;">26.72</span></td>
<td id="S2.T1.3.11.10.7" class="ltx_td ltx_align_center"><span id="S2.T1.3.11.10.7.1" class="ltx_text" style="font-size:80%;">28.83</span></td>
<td id="S2.T1.3.11.10.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S2.T1.3.11.10.8.1" class="ltx_text" style="font-size:80%;">38.79</span></td>
</tr>
<tr id="S2.T1.3.12.11" class="ltx_tr">
<th id="S2.T1.3.12.11.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S2.T1.3.12.11.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.12.11.2.1" class="ltx_text" style="font-size:80%;">FedAvg+cRT</span></th>
<td id="S2.T1.3.12.11.3" class="ltx_td ltx_align_center"><span id="S2.T1.3.12.11.3.1" class="ltx_text" style="font-size:80%;">51.74</span></td>
<td id="S2.T1.3.12.11.4" class="ltx_td ltx_align_center"><span id="S2.T1.3.12.11.4.1" class="ltx_text" style="font-size:80%;">55.87</span></td>
<td id="S2.T1.3.12.11.5" class="ltx_td ltx_align_center"><span id="S2.T1.3.12.11.5.1" class="ltx_text" style="font-size:80%;">61.11</span></td>
<td id="S2.T1.3.12.11.6" class="ltx_td ltx_align_center"><span id="S2.T1.3.12.11.6.1" class="ltx_text" style="font-size:80%;">30.73</span></td>
<td id="S2.T1.3.12.11.7" class="ltx_td ltx_align_center"><span id="S2.T1.3.12.11.7.1" class="ltx_text" style="font-size:80%;">31.47</span></td>
<td id="S2.T1.3.12.11.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S2.T1.3.12.11.8.1" class="ltx_text" style="font-size:80%;">39.75</span></td>
</tr>
<tr id="S2.T1.3.1" class="ltx_tr">
<th id="S2.T1.3.1.2" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S2.T1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S2.T1.3.1.1.1" class="ltx_text" style="font-size:80%;">FedAvg+</span><math id="S2.T1.3.1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S2.T1.3.1.1.m1.1a"><mi mathsize="80%" id="S2.T1.3.1.1.m1.1.1" xref="S2.T1.3.1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.T1.3.1.1.m1.1b"><ci id="S2.T1.3.1.1.m1.1.1.cmml" xref="S2.T1.3.1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.1.1.m1.1c">\tau</annotation></semantics></math><span id="S2.T1.3.1.1.2" class="ltx_text" style="font-size:80%;">-norm</span>
</th>
<td id="S2.T1.3.1.3" class="ltx_td ltx_align_center"><span id="S2.T1.3.1.3.1" class="ltx_text" style="font-size:80%;">44.38</span></td>
<td id="S2.T1.3.1.4" class="ltx_td ltx_align_center"><span id="S2.T1.3.1.4.1" class="ltx_text" style="font-size:80%;">45.59</span></td>
<td id="S2.T1.3.1.5" class="ltx_td ltx_align_center"><span id="S2.T1.3.1.5.1" class="ltx_text" style="font-size:80%;">48.29</span></td>
<td id="S2.T1.3.1.6" class="ltx_td ltx_align_center"><span id="S2.T1.3.1.6.1" class="ltx_text" style="font-size:80%;">19.59</span></td>
<td id="S2.T1.3.1.7" class="ltx_td ltx_align_center"><span id="S2.T1.3.1.7.1" class="ltx_text" style="font-size:80%;">22.07</span></td>
<td id="S2.T1.3.1.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S2.T1.3.1.8.1" class="ltx_text" style="font-size:80%;">30.48</span></td>
</tr>
<tr id="S2.T1.3.13.12" class="ltx_tr">
<th id="S2.T1.3.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.13.12.1.1" class="ltx_text" style="font-size:80%;">Imbalance-oriented FL methods</span></th>
<th id="S2.T1.3.13.12.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.T1.3.13.12.2.1" class="ltx_text" style="font-size:80%;">FedAvg+LWS</span></th>
<td id="S2.T1.3.13.12.3" class="ltx_td ltx_align_center"><span id="S2.T1.3.13.12.3.1" class="ltx_text" style="font-size:80%;">44.48</span></td>
<td id="S2.T1.3.13.12.4" class="ltx_td ltx_align_center"><span id="S2.T1.3.13.12.4.1" class="ltx_text" style="font-size:80%;">46.20</span></td>
<td id="S2.T1.3.13.12.5" class="ltx_td ltx_align_center"><span id="S2.T1.3.13.12.5.1" class="ltx_text" style="font-size:80%;">55.17</span></td>
<td id="S2.T1.3.13.12.6" class="ltx_td ltx_align_center"><span id="S2.T1.3.13.12.6.1" class="ltx_text" style="font-size:80%;">20.70</span></td>
<td id="S2.T1.3.13.12.7" class="ltx_td ltx_align_center"><span id="S2.T1.3.13.12.7.1" class="ltx_text" style="font-size:80%;">23.24</span></td>
<td id="S2.T1.3.13.12.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S2.T1.3.13.12.8.1" class="ltx_text" style="font-size:80%;">32.31</span></td>
</tr>
<tr id="S2.T1.3.14.13" class="ltx_tr">
<th id="S2.T1.3.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="background-color:#EFEFEF;"><span id="S2.T1.3.14.13.1.1" class="ltx_text" style="font-size:80%;background-color:#EFEFEF;">Proposed method</span></th>
<th id="S2.T1.3.14.13.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="background-color:#EFEFEF;"><span id="S2.T1.3.14.13.2.1" class="ltx_text" style="font-size:80%;background-color:#EFEFEF;">FEDIC</span></th>
<td id="S2.T1.3.14.13.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="background-color:#EFEFEF;"><span id="S2.T1.3.14.13.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">63.11</span></td>
<td id="S2.T1.3.14.13.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="background-color:#EFEFEF;"><span id="S2.T1.3.14.13.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">63.82</span></td>
<td id="S2.T1.3.14.13.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="background-color:#EFEFEF;"><span id="S2.T1.3.14.13.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">65.50</span></td>
<td id="S2.T1.3.14.13.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="background-color:#EFEFEF;"><span id="S2.T1.3.14.13.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">33.67</span></td>
<td id="S2.T1.3.14.13.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="background-color:#EFEFEF;"><span id="S2.T1.3.14.13.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">34.74</span></td>
<td id="S2.T1.3.14.13.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" style="background-color:#EFEFEF;"><span id="S2.T1.3.14.13.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">41.93</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.5" class="ltx_p"><span id="S2.SS2.p3.5.1" class="ltx_text ltx_font_bold">Ensemble Calibration.</span> Because of training on local data with different distributions, each local model may perform differently on the tail classes. It is reasonable to assign a higher ensemble weight to the local model that performs well on the tail classes to improve the generalization ability of the ensemble model. However, the server has no prior knowledge of which classes are the tail classes and which local model performs well on them.
Therefore, instead of giving each client a static weight (e.g., <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="1/K" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><mn id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">1</mn><mo id="S2.SS2.p3.1.m1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.cmml">/</mo><mi id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"><divide id="S2.SS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1"></divide><cn type="integer" id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2">1</cn><ci id="S2.SS2.p3.1.m1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">1/K</annotation></semantics></math> for the common average ensemble) in the ensemble, we propose the client-wise logit adjustment that searches proper ensemble weights <math id="S2.SS2.p3.2.m2.5" class="ltx_Math" alttext="e_{k},k=1,...,K" display="inline"><semantics id="S2.SS2.p3.2.m2.5a"><mrow id="S2.SS2.p3.2.m2.5.5.2" xref="S2.SS2.p3.2.m2.5.5.3.cmml"><mrow id="S2.SS2.p3.2.m2.4.4.1.1" xref="S2.SS2.p3.2.m2.4.4.1.1.cmml"><mrow id="S2.SS2.p3.2.m2.4.4.1.1.1.1" xref="S2.SS2.p3.2.m2.4.4.1.1.1.2.cmml"><msub id="S2.SS2.p3.2.m2.4.4.1.1.1.1.1" xref="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.2" xref="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.2.cmml">e</mi><mi id="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.3" xref="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS2.p3.2.m2.4.4.1.1.1.1.2" xref="S2.SS2.p3.2.m2.4.4.1.1.1.2.cmml">,</mo><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">k</mi></mrow><mo id="S2.SS2.p3.2.m2.4.4.1.1.2" xref="S2.SS2.p3.2.m2.4.4.1.1.2.cmml">=</mo><mn id="S2.SS2.p3.2.m2.4.4.1.1.3" xref="S2.SS2.p3.2.m2.4.4.1.1.3.cmml">1</mn></mrow><mo id="S2.SS2.p3.2.m2.5.5.2.3" xref="S2.SS2.p3.2.m2.5.5.3a.cmml">,</mo><mrow id="S2.SS2.p3.2.m2.5.5.2.2.2" xref="S2.SS2.p3.2.m2.5.5.2.2.1.cmml"><mi mathvariant="normal" id="S2.SS2.p3.2.m2.2.2" xref="S2.SS2.p3.2.m2.2.2.cmml">…</mi><mo id="S2.SS2.p3.2.m2.5.5.2.2.2.1" xref="S2.SS2.p3.2.m2.5.5.2.2.1.cmml">,</mo><mi id="S2.SS2.p3.2.m2.3.3" xref="S2.SS2.p3.2.m2.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.5b"><apply id="S2.SS2.p3.2.m2.5.5.3.cmml" xref="S2.SS2.p3.2.m2.5.5.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.5.5.3a.cmml" xref="S2.SS2.p3.2.m2.5.5.2.3">formulae-sequence</csymbol><apply id="S2.SS2.p3.2.m2.4.4.1.1.cmml" xref="S2.SS2.p3.2.m2.4.4.1.1"><eq id="S2.SS2.p3.2.m2.4.4.1.1.2.cmml" xref="S2.SS2.p3.2.m2.4.4.1.1.2"></eq><list id="S2.SS2.p3.2.m2.4.4.1.1.1.2.cmml" xref="S2.SS2.p3.2.m2.4.4.1.1.1.1"><apply id="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.cmml" xref="S2.SS2.p3.2.m2.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.2.m2.4.4.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.2">𝑒</ci><ci id="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.2.m2.4.4.1.1.1.1.1.3">𝑘</ci></apply><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝑘</ci></list><cn type="integer" id="S2.SS2.p3.2.m2.4.4.1.1.3.cmml" xref="S2.SS2.p3.2.m2.4.4.1.1.3">1</cn></apply><list id="S2.SS2.p3.2.m2.5.5.2.2.1.cmml" xref="S2.SS2.p3.2.m2.5.5.2.2.2"><ci id="S2.SS2.p3.2.m2.2.2.cmml" xref="S2.SS2.p3.2.m2.2.2">…</ci><ci id="S2.SS2.p3.2.m2.3.3.cmml" xref="S2.SS2.p3.2.m2.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.5c">e_{k},k=1,...,K</annotation></semantics></math> by learnable parameters. Given a sample <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{x}\in\mathcal{D}_{aux}" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><mrow id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml"><mi id="S2.SS2.p3.3.m3.1.1.2" xref="S2.SS2.p3.3.m3.1.1.2.cmml">𝐱</mi><mo id="S2.SS2.p3.3.m3.1.1.1" xref="S2.SS2.p3.3.m3.1.1.1.cmml">∈</mo><msub id="S2.SS2.p3.3.m3.1.1.3" xref="S2.SS2.p3.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.3.m3.1.1.3.2" xref="S2.SS2.p3.3.m3.1.1.3.2.cmml">𝒟</mi><mrow id="S2.SS2.p3.3.m3.1.1.3.3" xref="S2.SS2.p3.3.m3.1.1.3.3.cmml"><mi id="S2.SS2.p3.3.m3.1.1.3.3.2" xref="S2.SS2.p3.3.m3.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.3.m3.1.1.3.3.1" xref="S2.SS2.p3.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p3.3.m3.1.1.3.3.3" xref="S2.SS2.p3.3.m3.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.3.m3.1.1.3.3.1a" xref="S2.SS2.p3.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p3.3.m3.1.1.3.3.4" xref="S2.SS2.p3.3.m3.1.1.3.3.4.cmml">x</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><apply id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1"><in id="S2.SS2.p3.3.m3.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1.1"></in><ci id="S2.SS2.p3.3.m3.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2">𝐱</ci><apply id="S2.SS2.p3.3.m3.1.1.3.cmml" xref="S2.SS2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.3.1.cmml" xref="S2.SS2.p3.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS2.p3.3.m3.1.1.3.2.cmml" xref="S2.SS2.p3.3.m3.1.1.3.2">𝒟</ci><apply id="S2.SS2.p3.3.m3.1.1.3.3.cmml" xref="S2.SS2.p3.3.m3.1.1.3.3"><times id="S2.SS2.p3.3.m3.1.1.3.3.1.cmml" xref="S2.SS2.p3.3.m3.1.1.3.3.1"></times><ci id="S2.SS2.p3.3.m3.1.1.3.3.2.cmml" xref="S2.SS2.p3.3.m3.1.1.3.3.2">𝑎</ci><ci id="S2.SS2.p3.3.m3.1.1.3.3.3.cmml" xref="S2.SS2.p3.3.m3.1.1.3.3.3">𝑢</ci><ci id="S2.SS2.p3.3.m3.1.1.3.3.4.cmml" xref="S2.SS2.p3.3.m3.1.1.3.3.4">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\mathbf{x}\in\mathcal{D}_{aux}</annotation></semantics></math> on the server, we first calculate the logits of local models <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="\phi_{\mathbf{w}_{k}}(\mathbf{x})" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><mrow id="S2.SS2.p3.4.m4.1.2" xref="S2.SS2.p3.4.m4.1.2.cmml"><msub id="S2.SS2.p3.4.m4.1.2.2" xref="S2.SS2.p3.4.m4.1.2.2.cmml"><mi id="S2.SS2.p3.4.m4.1.2.2.2" xref="S2.SS2.p3.4.m4.1.2.2.2.cmml">ϕ</mi><msub id="S2.SS2.p3.4.m4.1.2.2.3" xref="S2.SS2.p3.4.m4.1.2.2.3.cmml"><mi id="S2.SS2.p3.4.m4.1.2.2.3.2" xref="S2.SS2.p3.4.m4.1.2.2.3.2.cmml">𝐰</mi><mi id="S2.SS2.p3.4.m4.1.2.2.3.3" xref="S2.SS2.p3.4.m4.1.2.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.4.m4.1.2.1" xref="S2.SS2.p3.4.m4.1.2.1.cmml">​</mo><mrow id="S2.SS2.p3.4.m4.1.2.3.2" xref="S2.SS2.p3.4.m4.1.2.cmml"><mo stretchy="false" id="S2.SS2.p3.4.m4.1.2.3.2.1" xref="S2.SS2.p3.4.m4.1.2.cmml">(</mo><mi id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p3.4.m4.1.2.3.2.2" xref="S2.SS2.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><apply id="S2.SS2.p3.4.m4.1.2.cmml" xref="S2.SS2.p3.4.m4.1.2"><times id="S2.SS2.p3.4.m4.1.2.1.cmml" xref="S2.SS2.p3.4.m4.1.2.1"></times><apply id="S2.SS2.p3.4.m4.1.2.2.cmml" xref="S2.SS2.p3.4.m4.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m4.1.2.2.1.cmml" xref="S2.SS2.p3.4.m4.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.4.m4.1.2.2.2.cmml" xref="S2.SS2.p3.4.m4.1.2.2.2">italic-ϕ</ci><apply id="S2.SS2.p3.4.m4.1.2.2.3.cmml" xref="S2.SS2.p3.4.m4.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m4.1.2.2.3.1.cmml" xref="S2.SS2.p3.4.m4.1.2.2.3">subscript</csymbol><ci id="S2.SS2.p3.4.m4.1.2.2.3.2.cmml" xref="S2.SS2.p3.4.m4.1.2.2.3.2">𝐰</ci><ci id="S2.SS2.p3.4.m4.1.2.2.3.3.cmml" xref="S2.SS2.p3.4.m4.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">\phi_{\mathbf{w}_{k}}(\mathbf{x})</annotation></semantics></math>. The ensemble weights <math id="S2.SS2.p3.5.m5.1" class="ltx_Math" alttext="e_{k}" display="inline"><semantics id="S2.SS2.p3.5.m5.1a"><msub id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml"><mi id="S2.SS2.p3.5.m5.1.1.2" xref="S2.SS2.p3.5.m5.1.1.2.cmml">e</mi><mi id="S2.SS2.p3.5.m5.1.1.3" xref="S2.SS2.p3.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><apply id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.1.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p3.5.m5.1.1.2.cmml" xref="S2.SS2.p3.5.m5.1.1.2">𝑒</ci><ci id="S2.SS2.p3.5.m5.1.1.3.cmml" xref="S2.SS2.p3.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">e_{k}</annotation></semantics></math> are calculated by a non-linear transform:</p>
<table id="S4.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\displaystyle e_{k}" display="inline"><semantics id="S2.E4.m1.1a"><msub id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">e</mi><mi id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">𝑒</ci><ci id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle e_{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.2" class="ltx_Math" alttext="\displaystyle=\mathrm{sigmoid}\big{(}\mathbf{a}_{e}^{T}\phi_{\mathbf{w}_{k}}(\mathbf{x})+b_{e}\big{)}," display="inline"><semantics id="S2.E4.m2.2a"><mrow id="S2.E4.m2.2.2.1" xref="S2.E4.m2.2.2.1.1.cmml"><mrow id="S2.E4.m2.2.2.1.1" xref="S2.E4.m2.2.2.1.1.cmml"><mi id="S2.E4.m2.2.2.1.1.3" xref="S2.E4.m2.2.2.1.1.3.cmml"></mi><mo id="S2.E4.m2.2.2.1.1.2" xref="S2.E4.m2.2.2.1.1.2.cmml">=</mo><mrow id="S2.E4.m2.2.2.1.1.1" xref="S2.E4.m2.2.2.1.1.1.cmml"><mi id="S2.E4.m2.2.2.1.1.1.3" xref="S2.E4.m2.2.2.1.1.1.3.cmml">sigmoid</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.2.2.1.1.1.2" xref="S2.E4.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m2.2.2.1.1.1.1.1" xref="S2.E4.m2.2.2.1.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S2.E4.m2.2.2.1.1.1.1.1.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m2.2.2.1.1.1.1.1.1" xref="S2.E4.m2.2.2.1.1.1.1.1.1.cmml"><mrow id="S2.E4.m2.2.2.1.1.1.1.1.1.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.cmml"><msubsup id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml">𝐚</mi><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.3.cmml">e</mi><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E4.m2.2.2.1.1.1.1.1.1.2.1" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.2.cmml">ϕ</mi><msub id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.cmml"><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.2.cmml">𝐰</mi><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E4.m2.2.2.1.1.1.1.1.1.2.1a" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.E4.m2.2.2.1.1.1.1.1.1.2.4.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m2.2.2.1.1.1.1.1.1.2.4.2.1" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E4.m2.1.1" xref="S2.E4.m2.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E4.m2.2.2.1.1.1.1.1.1.2.4.2.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m2.2.2.1.1.1.1.1.1.1" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.E4.m2.2.2.1.1.1.1.1.1.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.3.2" xref="S2.E4.m2.2.2.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S2.E4.m2.2.2.1.1.1.1.1.1.3.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.3.3.cmml">e</mi></msub></mrow><mo maxsize="120%" minsize="120%" id="S2.E4.m2.2.2.1.1.1.1.1.3" xref="S2.E4.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m2.2.2.1.2" xref="S2.E4.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.2b"><apply id="S2.E4.m2.2.2.1.1.cmml" xref="S2.E4.m2.2.2.1"><eq id="S2.E4.m2.2.2.1.1.2.cmml" xref="S2.E4.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="S2.E4.m2.2.2.1.1.3.cmml" xref="S2.E4.m2.2.2.1.1.3">absent</csymbol><apply id="S2.E4.m2.2.2.1.1.1.cmml" xref="S2.E4.m2.2.2.1.1.1"><times id="S2.E4.m2.2.2.1.1.1.2.cmml" xref="S2.E4.m2.2.2.1.1.1.2"></times><ci id="S2.E4.m2.2.2.1.1.1.3.cmml" xref="S2.E4.m2.2.2.1.1.1.3">sigmoid</ci><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1"><plus id="S2.E4.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.1"></plus><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2"><times id="S2.E4.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.1"></times><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.2">𝐚</ci><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.2.3">𝑒</ci></apply><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.2.3">𝑇</ci></apply><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.2">italic-ϕ</ci><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.2">𝐰</ci><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.2.3.3.3">𝑘</ci></apply></apply><ci id="S2.E4.m2.1.1.cmml" xref="S2.E4.m2.1.1">𝐱</ci></apply><apply id="S2.E4.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S2.E4.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m2.2.2.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.2c">\displaystyle=\mathrm{sigmoid}\big{(}\mathbf{a}_{e}^{T}\phi_{\mathbf{w}_{k}}(\mathbf{x})+b_{e}\big{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p3.11" class="ltx_p">where <math id="S2.SS2.p3.6.m1.1" class="ltx_Math" alttext="\mathbf{a}_{e}\in\mathbb{R}^{C}" display="inline"><semantics id="S2.SS2.p3.6.m1.1a"><mrow id="S2.SS2.p3.6.m1.1.1" xref="S2.SS2.p3.6.m1.1.1.cmml"><msub id="S2.SS2.p3.6.m1.1.1.2" xref="S2.SS2.p3.6.m1.1.1.2.cmml"><mi id="S2.SS2.p3.6.m1.1.1.2.2" xref="S2.SS2.p3.6.m1.1.1.2.2.cmml">𝐚</mi><mi id="S2.SS2.p3.6.m1.1.1.2.3" xref="S2.SS2.p3.6.m1.1.1.2.3.cmml">e</mi></msub><mo id="S2.SS2.p3.6.m1.1.1.1" xref="S2.SS2.p3.6.m1.1.1.1.cmml">∈</mo><msup id="S2.SS2.p3.6.m1.1.1.3" xref="S2.SS2.p3.6.m1.1.1.3.cmml"><mi id="S2.SS2.p3.6.m1.1.1.3.2" xref="S2.SS2.p3.6.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS2.p3.6.m1.1.1.3.3" xref="S2.SS2.p3.6.m1.1.1.3.3.cmml">C</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m1.1b"><apply id="S2.SS2.p3.6.m1.1.1.cmml" xref="S2.SS2.p3.6.m1.1.1"><in id="S2.SS2.p3.6.m1.1.1.1.cmml" xref="S2.SS2.p3.6.m1.1.1.1"></in><apply id="S2.SS2.p3.6.m1.1.1.2.cmml" xref="S2.SS2.p3.6.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m1.1.1.2.1.cmml" xref="S2.SS2.p3.6.m1.1.1.2">subscript</csymbol><ci id="S2.SS2.p3.6.m1.1.1.2.2.cmml" xref="S2.SS2.p3.6.m1.1.1.2.2">𝐚</ci><ci id="S2.SS2.p3.6.m1.1.1.2.3.cmml" xref="S2.SS2.p3.6.m1.1.1.2.3">𝑒</ci></apply><apply id="S2.SS2.p3.6.m1.1.1.3.cmml" xref="S2.SS2.p3.6.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m1.1.1.3.1.cmml" xref="S2.SS2.p3.6.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p3.6.m1.1.1.3.2.cmml" xref="S2.SS2.p3.6.m1.1.1.3.2">ℝ</ci><ci id="S2.SS2.p3.6.m1.1.1.3.3.cmml" xref="S2.SS2.p3.6.m1.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m1.1c">\mathbf{a}_{e}\in\mathbb{R}^{C}</annotation></semantics></math> and <math id="S2.SS2.p3.7.m2.1" class="ltx_Math" alttext="b_{e}" display="inline"><semantics id="S2.SS2.p3.7.m2.1a"><msub id="S2.SS2.p3.7.m2.1.1" xref="S2.SS2.p3.7.m2.1.1.cmml"><mi id="S2.SS2.p3.7.m2.1.1.2" xref="S2.SS2.p3.7.m2.1.1.2.cmml">b</mi><mi id="S2.SS2.p3.7.m2.1.1.3" xref="S2.SS2.p3.7.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.7.m2.1b"><apply id="S2.SS2.p3.7.m2.1.1.cmml" xref="S2.SS2.p3.7.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.7.m2.1.1.1.cmml" xref="S2.SS2.p3.7.m2.1.1">subscript</csymbol><ci id="S2.SS2.p3.7.m2.1.1.2.cmml" xref="S2.SS2.p3.7.m2.1.1.2">𝑏</ci><ci id="S2.SS2.p3.7.m2.1.1.3.cmml" xref="S2.SS2.p3.7.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.7.m2.1c">b_{e}</annotation></semantics></math> is a learnable parameter. <math id="S2.SS2.p3.8.m3.1" class="ltx_Math" alttext="e_{k}" display="inline"><semantics id="S2.SS2.p3.8.m3.1a"><msub id="S2.SS2.p3.8.m3.1.1" xref="S2.SS2.p3.8.m3.1.1.cmml"><mi id="S2.SS2.p3.8.m3.1.1.2" xref="S2.SS2.p3.8.m3.1.1.2.cmml">e</mi><mi id="S2.SS2.p3.8.m3.1.1.3" xref="S2.SS2.p3.8.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.8.m3.1b"><apply id="S2.SS2.p3.8.m3.1.1.cmml" xref="S2.SS2.p3.8.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.8.m3.1.1.1.cmml" xref="S2.SS2.p3.8.m3.1.1">subscript</csymbol><ci id="S2.SS2.p3.8.m3.1.1.2.cmml" xref="S2.SS2.p3.8.m3.1.1.2">𝑒</ci><ci id="S2.SS2.p3.8.m3.1.1.3.cmml" xref="S2.SS2.p3.8.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.8.m3.1c">e_{k}</annotation></semantics></math> is then normalized to make its sum equal to 1.
Subsequently, the weighted logits of the local model can be computed, as shown in Eq. (<a href="#S2.E1" title="In 2.2 Proposed Method ‣ 2 Proposed method ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
However, if none of the clients handles the tail classes well, the weighted ensemble is still biased towards the head classes. Subsequently, we propose class-wise logit adjustment to further enhance the logit of the tail classes by learnable parameters <math id="S2.SS2.p3.9.m4.2" class="ltx_Math" alttext="\mathbf{a}_{z},\mathbf{b}_{z}\in\mathbb{R}^{C}" display="inline"><semantics id="S2.SS2.p3.9.m4.2a"><mrow id="S2.SS2.p3.9.m4.2.2" xref="S2.SS2.p3.9.m4.2.2.cmml"><mrow id="S2.SS2.p3.9.m4.2.2.2.2" xref="S2.SS2.p3.9.m4.2.2.2.3.cmml"><msub id="S2.SS2.p3.9.m4.1.1.1.1.1" xref="S2.SS2.p3.9.m4.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.9.m4.1.1.1.1.1.2" xref="S2.SS2.p3.9.m4.1.1.1.1.1.2.cmml">𝐚</mi><mi id="S2.SS2.p3.9.m4.1.1.1.1.1.3" xref="S2.SS2.p3.9.m4.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S2.SS2.p3.9.m4.2.2.2.2.3" xref="S2.SS2.p3.9.m4.2.2.2.3.cmml">,</mo><msub id="S2.SS2.p3.9.m4.2.2.2.2.2" xref="S2.SS2.p3.9.m4.2.2.2.2.2.cmml"><mi id="S2.SS2.p3.9.m4.2.2.2.2.2.2" xref="S2.SS2.p3.9.m4.2.2.2.2.2.2.cmml">𝐛</mi><mi id="S2.SS2.p3.9.m4.2.2.2.2.2.3" xref="S2.SS2.p3.9.m4.2.2.2.2.2.3.cmml">z</mi></msub></mrow><mo id="S2.SS2.p3.9.m4.2.2.3" xref="S2.SS2.p3.9.m4.2.2.3.cmml">∈</mo><msup id="S2.SS2.p3.9.m4.2.2.4" xref="S2.SS2.p3.9.m4.2.2.4.cmml"><mi id="S2.SS2.p3.9.m4.2.2.4.2" xref="S2.SS2.p3.9.m4.2.2.4.2.cmml">ℝ</mi><mi id="S2.SS2.p3.9.m4.2.2.4.3" xref="S2.SS2.p3.9.m4.2.2.4.3.cmml">C</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.9.m4.2b"><apply id="S2.SS2.p3.9.m4.2.2.cmml" xref="S2.SS2.p3.9.m4.2.2"><in id="S2.SS2.p3.9.m4.2.2.3.cmml" xref="S2.SS2.p3.9.m4.2.2.3"></in><list id="S2.SS2.p3.9.m4.2.2.2.3.cmml" xref="S2.SS2.p3.9.m4.2.2.2.2"><apply id="S2.SS2.p3.9.m4.1.1.1.1.1.cmml" xref="S2.SS2.p3.9.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.9.m4.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.9.m4.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.9.m4.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.9.m4.1.1.1.1.1.2">𝐚</ci><ci id="S2.SS2.p3.9.m4.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.9.m4.1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.SS2.p3.9.m4.2.2.2.2.2.cmml" xref="S2.SS2.p3.9.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.9.m4.2.2.2.2.2.1.cmml" xref="S2.SS2.p3.9.m4.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.9.m4.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.9.m4.2.2.2.2.2.2">𝐛</ci><ci id="S2.SS2.p3.9.m4.2.2.2.2.2.3.cmml" xref="S2.SS2.p3.9.m4.2.2.2.2.2.3">𝑧</ci></apply></list><apply id="S2.SS2.p3.9.m4.2.2.4.cmml" xref="S2.SS2.p3.9.m4.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p3.9.m4.2.2.4.1.cmml" xref="S2.SS2.p3.9.m4.2.2.4">superscript</csymbol><ci id="S2.SS2.p3.9.m4.2.2.4.2.cmml" xref="S2.SS2.p3.9.m4.2.2.4.2">ℝ</ci><ci id="S2.SS2.p3.9.m4.2.2.4.3.cmml" xref="S2.SS2.p3.9.m4.2.2.4.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.9.m4.2c">\mathbf{a}_{z},\mathbf{b}_{z}\in\mathbb{R}^{C}</annotation></semantics></math>. They linearly transform the original weighted ensemble logits <math id="S2.SS2.p3.10.m5.1" class="ltx_Math" alttext="\phi^{t}(\mathbf{x})" display="inline"><semantics id="S2.SS2.p3.10.m5.1a"><mrow id="S2.SS2.p3.10.m5.1.2" xref="S2.SS2.p3.10.m5.1.2.cmml"><msup id="S2.SS2.p3.10.m5.1.2.2" xref="S2.SS2.p3.10.m5.1.2.2.cmml"><mi id="S2.SS2.p3.10.m5.1.2.2.2" xref="S2.SS2.p3.10.m5.1.2.2.2.cmml">ϕ</mi><mi id="S2.SS2.p3.10.m5.1.2.2.3" xref="S2.SS2.p3.10.m5.1.2.2.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p3.10.m5.1.2.1" xref="S2.SS2.p3.10.m5.1.2.1.cmml">​</mo><mrow id="S2.SS2.p3.10.m5.1.2.3.2" xref="S2.SS2.p3.10.m5.1.2.cmml"><mo stretchy="false" id="S2.SS2.p3.10.m5.1.2.3.2.1" xref="S2.SS2.p3.10.m5.1.2.cmml">(</mo><mi id="S2.SS2.p3.10.m5.1.1" xref="S2.SS2.p3.10.m5.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p3.10.m5.1.2.3.2.2" xref="S2.SS2.p3.10.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.10.m5.1b"><apply id="S2.SS2.p3.10.m5.1.2.cmml" xref="S2.SS2.p3.10.m5.1.2"><times id="S2.SS2.p3.10.m5.1.2.1.cmml" xref="S2.SS2.p3.10.m5.1.2.1"></times><apply id="S2.SS2.p3.10.m5.1.2.2.cmml" xref="S2.SS2.p3.10.m5.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.10.m5.1.2.2.1.cmml" xref="S2.SS2.p3.10.m5.1.2.2">superscript</csymbol><ci id="S2.SS2.p3.10.m5.1.2.2.2.cmml" xref="S2.SS2.p3.10.m5.1.2.2.2">italic-ϕ</ci><ci id="S2.SS2.p3.10.m5.1.2.2.3.cmml" xref="S2.SS2.p3.10.m5.1.2.2.3">𝑡</ci></apply><ci id="S2.SS2.p3.10.m5.1.1.cmml" xref="S2.SS2.p3.10.m5.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.10.m5.1c">\phi^{t}(\mathbf{x})</annotation></semantics></math> to calibrated logits <math id="S2.SS2.p3.11.m6.1" class="ltx_Math" alttext="\mathbf{z}^{cl}" display="inline"><semantics id="S2.SS2.p3.11.m6.1a"><msup id="S2.SS2.p3.11.m6.1.1" xref="S2.SS2.p3.11.m6.1.1.cmml"><mi id="S2.SS2.p3.11.m6.1.1.2" xref="S2.SS2.p3.11.m6.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p3.11.m6.1.1.3" xref="S2.SS2.p3.11.m6.1.1.3.cmml"><mi id="S2.SS2.p3.11.m6.1.1.3.2" xref="S2.SS2.p3.11.m6.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.11.m6.1.1.3.1" xref="S2.SS2.p3.11.m6.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p3.11.m6.1.1.3.3" xref="S2.SS2.p3.11.m6.1.1.3.3.cmml">l</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.11.m6.1b"><apply id="S2.SS2.p3.11.m6.1.1.cmml" xref="S2.SS2.p3.11.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.11.m6.1.1.1.cmml" xref="S2.SS2.p3.11.m6.1.1">superscript</csymbol><ci id="S2.SS2.p3.11.m6.1.1.2.cmml" xref="S2.SS2.p3.11.m6.1.1.2">𝐳</ci><apply id="S2.SS2.p3.11.m6.1.1.3.cmml" xref="S2.SS2.p3.11.m6.1.1.3"><times id="S2.SS2.p3.11.m6.1.1.3.1.cmml" xref="S2.SS2.p3.11.m6.1.1.3.1"></times><ci id="S2.SS2.p3.11.m6.1.1.3.2.cmml" xref="S2.SS2.p3.11.m6.1.1.3.2">𝑐</ci><ci id="S2.SS2.p3.11.m6.1.1.3.3.cmml" xref="S2.SS2.p3.11.m6.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.11.m6.1c">\mathbf{z}^{cl}</annotation></semantics></math> on each class:</p>
<table id="S4.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{z}^{cl}=\mathbf{a}_{z}\odot\phi^{t}(\mathbf{x})+\mathbf{b}_{z}," display="inline"><semantics id="S2.E5.m1.2a"><mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.1.cmml"><mrow id="S2.E5.m1.2.2.1.1" xref="S2.E5.m1.2.2.1.1.cmml"><msup id="S2.E5.m1.2.2.1.1.2" xref="S2.E5.m1.2.2.1.1.2.cmml"><mi id="S2.E5.m1.2.2.1.1.2.2" xref="S2.E5.m1.2.2.1.1.2.2.cmml">𝐳</mi><mrow id="S2.E5.m1.2.2.1.1.2.3" xref="S2.E5.m1.2.2.1.1.2.3.cmml"><mi id="S2.E5.m1.2.2.1.1.2.3.2" xref="S2.E5.m1.2.2.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.2.3.1" xref="S2.E5.m1.2.2.1.1.2.3.1.cmml">​</mo><mi id="S2.E5.m1.2.2.1.1.2.3.3" xref="S2.E5.m1.2.2.1.1.2.3.3.cmml">l</mi></mrow></msup><mo id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E5.m1.2.2.1.1.3" xref="S2.E5.m1.2.2.1.1.3.cmml"><mrow id="S2.E5.m1.2.2.1.1.3.2" xref="S2.E5.m1.2.2.1.1.3.2.cmml"><mrow id="S2.E5.m1.2.2.1.1.3.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.cmml"><msub id="S2.E5.m1.2.2.1.1.3.2.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2.2.2.cmml">𝐚</mi><mi id="S2.E5.m1.2.2.1.1.3.2.2.2.3" xref="S2.E5.m1.2.2.1.1.3.2.2.2.3.cmml">z</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E5.m1.2.2.1.1.3.2.2.1" xref="S2.E5.m1.2.2.1.1.3.2.2.1.cmml">⊙</mo><msup id="S2.E5.m1.2.2.1.1.3.2.2.3" xref="S2.E5.m1.2.2.1.1.3.2.2.3.cmml"><mi id="S2.E5.m1.2.2.1.1.3.2.2.3.2" xref="S2.E5.m1.2.2.1.1.3.2.2.3.2.cmml">ϕ</mi><mi id="S2.E5.m1.2.2.1.1.3.2.2.3.3" xref="S2.E5.m1.2.2.1.1.3.2.2.3.3.cmml">t</mi></msup></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.1.1.3.2.1" xref="S2.E5.m1.2.2.1.1.3.2.1.cmml">​</mo><mrow id="S2.E5.m1.2.2.1.1.3.2.3.2" xref="S2.E5.m1.2.2.1.1.3.2.cmml"><mo stretchy="false" id="S2.E5.m1.2.2.1.1.3.2.3.2.1" xref="S2.E5.m1.2.2.1.1.3.2.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E5.m1.2.2.1.1.3.2.3.2.2" xref="S2.E5.m1.2.2.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.2.2.1.1.3.1" xref="S2.E5.m1.2.2.1.1.3.1.cmml">+</mo><msub id="S2.E5.m1.2.2.1.1.3.3" xref="S2.E5.m1.2.2.1.1.3.3.cmml"><mi id="S2.E5.m1.2.2.1.1.3.3.2" xref="S2.E5.m1.2.2.1.1.3.3.2.cmml">𝐛</mi><mi id="S2.E5.m1.2.2.1.1.3.3.3" xref="S2.E5.m1.2.2.1.1.3.3.3.cmml">z</mi></msub></mrow></mrow><mo id="S2.E5.m1.2.2.1.2" xref="S2.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1"><eq id="S2.E5.m1.2.2.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"></eq><apply id="S2.E5.m1.2.2.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.2.1.cmml" xref="S2.E5.m1.2.2.1.1.2">superscript</csymbol><ci id="S2.E5.m1.2.2.1.1.2.2.cmml" xref="S2.E5.m1.2.2.1.1.2.2">𝐳</ci><apply id="S2.E5.m1.2.2.1.1.2.3.cmml" xref="S2.E5.m1.2.2.1.1.2.3"><times id="S2.E5.m1.2.2.1.1.2.3.1.cmml" xref="S2.E5.m1.2.2.1.1.2.3.1"></times><ci id="S2.E5.m1.2.2.1.1.2.3.2.cmml" xref="S2.E5.m1.2.2.1.1.2.3.2">𝑐</ci><ci id="S2.E5.m1.2.2.1.1.2.3.3.cmml" xref="S2.E5.m1.2.2.1.1.2.3.3">𝑙</ci></apply></apply><apply id="S2.E5.m1.2.2.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3"><plus id="S2.E5.m1.2.2.1.1.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.1"></plus><apply id="S2.E5.m1.2.2.1.1.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2"><times id="S2.E5.m1.2.2.1.1.3.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.1"></times><apply id="S2.E5.m1.2.2.1.1.3.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2"><csymbol cd="latexml" id="S2.E5.m1.2.2.1.1.3.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.1">direct-product</csymbol><apply id="S2.E5.m1.2.2.1.1.3.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2.2">𝐚</ci><ci id="S2.E5.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.2.3">𝑧</ci></apply><apply id="S2.E5.m1.2.2.1.1.3.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.2.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.3">superscript</csymbol><ci id="S2.E5.m1.2.2.1.1.3.2.2.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.3.2">italic-ϕ</ci><ci id="S2.E5.m1.2.2.1.1.3.2.2.3.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2.3.3">𝑡</ci></apply></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝐱</ci></apply><apply id="S2.E5.m1.2.2.1.1.3.3.cmml" xref="S2.E5.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.3">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.3.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.3.2">𝐛</ci><ci id="S2.E5.m1.2.2.1.1.3.3.3.cmml" xref="S2.E5.m1.2.2.1.1.3.3.3">𝑧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\displaystyle\mathbf{z}^{cl}=\mathbf{a}_{z}\odot\phi^{t}(\mathbf{x})+\mathbf{b}_{z},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p3.13" class="ltx_p">where <math id="S2.SS2.p3.12.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S2.SS2.p3.12.m1.1a"><mo id="S2.SS2.p3.12.m1.1.1" xref="S2.SS2.p3.12.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.12.m1.1b"><csymbol cd="latexml" id="S2.SS2.p3.12.m1.1.1.cmml" xref="S2.SS2.p3.12.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.12.m1.1c">\odot</annotation></semantics></math> denotes the Hadamard product. Thus, <math id="S2.SS2.p3.13.m2.1" class="ltx_Math" alttext="\mathbf{z}^{cl}" display="inline"><semantics id="S2.SS2.p3.13.m2.1a"><msup id="S2.SS2.p3.13.m2.1.1" xref="S2.SS2.p3.13.m2.1.1.cmml"><mi id="S2.SS2.p3.13.m2.1.1.2" xref="S2.SS2.p3.13.m2.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p3.13.m2.1.1.3" xref="S2.SS2.p3.13.m2.1.1.3.cmml"><mi id="S2.SS2.p3.13.m2.1.1.3.2" xref="S2.SS2.p3.13.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.13.m2.1.1.3.1" xref="S2.SS2.p3.13.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p3.13.m2.1.1.3.3" xref="S2.SS2.p3.13.m2.1.1.3.3.cmml">l</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.13.m2.1b"><apply id="S2.SS2.p3.13.m2.1.1.cmml" xref="S2.SS2.p3.13.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.13.m2.1.1.1.cmml" xref="S2.SS2.p3.13.m2.1.1">superscript</csymbol><ci id="S2.SS2.p3.13.m2.1.1.2.cmml" xref="S2.SS2.p3.13.m2.1.1.2">𝐳</ci><apply id="S2.SS2.p3.13.m2.1.1.3.cmml" xref="S2.SS2.p3.13.m2.1.1.3"><times id="S2.SS2.p3.13.m2.1.1.3.1.cmml" xref="S2.SS2.p3.13.m2.1.1.3.1"></times><ci id="S2.SS2.p3.13.m2.1.1.3.2.cmml" xref="S2.SS2.p3.13.m2.1.1.3.2">𝑐</ci><ci id="S2.SS2.p3.13.m2.1.1.3.3.cmml" xref="S2.SS2.p3.13.m2.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.13.m2.1c">\mathbf{z}^{cl}</annotation></semantics></math> is the calibrated logits after client-wise and class-wise logit adjustment.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.15" class="ltx_p">However, the effectiveness of the premise of logit adjustment is that the features are well extracted. Simply manipulating the logits may not be sufficient if the feature extractors of local models are severely affected.
Therefore, we propose to update the feature extractor as well to complement logit adjustment. Specifically, we can obtain a model <math id="S2.SS2.p4.1.m1.1" class="ltx_Math" alttext="\widehat{\mathbf{w}}" display="inline"><semantics id="S2.SS2.p4.1.m1.1a"><mover accent="true" id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml"><mi id="S2.SS2.p4.1.m1.1.1.2" xref="S2.SS2.p4.1.m1.1.1.2.cmml">𝐰</mi><mo id="S2.SS2.p4.1.m1.1.1.1" xref="S2.SS2.p4.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><apply id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1"><ci id="S2.SS2.p4.1.m1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1.1">^</ci><ci id="S2.SS2.p4.1.m1.1.1.2.cmml" xref="S2.SS2.p4.1.m1.1.1.2">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">\widehat{\mathbf{w}}</annotation></semantics></math> by fine-tuning the global model on <math id="S2.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S2.SS2.p4.2.m2.1a"><msub id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.2.m2.1.1.2" xref="S2.SS2.p4.2.m2.1.1.2.cmml">𝒟</mi><mrow id="S2.SS2.p4.2.m2.1.1.3" xref="S2.SS2.p4.2.m2.1.1.3.cmml"><mi id="S2.SS2.p4.2.m2.1.1.3.2" xref="S2.SS2.p4.2.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.1.1.3.1" xref="S2.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.2.m2.1.1.3.3" xref="S2.SS2.p4.2.m2.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.1.1.3.1a" xref="S2.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.2.m2.1.1.3.4" xref="S2.SS2.p4.2.m2.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><apply id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p4.2.m2.1.1.2.cmml" xref="S2.SS2.p4.2.m2.1.1.2">𝒟</ci><apply id="S2.SS2.p4.2.m2.1.1.3.cmml" xref="S2.SS2.p4.2.m2.1.1.3"><times id="S2.SS2.p4.2.m2.1.1.3.1.cmml" xref="S2.SS2.p4.2.m2.1.1.3.1"></times><ci id="S2.SS2.p4.2.m2.1.1.3.2.cmml" xref="S2.SS2.p4.2.m2.1.1.3.2">𝑎</ci><ci id="S2.SS2.p4.2.m2.1.1.3.3.cmml" xref="S2.SS2.p4.2.m2.1.1.3.3">𝑢</ci><ci id="S2.SS2.p4.2.m2.1.1.3.4.cmml" xref="S2.SS2.p4.2.m2.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">\mathcal{D}_{aux}</annotation></semantics></math>. Since <math id="S2.SS2.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S2.SS2.p4.3.m3.1a"><msub id="S2.SS2.p4.3.m3.1.1" xref="S2.SS2.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.3.m3.1.1.2" xref="S2.SS2.p4.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S2.SS2.p4.3.m3.1.1.3" xref="S2.SS2.p4.3.m3.1.1.3.cmml"><mi id="S2.SS2.p4.3.m3.1.1.3.2" xref="S2.SS2.p4.3.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.3.m3.1.1.3.1" xref="S2.SS2.p4.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.3.m3.1.1.3.3" xref="S2.SS2.p4.3.m3.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.3.m3.1.1.3.1a" xref="S2.SS2.p4.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.3.m3.1.1.3.4" xref="S2.SS2.p4.3.m3.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m3.1b"><apply id="S2.SS2.p4.3.m3.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p4.3.m3.1.1.2.cmml" xref="S2.SS2.p4.3.m3.1.1.2">𝒟</ci><apply id="S2.SS2.p4.3.m3.1.1.3.cmml" xref="S2.SS2.p4.3.m3.1.1.3"><times id="S2.SS2.p4.3.m3.1.1.3.1.cmml" xref="S2.SS2.p4.3.m3.1.1.3.1"></times><ci id="S2.SS2.p4.3.m3.1.1.3.2.cmml" xref="S2.SS2.p4.3.m3.1.1.3.2">𝑎</ci><ci id="S2.SS2.p4.3.m3.1.1.3.3.cmml" xref="S2.SS2.p4.3.m3.1.1.3.3">𝑢</ci><ci id="S2.SS2.p4.3.m3.1.1.3.4.cmml" xref="S2.SS2.p4.3.m3.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m3.1c">\mathcal{D}_{aux}</annotation></semantics></math> is balanced, <math id="S2.SS2.p4.4.m4.1" class="ltx_Math" alttext="\widehat{\mathbf{w}}" display="inline"><semantics id="S2.SS2.p4.4.m4.1a"><mover accent="true" id="S2.SS2.p4.4.m4.1.1" xref="S2.SS2.p4.4.m4.1.1.cmml"><mi id="S2.SS2.p4.4.m4.1.1.2" xref="S2.SS2.p4.4.m4.1.1.2.cmml">𝐰</mi><mo id="S2.SS2.p4.4.m4.1.1.1" xref="S2.SS2.p4.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.4.m4.1b"><apply id="S2.SS2.p4.4.m4.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1"><ci id="S2.SS2.p4.4.m4.1.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1.1">^</ci><ci id="S2.SS2.p4.4.m4.1.1.2.cmml" xref="S2.SS2.p4.4.m4.1.1.2">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.4.m4.1c">\widehat{\mathbf{w}}</annotation></semantics></math> is adjusted to obtain an unbiased feature extractor. Then, we can obtain the fine-tuned logits <math id="S2.SS2.p4.5.m5.1" class="ltx_Math" alttext="\mathbf{z}^{ft}=\phi_{\widehat{\mathbf{w}}}(\mathbf{x})" display="inline"><semantics id="S2.SS2.p4.5.m5.1a"><mrow id="S2.SS2.p4.5.m5.1.2" xref="S2.SS2.p4.5.m5.1.2.cmml"><msup id="S2.SS2.p4.5.m5.1.2.2" xref="S2.SS2.p4.5.m5.1.2.2.cmml"><mi id="S2.SS2.p4.5.m5.1.2.2.2" xref="S2.SS2.p4.5.m5.1.2.2.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.5.m5.1.2.2.3" xref="S2.SS2.p4.5.m5.1.2.2.3.cmml"><mi id="S2.SS2.p4.5.m5.1.2.2.3.2" xref="S2.SS2.p4.5.m5.1.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.5.m5.1.2.2.3.1" xref="S2.SS2.p4.5.m5.1.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p4.5.m5.1.2.2.3.3" xref="S2.SS2.p4.5.m5.1.2.2.3.3.cmml">t</mi></mrow></msup><mo id="S2.SS2.p4.5.m5.1.2.1" xref="S2.SS2.p4.5.m5.1.2.1.cmml">=</mo><mrow id="S2.SS2.p4.5.m5.1.2.3" xref="S2.SS2.p4.5.m5.1.2.3.cmml"><msub id="S2.SS2.p4.5.m5.1.2.3.2" xref="S2.SS2.p4.5.m5.1.2.3.2.cmml"><mi id="S2.SS2.p4.5.m5.1.2.3.2.2" xref="S2.SS2.p4.5.m5.1.2.3.2.2.cmml">ϕ</mi><mover accent="true" id="S2.SS2.p4.5.m5.1.2.3.2.3" xref="S2.SS2.p4.5.m5.1.2.3.2.3.cmml"><mi id="S2.SS2.p4.5.m5.1.2.3.2.3.2" xref="S2.SS2.p4.5.m5.1.2.3.2.3.2.cmml">𝐰</mi><mo id="S2.SS2.p4.5.m5.1.2.3.2.3.1" xref="S2.SS2.p4.5.m5.1.2.3.2.3.1.cmml">^</mo></mover></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p4.5.m5.1.2.3.1" xref="S2.SS2.p4.5.m5.1.2.3.1.cmml">​</mo><mrow id="S2.SS2.p4.5.m5.1.2.3.3.2" xref="S2.SS2.p4.5.m5.1.2.3.cmml"><mo stretchy="false" id="S2.SS2.p4.5.m5.1.2.3.3.2.1" xref="S2.SS2.p4.5.m5.1.2.3.cmml">(</mo><mi id="S2.SS2.p4.5.m5.1.1" xref="S2.SS2.p4.5.m5.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p4.5.m5.1.2.3.3.2.2" xref="S2.SS2.p4.5.m5.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.5.m5.1b"><apply id="S2.SS2.p4.5.m5.1.2.cmml" xref="S2.SS2.p4.5.m5.1.2"><eq id="S2.SS2.p4.5.m5.1.2.1.cmml" xref="S2.SS2.p4.5.m5.1.2.1"></eq><apply id="S2.SS2.p4.5.m5.1.2.2.cmml" xref="S2.SS2.p4.5.m5.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m5.1.2.2.1.cmml" xref="S2.SS2.p4.5.m5.1.2.2">superscript</csymbol><ci id="S2.SS2.p4.5.m5.1.2.2.2.cmml" xref="S2.SS2.p4.5.m5.1.2.2.2">𝐳</ci><apply id="S2.SS2.p4.5.m5.1.2.2.3.cmml" xref="S2.SS2.p4.5.m5.1.2.2.3"><times id="S2.SS2.p4.5.m5.1.2.2.3.1.cmml" xref="S2.SS2.p4.5.m5.1.2.2.3.1"></times><ci id="S2.SS2.p4.5.m5.1.2.2.3.2.cmml" xref="S2.SS2.p4.5.m5.1.2.2.3.2">𝑓</ci><ci id="S2.SS2.p4.5.m5.1.2.2.3.3.cmml" xref="S2.SS2.p4.5.m5.1.2.2.3.3">𝑡</ci></apply></apply><apply id="S2.SS2.p4.5.m5.1.2.3.cmml" xref="S2.SS2.p4.5.m5.1.2.3"><times id="S2.SS2.p4.5.m5.1.2.3.1.cmml" xref="S2.SS2.p4.5.m5.1.2.3.1"></times><apply id="S2.SS2.p4.5.m5.1.2.3.2.cmml" xref="S2.SS2.p4.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m5.1.2.3.2.1.cmml" xref="S2.SS2.p4.5.m5.1.2.3.2">subscript</csymbol><ci id="S2.SS2.p4.5.m5.1.2.3.2.2.cmml" xref="S2.SS2.p4.5.m5.1.2.3.2.2">italic-ϕ</ci><apply id="S2.SS2.p4.5.m5.1.2.3.2.3.cmml" xref="S2.SS2.p4.5.m5.1.2.3.2.3"><ci id="S2.SS2.p4.5.m5.1.2.3.2.3.1.cmml" xref="S2.SS2.p4.5.m5.1.2.3.2.3.1">^</ci><ci id="S2.SS2.p4.5.m5.1.2.3.2.3.2.cmml" xref="S2.SS2.p4.5.m5.1.2.3.2.3.2">𝐰</ci></apply></apply><ci id="S2.SS2.p4.5.m5.1.1.cmml" xref="S2.SS2.p4.5.m5.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.5.m5.1c">\mathbf{z}^{ft}=\phi_{\widehat{\mathbf{w}}}(\mathbf{x})</annotation></semantics></math> for the input <math id="S2.SS2.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.p4.6.m6.1a"><mi id="S2.SS2.p4.6.m6.1.1" xref="S2.SS2.p4.6.m6.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.6.m6.1b"><ci id="S2.SS2.p4.6.m6.1.1.cmml" xref="S2.SS2.p4.6.m6.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.6.m6.1c">\mathbf{x}</annotation></semantics></math>.
The logits <math id="S2.SS2.p4.7.m7.1" class="ltx_Math" alttext="\mathbf{z}^{cl}" display="inline"><semantics id="S2.SS2.p4.7.m7.1a"><msup id="S2.SS2.p4.7.m7.1.1" xref="S2.SS2.p4.7.m7.1.1.cmml"><mi id="S2.SS2.p4.7.m7.1.1.2" xref="S2.SS2.p4.7.m7.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.7.m7.1.1.3" xref="S2.SS2.p4.7.m7.1.1.3.cmml"><mi id="S2.SS2.p4.7.m7.1.1.3.2" xref="S2.SS2.p4.7.m7.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.7.m7.1.1.3.1" xref="S2.SS2.p4.7.m7.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.7.m7.1.1.3.3" xref="S2.SS2.p4.7.m7.1.1.3.3.cmml">l</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.7.m7.1b"><apply id="S2.SS2.p4.7.m7.1.1.cmml" xref="S2.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.7.m7.1.1.1.cmml" xref="S2.SS2.p4.7.m7.1.1">superscript</csymbol><ci id="S2.SS2.p4.7.m7.1.1.2.cmml" xref="S2.SS2.p4.7.m7.1.1.2">𝐳</ci><apply id="S2.SS2.p4.7.m7.1.1.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3"><times id="S2.SS2.p4.7.m7.1.1.3.1.cmml" xref="S2.SS2.p4.7.m7.1.1.3.1"></times><ci id="S2.SS2.p4.7.m7.1.1.3.2.cmml" xref="S2.SS2.p4.7.m7.1.1.3.2">𝑐</ci><ci id="S2.SS2.p4.7.m7.1.1.3.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.7.m7.1c">\mathbf{z}^{cl}</annotation></semantics></math> and <math id="S2.SS2.p4.8.m8.1" class="ltx_Math" alttext="\mathbf{z}^{ft}" display="inline"><semantics id="S2.SS2.p4.8.m8.1a"><msup id="S2.SS2.p4.8.m8.1.1" xref="S2.SS2.p4.8.m8.1.1.cmml"><mi id="S2.SS2.p4.8.m8.1.1.2" xref="S2.SS2.p4.8.m8.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.8.m8.1.1.3" xref="S2.SS2.p4.8.m8.1.1.3.cmml"><mi id="S2.SS2.p4.8.m8.1.1.3.2" xref="S2.SS2.p4.8.m8.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.8.m8.1.1.3.1" xref="S2.SS2.p4.8.m8.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.8.m8.1.1.3.3" xref="S2.SS2.p4.8.m8.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.8.m8.1b"><apply id="S2.SS2.p4.8.m8.1.1.cmml" xref="S2.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.8.m8.1.1.1.cmml" xref="S2.SS2.p4.8.m8.1.1">superscript</csymbol><ci id="S2.SS2.p4.8.m8.1.1.2.cmml" xref="S2.SS2.p4.8.m8.1.1.2">𝐳</ci><apply id="S2.SS2.p4.8.m8.1.1.3.cmml" xref="S2.SS2.p4.8.m8.1.1.3"><times id="S2.SS2.p4.8.m8.1.1.3.1.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1"></times><ci id="S2.SS2.p4.8.m8.1.1.3.2.cmml" xref="S2.SS2.p4.8.m8.1.1.3.2">𝑓</ci><ci id="S2.SS2.p4.8.m8.1.1.3.3.cmml" xref="S2.SS2.p4.8.m8.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.8.m8.1c">\mathbf{z}^{ft}</annotation></semantics></math> are both adjusted to deal with the long-tail distribution but they are from different perspectives. That is, <math id="S2.SS2.p4.9.m9.1" class="ltx_Math" alttext="\mathbf{z}^{cl}" display="inline"><semantics id="S2.SS2.p4.9.m9.1a"><msup id="S2.SS2.p4.9.m9.1.1" xref="S2.SS2.p4.9.m9.1.1.cmml"><mi id="S2.SS2.p4.9.m9.1.1.2" xref="S2.SS2.p4.9.m9.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.9.m9.1.1.3" xref="S2.SS2.p4.9.m9.1.1.3.cmml"><mi id="S2.SS2.p4.9.m9.1.1.3.2" xref="S2.SS2.p4.9.m9.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.9.m9.1.1.3.1" xref="S2.SS2.p4.9.m9.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.9.m9.1.1.3.3" xref="S2.SS2.p4.9.m9.1.1.3.3.cmml">l</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.9.m9.1b"><apply id="S2.SS2.p4.9.m9.1.1.cmml" xref="S2.SS2.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.9.m9.1.1.1.cmml" xref="S2.SS2.p4.9.m9.1.1">superscript</csymbol><ci id="S2.SS2.p4.9.m9.1.1.2.cmml" xref="S2.SS2.p4.9.m9.1.1.2">𝐳</ci><apply id="S2.SS2.p4.9.m9.1.1.3.cmml" xref="S2.SS2.p4.9.m9.1.1.3"><times id="S2.SS2.p4.9.m9.1.1.3.1.cmml" xref="S2.SS2.p4.9.m9.1.1.3.1"></times><ci id="S2.SS2.p4.9.m9.1.1.3.2.cmml" xref="S2.SS2.p4.9.m9.1.1.3.2">𝑐</ci><ci id="S2.SS2.p4.9.m9.1.1.3.3.cmml" xref="S2.SS2.p4.9.m9.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.9.m9.1c">\mathbf{z}^{cl}</annotation></semantics></math> is produced on the merit of the model ensemble but with fixed feature extractors, while <math id="S2.SS2.p4.10.m10.1" class="ltx_Math" alttext="\mathbf{z}^{ft}" display="inline"><semantics id="S2.SS2.p4.10.m10.1a"><msup id="S2.SS2.p4.10.m10.1.1" xref="S2.SS2.p4.10.m10.1.1.cmml"><mi id="S2.SS2.p4.10.m10.1.1.2" xref="S2.SS2.p4.10.m10.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.10.m10.1.1.3" xref="S2.SS2.p4.10.m10.1.1.3.cmml"><mi id="S2.SS2.p4.10.m10.1.1.3.2" xref="S2.SS2.p4.10.m10.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.10.m10.1.1.3.1" xref="S2.SS2.p4.10.m10.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.10.m10.1.1.3.3" xref="S2.SS2.p4.10.m10.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.10.m10.1b"><apply id="S2.SS2.p4.10.m10.1.1.cmml" xref="S2.SS2.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.10.m10.1.1.1.cmml" xref="S2.SS2.p4.10.m10.1.1">superscript</csymbol><ci id="S2.SS2.p4.10.m10.1.1.2.cmml" xref="S2.SS2.p4.10.m10.1.1.2">𝐳</ci><apply id="S2.SS2.p4.10.m10.1.1.3.cmml" xref="S2.SS2.p4.10.m10.1.1.3"><times id="S2.SS2.p4.10.m10.1.1.3.1.cmml" xref="S2.SS2.p4.10.m10.1.1.3.1"></times><ci id="S2.SS2.p4.10.m10.1.1.3.2.cmml" xref="S2.SS2.p4.10.m10.1.1.3.2">𝑓</ci><ci id="S2.SS2.p4.10.m10.1.1.3.3.cmml" xref="S2.SS2.p4.10.m10.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.10.m10.1c">\mathbf{z}^{ft}</annotation></semantics></math> is based on the single global model, but its feature extractor is fine-tuned on <math id="S2.SS2.p4.11.m11.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S2.SS2.p4.11.m11.1a"><msub id="S2.SS2.p4.11.m11.1.1" xref="S2.SS2.p4.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.11.m11.1.1.2" xref="S2.SS2.p4.11.m11.1.1.2.cmml">𝒟</mi><mrow id="S2.SS2.p4.11.m11.1.1.3" xref="S2.SS2.p4.11.m11.1.1.3.cmml"><mi id="S2.SS2.p4.11.m11.1.1.3.2" xref="S2.SS2.p4.11.m11.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.11.m11.1.1.3.1" xref="S2.SS2.p4.11.m11.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.11.m11.1.1.3.3" xref="S2.SS2.p4.11.m11.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.11.m11.1.1.3.1a" xref="S2.SS2.p4.11.m11.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.11.m11.1.1.3.4" xref="S2.SS2.p4.11.m11.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.11.m11.1b"><apply id="S2.SS2.p4.11.m11.1.1.cmml" xref="S2.SS2.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.11.m11.1.1.1.cmml" xref="S2.SS2.p4.11.m11.1.1">subscript</csymbol><ci id="S2.SS2.p4.11.m11.1.1.2.cmml" xref="S2.SS2.p4.11.m11.1.1.2">𝒟</ci><apply id="S2.SS2.p4.11.m11.1.1.3.cmml" xref="S2.SS2.p4.11.m11.1.1.3"><times id="S2.SS2.p4.11.m11.1.1.3.1.cmml" xref="S2.SS2.p4.11.m11.1.1.3.1"></times><ci id="S2.SS2.p4.11.m11.1.1.3.2.cmml" xref="S2.SS2.p4.11.m11.1.1.3.2">𝑎</ci><ci id="S2.SS2.p4.11.m11.1.1.3.3.cmml" xref="S2.SS2.p4.11.m11.1.1.3.3">𝑢</ci><ci id="S2.SS2.p4.11.m11.1.1.3.4.cmml" xref="S2.SS2.p4.11.m11.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.11.m11.1c">\mathcal{D}_{aux}</annotation></semantics></math>. Inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, we propose a calibration gating network to control the trade-off between <math id="S2.SS2.p4.12.m12.1" class="ltx_Math" alttext="\mathbf{z}^{ft}" display="inline"><semantics id="S2.SS2.p4.12.m12.1a"><msup id="S2.SS2.p4.12.m12.1.1" xref="S2.SS2.p4.12.m12.1.1.cmml"><mi id="S2.SS2.p4.12.m12.1.1.2" xref="S2.SS2.p4.12.m12.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.12.m12.1.1.3" xref="S2.SS2.p4.12.m12.1.1.3.cmml"><mi id="S2.SS2.p4.12.m12.1.1.3.2" xref="S2.SS2.p4.12.m12.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.12.m12.1.1.3.1" xref="S2.SS2.p4.12.m12.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.12.m12.1.1.3.3" xref="S2.SS2.p4.12.m12.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.12.m12.1b"><apply id="S2.SS2.p4.12.m12.1.1.cmml" xref="S2.SS2.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.12.m12.1.1.1.cmml" xref="S2.SS2.p4.12.m12.1.1">superscript</csymbol><ci id="S2.SS2.p4.12.m12.1.1.2.cmml" xref="S2.SS2.p4.12.m12.1.1.2">𝐳</ci><apply id="S2.SS2.p4.12.m12.1.1.3.cmml" xref="S2.SS2.p4.12.m12.1.1.3"><times id="S2.SS2.p4.12.m12.1.1.3.1.cmml" xref="S2.SS2.p4.12.m12.1.1.3.1"></times><ci id="S2.SS2.p4.12.m12.1.1.3.2.cmml" xref="S2.SS2.p4.12.m12.1.1.3.2">𝑓</ci><ci id="S2.SS2.p4.12.m12.1.1.3.3.cmml" xref="S2.SS2.p4.12.m12.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.12.m12.1c">\mathbf{z}^{ft}</annotation></semantics></math> and <math id="S2.SS2.p4.13.m13.1" class="ltx_Math" alttext="\mathbf{z}^{cl}" display="inline"><semantics id="S2.SS2.p4.13.m13.1a"><msup id="S2.SS2.p4.13.m13.1.1" xref="S2.SS2.p4.13.m13.1.1.cmml"><mi id="S2.SS2.p4.13.m13.1.1.2" xref="S2.SS2.p4.13.m13.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.13.m13.1.1.3" xref="S2.SS2.p4.13.m13.1.1.3.cmml"><mi id="S2.SS2.p4.13.m13.1.1.3.2" xref="S2.SS2.p4.13.m13.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.13.m13.1.1.3.1" xref="S2.SS2.p4.13.m13.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.13.m13.1.1.3.3" xref="S2.SS2.p4.13.m13.1.1.3.3.cmml">l</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.13.m13.1b"><apply id="S2.SS2.p4.13.m13.1.1.cmml" xref="S2.SS2.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.13.m13.1.1.1.cmml" xref="S2.SS2.p4.13.m13.1.1">superscript</csymbol><ci id="S2.SS2.p4.13.m13.1.1.2.cmml" xref="S2.SS2.p4.13.m13.1.1.2">𝐳</ci><apply id="S2.SS2.p4.13.m13.1.1.3.cmml" xref="S2.SS2.p4.13.m13.1.1.3"><times id="S2.SS2.p4.13.m13.1.1.3.1.cmml" xref="S2.SS2.p4.13.m13.1.1.3.1"></times><ci id="S2.SS2.p4.13.m13.1.1.3.2.cmml" xref="S2.SS2.p4.13.m13.1.1.3.2">𝑐</ci><ci id="S2.SS2.p4.13.m13.1.1.3.3.cmml" xref="S2.SS2.p4.13.m13.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.13.m13.1c">\mathbf{z}^{cl}</annotation></semantics></math>, in order to effectively integrate the calibrated and fine-tuned logits and make them complement each other. The network takes the feature ensemble as the input through a non-linear layer to output the weight between <math id="S2.SS2.p4.14.m14.1" class="ltx_Math" alttext="\mathbf{z}^{ft}" display="inline"><semantics id="S2.SS2.p4.14.m14.1a"><msup id="S2.SS2.p4.14.m14.1.1" xref="S2.SS2.p4.14.m14.1.1.cmml"><mi id="S2.SS2.p4.14.m14.1.1.2" xref="S2.SS2.p4.14.m14.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.14.m14.1.1.3" xref="S2.SS2.p4.14.m14.1.1.3.cmml"><mi id="S2.SS2.p4.14.m14.1.1.3.2" xref="S2.SS2.p4.14.m14.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.14.m14.1.1.3.1" xref="S2.SS2.p4.14.m14.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.14.m14.1.1.3.3" xref="S2.SS2.p4.14.m14.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.14.m14.1b"><apply id="S2.SS2.p4.14.m14.1.1.cmml" xref="S2.SS2.p4.14.m14.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.14.m14.1.1.1.cmml" xref="S2.SS2.p4.14.m14.1.1">superscript</csymbol><ci id="S2.SS2.p4.14.m14.1.1.2.cmml" xref="S2.SS2.p4.14.m14.1.1.2">𝐳</ci><apply id="S2.SS2.p4.14.m14.1.1.3.cmml" xref="S2.SS2.p4.14.m14.1.1.3"><times id="S2.SS2.p4.14.m14.1.1.3.1.cmml" xref="S2.SS2.p4.14.m14.1.1.3.1"></times><ci id="S2.SS2.p4.14.m14.1.1.3.2.cmml" xref="S2.SS2.p4.14.m14.1.1.3.2">𝑓</ci><ci id="S2.SS2.p4.14.m14.1.1.3.3.cmml" xref="S2.SS2.p4.14.m14.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.14.m14.1c">\mathbf{z}^{ft}</annotation></semantics></math> and <math id="S2.SS2.p4.15.m15.1" class="ltx_Math" alttext="\mathbf{z}^{cl}" display="inline"><semantics id="S2.SS2.p4.15.m15.1a"><msup id="S2.SS2.p4.15.m15.1.1" xref="S2.SS2.p4.15.m15.1.1.cmml"><mi id="S2.SS2.p4.15.m15.1.1.2" xref="S2.SS2.p4.15.m15.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.15.m15.1.1.3" xref="S2.SS2.p4.15.m15.1.1.3.cmml"><mi id="S2.SS2.p4.15.m15.1.1.3.2" xref="S2.SS2.p4.15.m15.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.15.m15.1.1.3.1" xref="S2.SS2.p4.15.m15.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.15.m15.1.1.3.3" xref="S2.SS2.p4.15.m15.1.1.3.3.cmml">l</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.15.m15.1b"><apply id="S2.SS2.p4.15.m15.1.1.cmml" xref="S2.SS2.p4.15.m15.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.15.m15.1.1.1.cmml" xref="S2.SS2.p4.15.m15.1.1">superscript</csymbol><ci id="S2.SS2.p4.15.m15.1.1.2.cmml" xref="S2.SS2.p4.15.m15.1.1.2">𝐳</ci><apply id="S2.SS2.p4.15.m15.1.1.3.cmml" xref="S2.SS2.p4.15.m15.1.1.3"><times id="S2.SS2.p4.15.m15.1.1.3.1.cmml" xref="S2.SS2.p4.15.m15.1.1.3.1"></times><ci id="S2.SS2.p4.15.m15.1.1.3.2.cmml" xref="S2.SS2.p4.15.m15.1.1.3.2">𝑐</ci><ci id="S2.SS2.p4.15.m15.1.1.3.3.cmml" xref="S2.SS2.p4.15.m15.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.15.m15.1c">\mathbf{z}^{cl}</annotation></semantics></math>, such that each sample obtains a different weight according to its own feature. The calibration gating network is formulated as:</p>
<table id="S4.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\displaystyle\sigma=\mathrm{sigmoid}(\mathbf{u}^{T}\mathbf{v})," display="inline"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.3.cmml">σ</mi><mo id="S2.E6.m1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E6.m1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.3.cmml">sigmoid</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E6.m1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐮</mi><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E6.m1.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml">𝐯</mi></mrow><mo stretchy="false" id="S2.E6.m1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><eq id="S2.E6.m1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.2"></eq><ci id="S2.E6.m1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.3">𝜎</ci><apply id="S2.E6.m1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"><times id="S2.E6.m1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.2"></times><ci id="S2.E6.m1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.3">sigmoid</ci><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1"><times id="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.2">𝐮</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3">𝐯</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle\sigma=\mathrm{sigmoid}(\mathbf{u}^{T}\mathbf{v}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p4.19" class="ltx_p">where <math id="S2.SS2.p4.16.m1.2" class="ltx_Math" alttext="\mathbf{v}=\frac{1}{|S|}{\sum_{k\in S}f_{\mathbf{w}_{k}}(\mathbf{x})}" display="inline"><semantics id="S2.SS2.p4.16.m1.2a"><mrow id="S2.SS2.p4.16.m1.2.3" xref="S2.SS2.p4.16.m1.2.3.cmml"><mi id="S2.SS2.p4.16.m1.2.3.2" xref="S2.SS2.p4.16.m1.2.3.2.cmml">𝐯</mi><mo id="S2.SS2.p4.16.m1.2.3.1" xref="S2.SS2.p4.16.m1.2.3.1.cmml">=</mo><mrow id="S2.SS2.p4.16.m1.2.3.3" xref="S2.SS2.p4.16.m1.2.3.3.cmml"><mfrac id="S2.SS2.p4.16.m1.1.1" xref="S2.SS2.p4.16.m1.1.1.cmml"><mn id="S2.SS2.p4.16.m1.1.1.3" xref="S2.SS2.p4.16.m1.1.1.3.cmml">1</mn><mrow id="S2.SS2.p4.16.m1.1.1.1.3" xref="S2.SS2.p4.16.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p4.16.m1.1.1.1.3.1" xref="S2.SS2.p4.16.m1.1.1.1.2.1.cmml">|</mo><mi id="S2.SS2.p4.16.m1.1.1.1.1" xref="S2.SS2.p4.16.m1.1.1.1.1.cmml">S</mi><mo stretchy="false" id="S2.SS2.p4.16.m1.1.1.1.3.2" xref="S2.SS2.p4.16.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.SS2.p4.16.m1.2.3.3.1" xref="S2.SS2.p4.16.m1.2.3.3.1.cmml">​</mo><mrow id="S2.SS2.p4.16.m1.2.3.3.2" xref="S2.SS2.p4.16.m1.2.3.3.2.cmml"><msub id="S2.SS2.p4.16.m1.2.3.3.2.1" xref="S2.SS2.p4.16.m1.2.3.3.2.1.cmml"><mo id="S2.SS2.p4.16.m1.2.3.3.2.1.2" xref="S2.SS2.p4.16.m1.2.3.3.2.1.2.cmml">∑</mo><mrow id="S2.SS2.p4.16.m1.2.3.3.2.1.3" xref="S2.SS2.p4.16.m1.2.3.3.2.1.3.cmml"><mi id="S2.SS2.p4.16.m1.2.3.3.2.1.3.2" xref="S2.SS2.p4.16.m1.2.3.3.2.1.3.2.cmml">k</mi><mo id="S2.SS2.p4.16.m1.2.3.3.2.1.3.1" xref="S2.SS2.p4.16.m1.2.3.3.2.1.3.1.cmml">∈</mo><mi id="S2.SS2.p4.16.m1.2.3.3.2.1.3.3" xref="S2.SS2.p4.16.m1.2.3.3.2.1.3.3.cmml">S</mi></mrow></msub><mrow id="S2.SS2.p4.16.m1.2.3.3.2.2" xref="S2.SS2.p4.16.m1.2.3.3.2.2.cmml"><msub id="S2.SS2.p4.16.m1.2.3.3.2.2.2" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.cmml"><mi id="S2.SS2.p4.16.m1.2.3.3.2.2.2.2" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.2.cmml">f</mi><msub id="S2.SS2.p4.16.m1.2.3.3.2.2.2.3" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.cmml"><mi id="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.2" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.2.cmml">𝐰</mi><mi id="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.3" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p4.16.m1.2.3.3.2.2.1" xref="S2.SS2.p4.16.m1.2.3.3.2.2.1.cmml">​</mo><mrow id="S2.SS2.p4.16.m1.2.3.3.2.2.3.2" xref="S2.SS2.p4.16.m1.2.3.3.2.2.cmml"><mo stretchy="false" id="S2.SS2.p4.16.m1.2.3.3.2.2.3.2.1" xref="S2.SS2.p4.16.m1.2.3.3.2.2.cmml">(</mo><mi id="S2.SS2.p4.16.m1.2.2" xref="S2.SS2.p4.16.m1.2.2.cmml">𝐱</mi><mo stretchy="false" id="S2.SS2.p4.16.m1.2.3.3.2.2.3.2.2" xref="S2.SS2.p4.16.m1.2.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.16.m1.2b"><apply id="S2.SS2.p4.16.m1.2.3.cmml" xref="S2.SS2.p4.16.m1.2.3"><eq id="S2.SS2.p4.16.m1.2.3.1.cmml" xref="S2.SS2.p4.16.m1.2.3.1"></eq><ci id="S2.SS2.p4.16.m1.2.3.2.cmml" xref="S2.SS2.p4.16.m1.2.3.2">𝐯</ci><apply id="S2.SS2.p4.16.m1.2.3.3.cmml" xref="S2.SS2.p4.16.m1.2.3.3"><times id="S2.SS2.p4.16.m1.2.3.3.1.cmml" xref="S2.SS2.p4.16.m1.2.3.3.1"></times><apply id="S2.SS2.p4.16.m1.1.1.cmml" xref="S2.SS2.p4.16.m1.1.1"><divide id="S2.SS2.p4.16.m1.1.1.2.cmml" xref="S2.SS2.p4.16.m1.1.1"></divide><cn type="integer" id="S2.SS2.p4.16.m1.1.1.3.cmml" xref="S2.SS2.p4.16.m1.1.1.3">1</cn><apply id="S2.SS2.p4.16.m1.1.1.1.2.cmml" xref="S2.SS2.p4.16.m1.1.1.1.3"><abs id="S2.SS2.p4.16.m1.1.1.1.2.1.cmml" xref="S2.SS2.p4.16.m1.1.1.1.3.1"></abs><ci id="S2.SS2.p4.16.m1.1.1.1.1.cmml" xref="S2.SS2.p4.16.m1.1.1.1.1">𝑆</ci></apply></apply><apply id="S2.SS2.p4.16.m1.2.3.3.2.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2"><apply id="S2.SS2.p4.16.m1.2.3.3.2.1.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S2.SS2.p4.16.m1.2.3.3.2.1.1.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.1">subscript</csymbol><sum id="S2.SS2.p4.16.m1.2.3.3.2.1.2.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.1.2"></sum><apply id="S2.SS2.p4.16.m1.2.3.3.2.1.3.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.1.3"><in id="S2.SS2.p4.16.m1.2.3.3.2.1.3.1.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.1.3.1"></in><ci id="S2.SS2.p4.16.m1.2.3.3.2.1.3.2.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.1.3.2">𝑘</ci><ci id="S2.SS2.p4.16.m1.2.3.3.2.1.3.3.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.1.3.3">𝑆</ci></apply></apply><apply id="S2.SS2.p4.16.m1.2.3.3.2.2.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2"><times id="S2.SS2.p4.16.m1.2.3.3.2.2.1.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2.1"></times><apply id="S2.SS2.p4.16.m1.2.3.3.2.2.2.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.16.m1.2.3.3.2.2.2.1.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p4.16.m1.2.3.3.2.2.2.2.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.2">𝑓</ci><apply id="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.2">𝐰</ci><ci id="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p4.16.m1.2.3.3.2.2.2.3.3">𝑘</ci></apply></apply><ci id="S2.SS2.p4.16.m1.2.2.cmml" xref="S2.SS2.p4.16.m1.2.2">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.16.m1.2c">\mathbf{v}=\frac{1}{|S|}{\sum_{k\in S}f_{\mathbf{w}_{k}}(\mathbf{x})}</annotation></semantics></math> is the feature ensemble, and <math id="S2.SS2.p4.17.m2.1" class="ltx_Math" alttext="|S|" display="inline"><semantics id="S2.SS2.p4.17.m2.1a"><mrow id="S2.SS2.p4.17.m2.1.2.2" xref="S2.SS2.p4.17.m2.1.2.1.cmml"><mo stretchy="false" id="S2.SS2.p4.17.m2.1.2.2.1" xref="S2.SS2.p4.17.m2.1.2.1.1.cmml">|</mo><mi id="S2.SS2.p4.17.m2.1.1" xref="S2.SS2.p4.17.m2.1.1.cmml">S</mi><mo stretchy="false" id="S2.SS2.p4.17.m2.1.2.2.2" xref="S2.SS2.p4.17.m2.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.17.m2.1b"><apply id="S2.SS2.p4.17.m2.1.2.1.cmml" xref="S2.SS2.p4.17.m2.1.2.2"><abs id="S2.SS2.p4.17.m2.1.2.1.1.cmml" xref="S2.SS2.p4.17.m2.1.2.2.1"></abs><ci id="S2.SS2.p4.17.m2.1.1.cmml" xref="S2.SS2.p4.17.m2.1.1">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.17.m2.1c">|S|</annotation></semantics></math> is the number of selected clients in each round. <math id="S2.SS2.p4.18.m3.1" class="ltx_Math" alttext="\mathbf{u}\in\mathbb{R}^{d}" display="inline"><semantics id="S2.SS2.p4.18.m3.1a"><mrow id="S2.SS2.p4.18.m3.1.1" xref="S2.SS2.p4.18.m3.1.1.cmml"><mi id="S2.SS2.p4.18.m3.1.1.2" xref="S2.SS2.p4.18.m3.1.1.2.cmml">𝐮</mi><mo id="S2.SS2.p4.18.m3.1.1.1" xref="S2.SS2.p4.18.m3.1.1.1.cmml">∈</mo><msup id="S2.SS2.p4.18.m3.1.1.3" xref="S2.SS2.p4.18.m3.1.1.3.cmml"><mi id="S2.SS2.p4.18.m3.1.1.3.2" xref="S2.SS2.p4.18.m3.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS2.p4.18.m3.1.1.3.3" xref="S2.SS2.p4.18.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.18.m3.1b"><apply id="S2.SS2.p4.18.m3.1.1.cmml" xref="S2.SS2.p4.18.m3.1.1"><in id="S2.SS2.p4.18.m3.1.1.1.cmml" xref="S2.SS2.p4.18.m3.1.1.1"></in><ci id="S2.SS2.p4.18.m3.1.1.2.cmml" xref="S2.SS2.p4.18.m3.1.1.2">𝐮</ci><apply id="S2.SS2.p4.18.m3.1.1.3.cmml" xref="S2.SS2.p4.18.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p4.18.m3.1.1.3.1.cmml" xref="S2.SS2.p4.18.m3.1.1.3">superscript</csymbol><ci id="S2.SS2.p4.18.m3.1.1.3.2.cmml" xref="S2.SS2.p4.18.m3.1.1.3.2">ℝ</ci><ci id="S2.SS2.p4.18.m3.1.1.3.3.cmml" xref="S2.SS2.p4.18.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.18.m3.1c">\mathbf{u}\in\mathbb{R}^{d}</annotation></semantics></math> is a learnable parameter.
Thus, the final calibrated logits <math id="S2.SS2.p4.19.m4.1" class="ltx_Math" alttext="\mathbf{z}^{\prime}" display="inline"><semantics id="S2.SS2.p4.19.m4.1a"><msup id="S2.SS2.p4.19.m4.1.1" xref="S2.SS2.p4.19.m4.1.1.cmml"><mi id="S2.SS2.p4.19.m4.1.1.2" xref="S2.SS2.p4.19.m4.1.1.2.cmml">𝐳</mi><mo id="S2.SS2.p4.19.m4.1.1.3" xref="S2.SS2.p4.19.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.19.m4.1b"><apply id="S2.SS2.p4.19.m4.1.1.cmml" xref="S2.SS2.p4.19.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.19.m4.1.1.1.cmml" xref="S2.SS2.p4.19.m4.1.1">superscript</csymbol><ci id="S2.SS2.p4.19.m4.1.1.2.cmml" xref="S2.SS2.p4.19.m4.1.1.2">𝐳</ci><ci id="S2.SS2.p4.19.m4.1.1.3.cmml" xref="S2.SS2.p4.19.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.19.m4.1c">\mathbf{z}^{\prime}</annotation></semantics></math> through the calibration gating network is formulated as:</p>
<table id="S4.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E7.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{z}^{\prime}=\sigma\mathbf{z}^{cl}+\big{(}1-\sigma\big{)}\mathbf{z}^{ft}." display="inline"><semantics id="S2.E7.m1.1a"><mrow id="S2.E7.m1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml"><mrow id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml"><msup id="S2.E7.m1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.1.1.1.1.3.2" xref="S2.E7.m1.1.1.1.1.3.2.cmml">𝐳</mi><mo id="S2.E7.m1.1.1.1.1.3.3" xref="S2.E7.m1.1.1.1.1.3.3.cmml">′</mo></msup><mo id="S2.E7.m1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.cmml"><mrow id="S2.E7.m1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.1.1.1.1.1.3.2" xref="S2.E7.m1.1.1.1.1.1.3.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.1.1.1.1.1.3.1" xref="S2.E7.m1.1.1.1.1.1.3.1.cmml">​</mo><msup id="S2.E7.m1.1.1.1.1.1.3.3" xref="S2.E7.m1.1.1.1.1.1.3.3.cmml"><mi id="S2.E7.m1.1.1.1.1.1.3.3.2" xref="S2.E7.m1.1.1.1.1.1.3.3.2.cmml">𝐳</mi><mrow id="S2.E7.m1.1.1.1.1.1.3.3.3" xref="S2.E7.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E7.m1.1.1.1.1.1.3.3.3.2" xref="S2.E7.m1.1.1.1.1.1.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.1.1.1.1.1.3.3.3.1" xref="S2.E7.m1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E7.m1.1.1.1.1.1.3.3.3.3" xref="S2.E7.m1.1.1.1.1.1.3.3.3.3.cmml">l</mi></mrow></msup></mrow><mo id="S2.E7.m1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E7.m1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S2.E7.m1.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml">σ</mi></mrow><mo maxsize="120%" minsize="120%" id="S2.E7.m1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">​</mo><msup id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mrow id="S2.E7.m1.1.1.1.1.1.1.3.3" xref="S2.E7.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.3.3.2" xref="S2.E7.m1.1.1.1.1.1.1.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.1.1.1.1.1.1.3.3.1" xref="S2.E7.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E7.m1.1.1.1.1.1.1.3.3.3" xref="S2.E7.m1.1.1.1.1.1.1.3.3.3.cmml">t</mi></mrow></msup></mrow></mrow></mrow><mo lspace="0em" id="S2.E7.m1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.1b"><apply id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"><eq id="S2.E7.m1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.2"></eq><apply id="S2.E7.m1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E7.m1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.1.1.3.2">𝐳</ci><ci id="S2.E7.m1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.1.1.3.3">′</ci></apply><apply id="S2.E7.m1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1"><plus id="S2.E7.m1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.2"></plus><apply id="S2.E7.m1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.3"><times id="S2.E7.m1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.1.1.1.3.1"></times><ci id="S2.E7.m1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.1.1.1.3.2">𝜎</ci><apply id="S2.E7.m1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.E7.m1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.E7.m1.1.1.1.1.1.3.3.2">𝐳</ci><apply id="S2.E7.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.E7.m1.1.1.1.1.1.3.3.3"><times id="S2.E7.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E7.m1.1.1.1.1.1.3.3.3.1"></times><ci id="S2.E7.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E7.m1.1.1.1.1.1.3.3.3.2">𝑐</ci><ci id="S2.E7.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E7.m1.1.1.1.1.1.3.3.3.3">𝑙</ci></apply></apply></apply><apply id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1"><times id="S2.E7.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2"></times><apply id="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1"><minus id="S2.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3">𝜎</ci></apply><apply id="S2.E7.m1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.2">𝐳</ci><apply id="S2.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.3"><times id="S2.E7.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E7.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.3.2">𝑓</ci><ci id="S2.E7.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.1c">\displaystyle\mathbf{z}^{\prime}=\sigma\mathbf{z}^{cl}+\big{(}1-\sigma\big{)}\mathbf{z}^{ft}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p4.23" class="ltx_p">The weight <math id="S2.SS2.p4.20.m1.2" class="ltx_Math" alttext="\sigma\in(0,1)" display="inline"><semantics id="S2.SS2.p4.20.m1.2a"><mrow id="S2.SS2.p4.20.m1.2.3" xref="S2.SS2.p4.20.m1.2.3.cmml"><mi id="S2.SS2.p4.20.m1.2.3.2" xref="S2.SS2.p4.20.m1.2.3.2.cmml">σ</mi><mo id="S2.SS2.p4.20.m1.2.3.1" xref="S2.SS2.p4.20.m1.2.3.1.cmml">∈</mo><mrow id="S2.SS2.p4.20.m1.2.3.3.2" xref="S2.SS2.p4.20.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p4.20.m1.2.3.3.2.1" xref="S2.SS2.p4.20.m1.2.3.3.1.cmml">(</mo><mn id="S2.SS2.p4.20.m1.1.1" xref="S2.SS2.p4.20.m1.1.1.cmml">0</mn><mo id="S2.SS2.p4.20.m1.2.3.3.2.2" xref="S2.SS2.p4.20.m1.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p4.20.m1.2.2" xref="S2.SS2.p4.20.m1.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS2.p4.20.m1.2.3.3.2.3" xref="S2.SS2.p4.20.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.20.m1.2b"><apply id="S2.SS2.p4.20.m1.2.3.cmml" xref="S2.SS2.p4.20.m1.2.3"><in id="S2.SS2.p4.20.m1.2.3.1.cmml" xref="S2.SS2.p4.20.m1.2.3.1"></in><ci id="S2.SS2.p4.20.m1.2.3.2.cmml" xref="S2.SS2.p4.20.m1.2.3.2">𝜎</ci><interval closure="open" id="S2.SS2.p4.20.m1.2.3.3.1.cmml" xref="S2.SS2.p4.20.m1.2.3.3.2"><cn type="integer" id="S2.SS2.p4.20.m1.1.1.cmml" xref="S2.SS2.p4.20.m1.1.1">0</cn><cn type="integer" id="S2.SS2.p4.20.m1.2.2.cmml" xref="S2.SS2.p4.20.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.20.m1.2c">\sigma\in(0,1)</annotation></semantics></math> acts as a feature-dependent gate to control the trade-off between <math id="S2.SS2.p4.21.m2.1" class="ltx_Math" alttext="\mathbf{z}^{ft}" display="inline"><semantics id="S2.SS2.p4.21.m2.1a"><msup id="S2.SS2.p4.21.m2.1.1" xref="S2.SS2.p4.21.m2.1.1.cmml"><mi id="S2.SS2.p4.21.m2.1.1.2" xref="S2.SS2.p4.21.m2.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.21.m2.1.1.3" xref="S2.SS2.p4.21.m2.1.1.3.cmml"><mi id="S2.SS2.p4.21.m2.1.1.3.2" xref="S2.SS2.p4.21.m2.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.21.m2.1.1.3.1" xref="S2.SS2.p4.21.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.21.m2.1.1.3.3" xref="S2.SS2.p4.21.m2.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.21.m2.1b"><apply id="S2.SS2.p4.21.m2.1.1.cmml" xref="S2.SS2.p4.21.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.21.m2.1.1.1.cmml" xref="S2.SS2.p4.21.m2.1.1">superscript</csymbol><ci id="S2.SS2.p4.21.m2.1.1.2.cmml" xref="S2.SS2.p4.21.m2.1.1.2">𝐳</ci><apply id="S2.SS2.p4.21.m2.1.1.3.cmml" xref="S2.SS2.p4.21.m2.1.1.3"><times id="S2.SS2.p4.21.m2.1.1.3.1.cmml" xref="S2.SS2.p4.21.m2.1.1.3.1"></times><ci id="S2.SS2.p4.21.m2.1.1.3.2.cmml" xref="S2.SS2.p4.21.m2.1.1.3.2">𝑓</ci><ci id="S2.SS2.p4.21.m2.1.1.3.3.cmml" xref="S2.SS2.p4.21.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.21.m2.1c">\mathbf{z}^{ft}</annotation></semantics></math> and <math id="S2.SS2.p4.22.m3.1" class="ltx_Math" alttext="\mathbf{z}^{cl}" display="inline"><semantics id="S2.SS2.p4.22.m3.1a"><msup id="S2.SS2.p4.22.m3.1.1" xref="S2.SS2.p4.22.m3.1.1.cmml"><mi id="S2.SS2.p4.22.m3.1.1.2" xref="S2.SS2.p4.22.m3.1.1.2.cmml">𝐳</mi><mrow id="S2.SS2.p4.22.m3.1.1.3" xref="S2.SS2.p4.22.m3.1.1.3.cmml"><mi id="S2.SS2.p4.22.m3.1.1.3.2" xref="S2.SS2.p4.22.m3.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.22.m3.1.1.3.1" xref="S2.SS2.p4.22.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p4.22.m3.1.1.3.3" xref="S2.SS2.p4.22.m3.1.1.3.3.cmml">l</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.22.m3.1b"><apply id="S2.SS2.p4.22.m3.1.1.cmml" xref="S2.SS2.p4.22.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.22.m3.1.1.1.cmml" xref="S2.SS2.p4.22.m3.1.1">superscript</csymbol><ci id="S2.SS2.p4.22.m3.1.1.2.cmml" xref="S2.SS2.p4.22.m3.1.1.2">𝐳</ci><apply id="S2.SS2.p4.22.m3.1.1.3.cmml" xref="S2.SS2.p4.22.m3.1.1.3"><times id="S2.SS2.p4.22.m3.1.1.3.1.cmml" xref="S2.SS2.p4.22.m3.1.1.3.1"></times><ci id="S2.SS2.p4.22.m3.1.1.3.2.cmml" xref="S2.SS2.p4.22.m3.1.1.3.2">𝑐</ci><ci id="S2.SS2.p4.22.m3.1.1.3.3.cmml" xref="S2.SS2.p4.22.m3.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.22.m3.1c">\mathbf{z}^{cl}</annotation></semantics></math>. All learnable parameters in the whole process of ensemble calibration are updated by cross-entropy loss on <math id="S2.SS2.p4.23.m4.2" class="ltx_Math" alttext="(\mathbf{x},\mathbf{y})\thicksim\mathcal{D}_{aux}" display="inline"><semantics id="S2.SS2.p4.23.m4.2a"><mrow id="S2.SS2.p4.23.m4.2.3" xref="S2.SS2.p4.23.m4.2.3.cmml"><mrow id="S2.SS2.p4.23.m4.2.3.2.2" xref="S2.SS2.p4.23.m4.2.3.2.1.cmml"><mo stretchy="false" id="S2.SS2.p4.23.m4.2.3.2.2.1" xref="S2.SS2.p4.23.m4.2.3.2.1.cmml">(</mo><mi id="S2.SS2.p4.23.m4.1.1" xref="S2.SS2.p4.23.m4.1.1.cmml">𝐱</mi><mo id="S2.SS2.p4.23.m4.2.3.2.2.2" xref="S2.SS2.p4.23.m4.2.3.2.1.cmml">,</mo><mi id="S2.SS2.p4.23.m4.2.2" xref="S2.SS2.p4.23.m4.2.2.cmml">𝐲</mi><mo stretchy="false" id="S2.SS2.p4.23.m4.2.3.2.2.3" xref="S2.SS2.p4.23.m4.2.3.2.1.cmml">)</mo></mrow><mo id="S2.SS2.p4.23.m4.2.3.1" xref="S2.SS2.p4.23.m4.2.3.1.cmml">∼</mo><msub id="S2.SS2.p4.23.m4.2.3.3" xref="S2.SS2.p4.23.m4.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.23.m4.2.3.3.2" xref="S2.SS2.p4.23.m4.2.3.3.2.cmml">𝒟</mi><mrow id="S2.SS2.p4.23.m4.2.3.3.3" xref="S2.SS2.p4.23.m4.2.3.3.3.cmml"><mi id="S2.SS2.p4.23.m4.2.3.3.3.2" xref="S2.SS2.p4.23.m4.2.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.23.m4.2.3.3.3.1" xref="S2.SS2.p4.23.m4.2.3.3.3.1.cmml">​</mo><mi id="S2.SS2.p4.23.m4.2.3.3.3.3" xref="S2.SS2.p4.23.m4.2.3.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.23.m4.2.3.3.3.1a" xref="S2.SS2.p4.23.m4.2.3.3.3.1.cmml">​</mo><mi id="S2.SS2.p4.23.m4.2.3.3.3.4" xref="S2.SS2.p4.23.m4.2.3.3.3.4.cmml">x</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.23.m4.2b"><apply id="S2.SS2.p4.23.m4.2.3.cmml" xref="S2.SS2.p4.23.m4.2.3"><ci id="S2.SS2.p4.23.m4.2.3.1.cmml" xref="S2.SS2.p4.23.m4.2.3.1">∼</ci><interval closure="open" id="S2.SS2.p4.23.m4.2.3.2.1.cmml" xref="S2.SS2.p4.23.m4.2.3.2.2"><ci id="S2.SS2.p4.23.m4.1.1.cmml" xref="S2.SS2.p4.23.m4.1.1">𝐱</ci><ci id="S2.SS2.p4.23.m4.2.2.cmml" xref="S2.SS2.p4.23.m4.2.2">𝐲</ci></interval><apply id="S2.SS2.p4.23.m4.2.3.3.cmml" xref="S2.SS2.p4.23.m4.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p4.23.m4.2.3.3.1.cmml" xref="S2.SS2.p4.23.m4.2.3.3">subscript</csymbol><ci id="S2.SS2.p4.23.m4.2.3.3.2.cmml" xref="S2.SS2.p4.23.m4.2.3.3.2">𝒟</ci><apply id="S2.SS2.p4.23.m4.2.3.3.3.cmml" xref="S2.SS2.p4.23.m4.2.3.3.3"><times id="S2.SS2.p4.23.m4.2.3.3.3.1.cmml" xref="S2.SS2.p4.23.m4.2.3.3.3.1"></times><ci id="S2.SS2.p4.23.m4.2.3.3.3.2.cmml" xref="S2.SS2.p4.23.m4.2.3.3.3.2">𝑎</ci><ci id="S2.SS2.p4.23.m4.2.3.3.3.3.cmml" xref="S2.SS2.p4.23.m4.2.3.3.3.3">𝑢</ci><ci id="S2.SS2.p4.23.m4.2.3.3.3.4.cmml" xref="S2.SS2.p4.23.m4.2.3.3.3.4">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.23.m4.2c">(\mathbf{x},\mathbf{y})\thicksim\mathcal{D}_{aux}</annotation></semantics></math>:</p>
<table id="S4.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E8.m1.5" class="ltx_Math" alttext="\displaystyle L=-\sum_{j=1}^{C}y_{j}\log\frac{\exp(z_{j}^{\prime})}{\sum_{i=1}^{C}\exp(z^{\prime}_{k})}." display="inline"><semantics id="S2.E8.m1.5a"><mrow id="S2.E8.m1.5.5.1" xref="S2.E8.m1.5.5.1.1.cmml"><mrow id="S2.E8.m1.5.5.1.1" xref="S2.E8.m1.5.5.1.1.cmml"><mi id="S2.E8.m1.5.5.1.1.2" xref="S2.E8.m1.5.5.1.1.2.cmml">L</mi><mo id="S2.E8.m1.5.5.1.1.1" xref="S2.E8.m1.5.5.1.1.1.cmml">=</mo><mrow id="S2.E8.m1.5.5.1.1.3" xref="S2.E8.m1.5.5.1.1.3.cmml"><mo id="S2.E8.m1.5.5.1.1.3a" xref="S2.E8.m1.5.5.1.1.3.cmml">−</mo><mrow id="S2.E8.m1.5.5.1.1.3.2" xref="S2.E8.m1.5.5.1.1.3.2.cmml"><mstyle displaystyle="true" id="S2.E8.m1.5.5.1.1.3.2.1" xref="S2.E8.m1.5.5.1.1.3.2.1.cmml"><munderover id="S2.E8.m1.5.5.1.1.3.2.1a" xref="S2.E8.m1.5.5.1.1.3.2.1.cmml"><mo movablelimits="false" id="S2.E8.m1.5.5.1.1.3.2.1.2.2" xref="S2.E8.m1.5.5.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S2.E8.m1.5.5.1.1.3.2.1.2.3" xref="S2.E8.m1.5.5.1.1.3.2.1.2.3.cmml"><mi id="S2.E8.m1.5.5.1.1.3.2.1.2.3.2" xref="S2.E8.m1.5.5.1.1.3.2.1.2.3.2.cmml">j</mi><mo id="S2.E8.m1.5.5.1.1.3.2.1.2.3.1" xref="S2.E8.m1.5.5.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S2.E8.m1.5.5.1.1.3.2.1.2.3.3" xref="S2.E8.m1.5.5.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E8.m1.5.5.1.1.3.2.1.3" xref="S2.E8.m1.5.5.1.1.3.2.1.3.cmml">C</mi></munderover></mstyle><mrow id="S2.E8.m1.5.5.1.1.3.2.2" xref="S2.E8.m1.5.5.1.1.3.2.2.cmml"><msub id="S2.E8.m1.5.5.1.1.3.2.2.2" xref="S2.E8.m1.5.5.1.1.3.2.2.2.cmml"><mi id="S2.E8.m1.5.5.1.1.3.2.2.2.2" xref="S2.E8.m1.5.5.1.1.3.2.2.2.2.cmml">y</mi><mi id="S2.E8.m1.5.5.1.1.3.2.2.2.3" xref="S2.E8.m1.5.5.1.1.3.2.2.2.3.cmml">j</mi></msub><mo lspace="0.167em" rspace="0em" id="S2.E8.m1.5.5.1.1.3.2.2.1" xref="S2.E8.m1.5.5.1.1.3.2.2.1.cmml">​</mo><mrow id="S2.E8.m1.5.5.1.1.3.2.2.3" xref="S2.E8.m1.5.5.1.1.3.2.2.3.cmml"><mi id="S2.E8.m1.5.5.1.1.3.2.2.3.1" xref="S2.E8.m1.5.5.1.1.3.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E8.m1.5.5.1.1.3.2.2.3a" xref="S2.E8.m1.5.5.1.1.3.2.2.3.cmml">⁡</mo><mstyle displaystyle="true" id="S2.E8.m1.4.4" xref="S2.E8.m1.4.4.cmml"><mfrac id="S2.E8.m1.4.4a" xref="S2.E8.m1.4.4.cmml"><mrow id="S2.E8.m1.2.2.2.2" xref="S2.E8.m1.2.2.2.3.cmml"><mi id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml">exp</mi><mo id="S2.E8.m1.2.2.2.2a" xref="S2.E8.m1.2.2.2.3.cmml">⁡</mo><mrow id="S2.E8.m1.2.2.2.2.1" xref="S2.E8.m1.2.2.2.3.cmml"><mo stretchy="false" id="S2.E8.m1.2.2.2.2.1.2" xref="S2.E8.m1.2.2.2.3.cmml">(</mo><msubsup id="S2.E8.m1.2.2.2.2.1.1" xref="S2.E8.m1.2.2.2.2.1.1.cmml"><mi id="S2.E8.m1.2.2.2.2.1.1.2.2" xref="S2.E8.m1.2.2.2.2.1.1.2.2.cmml">z</mi><mi id="S2.E8.m1.2.2.2.2.1.1.2.3" xref="S2.E8.m1.2.2.2.2.1.1.2.3.cmml">j</mi><mo id="S2.E8.m1.2.2.2.2.1.1.3" xref="S2.E8.m1.2.2.2.2.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S2.E8.m1.2.2.2.2.1.3" xref="S2.E8.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E8.m1.4.4.4" xref="S2.E8.m1.4.4.4.cmml"><msubsup id="S2.E8.m1.4.4.4.3" xref="S2.E8.m1.4.4.4.3.cmml"><mo id="S2.E8.m1.4.4.4.3.2.2" xref="S2.E8.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S2.E8.m1.4.4.4.3.2.3" xref="S2.E8.m1.4.4.4.3.2.3.cmml"><mi id="S2.E8.m1.4.4.4.3.2.3.2" xref="S2.E8.m1.4.4.4.3.2.3.2.cmml">i</mi><mo id="S2.E8.m1.4.4.4.3.2.3.1" xref="S2.E8.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S2.E8.m1.4.4.4.3.2.3.3" xref="S2.E8.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E8.m1.4.4.4.3.3" xref="S2.E8.m1.4.4.4.3.3.cmml">C</mi></msubsup><mrow id="S2.E8.m1.4.4.4.2.1" xref="S2.E8.m1.4.4.4.2.2.cmml"><mi id="S2.E8.m1.3.3.3.1" xref="S2.E8.m1.3.3.3.1.cmml">exp</mi><mo id="S2.E8.m1.4.4.4.2.1a" xref="S2.E8.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S2.E8.m1.4.4.4.2.1.1" xref="S2.E8.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S2.E8.m1.4.4.4.2.1.1.2" xref="S2.E8.m1.4.4.4.2.2.cmml">(</mo><msubsup id="S2.E8.m1.4.4.4.2.1.1.1" xref="S2.E8.m1.4.4.4.2.1.1.1.cmml"><mi id="S2.E8.m1.4.4.4.2.1.1.1.2.2" xref="S2.E8.m1.4.4.4.2.1.1.1.2.2.cmml">z</mi><mi id="S2.E8.m1.4.4.4.2.1.1.1.3" xref="S2.E8.m1.4.4.4.2.1.1.1.3.cmml">k</mi><mo id="S2.E8.m1.4.4.4.2.1.1.1.2.3" xref="S2.E8.m1.4.4.4.2.1.1.1.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S2.E8.m1.4.4.4.2.1.1.3" xref="S2.E8.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E8.m1.5.5.1.2" xref="S2.E8.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.5b"><apply id="S2.E8.m1.5.5.1.1.cmml" xref="S2.E8.m1.5.5.1"><eq id="S2.E8.m1.5.5.1.1.1.cmml" xref="S2.E8.m1.5.5.1.1.1"></eq><ci id="S2.E8.m1.5.5.1.1.2.cmml" xref="S2.E8.m1.5.5.1.1.2">𝐿</ci><apply id="S2.E8.m1.5.5.1.1.3.cmml" xref="S2.E8.m1.5.5.1.1.3"><minus id="S2.E8.m1.5.5.1.1.3.1.cmml" xref="S2.E8.m1.5.5.1.1.3"></minus><apply id="S2.E8.m1.5.5.1.1.3.2.cmml" xref="S2.E8.m1.5.5.1.1.3.2"><apply id="S2.E8.m1.5.5.1.1.3.2.1.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E8.m1.5.5.1.1.3.2.1.1.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1">superscript</csymbol><apply id="S2.E8.m1.5.5.1.1.3.2.1.2.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E8.m1.5.5.1.1.3.2.1.2.1.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1">subscript</csymbol><sum id="S2.E8.m1.5.5.1.1.3.2.1.2.2.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1.2.2"></sum><apply id="S2.E8.m1.5.5.1.1.3.2.1.2.3.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1.2.3"><eq id="S2.E8.m1.5.5.1.1.3.2.1.2.3.1.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1.2.3.1"></eq><ci id="S2.E8.m1.5.5.1.1.3.2.1.2.3.2.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1.2.3.2">𝑗</ci><cn type="integer" id="S2.E8.m1.5.5.1.1.3.2.1.2.3.3.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S2.E8.m1.5.5.1.1.3.2.1.3.cmml" xref="S2.E8.m1.5.5.1.1.3.2.1.3">𝐶</ci></apply><apply id="S2.E8.m1.5.5.1.1.3.2.2.cmml" xref="S2.E8.m1.5.5.1.1.3.2.2"><times id="S2.E8.m1.5.5.1.1.3.2.2.1.cmml" xref="S2.E8.m1.5.5.1.1.3.2.2.1"></times><apply id="S2.E8.m1.5.5.1.1.3.2.2.2.cmml" xref="S2.E8.m1.5.5.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S2.E8.m1.5.5.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E8.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S2.E8.m1.5.5.1.1.3.2.2.2.2">𝑦</ci><ci id="S2.E8.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S2.E8.m1.5.5.1.1.3.2.2.2.3">𝑗</ci></apply><apply id="S2.E8.m1.5.5.1.1.3.2.2.3.cmml" xref="S2.E8.m1.5.5.1.1.3.2.2.3"><log id="S2.E8.m1.5.5.1.1.3.2.2.3.1.cmml" xref="S2.E8.m1.5.5.1.1.3.2.2.3.1"></log><apply id="S2.E8.m1.4.4.cmml" xref="S2.E8.m1.4.4"><divide id="S2.E8.m1.4.4.5.cmml" xref="S2.E8.m1.4.4"></divide><apply id="S2.E8.m1.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.2"><exp id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1"></exp><apply id="S2.E8.m1.2.2.2.2.1.1.cmml" xref="S2.E8.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.1.1.1.cmml" xref="S2.E8.m1.2.2.2.2.1.1">superscript</csymbol><apply id="S2.E8.m1.2.2.2.2.1.1.2.cmml" xref="S2.E8.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E8.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E8.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E8.m1.2.2.2.2.1.1.2.2">𝑧</ci><ci id="S2.E8.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E8.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><ci id="S2.E8.m1.2.2.2.2.1.1.3.cmml" xref="S2.E8.m1.2.2.2.2.1.1.3">′</ci></apply></apply><apply id="S2.E8.m1.4.4.4.cmml" xref="S2.E8.m1.4.4.4"><apply id="S2.E8.m1.4.4.4.3.cmml" xref="S2.E8.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.4.3.1.cmml" xref="S2.E8.m1.4.4.4.3">superscript</csymbol><apply id="S2.E8.m1.4.4.4.3.2.cmml" xref="S2.E8.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.4.3.2.1.cmml" xref="S2.E8.m1.4.4.4.3">subscript</csymbol><sum id="S2.E8.m1.4.4.4.3.2.2.cmml" xref="S2.E8.m1.4.4.4.3.2.2"></sum><apply id="S2.E8.m1.4.4.4.3.2.3.cmml" xref="S2.E8.m1.4.4.4.3.2.3"><eq id="S2.E8.m1.4.4.4.3.2.3.1.cmml" xref="S2.E8.m1.4.4.4.3.2.3.1"></eq><ci id="S2.E8.m1.4.4.4.3.2.3.2.cmml" xref="S2.E8.m1.4.4.4.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E8.m1.4.4.4.3.2.3.3.cmml" xref="S2.E8.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S2.E8.m1.4.4.4.3.3.cmml" xref="S2.E8.m1.4.4.4.3.3">𝐶</ci></apply><apply id="S2.E8.m1.4.4.4.2.2.cmml" xref="S2.E8.m1.4.4.4.2.1"><exp id="S2.E8.m1.3.3.3.1.cmml" xref="S2.E8.m1.3.3.3.1"></exp><apply id="S2.E8.m1.4.4.4.2.1.1.1.cmml" xref="S2.E8.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.4.2.1.1.1.1.cmml" xref="S2.E8.m1.4.4.4.2.1.1.1">subscript</csymbol><apply id="S2.E8.m1.4.4.4.2.1.1.1.2.cmml" xref="S2.E8.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.4.2.1.1.1.2.1.cmml" xref="S2.E8.m1.4.4.4.2.1.1.1">superscript</csymbol><ci id="S2.E8.m1.4.4.4.2.1.1.1.2.2.cmml" xref="S2.E8.m1.4.4.4.2.1.1.1.2.2">𝑧</ci><ci id="S2.E8.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S2.E8.m1.4.4.4.2.1.1.1.2.3">′</ci></apply><ci id="S2.E8.m1.4.4.4.2.1.1.1.3.cmml" xref="S2.E8.m1.4.4.4.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.5c">\displaystyle L=-\sum_{j=1}^{C}y_{j}\log\frac{\exp(z_{j}^{\prime})}{\sum_{i=1}^{C}\exp(z^{\prime}_{k})}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.p5" class="ltx_para ltx_noindent">
<p id="S2.SS2.p5.7" class="ltx_p"><span id="S2.SS2.p5.7.1" class="ltx_text ltx_font_bold">Ensemble Distillation.</span> To better distill unbiased knowledge from the teacher model (i.e., the calibrated ensemble model) to the student model (i.e., the global model), we follow the work of knowledge distillation with two loss components <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>: (1) <math id="S2.SS2.p5.1.m1.1" class="ltx_Math" alttext="L_{CE}" display="inline"><semantics id="S2.SS2.p5.1.m1.1a"><msub id="S2.SS2.p5.1.m1.1.1" xref="S2.SS2.p5.1.m1.1.1.cmml"><mi id="S2.SS2.p5.1.m1.1.1.2" xref="S2.SS2.p5.1.m1.1.1.2.cmml">L</mi><mrow id="S2.SS2.p5.1.m1.1.1.3" xref="S2.SS2.p5.1.m1.1.1.3.cmml"><mi id="S2.SS2.p5.1.m1.1.1.3.2" xref="S2.SS2.p5.1.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.1.m1.1.1.3.1" xref="S2.SS2.p5.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.1.m1.1.1.3.3" xref="S2.SS2.p5.1.m1.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.m1.1b"><apply id="S2.SS2.p5.1.m1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p5.1.m1.1.1.2.cmml" xref="S2.SS2.p5.1.m1.1.1.2">𝐿</ci><apply id="S2.SS2.p5.1.m1.1.1.3.cmml" xref="S2.SS2.p5.1.m1.1.1.3"><times id="S2.SS2.p5.1.m1.1.1.3.1.cmml" xref="S2.SS2.p5.1.m1.1.1.3.1"></times><ci id="S2.SS2.p5.1.m1.1.1.3.2.cmml" xref="S2.SS2.p5.1.m1.1.1.3.2">𝐶</ci><ci id="S2.SS2.p5.1.m1.1.1.3.3.cmml" xref="S2.SS2.p5.1.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.m1.1c">L_{CE}</annotation></semantics></math> is the cross-entropy loss between logits of the student model and the ground truth; (2) <math id="S2.SS2.p5.2.m2.1" class="ltx_Math" alttext="L_{KL}" display="inline"><semantics id="S2.SS2.p5.2.m2.1a"><msub id="S2.SS2.p5.2.m2.1.1" xref="S2.SS2.p5.2.m2.1.1.cmml"><mi id="S2.SS2.p5.2.m2.1.1.2" xref="S2.SS2.p5.2.m2.1.1.2.cmml">L</mi><mrow id="S2.SS2.p5.2.m2.1.1.3" xref="S2.SS2.p5.2.m2.1.1.3.cmml"><mi id="S2.SS2.p5.2.m2.1.1.3.2" xref="S2.SS2.p5.2.m2.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.2.m2.1.1.3.1" xref="S2.SS2.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.2.m2.1.1.3.3" xref="S2.SS2.p5.2.m2.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m2.1b"><apply id="S2.SS2.p5.2.m2.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m2.1.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p5.2.m2.1.1.2.cmml" xref="S2.SS2.p5.2.m2.1.1.2">𝐿</ci><apply id="S2.SS2.p5.2.m2.1.1.3.cmml" xref="S2.SS2.p5.2.m2.1.1.3"><times id="S2.SS2.p5.2.m2.1.1.3.1.cmml" xref="S2.SS2.p5.2.m2.1.1.3.1"></times><ci id="S2.SS2.p5.2.m2.1.1.3.2.cmml" xref="S2.SS2.p5.2.m2.1.1.3.2">𝐾</ci><ci id="S2.SS2.p5.2.m2.1.1.3.3.cmml" xref="S2.SS2.p5.2.m2.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m2.1c">L_{KL}</annotation></semantics></math> is the Kullback-Leibler (KL) divergence of the logits between the teacher model and the student model. We use <math id="S2.SS2.p5.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S2.SS2.p5.3.m3.1a"><msub id="S2.SS2.p5.3.m3.1.1" xref="S2.SS2.p5.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.3.m3.1.1.2" xref="S2.SS2.p5.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S2.SS2.p5.3.m3.1.1.3" xref="S2.SS2.p5.3.m3.1.1.3.cmml"><mi id="S2.SS2.p5.3.m3.1.1.3.2" xref="S2.SS2.p5.3.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.3.m3.1.1.3.1" xref="S2.SS2.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.3.m3.1.1.3.3" xref="S2.SS2.p5.3.m3.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.3.m3.1.1.3.1a" xref="S2.SS2.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.3.m3.1.1.3.4" xref="S2.SS2.p5.3.m3.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.3.m3.1b"><apply id="S2.SS2.p5.3.m3.1.1.cmml" xref="S2.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.3.m3.1.1.1.cmml" xref="S2.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p5.3.m3.1.1.2.cmml" xref="S2.SS2.p5.3.m3.1.1.2">𝒟</ci><apply id="S2.SS2.p5.3.m3.1.1.3.cmml" xref="S2.SS2.p5.3.m3.1.1.3"><times id="S2.SS2.p5.3.m3.1.1.3.1.cmml" xref="S2.SS2.p5.3.m3.1.1.3.1"></times><ci id="S2.SS2.p5.3.m3.1.1.3.2.cmml" xref="S2.SS2.p5.3.m3.1.1.3.2">𝑎</ci><ci id="S2.SS2.p5.3.m3.1.1.3.3.cmml" xref="S2.SS2.p5.3.m3.1.1.3.3">𝑢</ci><ci id="S2.SS2.p5.3.m3.1.1.3.4.cmml" xref="S2.SS2.p5.3.m3.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.3.m3.1c">\mathcal{D}_{aux}</annotation></semantics></math> to calculate <math id="S2.SS2.p5.4.m4.1" class="ltx_Math" alttext="L_{CE}" display="inline"><semantics id="S2.SS2.p5.4.m4.1a"><msub id="S2.SS2.p5.4.m4.1.1" xref="S2.SS2.p5.4.m4.1.1.cmml"><mi id="S2.SS2.p5.4.m4.1.1.2" xref="S2.SS2.p5.4.m4.1.1.2.cmml">L</mi><mrow id="S2.SS2.p5.4.m4.1.1.3" xref="S2.SS2.p5.4.m4.1.1.3.cmml"><mi id="S2.SS2.p5.4.m4.1.1.3.2" xref="S2.SS2.p5.4.m4.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.4.m4.1.1.3.1" xref="S2.SS2.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.4.m4.1.1.3.3" xref="S2.SS2.p5.4.m4.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.4.m4.1b"><apply id="S2.SS2.p5.4.m4.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m4.1.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p5.4.m4.1.1.2.cmml" xref="S2.SS2.p5.4.m4.1.1.2">𝐿</ci><apply id="S2.SS2.p5.4.m4.1.1.3.cmml" xref="S2.SS2.p5.4.m4.1.1.3"><times id="S2.SS2.p5.4.m4.1.1.3.1.cmml" xref="S2.SS2.p5.4.m4.1.1.3.1"></times><ci id="S2.SS2.p5.4.m4.1.1.3.2.cmml" xref="S2.SS2.p5.4.m4.1.1.3.2">𝐶</ci><ci id="S2.SS2.p5.4.m4.1.1.3.3.cmml" xref="S2.SS2.p5.4.m4.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.4.m4.1c">L_{CE}</annotation></semantics></math>, and use another unlabeled dataset <math id="S2.SS2.p5.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{ulb}" display="inline"><semantics id="S2.SS2.p5.5.m5.1a"><msub id="S2.SS2.p5.5.m5.1.1" xref="S2.SS2.p5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.5.m5.1.1.2" xref="S2.SS2.p5.5.m5.1.1.2.cmml">𝒟</mi><mrow id="S2.SS2.p5.5.m5.1.1.3" xref="S2.SS2.p5.5.m5.1.1.3.cmml"><mi id="S2.SS2.p5.5.m5.1.1.3.2" xref="S2.SS2.p5.5.m5.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.5.m5.1.1.3.1" xref="S2.SS2.p5.5.m5.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.5.m5.1.1.3.3" xref="S2.SS2.p5.5.m5.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.5.m5.1.1.3.1a" xref="S2.SS2.p5.5.m5.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.5.m5.1.1.3.4" xref="S2.SS2.p5.5.m5.1.1.3.4.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.5.m5.1b"><apply id="S2.SS2.p5.5.m5.1.1.cmml" xref="S2.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m5.1.1.1.cmml" xref="S2.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p5.5.m5.1.1.2.cmml" xref="S2.SS2.p5.5.m5.1.1.2">𝒟</ci><apply id="S2.SS2.p5.5.m5.1.1.3.cmml" xref="S2.SS2.p5.5.m5.1.1.3"><times id="S2.SS2.p5.5.m5.1.1.3.1.cmml" xref="S2.SS2.p5.5.m5.1.1.3.1"></times><ci id="S2.SS2.p5.5.m5.1.1.3.2.cmml" xref="S2.SS2.p5.5.m5.1.1.3.2">𝑢</ci><ci id="S2.SS2.p5.5.m5.1.1.3.3.cmml" xref="S2.SS2.p5.5.m5.1.1.3.3">𝑙</ci><ci id="S2.SS2.p5.5.m5.1.1.3.4.cmml" xref="S2.SS2.p5.5.m5.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.5.m5.1c">\mathcal{D}_{ulb}</annotation></semantics></math> for <math id="S2.SS2.p5.6.m6.1" class="ltx_Math" alttext="L_{KL}" display="inline"><semantics id="S2.SS2.p5.6.m6.1a"><msub id="S2.SS2.p5.6.m6.1.1" xref="S2.SS2.p5.6.m6.1.1.cmml"><mi id="S2.SS2.p5.6.m6.1.1.2" xref="S2.SS2.p5.6.m6.1.1.2.cmml">L</mi><mrow id="S2.SS2.p5.6.m6.1.1.3" xref="S2.SS2.p5.6.m6.1.1.3.cmml"><mi id="S2.SS2.p5.6.m6.1.1.3.2" xref="S2.SS2.p5.6.m6.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.6.m6.1.1.3.1" xref="S2.SS2.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.6.m6.1.1.3.3" xref="S2.SS2.p5.6.m6.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.6.m6.1b"><apply id="S2.SS2.p5.6.m6.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.6.m6.1.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p5.6.m6.1.1.2.cmml" xref="S2.SS2.p5.6.m6.1.1.2">𝐿</ci><apply id="S2.SS2.p5.6.m6.1.1.3.cmml" xref="S2.SS2.p5.6.m6.1.1.3"><times id="S2.SS2.p5.6.m6.1.1.3.1.cmml" xref="S2.SS2.p5.6.m6.1.1.3.1"></times><ci id="S2.SS2.p5.6.m6.1.1.3.2.cmml" xref="S2.SS2.p5.6.m6.1.1.3.2">𝐾</ci><ci id="S2.SS2.p5.6.m6.1.1.3.3.cmml" xref="S2.SS2.p5.6.m6.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.6.m6.1c">L_{KL}</annotation></semantics></math> to boost the performance of distillation knowledge further. Thus, the loss is constituted by a trade-off hyperparameter <math id="S2.SS2.p5.7.m7.2" class="ltx_Math" alttext="\lambda\in[0,1]" display="inline"><semantics id="S2.SS2.p5.7.m7.2a"><mrow id="S2.SS2.p5.7.m7.2.3" xref="S2.SS2.p5.7.m7.2.3.cmml"><mi id="S2.SS2.p5.7.m7.2.3.2" xref="S2.SS2.p5.7.m7.2.3.2.cmml">λ</mi><mo id="S2.SS2.p5.7.m7.2.3.1" xref="S2.SS2.p5.7.m7.2.3.1.cmml">∈</mo><mrow id="S2.SS2.p5.7.m7.2.3.3.2" xref="S2.SS2.p5.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p5.7.m7.2.3.3.2.1" xref="S2.SS2.p5.7.m7.2.3.3.1.cmml">[</mo><mn id="S2.SS2.p5.7.m7.1.1" xref="S2.SS2.p5.7.m7.1.1.cmml">0</mn><mo id="S2.SS2.p5.7.m7.2.3.3.2.2" xref="S2.SS2.p5.7.m7.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p5.7.m7.2.2" xref="S2.SS2.p5.7.m7.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS2.p5.7.m7.2.3.3.2.3" xref="S2.SS2.p5.7.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.7.m7.2b"><apply id="S2.SS2.p5.7.m7.2.3.cmml" xref="S2.SS2.p5.7.m7.2.3"><in id="S2.SS2.p5.7.m7.2.3.1.cmml" xref="S2.SS2.p5.7.m7.2.3.1"></in><ci id="S2.SS2.p5.7.m7.2.3.2.cmml" xref="S2.SS2.p5.7.m7.2.3.2">𝜆</ci><interval closure="closed" id="S2.SS2.p5.7.m7.2.3.3.1.cmml" xref="S2.SS2.p5.7.m7.2.3.3.2"><cn type="integer" id="S2.SS2.p5.7.m7.1.1.cmml" xref="S2.SS2.p5.7.m7.1.1">0</cn><cn type="integer" id="S2.SS2.p5.7.m7.2.2.cmml" xref="S2.SS2.p5.7.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.7.m7.2c">\lambda\in[0,1]</annotation></semantics></math>:</p>
<table id="S4.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E9.m1.1" class="ltx_Math" alttext="\displaystyle L_{FEDIC}" display="inline"><semantics id="S2.E9.m1.1a"><msub id="S2.E9.m1.1.1" xref="S2.E9.m1.1.1.cmml"><mi id="S2.E9.m1.1.1.2" xref="S2.E9.m1.1.1.2.cmml">L</mi><mrow id="S2.E9.m1.1.1.3" xref="S2.E9.m1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.3.2" xref="S2.E9.m1.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.3.1" xref="S2.E9.m1.1.1.3.1.cmml">​</mo><mi id="S2.E9.m1.1.1.3.3" xref="S2.E9.m1.1.1.3.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.3.1a" xref="S2.E9.m1.1.1.3.1.cmml">​</mo><mi id="S2.E9.m1.1.1.3.4" xref="S2.E9.m1.1.1.3.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.3.1b" xref="S2.E9.m1.1.1.3.1.cmml">​</mo><mi id="S2.E9.m1.1.1.3.5" xref="S2.E9.m1.1.1.3.5.cmml">I</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.3.1c" xref="S2.E9.m1.1.1.3.1.cmml">​</mo><mi id="S2.E9.m1.1.1.3.6" xref="S2.E9.m1.1.1.3.6.cmml">C</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.1.cmml" xref="S2.E9.m1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.cmml" xref="S2.E9.m1.1.1">subscript</csymbol><ci id="S2.E9.m1.1.1.2.cmml" xref="S2.E9.m1.1.1.2">𝐿</ci><apply id="S2.E9.m1.1.1.3.cmml" xref="S2.E9.m1.1.1.3"><times id="S2.E9.m1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.3.1"></times><ci id="S2.E9.m1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.3.2">𝐹</ci><ci id="S2.E9.m1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.3.3">𝐸</ci><ci id="S2.E9.m1.1.1.3.4.cmml" xref="S2.E9.m1.1.1.3.4">𝐷</ci><ci id="S2.E9.m1.1.1.3.5.cmml" xref="S2.E9.m1.1.1.3.5">𝐼</ci><ci id="S2.E9.m1.1.1.3.6.cmml" xref="S2.E9.m1.1.1.3.6">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">\displaystyle L_{FEDIC}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E9.m2.1" class="ltx_Math" alttext="\displaystyle=(1-\lambda)L_{CE}+\lambda L_{KL}." display="inline"><semantics id="S2.E9.m2.1a"><mrow id="S2.E9.m2.1.1.1" xref="S2.E9.m2.1.1.1.1.cmml"><mrow id="S2.E9.m2.1.1.1.1" xref="S2.E9.m2.1.1.1.1.cmml"><mi id="S2.E9.m2.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E9.m2.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E9.m2.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.cmml"><mrow id="S2.E9.m2.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.cmml"><mrow id="S2.E9.m2.1.1.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E9.m2.1.1.1.1.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E9.m2.1.1.1.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E9.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E9.m2.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E9.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="S2.E9.m2.1.1.1.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E9.m2.1.1.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.1.1.2.cmml">​</mo><msub id="S2.E9.m2.1.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.1.3.cmml"><mi id="S2.E9.m2.1.1.1.1.1.1.3.2" xref="S2.E9.m2.1.1.1.1.1.1.3.2.cmml">L</mi><mrow id="S2.E9.m2.1.1.1.1.1.1.3.3" xref="S2.E9.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E9.m2.1.1.1.1.1.1.3.3.2" xref="S2.E9.m2.1.1.1.1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E9.m2.1.1.1.1.1.1.3.3.1" xref="S2.E9.m2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E9.m2.1.1.1.1.1.1.3.3.3" xref="S2.E9.m2.1.1.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub></mrow><mo id="S2.E9.m2.1.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E9.m2.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.3.cmml"><mi id="S2.E9.m2.1.1.1.1.1.3.2" xref="S2.E9.m2.1.1.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S2.E9.m2.1.1.1.1.1.3.1" xref="S2.E9.m2.1.1.1.1.1.3.1.cmml">​</mo><msub id="S2.E9.m2.1.1.1.1.1.3.3" xref="S2.E9.m2.1.1.1.1.1.3.3.cmml"><mi id="S2.E9.m2.1.1.1.1.1.3.3.2" xref="S2.E9.m2.1.1.1.1.1.3.3.2.cmml">L</mi><mrow id="S2.E9.m2.1.1.1.1.1.3.3.3" xref="S2.E9.m2.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E9.m2.1.1.1.1.1.3.3.3.2" xref="S2.E9.m2.1.1.1.1.1.3.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S2.E9.m2.1.1.1.1.1.3.3.3.1" xref="S2.E9.m2.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S2.E9.m2.1.1.1.1.1.3.3.3.3" xref="S2.E9.m2.1.1.1.1.1.3.3.3.3.cmml">L</mi></mrow></msub></mrow></mrow></mrow><mo lspace="0em" id="S2.E9.m2.1.1.1.2" xref="S2.E9.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m2.1b"><apply id="S2.E9.m2.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1"><eq id="S2.E9.m2.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E9.m2.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E9.m2.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1"><plus id="S2.E9.m2.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1.2"></plus><apply id="S2.E9.m2.1.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1"><times id="S2.E9.m2.1.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.2"></times><apply id="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1"><minus id="S2.E9.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.E9.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.3">𝜆</ci></apply><apply id="S2.E9.m2.1.1.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.3.2">𝐿</ci><apply id="S2.E9.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m2.1.1.1.1.1.1.3.3"><times id="S2.E9.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E9.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.3.3.2">𝐶</ci><ci id="S2.E9.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E9.m2.1.1.1.1.1.1.3.3.3">𝐸</ci></apply></apply></apply><apply id="S2.E9.m2.1.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.1.3"><times id="S2.E9.m2.1.1.1.1.1.3.1.cmml" xref="S2.E9.m2.1.1.1.1.1.3.1"></times><ci id="S2.E9.m2.1.1.1.1.1.3.2.cmml" xref="S2.E9.m2.1.1.1.1.1.3.2">𝜆</ci><apply id="S2.E9.m2.1.1.1.1.1.3.3.cmml" xref="S2.E9.m2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.3.3.1.cmml" xref="S2.E9.m2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E9.m2.1.1.1.1.1.3.3.2.cmml" xref="S2.E9.m2.1.1.1.1.1.3.3.2">𝐿</ci><apply id="S2.E9.m2.1.1.1.1.1.3.3.3.cmml" xref="S2.E9.m2.1.1.1.1.1.3.3.3"><times id="S2.E9.m2.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E9.m2.1.1.1.1.1.3.3.3.1"></times><ci id="S2.E9.m2.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E9.m2.1.1.1.1.1.3.3.3.2">𝐾</ci><ci id="S2.E9.m2.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E9.m2.1.1.1.1.1.3.3.3.3">𝐿</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m2.1c">\displaystyle=(1-\lambda)L_{CE}+\lambda L_{KL}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p5.8" class="ltx_p">We set <math id="S2.SS2.p5.8.m1.1" class="ltx_Math" alttext="\lambda=0.5" display="inline"><semantics id="S2.SS2.p5.8.m1.1a"><mrow id="S2.SS2.p5.8.m1.1.1" xref="S2.SS2.p5.8.m1.1.1.cmml"><mi id="S2.SS2.p5.8.m1.1.1.2" xref="S2.SS2.p5.8.m1.1.1.2.cmml">λ</mi><mo id="S2.SS2.p5.8.m1.1.1.1" xref="S2.SS2.p5.8.m1.1.1.1.cmml">=</mo><mn id="S2.SS2.p5.8.m1.1.1.3" xref="S2.SS2.p5.8.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.8.m1.1b"><apply id="S2.SS2.p5.8.m1.1.1.cmml" xref="S2.SS2.p5.8.m1.1.1"><eq id="S2.SS2.p5.8.m1.1.1.1.cmml" xref="S2.SS2.p5.8.m1.1.1.1"></eq><ci id="S2.SS2.p5.8.m1.1.1.2.cmml" xref="S2.SS2.p5.8.m1.1.1.2">𝜆</ci><cn type="float" id="S2.SS2.p5.8.m1.1.1.3.cmml" xref="S2.SS2.p5.8.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.8.m1.1c">\lambda=0.5</annotation></semantics></math> in all experiments.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experiment Setup</h3>

<figure id="S3.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F5.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:134.4pt;"><img src="/html/2205.00172/assets/x3.png" id="S3.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="277" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Fig. 3</span>: </span><span id="S3.F5.1.2.2" class="ltx_text" style="font-size:90%;">The performance of FEDIC with different sizes of auxiliary data on CIFAR-10-LT with IF=100.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F5.4" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:134.4pt;"><img src="/html/2205.00172/assets/x4.png" id="S3.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="277" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.4.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Fig. 4</span>: </span><span id="S3.F5.4.2.1" class="ltx_text" style="font-size:90%;">The performance of FEDIC with different values of <math id="S3.F5.4.2.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.F5.4.2.1.m1.1b"><mi id="S3.F5.4.2.1.m1.1.1" xref="S3.F5.4.2.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.F5.4.2.1.m1.1c"><ci id="S3.F5.4.2.1.m1.1.1.cmml" xref="S3.F5.4.2.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.4.2.1.m1.1d">\lambda</annotation></semantics></math> on CIFAR-10-LT.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F5.5" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:134.4pt;"><img src="/html/2205.00172/assets/x5.png" id="S3.F5.5.g1" class="ltx_graphics ltx_img_landscape" width="461" height="277" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.5.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Fig. 5</span>: </span><span id="S3.F5.5.2.2" class="ltx_text" style="font-size:90%;">The performance of FEDIC with different degrees of non-IIDness on CIFAR-10-LT with IF=100.</span></figcaption>
</figure>
</div>
</div>
</figure>
<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We conduct the experiments on the following datasets:
</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.2" class="ltx_p"><span id="S3.SS1.p2.2.1" class="ltx_text ltx_font_bold">CIFAR-10/100-LT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. We first exclude the auxiliary data <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.3.1a" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.1.1.3.4" xref="S3.SS1.p2.1.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝒟</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><times id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">𝑢</ci><ci id="S3.SS1.p2.1.m1.1.1.3.4.cmml" xref="S3.SS1.p2.1.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{D}_{aux}</annotation></semantics></math> from the training data and then follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> to shape the rest of the data into a long-tail distribution with different imbalance factors (IF), which is calculated by the ratio between the number of samples in the largest class and that in the smallest class. For the unlabeled dataset <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{ulb}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">𝒟</mi><mrow id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.2.m2.1.1.3.1" xref="S3.SS1.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.2.m2.1.1.3.1a" xref="S3.SS1.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.2.m2.1.1.3.4" xref="S3.SS1.p2.2.m2.1.1.3.4.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝒟</ci><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><times id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3.1"></times><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝑢</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">𝑙</ci><ci id="S3.SS1.p2.2.m2.1.1.3.4.cmml" xref="S3.SS1.p2.2.m2.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{D}_{ulb}</annotation></semantics></math>, we use CIFAR-100 for CIFAR-10-LT, and use the downsampled ImageNet (image size 32) for CIFAR-100-LT.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.2" class="ltx_p"><span id="S3.SS1.p3.2.1" class="ltx_text ltx_font_bold">ImageNet-LT</span> is a long-tailed version of ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
It contains 115.8K images from 1,000 categories, with the largest and smallest categories containing 1,280 and 5 images, respectively. We obtain the auxiliary data <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1a" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.1.3.4" xref="S3.SS1.p3.1.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝒟</ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">𝑢</ci><ci id="S3.SS1.p3.1.m1.1.1.3.4.cmml" xref="S3.SS1.p3.1.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathcal{D}_{aux}</annotation></semantics></math> from the balanced evaluation data and we use the oversampled CIFAR100 (image size 224) as <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{ulb}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">𝒟</mi><mrow id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m2.1.1.3.1" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.2.m2.1.1.3.1a" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.2.m2.1.1.3.4" xref="S3.SS1.p3.2.m2.1.1.3.4.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝒟</ci><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><times id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.1"></times><ci id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2">𝑢</ci><ci id="S3.SS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3">𝑙</ci><ci id="S3.SS1.p3.2.m2.1.1.3.4.cmml" xref="S3.SS1.p3.2.m2.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathcal{D}_{ulb}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.5" class="ltx_p">We use ResNet-8 for CIFAR-10-LT and CIFAR-100-LT, and ResNet-50 for ImageNet-LT as the backbone network.
By default, we run 200 global communication rounds, with 20 clients in total and an active user ratio <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="C=40\%" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">C</mi><mo id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml"><mn id="S3.SS1.p4.1.m1.1.1.3.2" xref="S3.SS1.p4.1.m1.1.1.3.2.cmml">40</mn><mo id="S3.SS1.p4.1.m1.1.1.3.1" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><eq id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></eq><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝐶</ci><apply id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3"><csymbol cd="latexml" id="S3.SS1.p4.1.m1.1.1.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S3.SS1.p4.1.m1.1.1.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.3.2">40</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">C=40\%</annotation></semantics></math> in each round. For local training, the batch size is set at 128 with learning rate 0.1 and SGD as the optimizer. For server training, we set the calibration steps <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">I</annotation></semantics></math> at 100, the distillation steps <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="J" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">J</annotation></semantics></math> at 100, and Adam with a learning rate <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><mn id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><cn type="float" id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">0.001</annotation></semantics></math> is used for knowledge distillation.
Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, we use Dirichlet distribution to generate the non-IID data partition among clients with the concentration parameter <math id="S3.SS1.p4.5.m5.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S3.SS1.p4.5.m5.1a"><mrow id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml"><mi id="S3.SS1.p4.5.m5.1.1.2" xref="S3.SS1.p4.5.m5.1.1.2.cmml">α</mi><mo id="S3.SS1.p4.5.m5.1.1.1" xref="S3.SS1.p4.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS1.p4.5.m5.1.1.3" xref="S3.SS1.p4.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><apply id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1"><eq id="S3.SS1.p4.5.m5.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1"></eq><ci id="S3.SS1.p4.5.m5.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2">𝛼</ci><cn type="float" id="S3.SS1.p4.5.m5.1.1.3.cmml" xref="S3.SS1.p4.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">\alpha=0.1</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Comparison with the State-of-the-art Methods</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">To verify the effectiveness of FEDIC, we compare the proposed method with the following federated learning (FL) methods: FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, FedAvgM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and distillation-based FL methods, including FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and FedBE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. All of them aim at producing a good global model on non-IID data. Moreover, we also compare the imbalance-oriented FL methods: Fed-Focal Loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, Ratio Loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, and FedAvg with post-hoc methods like cRT , <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\tau</annotation></semantics></math>-norm and LWS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">Results on CIFAR-10/100-LT.</span> The results are summarized in Table <a href="#S2.T1" title="Table 1 ‣ 2.2 Proposed Method ‣ 2 Proposed method ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. FEDIC achieves the highest test accuracy on both datasets with different IFs. Compared with the baseline FedAvg, the performance gain of FEDIC is the highest when IF=100 (around 11% for CIFAR-10-LT and 7.8% for CIFAR-100-LT). It shows the generalization ability of FEDIC when the universal class distribution is highly long-tailed. FedAvgM, FedProx and FedNova perform similarly to FedAvg because they only deal with data non-IIDness without taking global imbalanced class distribution into account. For the distillation-based methods, FedDF and FedBE perform even worse than FedAvg. A plausible reason is that their effectiveness is based on the power of the ensemble model as the teacher model to transfer knowledge. However, the ensemble model may perform even worse than the global model on the tail classes leading to a worse distilled model due to the global imbalanced distribution. This observation also validates the necessity of ensemble calibration in FEDIC. For the imbalance-oriented FL methods, some of them (e.g., Ratio Loss) perform well in some cases compared with FedAvg. However, there is still a performance gap compared with FEDIC because they only alleviate the imbalance problem on the server but ignore the data non-IID problem.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S3.T2.7.2.1" class="ltx_text ltx_font_bold" style="font-size:113%;">Table 2</span>: </span><span id="S3.T2.2.1" class="ltx_text" style="font-size:113%;">Top-1 test accuracy (<math id="S3.T2.2.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S3.T2.2.1.m1.1b"><mo id="S3.T2.2.1.m1.1.1" xref="S3.T2.2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.1.m1.1c"><csymbol cd="latexml" id="S3.T2.2.1.m1.1.1.cmml" xref="S3.T2.2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.1.m1.1d">\%</annotation></semantics></math>) for FEDIC and compared FL methods on ImageNet-LT.</span></figcaption>
<table id="S3.T2.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.8.1.1" class="ltx_tr">
<th id="S3.T2.8.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T2.8.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="4"><span id="S3.T2.8.1.1.2.1" class="ltx_text" style="font-size:80%;">ImageNet-LT</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.8.2.1" class="ltx_tr">
<th id="S3.T2.8.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Method</span></th>
<th id="S3.T2.8.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.8.2.1.2.1" class="ltx_text" style="font-size:80%;">All</span></th>
<td id="S3.T2.8.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.2.1.3.1" class="ltx_text" style="font-size:80%;">Many</span></td>
<td id="S3.T2.8.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.2.1.4.1" class="ltx_text" style="font-size:80%;">Medium</span></td>
<td id="S3.T2.8.2.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S3.T2.8.2.1.5.1" class="ltx_text" style="font-size:80%;">Few</span></td>
</tr>
<tr id="S3.T2.8.3.2" class="ltx_tr">
<th id="S3.T2.8.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.8.3.2.1.1" class="ltx_text" style="font-size:80%;">FedAvg</span></th>
<th id="S3.T2.8.3.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.8.3.2.2.1" class="ltx_text" style="font-size:80%;">23.85</span></th>
<td id="S3.T2.8.3.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.3.2.3.1" class="ltx_text" style="font-size:80%;">34.92</span></td>
<td id="S3.T2.8.3.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.3.2.4.1" class="ltx_text" style="font-size:80%;">19.18</span></td>
<td id="S3.T2.8.3.2.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S3.T2.8.3.2.5.1" class="ltx_text" style="font-size:80%;">7.41</span></td>
</tr>
<tr id="S3.T2.8.4.3" class="ltx_tr">
<th id="S3.T2.8.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.4.3.1.1" class="ltx_text" style="font-size:80%;">FedAvgM</span></th>
<th id="S3.T2.8.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.4.3.2.1" class="ltx_text" style="font-size:80%;">22.57</span></th>
<td id="S3.T2.8.4.3.3" class="ltx_td ltx_align_center"><span id="S3.T2.8.4.3.3.1" class="ltx_text" style="font-size:80%;">33.93</span></td>
<td id="S3.T2.8.4.3.4" class="ltx_td ltx_align_center"><span id="S3.T2.8.4.3.4.1" class="ltx_text" style="font-size:80%;">18.55</span></td>
<td id="S3.T2.8.4.3.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T2.8.4.3.5.1" class="ltx_text" style="font-size:80%;">6.73</span></td>
</tr>
<tr id="S3.T2.8.5.4" class="ltx_tr">
<th id="S3.T2.8.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.5.4.1.1" class="ltx_text" style="font-size:80%;">FedProx</span></th>
<th id="S3.T2.8.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.5.4.2.1" class="ltx_text" style="font-size:80%;">22.99</span></th>
<td id="S3.T2.8.5.4.3" class="ltx_td ltx_align_center"><span id="S3.T2.8.5.4.3.1" class="ltx_text" style="font-size:80%;">34.25</span></td>
<td id="S3.T2.8.5.4.4" class="ltx_td ltx_align_center"><span id="S3.T2.8.5.4.4.1" class="ltx_text" style="font-size:80%;">17.06</span></td>
<td id="S3.T2.8.5.4.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T2.8.5.4.5.1" class="ltx_text" style="font-size:80%;">6.37</span></td>
</tr>
<tr id="S3.T2.8.6.5" class="ltx_tr">
<th id="S3.T2.8.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.8.6.5.1.1" class="ltx_text" style="font-size:80%;">FedDF</span></th>
<th id="S3.T2.8.6.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.8.6.5.2.1" class="ltx_text" style="font-size:80%;">21.63</span></th>
<td id="S3.T2.8.6.5.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.6.5.3.1" class="ltx_text" style="font-size:80%;">31.78</span></td>
<td id="S3.T2.8.6.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.6.5.4.1" class="ltx_text" style="font-size:80%;">15.52</span></td>
<td id="S3.T2.8.6.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S3.T2.8.6.5.5.1" class="ltx_text" style="font-size:80%;">4.48</span></td>
</tr>
<tr id="S3.T2.8.7.6" class="ltx_tr">
<th id="S3.T2.8.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.7.6.1.1" class="ltx_text" style="font-size:80%;">Ratio Loss</span></th>
<th id="S3.T2.8.7.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.7.6.2.1" class="ltx_text" style="font-size:80%;">24.32</span></th>
<td id="S3.T2.8.7.6.3" class="ltx_td ltx_align_center"><span id="S3.T2.8.7.6.3.1" class="ltx_text" style="font-size:80%;">36.33</span></td>
<td id="S3.T2.8.7.6.4" class="ltx_td ltx_align_center"><span id="S3.T2.8.7.6.4.1" class="ltx_text" style="font-size:80%;">18.14</span></td>
<td id="S3.T2.8.7.6.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T2.8.7.6.5.1" class="ltx_text" style="font-size:80%;">7.10</span></td>
</tr>
<tr id="S3.T2.8.8.7" class="ltx_tr">
<th id="S3.T2.8.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.8.7.1.1" class="ltx_text" style="font-size:80%;">FedAvg+LWS</span></th>
<th id="S3.T2.8.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.8.8.7.2.1" class="ltx_text" style="font-size:80%;">21.58</span></th>
<td id="S3.T2.8.8.7.3" class="ltx_td ltx_align_center"><span id="S3.T2.8.8.7.3.1" class="ltx_text" style="font-size:80%;">31.66</span></td>
<td id="S3.T2.8.8.7.4" class="ltx_td ltx_align_center"><span id="S3.T2.8.8.7.4.1" class="ltx_text" style="font-size:80%;">15.76</span></td>
<td id="S3.T2.8.8.7.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T2.8.8.7.5.1" class="ltx_text" style="font-size:80%;">5.33</span></td>
</tr>
<tr id="S3.T2.8.9.8" class="ltx_tr" style="background-color:#EFEFEF;">
<th id="S3.T2.8.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S3.T2.8.9.8.1.1" class="ltx_text" style="font-size:80%;background-color:#EFEFEF;">FEDIC</span></th>
<th id="S3.T2.8.9.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S3.T2.8.9.8.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">28.93</span></th>
<td id="S3.T2.8.9.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.8.9.8.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">38.24</span></td>
<td id="S3.T2.8.9.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.8.9.8.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">25.28</span></td>
<td id="S3.T2.8.9.8.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.8.9.8.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;background-color:#EFEFEF;">15.91</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p"><span id="S3.SS2.p3.1.1" class="ltx_text ltx_font_bold">Results on ImageNet-LT.</span> We evaluate FEDIC on ImageNet-LT whose results are reported in Table <a href="#S3.T2" title="Table 2 ‣ 3.2 Comparison with the State-of-the-art Methods ‣ 3 Experiments ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Compared with the other methods, FEDIC achieves the best results on all cases we have tried thus far. At the same time, the accuracy on the few-shot classes achieves 15.91%, which is a significant improvement of 8.5% in comparison with the baseline.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Model Validation</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p"><span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_bold">Ablation study on ensemble calibration.</span> We conduct an ablation study to evaluate the necessity of each component of ensemble calibration in FEDIC, as shown in Table <a href="#S3.T3" title="Table 3 ‣ 3.3 Model Validation ‣ 3 Experiments ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We evaluate three modules: Fine-tune (FT), client-wise and class-wise logit adjustment (LA) and knowledge distillation (KD). Note that we do not specifically evaluate the proposed calibration gating network because it is used only if both FT and LA are activated. The experiment is done by running FEDIC to round 200 and evaluating all combinations on that round.
In the upper part (a)-(d) in Table <a href="#S3.T3" title="Table 3 ‣ 3.3 Model Validation ‣ 3 Experiments ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we only evaluate the performance of the ensemble model without distillation. Compared with the baseline (a), the overall accuracy of the calibrated ensemble model (d) is improved by 11.2%.
In the lower part (e)-(h), knowledge distillation is conducted. It can be observed that
the gap of the overall accuracy between the teacher model (d) and the student model (h) is only 1.7%, which indicates that the generalization ability to deal with the long-tail distribution is successfully transferred.
</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span id="S3.T3.4.1.1" class="ltx_text ltx_font_bold" style="font-size:113%;">Table 3</span>: </span><span id="S3.T3.5.2" class="ltx_text" style="font-size:113%;">Ablation study on the components of ensemble calibration in FEDIC on CIFAR-10-LT with IF=100.</span></figcaption>
<table id="S3.T3.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.6.1.1" class="ltx_tr">
<th id="S3.T3.6.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S3.T3.6.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Module</span></th>
<th id="S3.T3.6.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S3.T3.6.1.1.2.1" class="ltx_text" style="font-size:80%;">CIFAR-10-LT</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.6.2.1" class="ltx_tr">
<td id="S3.T3.6.2.1.1" class="ltx_td ltx_border_t"></td>
<th id="S3.T3.6.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.6.2.1.2.1" class="ltx_text" style="font-size:80%;">FT</span></th>
<th id="S3.T3.6.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.6.2.1.3.1" class="ltx_text" style="font-size:80%;">LA</span></th>
<th id="S3.T3.6.2.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.6.2.1.4.1" class="ltx_text" style="font-size:80%;">KD</span></th>
<th id="S3.T3.6.2.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.6.2.1.5.1" class="ltx_text" style="font-size:80%;">All</span></th>
<th id="S3.T3.6.2.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.6.2.1.6.1" class="ltx_text" style="font-size:80%;">Many</span></th>
<th id="S3.T3.6.2.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.6.2.1.7.1" class="ltx_text" style="font-size:80%;">Medium</span></th>
<th id="S3.T3.6.2.1.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.6.2.1.8.1" class="ltx_text" style="font-size:80%;">Few</span></th>
</tr>
<tr id="S3.T3.6.3.2" class="ltx_tr">
<td id="S3.T3.6.3.2.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.3.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span></td>
<td id="S3.T3.6.3.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.3.2.2.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.3.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.3.2.3.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.3.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.3.2.4.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.3.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.3.2.5.1" class="ltx_text" style="font-size:80%;">53.59</span></td>
<td id="S3.T3.6.3.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.3.2.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">76.90</span></td>
<td id="S3.T3.6.3.2.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.3.2.7.1" class="ltx_text" style="font-size:80%;">50.12</span></td>
<td id="S3.T3.6.3.2.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S3.T3.6.3.2.8.1" class="ltx_text" style="font-size:80%;">34.90</span></td>
</tr>
<tr id="S3.T3.6.4.3" class="ltx_tr">
<td id="S3.T3.6.4.3.1" class="ltx_td ltx_align_center"><span id="S3.T3.6.4.3.1.1" class="ltx_text" style="font-size:80%;">(b)</span></td>
<td id="S3.T3.6.4.3.2" class="ltx_td ltx_align_center"><span id="S3.T3.6.4.3.2.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.4.3.3" class="ltx_td ltx_align_center"><span id="S3.T3.6.4.3.3.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.4.3.4" class="ltx_td ltx_align_center"><span id="S3.T3.6.4.3.4.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.4.3.5" class="ltx_td ltx_align_center"><span id="S3.T3.6.4.3.5.1" class="ltx_text" style="font-size:80%;">61.11</span></td>
<td id="S3.T3.6.4.3.6" class="ltx_td ltx_align_center"><span id="S3.T3.6.4.3.6.1" class="ltx_text" style="font-size:80%;">64.30</span></td>
<td id="S3.T3.6.4.3.7" class="ltx_td ltx_align_center"><span id="S3.T3.6.4.3.7.1" class="ltx_text" style="font-size:80%;">62.47</span></td>
<td id="S3.T3.6.4.3.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T3.6.4.3.8.1" class="ltx_text" style="font-size:80%;">56.10</span></td>
</tr>
<tr id="S3.T3.6.5.4" class="ltx_tr">
<td id="S3.T3.6.5.4.1" class="ltx_td ltx_align_center"><span id="S3.T3.6.5.4.1.1" class="ltx_text" style="font-size:80%;">(c)</span></td>
<td id="S3.T3.6.5.4.2" class="ltx_td ltx_align_center"><span id="S3.T3.6.5.4.2.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.5.4.3" class="ltx_td ltx_align_center"><span id="S3.T3.6.5.4.3.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.5.4.4" class="ltx_td ltx_align_center"><span id="S3.T3.6.5.4.4.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.5.4.5" class="ltx_td ltx_align_center"><span id="S3.T3.6.5.4.5.1" class="ltx_text" style="font-size:80%;">60.66</span></td>
<td id="S3.T3.6.5.4.6" class="ltx_td ltx_align_center"><span id="S3.T3.6.5.4.6.1" class="ltx_text" style="font-size:80%;">66.00</span></td>
<td id="S3.T3.6.5.4.7" class="ltx_td ltx_align_center"><span id="S3.T3.6.5.4.7.1" class="ltx_text" style="font-size:80%;">60.93</span></td>
<td id="S3.T3.6.5.4.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T3.6.5.4.8.1" class="ltx_text" style="font-size:80%;">53.26</span></td>
</tr>
<tr id="S3.T3.6.6.5" class="ltx_tr">
<td id="S3.T3.6.6.5.1" class="ltx_td ltx_align_center"><span id="S3.T3.6.6.5.1.1" class="ltx_text" style="font-size:80%;">(d)</span></td>
<td id="S3.T3.6.6.5.2" class="ltx_td ltx_align_center"><span id="S3.T3.6.6.5.2.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.6.5.3" class="ltx_td ltx_align_center"><span id="S3.T3.6.6.5.3.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.6.5.4" class="ltx_td ltx_align_center"><span id="S3.T3.6.6.5.4.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.6.5.5" class="ltx_td ltx_align_center"><span id="S3.T3.6.6.5.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">64.77</span></td>
<td id="S3.T3.6.6.5.6" class="ltx_td ltx_align_center"><span id="S3.T3.6.6.5.6.1" class="ltx_text" style="font-size:80%;">65.26</span></td>
<td id="S3.T3.6.6.5.7" class="ltx_td ltx_align_center"><span id="S3.T3.6.6.5.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">64.88</span></td>
<td id="S3.T3.6.6.5.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T3.6.6.5.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">62.55</span></td>
</tr>
<tr id="S3.T3.6.7.6" class="ltx_tr">
<td id="S3.T3.6.7.6.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.7.6.1.1" class="ltx_text" style="font-size:80%;">(e)</span></td>
<td id="S3.T3.6.7.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.7.6.2.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.7.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.7.6.3.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.7.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.7.6.4.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.7.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.7.6.5.1" class="ltx_text" style="font-size:80%;">53.92</span></td>
<td id="S3.T3.6.7.6.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.7.6.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">77.20</span></td>
<td id="S3.T3.6.7.6.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.6.7.6.7.1" class="ltx_text" style="font-size:80%;">51.32</span></td>
<td id="S3.T3.6.7.6.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S3.T3.6.7.6.8.1" class="ltx_text" style="font-size:80%;">34.05</span></td>
</tr>
<tr id="S3.T3.6.8.7" class="ltx_tr">
<td id="S3.T3.6.8.7.1" class="ltx_td ltx_align_center"><span id="S3.T3.6.8.7.1.1" class="ltx_text" style="font-size:80%;">(f)</span></td>
<td id="S3.T3.6.8.7.2" class="ltx_td ltx_align_center"><span id="S3.T3.6.8.7.2.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.8.7.3" class="ltx_td ltx_align_center"><span id="S3.T3.6.8.7.3.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.8.7.4" class="ltx_td ltx_align_center"><span id="S3.T3.6.8.7.4.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.8.7.5" class="ltx_td ltx_align_center"><span id="S3.T3.6.8.7.5.1" class="ltx_text" style="font-size:80%;">60.18</span></td>
<td id="S3.T3.6.8.7.6" class="ltx_td ltx_align_center"><span id="S3.T3.6.8.7.6.1" class="ltx_text" style="font-size:80%;">64.68</span></td>
<td id="S3.T3.6.8.7.7" class="ltx_td ltx_align_center"><span id="S3.T3.6.8.7.7.1" class="ltx_text" style="font-size:80%;">58.04</span></td>
<td id="S3.T3.6.8.7.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T3.6.8.7.8.1" class="ltx_text" style="font-size:80%;">56.32</span></td>
</tr>
<tr id="S3.T3.6.9.8" class="ltx_tr">
<td id="S3.T3.6.9.8.1" class="ltx_td ltx_align_center"><span id="S3.T3.6.9.8.1.1" class="ltx_text" style="font-size:80%;">(g)</span></td>
<td id="S3.T3.6.9.8.2" class="ltx_td ltx_align_center"><span id="S3.T3.6.9.8.2.1" class="ltx_text" style="font-size:80%;">✗</span></td>
<td id="S3.T3.6.9.8.3" class="ltx_td ltx_align_center"><span id="S3.T3.6.9.8.3.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.9.8.4" class="ltx_td ltx_align_center"><span id="S3.T3.6.9.8.4.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.9.8.5" class="ltx_td ltx_align_center"><span id="S3.T3.6.9.8.5.1" class="ltx_text" style="font-size:80%;">61.71</span></td>
<td id="S3.T3.6.9.8.6" class="ltx_td ltx_align_center"><span id="S3.T3.6.9.8.6.1" class="ltx_text" style="font-size:80%;">63.75</span></td>
<td id="S3.T3.6.9.8.7" class="ltx_td ltx_align_center"><span id="S3.T3.6.9.8.7.1" class="ltx_text" style="font-size:80%;">63.45</span></td>
<td id="S3.T3.6.9.8.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T3.6.9.8.8.1" class="ltx_text" style="font-size:80%;">57.94</span></td>
</tr>
<tr id="S3.T3.6.10.9" class="ltx_tr">
<td id="S3.T3.6.10.9.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T3.6.10.9.1.1" class="ltx_text" style="font-size:80%;">(h)</span></td>
<td id="S3.T3.6.10.9.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T3.6.10.9.2.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.10.9.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T3.6.10.9.3.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.10.9.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T3.6.10.9.4.1" class="ltx_text" style="font-size:80%;">✓</span></td>
<td id="S3.T3.6.10.9.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T3.6.10.9.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">63.11</span></td>
<td id="S3.T3.6.10.9.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T3.6.10.9.6.1" class="ltx_text" style="font-size:80%;">64.90</span></td>
<td id="S3.T3.6.10.9.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T3.6.10.9.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">63.60</span></td>
<td id="S3.T3.6.10.9.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S3.T3.6.10.9.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">60.83</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.4" class="ltx_p"><span id="S3.SS3.p2.4.1" class="ltx_text ltx_font_bold">Influence of sizes of auxiliary and unlabeled datasets.</span> The sizes of <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.3.1" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.1.3.1a" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.1.3.4" xref="S3.SS3.p2.1.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝒟</ci><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><times id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3.1"></times><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3">𝑢</ci><ci id="S3.SS3.p2.1.m1.1.1.3.4.cmml" xref="S3.SS3.p2.1.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathcal{D}_{aux}</annotation></semantics></math> and <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{ulb}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">𝒟</mi><mrow id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.1.1.3.1" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.1.1.3.1a" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.2.m2.1.1.3.4" xref="S3.SS3.p2.2.m2.1.1.3.4.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝒟</ci><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><times id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3.1"></times><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">𝑢</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3">𝑙</ci><ci id="S3.SS3.p2.2.m2.1.1.3.4.cmml" xref="S3.SS3.p2.2.m2.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathcal{D}_{ulb}</annotation></semantics></math> play a key role in FEDIC. Therefore, we evaluate its influence on the performance of FEDIC, compared with the baseline FedAvg and a global model fine-tuned with <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.3.1" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.3.1a" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.3.m3.1.1.3.4" xref="S3.SS3.p2.3.m3.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝒟</ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><times id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.1"></times><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">𝑎</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">𝑢</ci><ci id="S3.SS3.p2.3.m3.1.1.3.4.cmml" xref="S3.SS3.p2.3.m3.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\mathcal{D}_{aux}</annotation></semantics></math> (marked as FT), as shown in Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Experiment Setup ‣ 3 Experiments ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Different curves in the figure indicate the data fractions of the unlabeled data used for distillation. We observe that FEDIC consistently outperforms FedAvg and FT for all sizes of <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{aux}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">𝒟</mi><mrow id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m4.1.1.3.1" xref="S3.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m4.1.1.3.1a" xref="S3.SS3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.4.m4.1.1.3.4" xref="S3.SS3.p2.4.m4.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝒟</ci><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><times id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3.1"></times><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">𝑎</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3">𝑢</ci><ci id="S3.SS3.p2.4.m4.1.1.3.4.cmml" xref="S3.SS3.p2.4.m4.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\mathcal{D}_{aux}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.3" class="ltx_p"><span id="S3.SS3.p3.3.1" class="ltx_text ltx_font_bold">Sensitivity analysis of hyperparameters.</span> We investigate the impact of distillation trade-off coefficient <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\lambda</annotation></semantics></math>. This hyperparameter controls the strength of distillation in the loss function in Eq. (<a href="#S2.E9" title="In 2.2 Proposed Method ‣ 2 Proposed method ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>). It can be observed from Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Experiment Setup ‣ 3 Experiments ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> that FEDIC is robust to most <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\lambda</annotation></semantics></math> values. However, the performance severely drops when <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\lambda</annotation></semantics></math> reaches 1, which shows that solely distillation with unlabeled data is not enough for a good global model.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.1" class="ltx_p"><span id="S3.SS3.p4.1.1" class="ltx_text ltx_font_bold">Influence of the degree of non-IIDness.</span> Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Experiment Setup ‣ 3 Experiments ‣ FEDIC: Federated Learning on Non-IID and Long-Tailed Data via Calibrated Distillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> further shows the test accuracy of four methods under the different degrees of non-IIDness. It can be observed that the performance of all methods drops as the degree of non-IIDness increases. However, the performance of the compared methods drops more severely than FEDIC when <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\alpha</annotation></semantics></math> decreases from 1.0 to 0.01.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this paper, we have proposed FEDIC to deal with the problem of learning a global model on non-IID and long-tailed data in the federated learning framework. FEDIC is a server-side method that first calibrates the biased ensemble model against the long-tail distribution by client-wise and class-wise logit adjustment with a calibration gating network. Then, the calibrated ensemble is used as the teacher model to transfer knowledge to the global model for further optimization on the clients. Also, the effectiveness of each component in FEDIC has been validated empirically. Experiments have shown that FEDIC outperforms the state-of-the-art FL methods on datasets with the non-IID and long-tailed setting.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Chang Xia, Jingyu Hua, Wei Tong, Yayuan Xiong, and Sheng Zhong,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">“A privacy-preserving scheme for convolutional neural network-based
applications in mobile cloud,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICME</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2020, pp. 1–6.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Ameet Talwalkar, and Virginia Smith,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">“Federated learning: Challenges, methods, and future directions,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Signal Process. Mag.</span><span id="bib.bib2.4.2" class="ltx_text" style="font-size:90%;">, vol. 37, no. 3, pp. 50–60, 2020.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">“Communication-efficient learning of deep networks from
decentralized data,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AISTATS</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2017, pp. 1273–1282.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">“Federated learning with non-iid data,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1806.00582</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">“Federated optimization in heterogeneous networks,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Mach. Learn.</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2020, pp. 429–450.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Yaoxin Zhuo and Baoxin Li,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">“Fedns: Improving federated learning for collaborative image
classification on mobile clients,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICME</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 1–6.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Ching-Hao Wang, Kang-Yang Huang, Jun-Cheng Chen, Hong-Han Shuai, and Wen-Huang
Cheng,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">“Heterogeneous federated learning through multi-branch network,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICME</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 1–6.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Tao Lin, Lingjing Kong, Sebastian U Stich, and Martin Jaggi,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">“Ensemble distillation for robust model fusion in federated
learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2020, pp. 2351–2363.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Hong-You Chen and Wei-Lun Chao,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">“Fedbe: Making bayesian model ensemble applicable to federated
learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 1–19.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Jianyu Wang, Qinghua Liu, Hao Liang, Gauri Joshi, and H. Vincent Poor,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">“Tackling the objective inconsistency problem in heterogeneous
federated optimization,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2020, pp. 7611–7623.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">“Measuring the effects of non-identical data distribution for
federated visual classification,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1909.06335</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Yifan Zhang, Bingyi Kang, Bryan Hooi, Shuicheng Yan, and Jiashi Feng,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">“Deep long-tailed learning: A survey,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2110.04596</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Haibo He and Edwardo A Garcia,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">“Learning from imbalanced data,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Trans. Knowl. Data Eng.</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, vol. 21, no. 9, pp. 1263–1284,
2009.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Hsin-Ping Chou, Shih-Chieh Chang, Jia-Yu Pan, Wei Wei, and Da-Cheng Juan,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">“Remix: Rebalanced mixup,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2020, pp. 95–110.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Jun Shu, Qi Xie, Lixuan Yi, Qian Zhao, Sanping Zhou, Zongben Xu, and Deyu Meng,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">“Meta-weight-net: Learning an explicit mapping for sample
weighting,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, 2019, p. 1567–1578.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Bingyi Kang, Saining Xie, Marcus Rohrbach, Zhicheng Yan, Albert Gordo, Jiashi
Feng, and Yannis Kalantidis,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">“Decoupling representation and classifier for long-tailed
recognition,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, 2020, pp. 1–16.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Moming Duan, Duo Liu, Xianzhang Chen, Renping Liu, Yujuan Tan, and Liang Liang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">“Self-balancing federated learning with global imbalanced data in
mobile systems,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Trans. Parallel Distrib. Syst.</span><span id="bib.bib17.4.2" class="ltx_text" style="font-size:90%;">, vol. 32, no. 1, pp.
59–71, 2020.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Lixu Wang, Shichao Xu, Xiao Wang, and Qi Zhu,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">“Addressing class imbalance in federated learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AAAI</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 10165–10173.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Thomas G Dietterich,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">“Ensemble methods in machine learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. Workshop Multiple Classifier Syst.</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, 2000, pp. 1–15.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Geoffrey Hinton, Oriol Vinyals, and Jeff Dean,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">“Distilling the knowledge in a neural network,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1503.02531</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Songyang Zhang, Zeming Li, Shipeng Yan, Xuming He, and Jian Sun,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">“Distribution alignment: A unified framework for long-tail visual
recognition,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 2361–2370.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Hinton Geoffrey Krizhevsky Alex,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">“Learning multiple layers of features from tiny images,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Tech. Rep.</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;"> 2009, pp. 32–33, University of Toronto.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Kaidi Cao, Colin Wei, Adrien Gaidon, Nikos Arechiga, and Tengyu Ma,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">“Learning imbalanced datasets with label-distribution-aware margin
loss,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2019, pp. 1567–1578.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, Sanjeev Satheesh, Sean Ma,
Zhiheng Huang, Andrej Karpathy, Aditya Khosla, and Michael Bernstein,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">“Imagenet large scale visual recognition challenge,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. J. Comput. Vision</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, vol. 115, no. 3, pp. 211–252, 2015.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Dipankar Sarkar, Ankur Narang, and Sumit Rai,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">“Fed-focal loss for imbalanced data classification in federated
learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2011.06283</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2205.00171" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2205.00172" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2205.00172">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2205.00172" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2205.00173" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Mar 11 17:01:59 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
