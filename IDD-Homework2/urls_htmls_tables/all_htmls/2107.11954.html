<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2107.11954] Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes</title><meta property="og:description" content="Although federated learning (FL) has recently been proposed for efficient distributed training and data privacy protection, it still encounters many obstacles. One of these is the naturally existing statistical heterog…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2107.11954">

<!--Generated on Wed Mar  6 15:34:51 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="federated learning,  private-shared models,  non-iid,  privatization,  aggregation,  personalization">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno"><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup>This is generated with the ACM Journal LeTex format.</span></span></span><span id="footnote1a" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup>*Corresponding Author</span></span></span>
<h1 class="ltx_title ltx_title_document">Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xin-Chun Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:lixc@lamda.nju.edu.cn">lixc@lamda.nju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Le Gan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ganle@nju.edu.cn">ganle@nju.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">De-Chuan Zhan<sup id="id2.2.id1" class="ltx_sup">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:zhandc@nju.edu.cn">zhandc@nju.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id3.3.id1" class="ltx_text ltx_affiliation_institution">State Key Laboratory for Novel Software Technology, Nanjing University</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yunfeng Shao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:shaoyunfeng@huawei.com">shaoyunfeng@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bingshuai Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:libingshuai@huawei.com">libingshuai@huawei.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shaoming Song
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:shaoming.song@huawei.com">shaoming.song@huawei.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id4.1.id1" class="ltx_text ltx_affiliation_institution">Huawei Noah’s Ark Lab</span>
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id5.id1" class="ltx_p">Although federated learning (FL) has recently been proposed for efficient distributed training and data privacy protection, it still encounters many obstacles. One of these is the naturally existing statistical heterogeneity among clients, making local data distributions non independently and identically distributed (i.e., non-iid), which poses challenges for model aggregation and personalization. For FL with a deep neural network (DNN), privatizing some layers is a simple yet effective solution for non-iid problems. However, which layers should we privatize to facilitate the learning process? Do different categories of non-iid scenes have preferred privatization ways? Can we automatically learn the most appropriate privatization way during FL? In this paper, we answer these questions via abundant experimental studies on several FL benchmarks. First, we present the detailed statistics of these benchmarks and categorize them into covariate and label shift non-iid scenes. Then, we investigate both coarse-grained and fine-grained network splits and explore whether the preferred privatization ways have any potential relations to the specific category of a non-iid scene. Our findings are exciting, e.g., privatizing the base layers could boost the performances even in label shift non-iid scenes, which are inconsistent with some natural conjectures. We also find that none of these privatization ways could improve the performances on the Shakespeare benchmark, and we guess that Shakespeare may not be a seriously non-iid scene. Finally, we propose several approaches to automatically learn where to aggregate via cross-stitch, soft attention, and hard selection. We advocate the proposed methods could serve as a preliminary try to explore where to privatize for a novel non-iid scene.</p>
</div>
<div class="ltx_keywords">federated learning, private-shared models, non-iid, privatization, aggregation, personalization
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Transfer learning</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Distributed algorithms</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Although traditional machine learning methods have experienced great success in some fields <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky
et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2012</a>; He
et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2016</a>)</cite>, the samples must be centralized for training. However, due to the data privacy or transmission cost in real-world applications, data from individual participants are often isolated and can not be located on the same device <cite class="ltx_cite ltx_citemacro_citep">(Ramaswamy et al<span class="ltx_text">.</span>, <a href="#bib.bib46" title="" class="ltx_ref">2019</a>)</cite>. Derived but different from the standard distributed optimization <cite class="ltx_cite ltx_citemacro_citep">(Dean et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2012</a>)</cite>, federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(Kairouz
et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2019</a>; Yang
et al<span class="ltx_text">.</span>, <a href="#bib.bib58" title="" class="ltx_ref">2019</a>; McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite> is tailored for data privacy protection and efficient distributed training. FL has been applied to many specific tasks, e.g., language modeling <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>, medical relation extraction <cite class="ltx_cite ltx_citemacro_citep">(Sui
et al<span class="ltx_text">.</span>, <a href="#bib.bib50" title="" class="ltx_ref">2020</a>)</cite>, industrial topic modeling <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>, and medical image analysis <cite class="ltx_cite ltx_citemacro_citep">(Yang
et al<span class="ltx_text">.</span>, <a href="#bib.bib59" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Standard FL methods utilize a parameter server <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2013</a>)</cite> to collaborate isolated clients, dividing the distributed training process into multiple rounds of local and global procedures. During the local procedure, a fraction of clients is selected to tune the global model downloaded from the parameter server. During the global procedure, the server collects the model updates from clients and fuses them into the global model. Because local clients bear more computation, FL can reduce the communication cost to some extent. From another aspect, only model parameters are transmitted among clients and the server, and hence FL provides essential privacy protection for local data.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">FL also faces many challenges. First, a real-world FL system may contain millions of local clients (e.g., portable devices), in which the communication may be unstable and the computation budget of local devices is often limited. This obstacle is categorized as the systematical heterogeneity in <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, and the possible solutions are investigated in <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2019</a>; Konecný et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2016</a>)</cite>. Second, although FL avoids direct transmission of users’ data and provides a certain level of privacy protection for users, it may encounter attacks or model inspection from adversaries in non-ideal real-world applications <cite class="ltx_cite ltx_citemacro_citep">(Kairouz
et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>. Some advanced privacy techniques can be applied to FL to acquire stricter privacy requirements, e.g., differential privacy <cite class="ltx_cite ltx_citemacro_citep">(Dwork and Roth, <a href="#bib.bib15" title="" class="ltx_ref">2014</a>; Wei et al<span class="ltx_text">.</span>, <a href="#bib.bib56" title="" class="ltx_ref">2020</a>)</cite>, homomorphic encryption <cite class="ltx_cite ltx_citemacro_citep">(Liu
et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>. Third, local clients’ various contexts determine that their data are non independently and identically distributed (i.e., non-iid). This problem is categorized as statistical heterogeneity in <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>. As the most standard FL algorithm, FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite> is originally declared robust to the non-iid data, while later studies have shown that it could experience severe performance degradation when faced with heterogeneous data <cite class="ltx_cite ltx_citemacro_citep">(Hsieh
et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>. One convincing explanation is the weight divergence proposed in <cite class="ltx_cite ltx_citemacro_citep">(Zhao
et al<span class="ltx_text">.</span>, <a href="#bib.bib67" title="" class="ltx_ref">2018</a>)</cite>, pointing out that the local update could diverge significantly from the optimal global target. Solutions with various considerations are proposed to enhance the model performances in FL with non-iid data <cite class="ltx_cite ltx_citemacro_citep">(Shoham et al<span class="ltx_text">.</span>, <a href="#bib.bib48" title="" class="ltx_ref">2019</a>; Yao
et al<span class="ltx_text">.</span>, <a href="#bib.bib61" title="" class="ltx_ref">2019a</a>; Karimireddy et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2020</a>; Wu et al<span class="ltx_text">.</span>, <a href="#bib.bib57" title="" class="ltx_ref">2019</a>; Chen
et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2018</a>; Peterson
et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2019</a>)</cite>. In this paper, we majorly investigate the non-iid challenge in FL.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">There are two specific goals when considering boosting the FL performances, i.e., aggregation and personalization. The goal of aggregation is to obtain a complete global shared model applicable to all participating clients and expect it could be quickly adapted to forthcoming clients. FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite> is primitively proposed to aggregate a well-performed global model with the collaboration of local clients. As aforementioned, the statistical heterogeneity leads to diverged local model updates, which poses a huge challenge for model aggregation. Several solutions have been proposed to tackle this problem. Some methods <cite class="ltx_cite ltx_citemacro_citep">(Yao
et al<span class="ltx_text">.</span>, <a href="#bib.bib62" title="" class="ltx_ref">2019b</a>; Wu et al<span class="ltx_text">.</span>, <a href="#bib.bib57" title="" class="ltx_ref">2019</a>; Jeong
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2018</a>)</cite> introduce a small public shared dataset on the parameter server and utilize it to fine-tune the aggregated model. Some other methods <cite class="ltx_cite ltx_citemacro_citep">(Li and Wang, <a href="#bib.bib31" title="" class="ltx_ref">2019</a>; Lin
et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2020</a>)</cite> take advantage of knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Hinton
et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2015</a>)</cite> to fuse the local models’ ability into the global model. These methods require an appropriate global dataset on the server, which is not easy to collect with stricter privacy constraints. Limiting the scope of model updates during the local procedure is another way to solve this problem. FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite> directly restricts the local parameters’ L2 distance to the global ones; FedCurv <cite class="ltx_cite ltx_citemacro_citep">(Shoham et al<span class="ltx_text">.</span>, <a href="#bib.bib48" title="" class="ltx_ref">2019</a>)</cite> additionally introduces the fisher information to assign weights to different parameters for overcoming catastrophic forgetting during the local procedure; FedFusion <cite class="ltx_cite ltx_citemacro_citep">(Yao
et al<span class="ltx_text">.</span>, <a href="#bib.bib61" title="" class="ltx_ref">2019a</a>)</cite> and FedMMD <cite class="ltx_cite ltx_citemacro_citep">(Yao
et al<span class="ltx_text">.</span>, <a href="#bib.bib60" title="" class="ltx_ref">2018</a>)</cite> impose such restrictions on the level of intermediate features; Scaffold <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite> introduces control variates and momentum for stable model updates.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Unlike the goal of aggregation, personalization indicates the primary incentive of local clients to participate in FL. Usually, local clients have insufficient labeled data to train well-performed models, and hence they are inclined to take part in the FL process. However, when faced with non-iid data, some clients may gain no benefit as shown in <cite class="ltx_cite ltx_citemacro_citep">(Yu
et al<span class="ltx_text">.</span>, <a href="#bib.bib64" title="" class="ltx_ref">2020</a>; Kulkarni
et al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite>. The main reason is mathematically proposed in <cite class="ltx_cite ltx_citemacro_citep">(Hamer
et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>, which states that the optimal solution of federated optimization is a convex combination of local ideal hypotheses. This implies that the single global model obtained by standard FL algorithms is a compromise solution for all local clients, and naturally, it is not the optimal model for some local clients. Some researches focus on facilitating personalization in FL. Formulating the FL as a multi-task learning <cite class="ltx_cite ltx_citemacro_citep">(Smith
et al<span class="ltx_text">.</span>, <a href="#bib.bib49" title="" class="ltx_ref">2017</a>)</cite> or meta-learning <cite class="ltx_cite ltx_citemacro_citep">(Chen
et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite> task can improve the personalized models’ performances. Varying the hyper-parameter settings during the local procedure can also facilitate fine-tuning of the global model <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a href="#bib.bib54" title="" class="ltx_ref">2019</a>)</cite>. In DNN based FL, privatizing some network layers is a simple yet effective solution for better personalization <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>; Liang et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Peterson
et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2019</a>; Bui et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2019</a>; Shen et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">This paper mainly focus on investigating private-shared models’ effectiveness for both FL aggregation and personalization. This investigation’s primary motivation originates from an interesting finding that existing FL methods with private-shared models take various privatization ways, e.g., privatizing the task-specific layers <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>, privatizing the base layers <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite>, privatizing the user embedding layer <cite class="ltx_cite ltx_citemacro_citep">(Bui et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2019</a>)</cite>, or even privatizing a complete deep model <cite class="ltx_cite ltx_citemacro_citep">(Peterson
et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2019</a>; Shen et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2020</a>)</cite>. Hence, we aim to investigate whether these architecture designs conform to some definite rules and which layers we should privatize when given a novel FL non-iid scene. Specifically, our investigation steps and contributions are listed as follows:</p>
</div>
<div id="S1.p7" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">We select several classical FL benchmarks and categorize them into covariate or label shift non-iid scenes</span>. Inspired by the categorization of non-iid scenes in <cite class="ltx_cite ltx_citemacro_citep">(Kairouz
et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>, we select four FL benchmarks that are commonly utilized in previous works, i.e., FeCifar10, FeCifar100, Shakespeare, and FeMnist. The first two benchmarks are label shift non-iid scenes where the heterogeneity is mainly caused by splitting data according to labels <cite class="ltx_cite ltx_citemacro_citep">(Zhao
et al<span class="ltx_text">.</span>, <a href="#bib.bib67" title="" class="ltx_ref">2018</a>; Hsieh
et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>. The second two are benchmarks recommended by LEAF <cite class="ltx_cite ltx_citemacro_citep">(Caldas et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>, and we view them as covariate shift non-iid scenes, where the heterogeneity is mainly caused by different play roles or users.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">We compare aggregation and personalization performances of various privatization ways based on both coarse-grained and fine-grained network splits.</span> For each benchmark, we first split its corresponding DNN into two coarse parts, i.e., the feature extractor (a.k.a., encoder) and the task-specific predictor (a.k.a., classifier). We construct various private-shared models and compare their aggregation and personalization performances in FL. Then, we split the DNN into fine-grained blocks for deeper analysis.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p"><span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">We propose several automatical methods to learn where to aggregate.</span> To automatically learn an appropriate privatization way for a specific FL non-iid scene, we keep both shared and private models on local clients and utilize three techniques, including cross-stitch, soft attention, and hard selection, to fuse features and outputs during the FL dynamically.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">We observe several exciting phenomena, e.g., privatizing the task-specific classifier may not be the most appropriate way for label shift non-iid scenes (see in Sect. <a href="#S5.SS4.SSS1" title="5.4.1. Coarse-grained Privatization ‣ 5.4. Results of Different Privatization Ways ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4.1</span></a>); none of the investigated privatization ways improve the performances on Shakespeare (see in Sect. <a href="#S5.SS4.SSS1" title="5.4.1. Coarse-grained Privatization ‣ 5.4. Results of Different Privatization Ways ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4.1</span></a> and Sect. <a href="#S5.SS5" title="5.5. Results of Automatical Algorithms ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.5</span></a>); the personalization performances will degrade monotonically with the number of private layers becoming larger in the single branch privatization ways (see in Sect. <a href="#S5.SS4.SSS2" title="5.4.2. Fine-grained Privatization ‣ 5.4. Results of Different Privatization Ways ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4.2</span></a>). Aside from the three automatical approaches, we also propose an interpolation trick to quickly search for the appropriate way to privatize (see in Sect. <a href="#S5.SS5" title="5.5. Results of Automatical Algorithms ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.5</span></a>).</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2107.11954/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="251" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span><span id="S1.F1.2.1" class="ltx_text" style="font-size:90%;">Illustrations of the defined privatization ways and corresponding FL framework. The top part shows the concept of “block” and “network splits” defined in Def. <a href="#S4.Thmtheorem1" title="Definition 4.1 (Block). ‣ 4.1. Privatization Ways ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> and Def. <a href="#S4.Thmtheorem2" title="Definition 4.2 (Network Splits). ‣ 4.1. Privatization Ways ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>; then the defined four “privatization” ways in Def. <a href="#S4.Thmtheorem3" title="Definition 4.3 (Privatization). ‣ 4.1. Privatization Ways ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, i.e., PS, SP, SPS, and SSP, are correspondingly presented. The bottom left part shows the unique privatization ways with <math id="S1.F1.2.1.m1.1" class="ltx_Math" alttext="L=2" display="inline"><semantics id="S1.F1.2.1.m1.1b"><mrow id="S1.F1.2.1.m1.1.1" xref="S1.F1.2.1.m1.1.1.cmml"><mi id="S1.F1.2.1.m1.1.1.2" xref="S1.F1.2.1.m1.1.1.2.cmml">L</mi><mo id="S1.F1.2.1.m1.1.1.1" xref="S1.F1.2.1.m1.1.1.1.cmml">=</mo><mn id="S1.F1.2.1.m1.1.1.3" xref="S1.F1.2.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.2.1.m1.1c"><apply id="S1.F1.2.1.m1.1.1.cmml" xref="S1.F1.2.1.m1.1.1"><eq id="S1.F1.2.1.m1.1.1.1.cmml" xref="S1.F1.2.1.m1.1.1.1"></eq><ci id="S1.F1.2.1.m1.1.1.2.cmml" xref="S1.F1.2.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S1.F1.2.1.m1.1.1.3.cmml" xref="S1.F1.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.1.m1.1d">L=2</annotation></semantics></math>, e.g., we split a network into feature extractor (a.k.a., encoder) and task-specific predictor (a.k.a., classifier). The bottom right part shows the FL framework with private components, where only the shared blocks participate in the global aggregation.</span></figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Works</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">The most relevant learning paradigms to FL faced with non-iid data are transfer learning (TL) <cite class="ltx_cite ltx_citemacro_citep">(Pan and Yang, <a href="#bib.bib43" title="" class="ltx_ref">2010</a>)</cite> and multi-task learning (MTL) <cite class="ltx_cite ltx_citemacro_citep">(Zhang and Yang, <a href="#bib.bib66" title="" class="ltx_ref">2017</a>; Crawshaw, <a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>. Hence, we will introduce some related works, including private-shared models in TL and MTL, existing researches on where to transfer/share in TL/MTL.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Private-Shared Models in TL and MTL</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Private-shared models aim to divide private and shared information among domains/tasks via feeding data to different network components. The shared components are commonly assumed to learn domain-invariant knowledge, and the private ones can capture task-specific information. Dating back to MTL without deep networks, MTFL <cite class="ltx_cite ltx_citemacro_citep">(Argyriou
et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2006</a>)</cite> proposes to share the feature transformation matrix among tasks and learn task-specific weights for each task individually. This evolves into sharing the same feature extractor among tasks and privatizing task-specific layers in  <cite class="ltx_cite ltx_citemacro_citep">(Collobert and
Weston, <a href="#bib.bib12" title="" class="ltx_ref">2008</a>; Liu
et al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2016</a>)</cite>. DSN <cite class="ltx_cite ltx_citemacro_citep">(Bousmalis et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2016</a>)</cite> designs a separation framework in FL with shared and private encoders for source and target domains. As a special kind of private-shared architecture, domain-specific batch normalization <cite class="ltx_cite ltx_citemacro_citep">(Chang
et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> is proposed for better adaptation in TL.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Similarly, private-shared models have also been applied to FL. FedPer <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite> privatizes the task-specific classifier for each client for better personalization, while on the contrary, FedL2G <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite> keeps the feature extractor private to process heterogeneous inputs and shares task-specific layers. FLDA <cite class="ltx_cite ltx_citemacro_citep">(Peterson
et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2019</a>)</cite> keeps a whole model private to mitigate the performance degradation induced by differential privacy. FedDML <cite class="ltx_cite ltx_citemacro_citep">(Shen et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2020</a>)</cite> also privatizes the whole model, while they introduce knowledge distillation for better aggregation and personalization simultaneously. As a particular case, FURL <cite class="ltx_cite ltx_citemacro_citep">(Bui et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2019</a>)</cite> advocates privatizing the user embedding layer for better federated recommendation.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Where to Transfer/Share in TL/MTL</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">For TL, when, what, and how to transfer are three core problems to be addressed as proposed in <cite class="ltx_cite ltx_citemacro_citep">(Pan and Yang, <a href="#bib.bib43" title="" class="ltx_ref">2010</a>)</cite>. Likewise, when, what, and how to share in MTL are corresponding fundamental issues to be solved <cite class="ltx_cite ltx_citemacro_citep">(Zhang and Yang, <a href="#bib.bib66" title="" class="ltx_ref">2017</a>)</cite>. Although the private-shared models described above provide essential solutions for dataset shift <cite class="ltx_cite ltx_citemacro_citep">(Quionero-Candela et al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2009</a>)</cite> in FL and MTL, which layers should we share or privatize is still an open problem. Existing researches dive into this from both qualitative and quantitative perspectives. Qualitative ones take abundant experimental studies to explore the underlying rules. In DNN based tasks, the base layers are assumed to be more transferable than top layers, which has been verified by existing studies <cite class="ltx_cite ltx_citemacro_citep">(Yosinski
et al<span class="ltx_text">.</span>, <a href="#bib.bib63" title="" class="ltx_ref">2014</a>)</cite>. Based on this, the layer-wise transferability of deep representations is further explored in <cite class="ltx_cite ltx_citemacro_citep">(Fayek
et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>, and this study also points that the transferability is non-symmetric. Additionally, L2Tw <cite class="ltx_cite ltx_citemacro_citep">(Jang
et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite> introduces meta-networks to automatically decide which features should be transferred to which target layers. The task relations are also experimentally explored in MTL <cite class="ltx_cite ltx_citemacro_citep">(Zamir et al<span class="ltx_text">.</span>, <a href="#bib.bib65" title="" class="ltx_ref">2018</a>; Vu et al<span class="ltx_text">.</span>, <a href="#bib.bib53" title="" class="ltx_ref">2020</a>)</cite>, exploring which source task is the most adaptable to the target one. There are also some quantitative works to explore the transferability among tasks, e.g., conditional entropy <cite class="ltx_cite ltx_citemacro_citep">(Tran
et al<span class="ltx_text">.</span>, <a href="#bib.bib51" title="" class="ltx_ref">2019</a>)</cite>, H-score <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2019</a>)</cite>, and LEEP <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al<span class="ltx_text">.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">However, the problem of where to aggregate in FL under non-iid scenes has not been explicitly studied as far as we know. Therefore, we aim to qualitatively explore the relationship between specific privatization ways and FL performances under different non-iid scenes in this paper.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Background</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">This section will introduce the basic procedure of FL, the goals of model aggregation and personalization, and the specific issues that we want to explore.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Basic Procedure of FL</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.4" class="ltx_p">In standard FL systems, e.g., FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>, we have <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> distributed clients and a global parameter server. Each client has a local data distribution <math id="S3.SS1.p1.2.m2.2" class="ltx_Math" alttext="{\mathcal{D}^{k}}={\mathcal{P}^{k}}({\mathbf{x}},y)" display="inline"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.3" xref="S3.SS1.p1.2.m2.2.3.cmml"><msup id="S3.SS1.p1.2.m2.2.3.2" xref="S3.SS1.p1.2.m2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.2.3.2.2" xref="S3.SS1.p1.2.m2.2.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m2.2.3.2.3" xref="S3.SS1.p1.2.m2.2.3.2.3.cmml">k</mi></msup><mo id="S3.SS1.p1.2.m2.2.3.1" xref="S3.SS1.p1.2.m2.2.3.1.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.2.3.3" xref="S3.SS1.p1.2.m2.2.3.3.cmml"><msup id="S3.SS1.p1.2.m2.2.3.3.2" xref="S3.SS1.p1.2.m2.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.2.3.3.2.2" xref="S3.SS1.p1.2.m2.2.3.3.2.2.cmml">𝒫</mi><mi id="S3.SS1.p1.2.m2.2.3.3.2.3" xref="S3.SS1.p1.2.m2.2.3.3.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.2.3.3.1" xref="S3.SS1.p1.2.m2.2.3.3.1.cmml">​</mo><mrow id="S3.SS1.p1.2.m2.2.3.3.3.2" xref="S3.SS1.p1.2.m2.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.2.3.3.3.2.1" xref="S3.SS1.p1.2.m2.2.3.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝐱</mi><mo id="S3.SS1.p1.2.m2.2.3.3.3.2.2" xref="S3.SS1.p1.2.m2.2.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.2.3.3.3.2.3" xref="S3.SS1.p1.2.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.3"><eq id="S3.SS1.p1.2.m2.2.3.1.cmml" xref="S3.SS1.p1.2.m2.2.3.1"></eq><apply id="S3.SS1.p1.2.m2.2.3.2.cmml" xref="S3.SS1.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.3.2.1.cmml" xref="S3.SS1.p1.2.m2.2.3.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.2.3.2.2.cmml" xref="S3.SS1.p1.2.m2.2.3.2.2">𝒟</ci><ci id="S3.SS1.p1.2.m2.2.3.2.3.cmml" xref="S3.SS1.p1.2.m2.2.3.2.3">𝑘</ci></apply><apply id="S3.SS1.p1.2.m2.2.3.3.cmml" xref="S3.SS1.p1.2.m2.2.3.3"><times id="S3.SS1.p1.2.m2.2.3.3.1.cmml" xref="S3.SS1.p1.2.m2.2.3.3.1"></times><apply id="S3.SS1.p1.2.m2.2.3.3.2.cmml" xref="S3.SS1.p1.2.m2.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.3.3.2.1.cmml" xref="S3.SS1.p1.2.m2.2.3.3.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.2.3.3.2.2">𝒫</ci><ci id="S3.SS1.p1.2.m2.2.3.3.2.3.cmml" xref="S3.SS1.p1.2.m2.2.3.3.2.3">𝑘</ci></apply><interval closure="open" id="S3.SS1.p1.2.m2.2.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.2.3.3.3.2"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐱</ci><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">{\mathcal{D}^{k}}={\mathcal{P}^{k}}({\mathbf{x}},y)</annotation></semantics></math>, and <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="{\mathcal{D}^{k}}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msup id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝒟</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">{\mathcal{D}^{k}}</annotation></semantics></math> could differ from other local clients’ distributions a lot. For the <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">k</annotation></semantics></math>th client, its optimization target is:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="{\mathcal{L}^{k}}({\theta}^{k})\triangleq E_{({\mathbf{x}}^{k},y^{k})\sim{\mathcal{D}^{k}}}\left[\ell\left(f({\mathbf{x}}^{k};{\theta}^{k}),y^{k}\right)\right]," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><msup id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.3.2.cmml">ℒ</mi><mi id="S3.E1.m1.3.3.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.3.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml">≜</mo><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><msub id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.2.3.2.cmml">E</mi><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mrow id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.3.cmml">(</mo><msup id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E1.m1.2.2.2.2.2.4" xref="S3.E1.m1.2.2.2.2.3.cmml">,</mo><msup id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.5" xref="S3.E1.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">∼</mo><msup id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.4.2" xref="S3.E1.m1.2.2.2.4.2.cmml">𝒟</mi><mi id="S3.E1.m1.2.2.2.4.3" xref="S3.E1.m1.2.2.2.4.3.cmml">k</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1" xref="S3.E1.m1.3.3.1.1.2.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.2.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.1.1.2.1.1.1.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml"><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">(</mo><msup id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">;</mo><msup id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.5" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml">,</mo><msup id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3.cmml">k</mi></msup><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.5" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><ci id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3">≜</ci><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.3.2">ℒ</ci><ci id="S3.E1.m1.3.3.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><times id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"></times><apply id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2">𝐸</ci><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3">𝑘</ci></apply></interval><apply id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.4.1.cmml" xref="S3.E1.m1.2.2.2.4">superscript</csymbol><ci id="S3.E1.m1.2.2.2.4.2.cmml" xref="S3.E1.m1.2.2.2.4.2">𝒟</ci><ci id="S3.E1.m1.2.2.2.4.3.cmml" xref="S3.E1.m1.2.2.2.4.3">𝑘</ci></apply></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.2.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1"><times id="S3.E1.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.3"></times><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.4">ℓ</ci><interval closure="open" id="S3.E1.m1.3.3.1.1.2.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.3"></times><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.4">𝑓</ci><list id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></list></apply><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">{\mathcal{L}^{k}}({\theta}^{k})\triangleq E_{({\mathbf{x}}^{k},y^{k})\sim{\mathcal{D}^{k}}}\left[\ell\left(f({\mathbf{x}}^{k};{\theta}^{k}),y^{k}\right)\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.15" class="ltx_p">where <math id="S3.SS1.p1.5.m1.2" class="ltx_Math" alttext="f(\cdot;{\theta}^{k})" display="inline"><semantics id="S3.SS1.p1.5.m1.2a"><mrow id="S3.SS1.p1.5.m1.2.2" xref="S3.SS1.p1.5.m1.2.2.cmml"><mi id="S3.SS1.p1.5.m1.2.2.3" xref="S3.SS1.p1.5.m1.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m1.2.2.2" xref="S3.SS1.p1.5.m1.2.2.2.cmml">​</mo><mrow id="S3.SS1.p1.5.m1.2.2.1.1" xref="S3.SS1.p1.5.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m1.2.2.1.1.2" xref="S3.SS1.p1.5.m1.2.2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m1.1.1" xref="S3.SS1.p1.5.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.5.m1.2.2.1.1.3" xref="S3.SS1.p1.5.m1.2.2.1.2.cmml">;</mo><msup id="S3.SS1.p1.5.m1.2.2.1.1.1" xref="S3.SS1.p1.5.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.5.m1.2.2.1.1.1.2" xref="S3.SS1.p1.5.m1.2.2.1.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.5.m1.2.2.1.1.1.3" xref="S3.SS1.p1.5.m1.2.2.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S3.SS1.p1.5.m1.2.2.1.1.4" xref="S3.SS1.p1.5.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m1.2b"><apply id="S3.SS1.p1.5.m1.2.2.cmml" xref="S3.SS1.p1.5.m1.2.2"><times id="S3.SS1.p1.5.m1.2.2.2.cmml" xref="S3.SS1.p1.5.m1.2.2.2"></times><ci id="S3.SS1.p1.5.m1.2.2.3.cmml" xref="S3.SS1.p1.5.m1.2.2.3">𝑓</ci><list id="S3.SS1.p1.5.m1.2.2.1.2.cmml" xref="S3.SS1.p1.5.m1.2.2.1.1"><ci id="S3.SS1.p1.5.m1.1.1.cmml" xref="S3.SS1.p1.5.m1.1.1">⋅</ci><apply id="S3.SS1.p1.5.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.5.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.5.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.5.m1.2.2.1.1.1.2">𝜃</ci><ci id="S3.SS1.p1.5.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.5.m1.2.2.1.1.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m1.2c">f(\cdot;{\theta}^{k})</annotation></semantics></math> is the prediction function with parameters <math id="S3.SS1.p1.6.m2.1" class="ltx_Math" alttext="\theta^{k}" display="inline"><semantics id="S3.SS1.p1.6.m2.1a"><msup id="S3.SS1.p1.6.m2.1.1" xref="S3.SS1.p1.6.m2.1.1.cmml"><mi id="S3.SS1.p1.6.m2.1.1.2" xref="S3.SS1.p1.6.m2.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.6.m2.1.1.3" xref="S3.SS1.p1.6.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m2.1b"><apply id="S3.SS1.p1.6.m2.1.1.cmml" xref="S3.SS1.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m2.1.1.1.cmml" xref="S3.SS1.p1.6.m2.1.1">superscript</csymbol><ci id="S3.SS1.p1.6.m2.1.1.2.cmml" xref="S3.SS1.p1.6.m2.1.1.2">𝜃</ci><ci id="S3.SS1.p1.6.m2.1.1.3.cmml" xref="S3.SS1.p1.6.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m2.1c">\theta^{k}</annotation></semantics></math> and <math id="S3.SS1.p1.7.m3.2" class="ltx_Math" alttext="f({\mathbf{x}}^{k};{\theta}^{k})" display="inline"><semantics id="S3.SS1.p1.7.m3.2a"><mrow id="S3.SS1.p1.7.m3.2.2" xref="S3.SS1.p1.7.m3.2.2.cmml"><mi id="S3.SS1.p1.7.m3.2.2.4" xref="S3.SS1.p1.7.m3.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m3.2.2.3" xref="S3.SS1.p1.7.m3.2.2.3.cmml">​</mo><mrow id="S3.SS1.p1.7.m3.2.2.2.2" xref="S3.SS1.p1.7.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m3.2.2.2.2.3" xref="S3.SS1.p1.7.m3.2.2.2.3.cmml">(</mo><msup id="S3.SS1.p1.7.m3.1.1.1.1.1" xref="S3.SS1.p1.7.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.7.m3.1.1.1.1.1.2" xref="S3.SS1.p1.7.m3.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.7.m3.1.1.1.1.1.3" xref="S3.SS1.p1.7.m3.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.SS1.p1.7.m3.2.2.2.2.4" xref="S3.SS1.p1.7.m3.2.2.2.3.cmml">;</mo><msup id="S3.SS1.p1.7.m3.2.2.2.2.2" xref="S3.SS1.p1.7.m3.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.7.m3.2.2.2.2.2.2" xref="S3.SS1.p1.7.m3.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.SS1.p1.7.m3.2.2.2.2.2.3" xref="S3.SS1.p1.7.m3.2.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="S3.SS1.p1.7.m3.2.2.2.2.5" xref="S3.SS1.p1.7.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m3.2b"><apply id="S3.SS1.p1.7.m3.2.2.cmml" xref="S3.SS1.p1.7.m3.2.2"><times id="S3.SS1.p1.7.m3.2.2.3.cmml" xref="S3.SS1.p1.7.m3.2.2.3"></times><ci id="S3.SS1.p1.7.m3.2.2.4.cmml" xref="S3.SS1.p1.7.m3.2.2.4">𝑓</ci><list id="S3.SS1.p1.7.m3.2.2.2.3.cmml" xref="S3.SS1.p1.7.m3.2.2.2.2"><apply id="S3.SS1.p1.7.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m3.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.7.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m3.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.7.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m3.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.p1.7.m3.2.2.2.2.2.cmml" xref="S3.SS1.p1.7.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m3.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.7.m3.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.7.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.7.m3.2.2.2.2.2.2">𝜃</ci><ci id="S3.SS1.p1.7.m3.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.7.m3.2.2.2.2.2.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m3.2c">f({\mathbf{x}}^{k};{\theta}^{k})</annotation></semantics></math> is a <math id="S3.SS1.p1.8.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p1.8.m4.1a"><mi id="S3.SS1.p1.8.m4.1.1" xref="S3.SS1.p1.8.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m4.1b"><ci id="S3.SS1.p1.8.m4.1.1.cmml" xref="S3.SS1.p1.8.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m4.1c">C</annotation></semantics></math>-dimensional probability vector that reflects the prediction result. <math id="S3.SS1.p1.9.m5.2" class="ltx_Math" alttext="\ell\left(\cdot,\cdot\right)" display="inline"><semantics id="S3.SS1.p1.9.m5.2a"><mrow id="S3.SS1.p1.9.m5.2.3" xref="S3.SS1.p1.9.m5.2.3.cmml"><mi mathvariant="normal" id="S3.SS1.p1.9.m5.2.3.2" xref="S3.SS1.p1.9.m5.2.3.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m5.2.3.1" xref="S3.SS1.p1.9.m5.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.9.m5.2.3.3.2" xref="S3.SS1.p1.9.m5.2.3.3.1.cmml"><mo id="S3.SS1.p1.9.m5.2.3.3.2.1" xref="S3.SS1.p1.9.m5.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m5.1.1" xref="S3.SS1.p1.9.m5.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.p1.9.m5.2.3.3.2.2" xref="S3.SS1.p1.9.m5.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m5.2.2" xref="S3.SS1.p1.9.m5.2.2.cmml">⋅</mo><mo id="S3.SS1.p1.9.m5.2.3.3.2.3" xref="S3.SS1.p1.9.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m5.2b"><apply id="S3.SS1.p1.9.m5.2.3.cmml" xref="S3.SS1.p1.9.m5.2.3"><times id="S3.SS1.p1.9.m5.2.3.1.cmml" xref="S3.SS1.p1.9.m5.2.3.1"></times><ci id="S3.SS1.p1.9.m5.2.3.2.cmml" xref="S3.SS1.p1.9.m5.2.3.2">ℓ</ci><interval closure="open" id="S3.SS1.p1.9.m5.2.3.3.1.cmml" xref="S3.SS1.p1.9.m5.2.3.3.2"><ci id="S3.SS1.p1.9.m5.1.1.cmml" xref="S3.SS1.p1.9.m5.1.1">⋅</ci><ci id="S3.SS1.p1.9.m5.2.2.cmml" xref="S3.SS1.p1.9.m5.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m5.2c">\ell\left(\cdot,\cdot\right)</annotation></semantics></math> is the loss function, which is usually the cross-entropy loss. Commonly, the client <math id="S3.SS1.p1.10.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.10.m6.1a"><mi id="S3.SS1.p1.10.m6.1.1" xref="S3.SS1.p1.10.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m6.1b"><ci id="S3.SS1.p1.10.m6.1.1.cmml" xref="S3.SS1.p1.10.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m6.1c">k</annotation></semantics></math> could only observe a small training dataset <math id="S3.SS1.p1.11.m7.1" class="ltx_Math" alttext="{D^{k}_{\text{tr}}}=\{({\mathbf{x}}_{i}^{k},y_{i}^{k})\}_{i=1}^{{N^{k}_{\text{tr}}}}" display="inline"><semantics id="S3.SS1.p1.11.m7.1a"><mrow id="S3.SS1.p1.11.m7.1.1" xref="S3.SS1.p1.11.m7.1.1.cmml"><msubsup id="S3.SS1.p1.11.m7.1.1.3" xref="S3.SS1.p1.11.m7.1.1.3.cmml"><mi id="S3.SS1.p1.11.m7.1.1.3.2.2" xref="S3.SS1.p1.11.m7.1.1.3.2.2.cmml">D</mi><mtext id="S3.SS1.p1.11.m7.1.1.3.3" xref="S3.SS1.p1.11.m7.1.1.3.3a.cmml">tr</mtext><mi id="S3.SS1.p1.11.m7.1.1.3.2.3" xref="S3.SS1.p1.11.m7.1.1.3.2.3.cmml">k</mi></msubsup><mo id="S3.SS1.p1.11.m7.1.1.2" xref="S3.SS1.p1.11.m7.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p1.11.m7.1.1.1" xref="S3.SS1.p1.11.m7.1.1.1.cmml"><mrow id="S3.SS1.p1.11.m7.1.1.1.1.1.1" xref="S3.SS1.p1.11.m7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.2" xref="S3.SS1.p1.11.m7.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.4" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.5" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.3" xref="S3.SS1.p1.11.m7.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.11.m7.1.1.1.1.3" xref="S3.SS1.p1.11.m7.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.11.m7.1.1.1.1.3.2" xref="S3.SS1.p1.11.m7.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.11.m7.1.1.1.1.3.1" xref="S3.SS1.p1.11.m7.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.11.m7.1.1.1.1.3.3" xref="S3.SS1.p1.11.m7.1.1.1.1.3.3.cmml">1</mn></mrow><msubsup id="S3.SS1.p1.11.m7.1.1.1.3" xref="S3.SS1.p1.11.m7.1.1.1.3.cmml"><mi id="S3.SS1.p1.11.m7.1.1.1.3.2.2" xref="S3.SS1.p1.11.m7.1.1.1.3.2.2.cmml">N</mi><mtext id="S3.SS1.p1.11.m7.1.1.1.3.3" xref="S3.SS1.p1.11.m7.1.1.1.3.3a.cmml">tr</mtext><mi id="S3.SS1.p1.11.m7.1.1.1.3.2.3" xref="S3.SS1.p1.11.m7.1.1.1.3.2.3.cmml">k</mi></msubsup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m7.1b"><apply id="S3.SS1.p1.11.m7.1.1.cmml" xref="S3.SS1.p1.11.m7.1.1"><eq id="S3.SS1.p1.11.m7.1.1.2.cmml" xref="S3.SS1.p1.11.m7.1.1.2"></eq><apply id="S3.SS1.p1.11.m7.1.1.3.cmml" xref="S3.SS1.p1.11.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.3.1.cmml" xref="S3.SS1.p1.11.m7.1.1.3">subscript</csymbol><apply id="S3.SS1.p1.11.m7.1.1.3.2.cmml" xref="S3.SS1.p1.11.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.3.2.1.cmml" xref="S3.SS1.p1.11.m7.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.11.m7.1.1.3.2.2.cmml" xref="S3.SS1.p1.11.m7.1.1.3.2.2">𝐷</ci><ci id="S3.SS1.p1.11.m7.1.1.3.2.3.cmml" xref="S3.SS1.p1.11.m7.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.11.m7.1.1.3.3a.cmml" xref="S3.SS1.p1.11.m7.1.1.3.3"><mtext mathsize="70%" id="S3.SS1.p1.11.m7.1.1.3.3.cmml" xref="S3.SS1.p1.11.m7.1.1.3.3">tr</mtext></ci></apply><apply id="S3.SS1.p1.11.m7.1.1.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.1.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.11.m7.1.1.1.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1">subscript</csymbol><set id="S3.SS1.p1.11.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1"><interval closure="open" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2"><apply id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="S3.SS1.p1.11.m7.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.3"><eq id="S3.SS1.p1.11.m7.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.3.1"></eq><ci id="S3.SS1.p1.11.m7.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.11.m7.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.11.m7.1.1.1.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.1.3.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1.3">subscript</csymbol><apply id="S3.SS1.p1.11.m7.1.1.1.3.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m7.1.1.1.3.2.1.cmml" xref="S3.SS1.p1.11.m7.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.11.m7.1.1.1.3.2.2.cmml" xref="S3.SS1.p1.11.m7.1.1.1.3.2.2">𝑁</ci><ci id="S3.SS1.p1.11.m7.1.1.1.3.2.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.11.m7.1.1.1.3.3a.cmml" xref="S3.SS1.p1.11.m7.1.1.1.3.3"><mtext mathsize="50%" id="S3.SS1.p1.11.m7.1.1.1.3.3.cmml" xref="S3.SS1.p1.11.m7.1.1.1.3.3">tr</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m7.1c">{D^{k}_{\text{tr}}}=\{({\mathbf{x}}_{i}^{k},y_{i}^{k})\}_{i=1}^{{N^{k}_{\text{tr}}}}</annotation></semantics></math> from the data distribution <math id="S3.SS1.p1.12.m8.1" class="ltx_Math" alttext="{\mathcal{D}^{k}}" display="inline"><semantics id="S3.SS1.p1.12.m8.1a"><msup id="S3.SS1.p1.12.m8.1.1" xref="S3.SS1.p1.12.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m8.1.1.2" xref="S3.SS1.p1.12.m8.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.12.m8.1.1.3" xref="S3.SS1.p1.12.m8.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m8.1b"><apply id="S3.SS1.p1.12.m8.1.1.cmml" xref="S3.SS1.p1.12.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m8.1.1.1.cmml" xref="S3.SS1.p1.12.m8.1.1">superscript</csymbol><ci id="S3.SS1.p1.12.m8.1.1.2.cmml" xref="S3.SS1.p1.12.m8.1.1.2">𝒟</ci><ci id="S3.SS1.p1.12.m8.1.1.3.cmml" xref="S3.SS1.p1.12.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m8.1c">{\mathcal{D}^{k}}</annotation></semantics></math>, where <math id="S3.SS1.p1.13.m9.1" class="ltx_Math" alttext="{N^{k}_{\text{tr}}}" display="inline"><semantics id="S3.SS1.p1.13.m9.1a"><msubsup id="S3.SS1.p1.13.m9.1.1" xref="S3.SS1.p1.13.m9.1.1.cmml"><mi id="S3.SS1.p1.13.m9.1.1.2.2" xref="S3.SS1.p1.13.m9.1.1.2.2.cmml">N</mi><mtext id="S3.SS1.p1.13.m9.1.1.3" xref="S3.SS1.p1.13.m9.1.1.3a.cmml">tr</mtext><mi id="S3.SS1.p1.13.m9.1.1.2.3" xref="S3.SS1.p1.13.m9.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m9.1b"><apply id="S3.SS1.p1.13.m9.1.1.cmml" xref="S3.SS1.p1.13.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m9.1.1.1.cmml" xref="S3.SS1.p1.13.m9.1.1">subscript</csymbol><apply id="S3.SS1.p1.13.m9.1.1.2.cmml" xref="S3.SS1.p1.13.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m9.1.1.2.1.cmml" xref="S3.SS1.p1.13.m9.1.1">superscript</csymbol><ci id="S3.SS1.p1.13.m9.1.1.2.2.cmml" xref="S3.SS1.p1.13.m9.1.1.2.2">𝑁</ci><ci id="S3.SS1.p1.13.m9.1.1.2.3.cmml" xref="S3.SS1.p1.13.m9.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.13.m9.1.1.3a.cmml" xref="S3.SS1.p1.13.m9.1.1.3"><mtext mathsize="70%" id="S3.SS1.p1.13.m9.1.1.3.cmml" xref="S3.SS1.p1.13.m9.1.1.3">tr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m9.1c">{N^{k}_{\text{tr}}}</annotation></semantics></math> is the number of training instances and <math id="S3.SS1.p1.14.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.14.m10.1a"><mi id="S3.SS1.p1.14.m10.1.1" xref="S3.SS1.p1.14.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m10.1b"><ci id="S3.SS1.p1.14.m10.1.1.cmml" xref="S3.SS1.p1.14.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m10.1c">i</annotation></semantics></math> is the sample index. A small <math id="S3.SS1.p1.15.m11.1" class="ltx_Math" alttext="{N^{k}_{\text{tr}}}" display="inline"><semantics id="S3.SS1.p1.15.m11.1a"><msubsup id="S3.SS1.p1.15.m11.1.1" xref="S3.SS1.p1.15.m11.1.1.cmml"><mi id="S3.SS1.p1.15.m11.1.1.2.2" xref="S3.SS1.p1.15.m11.1.1.2.2.cmml">N</mi><mtext id="S3.SS1.p1.15.m11.1.1.3" xref="S3.SS1.p1.15.m11.1.1.3a.cmml">tr</mtext><mi id="S3.SS1.p1.15.m11.1.1.2.3" xref="S3.SS1.p1.15.m11.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m11.1b"><apply id="S3.SS1.p1.15.m11.1.1.cmml" xref="S3.SS1.p1.15.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m11.1.1.1.cmml" xref="S3.SS1.p1.15.m11.1.1">subscript</csymbol><apply id="S3.SS1.p1.15.m11.1.1.2.cmml" xref="S3.SS1.p1.15.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m11.1.1.2.1.cmml" xref="S3.SS1.p1.15.m11.1.1">superscript</csymbol><ci id="S3.SS1.p1.15.m11.1.1.2.2.cmml" xref="S3.SS1.p1.15.m11.1.1.2.2">𝑁</ci><ci id="S3.SS1.p1.15.m11.1.1.2.3.cmml" xref="S3.SS1.p1.15.m11.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.15.m11.1.1.3a.cmml" xref="S3.SS1.p1.15.m11.1.1.3"><mtext mathsize="70%" id="S3.SS1.p1.15.m11.1.1.3.cmml" xref="S3.SS1.p1.15.m11.1.1.3">tr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m11.1c">{N^{k}_{\text{tr}}}</annotation></semantics></math> may limit the client’s ability to train a well-performed model. Therefore, collaborating all clients is a possible solution. FedAvg takes the following optimization target:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.6" class="ltx_Math" alttext="{\mathcal{L}}({\theta})\triangleq\sum_{k=1}^{K}p_{k}{\mathcal{L}}^{k}({\theta})=\sum_{k=1}^{K}p_{k}\left[E_{({\mathbf{x}}^{k},y^{k})\sim{\mathcal{D}^{k}}}\left[\ell\left(f({\mathbf{x}}^{k};{\theta}),y^{k}\right)\right]\right]," display="block"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.3" xref="S3.E2.m1.6.6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.1.1.3.2" xref="S3.E2.m1.6.6.1.1.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.3.1" xref="S3.E2.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.3.3.2" xref="S3.E2.m1.6.6.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.3.3.2.1" xref="S3.E2.m1.6.6.1.1.3.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.6.6.1.1.3.3.2.2" xref="S3.E2.m1.6.6.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.6.6.1.1.4" xref="S3.E2.m1.6.6.1.1.4.cmml">≜</mo><mrow id="S3.E2.m1.6.6.1.1.5" xref="S3.E2.m1.6.6.1.1.5.cmml"><munderover id="S3.E2.m1.6.6.1.1.5.1" xref="S3.E2.m1.6.6.1.1.5.1.cmml"><mo movablelimits="false" id="S3.E2.m1.6.6.1.1.5.1.2.2" xref="S3.E2.m1.6.6.1.1.5.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.1.1.5.1.2.3" xref="S3.E2.m1.6.6.1.1.5.1.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.5.1.2.3.2" xref="S3.E2.m1.6.6.1.1.5.1.2.3.2.cmml">k</mi><mo id="S3.E2.m1.6.6.1.1.5.1.2.3.1" xref="S3.E2.m1.6.6.1.1.5.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.6.6.1.1.5.1.2.3.3" xref="S3.E2.m1.6.6.1.1.5.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.6.6.1.1.5.1.3" xref="S3.E2.m1.6.6.1.1.5.1.3.cmml">K</mi></munderover><mrow id="S3.E2.m1.6.6.1.1.5.2" xref="S3.E2.m1.6.6.1.1.5.2.cmml"><msub id="S3.E2.m1.6.6.1.1.5.2.2" xref="S3.E2.m1.6.6.1.1.5.2.2.cmml"><mi id="S3.E2.m1.6.6.1.1.5.2.2.2" xref="S3.E2.m1.6.6.1.1.5.2.2.2.cmml">p</mi><mi id="S3.E2.m1.6.6.1.1.5.2.2.3" xref="S3.E2.m1.6.6.1.1.5.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.5.2.1" xref="S3.E2.m1.6.6.1.1.5.2.1.cmml">​</mo><msup id="S3.E2.m1.6.6.1.1.5.2.3" xref="S3.E2.m1.6.6.1.1.5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.1.1.5.2.3.2" xref="S3.E2.m1.6.6.1.1.5.2.3.2.cmml">ℒ</mi><mi id="S3.E2.m1.6.6.1.1.5.2.3.3" xref="S3.E2.m1.6.6.1.1.5.2.3.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.5.2.1a" xref="S3.E2.m1.6.6.1.1.5.2.1.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.5.2.4.2" xref="S3.E2.m1.6.6.1.1.5.2.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.5.2.4.2.1" xref="S3.E2.m1.6.6.1.1.5.2.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.6.6.1.1.5.2.4.2.2" xref="S3.E2.m1.6.6.1.1.5.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.6.6.1.1.6" xref="S3.E2.m1.6.6.1.1.6.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml"><munderover id="S3.E2.m1.6.6.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.6.6.1.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.1.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.2.2.3.2" xref="S3.E2.m1.6.6.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.6.6.1.1.1.2.2.3.1" xref="S3.E2.m1.6.6.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.6.6.1.1.1.2.2.3.3" xref="S3.E2.m1.6.6.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.6.6.1.1.1.2.3" xref="S3.E2.m1.6.6.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E2.m1.6.6.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.cmml"><msub id="S3.E2.m1.6.6.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.3.2.cmml">p</mi><mi id="S3.E2.m1.6.6.1.1.1.1.3.3" xref="S3.E2.m1.6.6.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.2.cmml">E</mi><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">(</mo><msup id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E2.m1.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.3.cmml">,</mo><msup id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.5" xref="S3.E2.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">∼</mo><msup id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.2.cmml">𝒟</mi><mi id="S3.E2.m1.2.2.2.4.3" xref="S3.E2.m1.2.2.2.4.3.cmml">k</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msup><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.6.6.1.2" xref="S3.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1"><and id="S3.E2.m1.6.6.1.1a.cmml" xref="S3.E2.m1.6.6.1"></and><apply id="S3.E2.m1.6.6.1.1b.cmml" xref="S3.E2.m1.6.6.1"><ci id="S3.E2.m1.6.6.1.1.4.cmml" xref="S3.E2.m1.6.6.1.1.4">≜</ci><apply id="S3.E2.m1.6.6.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.3"><times id="S3.E2.m1.6.6.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.1"></times><ci id="S3.E2.m1.6.6.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2">ℒ</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝜃</ci></apply><apply id="S3.E2.m1.6.6.1.1.5.cmml" xref="S3.E2.m1.6.6.1.1.5"><apply id="S3.E2.m1.6.6.1.1.5.1.cmml" xref="S3.E2.m1.6.6.1.1.5.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.5.1.1.cmml" xref="S3.E2.m1.6.6.1.1.5.1">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.5.1.2.cmml" xref="S3.E2.m1.6.6.1.1.5.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.5.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.5.1">subscript</csymbol><sum id="S3.E2.m1.6.6.1.1.5.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.5.1.2.2"></sum><apply id="S3.E2.m1.6.6.1.1.5.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.5.1.2.3"><eq id="S3.E2.m1.6.6.1.1.5.1.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.5.1.2.3.1"></eq><ci id="S3.E2.m1.6.6.1.1.5.1.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.5.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.6.6.1.1.5.1.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.5.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.6.6.1.1.5.1.3.cmml" xref="S3.E2.m1.6.6.1.1.5.1.3">𝐾</ci></apply><apply id="S3.E2.m1.6.6.1.1.5.2.cmml" xref="S3.E2.m1.6.6.1.1.5.2"><times id="S3.E2.m1.6.6.1.1.5.2.1.cmml" xref="S3.E2.m1.6.6.1.1.5.2.1"></times><apply id="S3.E2.m1.6.6.1.1.5.2.2.cmml" xref="S3.E2.m1.6.6.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.5.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.5.2.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.5.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.5.2.2.2">𝑝</ci><ci id="S3.E2.m1.6.6.1.1.5.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.5.2.2.3">𝑘</ci></apply><apply id="S3.E2.m1.6.6.1.1.5.2.3.cmml" xref="S3.E2.m1.6.6.1.1.5.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.5.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.5.2.3">superscript</csymbol><ci id="S3.E2.m1.6.6.1.1.5.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.5.2.3.2">ℒ</ci><ci id="S3.E2.m1.6.6.1.1.5.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.5.2.3.3">𝑘</ci></apply><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝜃</ci></apply></apply></apply><apply id="S3.E2.m1.6.6.1.1c.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.6.cmml" xref="S3.E2.m1.6.6.1.1.6"></eq><share href="#S3.E2.m1.6.6.1.1.5.cmml" id="S3.E2.m1.6.6.1.1d.cmml" xref="S3.E2.m1.6.6.1"></share><apply id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.6.6.1.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.6.6.1.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2.3"><eq id="S3.E2.m1.6.6.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.6.6.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.6.6.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.6.6.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.2.3">𝐾</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2"></times><apply id="S3.E2.m1.6.6.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2">𝑝</ci><ci id="S3.E2.m1.6.6.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.2">𝐸</ci><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3">𝑘</ci></apply></interval><apply id="S3.E2.m1.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4">superscript</csymbol><ci id="S3.E2.m1.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.4.2">𝒟</ci><ci id="S3.E2.m1.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.4.3">𝑘</ci></apply></apply></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3"></times><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.4">ℓ</ci><interval closure="open" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑓</ci><list id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝜃</ci></list></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">{\mathcal{L}}({\theta})\triangleq\sum_{k=1}^{K}p_{k}{\mathcal{L}}^{k}({\theta})=\sum_{k=1}^{K}p_{k}\left[E_{({\mathbf{x}}^{k},y^{k})\sim{\mathcal{D}^{k}}}\left[\ell\left(f({\mathbf{x}}^{k};{\theta}),y^{k}\right)\right]\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.26" class="ltx_p">where <math id="S3.SS1.p1.16.m1.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S3.SS1.p1.16.m1.1a"><msub id="S3.SS1.p1.16.m1.1.1" xref="S3.SS1.p1.16.m1.1.1.cmml"><mi id="S3.SS1.p1.16.m1.1.1.2" xref="S3.SS1.p1.16.m1.1.1.2.cmml">p</mi><mi id="S3.SS1.p1.16.m1.1.1.3" xref="S3.SS1.p1.16.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m1.1b"><apply id="S3.SS1.p1.16.m1.1.1.cmml" xref="S3.SS1.p1.16.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m1.1.1.1.cmml" xref="S3.SS1.p1.16.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m1.1.1.2.cmml" xref="S3.SS1.p1.16.m1.1.1.2">𝑝</ci><ci id="S3.SS1.p1.16.m1.1.1.3.cmml" xref="S3.SS1.p1.16.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m1.1c">p_{k}</annotation></semantics></math> is often set as <math id="S3.SS1.p1.17.m2.1" class="ltx_Math" alttext="{N^{k}_{\text{tr}}}/\sum_{k}{N^{k}_{\text{tr}}}" display="inline"><semantics id="S3.SS1.p1.17.m2.1a"><mrow id="S3.SS1.p1.17.m2.1.1" xref="S3.SS1.p1.17.m2.1.1.cmml"><msubsup id="S3.SS1.p1.17.m2.1.1.2" xref="S3.SS1.p1.17.m2.1.1.2.cmml"><mi id="S3.SS1.p1.17.m2.1.1.2.2.2" xref="S3.SS1.p1.17.m2.1.1.2.2.2.cmml">N</mi><mtext id="S3.SS1.p1.17.m2.1.1.2.3" xref="S3.SS1.p1.17.m2.1.1.2.3a.cmml">tr</mtext><mi id="S3.SS1.p1.17.m2.1.1.2.2.3" xref="S3.SS1.p1.17.m2.1.1.2.2.3.cmml">k</mi></msubsup><mo rspace="0.055em" id="S3.SS1.p1.17.m2.1.1.1" xref="S3.SS1.p1.17.m2.1.1.1.cmml">/</mo><mrow id="S3.SS1.p1.17.m2.1.1.3" xref="S3.SS1.p1.17.m2.1.1.3.cmml"><msub id="S3.SS1.p1.17.m2.1.1.3.1" xref="S3.SS1.p1.17.m2.1.1.3.1.cmml"><mo id="S3.SS1.p1.17.m2.1.1.3.1.2" xref="S3.SS1.p1.17.m2.1.1.3.1.2.cmml">∑</mo><mi id="S3.SS1.p1.17.m2.1.1.3.1.3" xref="S3.SS1.p1.17.m2.1.1.3.1.3.cmml">k</mi></msub><msubsup id="S3.SS1.p1.17.m2.1.1.3.2" xref="S3.SS1.p1.17.m2.1.1.3.2.cmml"><mi id="S3.SS1.p1.17.m2.1.1.3.2.2.2" xref="S3.SS1.p1.17.m2.1.1.3.2.2.2.cmml">N</mi><mtext id="S3.SS1.p1.17.m2.1.1.3.2.3" xref="S3.SS1.p1.17.m2.1.1.3.2.3a.cmml">tr</mtext><mi id="S3.SS1.p1.17.m2.1.1.3.2.2.3" xref="S3.SS1.p1.17.m2.1.1.3.2.2.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m2.1b"><apply id="S3.SS1.p1.17.m2.1.1.cmml" xref="S3.SS1.p1.17.m2.1.1"><divide id="S3.SS1.p1.17.m2.1.1.1.cmml" xref="S3.SS1.p1.17.m2.1.1.1"></divide><apply id="S3.SS1.p1.17.m2.1.1.2.cmml" xref="S3.SS1.p1.17.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m2.1.1.2.1.cmml" xref="S3.SS1.p1.17.m2.1.1.2">subscript</csymbol><apply id="S3.SS1.p1.17.m2.1.1.2.2.cmml" xref="S3.SS1.p1.17.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m2.1.1.2.2.1.cmml" xref="S3.SS1.p1.17.m2.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.17.m2.1.1.2.2.2.cmml" xref="S3.SS1.p1.17.m2.1.1.2.2.2">𝑁</ci><ci id="S3.SS1.p1.17.m2.1.1.2.2.3.cmml" xref="S3.SS1.p1.17.m2.1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.17.m2.1.1.2.3a.cmml" xref="S3.SS1.p1.17.m2.1.1.2.3"><mtext mathsize="70%" id="S3.SS1.p1.17.m2.1.1.2.3.cmml" xref="S3.SS1.p1.17.m2.1.1.2.3">tr</mtext></ci></apply><apply id="S3.SS1.p1.17.m2.1.1.3.cmml" xref="S3.SS1.p1.17.m2.1.1.3"><apply id="S3.SS1.p1.17.m2.1.1.3.1.cmml" xref="S3.SS1.p1.17.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m2.1.1.3.1.1.cmml" xref="S3.SS1.p1.17.m2.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p1.17.m2.1.1.3.1.2.cmml" xref="S3.SS1.p1.17.m2.1.1.3.1.2"></sum><ci id="S3.SS1.p1.17.m2.1.1.3.1.3.cmml" xref="S3.SS1.p1.17.m2.1.1.3.1.3">𝑘</ci></apply><apply id="S3.SS1.p1.17.m2.1.1.3.2.cmml" xref="S3.SS1.p1.17.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m2.1.1.3.2.1.cmml" xref="S3.SS1.p1.17.m2.1.1.3.2">subscript</csymbol><apply id="S3.SS1.p1.17.m2.1.1.3.2.2.cmml" xref="S3.SS1.p1.17.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m2.1.1.3.2.2.1.cmml" xref="S3.SS1.p1.17.m2.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p1.17.m2.1.1.3.2.2.2.cmml" xref="S3.SS1.p1.17.m2.1.1.3.2.2.2">𝑁</ci><ci id="S3.SS1.p1.17.m2.1.1.3.2.2.3.cmml" xref="S3.SS1.p1.17.m2.1.1.3.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.17.m2.1.1.3.2.3a.cmml" xref="S3.SS1.p1.17.m2.1.1.3.2.3"><mtext mathsize="70%" id="S3.SS1.p1.17.m2.1.1.3.2.3.cmml" xref="S3.SS1.p1.17.m2.1.1.3.2.3">tr</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m2.1c">{N^{k}_{\text{tr}}}/\sum_{k}{N^{k}_{\text{tr}}}</annotation></semantics></math> or a uniform weight <math id="S3.SS1.p1.18.m3.1" class="ltx_Math" alttext="1/K" display="inline"><semantics id="S3.SS1.p1.18.m3.1a"><mrow id="S3.SS1.p1.18.m3.1.1" xref="S3.SS1.p1.18.m3.1.1.cmml"><mn id="S3.SS1.p1.18.m3.1.1.2" xref="S3.SS1.p1.18.m3.1.1.2.cmml">1</mn><mo id="S3.SS1.p1.18.m3.1.1.1" xref="S3.SS1.p1.18.m3.1.1.1.cmml">/</mo><mi id="S3.SS1.p1.18.m3.1.1.3" xref="S3.SS1.p1.18.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m3.1b"><apply id="S3.SS1.p1.18.m3.1.1.cmml" xref="S3.SS1.p1.18.m3.1.1"><divide id="S3.SS1.p1.18.m3.1.1.1.cmml" xref="S3.SS1.p1.18.m3.1.1.1"></divide><cn type="integer" id="S3.SS1.p1.18.m3.1.1.2.cmml" xref="S3.SS1.p1.18.m3.1.1.2">1</cn><ci id="S3.SS1.p1.18.m3.1.1.3.cmml" xref="S3.SS1.p1.18.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m3.1c">1/K</annotation></semantics></math> if the clients own nearly the same amount of training samples. We take the latter one in this paper. This optimization target can be solved by rounds of local and global procedures. In the <math id="S3.SS1.p1.19.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.19.m4.1a"><mi id="S3.SS1.p1.19.m4.1.1" xref="S3.SS1.p1.19.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m4.1b"><ci id="S3.SS1.p1.19.m4.1.1.cmml" xref="S3.SS1.p1.19.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m4.1c">t</annotation></semantics></math>th round, where <math id="S3.SS1.p1.20.m5.4" class="ltx_Math" alttext="t=1,2,\cdots,T" display="inline"><semantics id="S3.SS1.p1.20.m5.4a"><mrow id="S3.SS1.p1.20.m5.4.5" xref="S3.SS1.p1.20.m5.4.5.cmml"><mi id="S3.SS1.p1.20.m5.4.5.2" xref="S3.SS1.p1.20.m5.4.5.2.cmml">t</mi><mo id="S3.SS1.p1.20.m5.4.5.1" xref="S3.SS1.p1.20.m5.4.5.1.cmml">=</mo><mrow id="S3.SS1.p1.20.m5.4.5.3.2" xref="S3.SS1.p1.20.m5.4.5.3.1.cmml"><mn id="S3.SS1.p1.20.m5.1.1" xref="S3.SS1.p1.20.m5.1.1.cmml">1</mn><mo id="S3.SS1.p1.20.m5.4.5.3.2.1" xref="S3.SS1.p1.20.m5.4.5.3.1.cmml">,</mo><mn id="S3.SS1.p1.20.m5.2.2" xref="S3.SS1.p1.20.m5.2.2.cmml">2</mn><mo id="S3.SS1.p1.20.m5.4.5.3.2.2" xref="S3.SS1.p1.20.m5.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.20.m5.3.3" xref="S3.SS1.p1.20.m5.3.3.cmml">⋯</mi><mo id="S3.SS1.p1.20.m5.4.5.3.2.3" xref="S3.SS1.p1.20.m5.4.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.20.m5.4.4" xref="S3.SS1.p1.20.m5.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m5.4b"><apply id="S3.SS1.p1.20.m5.4.5.cmml" xref="S3.SS1.p1.20.m5.4.5"><eq id="S3.SS1.p1.20.m5.4.5.1.cmml" xref="S3.SS1.p1.20.m5.4.5.1"></eq><ci id="S3.SS1.p1.20.m5.4.5.2.cmml" xref="S3.SS1.p1.20.m5.4.5.2">𝑡</ci><list id="S3.SS1.p1.20.m5.4.5.3.1.cmml" xref="S3.SS1.p1.20.m5.4.5.3.2"><cn type="integer" id="S3.SS1.p1.20.m5.1.1.cmml" xref="S3.SS1.p1.20.m5.1.1">1</cn><cn type="integer" id="S3.SS1.p1.20.m5.2.2.cmml" xref="S3.SS1.p1.20.m5.2.2">2</cn><ci id="S3.SS1.p1.20.m5.3.3.cmml" xref="S3.SS1.p1.20.m5.3.3">⋯</ci><ci id="S3.SS1.p1.20.m5.4.4.cmml" xref="S3.SS1.p1.20.m5.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m5.4c">t=1,2,\cdots,T</annotation></semantics></math>, we denote <math id="S3.SS1.p1.21.m6.1" class="ltx_Math" alttext="{\theta}_{t}" display="inline"><semantics id="S3.SS1.p1.21.m6.1a"><msub id="S3.SS1.p1.21.m6.1.1" xref="S3.SS1.p1.21.m6.1.1.cmml"><mi id="S3.SS1.p1.21.m6.1.1.2" xref="S3.SS1.p1.21.m6.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.21.m6.1.1.3" xref="S3.SS1.p1.21.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m6.1b"><apply id="S3.SS1.p1.21.m6.1.1.cmml" xref="S3.SS1.p1.21.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m6.1.1.1.cmml" xref="S3.SS1.p1.21.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.21.m6.1.1.2.cmml" xref="S3.SS1.p1.21.m6.1.1.2">𝜃</ci><ci id="S3.SS1.p1.21.m6.1.1.3.cmml" xref="S3.SS1.p1.21.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m6.1c">{\theta}_{t}</annotation></semantics></math> as the global parameters on the server, and <math id="S3.SS1.p1.22.m7.1" class="ltx_Math" alttext="{\theta}_{t}^{k}" display="inline"><semantics id="S3.SS1.p1.22.m7.1a"><msubsup id="S3.SS1.p1.22.m7.1.1" xref="S3.SS1.p1.22.m7.1.1.cmml"><mi id="S3.SS1.p1.22.m7.1.1.2.2" xref="S3.SS1.p1.22.m7.1.1.2.2.cmml">θ</mi><mi id="S3.SS1.p1.22.m7.1.1.2.3" xref="S3.SS1.p1.22.m7.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p1.22.m7.1.1.3" xref="S3.SS1.p1.22.m7.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m7.1b"><apply id="S3.SS1.p1.22.m7.1.1.cmml" xref="S3.SS1.p1.22.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m7.1.1.1.cmml" xref="S3.SS1.p1.22.m7.1.1">superscript</csymbol><apply id="S3.SS1.p1.22.m7.1.1.2.cmml" xref="S3.SS1.p1.22.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m7.1.1.2.1.cmml" xref="S3.SS1.p1.22.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.22.m7.1.1.2.2.cmml" xref="S3.SS1.p1.22.m7.1.1.2.2">𝜃</ci><ci id="S3.SS1.p1.22.m7.1.1.2.3.cmml" xref="S3.SS1.p1.22.m7.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.22.m7.1.1.3.cmml" xref="S3.SS1.p1.22.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m7.1c">{\theta}_{t}^{k}</annotation></semantics></math> as the parameters on the <math id="S3.SS1.p1.23.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.23.m8.1a"><mi id="S3.SS1.p1.23.m8.1.1" xref="S3.SS1.p1.23.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.23.m8.1b"><ci id="S3.SS1.p1.23.m8.1.1.cmml" xref="S3.SS1.p1.23.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.23.m8.1c">k</annotation></semantics></math>th client. Without additional declaration, we use the superscript “<math id="S3.SS1.p1.24.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.24.m9.1a"><mi id="S3.SS1.p1.24.m9.1.1" xref="S3.SS1.p1.24.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.24.m9.1b"><ci id="S3.SS1.p1.24.m9.1.1.cmml" xref="S3.SS1.p1.24.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.24.m9.1c">k</annotation></semantics></math>” to index the client and “<math id="S3.SS1.p1.25.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.25.m10.1a"><mi id="S3.SS1.p1.25.m10.1.1" xref="S3.SS1.p1.25.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.25.m10.1b"><ci id="S3.SS1.p1.25.m10.1.1.cmml" xref="S3.SS1.p1.25.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.25.m10.1c">i</annotation></semantics></math>” to index the instance; we denote notations without superscript “<math id="S3.SS1.p1.26.m11.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.26.m11.1a"><mi id="S3.SS1.p1.26.m11.1.1" xref="S3.SS1.p1.26.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.26.m11.1b"><ci id="S3.SS1.p1.26.m11.1.1.cmml" xref="S3.SS1.p1.26.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.26.m11.1c">k</annotation></semantics></math>” as the server ones.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.8" class="ltx_p">During the local procedure in <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">t</annotation></semantics></math>th round, a subset of clients <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">S</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑆</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">S_{t}</annotation></semantics></math> is selected, and the selected clients download the global model, i.e., <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="{\theta}_{t}^{k}\leftarrow{\theta}_{t}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msubsup id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.2.cmml">θ</mi><mi id="S3.SS1.p2.3.m3.1.1.2.2.3" xref="S3.SS1.p2.3.m3.1.1.2.2.3.cmml">t</mi><mi id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">←</mo><msub id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">θ</mi><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><ci id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1">←</ci><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">superscript</csymbol><apply id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2.2">𝜃</ci><ci id="S3.SS1.p2.3.m3.1.1.2.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">𝜃</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">{\theta}_{t}^{k}\leftarrow{\theta}_{t}</annotation></semantics></math>. Then, the client <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">k</annotation></semantics></math> samples data batches from local training dataset and update <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="{\theta}_{t}^{k}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msubsup id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2.2" xref="S3.SS1.p2.5.m5.1.1.2.2.cmml">θ</mi><mi id="S3.SS1.p2.5.m5.1.1.2.3" xref="S3.SS1.p2.5.m5.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">superscript</csymbol><apply id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2.2">𝜃</ci><ci id="S3.SS1.p2.5.m5.1.1.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">{\theta}_{t}^{k}</annotation></semantics></math> via the corresponding empirical loss of Eq. <a href="#S3.E1" title="In 3.1. Basic Procedure of FL ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The updated parameters, denoted as <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\hat{{\theta}}_{t}^{k}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msubsup id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mover accent="true" id="S3.SS1.p2.6.m6.1.1.2.2" xref="S3.SS1.p2.6.m6.1.1.2.2.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2.2.2" xref="S3.SS1.p2.6.m6.1.1.2.2.2.cmml">θ</mi><mo id="S3.SS1.p2.6.m6.1.1.2.2.1" xref="S3.SS1.p2.6.m6.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p2.6.m6.1.1.2.3" xref="S3.SS1.p2.6.m6.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">superscript</csymbol><apply id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS1.p2.6.m6.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2"><ci id="S3.SS1.p2.6.m6.1.1.2.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2.1">^</ci><ci id="S3.SS1.p2.6.m6.1.1.2.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2.2">𝜃</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\hat{{\theta}}_{t}^{k}</annotation></semantics></math>, will be uploaded to the global server. For the server, once it has collected updated parameters from these selected clients, it averages the model parameter via <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="{\theta}_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{1}{|S_{t}|}\hat{{\theta}}_{t}^{k}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mrow id="S3.SS1.p2.7.m7.1.2" xref="S3.SS1.p2.7.m7.1.2.cmml"><msub id="S3.SS1.p2.7.m7.1.2.2" xref="S3.SS1.p2.7.m7.1.2.2.cmml"><mi id="S3.SS1.p2.7.m7.1.2.2.2" xref="S3.SS1.p2.7.m7.1.2.2.2.cmml">θ</mi><mrow id="S3.SS1.p2.7.m7.1.2.2.3" xref="S3.SS1.p2.7.m7.1.2.2.3.cmml"><mi id="S3.SS1.p2.7.m7.1.2.2.3.2" xref="S3.SS1.p2.7.m7.1.2.2.3.2.cmml">t</mi><mo id="S3.SS1.p2.7.m7.1.2.2.3.1" xref="S3.SS1.p2.7.m7.1.2.2.3.1.cmml">+</mo><mn id="S3.SS1.p2.7.m7.1.2.2.3.3" xref="S3.SS1.p2.7.m7.1.2.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="S3.SS1.p2.7.m7.1.2.1" xref="S3.SS1.p2.7.m7.1.2.1.cmml">←</mo><mrow id="S3.SS1.p2.7.m7.1.2.3" xref="S3.SS1.p2.7.m7.1.2.3.cmml"><msub id="S3.SS1.p2.7.m7.1.2.3.1" xref="S3.SS1.p2.7.m7.1.2.3.1.cmml"><mo id="S3.SS1.p2.7.m7.1.2.3.1.2" xref="S3.SS1.p2.7.m7.1.2.3.1.2.cmml">∑</mo><mrow id="S3.SS1.p2.7.m7.1.2.3.1.3" xref="S3.SS1.p2.7.m7.1.2.3.1.3.cmml"><mi id="S3.SS1.p2.7.m7.1.2.3.1.3.2" xref="S3.SS1.p2.7.m7.1.2.3.1.3.2.cmml">k</mi><mo id="S3.SS1.p2.7.m7.1.2.3.1.3.1" xref="S3.SS1.p2.7.m7.1.2.3.1.3.1.cmml">∈</mo><msub id="S3.SS1.p2.7.m7.1.2.3.1.3.3" xref="S3.SS1.p2.7.m7.1.2.3.1.3.3.cmml"><mi id="S3.SS1.p2.7.m7.1.2.3.1.3.3.2" xref="S3.SS1.p2.7.m7.1.2.3.1.3.3.2.cmml">S</mi><mi id="S3.SS1.p2.7.m7.1.2.3.1.3.3.3" xref="S3.SS1.p2.7.m7.1.2.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="S3.SS1.p2.7.m7.1.2.3.2" xref="S3.SS1.p2.7.m7.1.2.3.2.cmml"><mfrac id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mn id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">1</mn><mrow id="S3.SS1.p2.7.m7.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.1.1.1.1.2" xref="S3.SS1.p2.7.m7.1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p2.7.m7.1.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.1.1.1.2" xref="S3.SS1.p2.7.m7.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS1.p2.7.m7.1.1.1.1.1.3" xref="S3.SS1.p2.7.m7.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS1.p2.7.m7.1.1.1.1.3" xref="S3.SS1.p2.7.m7.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m7.1.2.3.2.1" xref="S3.SS1.p2.7.m7.1.2.3.2.1.cmml">​</mo><msubsup id="S3.SS1.p2.7.m7.1.2.3.2.2" xref="S3.SS1.p2.7.m7.1.2.3.2.2.cmml"><mover accent="true" id="S3.SS1.p2.7.m7.1.2.3.2.2.2.2" xref="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.cmml"><mi id="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.2" xref="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.2.cmml">θ</mi><mo id="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.1" xref="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p2.7.m7.1.2.3.2.2.2.3" xref="S3.SS1.p2.7.m7.1.2.3.2.2.2.3.cmml">t</mi><mi id="S3.SS1.p2.7.m7.1.2.3.2.2.3" xref="S3.SS1.p2.7.m7.1.2.3.2.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.2.cmml" xref="S3.SS1.p2.7.m7.1.2"><ci id="S3.SS1.p2.7.m7.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.1">←</ci><apply id="S3.SS1.p2.7.m7.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.2.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2.2">𝜃</ci><apply id="S3.SS1.p2.7.m7.1.2.2.3.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3"><plus id="S3.SS1.p2.7.m7.1.2.2.3.1.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3.1"></plus><ci id="S3.SS1.p2.7.m7.1.2.2.3.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.7.m7.1.2.2.3.3.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.7.m7.1.2.3.cmml" xref="S3.SS1.p2.7.m7.1.2.3"><apply id="S3.SS1.p2.7.m7.1.2.3.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.3.1.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1">subscript</csymbol><sum id="S3.SS1.p2.7.m7.1.2.3.1.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.2"></sum><apply id="S3.SS1.p2.7.m7.1.2.3.1.3.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.3"><in id="S3.SS1.p2.7.m7.1.2.3.1.3.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.3.1"></in><ci id="S3.SS1.p2.7.m7.1.2.3.1.3.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.3.2">𝑘</ci><apply id="S3.SS1.p2.7.m7.1.2.3.1.3.3.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.3.1.3.3.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.2.3.1.3.3.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.3.3.2">𝑆</ci><ci id="S3.SS1.p2.7.m7.1.2.3.1.3.3.3.cmml" xref="S3.SS1.p2.7.m7.1.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.SS1.p2.7.m7.1.2.3.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2"><times id="S3.SS1.p2.7.m7.1.2.3.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.1"></times><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><divide id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1"></divide><cn type="integer" id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">1</cn><apply id="S3.SS1.p2.7.m7.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1"><abs id="S3.SS1.p2.7.m7.1.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.2"></abs><apply id="S3.SS1.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS1.p2.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.SS1.p2.7.m7.1.2.3.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.3.2.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2">superscript</csymbol><apply id="S3.SS1.p2.7.m7.1.2.3.2.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.3.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2">subscript</csymbol><apply id="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2.2.2"><ci id="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.1">^</ci><ci id="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2.2.2.2">𝜃</ci></apply><ci id="S3.SS1.p2.7.m7.1.2.3.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.7.m7.1.2.3.2.2.3.cmml" xref="S3.SS1.p2.7.m7.1.2.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">{\theta}_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{1}{|S_{t}|}\hat{{\theta}}_{t}^{k}</annotation></semantics></math>. These two procedures will repeat <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">T</annotation></semantics></math> rounds until the convergence.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Goals of Aggregation and Personalization</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.7" class="ltx_p">As in <cite class="ltx_cite ltx_citemacro_citep">(Hamer
et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>, a macroscopic analysis of FL using Bregman divergence as the loss function proves that ensemble models are optimal for the standard empirical risk minimization in FL. Specifically, we use <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">ℋ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">ℋ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{H}</annotation></semantics></math> to denote the hypothesis space, and its component <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="h\in\mathcal{H}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">h</mi><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">ℋ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><in id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></in><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">ℎ</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">h\in\mathcal{H}</annotation></semantics></math> is a map of the form <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="h:\mathcal{X}\rightarrow\Delta\mathcal{Y}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">h</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">:</mo><mrow id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">𝒳</mi><mo stretchy="false" id="S3.SS2.p1.3.m3.1.1.3.1" xref="S3.SS2.p1.3.m3.1.1.3.1.cmml">→</mo><mrow id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.SS2.p1.3.m3.1.1.3.3.2" xref="S3.SS2.p1.3.m3.1.1.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.1.3.3.1" xref="S3.SS2.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.3.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.3.cmml">𝒴</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><ci id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1">:</ci><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">ℎ</ci><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><ci id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.1">→</ci><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">𝒳</ci><apply id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3"><times id="S3.SS2.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS2.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.2">Δ</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3">𝒴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">h:\mathcal{X}\rightarrow\Delta\mathcal{Y}</annotation></semantics></math>, where <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathcal{X}</annotation></semantics></math> is the input space and <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\Delta\mathcal{Y}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><times id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1"></times><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">Δ</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\Delta\mathcal{Y}</annotation></semantics></math> is the probability simplex over the label space <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{Y}</annotation></semantics></math>. The loss of client <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">k</annotation></semantics></math> with Bregman divergence is defined as:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_math_unparsed" alttext="{\mathcal{L}^{k}_{\text{Bf}}}(h^{k})\triangleq B_{F}({\mathcal{D}^{k}}||h^{k})=F({\mathcal{D}^{k}})-F(h^{k})-\langle\nabla F(h^{k}),{\mathcal{D}^{k}}-h^{k}\rangle," display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1b"><msubsup id="S3.E3.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.2.2">ℒ</mi><mtext id="S3.E3.m1.1.1.3">Bf</mtext><mi id="S3.E3.m1.1.1.2.3">k</mi></msubsup><mrow id="S3.E3.m1.1.2"><mo stretchy="false" id="S3.E3.m1.1.2.1">(</mo><msup id="S3.E3.m1.1.2.2"><mi id="S3.E3.m1.1.2.2.2">h</mi><mi id="S3.E3.m1.1.2.2.3">k</mi></msup><mo stretchy="false" id="S3.E3.m1.1.2.3">)</mo></mrow><mo id="S3.E3.m1.1.3">≜</mo><msub id="S3.E3.m1.1.4"><mi id="S3.E3.m1.1.4.2">B</mi><mi id="S3.E3.m1.1.4.3">F</mi></msub><mrow id="S3.E3.m1.1.5"><mo stretchy="false" id="S3.E3.m1.1.5.1">(</mo><msup id="S3.E3.m1.1.5.2"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.5.2.2">𝒟</mi><mi id="S3.E3.m1.1.5.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E3.m1.1.5.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E3.m1.1.5.4">|</mo><msup id="S3.E3.m1.1.5.5"><mi id="S3.E3.m1.1.5.5.2">h</mi><mi id="S3.E3.m1.1.5.5.3">k</mi></msup><mo stretchy="false" id="S3.E3.m1.1.5.6">)</mo></mrow><mo id="S3.E3.m1.1.6">=</mo><mi id="S3.E3.m1.1.7">F</mi><mrow id="S3.E3.m1.1.8"><mo stretchy="false" id="S3.E3.m1.1.8.1">(</mo><msup id="S3.E3.m1.1.8.2"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.8.2.2">𝒟</mi><mi id="S3.E3.m1.1.8.2.3">k</mi></msup><mo stretchy="false" id="S3.E3.m1.1.8.3">)</mo></mrow><mo id="S3.E3.m1.1.9">−</mo><mi id="S3.E3.m1.1.10">F</mi><mrow id="S3.E3.m1.1.11"><mo stretchy="false" id="S3.E3.m1.1.11.1">(</mo><msup id="S3.E3.m1.1.11.2"><mi id="S3.E3.m1.1.11.2.2">h</mi><mi id="S3.E3.m1.1.11.2.3">k</mi></msup><mo stretchy="false" id="S3.E3.m1.1.11.3">)</mo></mrow><mo id="S3.E3.m1.1.12">−</mo><mrow id="S3.E3.m1.1.13"><mo stretchy="false" id="S3.E3.m1.1.13.1">⟨</mo><mo rspace="0.167em" id="S3.E3.m1.1.13.2">∇</mo><mi id="S3.E3.m1.1.13.3">F</mi><mrow id="S3.E3.m1.1.13.4"><mo stretchy="false" id="S3.E3.m1.1.13.4.1">(</mo><msup id="S3.E3.m1.1.13.4.2"><mi id="S3.E3.m1.1.13.4.2.2">h</mi><mi id="S3.E3.m1.1.13.4.2.3">k</mi></msup><mo stretchy="false" id="S3.E3.m1.1.13.4.3">)</mo></mrow><mo id="S3.E3.m1.1.13.5">,</mo><msup id="S3.E3.m1.1.13.6"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.13.6.2">𝒟</mi><mi id="S3.E3.m1.1.13.6.3">k</mi></msup><mo id="S3.E3.m1.1.13.7">−</mo><msup id="S3.E3.m1.1.13.8"><mi id="S3.E3.m1.1.13.8.2">h</mi><mi id="S3.E3.m1.1.13.8.3">k</mi></msup><mo stretchy="false" id="S3.E3.m1.1.13.9">⟩</mo></mrow><mo id="S3.E3.m1.1.14">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.1c">{\mathcal{L}^{k}_{\text{Bf}}}(h^{k})\triangleq B_{F}({\mathcal{D}^{k}}||h^{k})=F({\mathcal{D}^{k}})-F(h^{k})-\langle\nabla F(h^{k}),{\mathcal{D}^{k}}-h^{k}\rangle,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.11" class="ltx_p">where <math id="S3.SS2.p1.8.m1.1" class="ltx_Math" alttext="h^{k}" display="inline"><semantics id="S3.SS2.p1.8.m1.1a"><msup id="S3.SS2.p1.8.m1.1.1" xref="S3.SS2.p1.8.m1.1.1.cmml"><mi id="S3.SS2.p1.8.m1.1.1.2" xref="S3.SS2.p1.8.m1.1.1.2.cmml">h</mi><mi id="S3.SS2.p1.8.m1.1.1.3" xref="S3.SS2.p1.8.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m1.1b"><apply id="S3.SS2.p1.8.m1.1.1.cmml" xref="S3.SS2.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m1.1.1.1.cmml" xref="S3.SS2.p1.8.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.8.m1.1.1.2.cmml" xref="S3.SS2.p1.8.m1.1.1.2">ℎ</ci><ci id="S3.SS2.p1.8.m1.1.1.3.cmml" xref="S3.SS2.p1.8.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m1.1c">h^{k}</annotation></semantics></math> is the hypothesis on the <math id="S3.SS2.p1.9.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.9.m2.1a"><mi id="S3.SS2.p1.9.m2.1.1" xref="S3.SS2.p1.9.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m2.1b"><ci id="S3.SS2.p1.9.m2.1.1.cmml" xref="S3.SS2.p1.9.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m2.1c">k</annotation></semantics></math>th client, <math id="S3.SS2.p1.10.m3.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.SS2.p1.10.m3.1a"><mi id="S3.SS2.p1.10.m3.1.1" xref="S3.SS2.p1.10.m3.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m3.1b"><ci id="S3.SS2.p1.10.m3.1.1.cmml" xref="S3.SS2.p1.10.m3.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m3.1c">F</annotation></semantics></math> is a strictly convex function, and <math id="S3.SS2.p1.11.m4.2" class="ltx_Math" alttext="\langle\cdot,\cdot\rangle" display="inline"><semantics id="S3.SS2.p1.11.m4.2a"><mrow id="S3.SS2.p1.11.m4.2.3.2" xref="S3.SS2.p1.11.m4.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.11.m4.2.3.2.1" xref="S3.SS2.p1.11.m4.2.3.1.cmml">⟨</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.11.m4.1.1" xref="S3.SS2.p1.11.m4.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.p1.11.m4.2.3.2.2" xref="S3.SS2.p1.11.m4.2.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.11.m4.2.2" xref="S3.SS2.p1.11.m4.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p1.11.m4.2.3.2.3" xref="S3.SS2.p1.11.m4.2.3.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m4.2b"><list id="S3.SS2.p1.11.m4.2.3.1.cmml" xref="S3.SS2.p1.11.m4.2.3.2"><ci id="S3.SS2.p1.11.m4.1.1.cmml" xref="S3.SS2.p1.11.m4.1.1">⋅</ci><ci id="S3.SS2.p1.11.m4.2.2.cmml" xref="S3.SS2.p1.11.m4.2.2">⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m4.2c">\langle\cdot,\cdot\rangle</annotation></semantics></math> denotes the inner product. Then, the global target of standard FL is to minimize:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.2" class="ltx_math_unparsed" alttext="{\mathcal{L}_{\text{Bf}}}(h)\triangleq\sum_{k=1}^{K}p_{k}{\mathcal{L}^{k}_{\text{Bf}}}(h)=\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}^{k}}||h)," display="block"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2b"><msub id="S3.E4.m1.2.3"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.3.2">ℒ</mi><mtext id="S3.E4.m1.2.3.3">Bf</mtext></msub><mrow id="S3.E4.m1.2.4"><mo stretchy="false" id="S3.E4.m1.2.4.1">(</mo><mi id="S3.E4.m1.1.1">h</mi><mo stretchy="false" id="S3.E4.m1.2.4.2">)</mo></mrow><mo rspace="0.111em" id="S3.E4.m1.2.5">≜</mo><munderover id="S3.E4.m1.2.6"><mo movablelimits="false" id="S3.E4.m1.2.6.2.2">∑</mo><mrow id="S3.E4.m1.2.6.2.3"><mi id="S3.E4.m1.2.6.2.3.2">k</mi><mo id="S3.E4.m1.2.6.2.3.1">=</mo><mn id="S3.E4.m1.2.6.2.3.3">1</mn></mrow><mi id="S3.E4.m1.2.6.3">K</mi></munderover><msub id="S3.E4.m1.2.7"><mi id="S3.E4.m1.2.7.2">p</mi><mi id="S3.E4.m1.2.7.3">k</mi></msub><msubsup id="S3.E4.m1.2.8"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.8.2.2">ℒ</mi><mtext id="S3.E4.m1.2.8.3">Bf</mtext><mi id="S3.E4.m1.2.8.2.3">k</mi></msubsup><mrow id="S3.E4.m1.2.9"><mo stretchy="false" id="S3.E4.m1.2.9.1">(</mo><mi id="S3.E4.m1.2.2">h</mi><mo stretchy="false" id="S3.E4.m1.2.9.2">)</mo></mrow><mo rspace="0.111em" id="S3.E4.m1.2.10">=</mo><munderover id="S3.E4.m1.2.11"><mo movablelimits="false" id="S3.E4.m1.2.11.2.2">∑</mo><mrow id="S3.E4.m1.2.11.2.3"><mi id="S3.E4.m1.2.11.2.3.2">k</mi><mo id="S3.E4.m1.2.11.2.3.1">=</mo><mn id="S3.E4.m1.2.11.2.3.3">1</mn></mrow><mi id="S3.E4.m1.2.11.3">K</mi></munderover><msub id="S3.E4.m1.2.12"><mi id="S3.E4.m1.2.12.2">p</mi><mi id="S3.E4.m1.2.12.3">k</mi></msub><msub id="S3.E4.m1.2.13"><mi id="S3.E4.m1.2.13.2">B</mi><mi id="S3.E4.m1.2.13.3">F</mi></msub><mrow id="S3.E4.m1.2.14"><mo stretchy="false" id="S3.E4.m1.2.14.1">(</mo><msup id="S3.E4.m1.2.14.2"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.14.2.2">𝒟</mi><mi id="S3.E4.m1.2.14.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E4.m1.2.14.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E4.m1.2.14.4">|</mo><mi id="S3.E4.m1.2.14.5">h</mi><mo stretchy="false" id="S3.E4.m1.2.14.6">)</mo></mrow><mo id="S3.E4.m1.2.15">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E4.m1.2c">{\mathcal{L}_{\text{Bf}}}(h)\triangleq\sum_{k=1}^{K}p_{k}{\mathcal{L}^{k}_{\text{Bf}}}(h)=\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}^{k}}||h),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">The lemma below shows the optimality in FedAvg:</p>
</div>
<div id="S3.Thmtheorem1" class="ltx_theorem ltx_theorem_lemma">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Lemma 3.1 (Optimal Solution of FedAvg <cite class="ltx_cite ltx_citemacro_citep">(Hamer
et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>).</h6>
<div id="S3.Thmtheorem1.p1" class="ltx_para">
<p id="S3.Thmtheorem1.p1.6" class="ltx_p"><span id="S3.Thmtheorem1.p1.6.6" class="ltx_text ltx_font_italic">Suppose the loss is a Bregman divergence <math id="S3.Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="B_{F}" display="inline"><semantics id="S3.Thmtheorem1.p1.1.1.m1.1a"><msub id="S3.Thmtheorem1.p1.1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.1.1.m1.1.1.2" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.2.cmml">B</mi><mi id="S3.Thmtheorem1.p1.1.1.m1.1.1.3" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.1.m1.1b"><apply id="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.2">𝐵</ci><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.1.m1.1c">B_{F}</annotation></semantics></math>, let <math id="S3.Thmtheorem1.p1.2.2.m2.1" class="ltx_Math" alttext="p\in\Lambda" display="inline"><semantics id="S3.Thmtheorem1.p1.2.2.m2.1a"><mrow id="S3.Thmtheorem1.p1.2.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="S3.Thmtheorem1.p1.2.2.m2.1.1.2" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">p</mi><mo id="S3.Thmtheorem1.p1.2.2.m2.1.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.1.cmml">∈</mo><mi mathvariant="normal" id="S3.Thmtheorem1.p1.2.2.m2.1.1.3" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.3.cmml">Λ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.2.m2.1b"><apply id="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1"><in id="S3.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.1"></in><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.2">𝑝</ci><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.3">Λ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.2.m2.1c">p\in\Lambda</annotation></semantics></math> be fixed and <math id="S3.Thmtheorem1.p1.3.3.m3.1" class="ltx_Math" alttext="\sum_{k=1}^{K}p_{k}{\mathcal{D}^{k}}\in\mathcal{H}" display="inline"><semantics id="S3.Thmtheorem1.p1.3.3.m3.1a"><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.cmml"><msubsup id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.cmml"><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.2.cmml">k</mi><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.3.cmml">K</mi></msubsup><mrow id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.cmml"><msub id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.2.cmml">p</mi><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.1.cmml">​</mo><msup id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.2.cmml">𝒟</mi><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.3.cmml">k</mi></msup></mrow></mrow><mo id="S3.Thmtheorem1.p1.3.3.m3.1.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.cmml">ℋ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.3.m3.1b"><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1"><in id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.1"></in><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2"><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1">superscript</csymbol><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1">subscript</csymbol><sum id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.2"></sum><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3"><eq id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.1"></eq><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.1.3">𝐾</ci></apply><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2"><times id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.1"></times><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.2">𝑝</ci><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.2.3">𝑘</ci></apply><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3">superscript</csymbol><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.2">𝒟</ci><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.2.3.3">𝑘</ci></apply></apply></apply><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.3.m3.1c">\sum_{k=1}^{K}p_{k}{\mathcal{D}^{k}}\in\mathcal{H}</annotation></semantics></math>. Then <math id="S3.Thmtheorem1.p1.4.4.m4.1" class="ltx_Math" alttext="h^{*}=\sum_{k=1}^{K}p_{k}{\mathcal{D}^{k}}" display="inline"><semantics id="S3.Thmtheorem1.p1.4.4.m4.1a"><mrow id="S3.Thmtheorem1.p1.4.4.m4.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.cmml"><msup id="S3.Thmtheorem1.p1.4.4.m4.1.1.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2.cmml"><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.2.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2.2.cmml">h</mi><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.2.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2.3.cmml">∗</mo></msup><mo rspace="0.111em" id="S3.Thmtheorem1.p1.4.4.m4.1.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1.cmml">=</mo><mrow id="S3.Thmtheorem1.p1.4.4.m4.1.1.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.cmml"><msubsup id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.cmml"><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.cmml"><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.cmml"><msub id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.cmml"><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.2.cmml">p</mi><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.1.cmml">​</mo><msup id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.2.cmml">𝒟</mi><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.3.cmml">k</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.4.4.m4.1b"><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1"><eq id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.1"></eq><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2">superscript</csymbol><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2.2">ℎ</ci><times id="S3.Thmtheorem1.p1.4.4.m4.1.1.2.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2.3"></times></apply><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3"><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1">superscript</csymbol><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1">subscript</csymbol><sum id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.2"></sum><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3"><eq id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.1"></eq><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.1.3">𝐾</ci></apply><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2"><times id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.1"></times><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.2">𝑝</ci><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3">superscript</csymbol><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.2">𝒟</ci><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.4.4.m4.1c">h^{*}=\sum_{k=1}^{K}p_{k}{\mathcal{D}^{k}}</annotation></semantics></math> is a minimizer of <math id="S3.Thmtheorem1.p1.5.5.m5.1" class="ltx_math_unparsed" alttext="\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}^{k}}||h)" display="inline"><semantics id="S3.Thmtheorem1.p1.5.5.m5.1a"><mrow id="S3.Thmtheorem1.p1.5.5.m5.1b"><msubsup id="S3.Thmtheorem1.p1.5.5.m5.1.1"><mo id="S3.Thmtheorem1.p1.5.5.m5.1.1.2.2">∑</mo><mrow id="S3.Thmtheorem1.p1.5.5.m5.1.1.2.3"><mi id="S3.Thmtheorem1.p1.5.5.m5.1.1.2.3.2">k</mi><mo id="S3.Thmtheorem1.p1.5.5.m5.1.1.2.3.1">=</mo><mn id="S3.Thmtheorem1.p1.5.5.m5.1.1.2.3.3">1</mn></mrow><mi id="S3.Thmtheorem1.p1.5.5.m5.1.1.3">K</mi></msubsup><msub id="S3.Thmtheorem1.p1.5.5.m5.1.2"><mi id="S3.Thmtheorem1.p1.5.5.m5.1.2.2">p</mi><mi id="S3.Thmtheorem1.p1.5.5.m5.1.2.3">k</mi></msub><msub id="S3.Thmtheorem1.p1.5.5.m5.1.3"><mi id="S3.Thmtheorem1.p1.5.5.m5.1.3.2">B</mi><mi id="S3.Thmtheorem1.p1.5.5.m5.1.3.3">F</mi></msub><mrow id="S3.Thmtheorem1.p1.5.5.m5.1.4"><mo stretchy="false" id="S3.Thmtheorem1.p1.5.5.m5.1.4.1">(</mo><msup id="S3.Thmtheorem1.p1.5.5.m5.1.4.2"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.5.5.m5.1.4.2.2">𝒟</mi><mi id="S3.Thmtheorem1.p1.5.5.m5.1.4.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.Thmtheorem1.p1.5.5.m5.1.4.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.Thmtheorem1.p1.5.5.m5.1.4.4">|</mo><mi id="S3.Thmtheorem1.p1.5.5.m5.1.4.5">h</mi><mo stretchy="false" id="S3.Thmtheorem1.p1.5.5.m5.1.4.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.5.5.m5.1c">\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}^{k}}||h)</annotation></semantics></math>. Furthermore, if <math id="S3.Thmtheorem1.p1.6.6.m6.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.Thmtheorem1.p1.6.6.m6.1a"><mi id="S3.Thmtheorem1.p1.6.6.m6.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.6.6.m6.1b"><ci id="S3.Thmtheorem1.p1.6.6.m6.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.6.6.m6.1c">F</annotation></semantics></math> is strictly convex, then the minimizer is unique.</span></p>
</div>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.3" class="ltx_p">This inspires that some standard FL algorithms only aim to obtain a tradeoff solution among heterogeneous clients, which is not the optimal solution for some local clients. An obvious fact is that the <math id="S3.SS2.p3.1.m1.1" class="ltx_math_unparsed" alttext="B_{F}({\mathcal{D}^{k}}||h^{*})=B_{F}({\mathcal{D}^{k}}||\sum_{k=1}^{K}p_{k}{\mathcal{D}^{k}})" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1b"><msub id="S3.SS2.p3.1.m1.1.1"><mi id="S3.SS2.p3.1.m1.1.1.2">B</mi><mi id="S3.SS2.p3.1.m1.1.1.3">F</mi></msub><mrow id="S3.SS2.p3.1.m1.1.2"><mo stretchy="false" id="S3.SS2.p3.1.m1.1.2.1">(</mo><msup id="S3.SS2.p3.1.m1.1.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.2.2.2">𝒟</mi><mi id="S3.SS2.p3.1.m1.1.2.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS2.p3.1.m1.1.2.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS2.p3.1.m1.1.2.4">|</mo><msup id="S3.SS2.p3.1.m1.1.2.5"><mi id="S3.SS2.p3.1.m1.1.2.5.2">h</mi><mo id="S3.SS2.p3.1.m1.1.2.5.3">∗</mo></msup><mo stretchy="false" id="S3.SS2.p3.1.m1.1.2.6">)</mo></mrow><mo id="S3.SS2.p3.1.m1.1.3">=</mo><msub id="S3.SS2.p3.1.m1.1.4"><mi id="S3.SS2.p3.1.m1.1.4.2">B</mi><mi id="S3.SS2.p3.1.m1.1.4.3">F</mi></msub><mrow id="S3.SS2.p3.1.m1.1.5"><mo stretchy="false" id="S3.SS2.p3.1.m1.1.5.1">(</mo><msup id="S3.SS2.p3.1.m1.1.5.2"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.5.2.2">𝒟</mi><mi id="S3.SS2.p3.1.m1.1.5.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS2.p3.1.m1.1.5.3">|</mo><mo fence="false" stretchy="false" id="S3.SS2.p3.1.m1.1.5.4">|</mo><msubsup id="S3.SS2.p3.1.m1.1.5.5"><mo id="S3.SS2.p3.1.m1.1.5.5.2.2">∑</mo><mrow id="S3.SS2.p3.1.m1.1.5.5.2.3"><mi id="S3.SS2.p3.1.m1.1.5.5.2.3.2">k</mi><mo id="S3.SS2.p3.1.m1.1.5.5.2.3.1">=</mo><mn id="S3.SS2.p3.1.m1.1.5.5.2.3.3">1</mn></mrow><mi id="S3.SS2.p3.1.m1.1.5.5.3">K</mi></msubsup><msub id="S3.SS2.p3.1.m1.1.5.6"><mi id="S3.SS2.p3.1.m1.1.5.6.2">p</mi><mi id="S3.SS2.p3.1.m1.1.5.6.3">k</mi></msub><msup id="S3.SS2.p3.1.m1.1.5.7"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.5.7.2">𝒟</mi><mi id="S3.SS2.p3.1.m1.1.5.7.3">k</mi></msup><mo stretchy="false" id="S3.SS2.p3.1.m1.1.5.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">B_{F}({\mathcal{D}^{k}}||h^{*})=B_{F}({\mathcal{D}^{k}}||\sum_{k=1}^{K}p_{k}{\mathcal{D}^{k}})</annotation></semantics></math> could be very large if the local data distribution <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="{\mathcal{D}^{k}}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msup id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝒟</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">{\mathcal{D}^{k}}</annotation></semantics></math> is totally distinct from the “global distribution”, i.e., <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\sum_{k=1}^{K}p_{k}{\mathcal{D}^{k}}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mrow id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><msubsup id="S3.SS2.p3.3.m3.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.cmml"><mo id="S3.SS2.p3.3.m3.1.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p3.3.m3.1.1.1.2.3" xref="S3.SS2.p3.3.m3.1.1.1.2.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.1.2.3.2" xref="S3.SS2.p3.3.m3.1.1.1.2.3.2.cmml">k</mi><mo id="S3.SS2.p3.3.m3.1.1.1.2.3.1" xref="S3.SS2.p3.3.m3.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.3.m3.1.1.1.2.3.3" xref="S3.SS2.p3.3.m3.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p3.3.m3.1.1.1.3" xref="S3.SS2.p3.3.m3.1.1.1.3.cmml">K</mi></msubsup><mrow id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml"><msub id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.2.cmml">p</mi><mi id="S3.SS2.p3.3.m3.1.1.2.2.3" xref="S3.SS2.p3.3.m3.1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p3.3.m3.1.1.2.1" xref="S3.SS2.p3.3.m3.1.1.2.1.cmml">​</mo><msup id="S3.SS2.p3.3.m3.1.1.2.3" xref="S3.SS2.p3.3.m3.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.2.3.2" xref="S3.SS2.p3.3.m3.1.1.2.3.2.cmml">𝒟</mi><mi id="S3.SS2.p3.3.m3.1.1.2.3.3" xref="S3.SS2.p3.3.m3.1.1.2.3.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><apply id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1">superscript</csymbol><apply id="S3.SS2.p3.3.m3.1.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1">subscript</csymbol><sum id="S3.SS2.p3.3.m3.1.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.1.2.2"></sum><apply id="S3.SS2.p3.3.m3.1.1.1.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.1.2.3"><eq id="S3.SS2.p3.3.m3.1.1.1.2.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.2.3.1"></eq><ci id="S3.SS2.p3.3.m3.1.1.1.2.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.3.m3.1.1.1.2.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p3.3.m3.1.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.1.3">𝐾</ci></apply><apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2"><times id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2.1"></times><apply id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.2.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2.2">𝑝</ci><ci id="S3.SS2.p3.3.m3.1.1.2.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.2.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3.2">𝒟</ci><ci id="S3.SS2.p3.3.m3.1.1.2.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\sum_{k=1}^{K}p_{k}{\mathcal{D}^{k}}</annotation></semantics></math>. This implies that the standard FL algorithms could not satisfy all users via a single global model. From another aspect, paying efforts to accomplish the aggregation goal may not necessarily meet the personalization performances required by local clients. Therefore, an effective FL method should focus on both aggregation and personalization performances. We formally present the goals and corresponding metrics of aggregation and personalization as follows:</p>
</div>
<div id="S3.Thmtheorem2" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_theorem">Definition 3.2 (Goal of Aggregation in FL).</h6>
<div id="S3.Thmtheorem2.p1" class="ltx_para">
<p id="S3.Thmtheorem2.p1.3" class="ltx_p">Suppose we have a global test set <math id="S3.Thmtheorem2.p1.1.m1.1" class="ltx_Math" alttext="{D_{\text{te}}}=\{({\mathbf{x}}_{i},y_{i})\}_{i=1}^{M}" display="inline"><semantics id="S3.Thmtheorem2.p1.1.m1.1a"><mrow id="S3.Thmtheorem2.p1.1.m1.1.1" xref="S3.Thmtheorem2.p1.1.m1.1.1.cmml"><msub id="S3.Thmtheorem2.p1.1.m1.1.1.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.cmml"><mi id="S3.Thmtheorem2.p1.1.m1.1.1.3.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.2.cmml">D</mi><mtext id="S3.Thmtheorem2.p1.1.m1.1.1.3.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.3a.cmml">te</mtext></msub><mo id="S3.Thmtheorem2.p1.1.m1.1.1.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.2.cmml">=</mo><msubsup id="S3.Thmtheorem2.p1.1.m1.1.1.1" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.cmml"><mrow id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.4" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.5" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.cmml"><mi id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.1" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.Thmtheorem2.p1.1.m1.1.1.1.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.1.m1.1b"><apply id="S3.Thmtheorem2.p1.1.m1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1"><eq id="S3.Thmtheorem2.p1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.2"></eq><apply id="S3.Thmtheorem2.p1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.m1.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.Thmtheorem2.p1.1.m1.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.2">𝐷</ci><ci id="S3.Thmtheorem2.p1.1.m1.1.1.3.3a.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.3"><mtext mathsize="70%" id="S3.Thmtheorem2.p1.1.m1.1.1.3.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.3">te</mtext></ci></apply><apply id="S3.Thmtheorem2.p1.1.m1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.m1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1">superscript</csymbol><apply id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1">subscript</csymbol><set id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1"><interval closure="open" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2"><apply id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3"><eq id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.1"></eq><ci id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.Thmtheorem2.p1.1.m1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.1.m1.1c">{D_{\text{te}}}=\{({\mathbf{x}}_{i},y_{i})\}_{i=1}^{M}</annotation></semantics></math> on the parameter server. We calculate the classification accuracy of the <span id="S3.Thmtheorem2.p1.3.1" class="ltx_text ltx_font_italic">aggregated model</span> in the <math id="S3.Thmtheorem2.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.Thmtheorem2.p1.2.m2.1a"><mi id="S3.Thmtheorem2.p1.2.m2.1.1" xref="S3.Thmtheorem2.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.2.m2.1b"><ci id="S3.Thmtheorem2.p1.2.m2.1.1.cmml" xref="S3.Thmtheorem2.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.2.m2.1c">t</annotation></semantics></math>th round to evaluate the quality of aggregation, i.e., <math id="S3.Thmtheorem2.p1.3.m3.1" class="ltx_Math" alttext="\text{Ag}_{t}\triangleq\frac{1}{M}\sum_{i=1}^{M}\mathcal{I}\{\arg\max f({\mathbf{x}}_{i};{\theta}_{t+1})=y_{i}\}" display="inline"><semantics id="S3.Thmtheorem2.p1.3.m3.1a"><mrow id="S3.Thmtheorem2.p1.3.m3.1.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.cmml"><msub id="S3.Thmtheorem2.p1.3.m3.1.1.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.3.cmml"><mtext id="S3.Thmtheorem2.p1.3.m3.1.1.3.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.3.2a.cmml">Ag</mtext><mi id="S3.Thmtheorem2.p1.3.m3.1.1.3.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.3.3.cmml">t</mi></msub><mo id="S3.Thmtheorem2.p1.3.m3.1.1.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.2.cmml">≜</mo><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.cmml"><mfrac id="S3.Thmtheorem2.p1.3.m3.1.1.1.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.3.cmml"><mn id="S3.Thmtheorem2.p1.3.m3.1.1.1.3.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.3.2.cmml">1</mn><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.3.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.3.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.Thmtheorem2.p1.3.m3.1.1.1.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.2.cmml">​</mo><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.cmml"><msubsup id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.cmml"><mo id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.cmml"><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.3.cmml">M</mi></msubsup><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.3.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.1.cmml">arg</mi><mo lspace="0.167em" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4a" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.cmml">⁡</mo><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.cmml"><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.1.cmml">max</mi><mo lspace="0.167em" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2a" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.cmml">⁡</mo><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.2.cmml">f</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.3.cmml">;</mo><msub id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mrow id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.1" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml">+</mo><mn id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.5" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.3.cmml">=</mo><msub id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.2" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.2.cmml">y</mi><mi id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.3.m3.1b"><apply id="S3.Thmtheorem2.p1.3.m3.1.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1"><ci id="S3.Thmtheorem2.p1.3.m3.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.2">≜</ci><apply id="S3.Thmtheorem2.p1.3.m3.1.1.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.m3.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.Thmtheorem2.p1.3.m3.1.1.3.2a.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.3.2"><mtext id="S3.Thmtheorem2.p1.3.m3.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.3.2">Ag</mtext></ci><ci id="S3.Thmtheorem2.p1.3.m3.1.1.3.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.3.3">𝑡</ci></apply><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1"><times id="S3.Thmtheorem2.p1.3.m3.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.2"></times><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.3"><divide id="S3.Thmtheorem2.p1.3.m3.1.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.3"></divide><cn type="integer" id="S3.Thmtheorem2.p1.3.m3.1.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.3.2">1</cn><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.3.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.3.3">𝑀</ci></apply><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1"><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2">superscript</csymbol><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2">subscript</csymbol><sum id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.2"></sum><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3"><eq id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.1"></eq><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1"><times id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.2"></times><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.3">ℐ</ci><set id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1"><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1"><eq id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.3"></eq><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2"><times id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.3"></times><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4"><arg id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.1"></arg><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2"><max id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.1"></max><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.4.2.2">𝑓</ci></apply></apply><list id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2"><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.2">𝜃</ci><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3"><plus id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.1"></plus><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.2.2.2.2.3.3">1</cn></apply></apply></list></apply><apply id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.2">𝑦</ci><ci id="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.Thmtheorem2.p1.3.m3.1.1.1.1.1.1.1.1.4.3">𝑖</ci></apply></apply></set></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.3.m3.1c">\text{Ag}_{t}\triangleq\frac{1}{M}\sum_{i=1}^{M}\mathcal{I}\{\arg\max f({\mathbf{x}}_{i};{\theta}_{t+1})=y_{i}\}</annotation></semantics></math>.</p>
</div>
</div>
<div id="S3.Thmtheorem3" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_theorem">Definition 3.3 (Goal of Personalization in FL).</h6>
<div id="S3.Thmtheorem3.p1" class="ltx_para">
<p id="S3.Thmtheorem3.p1.6" class="ltx_p">Suppose we have a local test set <math id="S3.Thmtheorem3.p1.1.m1.1" class="ltx_Math" alttext="{D^{k}_{\text{te}}}=\{({\mathbf{x}}_{i}^{k},y_{i}^{k})\}_{i=1}^{{N^{k}_{\text{te}}}}" display="inline"><semantics id="S3.Thmtheorem3.p1.1.m1.1a"><mrow id="S3.Thmtheorem3.p1.1.m1.1.1" xref="S3.Thmtheorem3.p1.1.m1.1.1.cmml"><msubsup id="S3.Thmtheorem3.p1.1.m1.1.1.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.3.cmml"><mi id="S3.Thmtheorem3.p1.1.m1.1.1.3.2.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.3.2.2.cmml">D</mi><mtext id="S3.Thmtheorem3.p1.1.m1.1.1.3.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.3.3a.cmml">te</mtext><mi id="S3.Thmtheorem3.p1.1.m1.1.1.3.2.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.3.2.3.cmml">k</mi></msubsup><mo id="S3.Thmtheorem3.p1.1.m1.1.1.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.2.cmml">=</mo><msubsup id="S3.Thmtheorem3.p1.1.m1.1.1.1" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.cmml"><mrow id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.4" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.5" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.cmml"><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.1" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><msubsup id="S3.Thmtheorem3.p1.1.m1.1.1.1.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3.cmml"><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.2" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.2.cmml">N</mi><mtext id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3.3a.cmml">te</mtext><mi id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.3" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.3.cmml">k</mi></msubsup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.1.m1.1b"><apply id="S3.Thmtheorem3.p1.1.m1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1"><eq id="S3.Thmtheorem3.p1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.2"></eq><apply id="S3.Thmtheorem3.p1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.3.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.3">subscript</csymbol><apply id="S3.Thmtheorem3.p1.1.m1.1.1.3.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.3.2.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.Thmtheorem3.p1.1.m1.1.1.3.2.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.3.2.2">𝐷</ci><ci id="S3.Thmtheorem3.p1.1.m1.1.1.3.2.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.Thmtheorem3.p1.1.m1.1.1.3.3a.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.3.3"><mtext mathsize="70%" id="S3.Thmtheorem3.p1.1.m1.1.1.3.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.3.3">te</mtext></ci></apply><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1">superscript</csymbol><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1">subscript</csymbol><set id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1"><interval closure="open" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2"><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3"><eq id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.1"></eq><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3">subscript</csymbol><apply id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.1.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3">superscript</csymbol><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.2.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.2">𝑁</ci><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.3a.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3.3"><mtext mathsize="50%" id="S3.Thmtheorem3.p1.1.m1.1.1.1.3.3.cmml" xref="S3.Thmtheorem3.p1.1.m1.1.1.1.3.3">te</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.1.m1.1c">{D^{k}_{\text{te}}}=\{({\mathbf{x}}_{i}^{k},y_{i}^{k})\}_{i=1}^{{N^{k}_{\text{te}}}}</annotation></semantics></math> on the <math id="S3.Thmtheorem3.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.Thmtheorem3.p1.2.m2.1a"><mi id="S3.Thmtheorem3.p1.2.m2.1.1" xref="S3.Thmtheorem3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.2.m2.1b"><ci id="S3.Thmtheorem3.p1.2.m2.1.1.cmml" xref="S3.Thmtheorem3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.2.m2.1c">k</annotation></semantics></math>th client, then we can obtain the performance of the <span id="S3.Thmtheorem3.p1.6.1" class="ltx_text ltx_font_italic">personalized model</span> with parameters <math id="S3.Thmtheorem3.p1.3.m3.1" class="ltx_Math" alttext="\hat{{\theta}_{t}^{k}}" display="inline"><semantics id="S3.Thmtheorem3.p1.3.m3.1a"><mover accent="true" id="S3.Thmtheorem3.p1.3.m3.1.1" xref="S3.Thmtheorem3.p1.3.m3.1.1.cmml"><msubsup id="S3.Thmtheorem3.p1.3.m3.1.1.2" xref="S3.Thmtheorem3.p1.3.m3.1.1.2.cmml"><mi id="S3.Thmtheorem3.p1.3.m3.1.1.2.2.2" xref="S3.Thmtheorem3.p1.3.m3.1.1.2.2.2.cmml">θ</mi><mi id="S3.Thmtheorem3.p1.3.m3.1.1.2.2.3" xref="S3.Thmtheorem3.p1.3.m3.1.1.2.2.3.cmml">t</mi><mi id="S3.Thmtheorem3.p1.3.m3.1.1.2.3" xref="S3.Thmtheorem3.p1.3.m3.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.Thmtheorem3.p1.3.m3.1.1.1" xref="S3.Thmtheorem3.p1.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.3.m3.1b"><apply id="S3.Thmtheorem3.p1.3.m3.1.1.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1"><ci id="S3.Thmtheorem3.p1.3.m3.1.1.1.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1.1">^</ci><apply id="S3.Thmtheorem3.p1.3.m3.1.1.2.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.3.m3.1.1.2.1.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1.2">superscript</csymbol><apply id="S3.Thmtheorem3.p1.3.m3.1.1.2.2.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.3.m3.1.1.2.2.1.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.Thmtheorem3.p1.3.m3.1.1.2.2.2.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1.2.2.2">𝜃</ci><ci id="S3.Thmtheorem3.p1.3.m3.1.1.2.2.3.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1.2.2.3">𝑡</ci></apply><ci id="S3.Thmtheorem3.p1.3.m3.1.1.2.3.cmml" xref="S3.Thmtheorem3.p1.3.m3.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.3.m3.1c">\hat{{\theta}_{t}^{k}}</annotation></semantics></math> in the <math id="S3.Thmtheorem3.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.Thmtheorem3.p1.4.m4.1a"><mi id="S3.Thmtheorem3.p1.4.m4.1.1" xref="S3.Thmtheorem3.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.4.m4.1b"><ci id="S3.Thmtheorem3.p1.4.m4.1.1.cmml" xref="S3.Thmtheorem3.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.4.m4.1c">t</annotation></semantics></math>th round, i.e., <math id="S3.Thmtheorem3.p1.5.m5.1" class="ltx_Math" alttext="\text{Ap}_{t}^{k}\triangleq\frac{1}{{N^{k}_{\text{te}}}}\sum_{i=1}^{{N^{k}_{\text{te}}}}\mathcal{I}\{\arg\max f({\mathbf{x}}_{i}^{k};\hat{{\theta}}_{t}^{k})=y_{i}^{k}\}" display="inline"><semantics id="S3.Thmtheorem3.p1.5.m5.1a"><mrow id="S3.Thmtheorem3.p1.5.m5.1.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.cmml"><msubsup id="S3.Thmtheorem3.p1.5.m5.1.1.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.3.cmml"><mtext id="S3.Thmtheorem3.p1.5.m5.1.1.3.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.3.2.2a.cmml">Ap</mtext><mi id="S3.Thmtheorem3.p1.5.m5.1.1.3.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.3.2.3.cmml">t</mi><mi id="S3.Thmtheorem3.p1.5.m5.1.1.3.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.3.3.cmml">k</mi></msubsup><mo id="S3.Thmtheorem3.p1.5.m5.1.1.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.2.cmml">≜</mo><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.cmml"><mfrac id="S3.Thmtheorem3.p1.5.m5.1.1.1.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.cmml"><mn id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.2.cmml">1</mn><msubsup id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.cmml"><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.2.cmml">N</mi><mtext id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.3a.cmml">te</mtext><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.3.cmml">k</mi></msubsup></mfrac><mo lspace="0em" rspace="0em" id="S3.Thmtheorem3.p1.5.m5.1.1.1.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.2.cmml">​</mo><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.cmml"><msubsup id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.cmml"><mo id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.cmml"><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msubsup id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.cmml"><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.2.cmml">N</mi><mtext id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.3a.cmml">te</mtext><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.3.cmml">k</mi></msubsup></msubsup><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.3.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.1.cmml">arg</mi><mo lspace="0.167em" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4a" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.cmml">⁡</mo><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.cmml"><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.1.cmml">max</mi><mo lspace="0.167em" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2a" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.cmml">⁡</mo><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.2.cmml">f</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.3.cmml">;</mo><msubsup id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">θ</mi><mo id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.1" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">t</mi><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.5" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.3.cmml">=</mo><msubsup id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.2" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.2.cmml">y</mi><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.3.cmml">i</mi><mi id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.5.m5.1b"><apply id="S3.Thmtheorem3.p1.5.m5.1.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1"><ci id="S3.Thmtheorem3.p1.5.m5.1.1.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.2">≜</ci><apply id="S3.Thmtheorem3.p1.5.m5.1.1.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.3.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.3">superscript</csymbol><apply id="S3.Thmtheorem3.p1.5.m5.1.1.3.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.3.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.3">subscript</csymbol><ci id="S3.Thmtheorem3.p1.5.m5.1.1.3.2.2a.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.3.2.2"><mtext id="S3.Thmtheorem3.p1.5.m5.1.1.3.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.3.2.2">Ap</mtext></ci><ci id="S3.Thmtheorem3.p1.5.m5.1.1.3.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.3.2.3">𝑡</ci></apply><ci id="S3.Thmtheorem3.p1.5.m5.1.1.3.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.3.3">𝑘</ci></apply><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1"><times id="S3.Thmtheorem3.p1.5.m5.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.2"></times><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3"><divide id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3"></divide><cn type="integer" id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.2">1</cn><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3">subscript</csymbol><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3">superscript</csymbol><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.2">𝑁</ci><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.2.3">𝑘</ci></apply><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.3a.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.3"><mtext mathsize="50%" id="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.3.3.3">te</mtext></ci></apply></apply><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1"><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2">superscript</csymbol><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2">subscript</csymbol><sum id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.2"></sum><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3"><eq id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.1"></eq><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3">subscript</csymbol><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3">superscript</csymbol><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.2">𝑁</ci><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.2.3">𝑘</ci></apply><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.3a.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.3"><mtext mathsize="50%" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.2.3.3">te</mtext></ci></apply></apply><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1"><times id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.2"></times><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.3">ℐ</ci><set id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1"><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1"><eq id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.3"></eq><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2"><times id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.3"></times><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4"><arg id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.1"></arg><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2"><max id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.1"></max><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.4.2.2">𝑓</ci></apply></apply><list id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2"><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2"><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.1">^</ci><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.2.2">𝜃</ci></apply><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></list></apply><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.2">𝑦</ci><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.Thmtheorem3.p1.5.m5.1.1.1.1.1.1.1.1.4.3">𝑘</ci></apply></apply></set></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.5.m5.1c">\text{Ap}_{t}^{k}\triangleq\frac{1}{{N^{k}_{\text{te}}}}\sum_{i=1}^{{N^{k}_{\text{te}}}}\mathcal{I}\{\arg\max f({\mathbf{x}}_{i}^{k};\hat{{\theta}}_{t}^{k})=y_{i}^{k}\}</annotation></semantics></math>. Then we average the personalization accuracies across selected clients as the personalization performance, i.e., <math id="S3.Thmtheorem3.p1.6.m6.1" class="ltx_Math" alttext="\text{Ap}_{t}\triangleq\sum_{k\in S_{t}}\frac{1}{|S_{t}|}\text{Ap}_{t}^{k}" display="inline"><semantics id="S3.Thmtheorem3.p1.6.m6.1a"><mrow id="S3.Thmtheorem3.p1.6.m6.1.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.cmml"><msub id="S3.Thmtheorem3.p1.6.m6.1.2.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.2.cmml"><mtext id="S3.Thmtheorem3.p1.6.m6.1.2.2.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.2.2a.cmml">Ap</mtext><mi id="S3.Thmtheorem3.p1.6.m6.1.2.2.3" xref="S3.Thmtheorem3.p1.6.m6.1.2.2.3.cmml">t</mi></msub><mo rspace="0.111em" id="S3.Thmtheorem3.p1.6.m6.1.2.1" xref="S3.Thmtheorem3.p1.6.m6.1.2.1.cmml">≜</mo><mrow id="S3.Thmtheorem3.p1.6.m6.1.2.3" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.cmml"><msub id="S3.Thmtheorem3.p1.6.m6.1.2.3.1" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.cmml"><mo id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.2.cmml">∑</mo><mrow id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.cmml"><mi id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.2.cmml">k</mi><mo id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.1" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.1.cmml">∈</mo><msub id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.cmml"><mi id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.2.cmml">S</mi><mi id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.3" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="S3.Thmtheorem3.p1.6.m6.1.2.3.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.cmml"><mfrac id="S3.Thmtheorem3.p1.6.m6.1.1" xref="S3.Thmtheorem3.p1.6.m6.1.1.cmml"><mn id="S3.Thmtheorem3.p1.6.m6.1.1.3" xref="S3.Thmtheorem3.p1.6.m6.1.1.3.cmml">1</mn><mrow id="S3.Thmtheorem3.p1.6.m6.1.1.1.1" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.2" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.2.1.cmml">|</mo><msub id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.2" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.2.cmml">S</mi><mi id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.3" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.3" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.1" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.1.cmml">​</mo><msubsup id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.cmml"><mtext id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.2" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.2a.cmml">Ap</mtext><mi id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.3" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.3.cmml">t</mi><mi id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.3" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem3.p1.6.m6.1b"><apply id="S3.Thmtheorem3.p1.6.m6.1.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2"><ci id="S3.Thmtheorem3.p1.6.m6.1.2.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.1">≜</ci><apply id="S3.Thmtheorem3.p1.6.m6.1.2.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.6.m6.1.2.2.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.2">subscript</csymbol><ci id="S3.Thmtheorem3.p1.6.m6.1.2.2.2a.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.2.2"><mtext id="S3.Thmtheorem3.p1.6.m6.1.2.2.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.2.2">Ap</mtext></ci><ci id="S3.Thmtheorem3.p1.6.m6.1.2.2.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.2.3">𝑡</ci></apply><apply id="S3.Thmtheorem3.p1.6.m6.1.2.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3"><apply id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1">subscript</csymbol><sum id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.2"></sum><apply id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3"><in id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.1"></in><ci id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.2">𝑘</ci><apply id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3">subscript</csymbol><ci id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.2">𝑆</ci><ci id="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2"><times id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.1"></times><apply id="S3.Thmtheorem3.p1.6.m6.1.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1"><divide id="S3.Thmtheorem3.p1.6.m6.1.1.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1"></divide><cn type="integer" id="S3.Thmtheorem3.p1.6.m6.1.1.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1.3">1</cn><apply id="S3.Thmtheorem3.p1.6.m6.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1"><abs id="S3.Thmtheorem3.p1.6.m6.1.1.1.2.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1.2"></abs><apply id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.2">𝑆</ci><ci id="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2">superscript</csymbol><apply id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.1.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2">subscript</csymbol><ci id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.2a.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.2"><mtext id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.2.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.2">Ap</mtext></ci><ci id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.2.3">𝑡</ci></apply><ci id="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.3.cmml" xref="S3.Thmtheorem3.p1.6.m6.1.2.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem3.p1.6.m6.1c">\text{Ap}_{t}\triangleq\sum_{k\in S_{t}}\frac{1}{|S_{t}|}\text{Ap}_{t}^{k}</annotation></semantics></math>.</p>
</div>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.5" class="ltx_p"><math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">M</annotation></semantics></math> is the number of global test samples, <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="{N^{k}_{\text{te}}}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msubsup id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2.2" xref="S3.SS2.p4.2.m2.1.1.2.2.cmml">N</mi><mtext id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3a.cmml">te</mtext><mi id="S3.SS2.p4.2.m2.1.1.2.3" xref="S3.SS2.p4.2.m2.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.2.1.cmml" xref="S3.SS2.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2.2">𝑁</ci><ci id="S3.SS2.p4.2.m2.1.1.2.3.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p4.2.m2.1.1.3a.cmml" xref="S3.SS2.p4.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">te</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">{N^{k}_{\text{te}}}</annotation></semantics></math> is the number of local test samples on client <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">k</annotation></semantics></math>, <math id="S3.SS2.p4.4.m4.2" class="ltx_Math" alttext="\arg\max f(\cdot;\cdot)" display="inline"><semantics id="S3.SS2.p4.4.m4.2a"><mrow id="S3.SS2.p4.4.m4.2.3" xref="S3.SS2.p4.4.m4.2.3.cmml"><mrow id="S3.SS2.p4.4.m4.2.3.2" xref="S3.SS2.p4.4.m4.2.3.2.cmml"><mi id="S3.SS2.p4.4.m4.2.3.2.1" xref="S3.SS2.p4.4.m4.2.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.SS2.p4.4.m4.2.3.2a" xref="S3.SS2.p4.4.m4.2.3.2.cmml">⁡</mo><mrow id="S3.SS2.p4.4.m4.2.3.2.2" xref="S3.SS2.p4.4.m4.2.3.2.2.cmml"><mi id="S3.SS2.p4.4.m4.2.3.2.2.1" xref="S3.SS2.p4.4.m4.2.3.2.2.1.cmml">max</mi><mo lspace="0.167em" id="S3.SS2.p4.4.m4.2.3.2.2a" xref="S3.SS2.p4.4.m4.2.3.2.2.cmml">⁡</mo><mi id="S3.SS2.p4.4.m4.2.3.2.2.2" xref="S3.SS2.p4.4.m4.2.3.2.2.2.cmml">f</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.2.3.1" xref="S3.SS2.p4.4.m4.2.3.1.cmml">​</mo><mrow id="S3.SS2.p4.4.m4.2.3.3.2" xref="S3.SS2.p4.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p4.4.m4.2.3.3.2.1" xref="S3.SS2.p4.4.m4.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.p4.4.m4.2.3.3.2.2" xref="S3.SS2.p4.4.m4.2.3.3.1.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.2.2" xref="S3.SS2.p4.4.m4.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p4.4.m4.2.3.3.2.3" xref="S3.SS2.p4.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.2b"><apply id="S3.SS2.p4.4.m4.2.3.cmml" xref="S3.SS2.p4.4.m4.2.3"><times id="S3.SS2.p4.4.m4.2.3.1.cmml" xref="S3.SS2.p4.4.m4.2.3.1"></times><apply id="S3.SS2.p4.4.m4.2.3.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2"><arg id="S3.SS2.p4.4.m4.2.3.2.1.cmml" xref="S3.SS2.p4.4.m4.2.3.2.1"></arg><apply id="S3.SS2.p4.4.m4.2.3.2.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2.2"><max id="S3.SS2.p4.4.m4.2.3.2.2.1.cmml" xref="S3.SS2.p4.4.m4.2.3.2.2.1"></max><ci id="S3.SS2.p4.4.m4.2.3.2.2.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2.2.2">𝑓</ci></apply></apply><list id="S3.SS2.p4.4.m4.2.3.3.1.cmml" xref="S3.SS2.p4.4.m4.2.3.3.2"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">⋅</ci><ci id="S3.SS2.p4.4.m4.2.2.cmml" xref="S3.SS2.p4.4.m4.2.2">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.2c">\arg\max f(\cdot;\cdot)</annotation></semantics></math> returns the predicted label, and <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="\mathcal{I}\{\cdot\}" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><mrow id="S3.SS2.p4.5.m5.1.2" xref="S3.SS2.p4.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.5.m5.1.2.2" xref="S3.SS2.p4.5.m5.1.2.2.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.1.2.1" xref="S3.SS2.p4.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS2.p4.5.m5.1.2.3.2" xref="S3.SS2.p4.5.m5.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p4.5.m5.1.2.3.2.1" xref="S3.SS2.p4.5.m5.1.2.3.1.cmml">{</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p4.5.m5.1.2.3.2.2" xref="S3.SS2.p4.5.m5.1.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.2.cmml" xref="S3.SS2.p4.5.m5.1.2"><times id="S3.SS2.p4.5.m5.1.2.1.cmml" xref="S3.SS2.p4.5.m5.1.2.1"></times><ci id="S3.SS2.p4.5.m5.1.2.2.cmml" xref="S3.SS2.p4.5.m5.1.2.2">ℐ</ci><set id="S3.SS2.p4.5.m5.1.2.3.1.cmml" xref="S3.SS2.p4.5.m5.1.2.3.2"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">⋅</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">\mathcal{I}\{\cdot\}</annotation></semantics></math> is the indication function. We can find that the goal of aggregation emphasizes the global <span id="S3.SS2.p4.5.1" class="ltx_text ltx_font_italic">aggregated model</span>’s ability, which is expected to work well universally for existing clients or novel clients. However, the goal of personalization emphasizes the <span id="S3.SS2.p4.5.2" class="ltx_text ltx_font_italic">personalized model</span>’s ability, which reflects the original incentive for local clients to participate in FL. Due to the non-iid challenge, it is hard to generate a well-performed aggregated model. Even we can obtain such a global model, it could still perform poorly on local clients, and delicate personalization methods should be further utilized for better adaptation.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Issues to Explore</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.8" class="ltx_p">A simple yet effective approach to simultaneously accomplish the goals of aggregation and personalization with non-iid data is to privatize some network components. Take the privatization of a whole model for example, we keep both a shared model <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="h_{{\text{s}}}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">h</mi><mtext id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3a.cmml">s</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">ℎ</ci><ci id="S3.SS3.p1.1.m1.1.1.3a.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">s</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">h_{{\text{s}}}</annotation></semantics></math> and a private one <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="h_{{\text{p}}}^{k}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msubsup id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml">h</mi><mtext id="S3.SS3.p1.2.m2.1.1.2.3" xref="S3.SS3.p1.2.m2.1.1.2.3a.cmml">p</mtext><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2">ℎ</ci><ci id="S3.SS3.p1.2.m2.1.1.2.3a.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3"><mtext mathsize="70%" id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3">p</mtext></ci></apply><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">h_{{\text{p}}}^{k}</annotation></semantics></math> on the <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">k</annotation></semantics></math>th client. We utilize the additive model to combine them, i.e., <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="h^{k}\triangleq(1-\alpha)h_{{\text{s}}}+\alpha h_{{\text{p}}}^{k}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><msup id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">h</mi><mi id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml">k</mi></msup><mo id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">≜</mo><mrow id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml"><mrow id="S3.SS3.p1.4.m4.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.cmml"><mrow id="S3.SS3.p1.4.m4.1.1.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m4.1.1.1.1.1.1.2" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.cmml"><mn id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.2" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S3.SS3.p1.4.m4.1.1.1.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.1.1.1.2" xref="S3.SS3.p1.4.m4.1.1.1.1.2.cmml">​</mo><msub id="S3.SS3.p1.4.m4.1.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.1.1.3.2.cmml">h</mi><mtext id="S3.SS3.p1.4.m4.1.1.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.1.1.3.3a.cmml">s</mtext></msub></mrow><mo id="S3.SS3.p1.4.m4.1.1.1.2" xref="S3.SS3.p1.4.m4.1.1.1.2.cmml">+</mo><mrow id="S3.SS3.p1.4.m4.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.1.3.1.cmml">​</mo><msubsup id="S3.SS3.p1.4.m4.1.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.1.3.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.1.3.3.2.2" xref="S3.SS3.p1.4.m4.1.1.1.3.3.2.2.cmml">h</mi><mtext id="S3.SS3.p1.4.m4.1.1.1.3.3.2.3" xref="S3.SS3.p1.4.m4.1.1.1.3.3.2.3a.cmml">p</mtext><mi id="S3.SS3.p1.4.m4.1.1.1.3.3.3" xref="S3.SS3.p1.4.m4.1.1.1.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">≜</ci><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">ℎ</ci><ci id="S3.SS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3">𝑘</ci></apply><apply id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1"><plus id="S3.SS3.p1.4.m4.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.2"></plus><apply id="S3.SS3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1"><times id="S3.SS3.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.2"></times><apply id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1"><minus id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.2">1</cn><ci id="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.SS3.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3.2">ℎ</ci><ci id="S3.SS3.p1.4.m4.1.1.1.1.3.3a.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.SS3.p1.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1.3.3">s</mtext></ci></apply></apply><apply id="S3.SS3.p1.4.m4.1.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3"><times id="S3.SS3.p1.4.m4.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.1"></times><ci id="S3.SS3.p1.4.m4.1.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.2">𝛼</ci><apply id="S3.SS3.p1.4.m4.1.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.3.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3">superscript</csymbol><apply id="S3.SS3.p1.4.m4.1.1.1.3.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.3.3.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.1.3.3.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3.2.2">ℎ</ci><ci id="S3.SS3.p1.4.m4.1.1.1.3.3.2.3a.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3.2.3"><mtext mathsize="70%" id="S3.SS3.p1.4.m4.1.1.1.3.3.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3.2.3">p</mtext></ci></apply><ci id="S3.SS3.p1.4.m4.1.1.1.3.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">h^{k}\triangleq(1-\alpha)h_{{\text{s}}}+\alpha h_{{\text{p}}}^{k}</annotation></semantics></math>. <math id="S3.SS3.p1.5.m5.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="S3.SS3.p1.5.m5.2a"><mrow id="S3.SS3.p1.5.m5.2.3" xref="S3.SS3.p1.5.m5.2.3.cmml"><mi id="S3.SS3.p1.5.m5.2.3.2" xref="S3.SS3.p1.5.m5.2.3.2.cmml">α</mi><mo id="S3.SS3.p1.5.m5.2.3.1" xref="S3.SS3.p1.5.m5.2.3.1.cmml">∈</mo><mrow id="S3.SS3.p1.5.m5.2.3.3.2" xref="S3.SS3.p1.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.2.3.3.2.1" xref="S3.SS3.p1.5.m5.2.3.3.1.cmml">[</mo><mn id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">0</mn><mo id="S3.SS3.p1.5.m5.2.3.3.2.2" xref="S3.SS3.p1.5.m5.2.3.3.1.cmml">,</mo><mn id="S3.SS3.p1.5.m5.2.2" xref="S3.SS3.p1.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS3.p1.5.m5.2.3.3.2.3" xref="S3.SS3.p1.5.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.2b"><apply id="S3.SS3.p1.5.m5.2.3.cmml" xref="S3.SS3.p1.5.m5.2.3"><in id="S3.SS3.p1.5.m5.2.3.1.cmml" xref="S3.SS3.p1.5.m5.2.3.1"></in><ci id="S3.SS3.p1.5.m5.2.3.2.cmml" xref="S3.SS3.p1.5.m5.2.3.2">𝛼</ci><interval closure="closed" id="S3.SS3.p1.5.m5.2.3.3.1.cmml" xref="S3.SS3.p1.5.m5.2.3.3.2"><cn type="integer" id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">0</cn><cn type="integer" id="S3.SS3.p1.5.m5.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.2c">\alpha\in[0,1]</annotation></semantics></math> is a tradeoff coefficient. We let the shared model <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="h_{{\text{s}}}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><msub id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">h</mi><mtext id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3a.cmml">s</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">ℎ</ci><ci id="S3.SS3.p1.6.m6.1.1.3a.cmml" xref="S3.SS3.p1.6.m6.1.1.3"><mtext mathsize="70%" id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">s</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">h_{{\text{s}}}</annotation></semantics></math> participate in the aggregation process, while the private one does not. We expect <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="h_{{\text{s}}}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msub id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">h</mi><mtext id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3a.cmml">s</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">ℎ</ci><ci id="S3.SS3.p1.7.m7.1.1.3a.cmml" xref="S3.SS3.p1.7.m7.1.1.3"><mtext mathsize="70%" id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">s</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">h_{{\text{s}}}</annotation></semantics></math> and <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="h_{{\text{p}}}^{k}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><msubsup id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2.2" xref="S3.SS3.p1.8.m8.1.1.2.2.cmml">h</mi><mtext id="S3.SS3.p1.8.m8.1.1.2.3" xref="S3.SS3.p1.8.m8.1.1.2.3a.cmml">p</mtext><mi id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2.2">ℎ</ci><ci id="S3.SS3.p1.8.m8.1.1.2.3a.cmml" xref="S3.SS3.p1.8.m8.1.1.2.3"><mtext mathsize="70%" id="S3.SS3.p1.8.m8.1.1.2.3.cmml" xref="S3.SS3.p1.8.m8.1.1.2.3">p</mtext></ci></apply><ci id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">h_{{\text{p}}}^{k}</annotation></semantics></math> can capture the client-invariant and client-specific information respectively. We also propose a simple analysis via the Bregman divergence, i.e.,</p>
</div>
<div id="S3.Thmtheorem4" class="ltx_theorem ltx_theorem_proposition">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Proposition 3.4.</h6>
<div id="S3.Thmtheorem4.p1" class="ltx_para">
<p id="S3.Thmtheorem4.p1.2" class="ltx_p"><span id="S3.Thmtheorem4.p1.2.2" class="ltx_text ltx_font_italic">If <math id="S3.Thmtheorem4.p1.1.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.Thmtheorem4.p1.1.1.m1.1a"><mi id="S3.Thmtheorem4.p1.1.1.m1.1.1" xref="S3.Thmtheorem4.p1.1.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem4.p1.1.1.m1.1b"><ci id="S3.Thmtheorem4.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem4.p1.1.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem4.p1.1.1.m1.1c">F</annotation></semantics></math> is strictly convex and <math id="S3.Thmtheorem4.p1.2.2.m2.1" class="ltx_Math" alttext="B_{F}" display="inline"><semantics id="S3.Thmtheorem4.p1.2.2.m2.1a"><msub id="S3.Thmtheorem4.p1.2.2.m2.1.1" xref="S3.Thmtheorem4.p1.2.2.m2.1.1.cmml"><mi id="S3.Thmtheorem4.p1.2.2.m2.1.1.2" xref="S3.Thmtheorem4.p1.2.2.m2.1.1.2.cmml">B</mi><mi id="S3.Thmtheorem4.p1.2.2.m2.1.1.3" xref="S3.Thmtheorem4.p1.2.2.m2.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem4.p1.2.2.m2.1b"><apply id="S3.Thmtheorem4.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem4.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem4.p1.2.2.m2.1.1.1.cmml" xref="S3.Thmtheorem4.p1.2.2.m2.1.1">subscript</csymbol><ci id="S3.Thmtheorem4.p1.2.2.m2.1.1.2.cmml" xref="S3.Thmtheorem4.p1.2.2.m2.1.1.2">𝐵</ci><ci id="S3.Thmtheorem4.p1.2.2.m2.1.1.3.cmml" xref="S3.Thmtheorem4.p1.2.2.m2.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem4.p1.2.2.m2.1c">B_{F}</annotation></semantics></math> is jointly convex, we denote the target loss of FL with private-shared models and present its upper bound as follows:</span></p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_math_unparsed" alttext="\mathcal{L}_{\text{ps}}(h_{{\text{s}}},\{h_{{\text{p}}}^{k}\}_{k=1}^{K})\triangleq\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}}^{k}||h^{k})\leq(1-\alpha)\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}}^{k}||h_{{\text{s}}})+\alpha\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}}^{k}||h_{{\text{p}}}^{k})," display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1b"><msub id="S3.E5.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.2">ℒ</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.1.1.3">ps</mtext></msub><mrow id="S3.E5.m1.1.2"><mo stretchy="false" id="S3.E5.m1.1.2.1">(</mo><msub id="S3.E5.m1.1.2.2"><mi id="S3.E5.m1.1.2.2.2">h</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.1.2.2.3">s</mtext></msub><mo id="S3.E5.m1.1.2.3">,</mo><msubsup id="S3.E5.m1.1.2.4"><mrow id="S3.E5.m1.1.2.4.2.2"><mo stretchy="false" id="S3.E5.m1.1.2.4.2.2.1">{</mo><msubsup id="S3.E5.m1.1.2.4.2.2.2"><mi id="S3.E5.m1.1.2.4.2.2.2.2.2">h</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.1.2.4.2.2.2.2.3">p</mtext><mi id="S3.E5.m1.1.2.4.2.2.2.3">k</mi></msubsup><mo stretchy="false" id="S3.E5.m1.1.2.4.2.2.3">}</mo></mrow><mrow id="S3.E5.m1.1.2.4.2.3"><mi id="S3.E5.m1.1.2.4.2.3.2">k</mi><mo id="S3.E5.m1.1.2.4.2.3.1">=</mo><mn id="S3.E5.m1.1.2.4.2.3.3">1</mn></mrow><mi id="S3.E5.m1.1.2.4.3">K</mi></msubsup><mo stretchy="false" id="S3.E5.m1.1.2.5">)</mo></mrow><mo rspace="0.111em" id="S3.E5.m1.1.3">≜</mo><munderover id="S3.E5.m1.1.4"><mo movablelimits="false" id="S3.E5.m1.1.4.2.2">∑</mo><mrow id="S3.E5.m1.1.4.2.3"><mi id="S3.E5.m1.1.4.2.3.2">k</mi><mo id="S3.E5.m1.1.4.2.3.1">=</mo><mn id="S3.E5.m1.1.4.2.3.3">1</mn></mrow><mi id="S3.E5.m1.1.4.3">K</mi></munderover><msub id="S3.E5.m1.1.5"><mi id="S3.E5.m1.1.5.2">p</mi><mi id="S3.E5.m1.1.5.3">k</mi></msub><msub id="S3.E5.m1.1.6"><mi id="S3.E5.m1.1.6.2">B</mi><mi id="S3.E5.m1.1.6.3">F</mi></msub><mrow id="S3.E5.m1.1.7"><mo stretchy="false" id="S3.E5.m1.1.7.1">(</mo><msup id="S3.E5.m1.1.7.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.7.2.2">𝒟</mi><mi id="S3.E5.m1.1.7.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.1.7.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.1.7.4">|</mo><msup id="S3.E5.m1.1.7.5"><mi id="S3.E5.m1.1.7.5.2">h</mi><mi id="S3.E5.m1.1.7.5.3">k</mi></msup><mo stretchy="false" id="S3.E5.m1.1.7.6">)</mo></mrow><mo id="S3.E5.m1.1.8">≤</mo><mrow id="S3.E5.m1.1.9"><mo stretchy="false" id="S3.E5.m1.1.9.1">(</mo><mn id="S3.E5.m1.1.9.2">1</mn><mo id="S3.E5.m1.1.9.3">−</mo><mi id="S3.E5.m1.1.9.4">α</mi><mo stretchy="false" id="S3.E5.m1.1.9.5">)</mo></mrow><munderover id="S3.E5.m1.1.10"><mo movablelimits="false" id="S3.E5.m1.1.10.2.2">∑</mo><mrow id="S3.E5.m1.1.10.2.3"><mi id="S3.E5.m1.1.10.2.3.2">k</mi><mo id="S3.E5.m1.1.10.2.3.1">=</mo><mn id="S3.E5.m1.1.10.2.3.3">1</mn></mrow><mi id="S3.E5.m1.1.10.3">K</mi></munderover><msub id="S3.E5.m1.1.11"><mi id="S3.E5.m1.1.11.2">p</mi><mi id="S3.E5.m1.1.11.3">k</mi></msub><msub id="S3.E5.m1.1.12"><mi id="S3.E5.m1.1.12.2">B</mi><mi id="S3.E5.m1.1.12.3">F</mi></msub><mrow id="S3.E5.m1.1.13"><mo stretchy="false" id="S3.E5.m1.1.13.1">(</mo><msup id="S3.E5.m1.1.13.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.13.2.2">𝒟</mi><mi id="S3.E5.m1.1.13.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.1.13.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.1.13.4">|</mo><msub id="S3.E5.m1.1.13.5"><mi id="S3.E5.m1.1.13.5.2">h</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.1.13.5.3">s</mtext></msub><mo stretchy="false" id="S3.E5.m1.1.13.6">)</mo></mrow><mo id="S3.E5.m1.1.14">+</mo><mi id="S3.E5.m1.1.15">α</mi><munderover id="S3.E5.m1.1.16"><mo movablelimits="false" id="S3.E5.m1.1.16.2.2">∑</mo><mrow id="S3.E5.m1.1.16.2.3"><mi id="S3.E5.m1.1.16.2.3.2">k</mi><mo id="S3.E5.m1.1.16.2.3.1">=</mo><mn id="S3.E5.m1.1.16.2.3.3">1</mn></mrow><mi id="S3.E5.m1.1.16.3">K</mi></munderover><msub id="S3.E5.m1.1.17"><mi id="S3.E5.m1.1.17.2">p</mi><mi id="S3.E5.m1.1.17.3">k</mi></msub><msub id="S3.E5.m1.1.18"><mi id="S3.E5.m1.1.18.2">B</mi><mi id="S3.E5.m1.1.18.3">F</mi></msub><mrow id="S3.E5.m1.1.19"><mo stretchy="false" id="S3.E5.m1.1.19.1">(</mo><msup id="S3.E5.m1.1.19.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.19.2.2">𝒟</mi><mi id="S3.E5.m1.1.19.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.1.19.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E5.m1.1.19.4">|</mo><msubsup id="S3.E5.m1.1.19.5"><mi id="S3.E5.m1.1.19.5.2.2">h</mi><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.1.19.5.2.3">p</mtext><mi id="S3.E5.m1.1.19.5.3">k</mi></msubsup><mo stretchy="false" id="S3.E5.m1.1.19.6">)</mo></mrow><mo id="S3.E5.m1.1.20">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{L}_{\text{ps}}(h_{{\text{s}}},\{h_{{\text{p}}}^{k}\}_{k=1}^{K})\triangleq\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}}^{k}||h^{k})\leq(1-\alpha)\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}}^{k}||h_{{\text{s}}})+\alpha\sum_{k=1}^{K}p_{k}B_{F}({\mathcal{D}}^{k}||h_{{\text{p}}}^{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.2" class="ltx_p">The proof can be easily completed via the property of Bregman divergence, i.e., <math id="S3.SS3.p2.1.m1.1" class="ltx_math_unparsed" alttext="B_{F}({\mathcal{D}}^{k}||(1-\alpha)h_{{\text{s}}}+\alpha h_{{\text{p}}}^{k})\leq(1-\alpha)B_{F}({\mathcal{D}}^{k}||h_{{\text{s}}})+\alpha B_{F}({\mathcal{D}}^{k}||h_{{\text{p}}}^{k})" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1b"><msub id="S3.SS3.p2.1.m1.1.1"><mi id="S3.SS3.p2.1.m1.1.1.2">B</mi><mi id="S3.SS3.p2.1.m1.1.1.3">F</mi></msub><mrow id="S3.SS3.p2.1.m1.1.2"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.2.1">(</mo><msup id="S3.SS3.p2.1.m1.1.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.2.2.2">𝒟</mi><mi id="S3.SS3.p2.1.m1.1.2.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.p2.1.m1.1.2.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.p2.1.m1.1.2.4">|</mo><mrow id="S3.SS3.p2.1.m1.1.2.5"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.2.5.1">(</mo><mn id="S3.SS3.p2.1.m1.1.2.5.2">1</mn><mo id="S3.SS3.p2.1.m1.1.2.5.3">−</mo><mi id="S3.SS3.p2.1.m1.1.2.5.4">α</mi><mo stretchy="false" id="S3.SS3.p2.1.m1.1.2.5.5">)</mo></mrow><msub id="S3.SS3.p2.1.m1.1.2.6"><mi id="S3.SS3.p2.1.m1.1.2.6.2">h</mi><mtext id="S3.SS3.p2.1.m1.1.2.6.3">s</mtext></msub><mo id="S3.SS3.p2.1.m1.1.2.7">+</mo><mi id="S3.SS3.p2.1.m1.1.2.8">α</mi><msubsup id="S3.SS3.p2.1.m1.1.2.9"><mi id="S3.SS3.p2.1.m1.1.2.9.2.2">h</mi><mtext id="S3.SS3.p2.1.m1.1.2.9.2.3">p</mtext><mi id="S3.SS3.p2.1.m1.1.2.9.3">k</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.1.m1.1.2.10">)</mo></mrow><mo id="S3.SS3.p2.1.m1.1.3">≤</mo><mrow id="S3.SS3.p2.1.m1.1.4"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.4.1">(</mo><mn id="S3.SS3.p2.1.m1.1.4.2">1</mn><mo id="S3.SS3.p2.1.m1.1.4.3">−</mo><mi id="S3.SS3.p2.1.m1.1.4.4">α</mi><mo stretchy="false" id="S3.SS3.p2.1.m1.1.4.5">)</mo></mrow><msub id="S3.SS3.p2.1.m1.1.5"><mi id="S3.SS3.p2.1.m1.1.5.2">B</mi><mi id="S3.SS3.p2.1.m1.1.5.3">F</mi></msub><mrow id="S3.SS3.p2.1.m1.1.6"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.6.1">(</mo><msup id="S3.SS3.p2.1.m1.1.6.2"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.6.2.2">𝒟</mi><mi id="S3.SS3.p2.1.m1.1.6.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.p2.1.m1.1.6.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.p2.1.m1.1.6.4">|</mo><msub id="S3.SS3.p2.1.m1.1.6.5"><mi id="S3.SS3.p2.1.m1.1.6.5.2">h</mi><mtext id="S3.SS3.p2.1.m1.1.6.5.3">s</mtext></msub><mo stretchy="false" id="S3.SS3.p2.1.m1.1.6.6">)</mo></mrow><mo id="S3.SS3.p2.1.m1.1.7">+</mo><mi id="S3.SS3.p2.1.m1.1.8">α</mi><msub id="S3.SS3.p2.1.m1.1.9"><mi id="S3.SS3.p2.1.m1.1.9.2">B</mi><mi id="S3.SS3.p2.1.m1.1.9.3">F</mi></msub><mrow id="S3.SS3.p2.1.m1.1.10"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.10.1">(</mo><msup id="S3.SS3.p2.1.m1.1.10.2"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.10.2.2">𝒟</mi><mi id="S3.SS3.p2.1.m1.1.10.2.3">k</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.p2.1.m1.1.10.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.p2.1.m1.1.10.4">|</mo><msubsup id="S3.SS3.p2.1.m1.1.10.5"><mi id="S3.SS3.p2.1.m1.1.10.5.2.2">h</mi><mtext id="S3.SS3.p2.1.m1.1.10.5.2.3">p</mtext><mi id="S3.SS3.p2.1.m1.1.10.5.3">k</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.1.m1.1.10.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">B_{F}({\mathcal{D}}^{k}||(1-\alpha)h_{{\text{s}}}+\alpha h_{{\text{p}}}^{k})\leq(1-\alpha)B_{F}({\mathcal{D}}^{k}||h_{{\text{s}}})+\alpha B_{F}({\mathcal{D}}^{k}||h_{{\text{p}}}^{k})</annotation></semantics></math>. We take a closer look at the upper bound in Eq. <a href="#S3.E5" title="In Proposition 3.4. ‣ 3.3. Issues to Explore ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and we can find that the first term can be seen as the goal of aggregation, while the second term can be seen as the personalization one. <math id="S3.SS3.p2.2.m2.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="S3.SS3.p2.2.m2.2a"><mrow id="S3.SS3.p2.2.m2.2.3" xref="S3.SS3.p2.2.m2.2.3.cmml"><mi id="S3.SS3.p2.2.m2.2.3.2" xref="S3.SS3.p2.2.m2.2.3.2.cmml">α</mi><mo id="S3.SS3.p2.2.m2.2.3.1" xref="S3.SS3.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="S3.SS3.p2.2.m2.2.3.3.2" xref="S3.SS3.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m2.2.3.3.2.1" xref="S3.SS3.p2.2.m2.2.3.3.1.cmml">[</mo><mn id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">0</mn><mo id="S3.SS3.p2.2.m2.2.3.3.2.2" xref="S3.SS3.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS3.p2.2.m2.2.3.3.2.3" xref="S3.SS3.p2.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.2b"><apply id="S3.SS3.p2.2.m2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.3"><in id="S3.SS3.p2.2.m2.2.3.1.cmml" xref="S3.SS3.p2.2.m2.2.3.1"></in><ci id="S3.SS3.p2.2.m2.2.3.2.cmml" xref="S3.SS3.p2.2.m2.2.3.2">𝛼</ci><interval closure="closed" id="S3.SS3.p2.2.m2.2.3.3.1.cmml" xref="S3.SS3.p2.2.m2.2.3.3.2"><cn type="integer" id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">0</cn><cn type="integer" id="S3.SS3.p2.2.m2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.2c">\alpha\in[0,1]</annotation></semantics></math> balances the learning process of aggregation and personalization. This implies that taking advantage of private models can provide effective solutions for both aggregation and personalization in FL.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.4" class="ltx_p">However, which layers should we privatize, or must we keep a complete model private to achieve better FL performances<span id="footnote1b" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We refer to the aggregation and personalization performances as FL performances in a unified way.</span></span></span>? Although some existing methods have utilized private-shared models for accomplishing distinct goals in FL <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>; Peterson
et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2019</a>; Liang et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>; Bui et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2019</a>; Shen et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2020</a>)</cite>, they take various privatization ways and do not explicitly investigate where to aggregate in FL under different non-iid scenes. As categorized in TL, the dataset shift <cite class="ltx_cite ltx_citemacro_citep">(Quionero-Candela et al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2009</a>)</cite> contains both covariate shift and label shift scenes. Similarly, as reported in the recent comprehensive survey of FL <cite class="ltx_cite ltx_citemacro_citep">(Kairouz
et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>, the non-iid scenes contain covariate shift and label shift non-iid ones. The former assumes the heterogeneity is mainly caused by the change of the feature distribution <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="{\mathcal{P}}({\mathbf{x}})" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.2" xref="S3.SS3.p3.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.1.2.2" xref="S3.SS3.p3.1.m1.1.2.2.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.1.m1.1.2.1" xref="S3.SS3.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p3.1.m1.1.2.3.2" xref="S3.SS3.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.1.2.3.2.1" xref="S3.SS3.p3.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.SS3.p3.1.m1.1.2.3.2.2" xref="S3.SS3.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.2"><times id="S3.SS3.p3.1.m1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2.1"></times><ci id="S3.SS3.p3.1.m1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.2.2">𝒫</ci><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">{\mathcal{P}}({\mathbf{x}})</annotation></semantics></math>, while the conditional distribution <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="{\mathcal{P}}(y|{\mathbf{x}})" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mrow id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.2.m2.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.1.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.2.m2.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.SS3.p3.2.m2.1.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S3.SS3.p3.2.m2.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><times id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2"></times><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝒫</ci><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2">𝑦</ci><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">{\mathcal{P}}(y|{\mathbf{x}})</annotation></semantics></math> is nearly the same across clients; the latter assumes the label prior distribution <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="{\mathcal{P}}(y)" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.2" xref="S3.SS3.p3.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.3.m3.1.2.2" xref="S3.SS3.p3.3.m3.1.2.2.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.1.2.1" xref="S3.SS3.p3.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS3.p3.3.m3.1.2.3.2" xref="S3.SS3.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.1.2.3.2.1" xref="S3.SS3.p3.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">y</mi><mo stretchy="false" id="S3.SS3.p3.3.m3.1.2.3.2.2" xref="S3.SS3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.2.cmml" xref="S3.SS3.p3.3.m3.1.2"><times id="S3.SS3.p3.3.m3.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.2.1"></times><ci id="S3.SS3.p3.3.m3.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.2.2">𝒫</ci><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">{\mathcal{P}}(y)</annotation></semantics></math> varies a lot across clients, while the generation process <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="{\mathcal{P}}({\mathbf{x}}|y)" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mrow id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.4.m4.1.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.4.m4.1.1.1.1.2" xref="S3.SS3.p3.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.4.m4.1.1.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.1.1.1.2" xref="S3.SS3.p3.4.m4.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S3.SS3.p3.4.m4.1.1.1.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p3.4.m4.1.1.1.1.1.3" xref="S3.SS3.p3.4.m4.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.SS3.p3.4.m4.1.1.1.1.3" xref="S3.SS3.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><times id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2"></times><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝒫</ci><apply id="S3.SS3.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS3.p3.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">{\mathcal{P}}({\mathbf{x}}|y)</annotation></semantics></math> is nearly the same. For example, the various styles of handwriting could lead to the covariate shift; the fact that kangaroos are only in Australia or zoos could result in label shift <cite class="ltx_cite ltx_citemacro_citep">(Kairouz
et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>. According to this, we first propose two kinds of possible conjectures for where to aggregate or privatize in FL with non-iid scenes as follows:</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p"><span id="S3.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Where changes, where to privatize</span>. If the covariate shift in a specific FL scene is more serious, we should keep a private encoder to extract client-specific feature information. On the contrary, if the label shift is more serious, privatizing a task-specific classifier is preferred.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p"><span id="S3.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Aggregating base layers, privatizing task-specific layers</span>. According to the common assumption in DNN <cite class="ltx_cite ltx_citemacro_citep">(Yosinski
et al<span class="ltx_text">.</span>, <a href="#bib.bib63" title="" class="ltx_ref">2014</a>)</cite>, base layers are more transferable among tasks, and hence we prefer to share the feature extractor among clients.</p>
</div>
</li>
</ol>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p">These conjectures co-exist even in the same research area. For example, some domain adaptation (DA) methods <cite class="ltx_cite ltx_citemacro_citep">(Long
et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2015</a>; Ganin et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite> follow the assumption that the base layers are more transferable and share the feature extractor between domains to align the intermediate features. However, some other DA methods <cite class="ltx_cite ltx_citemacro_citep">(Tzeng
et al<span class="ltx_text">.</span>, <a href="#bib.bib52" title="" class="ltx_ref">2017</a>; Chang
et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> advocate that the covariate shift is majorly caused by the feature distribution skew and do not entirely share the feature extractor between source and target domains. Since these are just conjectures, we want to verify whether these assumptions hold in FL under different non-iid scenes.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Pseudo Code of Learn to Aggregate</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Methods and Algorithms</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This section will present specific privatization methods, experimental procedures, and the proposed automatical learning algorithms.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Privatization Ways</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Given a neural network, we have amounts of privatization ways to divide components into shared and private ones. The privatization can be a single branch one, where we directly privatize some layers and aggregate the remaining ones via the server, e.g., privatizing the base layers <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite>, privatizing the top layers <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>. Meanwhile, it could be a multi-branch one, where we keep the whole model shared and additionally keep several components private, e.g., privatizing a copy of the encoder <cite class="ltx_cite ltx_citemacro_citep">(Yao
et al<span class="ltx_text">.</span>, <a href="#bib.bib61" title="" class="ltx_ref">2019a</a>)</cite>, privatizing another independent model <cite class="ltx_cite ltx_citemacro_citep">(Peterson
et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2019</a>)</cite>. To standardize and simplify the descriptions of these privatization ways, we define the following terms:</p>
</div>
<div id="S4.Thmtheorem1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_theorem">Definition 4.1 (Block).</h6>
<div id="S4.Thmtheorem1.p1" class="ltx_para">
<p id="S4.Thmtheorem1.p1.1" class="ltx_p">A block is the smallest network unit that we use to construct private-shared models. It could be a single or a series of network layers. We use uppercase letters (e.g., A, B, C) to indicate shared blocks and lowercase letters (e.g., a, b, c) to indicate private ones.</p>
</div>
</div>
<div id="S4.Thmtheorem2" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_theorem">Definition 4.2 (Network Splits).</h6>
<div id="S4.Thmtheorem2.p1" class="ltx_para">
<p id="S4.Thmtheorem2.p1.3" class="ltx_p">We divide a complete network into several disjoint but sequentially adjacent blocks as network splits. We use <math id="S4.Thmtheorem2.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.Thmtheorem2.p1.1.m1.1a"><mi id="S4.Thmtheorem2.p1.1.m1.1.1" xref="S4.Thmtheorem2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.1.m1.1b"><ci id="S4.Thmtheorem2.p1.1.m1.1.1.cmml" xref="S4.Thmtheorem2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.1.m1.1c">L</annotation></semantics></math> to denote the number of blocks. By default, we arrange the split blocks in alphabetical order, and represent the network splits by concatenating the letters of the blocks from bottom to top, e.g., “ABCDef” with <math id="S4.Thmtheorem2.p1.2.m2.1" class="ltx_Math" alttext="L=6" display="inline"><semantics id="S4.Thmtheorem2.p1.2.m2.1a"><mrow id="S4.Thmtheorem2.p1.2.m2.1.1" xref="S4.Thmtheorem2.p1.2.m2.1.1.cmml"><mi id="S4.Thmtheorem2.p1.2.m2.1.1.2" xref="S4.Thmtheorem2.p1.2.m2.1.1.2.cmml">L</mi><mo id="S4.Thmtheorem2.p1.2.m2.1.1.1" xref="S4.Thmtheorem2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.Thmtheorem2.p1.2.m2.1.1.3" xref="S4.Thmtheorem2.p1.2.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.2.m2.1b"><apply id="S4.Thmtheorem2.p1.2.m2.1.1.cmml" xref="S4.Thmtheorem2.p1.2.m2.1.1"><eq id="S4.Thmtheorem2.p1.2.m2.1.1.1.cmml" xref="S4.Thmtheorem2.p1.2.m2.1.1.1"></eq><ci id="S4.Thmtheorem2.p1.2.m2.1.1.2.cmml" xref="S4.Thmtheorem2.p1.2.m2.1.1.2">𝐿</ci><cn type="integer" id="S4.Thmtheorem2.p1.2.m2.1.1.3.cmml" xref="S4.Thmtheorem2.p1.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.2.m2.1c">L=6</annotation></semantics></math>, “abc” with <math id="S4.Thmtheorem2.p1.3.m3.1" class="ltx_Math" alttext="L=3" display="inline"><semantics id="S4.Thmtheorem2.p1.3.m3.1a"><mrow id="S4.Thmtheorem2.p1.3.m3.1.1" xref="S4.Thmtheorem2.p1.3.m3.1.1.cmml"><mi id="S4.Thmtheorem2.p1.3.m3.1.1.2" xref="S4.Thmtheorem2.p1.3.m3.1.1.2.cmml">L</mi><mo id="S4.Thmtheorem2.p1.3.m3.1.1.1" xref="S4.Thmtheorem2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.Thmtheorem2.p1.3.m3.1.1.3" xref="S4.Thmtheorem2.p1.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem2.p1.3.m3.1b"><apply id="S4.Thmtheorem2.p1.3.m3.1.1.cmml" xref="S4.Thmtheorem2.p1.3.m3.1.1"><eq id="S4.Thmtheorem2.p1.3.m3.1.1.1.cmml" xref="S4.Thmtheorem2.p1.3.m3.1.1.1"></eq><ci id="S4.Thmtheorem2.p1.3.m3.1.1.2.cmml" xref="S4.Thmtheorem2.p1.3.m3.1.1.2">𝐿</ci><cn type="integer" id="S4.Thmtheorem2.p1.3.m3.1.1.3.cmml" xref="S4.Thmtheorem2.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem2.p1.3.m3.1c">L=3</annotation></semantics></math>.</p>
</div>
</div>
<div id="S4.Thmtheorem3" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_theorem">Definition 4.3 (Privatization).</h6>
<div id="S4.Thmtheorem3.p1" class="ltx_para">
<p id="S4.Thmtheorem3.p1.1" class="ltx_p">Given a complete DNN model, we first manually divide it into blocks and obtain the network splits. Then for each <math id="S4.Thmtheorem3.p1.1.m1.2" class="ltx_Math" alttext="b\in[1,L]" display="inline"><semantics id="S4.Thmtheorem3.p1.1.m1.2a"><mrow id="S4.Thmtheorem3.p1.1.m1.2.3" xref="S4.Thmtheorem3.p1.1.m1.2.3.cmml"><mi id="S4.Thmtheorem3.p1.1.m1.2.3.2" xref="S4.Thmtheorem3.p1.1.m1.2.3.2.cmml">b</mi><mo id="S4.Thmtheorem3.p1.1.m1.2.3.1" xref="S4.Thmtheorem3.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.Thmtheorem3.p1.1.m1.2.3.3.2" xref="S4.Thmtheorem3.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.Thmtheorem3.p1.1.m1.2.3.3.2.1" xref="S4.Thmtheorem3.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="S4.Thmtheorem3.p1.1.m1.1.1" xref="S4.Thmtheorem3.p1.1.m1.1.1.cmml">1</mn><mo id="S4.Thmtheorem3.p1.1.m1.2.3.3.2.2" xref="S4.Thmtheorem3.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.Thmtheorem3.p1.1.m1.2.2" xref="S4.Thmtheorem3.p1.1.m1.2.2.cmml">L</mi><mo stretchy="false" id="S4.Thmtheorem3.p1.1.m1.2.3.3.2.3" xref="S4.Thmtheorem3.p1.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem3.p1.1.m1.2b"><apply id="S4.Thmtheorem3.p1.1.m1.2.3.cmml" xref="S4.Thmtheorem3.p1.1.m1.2.3"><in id="S4.Thmtheorem3.p1.1.m1.2.3.1.cmml" xref="S4.Thmtheorem3.p1.1.m1.2.3.1"></in><ci id="S4.Thmtheorem3.p1.1.m1.2.3.2.cmml" xref="S4.Thmtheorem3.p1.1.m1.2.3.2">𝑏</ci><interval closure="closed" id="S4.Thmtheorem3.p1.1.m1.2.3.3.1.cmml" xref="S4.Thmtheorem3.p1.1.m1.2.3.3.2"><cn type="integer" id="S4.Thmtheorem3.p1.1.m1.1.1.cmml" xref="S4.Thmtheorem3.p1.1.m1.1.1">1</cn><ci id="S4.Thmtheorem3.p1.1.m1.2.2.cmml" xref="S4.Thmtheorem3.p1.1.m1.2.2">𝐿</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem3.p1.1.m1.2c">b\in[1,L]</annotation></semantics></math>, we take the following four ways to privatize corresponding layers:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Private-shared (PS)</span>. We keep the blocks that lower than <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><mi id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><ci id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">b</annotation></semantics></math> private on local clients and let others participate in the global aggregation.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Shared-private (SP)</span>. We keep the <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">b</annotation></semantics></math>th block and upper ones private on local clients and let the lower ones participate in the global aggregation.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Shared-private-shared (SPS)</span>. We additionally take a copy of the blocks that lower than <math id="S4.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.I1.i3.p1.1.m1.1a"><mi id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><ci id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">b</annotation></semantics></math> and make them private.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p"><span id="S4.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Shared-shared-private (SSP)</span>. We additionally take a copy of the <math id="S4.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.I1.i4.p1.1.m1.1a"><mi id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><ci id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">b</annotation></semantics></math>th block and upper ones and make them private.</p>
</div>
</li>
</ul>
</div>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.6" class="ltx_p">We concatenate the letters of the blocks following a bottom-first and shared-first order to name a specific privatization way. For example, “AaBbCcDE” represents a SPS way that with <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="L=5" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">L</mi><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></eq><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">L=5</annotation></semantics></math> and <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="b=4" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">b</mi><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><eq id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></eq><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑏</ci><cn type="integer" id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">b=4</annotation></semantics></math>, “ABc” represents a SP way that with <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="L=3" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">L</mi><mo id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><eq id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"></eq><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝐿</ci><cn type="integer" id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">L=3</annotation></semantics></math> and <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="b=3" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mrow id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">b</mi><mo id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><eq id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1"></eq><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">𝑏</ci><cn type="integer" id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">b=3</annotation></semantics></math>, and “ABb” represents a SSP way that with <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="L=2" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">L</mi><mo id="S4.SS1.p2.5.m5.1.1.1" xref="S4.SS1.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><eq id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1"></eq><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝐿</ci><cn type="integer" id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">L=2</annotation></semantics></math> and <math id="S4.SS1.p2.6.m6.1" class="ltx_Math" alttext="b=2" display="inline"><semantics id="S4.SS1.p2.6.m6.1a"><mrow id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">b</mi><mo id="S4.SS1.p2.6.m6.1.1.1" xref="S4.SS1.p2.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><eq id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1.1"></eq><ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">𝑏</ci><cn type="integer" id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">b=2</annotation></semantics></math>. The illustrations of the above definitions can be found in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We only copy the block architecture in SPS and SSP and re-initialize the parameters.
The SP and PS way can be seen as privatizing the top layers and bottom layers of a network in a single branch style, respectively. Because the server could only access incomplete models from clients, these two ways could not generate a complete global model. Hence, we do not compare aggregation performances with them, and only explore these architectures for personalization. These single branch methods are used in <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>; Liang et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite>. Different from these two ways, SPS and SSP privatize some layers while keeping a complete model shared across clients. Namely, SPS and SSP are double branch ones<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>More branches can also be investigated, and the private branch can also take a different architecture. We do not consider these settings in this paper.</span></span></span>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Experimental Procedures</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this section, we present how to investigate the privatization ways on several benchmarks. Given a DNN based FL scene and its corresponding network, we first divide the network into feature extractor (a.k.a., encoder) and task-specific predictor (a.k.a., classifier). That is, we obtain a type of network splits with <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="L=2" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">L</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">L=2</annotation></semantics></math>. Then, according to the defined privatization ways, we can obtain 7 different privatization ways as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, which are “AB”, “aB”, “ab”, “Ab”, “AaB”, “AaBb”, and “ABb”, respectively. We use “A” to denote the shared block of the encoder and “B” as the classifier. As aforementioned, lower cases represent private ones. We can observe that “ab” works as individually training, “AB” works as a single completely shared model used in FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>, “aB” works with a private encoder used in <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020</a>)</cite>, “Ab” works with a private classifier taken in <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite>, “AaB” works as similarly in <cite class="ltx_cite ltx_citemacro_citep">(Yao
et al<span class="ltx_text">.</span>, <a href="#bib.bib61" title="" class="ltx_ref">2019a</a>, <a href="#bib.bib60" title="" class="ltx_ref">2018</a>)</cite>, and “AaBb” works similarly as in <cite class="ltx_cite ltx_citemacro_citep">(Peterson
et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2019</a>; Shen et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2020</a>)</cite>. Hence, our defined privatization ways can contain existing private-shared FL architectures. For “AaB” in local training, we simply take the average of the two encoders’ outputs and feed it to the classifier. For “AaBb” and “ABb”, we can obtain two classification probability vectors, and we individually calculate losses of them in training while take their average for prediction as an ensemble in local testing. In FL, we only upload and download the shared blocks as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">We will individually apply these privatization ways to the selected benchmarks and compare their FL performances. For each architecture, we also consider taking several groups of hyper-parameters (e.g., the learning rate) and report the best performances.
Additionally, we will also take a larger <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">L</annotation></semantics></math> for network splits on several benchmarks and investigate the corresponding performances in a fine-grained privatization way. The results can be found in Sect. <a href="#S5.SS4" title="5.4. Results of Different Privatization Ways ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a>.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2107.11954/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="138" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span><span id="S4.F2.2.1" class="ltx_text" style="font-size:90%;">Illustrations of the proposed automatical algorithms to learn to aggregate. We only show the architecture and coefficients during local learning procedure on a specific client. The four blocks denote the shared encoder, the shared classifier, the private encoder, and the private classifier, respectively. The <math id="S4.F2.2.1.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.F2.2.1.m1.1b"><mi id="S4.F2.2.1.m1.1.1" xref="S4.F2.2.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.F2.2.1.m1.1c"><ci id="S4.F2.2.1.m1.1.1.cmml" xref="S4.F2.2.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.1.m1.1d">\psi</annotation></semantics></math> in AutoCS, AutoSA, and AutoHS are correspondingly presented in this figure.</span></figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Automatically Learn to Aggregate</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.11" class="ltx_p">Similar to where to transfer/share in TL/MTL, where to privatize in FL is also a key problem to be solved. In this paper, we propose several automatical algorithms to learn to aggregate in FL. Specifically, we first take a basic architecture as the “AaBb”, where the global server keeps a global encoder <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="E_{{\text{s}}}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">E</mi><mtext id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3a.cmml">s</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝐸</ci><ci id="S4.SS3.p1.1.m1.1.1.3a.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">s</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">E_{{\text{s}}}</annotation></semantics></math> and a global classifier <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="C_{{\text{s}}}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">C</mi><mtext id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3a.cmml">s</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝐶</ci><ci id="S4.SS3.p1.2.m2.1.1.3a.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">s</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">C_{{\text{s}}}</annotation></semantics></math>, and for each <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">k</annotation></semantics></math>, the <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">k</annotation></semantics></math>th client keeps a local encoder <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="E_{{\text{p}}}^{k}" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><msubsup id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mi id="S4.SS3.p1.5.m5.1.1.2.2" xref="S4.SS3.p1.5.m5.1.1.2.2.cmml">E</mi><mtext id="S4.SS3.p1.5.m5.1.1.2.3" xref="S4.SS3.p1.5.m5.1.1.2.3a.cmml">p</mtext><mi id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">superscript</csymbol><apply id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.2.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2.2">𝐸</ci><ci id="S4.SS3.p1.5.m5.1.1.2.3a.cmml" xref="S4.SS3.p1.5.m5.1.1.2.3"><mtext mathsize="70%" id="S4.SS3.p1.5.m5.1.1.2.3.cmml" xref="S4.SS3.p1.5.m5.1.1.2.3">p</mtext></ci></apply><ci id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">E_{{\text{p}}}^{k}</annotation></semantics></math> and a local classifier <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="C_{{\text{p}}}^{k}" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><msubsup id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2.2" xref="S4.SS3.p1.6.m6.1.1.2.2.cmml">C</mi><mtext id="S4.SS3.p1.6.m6.1.1.2.3" xref="S4.SS3.p1.6.m6.1.1.2.3a.cmml">p</mtext><mi id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.2.1.cmml" xref="S4.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p1.6.m6.1.1.2.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2.2">𝐶</ci><ci id="S4.SS3.p1.6.m6.1.1.2.3a.cmml" xref="S4.SS3.p1.6.m6.1.1.2.3"><mtext mathsize="70%" id="S4.SS3.p1.6.m6.1.1.2.3.cmml" xref="S4.SS3.p1.6.m6.1.1.2.3">p</mtext></ci></apply><ci id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">C_{{\text{p}}}^{k}</annotation></semantics></math>. The parameters of them are <math id="S4.SS3.p1.7.m7.1" class="ltx_Math" alttext="{\theta}_{E_{{\text{s}}}}" display="inline"><semantics id="S4.SS3.p1.7.m7.1a"><msub id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2" xref="S4.SS3.p1.7.m7.1.1.2.cmml">θ</mi><msub id="S4.SS3.p1.7.m7.1.1.3" xref="S4.SS3.p1.7.m7.1.1.3.cmml"><mi id="S4.SS3.p1.7.m7.1.1.3.2" xref="S4.SS3.p1.7.m7.1.1.3.2.cmml">E</mi><mtext id="S4.SS3.p1.7.m7.1.1.3.3" xref="S4.SS3.p1.7.m7.1.1.3.3a.cmml">s</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2">𝜃</ci><apply id="S4.SS3.p1.7.m7.1.1.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m7.1.1.3.1.cmml" xref="S4.SS3.p1.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.7.m7.1.1.3.2.cmml" xref="S4.SS3.p1.7.m7.1.1.3.2">𝐸</ci><ci id="S4.SS3.p1.7.m7.1.1.3.3a.cmml" xref="S4.SS3.p1.7.m7.1.1.3.3"><mtext mathsize="50%" id="S4.SS3.p1.7.m7.1.1.3.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3.3">s</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">{\theta}_{E_{{\text{s}}}}</annotation></semantics></math>, <math id="S4.SS3.p1.8.m8.1" class="ltx_Math" alttext="{\theta}_{C_{{\text{s}}}}" display="inline"><semantics id="S4.SS3.p1.8.m8.1a"><msub id="S4.SS3.p1.8.m8.1.1" xref="S4.SS3.p1.8.m8.1.1.cmml"><mi id="S4.SS3.p1.8.m8.1.1.2" xref="S4.SS3.p1.8.m8.1.1.2.cmml">θ</mi><msub id="S4.SS3.p1.8.m8.1.1.3" xref="S4.SS3.p1.8.m8.1.1.3.cmml"><mi id="S4.SS3.p1.8.m8.1.1.3.2" xref="S4.SS3.p1.8.m8.1.1.3.2.cmml">C</mi><mtext id="S4.SS3.p1.8.m8.1.1.3.3" xref="S4.SS3.p1.8.m8.1.1.3.3a.cmml">s</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><apply id="S4.SS3.p1.8.m8.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.p1.8.m8.1.1.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2">𝜃</ci><apply id="S4.SS3.p1.8.m8.1.1.3.cmml" xref="S4.SS3.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.3.1.cmml" xref="S4.SS3.p1.8.m8.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.8.m8.1.1.3.2.cmml" xref="S4.SS3.p1.8.m8.1.1.3.2">𝐶</ci><ci id="S4.SS3.p1.8.m8.1.1.3.3a.cmml" xref="S4.SS3.p1.8.m8.1.1.3.3"><mtext mathsize="50%" id="S4.SS3.p1.8.m8.1.1.3.3.cmml" xref="S4.SS3.p1.8.m8.1.1.3.3">s</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">{\theta}_{C_{{\text{s}}}}</annotation></semantics></math>, <math id="S4.SS3.p1.9.m9.1" class="ltx_Math" alttext="{\theta}_{E_{{\text{p}}}}^{k}" display="inline"><semantics id="S4.SS3.p1.9.m9.1a"><msubsup id="S4.SS3.p1.9.m9.1.1" xref="S4.SS3.p1.9.m9.1.1.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2.2" xref="S4.SS3.p1.9.m9.1.1.2.2.cmml">θ</mi><msub id="S4.SS3.p1.9.m9.1.1.2.3" xref="S4.SS3.p1.9.m9.1.1.2.3.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2.3.2" xref="S4.SS3.p1.9.m9.1.1.2.3.2.cmml">E</mi><mtext id="S4.SS3.p1.9.m9.1.1.2.3.3" xref="S4.SS3.p1.9.m9.1.1.2.3.3a.cmml">p</mtext></msub><mi id="S4.SS3.p1.9.m9.1.1.3" xref="S4.SS3.p1.9.m9.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><apply id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1">superscript</csymbol><apply id="S4.SS3.p1.9.m9.1.1.2.cmml" xref="S4.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2">𝜃</ci><apply id="S4.SS3.p1.9.m9.1.1.2.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.2.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.3">subscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.2.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.3.2">𝐸</ci><ci id="S4.SS3.p1.9.m9.1.1.2.3.3a.cmml" xref="S4.SS3.p1.9.m9.1.1.2.3.3"><mtext mathsize="50%" id="S4.SS3.p1.9.m9.1.1.2.3.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.3.3">p</mtext></ci></apply></apply><ci id="S4.SS3.p1.9.m9.1.1.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">{\theta}_{E_{{\text{p}}}}^{k}</annotation></semantics></math>, and <math id="S4.SS3.p1.10.m10.1" class="ltx_Math" alttext="{\theta}_{C_{{\text{p}}}}^{k}" display="inline"><semantics id="S4.SS3.p1.10.m10.1a"><msubsup id="S4.SS3.p1.10.m10.1.1" xref="S4.SS3.p1.10.m10.1.1.cmml"><mi id="S4.SS3.p1.10.m10.1.1.2.2" xref="S4.SS3.p1.10.m10.1.1.2.2.cmml">θ</mi><msub id="S4.SS3.p1.10.m10.1.1.2.3" xref="S4.SS3.p1.10.m10.1.1.2.3.cmml"><mi id="S4.SS3.p1.10.m10.1.1.2.3.2" xref="S4.SS3.p1.10.m10.1.1.2.3.2.cmml">C</mi><mtext id="S4.SS3.p1.10.m10.1.1.2.3.3" xref="S4.SS3.p1.10.m10.1.1.2.3.3a.cmml">p</mtext></msub><mi id="S4.SS3.p1.10.m10.1.1.3" xref="S4.SS3.p1.10.m10.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m10.1b"><apply id="S4.SS3.p1.10.m10.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.1.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1">superscript</csymbol><apply id="S4.SS3.p1.10.m10.1.1.2.cmml" xref="S4.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.1.1.2.1.cmml" xref="S4.SS3.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS3.p1.10.m10.1.1.2.2.cmml" xref="S4.SS3.p1.10.m10.1.1.2.2">𝜃</ci><apply id="S4.SS3.p1.10.m10.1.1.2.3.cmml" xref="S4.SS3.p1.10.m10.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m10.1.1.2.3.1.cmml" xref="S4.SS3.p1.10.m10.1.1.2.3">subscript</csymbol><ci id="S4.SS3.p1.10.m10.1.1.2.3.2.cmml" xref="S4.SS3.p1.10.m10.1.1.2.3.2">𝐶</ci><ci id="S4.SS3.p1.10.m10.1.1.2.3.3a.cmml" xref="S4.SS3.p1.10.m10.1.1.2.3.3"><mtext mathsize="50%" id="S4.SS3.p1.10.m10.1.1.2.3.3.cmml" xref="S4.SS3.p1.10.m10.1.1.2.3.3">p</mtext></ci></apply></apply><ci id="S4.SS3.p1.10.m10.1.1.3.cmml" xref="S4.SS3.p1.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m10.1c">{\theta}_{C_{{\text{p}}}}^{k}</annotation></semantics></math> correspondingly. To automatically learn a privatization way, some additional parameters should also be globally learned, and we denote them as <math id="S4.SS3.p1.11.m11.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS3.p1.11.m11.1a"><mi id="S4.SS3.p1.11.m11.1.1" xref="S4.SS3.p1.11.m11.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m11.1b"><ci id="S4.SS3.p1.11.m11.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m11.1c">\psi</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.10" class="ltx_p">In the <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">t</annotation></semantics></math>th round, the server sends the <math id="S4.SS3.p2.2.m2.2" class="ltx_Math" alttext="{\theta}_{E_{{\text{s}}},t}" display="inline"><semantics id="S4.SS3.p2.2.m2.2a"><msub id="S4.SS3.p2.2.m2.2.3" xref="S4.SS3.p2.2.m2.2.3.cmml"><mi id="S4.SS3.p2.2.m2.2.3.2" xref="S4.SS3.p2.2.m2.2.3.2.cmml">θ</mi><mrow id="S4.SS3.p2.2.m2.2.2.2.2" xref="S4.SS3.p2.2.m2.2.2.2.3.cmml"><msub id="S4.SS3.p2.2.m2.2.2.2.2.1" xref="S4.SS3.p2.2.m2.2.2.2.2.1.cmml"><mi id="S4.SS3.p2.2.m2.2.2.2.2.1.2" xref="S4.SS3.p2.2.m2.2.2.2.2.1.2.cmml">E</mi><mtext id="S4.SS3.p2.2.m2.2.2.2.2.1.3" xref="S4.SS3.p2.2.m2.2.2.2.2.1.3a.cmml">s</mtext></msub><mo id="S4.SS3.p2.2.m2.2.2.2.2.2" xref="S4.SS3.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.2.m2.1.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.1.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.2b"><apply id="S4.SS3.p2.2.m2.2.3.cmml" xref="S4.SS3.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.2.3.1.cmml" xref="S4.SS3.p2.2.m2.2.3">subscript</csymbol><ci id="S4.SS3.p2.2.m2.2.3.2.cmml" xref="S4.SS3.p2.2.m2.2.3.2">𝜃</ci><list id="S4.SS3.p2.2.m2.2.2.2.3.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2"><apply id="S4.SS3.p2.2.m2.2.2.2.2.1.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.2.2.2.2.1.1.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.2.2.2.2.1.2.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.1.2">𝐸</ci><ci id="S4.SS3.p2.2.m2.2.2.2.2.1.3a.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.1.3"><mtext mathsize="50%" id="S4.SS3.p2.2.m2.2.2.2.2.1.3.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.1.3">s</mtext></ci></apply><ci id="S4.SS3.p2.2.m2.1.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.1">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.2c">{\theta}_{E_{{\text{s}}},t}</annotation></semantics></math>, <math id="S4.SS3.p2.3.m3.2" class="ltx_Math" alttext="{\theta}_{C_{{\text{s}}},t}" display="inline"><semantics id="S4.SS3.p2.3.m3.2a"><msub id="S4.SS3.p2.3.m3.2.3" xref="S4.SS3.p2.3.m3.2.3.cmml"><mi id="S4.SS3.p2.3.m3.2.3.2" xref="S4.SS3.p2.3.m3.2.3.2.cmml">θ</mi><mrow id="S4.SS3.p2.3.m3.2.2.2.2" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml"><msub id="S4.SS3.p2.3.m3.2.2.2.2.1" xref="S4.SS3.p2.3.m3.2.2.2.2.1.cmml"><mi id="S4.SS3.p2.3.m3.2.2.2.2.1.2" xref="S4.SS3.p2.3.m3.2.2.2.2.1.2.cmml">C</mi><mtext id="S4.SS3.p2.3.m3.2.2.2.2.1.3" xref="S4.SS3.p2.3.m3.2.2.2.2.1.3a.cmml">s</mtext></msub><mo id="S4.SS3.p2.3.m3.2.2.2.2.2" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.3.m3.1.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.1.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.2b"><apply id="S4.SS3.p2.3.m3.2.3.cmml" xref="S4.SS3.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.3.1.cmml" xref="S4.SS3.p2.3.m3.2.3">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.3.2.cmml" xref="S4.SS3.p2.3.m3.2.3.2">𝜃</ci><list id="S4.SS3.p2.3.m3.2.2.2.3.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2"><apply id="S4.SS3.p2.3.m3.2.2.2.2.1.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.2.2.2.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.2.2.2.1.2.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2.1.2">𝐶</ci><ci id="S4.SS3.p2.3.m3.2.2.2.2.1.3a.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2.1.3"><mtext mathsize="50%" id="S4.SS3.p2.3.m3.2.2.2.2.1.3.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2.1.3">s</mtext></ci></apply><ci id="S4.SS3.p2.3.m3.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1.1">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.2c">{\theta}_{C_{{\text{s}}},t}</annotation></semantics></math>, and <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="\psi_{t}" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><msub id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">ψ</mi><mi id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">𝜓</ci><ci id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">\psi_{t}</annotation></semantics></math> to the selected clients. Take the <math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><mi id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><ci id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">k</annotation></semantics></math>th client as an example, it receives these parameters as: <math id="S4.SS3.p2.6.m6.4" class="ltx_Math" alttext="{\theta}_{E_{{\text{s}}},t}^{k}\leftarrow{\theta}_{E_{{\text{s}}},t}" display="inline"><semantics id="S4.SS3.p2.6.m6.4a"><mrow id="S4.SS3.p2.6.m6.4.5" xref="S4.SS3.p2.6.m6.4.5.cmml"><msubsup id="S4.SS3.p2.6.m6.4.5.2" xref="S4.SS3.p2.6.m6.4.5.2.cmml"><mi id="S4.SS3.p2.6.m6.4.5.2.2.2" xref="S4.SS3.p2.6.m6.4.5.2.2.2.cmml">θ</mi><mrow id="S4.SS3.p2.6.m6.2.2.2.2" xref="S4.SS3.p2.6.m6.2.2.2.3.cmml"><msub id="S4.SS3.p2.6.m6.2.2.2.2.1" xref="S4.SS3.p2.6.m6.2.2.2.2.1.cmml"><mi id="S4.SS3.p2.6.m6.2.2.2.2.1.2" xref="S4.SS3.p2.6.m6.2.2.2.2.1.2.cmml">E</mi><mtext id="S4.SS3.p2.6.m6.2.2.2.2.1.3" xref="S4.SS3.p2.6.m6.2.2.2.2.1.3a.cmml">s</mtext></msub><mo id="S4.SS3.p2.6.m6.2.2.2.2.2" xref="S4.SS3.p2.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.6.m6.1.1.1.1" xref="S4.SS3.p2.6.m6.1.1.1.1.cmml">t</mi></mrow><mi id="S4.SS3.p2.6.m6.4.5.2.3" xref="S4.SS3.p2.6.m6.4.5.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS3.p2.6.m6.4.5.1" xref="S4.SS3.p2.6.m6.4.5.1.cmml">←</mo><msub id="S4.SS3.p2.6.m6.4.5.3" xref="S4.SS3.p2.6.m6.4.5.3.cmml"><mi id="S4.SS3.p2.6.m6.4.5.3.2" xref="S4.SS3.p2.6.m6.4.5.3.2.cmml">θ</mi><mrow id="S4.SS3.p2.6.m6.4.4.2.2" xref="S4.SS3.p2.6.m6.4.4.2.3.cmml"><msub id="S4.SS3.p2.6.m6.4.4.2.2.1" xref="S4.SS3.p2.6.m6.4.4.2.2.1.cmml"><mi id="S4.SS3.p2.6.m6.4.4.2.2.1.2" xref="S4.SS3.p2.6.m6.4.4.2.2.1.2.cmml">E</mi><mtext id="S4.SS3.p2.6.m6.4.4.2.2.1.3" xref="S4.SS3.p2.6.m6.4.4.2.2.1.3a.cmml">s</mtext></msub><mo id="S4.SS3.p2.6.m6.4.4.2.2.2" xref="S4.SS3.p2.6.m6.4.4.2.3.cmml">,</mo><mi id="S4.SS3.p2.6.m6.3.3.1.1" xref="S4.SS3.p2.6.m6.3.3.1.1.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.4b"><apply id="S4.SS3.p2.6.m6.4.5.cmml" xref="S4.SS3.p2.6.m6.4.5"><ci id="S4.SS3.p2.6.m6.4.5.1.cmml" xref="S4.SS3.p2.6.m6.4.5.1">←</ci><apply id="S4.SS3.p2.6.m6.4.5.2.cmml" xref="S4.SS3.p2.6.m6.4.5.2"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.4.5.2.1.cmml" xref="S4.SS3.p2.6.m6.4.5.2">superscript</csymbol><apply id="S4.SS3.p2.6.m6.4.5.2.2.cmml" xref="S4.SS3.p2.6.m6.4.5.2"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.4.5.2.2.1.cmml" xref="S4.SS3.p2.6.m6.4.5.2">subscript</csymbol><ci id="S4.SS3.p2.6.m6.4.5.2.2.2.cmml" xref="S4.SS3.p2.6.m6.4.5.2.2.2">𝜃</ci><list id="S4.SS3.p2.6.m6.2.2.2.3.cmml" xref="S4.SS3.p2.6.m6.2.2.2.2"><apply id="S4.SS3.p2.6.m6.2.2.2.2.1.cmml" xref="S4.SS3.p2.6.m6.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.2.2.2.2.1.1.cmml" xref="S4.SS3.p2.6.m6.2.2.2.2.1">subscript</csymbol><ci id="S4.SS3.p2.6.m6.2.2.2.2.1.2.cmml" xref="S4.SS3.p2.6.m6.2.2.2.2.1.2">𝐸</ci><ci id="S4.SS3.p2.6.m6.2.2.2.2.1.3a.cmml" xref="S4.SS3.p2.6.m6.2.2.2.2.1.3"><mtext mathsize="50%" id="S4.SS3.p2.6.m6.2.2.2.2.1.3.cmml" xref="S4.SS3.p2.6.m6.2.2.2.2.1.3">s</mtext></ci></apply><ci id="S4.SS3.p2.6.m6.1.1.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1.1.1">𝑡</ci></list></apply><ci id="S4.SS3.p2.6.m6.4.5.2.3.cmml" xref="S4.SS3.p2.6.m6.4.5.2.3">𝑘</ci></apply><apply id="S4.SS3.p2.6.m6.4.5.3.cmml" xref="S4.SS3.p2.6.m6.4.5.3"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.4.5.3.1.cmml" xref="S4.SS3.p2.6.m6.4.5.3">subscript</csymbol><ci id="S4.SS3.p2.6.m6.4.5.3.2.cmml" xref="S4.SS3.p2.6.m6.4.5.3.2">𝜃</ci><list id="S4.SS3.p2.6.m6.4.4.2.3.cmml" xref="S4.SS3.p2.6.m6.4.4.2.2"><apply id="S4.SS3.p2.6.m6.4.4.2.2.1.cmml" xref="S4.SS3.p2.6.m6.4.4.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.4.4.2.2.1.1.cmml" xref="S4.SS3.p2.6.m6.4.4.2.2.1">subscript</csymbol><ci id="S4.SS3.p2.6.m6.4.4.2.2.1.2.cmml" xref="S4.SS3.p2.6.m6.4.4.2.2.1.2">𝐸</ci><ci id="S4.SS3.p2.6.m6.4.4.2.2.1.3a.cmml" xref="S4.SS3.p2.6.m6.4.4.2.2.1.3"><mtext mathsize="50%" id="S4.SS3.p2.6.m6.4.4.2.2.1.3.cmml" xref="S4.SS3.p2.6.m6.4.4.2.2.1.3">s</mtext></ci></apply><ci id="S4.SS3.p2.6.m6.3.3.1.1.cmml" xref="S4.SS3.p2.6.m6.3.3.1.1">𝑡</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.4c">{\theta}_{E_{{\text{s}}},t}^{k}\leftarrow{\theta}_{E_{{\text{s}}},t}</annotation></semantics></math>, <math id="S4.SS3.p2.7.m7.4" class="ltx_Math" alttext="{\theta}_{C_{{\text{s}}},t}^{k}\leftarrow{\theta}_{C_{{\text{s}}},t}" display="inline"><semantics id="S4.SS3.p2.7.m7.4a"><mrow id="S4.SS3.p2.7.m7.4.5" xref="S4.SS3.p2.7.m7.4.5.cmml"><msubsup id="S4.SS3.p2.7.m7.4.5.2" xref="S4.SS3.p2.7.m7.4.5.2.cmml"><mi id="S4.SS3.p2.7.m7.4.5.2.2.2" xref="S4.SS3.p2.7.m7.4.5.2.2.2.cmml">θ</mi><mrow id="S4.SS3.p2.7.m7.2.2.2.2" xref="S4.SS3.p2.7.m7.2.2.2.3.cmml"><msub id="S4.SS3.p2.7.m7.2.2.2.2.1" xref="S4.SS3.p2.7.m7.2.2.2.2.1.cmml"><mi id="S4.SS3.p2.7.m7.2.2.2.2.1.2" xref="S4.SS3.p2.7.m7.2.2.2.2.1.2.cmml">C</mi><mtext id="S4.SS3.p2.7.m7.2.2.2.2.1.3" xref="S4.SS3.p2.7.m7.2.2.2.2.1.3a.cmml">s</mtext></msub><mo id="S4.SS3.p2.7.m7.2.2.2.2.2" xref="S4.SS3.p2.7.m7.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.7.m7.1.1.1.1" xref="S4.SS3.p2.7.m7.1.1.1.1.cmml">t</mi></mrow><mi id="S4.SS3.p2.7.m7.4.5.2.3" xref="S4.SS3.p2.7.m7.4.5.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS3.p2.7.m7.4.5.1" xref="S4.SS3.p2.7.m7.4.5.1.cmml">←</mo><msub id="S4.SS3.p2.7.m7.4.5.3" xref="S4.SS3.p2.7.m7.4.5.3.cmml"><mi id="S4.SS3.p2.7.m7.4.5.3.2" xref="S4.SS3.p2.7.m7.4.5.3.2.cmml">θ</mi><mrow id="S4.SS3.p2.7.m7.4.4.2.2" xref="S4.SS3.p2.7.m7.4.4.2.3.cmml"><msub id="S4.SS3.p2.7.m7.4.4.2.2.1" xref="S4.SS3.p2.7.m7.4.4.2.2.1.cmml"><mi id="S4.SS3.p2.7.m7.4.4.2.2.1.2" xref="S4.SS3.p2.7.m7.4.4.2.2.1.2.cmml">C</mi><mtext id="S4.SS3.p2.7.m7.4.4.2.2.1.3" xref="S4.SS3.p2.7.m7.4.4.2.2.1.3a.cmml">s</mtext></msub><mo id="S4.SS3.p2.7.m7.4.4.2.2.2" xref="S4.SS3.p2.7.m7.4.4.2.3.cmml">,</mo><mi id="S4.SS3.p2.7.m7.3.3.1.1" xref="S4.SS3.p2.7.m7.3.3.1.1.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.4b"><apply id="S4.SS3.p2.7.m7.4.5.cmml" xref="S4.SS3.p2.7.m7.4.5"><ci id="S4.SS3.p2.7.m7.4.5.1.cmml" xref="S4.SS3.p2.7.m7.4.5.1">←</ci><apply id="S4.SS3.p2.7.m7.4.5.2.cmml" xref="S4.SS3.p2.7.m7.4.5.2"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.4.5.2.1.cmml" xref="S4.SS3.p2.7.m7.4.5.2">superscript</csymbol><apply id="S4.SS3.p2.7.m7.4.5.2.2.cmml" xref="S4.SS3.p2.7.m7.4.5.2"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.4.5.2.2.1.cmml" xref="S4.SS3.p2.7.m7.4.5.2">subscript</csymbol><ci id="S4.SS3.p2.7.m7.4.5.2.2.2.cmml" xref="S4.SS3.p2.7.m7.4.5.2.2.2">𝜃</ci><list id="S4.SS3.p2.7.m7.2.2.2.3.cmml" xref="S4.SS3.p2.7.m7.2.2.2.2"><apply id="S4.SS3.p2.7.m7.2.2.2.2.1.cmml" xref="S4.SS3.p2.7.m7.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.2.2.2.2.1.1.cmml" xref="S4.SS3.p2.7.m7.2.2.2.2.1">subscript</csymbol><ci id="S4.SS3.p2.7.m7.2.2.2.2.1.2.cmml" xref="S4.SS3.p2.7.m7.2.2.2.2.1.2">𝐶</ci><ci id="S4.SS3.p2.7.m7.2.2.2.2.1.3a.cmml" xref="S4.SS3.p2.7.m7.2.2.2.2.1.3"><mtext mathsize="50%" id="S4.SS3.p2.7.m7.2.2.2.2.1.3.cmml" xref="S4.SS3.p2.7.m7.2.2.2.2.1.3">s</mtext></ci></apply><ci id="S4.SS3.p2.7.m7.1.1.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1.1.1">𝑡</ci></list></apply><ci id="S4.SS3.p2.7.m7.4.5.2.3.cmml" xref="S4.SS3.p2.7.m7.4.5.2.3">𝑘</ci></apply><apply id="S4.SS3.p2.7.m7.4.5.3.cmml" xref="S4.SS3.p2.7.m7.4.5.3"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.4.5.3.1.cmml" xref="S4.SS3.p2.7.m7.4.5.3">subscript</csymbol><ci id="S4.SS3.p2.7.m7.4.5.3.2.cmml" xref="S4.SS3.p2.7.m7.4.5.3.2">𝜃</ci><list id="S4.SS3.p2.7.m7.4.4.2.3.cmml" xref="S4.SS3.p2.7.m7.4.4.2.2"><apply id="S4.SS3.p2.7.m7.4.4.2.2.1.cmml" xref="S4.SS3.p2.7.m7.4.4.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.4.4.2.2.1.1.cmml" xref="S4.SS3.p2.7.m7.4.4.2.2.1">subscript</csymbol><ci id="S4.SS3.p2.7.m7.4.4.2.2.1.2.cmml" xref="S4.SS3.p2.7.m7.4.4.2.2.1.2">𝐶</ci><ci id="S4.SS3.p2.7.m7.4.4.2.2.1.3a.cmml" xref="S4.SS3.p2.7.m7.4.4.2.2.1.3"><mtext mathsize="50%" id="S4.SS3.p2.7.m7.4.4.2.2.1.3.cmml" xref="S4.SS3.p2.7.m7.4.4.2.2.1.3">s</mtext></ci></apply><ci id="S4.SS3.p2.7.m7.3.3.1.1.cmml" xref="S4.SS3.p2.7.m7.3.3.1.1">𝑡</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.4c">{\theta}_{C_{{\text{s}}},t}^{k}\leftarrow{\theta}_{C_{{\text{s}}},t}</annotation></semantics></math>, and <math id="S4.SS3.p2.8.m8.1" class="ltx_Math" alttext="\psi_{t}^{k}\leftarrow\psi_{t}" display="inline"><semantics id="S4.SS3.p2.8.m8.1a"><mrow id="S4.SS3.p2.8.m8.1.1" xref="S4.SS3.p2.8.m8.1.1.cmml"><msubsup id="S4.SS3.p2.8.m8.1.1.2" xref="S4.SS3.p2.8.m8.1.1.2.cmml"><mi id="S4.SS3.p2.8.m8.1.1.2.2.2" xref="S4.SS3.p2.8.m8.1.1.2.2.2.cmml">ψ</mi><mi id="S4.SS3.p2.8.m8.1.1.2.2.3" xref="S4.SS3.p2.8.m8.1.1.2.2.3.cmml">t</mi><mi id="S4.SS3.p2.8.m8.1.1.2.3" xref="S4.SS3.p2.8.m8.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS3.p2.8.m8.1.1.1" xref="S4.SS3.p2.8.m8.1.1.1.cmml">←</mo><msub id="S4.SS3.p2.8.m8.1.1.3" xref="S4.SS3.p2.8.m8.1.1.3.cmml"><mi id="S4.SS3.p2.8.m8.1.1.3.2" xref="S4.SS3.p2.8.m8.1.1.3.2.cmml">ψ</mi><mi id="S4.SS3.p2.8.m8.1.1.3.3" xref="S4.SS3.p2.8.m8.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.1b"><apply id="S4.SS3.p2.8.m8.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1"><ci id="S4.SS3.p2.8.m8.1.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1.1">←</ci><apply id="S4.SS3.p2.8.m8.1.1.2.cmml" xref="S4.SS3.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m8.1.1.2.1.cmml" xref="S4.SS3.p2.8.m8.1.1.2">superscript</csymbol><apply id="S4.SS3.p2.8.m8.1.1.2.2.cmml" xref="S4.SS3.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m8.1.1.2.2.1.cmml" xref="S4.SS3.p2.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.8.m8.1.1.2.2.2.cmml" xref="S4.SS3.p2.8.m8.1.1.2.2.2">𝜓</ci><ci id="S4.SS3.p2.8.m8.1.1.2.2.3.cmml" xref="S4.SS3.p2.8.m8.1.1.2.2.3">𝑡</ci></apply><ci id="S4.SS3.p2.8.m8.1.1.2.3.cmml" xref="S4.SS3.p2.8.m8.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p2.8.m8.1.1.3.cmml" xref="S4.SS3.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m8.1.1.3.1.cmml" xref="S4.SS3.p2.8.m8.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.8.m8.1.1.3.2.cmml" xref="S4.SS3.p2.8.m8.1.1.3.2">𝜓</ci><ci id="S4.SS3.p2.8.m8.1.1.3.3.cmml" xref="S4.SS3.p2.8.m8.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.1c">\psi_{t}^{k}\leftarrow\psi_{t}</annotation></semantics></math>. We take the training sample pair <math id="S4.SS3.p2.9.m9.2" class="ltx_Math" alttext="({\mathbf{x}}_{i}^{k},y_{i}^{k})" display="inline"><semantics id="S4.SS3.p2.9.m9.2a"><mrow id="S4.SS3.p2.9.m9.2.2.2" xref="S4.SS3.p2.9.m9.2.2.3.cmml"><mo stretchy="false" id="S4.SS3.p2.9.m9.2.2.2.3" xref="S4.SS3.p2.9.m9.2.2.3.cmml">(</mo><msubsup id="S4.SS3.p2.9.m9.1.1.1.1" xref="S4.SS3.p2.9.m9.1.1.1.1.cmml"><mi id="S4.SS3.p2.9.m9.1.1.1.1.2.2" xref="S4.SS3.p2.9.m9.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS3.p2.9.m9.1.1.1.1.2.3" xref="S4.SS3.p2.9.m9.1.1.1.1.2.3.cmml">i</mi><mi id="S4.SS3.p2.9.m9.1.1.1.1.3" xref="S4.SS3.p2.9.m9.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.9.m9.2.2.2.4" xref="S4.SS3.p2.9.m9.2.2.3.cmml">,</mo><msubsup id="S4.SS3.p2.9.m9.2.2.2.2" xref="S4.SS3.p2.9.m9.2.2.2.2.cmml"><mi id="S4.SS3.p2.9.m9.2.2.2.2.2.2" xref="S4.SS3.p2.9.m9.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS3.p2.9.m9.2.2.2.2.2.3" xref="S4.SS3.p2.9.m9.2.2.2.2.2.3.cmml">i</mi><mi id="S4.SS3.p2.9.m9.2.2.2.2.3" xref="S4.SS3.p2.9.m9.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS3.p2.9.m9.2.2.2.5" xref="S4.SS3.p2.9.m9.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m9.2b"><interval closure="open" id="S4.SS3.p2.9.m9.2.2.3.cmml" xref="S4.SS3.p2.9.m9.2.2.2"><apply id="S4.SS3.p2.9.m9.1.1.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m9.1.1.1.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p2.9.m9.1.1.1.1.2.cmml" xref="S4.SS3.p2.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m9.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.9.m9.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.9.m9.1.1.1.1.2.2.cmml" xref="S4.SS3.p2.9.m9.1.1.1.1.2.2">𝐱</ci><ci id="S4.SS3.p2.9.m9.1.1.1.1.2.3.cmml" xref="S4.SS3.p2.9.m9.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS3.p2.9.m9.1.1.1.1.3.cmml" xref="S4.SS3.p2.9.m9.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p2.9.m9.2.2.2.2.cmml" xref="S4.SS3.p2.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m9.2.2.2.2.1.cmml" xref="S4.SS3.p2.9.m9.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p2.9.m9.2.2.2.2.2.cmml" xref="S4.SS3.p2.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m9.2.2.2.2.2.1.cmml" xref="S4.SS3.p2.9.m9.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p2.9.m9.2.2.2.2.2.2.cmml" xref="S4.SS3.p2.9.m9.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS3.p2.9.m9.2.2.2.2.2.3.cmml" xref="S4.SS3.p2.9.m9.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.SS3.p2.9.m9.2.2.2.2.3.cmml" xref="S4.SS3.p2.9.m9.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m9.2c">({\mathbf{x}}_{i}^{k},y_{i}^{k})</annotation></semantics></math> as an example to show the local learning process. The <math id="S4.SS3.p2.10.m10.1" class="ltx_Math" alttext="{\mathbf{x}}_{i}^{k}" display="inline"><semantics id="S4.SS3.p2.10.m10.1a"><msubsup id="S4.SS3.p2.10.m10.1.1" xref="S4.SS3.p2.10.m10.1.1.cmml"><mi id="S4.SS3.p2.10.m10.1.1.2.2" xref="S4.SS3.p2.10.m10.1.1.2.2.cmml">𝐱</mi><mi id="S4.SS3.p2.10.m10.1.1.2.3" xref="S4.SS3.p2.10.m10.1.1.2.3.cmml">i</mi><mi id="S4.SS3.p2.10.m10.1.1.3" xref="S4.SS3.p2.10.m10.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m10.1b"><apply id="S4.SS3.p2.10.m10.1.1.cmml" xref="S4.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.10.m10.1.1.1.cmml" xref="S4.SS3.p2.10.m10.1.1">superscript</csymbol><apply id="S4.SS3.p2.10.m10.1.1.2.cmml" xref="S4.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.10.m10.1.1.2.1.cmml" xref="S4.SS3.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS3.p2.10.m10.1.1.2.2.cmml" xref="S4.SS3.p2.10.m10.1.1.2.2">𝐱</ci><ci id="S4.SS3.p2.10.m10.1.1.2.3.cmml" xref="S4.SS3.p2.10.m10.1.1.2.3">𝑖</ci></apply><ci id="S4.SS3.p2.10.m10.1.1.3.cmml" xref="S4.SS3.p2.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m10.1c">{\mathbf{x}}_{i}^{k}</annotation></semantics></math> will be first processed via the shared and private encoders respectively, i.e.,</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.9" class="ltx_Math" alttext="{\mathbf{h}}_{{\text{s}},i}^{k}\triangleq E_{{\text{s}}}^{k}({\mathbf{x}}_{i}^{k};{\theta}_{E_{{\text{s}}},t}^{k}),\qquad{\mathbf{h}}_{{\text{p}},i}^{k}\triangleq E_{{\text{p}}}^{k}({\mathbf{x}}_{i}^{k};{\theta}_{E_{{\text{p}}},t}^{k})," display="block"><semantics id="S4.E6.m1.9a"><mrow id="S4.E6.m1.9.9.1"><mrow id="S4.E6.m1.9.9.1.1.2" xref="S4.E6.m1.9.9.1.1.3.cmml"><mrow id="S4.E6.m1.9.9.1.1.1.1" xref="S4.E6.m1.9.9.1.1.1.1.cmml"><msubsup id="S4.E6.m1.9.9.1.1.1.1.4" xref="S4.E6.m1.9.9.1.1.1.1.4.cmml"><mi id="S4.E6.m1.9.9.1.1.1.1.4.2.2" xref="S4.E6.m1.9.9.1.1.1.1.4.2.2.cmml">𝐡</mi><mrow id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.3.cmml"><mtext id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.E6.m1.2.2.2.4.1" xref="S4.E6.m1.2.2.2.3.cmml">,</mo><mi id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.E6.m1.9.9.1.1.1.1.4.3" xref="S4.E6.m1.9.9.1.1.1.1.4.3.cmml">k</mi></msubsup><mo id="S4.E6.m1.9.9.1.1.1.1.3" xref="S4.E6.m1.9.9.1.1.1.1.3.cmml">≜</mo><mrow id="S4.E6.m1.9.9.1.1.1.1.2" xref="S4.E6.m1.9.9.1.1.1.1.2.cmml"><msubsup id="S4.E6.m1.9.9.1.1.1.1.2.4" xref="S4.E6.m1.9.9.1.1.1.1.2.4.cmml"><mi id="S4.E6.m1.9.9.1.1.1.1.2.4.2.2" xref="S4.E6.m1.9.9.1.1.1.1.2.4.2.2.cmml">E</mi><mtext id="S4.E6.m1.9.9.1.1.1.1.2.4.2.3" xref="S4.E6.m1.9.9.1.1.1.1.2.4.2.3a.cmml">s</mtext><mi id="S4.E6.m1.9.9.1.1.1.1.2.4.3" xref="S4.E6.m1.9.9.1.1.1.1.2.4.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E6.m1.9.9.1.1.1.1.2.3" xref="S4.E6.m1.9.9.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E6.m1.9.9.1.1.1.1.2.2.2" xref="S4.E6.m1.9.9.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E6.m1.9.9.1.1.1.1.2.2.2.3" xref="S4.E6.m1.9.9.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.E6.m1.9.9.1.1.1.1.2.2.2.4" xref="S4.E6.m1.9.9.1.1.1.1.2.2.3.cmml">;</mo><msubsup id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.2.2" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.2.2.cmml">θ</mi><mrow id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.3.cmml"><msub id="S4.E6.m1.4.4.2.2.1" xref="S4.E6.m1.4.4.2.2.1.cmml"><mi id="S4.E6.m1.4.4.2.2.1.2" xref="S4.E6.m1.4.4.2.2.1.2.cmml">E</mi><mtext id="S4.E6.m1.4.4.2.2.1.3" xref="S4.E6.m1.4.4.2.2.1.3a.cmml">s</mtext></msub><mo id="S4.E6.m1.4.4.2.2.2" xref="S4.E6.m1.4.4.2.3.cmml">,</mo><mi id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml">t</mi></mrow><mi id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.3" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.E6.m1.9.9.1.1.1.1.2.2.2.5" xref="S4.E6.m1.9.9.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="2.167em" id="S4.E6.m1.9.9.1.1.2.3" xref="S4.E6.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S4.E6.m1.9.9.1.1.2.2" xref="S4.E6.m1.9.9.1.1.2.2.cmml"><msubsup id="S4.E6.m1.9.9.1.1.2.2.4" xref="S4.E6.m1.9.9.1.1.2.2.4.cmml"><mi id="S4.E6.m1.9.9.1.1.2.2.4.2.2" xref="S4.E6.m1.9.9.1.1.2.2.4.2.2.cmml">𝐡</mi><mrow id="S4.E6.m1.6.6.2.4" xref="S4.E6.m1.6.6.2.3.cmml"><mtext id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1a.cmml">p</mtext><mo id="S4.E6.m1.6.6.2.4.1" xref="S4.E6.m1.6.6.2.3.cmml">,</mo><mi id="S4.E6.m1.6.6.2.2" xref="S4.E6.m1.6.6.2.2.cmml">i</mi></mrow><mi id="S4.E6.m1.9.9.1.1.2.2.4.3" xref="S4.E6.m1.9.9.1.1.2.2.4.3.cmml">k</mi></msubsup><mo id="S4.E6.m1.9.9.1.1.2.2.3" xref="S4.E6.m1.9.9.1.1.2.2.3.cmml">≜</mo><mrow id="S4.E6.m1.9.9.1.1.2.2.2" xref="S4.E6.m1.9.9.1.1.2.2.2.cmml"><msubsup id="S4.E6.m1.9.9.1.1.2.2.2.4" xref="S4.E6.m1.9.9.1.1.2.2.2.4.cmml"><mi id="S4.E6.m1.9.9.1.1.2.2.2.4.2.2" xref="S4.E6.m1.9.9.1.1.2.2.2.4.2.2.cmml">E</mi><mtext id="S4.E6.m1.9.9.1.1.2.2.2.4.2.3" xref="S4.E6.m1.9.9.1.1.2.2.2.4.2.3a.cmml">p</mtext><mi id="S4.E6.m1.9.9.1.1.2.2.2.4.3" xref="S4.E6.m1.9.9.1.1.2.2.2.4.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E6.m1.9.9.1.1.2.2.2.3" xref="S4.E6.m1.9.9.1.1.2.2.2.3.cmml">​</mo><mrow id="S4.E6.m1.9.9.1.1.2.2.2.2.2" xref="S4.E6.m1.9.9.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E6.m1.9.9.1.1.2.2.2.2.2.3" xref="S4.E6.m1.9.9.1.1.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.cmml"><mi id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.2" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.3" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.3" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.E6.m1.9.9.1.1.2.2.2.2.2.4" xref="S4.E6.m1.9.9.1.1.2.2.2.2.3.cmml">;</mo><msubsup id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.2.2" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.2.2.cmml">θ</mi><mrow id="S4.E6.m1.8.8.2.2" xref="S4.E6.m1.8.8.2.3.cmml"><msub id="S4.E6.m1.8.8.2.2.1" xref="S4.E6.m1.8.8.2.2.1.cmml"><mi id="S4.E6.m1.8.8.2.2.1.2" xref="S4.E6.m1.8.8.2.2.1.2.cmml">E</mi><mtext id="S4.E6.m1.8.8.2.2.1.3" xref="S4.E6.m1.8.8.2.2.1.3a.cmml">p</mtext></msub><mo id="S4.E6.m1.8.8.2.2.2" xref="S4.E6.m1.8.8.2.3.cmml">,</mo><mi id="S4.E6.m1.7.7.1.1" xref="S4.E6.m1.7.7.1.1.cmml">t</mi></mrow><mi id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.3" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.E6.m1.9.9.1.1.2.2.2.2.2.5" xref="S4.E6.m1.9.9.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E6.m1.9.9.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.9b"><apply id="S4.E6.m1.9.9.1.1.3.cmml" xref="S4.E6.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.3a.cmml" xref="S4.E6.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E6.m1.9.9.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1"><ci id="S4.E6.m1.9.9.1.1.1.1.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.3">≜</ci><apply id="S4.E6.m1.9.9.1.1.1.1.4.cmml" xref="S4.E6.m1.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.4.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.4">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.1.1.4.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.4.2.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.4">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.1.1.4.2.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.4.2.2">𝐡</ci><list id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.4"><ci id="S4.E6.m1.1.1.1.1a.cmml" xref="S4.E6.m1.1.1.1.1"><mtext mathsize="70%" id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">s</mtext></ci><ci id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.E6.m1.9.9.1.1.1.1.4.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.4.3">𝑘</ci></apply><apply id="S4.E6.m1.9.9.1.1.1.1.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2"><times id="S4.E6.m1.9.9.1.1.1.1.2.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.3"></times><apply id="S4.E6.m1.9.9.1.1.1.1.2.4.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.2.4.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.4">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.1.1.2.4.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.2.4.2.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.1.1.2.4.2.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.4.2.2">𝐸</ci><ci id="S4.E6.m1.9.9.1.1.1.1.2.4.2.3a.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.4.2.3"><mtext mathsize="70%" id="S4.E6.m1.9.9.1.1.1.1.2.4.2.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.4.2.3">s</mtext></ci></apply><ci id="S4.E6.m1.9.9.1.1.1.1.2.4.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.4.3">𝑘</ci></apply><list id="S4.E6.m1.9.9.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2"><apply id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.2.2">𝜃</ci><list id="S4.E6.m1.4.4.2.3.cmml" xref="S4.E6.m1.4.4.2.2"><apply id="S4.E6.m1.4.4.2.2.1.cmml" xref="S4.E6.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.2.2.1.1.cmml" xref="S4.E6.m1.4.4.2.2.1">subscript</csymbol><ci id="S4.E6.m1.4.4.2.2.1.2.cmml" xref="S4.E6.m1.4.4.2.2.1.2">𝐸</ci><ci id="S4.E6.m1.4.4.2.2.1.3a.cmml" xref="S4.E6.m1.4.4.2.2.1.3"><mtext mathsize="50%" id="S4.E6.m1.4.4.2.2.1.3.cmml" xref="S4.E6.m1.4.4.2.2.1.3">s</mtext></ci></apply><ci id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1.1">𝑡</ci></list></apply><ci id="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="S4.E6.m1.9.9.1.1.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2"><ci id="S4.E6.m1.9.9.1.1.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3">≜</ci><apply id="S4.E6.m1.9.9.1.1.2.2.4.cmml" xref="S4.E6.m1.9.9.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.4.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.4">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.2.2.4.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.4.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.4">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.2.2.4.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.4.2.2">𝐡</ci><list id="S4.E6.m1.6.6.2.3.cmml" xref="S4.E6.m1.6.6.2.4"><ci id="S4.E6.m1.5.5.1.1a.cmml" xref="S4.E6.m1.5.5.1.1"><mtext mathsize="70%" id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1.1">p</mtext></ci><ci id="S4.E6.m1.6.6.2.2.cmml" xref="S4.E6.m1.6.6.2.2">𝑖</ci></list></apply><ci id="S4.E6.m1.9.9.1.1.2.2.4.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.4.3">𝑘</ci></apply><apply id="S4.E6.m1.9.9.1.1.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2"><times id="S4.E6.m1.9.9.1.1.2.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.3"></times><apply id="S4.E6.m1.9.9.1.1.2.2.2.4.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.2.4.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.4">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.2.2.2.4.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.2.4.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.4">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.2.2.2.4.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.4.2.2">𝐸</ci><ci id="S4.E6.m1.9.9.1.1.2.2.2.4.2.3a.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.4.2.3"><mtext mathsize="70%" id="S4.E6.m1.9.9.1.1.2.2.2.4.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.4.2.3">p</mtext></ci></apply><ci id="S4.E6.m1.9.9.1.1.2.2.2.4.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.4.3">𝑘</ci></apply><list id="S4.E6.m1.9.9.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2"><apply id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.2">𝐱</ci><ci id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.2.2">𝜃</ci><list id="S4.E6.m1.8.8.2.3.cmml" xref="S4.E6.m1.8.8.2.2"><apply id="S4.E6.m1.8.8.2.2.1.cmml" xref="S4.E6.m1.8.8.2.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.8.8.2.2.1.1.cmml" xref="S4.E6.m1.8.8.2.2.1">subscript</csymbol><ci id="S4.E6.m1.8.8.2.2.1.2.cmml" xref="S4.E6.m1.8.8.2.2.1.2">𝐸</ci><ci id="S4.E6.m1.8.8.2.2.1.3a.cmml" xref="S4.E6.m1.8.8.2.2.1.3"><mtext mathsize="50%" id="S4.E6.m1.8.8.2.2.1.3.cmml" xref="S4.E6.m1.8.8.2.2.1.3">p</mtext></ci></apply><ci id="S4.E6.m1.7.7.1.1.cmml" xref="S4.E6.m1.7.7.1.1">𝑡</ci></list></apply><ci id="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.2.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.9c">{\mathbf{h}}_{{\text{s}},i}^{k}\triangleq E_{{\text{s}}}^{k}({\mathbf{x}}_{i}^{k};{\theta}_{E_{{\text{s}}},t}^{k}),\qquad{\mathbf{h}}_{{\text{p}},i}^{k}\triangleq E_{{\text{p}}}^{k}({\mathbf{x}}_{i}^{k};{\theta}_{E_{{\text{p}}},t}^{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.13" class="ltx_p">where <math id="S4.SS3.p2.11.m1.2" class="ltx_Math" alttext="{\mathbf{h}}_{{\text{s}},i}^{k}" display="inline"><semantics id="S4.SS3.p2.11.m1.2a"><msubsup id="S4.SS3.p2.11.m1.2.3" xref="S4.SS3.p2.11.m1.2.3.cmml"><mi id="S4.SS3.p2.11.m1.2.3.2.2" xref="S4.SS3.p2.11.m1.2.3.2.2.cmml">𝐡</mi><mrow id="S4.SS3.p2.11.m1.2.2.2.4" xref="S4.SS3.p2.11.m1.2.2.2.3.cmml"><mtext id="S4.SS3.p2.11.m1.1.1.1.1" xref="S4.SS3.p2.11.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.SS3.p2.11.m1.2.2.2.4.1" xref="S4.SS3.p2.11.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.11.m1.2.2.2.2" xref="S4.SS3.p2.11.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.SS3.p2.11.m1.2.3.3" xref="S4.SS3.p2.11.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m1.2b"><apply id="S4.SS3.p2.11.m1.2.3.cmml" xref="S4.SS3.p2.11.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.11.m1.2.3.1.cmml" xref="S4.SS3.p2.11.m1.2.3">superscript</csymbol><apply id="S4.SS3.p2.11.m1.2.3.2.cmml" xref="S4.SS3.p2.11.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.11.m1.2.3.2.1.cmml" xref="S4.SS3.p2.11.m1.2.3">subscript</csymbol><ci id="S4.SS3.p2.11.m1.2.3.2.2.cmml" xref="S4.SS3.p2.11.m1.2.3.2.2">𝐡</ci><list id="S4.SS3.p2.11.m1.2.2.2.3.cmml" xref="S4.SS3.p2.11.m1.2.2.2.4"><ci id="S4.SS3.p2.11.m1.1.1.1.1a.cmml" xref="S4.SS3.p2.11.m1.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p2.11.m1.1.1.1.1.cmml" xref="S4.SS3.p2.11.m1.1.1.1.1">s</mtext></ci><ci id="S4.SS3.p2.11.m1.2.2.2.2.cmml" xref="S4.SS3.p2.11.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.SS3.p2.11.m1.2.3.3.cmml" xref="S4.SS3.p2.11.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m1.2c">{\mathbf{h}}_{{\text{s}},i}^{k}</annotation></semantics></math> and <math id="S4.SS3.p2.12.m2.2" class="ltx_Math" alttext="{\mathbf{h}}_{{\text{p}},i}^{k}" display="inline"><semantics id="S4.SS3.p2.12.m2.2a"><msubsup id="S4.SS3.p2.12.m2.2.3" xref="S4.SS3.p2.12.m2.2.3.cmml"><mi id="S4.SS3.p2.12.m2.2.3.2.2" xref="S4.SS3.p2.12.m2.2.3.2.2.cmml">𝐡</mi><mrow id="S4.SS3.p2.12.m2.2.2.2.4" xref="S4.SS3.p2.12.m2.2.2.2.3.cmml"><mtext id="S4.SS3.p2.12.m2.1.1.1.1" xref="S4.SS3.p2.12.m2.1.1.1.1a.cmml">p</mtext><mo id="S4.SS3.p2.12.m2.2.2.2.4.1" xref="S4.SS3.p2.12.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.12.m2.2.2.2.2" xref="S4.SS3.p2.12.m2.2.2.2.2.cmml">i</mi></mrow><mi id="S4.SS3.p2.12.m2.2.3.3" xref="S4.SS3.p2.12.m2.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m2.2b"><apply id="S4.SS3.p2.12.m2.2.3.cmml" xref="S4.SS3.p2.12.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m2.2.3.1.cmml" xref="S4.SS3.p2.12.m2.2.3">superscript</csymbol><apply id="S4.SS3.p2.12.m2.2.3.2.cmml" xref="S4.SS3.p2.12.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m2.2.3.2.1.cmml" xref="S4.SS3.p2.12.m2.2.3">subscript</csymbol><ci id="S4.SS3.p2.12.m2.2.3.2.2.cmml" xref="S4.SS3.p2.12.m2.2.3.2.2">𝐡</ci><list id="S4.SS3.p2.12.m2.2.2.2.3.cmml" xref="S4.SS3.p2.12.m2.2.2.2.4"><ci id="S4.SS3.p2.12.m2.1.1.1.1a.cmml" xref="S4.SS3.p2.12.m2.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p2.12.m2.1.1.1.1.cmml" xref="S4.SS3.p2.12.m2.1.1.1.1">p</mtext></ci><ci id="S4.SS3.p2.12.m2.2.2.2.2.cmml" xref="S4.SS3.p2.12.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S4.SS3.p2.12.m2.2.3.3.cmml" xref="S4.SS3.p2.12.m2.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m2.2c">{\mathbf{h}}_{{\text{p}},i}^{k}</annotation></semantics></math> denote the shared and private features respectively, and we omit the index of <math id="S4.SS3.p2.13.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS3.p2.13.m3.1a"><mi id="S4.SS3.p2.13.m3.1.1" xref="S4.SS3.p2.13.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m3.1b"><ci id="S4.SS3.p2.13.m3.1.1.cmml" xref="S4.SS3.p2.13.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m3.1c">t</annotation></semantics></math> for simplification. Then we propose three methods to fuse these features, i.e., cross-stitch, soft attention, and hard selection. For cross-stitch, we imitate the learning process in MTL with cross-stitch <cite class="ltx_cite ltx_citemacro_citep">(Misra
et al<span class="ltx_text">.</span>, <a href="#bib.bib41" title="" class="ltx_ref">2016</a>)</cite>, i.e.,</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.21" class="ltx_Math" alttext="\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}\triangleq\hat{\alpha}_{0,0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{0,1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},\qquad\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}\triangleq\hat{\alpha}_{1,0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1,1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k}," display="block"><semantics id="S4.E7.m1.21a"><mrow id="S4.E7.m1.21.21.1"><mrow id="S4.E7.m1.21.21.1.1.2" xref="S4.E7.m1.21.21.1.1.3.cmml"><mrow id="S4.E7.m1.21.21.1.1.1.1" xref="S4.E7.m1.21.21.1.1.1.1.cmml"><msubsup id="S4.E7.m1.21.21.1.1.1.1.2" xref="S4.E7.m1.21.21.1.1.1.1.2.cmml"><mover accent="true" id="S4.E7.m1.21.21.1.1.1.1.2.2.2" xref="S4.E7.m1.21.21.1.1.1.1.2.2.2.cmml"><mi id="S4.E7.m1.21.21.1.1.1.1.2.2.2.2" xref="S4.E7.m1.21.21.1.1.1.1.2.2.2.2.cmml">𝐡</mi><mo id="S4.E7.m1.21.21.1.1.1.1.2.2.2.1" xref="S4.E7.m1.21.21.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.2.2.2.4" xref="S4.E7.m1.2.2.2.3.cmml"><mtext id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.E7.m1.2.2.2.4.1" xref="S4.E7.m1.2.2.2.3.cmml">,</mo><mi id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.E7.m1.21.21.1.1.1.1.2.3" xref="S4.E7.m1.21.21.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.E7.m1.21.21.1.1.1.1.1" xref="S4.E7.m1.21.21.1.1.1.1.1.cmml">≜</mo><mrow id="S4.E7.m1.21.21.1.1.1.1.3" xref="S4.E7.m1.21.21.1.1.1.1.3.cmml"><mrow id="S4.E7.m1.21.21.1.1.1.1.3.2" xref="S4.E7.m1.21.21.1.1.1.1.3.2.cmml"><msubsup id="S4.E7.m1.21.21.1.1.1.1.3.2.2" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.cmml"><mover accent="true" id="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.cmml"><mi id="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.2" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.2.cmml">α</mi><mo id="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.1" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.4.4.2.4" xref="S4.E7.m1.4.4.2.3.cmml"><mn id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml">0</mn><mo id="S4.E7.m1.4.4.2.4.1" xref="S4.E7.m1.4.4.2.3.cmml">,</mo><mn id="S4.E7.m1.4.4.2.2" xref="S4.E7.m1.4.4.2.2.cmml">0</mn></mrow><mi id="S4.E7.m1.21.21.1.1.1.1.3.2.2.3" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E7.m1.21.21.1.1.1.1.3.2.1" xref="S4.E7.m1.21.21.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E7.m1.21.21.1.1.1.1.3.2.3" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3.cmml"><mi id="S4.E7.m1.21.21.1.1.1.1.3.2.3.2.2" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3.2.2.cmml">𝐡</mi><mrow id="S4.E7.m1.6.6.2.4" xref="S4.E7.m1.6.6.2.3.cmml"><mtext id="S4.E7.m1.5.5.1.1" xref="S4.E7.m1.5.5.1.1a.cmml">s</mtext><mo id="S4.E7.m1.6.6.2.4.1" xref="S4.E7.m1.6.6.2.3.cmml">,</mo><mi id="S4.E7.m1.6.6.2.2" xref="S4.E7.m1.6.6.2.2.cmml">i</mi></mrow><mi id="S4.E7.m1.21.21.1.1.1.1.3.2.3.3" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E7.m1.21.21.1.1.1.1.3.1" xref="S4.E7.m1.21.21.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E7.m1.21.21.1.1.1.1.3.3" xref="S4.E7.m1.21.21.1.1.1.1.3.3.cmml"><msubsup id="S4.E7.m1.21.21.1.1.1.1.3.3.2" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.cmml"><mover accent="true" id="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.cmml"><mi id="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.2" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.2.cmml">α</mi><mo id="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.1" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.8.8.2.4" xref="S4.E7.m1.8.8.2.3.cmml"><mn id="S4.E7.m1.7.7.1.1" xref="S4.E7.m1.7.7.1.1.cmml">0</mn><mo id="S4.E7.m1.8.8.2.4.1" xref="S4.E7.m1.8.8.2.3.cmml">,</mo><mn id="S4.E7.m1.8.8.2.2" xref="S4.E7.m1.8.8.2.2.cmml">1</mn></mrow><mi id="S4.E7.m1.21.21.1.1.1.1.3.3.2.3" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E7.m1.21.21.1.1.1.1.3.3.1" xref="S4.E7.m1.21.21.1.1.1.1.3.3.1.cmml">​</mo><msubsup id="S4.E7.m1.21.21.1.1.1.1.3.3.3" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3.cmml"><mi id="S4.E7.m1.21.21.1.1.1.1.3.3.3.2.2" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3.2.2.cmml">𝐡</mi><mrow id="S4.E7.m1.10.10.2.4" xref="S4.E7.m1.10.10.2.3.cmml"><mtext id="S4.E7.m1.9.9.1.1" xref="S4.E7.m1.9.9.1.1a.cmml">p</mtext><mo id="S4.E7.m1.10.10.2.4.1" xref="S4.E7.m1.10.10.2.3.cmml">,</mo><mi id="S4.E7.m1.10.10.2.2" xref="S4.E7.m1.10.10.2.2.cmml">i</mi></mrow><mi id="S4.E7.m1.21.21.1.1.1.1.3.3.3.3" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo rspace="2.167em" id="S4.E7.m1.21.21.1.1.2.3" xref="S4.E7.m1.21.21.1.1.3a.cmml">,</mo><mrow id="S4.E7.m1.21.21.1.1.2.2" xref="S4.E7.m1.21.21.1.1.2.2.cmml"><msubsup id="S4.E7.m1.21.21.1.1.2.2.2" xref="S4.E7.m1.21.21.1.1.2.2.2.cmml"><mover accent="true" id="S4.E7.m1.21.21.1.1.2.2.2.2.2" xref="S4.E7.m1.21.21.1.1.2.2.2.2.2.cmml"><mi id="S4.E7.m1.21.21.1.1.2.2.2.2.2.2" xref="S4.E7.m1.21.21.1.1.2.2.2.2.2.2.cmml">𝐡</mi><mo id="S4.E7.m1.21.21.1.1.2.2.2.2.2.1" xref="S4.E7.m1.21.21.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.12.12.2.4" xref="S4.E7.m1.12.12.2.3.cmml"><mtext id="S4.E7.m1.11.11.1.1" xref="S4.E7.m1.11.11.1.1a.cmml">p</mtext><mo id="S4.E7.m1.12.12.2.4.1" xref="S4.E7.m1.12.12.2.3.cmml">,</mo><mi id="S4.E7.m1.12.12.2.2" xref="S4.E7.m1.12.12.2.2.cmml">i</mi></mrow><mi id="S4.E7.m1.21.21.1.1.2.2.2.3" xref="S4.E7.m1.21.21.1.1.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.E7.m1.21.21.1.1.2.2.1" xref="S4.E7.m1.21.21.1.1.2.2.1.cmml">≜</mo><mrow id="S4.E7.m1.21.21.1.1.2.2.3" xref="S4.E7.m1.21.21.1.1.2.2.3.cmml"><mrow id="S4.E7.m1.21.21.1.1.2.2.3.2" xref="S4.E7.m1.21.21.1.1.2.2.3.2.cmml"><msubsup id="S4.E7.m1.21.21.1.1.2.2.3.2.2" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.cmml"><mover accent="true" id="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.cmml"><mi id="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.2" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.2.cmml">α</mi><mo id="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.1" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.14.14.2.4" xref="S4.E7.m1.14.14.2.3.cmml"><mn id="S4.E7.m1.13.13.1.1" xref="S4.E7.m1.13.13.1.1.cmml">1</mn><mo id="S4.E7.m1.14.14.2.4.1" xref="S4.E7.m1.14.14.2.3.cmml">,</mo><mn id="S4.E7.m1.14.14.2.2" xref="S4.E7.m1.14.14.2.2.cmml">0</mn></mrow><mi id="S4.E7.m1.21.21.1.1.2.2.3.2.2.3" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E7.m1.21.21.1.1.2.2.3.2.1" xref="S4.E7.m1.21.21.1.1.2.2.3.2.1.cmml">​</mo><msubsup id="S4.E7.m1.21.21.1.1.2.2.3.2.3" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3.cmml"><mi id="S4.E7.m1.21.21.1.1.2.2.3.2.3.2.2" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3.2.2.cmml">𝐡</mi><mrow id="S4.E7.m1.16.16.2.4" xref="S4.E7.m1.16.16.2.3.cmml"><mtext id="S4.E7.m1.15.15.1.1" xref="S4.E7.m1.15.15.1.1a.cmml">s</mtext><mo id="S4.E7.m1.16.16.2.4.1" xref="S4.E7.m1.16.16.2.3.cmml">,</mo><mi id="S4.E7.m1.16.16.2.2" xref="S4.E7.m1.16.16.2.2.cmml">i</mi></mrow><mi id="S4.E7.m1.21.21.1.1.2.2.3.2.3.3" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E7.m1.21.21.1.1.2.2.3.1" xref="S4.E7.m1.21.21.1.1.2.2.3.1.cmml">+</mo><mrow id="S4.E7.m1.21.21.1.1.2.2.3.3" xref="S4.E7.m1.21.21.1.1.2.2.3.3.cmml"><msubsup id="S4.E7.m1.21.21.1.1.2.2.3.3.2" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.cmml"><mover accent="true" id="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.cmml"><mi id="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.2" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.2.cmml">α</mi><mo id="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.1" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.18.18.2.4" xref="S4.E7.m1.18.18.2.3.cmml"><mn id="S4.E7.m1.17.17.1.1" xref="S4.E7.m1.17.17.1.1.cmml">1</mn><mo id="S4.E7.m1.18.18.2.4.1" xref="S4.E7.m1.18.18.2.3.cmml">,</mo><mn id="S4.E7.m1.18.18.2.2" xref="S4.E7.m1.18.18.2.2.cmml">1</mn></mrow><mi id="S4.E7.m1.21.21.1.1.2.2.3.3.2.3" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E7.m1.21.21.1.1.2.2.3.3.1" xref="S4.E7.m1.21.21.1.1.2.2.3.3.1.cmml">​</mo><msubsup id="S4.E7.m1.21.21.1.1.2.2.3.3.3" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3.cmml"><mi id="S4.E7.m1.21.21.1.1.2.2.3.3.3.2.2" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3.2.2.cmml">𝐡</mi><mrow id="S4.E7.m1.20.20.2.4" xref="S4.E7.m1.20.20.2.3.cmml"><mtext id="S4.E7.m1.19.19.1.1" xref="S4.E7.m1.19.19.1.1a.cmml">p</mtext><mo id="S4.E7.m1.20.20.2.4.1" xref="S4.E7.m1.20.20.2.3.cmml">,</mo><mi id="S4.E7.m1.20.20.2.2" xref="S4.E7.m1.20.20.2.2.cmml">i</mi></mrow><mi id="S4.E7.m1.21.21.1.1.2.2.3.3.3.3" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.21.21.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.21b"><apply id="S4.E7.m1.21.21.1.1.3.cmml" xref="S4.E7.m1.21.21.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.3a.cmml" xref="S4.E7.m1.21.21.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1"><ci id="S4.E7.m1.21.21.1.1.1.1.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.1">≜</ci><apply id="S4.E7.m1.21.21.1.1.1.1.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.2">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.2">subscript</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.2.2.2"><ci id="S4.E7.m1.21.21.1.1.1.1.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.2.2.2.1">^</ci><ci id="S4.E7.m1.21.21.1.1.1.1.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.2.2.2.2">𝐡</ci></apply><list id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.4"><ci id="S4.E7.m1.1.1.1.1a.cmml" xref="S4.E7.m1.1.1.1.1"><mtext mathsize="70%" id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">s</mtext></ci><ci id="S4.E7.m1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.E7.m1.21.21.1.1.1.1.2.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E7.m1.21.21.1.1.1.1.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3"><plus id="S4.E7.m1.21.21.1.1.1.1.3.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.1"></plus><apply id="S4.E7.m1.21.21.1.1.1.1.3.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2"><times id="S4.E7.m1.21.21.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.1"></times><apply id="S4.E7.m1.21.21.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.3.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2">subscript</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2"><ci id="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.1">^</ci><ci id="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.2.2.2">𝛼</ci></apply><list id="S4.E7.m1.4.4.2.3.cmml" xref="S4.E7.m1.4.4.2.4"><cn type="integer" id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1.1">0</cn><cn type="integer" id="S4.E7.m1.4.4.2.2.cmml" xref="S4.E7.m1.4.4.2.2">0</cn></list></apply><ci id="S4.E7.m1.21.21.1.1.1.1.3.2.2.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S4.E7.m1.21.21.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.3.2.3.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.3.2.3.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.3.2.3.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E7.m1.21.21.1.1.1.1.3.2.3.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3.2.2">𝐡</ci><list id="S4.E7.m1.6.6.2.3.cmml" xref="S4.E7.m1.6.6.2.4"><ci id="S4.E7.m1.5.5.1.1a.cmml" xref="S4.E7.m1.5.5.1.1"><mtext mathsize="70%" id="S4.E7.m1.5.5.1.1.cmml" xref="S4.E7.m1.5.5.1.1">s</mtext></ci><ci id="S4.E7.m1.6.6.2.2.cmml" xref="S4.E7.m1.6.6.2.2">𝑖</ci></list></apply><ci id="S4.E7.m1.21.21.1.1.1.1.3.2.3.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S4.E7.m1.21.21.1.1.1.1.3.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3"><times id="S4.E7.m1.21.21.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.1"></times><apply id="S4.E7.m1.21.21.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.3.3.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2">subscript</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2"><ci id="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.1">^</ci><ci id="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.2.2.2">𝛼</ci></apply><list id="S4.E7.m1.8.8.2.3.cmml" xref="S4.E7.m1.8.8.2.4"><cn type="integer" id="S4.E7.m1.7.7.1.1.cmml" xref="S4.E7.m1.7.7.1.1">0</cn><cn type="integer" id="S4.E7.m1.8.8.2.2.cmml" xref="S4.E7.m1.8.8.2.2">1</cn></list></apply><ci id="S4.E7.m1.21.21.1.1.1.1.3.3.2.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.2.3">𝑘</ci></apply><apply id="S4.E7.m1.21.21.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.3.3.3.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.1.1.3.3.3.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.1.1.3.3.3.2.1.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E7.m1.21.21.1.1.1.1.3.3.3.2.2.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3.2.2">𝐡</ci><list id="S4.E7.m1.10.10.2.3.cmml" xref="S4.E7.m1.10.10.2.4"><ci id="S4.E7.m1.9.9.1.1a.cmml" xref="S4.E7.m1.9.9.1.1"><mtext mathsize="70%" id="S4.E7.m1.9.9.1.1.cmml" xref="S4.E7.m1.9.9.1.1">p</mtext></ci><ci id="S4.E7.m1.10.10.2.2.cmml" xref="S4.E7.m1.10.10.2.2">𝑖</ci></list></apply><ci id="S4.E7.m1.21.21.1.1.1.1.3.3.3.3.cmml" xref="S4.E7.m1.21.21.1.1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S4.E7.m1.21.21.1.1.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2"><ci id="S4.E7.m1.21.21.1.1.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.1">≜</ci><apply id="S4.E7.m1.21.21.1.1.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.2">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.2">subscript</csymbol><apply id="S4.E7.m1.21.21.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.2.2.2"><ci id="S4.E7.m1.21.21.1.1.2.2.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.2.2.2.1">^</ci><ci id="S4.E7.m1.21.21.1.1.2.2.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.2.2.2.2">𝐡</ci></apply><list id="S4.E7.m1.12.12.2.3.cmml" xref="S4.E7.m1.12.12.2.4"><ci id="S4.E7.m1.11.11.1.1a.cmml" xref="S4.E7.m1.11.11.1.1"><mtext mathsize="70%" id="S4.E7.m1.11.11.1.1.cmml" xref="S4.E7.m1.11.11.1.1">p</mtext></ci><ci id="S4.E7.m1.12.12.2.2.cmml" xref="S4.E7.m1.12.12.2.2">𝑖</ci></list></apply><ci id="S4.E7.m1.21.21.1.1.2.2.2.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.2.3">𝑘</ci></apply><apply id="S4.E7.m1.21.21.1.1.2.2.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3"><plus id="S4.E7.m1.21.21.1.1.2.2.3.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.1"></plus><apply id="S4.E7.m1.21.21.1.1.2.2.3.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2"><times id="S4.E7.m1.21.21.1.1.2.2.3.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.1"></times><apply id="S4.E7.m1.21.21.1.1.2.2.3.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.3.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2">subscript</csymbol><apply id="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2"><ci id="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.1">^</ci><ci id="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.2.2.2">𝛼</ci></apply><list id="S4.E7.m1.14.14.2.3.cmml" xref="S4.E7.m1.14.14.2.4"><cn type="integer" id="S4.E7.m1.13.13.1.1.cmml" xref="S4.E7.m1.13.13.1.1">1</cn><cn type="integer" id="S4.E7.m1.14.14.2.2.cmml" xref="S4.E7.m1.14.14.2.2">0</cn></list></apply><ci id="S4.E7.m1.21.21.1.1.2.2.3.2.2.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.2.3">𝑘</ci></apply><apply id="S4.E7.m1.21.21.1.1.2.2.3.2.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.3.2.3.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.2.2.3.2.3.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.3.2.3.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3">subscript</csymbol><ci id="S4.E7.m1.21.21.1.1.2.2.3.2.3.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3.2.2">𝐡</ci><list id="S4.E7.m1.16.16.2.3.cmml" xref="S4.E7.m1.16.16.2.4"><ci id="S4.E7.m1.15.15.1.1a.cmml" xref="S4.E7.m1.15.15.1.1"><mtext mathsize="70%" id="S4.E7.m1.15.15.1.1.cmml" xref="S4.E7.m1.15.15.1.1">s</mtext></ci><ci id="S4.E7.m1.16.16.2.2.cmml" xref="S4.E7.m1.16.16.2.2">𝑖</ci></list></apply><ci id="S4.E7.m1.21.21.1.1.2.2.3.2.3.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.2.3.3">𝑘</ci></apply></apply><apply id="S4.E7.m1.21.21.1.1.2.2.3.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3"><times id="S4.E7.m1.21.21.1.1.2.2.3.3.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.1"></times><apply id="S4.E7.m1.21.21.1.1.2.2.3.3.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.3.3.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2">subscript</csymbol><apply id="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2"><ci id="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.1">^</ci><ci id="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.2.2.2">𝛼</ci></apply><list id="S4.E7.m1.18.18.2.3.cmml" xref="S4.E7.m1.18.18.2.4"><cn type="integer" id="S4.E7.m1.17.17.1.1.cmml" xref="S4.E7.m1.17.17.1.1">1</cn><cn type="integer" id="S4.E7.m1.18.18.2.2.cmml" xref="S4.E7.m1.18.18.2.2">1</cn></list></apply><ci id="S4.E7.m1.21.21.1.1.2.2.3.3.2.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.2.3">𝑘</ci></apply><apply id="S4.E7.m1.21.21.1.1.2.2.3.3.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.3.3.3.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3">superscript</csymbol><apply id="S4.E7.m1.21.21.1.1.2.2.3.3.3.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.21.21.1.1.2.2.3.3.3.2.1.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3">subscript</csymbol><ci id="S4.E7.m1.21.21.1.1.2.2.3.3.3.2.2.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3.2.2">𝐡</ci><list id="S4.E7.m1.20.20.2.3.cmml" xref="S4.E7.m1.20.20.2.4"><ci id="S4.E7.m1.19.19.1.1a.cmml" xref="S4.E7.m1.19.19.1.1"><mtext mathsize="70%" id="S4.E7.m1.19.19.1.1.cmml" xref="S4.E7.m1.19.19.1.1">p</mtext></ci><ci id="S4.E7.m1.20.20.2.2.cmml" xref="S4.E7.m1.20.20.2.2">𝑖</ci></list></apply><ci id="S4.E7.m1.21.21.1.1.2.2.3.3.3.3.cmml" xref="S4.E7.m1.21.21.1.1.2.2.3.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.21c">\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}\triangleq\hat{\alpha}_{0,0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{0,1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},\qquad\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}\triangleq\hat{\alpha}_{1,0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1,1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.25" class="ltx_p">where <math id="S4.SS3.p2.14.m1.10" class="ltx_Math" alttext="\hat{\alpha}_{i,j}^{k}\in[0,1],i\in\{0,1\},j\in\{0,1\}" display="inline"><semantics id="S4.SS3.p2.14.m1.10a"><mrow id="S4.SS3.p2.14.m1.10.10.2" xref="S4.SS3.p2.14.m1.10.10.3.cmml"><mrow id="S4.SS3.p2.14.m1.9.9.1.1" xref="S4.SS3.p2.14.m1.9.9.1.1.cmml"><msubsup id="S4.SS3.p2.14.m1.9.9.1.1.2" xref="S4.SS3.p2.14.m1.9.9.1.1.2.cmml"><mover accent="true" id="S4.SS3.p2.14.m1.9.9.1.1.2.2.2" xref="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.cmml"><mi id="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.2" xref="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.2.cmml">α</mi><mo id="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.1" xref="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p2.14.m1.2.2.2.4" xref="S4.SS3.p2.14.m1.2.2.2.3.cmml"><mi id="S4.SS3.p2.14.m1.1.1.1.1" xref="S4.SS3.p2.14.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p2.14.m1.2.2.2.4.1" xref="S4.SS3.p2.14.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.14.m1.2.2.2.2" xref="S4.SS3.p2.14.m1.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS3.p2.14.m1.9.9.1.1.2.3" xref="S4.SS3.p2.14.m1.9.9.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.14.m1.9.9.1.1.1" xref="S4.SS3.p2.14.m1.9.9.1.1.1.cmml">∈</mo><mrow id="S4.SS3.p2.14.m1.9.9.1.1.3.2" xref="S4.SS3.p2.14.m1.9.9.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.14.m1.9.9.1.1.3.2.1" xref="S4.SS3.p2.14.m1.9.9.1.1.3.1.cmml">[</mo><mn id="S4.SS3.p2.14.m1.3.3" xref="S4.SS3.p2.14.m1.3.3.cmml">0</mn><mo id="S4.SS3.p2.14.m1.9.9.1.1.3.2.2" xref="S4.SS3.p2.14.m1.9.9.1.1.3.1.cmml">,</mo><mn id="S4.SS3.p2.14.m1.4.4" xref="S4.SS3.p2.14.m1.4.4.cmml">1</mn><mo stretchy="false" id="S4.SS3.p2.14.m1.9.9.1.1.3.2.3" xref="S4.SS3.p2.14.m1.9.9.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S4.SS3.p2.14.m1.10.10.2.3" xref="S4.SS3.p2.14.m1.10.10.3a.cmml">,</mo><mrow id="S4.SS3.p2.14.m1.10.10.2.2.2" xref="S4.SS3.p2.14.m1.10.10.2.2.3.cmml"><mrow id="S4.SS3.p2.14.m1.10.10.2.2.1.1" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.cmml"><mi id="S4.SS3.p2.14.m1.10.10.2.2.1.1.2" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.2.cmml">i</mi><mo id="S4.SS3.p2.14.m1.10.10.2.2.1.1.1" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.1.cmml">∈</mo><mrow id="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.2" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.2.1" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.1.cmml">{</mo><mn id="S4.SS3.p2.14.m1.5.5" xref="S4.SS3.p2.14.m1.5.5.cmml">0</mn><mo id="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.2.2" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.1.cmml">,</mo><mn id="S4.SS3.p2.14.m1.6.6" xref="S4.SS3.p2.14.m1.6.6.cmml">1</mn><mo stretchy="false" id="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.2.3" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.1.cmml">}</mo></mrow></mrow><mo id="S4.SS3.p2.14.m1.10.10.2.2.2.3" xref="S4.SS3.p2.14.m1.10.10.2.2.3a.cmml">,</mo><mrow id="S4.SS3.p2.14.m1.10.10.2.2.2.2" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.cmml"><mi id="S4.SS3.p2.14.m1.10.10.2.2.2.2.2" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.2.cmml">j</mi><mo id="S4.SS3.p2.14.m1.10.10.2.2.2.2.1" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.1.cmml">∈</mo><mrow id="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.2" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.2.1" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.1.cmml">{</mo><mn id="S4.SS3.p2.14.m1.7.7" xref="S4.SS3.p2.14.m1.7.7.cmml">0</mn><mo id="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.2.2" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.1.cmml">,</mo><mn id="S4.SS3.p2.14.m1.8.8" xref="S4.SS3.p2.14.m1.8.8.cmml">1</mn><mo stretchy="false" id="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.2.3" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.1.cmml">}</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.14.m1.10b"><apply id="S4.SS3.p2.14.m1.10.10.3.cmml" xref="S4.SS3.p2.14.m1.10.10.2"><csymbol cd="ambiguous" id="S4.SS3.p2.14.m1.10.10.3a.cmml" xref="S4.SS3.p2.14.m1.10.10.2.3">formulae-sequence</csymbol><apply id="S4.SS3.p2.14.m1.9.9.1.1.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1"><in id="S4.SS3.p2.14.m1.9.9.1.1.1.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.1"></in><apply id="S4.SS3.p2.14.m1.9.9.1.1.2.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.14.m1.9.9.1.1.2.1.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.2">superscript</csymbol><apply id="S4.SS3.p2.14.m1.9.9.1.1.2.2.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.14.m1.9.9.1.1.2.2.1.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.2">subscript</csymbol><apply id="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.2.2.2"><ci id="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.1.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.1">^</ci><ci id="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.2.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.2.2.2.2">𝛼</ci></apply><list id="S4.SS3.p2.14.m1.2.2.2.3.cmml" xref="S4.SS3.p2.14.m1.2.2.2.4"><ci id="S4.SS3.p2.14.m1.1.1.1.1.cmml" xref="S4.SS3.p2.14.m1.1.1.1.1">𝑖</ci><ci id="S4.SS3.p2.14.m1.2.2.2.2.cmml" xref="S4.SS3.p2.14.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS3.p2.14.m1.9.9.1.1.2.3.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.2.3">𝑘</ci></apply><interval closure="closed" id="S4.SS3.p2.14.m1.9.9.1.1.3.1.cmml" xref="S4.SS3.p2.14.m1.9.9.1.1.3.2"><cn type="integer" id="S4.SS3.p2.14.m1.3.3.cmml" xref="S4.SS3.p2.14.m1.3.3">0</cn><cn type="integer" id="S4.SS3.p2.14.m1.4.4.cmml" xref="S4.SS3.p2.14.m1.4.4">1</cn></interval></apply><apply id="S4.SS3.p2.14.m1.10.10.2.2.3.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.14.m1.10.10.2.2.3a.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS3.p2.14.m1.10.10.2.2.1.1.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1"><in id="S4.SS3.p2.14.m1.10.10.2.2.1.1.1.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.1"></in><ci id="S4.SS3.p2.14.m1.10.10.2.2.1.1.2.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.2">𝑖</ci><set id="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.1.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.1.1.3.2"><cn type="integer" id="S4.SS3.p2.14.m1.5.5.cmml" xref="S4.SS3.p2.14.m1.5.5">0</cn><cn type="integer" id="S4.SS3.p2.14.m1.6.6.cmml" xref="S4.SS3.p2.14.m1.6.6">1</cn></set></apply><apply id="S4.SS3.p2.14.m1.10.10.2.2.2.2.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2"><in id="S4.SS3.p2.14.m1.10.10.2.2.2.2.1.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.1"></in><ci id="S4.SS3.p2.14.m1.10.10.2.2.2.2.2.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.2">𝑗</ci><set id="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.1.cmml" xref="S4.SS3.p2.14.m1.10.10.2.2.2.2.3.2"><cn type="integer" id="S4.SS3.p2.14.m1.7.7.cmml" xref="S4.SS3.p2.14.m1.7.7">0</cn><cn type="integer" id="S4.SS3.p2.14.m1.8.8.cmml" xref="S4.SS3.p2.14.m1.8.8">1</cn></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.14.m1.10c">\hat{\alpha}_{i,j}^{k}\in[0,1],i\in\{0,1\},j\in\{0,1\}</annotation></semantics></math> are coefficients to be learned. In order to obtain a meaningful <math id="S4.SS3.p2.15.m2.4" class="ltx_Math" alttext="\hat{\alpha}^{k}_{i,j}\in[0,1]" display="inline"><semantics id="S4.SS3.p2.15.m2.4a"><mrow id="S4.SS3.p2.15.m2.4.5" xref="S4.SS3.p2.15.m2.4.5.cmml"><msubsup id="S4.SS3.p2.15.m2.4.5.2" xref="S4.SS3.p2.15.m2.4.5.2.cmml"><mover accent="true" id="S4.SS3.p2.15.m2.4.5.2.2.2" xref="S4.SS3.p2.15.m2.4.5.2.2.2.cmml"><mi id="S4.SS3.p2.15.m2.4.5.2.2.2.2" xref="S4.SS3.p2.15.m2.4.5.2.2.2.2.cmml">α</mi><mo id="S4.SS3.p2.15.m2.4.5.2.2.2.1" xref="S4.SS3.p2.15.m2.4.5.2.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p2.15.m2.2.2.2.4" xref="S4.SS3.p2.15.m2.2.2.2.3.cmml"><mi id="S4.SS3.p2.15.m2.1.1.1.1" xref="S4.SS3.p2.15.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p2.15.m2.2.2.2.4.1" xref="S4.SS3.p2.15.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.15.m2.2.2.2.2" xref="S4.SS3.p2.15.m2.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS3.p2.15.m2.4.5.2.2.3" xref="S4.SS3.p2.15.m2.4.5.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.15.m2.4.5.1" xref="S4.SS3.p2.15.m2.4.5.1.cmml">∈</mo><mrow id="S4.SS3.p2.15.m2.4.5.3.2" xref="S4.SS3.p2.15.m2.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.15.m2.4.5.3.2.1" xref="S4.SS3.p2.15.m2.4.5.3.1.cmml">[</mo><mn id="S4.SS3.p2.15.m2.3.3" xref="S4.SS3.p2.15.m2.3.3.cmml">0</mn><mo id="S4.SS3.p2.15.m2.4.5.3.2.2" xref="S4.SS3.p2.15.m2.4.5.3.1.cmml">,</mo><mn id="S4.SS3.p2.15.m2.4.4" xref="S4.SS3.p2.15.m2.4.4.cmml">1</mn><mo stretchy="false" id="S4.SS3.p2.15.m2.4.5.3.2.3" xref="S4.SS3.p2.15.m2.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.15.m2.4b"><apply id="S4.SS3.p2.15.m2.4.5.cmml" xref="S4.SS3.p2.15.m2.4.5"><in id="S4.SS3.p2.15.m2.4.5.1.cmml" xref="S4.SS3.p2.15.m2.4.5.1"></in><apply id="S4.SS3.p2.15.m2.4.5.2.cmml" xref="S4.SS3.p2.15.m2.4.5.2"><csymbol cd="ambiguous" id="S4.SS3.p2.15.m2.4.5.2.1.cmml" xref="S4.SS3.p2.15.m2.4.5.2">subscript</csymbol><apply id="S4.SS3.p2.15.m2.4.5.2.2.cmml" xref="S4.SS3.p2.15.m2.4.5.2"><csymbol cd="ambiguous" id="S4.SS3.p2.15.m2.4.5.2.2.1.cmml" xref="S4.SS3.p2.15.m2.4.5.2">superscript</csymbol><apply id="S4.SS3.p2.15.m2.4.5.2.2.2.cmml" xref="S4.SS3.p2.15.m2.4.5.2.2.2"><ci id="S4.SS3.p2.15.m2.4.5.2.2.2.1.cmml" xref="S4.SS3.p2.15.m2.4.5.2.2.2.1">^</ci><ci id="S4.SS3.p2.15.m2.4.5.2.2.2.2.cmml" xref="S4.SS3.p2.15.m2.4.5.2.2.2.2">𝛼</ci></apply><ci id="S4.SS3.p2.15.m2.4.5.2.2.3.cmml" xref="S4.SS3.p2.15.m2.4.5.2.2.3">𝑘</ci></apply><list id="S4.SS3.p2.15.m2.2.2.2.3.cmml" xref="S4.SS3.p2.15.m2.2.2.2.4"><ci id="S4.SS3.p2.15.m2.1.1.1.1.cmml" xref="S4.SS3.p2.15.m2.1.1.1.1">𝑖</ci><ci id="S4.SS3.p2.15.m2.2.2.2.2.cmml" xref="S4.SS3.p2.15.m2.2.2.2.2">𝑗</ci></list></apply><interval closure="closed" id="S4.SS3.p2.15.m2.4.5.3.1.cmml" xref="S4.SS3.p2.15.m2.4.5.3.2"><cn type="integer" id="S4.SS3.p2.15.m2.3.3.cmml" xref="S4.SS3.p2.15.m2.3.3">0</cn><cn type="integer" id="S4.SS3.p2.15.m2.4.4.cmml" xref="S4.SS3.p2.15.m2.4.4">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.15.m2.4c">\hat{\alpha}^{k}_{i,j}\in[0,1]</annotation></semantics></math>, we take the softmax to normalize <math id="S4.SS3.p2.16.m3.2" class="ltx_Math" alttext="\alpha_{i,j}^{k}\in\mathcal{R}" display="inline"><semantics id="S4.SS3.p2.16.m3.2a"><mrow id="S4.SS3.p2.16.m3.2.3" xref="S4.SS3.p2.16.m3.2.3.cmml"><msubsup id="S4.SS3.p2.16.m3.2.3.2" xref="S4.SS3.p2.16.m3.2.3.2.cmml"><mi id="S4.SS3.p2.16.m3.2.3.2.2.2" xref="S4.SS3.p2.16.m3.2.3.2.2.2.cmml">α</mi><mrow id="S4.SS3.p2.16.m3.2.2.2.4" xref="S4.SS3.p2.16.m3.2.2.2.3.cmml"><mi id="S4.SS3.p2.16.m3.1.1.1.1" xref="S4.SS3.p2.16.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p2.16.m3.2.2.2.4.1" xref="S4.SS3.p2.16.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.16.m3.2.2.2.2" xref="S4.SS3.p2.16.m3.2.2.2.2.cmml">j</mi></mrow><mi id="S4.SS3.p2.16.m3.2.3.2.3" xref="S4.SS3.p2.16.m3.2.3.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.16.m3.2.3.1" xref="S4.SS3.p2.16.m3.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.16.m3.2.3.3" xref="S4.SS3.p2.16.m3.2.3.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.16.m3.2b"><apply id="S4.SS3.p2.16.m3.2.3.cmml" xref="S4.SS3.p2.16.m3.2.3"><in id="S4.SS3.p2.16.m3.2.3.1.cmml" xref="S4.SS3.p2.16.m3.2.3.1"></in><apply id="S4.SS3.p2.16.m3.2.3.2.cmml" xref="S4.SS3.p2.16.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.16.m3.2.3.2.1.cmml" xref="S4.SS3.p2.16.m3.2.3.2">superscript</csymbol><apply id="S4.SS3.p2.16.m3.2.3.2.2.cmml" xref="S4.SS3.p2.16.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.16.m3.2.3.2.2.1.cmml" xref="S4.SS3.p2.16.m3.2.3.2">subscript</csymbol><ci id="S4.SS3.p2.16.m3.2.3.2.2.2.cmml" xref="S4.SS3.p2.16.m3.2.3.2.2.2">𝛼</ci><list id="S4.SS3.p2.16.m3.2.2.2.3.cmml" xref="S4.SS3.p2.16.m3.2.2.2.4"><ci id="S4.SS3.p2.16.m3.1.1.1.1.cmml" xref="S4.SS3.p2.16.m3.1.1.1.1">𝑖</ci><ci id="S4.SS3.p2.16.m3.2.2.2.2.cmml" xref="S4.SS3.p2.16.m3.2.2.2.2">𝑗</ci></list></apply><ci id="S4.SS3.p2.16.m3.2.3.2.3.cmml" xref="S4.SS3.p2.16.m3.2.3.2.3">𝑘</ci></apply><ci id="S4.SS3.p2.16.m3.2.3.3.cmml" xref="S4.SS3.p2.16.m3.2.3.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.16.m3.2c">\alpha_{i,j}^{k}\in\mathcal{R}</annotation></semantics></math>. Specifically, we define <math id="S4.SS3.p2.17.m4.2" class="ltx_Math" alttext="\text{SoftMax}(\cdot,\cdot)" display="inline"><semantics id="S4.SS3.p2.17.m4.2a"><mrow id="S4.SS3.p2.17.m4.2.3" xref="S4.SS3.p2.17.m4.2.3.cmml"><mtext id="S4.SS3.p2.17.m4.2.3.2" xref="S4.SS3.p2.17.m4.2.3.2a.cmml">SoftMax</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p2.17.m4.2.3.1" xref="S4.SS3.p2.17.m4.2.3.1.cmml">​</mo><mrow id="S4.SS3.p2.17.m4.2.3.3.2" xref="S4.SS3.p2.17.m4.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.17.m4.2.3.3.2.1" xref="S4.SS3.p2.17.m4.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p2.17.m4.1.1" xref="S4.SS3.p2.17.m4.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS3.p2.17.m4.2.3.3.2.2" xref="S4.SS3.p2.17.m4.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p2.17.m4.2.2" xref="S4.SS3.p2.17.m4.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p2.17.m4.2.3.3.2.3" xref="S4.SS3.p2.17.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.17.m4.2b"><apply id="S4.SS3.p2.17.m4.2.3.cmml" xref="S4.SS3.p2.17.m4.2.3"><times id="S4.SS3.p2.17.m4.2.3.1.cmml" xref="S4.SS3.p2.17.m4.2.3.1"></times><ci id="S4.SS3.p2.17.m4.2.3.2a.cmml" xref="S4.SS3.p2.17.m4.2.3.2"><mtext id="S4.SS3.p2.17.m4.2.3.2.cmml" xref="S4.SS3.p2.17.m4.2.3.2">SoftMax</mtext></ci><interval closure="open" id="S4.SS3.p2.17.m4.2.3.3.1.cmml" xref="S4.SS3.p2.17.m4.2.3.3.2"><ci id="S4.SS3.p2.17.m4.1.1.cmml" xref="S4.SS3.p2.17.m4.1.1">⋅</ci><ci id="S4.SS3.p2.17.m4.2.2.cmml" xref="S4.SS3.p2.17.m4.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.17.m4.2c">\text{SoftMax}(\cdot,\cdot)</annotation></semantics></math> as a function that takes <math id="S4.SS3.p2.18.m5.1" class="ltx_Math" alttext="\alpha_{0}" display="inline"><semantics id="S4.SS3.p2.18.m5.1a"><msub id="S4.SS3.p2.18.m5.1.1" xref="S4.SS3.p2.18.m5.1.1.cmml"><mi id="S4.SS3.p2.18.m5.1.1.2" xref="S4.SS3.p2.18.m5.1.1.2.cmml">α</mi><mn id="S4.SS3.p2.18.m5.1.1.3" xref="S4.SS3.p2.18.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.18.m5.1b"><apply id="S4.SS3.p2.18.m5.1.1.cmml" xref="S4.SS3.p2.18.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.18.m5.1.1.1.cmml" xref="S4.SS3.p2.18.m5.1.1">subscript</csymbol><ci id="S4.SS3.p2.18.m5.1.1.2.cmml" xref="S4.SS3.p2.18.m5.1.1.2">𝛼</ci><cn type="integer" id="S4.SS3.p2.18.m5.1.1.3.cmml" xref="S4.SS3.p2.18.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.18.m5.1c">\alpha_{0}</annotation></semantics></math> and <math id="S4.SS3.p2.19.m6.1" class="ltx_Math" alttext="\alpha_{1}" display="inline"><semantics id="S4.SS3.p2.19.m6.1a"><msub id="S4.SS3.p2.19.m6.1.1" xref="S4.SS3.p2.19.m6.1.1.cmml"><mi id="S4.SS3.p2.19.m6.1.1.2" xref="S4.SS3.p2.19.m6.1.1.2.cmml">α</mi><mn id="S4.SS3.p2.19.m6.1.1.3" xref="S4.SS3.p2.19.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.19.m6.1b"><apply id="S4.SS3.p2.19.m6.1.1.cmml" xref="S4.SS3.p2.19.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.19.m6.1.1.1.cmml" xref="S4.SS3.p2.19.m6.1.1">subscript</csymbol><ci id="S4.SS3.p2.19.m6.1.1.2.cmml" xref="S4.SS3.p2.19.m6.1.1.2">𝛼</ci><cn type="integer" id="S4.SS3.p2.19.m6.1.1.3.cmml" xref="S4.SS3.p2.19.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.19.m6.1c">\alpha_{1}</annotation></semantics></math> as inputs and returns <math id="S4.SS3.p2.20.m7.1" class="ltx_Math" alttext="e^{\alpha_{0}}/(e^{\alpha_{0}}+e^{\alpha_{1}})" display="inline"><semantics id="S4.SS3.p2.20.m7.1a"><mrow id="S4.SS3.p2.20.m7.1.1" xref="S4.SS3.p2.20.m7.1.1.cmml"><msup id="S4.SS3.p2.20.m7.1.1.3" xref="S4.SS3.p2.20.m7.1.1.3.cmml"><mi id="S4.SS3.p2.20.m7.1.1.3.2" xref="S4.SS3.p2.20.m7.1.1.3.2.cmml">e</mi><msub id="S4.SS3.p2.20.m7.1.1.3.3" xref="S4.SS3.p2.20.m7.1.1.3.3.cmml"><mi id="S4.SS3.p2.20.m7.1.1.3.3.2" xref="S4.SS3.p2.20.m7.1.1.3.3.2.cmml">α</mi><mn id="S4.SS3.p2.20.m7.1.1.3.3.3" xref="S4.SS3.p2.20.m7.1.1.3.3.3.cmml">0</mn></msub></msup><mo id="S4.SS3.p2.20.m7.1.1.2" xref="S4.SS3.p2.20.m7.1.1.2.cmml">/</mo><mrow id="S4.SS3.p2.20.m7.1.1.1.1" xref="S4.SS3.p2.20.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p2.20.m7.1.1.1.1.2" xref="S4.SS3.p2.20.m7.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.20.m7.1.1.1.1.1" xref="S4.SS3.p2.20.m7.1.1.1.1.1.cmml"><msup id="S4.SS3.p2.20.m7.1.1.1.1.1.2" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p2.20.m7.1.1.1.1.1.2.2" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.2.cmml">e</mi><msub id="S4.SS3.p2.20.m7.1.1.1.1.1.2.3" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.cmml"><mi id="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.2" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.2.cmml">α</mi><mn id="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.3" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.3.cmml">0</mn></msub></msup><mo id="S4.SS3.p2.20.m7.1.1.1.1.1.1" xref="S4.SS3.p2.20.m7.1.1.1.1.1.1.cmml">+</mo><msup id="S4.SS3.p2.20.m7.1.1.1.1.1.3" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p2.20.m7.1.1.1.1.1.3.2" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.2.cmml">e</mi><msub id="S4.SS3.p2.20.m7.1.1.1.1.1.3.3" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.2" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.2.cmml">α</mi><mn id="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.3" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.3.cmml">1</mn></msub></msup></mrow><mo stretchy="false" id="S4.SS3.p2.20.m7.1.1.1.1.3" xref="S4.SS3.p2.20.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.20.m7.1b"><apply id="S4.SS3.p2.20.m7.1.1.cmml" xref="S4.SS3.p2.20.m7.1.1"><divide id="S4.SS3.p2.20.m7.1.1.2.cmml" xref="S4.SS3.p2.20.m7.1.1.2"></divide><apply id="S4.SS3.p2.20.m7.1.1.3.cmml" xref="S4.SS3.p2.20.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.20.m7.1.1.3.1.cmml" xref="S4.SS3.p2.20.m7.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.20.m7.1.1.3.2.cmml" xref="S4.SS3.p2.20.m7.1.1.3.2">𝑒</ci><apply id="S4.SS3.p2.20.m7.1.1.3.3.cmml" xref="S4.SS3.p2.20.m7.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.20.m7.1.1.3.3.1.cmml" xref="S4.SS3.p2.20.m7.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p2.20.m7.1.1.3.3.2.cmml" xref="S4.SS3.p2.20.m7.1.1.3.3.2">𝛼</ci><cn type="integer" id="S4.SS3.p2.20.m7.1.1.3.3.3.cmml" xref="S4.SS3.p2.20.m7.1.1.3.3.3">0</cn></apply></apply><apply id="S4.SS3.p2.20.m7.1.1.1.1.1.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1"><plus id="S4.SS3.p2.20.m7.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.1"></plus><apply id="S4.SS3.p2.20.m7.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.20.m7.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2">superscript</csymbol><ci id="S4.SS3.p2.20.m7.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.2">𝑒</ci><apply id="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.1.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.2.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.2">𝛼</ci><cn type="integer" id="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.3.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.2.3.3">0</cn></apply></apply><apply id="S4.SS3.p2.20.m7.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.20.m7.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.20.m7.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.2">𝑒</ci><apply id="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.2">𝛼</ci><cn type="integer" id="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p2.20.m7.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.20.m7.1c">e^{\alpha_{0}}/(e^{\alpha_{0}}+e^{\alpha_{1}})</annotation></semantics></math> and <math id="S4.SS3.p2.21.m8.1" class="ltx_Math" alttext="e^{\alpha_{1}}/(e^{\alpha_{0}}+e^{\alpha_{1}})" display="inline"><semantics id="S4.SS3.p2.21.m8.1a"><mrow id="S4.SS3.p2.21.m8.1.1" xref="S4.SS3.p2.21.m8.1.1.cmml"><msup id="S4.SS3.p2.21.m8.1.1.3" xref="S4.SS3.p2.21.m8.1.1.3.cmml"><mi id="S4.SS3.p2.21.m8.1.1.3.2" xref="S4.SS3.p2.21.m8.1.1.3.2.cmml">e</mi><msub id="S4.SS3.p2.21.m8.1.1.3.3" xref="S4.SS3.p2.21.m8.1.1.3.3.cmml"><mi id="S4.SS3.p2.21.m8.1.1.3.3.2" xref="S4.SS3.p2.21.m8.1.1.3.3.2.cmml">α</mi><mn id="S4.SS3.p2.21.m8.1.1.3.3.3" xref="S4.SS3.p2.21.m8.1.1.3.3.3.cmml">1</mn></msub></msup><mo id="S4.SS3.p2.21.m8.1.1.2" xref="S4.SS3.p2.21.m8.1.1.2.cmml">/</mo><mrow id="S4.SS3.p2.21.m8.1.1.1.1" xref="S4.SS3.p2.21.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p2.21.m8.1.1.1.1.2" xref="S4.SS3.p2.21.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.21.m8.1.1.1.1.1" xref="S4.SS3.p2.21.m8.1.1.1.1.1.cmml"><msup id="S4.SS3.p2.21.m8.1.1.1.1.1.2" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p2.21.m8.1.1.1.1.1.2.2" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.2.cmml">e</mi><msub id="S4.SS3.p2.21.m8.1.1.1.1.1.2.3" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.cmml"><mi id="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.2" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.2.cmml">α</mi><mn id="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.3" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.3.cmml">0</mn></msub></msup><mo id="S4.SS3.p2.21.m8.1.1.1.1.1.1" xref="S4.SS3.p2.21.m8.1.1.1.1.1.1.cmml">+</mo><msup id="S4.SS3.p2.21.m8.1.1.1.1.1.3" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p2.21.m8.1.1.1.1.1.3.2" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.2.cmml">e</mi><msub id="S4.SS3.p2.21.m8.1.1.1.1.1.3.3" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.cmml"><mi id="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.2" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.2.cmml">α</mi><mn id="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.3" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.3.cmml">1</mn></msub></msup></mrow><mo stretchy="false" id="S4.SS3.p2.21.m8.1.1.1.1.3" xref="S4.SS3.p2.21.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.21.m8.1b"><apply id="S4.SS3.p2.21.m8.1.1.cmml" xref="S4.SS3.p2.21.m8.1.1"><divide id="S4.SS3.p2.21.m8.1.1.2.cmml" xref="S4.SS3.p2.21.m8.1.1.2"></divide><apply id="S4.SS3.p2.21.m8.1.1.3.cmml" xref="S4.SS3.p2.21.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.21.m8.1.1.3.1.cmml" xref="S4.SS3.p2.21.m8.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.21.m8.1.1.3.2.cmml" xref="S4.SS3.p2.21.m8.1.1.3.2">𝑒</ci><apply id="S4.SS3.p2.21.m8.1.1.3.3.cmml" xref="S4.SS3.p2.21.m8.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.21.m8.1.1.3.3.1.cmml" xref="S4.SS3.p2.21.m8.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p2.21.m8.1.1.3.3.2.cmml" xref="S4.SS3.p2.21.m8.1.1.3.3.2">𝛼</ci><cn type="integer" id="S4.SS3.p2.21.m8.1.1.3.3.3.cmml" xref="S4.SS3.p2.21.m8.1.1.3.3.3">1</cn></apply></apply><apply id="S4.SS3.p2.21.m8.1.1.1.1.1.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1"><plus id="S4.SS3.p2.21.m8.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.1"></plus><apply id="S4.SS3.p2.21.m8.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.21.m8.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2">superscript</csymbol><ci id="S4.SS3.p2.21.m8.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.2">𝑒</ci><apply id="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.1.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.2.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.2">𝛼</ci><cn type="integer" id="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.3.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.2.3.3">0</cn></apply></apply><apply id="S4.SS3.p2.21.m8.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.21.m8.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.21.m8.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.2">𝑒</ci><apply id="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.2">𝛼</ci><cn type="integer" id="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p2.21.m8.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.21.m8.1c">e^{\alpha_{1}}/(e^{\alpha_{0}}+e^{\alpha_{1}})</annotation></semantics></math> respectively. Then, we can let <math id="S4.SS3.p2.22.m9.12" class="ltx_Math" alttext="\hat{\alpha}_{0,0}^{k},\hat{\alpha}_{0,1}^{k}=\text{SoftMax}(\alpha_{0,0}^{k}/\lambda,\alpha_{0,1}^{k}/\lambda)" display="inline"><semantics id="S4.SS3.p2.22.m9.12a"><mrow id="S4.SS3.p2.22.m9.12.12" xref="S4.SS3.p2.22.m9.12.12.cmml"><mrow id="S4.SS3.p2.22.m9.10.10.2.2" xref="S4.SS3.p2.22.m9.10.10.2.3.cmml"><msubsup id="S4.SS3.p2.22.m9.9.9.1.1.1" xref="S4.SS3.p2.22.m9.9.9.1.1.1.cmml"><mover accent="true" id="S4.SS3.p2.22.m9.9.9.1.1.1.2.2" xref="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.cmml"><mi id="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.2" xref="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.2.cmml">α</mi><mo id="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.1" xref="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p2.22.m9.2.2.2.4" xref="S4.SS3.p2.22.m9.2.2.2.3.cmml"><mn id="S4.SS3.p2.22.m9.1.1.1.1" xref="S4.SS3.p2.22.m9.1.1.1.1.cmml">0</mn><mo id="S4.SS3.p2.22.m9.2.2.2.4.1" xref="S4.SS3.p2.22.m9.2.2.2.3.cmml">,</mo><mn id="S4.SS3.p2.22.m9.2.2.2.2" xref="S4.SS3.p2.22.m9.2.2.2.2.cmml">0</mn></mrow><mi id="S4.SS3.p2.22.m9.9.9.1.1.1.3" xref="S4.SS3.p2.22.m9.9.9.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.22.m9.10.10.2.2.3" xref="S4.SS3.p2.22.m9.10.10.2.3.cmml">,</mo><msubsup id="S4.SS3.p2.22.m9.10.10.2.2.2" xref="S4.SS3.p2.22.m9.10.10.2.2.2.cmml"><mover accent="true" id="S4.SS3.p2.22.m9.10.10.2.2.2.2.2" xref="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.cmml"><mi id="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.2" xref="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.2.cmml">α</mi><mo id="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.1" xref="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p2.22.m9.4.4.2.4" xref="S4.SS3.p2.22.m9.4.4.2.3.cmml"><mn id="S4.SS3.p2.22.m9.3.3.1.1" xref="S4.SS3.p2.22.m9.3.3.1.1.cmml">0</mn><mo id="S4.SS3.p2.22.m9.4.4.2.4.1" xref="S4.SS3.p2.22.m9.4.4.2.3.cmml">,</mo><mn id="S4.SS3.p2.22.m9.4.4.2.2" xref="S4.SS3.p2.22.m9.4.4.2.2.cmml">1</mn></mrow><mi id="S4.SS3.p2.22.m9.10.10.2.2.2.3" xref="S4.SS3.p2.22.m9.10.10.2.2.2.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS3.p2.22.m9.12.12.5" xref="S4.SS3.p2.22.m9.12.12.5.cmml">=</mo><mrow id="S4.SS3.p2.22.m9.12.12.4" xref="S4.SS3.p2.22.m9.12.12.4.cmml"><mtext id="S4.SS3.p2.22.m9.12.12.4.4" xref="S4.SS3.p2.22.m9.12.12.4.4a.cmml">SoftMax</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p2.22.m9.12.12.4.3" xref="S4.SS3.p2.22.m9.12.12.4.3.cmml">​</mo><mrow id="S4.SS3.p2.22.m9.12.12.4.2.2" xref="S4.SS3.p2.22.m9.12.12.4.2.3.cmml"><mo stretchy="false" id="S4.SS3.p2.22.m9.12.12.4.2.2.3" xref="S4.SS3.p2.22.m9.12.12.4.2.3.cmml">(</mo><mrow id="S4.SS3.p2.22.m9.11.11.3.1.1.1" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.cmml"><msubsup id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.cmml"><mi id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.2.2" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.2.2.cmml">α</mi><mrow id="S4.SS3.p2.22.m9.6.6.2.4" xref="S4.SS3.p2.22.m9.6.6.2.3.cmml"><mn id="S4.SS3.p2.22.m9.5.5.1.1" xref="S4.SS3.p2.22.m9.5.5.1.1.cmml">0</mn><mo id="S4.SS3.p2.22.m9.6.6.2.4.1" xref="S4.SS3.p2.22.m9.6.6.2.3.cmml">,</mo><mn id="S4.SS3.p2.22.m9.6.6.2.2" xref="S4.SS3.p2.22.m9.6.6.2.2.cmml">0</mn></mrow><mi id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.3" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.22.m9.11.11.3.1.1.1.1" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.1.cmml">/</mo><mi id="S4.SS3.p2.22.m9.11.11.3.1.1.1.3" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.3.cmml">λ</mi></mrow><mo id="S4.SS3.p2.22.m9.12.12.4.2.2.4" xref="S4.SS3.p2.22.m9.12.12.4.2.3.cmml">,</mo><mrow id="S4.SS3.p2.22.m9.12.12.4.2.2.2" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.cmml"><msubsup id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.cmml"><mi id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.2.2" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.2.2.cmml">α</mi><mrow id="S4.SS3.p2.22.m9.8.8.2.4" xref="S4.SS3.p2.22.m9.8.8.2.3.cmml"><mn id="S4.SS3.p2.22.m9.7.7.1.1" xref="S4.SS3.p2.22.m9.7.7.1.1.cmml">0</mn><mo id="S4.SS3.p2.22.m9.8.8.2.4.1" xref="S4.SS3.p2.22.m9.8.8.2.3.cmml">,</mo><mn id="S4.SS3.p2.22.m9.8.8.2.2" xref="S4.SS3.p2.22.m9.8.8.2.2.cmml">1</mn></mrow><mi id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.3" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.22.m9.12.12.4.2.2.2.1" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.1.cmml">/</mo><mi id="S4.SS3.p2.22.m9.12.12.4.2.2.2.3" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.3.cmml">λ</mi></mrow><mo stretchy="false" id="S4.SS3.p2.22.m9.12.12.4.2.2.5" xref="S4.SS3.p2.22.m9.12.12.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.22.m9.12b"><apply id="S4.SS3.p2.22.m9.12.12.cmml" xref="S4.SS3.p2.22.m9.12.12"><eq id="S4.SS3.p2.22.m9.12.12.5.cmml" xref="S4.SS3.p2.22.m9.12.12.5"></eq><list id="S4.SS3.p2.22.m9.10.10.2.3.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2"><apply id="S4.SS3.p2.22.m9.9.9.1.1.1.cmml" xref="S4.SS3.p2.22.m9.9.9.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.22.m9.9.9.1.1.1.1.cmml" xref="S4.SS3.p2.22.m9.9.9.1.1.1">superscript</csymbol><apply id="S4.SS3.p2.22.m9.9.9.1.1.1.2.cmml" xref="S4.SS3.p2.22.m9.9.9.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.22.m9.9.9.1.1.1.2.1.cmml" xref="S4.SS3.p2.22.m9.9.9.1.1.1">subscript</csymbol><apply id="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.cmml" xref="S4.SS3.p2.22.m9.9.9.1.1.1.2.2"><ci id="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.1.cmml" xref="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.1">^</ci><ci id="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.2.cmml" xref="S4.SS3.p2.22.m9.9.9.1.1.1.2.2.2">𝛼</ci></apply><list id="S4.SS3.p2.22.m9.2.2.2.3.cmml" xref="S4.SS3.p2.22.m9.2.2.2.4"><cn type="integer" id="S4.SS3.p2.22.m9.1.1.1.1.cmml" xref="S4.SS3.p2.22.m9.1.1.1.1">0</cn><cn type="integer" id="S4.SS3.p2.22.m9.2.2.2.2.cmml" xref="S4.SS3.p2.22.m9.2.2.2.2">0</cn></list></apply><ci id="S4.SS3.p2.22.m9.9.9.1.1.1.3.cmml" xref="S4.SS3.p2.22.m9.9.9.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p2.22.m9.10.10.2.2.2.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.22.m9.10.10.2.2.2.1.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2.2">superscript</csymbol><apply id="S4.SS3.p2.22.m9.10.10.2.2.2.2.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.22.m9.10.10.2.2.2.2.1.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2.2">subscript</csymbol><apply id="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2.2.2.2"><ci id="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.1.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.1">^</ci><ci id="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.2.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2.2.2.2.2">𝛼</ci></apply><list id="S4.SS3.p2.22.m9.4.4.2.3.cmml" xref="S4.SS3.p2.22.m9.4.4.2.4"><cn type="integer" id="S4.SS3.p2.22.m9.3.3.1.1.cmml" xref="S4.SS3.p2.22.m9.3.3.1.1">0</cn><cn type="integer" id="S4.SS3.p2.22.m9.4.4.2.2.cmml" xref="S4.SS3.p2.22.m9.4.4.2.2">1</cn></list></apply><ci id="S4.SS3.p2.22.m9.10.10.2.2.2.3.cmml" xref="S4.SS3.p2.22.m9.10.10.2.2.2.3">𝑘</ci></apply></list><apply id="S4.SS3.p2.22.m9.12.12.4.cmml" xref="S4.SS3.p2.22.m9.12.12.4"><times id="S4.SS3.p2.22.m9.12.12.4.3.cmml" xref="S4.SS3.p2.22.m9.12.12.4.3"></times><ci id="S4.SS3.p2.22.m9.12.12.4.4a.cmml" xref="S4.SS3.p2.22.m9.12.12.4.4"><mtext id="S4.SS3.p2.22.m9.12.12.4.4.cmml" xref="S4.SS3.p2.22.m9.12.12.4.4">SoftMax</mtext></ci><interval closure="open" id="S4.SS3.p2.22.m9.12.12.4.2.3.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2"><apply id="S4.SS3.p2.22.m9.11.11.3.1.1.1.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1"><divide id="S4.SS3.p2.22.m9.11.11.3.1.1.1.1.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.1"></divide><apply id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.1.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2">superscript</csymbol><apply id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.2.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.2.1.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.2.2.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.2.2">𝛼</ci><list id="S4.SS3.p2.22.m9.6.6.2.3.cmml" xref="S4.SS3.p2.22.m9.6.6.2.4"><cn type="integer" id="S4.SS3.p2.22.m9.5.5.1.1.cmml" xref="S4.SS3.p2.22.m9.5.5.1.1">0</cn><cn type="integer" id="S4.SS3.p2.22.m9.6.6.2.2.cmml" xref="S4.SS3.p2.22.m9.6.6.2.2">0</cn></list></apply><ci id="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.3.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS3.p2.22.m9.11.11.3.1.1.1.3.cmml" xref="S4.SS3.p2.22.m9.11.11.3.1.1.1.3">𝜆</ci></apply><apply id="S4.SS3.p2.22.m9.12.12.4.2.2.2.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2"><divide id="S4.SS3.p2.22.m9.12.12.4.2.2.2.1.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.1"></divide><apply id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.1.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.2.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.2.1.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.2.2.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.2.2">𝛼</ci><list id="S4.SS3.p2.22.m9.8.8.2.3.cmml" xref="S4.SS3.p2.22.m9.8.8.2.4"><cn type="integer" id="S4.SS3.p2.22.m9.7.7.1.1.cmml" xref="S4.SS3.p2.22.m9.7.7.1.1">0</cn><cn type="integer" id="S4.SS3.p2.22.m9.8.8.2.2.cmml" xref="S4.SS3.p2.22.m9.8.8.2.2">1</cn></list></apply><ci id="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.3.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.2.3">𝑘</ci></apply><ci id="S4.SS3.p2.22.m9.12.12.4.2.2.2.3.cmml" xref="S4.SS3.p2.22.m9.12.12.4.2.2.2.3">𝜆</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.22.m9.12c">\hat{\alpha}_{0,0}^{k},\hat{\alpha}_{0,1}^{k}=\text{SoftMax}(\alpha_{0,0}^{k}/\lambda,\alpha_{0,1}^{k}/\lambda)</annotation></semantics></math>, and <math id="S4.SS3.p2.23.m10.12" class="ltx_Math" alttext="\hat{\alpha}_{1,0}^{k},\hat{\alpha}_{1,1}^{k}=\text{SoftMax}(\alpha_{1,0}^{k}/\lambda,\alpha_{1,1}^{k}/\lambda)" display="inline"><semantics id="S4.SS3.p2.23.m10.12a"><mrow id="S4.SS3.p2.23.m10.12.12" xref="S4.SS3.p2.23.m10.12.12.cmml"><mrow id="S4.SS3.p2.23.m10.10.10.2.2" xref="S4.SS3.p2.23.m10.10.10.2.3.cmml"><msubsup id="S4.SS3.p2.23.m10.9.9.1.1.1" xref="S4.SS3.p2.23.m10.9.9.1.1.1.cmml"><mover accent="true" id="S4.SS3.p2.23.m10.9.9.1.1.1.2.2" xref="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.cmml"><mi id="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.2" xref="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.2.cmml">α</mi><mo id="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.1" xref="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p2.23.m10.2.2.2.4" xref="S4.SS3.p2.23.m10.2.2.2.3.cmml"><mn id="S4.SS3.p2.23.m10.1.1.1.1" xref="S4.SS3.p2.23.m10.1.1.1.1.cmml">1</mn><mo id="S4.SS3.p2.23.m10.2.2.2.4.1" xref="S4.SS3.p2.23.m10.2.2.2.3.cmml">,</mo><mn id="S4.SS3.p2.23.m10.2.2.2.2" xref="S4.SS3.p2.23.m10.2.2.2.2.cmml">0</mn></mrow><mi id="S4.SS3.p2.23.m10.9.9.1.1.1.3" xref="S4.SS3.p2.23.m10.9.9.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.23.m10.10.10.2.2.3" xref="S4.SS3.p2.23.m10.10.10.2.3.cmml">,</mo><msubsup id="S4.SS3.p2.23.m10.10.10.2.2.2" xref="S4.SS3.p2.23.m10.10.10.2.2.2.cmml"><mover accent="true" id="S4.SS3.p2.23.m10.10.10.2.2.2.2.2" xref="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.cmml"><mi id="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.2" xref="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.2.cmml">α</mi><mo id="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.1" xref="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p2.23.m10.4.4.2.4" xref="S4.SS3.p2.23.m10.4.4.2.3.cmml"><mn id="S4.SS3.p2.23.m10.3.3.1.1" xref="S4.SS3.p2.23.m10.3.3.1.1.cmml">1</mn><mo id="S4.SS3.p2.23.m10.4.4.2.4.1" xref="S4.SS3.p2.23.m10.4.4.2.3.cmml">,</mo><mn id="S4.SS3.p2.23.m10.4.4.2.2" xref="S4.SS3.p2.23.m10.4.4.2.2.cmml">1</mn></mrow><mi id="S4.SS3.p2.23.m10.10.10.2.2.2.3" xref="S4.SS3.p2.23.m10.10.10.2.2.2.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS3.p2.23.m10.12.12.5" xref="S4.SS3.p2.23.m10.12.12.5.cmml">=</mo><mrow id="S4.SS3.p2.23.m10.12.12.4" xref="S4.SS3.p2.23.m10.12.12.4.cmml"><mtext id="S4.SS3.p2.23.m10.12.12.4.4" xref="S4.SS3.p2.23.m10.12.12.4.4a.cmml">SoftMax</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p2.23.m10.12.12.4.3" xref="S4.SS3.p2.23.m10.12.12.4.3.cmml">​</mo><mrow id="S4.SS3.p2.23.m10.12.12.4.2.2" xref="S4.SS3.p2.23.m10.12.12.4.2.3.cmml"><mo stretchy="false" id="S4.SS3.p2.23.m10.12.12.4.2.2.3" xref="S4.SS3.p2.23.m10.12.12.4.2.3.cmml">(</mo><mrow id="S4.SS3.p2.23.m10.11.11.3.1.1.1" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.cmml"><msubsup id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.cmml"><mi id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.2.2" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.2.2.cmml">α</mi><mrow id="S4.SS3.p2.23.m10.6.6.2.4" xref="S4.SS3.p2.23.m10.6.6.2.3.cmml"><mn id="S4.SS3.p2.23.m10.5.5.1.1" xref="S4.SS3.p2.23.m10.5.5.1.1.cmml">1</mn><mo id="S4.SS3.p2.23.m10.6.6.2.4.1" xref="S4.SS3.p2.23.m10.6.6.2.3.cmml">,</mo><mn id="S4.SS3.p2.23.m10.6.6.2.2" xref="S4.SS3.p2.23.m10.6.6.2.2.cmml">0</mn></mrow><mi id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.3" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.23.m10.11.11.3.1.1.1.1" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.1.cmml">/</mo><mi id="S4.SS3.p2.23.m10.11.11.3.1.1.1.3" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.3.cmml">λ</mi></mrow><mo id="S4.SS3.p2.23.m10.12.12.4.2.2.4" xref="S4.SS3.p2.23.m10.12.12.4.2.3.cmml">,</mo><mrow id="S4.SS3.p2.23.m10.12.12.4.2.2.2" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.cmml"><msubsup id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.cmml"><mi id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.2.2" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.2.2.cmml">α</mi><mrow id="S4.SS3.p2.23.m10.8.8.2.4" xref="S4.SS3.p2.23.m10.8.8.2.3.cmml"><mn id="S4.SS3.p2.23.m10.7.7.1.1" xref="S4.SS3.p2.23.m10.7.7.1.1.cmml">1</mn><mo id="S4.SS3.p2.23.m10.8.8.2.4.1" xref="S4.SS3.p2.23.m10.8.8.2.3.cmml">,</mo><mn id="S4.SS3.p2.23.m10.8.8.2.2" xref="S4.SS3.p2.23.m10.8.8.2.2.cmml">1</mn></mrow><mi id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.3" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p2.23.m10.12.12.4.2.2.2.1" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.1.cmml">/</mo><mi id="S4.SS3.p2.23.m10.12.12.4.2.2.2.3" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.3.cmml">λ</mi></mrow><mo stretchy="false" id="S4.SS3.p2.23.m10.12.12.4.2.2.5" xref="S4.SS3.p2.23.m10.12.12.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.23.m10.12b"><apply id="S4.SS3.p2.23.m10.12.12.cmml" xref="S4.SS3.p2.23.m10.12.12"><eq id="S4.SS3.p2.23.m10.12.12.5.cmml" xref="S4.SS3.p2.23.m10.12.12.5"></eq><list id="S4.SS3.p2.23.m10.10.10.2.3.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2"><apply id="S4.SS3.p2.23.m10.9.9.1.1.1.cmml" xref="S4.SS3.p2.23.m10.9.9.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.23.m10.9.9.1.1.1.1.cmml" xref="S4.SS3.p2.23.m10.9.9.1.1.1">superscript</csymbol><apply id="S4.SS3.p2.23.m10.9.9.1.1.1.2.cmml" xref="S4.SS3.p2.23.m10.9.9.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.23.m10.9.9.1.1.1.2.1.cmml" xref="S4.SS3.p2.23.m10.9.9.1.1.1">subscript</csymbol><apply id="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.cmml" xref="S4.SS3.p2.23.m10.9.9.1.1.1.2.2"><ci id="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.1.cmml" xref="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.1">^</ci><ci id="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.2.cmml" xref="S4.SS3.p2.23.m10.9.9.1.1.1.2.2.2">𝛼</ci></apply><list id="S4.SS3.p2.23.m10.2.2.2.3.cmml" xref="S4.SS3.p2.23.m10.2.2.2.4"><cn type="integer" id="S4.SS3.p2.23.m10.1.1.1.1.cmml" xref="S4.SS3.p2.23.m10.1.1.1.1">1</cn><cn type="integer" id="S4.SS3.p2.23.m10.2.2.2.2.cmml" xref="S4.SS3.p2.23.m10.2.2.2.2">0</cn></list></apply><ci id="S4.SS3.p2.23.m10.9.9.1.1.1.3.cmml" xref="S4.SS3.p2.23.m10.9.9.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p2.23.m10.10.10.2.2.2.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.23.m10.10.10.2.2.2.1.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2.2">superscript</csymbol><apply id="S4.SS3.p2.23.m10.10.10.2.2.2.2.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.23.m10.10.10.2.2.2.2.1.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2.2">subscript</csymbol><apply id="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2.2.2.2"><ci id="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.1.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.1">^</ci><ci id="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.2.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2.2.2.2.2">𝛼</ci></apply><list id="S4.SS3.p2.23.m10.4.4.2.3.cmml" xref="S4.SS3.p2.23.m10.4.4.2.4"><cn type="integer" id="S4.SS3.p2.23.m10.3.3.1.1.cmml" xref="S4.SS3.p2.23.m10.3.3.1.1">1</cn><cn type="integer" id="S4.SS3.p2.23.m10.4.4.2.2.cmml" xref="S4.SS3.p2.23.m10.4.4.2.2">1</cn></list></apply><ci id="S4.SS3.p2.23.m10.10.10.2.2.2.3.cmml" xref="S4.SS3.p2.23.m10.10.10.2.2.2.3">𝑘</ci></apply></list><apply id="S4.SS3.p2.23.m10.12.12.4.cmml" xref="S4.SS3.p2.23.m10.12.12.4"><times id="S4.SS3.p2.23.m10.12.12.4.3.cmml" xref="S4.SS3.p2.23.m10.12.12.4.3"></times><ci id="S4.SS3.p2.23.m10.12.12.4.4a.cmml" xref="S4.SS3.p2.23.m10.12.12.4.4"><mtext id="S4.SS3.p2.23.m10.12.12.4.4.cmml" xref="S4.SS3.p2.23.m10.12.12.4.4">SoftMax</mtext></ci><interval closure="open" id="S4.SS3.p2.23.m10.12.12.4.2.3.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2"><apply id="S4.SS3.p2.23.m10.11.11.3.1.1.1.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1"><divide id="S4.SS3.p2.23.m10.11.11.3.1.1.1.1.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.1"></divide><apply id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.1.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2">superscript</csymbol><apply id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.2.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.2.1.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.2.2.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.2.2">𝛼</ci><list id="S4.SS3.p2.23.m10.6.6.2.3.cmml" xref="S4.SS3.p2.23.m10.6.6.2.4"><cn type="integer" id="S4.SS3.p2.23.m10.5.5.1.1.cmml" xref="S4.SS3.p2.23.m10.5.5.1.1">1</cn><cn type="integer" id="S4.SS3.p2.23.m10.6.6.2.2.cmml" xref="S4.SS3.p2.23.m10.6.6.2.2">0</cn></list></apply><ci id="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.3.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS3.p2.23.m10.11.11.3.1.1.1.3.cmml" xref="S4.SS3.p2.23.m10.11.11.3.1.1.1.3">𝜆</ci></apply><apply id="S4.SS3.p2.23.m10.12.12.4.2.2.2.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2"><divide id="S4.SS3.p2.23.m10.12.12.4.2.2.2.1.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.1"></divide><apply id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.1.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.2.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.2.1.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.2.2.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.2.2">𝛼</ci><list id="S4.SS3.p2.23.m10.8.8.2.3.cmml" xref="S4.SS3.p2.23.m10.8.8.2.4"><cn type="integer" id="S4.SS3.p2.23.m10.7.7.1.1.cmml" xref="S4.SS3.p2.23.m10.7.7.1.1">1</cn><cn type="integer" id="S4.SS3.p2.23.m10.8.8.2.2.cmml" xref="S4.SS3.p2.23.m10.8.8.2.2">1</cn></list></apply><ci id="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.3.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.2.3">𝑘</ci></apply><ci id="S4.SS3.p2.23.m10.12.12.4.2.2.2.3.cmml" xref="S4.SS3.p2.23.m10.12.12.4.2.2.2.3">𝜆</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.23.m10.12c">\hat{\alpha}_{1,0}^{k},\hat{\alpha}_{1,1}^{k}=\text{SoftMax}(\alpha_{1,0}^{k}/\lambda,\alpha_{1,1}^{k}/\lambda)</annotation></semantics></math>. <math id="S4.SS3.p2.24.m11.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS3.p2.24.m11.1a"><mi id="S4.SS3.p2.24.m11.1.1" xref="S4.SS3.p2.24.m11.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.24.m11.1b"><ci id="S4.SS3.p2.24.m11.1.1.cmml" xref="S4.SS3.p2.24.m11.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.24.m11.1c">\lambda</annotation></semantics></math> is the temperature. In our experiments, taking it as <math id="S4.SS3.p2.25.m12.1" class="ltx_Math" alttext="2.0" display="inline"><semantics id="S4.SS3.p2.25.m12.1a"><mn id="S4.SS3.p2.25.m12.1.1" xref="S4.SS3.p2.25.m12.1.1.cmml">2.0</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.25.m12.1b"><cn type="float" id="S4.SS3.p2.25.m12.1.1.cmml" xref="S4.SS3.p2.25.m12.1.1">2.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.25.m12.1c">2.0</annotation></semantics></math> could lead to slightly better results.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.4" class="ltx_p">For soft attention, we take a simple weighted average of the features as follows:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.13" class="ltx_Math" alttext="\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}\triangleq\hat{\alpha}_{0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},\qquad\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}\triangleq\hat{\alpha}_{0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k}," display="block"><semantics id="S4.E8.m1.13a"><mrow id="S4.E8.m1.13.13.1"><mrow id="S4.E8.m1.13.13.1.1.2" xref="S4.E8.m1.13.13.1.1.3.cmml"><mrow id="S4.E8.m1.13.13.1.1.1.1" xref="S4.E8.m1.13.13.1.1.1.1.cmml"><msubsup id="S4.E8.m1.13.13.1.1.1.1.2" xref="S4.E8.m1.13.13.1.1.1.1.2.cmml"><mover accent="true" id="S4.E8.m1.13.13.1.1.1.1.2.2.2" xref="S4.E8.m1.13.13.1.1.1.1.2.2.2.cmml"><mi id="S4.E8.m1.13.13.1.1.1.1.2.2.2.2" xref="S4.E8.m1.13.13.1.1.1.1.2.2.2.2.cmml">𝐡</mi><mo id="S4.E8.m1.13.13.1.1.1.1.2.2.2.1" xref="S4.E8.m1.13.13.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E8.m1.2.2.2.4" xref="S4.E8.m1.2.2.2.3.cmml"><mtext id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.E8.m1.2.2.2.4.1" xref="S4.E8.m1.2.2.2.3.cmml">,</mo><mi id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.E8.m1.13.13.1.1.1.1.2.3" xref="S4.E8.m1.13.13.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.E8.m1.13.13.1.1.1.1.1" xref="S4.E8.m1.13.13.1.1.1.1.1.cmml">≜</mo><mrow id="S4.E8.m1.13.13.1.1.1.1.3" xref="S4.E8.m1.13.13.1.1.1.1.3.cmml"><mrow id="S4.E8.m1.13.13.1.1.1.1.3.2" xref="S4.E8.m1.13.13.1.1.1.1.3.2.cmml"><msubsup id="S4.E8.m1.13.13.1.1.1.1.3.2.2" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.cmml"><mover accent="true" id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.cmml"><mi id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.2" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.2.cmml">α</mi><mo id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.1" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.3" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.3.cmml">0</mn><mi id="S4.E8.m1.13.13.1.1.1.1.3.2.2.3" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.13.13.1.1.1.1.3.2.1" xref="S4.E8.m1.13.13.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E8.m1.13.13.1.1.1.1.3.2.3" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3.cmml"><mi id="S4.E8.m1.13.13.1.1.1.1.3.2.3.2.2" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3.2.2.cmml">𝐡</mi><mrow id="S4.E8.m1.4.4.2.4" xref="S4.E8.m1.4.4.2.3.cmml"><mtext id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1a.cmml">s</mtext><mo id="S4.E8.m1.4.4.2.4.1" xref="S4.E8.m1.4.4.2.3.cmml">,</mo><mi id="S4.E8.m1.4.4.2.2" xref="S4.E8.m1.4.4.2.2.cmml">i</mi></mrow><mi id="S4.E8.m1.13.13.1.1.1.1.3.2.3.3" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E8.m1.13.13.1.1.1.1.3.1" xref="S4.E8.m1.13.13.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E8.m1.13.13.1.1.1.1.3.3" xref="S4.E8.m1.13.13.1.1.1.1.3.3.cmml"><msubsup id="S4.E8.m1.13.13.1.1.1.1.3.3.2" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.cmml"><mover accent="true" id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.cmml"><mi id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.2" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.2.cmml">α</mi><mo id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.1" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.1.cmml">^</mo></mover><mn id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.3" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.3.cmml">1</mn><mi id="S4.E8.m1.13.13.1.1.1.1.3.3.2.3" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.13.13.1.1.1.1.3.3.1" xref="S4.E8.m1.13.13.1.1.1.1.3.3.1.cmml">​</mo><msubsup id="S4.E8.m1.13.13.1.1.1.1.3.3.3" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3.cmml"><mi id="S4.E8.m1.13.13.1.1.1.1.3.3.3.2.2" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3.2.2.cmml">𝐡</mi><mrow id="S4.E8.m1.6.6.2.4" xref="S4.E8.m1.6.6.2.3.cmml"><mtext id="S4.E8.m1.5.5.1.1" xref="S4.E8.m1.5.5.1.1a.cmml">p</mtext><mo id="S4.E8.m1.6.6.2.4.1" xref="S4.E8.m1.6.6.2.3.cmml">,</mo><mi id="S4.E8.m1.6.6.2.2" xref="S4.E8.m1.6.6.2.2.cmml">i</mi></mrow><mi id="S4.E8.m1.13.13.1.1.1.1.3.3.3.3" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo rspace="2.167em" id="S4.E8.m1.13.13.1.1.2.3" xref="S4.E8.m1.13.13.1.1.3a.cmml">,</mo><mrow id="S4.E8.m1.13.13.1.1.2.2" xref="S4.E8.m1.13.13.1.1.2.2.cmml"><msubsup id="S4.E8.m1.13.13.1.1.2.2.2" xref="S4.E8.m1.13.13.1.1.2.2.2.cmml"><mover accent="true" id="S4.E8.m1.13.13.1.1.2.2.2.2.2" xref="S4.E8.m1.13.13.1.1.2.2.2.2.2.cmml"><mi id="S4.E8.m1.13.13.1.1.2.2.2.2.2.2" xref="S4.E8.m1.13.13.1.1.2.2.2.2.2.2.cmml">𝐡</mi><mo id="S4.E8.m1.13.13.1.1.2.2.2.2.2.1" xref="S4.E8.m1.13.13.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E8.m1.8.8.2.4" xref="S4.E8.m1.8.8.2.3.cmml"><mtext id="S4.E8.m1.7.7.1.1" xref="S4.E8.m1.7.7.1.1a.cmml">p</mtext><mo id="S4.E8.m1.8.8.2.4.1" xref="S4.E8.m1.8.8.2.3.cmml">,</mo><mi id="S4.E8.m1.8.8.2.2" xref="S4.E8.m1.8.8.2.2.cmml">i</mi></mrow><mi id="S4.E8.m1.13.13.1.1.2.2.2.3" xref="S4.E8.m1.13.13.1.1.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.E8.m1.13.13.1.1.2.2.1" xref="S4.E8.m1.13.13.1.1.2.2.1.cmml">≜</mo><mrow id="S4.E8.m1.13.13.1.1.2.2.3" xref="S4.E8.m1.13.13.1.1.2.2.3.cmml"><mrow id="S4.E8.m1.13.13.1.1.2.2.3.2" xref="S4.E8.m1.13.13.1.1.2.2.3.2.cmml"><msubsup id="S4.E8.m1.13.13.1.1.2.2.3.2.2" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.cmml"><mover accent="true" id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.cmml"><mi id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.2" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.2.cmml">α</mi><mo id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.1" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.3" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.3.cmml">0</mn><mi id="S4.E8.m1.13.13.1.1.2.2.3.2.2.3" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.13.13.1.1.2.2.3.2.1" xref="S4.E8.m1.13.13.1.1.2.2.3.2.1.cmml">​</mo><msubsup id="S4.E8.m1.13.13.1.1.2.2.3.2.3" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3.cmml"><mi id="S4.E8.m1.13.13.1.1.2.2.3.2.3.2.2" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3.2.2.cmml">𝐡</mi><mrow id="S4.E8.m1.10.10.2.4" xref="S4.E8.m1.10.10.2.3.cmml"><mtext id="S4.E8.m1.9.9.1.1" xref="S4.E8.m1.9.9.1.1a.cmml">s</mtext><mo id="S4.E8.m1.10.10.2.4.1" xref="S4.E8.m1.10.10.2.3.cmml">,</mo><mi id="S4.E8.m1.10.10.2.2" xref="S4.E8.m1.10.10.2.2.cmml">i</mi></mrow><mi id="S4.E8.m1.13.13.1.1.2.2.3.2.3.3" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E8.m1.13.13.1.1.2.2.3.1" xref="S4.E8.m1.13.13.1.1.2.2.3.1.cmml">+</mo><mrow id="S4.E8.m1.13.13.1.1.2.2.3.3" xref="S4.E8.m1.13.13.1.1.2.2.3.3.cmml"><msubsup id="S4.E8.m1.13.13.1.1.2.2.3.3.2" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.cmml"><mover accent="true" id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.cmml"><mi id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.2" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.2.cmml">α</mi><mo id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.1" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.1.cmml">^</mo></mover><mn id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.3" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.3.cmml">1</mn><mi id="S4.E8.m1.13.13.1.1.2.2.3.3.2.3" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.13.13.1.1.2.2.3.3.1" xref="S4.E8.m1.13.13.1.1.2.2.3.3.1.cmml">​</mo><msubsup id="S4.E8.m1.13.13.1.1.2.2.3.3.3" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3.cmml"><mi id="S4.E8.m1.13.13.1.1.2.2.3.3.3.2.2" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3.2.2.cmml">𝐡</mi><mrow id="S4.E8.m1.12.12.2.4" xref="S4.E8.m1.12.12.2.3.cmml"><mtext id="S4.E8.m1.11.11.1.1" xref="S4.E8.m1.11.11.1.1a.cmml">p</mtext><mo id="S4.E8.m1.12.12.2.4.1" xref="S4.E8.m1.12.12.2.3.cmml">,</mo><mi id="S4.E8.m1.12.12.2.2" xref="S4.E8.m1.12.12.2.2.cmml">i</mi></mrow><mi id="S4.E8.m1.13.13.1.1.2.2.3.3.3.3" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.13.13.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.13b"><apply id="S4.E8.m1.13.13.1.1.3.cmml" xref="S4.E8.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.3a.cmml" xref="S4.E8.m1.13.13.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1"><ci id="S4.E8.m1.13.13.1.1.1.1.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.1">≜</ci><apply id="S4.E8.m1.13.13.1.1.1.1.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.2">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.2">subscript</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.2.2.2"><ci id="S4.E8.m1.13.13.1.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.2.2.2.1">^</ci><ci id="S4.E8.m1.13.13.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.2.2.2.2">𝐡</ci></apply><list id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.4"><ci id="S4.E8.m1.1.1.1.1a.cmml" xref="S4.E8.m1.1.1.1.1"><mtext mathsize="70%" id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">s</mtext></ci><ci id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.E8.m1.13.13.1.1.1.1.2.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E8.m1.13.13.1.1.1.1.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3"><plus id="S4.E8.m1.13.13.1.1.1.1.3.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.1"></plus><apply id="S4.E8.m1.13.13.1.1.1.1.3.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2"><times id="S4.E8.m1.13.13.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.1"></times><apply id="S4.E8.m1.13.13.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.3.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2">subscript</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2"><ci id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.1">^</ci><ci id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.2.3">0</cn></apply><ci id="S4.E8.m1.13.13.1.1.1.1.3.2.2.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S4.E8.m1.13.13.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.3.2.3.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.3.2.3.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.3.2.3.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E8.m1.13.13.1.1.1.1.3.2.3.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3.2.2">𝐡</ci><list id="S4.E8.m1.4.4.2.3.cmml" xref="S4.E8.m1.4.4.2.4"><ci id="S4.E8.m1.3.3.1.1a.cmml" xref="S4.E8.m1.3.3.1.1"><mtext mathsize="70%" id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1">s</mtext></ci><ci id="S4.E8.m1.4.4.2.2.cmml" xref="S4.E8.m1.4.4.2.2">𝑖</ci></list></apply><ci id="S4.E8.m1.13.13.1.1.1.1.3.2.3.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S4.E8.m1.13.13.1.1.1.1.3.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3"><times id="S4.E8.m1.13.13.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.1"></times><apply id="S4.E8.m1.13.13.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.3.3.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2">subscript</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2"><ci id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.1">^</ci><ci id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.2.3">1</cn></apply><ci id="S4.E8.m1.13.13.1.1.1.1.3.3.2.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.2.3">𝑘</ci></apply><apply id="S4.E8.m1.13.13.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.3.3.3.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.1.1.3.3.3.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.1.1.3.3.3.2.1.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E8.m1.13.13.1.1.1.1.3.3.3.2.2.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3.2.2">𝐡</ci><list id="S4.E8.m1.6.6.2.3.cmml" xref="S4.E8.m1.6.6.2.4"><ci id="S4.E8.m1.5.5.1.1a.cmml" xref="S4.E8.m1.5.5.1.1"><mtext mathsize="70%" id="S4.E8.m1.5.5.1.1.cmml" xref="S4.E8.m1.5.5.1.1">p</mtext></ci><ci id="S4.E8.m1.6.6.2.2.cmml" xref="S4.E8.m1.6.6.2.2">𝑖</ci></list></apply><ci id="S4.E8.m1.13.13.1.1.1.1.3.3.3.3.cmml" xref="S4.E8.m1.13.13.1.1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S4.E8.m1.13.13.1.1.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2"><ci id="S4.E8.m1.13.13.1.1.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.1">≜</ci><apply id="S4.E8.m1.13.13.1.1.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.2">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.2">subscript</csymbol><apply id="S4.E8.m1.13.13.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.2.2.2"><ci id="S4.E8.m1.13.13.1.1.2.2.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.2.2.2.1">^</ci><ci id="S4.E8.m1.13.13.1.1.2.2.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.2.2.2.2">𝐡</ci></apply><list id="S4.E8.m1.8.8.2.3.cmml" xref="S4.E8.m1.8.8.2.4"><ci id="S4.E8.m1.7.7.1.1a.cmml" xref="S4.E8.m1.7.7.1.1"><mtext mathsize="70%" id="S4.E8.m1.7.7.1.1.cmml" xref="S4.E8.m1.7.7.1.1">p</mtext></ci><ci id="S4.E8.m1.8.8.2.2.cmml" xref="S4.E8.m1.8.8.2.2">𝑖</ci></list></apply><ci id="S4.E8.m1.13.13.1.1.2.2.2.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.2.3">𝑘</ci></apply><apply id="S4.E8.m1.13.13.1.1.2.2.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3"><plus id="S4.E8.m1.13.13.1.1.2.2.3.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.1"></plus><apply id="S4.E8.m1.13.13.1.1.2.2.3.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2"><times id="S4.E8.m1.13.13.1.1.2.2.3.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.1"></times><apply id="S4.E8.m1.13.13.1.1.2.2.3.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.3.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2">subscript</csymbol><apply id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2"><ci id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.1">^</ci><ci id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.2.3">0</cn></apply><ci id="S4.E8.m1.13.13.1.1.2.2.3.2.2.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.2.3">𝑘</ci></apply><apply id="S4.E8.m1.13.13.1.1.2.2.3.2.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.3.2.3.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.2.2.3.2.3.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.3.2.3.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3">subscript</csymbol><ci id="S4.E8.m1.13.13.1.1.2.2.3.2.3.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3.2.2">𝐡</ci><list id="S4.E8.m1.10.10.2.3.cmml" xref="S4.E8.m1.10.10.2.4"><ci id="S4.E8.m1.9.9.1.1a.cmml" xref="S4.E8.m1.9.9.1.1"><mtext mathsize="70%" id="S4.E8.m1.9.9.1.1.cmml" xref="S4.E8.m1.9.9.1.1">s</mtext></ci><ci id="S4.E8.m1.10.10.2.2.cmml" xref="S4.E8.m1.10.10.2.2">𝑖</ci></list></apply><ci id="S4.E8.m1.13.13.1.1.2.2.3.2.3.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.2.3.3">𝑘</ci></apply></apply><apply id="S4.E8.m1.13.13.1.1.2.2.3.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3"><times id="S4.E8.m1.13.13.1.1.2.2.3.3.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.1"></times><apply id="S4.E8.m1.13.13.1.1.2.2.3.3.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.3.3.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2">subscript</csymbol><apply id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2"><ci id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.1">^</ci><ci id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.2.3">1</cn></apply><ci id="S4.E8.m1.13.13.1.1.2.2.3.3.2.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.2.3">𝑘</ci></apply><apply id="S4.E8.m1.13.13.1.1.2.2.3.3.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.3.3.3.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3">superscript</csymbol><apply id="S4.E8.m1.13.13.1.1.2.2.3.3.3.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.13.13.1.1.2.2.3.3.3.2.1.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3">subscript</csymbol><ci id="S4.E8.m1.13.13.1.1.2.2.3.3.3.2.2.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3.2.2">𝐡</ci><list id="S4.E8.m1.12.12.2.3.cmml" xref="S4.E8.m1.12.12.2.4"><ci id="S4.E8.m1.11.11.1.1a.cmml" xref="S4.E8.m1.11.11.1.1"><mtext mathsize="70%" id="S4.E8.m1.11.11.1.1.cmml" xref="S4.E8.m1.11.11.1.1">p</mtext></ci><ci id="S4.E8.m1.12.12.2.2.cmml" xref="S4.E8.m1.12.12.2.2">𝑖</ci></list></apply><ci id="S4.E8.m1.13.13.1.1.2.2.3.3.3.3.cmml" xref="S4.E8.m1.13.13.1.1.2.2.3.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.13c">\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}\triangleq\hat{\alpha}_{0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},\qquad\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}\triangleq\hat{\alpha}_{0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.3" class="ltx_p">where we can find that this differs from cross-stitch only in that it takes the same weights to generate <math id="S4.SS3.p3.1.m1.2" class="ltx_Math" alttext="\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}" display="inline"><semantics id="S4.SS3.p3.1.m1.2a"><msubsup id="S4.SS3.p3.1.m1.2.3" xref="S4.SS3.p3.1.m1.2.3.cmml"><mover accent="true" id="S4.SS3.p3.1.m1.2.3.2.2" xref="S4.SS3.p3.1.m1.2.3.2.2.cmml"><mi id="S4.SS3.p3.1.m1.2.3.2.2.2" xref="S4.SS3.p3.1.m1.2.3.2.2.2.cmml">𝐡</mi><mo id="S4.SS3.p3.1.m1.2.3.2.2.1" xref="S4.SS3.p3.1.m1.2.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p3.1.m1.2.2.2.4" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml"><mtext id="S4.SS3.p3.1.m1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.SS3.p3.1.m1.2.2.2.4.1" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.1.m1.2.2.2.2" xref="S4.SS3.p3.1.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.SS3.p3.1.m1.2.3.3" xref="S4.SS3.p3.1.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.2b"><apply id="S4.SS3.p3.1.m1.2.3.cmml" xref="S4.SS3.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.3.1.cmml" xref="S4.SS3.p3.1.m1.2.3">superscript</csymbol><apply id="S4.SS3.p3.1.m1.2.3.2.cmml" xref="S4.SS3.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.3.2.1.cmml" xref="S4.SS3.p3.1.m1.2.3">subscript</csymbol><apply id="S4.SS3.p3.1.m1.2.3.2.2.cmml" xref="S4.SS3.p3.1.m1.2.3.2.2"><ci id="S4.SS3.p3.1.m1.2.3.2.2.1.cmml" xref="S4.SS3.p3.1.m1.2.3.2.2.1">^</ci><ci id="S4.SS3.p3.1.m1.2.3.2.2.2.cmml" xref="S4.SS3.p3.1.m1.2.3.2.2.2">𝐡</ci></apply><list id="S4.SS3.p3.1.m1.2.2.2.3.cmml" xref="S4.SS3.p3.1.m1.2.2.2.4"><ci id="S4.SS3.p3.1.m1.1.1.1.1a.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p3.1.m1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1">s</mtext></ci><ci id="S4.SS3.p3.1.m1.2.2.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.SS3.p3.1.m1.2.3.3.cmml" xref="S4.SS3.p3.1.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.2c">\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}</annotation></semantics></math> and <math id="S4.SS3.p3.2.m2.2" class="ltx_Math" alttext="\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}" display="inline"><semantics id="S4.SS3.p3.2.m2.2a"><msubsup id="S4.SS3.p3.2.m2.2.3" xref="S4.SS3.p3.2.m2.2.3.cmml"><mover accent="true" id="S4.SS3.p3.2.m2.2.3.2.2" xref="S4.SS3.p3.2.m2.2.3.2.2.cmml"><mi id="S4.SS3.p3.2.m2.2.3.2.2.2" xref="S4.SS3.p3.2.m2.2.3.2.2.2.cmml">𝐡</mi><mo id="S4.SS3.p3.2.m2.2.3.2.2.1" xref="S4.SS3.p3.2.m2.2.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p3.2.m2.2.2.2.4" xref="S4.SS3.p3.2.m2.2.2.2.3.cmml"><mtext id="S4.SS3.p3.2.m2.1.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.1a.cmml">p</mtext><mo id="S4.SS3.p3.2.m2.2.2.2.4.1" xref="S4.SS3.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.2.m2.2.2.2.2" xref="S4.SS3.p3.2.m2.2.2.2.2.cmml">i</mi></mrow><mi id="S4.SS3.p3.2.m2.2.3.3" xref="S4.SS3.p3.2.m2.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.2b"><apply id="S4.SS3.p3.2.m2.2.3.cmml" xref="S4.SS3.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.2.3.1.cmml" xref="S4.SS3.p3.2.m2.2.3">superscript</csymbol><apply id="S4.SS3.p3.2.m2.2.3.2.cmml" xref="S4.SS3.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.2.3.2.1.cmml" xref="S4.SS3.p3.2.m2.2.3">subscript</csymbol><apply id="S4.SS3.p3.2.m2.2.3.2.2.cmml" xref="S4.SS3.p3.2.m2.2.3.2.2"><ci id="S4.SS3.p3.2.m2.2.3.2.2.1.cmml" xref="S4.SS3.p3.2.m2.2.3.2.2.1">^</ci><ci id="S4.SS3.p3.2.m2.2.3.2.2.2.cmml" xref="S4.SS3.p3.2.m2.2.3.2.2.2">𝐡</ci></apply><list id="S4.SS3.p3.2.m2.2.2.2.3.cmml" xref="S4.SS3.p3.2.m2.2.2.2.4"><ci id="S4.SS3.p3.2.m2.1.1.1.1a.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p3.2.m2.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1">p</mtext></ci><ci id="S4.SS3.p3.2.m2.2.2.2.2.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S4.SS3.p3.2.m2.2.3.3.cmml" xref="S4.SS3.p3.2.m2.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.2c">\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}</annotation></semantics></math>. Similarly, we take <math id="S4.SS3.p3.3.m3.4" class="ltx_Math" alttext="\hat{\alpha}_{0}^{k},\hat{\alpha}_{1}^{k}=\text{SoftMax}(\alpha_{0}^{k}/\lambda,\alpha_{1}^{k}/\lambda)" display="inline"><semantics id="S4.SS3.p3.3.m3.4a"><mrow id="S4.SS3.p3.3.m3.4.4" xref="S4.SS3.p3.3.m3.4.4.cmml"><mrow id="S4.SS3.p3.3.m3.2.2.2.2" xref="S4.SS3.p3.3.m3.2.2.2.3.cmml"><msubsup id="S4.SS3.p3.3.m3.1.1.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS3.p3.3.m3.1.1.1.1.1.2.2" xref="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.cmml"><mi id="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.2" xref="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.2.cmml">α</mi><mo id="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.1" xref="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p3.3.m3.1.1.1.1.1.2.3" xref="S4.SS3.p3.3.m3.1.1.1.1.1.2.3.cmml">0</mn><mi id="S4.SS3.p3.3.m3.1.1.1.1.1.3" xref="S4.SS3.p3.3.m3.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p3.3.m3.2.2.2.2.3" xref="S4.SS3.p3.3.m3.2.2.2.3.cmml">,</mo><msubsup id="S4.SS3.p3.3.m3.2.2.2.2.2" xref="S4.SS3.p3.3.m3.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS3.p3.3.m3.2.2.2.2.2.2.2" xref="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.cmml"><mi id="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.2" xref="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.2.cmml">α</mi><mo id="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.1" xref="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p3.3.m3.2.2.2.2.2.2.3" xref="S4.SS3.p3.3.m3.2.2.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p3.3.m3.2.2.2.2.2.3" xref="S4.SS3.p3.3.m3.2.2.2.2.2.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS3.p3.3.m3.4.4.5" xref="S4.SS3.p3.3.m3.4.4.5.cmml">=</mo><mrow id="S4.SS3.p3.3.m3.4.4.4" xref="S4.SS3.p3.3.m3.4.4.4.cmml"><mtext id="S4.SS3.p3.3.m3.4.4.4.4" xref="S4.SS3.p3.3.m3.4.4.4.4a.cmml">SoftMax</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m3.4.4.4.3" xref="S4.SS3.p3.3.m3.4.4.4.3.cmml">​</mo><mrow id="S4.SS3.p3.3.m3.4.4.4.2.2" xref="S4.SS3.p3.3.m3.4.4.4.2.3.cmml"><mo stretchy="false" id="S4.SS3.p3.3.m3.4.4.4.2.2.3" xref="S4.SS3.p3.3.m3.4.4.4.2.3.cmml">(</mo><mrow id="S4.SS3.p3.3.m3.3.3.3.1.1.1" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.cmml"><msubsup id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.cmml"><mi id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.2" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.2.cmml">α</mi><mn id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.3" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.3.cmml">0</mn><mi id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.3" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p3.3.m3.3.3.3.1.1.1.1" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.1.cmml">/</mo><mi id="S4.SS3.p3.3.m3.3.3.3.1.1.1.3" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.3.cmml">λ</mi></mrow><mo id="S4.SS3.p3.3.m3.4.4.4.2.2.4" xref="S4.SS3.p3.3.m3.4.4.4.2.3.cmml">,</mo><mrow id="S4.SS3.p3.3.m3.4.4.4.2.2.2" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.cmml"><msubsup id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.cmml"><mi id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.2" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.2.cmml">α</mi><mn id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.3" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.3" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p3.3.m3.4.4.4.2.2.2.1" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.1.cmml">/</mo><mi id="S4.SS3.p3.3.m3.4.4.4.2.2.2.3" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.3.cmml">λ</mi></mrow><mo stretchy="false" id="S4.SS3.p3.3.m3.4.4.4.2.2.5" xref="S4.SS3.p3.3.m3.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.4b"><apply id="S4.SS3.p3.3.m3.4.4.cmml" xref="S4.SS3.p3.3.m3.4.4"><eq id="S4.SS3.p3.3.m3.4.4.5.cmml" xref="S4.SS3.p3.3.m3.4.4.5"></eq><list id="S4.SS3.p3.3.m3.2.2.2.3.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2"><apply id="S4.SS3.p3.3.m3.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p3.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1">subscript</csymbol><apply id="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.2.2"><ci id="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.1">^</ci><ci id="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.SS3.p3.3.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p3.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p3.3.m3.2.2.2.2.2.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p3.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2">subscript</csymbol><apply id="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2.2.2"><ci id="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.1">^</ci><ci id="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.SS3.p3.3.m3.2.2.2.2.2.2.3.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p3.3.m3.2.2.2.2.2.3.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.2.3">𝑘</ci></apply></list><apply id="S4.SS3.p3.3.m3.4.4.4.cmml" xref="S4.SS3.p3.3.m3.4.4.4"><times id="S4.SS3.p3.3.m3.4.4.4.3.cmml" xref="S4.SS3.p3.3.m3.4.4.4.3"></times><ci id="S4.SS3.p3.3.m3.4.4.4.4a.cmml" xref="S4.SS3.p3.3.m3.4.4.4.4"><mtext id="S4.SS3.p3.3.m3.4.4.4.4.cmml" xref="S4.SS3.p3.3.m3.4.4.4.4">SoftMax</mtext></ci><interval closure="open" id="S4.SS3.p3.3.m3.4.4.4.2.3.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2"><apply id="S4.SS3.p3.3.m3.3.3.3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1"><divide id="S4.SS3.p3.3.m3.3.3.3.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.1"></divide><apply id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.1.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2">superscript</csymbol><apply id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.1.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.2.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.2">𝛼</ci><cn type="integer" id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.3.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.2.3">0</cn></apply><ci id="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.3.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS3.p3.3.m3.3.3.3.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.3.3.3.1.1.1.3">𝜆</ci></apply><apply id="S4.SS3.p3.3.m3.4.4.4.2.2.2.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2"><divide id="S4.SS3.p3.3.m3.4.4.4.2.2.2.1.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.1"></divide><apply id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.1.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.1.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.2.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.2">𝛼</ci><cn type="integer" id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.3.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.3.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.2.3">𝑘</ci></apply><ci id="S4.SS3.p3.3.m3.4.4.4.2.2.2.3.cmml" xref="S4.SS3.p3.3.m3.4.4.4.2.2.2.3">𝜆</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.4c">\hat{\alpha}_{0}^{k},\hat{\alpha}_{1}^{k}=\text{SoftMax}(\alpha_{0}^{k}/\lambda,\alpha_{1}^{k}/\lambda)</annotation></semantics></math>. We propose this approach to investigate whether the symmetric property of the combination weights matters.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.9" class="ltx_p">For hard selection, we directly select one group of features via the Gumbel-softmax <cite class="ltx_cite ltx_citemacro_citep">(Jang
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2017</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2021</a>)</cite>, i.e.,</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.13" class="ltx_Math" alttext="\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}\triangleq\hat{\alpha}_{0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},\qquad\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}\triangleq\hat{\alpha}_{0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k}," display="block"><semantics id="S4.E9.m1.13a"><mrow id="S4.E9.m1.13.13.1"><mrow id="S4.E9.m1.13.13.1.1.2" xref="S4.E9.m1.13.13.1.1.3.cmml"><mrow id="S4.E9.m1.13.13.1.1.1.1" xref="S4.E9.m1.13.13.1.1.1.1.cmml"><msubsup id="S4.E9.m1.13.13.1.1.1.1.2" xref="S4.E9.m1.13.13.1.1.1.1.2.cmml"><mover accent="true" id="S4.E9.m1.13.13.1.1.1.1.2.2.2" xref="S4.E9.m1.13.13.1.1.1.1.2.2.2.cmml"><mi id="S4.E9.m1.13.13.1.1.1.1.2.2.2.2" xref="S4.E9.m1.13.13.1.1.1.1.2.2.2.2.cmml">𝐡</mi><mo id="S4.E9.m1.13.13.1.1.1.1.2.2.2.1" xref="S4.E9.m1.13.13.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E9.m1.2.2.2.4" xref="S4.E9.m1.2.2.2.3.cmml"><mtext id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.E9.m1.2.2.2.4.1" xref="S4.E9.m1.2.2.2.3.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.E9.m1.13.13.1.1.1.1.2.3" xref="S4.E9.m1.13.13.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.E9.m1.13.13.1.1.1.1.1" xref="S4.E9.m1.13.13.1.1.1.1.1.cmml">≜</mo><mrow id="S4.E9.m1.13.13.1.1.1.1.3" xref="S4.E9.m1.13.13.1.1.1.1.3.cmml"><mrow id="S4.E9.m1.13.13.1.1.1.1.3.2" xref="S4.E9.m1.13.13.1.1.1.1.3.2.cmml"><msubsup id="S4.E9.m1.13.13.1.1.1.1.3.2.2" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.cmml"><mover accent="true" id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.cmml"><mi id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.2" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.2.cmml">α</mi><mo id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.1" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.3" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.3.cmml">0</mn><mi id="S4.E9.m1.13.13.1.1.1.1.3.2.2.3" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.13.13.1.1.1.1.3.2.1" xref="S4.E9.m1.13.13.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E9.m1.13.13.1.1.1.1.3.2.3" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3.cmml"><mi id="S4.E9.m1.13.13.1.1.1.1.3.2.3.2.2" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3.2.2.cmml">𝐡</mi><mrow id="S4.E9.m1.4.4.2.4" xref="S4.E9.m1.4.4.2.3.cmml"><mtext id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1a.cmml">s</mtext><mo id="S4.E9.m1.4.4.2.4.1" xref="S4.E9.m1.4.4.2.3.cmml">,</mo><mi id="S4.E9.m1.4.4.2.2" xref="S4.E9.m1.4.4.2.2.cmml">i</mi></mrow><mi id="S4.E9.m1.13.13.1.1.1.1.3.2.3.3" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E9.m1.13.13.1.1.1.1.3.1" xref="S4.E9.m1.13.13.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E9.m1.13.13.1.1.1.1.3.3" xref="S4.E9.m1.13.13.1.1.1.1.3.3.cmml"><msubsup id="S4.E9.m1.13.13.1.1.1.1.3.3.2" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.cmml"><mover accent="true" id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.cmml"><mi id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.2" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.2.cmml">α</mi><mo id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.1" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.1.cmml">^</mo></mover><mn id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.3" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.3.cmml">1</mn><mi id="S4.E9.m1.13.13.1.1.1.1.3.3.2.3" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.13.13.1.1.1.1.3.3.1" xref="S4.E9.m1.13.13.1.1.1.1.3.3.1.cmml">​</mo><msubsup id="S4.E9.m1.13.13.1.1.1.1.3.3.3" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3.cmml"><mi id="S4.E9.m1.13.13.1.1.1.1.3.3.3.2.2" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3.2.2.cmml">𝐡</mi><mrow id="S4.E9.m1.6.6.2.4" xref="S4.E9.m1.6.6.2.3.cmml"><mtext id="S4.E9.m1.5.5.1.1" xref="S4.E9.m1.5.5.1.1a.cmml">p</mtext><mo id="S4.E9.m1.6.6.2.4.1" xref="S4.E9.m1.6.6.2.3.cmml">,</mo><mi id="S4.E9.m1.6.6.2.2" xref="S4.E9.m1.6.6.2.2.cmml">i</mi></mrow><mi id="S4.E9.m1.13.13.1.1.1.1.3.3.3.3" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo rspace="2.167em" id="S4.E9.m1.13.13.1.1.2.3" xref="S4.E9.m1.13.13.1.1.3a.cmml">,</mo><mrow id="S4.E9.m1.13.13.1.1.2.2" xref="S4.E9.m1.13.13.1.1.2.2.cmml"><msubsup id="S4.E9.m1.13.13.1.1.2.2.2" xref="S4.E9.m1.13.13.1.1.2.2.2.cmml"><mover accent="true" id="S4.E9.m1.13.13.1.1.2.2.2.2.2" xref="S4.E9.m1.13.13.1.1.2.2.2.2.2.cmml"><mi id="S4.E9.m1.13.13.1.1.2.2.2.2.2.2" xref="S4.E9.m1.13.13.1.1.2.2.2.2.2.2.cmml">𝐡</mi><mo id="S4.E9.m1.13.13.1.1.2.2.2.2.2.1" xref="S4.E9.m1.13.13.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E9.m1.8.8.2.4" xref="S4.E9.m1.8.8.2.3.cmml"><mtext id="S4.E9.m1.7.7.1.1" xref="S4.E9.m1.7.7.1.1a.cmml">p</mtext><mo id="S4.E9.m1.8.8.2.4.1" xref="S4.E9.m1.8.8.2.3.cmml">,</mo><mi id="S4.E9.m1.8.8.2.2" xref="S4.E9.m1.8.8.2.2.cmml">i</mi></mrow><mi id="S4.E9.m1.13.13.1.1.2.2.2.3" xref="S4.E9.m1.13.13.1.1.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.E9.m1.13.13.1.1.2.2.1" xref="S4.E9.m1.13.13.1.1.2.2.1.cmml">≜</mo><mrow id="S4.E9.m1.13.13.1.1.2.2.3" xref="S4.E9.m1.13.13.1.1.2.2.3.cmml"><mrow id="S4.E9.m1.13.13.1.1.2.2.3.2" xref="S4.E9.m1.13.13.1.1.2.2.3.2.cmml"><msubsup id="S4.E9.m1.13.13.1.1.2.2.3.2.2" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.cmml"><mover accent="true" id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.cmml"><mi id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.2" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.2.cmml">α</mi><mo id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.1" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.3" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.3.cmml">0</mn><mi id="S4.E9.m1.13.13.1.1.2.2.3.2.2.3" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.13.13.1.1.2.2.3.2.1" xref="S4.E9.m1.13.13.1.1.2.2.3.2.1.cmml">​</mo><msubsup id="S4.E9.m1.13.13.1.1.2.2.3.2.3" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3.cmml"><mi id="S4.E9.m1.13.13.1.1.2.2.3.2.3.2.2" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3.2.2.cmml">𝐡</mi><mrow id="S4.E9.m1.10.10.2.4" xref="S4.E9.m1.10.10.2.3.cmml"><mtext id="S4.E9.m1.9.9.1.1" xref="S4.E9.m1.9.9.1.1a.cmml">s</mtext><mo id="S4.E9.m1.10.10.2.4.1" xref="S4.E9.m1.10.10.2.3.cmml">,</mo><mi id="S4.E9.m1.10.10.2.2" xref="S4.E9.m1.10.10.2.2.cmml">i</mi></mrow><mi id="S4.E9.m1.13.13.1.1.2.2.3.2.3.3" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E9.m1.13.13.1.1.2.2.3.1" xref="S4.E9.m1.13.13.1.1.2.2.3.1.cmml">+</mo><mrow id="S4.E9.m1.13.13.1.1.2.2.3.3" xref="S4.E9.m1.13.13.1.1.2.2.3.3.cmml"><msubsup id="S4.E9.m1.13.13.1.1.2.2.3.3.2" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.cmml"><mover accent="true" id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.cmml"><mi id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.2" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.2.cmml">α</mi><mo id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.1" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.1.cmml">^</mo></mover><mn id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.3" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.3.cmml">1</mn><mi id="S4.E9.m1.13.13.1.1.2.2.3.3.2.3" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.13.13.1.1.2.2.3.3.1" xref="S4.E9.m1.13.13.1.1.2.2.3.3.1.cmml">​</mo><msubsup id="S4.E9.m1.13.13.1.1.2.2.3.3.3" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3.cmml"><mi id="S4.E9.m1.13.13.1.1.2.2.3.3.3.2.2" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3.2.2.cmml">𝐡</mi><mrow id="S4.E9.m1.12.12.2.4" xref="S4.E9.m1.12.12.2.3.cmml"><mtext id="S4.E9.m1.11.11.1.1" xref="S4.E9.m1.11.11.1.1a.cmml">p</mtext><mo id="S4.E9.m1.12.12.2.4.1" xref="S4.E9.m1.12.12.2.3.cmml">,</mo><mi id="S4.E9.m1.12.12.2.2" xref="S4.E9.m1.12.12.2.2.cmml">i</mi></mrow><mi id="S4.E9.m1.13.13.1.1.2.2.3.3.3.3" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow></mrow><mo id="S4.E9.m1.13.13.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.13b"><apply id="S4.E9.m1.13.13.1.1.3.cmml" xref="S4.E9.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.3a.cmml" xref="S4.E9.m1.13.13.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1"><ci id="S4.E9.m1.13.13.1.1.1.1.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.1">≜</ci><apply id="S4.E9.m1.13.13.1.1.1.1.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.2">subscript</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.2.2.2"><ci id="S4.E9.m1.13.13.1.1.1.1.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.2.2.2.1">^</ci><ci id="S4.E9.m1.13.13.1.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.2.2.2.2">𝐡</ci></apply><list id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.4"><ci id="S4.E9.m1.1.1.1.1a.cmml" xref="S4.E9.m1.1.1.1.1"><mtext mathsize="70%" id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">s</mtext></ci><ci id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.E9.m1.13.13.1.1.1.1.2.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E9.m1.13.13.1.1.1.1.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3"><plus id="S4.E9.m1.13.13.1.1.1.1.3.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.1"></plus><apply id="S4.E9.m1.13.13.1.1.1.1.3.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2"><times id="S4.E9.m1.13.13.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.1"></times><apply id="S4.E9.m1.13.13.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.3.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2">subscript</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2"><ci id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.1">^</ci><ci id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.2.3">0</cn></apply><ci id="S4.E9.m1.13.13.1.1.1.1.3.2.2.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S4.E9.m1.13.13.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.3.2.3.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.3.2.3.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.3.2.3.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E9.m1.13.13.1.1.1.1.3.2.3.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3.2.2">𝐡</ci><list id="S4.E9.m1.4.4.2.3.cmml" xref="S4.E9.m1.4.4.2.4"><ci id="S4.E9.m1.3.3.1.1a.cmml" xref="S4.E9.m1.3.3.1.1"><mtext mathsize="70%" id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1">s</mtext></ci><ci id="S4.E9.m1.4.4.2.2.cmml" xref="S4.E9.m1.4.4.2.2">𝑖</ci></list></apply><ci id="S4.E9.m1.13.13.1.1.1.1.3.2.3.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S4.E9.m1.13.13.1.1.1.1.3.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3"><times id="S4.E9.m1.13.13.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.1"></times><apply id="S4.E9.m1.13.13.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.3.3.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2">subscript</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2"><ci id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.1">^</ci><ci id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.2.3">1</cn></apply><ci id="S4.E9.m1.13.13.1.1.1.1.3.3.2.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.2.3">𝑘</ci></apply><apply id="S4.E9.m1.13.13.1.1.1.1.3.3.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.3.3.3.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.1.1.3.3.3.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.3.3.3.2.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E9.m1.13.13.1.1.1.1.3.3.3.2.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3.2.2">𝐡</ci><list id="S4.E9.m1.6.6.2.3.cmml" xref="S4.E9.m1.6.6.2.4"><ci id="S4.E9.m1.5.5.1.1a.cmml" xref="S4.E9.m1.5.5.1.1"><mtext mathsize="70%" id="S4.E9.m1.5.5.1.1.cmml" xref="S4.E9.m1.5.5.1.1">p</mtext></ci><ci id="S4.E9.m1.6.6.2.2.cmml" xref="S4.E9.m1.6.6.2.2">𝑖</ci></list></apply><ci id="S4.E9.m1.13.13.1.1.1.1.3.3.3.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S4.E9.m1.13.13.1.1.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2"><ci id="S4.E9.m1.13.13.1.1.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.1">≜</ci><apply id="S4.E9.m1.13.13.1.1.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.2">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.2">subscript</csymbol><apply id="S4.E9.m1.13.13.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.2.2.2"><ci id="S4.E9.m1.13.13.1.1.2.2.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.2.2.2.1">^</ci><ci id="S4.E9.m1.13.13.1.1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.2.2.2.2">𝐡</ci></apply><list id="S4.E9.m1.8.8.2.3.cmml" xref="S4.E9.m1.8.8.2.4"><ci id="S4.E9.m1.7.7.1.1a.cmml" xref="S4.E9.m1.7.7.1.1"><mtext mathsize="70%" id="S4.E9.m1.7.7.1.1.cmml" xref="S4.E9.m1.7.7.1.1">p</mtext></ci><ci id="S4.E9.m1.8.8.2.2.cmml" xref="S4.E9.m1.8.8.2.2">𝑖</ci></list></apply><ci id="S4.E9.m1.13.13.1.1.2.2.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.2.3">𝑘</ci></apply><apply id="S4.E9.m1.13.13.1.1.2.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3"><plus id="S4.E9.m1.13.13.1.1.2.2.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.1"></plus><apply id="S4.E9.m1.13.13.1.1.2.2.3.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2"><times id="S4.E9.m1.13.13.1.1.2.2.3.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.1"></times><apply id="S4.E9.m1.13.13.1.1.2.2.3.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.3.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2">subscript</csymbol><apply id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2"><ci id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.1">^</ci><ci id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.2.3">0</cn></apply><ci id="S4.E9.m1.13.13.1.1.2.2.3.2.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.2.3">𝑘</ci></apply><apply id="S4.E9.m1.13.13.1.1.2.2.3.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.3.2.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.2.2.3.2.3.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.3.2.3.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3">subscript</csymbol><ci id="S4.E9.m1.13.13.1.1.2.2.3.2.3.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3.2.2">𝐡</ci><list id="S4.E9.m1.10.10.2.3.cmml" xref="S4.E9.m1.10.10.2.4"><ci id="S4.E9.m1.9.9.1.1a.cmml" xref="S4.E9.m1.9.9.1.1"><mtext mathsize="70%" id="S4.E9.m1.9.9.1.1.cmml" xref="S4.E9.m1.9.9.1.1">s</mtext></ci><ci id="S4.E9.m1.10.10.2.2.cmml" xref="S4.E9.m1.10.10.2.2">𝑖</ci></list></apply><ci id="S4.E9.m1.13.13.1.1.2.2.3.2.3.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.2.3.3">𝑘</ci></apply></apply><apply id="S4.E9.m1.13.13.1.1.2.2.3.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3"><times id="S4.E9.m1.13.13.1.1.2.2.3.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.1"></times><apply id="S4.E9.m1.13.13.1.1.2.2.3.3.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.3.3.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2">subscript</csymbol><apply id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2"><ci id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.1">^</ci><ci id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.2.3">1</cn></apply><ci id="S4.E9.m1.13.13.1.1.2.2.3.3.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.2.3">𝑘</ci></apply><apply id="S4.E9.m1.13.13.1.1.2.2.3.3.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.3.3.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3">superscript</csymbol><apply id="S4.E9.m1.13.13.1.1.2.2.3.3.3.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.2.3.3.3.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3">subscript</csymbol><ci id="S4.E9.m1.13.13.1.1.2.2.3.3.3.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3.2.2">𝐡</ci><list id="S4.E9.m1.12.12.2.3.cmml" xref="S4.E9.m1.12.12.2.4"><ci id="S4.E9.m1.11.11.1.1a.cmml" xref="S4.E9.m1.11.11.1.1"><mtext mathsize="70%" id="S4.E9.m1.11.11.1.1.cmml" xref="S4.E9.m1.11.11.1.1">p</mtext></ci><ci id="S4.E9.m1.12.12.2.2.cmml" xref="S4.E9.m1.12.12.2.2">𝑖</ci></list></apply><ci id="S4.E9.m1.13.13.1.1.2.2.3.3.3.3.cmml" xref="S4.E9.m1.13.13.1.1.2.2.3.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.13c">\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}\triangleq\hat{\alpha}_{0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},\qquad\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}\triangleq\hat{\alpha}_{0}^{k}{\mathbf{h}}_{{\text{s}},i}^{k}+\hat{\alpha}_{1}^{k}{\mathbf{h}}_{{\text{p}},i}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p4.8" class="ltx_p">where <math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="\hat{\alpha}_{0}^{k}" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><msubsup id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><mover accent="true" id="S4.SS3.p4.1.m1.1.1.2.2" xref="S4.SS3.p4.1.m1.1.1.2.2.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2.2.2" xref="S4.SS3.p4.1.m1.1.1.2.2.2.cmml">α</mi><mo id="S4.SS3.p4.1.m1.1.1.2.2.1" xref="S4.SS3.p4.1.m1.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p4.1.m1.1.1.2.3" xref="S4.SS3.p4.1.m1.1.1.2.3.cmml">0</mn><mi id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">superscript</csymbol><apply id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.2.1.cmml" xref="S4.SS3.p4.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p4.1.m1.1.1.2.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2.2"><ci id="S4.SS3.p4.1.m1.1.1.2.2.1.cmml" xref="S4.SS3.p4.1.m1.1.1.2.2.1">^</ci><ci id="S4.SS3.p4.1.m1.1.1.2.2.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.SS3.p4.1.m1.1.1.2.3.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">\hat{\alpha}_{0}^{k}</annotation></semantics></math> and <math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="\hat{\alpha}_{1}^{k}" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><msubsup id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><mover accent="true" id="S4.SS3.p4.2.m2.1.1.2.2" xref="S4.SS3.p4.2.m2.1.1.2.2.cmml"><mi id="S4.SS3.p4.2.m2.1.1.2.2.2" xref="S4.SS3.p4.2.m2.1.1.2.2.2.cmml">α</mi><mo id="S4.SS3.p4.2.m2.1.1.2.2.1" xref="S4.SS3.p4.2.m2.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p4.2.m2.1.1.2.3" xref="S4.SS3.p4.2.m2.1.1.2.3.cmml">1</mn><mi id="S4.SS3.p4.2.m2.1.1.3" xref="S4.SS3.p4.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">superscript</csymbol><apply id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.2.1.cmml" xref="S4.SS3.p4.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.p4.2.m2.1.1.2.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2.2"><ci id="S4.SS3.p4.2.m2.1.1.2.2.1.cmml" xref="S4.SS3.p4.2.m2.1.1.2.2.1">^</ci><ci id="S4.SS3.p4.2.m2.1.1.2.2.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.SS3.p4.2.m2.1.1.2.3.cmml" xref="S4.SS3.p4.2.m2.1.1.2.3">1</cn></apply><ci id="S4.SS3.p4.2.m2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">\hat{\alpha}_{1}^{k}</annotation></semantics></math> can be generated via the following steps. First, sample values from the Gumbel distribution, i.e., <math id="S4.SS3.p4.3.m3.4" class="ltx_Math" alttext="g_{0},g_{1}\sim\text{Gumbel}(0,1)" display="inline"><semantics id="S4.SS3.p4.3.m3.4a"><mrow id="S4.SS3.p4.3.m3.4.4" xref="S4.SS3.p4.3.m3.4.4.cmml"><mrow id="S4.SS3.p4.3.m3.4.4.2.2" xref="S4.SS3.p4.3.m3.4.4.2.3.cmml"><msub id="S4.SS3.p4.3.m3.3.3.1.1.1" xref="S4.SS3.p4.3.m3.3.3.1.1.1.cmml"><mi id="S4.SS3.p4.3.m3.3.3.1.1.1.2" xref="S4.SS3.p4.3.m3.3.3.1.1.1.2.cmml">g</mi><mn id="S4.SS3.p4.3.m3.3.3.1.1.1.3" xref="S4.SS3.p4.3.m3.3.3.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS3.p4.3.m3.4.4.2.2.3" xref="S4.SS3.p4.3.m3.4.4.2.3.cmml">,</mo><msub id="S4.SS3.p4.3.m3.4.4.2.2.2" xref="S4.SS3.p4.3.m3.4.4.2.2.2.cmml"><mi id="S4.SS3.p4.3.m3.4.4.2.2.2.2" xref="S4.SS3.p4.3.m3.4.4.2.2.2.2.cmml">g</mi><mn id="S4.SS3.p4.3.m3.4.4.2.2.2.3" xref="S4.SS3.p4.3.m3.4.4.2.2.2.3.cmml">1</mn></msub></mrow><mo id="S4.SS3.p4.3.m3.4.4.3" xref="S4.SS3.p4.3.m3.4.4.3.cmml">∼</mo><mrow id="S4.SS3.p4.3.m3.4.4.4" xref="S4.SS3.p4.3.m3.4.4.4.cmml"><mtext id="S4.SS3.p4.3.m3.4.4.4.2" xref="S4.SS3.p4.3.m3.4.4.4.2a.cmml">Gumbel</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p4.3.m3.4.4.4.1" xref="S4.SS3.p4.3.m3.4.4.4.1.cmml">​</mo><mrow id="S4.SS3.p4.3.m3.4.4.4.3.2" xref="S4.SS3.p4.3.m3.4.4.4.3.1.cmml"><mo stretchy="false" id="S4.SS3.p4.3.m3.4.4.4.3.2.1" xref="S4.SS3.p4.3.m3.4.4.4.3.1.cmml">(</mo><mn id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml">0</mn><mo id="S4.SS3.p4.3.m3.4.4.4.3.2.2" xref="S4.SS3.p4.3.m3.4.4.4.3.1.cmml">,</mo><mn id="S4.SS3.p4.3.m3.2.2" xref="S4.SS3.p4.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.p4.3.m3.4.4.4.3.2.3" xref="S4.SS3.p4.3.m3.4.4.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.4b"><apply id="S4.SS3.p4.3.m3.4.4.cmml" xref="S4.SS3.p4.3.m3.4.4"><csymbol cd="latexml" id="S4.SS3.p4.3.m3.4.4.3.cmml" xref="S4.SS3.p4.3.m3.4.4.3">similar-to</csymbol><list id="S4.SS3.p4.3.m3.4.4.2.3.cmml" xref="S4.SS3.p4.3.m3.4.4.2.2"><apply id="S4.SS3.p4.3.m3.3.3.1.1.1.cmml" xref="S4.SS3.p4.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS3.p4.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S4.SS3.p4.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS3.p4.3.m3.3.3.1.1.1.2">𝑔</ci><cn type="integer" id="S4.SS3.p4.3.m3.3.3.1.1.1.3.cmml" xref="S4.SS3.p4.3.m3.3.3.1.1.1.3">0</cn></apply><apply id="S4.SS3.p4.3.m3.4.4.2.2.2.cmml" xref="S4.SS3.p4.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.4.4.2.2.2.1.cmml" xref="S4.SS3.p4.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S4.SS3.p4.3.m3.4.4.2.2.2.2.cmml" xref="S4.SS3.p4.3.m3.4.4.2.2.2.2">𝑔</ci><cn type="integer" id="S4.SS3.p4.3.m3.4.4.2.2.2.3.cmml" xref="S4.SS3.p4.3.m3.4.4.2.2.2.3">1</cn></apply></list><apply id="S4.SS3.p4.3.m3.4.4.4.cmml" xref="S4.SS3.p4.3.m3.4.4.4"><times id="S4.SS3.p4.3.m3.4.4.4.1.cmml" xref="S4.SS3.p4.3.m3.4.4.4.1"></times><ci id="S4.SS3.p4.3.m3.4.4.4.2a.cmml" xref="S4.SS3.p4.3.m3.4.4.4.2"><mtext id="S4.SS3.p4.3.m3.4.4.4.2.cmml" xref="S4.SS3.p4.3.m3.4.4.4.2">Gumbel</mtext></ci><interval closure="open" id="S4.SS3.p4.3.m3.4.4.4.3.1.cmml" xref="S4.SS3.p4.3.m3.4.4.4.3.2"><cn type="integer" id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">0</cn><cn type="integer" id="S4.SS3.p4.3.m3.2.2.cmml" xref="S4.SS3.p4.3.m3.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.4c">g_{0},g_{1}\sim\text{Gumbel}(0,1)</annotation></semantics></math>, where <math id="S4.SS3.p4.4.m4.2" class="ltx_Math" alttext="\text{Gumbel}(0,1)" display="inline"><semantics id="S4.SS3.p4.4.m4.2a"><mrow id="S4.SS3.p4.4.m4.2.3" xref="S4.SS3.p4.4.m4.2.3.cmml"><mtext id="S4.SS3.p4.4.m4.2.3.2" xref="S4.SS3.p4.4.m4.2.3.2a.cmml">Gumbel</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p4.4.m4.2.3.1" xref="S4.SS3.p4.4.m4.2.3.1.cmml">​</mo><mrow id="S4.SS3.p4.4.m4.2.3.3.2" xref="S4.SS3.p4.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p4.4.m4.2.3.3.2.1" xref="S4.SS3.p4.4.m4.2.3.3.1.cmml">(</mo><mn id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">0</mn><mo id="S4.SS3.p4.4.m4.2.3.3.2.2" xref="S4.SS3.p4.4.m4.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p4.4.m4.2.2" xref="S4.SS3.p4.4.m4.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.p4.4.m4.2.3.3.2.3" xref="S4.SS3.p4.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.2b"><apply id="S4.SS3.p4.4.m4.2.3.cmml" xref="S4.SS3.p4.4.m4.2.3"><times id="S4.SS3.p4.4.m4.2.3.1.cmml" xref="S4.SS3.p4.4.m4.2.3.1"></times><ci id="S4.SS3.p4.4.m4.2.3.2a.cmml" xref="S4.SS3.p4.4.m4.2.3.2"><mtext id="S4.SS3.p4.4.m4.2.3.2.cmml" xref="S4.SS3.p4.4.m4.2.3.2">Gumbel</mtext></ci><interval closure="open" id="S4.SS3.p4.4.m4.2.3.3.1.cmml" xref="S4.SS3.p4.4.m4.2.3.3.2"><cn type="integer" id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1">0</cn><cn type="integer" id="S4.SS3.p4.4.m4.2.2.cmml" xref="S4.SS3.p4.4.m4.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.2c">\text{Gumbel}(0,1)</annotation></semantics></math> can be seen as first sampling <math id="S4.SS3.p4.5.m5.4" class="ltx_Math" alttext="u_{0},u_{1}\sim\text{Uniform}(0,1)" display="inline"><semantics id="S4.SS3.p4.5.m5.4a"><mrow id="S4.SS3.p4.5.m5.4.4" xref="S4.SS3.p4.5.m5.4.4.cmml"><mrow id="S4.SS3.p4.5.m5.4.4.2.2" xref="S4.SS3.p4.5.m5.4.4.2.3.cmml"><msub id="S4.SS3.p4.5.m5.3.3.1.1.1" xref="S4.SS3.p4.5.m5.3.3.1.1.1.cmml"><mi id="S4.SS3.p4.5.m5.3.3.1.1.1.2" xref="S4.SS3.p4.5.m5.3.3.1.1.1.2.cmml">u</mi><mn id="S4.SS3.p4.5.m5.3.3.1.1.1.3" xref="S4.SS3.p4.5.m5.3.3.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS3.p4.5.m5.4.4.2.2.3" xref="S4.SS3.p4.5.m5.4.4.2.3.cmml">,</mo><msub id="S4.SS3.p4.5.m5.4.4.2.2.2" xref="S4.SS3.p4.5.m5.4.4.2.2.2.cmml"><mi id="S4.SS3.p4.5.m5.4.4.2.2.2.2" xref="S4.SS3.p4.5.m5.4.4.2.2.2.2.cmml">u</mi><mn id="S4.SS3.p4.5.m5.4.4.2.2.2.3" xref="S4.SS3.p4.5.m5.4.4.2.2.2.3.cmml">1</mn></msub></mrow><mo id="S4.SS3.p4.5.m5.4.4.3" xref="S4.SS3.p4.5.m5.4.4.3.cmml">∼</mo><mrow id="S4.SS3.p4.5.m5.4.4.4" xref="S4.SS3.p4.5.m5.4.4.4.cmml"><mtext id="S4.SS3.p4.5.m5.4.4.4.2" xref="S4.SS3.p4.5.m5.4.4.4.2a.cmml">Uniform</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p4.5.m5.4.4.4.1" xref="S4.SS3.p4.5.m5.4.4.4.1.cmml">​</mo><mrow id="S4.SS3.p4.5.m5.4.4.4.3.2" xref="S4.SS3.p4.5.m5.4.4.4.3.1.cmml"><mo stretchy="false" id="S4.SS3.p4.5.m5.4.4.4.3.2.1" xref="S4.SS3.p4.5.m5.4.4.4.3.1.cmml">(</mo><mn id="S4.SS3.p4.5.m5.1.1" xref="S4.SS3.p4.5.m5.1.1.cmml">0</mn><mo id="S4.SS3.p4.5.m5.4.4.4.3.2.2" xref="S4.SS3.p4.5.m5.4.4.4.3.1.cmml">,</mo><mn id="S4.SS3.p4.5.m5.2.2" xref="S4.SS3.p4.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS3.p4.5.m5.4.4.4.3.2.3" xref="S4.SS3.p4.5.m5.4.4.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.5.m5.4b"><apply id="S4.SS3.p4.5.m5.4.4.cmml" xref="S4.SS3.p4.5.m5.4.4"><csymbol cd="latexml" id="S4.SS3.p4.5.m5.4.4.3.cmml" xref="S4.SS3.p4.5.m5.4.4.3">similar-to</csymbol><list id="S4.SS3.p4.5.m5.4.4.2.3.cmml" xref="S4.SS3.p4.5.m5.4.4.2.2"><apply id="S4.SS3.p4.5.m5.3.3.1.1.1.cmml" xref="S4.SS3.p4.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.5.m5.3.3.1.1.1.1.cmml" xref="S4.SS3.p4.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S4.SS3.p4.5.m5.3.3.1.1.1.2.cmml" xref="S4.SS3.p4.5.m5.3.3.1.1.1.2">𝑢</ci><cn type="integer" id="S4.SS3.p4.5.m5.3.3.1.1.1.3.cmml" xref="S4.SS3.p4.5.m5.3.3.1.1.1.3">0</cn></apply><apply id="S4.SS3.p4.5.m5.4.4.2.2.2.cmml" xref="S4.SS3.p4.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.5.m5.4.4.2.2.2.1.cmml" xref="S4.SS3.p4.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S4.SS3.p4.5.m5.4.4.2.2.2.2.cmml" xref="S4.SS3.p4.5.m5.4.4.2.2.2.2">𝑢</ci><cn type="integer" id="S4.SS3.p4.5.m5.4.4.2.2.2.3.cmml" xref="S4.SS3.p4.5.m5.4.4.2.2.2.3">1</cn></apply></list><apply id="S4.SS3.p4.5.m5.4.4.4.cmml" xref="S4.SS3.p4.5.m5.4.4.4"><times id="S4.SS3.p4.5.m5.4.4.4.1.cmml" xref="S4.SS3.p4.5.m5.4.4.4.1"></times><ci id="S4.SS3.p4.5.m5.4.4.4.2a.cmml" xref="S4.SS3.p4.5.m5.4.4.4.2"><mtext id="S4.SS3.p4.5.m5.4.4.4.2.cmml" xref="S4.SS3.p4.5.m5.4.4.4.2">Uniform</mtext></ci><interval closure="open" id="S4.SS3.p4.5.m5.4.4.4.3.1.cmml" xref="S4.SS3.p4.5.m5.4.4.4.3.2"><cn type="integer" id="S4.SS3.p4.5.m5.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1">0</cn><cn type="integer" id="S4.SS3.p4.5.m5.2.2.cmml" xref="S4.SS3.p4.5.m5.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.5.m5.4c">u_{0},u_{1}\sim\text{Uniform}(0,1)</annotation></semantics></math> and then taking the transformation <math id="S4.SS3.p4.6.m6.4" class="ltx_Math" alttext="g=-\log(-\log(u))" display="inline"><semantics id="S4.SS3.p4.6.m6.4a"><mrow id="S4.SS3.p4.6.m6.4.4" xref="S4.SS3.p4.6.m6.4.4.cmml"><mi id="S4.SS3.p4.6.m6.4.4.3" xref="S4.SS3.p4.6.m6.4.4.3.cmml">g</mi><mo id="S4.SS3.p4.6.m6.4.4.2" xref="S4.SS3.p4.6.m6.4.4.2.cmml">=</mo><mrow id="S4.SS3.p4.6.m6.4.4.1" xref="S4.SS3.p4.6.m6.4.4.1.cmml"><mo rspace="0.167em" id="S4.SS3.p4.6.m6.4.4.1a" xref="S4.SS3.p4.6.m6.4.4.1.cmml">−</mo><mrow id="S4.SS3.p4.6.m6.4.4.1.1.1" xref="S4.SS3.p4.6.m6.4.4.1.1.2.cmml"><mi id="S4.SS3.p4.6.m6.3.3" xref="S4.SS3.p4.6.m6.3.3.cmml">log</mi><mo id="S4.SS3.p4.6.m6.4.4.1.1.1a" xref="S4.SS3.p4.6.m6.4.4.1.1.2.cmml">⁡</mo><mrow id="S4.SS3.p4.6.m6.4.4.1.1.1.1" xref="S4.SS3.p4.6.m6.4.4.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p4.6.m6.4.4.1.1.1.1.2" xref="S4.SS3.p4.6.m6.4.4.1.1.2.cmml">(</mo><mrow id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1a" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.cmml">−</mo><mrow id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.2" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.1.cmml"><mi id="S4.SS3.p4.6.m6.1.1" xref="S4.SS3.p4.6.m6.1.1.cmml">log</mi><mo id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.2a" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.1.cmml">⁡</mo><mrow id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.2.1" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.1.cmml"><mo stretchy="false" id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.2.1.1" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.1.cmml">(</mo><mi id="S4.SS3.p4.6.m6.2.2" xref="S4.SS3.p4.6.m6.2.2.cmml">u</mi><mo stretchy="false" id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.2.1.2" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS3.p4.6.m6.4.4.1.1.1.1.3" xref="S4.SS3.p4.6.m6.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.6.m6.4b"><apply id="S4.SS3.p4.6.m6.4.4.cmml" xref="S4.SS3.p4.6.m6.4.4"><eq id="S4.SS3.p4.6.m6.4.4.2.cmml" xref="S4.SS3.p4.6.m6.4.4.2"></eq><ci id="S4.SS3.p4.6.m6.4.4.3.cmml" xref="S4.SS3.p4.6.m6.4.4.3">𝑔</ci><apply id="S4.SS3.p4.6.m6.4.4.1.cmml" xref="S4.SS3.p4.6.m6.4.4.1"><minus id="S4.SS3.p4.6.m6.4.4.1.2.cmml" xref="S4.SS3.p4.6.m6.4.4.1"></minus><apply id="S4.SS3.p4.6.m6.4.4.1.1.2.cmml" xref="S4.SS3.p4.6.m6.4.4.1.1.1"><log id="S4.SS3.p4.6.m6.3.3.cmml" xref="S4.SS3.p4.6.m6.3.3"></log><apply id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.cmml" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1"><minus id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.1.cmml" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1"></minus><apply id="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p4.6.m6.4.4.1.1.1.1.1.2.2"><log id="S4.SS3.p4.6.m6.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1"></log><ci id="S4.SS3.p4.6.m6.2.2.cmml" xref="S4.SS3.p4.6.m6.2.2">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.6.m6.4c">g=-\log(-\log(u))</annotation></semantics></math>. Second, take the reparametrized softmax as <math id="S4.SS3.p4.7.m7.4" class="ltx_Math" alttext="\hat{\alpha}_{0}^{k},\hat{\alpha}_{1}^{k}=\text{SoftMax}((\alpha_{0}^{k}+g_{0})/\lambda,(\alpha_{1}^{k}+g_{1})/\lambda)" display="inline"><semantics id="S4.SS3.p4.7.m7.4a"><mrow id="S4.SS3.p4.7.m7.4.4" xref="S4.SS3.p4.7.m7.4.4.cmml"><mrow id="S4.SS3.p4.7.m7.2.2.2.2" xref="S4.SS3.p4.7.m7.2.2.2.3.cmml"><msubsup id="S4.SS3.p4.7.m7.1.1.1.1.1" xref="S4.SS3.p4.7.m7.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS3.p4.7.m7.1.1.1.1.1.2.2" xref="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.cmml"><mi id="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.2" xref="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.2.cmml">α</mi><mo id="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.1" xref="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p4.7.m7.1.1.1.1.1.2.3" xref="S4.SS3.p4.7.m7.1.1.1.1.1.2.3.cmml">0</mn><mi id="S4.SS3.p4.7.m7.1.1.1.1.1.3" xref="S4.SS3.p4.7.m7.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p4.7.m7.2.2.2.2.3" xref="S4.SS3.p4.7.m7.2.2.2.3.cmml">,</mo><msubsup id="S4.SS3.p4.7.m7.2.2.2.2.2" xref="S4.SS3.p4.7.m7.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS3.p4.7.m7.2.2.2.2.2.2.2" xref="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.cmml"><mi id="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.2" xref="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.2.cmml">α</mi><mo id="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.1" xref="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p4.7.m7.2.2.2.2.2.2.3" xref="S4.SS3.p4.7.m7.2.2.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p4.7.m7.2.2.2.2.2.3" xref="S4.SS3.p4.7.m7.2.2.2.2.2.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS3.p4.7.m7.4.4.5" xref="S4.SS3.p4.7.m7.4.4.5.cmml">=</mo><mrow id="S4.SS3.p4.7.m7.4.4.4" xref="S4.SS3.p4.7.m7.4.4.4.cmml"><mtext id="S4.SS3.p4.7.m7.4.4.4.4" xref="S4.SS3.p4.7.m7.4.4.4.4a.cmml">SoftMax</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p4.7.m7.4.4.4.3" xref="S4.SS3.p4.7.m7.4.4.4.3.cmml">​</mo><mrow id="S4.SS3.p4.7.m7.4.4.4.2.2" xref="S4.SS3.p4.7.m7.4.4.4.2.3.cmml"><mo stretchy="false" id="S4.SS3.p4.7.m7.4.4.4.2.2.3" xref="S4.SS3.p4.7.m7.4.4.4.2.3.cmml">(</mo><mrow id="S4.SS3.p4.7.m7.3.3.3.1.1.1" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.cmml"><mrow id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.2" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.cmml"><msubsup id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.2" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.2.cmml">α</mi><mn id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.3" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.3.cmml">0</mn><mi id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.3" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.1" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.2" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.2.cmml">g</mi><mn id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.3" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo stretchy="false" id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.3" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS3.p4.7.m7.3.3.3.1.1.1.2" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.2.cmml">/</mo><mi id="S4.SS3.p4.7.m7.3.3.3.1.1.1.3" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.3.cmml">λ</mi></mrow><mo id="S4.SS3.p4.7.m7.4.4.4.2.2.4" xref="S4.SS3.p4.7.m7.4.4.4.2.3.cmml">,</mo><mrow id="S4.SS3.p4.7.m7.4.4.4.2.2.2" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.cmml"><mrow id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.2" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.cmml"><msubsup id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.cmml"><mi id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.2" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.2.cmml">α</mi><mn id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.3" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.3.cmml">1</mn><mi id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.3" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.1" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.1.cmml">+</mo><msub id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.cmml"><mi id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.2" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.2.cmml">g</mi><mn id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.3" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.3" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.SS3.p4.7.m7.4.4.4.2.2.2.2" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.2.cmml">/</mo><mi id="S4.SS3.p4.7.m7.4.4.4.2.2.2.3" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.3.cmml">λ</mi></mrow><mo stretchy="false" id="S4.SS3.p4.7.m7.4.4.4.2.2.5" xref="S4.SS3.p4.7.m7.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.7.m7.4b"><apply id="S4.SS3.p4.7.m7.4.4.cmml" xref="S4.SS3.p4.7.m7.4.4"><eq id="S4.SS3.p4.7.m7.4.4.5.cmml" xref="S4.SS3.p4.7.m7.4.4.5"></eq><list id="S4.SS3.p4.7.m7.2.2.2.3.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2"><apply id="S4.SS3.p4.7.m7.1.1.1.1.1.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p4.7.m7.1.1.1.1.1.2.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1">subscript</csymbol><apply id="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1.2.2"><ci id="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.1">^</ci><ci id="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.SS3.p4.7.m7.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p4.7.m7.1.1.1.1.1.3.cmml" xref="S4.SS3.p4.7.m7.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p4.7.m7.2.2.2.2.2.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.2.2.2.2.2.1.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p4.7.m7.2.2.2.2.2.2.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2">subscript</csymbol><apply id="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2.2.2"><ci id="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.1">^</ci><ci id="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.SS3.p4.7.m7.2.2.2.2.2.2.3.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p4.7.m7.2.2.2.2.2.3.cmml" xref="S4.SS3.p4.7.m7.2.2.2.2.2.3">𝑘</ci></apply></list><apply id="S4.SS3.p4.7.m7.4.4.4.cmml" xref="S4.SS3.p4.7.m7.4.4.4"><times id="S4.SS3.p4.7.m7.4.4.4.3.cmml" xref="S4.SS3.p4.7.m7.4.4.4.3"></times><ci id="S4.SS3.p4.7.m7.4.4.4.4a.cmml" xref="S4.SS3.p4.7.m7.4.4.4.4"><mtext id="S4.SS3.p4.7.m7.4.4.4.4.cmml" xref="S4.SS3.p4.7.m7.4.4.4.4">SoftMax</mtext></ci><interval closure="open" id="S4.SS3.p4.7.m7.4.4.4.2.3.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2"><apply id="S4.SS3.p4.7.m7.3.3.3.1.1.1.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1"><divide id="S4.SS3.p4.7.m7.3.3.3.1.1.1.2.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.2"></divide><apply id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1"><plus id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.1"></plus><apply id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.2">𝛼</ci><cn type="integer" id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.2.3">0</cn></apply><ci id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.2">𝑔</ci><cn type="integer" id="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.1.1.1.3.3">0</cn></apply></apply><ci id="S4.SS3.p4.7.m7.3.3.3.1.1.1.3.cmml" xref="S4.SS3.p4.7.m7.3.3.3.1.1.1.3">𝜆</ci></apply><apply id="S4.SS3.p4.7.m7.4.4.4.2.2.2.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2"><divide id="S4.SS3.p4.7.m7.4.4.4.2.2.2.2.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.2"></divide><apply id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1"><plus id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.1.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.1"></plus><apply id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.1.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2">superscript</csymbol><apply id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.1.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.2.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.2">𝛼</ci><cn type="integer" id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.3.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.2.3">1</cn></apply><ci id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.3.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.1.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.2.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.2">𝑔</ci><cn type="integer" id="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.3.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p4.7.m7.4.4.4.2.2.2.3.cmml" xref="S4.SS3.p4.7.m7.4.4.4.2.2.2.3">𝜆</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.7.m7.4c">\hat{\alpha}_{0}^{k},\hat{\alpha}_{1}^{k}=\text{SoftMax}((\alpha_{0}^{k}+g_{0})/\lambda,(\alpha_{1}^{k}+g_{1})/\lambda)</annotation></semantics></math>. We denote the process as <math id="S4.SS3.p4.8.m8.4" class="ltx_Math" alttext="\hat{\alpha}_{0}^{k},\hat{\alpha}_{1}^{k}=\text{GumbelSoftMax}(\alpha_{0}^{k},\alpha_{1}^{k})" display="inline"><semantics id="S4.SS3.p4.8.m8.4a"><mrow id="S4.SS3.p4.8.m8.4.4" xref="S4.SS3.p4.8.m8.4.4.cmml"><mrow id="S4.SS3.p4.8.m8.2.2.2.2" xref="S4.SS3.p4.8.m8.2.2.2.3.cmml"><msubsup id="S4.SS3.p4.8.m8.1.1.1.1.1" xref="S4.SS3.p4.8.m8.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS3.p4.8.m8.1.1.1.1.1.2.2" xref="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.cmml"><mi id="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.2" xref="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.2.cmml">α</mi><mo id="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.1" xref="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p4.8.m8.1.1.1.1.1.2.3" xref="S4.SS3.p4.8.m8.1.1.1.1.1.2.3.cmml">0</mn><mi id="S4.SS3.p4.8.m8.1.1.1.1.1.3" xref="S4.SS3.p4.8.m8.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p4.8.m8.2.2.2.2.3" xref="S4.SS3.p4.8.m8.2.2.2.3.cmml">,</mo><msubsup id="S4.SS3.p4.8.m8.2.2.2.2.2" xref="S4.SS3.p4.8.m8.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS3.p4.8.m8.2.2.2.2.2.2.2" xref="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.cmml"><mi id="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.2" xref="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.2.cmml">α</mi><mo id="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.1" xref="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p4.8.m8.2.2.2.2.2.2.3" xref="S4.SS3.p4.8.m8.2.2.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p4.8.m8.2.2.2.2.2.3" xref="S4.SS3.p4.8.m8.2.2.2.2.2.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS3.p4.8.m8.4.4.5" xref="S4.SS3.p4.8.m8.4.4.5.cmml">=</mo><mrow id="S4.SS3.p4.8.m8.4.4.4" xref="S4.SS3.p4.8.m8.4.4.4.cmml"><mtext id="S4.SS3.p4.8.m8.4.4.4.4" xref="S4.SS3.p4.8.m8.4.4.4.4a.cmml">GumbelSoftMax</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p4.8.m8.4.4.4.3" xref="S4.SS3.p4.8.m8.4.4.4.3.cmml">​</mo><mrow id="S4.SS3.p4.8.m8.4.4.4.2.2" xref="S4.SS3.p4.8.m8.4.4.4.2.3.cmml"><mo stretchy="false" id="S4.SS3.p4.8.m8.4.4.4.2.2.3" xref="S4.SS3.p4.8.m8.4.4.4.2.3.cmml">(</mo><msubsup id="S4.SS3.p4.8.m8.3.3.3.1.1.1" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1.cmml"><mi id="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.2" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.2.cmml">α</mi><mn id="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.3" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.3.cmml">0</mn><mi id="S4.SS3.p4.8.m8.3.3.3.1.1.1.3" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p4.8.m8.4.4.4.2.2.4" xref="S4.SS3.p4.8.m8.4.4.4.2.3.cmml">,</mo><msubsup id="S4.SS3.p4.8.m8.4.4.4.2.2.2" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2.cmml"><mi id="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.2" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.2.cmml">α</mi><mn id="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.3" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p4.8.m8.4.4.4.2.2.2.3" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS3.p4.8.m8.4.4.4.2.2.5" xref="S4.SS3.p4.8.m8.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.8.m8.4b"><apply id="S4.SS3.p4.8.m8.4.4.cmml" xref="S4.SS3.p4.8.m8.4.4"><eq id="S4.SS3.p4.8.m8.4.4.5.cmml" xref="S4.SS3.p4.8.m8.4.4.5"></eq><list id="S4.SS3.p4.8.m8.2.2.2.3.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2"><apply id="S4.SS3.p4.8.m8.1.1.1.1.1.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p4.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.8.m8.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1">subscript</csymbol><apply id="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1.2.2"><ci id="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.1">^</ci><ci id="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.SS3.p4.8.m8.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p4.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS3.p4.8.m8.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p4.8.m8.2.2.2.2.2.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.8.m8.2.2.2.2.2.1.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p4.8.m8.2.2.2.2.2.2.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.8.m8.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2">subscript</csymbol><apply id="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2.2.2"><ci id="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.1">^</ci><ci id="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2.2.2.2">𝛼</ci></apply><cn type="integer" id="S4.SS3.p4.8.m8.2.2.2.2.2.2.3.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p4.8.m8.2.2.2.2.2.3.cmml" xref="S4.SS3.p4.8.m8.2.2.2.2.2.3">𝑘</ci></apply></list><apply id="S4.SS3.p4.8.m8.4.4.4.cmml" xref="S4.SS3.p4.8.m8.4.4.4"><times id="S4.SS3.p4.8.m8.4.4.4.3.cmml" xref="S4.SS3.p4.8.m8.4.4.4.3"></times><ci id="S4.SS3.p4.8.m8.4.4.4.4a.cmml" xref="S4.SS3.p4.8.m8.4.4.4.4"><mtext id="S4.SS3.p4.8.m8.4.4.4.4.cmml" xref="S4.SS3.p4.8.m8.4.4.4.4">GumbelSoftMax</mtext></ci><interval closure="open" id="S4.SS3.p4.8.m8.4.4.4.2.3.cmml" xref="S4.SS3.p4.8.m8.4.4.4.2.2"><apply id="S4.SS3.p4.8.m8.3.3.3.1.1.1.cmml" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.8.m8.3.3.3.1.1.1.1.cmml" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1">superscript</csymbol><apply id="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.cmml" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.1.cmml" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1">subscript</csymbol><ci id="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.2.cmml" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.2">𝛼</ci><cn type="integer" id="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.3.cmml" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p4.8.m8.3.3.3.1.1.1.3.cmml" xref="S4.SS3.p4.8.m8.3.3.3.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p4.8.m8.4.4.4.2.2.2.cmml" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.8.m8.4.4.4.2.2.2.1.cmml" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2">superscript</csymbol><apply id="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.cmml" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.1.cmml" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2">subscript</csymbol><ci id="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.2.cmml" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.2">𝛼</ci><cn type="integer" id="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.3.cmml" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p4.8.m8.4.4.4.2.2.2.3.cmml" xref="S4.SS3.p4.8.m8.4.4.4.2.2.2.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.8.m8.4c">\hat{\alpha}_{0}^{k},\hat{\alpha}_{1}^{k}=\text{GumbelSoftMax}(\alpha_{0}^{k},\alpha_{1}^{k})</annotation></semantics></math>. Using Gumbel softmax can lead to more spiked weights or even discrete selection codes <cite class="ltx_cite ltx_citemacro_citep">(Jang
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite>, and hence we expect it could lead to purer aggregation and more understandable results.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.2" class="ltx_p">With either of the three ways, we can obtain <math id="S4.SS3.p5.1.m1.2" class="ltx_Math" alttext="\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}" display="inline"><semantics id="S4.SS3.p5.1.m1.2a"><msubsup id="S4.SS3.p5.1.m1.2.3" xref="S4.SS3.p5.1.m1.2.3.cmml"><mover accent="true" id="S4.SS3.p5.1.m1.2.3.2.2" xref="S4.SS3.p5.1.m1.2.3.2.2.cmml"><mi id="S4.SS3.p5.1.m1.2.3.2.2.2" xref="S4.SS3.p5.1.m1.2.3.2.2.2.cmml">𝐡</mi><mo id="S4.SS3.p5.1.m1.2.3.2.2.1" xref="S4.SS3.p5.1.m1.2.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p5.1.m1.2.2.2.4" xref="S4.SS3.p5.1.m1.2.2.2.3.cmml"><mtext id="S4.SS3.p5.1.m1.1.1.1.1" xref="S4.SS3.p5.1.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.SS3.p5.1.m1.2.2.2.4.1" xref="S4.SS3.p5.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p5.1.m1.2.2.2.2" xref="S4.SS3.p5.1.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.SS3.p5.1.m1.2.3.3" xref="S4.SS3.p5.1.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.2b"><apply id="S4.SS3.p5.1.m1.2.3.cmml" xref="S4.SS3.p5.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.2.3.1.cmml" xref="S4.SS3.p5.1.m1.2.3">superscript</csymbol><apply id="S4.SS3.p5.1.m1.2.3.2.cmml" xref="S4.SS3.p5.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.2.3.2.1.cmml" xref="S4.SS3.p5.1.m1.2.3">subscript</csymbol><apply id="S4.SS3.p5.1.m1.2.3.2.2.cmml" xref="S4.SS3.p5.1.m1.2.3.2.2"><ci id="S4.SS3.p5.1.m1.2.3.2.2.1.cmml" xref="S4.SS3.p5.1.m1.2.3.2.2.1">^</ci><ci id="S4.SS3.p5.1.m1.2.3.2.2.2.cmml" xref="S4.SS3.p5.1.m1.2.3.2.2.2">𝐡</ci></apply><list id="S4.SS3.p5.1.m1.2.2.2.3.cmml" xref="S4.SS3.p5.1.m1.2.2.2.4"><ci id="S4.SS3.p5.1.m1.1.1.1.1a.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p5.1.m1.1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1">s</mtext></ci><ci id="S4.SS3.p5.1.m1.2.2.2.2.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.SS3.p5.1.m1.2.3.3.cmml" xref="S4.SS3.p5.1.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.2c">\hat{{\mathbf{h}}}_{{\text{s}},i}^{k}</annotation></semantics></math> and <math id="S4.SS3.p5.2.m2.2" class="ltx_Math" alttext="\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}" display="inline"><semantics id="S4.SS3.p5.2.m2.2a"><msubsup id="S4.SS3.p5.2.m2.2.3" xref="S4.SS3.p5.2.m2.2.3.cmml"><mover accent="true" id="S4.SS3.p5.2.m2.2.3.2.2" xref="S4.SS3.p5.2.m2.2.3.2.2.cmml"><mi id="S4.SS3.p5.2.m2.2.3.2.2.2" xref="S4.SS3.p5.2.m2.2.3.2.2.2.cmml">𝐡</mi><mo id="S4.SS3.p5.2.m2.2.3.2.2.1" xref="S4.SS3.p5.2.m2.2.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS3.p5.2.m2.2.2.2.4" xref="S4.SS3.p5.2.m2.2.2.2.3.cmml"><mtext id="S4.SS3.p5.2.m2.1.1.1.1" xref="S4.SS3.p5.2.m2.1.1.1.1a.cmml">p</mtext><mo id="S4.SS3.p5.2.m2.2.2.2.4.1" xref="S4.SS3.p5.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p5.2.m2.2.2.2.2" xref="S4.SS3.p5.2.m2.2.2.2.2.cmml">i</mi></mrow><mi id="S4.SS3.p5.2.m2.2.3.3" xref="S4.SS3.p5.2.m2.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.2b"><apply id="S4.SS3.p5.2.m2.2.3.cmml" xref="S4.SS3.p5.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.2.3.1.cmml" xref="S4.SS3.p5.2.m2.2.3">superscript</csymbol><apply id="S4.SS3.p5.2.m2.2.3.2.cmml" xref="S4.SS3.p5.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.2.3.2.1.cmml" xref="S4.SS3.p5.2.m2.2.3">subscript</csymbol><apply id="S4.SS3.p5.2.m2.2.3.2.2.cmml" xref="S4.SS3.p5.2.m2.2.3.2.2"><ci id="S4.SS3.p5.2.m2.2.3.2.2.1.cmml" xref="S4.SS3.p5.2.m2.2.3.2.2.1">^</ci><ci id="S4.SS3.p5.2.m2.2.3.2.2.2.cmml" xref="S4.SS3.p5.2.m2.2.3.2.2.2">𝐡</ci></apply><list id="S4.SS3.p5.2.m2.2.2.2.3.cmml" xref="S4.SS3.p5.2.m2.2.2.2.4"><ci id="S4.SS3.p5.2.m2.1.1.1.1a.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p5.2.m2.1.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1">p</mtext></ci><ci id="S4.SS3.p5.2.m2.2.2.2.2.cmml" xref="S4.SS3.p5.2.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S4.SS3.p5.2.m2.2.3.3.cmml" xref="S4.SS3.p5.2.m2.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.2c">\hat{{\mathbf{h}}}_{{\text{p}},i}^{k}</annotation></semantics></math>. Then we make predictions via:</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.13" class="ltx_Math" alttext="{\mathbf{o}}_{{\text{s}},i}^{k}\triangleq C_{{\text{s}}}^{k}(\hat{{\mathbf{h}}}_{{\text{s}},i}^{k};{\theta}_{C_{{\text{s}}},t}^{k}),\qquad{\mathbf{o}}_{{\text{p}},i}^{k}\triangleq C_{{\text{p}}}^{k}(\hat{{\mathbf{h}}}_{{\text{p}},i}^{k};{\theta}_{C_{{\text{p}}},t}^{k})," display="block"><semantics id="S4.E10.m1.13a"><mrow id="S4.E10.m1.13.13.1"><mrow id="S4.E10.m1.13.13.1.1.2" xref="S4.E10.m1.13.13.1.1.3.cmml"><mrow id="S4.E10.m1.13.13.1.1.1.1" xref="S4.E10.m1.13.13.1.1.1.1.cmml"><msubsup id="S4.E10.m1.13.13.1.1.1.1.4" xref="S4.E10.m1.13.13.1.1.1.1.4.cmml"><mi id="S4.E10.m1.13.13.1.1.1.1.4.2.2" xref="S4.E10.m1.13.13.1.1.1.1.4.2.2.cmml">𝐨</mi><mrow id="S4.E10.m1.2.2.2.4" xref="S4.E10.m1.2.2.2.3.cmml"><mtext id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.E10.m1.2.2.2.4.1" xref="S4.E10.m1.2.2.2.3.cmml">,</mo><mi id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.E10.m1.13.13.1.1.1.1.4.3" xref="S4.E10.m1.13.13.1.1.1.1.4.3.cmml">k</mi></msubsup><mo id="S4.E10.m1.13.13.1.1.1.1.3" xref="S4.E10.m1.13.13.1.1.1.1.3.cmml">≜</mo><mrow id="S4.E10.m1.13.13.1.1.1.1.2" xref="S4.E10.m1.13.13.1.1.1.1.2.cmml"><msubsup id="S4.E10.m1.13.13.1.1.1.1.2.4" xref="S4.E10.m1.13.13.1.1.1.1.2.4.cmml"><mi id="S4.E10.m1.13.13.1.1.1.1.2.4.2.2" xref="S4.E10.m1.13.13.1.1.1.1.2.4.2.2.cmml">C</mi><mtext id="S4.E10.m1.13.13.1.1.1.1.2.4.2.3" xref="S4.E10.m1.13.13.1.1.1.1.2.4.2.3a.cmml">s</mtext><mi id="S4.E10.m1.13.13.1.1.1.1.2.4.3" xref="S4.E10.m1.13.13.1.1.1.1.2.4.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E10.m1.13.13.1.1.1.1.2.3" xref="S4.E10.m1.13.13.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E10.m1.13.13.1.1.1.1.2.2.2" xref="S4.E10.m1.13.13.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E10.m1.13.13.1.1.1.1.2.2.2.3" xref="S4.E10.m1.13.13.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐡</mi><mo id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.E10.m1.4.4.2.4" xref="S4.E10.m1.4.4.2.3.cmml"><mtext id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1a.cmml">s</mtext><mo id="S4.E10.m1.4.4.2.4.1" xref="S4.E10.m1.4.4.2.3.cmml">,</mo><mi id="S4.E10.m1.4.4.2.2" xref="S4.E10.m1.4.4.2.2.cmml">i</mi></mrow><mi id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.E10.m1.13.13.1.1.1.1.2.2.2.4" xref="S4.E10.m1.13.13.1.1.1.1.2.2.3.cmml">;</mo><msubsup id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.2.2" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.2.2.cmml">θ</mi><mrow id="S4.E10.m1.6.6.2.2" xref="S4.E10.m1.6.6.2.3.cmml"><msub id="S4.E10.m1.6.6.2.2.1" xref="S4.E10.m1.6.6.2.2.1.cmml"><mi id="S4.E10.m1.6.6.2.2.1.2" xref="S4.E10.m1.6.6.2.2.1.2.cmml">C</mi><mtext id="S4.E10.m1.6.6.2.2.1.3" xref="S4.E10.m1.6.6.2.2.1.3a.cmml">s</mtext></msub><mo id="S4.E10.m1.6.6.2.2.2" xref="S4.E10.m1.6.6.2.3.cmml">,</mo><mi id="S4.E10.m1.5.5.1.1" xref="S4.E10.m1.5.5.1.1.cmml">t</mi></mrow><mi id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.3" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.E10.m1.13.13.1.1.1.1.2.2.2.5" xref="S4.E10.m1.13.13.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="2.167em" id="S4.E10.m1.13.13.1.1.2.3" xref="S4.E10.m1.13.13.1.1.3a.cmml">,</mo><mrow id="S4.E10.m1.13.13.1.1.2.2" xref="S4.E10.m1.13.13.1.1.2.2.cmml"><msubsup id="S4.E10.m1.13.13.1.1.2.2.4" xref="S4.E10.m1.13.13.1.1.2.2.4.cmml"><mi id="S4.E10.m1.13.13.1.1.2.2.4.2.2" xref="S4.E10.m1.13.13.1.1.2.2.4.2.2.cmml">𝐨</mi><mrow id="S4.E10.m1.8.8.2.4" xref="S4.E10.m1.8.8.2.3.cmml"><mtext id="S4.E10.m1.7.7.1.1" xref="S4.E10.m1.7.7.1.1a.cmml">p</mtext><mo id="S4.E10.m1.8.8.2.4.1" xref="S4.E10.m1.8.8.2.3.cmml">,</mo><mi id="S4.E10.m1.8.8.2.2" xref="S4.E10.m1.8.8.2.2.cmml">i</mi></mrow><mi id="S4.E10.m1.13.13.1.1.2.2.4.3" xref="S4.E10.m1.13.13.1.1.2.2.4.3.cmml">k</mi></msubsup><mo id="S4.E10.m1.13.13.1.1.2.2.3" xref="S4.E10.m1.13.13.1.1.2.2.3.cmml">≜</mo><mrow id="S4.E10.m1.13.13.1.1.2.2.2" xref="S4.E10.m1.13.13.1.1.2.2.2.cmml"><msubsup id="S4.E10.m1.13.13.1.1.2.2.2.4" xref="S4.E10.m1.13.13.1.1.2.2.2.4.cmml"><mi id="S4.E10.m1.13.13.1.1.2.2.2.4.2.2" xref="S4.E10.m1.13.13.1.1.2.2.2.4.2.2.cmml">C</mi><mtext id="S4.E10.m1.13.13.1.1.2.2.2.4.2.3" xref="S4.E10.m1.13.13.1.1.2.2.2.4.2.3a.cmml">p</mtext><mi id="S4.E10.m1.13.13.1.1.2.2.2.4.3" xref="S4.E10.m1.13.13.1.1.2.2.2.4.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E10.m1.13.13.1.1.2.2.2.3" xref="S4.E10.m1.13.13.1.1.2.2.2.3.cmml">​</mo><mrow id="S4.E10.m1.13.13.1.1.2.2.2.2.2" xref="S4.E10.m1.13.13.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E10.m1.13.13.1.1.2.2.2.2.2.3" xref="S4.E10.m1.13.13.1.1.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.cmml"><mover accent="true" id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.cmml"><mi id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.2" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.2.cmml">𝐡</mi><mo id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.1" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.E10.m1.10.10.2.4" xref="S4.E10.m1.10.10.2.3.cmml"><mtext id="S4.E10.m1.9.9.1.1" xref="S4.E10.m1.9.9.1.1a.cmml">p</mtext><mo id="S4.E10.m1.10.10.2.4.1" xref="S4.E10.m1.10.10.2.3.cmml">,</mo><mi id="S4.E10.m1.10.10.2.2" xref="S4.E10.m1.10.10.2.2.cmml">i</mi></mrow><mi id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.3" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.E10.m1.13.13.1.1.2.2.2.2.2.4" xref="S4.E10.m1.13.13.1.1.2.2.2.2.3.cmml">;</mo><msubsup id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.2.2" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.2.2.cmml">θ</mi><mrow id="S4.E10.m1.12.12.2.2" xref="S4.E10.m1.12.12.2.3.cmml"><msub id="S4.E10.m1.12.12.2.2.1" xref="S4.E10.m1.12.12.2.2.1.cmml"><mi id="S4.E10.m1.12.12.2.2.1.2" xref="S4.E10.m1.12.12.2.2.1.2.cmml">C</mi><mtext id="S4.E10.m1.12.12.2.2.1.3" xref="S4.E10.m1.12.12.2.2.1.3a.cmml">p</mtext></msub><mo id="S4.E10.m1.12.12.2.2.2" xref="S4.E10.m1.12.12.2.3.cmml">,</mo><mi id="S4.E10.m1.11.11.1.1" xref="S4.E10.m1.11.11.1.1.cmml">t</mi></mrow><mi id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.3" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.E10.m1.13.13.1.1.2.2.2.2.2.5" xref="S4.E10.m1.13.13.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E10.m1.13.13.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.13b"><apply id="S4.E10.m1.13.13.1.1.3.cmml" xref="S4.E10.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.3a.cmml" xref="S4.E10.m1.13.13.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E10.m1.13.13.1.1.1.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1"><ci id="S4.E10.m1.13.13.1.1.1.1.3.cmml" xref="S4.E10.m1.13.13.1.1.1.1.3">≜</ci><apply id="S4.E10.m1.13.13.1.1.1.1.4.cmml" xref="S4.E10.m1.13.13.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.1.1.4.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.4">superscript</csymbol><apply id="S4.E10.m1.13.13.1.1.1.1.4.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.1.1.4.2.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.4">subscript</csymbol><ci id="S4.E10.m1.13.13.1.1.1.1.4.2.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.4.2.2">𝐨</ci><list id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.4"><ci id="S4.E10.m1.1.1.1.1a.cmml" xref="S4.E10.m1.1.1.1.1"><mtext mathsize="70%" id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">s</mtext></ci><ci id="S4.E10.m1.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.E10.m1.13.13.1.1.1.1.4.3.cmml" xref="S4.E10.m1.13.13.1.1.1.1.4.3">𝑘</ci></apply><apply id="S4.E10.m1.13.13.1.1.1.1.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2"><times id="S4.E10.m1.13.13.1.1.1.1.2.3.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.3"></times><apply id="S4.E10.m1.13.13.1.1.1.1.2.4.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.1.1.2.4.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.4">superscript</csymbol><apply id="S4.E10.m1.13.13.1.1.1.1.2.4.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.1.1.2.4.2.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E10.m1.13.13.1.1.1.1.2.4.2.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.4.2.2">𝐶</ci><ci id="S4.E10.m1.13.13.1.1.1.1.2.4.2.3a.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.4.2.3"><mtext mathsize="70%" id="S4.E10.m1.13.13.1.1.1.1.2.4.2.3.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.4.2.3">s</mtext></ci></apply><ci id="S4.E10.m1.13.13.1.1.1.1.2.4.3.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.4.3">𝑘</ci></apply><list id="S4.E10.m1.13.13.1.1.1.1.2.2.3.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2"><apply id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2"><ci id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.2.2.2">𝐡</ci></apply><list id="S4.E10.m1.4.4.2.3.cmml" xref="S4.E10.m1.4.4.2.4"><ci id="S4.E10.m1.3.3.1.1a.cmml" xref="S4.E10.m1.3.3.1.1"><mtext mathsize="70%" id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1.1">s</mtext></ci><ci id="S4.E10.m1.4.4.2.2.cmml" xref="S4.E10.m1.4.4.2.2">𝑖</ci></list></apply><ci id="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.13.13.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.2.2">𝜃</ci><list id="S4.E10.m1.6.6.2.3.cmml" xref="S4.E10.m1.6.6.2.2"><apply id="S4.E10.m1.6.6.2.2.1.cmml" xref="S4.E10.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S4.E10.m1.6.6.2.2.1.1.cmml" xref="S4.E10.m1.6.6.2.2.1">subscript</csymbol><ci id="S4.E10.m1.6.6.2.2.1.2.cmml" xref="S4.E10.m1.6.6.2.2.1.2">𝐶</ci><ci id="S4.E10.m1.6.6.2.2.1.3a.cmml" xref="S4.E10.m1.6.6.2.2.1.3"><mtext mathsize="50%" id="S4.E10.m1.6.6.2.2.1.3.cmml" xref="S4.E10.m1.6.6.2.2.1.3">s</mtext></ci></apply><ci id="S4.E10.m1.5.5.1.1.cmml" xref="S4.E10.m1.5.5.1.1">𝑡</ci></list></apply><ci id="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E10.m1.13.13.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="S4.E10.m1.13.13.1.1.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2"><ci id="S4.E10.m1.13.13.1.1.2.2.3.cmml" xref="S4.E10.m1.13.13.1.1.2.2.3">≜</ci><apply id="S4.E10.m1.13.13.1.1.2.2.4.cmml" xref="S4.E10.m1.13.13.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.2.2.4.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.4">superscript</csymbol><apply id="S4.E10.m1.13.13.1.1.2.2.4.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.2.2.4.2.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.4">subscript</csymbol><ci id="S4.E10.m1.13.13.1.1.2.2.4.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.4.2.2">𝐨</ci><list id="S4.E10.m1.8.8.2.3.cmml" xref="S4.E10.m1.8.8.2.4"><ci id="S4.E10.m1.7.7.1.1a.cmml" xref="S4.E10.m1.7.7.1.1"><mtext mathsize="70%" id="S4.E10.m1.7.7.1.1.cmml" xref="S4.E10.m1.7.7.1.1">p</mtext></ci><ci id="S4.E10.m1.8.8.2.2.cmml" xref="S4.E10.m1.8.8.2.2">𝑖</ci></list></apply><ci id="S4.E10.m1.13.13.1.1.2.2.4.3.cmml" xref="S4.E10.m1.13.13.1.1.2.2.4.3">𝑘</ci></apply><apply id="S4.E10.m1.13.13.1.1.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2"><times id="S4.E10.m1.13.13.1.1.2.2.2.3.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.3"></times><apply id="S4.E10.m1.13.13.1.1.2.2.2.4.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.2.2.2.4.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.4">superscript</csymbol><apply id="S4.E10.m1.13.13.1.1.2.2.2.4.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.2.2.2.4.2.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.4">subscript</csymbol><ci id="S4.E10.m1.13.13.1.1.2.2.2.4.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.4.2.2">𝐶</ci><ci id="S4.E10.m1.13.13.1.1.2.2.2.4.2.3a.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.4.2.3"><mtext mathsize="70%" id="S4.E10.m1.13.13.1.1.2.2.2.4.2.3.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.4.2.3">p</mtext></ci></apply><ci id="S4.E10.m1.13.13.1.1.2.2.2.4.3.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.4.3">𝑘</ci></apply><list id="S4.E10.m1.13.13.1.1.2.2.2.2.3.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2"><apply id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1">superscript</csymbol><apply id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1">subscript</csymbol><apply id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2"><ci id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.1">^</ci><ci id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.2.2.2">𝐡</ci></apply><list id="S4.E10.m1.10.10.2.3.cmml" xref="S4.E10.m1.10.10.2.4"><ci id="S4.E10.m1.9.9.1.1a.cmml" xref="S4.E10.m1.9.9.1.1"><mtext mathsize="70%" id="S4.E10.m1.9.9.1.1.cmml" xref="S4.E10.m1.9.9.1.1">p</mtext></ci><ci id="S4.E10.m1.10.10.2.2.cmml" xref="S4.E10.m1.10.10.2.2">𝑖</ci></list></apply><ci id="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E10.m1.13.13.1.1.2.2.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.2.1.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.2.2.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.2.2">𝜃</ci><list id="S4.E10.m1.12.12.2.3.cmml" xref="S4.E10.m1.12.12.2.2"><apply id="S4.E10.m1.12.12.2.2.1.cmml" xref="S4.E10.m1.12.12.2.2.1"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.2.2.1.1.cmml" xref="S4.E10.m1.12.12.2.2.1">subscript</csymbol><ci id="S4.E10.m1.12.12.2.2.1.2.cmml" xref="S4.E10.m1.12.12.2.2.1.2">𝐶</ci><ci id="S4.E10.m1.12.12.2.2.1.3a.cmml" xref="S4.E10.m1.12.12.2.2.1.3"><mtext mathsize="50%" id="S4.E10.m1.12.12.2.2.1.3.cmml" xref="S4.E10.m1.12.12.2.2.1.3">p</mtext></ci></apply><ci id="S4.E10.m1.11.11.1.1.cmml" xref="S4.E10.m1.11.11.1.1">𝑡</ci></list></apply><ci id="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E10.m1.13.13.1.1.2.2.2.2.2.2.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.13c">{\mathbf{o}}_{{\text{s}},i}^{k}\triangleq C_{{\text{s}}}^{k}(\hat{{\mathbf{h}}}_{{\text{s}},i}^{k};{\theta}_{C_{{\text{s}}},t}^{k}),\qquad{\mathbf{o}}_{{\text{p}},i}^{k}\triangleq C_{{\text{p}}}^{k}(\hat{{\mathbf{h}}}_{{\text{p}},i}^{k};{\theta}_{C_{{\text{p}}},t}^{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p5.4" class="ltx_p">where <math id="S4.SS3.p5.3.m1.2" class="ltx_Math" alttext="{\mathbf{o}}_{{\text{s}},i}^{k}" display="inline"><semantics id="S4.SS3.p5.3.m1.2a"><msubsup id="S4.SS3.p5.3.m1.2.3" xref="S4.SS3.p5.3.m1.2.3.cmml"><mi id="S4.SS3.p5.3.m1.2.3.2.2" xref="S4.SS3.p5.3.m1.2.3.2.2.cmml">𝐨</mi><mrow id="S4.SS3.p5.3.m1.2.2.2.4" xref="S4.SS3.p5.3.m1.2.2.2.3.cmml"><mtext id="S4.SS3.p5.3.m1.1.1.1.1" xref="S4.SS3.p5.3.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.SS3.p5.3.m1.2.2.2.4.1" xref="S4.SS3.p5.3.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p5.3.m1.2.2.2.2" xref="S4.SS3.p5.3.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.SS3.p5.3.m1.2.3.3" xref="S4.SS3.p5.3.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m1.2b"><apply id="S4.SS3.p5.3.m1.2.3.cmml" xref="S4.SS3.p5.3.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.3.m1.2.3.1.cmml" xref="S4.SS3.p5.3.m1.2.3">superscript</csymbol><apply id="S4.SS3.p5.3.m1.2.3.2.cmml" xref="S4.SS3.p5.3.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.3.m1.2.3.2.1.cmml" xref="S4.SS3.p5.3.m1.2.3">subscript</csymbol><ci id="S4.SS3.p5.3.m1.2.3.2.2.cmml" xref="S4.SS3.p5.3.m1.2.3.2.2">𝐨</ci><list id="S4.SS3.p5.3.m1.2.2.2.3.cmml" xref="S4.SS3.p5.3.m1.2.2.2.4"><ci id="S4.SS3.p5.3.m1.1.1.1.1a.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p5.3.m1.1.1.1.1.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1">s</mtext></ci><ci id="S4.SS3.p5.3.m1.2.2.2.2.cmml" xref="S4.SS3.p5.3.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.SS3.p5.3.m1.2.3.3.cmml" xref="S4.SS3.p5.3.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m1.2c">{\mathbf{o}}_{{\text{s}},i}^{k}</annotation></semantics></math> and <math id="S4.SS3.p5.4.m2.2" class="ltx_Math" alttext="{\mathbf{o}}_{{\text{p}},i}^{k}" display="inline"><semantics id="S4.SS3.p5.4.m2.2a"><msubsup id="S4.SS3.p5.4.m2.2.3" xref="S4.SS3.p5.4.m2.2.3.cmml"><mi id="S4.SS3.p5.4.m2.2.3.2.2" xref="S4.SS3.p5.4.m2.2.3.2.2.cmml">𝐨</mi><mrow id="S4.SS3.p5.4.m2.2.2.2.4" xref="S4.SS3.p5.4.m2.2.2.2.3.cmml"><mtext id="S4.SS3.p5.4.m2.1.1.1.1" xref="S4.SS3.p5.4.m2.1.1.1.1a.cmml">p</mtext><mo id="S4.SS3.p5.4.m2.2.2.2.4.1" xref="S4.SS3.p5.4.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p5.4.m2.2.2.2.2" xref="S4.SS3.p5.4.m2.2.2.2.2.cmml">i</mi></mrow><mi id="S4.SS3.p5.4.m2.2.3.3" xref="S4.SS3.p5.4.m2.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.4.m2.2b"><apply id="S4.SS3.p5.4.m2.2.3.cmml" xref="S4.SS3.p5.4.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.4.m2.2.3.1.cmml" xref="S4.SS3.p5.4.m2.2.3">superscript</csymbol><apply id="S4.SS3.p5.4.m2.2.3.2.cmml" xref="S4.SS3.p5.4.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p5.4.m2.2.3.2.1.cmml" xref="S4.SS3.p5.4.m2.2.3">subscript</csymbol><ci id="S4.SS3.p5.4.m2.2.3.2.2.cmml" xref="S4.SS3.p5.4.m2.2.3.2.2">𝐨</ci><list id="S4.SS3.p5.4.m2.2.2.2.3.cmml" xref="S4.SS3.p5.4.m2.2.2.2.4"><ci id="S4.SS3.p5.4.m2.1.1.1.1a.cmml" xref="S4.SS3.p5.4.m2.1.1.1.1"><mtext mathsize="70%" id="S4.SS3.p5.4.m2.1.1.1.1.cmml" xref="S4.SS3.p5.4.m2.1.1.1.1">p</mtext></ci><ci id="S4.SS3.p5.4.m2.2.2.2.2.cmml" xref="S4.SS3.p5.4.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S4.SS3.p5.4.m2.2.3.3.cmml" xref="S4.SS3.p5.4.m2.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.4.m2.2c">{\mathbf{o}}_{{\text{p}},i}^{k}</annotation></semantics></math> are the unnormalized outputs of shared classifier and private classifier correspondingly. Before using softmax and calculating cross-entropy loss, we similarly take a symmetric fusion as follows:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.5" class="ltx_Math" alttext="\hat{{\mathbf{o}}}_{i}^{k}\triangleq\hat{\beta}_{0}^{k}{\mathbf{o}}_{{\text{s}},i}^{k}+\hat{\beta}_{1}^{k}{\mathbf{o}}_{{\text{p}},i}^{k}," display="block"><semantics id="S4.E11.m1.5a"><mrow id="S4.E11.m1.5.5.1" xref="S4.E11.m1.5.5.1.1.cmml"><mrow id="S4.E11.m1.5.5.1.1" xref="S4.E11.m1.5.5.1.1.cmml"><msubsup id="S4.E11.m1.5.5.1.1.2" xref="S4.E11.m1.5.5.1.1.2.cmml"><mover accent="true" id="S4.E11.m1.5.5.1.1.2.2.2" xref="S4.E11.m1.5.5.1.1.2.2.2.cmml"><mi id="S4.E11.m1.5.5.1.1.2.2.2.2" xref="S4.E11.m1.5.5.1.1.2.2.2.2.cmml">𝐨</mi><mo id="S4.E11.m1.5.5.1.1.2.2.2.1" xref="S4.E11.m1.5.5.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S4.E11.m1.5.5.1.1.2.2.3" xref="S4.E11.m1.5.5.1.1.2.2.3.cmml">i</mi><mi id="S4.E11.m1.5.5.1.1.2.3" xref="S4.E11.m1.5.5.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.E11.m1.5.5.1.1.1" xref="S4.E11.m1.5.5.1.1.1.cmml">≜</mo><mrow id="S4.E11.m1.5.5.1.1.3" xref="S4.E11.m1.5.5.1.1.3.cmml"><mrow id="S4.E11.m1.5.5.1.1.3.2" xref="S4.E11.m1.5.5.1.1.3.2.cmml"><msubsup id="S4.E11.m1.5.5.1.1.3.2.2" xref="S4.E11.m1.5.5.1.1.3.2.2.cmml"><mover accent="true" id="S4.E11.m1.5.5.1.1.3.2.2.2.2" xref="S4.E11.m1.5.5.1.1.3.2.2.2.2.cmml"><mi id="S4.E11.m1.5.5.1.1.3.2.2.2.2.2" xref="S4.E11.m1.5.5.1.1.3.2.2.2.2.2.cmml">β</mi><mo id="S4.E11.m1.5.5.1.1.3.2.2.2.2.1" xref="S4.E11.m1.5.5.1.1.3.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.E11.m1.5.5.1.1.3.2.2.2.3" xref="S4.E11.m1.5.5.1.1.3.2.2.2.3.cmml">0</mn><mi id="S4.E11.m1.5.5.1.1.3.2.2.3" xref="S4.E11.m1.5.5.1.1.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E11.m1.5.5.1.1.3.2.1" xref="S4.E11.m1.5.5.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E11.m1.5.5.1.1.3.2.3" xref="S4.E11.m1.5.5.1.1.3.2.3.cmml"><mi id="S4.E11.m1.5.5.1.1.3.2.3.2.2" xref="S4.E11.m1.5.5.1.1.3.2.3.2.2.cmml">𝐨</mi><mrow id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.3.cmml"><mtext id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1a.cmml">s</mtext><mo id="S4.E11.m1.2.2.2.4.1" xref="S4.E11.m1.2.2.2.3.cmml">,</mo><mi id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S4.E11.m1.5.5.1.1.3.2.3.3" xref="S4.E11.m1.5.5.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E11.m1.5.5.1.1.3.1" xref="S4.E11.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S4.E11.m1.5.5.1.1.3.3" xref="S4.E11.m1.5.5.1.1.3.3.cmml"><msubsup id="S4.E11.m1.5.5.1.1.3.3.2" xref="S4.E11.m1.5.5.1.1.3.3.2.cmml"><mover accent="true" id="S4.E11.m1.5.5.1.1.3.3.2.2.2" xref="S4.E11.m1.5.5.1.1.3.3.2.2.2.cmml"><mi id="S4.E11.m1.5.5.1.1.3.3.2.2.2.2" xref="S4.E11.m1.5.5.1.1.3.3.2.2.2.2.cmml">β</mi><mo id="S4.E11.m1.5.5.1.1.3.3.2.2.2.1" xref="S4.E11.m1.5.5.1.1.3.3.2.2.2.1.cmml">^</mo></mover><mn id="S4.E11.m1.5.5.1.1.3.3.2.2.3" xref="S4.E11.m1.5.5.1.1.3.3.2.2.3.cmml">1</mn><mi id="S4.E11.m1.5.5.1.1.3.3.2.3" xref="S4.E11.m1.5.5.1.1.3.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E11.m1.5.5.1.1.3.3.1" xref="S4.E11.m1.5.5.1.1.3.3.1.cmml">​</mo><msubsup id="S4.E11.m1.5.5.1.1.3.3.3" xref="S4.E11.m1.5.5.1.1.3.3.3.cmml"><mi id="S4.E11.m1.5.5.1.1.3.3.3.2.2" xref="S4.E11.m1.5.5.1.1.3.3.3.2.2.cmml">𝐨</mi><mrow id="S4.E11.m1.4.4.2.4" xref="S4.E11.m1.4.4.2.3.cmml"><mtext id="S4.E11.m1.3.3.1.1" xref="S4.E11.m1.3.3.1.1a.cmml">p</mtext><mo id="S4.E11.m1.4.4.2.4.1" xref="S4.E11.m1.4.4.2.3.cmml">,</mo><mi id="S4.E11.m1.4.4.2.2" xref="S4.E11.m1.4.4.2.2.cmml">i</mi></mrow><mi id="S4.E11.m1.5.5.1.1.3.3.3.3" xref="S4.E11.m1.5.5.1.1.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S4.E11.m1.5.5.1.2" xref="S4.E11.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.5b"><apply id="S4.E11.m1.5.5.1.1.cmml" xref="S4.E11.m1.5.5.1"><ci id="S4.E11.m1.5.5.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1">≜</ci><apply id="S4.E11.m1.5.5.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E11.m1.5.5.1.1.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2.2.2"><ci id="S4.E11.m1.5.5.1.1.2.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2.2.2.1">^</ci><ci id="S4.E11.m1.5.5.1.1.2.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2.2.2.2">𝐨</ci></apply><ci id="S4.E11.m1.5.5.1.1.2.2.3.cmml" xref="S4.E11.m1.5.5.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E11.m1.5.5.1.1.2.3.cmml" xref="S4.E11.m1.5.5.1.1.2.3">𝑘</ci></apply><apply id="S4.E11.m1.5.5.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.3"><plus id="S4.E11.m1.5.5.1.1.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3.1"></plus><apply id="S4.E11.m1.5.5.1.1.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2"><times id="S4.E11.m1.5.5.1.1.3.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.1"></times><apply id="S4.E11.m1.5.5.1.1.3.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2">subscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.2.2"><ci id="S4.E11.m1.5.5.1.1.3.2.2.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.2.2.1">^</ci><ci id="S4.E11.m1.5.5.1.1.3.2.2.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.2.2.2">𝛽</ci></apply><cn type="integer" id="S4.E11.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.2.3">0</cn></apply><ci id="S4.E11.m1.5.5.1.1.3.2.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.3">𝑘</ci></apply><apply id="S4.E11.m1.5.5.1.1.3.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.2.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.3">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.2.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.2.3.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.3">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.3.2.3.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.3.2.2">𝐨</ci><list id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.4"><ci id="S4.E11.m1.1.1.1.1a.cmml" xref="S4.E11.m1.1.1.1.1"><mtext mathsize="70%" id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1">s</mtext></ci><ci id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S4.E11.m1.5.5.1.1.3.2.3.3.cmml" xref="S4.E11.m1.5.5.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S4.E11.m1.5.5.1.1.3.3.cmml" xref="S4.E11.m1.5.5.1.1.3.3"><times id="S4.E11.m1.5.5.1.1.3.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3.1"></times><apply id="S4.E11.m1.5.5.1.1.3.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.3.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.3.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.3.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2">subscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.3.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.2.2"><ci id="S4.E11.m1.5.5.1.1.3.3.2.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.2.2.1">^</ci><ci id="S4.E11.m1.5.5.1.1.3.3.2.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.2.2.2">𝛽</ci></apply><cn type="integer" id="S4.E11.m1.5.5.1.1.3.3.2.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.2.3">1</cn></apply><ci id="S4.E11.m1.5.5.1.1.3.3.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.3">𝑘</ci></apply><apply id="S4.E11.m1.5.5.1.1.3.3.3.cmml" xref="S4.E11.m1.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.3.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3.3">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.3.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.3.3.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3.3">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.3.3.3.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3.3.2.2">𝐨</ci><list id="S4.E11.m1.4.4.2.3.cmml" xref="S4.E11.m1.4.4.2.4"><ci id="S4.E11.m1.3.3.1.1a.cmml" xref="S4.E11.m1.3.3.1.1"><mtext mathsize="70%" id="S4.E11.m1.3.3.1.1.cmml" xref="S4.E11.m1.3.3.1.1">p</mtext></ci><ci id="S4.E11.m1.4.4.2.2.cmml" xref="S4.E11.m1.4.4.2.2">𝑖</ci></list></apply><ci id="S4.E11.m1.5.5.1.1.3.3.3.3.cmml" xref="S4.E11.m1.5.5.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.5c">\hat{{\mathbf{o}}}_{i}^{k}\triangleq\hat{\beta}_{0}^{k}{\mathbf{o}}_{{\text{s}},i}^{k}+\hat{\beta}_{1}^{k}{\mathbf{o}}_{{\text{p}},i}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p5.7" class="ltx_p">where <math id="S4.SS3.p5.5.m1.1" class="ltx_Math" alttext="\hat{{\mathbf{o}}}_{i}^{k}" display="inline"><semantics id="S4.SS3.p5.5.m1.1a"><msubsup id="S4.SS3.p5.5.m1.1.1" xref="S4.SS3.p5.5.m1.1.1.cmml"><mover accent="true" id="S4.SS3.p5.5.m1.1.1.2.2" xref="S4.SS3.p5.5.m1.1.1.2.2.cmml"><mi id="S4.SS3.p5.5.m1.1.1.2.2.2" xref="S4.SS3.p5.5.m1.1.1.2.2.2.cmml">𝐨</mi><mo id="S4.SS3.p5.5.m1.1.1.2.2.1" xref="S4.SS3.p5.5.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS3.p5.5.m1.1.1.2.3" xref="S4.SS3.p5.5.m1.1.1.2.3.cmml">i</mi><mi id="S4.SS3.p5.5.m1.1.1.3" xref="S4.SS3.p5.5.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.5.m1.1b"><apply id="S4.SS3.p5.5.m1.1.1.cmml" xref="S4.SS3.p5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.5.m1.1.1.1.cmml" xref="S4.SS3.p5.5.m1.1.1">superscript</csymbol><apply id="S4.SS3.p5.5.m1.1.1.2.cmml" xref="S4.SS3.p5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.5.m1.1.1.2.1.cmml" xref="S4.SS3.p5.5.m1.1.1">subscript</csymbol><apply id="S4.SS3.p5.5.m1.1.1.2.2.cmml" xref="S4.SS3.p5.5.m1.1.1.2.2"><ci id="S4.SS3.p5.5.m1.1.1.2.2.1.cmml" xref="S4.SS3.p5.5.m1.1.1.2.2.1">^</ci><ci id="S4.SS3.p5.5.m1.1.1.2.2.2.cmml" xref="S4.SS3.p5.5.m1.1.1.2.2.2">𝐨</ci></apply><ci id="S4.SS3.p5.5.m1.1.1.2.3.cmml" xref="S4.SS3.p5.5.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS3.p5.5.m1.1.1.3.cmml" xref="S4.SS3.p5.5.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.5.m1.1c">\hat{{\mathbf{o}}}_{i}^{k}</annotation></semantics></math> is the final weighted output, and it will be applied with softmax to calculate the cross-entopy loss. For cross-stitch and soft attention, <math id="S4.SS3.p5.6.m2.4" class="ltx_Math" alttext="\hat{\beta}_{0}^{k},\hat{\beta}_{1}^{k}=\text{SoftMax}(\beta_{0}^{k}/\lambda,\beta_{1}^{k}/\lambda)" display="inline"><semantics id="S4.SS3.p5.6.m2.4a"><mrow id="S4.SS3.p5.6.m2.4.4" xref="S4.SS3.p5.6.m2.4.4.cmml"><mrow id="S4.SS3.p5.6.m2.2.2.2.2" xref="S4.SS3.p5.6.m2.2.2.2.3.cmml"><msubsup id="S4.SS3.p5.6.m2.1.1.1.1.1" xref="S4.SS3.p5.6.m2.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS3.p5.6.m2.1.1.1.1.1.2.2" xref="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.cmml"><mi id="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.2" xref="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.2.cmml">β</mi><mo id="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.1" xref="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p5.6.m2.1.1.1.1.1.2.3" xref="S4.SS3.p5.6.m2.1.1.1.1.1.2.3.cmml">0</mn><mi id="S4.SS3.p5.6.m2.1.1.1.1.1.3" xref="S4.SS3.p5.6.m2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p5.6.m2.2.2.2.2.3" xref="S4.SS3.p5.6.m2.2.2.2.3.cmml">,</mo><msubsup id="S4.SS3.p5.6.m2.2.2.2.2.2" xref="S4.SS3.p5.6.m2.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS3.p5.6.m2.2.2.2.2.2.2.2" xref="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.cmml"><mi id="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.2" xref="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.2.cmml">β</mi><mo id="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.1" xref="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p5.6.m2.2.2.2.2.2.2.3" xref="S4.SS3.p5.6.m2.2.2.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p5.6.m2.2.2.2.2.2.3" xref="S4.SS3.p5.6.m2.2.2.2.2.2.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS3.p5.6.m2.4.4.5" xref="S4.SS3.p5.6.m2.4.4.5.cmml">=</mo><mrow id="S4.SS3.p5.6.m2.4.4.4" xref="S4.SS3.p5.6.m2.4.4.4.cmml"><mtext id="S4.SS3.p5.6.m2.4.4.4.4" xref="S4.SS3.p5.6.m2.4.4.4.4a.cmml">SoftMax</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p5.6.m2.4.4.4.3" xref="S4.SS3.p5.6.m2.4.4.4.3.cmml">​</mo><mrow id="S4.SS3.p5.6.m2.4.4.4.2.2" xref="S4.SS3.p5.6.m2.4.4.4.2.3.cmml"><mo stretchy="false" id="S4.SS3.p5.6.m2.4.4.4.2.2.3" xref="S4.SS3.p5.6.m2.4.4.4.2.3.cmml">(</mo><mrow id="S4.SS3.p5.6.m2.3.3.3.1.1.1" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.cmml"><msubsup id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.cmml"><mi id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.2" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.2.cmml">β</mi><mn id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.3" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.3.cmml">0</mn><mi id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.3" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p5.6.m2.3.3.3.1.1.1.1" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.1.cmml">/</mo><mi id="S4.SS3.p5.6.m2.3.3.3.1.1.1.3" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.3.cmml">λ</mi></mrow><mo id="S4.SS3.p5.6.m2.4.4.4.2.2.4" xref="S4.SS3.p5.6.m2.4.4.4.2.3.cmml">,</mo><mrow id="S4.SS3.p5.6.m2.4.4.4.2.2.2" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.cmml"><msubsup id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.cmml"><mi id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.2" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.2.cmml">β</mi><mn id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.3" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.3" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S4.SS3.p5.6.m2.4.4.4.2.2.2.1" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.1.cmml">/</mo><mi id="S4.SS3.p5.6.m2.4.4.4.2.2.2.3" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.3.cmml">λ</mi></mrow><mo stretchy="false" id="S4.SS3.p5.6.m2.4.4.4.2.2.5" xref="S4.SS3.p5.6.m2.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.6.m2.4b"><apply id="S4.SS3.p5.6.m2.4.4.cmml" xref="S4.SS3.p5.6.m2.4.4"><eq id="S4.SS3.p5.6.m2.4.4.5.cmml" xref="S4.SS3.p5.6.m2.4.4.5"></eq><list id="S4.SS3.p5.6.m2.2.2.2.3.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2"><apply id="S4.SS3.p5.6.m2.1.1.1.1.1.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p5.6.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1">subscript</csymbol><apply id="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1.2.2"><ci id="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.1">^</ci><ci id="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1.2.2.2">𝛽</ci></apply><cn type="integer" id="S4.SS3.p5.6.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p5.6.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.p5.6.m2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p5.6.m2.2.2.2.2.2.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m2.2.2.2.2.2.1.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p5.6.m2.2.2.2.2.2.2.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2">subscript</csymbol><apply id="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2.2.2"><ci id="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.1">^</ci><ci id="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2.2.2.2">𝛽</ci></apply><cn type="integer" id="S4.SS3.p5.6.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p5.6.m2.2.2.2.2.2.3.cmml" xref="S4.SS3.p5.6.m2.2.2.2.2.2.3">𝑘</ci></apply></list><apply id="S4.SS3.p5.6.m2.4.4.4.cmml" xref="S4.SS3.p5.6.m2.4.4.4"><times id="S4.SS3.p5.6.m2.4.4.4.3.cmml" xref="S4.SS3.p5.6.m2.4.4.4.3"></times><ci id="S4.SS3.p5.6.m2.4.4.4.4a.cmml" xref="S4.SS3.p5.6.m2.4.4.4.4"><mtext id="S4.SS3.p5.6.m2.4.4.4.4.cmml" xref="S4.SS3.p5.6.m2.4.4.4.4">SoftMax</mtext></ci><interval closure="open" id="S4.SS3.p5.6.m2.4.4.4.2.3.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2"><apply id="S4.SS3.p5.6.m2.3.3.3.1.1.1.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1"><divide id="S4.SS3.p5.6.m2.3.3.3.1.1.1.1.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.1"></divide><apply id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.1.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2">superscript</csymbol><apply id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.1.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.2.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.2">𝛽</ci><cn type="integer" id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.3.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.2.3">0</cn></apply><ci id="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.3.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS3.p5.6.m2.3.3.3.1.1.1.3.cmml" xref="S4.SS3.p5.6.m2.3.3.3.1.1.1.3">𝜆</ci></apply><apply id="S4.SS3.p5.6.m2.4.4.4.2.2.2.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2"><divide id="S4.SS3.p5.6.m2.4.4.4.2.2.2.1.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.1"></divide><apply id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.1.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.1.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.2.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.2">𝛽</ci><cn type="integer" id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.3.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.3.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.2.3">𝑘</ci></apply><ci id="S4.SS3.p5.6.m2.4.4.4.2.2.2.3.cmml" xref="S4.SS3.p5.6.m2.4.4.4.2.2.2.3">𝜆</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.6.m2.4c">\hat{\beta}_{0}^{k},\hat{\beta}_{1}^{k}=\text{SoftMax}(\beta_{0}^{k}/\lambda,\beta_{1}^{k}/\lambda)</annotation></semantics></math>, while for hard selection, <math id="S4.SS3.p5.7.m3.4" class="ltx_Math" alttext="\hat{\beta}_{0}^{k},\hat{\beta}_{1}^{k}=\text{GumbelSoftMax}(\beta_{0}^{k},\beta_{1}^{k})" display="inline"><semantics id="S4.SS3.p5.7.m3.4a"><mrow id="S4.SS3.p5.7.m3.4.4" xref="S4.SS3.p5.7.m3.4.4.cmml"><mrow id="S4.SS3.p5.7.m3.2.2.2.2" xref="S4.SS3.p5.7.m3.2.2.2.3.cmml"><msubsup id="S4.SS3.p5.7.m3.1.1.1.1.1" xref="S4.SS3.p5.7.m3.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS3.p5.7.m3.1.1.1.1.1.2.2" xref="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.cmml"><mi id="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.2" xref="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.2.cmml">β</mi><mo id="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.1" xref="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p5.7.m3.1.1.1.1.1.2.3" xref="S4.SS3.p5.7.m3.1.1.1.1.1.2.3.cmml">0</mn><mi id="S4.SS3.p5.7.m3.1.1.1.1.1.3" xref="S4.SS3.p5.7.m3.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p5.7.m3.2.2.2.2.3" xref="S4.SS3.p5.7.m3.2.2.2.3.cmml">,</mo><msubsup id="S4.SS3.p5.7.m3.2.2.2.2.2" xref="S4.SS3.p5.7.m3.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS3.p5.7.m3.2.2.2.2.2.2.2" xref="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.cmml"><mi id="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.2" xref="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.2.cmml">β</mi><mo id="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.1" xref="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p5.7.m3.2.2.2.2.2.2.3" xref="S4.SS3.p5.7.m3.2.2.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p5.7.m3.2.2.2.2.2.3" xref="S4.SS3.p5.7.m3.2.2.2.2.2.3.cmml">k</mi></msubsup></mrow><mo id="S4.SS3.p5.7.m3.4.4.5" xref="S4.SS3.p5.7.m3.4.4.5.cmml">=</mo><mrow id="S4.SS3.p5.7.m3.4.4.4" xref="S4.SS3.p5.7.m3.4.4.4.cmml"><mtext id="S4.SS3.p5.7.m3.4.4.4.4" xref="S4.SS3.p5.7.m3.4.4.4.4a.cmml">GumbelSoftMax</mtext><mo lspace="0em" rspace="0em" id="S4.SS3.p5.7.m3.4.4.4.3" xref="S4.SS3.p5.7.m3.4.4.4.3.cmml">​</mo><mrow id="S4.SS3.p5.7.m3.4.4.4.2.2" xref="S4.SS3.p5.7.m3.4.4.4.2.3.cmml"><mo stretchy="false" id="S4.SS3.p5.7.m3.4.4.4.2.2.3" xref="S4.SS3.p5.7.m3.4.4.4.2.3.cmml">(</mo><msubsup id="S4.SS3.p5.7.m3.3.3.3.1.1.1" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1.cmml"><mi id="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.2" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.2.cmml">β</mi><mn id="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.3" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.3.cmml">0</mn><mi id="S4.SS3.p5.7.m3.3.3.3.1.1.1.3" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1.3.cmml">k</mi></msubsup><mo id="S4.SS3.p5.7.m3.4.4.4.2.2.4" xref="S4.SS3.p5.7.m3.4.4.4.2.3.cmml">,</mo><msubsup id="S4.SS3.p5.7.m3.4.4.4.2.2.2" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2.cmml"><mi id="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.2" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.2.cmml">β</mi><mn id="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.3" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.3.cmml">1</mn><mi id="S4.SS3.p5.7.m3.4.4.4.2.2.2.3" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS3.p5.7.m3.4.4.4.2.2.5" xref="S4.SS3.p5.7.m3.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.7.m3.4b"><apply id="S4.SS3.p5.7.m3.4.4.cmml" xref="S4.SS3.p5.7.m3.4.4"><eq id="S4.SS3.p5.7.m3.4.4.5.cmml" xref="S4.SS3.p5.7.m3.4.4.5"></eq><list id="S4.SS3.p5.7.m3.2.2.2.3.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2"><apply id="S4.SS3.p5.7.m3.1.1.1.1.1.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m3.1.1.1.1.1.1.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p5.7.m3.1.1.1.1.1.2.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1">subscript</csymbol><apply id="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1.2.2"><ci id="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.1">^</ci><ci id="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1.2.2.2">𝛽</ci></apply><cn type="integer" id="S4.SS3.p5.7.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p5.7.m3.1.1.1.1.1.3.cmml" xref="S4.SS3.p5.7.m3.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p5.7.m3.2.2.2.2.2.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m3.2.2.2.2.2.1.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2">superscript</csymbol><apply id="S4.SS3.p5.7.m3.2.2.2.2.2.2.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m3.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2">subscript</csymbol><apply id="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2.2.2"><ci id="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.1">^</ci><ci id="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2.2.2.2">𝛽</ci></apply><cn type="integer" id="S4.SS3.p5.7.m3.2.2.2.2.2.2.3.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p5.7.m3.2.2.2.2.2.3.cmml" xref="S4.SS3.p5.7.m3.2.2.2.2.2.3">𝑘</ci></apply></list><apply id="S4.SS3.p5.7.m3.4.4.4.cmml" xref="S4.SS3.p5.7.m3.4.4.4"><times id="S4.SS3.p5.7.m3.4.4.4.3.cmml" xref="S4.SS3.p5.7.m3.4.4.4.3"></times><ci id="S4.SS3.p5.7.m3.4.4.4.4a.cmml" xref="S4.SS3.p5.7.m3.4.4.4.4"><mtext id="S4.SS3.p5.7.m3.4.4.4.4.cmml" xref="S4.SS3.p5.7.m3.4.4.4.4">GumbelSoftMax</mtext></ci><interval closure="open" id="S4.SS3.p5.7.m3.4.4.4.2.3.cmml" xref="S4.SS3.p5.7.m3.4.4.4.2.2"><apply id="S4.SS3.p5.7.m3.3.3.3.1.1.1.cmml" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m3.3.3.3.1.1.1.1.cmml" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1">superscript</csymbol><apply id="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.cmml" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.1.cmml" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1">subscript</csymbol><ci id="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.2.cmml" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.2">𝛽</ci><cn type="integer" id="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.3.cmml" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p5.7.m3.3.3.3.1.1.1.3.cmml" xref="S4.SS3.p5.7.m3.3.3.3.1.1.1.3">𝑘</ci></apply><apply id="S4.SS3.p5.7.m3.4.4.4.2.2.2.cmml" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m3.4.4.4.2.2.2.1.cmml" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2">superscript</csymbol><apply id="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.cmml" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.1.cmml" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2">subscript</csymbol><ci id="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.2.cmml" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.2">𝛽</ci><cn type="integer" id="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.3.cmml" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2.2.3">1</cn></apply><ci id="S4.SS3.p5.7.m3.4.4.4.2.2.2.3.cmml" xref="S4.SS3.p5.7.m3.4.4.4.2.2.2.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.7.m3.4c">\hat{\beta}_{0}^{k},\hat{\beta}_{1}^{k}=\text{GumbelSoftMax}(\beta_{0}^{k},\beta_{1}^{k})</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.3" class="ltx_p">In total, for cross-stitch, we have <math id="S4.SS3.p6.1.m1.14" class="ltx_Math" alttext="\psi=\{\alpha_{0,0},\alpha_{0,1},\alpha_{1,0},\alpha_{1,1},\beta_{0},\beta_{1}\}" display="inline"><semantics id="S4.SS3.p6.1.m1.14a"><mrow id="S4.SS3.p6.1.m1.14.14" xref="S4.SS3.p6.1.m1.14.14.cmml"><mi id="S4.SS3.p6.1.m1.14.14.8" xref="S4.SS3.p6.1.m1.14.14.8.cmml">ψ</mi><mo id="S4.SS3.p6.1.m1.14.14.7" xref="S4.SS3.p6.1.m1.14.14.7.cmml">=</mo><mrow id="S4.SS3.p6.1.m1.14.14.6.6" xref="S4.SS3.p6.1.m1.14.14.6.7.cmml"><mo stretchy="false" id="S4.SS3.p6.1.m1.14.14.6.6.7" xref="S4.SS3.p6.1.m1.14.14.6.7.cmml">{</mo><msub id="S4.SS3.p6.1.m1.9.9.1.1.1" xref="S4.SS3.p6.1.m1.9.9.1.1.1.cmml"><mi id="S4.SS3.p6.1.m1.9.9.1.1.1.2" xref="S4.SS3.p6.1.m1.9.9.1.1.1.2.cmml">α</mi><mrow id="S4.SS3.p6.1.m1.2.2.2.4" xref="S4.SS3.p6.1.m1.2.2.2.3.cmml"><mn id="S4.SS3.p6.1.m1.1.1.1.1" xref="S4.SS3.p6.1.m1.1.1.1.1.cmml">0</mn><mo id="S4.SS3.p6.1.m1.2.2.2.4.1" xref="S4.SS3.p6.1.m1.2.2.2.3.cmml">,</mo><mn id="S4.SS3.p6.1.m1.2.2.2.2" xref="S4.SS3.p6.1.m1.2.2.2.2.cmml">0</mn></mrow></msub><mo id="S4.SS3.p6.1.m1.14.14.6.6.8" xref="S4.SS3.p6.1.m1.14.14.6.7.cmml">,</mo><msub id="S4.SS3.p6.1.m1.10.10.2.2.2" xref="S4.SS3.p6.1.m1.10.10.2.2.2.cmml"><mi id="S4.SS3.p6.1.m1.10.10.2.2.2.2" xref="S4.SS3.p6.1.m1.10.10.2.2.2.2.cmml">α</mi><mrow id="S4.SS3.p6.1.m1.4.4.2.4" xref="S4.SS3.p6.1.m1.4.4.2.3.cmml"><mn id="S4.SS3.p6.1.m1.3.3.1.1" xref="S4.SS3.p6.1.m1.3.3.1.1.cmml">0</mn><mo id="S4.SS3.p6.1.m1.4.4.2.4.1" xref="S4.SS3.p6.1.m1.4.4.2.3.cmml">,</mo><mn id="S4.SS3.p6.1.m1.4.4.2.2" xref="S4.SS3.p6.1.m1.4.4.2.2.cmml">1</mn></mrow></msub><mo id="S4.SS3.p6.1.m1.14.14.6.6.9" xref="S4.SS3.p6.1.m1.14.14.6.7.cmml">,</mo><msub id="S4.SS3.p6.1.m1.11.11.3.3.3" xref="S4.SS3.p6.1.m1.11.11.3.3.3.cmml"><mi id="S4.SS3.p6.1.m1.11.11.3.3.3.2" xref="S4.SS3.p6.1.m1.11.11.3.3.3.2.cmml">α</mi><mrow id="S4.SS3.p6.1.m1.6.6.2.4" xref="S4.SS3.p6.1.m1.6.6.2.3.cmml"><mn id="S4.SS3.p6.1.m1.5.5.1.1" xref="S4.SS3.p6.1.m1.5.5.1.1.cmml">1</mn><mo id="S4.SS3.p6.1.m1.6.6.2.4.1" xref="S4.SS3.p6.1.m1.6.6.2.3.cmml">,</mo><mn id="S4.SS3.p6.1.m1.6.6.2.2" xref="S4.SS3.p6.1.m1.6.6.2.2.cmml">0</mn></mrow></msub><mo id="S4.SS3.p6.1.m1.14.14.6.6.10" xref="S4.SS3.p6.1.m1.14.14.6.7.cmml">,</mo><msub id="S4.SS3.p6.1.m1.12.12.4.4.4" xref="S4.SS3.p6.1.m1.12.12.4.4.4.cmml"><mi id="S4.SS3.p6.1.m1.12.12.4.4.4.2" xref="S4.SS3.p6.1.m1.12.12.4.4.4.2.cmml">α</mi><mrow id="S4.SS3.p6.1.m1.8.8.2.4" xref="S4.SS3.p6.1.m1.8.8.2.3.cmml"><mn id="S4.SS3.p6.1.m1.7.7.1.1" xref="S4.SS3.p6.1.m1.7.7.1.1.cmml">1</mn><mo id="S4.SS3.p6.1.m1.8.8.2.4.1" xref="S4.SS3.p6.1.m1.8.8.2.3.cmml">,</mo><mn id="S4.SS3.p6.1.m1.8.8.2.2" xref="S4.SS3.p6.1.m1.8.8.2.2.cmml">1</mn></mrow></msub><mo id="S4.SS3.p6.1.m1.14.14.6.6.11" xref="S4.SS3.p6.1.m1.14.14.6.7.cmml">,</mo><msub id="S4.SS3.p6.1.m1.13.13.5.5.5" xref="S4.SS3.p6.1.m1.13.13.5.5.5.cmml"><mi id="S4.SS3.p6.1.m1.13.13.5.5.5.2" xref="S4.SS3.p6.1.m1.13.13.5.5.5.2.cmml">β</mi><mn id="S4.SS3.p6.1.m1.13.13.5.5.5.3" xref="S4.SS3.p6.1.m1.13.13.5.5.5.3.cmml">0</mn></msub><mo id="S4.SS3.p6.1.m1.14.14.6.6.12" xref="S4.SS3.p6.1.m1.14.14.6.7.cmml">,</mo><msub id="S4.SS3.p6.1.m1.14.14.6.6.6" xref="S4.SS3.p6.1.m1.14.14.6.6.6.cmml"><mi id="S4.SS3.p6.1.m1.14.14.6.6.6.2" xref="S4.SS3.p6.1.m1.14.14.6.6.6.2.cmml">β</mi><mn id="S4.SS3.p6.1.m1.14.14.6.6.6.3" xref="S4.SS3.p6.1.m1.14.14.6.6.6.3.cmml">1</mn></msub><mo stretchy="false" id="S4.SS3.p6.1.m1.14.14.6.6.13" xref="S4.SS3.p6.1.m1.14.14.6.7.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.14b"><apply id="S4.SS3.p6.1.m1.14.14.cmml" xref="S4.SS3.p6.1.m1.14.14"><eq id="S4.SS3.p6.1.m1.14.14.7.cmml" xref="S4.SS3.p6.1.m1.14.14.7"></eq><ci id="S4.SS3.p6.1.m1.14.14.8.cmml" xref="S4.SS3.p6.1.m1.14.14.8">𝜓</ci><set id="S4.SS3.p6.1.m1.14.14.6.7.cmml" xref="S4.SS3.p6.1.m1.14.14.6.6"><apply id="S4.SS3.p6.1.m1.9.9.1.1.1.cmml" xref="S4.SS3.p6.1.m1.9.9.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.9.9.1.1.1.1.cmml" xref="S4.SS3.p6.1.m1.9.9.1.1.1">subscript</csymbol><ci id="S4.SS3.p6.1.m1.9.9.1.1.1.2.cmml" xref="S4.SS3.p6.1.m1.9.9.1.1.1.2">𝛼</ci><list id="S4.SS3.p6.1.m1.2.2.2.3.cmml" xref="S4.SS3.p6.1.m1.2.2.2.4"><cn type="integer" id="S4.SS3.p6.1.m1.1.1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1.1.1">0</cn><cn type="integer" id="S4.SS3.p6.1.m1.2.2.2.2.cmml" xref="S4.SS3.p6.1.m1.2.2.2.2">0</cn></list></apply><apply id="S4.SS3.p6.1.m1.10.10.2.2.2.cmml" xref="S4.SS3.p6.1.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.10.10.2.2.2.1.cmml" xref="S4.SS3.p6.1.m1.10.10.2.2.2">subscript</csymbol><ci id="S4.SS3.p6.1.m1.10.10.2.2.2.2.cmml" xref="S4.SS3.p6.1.m1.10.10.2.2.2.2">𝛼</ci><list id="S4.SS3.p6.1.m1.4.4.2.3.cmml" xref="S4.SS3.p6.1.m1.4.4.2.4"><cn type="integer" id="S4.SS3.p6.1.m1.3.3.1.1.cmml" xref="S4.SS3.p6.1.m1.3.3.1.1">0</cn><cn type="integer" id="S4.SS3.p6.1.m1.4.4.2.2.cmml" xref="S4.SS3.p6.1.m1.4.4.2.2">1</cn></list></apply><apply id="S4.SS3.p6.1.m1.11.11.3.3.3.cmml" xref="S4.SS3.p6.1.m1.11.11.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.11.11.3.3.3.1.cmml" xref="S4.SS3.p6.1.m1.11.11.3.3.3">subscript</csymbol><ci id="S4.SS3.p6.1.m1.11.11.3.3.3.2.cmml" xref="S4.SS3.p6.1.m1.11.11.3.3.3.2">𝛼</ci><list id="S4.SS3.p6.1.m1.6.6.2.3.cmml" xref="S4.SS3.p6.1.m1.6.6.2.4"><cn type="integer" id="S4.SS3.p6.1.m1.5.5.1.1.cmml" xref="S4.SS3.p6.1.m1.5.5.1.1">1</cn><cn type="integer" id="S4.SS3.p6.1.m1.6.6.2.2.cmml" xref="S4.SS3.p6.1.m1.6.6.2.2">0</cn></list></apply><apply id="S4.SS3.p6.1.m1.12.12.4.4.4.cmml" xref="S4.SS3.p6.1.m1.12.12.4.4.4"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.12.12.4.4.4.1.cmml" xref="S4.SS3.p6.1.m1.12.12.4.4.4">subscript</csymbol><ci id="S4.SS3.p6.1.m1.12.12.4.4.4.2.cmml" xref="S4.SS3.p6.1.m1.12.12.4.4.4.2">𝛼</ci><list id="S4.SS3.p6.1.m1.8.8.2.3.cmml" xref="S4.SS3.p6.1.m1.8.8.2.4"><cn type="integer" id="S4.SS3.p6.1.m1.7.7.1.1.cmml" xref="S4.SS3.p6.1.m1.7.7.1.1">1</cn><cn type="integer" id="S4.SS3.p6.1.m1.8.8.2.2.cmml" xref="S4.SS3.p6.1.m1.8.8.2.2">1</cn></list></apply><apply id="S4.SS3.p6.1.m1.13.13.5.5.5.cmml" xref="S4.SS3.p6.1.m1.13.13.5.5.5"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.13.13.5.5.5.1.cmml" xref="S4.SS3.p6.1.m1.13.13.5.5.5">subscript</csymbol><ci id="S4.SS3.p6.1.m1.13.13.5.5.5.2.cmml" xref="S4.SS3.p6.1.m1.13.13.5.5.5.2">𝛽</ci><cn type="integer" id="S4.SS3.p6.1.m1.13.13.5.5.5.3.cmml" xref="S4.SS3.p6.1.m1.13.13.5.5.5.3">0</cn></apply><apply id="S4.SS3.p6.1.m1.14.14.6.6.6.cmml" xref="S4.SS3.p6.1.m1.14.14.6.6.6"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.14.14.6.6.6.1.cmml" xref="S4.SS3.p6.1.m1.14.14.6.6.6">subscript</csymbol><ci id="S4.SS3.p6.1.m1.14.14.6.6.6.2.cmml" xref="S4.SS3.p6.1.m1.14.14.6.6.6.2">𝛽</ci><cn type="integer" id="S4.SS3.p6.1.m1.14.14.6.6.6.3.cmml" xref="S4.SS3.p6.1.m1.14.14.6.6.6.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.14c">\psi=\{\alpha_{0,0},\alpha_{0,1},\alpha_{1,0},\alpha_{1,1},\beta_{0},\beta_{1}\}</annotation></semantics></math>; for soft attention or hard selection, we have <math id="S4.SS3.p6.2.m2.4" class="ltx_Math" alttext="\psi=\{\alpha_{0},\alpha_{1},\beta_{0},\beta_{1}\}" display="inline"><semantics id="S4.SS3.p6.2.m2.4a"><mrow id="S4.SS3.p6.2.m2.4.4" xref="S4.SS3.p6.2.m2.4.4.cmml"><mi id="S4.SS3.p6.2.m2.4.4.6" xref="S4.SS3.p6.2.m2.4.4.6.cmml">ψ</mi><mo id="S4.SS3.p6.2.m2.4.4.5" xref="S4.SS3.p6.2.m2.4.4.5.cmml">=</mo><mrow id="S4.SS3.p6.2.m2.4.4.4.4" xref="S4.SS3.p6.2.m2.4.4.4.5.cmml"><mo stretchy="false" id="S4.SS3.p6.2.m2.4.4.4.4.5" xref="S4.SS3.p6.2.m2.4.4.4.5.cmml">{</mo><msub id="S4.SS3.p6.2.m2.1.1.1.1.1" xref="S4.SS3.p6.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS3.p6.2.m2.1.1.1.1.1.2" xref="S4.SS3.p6.2.m2.1.1.1.1.1.2.cmml">α</mi><mn id="S4.SS3.p6.2.m2.1.1.1.1.1.3" xref="S4.SS3.p6.2.m2.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS3.p6.2.m2.4.4.4.4.6" xref="S4.SS3.p6.2.m2.4.4.4.5.cmml">,</mo><msub id="S4.SS3.p6.2.m2.2.2.2.2.2" xref="S4.SS3.p6.2.m2.2.2.2.2.2.cmml"><mi id="S4.SS3.p6.2.m2.2.2.2.2.2.2" xref="S4.SS3.p6.2.m2.2.2.2.2.2.2.cmml">α</mi><mn id="S4.SS3.p6.2.m2.2.2.2.2.2.3" xref="S4.SS3.p6.2.m2.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S4.SS3.p6.2.m2.4.4.4.4.7" xref="S4.SS3.p6.2.m2.4.4.4.5.cmml">,</mo><msub id="S4.SS3.p6.2.m2.3.3.3.3.3" xref="S4.SS3.p6.2.m2.3.3.3.3.3.cmml"><mi id="S4.SS3.p6.2.m2.3.3.3.3.3.2" xref="S4.SS3.p6.2.m2.3.3.3.3.3.2.cmml">β</mi><mn id="S4.SS3.p6.2.m2.3.3.3.3.3.3" xref="S4.SS3.p6.2.m2.3.3.3.3.3.3.cmml">0</mn></msub><mo id="S4.SS3.p6.2.m2.4.4.4.4.8" xref="S4.SS3.p6.2.m2.4.4.4.5.cmml">,</mo><msub id="S4.SS3.p6.2.m2.4.4.4.4.4" xref="S4.SS3.p6.2.m2.4.4.4.4.4.cmml"><mi id="S4.SS3.p6.2.m2.4.4.4.4.4.2" xref="S4.SS3.p6.2.m2.4.4.4.4.4.2.cmml">β</mi><mn id="S4.SS3.p6.2.m2.4.4.4.4.4.3" xref="S4.SS3.p6.2.m2.4.4.4.4.4.3.cmml">1</mn></msub><mo stretchy="false" id="S4.SS3.p6.2.m2.4.4.4.4.9" xref="S4.SS3.p6.2.m2.4.4.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.4b"><apply id="S4.SS3.p6.2.m2.4.4.cmml" xref="S4.SS3.p6.2.m2.4.4"><eq id="S4.SS3.p6.2.m2.4.4.5.cmml" xref="S4.SS3.p6.2.m2.4.4.5"></eq><ci id="S4.SS3.p6.2.m2.4.4.6.cmml" xref="S4.SS3.p6.2.m2.4.4.6">𝜓</ci><set id="S4.SS3.p6.2.m2.4.4.4.5.cmml" xref="S4.SS3.p6.2.m2.4.4.4.4"><apply id="S4.SS3.p6.2.m2.1.1.1.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p6.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.p6.2.m2.1.1.1.1.1.2">𝛼</ci><cn type="integer" id="S4.SS3.p6.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.p6.2.m2.1.1.1.1.1.3">0</cn></apply><apply id="S4.SS3.p6.2.m2.2.2.2.2.2.cmml" xref="S4.SS3.p6.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.2.2.2.2.2.1.cmml" xref="S4.SS3.p6.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p6.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS3.p6.2.m2.2.2.2.2.2.2">𝛼</ci><cn type="integer" id="S4.SS3.p6.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS3.p6.2.m2.2.2.2.2.2.3">1</cn></apply><apply id="S4.SS3.p6.2.m2.3.3.3.3.3.cmml" xref="S4.SS3.p6.2.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.3.3.3.3.3.1.cmml" xref="S4.SS3.p6.2.m2.3.3.3.3.3">subscript</csymbol><ci id="S4.SS3.p6.2.m2.3.3.3.3.3.2.cmml" xref="S4.SS3.p6.2.m2.3.3.3.3.3.2">𝛽</ci><cn type="integer" id="S4.SS3.p6.2.m2.3.3.3.3.3.3.cmml" xref="S4.SS3.p6.2.m2.3.3.3.3.3.3">0</cn></apply><apply id="S4.SS3.p6.2.m2.4.4.4.4.4.cmml" xref="S4.SS3.p6.2.m2.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.4.4.4.4.4.1.cmml" xref="S4.SS3.p6.2.m2.4.4.4.4.4">subscript</csymbol><ci id="S4.SS3.p6.2.m2.4.4.4.4.4.2.cmml" xref="S4.SS3.p6.2.m2.4.4.4.4.4.2">𝛽</ci><cn type="integer" id="S4.SS3.p6.2.m2.4.4.4.4.4.3.cmml" xref="S4.SS3.p6.2.m2.4.4.4.4.4.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.4c">\psi=\{\alpha_{0},\alpha_{1},\beta_{0},\beta_{1}\}</annotation></semantics></math>. These parameters will be end-to-end updated in local training and will also be aggregated during the global procedure. The three algorithms are named as AutoCS, AutoSA, and AutoHS respectively, whose pseudo codes can be found in Algo. <a href="#alg1" title="Algorithm 1 ‣ 3.3. Issues to Explore ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The <math id="S4.SS3.p6.3.m3.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS3.p6.3.m3.1a"><mi id="S4.SS3.p6.3.m3.1.1" xref="S4.SS3.p6.3.m3.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.3.m3.1b"><ci id="S4.SS3.p6.3.m3.1.1.cmml" xref="S4.SS3.p6.3.m3.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.3.m3.1c">\psi</annotation></semantics></math> to be learned and the architectures are shown in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.2. Experimental Procedures ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span><span id="S4.T1.10.5" class="ltx_text" style="font-size:90%;">Statistical information of the investigated benchmarks: the number of clients <math id="S4.T1.6.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T1.6.1.m1.1b"><mi id="S4.T1.6.1.m1.1.1" xref="S4.T1.6.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.1.m1.1c"><ci id="S4.T1.6.1.m1.1.1.cmml" xref="S4.T1.6.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.1.m1.1d">K</annotation></semantics></math>, the total number of classes <math id="S4.T1.7.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.7.2.m2.1b"><mi id="S4.T1.7.2.m2.1.1" xref="S4.T1.7.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.7.2.m2.1c"><ci id="S4.T1.7.2.m2.1.1.cmml" xref="S4.T1.7.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.2.m2.1d">C</annotation></semantics></math>, the number of training samples on each client on average <math id="S4.T1.8.3.m3.1" class="ltx_Math" alttext="\overline{{N^{k}_{\text{tr}}}}" display="inline"><semantics id="S4.T1.8.3.m3.1b"><mover accent="true" id="S4.T1.8.3.m3.1.1" xref="S4.T1.8.3.m3.1.1.cmml"><msubsup id="S4.T1.8.3.m3.1.1.2" xref="S4.T1.8.3.m3.1.1.2.cmml"><mi id="S4.T1.8.3.m3.1.1.2.2.2" xref="S4.T1.8.3.m3.1.1.2.2.2.cmml">N</mi><mtext id="S4.T1.8.3.m3.1.1.2.3" xref="S4.T1.8.3.m3.1.1.2.3a.cmml">tr</mtext><mi id="S4.T1.8.3.m3.1.1.2.2.3" xref="S4.T1.8.3.m3.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S4.T1.8.3.m3.1.1.1" xref="S4.T1.8.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.8.3.m3.1c"><apply id="S4.T1.8.3.m3.1.1.cmml" xref="S4.T1.8.3.m3.1.1"><ci id="S4.T1.8.3.m3.1.1.1.cmml" xref="S4.T1.8.3.m3.1.1.1">¯</ci><apply id="S4.T1.8.3.m3.1.1.2.cmml" xref="S4.T1.8.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.T1.8.3.m3.1.1.2.1.cmml" xref="S4.T1.8.3.m3.1.1.2">subscript</csymbol><apply id="S4.T1.8.3.m3.1.1.2.2.cmml" xref="S4.T1.8.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.T1.8.3.m3.1.1.2.2.1.cmml" xref="S4.T1.8.3.m3.1.1.2">superscript</csymbol><ci id="S4.T1.8.3.m3.1.1.2.2.2.cmml" xref="S4.T1.8.3.m3.1.1.2.2.2">𝑁</ci><ci id="S4.T1.8.3.m3.1.1.2.2.3.cmml" xref="S4.T1.8.3.m3.1.1.2.2.3">𝑘</ci></apply><ci id="S4.T1.8.3.m3.1.1.2.3a.cmml" xref="S4.T1.8.3.m3.1.1.2.3"><mtext mathsize="70%" id="S4.T1.8.3.m3.1.1.2.3.cmml" xref="S4.T1.8.3.m3.1.1.2.3">tr</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.3.m3.1d">\overline{{N^{k}_{\text{tr}}}}</annotation></semantics></math>, the number of test samples on each client on average <math id="S4.T1.9.4.m4.1" class="ltx_Math" alttext="\overline{{N^{k}_{\text{te}}}}" display="inline"><semantics id="S4.T1.9.4.m4.1b"><mover accent="true" id="S4.T1.9.4.m4.1.1" xref="S4.T1.9.4.m4.1.1.cmml"><msubsup id="S4.T1.9.4.m4.1.1.2" xref="S4.T1.9.4.m4.1.1.2.cmml"><mi id="S4.T1.9.4.m4.1.1.2.2.2" xref="S4.T1.9.4.m4.1.1.2.2.2.cmml">N</mi><mtext id="S4.T1.9.4.m4.1.1.2.3" xref="S4.T1.9.4.m4.1.1.2.3a.cmml">te</mtext><mi id="S4.T1.9.4.m4.1.1.2.2.3" xref="S4.T1.9.4.m4.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S4.T1.9.4.m4.1.1.1" xref="S4.T1.9.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.9.4.m4.1c"><apply id="S4.T1.9.4.m4.1.1.cmml" xref="S4.T1.9.4.m4.1.1"><ci id="S4.T1.9.4.m4.1.1.1.cmml" xref="S4.T1.9.4.m4.1.1.1">¯</ci><apply id="S4.T1.9.4.m4.1.1.2.cmml" xref="S4.T1.9.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.T1.9.4.m4.1.1.2.1.cmml" xref="S4.T1.9.4.m4.1.1.2">subscript</csymbol><apply id="S4.T1.9.4.m4.1.1.2.2.cmml" xref="S4.T1.9.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.T1.9.4.m4.1.1.2.2.1.cmml" xref="S4.T1.9.4.m4.1.1.2">superscript</csymbol><ci id="S4.T1.9.4.m4.1.1.2.2.2.cmml" xref="S4.T1.9.4.m4.1.1.2.2.2">𝑁</ci><ci id="S4.T1.9.4.m4.1.1.2.2.3.cmml" xref="S4.T1.9.4.m4.1.1.2.2.3">𝑘</ci></apply><ci id="S4.T1.9.4.m4.1.1.2.3a.cmml" xref="S4.T1.9.4.m4.1.1.2.3"><mtext mathsize="70%" id="S4.T1.9.4.m4.1.1.2.3.cmml" xref="S4.T1.9.4.m4.1.1.2.3">te</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.4.m4.1d">\overline{{N^{k}_{\text{te}}}}</annotation></semantics></math>, and the number of global test samples <math id="S4.T1.10.5.m5.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.T1.10.5.m5.1b"><mi id="S4.T1.10.5.m5.1.1" xref="S4.T1.10.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.T1.10.5.m5.1c"><ci id="S4.T1.10.5.m5.1.1.cmml" xref="S4.T1.10.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.5.m5.1d">M</annotation></semantics></math>.</span></figcaption>
<table id="S4.T1.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.20.10" class="ltx_tr">
<th id="S4.T1.20.10.11" class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_tt"></th>
<th id="S4.T1.11.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S4.T1.11.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T1.11.1.1.m1.1a"><mi id="S4.T1.11.1.1.m1.1.1" xref="S4.T1.11.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T1.11.1.1.m1.1b"><ci id="S4.T1.11.1.1.m1.1.1.cmml" xref="S4.T1.11.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.1.1.m1.1c">K</annotation></semantics></math></th>
<th id="S4.T1.12.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S4.T1.12.2.2.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.12.2.2.m1.1a"><mi id="S4.T1.12.2.2.m1.1.1" xref="S4.T1.12.2.2.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.12.2.2.m1.1b"><ci id="S4.T1.12.2.2.m1.1.1.cmml" xref="S4.T1.12.2.2.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.2.2.m1.1c">C</annotation></semantics></math></th>
<th id="S4.T1.13.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S4.T1.13.3.3.m1.1" class="ltx_Math" alttext="\overline{{N^{k}_{\text{tr}}}}" display="inline"><semantics id="S4.T1.13.3.3.m1.1a"><mover accent="true" id="S4.T1.13.3.3.m1.1.1" xref="S4.T1.13.3.3.m1.1.1.cmml"><msubsup id="S4.T1.13.3.3.m1.1.1.2" xref="S4.T1.13.3.3.m1.1.1.2.cmml"><mi id="S4.T1.13.3.3.m1.1.1.2.2.2" xref="S4.T1.13.3.3.m1.1.1.2.2.2.cmml">N</mi><mtext id="S4.T1.13.3.3.m1.1.1.2.3" xref="S4.T1.13.3.3.m1.1.1.2.3a.cmml">tr</mtext><mi id="S4.T1.13.3.3.m1.1.1.2.2.3" xref="S4.T1.13.3.3.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S4.T1.13.3.3.m1.1.1.1" xref="S4.T1.13.3.3.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.13.3.3.m1.1b"><apply id="S4.T1.13.3.3.m1.1.1.cmml" xref="S4.T1.13.3.3.m1.1.1"><ci id="S4.T1.13.3.3.m1.1.1.1.cmml" xref="S4.T1.13.3.3.m1.1.1.1">¯</ci><apply id="S4.T1.13.3.3.m1.1.1.2.cmml" xref="S4.T1.13.3.3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.13.3.3.m1.1.1.2.1.cmml" xref="S4.T1.13.3.3.m1.1.1.2">subscript</csymbol><apply id="S4.T1.13.3.3.m1.1.1.2.2.cmml" xref="S4.T1.13.3.3.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.13.3.3.m1.1.1.2.2.1.cmml" xref="S4.T1.13.3.3.m1.1.1.2">superscript</csymbol><ci id="S4.T1.13.3.3.m1.1.1.2.2.2.cmml" xref="S4.T1.13.3.3.m1.1.1.2.2.2">𝑁</ci><ci id="S4.T1.13.3.3.m1.1.1.2.2.3.cmml" xref="S4.T1.13.3.3.m1.1.1.2.2.3">𝑘</ci></apply><ci id="S4.T1.13.3.3.m1.1.1.2.3a.cmml" xref="S4.T1.13.3.3.m1.1.1.2.3"><mtext mathsize="70%" id="S4.T1.13.3.3.m1.1.1.2.3.cmml" xref="S4.T1.13.3.3.m1.1.1.2.3">tr</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.3.3.m1.1c">\overline{{N^{k}_{\text{tr}}}}</annotation></semantics></math></th>
<th id="S4.T1.14.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S4.T1.14.4.4.m1.1" class="ltx_Math" alttext="\overline{{N^{k}_{\text{te}}}}" display="inline"><semantics id="S4.T1.14.4.4.m1.1a"><mover accent="true" id="S4.T1.14.4.4.m1.1.1" xref="S4.T1.14.4.4.m1.1.1.cmml"><msubsup id="S4.T1.14.4.4.m1.1.1.2" xref="S4.T1.14.4.4.m1.1.1.2.cmml"><mi id="S4.T1.14.4.4.m1.1.1.2.2.2" xref="S4.T1.14.4.4.m1.1.1.2.2.2.cmml">N</mi><mtext id="S4.T1.14.4.4.m1.1.1.2.3" xref="S4.T1.14.4.4.m1.1.1.2.3a.cmml">te</mtext><mi id="S4.T1.14.4.4.m1.1.1.2.2.3" xref="S4.T1.14.4.4.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S4.T1.14.4.4.m1.1.1.1" xref="S4.T1.14.4.4.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.14.4.4.m1.1b"><apply id="S4.T1.14.4.4.m1.1.1.cmml" xref="S4.T1.14.4.4.m1.1.1"><ci id="S4.T1.14.4.4.m1.1.1.1.cmml" xref="S4.T1.14.4.4.m1.1.1.1">¯</ci><apply id="S4.T1.14.4.4.m1.1.1.2.cmml" xref="S4.T1.14.4.4.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.14.4.4.m1.1.1.2.1.cmml" xref="S4.T1.14.4.4.m1.1.1.2">subscript</csymbol><apply id="S4.T1.14.4.4.m1.1.1.2.2.cmml" xref="S4.T1.14.4.4.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.14.4.4.m1.1.1.2.2.1.cmml" xref="S4.T1.14.4.4.m1.1.1.2">superscript</csymbol><ci id="S4.T1.14.4.4.m1.1.1.2.2.2.cmml" xref="S4.T1.14.4.4.m1.1.1.2.2.2">𝑁</ci><ci id="S4.T1.14.4.4.m1.1.1.2.2.3.cmml" xref="S4.T1.14.4.4.m1.1.1.2.2.3">𝑘</ci></apply><ci id="S4.T1.14.4.4.m1.1.1.2.3a.cmml" xref="S4.T1.14.4.4.m1.1.1.2.3"><mtext mathsize="70%" id="S4.T1.14.4.4.m1.1.1.2.3.cmml" xref="S4.T1.14.4.4.m1.1.1.2.3">te</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.4.4.m1.1c">\overline{{N^{k}_{\text{te}}}}</annotation></semantics></math></th>
<th id="S4.T1.15.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_rr ltx_border_tt"><math id="S4.T1.15.5.5.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.T1.15.5.5.m1.1a"><mi id="S4.T1.15.5.5.m1.1.1" xref="S4.T1.15.5.5.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.T1.15.5.5.m1.1b"><ci id="S4.T1.15.5.5.m1.1.1.cmml" xref="S4.T1.15.5.5.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.5.5.m1.1c">M</annotation></semantics></math></th>
<th id="S4.T1.20.10.12" class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_tt"></th>
<th id="S4.T1.16.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S4.T1.16.6.6.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T1.16.6.6.m1.1a"><mi id="S4.T1.16.6.6.m1.1.1" xref="S4.T1.16.6.6.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T1.16.6.6.m1.1b"><ci id="S4.T1.16.6.6.m1.1.1.cmml" xref="S4.T1.16.6.6.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.6.6.m1.1c">K</annotation></semantics></math></th>
<th id="S4.T1.17.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S4.T1.17.7.7.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.T1.17.7.7.m1.1a"><mi id="S4.T1.17.7.7.m1.1.1" xref="S4.T1.17.7.7.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.T1.17.7.7.m1.1b"><ci id="S4.T1.17.7.7.m1.1.1.cmml" xref="S4.T1.17.7.7.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.7.7.m1.1c">C</annotation></semantics></math></th>
<th id="S4.T1.18.8.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S4.T1.18.8.8.m1.1" class="ltx_Math" alttext="\overline{{N^{k}_{\text{tr}}}}" display="inline"><semantics id="S4.T1.18.8.8.m1.1a"><mover accent="true" id="S4.T1.18.8.8.m1.1.1" xref="S4.T1.18.8.8.m1.1.1.cmml"><msubsup id="S4.T1.18.8.8.m1.1.1.2" xref="S4.T1.18.8.8.m1.1.1.2.cmml"><mi id="S4.T1.18.8.8.m1.1.1.2.2.2" xref="S4.T1.18.8.8.m1.1.1.2.2.2.cmml">N</mi><mtext id="S4.T1.18.8.8.m1.1.1.2.3" xref="S4.T1.18.8.8.m1.1.1.2.3a.cmml">tr</mtext><mi id="S4.T1.18.8.8.m1.1.1.2.2.3" xref="S4.T1.18.8.8.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S4.T1.18.8.8.m1.1.1.1" xref="S4.T1.18.8.8.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.18.8.8.m1.1b"><apply id="S4.T1.18.8.8.m1.1.1.cmml" xref="S4.T1.18.8.8.m1.1.1"><ci id="S4.T1.18.8.8.m1.1.1.1.cmml" xref="S4.T1.18.8.8.m1.1.1.1">¯</ci><apply id="S4.T1.18.8.8.m1.1.1.2.cmml" xref="S4.T1.18.8.8.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.18.8.8.m1.1.1.2.1.cmml" xref="S4.T1.18.8.8.m1.1.1.2">subscript</csymbol><apply id="S4.T1.18.8.8.m1.1.1.2.2.cmml" xref="S4.T1.18.8.8.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.18.8.8.m1.1.1.2.2.1.cmml" xref="S4.T1.18.8.8.m1.1.1.2">superscript</csymbol><ci id="S4.T1.18.8.8.m1.1.1.2.2.2.cmml" xref="S4.T1.18.8.8.m1.1.1.2.2.2">𝑁</ci><ci id="S4.T1.18.8.8.m1.1.1.2.2.3.cmml" xref="S4.T1.18.8.8.m1.1.1.2.2.3">𝑘</ci></apply><ci id="S4.T1.18.8.8.m1.1.1.2.3a.cmml" xref="S4.T1.18.8.8.m1.1.1.2.3"><mtext mathsize="70%" id="S4.T1.18.8.8.m1.1.1.2.3.cmml" xref="S4.T1.18.8.8.m1.1.1.2.3">tr</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.8.8.m1.1c">\overline{{N^{k}_{\text{tr}}}}</annotation></semantics></math></th>
<th id="S4.T1.19.9.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><math id="S4.T1.19.9.9.m1.1" class="ltx_Math" alttext="\overline{{N^{k}_{\text{te}}}}" display="inline"><semantics id="S4.T1.19.9.9.m1.1a"><mover accent="true" id="S4.T1.19.9.9.m1.1.1" xref="S4.T1.19.9.9.m1.1.1.cmml"><msubsup id="S4.T1.19.9.9.m1.1.1.2" xref="S4.T1.19.9.9.m1.1.1.2.cmml"><mi id="S4.T1.19.9.9.m1.1.1.2.2.2" xref="S4.T1.19.9.9.m1.1.1.2.2.2.cmml">N</mi><mtext id="S4.T1.19.9.9.m1.1.1.2.3" xref="S4.T1.19.9.9.m1.1.1.2.3a.cmml">te</mtext><mi id="S4.T1.19.9.9.m1.1.1.2.2.3" xref="S4.T1.19.9.9.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S4.T1.19.9.9.m1.1.1.1" xref="S4.T1.19.9.9.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.19.9.9.m1.1b"><apply id="S4.T1.19.9.9.m1.1.1.cmml" xref="S4.T1.19.9.9.m1.1.1"><ci id="S4.T1.19.9.9.m1.1.1.1.cmml" xref="S4.T1.19.9.9.m1.1.1.1">¯</ci><apply id="S4.T1.19.9.9.m1.1.1.2.cmml" xref="S4.T1.19.9.9.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.19.9.9.m1.1.1.2.1.cmml" xref="S4.T1.19.9.9.m1.1.1.2">subscript</csymbol><apply id="S4.T1.19.9.9.m1.1.1.2.2.cmml" xref="S4.T1.19.9.9.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.19.9.9.m1.1.1.2.2.1.cmml" xref="S4.T1.19.9.9.m1.1.1.2">superscript</csymbol><ci id="S4.T1.19.9.9.m1.1.1.2.2.2.cmml" xref="S4.T1.19.9.9.m1.1.1.2.2.2">𝑁</ci><ci id="S4.T1.19.9.9.m1.1.1.2.2.3.cmml" xref="S4.T1.19.9.9.m1.1.1.2.2.3">𝑘</ci></apply><ci id="S4.T1.19.9.9.m1.1.1.2.3a.cmml" xref="S4.T1.19.9.9.m1.1.1.2.3"><mtext mathsize="70%" id="S4.T1.19.9.9.m1.1.1.2.3.cmml" xref="S4.T1.19.9.9.m1.1.1.2.3">te</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.9.9.m1.1c">\overline{{N^{k}_{\text{te}}}}</annotation></semantics></math></th>
<th id="S4.T1.20.10.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S4.T1.20.10.10.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.T1.20.10.10.m1.1a"><mi id="S4.T1.20.10.10.m1.1.1" xref="S4.T1.20.10.10.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.T1.20.10.10.m1.1b"><ci id="S4.T1.20.10.10.m1.1.1.cmml" xref="S4.T1.20.10.10.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.10.10.m1.1c">M</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.20.11.1" class="ltx_tr">
<td id="S4.T1.20.11.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">FeCifar10</td>
<td id="S4.T1.20.11.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">100</td>
<td id="S4.T1.20.11.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">10</td>
<td id="S4.T1.20.11.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">400</td>
<td id="S4.T1.20.11.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">100</td>
<td id="S4.T1.20.11.1.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt">10k</td>
<td id="S4.T1.20.11.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">FeCifar100</td>
<td id="S4.T1.20.11.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">100</td>
<td id="S4.T1.20.11.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">100</td>
<td id="S4.T1.20.11.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">400</td>
<td id="S4.T1.20.11.1.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">100</td>
<td id="S4.T1.20.11.1.12" class="ltx_td ltx_align_center ltx_border_tt">10k</td>
</tr>
<tr id="S4.T1.20.12.2" class="ltx_tr">
<td id="S4.T1.20.12.2.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t">Shakespeare</td>
<td id="S4.T1.20.12.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">1129</td>
<td id="S4.T1.20.12.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">81</td>
<td id="S4.T1.20.12.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">2994</td>
<td id="S4.T1.20.12.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">749</td>
<td id="S4.T1.20.12.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_rr ltx_border_t">845k</td>
<td id="S4.T1.20.12.2.7" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t">FeMnist</td>
<td id="S4.T1.20.12.2.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">3550</td>
<td id="S4.T1.20.12.2.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">62</td>
<td id="S4.T1.20.12.2.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">181</td>
<td id="S4.T1.20.12.2.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">45</td>
<td id="S4.T1.20.12.2.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">161k</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F3.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x3.png" id="S4.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="81" alt="Refer to caption">
<p id="S4.F3.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S4.F3.1.1.1" class="ltx_text">(a) FeCifar10</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F3.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x4.png" id="S4.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="186" alt="Refer to caption">
<p id="S4.F3.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S4.F3.2.1.1" class="ltx_text">(b) FeCifar100</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F3.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x5.png" id="S4.F3.3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="166" alt="Refer to caption">
<p id="S4.F3.3.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S4.F3.3.1.1" class="ltx_text">(c) Shakespeare</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F3.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x6.png" id="S4.F3.4.g1" class="ltx_graphics ltx_img_landscape" width="461" height="143" alt="Refer to caption">
<p id="S4.F3.4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S4.F3.4.1.1" class="ltx_text">(d) FeMnist</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span><span id="S4.F3.6.1" class="ltx_text" style="font-size:90%;">Distributions of the investigated FL benchmarks. Every figure shows one benchmark. In each figure, the middle heatmap shows the label distributions of 100 clients; the top histogram plots the numbers of samples in each client; the right histogram shows the number of samples in each class.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experimental Studies</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we will detail our experimental studies. We first introduce the utilized four benchmarks and their statistics. Then, we will present the utilized networks for these benchmarks. Finally, we will report the detailed experimental results.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Benchmarks</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.2" class="ltx_p">We select several FL benchmarks. In order to represent both covariate shift and label shift non-iid scenes <cite class="ltx_cite ltx_citemacro_citep">(Kairouz
et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>, we use FeCifar10, FeCifar100, Shakespeare, and FeMnist. The FeCifar10 and FeCifar100 are constructed by splitting cifar10 and cifar100 dataset <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky, <a href="#bib.bib28" title="" class="ltx_ref">2012</a>)</cite> according to labels. Specifically, for FeCifar10, we split the training samples of each class in cifar10 into 50 shards and obtain <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="10\times 50=500" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mrow id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2.2" xref="S5.SS1.p1.1.m1.1.1.2.2.cmml">10</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p1.1.m1.1.1.2.1" xref="S5.SS1.p1.1.m1.1.1.2.1.cmml">×</mo><mn id="S5.SS1.p1.1.m1.1.1.2.3" xref="S5.SS1.p1.1.m1.1.1.2.3.cmml">50</mn></mrow><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><eq id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></eq><apply id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2"><times id="S5.SS1.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.p1.1.m1.1.1.2.1"></times><cn type="integer" id="S5.SS1.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2.2">10</cn><cn type="integer" id="S5.SS1.p1.1.m1.1.1.2.3.cmml" xref="S5.SS1.p1.1.m1.1.1.2.3">50</cn></apply><cn type="integer" id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">10\times 50=500</annotation></semantics></math> shards in all, then we class-wisely allocate 5 shards to each client and each client could access 5 different classes. For FeCifar100, we split the training samples of each class in cifar100 into 20 shards and obtain <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="100\times 20=2000" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mrow id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2.2" xref="S5.SS1.p1.2.m2.1.1.2.2.cmml">100</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p1.2.m2.1.1.2.1" xref="S5.SS1.p1.2.m2.1.1.2.1.cmml">×</mo><mn id="S5.SS1.p1.2.m2.1.1.2.3" xref="S5.SS1.p1.2.m2.1.1.2.3.cmml">20</mn></mrow><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">2000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><eq id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></eq><apply id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2"><times id="S5.SS1.p1.2.m2.1.1.2.1.cmml" xref="S5.SS1.p1.2.m2.1.1.2.1"></times><cn type="integer" id="S5.SS1.p1.2.m2.1.1.2.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2.2">100</cn><cn type="integer" id="S5.SS1.p1.2.m2.1.1.2.3.cmml" xref="S5.SS1.p1.2.m2.1.1.2.3">20</cn></apply><cn type="integer" id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">2000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">100\times 20=2000</annotation></semantics></math> shards in all. We class-wisely allocate 20 shards to each client and each client could access 20 different classes. That is, we have 100 clients in both FeCifar10 and FeCifar100. This way of decentralization is mainly based on the label distribution, and we advocate these two scenes are more inclined to be label distribution shift non-iid scenes. Such partitions can also be found in previous works <cite class="ltx_cite ltx_citemacro_citep">(Zhao
et al<span class="ltx_text">.</span>, <a href="#bib.bib67" title="" class="ltx_ref">2018</a>; Li and Wang, <a href="#bib.bib31" title="" class="ltx_ref">2019</a>)</cite>. Shakespeare and FeMnist are benchmarks recommended by LEAF <cite class="ltx_cite ltx_citemacro_citep">(Caldas et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>. Shakespeare is a dataset built from the Complete Works of William Shakespeare, which is originally used in FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>. It is constructed by viewing each speaking role in each play as a different device, and the target is to predict the next character based on the previous characters. FeMnist is a task to classify the mixture of digits and characters, where data from each writer is considered as a client. Different speakers or writers may behave distinctly with various semantics and styles. Hence, we view these two scenes as covariate shift non-iid ones, where the heterogeneity is mainly caused by different play roles or users.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.6" class="ltx_p">For FeCifar10 and FeCifar100, we split the local data into 80% and 20% as local train set and local test set respectively, and use the original test set in cifar10 and cifar100 as the global test set. For Shakespeare and FeMnist, we split local data into 80% and 20% as local train set and local test set respectively, while we take the combination of all local test sets as the global test set. We reshape the images in FeMnist to <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="28\times 28" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mrow id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><mn id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p2.1.m1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><times id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1"></times><cn type="integer" id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2">28</cn><cn type="integer" id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">28\times 28</annotation></semantics></math>. We list the details of the benchmarks from several aspects in Tab. <a href="#S4.T1" title="Table 1 ‣ 4.3. Automatically Learn to Aggregate ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>: the number of clients <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">K</annotation></semantics></math>, the total number of classes <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mi id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><ci id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">C</annotation></semantics></math>, the number of training samples on each client on average <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="\overline{{N^{k}_{\text{tr}}}}" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mover accent="true" id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><msubsup id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml"><mi id="S5.SS1.p2.4.m4.1.1.2.2.2" xref="S5.SS1.p2.4.m4.1.1.2.2.2.cmml">N</mi><mtext id="S5.SS1.p2.4.m4.1.1.2.3" xref="S5.SS1.p2.4.m4.1.1.2.3a.cmml">tr</mtext><mi id="S5.SS1.p2.4.m4.1.1.2.2.3" xref="S5.SS1.p2.4.m4.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S5.SS1.p2.4.m4.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><ci id="S5.SS1.p2.4.m4.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1">¯</ci><apply id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.2.1.cmml" xref="S5.SS1.p2.4.m4.1.1.2">subscript</csymbol><apply id="S5.SS1.p2.4.m4.1.1.2.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.2.2.1.cmml" xref="S5.SS1.p2.4.m4.1.1.2">superscript</csymbol><ci id="S5.SS1.p2.4.m4.1.1.2.2.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2.2.2">𝑁</ci><ci id="S5.SS1.p2.4.m4.1.1.2.2.3.cmml" xref="S5.SS1.p2.4.m4.1.1.2.2.3">𝑘</ci></apply><ci id="S5.SS1.p2.4.m4.1.1.2.3a.cmml" xref="S5.SS1.p2.4.m4.1.1.2.3"><mtext mathsize="70%" id="S5.SS1.p2.4.m4.1.1.2.3.cmml" xref="S5.SS1.p2.4.m4.1.1.2.3">tr</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">\overline{{N^{k}_{\text{tr}}}}</annotation></semantics></math>, the number of test samples on each client on average <math id="S5.SS1.p2.5.m5.1" class="ltx_Math" alttext="\overline{{N^{k}_{\text{te}}}}" display="inline"><semantics id="S5.SS1.p2.5.m5.1a"><mover accent="true" id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml"><msubsup id="S5.SS1.p2.5.m5.1.1.2" xref="S5.SS1.p2.5.m5.1.1.2.cmml"><mi id="S5.SS1.p2.5.m5.1.1.2.2.2" xref="S5.SS1.p2.5.m5.1.1.2.2.2.cmml">N</mi><mtext id="S5.SS1.p2.5.m5.1.1.2.3" xref="S5.SS1.p2.5.m5.1.1.2.3a.cmml">te</mtext><mi id="S5.SS1.p2.5.m5.1.1.2.2.3" xref="S5.SS1.p2.5.m5.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S5.SS1.p2.5.m5.1.1.1" xref="S5.SS1.p2.5.m5.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b"><apply id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1"><ci id="S5.SS1.p2.5.m5.1.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1.1">¯</ci><apply id="S5.SS1.p2.5.m5.1.1.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m5.1.1.2.1.cmml" xref="S5.SS1.p2.5.m5.1.1.2">subscript</csymbol><apply id="S5.SS1.p2.5.m5.1.1.2.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m5.1.1.2.2.1.cmml" xref="S5.SS1.p2.5.m5.1.1.2">superscript</csymbol><ci id="S5.SS1.p2.5.m5.1.1.2.2.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2.2.2">𝑁</ci><ci id="S5.SS1.p2.5.m5.1.1.2.2.3.cmml" xref="S5.SS1.p2.5.m5.1.1.2.2.3">𝑘</ci></apply><ci id="S5.SS1.p2.5.m5.1.1.2.3a.cmml" xref="S5.SS1.p2.5.m5.1.1.2.3"><mtext mathsize="70%" id="S5.SS1.p2.5.m5.1.1.2.3.cmml" xref="S5.SS1.p2.5.m5.1.1.2.3">te</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">\overline{{N^{k}_{\text{te}}}}</annotation></semantics></math>, and the number of global test samples <math id="S5.SS1.p2.6.m6.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S5.SS1.p2.6.m6.1a"><mi id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><ci id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">M</annotation></semantics></math>.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">For a deeper understanding of these scenes, we plot the distributions of some clients in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.3. Automatically Learn to Aggregate ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. FeCifar10 and FeCifar100 are artificially constructed label shift non-iid scenes, where each client could only access a subset of classes, and the label distributions among clients differ a lot. Although some classes are missing for a specific client, the observed classes are uniformly distributed. Additionally, the samples are uniformly distributed across clients and classes. Shakespeare and FeMnist also experience a certain level of label shift, while the label distributions among clients do not diverge too much and are almost consistent with the global label distribution. Compared with FeCifar10 and FeCifar100, Shakespeare and FeMnist have another two challenges, i.e., the imbalance of the sample numbers across clients and classes. For example, some clients in Shakespeare could have more than 20,000 training samples, and the first 10 classes (i.e., digits) in FeMnist dominate most of the samples. However, we do not additionally solve these problems in this paper. We only suggest that some corresponding solutions (e.g., FL with imbalance learning techniques <cite class="ltx_cite ltx_citemacro_citep">(Wang
et al<span class="ltx_text">.</span>, <a href="#bib.bib55" title="" class="ltx_ref">2020</a>)</cite>) can be adopted to improve performance.</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2107.11954/assets/x7.png" id="S5.F4.g1" class="ltx_graphics ltx_img_landscape" width="461" height="156" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span><span id="S5.F4.2.1" class="ltx_text" style="font-size:90%;">Illustrations of the utilized networks and corresponding network splits. The left two columns show the coarse-grained network splits of CharLSTM (for Shakespeare), FeMnistNet (for FeMnist), and VGG11 (for FeCifar10 and FeCifar100). The right shows the fine-grained network splits of VGG11. The three numbers in “Conv()” denote the input channel, output channel, and kernel size, respectively; the “MaxPool()” has a default kernel size as 2; the two numbers in “Linear()” denote the input and output size; the “LSTM(8, 256, 2)” denotes the embedding size is 8, the hidden size is 256, and the number of layers is 2.</span></figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Utilized Networks and Network Splits</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.2" class="ltx_p">We investigate both coarse-grained and fine-grained privatization ways. For coarse-grained investigation, we split the utilized network into <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="L=2" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml">L</mi><mo id="S5.SS2.p1.1.m1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><eq id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1"></eq><ci id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S5.SS2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">L=2</annotation></semantics></math> blocks, i.e., the encoder and classifier. For FeCifar10 and FeCifar100, we utilize the VGG11 without batch normalization in PyTorch<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://pytorch.org/vision/master/_modules/torchvision/models/vgg.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://pytorch.org/vision/master/_modules/torchvision/models/vgg.html</a></span></span></span>. For Shakespeare, we take the same network used in FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>, which contains a character embedding layer, a two-layer LSTM, and a fully-connected layer. For FeMnist, we utilize the FeMnistNet as used in LEAF <cite class="ltx_cite ltx_citemacro_citep">(Caldas et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>, which contains two convolution layers and two fully-connected layers. Owing to the memory limitation, we modify the first fully-connected layer’s output dimension from 2048 to 512. For all networks, we view the fully-connected layers as the classifier and others as the encoder as shown in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.1. Benchmarks ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. For fine-grained network splits, we only investigate the performances on FeCifar10 and FeCifar100, splitting the VGG11 into <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="L=6" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">L</mi><mo id="S5.SS2.p1.2.m2.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><eq id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1"></eq><ci id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2">𝐿</ci><cn type="integer" id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">L=6</annotation></semantics></math> blocks as shown in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.1. Benchmarks ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F5.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x8.png" id="S5.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F5.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F5.1.1.1" class="ltx_text">(a) FeCifar10</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F5.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x9.png" id="S5.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F5.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F5.2.1.1" class="ltx_text">(b) FeCifar100</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F5.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x10.png" id="S5.F5.3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="362" alt="Refer to caption">
<p id="S5.F5.3.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F5.3.1.1" class="ltx_text">(c) Shakespeare</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F5.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x11.png" id="S5.F5.4.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F5.4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F5.4.1.1" class="ltx_text">(d) FeMnist</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span><span id="S5.F5.6.1" class="ltx_text" style="font-size:90%;">Aggregation performances of different privatization ways under the four non-iid benchmarks. Every figure shows one benchmark.</span></figcaption>
</figure>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F6.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x12.png" id="S5.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F6.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F6.1.1.1" class="ltx_text">(a) FeCifar10</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F6.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x13.png" id="S5.F6.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F6.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F6.2.1.1" class="ltx_text">(b) FeCifar100</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F6.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x14.png" id="S5.F6.3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F6.3.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F6.3.1.1" class="ltx_text">(c) Shakespeare</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F6.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x15.png" id="S5.F6.4.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F6.4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F6.4.1.1" class="ltx_text">(d) FeMnist</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span><span id="S5.F6.6.1" class="ltx_text" style="font-size:90%;">Personalization performances of different privatization ways under the four non-iid benchmarks. Every figure shows one benchmark.</span></figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Hyper-parameters and Settings</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.24" class="ltx_p">We denote the learning rate as <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\eta</annotation></semantics></math>, the batch size as <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mi id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">B</annotation></semantics></math>, the client selection ratio as <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mi id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><ci id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">Q</annotation></semantics></math>, the maximum number of global round as <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mi id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><ci id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">T</annotation></semantics></math>, and the local training epochs as <math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mi id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><ci id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">E</annotation></semantics></math>. For FeCifar10 and FeCifar100, we vary <math id="S5.SS3.p1.6.m6.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S5.SS3.p1.6.m6.1a"><mi id="S5.SS3.p1.6.m6.1.1" xref="S5.SS3.p1.6.m6.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m6.1b"><ci id="S5.SS3.p1.6.m6.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m6.1c">\eta</annotation></semantics></math> in <math id="S5.SS3.p1.7.m7.3" class="ltx_Math" alttext="\{0.01,0.03,0.05\}" display="inline"><semantics id="S5.SS3.p1.7.m7.3a"><mrow id="S5.SS3.p1.7.m7.3.4.2" xref="S5.SS3.p1.7.m7.3.4.1.cmml"><mo stretchy="false" id="S5.SS3.p1.7.m7.3.4.2.1" xref="S5.SS3.p1.7.m7.3.4.1.cmml">{</mo><mn id="S5.SS3.p1.7.m7.1.1" xref="S5.SS3.p1.7.m7.1.1.cmml">0.01</mn><mo id="S5.SS3.p1.7.m7.3.4.2.2" xref="S5.SS3.p1.7.m7.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.7.m7.2.2" xref="S5.SS3.p1.7.m7.2.2.cmml">0.03</mn><mo id="S5.SS3.p1.7.m7.3.4.2.3" xref="S5.SS3.p1.7.m7.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.7.m7.3.3" xref="S5.SS3.p1.7.m7.3.3.cmml">0.05</mn><mo stretchy="false" id="S5.SS3.p1.7.m7.3.4.2.4" xref="S5.SS3.p1.7.m7.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.7.m7.3b"><set id="S5.SS3.p1.7.m7.3.4.1.cmml" xref="S5.SS3.p1.7.m7.3.4.2"><cn type="float" id="S5.SS3.p1.7.m7.1.1.cmml" xref="S5.SS3.p1.7.m7.1.1">0.01</cn><cn type="float" id="S5.SS3.p1.7.m7.2.2.cmml" xref="S5.SS3.p1.7.m7.2.2">0.03</cn><cn type="float" id="S5.SS3.p1.7.m7.3.3.cmml" xref="S5.SS3.p1.7.m7.3.3">0.05</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.7.m7.3c">\{0.01,0.03,0.05\}</annotation></semantics></math>, take <math id="S5.SS3.p1.8.m8.1" class="ltx_Math" alttext="B=64" display="inline"><semantics id="S5.SS3.p1.8.m8.1a"><mrow id="S5.SS3.p1.8.m8.1.1" xref="S5.SS3.p1.8.m8.1.1.cmml"><mi id="S5.SS3.p1.8.m8.1.1.2" xref="S5.SS3.p1.8.m8.1.1.2.cmml">B</mi><mo id="S5.SS3.p1.8.m8.1.1.1" xref="S5.SS3.p1.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.8.m8.1.1.3" xref="S5.SS3.p1.8.m8.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.8.m8.1b"><apply id="S5.SS3.p1.8.m8.1.1.cmml" xref="S5.SS3.p1.8.m8.1.1"><eq id="S5.SS3.p1.8.m8.1.1.1.cmml" xref="S5.SS3.p1.8.m8.1.1.1"></eq><ci id="S5.SS3.p1.8.m8.1.1.2.cmml" xref="S5.SS3.p1.8.m8.1.1.2">𝐵</ci><cn type="integer" id="S5.SS3.p1.8.m8.1.1.3.cmml" xref="S5.SS3.p1.8.m8.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.8.m8.1c">B=64</annotation></semantics></math>, <math id="S5.SS3.p1.9.m9.1" class="ltx_Math" alttext="Q=0.1" display="inline"><semantics id="S5.SS3.p1.9.m9.1a"><mrow id="S5.SS3.p1.9.m9.1.1" xref="S5.SS3.p1.9.m9.1.1.cmml"><mi id="S5.SS3.p1.9.m9.1.1.2" xref="S5.SS3.p1.9.m9.1.1.2.cmml">Q</mi><mo id="S5.SS3.p1.9.m9.1.1.1" xref="S5.SS3.p1.9.m9.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.9.m9.1.1.3" xref="S5.SS3.p1.9.m9.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.9.m9.1b"><apply id="S5.SS3.p1.9.m9.1.1.cmml" xref="S5.SS3.p1.9.m9.1.1"><eq id="S5.SS3.p1.9.m9.1.1.1.cmml" xref="S5.SS3.p1.9.m9.1.1.1"></eq><ci id="S5.SS3.p1.9.m9.1.1.2.cmml" xref="S5.SS3.p1.9.m9.1.1.2">𝑄</ci><cn type="float" id="S5.SS3.p1.9.m9.1.1.3.cmml" xref="S5.SS3.p1.9.m9.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.9.m9.1c">Q=0.1</annotation></semantics></math>, <math id="S5.SS3.p1.10.m10.1" class="ltx_Math" alttext="T=1000" display="inline"><semantics id="S5.SS3.p1.10.m10.1a"><mrow id="S5.SS3.p1.10.m10.1.1" xref="S5.SS3.p1.10.m10.1.1.cmml"><mi id="S5.SS3.p1.10.m10.1.1.2" xref="S5.SS3.p1.10.m10.1.1.2.cmml">T</mi><mo id="S5.SS3.p1.10.m10.1.1.1" xref="S5.SS3.p1.10.m10.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.10.m10.1.1.3" xref="S5.SS3.p1.10.m10.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.10.m10.1b"><apply id="S5.SS3.p1.10.m10.1.1.cmml" xref="S5.SS3.p1.10.m10.1.1"><eq id="S5.SS3.p1.10.m10.1.1.1.cmml" xref="S5.SS3.p1.10.m10.1.1.1"></eq><ci id="S5.SS3.p1.10.m10.1.1.2.cmml" xref="S5.SS3.p1.10.m10.1.1.2">𝑇</ci><cn type="integer" id="S5.SS3.p1.10.m10.1.1.3.cmml" xref="S5.SS3.p1.10.m10.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.10.m10.1c">T=1000</annotation></semantics></math>, and <math id="S5.SS3.p1.11.m11.1" class="ltx_Math" alttext="E=2" display="inline"><semantics id="S5.SS3.p1.11.m11.1a"><mrow id="S5.SS3.p1.11.m11.1.1" xref="S5.SS3.p1.11.m11.1.1.cmml"><mi id="S5.SS3.p1.11.m11.1.1.2" xref="S5.SS3.p1.11.m11.1.1.2.cmml">E</mi><mo id="S5.SS3.p1.11.m11.1.1.1" xref="S5.SS3.p1.11.m11.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.11.m11.1.1.3" xref="S5.SS3.p1.11.m11.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.11.m11.1b"><apply id="S5.SS3.p1.11.m11.1.1.cmml" xref="S5.SS3.p1.11.m11.1.1"><eq id="S5.SS3.p1.11.m11.1.1.1.cmml" xref="S5.SS3.p1.11.m11.1.1.1"></eq><ci id="S5.SS3.p1.11.m11.1.1.2.cmml" xref="S5.SS3.p1.11.m11.1.1.2">𝐸</ci><cn type="integer" id="S5.SS3.p1.11.m11.1.1.3.cmml" xref="S5.SS3.p1.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.11.m11.1c">E=2</annotation></semantics></math>; for Shakespeare, we vary <math id="S5.SS3.p1.12.m12.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S5.SS3.p1.12.m12.1a"><mi id="S5.SS3.p1.12.m12.1.1" xref="S5.SS3.p1.12.m12.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.12.m12.1b"><ci id="S5.SS3.p1.12.m12.1.1.cmml" xref="S5.SS3.p1.12.m12.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.12.m12.1c">\eta</annotation></semantics></math> in <math id="S5.SS3.p1.13.m13.3" class="ltx_Math" alttext="\{0.75,1.0,1.47\}" display="inline"><semantics id="S5.SS3.p1.13.m13.3a"><mrow id="S5.SS3.p1.13.m13.3.4.2" xref="S5.SS3.p1.13.m13.3.4.1.cmml"><mo stretchy="false" id="S5.SS3.p1.13.m13.3.4.2.1" xref="S5.SS3.p1.13.m13.3.4.1.cmml">{</mo><mn id="S5.SS3.p1.13.m13.1.1" xref="S5.SS3.p1.13.m13.1.1.cmml">0.75</mn><mo id="S5.SS3.p1.13.m13.3.4.2.2" xref="S5.SS3.p1.13.m13.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.13.m13.2.2" xref="S5.SS3.p1.13.m13.2.2.cmml">1.0</mn><mo id="S5.SS3.p1.13.m13.3.4.2.3" xref="S5.SS3.p1.13.m13.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.13.m13.3.3" xref="S5.SS3.p1.13.m13.3.3.cmml">1.47</mn><mo stretchy="false" id="S5.SS3.p1.13.m13.3.4.2.4" xref="S5.SS3.p1.13.m13.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.13.m13.3b"><set id="S5.SS3.p1.13.m13.3.4.1.cmml" xref="S5.SS3.p1.13.m13.3.4.2"><cn type="float" id="S5.SS3.p1.13.m13.1.1.cmml" xref="S5.SS3.p1.13.m13.1.1">0.75</cn><cn type="float" id="S5.SS3.p1.13.m13.2.2.cmml" xref="S5.SS3.p1.13.m13.2.2">1.0</cn><cn type="float" id="S5.SS3.p1.13.m13.3.3.cmml" xref="S5.SS3.p1.13.m13.3.3">1.47</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.13.m13.3c">\{0.75,1.0,1.47\}</annotation></semantics></math>, take <math id="S5.SS3.p1.14.m14.1" class="ltx_Math" alttext="B=50" display="inline"><semantics id="S5.SS3.p1.14.m14.1a"><mrow id="S5.SS3.p1.14.m14.1.1" xref="S5.SS3.p1.14.m14.1.1.cmml"><mi id="S5.SS3.p1.14.m14.1.1.2" xref="S5.SS3.p1.14.m14.1.1.2.cmml">B</mi><mo id="S5.SS3.p1.14.m14.1.1.1" xref="S5.SS3.p1.14.m14.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.14.m14.1.1.3" xref="S5.SS3.p1.14.m14.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.14.m14.1b"><apply id="S5.SS3.p1.14.m14.1.1.cmml" xref="S5.SS3.p1.14.m14.1.1"><eq id="S5.SS3.p1.14.m14.1.1.1.cmml" xref="S5.SS3.p1.14.m14.1.1.1"></eq><ci id="S5.SS3.p1.14.m14.1.1.2.cmml" xref="S5.SS3.p1.14.m14.1.1.2">𝐵</ci><cn type="integer" id="S5.SS3.p1.14.m14.1.1.3.cmml" xref="S5.SS3.p1.14.m14.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.14.m14.1c">B=50</annotation></semantics></math>, <math id="S5.SS3.p1.15.m15.1" class="ltx_Math" alttext="Q=0.01" display="inline"><semantics id="S5.SS3.p1.15.m15.1a"><mrow id="S5.SS3.p1.15.m15.1.1" xref="S5.SS3.p1.15.m15.1.1.cmml"><mi id="S5.SS3.p1.15.m15.1.1.2" xref="S5.SS3.p1.15.m15.1.1.2.cmml">Q</mi><mo id="S5.SS3.p1.15.m15.1.1.1" xref="S5.SS3.p1.15.m15.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.15.m15.1.1.3" xref="S5.SS3.p1.15.m15.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.15.m15.1b"><apply id="S5.SS3.p1.15.m15.1.1.cmml" xref="S5.SS3.p1.15.m15.1.1"><eq id="S5.SS3.p1.15.m15.1.1.1.cmml" xref="S5.SS3.p1.15.m15.1.1.1"></eq><ci id="S5.SS3.p1.15.m15.1.1.2.cmml" xref="S5.SS3.p1.15.m15.1.1.2">𝑄</ci><cn type="float" id="S5.SS3.p1.15.m15.1.1.3.cmml" xref="S5.SS3.p1.15.m15.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.15.m15.1c">Q=0.01</annotation></semantics></math>, <math id="S5.SS3.p1.16.m16.1" class="ltx_Math" alttext="T=1000" display="inline"><semantics id="S5.SS3.p1.16.m16.1a"><mrow id="S5.SS3.p1.16.m16.1.1" xref="S5.SS3.p1.16.m16.1.1.cmml"><mi id="S5.SS3.p1.16.m16.1.1.2" xref="S5.SS3.p1.16.m16.1.1.2.cmml">T</mi><mo id="S5.SS3.p1.16.m16.1.1.1" xref="S5.SS3.p1.16.m16.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.16.m16.1.1.3" xref="S5.SS3.p1.16.m16.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.16.m16.1b"><apply id="S5.SS3.p1.16.m16.1.1.cmml" xref="S5.SS3.p1.16.m16.1.1"><eq id="S5.SS3.p1.16.m16.1.1.1.cmml" xref="S5.SS3.p1.16.m16.1.1.1"></eq><ci id="S5.SS3.p1.16.m16.1.1.2.cmml" xref="S5.SS3.p1.16.m16.1.1.2">𝑇</ci><cn type="integer" id="S5.SS3.p1.16.m16.1.1.3.cmml" xref="S5.SS3.p1.16.m16.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.16.m16.1c">T=1000</annotation></semantics></math>, and <math id="S5.SS3.p1.17.m17.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S5.SS3.p1.17.m17.1a"><mrow id="S5.SS3.p1.17.m17.1.1" xref="S5.SS3.p1.17.m17.1.1.cmml"><mi id="S5.SS3.p1.17.m17.1.1.2" xref="S5.SS3.p1.17.m17.1.1.2.cmml">E</mi><mo id="S5.SS3.p1.17.m17.1.1.1" xref="S5.SS3.p1.17.m17.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.17.m17.1.1.3" xref="S5.SS3.p1.17.m17.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.17.m17.1b"><apply id="S5.SS3.p1.17.m17.1.1.cmml" xref="S5.SS3.p1.17.m17.1.1"><eq id="S5.SS3.p1.17.m17.1.1.1.cmml" xref="S5.SS3.p1.17.m17.1.1.1"></eq><ci id="S5.SS3.p1.17.m17.1.1.2.cmml" xref="S5.SS3.p1.17.m17.1.1.2">𝐸</ci><cn type="integer" id="S5.SS3.p1.17.m17.1.1.3.cmml" xref="S5.SS3.p1.17.m17.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.17.m17.1c">E=1</annotation></semantics></math>; for FeMnist, we vary <math id="S5.SS3.p1.18.m18.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S5.SS3.p1.18.m18.1a"><mi id="S5.SS3.p1.18.m18.1.1" xref="S5.SS3.p1.18.m18.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.18.m18.1b"><ci id="S5.SS3.p1.18.m18.1.1.cmml" xref="S5.SS3.p1.18.m18.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.18.m18.1c">\eta</annotation></semantics></math> in <math id="S5.SS3.p1.19.m19.3" class="ltx_Math" alttext="\{0.001,0.002,0.004\}" display="inline"><semantics id="S5.SS3.p1.19.m19.3a"><mrow id="S5.SS3.p1.19.m19.3.4.2" xref="S5.SS3.p1.19.m19.3.4.1.cmml"><mo stretchy="false" id="S5.SS3.p1.19.m19.3.4.2.1" xref="S5.SS3.p1.19.m19.3.4.1.cmml">{</mo><mn id="S5.SS3.p1.19.m19.1.1" xref="S5.SS3.p1.19.m19.1.1.cmml">0.001</mn><mo id="S5.SS3.p1.19.m19.3.4.2.2" xref="S5.SS3.p1.19.m19.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.19.m19.2.2" xref="S5.SS3.p1.19.m19.2.2.cmml">0.002</mn><mo id="S5.SS3.p1.19.m19.3.4.2.3" xref="S5.SS3.p1.19.m19.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.19.m19.3.3" xref="S5.SS3.p1.19.m19.3.3.cmml">0.004</mn><mo stretchy="false" id="S5.SS3.p1.19.m19.3.4.2.4" xref="S5.SS3.p1.19.m19.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.19.m19.3b"><set id="S5.SS3.p1.19.m19.3.4.1.cmml" xref="S5.SS3.p1.19.m19.3.4.2"><cn type="float" id="S5.SS3.p1.19.m19.1.1.cmml" xref="S5.SS3.p1.19.m19.1.1">0.001</cn><cn type="float" id="S5.SS3.p1.19.m19.2.2.cmml" xref="S5.SS3.p1.19.m19.2.2">0.002</cn><cn type="float" id="S5.SS3.p1.19.m19.3.3.cmml" xref="S5.SS3.p1.19.m19.3.3">0.004</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.19.m19.3c">\{0.001,0.002,0.004\}</annotation></semantics></math>, take <math id="S5.SS3.p1.20.m20.1" class="ltx_Math" alttext="B=10" display="inline"><semantics id="S5.SS3.p1.20.m20.1a"><mrow id="S5.SS3.p1.20.m20.1.1" xref="S5.SS3.p1.20.m20.1.1.cmml"><mi id="S5.SS3.p1.20.m20.1.1.2" xref="S5.SS3.p1.20.m20.1.1.2.cmml">B</mi><mo id="S5.SS3.p1.20.m20.1.1.1" xref="S5.SS3.p1.20.m20.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.20.m20.1.1.3" xref="S5.SS3.p1.20.m20.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.20.m20.1b"><apply id="S5.SS3.p1.20.m20.1.1.cmml" xref="S5.SS3.p1.20.m20.1.1"><eq id="S5.SS3.p1.20.m20.1.1.1.cmml" xref="S5.SS3.p1.20.m20.1.1.1"></eq><ci id="S5.SS3.p1.20.m20.1.1.2.cmml" xref="S5.SS3.p1.20.m20.1.1.2">𝐵</ci><cn type="integer" id="S5.SS3.p1.20.m20.1.1.3.cmml" xref="S5.SS3.p1.20.m20.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.20.m20.1c">B=10</annotation></semantics></math>, <math id="S5.SS3.p1.21.m21.1" class="ltx_Math" alttext="Q=0.001" display="inline"><semantics id="S5.SS3.p1.21.m21.1a"><mrow id="S5.SS3.p1.21.m21.1.1" xref="S5.SS3.p1.21.m21.1.1.cmml"><mi id="S5.SS3.p1.21.m21.1.1.2" xref="S5.SS3.p1.21.m21.1.1.2.cmml">Q</mi><mo id="S5.SS3.p1.21.m21.1.1.1" xref="S5.SS3.p1.21.m21.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.21.m21.1.1.3" xref="S5.SS3.p1.21.m21.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.21.m21.1b"><apply id="S5.SS3.p1.21.m21.1.1.cmml" xref="S5.SS3.p1.21.m21.1.1"><eq id="S5.SS3.p1.21.m21.1.1.1.cmml" xref="S5.SS3.p1.21.m21.1.1.1"></eq><ci id="S5.SS3.p1.21.m21.1.1.2.cmml" xref="S5.SS3.p1.21.m21.1.1.2">𝑄</ci><cn type="float" id="S5.SS3.p1.21.m21.1.1.3.cmml" xref="S5.SS3.p1.21.m21.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.21.m21.1c">Q=0.001</annotation></semantics></math>, <math id="S5.SS3.p1.22.m22.1" class="ltx_Math" alttext="T=1000" display="inline"><semantics id="S5.SS3.p1.22.m22.1a"><mrow id="S5.SS3.p1.22.m22.1.1" xref="S5.SS3.p1.22.m22.1.1.cmml"><mi id="S5.SS3.p1.22.m22.1.1.2" xref="S5.SS3.p1.22.m22.1.1.2.cmml">T</mi><mo id="S5.SS3.p1.22.m22.1.1.1" xref="S5.SS3.p1.22.m22.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.22.m22.1.1.3" xref="S5.SS3.p1.22.m22.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.22.m22.1b"><apply id="S5.SS3.p1.22.m22.1.1.cmml" xref="S5.SS3.p1.22.m22.1.1"><eq id="S5.SS3.p1.22.m22.1.1.1.cmml" xref="S5.SS3.p1.22.m22.1.1.1"></eq><ci id="S5.SS3.p1.22.m22.1.1.2.cmml" xref="S5.SS3.p1.22.m22.1.1.2">𝑇</ci><cn type="integer" id="S5.SS3.p1.22.m22.1.1.3.cmml" xref="S5.SS3.p1.22.m22.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.22.m22.1c">T=1000</annotation></semantics></math>, and <math id="S5.SS3.p1.23.m23.1" class="ltx_Math" alttext="E=2" display="inline"><semantics id="S5.SS3.p1.23.m23.1a"><mrow id="S5.SS3.p1.23.m23.1.1" xref="S5.SS3.p1.23.m23.1.1.cmml"><mi id="S5.SS3.p1.23.m23.1.1.2" xref="S5.SS3.p1.23.m23.1.1.2.cmml">E</mi><mo id="S5.SS3.p1.23.m23.1.1.1" xref="S5.SS3.p1.23.m23.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.23.m23.1.1.3" xref="S5.SS3.p1.23.m23.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.23.m23.1b"><apply id="S5.SS3.p1.23.m23.1.1.cmml" xref="S5.SS3.p1.23.m23.1.1"><eq id="S5.SS3.p1.23.m23.1.1.1.cmml" xref="S5.SS3.p1.23.m23.1.1.1"></eq><ci id="S5.SS3.p1.23.m23.1.1.2.cmml" xref="S5.SS3.p1.23.m23.1.1.2">𝐸</ci><cn type="integer" id="S5.SS3.p1.23.m23.1.1.3.cmml" xref="S5.SS3.p1.23.m23.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.23.m23.1c">E=2</annotation></semantics></math>. For all of them, we use SGD with momentum 0.9 as the optimizer. For shakespeare, some clients have amounts of training samples, and hence we limit the maximum of local steps (i.e., the number of local batches) to be <math id="S5.SS3.p1.24.m24.1" class="ltx_Math" alttext="250" display="inline"><semantics id="S5.SS3.p1.24.m24.1a"><mn id="S5.SS3.p1.24.m24.1.1" xref="S5.SS3.p1.24.m24.1.1.cmml">250</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.24.m24.1b"><cn type="integer" id="S5.SS3.p1.24.m24.1.1.cmml" xref="S5.SS3.p1.24.m24.1.1">250</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.24.m24.1c">250</annotation></semantics></math>. In all experiments, we record both the aggregation and personalization results as calculated in Def. <a href="#S3.Thmtheorem2" title="Definition 3.2 (Goal of Aggregation in FL). ‣ 3.2. Goals of Aggregation and Personalization ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> and Def. <a href="#S3.Thmtheorem3" title="Definition 3.3 (Goal of Personalization in FL). ‣ 3.2. Goals of Aggregation and Personalization ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> every 10 rounds. For various hyper-parameters, we report the best one according to the average of the last 5 recorded performances. Taking various hyper-parameters can omit the randomness in training to some extent, and the obtained results are more convincing.</p>
</div>
<figure id="S5.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F7.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x16.png" id="S5.F7.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="362" alt="Refer to caption">
<p id="S5.F7.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F7.2.1.1" class="ltx_text">(a) Shakespeare, Aggregation (<math id="S5.F7.2.1.1.m1.1" class="ltx_Math" alttext="Q=0.1" display="inline"><semantics id="S5.F7.2.1.1.m1.1a"><mrow id="S5.F7.2.1.1.m1.1.1" xref="S5.F7.2.1.1.m1.1.1.cmml"><mi id="S5.F7.2.1.1.m1.1.1.2" xref="S5.F7.2.1.1.m1.1.1.2.cmml">Q</mi><mo id="S5.F7.2.1.1.m1.1.1.1" xref="S5.F7.2.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F7.2.1.1.m1.1.1.3" xref="S5.F7.2.1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.2.1.1.m1.1b"><apply id="S5.F7.2.1.1.m1.1.1.cmml" xref="S5.F7.2.1.1.m1.1.1"><eq id="S5.F7.2.1.1.m1.1.1.1.cmml" xref="S5.F7.2.1.1.m1.1.1.1"></eq><ci id="S5.F7.2.1.1.m1.1.1.2.cmml" xref="S5.F7.2.1.1.m1.1.1.2">𝑄</ci><cn type="float" id="S5.F7.2.1.1.m1.1.1.3.cmml" xref="S5.F7.2.1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.2.1.1.m1.1c">Q=0.1</annotation></semantics></math>)</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F7.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x17.png" id="S5.F7.3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="362" alt="Refer to caption">
<p id="S5.F7.4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F7.4.1.1" class="ltx_text">(b) Shakespeare, Aggregation (<math id="S5.F7.4.1.1.m1.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.F7.4.1.1.m1.1a"><mrow id="S5.F7.4.1.1.m1.1.1" xref="S5.F7.4.1.1.m1.1.1.cmml"><mi id="S5.F7.4.1.1.m1.1.1.2" xref="S5.F7.4.1.1.m1.1.1.2.cmml">E</mi><mo id="S5.F7.4.1.1.m1.1.1.1" xref="S5.F7.4.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F7.4.1.1.m1.1.1.3" xref="S5.F7.4.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.4.1.1.m1.1b"><apply id="S5.F7.4.1.1.m1.1.1.cmml" xref="S5.F7.4.1.1.m1.1.1"><eq id="S5.F7.4.1.1.m1.1.1.1.cmml" xref="S5.F7.4.1.1.m1.1.1.1"></eq><ci id="S5.F7.4.1.1.m1.1.1.2.cmml" xref="S5.F7.4.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.F7.4.1.1.m1.1.1.3.cmml" xref="S5.F7.4.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.4.1.1.m1.1c">E=5</annotation></semantics></math>)</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F7.6" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x18.png" id="S5.F7.5.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F7.6.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F7.6.1.1" class="ltx_text">(c) Shakespeare, Personalization (<math id="S5.F7.6.1.1.m1.1" class="ltx_Math" alttext="Q=0.1" display="inline"><semantics id="S5.F7.6.1.1.m1.1a"><mrow id="S5.F7.6.1.1.m1.1.1" xref="S5.F7.6.1.1.m1.1.1.cmml"><mi id="S5.F7.6.1.1.m1.1.1.2" xref="S5.F7.6.1.1.m1.1.1.2.cmml">Q</mi><mo id="S5.F7.6.1.1.m1.1.1.1" xref="S5.F7.6.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F7.6.1.1.m1.1.1.3" xref="S5.F7.6.1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.6.1.1.m1.1b"><apply id="S5.F7.6.1.1.m1.1.1.cmml" xref="S5.F7.6.1.1.m1.1.1"><eq id="S5.F7.6.1.1.m1.1.1.1.cmml" xref="S5.F7.6.1.1.m1.1.1.1"></eq><ci id="S5.F7.6.1.1.m1.1.1.2.cmml" xref="S5.F7.6.1.1.m1.1.1.2">𝑄</ci><cn type="float" id="S5.F7.6.1.1.m1.1.1.3.cmml" xref="S5.F7.6.1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.6.1.1.m1.1c">Q=0.1</annotation></semantics></math>)</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F7.8" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x19.png" id="S5.F7.7.g1" class="ltx_graphics ltx_img_landscape" width="461" height="369" alt="Refer to caption">
<p id="S5.F7.8.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F7.8.1.1" class="ltx_text">(d) Shakespeare, Personalization (<math id="S5.F7.8.1.1.m1.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.F7.8.1.1.m1.1a"><mrow id="S5.F7.8.1.1.m1.1.1" xref="S5.F7.8.1.1.m1.1.1.cmml"><mi id="S5.F7.8.1.1.m1.1.1.2" xref="S5.F7.8.1.1.m1.1.1.2.cmml">E</mi><mo id="S5.F7.8.1.1.m1.1.1.1" xref="S5.F7.8.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.F7.8.1.1.m1.1.1.3" xref="S5.F7.8.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.8.1.1.m1.1b"><apply id="S5.F7.8.1.1.m1.1.1.cmml" xref="S5.F7.8.1.1.m1.1.1"><eq id="S5.F7.8.1.1.m1.1.1.1.cmml" xref="S5.F7.8.1.1.m1.1.1.1"></eq><ci id="S5.F7.8.1.1.m1.1.1.2.cmml" xref="S5.F7.8.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.F7.8.1.1.m1.1.1.3.cmml" xref="S5.F7.8.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.8.1.1.m1.1c">E=5</annotation></semantics></math>)</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span><span id="S5.F7.10.1" class="ltx_text" style="font-size:90%;">The aggregation and personalization performances of Shakespeare under various hyper-parameter settings. The top row shows the aggregation performances, while the bottom shows the personalization performances. In each row, the two figures show the case when the client selection ratio is 0.1, and the number of local epochs is 5, respectively.</span></figcaption>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Results of Different Privatization Ways</h3>

<section id="S5.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.1. </span>Coarse-grained Privatization</h4>

<div id="S5.SS4.SSS1.p1" class="ltx_para">
<p id="S5.SS4.SSS1.p1.1" class="ltx_p">We first report the results of the coarse-grained privatization ways. We split corresponding networks into two blocks, i.e., encoder and classifier, as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We report the aggregation and personalization results in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.2. Utilized Networks and Network Splits ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.2. Utilized Networks and Network Splits ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, respectively. We denote the aggregation performance as “Global Accuracy” and the personalization performance as “Local Accuracy” in these figures. In Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.2. Utilized Networks and Network Splits ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we can observe that “AaB” can lead to much better aggregation performances on FeCifar10 and FeCifar100, which contradicts the two assumptions in Sect. <a href="#S3.SS3" title="3.3. Issues to Explore ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. FeCifar10 and FeCifar100 are constructed via splitting labels, which may perform better with “ABb” if the two assumptions stand. However, we find that “ABb” performs similarly to “AaBb”, a little better than “AB”, while worse than “AaB”. This phenomenon is not caused by the number of parameters because their parameters are the same on the server. Then, we consider the personalization performances as in Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.2. Utilized Networks and Network Splits ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, the “ABb” can lead to comparable or a little better results than “AaB” and “AaBb” on FeCifar10 and FeCifar100. The individually training, i.e., “ab”, obtains the worst personalization accuracies, which is rational because of the limit of training samples on local clients. Privatizing the encoder in a single branch style, i.e., “aB”, works better than “ab” while worse than “AB”. However, privatizing the classifier, i.e., “Ab”, can obtain slightly better performances than “AB”. To be brief, on FeCifar10 and FeCifar100, privatizing an encoder with double branches, i.e., “AaB”, can lead to better aggregation and personalization performances. <span id="S5.SS4.SSS1.p1.1.1" class="ltx_text ltx_font_italic">Namely, for FL with label shift non-iid scenes, privatizing a classifier or a complete model may be less effective than privatizing an encoder, which contradicts some natural conjectures.</span></p>
</div>
<div id="S5.SS4.SSS1.p2" class="ltx_para">
<p id="S5.SS4.SSS1.p2.1" class="ltx_p">Then, we take a look at Shakespeare and FeMnist. <span id="S5.SS4.SSS1.p2.1.1" class="ltx_text ltx_font_italic">On Shakespeare, all privatization ways seem useless in both aggregation and personalization performances.</span> This is so exciting that we doubt whether Shakespeare is a real non-iid scene or not, and we will verify our assumption later. On FeMnist, “ABb” can lead to faster convergence for aggregation, and the following is “AaB”, while they perform comparably for personalization. This phenomenon contradicts the first assumption in Sect. <a href="#S3.SS3" title="3.3. Issues to Explore ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>, where the covariate shift non-iid scene does not necessarily require privatizing an encoder.
The above observations can be concluded as follows:</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">Adopting private models in a double branch manner can nearly always lead to better performances than FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>, while this is not true for Shakespeare.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">Taking single branch privatization ways almost always perform worse.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">The observations contradict the natural assumptions in Sect. <a href="#S3.SS3" title="3.3. Issues to Explore ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p">Privatizing an encoder in a double branch manner, i.e., “AaB”, can almost always lead to better results, which should be prioritized when faced with a novel FL non-iid scene. Following this, the “ABb” should be taken for a try.</p>
</div>
</li>
</ul>
</div>
<figure id="S5.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F8.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x20.png" id="S5.F8.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="282" alt="Refer to caption">
<p id="S5.F8.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F8.1.1.1" class="ltx_text">(a) FeCifar10, Aggregation</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F8.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x21.png" id="S5.F8.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="282" alt="Refer to caption">
<p id="S5.F8.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F8.2.1.1" class="ltx_text">(b) FeCifar100, Aggregation</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S5.F8.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2107.11954/assets/x22.png" id="S5.F8.3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="180" alt="Refer to caption">
<p id="S5.F8.3.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F8.3.1.1" class="ltx_text">(c) FeCifar10, Personalization</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S5.F8.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:433.6pt;">
<img src="/html/2107.11954/assets/x23.png" id="S5.F8.4.g1" class="ltx_graphics ltx_img_landscape" width="461" height="180" alt="Refer to caption">
<p id="S5.F8.4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F8.4.1.1" class="ltx_text">(d) FeCifar100, Personalization</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span><span id="S5.F8.6.1" class="ltx_text" style="font-size:90%;">Aggregation and personalization performances of different fine-grained privatization ways on FeCifar10 and FeCifar100. The top row shows the aggregation performances, while the bottom two rows show the personalization performances.</span></figcaption>
</figure>
<div id="S5.SS4.SSS1.p3" class="ltx_para">
<p id="S5.SS4.SSS1.p3.6" class="ltx_p">Owing to the observation that none of the privatization ways performs better on Shakespeare, we investigate this scene with more settings, e.g., <math id="S5.SS4.SSS1.p3.1.m1.1" class="ltx_Math" alttext="Q=0.1" display="inline"><semantics id="S5.SS4.SSS1.p3.1.m1.1a"><mrow id="S5.SS4.SSS1.p3.1.m1.1.1" xref="S5.SS4.SSS1.p3.1.m1.1.1.cmml"><mi id="S5.SS4.SSS1.p3.1.m1.1.1.2" xref="S5.SS4.SSS1.p3.1.m1.1.1.2.cmml">Q</mi><mo id="S5.SS4.SSS1.p3.1.m1.1.1.1" xref="S5.SS4.SSS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS4.SSS1.p3.1.m1.1.1.3" xref="S5.SS4.SSS1.p3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p3.1.m1.1b"><apply id="S5.SS4.SSS1.p3.1.m1.1.1.cmml" xref="S5.SS4.SSS1.p3.1.m1.1.1"><eq id="S5.SS4.SSS1.p3.1.m1.1.1.1.cmml" xref="S5.SS4.SSS1.p3.1.m1.1.1.1"></eq><ci id="S5.SS4.SSS1.p3.1.m1.1.1.2.cmml" xref="S5.SS4.SSS1.p3.1.m1.1.1.2">𝑄</ci><cn type="float" id="S5.SS4.SSS1.p3.1.m1.1.1.3.cmml" xref="S5.SS4.SSS1.p3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p3.1.m1.1c">Q=0.1</annotation></semantics></math> and <math id="S5.SS4.SSS1.p3.2.m2.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.SS4.SSS1.p3.2.m2.1a"><mrow id="S5.SS4.SSS1.p3.2.m2.1.1" xref="S5.SS4.SSS1.p3.2.m2.1.1.cmml"><mi id="S5.SS4.SSS1.p3.2.m2.1.1.2" xref="S5.SS4.SSS1.p3.2.m2.1.1.2.cmml">E</mi><mo id="S5.SS4.SSS1.p3.2.m2.1.1.1" xref="S5.SS4.SSS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS4.SSS1.p3.2.m2.1.1.3" xref="S5.SS4.SSS1.p3.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p3.2.m2.1b"><apply id="S5.SS4.SSS1.p3.2.m2.1.1.cmml" xref="S5.SS4.SSS1.p3.2.m2.1.1"><eq id="S5.SS4.SSS1.p3.2.m2.1.1.1.cmml" xref="S5.SS4.SSS1.p3.2.m2.1.1.1"></eq><ci id="S5.SS4.SSS1.p3.2.m2.1.1.2.cmml" xref="S5.SS4.SSS1.p3.2.m2.1.1.2">𝐸</ci><cn type="integer" id="S5.SS4.SSS1.p3.2.m2.1.1.3.cmml" xref="S5.SS4.SSS1.p3.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p3.2.m2.1c">E=5</annotation></semantics></math>. For <math id="S5.SS4.SSS1.p3.3.m3.1" class="ltx_Math" alttext="Q=0.1" display="inline"><semantics id="S5.SS4.SSS1.p3.3.m3.1a"><mrow id="S5.SS4.SSS1.p3.3.m3.1.1" xref="S5.SS4.SSS1.p3.3.m3.1.1.cmml"><mi id="S5.SS4.SSS1.p3.3.m3.1.1.2" xref="S5.SS4.SSS1.p3.3.m3.1.1.2.cmml">Q</mi><mo id="S5.SS4.SSS1.p3.3.m3.1.1.1" xref="S5.SS4.SSS1.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS4.SSS1.p3.3.m3.1.1.3" xref="S5.SS4.SSS1.p3.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p3.3.m3.1b"><apply id="S5.SS4.SSS1.p3.3.m3.1.1.cmml" xref="S5.SS4.SSS1.p3.3.m3.1.1"><eq id="S5.SS4.SSS1.p3.3.m3.1.1.1.cmml" xref="S5.SS4.SSS1.p3.3.m3.1.1.1"></eq><ci id="S5.SS4.SSS1.p3.3.m3.1.1.2.cmml" xref="S5.SS4.SSS1.p3.3.m3.1.1.2">𝑄</ci><cn type="float" id="S5.SS4.SSS1.p3.3.m3.1.1.3.cmml" xref="S5.SS4.SSS1.p3.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p3.3.m3.1c">Q=0.1</annotation></semantics></math>, we increase the client selection ratio from <math id="S5.SS4.SSS1.p3.4.m4.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S5.SS4.SSS1.p3.4.m4.1a"><mn id="S5.SS4.SSS1.p3.4.m4.1.1" xref="S5.SS4.SSS1.p3.4.m4.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p3.4.m4.1b"><cn type="float" id="S5.SS4.SSS1.p3.4.m4.1.1.cmml" xref="S5.SS4.SSS1.p3.4.m4.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p3.4.m4.1c">0.01</annotation></semantics></math> to <math id="S5.SS4.SSS1.p3.5.m5.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S5.SS4.SSS1.p3.5.m5.1a"><mn id="S5.SS4.SSS1.p3.5.m5.1.1" xref="S5.SS4.SSS1.p3.5.m5.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p3.5.m5.1b"><cn type="float" id="S5.SS4.SSS1.p3.5.m5.1.1.cmml" xref="S5.SS4.SSS1.p3.5.m5.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p3.5.m5.1c">0.1</annotation></semantics></math>, and investigate whether the privatization is relevant to the number of participating clients or not; for <math id="S5.SS4.SSS1.p3.6.m6.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.SS4.SSS1.p3.6.m6.1a"><mrow id="S5.SS4.SSS1.p3.6.m6.1.1" xref="S5.SS4.SSS1.p3.6.m6.1.1.cmml"><mi id="S5.SS4.SSS1.p3.6.m6.1.1.2" xref="S5.SS4.SSS1.p3.6.m6.1.1.2.cmml">E</mi><mo id="S5.SS4.SSS1.p3.6.m6.1.1.1" xref="S5.SS4.SSS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS4.SSS1.p3.6.m6.1.1.3" xref="S5.SS4.SSS1.p3.6.m6.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p3.6.m6.1b"><apply id="S5.SS4.SSS1.p3.6.m6.1.1.cmml" xref="S5.SS4.SSS1.p3.6.m6.1.1"><eq id="S5.SS4.SSS1.p3.6.m6.1.1.1.cmml" xref="S5.SS4.SSS1.p3.6.m6.1.1.1"></eq><ci id="S5.SS4.SSS1.p3.6.m6.1.1.2.cmml" xref="S5.SS4.SSS1.p3.6.m6.1.1.2">𝐸</ci><cn type="integer" id="S5.SS4.SSS1.p3.6.m6.1.1.3.cmml" xref="S5.SS4.SSS1.p3.6.m6.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p3.6.m6.1c">E=5</annotation></semantics></math>, we want to find whether the performances of privatization ways are related to the local training steps or not. For each setting, we record the performances in Fig. <a href="#S5.F7" title="Figure 7 ‣ 5.3. Hyper-parameters and Settings ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. We can still find that the privatization ways are useless. <span id="S5.SS4.SSS1.p3.6.1" class="ltx_text ltx_font_italic">Hence, we guess that Shakespeare may not be a severe non-iid scene that does not need any privatized components.</span></p>
</div>
</section>
<section id="S5.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.2. </span>Fine-grained Privatization</h4>

<div id="S5.SS4.SSS2.p1" class="ltx_para">
<p id="S5.SS4.SSS2.p1.1" class="ltx_p">Then we investigate the aggregation and personalization performances via fine-grained network splits. Specifically, we investigate the VGG11 on FeCifar10 and FeCifar100. The fine-grained network splits can be found in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.1. Benchmarks ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Here, we only report the average of the last 5 test rounds’ performances and corresponding deviations. We plot the performances of various privatization ways in Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.4.1. Coarse-grained Privatization ‣ 5.4. Results of Different Privatization Ways ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. Because the reported results only denote the performances when obtaining convergence, the observations will be a little different from the above analysis. The aggregation performances on FeCifar10 and FeCifar100 do not present any regular changes, while the obtained personalization performances are interesting. We can obviously observe that the personalization performances gradually decrease from “ABCDEF” to “abcdeF”, or from “ABCDEF” to “Abcedf” in the single branch privatization ways. Individually training, i.e., “abcdef”, obtains the worst personalization performances. <span id="S5.SS4.SSS2.p1.1.1" class="ltx_text ltx_font_italic">With more privatization blocks, no matter the base or the top layers, the performances degrade monotonically.</span> On FeCifar10 and FeCifar100, the double branch architectures can obtain similar personalization performances. <span id="S5.SS4.SSS2.p1.1.2" class="ltx_text ltx_font_italic">This again verifies that the single branch privatization ways will lead to worse performances, and we should take a double branch one.</span></p>
</div>
<figure id="S5.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F9.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x24.png" id="S5.F9.1.g1" class="ltx_graphics ltx_img_square" width="461" height="476" alt="Refer to caption">
<p id="S5.F9.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F9.1.1.1" class="ltx_text">(a) FeCifar10</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F9.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x25.png" id="S5.F9.2.g1" class="ltx_graphics ltx_img_square" width="461" height="476" alt="Refer to caption">
<p id="S5.F9.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F9.2.1.1" class="ltx_text">(b) FeCifar100</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F9.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x26.png" id="S5.F9.3.g1" class="ltx_graphics ltx_img_square" width="461" height="476" alt="Refer to caption">
<p id="S5.F9.3.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F9.3.1.1" class="ltx_text">(c) Shakespeare</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F9.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2107.11954/assets/x27.png" id="S5.F9.4.g1" class="ltx_graphics ltx_img_square" width="461" height="473" alt="Refer to caption">
<p id="S5.F9.4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F9.4.1.1" class="ltx_text">(d) FeMnist</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9. </span><span id="S5.F9.6.1" class="ltx_text" style="font-size:90%;">Personalization performances of interpolations between shared and private components. Every figure shows one benchmark.</span></figcaption>
</figure>
<figure id="S5.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F10.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.11954/assets/x28.png" id="S5.F10.1.g1" class="ltx_graphics ltx_img_square" width="461" height="417" alt="Refer to caption">
<p id="S5.F10.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F10.1.1.1" class="ltx_text">(a) FeCifar10 AutoCS</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F10.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.11954/assets/x29.png" id="S5.F10.2.g1" class="ltx_graphics ltx_img_square" width="461" height="407" alt="Refer to caption">
<p id="S5.F10.2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F10.2.1.1" class="ltx_text">(b) FeCifar10 AutoSA</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F10.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.11954/assets/x30.png" id="S5.F10.3.g1" class="ltx_graphics ltx_img_square" width="461" height="417" alt="Refer to caption">
<p id="S5.F10.3.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F10.3.1.1" class="ltx_text">(c) FeCifar10 AutoHS</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F10.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.11954/assets/x31.png" id="S5.F10.4.g1" class="ltx_graphics ltx_img_square" width="461" height="407" alt="Refer to caption">
<p id="S5.F10.4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F10.4.1.1" class="ltx_text">(a) FeMnist AutoCS</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F10.5" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.11954/assets/x32.png" id="S5.F10.5.g1" class="ltx_graphics ltx_img_square" width="461" height="407" alt="Refer to caption">
<p id="S5.F10.5.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F10.5.1.1" class="ltx_text">(b) FeMnist AutoSA</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F10.6" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:130.1pt;">
<img src="/html/2107.11954/assets/x33.png" id="S5.F10.6.g1" class="ltx_graphics ltx_img_square" width="461" height="417" alt="Refer to caption">
<p id="S5.F10.6.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F10.6.1.1" class="ltx_text">(c) FeMnist AutoHS</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10. </span><span id="S5.F10.8.1" class="ltx_text" style="font-size:90%;">Aggregation performances, personalization performances, and the change of combination coefficients in the learning process of proposed three automatical methods. The two rows show the results on FeCifar10 and FeMnist, respectively. In each row, the three figures denote the three proposed algorithms, i.e., AutoCS, AutoSA, and AutoHS. In each figure, the top shows the aggregation and personalization performances, i.e., the global and local accuracy, the bottom shows the change of coefficients.</span></figcaption>
</figure>
</section>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5. </span>Results of Automatical Algorithms</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">The above experimental studies investigate where to aggregate via enumerating possible privatization ways. In this section, we aim to automatically learn where to aggregate through a simple yet interesting interpolation trick and the proposed algorithms in Sect. <a href="#S4.SS3" title="4.3. Automatically Learn to Aggregate ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
<div id="S5.SS5.p2" class="ltx_para">
<p id="S5.SS5.p2.28" class="ltx_p">We first take the architecture of “AaBb” to aggregate a global model and learn private models for each client. The global model contains a global encoder <math id="S5.SS5.p2.1.m1.1" class="ltx_Math" alttext="E_{{\text{s}}}" display="inline"><semantics id="S5.SS5.p2.1.m1.1a"><msub id="S5.SS5.p2.1.m1.1.1" xref="S5.SS5.p2.1.m1.1.1.cmml"><mi id="S5.SS5.p2.1.m1.1.1.2" xref="S5.SS5.p2.1.m1.1.1.2.cmml">E</mi><mtext id="S5.SS5.p2.1.m1.1.1.3" xref="S5.SS5.p2.1.m1.1.1.3a.cmml">s</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.1.m1.1b"><apply id="S5.SS5.p2.1.m1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.1.m1.1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS5.p2.1.m1.1.1.2.cmml" xref="S5.SS5.p2.1.m1.1.1.2">𝐸</ci><ci id="S5.SS5.p2.1.m1.1.1.3a.cmml" xref="S5.SS5.p2.1.m1.1.1.3"><mtext mathsize="70%" id="S5.SS5.p2.1.m1.1.1.3.cmml" xref="S5.SS5.p2.1.m1.1.1.3">s</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.1.m1.1c">E_{{\text{s}}}</annotation></semantics></math> and a global classifier <math id="S5.SS5.p2.2.m2.1" class="ltx_Math" alttext="C_{{\text{s}}}" display="inline"><semantics id="S5.SS5.p2.2.m2.1a"><msub id="S5.SS5.p2.2.m2.1.1" xref="S5.SS5.p2.2.m2.1.1.cmml"><mi id="S5.SS5.p2.2.m2.1.1.2" xref="S5.SS5.p2.2.m2.1.1.2.cmml">C</mi><mtext id="S5.SS5.p2.2.m2.1.1.3" xref="S5.SS5.p2.2.m2.1.1.3a.cmml">s</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.2.m2.1b"><apply id="S5.SS5.p2.2.m2.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.2.m2.1.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS5.p2.2.m2.1.1.2.cmml" xref="S5.SS5.p2.2.m2.1.1.2">𝐶</ci><ci id="S5.SS5.p2.2.m2.1.1.3a.cmml" xref="S5.SS5.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S5.SS5.p2.2.m2.1.1.3.cmml" xref="S5.SS5.p2.2.m2.1.1.3">s</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.2.m2.1c">C_{{\text{s}}}</annotation></semantics></math>. For each client, it owns a local encoder <math id="S5.SS5.p2.3.m3.1" class="ltx_Math" alttext="E_{{\text{p}}}^{k}" display="inline"><semantics id="S5.SS5.p2.3.m3.1a"><msubsup id="S5.SS5.p2.3.m3.1.1" xref="S5.SS5.p2.3.m3.1.1.cmml"><mi id="S5.SS5.p2.3.m3.1.1.2.2" xref="S5.SS5.p2.3.m3.1.1.2.2.cmml">E</mi><mtext id="S5.SS5.p2.3.m3.1.1.2.3" xref="S5.SS5.p2.3.m3.1.1.2.3a.cmml">p</mtext><mi id="S5.SS5.p2.3.m3.1.1.3" xref="S5.SS5.p2.3.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.3.m3.1b"><apply id="S5.SS5.p2.3.m3.1.1.cmml" xref="S5.SS5.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.3.m3.1.1.1.cmml" xref="S5.SS5.p2.3.m3.1.1">superscript</csymbol><apply id="S5.SS5.p2.3.m3.1.1.2.cmml" xref="S5.SS5.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.3.m3.1.1.2.1.cmml" xref="S5.SS5.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS5.p2.3.m3.1.1.2.2.cmml" xref="S5.SS5.p2.3.m3.1.1.2.2">𝐸</ci><ci id="S5.SS5.p2.3.m3.1.1.2.3a.cmml" xref="S5.SS5.p2.3.m3.1.1.2.3"><mtext mathsize="70%" id="S5.SS5.p2.3.m3.1.1.2.3.cmml" xref="S5.SS5.p2.3.m3.1.1.2.3">p</mtext></ci></apply><ci id="S5.SS5.p2.3.m3.1.1.3.cmml" xref="S5.SS5.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.3.m3.1c">E_{{\text{p}}}^{k}</annotation></semantics></math> and a local classifier <math id="S5.SS5.p2.4.m4.1" class="ltx_Math" alttext="C_{{\text{p}}}^{k}" display="inline"><semantics id="S5.SS5.p2.4.m4.1a"><msubsup id="S5.SS5.p2.4.m4.1.1" xref="S5.SS5.p2.4.m4.1.1.cmml"><mi id="S5.SS5.p2.4.m4.1.1.2.2" xref="S5.SS5.p2.4.m4.1.1.2.2.cmml">C</mi><mtext id="S5.SS5.p2.4.m4.1.1.2.3" xref="S5.SS5.p2.4.m4.1.1.2.3a.cmml">p</mtext><mi id="S5.SS5.p2.4.m4.1.1.3" xref="S5.SS5.p2.4.m4.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.4.m4.1b"><apply id="S5.SS5.p2.4.m4.1.1.cmml" xref="S5.SS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.4.m4.1.1.1.cmml" xref="S5.SS5.p2.4.m4.1.1">superscript</csymbol><apply id="S5.SS5.p2.4.m4.1.1.2.cmml" xref="S5.SS5.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.4.m4.1.1.2.1.cmml" xref="S5.SS5.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS5.p2.4.m4.1.1.2.2.cmml" xref="S5.SS5.p2.4.m4.1.1.2.2">𝐶</ci><ci id="S5.SS5.p2.4.m4.1.1.2.3a.cmml" xref="S5.SS5.p2.4.m4.1.1.2.3"><mtext mathsize="70%" id="S5.SS5.p2.4.m4.1.1.2.3.cmml" xref="S5.SS5.p2.4.m4.1.1.2.3">p</mtext></ci></apply><ci id="S5.SS5.p2.4.m4.1.1.3.cmml" xref="S5.SS5.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.4.m4.1c">C_{{\text{p}}}^{k}</annotation></semantics></math>. We investigate the interpolations of shared and private features, shared and private outputs. Specifically, for each client, we can obtain the shared features <math id="S5.SS5.p2.5.m5.1" class="ltx_Math" alttext="{\mathbf{h}}_{{\text{s}}}^{k}" display="inline"><semantics id="S5.SS5.p2.5.m5.1a"><msubsup id="S5.SS5.p2.5.m5.1.1" xref="S5.SS5.p2.5.m5.1.1.cmml"><mi id="S5.SS5.p2.5.m5.1.1.2.2" xref="S5.SS5.p2.5.m5.1.1.2.2.cmml">𝐡</mi><mtext id="S5.SS5.p2.5.m5.1.1.2.3" xref="S5.SS5.p2.5.m5.1.1.2.3a.cmml">s</mtext><mi id="S5.SS5.p2.5.m5.1.1.3" xref="S5.SS5.p2.5.m5.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.5.m5.1b"><apply id="S5.SS5.p2.5.m5.1.1.cmml" xref="S5.SS5.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.5.m5.1.1.1.cmml" xref="S5.SS5.p2.5.m5.1.1">superscript</csymbol><apply id="S5.SS5.p2.5.m5.1.1.2.cmml" xref="S5.SS5.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.5.m5.1.1.2.1.cmml" xref="S5.SS5.p2.5.m5.1.1">subscript</csymbol><ci id="S5.SS5.p2.5.m5.1.1.2.2.cmml" xref="S5.SS5.p2.5.m5.1.1.2.2">𝐡</ci><ci id="S5.SS5.p2.5.m5.1.1.2.3a.cmml" xref="S5.SS5.p2.5.m5.1.1.2.3"><mtext mathsize="70%" id="S5.SS5.p2.5.m5.1.1.2.3.cmml" xref="S5.SS5.p2.5.m5.1.1.2.3">s</mtext></ci></apply><ci id="S5.SS5.p2.5.m5.1.1.3.cmml" xref="S5.SS5.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.5.m5.1c">{\mathbf{h}}_{{\text{s}}}^{k}</annotation></semantics></math> and private features <math id="S5.SS5.p2.6.m6.1" class="ltx_Math" alttext="{\mathbf{h}}_{{\text{p}}}^{k}" display="inline"><semantics id="S5.SS5.p2.6.m6.1a"><msubsup id="S5.SS5.p2.6.m6.1.1" xref="S5.SS5.p2.6.m6.1.1.cmml"><mi id="S5.SS5.p2.6.m6.1.1.2.2" xref="S5.SS5.p2.6.m6.1.1.2.2.cmml">𝐡</mi><mtext id="S5.SS5.p2.6.m6.1.1.2.3" xref="S5.SS5.p2.6.m6.1.1.2.3a.cmml">p</mtext><mi id="S5.SS5.p2.6.m6.1.1.3" xref="S5.SS5.p2.6.m6.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.6.m6.1b"><apply id="S5.SS5.p2.6.m6.1.1.cmml" xref="S5.SS5.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.6.m6.1.1.1.cmml" xref="S5.SS5.p2.6.m6.1.1">superscript</csymbol><apply id="S5.SS5.p2.6.m6.1.1.2.cmml" xref="S5.SS5.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.6.m6.1.1.2.1.cmml" xref="S5.SS5.p2.6.m6.1.1">subscript</csymbol><ci id="S5.SS5.p2.6.m6.1.1.2.2.cmml" xref="S5.SS5.p2.6.m6.1.1.2.2">𝐡</ci><ci id="S5.SS5.p2.6.m6.1.1.2.3a.cmml" xref="S5.SS5.p2.6.m6.1.1.2.3"><mtext mathsize="70%" id="S5.SS5.p2.6.m6.1.1.2.3.cmml" xref="S5.SS5.p2.6.m6.1.1.2.3">p</mtext></ci></apply><ci id="S5.SS5.p2.6.m6.1.1.3.cmml" xref="S5.SS5.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.6.m6.1c">{\mathbf{h}}_{{\text{p}}}^{k}</annotation></semantics></math> as in Eq. <a href="#S4.E6" title="In 4.3. Automatically Learn to Aggregate ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. We omit the index of samples for simplification. Then we get an interpolation of the features via <math id="S5.SS5.p2.7.m7.1" class="ltx_Math" alttext="\hat{{\mathbf{h}}}=\alpha{\mathbf{h}}_{{\text{s}}}^{k}+(1-\alpha){\mathbf{h}}_{{\text{p}}}^{k}" display="inline"><semantics id="S5.SS5.p2.7.m7.1a"><mrow id="S5.SS5.p2.7.m7.1.1" xref="S5.SS5.p2.7.m7.1.1.cmml"><mover accent="true" id="S5.SS5.p2.7.m7.1.1.3" xref="S5.SS5.p2.7.m7.1.1.3.cmml"><mi id="S5.SS5.p2.7.m7.1.1.3.2" xref="S5.SS5.p2.7.m7.1.1.3.2.cmml">𝐡</mi><mo id="S5.SS5.p2.7.m7.1.1.3.1" xref="S5.SS5.p2.7.m7.1.1.3.1.cmml">^</mo></mover><mo id="S5.SS5.p2.7.m7.1.1.2" xref="S5.SS5.p2.7.m7.1.1.2.cmml">=</mo><mrow id="S5.SS5.p2.7.m7.1.1.1" xref="S5.SS5.p2.7.m7.1.1.1.cmml"><mrow id="S5.SS5.p2.7.m7.1.1.1.3" xref="S5.SS5.p2.7.m7.1.1.1.3.cmml"><mi id="S5.SS5.p2.7.m7.1.1.1.3.2" xref="S5.SS5.p2.7.m7.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p2.7.m7.1.1.1.3.1" xref="S5.SS5.p2.7.m7.1.1.1.3.1.cmml">​</mo><msubsup id="S5.SS5.p2.7.m7.1.1.1.3.3" xref="S5.SS5.p2.7.m7.1.1.1.3.3.cmml"><mi id="S5.SS5.p2.7.m7.1.1.1.3.3.2.2" xref="S5.SS5.p2.7.m7.1.1.1.3.3.2.2.cmml">𝐡</mi><mtext id="S5.SS5.p2.7.m7.1.1.1.3.3.2.3" xref="S5.SS5.p2.7.m7.1.1.1.3.3.2.3a.cmml">s</mtext><mi id="S5.SS5.p2.7.m7.1.1.1.3.3.3" xref="S5.SS5.p2.7.m7.1.1.1.3.3.3.cmml">k</mi></msubsup></mrow><mo id="S5.SS5.p2.7.m7.1.1.1.2" xref="S5.SS5.p2.7.m7.1.1.1.2.cmml">+</mo><mrow id="S5.SS5.p2.7.m7.1.1.1.1" xref="S5.SS5.p2.7.m7.1.1.1.1.cmml"><mrow id="S5.SS5.p2.7.m7.1.1.1.1.1.1" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS5.p2.7.m7.1.1.1.1.1.1.2" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.cmml"><mn id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.2" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.1" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.3" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S5.SS5.p2.7.m7.1.1.1.1.1.1.3" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S5.SS5.p2.7.m7.1.1.1.1.2" xref="S5.SS5.p2.7.m7.1.1.1.1.2.cmml">​</mo><msubsup id="S5.SS5.p2.7.m7.1.1.1.1.3" xref="S5.SS5.p2.7.m7.1.1.1.1.3.cmml"><mi id="S5.SS5.p2.7.m7.1.1.1.1.3.2.2" xref="S5.SS5.p2.7.m7.1.1.1.1.3.2.2.cmml">𝐡</mi><mtext id="S5.SS5.p2.7.m7.1.1.1.1.3.2.3" xref="S5.SS5.p2.7.m7.1.1.1.1.3.2.3a.cmml">p</mtext><mi id="S5.SS5.p2.7.m7.1.1.1.1.3.3" xref="S5.SS5.p2.7.m7.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.7.m7.1b"><apply id="S5.SS5.p2.7.m7.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1"><eq id="S5.SS5.p2.7.m7.1.1.2.cmml" xref="S5.SS5.p2.7.m7.1.1.2"></eq><apply id="S5.SS5.p2.7.m7.1.1.3.cmml" xref="S5.SS5.p2.7.m7.1.1.3"><ci id="S5.SS5.p2.7.m7.1.1.3.1.cmml" xref="S5.SS5.p2.7.m7.1.1.3.1">^</ci><ci id="S5.SS5.p2.7.m7.1.1.3.2.cmml" xref="S5.SS5.p2.7.m7.1.1.3.2">𝐡</ci></apply><apply id="S5.SS5.p2.7.m7.1.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1"><plus id="S5.SS5.p2.7.m7.1.1.1.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.2"></plus><apply id="S5.SS5.p2.7.m7.1.1.1.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3"><times id="S5.SS5.p2.7.m7.1.1.1.3.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.1"></times><ci id="S5.SS5.p2.7.m7.1.1.1.3.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.2">𝛼</ci><apply id="S5.SS5.p2.7.m7.1.1.1.3.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS5.p2.7.m7.1.1.1.3.3.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.3">superscript</csymbol><apply id="S5.SS5.p2.7.m7.1.1.1.3.3.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS5.p2.7.m7.1.1.1.3.3.2.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.3">subscript</csymbol><ci id="S5.SS5.p2.7.m7.1.1.1.3.3.2.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.3.2.2">𝐡</ci><ci id="S5.SS5.p2.7.m7.1.1.1.3.3.2.3a.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.3.2.3"><mtext mathsize="70%" id="S5.SS5.p2.7.m7.1.1.1.3.3.2.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.3.2.3">s</mtext></ci></apply><ci id="S5.SS5.p2.7.m7.1.1.1.3.3.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S5.SS5.p2.7.m7.1.1.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1"><times id="S5.SS5.p2.7.m7.1.1.1.1.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.2"></times><apply id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1"><minus id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.2">1</cn><ci id="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S5.SS5.p2.7.m7.1.1.1.1.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS5.p2.7.m7.1.1.1.1.3.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.3">superscript</csymbol><apply id="S5.SS5.p2.7.m7.1.1.1.1.3.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS5.p2.7.m7.1.1.1.1.3.2.1.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.3">subscript</csymbol><ci id="S5.SS5.p2.7.m7.1.1.1.1.3.2.2.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.3.2.2">𝐡</ci><ci id="S5.SS5.p2.7.m7.1.1.1.1.3.2.3a.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S5.SS5.p2.7.m7.1.1.1.1.3.2.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.3.2.3">p</mtext></ci></apply><ci id="S5.SS5.p2.7.m7.1.1.1.1.3.3.cmml" xref="S5.SS5.p2.7.m7.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.7.m7.1c">\hat{{\mathbf{h}}}=\alpha{\mathbf{h}}_{{\text{s}}}^{k}+(1-\alpha){\mathbf{h}}_{{\text{p}}}^{k}</annotation></semantics></math>. Next, we obtain predictions via feeding <math id="S5.SS5.p2.8.m8.1" class="ltx_Math" alttext="\hat{{\mathbf{h}}}" display="inline"><semantics id="S5.SS5.p2.8.m8.1a"><mover accent="true" id="S5.SS5.p2.8.m8.1.1" xref="S5.SS5.p2.8.m8.1.1.cmml"><mi id="S5.SS5.p2.8.m8.1.1.2" xref="S5.SS5.p2.8.m8.1.1.2.cmml">𝐡</mi><mo id="S5.SS5.p2.8.m8.1.1.1" xref="S5.SS5.p2.8.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.8.m8.1b"><apply id="S5.SS5.p2.8.m8.1.1.cmml" xref="S5.SS5.p2.8.m8.1.1"><ci id="S5.SS5.p2.8.m8.1.1.1.cmml" xref="S5.SS5.p2.8.m8.1.1.1">^</ci><ci id="S5.SS5.p2.8.m8.1.1.2.cmml" xref="S5.SS5.p2.8.m8.1.1.2">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.8.m8.1c">\hat{{\mathbf{h}}}</annotation></semantics></math> into both <math id="S5.SS5.p2.9.m9.1" class="ltx_Math" alttext="C_{{\text{s}}}" display="inline"><semantics id="S5.SS5.p2.9.m9.1a"><msub id="S5.SS5.p2.9.m9.1.1" xref="S5.SS5.p2.9.m9.1.1.cmml"><mi id="S5.SS5.p2.9.m9.1.1.2" xref="S5.SS5.p2.9.m9.1.1.2.cmml">C</mi><mtext id="S5.SS5.p2.9.m9.1.1.3" xref="S5.SS5.p2.9.m9.1.1.3a.cmml">s</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.9.m9.1b"><apply id="S5.SS5.p2.9.m9.1.1.cmml" xref="S5.SS5.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.9.m9.1.1.1.cmml" xref="S5.SS5.p2.9.m9.1.1">subscript</csymbol><ci id="S5.SS5.p2.9.m9.1.1.2.cmml" xref="S5.SS5.p2.9.m9.1.1.2">𝐶</ci><ci id="S5.SS5.p2.9.m9.1.1.3a.cmml" xref="S5.SS5.p2.9.m9.1.1.3"><mtext mathsize="70%" id="S5.SS5.p2.9.m9.1.1.3.cmml" xref="S5.SS5.p2.9.m9.1.1.3">s</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.9.m9.1c">C_{{\text{s}}}</annotation></semantics></math> and <math id="S5.SS5.p2.10.m10.1" class="ltx_Math" alttext="C_{{\text{p}}}^{k}" display="inline"><semantics id="S5.SS5.p2.10.m10.1a"><msubsup id="S5.SS5.p2.10.m10.1.1" xref="S5.SS5.p2.10.m10.1.1.cmml"><mi id="S5.SS5.p2.10.m10.1.1.2.2" xref="S5.SS5.p2.10.m10.1.1.2.2.cmml">C</mi><mtext id="S5.SS5.p2.10.m10.1.1.2.3" xref="S5.SS5.p2.10.m10.1.1.2.3a.cmml">p</mtext><mi id="S5.SS5.p2.10.m10.1.1.3" xref="S5.SS5.p2.10.m10.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.10.m10.1b"><apply id="S5.SS5.p2.10.m10.1.1.cmml" xref="S5.SS5.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.10.m10.1.1.1.cmml" xref="S5.SS5.p2.10.m10.1.1">superscript</csymbol><apply id="S5.SS5.p2.10.m10.1.1.2.cmml" xref="S5.SS5.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.10.m10.1.1.2.1.cmml" xref="S5.SS5.p2.10.m10.1.1">subscript</csymbol><ci id="S5.SS5.p2.10.m10.1.1.2.2.cmml" xref="S5.SS5.p2.10.m10.1.1.2.2">𝐶</ci><ci id="S5.SS5.p2.10.m10.1.1.2.3a.cmml" xref="S5.SS5.p2.10.m10.1.1.2.3"><mtext mathsize="70%" id="S5.SS5.p2.10.m10.1.1.2.3.cmml" xref="S5.SS5.p2.10.m10.1.1.2.3">p</mtext></ci></apply><ci id="S5.SS5.p2.10.m10.1.1.3.cmml" xref="S5.SS5.p2.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.10.m10.1c">C_{{\text{p}}}^{k}</annotation></semantics></math>, and we denote the probabilities (i.e., predictions after softmax) as <math id="S5.SS5.p2.11.m11.1" class="ltx_Math" alttext="{\mathbf{p}}_{{\text{s}}}^{k}" display="inline"><semantics id="S5.SS5.p2.11.m11.1a"><msubsup id="S5.SS5.p2.11.m11.1.1" xref="S5.SS5.p2.11.m11.1.1.cmml"><mi id="S5.SS5.p2.11.m11.1.1.2.2" xref="S5.SS5.p2.11.m11.1.1.2.2.cmml">𝐩</mi><mtext id="S5.SS5.p2.11.m11.1.1.2.3" xref="S5.SS5.p2.11.m11.1.1.2.3a.cmml">s</mtext><mi id="S5.SS5.p2.11.m11.1.1.3" xref="S5.SS5.p2.11.m11.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.11.m11.1b"><apply id="S5.SS5.p2.11.m11.1.1.cmml" xref="S5.SS5.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.11.m11.1.1.1.cmml" xref="S5.SS5.p2.11.m11.1.1">superscript</csymbol><apply id="S5.SS5.p2.11.m11.1.1.2.cmml" xref="S5.SS5.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.11.m11.1.1.2.1.cmml" xref="S5.SS5.p2.11.m11.1.1">subscript</csymbol><ci id="S5.SS5.p2.11.m11.1.1.2.2.cmml" xref="S5.SS5.p2.11.m11.1.1.2.2">𝐩</ci><ci id="S5.SS5.p2.11.m11.1.1.2.3a.cmml" xref="S5.SS5.p2.11.m11.1.1.2.3"><mtext mathsize="70%" id="S5.SS5.p2.11.m11.1.1.2.3.cmml" xref="S5.SS5.p2.11.m11.1.1.2.3">s</mtext></ci></apply><ci id="S5.SS5.p2.11.m11.1.1.3.cmml" xref="S5.SS5.p2.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.11.m11.1c">{\mathbf{p}}_{{\text{s}}}^{k}</annotation></semantics></math> and <math id="S5.SS5.p2.12.m12.1" class="ltx_Math" alttext="{\mathbf{p}}_{{\text{p}}}^{k}" display="inline"><semantics id="S5.SS5.p2.12.m12.1a"><msubsup id="S5.SS5.p2.12.m12.1.1" xref="S5.SS5.p2.12.m12.1.1.cmml"><mi id="S5.SS5.p2.12.m12.1.1.2.2" xref="S5.SS5.p2.12.m12.1.1.2.2.cmml">𝐩</mi><mtext id="S5.SS5.p2.12.m12.1.1.2.3" xref="S5.SS5.p2.12.m12.1.1.2.3a.cmml">p</mtext><mi id="S5.SS5.p2.12.m12.1.1.3" xref="S5.SS5.p2.12.m12.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.12.m12.1b"><apply id="S5.SS5.p2.12.m12.1.1.cmml" xref="S5.SS5.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.12.m12.1.1.1.cmml" xref="S5.SS5.p2.12.m12.1.1">superscript</csymbol><apply id="S5.SS5.p2.12.m12.1.1.2.cmml" xref="S5.SS5.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS5.p2.12.m12.1.1.2.1.cmml" xref="S5.SS5.p2.12.m12.1.1">subscript</csymbol><ci id="S5.SS5.p2.12.m12.1.1.2.2.cmml" xref="S5.SS5.p2.12.m12.1.1.2.2">𝐩</ci><ci id="S5.SS5.p2.12.m12.1.1.2.3a.cmml" xref="S5.SS5.p2.12.m12.1.1.2.3"><mtext mathsize="70%" id="S5.SS5.p2.12.m12.1.1.2.3.cmml" xref="S5.SS5.p2.12.m12.1.1.2.3">p</mtext></ci></apply><ci id="S5.SS5.p2.12.m12.1.1.3.cmml" xref="S5.SS5.p2.12.m12.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.12.m12.1c">{\mathbf{p}}_{{\text{p}}}^{k}</annotation></semantics></math>. We also take an interpolation via <math id="S5.SS5.p2.13.m13.1" class="ltx_Math" alttext="\hat{{\mathbf{p}}}=\beta{\mathbf{p}}_{{\text{s}}}^{k}+(1-\beta){\mathbf{p}}_{{\text{p}}}^{k}" display="inline"><semantics id="S5.SS5.p2.13.m13.1a"><mrow id="S5.SS5.p2.13.m13.1.1" xref="S5.SS5.p2.13.m13.1.1.cmml"><mover accent="true" id="S5.SS5.p2.13.m13.1.1.3" xref="S5.SS5.p2.13.m13.1.1.3.cmml"><mi id="S5.SS5.p2.13.m13.1.1.3.2" xref="S5.SS5.p2.13.m13.1.1.3.2.cmml">𝐩</mi><mo id="S5.SS5.p2.13.m13.1.1.3.1" xref="S5.SS5.p2.13.m13.1.1.3.1.cmml">^</mo></mover><mo id="S5.SS5.p2.13.m13.1.1.2" xref="S5.SS5.p2.13.m13.1.1.2.cmml">=</mo><mrow id="S5.SS5.p2.13.m13.1.1.1" xref="S5.SS5.p2.13.m13.1.1.1.cmml"><mrow id="S5.SS5.p2.13.m13.1.1.1.3" xref="S5.SS5.p2.13.m13.1.1.1.3.cmml"><mi id="S5.SS5.p2.13.m13.1.1.1.3.2" xref="S5.SS5.p2.13.m13.1.1.1.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p2.13.m13.1.1.1.3.1" xref="S5.SS5.p2.13.m13.1.1.1.3.1.cmml">​</mo><msubsup id="S5.SS5.p2.13.m13.1.1.1.3.3" xref="S5.SS5.p2.13.m13.1.1.1.3.3.cmml"><mi id="S5.SS5.p2.13.m13.1.1.1.3.3.2.2" xref="S5.SS5.p2.13.m13.1.1.1.3.3.2.2.cmml">𝐩</mi><mtext id="S5.SS5.p2.13.m13.1.1.1.3.3.2.3" xref="S5.SS5.p2.13.m13.1.1.1.3.3.2.3a.cmml">s</mtext><mi id="S5.SS5.p2.13.m13.1.1.1.3.3.3" xref="S5.SS5.p2.13.m13.1.1.1.3.3.3.cmml">k</mi></msubsup></mrow><mo id="S5.SS5.p2.13.m13.1.1.1.2" xref="S5.SS5.p2.13.m13.1.1.1.2.cmml">+</mo><mrow id="S5.SS5.p2.13.m13.1.1.1.1" xref="S5.SS5.p2.13.m13.1.1.1.1.cmml"><mrow id="S5.SS5.p2.13.m13.1.1.1.1.1.1" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS5.p2.13.m13.1.1.1.1.1.1.2" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS5.p2.13.m13.1.1.1.1.1.1.1" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.cmml"><mn id="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.2" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.1" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.3" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S5.SS5.p2.13.m13.1.1.1.1.1.1.3" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S5.SS5.p2.13.m13.1.1.1.1.2" xref="S5.SS5.p2.13.m13.1.1.1.1.2.cmml">​</mo><msubsup id="S5.SS5.p2.13.m13.1.1.1.1.3" xref="S5.SS5.p2.13.m13.1.1.1.1.3.cmml"><mi id="S5.SS5.p2.13.m13.1.1.1.1.3.2.2" xref="S5.SS5.p2.13.m13.1.1.1.1.3.2.2.cmml">𝐩</mi><mtext id="S5.SS5.p2.13.m13.1.1.1.1.3.2.3" xref="S5.SS5.p2.13.m13.1.1.1.1.3.2.3a.cmml">p</mtext><mi id="S5.SS5.p2.13.m13.1.1.1.1.3.3" xref="S5.SS5.p2.13.m13.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.13.m13.1b"><apply id="S5.SS5.p2.13.m13.1.1.cmml" xref="S5.SS5.p2.13.m13.1.1"><eq id="S5.SS5.p2.13.m13.1.1.2.cmml" xref="S5.SS5.p2.13.m13.1.1.2"></eq><apply id="S5.SS5.p2.13.m13.1.1.3.cmml" xref="S5.SS5.p2.13.m13.1.1.3"><ci id="S5.SS5.p2.13.m13.1.1.3.1.cmml" xref="S5.SS5.p2.13.m13.1.1.3.1">^</ci><ci id="S5.SS5.p2.13.m13.1.1.3.2.cmml" xref="S5.SS5.p2.13.m13.1.1.3.2">𝐩</ci></apply><apply id="S5.SS5.p2.13.m13.1.1.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1"><plus id="S5.SS5.p2.13.m13.1.1.1.2.cmml" xref="S5.SS5.p2.13.m13.1.1.1.2"></plus><apply id="S5.SS5.p2.13.m13.1.1.1.3.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3"><times id="S5.SS5.p2.13.m13.1.1.1.3.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.1"></times><ci id="S5.SS5.p2.13.m13.1.1.1.3.2.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.2">𝛽</ci><apply id="S5.SS5.p2.13.m13.1.1.1.3.3.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS5.p2.13.m13.1.1.1.3.3.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.3">superscript</csymbol><apply id="S5.SS5.p2.13.m13.1.1.1.3.3.2.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS5.p2.13.m13.1.1.1.3.3.2.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.3">subscript</csymbol><ci id="S5.SS5.p2.13.m13.1.1.1.3.3.2.2.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.3.2.2">𝐩</ci><ci id="S5.SS5.p2.13.m13.1.1.1.3.3.2.3a.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.3.2.3"><mtext mathsize="70%" id="S5.SS5.p2.13.m13.1.1.1.3.3.2.3.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.3.2.3">s</mtext></ci></apply><ci id="S5.SS5.p2.13.m13.1.1.1.3.3.3.cmml" xref="S5.SS5.p2.13.m13.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S5.SS5.p2.13.m13.1.1.1.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1"><times id="S5.SS5.p2.13.m13.1.1.1.1.2.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.2"></times><apply id="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1"><minus id="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.2.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.2">1</cn><ci id="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.3.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.1.1.1.3">𝛽</ci></apply><apply id="S5.SS5.p2.13.m13.1.1.1.1.3.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS5.p2.13.m13.1.1.1.1.3.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.3">superscript</csymbol><apply id="S5.SS5.p2.13.m13.1.1.1.1.3.2.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS5.p2.13.m13.1.1.1.1.3.2.1.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.3">subscript</csymbol><ci id="S5.SS5.p2.13.m13.1.1.1.1.3.2.2.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.3.2.2">𝐩</ci><ci id="S5.SS5.p2.13.m13.1.1.1.1.3.2.3a.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S5.SS5.p2.13.m13.1.1.1.1.3.2.3.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.3.2.3">p</mtext></ci></apply><ci id="S5.SS5.p2.13.m13.1.1.1.1.3.3.cmml" xref="S5.SS5.p2.13.m13.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.13.m13.1c">\hat{{\mathbf{p}}}=\beta{\mathbf{p}}_{{\text{s}}}^{k}+(1-\beta){\mathbf{p}}_{{\text{p}}}^{k}</annotation></semantics></math>. Finally, we calculate the personalization accuracy via the predicted <math id="S5.SS5.p2.14.m14.1" class="ltx_Math" alttext="\hat{{\mathbf{p}}}" display="inline"><semantics id="S5.SS5.p2.14.m14.1a"><mover accent="true" id="S5.SS5.p2.14.m14.1.1" xref="S5.SS5.p2.14.m14.1.1.cmml"><mi id="S5.SS5.p2.14.m14.1.1.2" xref="S5.SS5.p2.14.m14.1.1.2.cmml">𝐩</mi><mo id="S5.SS5.p2.14.m14.1.1.1" xref="S5.SS5.p2.14.m14.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.14.m14.1b"><apply id="S5.SS5.p2.14.m14.1.1.cmml" xref="S5.SS5.p2.14.m14.1.1"><ci id="S5.SS5.p2.14.m14.1.1.1.cmml" xref="S5.SS5.p2.14.m14.1.1.1">^</ci><ci id="S5.SS5.p2.14.m14.1.1.2.cmml" xref="S5.SS5.p2.14.m14.1.1.2">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.14.m14.1c">\hat{{\mathbf{p}}}</annotation></semantics></math> and the real labels. Varying <math id="S5.SS5.p2.15.m15.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="S5.SS5.p2.15.m15.2a"><mrow id="S5.SS5.p2.15.m15.2.3" xref="S5.SS5.p2.15.m15.2.3.cmml"><mi id="S5.SS5.p2.15.m15.2.3.2" xref="S5.SS5.p2.15.m15.2.3.2.cmml">α</mi><mo id="S5.SS5.p2.15.m15.2.3.1" xref="S5.SS5.p2.15.m15.2.3.1.cmml">∈</mo><mrow id="S5.SS5.p2.15.m15.2.3.3.2" xref="S5.SS5.p2.15.m15.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS5.p2.15.m15.2.3.3.2.1" xref="S5.SS5.p2.15.m15.2.3.3.1.cmml">[</mo><mn id="S5.SS5.p2.15.m15.1.1" xref="S5.SS5.p2.15.m15.1.1.cmml">0</mn><mo id="S5.SS5.p2.15.m15.2.3.3.2.2" xref="S5.SS5.p2.15.m15.2.3.3.1.cmml">,</mo><mn id="S5.SS5.p2.15.m15.2.2" xref="S5.SS5.p2.15.m15.2.2.cmml">1</mn><mo stretchy="false" id="S5.SS5.p2.15.m15.2.3.3.2.3" xref="S5.SS5.p2.15.m15.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.15.m15.2b"><apply id="S5.SS5.p2.15.m15.2.3.cmml" xref="S5.SS5.p2.15.m15.2.3"><in id="S5.SS5.p2.15.m15.2.3.1.cmml" xref="S5.SS5.p2.15.m15.2.3.1"></in><ci id="S5.SS5.p2.15.m15.2.3.2.cmml" xref="S5.SS5.p2.15.m15.2.3.2">𝛼</ci><interval closure="closed" id="S5.SS5.p2.15.m15.2.3.3.1.cmml" xref="S5.SS5.p2.15.m15.2.3.3.2"><cn type="integer" id="S5.SS5.p2.15.m15.1.1.cmml" xref="S5.SS5.p2.15.m15.1.1">0</cn><cn type="integer" id="S5.SS5.p2.15.m15.2.2.cmml" xref="S5.SS5.p2.15.m15.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.15.m15.2c">\alpha\in[0,1]</annotation></semantics></math> and <math id="S5.SS5.p2.16.m16.2" class="ltx_Math" alttext="\beta\in[0,1]" display="inline"><semantics id="S5.SS5.p2.16.m16.2a"><mrow id="S5.SS5.p2.16.m16.2.3" xref="S5.SS5.p2.16.m16.2.3.cmml"><mi id="S5.SS5.p2.16.m16.2.3.2" xref="S5.SS5.p2.16.m16.2.3.2.cmml">β</mi><mo id="S5.SS5.p2.16.m16.2.3.1" xref="S5.SS5.p2.16.m16.2.3.1.cmml">∈</mo><mrow id="S5.SS5.p2.16.m16.2.3.3.2" xref="S5.SS5.p2.16.m16.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS5.p2.16.m16.2.3.3.2.1" xref="S5.SS5.p2.16.m16.2.3.3.1.cmml">[</mo><mn id="S5.SS5.p2.16.m16.1.1" xref="S5.SS5.p2.16.m16.1.1.cmml">0</mn><mo id="S5.SS5.p2.16.m16.2.3.3.2.2" xref="S5.SS5.p2.16.m16.2.3.3.1.cmml">,</mo><mn id="S5.SS5.p2.16.m16.2.2" xref="S5.SS5.p2.16.m16.2.2.cmml">1</mn><mo stretchy="false" id="S5.SS5.p2.16.m16.2.3.3.2.3" xref="S5.SS5.p2.16.m16.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.16.m16.2b"><apply id="S5.SS5.p2.16.m16.2.3.cmml" xref="S5.SS5.p2.16.m16.2.3"><in id="S5.SS5.p2.16.m16.2.3.1.cmml" xref="S5.SS5.p2.16.m16.2.3.1"></in><ci id="S5.SS5.p2.16.m16.2.3.2.cmml" xref="S5.SS5.p2.16.m16.2.3.2">𝛽</ci><interval closure="closed" id="S5.SS5.p2.16.m16.2.3.3.1.cmml" xref="S5.SS5.p2.16.m16.2.3.3.2"><cn type="integer" id="S5.SS5.p2.16.m16.1.1.cmml" xref="S5.SS5.p2.16.m16.1.1">0</cn><cn type="integer" id="S5.SS5.p2.16.m16.2.2.cmml" xref="S5.SS5.p2.16.m16.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.16.m16.2c">\beta\in[0,1]</annotation></semantics></math>, we can obtain the performances of different privatization ways in a post-processing manner. For example, if <math id="S5.SS5.p2.17.m17.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S5.SS5.p2.17.m17.1a"><mrow id="S5.SS5.p2.17.m17.1.1" xref="S5.SS5.p2.17.m17.1.1.cmml"><mi id="S5.SS5.p2.17.m17.1.1.2" xref="S5.SS5.p2.17.m17.1.1.2.cmml">α</mi><mo id="S5.SS5.p2.17.m17.1.1.1" xref="S5.SS5.p2.17.m17.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.17.m17.1.1.3" xref="S5.SS5.p2.17.m17.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.17.m17.1b"><apply id="S5.SS5.p2.17.m17.1.1.cmml" xref="S5.SS5.p2.17.m17.1.1"><eq id="S5.SS5.p2.17.m17.1.1.1.cmml" xref="S5.SS5.p2.17.m17.1.1.1"></eq><ci id="S5.SS5.p2.17.m17.1.1.2.cmml" xref="S5.SS5.p2.17.m17.1.1.2">𝛼</ci><cn type="float" id="S5.SS5.p2.17.m17.1.1.3.cmml" xref="S5.SS5.p2.17.m17.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.17.m17.1c">\alpha=1.0</annotation></semantics></math> and <math id="S5.SS5.p2.18.m18.1" class="ltx_Math" alttext="\beta=1.0" display="inline"><semantics id="S5.SS5.p2.18.m18.1a"><mrow id="S5.SS5.p2.18.m18.1.1" xref="S5.SS5.p2.18.m18.1.1.cmml"><mi id="S5.SS5.p2.18.m18.1.1.2" xref="S5.SS5.p2.18.m18.1.1.2.cmml">β</mi><mo id="S5.SS5.p2.18.m18.1.1.1" xref="S5.SS5.p2.18.m18.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.18.m18.1.1.3" xref="S5.SS5.p2.18.m18.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.18.m18.1b"><apply id="S5.SS5.p2.18.m18.1.1.cmml" xref="S5.SS5.p2.18.m18.1.1"><eq id="S5.SS5.p2.18.m18.1.1.1.cmml" xref="S5.SS5.p2.18.m18.1.1.1"></eq><ci id="S5.SS5.p2.18.m18.1.1.2.cmml" xref="S5.SS5.p2.18.m18.1.1.2">𝛽</ci><cn type="float" id="S5.SS5.p2.18.m18.1.1.3.cmml" xref="S5.SS5.p2.18.m18.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.18.m18.1c">\beta=1.0</annotation></semantics></math>, it degenerates into the “AB” way. We plot the personalization results in Fig. <a href="#S5.F9" title="Figure 9 ‣ 5.4.2. Fine-grained Privatization ‣ 5.4. Results of Different Privatization Ways ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, and the results are evaluated as in Def. <a href="#S3.Thmtheorem3" title="Definition 3.3 (Goal of Personalization in FL). ‣ 3.2. Goals of Aggregation and Personalization ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. For FeMnist, we take a non-uniform change of <math id="S5.SS5.p2.19.m19.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS5.p2.19.m19.1a"><mi id="S5.SS5.p2.19.m19.1.1" xref="S5.SS5.p2.19.m19.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.19.m19.1b"><ci id="S5.SS5.p2.19.m19.1.1.cmml" xref="S5.SS5.p2.19.m19.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.19.m19.1c">\alpha</annotation></semantics></math> and <math id="S5.SS5.p2.20.m20.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS5.p2.20.m20.1a"><mi id="S5.SS5.p2.20.m20.1.1" xref="S5.SS5.p2.20.m20.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.20.m20.1b"><ci id="S5.SS5.p2.20.m20.1.1.cmml" xref="S5.SS5.p2.20.m20.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.20.m20.1c">\beta</annotation></semantics></math> to better show the change of results. For FeCifar10, the best interpolation lies around <math id="S5.SS5.p2.21.m21.1" class="ltx_Math" alttext="\alpha=0.8" display="inline"><semantics id="S5.SS5.p2.21.m21.1a"><mrow id="S5.SS5.p2.21.m21.1.1" xref="S5.SS5.p2.21.m21.1.1.cmml"><mi id="S5.SS5.p2.21.m21.1.1.2" xref="S5.SS5.p2.21.m21.1.1.2.cmml">α</mi><mo id="S5.SS5.p2.21.m21.1.1.1" xref="S5.SS5.p2.21.m21.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.21.m21.1.1.3" xref="S5.SS5.p2.21.m21.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.21.m21.1b"><apply id="S5.SS5.p2.21.m21.1.1.cmml" xref="S5.SS5.p2.21.m21.1.1"><eq id="S5.SS5.p2.21.m21.1.1.1.cmml" xref="S5.SS5.p2.21.m21.1.1.1"></eq><ci id="S5.SS5.p2.21.m21.1.1.2.cmml" xref="S5.SS5.p2.21.m21.1.1.2">𝛼</ci><cn type="float" id="S5.SS5.p2.21.m21.1.1.3.cmml" xref="S5.SS5.p2.21.m21.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.21.m21.1c">\alpha=0.8</annotation></semantics></math> and <math id="S5.SS5.p2.22.m22.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S5.SS5.p2.22.m22.1a"><mrow id="S5.SS5.p2.22.m22.1.1" xref="S5.SS5.p2.22.m22.1.1.cmml"><mi id="S5.SS5.p2.22.m22.1.1.2" xref="S5.SS5.p2.22.m22.1.1.2.cmml">β</mi><mo id="S5.SS5.p2.22.m22.1.1.1" xref="S5.SS5.p2.22.m22.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.22.m22.1.1.3" xref="S5.SS5.p2.22.m22.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.22.m22.1b"><apply id="S5.SS5.p2.22.m22.1.1.cmml" xref="S5.SS5.p2.22.m22.1.1"><eq id="S5.SS5.p2.22.m22.1.1.1.cmml" xref="S5.SS5.p2.22.m22.1.1.1"></eq><ci id="S5.SS5.p2.22.m22.1.1.2.cmml" xref="S5.SS5.p2.22.m22.1.1.2">𝛽</ci><cn type="float" id="S5.SS5.p2.22.m22.1.1.3.cmml" xref="S5.SS5.p2.22.m22.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.22.m22.1c">\beta=0.5</annotation></semantics></math>; for FeCifar100, the best one lies around <math id="S5.SS5.p2.23.m23.1" class="ltx_Math" alttext="\alpha=0.7" display="inline"><semantics id="S5.SS5.p2.23.m23.1a"><mrow id="S5.SS5.p2.23.m23.1.1" xref="S5.SS5.p2.23.m23.1.1.cmml"><mi id="S5.SS5.p2.23.m23.1.1.2" xref="S5.SS5.p2.23.m23.1.1.2.cmml">α</mi><mo id="S5.SS5.p2.23.m23.1.1.1" xref="S5.SS5.p2.23.m23.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.23.m23.1.1.3" xref="S5.SS5.p2.23.m23.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.23.m23.1b"><apply id="S5.SS5.p2.23.m23.1.1.cmml" xref="S5.SS5.p2.23.m23.1.1"><eq id="S5.SS5.p2.23.m23.1.1.1.cmml" xref="S5.SS5.p2.23.m23.1.1.1"></eq><ci id="S5.SS5.p2.23.m23.1.1.2.cmml" xref="S5.SS5.p2.23.m23.1.1.2">𝛼</ci><cn type="float" id="S5.SS5.p2.23.m23.1.1.3.cmml" xref="S5.SS5.p2.23.m23.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.23.m23.1c">\alpha=0.7</annotation></semantics></math> and <math id="S5.SS5.p2.24.m24.1" class="ltx_Math" alttext="\beta=0.6" display="inline"><semantics id="S5.SS5.p2.24.m24.1a"><mrow id="S5.SS5.p2.24.m24.1.1" xref="S5.SS5.p2.24.m24.1.1.cmml"><mi id="S5.SS5.p2.24.m24.1.1.2" xref="S5.SS5.p2.24.m24.1.1.2.cmml">β</mi><mo id="S5.SS5.p2.24.m24.1.1.1" xref="S5.SS5.p2.24.m24.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.24.m24.1.1.3" xref="S5.SS5.p2.24.m24.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.24.m24.1b"><apply id="S5.SS5.p2.24.m24.1.1.cmml" xref="S5.SS5.p2.24.m24.1.1"><eq id="S5.SS5.p2.24.m24.1.1.1.cmml" xref="S5.SS5.p2.24.m24.1.1.1"></eq><ci id="S5.SS5.p2.24.m24.1.1.2.cmml" xref="S5.SS5.p2.24.m24.1.1.2">𝛽</ci><cn type="float" id="S5.SS5.p2.24.m24.1.1.3.cmml" xref="S5.SS5.p2.24.m24.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.24.m24.1c">\beta=0.6</annotation></semantics></math>. Hence, these two scenes show that taking both the combinations of encoders and classifiers is preferred, which conforms to the results in Sect. <a href="#S5.SS4.SSS1" title="5.4.1. Coarse-grained Privatization ‣ 5.4. Results of Different Privatization Ways ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4.1</span></a> that fusing features (i.e., “AaB”) or fusing outputs (i.e., “ABb”) could improve the FL performances. For Shakespeare, setting <math id="S5.SS5.p2.25.m25.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S5.SS5.p2.25.m25.1a"><mrow id="S5.SS5.p2.25.m25.1.1" xref="S5.SS5.p2.25.m25.1.1.cmml"><mi id="S5.SS5.p2.25.m25.1.1.2" xref="S5.SS5.p2.25.m25.1.1.2.cmml">α</mi><mo id="S5.SS5.p2.25.m25.1.1.1" xref="S5.SS5.p2.25.m25.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.25.m25.1.1.3" xref="S5.SS5.p2.25.m25.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.25.m25.1b"><apply id="S5.SS5.p2.25.m25.1.1.cmml" xref="S5.SS5.p2.25.m25.1.1"><eq id="S5.SS5.p2.25.m25.1.1.1.cmml" xref="S5.SS5.p2.25.m25.1.1.1"></eq><ci id="S5.SS5.p2.25.m25.1.1.2.cmml" xref="S5.SS5.p2.25.m25.1.1.2">𝛼</ci><cn type="float" id="S5.SS5.p2.25.m25.1.1.3.cmml" xref="S5.SS5.p2.25.m25.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.25.m25.1c">\alpha=1.0</annotation></semantics></math> and <math id="S5.SS5.p2.26.m26.1" class="ltx_Math" alttext="\beta=1.0" display="inline"><semantics id="S5.SS5.p2.26.m26.1a"><mrow id="S5.SS5.p2.26.m26.1.1" xref="S5.SS5.p2.26.m26.1.1.cmml"><mi id="S5.SS5.p2.26.m26.1.1.2" xref="S5.SS5.p2.26.m26.1.1.2.cmml">β</mi><mo id="S5.SS5.p2.26.m26.1.1.1" xref="S5.SS5.p2.26.m26.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.26.m26.1.1.3" xref="S5.SS5.p2.26.m26.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.26.m26.1b"><apply id="S5.SS5.p2.26.m26.1.1.cmml" xref="S5.SS5.p2.26.m26.1.1"><eq id="S5.SS5.p2.26.m26.1.1.1.cmml" xref="S5.SS5.p2.26.m26.1.1.1"></eq><ci id="S5.SS5.p2.26.m26.1.1.2.cmml" xref="S5.SS5.p2.26.m26.1.1.2">𝛽</ci><cn type="float" id="S5.SS5.p2.26.m26.1.1.3.cmml" xref="S5.SS5.p2.26.m26.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.26.m26.1c">\beta=1.0</annotation></semantics></math> can obtain the best results, which again verifies that taking no private components on Shakespeare is more suitable. For FeMnist, setting <math id="S5.SS5.p2.27.m27.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S5.SS5.p2.27.m27.1a"><mrow id="S5.SS5.p2.27.m27.1.1" xref="S5.SS5.p2.27.m27.1.1.cmml"><mi id="S5.SS5.p2.27.m27.1.1.2" xref="S5.SS5.p2.27.m27.1.1.2.cmml">α</mi><mo id="S5.SS5.p2.27.m27.1.1.1" xref="S5.SS5.p2.27.m27.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.27.m27.1.1.3" xref="S5.SS5.p2.27.m27.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.27.m27.1b"><apply id="S5.SS5.p2.27.m27.1.1.cmml" xref="S5.SS5.p2.27.m27.1.1"><eq id="S5.SS5.p2.27.m27.1.1.1.cmml" xref="S5.SS5.p2.27.m27.1.1.1"></eq><ci id="S5.SS5.p2.27.m27.1.1.2.cmml" xref="S5.SS5.p2.27.m27.1.1.2">𝛼</ci><cn type="float" id="S5.SS5.p2.27.m27.1.1.3.cmml" xref="S5.SS5.p2.27.m27.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.27.m27.1c">\alpha=1.0</annotation></semantics></math> and <math id="S5.SS5.p2.28.m28.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S5.SS5.p2.28.m28.1a"><mrow id="S5.SS5.p2.28.m28.1.1" xref="S5.SS5.p2.28.m28.1.1.cmml"><mi id="S5.SS5.p2.28.m28.1.1.2" xref="S5.SS5.p2.28.m28.1.1.2.cmml">β</mi><mo id="S5.SS5.p2.28.m28.1.1.1" xref="S5.SS5.p2.28.m28.1.1.1.cmml">=</mo><mn id="S5.SS5.p2.28.m28.1.1.3" xref="S5.SS5.p2.28.m28.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.28.m28.1b"><apply id="S5.SS5.p2.28.m28.1.1.cmml" xref="S5.SS5.p2.28.m28.1.1"><eq id="S5.SS5.p2.28.m28.1.1.1.cmml" xref="S5.SS5.p2.28.m28.1.1.1"></eq><ci id="S5.SS5.p2.28.m28.1.1.2.cmml" xref="S5.SS5.p2.28.m28.1.1.2">𝛽</ci><cn type="float" id="S5.SS5.p2.28.m28.1.1.3.cmml" xref="S5.SS5.p2.28.m28.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.28.m28.1c">\beta=0.1</annotation></semantics></math> is better, implying that a shared encoder and an interpolated classifier will be more suitable, i.e., an architecture similar to “ABb”. This also conforms to the performances of “ABb” in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.2. Utilized Networks and Network Splits ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (d) and Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.2. Utilized Networks and Network Splits ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (d).</p>
</div>
<div id="S5.SS5.p3" class="ltx_para">
<p id="S5.SS5.p3.4" class="ltx_p">Additionally, we can find that the changes are regular, and the tendencies along with the change of <math id="S5.SS5.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS5.p3.1.m1.1a"><mi id="S5.SS5.p3.1.m1.1.1" xref="S5.SS5.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.1.m1.1b"><ci id="S5.SS5.p3.1.m1.1.1.cmml" xref="S5.SS5.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.1.m1.1c">\alpha</annotation></semantics></math> and <math id="S5.SS5.p3.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS5.p3.2.m2.1a"><mi id="S5.SS5.p3.2.m2.1.1" xref="S5.SS5.p3.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.2.m2.1b"><ci id="S5.SS5.p3.2.m2.1.1.cmml" xref="S5.SS5.p3.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.2.m2.1c">\beta</annotation></semantics></math> are apparent. This could be an easy procedure to investigate where to aggregate when faced with a novel non-iid FL scene. Namely, we can first take the “AaBb” architecture to train both the global model and personalized models preliminarily, and then we use this interpolation trick to find which combination performs better. Finally, we can use the architecture of the mined one for regular training and application. Take Shakespeare as an example, we can find that setting <math id="S5.SS5.p3.3.m3.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S5.SS5.p3.3.m3.1a"><mrow id="S5.SS5.p3.3.m3.1.1" xref="S5.SS5.p3.3.m3.1.1.cmml"><mi id="S5.SS5.p3.3.m3.1.1.2" xref="S5.SS5.p3.3.m3.1.1.2.cmml">α</mi><mo id="S5.SS5.p3.3.m3.1.1.1" xref="S5.SS5.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS5.p3.3.m3.1.1.3" xref="S5.SS5.p3.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.3.m3.1b"><apply id="S5.SS5.p3.3.m3.1.1.cmml" xref="S5.SS5.p3.3.m3.1.1"><eq id="S5.SS5.p3.3.m3.1.1.1.cmml" xref="S5.SS5.p3.3.m3.1.1.1"></eq><ci id="S5.SS5.p3.3.m3.1.1.2.cmml" xref="S5.SS5.p3.3.m3.1.1.2">𝛼</ci><cn type="float" id="S5.SS5.p3.3.m3.1.1.3.cmml" xref="S5.SS5.p3.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.3.m3.1c">\alpha=1.0</annotation></semantics></math> and <math id="S5.SS5.p3.4.m4.1" class="ltx_Math" alttext="\beta=1.0" display="inline"><semantics id="S5.SS5.p3.4.m4.1a"><mrow id="S5.SS5.p3.4.m4.1.1" xref="S5.SS5.p3.4.m4.1.1.cmml"><mi id="S5.SS5.p3.4.m4.1.1.2" xref="S5.SS5.p3.4.m4.1.1.2.cmml">β</mi><mo id="S5.SS5.p3.4.m4.1.1.1" xref="S5.SS5.p3.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS5.p3.4.m4.1.1.3" xref="S5.SS5.p3.4.m4.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.4.m4.1b"><apply id="S5.SS5.p3.4.m4.1.1.cmml" xref="S5.SS5.p3.4.m4.1.1"><eq id="S5.SS5.p3.4.m4.1.1.1.cmml" xref="S5.SS5.p3.4.m4.1.1.1"></eq><ci id="S5.SS5.p3.4.m4.1.1.2.cmml" xref="S5.SS5.p3.4.m4.1.1.2">𝛽</ci><cn type="float" id="S5.SS5.p3.4.m4.1.1.3.cmml" xref="S5.SS5.p3.4.m4.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.4.m4.1c">\beta=1.0</annotation></semantics></math> could lead to better results, and hence we could take the “AB” way, which <span id="S5.SS5.p3.4.1" class="ltx_text ltx_font_italic">saves vast training cost of enumerating all possible privatization ways</span>. From another aspect, this trick could possibly serve as an efficient way to measure whether a scene is a severe non-iid scene that needs private components to improve performances.</p>
</div>
<div id="S5.SS5.p4" class="ltx_para">
<p id="S5.SS5.p4.11" class="ltx_p">Next, we report the performances and the change of coefficients in <math id="S5.SS5.p4.1.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S5.SS5.p4.1.m1.1a"><mi id="S5.SS5.p4.1.m1.1.1" xref="S5.SS5.p4.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.1.m1.1b"><ci id="S5.SS5.p4.1.m1.1.1.cmml" xref="S5.SS5.p4.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.1.m1.1c">\psi</annotation></semantics></math> with the three proposed algorithms, i.e., AutoCS, AutoSA, and AutoHS introduced in Sect. <a href="#S4.SS3" title="4.3. Automatically Learn to Aggregate ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>. The results of FeCifar10 and FeMnist are shown in Fig. <a href="#S5.F10" title="Figure 10 ‣ 5.4.2. Fine-grained Privatization ‣ 5.4. Results of Different Privatization Ways ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>. In each figure, the top presents the convergence curves of both aggregation and personalization, i.e., the global and local accuracy. Compared with previous results, we can find that the algorithms can obtain comparable performances with the best performances in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.2. Utilized Networks and Network Splits ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.2. Utilized Networks and Network Splits ‣ 5. Experimental Studies ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, which implies that the designed algorithms can effectively learn where to aggregate. For comparisons of the three algorithms, AutoHS obtains a little worse personalization performance in FeCifar10, which may be related to the Gumbel sampling’s randomness. Then we have a deep look at the learned coefficients in the FL process. The illustrations of these coefficients can be found in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.2. Experimental Procedures ‣ 4. Methods and Algorithms ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. In AutoCS, we find that <math id="S5.SS5.p4.2.m2.2" class="ltx_Math" alttext="\alpha_{0,0}" display="inline"><semantics id="S5.SS5.p4.2.m2.2a"><msub id="S5.SS5.p4.2.m2.2.3" xref="S5.SS5.p4.2.m2.2.3.cmml"><mi id="S5.SS5.p4.2.m2.2.3.2" xref="S5.SS5.p4.2.m2.2.3.2.cmml">α</mi><mrow id="S5.SS5.p4.2.m2.2.2.2.4" xref="S5.SS5.p4.2.m2.2.2.2.3.cmml"><mn id="S5.SS5.p4.2.m2.1.1.1.1" xref="S5.SS5.p4.2.m2.1.1.1.1.cmml">0</mn><mo id="S5.SS5.p4.2.m2.2.2.2.4.1" xref="S5.SS5.p4.2.m2.2.2.2.3.cmml">,</mo><mn id="S5.SS5.p4.2.m2.2.2.2.2" xref="S5.SS5.p4.2.m2.2.2.2.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.2.m2.2b"><apply id="S5.SS5.p4.2.m2.2.3.cmml" xref="S5.SS5.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S5.SS5.p4.2.m2.2.3.1.cmml" xref="S5.SS5.p4.2.m2.2.3">subscript</csymbol><ci id="S5.SS5.p4.2.m2.2.3.2.cmml" xref="S5.SS5.p4.2.m2.2.3.2">𝛼</ci><list id="S5.SS5.p4.2.m2.2.2.2.3.cmml" xref="S5.SS5.p4.2.m2.2.2.2.4"><cn type="integer" id="S5.SS5.p4.2.m2.1.1.1.1.cmml" xref="S5.SS5.p4.2.m2.1.1.1.1">0</cn><cn type="integer" id="S5.SS5.p4.2.m2.2.2.2.2.cmml" xref="S5.SS5.p4.2.m2.2.2.2.2">0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.2.m2.2c">\alpha_{0,0}</annotation></semantics></math> tends to be larger than <math id="S5.SS5.p4.3.m3.2" class="ltx_Math" alttext="\alpha_{0,1}" display="inline"><semantics id="S5.SS5.p4.3.m3.2a"><msub id="S5.SS5.p4.3.m3.2.3" xref="S5.SS5.p4.3.m3.2.3.cmml"><mi id="S5.SS5.p4.3.m3.2.3.2" xref="S5.SS5.p4.3.m3.2.3.2.cmml">α</mi><mrow id="S5.SS5.p4.3.m3.2.2.2.4" xref="S5.SS5.p4.3.m3.2.2.2.3.cmml"><mn id="S5.SS5.p4.3.m3.1.1.1.1" xref="S5.SS5.p4.3.m3.1.1.1.1.cmml">0</mn><mo id="S5.SS5.p4.3.m3.2.2.2.4.1" xref="S5.SS5.p4.3.m3.2.2.2.3.cmml">,</mo><mn id="S5.SS5.p4.3.m3.2.2.2.2" xref="S5.SS5.p4.3.m3.2.2.2.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.3.m3.2b"><apply id="S5.SS5.p4.3.m3.2.3.cmml" xref="S5.SS5.p4.3.m3.2.3"><csymbol cd="ambiguous" id="S5.SS5.p4.3.m3.2.3.1.cmml" xref="S5.SS5.p4.3.m3.2.3">subscript</csymbol><ci id="S5.SS5.p4.3.m3.2.3.2.cmml" xref="S5.SS5.p4.3.m3.2.3.2">𝛼</ci><list id="S5.SS5.p4.3.m3.2.2.2.3.cmml" xref="S5.SS5.p4.3.m3.2.2.2.4"><cn type="integer" id="S5.SS5.p4.3.m3.1.1.1.1.cmml" xref="S5.SS5.p4.3.m3.1.1.1.1">0</cn><cn type="integer" id="S5.SS5.p4.3.m3.2.2.2.2.cmml" xref="S5.SS5.p4.3.m3.2.2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.3.m3.2c">\alpha_{0,1}</annotation></semantics></math> on both FeCifar10 and FeMnist, which implies that shared classifier is more inclined to use the features extracted by the shared encoder. However, the relation of <math id="S5.SS5.p4.4.m4.1" class="ltx_Math" alttext="\beta_{0}" display="inline"><semantics id="S5.SS5.p4.4.m4.1a"><msub id="S5.SS5.p4.4.m4.1.1" xref="S5.SS5.p4.4.m4.1.1.cmml"><mi id="S5.SS5.p4.4.m4.1.1.2" xref="S5.SS5.p4.4.m4.1.1.2.cmml">β</mi><mn id="S5.SS5.p4.4.m4.1.1.3" xref="S5.SS5.p4.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.4.m4.1b"><apply id="S5.SS5.p4.4.m4.1.1.cmml" xref="S5.SS5.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS5.p4.4.m4.1.1.1.cmml" xref="S5.SS5.p4.4.m4.1.1">subscript</csymbol><ci id="S5.SS5.p4.4.m4.1.1.2.cmml" xref="S5.SS5.p4.4.m4.1.1.2">𝛽</ci><cn type="integer" id="S5.SS5.p4.4.m4.1.1.3.cmml" xref="S5.SS5.p4.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.4.m4.1c">\beta_{0}</annotation></semantics></math> and <math id="S5.SS5.p4.5.m5.1" class="ltx_Math" alttext="\beta_{1}" display="inline"><semantics id="S5.SS5.p4.5.m5.1a"><msub id="S5.SS5.p4.5.m5.1.1" xref="S5.SS5.p4.5.m5.1.1.cmml"><mi id="S5.SS5.p4.5.m5.1.1.2" xref="S5.SS5.p4.5.m5.1.1.2.cmml">β</mi><mn id="S5.SS5.p4.5.m5.1.1.3" xref="S5.SS5.p4.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.5.m5.1b"><apply id="S5.SS5.p4.5.m5.1.1.cmml" xref="S5.SS5.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS5.p4.5.m5.1.1.1.cmml" xref="S5.SS5.p4.5.m5.1.1">subscript</csymbol><ci id="S5.SS5.p4.5.m5.1.1.2.cmml" xref="S5.SS5.p4.5.m5.1.1.2">𝛽</ci><cn type="integer" id="S5.SS5.p4.5.m5.1.1.3.cmml" xref="S5.SS5.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.5.m5.1c">\beta_{1}</annotation></semantics></math> differs significantly on FeCifar10 and FeMnist, where the former tends to combine the shared and private classifiers and the latter assigns a larger weight to the shared classifier. For AutoSA, similar phenomena can also be observed. In AutoHS, the <math id="S5.SS5.p4.6.m6.1" class="ltx_Math" alttext="\alpha_{0}" display="inline"><semantics id="S5.SS5.p4.6.m6.1a"><msub id="S5.SS5.p4.6.m6.1.1" xref="S5.SS5.p4.6.m6.1.1.cmml"><mi id="S5.SS5.p4.6.m6.1.1.2" xref="S5.SS5.p4.6.m6.1.1.2.cmml">α</mi><mn id="S5.SS5.p4.6.m6.1.1.3" xref="S5.SS5.p4.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.6.m6.1b"><apply id="S5.SS5.p4.6.m6.1.1.cmml" xref="S5.SS5.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS5.p4.6.m6.1.1.1.cmml" xref="S5.SS5.p4.6.m6.1.1">subscript</csymbol><ci id="S5.SS5.p4.6.m6.1.1.2.cmml" xref="S5.SS5.p4.6.m6.1.1.2">𝛼</ci><cn type="integer" id="S5.SS5.p4.6.m6.1.1.3.cmml" xref="S5.SS5.p4.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.6.m6.1c">\alpha_{0}</annotation></semantics></math> and <math id="S5.SS5.p4.7.m7.1" class="ltx_Math" alttext="\beta_{0}" display="inline"><semantics id="S5.SS5.p4.7.m7.1a"><msub id="S5.SS5.p4.7.m7.1.1" xref="S5.SS5.p4.7.m7.1.1.cmml"><mi id="S5.SS5.p4.7.m7.1.1.2" xref="S5.SS5.p4.7.m7.1.1.2.cmml">β</mi><mn id="S5.SS5.p4.7.m7.1.1.3" xref="S5.SS5.p4.7.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.7.m7.1b"><apply id="S5.SS5.p4.7.m7.1.1.cmml" xref="S5.SS5.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS5.p4.7.m7.1.1.1.cmml" xref="S5.SS5.p4.7.m7.1.1">subscript</csymbol><ci id="S5.SS5.p4.7.m7.1.1.2.cmml" xref="S5.SS5.p4.7.m7.1.1.2">𝛽</ci><cn type="integer" id="S5.SS5.p4.7.m7.1.1.3.cmml" xref="S5.SS5.p4.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.7.m7.1c">\beta_{0}</annotation></semantics></math> tend to be larger than <math id="S5.SS5.p4.8.m8.1" class="ltx_Math" alttext="\alpha_{1}" display="inline"><semantics id="S5.SS5.p4.8.m8.1a"><msub id="S5.SS5.p4.8.m8.1.1" xref="S5.SS5.p4.8.m8.1.1.cmml"><mi id="S5.SS5.p4.8.m8.1.1.2" xref="S5.SS5.p4.8.m8.1.1.2.cmml">α</mi><mn id="S5.SS5.p4.8.m8.1.1.3" xref="S5.SS5.p4.8.m8.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.8.m8.1b"><apply id="S5.SS5.p4.8.m8.1.1.cmml" xref="S5.SS5.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS5.p4.8.m8.1.1.1.cmml" xref="S5.SS5.p4.8.m8.1.1">subscript</csymbol><ci id="S5.SS5.p4.8.m8.1.1.2.cmml" xref="S5.SS5.p4.8.m8.1.1.2">𝛼</ci><cn type="integer" id="S5.SS5.p4.8.m8.1.1.3.cmml" xref="S5.SS5.p4.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.8.m8.1c">\alpha_{1}</annotation></semantics></math> and <math id="S5.SS5.p4.9.m9.1" class="ltx_Math" alttext="\beta_{1}" display="inline"><semantics id="S5.SS5.p4.9.m9.1a"><msub id="S5.SS5.p4.9.m9.1.1" xref="S5.SS5.p4.9.m9.1.1.cmml"><mi id="S5.SS5.p4.9.m9.1.1.2" xref="S5.SS5.p4.9.m9.1.1.2.cmml">β</mi><mn id="S5.SS5.p4.9.m9.1.1.3" xref="S5.SS5.p4.9.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.9.m9.1b"><apply id="S5.SS5.p4.9.m9.1.1.cmml" xref="S5.SS5.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S5.SS5.p4.9.m9.1.1.1.cmml" xref="S5.SS5.p4.9.m9.1.1">subscript</csymbol><ci id="S5.SS5.p4.9.m9.1.1.2.cmml" xref="S5.SS5.p4.9.m9.1.1.2">𝛽</ci><cn type="integer" id="S5.SS5.p4.9.m9.1.1.3.cmml" xref="S5.SS5.p4.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.9.m9.1c">\beta_{1}</annotation></semantics></math>, which assigns larger weights to the shared components.
Noting that the smaller coefficients will not be completely suppressed to zeroes after softmax, e.g., <span id="S5.SS5.p4.11.1" class="ltx_text ltx_markedasmath">SoftMax(2.0/2.0, -1.0/2.0)</span> returns 0.82 and 0.18 correspondingly, and hence the learned architecture still implies a soft combination among shared and private components. The coefficients may be related to the balancing factor <math id="S5.SS5.p4.11.m11.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS5.p4.11.m11.1a"><mi id="S5.SS5.p4.11.m11.1.1" xref="S5.SS5.p4.11.m11.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p4.11.m11.1b"><ci id="S5.SS5.p4.11.m11.1.1.cmml" xref="S5.SS5.p4.11.m11.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p4.11.m11.1c">\alpha</annotation></semantics></math> in Eq. <a href="#S3.E5" title="In Proposition 3.4. ‣ 3.3. Issues to Explore ‣ 3. Background ‣ Aggregate or Not? Exploring Where to Privatize in DNN Based Federated Learning Under Different Non-IID Scenes" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We will explore this in future work.</p>
</div>
<div id="S5.SS5.p5" class="ltx_para">
<p id="S5.SS5.p5.1" class="ltx_p">The proposed interpolation trick and automatical algorithms are efficient to implement and could be taken to search for an appropriate privatization way preliminarily when given a novel non-iid scene. Some other ways could also be explored, e.g., interpolating the parameters instead of the features and outputs, learning combination weights locally, or assigning different combination weights for different neurons. These possible studies are also left as future work.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Motivated by the observation that existing FL methods take various privatization ways in the learning process, we aimed to explore whether the privatization ways have any potential relations to the types of non-iid scenes.
We selected four FL benchmarks containing both covariate shift and label shift non-iid scenes, designed coarse-grained and fine-grained privatization ways, and took abundant experimental studies to analyze both aggregation and personalization performances.
We observed several exciting phenomena, e.g., privatizing the encoder can lead to better performances even in label shift non-iid scenes; none of the investigated privatization ways perform better on Shakespeare; the double branch privatization ways perform better when compared to the single branch ones.
These observations suggest that privatizing an encoder in a double branch manner (i.e., “AaB”) should be prioritized for a novel non-iid scene, regardless of which type of data heterogeneity, and the next to adopt is privatizing an additional classifier (i.e., “ABb”).
We also provided efficient ways to automatically learn where to aggregate via an interpolation trick and three proposed automatical algorithms. The results verify that these proposed methods could serve as a preliminary try to explore which layers to privatize.
To be brief, our investigation provides insights for further studies of where to aggregate or privatize in FL, e.g., applying advanced neural architecture search techniques to FL and quantifying the non-iid level of faced scenes.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Argyriou
et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2006)</span>
<span class="ltx_bibblock">
Andreas Argyriou,
Theodoros Evgeniou, and Massimiliano
Pontil. 2006.

</span>
<span class="ltx_bibblock">Multi-Task Feature Learning. In
<em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on Advances in Neural
Information Processing Systems (NeurIPS’06)</em>. 41–48.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan,
Vinay Aggarwal, Aaditya Kumar Singh,
and Sunav Choudhary. 2019.

</span>
<span class="ltx_bibblock">Federated Learning with Personalization Layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1912.00818
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Yajie Bao, Yang Li,
Shao-Lun Huang, Lin Zhang,
Lizhong Zheng, Amir Roshan Zamir, and
Leonidas J. Guibas. 2019.

</span>
<span class="ltx_bibblock">An Information-Theoretic Approach to
Transferability in Task Transfer Learning. In
<em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE International Conference
on Image Processing (ICIP’19)</em>. 2309–2313.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Keith Bonawitz, Hubert
Eichner, Wolfgang Grieskamp, Dzmitry
Huba, Alex Ingerman, Vladimir Ivanov,
Chloé Kiddon, Jakub Konecný,
Stefano Mazzocchi, Brendan McMahan,
Timon Van Overveldt, David Petrou,
Daniel Ramage, and Jason Roselander.
2019.

</span>
<span class="ltx_bibblock">Towards Federated Learning at Scale: System
Design. In <em id="bib.bib5.3.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and
Systems (MLSys’19)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bousmalis et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Konstantinos Bousmalis,
George Trigeorgis, Nathan Silberman,
Dilip Krishnan, and Dumitru Erhan.
2016.

</span>
<span class="ltx_bibblock">Domain Separation Networks. In
<em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on Advances in Neural
Information Processing Systems (NeurIPS’16)</em>. 343–351.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bui et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Duc Bui, Kshitiz Malik,
Jack Goetz, Honglei Liu,
Seungwhan Moon, Anuj Kumar, and
Kang G. Shin. 2019.

</span>
<span class="ltx_bibblock">Federated User Representation Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1909.12535
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Sebastian Caldas, Peter
Wu, Tian Li, Jakub Konecný,
H. Brendan McMahan, Virginia Smith, and
Ameet Talwalkar. 2018.

</span>
<span class="ltx_bibblock">LEAF: A Benchmark for Federated Settings.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1812.01097
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang
et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Woong-Gi Chang, Tackgeun
You, Seonguk Seo, Suha Kwak, and
Bohyung Han. 2019.

</span>
<span class="ltx_bibblock">Domain-Specific Batch Normalization for
Unsupervised Domain Adaptation. In <em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">Proceedings of
the IEEE Conference on Computer Vision and Pattern Recognition
(CVPR’19)</em>. 7354–7362.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen
et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Fei Chen, Zhenhua Dong,
Zhenguo Li, and Xiuqiang He.
2018.

</span>
<span class="ltx_bibblock">Federated Meta-Learning for Recommendation.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1802.07876
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Mingqing Chen,
Ananda Theertha Suresh, Rajiv Mathews,
Adeline Wong, Cyril Allauzen,
Françoise Beaufays, and Michael
Riley. 2019.

</span>
<span class="ltx_bibblock">Federated Learning of N-Gram Language Models. In
<em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 23rd Conference on Computational
Natural Language Learning (CoNLL’19)</em>. 121–130.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collobert and
Weston (2008)</span>
<span class="ltx_bibblock">
Ronan Collobert and
Jason Weston. 2008.

</span>
<span class="ltx_bibblock">A unified architecture for natural language
processing: deep neural networks with multitask learning. In
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Twenty-Fifth International
Conference (ICML’08)</em>, Vol. 307.
160–167.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Crawshaw (2020)</span>
<span class="ltx_bibblock">
Michael Crawshaw.
2020.

</span>
<span class="ltx_bibblock">Multi-Task Learning with Deep Neural Networks: A
Survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2009.09796
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dean et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2012)</span>
<span class="ltx_bibblock">
Jeffrey Dean, Greg
Corrado, Rajat Monga, Kai Chen,
Matthieu Devin, Quoc V. Le,
Mark Z. Mao, Marc’Aurelio Ranzato,
Andrew W. Senior, Paul A. Tucker,
Ke Yang, and Andrew Y. Ng.
2012.

</span>
<span class="ltx_bibblock">Large Scale Distributed Deep Networks. In
<em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on Advances in Neural
Information Processing Systems (NeurIPS’12)</em>. 1232–1240.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork and Roth (2014)</span>
<span class="ltx_bibblock">
Cynthia Dwork and Aaron
Roth. 2014.

</span>
<span class="ltx_bibblock">The Algorithmic Foundations of Differential
Privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Found. Trends Theor. Comput. Sci.</em>
9, 3-4 (2014),
211–407.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fayek
et al<span id="bib.bib16.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Haytham M. Fayek, Lawrence
Cavedon, and Hong Ren Wu.
2018.

</span>
<span class="ltx_bibblock">On the Transferability of Representations in Neural
Networks Between Datasets and Tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1811.12273
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ganin et al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Yaroslav Ganin, Evgeniya
Ustinova, Hana Ajakan, Pascal Germain,
Hugo Larochelle, François
Laviolette, Mario Marchand, and
Victor S. Lempitsky. 2016.

</span>
<span class="ltx_bibblock">Domain-Adversarial Training of Neural Networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.3.1" class="ltx_emph ltx_font_italic">J. Mach. Learn. Res.</em> 17
(2016), 59:1–59:35.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamer
et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Jenny Hamer, Mehryar
Mohri, and Ananda Theertha Suresh.
2020.

</span>
<span class="ltx_bibblock">FedBoost: A Communication-Efficient Algorithm
for Federated Learning. In <em id="bib.bib18.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th
International Conference on Machine Learning (ICML’20)</em>.
3973–3983.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He
et al<span id="bib.bib19.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu
Zhang, Shaoqing Ren, and Jian Sun.
2016.

</span>
<span class="ltx_bibblock">Deep Residual Learning for Image Recognition. In
<em id="bib.bib19.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition (CVPR’16)</em>. 770–778.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton
et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Geoffrey E. Hinton, Oriol
Vinyals, and Jeffrey Dean.
2015.

</span>
<span class="ltx_bibblock">Distilling the Knowledge in a Neural Network.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1503.02531
(2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsieh
et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Kevin Hsieh, Amar
Phanishayee, Onur Mutlu, and Phillip B.
Gibbons. 2019.

</span>
<span class="ltx_bibblock">The Non-IID Data Quagmire of Decentralized Machine
Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1910.00189
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jang
et al<span id="bib.bib22.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Eric Jang, Shixiang Gu,
and Ben Poole. 2017.

</span>
<span class="ltx_bibblock">Categorical Reparameterization with
Gumbel-Softmax. In <em id="bib.bib22.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 5th
International Conference on Learning Representations (ICLR’17)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jang
et al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Yunhun Jang, Hankook Lee,
Sung Ju Hwang, and Jinwoo Shin.
2019.

</span>
<span class="ltx_bibblock">Learning What and Where to Transfer. In
<em id="bib.bib23.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 36th International Conference on
Machine Learning, (ICML’19)</em>, Vol. 97.
3030–3039.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong
et al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Eunjeong Jeong, Seungeun
Oh, Hyesung Kim, Jihong Park,
Mehdi Bennis, and Seong-Lyun Kim.
2018.

</span>
<span class="ltx_bibblock">Communication-Efficient On-Device Machine Learning:
Federated Distillation and Augmentation under Non-IID Private Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1811.11479
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz
et al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Peter Kairouz, H. Brendan
McMahan, Brendan Avent, Aurélien
Bellet, Mehdi Bennis, Arjun Nitin
Bhagoji, Keith Bonawitz, Zachary
Charles, Graham Cormode, Rachel
Cummings, Rafael G. L. D’Oliveira,
Salim El Rouayheb, David Evans,
Josh Gardner, Zachary Garrett,
Adrià Gascón, Badih Ghazi,
Phillip B. Gibbons, Marco Gruteser,
Zaïd Harchaoui, Chaoyang He,
Lie He, Zhouyuan Huo,
Ben Hutchinson, Justin Hsu,
Martin Jaggi, Tara Javidi,
Gauri Joshi, Mikhail Khodak,
Jakub Konecný, Aleksandra Korolova,
Farinaz Koushanfar, Sanmi Koyejo,
Tancrède Lepoint, Yang Liu,
Prateek Mittal, Mehryar Mohri,
Richard Nock, Ayfer Özgür,
Rasmus Pagh, Mariana Raykova,
Hang Qi, Daniel Ramage,
Ramesh Raskar, Dawn Song,
Weikang Song, Sebastian U. Stich,
Ziteng Sun, Ananda Theertha Suresh,
Florian Tramèr, Praneeth Vepakomma,
Jianyu Wang, Li Xiong,
Zheng Xu, Qiang Yang,
Felix X. Yu, Han Yu, and
Sen Zhao. 2019.

</span>
<span class="ltx_bibblock">Advances and Open Problems in Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1912.04977
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy,
Satyen Kale, Mehryar Mohri,
Sashank J. Reddi, Sebastian U. Stich,
and Ananda Theertha Suresh.
2020.

</span>
<span class="ltx_bibblock">SCAFFOLD: Stochastic Controlled Averaging for
Federated Learning. In <em id="bib.bib26.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th
International Conference on Machine Learning (ICML’20)</em>.
5132–5143.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konecný et al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Jakub Konecný,
H. Brendan McMahan, Felix X. Yu,
Peter Richtárik, Ananda Theertha
Suresh, and Dave Bacon.
2016.

</span>
<span class="ltx_bibblock">Federated Learning: Strategies for Improving
Communication Efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1610.05492
(2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky (2012)</span>
<span class="ltx_bibblock">
Alex Krizhevsky.
2012.

</span>
<span class="ltx_bibblock">Learning Multiple Layers of Features from Tiny
Images.

</span>
<span class="ltx_bibblock">(2012).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky
et al<span id="bib.bib29.2.2.1" class="ltx_text">.</span> (2012)</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Ilya
Sutskever, and Geoffrey E. Hinton.
2012.

</span>
<span class="ltx_bibblock">ImageNet Classification with Deep Convolutional
Neural Networks. In <em id="bib.bib29.3.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference
on Advances in Neural Information Processing Systems (NeurIPS’12)</em>.
1106–1114.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kulkarni
et al<span id="bib.bib30.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Viraj Kulkarni, Milind
Kulkarni, and Aniruddha Pant.
2020.

</span>
<span class="ltx_bibblock">Survey of Personalization Techniques for Federated
Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2003.08673
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Wang (2019)</span>
<span class="ltx_bibblock">
Daliang Li and Junpu
Wang. 2019.

</span>
<span class="ltx_bibblock">FedMD: Heterogenous Federated Learning via Model
Distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1910.03581
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib32.2.2.1" class="ltx_text">.</span> (2013)</span>
<span class="ltx_bibblock">
Mu Li, Li Zhou,
Zichao Yang, Aaron Li,
Fei Xia, David G Andersen, and
Alexander Smola. 2013.

</span>
<span class="ltx_bibblock">Parameter server for distributed machine learning.
In <em id="bib.bib32.3.1" class="ltx_emph ltx_font_italic">Big Learning NeurIPS Workshop</em>,
Vol. 6. 2.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib33.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu,
Manzil Zaheer, Maziar Sanjabi,
Ameet Talwalkar, and Virginia Smith.
2020.

</span>
<span class="ltx_bibblock">Federated Optimization in Heterogeneous Networks.
In <em id="bib.bib33.3.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems
(MLSys’20)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib34.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Xin-Chun Li, De-Chuan
Zhan, Jia-Qi Yang, and Yi Shi.
2021.

</span>
<span class="ltx_bibblock">Deep multiple instance selection.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.3.1" class="ltx_emph ltx_font_italic">Sci. China Inf. Sci.</em> 64,
3 (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al<span id="bib.bib35.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Paul Pu Liang, Terrance
Liu, Ziyin Liu, Ruslan Salakhutdinov,
and Louis-Philippe Morency.
2020.

</span>
<span class="ltx_bibblock">Think Locally, Act Globally: Federated Learning
with Local and Global Representations.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2001.01523
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin
et al<span id="bib.bib36.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tao Lin, Lingjing Kong,
Sebastian U. Stich, and Martin Jaggi.
2020.

</span>
<span class="ltx_bibblock">Ensemble Distillation for Robust Model Fusion in
Federated Learning. In <em id="bib.bib36.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
Conference on Advances in Neural Information Processing Systems
(NeurIPS’20)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu
et al<span id="bib.bib37.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Pengfei Liu, Xipeng Qiu,
and Xuanjing Huang. 2016.

</span>
<span class="ltx_bibblock">Recurrent Neural Network for Text Classification
with Multi-Task Learning. In <em id="bib.bib37.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
Twenty-Fifth International Joint Conference on Artificial Intelligence
(IJCAI’16)</em>. 2873–2879.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu
et al<span id="bib.bib38.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Yang Liu, Yan Kang,
Chaoping Xing, Tianjian Chen, and
Qiang Yang. 2020.

</span>
<span class="ltx_bibblock">A Secure Federated Transfer Learning Framework.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.3.1" class="ltx_emph ltx_font_italic">IEEE Intell. Syst.</em> 35,
4 (2020), 70–82.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long
et al<span id="bib.bib39.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Mingsheng Long, Yue Cao,
Jianmin Wang, and Michael I. Jordan.
2015.

</span>
<span class="ltx_bibblock">Learning Transferable Features with Deep Adaptation
Networks. In <em id="bib.bib39.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 32nd International
Conference on Machine Learning (ICML’15)</em>, Vol. 37.
97–105.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib40.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider
Moore, Daniel Ramage, Seth Hampson,
and Blaise Agüera y Arcas.
2017.

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks
from Decentralized Data. In <em id="bib.bib40.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
20th International Conference on Artificial Intelligence and Statistics
(AISTATS’17)</em>. 1273–1282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Misra
et al<span id="bib.bib41.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Ishan Misra, Abhinav
Shrivastava, Abhinav Gupta, and Martial
Hebert. 2016.

</span>
<span class="ltx_bibblock">Cross-Stitch Networks for Multi-task Learning. In
<em id="bib.bib41.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition (CVPR’16)</em>. 3994–4003.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al<span id="bib.bib42.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Cuong Nguyen, Tal
Hassner, Matthias W. Seeger, and
Cédric Archambeau. 2020.

</span>
<span class="ltx_bibblock">LEEP: A New Measure to Evaluate Transferability
of Learned Representations. In <em id="bib.bib42.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
37th International Conference on Machine Learning (ICML’20)</em>,
Vol. 119. 7294–7305.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan and Yang (2010)</span>
<span class="ltx_bibblock">
Sinno Jialin Pan and
Qiang Yang. 2010.

</span>
<span class="ltx_bibblock">A Survey on Transfer Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Knowl. Data Eng.</em>
22, 10 (2010),
1345–1359.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peterson
et al<span id="bib.bib44.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Daniel Peterson, Pallika
Kanani, and Virendra J. Marathe.
2019.

</span>
<span class="ltx_bibblock">Private Federated Learning with Domain Adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1912.06733
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quionero-Candela et al<span id="bib.bib45.2.2.1" class="ltx_text">.</span> (2009)</span>
<span class="ltx_bibblock">
Joaquin Quionero-Candela,
Masashi Sugiyama, Anton Schwaighofer,
and Neil Lawrence. 2009.

</span>
<span class="ltx_bibblock">Dataset Shift in Machine Learning.

</span>
<span class="ltx_bibblock">(01 2009).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramaswamy et al<span id="bib.bib46.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Swaroop Ramaswamy, Rajiv
Mathews, Kanishka Rao, and
Françoise Beaufays. 2019.

</span>
<span class="ltx_bibblock">Federated Learning for Emoji Prediction in a Mobile
Keyboard.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1906.04329
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al<span id="bib.bib47.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tao Shen, Jie Zhang,
Xinkang Jia, Fengda Zhang,
Gang Huang, Pan Zhou,
Fei Wu, and Chao Wu.
2020.

</span>
<span class="ltx_bibblock">Federated Mutual Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2006.16765
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shoham et al<span id="bib.bib48.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Neta Shoham, Tomer
Avidor, Aviv Keren, Nadav Israel,
Daniel Benditkis, Liron Mor-Yosef,
and Itai Zeitak. 2019.

</span>
<span class="ltx_bibblock">Overcoming Forgetting in Federated Learning on
Non-IID Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1910.07796
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith
et al<span id="bib.bib49.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Virginia Smith, Chao-Kai
Chiang, Maziar Sanjabi, and Ameet S.
Talwalkar. 2017.

</span>
<span class="ltx_bibblock">Federated Multi-Task Learning. In
<em id="bib.bib49.3.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on Advances in Neural
Information Processing Systems (NeurIPS’17)</em>. 4424–4434.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sui
et al<span id="bib.bib50.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Dianbo Sui, Yubo Chen,
Jun Zhao, Yantao Jia,
Yuantao Xie, and Weijian Sun.
2020.

</span>
<span class="ltx_bibblock">FedED: Federated Learning via Ensemble Distillation
for Medical Relation Extraction. In <em id="bib.bib50.3.1" class="ltx_emph ltx_font_italic">Proceedings of
the Conference on Empirical Methods in Natural Language Processing
(EMNLP’20)</em>. 2118–2128.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tran
et al<span id="bib.bib51.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Anh Tuan Tran, Cuong V.
Nguyen, and Tal Hassner.
2019.

</span>
<span class="ltx_bibblock">Transferability and Hardness of Supervised
Classification Tasks. In <em id="bib.bib51.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF International Conference on Computer Vision (ICCV’19)</em>.
1395–1405.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tzeng
et al<span id="bib.bib52.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Eric Tzeng, Judy Hoffman,
Kate Saenko, and Trevor Darrell.
2017.

</span>
<span class="ltx_bibblock">Adversarial Discriminative Domain Adaptation. In
<em id="bib.bib52.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition (CVPR’17)</em>. 2962–2971.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vu et al<span id="bib.bib53.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tu Vu, Tong Wang,
Tsendsuren Munkhdalai, Alessandro
Sordoni, Adam Trischler, Andrew
Mattarella-Micke, Subhransu Maji, and
Mohit Iyyer. 2020.

</span>
<span class="ltx_bibblock">Exploring and Predicting Transferability across
NLP Tasks. In <em id="bib.bib53.3.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on
Empirical Methods in Natural Language Processing (EMNLP’20)</em>.
7882–7926.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span id="bib.bib54.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Kangkang Wang, Rajiv
Mathews, Chloé Kiddon, Hubert
Eichner, Françoise Beaufays, and
Daniel Ramage. 2019.

</span>
<span class="ltx_bibblock">Federated Evaluation of On-device Personalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1910.10252
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang
et al<span id="bib.bib55.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Lixu Wang, Shichao Xu,
Xiao Wang, and Qi Zhu.
2020.

</span>
<span class="ltx_bibblock">Towards Class Imbalance in Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2008.06217
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span id="bib.bib56.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Kang Wei, Jun Li,
Ming Ding, Chuan Ma,
Howard H. Yang, Farhad Farokhi,
Shi Jin, Tony Q. S. Quek, and
H. Vincent Poor. 2020.

</span>
<span class="ltx_bibblock">Federated Learning With Differential Privacy:
Algorithms and Performance Analysis.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.3.1" class="ltx_emph ltx_font_italic">IEEE Trans. Inf. Forensics Secur.</em>
15 (2020), 3454–3469.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span id="bib.bib57.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Xi-Zhu Wu, Song Liu,
and Zhi-Hua Zhou. 2019.

</span>
<span class="ltx_bibblock">Heterogeneous Model Reuse via Optimizing Multiparty
Multiclass Margin. In <em id="bib.bib57.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 36th
International Conference on Machine Learning (ICML’19)</em>,
Vol. 97. 6840–6849.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang
et al<span id="bib.bib58.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Qiang Yang, Yang Liu,
Tianjian Chen, and Yongxin Tong.
2019.

</span>
<span class="ltx_bibblock">Federated Machine Learning: Concept and
Applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.3.1" class="ltx_emph ltx_font_italic">ACM Trans. Intell. Syst. Technol.</em>
10, 2 (2019),
12:1–12:19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang
et al<span id="bib.bib59.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Qian Yang, Jianyi Zhang,
Weituo Hao, Gregory Spell, and
Lawrence Carin. 2021.

</span>
<span class="ltx_bibblock">FLOP: Federated Learning on Medical Datasets
using Partial Networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2102.05218
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao
et al<span id="bib.bib60.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Xin Yao, Chaofeng Huang,
and Lifeng Sun. 2018.

</span>
<span class="ltx_bibblock">Two-Stream Federated Learning: Reduce the
Communication Costs. In <em id="bib.bib60.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE
Visual Communications and Image Processing (VCIP’18)</em>.
1–4.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao
et al<span id="bib.bib61.2.2.1" class="ltx_text">.</span> (2019a)</span>
<span class="ltx_bibblock">
Xin Yao, Tianchi Huang,
Chenglei Wu, Rui-Xiao Zhang, and
Lifeng Sun. 2019a.

</span>
<span class="ltx_bibblock">Towards Faster and Better Federated Learning: A
Feature Fusion Approach. In <em id="bib.bib61.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE International Conference on Image Processing (ICIP’19)</em>.
175–179.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao
et al<span id="bib.bib62.2.2.1" class="ltx_text">.</span> (2019b)</span>
<span class="ltx_bibblock">
Xin Yao, Tianchi Huang,
Rui-Xiao Zhang, Ruiyu Li, and
Lifeng Sun. 2019b.

</span>
<span class="ltx_bibblock">Federated Learning with Unbiased Gradient
Aggregation and Controllable Meta Updating.

</span>
<span class="ltx_bibblock"><em id="bib.bib62.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1910.08234
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yosinski
et al<span id="bib.bib63.2.2.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Jason Yosinski, Jeff
Clune, Yoshua Bengio, and Hod Lipson.
2014.

</span>
<span class="ltx_bibblock">How transferable are features in deep neural
networks?. In <em id="bib.bib63.3.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on
Advances in Neural Information Processing Systems (NeurIPS’14)</em>.
3320–3328.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu
et al<span id="bib.bib64.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tao Yu, Eugene
Bagdasaryan, and Vitaly Shmatikov.
2020.

</span>
<span class="ltx_bibblock">Salvaging Federated Learning by Local Adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/2002.04758
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zamir et al<span id="bib.bib65.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Amir Roshan Zamir,
Alexander Sax, William B. Shen,
Leonidas J. Guibas, Jitendra Malik, and
Silvio Savarese. 2018.

</span>
<span class="ltx_bibblock">Taskonomy: Disentangling Task Transfer Learning.
In <em id="bib.bib65.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition (CVPR’18)</em>. 3712–3722.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Yang (2017)</span>
<span class="ltx_bibblock">
Yu Zhang and Qiang
Yang. 2017.

</span>
<span class="ltx_bibblock">A Survey on Multi-Task Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1707.08114
(2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao
et al<span id="bib.bib67.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li,
Liangzhen Lai, Naveen Suda,
Damon Civin, and Vikas Chandra.
2018.

</span>
<span class="ltx_bibblock">Federated Learning with Non-IID Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib67.3.1" class="ltx_emph ltx_font_italic">CoRR</em> abs/1806.00582
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2107.11953" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2107.11954" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2107.11954">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2107.11954" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2107.11955" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar  6 15:34:51 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
