<article class="ltx_document ltx_authors_1line" lang="en">
 <h1 class="ltx_title ltx_title_document">
  Large Language Model Guided Tree-of-Thought
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Jieyi Long
    <br class="ltx_break"/>
    Theta Labs, Inc.
    <br class="ltx_break"/>
    San Jose, CA 95128
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id1.1.id1">
     jieyi@thetalabs.org
    </span>
    <br class="ltx_break"/>
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id2.id1">
   <span class="ltx_text" id="id2.id1.1">
    In this paper, we introduce the Tree-of-Thought (ToT) framework, a novel approach aimed at improving the problem-solving capabilities of auto-regressive large language models (LLMs). The ToT technique is inspired by the human mind’s approach for solving complex reasoning tasks through trial and error. In this process, the human mind explores the solution space through a tree-like thought process, allowing for backtracking when necessary. To implement ToT as a software system, we augment an LLM with additional modules including a prompter agent, a checker module, a memory module, and a ToT controller. In order to solve a given problem, these modules engage in a multi-round conversation with the LLM. The memory module records the conversation and state history of the problem solving process, which allows the system to backtrack to the previous steps of the thought-process and explore other directions from there. To verify the effectiveness of the proposed technique, we implemented a ToT-based solver for the Sudoku Puzzle. Experimental results show that the ToT framework can significantly increase the success rate of Sudoku puzzle solving. Our implementation of the ToT-based Sudoku solver is available on GitHub:
    <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/jieyilong/tree-of-thought-puzzle-solver" style="font-size:80%;" target="_blank" title="">
     https://github.com/jieyilong/tree-of-thought-puzzle-solver
    </a>
    <span class="ltx_text" id="id2.id1.1.1" style="font-size:80%;">
     .
    </span>
   </span>
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Self-attention based auto-regressive large language models (LLMs) such as GPT-4 have recently taken the world by storm
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib1" title="">
      <span class="ltx_text" style="font-size:80%;">
       vaswani2017attention
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib2" title="">
      <span class="ltx_text" style="font-size:80%;">
       devlin2019bert
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib3" title="">
      <span class="ltx_text" style="font-size:80%;">
       radford2018gpt
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib4" title="">
      <span class="ltx_text" style="font-size:80%;">
       radford2019gpt2
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib5" title="">
      <span class="ltx_text" style="font-size:80%;">
       brown2020gpt3
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib6" title="">
      <span class="ltx_text" style="font-size:80%;">
       openai2023gpt4
      </span>
     </a>
    </cite>
    . These LLMs excel at a variety of tasks that previously thought as extremely difficult or even impossible. For example, they are able to handle various logical and mathematical reasoning tasks, particularly those that entail “short-range reasonings” necessitating only a few steps to arrive at conclusions
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib6" title="">
      <span class="ltx_text" style="font-size:80%;">
       openai2023gpt4
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib7" title="">
      <span class="ltx_text" style="font-size:80%;">
       bubeck2023sparks
      </span>
     </a>
    </cite>
    . Such remarkable capabilities have even led to speculation that an early form of artificial general intelligence (AGI) may have already emerged
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib7" title="">
      <span class="ltx_text" style="font-size:80%;">
       bubeck2023sparks
      </span>
     </a>
    </cite>
    . However, today’s LLMs still exhibit limitations in certain domains, especially for “long-range” reasoning tasks, where long-term planning and solution exploration are necessary
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib7" title="">
      <span class="ltx_text" style="font-size:80%;">
       bubeck2023sparks
      </span>
     </a>
    </cite>
    . When presenting a LLMs such as GPT-4 with a challenging problem solving task, especially the so called System-2 reasoning problems
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib8" title="">
      <span class="ltx_text" style="font-size:80%;">
       tay2016system2
      </span>
     </a>
    </cite>
    , the model does not always succeed.
Although the generated answer may be indicative of the correct direction, the derivation process frequently includes logical errors. We hypothesize that there are two main contributing factors which limits the problem solving ability of LLMs:
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    <span class="ltx_text ltx_font_bold" id="S1.p2.1.1">
     Lack of correctness checking
    </span>
    : To ensure correctness, a good practice for a human solver is to carry out verification procedures at
    <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">
     every step
    </span>
    of the problem-solving process, thereby ensuring the credibility of the final solution. In comparison, auto-regressive language models do not explicitly perform logical correctness checks as it generates a new token based on the previous tokens. This limits the model’s capacity to rectify its own mistakes. A minor error could be amplified as the model generates more tokens, thereby leading to rapid solution quality deterioration and making it difficult to recover from mistakes.
   </p>
  </div>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">
     Solution generated linearly
    </span>
    : As mentioned above, LLMs typically generate a token based on the preceding sequence of tokens without backward editing. On the contrary, when a human solver attempts to solve a problem, she might backtrack to previous steps if a derivation step is incorrect, or if she becomes stuck and is unable to make further progress towards arriving at the final answer. Fields Medal winner Terence Tao once shared his experiences solving hard math problems
    <span class="ltx_note ltx_role_footnote" id="footnote1">
     <sup class="ltx_note_mark">
      1
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        1
       </sup>
       <span class="ltx_tag ltx_tag_note">
        1
       </span>
       <a class="ltx_ref ltx_href" href="https://newsroom.ucla.edu/releases/Terence-Tao-Mozart-of-Math-7252" target="_blank" title="">
        https://newsroom.ucla.edu/releases/Terence-Tao-Mozart-of-Math-7252
       </a>
      </span>
     </span>
    </span>
    : “When I was a kid, I had a romanticized notion of mathematics, that hard problems were solved in Eureka moments of inspiration… With me, it’s always, Let’s try this. That gets me part of the way, or that doesn’t work. Now let’s try this. Oh, there’s a little shortcut here… You work on it long enough and you happen to make progress towards a hard problem by a back door at some point. At the end, it’s usually, oh, I’ve solved the problem.” The problem solving process as he described is a
    <span class="ltx_text ltx_font_italic" id="S1.p3.1.2">
     tree-like
    </span>
    thinking process, rather than a
    <span class="ltx_text ltx_font_italic" id="S1.p3.1.3">
     linear
    </span>
    chain-of-thought
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib9" title="">
      <span class="ltx_text" style="font-size:80%;">
       wei2023chainofthought
      </span>
     </a>
    </cite>
    . The limitation of linear response generation is also apparent from a computational complexity perspective. The number of computation steps an auto-regressive LLM can perform is polynomial in terms of its input length. Unless
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.4">
     P
    </span>
    =
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.5">
     NP
    </span>
    holds which contradicts the widely accepted belief, there would be problems in
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.6">
     NP
    </span>
    that is not solvable by auto-regressive LLMs.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_2">
     <figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="611" id="S1.F1.sf1.g1" src="/html/2305.08291/assets/figs/tot-search-strategy.png" width="598"/>
      <figcaption class="ltx_caption">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S1.F1.sf1.2.1.1" style="font-size:90%;">
         (a)
        </span>
       </span>
       <span class="ltx_text" id="S1.F1.sf1.3.2" style="font-size:90%;">
        ToT search strategy.
       </span>
      </figcaption>
     </figure>
    </div>
    <div class="ltx_flex_cell ltx_flex_size_2">
     <figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="375" id="S1.F1.sf2.g1" src="/html/2305.08291/assets/figs/tot-system.png" width="598"/>
      <figcaption class="ltx_caption">
       <span class="ltx_tag ltx_tag_figure">
        <span class="ltx_text" id="S1.F1.sf2.2.1.1" style="font-size:90%;">
         (b)
        </span>
       </span>
       <span class="ltx_text" id="S1.F1.sf2.3.2" style="font-size:90%;">
        ToT software system.
       </span>
      </figcaption>
     </figure>
    </div>
   </div>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">
      Figure 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">
     (a) Details of the Tree-of-Thought search strategy, where a solid arrow means a search step guided by the response from the LLM, and a dashed arrow indicates backtracking commanded by the ToT controller. (b) The software system implementing the Tree-of-Thought search strategy. It enhances the problem solving capability of an LLM by augmenting it with additional modules including a prompter agent, a checker module, a memory module, and a ToT controller.
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Inspired by these two shortcomings of auto-regressive LLMs, we propose a novel framework which augments an LLM with several additional modules including an automatic “prompter agent”. This framework employs a solution search strategy we call the
    <span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p4.1.1">
     Tree-of-Thought
     <span class="ltx_text ltx_font_medium" id="S1.p4.1.1.1">
      (
     </span>
     ToT
     <span class="ltx_note ltx_role_footnote" id="footnote2">
      <sup class="ltx_note_mark">
       2
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         2
        </sup>
        <span class="ltx_tag ltx_tag_note">
         <span class="ltx_text ltx_font_medium ltx_font_upright" id="footnote2.1.1.1">
          2
         </span>
        </span>
        <span class="ltx_text ltx_font_medium ltx_font_upright" id="footnote2.5">
         The word “tot” means a very young child, which is an interesting analogy as this work is a preliminary exploration into the potential for automated problem-solving utilizing language models.
        </span>
       </span>
      </span>
     </span>
     <span class="ltx_text ltx_font_medium" id="S1.p4.1.1.2">
      )
     </span>
    </span>
    . This strategy solves a problem through a multi-round conversation between the LLM and the prompter agent. Figure
    <a class="ltx_ref" href="#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Large Language Model Guided Tree-of-Thought">
     <span class="ltx_text ltx_ref_tag">
      1(a)
     </span>
    </a>
    provides a visual description of the ToT search strategy, in which the LLM plays a crucial role in
    <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">
     guiding
    </span>
    the search for solutions. To make it more concrete, let us assume the problem to be solved is an instance of the Sudoku puzzle. The “root” node represents the initial state, corresponding to when a human mind just reads through the problem description, and begins the thinking process. A blue node in the figure represents a valid partial solution, which can be used by the LLM as a basis to generate the next search step. In the context of Sudoku puzzle solving, this means presenting a partially filled Sudoku board to an LLM and letting the LLM fill in a few more cells. The rationale is that an LLM like GPT-4 has been trained on a vast amount of text corpus which includes many Sudoku puzzle solutions. Given a partially filled board, likely the LLM is able to recognize the pattern, and provide useful insights on how to proceed following the Sudoku rules. Hence, it is highly probable that a search guided by the LLM is significantly more efficient than a brute-force search. In the figure, the search steps guided by the LLM are represented by the solid arrows. However, these steps generated by the LLM are not guaranteed to be always logically correct. Thus, we introduce a “checker module” to perform correctness checks. In Figure
    <a class="ltx_ref" href="#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Large Language Model Guided Tree-of-Thought">
     <span class="ltx_text ltx_ref_tag">
      1(a)
     </span>
    </a>
    , a gray node with an “X” marker represents a “dead-end”, i.e. a partial solution that the checker module considers as invalid. For Sudoku, this means the partially filled board violates the Sudoku rules. If the current node is invalid, obviously we need to return to a parent or an ancestor node in order to correct the mistake. This can be coordinated by a module called the “ToT controller” which oversees the ToT search. With the backtracking capability, the system can regenerate the solution and thus recover from errors. In addition, even when the current node is valid, if the system remains stuck at it for too long, the ToT controller could issue a backtrack signal to explore other possible solutions. This is similar to a scenario where a human mind realizes that there is no viable path towards reaching the final solution through a particular direction, prompting her to change course and explore alternative routes. This process continues until either a full solution is found (represented by a green node in the figure), or a pre-specified maximum round of conversations is reached.
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <p class="ltx_p" id="S1.p5.4">
    Note that while the above discussion utilized Sudoku solving as a tangible example to illustrate our main ideas, the ToT framework can potentially be applied to more general mathematical and logical reasoning tasks. For example, in the context of mathematical theorem proving, a full solution corresponds to the complete proof, encompassing a total of
    <math alttext="n" class="ltx_Math" display="inline" id="S1.p5.1.m1.1">
     <semantics id="S1.p5.1.m1.1a">
      <mi id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">
       n
      </mi>
      <annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b">
       <ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">
        𝑛
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">
       n
      </annotation>
     </semantics>
    </math>
    derivation steps. On the other hand, a partial solution refers to a subset of these steps, specifically the initial
    <math alttext="k" class="ltx_Math" display="inline" id="S1.p5.2.m2.1">
     <semantics id="S1.p5.2.m2.1a">
      <mi id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml">
       k
      </mi>
      <annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b">
       <ci id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">
        𝑘
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">
       k
      </annotation>
     </semantics>
    </math>
    steps, where
    <math alttext="k" class="ltx_Math" display="inline" id="S1.p5.3.m3.1">
     <semantics id="S1.p5.3.m3.1a">
      <mi id="S1.p5.3.m3.1.1" xref="S1.p5.3.m3.1.1.cmml">
       k
      </mi>
      <annotation-xml encoding="MathML-Content" id="S1.p5.3.m3.1b">
       <ci id="S1.p5.3.m3.1.1.cmml" xref="S1.p5.3.m3.1.1">
        𝑘
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">
       k
      </annotation>
     </semantics>
    </math>
    is less than
    <math alttext="n" class="ltx_Math" display="inline" id="S1.p5.4.m4.1">
     <semantics id="S1.p5.4.m4.1a">
      <mi id="S1.p5.4.m4.1.1" xref="S1.p5.4.m4.1.1.cmml">
       n
      </mi>
      <annotation-xml encoding="MathML-Content" id="S1.p5.4.m4.1b">
       <ci id="S1.p5.4.m4.1.1.cmml" xref="S1.p5.4.m4.1.1">
        𝑛
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p5.4.m4.1c">
       n
      </annotation>
     </semantics>
    </math>
    . The checker verifies the logically correctness of a given partial proof. In parallel, the prompter agent and the ToT controller can offer hints and suggestions to the LLM, encouraging it to think about the subsequent proving step, or explore different directions for theorem proving when necessary.
   </p>
  </div>
  <div class="ltx_para" id="S1.p6">
   <p class="ltx_p" id="S1.p6.1">
    To evaluate the effectiveness of the ToT framework, we implemented a ToT-based Sudoku puzzle solver and evaluate it on a suite of Sudoku puzzle benchmarks we created. As shown by the experimental results in Section
    <a class="ltx_ref" href="#S4.SS2" title="4.2 Experimental Results ‣ 4 Evaluation ‣ Large Language Model Guided Tree-of-Thought">
     <span class="ltx_text ltx_ref_tag">
      4.2
     </span>
    </a>
    , the ToT framework can significantly increase the success rate of Sudoku puzzle solving.
   </p>
  </div>
  <div class="ltx_para" id="S1.p7">
   <p class="ltx_p" id="S1.p7.1">
    The remainder of the paper is organized as follows. Section
    <a class="ltx_ref" href="#S2" title="2 Related Works ‣ Large Language Model Guided Tree-of-Thought">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    reviews the related literature and compared our approach with the most relevant works. Section
    <a class="ltx_ref" href="#S3" title="3 Architecture ‣ Large Language Model Guided Tree-of-Thought">
     <span class="ltx_text ltx_ref_tag">
      3
     </span>
    </a>
    provides the details of the ToT system architecture. Section
    <a class="ltx_ref" href="#S4" title="4 Evaluation ‣ Large Language Model Guided Tree-of-Thought">
     <span class="ltx_text ltx_ref_tag">
      4
     </span>
    </a>
    describes our implementation of a ToT-based Sudoku puzzle solver and presents the experimental results. Finally, Section
    <a class="ltx_ref" href="#S5" title="5 Discussions and Future Works ‣ Large Language Model Guided Tree-of-Thought">
     <span class="ltx_text ltx_ref_tag">
      5
     </span>
    </a>
    discusses the limitation of the present work, and potential future extensions of the ToT framework.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Works
  </h2>
  <div class="ltx_para" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    Developing intelligent systems that can reason has long been one of the primary goals of artificial intelligence
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib10" title="">
      <span class="ltx_text" style="font-size:80%;">
       wos1984autoreasoning
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib11" title="">
      <span class="ltx_text" style="font-size:80%;">
       hayesroth1983expertsystem
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib12" title="">
      <span class="ltx_text" style="font-size:80%;">
       fagin2003knowledgereasoning
      </span>
     </a>
    </cite>
    . Recent advancements in large language models, particularly the discovery of their emergent properties and in-context learning abilities, have opened up a new avenue for machine reasoning
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib6" title="">
      <span class="ltx_text" style="font-size:80%;">
       openai2023gpt4
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib7" title="">
      <span class="ltx_text" style="font-size:80%;">
       bubeck2023sparks
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib9" title="">
      <span class="ltx_text" style="font-size:80%;">
       wei2023chainofthought
      </span>
     </a>
    </cite>
    . It is discovered that prompting language models using chain-of-thought and other hints can elicit them to output step-by-step solutions for mathematical and logical reasoning tasks
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib9" title="">
      <span class="ltx_text" style="font-size:80%;">
       wei2023chainofthought
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib13" title="">
      <span class="ltx_text" style="font-size:80%;">
       drori2022sympyprompt
      </span>
     </a>
    </cite>
    . Building on these findings, recent studies have also explored the practice of sampling multiple solutions and using self-consistency or complexity-based criteria to determine the optimal response
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib14" title="">
      <span class="ltx_text" style="font-size:80%;">
       wang2023selfconsistency
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib15" title="">
      <span class="ltx_text" style="font-size:80%;">
       fu2023complexitybased
      </span>
     </a>
    </cite>
    . Experiments were also conducted to evaluate the performance of different prompts
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib15" title="">
      <span class="ltx_text" style="font-size:80%;">
       fu2023complexitybased
      </span>
     </a>
    </cite>
    . The self-taught reasoner (STaR)
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib16" title="">
      <span class="ltx_text" style="font-size:80%;">
       zelikman2022star
      </span>
     </a>
    </cite>
    is a technique which asks an LLM to generate reasoning chains and drop those producing incorrect answers. Then, the model is fine-tuned with the remaining valid reasoning chains.
   </p>
  </div>
  <div class="ltx_para" id="S2.p2">
   <p class="ltx_p" id="S2.p2.1">
    Despite showing high potential, these techniques often necessitate human involvement. For example, chain-of-thought style prompting techniques require carefully hand-crafted examples and is thus difficult to scale. Consequently, researchers have started to explore the possibility of automatic prompt generation. Early exploration in this domain includes AutoPrompt
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib17" title="">
      <span class="ltx_text" style="font-size:80%;">
       shin2020autoprompt
      </span>
     </a>
    </cite>
    , prefix-tuning
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib18" title="">
      <span class="ltx_text" style="font-size:80%;">
       li2021prefixtuning
      </span>
     </a>
    </cite>
    , and parameter-efficient prompt tuning
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib19" title="">
      <span class="ltx_text" style="font-size:80%;">
       lester2021power
      </span>
     </a>
    </cite>
    . This research direction received even more attention lately. In a recent study
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib20" title="">
      <span class="ltx_text" style="font-size:80%;">
       cobbe2021training
      </span>
     </a>
    </cite>
    , the authors experimented with training verifiers to check if the solution provided by an LLM to an given mathematical problem is logically correct. If the trained verifier can effectively judge the LLM outputs, it would provide another avenue for prompt evaluation. Automatic prompt engineer
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib21" title="">
      <span class="ltx_text" style="font-size:80%;">
       zhou2023large
      </span>
     </a>
    </cite>
    examines a method to select the best prompt from a set of model-generated candidates. The three-phase augment-prune-select method was suggested in
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib22" title="">
      <span class="ltx_text" style="font-size:80%;">
       shum2023automatic
      </span>
     </a>
    </cite>
    . It first generates multiple chain-of-thought candidates, which was then pruned based on whether the derived answer matches with the ground truths. Finally, a policy gradient based method was used to select the optimal combination of several rationale chains from the pool for CoT prompting.
   </p>
  </div>
  <div class="ltx_para" id="S2.p3">
   <p class="ltx_p" id="S2.p3.1">
    Very recently researchers have also turned their attention to augmenting LLM with additional agents for various purposes. This is also the research field that is most relevant to our current work. AutoGPT
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib23" title="">
      <span class="ltx_text" style="font-size:80%;">
       autogpt2023
      </span>
     </a>
    </cite>
    is a program which combines GPT-4 with additional modules including an execution agent and a memory unit. It can chain together LLM “thoughts”, in order to autonomously achieve whatever goal the user sets. PromptPG
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib24" title="">
      <span class="ltx_text" style="font-size:80%;">
       lu2023dynamic
      </span>
     </a>
    </cite>
    proposes an approach that can learn to select in-context examples from a small amount of training data via policy gradient for prompt learning. The PromptPG agent learns to find optimal in-context examples from a candidate pool, with the goal of maximizing the prediction rewards on given training examples when interacting with the GPT-3 environment. DEPS
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib25" title="">
      <span class="ltx_text" style="font-size:80%;">
       wang2023describe
      </span>
     </a>
    </cite>
    is a proposal that utilizes multi-step reasoning and sub-task error correction to tackle complex tasks with long-range dependencies. By being able to provide explanations for errors in sub-tasks within a trial, DEPS exhibits remarkable performance. ReAct
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib26" title="">
      <span class="ltx_text" style="font-size:80%;">
       yao2023react
      </span>
     </a>
    </cite>
    is an approach that employs emergent properties present in LLMs, such as traces of verbal reasoning, to enable agents to reason and take action, resulting in impressive performance on different text-based benchmarks. Building on top of ReAct, Reflexion
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib27" title="">
      <span class="ltx_text" style="font-size:80%;">
       shinn2023reflexion
      </span>
     </a>
    </cite>
    is an approach that equips an agent with dynamic memory and self-reflection capabilities, improving its existing reasoning trace and ability to choose task-specific actions. To achieve complete automation, a simple but effective heuristic was designed to enable the agent to identify hallucination instances and prevent repetitive action sequences. Our proposal shares some commonalities with these approaches, for example, the use of a memory module and additional agents for automatic prompt generation. However, our approach is unique in that it introduces a ToT controller which can explicitly conduct backtracking when necessary. This not only allows the system to recover from mistakes, but potentially can also enlarge the solution search space.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Architecture
  </h2>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    The Tree-of-Thought Framework
   </h3>
   <div class="ltx_para" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.1">
     Figure
     <a class="ltx_ref" href="#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ Large Language Model Guided Tree-of-Thought">
      <span class="ltx_text ltx_ref_tag">
       1(b)
      </span>
     </a>
     depicts the software system that implements the ToT Framework. As mentioned earlier, it incorporates several components which enhance the problem solving capability of the LLM, including a
     <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.1.1">
      prompter agent
     </span>
     , a
     <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.1.2">
      checker module
     </span>
     , a
     <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.1.3">
      memory module
     </span>
     , and a
     <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.1.4">
      ToT controller
     </span>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.1">
     The problem solving process starts with the user inputting the problem description. The prompter agent then relays the problem to the LLM, with additional prompt text which encourages the LLM to come up with an intermediate solution instead of trying to reach the full solution in a single shot. After receiving the response from the LLM, the checker module is invoked to check the validity of the intermediate solution generated. If it passes the correctness check, the intermediate solution will be parsed and stored in the memory module. Then, based on the content of the memory module, the prompter agent generates a prompt to encourage the LLM to generate the next step. Conversely, if the LLM generates an invalid intermediate solution, the ToT controller will activate the prompter to offer hints to the LLM and request it to consider again. Note that in general, a valid intermediate solution does not always leads to the correct final solution. In order to prevent getting stuck, the ToT controller constantly monitors the search process and determines whether to continue trying from the current node or backtrack to a parent or an ancestor node and explore alternative directions.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p3">
    <p class="ltx_p" id="S3.SS1.p3.1">
     The ToT strategy can be viewed as a tree-search algorithm using an LLM as a heuristic for generating the search steps. In this setting, the LLM is only used for the “short-range reasoning” tasks, i.e deriving the next intermediate solution, which is a type of tasks that have been shown to have a high success rate for LLMs
     <cite class="ltx_cite ltx_citemacro_cite">
      <a class="ltx_ref" href="#bib.bib7" title="">
       <span class="ltx_text" style="font-size:80%;">
        bubeck2023sparks
       </span>
      </a>
     </cite>
     . On the other hand, by introducing the checker, the system have a higher likelihood to discover the mistakes it makes as it generates the solutions. Moreover, by allowing the system to backtrack from a valid but somewhat “hopeless” intermediate solution, the system is able to explore a larger solution space, which enhances the “long-range reasoning” capability of the system as a whole. The ToT framework thus combines the best of both world. Furthermore, this multi-round conversation technique increases the number of computation steps the system can perform. Thus, based on the time hierarchy theorem in computational complexity theory
     <cite class="ltx_cite ltx_citemacro_cite">
      <a class="ltx_ref" href="#bib.bib28" title="">
       <span class="ltx_text" style="font-size:80%;">
        hartmanis1965timehierarchy
       </span>
      </a>
     </cite>
     , the ToT framework can expand the range of problems that can potentially be solved compared to relying solely on a single round of conversation with an LLM.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    ToT Modules
   </h3>
   <div class="ltx_para" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.1">
     In this section we provide more details of the components of the ToT software system.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">
      Checker Module
     </span>
     . The checker module can either be rule-based or implemented as a deep neural network. For problems that have an explicit polynomial time algorithm for correctness checking (i.e. problems in
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.2">
      NP
     </span>
     ), rule-based checkers can be implemented. Numerous important mathematical and logical problems are in this category, for example, equation solving, polynomial factoring, 3SAT, and puzzles like Sudoku. With a rule-based checker, the ToT software can be viewed as a hybrid system which allows explicitly encoding prior knowledge (e.g. the Sudoku rules) into a neural network powered system. An alternative is to train and use a neural network based classifier as the checker
     <cite class="ltx_cite ltx_citemacro_cite">
      <a class="ltx_ref" href="#bib.bib20" title="">
       <span class="ltx_text" style="font-size:80%;">
        cobbe2021training
       </span>
      </a>
     </cite>
     . This is especially useful for problems where a rule-based checker is difficult to implement, e.g. checking whether a mathematical proof is correct.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p3">
    <p class="ltx_p" id="S3.SS2.p3.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.1">
      Memory Module
     </span>
     . The memory module can be used to store the entire conversation history between the LLM and the prompter agent, as well as other supplemental data useful for problem solving. The data stored can be served as the information source for the prompter agent to generate helpful hints for the LLM.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p4">
    <p class="ltx_p" id="S3.SS2.p4.2">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p4.2.1">
      ToT Controller
     </span>
     . The ToT controller oversees the entire ToT search. It can be implemented in a number of ways. It can be as simple as encoding two rules: 1) if the checker thinks the current partial solution is invalid, backtrack to the parent node, and 2) if the current partial solution is valid, but the ToT search tree has explored its
     <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1">
      <semantics id="S3.SS2.p4.1.m1.1a">
       <mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">
        C
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b">
        <ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">
         𝐶
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">
        C
       </annotation>
      </semantics>
     </math>
     children and yet failed to find the final solution, then backtrack to the parent node. Here
     <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1">
      <semantics id="S3.SS2.p4.2.m2.1a">
       <mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">
        C
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b">
        <ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">
         𝐶
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">
        C
       </annotation>
      </semantics>
     </math>
     is an pre-configured integer.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p5">
    <p class="ltx_p" id="S3.SS2.p5.8">
     A more advanced version of the ToT controller can employ a policy network to determine the backtracking policy. The network’s inputs include the recent search history comprised of the sequence of the last
     <math alttext="k+1" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1">
      <semantics id="S3.SS2.p5.1.m1.1a">
       <mrow id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">
        <mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">
         k
        </mi>
        <mo id="S3.SS2.p5.1.m1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.cmml">
         +
        </mo>
        <mn id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b">
        <apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">
         <plus id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1">
         </plus>
         <ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">
          𝑘
         </ci>
         <cn id="S3.SS2.p5.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p5.1.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">
        k+1
       </annotation>
      </semantics>
     </math>
     node visited in the search tree
     <math alttext="s_{i-k}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1">
      <semantics id="S3.SS2.p5.2.m2.1a">
       <msub id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">
        <mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">
         s
        </mi>
        <mrow id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">
         <mi id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">
          i
         </mi>
         <mo id="S3.SS2.p5.2.m2.1.1.3.1" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">
          −
         </mo>
         <mi id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml">
          k
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b">
        <apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">
          𝑠
         </ci>
         <apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3">
          <minus id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.1">
          </minus>
          <ci id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">
           𝑖
          </ci>
          <ci id="S3.SS2.p5.2.m2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3">
           𝑘
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">
        s_{i-k}
       </annotation>
      </semantics>
     </math>
     , ..,
     <math alttext="s_{i-1}" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1">
      <semantics id="S3.SS2.p5.3.m3.1a">
       <msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">
        <mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">
         s
        </mi>
        <mrow id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">
         <mi id="S3.SS2.p5.3.m3.1.1.3.2" xref="S3.SS2.p5.3.m3.1.1.3.2.cmml">
          i
         </mi>
         <mo id="S3.SS2.p5.3.m3.1.1.3.1" xref="S3.SS2.p5.3.m3.1.1.3.1.cmml">
          −
         </mo>
         <mn id="S3.SS2.p5.3.m3.1.1.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b">
        <apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">
          𝑠
         </ci>
         <apply id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">
          <minus id="S3.SS2.p5.3.m3.1.1.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3.1">
          </minus>
          <ci id="S3.SS2.p5.3.m3.1.1.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.2">
           𝑖
          </ci>
          <cn id="S3.SS2.p5.3.m3.1.1.3.3.cmml" type="integer" xref="S3.SS2.p5.3.m3.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">
        s_{i-1}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="s_{i}" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1">
      <semantics id="S3.SS2.p5.4.m4.1a">
       <msub id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml">
        <mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">
         s
        </mi>
        <mi id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b">
        <apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">
          𝑠
         </ci>
         <ci id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">
        s_{i}
       </annotation>
      </semantics>
     </math>
     (
     <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m5.1">
      <semantics id="S3.SS2.p5.5.m5.1a">
       <mi id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b">
        <ci id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">
        k
       </annotation>
      </semantics>
     </math>
     is a hyper-parameter). The network also takes in
     <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS2.p5.6.m6.1">
      <semantics id="S3.SS2.p5.6.m6.1a">
       <msub id="S3.SS2.p5.6.m6.1.1" xref="S3.SS2.p5.6.m6.1.1.cmml">
        <mi id="S3.SS2.p5.6.m6.1.1.2" xref="S3.SS2.p5.6.m6.1.1.2.cmml">
         c
        </mi>
        <mi id="S3.SS2.p5.6.m6.1.1.3" xref="S3.SS2.p5.6.m6.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m6.1b">
        <apply id="S3.SS2.p5.6.m6.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.6.m6.1.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p5.6.m6.1.1.2.cmml" xref="S3.SS2.p5.6.m6.1.1.2">
          𝑐
         </ci>
         <ci id="S3.SS2.p5.6.m6.1.1.3.cmml" xref="S3.SS2.p5.6.m6.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.6.m6.1c">
        c_{i}
       </annotation>
      </semantics>
     </math>
     , a Boolean variable which indicates whether the checker module considers the current node
     <math alttext="s_{i}" class="ltx_Math" display="inline" id="S3.SS2.p5.7.m7.1">
      <semantics id="S3.SS2.p5.7.m7.1a">
       <msub id="S3.SS2.p5.7.m7.1.1" xref="S3.SS2.p5.7.m7.1.1.cmml">
        <mi id="S3.SS2.p5.7.m7.1.1.2" xref="S3.SS2.p5.7.m7.1.1.2.cmml">
         s
        </mi>
        <mi id="S3.SS2.p5.7.m7.1.1.3" xref="S3.SS2.p5.7.m7.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m7.1b">
        <apply id="S3.SS2.p5.7.m7.1.1.cmml" xref="S3.SS2.p5.7.m7.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.7.m7.1.1.1.cmml" xref="S3.SS2.p5.7.m7.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p5.7.m7.1.1.2.cmml" xref="S3.SS2.p5.7.m7.1.1.2">
          𝑠
         </ci>
         <ci id="S3.SS2.p5.7.m7.1.1.3.cmml" xref="S3.SS2.p5.7.m7.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.7.m7.1c">
        s_{i}
       </annotation>
      </semantics>
     </math>
     is valid. We can sample from the policy to determine the next action
     <math alttext="a_{i}" class="ltx_Math" display="inline" id="S3.SS2.p5.8.m8.1">
      <semantics id="S3.SS2.p5.8.m8.1a">
       <msub id="S3.SS2.p5.8.m8.1.1" xref="S3.SS2.p5.8.m8.1.1.cmml">
        <mi id="S3.SS2.p5.8.m8.1.1.2" xref="S3.SS2.p5.8.m8.1.1.2.cmml">
         a
        </mi>
        <mi id="S3.SS2.p5.8.m8.1.1.3" xref="S3.SS2.p5.8.m8.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m8.1b">
        <apply id="S3.SS2.p5.8.m8.1.1.cmml" xref="S3.SS2.p5.8.m8.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p5.8.m8.1.1.1.cmml" xref="S3.SS2.p5.8.m8.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p5.8.m8.1.1.2.cmml" xref="S3.SS2.p5.8.m8.1.1.2">
          𝑎
         </ci>
         <ci id="S3.SS2.p5.8.m8.1.1.3.cmml" xref="S3.SS2.p5.8.m8.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.8.m8.1c">
        a_{i}
       </annotation>
      </semantics>
     </math>
     :
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p6">
    <table class="ltx_equation ltx_eqn_table" id="S3.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="a_{i}\sim\pi^{t}_{\rho}(a|c_{i},s_{i},..,s_{i-k}),\;a\in A_{cand}" class="ltx_math_unparsed" display="block" id="S3.E1.m1.1">
         <semantics id="S3.E1.m1.1a">
          <mrow id="S3.E1.m1.1b">
           <msub id="S3.E1.m1.1.1">
            <mi id="S3.E1.m1.1.1.2">
             a
            </mi>
            <mi id="S3.E1.m1.1.1.3">
             i
            </mi>
           </msub>
           <mo id="S3.E1.m1.1.2">
            ∼
           </mo>
           <msubsup id="S3.E1.m1.1.3">
            <mi id="S3.E1.m1.1.3.2.2">
             π
            </mi>
            <mi id="S3.E1.m1.1.3.3">
             ρ
            </mi>
            <mi id="S3.E1.m1.1.3.2.3">
             t
            </mi>
           </msubsup>
           <mrow id="S3.E1.m1.1.4">
            <mo id="S3.E1.m1.1.4.1" stretchy="false">
             (
            </mo>
            <mi id="S3.E1.m1.1.4.2">
             a
            </mi>
            <mo fence="false" id="S3.E1.m1.1.4.3" rspace="0.167em" stretchy="false">
             |
            </mo>
            <msub id="S3.E1.m1.1.4.4">
             <mi id="S3.E1.m1.1.4.4.2">
              c
             </mi>
             <mi id="S3.E1.m1.1.4.4.3">
              i
             </mi>
            </msub>
            <mo id="S3.E1.m1.1.4.5">
             ,
            </mo>
            <msub id="S3.E1.m1.1.4.6">
             <mi id="S3.E1.m1.1.4.6.2">
              s
             </mi>
             <mi id="S3.E1.m1.1.4.6.3">
              i
             </mi>
            </msub>
            <mo id="S3.E1.m1.1.4.7">
             ,
            </mo>
            <mo id="S3.E1.m1.1.4.8" lspace="0em" rspace="0.0835em">
             .
            </mo>
            <mo id="S3.E1.m1.1.4.9" lspace="0.0835em" rspace="0.167em">
             .
            </mo>
            <mo id="S3.E1.m1.1.4.10">
             ,
            </mo>
            <msub id="S3.E1.m1.1.4.11">
             <mi id="S3.E1.m1.1.4.11.2">
              s
             </mi>
             <mrow id="S3.E1.m1.1.4.11.3">
              <mi id="S3.E1.m1.1.4.11.3.2">
               i
              </mi>
              <mo id="S3.E1.m1.1.4.11.3.1">
               −
              </mo>
              <mi id="S3.E1.m1.1.4.11.3.3">
               k
              </mi>
             </mrow>
            </msub>
            <mo id="S3.E1.m1.1.4.12" stretchy="false">
             )
            </mo>
           </mrow>
           <mo id="S3.E1.m1.1.5" rspace="0.447em">
            ,
           </mo>
           <mi id="S3.E1.m1.1.6">
            a
           </mi>
           <mo id="S3.E1.m1.1.7">
            ∈
           </mo>
           <msub id="S3.E1.m1.1.8">
            <mi id="S3.E1.m1.1.8.2">
             A
            </mi>
            <mrow id="S3.E1.m1.1.8.3">
             <mi id="S3.E1.m1.1.8.3.2">
              c
             </mi>
             <mo id="S3.E1.m1.1.8.3.1" lspace="0em" rspace="0em">
              ​
             </mo>
             <mi id="S3.E1.m1.1.8.3.3">
              a
             </mi>
             <mo id="S3.E1.m1.1.8.3.1a" lspace="0em" rspace="0em">
              ​
             </mo>
             <mi id="S3.E1.m1.1.8.3.4">
              n
             </mi>
             <mo id="S3.E1.m1.1.8.3.1b" lspace="0em" rspace="0em">
              ​
             </mo>
             <mi id="S3.E1.m1.1.8.3.5">
              d
             </mi>
            </mrow>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex" id="S3.E1.m1.1c">
           a_{i}\sim\pi^{t}_{\rho}(a|c_{i},s_{i},..,s_{i-k}),\;a\in A_{cand}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p7">
    <p class="ltx_p" id="S3.SS2.p7.17">
     where
     <math alttext="\pi^{t}_{\rho}" class="ltx_Math" display="inline" id="S3.SS2.p7.1.m1.1">
      <semantics id="S3.SS2.p7.1.m1.1a">
       <msubsup id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml">
        <mi id="S3.SS2.p7.1.m1.1.1.2.2" xref="S3.SS2.p7.1.m1.1.1.2.2.cmml">
         π
        </mi>
        <mi id="S3.SS2.p7.1.m1.1.1.3" xref="S3.SS2.p7.1.m1.1.1.3.cmml">
         ρ
        </mi>
        <mi id="S3.SS2.p7.1.m1.1.1.2.3" xref="S3.SS2.p7.1.m1.1.1.2.3.cmml">
         t
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b">
        <apply id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS2.p7.1.m1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1">
          <csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.2.1.cmml" xref="S3.SS2.p7.1.m1.1.1">
           superscript
          </csymbol>
          <ci id="S3.SS2.p7.1.m1.1.1.2.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2.2">
           𝜋
          </ci>
          <ci id="S3.SS2.p7.1.m1.1.1.2.3.cmml" xref="S3.SS2.p7.1.m1.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S3.SS2.p7.1.m1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.1.1.3">
          𝜌
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">
        \pi^{t}_{\rho}
       </annotation>
      </semantics>
     </math>
     represents the policy network of the ToT controller with parameters
     <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS2.p7.2.m2.1">
      <semantics id="S3.SS2.p7.2.m2.1a">
       <mi id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml">
        ρ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b">
        <ci id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1">
         𝜌
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">
        \rho
       </annotation>
      </semantics>
     </math>
     . The set of candidate actions
     <math alttext="A_{cand}" class="ltx_Math" display="inline" id="S3.SS2.p7.3.m3.1">
      <semantics id="S3.SS2.p7.3.m3.1a">
       <msub id="S3.SS2.p7.3.m3.1.1" xref="S3.SS2.p7.3.m3.1.1.cmml">
        <mi id="S3.SS2.p7.3.m3.1.1.2" xref="S3.SS2.p7.3.m3.1.1.2.cmml">
         A
        </mi>
        <mrow id="S3.SS2.p7.3.m3.1.1.3" xref="S3.SS2.p7.3.m3.1.1.3.cmml">
         <mi id="S3.SS2.p7.3.m3.1.1.3.2" xref="S3.SS2.p7.3.m3.1.1.3.2.cmml">
          c
         </mi>
         <mo id="S3.SS2.p7.3.m3.1.1.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p7.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p7.3.m3.1.1.3.3" xref="S3.SS2.p7.3.m3.1.1.3.3.cmml">
          a
         </mi>
         <mo id="S3.SS2.p7.3.m3.1.1.3.1a" lspace="0em" rspace="0em" xref="S3.SS2.p7.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p7.3.m3.1.1.3.4" xref="S3.SS2.p7.3.m3.1.1.3.4.cmml">
          n
         </mi>
         <mo id="S3.SS2.p7.3.m3.1.1.3.1b" lspace="0em" rspace="0em" xref="S3.SS2.p7.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p7.3.m3.1.1.3.5" xref="S3.SS2.p7.3.m3.1.1.3.5.cmml">
          d
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.3.m3.1b">
        <apply id="S3.SS2.p7.3.m3.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p7.3.m3.1.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p7.3.m3.1.1.2.cmml" xref="S3.SS2.p7.3.m3.1.1.2">
          𝐴
         </ci>
         <apply id="S3.SS2.p7.3.m3.1.1.3.cmml" xref="S3.SS2.p7.3.m3.1.1.3">
          <times id="S3.SS2.p7.3.m3.1.1.3.1.cmml" xref="S3.SS2.p7.3.m3.1.1.3.1">
          </times>
          <ci id="S3.SS2.p7.3.m3.1.1.3.2.cmml" xref="S3.SS2.p7.3.m3.1.1.3.2">
           𝑐
          </ci>
          <ci id="S3.SS2.p7.3.m3.1.1.3.3.cmml" xref="S3.SS2.p7.3.m3.1.1.3.3">
           𝑎
          </ci>
          <ci id="S3.SS2.p7.3.m3.1.1.3.4.cmml" xref="S3.SS2.p7.3.m3.1.1.3.4">
           𝑛
          </ci>
          <ci id="S3.SS2.p7.3.m3.1.1.3.5.cmml" xref="S3.SS2.p7.3.m3.1.1.3.5">
           𝑑
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.3.m3.1c">
        A_{cand}
       </annotation>
      </semantics>
     </math>
     includes simply staying at the current node to generate the next step, and backtracking to the parent or an ancestor node at most
     <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p7.4.m4.1">
      <semantics id="S3.SS2.p7.4.m4.1a">
       <mi id="S3.SS2.p7.4.m4.1.1" xref="S3.SS2.p7.4.m4.1.1.cmml">
        L
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.4.m4.1b">
        <ci id="S3.SS2.p7.4.m4.1.1.cmml" xref="S3.SS2.p7.4.m4.1.1">
         𝐿
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.4.m4.1c">
        L
       </annotation>
      </semantics>
     </math>
     levels up in the search tree where
     <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p7.5.m5.1">
      <semantics id="S3.SS2.p7.5.m5.1a">
       <mi id="S3.SS2.p7.5.m5.1.1" xref="S3.SS2.p7.5.m5.1.1.cmml">
        L
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.5.m5.1b">
        <ci id="S3.SS2.p7.5.m5.1.1.cmml" xref="S3.SS2.p7.5.m5.1.1">
         𝐿
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.5.m5.1c">
        L
       </annotation>
      </semantics>
     </math>
     is a hyper-parameter. Thus, we can use one-hot encoding for the actions, where backtracking
     <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p7.6.m6.1">
      <semantics id="S3.SS2.p7.6.m6.1a">
       <mi id="S3.SS2.p7.6.m6.1.1" xref="S3.SS2.p7.6.m6.1.1.cmml">
        j
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.6.m6.1b">
        <ci id="S3.SS2.p7.6.m6.1.1.cmml" xref="S3.SS2.p7.6.m6.1.1">
         𝑗
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.6.m6.1c">
        j
       </annotation>
      </semantics>
     </math>
     levels up is represented by a vector where only the
     <math alttext="j^{\textrm{th}}" class="ltx_Math" display="inline" id="S3.SS2.p7.7.m7.1">
      <semantics id="S3.SS2.p7.7.m7.1a">
       <msup id="S3.SS2.p7.7.m7.1.1" xref="S3.SS2.p7.7.m7.1.1.cmml">
        <mi id="S3.SS2.p7.7.m7.1.1.2" xref="S3.SS2.p7.7.m7.1.1.2.cmml">
         j
        </mi>
        <mtext id="S3.SS2.p7.7.m7.1.1.3" xref="S3.SS2.p7.7.m7.1.1.3a.cmml">
         th
        </mtext>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.7.m7.1b">
        <apply id="S3.SS2.p7.7.m7.1.1.cmml" xref="S3.SS2.p7.7.m7.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p7.7.m7.1.1.1.cmml" xref="S3.SS2.p7.7.m7.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS2.p7.7.m7.1.1.2.cmml" xref="S3.SS2.p7.7.m7.1.1.2">
          𝑗
         </ci>
         <ci id="S3.SS2.p7.7.m7.1.1.3a.cmml" xref="S3.SS2.p7.7.m7.1.1.3">
          <mtext id="S3.SS2.p7.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p7.7.m7.1.1.3">
           th
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.7.m7.1c">
        j^{\textrm{th}}
       </annotation>
      </semantics>
     </math>
     position is set to 1. The action vector
     <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p7.8.m8.1">
      <semantics id="S3.SS2.p7.8.m8.1a">
       <mi id="S3.SS2.p7.8.m8.1.1" xref="S3.SS2.p7.8.m8.1.1.cmml">
        a
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.8.m8.1b">
        <ci id="S3.SS2.p7.8.m8.1.1.cmml" xref="S3.SS2.p7.8.m8.1.1">
         𝑎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.8.m8.1c">
        a
       </annotation>
      </semantics>
     </math>
     and checker output
     <math alttext="c_{i}" class="ltx_Math" display="inline" id="S3.SS2.p7.9.m9.1">
      <semantics id="S3.SS2.p7.9.m9.1a">
       <msub id="S3.SS2.p7.9.m9.1.1" xref="S3.SS2.p7.9.m9.1.1.cmml">
        <mi id="S3.SS2.p7.9.m9.1.1.2" xref="S3.SS2.p7.9.m9.1.1.2.cmml">
         c
        </mi>
        <mi id="S3.SS2.p7.9.m9.1.1.3" xref="S3.SS2.p7.9.m9.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.9.m9.1b">
        <apply id="S3.SS2.p7.9.m9.1.1.cmml" xref="S3.SS2.p7.9.m9.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p7.9.m9.1.1.1.cmml" xref="S3.SS2.p7.9.m9.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p7.9.m9.1.1.2.cmml" xref="S3.SS2.p7.9.m9.1.1.2">
          𝑐
         </ci>
         <ci id="S3.SS2.p7.9.m9.1.1.3.cmml" xref="S3.SS2.p7.9.m9.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.9.m9.1c">
        c_{i}
       </annotation>
      </semantics>
     </math>
     are processed by a feed-forward network (FFN) to for deep features extraction. A linear layer with learnable parameters
     <math alttext="\mathbf{W}_{1}" class="ltx_Math" display="inline" id="S3.SS2.p7.10.m10.1">
      <semantics id="S3.SS2.p7.10.m10.1a">
       <msub id="S3.SS2.p7.10.m10.1.1" xref="S3.SS2.p7.10.m10.1.1.cmml">
        <mi id="S3.SS2.p7.10.m10.1.1.2" xref="S3.SS2.p7.10.m10.1.1.2.cmml">
         𝐖
        </mi>
        <mn id="S3.SS2.p7.10.m10.1.1.3" xref="S3.SS2.p7.10.m10.1.1.3.cmml">
         1
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.10.m10.1b">
        <apply id="S3.SS2.p7.10.m10.1.1.cmml" xref="S3.SS2.p7.10.m10.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p7.10.m10.1.1.1.cmml" xref="S3.SS2.p7.10.m10.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p7.10.m10.1.1.2.cmml" xref="S3.SS2.p7.10.m10.1.1.2">
          𝐖
         </ci>
         <cn id="S3.SS2.p7.10.m10.1.1.3.cmml" type="integer" xref="S3.SS2.p7.10.m10.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.10.m10.1c">
        \mathbf{W}_{1}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\mathbf{b}_{1}" class="ltx_Math" display="inline" id="S3.SS2.p7.11.m11.1">
      <semantics id="S3.SS2.p7.11.m11.1a">
       <msub id="S3.SS2.p7.11.m11.1.1" xref="S3.SS2.p7.11.m11.1.1.cmml">
        <mi id="S3.SS2.p7.11.m11.1.1.2" xref="S3.SS2.p7.11.m11.1.1.2.cmml">
         𝐛
        </mi>
        <mn id="S3.SS2.p7.11.m11.1.1.3" xref="S3.SS2.p7.11.m11.1.1.3.cmml">
         1
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.11.m11.1b">
        <apply id="S3.SS2.p7.11.m11.1.1.cmml" xref="S3.SS2.p7.11.m11.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p7.11.m11.1.1.1.cmml" xref="S3.SS2.p7.11.m11.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p7.11.m11.1.1.2.cmml" xref="S3.SS2.p7.11.m11.1.1.2">
          𝐛
         </ci>
         <cn id="S3.SS2.p7.11.m11.1.1.3.cmml" type="integer" xref="S3.SS2.p7.11.m11.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.11.m11.1c">
        \mathbf{b}_{1}
       </annotation>
      </semantics>
     </math>
     is added on top of the FFN to map its output to a vector
     <math alttext="\mathbf{g}(a,c_{i})" class="ltx_Math" display="inline" id="S3.SS2.p7.12.m12.2">
      <semantics id="S3.SS2.p7.12.m12.2a">
       <mrow id="S3.SS2.p7.12.m12.2.2" xref="S3.SS2.p7.12.m12.2.2.cmml">
        <mi id="S3.SS2.p7.12.m12.2.2.3" xref="S3.SS2.p7.12.m12.2.2.3.cmml">
         𝐠
        </mi>
        <mo id="S3.SS2.p7.12.m12.2.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p7.12.m12.2.2.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p7.12.m12.2.2.1.1" xref="S3.SS2.p7.12.m12.2.2.1.2.cmml">
         <mo id="S3.SS2.p7.12.m12.2.2.1.1.2" stretchy="false" xref="S3.SS2.p7.12.m12.2.2.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p7.12.m12.1.1" xref="S3.SS2.p7.12.m12.1.1.cmml">
          a
         </mi>
         <mo id="S3.SS2.p7.12.m12.2.2.1.1.3" xref="S3.SS2.p7.12.m12.2.2.1.2.cmml">
          ,
         </mo>
         <msub id="S3.SS2.p7.12.m12.2.2.1.1.1" xref="S3.SS2.p7.12.m12.2.2.1.1.1.cmml">
          <mi id="S3.SS2.p7.12.m12.2.2.1.1.1.2" xref="S3.SS2.p7.12.m12.2.2.1.1.1.2.cmml">
           c
          </mi>
          <mi id="S3.SS2.p7.12.m12.2.2.1.1.1.3" xref="S3.SS2.p7.12.m12.2.2.1.1.1.3.cmml">
           i
          </mi>
         </msub>
         <mo id="S3.SS2.p7.12.m12.2.2.1.1.4" stretchy="false" xref="S3.SS2.p7.12.m12.2.2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.12.m12.2b">
        <apply id="S3.SS2.p7.12.m12.2.2.cmml" xref="S3.SS2.p7.12.m12.2.2">
         <times id="S3.SS2.p7.12.m12.2.2.2.cmml" xref="S3.SS2.p7.12.m12.2.2.2">
         </times>
         <ci id="S3.SS2.p7.12.m12.2.2.3.cmml" xref="S3.SS2.p7.12.m12.2.2.3">
          𝐠
         </ci>
         <interval closure="open" id="S3.SS2.p7.12.m12.2.2.1.2.cmml" xref="S3.SS2.p7.12.m12.2.2.1.1">
          <ci id="S3.SS2.p7.12.m12.1.1.cmml" xref="S3.SS2.p7.12.m12.1.1">
           𝑎
          </ci>
          <apply id="S3.SS2.p7.12.m12.2.2.1.1.1.cmml" xref="S3.SS2.p7.12.m12.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS2.p7.12.m12.2.2.1.1.1.1.cmml" xref="S3.SS2.p7.12.m12.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS2.p7.12.m12.2.2.1.1.1.2.cmml" xref="S3.SS2.p7.12.m12.2.2.1.1.1.2">
            𝑐
           </ci>
           <ci id="S3.SS2.p7.12.m12.2.2.1.1.1.3.cmml" xref="S3.SS2.p7.12.m12.2.2.1.1.1.3">
            𝑖
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.12.m12.2c">
        \mathbf{g}(a,c_{i})
       </annotation>
      </semantics>
     </math>
     . The latest
     <math alttext="k+1" class="ltx_Math" display="inline" id="S3.SS2.p7.13.m13.1">
      <semantics id="S3.SS2.p7.13.m13.1a">
       <mrow id="S3.SS2.p7.13.m13.1.1" xref="S3.SS2.p7.13.m13.1.1.cmml">
        <mi id="S3.SS2.p7.13.m13.1.1.2" xref="S3.SS2.p7.13.m13.1.1.2.cmml">
         k
        </mi>
        <mo id="S3.SS2.p7.13.m13.1.1.1" xref="S3.SS2.p7.13.m13.1.1.1.cmml">
         +
        </mo>
        <mn id="S3.SS2.p7.13.m13.1.1.3" xref="S3.SS2.p7.13.m13.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.13.m13.1b">
        <apply id="S3.SS2.p7.13.m13.1.1.cmml" xref="S3.SS2.p7.13.m13.1.1">
         <plus id="S3.SS2.p7.13.m13.1.1.1.cmml" xref="S3.SS2.p7.13.m13.1.1.1">
         </plus>
         <ci id="S3.SS2.p7.13.m13.1.1.2.cmml" xref="S3.SS2.p7.13.m13.1.1.2">
          𝑘
         </ci>
         <cn id="S3.SS2.p7.13.m13.1.1.3.cmml" type="integer" xref="S3.SS2.p7.13.m13.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.13.m13.1c">
        k+1
       </annotation>
      </semantics>
     </math>
     visited nodes are concatenated into a string, and then added with position embedding (PE), and finally inputted into a self-attention model
     <cite class="ltx_cite ltx_citemacro_cite">
      <a class="ltx_ref" href="#bib.bib1" title="">
       <span class="ltx_text" style="font-size:80%;">
        vaswani2017attention
       </span>
      </a>
     </cite>
     . The idea is that by adding position embedding, the attention model will be able to make decisions based on the sequence of the recent node visits. A linear layer with learnable parameters
     <math alttext="\mathbf{W}_{2}" class="ltx_Math" display="inline" id="S3.SS2.p7.14.m14.1">
      <semantics id="S3.SS2.p7.14.m14.1a">
       <msub id="S3.SS2.p7.14.m14.1.1" xref="S3.SS2.p7.14.m14.1.1.cmml">
        <mi id="S3.SS2.p7.14.m14.1.1.2" xref="S3.SS2.p7.14.m14.1.1.2.cmml">
         𝐖
        </mi>
        <mn id="S3.SS2.p7.14.m14.1.1.3" xref="S3.SS2.p7.14.m14.1.1.3.cmml">
         2
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.14.m14.1b">
        <apply id="S3.SS2.p7.14.m14.1.1.cmml" xref="S3.SS2.p7.14.m14.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p7.14.m14.1.1.1.cmml" xref="S3.SS2.p7.14.m14.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p7.14.m14.1.1.2.cmml" xref="S3.SS2.p7.14.m14.1.1.2">
          𝐖
         </ci>
         <cn id="S3.SS2.p7.14.m14.1.1.3.cmml" type="integer" xref="S3.SS2.p7.14.m14.1.1.3">
          2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.14.m14.1c">
        \mathbf{W}_{2}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\mathbf{b}_{2}" class="ltx_Math" display="inline" id="S3.SS2.p7.15.m15.1">
      <semantics id="S3.SS2.p7.15.m15.1a">
       <msub id="S3.SS2.p7.15.m15.1.1" xref="S3.SS2.p7.15.m15.1.1.cmml">
        <mi id="S3.SS2.p7.15.m15.1.1.2" xref="S3.SS2.p7.15.m15.1.1.2.cmml">
         𝐛
        </mi>
        <mn id="S3.SS2.p7.15.m15.1.1.3" xref="S3.SS2.p7.15.m15.1.1.3.cmml">
         2
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.15.m15.1b">
        <apply id="S3.SS2.p7.15.m15.1.1.cmml" xref="S3.SS2.p7.15.m15.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p7.15.m15.1.1.1.cmml" xref="S3.SS2.p7.15.m15.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p7.15.m15.1.1.2.cmml" xref="S3.SS2.p7.15.m15.1.1.2">
          𝐛
         </ci>
         <cn id="S3.SS2.p7.15.m15.1.1.3.cmml" type="integer" xref="S3.SS2.p7.15.m15.1.1.3">
          2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.15.m15.1c">
        \mathbf{b}_{2}
       </annotation>
      </semantics>
     </math>
     is added on top of the attention model to transform its output to a vector
     <math alttext="\mathbf{g}(s_{i},..,s_{i-k})" class="ltx_math_unparsed" display="inline" id="S3.SS2.p7.16.m16.1">
      <semantics id="S3.SS2.p7.16.m16.1a">
       <mrow id="S3.SS2.p7.16.m16.1b">
        <mi id="S3.SS2.p7.16.m16.1.1">
         𝐠
        </mi>
        <mrow id="S3.SS2.p7.16.m16.1.2">
         <mo id="S3.SS2.p7.16.m16.1.2.1" stretchy="false">
          (
         </mo>
         <msub id="S3.SS2.p7.16.m16.1.2.2">
          <mi id="S3.SS2.p7.16.m16.1.2.2.2">
           s
          </mi>
          <mi id="S3.SS2.p7.16.m16.1.2.2.3">
           i
          </mi>
         </msub>
         <mo id="S3.SS2.p7.16.m16.1.2.3">
          ,
         </mo>
         <mo id="S3.SS2.p7.16.m16.1.2.4" lspace="0em" rspace="0.0835em">
          .
         </mo>
         <mo id="S3.SS2.p7.16.m16.1.2.5" lspace="0.0835em" rspace="0.167em">
          .
         </mo>
         <mo id="S3.SS2.p7.16.m16.1.2.6">
          ,
         </mo>
         <msub id="S3.SS2.p7.16.m16.1.2.7">
          <mi id="S3.SS2.p7.16.m16.1.2.7.2">
           s
          </mi>
          <mrow id="S3.SS2.p7.16.m16.1.2.7.3">
           <mi id="S3.SS2.p7.16.m16.1.2.7.3.2">
            i
           </mi>
           <mo id="S3.SS2.p7.16.m16.1.2.7.3.1">
            −
           </mo>
           <mi id="S3.SS2.p7.16.m16.1.2.7.3.3">
            k
           </mi>
          </mrow>
         </msub>
         <mo id="S3.SS2.p7.16.m16.1.2.8" stretchy="false">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.16.m16.1c">
        \mathbf{g}(s_{i},..,s_{i-k})
       </annotation>
      </semantics>
     </math>
     whose dimension matches with that of
     <math alttext="\mathbf{g}(a,c_{i})" class="ltx_Math" display="inline" id="S3.SS2.p7.17.m17.2">
      <semantics id="S3.SS2.p7.17.m17.2a">
       <mrow id="S3.SS2.p7.17.m17.2.2" xref="S3.SS2.p7.17.m17.2.2.cmml">
        <mi id="S3.SS2.p7.17.m17.2.2.3" xref="S3.SS2.p7.17.m17.2.2.3.cmml">
         𝐠
        </mi>
        <mo id="S3.SS2.p7.17.m17.2.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p7.17.m17.2.2.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p7.17.m17.2.2.1.1" xref="S3.SS2.p7.17.m17.2.2.1.2.cmml">
         <mo id="S3.SS2.p7.17.m17.2.2.1.1.2" stretchy="false" xref="S3.SS2.p7.17.m17.2.2.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p7.17.m17.1.1" xref="S3.SS2.p7.17.m17.1.1.cmml">
          a
         </mi>
         <mo id="S3.SS2.p7.17.m17.2.2.1.1.3" xref="S3.SS2.p7.17.m17.2.2.1.2.cmml">
          ,
         </mo>
         <msub id="S3.SS2.p7.17.m17.2.2.1.1.1" xref="S3.SS2.p7.17.m17.2.2.1.1.1.cmml">
          <mi id="S3.SS2.p7.17.m17.2.2.1.1.1.2" xref="S3.SS2.p7.17.m17.2.2.1.1.1.2.cmml">
           c
          </mi>
          <mi id="S3.SS2.p7.17.m17.2.2.1.1.1.3" xref="S3.SS2.p7.17.m17.2.2.1.1.1.3.cmml">
           i
          </mi>
         </msub>
         <mo id="S3.SS2.p7.17.m17.2.2.1.1.4" stretchy="false" xref="S3.SS2.p7.17.m17.2.2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.17.m17.2b">
        <apply id="S3.SS2.p7.17.m17.2.2.cmml" xref="S3.SS2.p7.17.m17.2.2">
         <times id="S3.SS2.p7.17.m17.2.2.2.cmml" xref="S3.SS2.p7.17.m17.2.2.2">
         </times>
         <ci id="S3.SS2.p7.17.m17.2.2.3.cmml" xref="S3.SS2.p7.17.m17.2.2.3">
          𝐠
         </ci>
         <interval closure="open" id="S3.SS2.p7.17.m17.2.2.1.2.cmml" xref="S3.SS2.p7.17.m17.2.2.1.1">
          <ci id="S3.SS2.p7.17.m17.1.1.cmml" xref="S3.SS2.p7.17.m17.1.1">
           𝑎
          </ci>
          <apply id="S3.SS2.p7.17.m17.2.2.1.1.1.cmml" xref="S3.SS2.p7.17.m17.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS2.p7.17.m17.2.2.1.1.1.1.cmml" xref="S3.SS2.p7.17.m17.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS2.p7.17.m17.2.2.1.1.1.2.cmml" xref="S3.SS2.p7.17.m17.2.2.1.1.1.2">
            𝑐
           </ci>
           <ci id="S3.SS2.p7.17.m17.2.2.1.1.1.3.cmml" xref="S3.SS2.p7.17.m17.2.2.1.1.1.3">
            𝑖
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.17.m17.2c">
        \mathbf{g}(a,c_{i})
       </annotation>
      </semantics>
     </math>
     . Finally, we calculate the inner-products of these two vectors, and use the softmax function to compute the probability of each action candidate:
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p8">
    <table class="ltx_equation ltx_eqn_table" id="S3.E2">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\begin{split}\mathbf{g}(a,c_{i})&amp;=\mathbf{W}_{1}\cdot\textrm{FFN}(a,c_{i})+\mathbf{b}_{1}\\
\mathbf{g}(s_{i},..,s_{i-k})&amp;=\mathbf{W}_{2}\cdot\textrm{Attention}(\textrm{PE}(s_{i-k}||..||s_{i-1}||s_{i}))+\mathbf{b}_{2}\\
\pi^{t}_{\rho}(a|c_{i},s_{i},..,s_{i-k})&amp;=\frac{\textrm{exp}(\mathbf{g}(a,c_{i})\cdot\mathbf{g}(s_{i},..,s_{i-k}))}{\sum_{a^{\prime}\in A_{cand}}{\textrm{exp}(\mathbf{g}(a^{\prime},c_{i})\cdot\mathbf{g}(s_{i},..,s_{i-k}))}}\end{split}" class="ltx_math_unparsed" display="block" id="S3.E2.m1.81">
         <semantics id="S3.E2.m1.81a">
          <mtable columnspacing="0pt" displaystyle="true" id="S3.E2.m1.81.81.2" rowspacing="0pt">
           <mtr id="S3.E2.m1.81.81.2a">
            <mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.81.81.2b">
             <mrow id="S3.E2.m1.80.80.1.80.22.8">
              <mi id="S3.E2.m1.1.1.1.1.1.1">
               𝐠
              </mi>
              <mo id="S3.E2.m1.80.80.1.80.22.8.9" lspace="0em" rspace="0em">
               ​
              </mo>
              <mrow id="S3.E2.m1.80.80.1.80.22.8.8.1">
               <mo id="S3.E2.m1.2.2.2.2.2.2" stretchy="false">
                (
               </mo>
               <mi id="S3.E2.m1.3.3.3.3.3.3">
                a
               </mi>
               <mo id="S3.E2.m1.4.4.4.4.4.4">
                ,
               </mo>
               <msub id="S3.E2.m1.80.80.1.80.22.8.8.1.1">
                <mi id="S3.E2.m1.5.5.5.5.5.5">
                 c
                </mi>
                <mi id="S3.E2.m1.6.6.6.6.6.6.1">
                 i
                </mi>
               </msub>
               <mo id="S3.E2.m1.7.7.7.7.7.7" stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
            </mtd>
            <mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.81.81.2c">
             <mrow id="S3.E2.m1.81.81.2.81.23.15">
              <mi id="S3.E2.m1.81.81.2.81.23.15.16">
              </mi>
              <mo id="S3.E2.m1.8.8.8.8.1.1">
               =
              </mo>
              <mrow id="S3.E2.m1.81.81.2.81.23.15.15">
               <mrow id="S3.E2.m1.81.81.2.81.23.15.15.1">
                <mrow id="S3.E2.m1.81.81.2.81.23.15.15.1.3">
                 <msub id="S3.E2.m1.81.81.2.81.23.15.15.1.3.1">
                  <mi id="S3.E2.m1.9.9.9.9.2.2">
                   𝐖
                  </mi>
                  <mn id="S3.E2.m1.10.10.10.10.3.3.1">
                   1
                  </mn>
                 </msub>
                 <mo id="S3.E2.m1.11.11.11.11.4.4" lspace="0.222em" rspace="0.222em">
                  ⋅
                 </mo>
                 <mtext id="S3.E2.m1.12.12.12.12.5.5">
                  FFN
                 </mtext>
                </mrow>
                <mo id="S3.E2.m1.81.81.2.81.23.15.15.1.2" lspace="0em" rspace="0em">
                 ​
                </mo>
                <mrow id="S3.E2.m1.81.81.2.81.23.15.15.1.1.1">
                 <mo id="S3.E2.m1.13.13.13.13.6.6" stretchy="false">
                  (
                 </mo>
                 <mi id="S3.E2.m1.14.14.14.14.7.7">
                  a
                 </mi>
                 <mo id="S3.E2.m1.15.15.15.15.8.8">
                  ,
                 </mo>
                 <msub id="S3.E2.m1.81.81.2.81.23.15.15.1.1.1.1">
                  <mi id="S3.E2.m1.16.16.16.16.9.9">
                   c
                  </mi>
                  <mi id="S3.E2.m1.17.17.17.17.10.10.1">
                   i
                  </mi>
                 </msub>
                 <mo id="S3.E2.m1.18.18.18.18.11.11" stretchy="false">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="S3.E2.m1.19.19.19.19.12.12">
                +
               </mo>
               <msub id="S3.E2.m1.81.81.2.81.23.15.15.2">
                <mi id="S3.E2.m1.20.20.20.20.13.13">
                 𝐛
                </mi>
                <mn id="S3.E2.m1.21.21.21.21.14.14.1">
                 1
                </mn>
               </msub>
              </mrow>
             </mrow>
            </mtd>
           </mtr>
           <mtr id="S3.E2.m1.81.81.2d">
            <mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.81.81.2e">
             <mrow id="S3.E2.m1.32.32.32.11.11">
              <mi id="S3.E2.m1.22.22.22.1.1.1">
               𝐠
              </mi>
              <mrow id="S3.E2.m1.32.32.32.11.11.12">
               <mo id="S3.E2.m1.23.23.23.2.2.2" stretchy="false">
                (
               </mo>
               <msub id="S3.E2.m1.32.32.32.11.11.12.1">
                <mi id="S3.E2.m1.24.24.24.3.3.3">
                 s
                </mi>
                <mi id="S3.E2.m1.25.25.25.4.4.4.1">
                 i
                </mi>
               </msub>
               <mo id="S3.E2.m1.26.26.26.5.5.5">
                ,
               </mo>
               <mo id="S3.E2.m1.27.27.27.6.6.6" lspace="0em" rspace="0.0835em">
                .
               </mo>
               <mo id="S3.E2.m1.28.28.28.7.7.7" lspace="0.0835em" rspace="0.167em">
                .
               </mo>
               <mo id="S3.E2.m1.29.29.29.8.8.8">
                ,
               </mo>
               <msub id="S3.E2.m1.32.32.32.11.11.12.2">
                <mi id="S3.E2.m1.30.30.30.9.9.9">
                 s
                </mi>
                <mrow id="S3.E2.m1.31.31.31.10.10.10.1">
                 <mi id="S3.E2.m1.31.31.31.10.10.10.1.2">
                  i
                 </mi>
                 <mo id="S3.E2.m1.31.31.31.10.10.10.1.1">
                  −
                 </mo>
                 <mi id="S3.E2.m1.31.31.31.10.10.10.1.3">
                  k
                 </mi>
                </mrow>
               </msub>
               <mo id="S3.E2.m1.32.32.32.11.11.11" stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
            </mtd>
            <mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.81.81.2f">
             <mrow id="S3.E2.m1.59.59.59.38.27">
              <mo id="S3.E2.m1.33.33.33.12.1.1">
               =
              </mo>
              <msub id="S3.E2.m1.59.59.59.38.27.28">
               <mi id="S3.E2.m1.34.34.34.13.2.2">
                𝐖
               </mi>
               <mn id="S3.E2.m1.35.35.35.14.3.3.1">
                2
               </mn>
              </msub>
              <mo id="S3.E2.m1.36.36.36.15.4.4" lspace="0.222em" rspace="0.222em">
               ⋅
              </mo>
              <mtext id="S3.E2.m1.37.37.37.16.5.5">
               Attention
              </mtext>
              <mrow id="S3.E2.m1.59.59.59.38.27.29">
               <mo id="S3.E2.m1.38.38.38.17.6.6" stretchy="false">
                (
               </mo>
               <mtext id="S3.E2.m1.39.39.39.18.7.7">
                PE
               </mtext>
               <mrow id="S3.E2.m1.59.59.59.38.27.29.1">
                <mo id="S3.E2.m1.40.40.40.19.8.8" stretchy="false">
                 (
                </mo>
                <msub id="S3.E2.m1.59.59.59.38.27.29.1.1">
                 <mi id="S3.E2.m1.41.41.41.20.9.9">
                  s
                 </mi>
                 <mrow id="S3.E2.m1.42.42.42.21.10.10.1">
                  <mi id="S3.E2.m1.42.42.42.21.10.10.1.2">
                   i
                  </mi>
                  <mo id="S3.E2.m1.42.42.42.21.10.10.1.1">
                   −
                  </mo>
                  <mi id="S3.E2.m1.42.42.42.21.10.10.1.3">
                   k
                  </mi>
                 </mrow>
                </msub>
                <mo fence="false" id="S3.E2.m1.43.43.43.22.11.11" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <mo fence="false" id="S3.E2.m1.44.44.44.23.12.12" stretchy="false">
                 |
                </mo>
                <mo id="S3.E2.m1.45.45.45.24.13.13" lspace="0.167em" rspace="0.0835em">
                 .
                </mo>
                <mo id="S3.E2.m1.46.46.46.25.14.14" lspace="0.0835em" rspace="0.167em">
                 .
                </mo>
                <mo fence="false" id="S3.E2.m1.47.47.47.26.15.15" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <mo fence="false" id="S3.E2.m1.48.48.48.27.16.16" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <msub id="S3.E2.m1.59.59.59.38.27.29.1.2">
                 <mi id="S3.E2.m1.49.49.49.28.17.17">
                  s
                 </mi>
                 <mrow id="S3.E2.m1.50.50.50.29.18.18.1">
                  <mi id="S3.E2.m1.50.50.50.29.18.18.1.2">
                   i
                  </mi>
                  <mo id="S3.E2.m1.50.50.50.29.18.18.1.1">
                   −
                  </mo>
                  <mn id="S3.E2.m1.50.50.50.29.18.18.1.3">
                   1
                  </mn>
                 </mrow>
                </msub>
                <mo fence="false" id="S3.E2.m1.51.51.51.30.19.19" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <mo fence="false" id="S3.E2.m1.52.52.52.31.20.20" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <msub id="S3.E2.m1.59.59.59.38.27.29.1.3">
                 <mi id="S3.E2.m1.53.53.53.32.21.21">
                  s
                 </mi>
                 <mi id="S3.E2.m1.54.54.54.33.22.22.1">
                  i
                 </mi>
                </msub>
                <mo id="S3.E2.m1.55.55.55.34.23.23" stretchy="false">
                 )
                </mo>
               </mrow>
               <mo id="S3.E2.m1.56.56.56.35.24.24" stretchy="false">
                )
               </mo>
              </mrow>
              <mo id="S3.E2.m1.57.57.57.36.25.25">
               +
              </mo>
              <msub id="S3.E2.m1.59.59.59.38.27.30">
               <mi id="S3.E2.m1.58.58.58.37.26.26">
                𝐛
               </mi>
               <mn id="S3.E2.m1.59.59.59.38.27.27.1">
                2
               </mn>
              </msub>
             </mrow>
            </mtd>
           </mtr>
           <mtr id="S3.E2.m1.81.81.2g">
            <mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.81.81.2h">
             <mrow id="S3.E2.m1.77.77.77.18.18">
              <msubsup id="S3.E2.m1.77.77.77.18.18.19">
               <mi id="S3.E2.m1.60.60.60.1.1.1">
                π
               </mi>
               <mi id="S3.E2.m1.62.62.62.3.3.3.1">
                ρ
               </mi>
               <mi id="S3.E2.m1.61.61.61.2.2.2.1">
                t
               </mi>
              </msubsup>
              <mrow id="S3.E2.m1.77.77.77.18.18.20">
               <mo id="S3.E2.m1.63.63.63.4.4.4" stretchy="false">
                (
               </mo>
               <mi id="S3.E2.m1.64.64.64.5.5.5">
                a
               </mi>
               <mo fence="false" id="S3.E2.m1.65.65.65.6.6.6" rspace="0.167em" stretchy="false">
                |
               </mo>
               <msub id="S3.E2.m1.77.77.77.18.18.20.1">
                <mi id="S3.E2.m1.66.66.66.7.7.7">
                 c
                </mi>
                <mi id="S3.E2.m1.67.67.67.8.8.8.1">
                 i
                </mi>
               </msub>
               <mo id="S3.E2.m1.68.68.68.9.9.9">
                ,
               </mo>
               <msub id="S3.E2.m1.77.77.77.18.18.20.2">
                <mi id="S3.E2.m1.69.69.69.10.10.10">
                 s
                </mi>
                <mi id="S3.E2.m1.70.70.70.11.11.11.1">
                 i
                </mi>
               </msub>
               <mo id="S3.E2.m1.71.71.71.12.12.12">
                ,
               </mo>
               <mo id="S3.E2.m1.72.72.72.13.13.13" lspace="0em" rspace="0.0835em">
                .
               </mo>
               <mo id="S3.E2.m1.73.73.73.14.14.14" lspace="0.0835em" rspace="0.167em">
                .
               </mo>
               <mo id="S3.E2.m1.74.74.74.15.15.15">
                ,
               </mo>
               <msub id="S3.E2.m1.77.77.77.18.18.20.3">
                <mi id="S3.E2.m1.75.75.75.16.16.16">
                 s
                </mi>
                <mrow id="S3.E2.m1.76.76.76.17.17.17.1">
                 <mi id="S3.E2.m1.76.76.76.17.17.17.1.2">
                  i
                 </mi>
                 <mo id="S3.E2.m1.76.76.76.17.17.17.1.1">
                  −
                 </mo>
                 <mi id="S3.E2.m1.76.76.76.17.17.17.1.3">
                  k
                 </mi>
                </mrow>
               </msub>
               <mo id="S3.E2.m1.77.77.77.18.18.18" stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
            </mtd>
            <mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.81.81.2i">
             <mrow id="S3.E2.m1.79.79.79.20.2">
              <mi id="S3.E2.m1.79.79.79.20.2.3">
              </mi>
              <mo id="S3.E2.m1.78.78.78.19.1.1">
               =
              </mo>
              <mfrac id="S3.E2.m1.79.79.79.20.2.2">
               <mrow id="S3.E2.m1.79.79.79.20.2.2.1">
                <mtext id="S3.E2.m1.79.79.79.20.2.2.1.2">
                 exp
                </mtext>
                <mrow id="S3.E2.m1.79.79.79.20.2.2.1.3">
                 <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.1" stretchy="false">
                  (
                 </mo>
                 <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.2">
                  𝐠
                 </mi>
                 <mrow id="S3.E2.m1.79.79.79.20.2.2.1.3.3">
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.3.1" stretchy="false">
                   (
                  </mo>
                  <mi id="S3.E2.m1.79.79.79.20.2.2.1.1">
                   a
                  </mi>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.3.2">
                   ,
                  </mo>
                  <msub id="S3.E2.m1.79.79.79.20.2.2.1.3.3.3">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.3.3.2">
                    c
                   </mi>
                   <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.3.3.3">
                    i
                   </mi>
                  </msub>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.3.4" rspace="0.055em" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.4" rspace="0.222em">
                  ⋅
                 </mo>
                 <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.5">
                  𝐠
                 </mi>
                 <mrow id="S3.E2.m1.79.79.79.20.2.2.1.3.6">
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.6.1" stretchy="false">
                   (
                  </mo>
                  <msub id="S3.E2.m1.79.79.79.20.2.2.1.3.6.2">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.6.2.2">
                    s
                   </mi>
                   <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.6.2.3">
                    i
                   </mi>
                  </msub>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.6.3">
                   ,
                  </mo>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.6.4" lspace="0em" rspace="0.0835em">
                   .
                  </mo>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.6.5" lspace="0.0835em" rspace="0.167em">
                   .
                  </mo>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.6.6">
                   ,
                  </mo>
                  <msub id="S3.E2.m1.79.79.79.20.2.2.1.3.6.7">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.6.7.2">
                    s
                   </mi>
                   <mrow id="S3.E2.m1.79.79.79.20.2.2.1.3.6.7.3">
                    <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.6.7.3.2">
                     i
                    </mi>
                    <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.6.7.3.1">
                     −
                    </mo>
                    <mi id="S3.E2.m1.79.79.79.20.2.2.1.3.6.7.3.3">
                     k
                    </mi>
                   </mrow>
                  </msub>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.6.8" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S3.E2.m1.79.79.79.20.2.2.1.3.7" stretchy="false">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mrow id="S3.E2.m1.79.79.79.20.2.2.3">
                <msub id="S3.E2.m1.79.79.79.20.2.2.3.1">
                 <mo id="S3.E2.m1.79.79.79.20.2.2.3.1.2">
                  ∑
                 </mo>
                 <mrow id="S3.E2.m1.79.79.79.20.2.2.3.1.3">
                  <msup id="S3.E2.m1.79.79.79.20.2.2.3.1.3.2">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.3.1.3.2.2">
                    a
                   </mi>
                   <mo id="S3.E2.m1.79.79.79.20.2.2.3.1.3.2.3">
                    ′
                   </mo>
                  </msup>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.1.3.1">
                   ∈
                  </mo>
                  <msub id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.2">
                    A
                   </mi>
                   <mrow id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.3">
                    <mi id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.3.2">
                     c
                    </mi>
                    <mo id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.3.1" lspace="0em" rspace="0em">
                     ​
                    </mo>
                    <mi id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.3.3">
                     a
                    </mi>
                    <mo id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.3.1a" lspace="0em" rspace="0em">
                     ​
                    </mo>
                    <mi id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.3.4">
                     n
                    </mi>
                    <mo id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.3.1b" lspace="0em" rspace="0em">
                     ​
                    </mo>
                    <mi id="S3.E2.m1.79.79.79.20.2.2.3.1.3.3.3.5">
                     d
                    </mi>
                   </mrow>
                  </msub>
                 </mrow>
                </msub>
                <mtext id="S3.E2.m1.79.79.79.20.2.2.3.2">
                 exp
                </mtext>
                <mrow id="S3.E2.m1.79.79.79.20.2.2.3.3">
                 <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.1" stretchy="false">
                  (
                 </mo>
                 <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.2">
                  𝐠
                 </mi>
                 <mrow id="S3.E2.m1.79.79.79.20.2.2.3.3.3">
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.3.1" stretchy="false">
                   (
                  </mo>
                  <msup id="S3.E2.m1.79.79.79.20.2.2.3.3.3.2">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.3.2.2">
                    a
                   </mi>
                   <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.3.2.3">
                    ′
                   </mo>
                  </msup>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.3.3">
                   ,
                  </mo>
                  <msub id="S3.E2.m1.79.79.79.20.2.2.3.3.3.4">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.3.4.2">
                    c
                   </mi>
                   <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.3.4.3">
                    i
                   </mi>
                  </msub>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.3.5" rspace="0.055em" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.4" rspace="0.222em">
                  ⋅
                 </mo>
                 <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.5">
                  𝐠
                 </mi>
                 <mrow id="S3.E2.m1.79.79.79.20.2.2.3.3.6">
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.6.1" stretchy="false">
                   (
                  </mo>
                  <msub id="S3.E2.m1.79.79.79.20.2.2.3.3.6.2">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.6.2.2">
                    s
                   </mi>
                   <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.6.2.3">
                    i
                   </mi>
                  </msub>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.6.3">
                   ,
                  </mo>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.6.4" lspace="0em" rspace="0.0835em">
                   .
                  </mo>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.6.5" lspace="0.0835em" rspace="0.167em">
                   .
                  </mo>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.6.6">
                   ,
                  </mo>
                  <msub id="S3.E2.m1.79.79.79.20.2.2.3.3.6.7">
                   <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.6.7.2">
                    s
                   </mi>
                   <mrow id="S3.E2.m1.79.79.79.20.2.2.3.3.6.7.3">
                    <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.6.7.3.2">
                     i
                    </mi>
                    <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.6.7.3.1">
                     −
                    </mo>
                    <mi id="S3.E2.m1.79.79.79.20.2.2.3.3.6.7.3.3">
                     k
                    </mi>
                   </mrow>
                  </msub>
                  <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.6.8" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S3.E2.m1.79.79.79.20.2.2.3.3.7" stretchy="false">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mfrac>
             </mrow>
            </mtd>
           </mtr>
          </mtable>
          <annotation encoding="application/x-tex" id="S3.E2.m1.81b">
           \begin{split}\mathbf{g}(a,c_{i})&amp;=\mathbf{W}_{1}\cdot\textrm{FFN}(a,c_{i})+\mathbf{b}_{1}\\
\mathbf{g}(s_{i},..,s_{i-k})&amp;=\mathbf{W}_{2}\cdot\textrm{Attention}(\textrm{PE}(s_{i-k}||..||s_{i-1}||s_{i}))+\mathbf{b}_{2}\\
\pi^{t}_{\rho}(a|c_{i},s_{i},..,s_{i-k})&amp;=\frac{\textrm{exp}(\mathbf{g}(a,c_{i})\cdot\mathbf{g}(s_{i},..,s_{i-k}))}{\sum_{a^{\prime}\in A_{cand}}{\textrm{exp}(\mathbf{g}(a^{\prime},c_{i})\cdot\mathbf{g}(s_{i},..,s_{i-k}))}}\end{split}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para" id="S3.SS2.p9">
    <p class="ltx_p" id="S3.SS2.p9.1">
     In the above formula, “||” is the string concatenation operator. Section
     <a class="ltx_ref" href="#S3.SS3" title="3.3 ToT System Training ‣ 3 Architecture ‣ Large Language Model Guided Tree-of-Thought">
      <span class="ltx_text ltx_ref_tag">
       3.3
      </span>
     </a>
     will discuss the training algorithm for the ToT controller policy network.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p10">
    <p class="ltx_p" id="S3.SS2.p10.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p10.1.1">
      Prompter Agent
     </span>
     . The prompter agent gives hints to the LLM for it to generate the next search step. The most basic hint can be a generic prompt using the following template:
     <math alttext="generic\_tmpl=" class="ltx_Math" display="inline" id="S3.SS2.p10.1.m1.1">
      <semantics id="S3.SS2.p10.1.m1.1a">
       <mrow id="S3.SS2.p10.1.m1.1.1" xref="S3.SS2.p10.1.m1.1.1.cmml">
        <mrow id="S3.SS2.p10.1.m1.1.1.2" xref="S3.SS2.p10.1.m1.1.1.2.cmml">
         <mi id="S3.SS2.p10.1.m1.1.1.2.2" xref="S3.SS2.p10.1.m1.1.1.2.2.cmml">
          g
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.3" xref="S3.SS2.p10.1.m1.1.1.2.3.cmml">
          e
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1a" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.4" xref="S3.SS2.p10.1.m1.1.1.2.4.cmml">
          n
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1b" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.5" xref="S3.SS2.p10.1.m1.1.1.2.5.cmml">
          e
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1c" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.6" xref="S3.SS2.p10.1.m1.1.1.2.6.cmml">
          r
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1d" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.7" xref="S3.SS2.p10.1.m1.1.1.2.7.cmml">
          i
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1e" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.8" xref="S3.SS2.p10.1.m1.1.1.2.8.cmml">
          c
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1f" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.9" mathvariant="normal" xref="S3.SS2.p10.1.m1.1.1.2.9.cmml">
          _
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1g" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.10" xref="S3.SS2.p10.1.m1.1.1.2.10.cmml">
          t
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1h" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.11" xref="S3.SS2.p10.1.m1.1.1.2.11.cmml">
          m
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1i" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.12" xref="S3.SS2.p10.1.m1.1.1.2.12.cmml">
          p
         </mi>
         <mo id="S3.SS2.p10.1.m1.1.1.2.1j" lspace="0em" rspace="0em" xref="S3.SS2.p10.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p10.1.m1.1.1.2.13" xref="S3.SS2.p10.1.m1.1.1.2.13.cmml">
          l
         </mi>
        </mrow>
        <mo id="S3.SS2.p10.1.m1.1.1.1" xref="S3.SS2.p10.1.m1.1.1.1.cmml">
         =
        </mo>
        <mi id="S3.SS2.p10.1.m1.1.1.3" xref="S3.SS2.p10.1.m1.1.1.3.cmml">
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p10.1.m1.1b">
        <apply id="S3.SS2.p10.1.m1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1">
         <eq id="S3.SS2.p10.1.m1.1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1.1">
         </eq>
         <apply id="S3.SS2.p10.1.m1.1.1.2.cmml" xref="S3.SS2.p10.1.m1.1.1.2">
          <times id="S3.SS2.p10.1.m1.1.1.2.1.cmml" xref="S3.SS2.p10.1.m1.1.1.2.1">
          </times>
          <ci id="S3.SS2.p10.1.m1.1.1.2.2.cmml" xref="S3.SS2.p10.1.m1.1.1.2.2">
           𝑔
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.3.cmml" xref="S3.SS2.p10.1.m1.1.1.2.3">
           𝑒
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.4.cmml" xref="S3.SS2.p10.1.m1.1.1.2.4">
           𝑛
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.5.cmml" xref="S3.SS2.p10.1.m1.1.1.2.5">
           𝑒
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.6.cmml" xref="S3.SS2.p10.1.m1.1.1.2.6">
           𝑟
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.7.cmml" xref="S3.SS2.p10.1.m1.1.1.2.7">
           𝑖
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.8.cmml" xref="S3.SS2.p10.1.m1.1.1.2.8">
           𝑐
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.9.cmml" xref="S3.SS2.p10.1.m1.1.1.2.9">
           _
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.10.cmml" xref="S3.SS2.p10.1.m1.1.1.2.10">
           𝑡
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.11.cmml" xref="S3.SS2.p10.1.m1.1.1.2.11">
           𝑚
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.12.cmml" xref="S3.SS2.p10.1.m1.1.1.2.12">
           𝑝
          </ci>
          <ci id="S3.SS2.p10.1.m1.1.1.2.13.cmml" xref="S3.SS2.p10.1.m1.1.1.2.13">
           𝑙
          </ci>
         </apply>
         <csymbol cd="latexml" id="S3.SS2.p10.1.m1.1.1.3.cmml" xref="S3.SS2.p10.1.m1.1.1.3">
          absent
         </csymbol>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p10.1.m1.1c">
        generic\_tmpl=
       </annotation>
      </semantics>
     </math>
     “
     <span class="ltx_text ltx_font_italic" id="S3.SS2.p10.1.2">
      For the given problem: [problem description], we have come up with a partial solution: [partial solution summary]. Please derive the next step on top of this partial solution, and return the next step in the following JSON format
     </span>
     {
     <span class="ltx_text ltx_font_italic" id="S3.SS2.p10.1.3">
      next_step: &lt;next_step&gt;
     </span>
     }”. Note that the template requires the LLM to respond with a structured JSON string. This is a trick to make it easier for the checker to extract the next step from the LLM response. To create an actual prompt from this template, the prompter needs the
     <span class="ltx_text ltx_font_italic" id="S3.SS2.p10.1.4">
      [problem description]
     </span>
     and the
     <span class="ltx_text ltx_font_italic" id="S3.SS2.p10.1.5">
      [partial solution summary]
     </span>
     , both of which can be queried from the memory module.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p11">
    <p class="ltx_p" id="S3.SS2.p11.8">
     Similar to the ToT controller, we can also implement the prompter agent as a policy network, which can generate prompts based on the current partial solution and the conversation history. First we define the prompt template as follows:
     <math alttext="prompt\_tmpl=generic\_tmpl\;||\;" class="ltx_math_unparsed" display="inline" id="S3.SS2.p11.1.m1.1">
      <semantics id="S3.SS2.p11.1.m1.1a">
       <mrow id="S3.SS2.p11.1.m1.1b">
        <mi id="S3.SS2.p11.1.m1.1.1">
         p
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.2">
         r
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.3">
         o
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.4">
         m
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.5">
         p
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.6">
         t
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.7" mathvariant="normal">
         _
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.8">
         t
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.9">
         m
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.10">
         p
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.11">
         l
        </mi>
        <mo id="S3.SS2.p11.1.m1.1.12">
         =
        </mo>
        <mi id="S3.SS2.p11.1.m1.1.13">
         g
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.14">
         e
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.15">
         n
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.16">
         e
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.17">
         r
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.18">
         i
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.19">
         c
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.20" mathvariant="normal">
         _
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.21">
         t
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.22">
         m
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.23">
         p
        </mi>
        <mi id="S3.SS2.p11.1.m1.1.24">
         l
        </mi>
        <mo fence="false" id="S3.SS2.p11.1.m1.1.25" lspace="0.280em" rspace="0.167em" stretchy="false">
         |
        </mo>
        <mo fence="false" id="S3.SS2.p11.1.m1.1.26" stretchy="false">
         |
        </mo>
       </mrow>
       <annotation encoding="application/x-tex" id="S3.SS2.p11.1.m1.1c">
        prompt\_tmpl=generic\_tmpl\;||\;
       </annotation>
      </semantics>
     </math>
     “
     <span class="ltx_text ltx_font_italic" id="S3.SS2.p11.8.1">
      Here are a few examples: [in-context learning examples]
     </span>
     .”, where
     <math alttext="||" class="ltx_math_unparsed" display="inline" id="S3.SS2.p11.2.m2.1">
      <semantics id="S3.SS2.p11.2.m2.1a">
       <mrow id="S3.SS2.p11.2.m2.1b">
        <mo fence="false" id="S3.SS2.p11.2.m2.1.1" rspace="0.167em" stretchy="false">
         |
        </mo>
        <mo fence="false" id="S3.SS2.p11.2.m2.1.2" stretchy="false">
         |
        </mo>
       </mrow>
       <annotation encoding="application/x-tex" id="S3.SS2.p11.2.m2.1c">
        ||
       </annotation>
      </semantics>
     </math>
     is the string concatenation operator. The variable
     <span class="ltx_text ltx_font_italic" id="S3.SS2.p11.8.2">
      [in context learning examples]
     </span>
     are in-context learning examples for the problem being solved, which can be picked by the prompter policy network from a set of candidates, similar to the PromptPG approach
     <cite class="ltx_cite ltx_citemacro_cite">
      <a class="ltx_ref" href="#bib.bib24" title="">
       <span class="ltx_text" style="font-size:80%;">
        lu2023dynamic
       </span>
      </a>
     </cite>
     . The rationale is that given the current and recently attempted intermediate solution, some in-context examples might work better than others as hints for the next step. Given the recently visited node sequence
     <math alttext="s_{i-k}" class="ltx_Math" display="inline" id="S3.SS2.p11.3.m3.1">
      <semantics id="S3.SS2.p11.3.m3.1a">
       <msub id="S3.SS2.p11.3.m3.1.1" xref="S3.SS2.p11.3.m3.1.1.cmml">
        <mi id="S3.SS2.p11.3.m3.1.1.2" xref="S3.SS2.p11.3.m3.1.1.2.cmml">
         s
        </mi>
        <mrow id="S3.SS2.p11.3.m3.1.1.3" xref="S3.SS2.p11.3.m3.1.1.3.cmml">
         <mi id="S3.SS2.p11.3.m3.1.1.3.2" xref="S3.SS2.p11.3.m3.1.1.3.2.cmml">
          i
         </mi>
         <mo id="S3.SS2.p11.3.m3.1.1.3.1" xref="S3.SS2.p11.3.m3.1.1.3.1.cmml">
          −
         </mo>
         <mi id="S3.SS2.p11.3.m3.1.1.3.3" xref="S3.SS2.p11.3.m3.1.1.3.3.cmml">
          k
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p11.3.m3.1b">
        <apply id="S3.SS2.p11.3.m3.1.1.cmml" xref="S3.SS2.p11.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p11.3.m3.1.1.1.cmml" xref="S3.SS2.p11.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p11.3.m3.1.1.2.cmml" xref="S3.SS2.p11.3.m3.1.1.2">
          𝑠
         </ci>
         <apply id="S3.SS2.p11.3.m3.1.1.3.cmml" xref="S3.SS2.p11.3.m3.1.1.3">
          <minus id="S3.SS2.p11.3.m3.1.1.3.1.cmml" xref="S3.SS2.p11.3.m3.1.1.3.1">
          </minus>
          <ci id="S3.SS2.p11.3.m3.1.1.3.2.cmml" xref="S3.SS2.p11.3.m3.1.1.3.2">
           𝑖
          </ci>
          <ci id="S3.SS2.p11.3.m3.1.1.3.3.cmml" xref="S3.SS2.p11.3.m3.1.1.3.3">
           𝑘
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p11.3.m3.1c">
        s_{i-k}
       </annotation>
      </semantics>
     </math>
     , ..,
     <math alttext="s_{i-1}" class="ltx_Math" display="inline" id="S3.SS2.p11.4.m4.1">
      <semantics id="S3.SS2.p11.4.m4.1a">
       <msub id="S3.SS2.p11.4.m4.1.1" xref="S3.SS2.p11.4.m4.1.1.cmml">
        <mi id="S3.SS2.p11.4.m4.1.1.2" xref="S3.SS2.p11.4.m4.1.1.2.cmml">
         s
        </mi>
        <mrow id="S3.SS2.p11.4.m4.1.1.3" xref="S3.SS2.p11.4.m4.1.1.3.cmml">
         <mi id="S3.SS2.p11.4.m4.1.1.3.2" xref="S3.SS2.p11.4.m4.1.1.3.2.cmml">
          i
         </mi>
         <mo id="S3.SS2.p11.4.m4.1.1.3.1" xref="S3.SS2.p11.4.m4.1.1.3.1.cmml">
          −
         </mo>
         <mn id="S3.SS2.p11.4.m4.1.1.3.3" xref="S3.SS2.p11.4.m4.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p11.4.m4.1b">
        <apply id="S3.SS2.p11.4.m4.1.1.cmml" xref="S3.SS2.p11.4.m4.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p11.4.m4.1.1.1.cmml" xref="S3.SS2.p11.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p11.4.m4.1.1.2.cmml" xref="S3.SS2.p11.4.m4.1.1.2">
          𝑠
         </ci>
         <apply id="S3.SS2.p11.4.m4.1.1.3.cmml" xref="S3.SS2.p11.4.m4.1.1.3">
          <minus id="S3.SS2.p11.4.m4.1.1.3.1.cmml" xref="S3.SS2.p11.4.m4.1.1.3.1">
          </minus>
          <ci id="S3.SS2.p11.4.m4.1.1.3.2.cmml" xref="S3.SS2.p11.4.m4.1.1.3.2">
           𝑖
          </ci>
          <cn id="S3.SS2.p11.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS2.p11.4.m4.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p11.4.m4.1c">
        s_{i-1}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="s_{i}" class="ltx_Math" display="inline" id="S3.SS2.p11.5.m5.1">
      <semantics id="S3.SS2.p11.5.m5.1a">
       <msub id="S3.SS2.p11.5.m5.1.1" xref="S3.SS2.p11.5.m5.1.1.cmml">
        <mi id="S3.SS2.p11.5.m5.1.1.2" xref="S3.SS2.p11.5.m5.1.1.2.cmml">
         s
        </mi>
        <mi id="S3.SS2.p11.5.m5.1.1.3" xref="S3.SS2.p11.5.m5.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p11.5.m5.1b">
        <apply id="S3.SS2.p11.5.m5.1.1.cmml" xref="S3.SS2.p11.5.m5.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p11.5.m5.1.1.1.cmml" xref="S3.SS2.p11.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p11.5.m5.1.1.2.cmml" xref="S3.SS2.p11.5.m5.1.1.2">
          𝑠
         </ci>
         <ci id="S3.SS2.p11.5.m5.1.1.3.cmml" xref="S3.SS2.p11.5.m5.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p11.5.m5.1c">
        s_{i}
       </annotation>
      </semantics>
     </math>
     , our goal is to select
     <math alttext="l" class="ltx_Math" display="inline" id="S3.SS2.p11.6.m6.1">
      <semantics id="S3.SS2.p11.6.m6.1a">
       <mi id="S3.SS2.p11.6.m6.1.1" xref="S3.SS2.p11.6.m6.1.1.cmml">
        l
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p11.6.m6.1b">
        <ci id="S3.SS2.p11.6.m6.1.1.cmml" xref="S3.SS2.p11.6.m6.1.1">
         𝑙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p11.6.m6.1c">
        l
       </annotation>
      </semantics>
     </math>
     examples
     <math alttext="e_{i}=\{e_{i}^{1},e_{i}^{2},...,e_{i}^{l}|e_{i}^{j}\in E_{cand}\}" class="ltx_Math" display="inline" id="S3.SS2.p11.7.m7.3">
      <semantics id="S3.SS2.p11.7.m7.3a">
       <mrow id="S3.SS2.p11.7.m7.3.3" xref="S3.SS2.p11.7.m7.3.3.cmml">
        <msub id="S3.SS2.p11.7.m7.3.3.4" xref="S3.SS2.p11.7.m7.3.3.4.cmml">
         <mi id="S3.SS2.p11.7.m7.3.3.4.2" xref="S3.SS2.p11.7.m7.3.3.4.2.cmml">
          e
         </mi>
         <mi id="S3.SS2.p11.7.m7.3.3.4.3" xref="S3.SS2.p11.7.m7.3.3.4.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS2.p11.7.m7.3.3.3" xref="S3.SS2.p11.7.m7.3.3.3.cmml">
         =
        </mo>
        <mrow id="S3.SS2.p11.7.m7.3.3.2.2" xref="S3.SS2.p11.7.m7.3.3.2.3.cmml">
         <mo id="S3.SS2.p11.7.m7.3.3.2.2.3" stretchy="false" xref="S3.SS2.p11.7.m7.3.3.2.3.1.cmml">
          {
         </mo>
         <mrow id="S3.SS2.p11.7.m7.2.2.1.1.1.3" xref="S3.SS2.p11.7.m7.2.2.1.1.1.4.cmml">
          <msubsup id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.cmml">
           <mi id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.2" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.2.cmml">
            e
           </mi>
           <mi id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.3" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.3.cmml">
            i
           </mi>
           <mn id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.3" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.3.cmml">
            1
           </mn>
          </msubsup>
          <mo id="S3.SS2.p11.7.m7.2.2.1.1.1.3.4" xref="S3.SS2.p11.7.m7.2.2.1.1.1.4.cmml">
           ,
          </mo>
          <msubsup id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.cmml">
           <mi id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.2" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.2.cmml">
            e
           </mi>
           <mi id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.3" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.3.cmml">
            i
           </mi>
           <mn id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.3" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.3.cmml">
            2
           </mn>
          </msubsup>
          <mo id="S3.SS2.p11.7.m7.2.2.1.1.1.3.5" xref="S3.SS2.p11.7.m7.2.2.1.1.1.4.cmml">
           ,
          </mo>
          <mi id="S3.SS2.p11.7.m7.1.1" mathvariant="normal" xref="S3.SS2.p11.7.m7.1.1.cmml">
           …
          </mi>
          <mo id="S3.SS2.p11.7.m7.2.2.1.1.1.3.6" xref="S3.SS2.p11.7.m7.2.2.1.1.1.4.cmml">
           ,
          </mo>
          <msubsup id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.cmml">
           <mi id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.2" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.2.cmml">
            e
           </mi>
           <mi id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.3" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.3.cmml">
            i
           </mi>
           <mi id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.3" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.3.cmml">
            l
           </mi>
          </msubsup>
         </mrow>
         <mo id="S3.SS2.p11.7.m7.3.3.2.2.4" lspace="0em" rspace="0em" xref="S3.SS2.p11.7.m7.3.3.2.3.1.cmml">
          |
         </mo>
         <mrow id="S3.SS2.p11.7.m7.3.3.2.2.2" xref="S3.SS2.p11.7.m7.3.3.2.2.2.cmml">
          <msubsup id="S3.SS2.p11.7.m7.3.3.2.2.2.2" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2.cmml">
           <mi id="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.2" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.2.cmml">
            e
           </mi>
           <mi id="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.3" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.3.cmml">
            i
           </mi>
           <mi id="S3.SS2.p11.7.m7.3.3.2.2.2.2.3" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2.3.cmml">
            j
           </mi>
          </msubsup>
          <mo id="S3.SS2.p11.7.m7.3.3.2.2.2.1" xref="S3.SS2.p11.7.m7.3.3.2.2.2.1.cmml">
           ∈
          </mo>
          <msub id="S3.SS2.p11.7.m7.3.3.2.2.2.3" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.cmml">
           <mi id="S3.SS2.p11.7.m7.3.3.2.2.2.3.2" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.2.cmml">
            E
           </mi>
           <mrow id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.cmml">
            <mi id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.2" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.2.cmml">
             c
            </mi>
            <mo id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.1.cmml">
             ​
            </mo>
            <mi id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.3" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.3.cmml">
             a
            </mi>
            <mo id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.1a" lspace="0em" rspace="0em" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.1.cmml">
             ​
            </mo>
            <mi id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.4" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.4.cmml">
             n
            </mi>
            <mo id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.1b" lspace="0em" rspace="0em" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.1.cmml">
             ​
            </mo>
            <mi id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.5" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.5.cmml">
             d
            </mi>
           </mrow>
          </msub>
         </mrow>
         <mo id="S3.SS2.p11.7.m7.3.3.2.2.5" stretchy="false" xref="S3.SS2.p11.7.m7.3.3.2.3.1.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p11.7.m7.3b">
        <apply id="S3.SS2.p11.7.m7.3.3.cmml" xref="S3.SS2.p11.7.m7.3.3">
         <eq id="S3.SS2.p11.7.m7.3.3.3.cmml" xref="S3.SS2.p11.7.m7.3.3.3">
         </eq>
         <apply id="S3.SS2.p11.7.m7.3.3.4.cmml" xref="S3.SS2.p11.7.m7.3.3.4">
          <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.3.3.4.1.cmml" xref="S3.SS2.p11.7.m7.3.3.4">
           subscript
          </csymbol>
          <ci id="S3.SS2.p11.7.m7.3.3.4.2.cmml" xref="S3.SS2.p11.7.m7.3.3.4.2">
           𝑒
          </ci>
          <ci id="S3.SS2.p11.7.m7.3.3.4.3.cmml" xref="S3.SS2.p11.7.m7.3.3.4.3">
           𝑖
          </ci>
         </apply>
         <apply id="S3.SS2.p11.7.m7.3.3.2.3.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2">
          <csymbol cd="latexml" id="S3.SS2.p11.7.m7.3.3.2.3.1.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.3">
           conditional-set
          </csymbol>
          <list id="S3.SS2.p11.7.m7.2.2.1.1.1.4.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3">
           <apply id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1">
             superscript
            </csymbol>
            <apply id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.2">
              𝑒
             </ci>
             <ci id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.2.3">
              𝑖
             </ci>
            </apply>
            <cn id="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p11.7.m7.2.2.1.1.1.1.1.3">
             1
            </cn>
           </apply>
           <apply id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2">
            <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.1.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2">
             superscript
            </csymbol>
            <apply id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2">
             <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2">
              subscript
             </csymbol>
             <ci id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.2">
              𝑒
             </ci>
             <ci id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.3.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.2.3">
              𝑖
             </ci>
            </apply>
            <cn id="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.3.cmml" type="integer" xref="S3.SS2.p11.7.m7.2.2.1.1.1.2.2.3">
             2
            </cn>
           </apply>
           <ci id="S3.SS2.p11.7.m7.1.1.cmml" xref="S3.SS2.p11.7.m7.1.1">
            …
           </ci>
           <apply id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3">
            <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.1.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3">
             superscript
            </csymbol>
            <apply id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3">
             <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.1.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3">
              subscript
             </csymbol>
             <ci id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.2.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.2">
              𝑒
             </ci>
             <ci id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.3.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.2.3">
              𝑖
             </ci>
            </apply>
            <ci id="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.3.cmml" xref="S3.SS2.p11.7.m7.2.2.1.1.1.3.3.3">
             𝑙
            </ci>
           </apply>
          </list>
          <apply id="S3.SS2.p11.7.m7.3.3.2.2.2.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2">
           <in id="S3.SS2.p11.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.1">
           </in>
           <apply id="S3.SS2.p11.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2">
            <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2">
             superscript
            </csymbol>
            <apply id="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2">
             <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.1.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2">
              subscript
             </csymbol>
             <ci id="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.2.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.2">
              𝑒
             </ci>
             <ci id="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.3.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2.2.3">
              𝑖
             </ci>
            </apply>
            <ci id="S3.SS2.p11.7.m7.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.2.3">
             𝑗
            </ci>
           </apply>
           <apply id="S3.SS2.p11.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3">
            <csymbol cd="ambiguous" id="S3.SS2.p11.7.m7.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3">
             subscript
            </csymbol>
            <ci id="S3.SS2.p11.7.m7.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.2">
             𝐸
            </ci>
            <apply id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3">
             <times id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.1.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.1">
             </times>
             <ci id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.2.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.2">
              𝑐
             </ci>
             <ci id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.3.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.3">
              𝑎
             </ci>
             <ci id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.4.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.4">
              𝑛
             </ci>
             <ci id="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.5.cmml" xref="S3.SS2.p11.7.m7.3.3.2.2.2.3.3.5">
              𝑑
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p11.7.m7.3c">
        e_{i}=\{e_{i}^{1},e_{i}^{2},...,e_{i}^{l}|e_{i}^{j}\in E_{cand}\}
       </annotation>
      </semantics>
     </math>
     where
     <math alttext="E_{cand}" class="ltx_Math" display="inline" id="S3.SS2.p11.8.m8.1">
      <semantics id="S3.SS2.p11.8.m8.1a">
       <msub id="S3.SS2.p11.8.m8.1.1" xref="S3.SS2.p11.8.m8.1.1.cmml">
        <mi id="S3.SS2.p11.8.m8.1.1.2" xref="S3.SS2.p11.8.m8.1.1.2.cmml">
         E
        </mi>
        <mrow id="S3.SS2.p11.8.m8.1.1.3" xref="S3.SS2.p11.8.m8.1.1.3.cmml">
         <mi id="S3.SS2.p11.8.m8.1.1.3.2" xref="S3.SS2.p11.8.m8.1.1.3.2.cmml">
          c
         </mi>
         <mo id="S3.SS2.p11.8.m8.1.1.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p11.8.m8.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p11.8.m8.1.1.3.3" xref="S3.SS2.p11.8.m8.1.1.3.3.cmml">
          a
         </mi>
         <mo id="S3.SS2.p11.8.m8.1.1.3.1a" lspace="0em" rspace="0em" xref="S3.SS2.p11.8.m8.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p11.8.m8.1.1.3.4" xref="S3.SS2.p11.8.m8.1.1.3.4.cmml">
          n
         </mi>
         <mo id="S3.SS2.p11.8.m8.1.1.3.1b" lspace="0em" rspace="0em" xref="S3.SS2.p11.8.m8.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p11.8.m8.1.1.3.5" xref="S3.SS2.p11.8.m8.1.1.3.5.cmml">
          d
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p11.8.m8.1b">
        <apply id="S3.SS2.p11.8.m8.1.1.cmml" xref="S3.SS2.p11.8.m8.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p11.8.m8.1.1.1.cmml" xref="S3.SS2.p11.8.m8.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p11.8.m8.1.1.2.cmml" xref="S3.SS2.p11.8.m8.1.1.2">
          𝐸
         </ci>
         <apply id="S3.SS2.p11.8.m8.1.1.3.cmml" xref="S3.SS2.p11.8.m8.1.1.3">
          <times id="S3.SS2.p11.8.m8.1.1.3.1.cmml" xref="S3.SS2.p11.8.m8.1.1.3.1">
          </times>
          <ci id="S3.SS2.p11.8.m8.1.1.3.2.cmml" xref="S3.SS2.p11.8.m8.1.1.3.2">
           𝑐
          </ci>
          <ci id="S3.SS2.p11.8.m8.1.1.3.3.cmml" xref="S3.SS2.p11.8.m8.1.1.3.3">
           𝑎
          </ci>
          <ci id="S3.SS2.p11.8.m8.1.1.3.4.cmml" xref="S3.SS2.p11.8.m8.1.1.3.4">
           𝑛
          </ci>
          <ci id="S3.SS2.p11.8.m8.1.1.3.5.cmml" xref="S3.SS2.p11.8.m8.1.1.3.5">
           𝑑
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p11.8.m8.1c">
        E_{cand}
       </annotation>
      </semantics>
     </math>
     is a pool of in-context learning example candidates. The examples are selected according on a policy:
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p12">
    <table class="ltx_equation ltx_eqn_table" id="S3.E3">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="e_{i}^{j}\sim\pi^{p}_{\theta}(e|s_{i},..,s_{i-k}),\;e_{i}^{j}\in E_{cand}\;\textrm{for}\;j=1,2,...,l" class="ltx_math_unparsed" display="block" id="S3.E3.m1.1">
         <semantics id="S3.E3.m1.1a">
          <mrow id="S3.E3.m1.1b">
           <msubsup id="S3.E3.m1.1.1">
            <mi id="S3.E3.m1.1.1.2.2">
             e
            </mi>
            <mi id="S3.E3.m1.1.1.2.3">
             i
            </mi>
            <mi id="S3.E3.m1.1.1.3">
             j
            </mi>
           </msubsup>
           <mo id="S3.E3.m1.1.2">
            ∼
           </mo>
           <msubsup id="S3.E3.m1.1.3">
            <mi id="S3.E3.m1.1.3.2.2">
             π
            </mi>
            <mi id="S3.E3.m1.1.3.3">
             θ
            </mi>
            <mi id="S3.E3.m1.1.3.2.3">
             p
            </mi>
           </msubsup>
           <mrow id="S3.E3.m1.1.4">
            <mo id="S3.E3.m1.1.4.1" stretchy="false">
             (
            </mo>
            <mi id="S3.E3.m1.1.4.2">
             e
            </mi>
            <mo fence="false" id="S3.E3.m1.1.4.3" rspace="0.167em" stretchy="false">
             |
            </mo>
            <msub id="S3.E3.m1.1.4.4">
             <mi id="S3.E3.m1.1.4.4.2">
              s
             </mi>
             <mi id="S3.E3.m1.1.4.4.3">
              i
             </mi>
            </msub>
            <mo id="S3.E3.m1.1.4.5">
             ,
            </mo>
            <mo id="S3.E3.m1.1.4.6" lspace="0em" rspace="0.0835em">
             .
            </mo>
            <mo id="S3.E3.m1.1.4.7" lspace="0.0835em" rspace="0.167em">
             .
            </mo>
            <mo id="S3.E3.m1.1.4.8">
             ,
            </mo>
            <msub id="S3.E3.m1.1.4.9">
             <mi id="S3.E3.m1.1.4.9.2">
              s
             </mi>
             <mrow id="S3.E3.m1.1.4.9.3">
              <mi id="S3.E3.m1.1.4.9.3.2">
               i
              </mi>
              <mo id="S3.E3.m1.1.4.9.3.1">
               −
              </mo>
              <mi id="S3.E3.m1.1.4.9.3.3">
               k
              </mi>
             </mrow>
            </msub>
            <mo id="S3.E3.m1.1.4.10" stretchy="false">
             )
            </mo>
           </mrow>
           <mo id="S3.E3.m1.1.5" rspace="0.447em">
            ,
           </mo>
           <msubsup id="S3.E3.m1.1.6">
            <mi id="S3.E3.m1.1.6.2.2">
             e
            </mi>
            <mi id="S3.E3.m1.1.6.2.3">
             i
            </mi>
            <mi id="S3.E3.m1.1.6.3">
             j
            </mi>
           </msubsup>
           <mo id="S3.E3.m1.1.7">
            ∈
           </mo>
           <msub id="S3.E3.m1.1.8">
            <mi id="S3.E3.m1.1.8.2">
             E
            </mi>
            <mrow id="S3.E3.m1.1.8.3">
             <mi id="S3.E3.m1.1.8.3.2">
              c
             </mi>
             <mo id="S3.E3.m1.1.8.3.1" lspace="0em" rspace="0em">
              ​
             </mo>
             <mi id="S3.E3.m1.1.8.3.3">
              a
             </mi>
             <mo id="S3.E3.m1.1.8.3.1a" lspace="0em" rspace="0em">
              ​
             </mo>
             <mi id="S3.E3.m1.1.8.3.4">
              n
             </mi>
             <mo id="S3.E3.m1.1.8.3.1b" lspace="0em" rspace="0em">
              ​
             </mo>
             <mi id="S3.E3.m1.1.8.3.5">
              d
             </mi>
            </mrow>
           </msub>
           <mtext id="S3.E3.m1.1.9">
            for
           </mtext>
           <mi id="S3.E3.m1.1.10">
            j
           </mi>
           <mo id="S3.E3.m1.1.11">
            =
           </mo>
           <mn id="S3.E3.m1.1.12">
            1
           </mn>
           <mo id="S3.E3.m1.1.13">
            ,
           </mo>
           <mn id="S3.E3.m1.1.14">
            2
           </mn>
           <mo id="S3.E3.m1.1.15">
            ,
           </mo>
           <mi id="S3.E3.m1.1.16" mathvariant="normal">
            …
           </mi>
           <mo id="S3.E3.m1.1.17">
            ,
           </mo>
           <mi id="S3.E3.m1.1.18">
            l
           </mi>
          </mrow>
          <annotation encoding="application/x-tex" id="S3.E3.m1.1c">
           e_{i}^{j}\sim\pi^{p}_{\theta}(e|s_{i},..,s_{i-k}),\;e_{i}^{j}\in E_{cand}\;\textrm{for}\;j=1,2,...,l
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (3)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p13">
    <p class="ltx_p" id="S3.SS2.p13.4">
     where
     <math alttext="\pi^{p}_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p13.1.m1.1">
      <semantics id="S3.SS2.p13.1.m1.1a">
       <msubsup id="S3.SS2.p13.1.m1.1.1" xref="S3.SS2.p13.1.m1.1.1.cmml">
        <mi id="S3.SS2.p13.1.m1.1.1.2.2" xref="S3.SS2.p13.1.m1.1.1.2.2.cmml">
         π
        </mi>
        <mi id="S3.SS2.p13.1.m1.1.1.3" xref="S3.SS2.p13.1.m1.1.1.3.cmml">
         θ
        </mi>
        <mi id="S3.SS2.p13.1.m1.1.1.2.3" xref="S3.SS2.p13.1.m1.1.1.2.3.cmml">
         p
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p13.1.m1.1b">
        <apply id="S3.SS2.p13.1.m1.1.1.cmml" xref="S3.SS2.p13.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p13.1.m1.1.1.1.cmml" xref="S3.SS2.p13.1.m1.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS2.p13.1.m1.1.1.2.cmml" xref="S3.SS2.p13.1.m1.1.1">
          <csymbol cd="ambiguous" id="S3.SS2.p13.1.m1.1.1.2.1.cmml" xref="S3.SS2.p13.1.m1.1.1">
           superscript
          </csymbol>
          <ci id="S3.SS2.p13.1.m1.1.1.2.2.cmml" xref="S3.SS2.p13.1.m1.1.1.2.2">
           𝜋
          </ci>
          <ci id="S3.SS2.p13.1.m1.1.1.2.3.cmml" xref="S3.SS2.p13.1.m1.1.1.2.3">
           𝑝
          </ci>
         </apply>
         <ci id="S3.SS2.p13.1.m1.1.1.3.cmml" xref="S3.SS2.p13.1.m1.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p13.1.m1.1c">
        \pi^{p}_{\theta}
       </annotation>
      </semantics>
     </math>
     represents the policy network of the prompter agent with parameters
     <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p13.2.m2.1">
      <semantics id="S3.SS2.p13.2.m2.1a">
       <mi id="S3.SS2.p13.2.m2.1.1" xref="S3.SS2.p13.2.m2.1.1.cmml">
        θ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p13.2.m2.1b">
        <ci id="S3.SS2.p13.2.m2.1.1.cmml" xref="S3.SS2.p13.2.m2.1.1">
         𝜃
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p13.2.m2.1c">
        \theta
       </annotation>
      </semantics>
     </math>
     . With the set of selected examples, the prompter agent generates a prompt from the template:
     <math alttext="p_{i}=prompter(prompt\_tmpl,e_{i},s_{i})" class="ltx_Math" display="inline" id="S3.SS2.p13.3.m3.3">
      <semantics id="S3.SS2.p13.3.m3.3a">
       <mrow id="S3.SS2.p13.3.m3.3.3" xref="S3.SS2.p13.3.m3.3.3.cmml">
        <msub id="S3.SS2.p13.3.m3.3.3.5" xref="S3.SS2.p13.3.m3.3.3.5.cmml">
         <mi id="S3.SS2.p13.3.m3.3.3.5.2" xref="S3.SS2.p13.3.m3.3.3.5.2.cmml">
          p
         </mi>
         <mi id="S3.SS2.p13.3.m3.3.3.5.3" xref="S3.SS2.p13.3.m3.3.3.5.3.cmml">
          i
         </mi>
        </msub>
        <mo id="S3.SS2.p13.3.m3.3.3.4" xref="S3.SS2.p13.3.m3.3.3.4.cmml">
         =
        </mo>
        <mrow id="S3.SS2.p13.3.m3.3.3.3" xref="S3.SS2.p13.3.m3.3.3.3.cmml">
         <mi id="S3.SS2.p13.3.m3.3.3.3.5" xref="S3.SS2.p13.3.m3.3.3.3.5.cmml">
          p
         </mi>
         <mo id="S3.SS2.p13.3.m3.3.3.3.4" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.3.3.3.4.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.3.m3.3.3.3.6" xref="S3.SS2.p13.3.m3.3.3.3.6.cmml">
          r
         </mi>
         <mo id="S3.SS2.p13.3.m3.3.3.3.4a" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.3.3.3.4.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.3.m3.3.3.3.7" xref="S3.SS2.p13.3.m3.3.3.3.7.cmml">
          o
         </mi>
         <mo id="S3.SS2.p13.3.m3.3.3.3.4b" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.3.3.3.4.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.3.m3.3.3.3.8" xref="S3.SS2.p13.3.m3.3.3.3.8.cmml">
          m
         </mi>
         <mo id="S3.SS2.p13.3.m3.3.3.3.4c" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.3.3.3.4.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.3.m3.3.3.3.9" xref="S3.SS2.p13.3.m3.3.3.3.9.cmml">
          p
         </mi>
         <mo id="S3.SS2.p13.3.m3.3.3.3.4d" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.3.3.3.4.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.3.m3.3.3.3.10" xref="S3.SS2.p13.3.m3.3.3.3.10.cmml">
          t
         </mi>
         <mo id="S3.SS2.p13.3.m3.3.3.3.4e" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.3.3.3.4.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.3.m3.3.3.3.11" xref="S3.SS2.p13.3.m3.3.3.3.11.cmml">
          e
         </mi>
         <mo id="S3.SS2.p13.3.m3.3.3.3.4f" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.3.3.3.4.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.3.m3.3.3.3.12" xref="S3.SS2.p13.3.m3.3.3.3.12.cmml">
          r
         </mi>
         <mo id="S3.SS2.p13.3.m3.3.3.3.4g" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.3.3.3.4.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p13.3.m3.3.3.3.3.3" xref="S3.SS2.p13.3.m3.3.3.3.3.4.cmml">
          <mo id="S3.SS2.p13.3.m3.3.3.3.3.3.4" stretchy="false" xref="S3.SS2.p13.3.m3.3.3.3.3.4.cmml">
           (
          </mo>
          <mrow id="S3.SS2.p13.3.m3.1.1.1.1.1.1" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.cmml">
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.2" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.2.cmml">
            p
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.3" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.3.cmml">
            r
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1a" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.4" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.4.cmml">
            o
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1b" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.5" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.5.cmml">
            m
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1c" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.6" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.6.cmml">
            p
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1d" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.7" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.7.cmml">
            t
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1e" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.8" mathvariant="normal" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.8.cmml">
            _
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1f" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.9" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.9.cmml">
            t
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1g" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.10" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.10.cmml">
            m
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1h" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.11" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.11.cmml">
            p
           </mi>
           <mo id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1i" lspace="0em" rspace="0em" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml">
            ​
           </mo>
           <mi id="S3.SS2.p13.3.m3.1.1.1.1.1.1.12" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.12.cmml">
            l
           </mi>
          </mrow>
          <mo id="S3.SS2.p13.3.m3.3.3.3.3.3.5" xref="S3.SS2.p13.3.m3.3.3.3.3.4.cmml">
           ,
          </mo>
          <msub id="S3.SS2.p13.3.m3.2.2.2.2.2.2" xref="S3.SS2.p13.3.m3.2.2.2.2.2.2.cmml">
           <mi id="S3.SS2.p13.3.m3.2.2.2.2.2.2.2" xref="S3.SS2.p13.3.m3.2.2.2.2.2.2.2.cmml">
            e
           </mi>
           <mi id="S3.SS2.p13.3.m3.2.2.2.2.2.2.3" xref="S3.SS2.p13.3.m3.2.2.2.2.2.2.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S3.SS2.p13.3.m3.3.3.3.3.3.6" xref="S3.SS2.p13.3.m3.3.3.3.3.4.cmml">
           ,
          </mo>
          <msub id="S3.SS2.p13.3.m3.3.3.3.3.3.3" xref="S3.SS2.p13.3.m3.3.3.3.3.3.3.cmml">
           <mi id="S3.SS2.p13.3.m3.3.3.3.3.3.3.2" xref="S3.SS2.p13.3.m3.3.3.3.3.3.3.2.cmml">
            s
           </mi>
           <mi id="S3.SS2.p13.3.m3.3.3.3.3.3.3.3" xref="S3.SS2.p13.3.m3.3.3.3.3.3.3.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S3.SS2.p13.3.m3.3.3.3.3.3.7" stretchy="false" xref="S3.SS2.p13.3.m3.3.3.3.3.4.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p13.3.m3.3b">
        <apply id="S3.SS2.p13.3.m3.3.3.cmml" xref="S3.SS2.p13.3.m3.3.3">
         <eq id="S3.SS2.p13.3.m3.3.3.4.cmml" xref="S3.SS2.p13.3.m3.3.3.4">
         </eq>
         <apply id="S3.SS2.p13.3.m3.3.3.5.cmml" xref="S3.SS2.p13.3.m3.3.3.5">
          <csymbol cd="ambiguous" id="S3.SS2.p13.3.m3.3.3.5.1.cmml" xref="S3.SS2.p13.3.m3.3.3.5">
           subscript
          </csymbol>
          <ci id="S3.SS2.p13.3.m3.3.3.5.2.cmml" xref="S3.SS2.p13.3.m3.3.3.5.2">
           𝑝
          </ci>
          <ci id="S3.SS2.p13.3.m3.3.3.5.3.cmml" xref="S3.SS2.p13.3.m3.3.3.5.3">
           𝑖
          </ci>
         </apply>
         <apply id="S3.SS2.p13.3.m3.3.3.3.cmml" xref="S3.SS2.p13.3.m3.3.3.3">
          <times id="S3.SS2.p13.3.m3.3.3.3.4.cmml" xref="S3.SS2.p13.3.m3.3.3.3.4">
          </times>
          <ci id="S3.SS2.p13.3.m3.3.3.3.5.cmml" xref="S3.SS2.p13.3.m3.3.3.3.5">
           𝑝
          </ci>
          <ci id="S3.SS2.p13.3.m3.3.3.3.6.cmml" xref="S3.SS2.p13.3.m3.3.3.3.6">
           𝑟
          </ci>
          <ci id="S3.SS2.p13.3.m3.3.3.3.7.cmml" xref="S3.SS2.p13.3.m3.3.3.3.7">
           𝑜
          </ci>
          <ci id="S3.SS2.p13.3.m3.3.3.3.8.cmml" xref="S3.SS2.p13.3.m3.3.3.3.8">
           𝑚
          </ci>
          <ci id="S3.SS2.p13.3.m3.3.3.3.9.cmml" xref="S3.SS2.p13.3.m3.3.3.3.9">
           𝑝
          </ci>
          <ci id="S3.SS2.p13.3.m3.3.3.3.10.cmml" xref="S3.SS2.p13.3.m3.3.3.3.10">
           𝑡
          </ci>
          <ci id="S3.SS2.p13.3.m3.3.3.3.11.cmml" xref="S3.SS2.p13.3.m3.3.3.3.11">
           𝑒
          </ci>
          <ci id="S3.SS2.p13.3.m3.3.3.3.12.cmml" xref="S3.SS2.p13.3.m3.3.3.3.12">
           𝑟
          </ci>
          <vector id="S3.SS2.p13.3.m3.3.3.3.3.4.cmml" xref="S3.SS2.p13.3.m3.3.3.3.3.3">
           <apply id="S3.SS2.p13.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1">
            <times id="S3.SS2.p13.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.1">
            </times>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.2">
             𝑝
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.3">
             𝑟
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.4.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.4">
             𝑜
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.5.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.5">
             𝑚
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.6.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.6">
             𝑝
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.7.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.7">
             𝑡
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.8.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.8">
             _
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.9.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.9">
             𝑡
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.10.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.10">
             𝑚
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.11.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.11">
             𝑝
            </ci>
            <ci id="S3.SS2.p13.3.m3.1.1.1.1.1.1.12.cmml" xref="S3.SS2.p13.3.m3.1.1.1.1.1.1.12">
             𝑙
            </ci>
           </apply>
           <apply id="S3.SS2.p13.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS2.p13.3.m3.2.2.2.2.2.2">
            <csymbol cd="ambiguous" id="S3.SS2.p13.3.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p13.3.m3.2.2.2.2.2.2">
             subscript
            </csymbol>
            <ci id="S3.SS2.p13.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p13.3.m3.2.2.2.2.2.2.2">
             𝑒
            </ci>
            <ci id="S3.SS2.p13.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p13.3.m3.2.2.2.2.2.2.3">
             𝑖
            </ci>
           </apply>
           <apply id="S3.SS2.p13.3.m3.3.3.3.3.3.3.cmml" xref="S3.SS2.p13.3.m3.3.3.3.3.3.3">
            <csymbol cd="ambiguous" id="S3.SS2.p13.3.m3.3.3.3.3.3.3.1.cmml" xref="S3.SS2.p13.3.m3.3.3.3.3.3.3">
             subscript
            </csymbol>
            <ci id="S3.SS2.p13.3.m3.3.3.3.3.3.3.2.cmml" xref="S3.SS2.p13.3.m3.3.3.3.3.3.3.2">
             𝑠
            </ci>
            <ci id="S3.SS2.p13.3.m3.3.3.3.3.3.3.3.cmml" xref="S3.SS2.p13.3.m3.3.3.3.3.3.3.3">
             𝑖
            </ci>
           </apply>
          </vector>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p13.3.m3.3c">
        p_{i}=prompter(prompt\_tmpl,e_{i},s_{i})
       </annotation>
      </semantics>
     </math>
     , which can be fed into the LLM to obtain the next intermediate solution
     <math alttext="s_{i+1}=LLM(p_{i})" class="ltx_Math" display="inline" id="S3.SS2.p13.4.m4.1">
      <semantics id="S3.SS2.p13.4.m4.1a">
       <mrow id="S3.SS2.p13.4.m4.1.1" xref="S3.SS2.p13.4.m4.1.1.cmml">
        <msub id="S3.SS2.p13.4.m4.1.1.3" xref="S3.SS2.p13.4.m4.1.1.3.cmml">
         <mi id="S3.SS2.p13.4.m4.1.1.3.2" xref="S3.SS2.p13.4.m4.1.1.3.2.cmml">
          s
         </mi>
         <mrow id="S3.SS2.p13.4.m4.1.1.3.3" xref="S3.SS2.p13.4.m4.1.1.3.3.cmml">
          <mi id="S3.SS2.p13.4.m4.1.1.3.3.2" xref="S3.SS2.p13.4.m4.1.1.3.3.2.cmml">
           i
          </mi>
          <mo id="S3.SS2.p13.4.m4.1.1.3.3.1" xref="S3.SS2.p13.4.m4.1.1.3.3.1.cmml">
           +
          </mo>
          <mn id="S3.SS2.p13.4.m4.1.1.3.3.3" xref="S3.SS2.p13.4.m4.1.1.3.3.3.cmml">
           1
          </mn>
         </mrow>
        </msub>
        <mo id="S3.SS2.p13.4.m4.1.1.2" xref="S3.SS2.p13.4.m4.1.1.2.cmml">
         =
        </mo>
        <mrow id="S3.SS2.p13.4.m4.1.1.1" xref="S3.SS2.p13.4.m4.1.1.1.cmml">
         <mi id="S3.SS2.p13.4.m4.1.1.1.3" xref="S3.SS2.p13.4.m4.1.1.1.3.cmml">
          L
         </mi>
         <mo id="S3.SS2.p13.4.m4.1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS2.p13.4.m4.1.1.1.2.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.4.m4.1.1.1.4" xref="S3.SS2.p13.4.m4.1.1.1.4.cmml">
          L
         </mi>
         <mo id="S3.SS2.p13.4.m4.1.1.1.2a" lspace="0em" rspace="0em" xref="S3.SS2.p13.4.m4.1.1.1.2.cmml">
          ​
         </mo>
         <mi id="S3.SS2.p13.4.m4.1.1.1.5" xref="S3.SS2.p13.4.m4.1.1.1.5.cmml">
          M
         </mi>
         <mo id="S3.SS2.p13.4.m4.1.1.1.2b" lspace="0em" rspace="0em" xref="S3.SS2.p13.4.m4.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p13.4.m4.1.1.1.1.1" xref="S3.SS2.p13.4.m4.1.1.1.1.1.1.cmml">
          <mo id="S3.SS2.p13.4.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p13.4.m4.1.1.1.1.1.1.cmml">
           (
          </mo>
          <msub id="S3.SS2.p13.4.m4.1.1.1.1.1.1" xref="S3.SS2.p13.4.m4.1.1.1.1.1.1.cmml">
           <mi id="S3.SS2.p13.4.m4.1.1.1.1.1.1.2" xref="S3.SS2.p13.4.m4.1.1.1.1.1.1.2.cmml">
            p
           </mi>
           <mi id="S3.SS2.p13.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.p13.4.m4.1.1.1.1.1.1.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S3.SS2.p13.4.m4.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p13.4.m4.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p13.4.m4.1b">
        <apply id="S3.SS2.p13.4.m4.1.1.cmml" xref="S3.SS2.p13.4.m4.1.1">
         <eq id="S3.SS2.p13.4.m4.1.1.2.cmml" xref="S3.SS2.p13.4.m4.1.1.2">
         </eq>
         <apply id="S3.SS2.p13.4.m4.1.1.3.cmml" xref="S3.SS2.p13.4.m4.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS2.p13.4.m4.1.1.3.1.cmml" xref="S3.SS2.p13.4.m4.1.1.3">
           subscript
          </csymbol>
          <ci id="S3.SS2.p13.4.m4.1.1.3.2.cmml" xref="S3.SS2.p13.4.m4.1.1.3.2">
           𝑠
          </ci>
          <apply id="S3.SS2.p13.4.m4.1.1.3.3.cmml" xref="S3.SS2.p13.4.m4.1.1.3.3">
           <plus id="S3.SS2.p13.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p13.4.m4.1.1.3.3.1">
           </plus>
           <ci id="S3.SS2.p13.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.p13.4.m4.1.1.3.3.2">
            𝑖
           </ci>
           <cn id="S3.SS2.p13.4.m4.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p13.4.m4.1.1.3.3.3">
            1
           </cn>
          </apply>
         </apply>
         <apply id="S3.SS2.p13.4.m4.1.1.1.cmml" xref="S3.SS2.p13.4.m4.1.1.1">
          <times id="S3.SS2.p13.4.m4.1.1.1.2.cmml" xref="S3.SS2.p13.4.m4.1.1.1.2">
          </times>
          <ci id="S3.SS2.p13.4.m4.1.1.1.3.cmml" xref="S3.SS2.p13.4.m4.1.1.1.3">
           𝐿
          </ci>
          <ci id="S3.SS2.p13.4.m4.1.1.1.4.cmml" xref="S3.SS2.p13.4.m4.1.1.1.4">
           𝐿
          </ci>
          <ci id="S3.SS2.p13.4.m4.1.1.1.5.cmml" xref="S3.SS2.p13.4.m4.1.1.1.5">
           𝑀
          </ci>
          <apply id="S3.SS2.p13.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p13.4.m4.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS2.p13.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p13.4.m4.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS2.p13.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p13.4.m4.1.1.1.1.1.1.2">
            𝑝
           </ci>
           <ci id="S3.SS2.p13.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p13.4.m4.1.1.1.1.1.1.3">
            𝑖
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p13.4.m4.1c">
        s_{i+1}=LLM(p_{i})
       </annotation>
      </semantics>
     </math>
     . The neural network architecture for the prompter’s policy network is similar to that of the ToT controller. The only difference is that since the in-context examples are expressed in natural language, instead of FFN, we use an attention model to process them:
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p14">
    <table class="ltx_equation ltx_eqn_table" id="S3.E4">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\begin{split}\mathbf{h}(e)&amp;=\mathbf{M}_{1}\cdot\textrm{Attention}(e)+\mathbf{c}_{1}\\
\mathbf{h}(s_{i},..,s_{i-k})&amp;=\mathbf{M}_{2}\cdot\textrm{Attention}(\textrm{PE}(s_{i-k}||..||s_{i-1}||s_{i}))+\mathbf{c}_{2}\\
\pi^{p}_{\theta}(e|s_{i},..,s_{i-k})&amp;=\frac{\textrm{exp}(\mathbf{h}(e)\cdot\mathbf{h}(s_{i},..,s_{i-k}))}{\sum_{e^{\prime}\in E_{cand}}{\textrm{exp}(\mathbf{h}(e^{\prime})\cdot\mathbf{h}(s_{i},..,s_{i-k}))}}\end{split}" class="ltx_math_unparsed" display="block" id="S3.E4.m1.70">
         <semantics id="S3.E4.m1.70a">
          <mtable columnspacing="0pt" displaystyle="true" id="S3.E4.m1.70.70" rowspacing="0pt">
           <mtr id="S3.E4.m1.70.70a">
            <mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.70.70b">
             <mrow id="S3.E4.m1.4.4.4.4.4">
              <mi id="S3.E4.m1.1.1.1.1.1.1">
               𝐡
              </mi>
              <mo id="S3.E4.m1.4.4.4.4.4.5" lspace="0em" rspace="0em">
               ​
              </mo>
              <mrow id="S3.E4.m1.4.4.4.4.4.6">
               <mo id="S3.E4.m1.2.2.2.2.2.2" stretchy="false">
                (
               </mo>
               <mi id="S3.E4.m1.3.3.3.3.3.3">
                e
               </mi>
               <mo id="S3.E4.m1.4.4.4.4.4.4" stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
            </mtd>
            <mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.70.70c">
             <mrow id="S3.E4.m1.15.15.15.15.11">
              <mi id="S3.E4.m1.15.15.15.15.11.12">
              </mi>
              <mo id="S3.E4.m1.5.5.5.5.1.1">
               =
              </mo>
              <mrow id="S3.E4.m1.15.15.15.15.11.13">
               <mrow id="S3.E4.m1.15.15.15.15.11.13.1">
                <mrow id="S3.E4.m1.15.15.15.15.11.13.1.2">
                 <msub id="S3.E4.m1.15.15.15.15.11.13.1.2.1">
                  <mi id="S3.E4.m1.6.6.6.6.2.2">
                   𝐌
                  </mi>
                  <mn id="S3.E4.m1.7.7.7.7.3.3.1">
                   1
                  </mn>
                 </msub>
                 <mo id="S3.E4.m1.8.8.8.8.4.4" lspace="0.222em" rspace="0.222em">
                  ⋅
                 </mo>
                 <mtext id="S3.E4.m1.9.9.9.9.5.5">
                  Attention
                 </mtext>
                </mrow>
                <mo id="S3.E4.m1.15.15.15.15.11.13.1.1" lspace="0em" rspace="0em">
                 ​
                </mo>
                <mrow id="S3.E4.m1.15.15.15.15.11.13.1.3">
                 <mo id="S3.E4.m1.10.10.10.10.6.6" stretchy="false">
                  (
                 </mo>
                 <mi id="S3.E4.m1.11.11.11.11.7.7">
                  e
                 </mi>
                 <mo id="S3.E4.m1.12.12.12.12.8.8" stretchy="false">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="S3.E4.m1.13.13.13.13.9.9">
                +
               </mo>
               <msub id="S3.E4.m1.15.15.15.15.11.13.2">
                <mi id="S3.E4.m1.14.14.14.14.10.10">
                 𝐜
                </mi>
                <mn id="S3.E4.m1.15.15.15.15.11.11.1">
                 1
                </mn>
               </msub>
              </mrow>
             </mrow>
            </mtd>
           </mtr>
           <mtr id="S3.E4.m1.70.70d">
            <mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.70.70e">
             <mrow id="S3.E4.m1.26.26.26.11.11">
              <mi id="S3.E4.m1.16.16.16.1.1.1">
               𝐡
              </mi>
              <mrow id="S3.E4.m1.26.26.26.11.11.12">
               <mo id="S3.E4.m1.17.17.17.2.2.2" stretchy="false">
                (
               </mo>
               <msub id="S3.E4.m1.26.26.26.11.11.12.1">
                <mi id="S3.E4.m1.18.18.18.3.3.3">
                 s
                </mi>
                <mi id="S3.E4.m1.19.19.19.4.4.4.1">
                 i
                </mi>
               </msub>
               <mo id="S3.E4.m1.20.20.20.5.5.5">
                ,
               </mo>
               <mo id="S3.E4.m1.21.21.21.6.6.6" lspace="0em" rspace="0.0835em">
                .
               </mo>
               <mo id="S3.E4.m1.22.22.22.7.7.7" lspace="0.0835em" rspace="0.167em">
                .
               </mo>
               <mo id="S3.E4.m1.23.23.23.8.8.8">
                ,
               </mo>
               <msub id="S3.E4.m1.26.26.26.11.11.12.2">
                <mi id="S3.E4.m1.24.24.24.9.9.9">
                 s
                </mi>
                <mrow id="S3.E4.m1.25.25.25.10.10.10.1">
                 <mi id="S3.E4.m1.25.25.25.10.10.10.1.2">
                  i
                 </mi>
                 <mo id="S3.E4.m1.25.25.25.10.10.10.1.1">
                  −
                 </mo>
                 <mi id="S3.E4.m1.25.25.25.10.10.10.1.3">
                  k
                 </mi>
                </mrow>
               </msub>
               <mo id="S3.E4.m1.26.26.26.11.11.11" stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
            </mtd>
            <mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.70.70f">
             <mrow id="S3.E4.m1.53.53.53.38.27">
              <mo id="S3.E4.m1.27.27.27.12.1.1">
               =
              </mo>
              <msub id="S3.E4.m1.53.53.53.38.27.28">
               <mi id="S3.E4.m1.28.28.28.13.2.2">
                𝐌
               </mi>
               <mn id="S3.E4.m1.29.29.29.14.3.3.1">
                2
               </mn>
              </msub>
              <mo id="S3.E4.m1.30.30.30.15.4.4" lspace="0.222em" rspace="0.222em">
               ⋅
              </mo>
              <mtext id="S3.E4.m1.31.31.31.16.5.5">
               Attention
              </mtext>
              <mrow id="S3.E4.m1.53.53.53.38.27.29">
               <mo id="S3.E4.m1.32.32.32.17.6.6" stretchy="false">
                (
               </mo>
               <mtext id="S3.E4.m1.33.33.33.18.7.7">
                PE
               </mtext>
               <mrow id="S3.E4.m1.53.53.53.38.27.29.1">
                <mo id="S3.E4.m1.34.34.34.19.8.8" stretchy="false">
                 (
                </mo>
                <msub id="S3.E4.m1.53.53.53.38.27.29.1.1">
                 <mi id="S3.E4.m1.35.35.35.20.9.9">
                  s
                 </mi>
                 <mrow id="S3.E4.m1.36.36.36.21.10.10.1">
                  <mi id="S3.E4.m1.36.36.36.21.10.10.1.2">
                   i
                  </mi>
                  <mo id="S3.E4.m1.36.36.36.21.10.10.1.1">
                   −
                  </mo>
                  <mi id="S3.E4.m1.36.36.36.21.10.10.1.3">
                   k
                  </mi>
                 </mrow>
                </msub>
                <mo fence="false" id="S3.E4.m1.37.37.37.22.11.11" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <mo fence="false" id="S3.E4.m1.38.38.38.23.12.12" stretchy="false">
                 |
                </mo>
                <mo id="S3.E4.m1.39.39.39.24.13.13" lspace="0.167em" rspace="0.0835em">
                 .
                </mo>
                <mo id="S3.E4.m1.40.40.40.25.14.14" lspace="0.0835em" rspace="0.167em">
                 .
                </mo>
                <mo fence="false" id="S3.E4.m1.41.41.41.26.15.15" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <mo fence="false" id="S3.E4.m1.42.42.42.27.16.16" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <msub id="S3.E4.m1.53.53.53.38.27.29.1.2">
                 <mi id="S3.E4.m1.43.43.43.28.17.17">
                  s
                 </mi>
                 <mrow id="S3.E4.m1.44.44.44.29.18.18.1">
                  <mi id="S3.E4.m1.44.44.44.29.18.18.1.2">
                   i
                  </mi>
                  <mo id="S3.E4.m1.44.44.44.29.18.18.1.1">
                   −
                  </mo>
                  <mn id="S3.E4.m1.44.44.44.29.18.18.1.3">
                   1
                  </mn>
                 </mrow>
                </msub>
                <mo fence="false" id="S3.E4.m1.45.45.45.30.19.19" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <mo fence="false" id="S3.E4.m1.46.46.46.31.20.20" rspace="0.167em" stretchy="false">
                 |
                </mo>
                <msub id="S3.E4.m1.53.53.53.38.27.29.1.3">
                 <mi id="S3.E4.m1.47.47.47.32.21.21">
                  s
                 </mi>
                 <mi id="S3.E4.m1.48.48.48.33.22.22.1">
                  i
                 </mi>
                </msub>
                <mo id="S3.E4.m1.49.49.49.34.23.23" stretchy="false">
                 )
                </mo>
               </mrow>
               <mo id="S3.E4.m1.50.50.50.35.24.24" stretchy="false">
                )
               </mo>
              </mrow>
              <mo id="S3.E4.m1.51.51.51.36.25.25">
               +
              </mo>
              <msub id="S3.E4.m1.53.53.53.38.27.30">
               <mi id="S3.E4.m1.52.52.52.37.26.26">
                𝐜
               </mi>
               <mn id="S3.E4.m1.53.53.53.38.27.27.1">
                2
               </mn>
              </msub>
             </mrow>
            </mtd>
           </mtr>
           <mtr id="S3.E4.m1.70.70g">
            <mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.70.70h">
             <mrow id="S3.E4.m1.68.68.68.15.15">
              <msubsup id="S3.E4.m1.68.68.68.15.15.16">
               <mi id="S3.E4.m1.54.54.54.1.1.1">
                π
               </mi>
               <mi id="S3.E4.m1.56.56.56.3.3.3.1">
                θ
               </mi>
               <mi id="S3.E4.m1.55.55.55.2.2.2.1">
                p
               </mi>
              </msubsup>
              <mrow id="S3.E4.m1.68.68.68.15.15.17">
               <mo id="S3.E4.m1.57.57.57.4.4.4" stretchy="false">
                (
               </mo>
               <mi id="S3.E4.m1.58.58.58.5.5.5">
                e
               </mi>
               <mo fence="false" id="S3.E4.m1.59.59.59.6.6.6" rspace="0.167em" stretchy="false">
                |
               </mo>
               <msub id="S3.E4.m1.68.68.68.15.15.17.1">
                <mi id="S3.E4.m1.60.60.60.7.7.7">
                 s
                </mi>
                <mi id="S3.E4.m1.61.61.61.8.8.8.1">
                 i
                </mi>
               </msub>
               <mo id="S3.E4.m1.62.62.62.9.9.9">
                ,
               </mo>
               <mo id="S3.E4.m1.63.63.63.10.10.10" lspace="0em" rspace="0.0835em">
                .
               </mo>
               <mo id="S3.E4.m1.64.64.64.11.11.11" lspace="0.0835em" rspace="0.167em">
                .
               </mo>
               <mo id="S3.E4.m1.65.65.65.12.12.12">
                ,
               </mo>
               <msub id="S3.E4.m1.68.68.68.15.15.17.2">
                <mi id="S3.E4.m1.66.66.66.13.13.13">
                 s
                </mi>
                <mrow id="S3.E4.m1.67.67.67.14.14.14.1">
                 <mi id="S3.E4.m1.67.67.67.14.14.14.1.2">
                  i
                 </mi>
                 <mo id="S3.E4.m1.67.67.67.14.14.14.1.1">
                  −
                 </mo>
                 <mi id="S3.E4.m1.67.67.67.14.14.14.1.3">
                  k
                 </mi>
                </mrow>
               </msub>
               <mo id="S3.E4.m1.68.68.68.15.15.15" stretchy="false">
                )
               </mo>
              </mrow>
             </mrow>
            </mtd>
            <mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.70.70i">
             <mrow id="S3.E4.m1.70.70.70.17.2">
              <mi id="S3.E4.m1.70.70.70.17.2.3">
              </mi>
              <mo id="S3.E4.m1.69.69.69.16.1.1">
               =
              </mo>
              <mfrac id="S3.E4.m1.70.70.70.17.2.2">
               <mrow id="S3.E4.m1.70.70.70.17.2.2.1">
                <mtext id="S3.E4.m1.70.70.70.17.2.2.1.2">
                 exp
                </mtext>
                <mrow id="S3.E4.m1.70.70.70.17.2.2.1.3">
                 <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.1" stretchy="false">
                  (
                 </mo>
                 <mi id="S3.E4.m1.70.70.70.17.2.2.1.3.2">
                  𝐡
                 </mi>
                 <mrow id="S3.E4.m1.70.70.70.17.2.2.1.3.3">
                  <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.3.1" stretchy="false">
                   (
                  </mo>
                  <mi id="S3.E4.m1.70.70.70.17.2.2.1.1">
                   e
                  </mi>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.3.2" rspace="0.055em" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.4" rspace="0.222em">
                  ⋅
                 </mo>
                 <mi id="S3.E4.m1.70.70.70.17.2.2.1.3.5">
                  𝐡
                 </mi>
                 <mrow id="S3.E4.m1.70.70.70.17.2.2.1.3.6">
                  <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.6.1" stretchy="false">
                   (
                  </mo>
                  <msub id="S3.E4.m1.70.70.70.17.2.2.1.3.6.2">
                   <mi id="S3.E4.m1.70.70.70.17.2.2.1.3.6.2.2">
                    s
                   </mi>
                   <mi id="S3.E4.m1.70.70.70.17.2.2.1.3.6.2.3">
                    i
                   </mi>
                  </msub>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.6.3">
                   ,
                  </mo>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.6.4" lspace="0em" rspace="0.0835em">
                   .
                  </mo>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.6.5" lspace="0.0835em" rspace="0.167em">
                   .
                  </mo>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.6.6">
                   ,
                  </mo>
                  <msub id="S3.E4.m1.70.70.70.17.2.2.1.3.6.7">
                   <mi id="S3.E4.m1.70.70.70.17.2.2.1.3.6.7.2">
                    s
                   </mi>
                   <mrow id="S3.E4.m1.70.70.70.17.2.2.1.3.6.7.3">
                    <mi id="S3.E4.m1.70.70.70.17.2.2.1.3.6.7.3.2">
                     i
                    </mi>
                    <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.6.7.3.1">
                     −
                    </mo>
                    <mi id="S3.E4.m1.70.70.70.17.2.2.1.3.6.7.3.3">
                     k
                    </mi>
                   </mrow>
                  </msub>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.6.8" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S3.E4.m1.70.70.70.17.2.2.1.3.7" stretchy="false">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mrow id="S3.E4.m1.70.70.70.17.2.2.3">
                <msub id="S3.E4.m1.70.70.70.17.2.2.3.1">
                 <mo id="S3.E4.m1.70.70.70.17.2.2.3.1.2">
                  ∑
                 </mo>
                 <mrow id="S3.E4.m1.70.70.70.17.2.2.3.1.3">
                  <msup id="S3.E4.m1.70.70.70.17.2.2.3.1.3.2">
                   <mi id="S3.E4.m1.70.70.70.17.2.2.3.1.3.2.2">
                    e
                   </mi>
                   <mo id="S3.E4.m1.70.70.70.17.2.2.3.1.3.2.3">
                    ′
                   </mo>
                  </msup>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.1.3.1">
                   ∈
                  </mo>
                  <msub id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3">
                   <mi id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.2">
                    E
                   </mi>
                   <mrow id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.3">
                    <mi id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.3.2">
                     c
                    </mi>
                    <mo id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.3.1" lspace="0em" rspace="0em">
                     ​
                    </mo>
                    <mi id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.3.3">
                     a
                    </mi>
                    <mo id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.3.1a" lspace="0em" rspace="0em">
                     ​
                    </mo>
                    <mi id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.3.4">
                     n
                    </mi>
                    <mo id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.3.1b" lspace="0em" rspace="0em">
                     ​
                    </mo>
                    <mi id="S3.E4.m1.70.70.70.17.2.2.3.1.3.3.3.5">
                     d
                    </mi>
                   </mrow>
                  </msub>
                 </mrow>
                </msub>
                <mtext id="S3.E4.m1.70.70.70.17.2.2.3.2">
                 exp
                </mtext>
                <mrow id="S3.E4.m1.70.70.70.17.2.2.3.3">
                 <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.1" stretchy="false">
                  (
                 </mo>
                 <mi id="S3.E4.m1.70.70.70.17.2.2.3.3.2">
                  𝐡
                 </mi>
                 <mrow id="S3.E4.m1.70.70.70.17.2.2.3.3.3">
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.3.1" stretchy="false">
                   (
                  </mo>
                  <msup id="S3.E4.m1.70.70.70.17.2.2.3.3.3.2">
                   <mi id="S3.E4.m1.70.70.70.17.2.2.3.3.3.2.2">
                    e
                   </mi>
                   <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.3.2.3">
                    ′
                   </mo>
                  </msup>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.3.3" rspace="0.055em" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.4" rspace="0.222em">
                  ⋅
                 </mo>
                 <mi id="S3.E4.m1.70.70.70.17.2.2.3.3.5">
                  𝐡
                 </mi>
                 <mrow id="S3.E4.m1.70.70.70.17.2.2.3.3.6">
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.6.1" stretchy="false">
                   (
                  </mo>
                  <msub id="S3.E4.m1.70.70.70.17.2.2.3.3.6.2">
                   <mi id="S3.E4.m1.70.70.70.17.2.2.3.3.6.2.2">
                    s
                   </mi>
                   <mi id="S3.E4.m1.70.70.70.17.2.2.3.3.6.2.3">
                    i
                   </mi>
                  </msub>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.6.3">
                   ,
                  </mo>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.6.4" lspace="0em" rspace="0.0835em">
                   .
                  </mo>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.6.5" lspace="0.0835em" rspace="0.167em">
                   .
                  </mo>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.6.6">
                   ,
                  </mo>
                  <msub id="S3.E4.m1.70.70.70.17.2.2.3.3.6.7">
                   <mi id="S3.E4.m1.70.70.70.17.2.2.3.3.6.7.2">
                    s
                   </mi>
                   <mrow id="S3.E4.m1.70.70.70.17.2.2.3.3.6.7.3">
                    <mi id="S3.E4.m1.70.70.70.17.2.2.3.3.6.7.3.2">
                     i
                    </mi>
                    <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.6.7.3.1">
                     −
                    </mo>
                    <mi id="S3.E4.m1.70.70.70.17.2.2.3.3.6.7.3.3">
                     k
                    </mi>
                   </mrow>
                  </msub>
                  <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.6.8" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S3.E4.m1.70.70.70.17.2.2.3.3.7" stretchy="false">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mfrac>
             </mrow>
            </mtd>
           </mtr>
          </mtable>
          <annotation encoding="application/x-tex" id="S3.E4.m1.70b">
           \begin{split}\mathbf{h}(e)&amp;=\mathbf{M}_{1}\cdot\textrm{Attention}(e)+\mathbf{c}_{1}\\
\mathbf{h}(s_{i},..,s_{i-k})&amp;=\mathbf{M}_{2}\cdot\textrm{Attention}(\textrm{PE}(s_{i-k}||..||s_{i-1}||s_{i}))+\mathbf{c}_{2}\\
\pi^{p}_{\theta}(e|s_{i},..,s_{i-k})&amp;=\frac{\textrm{exp}(\mathbf{h}(e)\cdot\mathbf{h}(s_{i},..,s_{i-k}))}{\sum_{e^{\prime}\in E_{cand}}{\textrm{exp}(\mathbf{h}(e^{\prime})\cdot\mathbf{h}(s_{i},..,s_{i-k}))}}\end{split}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para" id="S3.SS2.p15">
    <p class="ltx_p" id="S3.SS2.p15.1">
     The prompter policy network can be trained together with the ToT controller using multi-agent reinforcement learning methods. The training algorithm of the prompter’s policy network is discussed in Section
     <a class="ltx_ref" href="#S3.SS3" title="3.3 ToT System Training ‣ 3 Architecture ‣ Large Language Model Guided Tree-of-Thought">
      <span class="ltx_text ltx_ref_tag">
       3.3
      </span>
     </a>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    ToT System Training
   </h3>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg1.2.1.1">
       Algorithm 1
      </span>
     </span>
     Policy Gradient based Training Algorithm for the ToT System
    </figcaption>
    <div class="ltx_listing ltx_listing" id="alg1.3">
     <div class="ltx_listingline" id="alg1.l1">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">
        1:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l1.2">
       Input:
      </span>
      training set
      <math alttext="P_{train}" class="ltx_Math" display="inline" id="alg1.l1.m1.1">
       <semantics id="alg1.l1.m1.1a">
        <msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">
         <mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">
          P
         </mi>
         <mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">
          <mi id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml">
           t
          </mi>
          <mo id="alg1.l1.m1.1.1.3.1" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml">
           r
          </mi>
          <mo id="alg1.l1.m1.1.1.3.1a" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg1.l1.m1.1.1.3.4" xref="alg1.l1.m1.1.1.3.4.cmml">
           a
          </mi>
          <mo id="alg1.l1.m1.1.1.3.1b" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg1.l1.m1.1.1.3.5" xref="alg1.l1.m1.1.1.3.5.cmml">
           i
          </mi>
          <mo id="alg1.l1.m1.1.1.3.1c" lspace="0em" rspace="0em" xref="alg1.l1.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg1.l1.m1.1.1.3.6" xref="alg1.l1.m1.1.1.3.6.cmml">
           n
          </mi>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b">
         <apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">
           𝑃
          </ci>
          <apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">
           <times id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1">
           </times>
           <ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">
            𝑡
           </ci>
           <ci id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">
            𝑟
           </ci>
           <ci id="alg1.l1.m1.1.1.3.4.cmml" xref="alg1.l1.m1.1.1.3.4">
            𝑎
           </ci>
           <ci id="alg1.l1.m1.1.1.3.5.cmml" xref="alg1.l1.m1.1.1.3.5">
            𝑖
           </ci>
           <ci id="alg1.l1.m1.1.1.3.6.cmml" xref="alg1.l1.m1.1.1.3.6">
            𝑛
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m1.1c">
         P_{train}
        </annotation>
       </semantics>
      </math>
      , num of training epochs
      <math alttext="N" class="ltx_Math" display="inline" id="alg1.l1.m2.1">
       <semantics id="alg1.l1.m2.1a">
        <mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">
         N
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b">
         <ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">
          𝑁
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m2.1c">
         N
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l2">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">
        2:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l2.2">
       procedure
      </span>
      <span class="ltx_text ltx_font_smallcaps" id="alg1.l2.3">
       REINFORCE
      </span>
      (
      <math alttext="P_{train}" class="ltx_Math" display="inline" id="alg1.l2.m1.1">
       <semantics id="alg1.l2.m1.1a">
        <msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">
         <mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">
          P
         </mi>
         <mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">
          <mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">
           t
          </mi>
          <mo id="alg1.l2.m1.1.1.3.1" lspace="0em" rspace="0em" xref="alg1.l2.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">
           r
          </mi>
          <mo id="alg1.l2.m1.1.1.3.1a" lspace="0em" rspace="0em" xref="alg1.l2.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg1.l2.m1.1.1.3.4" xref="alg1.l2.m1.1.1.3.4.cmml">
           a
          </mi>
          <mo id="alg1.l2.m1.1.1.3.1b" lspace="0em" rspace="0em" xref="alg1.l2.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg1.l2.m1.1.1.3.5" xref="alg1.l2.m1.1.1.3.5.cmml">
           i
          </mi>
          <mo id="alg1.l2.m1.1.1.3.1c" lspace="0em" rspace="0em" xref="alg1.l2.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg1.l2.m1.1.1.3.6" xref="alg1.l2.m1.1.1.3.6.cmml">
           n
          </mi>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b">
         <apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">
           𝑃
          </ci>
          <apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">
           <times id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1">
           </times>
           <ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">
            𝑡
           </ci>
           <ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">
            𝑟
           </ci>
           <ci id="alg1.l2.m1.1.1.3.4.cmml" xref="alg1.l2.m1.1.1.3.4">
            𝑎
           </ci>
           <ci id="alg1.l2.m1.1.1.3.5.cmml" xref="alg1.l2.m1.1.1.3.5">
            𝑖
           </ci>
           <ci id="alg1.l2.m1.1.1.3.6.cmml" xref="alg1.l2.m1.1.1.3.6">
            𝑛
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m1.1c">
         P_{train}
        </annotation>
       </semantics>
      </math>
      ,
      <math alttext="N" class="ltx_Math" display="inline" id="alg1.l2.m2.1">
       <semantics id="alg1.l2.m2.1a">
        <mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">
         N
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b">
         <ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">
          𝑁
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m2.1c">
         N
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg1.l3">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">
        3:
       </span>
      </span>
      randomly initialized the ToT Controller policy
      <math alttext="\pi^{t}_{\rho}" class="ltx_Math" display="inline" id="alg1.l3.m1.1">
       <semantics id="alg1.l3.m1.1a">
        <msubsup id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">
         <mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">
          π
         </mi>
         <mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">
          ρ
         </mi>
         <mi id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">
          t
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b">
         <apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">
           subscript
          </csymbol>
          <apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1">
           <csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1">
            superscript
           </csymbol>
           <ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">
            𝜋
           </ci>
           <ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">
            𝑡
           </ci>
          </apply>
          <ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">
           𝜌
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l3.m1.1c">
         \pi^{t}_{\rho}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l4">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">
        4:
       </span>
      </span>
      randomly initialized the Prompter agent policy
      <math alttext="\pi^{p}_{\theta}" class="ltx_Math" display="inline" id="alg1.l4.m1.1">
       <semantics id="alg1.l4.m1.1a">
        <msubsup id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">
         <mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">
          π
         </mi>
         <mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">
          θ
         </mi>
         <mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">
          p
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b">
         <apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">
           subscript
          </csymbol>
          <apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1">
           <csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1">
            superscript
           </csymbol>
           <ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">
            𝜋
           </ci>
           <ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">
            𝑝
           </ci>
          </apply>
          <ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">
           𝜃
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l4.m1.1c">
         \pi^{p}_{\theta}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l5">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">
        5:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l5.2">
       for
      </span>
      <math alttext="epoch" class="ltx_Math" display="inline" id="alg1.l5.m1.1">
       <semantics id="alg1.l5.m1.1a">
        <mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">
         <mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">
          e
         </mi>
         <mo id="alg1.l5.m1.1.1.1" lspace="0em" rspace="0em" xref="alg1.l5.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">
          p
         </mi>
         <mo id="alg1.l5.m1.1.1.1a" lspace="0em" rspace="0em" xref="alg1.l5.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg1.l5.m1.1.1.4" xref="alg1.l5.m1.1.1.4.cmml">
          o
         </mi>
         <mo id="alg1.l5.m1.1.1.1b" lspace="0em" rspace="0em" xref="alg1.l5.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg1.l5.m1.1.1.5" xref="alg1.l5.m1.1.1.5.cmml">
          c
         </mi>
         <mo id="alg1.l5.m1.1.1.1c" lspace="0em" rspace="0em" xref="alg1.l5.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg1.l5.m1.1.1.6" xref="alg1.l5.m1.1.1.6.cmml">
          h
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b">
         <apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">
          <times id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">
          </times>
          <ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">
           𝑒
          </ci>
          <ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">
           𝑝
          </ci>
          <ci id="alg1.l5.m1.1.1.4.cmml" xref="alg1.l5.m1.1.1.4">
           𝑜
          </ci>
          <ci id="alg1.l5.m1.1.1.5.cmml" xref="alg1.l5.m1.1.1.5">
           𝑐
          </ci>
          <ci id="alg1.l5.m1.1.1.6.cmml" xref="alg1.l5.m1.1.1.6">
           ℎ
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m1.1c">
         epoch
        </annotation>
       </semantics>
      </math>
      = 1, 2, ..,
      <math alttext="N" class="ltx_Math" display="inline" id="alg1.l5.m2.1">
       <semantics id="alg1.l5.m2.1a">
        <mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">
         N
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b">
         <ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">
          𝑁
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m2.1c">
         N
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l5.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l6">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l6.2.1.1" style="font-size:80%;">
        6:
       </span>
      </span>
      <math alttext="\pi_{w}\leftarrow" class="ltx_Math" display="inline" id="alg1.l6.m1.1">
       <semantics id="alg1.l6.m1.1a">
        <mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">
         <msub id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">
          <mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">
           π
          </mi>
          <mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">
           w
          </mi>
         </msub>
         <mo id="alg1.l6.m1.1.1.1" stretchy="false" xref="alg1.l6.m1.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b">
         <apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">
          <ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">
           ←
          </ci>
          <apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">
            subscript
           </csymbol>
           <ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">
            𝜋
           </ci>
           <ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">
            𝑤
           </ci>
          </apply>
          <csymbol cd="latexml" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">
           absent
          </csymbol>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m1.1c">
         \pi_{w}\leftarrow
        </annotation>
       </semantics>
      </math>
      <math alttext="\pi^{t}_{\rho}" class="ltx_Math" display="inline" id="alg1.l6.m2.1">
       <semantics id="alg1.l6.m2.1a">
        <msubsup id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">
         <mi id="alg1.l6.m2.1.1.2.2" xref="alg1.l6.m2.1.1.2.2.cmml">
          π
         </mi>
         <mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">
          ρ
         </mi>
         <mi id="alg1.l6.m2.1.1.2.3" xref="alg1.l6.m2.1.1.2.3.cmml">
          t
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b">
         <apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">
           subscript
          </csymbol>
          <apply id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1">
           <csymbol cd="ambiguous" id="alg1.l6.m2.1.1.2.1.cmml" xref="alg1.l6.m2.1.1">
            superscript
           </csymbol>
           <ci id="alg1.l6.m2.1.1.2.2.cmml" xref="alg1.l6.m2.1.1.2.2">
            𝜋
           </ci>
           <ci id="alg1.l6.m2.1.1.2.3.cmml" xref="alg1.l6.m2.1.1.2.3">
            𝑡
           </ci>
          </apply>
          <ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">
           𝜌
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m2.1c">
         \pi^{t}_{\rho}
        </annotation>
       </semantics>
      </math>
      if
      <math alttext="epoch" class="ltx_Math" display="inline" id="alg1.l6.m3.1">
       <semantics id="alg1.l6.m3.1a">
        <mrow id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml">
         <mi id="alg1.l6.m3.1.1.2" xref="alg1.l6.m3.1.1.2.cmml">
          e
         </mi>
         <mo id="alg1.l6.m3.1.1.1" lspace="0em" rspace="0em" xref="alg1.l6.m3.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg1.l6.m3.1.1.3" xref="alg1.l6.m3.1.1.3.cmml">
          p
         </mi>
         <mo id="alg1.l6.m3.1.1.1a" lspace="0em" rspace="0em" xref="alg1.l6.m3.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg1.l6.m3.1.1.4" xref="alg1.l6.m3.1.1.4.cmml">
          o
         </mi>
         <mo id="alg1.l6.m3.1.1.1b" lspace="0em" rspace="0em" xref="alg1.l6.m3.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg1.l6.m3.1.1.5" xref="alg1.l6.m3.1.1.5.cmml">
          c
         </mi>
         <mo id="alg1.l6.m3.1.1.1c" lspace="0em" rspace="0em" xref="alg1.l6.m3.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg1.l6.m3.1.1.6" xref="alg1.l6.m3.1.1.6.cmml">
          h
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b">
         <apply id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1">
          <times id="alg1.l6.m3.1.1.1.cmml" xref="alg1.l6.m3.1.1.1">
          </times>
          <ci id="alg1.l6.m3.1.1.2.cmml" xref="alg1.l6.m3.1.1.2">
           𝑒
          </ci>
          <ci id="alg1.l6.m3.1.1.3.cmml" xref="alg1.l6.m3.1.1.3">
           𝑝
          </ci>
          <ci id="alg1.l6.m3.1.1.4.cmml" xref="alg1.l6.m3.1.1.4">
           𝑜
          </ci>
          <ci id="alg1.l6.m3.1.1.5.cmml" xref="alg1.l6.m3.1.1.5">
           𝑐
          </ci>
          <ci id="alg1.l6.m3.1.1.6.cmml" xref="alg1.l6.m3.1.1.6">
           ℎ
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m3.1c">
         epoch
        </annotation>
       </semantics>
      </math>
      is even,
      <math alttext="\pi^{p}_{\theta}" class="ltx_Math" display="inline" id="alg1.l6.m4.1">
       <semantics id="alg1.l6.m4.1a">
        <msubsup id="alg1.l6.m4.1.1" xref="alg1.l6.m4.1.1.cmml">
         <mi id="alg1.l6.m4.1.1.2.2" xref="alg1.l6.m4.1.1.2.2.cmml">
          π
         </mi>
         <mi id="alg1.l6.m4.1.1.3" xref="alg1.l6.m4.1.1.3.cmml">
          θ
         </mi>
         <mi id="alg1.l6.m4.1.1.2.3" xref="alg1.l6.m4.1.1.2.3.cmml">
          p
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m4.1b">
         <apply id="alg1.l6.m4.1.1.cmml" xref="alg1.l6.m4.1.1">
          <csymbol cd="ambiguous" id="alg1.l6.m4.1.1.1.cmml" xref="alg1.l6.m4.1.1">
           subscript
          </csymbol>
          <apply id="alg1.l6.m4.1.1.2.cmml" xref="alg1.l6.m4.1.1">
           <csymbol cd="ambiguous" id="alg1.l6.m4.1.1.2.1.cmml" xref="alg1.l6.m4.1.1">
            superscript
           </csymbol>
           <ci id="alg1.l6.m4.1.1.2.2.cmml" xref="alg1.l6.m4.1.1.2.2">
            𝜋
           </ci>
           <ci id="alg1.l6.m4.1.1.2.3.cmml" xref="alg1.l6.m4.1.1.2.3">
            𝑝
           </ci>
          </apply>
          <ci id="alg1.l6.m4.1.1.3.cmml" xref="alg1.l6.m4.1.1.3">
           𝜃
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m4.1c">
         \pi^{p}_{\theta}
        </annotation>
       </semantics>
      </math>
      otherwise
      <span class="ltx_text" id="alg1.l6.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1">
        <semantics id="alg1.l6.1.m1.1a">
         <mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">
          ▷
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b">
          <ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">
           ▷
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       update the selected policy only, fix the other
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l7">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">
        7:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l7.2">
       for
      </span>
      <math alttext="p_{i}\in P_{train}" class="ltx_Math" display="inline" id="alg1.l7.m1.1">
       <semantics id="alg1.l7.m1.1a">
        <mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">
         <msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">
          <mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">
           p
          </mi>
          <mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">
           i
          </mi>
         </msub>
         <mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">
          ∈
         </mo>
         <msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">
          <mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">
           P
          </mi>
          <mrow id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">
           <mi id="alg1.l7.m1.1.1.3.3.2" xref="alg1.l7.m1.1.1.3.3.2.cmml">
            t
           </mi>
           <mo id="alg1.l7.m1.1.1.3.3.1" lspace="0em" rspace="0em" xref="alg1.l7.m1.1.1.3.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l7.m1.1.1.3.3.3" xref="alg1.l7.m1.1.1.3.3.3.cmml">
            r
           </mi>
           <mo id="alg1.l7.m1.1.1.3.3.1a" lspace="0em" rspace="0em" xref="alg1.l7.m1.1.1.3.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l7.m1.1.1.3.3.4" xref="alg1.l7.m1.1.1.3.3.4.cmml">
            a
           </mi>
           <mo id="alg1.l7.m1.1.1.3.3.1b" lspace="0em" rspace="0em" xref="alg1.l7.m1.1.1.3.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l7.m1.1.1.3.3.5" xref="alg1.l7.m1.1.1.3.3.5.cmml">
            i
           </mi>
           <mo id="alg1.l7.m1.1.1.3.3.1c" lspace="0em" rspace="0em" xref="alg1.l7.m1.1.1.3.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l7.m1.1.1.3.3.6" xref="alg1.l7.m1.1.1.3.3.6.cmml">
            n
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b">
         <apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">
          <in id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">
          </in>
          <apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">
            subscript
           </csymbol>
           <ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">
            𝑝
           </ci>
           <ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">
            subscript
           </csymbol>
           <ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">
            𝑃
           </ci>
           <apply id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">
            <times id="alg1.l7.m1.1.1.3.3.1.cmml" xref="alg1.l7.m1.1.1.3.3.1">
            </times>
            <ci id="alg1.l7.m1.1.1.3.3.2.cmml" xref="alg1.l7.m1.1.1.3.3.2">
             𝑡
            </ci>
            <ci id="alg1.l7.m1.1.1.3.3.3.cmml" xref="alg1.l7.m1.1.1.3.3.3">
             𝑟
            </ci>
            <ci id="alg1.l7.m1.1.1.3.3.4.cmml" xref="alg1.l7.m1.1.1.3.3.4">
             𝑎
            </ci>
            <ci id="alg1.l7.m1.1.1.3.3.5.cmml" xref="alg1.l7.m1.1.1.3.3.5">
             𝑖
            </ci>
            <ci id="alg1.l7.m1.1.1.3.3.6.cmml" xref="alg1.l7.m1.1.1.3.3.6">
             𝑛
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l7.m1.1c">
         p_{i}\in P_{train}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l7.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l8">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l8.4.1.1" style="font-size:80%;">
        8:
       </span>
      </span>
      <math alttext="r_{i}\leftarrow reward(\textrm{ToTSystem}(p_{i}))" class="ltx_Math" display="inline" id="alg1.l8.m1.1">
       <semantics id="alg1.l8.m1.1a">
        <mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">
         <msub id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">
          <mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">
           r
          </mi>
          <mi id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml">
           i
          </mi>
         </msub>
         <mo id="alg1.l8.m1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">
          <mi id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.3.cmml">
           r
          </mi>
          <mo id="alg1.l8.m1.1.1.1.2" lspace="0em" rspace="0em" xref="alg1.l8.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mi id="alg1.l8.m1.1.1.1.4" xref="alg1.l8.m1.1.1.1.4.cmml">
           e
          </mi>
          <mo id="alg1.l8.m1.1.1.1.2a" lspace="0em" rspace="0em" xref="alg1.l8.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mi id="alg1.l8.m1.1.1.1.5" xref="alg1.l8.m1.1.1.1.5.cmml">
           w
          </mi>
          <mo id="alg1.l8.m1.1.1.1.2b" lspace="0em" rspace="0em" xref="alg1.l8.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mi id="alg1.l8.m1.1.1.1.6" xref="alg1.l8.m1.1.1.1.6.cmml">
           a
          </mi>
          <mo id="alg1.l8.m1.1.1.1.2c" lspace="0em" rspace="0em" xref="alg1.l8.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mi id="alg1.l8.m1.1.1.1.7" xref="alg1.l8.m1.1.1.1.7.cmml">
           r
          </mi>
          <mo id="alg1.l8.m1.1.1.1.2d" lspace="0em" rspace="0em" xref="alg1.l8.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mi id="alg1.l8.m1.1.1.1.8" xref="alg1.l8.m1.1.1.1.8.cmml">
           d
          </mi>
          <mo id="alg1.l8.m1.1.1.1.2e" lspace="0em" rspace="0em" xref="alg1.l8.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">
           <mo id="alg1.l8.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">
            <mtext id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.3a.cmml">
             ToTSystem
            </mtext>
            <mo id="alg1.l8.m1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="alg1.l8.m1.1.1.1.1.1.1.2.cmml">
             ​
            </mo>
            <mrow id="alg1.l8.m1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">
             <mo id="alg1.l8.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">
              (
             </mo>
             <msub id="alg1.l8.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">
              <mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml">
               p
              </mi>
              <mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml">
               i
              </mi>
             </msub>
             <mo id="alg1.l8.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="alg1.l8.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b">
         <apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">
          <ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">
           ←
          </ci>
          <apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3">
            subscript
           </csymbol>
           <ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">
            𝑟
           </ci>
           <ci id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">
           <times id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.2">
           </times>
           <ci id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.3">
            𝑟
           </ci>
           <ci id="alg1.l8.m1.1.1.1.4.cmml" xref="alg1.l8.m1.1.1.1.4">
            𝑒
           </ci>
           <ci id="alg1.l8.m1.1.1.1.5.cmml" xref="alg1.l8.m1.1.1.1.5">
            𝑤
           </ci>
           <ci id="alg1.l8.m1.1.1.1.6.cmml" xref="alg1.l8.m1.1.1.1.6">
            𝑎
           </ci>
           <ci id="alg1.l8.m1.1.1.1.7.cmml" xref="alg1.l8.m1.1.1.1.7">
            𝑟
           </ci>
           <ci id="alg1.l8.m1.1.1.1.8.cmml" xref="alg1.l8.m1.1.1.1.8">
            𝑑
           </ci>
           <apply id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">
            <times id="alg1.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2">
            </times>
            <ci id="alg1.l8.m1.1.1.1.1.1.1.3a.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3">
             <mtext id="alg1.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3">
              ToTSystem
             </mtext>
            </ci>
            <apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2">
              𝑝
             </ci>
             <ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3">
              𝑖
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l8.m1.1c">
         r_{i}\leftarrow reward(\textrm{ToTSystem}(p_{i}))
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text" id="alg1.l8.3" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l8.1.m1.1">
        <semantics id="alg1.l8.1.m1.1a">
         <mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">
          ▷
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b">
          <ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">
           ▷
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       attempt to solve problem
       <math alttext="p_{i}" class="ltx_Math" display="inline" id="alg1.l8.2.m2.1">
        <semantics id="alg1.l8.2.m2.1a">
         <msub id="alg1.l8.2.m2.1.1" xref="alg1.l8.2.m2.1.1.cmml">
          <mi id="alg1.l8.2.m2.1.1.2" xref="alg1.l8.2.m2.1.1.2.cmml">
           p
          </mi>
          <mi id="alg1.l8.2.m2.1.1.3" xref="alg1.l8.2.m2.1.1.3.cmml">
           i
          </mi>
         </msub>
         <annotation-xml encoding="MathML-Content" id="alg1.l8.2.m2.1b">
          <apply id="alg1.l8.2.m2.1.1.cmml" xref="alg1.l8.2.m2.1.1">
           <csymbol cd="ambiguous" id="alg1.l8.2.m2.1.1.1.cmml" xref="alg1.l8.2.m2.1.1">
            subscript
           </csymbol>
           <ci id="alg1.l8.2.m2.1.1.2.cmml" xref="alg1.l8.2.m2.1.1.2">
            𝑝
           </ci>
           <ci id="alg1.l8.2.m2.1.1.3.cmml" xref="alg1.l8.2.m2.1.1.3">
            𝑖
           </ci>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l8.2.m2.1c">
          p_{i}
         </annotation>
        </semantics>
       </math>
       and obtain reward
       <math alttext="r_{i}" class="ltx_Math" display="inline" id="alg1.l8.3.m3.1">
        <semantics id="alg1.l8.3.m3.1a">
         <msub id="alg1.l8.3.m3.1.1" xref="alg1.l8.3.m3.1.1.cmml">
          <mi id="alg1.l8.3.m3.1.1.2" xref="alg1.l8.3.m3.1.1.2.cmml">
           r
          </mi>
          <mi id="alg1.l8.3.m3.1.1.3" xref="alg1.l8.3.m3.1.1.3.cmml">
           i
          </mi>
         </msub>
         <annotation-xml encoding="MathML-Content" id="alg1.l8.3.m3.1b">
          <apply id="alg1.l8.3.m3.1.1.cmml" xref="alg1.l8.3.m3.1.1">
           <csymbol cd="ambiguous" id="alg1.l8.3.m3.1.1.1.cmml" xref="alg1.l8.3.m3.1.1">
            subscript
           </csymbol>
           <ci id="alg1.l8.3.m3.1.1.2.cmml" xref="alg1.l8.3.m3.1.1.2">
            𝑟
           </ci>
           <ci id="alg1.l8.3.m3.1.1.3.cmml" xref="alg1.l8.3.m3.1.1.3">
            𝑖
           </ci>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l8.3.m3.1c">
          r_{i}
         </annotation>
        </semantics>
       </math>
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l9">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">
        9:
       </span>
      </span>
      <math alttext="w\leftarrow w+\alpha\nabla_{w}\textrm{log}\pi_{w}r_{i}" class="ltx_Math" display="inline" id="alg1.l9.m1.1">
       <semantics id="alg1.l9.m1.1a">
        <mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">
         <mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">
          w
         </mi>
         <mo id="alg1.l9.m1.1.1.1" stretchy="false" xref="alg1.l9.m1.1.1.1.cmml">
          ←
         </mo>
         <mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">
          <mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">
           w
          </mi>
          <mo id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml">
           +
          </mo>
          <mrow id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">
           <mi id="alg1.l9.m1.1.1.3.3.2" xref="alg1.l9.m1.1.1.3.3.2.cmml">
            α
           </mi>
           <mo id="alg1.l9.m1.1.1.3.3.1" lspace="0.167em" rspace="0em" xref="alg1.l9.m1.1.1.3.3.1.cmml">
            ​
           </mo>
           <mrow id="alg1.l9.m1.1.1.3.3.3" xref="alg1.l9.m1.1.1.3.3.3.cmml">
            <msub id="alg1.l9.m1.1.1.3.3.3.1" xref="alg1.l9.m1.1.1.3.3.3.1.cmml">
             <mo id="alg1.l9.m1.1.1.3.3.3.1.2" rspace="0.167em" xref="alg1.l9.m1.1.1.3.3.3.1.2.cmml">
              ∇
             </mo>
             <mi id="alg1.l9.m1.1.1.3.3.3.1.3" xref="alg1.l9.m1.1.1.3.3.3.1.3.cmml">
              w
             </mi>
            </msub>
            <mrow id="alg1.l9.m1.1.1.3.3.3.2" xref="alg1.l9.m1.1.1.3.3.3.2.cmml">
             <mtext id="alg1.l9.m1.1.1.3.3.3.2.2" xref="alg1.l9.m1.1.1.3.3.3.2.2a.cmml">
              log
             </mtext>
             <mo id="alg1.l9.m1.1.1.3.3.3.2.1" lspace="0em" rspace="0em" xref="alg1.l9.m1.1.1.3.3.3.2.1.cmml">
              ​
             </mo>
             <msub id="alg1.l9.m1.1.1.3.3.3.2.3" xref="alg1.l9.m1.1.1.3.3.3.2.3.cmml">
              <mi id="alg1.l9.m1.1.1.3.3.3.2.3.2" xref="alg1.l9.m1.1.1.3.3.3.2.3.2.cmml">
               π
              </mi>
              <mi id="alg1.l9.m1.1.1.3.3.3.2.3.3" xref="alg1.l9.m1.1.1.3.3.3.2.3.3.cmml">
               w
              </mi>
             </msub>
             <mo id="alg1.l9.m1.1.1.3.3.3.2.1a" lspace="0em" rspace="0em" xref="alg1.l9.m1.1.1.3.3.3.2.1.cmml">
              ​
             </mo>
             <msub id="alg1.l9.m1.1.1.3.3.3.2.4" xref="alg1.l9.m1.1.1.3.3.3.2.4.cmml">
              <mi id="alg1.l9.m1.1.1.3.3.3.2.4.2" xref="alg1.l9.m1.1.1.3.3.3.2.4.2.cmml">
               r
              </mi>
              <mi id="alg1.l9.m1.1.1.3.3.3.2.4.3" xref="alg1.l9.m1.1.1.3.3.3.2.4.3.cmml">
               i
              </mi>
             </msub>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b">
         <apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">
          <ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">
           ←
          </ci>
          <ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">
           𝑤
          </ci>
          <apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">
           <plus id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1">
           </plus>
           <ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">
            𝑤
           </ci>
           <apply id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">
            <times id="alg1.l9.m1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.1">
            </times>
            <ci id="alg1.l9.m1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.2">
             𝛼
            </ci>
            <apply id="alg1.l9.m1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.3">
             <apply id="alg1.l9.m1.1.1.3.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.3.1">
              <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.3.1.1.cmml" xref="alg1.l9.m1.1.1.3.3.3.1">
               subscript
              </csymbol>
              <ci id="alg1.l9.m1.1.1.3.3.3.1.2.cmml" xref="alg1.l9.m1.1.1.3.3.3.1.2">
               ∇
              </ci>
              <ci id="alg1.l9.m1.1.1.3.3.3.1.3.cmml" xref="alg1.l9.m1.1.1.3.3.3.1.3">
               𝑤
              </ci>
             </apply>
             <apply id="alg1.l9.m1.1.1.3.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.3.2">
              <times id="alg1.l9.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.1">
              </times>
              <ci id="alg1.l9.m1.1.1.3.3.3.2.2a.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.2">
               <mtext id="alg1.l9.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.2">
                log
               </mtext>
              </ci>
              <apply id="alg1.l9.m1.1.1.3.3.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.3">
               <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.3.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.3">
                subscript
               </csymbol>
               <ci id="alg1.l9.m1.1.1.3.3.3.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.3.2">
                𝜋
               </ci>
               <ci id="alg1.l9.m1.1.1.3.3.3.2.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.3.3">
                𝑤
               </ci>
              </apply>
              <apply id="alg1.l9.m1.1.1.3.3.3.2.4.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.4">
               <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.3.2.4.1.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.4">
                subscript
               </csymbol>
               <ci id="alg1.l9.m1.1.1.3.3.3.2.4.2.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.4.2">
                𝑟
               </ci>
               <ci id="alg1.l9.m1.1.1.3.3.3.2.4.3.cmml" xref="alg1.l9.m1.1.1.3.3.3.2.4.3">
                𝑖
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l9.m1.1c">
         w\leftarrow w+\alpha\nabla_{w}\textrm{log}\pi_{w}r_{i}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l10">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">
        10:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l10.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l10.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l11">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">
        11:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l11.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l11.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l12">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">
        12:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.3">
       procedure
      </span>
     </div>
    </div>
   </figure>
   <div class="ltx_para" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.1">
     In the previous sections, we have described the multi-agent ToT framework. This section dives into how we can train the agents, in particular, the policy networks of the ToT controller and the prompter agent. While there are many multi-agent reinforcement learning algorithms (MARL) proposed in the literature
     <cite class="ltx_cite ltx_citemacro_cite">
      <a class="ltx_ref" href="#bib.bib29" title="">
       <span class="ltx_text" style="font-size:80%;">
        nguyen2020marlreview
       </span>
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib30" title="">
       <span class="ltx_text" style="font-size:80%;">
        oroojlooyjadid2021review
       </span>
      </a>
      ;
      <a class="ltx_ref" href="#bib.bib31" title="">
       <span class="ltx_text" style="font-size:80%;">
        zhang2021multiagent
       </span>
      </a>
     </cite>
     , in this work we adopt a relatively simple approach which uses a modified version of the REINFORCE algorithm
     <cite class="ltx_cite ltx_citemacro_cite">
      <a class="ltx_ref" href="#bib.bib32" title="">
       <span class="ltx_text" style="font-size:80%;">
        sutton1999policygradient
       </span>
      </a>
     </cite>
     to train the policy networks of the ToT controller and the prompter agent directly. The more advanced MARL algorithms will be explored in the future.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.3">
     First, we define a run of the ToT system as the process where a user inputs the problem description, and the ToT system attempts to solve the problem until it thinks the problem is solved, or a pre-specified maximum round of conversations is reached. Next, we define the reward
     <math alttext="r" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1">
      <semantics id="S3.SS3.p2.1.m1.1a">
       <mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">
        r
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b">
        <ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">
         𝑟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">
        r
       </annotation>
      </semantics>
     </math>
     of a run: if the problem is correctly solved, then
     <math alttext="r=+1" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1">
      <semantics id="S3.SS3.p2.2.m2.1a">
       <mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">
        <mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">
         r
        </mi>
        <mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">
         =
        </mo>
        <mrow id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">
         <mo id="S3.SS3.p2.2.m2.1.1.3a" xref="S3.SS3.p2.2.m2.1.1.3.cmml">
          +
         </mo>
         <mn id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">
          1
         </mn>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b">
        <apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">
         <eq id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1">
         </eq>
         <ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">
          𝑟
         </ci>
         <apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">
          <plus id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3">
          </plus>
          <cn id="S3.SS3.p2.2.m2.1.1.3.2.cmml" type="integer" xref="S3.SS3.p2.2.m2.1.1.3.2">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">
        r=+1
       </annotation>
      </semantics>
     </math>
     . Otherwise, if the system outputs an incorrect solution, or the maximum round of conversations is reached, then
     <math alttext="r=-1" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1">
      <semantics id="S3.SS3.p2.3.m3.1a">
       <mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">
        <mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">
         r
        </mi>
        <mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">
         =
        </mo>
        <mrow id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">
         <mo id="S3.SS3.p2.3.m3.1.1.3a" xref="S3.SS3.p2.3.m3.1.1.3.cmml">
          −
         </mo>
         <mn id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">
          1
         </mn>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b">
        <apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">
         <eq id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1">
         </eq>
         <ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">
          𝑟
         </ci>
         <apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">
          <minus id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3">
          </minus>
          <cn id="S3.SS3.p2.3.m3.1.1.3.2.cmml" type="integer" xref="S3.SS3.p2.3.m3.1.1.3.2">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">
        r=-1
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS3.p3">
    <p class="ltx_p" id="S3.SS3.p3.8">
     The training algorithm is provided in Algorithm
     <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 3.3 ToT System Training ‣ 3 Architecture ‣ Large Language Model Guided Tree-of-Thought">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     . The algorithm takes two inputs, the training data set
     <math alttext="P_{train}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1">
      <semantics id="S3.SS3.p3.1.m1.1a">
       <msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">
        <mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">
         P
        </mi>
        <mrow id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">
         <mi id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml">
          t
         </mi>
         <mo id="S3.SS3.p3.1.m1.1.1.3.1" lspace="0em" rspace="0em" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">
          r
         </mi>
         <mo id="S3.SS3.p3.1.m1.1.1.3.1a" lspace="0em" rspace="0em" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS3.p3.1.m1.1.1.3.4" xref="S3.SS3.p3.1.m1.1.1.3.4.cmml">
          a
         </mi>
         <mo id="S3.SS3.p3.1.m1.1.1.3.1b" lspace="0em" rspace="0em" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS3.p3.1.m1.1.1.3.5" xref="S3.SS3.p3.1.m1.1.1.3.5.cmml">
          i
         </mi>
         <mo id="S3.SS3.p3.1.m1.1.1.3.1c" lspace="0em" rspace="0em" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S3.SS3.p3.1.m1.1.1.3.6" xref="S3.SS3.p3.1.m1.1.1.3.6.cmml">
          n
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b">
        <apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">
          𝑃
         </ci>
         <apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">
          <times id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3.1">
          </times>
          <ci id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2">
           𝑡
          </ci>
          <ci id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3">
           𝑟
          </ci>
          <ci id="S3.SS3.p3.1.m1.1.1.3.4.cmml" xref="S3.SS3.p3.1.m1.1.1.3.4">
           𝑎
          </ci>
          <ci id="S3.SS3.p3.1.m1.1.1.3.5.cmml" xref="S3.SS3.p3.1.m1.1.1.3.5">
           𝑖
          </ci>
          <ci id="S3.SS3.p3.1.m1.1.1.3.6.cmml" xref="S3.SS3.p3.1.m1.1.1.3.6">
           𝑛
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">
        P_{train}
       </annotation>
      </semantics>
     </math>
     , and the number of training epochs
     <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1">
      <semantics id="S3.SS3.p3.2.m2.1a">
       <mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b">
        <ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">
        N
       </annotation>
      </semantics>
     </math>
     (Line 1-2). The two policy networks
     <math alttext="\pi^{t}_{\rho}(a_{i}|s_{i},..,s_{i-k})" class="ltx_math_unparsed" display="inline" id="S3.SS3.p3.3.m3.1">
      <semantics id="S3.SS3.p3.3.m3.1a">
       <mrow id="S3.SS3.p3.3.m3.1b">
        <msubsup id="S3.SS3.p3.3.m3.1.1">
         <mi id="S3.SS3.p3.3.m3.1.1.2.2">
          π
         </mi>
         <mi id="S3.SS3.p3.3.m3.1.1.3">
          ρ
         </mi>
         <mi id="S3.SS3.p3.3.m3.1.1.2.3">
          t
         </mi>
        </msubsup>
        <mrow id="S3.SS3.p3.3.m3.1.2">
         <mo id="S3.SS3.p3.3.m3.1.2.1" stretchy="false">
          (
         </mo>
         <msub id="S3.SS3.p3.3.m3.1.2.2">
          <mi id="S3.SS3.p3.3.m3.1.2.2.2">
           a
          </mi>
          <mi id="S3.SS3.p3.3.m3.1.2.2.3">
           i
          </mi>
         </msub>
         <mo fence="false" id="S3.SS3.p3.3.m3.1.2.3" rspace="0.167em" stretchy="false">
          |
         </mo>
         <msub id="S3.SS3.p3.3.m3.1.2.4">
          <mi id="S3.SS3.p3.3.m3.1.2.4.2">
           s
          </mi>
          <mi id="S3.SS3.p3.3.m3.1.2.4.3">
           i
          </mi>
         </msub>
         <mo id="S3.SS3.p3.3.m3.1.2.5">
          ,
         </mo>
         <mo id="S3.SS3.p3.3.m3.1.2.6" lspace="0em" rspace="0.0835em">
          .
         </mo>
         <mo id="S3.SS3.p3.3.m3.1.2.7" lspace="0.0835em" rspace="0.167em">
          .
         </mo>
         <mo id="S3.SS3.p3.3.m3.1.2.8">
          ,
         </mo>
         <msub id="S3.SS3.p3.3.m3.1.2.9">
          <mi id="S3.SS3.p3.3.m3.1.2.9.2">
           s
          </mi>
          <mrow id="S3.SS3.p3.3.m3.1.2.9.3">
           <mi id="S3.SS3.p3.3.m3.1.2.9.3.2">
            i
           </mi>
           <mo id="S3.SS3.p3.3.m3.1.2.9.3.1">
            −
           </mo>
           <mi id="S3.SS3.p3.3.m3.1.2.9.3.3">
            k
           </mi>
          </mrow>
         </msub>
         <mo id="S3.SS3.p3.3.m3.1.2.10" stretchy="false">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">
        \pi^{t}_{\rho}(a_{i}|s_{i},..,s_{i-k})
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\pi^{p}_{\theta}(e_{i}|s_{i},..,s_{i-k})" class="ltx_math_unparsed" display="inline" id="S3.SS3.p3.4.m4.1">
      <semantics id="S3.SS3.p3.4.m4.1a">
       <mrow id="S3.SS3.p3.4.m4.1b">
        <msubsup id="S3.SS3.p3.4.m4.1.1">
         <mi id="S3.SS3.p3.4.m4.1.1.2.2">
          π
         </mi>
         <mi id="S3.SS3.p3.4.m4.1.1.3">
          θ
         </mi>
         <mi id="S3.SS3.p3.4.m4.1.1.2.3">
          p
         </mi>
        </msubsup>
        <mrow id="S3.SS3.p3.4.m4.1.2">
         <mo id="S3.SS3.p3.4.m4.1.2.1" stretchy="false">
          (
         </mo>
         <msub id="S3.SS3.p3.4.m4.1.2.2">
          <mi id="S3.SS3.p3.4.m4.1.2.2.2">
           e
          </mi>
          <mi id="S3.SS3.p3.4.m4.1.2.2.3">
           i
          </mi>
         </msub>
         <mo fence="false" id="S3.SS3.p3.4.m4.1.2.3" rspace="0.167em" stretchy="false">
          |
         </mo>
         <msub id="S3.SS3.p3.4.m4.1.2.4">
          <mi id="S3.SS3.p3.4.m4.1.2.4.2">
           s
          </mi>
          <mi id="S3.SS3.p3.4.m4.1.2.4.3">
           i
          </mi>
         </msub>
         <mo id="S3.SS3.p3.4.m4.1.2.5">
          ,
         </mo>
         <mo id="S3.SS3.p3.4.m4.1.2.6" lspace="0em" rspace="0.0835em">
          .
         </mo>
         <mo id="S3.SS3.p3.4.m4.1.2.7" lspace="0.0835em" rspace="0.167em">
          .
         </mo>
         <mo id="S3.SS3.p3.4.m4.1.2.8">
          ,
         </mo>
         <msub id="S3.SS3.p3.4.m4.1.2.9">
          <mi id="S3.SS3.p3.4.m4.1.2.9.2">
           s
          </mi>
          <mrow id="S3.SS3.p3.4.m4.1.2.9.3">
           <mi id="S3.SS3.p3.4.m4.1.2.9.3.2">
            i
           </mi>
           <mo id="S3.SS3.p3.4.m4.1.2.9.3.1">
            −
           </mo>
           <mi id="S3.SS3.p3.4.m4.1.2.9.3.3">
            k
           </mi>
          </mrow>
         </msub>
         <mo id="S3.SS3.p3.4.m4.1.2.10" stretchy="false">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">
        \pi^{p}_{\theta}(e_{i}|s_{i},..,s_{i-k})
       </annotation>
      </semantics>
     </math>
     are randomly initialized (Line 3-4). We train the two policy networks in turns, i.e. training one network with policy gradient while keeping the other fixed (Line 6). To be more specific, when the current
     <math alttext="epoch" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.1">
      <semantics id="S3.SS3.p3.5.m5.1a">
       <mrow id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">
        <mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">
         e
        </mi>
        <mo id="S3.SS3.p3.5.m5.1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p3.5.m5.1.1.1.cmml">
         ​
        </mo>
        <mi id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">
         p
        </mi>
        <mo id="S3.SS3.p3.5.m5.1.1.1a" lspace="0em" rspace="0em" xref="S3.SS3.p3.5.m5.1.1.1.cmml">
         ​
        </mo>
        <mi id="S3.SS3.p3.5.m5.1.1.4" xref="S3.SS3.p3.5.m5.1.1.4.cmml">
         o
        </mi>
        <mo id="S3.SS3.p3.5.m5.1.1.1b" lspace="0em" rspace="0em" xref="S3.SS3.p3.5.m5.1.1.1.cmml">
         ​
        </mo>
        <mi id="S3.SS3.p3.5.m5.1.1.5" xref="S3.SS3.p3.5.m5.1.1.5.cmml">
         c
        </mi>
        <mo id="S3.SS3.p3.5.m5.1.1.1c" lspace="0em" rspace="0em" xref="S3.SS3.p3.5.m5.1.1.1.cmml">
         ​
        </mo>
        <mi id="S3.SS3.p3.5.m5.1.1.6" xref="S3.SS3.p3.5.m5.1.1.6.cmml">
         h
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b">
        <apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">
         <times id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1">
         </times>
         <ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">
          𝑒
         </ci>
         <ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">
          𝑝
         </ci>
         <ci id="S3.SS3.p3.5.m5.1.1.4.cmml" xref="S3.SS3.p3.5.m5.1.1.4">
          𝑜
         </ci>
         <ci id="S3.SS3.p3.5.m5.1.1.5.cmml" xref="S3.SS3.p3.5.m5.1.1.5">
          𝑐
         </ci>
         <ci id="S3.SS3.p3.5.m5.1.1.6.cmml" xref="S3.SS3.p3.5.m5.1.1.6">
          ℎ
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">
        epoch
       </annotation>
      </semantics>
     </math>
     is an even number, we select the ToT controller policy
     <math alttext="\pi^{t}_{\rho}" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m6.1">
      <semantics id="S3.SS3.p3.6.m6.1a">
       <msubsup id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml">
        <mi id="S3.SS3.p3.6.m6.1.1.2.2" xref="S3.SS3.p3.6.m6.1.1.2.2.cmml">
         π
        </mi>
        <mi id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">
         ρ
        </mi>
        <mi id="S3.SS3.p3.6.m6.1.1.2.3" xref="S3.SS3.p3.6.m6.1.1.2.3.cmml">
         t
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b">
        <apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1">
           superscript
          </csymbol>
          <ci id="S3.SS3.p3.6.m6.1.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.2">
           𝜋
          </ci>
          <ci id="S3.SS3.p3.6.m6.1.1.2.3.cmml" xref="S3.SS3.p3.6.m6.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">
          𝜌
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">
        \pi^{t}_{\rho}
       </annotation>
      </semantics>
     </math>
     , and keep the parameters of the prompter agent fixed. Otherwise, we select the prompter agent policy
     <math alttext="\pi^{p}_{\theta}" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m7.1">
      <semantics id="S3.SS3.p3.7.m7.1a">
       <msubsup id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">
        <mi id="S3.SS3.p3.7.m7.1.1.2.2" xref="S3.SS3.p3.7.m7.1.1.2.2.cmml">
         π
        </mi>
        <mi id="S3.SS3.p3.7.m7.1.1.3" xref="S3.SS3.p3.7.m7.1.1.3.cmml">
         θ
        </mi>
        <mi id="S3.SS3.p3.7.m7.1.1.2.3" xref="S3.SS3.p3.7.m7.1.1.2.3.cmml">
         p
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b">
        <apply id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS3.p3.7.m7.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.2.1.cmml" xref="S3.SS3.p3.7.m7.1.1">
           superscript
          </csymbol>
          <ci id="S3.SS3.p3.7.m7.1.1.2.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2.2">
           𝜋
          </ci>
          <ci id="S3.SS3.p3.7.m7.1.1.2.3.cmml" xref="S3.SS3.p3.7.m7.1.1.2.3">
           𝑝
          </ci>
         </apply>
         <ci id="S3.SS3.p3.7.m7.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">
        \pi^{p}_{\theta}
       </annotation>
      </semantics>
     </math>
     and fix the ToT controller policy. Next, the algorithm updates the parameters of the selected policy network using the policy gradient method (Line 7-9). For each problem in the training data, we attempt to solve it with a ToT system run. Based on the result, we obtain the reward for that run (Line 8). The entire training algorithm runs for
     <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m8.1">
      <semantics id="S3.SS3.p3.8.m8.1a">
       <mi id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b">
        <ci id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">
        N
       </annotation>
      </semantics>
     </math>
     epochs.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.4
    </span>
    Problem Solving Using the ToT System
   </h3>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg2.2.1.1">
       Algorithm 2
      </span>
     </span>
     Problem Solving Using the ToT System
    </figcaption>
    <div class="ltx_listing ltx_listing" id="alg2.3">
     <div class="ltx_listingline" id="alg2.l1">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">
        1:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l1.2">
       Input:
      </span>
      problem description from the user
      <math alttext="p_{user}" class="ltx_Math" display="inline" id="alg2.l1.m1.1">
       <semantics id="alg2.l1.m1.1a">
        <msub id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">
         <mi id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">
          p
         </mi>
         <mrow id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">
          <mi id="alg2.l1.m1.1.1.3.2" xref="alg2.l1.m1.1.1.3.2.cmml">
           u
          </mi>
          <mo id="alg2.l1.m1.1.1.3.1" lspace="0em" rspace="0em" xref="alg2.l1.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l1.m1.1.1.3.3" xref="alg2.l1.m1.1.1.3.3.cmml">
           s
          </mi>
          <mo id="alg2.l1.m1.1.1.3.1a" lspace="0em" rspace="0em" xref="alg2.l1.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l1.m1.1.1.3.4" xref="alg2.l1.m1.1.1.3.4.cmml">
           e
          </mi>
          <mo id="alg2.l1.m1.1.1.3.1b" lspace="0em" rspace="0em" xref="alg2.l1.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l1.m1.1.1.3.5" xref="alg2.l1.m1.1.1.3.5.cmml">
           r
          </mi>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b">
         <apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">
          <csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">
           𝑝
          </ci>
          <apply id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">
           <times id="alg2.l1.m1.1.1.3.1.cmml" xref="alg2.l1.m1.1.1.3.1">
           </times>
           <ci id="alg2.l1.m1.1.1.3.2.cmml" xref="alg2.l1.m1.1.1.3.2">
            𝑢
           </ci>
           <ci id="alg2.l1.m1.1.1.3.3.cmml" xref="alg2.l1.m1.1.1.3.3">
            𝑠
           </ci>
           <ci id="alg2.l1.m1.1.1.3.4.cmml" xref="alg2.l1.m1.1.1.3.4">
            𝑒
           </ci>
           <ci id="alg2.l1.m1.1.1.3.5.cmml" xref="alg2.l1.m1.1.1.3.5">
            𝑟
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l1.m1.1c">
         p_{user}
        </annotation>
       </semantics>
      </math>
      , max num of conversation rounds
      <math alttext="K" class="ltx_Math" display="inline" id="alg2.l1.m2.1">
       <semantics id="alg2.l1.m2.1a">
        <mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">
         K
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b">
         <ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">
          𝐾
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l1.m2.1c">
         K
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg2.l2">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">
        2:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l2.2">
       procedure
      </span>
      <span class="ltx_text ltx_font_smallcaps" id="alg2.l2.3">
       SOLVE
      </span>
      (
      <math alttext="p_{user}" class="ltx_Math" display="inline" id="alg2.l2.m1.1">
       <semantics id="alg2.l2.m1.1a">
        <msub id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">
         <mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">
          p
         </mi>
         <mrow id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">
          <mi id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">
           u
          </mi>
          <mo id="alg2.l2.m1.1.1.3.1" lspace="0em" rspace="0em" xref="alg2.l2.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml">
           s
          </mi>
          <mo id="alg2.l2.m1.1.1.3.1a" lspace="0em" rspace="0em" xref="alg2.l2.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l2.m1.1.1.3.4" xref="alg2.l2.m1.1.1.3.4.cmml">
           e
          </mi>
          <mo id="alg2.l2.m1.1.1.3.1b" lspace="0em" rspace="0em" xref="alg2.l2.m1.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l2.m1.1.1.3.5" xref="alg2.l2.m1.1.1.3.5.cmml">
           r
          </mi>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b">
         <apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">
          <csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">
           𝑝
          </ci>
          <apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">
           <times id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3.1">
           </times>
           <ci id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">
            𝑢
           </ci>
           <ci id="alg2.l2.m1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.3.3">
            𝑠
           </ci>
           <ci id="alg2.l2.m1.1.1.3.4.cmml" xref="alg2.l2.m1.1.1.3.4">
            𝑒
           </ci>
           <ci id="alg2.l2.m1.1.1.3.5.cmml" xref="alg2.l2.m1.1.1.3.5">
            𝑟
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l2.m1.1c">
         p_{user}
        </annotation>
       </semantics>
      </math>
      ,
      <math alttext="K" class="ltx_Math" display="inline" id="alg2.l2.m2.1">
       <semantics id="alg2.l2.m2.1a">
        <mi id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">
         K
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b">
         <ci id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1">
          𝐾
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l2.m2.1c">
         K
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg2.l3">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">
        3:
       </span>
      </span>
      <math alttext="prompt\leftarrow" class="ltx_Math" display="inline" id="alg2.l3.m1.1">
       <semantics id="alg2.l3.m1.1a">
        <mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">
         <mrow id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">
          <mi id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">
           p
          </mi>
          <mo id="alg2.l3.m1.1.1.2.1" lspace="0em" rspace="0em" xref="alg2.l3.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">
           r
          </mi>
          <mo id="alg2.l3.m1.1.1.2.1a" lspace="0em" rspace="0em" xref="alg2.l3.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l3.m1.1.1.2.4" xref="alg2.l3.m1.1.1.2.4.cmml">
           o
          </mi>
          <mo id="alg2.l3.m1.1.1.2.1b" lspace="0em" rspace="0em" xref="alg2.l3.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l3.m1.1.1.2.5" xref="alg2.l3.m1.1.1.2.5.cmml">
           m
          </mi>
          <mo id="alg2.l3.m1.1.1.2.1c" lspace="0em" rspace="0em" xref="alg2.l3.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l3.m1.1.1.2.6" xref="alg2.l3.m1.1.1.2.6.cmml">
           p
          </mi>
          <mo id="alg2.l3.m1.1.1.2.1d" lspace="0em" rspace="0em" xref="alg2.l3.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l3.m1.1.1.2.7" xref="alg2.l3.m1.1.1.2.7.cmml">
           t
          </mi>
         </mrow>
         <mo id="alg2.l3.m1.1.1.1" stretchy="false" xref="alg2.l3.m1.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b">
         <apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">
          <ci id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1">
           ←
          </ci>
          <apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">
           <times id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2.1">
           </times>
           <ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">
            𝑝
           </ci>
           <ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">
            𝑟
           </ci>
           <ci id="alg2.l3.m1.1.1.2.4.cmml" xref="alg2.l3.m1.1.1.2.4">
            𝑜
           </ci>
           <ci id="alg2.l3.m1.1.1.2.5.cmml" xref="alg2.l3.m1.1.1.2.5">
            𝑚
           </ci>
           <ci id="alg2.l3.m1.1.1.2.6.cmml" xref="alg2.l3.m1.1.1.2.6">
            𝑝
           </ci>
           <ci id="alg2.l3.m1.1.1.2.7.cmml" xref="alg2.l3.m1.1.1.2.7">
            𝑡
           </ci>
          </apply>
          <csymbol cd="latexml" id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">
           absent
          </csymbol>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l3.m1.1c">
         prompt\leftarrow
        </annotation>
       </semantics>
      </math>
      Prompter(
      <math alttext="p_{user}" class="ltx_Math" display="inline" id="alg2.l3.m2.1">
       <semantics id="alg2.l3.m2.1a">
        <msub id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">
         <mi id="alg2.l3.m2.1.1.2" xref="alg2.l3.m2.1.1.2.cmml">
          p
         </mi>
         <mrow id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3.cmml">
          <mi id="alg2.l3.m2.1.1.3.2" xref="alg2.l3.m2.1.1.3.2.cmml">
           u
          </mi>
          <mo id="alg2.l3.m2.1.1.3.1" lspace="0em" rspace="0em" xref="alg2.l3.m2.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l3.m2.1.1.3.3" xref="alg2.l3.m2.1.1.3.3.cmml">
           s
          </mi>
          <mo id="alg2.l3.m2.1.1.3.1a" lspace="0em" rspace="0em" xref="alg2.l3.m2.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l3.m2.1.1.3.4" xref="alg2.l3.m2.1.1.3.4.cmml">
           e
          </mi>
          <mo id="alg2.l3.m2.1.1.3.1b" lspace="0em" rspace="0em" xref="alg2.l3.m2.1.1.3.1.cmml">
           ​
          </mo>
          <mi id="alg2.l3.m2.1.1.3.5" xref="alg2.l3.m2.1.1.3.5.cmml">
           r
          </mi>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b">
         <apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">
          <csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1.2">
           𝑝
          </ci>
          <apply id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3">
           <times id="alg2.l3.m2.1.1.3.1.cmml" xref="alg2.l3.m2.1.1.3.1">
           </times>
           <ci id="alg2.l3.m2.1.1.3.2.cmml" xref="alg2.l3.m2.1.1.3.2">
            𝑢
           </ci>
           <ci id="alg2.l3.m2.1.1.3.3.cmml" xref="alg2.l3.m2.1.1.3.3">
            𝑠
           </ci>
           <ci id="alg2.l3.m2.1.1.3.4.cmml" xref="alg2.l3.m2.1.1.3.4">
            𝑒
           </ci>
           <ci id="alg2.l3.m2.1.1.3.5.cmml" xref="alg2.l3.m2.1.1.3.5">
            𝑟
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l3.m2.1c">
         p_{user}
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg2.l4">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">
        4:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l4.2">
       for
      </span>
      <math alttext="round" class="ltx_Math" display="inline" id="alg2.l4.m1.1">
       <semantics id="alg2.l4.m1.1a">
        <mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">
         <mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">
          r
         </mi>
         <mo id="alg2.l4.m1.1.1.1" lspace="0em" rspace="0em" xref="alg2.l4.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">
          o
         </mi>
         <mo id="alg2.l4.m1.1.1.1a" lspace="0em" rspace="0em" xref="alg2.l4.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l4.m1.1.1.4" xref="alg2.l4.m1.1.1.4.cmml">
          u
         </mi>
         <mo id="alg2.l4.m1.1.1.1b" lspace="0em" rspace="0em" xref="alg2.l4.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l4.m1.1.1.5" xref="alg2.l4.m1.1.1.5.cmml">
          n
         </mi>
         <mo id="alg2.l4.m1.1.1.1c" lspace="0em" rspace="0em" xref="alg2.l4.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l4.m1.1.1.6" xref="alg2.l4.m1.1.1.6.cmml">
          d
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b">
         <apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">
          <times id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">
          </times>
          <ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">
           𝑟
          </ci>
          <ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">
           𝑜
          </ci>
          <ci id="alg2.l4.m1.1.1.4.cmml" xref="alg2.l4.m1.1.1.4">
           𝑢
          </ci>
          <ci id="alg2.l4.m1.1.1.5.cmml" xref="alg2.l4.m1.1.1.5">
           𝑛
          </ci>
          <ci id="alg2.l4.m1.1.1.6.cmml" xref="alg2.l4.m1.1.1.6">
           𝑑
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l4.m1.1c">
         round
        </annotation>
       </semantics>
      </math>
      = 1, 2, ..,
      <math alttext="K" class="ltx_Math" display="inline" id="alg2.l4.m2.1">
       <semantics id="alg2.l4.m2.1a">
        <mi id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml">
         K
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b">
         <ci id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1">
          𝐾
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l4.m2.1c">
         K
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg2.l4.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l5">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">
        5:
       </span>
      </span>
      <math alttext="response\leftarrow" class="ltx_Math" display="inline" id="alg2.l5.m1.1">
       <semantics id="alg2.l5.m1.1a">
        <mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">
         <mrow id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">
          <mi id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">
           r
          </mi>
          <mo id="alg2.l5.m1.1.1.2.1" lspace="0em" rspace="0em" xref="alg2.l5.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l5.m1.1.1.2.3" xref="alg2.l5.m1.1.1.2.3.cmml">
           e
          </mi>
          <mo id="alg2.l5.m1.1.1.2.1a" lspace="0em" rspace="0em" xref="alg2.l5.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l5.m1.1.1.2.4" xref="alg2.l5.m1.1.1.2.4.cmml">
           s
          </mi>
          <mo id="alg2.l5.m1.1.1.2.1b" lspace="0em" rspace="0em" xref="alg2.l5.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l5.m1.1.1.2.5" xref="alg2.l5.m1.1.1.2.5.cmml">
           p
          </mi>
          <mo id="alg2.l5.m1.1.1.2.1c" lspace="0em" rspace="0em" xref="alg2.l5.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l5.m1.1.1.2.6" xref="alg2.l5.m1.1.1.2.6.cmml">
           o
          </mi>
          <mo id="alg2.l5.m1.1.1.2.1d" lspace="0em" rspace="0em" xref="alg2.l5.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l5.m1.1.1.2.7" xref="alg2.l5.m1.1.1.2.7.cmml">
           n
          </mi>
          <mo id="alg2.l5.m1.1.1.2.1e" lspace="0em" rspace="0em" xref="alg2.l5.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l5.m1.1.1.2.8" xref="alg2.l5.m1.1.1.2.8.cmml">
           s
          </mi>
          <mo id="alg2.l5.m1.1.1.2.1f" lspace="0em" rspace="0em" xref="alg2.l5.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l5.m1.1.1.2.9" xref="alg2.l5.m1.1.1.2.9.cmml">
           e
          </mi>
         </mrow>
         <mo id="alg2.l5.m1.1.1.1" stretchy="false" xref="alg2.l5.m1.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b">
         <apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">
          <ci id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">
           ←
          </ci>
          <apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">
           <times id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2.1">
           </times>
           <ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">
            𝑟
           </ci>
           <ci id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">
            𝑒
           </ci>
           <ci id="alg2.l5.m1.1.1.2.4.cmml" xref="alg2.l5.m1.1.1.2.4">
            𝑠
           </ci>
           <ci id="alg2.l5.m1.1.1.2.5.cmml" xref="alg2.l5.m1.1.1.2.5">
            𝑝
           </ci>
           <ci id="alg2.l5.m1.1.1.2.6.cmml" xref="alg2.l5.m1.1.1.2.6">
            𝑜
           </ci>
           <ci id="alg2.l5.m1.1.1.2.7.cmml" xref="alg2.l5.m1.1.1.2.7">
            𝑛
           </ci>
           <ci id="alg2.l5.m1.1.1.2.8.cmml" xref="alg2.l5.m1.1.1.2.8">
            𝑠
           </ci>
           <ci id="alg2.l5.m1.1.1.2.9.cmml" xref="alg2.l5.m1.1.1.2.9">
            𝑒
           </ci>
          </apply>
          <csymbol cd="latexml" id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">
           absent
          </csymbol>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l5.m1.1c">
         response\leftarrow
        </annotation>
       </semantics>
      </math>
      LLM(
      <math alttext="prompt" class="ltx_Math" display="inline" id="alg2.l5.m2.1">
       <semantics id="alg2.l5.m2.1a">
        <mrow id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">
         <mi id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">
          p
         </mi>
         <mo id="alg2.l5.m2.1.1.1" lspace="0em" rspace="0em" xref="alg2.l5.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">
          r
         </mi>
         <mo id="alg2.l5.m2.1.1.1a" lspace="0em" rspace="0em" xref="alg2.l5.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l5.m2.1.1.4" xref="alg2.l5.m2.1.1.4.cmml">
          o
         </mi>
         <mo id="alg2.l5.m2.1.1.1b" lspace="0em" rspace="0em" xref="alg2.l5.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l5.m2.1.1.5" xref="alg2.l5.m2.1.1.5.cmml">
          m
         </mi>
         <mo id="alg2.l5.m2.1.1.1c" lspace="0em" rspace="0em" xref="alg2.l5.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l5.m2.1.1.6" xref="alg2.l5.m2.1.1.6.cmml">
          p
         </mi>
         <mo id="alg2.l5.m2.1.1.1d" lspace="0em" rspace="0em" xref="alg2.l5.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l5.m2.1.1.7" xref="alg2.l5.m2.1.1.7.cmml">
          t
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b">
         <apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">
          <times id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1.1">
          </times>
          <ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">
           𝑝
          </ci>
          <ci id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3">
           𝑟
          </ci>
          <ci id="alg2.l5.m2.1.1.4.cmml" xref="alg2.l5.m2.1.1.4">
           𝑜
          </ci>
          <ci id="alg2.l5.m2.1.1.5.cmml" xref="alg2.l5.m2.1.1.5">
           𝑚
          </ci>
          <ci id="alg2.l5.m2.1.1.6.cmml" xref="alg2.l5.m2.1.1.6">
           𝑝
          </ci>
          <ci id="alg2.l5.m2.1.1.7.cmml" xref="alg2.l5.m2.1.1.7">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l5.m2.1c">
         prompt
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg2.l6">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">
        6:
       </span>
      </span>
      <math alttext="result\leftarrow" class="ltx_Math" display="inline" id="alg2.l6.m1.1">
       <semantics id="alg2.l6.m1.1a">
        <mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">
         <mrow id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">
          <mi id="alg2.l6.m1.1.1.2.2" xref="alg2.l6.m1.1.1.2.2.cmml">
           r
          </mi>
          <mo id="alg2.l6.m1.1.1.2.1" lspace="0em" rspace="0em" xref="alg2.l6.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l6.m1.1.1.2.3" xref="alg2.l6.m1.1.1.2.3.cmml">
           e
          </mi>
          <mo id="alg2.l6.m1.1.1.2.1a" lspace="0em" rspace="0em" xref="alg2.l6.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l6.m1.1.1.2.4" xref="alg2.l6.m1.1.1.2.4.cmml">
           s
          </mi>
          <mo id="alg2.l6.m1.1.1.2.1b" lspace="0em" rspace="0em" xref="alg2.l6.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l6.m1.1.1.2.5" xref="alg2.l6.m1.1.1.2.5.cmml">
           u
          </mi>
          <mo id="alg2.l6.m1.1.1.2.1c" lspace="0em" rspace="0em" xref="alg2.l6.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l6.m1.1.1.2.6" xref="alg2.l6.m1.1.1.2.6.cmml">
           l
          </mi>
          <mo id="alg2.l6.m1.1.1.2.1d" lspace="0em" rspace="0em" xref="alg2.l6.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l6.m1.1.1.2.7" xref="alg2.l6.m1.1.1.2.7.cmml">
           t
          </mi>
         </mrow>
         <mo id="alg2.l6.m1.1.1.1" stretchy="false" xref="alg2.l6.m1.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b">
         <apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">
          <ci id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">
           ←
          </ci>
          <apply id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">
           <times id="alg2.l6.m1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.2.1">
           </times>
           <ci id="alg2.l6.m1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.2.2">
            𝑟
           </ci>
           <ci id="alg2.l6.m1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.2.3">
            𝑒
           </ci>
           <ci id="alg2.l6.m1.1.1.2.4.cmml" xref="alg2.l6.m1.1.1.2.4">
            𝑠
           </ci>
           <ci id="alg2.l6.m1.1.1.2.5.cmml" xref="alg2.l6.m1.1.1.2.5">
            𝑢
           </ci>
           <ci id="alg2.l6.m1.1.1.2.6.cmml" xref="alg2.l6.m1.1.1.2.6">
            𝑙
           </ci>
           <ci id="alg2.l6.m1.1.1.2.7.cmml" xref="alg2.l6.m1.1.1.2.7">
            𝑡
           </ci>
          </apply>
          <csymbol cd="latexml" id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">
           absent
          </csymbol>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l6.m1.1c">
         result\leftarrow
        </annotation>
       </semantics>
      </math>
      Checker(
      <math alttext="response" class="ltx_Math" display="inline" id="alg2.l6.m2.1">
       <semantics id="alg2.l6.m2.1a">
        <mrow id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">
         <mi id="alg2.l6.m2.1.1.2" xref="alg2.l6.m2.1.1.2.cmml">
          r
         </mi>
         <mo id="alg2.l6.m2.1.1.1" lspace="0em" rspace="0em" xref="alg2.l6.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml">
          e
         </mi>
         <mo id="alg2.l6.m2.1.1.1a" lspace="0em" rspace="0em" xref="alg2.l6.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l6.m2.1.1.4" xref="alg2.l6.m2.1.1.4.cmml">
          s
         </mi>
         <mo id="alg2.l6.m2.1.1.1b" lspace="0em" rspace="0em" xref="alg2.l6.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l6.m2.1.1.5" xref="alg2.l6.m2.1.1.5.cmml">
          p
         </mi>
         <mo id="alg2.l6.m2.1.1.1c" lspace="0em" rspace="0em" xref="alg2.l6.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l6.m2.1.1.6" xref="alg2.l6.m2.1.1.6.cmml">
          o
         </mi>
         <mo id="alg2.l6.m2.1.1.1d" lspace="0em" rspace="0em" xref="alg2.l6.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l6.m2.1.1.7" xref="alg2.l6.m2.1.1.7.cmml">
          n
         </mi>
         <mo id="alg2.l6.m2.1.1.1e" lspace="0em" rspace="0em" xref="alg2.l6.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l6.m2.1.1.8" xref="alg2.l6.m2.1.1.8.cmml">
          s
         </mi>
         <mo id="alg2.l6.m2.1.1.1f" lspace="0em" rspace="0em" xref="alg2.l6.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l6.m2.1.1.9" xref="alg2.l6.m2.1.1.9.cmml">
          e
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b">
         <apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1">
          <times id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1.1">
          </times>
          <ci id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2">
           𝑟
          </ci>
          <ci id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3">
           𝑒
          </ci>
          <ci id="alg2.l6.m2.1.1.4.cmml" xref="alg2.l6.m2.1.1.4">
           𝑠
          </ci>
          <ci id="alg2.l6.m2.1.1.5.cmml" xref="alg2.l6.m2.1.1.5">
           𝑝
          </ci>
          <ci id="alg2.l6.m2.1.1.6.cmml" xref="alg2.l6.m2.1.1.6">
           𝑜
          </ci>
          <ci id="alg2.l6.m2.1.1.7.cmml" xref="alg2.l6.m2.1.1.7">
           𝑛
          </ci>
          <ci id="alg2.l6.m2.1.1.8.cmml" xref="alg2.l6.m2.1.1.8">
           𝑠
          </ci>
          <ci id="alg2.l6.m2.1.1.9.cmml" xref="alg2.l6.m2.1.1.9">
           𝑒
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l6.m2.1c">
         response
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg2.l7">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">
        7:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l7.2">
       if
      </span>
      <math alttext="result" class="ltx_Math" display="inline" id="alg2.l7.m1.1">
       <semantics id="alg2.l7.m1.1a">
        <mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">
         <mi id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">
          r
         </mi>
         <mo id="alg2.l7.m1.1.1.1" lspace="0em" rspace="0em" xref="alg2.l7.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">
          e
         </mi>
         <mo id="alg2.l7.m1.1.1.1a" lspace="0em" rspace="0em" xref="alg2.l7.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l7.m1.1.1.4" xref="alg2.l7.m1.1.1.4.cmml">
          s
         </mi>
         <mo id="alg2.l7.m1.1.1.1b" lspace="0em" rspace="0em" xref="alg2.l7.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l7.m1.1.1.5" xref="alg2.l7.m1.1.1.5.cmml">
          u
         </mi>
         <mo id="alg2.l7.m1.1.1.1c" lspace="0em" rspace="0em" xref="alg2.l7.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l7.m1.1.1.6" xref="alg2.l7.m1.1.1.6.cmml">
          l
         </mi>
         <mo id="alg2.l7.m1.1.1.1d" lspace="0em" rspace="0em" xref="alg2.l7.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l7.m1.1.1.7" xref="alg2.l7.m1.1.1.7.cmml">
          t
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b">
         <apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">
          <times id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1">
          </times>
          <ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">
           𝑟
          </ci>
          <ci id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">
           𝑒
          </ci>
          <ci id="alg2.l7.m1.1.1.4.cmml" xref="alg2.l7.m1.1.1.4">
           𝑠
          </ci>
          <ci id="alg2.l7.m1.1.1.5.cmml" xref="alg2.l7.m1.1.1.5">
           𝑢
          </ci>
          <ci id="alg2.l7.m1.1.1.6.cmml" xref="alg2.l7.m1.1.1.6">
           𝑙
          </ci>
          <ci id="alg2.l7.m1.1.1.7.cmml" xref="alg2.l7.m1.1.1.7">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l7.m1.1c">
         result
        </annotation>
       </semantics>
      </math>
      .isValidFinalSolution()
      <span class="ltx_text ltx_font_bold" id="alg2.l7.3">
       then
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l8">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">
        8:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l8.2">
       return
      </span>
      (
      <math alttext="result.solution" class="ltx_Math" display="inline" id="alg2.l8.m1.2">
       <semantics id="alg2.l8.m1.2a">
        <mrow id="alg2.l8.m1.2.2.2" xref="alg2.l8.m1.2.2.3.cmml">
         <mrow id="alg2.l8.m1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.cmml">
          <mi id="alg2.l8.m1.1.1.1.1.2" xref="alg2.l8.m1.1.1.1.1.2.cmml">
           r
          </mi>
          <mo id="alg2.l8.m1.1.1.1.1.1" lspace="0em" rspace="0em" xref="alg2.l8.m1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.3.cmml">
           e
          </mi>
          <mo id="alg2.l8.m1.1.1.1.1.1a" lspace="0em" rspace="0em" xref="alg2.l8.m1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.1.1.1.1.4" xref="alg2.l8.m1.1.1.1.1.4.cmml">
           s
          </mi>
          <mo id="alg2.l8.m1.1.1.1.1.1b" lspace="0em" rspace="0em" xref="alg2.l8.m1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.1.1.1.1.5" xref="alg2.l8.m1.1.1.1.1.5.cmml">
           u
          </mi>
          <mo id="alg2.l8.m1.1.1.1.1.1c" lspace="0em" rspace="0em" xref="alg2.l8.m1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.1.1.1.1.6" xref="alg2.l8.m1.1.1.1.1.6.cmml">
           l
          </mi>
          <mo id="alg2.l8.m1.1.1.1.1.1d" lspace="0em" rspace="0em" xref="alg2.l8.m1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.1.1.1.1.7" xref="alg2.l8.m1.1.1.1.1.7.cmml">
           t
          </mi>
         </mrow>
         <mo id="alg2.l8.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg2.l8.m1.2.2.3a.cmml">
          .
         </mo>
         <mrow id="alg2.l8.m1.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.cmml">
          <mi id="alg2.l8.m1.2.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.2.cmml">
           s
          </mi>
          <mo id="alg2.l8.m1.2.2.2.2.1" lspace="0em" rspace="0em" xref="alg2.l8.m1.2.2.2.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.2.2.2.2.3" xref="alg2.l8.m1.2.2.2.2.3.cmml">
           o
          </mi>
          <mo id="alg2.l8.m1.2.2.2.2.1a" lspace="0em" rspace="0em" xref="alg2.l8.m1.2.2.2.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.2.2.2.2.4" xref="alg2.l8.m1.2.2.2.2.4.cmml">
           l
          </mi>
          <mo id="alg2.l8.m1.2.2.2.2.1b" lspace="0em" rspace="0em" xref="alg2.l8.m1.2.2.2.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.2.2.2.2.5" xref="alg2.l8.m1.2.2.2.2.5.cmml">
           u
          </mi>
          <mo id="alg2.l8.m1.2.2.2.2.1c" lspace="0em" rspace="0em" xref="alg2.l8.m1.2.2.2.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.2.2.2.2.6" xref="alg2.l8.m1.2.2.2.2.6.cmml">
           t
          </mi>
          <mo id="alg2.l8.m1.2.2.2.2.1d" lspace="0em" rspace="0em" xref="alg2.l8.m1.2.2.2.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.2.2.2.2.7" xref="alg2.l8.m1.2.2.2.2.7.cmml">
           i
          </mi>
          <mo id="alg2.l8.m1.2.2.2.2.1e" lspace="0em" rspace="0em" xref="alg2.l8.m1.2.2.2.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.2.2.2.2.8" xref="alg2.l8.m1.2.2.2.2.8.cmml">
           o
          </mi>
          <mo id="alg2.l8.m1.2.2.2.2.1f" lspace="0em" rspace="0em" xref="alg2.l8.m1.2.2.2.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l8.m1.2.2.2.2.9" xref="alg2.l8.m1.2.2.2.2.9.cmml">
           n
          </mi>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l8.m1.2b">
         <apply id="alg2.l8.m1.2.2.3.cmml" xref="alg2.l8.m1.2.2.2">
          <csymbol cd="ambiguous" id="alg2.l8.m1.2.2.3a.cmml" xref="alg2.l8.m1.2.2.2.3">
           formulae-sequence
          </csymbol>
          <apply id="alg2.l8.m1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1">
           <times id="alg2.l8.m1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1">
           </times>
           <ci id="alg2.l8.m1.1.1.1.1.2.cmml" xref="alg2.l8.m1.1.1.1.1.2">
            𝑟
           </ci>
           <ci id="alg2.l8.m1.1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.1.3">
            𝑒
           </ci>
           <ci id="alg2.l8.m1.1.1.1.1.4.cmml" xref="alg2.l8.m1.1.1.1.1.4">
            𝑠
           </ci>
           <ci id="alg2.l8.m1.1.1.1.1.5.cmml" xref="alg2.l8.m1.1.1.1.1.5">
            𝑢
           </ci>
           <ci id="alg2.l8.m1.1.1.1.1.6.cmml" xref="alg2.l8.m1.1.1.1.1.6">
            𝑙
           </ci>
           <ci id="alg2.l8.m1.1.1.1.1.7.cmml" xref="alg2.l8.m1.1.1.1.1.7">
            𝑡
           </ci>
          </apply>
          <apply id="alg2.l8.m1.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2">
           <times id="alg2.l8.m1.2.2.2.2.1.cmml" xref="alg2.l8.m1.2.2.2.2.1">
           </times>
           <ci id="alg2.l8.m1.2.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2.2">
            𝑠
           </ci>
           <ci id="alg2.l8.m1.2.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.2.3">
            𝑜
           </ci>
           <ci id="alg2.l8.m1.2.2.2.2.4.cmml" xref="alg2.l8.m1.2.2.2.2.4">
            𝑙
           </ci>
           <ci id="alg2.l8.m1.2.2.2.2.5.cmml" xref="alg2.l8.m1.2.2.2.2.5">
            𝑢
           </ci>
           <ci id="alg2.l8.m1.2.2.2.2.6.cmml" xref="alg2.l8.m1.2.2.2.2.6">
            𝑡
           </ci>
           <ci id="alg2.l8.m1.2.2.2.2.7.cmml" xref="alg2.l8.m1.2.2.2.2.7">
            𝑖
           </ci>
           <ci id="alg2.l8.m1.2.2.2.2.8.cmml" xref="alg2.l8.m1.2.2.2.2.8">
            𝑜
           </ci>
           <ci id="alg2.l8.m1.2.2.2.2.9.cmml" xref="alg2.l8.m1.2.2.2.2.9">
            𝑛
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l8.m1.2c">
         result.solution
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg2.l9">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">
        9:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l9.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l9.3">
       if
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l10">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">
        10:
       </span>
      </span>
      memory.store(
      <math alttext="result" class="ltx_Math" display="inline" id="alg2.l10.m1.1">
       <semantics id="alg2.l10.m1.1a">
        <mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">
         <mi id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">
          r
         </mi>
         <mo id="alg2.l10.m1.1.1.1" lspace="0em" rspace="0em" xref="alg2.l10.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml">
          e
         </mi>
         <mo id="alg2.l10.m1.1.1.1a" lspace="0em" rspace="0em" xref="alg2.l10.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l10.m1.1.1.4" xref="alg2.l10.m1.1.1.4.cmml">
          s
         </mi>
         <mo id="alg2.l10.m1.1.1.1b" lspace="0em" rspace="0em" xref="alg2.l10.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l10.m1.1.1.5" xref="alg2.l10.m1.1.1.5.cmml">
          u
         </mi>
         <mo id="alg2.l10.m1.1.1.1c" lspace="0em" rspace="0em" xref="alg2.l10.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l10.m1.1.1.6" xref="alg2.l10.m1.1.1.6.cmml">
          l
         </mi>
         <mo id="alg2.l10.m1.1.1.1d" lspace="0em" rspace="0em" xref="alg2.l10.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l10.m1.1.1.7" xref="alg2.l10.m1.1.1.7.cmml">
          t
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b">
         <apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">
          <times id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1">
          </times>
          <ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">
           𝑟
          </ci>
          <ci id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">
           𝑒
          </ci>
          <ci id="alg2.l10.m1.1.1.4.cmml" xref="alg2.l10.m1.1.1.4">
           𝑠
          </ci>
          <ci id="alg2.l10.m1.1.1.5.cmml" xref="alg2.l10.m1.1.1.5">
           𝑢
          </ci>
          <ci id="alg2.l10.m1.1.1.6.cmml" xref="alg2.l10.m1.1.1.6">
           𝑙
          </ci>
          <ci id="alg2.l10.m1.1.1.7.cmml" xref="alg2.l10.m1.1.1.7">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l10.m1.1c">
         result
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg2.l11">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l11.1.1.1" style="font-size:80%;">
        11:
       </span>
      </span>
      <math alttext="ctrl\_signal\leftarrow" class="ltx_Math" display="inline" id="alg2.l11.m1.1">
       <semantics id="alg2.l11.m1.1a">
        <mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml">
         <mrow id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml">
          <mi id="alg2.l11.m1.1.1.2.2" xref="alg2.l11.m1.1.1.2.2.cmml">
           c
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.3" xref="alg2.l11.m1.1.1.2.3.cmml">
           t
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1a" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.4" xref="alg2.l11.m1.1.1.2.4.cmml">
           r
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1b" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.5" xref="alg2.l11.m1.1.1.2.5.cmml">
           l
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1c" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.6" mathvariant="normal" xref="alg2.l11.m1.1.1.2.6.cmml">
           _
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1d" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.7" xref="alg2.l11.m1.1.1.2.7.cmml">
           s
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1e" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.8" xref="alg2.l11.m1.1.1.2.8.cmml">
           i
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1f" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.9" xref="alg2.l11.m1.1.1.2.9.cmml">
           g
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1g" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.10" xref="alg2.l11.m1.1.1.2.10.cmml">
           n
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1h" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.11" xref="alg2.l11.m1.1.1.2.11.cmml">
           a
          </mi>
          <mo id="alg2.l11.m1.1.1.2.1i" lspace="0em" rspace="0em" xref="alg2.l11.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l11.m1.1.1.2.12" xref="alg2.l11.m1.1.1.2.12.cmml">
           l
          </mi>
         </mrow>
         <mo id="alg2.l11.m1.1.1.1" stretchy="false" xref="alg2.l11.m1.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml">
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b">
         <apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">
          <ci id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1">
           ←
          </ci>
          <apply id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2">
           <times id="alg2.l11.m1.1.1.2.1.cmml" xref="alg2.l11.m1.1.1.2.1">
           </times>
           <ci id="alg2.l11.m1.1.1.2.2.cmml" xref="alg2.l11.m1.1.1.2.2">
            𝑐
           </ci>
           <ci id="alg2.l11.m1.1.1.2.3.cmml" xref="alg2.l11.m1.1.1.2.3">
            𝑡
           </ci>
           <ci id="alg2.l11.m1.1.1.2.4.cmml" xref="alg2.l11.m1.1.1.2.4">
            𝑟
           </ci>
           <ci id="alg2.l11.m1.1.1.2.5.cmml" xref="alg2.l11.m1.1.1.2.5">
            𝑙
           </ci>
           <ci id="alg2.l11.m1.1.1.2.6.cmml" xref="alg2.l11.m1.1.1.2.6">
            _
           </ci>
           <ci id="alg2.l11.m1.1.1.2.7.cmml" xref="alg2.l11.m1.1.1.2.7">
            𝑠
           </ci>
           <ci id="alg2.l11.m1.1.1.2.8.cmml" xref="alg2.l11.m1.1.1.2.8">
            𝑖
           </ci>
           <ci id="alg2.l11.m1.1.1.2.9.cmml" xref="alg2.l11.m1.1.1.2.9">
            𝑔
           </ci>
           <ci id="alg2.l11.m1.1.1.2.10.cmml" xref="alg2.l11.m1.1.1.2.10">
            𝑛
           </ci>
           <ci id="alg2.l11.m1.1.1.2.11.cmml" xref="alg2.l11.m1.1.1.2.11">
            𝑎
           </ci>
           <ci id="alg2.l11.m1.1.1.2.12.cmml" xref="alg2.l11.m1.1.1.2.12">
            𝑙
           </ci>
          </apply>
          <csymbol cd="latexml" id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3">
           absent
          </csymbol>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l11.m1.1c">
         ctrl\_signal\leftarrow
        </annotation>
       </semantics>
      </math>
      ToTController(memory)
     </div>
     <div class="ltx_listingline" id="alg2.l12">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l12.1.1.1" style="font-size:80%;">
        12:
       </span>
      </span>
      <math alttext="prompt\leftarrow" class="ltx_Math" display="inline" id="alg2.l12.m1.1">
       <semantics id="alg2.l12.m1.1a">
        <mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml">
         <mrow id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">
          <mi id="alg2.l12.m1.1.1.2.2" xref="alg2.l12.m1.1.1.2.2.cmml">
           p
          </mi>
          <mo id="alg2.l12.m1.1.1.2.1" lspace="0em" rspace="0em" xref="alg2.l12.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l12.m1.1.1.2.3" xref="alg2.l12.m1.1.1.2.3.cmml">
           r
          </mi>
          <mo id="alg2.l12.m1.1.1.2.1a" lspace="0em" rspace="0em" xref="alg2.l12.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l12.m1.1.1.2.4" xref="alg2.l12.m1.1.1.2.4.cmml">
           o
          </mi>
          <mo id="alg2.l12.m1.1.1.2.1b" lspace="0em" rspace="0em" xref="alg2.l12.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l12.m1.1.1.2.5" xref="alg2.l12.m1.1.1.2.5.cmml">
           m
          </mi>
          <mo id="alg2.l12.m1.1.1.2.1c" lspace="0em" rspace="0em" xref="alg2.l12.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l12.m1.1.1.2.6" xref="alg2.l12.m1.1.1.2.6.cmml">
           p
          </mi>
          <mo id="alg2.l12.m1.1.1.2.1d" lspace="0em" rspace="0em" xref="alg2.l12.m1.1.1.2.1.cmml">
           ​
          </mo>
          <mi id="alg2.l12.m1.1.1.2.7" xref="alg2.l12.m1.1.1.2.7.cmml">
           t
          </mi>
         </mrow>
         <mo id="alg2.l12.m1.1.1.1" stretchy="false" xref="alg2.l12.m1.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b">
         <apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">
          <ci id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1">
           ←
          </ci>
          <apply id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">
           <times id="alg2.l12.m1.1.1.2.1.cmml" xref="alg2.l12.m1.1.1.2.1">
           </times>
           <ci id="alg2.l12.m1.1.1.2.2.cmml" xref="alg2.l12.m1.1.1.2.2">
            𝑝
           </ci>
           <ci id="alg2.l12.m1.1.1.2.3.cmml" xref="alg2.l12.m1.1.1.2.3">
            𝑟
           </ci>
           <ci id="alg2.l12.m1.1.1.2.4.cmml" xref="alg2.l12.m1.1.1.2.4">
            𝑜
           </ci>
           <ci id="alg2.l12.m1.1.1.2.5.cmml" xref="alg2.l12.m1.1.1.2.5">
            𝑚
           </ci>
           <ci id="alg2.l12.m1.1.1.2.6.cmml" xref="alg2.l12.m1.1.1.2.6">
            𝑝
           </ci>
           <ci id="alg2.l12.m1.1.1.2.7.cmml" xref="alg2.l12.m1.1.1.2.7">
            𝑡
           </ci>
          </apply>
          <csymbol cd="latexml" id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">
           absent
          </csymbol>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l12.m1.1c">
         prompt\leftarrow
        </annotation>
       </semantics>
      </math>
      Prompter(memory,
      <math alttext="ctrl\_signal" class="ltx_Math" display="inline" id="alg2.l12.m2.1">
       <semantics id="alg2.l12.m2.1a">
        <mrow id="alg2.l12.m2.1.1" xref="alg2.l12.m2.1.1.cmml">
         <mi id="alg2.l12.m2.1.1.2" xref="alg2.l12.m2.1.1.2.cmml">
          c
         </mi>
         <mo id="alg2.l12.m2.1.1.1" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.3" xref="alg2.l12.m2.1.1.3.cmml">
          t
         </mi>
         <mo id="alg2.l12.m2.1.1.1a" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.4" xref="alg2.l12.m2.1.1.4.cmml">
          r
         </mi>
         <mo id="alg2.l12.m2.1.1.1b" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.5" xref="alg2.l12.m2.1.1.5.cmml">
          l
         </mi>
         <mo id="alg2.l12.m2.1.1.1c" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.6" mathvariant="normal" xref="alg2.l12.m2.1.1.6.cmml">
          _
         </mi>
         <mo id="alg2.l12.m2.1.1.1d" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.7" xref="alg2.l12.m2.1.1.7.cmml">
          s
         </mi>
         <mo id="alg2.l12.m2.1.1.1e" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.8" xref="alg2.l12.m2.1.1.8.cmml">
          i
         </mi>
         <mo id="alg2.l12.m2.1.1.1f" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.9" xref="alg2.l12.m2.1.1.9.cmml">
          g
         </mi>
         <mo id="alg2.l12.m2.1.1.1g" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.10" xref="alg2.l12.m2.1.1.10.cmml">
          n
         </mi>
         <mo id="alg2.l12.m2.1.1.1h" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.11" xref="alg2.l12.m2.1.1.11.cmml">
          a
         </mi>
         <mo id="alg2.l12.m2.1.1.1i" lspace="0em" rspace="0em" xref="alg2.l12.m2.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l12.m2.1.1.12" xref="alg2.l12.m2.1.1.12.cmml">
          l
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l12.m2.1b">
         <apply id="alg2.l12.m2.1.1.cmml" xref="alg2.l12.m2.1.1">
          <times id="alg2.l12.m2.1.1.1.cmml" xref="alg2.l12.m2.1.1.1">
          </times>
          <ci id="alg2.l12.m2.1.1.2.cmml" xref="alg2.l12.m2.1.1.2">
           𝑐
          </ci>
          <ci id="alg2.l12.m2.1.1.3.cmml" xref="alg2.l12.m2.1.1.3">
           𝑡
          </ci>
          <ci id="alg2.l12.m2.1.1.4.cmml" xref="alg2.l12.m2.1.1.4">
           𝑟
          </ci>
          <ci id="alg2.l12.m2.1.1.5.cmml" xref="alg2.l12.m2.1.1.5">
           𝑙
          </ci>
          <ci id="alg2.l12.m2.1.1.6.cmml" xref="alg2.l12.m2.1.1.6">
           _
          </ci>
          <ci id="alg2.l12.m2.1.1.7.cmml" xref="alg2.l12.m2.1.1.7">
           𝑠
          </ci>
          <ci id="alg2.l12.m2.1.1.8.cmml" xref="alg2.l12.m2.1.1.8">
           𝑖
          </ci>
          <ci id="alg2.l12.m2.1.1.9.cmml" xref="alg2.l12.m2.1.1.9">
           𝑔
          </ci>
          <ci id="alg2.l12.m2.1.1.10.cmml" xref="alg2.l12.m2.1.1.10">
           𝑛
          </ci>
          <ci id="alg2.l12.m2.1.1.11.cmml" xref="alg2.l12.m2.1.1.11">
           𝑎
          </ci>
          <ci id="alg2.l12.m2.1.1.12.cmml" xref="alg2.l12.m2.1.1.12">
           𝑙
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l12.m2.1c">
         ctrl\_signal
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg2.l13">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l13.1.1.1" style="font-size:80%;">
        13:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l13.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l13.3">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg2.l14">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l14.1.1.1" style="font-size:80%;">
        14:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l14.2">
       return
      </span>
      (
      <math alttext="nil" class="ltx_Math" display="inline" id="alg2.l14.m1.1">
       <semantics id="alg2.l14.m1.1a">
        <mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml">
         <mi id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml">
          n
         </mi>
         <mo id="alg2.l14.m1.1.1.1" lspace="0em" rspace="0em" xref="alg2.l14.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml">
          i
         </mi>
         <mo id="alg2.l14.m1.1.1.1a" lspace="0em" rspace="0em" xref="alg2.l14.m1.1.1.1.cmml">
          ​
         </mo>
         <mi id="alg2.l14.m1.1.1.4" xref="alg2.l14.m1.1.1.4.cmml">
          l
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b">
         <apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1">
          <times id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1">
          </times>
          <ci id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2">
           𝑛
          </ci>
          <ci id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3">
           𝑖
          </ci>
          <ci id="alg2.l14.m1.1.1.4.cmml" xref="alg2.l14.m1.1.1.4">
           𝑙
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg2.l14.m1.1c">
         nil
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg2.l15">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg2.l15.1.1.1" style="font-size:80%;">
        15:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l15.2">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg2.l15.3">
       procedure
      </span>
     </div>
    </div>
   </figure>
   <div class="ltx_para" id="S3.SS4.p1">
    <p class="ltx_p" id="S3.SS4.p1.1">
     After the ToT system is trained, we can use it for inference, i.e. problem solving. Algorithm
     <a class="ltx_ref" href="#alg2" title="Algorithm 2 ‣ 3.4 Problem Solving Using the ToT System ‣ 3 Architecture ‣ Large Language Model Guided Tree-of-Thought">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     provides the pseudo code for solving problems using the ToT system. It starts with a user inputting description of the problem (Line 1-2). The prompter module then converts the user input into a prompt (Line 3) using a prompt template for user input, for example:
     <math alttext="user\_input\_prompt=" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1">
      <semantics id="S3.SS4.p1.1.m1.1a">
       <mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">
        <mrow id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">
         <mi id="S3.SS4.p1.1.m1.1.1.2.2" xref="S3.SS4.p1.1.m1.1.1.2.2.cmml">
          u
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.3" xref="S3.SS4.p1.1.m1.1.1.2.3.cmml">
          s
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1a" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.4" xref="S3.SS4.p1.1.m1.1.1.2.4.cmml">
          e
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1b" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.5" xref="S3.SS4.p1.1.m1.1.1.2.5.cmml">
          r
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1c" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.6" mathvariant="normal" xref="S3.SS4.p1.1.m1.1.1.2.6.cmml">
          _
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1d" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.7" xref="S3.SS4.p1.1.m1.1.1.2.7.cmml">
          i
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1e" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.8" xref="S3.SS4.p1.1.m1.1.1.2.8.cmml">
          n
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1f" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.9" xref="S3.SS4.p1.1.m1.1.1.2.9.cmml">
          p
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1g" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.10" xref="S3.SS4.p1.1.m1.1.1.2.10.cmml">
          u
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1h" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.11" xref="S3.SS4.p1.1.m1.1.1.2.11.cmml">
          t
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1i" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.12" mathvariant="normal" xref="S3.SS4.p1.1.m1.1.1.2.12.cmml">
          _
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1j" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.13" xref="S3.SS4.p1.1.m1.1.1.2.13.cmml">
          p
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1k" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.14" xref="S3.SS4.p1.1.m1.1.1.2.14.cmml">
          r
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1l" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.15" xref="S3.SS4.p1.1.m1.1.1.2.15.cmml">
          o
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1m" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.16" xref="S3.SS4.p1.1.m1.1.1.2.16.cmml">
          m
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1n" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.17" xref="S3.SS4.p1.1.m1.1.1.2.17.cmml">
          p
         </mi>
         <mo id="S3.SS4.p1.1.m1.1.1.2.1o" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.1.1.2.1.cmml">
          ​
         </mo>
         <mi id="S3.SS4.p1.1.m1.1.1.2.18" xref="S3.SS4.p1.1.m1.1.1.2.18.cmml">
          t
         </mi>
        </mrow>
        <mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">
         =
        </mo>
        <mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b">
        <apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">
         <eq id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1">
         </eq>
         <apply id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">
          <times id="S3.SS4.p1.1.m1.1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.1.1.2.1">
          </times>
          <ci id="S3.SS4.p1.1.m1.1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2.2">
           𝑢
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.3.cmml" xref="S3.SS4.p1.1.m1.1.1.2.3">
           𝑠
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.4.cmml" xref="S3.SS4.p1.1.m1.1.1.2.4">
           𝑒
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.5.cmml" xref="S3.SS4.p1.1.m1.1.1.2.5">
           𝑟
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.6.cmml" xref="S3.SS4.p1.1.m1.1.1.2.6">
           _
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.7.cmml" xref="S3.SS4.p1.1.m1.1.1.2.7">
           𝑖
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.8.cmml" xref="S3.SS4.p1.1.m1.1.1.2.8">
           𝑛
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.9.cmml" xref="S3.SS4.p1.1.m1.1.1.2.9">
           𝑝
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.10.cmml" xref="S3.SS4.p1.1.m1.1.1.2.10">
           𝑢
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.11.cmml" xref="S3.SS4.p1.1.m1.1.1.2.11">
           𝑡
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.12.cmml" xref="S3.SS4.p1.1.m1.1.1.2.12">
           _
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.13.cmml" xref="S3.SS4.p1.1.m1.1.1.2.13">
           𝑝
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.14.cmml" xref="S3.SS4.p1.1.m1.1.1.2.14">
           𝑟
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.15.cmml" xref="S3.SS4.p1.1.m1.1.1.2.15">
           𝑜
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.16.cmml" xref="S3.SS4.p1.1.m1.1.1.2.16">
           𝑚
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.17.cmml" xref="S3.SS4.p1.1.m1.1.1.2.17">
           𝑝
          </ci>
          <ci id="S3.SS4.p1.1.m1.1.1.2.18.cmml" xref="S3.SS4.p1.1.m1.1.1.2.18">
           𝑡
          </ci>
         </apply>
         <csymbol cd="latexml" id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">
          absent
         </csymbol>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">
        user\_input\_prompt=
       </annotation>
      </semantics>
     </math>
     “
     <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.1.1">
      For the given problem: [problem description], please derive the first step, and return the step in the following JSON format
     </span>
     {
     <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.1.2">
      next_step: &lt;next_step&gt;
     </span>
     }”.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p2">
    <p class="ltx_p" id="S3.SS4.p2.4">
     Next, up to
     <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1">
      <semantics id="S3.SS4.p2.1.m1.1a">
       <mi id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b">
        <ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">
        K
       </annotation>
      </semantics>
     </math>
     rounds of conversations with the LLM are conducted for problem solving (Line 4). In each round, the LLM first produces a response for the given prompt (Line 5). Then, the checker analyzes the response, and returns a result (Line 6). The result contains the partial solution extracted from the LLM response, as well as information like whether the checker considers the solution as a valid final solution, a valid intermediate solution, or an invalid partial solution, etc. If the solution is a valid final solution, the algorithm simply returns it (Line 7-9). Otherwise, the result is stored in the memory module (Line 10). Based on the content of the memory module, the ToT controller issues control signals, e.g. backtracking for
     <math alttext="l" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1">
      <semantics id="S3.SS4.p2.2.m2.1a">
       <mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">
        l
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b">
        <ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">
         𝑙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">
        l
       </annotation>
      </semantics>
     </math>
     levels, to the prompter (Line 11). Finally, based on the control signal, the prompter looks up the relevant information from the memory module, and produce the next prompt for the LLM (Line 12). If no valid final solution is found within
     <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1">
      <semantics id="S3.SS4.p2.3.m3.1a">
       <mi id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b">
        <ci id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">
        K
       </annotation>
      </semantics>
     </math>
     rounds of conversations, the algorithm return
     <math alttext="nil" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1">
      <semantics id="S3.SS4.p2.4.m4.1a">
       <mrow id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml">
        <mi id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml">
         n
        </mi>
        <mo id="S3.SS4.p2.4.m4.1.1.1" lspace="0em" rspace="0em" xref="S3.SS4.p2.4.m4.1.1.1.cmml">
         ​
        </mo>
        <mi id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml">
         i
        </mi>
        <mo id="S3.SS4.p2.4.m4.1.1.1a" lspace="0em" rspace="0em" xref="S3.SS4.p2.4.m4.1.1.1.cmml">
         ​
        </mo>
        <mi id="S3.SS4.p2.4.m4.1.1.4" xref="S3.SS4.p2.4.m4.1.1.4.cmml">
         l
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b">
        <apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">
         <times id="S3.SS4.p2.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1">
         </times>
         <ci id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2">
          𝑛
         </ci>
         <ci id="S3.SS4.p2.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3">
          𝑖
         </ci>
         <ci id="S3.SS4.p2.4.m4.1.1.4.cmml" xref="S3.SS4.p2.4.m4.1.1.4">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">
        nil
       </annotation>
      </semantics>
     </math>
     indicating it fails to solve the problem (Line 14).
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Evaluation
  </h2>
  <div class="ltx_para" id="S4.p1">
   <p class="ltx_p" id="S4.p1.2">
    This section provides the evaluation methodology and experimental results for our proposed ToT framework. Our evaluation focuses on the ToT-based solver for the Sudoku problem. At the first glance, Sudoku problems seem to be just brain teasers with little practical importance. However, the generalized Sudoku problem on
    <math alttext="n^{2}\times n^{2}" class="ltx_Math" display="inline" id="S4.p1.1.m1.1">
     <semantics id="S4.p1.1.m1.1a">
      <mrow id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">
       <msup id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">
        <mi id="S4.p1.1.m1.1.1.2.2" xref="S4.p1.1.m1.1.1.2.2.cmml">
         n
        </mi>
        <mn id="S4.p1.1.m1.1.1.2.3" xref="S4.p1.1.m1.1.1.2.3.cmml">
         2
        </mn>
       </msup>
       <mo id="S4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.1.m1.1.1.1.cmml">
        ×
       </mo>
       <msup id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">
        <mi id="S4.p1.1.m1.1.1.3.2" xref="S4.p1.1.m1.1.1.3.2.cmml">
         n
        </mi>
        <mn id="S4.p1.1.m1.1.1.3.3" xref="S4.p1.1.m1.1.1.3.3.cmml">
         2
        </mn>
       </msup>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b">
       <apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">
        <times id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1">
        </times>
        <apply id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">
         <csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.2.1.cmml" xref="S4.p1.1.m1.1.1.2">
          superscript
         </csymbol>
         <ci id="S4.p1.1.m1.1.1.2.2.cmml" xref="S4.p1.1.m1.1.1.2.2">
          𝑛
         </ci>
         <cn id="S4.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.2.3">
          2
         </cn>
        </apply>
        <apply id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">
         <csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.3.1.cmml" xref="S4.p1.1.m1.1.1.3">
          superscript
         </csymbol>
         <ci id="S4.p1.1.m1.1.1.3.2.cmml" xref="S4.p1.1.m1.1.1.3.2">
          𝑛
         </ci>
         <cn id="S4.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.3.3">
          2
         </cn>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">
       n^{2}\times n^{2}
      </annotation>
     </semantics>
    </math>
    grids of
    <math alttext="n\times n" class="ltx_Math" display="inline" id="S4.p1.2.m2.1">
     <semantics id="S4.p1.2.m2.1a">
      <mrow id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">
       <mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">
        n
       </mi>
       <mo id="S4.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.2.m2.1.1.1.cmml">
        ×
       </mo>
       <mi id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">
        n
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b">
       <apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">
        <times id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1">
        </times>
        <ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">
         𝑛
        </ci>
        <ci id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">
         𝑛
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">
       n\times n
      </annotation>
     </semantics>
    </math>
    blocks is known to be NP-complete
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib33" title="">
      <span class="ltx_text" style="font-size:80%;">
       haythorpe2016reducing
      </span>
     </a>
    </cite>
    . If the ToT framework can solve instances of the generalized Sudoku problem (granted that it might takes an exponential number of rounds of conversations), in principle it can handle many other mathematical and logical reasoning tasks. In fact, it is straightforward to re-purpose the implementation described below to solve other puzzles, such as 3SAT, 3-coloring, etc. Below we first describe the implementation details of the solver. Then, we present the test suite used in our evaluation, as well as the experimental results.
   </p>
  </div>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    ToT Solver for Sudoku Puzzles
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     The ToT-based Sudoku solver follows the generic framework described in Section
     <a class="ltx_ref" href="#S3" title="3 Architecture ‣ Large Language Model Guided Tree-of-Thought">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     with some specific tweaks for the Sudoku problem. It allows a user to input a Sudoku puzzle using natural languages, for example: “Please solve this 4x4 Sudoku puzzle [[3,*,*,2],[1,*,3,*],[*,1,*,3],[4,*,*,1]] where * represents a cell to be filled”.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p2">
    <p class="ltx_p" id="S4.SS1.p2.1">
     We have implemented the ToT-based Sudoku solver as described in Section
     <a class="ltx_ref" href="#S4.SS1" title="4.1 ToT Solver for Sudoku Puzzles ‣ 4 Evaluation ‣ Large Language Model Guided Tree-of-Thought">
      <span class="ltx_text ltx_ref_tag">
       4.1
      </span>
     </a>
     in Python. We adopted a rule-based approach for the
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">
      checker module
     </span>
     since the Sudoku rules are precise and easy to check. The
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.2">
      memory module
     </span>
     stores the conversation history between the prompter and the LLM, as well as a search tree which maintains all the partially filled Sudoku board the LLM has generated so far. This way, when backtracking happens, the previous board configuration can be retrieved. The
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.3">
      ToT controller
     </span>
     in our implementation is also rule-based. It returns to the parent node in the search tree if either the current node considered invalid by the checker, or the search algorithm has explored more than 5 children of the current node. Finally the
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.4">
      prompter agent
     </span>
     uses a variation of the generic template mentioned above, with the
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.5">
      [problem description]
     </span>
     being the initial configuration of the Sudoku board input by the user, and
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.6">
      [partial solution summary]
     </span>
     being the partially filled board represented by the current node in the search tree. The LLM utilized in this study is the "gpt-3.5-turbo" model, which is accessible through the OpenAI API suite. The
     <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.7">
      temperature
     </span>
     parameter was set to 1 in our experiments.
    </p>
   </div>
   <figure class="ltx_figure" id="S4.F2">
    <svg class="ltx_picture ltx_centering" height="200.3" id="S4.F2.pic1" overflow="visible" version="1.1" width="496.45">
     <g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,200.3) matrix(1 0 0 -1 0 0) translate(48.44,0) translate(0,51.8) matrix(1.0 0.0 0.0 1.0 -48.44 -51.8)">
      <g class="ltx_nestedsvg" transform="matrix(1 0 0 1 0 0) translate(100.1,0) translate(0,68.24)">
       <g color="#808080" fill="#808080" stroke="#808080" stroke-width="0.2pt">
        <path d="M 0 -22.34 L 0 -16.44 M 172.21 -22.34 L 172.21 -16.44 M 344.41 -22.34 L 344.41 -16.44 M 0 131.93 L 0 126.02 M 172.21 131.93 L 172.21 126.02 M 344.41 131.93 L 344.41 126.02" style="fill:none">
        </path>
       </g>
       <g color="#808080" fill="#808080" stroke="#808080" stroke-width="0.2pt">
        <path d="M -51.66 -12.18 L -45.75 -12.18 M -51.66 48.7 L -45.75 48.7 M -51.66 109.59 L -45.75 109.59 M 396.07 -12.18 L 390.17 -12.18 M 396.07 48.7 L 390.17 48.7 M 396.07 109.59 L 390.17 109.59" style="fill:none">
        </path>
       </g>
       <g fill="#000000" stroke="#000000" stroke-width="0.4pt">
        <path d="M -51.66 -16.44 L -51.66 126.02 L 396.07 126.02 L 396.07 -16.44 L -51.66 -16.44 Z" style="fill:none">
        </path>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -34.44 -36.84)">
         <foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="68.88">
          <span class="ltx_text" id="S4.F2.pic1.16.16.16.16.16.1.1">
           3x3 puzzles
          </span>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 137.77 -36.84)">
         <foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="68.88">
          <span class="ltx_text" id="S4.F2.pic1.17.17.17.17.17.1.1">
           4x4 puzzles
          </span>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 309.97 -36.84)">
         <foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="68.88">
          <span class="ltx_text" id="S4.F2.pic1.18.18.18.18.18.1.1">
           5x5 puzzles
          </span>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -63.47 -16.63)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92">
          <math alttext="0" class="ltx_Math" display="inline" id="S4.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="integer" xref="S4.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
              0
             </cn>
            </annotation-xml>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -76.54 44.25)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.5" class="ltx_Math" display="inline" id="S4.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.5
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.5
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1c">
             0.5
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -63.47 105.13)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92">
          <math alttext="1" class="ltx_Math" display="inline" id="S4.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             1
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="integer" xref="S4.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1">
              1
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.m1.1c">
             1
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <clippath id="pgfcp1">
         <path d="M -51.66 -16.44 L 396.07 -16.44 L 396.07 126.02 L -51.66 126.02 Z">
         </path>
        </clippath>
        <g clip-path="url(#pgfcp1)">
         <g fill="#B3B3FF">
          <path d="M -37.36 -12.18 h 16.6 v 48.7 h -16.6 Z M 134.85 -12.18 h 16.6 v 24.35 h -16.6 Z M 307.05 -12.18 h 16.6 v 12.18 h -16.6 Z">
          </path>
         </g>
         <g>
         </g>
         <g fill="#FFB3B3">
          <path d="M -17.99 -12.18 h 16.6 v 109.59 h -16.6 Z M 154.22 -12.18 h 16.6 v 48.7 h -16.6 Z M 326.43 -12.18 h 16.6 v 60.88 h -16.6 Z">
          </path>
         </g>
         <g>
         </g>
         <g fill="#ECD9C6">
          <path d="M 1.38 -12.18 h 16.6 v 109.59 h -16.6 Z M 173.59 -12.18 h 16.6 v 60.88 h -16.6 Z M 345.8 -12.18 h 16.6 v 60.88 h -16.6 Z">
          </path>
         </g>
         <g>
         </g>
         <g fill="#80FF80">
          <path d="M 20.76 -12.18 h 16.6 v 121.76 h -16.6 Z M 192.96 -12.18 h 16.6 v 109.59 h -16.6 Z M 365.17 -12.18 h 16.6 v 97.41 h -16.6 Z">
          </path>
         </g>
         <g>
         </g>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -39.05 41.42)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.4" class="ltx_Math" display="inline" id="S4.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.4
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.4
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">
             0.4
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 133.16 17.06)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.2" class="ltx_Math" display="inline" id="S4.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.2.2.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.2.2.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.2
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.2.2.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.2
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.5.2.2.2.1.1.1.1.1.1.1.1.1.m1.1c">
             0.2
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 305.36 4.89)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.1" class="ltx_Math" display="inline" id="S4.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.3.3.3.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.3.3.3.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.1
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.3.3.3.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.1
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.6.3.3.3.1.1.1.1.1.1.1.1.1.m1.1c">
             0.1
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -19.68 102.3)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.9" class="ltx_Math" display="inline" id="S4.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.9
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.9
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">
             0.9
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 152.53 41.42)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.4" class="ltx_Math" display="inline" id="S4.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.4
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.4
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.1.1.1.1.1.1.1.1.1.m1.1c">
             0.4
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 324.73 53.59)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.5" class="ltx_Math" display="inline" id="S4.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.3.3.3.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.3.3.3.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.5
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.3.3.3.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.5
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.3.3.3.1.1.1.1.1.1.1.1.1.m1.1c">
             0.5
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -0.31 102.3)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.9" class="ltx_Math" display="inline" id="S4.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.9
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.9
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">
             0.9
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 171.9 53.59)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.5" class="ltx_Math" display="inline" id="S4.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.2.2.2.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.2.2.2.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.5
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.2.2.2.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.5
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.11.2.2.2.1.1.1.1.1.1.1.1.1.m1.1c">
             0.5
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 344.11 53.59)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.5" class="ltx_Math" display="inline" id="S4.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.3.3.3.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.3.3.3.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.5
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.3.3.3.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.5
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.12.3.3.3.1.1.1.1.1.1.1.1.1.m1.1c">
             0.5
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 25.6 114.47)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92">
          <math alttext="1" class="ltx_Math" display="inline" id="S4.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             1
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="integer" xref="S4.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">
              1
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">
             1
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 191.27 102.3)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.9" class="ltx_Math" display="inline" id="S4.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.2.2.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.2.2.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.9
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.2.2.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.9
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.14.2.2.2.1.1.1.1.1.1.1.1.1.m1.1c">
             0.9
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 363.48 90.12)">
         <foreignobject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.99">
          <math alttext="0.8" class="ltx_Math" display="inline" id="S4.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.3.3.1.1.1.1.1.1.1.1.1.m1.1">
           <semantics id="S4.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.3.3.1.1.1.1.1.1.1.1.1.m1.1a">
            <mn id="S4.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
             0.8
            </mn>
            <annotation-xml encoding="MathML-Content" id="S4.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.3.3.1.1.1.1.1.1.1.1.1.m1.1b">
             <cn id="S4.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" type="float" xref="S4.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.3.3.1.1.1.1.1.1.1.1.1.m1.1.1">
              0.8
             </cn>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S4.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.15.3.3.3.1.1.1.1.1.1.1.1.1.m1.1c">
             0.8
            </annotation>
           </semantics>
          </math>
         </foreignobject>
        </g>
        <g fill="#000000" stroke="#000000" transform="matrix(0.0 1.0 -1.0 0.0 -86.04 18.18)">
         <foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="73.22">
          <span class="ltx_text" id="S4.F2.pic1.19.19.19.19.19.1.1">
           Success rate
          </span>
         </foreignobject>
        </g>
        <g fill="#FFFFFF" stroke="#000000">
         <path d="M 104.74 -67.96 h 134.93 v 22.75 h -134.93 Z">
         </path>
        </g>
        <g fill="#FFFFFF" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 108.89 -65.19)">
         <g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 8.61)">
          <g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 8.61)">
           <g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" fill="#B3B3FF" transform="matrix(1 0 0 -1 0 0) translate(2.35,0)">
            <path d="M -2.08 -2.77 h 4.15 v 11.07 h -4.15 Z M 6.23 -2.77 h 4.15 v 8.3 h -4.15 Z">
            </path>
           </g>
           <g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" fill="#000000" stroke="#000000" transform="matrix(1 0 0 -1 13.28 0) translate(-0.28,0) matrix(1.0 0.0 0.0 1.0 3.04 -1.94)">
            <foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="11.61">
             <span class="ltx_text" id="S4.F2.pic1.20.20.20.20.20.1.1.1.1.1">
              zs
             </span>
            </foreignobject>
           </g>
           <g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" fill="#FFB3B3" transform="matrix(1 0 0 -1 30.43 0) translate(2.35,0)">
            <path d="M -2.08 -2.77 h 4.15 v 11.07 h -4.15 Z M 6.23 -2.77 h 4.15 v 8.3 h -4.15 Z">
            </path>
           </g>
           <g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" fill="#000000" stroke="#000000" transform="matrix(1 0 0 -1 43.71 0) translate(-0.28,0) matrix(1.0 0.0 0.0 1.0 3.04 -1.94)">
            <foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.38">
             <span class="ltx_text" id="S4.F2.pic1.21.21.21.21.21.2.2.2.1.1">
              os
             </span>
            </foreignobject>
           </g>
           <g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" fill="#ECD9C6" transform="matrix(1 0 0 -1 61.62 0) translate(2.35,0)">
            <path d="M -2.08 -2.77 h 4.15 v 11.07 h -4.15 Z M 6.23 -2.77 h 4.15 v 8.3 h -4.15 Z">
            </path>
           </g>
           <g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" fill="#000000" stroke="#000000" transform="matrix(1 0 0 -1 74.9 0) translate(-0.28,0) matrix(1.0 0.0 0.0 1.0 3.04 -3.77)">
            <foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="9.69">
             <span class="ltx_text" id="S4.F2.pic1.22.22.22.22.22.3.3.3.1.1">
              fs
             </span>
            </foreignobject>
           </g>
           <g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" fill="#80FF80" transform="matrix(1 0 0 -1 90.12 0) translate(2.35,0)">
            <path d="M -2.08 -2.77 h 4.15 v 11.07 h -4.15 Z M 6.23 -2.77 h 4.15 v 8.3 h -4.15 Z">
            </path>
           </g>
           <g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" fill="#000000" stroke="#000000" transform="matrix(1 0 0 -1 103.41 0) translate(-0.28,0) matrix(1.0 0.0 0.0 1.0 3.04 -3.22)">
            <foreignobject height="8.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="17.68">
             <span class="ltx_text" id="S4.F2.pic1.23.23.23.23.23.4.4.4.1.1">
              tot
             </span>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </g>
    </svg>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">
       Figure 2
      </span>
      :
     </span>
     <span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">
      Experimental results comparing the success rate of different LLM-based Sudoku puzzle solvers across three sets of benchmarks.
     </span>
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Experimental Results
   </h3>
   <div class="ltx_para" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.3">
     We have implemented four LLM-based Sudoku puzzle solvers and compared their performance: 1) zero-shot solver (
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.3.1">
      zs
     </span>
     ) which directly posts the puzzle description to the LLM, 2) one-shot solver (
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.3.2">
      os
     </span>
     ) which provides a chain-of-thought style step-by-step solution of a 3x3 Sudoku puzzle as an example in addition to the problem description, 3) few-shot solver (
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.3.3">
      fs
     </span>
     ) which provides multiple examples with CoT-style solutions, and 4) our proposed Tree-of-Thought solver (
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.3.4">
      tot
     </span>
     ). We constructed three benchmarks, comprising of ten 3x3, 4x4, and 5x5 Sudoku puzzles, respectively. The objective of a solver is to fill the
     <math alttext="n\times n" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1">
      <semantics id="S4.SS2.p1.1.m1.1a">
       <mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">
        <mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">
         n
        </mi>
        <mo id="S4.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.1.m1.1.1.1.cmml">
         ×
        </mo>
        <mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">
         n
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b">
        <apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">
         <times id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">
         </times>
         <ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">
          𝑛
         </ci>
         <ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">
          𝑛
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">
        n\times n
       </annotation>
      </semantics>
     </math>
     Sudoku grid with digits so that each row and column contain all of the digits from 1 to
     <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1">
      <semantics id="S4.SS2.p1.2.m2.1a">
       <mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">
        n
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b">
        <ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">
         𝑛
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">
        n
       </annotation>
      </semantics>
     </math>
     (
     <math alttext="n=3,4,5" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.3">
      <semantics id="S4.SS2.p1.3.m3.3a">
       <mrow id="S4.SS2.p1.3.m3.3.4" xref="S4.SS2.p1.3.m3.3.4.cmml">
        <mi id="S4.SS2.p1.3.m3.3.4.2" xref="S4.SS2.p1.3.m3.3.4.2.cmml">
         n
        </mi>
        <mo id="S4.SS2.p1.3.m3.3.4.1" xref="S4.SS2.p1.3.m3.3.4.1.cmml">
         =
        </mo>
        <mrow id="S4.SS2.p1.3.m3.3.4.3.2" xref="S4.SS2.p1.3.m3.3.4.3.1.cmml">
         <mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">
          3
         </mn>
         <mo id="S4.SS2.p1.3.m3.3.4.3.2.1" xref="S4.SS2.p1.3.m3.3.4.3.1.cmml">
          ,
         </mo>
         <mn id="S4.SS2.p1.3.m3.2.2" xref="S4.SS2.p1.3.m3.2.2.cmml">
          4
         </mn>
         <mo id="S4.SS2.p1.3.m3.3.4.3.2.2" xref="S4.SS2.p1.3.m3.3.4.3.1.cmml">
          ,
         </mo>
         <mn id="S4.SS2.p1.3.m3.3.3" xref="S4.SS2.p1.3.m3.3.3.cmml">
          5
         </mn>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.3b">
        <apply id="S4.SS2.p1.3.m3.3.4.cmml" xref="S4.SS2.p1.3.m3.3.4">
         <eq id="S4.SS2.p1.3.m3.3.4.1.cmml" xref="S4.SS2.p1.3.m3.3.4.1">
         </eq>
         <ci id="S4.SS2.p1.3.m3.3.4.2.cmml" xref="S4.SS2.p1.3.m3.3.4.2">
          𝑛
         </ci>
         <list id="S4.SS2.p1.3.m3.3.4.3.1.cmml" xref="S4.SS2.p1.3.m3.3.4.3.2">
          <cn id="S4.SS2.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1">
           3
          </cn>
          <cn id="S4.SS2.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS2.p1.3.m3.2.2">
           4
          </cn>
          <cn id="S4.SS2.p1.3.m3.3.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.3.3">
           5
          </cn>
         </list>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.3c">
        n=3,4,5
       </annotation>
      </semantics>
     </math>
     in our experiments).
    </p>
   </div>
   <div class="ltx_para" id="S4.SS2.p2">
    <p class="ltx_p" id="S4.SS2.p2.1">
     Figure
     <a class="ltx_ref" href="#S4.F2" title="Figure 2 ‣ 4.1 ToT Solver for Sudoku Puzzles ‣ 4 Evaluation ‣ Large Language Model Guided Tree-of-Thought">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     compares the success rates of different LLM-based solvers across the three benchmarks. Here the term
     <span class="ltx_text ltx_font_italic" id="S4.SS2.p2.1.1">
      success rate
     </span>
     refers to the fraction of problems in a benchmark set that are successfully solved by a solver. For example, if a solver is able to solve 4 out of 10 problems in the “3x3 puzzles” benchmark set, then the success rate of this solver for this benchmark set is 0.4. As expected, the zero-shot solver has the worst performance across all the three set of benchmarks. Adding CoT-style step-by-step examples significantly boosts the success rate, especially for the 3x3 puzzles. This is expected, since one can pretty much rely on “short-range” reasoning skills, which is a strength of the LLM models, to solve a small-sized 3x3 Sudoku puzzle, espcially when CoT-style hints are provided. However, as the puzzle size gets bigger, the success rate of the one-shot and few-shot solver dropped to around 0.5. This is because solving bigger puzzles requires trial and error, which is a capability LLMs generally lack of as discussed earlier.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS2.p3">
    <p class="ltx_p" id="S4.SS2.p3.1">
     In comparison, the ToT-based solver demonstrates superior performance when compared to the other solvers. For the 3x3 benchmark set, it was able to solve all the puzzles. The success rate improves by 11% compared to the second best for the two benchmark sets. For the 4x4 benchmark set, the ToT-based solver failed to find the solution for 1 out of the 10 puzzles before reaching the maximum round of conversations (which is set to 100 in our experiments). We suspect it is due to the limited capability of the rule-based ToT controller. In particular, the rule-based controller has no sense of whether the current partially-filled board can be completed without violating the Sudoku rules, which decreases the efficiency of the solution search. We expect a neural network based ToT controller will perform better, which we will verify in the future extension of this work. Despite this, the success rate of the ToT based solver is still 80% higher compared to that of the one-shot and few-shot based solvers. Finally, for the 5x5 puzzles, the ToT-based solver failed with 2 puzzles before reaching the maximum round of conversations. Nonetheless, the success rate is 60% higher compared to that of the one-shot and few-shot based solvers.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Discussions and Future Works
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    In this paper, we presented the Tree-of-Thought framework, which enhances LLMs with additional agents and memory modules, resulting in improved performance for mathematical problem-solving tasks. To evaluate the performance of this technique, we implemented a Sudoku puzzle solver based on the ToT framework. One of the limitations of the current implementation is that it utilizes a rule-based checker that contains custom logic, making it less easily adaptable to other problems. For more generic problems, for example, general mathematical and logical reasoning problems, where rule-based solution checking is difficult to implement, a future direction is to explore checkers based on neural network or other probabilistic models. Moreover, the experiments we conducted in this work also uses a rule-based ToT controller, which as we pointed out, has limited capabilities. In the future, we will implement the neural network based ToT controller which can hopefully enhance the system performance. Additionally, the policy-gradient based training algorithm proposed in this work is relatively simple and may be susceptible to training stability issues. To further optimize the ToT system, more advanced multi-agent reinforcement learning algorithms, particularly those designed for cooperative agents, could be adopted.
   </p>
  </div>
  <div class="ltx_para" id="S5.p2">
   <p class="ltx_p" id="S5.p2.1">
    Another intriguing future direction is to investigate the potential of utilizing the “self-play” technique to enable the ToT system to develop novel problem solving strategies that are not found in the LLM’s training text corpus. The self-play training method is a reinforcement learning technique which was popularized by the development of competitive game-playing agents such as AlphaGo and AlphaStar
    <cite class="ltx_cite ltx_citemacro_cite">
     <a class="ltx_ref" href="#bib.bib34" title="">
      <span class="ltx_text" style="font-size:80%;">
       silver2016mastering
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib35" title="">
      <span class="ltx_text" style="font-size:80%;">
       silver2017mastering
      </span>
     </a>
     ;
     <a class="ltx_ref" href="#bib.bib36" title="">
      <span class="ltx_text" style="font-size:80%;">
       vinyals2019starcraft
      </span>
     </a>
    </cite>
    , where an AI agent learns to improve its own strategy by playing against itself. Today’s LLMs are typically trained using self-supervised learning techniques. They may have limitations when it comes to problem-solving, as they may not be able to generate samples (i.e. novel problem solving strategies) that fall outside the distribution of the training data. In other words, they may not be able to “think outside the box”, which is a crucial human trait that facilitates the discovery of new knowledge. Compared to self-supervised learning, self-play based reinforcement learning enables the system to access a much broader solution space beyond the provided training examples, allowing for greater improvement. AlphaGo and similar systems have demonstrated the ability to devise strategies that surpass even those of human experts. Inspired by these examples, for ToT system training, instead of relying on the training data set
    <math alttext="P_{train}" class="ltx_Math" display="inline" id="S5.p2.1.m1.1">
     <semantics id="S5.p2.1.m1.1a">
      <msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">
       <mi id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">
        P
       </mi>
       <mrow id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">
        <mi id="S5.p2.1.m1.1.1.3.2" xref="S5.p2.1.m1.1.1.3.2.cmml">
         t
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.3" xref="S5.p2.1.m1.1.1.3.3.cmml">
         r
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1a" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.4" xref="S5.p2.1.m1.1.1.3.4.cmml">
         a
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1b" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.5" xref="S5.p2.1.m1.1.1.3.5.cmml">
         i
        </mi>
        <mo id="S5.p2.1.m1.1.1.3.1c" lspace="0em" rspace="0em" xref="S5.p2.1.m1.1.1.3.1.cmml">
         ​
        </mo>
        <mi id="S5.p2.1.m1.1.1.3.6" xref="S5.p2.1.m1.1.1.3.6.cmml">
         n
        </mi>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b">
       <apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">
        <csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">
         subscript
        </csymbol>
        <ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">
         𝑃
        </ci>
        <apply id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">
         <times id="S5.p2.1.m1.1.1.3.1.cmml" xref="S5.p2.1.m1.1.1.3.1">
         </times>
         <ci id="S5.p2.1.m1.1.1.3.2.cmml" xref="S5.p2.1.m1.1.1.3.2">
          𝑡
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.3.cmml" xref="S5.p2.1.m1.1.1.3.3">
          𝑟
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.4.cmml" xref="S5.p2.1.m1.1.1.3.4">
          𝑎
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.5.cmml" xref="S5.p2.1.m1.1.1.3.5">
          𝑖
         </ci>
         <ci id="S5.p2.1.m1.1.1.3.6.cmml" xref="S5.p2.1.m1.1.1.3.6">
          𝑛
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">
       P_{train}
      </annotation>
     </semantics>
    </math>
    , we can introduce a “quizzer” module which can come up with problem descriptions on its own to train the ToT controller and the prompter agent. It is worth mentioning that one of the key enablers for training AlphaGo and similar system is that the environment reward can be precisely determined, as it is straightforward to determine whether the gameplay results in a win or a loss. The ToT framework incorporates a checker that can assess the correctness of the solution, functioning similarly to the environment, particularly for problems that have well-defined solution validation rules. Thus, the reinforcement learning training methods can be readily applied. We suspect that this self-driven learning approach, similar to the self-play method, could be an effective means of improving the ToT framework’s problem-solving capabilities beyond the solution examples provided in the training text corpus for the LLMs.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography" style="font-size:80%;">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib1.2.2.1" style="font-size:80%;">
      [1]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib1.4.1" style="font-size:80%;">
      Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib1.5.1" style="font-size:80%;">
      Attention is all you need, 2017.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib2.2.2.1" style="font-size:80%;">
      [2]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib2.4.1" style="font-size:80%;">
      Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib2.5.1" style="font-size:80%;">
      Bert: Pre-training of deep bidirectional transformers for language
understanding, 2019.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib3.2.2.1" style="font-size:80%;">
      [3]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib3.4.1" style="font-size:80%;">
      Alec Radford and Karthik Narasimhan.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib3.5.1" style="font-size:80%;">
      Improving language understanding by generative pre-training.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib3.6.1" style="font-size:80%;">
      2018.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib4.2.2.1" style="font-size:80%;">
      [4]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.4.1" style="font-size:80%;">
      Alec Radford, Jeff Wu, Rewon Child, David Luan, Dario Amodei, and Ilya
Sutskever.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.5.1" style="font-size:80%;">
      Language models are unsupervised multitask learners.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.6.1" style="font-size:80%;">
      2019.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib5.2.2.1" style="font-size:80%;">
      [5]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib5.4.1" style="font-size:80%;">
      Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan,
Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda
Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan,
Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter,
Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray,
Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford,
Ilya Sutskever, and Dario Amodei.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib5.5.1" style="font-size:80%;">
      Language models are few-shot learners, 2020.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib6.2.2.1" style="font-size:80%;">
      [6]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib6.4.1" style="font-size:80%;">
      OpenAI.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib6.5.1" style="font-size:80%;">
      Gpt-4 technical report, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib7.2.2.1" style="font-size:80%;">
      [7]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib7.4.1" style="font-size:80%;">
      Sébastien Bubeck, Varun Chandrasekaran, Ronen Eldan, Johannes Gehrke, Eric
Horvitz, Ece Kamar, Peter Lee, Yin Tat Lee, Yuanzhi Li, Scott Lundberg,
Harsha Nori, Hamid Palangi, Marco Tulio Ribeiro, and Yi Zhang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib7.5.1" style="font-size:80%;">
      Sparks of artificial general intelligence: Early experiments with
gpt-4, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib8.2.2.1" style="font-size:80%;">
      [8]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib8.4.1" style="font-size:80%;">
      Shu Tay, Paul Ryan, and Anthony C Ryan.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib8.5.1" style="font-size:80%;">
      Systems 1 and 2 thinking processes and cognitive reflection testing
in medical students.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib8.6.1" style="font-size:80%;">
      Canadian Medical Education Journal
     </span>
     <span class="ltx_text" id="bib.bib8.7.2" style="font-size:80%;">
      , 2016:97–103, 11 2016.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib9.2.2.1" style="font-size:80%;">
      [9]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib9.4.1" style="font-size:80%;">
      Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Brian Ichter, Fei Xia,
Ed Chi, Quoc Le, and Denny Zhou.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib9.5.1" style="font-size:80%;">
      Chain-of-thought prompting elicits reasoning in large language
models, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib10.2.2.1" style="font-size:80%;">
      [10]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib10.4.1" style="font-size:80%;">
      Larry Wos, Ross Overbeck, Ewing Lusk, and Jim Boyle.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib10.5.1" style="font-size:80%;">
      Automated Reasoning: Introduction and Applications
     </span>
     <span class="ltx_text" id="bib.bib10.6.2" style="font-size:80%;">
      .
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib10.7.1" style="font-size:80%;">
      Prentice Hall Professional Technical Reference, 1984.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib11.2.2.1" style="font-size:80%;">
      [11]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib11.4.1" style="font-size:80%;">
      Frederick Hayes-Roth, Donald A. Waterman, and Douglas B. Lenat.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib11.5.1" style="font-size:80%;">
      Building Expert Systems
     </span>
     <span class="ltx_text" id="bib.bib11.6.2" style="font-size:80%;">
      .
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib11.7.1" style="font-size:80%;">
      Addison-Wesley Longman Publishing Co., Inc., USA, 1983.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib12.2.2.1" style="font-size:80%;">
      [12]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib12.4.1" style="font-size:80%;">
      Ronald Fagin, Joseph Y. Halpern, Yoram Moses, and Moshe Y. Vardi.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib12.5.1" style="font-size:80%;">
      Reasoning About Knowledge
     </span>
     <span class="ltx_text" id="bib.bib12.6.2" style="font-size:80%;">
      .
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib12.7.1" style="font-size:80%;">
      MIT Press, Cambridge, MA, USA, 2003.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib13.2.2.1" style="font-size:80%;">
      [13]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib13.4.1" style="font-size:80%;">
      Iddo Drori, Sarah Zhang, Reece Shuttleworth, Leonard Tang, Albert Lu, Elizabeth
Ke, Kevin Liu, Linda Chen, Sunny Tran, Newman Cheng, Roman Wang, Nikhil
Singh, Taylor L. Patti, Jayson Lynch, Avi Shporer, Nakul Verma, Eugene Wu,
and Gilbert Strang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib13.5.1" style="font-size:80%;">
      A neural network solves, explains, and generates university math
problems by program synthesis and few-shot learning at human level.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib13.6.1" style="font-size:80%;">
      Proceedings of the National Academy of Sciences
     </span>
     <span class="ltx_text" id="bib.bib13.7.2" style="font-size:80%;">
      , 119(32), aug
2022.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib14.2.2.1" style="font-size:80%;">
      [14]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib14.4.1" style="font-size:80%;">
      Xuezhi Wang, Jason Wei, Dale Schuurmans, Quoc Le, Ed Chi, Sharan Narang,
Aakanksha Chowdhery, and Denny Zhou.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib14.5.1" style="font-size:80%;">
      Self-consistency improves chain of thought reasoning in language
models, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib15.2.2.1" style="font-size:80%;">
      [15]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib15.4.1" style="font-size:80%;">
      Yao Fu, Hao Peng, Ashish Sabharwal, Peter Clark, and Tushar Khot.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib15.5.1" style="font-size:80%;">
      Complexity-based prompting for multi-step reasoning, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib16.2.2.1" style="font-size:80%;">
      [16]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib16.4.1" style="font-size:80%;">
      Eric Zelikman, Yuhuai Wu, Jesse Mu, and Noah D. Goodman.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib16.5.1" style="font-size:80%;">
      Star: Bootstrapping reasoning with reasoning, 2022.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib17.2.2.1" style="font-size:80%;">
      [17]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib17.4.1" style="font-size:80%;">
      Taylor Shin, Yasaman Razeghi, Robert L. Logan IV au2, Eric Wallace, and Sameer
Singh.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib17.5.1" style="font-size:80%;">
      Autoprompt: Eliciting knowledge from language models with
automatically generated prompts, 2020.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib18.2.2.1" style="font-size:80%;">
      [18]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib18.4.1" style="font-size:80%;">
      Xiang Lisa Li and Percy Liang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib18.5.1" style="font-size:80%;">
      Prefix-tuning: Optimizing continuous prompts for generation, 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib19.2.2.1" style="font-size:80%;">
      [19]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib19.4.1" style="font-size:80%;">
      Brian Lester, Rami Al-Rfou, and Noah Constant.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib19.5.1" style="font-size:80%;">
      The power of scale for parameter-efficient prompt tuning, 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib20.2.2.1" style="font-size:80%;">
      [20]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib20.4.1" style="font-size:80%;">
      Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz
Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano,
Christopher Hesse, and John Schulman.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib20.5.1" style="font-size:80%;">
      Training verifiers to solve math word problems, 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib21.2.2.1" style="font-size:80%;">
      [21]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib21.4.1" style="font-size:80%;">
      Yongchao Zhou, Andrei Ioan Muresanu, Ziwen Han, Keiran Paster, Silviu Pitis,
Harris Chan, and Jimmy Ba.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib21.5.1" style="font-size:80%;">
      Large language models are human-level prompt engineers, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib22.2.2.1" style="font-size:80%;">
      [22]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib22.4.1" style="font-size:80%;">
      KaShun Shum, Shizhe Diao, and Tong Zhang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib22.5.1" style="font-size:80%;">
      Automatic prompt augmentation and selection with chain-of-thought
from labeled data, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib23.2.2.1" style="font-size:80%;">
      [23]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib23.4.1" style="font-size:80%;">
      Auto-gpt: An autonomous gpt-4 experiment, 2023.
     </span>
    </span>
    <span class="ltx_bibblock">
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Significant-Gravitas/Auto-GPT" style="font-size:80%;" target="_blank" title="">
      https://github.com/Significant-Gravitas/Auto-GPT
     </a>
     <span class="ltx_text" id="bib.bib23.5.1" style="font-size:80%;">
      .
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib24.2.2.1" style="font-size:80%;">
      [24]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib24.4.1" style="font-size:80%;">
      Pan Lu, Liang Qiu, Kai-Wei Chang, Ying Nian Wu, Song-Chun Zhu, Tanmay
Rajpurohit, Peter Clark, and Ashwin Kalyan.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib24.5.1" style="font-size:80%;">
      Dynamic prompt learning via policy gradient for semi-structured
mathematical reasoning, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib25.2.2.1" style="font-size:80%;">
      [25]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib25.4.1" style="font-size:80%;">
      Zihao Wang, Shaofei Cai, Anji Liu, Xiaojian Ma, and Yitao Liang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib25.5.1" style="font-size:80%;">
      Describe, explain, plan and select: Interactive planning with large
language models enables open-world multi-task agents, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib26.2.2.1" style="font-size:80%;">
      [26]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib26.4.1" style="font-size:80%;">
      Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik Narasimhan,
and Yuan Cao.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib26.5.1" style="font-size:80%;">
      React: Synergizing reasoning and acting in language models, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib27.2.2.1" style="font-size:80%;">
      [27]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib27.4.1" style="font-size:80%;">
      Noah Shinn, Beck Labash, and Ashwin Gopinath.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib27.5.1" style="font-size:80%;">
      Reflexion: an autonomous agent with dynamic memory and
self-reflection, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib28.2.2.1" style="font-size:80%;">
      [28]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib28.4.1" style="font-size:80%;">
      Juris Hartmanis and R. Stearns.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib28.5.1" style="font-size:80%;">
      On the computational complexity of algorithms.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib28.6.1" style="font-size:80%;">
      Transactions of The American Mathematical Society - TRANS AMER
MATH SOC
     </span>
     <span class="ltx_text" id="bib.bib28.7.2" style="font-size:80%;">
      , 117:285–285, 05 1965.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib29.2.2.1" style="font-size:80%;">
      [29]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib29.4.1" style="font-size:80%;">
      Thanh Nguyen, Ngoc Duy Nguyen, and Saeid Nahavandi.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib29.5.1" style="font-size:80%;">
      Deep reinforcement learning for multiagent systems: A review of
challenges, solutions, and applications.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib29.6.1" style="font-size:80%;">
      IEEE Transactions on Cybernetics
     </span>
     <span class="ltx_text" id="bib.bib29.7.2" style="font-size:80%;">
      , PP:1–14, 03 2020.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib30.2.2.1" style="font-size:80%;">
      [30]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib30.4.1" style="font-size:80%;">
      Afshin OroojlooyJadid and Davood Hajinezhad.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib30.5.1" style="font-size:80%;">
      A review of cooperative multi-agent deep reinforcement learning,
2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib31.2.2.1" style="font-size:80%;">
      [31]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib31.4.1" style="font-size:80%;">
      Kaiqing Zhang, Zhuoran Yang, and Tamer Başar.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib31.5.1" style="font-size:80%;">
      Multi-agent reinforcement learning: A selective overview of theories
and algorithms, 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib32.2.2.1" style="font-size:80%;">
      [32]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib32.4.1" style="font-size:80%;">
      Richard S. Sutton, David McAllester, Satinder Singh, and Yishay Mansour.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib32.5.1" style="font-size:80%;">
      Policy gradient methods for reinforcement learning with function
approximation.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib32.6.1" style="font-size:80%;">
      In
     </span>
     <span class="ltx_text ltx_font_italic" id="bib.bib32.7.2" style="font-size:80%;">
      Proceedings of the 12th International Conference on Neural
Information Processing Systems
     </span>
     <span class="ltx_text" id="bib.bib32.8.3" style="font-size:80%;">
      , NIPS’99, page 1057–1063, Cambridge, MA,
USA, 1999. MIT Press.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib33.2.2.1" style="font-size:80%;">
      [33]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib33.4.1" style="font-size:80%;">
      Michael Haythorpe.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib33.5.1" style="font-size:80%;">
      Reducing the generalised sudoku problem to the hamiltonian cycle
problem, 2016.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib34.2.2.1" style="font-size:80%;">
      [34]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib34.4.1" style="font-size:80%;">
      David Silver, Aja Huang, Chris J Maddison, Arthur Guez, Laurent Sifre, George
Van Den Driessche, Julian Schrittwieser, Ioannis Antonoglou, Veda
Panneershelvam, Marc Lanctot, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib34.5.1" style="font-size:80%;">
      Mastering the game of go with deep neural networks and tree search.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib34.6.1" style="font-size:80%;">
      Nature
     </span>
     <span class="ltx_text" id="bib.bib34.7.2" style="font-size:80%;">
      , 529(7587):484–489, 2016.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib35.2.2.1" style="font-size:80%;">
      [35]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib35.4.1" style="font-size:80%;">
      David Silver, Thomas Hubert, Julian Schrittwieser, Ioannis Antonoglou, Matthew
Lai, Arthur Guez, Marc Lanctot, Laurent Sifre, Dharshan Kumaran, Thore
Graepel, Timothy Lillicrap, Karen Simonyan, and Demis Hassabis.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib35.5.1" style="font-size:80%;">
      Mastering chess and shogi by self-play with a general reinforcement
learning algorithm, 2017.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib36.2.2.1" style="font-size:80%;">
      [36]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib36.4.1" style="font-size:80%;">
      Oriol Vinyals, Igor Babuschkin, Wojciech Czarnecki, Michaël Mathieu, Andrew
Dudzik, Junyoung Chung, David Choi, Richard Powell, Timo Ewalds, Petko
Georgiev, Junhyuk Oh, Dan Horgan, Manuel Kroiss, Ivo Danihelka, Aja Huang,
Laurent Sifre, Trevor Cai, John Agapiou, Max Jaderberg, and David Silver.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib36.5.1" style="font-size:80%;">
      Grandmaster level in starcraft ii using multi-agent reinforcement
learning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib36.6.1" style="font-size:80%;">
      Nature
     </span>
     <span class="ltx_text" id="bib.bib36.7.2" style="font-size:80%;">
      , 575, 11 2019.
     </span>
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
</article>
