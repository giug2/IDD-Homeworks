<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1704.05526] Learning to Reason: End-to-End Module Networks for Visual Question Answering</title><meta property="og:description" content="Natural language questions are inherently compositional, and many are most easily answered by reasoning about
their decomposition into modular sub-problems. For example, to answer “is there an equal number of balls
and…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learning to Reason: End-to-End Module Networks for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Learning to Reason: End-to-End Module Networks for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1704.05526">

<!--Generated on Mon Feb 26 19:24:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Learning to Reason: End-to-End Module Networks 
<br class="ltx_break">for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ronghang Hu<sup id="id9.9.id1" class="ltx_sup">1</sup>  Jacob Andreas<sup id="id10.10.id2" class="ltx_sup">1</sup>  Marcus Rohrbach<sup id="id11.11.id3" class="ltx_sup"><span id="id11.11.id3.1" class="ltx_text ltx_font_italic">1,2</span></sup>  Trevor Darrell<sup id="id12.12.id4" class="ltx_sup">1</sup>  Kate Saenko<sup id="id13.13.id5" class="ltx_sup">3</sup> 
<br class="ltx_break"><sup id="id14.14.id6" class="ltx_sup">1</sup>University of California, Berkeley<math id="id7.7.m7.1" class="ltx_Math" alttext="\qquad{}^{2}" display="inline"><semantics id="id7.7.m7.1a"><msup id="id7.7.m7.1.1" xref="id7.7.m7.1.1.cmml"><mi id="id7.7.m7.1.1a" xref="id7.7.m7.1.1.cmml"></mi><mn id="id7.7.m7.1.1.1" xref="id7.7.m7.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id7.7.m7.1b"><apply id="id7.7.m7.1.1.cmml" xref="id7.7.m7.1.1"><cn type="integer" id="id7.7.m7.1.1.1.cmml" xref="id7.7.m7.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.7.m7.1c">\qquad{}^{2}</annotation></semantics></math>Facebook AI Research<math id="id8.8.m8.1" class="ltx_Math" alttext="\qquad{}^{3}" display="inline"><semantics id="id8.8.m8.1a"><msup id="id8.8.m8.1.1" xref="id8.8.m8.1.1.cmml"><mi id="id8.8.m8.1.1a" xref="id8.8.m8.1.1.cmml"></mi><mn id="id8.8.m8.1.1.1" xref="id8.8.m8.1.1.1.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id8.8.m8.1b"><apply id="id8.8.m8.1.1.cmml" xref="id8.8.m8.1.1"><cn type="integer" id="id8.8.m8.1.1.1.cmml" xref="id8.8.m8.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.8.m8.1c">\qquad{}^{3}</annotation></semantics></math>Boston University 
<br class="ltx_break"><span id="id15.15.id7" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{ronghang,jda,trevor,rohrbach}@eecs.berkeley.edu, saenko@bu.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id16.id1" class="ltx_p">Natural language questions are inherently compositional, and many are most easily answered by reasoning about
their decomposition into modular sub-problems. For example, to answer <em id="id16.id1.1" class="ltx_emph ltx_font_italic">“is there an equal number of balls
and boxes?”</em> we can look for balls, look for boxes, count them, and compare the results. The recently proposed
Neural Module Network (NMN) architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> implements this approach to question answering by parsing questions into linguistic substructures and assembling question-specific deep networks from smaller modules that each solve one subtask. However, existing NMN implementations rely on brittle off-the-shelf parsers, and are restricted to the module configurations proposed by these parsers rather than learning them from data. In this paper, we propose End-to-End Module Networks (N2NMNs), which learn to reason by directly predicting instance-specific network layouts without the aid of a parser. Our model learns to generate network <em id="id16.id1.2" class="ltx_emph ltx_font_italic">structures</em> (by imitating expert demonstrations) while simultaneously learning network <em id="id16.id1.3" class="ltx_emph ltx_font_italic">parameters</em> (using the downstream task loss). Experimental results on the new <span id="id16.id1.4" class="ltx_text ltx_font_smallcaps">clevr</span> dataset targeted at compositional question answering show that N2NMNs achieve an error reduction of nearly 50% relative to state-of-the-art attentional approaches, while discovering interpretable network architectures specialized for each question.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/1704.05526/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="166" height="91" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>For each instance, our model predicts a computational expression and a sequence of attentive module parameterizations. It uses these to assemble a concrete network architecture, and then executes the assembled neural module network to output an answer for visual question answering. (The
example shows a real structure predicted by our model, with text attention maps
simplified for clarity.)</figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) requires joint comprehension of images and text. This comprehension often depends on compositional reasoning, for example locating multiple objects in a scene and inspecting their properties or comparing them to one another (Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). While conventional deep networks have shown promising VQA performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, there is limited evidence that they are capable of explicit compositional reasoning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Much of the success of state-of-the-art approaches to VQA instead comes from their ability to discover statistical biases in the data distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. And to the extent that such approaches are capable of more sophisticated reasoning, their monolithic structure makes these behaviors difficult to understand and explain. Additionally, they rely on the same non-modular network structure for all input questions.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In this paper, we propose <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">End-to-End Module Networks (N2NMNs)</span>: a class of models capable of predicting novel modular network architectures directly from textual input and applying them to images in order to solve question answering tasks. In contrast to previous work, our approach learns to both parse the language into linguistic structures <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">and</span> compose them into appropriate layouts.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The present work synthesizes and extends two recent modular architectures for visual problem solving. Standard neural module networks (NMNs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> already provide a technique for constructing dynamic network structures from collections of composable modules. However, previous work relies on an external parser to process input text and obtain the module layout. This is a serious limitation, because off-the-shelf language parsers are not designed for language and vision tasks and must therefore be modified using handcrafted rules that often fail to predict valid layouts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Meanwhile, the compositional modular network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed for grounding referring expressions in images does not need a parser, but is restricted to a fixed (<span id="S1.p3.1.1" class="ltx_text ltx_font_italic">subject, relationship, object</span>) structure. None of the existing methods can learn to predict a suitable structure for every input in an end-to-end manner.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our contributions are 1) a method for learning a layout policy that dynamically predicts a network structure for each instance, without the aid of external linguistic resources at test time and 2) a new module parameterization that uses a soft attention over question words rather than hard-coded word assignments. Experiments show that our model is capable of directly predicting expert-provided network layouts with near-perfect accuracy, and even improving on expert-designed networks after a period of exploration. We obtain state-of-the-art results on the recently released <span id="S1.p4.1.1" class="ltx_text ltx_font_smallcaps">clevr</span> dataset by a wide margin.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<figure id="S2.F2" class="ltx_figure"><img src="/html/1704.05526/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="304" height="117" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Model overview. Our approach first computes a deep representation
of the question, and uses this as an input to a layout-prediction policy
implemented with a recurrent neural network. This policy emits both a
sequence of <em id="S2.F2.4.1" class="ltx_emph ltx_font_italic">structural</em> actions, specifying a template for a modular
neural network in reverse Polish notation, and a sequence of <em id="S2.F2.5.2" class="ltx_emph ltx_font_italic">attentive</em> actions, extracting parameters for these neural modules from
the input sentence. These two sequences are passed to a <em id="S2.F2.6.3" class="ltx_emph ltx_font_italic">network builder</em>, which dynamically instantiates an appropriate neural network
and applies it to the input image to obtain an answer.</figcaption>
</figure>
<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Neural module networks.</span> The recently proposed neural module network (NMN) architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>—a general class of recursive neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>—provides a framework for constructing deep networks with dynamic computational structure. In an NMN model, every input is associated with a <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">layout</em> that provides a template for assembling an instance-specific network from a collection of shallow network fragments called <em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">modules</em>. These modules can be jointly trained across multiple structures to provide reusable, compositional behaviors. Existing work on NMNs has focused on natural language question answering applications, in which a linguistic analysis of the question is used to generate the layout, and the resulting network applied to some world representation (either an image or knowledge base) to produce an answer. The earliest work on NMNs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> used fixed rule-based layouts generated from dependency parses <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. Later work on “dynamic” module networks (D-NMNs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> incorporated a limited form of layout prediction by learning to rerank a list of three to ten candidates, again generated by rearranging modules predicted by a dependency parse. Like D-NMNs, the present work attempts to learn an optimal layout predictor jointly with module behaviors themselves. Here, however, we tackle a considerably more challenging prediction problem: our approach learns to optimize over the full space of network layouts rather than acting as a reranker, and requires no parser at evaluation time.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">We additionally modify the representation of the assembled module networks themselves: where <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> parameterized individual modules with a fixed embedding supplied by the parser, here we <em id="S2.p2.1.1" class="ltx_emph ltx_font_italic">predict</em> these parameters jointly with network structures using a soft attention mechanism. This parameterization resembles the approach used in the “compositional modular network” architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> for grounding referential expressions. However, the model proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> is restricted to a fixed layout structure of (subject, relationship, object) for every referential expression, and includes no structure search.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Learning network architectures.</span> More generally than these dynamic / modular approaches, a long line of research focuses on generic methods for automatically discovering neural network architectures from data. Past work includes techniques for optimizing over the space of architectures using evolutionary algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, Bayesian methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, and reinforcement learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. The last of these is most closely related to our approach in this paper: both learn a controller RNN to output a network structure, train a neural network with the generated structure, and use the accuracy of the generated network to optimize the controller RNN. A key difference between <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and the layout policy optimization in our work is that <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> learns a <span id="S2.p3.1.2" class="ltx_text ltx_font_italic">fixed</span> layout (network architecture) that is applied to every instance, while our model learns a layout policy that <span id="S2.p3.1.3" class="ltx_text ltx_font_italic">dynamically</span> predicts a specific layout tailored to each individual input example.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Visual question answering.</span> The visual question answering task <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> is generally motivated as a test to measure the capacity of deep models to <em id="S2.p4.1.2" class="ltx_emph ltx_font_italic">reason</em> about linguistic and visual inputs jointly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Recent years have seen a proliferation of datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and approaches, including models based on differentiable memory <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, dynamic prediction of question-specific computations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and core improvements to the implementation of the multi-modal representation and attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Together, these approaches have produced substantial gains over the initial baseline results published with
the first VQA datasets.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">It has been less clear, however, that these improvements correspond to an improvement in the <em id="S2.p5.1.1" class="ltx_emph ltx_font_italic">reasoning</em> abilities of models. Recent work has found that it is possible to do quite well on many visual QA problems by simply memorizing statistics about question / answer pairs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> (suggesting that limited visual reasoning is involved), and that models with bag-of-words text representations perform competitively against more sophisticated approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> (suggesting that limited linguistic
compositionality is involved). To address this concern, newer visual question answering datasets have focused on exploring specific phenomena in compositionality and generalization; examples include the <span id="S2.p5.1.2" class="ltx_text ltx_font_smallcaps">shapes</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, the VQAv2 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and the <span id="S2.p5.1.3" class="ltx_text ltx_font_smallcaps">clevr</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. The last of these appears to present the greatest challenges to standard VQA approaches and the hardest reasoning problems in general.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p">Most previous work on this task other than NMN uses a fixed inference structure to answer every question. However, the optimal reasoning procedure may vary greatly from question to question, so it is desirable to have inference structures that are specific to the input question. Concurrent with our work, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> proposes a similar model to ours. Our model is different from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> in that we use a set of specialized modules with soft attention mechanism to provide textual parameters for each module, while <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> uses a generic module implementation with textual parameters hard-coded in module instantiation.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>End-to-End Module Networks</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We propose End-to-End Module Networks (N2NMNs) to address compositionality in visual reasoning tasks. Our model consists of two main components: a set of co-attentive neural modules that provide parameterized functions for solving sub-tasks, and a layout policy to predict a question-specific layout from which a neural network is dynamically assembled. An overview of our model is shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related work ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">Given an input question, such as <em id="S3.p2.1.1" class="ltx_emph ltx_font_italic">how many other things are there of the same size as the matte ball?</em>, our layout policy first predicts a coarse functional expression like <span id="S3.p2.1.2" class="ltx_text ltx_font_typewriter">count(relocate(find())</span> that describes the structure of the desired computation, Next, some subset of function applications within this expression (here <span id="S3.p2.1.3" class="ltx_text ltx_font_typewriter">relocate</span> and <span id="S3.p2.1.4" class="ltx_text ltx_font_typewriter">find</span>) receive parameter vectors predicted from text (here perhaps vector representations of <em id="S3.p2.1.5" class="ltx_emph ltx_font_italic">matte ball</em> and <em id="S3.p2.1.6" class="ltx_emph ltx_font_italic">size</em>, respectively). Then a network is assembled with the modules according to this layout expression to output an answer.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">We describe the implementation details of each neural module <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="f_{m}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">f</mi><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑓</ci><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">f_{m}</annotation></semantics></math> in Sec. <a href="#S3.SS1" title="3.1 Attentional neural modules ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>, and our layout policy in Sec. <a href="#S3.SS2" title="3.2 Layout policy with sequence-to-sequence RNN ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>. In Sec. <a href="#S3.SS3" title="3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>, we present a reinforcement learning approach to jointly optimize the neural modules and the layout policy.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Attentional neural modules</h3>

<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.27" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.27.28.1" class="ltx_tr">
<th id="S3.T1.27.28.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="S3.T1.27.28.1.1.1" class="ltx_text" style="font-size:90%;">Module name</span></th>
<th id="S3.T1.27.28.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S3.T1.27.28.1.2.1" class="ltx_text" style="font-size:90%;">Att-inputs</span></th>
<th id="S3.T1.27.28.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S3.T1.27.28.1.3.1" class="ltx_text" style="font-size:90%;">Features</span></th>
<th id="S3.T1.27.28.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S3.T1.27.28.1.4.1" class="ltx_text" style="font-size:90%;">Output</span></th>
<th id="S3.T1.27.28.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S3.T1.27.28.1.5.1" class="ltx_text" style="font-size:90%;">Implementation details</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.3.3" class="ltx_tr">
<td id="S3.T1.3.3.4" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="S3.T1.3.3.4.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">find</span></td>
<td id="S3.T1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.3.3.5.1" class="ltx_text" style="font-size:90%;">(none)</span></td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><msub id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.m1.1.1.2.cmml">x</mi><mrow id="S3.T1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.1.1.1.m1.1.1.3.2" xref="S3.T1.1.1.1.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.1.1.1.m1.1.1.3.1" xref="S3.T1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.1.1.1.m1.1.1.3.3" xref="S3.T1.1.1.1.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.1.1.1.m1.1.1.3.1a" xref="S3.T1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.1.1.1.m1.1.1.3.4" xref="S3.T1.1.1.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.1.2">𝑥</ci><apply id="S3.T1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3"><times id="S3.T1.1.1.1.m1.1.1.3.1.cmml" xref="S3.T1.1.1.1.m1.1.1.3.1"></times><ci id="S3.T1.1.1.1.m1.1.1.3.2.cmml" xref="S3.T1.1.1.1.m1.1.1.3.2">𝑣</ci><ci id="S3.T1.1.1.1.m1.1.1.3.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3.3">𝑖</ci><ci id="S3.T1.1.1.1.m1.1.1.3.4.cmml" xref="S3.T1.1.1.1.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">x_{vis}</annotation></semantics></math><span id="S3.T1.2.2.2.1" class="ltx_text" style="font-size:90%;">, </span><math id="S3.T1.2.2.2.m2.1" class="ltx_Math" alttext="x_{txt}" display="inline"><semantics id="S3.T1.2.2.2.m2.1a"><msub id="S3.T1.2.2.2.m2.1.1" xref="S3.T1.2.2.2.m2.1.1.cmml"><mi mathsize="90%" id="S3.T1.2.2.2.m2.1.1.2" xref="S3.T1.2.2.2.m2.1.1.2.cmml">x</mi><mrow id="S3.T1.2.2.2.m2.1.1.3" xref="S3.T1.2.2.2.m2.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.2.2.2.m2.1.1.3.2" xref="S3.T1.2.2.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.2.2.2.m2.1.1.3.1" xref="S3.T1.2.2.2.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.2.2.2.m2.1.1.3.3" xref="S3.T1.2.2.2.m2.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.2.2.2.m2.1.1.3.1a" xref="S3.T1.2.2.2.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.2.2.2.m2.1.1.3.4" xref="S3.T1.2.2.2.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m2.1b"><apply id="S3.T1.2.2.2.m2.1.1.cmml" xref="S3.T1.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.2.2.2.m2.1.1.1.cmml" xref="S3.T1.2.2.2.m2.1.1">subscript</csymbol><ci id="S3.T1.2.2.2.m2.1.1.2.cmml" xref="S3.T1.2.2.2.m2.1.1.2">𝑥</ci><apply id="S3.T1.2.2.2.m2.1.1.3.cmml" xref="S3.T1.2.2.2.m2.1.1.3"><times id="S3.T1.2.2.2.m2.1.1.3.1.cmml" xref="S3.T1.2.2.2.m2.1.1.3.1"></times><ci id="S3.T1.2.2.2.m2.1.1.3.2.cmml" xref="S3.T1.2.2.2.m2.1.1.3.2">𝑡</ci><ci id="S3.T1.2.2.2.m2.1.1.3.3.cmml" xref="S3.T1.2.2.2.m2.1.1.3.3">𝑥</ci><ci id="S3.T1.2.2.2.m2.1.1.3.4.cmml" xref="S3.T1.2.2.2.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m2.1c">x_{txt}</annotation></semantics></math>
</td>
<td id="S3.T1.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.3.3.6.1" class="ltx_text" style="font-size:90%;">att</span></td>
<td id="S3.T1.3.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="S3.T1.3.3.3.m1.1" class="ltx_Math" alttext="a_{out}=\mathrm{conv_{2}}\left(\mathrm{conv_{1}}(x_{vis})\odot Wx_{txt}\right)" display="inline"><semantics id="S3.T1.3.3.3.m1.1a"><mrow id="S3.T1.3.3.3.m1.1.1" xref="S3.T1.3.3.3.m1.1.1.cmml"><msub id="S3.T1.3.3.3.m1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.3.2" xref="S3.T1.3.3.3.m1.1.1.3.2.cmml">a</mi><mrow id="S3.T1.3.3.3.m1.1.1.3.3" xref="S3.T1.3.3.3.m1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.3.3.2" xref="S3.T1.3.3.3.m1.1.1.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.3.3.1" xref="S3.T1.3.3.3.m1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.3.3.3" xref="S3.T1.3.3.3.m1.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.3.3.1a" xref="S3.T1.3.3.3.m1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.3.3.4" xref="S3.T1.3.3.3.m1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo mathsize="90%" id="S3.T1.3.3.3.m1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.2.cmml">=</mo><mrow id="S3.T1.3.3.3.m1.1.1.1" xref="S3.T1.3.3.3.m1.1.1.1.cmml"><msub id="S3.T1.3.3.3.m1.1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.3.2" xref="S3.T1.3.3.3.m1.1.1.1.3.2.cmml">conv</mi><mn mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.3.3" xref="S3.T1.3.3.3.m1.1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.3.3.3.m1.1.1.1.1.1" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.cmml"><mo id="S3.T1.3.3.3.m1.1.1.1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.3.3.3.m1.1.1.1.1.1.1" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.2.cmml">conv</mi><mn mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.3.cmml">W</mi></mrow><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.2" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.1" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.1a" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.4" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.T1.3.3.3.m1.1.1.1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.m1.1b"><apply id="S3.T1.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1"><eq id="S3.T1.3.3.3.m1.1.1.2.cmml" xref="S3.T1.3.3.3.m1.1.1.2"></eq><apply id="S3.T1.3.3.3.m1.1.1.3.cmml" xref="S3.T1.3.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.3.3.3.m1.1.1.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.3">subscript</csymbol><ci id="S3.T1.3.3.3.m1.1.1.3.2.cmml" xref="S3.T1.3.3.3.m1.1.1.3.2">𝑎</ci><apply id="S3.T1.3.3.3.m1.1.1.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.3.3"><times id="S3.T1.3.3.3.m1.1.1.3.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.3.3.1"></times><ci id="S3.T1.3.3.3.m1.1.1.3.3.2.cmml" xref="S3.T1.3.3.3.m1.1.1.3.3.2">𝑜</ci><ci id="S3.T1.3.3.3.m1.1.1.3.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.3.3.3">𝑢</ci><ci id="S3.T1.3.3.3.m1.1.1.3.3.4.cmml" xref="S3.T1.3.3.3.m1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S3.T1.3.3.3.m1.1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1"><times id="S3.T1.3.3.3.m1.1.1.1.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.2"></times><apply id="S3.T1.3.3.3.m1.1.1.1.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.3.3.3.m1.1.1.1.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.3">subscript</csymbol><ci id="S3.T1.3.3.3.m1.1.1.1.3.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.3.2">conv</ci><cn type="integer" id="S3.T1.3.3.3.m1.1.1.1.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.3.3">2</cn></apply><apply id="S3.T1.3.3.3.m1.1.1.1.1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1"><times id="S3.T1.3.3.3.m1.1.1.1.1.1.1.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.2"></times><apply id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1"><times id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.2">conv</ci><cn type="integer" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply></apply><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.1.3">𝑊</ci></apply><apply id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3"><times id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.3">𝑥</ci><ci id="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.T1.3.3.3.m1.1.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.m1.1c">a_{out}=\mathrm{conv_{2}}\left(\mathrm{conv_{1}}(x_{vis})\odot Wx_{txt}\right)</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.7.7" class="ltx_tr">
<td id="S3.T1.7.7.5" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S3.T1.7.7.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">relocate</span></td>
<td id="S3.T1.4.4.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T1.4.4.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.T1.4.4.1.m1.1a"><mi mathsize="90%" id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b"><ci id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">a</annotation></semantics></math></td>
<td id="S3.T1.6.6.3" class="ltx_td ltx_align_center ltx_border_r">
<math id="S3.T1.5.5.2.m1.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S3.T1.5.5.2.m1.1a"><msub id="S3.T1.5.5.2.m1.1.1" xref="S3.T1.5.5.2.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.5.5.2.m1.1.1.2" xref="S3.T1.5.5.2.m1.1.1.2.cmml">x</mi><mrow id="S3.T1.5.5.2.m1.1.1.3" xref="S3.T1.5.5.2.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.5.5.2.m1.1.1.3.2" xref="S3.T1.5.5.2.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.5.5.2.m1.1.1.3.1" xref="S3.T1.5.5.2.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.5.5.2.m1.1.1.3.3" xref="S3.T1.5.5.2.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.5.5.2.m1.1.1.3.1a" xref="S3.T1.5.5.2.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.5.5.2.m1.1.1.3.4" xref="S3.T1.5.5.2.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.2.m1.1b"><apply id="S3.T1.5.5.2.m1.1.1.cmml" xref="S3.T1.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.5.2.m1.1.1.1.cmml" xref="S3.T1.5.5.2.m1.1.1">subscript</csymbol><ci id="S3.T1.5.5.2.m1.1.1.2.cmml" xref="S3.T1.5.5.2.m1.1.1.2">𝑥</ci><apply id="S3.T1.5.5.2.m1.1.1.3.cmml" xref="S3.T1.5.5.2.m1.1.1.3"><times id="S3.T1.5.5.2.m1.1.1.3.1.cmml" xref="S3.T1.5.5.2.m1.1.1.3.1"></times><ci id="S3.T1.5.5.2.m1.1.1.3.2.cmml" xref="S3.T1.5.5.2.m1.1.1.3.2">𝑣</ci><ci id="S3.T1.5.5.2.m1.1.1.3.3.cmml" xref="S3.T1.5.5.2.m1.1.1.3.3">𝑖</ci><ci id="S3.T1.5.5.2.m1.1.1.3.4.cmml" xref="S3.T1.5.5.2.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.2.m1.1c">x_{vis}</annotation></semantics></math><span id="S3.T1.6.6.3.1" class="ltx_text" style="font-size:90%;">, </span><math id="S3.T1.6.6.3.m2.1" class="ltx_Math" alttext="x_{txt}" display="inline"><semantics id="S3.T1.6.6.3.m2.1a"><msub id="S3.T1.6.6.3.m2.1.1" xref="S3.T1.6.6.3.m2.1.1.cmml"><mi mathsize="90%" id="S3.T1.6.6.3.m2.1.1.2" xref="S3.T1.6.6.3.m2.1.1.2.cmml">x</mi><mrow id="S3.T1.6.6.3.m2.1.1.3" xref="S3.T1.6.6.3.m2.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.6.6.3.m2.1.1.3.2" xref="S3.T1.6.6.3.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.6.6.3.m2.1.1.3.1" xref="S3.T1.6.6.3.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.6.6.3.m2.1.1.3.3" xref="S3.T1.6.6.3.m2.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.6.6.3.m2.1.1.3.1a" xref="S3.T1.6.6.3.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.6.6.3.m2.1.1.3.4" xref="S3.T1.6.6.3.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.3.m2.1b"><apply id="S3.T1.6.6.3.m2.1.1.cmml" xref="S3.T1.6.6.3.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.6.6.3.m2.1.1.1.cmml" xref="S3.T1.6.6.3.m2.1.1">subscript</csymbol><ci id="S3.T1.6.6.3.m2.1.1.2.cmml" xref="S3.T1.6.6.3.m2.1.1.2">𝑥</ci><apply id="S3.T1.6.6.3.m2.1.1.3.cmml" xref="S3.T1.6.6.3.m2.1.1.3"><times id="S3.T1.6.6.3.m2.1.1.3.1.cmml" xref="S3.T1.6.6.3.m2.1.1.3.1"></times><ci id="S3.T1.6.6.3.m2.1.1.3.2.cmml" xref="S3.T1.6.6.3.m2.1.1.3.2">𝑡</ci><ci id="S3.T1.6.6.3.m2.1.1.3.3.cmml" xref="S3.T1.6.6.3.m2.1.1.3.3">𝑥</ci><ci id="S3.T1.6.6.3.m2.1.1.3.4.cmml" xref="S3.T1.6.6.3.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.3.m2.1c">x_{txt}</annotation></semantics></math>
</td>
<td id="S3.T1.7.7.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.7.7.6.1" class="ltx_text" style="font-size:90%;">att</span></td>
<td id="S3.T1.7.7.4" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.7.7.4.m1.1" class="ltx_Math" alttext="a_{out}=\mathrm{conv_{2}}\left(\mathrm{conv_{1}}(x_{vis})\odot W_{1}\mathrm{sum}(a\odot x_{vis})\odot W_{2}x_{txt}\right)" display="inline"><semantics id="S3.T1.7.7.4.m1.1a"><mrow id="S3.T1.7.7.4.m1.1.1" xref="S3.T1.7.7.4.m1.1.1.cmml"><msub id="S3.T1.7.7.4.m1.1.1.3" xref="S3.T1.7.7.4.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.3.2" xref="S3.T1.7.7.4.m1.1.1.3.2.cmml">a</mi><mrow id="S3.T1.7.7.4.m1.1.1.3.3" xref="S3.T1.7.7.4.m1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.3.3.2" xref="S3.T1.7.7.4.m1.1.1.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.3.3.1" xref="S3.T1.7.7.4.m1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.3.3.3" xref="S3.T1.7.7.4.m1.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.3.3.1a" xref="S3.T1.7.7.4.m1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.3.3.4" xref="S3.T1.7.7.4.m1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo mathsize="90%" id="S3.T1.7.7.4.m1.1.1.2" xref="S3.T1.7.7.4.m1.1.1.2.cmml">=</mo><mrow id="S3.T1.7.7.4.m1.1.1.1" xref="S3.T1.7.7.4.m1.1.1.1.cmml"><msub id="S3.T1.7.7.4.m1.1.1.1.3" xref="S3.T1.7.7.4.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.3.2" xref="S3.T1.7.7.4.m1.1.1.1.3.2.cmml">conv</mi><mn mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.3.3" xref="S3.T1.7.7.4.m1.1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.2" xref="S3.T1.7.7.4.m1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.cmml"><mo id="S3.T1.7.7.4.m1.1.1.1.1.1.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.cmml"><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.cmml"><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.cmml"><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">conv</mi><mn mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.3.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.4" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.4.cmml">sum</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.3a" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml">a</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">⊙</mo><msub id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.2.cmml">x</mi><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1a" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.4" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.4.cmml">s</mi></mrow></msub></mrow><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.3.cmml">⊙</mo><msub id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.3.cmml">2</mn></msub></mrow><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.3.cmml">​</mo><msub id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.2.cmml">x</mi><mrow id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.cmml"><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.2" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.1" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.1a" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.4" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.T1.7.7.4.m1.1.1.1.1.1.3" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.4.m1.1b"><apply id="S3.T1.7.7.4.m1.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1"><eq id="S3.T1.7.7.4.m1.1.1.2.cmml" xref="S3.T1.7.7.4.m1.1.1.2"></eq><apply id="S3.T1.7.7.4.m1.1.1.3.cmml" xref="S3.T1.7.7.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.7.7.4.m1.1.1.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.3">subscript</csymbol><ci id="S3.T1.7.7.4.m1.1.1.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.3.2">𝑎</ci><apply id="S3.T1.7.7.4.m1.1.1.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.3.3"><times id="S3.T1.7.7.4.m1.1.1.3.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.3.3.1"></times><ci id="S3.T1.7.7.4.m1.1.1.3.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.3.3.2">𝑜</ci><ci id="S3.T1.7.7.4.m1.1.1.3.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.3.3.3">𝑢</ci><ci id="S3.T1.7.7.4.m1.1.1.3.3.4.cmml" xref="S3.T1.7.7.4.m1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S3.T1.7.7.4.m1.1.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1"><times id="S3.T1.7.7.4.m1.1.1.1.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.2"></times><apply id="S3.T1.7.7.4.m1.1.1.1.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.7.7.4.m1.1.1.1.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.3">subscript</csymbol><ci id="S3.T1.7.7.4.m1.1.1.1.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.3.2">conv</ci><cn type="integer" id="S3.T1.7.7.4.m1.1.1.1.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.3.3">2</cn></apply><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1"><times id="S3.T1.7.7.4.m1.1.1.1.1.1.1.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.3"></times><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.3">direct-product</csymbol><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2"><times id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.3"></times><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.2">conv</ci><cn type="integer" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply></apply><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.4.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.4">sum</ci><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="latexml" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.1">direct-product</csymbol><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.2">𝑎</ci><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.2">𝑥</ci><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3"><times id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1"></times><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.2">𝑣</ci><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.3">𝑖</ci><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.4.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.4">𝑠</ci></apply></apply></apply></apply><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.2">𝑊</ci><cn type="integer" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.2.4.3">2</cn></apply></apply><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.2">𝑥</ci><apply id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3"><times id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.1"></times><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.2">𝑡</ci><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.3">𝑥</ci><ci id="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.4.cmml" xref="S3.T1.7.7.4.m1.1.1.1.1.1.1.4.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.4.m1.1c">a_{out}=\mathrm{conv_{2}}\left(\mathrm{conv_{1}}(x_{vis})\odot W_{1}\mathrm{sum}(a\odot x_{vis})\odot W_{2}x_{txt}\right)</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.9.9" class="ltx_tr">
<td id="S3.T1.9.9.3" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S3.T1.9.9.3.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">and</span></td>
<td id="S3.T1.8.8.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T1.8.8.1.m1.2" class="ltx_Math" alttext="a_{1},a_{2}" display="inline"><semantics id="S3.T1.8.8.1.m1.2a"><mrow id="S3.T1.8.8.1.m1.2.2.2" xref="S3.T1.8.8.1.m1.2.2.3.cmml"><msub id="S3.T1.8.8.1.m1.1.1.1.1" xref="S3.T1.8.8.1.m1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.8.8.1.m1.1.1.1.1.2" xref="S3.T1.8.8.1.m1.1.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.8.8.1.m1.1.1.1.1.3" xref="S3.T1.8.8.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S3.T1.8.8.1.m1.2.2.2.3" xref="S3.T1.8.8.1.m1.2.2.3.cmml">,</mo><msub id="S3.T1.8.8.1.m1.2.2.2.2" xref="S3.T1.8.8.1.m1.2.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.8.8.1.m1.2.2.2.2.2" xref="S3.T1.8.8.1.m1.2.2.2.2.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.8.8.1.m1.2.2.2.2.3" xref="S3.T1.8.8.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.1.m1.2b"><list id="S3.T1.8.8.1.m1.2.2.3.cmml" xref="S3.T1.8.8.1.m1.2.2.2"><apply id="S3.T1.8.8.1.m1.1.1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.1.1.1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.8.8.1.m1.1.1.1.1.2.cmml" xref="S3.T1.8.8.1.m1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.T1.8.8.1.m1.1.1.1.1.3.cmml" xref="S3.T1.8.8.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.8.8.1.m1.2.2.2.2.cmml" xref="S3.T1.8.8.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.2.2.2.2.1.cmml" xref="S3.T1.8.8.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.8.8.1.m1.2.2.2.2.2.cmml" xref="S3.T1.8.8.1.m1.2.2.2.2.2">𝑎</ci><cn type="integer" id="S3.T1.8.8.1.m1.2.2.2.2.3.cmml" xref="S3.T1.8.8.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.1.m1.2c">a_{1},a_{2}</annotation></semantics></math></td>
<td id="S3.T1.9.9.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.9.9.4.1" class="ltx_text" style="font-size:90%;">(none)</span></td>
<td id="S3.T1.9.9.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.9.9.5.1" class="ltx_text" style="font-size:90%;">att</span></td>
<td id="S3.T1.9.9.2" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.9.9.2.m1.2" class="ltx_Math" alttext="a_{out}=\mathrm{minimum}(a_{1},a_{2})" display="inline"><semantics id="S3.T1.9.9.2.m1.2a"><mrow id="S3.T1.9.9.2.m1.2.2" xref="S3.T1.9.9.2.m1.2.2.cmml"><msub id="S3.T1.9.9.2.m1.2.2.4" xref="S3.T1.9.9.2.m1.2.2.4.cmml"><mi mathsize="90%" id="S3.T1.9.9.2.m1.2.2.4.2" xref="S3.T1.9.9.2.m1.2.2.4.2.cmml">a</mi><mrow id="S3.T1.9.9.2.m1.2.2.4.3" xref="S3.T1.9.9.2.m1.2.2.4.3.cmml"><mi mathsize="90%" id="S3.T1.9.9.2.m1.2.2.4.3.2" xref="S3.T1.9.9.2.m1.2.2.4.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.9.9.2.m1.2.2.4.3.1" xref="S3.T1.9.9.2.m1.2.2.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.9.9.2.m1.2.2.4.3.3" xref="S3.T1.9.9.2.m1.2.2.4.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.T1.9.9.2.m1.2.2.4.3.1a" xref="S3.T1.9.9.2.m1.2.2.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.9.9.2.m1.2.2.4.3.4" xref="S3.T1.9.9.2.m1.2.2.4.3.4.cmml">t</mi></mrow></msub><mo mathsize="90%" id="S3.T1.9.9.2.m1.2.2.3" xref="S3.T1.9.9.2.m1.2.2.3.cmml">=</mo><mrow id="S3.T1.9.9.2.m1.2.2.2" xref="S3.T1.9.9.2.m1.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.9.9.2.m1.2.2.2.4" xref="S3.T1.9.9.2.m1.2.2.2.4.cmml">minimum</mi><mo lspace="0em" rspace="0em" id="S3.T1.9.9.2.m1.2.2.2.3" xref="S3.T1.9.9.2.m1.2.2.2.3.cmml">​</mo><mrow id="S3.T1.9.9.2.m1.2.2.2.2.2" xref="S3.T1.9.9.2.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.9.9.2.m1.2.2.2.2.2.3" xref="S3.T1.9.9.2.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.T1.9.9.2.m1.1.1.1.1.1.1" xref="S3.T1.9.9.2.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.9.9.2.m1.1.1.1.1.1.1.2" xref="S3.T1.9.9.2.m1.1.1.1.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.9.9.2.m1.1.1.1.1.1.1.3" xref="S3.T1.9.9.2.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S3.T1.9.9.2.m1.2.2.2.2.2.4" xref="S3.T1.9.9.2.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.T1.9.9.2.m1.2.2.2.2.2.2" xref="S3.T1.9.9.2.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.9.9.2.m1.2.2.2.2.2.2.2" xref="S3.T1.9.9.2.m1.2.2.2.2.2.2.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.9.9.2.m1.2.2.2.2.2.2.3" xref="S3.T1.9.9.2.m1.2.2.2.2.2.2.3.cmml">2</mn></msub><mo maxsize="90%" minsize="90%" id="S3.T1.9.9.2.m1.2.2.2.2.2.5" xref="S3.T1.9.9.2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.2.m1.2b"><apply id="S3.T1.9.9.2.m1.2.2.cmml" xref="S3.T1.9.9.2.m1.2.2"><eq id="S3.T1.9.9.2.m1.2.2.3.cmml" xref="S3.T1.9.9.2.m1.2.2.3"></eq><apply id="S3.T1.9.9.2.m1.2.2.4.cmml" xref="S3.T1.9.9.2.m1.2.2.4"><csymbol cd="ambiguous" id="S3.T1.9.9.2.m1.2.2.4.1.cmml" xref="S3.T1.9.9.2.m1.2.2.4">subscript</csymbol><ci id="S3.T1.9.9.2.m1.2.2.4.2.cmml" xref="S3.T1.9.9.2.m1.2.2.4.2">𝑎</ci><apply id="S3.T1.9.9.2.m1.2.2.4.3.cmml" xref="S3.T1.9.9.2.m1.2.2.4.3"><times id="S3.T1.9.9.2.m1.2.2.4.3.1.cmml" xref="S3.T1.9.9.2.m1.2.2.4.3.1"></times><ci id="S3.T1.9.9.2.m1.2.2.4.3.2.cmml" xref="S3.T1.9.9.2.m1.2.2.4.3.2">𝑜</ci><ci id="S3.T1.9.9.2.m1.2.2.4.3.3.cmml" xref="S3.T1.9.9.2.m1.2.2.4.3.3">𝑢</ci><ci id="S3.T1.9.9.2.m1.2.2.4.3.4.cmml" xref="S3.T1.9.9.2.m1.2.2.4.3.4">𝑡</ci></apply></apply><apply id="S3.T1.9.9.2.m1.2.2.2.cmml" xref="S3.T1.9.9.2.m1.2.2.2"><times id="S3.T1.9.9.2.m1.2.2.2.3.cmml" xref="S3.T1.9.9.2.m1.2.2.2.3"></times><ci id="S3.T1.9.9.2.m1.2.2.2.4.cmml" xref="S3.T1.9.9.2.m1.2.2.2.4">minimum</ci><interval closure="open" id="S3.T1.9.9.2.m1.2.2.2.2.3.cmml" xref="S3.T1.9.9.2.m1.2.2.2.2.2"><apply id="S3.T1.9.9.2.m1.1.1.1.1.1.1.cmml" xref="S3.T1.9.9.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.9.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.T1.9.9.2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.T1.9.9.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.T1.9.9.2.m1.1.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.T1.9.9.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.T1.9.9.2.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.9.9.2.m1.2.2.2.2.2.2.cmml" xref="S3.T1.9.9.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.9.9.2.m1.2.2.2.2.2.2.1.cmml" xref="S3.T1.9.9.2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.T1.9.9.2.m1.2.2.2.2.2.2.2.cmml" xref="S3.T1.9.9.2.m1.2.2.2.2.2.2.2">𝑎</ci><cn type="integer" id="S3.T1.9.9.2.m1.2.2.2.2.2.2.3.cmml" xref="S3.T1.9.9.2.m1.2.2.2.2.2.2.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.2.m1.2c">a_{out}=\mathrm{minimum}(a_{1},a_{2})</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.11.11" class="ltx_tr">
<td id="S3.T1.11.11.3" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S3.T1.11.11.3.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">or</span></td>
<td id="S3.T1.10.10.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T1.10.10.1.m1.2" class="ltx_Math" alttext="a_{1},a_{2}" display="inline"><semantics id="S3.T1.10.10.1.m1.2a"><mrow id="S3.T1.10.10.1.m1.2.2.2" xref="S3.T1.10.10.1.m1.2.2.3.cmml"><msub id="S3.T1.10.10.1.m1.1.1.1.1" xref="S3.T1.10.10.1.m1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.10.10.1.m1.1.1.1.1.2" xref="S3.T1.10.10.1.m1.1.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.10.10.1.m1.1.1.1.1.3" xref="S3.T1.10.10.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S3.T1.10.10.1.m1.2.2.2.3" xref="S3.T1.10.10.1.m1.2.2.3.cmml">,</mo><msub id="S3.T1.10.10.1.m1.2.2.2.2" xref="S3.T1.10.10.1.m1.2.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.10.10.1.m1.2.2.2.2.2" xref="S3.T1.10.10.1.m1.2.2.2.2.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.10.10.1.m1.2.2.2.2.3" xref="S3.T1.10.10.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.2b"><list id="S3.T1.10.10.1.m1.2.2.3.cmml" xref="S3.T1.10.10.1.m1.2.2.2"><apply id="S3.T1.10.10.1.m1.1.1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.1.m1.1.1.1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.10.10.1.m1.1.1.1.1.2.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.T1.10.10.1.m1.1.1.1.1.3.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.10.10.1.m1.2.2.2.2.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.10.10.1.m1.2.2.2.2.1.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.10.10.1.m1.2.2.2.2.2.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2.2">𝑎</ci><cn type="integer" id="S3.T1.10.10.1.m1.2.2.2.2.3.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.2c">a_{1},a_{2}</annotation></semantics></math></td>
<td id="S3.T1.11.11.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.11.11.4.1" class="ltx_text" style="font-size:90%;">(none)</span></td>
<td id="S3.T1.11.11.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.11.11.5.1" class="ltx_text" style="font-size:90%;">att</span></td>
<td id="S3.T1.11.11.2" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.11.11.2.m1.2" class="ltx_Math" alttext="a_{out}=\mathrm{maximum}(a_{1},a_{2})" display="inline"><semantics id="S3.T1.11.11.2.m1.2a"><mrow id="S3.T1.11.11.2.m1.2.2" xref="S3.T1.11.11.2.m1.2.2.cmml"><msub id="S3.T1.11.11.2.m1.2.2.4" xref="S3.T1.11.11.2.m1.2.2.4.cmml"><mi mathsize="90%" id="S3.T1.11.11.2.m1.2.2.4.2" xref="S3.T1.11.11.2.m1.2.2.4.2.cmml">a</mi><mrow id="S3.T1.11.11.2.m1.2.2.4.3" xref="S3.T1.11.11.2.m1.2.2.4.3.cmml"><mi mathsize="90%" id="S3.T1.11.11.2.m1.2.2.4.3.2" xref="S3.T1.11.11.2.m1.2.2.4.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.11.11.2.m1.2.2.4.3.1" xref="S3.T1.11.11.2.m1.2.2.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.11.11.2.m1.2.2.4.3.3" xref="S3.T1.11.11.2.m1.2.2.4.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.T1.11.11.2.m1.2.2.4.3.1a" xref="S3.T1.11.11.2.m1.2.2.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.11.11.2.m1.2.2.4.3.4" xref="S3.T1.11.11.2.m1.2.2.4.3.4.cmml">t</mi></mrow></msub><mo mathsize="90%" id="S3.T1.11.11.2.m1.2.2.3" xref="S3.T1.11.11.2.m1.2.2.3.cmml">=</mo><mrow id="S3.T1.11.11.2.m1.2.2.2" xref="S3.T1.11.11.2.m1.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.11.11.2.m1.2.2.2.4" xref="S3.T1.11.11.2.m1.2.2.2.4.cmml">maximum</mi><mo lspace="0em" rspace="0em" id="S3.T1.11.11.2.m1.2.2.2.3" xref="S3.T1.11.11.2.m1.2.2.2.3.cmml">​</mo><mrow id="S3.T1.11.11.2.m1.2.2.2.2.2" xref="S3.T1.11.11.2.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.11.11.2.m1.2.2.2.2.2.3" xref="S3.T1.11.11.2.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.T1.11.11.2.m1.1.1.1.1.1.1" xref="S3.T1.11.11.2.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.11.11.2.m1.1.1.1.1.1.1.2" xref="S3.T1.11.11.2.m1.1.1.1.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.11.11.2.m1.1.1.1.1.1.1.3" xref="S3.T1.11.11.2.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S3.T1.11.11.2.m1.2.2.2.2.2.4" xref="S3.T1.11.11.2.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.T1.11.11.2.m1.2.2.2.2.2.2" xref="S3.T1.11.11.2.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.11.11.2.m1.2.2.2.2.2.2.2" xref="S3.T1.11.11.2.m1.2.2.2.2.2.2.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.11.11.2.m1.2.2.2.2.2.2.3" xref="S3.T1.11.11.2.m1.2.2.2.2.2.2.3.cmml">2</mn></msub><mo maxsize="90%" minsize="90%" id="S3.T1.11.11.2.m1.2.2.2.2.2.5" xref="S3.T1.11.11.2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.2.m1.2b"><apply id="S3.T1.11.11.2.m1.2.2.cmml" xref="S3.T1.11.11.2.m1.2.2"><eq id="S3.T1.11.11.2.m1.2.2.3.cmml" xref="S3.T1.11.11.2.m1.2.2.3"></eq><apply id="S3.T1.11.11.2.m1.2.2.4.cmml" xref="S3.T1.11.11.2.m1.2.2.4"><csymbol cd="ambiguous" id="S3.T1.11.11.2.m1.2.2.4.1.cmml" xref="S3.T1.11.11.2.m1.2.2.4">subscript</csymbol><ci id="S3.T1.11.11.2.m1.2.2.4.2.cmml" xref="S3.T1.11.11.2.m1.2.2.4.2">𝑎</ci><apply id="S3.T1.11.11.2.m1.2.2.4.3.cmml" xref="S3.T1.11.11.2.m1.2.2.4.3"><times id="S3.T1.11.11.2.m1.2.2.4.3.1.cmml" xref="S3.T1.11.11.2.m1.2.2.4.3.1"></times><ci id="S3.T1.11.11.2.m1.2.2.4.3.2.cmml" xref="S3.T1.11.11.2.m1.2.2.4.3.2">𝑜</ci><ci id="S3.T1.11.11.2.m1.2.2.4.3.3.cmml" xref="S3.T1.11.11.2.m1.2.2.4.3.3">𝑢</ci><ci id="S3.T1.11.11.2.m1.2.2.4.3.4.cmml" xref="S3.T1.11.11.2.m1.2.2.4.3.4">𝑡</ci></apply></apply><apply id="S3.T1.11.11.2.m1.2.2.2.cmml" xref="S3.T1.11.11.2.m1.2.2.2"><times id="S3.T1.11.11.2.m1.2.2.2.3.cmml" xref="S3.T1.11.11.2.m1.2.2.2.3"></times><ci id="S3.T1.11.11.2.m1.2.2.2.4.cmml" xref="S3.T1.11.11.2.m1.2.2.2.4">maximum</ci><interval closure="open" id="S3.T1.11.11.2.m1.2.2.2.2.3.cmml" xref="S3.T1.11.11.2.m1.2.2.2.2.2"><apply id="S3.T1.11.11.2.m1.1.1.1.1.1.1.cmml" xref="S3.T1.11.11.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.T1.11.11.2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.T1.11.11.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.T1.11.11.2.m1.1.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.T1.11.11.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.T1.11.11.2.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.11.11.2.m1.2.2.2.2.2.2.cmml" xref="S3.T1.11.11.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.11.11.2.m1.2.2.2.2.2.2.1.cmml" xref="S3.T1.11.11.2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.T1.11.11.2.m1.2.2.2.2.2.2.2.cmml" xref="S3.T1.11.11.2.m1.2.2.2.2.2.2.2">𝑎</ci><cn type="integer" id="S3.T1.11.11.2.m1.2.2.2.2.2.2.3.cmml" xref="S3.T1.11.11.2.m1.2.2.2.2.2.2.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.2.m1.2c">a_{out}=\mathrm{maximum}(a_{1},a_{2})</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.15.15" class="ltx_tr">
<td id="S3.T1.15.15.5" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S3.T1.15.15.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">filter</span></td>
<td id="S3.T1.12.12.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T1.12.12.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.T1.12.12.1.m1.1a"><mi mathsize="90%" id="S3.T1.12.12.1.m1.1.1" xref="S3.T1.12.12.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.1.m1.1b"><ci id="S3.T1.12.12.1.m1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.1.m1.1c">a</annotation></semantics></math></td>
<td id="S3.T1.14.14.3" class="ltx_td ltx_align_center ltx_border_r">
<math id="S3.T1.13.13.2.m1.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S3.T1.13.13.2.m1.1a"><msub id="S3.T1.13.13.2.m1.1.1" xref="S3.T1.13.13.2.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.13.13.2.m1.1.1.2" xref="S3.T1.13.13.2.m1.1.1.2.cmml">x</mi><mrow id="S3.T1.13.13.2.m1.1.1.3" xref="S3.T1.13.13.2.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.13.13.2.m1.1.1.3.2" xref="S3.T1.13.13.2.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.13.13.2.m1.1.1.3.1" xref="S3.T1.13.13.2.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.13.13.2.m1.1.1.3.3" xref="S3.T1.13.13.2.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.13.13.2.m1.1.1.3.1a" xref="S3.T1.13.13.2.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.13.13.2.m1.1.1.3.4" xref="S3.T1.13.13.2.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.2.m1.1b"><apply id="S3.T1.13.13.2.m1.1.1.cmml" xref="S3.T1.13.13.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.13.13.2.m1.1.1.1.cmml" xref="S3.T1.13.13.2.m1.1.1">subscript</csymbol><ci id="S3.T1.13.13.2.m1.1.1.2.cmml" xref="S3.T1.13.13.2.m1.1.1.2">𝑥</ci><apply id="S3.T1.13.13.2.m1.1.1.3.cmml" xref="S3.T1.13.13.2.m1.1.1.3"><times id="S3.T1.13.13.2.m1.1.1.3.1.cmml" xref="S3.T1.13.13.2.m1.1.1.3.1"></times><ci id="S3.T1.13.13.2.m1.1.1.3.2.cmml" xref="S3.T1.13.13.2.m1.1.1.3.2">𝑣</ci><ci id="S3.T1.13.13.2.m1.1.1.3.3.cmml" xref="S3.T1.13.13.2.m1.1.1.3.3">𝑖</ci><ci id="S3.T1.13.13.2.m1.1.1.3.4.cmml" xref="S3.T1.13.13.2.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.2.m1.1c">x_{vis}</annotation></semantics></math><span id="S3.T1.14.14.3.1" class="ltx_text" style="font-size:90%;">, </span><math id="S3.T1.14.14.3.m2.1" class="ltx_Math" alttext="x_{txt}" display="inline"><semantics id="S3.T1.14.14.3.m2.1a"><msub id="S3.T1.14.14.3.m2.1.1" xref="S3.T1.14.14.3.m2.1.1.cmml"><mi mathsize="90%" id="S3.T1.14.14.3.m2.1.1.2" xref="S3.T1.14.14.3.m2.1.1.2.cmml">x</mi><mrow id="S3.T1.14.14.3.m2.1.1.3" xref="S3.T1.14.14.3.m2.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.14.14.3.m2.1.1.3.2" xref="S3.T1.14.14.3.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.14.14.3.m2.1.1.3.1" xref="S3.T1.14.14.3.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.14.14.3.m2.1.1.3.3" xref="S3.T1.14.14.3.m2.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.14.14.3.m2.1.1.3.1a" xref="S3.T1.14.14.3.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.14.14.3.m2.1.1.3.4" xref="S3.T1.14.14.3.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.3.m2.1b"><apply id="S3.T1.14.14.3.m2.1.1.cmml" xref="S3.T1.14.14.3.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.14.14.3.m2.1.1.1.cmml" xref="S3.T1.14.14.3.m2.1.1">subscript</csymbol><ci id="S3.T1.14.14.3.m2.1.1.2.cmml" xref="S3.T1.14.14.3.m2.1.1.2">𝑥</ci><apply id="S3.T1.14.14.3.m2.1.1.3.cmml" xref="S3.T1.14.14.3.m2.1.1.3"><times id="S3.T1.14.14.3.m2.1.1.3.1.cmml" xref="S3.T1.14.14.3.m2.1.1.3.1"></times><ci id="S3.T1.14.14.3.m2.1.1.3.2.cmml" xref="S3.T1.14.14.3.m2.1.1.3.2">𝑡</ci><ci id="S3.T1.14.14.3.m2.1.1.3.3.cmml" xref="S3.T1.14.14.3.m2.1.1.3.3">𝑥</ci><ci id="S3.T1.14.14.3.m2.1.1.3.4.cmml" xref="S3.T1.14.14.3.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.3.m2.1c">x_{txt}</annotation></semantics></math>
</td>
<td id="S3.T1.15.15.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.15.15.6.1" class="ltx_text" style="font-size:90%;">att</span></td>
<td id="S3.T1.15.15.4" class="ltx_td ltx_align_left ltx_border_r">
<math id="S3.T1.15.15.4.m1.2" class="ltx_Math" alttext="a_{out}=\mathtt{and}(a,\mathtt{find}[x_{vis},x_{txt}]())" display="inline"><semantics id="S3.T1.15.15.4.m1.2a"><mrow id="S3.T1.15.15.4.m1.2.2" xref="S3.T1.15.15.4.m1.2.2.cmml"><msub id="S3.T1.15.15.4.m1.2.2.3" xref="S3.T1.15.15.4.m1.2.2.3.cmml"><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.3.2" xref="S3.T1.15.15.4.m1.2.2.3.2.cmml">a</mi><mrow id="S3.T1.15.15.4.m1.2.2.3.3" xref="S3.T1.15.15.4.m1.2.2.3.3.cmml"><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.3.3.2" xref="S3.T1.15.15.4.m1.2.2.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.3.3.1" xref="S3.T1.15.15.4.m1.2.2.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.3.3.3" xref="S3.T1.15.15.4.m1.2.2.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.3.3.1a" xref="S3.T1.15.15.4.m1.2.2.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.3.3.4" xref="S3.T1.15.15.4.m1.2.2.3.3.4.cmml">t</mi></mrow></msub><mo mathsize="90%" id="S3.T1.15.15.4.m1.2.2.2" xref="S3.T1.15.15.4.m1.2.2.2.cmml">=</mo><mrow id="S3.T1.15.15.4.m1.2.2.1" xref="S3.T1.15.15.4.m1.2.2.1.cmml"><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.3" xref="S3.T1.15.15.4.m1.2.2.1.3.cmml">𝚊𝚗𝚍</mi><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.1.2" xref="S3.T1.15.15.4.m1.2.2.1.2.cmml">​</mo><mrow id="S3.T1.15.15.4.m1.2.2.1.1.1" xref="S3.T1.15.15.4.m1.2.2.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.2" xref="S3.T1.15.15.4.m1.2.2.1.1.2.cmml">(</mo><mi mathsize="90%" id="S3.T1.15.15.4.m1.1.1" xref="S3.T1.15.15.4.m1.1.1.cmml">a</mi><mo mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.3" xref="S3.T1.15.15.4.m1.2.2.1.1.2.cmml">,</mo><mrow id="S3.T1.15.15.4.m1.2.2.1.1.1.1" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.4" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.4.cmml">𝚏𝚒𝚗𝚍</mi><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.3" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.3.cmml">​</mo><mrow id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.3" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.3.cmml">[</mo><msub id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.1a" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.4" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.4" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.3.cmml">,</mo><msub id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.2" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.2.cmml">x</mi><mrow id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.cmml"><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.2" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.1" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.3" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.1a" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.4" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.4.cmml">t</mi></mrow></msub><mo maxsize="90%" minsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.5" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.3.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.3a" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.3.cmml">​</mo><mrow id="S3.T1.15.15.4.m1.2.2.1.1.1.1.5.2" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.5.2.1" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.5.1.cmml">(</mo><mo maxsize="90%" minsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.5.2.2" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.5.1.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S3.T1.15.15.4.m1.2.2.1.1.1.4" xref="S3.T1.15.15.4.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.4.m1.2b"><apply id="S3.T1.15.15.4.m1.2.2.cmml" xref="S3.T1.15.15.4.m1.2.2"><eq id="S3.T1.15.15.4.m1.2.2.2.cmml" xref="S3.T1.15.15.4.m1.2.2.2"></eq><apply id="S3.T1.15.15.4.m1.2.2.3.cmml" xref="S3.T1.15.15.4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.T1.15.15.4.m1.2.2.3.1.cmml" xref="S3.T1.15.15.4.m1.2.2.3">subscript</csymbol><ci id="S3.T1.15.15.4.m1.2.2.3.2.cmml" xref="S3.T1.15.15.4.m1.2.2.3.2">𝑎</ci><apply id="S3.T1.15.15.4.m1.2.2.3.3.cmml" xref="S3.T1.15.15.4.m1.2.2.3.3"><times id="S3.T1.15.15.4.m1.2.2.3.3.1.cmml" xref="S3.T1.15.15.4.m1.2.2.3.3.1"></times><ci id="S3.T1.15.15.4.m1.2.2.3.3.2.cmml" xref="S3.T1.15.15.4.m1.2.2.3.3.2">𝑜</ci><ci id="S3.T1.15.15.4.m1.2.2.3.3.3.cmml" xref="S3.T1.15.15.4.m1.2.2.3.3.3">𝑢</ci><ci id="S3.T1.15.15.4.m1.2.2.3.3.4.cmml" xref="S3.T1.15.15.4.m1.2.2.3.3.4">𝑡</ci></apply></apply><apply id="S3.T1.15.15.4.m1.2.2.1.cmml" xref="S3.T1.15.15.4.m1.2.2.1"><times id="S3.T1.15.15.4.m1.2.2.1.2.cmml" xref="S3.T1.15.15.4.m1.2.2.1.2"></times><ci id="S3.T1.15.15.4.m1.2.2.1.3.cmml" xref="S3.T1.15.15.4.m1.2.2.1.3">𝚊𝚗𝚍</ci><interval closure="open" id="S3.T1.15.15.4.m1.2.2.1.1.2.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1"><ci id="S3.T1.15.15.4.m1.1.1.cmml" xref="S3.T1.15.15.4.m1.1.1">𝑎</ci><apply id="S3.T1.15.15.4.m1.2.2.1.1.1.1.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1"><times id="S3.T1.15.15.4.m1.2.2.1.1.1.1.3.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.3"></times><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.4.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.4">𝚏𝚒𝚗𝚍</ci><interval closure="closed" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2"><apply id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3"><times id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.3">𝑖</ci><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.4.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply><apply id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.2">𝑥</ci><apply id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3"><times id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.1.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.1"></times><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.2.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.2">𝑡</ci><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.3.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.3">𝑥</ci><ci id="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.4.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.2.2.2.3.4">𝑡</ci></apply></apply></interval><list id="S3.T1.15.15.4.m1.2.2.1.1.1.1.5.1.cmml" xref="S3.T1.15.15.4.m1.2.2.1.1.1.1.5.2.1"></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.4.m1.2c">a_{out}=\mathtt{and}(a,\mathtt{find}[x_{vis},x_{txt}]())</annotation></semantics></math><span id="S3.T1.15.15.4.1" class="ltx_text" style="font-size:90%;">, </span><em id="S3.T1.15.15.4.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">i.e</em><span id="S3.T1.15.15.4.3" class="ltx_text" style="font-size:90%;">.</span><span id="S3.T1.15.15.4.4" class="ltx_text"></span><span id="S3.T1.15.15.4.5" class="ltx_text" style="font-size:90%;"> reusing </span><span id="S3.T1.15.15.4.6" class="ltx_text ltx_font_typewriter" style="font-size:90%;">find</span><span id="S3.T1.15.15.4.7" class="ltx_text" style="font-size:90%;"> and </span><span id="S3.T1.15.15.4.8" class="ltx_text ltx_font_typewriter" style="font-size:90%;">and</span>
</td>
</tr>
<tr id="S3.T1.17.17" class="ltx_tr">
<td id="S3.T1.17.17.3" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S3.T1.17.17.3.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[exist, count]</span></td>
<td id="S3.T1.16.16.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T1.16.16.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.T1.16.16.1.m1.1a"><mi mathsize="90%" id="S3.T1.16.16.1.m1.1.1" xref="S3.T1.16.16.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.1.m1.1b"><ci id="S3.T1.16.16.1.m1.1.1.cmml" xref="S3.T1.16.16.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.1.m1.1c">a</annotation></semantics></math></td>
<td id="S3.T1.17.17.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.17.17.4.1" class="ltx_text" style="font-size:90%;">(none)</span></td>
<td id="S3.T1.17.17.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.17.17.5.1" class="ltx_text" style="font-size:90%;">ans</span></td>
<td id="S3.T1.17.17.2" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.17.17.2.m1.1" class="ltx_Math" alttext="y=W^{T}\mathrm{vec}(a)" display="inline"><semantics id="S3.T1.17.17.2.m1.1a"><mrow id="S3.T1.17.17.2.m1.1.2" xref="S3.T1.17.17.2.m1.1.2.cmml"><mi mathsize="90%" id="S3.T1.17.17.2.m1.1.2.2" xref="S3.T1.17.17.2.m1.1.2.2.cmml">y</mi><mo mathsize="90%" id="S3.T1.17.17.2.m1.1.2.1" xref="S3.T1.17.17.2.m1.1.2.1.cmml">=</mo><mrow id="S3.T1.17.17.2.m1.1.2.3" xref="S3.T1.17.17.2.m1.1.2.3.cmml"><msup id="S3.T1.17.17.2.m1.1.2.3.2" xref="S3.T1.17.17.2.m1.1.2.3.2.cmml"><mi mathsize="90%" id="S3.T1.17.17.2.m1.1.2.3.2.2" xref="S3.T1.17.17.2.m1.1.2.3.2.2.cmml">W</mi><mi mathsize="90%" id="S3.T1.17.17.2.m1.1.2.3.2.3" xref="S3.T1.17.17.2.m1.1.2.3.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.T1.17.17.2.m1.1.2.3.1" xref="S3.T1.17.17.2.m1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.17.17.2.m1.1.2.3.3" xref="S3.T1.17.17.2.m1.1.2.3.3.cmml">vec</mi><mo lspace="0em" rspace="0em" id="S3.T1.17.17.2.m1.1.2.3.1a" xref="S3.T1.17.17.2.m1.1.2.3.1.cmml">​</mo><mrow id="S3.T1.17.17.2.m1.1.2.3.4.2" xref="S3.T1.17.17.2.m1.1.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.17.17.2.m1.1.2.3.4.2.1" xref="S3.T1.17.17.2.m1.1.2.3.cmml">(</mo><mi mathsize="90%" id="S3.T1.17.17.2.m1.1.1" xref="S3.T1.17.17.2.m1.1.1.cmml">a</mi><mo maxsize="90%" minsize="90%" id="S3.T1.17.17.2.m1.1.2.3.4.2.2" xref="S3.T1.17.17.2.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.2.m1.1b"><apply id="S3.T1.17.17.2.m1.1.2.cmml" xref="S3.T1.17.17.2.m1.1.2"><eq id="S3.T1.17.17.2.m1.1.2.1.cmml" xref="S3.T1.17.17.2.m1.1.2.1"></eq><ci id="S3.T1.17.17.2.m1.1.2.2.cmml" xref="S3.T1.17.17.2.m1.1.2.2">𝑦</ci><apply id="S3.T1.17.17.2.m1.1.2.3.cmml" xref="S3.T1.17.17.2.m1.1.2.3"><times id="S3.T1.17.17.2.m1.1.2.3.1.cmml" xref="S3.T1.17.17.2.m1.1.2.3.1"></times><apply id="S3.T1.17.17.2.m1.1.2.3.2.cmml" xref="S3.T1.17.17.2.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.T1.17.17.2.m1.1.2.3.2.1.cmml" xref="S3.T1.17.17.2.m1.1.2.3.2">superscript</csymbol><ci id="S3.T1.17.17.2.m1.1.2.3.2.2.cmml" xref="S3.T1.17.17.2.m1.1.2.3.2.2">𝑊</ci><ci id="S3.T1.17.17.2.m1.1.2.3.2.3.cmml" xref="S3.T1.17.17.2.m1.1.2.3.2.3">𝑇</ci></apply><ci id="S3.T1.17.17.2.m1.1.2.3.3.cmml" xref="S3.T1.17.17.2.m1.1.2.3.3">vec</ci><ci id="S3.T1.17.17.2.m1.1.1.cmml" xref="S3.T1.17.17.2.m1.1.1">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.2.m1.1c">y=W^{T}\mathrm{vec}(a)</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.21.21" class="ltx_tr">
<td id="S3.T1.21.21.5" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S3.T1.21.21.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">describe</span></td>
<td id="S3.T1.18.18.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T1.18.18.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.T1.18.18.1.m1.1a"><mi mathsize="90%" id="S3.T1.18.18.1.m1.1.1" xref="S3.T1.18.18.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.1.m1.1b"><ci id="S3.T1.18.18.1.m1.1.1.cmml" xref="S3.T1.18.18.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.1.m1.1c">a</annotation></semantics></math></td>
<td id="S3.T1.20.20.3" class="ltx_td ltx_align_center ltx_border_r">
<math id="S3.T1.19.19.2.m1.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S3.T1.19.19.2.m1.1a"><msub id="S3.T1.19.19.2.m1.1.1" xref="S3.T1.19.19.2.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.19.19.2.m1.1.1.2" xref="S3.T1.19.19.2.m1.1.1.2.cmml">x</mi><mrow id="S3.T1.19.19.2.m1.1.1.3" xref="S3.T1.19.19.2.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.19.19.2.m1.1.1.3.2" xref="S3.T1.19.19.2.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.19.19.2.m1.1.1.3.1" xref="S3.T1.19.19.2.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.19.19.2.m1.1.1.3.3" xref="S3.T1.19.19.2.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.19.19.2.m1.1.1.3.1a" xref="S3.T1.19.19.2.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.19.19.2.m1.1.1.3.4" xref="S3.T1.19.19.2.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.19.19.2.m1.1b"><apply id="S3.T1.19.19.2.m1.1.1.cmml" xref="S3.T1.19.19.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.19.19.2.m1.1.1.1.cmml" xref="S3.T1.19.19.2.m1.1.1">subscript</csymbol><ci id="S3.T1.19.19.2.m1.1.1.2.cmml" xref="S3.T1.19.19.2.m1.1.1.2">𝑥</ci><apply id="S3.T1.19.19.2.m1.1.1.3.cmml" xref="S3.T1.19.19.2.m1.1.1.3"><times id="S3.T1.19.19.2.m1.1.1.3.1.cmml" xref="S3.T1.19.19.2.m1.1.1.3.1"></times><ci id="S3.T1.19.19.2.m1.1.1.3.2.cmml" xref="S3.T1.19.19.2.m1.1.1.3.2">𝑣</ci><ci id="S3.T1.19.19.2.m1.1.1.3.3.cmml" xref="S3.T1.19.19.2.m1.1.1.3.3">𝑖</ci><ci id="S3.T1.19.19.2.m1.1.1.3.4.cmml" xref="S3.T1.19.19.2.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.19.2.m1.1c">x_{vis}</annotation></semantics></math><span id="S3.T1.20.20.3.1" class="ltx_text" style="font-size:90%;">, </span><math id="S3.T1.20.20.3.m2.1" class="ltx_Math" alttext="x_{txt}" display="inline"><semantics id="S3.T1.20.20.3.m2.1a"><msub id="S3.T1.20.20.3.m2.1.1" xref="S3.T1.20.20.3.m2.1.1.cmml"><mi mathsize="90%" id="S3.T1.20.20.3.m2.1.1.2" xref="S3.T1.20.20.3.m2.1.1.2.cmml">x</mi><mrow id="S3.T1.20.20.3.m2.1.1.3" xref="S3.T1.20.20.3.m2.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.20.20.3.m2.1.1.3.2" xref="S3.T1.20.20.3.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.20.20.3.m2.1.1.3.1" xref="S3.T1.20.20.3.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.20.20.3.m2.1.1.3.3" xref="S3.T1.20.20.3.m2.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.20.20.3.m2.1.1.3.1a" xref="S3.T1.20.20.3.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.20.20.3.m2.1.1.3.4" xref="S3.T1.20.20.3.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.3.m2.1b"><apply id="S3.T1.20.20.3.m2.1.1.cmml" xref="S3.T1.20.20.3.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.20.20.3.m2.1.1.1.cmml" xref="S3.T1.20.20.3.m2.1.1">subscript</csymbol><ci id="S3.T1.20.20.3.m2.1.1.2.cmml" xref="S3.T1.20.20.3.m2.1.1.2">𝑥</ci><apply id="S3.T1.20.20.3.m2.1.1.3.cmml" xref="S3.T1.20.20.3.m2.1.1.3"><times id="S3.T1.20.20.3.m2.1.1.3.1.cmml" xref="S3.T1.20.20.3.m2.1.1.3.1"></times><ci id="S3.T1.20.20.3.m2.1.1.3.2.cmml" xref="S3.T1.20.20.3.m2.1.1.3.2">𝑡</ci><ci id="S3.T1.20.20.3.m2.1.1.3.3.cmml" xref="S3.T1.20.20.3.m2.1.1.3.3">𝑥</ci><ci id="S3.T1.20.20.3.m2.1.1.3.4.cmml" xref="S3.T1.20.20.3.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.3.m2.1c">x_{txt}</annotation></semantics></math>
</td>
<td id="S3.T1.21.21.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.21.21.6.1" class="ltx_text" style="font-size:90%;">ans</span></td>
<td id="S3.T1.21.21.4" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.21.21.4.m1.1" class="ltx_Math" alttext="y=W_{1}^{T}\left(W_{2}\mathrm{sum}(a\odot x_{vis})\odot W_{3}x_{txt}\right)" display="inline"><semantics id="S3.T1.21.21.4.m1.1a"><mrow id="S3.T1.21.21.4.m1.1.1" xref="S3.T1.21.21.4.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.3" xref="S3.T1.21.21.4.m1.1.1.3.cmml">y</mi><mo mathsize="90%" id="S3.T1.21.21.4.m1.1.1.2" xref="S3.T1.21.21.4.m1.1.1.2.cmml">=</mo><mrow id="S3.T1.21.21.4.m1.1.1.1" xref="S3.T1.21.21.4.m1.1.1.1.cmml"><msubsup id="S3.T1.21.21.4.m1.1.1.1.3" xref="S3.T1.21.21.4.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.3.2.2" xref="S3.T1.21.21.4.m1.1.1.1.3.2.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.3.2.3" xref="S3.T1.21.21.4.m1.1.1.1.3.2.3.cmml">1</mn><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.3.3" xref="S3.T1.21.21.4.m1.1.1.1.3.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.T1.21.21.4.m1.1.1.1.2" xref="S3.T1.21.21.4.m1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.21.21.4.m1.1.1.1.1.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.cmml"><mo id="S3.T1.21.21.4.m1.1.1.1.1.1.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.21.21.4.m1.1.1.1.1.1.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.cmml"><mrow id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.4" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.4.cmml">sum</mi><mo lspace="0em" rspace="0em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.2a" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><msub id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">s</mi></mrow></msub></mrow><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.3.cmml">3</mn></msub></mrow><mo lspace="0em" rspace="0em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.2" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.1" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.1a" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.4" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.T1.21.21.4.m1.1.1.1.1.1.3" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.21.21.4.m1.1b"><apply id="S3.T1.21.21.4.m1.1.1.cmml" xref="S3.T1.21.21.4.m1.1.1"><eq id="S3.T1.21.21.4.m1.1.1.2.cmml" xref="S3.T1.21.21.4.m1.1.1.2"></eq><ci id="S3.T1.21.21.4.m1.1.1.3.cmml" xref="S3.T1.21.21.4.m1.1.1.3">𝑦</ci><apply id="S3.T1.21.21.4.m1.1.1.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1"><times id="S3.T1.21.21.4.m1.1.1.1.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.2"></times><apply id="S3.T1.21.21.4.m1.1.1.1.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.21.21.4.m1.1.1.1.3.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.3">superscript</csymbol><apply id="S3.T1.21.21.4.m1.1.1.1.3.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.21.21.4.m1.1.1.1.3.2.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.3">subscript</csymbol><ci id="S3.T1.21.21.4.m1.1.1.1.3.2.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.3.2.2">𝑊</ci><cn type="integer" id="S3.T1.21.21.4.m1.1.1.1.3.2.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.3.2.3">1</cn></apply><ci id="S3.T1.21.21.4.m1.1.1.1.3.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.3.3">𝑇</ci></apply><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1"><times id="S3.T1.21.21.4.m1.1.1.1.1.1.1.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.2"></times><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1"><times id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.4">sum</ci><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.1">direct-product</csymbol><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.4">𝑠</ci></apply></apply></apply></apply><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.1.3.3">3</cn></apply></apply><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3"><times id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.3">𝑥</ci><ci id="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.T1.21.21.4.m1.1.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.21.4.m1.1c">y=W_{1}^{T}\left(W_{2}\mathrm{sum}(a\odot x_{vis})\odot W_{3}x_{txt}\right)</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.23.23" class="ltx_tr">
<td id="S3.T1.23.23.3" class="ltx_td ltx_align_left ltx_border_l ltx_border_r"><span id="S3.T1.23.23.3.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[eq_count, more, less]</span></td>
<td id="S3.T1.22.22.1" class="ltx_td ltx_align_center ltx_border_r"><math id="S3.T1.22.22.1.m1.2" class="ltx_Math" alttext="a_{1},a_{2}" display="inline"><semantics id="S3.T1.22.22.1.m1.2a"><mrow id="S3.T1.22.22.1.m1.2.2.2" xref="S3.T1.22.22.1.m1.2.2.3.cmml"><msub id="S3.T1.22.22.1.m1.1.1.1.1" xref="S3.T1.22.22.1.m1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.22.22.1.m1.1.1.1.1.2" xref="S3.T1.22.22.1.m1.1.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.22.22.1.m1.1.1.1.1.3" xref="S3.T1.22.22.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S3.T1.22.22.1.m1.2.2.2.3" xref="S3.T1.22.22.1.m1.2.2.3.cmml">,</mo><msub id="S3.T1.22.22.1.m1.2.2.2.2" xref="S3.T1.22.22.1.m1.2.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.22.22.1.m1.2.2.2.2.2" xref="S3.T1.22.22.1.m1.2.2.2.2.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.22.22.1.m1.2.2.2.2.3" xref="S3.T1.22.22.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.22.22.1.m1.2b"><list id="S3.T1.22.22.1.m1.2.2.3.cmml" xref="S3.T1.22.22.1.m1.2.2.2"><apply id="S3.T1.22.22.1.m1.1.1.1.1.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.22.22.1.m1.1.1.1.1.1.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.22.22.1.m1.1.1.1.1.2.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.T1.22.22.1.m1.1.1.1.1.3.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.22.22.1.m1.2.2.2.2.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.22.22.1.m1.2.2.2.2.1.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.22.22.1.m1.2.2.2.2.2.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2.2">𝑎</ci><cn type="integer" id="S3.T1.22.22.1.m1.2.2.2.2.3.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.22.22.1.m1.2c">a_{1},a_{2}</annotation></semantics></math></td>
<td id="S3.T1.23.23.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.23.23.4.1" class="ltx_text" style="font-size:90%;">(none)</span></td>
<td id="S3.T1.23.23.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.23.23.5.1" class="ltx_text" style="font-size:90%;">ans</span></td>
<td id="S3.T1.23.23.2" class="ltx_td ltx_align_left ltx_border_r"><math id="S3.T1.23.23.2.m1.2" class="ltx_Math" alttext="y=W_{1}^{T}\mathrm{vec}(a_{1})+W_{2}^{T}\mathrm{vec}(a_{2})" display="inline"><semantics id="S3.T1.23.23.2.m1.2a"><mrow id="S3.T1.23.23.2.m1.2.2" xref="S3.T1.23.23.2.m1.2.2.cmml"><mi mathsize="90%" id="S3.T1.23.23.2.m1.2.2.4" xref="S3.T1.23.23.2.m1.2.2.4.cmml">y</mi><mo mathsize="90%" id="S3.T1.23.23.2.m1.2.2.3" xref="S3.T1.23.23.2.m1.2.2.3.cmml">=</mo><mrow id="S3.T1.23.23.2.m1.2.2.2" xref="S3.T1.23.23.2.m1.2.2.2.cmml"><mrow id="S3.T1.23.23.2.m1.1.1.1.1" xref="S3.T1.23.23.2.m1.1.1.1.1.cmml"><msubsup id="S3.T1.23.23.2.m1.1.1.1.1.3" xref="S3.T1.23.23.2.m1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.23.23.2.m1.1.1.1.1.3.2.2" xref="S3.T1.23.23.2.m1.1.1.1.1.3.2.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.23.23.2.m1.1.1.1.1.3.2.3" xref="S3.T1.23.23.2.m1.1.1.1.1.3.2.3.cmml">1</mn><mi mathsize="90%" id="S3.T1.23.23.2.m1.1.1.1.1.3.3" xref="S3.T1.23.23.2.m1.1.1.1.1.3.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.T1.23.23.2.m1.1.1.1.1.2" xref="S3.T1.23.23.2.m1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.T1.23.23.2.m1.1.1.1.1.4" xref="S3.T1.23.23.2.m1.1.1.1.1.4.cmml">vec</mi><mo lspace="0em" rspace="0em" id="S3.T1.23.23.2.m1.1.1.1.1.2a" xref="S3.T1.23.23.2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.23.23.2.m1.1.1.1.1.1.1" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.23.23.2.m1.1.1.1.1.1.1.2" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.T1.23.23.2.m1.1.1.1.1.1.1.1" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.2" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.3" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo maxsize="90%" minsize="90%" id="S3.T1.23.23.2.m1.1.1.1.1.1.1.3" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.T1.23.23.2.m1.2.2.2.3" xref="S3.T1.23.23.2.m1.2.2.2.3.cmml">+</mo><mrow id="S3.T1.23.23.2.m1.2.2.2.2" xref="S3.T1.23.23.2.m1.2.2.2.2.cmml"><msubsup id="S3.T1.23.23.2.m1.2.2.2.2.3" xref="S3.T1.23.23.2.m1.2.2.2.2.3.cmml"><mi mathsize="90%" id="S3.T1.23.23.2.m1.2.2.2.2.3.2.2" xref="S3.T1.23.23.2.m1.2.2.2.2.3.2.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.23.23.2.m1.2.2.2.2.3.2.3" xref="S3.T1.23.23.2.m1.2.2.2.2.3.2.3.cmml">2</mn><mi mathsize="90%" id="S3.T1.23.23.2.m1.2.2.2.2.3.3" xref="S3.T1.23.23.2.m1.2.2.2.2.3.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.T1.23.23.2.m1.2.2.2.2.2" xref="S3.T1.23.23.2.m1.2.2.2.2.2.cmml">​</mo><mi mathsize="90%" id="S3.T1.23.23.2.m1.2.2.2.2.4" xref="S3.T1.23.23.2.m1.2.2.2.2.4.cmml">vec</mi><mo lspace="0em" rspace="0em" id="S3.T1.23.23.2.m1.2.2.2.2.2a" xref="S3.T1.23.23.2.m1.2.2.2.2.2.cmml">​</mo><mrow id="S3.T1.23.23.2.m1.2.2.2.2.1.1" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.23.23.2.m1.2.2.2.2.1.1.2" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.T1.23.23.2.m1.2.2.2.2.1.1.1" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.2" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.3" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.3.cmml">2</mn></msub><mo maxsize="90%" minsize="90%" id="S3.T1.23.23.2.m1.2.2.2.2.1.1.3" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.23.23.2.m1.2b"><apply id="S3.T1.23.23.2.m1.2.2.cmml" xref="S3.T1.23.23.2.m1.2.2"><eq id="S3.T1.23.23.2.m1.2.2.3.cmml" xref="S3.T1.23.23.2.m1.2.2.3"></eq><ci id="S3.T1.23.23.2.m1.2.2.4.cmml" xref="S3.T1.23.23.2.m1.2.2.4">𝑦</ci><apply id="S3.T1.23.23.2.m1.2.2.2.cmml" xref="S3.T1.23.23.2.m1.2.2.2"><plus id="S3.T1.23.23.2.m1.2.2.2.3.cmml" xref="S3.T1.23.23.2.m1.2.2.2.3"></plus><apply id="S3.T1.23.23.2.m1.1.1.1.1.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1"><times id="S3.T1.23.23.2.m1.1.1.1.1.2.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.2"></times><apply id="S3.T1.23.23.2.m1.1.1.1.1.3.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.23.23.2.m1.1.1.1.1.3.1.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.T1.23.23.2.m1.1.1.1.1.3.2.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.23.23.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.23.23.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.3.2.2">𝑊</ci><cn type="integer" id="S3.T1.23.23.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.3.2.3">1</cn></apply><ci id="S3.T1.23.23.2.m1.1.1.1.1.3.3.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.3.3">𝑇</ci></apply><ci id="S3.T1.23.23.2.m1.1.1.1.1.4.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.4">vec</ci><apply id="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.23.23.2.m1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.T1.23.23.2.m1.2.2.2.2.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2"><times id="S3.T1.23.23.2.m1.2.2.2.2.2.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.2"></times><apply id="S3.T1.23.23.2.m1.2.2.2.2.3.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.T1.23.23.2.m1.2.2.2.2.3.1.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.3">superscript</csymbol><apply id="S3.T1.23.23.2.m1.2.2.2.2.3.2.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.T1.23.23.2.m1.2.2.2.2.3.2.1.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.3">subscript</csymbol><ci id="S3.T1.23.23.2.m1.2.2.2.2.3.2.2.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.3.2.2">𝑊</ci><cn type="integer" id="S3.T1.23.23.2.m1.2.2.2.2.3.2.3.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.3.2.3">2</cn></apply><ci id="S3.T1.23.23.2.m1.2.2.2.2.3.3.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.3.3">𝑇</ci></apply><ci id="S3.T1.23.23.2.m1.2.2.2.2.4.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.4">vec</ci><apply id="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.2">𝑎</ci><cn type="integer" id="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.T1.23.23.2.m1.2.2.2.2.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.23.23.2.m1.2c">y=W_{1}^{T}\mathrm{vec}(a_{1})+W_{2}^{T}\mathrm{vec}(a_{2})</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.27.27" class="ltx_tr">
<td id="S3.T1.27.27.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r"><span id="S3.T1.27.27.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">compare</span></td>
<td id="S3.T1.24.24.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><math id="S3.T1.24.24.1.m1.2" class="ltx_Math" alttext="a_{1},a_{2}" display="inline"><semantics id="S3.T1.24.24.1.m1.2a"><mrow id="S3.T1.24.24.1.m1.2.2.2" xref="S3.T1.24.24.1.m1.2.2.3.cmml"><msub id="S3.T1.24.24.1.m1.1.1.1.1" xref="S3.T1.24.24.1.m1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.T1.24.24.1.m1.1.1.1.1.2" xref="S3.T1.24.24.1.m1.1.1.1.1.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.24.24.1.m1.1.1.1.1.3" xref="S3.T1.24.24.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S3.T1.24.24.1.m1.2.2.2.3" xref="S3.T1.24.24.1.m1.2.2.3.cmml">,</mo><msub id="S3.T1.24.24.1.m1.2.2.2.2" xref="S3.T1.24.24.1.m1.2.2.2.2.cmml"><mi mathsize="90%" id="S3.T1.24.24.1.m1.2.2.2.2.2" xref="S3.T1.24.24.1.m1.2.2.2.2.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.24.24.1.m1.2.2.2.2.3" xref="S3.T1.24.24.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.24.24.1.m1.2b"><list id="S3.T1.24.24.1.m1.2.2.3.cmml" xref="S3.T1.24.24.1.m1.2.2.2"><apply id="S3.T1.24.24.1.m1.1.1.1.1.cmml" xref="S3.T1.24.24.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.24.24.1.m1.1.1.1.1.1.cmml" xref="S3.T1.24.24.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.24.24.1.m1.1.1.1.1.2.cmml" xref="S3.T1.24.24.1.m1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.T1.24.24.1.m1.1.1.1.1.3.cmml" xref="S3.T1.24.24.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.24.24.1.m1.2.2.2.2.cmml" xref="S3.T1.24.24.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.24.24.1.m1.2.2.2.2.1.cmml" xref="S3.T1.24.24.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.24.24.1.m1.2.2.2.2.2.cmml" xref="S3.T1.24.24.1.m1.2.2.2.2.2">𝑎</ci><cn type="integer" id="S3.T1.24.24.1.m1.2.2.2.2.3.cmml" xref="S3.T1.24.24.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.24.24.1.m1.2c">a_{1},a_{2}</annotation></semantics></math></td>
<td id="S3.T1.26.26.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">
<math id="S3.T1.25.25.2.m1.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S3.T1.25.25.2.m1.1a"><msub id="S3.T1.25.25.2.m1.1.1" xref="S3.T1.25.25.2.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.25.25.2.m1.1.1.2" xref="S3.T1.25.25.2.m1.1.1.2.cmml">x</mi><mrow id="S3.T1.25.25.2.m1.1.1.3" xref="S3.T1.25.25.2.m1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.25.25.2.m1.1.1.3.2" xref="S3.T1.25.25.2.m1.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.25.25.2.m1.1.1.3.1" xref="S3.T1.25.25.2.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.25.25.2.m1.1.1.3.3" xref="S3.T1.25.25.2.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.25.25.2.m1.1.1.3.1a" xref="S3.T1.25.25.2.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.25.25.2.m1.1.1.3.4" xref="S3.T1.25.25.2.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.25.25.2.m1.1b"><apply id="S3.T1.25.25.2.m1.1.1.cmml" xref="S3.T1.25.25.2.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.25.25.2.m1.1.1.1.cmml" xref="S3.T1.25.25.2.m1.1.1">subscript</csymbol><ci id="S3.T1.25.25.2.m1.1.1.2.cmml" xref="S3.T1.25.25.2.m1.1.1.2">𝑥</ci><apply id="S3.T1.25.25.2.m1.1.1.3.cmml" xref="S3.T1.25.25.2.m1.1.1.3"><times id="S3.T1.25.25.2.m1.1.1.3.1.cmml" xref="S3.T1.25.25.2.m1.1.1.3.1"></times><ci id="S3.T1.25.25.2.m1.1.1.3.2.cmml" xref="S3.T1.25.25.2.m1.1.1.3.2">𝑣</ci><ci id="S3.T1.25.25.2.m1.1.1.3.3.cmml" xref="S3.T1.25.25.2.m1.1.1.3.3">𝑖</ci><ci id="S3.T1.25.25.2.m1.1.1.3.4.cmml" xref="S3.T1.25.25.2.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.25.25.2.m1.1c">x_{vis}</annotation></semantics></math><span id="S3.T1.26.26.3.1" class="ltx_text" style="font-size:90%;">, </span><math id="S3.T1.26.26.3.m2.1" class="ltx_Math" alttext="x_{txt}" display="inline"><semantics id="S3.T1.26.26.3.m2.1a"><msub id="S3.T1.26.26.3.m2.1.1" xref="S3.T1.26.26.3.m2.1.1.cmml"><mi mathsize="90%" id="S3.T1.26.26.3.m2.1.1.2" xref="S3.T1.26.26.3.m2.1.1.2.cmml">x</mi><mrow id="S3.T1.26.26.3.m2.1.1.3" xref="S3.T1.26.26.3.m2.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.26.26.3.m2.1.1.3.2" xref="S3.T1.26.26.3.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.26.26.3.m2.1.1.3.1" xref="S3.T1.26.26.3.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.26.26.3.m2.1.1.3.3" xref="S3.T1.26.26.3.m2.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.26.26.3.m2.1.1.3.1a" xref="S3.T1.26.26.3.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.26.26.3.m2.1.1.3.4" xref="S3.T1.26.26.3.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.26.26.3.m2.1b"><apply id="S3.T1.26.26.3.m2.1.1.cmml" xref="S3.T1.26.26.3.m2.1.1"><csymbol cd="ambiguous" id="S3.T1.26.26.3.m2.1.1.1.cmml" xref="S3.T1.26.26.3.m2.1.1">subscript</csymbol><ci id="S3.T1.26.26.3.m2.1.1.2.cmml" xref="S3.T1.26.26.3.m2.1.1.2">𝑥</ci><apply id="S3.T1.26.26.3.m2.1.1.3.cmml" xref="S3.T1.26.26.3.m2.1.1.3"><times id="S3.T1.26.26.3.m2.1.1.3.1.cmml" xref="S3.T1.26.26.3.m2.1.1.3.1"></times><ci id="S3.T1.26.26.3.m2.1.1.3.2.cmml" xref="S3.T1.26.26.3.m2.1.1.3.2">𝑡</ci><ci id="S3.T1.26.26.3.m2.1.1.3.3.cmml" xref="S3.T1.26.26.3.m2.1.1.3.3">𝑥</ci><ci id="S3.T1.26.26.3.m2.1.1.3.4.cmml" xref="S3.T1.26.26.3.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.26.26.3.m2.1c">x_{txt}</annotation></semantics></math>
</td>
<td id="S3.T1.27.27.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S3.T1.27.27.6.1" class="ltx_text" style="font-size:90%;">ans</span></td>
<td id="S3.T1.27.27.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r"><math id="S3.T1.27.27.4.m1.1" class="ltx_Math" alttext="y=W_{1}^{T}\left(W_{2}\mathrm{sum}(a_{1}\odot x_{vis})\odot W_{3}\mathrm{sum}(a_{2}\odot x_{vis})\odot W_{4}x_{txt}\right)" display="inline"><semantics id="S3.T1.27.27.4.m1.1a"><mrow id="S3.T1.27.27.4.m1.1.1" xref="S3.T1.27.27.4.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.3" xref="S3.T1.27.27.4.m1.1.1.3.cmml">y</mi><mo mathsize="90%" id="S3.T1.27.27.4.m1.1.1.2" xref="S3.T1.27.27.4.m1.1.1.2.cmml">=</mo><mrow id="S3.T1.27.27.4.m1.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.cmml"><msubsup id="S3.T1.27.27.4.m1.1.1.1.3" xref="S3.T1.27.27.4.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.3.2.2" xref="S3.T1.27.27.4.m1.1.1.1.3.2.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.3.2.3" xref="S3.T1.27.27.4.m1.1.1.1.3.2.3.cmml">1</mn><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.3.3" xref="S3.T1.27.27.4.m1.1.1.1.3.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.2" xref="S3.T1.27.27.4.m1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.cmml"><mo id="S3.T1.27.27.4.m1.1.1.1.1.1.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.cmml"><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.cmml"><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.cmml"><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.4.cmml">sum</mi><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><msub id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">s</mi></mrow></msub></mrow><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">3</mn></msub></mrow><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.3.cmml">​</mo><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.4" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.4.cmml">sum</mi><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.3a" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml"><msub id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.2.cmml">a</mi><mn mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.cmml">2</mn></msub><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">⊙</mo><msub id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.2.cmml">x</mi><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1a" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.4" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.4.cmml">s</mi></mrow></msub></mrow><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.3.cmml">⊙</mo><msub id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.2.cmml">W</mi><mn mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.3.cmml">4</mn></msub></mrow><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.3.cmml">​</mo><msub id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.2.cmml">x</mi><mrow id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.cmml"><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.2" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.1" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.1a" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi mathsize="90%" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.4" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.T1.27.27.4.m1.1.1.1.1.1.3" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.27.27.4.m1.1b"><apply id="S3.T1.27.27.4.m1.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1"><eq id="S3.T1.27.27.4.m1.1.1.2.cmml" xref="S3.T1.27.27.4.m1.1.1.2"></eq><ci id="S3.T1.27.27.4.m1.1.1.3.cmml" xref="S3.T1.27.27.4.m1.1.1.3">𝑦</ci><apply id="S3.T1.27.27.4.m1.1.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1"><times id="S3.T1.27.27.4.m1.1.1.1.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.2"></times><apply id="S3.T1.27.27.4.m1.1.1.1.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.3.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.3">superscript</csymbol><apply id="S3.T1.27.27.4.m1.1.1.1.3.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.3.2.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.3">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.3.2.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.3.2.2">𝑊</ci><cn type="integer" id="S3.T1.27.27.4.m1.1.1.1.3.2.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.3.2.3">1</cn></apply><ci id="S3.T1.27.27.4.m1.1.1.1.3.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.3.3">𝑇</ci></apply><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1"><times id="S3.T1.27.27.4.m1.1.1.1.1.1.1.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.3"></times><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.3">direct-product</csymbol><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2"><times id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.3"></times><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.4">sum</ci><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><cn type="integer" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.4">𝑠</ci></apply></apply></apply></apply><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.1.1.1.3.3">3</cn></apply></apply><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.4.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.4">sum</ci><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="latexml" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.1">direct-product</csymbol><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.2">𝑎</ci><cn type="integer" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.2.3">2</cn></apply><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.2">𝑥</ci><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3"><times id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.1"></times><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.2">𝑣</ci><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.3">𝑖</ci><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.4.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.4">𝑠</ci></apply></apply></apply></apply><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.2">𝑊</ci><cn type="integer" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.2.4.3">4</cn></apply></apply><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.2">𝑥</ci><apply id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3"><times id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.1"></times><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.2">𝑡</ci><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.3">𝑥</ci><ci id="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.4.cmml" xref="S3.T1.27.27.4.m1.1.1.1.1.1.1.4.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.27.27.4.m1.1c">y=W_{1}^{T}\left(W_{2}\mathrm{sum}(a_{1}\odot x_{vis})\odot W_{3}\mathrm{sum}(a_{2}\odot x_{vis})\odot W_{4}x_{txt}\right)</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>The full list of neural modules in our model. Each module takes 0, 1 or 2 attention maps (and also visual and textual features) as input, and outputs either an attention map <math id="S3.T1.33.m1.1" class="ltx_Math" alttext="a_{out}" display="inline"><semantics id="S3.T1.33.m1.1b"><msub id="S3.T1.33.m1.1.1" xref="S3.T1.33.m1.1.1.cmml"><mi id="S3.T1.33.m1.1.1.2" xref="S3.T1.33.m1.1.1.2.cmml">a</mi><mrow id="S3.T1.33.m1.1.1.3" xref="S3.T1.33.m1.1.1.3.cmml"><mi id="S3.T1.33.m1.1.1.3.2" xref="S3.T1.33.m1.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.33.m1.1.1.3.1" xref="S3.T1.33.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.33.m1.1.1.3.3" xref="S3.T1.33.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.T1.33.m1.1.1.3.1b" xref="S3.T1.33.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.33.m1.1.1.3.4" xref="S3.T1.33.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.33.m1.1c"><apply id="S3.T1.33.m1.1.1.cmml" xref="S3.T1.33.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.33.m1.1.1.1.cmml" xref="S3.T1.33.m1.1.1">subscript</csymbol><ci id="S3.T1.33.m1.1.1.2.cmml" xref="S3.T1.33.m1.1.1.2">𝑎</ci><apply id="S3.T1.33.m1.1.1.3.cmml" xref="S3.T1.33.m1.1.1.3"><times id="S3.T1.33.m1.1.1.3.1.cmml" xref="S3.T1.33.m1.1.1.3.1"></times><ci id="S3.T1.33.m1.1.1.3.2.cmml" xref="S3.T1.33.m1.1.1.3.2">𝑜</ci><ci id="S3.T1.33.m1.1.1.3.3.cmml" xref="S3.T1.33.m1.1.1.3.3">𝑢</ci><ci id="S3.T1.33.m1.1.1.3.4.cmml" xref="S3.T1.33.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.33.m1.1d">a_{out}</annotation></semantics></math> or a score vector <math id="S3.T1.34.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.T1.34.m2.1b"><mi id="S3.T1.34.m2.1.1" xref="S3.T1.34.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.T1.34.m2.1c"><ci id="S3.T1.34.m2.1.1.cmml" xref="S3.T1.34.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.34.m2.1d">y</annotation></semantics></math> for all possible answers. The operator <math id="S3.T1.35.m3.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.T1.35.m3.1b"><mo id="S3.T1.35.m3.1.1" xref="S3.T1.35.m3.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.T1.35.m3.1c"><csymbol cd="latexml" id="S3.T1.35.m3.1.1.cmml" xref="S3.T1.35.m3.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.35.m3.1d">\odot</annotation></semantics></math> is element-wise multiplication, and <math id="S3.T1.36.m4.1" class="ltx_Math" alttext="\mathrm{sum}" display="inline"><semantics id="S3.T1.36.m4.1b"><mi id="S3.T1.36.m4.1.1" xref="S3.T1.36.m4.1.1.cmml">sum</mi><annotation-xml encoding="MathML-Content" id="S3.T1.36.m4.1c"><ci id="S3.T1.36.m4.1.1.cmml" xref="S3.T1.36.m4.1.1">sum</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.36.m4.1d">\mathrm{sum}</annotation></semantics></math> is summing the result over spatial dimensions. The <math id="S3.T1.37.m5.1" class="ltx_Math" alttext="\mathrm{vec}" display="inline"><semantics id="S3.T1.37.m5.1b"><mi id="S3.T1.37.m5.1.1" xref="S3.T1.37.m5.1.1.cmml">vec</mi><annotation-xml encoding="MathML-Content" id="S3.T1.37.m5.1c"><ci id="S3.T1.37.m5.1.1.cmml" xref="S3.T1.37.m5.1.1">vec</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.37.m5.1d">\mathrm{vec}</annotation></semantics></math> operation is flattening an attention map into a vector, and adding two extra dimensions: the max and min over attention map.</figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.9" class="ltx_p">Our model involves a set of neural modules that can be dynamically assembled into a neural network. A neural module <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">m</annotation></semantics></math> is a parameterized function <math id="S3.SS1.p1.2.m2.6" class="ltx_Math" alttext="y=f_{m}(a_{1},a_{2},\ldots;x_{vis},x_{txt},\theta_{m})" display="inline"><semantics id="S3.SS1.p1.2.m2.6a"><mrow id="S3.SS1.p1.2.m2.6.6" xref="S3.SS1.p1.2.m2.6.6.cmml"><mi id="S3.SS1.p1.2.m2.6.6.7" xref="S3.SS1.p1.2.m2.6.6.7.cmml">y</mi><mo id="S3.SS1.p1.2.m2.6.6.6" xref="S3.SS1.p1.2.m2.6.6.6.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.6.6.5" xref="S3.SS1.p1.2.m2.6.6.5.cmml"><msub id="S3.SS1.p1.2.m2.6.6.5.7" xref="S3.SS1.p1.2.m2.6.6.5.7.cmml"><mi id="S3.SS1.p1.2.m2.6.6.5.7.2" xref="S3.SS1.p1.2.m2.6.6.5.7.2.cmml">f</mi><mi id="S3.SS1.p1.2.m2.6.6.5.7.3" xref="S3.SS1.p1.2.m2.6.6.5.7.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.6.6.5.6" xref="S3.SS1.p1.2.m2.6.6.5.6.cmml">​</mo><mrow id="S3.SS1.p1.2.m2.6.6.5.5.5" xref="S3.SS1.p1.2.m2.6.6.5.5.6.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.6.6.5.5.5.6" xref="S3.SS1.p1.2.m2.6.6.5.5.6.cmml">(</mo><msub id="S3.SS1.p1.2.m2.2.2.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.2.cmml">a</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.6.6.5.5.5.7" xref="S3.SS1.p1.2.m2.6.6.5.5.6.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.cmml">a</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.6.6.5.5.5.8" xref="S3.SS1.p1.2.m2.6.6.5.5.6.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.6.6.5.5.5.9" xref="S3.SS1.p1.2.m2.6.6.5.5.6.cmml">;</mo><msub id="S3.SS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.2.cmml">x</mi><mrow id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.1" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.1a" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.4" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS1.p1.2.m2.6.6.5.5.5.10" xref="S3.SS1.p1.2.m2.6.6.5.5.6.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.4.4.4.4" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.cmml"><mi id="S3.SS1.p1.2.m2.5.5.4.4.4.4.2" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.2.cmml">x</mi><mrow id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.2" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.1" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.3" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.1a" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.4" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.4.cmml">t</mi></mrow></msub><mo id="S3.SS1.p1.2.m2.6.6.5.5.5.11" xref="S3.SS1.p1.2.m2.6.6.5.5.6.cmml">,</mo><msub id="S3.SS1.p1.2.m2.6.6.5.5.5.5" xref="S3.SS1.p1.2.m2.6.6.5.5.5.5.cmml"><mi id="S3.SS1.p1.2.m2.6.6.5.5.5.5.2" xref="S3.SS1.p1.2.m2.6.6.5.5.5.5.2.cmml">θ</mi><mi id="S3.SS1.p1.2.m2.6.6.5.5.5.5.3" xref="S3.SS1.p1.2.m2.6.6.5.5.5.5.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS1.p1.2.m2.6.6.5.5.5.12" xref="S3.SS1.p1.2.m2.6.6.5.5.6.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.6b"><apply id="S3.SS1.p1.2.m2.6.6.cmml" xref="S3.SS1.p1.2.m2.6.6"><eq id="S3.SS1.p1.2.m2.6.6.6.cmml" xref="S3.SS1.p1.2.m2.6.6.6"></eq><ci id="S3.SS1.p1.2.m2.6.6.7.cmml" xref="S3.SS1.p1.2.m2.6.6.7">𝑦</ci><apply id="S3.SS1.p1.2.m2.6.6.5.cmml" xref="S3.SS1.p1.2.m2.6.6.5"><times id="S3.SS1.p1.2.m2.6.6.5.6.cmml" xref="S3.SS1.p1.2.m2.6.6.5.6"></times><apply id="S3.SS1.p1.2.m2.6.6.5.7.cmml" xref="S3.SS1.p1.2.m2.6.6.5.7"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.6.6.5.7.1.cmml" xref="S3.SS1.p1.2.m2.6.6.5.7">subscript</csymbol><ci id="S3.SS1.p1.2.m2.6.6.5.7.2.cmml" xref="S3.SS1.p1.2.m2.6.6.5.7.2">𝑓</ci><ci id="S3.SS1.p1.2.m2.6.6.5.7.3.cmml" xref="S3.SS1.p1.2.m2.6.6.5.7.3">𝑚</ci></apply><vector id="S3.SS1.p1.2.m2.6.6.5.5.6.cmml" xref="S3.SS1.p1.2.m2.6.6.5.5.5"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.2">𝑎</ci><cn type="integer" id="S3.SS1.p1.2.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.2">𝑥</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3"><times id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.1"></times><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.2">𝑣</ci><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.3">𝑖</ci><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.4.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.4">𝑠</ci></apply></apply><apply id="S3.SS1.p1.2.m2.5.5.4.4.4.4.cmml" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.4.4.4.4.1.cmml" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.4.4.4.4.2.cmml" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.2">𝑥</ci><apply id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.cmml" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3"><times id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.1"></times><ci id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.2">𝑡</ci><ci id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.3">𝑥</ci><ci id="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.4.cmml" xref="S3.SS1.p1.2.m2.5.5.4.4.4.4.3.4">𝑡</ci></apply></apply><apply id="S3.SS1.p1.2.m2.6.6.5.5.5.5.cmml" xref="S3.SS1.p1.2.m2.6.6.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.6.6.5.5.5.5.1.cmml" xref="S3.SS1.p1.2.m2.6.6.5.5.5.5">subscript</csymbol><ci id="S3.SS1.p1.2.m2.6.6.5.5.5.5.2.cmml" xref="S3.SS1.p1.2.m2.6.6.5.5.5.5.2">𝜃</ci><ci id="S3.SS1.p1.2.m2.6.6.5.5.5.5.3.cmml" xref="S3.SS1.p1.2.m2.6.6.5.5.5.5.3">𝑚</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.6c">y=f_{m}(a_{1},a_{2},\ldots;x_{vis},x_{txt},\theta_{m})</annotation></semantics></math> that takes zero, one or multiple tensors <math id="S3.SS1.p1.3.m3.3" class="ltx_Math" alttext="a_{1},a_{2},\ldots" display="inline"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3.2" xref="S3.SS1.p1.3.m3.3.3.3.cmml"><msub id="S3.SS1.p1.3.m3.2.2.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.2.cmml">a</mi><mn id="S3.SS1.p1.3.m3.2.2.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.3.3.2.3" xref="S3.SS1.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.3.3.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.cmml">a</mi><mn id="S3.SS1.p1.3.m3.3.3.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.3.m3.3.3.2.4" xref="S3.SS1.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">…</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><list id="S3.SS1.p1.3.m3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2"><apply id="S3.SS1.p1.3.m3.2.2.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.2">𝑎</ci><cn type="integer" id="S3.SS1.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.p1.3.m3.3.3.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">𝑎</ci><cn type="integer" id="S3.SS1.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.3">2</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">a_{1},a_{2},\ldots</annotation></semantics></math> as input, using its internal parameter <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\theta_{m}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝜃</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\theta_{m}</annotation></semantics></math> and features <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">x</mi><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.1.1.3.1a" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.5.m5.1.1.3.4" xref="S3.SS1.p1.5.m5.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑥</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><times id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝑣</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">𝑖</ci><ci id="S3.SS1.p1.5.m5.1.1.3.4.cmml" xref="S3.SS1.p1.5.m5.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">x_{vis}</annotation></semantics></math> and <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="x_{txt}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">x</mi><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.3.1a" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.3.4" xref="S3.SS1.p1.6.m6.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑥</ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><times id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝑡</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">𝑥</ci><ci id="S3.SS1.p1.6.m6.1.1.3.4.cmml" xref="S3.SS1.p1.6.m6.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">x_{txt}</annotation></semantics></math> from the image and question to perform some computation on the input, and outputs a tensor <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">y</annotation></semantics></math>. In our implementation, each input tensor <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">a</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑎</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">a_{i}</annotation></semantics></math> is an image attention map over the convolutional image feature grid, and the output tensor <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">y</annotation></semantics></math> is either an image attention map, or a probability distribution over possible answers.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.9" class="ltx_p">Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Attentional neural modules ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the set of modules in our N2NMNs model, along with their implementation details. We assign a name to each module according to its input and output type and potential functionality, such as <span id="S3.SS1.p2.9.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">find</span> or <span id="S3.SS1.p2.9.2" class="ltx_text ltx_markedasmath ltx_font_typewriter">describe</span>. However, we note that each module is in itself merely a function with parameters, and we do not restrict its behavior during training. In addition to the input tensors (that are outputs from other modules), a module <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">m</annotation></semantics></math> can also use two additional feature vectors <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">x</mi><mrow id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.1.1.3.1" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.1.1.3.1a" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.4.m4.1.1.3.4" xref="S3.SS1.p2.4.m4.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑥</ci><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><times id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">𝑣</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">𝑖</ci><ci id="S3.SS1.p2.4.m4.1.1.3.4.cmml" xref="S3.SS1.p2.4.m4.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">x_{vis}</annotation></semantics></math> and <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="x_{txt}^{(m)}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msubsup id="S3.SS1.p2.5.m5.1.2" xref="S3.SS1.p2.5.m5.1.2.cmml"><mi id="S3.SS1.p2.5.m5.1.2.2.2" xref="S3.SS1.p2.5.m5.1.2.2.2.cmml">x</mi><mrow id="S3.SS1.p2.5.m5.1.2.2.3" xref="S3.SS1.p2.5.m5.1.2.2.3.cmml"><mi id="S3.SS1.p2.5.m5.1.2.2.3.2" xref="S3.SS1.p2.5.m5.1.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.1.2.2.3.1" xref="S3.SS1.p2.5.m5.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p2.5.m5.1.2.2.3.3" xref="S3.SS1.p2.5.m5.1.2.2.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.1.2.2.3.1a" xref="S3.SS1.p2.5.m5.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p2.5.m5.1.2.2.3.4" xref="S3.SS1.p2.5.m5.1.2.2.3.4.cmml">t</mi></mrow><mrow id="S3.SS1.p2.5.m5.1.1.1.3" xref="S3.SS1.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.3.1" xref="S3.SS1.p2.5.m5.1.2.cmml">(</mo><mi id="S3.SS1.p2.5.m5.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.3.2" xref="S3.SS1.p2.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.2.cmml" xref="S3.SS1.p2.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2">superscript</csymbol><apply id="S3.SS1.p2.5.m5.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.2.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.2.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2.2.2">𝑥</ci><apply id="S3.SS1.p2.5.m5.1.2.2.3.cmml" xref="S3.SS1.p2.5.m5.1.2.2.3"><times id="S3.SS1.p2.5.m5.1.2.2.3.1.cmml" xref="S3.SS1.p2.5.m5.1.2.2.3.1"></times><ci id="S3.SS1.p2.5.m5.1.2.2.3.2.cmml" xref="S3.SS1.p2.5.m5.1.2.2.3.2">𝑡</ci><ci id="S3.SS1.p2.5.m5.1.2.2.3.3.cmml" xref="S3.SS1.p2.5.m5.1.2.2.3.3">𝑥</ci><ci id="S3.SS1.p2.5.m5.1.2.2.3.4.cmml" xref="S3.SS1.p2.5.m5.1.2.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">x_{txt}^{(m)}</annotation></semantics></math>, where <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">x</mi><mrow id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml"><mi id="S3.SS1.p2.6.m6.1.1.3.2" xref="S3.SS1.p2.6.m6.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.6.m6.1.1.3.1" xref="S3.SS1.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.6.m6.1.1.3.3" xref="S3.SS1.p2.6.m6.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.6.m6.1.1.3.1a" xref="S3.SS1.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.6.m6.1.1.3.4" xref="S3.SS1.p2.6.m6.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝑥</ci><apply id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3"><times id="S3.SS1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.1"></times><ci id="S3.SS1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2">𝑣</ci><ci id="S3.SS1.p2.6.m6.1.1.3.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3">𝑖</ci><ci id="S3.SS1.p2.6.m6.1.1.3.4.cmml" xref="S3.SS1.p2.6.m6.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">x_{vis}</annotation></semantics></math> is the spatial feature map extracted from the image with a convolutional neural network, and <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="x_{txt}^{(m)}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><msubsup id="S3.SS1.p2.7.m7.1.2" xref="S3.SS1.p2.7.m7.1.2.cmml"><mi id="S3.SS1.p2.7.m7.1.2.2.2" xref="S3.SS1.p2.7.m7.1.2.2.2.cmml">x</mi><mrow id="S3.SS1.p2.7.m7.1.2.2.3" xref="S3.SS1.p2.7.m7.1.2.2.3.cmml"><mi id="S3.SS1.p2.7.m7.1.2.2.3.2" xref="S3.SS1.p2.7.m7.1.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m7.1.2.2.3.1" xref="S3.SS1.p2.7.m7.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p2.7.m7.1.2.2.3.3" xref="S3.SS1.p2.7.m7.1.2.2.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.7.m7.1.2.2.3.1a" xref="S3.SS1.p2.7.m7.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p2.7.m7.1.2.2.3.4" xref="S3.SS1.p2.7.m7.1.2.2.3.4.cmml">t</mi></mrow><mrow id="S3.SS1.p2.7.m7.1.1.1.3" xref="S3.SS1.p2.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.7.m7.1.1.1.3.1" xref="S3.SS1.p2.7.m7.1.2.cmml">(</mo><mi id="S3.SS1.p2.7.m7.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p2.7.m7.1.1.1.3.2" xref="S3.SS1.p2.7.m7.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.2.cmml" xref="S3.SS1.p2.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2">superscript</csymbol><apply id="S3.SS1.p2.7.m7.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.2.2.1.cmml" xref="S3.SS1.p2.7.m7.1.2">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.2.2.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2.2">𝑥</ci><apply id="S3.SS1.p2.7.m7.1.2.2.3.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3"><times id="S3.SS1.p2.7.m7.1.2.2.3.1.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3.1"></times><ci id="S3.SS1.p2.7.m7.1.2.2.3.2.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3.2">𝑡</ci><ci id="S3.SS1.p2.7.m7.1.2.2.3.3.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3.3">𝑥</ci><ci id="S3.SS1.p2.7.m7.1.2.2.3.4.cmml" xref="S3.SS1.p2.7.m7.1.2.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS1.p2.7.m7.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">x_{txt}^{(m)}</annotation></semantics></math> is a textual vector for this module <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">m</annotation></semantics></math> that contains information extracted from the question <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">q</annotation></semantics></math>. In addition, <span id="S3.SS1.p2.9.3" class="ltx_text ltx_font_typewriter">and</span> and <span id="S3.SS1.p2.9.4" class="ltx_text ltx_font_typewriter">or</span> take two image attention maps as inputs, and return their intersection or union respectively.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">In Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Attentional neural modules ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the <span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_typewriter">find</span> module outputs an attention map over the image and can be potentially used to localize some objects or attributes. The <span id="S3.SS1.p3.1.2" class="ltx_text ltx_font_typewriter">relocate</span> module transforms the input image attention map and outputs a new attention map, which can be useful for spatial or relationship inference. Also the <span id="S3.SS1.p3.1.3" class="ltx_text ltx_font_typewriter">filter</span> module reuses <span id="S3.SS1.p3.1.4" class="ltx_text ltx_font_typewriter">find</span> and <span id="S3.SS1.p3.1.5" class="ltx_text ltx_font_typewriter">and</span>, and can be used to simplify the layout expression. We use two classes of modules to infer an answer from a single attention map: the first class has the instances <span id="S3.SS1.p3.1.6" class="ltx_text ltx_font_typewriter">exist</span> and <span id="S3.SS1.p3.1.7" class="ltx_text ltx_font_typewriter">count</span> (instances share the same structure, but have different parameters). They are used for simple inference by looking only at the attention map. The second class, <span id="S3.SS1.p3.1.8" class="ltx_text ltx_font_typewriter">describe</span>, is for more complex inference where visual appearance is needed. Similarly, for pairwise comparison over two attention maps we also have two classes of available modules with (<span id="S3.SS1.p3.1.9" class="ltx_text ltx_font_typewriter">compare</span>) or without (<span id="S3.SS1.p3.1.10" class="ltx_text ltx_font_typewriter">eq_count,more,less</span>) access to visual features.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.4" class="ltx_p">The biggest difference in module implementation between this work and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> is the textual component. Hard-coded textual components are used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, for example, <span id="S3.SS1.p4.4.1" class="ltx_text ltx_font_typewriter">describe</span>[‘shape’] and <span id="S3.SS1.p4.4.2" class="ltx_text ltx_font_typewriter">describe</span>[‘where’] are two different instantiations that have different parameters. In contrast, our model obtains the textual input using soft attention over question words similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. For each module <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">m</annotation></semantics></math>, we predict an attention map <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="\alpha_{i}^{(m)}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><msubsup id="S3.SS1.p4.2.m2.1.2" xref="S3.SS1.p4.2.m2.1.2.cmml"><mi id="S3.SS1.p4.2.m2.1.2.2.2" xref="S3.SS1.p4.2.m2.1.2.2.2.cmml">α</mi><mi id="S3.SS1.p4.2.m2.1.2.2.3" xref="S3.SS1.p4.2.m2.1.2.2.3.cmml">i</mi><mrow id="S3.SS1.p4.2.m2.1.1.1.3" xref="S3.SS1.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.2.m2.1.1.1.3.1" xref="S3.SS1.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS1.p4.2.m2.1.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS1.p4.2.m2.1.1.1.3.2" xref="S3.SS1.p4.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.2.cmml" xref="S3.SS1.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.2">superscript</csymbol><apply id="S3.SS1.p4.2.m2.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.2.2.1.cmml" xref="S3.SS1.p4.2.m2.1.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.2.2.2.cmml" xref="S3.SS1.p4.2.m2.1.2.2.2">𝛼</ci><ci id="S3.SS1.p4.2.m2.1.2.2.3.cmml" xref="S3.SS1.p4.2.m2.1.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p4.2.m2.1.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\alpha_{i}^{(m)}</annotation></semantics></math> over the <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">T</annotation></semantics></math> question words (in Sec. <a href="#S3.SS2" title="3.2 Layout policy with sequence-to-sequence RNN ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>), and obtain the textual feature <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="x_{txt}" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><msub id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml"><mi id="S3.SS1.p4.4.m4.1.1.2" xref="S3.SS1.p4.4.m4.1.1.2.cmml">x</mi><mrow id="S3.SS1.p4.4.m4.1.1.3" xref="S3.SS1.p4.4.m4.1.1.3.cmml"><mi id="S3.SS1.p4.4.m4.1.1.3.2" xref="S3.SS1.p4.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.4.m4.1.1.3.1" xref="S3.SS1.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.4.m4.1.1.3.3" xref="S3.SS1.p4.4.m4.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.4.m4.1.1.3.1a" xref="S3.SS1.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.4.m4.1.1.3.4" xref="S3.SS1.p4.4.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><apply id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.2">𝑥</ci><apply id="S3.SS1.p4.4.m4.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3"><times id="S3.SS1.p4.4.m4.1.1.3.1.cmml" xref="S3.SS1.p4.4.m4.1.1.3.1"></times><ci id="S3.SS1.p4.4.m4.1.1.3.2.cmml" xref="S3.SS1.p4.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS1.p4.4.m4.1.1.3.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3">𝑥</ci><ci id="S3.SS1.p4.4.m4.1.1.3.4.cmml" xref="S3.SS1.p4.4.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">x_{txt}</annotation></semantics></math> for each module:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.2" class="ltx_Math" alttext="x_{txt}^{(m)}=\sum_{i=1}^{T}\alpha_{i}^{(m)}w_{i}" display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.3" xref="S3.E1.m1.2.3.cmml"><msubsup id="S3.E1.m1.2.3.2" xref="S3.E1.m1.2.3.2.cmml"><mi id="S3.E1.m1.2.3.2.2.2" xref="S3.E1.m1.2.3.2.2.2.cmml">x</mi><mrow id="S3.E1.m1.2.3.2.2.3" xref="S3.E1.m1.2.3.2.2.3.cmml"><mi id="S3.E1.m1.2.3.2.2.3.2" xref="S3.E1.m1.2.3.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.2.2.3.1" xref="S3.E1.m1.2.3.2.2.3.1.cmml">​</mo><mi id="S3.E1.m1.2.3.2.2.3.3" xref="S3.E1.m1.2.3.2.2.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.2.2.3.1a" xref="S3.E1.m1.2.3.2.2.3.1.cmml">​</mo><mi id="S3.E1.m1.2.3.2.2.3.4" xref="S3.E1.m1.2.3.2.2.3.4.cmml">t</mi></mrow><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.2.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.3.1" xref="S3.E1.m1.2.3.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.3.2" xref="S3.E1.m1.2.3.2.cmml">)</mo></mrow></msubsup><mo rspace="0.111em" id="S3.E1.m1.2.3.1" xref="S3.E1.m1.2.3.1.cmml">=</mo><mrow id="S3.E1.m1.2.3.3" xref="S3.E1.m1.2.3.3.cmml"><munderover id="S3.E1.m1.2.3.3.1" xref="S3.E1.m1.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.2.3.3.1.2.2" xref="S3.E1.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.3.3.1.2.3" xref="S3.E1.m1.2.3.3.1.2.3.cmml"><mi id="S3.E1.m1.2.3.3.1.2.3.2" xref="S3.E1.m1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.2.3.3.1.2.3.1" xref="S3.E1.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.3.3.1.2.3.3" xref="S3.E1.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.2.3.3.1.3" xref="S3.E1.m1.2.3.3.1.3.cmml">T</mi></munderover><mrow id="S3.E1.m1.2.3.3.2" xref="S3.E1.m1.2.3.3.2.cmml"><msubsup id="S3.E1.m1.2.3.3.2.2" xref="S3.E1.m1.2.3.3.2.2.cmml"><mi id="S3.E1.m1.2.3.3.2.2.2.2" xref="S3.E1.m1.2.3.3.2.2.2.2.cmml">α</mi><mi id="S3.E1.m1.2.3.3.2.2.2.3" xref="S3.E1.m1.2.3.3.2.2.2.3.cmml">i</mi><mrow id="S3.E1.m1.2.2.1.3" xref="S3.E1.m1.2.3.3.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.3.1" xref="S3.E1.m1.2.3.3.2.2.cmml">(</mo><mi id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="S3.E1.m1.2.2.1.3.2" xref="S3.E1.m1.2.3.3.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.3.2.1" xref="S3.E1.m1.2.3.3.2.1.cmml">​</mo><msub id="S3.E1.m1.2.3.3.2.3" xref="S3.E1.m1.2.3.3.2.3.cmml"><mi id="S3.E1.m1.2.3.3.2.3.2" xref="S3.E1.m1.2.3.3.2.3.2.cmml">w</mi><mi id="S3.E1.m1.2.3.3.2.3.3" xref="S3.E1.m1.2.3.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.3.cmml" xref="S3.E1.m1.2.3"><eq id="S3.E1.m1.2.3.1.cmml" xref="S3.E1.m1.2.3.1"></eq><apply id="S3.E1.m1.2.3.2.cmml" xref="S3.E1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.2.1.cmml" xref="S3.E1.m1.2.3.2">superscript</csymbol><apply id="S3.E1.m1.2.3.2.2.cmml" xref="S3.E1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.2.2.1.cmml" xref="S3.E1.m1.2.3.2">subscript</csymbol><ci id="S3.E1.m1.2.3.2.2.2.cmml" xref="S3.E1.m1.2.3.2.2.2">𝑥</ci><apply id="S3.E1.m1.2.3.2.2.3.cmml" xref="S3.E1.m1.2.3.2.2.3"><times id="S3.E1.m1.2.3.2.2.3.1.cmml" xref="S3.E1.m1.2.3.2.2.3.1"></times><ci id="S3.E1.m1.2.3.2.2.3.2.cmml" xref="S3.E1.m1.2.3.2.2.3.2">𝑡</ci><ci id="S3.E1.m1.2.3.2.2.3.3.cmml" xref="S3.E1.m1.2.3.2.2.3.3">𝑥</ci><ci id="S3.E1.m1.2.3.2.2.3.4.cmml" xref="S3.E1.m1.2.3.2.2.3.4">𝑡</ci></apply></apply><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑚</ci></apply><apply id="S3.E1.m1.2.3.3.cmml" xref="S3.E1.m1.2.3.3"><apply id="S3.E1.m1.2.3.3.1.cmml" xref="S3.E1.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.3.1.1.cmml" xref="S3.E1.m1.2.3.3.1">superscript</csymbol><apply id="S3.E1.m1.2.3.3.1.2.cmml" xref="S3.E1.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.3.1.2.1.cmml" xref="S3.E1.m1.2.3.3.1">subscript</csymbol><sum id="S3.E1.m1.2.3.3.1.2.2.cmml" xref="S3.E1.m1.2.3.3.1.2.2"></sum><apply id="S3.E1.m1.2.3.3.1.2.3.cmml" xref="S3.E1.m1.2.3.3.1.2.3"><eq id="S3.E1.m1.2.3.3.1.2.3.1.cmml" xref="S3.E1.m1.2.3.3.1.2.3.1"></eq><ci id="S3.E1.m1.2.3.3.1.2.3.2.cmml" xref="S3.E1.m1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.2.3.3.1.2.3.3.cmml" xref="S3.E1.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.3.3.1.3.cmml" xref="S3.E1.m1.2.3.3.1.3">𝑇</ci></apply><apply id="S3.E1.m1.2.3.3.2.cmml" xref="S3.E1.m1.2.3.3.2"><times id="S3.E1.m1.2.3.3.2.1.cmml" xref="S3.E1.m1.2.3.3.2.1"></times><apply id="S3.E1.m1.2.3.3.2.2.cmml" xref="S3.E1.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.3.2.2.1.cmml" xref="S3.E1.m1.2.3.3.2.2">superscript</csymbol><apply id="S3.E1.m1.2.3.3.2.2.2.cmml" xref="S3.E1.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.3.2.2.2.1.cmml" xref="S3.E1.m1.2.3.3.2.2">subscript</csymbol><ci id="S3.E1.m1.2.3.3.2.2.2.2.cmml" xref="S3.E1.m1.2.3.3.2.2.2.2">𝛼</ci><ci id="S3.E1.m1.2.3.3.2.2.2.3.cmml" xref="S3.E1.m1.2.3.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1">𝑚</ci></apply><apply id="S3.E1.m1.2.3.3.2.3.cmml" xref="S3.E1.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.3.2.3.1.cmml" xref="S3.E1.m1.2.3.3.2.3">subscript</csymbol><ci id="S3.E1.m1.2.3.3.2.3.2.cmml" xref="S3.E1.m1.2.3.3.2.3.2">𝑤</ci><ci id="S3.E1.m1.2.3.3.2.3.3.cmml" xref="S3.E1.m1.2.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">x_{txt}^{(m)}=\sum_{i=1}^{T}\alpha_{i}^{(m)}w_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.9" class="ltx_p">where <math id="S3.SS1.p4.5.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS1.p4.5.m1.1a"><msub id="S3.SS1.p4.5.m1.1.1" xref="S3.SS1.p4.5.m1.1.1.cmml"><mi id="S3.SS1.p4.5.m1.1.1.2" xref="S3.SS1.p4.5.m1.1.1.2.cmml">w</mi><mi id="S3.SS1.p4.5.m1.1.1.3" xref="S3.SS1.p4.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m1.1b"><apply id="S3.SS1.p4.5.m1.1.1.cmml" xref="S3.SS1.p4.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m1.1.1.1.cmml" xref="S3.SS1.p4.5.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.5.m1.1.1.2.cmml" xref="S3.SS1.p4.5.m1.1.1.2">𝑤</ci><ci id="S3.SS1.p4.5.m1.1.1.3.cmml" xref="S3.SS1.p4.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m1.1c">w_{i}</annotation></semantics></math> is the word embedding vector for word <math id="S3.SS1.p4.6.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p4.6.m2.1a"><mi id="S3.SS1.p4.6.m2.1.1" xref="S3.SS1.p4.6.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m2.1b"><ci id="S3.SS1.p4.6.m2.1.1.cmml" xref="S3.SS1.p4.6.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m2.1c">i</annotation></semantics></math> in the question. At runtime, the modules can be assembled into a network according to a layout <math id="S3.SS1.p4.7.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p4.7.m3.1a"><mi id="S3.SS1.p4.7.m3.1.1" xref="S3.SS1.p4.7.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m3.1b"><ci id="S3.SS1.p4.7.m3.1.1.cmml" xref="S3.SS1.p4.7.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m3.1c">l</annotation></semantics></math>, which is a computation expression consisting of modules, such as <math id="S3.SS1.p4.8.m4.2" class="ltx_Math" alttext="f_{m2}(f_{m4}(f_{m1}),f_{m3}(f_{m1},f_{m1}))" display="inline"><semantics id="S3.SS1.p4.8.m4.2a"><mrow id="S3.SS1.p4.8.m4.2.2" xref="S3.SS1.p4.8.m4.2.2.cmml"><msub id="S3.SS1.p4.8.m4.2.2.4" xref="S3.SS1.p4.8.m4.2.2.4.cmml"><mi id="S3.SS1.p4.8.m4.2.2.4.2" xref="S3.SS1.p4.8.m4.2.2.4.2.cmml">f</mi><mrow id="S3.SS1.p4.8.m4.2.2.4.3" xref="S3.SS1.p4.8.m4.2.2.4.3.cmml"><mi id="S3.SS1.p4.8.m4.2.2.4.3.2" xref="S3.SS1.p4.8.m4.2.2.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.2.2.4.3.1" xref="S3.SS1.p4.8.m4.2.2.4.3.1.cmml">​</mo><mn id="S3.SS1.p4.8.m4.2.2.4.3.3" xref="S3.SS1.p4.8.m4.2.2.4.3.3.cmml">2</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.2.2.3" xref="S3.SS1.p4.8.m4.2.2.3.cmml">​</mo><mrow id="S3.SS1.p4.8.m4.2.2.2.2" xref="S3.SS1.p4.8.m4.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p4.8.m4.2.2.2.2.3" xref="S3.SS1.p4.8.m4.2.2.2.3.cmml">(</mo><mrow id="S3.SS1.p4.8.m4.1.1.1.1.1" xref="S3.SS1.p4.8.m4.1.1.1.1.1.cmml"><msub id="S3.SS1.p4.8.m4.1.1.1.1.1.3" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p4.8.m4.1.1.1.1.1.3.2" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S3.SS1.p4.8.m4.1.1.1.1.1.3.3" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.2" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.1" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.1.cmml">​</mo><mn id="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.3" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.3.cmml">4</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.1.1.1.1.1.2" xref="S3.SS1.p4.8.m4.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.2" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.2.cmml">f</mi><mrow id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.1" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mn id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.3" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p4.8.m4.2.2.2.2.4" xref="S3.SS1.p4.8.m4.2.2.2.3.cmml">,</mo><mrow id="S3.SS1.p4.8.m4.2.2.2.2.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.cmml"><msub id="S3.SS1.p4.8.m4.2.2.2.2.2.4" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.cmml"><mi id="S3.SS1.p4.8.m4.2.2.2.2.2.4.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.2.cmml">f</mi><mrow id="S3.SS1.p4.8.m4.2.2.2.2.2.4.3" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.cmml"><mi id="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.1" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.1.cmml">​</mo><mn id="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.3" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.3.cmml">3</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.2.2.2.2.2.3" xref="S3.SS1.p4.8.m4.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.3" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.cmml"><mi id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.2.cmml">f</mi><mrow id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.1" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.1.cmml">​</mo><mn id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.3" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.4" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.2.cmml">f</mi><mrow id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.2" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.1" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.1.cmml">​</mo><mn id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.3" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.5" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.p4.8.m4.2.2.2.2.5" xref="S3.SS1.p4.8.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m4.2b"><apply id="S3.SS1.p4.8.m4.2.2.cmml" xref="S3.SS1.p4.8.m4.2.2"><times id="S3.SS1.p4.8.m4.2.2.3.cmml" xref="S3.SS1.p4.8.m4.2.2.3"></times><apply id="S3.SS1.p4.8.m4.2.2.4.cmml" xref="S3.SS1.p4.8.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m4.2.2.4.1.cmml" xref="S3.SS1.p4.8.m4.2.2.4">subscript</csymbol><ci id="S3.SS1.p4.8.m4.2.2.4.2.cmml" xref="S3.SS1.p4.8.m4.2.2.4.2">𝑓</ci><apply id="S3.SS1.p4.8.m4.2.2.4.3.cmml" xref="S3.SS1.p4.8.m4.2.2.4.3"><times id="S3.SS1.p4.8.m4.2.2.4.3.1.cmml" xref="S3.SS1.p4.8.m4.2.2.4.3.1"></times><ci id="S3.SS1.p4.8.m4.2.2.4.3.2.cmml" xref="S3.SS1.p4.8.m4.2.2.4.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p4.8.m4.2.2.4.3.3.cmml" xref="S3.SS1.p4.8.m4.2.2.4.3.3">2</cn></apply></apply><interval closure="open" id="S3.SS1.p4.8.m4.2.2.2.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2"><apply id="S3.SS1.p4.8.m4.1.1.1.1.1.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1"><times id="S3.SS1.p4.8.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.2"></times><apply id="S3.SS1.p4.8.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p4.8.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.2">𝑓</ci><apply id="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.3"><times id="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.1"></times><ci id="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.3.3.3">4</cn></apply></apply><apply id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.2">𝑓</ci><apply id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3"><times id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.SS1.p4.8.m4.2.2.2.2.2.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2"><times id="S3.SS1.p4.8.m4.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.3"></times><apply id="S3.SS1.p4.8.m4.2.2.2.2.2.4.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m4.2.2.2.2.2.4.1.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4">subscript</csymbol><ci id="S3.SS1.p4.8.m4.2.2.2.2.2.4.2.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.2">𝑓</ci><apply id="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.3"><times id="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.1.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.1"></times><ci id="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.2.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.4.3.3">3</cn></apply></apply><interval closure="open" id="S3.SS1.p4.8.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2"><apply id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.2">𝑓</ci><apply id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3"><times id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.1"></times><ci id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.2">𝑓</ci><apply id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3"><times id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.1"></times><ci id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p4.8.m4.2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m4.2c">f_{m2}(f_{m4}(f_{m1}),f_{m3}(f_{m1},f_{m1}))</annotation></semantics></math>, where each of <math id="S3.SS1.p4.9.m5.3" class="ltx_Math" alttext="f_{m1},\cdots,f_{m4}" display="inline"><semantics id="S3.SS1.p4.9.m5.3a"><mrow id="S3.SS1.p4.9.m5.3.3.2" xref="S3.SS1.p4.9.m5.3.3.3.cmml"><msub id="S3.SS1.p4.9.m5.2.2.1.1" xref="S3.SS1.p4.9.m5.2.2.1.1.cmml"><mi id="S3.SS1.p4.9.m5.2.2.1.1.2" xref="S3.SS1.p4.9.m5.2.2.1.1.2.cmml">f</mi><mrow id="S3.SS1.p4.9.m5.2.2.1.1.3" xref="S3.SS1.p4.9.m5.2.2.1.1.3.cmml"><mi id="S3.SS1.p4.9.m5.2.2.1.1.3.2" xref="S3.SS1.p4.9.m5.2.2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.9.m5.2.2.1.1.3.1" xref="S3.SS1.p4.9.m5.2.2.1.1.3.1.cmml">​</mo><mn id="S3.SS1.p4.9.m5.2.2.1.1.3.3" xref="S3.SS1.p4.9.m5.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p4.9.m5.3.3.2.3" xref="S3.SS1.p4.9.m5.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p4.9.m5.1.1" xref="S3.SS1.p4.9.m5.1.1.cmml">⋯</mi><mo id="S3.SS1.p4.9.m5.3.3.2.4" xref="S3.SS1.p4.9.m5.3.3.3.cmml">,</mo><msub id="S3.SS1.p4.9.m5.3.3.2.2" xref="S3.SS1.p4.9.m5.3.3.2.2.cmml"><mi id="S3.SS1.p4.9.m5.3.3.2.2.2" xref="S3.SS1.p4.9.m5.3.3.2.2.2.cmml">f</mi><mrow id="S3.SS1.p4.9.m5.3.3.2.2.3" xref="S3.SS1.p4.9.m5.3.3.2.2.3.cmml"><mi id="S3.SS1.p4.9.m5.3.3.2.2.3.2" xref="S3.SS1.p4.9.m5.3.3.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.9.m5.3.3.2.2.3.1" xref="S3.SS1.p4.9.m5.3.3.2.2.3.1.cmml">​</mo><mn id="S3.SS1.p4.9.m5.3.3.2.2.3.3" xref="S3.SS1.p4.9.m5.3.3.2.2.3.3.cmml">4</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m5.3b"><list id="S3.SS1.p4.9.m5.3.3.3.cmml" xref="S3.SS1.p4.9.m5.3.3.2"><apply id="S3.SS1.p4.9.m5.2.2.1.1.cmml" xref="S3.SS1.p4.9.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m5.2.2.1.1.1.cmml" xref="S3.SS1.p4.9.m5.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p4.9.m5.2.2.1.1.2.cmml" xref="S3.SS1.p4.9.m5.2.2.1.1.2">𝑓</ci><apply id="S3.SS1.p4.9.m5.2.2.1.1.3.cmml" xref="S3.SS1.p4.9.m5.2.2.1.1.3"><times id="S3.SS1.p4.9.m5.2.2.1.1.3.1.cmml" xref="S3.SS1.p4.9.m5.2.2.1.1.3.1"></times><ci id="S3.SS1.p4.9.m5.2.2.1.1.3.2.cmml" xref="S3.SS1.p4.9.m5.2.2.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p4.9.m5.2.2.1.1.3.3.cmml" xref="S3.SS1.p4.9.m5.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p4.9.m5.1.1.cmml" xref="S3.SS1.p4.9.m5.1.1">⋯</ci><apply id="S3.SS1.p4.9.m5.3.3.2.2.cmml" xref="S3.SS1.p4.9.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m5.3.3.2.2.1.cmml" xref="S3.SS1.p4.9.m5.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p4.9.m5.3.3.2.2.2.cmml" xref="S3.SS1.p4.9.m5.3.3.2.2.2">𝑓</ci><apply id="S3.SS1.p4.9.m5.3.3.2.2.3.cmml" xref="S3.SS1.p4.9.m5.3.3.2.2.3"><times id="S3.SS1.p4.9.m5.3.3.2.2.3.1.cmml" xref="S3.SS1.p4.9.m5.3.3.2.2.3.1"></times><ci id="S3.SS1.p4.9.m5.3.3.2.2.3.2.cmml" xref="S3.SS1.p4.9.m5.3.3.2.2.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p4.9.m5.3.3.2.2.3.3.cmml" xref="S3.SS1.p4.9.m5.3.3.2.2.3.3">4</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m5.3c">f_{m1},\cdots,f_{m4}</annotation></semantics></math> is one of the modules in Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Attentional neural modules ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Layout policy with sequence-to-sequence RNN</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.6" class="ltx_p">We would like to predict the most suitable reasoning structure tailored to each question. For an input question <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">q</annotation></semantics></math> such as <span id="S3.SS2.p1.6.1" class="ltx_text ltx_font_italic">What object is next to the table?</span>, our layout policy outputs a probability distribution <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="p(l|q)" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"></times><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑝</ci><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">p(l|q)</annotation></semantics></math>, and we can sample from <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="p(l|q)" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.3.m3.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.1.1.1.1.2" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.3.m3.1.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.p1.3.m3.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS2.p1.3.m3.1.1.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.SS2.p1.3.m3.1.1.1.1.3" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><times id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"></times><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑝</ci><apply id="S3.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">p(l|q)</annotation></semantics></math> to obtain high probability layout <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">l</annotation></semantics></math> such as <span id="S3.SS2.p1.6.2" class="ltx_text ltx_font_typewriter">describe(relocate(find()))</span> that are effective for answering the question <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">q</annotation></semantics></math>. Then, a neural network is assembled according to the predicted layout <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">l</annotation></semantics></math> to output an answer.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">Unlike in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> where the layout search space is restricted to a few parser candidates, in this work, we search over a much larger layout space: in our model, the layout policy <math id="S3.SS2.p2.1.m1.2" class="ltx_Math" alttext="p(l|q;\theta_{layout})" display="inline"><semantics id="S3.SS2.p2.1.m1.2a"><mrow id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml"><mi id="S3.SS2.p2.1.m1.2.2.3" xref="S3.SS2.p2.1.m1.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.2.2.2" xref="S3.SS2.p2.1.m1.2.2.2.cmml">​</mo><mrow id="S3.SS2.p2.1.m1.2.2.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.2.2.1.1.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.1.m1.2.2.1.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.3.cmml">l</mi><mo fence="false" id="S3.SS2.p2.1.m1.2.2.1.1.1.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2.cmml">|</mo><mrow id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">q</mi><mo id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.2.cmml">;</mo><msub id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1a" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.4" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.4.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1b" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.5" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1c" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.6" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1d" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.7" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.7.cmml">t</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.SS2.p2.1.m1.2.2.1.1.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.2b"><apply id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2"><times id="S3.SS2.p2.1.m1.2.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2.2"></times><ci id="S3.SS2.p2.1.m1.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.3">𝑝</ci><apply id="S3.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2">conditional</csymbol><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.3">𝑙</ci><list id="S3.SS2.p2.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑞</ci><apply id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3"><times id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.3">𝑎</ci><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.4">𝑦</ci><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.5.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.5">𝑜</ci><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.6.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.6">𝑢</ci><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.7.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.7">𝑡</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.2c">p(l|q;\theta_{layout})</annotation></semantics></math> predicts a distribution over the space of <span id="S3.SS2.p2.4.1" class="ltx_text ltx_font_italic">all possible layouts</span>. Every possible layout <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">l</annotation></semantics></math> is an expression that consists of neural modules, such as <math id="S3.SS2.p2.3.m3.2" class="ltx_Math" alttext="f_{m2}(f_{m1},f_{m3}(f_{m1},f_{m1}))" display="inline"><semantics id="S3.SS2.p2.3.m3.2a"><mrow id="S3.SS2.p2.3.m3.2.2" xref="S3.SS2.p2.3.m3.2.2.cmml"><msub id="S3.SS2.p2.3.m3.2.2.4" xref="S3.SS2.p2.3.m3.2.2.4.cmml"><mi id="S3.SS2.p2.3.m3.2.2.4.2" xref="S3.SS2.p2.3.m3.2.2.4.2.cmml">f</mi><mrow id="S3.SS2.p2.3.m3.2.2.4.3" xref="S3.SS2.p2.3.m3.2.2.4.3.cmml"><mi id="S3.SS2.p2.3.m3.2.2.4.3.2" xref="S3.SS2.p2.3.m3.2.2.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.2.2.4.3.1" xref="S3.SS2.p2.3.m3.2.2.4.3.1.cmml">​</mo><mn id="S3.SS2.p2.3.m3.2.2.4.3.3" xref="S3.SS2.p2.3.m3.2.2.4.3.3.cmml">2</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.2.2.3" xref="S3.SS2.p2.3.m3.2.2.3.cmml">​</mo><mrow id="S3.SS2.p2.3.m3.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m3.2.2.2.2.3" xref="S3.SS2.p2.3.m3.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.3.m3.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.cmml">f</mi><mrow id="S3.SS2.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.1.1.1.3.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.1.cmml">​</mo><mn id="S3.SS2.p2.3.m3.1.1.1.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.p2.3.m3.2.2.2.2.4" xref="S3.SS2.p2.3.m3.2.2.2.3.cmml">,</mo><mrow id="S3.SS2.p2.3.m3.2.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.cmml"><msub id="S3.SS2.p2.3.m3.2.2.2.2.2.4" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.cmml"><mi id="S3.SS2.p2.3.m3.2.2.2.2.2.4.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.2.cmml">f</mi><mrow id="S3.SS2.p2.3.m3.2.2.2.2.2.4.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.cmml"><mi id="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.1" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.1.cmml">​</mo><mn id="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.3.cmml">3</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.2.2.2.2.2.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.2.cmml">f</mi><mrow id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.1" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.1.cmml">​</mo><mn id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.4" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.2.cmml">f</mi><mrow id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.1" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.1.cmml">​</mo><mn id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.3" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.5" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p2.3.m3.2.2.2.2.5" xref="S3.SS2.p2.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.2b"><apply id="S3.SS2.p2.3.m3.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2"><times id="S3.SS2.p2.3.m3.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.3"></times><apply id="S3.SS2.p2.3.m3.2.2.4.cmml" xref="S3.SS2.p2.3.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.4.1.cmml" xref="S3.SS2.p2.3.m3.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.3.m3.2.2.4.2.cmml" xref="S3.SS2.p2.3.m3.2.2.4.2">𝑓</ci><apply id="S3.SS2.p2.3.m3.2.2.4.3.cmml" xref="S3.SS2.p2.3.m3.2.2.4.3"><times id="S3.SS2.p2.3.m3.2.2.4.3.1.cmml" xref="S3.SS2.p2.3.m3.2.2.4.3.1"></times><ci id="S3.SS2.p2.3.m3.2.2.4.3.2.cmml" xref="S3.SS2.p2.3.m3.2.2.4.3.2">𝑚</ci><cn type="integer" id="S3.SS2.p2.3.m3.2.2.4.3.3.cmml" xref="S3.SS2.p2.3.m3.2.2.4.3.3">2</cn></apply></apply><interval closure="open" id="S3.SS2.p2.3.m3.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2"><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2">𝑓</ci><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3"><times id="S3.SS2.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS2.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS2.p2.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2"><times id="S3.SS2.p2.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.3"></times><apply id="S3.SS2.p2.3.m3.2.2.2.2.2.4.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.2.2.2.4.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.4.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.2">𝑓</ci><apply id="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.3"><times id="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.1"></times><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.2">𝑚</ci><cn type="integer" id="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.4.3.3">3</cn></apply></apply><interval closure="open" id="S3.SS2.p2.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2"><apply id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.2">𝑓</ci><apply id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3"><times id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.1"></times><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.2">𝑓</ci><apply id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3"><times id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.2">𝑚</ci><cn type="integer" id="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.2c">f_{m2}(f_{m1},f_{m3}(f_{m1},f_{m1}))</annotation></semantics></math>, and can be represented as a syntax tree. So each layout expression can be mapped one-to-one into a linearized sequence <math id="S3.SS2.p2.4.m4.2" class="ltx_Math" alttext="l=\{m^{(t)}\}" display="inline"><semantics id="S3.SS2.p2.4.m4.2a"><mrow id="S3.SS2.p2.4.m4.2.2" xref="S3.SS2.p2.4.m4.2.2.cmml"><mi id="S3.SS2.p2.4.m4.2.2.3" xref="S3.SS2.p2.4.m4.2.2.3.cmml">l</mi><mo id="S3.SS2.p2.4.m4.2.2.2" xref="S3.SS2.p2.4.m4.2.2.2.cmml">=</mo><mrow id="S3.SS2.p2.4.m4.2.2.1.1" xref="S3.SS2.p2.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m4.2.2.1.1.2" xref="S3.SS2.p2.4.m4.2.2.1.2.cmml">{</mo><msup id="S3.SS2.p2.4.m4.2.2.1.1.1" xref="S3.SS2.p2.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.4.m4.2.2.1.1.1.2" xref="S3.SS2.p2.4.m4.2.2.1.1.1.2.cmml">m</mi><mrow id="S3.SS2.p2.4.m4.1.1.1.3" xref="S3.SS2.p2.4.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m4.1.1.1.3.1" xref="S3.SS2.p2.4.m4.2.2.1.1.1.cmml">(</mo><mi id="S3.SS2.p2.4.m4.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p2.4.m4.1.1.1.3.2" xref="S3.SS2.p2.4.m4.2.2.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.SS2.p2.4.m4.2.2.1.1.3" xref="S3.SS2.p2.4.m4.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.2b"><apply id="S3.SS2.p2.4.m4.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2"><eq id="S3.SS2.p2.4.m4.2.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2.2"></eq><ci id="S3.SS2.p2.4.m4.2.2.3.cmml" xref="S3.SS2.p2.4.m4.2.2.3">𝑙</ci><set id="S3.SS2.p2.4.m4.2.2.1.2.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1"><apply id="S3.SS2.p2.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.2.2.1.1.1.2">𝑚</ci><ci id="S3.SS2.p2.4.m4.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.2c">l=\{m^{(t)}\}</annotation></semantics></math> using Reverse Polish Notation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> (the post-order traversal over the syntax tree). Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2 Layout policy with sequence-to-sequence RNN ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows an example for an expression and its linearized module token sequence.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/1704.05526/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="207" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>An example showing how an arbitrary layout expression can be linearized as a sequence of module tokens.</figcaption>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.11" class="ltx_p">After linearizing each layout <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">l</annotation></semantics></math> into a sequence of module tokens <math id="S3.SS2.p3.2.m2.2" class="ltx_Math" alttext="\{m^{(t)}\}" display="inline"><semantics id="S3.SS2.p3.2.m2.2a"><mrow id="S3.SS2.p3.2.m2.2.2.1" xref="S3.SS2.p3.2.m2.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p3.2.m2.2.2.1.2" xref="S3.SS2.p3.2.m2.2.2.2.cmml">{</mo><msup id="S3.SS2.p3.2.m2.2.2.1.1" xref="S3.SS2.p3.2.m2.2.2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.2.2.1.1.2" xref="S3.SS2.p3.2.m2.2.2.1.1.2.cmml">m</mi><mrow id="S3.SS2.p3.2.m2.1.1.1.3" xref="S3.SS2.p3.2.m2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.2.m2.1.1.1.3.1" xref="S3.SS2.p3.2.m2.2.2.1.1.cmml">(</mo><mi id="S3.SS2.p3.2.m2.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p3.2.m2.1.1.1.3.2" xref="S3.SS2.p3.2.m2.2.2.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.SS2.p3.2.m2.2.2.1.3" xref="S3.SS2.p3.2.m2.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.2b"><set id="S3.SS2.p3.2.m2.2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2.1"><apply id="S3.SS2.p3.2.m2.2.2.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1">superscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1.2">𝑚</ci><ci id="S3.SS2.p3.2.m2.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.2c">\{m^{(t)}\}</annotation></semantics></math>, the layout prediction problem turns into a sequence-to-sequence learning problem from questions to module tokens. We address this problem using the attentional Recurrent Neural Network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. First, we embed every word <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">i</annotation></semantics></math> in the question into a vector <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">w</mi><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝑤</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">w_{i}</annotation></semantics></math> (also embedding all module tokens similarly), and use a multi-layer LSTM network as the encoder of the input question. For a question <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">q</annotation></semantics></math> with <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">T</annotation></semantics></math> words, the encoder LSTM outputs a length-<math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">T</annotation></semantics></math> sequence <math id="S3.SS2.p3.8.m8.4" class="ltx_Math" alttext="[h_{1},h_{2},\cdots,h_{T}]" display="inline"><semantics id="S3.SS2.p3.8.m8.4a"><mrow id="S3.SS2.p3.8.m8.4.4.3" xref="S3.SS2.p3.8.m8.4.4.4.cmml"><mo stretchy="false" id="S3.SS2.p3.8.m8.4.4.3.4" xref="S3.SS2.p3.8.m8.4.4.4.cmml">[</mo><msub id="S3.SS2.p3.8.m8.2.2.1.1" xref="S3.SS2.p3.8.m8.2.2.1.1.cmml"><mi id="S3.SS2.p3.8.m8.2.2.1.1.2" xref="S3.SS2.p3.8.m8.2.2.1.1.2.cmml">h</mi><mn id="S3.SS2.p3.8.m8.2.2.1.1.3" xref="S3.SS2.p3.8.m8.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p3.8.m8.4.4.3.5" xref="S3.SS2.p3.8.m8.4.4.4.cmml">,</mo><msub id="S3.SS2.p3.8.m8.3.3.2.2" xref="S3.SS2.p3.8.m8.3.3.2.2.cmml"><mi id="S3.SS2.p3.8.m8.3.3.2.2.2" xref="S3.SS2.p3.8.m8.3.3.2.2.2.cmml">h</mi><mn id="S3.SS2.p3.8.m8.3.3.2.2.3" xref="S3.SS2.p3.8.m8.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p3.8.m8.4.4.3.6" xref="S3.SS2.p3.8.m8.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">⋯</mi><mo id="S3.SS2.p3.8.m8.4.4.3.7" xref="S3.SS2.p3.8.m8.4.4.4.cmml">,</mo><msub id="S3.SS2.p3.8.m8.4.4.3.3" xref="S3.SS2.p3.8.m8.4.4.3.3.cmml"><mi id="S3.SS2.p3.8.m8.4.4.3.3.2" xref="S3.SS2.p3.8.m8.4.4.3.3.2.cmml">h</mi><mi id="S3.SS2.p3.8.m8.4.4.3.3.3" xref="S3.SS2.p3.8.m8.4.4.3.3.3.cmml">T</mi></msub><mo stretchy="false" id="S3.SS2.p3.8.m8.4.4.3.8" xref="S3.SS2.p3.8.m8.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.4b"><list id="S3.SS2.p3.8.m8.4.4.4.cmml" xref="S3.SS2.p3.8.m8.4.4.3"><apply id="S3.SS2.p3.8.m8.2.2.1.1.cmml" xref="S3.SS2.p3.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.2.2.1.1.1.cmml" xref="S3.SS2.p3.8.m8.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m8.2.2.1.1.2.cmml" xref="S3.SS2.p3.8.m8.2.2.1.1.2">ℎ</ci><cn type="integer" id="S3.SS2.p3.8.m8.2.2.1.1.3.cmml" xref="S3.SS2.p3.8.m8.2.2.1.1.3">1</cn></apply><apply id="S3.SS2.p3.8.m8.3.3.2.2.cmml" xref="S3.SS2.p3.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.3.3.2.2.1.cmml" xref="S3.SS2.p3.8.m8.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p3.8.m8.3.3.2.2.2.cmml" xref="S3.SS2.p3.8.m8.3.3.2.2.2">ℎ</ci><cn type="integer" id="S3.SS2.p3.8.m8.3.3.2.2.3.cmml" xref="S3.SS2.p3.8.m8.3.3.2.2.3">2</cn></apply><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">⋯</ci><apply id="S3.SS2.p3.8.m8.4.4.3.3.cmml" xref="S3.SS2.p3.8.m8.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.4.4.3.3.1.cmml" xref="S3.SS2.p3.8.m8.4.4.3.3">subscript</csymbol><ci id="S3.SS2.p3.8.m8.4.4.3.3.2.cmml" xref="S3.SS2.p3.8.m8.4.4.3.3.2">ℎ</ci><ci id="S3.SS2.p3.8.m8.4.4.3.3.3.cmml" xref="S3.SS2.p3.8.m8.4.4.3.3.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.4c">[h_{1},h_{2},\cdots,h_{T}]</annotation></semantics></math>. The decoder is a LSTM network that has the same structure as the encoder but different parameters. Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, at each time step in the decoder LSTM, a soft attention map over the input sequence is predicted. At decoder time-step <math id="S3.SS2.p3.9.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p3.9.m9.1a"><mi id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><ci id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">t</annotation></semantics></math>, the attention weights <math id="S3.SS2.p3.10.m10.1" class="ltx_Math" alttext="\alpha_{ti}" display="inline"><semantics id="S3.SS2.p3.10.m10.1a"><msub id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml"><mi id="S3.SS2.p3.10.m10.1.1.2" xref="S3.SS2.p3.10.m10.1.1.2.cmml">α</mi><mrow id="S3.SS2.p3.10.m10.1.1.3" xref="S3.SS2.p3.10.m10.1.1.3.cmml"><mi id="S3.SS2.p3.10.m10.1.1.3.2" xref="S3.SS2.p3.10.m10.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.10.m10.1.1.3.1" xref="S3.SS2.p3.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.10.m10.1.1.3.3" xref="S3.SS2.p3.10.m10.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><apply id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m10.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.2">𝛼</ci><apply id="S3.SS2.p3.10.m10.1.1.3.cmml" xref="S3.SS2.p3.10.m10.1.1.3"><times id="S3.SS2.p3.10.m10.1.1.3.1.cmml" xref="S3.SS2.p3.10.m10.1.1.3.1"></times><ci id="S3.SS2.p3.10.m10.1.1.3.2.cmml" xref="S3.SS2.p3.10.m10.1.1.3.2">𝑡</ci><ci id="S3.SS2.p3.10.m10.1.1.3.3.cmml" xref="S3.SS2.p3.10.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">\alpha_{ti}</annotation></semantics></math> of input word at position <math id="S3.SS2.p3.11.m11.3" class="ltx_Math" alttext="i\in\{1,\cdots,T\}" display="inline"><semantics id="S3.SS2.p3.11.m11.3a"><mrow id="S3.SS2.p3.11.m11.3.4" xref="S3.SS2.p3.11.m11.3.4.cmml"><mi id="S3.SS2.p3.11.m11.3.4.2" xref="S3.SS2.p3.11.m11.3.4.2.cmml">i</mi><mo id="S3.SS2.p3.11.m11.3.4.1" xref="S3.SS2.p3.11.m11.3.4.1.cmml">∈</mo><mrow id="S3.SS2.p3.11.m11.3.4.3.2" xref="S3.SS2.p3.11.m11.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.p3.11.m11.3.4.3.2.1" xref="S3.SS2.p3.11.m11.3.4.3.1.cmml">{</mo><mn id="S3.SS2.p3.11.m11.1.1" xref="S3.SS2.p3.11.m11.1.1.cmml">1</mn><mo id="S3.SS2.p3.11.m11.3.4.3.2.2" xref="S3.SS2.p3.11.m11.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.11.m11.2.2" xref="S3.SS2.p3.11.m11.2.2.cmml">⋯</mi><mo id="S3.SS2.p3.11.m11.3.4.3.2.3" xref="S3.SS2.p3.11.m11.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p3.11.m11.3.3" xref="S3.SS2.p3.11.m11.3.3.cmml">T</mi><mo stretchy="false" id="S3.SS2.p3.11.m11.3.4.3.2.4" xref="S3.SS2.p3.11.m11.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m11.3b"><apply id="S3.SS2.p3.11.m11.3.4.cmml" xref="S3.SS2.p3.11.m11.3.4"><in id="S3.SS2.p3.11.m11.3.4.1.cmml" xref="S3.SS2.p3.11.m11.3.4.1"></in><ci id="S3.SS2.p3.11.m11.3.4.2.cmml" xref="S3.SS2.p3.11.m11.3.4.2">𝑖</ci><set id="S3.SS2.p3.11.m11.3.4.3.1.cmml" xref="S3.SS2.p3.11.m11.3.4.3.2"><cn type="integer" id="S3.SS2.p3.11.m11.1.1.cmml" xref="S3.SS2.p3.11.m11.1.1">1</cn><ci id="S3.SS2.p3.11.m11.2.2.cmml" xref="S3.SS2.p3.11.m11.2.2">⋯</ci><ci id="S3.SS2.p3.11.m11.3.3.cmml" xref="S3.SS2.p3.11.m11.3.3">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m11.3c">i\in\{1,\cdots,T\}</annotation></semantics></math> are predicted as</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle u_{ti}" display="inline"><semantics id="S3.E2.m1.1a"><msub id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">u</mi><mrow id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.3.1" xref="S3.E2.m1.1.1.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝑢</ci><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><times id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1"></times><ci id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2">𝑡</ci><ci id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle u_{ti}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E2.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E2.m2.1a"><mo id="S3.E2.m2.1.1" xref="S3.E2.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E2.m2.1b"><eq id="S3.E2.m2.1.1.cmml" xref="S3.E2.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m3.2" class="ltx_Math" alttext="\displaystyle v^{T}\tanh(W_{1}h_{i}+W_{2}h_{t})" display="inline"><semantics id="S3.E2.m3.2a"><mrow id="S3.E2.m3.2.2" xref="S3.E2.m3.2.2.cmml"><msup id="S3.E2.m3.2.2.3" xref="S3.E2.m3.2.2.3.cmml"><mi id="S3.E2.m3.2.2.3.2" xref="S3.E2.m3.2.2.3.2.cmml">v</mi><mi id="S3.E2.m3.2.2.3.3" xref="S3.E2.m3.2.2.3.3.cmml">T</mi></msup><mo lspace="0.167em" rspace="0em" id="S3.E2.m3.2.2.2" xref="S3.E2.m3.2.2.2.cmml">​</mo><mrow id="S3.E2.m3.2.2.1.1" xref="S3.E2.m3.2.2.1.2.cmml"><mi id="S3.E2.m3.1.1" xref="S3.E2.m3.1.1.cmml">tanh</mi><mo id="S3.E2.m3.2.2.1.1a" xref="S3.E2.m3.2.2.1.2.cmml">⁡</mo><mrow id="S3.E2.m3.2.2.1.1.1" xref="S3.E2.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.E2.m3.2.2.1.1.1.2" xref="S3.E2.m3.2.2.1.2.cmml">(</mo><mrow id="S3.E2.m3.2.2.1.1.1.1" xref="S3.E2.m3.2.2.1.1.1.1.cmml"><mrow id="S3.E2.m3.2.2.1.1.1.1.2" xref="S3.E2.m3.2.2.1.1.1.1.2.cmml"><msub id="S3.E2.m3.2.2.1.1.1.1.2.2" xref="S3.E2.m3.2.2.1.1.1.1.2.2.cmml"><mi id="S3.E2.m3.2.2.1.1.1.1.2.2.2" xref="S3.E2.m3.2.2.1.1.1.1.2.2.2.cmml">W</mi><mn id="S3.E2.m3.2.2.1.1.1.1.2.2.3" xref="S3.E2.m3.2.2.1.1.1.1.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E2.m3.2.2.1.1.1.1.2.1" xref="S3.E2.m3.2.2.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E2.m3.2.2.1.1.1.1.2.3" xref="S3.E2.m3.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E2.m3.2.2.1.1.1.1.2.3.2" xref="S3.E2.m3.2.2.1.1.1.1.2.3.2.cmml">h</mi><mi id="S3.E2.m3.2.2.1.1.1.1.2.3.3" xref="S3.E2.m3.2.2.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E2.m3.2.2.1.1.1.1.1" xref="S3.E2.m3.2.2.1.1.1.1.1.cmml">+</mo><mrow id="S3.E2.m3.2.2.1.1.1.1.3" xref="S3.E2.m3.2.2.1.1.1.1.3.cmml"><msub id="S3.E2.m3.2.2.1.1.1.1.3.2" xref="S3.E2.m3.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E2.m3.2.2.1.1.1.1.3.2.2" xref="S3.E2.m3.2.2.1.1.1.1.3.2.2.cmml">W</mi><mn id="S3.E2.m3.2.2.1.1.1.1.3.2.3" xref="S3.E2.m3.2.2.1.1.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E2.m3.2.2.1.1.1.1.3.1" xref="S3.E2.m3.2.2.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E2.m3.2.2.1.1.1.1.3.3" xref="S3.E2.m3.2.2.1.1.1.1.3.3.cmml"><mi id="S3.E2.m3.2.2.1.1.1.1.3.3.2" xref="S3.E2.m3.2.2.1.1.1.1.3.3.2.cmml">h</mi><mi id="S3.E2.m3.2.2.1.1.1.1.3.3.3" xref="S3.E2.m3.2.2.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E2.m3.2.2.1.1.1.3" xref="S3.E2.m3.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m3.2b"><apply id="S3.E2.m3.2.2.cmml" xref="S3.E2.m3.2.2"><times id="S3.E2.m3.2.2.2.cmml" xref="S3.E2.m3.2.2.2"></times><apply id="S3.E2.m3.2.2.3.cmml" xref="S3.E2.m3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m3.2.2.3.1.cmml" xref="S3.E2.m3.2.2.3">superscript</csymbol><ci id="S3.E2.m3.2.2.3.2.cmml" xref="S3.E2.m3.2.2.3.2">𝑣</ci><ci id="S3.E2.m3.2.2.3.3.cmml" xref="S3.E2.m3.2.2.3.3">𝑇</ci></apply><apply id="S3.E2.m3.2.2.1.2.cmml" xref="S3.E2.m3.2.2.1.1"><tanh id="S3.E2.m3.1.1.cmml" xref="S3.E2.m3.1.1"></tanh><apply id="S3.E2.m3.2.2.1.1.1.1.cmml" xref="S3.E2.m3.2.2.1.1.1.1"><plus id="S3.E2.m3.2.2.1.1.1.1.1.cmml" xref="S3.E2.m3.2.2.1.1.1.1.1"></plus><apply id="S3.E2.m3.2.2.1.1.1.1.2.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2"><times id="S3.E2.m3.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.1"></times><apply id="S3.E2.m3.2.2.1.1.1.1.2.2.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m3.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m3.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.2.2">𝑊</ci><cn type="integer" id="S3.E2.m3.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.2.3">1</cn></apply><apply id="S3.E2.m3.2.2.1.1.1.1.2.3.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m3.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m3.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.3.2">ℎ</ci><ci id="S3.E2.m3.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E2.m3.2.2.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m3.2.2.1.1.1.1.3.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3"><times id="S3.E2.m3.2.2.1.1.1.1.3.1.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.1"></times><apply id="S3.E2.m3.2.2.1.1.1.1.3.2.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m3.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m3.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.2.2">𝑊</ci><cn type="integer" id="S3.E2.m3.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.2.3">2</cn></apply><apply id="S3.E2.m3.2.2.1.1.1.1.3.3.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m3.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m3.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.3.2">ℎ</ci><ci id="S3.E2.m3.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E2.m3.2.2.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m3.2c">\displaystyle v^{T}\tanh(W_{1}h_{i}+W_{2}h_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle\alpha_{ti}" display="inline"><semantics id="S3.E3.m1.1a"><msub id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">α</mi><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2">𝛼</ci><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><times id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></times><ci id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">𝑡</ci><ci id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\alpha_{ti}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S3.E3.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S3.E3.m2.1a"><mo id="S3.E3.m2.1.1" xref="S3.E3.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E3.m2.1b"><eq id="S3.E3.m2.1.1.cmml" xref="S3.E3.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m3.4" class="ltx_Math" alttext="\displaystyle\frac{\exp(u_{ti})}{\sum_{j=1}^{T}\exp(u_{tj})}" display="inline"><semantics id="S3.E3.m3.4a"><mstyle displaystyle="true" id="S3.E3.m3.4.4" xref="S3.E3.m3.4.4.cmml"><mfrac id="S3.E3.m3.4.4a" xref="S3.E3.m3.4.4.cmml"><mrow id="S3.E3.m3.2.2.2.2" xref="S3.E3.m3.2.2.2.3.cmml"><mi id="S3.E3.m3.1.1.1.1" xref="S3.E3.m3.1.1.1.1.cmml">exp</mi><mo id="S3.E3.m3.2.2.2.2a" xref="S3.E3.m3.2.2.2.3.cmml">⁡</mo><mrow id="S3.E3.m3.2.2.2.2.1" xref="S3.E3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m3.2.2.2.2.1.2" xref="S3.E3.m3.2.2.2.3.cmml">(</mo><msub id="S3.E3.m3.2.2.2.2.1.1" xref="S3.E3.m3.2.2.2.2.1.1.cmml"><mi id="S3.E3.m3.2.2.2.2.1.1.2" xref="S3.E3.m3.2.2.2.2.1.1.2.cmml">u</mi><mrow id="S3.E3.m3.2.2.2.2.1.1.3" xref="S3.E3.m3.2.2.2.2.1.1.3.cmml"><mi id="S3.E3.m3.2.2.2.2.1.1.3.2" xref="S3.E3.m3.2.2.2.2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m3.2.2.2.2.1.1.3.1" xref="S3.E3.m3.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E3.m3.2.2.2.2.1.1.3.3" xref="S3.E3.m3.2.2.2.2.1.1.3.3.cmml">i</mi></mrow></msub><mo stretchy="false" id="S3.E3.m3.2.2.2.2.1.3" xref="S3.E3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m3.4.4.4" xref="S3.E3.m3.4.4.4.cmml"><msubsup id="S3.E3.m3.4.4.4.3" xref="S3.E3.m3.4.4.4.3.cmml"><mo id="S3.E3.m3.4.4.4.3.2.2" xref="S3.E3.m3.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.E3.m3.4.4.4.3.2.3" xref="S3.E3.m3.4.4.4.3.2.3.cmml"><mi id="S3.E3.m3.4.4.4.3.2.3.2" xref="S3.E3.m3.4.4.4.3.2.3.2.cmml">j</mi><mo id="S3.E3.m3.4.4.4.3.2.3.1" xref="S3.E3.m3.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.E3.m3.4.4.4.3.2.3.3" xref="S3.E3.m3.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m3.4.4.4.3.3" xref="S3.E3.m3.4.4.4.3.3.cmml">T</mi></msubsup><mrow id="S3.E3.m3.4.4.4.2.1" xref="S3.E3.m3.4.4.4.2.2.cmml"><mi id="S3.E3.m3.3.3.3.1" xref="S3.E3.m3.3.3.3.1.cmml">exp</mi><mo id="S3.E3.m3.4.4.4.2.1a" xref="S3.E3.m3.4.4.4.2.2.cmml">⁡</mo><mrow id="S3.E3.m3.4.4.4.2.1.1" xref="S3.E3.m3.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.E3.m3.4.4.4.2.1.1.2" xref="S3.E3.m3.4.4.4.2.2.cmml">(</mo><msub id="S3.E3.m3.4.4.4.2.1.1.1" xref="S3.E3.m3.4.4.4.2.1.1.1.cmml"><mi id="S3.E3.m3.4.4.4.2.1.1.1.2" xref="S3.E3.m3.4.4.4.2.1.1.1.2.cmml">u</mi><mrow id="S3.E3.m3.4.4.4.2.1.1.1.3" xref="S3.E3.m3.4.4.4.2.1.1.1.3.cmml"><mi id="S3.E3.m3.4.4.4.2.1.1.1.3.2" xref="S3.E3.m3.4.4.4.2.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m3.4.4.4.2.1.1.1.3.1" xref="S3.E3.m3.4.4.4.2.1.1.1.3.1.cmml">​</mo><mi id="S3.E3.m3.4.4.4.2.1.1.1.3.3" xref="S3.E3.m3.4.4.4.2.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.E3.m3.4.4.4.2.1.1.3" xref="S3.E3.m3.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S3.E3.m3.4b"><apply id="S3.E3.m3.4.4.cmml" xref="S3.E3.m3.4.4"><divide id="S3.E3.m3.4.4.5.cmml" xref="S3.E3.m3.4.4"></divide><apply id="S3.E3.m3.2.2.2.3.cmml" xref="S3.E3.m3.2.2.2.2"><exp id="S3.E3.m3.1.1.1.1.cmml" xref="S3.E3.m3.1.1.1.1"></exp><apply id="S3.E3.m3.2.2.2.2.1.1.cmml" xref="S3.E3.m3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m3.2.2.2.2.1.1.1.cmml" xref="S3.E3.m3.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m3.2.2.2.2.1.1.2.cmml" xref="S3.E3.m3.2.2.2.2.1.1.2">𝑢</ci><apply id="S3.E3.m3.2.2.2.2.1.1.3.cmml" xref="S3.E3.m3.2.2.2.2.1.1.3"><times id="S3.E3.m3.2.2.2.2.1.1.3.1.cmml" xref="S3.E3.m3.2.2.2.2.1.1.3.1"></times><ci id="S3.E3.m3.2.2.2.2.1.1.3.2.cmml" xref="S3.E3.m3.2.2.2.2.1.1.3.2">𝑡</ci><ci id="S3.E3.m3.2.2.2.2.1.1.3.3.cmml" xref="S3.E3.m3.2.2.2.2.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E3.m3.4.4.4.cmml" xref="S3.E3.m3.4.4.4"><apply id="S3.E3.m3.4.4.4.3.cmml" xref="S3.E3.m3.4.4.4.3"><csymbol cd="ambiguous" id="S3.E3.m3.4.4.4.3.1.cmml" xref="S3.E3.m3.4.4.4.3">superscript</csymbol><apply id="S3.E3.m3.4.4.4.3.2.cmml" xref="S3.E3.m3.4.4.4.3"><csymbol cd="ambiguous" id="S3.E3.m3.4.4.4.3.2.1.cmml" xref="S3.E3.m3.4.4.4.3">subscript</csymbol><sum id="S3.E3.m3.4.4.4.3.2.2.cmml" xref="S3.E3.m3.4.4.4.3.2.2"></sum><apply id="S3.E3.m3.4.4.4.3.2.3.cmml" xref="S3.E3.m3.4.4.4.3.2.3"><eq id="S3.E3.m3.4.4.4.3.2.3.1.cmml" xref="S3.E3.m3.4.4.4.3.2.3.1"></eq><ci id="S3.E3.m3.4.4.4.3.2.3.2.cmml" xref="S3.E3.m3.4.4.4.3.2.3.2">𝑗</ci><cn type="integer" id="S3.E3.m3.4.4.4.3.2.3.3.cmml" xref="S3.E3.m3.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m3.4.4.4.3.3.cmml" xref="S3.E3.m3.4.4.4.3.3">𝑇</ci></apply><apply id="S3.E3.m3.4.4.4.2.2.cmml" xref="S3.E3.m3.4.4.4.2.1"><exp id="S3.E3.m3.3.3.3.1.cmml" xref="S3.E3.m3.3.3.3.1"></exp><apply id="S3.E3.m3.4.4.4.2.1.1.1.cmml" xref="S3.E3.m3.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m3.4.4.4.2.1.1.1.1.cmml" xref="S3.E3.m3.4.4.4.2.1.1.1">subscript</csymbol><ci id="S3.E3.m3.4.4.4.2.1.1.1.2.cmml" xref="S3.E3.m3.4.4.4.2.1.1.1.2">𝑢</ci><apply id="S3.E3.m3.4.4.4.2.1.1.1.3.cmml" xref="S3.E3.m3.4.4.4.2.1.1.1.3"><times id="S3.E3.m3.4.4.4.2.1.1.1.3.1.cmml" xref="S3.E3.m3.4.4.4.2.1.1.1.3.1"></times><ci id="S3.E3.m3.4.4.4.2.1.1.1.3.2.cmml" xref="S3.E3.m3.4.4.4.2.1.1.1.3.2">𝑡</ci><ci id="S3.E3.m3.4.4.4.2.1.1.1.3.3.cmml" xref="S3.E3.m3.4.4.4.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m3.4c">\displaystyle\frac{\exp(u_{ti})}{\sum_{j=1}^{T}\exp(u_{tj})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.33" class="ltx_p">where <math id="S3.SS2.p3.12.m1.1" class="ltx_Math" alttext="h_{i}" display="inline"><semantics id="S3.SS2.p3.12.m1.1a"><msub id="S3.SS2.p3.12.m1.1.1" xref="S3.SS2.p3.12.m1.1.1.cmml"><mi id="S3.SS2.p3.12.m1.1.1.2" xref="S3.SS2.p3.12.m1.1.1.2.cmml">h</mi><mi id="S3.SS2.p3.12.m1.1.1.3" xref="S3.SS2.p3.12.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m1.1b"><apply id="S3.SS2.p3.12.m1.1.1.cmml" xref="S3.SS2.p3.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.12.m1.1.1.1.cmml" xref="S3.SS2.p3.12.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.12.m1.1.1.2.cmml" xref="S3.SS2.p3.12.m1.1.1.2">ℎ</ci><ci id="S3.SS2.p3.12.m1.1.1.3.cmml" xref="S3.SS2.p3.12.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m1.1c">h_{i}</annotation></semantics></math> and <math id="S3.SS2.p3.13.m2.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S3.SS2.p3.13.m2.1a"><msub id="S3.SS2.p3.13.m2.1.1" xref="S3.SS2.p3.13.m2.1.1.cmml"><mi id="S3.SS2.p3.13.m2.1.1.2" xref="S3.SS2.p3.13.m2.1.1.2.cmml">h</mi><mi id="S3.SS2.p3.13.m2.1.1.3" xref="S3.SS2.p3.13.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m2.1b"><apply id="S3.SS2.p3.13.m2.1.1.cmml" xref="S3.SS2.p3.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m2.1.1.1.cmml" xref="S3.SS2.p3.13.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.13.m2.1.1.2.cmml" xref="S3.SS2.p3.13.m2.1.1.2">ℎ</ci><ci id="S3.SS2.p3.13.m2.1.1.3.cmml" xref="S3.SS2.p3.13.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m2.1c">h_{t}</annotation></semantics></math> are LSTM outputs at encoder time-step <math id="S3.SS2.p3.14.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p3.14.m3.1a"><mi id="S3.SS2.p3.14.m3.1.1" xref="S3.SS2.p3.14.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.14.m3.1b"><ci id="S3.SS2.p3.14.m3.1.1.cmml" xref="S3.SS2.p3.14.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.14.m3.1c">i</annotation></semantics></math> and decoder time-step <math id="S3.SS2.p3.15.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p3.15.m4.1a"><mi id="S3.SS2.p3.15.m4.1.1" xref="S3.SS2.p3.15.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.15.m4.1b"><ci id="S3.SS2.p3.15.m4.1.1.cmml" xref="S3.SS2.p3.15.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.15.m4.1c">t</annotation></semantics></math>, respectively, and <math id="S3.SS2.p3.16.m5.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.SS2.p3.16.m5.1a"><mi id="S3.SS2.p3.16.m5.1.1" xref="S3.SS2.p3.16.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.16.m5.1b"><ci id="S3.SS2.p3.16.m5.1.1.cmml" xref="S3.SS2.p3.16.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.16.m5.1c">v</annotation></semantics></math>, <math id="S3.SS2.p3.17.m6.1" class="ltx_Math" alttext="W_{1}" display="inline"><semantics id="S3.SS2.p3.17.m6.1a"><msub id="S3.SS2.p3.17.m6.1.1" xref="S3.SS2.p3.17.m6.1.1.cmml"><mi id="S3.SS2.p3.17.m6.1.1.2" xref="S3.SS2.p3.17.m6.1.1.2.cmml">W</mi><mn id="S3.SS2.p3.17.m6.1.1.3" xref="S3.SS2.p3.17.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.17.m6.1b"><apply id="S3.SS2.p3.17.m6.1.1.cmml" xref="S3.SS2.p3.17.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m6.1.1.1.cmml" xref="S3.SS2.p3.17.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.17.m6.1.1.2.cmml" xref="S3.SS2.p3.17.m6.1.1.2">𝑊</ci><cn type="integer" id="S3.SS2.p3.17.m6.1.1.3.cmml" xref="S3.SS2.p3.17.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.17.m6.1c">W_{1}</annotation></semantics></math> and <math id="S3.SS2.p3.18.m7.1" class="ltx_Math" alttext="W_{2}" display="inline"><semantics id="S3.SS2.p3.18.m7.1a"><msub id="S3.SS2.p3.18.m7.1.1" xref="S3.SS2.p3.18.m7.1.1.cmml"><mi id="S3.SS2.p3.18.m7.1.1.2" xref="S3.SS2.p3.18.m7.1.1.2.cmml">W</mi><mn id="S3.SS2.p3.18.m7.1.1.3" xref="S3.SS2.p3.18.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.18.m7.1b"><apply id="S3.SS2.p3.18.m7.1.1.cmml" xref="S3.SS2.p3.18.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.18.m7.1.1.1.cmml" xref="S3.SS2.p3.18.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.18.m7.1.1.2.cmml" xref="S3.SS2.p3.18.m7.1.1.2">𝑊</ci><cn type="integer" id="S3.SS2.p3.18.m7.1.1.3.cmml" xref="S3.SS2.p3.18.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.18.m7.1c">W_{2}</annotation></semantics></math> are model parameters to be learned from data. Then a context vector <math id="S3.SS2.p3.19.m8.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S3.SS2.p3.19.m8.1a"><msub id="S3.SS2.p3.19.m8.1.1" xref="S3.SS2.p3.19.m8.1.1.cmml"><mi id="S3.SS2.p3.19.m8.1.1.2" xref="S3.SS2.p3.19.m8.1.1.2.cmml">c</mi><mi id="S3.SS2.p3.19.m8.1.1.3" xref="S3.SS2.p3.19.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.19.m8.1b"><apply id="S3.SS2.p3.19.m8.1.1.cmml" xref="S3.SS2.p3.19.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.19.m8.1.1.1.cmml" xref="S3.SS2.p3.19.m8.1.1">subscript</csymbol><ci id="S3.SS2.p3.19.m8.1.1.2.cmml" xref="S3.SS2.p3.19.m8.1.1.2">𝑐</ci><ci id="S3.SS2.p3.19.m8.1.1.3.cmml" xref="S3.SS2.p3.19.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.19.m8.1c">c_{t}</annotation></semantics></math> is obtained as <math id="S3.SS2.p3.20.m9.1" class="ltx_Math" alttext="\sum_{i=1}^{T}\alpha_{ti}h_{i}" display="inline"><semantics id="S3.SS2.p3.20.m9.1a"><mrow id="S3.SS2.p3.20.m9.1.1" xref="S3.SS2.p3.20.m9.1.1.cmml"><msubsup id="S3.SS2.p3.20.m9.1.1.1" xref="S3.SS2.p3.20.m9.1.1.1.cmml"><mo id="S3.SS2.p3.20.m9.1.1.1.2.2" xref="S3.SS2.p3.20.m9.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p3.20.m9.1.1.1.2.3" xref="S3.SS2.p3.20.m9.1.1.1.2.3.cmml"><mi id="S3.SS2.p3.20.m9.1.1.1.2.3.2" xref="S3.SS2.p3.20.m9.1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p3.20.m9.1.1.1.2.3.1" xref="S3.SS2.p3.20.m9.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.20.m9.1.1.1.2.3.3" xref="S3.SS2.p3.20.m9.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p3.20.m9.1.1.1.3" xref="S3.SS2.p3.20.m9.1.1.1.3.cmml">T</mi></msubsup><mrow id="S3.SS2.p3.20.m9.1.1.2" xref="S3.SS2.p3.20.m9.1.1.2.cmml"><msub id="S3.SS2.p3.20.m9.1.1.2.2" xref="S3.SS2.p3.20.m9.1.1.2.2.cmml"><mi id="S3.SS2.p3.20.m9.1.1.2.2.2" xref="S3.SS2.p3.20.m9.1.1.2.2.2.cmml">α</mi><mrow id="S3.SS2.p3.20.m9.1.1.2.2.3" xref="S3.SS2.p3.20.m9.1.1.2.2.3.cmml"><mi id="S3.SS2.p3.20.m9.1.1.2.2.3.2" xref="S3.SS2.p3.20.m9.1.1.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.20.m9.1.1.2.2.3.1" xref="S3.SS2.p3.20.m9.1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p3.20.m9.1.1.2.2.3.3" xref="S3.SS2.p3.20.m9.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p3.20.m9.1.1.2.1" xref="S3.SS2.p3.20.m9.1.1.2.1.cmml">​</mo><msub id="S3.SS2.p3.20.m9.1.1.2.3" xref="S3.SS2.p3.20.m9.1.1.2.3.cmml"><mi id="S3.SS2.p3.20.m9.1.1.2.3.2" xref="S3.SS2.p3.20.m9.1.1.2.3.2.cmml">h</mi><mi id="S3.SS2.p3.20.m9.1.1.2.3.3" xref="S3.SS2.p3.20.m9.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.20.m9.1b"><apply id="S3.SS2.p3.20.m9.1.1.cmml" xref="S3.SS2.p3.20.m9.1.1"><apply id="S3.SS2.p3.20.m9.1.1.1.cmml" xref="S3.SS2.p3.20.m9.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m9.1.1.1.1.cmml" xref="S3.SS2.p3.20.m9.1.1.1">superscript</csymbol><apply id="S3.SS2.p3.20.m9.1.1.1.2.cmml" xref="S3.SS2.p3.20.m9.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m9.1.1.1.2.1.cmml" xref="S3.SS2.p3.20.m9.1.1.1">subscript</csymbol><sum id="S3.SS2.p3.20.m9.1.1.1.2.2.cmml" xref="S3.SS2.p3.20.m9.1.1.1.2.2"></sum><apply id="S3.SS2.p3.20.m9.1.1.1.2.3.cmml" xref="S3.SS2.p3.20.m9.1.1.1.2.3"><eq id="S3.SS2.p3.20.m9.1.1.1.2.3.1.cmml" xref="S3.SS2.p3.20.m9.1.1.1.2.3.1"></eq><ci id="S3.SS2.p3.20.m9.1.1.1.2.3.2.cmml" xref="S3.SS2.p3.20.m9.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p3.20.m9.1.1.1.2.3.3.cmml" xref="S3.SS2.p3.20.m9.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p3.20.m9.1.1.1.3.cmml" xref="S3.SS2.p3.20.m9.1.1.1.3">𝑇</ci></apply><apply id="S3.SS2.p3.20.m9.1.1.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2"><times id="S3.SS2.p3.20.m9.1.1.2.1.cmml" xref="S3.SS2.p3.20.m9.1.1.2.1"></times><apply id="S3.SS2.p3.20.m9.1.1.2.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m9.1.1.2.2.1.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p3.20.m9.1.1.2.2.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2.2">𝛼</ci><apply id="S3.SS2.p3.20.m9.1.1.2.2.3.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2.3"><times id="S3.SS2.p3.20.m9.1.1.2.2.3.1.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2.3.1"></times><ci id="S3.SS2.p3.20.m9.1.1.2.2.3.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2.3.2">𝑡</ci><ci id="S3.SS2.p3.20.m9.1.1.2.2.3.3.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS2.p3.20.m9.1.1.2.3.cmml" xref="S3.SS2.p3.20.m9.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m9.1.1.2.3.1.cmml" xref="S3.SS2.p3.20.m9.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p3.20.m9.1.1.2.3.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2.3.2">ℎ</ci><ci id="S3.SS2.p3.20.m9.1.1.2.3.3.cmml" xref="S3.SS2.p3.20.m9.1.1.2.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.20.m9.1c">\sum_{i=1}^{T}\alpha_{ti}h_{i}</annotation></semantics></math>, and the probability for the next module token <math id="S3.SS2.p3.21.m10.1" class="ltx_Math" alttext="m^{(t)}" display="inline"><semantics id="S3.SS2.p3.21.m10.1a"><msup id="S3.SS2.p3.21.m10.1.2" xref="S3.SS2.p3.21.m10.1.2.cmml"><mi id="S3.SS2.p3.21.m10.1.2.2" xref="S3.SS2.p3.21.m10.1.2.2.cmml">m</mi><mrow id="S3.SS2.p3.21.m10.1.1.1.3" xref="S3.SS2.p3.21.m10.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.21.m10.1.1.1.3.1" xref="S3.SS2.p3.21.m10.1.2.cmml">(</mo><mi id="S3.SS2.p3.21.m10.1.1.1.1" xref="S3.SS2.p3.21.m10.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p3.21.m10.1.1.1.3.2" xref="S3.SS2.p3.21.m10.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.21.m10.1b"><apply id="S3.SS2.p3.21.m10.1.2.cmml" xref="S3.SS2.p3.21.m10.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.21.m10.1.2.1.cmml" xref="S3.SS2.p3.21.m10.1.2">superscript</csymbol><ci id="S3.SS2.p3.21.m10.1.2.2.cmml" xref="S3.SS2.p3.21.m10.1.2.2">𝑚</ci><ci id="S3.SS2.p3.21.m10.1.1.1.1.cmml" xref="S3.SS2.p3.21.m10.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.21.m10.1c">m^{(t)}</annotation></semantics></math> is predicted from <math id="S3.SS2.p3.22.m11.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S3.SS2.p3.22.m11.1a"><msub id="S3.SS2.p3.22.m11.1.1" xref="S3.SS2.p3.22.m11.1.1.cmml"><mi id="S3.SS2.p3.22.m11.1.1.2" xref="S3.SS2.p3.22.m11.1.1.2.cmml">h</mi><mi id="S3.SS2.p3.22.m11.1.1.3" xref="S3.SS2.p3.22.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.22.m11.1b"><apply id="S3.SS2.p3.22.m11.1.1.cmml" xref="S3.SS2.p3.22.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m11.1.1.1.cmml" xref="S3.SS2.p3.22.m11.1.1">subscript</csymbol><ci id="S3.SS2.p3.22.m11.1.1.2.cmml" xref="S3.SS2.p3.22.m11.1.1.2">ℎ</ci><ci id="S3.SS2.p3.22.m11.1.1.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.22.m11.1c">h_{t}</annotation></semantics></math> and <math id="S3.SS2.p3.23.m12.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S3.SS2.p3.23.m12.1a"><msub id="S3.SS2.p3.23.m12.1.1" xref="S3.SS2.p3.23.m12.1.1.cmml"><mi id="S3.SS2.p3.23.m12.1.1.2" xref="S3.SS2.p3.23.m12.1.1.2.cmml">c</mi><mi id="S3.SS2.p3.23.m12.1.1.3" xref="S3.SS2.p3.23.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.23.m12.1b"><apply id="S3.SS2.p3.23.m12.1.1.cmml" xref="S3.SS2.p3.23.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.23.m12.1.1.1.cmml" xref="S3.SS2.p3.23.m12.1.1">subscript</csymbol><ci id="S3.SS2.p3.23.m12.1.1.2.cmml" xref="S3.SS2.p3.23.m12.1.1.2">𝑐</ci><ci id="S3.SS2.p3.23.m12.1.1.3.cmml" xref="S3.SS2.p3.23.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.23.m12.1c">c_{t}</annotation></semantics></math> as
<math id="S3.SS2.p3.24.m13.7" class="ltx_Math" alttext="p(m^{(t)}|m^{(1)},\cdots,m^{(t-1)},q)=\mathrm{softmax}(W_{3}h_{t}+W_{4}c_{t})" display="inline"><semantics id="S3.SS2.p3.24.m13.7a"><mrow id="S3.SS2.p3.24.m13.7.7" xref="S3.SS2.p3.24.m13.7.7.cmml"><mrow id="S3.SS2.p3.24.m13.6.6.1" xref="S3.SS2.p3.24.m13.6.6.1.cmml"><mi id="S3.SS2.p3.24.m13.6.6.1.3" xref="S3.SS2.p3.24.m13.6.6.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.24.m13.6.6.1.2" xref="S3.SS2.p3.24.m13.6.6.1.2.cmml">​</mo><mrow id="S3.SS2.p3.24.m13.6.6.1.1.1" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.24.m13.6.6.1.1.1.2" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.24.m13.6.6.1.1.1.1" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.cmml"><msup id="S3.SS2.p3.24.m13.6.6.1.1.1.1.4" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.cmml"><mi id="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.2" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.2.cmml">m</mi><mrow id="S3.SS2.p3.24.m13.1.1.1.3" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS2.p3.24.m13.1.1.1.3.1" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.cmml">(</mo><mi id="S3.SS2.p3.24.m13.1.1.1.1" xref="S3.SS2.p3.24.m13.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p3.24.m13.1.1.1.3.2" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.cmml">)</mo></mrow></msup><mo fence="false" id="S3.SS2.p3.24.m13.6.6.1.1.1.1.3" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.3.cmml"><msup id="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.2.cmml">m</mi><mrow id="S3.SS2.p3.24.m13.2.2.1.3" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.24.m13.2.2.1.3.1" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.cmml">(</mo><mn id="S3.SS2.p3.24.m13.2.2.1.1" xref="S3.SS2.p3.24.m13.2.2.1.1.cmml">1</mn><mo stretchy="false" id="S3.SS2.p3.24.m13.2.2.1.3.2" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.3" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.24.m13.4.4" xref="S3.SS2.p3.24.m13.4.4.cmml">⋯</mi><mo id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.4" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.3.cmml">,</mo><msup id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2.cmml"><mi id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2.2" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2.2.cmml">m</mi><mrow id="S3.SS2.p3.24.m13.3.3.1.1" xref="S3.SS2.p3.24.m13.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.24.m13.3.3.1.1.2" xref="S3.SS2.p3.24.m13.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.24.m13.3.3.1.1.1" xref="S3.SS2.p3.24.m13.3.3.1.1.1.cmml"><mi id="S3.SS2.p3.24.m13.3.3.1.1.1.2" xref="S3.SS2.p3.24.m13.3.3.1.1.1.2.cmml">t</mi><mo id="S3.SS2.p3.24.m13.3.3.1.1.1.1" xref="S3.SS2.p3.24.m13.3.3.1.1.1.1.cmml">−</mo><mn id="S3.SS2.p3.24.m13.3.3.1.1.1.3" xref="S3.SS2.p3.24.m13.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p3.24.m13.3.3.1.1.3" xref="S3.SS2.p3.24.m13.3.3.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.5" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.3.cmml">,</mo><mi id="S3.SS2.p3.24.m13.5.5" xref="S3.SS2.p3.24.m13.5.5.cmml">q</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.p3.24.m13.6.6.1.1.1.3" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.24.m13.7.7.3" xref="S3.SS2.p3.24.m13.7.7.3.cmml">=</mo><mrow id="S3.SS2.p3.24.m13.7.7.2" xref="S3.SS2.p3.24.m13.7.7.2.cmml"><mi id="S3.SS2.p3.24.m13.7.7.2.3" xref="S3.SS2.p3.24.m13.7.7.2.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.24.m13.7.7.2.2" xref="S3.SS2.p3.24.m13.7.7.2.2.cmml">​</mo><mrow id="S3.SS2.p3.24.m13.7.7.2.1.1" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.24.m13.7.7.2.1.1.2" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.24.m13.7.7.2.1.1.1" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.cmml"><mrow id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.cmml"><msub id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.cmml"><mi id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.2" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.2.cmml">W</mi><mn id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.3" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.1" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.1.cmml">​</mo><msub id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.cmml"><mi id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.2" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.2.cmml">h</mi><mi id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.3" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS2.p3.24.m13.7.7.2.1.1.1.1" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.1.cmml">+</mo><mrow id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.cmml"><msub id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.cmml"><mi id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.2" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.2.cmml">W</mi><mn id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.3" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.3.cmml">4</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.1" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.1.cmml">​</mo><msub id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.cmml"><mi id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.2" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.2.cmml">c</mi><mi id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.3" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo stretchy="false" id="S3.SS2.p3.24.m13.7.7.2.1.1.3" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.24.m13.7b"><apply id="S3.SS2.p3.24.m13.7.7.cmml" xref="S3.SS2.p3.24.m13.7.7"><eq id="S3.SS2.p3.24.m13.7.7.3.cmml" xref="S3.SS2.p3.24.m13.7.7.3"></eq><apply id="S3.SS2.p3.24.m13.6.6.1.cmml" xref="S3.SS2.p3.24.m13.6.6.1"><times id="S3.SS2.p3.24.m13.6.6.1.2.cmml" xref="S3.SS2.p3.24.m13.6.6.1.2"></times><ci id="S3.SS2.p3.24.m13.6.6.1.3.cmml" xref="S3.SS2.p3.24.m13.6.6.1.3">𝑝</ci><apply id="S3.SS2.p3.24.m13.6.6.1.1.1.1.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.24.m13.6.6.1.1.1.1.3.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.3">conditional</csymbol><apply id="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.1.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.4">superscript</csymbol><ci id="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.2.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.4.2">𝑚</ci><ci id="S3.SS2.p3.24.m13.1.1.1.1.cmml" xref="S3.SS2.p3.24.m13.1.1.1.1">𝑡</ci></apply><list id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.3.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2"><apply id="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.1.1.1.2">𝑚</ci><cn type="integer" id="S3.SS2.p3.24.m13.2.2.1.1.cmml" xref="S3.SS2.p3.24.m13.2.2.1.1">1</cn></apply><ci id="S3.SS2.p3.24.m13.4.4.cmml" xref="S3.SS2.p3.24.m13.4.4">⋯</ci><apply id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p3.24.m13.6.6.1.1.1.1.2.2.2.2">𝑚</ci><apply id="S3.SS2.p3.24.m13.3.3.1.1.1.cmml" xref="S3.SS2.p3.24.m13.3.3.1.1"><minus id="S3.SS2.p3.24.m13.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.24.m13.3.3.1.1.1.1"></minus><ci id="S3.SS2.p3.24.m13.3.3.1.1.1.2.cmml" xref="S3.SS2.p3.24.m13.3.3.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS2.p3.24.m13.3.3.1.1.1.3.cmml" xref="S3.SS2.p3.24.m13.3.3.1.1.1.3">1</cn></apply></apply><ci id="S3.SS2.p3.24.m13.5.5.cmml" xref="S3.SS2.p3.24.m13.5.5">𝑞</ci></list></apply></apply><apply id="S3.SS2.p3.24.m13.7.7.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2"><times id="S3.SS2.p3.24.m13.7.7.2.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2.2"></times><ci id="S3.SS2.p3.24.m13.7.7.2.3.cmml" xref="S3.SS2.p3.24.m13.7.7.2.3">softmax</ci><apply id="S3.SS2.p3.24.m13.7.7.2.1.1.1.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1"><plus id="S3.SS2.p3.24.m13.7.7.2.1.1.1.1.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.1"></plus><apply id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2"><times id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.1.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.1"></times><apply id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.1.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.2">𝑊</ci><cn type="integer" id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.3.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.2.3">3</cn></apply><apply id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.1.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.2">ℎ</ci><ci id="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.3.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3"><times id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.1.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.1"></times><apply id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.1.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.2">𝑊</ci><cn type="integer" id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.3.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.2.3">4</cn></apply><apply id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.1.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.2.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.2">𝑐</ci><ci id="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.3.cmml" xref="S3.SS2.p3.24.m13.7.7.2.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.24.m13.7c">p(m^{(t)}|m^{(1)},\cdots,m^{(t-1)},q)=\mathrm{softmax}(W_{3}h_{t}+W_{4}c_{t})</annotation></semantics></math>.
We sample from <math id="S3.SS2.p3.25.m14.6" class="ltx_Math" alttext="p(m^{(t)}|m^{(1)},\cdots,m^{(t-1)},q)" display="inline"><semantics id="S3.SS2.p3.25.m14.6a"><mrow id="S3.SS2.p3.25.m14.6.6" xref="S3.SS2.p3.25.m14.6.6.cmml"><mi id="S3.SS2.p3.25.m14.6.6.3" xref="S3.SS2.p3.25.m14.6.6.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.25.m14.6.6.2" xref="S3.SS2.p3.25.m14.6.6.2.cmml">​</mo><mrow id="S3.SS2.p3.25.m14.6.6.1.1" xref="S3.SS2.p3.25.m14.6.6.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.25.m14.6.6.1.1.2" xref="S3.SS2.p3.25.m14.6.6.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.25.m14.6.6.1.1.1" xref="S3.SS2.p3.25.m14.6.6.1.1.1.cmml"><msup id="S3.SS2.p3.25.m14.6.6.1.1.1.4" xref="S3.SS2.p3.25.m14.6.6.1.1.1.4.cmml"><mi id="S3.SS2.p3.25.m14.6.6.1.1.1.4.2" xref="S3.SS2.p3.25.m14.6.6.1.1.1.4.2.cmml">m</mi><mrow id="S3.SS2.p3.25.m14.1.1.1.3" xref="S3.SS2.p3.25.m14.6.6.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS2.p3.25.m14.1.1.1.3.1" xref="S3.SS2.p3.25.m14.6.6.1.1.1.4.cmml">(</mo><mi id="S3.SS2.p3.25.m14.1.1.1.1" xref="S3.SS2.p3.25.m14.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p3.25.m14.1.1.1.3.2" xref="S3.SS2.p3.25.m14.6.6.1.1.1.4.cmml">)</mo></mrow></msup><mo fence="false" id="S3.SS2.p3.25.m14.6.6.1.1.1.3" xref="S3.SS2.p3.25.m14.6.6.1.1.1.3.cmml">|</mo><mrow id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.3.cmml"><msup id="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1" xref="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.2" xref="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.2.cmml">m</mi><mrow id="S3.SS2.p3.25.m14.2.2.1.3" xref="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.25.m14.2.2.1.3.1" xref="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.cmml">(</mo><mn id="S3.SS2.p3.25.m14.2.2.1.1" xref="S3.SS2.p3.25.m14.2.2.1.1.cmml">1</mn><mo stretchy="false" id="S3.SS2.p3.25.m14.2.2.1.3.2" xref="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.3" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.25.m14.4.4" xref="S3.SS2.p3.25.m14.4.4.cmml">⋯</mi><mo id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.4" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.3.cmml">,</mo><msup id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2.cmml"><mi id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2.2" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2.2.cmml">m</mi><mrow id="S3.SS2.p3.25.m14.3.3.1.1" xref="S3.SS2.p3.25.m14.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.25.m14.3.3.1.1.2" xref="S3.SS2.p3.25.m14.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.25.m14.3.3.1.1.1" xref="S3.SS2.p3.25.m14.3.3.1.1.1.cmml"><mi id="S3.SS2.p3.25.m14.3.3.1.1.1.2" xref="S3.SS2.p3.25.m14.3.3.1.1.1.2.cmml">t</mi><mo id="S3.SS2.p3.25.m14.3.3.1.1.1.1" xref="S3.SS2.p3.25.m14.3.3.1.1.1.1.cmml">−</mo><mn id="S3.SS2.p3.25.m14.3.3.1.1.1.3" xref="S3.SS2.p3.25.m14.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p3.25.m14.3.3.1.1.3" xref="S3.SS2.p3.25.m14.3.3.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.5" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.3.cmml">,</mo><mi id="S3.SS2.p3.25.m14.5.5" xref="S3.SS2.p3.25.m14.5.5.cmml">q</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.p3.25.m14.6.6.1.1.3" xref="S3.SS2.p3.25.m14.6.6.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.25.m14.6b"><apply id="S3.SS2.p3.25.m14.6.6.cmml" xref="S3.SS2.p3.25.m14.6.6"><times id="S3.SS2.p3.25.m14.6.6.2.cmml" xref="S3.SS2.p3.25.m14.6.6.2"></times><ci id="S3.SS2.p3.25.m14.6.6.3.cmml" xref="S3.SS2.p3.25.m14.6.6.3">𝑝</ci><apply id="S3.SS2.p3.25.m14.6.6.1.1.1.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1"><csymbol cd="latexml" id="S3.SS2.p3.25.m14.6.6.1.1.1.3.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.3">conditional</csymbol><apply id="S3.SS2.p3.25.m14.6.6.1.1.1.4.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m14.6.6.1.1.1.4.1.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.4">superscript</csymbol><ci id="S3.SS2.p3.25.m14.6.6.1.1.1.4.2.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.4.2">𝑚</ci><ci id="S3.SS2.p3.25.m14.1.1.1.1.cmml" xref="S3.SS2.p3.25.m14.1.1.1.1">𝑡</ci></apply><list id="S3.SS2.p3.25.m14.6.6.1.1.1.2.3.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.2"><apply id="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.1.1.1.2">𝑚</ci><cn type="integer" id="S3.SS2.p3.25.m14.2.2.1.1.cmml" xref="S3.SS2.p3.25.m14.2.2.1.1">1</cn></apply><ci id="S3.SS2.p3.25.m14.4.4.cmml" xref="S3.SS2.p3.25.m14.4.4">⋯</ci><apply id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2">superscript</csymbol><ci id="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p3.25.m14.6.6.1.1.1.2.2.2.2">𝑚</ci><apply id="S3.SS2.p3.25.m14.3.3.1.1.1.cmml" xref="S3.SS2.p3.25.m14.3.3.1.1"><minus id="S3.SS2.p3.25.m14.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.25.m14.3.3.1.1.1.1"></minus><ci id="S3.SS2.p3.25.m14.3.3.1.1.1.2.cmml" xref="S3.SS2.p3.25.m14.3.3.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS2.p3.25.m14.3.3.1.1.1.3.cmml" xref="S3.SS2.p3.25.m14.3.3.1.1.1.3">1</cn></apply></apply><ci id="S3.SS2.p3.25.m14.5.5.cmml" xref="S3.SS2.p3.25.m14.5.5">𝑞</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.25.m14.6c">p(m^{(t)}|m^{(1)},\cdots,m^{(t-1)},q)</annotation></semantics></math> to discretely get the next token <math id="S3.SS2.p3.26.m15.1" class="ltx_Math" alttext="m^{(t)}" display="inline"><semantics id="S3.SS2.p3.26.m15.1a"><msup id="S3.SS2.p3.26.m15.1.2" xref="S3.SS2.p3.26.m15.1.2.cmml"><mi id="S3.SS2.p3.26.m15.1.2.2" xref="S3.SS2.p3.26.m15.1.2.2.cmml">m</mi><mrow id="S3.SS2.p3.26.m15.1.1.1.3" xref="S3.SS2.p3.26.m15.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.26.m15.1.1.1.3.1" xref="S3.SS2.p3.26.m15.1.2.cmml">(</mo><mi id="S3.SS2.p3.26.m15.1.1.1.1" xref="S3.SS2.p3.26.m15.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p3.26.m15.1.1.1.3.2" xref="S3.SS2.p3.26.m15.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.26.m15.1b"><apply id="S3.SS2.p3.26.m15.1.2.cmml" xref="S3.SS2.p3.26.m15.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.26.m15.1.2.1.cmml" xref="S3.SS2.p3.26.m15.1.2">superscript</csymbol><ci id="S3.SS2.p3.26.m15.1.2.2.cmml" xref="S3.SS2.p3.26.m15.1.2.2">𝑚</ci><ci id="S3.SS2.p3.26.m15.1.1.1.1.cmml" xref="S3.SS2.p3.26.m15.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.26.m15.1c">m^{(t)}</annotation></semantics></math>, and also construct its textual input <math id="S3.SS2.p3.27.m16.1" class="ltx_Math" alttext="x_{txt}^{(t)}" display="inline"><semantics id="S3.SS2.p3.27.m16.1a"><msubsup id="S3.SS2.p3.27.m16.1.2" xref="S3.SS2.p3.27.m16.1.2.cmml"><mi id="S3.SS2.p3.27.m16.1.2.2.2" xref="S3.SS2.p3.27.m16.1.2.2.2.cmml">x</mi><mrow id="S3.SS2.p3.27.m16.1.2.2.3" xref="S3.SS2.p3.27.m16.1.2.2.3.cmml"><mi id="S3.SS2.p3.27.m16.1.2.2.3.2" xref="S3.SS2.p3.27.m16.1.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.27.m16.1.2.2.3.1" xref="S3.SS2.p3.27.m16.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p3.27.m16.1.2.2.3.3" xref="S3.SS2.p3.27.m16.1.2.2.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.27.m16.1.2.2.3.1a" xref="S3.SS2.p3.27.m16.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p3.27.m16.1.2.2.3.4" xref="S3.SS2.p3.27.m16.1.2.2.3.4.cmml">t</mi></mrow><mrow id="S3.SS2.p3.27.m16.1.1.1.3" xref="S3.SS2.p3.27.m16.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.27.m16.1.1.1.3.1" xref="S3.SS2.p3.27.m16.1.2.cmml">(</mo><mi id="S3.SS2.p3.27.m16.1.1.1.1" xref="S3.SS2.p3.27.m16.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p3.27.m16.1.1.1.3.2" xref="S3.SS2.p3.27.m16.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.27.m16.1b"><apply id="S3.SS2.p3.27.m16.1.2.cmml" xref="S3.SS2.p3.27.m16.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.27.m16.1.2.1.cmml" xref="S3.SS2.p3.27.m16.1.2">superscript</csymbol><apply id="S3.SS2.p3.27.m16.1.2.2.cmml" xref="S3.SS2.p3.27.m16.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.27.m16.1.2.2.1.cmml" xref="S3.SS2.p3.27.m16.1.2">subscript</csymbol><ci id="S3.SS2.p3.27.m16.1.2.2.2.cmml" xref="S3.SS2.p3.27.m16.1.2.2.2">𝑥</ci><apply id="S3.SS2.p3.27.m16.1.2.2.3.cmml" xref="S3.SS2.p3.27.m16.1.2.2.3"><times id="S3.SS2.p3.27.m16.1.2.2.3.1.cmml" xref="S3.SS2.p3.27.m16.1.2.2.3.1"></times><ci id="S3.SS2.p3.27.m16.1.2.2.3.2.cmml" xref="S3.SS2.p3.27.m16.1.2.2.3.2">𝑡</ci><ci id="S3.SS2.p3.27.m16.1.2.2.3.3.cmml" xref="S3.SS2.p3.27.m16.1.2.2.3.3">𝑥</ci><ci id="S3.SS2.p3.27.m16.1.2.2.3.4.cmml" xref="S3.SS2.p3.27.m16.1.2.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS2.p3.27.m16.1.1.1.1.cmml" xref="S3.SS2.p3.27.m16.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.27.m16.1c">x_{txt}^{(t)}</annotation></semantics></math> according to Eqn. <a href="#S3.E1" title="In 3.1 Attentional neural modules ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> using the attention weights <math id="S3.SS2.p3.28.m17.1" class="ltx_Math" alttext="\alpha_{ti}" display="inline"><semantics id="S3.SS2.p3.28.m17.1a"><msub id="S3.SS2.p3.28.m17.1.1" xref="S3.SS2.p3.28.m17.1.1.cmml"><mi id="S3.SS2.p3.28.m17.1.1.2" xref="S3.SS2.p3.28.m17.1.1.2.cmml">α</mi><mrow id="S3.SS2.p3.28.m17.1.1.3" xref="S3.SS2.p3.28.m17.1.1.3.cmml"><mi id="S3.SS2.p3.28.m17.1.1.3.2" xref="S3.SS2.p3.28.m17.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.28.m17.1.1.3.1" xref="S3.SS2.p3.28.m17.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.28.m17.1.1.3.3" xref="S3.SS2.p3.28.m17.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.28.m17.1b"><apply id="S3.SS2.p3.28.m17.1.1.cmml" xref="S3.SS2.p3.28.m17.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.28.m17.1.1.1.cmml" xref="S3.SS2.p3.28.m17.1.1">subscript</csymbol><ci id="S3.SS2.p3.28.m17.1.1.2.cmml" xref="S3.SS2.p3.28.m17.1.1.2">𝛼</ci><apply id="S3.SS2.p3.28.m17.1.1.3.cmml" xref="S3.SS2.p3.28.m17.1.1.3"><times id="S3.SS2.p3.28.m17.1.1.3.1.cmml" xref="S3.SS2.p3.28.m17.1.1.3.1"></times><ci id="S3.SS2.p3.28.m17.1.1.3.2.cmml" xref="S3.SS2.p3.28.m17.1.1.3.2">𝑡</ci><ci id="S3.SS2.p3.28.m17.1.1.3.3.cmml" xref="S3.SS2.p3.28.m17.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.28.m17.1c">\alpha_{ti}</annotation></semantics></math> in Eqn. <a href="#S3.E3" title="In 3.2 Layout policy with sequence-to-sequence RNN ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The probability of a layout <math id="S3.SS2.p3.29.m18.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p3.29.m18.1a"><mi id="S3.SS2.p3.29.m18.1.1" xref="S3.SS2.p3.29.m18.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.29.m18.1b"><ci id="S3.SS2.p3.29.m18.1.1.cmml" xref="S3.SS2.p3.29.m18.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.29.m18.1c">l</annotation></semantics></math> is
<math id="S3.SS2.p3.30.m19.8" class="ltx_Math" alttext="p(l|q)=\prod_{m^{(t)}\in l}p(m^{(t)}|m^{(1)},\cdots,m^{(t-1)},q)" display="inline"><semantics id="S3.SS2.p3.30.m19.8a"><mrow id="S3.SS2.p3.30.m19.8.8" xref="S3.SS2.p3.30.m19.8.8.cmml"><mrow id="S3.SS2.p3.30.m19.7.7.1" xref="S3.SS2.p3.30.m19.7.7.1.cmml"><mi id="S3.SS2.p3.30.m19.7.7.1.3" xref="S3.SS2.p3.30.m19.7.7.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.30.m19.7.7.1.2" xref="S3.SS2.p3.30.m19.7.7.1.2.cmml">​</mo><mrow id="S3.SS2.p3.30.m19.7.7.1.1.1" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.30.m19.7.7.1.1.1.2" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.30.m19.7.7.1.1.1.1" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.cmml"><mi id="S3.SS2.p3.30.m19.7.7.1.1.1.1.2" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS2.p3.30.m19.7.7.1.1.1.1.1" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p3.30.m19.7.7.1.1.1.1.3" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.SS2.p3.30.m19.7.7.1.1.1.3" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.SS2.p3.30.m19.8.8.3" xref="S3.SS2.p3.30.m19.8.8.3.cmml">=</mo><mrow id="S3.SS2.p3.30.m19.8.8.2" xref="S3.SS2.p3.30.m19.8.8.2.cmml"><msub id="S3.SS2.p3.30.m19.8.8.2.2" xref="S3.SS2.p3.30.m19.8.8.2.2.cmml"><mo id="S3.SS2.p3.30.m19.8.8.2.2.2" xref="S3.SS2.p3.30.m19.8.8.2.2.2.cmml">∏</mo><mrow id="S3.SS2.p3.30.m19.1.1.1" xref="S3.SS2.p3.30.m19.1.1.1.cmml"><msup id="S3.SS2.p3.30.m19.1.1.1.3" xref="S3.SS2.p3.30.m19.1.1.1.3.cmml"><mi id="S3.SS2.p3.30.m19.1.1.1.3.2" xref="S3.SS2.p3.30.m19.1.1.1.3.2.cmml">m</mi><mrow id="S3.SS2.p3.30.m19.1.1.1.1.1.3" xref="S3.SS2.p3.30.m19.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS2.p3.30.m19.1.1.1.1.1.3.1" xref="S3.SS2.p3.30.m19.1.1.1.3.cmml">(</mo><mi id="S3.SS2.p3.30.m19.1.1.1.1.1.1" xref="S3.SS2.p3.30.m19.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p3.30.m19.1.1.1.1.1.3.2" xref="S3.SS2.p3.30.m19.1.1.1.3.cmml">)</mo></mrow></msup><mo id="S3.SS2.p3.30.m19.1.1.1.2" xref="S3.SS2.p3.30.m19.1.1.1.2.cmml">∈</mo><mi id="S3.SS2.p3.30.m19.1.1.1.4" xref="S3.SS2.p3.30.m19.1.1.1.4.cmml">l</mi></mrow></msub><mrow id="S3.SS2.p3.30.m19.8.8.2.1" xref="S3.SS2.p3.30.m19.8.8.2.1.cmml"><mi id="S3.SS2.p3.30.m19.8.8.2.1.3" xref="S3.SS2.p3.30.m19.8.8.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.30.m19.8.8.2.1.2" xref="S3.SS2.p3.30.m19.8.8.2.1.2.cmml">​</mo><mrow id="S3.SS2.p3.30.m19.8.8.2.1.1.1" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.30.m19.8.8.2.1.1.1.2" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.cmml"><msup id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.cmml"><mi id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.2" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.2.cmml">m</mi><mrow id="S3.SS2.p3.30.m19.2.2.1.3" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.SS2.p3.30.m19.2.2.1.3.1" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.cmml">(</mo><mi id="S3.SS2.p3.30.m19.2.2.1.1" xref="S3.SS2.p3.30.m19.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS2.p3.30.m19.2.2.1.3.2" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.cmml">)</mo></mrow></msup><mo fence="false" id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.3" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.3.cmml"><msup id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.2.cmml">m</mi><mrow id="S3.SS2.p3.30.m19.3.3.1.3" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.30.m19.3.3.1.3.1" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.cmml">(</mo><mn id="S3.SS2.p3.30.m19.3.3.1.1" xref="S3.SS2.p3.30.m19.3.3.1.1.cmml">1</mn><mo stretchy="false" id="S3.SS2.p3.30.m19.3.3.1.3.2" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.3" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.30.m19.5.5" xref="S3.SS2.p3.30.m19.5.5.cmml">⋯</mi><mo id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.4" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.3.cmml">,</mo><msup id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2.cmml"><mi id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2.2" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2.2.cmml">m</mi><mrow id="S3.SS2.p3.30.m19.4.4.1.1" xref="S3.SS2.p3.30.m19.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.30.m19.4.4.1.1.2" xref="S3.SS2.p3.30.m19.4.4.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.30.m19.4.4.1.1.1" xref="S3.SS2.p3.30.m19.4.4.1.1.1.cmml"><mi id="S3.SS2.p3.30.m19.4.4.1.1.1.2" xref="S3.SS2.p3.30.m19.4.4.1.1.1.2.cmml">t</mi><mo id="S3.SS2.p3.30.m19.4.4.1.1.1.1" xref="S3.SS2.p3.30.m19.4.4.1.1.1.1.cmml">−</mo><mn id="S3.SS2.p3.30.m19.4.4.1.1.1.3" xref="S3.SS2.p3.30.m19.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p3.30.m19.4.4.1.1.3" xref="S3.SS2.p3.30.m19.4.4.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.5" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.3.cmml">,</mo><mi id="S3.SS2.p3.30.m19.6.6" xref="S3.SS2.p3.30.m19.6.6.cmml">q</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.p3.30.m19.8.8.2.1.1.1.3" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.30.m19.8b"><apply id="S3.SS2.p3.30.m19.8.8.cmml" xref="S3.SS2.p3.30.m19.8.8"><eq id="S3.SS2.p3.30.m19.8.8.3.cmml" xref="S3.SS2.p3.30.m19.8.8.3"></eq><apply id="S3.SS2.p3.30.m19.7.7.1.cmml" xref="S3.SS2.p3.30.m19.7.7.1"><times id="S3.SS2.p3.30.m19.7.7.1.2.cmml" xref="S3.SS2.p3.30.m19.7.7.1.2"></times><ci id="S3.SS2.p3.30.m19.7.7.1.3.cmml" xref="S3.SS2.p3.30.m19.7.7.1.3">𝑝</ci><apply id="S3.SS2.p3.30.m19.7.7.1.1.1.1.cmml" xref="S3.SS2.p3.30.m19.7.7.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.30.m19.7.7.1.1.1.1.1.cmml" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p3.30.m19.7.7.1.1.1.1.2.cmml" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.p3.30.m19.7.7.1.1.1.1.3.cmml" xref="S3.SS2.p3.30.m19.7.7.1.1.1.1.3">𝑞</ci></apply></apply><apply id="S3.SS2.p3.30.m19.8.8.2.cmml" xref="S3.SS2.p3.30.m19.8.8.2"><apply id="S3.SS2.p3.30.m19.8.8.2.2.cmml" xref="S3.SS2.p3.30.m19.8.8.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.30.m19.8.8.2.2.1.cmml" xref="S3.SS2.p3.30.m19.8.8.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.SS2.p3.30.m19.8.8.2.2.2.cmml" xref="S3.SS2.p3.30.m19.8.8.2.2.2">product</csymbol><apply id="S3.SS2.p3.30.m19.1.1.1.cmml" xref="S3.SS2.p3.30.m19.1.1.1"><in id="S3.SS2.p3.30.m19.1.1.1.2.cmml" xref="S3.SS2.p3.30.m19.1.1.1.2"></in><apply id="S3.SS2.p3.30.m19.1.1.1.3.cmml" xref="S3.SS2.p3.30.m19.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.30.m19.1.1.1.3.1.cmml" xref="S3.SS2.p3.30.m19.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.30.m19.1.1.1.3.2.cmml" xref="S3.SS2.p3.30.m19.1.1.1.3.2">𝑚</ci><ci id="S3.SS2.p3.30.m19.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.30.m19.1.1.1.1.1.1">𝑡</ci></apply><ci id="S3.SS2.p3.30.m19.1.1.1.4.cmml" xref="S3.SS2.p3.30.m19.1.1.1.4">𝑙</ci></apply></apply><apply id="S3.SS2.p3.30.m19.8.8.2.1.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1"><times id="S3.SS2.p3.30.m19.8.8.2.1.2.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.2"></times><ci id="S3.SS2.p3.30.m19.8.8.2.1.3.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.3">𝑝</ci><apply id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.3.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.3">conditional</csymbol><apply id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.1.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4">superscript</csymbol><ci id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.2.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.4.2">𝑚</ci><ci id="S3.SS2.p3.30.m19.2.2.1.1.cmml" xref="S3.SS2.p3.30.m19.2.2.1.1">𝑡</ci></apply><list id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.3.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2"><apply id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.1.1.1.2">𝑚</ci><cn type="integer" id="S3.SS2.p3.30.m19.3.3.1.1.cmml" xref="S3.SS2.p3.30.m19.3.3.1.1">1</cn></apply><ci id="S3.SS2.p3.30.m19.5.5.cmml" xref="S3.SS2.p3.30.m19.5.5">⋯</ci><apply id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p3.30.m19.8.8.2.1.1.1.1.2.2.2.2">𝑚</ci><apply id="S3.SS2.p3.30.m19.4.4.1.1.1.cmml" xref="S3.SS2.p3.30.m19.4.4.1.1"><minus id="S3.SS2.p3.30.m19.4.4.1.1.1.1.cmml" xref="S3.SS2.p3.30.m19.4.4.1.1.1.1"></minus><ci id="S3.SS2.p3.30.m19.4.4.1.1.1.2.cmml" xref="S3.SS2.p3.30.m19.4.4.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS2.p3.30.m19.4.4.1.1.1.3.cmml" xref="S3.SS2.p3.30.m19.4.4.1.1.1.3">1</cn></apply></apply><ci id="S3.SS2.p3.30.m19.6.6.cmml" xref="S3.SS2.p3.30.m19.6.6">𝑞</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.30.m19.8c">p(l|q)=\prod_{m^{(t)}\in l}p(m^{(t)}|m^{(1)},\cdots,m^{(t-1)},q)</annotation></semantics></math>.
At test time, we deterministically predict a maximum-probability layout <math id="S3.SS2.p3.31.m20.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p3.31.m20.1a"><mi id="S3.SS2.p3.31.m20.1.1" xref="S3.SS2.p3.31.m20.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.31.m20.1b"><ci id="S3.SS2.p3.31.m20.1.1.cmml" xref="S3.SS2.p3.31.m20.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.31.m20.1c">l</annotation></semantics></math> from <math id="S3.SS2.p3.32.m21.1" class="ltx_Math" alttext="p(l|q)" display="inline"><semantics id="S3.SS2.p3.32.m21.1a"><mrow id="S3.SS2.p3.32.m21.1.1" xref="S3.SS2.p3.32.m21.1.1.cmml"><mi id="S3.SS2.p3.32.m21.1.1.3" xref="S3.SS2.p3.32.m21.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.32.m21.1.1.2" xref="S3.SS2.p3.32.m21.1.1.2.cmml">​</mo><mrow id="S3.SS2.p3.32.m21.1.1.1.1" xref="S3.SS2.p3.32.m21.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.32.m21.1.1.1.1.2" xref="S3.SS2.p3.32.m21.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.32.m21.1.1.1.1.1" xref="S3.SS2.p3.32.m21.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.32.m21.1.1.1.1.1.2" xref="S3.SS2.p3.32.m21.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS2.p3.32.m21.1.1.1.1.1.1" xref="S3.SS2.p3.32.m21.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p3.32.m21.1.1.1.1.1.3" xref="S3.SS2.p3.32.m21.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.SS2.p3.32.m21.1.1.1.1.3" xref="S3.SS2.p3.32.m21.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.32.m21.1b"><apply id="S3.SS2.p3.32.m21.1.1.cmml" xref="S3.SS2.p3.32.m21.1.1"><times id="S3.SS2.p3.32.m21.1.1.2.cmml" xref="S3.SS2.p3.32.m21.1.1.2"></times><ci id="S3.SS2.p3.32.m21.1.1.3.cmml" xref="S3.SS2.p3.32.m21.1.1.3">𝑝</ci><apply id="S3.SS2.p3.32.m21.1.1.1.1.1.cmml" xref="S3.SS2.p3.32.m21.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.32.m21.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.32.m21.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p3.32.m21.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.32.m21.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS2.p3.32.m21.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.32.m21.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.32.m21.1c">p(l|q)</annotation></semantics></math> using beam search, and assemble a neural network according to <math id="S3.SS2.p3.33.m22.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p3.33.m22.1a"><mi id="S3.SS2.p3.33.m22.1.1" xref="S3.SS2.p3.33.m22.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.33.m22.1b"><ci id="S3.SS2.p3.33.m22.1.1.cmml" xref="S3.SS2.p3.33.m22.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.33.m22.1c">l</annotation></semantics></math> to output an answer for the question.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>End-to-end training</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.9" class="ltx_p">During training, we jointly learn the layout policy <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="p(l|q)" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS3.p1.1.m1.1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.SS3.p1.1.m1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><times id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2"></times><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑝</ci><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">p(l|q)</annotation></semantics></math> and the parameters in each neural module, and minimize the expected loss from the layout policy. Let <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\theta</annotation></semantics></math> be all the parameters in our model. Suppose we obtain a layout <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">l</annotation></semantics></math> sampled from <math id="S3.SS3.p1.4.m4.3" class="ltx_Math" alttext="p(l|q;\theta)" display="inline"><semantics id="S3.SS3.p1.4.m4.3a"><mrow id="S3.SS3.p1.4.m4.3.3" xref="S3.SS3.p1.4.m4.3.3.cmml"><mi id="S3.SS3.p1.4.m4.3.3.3" xref="S3.SS3.p1.4.m4.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.3.3.2" xref="S3.SS3.p1.4.m4.3.3.2.cmml">​</mo><mrow id="S3.SS3.p1.4.m4.3.3.1.1" xref="S3.SS3.p1.4.m4.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m4.3.3.1.1.2" xref="S3.SS3.p1.4.m4.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.4.m4.3.3.1.1.1" xref="S3.SS3.p1.4.m4.3.3.1.1.1.cmml"><mi id="S3.SS3.p1.4.m4.3.3.1.1.1.2" xref="S3.SS3.p1.4.m4.3.3.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS3.p1.4.m4.3.3.1.1.1.1" xref="S3.SS3.p1.4.m4.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p1.4.m4.3.3.1.1.1.3.2" xref="S3.SS3.p1.4.m4.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">q</mi><mo id="S3.SS3.p1.4.m4.3.3.1.1.1.3.2.1" xref="S3.SS3.p1.4.m4.3.3.1.1.1.3.1.cmml">;</mo><mi id="S3.SS3.p1.4.m4.2.2" xref="S3.SS3.p1.4.m4.2.2.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.p1.4.m4.3.3.1.1.3" xref="S3.SS3.p1.4.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.3b"><apply id="S3.SS3.p1.4.m4.3.3.cmml" xref="S3.SS3.p1.4.m4.3.3"><times id="S3.SS3.p1.4.m4.3.3.2.cmml" xref="S3.SS3.p1.4.m4.3.3.2"></times><ci id="S3.SS3.p1.4.m4.3.3.3.cmml" xref="S3.SS3.p1.4.m4.3.3.3">𝑝</ci><apply id="S3.SS3.p1.4.m4.3.3.1.1.1.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p1.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1.2">𝑙</ci><list id="S3.SS3.p1.4.m4.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1.3.2"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑞</ci><ci id="S3.SS3.p1.4.m4.2.2.cmml" xref="S3.SS3.p1.4.m4.2.2">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.3c">p(l|q;\theta)</annotation></semantics></math> and receive a final question answering loss <math id="S3.SS3.p1.5.m5.4" class="ltx_Math" alttext="\tilde{L}(\theta,l;q,I)" display="inline"><semantics id="S3.SS3.p1.5.m5.4a"><mrow id="S3.SS3.p1.5.m5.4.5" xref="S3.SS3.p1.5.m5.4.5.cmml"><mover accent="true" id="S3.SS3.p1.5.m5.4.5.2" xref="S3.SS3.p1.5.m5.4.5.2.cmml"><mi id="S3.SS3.p1.5.m5.4.5.2.2" xref="S3.SS3.p1.5.m5.4.5.2.2.cmml">L</mi><mo id="S3.SS3.p1.5.m5.4.5.2.1" xref="S3.SS3.p1.5.m5.4.5.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m5.4.5.1" xref="S3.SS3.p1.5.m5.4.5.1.cmml">​</mo><mrow id="S3.SS3.p1.5.m5.4.5.3.2" xref="S3.SS3.p1.5.m5.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.4.5.3.2.1" xref="S3.SS3.p1.5.m5.4.5.3.1.cmml">(</mo><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">θ</mi><mo id="S3.SS3.p1.5.m5.4.5.3.2.2" xref="S3.SS3.p1.5.m5.4.5.3.1.cmml">,</mo><mi id="S3.SS3.p1.5.m5.2.2" xref="S3.SS3.p1.5.m5.2.2.cmml">l</mi><mo id="S3.SS3.p1.5.m5.4.5.3.2.3" xref="S3.SS3.p1.5.m5.4.5.3.1.cmml">;</mo><mi id="S3.SS3.p1.5.m5.3.3" xref="S3.SS3.p1.5.m5.3.3.cmml">q</mi><mo id="S3.SS3.p1.5.m5.4.5.3.2.4" xref="S3.SS3.p1.5.m5.4.5.3.1.cmml">,</mo><mi id="S3.SS3.p1.5.m5.4.4" xref="S3.SS3.p1.5.m5.4.4.cmml">I</mi><mo stretchy="false" id="S3.SS3.p1.5.m5.4.5.3.2.5" xref="S3.SS3.p1.5.m5.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.4b"><apply id="S3.SS3.p1.5.m5.4.5.cmml" xref="S3.SS3.p1.5.m5.4.5"><times id="S3.SS3.p1.5.m5.4.5.1.cmml" xref="S3.SS3.p1.5.m5.4.5.1"></times><apply id="S3.SS3.p1.5.m5.4.5.2.cmml" xref="S3.SS3.p1.5.m5.4.5.2"><ci id="S3.SS3.p1.5.m5.4.5.2.1.cmml" xref="S3.SS3.p1.5.m5.4.5.2.1">~</ci><ci id="S3.SS3.p1.5.m5.4.5.2.2.cmml" xref="S3.SS3.p1.5.m5.4.5.2.2">𝐿</ci></apply><vector id="S3.SS3.p1.5.m5.4.5.3.1.cmml" xref="S3.SS3.p1.5.m5.4.5.3.2"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝜃</ci><ci id="S3.SS3.p1.5.m5.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2">𝑙</ci><ci id="S3.SS3.p1.5.m5.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3">𝑞</ci><ci id="S3.SS3.p1.5.m5.4.4.cmml" xref="S3.SS3.p1.5.m5.4.4">𝐼</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.4c">\tilde{L}(\theta,l;q,I)</annotation></semantics></math> on question <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">q</annotation></semantics></math> and image <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">I</annotation></semantics></math> after predicting an answer using the network assembled with <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">l</annotation></semantics></math>. Our training loss function <math id="S3.SS3.p1.9.m9.1" class="ltx_Math" alttext="L(\theta)" display="inline"><semantics id="S3.SS3.p1.9.m9.1a"><mrow id="S3.SS3.p1.9.m9.1.2" xref="S3.SS3.p1.9.m9.1.2.cmml"><mi id="S3.SS3.p1.9.m9.1.2.2" xref="S3.SS3.p1.9.m9.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.9.m9.1.2.1" xref="S3.SS3.p1.9.m9.1.2.1.cmml">​</mo><mrow id="S3.SS3.p1.9.m9.1.2.3.2" xref="S3.SS3.p1.9.m9.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.9.m9.1.2.3.2.1" xref="S3.SS3.p1.9.m9.1.2.cmml">(</mo><mi id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS3.p1.9.m9.1.2.3.2.2" xref="S3.SS3.p1.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.2.cmml" xref="S3.SS3.p1.9.m9.1.2"><times id="S3.SS3.p1.9.m9.1.2.1.cmml" xref="S3.SS3.p1.9.m9.1.2.1"></times><ci id="S3.SS3.p1.9.m9.1.2.2.cmml" xref="S3.SS3.p1.9.m9.1.2.2">𝐿</ci><ci id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">L(\theta)</annotation></semantics></math> is as follows.</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.9" class="ltx_Math" alttext="L(\theta)=E_{l\sim p(l|q;\theta)}[\tilde{L}(\theta,l;q,I)]" display="block"><semantics id="S3.E4.m1.9a"><mrow id="S3.E4.m1.9.9" xref="S3.E4.m1.9.9.cmml"><mrow id="S3.E4.m1.9.9.3" xref="S3.E4.m1.9.9.3.cmml"><mi id="S3.E4.m1.9.9.3.2" xref="S3.E4.m1.9.9.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.3.1" xref="S3.E4.m1.9.9.3.1.cmml">​</mo><mrow id="S3.E4.m1.9.9.3.3.2" xref="S3.E4.m1.9.9.3.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.3.3.2.1" xref="S3.E4.m1.9.9.3.cmml">(</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">θ</mi><mo stretchy="false" id="S3.E4.m1.9.9.3.3.2.2" xref="S3.E4.m1.9.9.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.9.9.2" xref="S3.E4.m1.9.9.2.cmml">=</mo><mrow id="S3.E4.m1.9.9.1" xref="S3.E4.m1.9.9.1.cmml"><msub id="S3.E4.m1.9.9.1.3" xref="S3.E4.m1.9.9.1.3.cmml"><mi id="S3.E4.m1.9.9.1.3.2" xref="S3.E4.m1.9.9.1.3.2.cmml">E</mi><mrow id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml"><mi id="S3.E4.m1.3.3.3.5" xref="S3.E4.m1.3.3.3.5.cmml">l</mi><mo id="S3.E4.m1.3.3.3.4" xref="S3.E4.m1.3.3.3.4.cmml">∼</mo><mrow id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.cmml"><mi id="S3.E4.m1.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.3.2" xref="S3.E4.m1.3.3.3.3.2.cmml">​</mo><mrow id="S3.E4.m1.3.3.3.3.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.3.3.1.1.2" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.3.3.1.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1.1.2" xref="S3.E4.m1.3.3.3.3.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.E4.m1.3.3.3.3.1.1.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.E4.m1.3.3.3.3.1.1.1.3.2" xref="S3.E4.m1.3.3.3.3.1.1.1.3.1.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">q</mi><mo id="S3.E4.m1.3.3.3.3.1.1.1.3.2.1" xref="S3.E4.m1.3.3.3.3.1.1.1.3.1.cmml">;</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.E4.m1.3.3.3.3.1.1.3" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.2" xref="S3.E4.m1.9.9.1.2.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.1" xref="S3.E4.m1.9.9.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.2" xref="S3.E4.m1.9.9.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.9.9.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.9.9.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.2.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.2.2" xref="S3.E4.m1.9.9.1.1.1.1.2.2.cmml">L</mi><mo id="S3.E4.m1.9.9.1.1.1.1.2.1" xref="S3.E4.m1.9.9.1.1.1.1.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.3.2" xref="S3.E4.m1.9.9.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.3.2.1" xref="S3.E4.m1.9.9.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">θ</mi><mo id="S3.E4.m1.9.9.1.1.1.1.3.2.2" xref="S3.E4.m1.9.9.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">l</mi><mo id="S3.E4.m1.9.9.1.1.1.1.3.2.3" xref="S3.E4.m1.9.9.1.1.1.1.3.1.cmml">;</mo><mi id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">q</mi><mo id="S3.E4.m1.9.9.1.1.1.1.3.2.4" xref="S3.E4.m1.9.9.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml">I</mi><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.3.2.5" xref="S3.E4.m1.9.9.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.3" xref="S3.E4.m1.9.9.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.9b"><apply id="S3.E4.m1.9.9.cmml" xref="S3.E4.m1.9.9"><eq id="S3.E4.m1.9.9.2.cmml" xref="S3.E4.m1.9.9.2"></eq><apply id="S3.E4.m1.9.9.3.cmml" xref="S3.E4.m1.9.9.3"><times id="S3.E4.m1.9.9.3.1.cmml" xref="S3.E4.m1.9.9.3.1"></times><ci id="S3.E4.m1.9.9.3.2.cmml" xref="S3.E4.m1.9.9.3.2">𝐿</ci><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝜃</ci></apply><apply id="S3.E4.m1.9.9.1.cmml" xref="S3.E4.m1.9.9.1"><times id="S3.E4.m1.9.9.1.2.cmml" xref="S3.E4.m1.9.9.1.2"></times><apply id="S3.E4.m1.9.9.1.3.cmml" xref="S3.E4.m1.9.9.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.3.1.cmml" xref="S3.E4.m1.9.9.1.3">subscript</csymbol><ci id="S3.E4.m1.9.9.1.3.2.cmml" xref="S3.E4.m1.9.9.1.3.2">𝐸</ci><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"><csymbol cd="latexml" id="S3.E4.m1.3.3.3.4.cmml" xref="S3.E4.m1.3.3.3.4">similar-to</csymbol><ci id="S3.E4.m1.3.3.3.5.cmml" xref="S3.E4.m1.3.3.3.5">𝑙</ci><apply id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3"><times id="S3.E4.m1.3.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.3.2"></times><ci id="S3.E4.m1.3.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.3">𝑝</ci><apply id="S3.E4.m1.3.3.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1"><csymbol cd="latexml" id="S3.E4.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.1">conditional</csymbol><ci id="S3.E4.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.2">𝑙</ci><list id="S3.E4.m1.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.2"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑞</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝜃</ci></list></apply></apply></apply></apply><apply id="S3.E4.m1.9.9.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.9.9.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1"><times id="S3.E4.m1.9.9.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1"></times><apply id="S3.E4.m1.9.9.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2"><ci id="S3.E4.m1.9.9.1.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2.1">~</ci><ci id="S3.E4.m1.9.9.1.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2.2">𝐿</ci></apply><vector id="S3.E4.m1.9.9.1.1.1.1.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.3.2"><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">𝜃</ci><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝑙</ci><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">𝑞</ci><ci id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8">𝐼</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.9c">L(\theta)=E_{l\sim p(l|q;\theta)}[\tilde{L}(\theta,l;q,I)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.10" class="ltx_p">where we use the softmax loss over the output answer scores as <math id="S3.SS3.p1.10.m1.4" class="ltx_Math" alttext="\tilde{L}(\theta,l;q,I)" display="inline"><semantics id="S3.SS3.p1.10.m1.4a"><mrow id="S3.SS3.p1.10.m1.4.5" xref="S3.SS3.p1.10.m1.4.5.cmml"><mover accent="true" id="S3.SS3.p1.10.m1.4.5.2" xref="S3.SS3.p1.10.m1.4.5.2.cmml"><mi id="S3.SS3.p1.10.m1.4.5.2.2" xref="S3.SS3.p1.10.m1.4.5.2.2.cmml">L</mi><mo id="S3.SS3.p1.10.m1.4.5.2.1" xref="S3.SS3.p1.10.m1.4.5.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.p1.10.m1.4.5.1" xref="S3.SS3.p1.10.m1.4.5.1.cmml">​</mo><mrow id="S3.SS3.p1.10.m1.4.5.3.2" xref="S3.SS3.p1.10.m1.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.10.m1.4.5.3.2.1" xref="S3.SS3.p1.10.m1.4.5.3.1.cmml">(</mo><mi id="S3.SS3.p1.10.m1.1.1" xref="S3.SS3.p1.10.m1.1.1.cmml">θ</mi><mo id="S3.SS3.p1.10.m1.4.5.3.2.2" xref="S3.SS3.p1.10.m1.4.5.3.1.cmml">,</mo><mi id="S3.SS3.p1.10.m1.2.2" xref="S3.SS3.p1.10.m1.2.2.cmml">l</mi><mo id="S3.SS3.p1.10.m1.4.5.3.2.3" xref="S3.SS3.p1.10.m1.4.5.3.1.cmml">;</mo><mi id="S3.SS3.p1.10.m1.3.3" xref="S3.SS3.p1.10.m1.3.3.cmml">q</mi><mo id="S3.SS3.p1.10.m1.4.5.3.2.4" xref="S3.SS3.p1.10.m1.4.5.3.1.cmml">,</mo><mi id="S3.SS3.p1.10.m1.4.4" xref="S3.SS3.p1.10.m1.4.4.cmml">I</mi><mo stretchy="false" id="S3.SS3.p1.10.m1.4.5.3.2.5" xref="S3.SS3.p1.10.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m1.4b"><apply id="S3.SS3.p1.10.m1.4.5.cmml" xref="S3.SS3.p1.10.m1.4.5"><times id="S3.SS3.p1.10.m1.4.5.1.cmml" xref="S3.SS3.p1.10.m1.4.5.1"></times><apply id="S3.SS3.p1.10.m1.4.5.2.cmml" xref="S3.SS3.p1.10.m1.4.5.2"><ci id="S3.SS3.p1.10.m1.4.5.2.1.cmml" xref="S3.SS3.p1.10.m1.4.5.2.1">~</ci><ci id="S3.SS3.p1.10.m1.4.5.2.2.cmml" xref="S3.SS3.p1.10.m1.4.5.2.2">𝐿</ci></apply><vector id="S3.SS3.p1.10.m1.4.5.3.1.cmml" xref="S3.SS3.p1.10.m1.4.5.3.2"><ci id="S3.SS3.p1.10.m1.1.1.cmml" xref="S3.SS3.p1.10.m1.1.1">𝜃</ci><ci id="S3.SS3.p1.10.m1.2.2.cmml" xref="S3.SS3.p1.10.m1.2.2">𝑙</ci><ci id="S3.SS3.p1.10.m1.3.3.cmml" xref="S3.SS3.p1.10.m1.3.3">𝑞</ci><ci id="S3.SS3.p1.10.m1.4.4.cmml" xref="S3.SS3.p1.10.m1.4.4">𝐼</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m1.4c">\tilde{L}(\theta,l;q,I)</annotation></semantics></math> in our implementation.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.6" class="ltx_p">The loss function in <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="L(\theta)" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><mi id="S3.SS3.p2.1.m1.1.2.2" xref="S3.SS3.p2.1.m1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.2.1" xref="S3.SS3.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p2.1.m1.1.2.3.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.2.3.2.1" xref="S3.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS3.p2.1.m1.1.2.3.2.2" xref="S3.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.2"><times id="S3.SS3.p2.1.m1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.1"></times><ci id="S3.SS3.p2.1.m1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2">𝐿</ci><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">L(\theta)</annotation></semantics></math> is not fully differentiable since the layout <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">l</annotation></semantics></math> is discrete, so one cannot train it with full back-propagation. We optimize <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="L(\theta)" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.2" xref="S3.SS3.p2.3.m3.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.2.2" xref="S3.SS3.p2.3.m3.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.2.1" xref="S3.SS3.p2.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS3.p2.3.m3.1.2.3.2" xref="S3.SS3.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.3.m3.1.2.3.2.1" xref="S3.SS3.p2.3.m3.1.2.cmml">(</mo><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS3.p2.3.m3.1.2.3.2.2" xref="S3.SS3.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.2.cmml" xref="S3.SS3.p2.3.m3.1.2"><times id="S3.SS3.p2.3.m3.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.2.1"></times><ci id="S3.SS3.p2.3.m3.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.2.2">𝐿</ci><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">L(\theta)</annotation></semantics></math> using back-propagation for differentiable parts, and policy gradient method in reinforcement learning for non-differentiable part. The gradient <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\nabla_{\theta}L" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><msub id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml"><mo id="S3.SS3.p2.4.m4.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.2.cmml">∇</mo><mi id="S3.SS3.p2.4.m4.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.3.cmml">θ</mi></msub><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><apply id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.2">∇</ci><ci id="S3.SS3.p2.4.m4.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.3">𝜃</ci></apply><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\nabla_{\theta}L</annotation></semantics></math> of the loss <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="L(\theta)" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mrow id="S3.SS3.p2.5.m5.1.2" xref="S3.SS3.p2.5.m5.1.2.cmml"><mi id="S3.SS3.p2.5.m5.1.2.2" xref="S3.SS3.p2.5.m5.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.5.m5.1.2.1" xref="S3.SS3.p2.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS3.p2.5.m5.1.2.3.2" xref="S3.SS3.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.5.m5.1.2.3.2.1" xref="S3.SS3.p2.5.m5.1.2.cmml">(</mo><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS3.p2.5.m5.1.2.3.2.2" xref="S3.SS3.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.2.cmml" xref="S3.SS3.p2.5.m5.1.2"><times id="S3.SS3.p2.5.m5.1.2.1.cmml" xref="S3.SS3.p2.5.m5.1.2.1"></times><ci id="S3.SS3.p2.5.m5.1.2.2.cmml" xref="S3.SS3.p2.5.m5.1.2.2">𝐿</ci><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">L(\theta)</annotation></semantics></math> is
<math id="S3.SS3.p2.6.m6.10" class="ltx_Math" alttext="\nabla_{\theta}L=E_{l\sim p(l|q;\theta)}\left[\tilde{L}(\theta,l)\nabla_{\theta}\log p(l|q;\theta)+\nabla_{\theta}\tilde{L}(\theta,l)\right]" display="inline"><semantics id="S3.SS3.p2.6.m6.10a"><mrow id="S3.SS3.p2.6.m6.10.10" xref="S3.SS3.p2.6.m6.10.10.cmml"><mrow id="S3.SS3.p2.6.m6.10.10.3" xref="S3.SS3.p2.6.m6.10.10.3.cmml"><msub id="S3.SS3.p2.6.m6.10.10.3.1" xref="S3.SS3.p2.6.m6.10.10.3.1.cmml"><mo id="S3.SS3.p2.6.m6.10.10.3.1.2" xref="S3.SS3.p2.6.m6.10.10.3.1.2.cmml">∇</mo><mi id="S3.SS3.p2.6.m6.10.10.3.1.3" xref="S3.SS3.p2.6.m6.10.10.3.1.3.cmml">θ</mi></msub><mi id="S3.SS3.p2.6.m6.10.10.3.2" xref="S3.SS3.p2.6.m6.10.10.3.2.cmml">L</mi></mrow><mo id="S3.SS3.p2.6.m6.10.10.2" xref="S3.SS3.p2.6.m6.10.10.2.cmml">=</mo><mrow id="S3.SS3.p2.6.m6.10.10.1" xref="S3.SS3.p2.6.m6.10.10.1.cmml"><msub id="S3.SS3.p2.6.m6.10.10.1.3" xref="S3.SS3.p2.6.m6.10.10.1.3.cmml"><mi id="S3.SS3.p2.6.m6.10.10.1.3.2" xref="S3.SS3.p2.6.m6.10.10.1.3.2.cmml">E</mi><mrow id="S3.SS3.p2.6.m6.3.3.3" xref="S3.SS3.p2.6.m6.3.3.3.cmml"><mi id="S3.SS3.p2.6.m6.3.3.3.5" xref="S3.SS3.p2.6.m6.3.3.3.5.cmml">l</mi><mo id="S3.SS3.p2.6.m6.3.3.3.4" xref="S3.SS3.p2.6.m6.3.3.3.4.cmml">∼</mo><mrow id="S3.SS3.p2.6.m6.3.3.3.3" xref="S3.SS3.p2.6.m6.3.3.3.3.cmml"><mi id="S3.SS3.p2.6.m6.3.3.3.3.3" xref="S3.SS3.p2.6.m6.3.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.3.3.3.3.2" xref="S3.SS3.p2.6.m6.3.3.3.3.2.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.3.3.3.3.1.1" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.3.3.3.3.1.1.2" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.cmml"><mi id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.2" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.1" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.3.2" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.1.cmml">q</mi><mo id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.3.2.1" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.3.1.cmml">;</mo><mi id="S3.SS3.p2.6.m6.2.2.2.2" xref="S3.SS3.p2.6.m6.2.2.2.2.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.p2.6.m6.3.3.3.3.1.1.3" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.10.10.1.2" xref="S3.SS3.p2.6.m6.10.10.1.2.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1" xref="S3.SS3.p2.6.m6.10.10.1.1.2.cmml"><mo id="S3.SS3.p2.6.m6.10.10.1.1.1.2" xref="S3.SS3.p2.6.m6.10.10.1.1.2.1.cmml">[</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.cmml"><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.2.cmml">L</mi><mo id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.2.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.1.cmml">(</mo><mi id="S3.SS3.p2.6.m6.4.4" xref="S3.SS3.p2.6.m6.4.4.cmml">θ</mi><mo id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.2.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.1.cmml">,</mo><mi id="S3.SS3.p2.6.m6.5.5" xref="S3.SS3.p2.6.m6.5.5.cmml">l</mi><mo stretchy="false" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.2.3" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.2a" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.cmml"><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.cmml"><msub id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.cmml"><mo rspace="0.167em" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.2.cmml">∇</mo><mi id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.3" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.3.cmml">θ</mi></msub><mi id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5a" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.cmml">⁡</mo><mi id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.2b" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.3.1.cmml"><mi id="S3.SS3.p2.6.m6.6.6" xref="S3.SS3.p2.6.m6.6.6.cmml">q</mi><mo id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.3.2.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S3.SS3.p2.6.m6.7.7" xref="S3.SS3.p2.6.m6.7.7.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.6.m6.10.10.1.1.1.1.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.2.cmml">+</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.cmml"><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.cmml"><msub id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.cmml"><mo rspace="0.167em" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.2.cmml">∇</mo><mi id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.3" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.3.cmml">θ</mi></msub><mover accent="true" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.cmml"><mi id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.2.cmml">L</mi><mo id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.1.cmml">~</mo></mover></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.2.1" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.SS3.p2.6.m6.8.8" xref="S3.SS3.p2.6.m6.8.8.cmml">θ</mi><mo id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.2.2" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.SS3.p2.6.m6.9.9" xref="S3.SS3.p2.6.m6.9.9.cmml">l</mi><mo stretchy="false" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.2.3" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.p2.6.m6.10.10.1.1.1.3" xref="S3.SS3.p2.6.m6.10.10.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.10b"><apply id="S3.SS3.p2.6.m6.10.10.cmml" xref="S3.SS3.p2.6.m6.10.10"><eq id="S3.SS3.p2.6.m6.10.10.2.cmml" xref="S3.SS3.p2.6.m6.10.10.2"></eq><apply id="S3.SS3.p2.6.m6.10.10.3.cmml" xref="S3.SS3.p2.6.m6.10.10.3"><apply id="S3.SS3.p2.6.m6.10.10.3.1.cmml" xref="S3.SS3.p2.6.m6.10.10.3.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.10.10.3.1.1.cmml" xref="S3.SS3.p2.6.m6.10.10.3.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.10.10.3.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.3.1.2">∇</ci><ci id="S3.SS3.p2.6.m6.10.10.3.1.3.cmml" xref="S3.SS3.p2.6.m6.10.10.3.1.3">𝜃</ci></apply><ci id="S3.SS3.p2.6.m6.10.10.3.2.cmml" xref="S3.SS3.p2.6.m6.10.10.3.2">𝐿</ci></apply><apply id="S3.SS3.p2.6.m6.10.10.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1"><times id="S3.SS3.p2.6.m6.10.10.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.2"></times><apply id="S3.SS3.p2.6.m6.10.10.1.3.cmml" xref="S3.SS3.p2.6.m6.10.10.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.10.10.1.3.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.3">subscript</csymbol><ci id="S3.SS3.p2.6.m6.10.10.1.3.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.3.2">𝐸</ci><apply id="S3.SS3.p2.6.m6.3.3.3.cmml" xref="S3.SS3.p2.6.m6.3.3.3"><csymbol cd="latexml" id="S3.SS3.p2.6.m6.3.3.3.4.cmml" xref="S3.SS3.p2.6.m6.3.3.3.4">similar-to</csymbol><ci id="S3.SS3.p2.6.m6.3.3.3.5.cmml" xref="S3.SS3.p2.6.m6.3.3.3.5">𝑙</ci><apply id="S3.SS3.p2.6.m6.3.3.3.3.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3"><times id="S3.SS3.p2.6.m6.3.3.3.3.2.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3.2"></times><ci id="S3.SS3.p2.6.m6.3.3.3.3.3.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3.3">𝑝</ci><apply id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.2">𝑙</ci><list id="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3.1.1.1.3.2"><ci id="S3.SS3.p2.6.m6.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1">𝑞</ci><ci id="S3.SS3.p2.6.m6.2.2.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2.2.2">𝜃</ci></list></apply></apply></apply></apply><apply id="S3.SS3.p2.6.m6.10.10.1.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.6.m6.10.10.1.1.2.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1"><plus id="S3.SS3.p2.6.m6.10.10.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.2"></plus><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1"><times id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.2"></times><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3"><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.1">~</ci><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.3.2">𝐿</ci></apply><interval closure="open" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.4.2"><ci id="S3.SS3.p2.6.m6.4.4.cmml" xref="S3.SS3.p2.6.m6.4.4">𝜃</ci><ci id="S3.SS3.p2.6.m6.5.5.cmml" xref="S3.SS3.p2.6.m6.5.5">𝑙</ci></interval><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5"><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1"><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.2">∇</ci><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.3.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.1.3">𝜃</ci></apply><log id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.1.2"></log></apply><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.5.2">𝑝</ci></apply><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.2">𝑙</ci><list id="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.1.1.1.1.3.2"><ci id="S3.SS3.p2.6.m6.6.6.cmml" xref="S3.SS3.p2.6.m6.6.6">𝑞</ci><ci id="S3.SS3.p2.6.m6.7.7.cmml" xref="S3.SS3.p2.6.m6.7.7">𝜃</ci></list></apply></apply><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3"><times id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.1"></times><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2"><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.2">∇</ci><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.3.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.1.3">𝜃</ci></apply><apply id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2"><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.1">~</ci><ci id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.2.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.2.2.2">𝐿</ci></apply></apply><interval closure="open" id="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p2.6.m6.10.10.1.1.1.1.3.3.2"><ci id="S3.SS3.p2.6.m6.8.8.cmml" xref="S3.SS3.p2.6.m6.8.8">𝜃</ci><ci id="S3.SS3.p2.6.m6.9.9.cmml" xref="S3.SS3.p2.6.m6.9.9">𝑙</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.10c">\nabla_{\theta}L=E_{l\sim p(l|q;\theta)}\left[\tilde{L}(\theta,l)\nabla_{\theta}\log p(l|q;\theta)+\nabla_{\theta}\tilde{L}(\theta,l)\right]</annotation></semantics></math>
which can be estimated using Monte-Carlo sampling as</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.5" class="ltx_Math" alttext="\nabla_{\theta}L\approx\frac{1}{M}\sum_{m=1}^{M}\left(\tilde{L}(\theta,l_{m})\nabla_{\theta}\log p(l_{m}|q;\theta)+\nabla_{\theta}\tilde{L}(\theta,l_{m})\right)" display="block"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml"><mrow id="S3.E5.m1.5.5.3" xref="S3.E5.m1.5.5.3.cmml"><msub id="S3.E5.m1.5.5.3.1" xref="S3.E5.m1.5.5.3.1.cmml"><mo id="S3.E5.m1.5.5.3.1.2" xref="S3.E5.m1.5.5.3.1.2.cmml">∇</mo><mi id="S3.E5.m1.5.5.3.1.3" xref="S3.E5.m1.5.5.3.1.3.cmml">θ</mi></msub><mi id="S3.E5.m1.5.5.3.2" xref="S3.E5.m1.5.5.3.2.cmml">L</mi></mrow><mo id="S3.E5.m1.5.5.2" xref="S3.E5.m1.5.5.2.cmml">≈</mo><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.cmml"><mfrac id="S3.E5.m1.5.5.1.3" xref="S3.E5.m1.5.5.1.3.cmml"><mn id="S3.E5.m1.5.5.1.3.2" xref="S3.E5.m1.5.5.1.3.2.cmml">1</mn><mi id="S3.E5.m1.5.5.1.3.3" xref="S3.E5.m1.5.5.1.3.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><munderover id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E5.m1.5.5.1.1.2.2.2" xref="S3.E5.m1.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.5.5.1.1.2.2.3" xref="S3.E5.m1.5.5.1.1.2.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.2.2.3.2" xref="S3.E5.m1.5.5.1.1.2.2.3.2.cmml">m</mi><mo id="S3.E5.m1.5.5.1.1.2.2.3.1" xref="S3.E5.m1.5.5.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.5.5.1.1.2.2.3.3" xref="S3.E5.m1.5.5.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.5.5.1.1.2.3" xref="S3.E5.m1.5.5.1.1.2.3.cmml">M</mi></munderover><mrow id="S3.E5.m1.5.5.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.cmml"><mo id="S3.E5.m1.5.5.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E5.m1.5.5.1.1.1.1.1.2.4" xref="S3.E5.m1.5.5.1.1.1.1.1.2.4.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.2.4.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.4.2.cmml">L</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.2.4.1" xref="S3.E5.m1.5.5.1.1.1.1.1.2.4.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.1.1.1.2.3" xref="S3.E5.m1.5.5.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">θ</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">l</mi><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E5.m1.5.5.1.1.1.1.1.2.3a" xref="S3.E5.m1.5.5.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.2.5" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.cmml"><mrow id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.cmml"><msub id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.cmml"><mo rspace="0.167em" id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.2.cmml">∇</mo><mi id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.3.cmml">θ</mi></msub><mi id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S3.E5.m1.5.5.1.1.1.1.1.2.5a" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.cmml">⁡</mo><mi id="S3.E5.m1.5.5.1.1.1.1.1.2.5.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.1.1.1.2.3b" xref="S3.E5.m1.5.5.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.cmml"><msub id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.2.cmml">l</mi><mi id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.3" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.3.cmml">m</mi></msub><mo fence="false" id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.1.cmml">|</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.3.2" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.3.1.cmml"><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">q</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.1" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.3.1.cmml">;</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.1.1.1.4" xref="S3.E5.m1.5.5.1.1.1.1.1.4.cmml">+</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.3.cmml"><mrow id="S3.E5.m1.5.5.1.1.1.1.1.3.3" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.cmml"><msub id="S3.E5.m1.5.5.1.1.1.1.1.3.3.1" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.cmml"><mo rspace="0.167em" id="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.2.cmml">∇</mo><mi id="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.3.cmml">θ</mi></msub><mover accent="true" id="S3.E5.m1.5.5.1.1.1.1.1.3.3.2" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.2" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.2.cmml">L</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.1" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.1.cmml">~</mo></mover></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.1.1.1.1.1.3.2" xref="S3.E5.m1.5.5.1.1.1.1.1.3.2.cmml">​</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.2.cmml">(</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">θ</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.2.cmml">,</mo><msub id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.2.cmml">l</mi><mi id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.4" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5"><approx id="S3.E5.m1.5.5.2.cmml" xref="S3.E5.m1.5.5.2"></approx><apply id="S3.E5.m1.5.5.3.cmml" xref="S3.E5.m1.5.5.3"><apply id="S3.E5.m1.5.5.3.1.cmml" xref="S3.E5.m1.5.5.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.3.1.1.cmml" xref="S3.E5.m1.5.5.3.1">subscript</csymbol><ci id="S3.E5.m1.5.5.3.1.2.cmml" xref="S3.E5.m1.5.5.3.1.2">∇</ci><ci id="S3.E5.m1.5.5.3.1.3.cmml" xref="S3.E5.m1.5.5.3.1.3">𝜃</ci></apply><ci id="S3.E5.m1.5.5.3.2.cmml" xref="S3.E5.m1.5.5.3.2">𝐿</ci></apply><apply id="S3.E5.m1.5.5.1.cmml" xref="S3.E5.m1.5.5.1"><times id="S3.E5.m1.5.5.1.2.cmml" xref="S3.E5.m1.5.5.1.2"></times><apply id="S3.E5.m1.5.5.1.3.cmml" xref="S3.E5.m1.5.5.1.3"><divide id="S3.E5.m1.5.5.1.3.1.cmml" xref="S3.E5.m1.5.5.1.3"></divide><cn type="integer" id="S3.E5.m1.5.5.1.3.2.cmml" xref="S3.E5.m1.5.5.1.3.2">1</cn><ci id="S3.E5.m1.5.5.1.3.3.cmml" xref="S3.E5.m1.5.5.1.3.3">𝑀</ci></apply><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1.1"><apply id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2">subscript</csymbol><sum id="S3.E5.m1.5.5.1.1.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2"></sum><apply id="S3.E5.m1.5.5.1.1.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.3"><eq id="S3.E5.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2.3.1"></eq><ci id="S3.E5.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.E5.m1.5.5.1.1.2.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.5.5.1.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.3">𝑀</ci></apply><apply id="S3.E5.m1.5.5.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1"><plus id="S3.E5.m1.5.5.1.1.1.1.1.4.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.4"></plus><apply id="S3.E5.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2"><times id="S3.E5.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.3"></times><apply id="S3.E5.m1.5.5.1.1.1.1.1.2.4.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.4"><ci id="S3.E5.m1.5.5.1.1.1.1.1.2.4.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.4.1">~</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.2.4.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.4.2">𝐿</ci></apply><interval closure="open" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝜃</ci><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></interval><apply id="S3.E5.m1.5.5.1.1.1.1.1.2.5.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5"><apply id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1"><apply id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.2">∇</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.1.3">𝜃</ci></apply><log id="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.1.2"></log></apply><ci id="S3.E5.m1.5.5.1.1.1.1.1.2.5.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.5.2">𝑝</ci></apply><apply id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1"><csymbol cd="latexml" id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.1">conditional</csymbol><apply id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.2">𝑙</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.2.3">𝑚</ci></apply><list id="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.2.2.1.1.3.2"><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝑞</ci><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝜃</ci></list></apply></apply><apply id="S3.E5.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3"><times id="S3.E5.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.2"></times><apply id="S3.E5.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3"><apply id="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.2">∇</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.1.3">𝜃</ci></apply><apply id="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.2"><ci id="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.1">~</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.3.2.2">𝐿</ci></apply></apply><interval closure="open" id="S3.E5.m1.5.5.1.1.1.1.1.3.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.1"><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝜃</ci><apply id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.2">𝑙</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3.1.1.1.3">𝑚</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\nabla_{\theta}L\approx\frac{1}{M}\sum_{m=1}^{M}\left(\tilde{L}(\theta,l_{m})\nabla_{\theta}\log p(l_{m}|q;\theta)+\nabla_{\theta}\tilde{L}(\theta,l_{m})\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.9" class="ltx_p">where both <math id="S3.SS3.p2.7.m1.3" class="ltx_Math" alttext="\log p(l_{m}|q;\theta)" display="inline"><semantics id="S3.SS3.p2.7.m1.3a"><mrow id="S3.SS3.p2.7.m1.3.3" xref="S3.SS3.p2.7.m1.3.3.cmml"><mrow id="S3.SS3.p2.7.m1.3.3.3" xref="S3.SS3.p2.7.m1.3.3.3.cmml"><mi id="S3.SS3.p2.7.m1.3.3.3.1" xref="S3.SS3.p2.7.m1.3.3.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS3.p2.7.m1.3.3.3a" xref="S3.SS3.p2.7.m1.3.3.3.cmml">⁡</mo><mi id="S3.SS3.p2.7.m1.3.3.3.2" xref="S3.SS3.p2.7.m1.3.3.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p2.7.m1.3.3.2" xref="S3.SS3.p2.7.m1.3.3.2.cmml">​</mo><mrow id="S3.SS3.p2.7.m1.3.3.1.1" xref="S3.SS3.p2.7.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.7.m1.3.3.1.1.2" xref="S3.SS3.p2.7.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.7.m1.3.3.1.1.1" xref="S3.SS3.p2.7.m1.3.3.1.1.1.cmml"><msub id="S3.SS3.p2.7.m1.3.3.1.1.1.2" xref="S3.SS3.p2.7.m1.3.3.1.1.1.2.cmml"><mi id="S3.SS3.p2.7.m1.3.3.1.1.1.2.2" xref="S3.SS3.p2.7.m1.3.3.1.1.1.2.2.cmml">l</mi><mi id="S3.SS3.p2.7.m1.3.3.1.1.1.2.3" xref="S3.SS3.p2.7.m1.3.3.1.1.1.2.3.cmml">m</mi></msub><mo fence="false" id="S3.SS3.p2.7.m1.3.3.1.1.1.1" xref="S3.SS3.p2.7.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p2.7.m1.3.3.1.1.1.3.2" xref="S3.SS3.p2.7.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.p2.7.m1.1.1" xref="S3.SS3.p2.7.m1.1.1.cmml">q</mi><mo id="S3.SS3.p2.7.m1.3.3.1.1.1.3.2.1" xref="S3.SS3.p2.7.m1.3.3.1.1.1.3.1.cmml">;</mo><mi id="S3.SS3.p2.7.m1.2.2" xref="S3.SS3.p2.7.m1.2.2.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.p2.7.m1.3.3.1.1.3" xref="S3.SS3.p2.7.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m1.3b"><apply id="S3.SS3.p2.7.m1.3.3.cmml" xref="S3.SS3.p2.7.m1.3.3"><times id="S3.SS3.p2.7.m1.3.3.2.cmml" xref="S3.SS3.p2.7.m1.3.3.2"></times><apply id="S3.SS3.p2.7.m1.3.3.3.cmml" xref="S3.SS3.p2.7.m1.3.3.3"><log id="S3.SS3.p2.7.m1.3.3.3.1.cmml" xref="S3.SS3.p2.7.m1.3.3.3.1"></log><ci id="S3.SS3.p2.7.m1.3.3.3.2.cmml" xref="S3.SS3.p2.7.m1.3.3.3.2">𝑝</ci></apply><apply id="S3.SS3.p2.7.m1.3.3.1.1.1.cmml" xref="S3.SS3.p2.7.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.p2.7.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.7.m1.3.3.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p2.7.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.7.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m1.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p2.7.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.7.m1.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p2.7.m1.3.3.1.1.1.2.2">𝑙</ci><ci id="S3.SS3.p2.7.m1.3.3.1.1.1.2.3.cmml" xref="S3.SS3.p2.7.m1.3.3.1.1.1.2.3">𝑚</ci></apply><list id="S3.SS3.p2.7.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p2.7.m1.3.3.1.1.1.3.2"><ci id="S3.SS3.p2.7.m1.1.1.cmml" xref="S3.SS3.p2.7.m1.1.1">𝑞</ci><ci id="S3.SS3.p2.7.m1.2.2.cmml" xref="S3.SS3.p2.7.m1.2.2">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m1.3c">\log p(l_{m}|q;\theta)</annotation></semantics></math> and <math id="S3.SS3.p2.8.m2.2" class="ltx_Math" alttext="\tilde{L}(\theta,l_{m})" display="inline"><semantics id="S3.SS3.p2.8.m2.2a"><mrow id="S3.SS3.p2.8.m2.2.2" xref="S3.SS3.p2.8.m2.2.2.cmml"><mover accent="true" id="S3.SS3.p2.8.m2.2.2.3" xref="S3.SS3.p2.8.m2.2.2.3.cmml"><mi id="S3.SS3.p2.8.m2.2.2.3.2" xref="S3.SS3.p2.8.m2.2.2.3.2.cmml">L</mi><mo id="S3.SS3.p2.8.m2.2.2.3.1" xref="S3.SS3.p2.8.m2.2.2.3.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m2.2.2.2" xref="S3.SS3.p2.8.m2.2.2.2.cmml">​</mo><mrow id="S3.SS3.p2.8.m2.2.2.1.1" xref="S3.SS3.p2.8.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.8.m2.2.2.1.1.2" xref="S3.SS3.p2.8.m2.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p2.8.m2.1.1" xref="S3.SS3.p2.8.m2.1.1.cmml">θ</mi><mo id="S3.SS3.p2.8.m2.2.2.1.1.3" xref="S3.SS3.p2.8.m2.2.2.1.2.cmml">,</mo><msub id="S3.SS3.p2.8.m2.2.2.1.1.1" xref="S3.SS3.p2.8.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.8.m2.2.2.1.1.1.2" xref="S3.SS3.p2.8.m2.2.2.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p2.8.m2.2.2.1.1.1.3" xref="S3.SS3.p2.8.m2.2.2.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p2.8.m2.2.2.1.1.4" xref="S3.SS3.p2.8.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m2.2b"><apply id="S3.SS3.p2.8.m2.2.2.cmml" xref="S3.SS3.p2.8.m2.2.2"><times id="S3.SS3.p2.8.m2.2.2.2.cmml" xref="S3.SS3.p2.8.m2.2.2.2"></times><apply id="S3.SS3.p2.8.m2.2.2.3.cmml" xref="S3.SS3.p2.8.m2.2.2.3"><ci id="S3.SS3.p2.8.m2.2.2.3.1.cmml" xref="S3.SS3.p2.8.m2.2.2.3.1">~</ci><ci id="S3.SS3.p2.8.m2.2.2.3.2.cmml" xref="S3.SS3.p2.8.m2.2.2.3.2">𝐿</ci></apply><interval closure="open" id="S3.SS3.p2.8.m2.2.2.1.2.cmml" xref="S3.SS3.p2.8.m2.2.2.1.1"><ci id="S3.SS3.p2.8.m2.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1">𝜃</ci><apply id="S3.SS3.p2.8.m2.2.2.1.1.1.cmml" xref="S3.SS3.p2.8.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.8.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.8.m2.2.2.1.1.1.2">𝑙</ci><ci id="S3.SS3.p2.8.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.8.m2.2.2.1.1.1.3">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m2.2c">\tilde{L}(\theta,l_{m})</annotation></semantics></math> are fully differentiable so the above equation can be computed with back-propagation, allowing end-to-end training for the entire model. We use <math id="S3.SS3.p2.9.m3.1" class="ltx_Math" alttext="M=1" display="inline"><semantics id="S3.SS3.p2.9.m3.1a"><mrow id="S3.SS3.p2.9.m3.1.1" xref="S3.SS3.p2.9.m3.1.1.cmml"><mi id="S3.SS3.p2.9.m3.1.1.2" xref="S3.SS3.p2.9.m3.1.1.2.cmml">M</mi><mo id="S3.SS3.p2.9.m3.1.1.1" xref="S3.SS3.p2.9.m3.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.9.m3.1.1.3" xref="S3.SS3.p2.9.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m3.1b"><apply id="S3.SS3.p2.9.m3.1.1.cmml" xref="S3.SS3.p2.9.m3.1.1"><eq id="S3.SS3.p2.9.m3.1.1.1.cmml" xref="S3.SS3.p2.9.m3.1.1.1"></eq><ci id="S3.SS3.p2.9.m3.1.1.2.cmml" xref="S3.SS3.p2.9.m3.1.1.2">𝑀</ci><cn type="integer" id="S3.SS3.p2.9.m3.1.1.3.cmml" xref="S3.SS3.p2.9.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m3.1c">M=1</annotation></semantics></math> in our implementation.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.7" class="ltx_p">To reduce the variance of the estimated gradient, we introduce a simple baseline <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">b</annotation></semantics></math>, by replacing <math id="S3.SS3.p3.2.m2.2" class="ltx_Math" alttext="\tilde{L}(\theta,l_{m})" display="inline"><semantics id="S3.SS3.p3.2.m2.2a"><mrow id="S3.SS3.p3.2.m2.2.2" xref="S3.SS3.p3.2.m2.2.2.cmml"><mover accent="true" id="S3.SS3.p3.2.m2.2.2.3" xref="S3.SS3.p3.2.m2.2.2.3.cmml"><mi id="S3.SS3.p3.2.m2.2.2.3.2" xref="S3.SS3.p3.2.m2.2.2.3.2.cmml">L</mi><mo id="S3.SS3.p3.2.m2.2.2.3.1" xref="S3.SS3.p3.2.m2.2.2.3.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.cmml">​</mo><mrow id="S3.SS3.p3.2.m2.2.2.1.1" xref="S3.SS3.p3.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.2.2.1.1.2" xref="S3.SS3.p3.2.m2.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">θ</mi><mo id="S3.SS3.p3.2.m2.2.2.1.1.3" xref="S3.SS3.p3.2.m2.2.2.1.2.cmml">,</mo><msub id="S3.SS3.p3.2.m2.2.2.1.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.2.2.1.1.1.2" xref="S3.SS3.p3.2.m2.2.2.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p3.2.m2.2.2.1.1.1.3" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p3.2.m2.2.2.1.1.4" xref="S3.SS3.p3.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.2b"><apply id="S3.SS3.p3.2.m2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2"><times id="S3.SS3.p3.2.m2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2"></times><apply id="S3.SS3.p3.2.m2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.3"><ci id="S3.SS3.p3.2.m2.2.2.3.1.cmml" xref="S3.SS3.p3.2.m2.2.2.3.1">~</ci><ci id="S3.SS3.p3.2.m2.2.2.3.2.cmml" xref="S3.SS3.p3.2.m2.2.2.3.2">𝐿</ci></apply><interval closure="open" id="S3.SS3.p3.2.m2.2.2.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝜃</ci><apply id="S3.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.2">𝑙</ci><ci id="S3.SS3.p3.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.2c">\tilde{L}(\theta,l_{m})</annotation></semantics></math> with <math id="S3.SS3.p3.3.m3.2" class="ltx_Math" alttext="\tilde{L}(\theta,l_{m})-b" display="inline"><semantics id="S3.SS3.p3.3.m3.2a"><mrow id="S3.SS3.p3.3.m3.2.2" xref="S3.SS3.p3.3.m3.2.2.cmml"><mrow id="S3.SS3.p3.3.m3.2.2.1" xref="S3.SS3.p3.3.m3.2.2.1.cmml"><mover accent="true" id="S3.SS3.p3.3.m3.2.2.1.3" xref="S3.SS3.p3.3.m3.2.2.1.3.cmml"><mi id="S3.SS3.p3.3.m3.2.2.1.3.2" xref="S3.SS3.p3.3.m3.2.2.1.3.2.cmml">L</mi><mo id="S3.SS3.p3.3.m3.2.2.1.3.1" xref="S3.SS3.p3.3.m3.2.2.1.3.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.p3.3.m3.2.2.1.2" xref="S3.SS3.p3.3.m3.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p3.3.m3.2.2.1.1.1" xref="S3.SS3.p3.3.m3.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.2.2.1.1.1.2" xref="S3.SS3.p3.3.m3.2.2.1.1.2.cmml">(</mo><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">θ</mi><mo id="S3.SS3.p3.3.m3.2.2.1.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.1.2.cmml">,</mo><msub id="S3.SS3.p3.3.m3.2.2.1.1.1.1" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p3.3.m3.2.2.1.1.1.1.3" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p3.3.m3.2.2.1.1.1.4" xref="S3.SS3.p3.3.m3.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.3.m3.2.2.2" xref="S3.SS3.p3.3.m3.2.2.2.cmml">−</mo><mi id="S3.SS3.p3.3.m3.2.2.3" xref="S3.SS3.p3.3.m3.2.2.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.2b"><apply id="S3.SS3.p3.3.m3.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2"><minus id="S3.SS3.p3.3.m3.2.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2.2"></minus><apply id="S3.SS3.p3.3.m3.2.2.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1"><times id="S3.SS3.p3.3.m3.2.2.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.2"></times><apply id="S3.SS3.p3.3.m3.2.2.1.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.3"><ci id="S3.SS3.p3.3.m3.2.2.1.3.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.3.1">~</ci><ci id="S3.SS3.p3.3.m3.2.2.1.3.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.3.2">𝐿</ci></apply><interval closure="open" id="S3.SS3.p3.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝜃</ci><apply id="S3.SS3.p3.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.2">𝑙</ci><ci id="S3.SS3.p3.3.m3.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p3.3.m3.2.2.1.1.1.1.3">𝑚</ci></apply></interval></apply><ci id="S3.SS3.p3.3.m3.2.2.3.cmml" xref="S3.SS3.p3.3.m3.2.2.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.2c">\tilde{L}(\theta,l_{m})-b</annotation></semantics></math> in Eqn. <a href="#S3.E5" title="In 3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, where <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">b</annotation></semantics></math> is implemented as an exponential moving average over the recent loss <math id="S3.SS3.p3.5.m5.2" class="ltx_Math" alttext="\tilde{L}(\theta,l_{m})" display="inline"><semantics id="S3.SS3.p3.5.m5.2a"><mrow id="S3.SS3.p3.5.m5.2.2" xref="S3.SS3.p3.5.m5.2.2.cmml"><mover accent="true" id="S3.SS3.p3.5.m5.2.2.3" xref="S3.SS3.p3.5.m5.2.2.3.cmml"><mi id="S3.SS3.p3.5.m5.2.2.3.2" xref="S3.SS3.p3.5.m5.2.2.3.2.cmml">L</mi><mo id="S3.SS3.p3.5.m5.2.2.3.1" xref="S3.SS3.p3.5.m5.2.2.3.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.p3.5.m5.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.cmml">​</mo><mrow id="S3.SS3.p3.5.m5.2.2.1.1" xref="S3.SS3.p3.5.m5.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.5.m5.2.2.1.1.2" xref="S3.SS3.p3.5.m5.2.2.1.2.cmml">(</mo><mi id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">θ</mi><mo id="S3.SS3.p3.5.m5.2.2.1.1.3" xref="S3.SS3.p3.5.m5.2.2.1.2.cmml">,</mo><msub id="S3.SS3.p3.5.m5.2.2.1.1.1" xref="S3.SS3.p3.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.5.m5.2.2.1.1.1.2" xref="S3.SS3.p3.5.m5.2.2.1.1.1.2.cmml">l</mi><mi id="S3.SS3.p3.5.m5.2.2.1.1.1.3" xref="S3.SS3.p3.5.m5.2.2.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS3.p3.5.m5.2.2.1.1.4" xref="S3.SS3.p3.5.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.2b"><apply id="S3.SS3.p3.5.m5.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2"><times id="S3.SS3.p3.5.m5.2.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2"></times><apply id="S3.SS3.p3.5.m5.2.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.3"><ci id="S3.SS3.p3.5.m5.2.2.3.1.cmml" xref="S3.SS3.p3.5.m5.2.2.3.1">~</ci><ci id="S3.SS3.p3.5.m5.2.2.3.2.cmml" xref="S3.SS3.p3.5.m5.2.2.3.2">𝐿</ci></apply><interval closure="open" id="S3.SS3.p3.5.m5.2.2.1.2.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">𝜃</ci><apply id="S3.SS3.p3.5.m5.2.2.1.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1.1.2">𝑙</ci><ci id="S3.SS3.p3.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.5.m5.2.2.1.1.1.3">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.2c">\tilde{L}(\theta,l_{m})</annotation></semantics></math>. We also use an entropy regularization <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="\alpha=0.005" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><mrow id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml">α</mi><mo id="S3.SS3.p3.6.m6.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><eq id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1"></eq><ci id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2">𝛼</ci><cn type="float" id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">\alpha=0.005</annotation></semantics></math> over the policy <math id="S3.SS3.p3.7.m7.1" class="ltx_Math" alttext="p(l|q)" display="inline"><semantics id="S3.SS3.p3.7.m7.1a"><mrow id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.3" xref="S3.SS3.p3.7.m7.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.7.m7.1.1.2" xref="S3.SS3.p3.7.m7.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.7.m7.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m7.1.1.1.1.2" xref="S3.SS3.p3.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.7.m7.1.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.2" xref="S3.SS3.p3.7.m7.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS3.p3.7.m7.1.1.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.3" xref="S3.SS3.p3.7.m7.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.SS3.p3.7.m7.1.1.1.1.3" xref="S3.SS3.p3.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><apply id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1"><times id="S3.SS3.p3.7.m7.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2"></times><ci id="S3.SS3.p3.7.m7.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.3">𝑝</ci><apply id="S3.SS3.p3.7.m7.1.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">p(l|q)</annotation></semantics></math> to encourage exploration through the layout space.</p>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Behavioral cloning from expert polices.</h4>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p1.1" class="ltx_p">Optimizing the loss function in Eqn. <a href="#S3.E4" title="In 3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> from scratch is a challenging reinforcement learning problem: one needs to simultaneously learn the parameters in the sequence-to-sequence RNN to optimize the layout policy and textual attention weights to construct the textual features <math id="S3.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="x_{txt}^{(m)}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><msubsup id="S3.SS3.SSS0.Px1.p1.1.m1.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.2.cmml">x</mi><mrow id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.1a" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.4" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.4.cmml">t</mi></mrow><mrow id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.3.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.2">𝑥</ci><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3"><times id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.2">𝑡</ci><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.3">𝑥</ci><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.4.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.2.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">x_{txt}^{(m)}</annotation></semantics></math> for each module, and also the parameters in the neural modules. This is more challenging than a typical reinforcement learning scenario where one only needs to learn a policy.</p>
</div>
<div id="S3.SS3.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p2.9" class="ltx_p">On the other hand, the learning would be easier if we have some additional knowledge of module layout. While we do not want to restrict the layout search space to only a few candidates from the parser as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, we can treat these candidate layouts as an existing expert policy that can be used to provide additional supervision. More generally, if there is an expert policy <math id="S3.SS3.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="p_{e}(l|q)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.1.m1.1a"><mrow id="S3.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.2" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.2.cmml">p</mi><mi id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.3" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1"><times id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.2"></times><apply id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.2">𝑝</ci><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.3.3">𝑒</ci></apply><apply id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.1.m1.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.1.m1.1c">p_{e}(l|q)</annotation></semantics></math> that predicts a reasonable layout <math id="S3.SS3.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.2.m2.1a"><mi id="S3.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.2.m2.1b"><ci id="S3.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.2.m2.1c">l</annotation></semantics></math> from the question, we can first pre-train our model by behavioral cloning from <math id="S3.SS3.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.3.m3.1a"><msub id="S3.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml">p</mi><mi id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.2">𝑝</ci><ci id="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.3.m3.1c">p_{e}</annotation></semantics></math>. This can be done by minimizing the KL-divergence <math id="S3.SS3.SSS0.Px1.p2.4.m4.1" class="ltx_math_unparsed" alttext="D_{KL}(p_{e}||p)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.4.m4.1a"><mrow id="S3.SS3.SSS0.Px1.p2.4.m4.1b"><msub id="S3.SS3.SSS0.Px1.p2.4.m4.1.1"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.2">D</mi><mrow id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.3"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.3.2">K</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.3.1">​</mo><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.1.3.3">L</mi></mrow></msub><mrow id="S3.SS3.SSS0.Px1.p2.4.m4.1.2"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.4.m4.1.2.1">(</mo><msub id="S3.SS3.SSS0.Px1.p2.4.m4.1.2.2"><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.2.2.2">p</mi><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.2.2.3">e</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.SSS0.Px1.p2.4.m4.1.2.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS3.SSS0.Px1.p2.4.m4.1.2.4">|</mo><mi id="S3.SS3.SSS0.Px1.p2.4.m4.1.2.5">p</mi><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.4.m4.1.2.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.4.m4.1c">D_{KL}(p_{e}||p)</annotation></semantics></math> between the expert policy <math id="S3.SS3.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.5.m5.1a"><msub id="S3.SS3.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.2" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.2.cmml">p</mi><mi id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.3" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.2">𝑝</ci><ci id="S3.SS3.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.5.m5.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.5.m5.1c">p_{e}</annotation></semantics></math> and our layout policy <math id="S3.SS3.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.6.m6.1a"><mi id="S3.SS3.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.6.m6.1b"><ci id="S3.SS3.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.6.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.6.m6.1c">p</annotation></semantics></math>, and simultaneously minimizing the question answering loss <math id="S3.SS3.SSS0.Px1.p2.7.m7.4" class="ltx_Math" alttext="\tilde{L}(\theta,l;q,I)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.7.m7.4a"><mrow id="S3.SS3.SSS0.Px1.p2.7.m7.4.5" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.cmml"><mover accent="true" id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.cmml"><mi id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.2.cmml">L</mi><mo id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.1" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.1" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.1.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.2.1" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.1.cmml">(</mo><mi id="S3.SS3.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.1.cmml">θ</mi><mo id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.2.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.7.m7.2.2" xref="S3.SS3.SSS0.Px1.p2.7.m7.2.2.cmml">l</mi><mo id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.2.3" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.1.cmml">;</mo><mi id="S3.SS3.SSS0.Px1.p2.7.m7.3.3" xref="S3.SS3.SSS0.Px1.p2.7.m7.3.3.cmml">q</mi><mo id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.2.4" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.1.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p2.7.m7.4.4" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.4.cmml">I</mi><mo stretchy="false" id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.2.5" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.7.m7.4b"><apply id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5"><times id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.1"></times><apply id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2"><ci id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.1">~</ci><ci id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.2.2">𝐿</ci></apply><vector id="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.5.3.2"><ci id="S3.SS3.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.1.1">𝜃</ci><ci id="S3.SS3.SSS0.Px1.p2.7.m7.2.2.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.2.2">𝑙</ci><ci id="S3.SS3.SSS0.Px1.p2.7.m7.3.3.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.3.3">𝑞</ci><ci id="S3.SS3.SSS0.Px1.p2.7.m7.4.4.cmml" xref="S3.SS3.SSS0.Px1.p2.7.m7.4.4">𝐼</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.7.m7.4c">\tilde{L}(\theta,l;q,I)</annotation></semantics></math> with <math id="S3.SS3.SSS0.Px1.p2.8.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.8.m8.1a"><mi id="S3.SS3.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.8.m8.1b"><ci id="S3.SS3.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.8.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.8.m8.1c">l</annotation></semantics></math> obtained from <math id="S3.SS3.SSS0.Px1.p2.9.m9.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p2.9.m9.1a"><msub id="S3.SS3.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p2.9.m9.1.1.2" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1.2.cmml">p</mi><mi id="S3.SS3.SSS0.Px1.p2.9.m9.1.1.3" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p2.9.m9.1b"><apply id="S3.SS3.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p2.9.m9.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p2.9.m9.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1.2">𝑝</ci><ci id="S3.SS3.SSS0.Px1.p2.9.m9.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p2.9.m9.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p2.9.m9.1c">p_{e}</annotation></semantics></math>. This supervised behavioral cloning from the expert policy can provide a good set of initial parameters in our sequence-to-sequence RNN and each neural module. Note that the above behavioral cloning procedure is only done at training time to obtain a supervised initialization our model, and the expert policy is not used at test time.</p>
</div>
<div id="S3.SS3.SSS0.Px1.p3" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p3.4" class="ltx_p">The expert policy is not necessarily optimal, so behavioral cloning itself is not sufficient for learning the most suitable layout for each question. After learning a good initialization by cloning the expert policy, our model is further trained end-to-end with gradient <math id="S3.SS3.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="\nabla_{\theta}L" display="inline"><semantics id="S3.SS3.SSS0.Px1.p3.1.m1.1a"><mrow id="S3.SS3.SSS0.Px1.p3.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.cmml"><mo id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.2.cmml">∇</mo><mi id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.3.cmml">θ</mi></msub><mi id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.2.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p3.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1"><apply id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.2">∇</ci><ci id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.1.3">𝜃</ci></apply><ci id="S3.SS3.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p3.1.m1.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p3.1.m1.1c">\nabla_{\theta}L</annotation></semantics></math> computed using Eqn. <a href="#S3.E5" title="In 3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, where now the layout <math id="S3.SS3.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.SSS0.Px1.p3.2.m2.1a"><mi id="S3.SS3.SSS0.Px1.p3.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p3.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p3.2.m2.1b"><ci id="S3.SS3.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p3.2.m2.1c">l</annotation></semantics></math> is sampled from the layout policy <math id="S3.SS3.SSS0.Px1.p3.3.m3.1" class="ltx_Math" alttext="p(l|q)" display="inline"><semantics id="S3.SS3.SSS0.Px1.p3.3.m3.1a"><mrow id="S3.SS3.SSS0.Px1.p3.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.3" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.2" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.1" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.3" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p3.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1"><times id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.2"></times><ci id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.3">𝑝</ci><apply id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.2">𝑙</ci><ci id="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p3.3.m3.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p3.3.m3.1c">p(l|q)</annotation></semantics></math> in our model, and the expert policy <math id="S3.SS3.SSS0.Px1.p3.4.m4.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p3.4.m4.1a"><msub id="S3.SS3.SSS0.Px1.p3.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p3.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p3.4.m4.1.1.2" xref="S3.SS3.SSS0.Px1.p3.4.m4.1.1.2.cmml">p</mi><mi id="S3.SS3.SSS0.Px1.p3.4.m4.1.1.3" xref="S3.SS3.SSS0.Px1.p3.4.m4.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p3.4.m4.1b"><apply id="S3.SS3.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p3.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p3.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p3.4.m4.1.1.2">𝑝</ci><ci id="S3.SS3.SSS0.Px1.p3.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p3.4.m4.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p3.4.m4.1c">p_{e}</annotation></semantics></math> can be discarded.</p>
</div>
<div id="S3.SS3.SSS0.Px1.p4" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p4.1" class="ltx_p">We train our models using the Adam Optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> in all of our experiments. Our model is implemented using TensorFlow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and our code is available at <a target="_blank" href="http://ronghanghu.com/n2nmn/" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://ronghanghu.com/n2nmn/</a>.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We first analyze our model on a relatively small <span id="S4.p1.1.1" class="ltx_text ltx_font_smallcaps">shapes</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, and then apply our model to two large-scale datasets: <span id="S4.p1.1.2" class="ltx_text ltx_font_smallcaps">clevr</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and <span id="S4.p1.1.3" class="ltx_text ltx_font_smallcaps">vqa</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Analysis on the <span id="S4.SS1.1.1" class="ltx_text ltx_font_smallcaps">shapes</span> dataset</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_smallcaps">shapes</span> dataset for visual question answering (collected in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>) consists of 15616 image-question pairs with 244 unique questions. Each image consists of shapes of different colors and sizes aligned on a 3 by 3 grid. Despite its relatively small size, effective reasoning is needed to successfully answer questions like <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_italic">“is there a red triangle above a blue shape?”</span>. The dataset also provides a ground-truth parsing result for each question, which is used to train the NMN model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.3" class="ltx_p">We analyze our method on the <span id="S4.SS1.p2.3.1" class="ltx_text ltx_font_smallcaps">shapes</span> dataset under two settings.
In the first setting, we train our model using behavioral cloning from an expert layout policy as described in Sec. <a href="#S3.SS3" title="3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. An expert layout policy <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">p</mi><mi id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑝</ci><ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">p_{e}</annotation></semantics></math> is constructed by mapping the the ground-truth parsing for each question to a module layout in the same way as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Note that unlike <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, in this setting we only need to query the expert policy at training time. At test time, we obtain the layout <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">l</annotation></semantics></math> from the learned layout policy <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="p(l|q)" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">​</mo><mrow id="S4.SS1.p2.3.m3.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.3.m3.1.1.1.1.2" xref="S4.SS1.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.3.m3.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.2" xref="S4.SS1.p2.3.m3.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S4.SS1.p2.3.m3.1.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S4.SS1.p2.3.m3.1.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><times id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2"></times><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝑝</ci><apply id="S4.SS1.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.2">𝑙</ci><ci id="S4.SS1.p2.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">p(l|q)</annotation></semantics></math> in our model, while NMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> still needs to access the ground-truth parsing at test time.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.2" class="ltx_p">In the second setting, we train our model without using any expert policy, and directly perform policy optimization by minimizing the loss function <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="L(\theta)" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.2" xref="S4.SS1.p3.1.m1.1.2.cmml"><mi id="S4.SS1.p3.1.m1.1.2.2" xref="S4.SS1.p3.1.m1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.2.1" xref="S4.SS1.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.p3.1.m1.1.2.3.2" xref="S4.SS1.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.1.2.3.2.1" xref="S4.SS1.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S4.SS1.p3.1.m1.1.2.3.2.2" xref="S4.SS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.2"><times id="S4.SS1.p3.1.m1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.2.1"></times><ci id="S4.SS1.p3.1.m1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.2.2">𝐿</ci><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">L(\theta)</annotation></semantics></math> in Eqn. <a href="#S3.E4" title="In 3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> with gradient <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\nabla_{\theta}L" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><msub id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml"><mo id="S4.SS1.p3.2.m2.1.1.1.2" xref="S4.SS1.p3.2.m2.1.1.1.2.cmml">∇</mo><mi id="S4.SS1.p3.2.m2.1.1.1.3" xref="S4.SS1.p3.2.m2.1.1.1.3.cmml">θ</mi></msub><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><apply id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.1.2">∇</ci><ci id="S4.SS1.p3.2.m2.1.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.1.3">𝜃</ci></apply><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\nabla_{\theta}L</annotation></semantics></math> in Eqn. <a href="#S3.E5" title="In 3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. For both settings, we use a simple randomly initialized two-layer convolutional neural network to extract visual features from the image, trained together with other parts of our model.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.1.1" class="ltx_tr">
<th id="S4.T2.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</th>
<th id="S4.T2.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.2.1" class="ltx_tr">
<th id="S4.T2.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">NMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</th>
<td id="S4.T2.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t">  90.80%</td>
</tr>
<tr id="S4.T2.3.3.2" class="ltx_tr">
<th id="S4.T2.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ours - behavioral cloning from expert</th>
<td id="S4.T2.3.3.2.2" class="ltx_td ltx_align_center">100.00%</td>
</tr>
<tr id="S4.T2.3.4.3" class="ltx_tr">
<th id="S4.T2.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">ours - policy search from scratch</th>
<td id="S4.T2.3.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">  96.19%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance of our model on the <span id="S4.T2.5.1" class="ltx_text ltx_font_smallcaps">shapes</span> dataset. “ours - behavioral cloning from expert” corresponds to the supervised behavioral cloning from the expert policy <math id="S4.T2.2.m1.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S4.T2.2.m1.1b"><msub id="S4.T2.2.m1.1.1" xref="S4.T2.2.m1.1.1.cmml"><mi id="S4.T2.2.m1.1.1.2" xref="S4.T2.2.m1.1.1.2.cmml">p</mi><mi id="S4.T2.2.m1.1.1.3" xref="S4.T2.2.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.2.m1.1c"><apply id="S4.T2.2.m1.1.1.cmml" xref="S4.T2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.2.m1.1.1.1.cmml" xref="S4.T2.2.m1.1.1">subscript</csymbol><ci id="S4.T2.2.m1.1.1.2.cmml" xref="S4.T2.2.m1.1.1.2">𝑝</ci><ci id="S4.T2.2.m1.1.1.3.cmml" xref="S4.T2.2.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.m1.1d">p_{e}</annotation></semantics></math>, and “ours - policy search from scratch” is directly optimizing the layout policy without utilizing any expert policy.</figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/1704.05526/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="271" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Examples of layouts predicted by our model on the <span id="S4.F4.2.1" class="ltx_text ltx_font_smallcaps">shapes</span> dataset, under two training settings (Sec. <a href="#S4.SS1" title="4.1 Analysis on the shapes dataset ‣ 4 Experiments ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>).</figcaption>
</figure>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">The results are summarized in Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Analysis on the shapes dataset ‣ 4 Experiments ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. In the first setting, we find that our model (“ours - behavioral cloning from expert”) already achieves <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mn id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">100</mn><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">100\%</annotation></semantics></math> accuracy. While this shows that the expert policy constructed from ground-truth parsing is quite effective on this dataset, the higher performance of our model compared to the previous NMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> also suggests that our implementation of modules is more effective than <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, since the NMN is also trained with the same expert module layout obtained from the ground-truth parsing. In the second setting, our model achieves a good performance on this dataset by performing policy search from scratch without resorting to any expert policy. Figure <a href="#S4.F4" title="Figure 4 ‣ 4.1 Analysis on the shapes dataset ‣ 4 Experiments ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows some examples of predicted layouts and answers on this dataset.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1704.05526/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" width="104" height="138" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1704.05526/assets/x6.png" id="S4.F5.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="178" height="147" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Question answering examples on the <span id="S4.F5.5.1" class="ltx_text ltx_font_smallcaps">clevr</span> dataset. On the left, it
can be seen that the model successfully locates the matte green ball,
attends to all the other objects of the same size, and then correctly identifies
that there are 4 such objects (excluding the initial ball). On the right, it can
be seen the various modules similarly assume intuitive semantics.
Of particular interest is
the second <span id="S4.F5.6.2" class="ltx_text ltx_font_typewriter">find</span> module, which picks up the word <em id="S4.F5.7.3" class="ltx_emph ltx_font_italic">right</em> in addition
to <em id="S4.F5.8.4" class="ltx_emph ltx_font_italic">metallic red thing</em>: this suggests that model can use the fact that
downstream computation will look to the right of the detected object to focus
its initial search in the left half of the image, a behavior supported by our
attentive approach but not a conventional linguistic analysis of the question.</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluation on the <span id="S4.SS2.1.1" class="ltx_text ltx_font_smallcaps">clevr</span> dataset</h3>

<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1.1" class="ltx_td ltx_border_tt"></td>
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_border_tt"></td>
<td id="S4.T3.1.1.1.3" class="ltx_td ltx_border_tt"></td>
<td id="S4.T3.1.1.1.4" class="ltx_td ltx_border_tt"></td>
<td id="S4.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="3"><span id="S4.T3.1.1.1.5.1" class="ltx_text" style="font-size:80%;">Compare Integer</span></td>
<td id="S4.T3.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S4.T3.1.1.1.6.1" class="ltx_text" style="font-size:80%;">Query Attribute</span></td>
<td id="S4.T3.1.1.1.7" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S4.T3.1.1.1.7.1" class="ltx_text" style="font-size:80%;">Compare Attribute</span></td>
</tr>
<tr id="S4.T3.1.2.2" class="ltx_tr">
<td id="S4.T3.1.2.2.1" class="ltx_td ltx_align_left"><span id="S4.T3.1.2.2.1.1" class="ltx_text" style="font-size:80%;">Method</span></td>
<td id="S4.T3.1.2.2.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.2.2.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Overall</span></td>
<td id="S4.T3.1.2.2.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.2.2.3.1" class="ltx_text" style="font-size:80%;">Exist</span></td>
<td id="S4.T3.1.2.2.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.2.2.4.1" class="ltx_text" style="font-size:80%;">Count</span></td>
<td id="S4.T3.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.5.1" class="ltx_text" style="font-size:80%;">equal</span></td>
<td id="S4.T3.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.6.1" class="ltx_text" style="font-size:80%;">less</span></td>
<td id="S4.T3.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.7.1" class="ltx_text" style="font-size:80%;">more</span></td>
<td id="S4.T3.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.8.1" class="ltx_text" style="font-size:80%;">size</span></td>
<td id="S4.T3.1.2.2.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.9.1" class="ltx_text" style="font-size:80%;">color</span></td>
<td id="S4.T3.1.2.2.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.10.1" class="ltx_text" style="font-size:80%;">material</span></td>
<td id="S4.T3.1.2.2.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.11.1" class="ltx_text" style="font-size:80%;">shape</span></td>
<td id="S4.T3.1.2.2.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.12.1" class="ltx_text" style="font-size:80%;">size</span></td>
<td id="S4.T3.1.2.2.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.13.1" class="ltx_text" style="font-size:80%;">color</span></td>
<td id="S4.T3.1.2.2.14" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.14.1" class="ltx_text" style="font-size:80%;">material</span></td>
<td id="S4.T3.1.2.2.15" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.2.2.15.1" class="ltx_text" style="font-size:80%;">shape</span></td>
</tr>
<tr id="S4.T3.1.3.3" class="ltx_tr">
<td id="S4.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_border_t">
<span id="S4.T3.1.3.3.1.1" class="ltx_text" style="font-size:80%;">CNN+BoW </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.3.3.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib26" title="" class="ltx_ref">26</a><span id="S4.T3.1.3.3.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S4.T3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.2.1" class="ltx_text" style="font-size:80%;">48.4</span></td>
<td id="S4.T3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.3.1" class="ltx_text" style="font-size:80%;">59.5</span></td>
<td id="S4.T3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.4.1" class="ltx_text" style="font-size:80%;">38.9</span></td>
<td id="S4.T3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.5.1" class="ltx_text" style="font-size:80%;">50</span></td>
<td id="S4.T3.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.6.1" class="ltx_text" style="font-size:80%;">54</span></td>
<td id="S4.T3.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.7.1" class="ltx_text" style="font-size:80%;">49</span></td>
<td id="S4.T3.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.8.1" class="ltx_text" style="font-size:80%;">56</span></td>
<td id="S4.T3.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.9.1" class="ltx_text" style="font-size:80%;">32</span></td>
<td id="S4.T3.1.3.3.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.10.1" class="ltx_text" style="font-size:80%;">58</span></td>
<td id="S4.T3.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.11.1" class="ltx_text" style="font-size:80%;">47</span></td>
<td id="S4.T3.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.12.1" class="ltx_text" style="font-size:80%;">52</span></td>
<td id="S4.T3.1.3.3.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.13.1" class="ltx_text" style="font-size:80%;">52</span></td>
<td id="S4.T3.1.3.3.14" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.14.1" class="ltx_text" style="font-size:80%;">51</span></td>
<td id="S4.T3.1.3.3.15" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.3.3.15.1" class="ltx_text" style="font-size:80%;">52</span></td>
</tr>
<tr id="S4.T3.1.4.4" class="ltx_tr">
<td id="S4.T3.1.4.4.1" class="ltx_td ltx_align_left">
<span id="S4.T3.1.4.4.1.1" class="ltx_text" style="font-size:80%;">CNN+LSTM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.4.4.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S4.T3.1.4.4.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S4.T3.1.4.4.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.2.1" class="ltx_text" style="font-size:80%;">52.3</span></td>
<td id="S4.T3.1.4.4.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.3.1" class="ltx_text" style="font-size:80%;">65.2</span></td>
<td id="S4.T3.1.4.4.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.4.1" class="ltx_text" style="font-size:80%;">43.7</span></td>
<td id="S4.T3.1.4.4.5" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.5.1" class="ltx_text" style="font-size:80%;">57</span></td>
<td id="S4.T3.1.4.4.6" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.6.1" class="ltx_text" style="font-size:80%;">72</span></td>
<td id="S4.T3.1.4.4.7" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.7.1" class="ltx_text" style="font-size:80%;">69</span></td>
<td id="S4.T3.1.4.4.8" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.8.1" class="ltx_text" style="font-size:80%;">59</span></td>
<td id="S4.T3.1.4.4.9" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.9.1" class="ltx_text" style="font-size:80%;">32</span></td>
<td id="S4.T3.1.4.4.10" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.10.1" class="ltx_text" style="font-size:80%;">58</span></td>
<td id="S4.T3.1.4.4.11" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.11.1" class="ltx_text" style="font-size:80%;">48</span></td>
<td id="S4.T3.1.4.4.12" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.12.1" class="ltx_text" style="font-size:80%;">54</span></td>
<td id="S4.T3.1.4.4.13" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.13.1" class="ltx_text" style="font-size:80%;">54</span></td>
<td id="S4.T3.1.4.4.14" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.14.1" class="ltx_text" style="font-size:80%;">51</span></td>
<td id="S4.T3.1.4.4.15" class="ltx_td ltx_align_center"><span id="S4.T3.1.4.4.15.1" class="ltx_text" style="font-size:80%;">53</span></td>
</tr>
<tr id="S4.T3.1.5.5" class="ltx_tr">
<td id="S4.T3.1.5.5.1" class="ltx_td ltx_align_left">
<span id="S4.T3.1.5.5.1.1" class="ltx_text" style="font-size:80%;">CNN+LSTM+MCB </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.5.5.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib9" title="" class="ltx_ref">9</a><span id="S4.T3.1.5.5.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S4.T3.1.5.5.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.2.1" class="ltx_text" style="font-size:80%;">51.4</span></td>
<td id="S4.T3.1.5.5.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.3.1" class="ltx_text" style="font-size:80%;">63.4</span></td>
<td id="S4.T3.1.5.5.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.4.1" class="ltx_text" style="font-size:80%;">42.1</span></td>
<td id="S4.T3.1.5.5.5" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.5.1" class="ltx_text" style="font-size:80%;">57</span></td>
<td id="S4.T3.1.5.5.6" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.6.1" class="ltx_text" style="font-size:80%;">71</span></td>
<td id="S4.T3.1.5.5.7" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.7.1" class="ltx_text" style="font-size:80%;">68</span></td>
<td id="S4.T3.1.5.5.8" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.8.1" class="ltx_text" style="font-size:80%;">59</span></td>
<td id="S4.T3.1.5.5.9" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.9.1" class="ltx_text" style="font-size:80%;">32</span></td>
<td id="S4.T3.1.5.5.10" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.10.1" class="ltx_text" style="font-size:80%;">57</span></td>
<td id="S4.T3.1.5.5.11" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.11.1" class="ltx_text" style="font-size:80%;">48</span></td>
<td id="S4.T3.1.5.5.12" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.12.1" class="ltx_text" style="font-size:80%;">51</span></td>
<td id="S4.T3.1.5.5.13" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.13.1" class="ltx_text" style="font-size:80%;">52</span></td>
<td id="S4.T3.1.5.5.14" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.14.1" class="ltx_text" style="font-size:80%;">50</span></td>
<td id="S4.T3.1.5.5.15" class="ltx_td ltx_align_center"><span id="S4.T3.1.5.5.15.1" class="ltx_text" style="font-size:80%;">51</span></td>
</tr>
<tr id="S4.T3.1.6.6" class="ltx_tr">
<td id="S4.T3.1.6.6.1" class="ltx_td ltx_align_left">
<span id="S4.T3.1.6.6.1.1" class="ltx_text" style="font-size:80%;">CNN+LSTM+SA </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.6.6.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib25" title="" class="ltx_ref">25</a><span id="S4.T3.1.6.6.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S4.T3.1.6.6.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.2.1" class="ltx_text" style="font-size:80%;">68.5</span></td>
<td id="S4.T3.1.6.6.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.3.1" class="ltx_text" style="font-size:80%;">71.1</span></td>
<td id="S4.T3.1.6.6.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.4.1" class="ltx_text" style="font-size:80%;">52.2</span></td>
<td id="S4.T3.1.6.6.5" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.5.1" class="ltx_text" style="font-size:80%;">60</span></td>
<td id="S4.T3.1.6.6.6" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.6.1" class="ltx_text" style="font-size:80%;">82</span></td>
<td id="S4.T3.1.6.6.7" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.7.1" class="ltx_text" style="font-size:80%;">74</span></td>
<td id="S4.T3.1.6.6.8" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.8.1" class="ltx_text" style="font-size:80%;">87</span></td>
<td id="S4.T3.1.6.6.9" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.9.1" class="ltx_text" style="font-size:80%;">81</span></td>
<td id="S4.T3.1.6.6.10" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.10.1" class="ltx_text" style="font-size:80%;">88</span></td>
<td id="S4.T3.1.6.6.11" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.11.1" class="ltx_text" style="font-size:80%;">85</span></td>
<td id="S4.T3.1.6.6.12" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.12.1" class="ltx_text" style="font-size:80%;">52</span></td>
<td id="S4.T3.1.6.6.13" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.13.1" class="ltx_text" style="font-size:80%;">55</span></td>
<td id="S4.T3.1.6.6.14" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.14.1" class="ltx_text" style="font-size:80%;">51</span></td>
<td id="S4.T3.1.6.6.15" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.15.1" class="ltx_text" style="font-size:80%;">51</span></td>
</tr>
<tr id="S4.T3.1.7.7" class="ltx_tr">
<td id="S4.T3.1.7.7.1" class="ltx_td ltx_align_left ltx_border_t">
<span id="S4.T3.1.7.7.1.1" class="ltx_text" style="font-size:80%;">NMN (expert layout) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.1.7.7.1.2.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T3.1.7.7.1.3.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</td>
<td id="S4.T3.1.7.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.2.1" class="ltx_text" style="font-size:80%;">72.1</span></td>
<td id="S4.T3.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.3.1" class="ltx_text" style="font-size:80%;">79.3</span></td>
<td id="S4.T3.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.4.1" class="ltx_text" style="font-size:80%;">52.5</span></td>
<td id="S4.T3.1.7.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.5.1" class="ltx_text" style="font-size:80%;">61.2</span></td>
<td id="S4.T3.1.7.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.6.1" class="ltx_text" style="font-size:80%;">77.9</span></td>
<td id="S4.T3.1.7.7.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.7.1" class="ltx_text" style="font-size:80%;">75.2</span></td>
<td id="S4.T3.1.7.7.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.8.1" class="ltx_text" style="font-size:80%;">84.2</span></td>
<td id="S4.T3.1.7.7.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.9.1" class="ltx_text" style="font-size:80%;">68.9</span></td>
<td id="S4.T3.1.7.7.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.10.1" class="ltx_text" style="font-size:80%;">82.6</span></td>
<td id="S4.T3.1.7.7.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.11.1" class="ltx_text" style="font-size:80%;">80.2</span></td>
<td id="S4.T3.1.7.7.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.12.1" class="ltx_text" style="font-size:80%;">80.7</span></td>
<td id="S4.T3.1.7.7.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.13.1" class="ltx_text" style="font-size:80%;">74.4</span></td>
<td id="S4.T3.1.7.7.14" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.14.1" class="ltx_text" style="font-size:80%;">77.6</span></td>
<td id="S4.T3.1.7.7.15" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.7.7.15.1" class="ltx_text" style="font-size:80%;">79.3</span></td>
</tr>
<tr id="S4.T3.1.8.8" class="ltx_tr">
<td id="S4.T3.1.8.8.1" class="ltx_td ltx_align_left ltx_border_t">
<span id="S4.T3.1.8.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.8.8.1.1.1" class="ltx_p"><span id="S4.T3.1.8.8.1.1.1.1" class="ltx_text" style="font-size:80%;">ours - policy search from scratch</span></span>
</span>
</td>
<td id="S4.T3.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.2.1" class="ltx_text" style="font-size:80%;">69.0</span></td>
<td id="S4.T3.1.8.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.3.1" class="ltx_text" style="font-size:80%;">72.7</span></td>
<td id="S4.T3.1.8.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.4.1" class="ltx_text" style="font-size:80%;">55.1</span></td>
<td id="S4.T3.1.8.8.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.5.1" class="ltx_text" style="font-size:80%;">71.6</span></td>
<td id="S4.T3.1.8.8.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.6.1" class="ltx_text" style="font-size:80%;">85.1</span></td>
<td id="S4.T3.1.8.8.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.7.1" class="ltx_text" style="font-size:80%;">79.0</span></td>
<td id="S4.T3.1.8.8.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.8.1" class="ltx_text" style="font-size:80%;">88.1</span></td>
<td id="S4.T3.1.8.8.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.9.1" class="ltx_text" style="font-size:80%;">74.0</span></td>
<td id="S4.T3.1.8.8.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.10.1" class="ltx_text" style="font-size:80%;">86.6</span></td>
<td id="S4.T3.1.8.8.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.11.1" class="ltx_text" style="font-size:80%;">84.1</span></td>
<td id="S4.T3.1.8.8.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.12.1" class="ltx_text" style="font-size:80%;">50.1</span></td>
<td id="S4.T3.1.8.8.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.13.1" class="ltx_text" style="font-size:80%;">53.9</span></td>
<td id="S4.T3.1.8.8.14" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.14.1" class="ltx_text" style="font-size:80%;">48.6</span></td>
<td id="S4.T3.1.8.8.15" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.8.8.15.1" class="ltx_text" style="font-size:80%;">51.1</span></td>
</tr>
<tr id="S4.T3.1.9.9" class="ltx_tr">
<td id="S4.T3.1.9.9.1" class="ltx_td ltx_align_left"><span id="S4.T3.1.9.9.1.1" class="ltx_text" style="font-size:80%;">ours - cloning expert</span></td>
<td id="S4.T3.1.9.9.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.2.1" class="ltx_text" style="font-size:80%;">78.9</span></td>
<td id="S4.T3.1.9.9.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.3.1" class="ltx_text" style="font-size:80%;">83.3</span></td>
<td id="S4.T3.1.9.9.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.4.1" class="ltx_text" style="font-size:80%;">63.3</span></td>
<td id="S4.T3.1.9.9.5" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.5.1" class="ltx_text" style="font-size:80%;">68.2</span></td>
<td id="S4.T3.1.9.9.6" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.6.1" class="ltx_text" style="font-size:80%;">87.2</span></td>
<td id="S4.T3.1.9.9.7" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.7.1" class="ltx_text" style="font-size:80%;">85.4</span></td>
<td id="S4.T3.1.9.9.8" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.8.1" class="ltx_text" style="font-size:80%;">90.5</span></td>
<td id="S4.T3.1.9.9.9" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.9.1" class="ltx_text" style="font-size:80%;">80.2</span></td>
<td id="S4.T3.1.9.9.10" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.10.1" class="ltx_text" style="font-size:80%;">88.9</span></td>
<td id="S4.T3.1.9.9.11" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.11.1" class="ltx_text" style="font-size:80%;">88.3</span></td>
<td id="S4.T3.1.9.9.12" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.12.1" class="ltx_text" style="font-size:80%;">89.4</span></td>
<td id="S4.T3.1.9.9.13" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.13.1" class="ltx_text" style="font-size:80%;">52.5</span></td>
<td id="S4.T3.1.9.9.14" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.14.1" class="ltx_text" style="font-size:80%;">85.4</span></td>
<td id="S4.T3.1.9.9.15" class="ltx_td ltx_align_center"><span id="S4.T3.1.9.9.15.1" class="ltx_text" style="font-size:80%;">86.7</span></td>
</tr>
<tr id="S4.T3.1.10.10" class="ltx_tr">
<td id="S4.T3.1.10.10.1" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.T3.1.10.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.T3.1.10.10.1.1.1" class="ltx_p"><span id="S4.T3.1.10.10.1.1.1.1" class="ltx_text" style="font-size:80%;">ours - policy search      after cloning</span></span>
</span>
</td>
<td id="S4.T3.1.10.10.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">83.7</span></td>
<td id="S4.T3.1.10.10.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">85.7</span></td>
<td id="S4.T3.1.10.10.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">68.5</span></td>
<td id="S4.T3.1.10.10.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">73.8</span></td>
<td id="S4.T3.1.10.10.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">89.7</span></td>
<td id="S4.T3.1.10.10.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">87.7</span></td>
<td id="S4.T3.1.10.10.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">93.1</span></td>
<td id="S4.T3.1.10.10.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">84.8</span></td>
<td id="S4.T3.1.10.10.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.10.1" class="ltx_text ltx_font_bold" style="font-size:80%;">91.5</span></td>
<td id="S4.T3.1.10.10.11" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.11.1" class="ltx_text ltx_font_bold" style="font-size:80%;">90.6</span></td>
<td id="S4.T3.1.10.10.12" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.12.1" class="ltx_text ltx_font_bold" style="font-size:80%;">92.6</span></td>
<td id="S4.T3.1.10.10.13" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.13.1" class="ltx_text ltx_font_bold" style="font-size:80%;">82.8</span></td>
<td id="S4.T3.1.10.10.14" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.14.1" class="ltx_text ltx_font_bold" style="font-size:80%;">89.6</span></td>
<td id="S4.T3.1.10.10.15" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.1.10.10.15.1" class="ltx_text ltx_font_bold" style="font-size:80%;">90.0</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Evaluation of our method and previous work on <span id="S4.T3.6.1" class="ltx_text ltx_font_smallcaps">clevr</span> test set. With policy search after cloning, the accuracies are consistently improved on all questions types, with large improvement on some question types like compare color.</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure">
<p id="S4.F6.18" class="ltx_p ltx_align_center"><span id="S4.F6.18.18" class="ltx_text" style="font-size:90%;">question: <span id="S4.F6.18.18.18" class="ltx_text ltx_font_italic">do the small cylinder that is in front of the small green thing and the object right of the green cylinder have the same material?</span> 
<br class="ltx_break">ground-truth answer: <span id="S4.F6.18.18.19" class="ltx_text ltx_font_italic">no</span>

<span id="S4.F6.17.17.17" class="ltx_tabular ltx_align_middle">
<span class="ltx_tbody">
<span id="S4.F6.17.17.17.18.1" class="ltx_tr">
<span id="S4.F6.17.17.17.18.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.18.1.1.1" class="ltx_text" style="font-size:89%;">image</span></span>
<span id="S4.F6.17.17.17.18.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.18.1.2.1" class="ltx_text" style="font-size:89%;">layout</span></span>
<span id="S4.F6.17.17.17.18.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.18.1.3.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">find[0]</span></span>
<span id="S4.F6.17.17.17.18.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.18.1.4.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">relocate[1]</span></span>
<span id="S4.F6.17.17.17.18.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.18.1.5.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">filter[2]</span></span>
<span id="S4.F6.17.17.17.18.1.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.18.1.6.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">find[3]</span></span>
<span id="S4.F6.17.17.17.18.1.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.18.1.7.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">relocate[4]</span></span>
<span id="S4.F6.17.17.17.18.1.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.18.1.8.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">compare[5]</span></span>
<span id="S4.F6.17.17.17.18.1.9" class="ltx_td"></span></span>
<span id="S4.F6.8.8.8.8" class="ltx_tr">
<span id="S4.F6.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_after_RL/00000103_image.jpg" id="S4.F6.1.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.2.2.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/x7.png" id="S4.F6.2.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="51" height="38" alt="Refer to caption"></span>
<span id="S4.F6.3.3.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_before_RL/00000103_out_00.jpg" id="S4.F6.3.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.4.4.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_before_RL/00000103_out_01.jpg" id="S4.F6.4.4.4.4.4.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.5.5.5.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_before_RL/00000103_out_02.jpg" id="S4.F6.5.5.5.5.5.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.6.6.6.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_before_RL/00000103_out_03.jpg" id="S4.F6.6.6.6.6.6.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.7.7.7.7.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_before_RL/00000103_out_04.jpg" id="S4.F6.7.7.7.7.7.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.8.8.8.8.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/x8.png" id="S4.F6.8.8.8.8.8.g1" class="ltx_graphics ltx_img_landscape" width="46" height="35" alt="Refer to caption"></span>
<span id="S4.F6.8.8.8.8.9" class="ltx_td"></span></span>
<span id="S4.F6.17.17.17.19.2" class="ltx_tr">
<span id="S4.F6.17.17.17.19.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.1.1" class="ltx_ERROR undefined">\hdashline</span><span id="S4.F6.17.17.17.19.2.1.2" class="ltx_text" style="font-size:89%;">image</span></span>
<span id="S4.F6.17.17.17.19.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.2.1" class="ltx_text" style="font-size:89%;">layout</span></span>
<span id="S4.F6.17.17.17.19.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.3.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">find[0]</span></span>
<span id="S4.F6.17.17.17.19.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.4.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">relocate[1]</span></span>
<span id="S4.F6.17.17.17.19.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.5.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">filter[2]</span></span>
<span id="S4.F6.17.17.17.19.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.6.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">find[3]</span></span>
<span id="S4.F6.17.17.17.19.2.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.7.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">relocate[4]</span></span>
<span id="S4.F6.17.17.17.19.2.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.8.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">filter[5]</span></span>
<span id="S4.F6.17.17.17.19.2.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.19.2.9.1" class="ltx_text ltx_font_typewriter" style="font-size:89%;">compare[6]</span></span></span>
<span id="S4.F6.17.17.17.17" class="ltx_tr">
<span id="S4.F6.9.9.9.9.1" class="ltx_td ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_after_RL/00000103_image.jpg" id="S4.F6.9.9.9.9.1.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.10.10.10.10.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/x9.png" id="S4.F6.10.10.10.10.2.g1" class="ltx_graphics ltx_img_landscape" width="51" height="38" alt="Refer to caption"></span>
<span id="S4.F6.11.11.11.11.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_after_RL/00000103_out_00.jpg" id="S4.F6.11.11.11.11.3.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.12.12.12.12.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_after_RL/00000103_out_01.jpg" id="S4.F6.12.12.12.12.4.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.13.13.13.13.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_after_RL/00000103_out_02.jpg" id="S4.F6.13.13.13.13.5.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.14.14.14.14.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_after_RL/00000103_out_03.jpg" id="S4.F6.14.14.14.14.6.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.15.15.15.15.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_after_RL/00000103_out_04.jpg" id="S4.F6.15.15.15.15.7.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.16.16.16.16.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/figures/clevr/00000103_after_RL/00000103_out_05.jpg" id="S4.F6.16.16.16.16.8.g1" class="ltx_graphics ltx_img_landscape" width="72" height="48" alt="Refer to caption"></span>
<span id="S4.F6.17.17.17.17.9" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center"><img src="/html/1704.05526/assets/x10.png" id="S4.F6.17.17.17.17.9.g1" class="ltx_graphics ltx_img_landscape" width="46" height="35" alt="Refer to caption"></span></span>
<span id="S4.F6.17.17.17.20.3" class="ltx_tr">
<span id="S4.F6.17.17.17.20.3.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.F6.17.17.17.20.3.1.1" class="ltx_ERROR undefined">\hdashline</span></span>
<span id="S4.F6.17.17.17.20.3.2" class="ltx_td"></span>
<span id="S4.F6.17.17.17.20.3.3" class="ltx_td"></span>
<span id="S4.F6.17.17.17.20.3.4" class="ltx_td"></span>
<span id="S4.F6.17.17.17.20.3.5" class="ltx_td"></span>
<span id="S4.F6.17.17.17.20.3.6" class="ltx_td"></span>
<span id="S4.F6.17.17.17.20.3.7" class="ltx_td"></span>
<span id="S4.F6.17.17.17.20.3.8" class="ltx_td"></span>
<span id="S4.F6.17.17.17.20.3.9" class="ltx_td"></span></span>
</span>
</span>
<img src="/html/1704.05526/assets/x11.png" id="S4.F6.18.18.g1" class="ltx_graphics ltx_img_landscape" width="438" height="52" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>An example illustrating the layout change before (top row) and after (middle row) the second stage of end-to-end optimization with reinforcement learning. After end-to-end learning, a new <span id="S4.F6.25.1" class="ltx_text ltx_font_typewriter">filter</span> module is inserted by the layout policy to remove the attention over the non-object area before feeding it into the final <span id="S4.F6.26.2" class="ltx_text ltx_font_typewriter">compare</span> module, correcting the previous error.</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We evaluate our End-to-End Module Networks on the recently proposed <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">clevr</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> with 100,000 images and 853,554 questions. The images in this dataset are photo-realistic rendered images with objects of different shapes, colors, materials and sizes and possible occlusions, and the questions in this dataset are synthesized with functional programs. Compared to other datasets for visual question answering such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, the <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_smallcaps">clevr</span> dataset focuses mostly on the <span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_italic">reasoning</span> ability. The questions in the <span id="S4.SS2.p1.1.4" class="ltx_text ltx_font_smallcaps">clevr</span> dataset have much longer question length, and require handling long and complex inference chains to get an answer, such as <span id="S4.SS2.p1.1.5" class="ltx_text ltx_font_italic">“what size is the cylinder that is left of the brown metal thing that is left of the big sphere?”</span> and <span id="S4.SS2.p1.1.6" class="ltx_text ltx_font_italic">“there is an object in front of the blue thing; does it have the same shape as the tiny cyan thing that is to the right of the gray metal ball?”</span>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.7" class="ltx_p">In our experiment on this dataset, we resize each image to <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="480\times 320" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">480</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">320</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></times><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">480</cn><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">320</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">480\times 320</annotation></semantics></math>, and extract a <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="15\times 10" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">15</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">15</cn><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">15\times 10</annotation></semantics></math> convolutional feature map from each image by forwarding the image through the VGG-16 network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> trained on ImageNET classification, and take the 512-channel pool5 output. To help reason about spatial properties, we add two extra <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="x=\frac{i}{15}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">x</mi><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">=</mo><mfrac id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">i</mi><mn id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">15</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><eq id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></eq><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝑥</ci><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><divide id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3"></divide><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">15</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">x=\frac{i}{15}</annotation></semantics></math> and <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="y=\frac{j}{10}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">y</mi><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">=</mo><mfrac id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS2.p2.4.m4.1.1.3.2" xref="S4.SS2.p2.4.m4.1.1.3.2.cmml">j</mi><mn id="S4.SS2.p2.4.m4.1.1.3.3" xref="S4.SS2.p2.4.m4.1.1.3.3.cmml">10</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><eq id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></eq><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝑦</ci><apply id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><divide id="S4.SS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3"></divide><ci id="S4.SS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2">𝑗</ci><cn type="integer" id="S4.SS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">y=\frac{j}{10}</annotation></semantics></math> dimensions to each location <math id="S4.SS2.p2.5.m5.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S4.SS2.p2.5.m5.2a"><mrow id="S4.SS2.p2.5.m5.2.3.2" xref="S4.SS2.p2.5.m5.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.2.3.2.1" xref="S4.SS2.p2.5.m5.2.3.1.cmml">(</mo><mi id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">i</mi><mo id="S4.SS2.p2.5.m5.2.3.2.2" xref="S4.SS2.p2.5.m5.2.3.1.cmml">,</mo><mi id="S4.SS2.p2.5.m5.2.2" xref="S4.SS2.p2.5.m5.2.2.cmml">j</mi><mo stretchy="false" id="S4.SS2.p2.5.m5.2.3.2.3" xref="S4.SS2.p2.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.2b"><interval closure="open" id="S4.SS2.p2.5.m5.2.3.1.cmml" xref="S4.SS2.p2.5.m5.2.3.2"><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">𝑖</ci><ci id="S4.SS2.p2.5.m5.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.2c">(i,j)</annotation></semantics></math> on the feature map similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, so the final visual feature <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="x_{vis}" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><msub id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">x</mi><mrow id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml"><mi id="S4.SS2.p2.6.m6.1.1.3.2" xref="S4.SS2.p2.6.m6.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.3.1" xref="S4.SS2.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m6.1.1.3.3" xref="S4.SS2.p2.6.m6.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.3.1a" xref="S4.SS2.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m6.1.1.3.4" xref="S4.SS2.p2.6.m6.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">𝑥</ci><apply id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3"><times id="S4.SS2.p2.6.m6.1.1.3.1.cmml" xref="S4.SS2.p2.6.m6.1.1.3.1"></times><ci id="S4.SS2.p2.6.m6.1.1.3.2.cmml" xref="S4.SS2.p2.6.m6.1.1.3.2">𝑣</ci><ci id="S4.SS2.p2.6.m6.1.1.3.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3.3">𝑖</ci><ci id="S4.SS2.p2.6.m6.1.1.3.4.cmml" xref="S4.SS2.p2.6.m6.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">x_{vis}</annotation></semantics></math> on each image is a <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="15\times 10\times 514" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mrow id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mn id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">15</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.7.m7.1.1.1" xref="S4.SS2.p2.7.m7.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">10</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.7.m7.1.1.1a" xref="S4.SS2.p2.7.m7.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.7.m7.1.1.4" xref="S4.SS2.p2.7.m7.1.1.4.cmml">514</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><times id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1.1"></times><cn type="integer" id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">15</cn><cn type="integer" id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">10</cn><cn type="integer" id="S4.SS2.p2.7.m7.1.1.4.cmml" xref="S4.SS2.p2.7.m7.1.1.4">514</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">15\times 10\times 514</annotation></semantics></math> tensor. Each question word is embedded to a 300-dimensional vector initialized from scratch. We use a batch size of 64 during training.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p">In the first training stage, behavioral cloning is used with an expert layout policy as described in Sec. <a href="#S3.SS3" title="3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. We construct an expert layout policy <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">p</mi><mi id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝑝</ci><ci id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">p_{e}</annotation></semantics></math> that deterministically maps a question <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">q</annotation></semantics></math> into a layout <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="l_{e}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">l</mi><mi id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝑙</ci><ci id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">l_{e}</annotation></semantics></math> by converting the annotated functional programs in this dataset into a module layout with manually defined rules: first, the program chain is simplified to keep all intermediate computation in the image attention domain, and then each function type is mapped to a module in Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Attentional neural modules ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> that has the same number of inputs and closest potential behavior.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.9" class="ltx_p">While the manually specified expert policy <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">p</mi><mi id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝑝</ci><ci id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">p_{e}</annotation></semantics></math> obtained in this way might not be optimal, it is sufficient to provide supervision to learn good initial model parameters that can be further optimized in the later stage. During behavioral cloning, we train our model with two losses added together: the first loss is the KL-divergence <math id="S4.SS2.p4.2.m2.1" class="ltx_math_unparsed" alttext="D_{KL}(p_{e}||p)=-\log(p(l=l_{e}|q))" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1b"><msub id="S4.SS2.p4.2.m2.1.1"><mi id="S4.SS2.p4.2.m2.1.1.2">D</mi><mrow id="S4.SS2.p4.2.m2.1.1.3"><mi id="S4.SS2.p4.2.m2.1.1.3.2">K</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.2.m2.1.1.3.1">​</mo><mi id="S4.SS2.p4.2.m2.1.1.3.3">L</mi></mrow></msub><mrow id="S4.SS2.p4.2.m2.1.2"><mo stretchy="false" id="S4.SS2.p4.2.m2.1.2.1">(</mo><msub id="S4.SS2.p4.2.m2.1.2.2"><mi id="S4.SS2.p4.2.m2.1.2.2.2">p</mi><mi id="S4.SS2.p4.2.m2.1.2.2.3">e</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.p4.2.m2.1.2.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.p4.2.m2.1.2.4">|</mo><mi id="S4.SS2.p4.2.m2.1.2.5">p</mi><mo stretchy="false" id="S4.SS2.p4.2.m2.1.2.6">)</mo></mrow><mo rspace="0em" id="S4.SS2.p4.2.m2.1.3">=</mo><mo lspace="0em" id="S4.SS2.p4.2.m2.1.4">−</mo><mi id="S4.SS2.p4.2.m2.1.5">log</mi><mrow id="S4.SS2.p4.2.m2.1.6"><mo stretchy="false" id="S4.SS2.p4.2.m2.1.6.1">(</mo><mi id="S4.SS2.p4.2.m2.1.6.2">p</mi><mrow id="S4.SS2.p4.2.m2.1.6.3"><mo stretchy="false" id="S4.SS2.p4.2.m2.1.6.3.1">(</mo><mi id="S4.SS2.p4.2.m2.1.6.3.2">l</mi><mo id="S4.SS2.p4.2.m2.1.6.3.3">=</mo><msub id="S4.SS2.p4.2.m2.1.6.3.4"><mi id="S4.SS2.p4.2.m2.1.6.3.4.2">l</mi><mi id="S4.SS2.p4.2.m2.1.6.3.4.3">e</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.p4.2.m2.1.6.3.5">|</mo><mi id="S4.SS2.p4.2.m2.1.6.3.6">q</mi><mo stretchy="false" id="S4.SS2.p4.2.m2.1.6.3.7">)</mo></mrow><mo stretchy="false" id="S4.SS2.p4.2.m2.1.6.4">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">D_{KL}(p_{e}||p)=-\log(p(l=l_{e}|q))</annotation></semantics></math>, which corresponds to maximizing the probability of the expert layout <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="l_{e}" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><msub id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">l</mi><mi id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">𝑙</ci><ci id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">l_{e}</annotation></semantics></math> in our policy <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="p(l|q)" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">​</mo><mrow id="S4.SS2.p4.4.m4.1.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p4.4.m4.1.1.1.1.2" xref="S4.SS2.p4.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p4.4.m4.1.1.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.1.1.1.2" xref="S4.SS2.p4.4.m4.1.1.1.1.1.2.cmml">l</mi><mo fence="false" id="S4.SS2.p4.4.m4.1.1.1.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS2.p4.4.m4.1.1.1.1.1.3" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S4.SS2.p4.4.m4.1.1.1.1.3" xref="S4.SS2.p4.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><times id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2"></times><ci id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">𝑝</ci><apply id="S4.SS2.p4.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p4.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS2.p4.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.1.2">𝑙</ci><ci id="S4.SS2.p4.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">p(l|q)</annotation></semantics></math> from the sequence-to-sequence RNN, and the second loss is the question answering loss <math id="S4.SS2.p4.5.m5.4" class="ltx_Math" alttext="\tilde{L}(\theta,l_{e};q,I)" display="inline"><semantics id="S4.SS2.p4.5.m5.4a"><mrow id="S4.SS2.p4.5.m5.4.4" xref="S4.SS2.p4.5.m5.4.4.cmml"><mover accent="true" id="S4.SS2.p4.5.m5.4.4.3" xref="S4.SS2.p4.5.m5.4.4.3.cmml"><mi id="S4.SS2.p4.5.m5.4.4.3.2" xref="S4.SS2.p4.5.m5.4.4.3.2.cmml">L</mi><mo id="S4.SS2.p4.5.m5.4.4.3.1" xref="S4.SS2.p4.5.m5.4.4.3.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS2.p4.5.m5.4.4.2" xref="S4.SS2.p4.5.m5.4.4.2.cmml">​</mo><mrow id="S4.SS2.p4.5.m5.4.4.1.1" xref="S4.SS2.p4.5.m5.4.4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p4.5.m5.4.4.1.1.2" xref="S4.SS2.p4.5.m5.4.4.1.2.cmml">(</mo><mi id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml">θ</mi><mo id="S4.SS2.p4.5.m5.4.4.1.1.3" xref="S4.SS2.p4.5.m5.4.4.1.2.cmml">,</mo><msub id="S4.SS2.p4.5.m5.4.4.1.1.1" xref="S4.SS2.p4.5.m5.4.4.1.1.1.cmml"><mi id="S4.SS2.p4.5.m5.4.4.1.1.1.2" xref="S4.SS2.p4.5.m5.4.4.1.1.1.2.cmml">l</mi><mi id="S4.SS2.p4.5.m5.4.4.1.1.1.3" xref="S4.SS2.p4.5.m5.4.4.1.1.1.3.cmml">e</mi></msub><mo id="S4.SS2.p4.5.m5.4.4.1.1.4" xref="S4.SS2.p4.5.m5.4.4.1.2.cmml">;</mo><mi id="S4.SS2.p4.5.m5.2.2" xref="S4.SS2.p4.5.m5.2.2.cmml">q</mi><mo id="S4.SS2.p4.5.m5.4.4.1.1.5" xref="S4.SS2.p4.5.m5.4.4.1.2.cmml">,</mo><mi id="S4.SS2.p4.5.m5.3.3" xref="S4.SS2.p4.5.m5.3.3.cmml">I</mi><mo stretchy="false" id="S4.SS2.p4.5.m5.4.4.1.1.6" xref="S4.SS2.p4.5.m5.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.4b"><apply id="S4.SS2.p4.5.m5.4.4.cmml" xref="S4.SS2.p4.5.m5.4.4"><times id="S4.SS2.p4.5.m5.4.4.2.cmml" xref="S4.SS2.p4.5.m5.4.4.2"></times><apply id="S4.SS2.p4.5.m5.4.4.3.cmml" xref="S4.SS2.p4.5.m5.4.4.3"><ci id="S4.SS2.p4.5.m5.4.4.3.1.cmml" xref="S4.SS2.p4.5.m5.4.4.3.1">~</ci><ci id="S4.SS2.p4.5.m5.4.4.3.2.cmml" xref="S4.SS2.p4.5.m5.4.4.3.2">𝐿</ci></apply><vector id="S4.SS2.p4.5.m5.4.4.1.2.cmml" xref="S4.SS2.p4.5.m5.4.4.1.1"><ci id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">𝜃</ci><apply id="S4.SS2.p4.5.m5.4.4.1.1.1.cmml" xref="S4.SS2.p4.5.m5.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.5.m5.4.4.1.1.1.1.cmml" xref="S4.SS2.p4.5.m5.4.4.1.1.1">subscript</csymbol><ci id="S4.SS2.p4.5.m5.4.4.1.1.1.2.cmml" xref="S4.SS2.p4.5.m5.4.4.1.1.1.2">𝑙</ci><ci id="S4.SS2.p4.5.m5.4.4.1.1.1.3.cmml" xref="S4.SS2.p4.5.m5.4.4.1.1.1.3">𝑒</ci></apply><ci id="S4.SS2.p4.5.m5.2.2.cmml" xref="S4.SS2.p4.5.m5.2.2">𝑞</ci><ci id="S4.SS2.p4.5.m5.3.3.cmml" xref="S4.SS2.p4.5.m5.3.3">𝐼</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.4c">\tilde{L}(\theta,l_{e};q,I)</annotation></semantics></math> for question <math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mi id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><ci id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">q</annotation></semantics></math> and image <math id="S4.SS2.p4.7.m7.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS2.p4.7.m7.1a"><mi id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><ci id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">I</annotation></semantics></math>, where the layout <math id="S4.SS2.p4.8.m8.1" class="ltx_Math" alttext="l_{e}" display="inline"><semantics id="S4.SS2.p4.8.m8.1a"><msub id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml"><mi id="S4.SS2.p4.8.m8.1.1.2" xref="S4.SS2.p4.8.m8.1.1.2.cmml">l</mi><mi id="S4.SS2.p4.8.m8.1.1.3" xref="S4.SS2.p4.8.m8.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b"><apply id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p4.8.m8.1.1.2.cmml" xref="S4.SS2.p4.8.m8.1.1.2">𝑙</ci><ci id="S4.SS2.p4.8.m8.1.1.3.cmml" xref="S4.SS2.p4.8.m8.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">l_{e}</annotation></semantics></math> is obtained from the expert. Note that the second loss <math id="S4.SS2.p4.9.m9.4" class="ltx_Math" alttext="\tilde{L}(\theta,l_{e};q,I)" display="inline"><semantics id="S4.SS2.p4.9.m9.4a"><mrow id="S4.SS2.p4.9.m9.4.4" xref="S4.SS2.p4.9.m9.4.4.cmml"><mover accent="true" id="S4.SS2.p4.9.m9.4.4.3" xref="S4.SS2.p4.9.m9.4.4.3.cmml"><mi id="S4.SS2.p4.9.m9.4.4.3.2" xref="S4.SS2.p4.9.m9.4.4.3.2.cmml">L</mi><mo id="S4.SS2.p4.9.m9.4.4.3.1" xref="S4.SS2.p4.9.m9.4.4.3.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S4.SS2.p4.9.m9.4.4.2" xref="S4.SS2.p4.9.m9.4.4.2.cmml">​</mo><mrow id="S4.SS2.p4.9.m9.4.4.1.1" xref="S4.SS2.p4.9.m9.4.4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p4.9.m9.4.4.1.1.2" xref="S4.SS2.p4.9.m9.4.4.1.2.cmml">(</mo><mi id="S4.SS2.p4.9.m9.1.1" xref="S4.SS2.p4.9.m9.1.1.cmml">θ</mi><mo id="S4.SS2.p4.9.m9.4.4.1.1.3" xref="S4.SS2.p4.9.m9.4.4.1.2.cmml">,</mo><msub id="S4.SS2.p4.9.m9.4.4.1.1.1" xref="S4.SS2.p4.9.m9.4.4.1.1.1.cmml"><mi id="S4.SS2.p4.9.m9.4.4.1.1.1.2" xref="S4.SS2.p4.9.m9.4.4.1.1.1.2.cmml">l</mi><mi id="S4.SS2.p4.9.m9.4.4.1.1.1.3" xref="S4.SS2.p4.9.m9.4.4.1.1.1.3.cmml">e</mi></msub><mo id="S4.SS2.p4.9.m9.4.4.1.1.4" xref="S4.SS2.p4.9.m9.4.4.1.2.cmml">;</mo><mi id="S4.SS2.p4.9.m9.2.2" xref="S4.SS2.p4.9.m9.2.2.cmml">q</mi><mo id="S4.SS2.p4.9.m9.4.4.1.1.5" xref="S4.SS2.p4.9.m9.4.4.1.2.cmml">,</mo><mi id="S4.SS2.p4.9.m9.3.3" xref="S4.SS2.p4.9.m9.3.3.cmml">I</mi><mo stretchy="false" id="S4.SS2.p4.9.m9.4.4.1.1.6" xref="S4.SS2.p4.9.m9.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m9.4b"><apply id="S4.SS2.p4.9.m9.4.4.cmml" xref="S4.SS2.p4.9.m9.4.4"><times id="S4.SS2.p4.9.m9.4.4.2.cmml" xref="S4.SS2.p4.9.m9.4.4.2"></times><apply id="S4.SS2.p4.9.m9.4.4.3.cmml" xref="S4.SS2.p4.9.m9.4.4.3"><ci id="S4.SS2.p4.9.m9.4.4.3.1.cmml" xref="S4.SS2.p4.9.m9.4.4.3.1">~</ci><ci id="S4.SS2.p4.9.m9.4.4.3.2.cmml" xref="S4.SS2.p4.9.m9.4.4.3.2">𝐿</ci></apply><vector id="S4.SS2.p4.9.m9.4.4.1.2.cmml" xref="S4.SS2.p4.9.m9.4.4.1.1"><ci id="S4.SS2.p4.9.m9.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1">𝜃</ci><apply id="S4.SS2.p4.9.m9.4.4.1.1.1.cmml" xref="S4.SS2.p4.9.m9.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.9.m9.4.4.1.1.1.1.cmml" xref="S4.SS2.p4.9.m9.4.4.1.1.1">subscript</csymbol><ci id="S4.SS2.p4.9.m9.4.4.1.1.1.2.cmml" xref="S4.SS2.p4.9.m9.4.4.1.1.1.2">𝑙</ci><ci id="S4.SS2.p4.9.m9.4.4.1.1.1.3.cmml" xref="S4.SS2.p4.9.m9.4.4.1.1.1.3">𝑒</ci></apply><ci id="S4.SS2.p4.9.m9.2.2.cmml" xref="S4.SS2.p4.9.m9.2.2">𝑞</ci><ci id="S4.SS2.p4.9.m9.3.3.cmml" xref="S4.SS2.p4.9.m9.3.3">𝐼</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m9.4c">\tilde{L}(\theta,l_{e};q,I)</annotation></semantics></math> also affects the parameters in the sequence-to-sequence RNN through the textual attention in Eqn. <a href="#S3.E3" title="In 3.2 Layout policy with sequence-to-sequence RNN ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p">After the first training stage, we discard the expert policy and continue to train our model for a second stage with end-to-end reinforcement learning, using the gradient in Eqn. <a href="#S3.E5" title="In 3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. In this stage, the model is no longer constrained to get close to the expert, but is encouraged to explore the layout space and search for the optimal layout of each question.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.1" class="ltx_p">As a baseline, we also train our model without using any expert policy, and directly perform policy search from scratch by minimizing the loss function <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="L(\theta)" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><mrow id="S4.SS2.p6.1.m1.1.2" xref="S4.SS2.p6.1.m1.1.2.cmml"><mi id="S4.SS2.p6.1.m1.1.2.2" xref="S4.SS2.p6.1.m1.1.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p6.1.m1.1.2.1" xref="S4.SS2.p6.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p6.1.m1.1.2.3.2" xref="S4.SS2.p6.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p6.1.m1.1.2.3.2.1" xref="S4.SS2.p6.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S4.SS2.p6.1.m1.1.2.3.2.2" xref="S4.SS2.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.2"><times id="S4.SS2.p6.1.m1.1.2.1.cmml" xref="S4.SS2.p6.1.m1.1.2.1"></times><ci id="S4.SS2.p6.1.m1.1.2.2.cmml" xref="S4.SS2.p6.1.m1.1.2.2">𝐿</ci><ci id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">L(\theta)</annotation></semantics></math> in Eqn. <a href="#S3.E4" title="In 3.3 End-to-end training ‣ 3 End-to-End Module Networks ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S4.SS2.p7" class="ltx_para">
<p id="S4.SS2.p7.1" class="ltx_p">We evaluate our model on the test set of <span id="S4.SS2.p7.1.1" class="ltx_text ltx_font_smallcaps">clevr</span>. Table <a href="#S4.T3" title="Table 3 ‣ 4.2 Evaluation on the clevr dataset ‣ 4 Experiments ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the detailed performance of our model and previous methods on each question type, where “ours - policy search from scratch” is the baseline using pure reinforcement learning without resorting to the expert, “ours - cloning expert” is the supervised behavioral cloning from the constructed expert policy in the first stage, and “ours - policy search after cloning” is our model further trained for the second training stage. It can be seen that without using any expert demonstrations, our method with policy optimization from scratch already achieves higher performance than most previous work, and our model trained in the first behavioral cloning stage outperforms the previous approaches by a large margin in overall accuracy. This indicates that our neural modules are capable of reasoning for complex questions in the dataset like <span id="S4.SS2.p7.1.2" class="ltx_text ltx_font_italic">“does the block that is to the right of the big cyan sphere have the same material as the large blue thing?”</span> Our model also outperforms the NMN baseline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> trained on the same expert layout as used in our model<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The question parsing in the original NMN implementation does not work on the <span id="footnote1.1" class="ltx_text ltx_font_smallcaps">clevr</span> dataset, as confirmed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. For fair comparison with NMN, we train NMN using the same expert layout as our model.</span></span></span>. This shows that our soft attention module parameterization is better than the hard-coded textual parameters in NMN. Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Analysis on the shapes dataset ‣ 4 Experiments ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows some question answering examples with our model.</p>
</div>
<div id="S4.SS2.p8" class="ltx_para">
<p id="S4.SS2.p8.1" class="ltx_p">By comparing “ours - policy search after cloning” with “ours - cloning expert” in Table <a href="#S4.T3" title="Table 3 ‣ 4.2 Evaluation on the clevr dataset ‣ 4 Experiments ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, it can be seen that the performance consistently improves after end-to-end training with policy search using reinforcement learning in the second training stage, with especially large improvement on the <span id="S4.SS2.p8.1.1" class="ltx_text ltx_font_italic">compare color</span> type of questions, indicating that the original expert policy is not optimal, and we can improve upon it with policy search over the entire layout space. Figure <a href="#S4.F6" title="Figure 6 ‣ 4.2 Evaluation on the clevr dataset ‣ 4 Experiments ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows an example before and after end-to-end optimization.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Evaluation on the <span id="S5.1.1" class="ltx_text ltx_font_smallcaps">vqa</span> dataset</h2>

<figure id="S5.F7" class="ltx_figure"><img src="" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>An example from our model on the <span id="S5.F7.2.1" class="ltx_text ltx_font_smallcaps">vqa</span> dataset.</figcaption>
</figure>
<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We also evaluate our method on the <span id="S5.p1.1.1" class="ltx_text ltx_font_smallcaps">vqa</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> with real images. On the <span id="S5.p1.1.2" class="ltx_text ltx_font_smallcaps">vqa</span> dataset, although there are no underlying functional program annotation for the questions, we can still construct an expert layout policy using a syntactic parse of questions as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and train our model in the same way as in Sec. <a href="#S4.SS2" title="4.2 Evaluation on the clevr dataset ‣ 4 Experiments ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. We train our model using different visual features for fair comparison with other methods. Unlike previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, the syntactic parser is only used during the training stage and is not needed at test time.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.1.1.1" class="ltx_tr">
<th id="S5.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S5.T4.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<th id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T4.1.1.1.2.1" class="ltx_text" style="font-size:90%;">Visual feature</span></th>
<th id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T4.1.1.1.3.1" class="ltx_text" style="font-size:90%;">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.1.2.1" class="ltx_tr">
<th id="S5.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S5.T4.1.2.1.1.1" class="ltx_text" style="font-size:90%;">NMN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T4.1.2.1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S5.T4.1.2.1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S5.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.2.1.2.1" class="ltx_text" style="font-size:90%;">LRCN VGG-16</span></td>
<td id="S5.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.2.1.3.1" class="ltx_text" style="font-size:90%;">57.3</span></td>
</tr>
<tr id="S5.T4.1.3.2" class="ltx_tr">
<th id="S5.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S5.T4.1.3.2.1.1" class="ltx_text" style="font-size:90%;">D-NMN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T4.1.3.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S5.T4.1.3.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S5.T4.1.3.2.2" class="ltx_td ltx_align_center"><span id="S5.T4.1.3.2.2.1" class="ltx_text" style="font-size:90%;">LRCN VGG-16</span></td>
<td id="S5.T4.1.3.2.3" class="ltx_td ltx_align_center"><span id="S5.T4.1.3.2.3.1" class="ltx_text" style="font-size:90%;">57.9</span></td>
</tr>
<tr id="S5.T4.1.4.3" class="ltx_tr">
<th id="S5.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S5.T4.1.4.3.1.1" class="ltx_text" style="font-size:90%;">MCB </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T4.1.4.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib9" title="" class="ltx_ref">9</a><span id="S5.T4.1.4.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S5.T4.1.4.3.2" class="ltx_td ltx_align_center"><span id="S5.T4.1.4.3.2.1" class="ltx_text" style="font-size:90%;">ResNet-152</span></td>
<td id="S5.T4.1.4.3.3" class="ltx_td ltx_align_center"><span id="S5.T4.1.4.3.3.1" class="ltx_text" style="font-size:90%;">64.7</span></td>
</tr>
<tr id="S5.T4.1.5.4" class="ltx_tr">
<th id="S5.T4.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T4.1.5.4.1.1" class="ltx_text" style="font-size:90%;">ours - cloning expert</span></th>
<td id="S5.T4.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.5.4.2.1" class="ltx_text" style="font-size:90%;">LRCN VGG-16</span></td>
<td id="S5.T4.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.5.4.3.1" class="ltx_text" style="font-size:90%;">61.9</span></td>
</tr>
<tr id="S5.T4.1.6.5" class="ltx_tr">
<th id="S5.T4.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T4.1.6.5.1.1" class="ltx_text" style="font-size:90%;">ours - cloning expert</span></th>
<td id="S5.T4.1.6.5.2" class="ltx_td ltx_align_center"><span id="S5.T4.1.6.5.2.1" class="ltx_text" style="font-size:90%;">ResNet-152</span></td>
<td id="S5.T4.1.6.5.3" class="ltx_td ltx_align_center"><span id="S5.T4.1.6.5.3.1" class="ltx_text" style="font-size:90%;">64.2</span></td>
</tr>
<tr id="S5.T4.1.7.6" class="ltx_tr">
<th id="S5.T4.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S5.T4.1.7.6.1.1" class="ltx_text" style="font-size:90%;">ours - policy search after cloning</span></th>
<td id="S5.T4.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.1.7.6.2.1" class="ltx_text" style="font-size:90%;">ResNet-152</span></td>
<td id="S5.T4.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.1.7.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">64.9</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>Evaluation of our method on the <span id="S5.T4.6.1" class="ltx_text ltx_font_smallcaps">vqa</span> test-dev set. Our model outperforms previous work NMN and D-NMN and achieves comparable performance as MCB.</figcaption>
</figure>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">The results are summarized in Table <a href="#S5.T4" title="Table 4 ‣ 5 Evaluation on the vqa dataset ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> on the <span id="S5.p2.1.1" class="ltx_text ltx_font_smallcaps">vqa</span> dataset, where our method significantly outperforms NMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and D-NMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> that also use modular structures, using the same LRCN VGG-16 image features (VGG-16 network fine-tuned for image captioning, as used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>). Compared with MCB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> (the VQA 2016 challenge winner method) trained on the same ResNet-152 image features, our model achieves slightly higher performance while being more interpretable as one can explicitly see the underlying reasoning procedure. Figure <a href="#S5.F7" title="Figure 7 ‣ 5 Evaluation on the vqa dataset ‣ Learning to Reason: End-to-End Module Networks for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows a prediction example on this dataset.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we present the End-to-End Module Networks for visual question answering. Our model uses a set of neural modules to break down complex reasoning problems posed in textual questions into a few sub-tasks connected together, and learns to predict a suitable layout expression for each question using a layout policy implemented with a sequence-to-sequence RNN. During training, the model can be first trained with behavioral cloning from an expert layout policy, and further optimized end-to-end using reinforcement learning. Experimental results demonstrate that our model is capable of handling complicated reasoning problems, and the end-to-end optimization of the neural modules and layout policy can lead to significant further improvement over behavioral cloning from expert layouts.</p>
</div>
<div id="S6.p2" class="ltx_para ltx_noindent">
<p id="S6.p2.1" class="ltx_p"><span id="S6.p2.1.1" class="ltx_text ltx_font_bold">Acknowledgements.</span>
This work was supported by DARPA, AFRL, DoD MURI award N000141110688, NSF awards IIS-1427425, IIS-1212798 and IIS-1212928, NGA and the Berkeley Artificial Intelligence Research (BAIR) Lab. Jacob Andreas is supported by a Facebook graduate fellowship and a Huawei / Berkeley AI fellowship.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
M. Abadi, A. Agarwal, P. Barham, E. Brevdo, Z. Chen, C. Citro, G. S. Corrado,
A. Davis, J. Dean, M. Devin, S. Ghemawat, I. Goodfellow, A. Harp, G. Irving,
M. Isard, Y. Jia, R. Jozefowicz, L. Kaiser, M. Kudlur, J. Levenberg,
D. Mané, R. Monga, S. Moore, D. Murray, C. Olah, M. Schuster, J. Shlens,
B. Steiner, I. Sutskever, K. Talwar, P. Tucker, V. Vanhoucke, V. Vasudevan,
F. Viégas, O. Vinyals, P. Warden, M. Wattenberg, M. Wicke, Y. Yu, and
X. Zheng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">TensorFlow: Large-scale machine learning on heterogeneous systems.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1603.04467</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
J. Andreas, M. Rohrbach, T. Darrell, and D. Klein.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Learning to compose neural networks for question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the Conference of the North American Chapter
of the Association for Computational Linguistics (NAACL)</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
J. Andreas, M. Rohrbach, T. Darrell, and D. Klein.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Neural module networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. L. Zitnick, and
D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Vqa: Visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision (ICCV)</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
D. Bahdanau, K. Cho, and Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Neural machine translation by jointly learning to align and
translate.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the International Conference on Learning
Representations (ICLR)</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
J. Bergstra, D. Yamins, and D. D. Cox.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Making a science of model search: Hyperparameter optimization in
hundreds of dimensions for vision architectures.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML (1)</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">, 28:115–123, 2013.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
A. W. Burks, D. W. Warren, and J. B. Wright.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">An analysis of a logical machine using parenthesis-free notation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Mathematical tables and other aids to computation</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">,
8(46):53–57, 1954.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
D. Floreano, P. Dürr, and C. Mattiussi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Neuroevolution: from architectures to learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Evolutionary Intelligence</span><span id="bib.bib8.4.2" class="ltx_text" style="font-size:90%;">, 1(1):47–62, 2008.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
A. Fukui, D. H. Park, D. Yang, A. Rohrbach, T. Darrell, and M. Rohrbach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Multimodal compact bilinear pooling for visual question answering and
visual grounding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the Conference on Empirical Methods in Natural
Language Processing (EMNLP)</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Y. Goyal, T. Khot, D. Summers-Stay, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Making the V in VQA matter: Elevating the role of image
understanding in Visual Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, abs/1612.00837, 2016.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
K. He, X. Zhang, S. Ren, and J. Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
R. Hu, M. Rohrbach, J. Andreas, T. Darrell, and K. Saenko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Modeling relationships in referential expressions with compositional
modular networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
R. Hu, M. Rohrbach, and T. Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Segmentation from natural language expressions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
A. Jabri, A. Joulin, and L. van der Maaten.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Revisiting visual question answering baselines.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European Conference on Computer Vision</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, pages 727–739.
Springer, 2016.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
J. Johnson, B. Hariharan, L. van der Maaten, L. Fei-Fei, C. L. Zitnick, and
R. Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Clevr: A diagnostic dataset for compositional language and elementary
visual reasoning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
J. Johnson, B. Hariharan, L. van der Maaten, J. Hoffman, L. Fei-Fei, C. L.
Zitnick, and R. Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Inferring and executing programs for visual reasoning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer
Vision (ICCV)</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
D. Kingma and J. Ba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the International Conference on Learning
Representations (ICLR)</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
J. Lu, J. Yang, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Hierarchical Co-Attention for Visual Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems (NIPS)</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">,
2016.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski and M. Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">A multi-world approach to question answering about real-world scenes
based on uncertain input.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems (NIPS)</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">,
2014.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
H. Noh, P. H. Seo, and B. Han.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Image question answering using convolutional neural network with
dynamic parameter prediction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
K. Simonyan and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the International Conference on Learning
Representations (ICLR)</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
R. Socher, A. Perelygin, J. Y. Wu, J. Chuang, C. D. Manning, A. Y. Ng,
C. Potts, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Recursive deep models for semantic compositionality over a sentiment
treebank.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the conference on empirical methods in natural
language processing (EMNLP)</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, volume 1631, page 1642. Citeseer, 2013.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
D. Wierstra, F. J. Gomez, and J. Schmidhuber.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Modeling systems with internal state using evolino.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 7th annual conference on Genetic and
evolutionary computation</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, pages 1795–1802. ACM, 2005.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
C. Xiong, S. Merity, and R. Socher.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Dynamic memory networks for visual and textual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the International Conference on Machine
Learning (ICML)</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Z. Yang, X. He, J. Gao, L. Deng, and A. Smola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Stacked attention networks for image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
B. Zhou, Y. Tian, S. Sukhbaatar, A. Szlam, and R. Fergus.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Simple baseline for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
M. Zhu, Y. Zhang, W. Chen, M. Zhang, and J. Zhu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Fast and accurate shift-reduce constituent parsing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACL (1)</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, pages 434–443, 2013.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
B. Zoph and Q. V. Le.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Neural architecture search with reinforcement learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the International Conference on Learning
Representations (ICLR)</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1704.05525" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1704.05526" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1704.05526">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1704.05526" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1704.05527" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Feb 26 19:24:27 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
