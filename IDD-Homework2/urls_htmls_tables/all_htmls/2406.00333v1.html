<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation</title>
<!--Generated on Sat Jun  1 07:16:08 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Sequential recommendation,  Large language model,  Supervised fine-tuning,  Practice-friendly" lang="en" name="keywords"/>
<base href="/html/2406.00333v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S1" title="In A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S2" title="In A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S3" title="In A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S4" title="In A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>The Proposed Framework</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S4.SS1" title="In 4. The Proposed Framework ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Information Reconstruction Stage</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S4.SS2" title="In 4. The Proposed Framework ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Information Augmentation Stage</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5" title="In A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.SS1" title="In 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experiment Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.SS2" title="In 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>RQ1: Performance Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.SS3" title="In 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>RQ2: Efficiency Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.SS4" title="In 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>RQ3: In-depth Analysis of TSLRec</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S6" title="In A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dugang Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Guangdong Laboratory of Artificial Intelligence and Digital Economy (SZ)</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:dugang.ldg@gmail.com">dugang.ldg@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shenxian Xian
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">CSSE, Shenzhen University</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xianshenxian2022@email.szu.edu.cn">xianshenxian2022@email.szu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaolin Lin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">CSSE, Shenzhen University</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:linxiaolin2021@email.szu.edu.cn">linxiaolin2021@email.szu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaolian Zhang
</span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hong Zhu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Huawei Technologies Co Ltd</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhangxiaolian,zhuhong8@huawei.com">zhangxiaolian,zhuhong8@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuan Fang
</span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhen Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Huawei Technologies Co Ltd</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:frank.fy,zzz.chen@huawei.com">frank.fy,zzz.chen@huawei.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhong Ming
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Shenzhen Technology University</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:mingz@szu.edu.cn">mingz@szu.edu.cn</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id19.id1">The training paradigm integrating large language models (LLM) is gradually reshaping sequential recommender systems (SRS) and has shown promising results. However, most existing LLM-enhanced methods rely on rich textual information on the item side and instance-level supervised fine-tuning (SFT) to inject collaborative information into LLM, which is inefficient and limited in many applications. To alleviate these problems, this paper proposes a novel practice-friendly two-stage LLM-enhanced paradigm (TSLRec) for SRS. Specifically, in the information reconstruction stage, we design a new user-level SFT task for collaborative information injection with the assistance of a pre-trained SRS model, which is more efficient and compatible with limited text information. We aim to let LLM try to infer the latent category of each item and reconstruct the corresponding user’s preference distribution for all categories from the user’s interaction sequence. In the information augmentation stage, we feed each item into LLM to obtain a set of enhanced embeddings that combine collaborative information and LLM inference capabilities. These embeddings can then be used to help train various future SRS models. Finally, we verify the effectiveness and efficiency of our TSLRec on three SRS benchmark datasets.</p>
</div>
<div class="ltx_keywords">Sequential recommendation, Large language model, Supervised fine-tuning, Practice-friendly
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Sequential recommender systems (SRS), which leverage historical interaction sequences to predict each user’s next most likely item of interest <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib2" title="">2021</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib21" title="">2019</a>; Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib17" title="">2024</a>)</cite>, are core components in many industrial platforms.
A critical step in SRS is learning user preferences from interaction sequences better.
Previous studies have developed many technical routes for this purpose, the most representative of which include those based on recurrent neural networks (RNN) <cite class="ltx_cite ltx_citemacro_citep">(Donkers et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib4" title="">2017</a>; Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib10" title="">2016</a>; Quadrana et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib19" title="">2017</a>)</cite>, convolutional neural networks (CNN) <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib22" title="">2018</a>; Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib27" title="">2019</a>; Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib25" title="">2019</a>)</cite>, self-attention <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib13" title="">2018</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib9" title="">2021</a>)</cite>, and multi-layer perceptron (MLP) <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib32" title="">2022</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib15" title="">2023c</a>; Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib6" title="">2024</a>)</cite>.
Recently, with the rapid development of large language models (LLM), the research of combining LLM with traditional SRS models to reshape the training paradigm has received increasing attention <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib30" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Existing LLM-enhanced SRS methods can be classified into three main categories: text information encoding-based, supervised fine-tuning (SFT) task-based, and structure distillation-based methods.
The first line focuses on leveraging the rich textual information on the item side as a bridge to connect the LLM and SRS models and then introduces various enhanced information embeddings encoded by LLM into the SRS model to improve recommendations <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib23" title="">2024</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib26" title="">2024</a>; Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib7" title="">2024</a>)</cite>.
The second line aims to design different SFT tasks to inject the collaborative information required for recommendation into LLM, thus endowing it with the ability to act as a recommender for SRS <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib16" title="">2023a</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib31" title="">2024</a>)</cite>.
The third line uses knowledge distillation to establish information alignment or transfer between LLM and SRS models at different layers, enhancing the SRS model’s capabilities <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib14" title="">2023b</a>; Qiao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib18" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">However, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, the success of most existing LLM-enhanced methods is too dependent on rich item-related textual information and instance-level SFT tasks, which makes them inefficient and limited in many applications.
On the one hand, some scenarios may lack textual information related to items.
On the other hand, the number of interaction instances in industrial scenarios is usually very large, resulting in an excessively high and unacceptable LLM inference overhead for SFT.
To alleviate these problems, this paper proposes a novel practice-friendly two-stage LLM-enhanced paradigm (TSLRec) for SRS.
The core idea of our TSLRec is to introduce a new SFT task aimed at reconstructing users’ preference distribution over all item latent categories.
This reduces the reliance on textual information and the overhead of LLM from instance to user level.
Finally, extensive experiments are conducted on three public SRS benchmark datasets to answer the following questions: 1) How does our TSLRec perform compared to the baselines? 2) How does our TSLRec perform in terms of efficiency? 3) What is the gain of LLM for SRS in our TSLRec?
</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="312" id="S1.F1.g1" src="x1.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>An illustration of a typical LLM-enhanced SRS model training architecture.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Sequential recommender systems (SRS) aim to capture user preferences from their historical interaction sequences and then use them to predict each user’s next interaction item accurately.
As some of the most representative backbone models, FPMC <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib20" title="">2010</a>)</cite>, GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib10" title="">2016</a>)</cite>, Caser <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib22" title="">2018</a>)</cite>, SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib13" title="">2018</a>)</cite>, and FMLP-Rec <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib32" title="">2022</a>)</cite> adopt the form of Markov chain, recurrent neural network, convolutional neural network, self-attention, and multi-layer perception, respectively, to model the process of capturing user preferences.
Then, many follow-up works have been developed based on them to improve the effectiveness of this process further <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib3" title="">2022</a>; Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib5" title="">2023</a>)</cite>.
Recently, the great success of LLM in different tasks has attracted many efforts to apply LLM to SRS <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib23" title="">2024</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib16" title="">2023a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib14" title="">b</a>)</cite>.
However, most have limited applicability due to their instance-level SFT tasks and reliance on textual information.
Our TSLRec aims to provide a new LLM-enhanced paradigm for SRS to achieve a better trade-off between performance and efficiency.
</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Problem Formulation</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.9">In this section, we first define sequential recommendation with some necessary notations.
We denote the sets of users and items as <math alttext="\mathcal{U}=\{u_{1},u_{2},\cdots,u_{M}\}" class="ltx_Math" display="inline" id="S3.p1.1.m1.4"><semantics id="S3.p1.1.m1.4a"><mrow id="S3.p1.1.m1.4.4" xref="S3.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.4.4.5" xref="S3.p1.1.m1.4.4.5.cmml">𝒰</mi><mo id="S3.p1.1.m1.4.4.4" xref="S3.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.p1.1.m1.4.4.3.3" xref="S3.p1.1.m1.4.4.3.4.cmml"><mo id="S3.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S3.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.p1.1.m1.2.2.1.1.1" xref="S3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.p1.1.m1.2.2.1.1.1.2" xref="S3.p1.1.m1.2.2.1.1.1.2.cmml">u</mi><mn id="S3.p1.1.m1.2.2.1.1.1.3" xref="S3.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.1.m1.4.4.3.3.5" xref="S3.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.p1.1.m1.3.3.2.2.2" xref="S3.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.p1.1.m1.3.3.2.2.2.2" xref="S3.p1.1.m1.3.3.2.2.2.2.cmml">u</mi><mn id="S3.p1.1.m1.3.3.2.2.2.3" xref="S3.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.p1.1.m1.4.4.3.3.6" xref="S3.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.p1.1.m1.1.1" mathvariant="normal" xref="S3.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.p1.1.m1.4.4.3.3.7" xref="S3.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.p1.1.m1.4.4.3.3.3" xref="S3.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.p1.1.m1.4.4.3.3.3.2" xref="S3.p1.1.m1.4.4.3.3.3.2.cmml">u</mi><mi id="S3.p1.1.m1.4.4.3.3.3.3" xref="S3.p1.1.m1.4.4.3.3.3.3.cmml">M</mi></msub><mo id="S3.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S3.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.4b"><apply id="S3.p1.1.m1.4.4.cmml" xref="S3.p1.1.m1.4.4"><eq id="S3.p1.1.m1.4.4.4.cmml" xref="S3.p1.1.m1.4.4.4"></eq><ci id="S3.p1.1.m1.4.4.5.cmml" xref="S3.p1.1.m1.4.4.5">𝒰</ci><set id="S3.p1.1.m1.4.4.3.4.cmml" xref="S3.p1.1.m1.4.4.3.3"><apply id="S3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.p1.1.m1.2.2.1.1.1.2">𝑢</ci><cn id="S3.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.p1.1.m1.3.3.2.2.2.2">𝑢</ci><cn id="S3.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">⋯</ci><apply id="S3.p1.1.m1.4.4.3.3.3.cmml" xref="S3.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.p1.1.m1.4.4.3.3.3.2">𝑢</ci><ci id="S3.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.p1.1.m1.4.4.3.3.3.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.4c">\mathcal{U}=\{u_{1},u_{2},\cdots,u_{M}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.4d">caligraphic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_u start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="\mathcal{V}=\left\{v_{1},v_{2},\cdots,v_{N}\right\}" class="ltx_Math" display="inline" id="S3.p1.2.m2.4"><semantics id="S3.p1.2.m2.4a"><mrow id="S3.p1.2.m2.4.4" xref="S3.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.4.4.5" xref="S3.p1.2.m2.4.4.5.cmml">𝒱</mi><mo id="S3.p1.2.m2.4.4.4" xref="S3.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.p1.2.m2.4.4.3.3" xref="S3.p1.2.m2.4.4.3.4.cmml"><mo id="S3.p1.2.m2.4.4.3.3.4" xref="S3.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.p1.2.m2.2.2.1.1.1" xref="S3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.1.2" xref="S3.p1.2.m2.2.2.1.1.1.2.cmml">v</mi><mn id="S3.p1.2.m2.2.2.1.1.1.3" xref="S3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.2.m2.4.4.3.3.5" xref="S3.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.p1.2.m2.3.3.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.p1.2.m2.3.3.2.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.2.cmml">v</mi><mn id="S3.p1.2.m2.3.3.2.2.2.3" xref="S3.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.p1.2.m2.4.4.3.3.6" xref="S3.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.p1.2.m2.1.1" mathvariant="normal" xref="S3.p1.2.m2.1.1.cmml">⋯</mi><mo id="S3.p1.2.m2.4.4.3.3.7" xref="S3.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.p1.2.m2.4.4.3.3.3" xref="S3.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.p1.2.m2.4.4.3.3.3.2" xref="S3.p1.2.m2.4.4.3.3.3.2.cmml">v</mi><mi id="S3.p1.2.m2.4.4.3.3.3.3" xref="S3.p1.2.m2.4.4.3.3.3.3.cmml">N</mi></msub><mo id="S3.p1.2.m2.4.4.3.3.8" xref="S3.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.4b"><apply id="S3.p1.2.m2.4.4.cmml" xref="S3.p1.2.m2.4.4"><eq id="S3.p1.2.m2.4.4.4.cmml" xref="S3.p1.2.m2.4.4.4"></eq><ci id="S3.p1.2.m2.4.4.5.cmml" xref="S3.p1.2.m2.4.4.5">𝒱</ci><set id="S3.p1.2.m2.4.4.3.4.cmml" xref="S3.p1.2.m2.4.4.3.3"><apply id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.1.2">𝑣</ci><cn id="S3.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2.2">𝑣</ci><cn id="S3.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">⋯</ci><apply id="S3.p1.2.m2.4.4.3.3.3.cmml" xref="S3.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.p1.2.m2.4.4.3.3.3.2">𝑣</ci><ci id="S3.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.p1.2.m2.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.4c">\mathcal{V}=\left\{v_{1},v_{2},\cdots,v_{N}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.4d">caligraphic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }</annotation></semantics></math>, respectively, where <math alttext="M" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_M</annotation></semantics></math> and <math alttext="N" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_N</annotation></semantics></math> represent the number of users and the number of items, respectively.
Each user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">u</mi><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><in id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></in><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝑢</ci><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_u ∈ caligraphic_U</annotation></semantics></math> has an associated a sequence of historical interactions <math alttext="\mathcal{S}^{u}=\left\{v^{u}_{1},v^{u}_{2},\cdots,v^{u}_{t},\cdots,v^{u}_{|%
\mathcal{S}^{u}|}\right\}" class="ltx_Math" display="inline" id="S3.p1.6.m6.7"><semantics id="S3.p1.6.m6.7a"><mrow id="S3.p1.6.m6.7.7" xref="S3.p1.6.m6.7.7.cmml"><msup id="S3.p1.6.m6.7.7.6" xref="S3.p1.6.m6.7.7.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.7.7.6.2" xref="S3.p1.6.m6.7.7.6.2.cmml">𝒮</mi><mi id="S3.p1.6.m6.7.7.6.3" xref="S3.p1.6.m6.7.7.6.3.cmml">u</mi></msup><mo id="S3.p1.6.m6.7.7.5" xref="S3.p1.6.m6.7.7.5.cmml">=</mo><mrow id="S3.p1.6.m6.7.7.4.4" xref="S3.p1.6.m6.7.7.4.5.cmml"><mo id="S3.p1.6.m6.7.7.4.4.5" xref="S3.p1.6.m6.7.7.4.5.cmml">{</mo><msubsup id="S3.p1.6.m6.4.4.1.1.1" xref="S3.p1.6.m6.4.4.1.1.1.cmml"><mi id="S3.p1.6.m6.4.4.1.1.1.2.2" xref="S3.p1.6.m6.4.4.1.1.1.2.2.cmml">v</mi><mn id="S3.p1.6.m6.4.4.1.1.1.3" xref="S3.p1.6.m6.4.4.1.1.1.3.cmml">1</mn><mi id="S3.p1.6.m6.4.4.1.1.1.2.3" xref="S3.p1.6.m6.4.4.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.p1.6.m6.7.7.4.4.6" xref="S3.p1.6.m6.7.7.4.5.cmml">,</mo><msubsup id="S3.p1.6.m6.5.5.2.2.2" xref="S3.p1.6.m6.5.5.2.2.2.cmml"><mi id="S3.p1.6.m6.5.5.2.2.2.2.2" xref="S3.p1.6.m6.5.5.2.2.2.2.2.cmml">v</mi><mn id="S3.p1.6.m6.5.5.2.2.2.3" xref="S3.p1.6.m6.5.5.2.2.2.3.cmml">2</mn><mi id="S3.p1.6.m6.5.5.2.2.2.2.3" xref="S3.p1.6.m6.5.5.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S3.p1.6.m6.7.7.4.4.7" xref="S3.p1.6.m6.7.7.4.5.cmml">,</mo><mi id="S3.p1.6.m6.2.2" mathvariant="normal" xref="S3.p1.6.m6.2.2.cmml">⋯</mi><mo id="S3.p1.6.m6.7.7.4.4.8" xref="S3.p1.6.m6.7.7.4.5.cmml">,</mo><msubsup id="S3.p1.6.m6.6.6.3.3.3" xref="S3.p1.6.m6.6.6.3.3.3.cmml"><mi id="S3.p1.6.m6.6.6.3.3.3.2.2" xref="S3.p1.6.m6.6.6.3.3.3.2.2.cmml">v</mi><mi id="S3.p1.6.m6.6.6.3.3.3.3" xref="S3.p1.6.m6.6.6.3.3.3.3.cmml">t</mi><mi id="S3.p1.6.m6.6.6.3.3.3.2.3" xref="S3.p1.6.m6.6.6.3.3.3.2.3.cmml">u</mi></msubsup><mo id="S3.p1.6.m6.7.7.4.4.9" xref="S3.p1.6.m6.7.7.4.5.cmml">,</mo><mi id="S3.p1.6.m6.3.3" mathvariant="normal" xref="S3.p1.6.m6.3.3.cmml">⋯</mi><mo id="S3.p1.6.m6.7.7.4.4.10" xref="S3.p1.6.m6.7.7.4.5.cmml">,</mo><msubsup id="S3.p1.6.m6.7.7.4.4.4" xref="S3.p1.6.m6.7.7.4.4.4.cmml"><mi id="S3.p1.6.m6.7.7.4.4.4.2.2" xref="S3.p1.6.m6.7.7.4.4.4.2.2.cmml">v</mi><mrow id="S3.p1.6.m6.1.1.1.1" xref="S3.p1.6.m6.1.1.1.2.cmml"><mo id="S3.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S3.p1.6.m6.1.1.1.2.1.cmml">|</mo><msup id="S3.p1.6.m6.1.1.1.1.1" xref="S3.p1.6.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.1.1.1.1.1.2" xref="S3.p1.6.m6.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.p1.6.m6.1.1.1.1.1.3" xref="S3.p1.6.m6.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S3.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S3.p1.6.m6.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.p1.6.m6.7.7.4.4.4.2.3" xref="S3.p1.6.m6.7.7.4.4.4.2.3.cmml">u</mi></msubsup><mo id="S3.p1.6.m6.7.7.4.4.11" xref="S3.p1.6.m6.7.7.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.7b"><apply id="S3.p1.6.m6.7.7.cmml" xref="S3.p1.6.m6.7.7"><eq id="S3.p1.6.m6.7.7.5.cmml" xref="S3.p1.6.m6.7.7.5"></eq><apply id="S3.p1.6.m6.7.7.6.cmml" xref="S3.p1.6.m6.7.7.6"><csymbol cd="ambiguous" id="S3.p1.6.m6.7.7.6.1.cmml" xref="S3.p1.6.m6.7.7.6">superscript</csymbol><ci id="S3.p1.6.m6.7.7.6.2.cmml" xref="S3.p1.6.m6.7.7.6.2">𝒮</ci><ci id="S3.p1.6.m6.7.7.6.3.cmml" xref="S3.p1.6.m6.7.7.6.3">𝑢</ci></apply><set id="S3.p1.6.m6.7.7.4.5.cmml" xref="S3.p1.6.m6.7.7.4.4"><apply id="S3.p1.6.m6.4.4.1.1.1.cmml" xref="S3.p1.6.m6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.4.4.1.1.1.1.cmml" xref="S3.p1.6.m6.4.4.1.1.1">subscript</csymbol><apply id="S3.p1.6.m6.4.4.1.1.1.2.cmml" xref="S3.p1.6.m6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.4.4.1.1.1.2.1.cmml" xref="S3.p1.6.m6.4.4.1.1.1">superscript</csymbol><ci id="S3.p1.6.m6.4.4.1.1.1.2.2.cmml" xref="S3.p1.6.m6.4.4.1.1.1.2.2">𝑣</ci><ci id="S3.p1.6.m6.4.4.1.1.1.2.3.cmml" xref="S3.p1.6.m6.4.4.1.1.1.2.3">𝑢</ci></apply><cn id="S3.p1.6.m6.4.4.1.1.1.3.cmml" type="integer" xref="S3.p1.6.m6.4.4.1.1.1.3">1</cn></apply><apply id="S3.p1.6.m6.5.5.2.2.2.cmml" xref="S3.p1.6.m6.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.5.5.2.2.2.1.cmml" xref="S3.p1.6.m6.5.5.2.2.2">subscript</csymbol><apply id="S3.p1.6.m6.5.5.2.2.2.2.cmml" xref="S3.p1.6.m6.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.5.5.2.2.2.2.1.cmml" xref="S3.p1.6.m6.5.5.2.2.2">superscript</csymbol><ci id="S3.p1.6.m6.5.5.2.2.2.2.2.cmml" xref="S3.p1.6.m6.5.5.2.2.2.2.2">𝑣</ci><ci id="S3.p1.6.m6.5.5.2.2.2.2.3.cmml" xref="S3.p1.6.m6.5.5.2.2.2.2.3">𝑢</ci></apply><cn id="S3.p1.6.m6.5.5.2.2.2.3.cmml" type="integer" xref="S3.p1.6.m6.5.5.2.2.2.3">2</cn></apply><ci id="S3.p1.6.m6.2.2.cmml" xref="S3.p1.6.m6.2.2">⋯</ci><apply id="S3.p1.6.m6.6.6.3.3.3.cmml" xref="S3.p1.6.m6.6.6.3.3.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.6.6.3.3.3.1.cmml" xref="S3.p1.6.m6.6.6.3.3.3">subscript</csymbol><apply id="S3.p1.6.m6.6.6.3.3.3.2.cmml" xref="S3.p1.6.m6.6.6.3.3.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.6.6.3.3.3.2.1.cmml" xref="S3.p1.6.m6.6.6.3.3.3">superscript</csymbol><ci id="S3.p1.6.m6.6.6.3.3.3.2.2.cmml" xref="S3.p1.6.m6.6.6.3.3.3.2.2">𝑣</ci><ci id="S3.p1.6.m6.6.6.3.3.3.2.3.cmml" xref="S3.p1.6.m6.6.6.3.3.3.2.3">𝑢</ci></apply><ci id="S3.p1.6.m6.6.6.3.3.3.3.cmml" xref="S3.p1.6.m6.6.6.3.3.3.3">𝑡</ci></apply><ci id="S3.p1.6.m6.3.3.cmml" xref="S3.p1.6.m6.3.3">⋯</ci><apply id="S3.p1.6.m6.7.7.4.4.4.cmml" xref="S3.p1.6.m6.7.7.4.4.4"><csymbol cd="ambiguous" id="S3.p1.6.m6.7.7.4.4.4.1.cmml" xref="S3.p1.6.m6.7.7.4.4.4">subscript</csymbol><apply id="S3.p1.6.m6.7.7.4.4.4.2.cmml" xref="S3.p1.6.m6.7.7.4.4.4"><csymbol cd="ambiguous" id="S3.p1.6.m6.7.7.4.4.4.2.1.cmml" xref="S3.p1.6.m6.7.7.4.4.4">superscript</csymbol><ci id="S3.p1.6.m6.7.7.4.4.4.2.2.cmml" xref="S3.p1.6.m6.7.7.4.4.4.2.2">𝑣</ci><ci id="S3.p1.6.m6.7.7.4.4.4.2.3.cmml" xref="S3.p1.6.m6.7.7.4.4.4.2.3">𝑢</ci></apply><apply id="S3.p1.6.m6.1.1.1.2.cmml" xref="S3.p1.6.m6.1.1.1.1"><abs id="S3.p1.6.m6.1.1.1.2.1.cmml" xref="S3.p1.6.m6.1.1.1.1.2"></abs><apply id="S3.p1.6.m6.1.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1">superscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.p1.6.m6.1.1.1.1.1.2">𝒮</ci><ci id="S3.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.p1.6.m6.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.7c">\mathcal{S}^{u}=\left\{v^{u}_{1},v^{u}_{2},\cdots,v^{u}_{t},\cdots,v^{u}_{|%
\mathcal{S}^{u}|}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.7d">caligraphic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = { italic_v start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT | caligraphic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="\mathcal{S}^{u}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><msup id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">𝒮</mi><mi id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">superscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝒮</ci><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\mathcal{S}^{u}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">caligraphic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> is arranged by time, where <math alttext="v^{u}_{t}\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.p1.8.m8.1"><semantics id="S3.p1.8.m8.1a"><mrow id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><msubsup id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml"><mi id="S3.p1.8.m8.1.1.2.2.2" xref="S3.p1.8.m8.1.1.2.2.2.cmml">v</mi><mi id="S3.p1.8.m8.1.1.2.3" xref="S3.p1.8.m8.1.1.2.3.cmml">t</mi><mi id="S3.p1.8.m8.1.1.2.2.3" xref="S3.p1.8.m8.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S3.p1.8.m8.1.1.1" xref="S3.p1.8.m8.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><in id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1"></in><apply id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.2.1.cmml" xref="S3.p1.8.m8.1.1.2">subscript</csymbol><apply id="S3.p1.8.m8.1.1.2.2.cmml" xref="S3.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.2.2.1.cmml" xref="S3.p1.8.m8.1.1.2">superscript</csymbol><ci id="S3.p1.8.m8.1.1.2.2.2.cmml" xref="S3.p1.8.m8.1.1.2.2.2">𝑣</ci><ci id="S3.p1.8.m8.1.1.2.2.3.cmml" xref="S3.p1.8.m8.1.1.2.2.3">𝑢</ci></apply><ci id="S3.p1.8.m8.1.1.2.3.cmml" xref="S3.p1.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">v^{u}_{t}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.1d">italic_v start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_V</annotation></semantics></math> denotes the item that the user interacts with at step <math alttext="t" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">italic_t</annotation></semantics></math>.
We then can formalize the sequential recommendation task.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.p2.1.1">Input</span>: The set of historical interaction sequences for all users, i.e., <math alttext="\mathcal{S}=\left\{\mathcal{S}^{u_{1}},\mathcal{S}^{u_{2}},\cdots,\mathcal{S}^%
{u_{M}}\right\}" class="ltx_Math" display="inline" id="S3.p2.1.m1.4"><semantics id="S3.p2.1.m1.4a"><mrow id="S3.p2.1.m1.4.4" xref="S3.p2.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.4.4.5" xref="S3.p2.1.m1.4.4.5.cmml">𝒮</mi><mo id="S3.p2.1.m1.4.4.4" xref="S3.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.p2.1.m1.4.4.3.3" xref="S3.p2.1.m1.4.4.3.4.cmml"><mo id="S3.p2.1.m1.4.4.3.3.4" xref="S3.p2.1.m1.4.4.3.4.cmml">{</mo><msup id="S3.p2.1.m1.2.2.1.1.1" xref="S3.p2.1.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.2.2.1.1.1.2" xref="S3.p2.1.m1.2.2.1.1.1.2.cmml">𝒮</mi><msub id="S3.p2.1.m1.2.2.1.1.1.3" xref="S3.p2.1.m1.2.2.1.1.1.3.cmml"><mi id="S3.p2.1.m1.2.2.1.1.1.3.2" xref="S3.p2.1.m1.2.2.1.1.1.3.2.cmml">u</mi><mn id="S3.p2.1.m1.2.2.1.1.1.3.3" xref="S3.p2.1.m1.2.2.1.1.1.3.3.cmml">1</mn></msub></msup><mo id="S3.p2.1.m1.4.4.3.3.5" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><msup id="S3.p2.1.m1.3.3.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.3.3.2.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.2.cmml">𝒮</mi><msub id="S3.p2.1.m1.3.3.2.2.2.3" xref="S3.p2.1.m1.3.3.2.2.2.3.cmml"><mi id="S3.p2.1.m1.3.3.2.2.2.3.2" xref="S3.p2.1.m1.3.3.2.2.2.3.2.cmml">u</mi><mn id="S3.p2.1.m1.3.3.2.2.2.3.3" xref="S3.p2.1.m1.3.3.2.2.2.3.3.cmml">2</mn></msub></msup><mo id="S3.p2.1.m1.4.4.3.3.6" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.p2.1.m1.1.1" mathvariant="normal" xref="S3.p2.1.m1.1.1.cmml">⋯</mi><mo id="S3.p2.1.m1.4.4.3.3.7" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><msup id="S3.p2.1.m1.4.4.3.3.3" xref="S3.p2.1.m1.4.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.4.4.3.3.3.2" xref="S3.p2.1.m1.4.4.3.3.3.2.cmml">𝒮</mi><msub id="S3.p2.1.m1.4.4.3.3.3.3" xref="S3.p2.1.m1.4.4.3.3.3.3.cmml"><mi id="S3.p2.1.m1.4.4.3.3.3.3.2" xref="S3.p2.1.m1.4.4.3.3.3.3.2.cmml">u</mi><mi id="S3.p2.1.m1.4.4.3.3.3.3.3" xref="S3.p2.1.m1.4.4.3.3.3.3.3.cmml">M</mi></msub></msup><mo id="S3.p2.1.m1.4.4.3.3.8" xref="S3.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.4b"><apply id="S3.p2.1.m1.4.4.cmml" xref="S3.p2.1.m1.4.4"><eq id="S3.p2.1.m1.4.4.4.cmml" xref="S3.p2.1.m1.4.4.4"></eq><ci id="S3.p2.1.m1.4.4.5.cmml" xref="S3.p2.1.m1.4.4.5">𝒮</ci><set id="S3.p2.1.m1.4.4.3.4.cmml" xref="S3.p2.1.m1.4.4.3.3"><apply id="S3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1.2">𝒮</ci><apply id="S3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.p2.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.1.1.1.3.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.p2.1.m1.2.2.1.1.1.3.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1.3.2">𝑢</ci><cn id="S3.p2.1.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.p2.1.m1.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2.2">𝒮</ci><apply id="S3.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.p2.1.m1.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.3.3.2.2.2.3.1.cmml" xref="S3.p2.1.m1.3.3.2.2.2.3">subscript</csymbol><ci id="S3.p2.1.m1.3.3.2.2.2.3.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2.3.2">𝑢</ci><cn id="S3.p2.1.m1.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.p2.1.m1.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">⋯</ci><apply id="S3.p2.1.m1.4.4.3.3.3.cmml" xref="S3.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.p2.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S3.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.p2.1.m1.4.4.3.3.3.2">𝒮</ci><apply id="S3.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.p2.1.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.4.4.3.3.3.3.1.cmml" xref="S3.p2.1.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S3.p2.1.m1.4.4.3.3.3.3.2.cmml" xref="S3.p2.1.m1.4.4.3.3.3.3.2">𝑢</ci><ci id="S3.p2.1.m1.4.4.3.3.3.3.3.cmml" xref="S3.p2.1.m1.4.4.3.3.3.3.3">𝑀</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.4c">\mathcal{S}=\left\{\mathcal{S}^{u_{1}},\mathcal{S}^{u_{2}},\cdots,\mathcal{S}^%
{u_{M}}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.4d">caligraphic_S = { caligraphic_S start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , caligraphic_S start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , ⋯ , caligraphic_S start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT end_POSTSUPERSCRIPT }</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.2"><span class="ltx_text ltx_font_bold" id="S3.p3.2.1">Output</span>: A SRS model to accurately predict an item <math alttext="v" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_v</annotation></semantics></math> that is most likely to be interacted by a user <math alttext="u" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_u</annotation></semantics></math> at the next moment.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>The Proposed Framework</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we propose a novel practice-friendly two-stage LLM-enhanced paradigm (TSLRec), including an information reconstruction stage and an information augmentation stage, that is more attractive for deployment in industrial SRS.
Next, based on the training pipeline, we will describe these two core stages in detail.
To facilitate understanding, an illustration of our TSLRec framework is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S4.F2" title="Figure 2 ‣ 4. The Proposed Framework ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="291" id="S4.F2.g1" src="x2.png" width="705"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>The architecture of our practice-friendly two-stage LLM-enhanced paradigm (TSLRec) framework.</figcaption>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Information Reconstruction Stage</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">To avoid the overhead dilemma brought by instance-level SFT, we design a new user-level task for SFT at this stage, aiming to reconstruct the user’s preference distribution over all item latent categories.
This means that using LLM in our TSLRec will have lower complexity, i.e., reducing from <math alttext="O(\sum_{i=1}^{M}|\mathcal{S}^{u_{i}}|)" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">O</mi><mo id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.1.m1.1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.1.cmml"><msubsup id="S4.SS1.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2" lspace="0em" rspace="0em" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.1" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.1.m1.1.1.1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.3.cmml">M</mi></msubsup><mrow id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.2.1.cmml">|</mo><msup id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝒮</mi><msub id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">u</mi><mi id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msup><mo id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S4.SS1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2"></times><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑂</ci><apply id="S4.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1"><apply id="S4.SS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.2"></sum><apply id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3"><eq id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="S4.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1"><abs id="S4.SS1.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.2"></abs><apply id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.2">𝒮</ci><apply id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.2">𝑢</ci><ci id="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">O(\sum_{i=1}^{M}|\mathcal{S}^{u_{i}}|)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_O ( ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT | caligraphic_S start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT | )</annotation></semantics></math> to <math alttext="O(M)" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.2.2" xref="S4.SS1.p1.2.m2.1.2.2.cmml">O</mi><mo id="S4.SS1.p1.2.m2.1.2.1" xref="S4.SS1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.2.m2.1.2.3.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mo id="S4.SS1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS1.p1.2.m2.1.2.cmml">(</mo><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">M</mi><mo id="S4.SS1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.2.cmml" xref="S4.SS1.p1.2.m2.1.2"><times id="S4.SS1.p1.2.m2.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.1"></times><ci id="S4.SS1.p1.2.m2.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2">𝑂</ci><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">O(M)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_O ( italic_M )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.16"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.16.1">Characterize User Preferences.</span>
To be compatible with more practical situations, we limit the side information of items to be unavailable and then utilize the collaborative knowledge of a pre-trained SRS model to obtain preliminary latent categories related to the items.
Specifically, given a backbone SRS model <math alttext="M(\Theta)" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.2" xref="S4.SS1.p2.1.m1.1.2.cmml"><mi id="S4.SS1.p2.1.m1.1.2.2" xref="S4.SS1.p2.1.m1.1.2.2.cmml">M</mi><mo id="S4.SS1.p2.1.m1.1.2.1" xref="S4.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p2.1.m1.1.2.3.2" xref="S4.SS1.p2.1.m1.1.2.cmml"><mo id="S4.SS1.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p2.1.m1.1.1" mathvariant="normal" xref="S4.SS1.p2.1.m1.1.1.cmml">Θ</mi><mo id="S4.SS1.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.2"><times id="S4.SS1.p2.1.m1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.2.1"></times><ci id="S4.SS1.p2.1.m1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.2.2">𝑀</ci><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">Θ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">M(\Theta)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_M ( roman_Θ )</annotation></semantics></math> trained based on the ID paradigm, we can obtain a set of well-trained item embeddings from it, i.e., <math alttext="\{\mathbf{e}_{v_{1}},\mathbf{e}_{v_{2}},\cdots,\mathbf{e}_{v_{N}}\}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.4"><semantics id="S4.SS1.p2.2.m2.4a"><mrow id="S4.SS1.p2.2.m2.4.4.3" xref="S4.SS1.p2.2.m2.4.4.4.cmml"><mo id="S4.SS1.p2.2.m2.4.4.3.4" stretchy="false" xref="S4.SS1.p2.2.m2.4.4.4.cmml">{</mo><msub id="S4.SS1.p2.2.m2.2.2.1.1" xref="S4.SS1.p2.2.m2.2.2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.2.2.1.1.2" xref="S4.SS1.p2.2.m2.2.2.1.1.2.cmml">𝐞</mi><msub id="S4.SS1.p2.2.m2.2.2.1.1.3" xref="S4.SS1.p2.2.m2.2.2.1.1.3.cmml"><mi id="S4.SS1.p2.2.m2.2.2.1.1.3.2" xref="S4.SS1.p2.2.m2.2.2.1.1.3.2.cmml">v</mi><mn id="S4.SS1.p2.2.m2.2.2.1.1.3.3" xref="S4.SS1.p2.2.m2.2.2.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.SS1.p2.2.m2.4.4.3.5" xref="S4.SS1.p2.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS1.p2.2.m2.3.3.2.2" xref="S4.SS1.p2.2.m2.3.3.2.2.cmml"><mi id="S4.SS1.p2.2.m2.3.3.2.2.2" xref="S4.SS1.p2.2.m2.3.3.2.2.2.cmml">𝐞</mi><msub id="S4.SS1.p2.2.m2.3.3.2.2.3" xref="S4.SS1.p2.2.m2.3.3.2.2.3.cmml"><mi id="S4.SS1.p2.2.m2.3.3.2.2.3.2" xref="S4.SS1.p2.2.m2.3.3.2.2.3.2.cmml">v</mi><mn id="S4.SS1.p2.2.m2.3.3.2.2.3.3" xref="S4.SS1.p2.2.m2.3.3.2.2.3.3.cmml">2</mn></msub></msub><mo id="S4.SS1.p2.2.m2.4.4.3.6" xref="S4.SS1.p2.2.m2.4.4.4.cmml">,</mo><mi id="S4.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S4.SS1.p2.2.m2.1.1.cmml">⋯</mi><mo id="S4.SS1.p2.2.m2.4.4.3.7" xref="S4.SS1.p2.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS1.p2.2.m2.4.4.3.3" xref="S4.SS1.p2.2.m2.4.4.3.3.cmml"><mi id="S4.SS1.p2.2.m2.4.4.3.3.2" xref="S4.SS1.p2.2.m2.4.4.3.3.2.cmml">𝐞</mi><msub id="S4.SS1.p2.2.m2.4.4.3.3.3" xref="S4.SS1.p2.2.m2.4.4.3.3.3.cmml"><mi id="S4.SS1.p2.2.m2.4.4.3.3.3.2" xref="S4.SS1.p2.2.m2.4.4.3.3.3.2.cmml">v</mi><mi id="S4.SS1.p2.2.m2.4.4.3.3.3.3" xref="S4.SS1.p2.2.m2.4.4.3.3.3.3.cmml">N</mi></msub></msub><mo id="S4.SS1.p2.2.m2.4.4.3.8" stretchy="false" xref="S4.SS1.p2.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.4b"><set id="S4.SS1.p2.2.m2.4.4.4.cmml" xref="S4.SS1.p2.2.m2.4.4.3"><apply id="S4.SS1.p2.2.m2.2.2.1.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.2.2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.2">𝐞</ci><apply id="S4.SS1.p2.2.m2.2.2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.1.1.3.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.2.m2.2.2.1.1.3.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.3.2">𝑣</ci><cn id="S4.SS1.p2.2.m2.2.2.1.1.3.3.cmml" type="integer" xref="S4.SS1.p2.2.m2.2.2.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.p2.2.m2.3.3.2.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.2.2.1.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p2.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2">𝐞</ci><apply id="S4.SS1.p2.2.m2.3.3.2.2.3.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.2.2.3.1.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.3">subscript</csymbol><ci id="S4.SS1.p2.2.m2.3.3.2.2.3.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.3.2">𝑣</ci><cn id="S4.SS1.p2.2.m2.3.3.2.2.3.3.cmml" type="integer" xref="S4.SS1.p2.2.m2.3.3.2.2.3.3">2</cn></apply></apply><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">⋯</ci><apply id="S4.SS1.p2.2.m2.4.4.3.3.cmml" xref="S4.SS1.p2.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.4.4.3.3.1.cmml" xref="S4.SS1.p2.2.m2.4.4.3.3">subscript</csymbol><ci id="S4.SS1.p2.2.m2.4.4.3.3.2.cmml" xref="S4.SS1.p2.2.m2.4.4.3.3.2">𝐞</ci><apply id="S4.SS1.p2.2.m2.4.4.3.3.3.cmml" xref="S4.SS1.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.4.4.3.3.3.1.cmml" xref="S4.SS1.p2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.p2.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS1.p2.2.m2.4.4.3.3.3.2">𝑣</ci><ci id="S4.SS1.p2.2.m2.4.4.3.3.3.3.cmml" xref="S4.SS1.p2.2.m2.4.4.3.3.3.3">𝑁</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.4c">\{\mathbf{e}_{v_{1}},\mathbf{e}_{v_{2}},\cdots,\mathbf{e}_{v_{N}}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.4d">{ bold_e start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_e start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ⋯ , bold_e start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math>.
We then perform a pre-grouping operation on them to obtain <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_K</annotation></semantics></math> groups <math alttext="\{c_{1},c_{2},\cdots,c_{K}\}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.4"><semantics id="S4.SS1.p2.4.m4.4a"><mrow id="S4.SS1.p2.4.m4.4.4.3" xref="S4.SS1.p2.4.m4.4.4.4.cmml"><mo id="S4.SS1.p2.4.m4.4.4.3.4" stretchy="false" xref="S4.SS1.p2.4.m4.4.4.4.cmml">{</mo><msub id="S4.SS1.p2.4.m4.2.2.1.1" xref="S4.SS1.p2.4.m4.2.2.1.1.cmml"><mi id="S4.SS1.p2.4.m4.2.2.1.1.2" xref="S4.SS1.p2.4.m4.2.2.1.1.2.cmml">c</mi><mn id="S4.SS1.p2.4.m4.2.2.1.1.3" xref="S4.SS1.p2.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p2.4.m4.4.4.3.5" xref="S4.SS1.p2.4.m4.4.4.4.cmml">,</mo><msub id="S4.SS1.p2.4.m4.3.3.2.2" xref="S4.SS1.p2.4.m4.3.3.2.2.cmml"><mi id="S4.SS1.p2.4.m4.3.3.2.2.2" xref="S4.SS1.p2.4.m4.3.3.2.2.2.cmml">c</mi><mn id="S4.SS1.p2.4.m4.3.3.2.2.3" xref="S4.SS1.p2.4.m4.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.p2.4.m4.4.4.3.6" xref="S4.SS1.p2.4.m4.4.4.4.cmml">,</mo><mi id="S4.SS1.p2.4.m4.1.1" mathvariant="normal" xref="S4.SS1.p2.4.m4.1.1.cmml">⋯</mi><mo id="S4.SS1.p2.4.m4.4.4.3.7" xref="S4.SS1.p2.4.m4.4.4.4.cmml">,</mo><msub id="S4.SS1.p2.4.m4.4.4.3.3" xref="S4.SS1.p2.4.m4.4.4.3.3.cmml"><mi id="S4.SS1.p2.4.m4.4.4.3.3.2" xref="S4.SS1.p2.4.m4.4.4.3.3.2.cmml">c</mi><mi id="S4.SS1.p2.4.m4.4.4.3.3.3" xref="S4.SS1.p2.4.m4.4.4.3.3.3.cmml">K</mi></msub><mo id="S4.SS1.p2.4.m4.4.4.3.8" stretchy="false" xref="S4.SS1.p2.4.m4.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.4b"><set id="S4.SS1.p2.4.m4.4.4.4.cmml" xref="S4.SS1.p2.4.m4.4.4.3"><apply id="S4.SS1.p2.4.m4.2.2.1.1.cmml" xref="S4.SS1.p2.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.2.2.1.1.1.cmml" xref="S4.SS1.p2.4.m4.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m4.2.2.1.1.2.cmml" xref="S4.SS1.p2.4.m4.2.2.1.1.2">𝑐</ci><cn id="S4.SS1.p2.4.m4.2.2.1.1.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.2.2.1.1.3">1</cn></apply><apply id="S4.SS1.p2.4.m4.3.3.2.2.cmml" xref="S4.SS1.p2.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.3.3.2.2.1.cmml" xref="S4.SS1.p2.4.m4.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.3.3.2.2.2.cmml" xref="S4.SS1.p2.4.m4.3.3.2.2.2">𝑐</ci><cn id="S4.SS1.p2.4.m4.3.3.2.2.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.3.3.2.2.3">2</cn></apply><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">⋯</ci><apply id="S4.SS1.p2.4.m4.4.4.3.3.cmml" xref="S4.SS1.p2.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.4.4.3.3.1.cmml" xref="S4.SS1.p2.4.m4.4.4.3.3">subscript</csymbol><ci id="S4.SS1.p2.4.m4.4.4.3.3.2.cmml" xref="S4.SS1.p2.4.m4.4.4.3.3.2">𝑐</ci><ci id="S4.SS1.p2.4.m4.4.4.3.3.3.cmml" xref="S4.SS1.p2.4.m4.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.4c">\{c_{1},c_{2},\cdots,c_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.4d">{ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_c start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> and consider the group index corresponding to each item as its preliminary latent category.
We implement this operation using a <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">italic_k</annotation></semantics></math>-means method <cite class="ltx_cite ltx_citemacro_citep">(Hartigan and Wong, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib8" title="">1979</a>)</cite> for simplicity.
After obtaining the mapping relationship between each item and its group, we can get the interaction frequency vector <math alttext="\mathbf{g}^{u}=\left[g^{u}_{1},g^{u}_{2},\cdots,g^{u}_{K}\right]" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.4"><semantics id="S4.SS1.p2.6.m6.4a"><mrow id="S4.SS1.p2.6.m6.4.4" xref="S4.SS1.p2.6.m6.4.4.cmml"><msup id="S4.SS1.p2.6.m6.4.4.5" xref="S4.SS1.p2.6.m6.4.4.5.cmml"><mi id="S4.SS1.p2.6.m6.4.4.5.2" xref="S4.SS1.p2.6.m6.4.4.5.2.cmml">𝐠</mi><mi id="S4.SS1.p2.6.m6.4.4.5.3" xref="S4.SS1.p2.6.m6.4.4.5.3.cmml">u</mi></msup><mo id="S4.SS1.p2.6.m6.4.4.4" xref="S4.SS1.p2.6.m6.4.4.4.cmml">=</mo><mrow id="S4.SS1.p2.6.m6.4.4.3.3" xref="S4.SS1.p2.6.m6.4.4.3.4.cmml"><mo id="S4.SS1.p2.6.m6.4.4.3.3.4" xref="S4.SS1.p2.6.m6.4.4.3.4.cmml">[</mo><msubsup id="S4.SS1.p2.6.m6.2.2.1.1.1" xref="S4.SS1.p2.6.m6.2.2.1.1.1.cmml"><mi id="S4.SS1.p2.6.m6.2.2.1.1.1.2.2" xref="S4.SS1.p2.6.m6.2.2.1.1.1.2.2.cmml">g</mi><mn id="S4.SS1.p2.6.m6.2.2.1.1.1.3" xref="S4.SS1.p2.6.m6.2.2.1.1.1.3.cmml">1</mn><mi id="S4.SS1.p2.6.m6.2.2.1.1.1.2.3" xref="S4.SS1.p2.6.m6.2.2.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.SS1.p2.6.m6.4.4.3.3.5" xref="S4.SS1.p2.6.m6.4.4.3.4.cmml">,</mo><msubsup id="S4.SS1.p2.6.m6.3.3.2.2.2" xref="S4.SS1.p2.6.m6.3.3.2.2.2.cmml"><mi id="S4.SS1.p2.6.m6.3.3.2.2.2.2.2" xref="S4.SS1.p2.6.m6.3.3.2.2.2.2.2.cmml">g</mi><mn id="S4.SS1.p2.6.m6.3.3.2.2.2.3" xref="S4.SS1.p2.6.m6.3.3.2.2.2.3.cmml">2</mn><mi id="S4.SS1.p2.6.m6.3.3.2.2.2.2.3" xref="S4.SS1.p2.6.m6.3.3.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.SS1.p2.6.m6.4.4.3.3.6" xref="S4.SS1.p2.6.m6.4.4.3.4.cmml">,</mo><mi id="S4.SS1.p2.6.m6.1.1" mathvariant="normal" xref="S4.SS1.p2.6.m6.1.1.cmml">⋯</mi><mo id="S4.SS1.p2.6.m6.4.4.3.3.7" xref="S4.SS1.p2.6.m6.4.4.3.4.cmml">,</mo><msubsup id="S4.SS1.p2.6.m6.4.4.3.3.3" xref="S4.SS1.p2.6.m6.4.4.3.3.3.cmml"><mi id="S4.SS1.p2.6.m6.4.4.3.3.3.2.2" xref="S4.SS1.p2.6.m6.4.4.3.3.3.2.2.cmml">g</mi><mi id="S4.SS1.p2.6.m6.4.4.3.3.3.3" xref="S4.SS1.p2.6.m6.4.4.3.3.3.3.cmml">K</mi><mi id="S4.SS1.p2.6.m6.4.4.3.3.3.2.3" xref="S4.SS1.p2.6.m6.4.4.3.3.3.2.3.cmml">u</mi></msubsup><mo id="S4.SS1.p2.6.m6.4.4.3.3.8" xref="S4.SS1.p2.6.m6.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.4b"><apply id="S4.SS1.p2.6.m6.4.4.cmml" xref="S4.SS1.p2.6.m6.4.4"><eq id="S4.SS1.p2.6.m6.4.4.4.cmml" xref="S4.SS1.p2.6.m6.4.4.4"></eq><apply id="S4.SS1.p2.6.m6.4.4.5.cmml" xref="S4.SS1.p2.6.m6.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.4.4.5.1.cmml" xref="S4.SS1.p2.6.m6.4.4.5">superscript</csymbol><ci id="S4.SS1.p2.6.m6.4.4.5.2.cmml" xref="S4.SS1.p2.6.m6.4.4.5.2">𝐠</ci><ci id="S4.SS1.p2.6.m6.4.4.5.3.cmml" xref="S4.SS1.p2.6.m6.4.4.5.3">𝑢</ci></apply><list id="S4.SS1.p2.6.m6.4.4.3.4.cmml" xref="S4.SS1.p2.6.m6.4.4.3.3"><apply id="S4.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1">subscript</csymbol><apply id="S4.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.2.2.1.1.1.2.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1">superscript</csymbol><ci id="S4.SS1.p2.6.m6.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.2.2">𝑔</ci><ci id="S4.SS1.p2.6.m6.2.2.1.1.1.2.3.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.2.3">𝑢</ci></apply><cn id="S4.SS1.p2.6.m6.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p2.6.m6.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.p2.6.m6.3.3.2.2.2.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.3.3.2.2.2.1.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2">subscript</csymbol><apply id="S4.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2">superscript</csymbol><ci id="S4.SS1.p2.6.m6.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2.2.2">𝑔</ci><ci id="S4.SS1.p2.6.m6.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2.2.3">𝑢</ci></apply><cn id="S4.SS1.p2.6.m6.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.p2.6.m6.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">⋯</ci><apply id="S4.SS1.p2.6.m6.4.4.3.3.3.cmml" xref="S4.SS1.p2.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.4.4.3.3.3.1.cmml" xref="S4.SS1.p2.6.m6.4.4.3.3.3">subscript</csymbol><apply id="S4.SS1.p2.6.m6.4.4.3.3.3.2.cmml" xref="S4.SS1.p2.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.4.4.3.3.3.2.1.cmml" xref="S4.SS1.p2.6.m6.4.4.3.3.3">superscript</csymbol><ci id="S4.SS1.p2.6.m6.4.4.3.3.3.2.2.cmml" xref="S4.SS1.p2.6.m6.4.4.3.3.3.2.2">𝑔</ci><ci id="S4.SS1.p2.6.m6.4.4.3.3.3.2.3.cmml" xref="S4.SS1.p2.6.m6.4.4.3.3.3.2.3">𝑢</ci></apply><ci id="S4.SS1.p2.6.m6.4.4.3.3.3.3.cmml" xref="S4.SS1.p2.6.m6.4.4.3.3.3.3">𝐾</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.4c">\mathbf{g}^{u}=\left[g^{u}_{1},g^{u}_{2},\cdots,g^{u}_{K}\right]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.4d">bold_g start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = [ italic_g start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_g start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_g start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ]</annotation></semantics></math> of each user in <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m7.1"><semantics id="S4.SS1.p2.7.m7.1a"><mi id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><ci id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m7.1d">italic_K</annotation></semantics></math> groups based on the items included in each user’s interaction sequence, i.e., if user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m8.1"><semantics id="S4.SS1.p2.8.m8.1a"><mi id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.1b"><ci id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m8.1d">italic_u</annotation></semantics></math> interacts with item <math alttext="v" class="ltx_Math" display="inline" id="S4.SS1.p2.9.m9.1"><semantics id="S4.SS1.p2.9.m9.1a"><mi id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m9.1b"><ci id="S4.SS1.p2.9.m9.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m9.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.9.m9.1d">italic_v</annotation></semantics></math> and <math alttext="v\in c_{i}" class="ltx_Math" display="inline" id="S4.SS1.p2.10.m10.1"><semantics id="S4.SS1.p2.10.m10.1a"><mrow id="S4.SS1.p2.10.m10.1.1" xref="S4.SS1.p2.10.m10.1.1.cmml"><mi id="S4.SS1.p2.10.m10.1.1.2" xref="S4.SS1.p2.10.m10.1.1.2.cmml">v</mi><mo id="S4.SS1.p2.10.m10.1.1.1" xref="S4.SS1.p2.10.m10.1.1.1.cmml">∈</mo><msub id="S4.SS1.p2.10.m10.1.1.3" xref="S4.SS1.p2.10.m10.1.1.3.cmml"><mi id="S4.SS1.p2.10.m10.1.1.3.2" xref="S4.SS1.p2.10.m10.1.1.3.2.cmml">c</mi><mi id="S4.SS1.p2.10.m10.1.1.3.3" xref="S4.SS1.p2.10.m10.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m10.1b"><apply id="S4.SS1.p2.10.m10.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1"><in id="S4.SS1.p2.10.m10.1.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1.1"></in><ci id="S4.SS1.p2.10.m10.1.1.2.cmml" xref="S4.SS1.p2.10.m10.1.1.2">𝑣</ci><apply id="S4.SS1.p2.10.m10.1.1.3.cmml" xref="S4.SS1.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m10.1.1.3.1.cmml" xref="S4.SS1.p2.10.m10.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.10.m10.1.1.3.2.cmml" xref="S4.SS1.p2.10.m10.1.1.3.2">𝑐</ci><ci id="S4.SS1.p2.10.m10.1.1.3.3.cmml" xref="S4.SS1.p2.10.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m10.1c">v\in c_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.10.m10.1d">italic_v ∈ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="g^{u}_{i}" class="ltx_Math" display="inline" id="S4.SS1.p2.11.m11.1"><semantics id="S4.SS1.p2.11.m11.1a"><msubsup id="S4.SS1.p2.11.m11.1.1" xref="S4.SS1.p2.11.m11.1.1.cmml"><mi id="S4.SS1.p2.11.m11.1.1.2.2" xref="S4.SS1.p2.11.m11.1.1.2.2.cmml">g</mi><mi id="S4.SS1.p2.11.m11.1.1.3" xref="S4.SS1.p2.11.m11.1.1.3.cmml">i</mi><mi id="S4.SS1.p2.11.m11.1.1.2.3" xref="S4.SS1.p2.11.m11.1.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m11.1b"><apply id="S4.SS1.p2.11.m11.1.1.cmml" xref="S4.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m11.1.1.1.cmml" xref="S4.SS1.p2.11.m11.1.1">subscript</csymbol><apply id="S4.SS1.p2.11.m11.1.1.2.cmml" xref="S4.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m11.1.1.2.1.cmml" xref="S4.SS1.p2.11.m11.1.1">superscript</csymbol><ci id="S4.SS1.p2.11.m11.1.1.2.2.cmml" xref="S4.SS1.p2.11.m11.1.1.2.2">𝑔</ci><ci id="S4.SS1.p2.11.m11.1.1.2.3.cmml" xref="S4.SS1.p2.11.m11.1.1.2.3">𝑢</ci></apply><ci id="S4.SS1.p2.11.m11.1.1.3.cmml" xref="S4.SS1.p2.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m11.1c">g^{u}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.11.m11.1d">italic_g start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> will be increased by one; otherwise, it will remain at the initial value (i.e., 0).
In other words, the value of <math alttext="g^{u}_{i}" class="ltx_Math" display="inline" id="S4.SS1.p2.12.m12.1"><semantics id="S4.SS1.p2.12.m12.1a"><msubsup id="S4.SS1.p2.12.m12.1.1" xref="S4.SS1.p2.12.m12.1.1.cmml"><mi id="S4.SS1.p2.12.m12.1.1.2.2" xref="S4.SS1.p2.12.m12.1.1.2.2.cmml">g</mi><mi id="S4.SS1.p2.12.m12.1.1.3" xref="S4.SS1.p2.12.m12.1.1.3.cmml">i</mi><mi id="S4.SS1.p2.12.m12.1.1.2.3" xref="S4.SS1.p2.12.m12.1.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m12.1b"><apply id="S4.SS1.p2.12.m12.1.1.cmml" xref="S4.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m12.1.1.1.cmml" xref="S4.SS1.p2.12.m12.1.1">subscript</csymbol><apply id="S4.SS1.p2.12.m12.1.1.2.cmml" xref="S4.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m12.1.1.2.1.cmml" xref="S4.SS1.p2.12.m12.1.1">superscript</csymbol><ci id="S4.SS1.p2.12.m12.1.1.2.2.cmml" xref="S4.SS1.p2.12.m12.1.1.2.2">𝑔</ci><ci id="S4.SS1.p2.12.m12.1.1.2.3.cmml" xref="S4.SS1.p2.12.m12.1.1.2.3">𝑢</ci></apply><ci id="S4.SS1.p2.12.m12.1.1.3.cmml" xref="S4.SS1.p2.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m12.1c">g^{u}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.12.m12.1d">italic_g start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> reflects the number of interactions that user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p2.13.m13.1"><semantics id="S4.SS1.p2.13.m13.1a"><mi id="S4.SS1.p2.13.m13.1.1" xref="S4.SS1.p2.13.m13.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m13.1b"><ci id="S4.SS1.p2.13.m13.1.1.cmml" xref="S4.SS1.p2.13.m13.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m13.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.13.m13.1d">italic_u</annotation></semantics></math> has had with the set of items in the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p2.14.m14.1"><semantics id="S4.SS1.p2.14.m14.1a"><mi id="S4.SS1.p2.14.m14.1.1" xref="S4.SS1.p2.14.m14.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.14.m14.1b"><ci id="S4.SS1.p2.14.m14.1.1.cmml" xref="S4.SS1.p2.14.m14.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.14.m14.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.14.m14.1d">italic_i</annotation></semantics></math>-th group <math alttext="c_{i}" class="ltx_Math" display="inline" id="S4.SS1.p2.15.m15.1"><semantics id="S4.SS1.p2.15.m15.1a"><msub id="S4.SS1.p2.15.m15.1.1" xref="S4.SS1.p2.15.m15.1.1.cmml"><mi id="S4.SS1.p2.15.m15.1.1.2" xref="S4.SS1.p2.15.m15.1.1.2.cmml">c</mi><mi id="S4.SS1.p2.15.m15.1.1.3" xref="S4.SS1.p2.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.15.m15.1b"><apply id="S4.SS1.p2.15.m15.1.1.cmml" xref="S4.SS1.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.15.m15.1.1.1.cmml" xref="S4.SS1.p2.15.m15.1.1">subscript</csymbol><ci id="S4.SS1.p2.15.m15.1.1.2.cmml" xref="S4.SS1.p2.15.m15.1.1.2">𝑐</ci><ci id="S4.SS1.p2.15.m15.1.1.3.cmml" xref="S4.SS1.p2.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.15.m15.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.15.m15.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
To avoid magnitude differences between users with different activity levels, we will also normalize these vectors (denoted as <math alttext="\overline{\mathbf{g}}^{u}" class="ltx_Math" display="inline" id="S4.SS1.p2.16.m16.1"><semantics id="S4.SS1.p2.16.m16.1a"><msup id="S4.SS1.p2.16.m16.1.1" xref="S4.SS1.p2.16.m16.1.1.cmml"><mover accent="true" id="S4.SS1.p2.16.m16.1.1.2" xref="S4.SS1.p2.16.m16.1.1.2.cmml"><mi id="S4.SS1.p2.16.m16.1.1.2.2" xref="S4.SS1.p2.16.m16.1.1.2.2.cmml">𝐠</mi><mo id="S4.SS1.p2.16.m16.1.1.2.1" xref="S4.SS1.p2.16.m16.1.1.2.1.cmml">¯</mo></mover><mi id="S4.SS1.p2.16.m16.1.1.3" xref="S4.SS1.p2.16.m16.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.16.m16.1b"><apply id="S4.SS1.p2.16.m16.1.1.cmml" xref="S4.SS1.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.16.m16.1.1.1.cmml" xref="S4.SS1.p2.16.m16.1.1">superscript</csymbol><apply id="S4.SS1.p2.16.m16.1.1.2.cmml" xref="S4.SS1.p2.16.m16.1.1.2"><ci id="S4.SS1.p2.16.m16.1.1.2.1.cmml" xref="S4.SS1.p2.16.m16.1.1.2.1">¯</ci><ci id="S4.SS1.p2.16.m16.1.1.2.2.cmml" xref="S4.SS1.p2.16.m16.1.1.2.2">𝐠</ci></apply><ci id="S4.SS1.p2.16.m16.1.1.3.cmml" xref="S4.SS1.p2.16.m16.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.16.m16.1c">\overline{\mathbf{g}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.16.m16.1d">over¯ start_ARG bold_g end_ARG start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>) and use them to characterize user preferences.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.8"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.8.1">SFT for Reconstructing User Preferences.</span>
Next, we modify the SFT task to take a user’s interaction sequence <math alttext="\mathcal{S}^{u}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><msup id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">𝒮</mi><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝒮</ci><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathcal{S}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">caligraphic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> as input and reconstruct the user’s corresponding preference, i.e., the normalized interaction frequency vector <math alttext="\overline{\mathbf{g}}^{u}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><msup id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2.2" xref="S4.SS1.p3.2.m2.1.1.2.2.cmml">𝐠</mi><mo id="S4.SS1.p3.2.m2.1.1.2.1" xref="S4.SS1.p3.2.m2.1.1.2.1.cmml">¯</mo></mover><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2"><ci id="S4.SS1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.2.1">¯</ci><ci id="S4.SS1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2.2">𝐠</ci></apply><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\overline{\mathbf{g}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">over¯ start_ARG bold_g end_ARG start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>.
Specifically, for ease of description, we denote the prompt template for this task as three parts, i.e., <math alttext="d_{inst}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><msub id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">d</mi><mrow id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml"><mi id="S4.SS1.p3.3.m3.1.1.3.2" xref="S4.SS1.p3.3.m3.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p3.3.m3.1.1.3.1" xref="S4.SS1.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.3.m3.1.1.3.3" xref="S4.SS1.p3.3.m3.1.1.3.3.cmml">n</mi><mo id="S4.SS1.p3.3.m3.1.1.3.1a" xref="S4.SS1.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.3.m3.1.1.3.4" xref="S4.SS1.p3.3.m3.1.1.3.4.cmml">s</mi><mo id="S4.SS1.p3.3.m3.1.1.3.1b" xref="S4.SS1.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.3.m3.1.1.3.5" xref="S4.SS1.p3.3.m3.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">𝑑</ci><apply id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3"><times id="S4.SS1.p3.3.m3.1.1.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.3.1"></times><ci id="S4.SS1.p3.3.m3.1.1.3.2.cmml" xref="S4.SS1.p3.3.m3.1.1.3.2">𝑖</ci><ci id="S4.SS1.p3.3.m3.1.1.3.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3">𝑛</ci><ci id="S4.SS1.p3.3.m3.1.1.3.4.cmml" xref="S4.SS1.p3.3.m3.1.1.3.4">𝑠</ci><ci id="S4.SS1.p3.3.m3.1.1.3.5.cmml" xref="S4.SS1.p3.3.m3.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">d_{inst}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_d start_POSTSUBSCRIPT italic_i italic_n italic_s italic_t end_POSTSUBSCRIPT</annotation></semantics></math>: “Given the user’s purchase history, predict the user’s distribution among <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">italic_K</annotation></semantics></math> purchase preferences.”, and <math alttext="d_{ids}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><msub id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">d</mi><mrow id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml"><mi id="S4.SS1.p3.5.m5.1.1.3.2" xref="S4.SS1.p3.5.m5.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p3.5.m5.1.1.3.1" xref="S4.SS1.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.5.m5.1.1.3.3" xref="S4.SS1.p3.5.m5.1.1.3.3.cmml">d</mi><mo id="S4.SS1.p3.5.m5.1.1.3.1a" xref="S4.SS1.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.5.m5.1.1.3.4" xref="S4.SS1.p3.5.m5.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">𝑑</ci><apply id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3"><times id="S4.SS1.p3.5.m5.1.1.3.1.cmml" xref="S4.SS1.p3.5.m5.1.1.3.1"></times><ci id="S4.SS1.p3.5.m5.1.1.3.2.cmml" xref="S4.SS1.p3.5.m5.1.1.3.2">𝑖</ci><ci id="S4.SS1.p3.5.m5.1.1.3.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3.3">𝑑</ci><ci id="S4.SS1.p3.5.m5.1.1.3.4.cmml" xref="S4.SS1.p3.5.m5.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">d_{ids}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">italic_d start_POSTSUBSCRIPT italic_i italic_d italic_s end_POSTSUBSCRIPT</annotation></semantics></math>: <math alttext="\mathcal{S}^{u}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><msup id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">𝒮</mi><mi id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝒮</ci><ci id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">\mathcal{S}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">caligraphic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="d_{res}" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.1"><semantics id="S4.SS1.p3.7.m7.1a"><msub id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.2" xref="S4.SS1.p3.7.m7.1.1.2.cmml">d</mi><mrow id="S4.SS1.p3.7.m7.1.1.3" xref="S4.SS1.p3.7.m7.1.1.3.cmml"><mi id="S4.SS1.p3.7.m7.1.1.3.2" xref="S4.SS1.p3.7.m7.1.1.3.2.cmml">r</mi><mo id="S4.SS1.p3.7.m7.1.1.3.1" xref="S4.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.7.m7.1.1.3.3" xref="S4.SS1.p3.7.m7.1.1.3.3.cmml">e</mi><mo id="S4.SS1.p3.7.m7.1.1.3.1a" xref="S4.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.7.m7.1.1.3.4" xref="S4.SS1.p3.7.m7.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><apply id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.2">𝑑</ci><apply id="S4.SS1.p3.7.m7.1.1.3.cmml" xref="S4.SS1.p3.7.m7.1.1.3"><times id="S4.SS1.p3.7.m7.1.1.3.1.cmml" xref="S4.SS1.p3.7.m7.1.1.3.1"></times><ci id="S4.SS1.p3.7.m7.1.1.3.2.cmml" xref="S4.SS1.p3.7.m7.1.1.3.2">𝑟</ci><ci id="S4.SS1.p3.7.m7.1.1.3.3.cmml" xref="S4.SS1.p3.7.m7.1.1.3.3">𝑒</ci><ci id="S4.SS1.p3.7.m7.1.1.3.4.cmml" xref="S4.SS1.p3.7.m7.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">d_{res}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.1d">italic_d start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT</annotation></semantics></math>: “Response:”.
Similar to previous work <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib16" title="">2023a</a>)</cite>, we use the item embeddings provided by the pre-trained backbone SRS model to replace LLM’s token embeddings for item IDs in interaction sequences, making LLM aware of the item correlations behind different IDs.
Therefore, obtaining LLM knowledge embedding <math alttext="\mathbf{h}^{u}" class="ltx_Math" display="inline" id="S4.SS1.p3.8.m8.1"><semantics id="S4.SS1.p3.8.m8.1a"><msup id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml"><mi id="S4.SS1.p3.8.m8.1.1.2" xref="S4.SS1.p3.8.m8.1.1.2.cmml">𝐡</mi><mi id="S4.SS1.p3.8.m8.1.1.3" xref="S4.SS1.p3.8.m8.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.1b"><apply id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.1.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1">superscript</csymbol><ci id="S4.SS1.p3.8.m8.1.1.2.cmml" xref="S4.SS1.p3.8.m8.1.1.2">𝐡</ci><ci id="S4.SS1.p3.8.m8.1.1.3.cmml" xref="S4.SS1.p3.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.1c">\mathbf{h}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.8.m8.1d">bold_h start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> based on this prompt can be expressed as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{h}^{u}=LLM\left(\mathbf{p}_{inst};linear\_proj([\mathbf{e}_{v^{u}_{1}}%
,\mathbf{e}_{v^{u}_{2}},\cdots,\mathbf{e}_{v^{u}_{|\mathcal{S}^{u}|}}]);%
\mathbf{p}_{res}\right)," class="ltx_Math" display="block" id="S4.E1.m1.3"><semantics id="S4.E1.m1.3a"><mrow id="S4.E1.m1.3.3.1" xref="S4.E1.m1.3.3.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.cmml"><msup id="S4.E1.m1.3.3.1.1.5" xref="S4.E1.m1.3.3.1.1.5.cmml"><mi id="S4.E1.m1.3.3.1.1.5.2" xref="S4.E1.m1.3.3.1.1.5.2.cmml">𝐡</mi><mi id="S4.E1.m1.3.3.1.1.5.3" xref="S4.E1.m1.3.3.1.1.5.3.cmml">u</mi></msup><mo id="S4.E1.m1.3.3.1.1.4" xref="S4.E1.m1.3.3.1.1.4.cmml">=</mo><mrow id="S4.E1.m1.3.3.1.1.3" xref="S4.E1.m1.3.3.1.1.3.cmml"><mi id="S4.E1.m1.3.3.1.1.3.5" xref="S4.E1.m1.3.3.1.1.3.5.cmml">L</mi><mo id="S4.E1.m1.3.3.1.1.3.4" xref="S4.E1.m1.3.3.1.1.3.4.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.3.6" xref="S4.E1.m1.3.3.1.1.3.6.cmml">L</mi><mo id="S4.E1.m1.3.3.1.1.3.4a" xref="S4.E1.m1.3.3.1.1.3.4.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.3.7" xref="S4.E1.m1.3.3.1.1.3.7.cmml">M</mi><mo id="S4.E1.m1.3.3.1.1.3.4b" xref="S4.E1.m1.3.3.1.1.3.4.cmml">⁢</mo><mrow id="S4.E1.m1.3.3.1.1.3.3.3" xref="S4.E1.m1.3.3.1.1.3.3.4.cmml"><mo id="S4.E1.m1.3.3.1.1.3.3.3.4" xref="S4.E1.m1.3.3.1.1.3.3.4.cmml">(</mo><msub id="S4.E1.m1.3.3.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml">𝐩</mi><mrow id="S4.E1.m1.3.3.1.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.3.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml">n</mi><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.3.1a" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.3.4" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.4.cmml">s</mi><mo id="S4.E1.m1.3.3.1.1.1.1.1.1.3.1b" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.1.3.5" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.5.cmml">t</mi></mrow></msub><mo id="S4.E1.m1.3.3.1.1.3.3.3.5" xref="S4.E1.m1.3.3.1.1.3.3.4.cmml">;</mo><mrow id="S4.E1.m1.3.3.1.1.2.2.2.2" xref="S4.E1.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.3.cmml">l</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.4" xref="S4.E1.m1.3.3.1.1.2.2.2.2.4.cmml">i</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2a" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.5" xref="S4.E1.m1.3.3.1.1.2.2.2.2.5.cmml">n</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2b" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.6" xref="S4.E1.m1.3.3.1.1.2.2.2.2.6.cmml">e</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2c" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.7" xref="S4.E1.m1.3.3.1.1.2.2.2.2.7.cmml">a</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2d" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.8" xref="S4.E1.m1.3.3.1.1.2.2.2.2.8.cmml">r</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2e" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.9" mathvariant="normal" xref="S4.E1.m1.3.3.1.1.2.2.2.2.9.cmml">_</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2f" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.10" xref="S4.E1.m1.3.3.1.1.2.2.2.2.10.cmml">p</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2g" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.11" xref="S4.E1.m1.3.3.1.1.2.2.2.2.11.cmml">r</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2h" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.12" xref="S4.E1.m1.3.3.1.1.2.2.2.2.12.cmml">o</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2i" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.13" xref="S4.E1.m1.3.3.1.1.2.2.2.2.13.cmml">j</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.2j" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1" xref="S4.E1.m1.3.3.1.1.2.2.2.2.cmml"><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.2" stretchy="false" xref="S4.E1.m1.3.3.1.1.2.2.2.2.cmml">(</mo><mrow id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.4.cmml"><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.4" stretchy="false" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.4.cmml">[</mo><msub id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.2.cmml">𝐞</mi><msubsup id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.2" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.2.cmml">v</mi><mn id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.3.cmml">1</mn><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.3.cmml">u</mi></msubsup></msub><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.5" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.4.cmml">,</mo><msub id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.cmml"><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.2" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.2.cmml">𝐞</mi><msubsup id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.cmml"><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.2" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.2.cmml">v</mi><mn id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.3.cmml">2</mn><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.3.cmml">u</mi></msubsup></msub><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.6" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.4.cmml">,</mo><mi id="S4.E1.m1.2.2" mathvariant="normal" xref="S4.E1.m1.2.2.cmml">⋯</mi><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.7" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.4.cmml">,</mo><msub id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3.cmml"><mi id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3.2" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3.2.cmml">𝐞</mi><msubsup id="S4.E1.m1.1.1.1" xref="S4.E1.m1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.3.2.cmml">v</mi><mrow id="S4.E1.m1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.2.cmml"><mo id="S4.E1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.2.1.cmml">|</mo><msup id="S4.E1.m1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S4.E1.m1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S4.E1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S4.E1.m1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.3.3.cmml">u</mi></msubsup></msub><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.8" stretchy="false" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.4.cmml">]</mo></mrow><mo id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.3" stretchy="false" xref="S4.E1.m1.3.3.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.3.3.1.1.3.3.3.6" xref="S4.E1.m1.3.3.1.1.3.3.4.cmml">;</mo><msub id="S4.E1.m1.3.3.1.1.3.3.3.3" xref="S4.E1.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S4.E1.m1.3.3.1.1.3.3.3.3.2" xref="S4.E1.m1.3.3.1.1.3.3.3.3.2.cmml">𝐩</mi><mrow id="S4.E1.m1.3.3.1.1.3.3.3.3.3" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.cmml"><mi id="S4.E1.m1.3.3.1.1.3.3.3.3.3.2" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.2.cmml">r</mi><mo id="S4.E1.m1.3.3.1.1.3.3.3.3.3.1" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.3.3.3.3.3.3" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.3.cmml">e</mi><mo id="S4.E1.m1.3.3.1.1.3.3.3.3.3.1a" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E1.m1.3.3.1.1.3.3.3.3.3.4" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.4.cmml">s</mi></mrow></msub><mo id="S4.E1.m1.3.3.1.1.3.3.3.7" xref="S4.E1.m1.3.3.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.3.3.1.2" xref="S4.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.3b"><apply id="S4.E1.m1.3.3.1.1.cmml" xref="S4.E1.m1.3.3.1"><eq id="S4.E1.m1.3.3.1.1.4.cmml" xref="S4.E1.m1.3.3.1.1.4"></eq><apply id="S4.E1.m1.3.3.1.1.5.cmml" xref="S4.E1.m1.3.3.1.1.5"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.5.1.cmml" xref="S4.E1.m1.3.3.1.1.5">superscript</csymbol><ci id="S4.E1.m1.3.3.1.1.5.2.cmml" xref="S4.E1.m1.3.3.1.1.5.2">𝐡</ci><ci id="S4.E1.m1.3.3.1.1.5.3.cmml" xref="S4.E1.m1.3.3.1.1.5.3">𝑢</ci></apply><apply id="S4.E1.m1.3.3.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.3"><times id="S4.E1.m1.3.3.1.1.3.4.cmml" xref="S4.E1.m1.3.3.1.1.3.4"></times><ci id="S4.E1.m1.3.3.1.1.3.5.cmml" xref="S4.E1.m1.3.3.1.1.3.5">𝐿</ci><ci id="S4.E1.m1.3.3.1.1.3.6.cmml" xref="S4.E1.m1.3.3.1.1.3.6">𝐿</ci><ci id="S4.E1.m1.3.3.1.1.3.7.cmml" xref="S4.E1.m1.3.3.1.1.3.7">𝑀</ci><list id="S4.E1.m1.3.3.1.1.3.3.4.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3"><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.2">𝐩</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3"><times id="S4.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.1"></times><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.3">𝑛</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.4.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.4">𝑠</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.1.3.5.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1.3.5">𝑡</ci></apply></apply><apply id="S4.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2"><times id="S4.E1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.2"></times><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.3">𝑙</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.4.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.4">𝑖</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.5.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.5">𝑛</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.6.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.6">𝑒</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.7.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.7">𝑎</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.8.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.8">𝑟</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.9.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.9">_</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.10.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.10">𝑝</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.11.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.11">𝑟</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.12.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.12">𝑜</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.13.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.13">𝑗</ci><list id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.4.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3"><apply id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.2">𝐞</ci><apply id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.1.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.2">𝑣</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.3.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.2.3">𝑢</ci></apply><cn id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.1.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2">subscript</csymbol><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.2">𝐞</ci><apply id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.1.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3">subscript</csymbol><apply id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.1.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3">superscript</csymbol><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.2">𝑣</ci><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.3.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.2.3">𝑢</ci></apply><cn id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.2.2.3.3">2</cn></apply></apply><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">⋯</ci><apply id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3.1.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3.2.cmml" xref="S4.E1.m1.3.3.1.1.2.2.2.2.1.1.1.3.3.2">𝐞</ci><apply id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1">subscript</csymbol><apply id="S4.E1.m1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1">superscript</csymbol><ci id="S4.E1.m1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.3.2">𝑣</ci><ci id="S4.E1.m1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.3.3">𝑢</ci></apply><apply id="S4.E1.m1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1"><abs id="S4.E1.m1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.2"></abs><apply id="S4.E1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2">𝒮</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></apply></list></apply><apply id="S4.E1.m1.3.3.1.1.3.3.3.3.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3.3">subscript</csymbol><ci id="S4.E1.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3.3.2">𝐩</ci><apply id="S4.E1.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3"><times id="S4.E1.m1.3.3.1.1.3.3.3.3.3.1.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.1"></times><ci id="S4.E1.m1.3.3.1.1.3.3.3.3.3.2.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.2">𝑟</ci><ci id="S4.E1.m1.3.3.1.1.3.3.3.3.3.3.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.3">𝑒</ci><ci id="S4.E1.m1.3.3.1.1.3.3.3.3.3.4.cmml" xref="S4.E1.m1.3.3.1.1.3.3.3.3.3.4">𝑠</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.3c">\mathbf{h}^{u}=LLM\left(\mathbf{p}_{inst};linear\_proj([\mathbf{e}_{v^{u}_{1}}%
,\mathbf{e}_{v^{u}_{2}},\cdots,\mathbf{e}_{v^{u}_{|\mathcal{S}^{u}|}}]);%
\mathbf{p}_{res}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.3d">bold_h start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = italic_L italic_L italic_M ( bold_p start_POSTSUBSCRIPT italic_i italic_n italic_s italic_t end_POSTSUBSCRIPT ; italic_l italic_i italic_n italic_e italic_a italic_r _ italic_p italic_r italic_o italic_j ( [ bold_e start_POSTSUBSCRIPT italic_v start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_e start_POSTSUBSCRIPT italic_v start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ⋯ , bold_e start_POSTSUBSCRIPT italic_v start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT | caligraphic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ) ; bold_p start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.14">where <math alttext="\mathbf{p}_{inst}" class="ltx_Math" display="inline" id="S4.SS1.p3.9.m1.1"><semantics id="S4.SS1.p3.9.m1.1a"><msub id="S4.SS1.p3.9.m1.1.1" xref="S4.SS1.p3.9.m1.1.1.cmml"><mi id="S4.SS1.p3.9.m1.1.1.2" xref="S4.SS1.p3.9.m1.1.1.2.cmml">𝐩</mi><mrow id="S4.SS1.p3.9.m1.1.1.3" xref="S4.SS1.p3.9.m1.1.1.3.cmml"><mi id="S4.SS1.p3.9.m1.1.1.3.2" xref="S4.SS1.p3.9.m1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p3.9.m1.1.1.3.1" xref="S4.SS1.p3.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.9.m1.1.1.3.3" xref="S4.SS1.p3.9.m1.1.1.3.3.cmml">n</mi><mo id="S4.SS1.p3.9.m1.1.1.3.1a" xref="S4.SS1.p3.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.9.m1.1.1.3.4" xref="S4.SS1.p3.9.m1.1.1.3.4.cmml">s</mi><mo id="S4.SS1.p3.9.m1.1.1.3.1b" xref="S4.SS1.p3.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.9.m1.1.1.3.5" xref="S4.SS1.p3.9.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m1.1b"><apply id="S4.SS1.p3.9.m1.1.1.cmml" xref="S4.SS1.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m1.1.1.1.cmml" xref="S4.SS1.p3.9.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.9.m1.1.1.2.cmml" xref="S4.SS1.p3.9.m1.1.1.2">𝐩</ci><apply id="S4.SS1.p3.9.m1.1.1.3.cmml" xref="S4.SS1.p3.9.m1.1.1.3"><times id="S4.SS1.p3.9.m1.1.1.3.1.cmml" xref="S4.SS1.p3.9.m1.1.1.3.1"></times><ci id="S4.SS1.p3.9.m1.1.1.3.2.cmml" xref="S4.SS1.p3.9.m1.1.1.3.2">𝑖</ci><ci id="S4.SS1.p3.9.m1.1.1.3.3.cmml" xref="S4.SS1.p3.9.m1.1.1.3.3">𝑛</ci><ci id="S4.SS1.p3.9.m1.1.1.3.4.cmml" xref="S4.SS1.p3.9.m1.1.1.3.4">𝑠</ci><ci id="S4.SS1.p3.9.m1.1.1.3.5.cmml" xref="S4.SS1.p3.9.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m1.1c">\mathbf{p}_{inst}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.9.m1.1d">bold_p start_POSTSUBSCRIPT italic_i italic_n italic_s italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{p}_{res}" class="ltx_Math" display="inline" id="S4.SS1.p3.10.m2.1"><semantics id="S4.SS1.p3.10.m2.1a"><msub id="S4.SS1.p3.10.m2.1.1" xref="S4.SS1.p3.10.m2.1.1.cmml"><mi id="S4.SS1.p3.10.m2.1.1.2" xref="S4.SS1.p3.10.m2.1.1.2.cmml">𝐩</mi><mrow id="S4.SS1.p3.10.m2.1.1.3" xref="S4.SS1.p3.10.m2.1.1.3.cmml"><mi id="S4.SS1.p3.10.m2.1.1.3.2" xref="S4.SS1.p3.10.m2.1.1.3.2.cmml">r</mi><mo id="S4.SS1.p3.10.m2.1.1.3.1" xref="S4.SS1.p3.10.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.10.m2.1.1.3.3" xref="S4.SS1.p3.10.m2.1.1.3.3.cmml">e</mi><mo id="S4.SS1.p3.10.m2.1.1.3.1a" xref="S4.SS1.p3.10.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.10.m2.1.1.3.4" xref="S4.SS1.p3.10.m2.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m2.1b"><apply id="S4.SS1.p3.10.m2.1.1.cmml" xref="S4.SS1.p3.10.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m2.1.1.1.cmml" xref="S4.SS1.p3.10.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.10.m2.1.1.2.cmml" xref="S4.SS1.p3.10.m2.1.1.2">𝐩</ci><apply id="S4.SS1.p3.10.m2.1.1.3.cmml" xref="S4.SS1.p3.10.m2.1.1.3"><times id="S4.SS1.p3.10.m2.1.1.3.1.cmml" xref="S4.SS1.p3.10.m2.1.1.3.1"></times><ci id="S4.SS1.p3.10.m2.1.1.3.2.cmml" xref="S4.SS1.p3.10.m2.1.1.3.2">𝑟</ci><ci id="S4.SS1.p3.10.m2.1.1.3.3.cmml" xref="S4.SS1.p3.10.m2.1.1.3.3">𝑒</ci><ci id="S4.SS1.p3.10.m2.1.1.3.4.cmml" xref="S4.SS1.p3.10.m2.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m2.1c">\mathbf{p}_{res}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.10.m2.1d">bold_p start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT</annotation></semantics></math> denote the token sequence embeddings obtained by LLM for <math alttext="d_{inst}" class="ltx_Math" display="inline" id="S4.SS1.p3.11.m3.1"><semantics id="S4.SS1.p3.11.m3.1a"><msub id="S4.SS1.p3.11.m3.1.1" xref="S4.SS1.p3.11.m3.1.1.cmml"><mi id="S4.SS1.p3.11.m3.1.1.2" xref="S4.SS1.p3.11.m3.1.1.2.cmml">d</mi><mrow id="S4.SS1.p3.11.m3.1.1.3" xref="S4.SS1.p3.11.m3.1.1.3.cmml"><mi id="S4.SS1.p3.11.m3.1.1.3.2" xref="S4.SS1.p3.11.m3.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p3.11.m3.1.1.3.1" xref="S4.SS1.p3.11.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.11.m3.1.1.3.3" xref="S4.SS1.p3.11.m3.1.1.3.3.cmml">n</mi><mo id="S4.SS1.p3.11.m3.1.1.3.1a" xref="S4.SS1.p3.11.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.11.m3.1.1.3.4" xref="S4.SS1.p3.11.m3.1.1.3.4.cmml">s</mi><mo id="S4.SS1.p3.11.m3.1.1.3.1b" xref="S4.SS1.p3.11.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.11.m3.1.1.3.5" xref="S4.SS1.p3.11.m3.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.11.m3.1b"><apply id="S4.SS1.p3.11.m3.1.1.cmml" xref="S4.SS1.p3.11.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m3.1.1.1.cmml" xref="S4.SS1.p3.11.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.11.m3.1.1.2.cmml" xref="S4.SS1.p3.11.m3.1.1.2">𝑑</ci><apply id="S4.SS1.p3.11.m3.1.1.3.cmml" xref="S4.SS1.p3.11.m3.1.1.3"><times id="S4.SS1.p3.11.m3.1.1.3.1.cmml" xref="S4.SS1.p3.11.m3.1.1.3.1"></times><ci id="S4.SS1.p3.11.m3.1.1.3.2.cmml" xref="S4.SS1.p3.11.m3.1.1.3.2">𝑖</ci><ci id="S4.SS1.p3.11.m3.1.1.3.3.cmml" xref="S4.SS1.p3.11.m3.1.1.3.3">𝑛</ci><ci id="S4.SS1.p3.11.m3.1.1.3.4.cmml" xref="S4.SS1.p3.11.m3.1.1.3.4">𝑠</ci><ci id="S4.SS1.p3.11.m3.1.1.3.5.cmml" xref="S4.SS1.p3.11.m3.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.11.m3.1c">d_{inst}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.11.m3.1d">italic_d start_POSTSUBSCRIPT italic_i italic_n italic_s italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{res}" class="ltx_Math" display="inline" id="S4.SS1.p3.12.m4.1"><semantics id="S4.SS1.p3.12.m4.1a"><msub id="S4.SS1.p3.12.m4.1.1" xref="S4.SS1.p3.12.m4.1.1.cmml"><mi id="S4.SS1.p3.12.m4.1.1.2" xref="S4.SS1.p3.12.m4.1.1.2.cmml">d</mi><mrow id="S4.SS1.p3.12.m4.1.1.3" xref="S4.SS1.p3.12.m4.1.1.3.cmml"><mi id="S4.SS1.p3.12.m4.1.1.3.2" xref="S4.SS1.p3.12.m4.1.1.3.2.cmml">r</mi><mo id="S4.SS1.p3.12.m4.1.1.3.1" xref="S4.SS1.p3.12.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.12.m4.1.1.3.3" xref="S4.SS1.p3.12.m4.1.1.3.3.cmml">e</mi><mo id="S4.SS1.p3.12.m4.1.1.3.1a" xref="S4.SS1.p3.12.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.12.m4.1.1.3.4" xref="S4.SS1.p3.12.m4.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.12.m4.1b"><apply id="S4.SS1.p3.12.m4.1.1.cmml" xref="S4.SS1.p3.12.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m4.1.1.1.cmml" xref="S4.SS1.p3.12.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.12.m4.1.1.2.cmml" xref="S4.SS1.p3.12.m4.1.1.2">𝑑</ci><apply id="S4.SS1.p3.12.m4.1.1.3.cmml" xref="S4.SS1.p3.12.m4.1.1.3"><times id="S4.SS1.p3.12.m4.1.1.3.1.cmml" xref="S4.SS1.p3.12.m4.1.1.3.1"></times><ci id="S4.SS1.p3.12.m4.1.1.3.2.cmml" xref="S4.SS1.p3.12.m4.1.1.3.2">𝑟</ci><ci id="S4.SS1.p3.12.m4.1.1.3.3.cmml" xref="S4.SS1.p3.12.m4.1.1.3.3">𝑒</ci><ci id="S4.SS1.p3.12.m4.1.1.3.4.cmml" xref="S4.SS1.p3.12.m4.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.12.m4.1c">d_{res}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.12.m4.1d">italic_d start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="linear\_proj(\cdot)" class="ltx_Math" display="inline" id="S4.SS1.p3.13.m5.1"><semantics id="S4.SS1.p3.13.m5.1a"><mrow id="S4.SS1.p3.13.m5.1.2" xref="S4.SS1.p3.13.m5.1.2.cmml"><mi id="S4.SS1.p3.13.m5.1.2.2" xref="S4.SS1.p3.13.m5.1.2.2.cmml">l</mi><mo id="S4.SS1.p3.13.m5.1.2.1" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.3" xref="S4.SS1.p3.13.m5.1.2.3.cmml">i</mi><mo id="S4.SS1.p3.13.m5.1.2.1a" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.4" xref="S4.SS1.p3.13.m5.1.2.4.cmml">n</mi><mo id="S4.SS1.p3.13.m5.1.2.1b" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.5" xref="S4.SS1.p3.13.m5.1.2.5.cmml">e</mi><mo id="S4.SS1.p3.13.m5.1.2.1c" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.6" xref="S4.SS1.p3.13.m5.1.2.6.cmml">a</mi><mo id="S4.SS1.p3.13.m5.1.2.1d" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.7" xref="S4.SS1.p3.13.m5.1.2.7.cmml">r</mi><mo id="S4.SS1.p3.13.m5.1.2.1e" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.8" mathvariant="normal" xref="S4.SS1.p3.13.m5.1.2.8.cmml">_</mi><mo id="S4.SS1.p3.13.m5.1.2.1f" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.9" xref="S4.SS1.p3.13.m5.1.2.9.cmml">p</mi><mo id="S4.SS1.p3.13.m5.1.2.1g" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.10" xref="S4.SS1.p3.13.m5.1.2.10.cmml">r</mi><mo id="S4.SS1.p3.13.m5.1.2.1h" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.11" xref="S4.SS1.p3.13.m5.1.2.11.cmml">o</mi><mo id="S4.SS1.p3.13.m5.1.2.1i" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.13.m5.1.2.12" xref="S4.SS1.p3.13.m5.1.2.12.cmml">j</mi><mo id="S4.SS1.p3.13.m5.1.2.1j" xref="S4.SS1.p3.13.m5.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p3.13.m5.1.2.13.2" xref="S4.SS1.p3.13.m5.1.2.cmml"><mo id="S4.SS1.p3.13.m5.1.2.13.2.1" stretchy="false" xref="S4.SS1.p3.13.m5.1.2.cmml">(</mo><mo id="S4.SS1.p3.13.m5.1.1" lspace="0em" rspace="0em" xref="S4.SS1.p3.13.m5.1.1.cmml">⋅</mo><mo id="S4.SS1.p3.13.m5.1.2.13.2.2" stretchy="false" xref="S4.SS1.p3.13.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.13.m5.1b"><apply id="S4.SS1.p3.13.m5.1.2.cmml" xref="S4.SS1.p3.13.m5.1.2"><times id="S4.SS1.p3.13.m5.1.2.1.cmml" xref="S4.SS1.p3.13.m5.1.2.1"></times><ci id="S4.SS1.p3.13.m5.1.2.2.cmml" xref="S4.SS1.p3.13.m5.1.2.2">𝑙</ci><ci id="S4.SS1.p3.13.m5.1.2.3.cmml" xref="S4.SS1.p3.13.m5.1.2.3">𝑖</ci><ci id="S4.SS1.p3.13.m5.1.2.4.cmml" xref="S4.SS1.p3.13.m5.1.2.4">𝑛</ci><ci id="S4.SS1.p3.13.m5.1.2.5.cmml" xref="S4.SS1.p3.13.m5.1.2.5">𝑒</ci><ci id="S4.SS1.p3.13.m5.1.2.6.cmml" xref="S4.SS1.p3.13.m5.1.2.6">𝑎</ci><ci id="S4.SS1.p3.13.m5.1.2.7.cmml" xref="S4.SS1.p3.13.m5.1.2.7">𝑟</ci><ci id="S4.SS1.p3.13.m5.1.2.8.cmml" xref="S4.SS1.p3.13.m5.1.2.8">_</ci><ci id="S4.SS1.p3.13.m5.1.2.9.cmml" xref="S4.SS1.p3.13.m5.1.2.9">𝑝</ci><ci id="S4.SS1.p3.13.m5.1.2.10.cmml" xref="S4.SS1.p3.13.m5.1.2.10">𝑟</ci><ci id="S4.SS1.p3.13.m5.1.2.11.cmml" xref="S4.SS1.p3.13.m5.1.2.11">𝑜</ci><ci id="S4.SS1.p3.13.m5.1.2.12.cmml" xref="S4.SS1.p3.13.m5.1.2.12">𝑗</ci><ci id="S4.SS1.p3.13.m5.1.1.cmml" xref="S4.SS1.p3.13.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.13.m5.1c">linear\_proj(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.13.m5.1d">italic_l italic_i italic_n italic_e italic_a italic_r _ italic_p italic_r italic_o italic_j ( ⋅ )</annotation></semantics></math> denotes the operation of projecting each item embedding into the same dimension as the token embedding of LLM.
Finally, we equip the knowledge embedding <math alttext="\mathbf{h}^{u}" class="ltx_Math" display="inline" id="S4.SS1.p3.14.m6.1"><semantics id="S4.SS1.p3.14.m6.1a"><msup id="S4.SS1.p3.14.m6.1.1" xref="S4.SS1.p3.14.m6.1.1.cmml"><mi id="S4.SS1.p3.14.m6.1.1.2" xref="S4.SS1.p3.14.m6.1.1.2.cmml">𝐡</mi><mi id="S4.SS1.p3.14.m6.1.1.3" xref="S4.SS1.p3.14.m6.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.14.m6.1b"><apply id="S4.SS1.p3.14.m6.1.1.cmml" xref="S4.SS1.p3.14.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.14.m6.1.1.1.cmml" xref="S4.SS1.p3.14.m6.1.1">superscript</csymbol><ci id="S4.SS1.p3.14.m6.1.1.2.cmml" xref="S4.SS1.p3.14.m6.1.1.2">𝐡</ci><ci id="S4.SS1.p3.14.m6.1.1.3.cmml" xref="S4.SS1.p3.14.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.14.m6.1c">\mathbf{h}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.14.m6.1d">bold_h start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> with a group linear projection layer to generate the normalized interaction frequency vector, i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{g}}^{u}=softmax\left(\mathbf{W}_{gp}\mathbf{h}^{u}+\mathbf{b}_{gp%
}\right)," class="ltx_Math" display="block" id="S4.E2.m1.1"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><msup id="S4.E2.m1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E2.m1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.3.2.cmml"><mi id="S4.E2.m1.1.1.1.1.3.2.2" xref="S4.E2.m1.1.1.1.1.3.2.2.cmml">𝐠</mi><mo id="S4.E2.m1.1.1.1.1.3.2.1" xref="S4.E2.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E2.m1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.3.3.cmml">u</mi></msup><mo id="S4.E2.m1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.3.cmml">s</mi><mo id="S4.E2.m1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.4" xref="S4.E2.m1.1.1.1.1.1.4.cmml">o</mi><mo id="S4.E2.m1.1.1.1.1.1.2a" xref="S4.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.5" xref="S4.E2.m1.1.1.1.1.1.5.cmml">f</mi><mo id="S4.E2.m1.1.1.1.1.1.2b" xref="S4.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.6" xref="S4.E2.m1.1.1.1.1.1.6.cmml">t</mi><mo id="S4.E2.m1.1.1.1.1.1.2c" xref="S4.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.7" xref="S4.E2.m1.1.1.1.1.1.7.cmml">m</mi><mo id="S4.E2.m1.1.1.1.1.1.2d" xref="S4.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.8" xref="S4.E2.m1.1.1.1.1.1.8.cmml">a</mi><mo id="S4.E2.m1.1.1.1.1.1.2e" xref="S4.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.9" xref="S4.E2.m1.1.1.1.1.1.9.cmml">x</mi><mo id="S4.E2.m1.1.1.1.1.1.2f" xref="S4.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">g</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">p</mi></mrow></msub><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">𝐡</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">u</mi></msup></mrow><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.E2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">g</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">p</mi></mrow></msub></mrow><mo id="S4.E2.m1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><eq id="S4.E2.m1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.2"></eq><apply id="S4.E2.m1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E2.m1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.3.2"><ci id="S4.E2.m1.1.1.1.1.3.2.1.cmml" xref="S4.E2.m1.1.1.1.1.3.2.1">^</ci><ci id="S4.E2.m1.1.1.1.1.3.2.2.cmml" xref="S4.E2.m1.1.1.1.1.3.2.2">𝐠</ci></apply><ci id="S4.E2.m1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><times id="S4.E2.m1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.2"></times><ci id="S4.E2.m1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.3">𝑠</ci><ci id="S4.E2.m1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.1.1.1.1.1.4">𝑜</ci><ci id="S4.E2.m1.1.1.1.1.1.5.cmml" xref="S4.E2.m1.1.1.1.1.1.5">𝑓</ci><ci id="S4.E2.m1.1.1.1.1.1.6.cmml" xref="S4.E2.m1.1.1.1.1.1.6">𝑡</ci><ci id="S4.E2.m1.1.1.1.1.1.7.cmml" xref="S4.E2.m1.1.1.1.1.1.7">𝑚</ci><ci id="S4.E2.m1.1.1.1.1.1.8.cmml" xref="S4.E2.m1.1.1.1.1.1.8">𝑎</ci><ci id="S4.E2.m1.1.1.1.1.1.9.cmml" xref="S4.E2.m1.1.1.1.1.1.9">𝑥</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1"><plus id="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2"><times id="S4.E2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.2">𝐖</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3"><times id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.2">𝑔</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.3">𝑝</ci></apply></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2">𝐡</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3">𝑢</ci></apply></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.2">𝐛</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3"><times id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.2">𝑔</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.3">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\hat{\mathbf{g}}^{u}=softmax\left(\mathbf{W}_{gp}\mathbf{h}^{u}+\mathbf{b}_{gp%
}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.1d">over^ start_ARG bold_g end_ARG start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( bold_W start_POSTSUBSCRIPT italic_g italic_p end_POSTSUBSCRIPT bold_h start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT + bold_b start_POSTSUBSCRIPT italic_g italic_p end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.17">where <math alttext="\mathbf{W}_{gp}" class="ltx_Math" display="inline" id="S4.SS1.p3.15.m1.1"><semantics id="S4.SS1.p3.15.m1.1a"><msub id="S4.SS1.p3.15.m1.1.1" xref="S4.SS1.p3.15.m1.1.1.cmml"><mi id="S4.SS1.p3.15.m1.1.1.2" xref="S4.SS1.p3.15.m1.1.1.2.cmml">𝐖</mi><mrow id="S4.SS1.p3.15.m1.1.1.3" xref="S4.SS1.p3.15.m1.1.1.3.cmml"><mi id="S4.SS1.p3.15.m1.1.1.3.2" xref="S4.SS1.p3.15.m1.1.1.3.2.cmml">g</mi><mo id="S4.SS1.p3.15.m1.1.1.3.1" xref="S4.SS1.p3.15.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.15.m1.1.1.3.3" xref="S4.SS1.p3.15.m1.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.15.m1.1b"><apply id="S4.SS1.p3.15.m1.1.1.cmml" xref="S4.SS1.p3.15.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.15.m1.1.1.1.cmml" xref="S4.SS1.p3.15.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.15.m1.1.1.2.cmml" xref="S4.SS1.p3.15.m1.1.1.2">𝐖</ci><apply id="S4.SS1.p3.15.m1.1.1.3.cmml" xref="S4.SS1.p3.15.m1.1.1.3"><times id="S4.SS1.p3.15.m1.1.1.3.1.cmml" xref="S4.SS1.p3.15.m1.1.1.3.1"></times><ci id="S4.SS1.p3.15.m1.1.1.3.2.cmml" xref="S4.SS1.p3.15.m1.1.1.3.2">𝑔</ci><ci id="S4.SS1.p3.15.m1.1.1.3.3.cmml" xref="S4.SS1.p3.15.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.15.m1.1c">\mathbf{W}_{gp}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.15.m1.1d">bold_W start_POSTSUBSCRIPT italic_g italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}_{gp}" class="ltx_Math" display="inline" id="S4.SS1.p3.16.m2.1"><semantics id="S4.SS1.p3.16.m2.1a"><msub id="S4.SS1.p3.16.m2.1.1" xref="S4.SS1.p3.16.m2.1.1.cmml"><mi id="S4.SS1.p3.16.m2.1.1.2" xref="S4.SS1.p3.16.m2.1.1.2.cmml">𝐛</mi><mrow id="S4.SS1.p3.16.m2.1.1.3" xref="S4.SS1.p3.16.m2.1.1.3.cmml"><mi id="S4.SS1.p3.16.m2.1.1.3.2" xref="S4.SS1.p3.16.m2.1.1.3.2.cmml">g</mi><mo id="S4.SS1.p3.16.m2.1.1.3.1" xref="S4.SS1.p3.16.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.16.m2.1.1.3.3" xref="S4.SS1.p3.16.m2.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.16.m2.1b"><apply id="S4.SS1.p3.16.m2.1.1.cmml" xref="S4.SS1.p3.16.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.16.m2.1.1.1.cmml" xref="S4.SS1.p3.16.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.16.m2.1.1.2.cmml" xref="S4.SS1.p3.16.m2.1.1.2">𝐛</ci><apply id="S4.SS1.p3.16.m2.1.1.3.cmml" xref="S4.SS1.p3.16.m2.1.1.3"><times id="S4.SS1.p3.16.m2.1.1.3.1.cmml" xref="S4.SS1.p3.16.m2.1.1.3.1"></times><ci id="S4.SS1.p3.16.m2.1.1.3.2.cmml" xref="S4.SS1.p3.16.m2.1.1.3.2">𝑔</ci><ci id="S4.SS1.p3.16.m2.1.1.3.3.cmml" xref="S4.SS1.p3.16.m2.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.16.m2.1c">\mathbf{b}_{gp}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.16.m2.1d">bold_b start_POSTSUBSCRIPT italic_g italic_p end_POSTSUBSCRIPT</annotation></semantics></math> are the learnable weight matrix and vector, and <math alttext="softmax(\cdot)" class="ltx_Math" display="inline" id="S4.SS1.p3.17.m3.1"><semantics id="S4.SS1.p3.17.m3.1a"><mrow id="S4.SS1.p3.17.m3.1.2" xref="S4.SS1.p3.17.m3.1.2.cmml"><mi id="S4.SS1.p3.17.m3.1.2.2" xref="S4.SS1.p3.17.m3.1.2.2.cmml">s</mi><mo id="S4.SS1.p3.17.m3.1.2.1" xref="S4.SS1.p3.17.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.17.m3.1.2.3" xref="S4.SS1.p3.17.m3.1.2.3.cmml">o</mi><mo id="S4.SS1.p3.17.m3.1.2.1a" xref="S4.SS1.p3.17.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.17.m3.1.2.4" xref="S4.SS1.p3.17.m3.1.2.4.cmml">f</mi><mo id="S4.SS1.p3.17.m3.1.2.1b" xref="S4.SS1.p3.17.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.17.m3.1.2.5" xref="S4.SS1.p3.17.m3.1.2.5.cmml">t</mi><mo id="S4.SS1.p3.17.m3.1.2.1c" xref="S4.SS1.p3.17.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.17.m3.1.2.6" xref="S4.SS1.p3.17.m3.1.2.6.cmml">m</mi><mo id="S4.SS1.p3.17.m3.1.2.1d" xref="S4.SS1.p3.17.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.17.m3.1.2.7" xref="S4.SS1.p3.17.m3.1.2.7.cmml">a</mi><mo id="S4.SS1.p3.17.m3.1.2.1e" xref="S4.SS1.p3.17.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p3.17.m3.1.2.8" xref="S4.SS1.p3.17.m3.1.2.8.cmml">x</mi><mo id="S4.SS1.p3.17.m3.1.2.1f" xref="S4.SS1.p3.17.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p3.17.m3.1.2.9.2" xref="S4.SS1.p3.17.m3.1.2.cmml"><mo id="S4.SS1.p3.17.m3.1.2.9.2.1" stretchy="false" xref="S4.SS1.p3.17.m3.1.2.cmml">(</mo><mo id="S4.SS1.p3.17.m3.1.1" lspace="0em" rspace="0em" xref="S4.SS1.p3.17.m3.1.1.cmml">⋅</mo><mo id="S4.SS1.p3.17.m3.1.2.9.2.2" stretchy="false" xref="S4.SS1.p3.17.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.17.m3.1b"><apply id="S4.SS1.p3.17.m3.1.2.cmml" xref="S4.SS1.p3.17.m3.1.2"><times id="S4.SS1.p3.17.m3.1.2.1.cmml" xref="S4.SS1.p3.17.m3.1.2.1"></times><ci id="S4.SS1.p3.17.m3.1.2.2.cmml" xref="S4.SS1.p3.17.m3.1.2.2">𝑠</ci><ci id="S4.SS1.p3.17.m3.1.2.3.cmml" xref="S4.SS1.p3.17.m3.1.2.3">𝑜</ci><ci id="S4.SS1.p3.17.m3.1.2.4.cmml" xref="S4.SS1.p3.17.m3.1.2.4">𝑓</ci><ci id="S4.SS1.p3.17.m3.1.2.5.cmml" xref="S4.SS1.p3.17.m3.1.2.5">𝑡</ci><ci id="S4.SS1.p3.17.m3.1.2.6.cmml" xref="S4.SS1.p3.17.m3.1.2.6">𝑚</ci><ci id="S4.SS1.p3.17.m3.1.2.7.cmml" xref="S4.SS1.p3.17.m3.1.2.7">𝑎</ci><ci id="S4.SS1.p3.17.m3.1.2.8.cmml" xref="S4.SS1.p3.17.m3.1.2.8">𝑥</ci><ci id="S4.SS1.p3.17.m3.1.1.cmml" xref="S4.SS1.p3.17.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.17.m3.1c">softmax(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.17.m3.1d">italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( ⋅ )</annotation></semantics></math> is the softmax operation.
We use the mean squared error as a constraint to force the LLM to reconstruct the target better and adopt LoRA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib11" title="">2021</a>)</cite> as the fine-tuning paradigm.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{SFT}=\sum_{u=1}^{M}\sum_{i=1}^{K}(\overline{\mathbf{g}}^{u}_{i}-%
\hat{\mathbf{g}}^{u}_{i})^{2}." class="ltx_Math" display="block" id="S4.E3.m1.1"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><msub id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E3.m1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.3.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.3.2" xref="S4.E3.m1.1.1.1.1.3.3.2.cmml">S</mi><mo id="S4.E3.m1.1.1.1.1.3.3.1" xref="S4.E3.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.3.3.3" xref="S4.E3.m1.1.1.1.1.3.3.3.cmml">F</mi><mo id="S4.E3.m1.1.1.1.1.3.3.1a" xref="S4.E3.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.3.3.4" xref="S4.E3.m1.1.1.1.1.3.3.4.cmml">T</mi></mrow></msub><mo id="S4.E3.m1.1.1.1.1.2" rspace="0.111em" xref="S4.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.cmml"><munderover id="S4.E3.m1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.2.cmml"><mo id="S4.E3.m1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E3.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E3.m1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.2.2.3.2" xref="S4.E3.m1.1.1.1.1.1.2.2.3.2.cmml">u</mi><mo id="S4.E3.m1.1.1.1.1.1.2.2.3.1" xref="S4.E3.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E3.m1.1.1.1.1.1.2.2.3.3" xref="S4.E3.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E3.m1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.2.3.cmml">M</mi></munderover><mrow id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><munderover id="S4.E3.m1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.E3.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E3.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.2.2.3.2" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E3.m1.1.1.1.1.1.1.2.2.3.1" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E3.m1.1.1.1.1.1.1.2.2.3.3" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E3.m1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.2.3.cmml">K</mi></munderover><msup id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐠</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">¯</mo></mover><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">𝐠</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">u</mi></msubsup></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S4.E3.m1.1.1.1.2" lspace="0em" xref="S4.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><eq id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"></eq><apply id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E3.m1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3"><times id="S4.E3.m1.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.3.1"></times><ci id="S4.E3.m1.1.1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.3.2">𝑆</ci><ci id="S4.E3.m1.1.1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3">𝐹</ci><ci id="S4.E3.m1.1.1.1.1.3.3.4.cmml" xref="S4.E3.m1.1.1.1.1.3.3.4">𝑇</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><apply id="S4.E3.m1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E3.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E3.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.2.2.3"><eq id="S4.E3.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E3.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.2.2.3.2">𝑢</ci><cn id="S4.E3.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E3.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E3.m1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1"><apply id="S4.E3.m1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3"><eq id="S4.E3.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E3.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E3.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.1">¯</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐠</ci></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑢</ci></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝐠</ci></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑢</ci></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><cn id="S4.E3.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E3.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\mathcal{L}_{SFT}=\sum_{u=1}^{M}\sum_{i=1}^{K}(\overline{\mathbf{g}}^{u}_{i}-%
\hat{\mathbf{g}}^{u}_{i})^{2}.</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_S italic_F italic_T end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_u = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ( over¯ start_ARG bold_g end_ARG start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over^ start_ARG bold_g end_ARG start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Information Augmentation Stage</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.5">To accurately reconstruct the normalized frequency interaction vector <math alttext="\overline{\mathbf{g}}^{u}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.2.2.cmml">𝐠</mi><mo id="S4.SS2.p1.1.m1.1.1.2.1" xref="S4.SS2.p1.1.m1.1.1.2.1.cmml">¯</mo></mover><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"><ci id="S4.SS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.2.1">¯</ci><ci id="S4.SS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2.2">𝐠</ci></apply><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\overline{\mathbf{g}}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">over¯ start_ARG bold_g end_ARG start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, LLM must try to infer the latent category to which each item belongs.
With the power of LLM, we expect it to recognize the reasonable part of the pre-grouping results (i.e., give the same latent category) and correct the unreasonable part (i.e., provide different latent categories).
The knowledge-enhanced embeddings associated with this inference process will then likely better characterize each item’s properties and the connections between different items.
Next, we describe using the LLM trained with SFT to obtain knowledge-enhanced embeddings and inferred latent categories for each item.
Specifically, this can be easily achieved by replacing the user interaction sequence <math alttext="\mathcal{S}^{u}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><msup id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">𝒮</mi><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝒮</ci><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mathcal{S}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">caligraphic_S start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> in the previous stage with each item ID <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><msub id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">v</mi><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑣</ci><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as <math alttext="d_{ids}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><msub id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">d</mi><mrow id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.3.2.cmml">i</mi><mo id="S4.SS2.p1.4.m4.1.1.3.1" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.3.3" xref="S4.SS2.p1.4.m4.1.1.3.3.cmml">d</mi><mo id="S4.SS2.p1.4.m4.1.1.3.1a" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.3.4" xref="S4.SS2.p1.4.m4.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝑑</ci><apply id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3"><times id="S4.SS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.1"></times><ci id="S4.SS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2">𝑖</ci><ci id="S4.SS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3">𝑑</ci><ci id="S4.SS2.p1.4.m4.1.1.3.4.cmml" xref="S4.SS2.p1.4.m4.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">d_{ids}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_i italic_d italic_s end_POSTSUBSCRIPT</annotation></semantics></math> in turn.
This can also be viewed as there are <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_N</annotation></semantics></math> virtual user interaction sequences, each of which includes only one item.
In this case, the embedding obtained by Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S4.E1" title="In 4.1. Information Reconstruction Stage ‣ 4. The Proposed Framework ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>) will be regarded as the knowledge-enhanced embedding of each item, and the vector obtained by Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S4.E2" title="In 4.1. Information Reconstruction Stage ‣ 4. The Proposed Framework ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>) reflects the latent category probability distribution of each item.
Finally, these knowledge-enhanced embeddings can be directly used to train various future SRS models.
To demonstrate the effectiveness of our TSLRec, especially the knowledge-enhanced embeddings obtained, in our experiments, we adopt a simple gating mechanism to combine them with randomly initialized item embeddings of a new backbone SRS model to represent each item and use them for subsequent training.
We leave exploring more diverse fusion methods as future work, and an example of this stage can be found on the right side of Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S4.F2" title="Figure 2 ‣ 4. The Proposed Framework ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experiment Settings</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.3"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.3.1">Dataset and Evaluation Metrics.</span>
To evaluate the effectiveness of our TLSRec, following the setup of previous works <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib16" title="">2023a</a>; Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib24" title="">2024</a>)</cite>, we select three public benchmark datasets in our experiments: Beauty, MovieLens-1M, and Yelp<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/RUCAIBox/RecSysDatasets</span></span></span>, and use the last interactive item, the penultimate item, and the remaining ones of each user for testing, validation, and training.
We summarize the statistics of the three processed datasets in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.T1" title="Table 1 ‣ 5.1. Experiment Settings ‣ 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.
Two widely used evaluation metrics will be adopted: hit ratio (HR@<math alttext="k" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mi id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><ci id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">italic_k</annotation></semantics></math>) and normalized discounted cumulative gain (NDCG@<math alttext="k" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><ci id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">italic_k</annotation></semantics></math>).
We report the average metrics for all users in the testing set, where <math alttext="k" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mi id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><ci id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">italic_k</annotation></semantics></math> is set to 5 and 10, respectively.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of the processed datasets.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.1" style="width:433.6pt;height:89.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(42.5pt,-8.8pt) scale(1.24374918840167,1.24374918840167) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T1.1.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1.2">#Users</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1.3">#Items</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1.4">#Interactions</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1.5">Density</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1.6">Avg.Length</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.1.1.2.1.1">Beauty</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.1.2">22,363</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.1.3">12,101</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.1.4">198,502</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.1.5">0.07%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.1.6">8.9</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T1.1.1.3.2.1">MovieLens-1M</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.2.2">6,040</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.2.3">3,416</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.2.4">999,611</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.2.5">4.84%</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.2.6">165.5</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T1.1.1.4.3.1">Yelp</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.4.3.2">30,431</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.4.3.3">20,033</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.4.3.4">316,354</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.4.3.5">0.05%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.4.3.6">10.4</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Results on all datasets, where the best and second best results are marked in bold and underlined, respectively. Note that <sup class="ltx_sup" id="S5.T2.22.1"><span class="ltx_text ltx_font_italic" id="S5.T2.22.1.1">∗</span></sup> indicates a significance level of <math alttext="p\leq 0.05" class="ltx_Math" display="inline" id="S5.T2.4.m2.1"><semantics id="S5.T2.4.m2.1b"><mrow id="S5.T2.4.m2.1.1" xref="S5.T2.4.m2.1.1.cmml"><mi id="S5.T2.4.m2.1.1.2" xref="S5.T2.4.m2.1.1.2.cmml">p</mi><mo id="S5.T2.4.m2.1.1.1" xref="S5.T2.4.m2.1.1.1.cmml">≤</mo><mn id="S5.T2.4.m2.1.1.3" xref="S5.T2.4.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.4.m2.1c"><apply id="S5.T2.4.m2.1.1.cmml" xref="S5.T2.4.m2.1.1"><leq id="S5.T2.4.m2.1.1.1.cmml" xref="S5.T2.4.m2.1.1.1"></leq><ci id="S5.T2.4.m2.1.1.2.cmml" xref="S5.T2.4.m2.1.1.2">𝑝</ci><cn id="S5.T2.4.m2.1.1.3.cmml" type="float" xref="S5.T2.4.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.m2.1d">p\leq 0.05</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.m2.1e">italic_p ≤ 0.05</annotation></semantics></math> based on a two-sample t-test between our method and the best baseline.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.20" style="width:433.6pt;height:224.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-95.5pt,49.5pt) scale(0.694222627160911,0.694222627160911) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.20.16">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.20.16.17.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.20.16.17.1.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.20.16.17.1.2" rowspan="2"><span class="ltx_text" id="S5.T2.20.16.17.1.2.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T2.20.16.17.1.3">Beauty</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="4" id="S5.T2.20.16.17.1.4">MovieLens-1M</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="4" id="S5.T2.20.16.17.1.5">Yelp</td>
</tr>
<tr class="ltx_tr" id="S5.T2.10.6.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S5.T2.10.6.6.7"></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T2.5.1.1.1">HR@{5,10}<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.5.1.1.1.m1.1"><semantics id="S5.T2.5.1.1.1.m1.1a"><mo id="S5.T2.5.1.1.1.m1.1.1" stretchy="false" xref="S5.T2.5.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.1.1.1.m1.1b"><ci id="S5.T2.5.1.1.1.m1.1.1.cmml" xref="S5.T2.5.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T2.6.2.2.2">NDCG@{5,10}<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.6.2.2.2.m1.1"><semantics id="S5.T2.6.2.2.2.m1.1a"><mo id="S5.T2.6.2.2.2.m1.1.1" stretchy="false" xref="S5.T2.6.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.2.2.2.m1.1b"><ci id="S5.T2.6.2.2.2.m1.1.1.cmml" xref="S5.T2.6.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T2.7.3.3.3">HR@{5,10}<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.7.3.3.3.m1.1"><semantics id="S5.T2.7.3.3.3.m1.1a"><mo id="S5.T2.7.3.3.3.m1.1.1" stretchy="false" xref="S5.T2.7.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.3.3.3.m1.1b"><ci id="S5.T2.7.3.3.3.m1.1.1.cmml" xref="S5.T2.7.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T2.8.4.4.4">NDCG@{5,10}<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.8.4.4.4.m1.1"><semantics id="S5.T2.8.4.4.4.m1.1a"><mo id="S5.T2.8.4.4.4.m1.1.1" stretchy="false" xref="S5.T2.8.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.4.4.4.m1.1b"><ci id="S5.T2.8.4.4.4.m1.1.1.cmml" xref="S5.T2.8.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.8.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T2.9.5.5.5">HR@{5,10}<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.9.5.5.5.m1.1"><semantics id="S5.T2.9.5.5.5.m1.1a"><mo id="S5.T2.9.5.5.5.m1.1.1" stretchy="false" xref="S5.T2.9.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.5.5.5.m1.1b"><ci id="S5.T2.9.5.5.5.m1.1.1.cmml" xref="S5.T2.9.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.9.5.5.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T2.10.6.6.6">NDCG@{5,10}<math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.T2.10.6.6.6.m1.1"><semantics id="S5.T2.10.6.6.6.m1.1a"><mo id="S5.T2.10.6.6.6.m1.1.1" stretchy="false" xref="S5.T2.10.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.6.6.6.m1.1b"><ci id="S5.T2.10.6.6.6.m1.1.1.cmml" xref="S5.T2.10.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.T2.10.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.18.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.20.16.18.2.1" rowspan="4"><span class="ltx_text" id="S5.T2.20.16.18.2.1.1">LLM</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.20.16.18.2.2">POD</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.3">0.0185</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.4">0.0245</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.5">0.0125</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.16.18.2.6">0.0146</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.7">0.0422</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.8">0.0528</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.9">0.0291</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.16.18.2.10">0.0326</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.11">0.0476</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.12">0.0564</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.13">0.0330</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.18.2.14">0.0358</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.19.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.19.3.1">P5</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.2">0.0569</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.3">0.0791</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.4">0.0403</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.19.3.5">0.0474</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.6">0.2225</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.7">0.3131</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.8">0.1570</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.19.3.9">0.1861</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.10">0.0289</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.11">0.0453</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.12">0.0200</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.19.3.13">0.0252</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.20.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.20.4.1">LlamaRec</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.20.4.2.1">0.0591</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.20.4.3.1">0.0862</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.20.4.4.1">0.0405</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.20.4.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.20.4.5.1">0.0492</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.6">0.1757</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.7">0.2836</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.8">0.1113</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.20.4.9">0.1461</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.10">0.0416</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.11">0.0605</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.12">0.0306</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.20.4.13">0.0367</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.21.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.21.5.1">E4SRec</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.2">0.0527</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.3">0.0753</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.4">0.0376</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.21.5.5">0.0448</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.6">0.1871</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.7">0.2765</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.8">0.1234</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.21.5.9">0.1522</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.10">0.0309</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.11">0.0473</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.12">0.0207</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.21.5.13">0.0260</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.22.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.20.16.22.6.1" rowspan="3"><span class="ltx_text" id="S5.T2.20.16.22.6.1.1">GRU4Rec</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.20.16.22.6.2">+Base</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.3">0.0369</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.4">0.0590</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.5">0.0267</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.20.16.22.6.6">0.0329</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.7">0.2126</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.8">0.2912</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.9">0.1451</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.20.16.22.6.10">0.1703</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.11">0.0201</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.12">0.0365</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.13">0.0129</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.20.16.22.6.14">0.0182</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.23.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.23.7.1">+CI</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.2">0.0415</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.3">0.0603</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.4">0.0274</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.23.7.5">0.0335</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.6">0.2131</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.7">0.2957</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.8">0.1467</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.23.7.9">0.1734</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.10">0.0224</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.11">0.0368</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.12">0.0143</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.23.7.13">0.0189</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.24.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.24.8.1">+TSLRec</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.2">0.0442</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.3">0.0648</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.4">0.0299</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.24.8.5">0.0366</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.6">0.2147</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.7">0.3020</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.8">0.1498</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.24.8.9">0.1781</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.10">0.0242</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.11">0.0391</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.12">0.0152</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.24.8.13">0.0200</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.25.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.20.16.25.9.1" rowspan="3"><span class="ltx_text" id="S5.T2.20.16.25.9.1.1">Caser</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.20.16.25.9.2">+Base</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.3">0.0259</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.4">0.0429</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.5">0.0162</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.16.25.9.6">0.0217</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.7">0.1902</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.8">0.2700</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.9">0.1282</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.16.25.9.10">0.1539</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.11">0.0181</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.12">0.0325</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.13">0.0113</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.25.9.14">0.0159</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.26.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.26.10.1">+CI</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.2">0.0264</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.3">0.0433</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.4">0.0169</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.26.10.5">0.0223</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.6">0.1894</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.7">0.2722</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.8">0.1293</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.26.10.9">0.1558</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.10">0.0192</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.11">0.0350</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.12">0.0120</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.26.10.13">0.0166</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.27.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.27.11.1">+TSLRec</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.2">0.0300</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.3">0.0494</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.4">0.0187</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.27.11.5">0.0249</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.6">0.1949</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.7">0.2762</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.8">0.1331</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.27.11.9">0.1593</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.10">0.0215</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.11">0.0366</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.12">0.0135</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.27.11.13">0.0183</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.28.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.20.16.28.12.1" rowspan="3"><span class="ltx_text" id="S5.T2.20.16.28.12.1.1">SASRec</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.20.16.28.12.2">+Base</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.3">0.0551</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.4">0.0846</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.5">0.0329</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.16.28.12.6">0.0424</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.28.12.7.1">0.2364</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.8">0.3217</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.28.12.9.1">0.1631</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.16.28.12.10">0.1907</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.11">0.0449</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.12">0.0637</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.13">0.0334</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.28.12.14">0.0394</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.29.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.29.13.1">+CI</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.2">0.0569</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.3">0.0836</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.4">0.0354</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.29.13.5">0.0440</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.6">0.2315</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.29.13.7.1">0.3257</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.8">0.1619</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.29.13.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.29.13.9.1">0.1924</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.10">0.0467</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.11">0.0667</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.12">0.0344</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.29.13.13">0.0408</td>
</tr>
<tr class="ltx_tr" id="S5.T2.14.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.14.10.10.5">+TSLRec</th>
<td class="ltx_td ltx_align_center" id="S5.T2.14.10.10.6">0.0585</td>
<td class="ltx_td ltx_align_center" id="S5.T2.14.10.10.7">0.0854</td>
<td class="ltx_td ltx_align_center" id="S5.T2.14.10.10.8">0.0371</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.14.10.10.9">0.0458</td>
<td class="ltx_td ltx_align_center" id="S5.T2.11.7.7.1"><math alttext="\textbf{0.2404}^{*}" class="ltx_Math" display="inline" id="S5.T2.11.7.7.1.m1.1"><semantics id="S5.T2.11.7.7.1.m1.1a"><msup id="S5.T2.11.7.7.1.m1.1.1" xref="S5.T2.11.7.7.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.11.7.7.1.m1.1.1.2" xref="S5.T2.11.7.7.1.m1.1.1.2a.cmml">0.2404</mtext><mo id="S5.T2.11.7.7.1.m1.1.1.3" xref="S5.T2.11.7.7.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.11.7.7.1.m1.1b"><apply id="S5.T2.11.7.7.1.m1.1.1.cmml" xref="S5.T2.11.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.11.7.7.1.m1.1.1.1.cmml" xref="S5.T2.11.7.7.1.m1.1.1">superscript</csymbol><ci id="S5.T2.11.7.7.1.m1.1.1.2a.cmml" xref="S5.T2.11.7.7.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.11.7.7.1.m1.1.1.2.cmml" xref="S5.T2.11.7.7.1.m1.1.1.2">0.2404</mtext></ci><times id="S5.T2.11.7.7.1.m1.1.1.3.cmml" xref="S5.T2.11.7.7.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.7.7.1.m1.1c">\textbf{0.2404}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.11.7.7.1.m1.1d">0.2404 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T2.12.8.8.2"><math alttext="\textbf{0.3315}^{*}" class="ltx_Math" display="inline" id="S5.T2.12.8.8.2.m1.1"><semantics id="S5.T2.12.8.8.2.m1.1a"><msup id="S5.T2.12.8.8.2.m1.1.1" xref="S5.T2.12.8.8.2.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.12.8.8.2.m1.1.1.2" xref="S5.T2.12.8.8.2.m1.1.1.2a.cmml">0.3315</mtext><mo id="S5.T2.12.8.8.2.m1.1.1.3" xref="S5.T2.12.8.8.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.12.8.8.2.m1.1b"><apply id="S5.T2.12.8.8.2.m1.1.1.cmml" xref="S5.T2.12.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.12.8.8.2.m1.1.1.1.cmml" xref="S5.T2.12.8.8.2.m1.1.1">superscript</csymbol><ci id="S5.T2.12.8.8.2.m1.1.1.2a.cmml" xref="S5.T2.12.8.8.2.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.12.8.8.2.m1.1.1.2.cmml" xref="S5.T2.12.8.8.2.m1.1.1.2">0.3315</mtext></ci><times id="S5.T2.12.8.8.2.m1.1.1.3.cmml" xref="S5.T2.12.8.8.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.8.8.2.m1.1c">\textbf{0.3315}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.12.8.8.2.m1.1d">0.3315 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T2.13.9.9.3"><math alttext="\textbf{0.1670}^{*}" class="ltx_Math" display="inline" id="S5.T2.13.9.9.3.m1.1"><semantics id="S5.T2.13.9.9.3.m1.1a"><msup id="S5.T2.13.9.9.3.m1.1.1" xref="S5.T2.13.9.9.3.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.13.9.9.3.m1.1.1.2" xref="S5.T2.13.9.9.3.m1.1.1.2a.cmml">0.1670</mtext><mo id="S5.T2.13.9.9.3.m1.1.1.3" xref="S5.T2.13.9.9.3.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.13.9.9.3.m1.1b"><apply id="S5.T2.13.9.9.3.m1.1.1.cmml" xref="S5.T2.13.9.9.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.13.9.9.3.m1.1.1.1.cmml" xref="S5.T2.13.9.9.3.m1.1.1">superscript</csymbol><ci id="S5.T2.13.9.9.3.m1.1.1.2a.cmml" xref="S5.T2.13.9.9.3.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.13.9.9.3.m1.1.1.2.cmml" xref="S5.T2.13.9.9.3.m1.1.1.2">0.1670</mtext></ci><times id="S5.T2.13.9.9.3.m1.1.1.3.cmml" xref="S5.T2.13.9.9.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.9.9.3.m1.1c">\textbf{0.1670}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.13.9.9.3.m1.1d">0.1670 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.14.10.10.4"><math alttext="\textbf{0.1965}^{*}" class="ltx_Math" display="inline" id="S5.T2.14.10.10.4.m1.1"><semantics id="S5.T2.14.10.10.4.m1.1a"><msup id="S5.T2.14.10.10.4.m1.1.1" xref="S5.T2.14.10.10.4.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.14.10.10.4.m1.1.1.2" xref="S5.T2.14.10.10.4.m1.1.1.2a.cmml">0.1965</mtext><mo id="S5.T2.14.10.10.4.m1.1.1.3" xref="S5.T2.14.10.10.4.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.14.10.10.4.m1.1b"><apply id="S5.T2.14.10.10.4.m1.1.1.cmml" xref="S5.T2.14.10.10.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.14.10.10.4.m1.1.1.1.cmml" xref="S5.T2.14.10.10.4.m1.1.1">superscript</csymbol><ci id="S5.T2.14.10.10.4.m1.1.1.2a.cmml" xref="S5.T2.14.10.10.4.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.14.10.10.4.m1.1.1.2.cmml" xref="S5.T2.14.10.10.4.m1.1.1.2">0.1965</mtext></ci><times id="S5.T2.14.10.10.4.m1.1.1.3.cmml" xref="S5.T2.14.10.10.4.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.10.10.4.m1.1c">\textbf{0.1965}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.14.10.10.4.m1.1d">0.1965 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T2.14.10.10.10">0.0475</td>
<td class="ltx_td ltx_align_center" id="S5.T2.14.10.10.11">0.0685</td>
<td class="ltx_td ltx_align_center" id="S5.T2.14.10.10.12">0.0346</td>
<td class="ltx_td ltx_align_center" id="S5.T2.14.10.10.13">0.0414</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.30.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.20.16.30.14.1" rowspan="3"><span class="ltx_text" id="S5.T2.20.16.30.14.1.1">FMLP-Rec</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.20.16.30.14.2">+Base</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.3">0.0577</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.4">0.0866</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.5">0.0361</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.16.30.14.6">0.0455</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.7">0.2230</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.8">0.3172</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.9">0.1545</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.16.30.14.10">0.1848</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.11">0.0491</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.12">0.0698</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.13">0.0356</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.20.16.30.14.14">0.0422</td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.31.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.16.31.15.1">+CI</th>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.2">0.0575</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.3"><span class="ltx_text ltx_font_bold" id="S5.T2.20.16.31.15.3.1">0.0868</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.4">0.0365</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.31.15.5">0.0459</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.6">0.2273</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.7">0.3123</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.8">0.1586</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.20.16.31.15.9">0.1861</td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.31.15.10.1">0.0511</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.31.15.11.1">0.0743</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.31.15.12.1">0.0365</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.20.16.31.15.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.20.16.31.15.13.1">0.0439</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T2.20.16.16.7">+TSLRec</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.15.11.11.1"><math alttext="\textbf{0.0604}^{*}" class="ltx_Math" display="inline" id="S5.T2.15.11.11.1.m1.1"><semantics id="S5.T2.15.11.11.1.m1.1a"><msup id="S5.T2.15.11.11.1.m1.1.1" xref="S5.T2.15.11.11.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.15.11.11.1.m1.1.1.2" xref="S5.T2.15.11.11.1.m1.1.1.2a.cmml">0.0604</mtext><mo id="S5.T2.15.11.11.1.m1.1.1.3" xref="S5.T2.15.11.11.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.15.11.11.1.m1.1b"><apply id="S5.T2.15.11.11.1.m1.1.1.cmml" xref="S5.T2.15.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.15.11.11.1.m1.1.1.1.cmml" xref="S5.T2.15.11.11.1.m1.1.1">superscript</csymbol><ci id="S5.T2.15.11.11.1.m1.1.1.2a.cmml" xref="S5.T2.15.11.11.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.15.11.11.1.m1.1.1.2.cmml" xref="S5.T2.15.11.11.1.m1.1.1.2">0.0604</mtext></ci><times id="S5.T2.15.11.11.1.m1.1.1.3.cmml" xref="S5.T2.15.11.11.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.11.11.1.m1.1c">\textbf{0.0604}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.15.11.11.1.m1.1d">0.0604 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.20.16.16.8">0.0852</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.16.12.12.2"><math alttext="\textbf{0.0445}^{*}" class="ltx_Math" display="inline" id="S5.T2.16.12.12.2.m1.1"><semantics id="S5.T2.16.12.12.2.m1.1a"><msup id="S5.T2.16.12.12.2.m1.1.1" xref="S5.T2.16.12.12.2.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.16.12.12.2.m1.1.1.2" xref="S5.T2.16.12.12.2.m1.1.1.2a.cmml">0.0445</mtext><mo id="S5.T2.16.12.12.2.m1.1.1.3" xref="S5.T2.16.12.12.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.16.12.12.2.m1.1b"><apply id="S5.T2.16.12.12.2.m1.1.1.cmml" xref="S5.T2.16.12.12.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.16.12.12.2.m1.1.1.1.cmml" xref="S5.T2.16.12.12.2.m1.1.1">superscript</csymbol><ci id="S5.T2.16.12.12.2.m1.1.1.2a.cmml" xref="S5.T2.16.12.12.2.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.16.12.12.2.m1.1.1.2.cmml" xref="S5.T2.16.12.12.2.m1.1.1.2">0.0445</mtext></ci><times id="S5.T2.16.12.12.2.m1.1.1.3.cmml" xref="S5.T2.16.12.12.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.12.12.2.m1.1c">\textbf{0.0445}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.16.12.12.2.m1.1d">0.0445 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.17.13.13.3"><math alttext="\textbf{0.0509}^{*}" class="ltx_Math" display="inline" id="S5.T2.17.13.13.3.m1.1"><semantics id="S5.T2.17.13.13.3.m1.1a"><msup id="S5.T2.17.13.13.3.m1.1.1" xref="S5.T2.17.13.13.3.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.17.13.13.3.m1.1.1.2" xref="S5.T2.17.13.13.3.m1.1.1.2a.cmml">0.0509</mtext><mo id="S5.T2.17.13.13.3.m1.1.1.3" xref="S5.T2.17.13.13.3.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.17.13.13.3.m1.1b"><apply id="S5.T2.17.13.13.3.m1.1.1.cmml" xref="S5.T2.17.13.13.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.17.13.13.3.m1.1.1.1.cmml" xref="S5.T2.17.13.13.3.m1.1.1">superscript</csymbol><ci id="S5.T2.17.13.13.3.m1.1.1.2a.cmml" xref="S5.T2.17.13.13.3.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.17.13.13.3.m1.1.1.2.cmml" xref="S5.T2.17.13.13.3.m1.1.1.2">0.0509</mtext></ci><times id="S5.T2.17.13.13.3.m1.1.1.3.cmml" xref="S5.T2.17.13.13.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.13.13.3.m1.1c">\textbf{0.0509}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.17.13.13.3.m1.1d">0.0509 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.20.16.16.9">0.2341</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.20.16.16.10">0.3192</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.20.16.16.11">0.1626</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.20.16.16.12">0.1901</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.18.14.14.4"><math alttext="\textbf{0.0531}^{*}" class="ltx_Math" display="inline" id="S5.T2.18.14.14.4.m1.1"><semantics id="S5.T2.18.14.14.4.m1.1a"><msup id="S5.T2.18.14.14.4.m1.1.1" xref="S5.T2.18.14.14.4.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.18.14.14.4.m1.1.1.2" xref="S5.T2.18.14.14.4.m1.1.1.2a.cmml">0.0531</mtext><mo id="S5.T2.18.14.14.4.m1.1.1.3" xref="S5.T2.18.14.14.4.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.18.14.14.4.m1.1b"><apply id="S5.T2.18.14.14.4.m1.1.1.cmml" xref="S5.T2.18.14.14.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.18.14.14.4.m1.1.1.1.cmml" xref="S5.T2.18.14.14.4.m1.1.1">superscript</csymbol><ci id="S5.T2.18.14.14.4.m1.1.1.2a.cmml" xref="S5.T2.18.14.14.4.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.18.14.14.4.m1.1.1.2.cmml" xref="S5.T2.18.14.14.4.m1.1.1.2">0.0531</mtext></ci><times id="S5.T2.18.14.14.4.m1.1.1.3.cmml" xref="S5.T2.18.14.14.4.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.14.14.4.m1.1c">\textbf{0.0531}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.18.14.14.4.m1.1d">0.0531 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.19.15.15.5"><math alttext="\textbf{0.0771}^{*}" class="ltx_Math" display="inline" id="S5.T2.19.15.15.5.m1.1"><semantics id="S5.T2.19.15.15.5.m1.1a"><msup id="S5.T2.19.15.15.5.m1.1.1" xref="S5.T2.19.15.15.5.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.19.15.15.5.m1.1.1.2" xref="S5.T2.19.15.15.5.m1.1.1.2a.cmml">0.0771</mtext><mo id="S5.T2.19.15.15.5.m1.1.1.3" xref="S5.T2.19.15.15.5.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.19.15.15.5.m1.1b"><apply id="S5.T2.19.15.15.5.m1.1.1.cmml" xref="S5.T2.19.15.15.5.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.19.15.15.5.m1.1.1.1.cmml" xref="S5.T2.19.15.15.5.m1.1.1">superscript</csymbol><ci id="S5.T2.19.15.15.5.m1.1.1.2a.cmml" xref="S5.T2.19.15.15.5.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.19.15.15.5.m1.1.1.2.cmml" xref="S5.T2.19.15.15.5.m1.1.1.2">0.0771</mtext></ci><times id="S5.T2.19.15.15.5.m1.1.1.3.cmml" xref="S5.T2.19.15.15.5.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.15.15.5.m1.1c">\textbf{0.0771}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.19.15.15.5.m1.1d">0.0771 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.20.16.16.13"><span class="ltx_text ltx_font_bold" id="S5.T2.20.16.16.13.1">0.0373</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.20.16.16.6"><math alttext="\textbf{0.0451}^{*}" class="ltx_Math" display="inline" id="S5.T2.20.16.16.6.m1.1"><semantics id="S5.T2.20.16.16.6.m1.1a"><msup id="S5.T2.20.16.16.6.m1.1.1" xref="S5.T2.20.16.16.6.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T2.20.16.16.6.m1.1.1.2" xref="S5.T2.20.16.16.6.m1.1.1.2a.cmml">0.0451</mtext><mo id="S5.T2.20.16.16.6.m1.1.1.3" xref="S5.T2.20.16.16.6.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T2.20.16.16.6.m1.1b"><apply id="S5.T2.20.16.16.6.m1.1.1.cmml" xref="S5.T2.20.16.16.6.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.20.16.16.6.m1.1.1.1.cmml" xref="S5.T2.20.16.16.6.m1.1.1">superscript</csymbol><ci id="S5.T2.20.16.16.6.m1.1.1.2a.cmml" xref="S5.T2.20.16.16.6.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T2.20.16.16.6.m1.1.1.2.cmml" xref="S5.T2.20.16.16.6.m1.1.1.2">0.0451</mtext></ci><times id="S5.T2.20.16.16.6.m1.1.1.3.cmml" xref="S5.T2.20.16.16.6.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.16.16.6.m1.1c">\textbf{0.0451}^{*}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.20.16.16.6.m1.1d">0.0451 start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Baselines and Implementation Details.</span>
We adopt four SRS methods with different representative architectures as backbone models to verify the compatibility of our TSLRec:
GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib10" title="">2016</a>)</cite>, Caser <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib22" title="">2018</a>)</cite>, SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib13" title="">2018</a>)</cite>, and FMLP-Rec <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib32" title="">2022</a>)</cite>.
We also select four typical LLM-enhanced methods for comparison: POD <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib14" title="">2023b</a>)</cite>, P5 <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib12" title="">2023</a>)</cite>, LlamaRec <cite class="ltx_cite ltx_citemacro_citep">(Yue et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib28" title="">2023</a>)</cite> and E4SRec <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib16" title="">2023a</a>)</cite>.
We adopt the implementation in the RecBole <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#bib.bib29" title="">2021</a>)</cite> framework for SRS baselines and their own open-source repositories for LLM-enhanced baselines.
Llama2-13B is taken as the backbone large language model.
For a fair comparison, we set the learning rate to <math alttext="1e^{-4}" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mrow id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><mn id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml">1</mn><mo id="S5.SS1.p2.1.m1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.cmml">⁢</mo><msup id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml"><mi id="S5.SS1.p2.1.m1.1.1.3.2" xref="S5.SS1.p2.1.m1.1.1.3.2.cmml">e</mi><mrow id="S5.SS1.p2.1.m1.1.1.3.3" xref="S5.SS1.p2.1.m1.1.1.3.3.cmml"><mo id="S5.SS1.p2.1.m1.1.1.3.3a" xref="S5.SS1.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p2.1.m1.1.1.3.3.2" xref="S5.SS1.p2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><times id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1"></times><cn id="S5.SS1.p2.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.p2.1.m1.1.1.2">1</cn><apply id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.3.1.cmml" xref="S5.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS1.p2.1.m1.1.1.3.2.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2">𝑒</ci><apply id="S5.SS1.p2.1.m1.1.1.3.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3"><minus id="S5.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3"></minus><cn id="S5.SS1.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.p2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">1e^{-4}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">1 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, the batch size to 1024, the embedding dimension to 256, and using the Adam as optimizer.
We carefully tune the unique parameters of each baseline according to the suggestions in the original papers.
We also use an early stopping strategy, with the patience set to 10 times, to obtain the best model based on the NDCG@10 on the validation set.
We will make the source codes publicly available once the paper has been accepted.
</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>RQ1: Performance Comparison</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">In addition to all baselines, to better evaluate the advantage of our TSLRec in inferring and utilizing the latent category information of items, we additionally introduce a variant (denoted as ‘CI’) that takes the pre-grouped index of each item as a feature and initializes a learnable embedding for it in the backbone model.
We report the comparison results in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.T2" title="Table 2 ‣ 5.1. Experiment Settings ‣ 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.
We can have the following observations:
1) Our TSLRec outperforms the base backbone model and the variant using pre-grouping results in all cases. This shows the effectiveness of our proposed SFT task and the knowledge-enhanced embeddings obtained by combining the capabilities of LLM.
2) The performance of existing LLM-enhanced baselines is dataset-dependent and does not necessarily have an advantage over traditional methods. However, our TSLRec achieves a stable gain on all datasets.
</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>RQ2: Efficiency Analysis</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">To verify the efficiency of our TSLRec, we take a recent LLM-enhance baseline, E4SRec, as an example and show the time it and our TSLRec take to perform LLM in training and inference phases, respectively.
The results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.F3" title="Figure 3 ‣ 5.3. RQ2: Efficiency Analysis ‣ 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, and comparison with other LLM-enhanced baselines has similar results.
Since our TSLRec modifies the complexity of SFT to the user level, we can find that its time to perform LLM in the training phase will be significantly reduced, especially on MovieLens-1M, which has the most training instances and the smallest number of users.
In addition, since our TSLRec only needs to obtain the knowledge-enhanced embedding of each item in the inference phase instead of using each user interaction sequence for inferencing like E4SRec, it also reduces the overhead.
This efficient property of TSLRec makes it more attractive for industrial deployment.
</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="354" id="S5.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>The time required to execute LLM in one epoch in the training and inference phases of TSLRec and E4SRec, respectively.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>RQ3: In-depth Analysis of TSLRec</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Finally, we provide some preliminary insights into how our TSLRec can leverage LLM’s capabilities to enhance the training of SRS models.
We first compare the latent category vectors inferred for each item by the well-trained LLM via SFT with their corresponding pre-grouped indices.
The comparison results include three cases: 1) the category with the highest probability in the inferred vector is the same as the pre-grouping index (denoted as ‘C1’); 2) the categories with the top three probabilities include the pre-grouping index (denoted as ‘C2’); 3) others (denoted as ‘C3’).
They respectively mean that the latent categories obtained using LLM in TSLRec agree with the pre-grouping result, think that an item belongs to multiple categories (including the pre-grouping result), or disagree with the pre-grouping result.
The results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.F4" title="Figure 4 ‣ 5.4. RQ3: In-depth Analysis of TSLRec ‣ 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>.
We can see that our TSLRec revised the latent categories of some items based on the pre-grouping results, which may be an essential source of the gain of our TSLRec.
In other words, the LLM in our TSLRec can better identify each item’s properties with the help of the designed SFT, which establishes the connections between different items.
</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="354" id="S5.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>The ratio of different comparison cases between the latent classes obtained by our TSLRec and the pre-grouped results.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">Second, we group each user by activity level and sort them in ascending order.
As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.00333v1#S5.F5" title="Figure 5 ‣ 5.4. RQ3: In-depth Analysis of TSLRec ‣ 5. Experiments ‣ A Practice-Friendly Two-Stage LLM-Enhanced Paradigm in Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, we report the results of our TSLRec and other baselines on all groups.
We can find that the variant that directly uses the pre-grouping results (i.e., ‘CI’) may encounter performance bottlenecks in groups with high activity while our TSLRec consistently gains.
This may be because the variant ‘CI’ uses the same feature embedding for all items in a group, which can easily confuse, while our TSLRec can provide more fine-grained enhanced embeddings for each item.
</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="354" id="S5.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>The performance results of our TSLRec and baselines on different user groups.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusions</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we consider the limitations of most existing sequential recommendation models augmented with large language models (LLM) regarding efficiency and rich textual dependencies and propose a novel practice-friendly two-stage LLM-enhanced paradigm (TSLRec).
Our TSLRec designs a novel supervised fine-tuning task for LLM in the first stage to reconstruct user preferences and reduce the training complexity to the user level.
In the second stage, we obtain an enhanced and informative embedding for each item by training a well-trained LLM, which can be directly used for training various future sequence models.
Finally, extensive experiments verify the effectiveness and efficiency of our TSLRec.

</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chen Gao, Yu Zheng, Yiqun Hui, Yanan Niu, Yang Song, Depeng Jin, and Yong Li. 2021.

</span>
<span class="ltx_bibblock">Sequential recommendation with graph neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 378–387.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yongjun Chen, Zhiwei Liu, Jia Li, Julian McAuley, and Caiming Xiong. 2022.

</span>
<span class="ltx_bibblock">Intent contrastive learning for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the ACM Web Conference 2022</em>. 2172–2182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Donkers et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Tim Donkers, Benedikt Loepp, and Jürgen Ziegler. 2017.

</span>
<span class="ltx_bibblock">Sequential user-based recurrent neural network recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 11th ACM Conference on Recommender Systems</em>. 152–160.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hanwen Du, Huanhuan Yuan, Pengpeng Zhao, Fuzhen Zhuang, Guanfeng Liu, Lei Zhao, Yanchi Liu, and Victor S Sheng. 2023.

</span>
<span class="ltx_bibblock">Ensemble modeling with contrastive knowledge distillation for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 58–67.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jingtong Gao, Xiangyu Zhao, Muyang Li, Minghao Zhao, Runze Wu, Ruocheng Guo, Yiding Liu, and Dawei Yin. 2024.

</span>
<span class="ltx_bibblock">SMLP4Rec: An efficient all-MLP architecture for sequential recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">ACM Transactions on Information Systems</em> 42, 3 (2024), 1–23.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Binzong Geng, Zhaoxin Huan, Xiaolu Zhang, Yong He, Liang Zhang, Fajie Yuan, Jun Zhou, and Linjian Mo. 2024.

</span>
<span class="ltx_bibblock">Breaking the length barrier: LLM-enhanced CTR prediction in long textual user behaviors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">arXiv preprint arXiv:2403.19347</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hartigan and Wong (1979)</span>
<span class="ltx_bibblock">
John A Hartigan and Manchek A Wong. 1979.

</span>
<span class="ltx_bibblock">Algorithm as 136: A k-means clustering algorithm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Journal of the Royal Statistical Society. Series S (Applied Statistics)</em> 28, 1 (1979), 100–108.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhankui He, Handong Zhao, Zhe Lin, Zhaowen Wang, Ajinkya Kale, and Julian McAuley. 2021.

</span>
<span class="ltx_bibblock">Locker: Locally constrained self-attentive sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 30th ACM International Conference on Information and Knowledge Management</em>. 3088–3092.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2016.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 4th International Conference on Learning Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Edward J Hu, Yeglong Shen, Wallis Phillip, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2021.

</span>
<span class="ltx_bibblock">LoRA: Low-rank adaptation of large language models. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the 9th International Conference on Learning Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hua et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenyue Hua, Shuyuan Xu, Yingqiang Ge, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">How to index item IDs for recommendation foundation models. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the Annual International ACM SIGIR Conference on Research and Development in Information Retrieval in the Asia Pacific Region</em>. 195–204.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 2018 IEEE International Conference on Data Mining</em>. 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen. 2023b.

</span>
<span class="ltx_bibblock">Prompt distillation for efficient LLM-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em>. 1348–1357.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Muyang Li, Zijian Zhang, Xiangyu Zhao, Wanyu Wang, Minghao Zhao, Runze Wu, and Ruocheng Guo. 2023c.

</span>
<span class="ltx_bibblock">AutoMLP: Automated MLP for sequential recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Proceedings of the ACM Web Conference 2023</em>. 1190–1198.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Xinhang Li, Chong Chen, Xiangyu Zhao, Yong Zhang, and Chunxiao Xing. 2023a.

</span>
<span class="ltx_bibblock">E4SRec: An elegant effective efficient extensible solution of large language models for sequential recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">arXiv preprint arXiv:2312.02443</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Xiaolin Lin, Jinwei Luo, Junwei Pan, Weike Pan, Zhong Ming, Xun Liu, Shudong Huang, and Jie Jiang. 2024.

</span>
<span class="ltx_bibblock">Multi-sequence attentive user representation learning for side-information integrated sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em>. 414–423.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiao et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Shutong Qiao, Chen Gao, Junhao Wen, Wei Zhou, Qun Luo, Peixuan Chen, and Yong Li. 2024.

</span>
<span class="ltx_bibblock">LLM4SBR: A lightweight and effective framework for integrating large language models in session-based recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">arXiv preprint arXiv:2402.13840</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quadrana et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Massimo Quadrana, Alexandros Karatzoglou, Balázs Hidasi, and Paolo Cremonesi. 2017.

</span>
<span class="ltx_bibblock">Personalizing session-based recommendations with hierarchical recurrent neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the 11th ACM Conference on Recommender Systems</em>. 130–137.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, and Lars Schmidt-Thieme. 2010.

</span>
<span class="ltx_bibblock">Factorizing personalized Markov chains for next-basket recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the ACM on Web Conference 2010</em>. 811–820.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized top-N sequential recommendation via convolutional sequence embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 11th ACM International Conference on Web Search and Data Mining</em>. 565–573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Hanbing Wang, Xiaorui Liu, Wenqi Fan, Xiangyu Zhao, Venkataramana Kini, Devendra Yadav, Fei Wang, Zhen Wen, Jiliang Tang, and Hui Liu. 2024.

</span>
<span class="ltx_bibblock">Rethinking large language model architectures for sequential recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">arXiv preprint arXiv:2402.09543</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Cong Xu, Zhangchi Zhu, Jun Wang, Jianyong Wang, and Wei Zhang. 2024.

</span>
<span class="ltx_bibblock">Fairly evaluating large language model-based recommendation needs revisit the cross-entropy loss.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">arXiv preprint arXiv:2402.06216</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
An Yan, Shuo Cheng, Wang-Cheng Kang, Mengting Wan, and Julian McAuley. 2019.

</span>
<span class="ltx_bibblock">CosRec: 2D convolutional neural networks for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</em>. 2173–2176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Shenghao Yang, Weizhi Ma, Peijie Sun, Qingyao Ai, Yiqun Liu, Mingchen Cai, and Min Zhang. 2024.

</span>
<span class="ltx_bibblock">Sequential recommendation with latent relations based on large language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">arXiv preprint arXiv:2403.18348</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fajie Yuan, Alexandros Karatzoglou, Ioannis Arapakis, Joemon M Jose, and Xiangnan He. 2019.

</span>
<span class="ltx_bibblock">A simple convolutional generative network for next item recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the 12th ACM International Conference on Web Search and Data Mining</em>. 582–590.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhenrui Yue, Sara Rabhi, Gabriel de Souza Pereira Moreira, Dong Wang, and Even Oldridge. 2023.

</span>
<span class="ltx_bibblock">LlamaRec: Two-stage recommendation using large language models for ranking.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">arXiv preprint arXiv:2311.02089</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wayne Xin Zhao, Shanlei Mu, Yupeng Hou, Zihan Lin, Yushuo Chen, Xingyu Pan, Kaiyuan Li, Yujie Lu, Hui Wang, Changxin Tian, Yingqian Min, Zhichao Feng, Xinyan Fan, Xu Chen, Pengfei Wang, Wendi Ji, Yaliang Li, Xiaoling Wang, and Ji-Rong Wen. 2021.

</span>
<span class="ltx_bibblock">RecBole: Towards a unified, comprehensive and efficient framework for recommendation algorithms. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Proceedings of the 30th ACM International Conference on Information and Knowledge Management</em>. 4653–4664.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zihuai Zhao, Wenqi Fan, Jiatong Li, Yunqing Liu, Xiaowei Mei, Yiqi Wang, Zhen Wen, Fei Wang, Xiangyu Zhao, Jiliang Tang, and Qing Li. 2024.

</span>
<span class="ltx_bibblock">Recommender systems in the era of large language models (LLMs).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">IEEE Transactions on Knowledge and Data Engineering</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhi Zheng, WenShuo Chao, Zhaopeng Qiu, Hengshu Zhu, and Hui Xiong. 2024.

</span>
<span class="ltx_bibblock">Harnessing large language models for text-rich sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of the ACM on Web Conference 2024</em>. 3207–3216.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Yu, Wayne Xin Zhao, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Filter-enhanced MLP is all you need for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the ACM Web Conference 2022</em>. 2388–2399.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Jun  1 07:16:08 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
