<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  World Models with Hints of Large Language Models for Goal Achieving
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Zeyuan Liu
    <sup class="ltx_sup" id="id16.16.id1">
     <span class="ltx_text ltx_font_italic" id="id16.16.id1.1">
      1
     </span>
    </sup>
    &amp;Ziyu Huan
    <sup class="ltx_sup" id="id17.17.id2">
     <span class="ltx_text ltx_font_italic" id="id17.17.id2.1">
      2
     </span>
    </sup>
    <span class="ltx_note ltx_role_footnotemark" id="footnotex1">
     <sup class="ltx_note_mark">
      1
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        1
       </sup>
       <span class="ltx_note_type">
        footnotemark:
       </span>
       <span class="ltx_tag ltx_tag_note">
        1
       </span>
      </span>
     </span>
    </span>
    &amp;Xiyao Wang
    <sup class="ltx_sup" id="id18.18.id3">
     <span class="ltx_text ltx_font_italic" id="id18.18.id3.1">
      3
     </span>
    </sup>
    &amp;Jiafei Lyu
    <sup class="ltx_sup" id="id19.19.id4">
     <span class="ltx_text ltx_font_italic" id="id19.19.id4.1">
      1
     </span>
    </sup>
    &amp;Jian Tao
    <sup class="ltx_sup" id="id20.20.id5">
     <span class="ltx_text ltx_font_italic" id="id20.20.id5.1">
      1
     </span>
    </sup>
    &amp;Xiu Li
    <sup class="ltx_sup" id="id21.21.id6">
     <span class="ltx_text ltx_font_italic" id="id21.21.id6.1">
      1†
     </span>
    </sup>
    &amp;Furong Huang
    <sup class="ltx_sup" id="id22.22.id7">
     <span class="ltx_text ltx_font_italic" id="id22.22.id7.1">
      3†
     </span>
    </sup>
    &amp;Huazhe Xu
    <sup class="ltx_sup" id="id23.23.id8">
     <span class="ltx_text ltx_font_italic" id="id23.23.id8.1">
      4,5,6†
     </span>
    </sup>
    <span class="ltx_ERROR undefined" id="id24.24.id9">
     \TEST
    </span>
    <sup class="ltx_sup" id="id25.25.id10">
     <span class="ltx_text ltx_font_italic" id="id25.25.id10.1">
      1
     </span>
    </sup>
    Tsinghua Shenzhen International Graduate School, Tsinghua University
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id26.26.id11">
     <span class="ltx_text ltx_font_italic" id="id26.26.id11.1">
      2
     </span>
    </sup>
    The Ohio State University,
    <sup class="ltx_sup" id="id27.27.id12">
     <span class="ltx_text ltx_font_italic" id="id27.27.id12.1">
      3
     </span>
    </sup>
    University of Maryland, College Park
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id28.28.id13">
     <span class="ltx_text ltx_font_italic" id="id28.28.id13.1">
      4
     </span>
    </sup>
    IIIS, Tsinghua University,
    <sup class="ltx_sup" id="id29.29.id14">
     <span class="ltx_text ltx_font_italic" id="id29.29.id14.1">
      5
     </span>
    </sup>
    Shanghai Qi Zhi Institute,
    <sup class="ltx_sup" id="id30.30.id15">
     <span class="ltx_text ltx_font_italic" id="id30.30.id15.1">
      6
     </span>
    </sup>
    Shanghai AI Lab
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id31.31.id16">
     {liuzeyua22, lvjf20, tj22}@mails.tsinghua.edu.cn
     <br class="ltx_break"/>
     ziyuhuan.ac@gmail.com
    </span>
    ,
    <span class="ltx_text ltx_font_typewriter" id="id32.32.id17">
     li.xiu@sz.tsinghua.edu.cn
     <br class="ltx_break"/>
     {xywang, furongh}@umd.edu
    </span>
    ,
    <span class="ltx_text ltx_font_typewriter" id="id33.33.id18">
     huazhe_xu@mail.tsinghua.edu.cn
    </span>
   </span>
   <span class="ltx_author_notes">
    Equal contribution.
    <sup class="ltx_sup" id="id34.34.id1">
     †
    </sup>
    Corresponding Authors.
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id35.id1">
   Reinforcement learning struggles in the face of long-horizon tasks and sparse goals due to the difficulty in manual reward specification. While existing methods address this by adding intrinsic rewards, they may fail to provide meaningful guidance in long-horizon decision-making tasks with large state and action spaces, lacking purposeful exploration. Inspired by human cognition, we propose a new multi-modal model-based RL approach named Dreaming with Large Language Models (DLLM). DLLM integrates the proposed hinting subgoals from the LLMs into the model rollouts to encourage goal discovery and reaching in challenging tasks. By assigning higher intrinsic rewards to samples that align with the hints outlined by the language model during model rollouts, DLLM guides the agent toward meaningful and efficient exploration. Extensive experiments demonstrate that the DLLM outperforms recent methods in various challenging, sparse-reward environments such as HomeGrid, Crafter, and Minecraft by 27.7%, 21.1%, and 9.9%, respectively.
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Reinforcement learning (RL) is effective when the agents receive rewards that propel them towards desired behaviors
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib52" title="">
      52
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib30" title="">
      30
     </a>
     ]
    </cite>
    . However, the manual engineering of suitable reward functions presents substantial challenges, especially in complex environments
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib62" title="">
      62
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib14" title="">
      14
     </a>
     ]
    </cite>
    . Therefore, solving tasks with long horizons and sparse rewards has long been desired in RL
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib2" title="">
      2
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib60" title="">
      60
     </a>
     ]
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    Existing RL methods address this issue by supplementing the extrinsic rewards provided by the environment with an intrinsic reward as an auxiliary objective such as novelty
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib7" title="">
      7
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib67" title="">
      67
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib68" title="">
      68
     </a>
     ]
    </cite>
    , surprise
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib1" title="">
      1
     </a>
     ]
    </cite>
    , uncertainty
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib4" title="">
      4
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib36" title="">
      36
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib27" title="">
      27
     </a>
     ]
    </cite>
    , and prediction errors
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib53" title="">
      53
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib40" title="">
      40
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib5" title="">
      5
     </a>
     ]
    </cite>
    .
Nonetheless, there exist scenarios wherein only a limited set of elements possess inherent factors that are truly valuable to the agent’s target objective, rendering the exploration of additional aspects inconsequential or potentially detrimental to the overall system performance
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib14" title="">
      14
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib11" title="">
      11
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib13" title="">
      13
     </a>
     ]
    </cite>
    . Some recent researches employ large language models (LLMs) to explore new solutions for this issue
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib13" title="">
      13
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib70" title="">
      70
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib69" title="">
      69
     </a>
     ]
    </cite>
    . Leveraging prior knowledge from extensive corpus data, these methods aim to encourage the exploration of meaningful states. While these approaches have demonstrated impressive results, they depend on querying the LLM for any unknown environmental conditions, which limits their ability to generalize the acquired language information to other steps. Additionally, due to their model-free nature, these approaches cannot capture the underlying relationships between dynamics and language-based hints. They also fail to leverage planning mechanisms or synthetic data generation to enhance sample efficiency.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <br class="ltx_break"/>
   <p class="ltx_p ltx_align_center ltx_align_center" id="S1.F1.1.1">
    <span class="ltx_text" id="S1.F1.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="219" id="S1.F1.1.1.1.g1" src="/html/2406.07381/assets/icml2024/pics/algorithm.jpg" width="598"/>
    </span>
   </p>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S1.F1.11.5.1" style="font-size:90%;">
      Figure 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S1.F1.9.9.4" style="font-size:90%;">
     The algorithmic overall structure diagram of DLLM, where WM denotes the world model,
     <math alttext="o_{l}" class="ltx_Math" display="inline" id="S1.F1.6.6.1.m1.1">
      <semantics id="S1.F1.6.6.1.m1.1b">
       <msub id="S1.F1.6.6.1.m1.1.1" xref="S1.F1.6.6.1.m1.1.1.cmml">
        <mi id="S1.F1.6.6.1.m1.1.1.2" xref="S1.F1.6.6.1.m1.1.1.2.cmml">
         o
        </mi>
        <mi id="S1.F1.6.6.1.m1.1.1.3" xref="S1.F1.6.6.1.m1.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S1.F1.6.6.1.m1.1c">
        <apply id="S1.F1.6.6.1.m1.1.1.cmml" xref="S1.F1.6.6.1.m1.1.1">
         <csymbol cd="ambiguous" id="S1.F1.6.6.1.m1.1.1.1.cmml" xref="S1.F1.6.6.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S1.F1.6.6.1.m1.1.1.2.cmml" xref="S1.F1.6.6.1.m1.1.1.2">
          𝑜
         </ci>
         <ci id="S1.F1.6.6.1.m1.1.1.3.cmml" xref="S1.F1.6.6.1.m1.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S1.F1.6.6.1.m1.1d">
        o_{l}
       </annotation>
      </semantics>
     </math>
     represents the natural language caption of the observation,
     <math alttext="u" class="ltx_Math" display="inline" id="S1.F1.7.7.2.m2.1">
      <semantics id="S1.F1.7.7.2.m2.1b">
       <mi id="S1.F1.7.7.2.m2.1.1" xref="S1.F1.7.7.2.m2.1.1.cmml">
        u
       </mi>
       <annotation-xml encoding="MathML-Content" id="S1.F1.7.7.2.m2.1c">
        <ci id="S1.F1.7.7.2.m2.1.1.cmml" xref="S1.F1.7.7.2.m2.1.1">
         𝑢
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S1.F1.7.7.2.m2.1d">
        u
       </annotation>
      </semantics>
     </math>
     denotes the transition, and
     <math alttext="i_{k}" class="ltx_Math" display="inline" id="S1.F1.8.8.3.m3.1">
      <semantics id="S1.F1.8.8.3.m3.1b">
       <msub id="S1.F1.8.8.3.m3.1.1" xref="S1.F1.8.8.3.m3.1.1.cmml">
        <mi id="S1.F1.8.8.3.m3.1.1.2" xref="S1.F1.8.8.3.m3.1.1.2.cmml">
         i
        </mi>
        <mi id="S1.F1.8.8.3.m3.1.1.3" xref="S1.F1.8.8.3.m3.1.1.3.cmml">
         k
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S1.F1.8.8.3.m3.1c">
        <apply id="S1.F1.8.8.3.m3.1.1.cmml" xref="S1.F1.8.8.3.m3.1.1">
         <csymbol cd="ambiguous" id="S1.F1.8.8.3.m3.1.1.1.cmml" xref="S1.F1.8.8.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S1.F1.8.8.3.m3.1.1.2.cmml" xref="S1.F1.8.8.3.m3.1.1.2">
          𝑖
         </ci>
         <ci id="S1.F1.8.8.3.m3.1.1.3.cmml" xref="S1.F1.8.8.3.m3.1.1.3">
          𝑘
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S1.F1.8.8.3.m3.1d">
        i_{k}
       </annotation>
      </semantics>
     </math>
     corresponds to the intrinsic reward for the
     <math alttext="k" class="ltx_Math" display="inline" id="S1.F1.9.9.4.m4.1">
      <semantics id="S1.F1.9.9.4.m4.1b">
       <mi id="S1.F1.9.9.4.m4.1.1" xref="S1.F1.9.9.4.m4.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S1.F1.9.9.4.m4.1c">
        <ci id="S1.F1.9.9.4.m4.1.1.cmml" xref="S1.F1.9.9.4.m4.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S1.F1.9.9.4.m4.1d">
        k
       </annotation>
      </semantics>
     </math>
     -th goal.
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    To address this issue, we draw inspiration from how humans solve long-horizon tasks efficiently. Humans excel at breaking down overall goals into several sub-goals and strive to plan a reasonable route to accomplish these goals sequentially
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib16" title="">
      16
     </a>
     ]
    </cite>
    . These goals are often associated with specific actions or environmental dynamics and can ideally be expressed in concise natural language. For example, experienced Minecraft players can naturally connect the action “obtaining iron” with its prerequisite actions “find an iron ore” and “breaking iron ore”.
   </p>
  </div>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Consequently, we propose Dreaming with Large Language Model (DLLM), a multi-modal model-based RL approach that integrates language hints (i.e., goals) from LLMs into the rollouts to encourage goal discovery and reaching in challenging and sparse-reward tasks, as illustrated in Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ World Models with Hints of Large Language Models for Goal Achieving">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    . DLLM’s world model processes visual inputs and sentence embeddings of natural language descriptions for transitions and learns to predict both. It then rewards the agent when the predicted embeddings are close enough to the goal, facilitating the agents’ use of inductive bias to achieve task goals. Thanks to the power of prompt-based LLMs, DLLM can influence agents’ behaviors in distinct manners based on the prompts provided for identical tasks, resulting in multiple styles of guidance for the agents. For example, when an agent needs to obtain iron in Minecraft, it can be guided directly to break iron ore, explore more for a better policy, or try interpolating both strategies.
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    Empirically, we evaluate DLLM on various sparse-reward environments, including Homegrid
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib31" title="">
      31
     </a>
     ]
    </cite>
    , Crafter
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib19" title="">
      19
     </a>
     ]
    </cite>
    , and Minecraft
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib17" title="">
      17
     </a>
     ]
    </cite>
    . Experimental results demonstrate that DLLM outperforms recent strong methods in task-oriented and exploration-oriented environments, showcasing robust performance in guiding exploration and training of the agent within highly complex scenarios. In Homegrid, Crafter and Minecraft environments, we successfully improve the performance by
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">
     27.7%
    </span>
    ,
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.2">
     21.1%
    </span>
    and
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.3">
     9.9%
    </span>
    , respectively, compared to the strongest baseline Dynalang
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib31" title="">
      31
     </a>
     ]
    </cite>
    , Achievement Distillation
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib38" title="">
      38
     </a>
     ]
    </cite>
    , and DreamerV3
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib23" title="">
      23
     </a>
     ]
    </cite>
    . We also observe that leveraging more powerful language models and providing the agent with comprehensive language information results in even better performance.
   </p>
  </div>
  <div class="ltx_para" id="S1.p6">
   <p class="ltx_p" id="S1.p6.1">
    Our contributions are as follows: (a) we propose DLLM, a multi-modal model-based reinforcement learning approach that utilizes human natural language to describe environmental dynamics, and incorporates LLM’s guidance in model rollouts to improve the agent’s exploration and goal-completion capabilities; (b) based on goals extracted by LLMs, DLLM can generate meaningful intrinsic rewards through an automatic descending mechanism to guide policy learning; (c) experimental results demonstrate that DLLM outperforms recent strong baselines across diverse environments.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Background and Related Work
  </h2>
  <div class="ltx_para" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">
     Model-based RL.
    </span>
    Model-based RL (MBRL) trains a world model through online interactions with the environment to predict rewards and next-step states
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib49" title="">
      49
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib51" title="">
      51
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib50" title="">
      50
     </a>
     ]
    </cite>
    . With the world model, the agent can plan and optimize its policy from imagined sequences
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib25" title="">
      25
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib34" title="">
      34
     </a>
     ]
    </cite>
    . Amidst recent advancements, specific contemporary MBRL methods have acquired a world model that is capable of handling high-dimensional observations and intricate dynamics, achieving notable milestones in various domains
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib18" title="">
      18
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib46" title="">
      46
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib20" title="">
      20
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib22" title="">
      22
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib23" title="">
      23
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib25" title="">
      25
     </a>
     ]
    </cite>
    . Akin to our approach, the work of Lin et al.
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib31" title="">
      31
     </a>
     ]
    </cite>
    constructs a multimodal world model capable of predicting future visual and textual representations, thereby enabling agents to ground their language generation capabilities within an imagined, simulated environment. We employ the same implementation approach, but further integrate the generated natural language from the LLMs during the planning process into constructing the intrinsic rewards.
   </p>
  </div>
  <div class="ltx_para" id="S2.p2">
   <p class="ltx_p" id="S2.p2.1">
    <span class="ltx_text ltx_font_bold" id="S2.p2.1.1">
     Intrinsically motivated RL.
    </span>
    In a sparse-reward environment, agents must take many steps in a decision sequence before receiving a positive reward signal. Collecting practical data for training using only random sampling or noisy RL methods is challenging, especially in complex environments with a large state-action space
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib44" title="">
      44
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib64" title="">
      64
     </a>
     ]
    </cite>
    . Intrinsically motivated RL is the primary method for addressing sparse reward problems. It provides extra intrinsic dense rewards to the agent, encouraging the agent to explore unvisited areas. Pathak et al.
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib40" title="">
      40
     </a>
     ]
    </cite>
    propose using curiosity as an intrinsic reward signal, which measures the agent’s proficiency in predicting the consequences of its actions within the latent feature space generated by a self-supervised inverse dynamics model. Burda
et al. propose random network distillation (RND)
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib6" title="">
      6
     </a>
     ]
    </cite>
    that leverages the prediction error of a fixed random neural network on novel states and achieves outstanding results in Montezuma’s Revenge. Some subsequent studies improve RND via methods such as distributional modeling
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib63" title="">
      63
     </a>
     ]
    </cite>
    . In addition to the intrinsically motivated method that utilizes state novelty, there are methods for maximizing the diversity of states
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib55" title="">
      55
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib32" title="">
      32
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib59" title="">
      59
     </a>
     ]
    </cite>
    and for maximizing the diversity of skills mastered by the agent
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib3" title="">
      3
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib10" title="">
      10
     </a>
     ]
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para" id="S2.p3">
   <p class="ltx_p" id="S2.p3.1">
    Despite the success of intrinsically motivated RL methods, they may face challenges when dealing with large state-action space and complex task scenarios since they are only encouraged to explore novel states, and not all states are useful for achieving the goal. Purposeless exploration can hinder the performance of the agent. Hence, it is essential to incorporate meaningful encouragement to assist the agent, as highlighted in previous studies
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib14" title="">
      14
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib13" title="">
      13
     </a>
     ]
    </cite>
    . This may involve integrating commonsense knowledge, furnishing explicit subgoals as guides, and employing other relevant strategies to facilitate the agent’s learning process. DLLM considers these factors with a specific focus on long-term decision-making. During rollouts, DLLM applies intrinsic rewards when the agent achieves goals set by LLM in previous steps, strengthening the understanding of the agent’s contextual connections.
   </p>
  </div>
  <div class="ltx_para" id="S2.p4">
   <p class="ltx_p" id="S2.p4.1">
    <span class="ltx_text ltx_font_bold" id="S2.p4.1.1">
     Leveraging large language models (LLMs) for language goals.
    </span>
    Pre-trained LLMs showcase remarkable capabilities, particularly in understanding common human knowledge. Naturally, LLMs can generate meaningful and human-recognizable intrinsic rewards for intelligent agents. Choi et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib9" title="">
      9
     </a>
     ]
    </cite>
    leverage pre-trained LLMs as task-specific priors for managing text-based metadata within the context of supervised learning. Kant et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib28" title="">
      28
     </a>
     ]
    </cite>
    utilize LLMs as commonsense priors for zero-shot planning. Similar efforts are made by Yao
et al., Shinn et al., Wu et al., and Wang et al.,
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib65" title="">
      65
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib48" title="">
      48
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib61" title="">
      61
     </a>
     ,
     <a class="ltx_ref" href="#biba.bib57" title="">
      57
     </a>
     ]
    </cite>
    , who propose diverse prompt methods and algorithmic structures to mitigate the problems of hallucination and inaccuracy when employing LLMs directly for decision-making. Carta et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib8" title="">
      8
     </a>
     ]
    </cite>
    examine an approach where an agent utilizes an LLM as a policy that undergoes progressive updates as the agent engages with the environment, employing online reinforcement learning to enhance its performance in achieving objectives. Zhang et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib66" title="">
      66
     </a>
     ]
    </cite>
    propose to leverage the LLMs to guide skill chaining. Du
et al. propose ELLM
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib13" title="">
      13
     </a>
     ]
    </cite>
    , which leverages LLMs to generate intrinsic rewards for guiding agents, integrating LLM with RL. However, the guidance obtained using this approach is only effective in the short term. DLLM draws inspiration from ELLM and endeavors to extend the guidance from LLMs into long-term decision-making.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Preliminaries
  </h2>
  <div class="ltx_para" id="S3.p1">
   <p class="ltx_p" id="S3.p1.10">
    We consider a partially observable Markov decision process (POMDP) defined by a tuple
    <math alttext="(S,A,O,\Omega,P,\gamma,R)" class="ltx_Math" display="inline" id="S3.p1.1.m1.7">
     <semantics id="S3.p1.1.m1.7a">
      <mrow id="S3.p1.1.m1.7.8.2" xref="S3.p1.1.m1.7.8.1.cmml">
       <mo id="S3.p1.1.m1.7.8.2.1" stretchy="false" xref="S3.p1.1.m1.7.8.1.cmml">
        (
       </mo>
       <mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">
        S
       </mi>
       <mo id="S3.p1.1.m1.7.8.2.2" xref="S3.p1.1.m1.7.8.1.cmml">
        ,
       </mo>
       <mi id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml">
        A
       </mi>
       <mo id="S3.p1.1.m1.7.8.2.3" xref="S3.p1.1.m1.7.8.1.cmml">
        ,
       </mo>
       <mi id="S3.p1.1.m1.3.3" xref="S3.p1.1.m1.3.3.cmml">
        O
       </mi>
       <mo id="S3.p1.1.m1.7.8.2.4" xref="S3.p1.1.m1.7.8.1.cmml">
        ,
       </mo>
       <mi id="S3.p1.1.m1.4.4" mathvariant="normal" xref="S3.p1.1.m1.4.4.cmml">
        Ω
       </mi>
       <mo id="S3.p1.1.m1.7.8.2.5" xref="S3.p1.1.m1.7.8.1.cmml">
        ,
       </mo>
       <mi id="S3.p1.1.m1.5.5" xref="S3.p1.1.m1.5.5.cmml">
        P
       </mi>
       <mo id="S3.p1.1.m1.7.8.2.6" xref="S3.p1.1.m1.7.8.1.cmml">
        ,
       </mo>
       <mi id="S3.p1.1.m1.6.6" xref="S3.p1.1.m1.6.6.cmml">
        γ
       </mi>
       <mo id="S3.p1.1.m1.7.8.2.7" xref="S3.p1.1.m1.7.8.1.cmml">
        ,
       </mo>
       <mi id="S3.p1.1.m1.7.7" xref="S3.p1.1.m1.7.7.cmml">
        R
       </mi>
       <mo id="S3.p1.1.m1.7.8.2.8" stretchy="false" xref="S3.p1.1.m1.7.8.1.cmml">
        )
       </mo>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.7b">
       <vector id="S3.p1.1.m1.7.8.1.cmml" xref="S3.p1.1.m1.7.8.2">
        <ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">
         𝑆
        </ci>
        <ci id="S3.p1.1.m1.2.2.cmml" xref="S3.p1.1.m1.2.2">
         𝐴
        </ci>
        <ci id="S3.p1.1.m1.3.3.cmml" xref="S3.p1.1.m1.3.3">
         𝑂
        </ci>
        <ci id="S3.p1.1.m1.4.4.cmml" xref="S3.p1.1.m1.4.4">
         Ω
        </ci>
        <ci id="S3.p1.1.m1.5.5.cmml" xref="S3.p1.1.m1.5.5">
         𝑃
        </ci>
        <ci id="S3.p1.1.m1.6.6.cmml" xref="S3.p1.1.m1.6.6">
         𝛾
        </ci>
        <ci id="S3.p1.1.m1.7.7.cmml" xref="S3.p1.1.m1.7.7">
         𝑅
        </ci>
       </vector>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.1.m1.7c">
       (S,A,O,\Omega,P,\gamma,R)
      </annotation>
     </semantics>
    </math>
    , where
    <math alttext="s\in S" class="ltx_Math" display="inline" id="S3.p1.2.m2.1">
     <semantics id="S3.p1.2.m2.1a">
      <mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">
       <mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">
        s
       </mi>
       <mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">
        ∈
       </mo>
       <mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">
        S
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b">
       <apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">
        <in id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1">
        </in>
        <ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">
         𝑠
        </ci>
        <ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">
         𝑆
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">
       s\in S
      </annotation>
     </semantics>
    </math>
    represents the states of the environment,
    <math alttext="a\in A" class="ltx_Math" display="inline" id="S3.p1.3.m3.1">
     <semantics id="S3.p1.3.m3.1a">
      <mrow id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">
       <mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">
        a
       </mi>
       <mo id="S3.p1.3.m3.1.1.1" xref="S3.p1.3.m3.1.1.1.cmml">
        ∈
       </mo>
       <mi id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">
        A
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b">
       <apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">
        <in id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1">
        </in>
        <ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">
         𝑎
        </ci>
        <ci id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3">
         𝐴
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">
       a\in A
      </annotation>
     </semantics>
    </math>
    represents the actions, and observation
    <math alttext="o\in\Omega" class="ltx_Math" display="inline" id="S3.p1.4.m4.1">
     <semantics id="S3.p1.4.m4.1a">
      <mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">
       <mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">
        o
       </mi>
       <mo id="S3.p1.4.m4.1.1.1" xref="S3.p1.4.m4.1.1.1.cmml">
        ∈
       </mo>
       <mi id="S3.p1.4.m4.1.1.3" mathvariant="normal" xref="S3.p1.4.m4.1.1.3.cmml">
        Ω
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b">
       <apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">
        <in id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1">
        </in>
        <ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">
         𝑜
        </ci>
        <ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">
         Ω
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">
       o\in\Omega
      </annotation>
     </semantics>
    </math>
    is obtained from
    <math alttext="O(o|s,a)" class="ltx_Math" display="inline" id="S3.p1.5.m5.3">
     <semantics id="S3.p1.5.m5.3a">
      <mrow id="S3.p1.5.m5.3.3" xref="S3.p1.5.m5.3.3.cmml">
       <mi id="S3.p1.5.m5.3.3.3" xref="S3.p1.5.m5.3.3.3.cmml">
        O
       </mi>
       <mo id="S3.p1.5.m5.3.3.2" lspace="0em" rspace="0em" xref="S3.p1.5.m5.3.3.2.cmml">
        ​
       </mo>
       <mrow id="S3.p1.5.m5.3.3.1.1" xref="S3.p1.5.m5.3.3.1.1.1.cmml">
        <mo id="S3.p1.5.m5.3.3.1.1.2" stretchy="false" xref="S3.p1.5.m5.3.3.1.1.1.cmml">
         (
        </mo>
        <mrow id="S3.p1.5.m5.3.3.1.1.1" xref="S3.p1.5.m5.3.3.1.1.1.cmml">
         <mi id="S3.p1.5.m5.3.3.1.1.1.2" xref="S3.p1.5.m5.3.3.1.1.1.2.cmml">
          o
         </mi>
         <mo fence="false" id="S3.p1.5.m5.3.3.1.1.1.1" xref="S3.p1.5.m5.3.3.1.1.1.1.cmml">
          |
         </mo>
         <mrow id="S3.p1.5.m5.3.3.1.1.1.3.2" xref="S3.p1.5.m5.3.3.1.1.1.3.1.cmml">
          <mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">
           s
          </mi>
          <mo id="S3.p1.5.m5.3.3.1.1.1.3.2.1" xref="S3.p1.5.m5.3.3.1.1.1.3.1.cmml">
           ,
          </mo>
          <mi id="S3.p1.5.m5.2.2" xref="S3.p1.5.m5.2.2.cmml">
           a
          </mi>
         </mrow>
        </mrow>
        <mo id="S3.p1.5.m5.3.3.1.1.3" stretchy="false" xref="S3.p1.5.m5.3.3.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.3b">
       <apply id="S3.p1.5.m5.3.3.cmml" xref="S3.p1.5.m5.3.3">
        <times id="S3.p1.5.m5.3.3.2.cmml" xref="S3.p1.5.m5.3.3.2">
        </times>
        <ci id="S3.p1.5.m5.3.3.3.cmml" xref="S3.p1.5.m5.3.3.3">
         𝑂
        </ci>
        <apply id="S3.p1.5.m5.3.3.1.1.1.cmml" xref="S3.p1.5.m5.3.3.1.1">
         <csymbol cd="latexml" id="S3.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.p1.5.m5.3.3.1.1.1.1">
          conditional
         </csymbol>
         <ci id="S3.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.p1.5.m5.3.3.1.1.1.2">
          𝑜
         </ci>
         <list id="S3.p1.5.m5.3.3.1.1.1.3.1.cmml" xref="S3.p1.5.m5.3.3.1.1.1.3.2">
          <ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">
           𝑠
          </ci>
          <ci id="S3.p1.5.m5.2.2.cmml" xref="S3.p1.5.m5.2.2">
           𝑎
          </ci>
         </list>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.5.m5.3c">
       O(o|s,a)
      </annotation>
     </semantics>
    </math>
    .
    <math alttext="P(s^{\prime}|s,a)" class="ltx_Math" display="inline" id="S3.p1.6.m6.3">
     <semantics id="S3.p1.6.m6.3a">
      <mrow id="S3.p1.6.m6.3.3" xref="S3.p1.6.m6.3.3.cmml">
       <mi id="S3.p1.6.m6.3.3.3" xref="S3.p1.6.m6.3.3.3.cmml">
        P
       </mi>
       <mo id="S3.p1.6.m6.3.3.2" lspace="0em" rspace="0em" xref="S3.p1.6.m6.3.3.2.cmml">
        ​
       </mo>
       <mrow id="S3.p1.6.m6.3.3.1.1" xref="S3.p1.6.m6.3.3.1.1.1.cmml">
        <mo id="S3.p1.6.m6.3.3.1.1.2" stretchy="false" xref="S3.p1.6.m6.3.3.1.1.1.cmml">
         (
        </mo>
        <mrow id="S3.p1.6.m6.3.3.1.1.1" xref="S3.p1.6.m6.3.3.1.1.1.cmml">
         <msup id="S3.p1.6.m6.3.3.1.1.1.2" xref="S3.p1.6.m6.3.3.1.1.1.2.cmml">
          <mi id="S3.p1.6.m6.3.3.1.1.1.2.2" xref="S3.p1.6.m6.3.3.1.1.1.2.2.cmml">
           s
          </mi>
          <mo id="S3.p1.6.m6.3.3.1.1.1.2.3" xref="S3.p1.6.m6.3.3.1.1.1.2.3.cmml">
           ′
          </mo>
         </msup>
         <mo fence="false" id="S3.p1.6.m6.3.3.1.1.1.1" xref="S3.p1.6.m6.3.3.1.1.1.1.cmml">
          |
         </mo>
         <mrow id="S3.p1.6.m6.3.3.1.1.1.3.2" xref="S3.p1.6.m6.3.3.1.1.1.3.1.cmml">
          <mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">
           s
          </mi>
          <mo id="S3.p1.6.m6.3.3.1.1.1.3.2.1" xref="S3.p1.6.m6.3.3.1.1.1.3.1.cmml">
           ,
          </mo>
          <mi id="S3.p1.6.m6.2.2" xref="S3.p1.6.m6.2.2.cmml">
           a
          </mi>
         </mrow>
        </mrow>
        <mo id="S3.p1.6.m6.3.3.1.1.3" stretchy="false" xref="S3.p1.6.m6.3.3.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.3b">
       <apply id="S3.p1.6.m6.3.3.cmml" xref="S3.p1.6.m6.3.3">
        <times id="S3.p1.6.m6.3.3.2.cmml" xref="S3.p1.6.m6.3.3.2">
        </times>
        <ci id="S3.p1.6.m6.3.3.3.cmml" xref="S3.p1.6.m6.3.3.3">
         𝑃
        </ci>
        <apply id="S3.p1.6.m6.3.3.1.1.1.cmml" xref="S3.p1.6.m6.3.3.1.1">
         <csymbol cd="latexml" id="S3.p1.6.m6.3.3.1.1.1.1.cmml" xref="S3.p1.6.m6.3.3.1.1.1.1">
          conditional
         </csymbol>
         <apply id="S3.p1.6.m6.3.3.1.1.1.2.cmml" xref="S3.p1.6.m6.3.3.1.1.1.2">
          <csymbol cd="ambiguous" id="S3.p1.6.m6.3.3.1.1.1.2.1.cmml" xref="S3.p1.6.m6.3.3.1.1.1.2">
           superscript
          </csymbol>
          <ci id="S3.p1.6.m6.3.3.1.1.1.2.2.cmml" xref="S3.p1.6.m6.3.3.1.1.1.2.2">
           𝑠
          </ci>
          <ci id="S3.p1.6.m6.3.3.1.1.1.2.3.cmml" xref="S3.p1.6.m6.3.3.1.1.1.2.3">
           ′
          </ci>
         </apply>
         <list id="S3.p1.6.m6.3.3.1.1.1.3.1.cmml" xref="S3.p1.6.m6.3.3.1.1.1.3.2">
          <ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">
           𝑠
          </ci>
          <ci id="S3.p1.6.m6.2.2.cmml" xref="S3.p1.6.m6.2.2">
           𝑎
          </ci>
         </list>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.6.m6.3c">
       P(s^{\prime}|s,a)
      </annotation>
     </semantics>
    </math>
    represents the dynamics of the environment,
    <math alttext="R" class="ltx_Math" display="inline" id="S3.p1.7.m7.1">
     <semantics id="S3.p1.7.m7.1a">
      <mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">
       R
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b">
       <ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">
        𝑅
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">
       R
      </annotation>
     </semantics>
    </math>
    and
    <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.p1.8.m8.1">
     <semantics id="S3.p1.8.m8.1a">
      <mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">
       γ
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b">
       <ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">
        𝛾
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">
       \gamma
      </annotation>
     </semantics>
    </math>
    are the reward function and discount factor, respectively. During training, the agent’s goal is to learn a policy
    <math alttext="\pi" class="ltx_Math" display="inline" id="S3.p1.9.m9.1">
     <semantics id="S3.p1.9.m9.1a">
      <mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">
       π
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b">
       <ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">
        𝜋
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">
       \pi
      </annotation>
     </semantics>
    </math>
    that maximizes discounted cumulative rewards, i.e.,
    <math alttext="\max\mathbb{E}_{\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}R(s_{t},a_{t})\right]." class="ltx_Math" display="inline" id="S3.p1.10.m10.1">
     <semantics id="S3.p1.10.m10.1a">
      <mrow id="S3.p1.10.m10.1.1.1" xref="S3.p1.10.m10.1.1.1.1.cmml">
       <mrow id="S3.p1.10.m10.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.cmml">
        <mrow id="S3.p1.10.m10.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.3.cmml">
         <mi id="S3.p1.10.m10.1.1.1.1.3.1" xref="S3.p1.10.m10.1.1.1.1.3.1.cmml">
          max
         </mi>
         <mo id="S3.p1.10.m10.1.1.1.1.3a" lspace="0.167em" xref="S3.p1.10.m10.1.1.1.1.3.cmml">
          ⁡
         </mo>
         <msub id="S3.p1.10.m10.1.1.1.1.3.2" xref="S3.p1.10.m10.1.1.1.1.3.2.cmml">
          <mi id="S3.p1.10.m10.1.1.1.1.3.2.2" xref="S3.p1.10.m10.1.1.1.1.3.2.2.cmml">
           𝔼
          </mi>
          <mi id="S3.p1.10.m10.1.1.1.1.3.2.3" xref="S3.p1.10.m10.1.1.1.1.3.2.3.cmml">
           π
          </mi>
         </msub>
        </mrow>
        <mo id="S3.p1.10.m10.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.p1.10.m10.1.1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.p1.10.m10.1.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.2.cmml">
         <mo id="S3.p1.10.m10.1.1.1.1.1.1.2" xref="S3.p1.10.m10.1.1.1.1.1.2.1.cmml">
          [
         </mo>
         <mrow id="S3.p1.10.m10.1.1.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.1.1.cmml">
          <msubsup id="S3.p1.10.m10.1.1.1.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.cmml">
           <mo id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.2" lspace="0em" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.2.cmml">
            ∑
           </mo>
           <mrow id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.cmml">
            <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.2" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.2.cmml">
             t
            </mi>
            <mo id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.1" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.1.cmml">
             =
            </mo>
            <mn id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.3" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.3.cmml">
             0
            </mn>
           </mrow>
           <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.3.cmml">
            ∞
           </mi>
          </msubsup>
          <mrow id="S3.p1.10.m10.1.1.1.1.1.1.1.2" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.cmml">
           <msup id="S3.p1.10.m10.1.1.1.1.1.1.1.2.4" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.cmml">
            <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.2" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.2.cmml">
             γ
            </mi>
            <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.3" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.3.cmml">
             t
            </mi>
           </msup>
           <mo id="S3.p1.10.m10.1.1.1.1.1.1.1.2.3" lspace="0em" rspace="0em" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.3.cmml">
            ​
           </mo>
           <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.2.5" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.5.cmml">
            R
           </mi>
           <mo id="S3.p1.10.m10.1.1.1.1.1.1.1.2.3a" lspace="0em" rspace="0em" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.3.cmml">
            ​
           </mo>
           <mrow id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.3.cmml">
            <mo id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.3.cmml">
             (
            </mo>
            <msub id="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.cmml">
             <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
              s
             </mi>
             <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.4" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.3.cmml">
             ,
            </mo>
            <msub id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.cmml">
             <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.2.cmml">
              a
             </mi>
             <mi id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.3.cmml">
             )
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <mo id="S3.p1.10.m10.1.1.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.1.2.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <mo id="S3.p1.10.m10.1.1.1.2" lspace="0em" xref="S3.p1.10.m10.1.1.1.1.cmml">
        .
       </mo>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b">
       <apply id="S3.p1.10.m10.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1">
        <times id="S3.p1.10.m10.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.2">
        </times>
        <apply id="S3.p1.10.m10.1.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.1.3">
         <max id="S3.p1.10.m10.1.1.1.1.3.1.cmml" xref="S3.p1.10.m10.1.1.1.1.3.1">
         </max>
         <apply id="S3.p1.10.m10.1.1.1.1.3.2.cmml" xref="S3.p1.10.m10.1.1.1.1.3.2">
          <csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.3.2.1.cmml" xref="S3.p1.10.m10.1.1.1.1.3.2">
           subscript
          </csymbol>
          <ci id="S3.p1.10.m10.1.1.1.1.3.2.2.cmml" xref="S3.p1.10.m10.1.1.1.1.3.2.2">
           𝔼
          </ci>
          <ci id="S3.p1.10.m10.1.1.1.1.3.2.3.cmml" xref="S3.p1.10.m10.1.1.1.1.3.2.3">
           𝜋
          </ci>
         </apply>
        </apply>
        <apply id="S3.p1.10.m10.1.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1">
         <csymbol cd="latexml" id="S3.p1.10.m10.1.1.1.1.1.2.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.2">
          delimited-[]
         </csymbol>
         <apply id="S3.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1">
          <apply id="S3.p1.10.m10.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3">
           <csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3">
            superscript
           </csymbol>
           <apply id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3">
            <csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3">
             subscript
            </csymbol>
            <sum id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.2">
            </sum>
            <apply id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3">
             <eq id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.1">
             </eq>
             <ci id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.2">
              𝑡
             </ci>
             <cn id="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.2.3.3">
              0
             </cn>
            </apply>
           </apply>
           <infinity id="S3.p1.10.m10.1.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.3.3">
           </infinity>
          </apply>
          <apply id="S3.p1.10.m10.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2">
           <times id="S3.p1.10.m10.1.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.3">
           </times>
           <apply id="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.4">
            <csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.4">
             superscript
            </csymbol>
            <ci id="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.2">
             𝛾
            </ci>
            <ci id="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.4.3">
             𝑡
            </ci>
           </apply>
           <ci id="S3.p1.10.m10.1.1.1.1.1.1.1.2.5.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.5">
            𝑅
           </ci>
           <interval closure="open" id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2">
            <apply id="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.2">
              𝑠
             </ci>
             <ci id="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
            <apply id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2">
             <csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2">
              subscript
             </csymbol>
             <ci id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.2">
              𝑎
             </ci>
             <ci id="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.3">
              𝑡
             </ci>
            </apply>
           </interval>
          </apply>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">
       \max\mathbb{E}_{\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}R(s_{t},a_{t})\right].
      </annotation>
     </semantics>
    </math>
   </p>
  </div>
  <div class="ltx_para" id="S3.p2">
   <p class="ltx_p" id="S3.p2.7">
    Additionally, we define two sets of natural language sentence embeddings: the set of sentence embeddings for transitions, denoted as
    <math alttext="U" class="ltx_Math" display="inline" id="S3.p2.1.m1.1">
     <semantics id="S3.p2.1.m1.1a">
      <mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">
       U
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b">
       <ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">
        𝑈
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">
       U
      </annotation>
     </semantics>
    </math>
    , and the set of sentence embeddings for goals, denoted as
    <math alttext="G" class="ltx_Math" display="inline" id="S3.p2.2.m2.1">
     <semantics id="S3.p2.2.m2.1a">
      <mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">
       G
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b">
       <ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">
        𝐺
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">
       G
      </annotation>
     </semantics>
    </math>
    . In this context, each
    <math alttext="u\in U" class="ltx_Math" display="inline" id="S3.p2.3.m3.1">
     <semantics id="S3.p2.3.m3.1a">
      <mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">
       <mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">
        u
       </mi>
       <mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">
        ∈
       </mo>
       <mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">
        U
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b">
       <apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">
        <in id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1">
        </in>
        <ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">
         𝑢
        </ci>
        <ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">
         𝑈
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">
       u\in U
      </annotation>
     </semantics>
    </math>
    represents a sentence embedding describing the environmental changes from the previous step to the current step, while
    <math alttext="g\in G" class="ltx_Math" display="inline" id="S3.p2.4.m4.1">
     <semantics id="S3.p2.4.m4.1a">
      <mrow id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">
       <mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">
        g
       </mi>
       <mo id="S3.p2.4.m4.1.1.1" xref="S3.p2.4.m4.1.1.1.cmml">
        ∈
       </mo>
       <mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">
        G
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b">
       <apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">
        <in id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1">
        </in>
        <ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">
         𝑔
        </ci>
        <ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">
         𝐺
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">
       g\in G
      </annotation>
     </semantics>
    </math>
    represents a sentence embedding of a goal the LLM intends for the agent to achieve. We permit the LLM to output any content within specified formats, thereby enlarging the support of the goal distribution to encompass the space of natural language strings. Thus,
    <math alttext="G" class="ltx_Math" display="inline" id="S3.p2.5.m5.1">
     <semantics id="S3.p2.5.m5.1a">
      <mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">
       G
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b">
       <ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">
        𝐺
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">
       G
      </annotation>
     </semantics>
    </math>
    should encompass all possible
    <math alttext="u\in U" class="ltx_Math" display="inline" id="S3.p2.6.m6.1">
     <semantics id="S3.p2.6.m6.1a">
      <mrow id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">
       <mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">
        u
       </mi>
       <mo id="S3.p2.6.m6.1.1.1" xref="S3.p2.6.m6.1.1.1.cmml">
        ∈
       </mo>
       <mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">
        U
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b">
       <apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">
        <in id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1">
        </in>
        <ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">
         𝑢
        </ci>
        <ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">
         𝑈
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">
       u\in U
      </annotation>
     </semantics>
    </math>
    , i.e.,
    <math alttext="U\subset G" class="ltx_Math" display="inline" id="S3.p2.7.m7.1">
     <semantics id="S3.p2.7.m7.1a">
      <mrow id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml">
       <mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">
        U
       </mi>
       <mo id="S3.p2.7.m7.1.1.1" xref="S3.p2.7.m7.1.1.1.cmml">
        ⊂
       </mo>
       <mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">
        G
       </mi>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b">
       <apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1">
        <subset id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1.1">
        </subset>
        <ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">
         𝑈
        </ci>
        <ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">
         𝐺
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">
       U\subset G
      </annotation>
     </semantics>
    </math>
    .
   </p>
  </div>
  <div class="ltx_para" id="S3.p3">
   <p class="ltx_p" id="S3.p3.6">
    We also define the goal-conditioned intrinsic reward function
    <math alttext="R_{\text{int}}(u|g)" class="ltx_Math" display="inline" id="S3.p3.1.m1.1">
     <semantics id="S3.p3.1.m1.1a">
      <mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">
       <msub id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">
        <mi id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml">
         R
        </mi>
        <mtext id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3a.cmml">
         int
        </mtext>
       </msub>
       <mo id="S3.p3.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S3.p3.1.m1.1.1.2.cmml">
        ​
       </mo>
       <mrow id="S3.p3.1.m1.1.1.1.1" xref="S3.p3.1.m1.1.1.1.1.1.cmml">
        <mo id="S3.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S3.p3.1.m1.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="S3.p3.1.m1.1.1.1.1.1" xref="S3.p3.1.m1.1.1.1.1.1.cmml">
         <mi id="S3.p3.1.m1.1.1.1.1.1.2" xref="S3.p3.1.m1.1.1.1.1.1.2.cmml">
          u
         </mi>
         <mo fence="false" id="S3.p3.1.m1.1.1.1.1.1.1" xref="S3.p3.1.m1.1.1.1.1.1.1.cmml">
          |
         </mo>
         <mi id="S3.p3.1.m1.1.1.1.1.1.3" xref="S3.p3.1.m1.1.1.1.1.1.3.cmml">
          g
         </mi>
        </mrow>
        <mo id="S3.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S3.p3.1.m1.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b">
       <apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">
        <times id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">
        </times>
        <apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">
         <csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3">
          subscript
         </csymbol>
         <ci id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2">
          𝑅
         </ci>
         <ci id="S3.p3.1.m1.1.1.3.3a.cmml" xref="S3.p3.1.m1.1.1.3.3">
          <mtext id="S3.p3.1.m1.1.1.3.3.cmml" mathsize="70%" xref="S3.p3.1.m1.1.1.3.3">
           int
          </mtext>
         </ci>
        </apply>
        <apply id="S3.p3.1.m1.1.1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1.1">
         <csymbol cd="latexml" id="S3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1.1.1.1">
          conditional
         </csymbol>
         <ci id="S3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.1.1.1.2">
          𝑢
         </ci>
         <ci id="S3.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.1.1.1.3">
          𝑔
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">
       R_{\text{int}}(u|g)
      </annotation>
     </semantics>
    </math>
    , and the DLLM agent optimizes for an intrinsic reward
    <math alttext="R_{\rm int}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1">
     <semantics id="S3.p3.2.m2.1a">
      <msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">
       <mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">
        R
       </mi>
       <mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">
        int
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b">
       <apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">
        <csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">
         𝑅
        </ci>
        <ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">
         int
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">
       R_{\rm int}
      </annotation>
     </semantics>
    </math>
    alongside the reward
    <math alttext="R" class="ltx_Math" display="inline" id="S3.p3.3.m3.1">
     <semantics id="S3.p3.3.m3.1a">
      <mi id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">
       R
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b">
       <ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">
        𝑅
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">
       R
      </annotation>
     </semantics>
    </math>
    from the environment. Assuming that goals provided by natural language are diverse, common-sense sensitive, and context-sensitive, we expect that maximizing
    <math alttext="R_{\text{int}}" class="ltx_Math" display="inline" id="S3.p3.4.m4.1">
     <semantics id="S3.p3.4.m4.1a">
      <msub id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">
       <mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">
        R
       </mi>
       <mtext id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3a.cmml">
        int
       </mtext>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b">
       <apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">
        <csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">
         subscript
        </csymbol>
        <ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">
         𝑅
        </ci>
        <ci id="S3.p3.4.m4.1.1.3a.cmml" xref="S3.p3.4.m4.1.1.3">
         <mtext id="S3.p3.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.p3.4.m4.1.1.3">
          int
         </mtext>
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">
       R_{\text{int}}
      </annotation>
     </semantics>
    </math>
    alongside
    <math alttext="R" class="ltx_Math" display="inline" id="S3.p3.5.m5.1">
     <semantics id="S3.p3.5.m5.1a">
      <mi id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml">
       R
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b">
       <ci id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1">
        𝑅
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">
       R
      </annotation>
     </semantics>
    </math>
    ensures that the agent maximizes the general reward function
    <math alttext="R" class="ltx_Math" display="inline" id="S3.p3.6.m6.1">
     <semantics id="S3.p3.6.m6.1a">
      <mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">
       R
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b">
       <ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">
        𝑅
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">
       R
      </annotation>
     </semantics>
    </math>
    without getting stuck in local optima.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Dreaming with LLMs
  </h2>
  <div class="ltx_para" id="S4.p1">
   <p class="ltx_p" id="S4.p1.1">
    This section systematically introduces how DLLM obtains guiding information (goals) from LLMs and utilizes them to incentivize the agent to manage long-term decision-making.
   </p>
  </div>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Goal Generation by Prompting LLMs
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     To generate the natural language representations of goals and their corresponding vector embeddings, DLLM utilizes a pretrained SentenceBert model
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib43" title="">
       43
      </a>
      ]
     </cite>
     and GPT
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib39" title="">
       39
      </a>
      ]
     </cite>
     . For GPT, we use two versions including GPT-3.5-turbo-0315 and GPT-4-32k-0315, which we will refer to as GPT-3.5 and GPT-4 respectively in the following text.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p2">
    <p class="ltx_p" id="S4.SS1.p2.13">
     We initially obtain the natural language representation, denoted as
     <math alttext="o_{l}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1">
      <semantics id="S4.SS1.p2.1.m1.1a">
       <msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">
        <mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">
         o
        </mi>
        <mi id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b">
        <apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">
          𝑜
         </ci>
         <ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">
        o_{l}
       </annotation>
      </semantics>
     </math>
     (
     <math alttext="l" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1">
      <semantics id="S4.SS1.p2.2.m2.1a">
       <mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">
        l
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b">
        <ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">
         𝑙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">
        l
       </annotation>
      </semantics>
     </math>
     denotes language, and
     <math alttext="o_{l}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1">
      <semantics id="S4.SS1.p2.3.m3.1a">
       <msub id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">
        <mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">
         o
        </mi>
        <mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b">
        <apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">
          𝑜
         </ci>
         <ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">
        o_{l}
       </annotation>
      </semantics>
     </math>
     means natural language description of
     <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1">
      <semantics id="S4.SS1.p2.4.m4.1a">
       <mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">
        o
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b">
        <ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">
         𝑜
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">
        o
       </annotation>
      </semantics>
     </math>
     ), corresponding to the information in the agent’s current observation
     <math alttext="o" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1">
      <semantics id="S4.SS1.p2.5.m5.1a">
       <mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">
        o
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b">
        <ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">
         𝑜
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">
        o
       </annotation>
      </semantics>
     </math>
     . This
     <math alttext="o_{l}" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1">
      <semantics id="S4.SS1.p2.6.m6.1a">
       <msub id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">
        <mi id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">
         o
        </mi>
        <mi id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b">
        <apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">
          𝑜
         </ci>
         <ci id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">
        o_{l}
       </annotation>
      </semantics>
     </math>
     may include details such as the agent’s position, inventory, health status, and field of view. We use an observation captioner to obtain the
     <math alttext="o_{l}" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m7.1">
      <semantics id="S4.SS1.p2.7.m7.1a">
       <msub id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml">
        <mi id="S4.SS1.p2.7.m7.1.1.2" xref="S4.SS1.p2.7.m7.1.1.2.cmml">
         o
        </mi>
        <mi id="S4.SS1.p2.7.m7.1.1.3" xref="S4.SS1.p2.7.m7.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b">
        <apply id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.p2.7.m7.1.1.2">
          𝑜
         </ci>
         <ci id="S4.SS1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.p2.7.m7.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">
        o_{l}
       </annotation>
      </semantics>
     </math>
     following ELLM
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib13" title="">
       13
      </a>
      ]
     </cite>
     (see Appendix
     <a class="ltx_ref" href="#A3" title="Appendix C Details of Captioners ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       C
      </span>
     </a>
     for more details of captioners). Subsequently, we provide
     <math alttext="o_{l}" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m8.1">
      <semantics id="S4.SS1.p2.8.m8.1a">
       <msub id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml">
        <mi id="S4.SS1.p2.8.m8.1.1.2" xref="S4.SS1.p2.8.m8.1.1.2.cmml">
         o
        </mi>
        <mi id="S4.SS1.p2.8.m8.1.1.3" xref="S4.SS1.p2.8.m8.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.1b">
        <apply id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p2.8.m8.1.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p2.8.m8.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.2">
          𝑜
         </ci>
         <ci id="S4.SS1.p2.8.m8.1.1.3.cmml" xref="S4.SS1.p2.8.m8.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.1c">
        o_{l}
       </annotation>
      </semantics>
     </math>
     and other possible language output from the environment (e.g., the task description in HomeGrid) and the description of environmental mechanisms to LLMs to get a fixed number of goals
     <math alttext="g^{l}_{1:K}" class="ltx_Math" display="inline" id="S4.SS1.p2.9.m9.1">
      <semantics id="S4.SS1.p2.9.m9.1a">
       <msubsup id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml">
        <mi id="S4.SS1.p2.9.m9.1.1.2.2" xref="S4.SS1.p2.9.m9.1.1.2.2.cmml">
         g
        </mi>
        <mrow id="S4.SS1.p2.9.m9.1.1.3" xref="S4.SS1.p2.9.m9.1.1.3.cmml">
         <mn id="S4.SS1.p2.9.m9.1.1.3.2" xref="S4.SS1.p2.9.m9.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS1.p2.9.m9.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p2.9.m9.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS1.p2.9.m9.1.1.3.3" xref="S4.SS1.p2.9.m9.1.1.3.3.cmml">
          K
         </mi>
        </mrow>
        <mi id="S4.SS1.p2.9.m9.1.1.2.3" xref="S4.SS1.p2.9.m9.1.1.2.3.cmml">
         l
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m9.1b">
        <apply id="S4.SS1.p2.9.m9.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p2.9.m9.1.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS1.p2.9.m9.1.1.2.cmml" xref="S4.SS1.p2.9.m9.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p2.9.m9.1.1.2.1.cmml" xref="S4.SS1.p2.9.m9.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS1.p2.9.m9.1.1.2.2.cmml" xref="S4.SS1.p2.9.m9.1.1.2.2">
           𝑔
          </ci>
          <ci id="S4.SS1.p2.9.m9.1.1.2.3.cmml" xref="S4.SS1.p2.9.m9.1.1.2.3">
           𝑙
          </ci>
         </apply>
         <apply id="S4.SS1.p2.9.m9.1.1.3.cmml" xref="S4.SS1.p2.9.m9.1.1.3">
          <ci id="S4.SS1.p2.9.m9.1.1.3.1.cmml" xref="S4.SS1.p2.9.m9.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS1.p2.9.m9.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.9.m9.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS1.p2.9.m9.1.1.3.3.cmml" xref="S4.SS1.p2.9.m9.1.1.3.3">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.9.m9.1c">
        g^{l}_{1:K}
       </annotation>
      </semantics>
     </math>
     in the form of natural language, where
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.10.m10.1">
      <semantics id="S4.SS1.p2.10.m10.1a">
       <mi id="S4.SS1.p2.10.m10.1.1" xref="S4.SS1.p2.10.m10.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m10.1b">
        <ci id="S4.SS1.p2.10.m10.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.10.m10.1c">
        K
       </annotation>
      </semantics>
     </math>
     is a hyperparameter representing the expected number of goals returned by the LLM. We utilize SentenceBert to convert these goals from natural language into vector embeddings
     <math alttext="g_{1:K}" class="ltx_Math" display="inline" id="S4.SS1.p2.11.m11.1">
      <semantics id="S4.SS1.p2.11.m11.1a">
       <msub id="S4.SS1.p2.11.m11.1.1" xref="S4.SS1.p2.11.m11.1.1.cmml">
        <mi id="S4.SS1.p2.11.m11.1.1.2" xref="S4.SS1.p2.11.m11.1.1.2.cmml">
         g
        </mi>
        <mrow id="S4.SS1.p2.11.m11.1.1.3" xref="S4.SS1.p2.11.m11.1.1.3.cmml">
         <mn id="S4.SS1.p2.11.m11.1.1.3.2" xref="S4.SS1.p2.11.m11.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS1.p2.11.m11.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p2.11.m11.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS1.p2.11.m11.1.1.3.3" xref="S4.SS1.p2.11.m11.1.1.3.3.cmml">
          K
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m11.1b">
        <apply id="S4.SS1.p2.11.m11.1.1.cmml" xref="S4.SS1.p2.11.m11.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p2.11.m11.1.1.1.cmml" xref="S4.SS1.p2.11.m11.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p2.11.m11.1.1.2.cmml" xref="S4.SS1.p2.11.m11.1.1.2">
          𝑔
         </ci>
         <apply id="S4.SS1.p2.11.m11.1.1.3.cmml" xref="S4.SS1.p2.11.m11.1.1.3">
          <ci id="S4.SS1.p2.11.m11.1.1.3.1.cmml" xref="S4.SS1.p2.11.m11.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS1.p2.11.m11.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.11.m11.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS1.p2.11.m11.1.1.3.3.cmml" xref="S4.SS1.p2.11.m11.1.1.3.3">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.11.m11.1c">
        g_{1:K}
       </annotation>
      </semantics>
     </math>
     . For different environments, we utilize two specific approaches to obtain goals: 1) having the LLM generate responses for
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.12.m12.1">
      <semantics id="S4.SS1.p2.12.m12.1a">
       <mi id="S4.SS1.p2.12.m12.1.1" xref="S4.SS1.p2.12.m12.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m12.1b">
        <ci id="S4.SS1.p2.12.m12.1.1.cmml" xref="S4.SS1.p2.12.m12.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.12.m12.1c">
        K
       </annotation>
      </semantics>
     </math>
     arbitrary types of goals and 2) instructing the LLM to provide a goal for
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p2.13.m13.1">
      <semantics id="S4.SS1.p2.13.m13.1a">
       <mi id="S4.SS1.p2.13.m13.1.1" xref="S4.SS1.p2.13.m13.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m13.1b">
        <ci id="S4.SS1.p2.13.m13.1.1.cmml" xref="S4.SS1.p2.13.m13.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.13.m13.1c">
        K
       </annotation>
      </semantics>
     </math>
     specified types (e.g., determining which room to enter and specifying the corresponding action). The second approach is designed to standardize responses from the LLM and ensure that the goals output by the LLM cover all necessary aspects for task completion in complex scenarios.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Incorporating Decreased Intrinsic Rewards into Dreaming Processes
   </h3>
   <div class="ltx_para" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.14">
     At each online interaction step, we have a transition captioner that gives a language description
     <math alttext="u_{l}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1">
      <semantics id="S4.SS2.p1.1.m1.1a">
       <msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">
        <mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">
         u
        </mi>
        <mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b">
        <apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">
          𝑢
         </ci>
         <ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">
        u_{l}
       </annotation>
      </semantics>
     </math>
     of the dynamics between the observation and the next observation; the language description
     <math alttext="u_{l}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1">
      <semantics id="S4.SS2.p1.2.m2.1a">
       <msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">
        <mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">
         u
        </mi>
        <mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b">
        <apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">
          𝑢
         </ci>
         <ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">
        u_{l}
       </annotation>
      </semantics>
     </math>
     is then embedded into a vector embedding
     <math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1">
      <semantics id="S4.SS2.p1.3.m3.1a">
       <mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">
        u
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b">
        <ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">
         𝑢
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">
        u
       </annotation>
      </semantics>
     </math>
     . Given the sensory representation
     <math alttext="x_{0}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1">
      <semantics id="S4.SS2.p1.4.m4.1a">
       <msub id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">
        <mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">
         x
        </mi>
        <mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">
         0
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b">
        <apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">
          𝑥
         </ci>
         <cn id="S4.SS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p1.4.m4.1.1.3">
          0
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">
        x_{0}
       </annotation>
      </semantics>
     </math>
     , language description embedding of transition
     <math alttext="u_{0}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1">
      <semantics id="S4.SS2.p1.5.m5.1a">
       <msub id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">
        <mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">
         u
        </mi>
        <mn id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">
         0
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b">
        <apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">
          𝑢
         </ci>
         <cn id="S4.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p1.5.m5.1.1.3">
          0
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">
        u_{0}
       </annotation>
      </semantics>
     </math>
     , embeddings of goals
     <math alttext="g_{1:K}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1">
      <semantics id="S4.SS2.p1.6.m6.1a">
       <msub id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">
        <mi id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">
         g
        </mi>
        <mrow id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml">
         <mn id="S4.SS2.p1.6.m6.1.1.3.2" xref="S4.SS2.p1.6.m6.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS2.p1.6.m6.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.6.m6.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS2.p1.6.m6.1.1.3.3" xref="S4.SS2.p1.6.m6.1.1.3.3.cmml">
          K
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b">
        <apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">
          𝑔
         </ci>
         <apply id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3">
          <ci id="S4.SS2.p1.6.m6.1.1.3.1.cmml" xref="S4.SS2.p1.6.m6.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS2.p1.6.m6.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.6.m6.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS2.p1.6.m6.1.1.3.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3.3">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">
        g_{1:K}
       </annotation>
      </semantics>
     </math>
     , and intrinsic rewards for each goal
     <math alttext="i_{1:K}" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1">
      <semantics id="S4.SS2.p1.7.m7.1a">
       <msub id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">
        <mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">
         i
        </mi>
        <mrow id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">
         <mn id="S4.SS2.p1.7.m7.1.1.3.2" xref="S4.SS2.p1.7.m7.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS2.p1.7.m7.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.7.m7.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS2.p1.7.m7.1.1.3.3" xref="S4.SS2.p1.7.m7.1.1.3.3.cmml">
          K
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b">
        <apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">
          𝑖
         </ci>
         <apply id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">
          <ci id="S4.SS2.p1.7.m7.1.1.3.1.cmml" xref="S4.SS2.p1.7.m7.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS2.p1.7.m7.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.7.m7.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS2.p1.7.m7.1.1.3.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3.3">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">
        i_{1:K}
       </annotation>
      </semantics>
     </math>
     of replay inputs, the world model and actor produce a sequence of imagined latent states
     <math alttext="\hat{s}_{1:T}" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m8.1">
      <semantics id="S4.SS2.p1.8.m8.1a">
       <msub id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">
        <mover accent="true" id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">
         <mi id="S4.SS2.p1.8.m8.1.1.2.2" xref="S4.SS2.p1.8.m8.1.1.2.2.cmml">
          s
         </mi>
         <mo id="S4.SS2.p1.8.m8.1.1.2.1" xref="S4.SS2.p1.8.m8.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mrow id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml">
         <mn id="S4.SS2.p1.8.m8.1.1.3.2" xref="S4.SS2.p1.8.m8.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS2.p1.8.m8.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.8.m8.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS2.p1.8.m8.1.1.3.3" xref="S4.SS2.p1.8.m8.1.1.3.3.cmml">
          T
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b">
        <apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2">
          <ci id="S4.SS2.p1.8.m8.1.1.2.1.cmml" xref="S4.SS2.p1.8.m8.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS2.p1.8.m8.1.1.2.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2.2">
           𝑠
          </ci>
         </apply>
         <apply id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3">
          <ci id="S4.SS2.p1.8.m8.1.1.3.1.cmml" xref="S4.SS2.p1.8.m8.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS2.p1.8.m8.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.8.m8.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS2.p1.8.m8.1.1.3.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3.3">
           𝑇
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">
        \hat{s}_{1:T}
       </annotation>
      </semantics>
     </math>
     , actions
     <math alttext="\hat{a}_{1:T}" class="ltx_Math" display="inline" id="S4.SS2.p1.9.m9.1">
      <semantics id="S4.SS2.p1.9.m9.1a">
       <msub id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">
        <mover accent="true" id="S4.SS2.p1.9.m9.1.1.2" xref="S4.SS2.p1.9.m9.1.1.2.cmml">
         <mi id="S4.SS2.p1.9.m9.1.1.2.2" xref="S4.SS2.p1.9.m9.1.1.2.2.cmml">
          a
         </mi>
         <mo id="S4.SS2.p1.9.m9.1.1.2.1" xref="S4.SS2.p1.9.m9.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mrow id="S4.SS2.p1.9.m9.1.1.3" xref="S4.SS2.p1.9.m9.1.1.3.cmml">
         <mn id="S4.SS2.p1.9.m9.1.1.3.2" xref="S4.SS2.p1.9.m9.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS2.p1.9.m9.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.9.m9.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS2.p1.9.m9.1.1.3.3" xref="S4.SS2.p1.9.m9.1.1.3.3.cmml">
          T
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b">
        <apply id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p1.9.m9.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.2">
          <ci id="S4.SS2.p1.9.m9.1.1.2.1.cmml" xref="S4.SS2.p1.9.m9.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS2.p1.9.m9.1.1.2.2.cmml" xref="S4.SS2.p1.9.m9.1.1.2.2">
           𝑎
          </ci>
         </apply>
         <apply id="S4.SS2.p1.9.m9.1.1.3.cmml" xref="S4.SS2.p1.9.m9.1.1.3">
          <ci id="S4.SS2.p1.9.m9.1.1.3.1.cmml" xref="S4.SS2.p1.9.m9.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS2.p1.9.m9.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.9.m9.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS2.p1.9.m9.1.1.3.3.cmml" xref="S4.SS2.p1.9.m9.1.1.3.3">
           𝑇
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">
        \hat{a}_{1:T}
       </annotation>
      </semantics>
     </math>
     , rewards
     <math alttext="\hat{r}_{1:T}" class="ltx_Math" display="inline" id="S4.SS2.p1.10.m10.1">
      <semantics id="S4.SS2.p1.10.m10.1a">
       <msub id="S4.SS2.p1.10.m10.1.1" xref="S4.SS2.p1.10.m10.1.1.cmml">
        <mover accent="true" id="S4.SS2.p1.10.m10.1.1.2" xref="S4.SS2.p1.10.m10.1.1.2.cmml">
         <mi id="S4.SS2.p1.10.m10.1.1.2.2" xref="S4.SS2.p1.10.m10.1.1.2.2.cmml">
          r
         </mi>
         <mo id="S4.SS2.p1.10.m10.1.1.2.1" xref="S4.SS2.p1.10.m10.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mrow id="S4.SS2.p1.10.m10.1.1.3" xref="S4.SS2.p1.10.m10.1.1.3.cmml">
         <mn id="S4.SS2.p1.10.m10.1.1.3.2" xref="S4.SS2.p1.10.m10.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS2.p1.10.m10.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.10.m10.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS2.p1.10.m10.1.1.3.3" xref="S4.SS2.p1.10.m10.1.1.3.3.cmml">
          T
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b">
        <apply id="S4.SS2.p1.10.m10.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.10.m10.1.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p1.10.m10.1.1.2.cmml" xref="S4.SS2.p1.10.m10.1.1.2">
          <ci id="S4.SS2.p1.10.m10.1.1.2.1.cmml" xref="S4.SS2.p1.10.m10.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS2.p1.10.m10.1.1.2.2.cmml" xref="S4.SS2.p1.10.m10.1.1.2.2">
           𝑟
          </ci>
         </apply>
         <apply id="S4.SS2.p1.10.m10.1.1.3.cmml" xref="S4.SS2.p1.10.m10.1.1.3">
          <ci id="S4.SS2.p1.10.m10.1.1.3.1.cmml" xref="S4.SS2.p1.10.m10.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS2.p1.10.m10.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.10.m10.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS2.p1.10.m10.1.1.3.3.cmml" xref="S4.SS2.p1.10.m10.1.1.3.3">
           𝑇
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">
        \hat{r}_{1:T}
       </annotation>
      </semantics>
     </math>
     , transitions
     <math alttext="\hat{u}_{1:T}" class="ltx_Math" display="inline" id="S4.SS2.p1.11.m11.1">
      <semantics id="S4.SS2.p1.11.m11.1a">
       <msub id="S4.SS2.p1.11.m11.1.1" xref="S4.SS2.p1.11.m11.1.1.cmml">
        <mover accent="true" id="S4.SS2.p1.11.m11.1.1.2" xref="S4.SS2.p1.11.m11.1.1.2.cmml">
         <mi id="S4.SS2.p1.11.m11.1.1.2.2" xref="S4.SS2.p1.11.m11.1.1.2.2.cmml">
          u
         </mi>
         <mo id="S4.SS2.p1.11.m11.1.1.2.1" xref="S4.SS2.p1.11.m11.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mrow id="S4.SS2.p1.11.m11.1.1.3" xref="S4.SS2.p1.11.m11.1.1.3.cmml">
         <mn id="S4.SS2.p1.11.m11.1.1.3.2" xref="S4.SS2.p1.11.m11.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS2.p1.11.m11.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.11.m11.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS2.p1.11.m11.1.1.3.3" xref="S4.SS2.p1.11.m11.1.1.3.3.cmml">
          T
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m11.1b">
        <apply id="S4.SS2.p1.11.m11.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.11.m11.1.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p1.11.m11.1.1.2.cmml" xref="S4.SS2.p1.11.m11.1.1.2">
          <ci id="S4.SS2.p1.11.m11.1.1.2.1.cmml" xref="S4.SS2.p1.11.m11.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS2.p1.11.m11.1.1.2.2.cmml" xref="S4.SS2.p1.11.m11.1.1.2.2">
           𝑢
          </ci>
         </apply>
         <apply id="S4.SS2.p1.11.m11.1.1.3.cmml" xref="S4.SS2.p1.11.m11.1.1.3">
          <ci id="S4.SS2.p1.11.m11.1.1.3.1.cmml" xref="S4.SS2.p1.11.m11.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS2.p1.11.m11.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.11.m11.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS2.p1.11.m11.1.1.3.3.cmml" xref="S4.SS2.p1.11.m11.1.1.3.3">
           𝑇
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.11.m11.1c">
        \hat{u}_{1:T}
       </annotation>
      </semantics>
     </math>
     and continuation flags
     <math alttext="\hat{c}_{1:T}" class="ltx_Math" display="inline" id="S4.SS2.p1.12.m12.1">
      <semantics id="S4.SS2.p1.12.m12.1a">
       <msub id="S4.SS2.p1.12.m12.1.1" xref="S4.SS2.p1.12.m12.1.1.cmml">
        <mover accent="true" id="S4.SS2.p1.12.m12.1.1.2" xref="S4.SS2.p1.12.m12.1.1.2.cmml">
         <mi id="S4.SS2.p1.12.m12.1.1.2.2" xref="S4.SS2.p1.12.m12.1.1.2.2.cmml">
          c
         </mi>
         <mo id="S4.SS2.p1.12.m12.1.1.2.1" xref="S4.SS2.p1.12.m12.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mrow id="S4.SS2.p1.12.m12.1.1.3" xref="S4.SS2.p1.12.m12.1.1.3.cmml">
         <mn id="S4.SS2.p1.12.m12.1.1.3.2" xref="S4.SS2.p1.12.m12.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS2.p1.12.m12.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.12.m12.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS2.p1.12.m12.1.1.3.3" xref="S4.SS2.p1.12.m12.1.1.3.3.cmml">
          T
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m12.1b">
        <apply id="S4.SS2.p1.12.m12.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p1.12.m12.1.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p1.12.m12.1.1.2.cmml" xref="S4.SS2.p1.12.m12.1.1.2">
          <ci id="S4.SS2.p1.12.m12.1.1.2.1.cmml" xref="S4.SS2.p1.12.m12.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS2.p1.12.m12.1.1.2.2.cmml" xref="S4.SS2.p1.12.m12.1.1.2.2">
           𝑐
          </ci>
         </apply>
         <apply id="S4.SS2.p1.12.m12.1.1.3.cmml" xref="S4.SS2.p1.12.m12.1.1.3">
          <ci id="S4.SS2.p1.12.m12.1.1.3.1.cmml" xref="S4.SS2.p1.12.m12.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS2.p1.12.m12.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.12.m12.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS2.p1.12.m12.1.1.3.3.cmml" xref="S4.SS2.p1.12.m12.1.1.3.3">
           𝑇
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.12.m12.1c">
        \hat{c}_{1:T}
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p1.13.m13.1">
      <semantics id="S4.SS2.p1.13.m13.1a">
       <mi id="S4.SS2.p1.13.m13.1.1" xref="S4.SS2.p1.13.m13.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m13.1b">
        <ci id="S4.SS2.p1.13.m13.1.1.cmml" xref="S4.SS2.p1.13.m13.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.13.m13.1c">
        T
       </annotation>
      </semantics>
     </math>
     represents the total length of model rollouts. We use cosine similarity to measure the matching score
     <math alttext="w" class="ltx_Math" display="inline" id="S4.SS2.p1.14.m14.1">
      <semantics id="S4.SS2.p1.14.m14.1a">
       <mi id="S4.SS2.p1.14.m14.1.1" xref="S4.SS2.p1.14.m14.1.1.cmml">
        w
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m14.1b">
        <ci id="S4.SS2.p1.14.m14.1.1.cmml" xref="S4.SS2.p1.14.m14.1.1">
         𝑤
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.14.m14.1c">
        w
       </annotation>
      </semantics>
     </math>
     between transitions and goals:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E1X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle w\left(\hat{u}\mid g\right)=\begin{cases}\frac{\hat{u}\cdot g}{\left\|\hat{u}\right\|\|g\|}&amp;\text{if }\frac{\hat{u}\cdot g}{\left\|\hat{u}\right\|\|g\|}&gt;M\\
0&amp;\text{ otherwise }\end{cases}," class="ltx_Math" display="inline" id="S4.E1X.2.1.1.m1.1">
         <semantics id="S4.E1X.2.1.1.m1.1a">
          <mrow id="S4.E1X.2.1.1.m1.1.1.1" xref="S4.E1X.2.1.1.m1.1.1.1.1.cmml">
           <mrow id="S4.E1X.2.1.1.m1.1.1.1.1" xref="S4.E1X.2.1.1.m1.1.1.1.1.cmml">
            <mrow id="S4.E1X.2.1.1.m1.1.1.1.1.1" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.cmml">
             <mi id="S4.E1X.2.1.1.m1.1.1.1.1.1.3" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.3.cmml">
              w
             </mi>
             <mo id="S4.E1X.2.1.1.m1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">
              <mo id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">
               <mover accent="true" id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">
                <mi id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">
                 u
                </mi>
                <mo id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml">
                 ^
                </mo>
               </mover>
               <mo id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
                ∣
               </mo>
               <mi id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">
                g
               </mi>
              </mrow>
              <mo id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="S4.E1X.2.1.1.m1.1.1.1.1.2" xref="S4.E1X.2.1.1.m1.1.1.1.1.2.cmml">
             =
            </mo>
            <mrow id="S4.E1.m1.4.4.4.4.4.4a" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">
             <mo id="S4.E1.m1.4.4.4.4.4.4a.5" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.1.cmml">
              {
             </mo>
             <mtable columnspacing="5pt" id="S4.E1.m1.4.4.4.4.4.4.4a" rowspacing="0pt" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">
              <mtr id="S4.E1.m1.4.4.4.4.4.4.4aa" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">
               <mtd class="ltx_align_left" columnalign="left" id="S4.E1.m1.4.4.4.4.4.4.4ab" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">
                <mfrac id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.cmml">
                 <mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.cmml">
                  <mover accent="true" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.cmml">
                   <mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.2.cmml">
                    u
                   </mi>
                   <mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.1.cmml">
                    ^
                   </mo>
                  </mover>
                  <mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.1" lspace="0.222em" rspace="0.222em" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.1.cmml">
                   ⋅
                  </mo>
                  <mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.3.cmml">
                   g
                  </mi>
                 </mrow>
                 <mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.cmml">
                  <mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.1.cmml">
                   <mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.2.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.1.1.cmml">
                    ‖
                   </mo>
                   <mover accent="true" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml">
                    <mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml">
                     u
                    </mi>
                    <mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.cmml">
                     ^
                    </mo>
                   </mover>
                   <mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.1.1.cmml">
                    ‖
                   </mo>
                  </mrow>
                  <mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.3" lspace="0em" rspace="0em" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.3.cmml">
                   ​
                  </mo>
                  <mrow id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.1.cmml">
                   <mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.2.1" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.1.1.cmml">
                    ‖
                   </mo>
                   <mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.2.cmml">
                    g
                   </mi>
                   <mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.2.2" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.1.1.cmml">
                    ‖
                   </mo>
                  </mrow>
                 </mrow>
                </mfrac>
               </mtd>
               <mtd class="ltx_align_left" columnalign="left" id="S4.E1.m1.4.4.4.4.4.4.4ac" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">
                <mrow id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml">
                 <mrow id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml">
                  <mtext id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2a.cmml">
                   if
                  </mtext>
                  <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1" lspace="0em" rspace="0em" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1.cmml">
                   ​
                  </mo>
                  <mfrac id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml">
                   <mrow id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.cmml">
                    <mover accent="true" id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.cmml">
                     <mi id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.2.cmml">
                      u
                     </mi>
                     <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.1" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.1.cmml">
                      ^
                     </mo>
                    </mover>
                    <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.1" lspace="0.222em" rspace="0.222em" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.1.cmml">
                     ⋅
                    </mo>
                    <mi id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.3" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.3.cmml">
                     g
                    </mi>
                   </mrow>
                   <mrow id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.cmml">
                    <mrow id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.1.cmml">
                     <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.2.1" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.1.1.cmml">
                      ‖
                     </mo>
                     <mover accent="true" id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.cmml">
                      <mi id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.2.cmml">
                       u
                      </mi>
                      <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.1" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.1.cmml">
                       ^
                      </mo>
                     </mover>
                     <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.2.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.1.1.cmml">
                      ‖
                     </mo>
                    </mrow>
                    <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.3" lspace="0em" rspace="0em" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.3.cmml">
                     ​
                    </mo>
                    <mrow id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.1.cmml">
                     <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.2.1" stretchy="false" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.1.1.cmml">
                      ‖
                     </mo>
                     <mi id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.2" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.2.cmml">
                      g
                     </mi>
                     <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.2.2" stretchy="false" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.1.1.cmml">
                      ‖
                     </mo>
                    </mrow>
                   </mrow>
                  </mfrac>
                 </mrow>
                 <mo id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.3" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.3.cmml">
                  &gt;
                 </mo>
                 <mi id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.5" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.5.cmml">
                  M
                 </mi>
                </mrow>
               </mtd>
              </mtr>
              <mtr id="S4.E1.m1.4.4.4.4.4.4.4ad" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">
               <mtd class="ltx_align_left" columnalign="left" id="S4.E1.m1.4.4.4.4.4.4.4ae" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">
                <mn id="S4.E1.m1.3.3.3.3.3.3.3.3.1.1.mf" xref="S4.E1.m1.3.3.3.3.3.3.3.3.1.1.mf.cmml">
                 0
                </mn>
               </mtd>
               <mtd class="ltx_align_left" columnalign="left" id="S4.E1.m1.4.4.4.4.4.4.4af" xref="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml">
                <mtext id="S4.E1.m1.4.4.4.4.4.4.4.4.2.1.mf" xref="S4.E1.m1.4.4.4.4.4.4.4.4.2.1.mfa.cmml">
                 otherwise
                </mtext>
               </mtd>
              </mtr>
             </mtable>
            </mrow>
           </mrow>
           <mo id="S4.E1X.2.1.1.m1.1.1.1.2" xref="S4.E1X.2.1.1.m1.1.1.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E1X.2.1.1.m1.1b">
           <apply id="S4.E1X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E1X.2.1.1.m1.1.1.1">
            <eq id="S4.E1X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.2">
            </eq>
            <apply id="S4.E1X.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1">
             <times id="S4.E1X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.2">
             </times>
             <ci id="S4.E1X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.3">
              𝑤
             </ci>
             <apply id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1">
              <csymbol cd="latexml" id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.1">
               conditional
              </csymbol>
              <apply id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2">
               <ci id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.1">
                ^
               </ci>
               <ci id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.2.2">
                𝑢
               </ci>
              </apply>
              <ci id="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1X.2.1.1.m1.1.1.1.1.1.1.1.1.3">
               𝑔
              </ci>
             </apply>
            </apply>
            <apply id="S4.E1X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.4.4.4.4.4.4a">
             <csymbol cd="latexml" id="S4.E1X.2.1.1.m1.1.1.1.1.3.1.1.cmml" xref="S4.E1.m1.4.4.4.4.4.4a.5">
              cases
             </csymbol>
             <apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf">
              <divide id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf">
              </divide>
              <apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4">
               <ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.1">
                ⋅
               </ci>
               <apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2">
                <ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.1">
                 ^
                </ci>
                <ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.2.2">
                 𝑢
                </ci>
               </apply>
               <ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.4.3">
                𝑔
               </ci>
              </apply>
              <apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2">
               <times id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.3">
               </times>
               <apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.2">
                <csymbol cd="latexml" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.4.2.1">
                 norm
                </csymbol>
                <apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1">
                 <ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.1">
                  ^
                 </ci>
                 <ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.2">
                  𝑢
                 </ci>
                </apply>
               </apply>
               <apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.2">
                <csymbol cd="latexml" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.5.2.1">
                 norm
                </csymbol>
                <ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.mf.2.2.2">
                 𝑔
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf">
              <gt id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.3.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.3">
              </gt>
              <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4">
               <times id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1">
               </times>
               <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2a.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2">
                <mtext id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2">
                 if
                </mtext>
               </ci>
               <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2">
                <divide id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2">
                </divide>
                <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4">
                 <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.1">
                  ⋅
                 </ci>
                 <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2">
                  <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.1">
                   ^
                  </ci>
                  <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.2.2">
                   𝑢
                  </ci>
                 </apply>
                 <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.3.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.4.3">
                  𝑔
                 </ci>
                </apply>
                <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2">
                 <times id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.3.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.3">
                 </times>
                 <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.2">
                  <csymbol cd="latexml" id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.1.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.4.2.1">
                   norm
                  </csymbol>
                  <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1">
                   <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.1">
                    ^
                   </ci>
                   <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.1.1.1.2">
                    𝑢
                   </ci>
                  </apply>
                 </apply>
                 <apply id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.2">
                  <csymbol cd="latexml" id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.1.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.5.2.1">
                   norm
                  </csymbol>
                  <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.2">
                   𝑔
                  </ci>
                 </apply>
                </apply>
               </apply>
              </apply>
              <ci id="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.5.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2.2.2.1.mf.5">
               𝑀
              </ci>
             </apply>
             <cn id="S4.E1.m1.3.3.3.3.3.3.3.3.1.1.mf.cmml" type="integer" xref="S4.E1.m1.3.3.3.3.3.3.3.3.1.1.mf">
              0
             </cn>
             <ci id="S4.E1.m1.4.4.4.4.4.4.4.4.2.1.mfa.cmml" xref="S4.E1.m1.4.4.4.4.4.4.4.4.2.1.mf">
              <mtext id="S4.E1.m1.4.4.4.4.4.4.4.4.2.1.mf.cmml" xref="S4.E1.m1.4.4.4.4.4.4.4.4.2.1.mf">
               otherwise
              </mtext>
             </ci>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E1X.2.1.1.m1.1c">
           \displaystyle w\left(\hat{u}\mid g\right)=\begin{cases}\frac{\hat{u}\cdot g}{\left\|\hat{u}\right\|\|g\|}&amp;\text{if }\frac{\hat{u}\cdot g}{\left\|\hat{u}\right\|\|g\|}&gt;M\\
0&amp;\text{ otherwise }\end{cases},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para" id="S4.SS2.p2">
    <p class="ltx_p" id="S4.SS2.p2.3">
     where
     <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1">
      <semantics id="S4.SS2.p2.1.m1.1a">
       <mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b">
        <ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">
        M
       </annotation>
      </semantics>
     </math>
     is a similarity threshold hyperparameter. In this step, we aim to disregard low cosine similarities to some extent, thereby preventing misleading guidance. Moreover, within a sequence, a goal may be triggered multiple times. We aim to avoid assigning intrinsic rewards to the same goal multiple times during a single rollout process, as it could lead the agent to perform simple actions repeatedly and eventually diminish the exploration of more complex behaviors. Hence, we only retain a specific goal’s matching score when it first exceeds
     <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1">
      <semantics id="S4.SS2.p2.2.m2.1a">
       <mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b">
        <ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">
        M
       </annotation>
      </semantics>
     </math>
     in the sequence. The method to calculate the intrinsic reward for step
     <math alttext="t" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1">
      <semantics id="S4.SS2.p2.3.m3.1a">
       <mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b">
        <ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">
        t
       </annotation>
      </semantics>
     </math>
     in one model rollout is written as:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E2">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E2X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle r_{t}^{\text{int}}=\alpha\cdot\sum_{k=1}^{K}w_{t}^{k}\cdot i_{k}\cdot\begin{cases}1&amp;\text{if}\ \ t_{k}^{\prime}\ \ \text{exists}\ \ \text{and}\ \ t=t_{k}^{\prime}\\
0&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="inline" id="S4.E2X.2.1.1.m1.1">
         <semantics id="S4.E2X.2.1.1.m1.1a">
          <mrow id="S4.E2X.2.1.1.m1.1.1" xref="S4.E2X.2.1.1.m1.1.1.cmml">
           <msubsup id="S4.E2X.2.1.1.m1.1.1.2" xref="S4.E2X.2.1.1.m1.1.1.2.cmml">
            <mi id="S4.E2X.2.1.1.m1.1.1.2.2.2" xref="S4.E2X.2.1.1.m1.1.1.2.2.2.cmml">
             r
            </mi>
            <mi id="S4.E2X.2.1.1.m1.1.1.2.2.3" xref="S4.E2X.2.1.1.m1.1.1.2.2.3.cmml">
             t
            </mi>
            <mtext id="S4.E2X.2.1.1.m1.1.1.2.3" xref="S4.E2X.2.1.1.m1.1.1.2.3a.cmml">
             int
            </mtext>
           </msubsup>
           <mo id="S4.E2X.2.1.1.m1.1.1.1" xref="S4.E2X.2.1.1.m1.1.1.1.cmml">
            =
           </mo>
           <mrow id="S4.E2X.2.1.1.m1.1.1.3" xref="S4.E2X.2.1.1.m1.1.1.3.cmml">
            <mi id="S4.E2X.2.1.1.m1.1.1.3.2" xref="S4.E2X.2.1.1.m1.1.1.3.2.cmml">
             α
            </mi>
            <mo id="S4.E2X.2.1.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E2X.2.1.1.m1.1.1.3.1.cmml">
             ⋅
            </mo>
            <mrow id="S4.E2X.2.1.1.m1.1.1.3.3" xref="S4.E2X.2.1.1.m1.1.1.3.3.cmml">
             <mstyle displaystyle="true" id="S4.E2X.2.1.1.m1.1.1.3.3.1" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.cmml">
              <munderover id="S4.E2X.2.1.1.m1.1.1.3.3.1a" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.cmml">
               <mo id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.2" movablelimits="false" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.2.cmml">
                ∑
               </mo>
               <mrow id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.cmml">
                <mi id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.2" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.2.cmml">
                 k
                </mi>
                <mo id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.1" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.1.cmml">
                 =
                </mo>
                <mn id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.3" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.3.cmml">
                 1
                </mn>
               </mrow>
               <mi id="S4.E2X.2.1.1.m1.1.1.3.3.1.3" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.3.cmml">
                K
               </mi>
              </munderover>
             </mstyle>
             <mrow id="S4.E2X.2.1.1.m1.1.1.3.3.2" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.cmml">
              <msubsup id="S4.E2X.2.1.1.m1.1.1.3.3.2.2" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2.cmml">
               <mi id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.2" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.2.cmml">
                w
               </mi>
               <mi id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.3" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.3.cmml">
                t
               </mi>
               <mi id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.3" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2.3.cmml">
                k
               </mi>
              </msubsup>
              <mo id="S4.E2X.2.1.1.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.1.cmml">
               ⋅
              </mo>
              <msub id="S4.E2X.2.1.1.m1.1.1.3.3.2.3" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.3.cmml">
               <mi id="S4.E2X.2.1.1.m1.1.1.3.3.2.3.2" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.3.2.cmml">
                i
               </mi>
               <mi id="S4.E2X.2.1.1.m1.1.1.3.3.2.3.3" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.3.3.cmml">
                k
               </mi>
              </msub>
              <mo id="S4.E2X.2.1.1.m1.1.1.3.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.1.cmml">
               ⋅
              </mo>
              <mrow id="S4.E2.m1.4.4.4.4.4.4a" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml">
               <mo id="S4.E2.m1.4.4.4.4.4.4a.5" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.1.cmml">
                {
               </mo>
               <mtable columnspacing="5pt" id="S4.E2.m1.4.4.4.4.4.4.4a" rowspacing="0pt" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml">
                <mtr id="S4.E2.m1.4.4.4.4.4.4.4aa" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml">
                 <mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4.4.4.4.4ab" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml">
                  <mn id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.mf" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.cmml">
                   1
                  </mn>
                 </mtd>
                 <mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4.4.4.4.4ac" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml">
                  <mrow id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml">
                   <mrow id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.2.cmml">
                    <mtext id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.1" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.1a.cmml">
                     if
                    </mtext>
                    <mspace id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.2" width="1em" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.2.cmml">
                    </mspace>
                    <msubsup id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.cmml">
                     <mi id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.2" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.2.cmml">
                      t
                     </mi>
                     <mi id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.3" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.3.cmml">
                      k
                     </mi>
                     <mo id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.3" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.3.cmml">
                      ′
                     </mo>
                    </msubsup>
                    <mspace id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.3" width="1em" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.2.cmml">
                    </mspace>
                    <mtext id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.2" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.2a.cmml">
                     exists
                    </mtext>
                    <mspace id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.4" width="1em" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.2.cmml">
                    </mspace>
                    <mtext id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.3" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.3a.cmml">
                     and
                    </mtext>
                    <mspace id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.5" width="1em" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.2.cmml">
                    </mspace>
                    <mi id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.4" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml">
                     t
                    </mi>
                   </mrow>
                   <mo id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.6" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.6.cmml">
                    =
                   </mo>
                   <msubsup id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.cmml">
                    <mi id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.2" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.2.cmml">
                     t
                    </mi>
                    <mi id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.3" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.3.cmml">
                     k
                    </mi>
                    <mo id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.3" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.3.cmml">
                     ′
                    </mo>
                   </msubsup>
                  </mrow>
                 </mtd>
                </mtr>
                <mtr id="S4.E2.m1.4.4.4.4.4.4.4ad" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml">
                 <mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4.4.4.4.4ae" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml">
                  <mn id="S4.E2.m1.3.3.3.3.3.3.3.3.1.1.mf" xref="S4.E2.m1.3.3.3.3.3.3.3.3.1.1.mf.cmml">
                   0
                  </mn>
                 </mtd>
                 <mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4.4.4.4.4af" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml">
                  <mtext id="S4.E2.m1.4.4.4.4.4.4.4.4.2.1.mf" xref="S4.E2.m1.4.4.4.4.4.4.4.4.2.1.mfa.cmml">
                   otherwise
                  </mtext>
                 </mtd>
                </mtr>
               </mtable>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E2X.2.1.1.m1.1b">
           <apply id="S4.E2X.2.1.1.m1.1.1.cmml" xref="S4.E2X.2.1.1.m1.1.1">
            <eq id="S4.E2X.2.1.1.m1.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.1">
            </eq>
            <apply id="S4.E2X.2.1.1.m1.1.1.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.2">
             <csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.2.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.2">
              superscript
             </csymbol>
             <apply id="S4.E2X.2.1.1.m1.1.1.2.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.2">
              <csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.2">
               subscript
              </csymbol>
              <ci id="S4.E2X.2.1.1.m1.1.1.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.2.2.2">
               𝑟
              </ci>
              <ci id="S4.E2X.2.1.1.m1.1.1.2.2.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.2.2.3">
               𝑡
              </ci>
             </apply>
             <ci id="S4.E2X.2.1.1.m1.1.1.2.3a.cmml" xref="S4.E2X.2.1.1.m1.1.1.2.3">
              <mtext id="S4.E2X.2.1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.E2X.2.1.1.m1.1.1.2.3">
               int
              </mtext>
             </ci>
            </apply>
            <apply id="S4.E2X.2.1.1.m1.1.1.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.3">
             <ci id="S4.E2X.2.1.1.m1.1.1.3.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.1">
              ⋅
             </ci>
             <ci id="S4.E2X.2.1.1.m1.1.1.3.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.2">
              𝛼
             </ci>
             <apply id="S4.E2X.2.1.1.m1.1.1.3.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3">
              <apply id="S4.E2X.2.1.1.m1.1.1.3.3.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1">
               <csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.3.3.1.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1">
                superscript
               </csymbol>
               <apply id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1">
                <csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1">
                 subscript
                </csymbol>
                <sum id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.2">
                </sum>
                <apply id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3">
                 <eq id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.1">
                 </eq>
                 <ci id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.2">
                  𝑘
                 </ci>
                 <cn id="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.2.3.3">
                  1
                 </cn>
                </apply>
               </apply>
               <ci id="S4.E2X.2.1.1.m1.1.1.3.3.1.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.1.3">
                𝐾
               </ci>
              </apply>
              <apply id="S4.E2X.2.1.1.m1.1.1.3.3.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2">
               <ci id="S4.E2X.2.1.1.m1.1.1.3.3.2.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.1">
                ⋅
               </ci>
               <apply id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2">
                <csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2">
                 superscript
                </csymbol>
                <apply id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2">
                 <csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2">
                  subscript
                 </csymbol>
                 <ci id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.2">
                  𝑤
                 </ci>
                 <ci id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2.2.3">
                  𝑡
                 </ci>
                </apply>
                <ci id="S4.E2X.2.1.1.m1.1.1.3.3.2.2.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.2.3">
                 𝑘
                </ci>
               </apply>
               <apply id="S4.E2X.2.1.1.m1.1.1.3.3.2.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.3">
                <csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.3.3.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.3">
                 subscript
                </csymbol>
                <ci id="S4.E2X.2.1.1.m1.1.1.3.3.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.3.2">
                 𝑖
                </ci>
                <ci id="S4.E2X.2.1.1.m1.1.1.3.3.2.3.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.3.3.2.3.3">
                 𝑘
                </ci>
               </apply>
               <apply id="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.cmml" xref="S4.E2.m1.4.4.4.4.4.4a">
                <csymbol cd="latexml" id="S4.E2X.2.1.1.m1.1.1.3.3.2.4.1.1.cmml" xref="S4.E2.m1.4.4.4.4.4.4a.5">
                 cases
                </csymbol>
                <cn id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.cmml" type="integer" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.mf">
                 1
                </cn>
                <apply id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf">
                 <eq id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.6.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.6">
                 </eq>
                 <list id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1">
                  <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.1a.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.1">
                   <mtext id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.1">
                    if
                   </mtext>
                  </ci>
                  <apply id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1">
                   <csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1">
                    superscript
                   </csymbol>
                   <apply id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1">
                    <csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1">
                     subscript
                    </csymbol>
                    <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.2">
                     𝑡
                    </ci>
                    <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.3.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.2.3">
                     𝑘
                    </ci>
                   </apply>
                   <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.3.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.5.1.1.3">
                    ′
                   </ci>
                  </apply>
                  <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.2a.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.2">
                   <mtext id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.2">
                    exists
                   </mtext>
                  </ci>
                  <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.3a.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.3">
                   <mtext id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.3.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.3">
                    and
                   </mtext>
                  </ci>
                  <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.4">
                   𝑡
                  </ci>
                 </list>
                 <apply id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7">
                  <csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7">
                   superscript
                  </csymbol>
                  <apply id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7">
                   <csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7">
                    subscript
                   </csymbol>
                   <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.2.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.2">
                    𝑡
                   </ci>
                   <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.3.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.2.3">
                    𝑘
                   </ci>
                  </apply>
                  <ci id="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.3.cmml" xref="S4.E2.m1.2.2.2.2.2.2.2.2.2.1.mf.7.3">
                   ′
                  </ci>
                 </apply>
                </apply>
                <cn id="S4.E2.m1.3.3.3.3.3.3.3.3.1.1.mf.cmml" type="integer" xref="S4.E2.m1.3.3.3.3.3.3.3.3.1.1.mf">
                 0
                </cn>
                <ci id="S4.E2.m1.4.4.4.4.4.4.4.4.2.1.mfa.cmml" xref="S4.E2.m1.4.4.4.4.4.4.4.4.2.1.mf">
                 <mtext id="S4.E2.m1.4.4.4.4.4.4.4.4.2.1.mf.cmml" xref="S4.E2.m1.4.4.4.4.4.4.4.4.2.1.mf">
                  otherwise
                 </mtext>
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E2X.2.1.1.m1.1c">
           \displaystyle r_{t}^{\text{int}}=\alpha\cdot\sum_{k=1}^{K}w_{t}^{k}\cdot i_{k}\cdot\begin{cases}1&amp;\text{if}\ \ t_{k}^{\prime}\ \ \text{exists}\ \ \text{and}\ \ t=t_{k}^{\prime}\\
0&amp;\text{otherwise}\end{cases}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS2.p2.10">
     where
     <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m1.1">
      <semantics id="S4.SS2.p2.4.m1.1a">
       <mi id="S4.SS2.p2.4.m1.1.1" xref="S4.SS2.p2.4.m1.1.1.cmml">
        α
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m1.1b">
        <ci id="S4.SS2.p2.4.m1.1.1.cmml" xref="S4.SS2.p2.4.m1.1.1">
         𝛼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.4.m1.1c">
        \alpha
       </annotation>
      </semantics>
     </math>
     is the hyperparameter that controls the scale of the intrinsic rewards,
     <math alttext="t^{\prime}_{k}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m2.1">
      <semantics id="S4.SS2.p2.5.m2.1a">
       <msubsup id="S4.SS2.p2.5.m2.1.1" xref="S4.SS2.p2.5.m2.1.1.cmml">
        <mi id="S4.SS2.p2.5.m2.1.1.2.2" xref="S4.SS2.p2.5.m2.1.1.2.2.cmml">
         t
        </mi>
        <mi id="S4.SS2.p2.5.m2.1.1.3" xref="S4.SS2.p2.5.m2.1.1.3.cmml">
         k
        </mi>
        <mo id="S4.SS2.p2.5.m2.1.1.2.3" xref="S4.SS2.p2.5.m2.1.1.2.3.cmml">
         ′
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m2.1b">
        <apply id="S4.SS2.p2.5.m2.1.1.cmml" xref="S4.SS2.p2.5.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p2.5.m2.1.1.1.cmml" xref="S4.SS2.p2.5.m2.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p2.5.m2.1.1.2.cmml" xref="S4.SS2.p2.5.m2.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p2.5.m2.1.1.2.1.cmml" xref="S4.SS2.p2.5.m2.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS2.p2.5.m2.1.1.2.2.cmml" xref="S4.SS2.p2.5.m2.1.1.2.2">
           𝑡
          </ci>
          <ci id="S4.SS2.p2.5.m2.1.1.2.3.cmml" xref="S4.SS2.p2.5.m2.1.1.2.3">
           ′
          </ci>
         </apply>
         <ci id="S4.SS2.p2.5.m2.1.1.3.cmml" xref="S4.SS2.p2.5.m2.1.1.3">
          𝑘
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.5.m2.1c">
        t^{\prime}_{k}
       </annotation>
      </semantics>
     </math>
     represents the time step
     <math alttext="t" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m3.1">
      <semantics id="S4.SS2.p2.6.m3.1a">
       <mi id="S4.SS2.p2.6.m3.1.1" xref="S4.SS2.p2.6.m3.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m3.1b">
        <ci id="S4.SS2.p2.6.m3.1.1.cmml" xref="S4.SS2.p2.6.m3.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.6.m3.1c">
        t
       </annotation>
      </semantics>
     </math>
     when the
     <math alttext="w^{k}_{t}" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m4.1">
      <semantics id="S4.SS2.p2.7.m4.1a">
       <msubsup id="S4.SS2.p2.7.m4.1.1" xref="S4.SS2.p2.7.m4.1.1.cmml">
        <mi id="S4.SS2.p2.7.m4.1.1.2.2" xref="S4.SS2.p2.7.m4.1.1.2.2.cmml">
         w
        </mi>
        <mi id="S4.SS2.p2.7.m4.1.1.3" xref="S4.SS2.p2.7.m4.1.1.3.cmml">
         t
        </mi>
        <mi id="S4.SS2.p2.7.m4.1.1.2.3" xref="S4.SS2.p2.7.m4.1.1.2.3.cmml">
         k
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m4.1b">
        <apply id="S4.SS2.p2.7.m4.1.1.cmml" xref="S4.SS2.p2.7.m4.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p2.7.m4.1.1.1.cmml" xref="S4.SS2.p2.7.m4.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS2.p2.7.m4.1.1.2.cmml" xref="S4.SS2.p2.7.m4.1.1">
          <csymbol cd="ambiguous" id="S4.SS2.p2.7.m4.1.1.2.1.cmml" xref="S4.SS2.p2.7.m4.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS2.p2.7.m4.1.1.2.2.cmml" xref="S4.SS2.p2.7.m4.1.1.2.2">
           𝑤
          </ci>
          <ci id="S4.SS2.p2.7.m4.1.1.2.3.cmml" xref="S4.SS2.p2.7.m4.1.1.2.3">
           𝑘
          </ci>
         </apply>
         <ci id="S4.SS2.p2.7.m4.1.1.3.cmml" xref="S4.SS2.p2.7.m4.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.7.m4.1c">
        w^{k}_{t}
       </annotation>
      </semantics>
     </math>
     first exceeds
     <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p2.8.m5.1">
      <semantics id="S4.SS2.p2.8.m5.1a">
       <mi id="S4.SS2.p2.8.m5.1.1" xref="S4.SS2.p2.8.m5.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m5.1b">
        <ci id="S4.SS2.p2.8.m5.1.1.cmml" xref="S4.SS2.p2.8.m5.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.8.m5.1c">
        M
       </annotation>
      </semantics>
     </math>
     within the range of
     <math alttext="1" class="ltx_Math" display="inline" id="S4.SS2.p2.9.m6.1">
      <semantics id="S4.SS2.p2.9.m6.1a">
       <mn id="S4.SS2.p2.9.m6.1.1" xref="S4.SS2.p2.9.m6.1.1.cmml">
        1
       </mn>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m6.1b">
        <cn id="S4.SS2.p2.9.m6.1.1.cmml" type="integer" xref="S4.SS2.p2.9.m6.1.1">
         1
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.9.m6.1c">
        1
       </annotation>
      </semantics>
     </math>
     to
     <math alttext="T" class="ltx_Math" display="inline" id="S4.SS2.p2.10.m7.1">
      <semantics id="S4.SS2.p2.10.m7.1a">
       <mi id="S4.SS2.p2.10.m7.1.1" xref="S4.SS2.p2.10.m7.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m7.1b">
        <ci id="S4.SS2.p2.10.m7.1.1.cmml" xref="S4.SS2.p2.10.m7.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.10.m7.1c">
        T
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS2.p3">
    <p class="ltx_p" id="S4.SS2.p3.6">
     Then, we give the method to calculate and decrease
     <math alttext="i_{1:K}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1">
      <semantics id="S4.SS2.p3.1.m1.1a">
       <msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">
        <mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">
         i
        </mi>
        <mrow id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">
         <mn id="S4.SS2.p3.1.m1.1.1.3.2" xref="S4.SS2.p3.1.m1.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS2.p3.1.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p3.1.m1.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS2.p3.1.m1.1.1.3.3" xref="S4.SS2.p3.1.m1.1.1.3.3.cmml">
          K
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b">
        <apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">
          𝑖
         </ci>
         <apply id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">
          <ci id="S4.SS2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS2.p3.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS2.p3.1.m1.1.1.3.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3.3">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">
        i_{1:K}
       </annotation>
      </semantics>
     </math>
     . If each goal’s reward is constant, the agent will tend to repeat learned skills instead of exploring new ones. We use the novelty measure RND
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#biba.bib6" title="">
       6
      </a>
      ]
     </cite>
     to generate and reduce the intrinsic rewards from LLMs, which effectively mitigates the issue of repetitive completion of simple tasks. To be more specific, after sampling a batch from the replay buffer, we extract the sentence embeddings of the goals from them:
     <math alttext="g_{1:B,1:L,1:K}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.4">
      <semantics id="S4.SS2.p3.2.m2.4a">
       <msub id="S4.SS2.p3.2.m2.4.5" xref="S4.SS2.p3.2.m2.4.5.cmml">
        <mi id="S4.SS2.p3.2.m2.4.5.2" xref="S4.SS2.p3.2.m2.4.5.2.cmml">
         g
        </mi>
        <mrow id="S4.SS2.p3.2.m2.4.4.4" xref="S4.SS2.p3.2.m2.4.4.4.cmml">
         <mn id="S4.SS2.p3.2.m2.4.4.4.6" xref="S4.SS2.p3.2.m2.4.4.4.6.cmml">
          1
         </mn>
         <mo id="S4.SS2.p3.2.m2.4.4.4.7" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p3.2.m2.4.4.4.7.cmml">
          :
         </mo>
         <mrow id="S4.SS2.p3.2.m2.4.4.4.8.2" xref="S4.SS2.p3.2.m2.4.4.4.8.1.cmml">
          <mi id="S4.SS2.p3.2.m2.1.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.1.cmml">
           B
          </mi>
          <mo id="S4.SS2.p3.2.m2.4.4.4.8.2.1" xref="S4.SS2.p3.2.m2.4.4.4.8.1.cmml">
           ,
          </mo>
          <mn id="S4.SS2.p3.2.m2.2.2.2.2" xref="S4.SS2.p3.2.m2.2.2.2.2.cmml">
           1
          </mn>
         </mrow>
         <mo id="S4.SS2.p3.2.m2.4.4.4.9" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p3.2.m2.4.4.4.9.cmml">
          :
         </mo>
         <mrow id="S4.SS2.p3.2.m2.4.4.4.10.2" xref="S4.SS2.p3.2.m2.4.4.4.10.1.cmml">
          <mi id="S4.SS2.p3.2.m2.3.3.3.3" xref="S4.SS2.p3.2.m2.3.3.3.3.cmml">
           L
          </mi>
          <mo id="S4.SS2.p3.2.m2.4.4.4.10.2.1" xref="S4.SS2.p3.2.m2.4.4.4.10.1.cmml">
           ,
          </mo>
          <mn id="S4.SS2.p3.2.m2.4.4.4.4" xref="S4.SS2.p3.2.m2.4.4.4.4.cmml">
           1
          </mn>
         </mrow>
         <mo id="S4.SS2.p3.2.m2.4.4.4.11" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p3.2.m2.4.4.4.11.cmml">
          :
         </mo>
         <mi id="S4.SS2.p3.2.m2.4.4.4.12" xref="S4.SS2.p3.2.m2.4.4.4.12.cmml">
          K
         </mi>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.4b">
        <apply id="S4.SS2.p3.2.m2.4.5.cmml" xref="S4.SS2.p3.2.m2.4.5">
         <csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.4.5.1.cmml" xref="S4.SS2.p3.2.m2.4.5">
          subscript
         </csymbol>
         <ci id="S4.SS2.p3.2.m2.4.5.2.cmml" xref="S4.SS2.p3.2.m2.4.5.2">
          𝑔
         </ci>
         <apply id="S4.SS2.p3.2.m2.4.4.4.cmml" xref="S4.SS2.p3.2.m2.4.4.4">
          <and id="S4.SS2.p3.2.m2.4.4.4a.cmml" xref="S4.SS2.p3.2.m2.4.4.4">
          </and>
          <apply id="S4.SS2.p3.2.m2.4.4.4b.cmml" xref="S4.SS2.p3.2.m2.4.4.4">
           <ci id="S4.SS2.p3.2.m2.4.4.4.7.cmml" xref="S4.SS2.p3.2.m2.4.4.4.7">
            :
           </ci>
           <cn id="S4.SS2.p3.2.m2.4.4.4.6.cmml" type="integer" xref="S4.SS2.p3.2.m2.4.4.4.6">
            1
           </cn>
           <list id="S4.SS2.p3.2.m2.4.4.4.8.1.cmml" xref="S4.SS2.p3.2.m2.4.4.4.8.2">
            <ci id="S4.SS2.p3.2.m2.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1.1">
             𝐵
            </ci>
            <cn id="S4.SS2.p3.2.m2.2.2.2.2.cmml" type="integer" xref="S4.SS2.p3.2.m2.2.2.2.2">
             1
            </cn>
           </list>
          </apply>
          <apply id="S4.SS2.p3.2.m2.4.4.4c.cmml" xref="S4.SS2.p3.2.m2.4.4.4">
           <ci id="S4.SS2.p3.2.m2.4.4.4.9.cmml" xref="S4.SS2.p3.2.m2.4.4.4.9">
            :
           </ci>
           <share href="#S4.SS2.p3.2.m2.4.4.4.8.cmml" id="S4.SS2.p3.2.m2.4.4.4d.cmml" xref="S4.SS2.p3.2.m2.4.4.4">
           </share>
           <list id="S4.SS2.p3.2.m2.4.4.4.10.1.cmml" xref="S4.SS2.p3.2.m2.4.4.4.10.2">
            <ci id="S4.SS2.p3.2.m2.3.3.3.3.cmml" xref="S4.SS2.p3.2.m2.3.3.3.3">
             𝐿
            </ci>
            <cn id="S4.SS2.p3.2.m2.4.4.4.4.cmml" type="integer" xref="S4.SS2.p3.2.m2.4.4.4.4">
             1
            </cn>
           </list>
          </apply>
          <apply id="S4.SS2.p3.2.m2.4.4.4e.cmml" xref="S4.SS2.p3.2.m2.4.4.4">
           <ci id="S4.SS2.p3.2.m2.4.4.4.11.cmml" xref="S4.SS2.p3.2.m2.4.4.4.11">
            :
           </ci>
           <share href="#S4.SS2.p3.2.m2.4.4.4.10.cmml" id="S4.SS2.p3.2.m2.4.4.4f.cmml" xref="S4.SS2.p3.2.m2.4.4.4">
           </share>
           <ci id="S4.SS2.p3.2.m2.4.4.4.12.cmml" xref="S4.SS2.p3.2.m2.4.4.4.12">
            𝐾
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.4c">
        g_{1:B,1:L,1:K}
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="B" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1">
      <semantics id="S4.SS2.p3.3.m3.1a">
       <mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">
        B
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b">
        <ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">
         𝐵
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">
        B
       </annotation>
      </semantics>
     </math>
     is the batch size, and
     <math alttext="L" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1">
      <semantics id="S4.SS2.p3.4.m4.1a">
       <mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">
        L
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b">
        <ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">
         𝐿
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">
        L
       </annotation>
      </semantics>
     </math>
     is the batch length. Given the target network
     <math alttext="f:G\rightarrow{\mathbb{R}}" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1">
      <semantics id="S4.SS2.p3.5.m5.1a">
       <mrow id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">
        <mi id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">
         f
        </mi>
        <mo id="S4.SS2.p3.5.m5.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p3.5.m5.1.1.1.cmml">
         :
        </mo>
        <mrow id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">
         <mi id="S4.SS2.p3.5.m5.1.1.3.2" xref="S4.SS2.p3.5.m5.1.1.3.2.cmml">
          G
         </mi>
         <mo id="S4.SS2.p3.5.m5.1.1.3.1" stretchy="false" xref="S4.SS2.p3.5.m5.1.1.3.1.cmml">
          →
         </mo>
         <mi id="S4.SS2.p3.5.m5.1.1.3.3" xref="S4.SS2.p3.5.m5.1.1.3.3.cmml">
          ℝ
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b">
        <apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">
         <ci id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1">
          :
         </ci>
         <ci id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2">
          𝑓
         </ci>
         <apply id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3">
          <ci id="S4.SS2.p3.5.m5.1.1.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.3.1">
           →
          </ci>
          <ci id="S4.SS2.p3.5.m5.1.1.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.3.2">
           𝐺
          </ci>
          <ci id="S4.SS2.p3.5.m5.1.1.3.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3">
           ℝ
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">
        f:G\rightarrow{\mathbb{R}}
       </annotation>
      </semantics>
     </math>
     and the predictor neural network
     <math alttext="\hat{f_{\theta}}:G\rightarrow{\mathbb{R}}" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.1">
      <semantics id="S4.SS2.p3.6.m6.1a">
       <mrow id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">
        <mover accent="true" id="S4.SS2.p3.6.m6.1.1.2" xref="S4.SS2.p3.6.m6.1.1.2.cmml">
         <msub id="S4.SS2.p3.6.m6.1.1.2.2" xref="S4.SS2.p3.6.m6.1.1.2.2.cmml">
          <mi id="S4.SS2.p3.6.m6.1.1.2.2.2" xref="S4.SS2.p3.6.m6.1.1.2.2.2.cmml">
           f
          </mi>
          <mi id="S4.SS2.p3.6.m6.1.1.2.2.3" xref="S4.SS2.p3.6.m6.1.1.2.2.3.cmml">
           θ
          </mi>
         </msub>
         <mo id="S4.SS2.p3.6.m6.1.1.2.1" xref="S4.SS2.p3.6.m6.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mo id="S4.SS2.p3.6.m6.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p3.6.m6.1.1.1.cmml">
         :
        </mo>
        <mrow id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml">
         <mi id="S4.SS2.p3.6.m6.1.1.3.2" xref="S4.SS2.p3.6.m6.1.1.3.2.cmml">
          G
         </mi>
         <mo id="S4.SS2.p3.6.m6.1.1.3.1" stretchy="false" xref="S4.SS2.p3.6.m6.1.1.3.1.cmml">
          →
         </mo>
         <mi id="S4.SS2.p3.6.m6.1.1.3.3" xref="S4.SS2.p3.6.m6.1.1.3.3.cmml">
          ℝ
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b">
        <apply id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">
         <ci id="S4.SS2.p3.6.m6.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1">
          :
         </ci>
         <apply id="S4.SS2.p3.6.m6.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2">
          <ci id="S4.SS2.p3.6.m6.1.1.2.1.cmml" xref="S4.SS2.p3.6.m6.1.1.2.1">
           ^
          </ci>
          <apply id="S4.SS2.p3.6.m6.1.1.2.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2.2">
           <csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.1.1.2.2.1.cmml" xref="S4.SS2.p3.6.m6.1.1.2.2">
            subscript
           </csymbol>
           <ci id="S4.SS2.p3.6.m6.1.1.2.2.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2.2.2">
            𝑓
           </ci>
           <ci id="S4.SS2.p3.6.m6.1.1.2.2.3.cmml" xref="S4.SS2.p3.6.m6.1.1.2.2.3">
            𝜃
           </ci>
          </apply>
         </apply>
         <apply id="S4.SS2.p3.6.m6.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3">
          <ci id="S4.SS2.p3.6.m6.1.1.3.1.cmml" xref="S4.SS2.p3.6.m6.1.1.3.1">
           →
          </ci>
          <ci id="S4.SS2.p3.6.m6.1.1.3.2.cmml" xref="S4.SS2.p3.6.m6.1.1.3.2">
           𝐺
          </ci>
          <ci id="S4.SS2.p3.6.m6.1.1.3.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3.3">
           ℝ
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">
        \hat{f_{\theta}}:G\rightarrow{\mathbb{R}}
       </annotation>
      </semantics>
     </math>
     , we calculate the prediction error:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E3">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E3X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle e_{1:B,1:L,1:K}=\|\hat{f}_{\theta}(g)-f(g)\|^{2}." class="ltx_Math" display="inline" id="S4.E3X.2.1.1.m1.7">
         <semantics id="S4.E3X.2.1.1.m1.7a">
          <mrow id="S4.E3X.2.1.1.m1.7.7.1" xref="S4.E3X.2.1.1.m1.7.7.1.1.cmml">
           <mrow id="S4.E3X.2.1.1.m1.7.7.1.1" xref="S4.E3X.2.1.1.m1.7.7.1.1.cmml">
            <msub id="S4.E3X.2.1.1.m1.7.7.1.1.3" xref="S4.E3X.2.1.1.m1.7.7.1.1.3.cmml">
             <mi id="S4.E3X.2.1.1.m1.7.7.1.1.3.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.3.2.cmml">
              e
             </mi>
             <mrow id="S4.E3X.2.1.1.m1.4.4.4" xref="S4.E3X.2.1.1.m1.4.4.4.cmml">
              <mn id="S4.E3X.2.1.1.m1.4.4.4.6" xref="S4.E3X.2.1.1.m1.4.4.4.6.cmml">
               1
              </mn>
              <mo id="S4.E3X.2.1.1.m1.4.4.4.7" lspace="0.278em" rspace="0.278em" xref="S4.E3X.2.1.1.m1.4.4.4.7.cmml">
               :
              </mo>
              <mrow id="S4.E3X.2.1.1.m1.4.4.4.8.2" xref="S4.E3X.2.1.1.m1.4.4.4.8.1.cmml">
               <mi id="S4.E3X.2.1.1.m1.1.1.1.1" xref="S4.E3X.2.1.1.m1.1.1.1.1.cmml">
                B
               </mi>
               <mo id="S4.E3X.2.1.1.m1.4.4.4.8.2.1" xref="S4.E3X.2.1.1.m1.4.4.4.8.1.cmml">
                ,
               </mo>
               <mn id="S4.E3X.2.1.1.m1.2.2.2.2" xref="S4.E3X.2.1.1.m1.2.2.2.2.cmml">
                1
               </mn>
              </mrow>
              <mo id="S4.E3X.2.1.1.m1.4.4.4.9" lspace="0.278em" rspace="0.278em" xref="S4.E3X.2.1.1.m1.4.4.4.9.cmml">
               :
              </mo>
              <mrow id="S4.E3X.2.1.1.m1.4.4.4.10.2" xref="S4.E3X.2.1.1.m1.4.4.4.10.1.cmml">
               <mi id="S4.E3X.2.1.1.m1.3.3.3.3" xref="S4.E3X.2.1.1.m1.3.3.3.3.cmml">
                L
               </mi>
               <mo id="S4.E3X.2.1.1.m1.4.4.4.10.2.1" xref="S4.E3X.2.1.1.m1.4.4.4.10.1.cmml">
                ,
               </mo>
               <mn id="S4.E3X.2.1.1.m1.4.4.4.4" xref="S4.E3X.2.1.1.m1.4.4.4.4.cmml">
                1
               </mn>
              </mrow>
              <mo id="S4.E3X.2.1.1.m1.4.4.4.11" lspace="0.278em" rspace="0.278em" xref="S4.E3X.2.1.1.m1.4.4.4.11.cmml">
               :
              </mo>
              <mi id="S4.E3X.2.1.1.m1.4.4.4.12" xref="S4.E3X.2.1.1.m1.4.4.4.12.cmml">
               K
              </mi>
             </mrow>
            </msub>
            <mo id="S4.E3X.2.1.1.m1.7.7.1.1.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.2.cmml">
             =
            </mo>
            <msup id="S4.E3X.2.1.1.m1.7.7.1.1.1" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.cmml">
             <mrow id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.2.cmml">
              <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.2" stretchy="false" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.2.1.cmml">
               ‖
              </mo>
              <mrow id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.cmml">
               <mrow id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">
                <msub id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.cmml">
                 <mover accent="true" id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.cmml">
                  <mi id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml">
                   f
                  </mi>
                  <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.1" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.1.cmml">
                   ^
                  </mo>
                 </mover>
                 <mi id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.3" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.3.cmml">
                  θ
                 </mi>
                </msub>
                <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.1" lspace="0em" rspace="0em" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.1.cmml">
                 ​
                </mo>
                <mrow id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.3.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">
                 <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">
                  (
                 </mo>
                 <mi id="S4.E3X.2.1.1.m1.5.5" xref="S4.E3X.2.1.1.m1.5.5.cmml">
                  g
                 </mi>
                 <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.1" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.1.cmml">
                −
               </mo>
               <mrow id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.cmml">
                <mi id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.2.cmml">
                 f
                </mi>
                <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.1" lspace="0em" rspace="0em" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.1.cmml">
                 ​
                </mo>
                <mrow id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.3.2" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.cmml">
                 <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.cmml">
                  (
                 </mo>
                 <mi id="S4.E3X.2.1.1.m1.6.6" xref="S4.E3X.2.1.1.m1.6.6.cmml">
                  g
                 </mi>
                 <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
              <mo id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.3" stretchy="false" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.2.1.cmml">
               ‖
              </mo>
             </mrow>
             <mn id="S4.E3X.2.1.1.m1.7.7.1.1.1.3" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.3.cmml">
              2
             </mn>
            </msup>
           </mrow>
           <mo id="S4.E3X.2.1.1.m1.7.7.1.2" lspace="0em" xref="S4.E3X.2.1.1.m1.7.7.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E3X.2.1.1.m1.7b">
           <apply id="S4.E3X.2.1.1.m1.7.7.1.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1">
            <eq id="S4.E3X.2.1.1.m1.7.7.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.2">
            </eq>
            <apply id="S4.E3X.2.1.1.m1.7.7.1.1.3.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.3">
             <csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.7.7.1.1.3.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E3X.2.1.1.m1.7.7.1.1.3.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.3.2">
              𝑒
             </ci>
             <apply id="S4.E3X.2.1.1.m1.4.4.4.cmml" xref="S4.E3X.2.1.1.m1.4.4.4">
              <and id="S4.E3X.2.1.1.m1.4.4.4a.cmml" xref="S4.E3X.2.1.1.m1.4.4.4">
              </and>
              <apply id="S4.E3X.2.1.1.m1.4.4.4b.cmml" xref="S4.E3X.2.1.1.m1.4.4.4">
               <ci id="S4.E3X.2.1.1.m1.4.4.4.7.cmml" xref="S4.E3X.2.1.1.m1.4.4.4.7">
                :
               </ci>
               <cn id="S4.E3X.2.1.1.m1.4.4.4.6.cmml" type="integer" xref="S4.E3X.2.1.1.m1.4.4.4.6">
                1
               </cn>
               <list id="S4.E3X.2.1.1.m1.4.4.4.8.1.cmml" xref="S4.E3X.2.1.1.m1.4.4.4.8.2">
                <ci id="S4.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.1.1.1.1">
                 𝐵
                </ci>
                <cn id="S4.E3X.2.1.1.m1.2.2.2.2.cmml" type="integer" xref="S4.E3X.2.1.1.m1.2.2.2.2">
                 1
                </cn>
               </list>
              </apply>
              <apply id="S4.E3X.2.1.1.m1.4.4.4c.cmml" xref="S4.E3X.2.1.1.m1.4.4.4">
               <ci id="S4.E3X.2.1.1.m1.4.4.4.9.cmml" xref="S4.E3X.2.1.1.m1.4.4.4.9">
                :
               </ci>
               <share href="#S4.E3X.2.1.1.m1.4.4.4.8.cmml" id="S4.E3X.2.1.1.m1.4.4.4d.cmml" xref="S4.E3X.2.1.1.m1.4.4.4">
               </share>
               <list id="S4.E3X.2.1.1.m1.4.4.4.10.1.cmml" xref="S4.E3X.2.1.1.m1.4.4.4.10.2">
                <ci id="S4.E3X.2.1.1.m1.3.3.3.3.cmml" xref="S4.E3X.2.1.1.m1.3.3.3.3">
                 𝐿
                </ci>
                <cn id="S4.E3X.2.1.1.m1.4.4.4.4.cmml" type="integer" xref="S4.E3X.2.1.1.m1.4.4.4.4">
                 1
                </cn>
               </list>
              </apply>
              <apply id="S4.E3X.2.1.1.m1.4.4.4e.cmml" xref="S4.E3X.2.1.1.m1.4.4.4">
               <ci id="S4.E3X.2.1.1.m1.4.4.4.11.cmml" xref="S4.E3X.2.1.1.m1.4.4.4.11">
                :
               </ci>
               <share href="#S4.E3X.2.1.1.m1.4.4.4.10.cmml" id="S4.E3X.2.1.1.m1.4.4.4f.cmml" xref="S4.E3X.2.1.1.m1.4.4.4">
               </share>
               <ci id="S4.E3X.2.1.1.m1.4.4.4.12.cmml" xref="S4.E3X.2.1.1.m1.4.4.4.12">
                𝐾
               </ci>
              </apply>
             </apply>
            </apply>
            <apply id="S4.E3X.2.1.1.m1.7.7.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1">
             <csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.7.7.1.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1">
              superscript
             </csymbol>
             <apply id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1">
              <csymbol cd="latexml" id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.2">
               norm
              </csymbol>
              <apply id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1">
               <minus id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.1">
               </minus>
               <apply id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2">
                <times id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.1">
                </times>
                <apply id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2">
                 <csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2">
                  subscript
                 </csymbol>
                 <apply id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2">
                  <ci id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.1">
                   ^
                  </ci>
                  <ci id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.2.2">
                   𝑓
                  </ci>
                 </apply>
                 <ci id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.2.2.3">
                  𝜃
                 </ci>
                </apply>
                <ci id="S4.E3X.2.1.1.m1.5.5.cmml" xref="S4.E3X.2.1.1.m1.5.5">
                 𝑔
                </ci>
               </apply>
               <apply id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3">
                <times id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.1">
                </times>
                <ci id="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.1.1.1.3.2">
                 𝑓
                </ci>
                <ci id="S4.E3X.2.1.1.m1.6.6.cmml" xref="S4.E3X.2.1.1.m1.6.6">
                 𝑔
                </ci>
               </apply>
              </apply>
             </apply>
             <cn id="S4.E3X.2.1.1.m1.7.7.1.1.1.3.cmml" type="integer" xref="S4.E3X.2.1.1.m1.7.7.1.1.1.3">
              2
             </cn>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E3X.2.1.1.m1.7c">
           \displaystyle e_{1:B,1:L,1:K}=\|\hat{f}_{\theta}(g)-f(g)\|^{2}.
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (3)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS2.p3.9">
     Subsequently, we update the predictor neural network and the running estimates of reward standard deviation, then standardize the intrinsic reward:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E4">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E4X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle i_{1:B,1:L,1:K}=(e_{1:B,1:L,1:K}-m)/{\sigma}," class="ltx_Math" display="inline" id="S4.E4X.2.1.1.m1.9">
         <semantics id="S4.E4X.2.1.1.m1.9a">
          <mrow id="S4.E4X.2.1.1.m1.9.9.1" xref="S4.E4X.2.1.1.m1.9.9.1.1.cmml">
           <mrow id="S4.E4X.2.1.1.m1.9.9.1.1" xref="S4.E4X.2.1.1.m1.9.9.1.1.cmml">
            <msub id="S4.E4X.2.1.1.m1.9.9.1.1.3" xref="S4.E4X.2.1.1.m1.9.9.1.1.3.cmml">
             <mi id="S4.E4X.2.1.1.m1.9.9.1.1.3.2" xref="S4.E4X.2.1.1.m1.9.9.1.1.3.2.cmml">
              i
             </mi>
             <mrow id="S4.E4X.2.1.1.m1.4.4.4" xref="S4.E4X.2.1.1.m1.4.4.4.cmml">
              <mn id="S4.E4X.2.1.1.m1.4.4.4.6" xref="S4.E4X.2.1.1.m1.4.4.4.6.cmml">
               1
              </mn>
              <mo id="S4.E4X.2.1.1.m1.4.4.4.7" lspace="0.278em" rspace="0.278em" xref="S4.E4X.2.1.1.m1.4.4.4.7.cmml">
               :
              </mo>
              <mrow id="S4.E4X.2.1.1.m1.4.4.4.8.2" xref="S4.E4X.2.1.1.m1.4.4.4.8.1.cmml">
               <mi id="S4.E4X.2.1.1.m1.1.1.1.1" xref="S4.E4X.2.1.1.m1.1.1.1.1.cmml">
                B
               </mi>
               <mo id="S4.E4X.2.1.1.m1.4.4.4.8.2.1" xref="S4.E4X.2.1.1.m1.4.4.4.8.1.cmml">
                ,
               </mo>
               <mn id="S4.E4X.2.1.1.m1.2.2.2.2" xref="S4.E4X.2.1.1.m1.2.2.2.2.cmml">
                1
               </mn>
              </mrow>
              <mo id="S4.E4X.2.1.1.m1.4.4.4.9" lspace="0.278em" rspace="0.278em" xref="S4.E4X.2.1.1.m1.4.4.4.9.cmml">
               :
              </mo>
              <mrow id="S4.E4X.2.1.1.m1.4.4.4.10.2" xref="S4.E4X.2.1.1.m1.4.4.4.10.1.cmml">
               <mi id="S4.E4X.2.1.1.m1.3.3.3.3" xref="S4.E4X.2.1.1.m1.3.3.3.3.cmml">
                L
               </mi>
               <mo id="S4.E4X.2.1.1.m1.4.4.4.10.2.1" xref="S4.E4X.2.1.1.m1.4.4.4.10.1.cmml">
                ,
               </mo>
               <mn id="S4.E4X.2.1.1.m1.4.4.4.4" xref="S4.E4X.2.1.1.m1.4.4.4.4.cmml">
                1
               </mn>
              </mrow>
              <mo id="S4.E4X.2.1.1.m1.4.4.4.11" lspace="0.278em" rspace="0.278em" xref="S4.E4X.2.1.1.m1.4.4.4.11.cmml">
               :
              </mo>
              <mi id="S4.E4X.2.1.1.m1.4.4.4.12" xref="S4.E4X.2.1.1.m1.4.4.4.12.cmml">
               K
              </mi>
             </mrow>
            </msub>
            <mo id="S4.E4X.2.1.1.m1.9.9.1.1.2" xref="S4.E4X.2.1.1.m1.9.9.1.1.2.cmml">
             =
            </mo>
            <mrow id="S4.E4X.2.1.1.m1.9.9.1.1.1" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.cmml">
             <mrow id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.cmml">
              <mo id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.2" stretchy="false" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.cmml">
               <msub id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2.cmml">
                <mi id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2.2" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2.2.cmml">
                 e
                </mi>
                <mrow id="S4.E4X.2.1.1.m1.8.8.4" xref="S4.E4X.2.1.1.m1.8.8.4.cmml">
                 <mn id="S4.E4X.2.1.1.m1.8.8.4.6" xref="S4.E4X.2.1.1.m1.8.8.4.6.cmml">
                  1
                 </mn>
                 <mo id="S4.E4X.2.1.1.m1.8.8.4.7" lspace="0.278em" rspace="0.278em" xref="S4.E4X.2.1.1.m1.8.8.4.7.cmml">
                  :
                 </mo>
                 <mrow id="S4.E4X.2.1.1.m1.8.8.4.8.2" xref="S4.E4X.2.1.1.m1.8.8.4.8.1.cmml">
                  <mi id="S4.E4X.2.1.1.m1.5.5.1.1" xref="S4.E4X.2.1.1.m1.5.5.1.1.cmml">
                   B
                  </mi>
                  <mo id="S4.E4X.2.1.1.m1.8.8.4.8.2.1" xref="S4.E4X.2.1.1.m1.8.8.4.8.1.cmml">
                   ,
                  </mo>
                  <mn id="S4.E4X.2.1.1.m1.6.6.2.2" xref="S4.E4X.2.1.1.m1.6.6.2.2.cmml">
                   1
                  </mn>
                 </mrow>
                 <mo id="S4.E4X.2.1.1.m1.8.8.4.9" lspace="0.278em" rspace="0.278em" xref="S4.E4X.2.1.1.m1.8.8.4.9.cmml">
                  :
                 </mo>
                 <mrow id="S4.E4X.2.1.1.m1.8.8.4.10.2" xref="S4.E4X.2.1.1.m1.8.8.4.10.1.cmml">
                  <mi id="S4.E4X.2.1.1.m1.7.7.3.3" xref="S4.E4X.2.1.1.m1.7.7.3.3.cmml">
                   L
                  </mi>
                  <mo id="S4.E4X.2.1.1.m1.8.8.4.10.2.1" xref="S4.E4X.2.1.1.m1.8.8.4.10.1.cmml">
                   ,
                  </mo>
                  <mn id="S4.E4X.2.1.1.m1.8.8.4.4" xref="S4.E4X.2.1.1.m1.8.8.4.4.cmml">
                   1
                  </mn>
                 </mrow>
                 <mo id="S4.E4X.2.1.1.m1.8.8.4.11" lspace="0.278em" rspace="0.278em" xref="S4.E4X.2.1.1.m1.8.8.4.11.cmml">
                  :
                 </mo>
                 <mi id="S4.E4X.2.1.1.m1.8.8.4.12" xref="S4.E4X.2.1.1.m1.8.8.4.12.cmml">
                  K
                 </mi>
                </mrow>
               </msub>
               <mo id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.1.cmml">
                −
               </mo>
               <mi id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.3" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.3.cmml">
                m
               </mi>
              </mrow>
              <mo id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.3" stretchy="false" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
             <mo id="S4.E4X.2.1.1.m1.9.9.1.1.1.2" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.2.cmml">
              /
             </mo>
             <mi id="S4.E4X.2.1.1.m1.9.9.1.1.1.3" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.3.cmml">
              σ
             </mi>
            </mrow>
           </mrow>
           <mo id="S4.E4X.2.1.1.m1.9.9.1.2" xref="S4.E4X.2.1.1.m1.9.9.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E4X.2.1.1.m1.9b">
           <apply id="S4.E4X.2.1.1.m1.9.9.1.1.cmml" xref="S4.E4X.2.1.1.m1.9.9.1">
            <eq id="S4.E4X.2.1.1.m1.9.9.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.2">
            </eq>
            <apply id="S4.E4X.2.1.1.m1.9.9.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.3">
             <csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.9.9.1.1.3.1.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E4X.2.1.1.m1.9.9.1.1.3.2.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.3.2">
              𝑖
             </ci>
             <apply id="S4.E4X.2.1.1.m1.4.4.4.cmml" xref="S4.E4X.2.1.1.m1.4.4.4">
              <and id="S4.E4X.2.1.1.m1.4.4.4a.cmml" xref="S4.E4X.2.1.1.m1.4.4.4">
              </and>
              <apply id="S4.E4X.2.1.1.m1.4.4.4b.cmml" xref="S4.E4X.2.1.1.m1.4.4.4">
               <ci id="S4.E4X.2.1.1.m1.4.4.4.7.cmml" xref="S4.E4X.2.1.1.m1.4.4.4.7">
                :
               </ci>
               <cn id="S4.E4X.2.1.1.m1.4.4.4.6.cmml" type="integer" xref="S4.E4X.2.1.1.m1.4.4.4.6">
                1
               </cn>
               <list id="S4.E4X.2.1.1.m1.4.4.4.8.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.4.8.2">
                <ci id="S4.E4X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.1">
                 𝐵
                </ci>
                <cn id="S4.E4X.2.1.1.m1.2.2.2.2.cmml" type="integer" xref="S4.E4X.2.1.1.m1.2.2.2.2">
                 1
                </cn>
               </list>
              </apply>
              <apply id="S4.E4X.2.1.1.m1.4.4.4c.cmml" xref="S4.E4X.2.1.1.m1.4.4.4">
               <ci id="S4.E4X.2.1.1.m1.4.4.4.9.cmml" xref="S4.E4X.2.1.1.m1.4.4.4.9">
                :
               </ci>
               <share href="#S4.E4X.2.1.1.m1.4.4.4.8.cmml" id="S4.E4X.2.1.1.m1.4.4.4d.cmml" xref="S4.E4X.2.1.1.m1.4.4.4">
               </share>
               <list id="S4.E4X.2.1.1.m1.4.4.4.10.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.4.10.2">
                <ci id="S4.E4X.2.1.1.m1.3.3.3.3.cmml" xref="S4.E4X.2.1.1.m1.3.3.3.3">
                 𝐿
                </ci>
                <cn id="S4.E4X.2.1.1.m1.4.4.4.4.cmml" type="integer" xref="S4.E4X.2.1.1.m1.4.4.4.4">
                 1
                </cn>
               </list>
              </apply>
              <apply id="S4.E4X.2.1.1.m1.4.4.4e.cmml" xref="S4.E4X.2.1.1.m1.4.4.4">
               <ci id="S4.E4X.2.1.1.m1.4.4.4.11.cmml" xref="S4.E4X.2.1.1.m1.4.4.4.11">
                :
               </ci>
               <share href="#S4.E4X.2.1.1.m1.4.4.4.10.cmml" id="S4.E4X.2.1.1.m1.4.4.4f.cmml" xref="S4.E4X.2.1.1.m1.4.4.4">
               </share>
               <ci id="S4.E4X.2.1.1.m1.4.4.4.12.cmml" xref="S4.E4X.2.1.1.m1.4.4.4.12">
                𝐾
               </ci>
              </apply>
             </apply>
            </apply>
            <apply id="S4.E4X.2.1.1.m1.9.9.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1">
             <divide id="S4.E4X.2.1.1.m1.9.9.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.2">
             </divide>
             <apply id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1">
              <minus id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.1">
              </minus>
              <apply id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2">
               <csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2">
                subscript
               </csymbol>
               <ci id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.2.2">
                𝑒
               </ci>
               <apply id="S4.E4X.2.1.1.m1.8.8.4.cmml" xref="S4.E4X.2.1.1.m1.8.8.4">
                <and id="S4.E4X.2.1.1.m1.8.8.4a.cmml" xref="S4.E4X.2.1.1.m1.8.8.4">
                </and>
                <apply id="S4.E4X.2.1.1.m1.8.8.4b.cmml" xref="S4.E4X.2.1.1.m1.8.8.4">
                 <ci id="S4.E4X.2.1.1.m1.8.8.4.7.cmml" xref="S4.E4X.2.1.1.m1.8.8.4.7">
                  :
                 </ci>
                 <cn id="S4.E4X.2.1.1.m1.8.8.4.6.cmml" type="integer" xref="S4.E4X.2.1.1.m1.8.8.4.6">
                  1
                 </cn>
                 <list id="S4.E4X.2.1.1.m1.8.8.4.8.1.cmml" xref="S4.E4X.2.1.1.m1.8.8.4.8.2">
                  <ci id="S4.E4X.2.1.1.m1.5.5.1.1.cmml" xref="S4.E4X.2.1.1.m1.5.5.1.1">
                   𝐵
                  </ci>
                  <cn id="S4.E4X.2.1.1.m1.6.6.2.2.cmml" type="integer" xref="S4.E4X.2.1.1.m1.6.6.2.2">
                   1
                  </cn>
                 </list>
                </apply>
                <apply id="S4.E4X.2.1.1.m1.8.8.4c.cmml" xref="S4.E4X.2.1.1.m1.8.8.4">
                 <ci id="S4.E4X.2.1.1.m1.8.8.4.9.cmml" xref="S4.E4X.2.1.1.m1.8.8.4.9">
                  :
                 </ci>
                 <share href="#S4.E4X.2.1.1.m1.8.8.4.8.cmml" id="S4.E4X.2.1.1.m1.8.8.4d.cmml" xref="S4.E4X.2.1.1.m1.8.8.4">
                 </share>
                 <list id="S4.E4X.2.1.1.m1.8.8.4.10.1.cmml" xref="S4.E4X.2.1.1.m1.8.8.4.10.2">
                  <ci id="S4.E4X.2.1.1.m1.7.7.3.3.cmml" xref="S4.E4X.2.1.1.m1.7.7.3.3">
                   𝐿
                  </ci>
                  <cn id="S4.E4X.2.1.1.m1.8.8.4.4.cmml" type="integer" xref="S4.E4X.2.1.1.m1.8.8.4.4">
                   1
                  </cn>
                 </list>
                </apply>
                <apply id="S4.E4X.2.1.1.m1.8.8.4e.cmml" xref="S4.E4X.2.1.1.m1.8.8.4">
                 <ci id="S4.E4X.2.1.1.m1.8.8.4.11.cmml" xref="S4.E4X.2.1.1.m1.8.8.4.11">
                  :
                 </ci>
                 <share href="#S4.E4X.2.1.1.m1.8.8.4.10.cmml" id="S4.E4X.2.1.1.m1.8.8.4f.cmml" xref="S4.E4X.2.1.1.m1.8.8.4">
                 </share>
                 <ci id="S4.E4X.2.1.1.m1.8.8.4.12.cmml" xref="S4.E4X.2.1.1.m1.8.8.4.12">
                  𝐾
                 </ci>
                </apply>
               </apply>
              </apply>
              <ci id="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.1.1.1.3">
               𝑚
              </ci>
             </apply>
             <ci id="S4.E4X.2.1.1.m1.9.9.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.9.9.1.1.1.3">
              𝜎
             </ci>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E4X.2.1.1.m1.9c">
           \displaystyle i_{1:B,1:L,1:K}=(e_{1:B,1:L,1:K}-m)/{\sigma},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (4)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS2.p3.8">
     where
     <math alttext="m" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m1.1">
      <semantics id="S4.SS2.p3.7.m1.1a">
       <mi id="S4.SS2.p3.7.m1.1.1" xref="S4.SS2.p3.7.m1.1.1.cmml">
        m
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m1.1b">
        <ci id="S4.SS2.p3.7.m1.1.1.cmml" xref="S4.SS2.p3.7.m1.1.1">
         𝑚
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.7.m1.1c">
        m
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m2.1">
      <semantics id="S4.SS2.p3.8.m2.1a">
       <mi id="S4.SS2.p3.8.m2.1.1" xref="S4.SS2.p3.8.m2.1.1.cmml">
        σ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m2.1b">
        <ci id="S4.SS2.p3.8.m2.1.1.cmml" xref="S4.SS2.p3.8.m2.1.1">
         𝜎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.8.m2.1c">
        \sigma
       </annotation>
      </semantics>
     </math>
     stand for the running estimates of the mean and standard deviation of the intrinsic returns.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.3
    </span>
    World Model and Actor Critic Learning
   </h3>
   <div class="ltx_para" id="S4.SS3.p1">
    <p class="ltx_p" id="S4.SS3.p1.7">
     We implement the world model with Recurrent State-Space Model (RSSM)
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib21" title="">
       21
      </a>
      ]
     </cite>
     , with an encoder that maps sensory inputs
     <math alttext="x_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1">
      <semantics id="S4.SS3.p1.1.m1.1a">
       <msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">
        <mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">
         x
        </mi>
        <mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b">
        <apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">
          𝑥
         </ci>
         <ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">
        x_{t}
       </annotation>
      </semantics>
     </math>
     (e.g., image frame or language) and
     <math alttext="u_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1">
      <semantics id="S4.SS3.p1.2.m2.1a">
       <msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">
        <mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">
         u
        </mi>
        <mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b">
        <apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">
          𝑢
         </ci>
         <ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">
        u_{t}
       </annotation>
      </semantics>
     </math>
     to stochastic representations
     <math alttext="z_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1">
      <semantics id="S4.SS3.p1.3.m3.1a">
       <msub id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">
        <mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">
         z
        </mi>
        <mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b">
        <apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">
          𝑧
         </ci>
         <ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">
        z_{t}
       </annotation>
      </semantics>
     </math>
     . Afterward,
     <math alttext="z_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1">
      <semantics id="S4.SS3.p1.4.m4.1a">
       <msub id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">
        <mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">
         z
        </mi>
        <mi id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b">
        <apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">
          𝑧
         </ci>
         <ci id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">
        z_{t}
       </annotation>
      </semantics>
     </math>
     is combined with past action
     <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1">
      <semantics id="S4.SS3.p1.5.m5.1a">
       <msub id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">
        <mi id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">
         a
        </mi>
        <mi id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b">
        <apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">
          𝑎
         </ci>
         <ci id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">
        a_{t}
       </annotation>
      </semantics>
     </math>
     and recurrent state
     <math alttext="h_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m6.1">
      <semantics id="S4.SS3.p1.6.m6.1a">
       <msub id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml">
        <mi id="S4.SS3.p1.6.m6.1.1.2" xref="S4.SS3.p1.6.m6.1.1.2.cmml">
         h
        </mi>
        <mi id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b">
        <apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">
          ℎ
         </ci>
         <ci id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">
        h_{t}
       </annotation>
      </semantics>
     </math>
     and fed into a sequence model, denoted as “seq”, to predict
     <math alttext="\hat{z}_{t+1}" class="ltx_Math" display="inline" id="S4.SS3.p1.7.m7.1">
      <semantics id="S4.SS3.p1.7.m7.1a">
       <msub id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml">
        <mover accent="true" id="S4.SS3.p1.7.m7.1.1.2" xref="S4.SS3.p1.7.m7.1.1.2.cmml">
         <mi id="S4.SS3.p1.7.m7.1.1.2.2" xref="S4.SS3.p1.7.m7.1.1.2.2.cmml">
          z
         </mi>
         <mo id="S4.SS3.p1.7.m7.1.1.2.1" xref="S4.SS3.p1.7.m7.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mrow id="S4.SS3.p1.7.m7.1.1.3" xref="S4.SS3.p1.7.m7.1.1.3.cmml">
         <mi id="S4.SS3.p1.7.m7.1.1.3.2" xref="S4.SS3.p1.7.m7.1.1.3.2.cmml">
          t
         </mi>
         <mo id="S4.SS3.p1.7.m7.1.1.3.1" xref="S4.SS3.p1.7.m7.1.1.3.1.cmml">
          +
         </mo>
         <mn id="S4.SS3.p1.7.m7.1.1.3.3" xref="S4.SS3.p1.7.m7.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b">
        <apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2">
          <ci id="S4.SS3.p1.7.m7.1.1.2.1.cmml" xref="S4.SS3.p1.7.m7.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS3.p1.7.m7.1.1.2.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2.2">
           𝑧
          </ci>
         </apply>
         <apply id="S4.SS3.p1.7.m7.1.1.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3">
          <plus id="S4.SS3.p1.7.m7.1.1.3.1.cmml" xref="S4.SS3.p1.7.m7.1.1.3.1">
          </plus>
          <ci id="S4.SS3.p1.7.m7.1.1.3.2.cmml" xref="S4.SS3.p1.7.m7.1.1.3.2">
           𝑡
          </ci>
          <cn id="S4.SS3.p1.7.m7.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.7.m7.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">
        \hat{z}_{t+1}
       </annotation>
      </semantics>
     </math>
     :
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E5">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E5X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\hat{z}_{t},h_{t}=\operatorname{seq}\left(z_{t-1},h_{t-1},a_{t-1}\right)," class="ltx_Math" display="inline" id="S4.E5X.2.1.1.m1.2">
         <semantics id="S4.E5X.2.1.1.m1.2a">
          <mrow id="S4.E5X.2.1.1.m1.2.2.1" xref="S4.E5X.2.1.1.m1.2.2.1.1.cmml">
           <mrow id="S4.E5X.2.1.1.m1.2.2.1.1" xref="S4.E5X.2.1.1.m1.2.2.1.1.cmml">
            <mrow id="S4.E5X.2.1.1.m1.2.2.1.1.2.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.3.cmml">
             <msub id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.cmml">
              <mover accent="true" id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">
               <mi id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.2.cmml">
                z
               </mi>
               <mo id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.1" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.1.cmml">
                ^
               </mo>
              </mover>
              <mi id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S4.E5X.2.1.1.m1.2.2.1.1.2.2.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.3.cmml">
              ,
             </mo>
             <msub id="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.cmml">
              <mi id="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml">
               h
              </mi>
              <mi id="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.3.cmml">
               t
              </mi>
             </msub>
            </mrow>
            <mo id="S4.E5X.2.1.1.m1.2.2.1.1.6" xref="S4.E5X.2.1.1.m1.2.2.1.1.6.cmml">
             =
            </mo>
            <mrow id="S4.E5X.2.1.1.m1.2.2.1.1.5.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.4.cmml">
             <mi id="S4.E5X.2.1.1.m1.1.1" xref="S4.E5X.2.1.1.m1.1.1.cmml">
              seq
             </mi>
             <mo id="S4.E5X.2.1.1.m1.2.2.1.1.5.3a" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.4.cmml">
              ⁡
             </mo>
             <mrow id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.4.cmml">
              <mo id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.4" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.4.cmml">
               (
              </mo>
              <msub id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.cmml">
               <mi id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.2.cmml">
                z
               </mi>
               <mrow id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.cmml">
                <mi id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.2.cmml">
                 t
                </mi>
                <mo id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.1" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.1.cmml">
                 −
                </mo>
                <mn id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.3.cmml">
                 1
                </mn>
               </mrow>
              </msub>
              <mo id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.5" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.4.cmml">
               ,
              </mo>
              <msub id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.cmml">
               <mi id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.2.cmml">
                h
               </mi>
               <mrow id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.cmml">
                <mi id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.2.cmml">
                 t
                </mi>
                <mo id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.1" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.1.cmml">
                 −
                </mo>
                <mn id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.3.cmml">
                 1
                </mn>
               </mrow>
              </msub>
              <mo id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.6" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.4.cmml">
               ,
              </mo>
              <msub id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.cmml">
               <mi id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.2.cmml">
                a
               </mi>
               <mrow id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.cmml">
                <mi id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.2.cmml">
                 t
                </mi>
                <mo id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.1" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.1.cmml">
                 −
                </mo>
                <mn id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.3" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.3.cmml">
                 1
                </mn>
               </mrow>
              </msub>
              <mo id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.7" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.4.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E5X.2.1.1.m1.2.2.1.2" xref="S4.E5X.2.1.1.m1.2.2.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E5X.2.1.1.m1.2b">
           <apply id="S4.E5X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1">
            <eq id="S4.E5X.2.1.1.m1.2.2.1.1.6.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.6">
            </eq>
            <list id="S4.E5X.2.1.1.m1.2.2.1.1.2.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.2">
             <apply id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1">
               subscript
              </csymbol>
              <apply id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2">
               <ci id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.1">
                ^
               </ci>
               <ci id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.2.2">
                𝑧
               </ci>
              </apply>
              <ci id="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2">
              <csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.2">
               ℎ
              </ci>
              <ci id="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.2.2.2.3">
               𝑡
              </ci>
             </apply>
            </list>
            <apply id="S4.E5X.2.1.1.m1.2.2.1.1.5.4.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3">
             <ci id="S4.E5X.2.1.1.m1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1">
              seq
             </ci>
             <apply id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1">
              <csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.2">
               𝑧
              </ci>
              <apply id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3">
               <minus id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.1">
               </minus>
               <ci id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.2">
                𝑡
               </ci>
               <cn id="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.3.cmml" type="integer" xref="S4.E5X.2.1.1.m1.2.2.1.1.3.1.1.1.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2">
              <csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.2">
               ℎ
              </ci>
              <apply id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3">
               <minus id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.1">
               </minus>
               <ci id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.2">
                𝑡
               </ci>
               <cn id="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.3.cmml" type="integer" xref="S4.E5X.2.1.1.m1.2.2.1.1.4.2.2.2.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3">
              <csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3">
               subscript
              </csymbol>
              <ci id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.2">
               𝑎
              </ci>
              <apply id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3">
               <minus id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.1">
               </minus>
               <ci id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.2">
                𝑡
               </ci>
               <cn id="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.3.cmml" type="integer" xref="S4.E5X.2.1.1.m1.2.2.1.1.5.3.3.3.3.3">
                1
               </cn>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E5X.2.1.1.m1.2c">
           \displaystyle\hat{z}_{t},h_{t}=\operatorname{seq}\left(z_{t-1},h_{t-1},a_{t-1}\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (5)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E6">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E6X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle z_{t}\sim\operatorname{encoder}\left(x_{t},u_{t},h_{t}\right)," class="ltx_Math" display="inline" id="S4.E6X.2.1.1.m1.2">
         <semantics id="S4.E6X.2.1.1.m1.2a">
          <mrow id="S4.E6X.2.1.1.m1.2.2.1" xref="S4.E6X.2.1.1.m1.2.2.1.1.cmml">
           <mrow id="S4.E6X.2.1.1.m1.2.2.1.1" xref="S4.E6X.2.1.1.m1.2.2.1.1.cmml">
            <msub id="S4.E6X.2.1.1.m1.2.2.1.1.5" xref="S4.E6X.2.1.1.m1.2.2.1.1.5.cmml">
             <mi id="S4.E6X.2.1.1.m1.2.2.1.1.5.2" xref="S4.E6X.2.1.1.m1.2.2.1.1.5.2.cmml">
              z
             </mi>
             <mi id="S4.E6X.2.1.1.m1.2.2.1.1.5.3" xref="S4.E6X.2.1.1.m1.2.2.1.1.5.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S4.E6X.2.1.1.m1.2.2.1.1.4" xref="S4.E6X.2.1.1.m1.2.2.1.1.4.cmml">
             ∼
            </mo>
            <mrow id="S4.E6X.2.1.1.m1.2.2.1.1.3.3" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.4.cmml">
             <mi id="S4.E6X.2.1.1.m1.1.1" xref="S4.E6X.2.1.1.m1.1.1.cmml">
              encoder
             </mi>
             <mo id="S4.E6X.2.1.1.m1.2.2.1.1.3.3a" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.4.cmml">
              ⁡
             </mo>
             <mrow id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.4.cmml">
              <mo id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.4" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.4.cmml">
               (
              </mo>
              <msub id="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml">
               <mi id="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">
                x
               </mi>
               <mi id="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.5" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.4.cmml">
               ,
              </mo>
              <msub id="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml">
               <mi id="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml">
                u
               </mi>
               <mi id="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.3" xref="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.6" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.4.cmml">
               ,
              </mo>
              <msub id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.cmml">
               <mi id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.2" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.2.cmml">
                h
               </mi>
               <mi id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.3" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.7" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.4.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E6X.2.1.1.m1.2.2.1.2" xref="S4.E6X.2.1.1.m1.2.2.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E6X.2.1.1.m1.2b">
           <apply id="S4.E6X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.1">
            <csymbol cd="latexml" id="S4.E6X.2.1.1.m1.2.2.1.1.4.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.4">
             similar-to
            </csymbol>
            <apply id="S4.E6X.2.1.1.m1.2.2.1.1.5.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.5">
             <csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.2.2.1.1.5.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.5">
              subscript
             </csymbol>
             <ci id="S4.E6X.2.1.1.m1.2.2.1.1.5.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.5.2">
              𝑧
             </ci>
             <ci id="S4.E6X.2.1.1.m1.2.2.1.1.5.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.5.3">
              𝑡
             </ci>
            </apply>
            <apply id="S4.E6X.2.1.1.m1.2.2.1.1.3.4.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.3">
             <ci id="S4.E6X.2.1.1.m1.1.1.cmml" xref="S4.E6X.2.1.1.m1.1.1">
              encoder
             </ci>
             <apply id="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.2">
               𝑥
              </ci>
              <ci id="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2">
              <csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.2">
               𝑢
              </ci>
              <ci id="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.2.2.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3">
              <csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3">
               subscript
              </csymbol>
              <ci id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.2">
               ℎ
              </ci>
              <ci id="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.1.1.3.3.3.3.3">
               𝑡
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E6X.2.1.1.m1.2c">
           \displaystyle z_{t}\sim\operatorname{encoder}\left(x_{t},u_{t},h_{t}\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (6)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E7">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E7X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\hat{x}_{t},\hat{u}_{t},\hat{r}_{t},\hat{c}_{t}=\operatorname{decoder}\left(z_{t},h_{t}\right)," class="ltx_Math" display="inline" id="S4.E7X.2.1.1.m1.2">
         <semantics id="S4.E7X.2.1.1.m1.2a">
          <mrow id="S4.E7X.2.1.1.m1.2.2.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.cmml">
           <mrow id="S4.E7X.2.1.1.m1.2.2.1.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.cmml">
            <mrow id="S4.E7X.2.1.1.m1.2.2.1.1.4.4" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.5.cmml">
             <msub id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.cmml">
              <mover accent="true" id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">
               <mi id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.2.cmml">
                x
               </mi>
               <mo id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.1.cmml">
                ^
               </mo>
              </mover>
              <mi id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.5" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.5.cmml">
              ,
             </mo>
             <msub id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.cmml">
              <mover accent="true" id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml">
               <mi id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml">
                u
               </mi>
               <mo id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.1.cmml">
                ^
               </mo>
              </mover>
              <mi id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.3" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.6" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.5.cmml">
              ,
             </mo>
             <msub id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.cmml">
              <mover accent="true" id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.cmml">
               <mi id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.2.cmml">
                r
               </mi>
               <mo id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.1.cmml">
                ^
               </mo>
              </mover>
              <mi id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.3" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.7" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.5.cmml">
              ,
             </mo>
             <msub id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.cmml">
              <mover accent="true" id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.cmml">
               <mi id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.2.cmml">
                c
               </mi>
               <mo id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.1.cmml">
                ^
               </mo>
              </mover>
              <mi id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.3" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.3.cmml">
               t
              </mi>
             </msub>
            </mrow>
            <mo id="S4.E7X.2.1.1.m1.2.2.1.1.7" xref="S4.E7X.2.1.1.m1.2.2.1.1.7.cmml">
             =
            </mo>
            <mrow id="S4.E7X.2.1.1.m1.2.2.1.1.6.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.3.cmml">
             <mi id="S4.E7X.2.1.1.m1.1.1" xref="S4.E7X.2.1.1.m1.1.1.cmml">
              decoder
             </mi>
             <mo id="S4.E7X.2.1.1.m1.2.2.1.1.6.2a" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.3.cmml">
              ⁡
             </mo>
             <mrow id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.3.cmml">
              <mo id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.3" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.3.cmml">
               (
              </mo>
              <msub id="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.cmml">
               <mi id="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.2.cmml">
                z
               </mi>
               <mi id="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.3" xref="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.4" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.3.cmml">
               ,
              </mo>
              <msub id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.cmml">
               <mi id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.2.cmml">
                h
               </mi>
               <mi id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.3" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.5" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E7X.2.1.1.m1.2.2.1.2" xref="S4.E7X.2.1.1.m1.2.2.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E7X.2.1.1.m1.2b">
           <apply id="S4.E7X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1">
            <eq id="S4.E7X.2.1.1.m1.2.2.1.1.7.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.7">
            </eq>
            <list id="S4.E7X.2.1.1.m1.2.2.1.1.4.5.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4">
             <apply id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1">
               subscript
              </csymbol>
              <apply id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2">
               <ci id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.1">
                ^
               </ci>
               <ci id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.2">
                𝑥
               </ci>
              </apply>
              <ci id="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2">
              <csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2">
               subscript
              </csymbol>
              <apply id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2">
               <ci id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.1">
                ^
               </ci>
               <ci id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.2.2">
                𝑢
               </ci>
              </apply>
              <ci id="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.2.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3">
              <csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3">
               subscript
              </csymbol>
              <apply id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2">
               <ci id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.1">
                ^
               </ci>
               <ci id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.2.2">
                𝑟
               </ci>
              </apply>
              <ci id="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.3.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.3.3.3.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4">
              <csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4">
               subscript
              </csymbol>
              <apply id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2">
               <ci id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.1">
                ^
               </ci>
               <ci id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.2.2">
                𝑐
               </ci>
              </apply>
              <ci id="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.3.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.4.4.4.3">
               𝑡
              </ci>
             </apply>
            </list>
            <apply id="S4.E7X.2.1.1.m1.2.2.1.1.6.3.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.2">
             <ci id="S4.E7X.2.1.1.m1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1">
              decoder
             </ci>
             <apply id="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1">
              <csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.2">
               𝑧
              </ci>
              <ci id="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.5.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2">
              <csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.2">
               ℎ
              </ci>
              <ci id="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1.6.2.2.2.3">
               𝑡
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E7X.2.1.1.m1.2c">
           \displaystyle\hat{x}_{t},\hat{u}_{t},\hat{r}_{t},\hat{c}_{t}=\operatorname{decoder}\left(z_{t},h_{t}\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (7)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS3.p1.12">
     where
     <math alttext="\hat{z_{t}}" class="ltx_Math" display="inline" id="S4.SS3.p1.8.m1.1">
      <semantics id="S4.SS3.p1.8.m1.1a">
       <mover accent="true" id="S4.SS3.p1.8.m1.1.1" xref="S4.SS3.p1.8.m1.1.1.cmml">
        <msub id="S4.SS3.p1.8.m1.1.1.2" xref="S4.SS3.p1.8.m1.1.1.2.cmml">
         <mi id="S4.SS3.p1.8.m1.1.1.2.2" xref="S4.SS3.p1.8.m1.1.1.2.2.cmml">
          z
         </mi>
         <mi id="S4.SS3.p1.8.m1.1.1.2.3" xref="S4.SS3.p1.8.m1.1.1.2.3.cmml">
          t
         </mi>
        </msub>
        <mo id="S4.SS3.p1.8.m1.1.1.1" xref="S4.SS3.p1.8.m1.1.1.1.cmml">
         ^
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m1.1b">
        <apply id="S4.SS3.p1.8.m1.1.1.cmml" xref="S4.SS3.p1.8.m1.1.1">
         <ci id="S4.SS3.p1.8.m1.1.1.1.cmml" xref="S4.SS3.p1.8.m1.1.1.1">
          ^
         </ci>
         <apply id="S4.SS3.p1.8.m1.1.1.2.cmml" xref="S4.SS3.p1.8.m1.1.1.2">
          <csymbol cd="ambiguous" id="S4.SS3.p1.8.m1.1.1.2.1.cmml" xref="S4.SS3.p1.8.m1.1.1.2">
           subscript
          </csymbol>
          <ci id="S4.SS3.p1.8.m1.1.1.2.2.cmml" xref="S4.SS3.p1.8.m1.1.1.2.2">
           𝑧
          </ci>
          <ci id="S4.SS3.p1.8.m1.1.1.2.3.cmml" xref="S4.SS3.p1.8.m1.1.1.2.3">
           𝑡
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.8.m1.1c">
        \hat{z_{t}}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\hat{x}_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.9.m2.1">
      <semantics id="S4.SS3.p1.9.m2.1a">
       <msub id="S4.SS3.p1.9.m2.1.1" xref="S4.SS3.p1.9.m2.1.1.cmml">
        <mover accent="true" id="S4.SS3.p1.9.m2.1.1.2" xref="S4.SS3.p1.9.m2.1.1.2.cmml">
         <mi id="S4.SS3.p1.9.m2.1.1.2.2" xref="S4.SS3.p1.9.m2.1.1.2.2.cmml">
          x
         </mi>
         <mo id="S4.SS3.p1.9.m2.1.1.2.1" xref="S4.SS3.p1.9.m2.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S4.SS3.p1.9.m2.1.1.3" xref="S4.SS3.p1.9.m2.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m2.1b">
        <apply id="S4.SS3.p1.9.m2.1.1.cmml" xref="S4.SS3.p1.9.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.9.m2.1.1.1.cmml" xref="S4.SS3.p1.9.m2.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS3.p1.9.m2.1.1.2.cmml" xref="S4.SS3.p1.9.m2.1.1.2">
          <ci id="S4.SS3.p1.9.m2.1.1.2.1.cmml" xref="S4.SS3.p1.9.m2.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS3.p1.9.m2.1.1.2.2.cmml" xref="S4.SS3.p1.9.m2.1.1.2.2">
           𝑥
          </ci>
         </apply>
         <ci id="S4.SS3.p1.9.m2.1.1.3.cmml" xref="S4.SS3.p1.9.m2.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.9.m2.1c">
        \hat{x}_{t}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\hat{u}_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.10.m3.1">
      <semantics id="S4.SS3.p1.10.m3.1a">
       <msub id="S4.SS3.p1.10.m3.1.1" xref="S4.SS3.p1.10.m3.1.1.cmml">
        <mover accent="true" id="S4.SS3.p1.10.m3.1.1.2" xref="S4.SS3.p1.10.m3.1.1.2.cmml">
         <mi id="S4.SS3.p1.10.m3.1.1.2.2" xref="S4.SS3.p1.10.m3.1.1.2.2.cmml">
          u
         </mi>
         <mo id="S4.SS3.p1.10.m3.1.1.2.1" xref="S4.SS3.p1.10.m3.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S4.SS3.p1.10.m3.1.1.3" xref="S4.SS3.p1.10.m3.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m3.1b">
        <apply id="S4.SS3.p1.10.m3.1.1.cmml" xref="S4.SS3.p1.10.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.10.m3.1.1.1.cmml" xref="S4.SS3.p1.10.m3.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS3.p1.10.m3.1.1.2.cmml" xref="S4.SS3.p1.10.m3.1.1.2">
          <ci id="S4.SS3.p1.10.m3.1.1.2.1.cmml" xref="S4.SS3.p1.10.m3.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS3.p1.10.m3.1.1.2.2.cmml" xref="S4.SS3.p1.10.m3.1.1.2.2">
           𝑢
          </ci>
         </apply>
         <ci id="S4.SS3.p1.10.m3.1.1.3.cmml" xref="S4.SS3.p1.10.m3.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.10.m3.1c">
        \hat{u}_{t}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\hat{r}_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.11.m4.1">
      <semantics id="S4.SS3.p1.11.m4.1a">
       <msub id="S4.SS3.p1.11.m4.1.1" xref="S4.SS3.p1.11.m4.1.1.cmml">
        <mover accent="true" id="S4.SS3.p1.11.m4.1.1.2" xref="S4.SS3.p1.11.m4.1.1.2.cmml">
         <mi id="S4.SS3.p1.11.m4.1.1.2.2" xref="S4.SS3.p1.11.m4.1.1.2.2.cmml">
          r
         </mi>
         <mo id="S4.SS3.p1.11.m4.1.1.2.1" xref="S4.SS3.p1.11.m4.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S4.SS3.p1.11.m4.1.1.3" xref="S4.SS3.p1.11.m4.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m4.1b">
        <apply id="S4.SS3.p1.11.m4.1.1.cmml" xref="S4.SS3.p1.11.m4.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.11.m4.1.1.1.cmml" xref="S4.SS3.p1.11.m4.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS3.p1.11.m4.1.1.2.cmml" xref="S4.SS3.p1.11.m4.1.1.2">
          <ci id="S4.SS3.p1.11.m4.1.1.2.1.cmml" xref="S4.SS3.p1.11.m4.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS3.p1.11.m4.1.1.2.2.cmml" xref="S4.SS3.p1.11.m4.1.1.2.2">
           𝑟
          </ci>
         </apply>
         <ci id="S4.SS3.p1.11.m4.1.1.3.cmml" xref="S4.SS3.p1.11.m4.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.11.m4.1c">
        \hat{r}_{t}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\hat{c}_{t}" class="ltx_Math" display="inline" id="S4.SS3.p1.12.m5.1">
      <semantics id="S4.SS3.p1.12.m5.1a">
       <msub id="S4.SS3.p1.12.m5.1.1" xref="S4.SS3.p1.12.m5.1.1.cmml">
        <mover accent="true" id="S4.SS3.p1.12.m5.1.1.2" xref="S4.SS3.p1.12.m5.1.1.2.cmml">
         <mi id="S4.SS3.p1.12.m5.1.1.2.2" xref="S4.SS3.p1.12.m5.1.1.2.2.cmml">
          c
         </mi>
         <mo id="S4.SS3.p1.12.m5.1.1.2.1" xref="S4.SS3.p1.12.m5.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S4.SS3.p1.12.m5.1.1.3" xref="S4.SS3.p1.12.m5.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m5.1b">
        <apply id="S4.SS3.p1.12.m5.1.1.cmml" xref="S4.SS3.p1.12.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.12.m5.1.1.1.cmml" xref="S4.SS3.p1.12.m5.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS3.p1.12.m5.1.1.2.cmml" xref="S4.SS3.p1.12.m5.1.1.2">
          <ci id="S4.SS3.p1.12.m5.1.1.2.1.cmml" xref="S4.SS3.p1.12.m5.1.1.2.1">
           ^
          </ci>
          <ci id="S4.SS3.p1.12.m5.1.1.2.2.cmml" xref="S4.SS3.p1.12.m5.1.1.2.2">
           𝑐
          </ci>
         </apply>
         <ci id="S4.SS3.p1.12.m5.1.1.3.cmml" xref="S4.SS3.p1.12.m5.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.12.m5.1c">
        \hat{c}_{t}
       </annotation>
      </semantics>
     </math>
     denotes the world model prediction for the stochastic representation, sensory representation, transition, reward, and the episode continuation flag. The encoder and decoder employ convolutional neural networks (CNN) for image inputs and multi-layer perceptrons (MLP) for other low-dimensional inputs. After obtaining multi-modal representations from the decoder and sequence model, we employ the following objective to train the entire world model in an end-to-end manner:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E8">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{\rm total}={\mathcal{L}_{x}}+\mathcal{L}_{u}+\mathcal{L}_{r}+\mathcal{L}_{c}+{\beta_{1}}\mathcal{L}_{\rm pred}+{\beta_{2}}\mathcal{L}_{\rm reg}," class="ltx_Math" display="inline" id="S4.E8X.2.1.1.m1.1">
         <semantics id="S4.E8X.2.1.1.m1.1a">
          <mrow id="S4.E8X.2.1.1.m1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.cmml">
           <mrow id="S4.E8X.2.1.1.m1.1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.cmml">
            <msub id="S4.E8X.2.1.1.m1.1.1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.2.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E8X.2.1.1.m1.1.1.1.1.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.2.2.cmml">
              ℒ
             </mi>
             <mi id="S4.E8X.2.1.1.m1.1.1.1.1.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.2.3.cmml">
              total
             </mi>
            </msub>
            <mo id="S4.E8X.2.1.1.m1.1.1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.cmml">
             =
            </mo>
            <mrow id="S4.E8X.2.1.1.m1.1.1.1.1.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.cmml">
             <msub id="S4.E8X.2.1.1.m1.1.1.1.1.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.2.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E8X.2.1.1.m1.1.1.1.1.3.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.2.2.cmml">
               ℒ
              </mi>
              <mi id="S4.E8X.2.1.1.m1.1.1.1.1.3.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.2.3.cmml">
               x
              </mi>
             </msub>
             <mo id="S4.E8X.2.1.1.m1.1.1.1.1.3.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.1.cmml">
              +
             </mo>
             <msub id="S4.E8X.2.1.1.m1.1.1.1.1.3.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.3.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E8X.2.1.1.m1.1.1.1.1.3.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.3.2.cmml">
               ℒ
              </mi>
              <mi id="S4.E8X.2.1.1.m1.1.1.1.1.3.3.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.3.3.cmml">
               u
              </mi>
             </msub>
             <mo id="S4.E8X.2.1.1.m1.1.1.1.1.3.1a" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.1.cmml">
              +
             </mo>
             <msub id="S4.E8X.2.1.1.m1.1.1.1.1.3.4" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.4.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E8X.2.1.1.m1.1.1.1.1.3.4.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.4.2.cmml">
               ℒ
              </mi>
              <mi id="S4.E8X.2.1.1.m1.1.1.1.1.3.4.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.4.3.cmml">
               r
              </mi>
             </msub>
             <mo id="S4.E8X.2.1.1.m1.1.1.1.1.3.1b" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.1.cmml">
              +
             </mo>
             <msub id="S4.E8X.2.1.1.m1.1.1.1.1.3.5" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.5.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E8X.2.1.1.m1.1.1.1.1.3.5.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.5.2.cmml">
               ℒ
              </mi>
              <mi id="S4.E8X.2.1.1.m1.1.1.1.1.3.5.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.5.3.cmml">
               c
              </mi>
             </msub>
             <mo id="S4.E8X.2.1.1.m1.1.1.1.1.3.1c" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.1.cmml">
              +
             </mo>
             <mrow id="S4.E8X.2.1.1.m1.1.1.1.1.3.6" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.cmml">
              <msub id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.cmml">
               <mi id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.2.cmml">
                β
               </mi>
               <mn id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.3.cmml">
                1
               </mn>
              </msub>
              <mo id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.1" lspace="0em" rspace="0em" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.1.cmml">
               ​
              </mo>
              <msub id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.2.cmml">
                ℒ
               </mi>
               <mi id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.3.cmml">
                pred
               </mi>
              </msub>
             </mrow>
             <mo id="S4.E8X.2.1.1.m1.1.1.1.1.3.1d" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.1.cmml">
              +
             </mo>
             <mrow id="S4.E8X.2.1.1.m1.1.1.1.1.3.7" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.cmml">
              <msub id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.cmml">
               <mi id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.2.cmml">
                β
               </mi>
               <mn id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.3.cmml">
                2
               </mn>
              </msub>
              <mo id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.1" lspace="0em" rspace="0em" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.1.cmml">
               ​
              </mo>
              <msub id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.2.cmml">
                ℒ
               </mi>
               <mi id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.3.cmml">
                reg
               </mi>
              </msub>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E8X.2.1.1.m1.1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E8X.2.1.1.m1.1b">
           <apply id="S4.E8X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1">
            <eq id="S4.E8X.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1">
            </eq>
            <apply id="S4.E8X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.2">
             <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.2">
              subscript
             </csymbol>
             <ci id="S4.E8X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.2.2">
              ℒ
             </ci>
             <ci id="S4.E8X.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.2.3">
              total
             </ci>
            </apply>
            <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3">
             <plus id="S4.E8X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.1">
             </plus>
             <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.2">
              <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.2">
               subscript
              </csymbol>
              <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.2.2">
               ℒ
              </ci>
              <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.2.3">
               𝑥
              </ci>
             </apply>
             <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.3">
              <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.3">
               subscript
              </csymbol>
              <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.3.2">
               ℒ
              </ci>
              <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.3.3">
               𝑢
              </ci>
             </apply>
             <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.4.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.4">
              <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.3.4.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.4">
               subscript
              </csymbol>
              <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.4.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.4.2">
               ℒ
              </ci>
              <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.4.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.4.3">
               𝑟
              </ci>
             </apply>
             <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.5.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.5">
              <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.3.5.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.5">
               subscript
              </csymbol>
              <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.5.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.5.2">
               ℒ
              </ci>
              <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.5.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.5.3">
               𝑐
              </ci>
             </apply>
             <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6">
              <times id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.1">
              </times>
              <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2">
               <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2">
                subscript
               </csymbol>
               <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.2">
                𝛽
               </ci>
               <cn id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.3.cmml" type="integer" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.2.3">
                1
               </cn>
              </apply>
              <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3">
               <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3">
                subscript
               </csymbol>
               <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.2">
                ℒ
               </ci>
               <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.6.3.3">
                pred
               </ci>
              </apply>
             </apply>
             <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7">
              <times id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.1">
              </times>
              <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2">
               <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2">
                subscript
               </csymbol>
               <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.2">
                𝛽
               </ci>
               <cn id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.3.cmml" type="integer" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.2.3">
                2
               </cn>
              </apply>
              <apply id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3">
               <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3">
                subscript
               </csymbol>
               <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.2">
                ℒ
               </ci>
               <ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.7.3.3">
                reg
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E8X.2.1.1.m1.1c">
           \displaystyle\mathcal{L}_{\rm total}={\mathcal{L}_{x}}+\mathcal{L}_{u}+\mathcal{L}_{r}+\mathcal{L}_{c}+{\beta_{1}}\mathcal{L}_{\rm pred}+{\beta_{2}}\mathcal{L}_{\rm reg},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (8)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS3.p1.14">
     in which
     <math alttext="\beta_{1}=0.5" class="ltx_Math" display="inline" id="S4.SS3.p1.13.m1.1">
      <semantics id="S4.SS3.p1.13.m1.1a">
       <mrow id="S4.SS3.p1.13.m1.1.1" xref="S4.SS3.p1.13.m1.1.1.cmml">
        <msub id="S4.SS3.p1.13.m1.1.1.2" xref="S4.SS3.p1.13.m1.1.1.2.cmml">
         <mi id="S4.SS3.p1.13.m1.1.1.2.2" xref="S4.SS3.p1.13.m1.1.1.2.2.cmml">
          β
         </mi>
         <mn id="S4.SS3.p1.13.m1.1.1.2.3" xref="S4.SS3.p1.13.m1.1.1.2.3.cmml">
          1
         </mn>
        </msub>
        <mo id="S4.SS3.p1.13.m1.1.1.1" xref="S4.SS3.p1.13.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS3.p1.13.m1.1.1.3" xref="S4.SS3.p1.13.m1.1.1.3.cmml">
         0.5
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.13.m1.1b">
        <apply id="S4.SS3.p1.13.m1.1.1.cmml" xref="S4.SS3.p1.13.m1.1.1">
         <eq id="S4.SS3.p1.13.m1.1.1.1.cmml" xref="S4.SS3.p1.13.m1.1.1.1">
         </eq>
         <apply id="S4.SS3.p1.13.m1.1.1.2.cmml" xref="S4.SS3.p1.13.m1.1.1.2">
          <csymbol cd="ambiguous" id="S4.SS3.p1.13.m1.1.1.2.1.cmml" xref="S4.SS3.p1.13.m1.1.1.2">
           subscript
          </csymbol>
          <ci id="S4.SS3.p1.13.m1.1.1.2.2.cmml" xref="S4.SS3.p1.13.m1.1.1.2.2">
           𝛽
          </ci>
          <cn id="S4.SS3.p1.13.m1.1.1.2.3.cmml" type="integer" xref="S4.SS3.p1.13.m1.1.1.2.3">
           1
          </cn>
         </apply>
         <cn id="S4.SS3.p1.13.m1.1.1.3.cmml" type="float" xref="S4.SS3.p1.13.m1.1.1.3">
          0.5
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.13.m1.1c">
        \beta_{1}=0.5
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\beta_{2}=0.1" class="ltx_Math" display="inline" id="S4.SS3.p1.14.m2.1">
      <semantics id="S4.SS3.p1.14.m2.1a">
       <mrow id="S4.SS3.p1.14.m2.1.1" xref="S4.SS3.p1.14.m2.1.1.cmml">
        <msub id="S4.SS3.p1.14.m2.1.1.2" xref="S4.SS3.p1.14.m2.1.1.2.cmml">
         <mi id="S4.SS3.p1.14.m2.1.1.2.2" xref="S4.SS3.p1.14.m2.1.1.2.2.cmml">
          β
         </mi>
         <mn id="S4.SS3.p1.14.m2.1.1.2.3" xref="S4.SS3.p1.14.m2.1.1.2.3.cmml">
          2
         </mn>
        </msub>
        <mo id="S4.SS3.p1.14.m2.1.1.1" xref="S4.SS3.p1.14.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS3.p1.14.m2.1.1.3" xref="S4.SS3.p1.14.m2.1.1.3.cmml">
         0.1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.14.m2.1b">
        <apply id="S4.SS3.p1.14.m2.1.1.cmml" xref="S4.SS3.p1.14.m2.1.1">
         <eq id="S4.SS3.p1.14.m2.1.1.1.cmml" xref="S4.SS3.p1.14.m2.1.1.1">
         </eq>
         <apply id="S4.SS3.p1.14.m2.1.1.2.cmml" xref="S4.SS3.p1.14.m2.1.1.2">
          <csymbol cd="ambiguous" id="S4.SS3.p1.14.m2.1.1.2.1.cmml" xref="S4.SS3.p1.14.m2.1.1.2">
           subscript
          </csymbol>
          <ci id="S4.SS3.p1.14.m2.1.1.2.2.cmml" xref="S4.SS3.p1.14.m2.1.1.2.2">
           𝛽
          </ci>
          <cn id="S4.SS3.p1.14.m2.1.1.2.3.cmml" type="integer" xref="S4.SS3.p1.14.m2.1.1.2.3">
           2
          </cn>
         </apply>
         <cn id="S4.SS3.p1.14.m2.1.1.3.cmml" type="float" xref="S4.SS3.p1.14.m2.1.1.3">
          0.1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.14.m2.1c">
        \beta_{2}=0.1
       </annotation>
      </semantics>
     </math>
     , and all sub loss term are written as:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E9">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E9X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.E9X.2.1.1.1">
         Sensation Loss:
        </span>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{x}=\left\|\hat{x}_{t}-x_{t}\right\|_{2}^{2}," class="ltx_Math" display="inline" id="S4.E9X.4.1.1.m1.1">
         <semantics id="S4.E9X.4.1.1.m1.1a">
          <mrow id="S4.E9X.4.1.1.m1.1.1.1" xref="S4.E9X.4.1.1.m1.1.1.1.1.cmml">
           <mrow id="S4.E9X.4.1.1.m1.1.1.1.1" xref="S4.E9X.4.1.1.m1.1.1.1.1.cmml">
            <msub id="S4.E9X.4.1.1.m1.1.1.1.1.3" xref="S4.E9X.4.1.1.m1.1.1.1.1.3.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E9X.4.1.1.m1.1.1.1.1.3.2" xref="S4.E9X.4.1.1.m1.1.1.1.1.3.2.cmml">
              ℒ
             </mi>
             <mi id="S4.E9X.4.1.1.m1.1.1.1.1.3.3" xref="S4.E9X.4.1.1.m1.1.1.1.1.3.3.cmml">
              x
             </mi>
            </msub>
            <mo id="S4.E9X.4.1.1.m1.1.1.1.1.2" xref="S4.E9X.4.1.1.m1.1.1.1.1.2.cmml">
             =
            </mo>
            <msubsup id="S4.E9X.4.1.1.m1.1.1.1.1.1" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.cmml">
             <mrow id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.cmml">
              <mo id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">
               ‖
              </mo>
              <mrow id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
               <msub id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">
                <mover accent="true" id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                 <mi id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">
                  x
                 </mi>
                 <mo id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">
                  ^
                 </mo>
                </mover>
                <mi id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">
                −
               </mo>
               <msub id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">
                <mi id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                 x
                </mi>
                <mi id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                 t
                </mi>
               </msub>
              </mrow>
              <mo id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">
               ‖
              </mo>
             </mrow>
             <mn id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.3" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.3.cmml">
              2
             </mn>
             <mn id="S4.E9X.4.1.1.m1.1.1.1.1.1.3" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.3.cmml">
              2
             </mn>
            </msubsup>
           </mrow>
           <mo id="S4.E9X.4.1.1.m1.1.1.1.2" xref="S4.E9X.4.1.1.m1.1.1.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E9X.4.1.1.m1.1b">
           <apply id="S4.E9X.4.1.1.m1.1.1.1.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1">
            <eq id="S4.E9X.4.1.1.m1.1.1.1.1.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.2">
            </eq>
            <apply id="S4.E9X.4.1.1.m1.1.1.1.1.3.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S4.E9X.4.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E9X.4.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.3.2">
              ℒ
             </ci>
             <ci id="S4.E9X.4.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.3.3">
              𝑥
             </ci>
            </apply>
            <apply id="S4.E9X.4.1.1.m1.1.1.1.1.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S4.E9X.4.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1">
              superscript
             </csymbol>
             <apply id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1">
               subscript
              </csymbol>
              <apply id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.2">
                norm
               </csymbol>
               <apply id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1">
                <minus id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.1">
                </minus>
                <apply id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2">
                 <csymbol cd="ambiguous" id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2">
                  subscript
                 </csymbol>
                 <apply id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2">
                  <ci id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1">
                   ^
                  </ci>
                  <ci id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2">
                   𝑥
                  </ci>
                 </apply>
                 <ci id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">
                  𝑡
                 </ci>
                </apply>
                <apply id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.2">
                  𝑥
                 </ci>
                 <ci id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">
                  𝑡
                 </ci>
                </apply>
               </apply>
              </apply>
              <cn id="S4.E9X.4.1.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.1.3">
               2
              </cn>
             </apply>
             <cn id="S4.E9X.4.1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E9X.4.1.1.m1.1.1.1.1.1.3">
              2
             </cn>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E9X.4.1.1.m1.1c">
           \displaystyle\mathcal{L}_{x}=\left\|\hat{x}_{t}-x_{t}\right\|_{2}^{2},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="6">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (9)
        </span>
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E9Xa">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.E9Xa.2.1.1.1">
         Transition Loss:
        </span>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{u}=\operatorname{catxent}\left(\hat{u}_{t},{u}_{t}\right)," class="ltx_Math" display="inline" id="S4.E9Xa.4.1.1.m1.2">
         <semantics id="S4.E9Xa.4.1.1.m1.2a">
          <mrow id="S4.E9Xa.4.1.1.m1.2.2.1" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.cmml">
           <mrow id="S4.E9Xa.4.1.1.m1.2.2.1.1" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.cmml">
            <msub id="S4.E9Xa.4.1.1.m1.2.2.1.1.4" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.4.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E9Xa.4.1.1.m1.2.2.1.1.4.2" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.4.2.cmml">
              ℒ
             </mi>
             <mi id="S4.E9Xa.4.1.1.m1.2.2.1.1.4.3" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.4.3.cmml">
              u
             </mi>
            </msub>
            <mo id="S4.E9Xa.4.1.1.m1.2.2.1.1.3" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.3.cmml">
             =
            </mo>
            <mrow id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.3.cmml">
             <mi id="S4.E9Xa.4.1.1.m1.1.1" xref="S4.E9Xa.4.1.1.m1.1.1.cmml">
              catxent
             </mi>
             <mo id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2a" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.3.cmml">
              ⁡
             </mo>
             <mrow id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.3.cmml">
              <mo id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.3" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.3.cmml">
               (
              </mo>
              <msub id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.cmml">
               <mover accent="true" id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">
                <mi id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.2" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.2.cmml">
                 u
                </mi>
                <mo id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.1" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml">
                 ^
                </mo>
               </mover>
               <mi id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.4" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.3.cmml">
               ,
              </mo>
              <msub id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.cmml">
               <mi id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.2.cmml">
                u
               </mi>
               <mi id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.3" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.5" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E9Xa.4.1.1.m1.2.2.1.2" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E9Xa.4.1.1.m1.2b">
           <apply id="S4.E9Xa.4.1.1.m1.2.2.1.1.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1">
            <eq id="S4.E9Xa.4.1.1.m1.2.2.1.1.3.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.3">
            </eq>
            <apply id="S4.E9Xa.4.1.1.m1.2.2.1.1.4.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.4">
             <csymbol cd="ambiguous" id="S4.E9Xa.4.1.1.m1.2.2.1.1.4.1.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.4">
              subscript
             </csymbol>
             <ci id="S4.E9Xa.4.1.1.m1.2.2.1.1.4.2.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.4.2">
              ℒ
             </ci>
             <ci id="S4.E9Xa.4.1.1.m1.2.2.1.1.4.3.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.4.3">
              𝑢
             </ci>
            </apply>
            <apply id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.3.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2">
             <ci id="S4.E9Xa.4.1.1.m1.1.1.cmml" xref="S4.E9Xa.4.1.1.m1.1.1">
              catxent
             </ci>
             <apply id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1">
               subscript
              </csymbol>
              <apply id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2">
               <ci id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.1">
                ^
               </ci>
               <ci id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.2.2">
                𝑢
               </ci>
              </apply>
              <ci id="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2">
              <csymbol cd="ambiguous" id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.2">
               𝑢
              </ci>
              <ci id="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E9Xa.4.1.1.m1.2.2.1.1.2.2.2.2.3">
               𝑡
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E9Xa.4.1.1.m1.2c">
           \displaystyle\mathcal{L}_{u}=\operatorname{catxent}\left(\hat{u}_{t},{u}_{t}\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E9Xb">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.E9Xb.2.1.1.1">
         Reward Loss:
        </span>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{r}=\operatorname{catxent}\left(\hat{r}_{t},\operatorname{twohot}\left(r_{t}\right)\right)," class="ltx_Math" display="inline" id="S4.E9Xb.4.1.1.m1.3">
         <semantics id="S4.E9Xb.4.1.1.m1.3a">
          <mrow id="S4.E9Xb.4.1.1.m1.3.3.1" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.cmml">
           <mrow id="S4.E9Xb.4.1.1.m1.3.3.1.1" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.cmml">
            <msub id="S4.E9Xb.4.1.1.m1.3.3.1.1.4" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.4.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E9Xb.4.1.1.m1.3.3.1.1.4.2" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.4.2.cmml">
              ℒ
             </mi>
             <mi id="S4.E9Xb.4.1.1.m1.3.3.1.1.4.3" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.4.3.cmml">
              r
             </mi>
            </msub>
            <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.3" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.3.cmml">
             =
            </mo>
            <mrow id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.3.cmml">
             <mi id="S4.E9Xb.4.1.1.m1.2.2" xref="S4.E9Xb.4.1.1.m1.2.2.cmml">
              catxent
             </mi>
             <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2a" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.3.cmml">
              ⁡
             </mo>
             <mrow id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.3.cmml">
              <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.3" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.3.cmml">
               (
              </mo>
              <msub id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.cmml">
               <mover accent="true" id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">
                <mi id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml">
                 r
                </mi>
                <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.1" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml">
                 ^
                </mo>
               </mover>
               <mi id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.4" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.3.cmml">
               ,
              </mo>
              <mrow id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.2.cmml">
               <mi id="S4.E9Xb.4.1.1.m1.1.1" xref="S4.E9Xb.4.1.1.m1.1.1.cmml">
                twohot
               </mi>
               <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1a" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.2.cmml">
                ⁡
               </mo>
               <mrow id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.2.cmml">
                <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.2" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.2.cmml">
                 (
                </mo>
                <msub id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.cmml">
                 <mi id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.2" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml">
                  r
                 </mi>
                 <mi id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.3" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.3.cmml">
                  t
                 </mi>
                </msub>
                <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.3" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.5" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E9Xb.4.1.1.m1.3.3.1.2" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E9Xb.4.1.1.m1.3b">
           <apply id="S4.E9Xb.4.1.1.m1.3.3.1.1.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1">
            <eq id="S4.E9Xb.4.1.1.m1.3.3.1.1.3.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.3">
            </eq>
            <apply id="S4.E9Xb.4.1.1.m1.3.3.1.1.4.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.4">
             <csymbol cd="ambiguous" id="S4.E9Xb.4.1.1.m1.3.3.1.1.4.1.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.4">
              subscript
             </csymbol>
             <ci id="S4.E9Xb.4.1.1.m1.3.3.1.1.4.2.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.4.2">
              ℒ
             </ci>
             <ci id="S4.E9Xb.4.1.1.m1.3.3.1.1.4.3.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.4.3">
              𝑟
             </ci>
            </apply>
            <apply id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.3.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2">
             <ci id="S4.E9Xb.4.1.1.m1.2.2.cmml" xref="S4.E9Xb.4.1.1.m1.2.2">
              catxent
             </ci>
             <apply id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1">
               subscript
              </csymbol>
              <apply id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2">
               <ci id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.1">
                ^
               </ci>
               <ci id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.2.2">
                𝑟
               </ci>
              </apply>
              <ci id="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1">
              <ci id="S4.E9Xb.4.1.1.m1.1.1.cmml" xref="S4.E9Xb.4.1.1.m1.1.1">
               twohot
              </ci>
              <apply id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1">
               <csymbol cd="ambiguous" id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.1.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1">
                subscript
               </csymbol>
               <ci id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.2">
                𝑟
               </ci>
               <ci id="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.3.cmml" xref="S4.E9Xb.4.1.1.m1.3.3.1.1.2.2.2.2.1.1.1.3">
                𝑡
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E9Xb.4.1.1.m1.3c">
           \displaystyle\mathcal{L}_{r}=\operatorname{catxent}\left(\hat{r}_{t},\operatorname{twohot}\left(r_{t}\right)\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E9Xc">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.E9Xc.2.1.1.1">
         Continue Loss:
        </span>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{c}=\operatorname{binxent}\left(\hat{c}_{t},c_{t}\right)," class="ltx_Math" display="inline" id="S4.E9Xc.4.1.1.m1.2">
         <semantics id="S4.E9Xc.4.1.1.m1.2a">
          <mrow id="S4.E9Xc.4.1.1.m1.2.2.1" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.cmml">
           <mrow id="S4.E9Xc.4.1.1.m1.2.2.1.1" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.cmml">
            <msub id="S4.E9Xc.4.1.1.m1.2.2.1.1.4" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.4.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E9Xc.4.1.1.m1.2.2.1.1.4.2" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.4.2.cmml">
              ℒ
             </mi>
             <mi id="S4.E9Xc.4.1.1.m1.2.2.1.1.4.3" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.4.3.cmml">
              c
             </mi>
            </msub>
            <mo id="S4.E9Xc.4.1.1.m1.2.2.1.1.3" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.3.cmml">
             =
            </mo>
            <mrow id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.3.cmml">
             <mi id="S4.E9Xc.4.1.1.m1.1.1" xref="S4.E9Xc.4.1.1.m1.1.1.cmml">
              binxent
             </mi>
             <mo id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2a" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.3.cmml">
              ⁡
             </mo>
             <mrow id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.3.cmml">
              <mo id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.3" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.3.cmml">
               (
              </mo>
              <msub id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.cmml">
               <mover accent="true" id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">
                <mi id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.2" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.2.cmml">
                 c
                </mi>
                <mo id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.1" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml">
                 ^
                </mo>
               </mover>
               <mi id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.4" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.3.cmml">
               ,
              </mo>
              <msub id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.cmml">
               <mi id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.2.cmml">
                c
               </mi>
               <mi id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.3" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.5" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E9Xc.4.1.1.m1.2.2.1.2" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E9Xc.4.1.1.m1.2b">
           <apply id="S4.E9Xc.4.1.1.m1.2.2.1.1.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1">
            <eq id="S4.E9Xc.4.1.1.m1.2.2.1.1.3.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.3">
            </eq>
            <apply id="S4.E9Xc.4.1.1.m1.2.2.1.1.4.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.4">
             <csymbol cd="ambiguous" id="S4.E9Xc.4.1.1.m1.2.2.1.1.4.1.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.4">
              subscript
             </csymbol>
             <ci id="S4.E9Xc.4.1.1.m1.2.2.1.1.4.2.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.4.2">
              ℒ
             </ci>
             <ci id="S4.E9Xc.4.1.1.m1.2.2.1.1.4.3.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.4.3">
              𝑐
             </ci>
            </apply>
            <apply id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.3.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2">
             <ci id="S4.E9Xc.4.1.1.m1.1.1.cmml" xref="S4.E9Xc.4.1.1.m1.1.1">
              binxent
             </ci>
             <apply id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1">
               subscript
              </csymbol>
              <apply id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2">
               <ci id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.1">
                ^
               </ci>
               <ci id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.2.2">
                𝑐
               </ci>
              </apply>
              <ci id="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2">
              <csymbol cd="ambiguous" id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.2">
               𝑐
              </ci>
              <ci id="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E9Xc.4.1.1.m1.2.2.1.1.2.2.2.2.3">
               𝑡
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E9Xc.4.1.1.m1.2c">
           \displaystyle\mathcal{L}_{c}=\operatorname{binxent}\left(\hat{c}_{t},c_{t}\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E9Xd">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.E9Xd.2.1.1.1">
         Prediction Loss:
        </span>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{\text{pred}}=\max\left(1,\operatorname{KL}\left[\operatorname{sg}\left(z_{t}\right)\|\hat{z}_{t}\right]\right)," class="ltx_Math" display="inline" id="S4.E9Xd.4.1.1.m1.5">
         <semantics id="S4.E9Xd.4.1.1.m1.5a">
          <mrow id="S4.E9Xd.4.1.1.m1.5.5.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.cmml">
           <mrow id="S4.E9Xd.4.1.1.m1.5.5.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.cmml">
            <msub id="S4.E9Xd.4.1.1.m1.5.5.1.1.3" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.3.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E9Xd.4.1.1.m1.5.5.1.1.3.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.3.2.cmml">
              ℒ
             </mi>
             <mtext id="S4.E9Xd.4.1.1.m1.5.5.1.1.3.3" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.3.3a.cmml">
              pred
             </mtext>
            </msub>
            <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.2.cmml">
             =
            </mo>
            <mrow id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.2.cmml">
             <mi id="S4.E9Xd.4.1.1.m1.3.3" xref="S4.E9Xd.4.1.1.m1.3.3.cmml">
              max
             </mi>
             <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1a" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.2.cmml">
              ⁡
             </mo>
             <mrow id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.2.cmml">
              <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.2.cmml">
               (
              </mo>
              <mn id="S4.E9Xd.4.1.1.m1.4.4" xref="S4.E9Xd.4.1.1.m1.4.4.cmml">
               1
              </mn>
              <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.3" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.2.cmml">
               ,
              </mo>
              <mrow id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
               <mi id="S4.E9Xd.4.1.1.m1.2.2" xref="S4.E9Xd.4.1.1.m1.2.2.cmml">
                KL
               </mi>
               <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1a" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
                ⁡
               </mo>
               <mrow id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
                <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
                 [
                </mo>
                <mrow id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">
                 <mrow id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  <mi id="S4.E9Xd.4.1.1.m1.1.1" xref="S4.E9Xd.4.1.1.m1.1.1.cmml">
                   sg
                  </mi>
                  <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   ⁡
                  </mo>
                  <mrow id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    (
                   </mo>
                   <msub id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                    <mi id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                     z
                    </mi>
                    <mi id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                     t
                    </mi>
                   </msub>
                   <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                 <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">
                  ∥
                 </mo>
                 <msub id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">
                  <mover accent="true" id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">
                   <mi id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml">
                    z
                   </mi>
                   <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml">
                    ^
                   </mo>
                  </mover>
                  <mi id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml">
                   t
                  </mi>
                 </msub>
                </mrow>
                <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
                 ]
                </mo>
               </mrow>
              </mrow>
              <mo id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.4" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.2.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E9Xd.4.1.1.m1.5.5.1.2" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E9Xd.4.1.1.m1.5b">
           <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1">
            <eq id="S4.E9Xd.4.1.1.m1.5.5.1.1.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.2">
            </eq>
            <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.3.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.3">
             <csymbol cd="ambiguous" id="S4.E9Xd.4.1.1.m1.5.5.1.1.3.1.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E9Xd.4.1.1.m1.5.5.1.1.3.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.3.2">
              ℒ
             </ci>
             <ci id="S4.E9Xd.4.1.1.m1.5.5.1.1.3.3a.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.3.3">
              <mtext id="S4.E9Xd.4.1.1.m1.5.5.1.1.3.3.cmml" mathsize="70%" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.3.3">
               pred
              </mtext>
             </ci>
            </apply>
            <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1">
             <max id="S4.E9Xd.4.1.1.m1.3.3.cmml" xref="S4.E9Xd.4.1.1.m1.3.3">
             </max>
             <cn id="S4.E9Xd.4.1.1.m1.4.4.cmml" type="integer" xref="S4.E9Xd.4.1.1.m1.4.4">
              1
             </cn>
             <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1">
              <ci id="S4.E9Xd.4.1.1.m1.2.2.cmml" xref="S4.E9Xd.4.1.1.m1.2.2">
               KL
              </ci>
              <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2">
                conditional
               </csymbol>
               <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">
                <ci id="S4.E9Xd.4.1.1.m1.1.1.cmml" xref="S4.E9Xd.4.1.1.m1.1.1">
                 sg
                </ci>
                <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                  𝑧
                 </ci>
                 <ci id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                  𝑡
                 </ci>
                </apply>
               </apply>
               <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3">
                <csymbol cd="ambiguous" id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3">
                 subscript
                </csymbol>
                <apply id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">
                 <ci id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1">
                  ^
                 </ci>
                 <ci id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2">
                  𝑧
                 </ci>
                </apply>
                <ci id="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9Xd.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3">
                 𝑡
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E9Xd.4.1.1.m1.5c">
           \displaystyle\mathcal{L}_{\text{pred}}=\max\left(1,\operatorname{KL}\left[\operatorname{sg}\left(z_{t}\right)\|\hat{z}_{t}\right]\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E9Xe">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.E9Xe.2.1.1.1">
         Regularizer:
        </span>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{\text{reg}}=\max\left(1,\operatorname{KL}\left[z_{t}\|\operatorname{sg}\left(\hat{z}_{t}\right)\right]\right)," class="ltx_Math" display="inline" id="S4.E9Xe.4.1.1.m1.5">
         <semantics id="S4.E9Xe.4.1.1.m1.5a">
          <mrow id="S4.E9Xe.4.1.1.m1.5.5.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.cmml">
           <mrow id="S4.E9Xe.4.1.1.m1.5.5.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.cmml">
            <msub id="S4.E9Xe.4.1.1.m1.5.5.1.1.3" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.3.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E9Xe.4.1.1.m1.5.5.1.1.3.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.3.2.cmml">
              ℒ
             </mi>
             <mtext id="S4.E9Xe.4.1.1.m1.5.5.1.1.3.3" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.3.3a.cmml">
              reg
             </mtext>
            </msub>
            <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.2.cmml">
             =
            </mo>
            <mrow id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.2.cmml">
             <mi id="S4.E9Xe.4.1.1.m1.3.3" xref="S4.E9Xe.4.1.1.m1.3.3.cmml">
              max
             </mi>
             <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1a" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.2.cmml">
              ⁡
             </mo>
             <mrow id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.2.cmml">
              <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.2.cmml">
               (
              </mo>
              <mn id="S4.E9Xe.4.1.1.m1.4.4" xref="S4.E9Xe.4.1.1.m1.4.4.cmml">
               1
              </mn>
              <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.3" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.2.cmml">
               ,
              </mo>
              <mrow id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
               <mi id="S4.E9Xe.4.1.1.m1.2.2" xref="S4.E9Xe.4.1.1.m1.2.2.cmml">
                KL
               </mi>
               <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1a" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
                ⁡
               </mo>
               <mrow id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
                <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
                 [
                </mo>
                <mrow id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">
                 <msub id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">
                  <mi id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">
                   z
                  </mi>
                  <mi id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml">
                   t
                  </mi>
                 </msub>
                 <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">
                  ∥
                 </mo>
                 <mrow id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  <mi id="S4.E9Xe.4.1.1.m1.1.1" xref="S4.E9Xe.4.1.1.m1.1.1.cmml">
                   sg
                  </mi>
                  <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   ⁡
                  </mo>
                  <mrow id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    (
                   </mo>
                   <msub id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                    <mover accent="true" id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                     <mi id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                      z
                     </mi>
                     <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">
                      ^
                     </mo>
                    </mover>
                    <mi id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                     t
                    </mi>
                   </msub>
                   <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                </mrow>
                <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">
                 ]
                </mo>
               </mrow>
              </mrow>
              <mo id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.4" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.2.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E9Xe.4.1.1.m1.5.5.1.2" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E9Xe.4.1.1.m1.5b">
           <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1">
            <eq id="S4.E9Xe.4.1.1.m1.5.5.1.1.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.2">
            </eq>
            <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.3.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.3">
             <csymbol cd="ambiguous" id="S4.E9Xe.4.1.1.m1.5.5.1.1.3.1.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E9Xe.4.1.1.m1.5.5.1.1.3.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.3.2">
              ℒ
             </ci>
             <ci id="S4.E9Xe.4.1.1.m1.5.5.1.1.3.3a.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.3.3">
              <mtext id="S4.E9Xe.4.1.1.m1.5.5.1.1.3.3.cmml" mathsize="70%" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.3.3">
               reg
              </mtext>
             </ci>
            </apply>
            <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1">
             <max id="S4.E9Xe.4.1.1.m1.3.3.cmml" xref="S4.E9Xe.4.1.1.m1.3.3">
             </max>
             <cn id="S4.E9Xe.4.1.1.m1.4.4.cmml" type="integer" xref="S4.E9Xe.4.1.1.m1.4.4">
              1
             </cn>
             <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1">
              <ci id="S4.E9Xe.4.1.1.m1.2.2.cmml" xref="S4.E9Xe.4.1.1.m1.2.2">
               KL
              </ci>
              <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2">
                conditional
               </csymbol>
               <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3">
                <csymbol cd="ambiguous" id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.2">
                 𝑧
                </ci>
                <ci id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.3.3">
                 𝑡
                </ci>
               </apply>
               <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">
                <ci id="S4.E9Xe.4.1.1.m1.1.1.cmml" xref="S4.E9Xe.4.1.1.m1.1.1">
                 sg
                </ci>
                <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <apply id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                  <ci id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">
                   ^
                  </ci>
                  <ci id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">
                   𝑧
                  </ci>
                 </apply>
                 <ci id="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9Xe.4.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                  𝑡
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E9Xe.4.1.1.m1.5c">
           \displaystyle\mathcal{L}_{\text{reg}}=\max\left(1,\operatorname{KL}\left[z_{t}\|\operatorname{sg}\left(\hat{z}_{t}\right)\right]\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para" id="S4.SS3.p2">
    <p class="ltx_p" id="S4.SS3.p2.4">
     where
     <math alttext="\rm catxent" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1">
      <semantics id="S4.SS3.p2.1.m1.1a">
       <mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">
        catxent
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b">
        <ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">
         catxent
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">
        \rm catxent
       </annotation>
      </semantics>
     </math>
     is the categorical cross-entropy loss,
     <math alttext="\rm binxent" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1">
      <semantics id="S4.SS3.p2.2.m2.1a">
       <mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">
        binxent
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b">
        <ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">
         binxent
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">
        \rm binxent
       </annotation>
      </semantics>
     </math>
     is the binary cross-entropy loss,
     <math alttext="\rm sg" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1">
      <semantics id="S4.SS3.p2.3.m3.1a">
       <mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">
        sg
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b">
        <ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">
         sg
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">
        \rm sg
       </annotation>
      </semantics>
     </math>
     is the stop gradient operator, KL refers to the Kullback-Leibler (KL) divergence. Details of the
     <math alttext="\text{twohot}(\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1">
      <semantics id="S4.SS3.p2.4.m4.1a">
       <mrow id="S4.SS3.p2.4.m4.1.2" xref="S4.SS3.p2.4.m4.1.2.cmml">
        <mtext id="S4.SS3.p2.4.m4.1.2.2" xref="S4.SS3.p2.4.m4.1.2.2a.cmml">
         twohot
        </mtext>
        <mo id="S4.SS3.p2.4.m4.1.2.1" lspace="0em" rspace="0em" xref="S4.SS3.p2.4.m4.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S4.SS3.p2.4.m4.1.2.3.2" xref="S4.SS3.p2.4.m4.1.2.cmml">
         <mo id="S4.SS3.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S4.SS3.p2.4.m4.1.2.cmml">
          (
         </mo>
         <mo id="S4.SS3.p2.4.m4.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p2.4.m4.1.1.cmml">
          ⋅
         </mo>
         <mo id="S4.SS3.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S4.SS3.p2.4.m4.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b">
        <apply id="S4.SS3.p2.4.m4.1.2.cmml" xref="S4.SS3.p2.4.m4.1.2">
         <times id="S4.SS3.p2.4.m4.1.2.1.cmml" xref="S4.SS3.p2.4.m4.1.2.1">
         </times>
         <ci id="S4.SS3.p2.4.m4.1.2.2a.cmml" xref="S4.SS3.p2.4.m4.1.2.2">
          <mtext id="S4.SS3.p2.4.m4.1.2.2.cmml" xref="S4.SS3.p2.4.m4.1.2.2">
           twohot
          </mtext>
         </ci>
         <ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">
          ⋅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">
        \text{twohot}(\cdot)
       </annotation>
      </semantics>
     </math>
     can be found in Appendix
     <a class="ltx_ref" href="#A2.SS1" title="B.1 Two-hot Reward Prediction ‣ Appendix B Additional Details of DLLM ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       B.1
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS3.p3">
    <p class="ltx_p" id="S4.SS3.p3.1">
     We adopt the widely used actor-critic architecture for learning policies, where the actor executes actions and collects samples in the environment while the critic evaluates whether the executed action is good. We denote the model state as
     <math alttext="s_{t}=concat(z_{t},h_{t})" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.2">
      <semantics id="S4.SS3.p3.1.m1.2a">
       <mrow id="S4.SS3.p3.1.m1.2.2" xref="S4.SS3.p3.1.m1.2.2.cmml">
        <msub id="S4.SS3.p3.1.m1.2.2.4" xref="S4.SS3.p3.1.m1.2.2.4.cmml">
         <mi id="S4.SS3.p3.1.m1.2.2.4.2" xref="S4.SS3.p3.1.m1.2.2.4.2.cmml">
          s
         </mi>
         <mi id="S4.SS3.p3.1.m1.2.2.4.3" xref="S4.SS3.p3.1.m1.2.2.4.3.cmml">
          t
         </mi>
        </msub>
        <mo id="S4.SS3.p3.1.m1.2.2.3" xref="S4.SS3.p3.1.m1.2.2.3.cmml">
         =
        </mo>
        <mrow id="S4.SS3.p3.1.m1.2.2.2" xref="S4.SS3.p3.1.m1.2.2.2.cmml">
         <mi id="S4.SS3.p3.1.m1.2.2.2.4" xref="S4.SS3.p3.1.m1.2.2.2.4.cmml">
          c
         </mi>
         <mo id="S4.SS3.p3.1.m1.2.2.2.3" lspace="0em" rspace="0em" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">
          ​
         </mo>
         <mi id="S4.SS3.p3.1.m1.2.2.2.5" xref="S4.SS3.p3.1.m1.2.2.2.5.cmml">
          o
         </mi>
         <mo id="S4.SS3.p3.1.m1.2.2.2.3a" lspace="0em" rspace="0em" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">
          ​
         </mo>
         <mi id="S4.SS3.p3.1.m1.2.2.2.6" xref="S4.SS3.p3.1.m1.2.2.2.6.cmml">
          n
         </mi>
         <mo id="S4.SS3.p3.1.m1.2.2.2.3b" lspace="0em" rspace="0em" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">
          ​
         </mo>
         <mi id="S4.SS3.p3.1.m1.2.2.2.7" xref="S4.SS3.p3.1.m1.2.2.2.7.cmml">
          c
         </mi>
         <mo id="S4.SS3.p3.1.m1.2.2.2.3c" lspace="0em" rspace="0em" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">
          ​
         </mo>
         <mi id="S4.SS3.p3.1.m1.2.2.2.8" xref="S4.SS3.p3.1.m1.2.2.2.8.cmml">
          a
         </mi>
         <mo id="S4.SS3.p3.1.m1.2.2.2.3d" lspace="0em" rspace="0em" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">
          ​
         </mo>
         <mi id="S4.SS3.p3.1.m1.2.2.2.9" xref="S4.SS3.p3.1.m1.2.2.2.9.cmml">
          t
         </mi>
         <mo id="S4.SS3.p3.1.m1.2.2.2.3e" lspace="0em" rspace="0em" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">
          ​
         </mo>
         <mrow id="S4.SS3.p3.1.m1.2.2.2.2.2" xref="S4.SS3.p3.1.m1.2.2.2.2.3.cmml">
          <mo id="S4.SS3.p3.1.m1.2.2.2.2.2.3" stretchy="false" xref="S4.SS3.p3.1.m1.2.2.2.2.3.cmml">
           (
          </mo>
          <msub id="S4.SS3.p3.1.m1.1.1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.cmml">
           <mi id="S4.SS3.p3.1.m1.1.1.1.1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.2.cmml">
            z
           </mi>
           <mi id="S4.SS3.p3.1.m1.1.1.1.1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.3.cmml">
            t
           </mi>
          </msub>
          <mo id="S4.SS3.p3.1.m1.2.2.2.2.2.4" xref="S4.SS3.p3.1.m1.2.2.2.2.3.cmml">
           ,
          </mo>
          <msub id="S4.SS3.p3.1.m1.2.2.2.2.2.2" xref="S4.SS3.p3.1.m1.2.2.2.2.2.2.cmml">
           <mi id="S4.SS3.p3.1.m1.2.2.2.2.2.2.2" xref="S4.SS3.p3.1.m1.2.2.2.2.2.2.2.cmml">
            h
           </mi>
           <mi id="S4.SS3.p3.1.m1.2.2.2.2.2.2.3" xref="S4.SS3.p3.1.m1.2.2.2.2.2.2.3.cmml">
            t
           </mi>
          </msub>
          <mo id="S4.SS3.p3.1.m1.2.2.2.2.2.5" stretchy="false" xref="S4.SS3.p3.1.m1.2.2.2.2.3.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.2b">
        <apply id="S4.SS3.p3.1.m1.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2">
         <eq id="S4.SS3.p3.1.m1.2.2.3.cmml" xref="S4.SS3.p3.1.m1.2.2.3">
         </eq>
         <apply id="S4.SS3.p3.1.m1.2.2.4.cmml" xref="S4.SS3.p3.1.m1.2.2.4">
          <csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.2.4.1.cmml" xref="S4.SS3.p3.1.m1.2.2.4">
           subscript
          </csymbol>
          <ci id="S4.SS3.p3.1.m1.2.2.4.2.cmml" xref="S4.SS3.p3.1.m1.2.2.4.2">
           𝑠
          </ci>
          <ci id="S4.SS3.p3.1.m1.2.2.4.3.cmml" xref="S4.SS3.p3.1.m1.2.2.4.3">
           𝑡
          </ci>
         </apply>
         <apply id="S4.SS3.p3.1.m1.2.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2.2">
          <times id="S4.SS3.p3.1.m1.2.2.2.3.cmml" xref="S4.SS3.p3.1.m1.2.2.2.3">
          </times>
          <ci id="S4.SS3.p3.1.m1.2.2.2.4.cmml" xref="S4.SS3.p3.1.m1.2.2.2.4">
           𝑐
          </ci>
          <ci id="S4.SS3.p3.1.m1.2.2.2.5.cmml" xref="S4.SS3.p3.1.m1.2.2.2.5">
           𝑜
          </ci>
          <ci id="S4.SS3.p3.1.m1.2.2.2.6.cmml" xref="S4.SS3.p3.1.m1.2.2.2.6">
           𝑛
          </ci>
          <ci id="S4.SS3.p3.1.m1.2.2.2.7.cmml" xref="S4.SS3.p3.1.m1.2.2.2.7">
           𝑐
          </ci>
          <ci id="S4.SS3.p3.1.m1.2.2.2.8.cmml" xref="S4.SS3.p3.1.m1.2.2.2.8">
           𝑎
          </ci>
          <ci id="S4.SS3.p3.1.m1.2.2.2.9.cmml" xref="S4.SS3.p3.1.m1.2.2.2.9">
           𝑡
          </ci>
          <interval closure="open" id="S4.SS3.p3.1.m1.2.2.2.2.3.cmml" xref="S4.SS3.p3.1.m1.2.2.2.2.2">
           <apply id="S4.SS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.2">
             𝑧
            </ci>
            <ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.3">
             𝑡
            </ci>
           </apply>
           <apply id="S4.SS3.p3.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2.2.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.SS3.p3.1.m1.2.2.2.2.2.2">
             subscript
            </csymbol>
            <ci id="S4.SS3.p3.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2.2.2.2.2.2">
             ℎ
            </ci>
            <ci id="S4.SS3.p3.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.SS3.p3.1.m1.2.2.2.2.2.2.3">
             𝑡
            </ci>
           </apply>
          </interval>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.2c">
        s_{t}=concat(z_{t},h_{t})
       </annotation>
      </semantics>
     </math>
     . The actor and the critic give:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E10">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E10X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.E10X.2.1.1.1">
         Actor:
        </span>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\pi_{\theta}(a_{t}\mid s_{t})," class="ltx_Math" display="inline" id="S4.E10X.4.1.1.m1.1">
         <semantics id="S4.E10X.4.1.1.m1.1a">
          <mrow id="S4.E10X.4.1.1.m1.1.1.1" xref="S4.E10X.4.1.1.m1.1.1.1.1.cmml">
           <mrow id="S4.E10X.4.1.1.m1.1.1.1.1" xref="S4.E10X.4.1.1.m1.1.1.1.1.cmml">
            <msub id="S4.E10X.4.1.1.m1.1.1.1.1.3" xref="S4.E10X.4.1.1.m1.1.1.1.1.3.cmml">
             <mi id="S4.E10X.4.1.1.m1.1.1.1.1.3.2" xref="S4.E10X.4.1.1.m1.1.1.1.1.3.2.cmml">
              π
             </mi>
             <mi id="S4.E10X.4.1.1.m1.1.1.1.1.3.3" xref="S4.E10X.4.1.1.m1.1.1.1.1.3.3.cmml">
              θ
             </mi>
            </msub>
            <mo id="S4.E10X.4.1.1.m1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E10X.4.1.1.m1.1.1.1.1.2.cmml">
             ​
            </mo>
            <mrow id="S4.E10X.4.1.1.m1.1.1.1.1.1.1" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.cmml">
             <mo id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.cmml">
              <msub id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.cmml">
               <mi id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.2" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.2.cmml">
                a
               </mi>
               <mi id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.3" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml">
               ∣
              </mo>
              <msub id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.cmml">
               <mi id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">
                s
               </mi>
               <mi id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">
                t
               </mi>
              </msub>
             </mrow>
             <mo id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S4.E10X.4.1.1.m1.1.1.1.2" xref="S4.E10X.4.1.1.m1.1.1.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E10X.4.1.1.m1.1b">
           <apply id="S4.E10X.4.1.1.m1.1.1.1.1.cmml" xref="S4.E10X.4.1.1.m1.1.1.1">
            <times id="S4.E10X.4.1.1.m1.1.1.1.1.2.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.2">
            </times>
            <apply id="S4.E10X.4.1.1.m1.1.1.1.1.3.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S4.E10X.4.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E10X.4.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.3.2">
              𝜋
             </ci>
             <ci id="S4.E10X.4.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.3.3">
              𝜃
             </ci>
            </apply>
            <apply id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1">
             <csymbol cd="latexml" id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.1">
              conditional
             </csymbol>
             <apply id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2">
              <csymbol cd="ambiguous" id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2">
               subscript
              </csymbol>
              <ci id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.2">
               𝑎
              </ci>
              <ci id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3">
              <csymbol cd="ambiguous" id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3">
               subscript
              </csymbol>
              <ci id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.2">
               𝑠
              </ci>
              <ci id="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10X.4.1.1.m1.1.1.1.1.1.1.1.3.3">
               𝑡
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E10X.4.1.1.m1.1c">
           \displaystyle\pi_{\theta}(a_{t}\mid s_{t}),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S4.E10X.7.1.1.1">
         Critic:
        </span>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle V_{\psi}(s_{t})." class="ltx_Math" display="inline" id="S4.E10X.9.1.1.m1.1">
         <semantics id="S4.E10X.9.1.1.m1.1a">
          <mrow id="S4.E10X.9.1.1.m1.1.1.1" xref="S4.E10X.9.1.1.m1.1.1.1.1.cmml">
           <mrow id="S4.E10X.9.1.1.m1.1.1.1.1" xref="S4.E10X.9.1.1.m1.1.1.1.1.cmml">
            <msub id="S4.E10X.9.1.1.m1.1.1.1.1.3" xref="S4.E10X.9.1.1.m1.1.1.1.1.3.cmml">
             <mi id="S4.E10X.9.1.1.m1.1.1.1.1.3.2" xref="S4.E10X.9.1.1.m1.1.1.1.1.3.2.cmml">
              V
             </mi>
             <mi id="S4.E10X.9.1.1.m1.1.1.1.1.3.3" xref="S4.E10X.9.1.1.m1.1.1.1.1.3.3.cmml">
              ψ
             </mi>
            </msub>
            <mo id="S4.E10X.9.1.1.m1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E10X.9.1.1.m1.1.1.1.1.2.cmml">
             ​
            </mo>
            <mrow id="S4.E10X.9.1.1.m1.1.1.1.1.1.1" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.cmml">
             <mo id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.cmml">
              (
             </mo>
             <msub id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.cmml">
              <mi id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.2.cmml">
               s
              </mi>
              <mi id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.3" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S4.E10X.9.1.1.m1.1.1.1.2" lspace="0em" xref="S4.E10X.9.1.1.m1.1.1.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E10X.9.1.1.m1.1b">
           <apply id="S4.E10X.9.1.1.m1.1.1.1.1.cmml" xref="S4.E10X.9.1.1.m1.1.1.1">
            <times id="S4.E10X.9.1.1.m1.1.1.1.1.2.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.2">
            </times>
            <apply id="S4.E10X.9.1.1.m1.1.1.1.1.3.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S4.E10X.9.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E10X.9.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.3.2">
              𝑉
             </ci>
             <ci id="S4.E10X.9.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.3.3">
              𝜓
             </ci>
            </apply>
            <apply id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.2">
              𝑠
             </ci>
             <ci id="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10X.9.1.1.m1.1.1.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E10X.9.1.1.m1.1c">
           \displaystyle V_{\psi}(s_{t}).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (10)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS3.p3.5">
     Note that both the actor network and the critic network are simple MLPs. The actor aims to maximize the cumulative returns with the involvement of intrinsic reward, i.e.,
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E11">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E11X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle R_{t}\doteq\sum_{\tau=0}^{\infty}\gamma^{\tau}(r_{t+\tau}+r^{\rm int}_{t+\tau})." class="ltx_Math" display="inline" id="S4.E11X.2.1.1.m1.1">
         <semantics id="S4.E11X.2.1.1.m1.1a">
          <mrow id="S4.E11X.2.1.1.m1.1.1.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.cmml">
           <mrow id="S4.E11X.2.1.1.m1.1.1.1.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.cmml">
            <msub id="S4.E11X.2.1.1.m1.1.1.1.1.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.3.cmml">
             <mi id="S4.E11X.2.1.1.m1.1.1.1.1.3.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.3.2.cmml">
              R
             </mi>
             <mi id="S4.E11X.2.1.1.m1.1.1.1.1.3.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.3.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S4.E11X.2.1.1.m1.1.1.1.1.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.2.cmml">
             ≐
            </mo>
            <mrow id="S4.E11X.2.1.1.m1.1.1.1.1.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.cmml">
             <mstyle displaystyle="true" id="S4.E11X.2.1.1.m1.1.1.1.1.1.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.cmml">
              <munderover id="S4.E11X.2.1.1.m1.1.1.1.1.1.2a" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.cmml">
               <mo id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.2.cmml">
                ∑
               </mo>
               <mrow id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.cmml">
                <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.2.cmml">
                 τ
                </mi>
                <mo id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.1.cmml">
                 =
                </mo>
                <mn id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.3.cmml">
                 0
                </mn>
               </mrow>
               <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.3" mathvariant="normal" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.3.cmml">
                ∞
               </mi>
              </munderover>
             </mstyle>
             <mrow id="S4.E11X.2.1.1.m1.1.1.1.1.1.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.cmml">
              <msup id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.cmml">
               <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">
                γ
               </mi>
               <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">
                τ
               </mi>
              </msup>
              <mo id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
               <mo id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
                <msub id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">
                 <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                  r
                 </mi>
                 <mrow id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                  <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">
                   t
                  </mi>
                  <mo id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">
                   +
                  </mo>
                  <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">
                   τ
                  </mi>
                 </mrow>
                </msub>
                <mo id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">
                 +
                </mo>
                <msubsup id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">
                 <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">
                  r
                 </mi>
                 <mrow id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                  <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">
                   t
                  </mi>
                  <mo id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">
                   +
                  </mo>
                  <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">
                   τ
                  </mi>
                 </mrow>
                 <mi id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">
                  int
                 </mi>
                </msubsup>
               </mrow>
               <mo id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E11X.2.1.1.m1.1.1.1.2" lspace="0em" xref="S4.E11X.2.1.1.m1.1.1.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E11X.2.1.1.m1.1b">
           <apply id="S4.E11X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1">
            <csymbol cd="latexml" id="S4.E11X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.2">
             approaches-limit
            </csymbol>
            <apply id="S4.E11X.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S4.E11X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E11X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.3.2">
              𝑅
             </ci>
             <ci id="S4.E11X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.3.3">
              𝑡
             </ci>
            </apply>
            <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1">
             <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2">
              <csymbol cd="ambiguous" id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2">
               superscript
              </csymbol>
              <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2">
               <csymbol cd="ambiguous" id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2">
                subscript
               </csymbol>
               <sum id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.2">
               </sum>
               <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3">
                <eq id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.1">
                </eq>
                <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.2">
                 𝜏
                </ci>
                <cn id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.2.3.3">
                 0
                </cn>
               </apply>
              </apply>
              <infinity id="S4.E11X.2.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.2.3">
              </infinity>
             </apply>
             <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1">
              <times id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.2">
              </times>
              <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3">
                superscript
               </csymbol>
               <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.2">
                𝛾
               </ci>
               <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.3.3">
                𝜏
               </ci>
              </apply>
              <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1">
               <plus id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1">
               </plus>
               <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">
                <csymbol cd="ambiguous" id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">
                 subscript
                </csymbol>
                <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2">
                 𝑟
                </ci>
                <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">
                 <plus id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1">
                 </plus>
                 <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2">
                  𝑡
                 </ci>
                 <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3">
                  𝜏
                 </ci>
                </apply>
               </apply>
               <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">
                <csymbol cd="ambiguous" id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">
                 subscript
                </csymbol>
                <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">
                  superscript
                 </csymbol>
                 <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.2">
                  𝑟
                 </ci>
                 <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.3">
                  int
                 </ci>
                </apply>
                <apply id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">
                 <plus id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.1">
                 </plus>
                 <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.2">
                  𝑡
                 </ci>
                 <ci id="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3">
                  𝜏
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E11X.2.1.1.m1.1c">
           \displaystyle R_{t}\doteq\sum_{\tau=0}^{\infty}\gamma^{\tau}(r_{t+\tau}+r^{\rm int}_{t+\tau}).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (11)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS3.p3.4">
     The intrinsic rewards beyond the prediction horizon
     <math alttext="T" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m1.1">
      <semantics id="S4.SS3.p3.2.m1.1a">
       <mi id="S4.SS3.p3.2.m1.1.1" xref="S4.SS3.p3.2.m1.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m1.1b">
        <ci id="S4.SS3.p3.2.m1.1.1.cmml" xref="S4.SS3.p3.2.m1.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.2.m1.1c">
        T
       </annotation>
      </semantics>
     </math>
     are inaccessible, and we set them to zero. The details of bootstrapped
     <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m2.1">
      <semantics id="S4.SS3.p3.3.m2.1a">
       <mi id="S4.SS3.p3.3.m2.1.1" xref="S4.SS3.p3.3.m2.1.1.cmml">
        λ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m2.1b">
        <ci id="S4.SS3.p3.3.m2.1.1.cmml" xref="S4.SS3.p3.3.m2.1.1">
         𝜆
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.3.m2.1c">
        \lambda
       </annotation>
      </semantics>
     </math>
     -returns
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib54" title="">
       54
      </a>
      ]
     </cite>
     . Then the bootstrapped
     <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m3.1">
      <semantics id="S4.SS3.p3.4.m3.1a">
       <mi id="S4.SS3.p3.4.m3.1.1" xref="S4.SS3.p3.4.m3.1.1.cmml">
        λ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m3.1b">
        <ci id="S4.SS3.p3.4.m3.1.1.cmml" xref="S4.SS3.p3.4.m3.1.1">
         𝜆
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p3.4.m3.1c">
        \lambda
       </annotation>
      </semantics>
     </math>
     -returns
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib54" title="">
       54
      </a>
      ]
     </cite>
     could be written as:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E12">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E12X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle R_{t}^{\lambda}\doteq r_{t}+\gamma c_{t}\left((1-\lambda)V_{\psi}\left(s_{t+1}\right)+\lambda R_{t+1}^{\lambda}\right)," class="ltx_Math" display="inline" id="S4.E12X.2.1.1.m1.1">
         <semantics id="S4.E12X.2.1.1.m1.1a">
          <mrow id="S4.E12X.2.1.1.m1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.cmml">
           <mrow id="S4.E12X.2.1.1.m1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.cmml">
            <msubsup id="S4.E12X.2.1.1.m1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.3.cmml">
             <mi id="S4.E12X.2.1.1.m1.1.1.1.1.3.2.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.3.2.2.cmml">
              R
             </mi>
             <mi id="S4.E12X.2.1.1.m1.1.1.1.1.3.2.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.3.2.3.cmml">
              t
             </mi>
             <mi id="S4.E12X.2.1.1.m1.1.1.1.1.3.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.3.3.cmml">
              λ
             </mi>
            </msubsup>
            <mo id="S4.E12X.2.1.1.m1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.2.cmml">
             ≐
            </mo>
            <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.cmml">
             <msub id="S4.E12X.2.1.1.m1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.3.cmml">
              <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.3.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.3.2.cmml">
               r
              </mi>
              <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.3.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.3.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.2.cmml">
              +
             </mo>
             <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.cmml">
              <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.3.cmml">
               γ
              </mi>
              <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <msub id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.cmml">
               <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.2.cmml">
                c
               </mi>
               <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.2a" lspace="0em" rspace="0em" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
               <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
                <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">
                 <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   (
                  </mo>
                  <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mn id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    1
                   </mn>
                   <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                    −
                   </mo>
                   <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    λ
                   </mi>
                  </mrow>
                  <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                 <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" lspace="0em" rspace="0em" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                  ​
                 </mo>
                 <msub id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.cmml">
                  <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml">
                   V
                  </mi>
                  <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml">
                   ψ
                  </mi>
                 </msub>
                 <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3a" lspace="0em" rspace="0em" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                  ​
                 </mo>
                 <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">
                  <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">
                   (
                  </mo>
                  <msub id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">
                   <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml">
                    s
                   </mi>
                   <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml">
                    <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml">
                     t
                    </mi>
                    <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1.cmml">
                     +
                    </mo>
                    <mn id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.cmml">
                     1
                    </mn>
                   </mrow>
                  </msub>
                  <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">
                 +
                </mo>
                <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.cmml">
                 <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">
                  λ
                 </mi>
                 <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.1" lspace="0em" rspace="0em" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.1.cmml">
                  ​
                 </mo>
                 <msubsup id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.cmml">
                  <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.2.cmml">
                   R
                  </mi>
                  <mrow id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.cmml">
                   <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.2.cmml">
                    t
                   </mi>
                   <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.1.cmml">
                    +
                   </mo>
                   <mn id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.3.cmml">
                    1
                   </mn>
                  </mrow>
                  <mi id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">
                   λ
                  </mi>
                 </msubsup>
                </mrow>
               </mrow>
               <mo id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E12X.2.1.1.m1.1.1.1.2" xref="S4.E12X.2.1.1.m1.1.1.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E12X.2.1.1.m1.1b">
           <apply id="S4.E12X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1">
            <csymbol cd="latexml" id="S4.E12X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.2">
             approaches-limit
            </csymbol>
            <apply id="S4.E12X.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.3">
              superscript
             </csymbol>
             <apply id="S4.E12X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.3">
              <csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.3">
               subscript
              </csymbol>
              <ci id="S4.E12X.2.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.3.2.2">
               𝑅
              </ci>
              <ci id="S4.E12X.2.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.3.2.3">
               𝑡
              </ci>
             </apply>
             <ci id="S4.E12X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.3.3">
              𝜆
             </ci>
            </apply>
            <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1">
             <plus id="S4.E12X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.2">
             </plus>
             <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.3">
              <csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.3">
               subscript
              </csymbol>
              <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.3.2">
               𝑟
              </ci>
              <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.3.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1">
              <times id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.2">
              </times>
              <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.3">
               𝛾
              </ci>
              <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4">
               <csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4">
                subscript
               </csymbol>
               <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.2">
                𝑐
               </ci>
               <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.4.3">
                𝑡
               </ci>
              </apply>
              <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1">
               <plus id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">
               </plus>
               <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">
                <times id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">
                </times>
                <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">
                 <minus id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                 </minus>
                 <cn id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                  1
                 </cn>
                 <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                  𝜆
                 </ci>
                </apply>
                <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4">
                 <csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4">
                  subscript
                 </csymbol>
                 <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.2">
                  𝑉
                 </ci>
                 <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.4.3">
                  𝜓
                 </ci>
                </apply>
                <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1">
                 <csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1">
                  subscript
                 </csymbol>
                 <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2">
                  𝑠
                 </ci>
                 <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3">
                  <plus id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.1">
                  </plus>
                  <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.2">
                   𝑡
                  </ci>
                  <cn id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3.cmml" type="integer" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
               </apply>
               <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4">
                <times id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.1">
                </times>
                <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.2">
                 𝜆
                </ci>
                <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3">
                 <csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3">
                  superscript
                 </csymbol>
                 <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3">
                  <csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3">
                   subscript
                  </csymbol>
                  <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.2">
                   𝑅
                  </ci>
                  <apply id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3">
                   <plus id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.1">
                   </plus>
                   <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.2.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.2">
                    𝑡
                   </ci>
                   <cn id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.3.cmml" type="integer" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.2.3.3">
                    1
                   </cn>
                  </apply>
                 </apply>
                 <ci id="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.4.3.3">
                  𝜆
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E12X.2.1.1.m1.1c">
           \displaystyle R_{t}^{\lambda}\doteq r_{t}+\gamma c_{t}\left((1-\lambda)V_{\psi}\left(s_{t+1}\right)+\lambda R_{t+1}^{\lambda}\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\quad R_{T}^{\lambda}\doteq V_{\psi}\left(s_{T}\right)." class="ltx_Math" display="inline" id="S4.E12X.4.1.1.m1.1">
         <semantics id="S4.E12X.4.1.1.m1.1a">
          <mrow id="S4.E12X.4.1.1.m1.1.1.1" xref="S4.E12X.4.1.1.m1.1.1.1.1.cmml">
           <mrow id="S4.E12X.4.1.1.m1.1.1.1.1" xref="S4.E12X.4.1.1.m1.1.1.1.1.cmml">
            <msubsup id="S4.E12X.4.1.1.m1.1.1.1.1.3" xref="S4.E12X.4.1.1.m1.1.1.1.1.3.cmml">
             <mi id="S4.E12X.4.1.1.m1.1.1.1.1.3.2.2" xref="S4.E12X.4.1.1.m1.1.1.1.1.3.2.2.cmml">
              R
             </mi>
             <mi id="S4.E12X.4.1.1.m1.1.1.1.1.3.2.3" xref="S4.E12X.4.1.1.m1.1.1.1.1.3.2.3.cmml">
              T
             </mi>
             <mi id="S4.E12X.4.1.1.m1.1.1.1.1.3.3" xref="S4.E12X.4.1.1.m1.1.1.1.1.3.3.cmml">
              λ
             </mi>
            </msubsup>
            <mo id="S4.E12X.4.1.1.m1.1.1.1.1.2" xref="S4.E12X.4.1.1.m1.1.1.1.1.2.cmml">
             ≐
            </mo>
            <mrow id="S4.E12X.4.1.1.m1.1.1.1.1.1" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.cmml">
             <msub id="S4.E12X.4.1.1.m1.1.1.1.1.1.3" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.3.cmml">
              <mi id="S4.E12X.4.1.1.m1.1.1.1.1.1.3.2" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.3.2.cmml">
               V
              </mi>
              <mi id="S4.E12X.4.1.1.m1.1.1.1.1.1.3.3" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.3.3.cmml">
               ψ
              </mi>
             </msub>
             <mo id="S4.E12X.4.1.1.m1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml">
              <mo id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml">
               (
              </mo>
              <msub id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml">
               <mi id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">
                s
               </mi>
               <mi id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">
                T
               </mi>
              </msub>
              <mo id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.3" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E12X.4.1.1.m1.1.1.1.2" lspace="0em" xref="S4.E12X.4.1.1.m1.1.1.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E12X.4.1.1.m1.1b">
           <apply id="S4.E12X.4.1.1.m1.1.1.1.1.cmml" xref="S4.E12X.4.1.1.m1.1.1.1">
            <csymbol cd="latexml" id="S4.E12X.4.1.1.m1.1.1.1.1.2.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.2">
             approaches-limit
            </csymbol>
            <apply id="S4.E12X.4.1.1.m1.1.1.1.1.3.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S4.E12X.4.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.3">
              superscript
             </csymbol>
             <apply id="S4.E12X.4.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.3">
              <csymbol cd="ambiguous" id="S4.E12X.4.1.1.m1.1.1.1.1.3.2.1.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.3">
               subscript
              </csymbol>
              <ci id="S4.E12X.4.1.1.m1.1.1.1.1.3.2.2.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.3.2.2">
               𝑅
              </ci>
              <ci id="S4.E12X.4.1.1.m1.1.1.1.1.3.2.3.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.3.2.3">
               𝑇
              </ci>
             </apply>
             <ci id="S4.E12X.4.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.3.3">
              𝜆
             </ci>
            </apply>
            <apply id="S4.E12X.4.1.1.m1.1.1.1.1.1.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1">
             <times id="S4.E12X.4.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.2">
             </times>
             <apply id="S4.E12X.4.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.3">
              <csymbol cd="ambiguous" id="S4.E12X.4.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.3">
               subscript
              </csymbol>
              <ci id="S4.E12X.4.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.3.2">
               𝑉
              </ci>
              <ci id="S4.E12X.4.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.3.3">
               𝜓
              </ci>
             </apply>
             <apply id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.2">
               𝑠
              </ci>
              <ci id="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12X.4.1.1.m1.1.1.1.1.1.1.1.1.3">
               𝑇
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E12X.4.1.1.m1.1c">
           \displaystyle\quad R_{T}^{\lambda}\doteq V_{\psi}\left(s_{T}\right).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (12)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para" id="S4.SS3.p4">
    <p class="ltx_p" id="S4.SS3.p4.1">
     The actor and the critic are updated via the following losses:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E13">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E13X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{V}=\operatorname{catxent}\left(V_{\psi}(s_{t}),\operatorname{sg}\left(\operatorname{twohot}\left(R_{t}\right)\right)\right)," class="ltx_Math" display="inline" id="S4.E13X.2.1.1.m1.4">
         <semantics id="S4.E13X.2.1.1.m1.4a">
          <mrow id="S4.E13X.2.1.1.m1.4.4.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.cmml">
           <mrow id="S4.E13X.2.1.1.m1.4.4.1.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.cmml">
            <msub id="S4.E13X.2.1.1.m1.4.4.1.1.4" xref="S4.E13X.2.1.1.m1.4.4.1.1.4.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E13X.2.1.1.m1.4.4.1.1.4.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.4.2.cmml">
              ℒ
             </mi>
             <mi id="S4.E13X.2.1.1.m1.4.4.1.1.4.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.4.3.cmml">
              V
             </mi>
            </msub>
            <mo id="S4.E13X.2.1.1.m1.4.4.1.1.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.3.cmml">
             =
            </mo>
            <mrow id="S4.E13X.2.1.1.m1.4.4.1.1.2.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.3.cmml">
             <mi id="S4.E13X.2.1.1.m1.3.3" xref="S4.E13X.2.1.1.m1.3.3.cmml">
              catxent
             </mi>
             <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2a" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.3.cmml">
              ⁡
             </mo>
             <mrow id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.3.cmml">
              <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.3.cmml">
               (
              </mo>
              <mrow id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.cmml">
               <msub id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml">
                <mi id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.2.cmml">
                 V
                </mi>
                <mi id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.3.cmml">
                 ψ
                </mi>
               </msub>
               <mo id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">
                <mo id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <msub id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">
                 <mi id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">
                  s
                 </mi>
                 <mi id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">
                  t
                 </mi>
                </msub>
                <mo id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.4" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.3.cmml">
               ,
              </mo>
              <mrow id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml">
               <mi id="S4.E13X.2.1.1.m1.2.2" xref="S4.E13X.2.1.1.m1.2.2.cmml">
                sg
               </mi>
               <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1a" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml">
                ⁡
               </mo>
               <mrow id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml">
                <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml">
                 (
                </mo>
                <mrow id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.2.cmml">
                 <mi id="S4.E13X.2.1.1.m1.1.1" xref="S4.E13X.2.1.1.m1.1.1.cmml">
                  twohot
                 </mi>
                 <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1a" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.2.cmml">
                  ⁡
                 </mo>
                 <mrow id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.2.cmml">
                  <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.2.cmml">
                   (
                  </mo>
                  <msub id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.cmml">
                   <mi id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.2.cmml">
                    R
                   </mi>
                   <mi id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.3.cmml">
                    t
                   </mi>
                  </msub>
                  <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.2.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.3" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.5" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E13X.2.1.1.m1.4.4.1.2" xref="S4.E13X.2.1.1.m1.4.4.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E13X.2.1.1.m1.4b">
           <apply id="S4.E13X.2.1.1.m1.4.4.1.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.1">
            <eq id="S4.E13X.2.1.1.m1.4.4.1.1.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.3">
            </eq>
            <apply id="S4.E13X.2.1.1.m1.4.4.1.1.4.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.4">
             <csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.4.4.1.1.4.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.4">
              subscript
             </csymbol>
             <ci id="S4.E13X.2.1.1.m1.4.4.1.1.4.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.4.2">
              ℒ
             </ci>
             <ci id="S4.E13X.2.1.1.m1.4.4.1.1.4.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.4.3">
              𝑉
             </ci>
            </apply>
            <apply id="S4.E13X.2.1.1.m1.4.4.1.1.2.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2">
             <ci id="S4.E13X.2.1.1.m1.3.3.cmml" xref="S4.E13X.2.1.1.m1.3.3">
              catxent
             </ci>
             <apply id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1">
              <times id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.2">
              </times>
              <apply id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.2">
                𝑉
               </ci>
               <ci id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.3.3">
                𝜓
               </ci>
              </apply>
              <apply id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2">
                𝑠
               </ci>
               <ci id="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3">
                𝑡
               </ci>
              </apply>
             </apply>
             <apply id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1">
              <ci id="S4.E13X.2.1.1.m1.2.2.cmml" xref="S4.E13X.2.1.1.m1.2.2">
               sg
              </ci>
              <apply id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1">
               <ci id="S4.E13X.2.1.1.m1.1.1.cmml" xref="S4.E13X.2.1.1.m1.1.1">
                twohot
               </ci>
               <apply id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.2">
                 𝑅
                </ci>
                <ci id="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.1.1.2.2.2.2.1.1.1.1.1.1.3">
                 𝑡
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E13X.2.1.1.m1.4c">
           \displaystyle\mathcal{L}_{V}=\operatorname{catxent}\left(V_{\psi}(s_{t}),\operatorname{sg}\left(\operatorname{twohot}\left(R_{t}\right)\right)\right),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (13)
        </span>
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E13Xa">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{\pi}=-\frac{\operatorname{sg}\left(R_{t}-V(s_{t})\right)}{\max(1,S)}\log\pi_{\theta}\left(a_{t}\mid s_{t}\right)-\eta\mathrm{H}\left[\pi_{\theta}\left(a_{t}\mid s_{t}\right)\right]." class="ltx_Math" display="inline" id="S4.E13Xa.2.1.1.m1.6">
         <semantics id="S4.E13Xa.2.1.1.m1.6a">
          <mrow id="S4.E13Xa.2.1.1.m1.6.6.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.cmml">
           <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.cmml">
            <msub id="S4.E13Xa.2.1.1.m1.6.6.1.1.4" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.4.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E13Xa.2.1.1.m1.6.6.1.1.4.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.4.2.cmml">
              ℒ
             </mi>
             <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.4.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.4.3.cmml">
              π
             </mi>
            </msub>
            <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.3.cmml">
             =
            </mo>
            <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.cmml">
             <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.cmml">
              <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1a" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.cmml">
               −
              </mo>
              <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.cmml">
               <mstyle displaystyle="true" id="S4.E13Xa.2.1.1.m1.5.5" xref="S4.E13Xa.2.1.1.m1.5.5.cmml">
                <mfrac id="S4.E13Xa.2.1.1.m1.5.5a" xref="S4.E13Xa.2.1.1.m1.5.5.cmml">
                 <mrow id="S4.E13Xa.2.1.1.m1.2.2.2.2" xref="S4.E13Xa.2.1.1.m1.2.2.2.3.cmml">
                  <mi id="S4.E13Xa.2.1.1.m1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.1.1.1.1.cmml">
                   sg
                  </mi>
                  <mo id="S4.E13Xa.2.1.1.m1.2.2.2.2a" xref="S4.E13Xa.2.1.1.m1.2.2.2.3.cmml">
                   ⁡
                  </mo>
                  <mrow id="S4.E13Xa.2.1.1.m1.2.2.2.2.1" xref="S4.E13Xa.2.1.1.m1.2.2.2.3.cmml">
                   <mo id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.2" xref="S4.E13Xa.2.1.1.m1.2.2.2.3.cmml">
                    (
                   </mo>
                   <mrow id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.cmml">
                    <msub id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml">
                     <mi id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.2" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.2.cmml">
                      R
                     </mi>
                     <mi id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.3" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.3.cmml">
                      t
                     </mi>
                    </msub>
                    <mo id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.2" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml">
                     −
                    </mo>
                    <mrow id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml">
                     <mi id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.3" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml">
                      V
                     </mi>
                     <mo id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml">
                      ​
                     </mo>
                     <mrow id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.cmml">
                      <mo id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.cmml">
                       (
                      </mo>
                      <msub id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.cmml">
                       <mi id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">
                        s
                       </mi>
                       <mi id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">
                        t
                       </mi>
                      </msub>
                      <mo id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.cmml">
                       )
                      </mo>
                     </mrow>
                    </mrow>
                   </mrow>
                   <mo id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.3" xref="S4.E13Xa.2.1.1.m1.2.2.2.3.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                 <mrow id="S4.E13Xa.2.1.1.m1.5.5.5.5" xref="S4.E13Xa.2.1.1.m1.5.5.5.4.cmml">
                  <mi id="S4.E13Xa.2.1.1.m1.3.3.3.1" xref="S4.E13Xa.2.1.1.m1.3.3.3.1.cmml">
                   max
                  </mi>
                  <mo id="S4.E13Xa.2.1.1.m1.5.5.5.5a" xref="S4.E13Xa.2.1.1.m1.5.5.5.4.cmml">
                   ⁡
                  </mo>
                  <mrow id="S4.E13Xa.2.1.1.m1.5.5.5.5.1" xref="S4.E13Xa.2.1.1.m1.5.5.5.4.cmml">
                   <mo id="S4.E13Xa.2.1.1.m1.5.5.5.5.1.1" stretchy="false" xref="S4.E13Xa.2.1.1.m1.5.5.5.4.cmml">
                    (
                   </mo>
                   <mn id="S4.E13Xa.2.1.1.m1.4.4.4.2" xref="S4.E13Xa.2.1.1.m1.4.4.4.2.cmml">
                    1
                   </mn>
                   <mo id="S4.E13Xa.2.1.1.m1.5.5.5.5.1.2" xref="S4.E13Xa.2.1.1.m1.5.5.5.4.cmml">
                    ,
                   </mo>
                   <mi id="S4.E13Xa.2.1.1.m1.5.5.5.3" xref="S4.E13Xa.2.1.1.m1.5.5.5.3.cmml">
                    S
                   </mi>
                   <mo id="S4.E13Xa.2.1.1.m1.5.5.5.5.1.3" stretchy="false" xref="S4.E13Xa.2.1.1.m1.5.5.5.4.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                </mfrac>
               </mstyle>
               <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.2" lspace="0.167em" rspace="0em" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.cmml">
                <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.1.cmml">
                 log
                </mi>
                <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.cmml">
                 ⁡
                </mo>
                <msub id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.cmml">
                 <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.2.cmml">
                  π
                 </mi>
                 <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.3.cmml">
                  θ
                 </mi>
                </msub>
               </mrow>
               <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.2a" lspace="0em" rspace="0em" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml">
                <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml">
                 <msub id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">
                  <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml">
                   a
                  </mi>
                  <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml">
                   t
                  </mi>
                 </msub>
                 <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">
                  ∣
                 </mo>
                 <msub id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">
                  <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml">
                   s
                  </mi>
                  <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml">
                   t
                  </mi>
                 </msub>
                </mrow>
                <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
             <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.3.cmml">
              −
             </mo>
             <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.cmml">
              <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.3.cmml">
               η
              </mi>
              <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.2" lspace="0em" rspace="0em" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.2.cmml">
               ​
              </mo>
              <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.4" mathvariant="normal" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.4.cmml">
               H
              </mi>
              <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.2a" lspace="0em" rspace="0em" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.2.cmml">
               ​
              </mo>
              <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.2.cmml">
               <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.2.1.cmml">
                [
               </mo>
               <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.cmml">
                <msub id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.cmml">
                 <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.2.cmml">
                  π
                 </mi>
                 <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.3.cmml">
                  θ
                 </mi>
                </msub>
                <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.2.cmml">
                 ​
                </mo>
                <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.cmml">
                 <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.cmml">
                  (
                 </mo>
                 <mrow id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.cmml">
                  <msub id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.cmml">
                   <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.2.cmml">
                    a
                   </mi>
                   <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.3.cmml">
                    t
                   </mi>
                  </msub>
                  <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.cmml">
                   ∣
                  </mo>
                  <msub id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.cmml">
                   <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.2" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.2.cmml">
                    s
                   </mi>
                   <mi id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.3.cmml">
                    t
                   </mi>
                  </msub>
                 </mrow>
                 <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.3" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.2.1.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E13Xa.2.1.1.m1.6.6.1.2" lspace="0em" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E13Xa.2.1.1.m1.6b">
           <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1">
            <eq id="S4.E13Xa.2.1.1.m1.6.6.1.1.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.3">
            </eq>
            <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.4.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.4">
             <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.6.6.1.1.4.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.4">
              subscript
             </csymbol>
             <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.4.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.4.2">
              ℒ
             </ci>
             <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.4.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.4.3">
              𝜋
             </ci>
            </apply>
            <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2">
             <minus id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.3">
             </minus>
             <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1">
              <minus id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1">
              </minus>
              <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1">
               <times id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.2">
               </times>
               <apply id="S4.E13Xa.2.1.1.m1.5.5.cmml" xref="S4.E13Xa.2.1.1.m1.5.5">
                <divide id="S4.E13Xa.2.1.1.m1.5.5.6.cmml" xref="S4.E13Xa.2.1.1.m1.5.5">
                </divide>
                <apply id="S4.E13Xa.2.1.1.m1.2.2.2.3.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2">
                 <ci id="S4.E13Xa.2.1.1.m1.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.1.1.1.1">
                  sg
                 </ci>
                 <apply id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1">
                  <minus id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.2">
                  </minus>
                  <apply id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3">
                   <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3">
                    subscript
                   </csymbol>
                   <ci id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.2">
                    𝑅
                   </ci>
                   <ci id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.3.3">
                    𝑡
                   </ci>
                  </apply>
                  <apply id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1">
                   <times id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.2">
                   </times>
                   <ci id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.3">
                    𝑉
                   </ci>
                   <apply id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1">
                    <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1">
                     subscript
                    </csymbol>
                    <ci id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.2">
                     𝑠
                    </ci>
                    <ci id="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E13Xa.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.3">
                     𝑡
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                </apply>
                <apply id="S4.E13Xa.2.1.1.m1.5.5.5.4.cmml" xref="S4.E13Xa.2.1.1.m1.5.5.5.5">
                 <max id="S4.E13Xa.2.1.1.m1.3.3.3.1.cmml" xref="S4.E13Xa.2.1.1.m1.3.3.3.1">
                 </max>
                 <cn id="S4.E13Xa.2.1.1.m1.4.4.4.2.cmml" type="integer" xref="S4.E13Xa.2.1.1.m1.4.4.4.2">
                  1
                 </cn>
                 <ci id="S4.E13Xa.2.1.1.m1.5.5.5.3.cmml" xref="S4.E13Xa.2.1.1.m1.5.5.5.3">
                  𝑆
                 </ci>
                </apply>
               </apply>
               <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3">
                <log id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.1">
                </log>
                <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2">
                 <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2">
                  subscript
                 </csymbol>
                 <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.2">
                  𝜋
                 </ci>
                 <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.3.2.3">
                  𝜃
                 </ci>
                </apply>
               </apply>
               <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1">
                <csymbol cd="latexml" id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.1">
                 conditional
                </csymbol>
                <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2">
                 <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2">
                  subscript
                 </csymbol>
                 <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.2">
                  𝑎
                 </ci>
                 <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.2.3">
                  𝑡
                 </ci>
                </apply>
                <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.2">
                  𝑠
                 </ci>
                 <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.1.1.1.1.1.1.3.3">
                  𝑡
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2">
              <times id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.2">
              </times>
              <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.3">
               𝜂
              </ci>
              <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.4.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.4">
               H
              </ci>
              <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1">
               <csymbol cd="latexml" id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.2.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.2">
                delimited-[]
               </csymbol>
               <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1">
                <times id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.2">
                </times>
                <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3">
                 <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.2">
                  𝜋
                 </ci>
                 <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.3">
                  𝜃
                 </ci>
                </apply>
                <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1">
                 <csymbol cd="latexml" id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1">
                  conditional
                 </csymbol>
                 <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2">
                  <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2">
                   subscript
                  </csymbol>
                  <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.2">
                   𝑎
                  </ci>
                  <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2.3">
                   𝑡
                  </ci>
                 </apply>
                 <apply id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3">
                  <csymbol cd="ambiguous" id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3">
                   subscript
                  </csymbol>
                  <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.2">
                   𝑠
                  </ci>
                  <ci id="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E13Xa.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3.3">
                   𝑡
                  </ci>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E13Xa.2.1.1.m1.6c">
           \displaystyle\mathcal{L}_{\pi}=-\frac{\operatorname{sg}\left(R_{t}-V(s_{t})\right)}{\max(1,S)}\log\pi_{\theta}\left(a_{t}\mid s_{t}\right)-\eta\mathrm{H}\left[\pi_{\theta}\left(a_{t}\mid s_{t}\right)\right].
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para" id="S4.SS3.p5">
    <p class="ltx_p" id="S4.SS3.p5.2">
     where
     <math alttext="S" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.1">
      <semantics id="S4.SS3.p5.1.m1.1a">
       <mi id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml">
        S
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b">
        <ci id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">
         𝑆
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">
        S
       </annotation>
      </semantics>
     </math>
     is the exponential moving average between the 5th and 95th percentile of
     <math alttext="R_{t}" class="ltx_Math" display="inline" id="S4.SS3.p5.2.m2.1">
      <semantics id="S4.SS3.p5.2.m2.1a">
       <msub id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml">
        <mi id="S4.SS3.p5.2.m2.1.1.2" xref="S4.SS3.p5.2.m2.1.1.2.cmml">
         R
        </mi>
        <mi id="S4.SS3.p5.2.m2.1.1.3" xref="S4.SS3.p5.2.m2.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b">
        <apply id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p5.2.m2.1.1.2.cmml" xref="S4.SS3.p5.2.m2.1.1.2">
          𝑅
         </ci>
         <ci id="S4.SS3.p5.2.m2.1.1.3.cmml" xref="S4.SS3.p5.2.m2.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">
        R_{t}
       </annotation>
      </semantics>
     </math>
     . We summarize the detailed pseudocode for DLLM in Appendix
     <a class="ltx_ref" href="#A2.SS2" title="B.2 Pseudo Code ‣ Appendix B Additional Details of DLLM ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       B.2
      </span>
     </a>
     .
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Experiments
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    The primary goal of our experiments is to substantiate the following claim: DLLM helps the agent by leveraging the guidance from the LLM during the dreaming process, thereby achieving improved performance in tasks. Specifically, our experiments test the following hypotheses:
   </p>
   <ul class="ltx_itemize" id="S5.I1">
    <li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S5.I1.i1.p1">
      <p class="ltx_p" id="S5.I1.i1.p1.1">
       <span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">
        (H1)
       </span>
       Through proper prompting, DLLM can comprehend complex environments and generate accurate instructions to assist intelligent agents in multi-task environments.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S5.I1.i2.p1">
      <p class="ltx_p" id="S5.I1.i2.p1.1">
       <span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">
        (H2)
       </span>
       DLLM can leverage the generative capabilities of LLMs to obtain reasonable and novel hints, aiding agents in exploration within challenging environments.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S5.I1.i3.p1">
      <p class="ltx_p" id="S5.I1.i3.p1.1">
       <span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">
        (H3)
       </span>
       DLLM can significantly accelerate the exploration and training of agents in highly complex, large-scale, near-real environments that necessitate rational high-dimensional planning.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S5.I1.i4.p1">
      <p class="ltx_p" id="S5.I1.i4.p1.1">
       <span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">
        (H4)
       </span>
       DLLM can be more powerful when leveraging stronger LLMs or receiving additional language information.
      </p>
     </div>
    </li>
   </ul>
  </div>
  <div class="ltx_para" id="S5.p2">
   <p class="ltx_p" id="S5.p2.1">
    <span class="ltx_text ltx_font_bold" id="S5.p2.1.1">
     Baselines.
    </span>
    Since we include natural language information in our experiments, we consider employing ELLM
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib13" title="">
      13
     </a>
     ]
    </cite>
    and Dynalang
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib31" title="">
      31
     </a>
     ]
    </cite>
    as baselines.
    <span class="ltx_note ltx_role_footnote" id="footnote1">
     <sup class="ltx_note_mark">
      1
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        1
       </sup>
       <span class="ltx_tag ltx_tag_note">
        1
       </span>
       For ELLM and Dynalang, we utilize their official implementations for experimentation. For ELLM, we prompt the LLM and obtain goals following the same procedure as in our method. All language information, including the goals obtained from the LLMs, is encoded into sentence embeddings to feed Dynalang.
      </span>
     </span>
    </span>
    We also compare against other recent strong baseline algorithms that do not utilize natural language in each environment.
   </p>
  </div>
  <div class="ltx_para" id="S5.p3">
   <p class="ltx_p" id="S5.p3.1">
    <span class="ltx_text ltx_font_bold" id="S5.p3.1.1">
     Environments.
    </span>
    We conduct experiments on three environments: HomeGrid
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib31" title="">
      31
     </a>
     ]
    </cite>
    , Crafter
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib19" title="">
      19
     </a>
     ]
    </cite>
    , and Minecraft based on MineRL
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib17" title="">
      17
     </a>
     ]
    </cite>
    . These environments span first-person to third-person perspectives, 2D or 3D views, and various types and levels of task complexity.
   </p>
  </div>
  <div class="ltx_para" id="S5.p4">
   <p class="ltx_p" id="S5.p4.1">
    <span class="ltx_text ltx_font_bold" id="S5.p4.1.1">
     Captioner and Language Encodings.
    </span>
    Within each environment, we deploy an observation captioner and a transition captioner to caption observations and transitions, respectively. Transition captions are stored in the replay buffer for the agent’s predictive learning, while observation captions provide pertinent information for LLM. For language encoding, we employ SentenceBert
    <em class="ltx_emph ltx_font_italic" id="S5.p4.1.2">
     all-MiniLM-L6-v2
    </em>
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib58" title="">
      58
     </a>
     ]
    </cite>
    to convert all natural language inputs into embeddings.
   </p>
  </div>
  <div class="ltx_para" id="S5.p5">
   <p class="ltx_p" id="S5.p5.1">
    <span class="ltx_text ltx_font_bold" id="S5.p5.1.1">
     The Quality of Generated Goals.
    </span>
    To measure the quality of goals generated by LLMs during online interaction in the environment, we selected the following metrics: novelty, correctness, context sensitivity, and common-sense sensitivity. See the detailed explanations and experiments in Appendix
    <a class="ltx_ref" href="#A4" title="Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
     <span class="ltx_text ltx_ref_tag">
      D
     </span>
    </a>
    .
   </p>
  </div>
  <div class="ltx_para" id="S5.p6">
   <p class="ltx_p" id="S5.p6.1">
    <span class="ltx_text ltx_font_bold" id="S5.p6.1.1">
     Cache.
    </span>
    As each query to the LLM consists of an object-receptacle combination, we implement a cache for each experiment to efficiently reuse queries, thereby reducing both time and monetary cost.
   </p>
  </div>
  <section class="ltx_subsection" id="S5.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.1
    </span>
    HomeGrid
   </h3>
   <div class="ltx_para" id="S5.SS1.p1">
    <p class="ltx_p" id="S5.SS1.p1.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">
      Environment description.
     </span>
     HomeGrid is a multi-task reinforcement learning environment structured as a grid world, where agents get partial pixel observations and language hints (e.g., the descriptions of tasks). We reduce the map size to 10
     <math alttext="\times" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1">
      <semantics id="S5.SS1.p1.1.m1.1a">
       <mo id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">
        ×
       </mo>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b">
        <times id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">
        </times>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">
        \times
       </annotation>
      </semantics>
     </math>
     10 to expedite the overall training of the agent and incorporate icon signals to indicate actions for opening bins. For each step, we have the captioners to caption the observation and transition. The other components of the environment remain unchanged. More details can be seen in Appendix
     <a class="ltx_ref" href="#A1.SS1.SSS1" title="A.1.1 Details of Environmental Adjustments ‣ A.1 HomeGrid ‣ Appendix A Environment Details ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       A.1.1
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S5.SS1.p2">
    <p class="ltx_p" id="S5.SS1.p2.1">
     To support our claims, we design various settings where the environment provides different levels of information along with distinct language hints for each, as outlined in Table
     <a class="ltx_ref" href="#S5.T1" title="Table 1 ‣ 5.1 HomeGrid ‣ 5 Experiments ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , to help address hypothesis
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">
      H4
     </span>
     .
    </p>
   </div>
   <figure class="ltx_table" id="S5.T1">
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="S5.T1.2.1.1" style="font-size:90%;">
       Table 1
      </span>
      :
     </span>
     <span class="ltx_text" id="S5.T1.3.2" style="font-size:90%;">
      Description of different environment settings
     </span>
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.4">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S5.T1.4.1.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T1.4.1.1.1">
        <span class="ltx_text ltx_font_bold" id="S5.T1.4.1.1.1.1">
         Setting
        </span>
       </th>
       <th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S5.T1.4.1.1.2">
        <span class="ltx_inline-block ltx_align_top" id="S5.T1.4.1.1.2.1">
         <span class="ltx_p" id="S5.T1.4.1.1.2.1.1" style="width:335.7pt;">
          <span class="ltx_text ltx_font_bold" id="S5.T1.4.1.1.2.1.1.1">
           Description
          </span>
         </span>
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T1.4.2.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.4.2.1.1">
        Standard
       </th>
       <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T1.4.2.1.2">
        <span class="ltx_inline-block ltx_align_top" id="S5.T1.4.2.1.2.1">
         <span class="ltx_p" id="S5.T1.4.2.1.2.1.1" style="width:335.7pt;">
          The environment provides task descriptions in natural language form.
         </span>
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.4.3.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.4.3.2.1">
        Key info
       </th>
       <td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T1.4.3.2.2">
        <span class="ltx_inline-block ltx_align_top" id="S5.T1.4.3.2.2.1">
         <span class="ltx_p" id="S5.T1.4.3.2.2.1.1" style="width:335.7pt;">
          The environment additionally provides task-relevant objects’ location and status information.
         </span>
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.4.4.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.4.4.3.1">
        Full info
       </th>
       <td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T1.4.4.3.2">
        <span class="ltx_inline-block ltx_align_top" id="S5.T1.4.4.3.2.1">
         <span class="ltx_p" id="S5.T1.4.4.3.2.1.1" style="width:335.7pt;">
          The environment additionally provides the location and status information of all objects on the map. For bins, the correct opening actions will also be instructed.
         </span>
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.4.5.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T1.4.5.4.1">
        Oracle
       </th>
       <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T1.4.5.4.2">
        <span class="ltx_inline-block ltx_align_top" id="S5.T1.4.5.4.2.1">
         <span class="ltx_p" id="S5.T1.4.5.4.2.1.1" style="width:335.7pt;">
          The agent will always receive accurate instructions.
         </span>
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para" id="S5.SS1.p3">
    <p class="ltx_p" id="S5.SS1.p3.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">
      Query prompts, LLM choices, and Goals Generated.
     </span>
     Each query prompt consists of the caption of the agent’s current observation and a request for the LLM to generate a goal for each of the two types: “where to go” and “what to do”, respectively. For full prompts and examples, please see Appendix
     <a class="ltx_ref" href="#A1.SS1.SSS2" title="A.1.2 Full Prompt Details ‣ A.1 HomeGrid ‣ Appendix A Environment Details ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       A.1.2
      </span>
     </a>
     . We select GPT-4 as the base LLM for all experiments in HomeGrid. Queries to the GPT are made every ten steps. We test the quality of the goals generated in the Appendix
     <a class="ltx_ref" href="#A4.SS1" title="D.1 HomeGrid ‣ Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       D.1
      </span>
     </a>
     .
    </p>
   </div>
   <figure class="ltx_figure ltx_align_floatright" id="S5.F2">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="S5.F2.g1" src="/html/2406.07381/assets/x1.png" width="253"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S5.F2.2.1.1" style="font-size:90%;">
       Figure 2
      </span>
      :
     </span>
     <span class="ltx_text" id="S5.F2.3.2" style="font-size:90%;">
      HomeGrid experiments results. Curves averaged over 5 seeds with shading representing one-eighth of the standard deviation.
     </span>
    </figcaption>
   </figure>
   <div class="ltx_para" id="S5.SS1.p4">
    <p class="ltx_p" id="S5.SS1.p4.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">
      Performance.
     </span>
     The overall results are depicted in Figure
     <a class="ltx_ref" href="#S5.F2" title="Figure 2 ‣ 5.1 HomeGrid ‣ 5 Experiments ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . The baseline algorithm ELLM fails in HomeGrid, likely because it struggles to comprehend the sentence embeddings required to describe the task. Our method outperforms baseline algorithms utilizing the same information in the standard setting, showing strong evidence for
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.2">
      H1
     </span>
     and
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.3">
      H3
     </span>
     . Moreover, in the Key info, Full info, and Oracle settings, DLLM demonstrates enhanced performance with increasing information. In the overall context of reduced error prompts in the Full info, DLLM consistently demonstrates a more pronounced advantage throughout the training period. The results of the Full info and Oracle settings show no significant difference. These findings support hypothesis
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.4">
      H4
     </span>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.2
    </span>
    Crafter
   </h3>
   <figure class="ltx_figure" id="S5.F4.sf1">
   </figure>
   <div class="ltx_para" id="S5.SS2.p1">
    <p class="ltx_p" id="S5.SS2.p1.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">
      Environment description.
     </span>
     The Crafter environment is a grid world that features top-down graphics and discrete action space. Crafter is designed similarly to a 2D Minecraft, featuring a
procedurally generated, partially observable world where players can collect or craft a variety of artifacts. In Crafter, the player’s goal is to unlock the entire achievement tree, which consists of 22 achievements. As the map is designed with entities capable of harming the player (e.g., zombies, skeletons), the player must also create weapons or place barriers to ensure survival.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS2.p2">
    <p class="ltx_p" id="S5.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">
      Extra baselines.
     </span>
     We compared three additional types of baselines that do not utilize language information: (1) LLM-based solutions: SPRING
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib61" title="">
       61
      </a>
      ]
     </cite>
     , Reflexion
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib48" title="">
       48
      </a>
      ]
     </cite>
     , ReAct
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib65" title="">
       65
      </a>
      ]
     </cite>
     , standalone GPT-4 (step-by-step instructions), (2) model-based RL baseline: DreamerV3
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib23" title="">
       23
      </a>
      ]
     </cite>
     , (3) model-free methods: Achievement Distillation
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib38" title="">
       38
      </a>
      ]
     </cite>
     , PPO
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib47" title="">
       47
      </a>
      ]
     </cite>
     , Rainbow
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib26" title="">
       26
      </a>
      ]
     </cite>
     . We also add human experts
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib19" title="">
       19
      </a>
      ]
     </cite>
     and random policy as additional references.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS2.p3">
    <p class="ltx_p" id="S5.SS2.p3.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">
      Query prompts, LLM choices, and Goals Generated.
     </span>
     Each query prompt contains the caption of the agent’s current observation description and a request to have the LLM generate five goals. In this portion, we conduct evaluations using two popular LLMs, GPT-3.5 and GPT-4. Through these assessments, we explore whether a more robust LLM contributes to enhanced agent performance, addressing hypothesis
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.2">
      H4
     </span>
     . Queries to the GPT are made every ten steps. We test the quality of the goals generated in the Appendix
     <a class="ltx_ref" href="#A4.SS2" title="D.2 Crafter ‣ Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       D.2
      </span>
     </a>
     .
    </p>
   </div>
   <figure class="ltx_table ltx_align_floatright" id="S5.T2">
    <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.39" style="width:433.6pt;height:617pt;vertical-align:-0.0pt;">
     <span class="ltx_transformed_inner" style="transform:translate(84.0pt,-119.5pt) scale(1.63227818549395,1.63227818549395) ;">
      <table class="ltx_tabular ltx_align_middle" id="S5.T2.39.39">
       <tbody class="ltx_tbody">
        <tr class="ltx_tr" id="S5.T2.39.39.40.1">
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.39.39.40.1.1">
          Method
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.39.39.40.1.2">
          Score
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.39.39.40.1.3">
          Reward
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.39.39.40.1.4">
          Steps
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.2.2.2">
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.2.3">
          DLLM (w/ GPT-4)
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1">
          <span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1.1">
           38.1
           <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.1.1.1.1.1.m1.1">
            <semantics id="S5.T2.1.1.1.1.1.m1.1a">
             <mo id="S5.T2.1.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.1.m1.1.1.cmml">
              ±
             </mo>
             <annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.1.m1.1b">
              <csymbol cd="latexml" id="S5.T2.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1">
               plus-or-minus
              </csymbol>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.1.m1.1c">
              \pm
             </annotation>
            </semantics>
           </math>
          </span>
          1.2
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.2.2">
          15.4
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.2.2.2.2.m1.1">
           <semantics id="S5.T2.2.2.2.2.m1.1a">
            <mo id="S5.T2.2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.2.2.2.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.1
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.2.2.2.4">
          5M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.4.4.4">
         <td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.3">
          DLLM (w/ GPT-3.5)
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.3.3.3.1">
          <span class="ltx_text ltx_font_bold" id="S5.T2.3.3.3.1.1">
           37.6
           <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.3.3.3.1.1.m1.1">
            <semantics id="S5.T2.3.3.3.1.1.m1.1a">
             <mo id="S5.T2.3.3.3.1.1.m1.1.1" xref="S5.T2.3.3.3.1.1.m1.1.1.cmml">
              ±
             </mo>
             <annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.1.1.m1.1b">
              <csymbol cd="latexml" id="S5.T2.3.3.3.1.1.m1.1.1.cmml" xref="S5.T2.3.3.3.1.1.m1.1.1">
               plus-or-minus
              </csymbol>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S5.T2.3.3.3.1.1.m1.1c">
              \pm
             </annotation>
            </semantics>
           </math>
          </span>
          1.6
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.2">
          14.5
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.4.4.4.2.m1.1">
           <semantics id="S5.T2.4.4.4.2.m1.1a">
            <mo id="S5.T2.4.4.4.2.m1.1.1" xref="S5.T2.4.4.4.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.4.4.4.2.m1.1.1.cmml" xref="S5.T2.4.4.4.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.4.4.4.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.5
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.4.4.4.4">
          5M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.6.6.6">
         <td class="ltx_td ltx_align_center" id="S5.T2.6.6.6.3">
          AdaRefiner (w/ GPT-4)
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.5.5.5.1">
          28.2
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.5.5.5.1.m1.1">
           <semantics id="S5.T2.5.5.5.1.m1.1a">
            <mo id="S5.T2.5.5.5.1.m1.1.1" xref="S5.T2.5.5.5.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.5.5.5.1.m1.1.1.cmml" xref="S5.T2.5.5.5.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.5.5.5.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.8
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.6.6.6.2">
          12.9
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.6.6.6.2.m1.1">
           <semantics id="S5.T2.6.6.6.2.m1.1a">
            <mo id="S5.T2.6.6.6.2.m1.1.1" xref="S5.T2.6.6.6.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.6.6.6.2.m1.1.1.cmml" xref="S5.T2.6.6.6.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.6.6.6.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.2
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.6.6.6.4">
          5M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.8.8.8">
         <td class="ltx_td ltx_align_center" id="S5.T2.8.8.8.3">
          AdaRefiner (w/ GPT-3.5)
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.7.7.7.1">
          23.4
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.7.7.7.1.m1.1">
           <semantics id="S5.T2.7.7.7.1.m1.1a">
            <mo id="S5.T2.7.7.7.1.m1.1.1" xref="S5.T2.7.7.7.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.7.7.7.1.m1.1.1.cmml" xref="S5.T2.7.7.7.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.7.7.7.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          2.2
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.8.8.8.2">
          11.8
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.8.8.8.2.m1.1">
           <semantics id="S5.T2.8.8.8.2.m1.1a">
            <mo id="S5.T2.8.8.8.2.m1.1.1" xref="S5.T2.8.8.8.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.8.8.8.2.m1.1.1.cmml" xref="S5.T2.8.8.8.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.8.8.8.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.7
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.8.8.8.4">
          5M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.9.9.9">
         <td class="ltx_td ltx_align_center" id="S5.T2.9.9.9.2">
          ELLM
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.9.9.9.3">
          -
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.9.9.9.1">
          6.0
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.9.9.9.1.m1.1">
           <semantics id="S5.T2.9.9.9.1.m1.1a">
            <mo id="S5.T2.9.9.9.1.m1.1.1" xref="S5.T2.9.9.9.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.9.9.9.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.9.9.9.1.m1.1.1.cmml" xref="S5.T2.9.9.9.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.9.9.9.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          0.4
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.9.9.9.4">
          5M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.11.11.11">
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.11.11.11.3">
          DLLM (w/ GPT-4)
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.10.10.1">
          <span class="ltx_text ltx_font_bold" id="S5.T2.10.10.10.1.1">
           26.4
           <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.10.10.10.1.1.m1.1">
            <semantics id="S5.T2.10.10.10.1.1.m1.1a">
             <mo id="S5.T2.10.10.10.1.1.m1.1.1" xref="S5.T2.10.10.10.1.1.m1.1.1.cmml">
              ±
             </mo>
             <annotation-xml encoding="MathML-Content" id="S5.T2.10.10.10.1.1.m1.1b">
              <csymbol cd="latexml" id="S5.T2.10.10.10.1.1.m1.1.1.cmml" xref="S5.T2.10.10.10.1.1.m1.1.1">
               plus-or-minus
              </csymbol>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S5.T2.10.10.10.1.1.m1.1c">
              \pm
             </annotation>
            </semantics>
           </math>
          </span>
          1.3
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.11.11.11.2">
          12.4
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.11.11.11.2.m1.1">
           <semantics id="S5.T2.11.11.11.2.m1.1a">
            <mo id="S5.T2.11.11.11.2.m1.1.1" xref="S5.T2.11.11.11.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.11.11.11.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.11.11.11.2.m1.1.1.cmml" xref="S5.T2.11.11.11.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.11.11.11.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.3
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.11.11.11.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.13.13.13">
         <td class="ltx_td ltx_align_center" id="S5.T2.13.13.13.3">
          DLLM (w/ GPT-3.5)
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.12.12.12.1">
          <span class="ltx_text ltx_font_bold" id="S5.T2.12.12.12.1.1">
           24.4
           <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.12.12.12.1.1.m1.1">
            <semantics id="S5.T2.12.12.12.1.1.m1.1a">
             <mo id="S5.T2.12.12.12.1.1.m1.1.1" xref="S5.T2.12.12.12.1.1.m1.1.1.cmml">
              ±
             </mo>
             <annotation-xml encoding="MathML-Content" id="S5.T2.12.12.12.1.1.m1.1b">
              <csymbol cd="latexml" id="S5.T2.12.12.12.1.1.m1.1.1.cmml" xref="S5.T2.12.12.12.1.1.m1.1.1">
               plus-or-minus
              </csymbol>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S5.T2.12.12.12.1.1.m1.1c">
              \pm
             </annotation>
            </semantics>
           </math>
          </span>
          1.8
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.13.13.13.2">
          12.2
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.13.13.13.2.m1.1">
           <semantics id="S5.T2.13.13.13.2.m1.1a">
            <mo id="S5.T2.13.13.13.2.m1.1.1" xref="S5.T2.13.13.13.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.13.13.13.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.13.13.13.2.m1.1.1.cmml" xref="S5.T2.13.13.13.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.13.13.13.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.6
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.13.13.13.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.15.15.15">
         <td class="ltx_td ltx_align_center" id="S5.T2.15.15.15.3">
          Achievement Distillation
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.14.14.14.1">
          21.8
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.14.14.14.1.m1.1">
           <semantics id="S5.T2.14.14.14.1.m1.1a">
            <mo id="S5.T2.14.14.14.1.m1.1.1" xref="S5.T2.14.14.14.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.14.14.14.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.14.14.14.1.m1.1.1.cmml" xref="S5.T2.14.14.14.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.14.14.14.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.4
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.15.15.15.2">
          12.6
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.15.15.15.2.m1.1">
           <semantics id="S5.T2.15.15.15.2.m1.1a">
            <mo id="S5.T2.15.15.15.2.m1.1.1" xref="S5.T2.15.15.15.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.15.15.15.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.15.15.15.2.m1.1.1.cmml" xref="S5.T2.15.15.15.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.15.15.15.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          0.3
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.15.15.15.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.17.17.17">
         <td class="ltx_td ltx_align_center" id="S5.T2.17.17.17.3">
          Dynalang
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.16.16.16.1">
          16.4
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.16.16.16.1.m1.1">
           <semantics id="S5.T2.16.16.16.1.m1.1a">
            <mo id="S5.T2.16.16.16.1.m1.1.1" xref="S5.T2.16.16.16.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.16.16.16.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.16.16.16.1.m1.1.1.cmml" xref="S5.T2.16.16.16.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.16.16.16.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.7
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.17.17.17.2">
          11.5
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.17.17.17.2.m1.1">
           <semantics id="S5.T2.17.17.17.2.m1.1a">
            <mo id="S5.T2.17.17.17.2.m1.1.1" xref="S5.T2.17.17.17.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.17.17.17.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.17.17.17.2.m1.1.1.cmml" xref="S5.T2.17.17.17.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.17.17.17.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.4
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.17.17.17.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.19.19.19">
         <td class="ltx_td ltx_align_center" id="S5.T2.19.19.19.3">
          AdaRefiner (w/ GPT-4)
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.18.18.18.1">
          15.8
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.18.18.18.1.m1.1">
           <semantics id="S5.T2.18.18.18.1.m1.1a">
            <mo id="S5.T2.18.18.18.1.m1.1.1" xref="S5.T2.18.18.18.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.18.18.18.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.18.18.18.1.m1.1.1.cmml" xref="S5.T2.18.18.18.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.18.18.18.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.4
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.19.19.19.2">
          12.3
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.19.19.19.2.m1.1">
           <semantics id="S5.T2.19.19.19.2.m1.1a">
            <mo id="S5.T2.19.19.19.2.m1.1.1" xref="S5.T2.19.19.19.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.19.19.19.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.19.19.19.2.m1.1.1.cmml" xref="S5.T2.19.19.19.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.19.19.19.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.3
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.19.19.19.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.21.21.21">
         <td class="ltx_td ltx_align_center" id="S5.T2.21.21.21.3">
          PPO (ResNet)
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.20.20.20.1">
          15.6
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.20.20.20.1.m1.1">
           <semantics id="S5.T2.20.20.20.1.m1.1a">
            <mo id="S5.T2.20.20.20.1.m1.1.1" xref="S5.T2.20.20.20.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.20.20.20.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.20.20.20.1.m1.1.1.cmml" xref="S5.T2.20.20.20.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.20.20.20.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.6
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.21.21.21.2">
          10.3
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.21.21.21.2.m1.1">
           <semantics id="S5.T2.21.21.21.2.m1.1a">
            <mo id="S5.T2.21.21.21.2.m1.1.1" xref="S5.T2.21.21.21.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.21.21.21.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.21.21.21.2.m1.1.1.cmml" xref="S5.T2.21.21.21.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.21.21.21.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          0.5
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.21.21.21.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.23.23.23">
         <td class="ltx_td ltx_align_center" id="S5.T2.23.23.23.3">
          DreamerV3
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.22.22.22.1">
          14.5
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.22.22.22.1.m1.1">
           <semantics id="S5.T2.22.22.22.1.m1.1a">
            <mo id="S5.T2.22.22.22.1.m1.1.1" xref="S5.T2.22.22.22.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.22.22.22.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.22.22.22.1.m1.1.1.cmml" xref="S5.T2.22.22.22.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.22.22.22.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.6
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.23.23.23.2">
          11.7
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.23.23.23.2.m1.1">
           <semantics id="S5.T2.23.23.23.2.m1.1a">
            <mo id="S5.T2.23.23.23.2.m1.1.1" xref="S5.T2.23.23.23.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.23.23.23.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.23.23.23.2.m1.1.1.cmml" xref="S5.T2.23.23.23.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.23.23.23.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.9
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.23.23.23.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.25.25.25">
         <td class="ltx_td ltx_align_center" id="S5.T2.25.25.25.3">
          PPO
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.24.24.24.1">
          4.6
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.24.24.24.1.m1.1">
           <semantics id="S5.T2.24.24.24.1.m1.1a">
            <mo id="S5.T2.24.24.24.1.m1.1.1" xref="S5.T2.24.24.24.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.24.24.24.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.24.24.24.1.m1.1.1.cmml" xref="S5.T2.24.24.24.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.24.24.24.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          0.3
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.25.25.25.2">
          4.2
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.25.25.25.2.m1.1">
           <semantics id="S5.T2.25.25.25.2.m1.1a">
            <mo id="S5.T2.25.25.25.2.m1.1.1" xref="S5.T2.25.25.25.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.25.25.25.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.25.25.25.2.m1.1.1.cmml" xref="S5.T2.25.25.25.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.25.25.25.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.2
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.25.25.25.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.27.27.27">
         <td class="ltx_td ltx_align_center" id="S5.T2.27.27.27.3">
          Rainbow
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.26.26.26.1">
          4.3
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.26.26.26.1.m1.1">
           <semantics id="S5.T2.26.26.26.1.m1.1a">
            <mo id="S5.T2.26.26.26.1.m1.1.1" xref="S5.T2.26.26.26.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.26.26.26.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.26.26.26.1.m1.1.1.cmml" xref="S5.T2.26.26.26.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.26.26.26.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          0.2
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.27.27.27.2">
          5.0
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.27.27.27.2.m1.1">
           <semantics id="S5.T2.27.27.27.2.m1.1a">
            <mo id="S5.T2.27.27.27.2.m1.1.1" xref="S5.T2.27.27.27.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.27.27.27.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.27.27.27.2.m1.1.1.cmml" xref="S5.T2.27.27.27.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.27.27.27.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.3
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.27.27.27.4">
          1M
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.29.29.29">
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.29.29.29.3">
          SPRING (w/ GPT-4)
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.28.28.28.1">
          27.3
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.28.28.28.1.m1.1">
           <semantics id="S5.T2.28.28.28.1.m1.1a">
            <mo id="S5.T2.28.28.28.1.m1.1.1" xref="S5.T2.28.28.28.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.28.28.28.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.28.28.28.1.m1.1.1.cmml" xref="S5.T2.28.28.28.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.28.28.28.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.2
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.29.29.29.2">
          12.3
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.29.29.29.2.m1.1">
           <semantics id="S5.T2.29.29.29.2.m1.1a">
            <mo id="S5.T2.29.29.29.2.m1.1.1" xref="S5.T2.29.29.29.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.29.29.29.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.29.29.29.2.m1.1.1.cmml" xref="S5.T2.29.29.29.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.29.29.29.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          0.7
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.29.29.29.4">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.31.31.31">
         <td class="ltx_td ltx_align_center" id="S5.T2.31.31.31.3">
          Reflexion (w/ GPT-4)
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.30.30.30.1">
          12.8
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.30.30.30.1.m1.1">
           <semantics id="S5.T2.30.30.30.1.m1.1a">
            <mo id="S5.T2.30.30.30.1.m1.1.1" xref="S5.T2.30.30.30.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.30.30.30.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.30.30.30.1.m1.1.1.cmml" xref="S5.T2.30.30.30.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.30.30.30.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.0
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.31.31.31.2">
          10.3
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.31.31.31.2.m1.1">
           <semantics id="S5.T2.31.31.31.2.m1.1a">
            <mo id="S5.T2.31.31.31.2.m1.1.1" xref="S5.T2.31.31.31.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.31.31.31.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.31.31.31.2.m1.1.1.cmml" xref="S5.T2.31.31.31.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.31.31.31.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.3
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.31.31.31.4">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.33.33.33">
         <td class="ltx_td ltx_align_center" id="S5.T2.33.33.33.3">
          ReAct (w/ GPT-4)
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.32.32.32.1">
          8.3
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.32.32.32.1.m1.1">
           <semantics id="S5.T2.32.32.32.1.m1.1a">
            <mo id="S5.T2.32.32.32.1.m1.1.1" xref="S5.T2.32.32.32.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.32.32.32.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.32.32.32.1.m1.1.1.cmml" xref="S5.T2.32.32.32.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.32.32.32.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.2
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.33.33.33.2">
          7.4
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.33.33.33.2.m1.1">
           <semantics id="S5.T2.33.33.33.2.m1.1a">
            <mo id="S5.T2.33.33.33.2.m1.1.1" xref="S5.T2.33.33.33.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.33.33.33.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.33.33.33.2.m1.1.1.cmml" xref="S5.T2.33.33.33.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.33.33.33.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          0.9
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.33.33.33.4">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.35.35.35">
         <td class="ltx_td ltx_align_center" id="S5.T2.35.35.35.3">
          Vanilla GPT-4
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.34.34.34.1">
          3.4
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.34.34.34.1.m1.1">
           <semantics id="S5.T2.34.34.34.1.m1.1a">
            <mo id="S5.T2.34.34.34.1.m1.1.1" xref="S5.T2.34.34.34.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.34.34.34.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.34.34.34.1.m1.1.1.cmml" xref="S5.T2.34.34.34.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.34.34.34.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.5
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.35.35.35.2">
          2.5
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.35.35.35.2.m1.1">
           <semantics id="S5.T2.35.35.35.2.m1.1a">
            <mo id="S5.T2.35.35.35.2.m1.1.1" xref="S5.T2.35.35.35.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.35.35.35.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.35.35.35.2.m1.1.1.cmml" xref="S5.T2.35.35.35.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.35.35.35.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.6
         </td>
         <td class="ltx_td ltx_align_center" id="S5.T2.35.35.35.4">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.37.37.37">
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.37.37.37.3">
          Human Experts
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.36.36.36.1">
          50.5
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.36.36.36.1.m1.1">
           <semantics id="S5.T2.36.36.36.1.m1.1a">
            <mo id="S5.T2.36.36.36.1.m1.1.1" xref="S5.T2.36.36.36.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.36.36.36.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.36.36.36.1.m1.1.1.cmml" xref="S5.T2.36.36.36.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.36.36.36.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          6.8
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.37.37.37.2">
          14.3
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.37.37.37.2.m1.1">
           <semantics id="S5.T2.37.37.37.2.m1.1a">
            <mo id="S5.T2.37.37.37.2.m1.1.1" xref="S5.T2.37.37.37.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.37.37.37.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.37.37.37.2.m1.1.1.cmml" xref="S5.T2.37.37.37.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.37.37.37.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          2.3
         </td>
         <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.37.37.37.4">
          -
         </td>
        </tr>
        <tr class="ltx_tr" id="S5.T2.39.39.39">
         <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.39.39.39.3">
          Random
         </td>
         <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.38.38.38.1">
          1.6
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.38.38.38.1.m1.1">
           <semantics id="S5.T2.38.38.38.1.m1.1a">
            <mo id="S5.T2.38.38.38.1.m1.1.1" xref="S5.T2.38.38.38.1.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.38.38.38.1.m1.1b">
             <csymbol cd="latexml" id="S5.T2.38.38.38.1.m1.1.1.cmml" xref="S5.T2.38.38.38.1.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.38.38.38.1.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          0.0
         </td>
         <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.39.39.39.2">
          2.1
          <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.39.39.39.2.m1.1">
           <semantics id="S5.T2.39.39.39.2.m1.1a">
            <mo id="S5.T2.39.39.39.2.m1.1.1" xref="S5.T2.39.39.39.2.m1.1.1.cmml">
             ±
            </mo>
            <annotation-xml encoding="MathML-Content" id="S5.T2.39.39.39.2.m1.1b">
             <csymbol cd="latexml" id="S5.T2.39.39.39.2.m1.1.1.cmml" xref="S5.T2.39.39.39.2.m1.1.1">
              plus-or-minus
             </csymbol>
            </annotation-xml>
            <annotation encoding="application/x-tex" id="S5.T2.39.39.39.2.m1.1c">
             \pm
            </annotation>
           </semantics>
          </math>
          1.3
         </td>
         <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.39.39.39.4">
          -
         </td>
        </tr>
       </tbody>
      </table>
     </span>
    </div>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_table">
      <span class="ltx_text" id="S5.T2.41.1.1" style="font-size:90%;">
       Table 2
      </span>
      :
     </span>
     <span class="ltx_text" id="S5.T2.42.2" style="font-size:90%;">
      The results indicate that DLLM with GPT-4 and GPT-3.5 outperforms baseline algorithms, achieving superiority at 1M and 5M training steps.
     </span>
    </figcaption>
   </figure>
   <div class="ltx_para" id="S5.SS2.p4">
    <p class="ltx_p" id="S5.SS2.p4.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.1">
      Performance.
     </span>
     DLLM outperforms all baseline algorithms at 1M and 5M steps. As shown in Figure
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:crafter_sub_spr
     </span>
     and Table
     <a class="ltx_ref" href="#S5.T2" title="Table 2 ‣ 5.2 Crafter ‣ 5 Experiments ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     , DLLM exhibits a significant advantage compared to baselines. Figure
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:crafter_sub_successes
     </span>
     shows that DLLM is good at medium to high difficulty tasks like “make stone pickaxe/sword” and “collect iron” while maintaining stable performance in less challenging tasks. When the steps reach 5M, the performance of DLLM significantly surpasses the language-based algorithm SPRING. These findings show strong evidence for hypotheses
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.2">
      H2
     </span>
     and
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.3">
      H3
     </span>
     . In all experiments of Crafter, DLLM (w/ GPT-4) demonstrates a more robust performance than DLLM (w/ GPT-3.5), indicating that DLLM can indeed achieve better performance with the assistance of a more powerful LLM. This finding aligns with the results presented in Appendix
     <a class="ltx_ref" href="#A4.SS2" title="D.2 Crafter ‣ Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       D.2
      </span>
     </a>
     , where GPT-4 consistently identifies exploration-beneficial goals, thus confirming hypothesis
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.4">
      H4
     </span>
     . In Crafter, We also include ablation studies on the scale of intrinsic rewards in Appendix
     <a class="ltx_ref" href="#A5.SS2" title="E.2 Ablations of the Intrinsic Reward Scale in Crafter ‣ Appendix E Additional Ablation Studies ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       E.2
      </span>
     </a>
     , not decreasing intrinsic rewards in Appendix
     <a class="ltx_ref" href="#A5.SS3" title="E.3 Decrease or not to decrease intrinsic rewards in Crafter ‣ Appendix E Additional Ablation Studies ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       E.3
      </span>
     </a>
     , utilizing random goals in Appendix
     <a class="ltx_ref" href="#A5.SS4" title="E.4 Random Goals in Crafter ‣ Appendix E Additional Ablation Studies ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       E.4
      </span>
     </a>
     , and allowing repeated intrinsic rewards in Appendix
     <a class="ltx_ref" href="#A5.SS5" title="E.5 Allow Repetition in Crafter ‣ Appendix E Additional Ablation Studies ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       E.5
      </span>
     </a>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.3
    </span>
    Minecraft
   </h3>
   <div class="ltx_para" id="S5.SS3.p1">
    <p class="ltx_p" id="S5.SS3.p1.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS3.p1.1.1">
      Environment description.
     </span>
     Several RL environments, e.g., MineRL
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib17" title="">
       17
      </a>
      ]
     </cite>
     , have been constructed based on Minecraft, a popular video game that features a randomly initialized open world with diverse biomes. Minecraft Diamond is a challenging task based on MineRL, with the primary objective of acquiring a diamond. Progressing through the game involves the player collecting resources to craft new items, ensuring his survival, unlocking the technological progress tree, and ultimately achieving the goal of obtaining a diamond within 36000 steps. In Minecraft Diamond, we also have captioners to provide the captions of the observation and transition in natural language form at each step. The environment settings completely mirror those outlined in DreamerV3
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib23" title="">
       23
      </a>
      ]
     </cite>
     , which includes awarding a +1 reward for each milestone achieved, which encompasses collecting or crafting a log, plank, stick, crafting table, wooden pickaxe, cobblestone, stone pickaxe, iron ore, furnace, iron ingot, iron pickaxe, and diamond.
    </p>
   </div>
   <figure class="ltx_table" id="S5.T3">
    <div class="ltx_flex_figure ltx_flex_table">
     <div class="ltx_flex_cell ltx_flex_size_2">
      <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_bottom" id="S5.T3.8" style="width:130.1pt;">
       <div class="ltx_inline-block ltx_transformed_outer" id="S5.T3.8.8" style="width:433.6pt;height:452.7pt;vertical-align:-0.0pt;">
        <span class="ltx_transformed_inner" style="transform:translate(139.2pt,-145.3pt) scale(2.79428892768081,2.79428892768081) ;">
         <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.8.8.8">
          <thead class="ltx_thead">
           <tr class="ltx_tr" id="S5.T3.8.8.8.9.1">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T3.8.8.8.9.1.1">
             Method
            </th>
            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.8.8.8.9.1.2">
             Reward
            </th>
           </tr>
          </thead>
          <tbody class="ltx_tbody">
           <tr class="ltx_tr" id="S5.T3.1.1.1.1">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.1.1.1.2">
             DLLM (w/ GPT-4)
            </th>
            <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.1.1">
             <span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.1.1.1">
              10.0
              <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.1.1.1.1.1.1.m1.1">
               <semantics id="S5.T3.1.1.1.1.1.1.m1.1a">
                <mo id="S5.T3.1.1.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.1.1.m1.1.1.cmml">
                 ±
                </mo>
                <annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.1.1.m1.1b">
                 <csymbol cd="latexml" id="S5.T3.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.1.1.m1.1.1">
                  plus-or-minus
                 </csymbol>
                </annotation-xml>
                <annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.1.1.m1.1c">
                 \pm
                </annotation>
               </semantics>
              </math>
             </span>
             0.3
            </td>
           </tr>
           <tr class="ltx_tr" id="S5.T3.2.2.2.2">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.2.2.2.2.2">
             DreamerV3
            </th>
            <td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.2.1">
             9.1
             <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.2.2.2.2.1.m1.1">
              <semantics id="S5.T3.2.2.2.2.1.m1.1a">
               <mo id="S5.T3.2.2.2.2.1.m1.1.1" xref="S5.T3.2.2.2.2.1.m1.1.1.cmml">
                ±
               </mo>
               <annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.2.1.m1.1b">
                <csymbol cd="latexml" id="S5.T3.2.2.2.2.1.m1.1.1.cmml" xref="S5.T3.2.2.2.2.1.m1.1.1">
                 plus-or-minus
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="S5.T3.2.2.2.2.1.m1.1c">
                \pm
               </annotation>
              </semantics>
             </math>
             0.3
            </td>
           </tr>
           <tr class="ltx_tr" id="S5.T3.3.3.3.3">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.3.3.3.3.2">
             Dynalang
            </th>
            <td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.3.1">
             8.9
             <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.3.3.3.3.1.m1.1">
              <semantics id="S5.T3.3.3.3.3.1.m1.1a">
               <mo id="S5.T3.3.3.3.3.1.m1.1.1" xref="S5.T3.3.3.3.3.1.m1.1.1.cmml">
                ±
               </mo>
               <annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.3.1.m1.1b">
                <csymbol cd="latexml" id="S5.T3.3.3.3.3.1.m1.1.1.cmml" xref="S5.T3.3.3.3.3.1.m1.1.1">
                 plus-or-minus
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="S5.T3.3.3.3.3.1.m1.1c">
                \pm
               </annotation>
              </semantics>
             </math>
             0.4
            </td>
           </tr>
           <tr class="ltx_tr" id="S5.T3.4.4.4.4">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.4.4.4.4.2">
             IMPALA
            </th>
            <td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.4.1">
             7.4
             <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.4.4.4.4.1.m1.1">
              <semantics id="S5.T3.4.4.4.4.1.m1.1a">
               <mo id="S5.T3.4.4.4.4.1.m1.1.1" xref="S5.T3.4.4.4.4.1.m1.1.1.cmml">
                ±
               </mo>
               <annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.4.1.m1.1b">
                <csymbol cd="latexml" id="S5.T3.4.4.4.4.1.m1.1.1.cmml" xref="S5.T3.4.4.4.4.1.m1.1.1">
                 plus-or-minus
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="S5.T3.4.4.4.4.1.m1.1c">
                \pm
               </annotation>
              </semantics>
             </math>
             0.2
            </td>
           </tr>
           <tr class="ltx_tr" id="S5.T3.5.5.5.5">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.5.5.5.5.2">
             Rainbow
            </th>
            <td class="ltx_td ltx_align_center" id="S5.T3.5.5.5.5.1">
             6.3
             <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.5.5.5.5.1.m1.1">
              <semantics id="S5.T3.5.5.5.5.1.m1.1a">
               <mo id="S5.T3.5.5.5.5.1.m1.1.1" xref="S5.T3.5.5.5.5.1.m1.1.1.cmml">
                ±
               </mo>
               <annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.5.1.m1.1b">
                <csymbol cd="latexml" id="S5.T3.5.5.5.5.1.m1.1.1.cmml" xref="S5.T3.5.5.5.5.1.m1.1.1">
                 plus-or-minus
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="S5.T3.5.5.5.5.1.m1.1c">
                \pm
               </annotation>
              </semantics>
             </math>
             0.3
            </td>
           </tr>
           <tr class="ltx_tr" id="S5.T3.6.6.6.6">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.6.6.6.6.2">
             R2D2
            </th>
            <td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.6.1">
             5.0
             <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.6.6.6.6.1.m1.1">
              <semantics id="S5.T3.6.6.6.6.1.m1.1a">
               <mo id="S5.T3.6.6.6.6.1.m1.1.1" xref="S5.T3.6.6.6.6.1.m1.1.1.cmml">
                ±
               </mo>
               <annotation-xml encoding="MathML-Content" id="S5.T3.6.6.6.6.1.m1.1b">
                <csymbol cd="latexml" id="S5.T3.6.6.6.6.1.m1.1.1.cmml" xref="S5.T3.6.6.6.6.1.m1.1.1">
                 plus-or-minus
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="S5.T3.6.6.6.6.1.m1.1c">
                \pm
               </annotation>
              </semantics>
             </math>
             0.5
            </td>
           </tr>
           <tr class="ltx_tr" id="S5.T3.7.7.7.7">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.7.7.7.7.2">
             PPO
            </th>
            <td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.7.1">
             4.1
             <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.7.7.7.7.1.m1.1">
              <semantics id="S5.T3.7.7.7.7.1.m1.1a">
               <mo id="S5.T3.7.7.7.7.1.m1.1.1" xref="S5.T3.7.7.7.7.1.m1.1.1.cmml">
                ±
               </mo>
               <annotation-xml encoding="MathML-Content" id="S5.T3.7.7.7.7.1.m1.1b">
                <csymbol cd="latexml" id="S5.T3.7.7.7.7.1.m1.1.1.cmml" xref="S5.T3.7.7.7.7.1.m1.1.1">
                 plus-or-minus
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="S5.T3.7.7.7.7.1.m1.1c">
                \pm
               </annotation>
              </semantics>
             </math>
             0.2
            </td>
           </tr>
           <tr class="ltx_tr" id="S5.T3.8.8.8.8">
            <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="S5.T3.8.8.8.8.2">
             ELLM
            </th>
            <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.8.8.8.8.1">
             0.3
             <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T3.8.8.8.8.1.m1.1">
              <semantics id="S5.T3.8.8.8.8.1.m1.1a">
               <mo id="S5.T3.8.8.8.8.1.m1.1.1" xref="S5.T3.8.8.8.8.1.m1.1.1.cmml">
                ±
               </mo>
               <annotation-xml encoding="MathML-Content" id="S5.T3.8.8.8.8.1.m1.1b">
                <csymbol cd="latexml" id="S5.T3.8.8.8.8.1.m1.1.1.cmml" xref="S5.T3.8.8.8.8.1.m1.1.1">
                 plus-or-minus
                </csymbol>
               </annotation-xml>
               <annotation encoding="application/x-tex" id="S5.T3.8.8.8.8.1.m1.1c">
                \pm
               </annotation>
              </semantics>
             </math>
             0.0
            </td>
           </tr>
          </tbody>
         </table>
        </span>
       </div>
       <figcaption class="ltx_caption ltx_centering">
        <span class="ltx_tag ltx_tag_figure">
         <span class="ltx_text" id="S5.T3.8.9.1.1" style="font-size:90%;">
          Table 3
         </span>
         :
        </span>
        <span class="ltx_text" id="S5.T3.8.10.2" style="font-size:90%;">
         Comparison between DLLM (w/ GPT-4) and baselines in Minecraft at 100M. DLLM (w/ GPT-4) surpasses all baselines, including those that also involve LLMs or natural languages in policy learning.
        </span>
       </figcaption>
      </figure>
     </div>
     <div class="ltx_flex_cell ltx_flex_size_2">
      <figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_bottom" id="S5.F4" style="width:281.9pt;">
       <img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="226" id="S5.T3.9.g1" src="/html/2406.07381/assets/x2.png" width="415"/>
       <br class="ltx_break ltx_break"/>
       <figcaption class="ltx_caption">
        <span class="ltx_tag ltx_tag_figure">
         <span class="ltx_text" id="S5.F4.2.1.1" style="font-size:90%;">
          Figure 4
         </span>
         :
        </span>
        <span class="ltx_text" id="S5.F4.3.2" style="font-size:90%;">
         The episode returns in Minecraft Diamond. The curves indicate that DLLM enjoys a consistent advantage throughout the entire learning process, thanks to its utilization of an LLM for exploration and training. All algorithms undergo experiments using 5 different seeds.
        </span>
       </figcaption>
      </figure>
     </div>
    </div>
   </figure>
   <div class="ltx_para" id="S5.SS3.p2">
    <p class="ltx_p" id="S5.SS3.p2.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS3.p2.1.1">
      Extra baselines.
     </span>
     To fully compare DLLM with current popular methods from model-based algorithms to model-free algorithms on Minecraft, we include DreamerV3
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib23" title="">
       23
      </a>
      ]
     </cite>
     , IMPALA
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib15" title="">
       15
      </a>
      ]
     </cite>
     , R2D2
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib33" title="">
       33
      </a>
      ]
     </cite>
     , Rainbow
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib26" title="">
       26
      </a>
      ]
     </cite>
     and PPO
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib47" title="">
       47
      </a>
      ]
     </cite>
     as our extra baselines, along with ELLM
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib13" title="">
       13
      </a>
      ]
     </cite>
     and Dynalang
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib31" title="">
       31
      </a>
      ]
     </cite>
     .
    </p>
   </div>
   <div class="ltx_para" id="S5.SS3.p3">
    <p class="ltx_p" id="S5.SS3.p3.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS3.p3.1.1">
      Query prompts, LLM choices, and Goals Generated.
     </span>
     During each query to the GPT, we provide it with information about the player’s status, inventory, and equipment and request the GPT to generate five goals. We choose GPT-4 as our language model for the DLLM experiment. Please see Appendix
     <a class="ltx_ref" href="#A1.SS3.SSS1" title="A.3.1 Full Prompt Details ‣ A.3 Minecraft ‣ Appendix A Environment Details ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       A.3.1
      </span>
     </a>
     for specific details. We make a query to the GPT every twenty steps. We also test the quality of the generated goals in Appendix
     <a class="ltx_ref" href="#A4.SS3" title="D.3 Minecraft ‣ Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       D.3
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S5.SS3.p4">
    <p class="ltx_p" id="S5.SS3.p4.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS3.p4.1.1">
      Performance.
     </span>
     In Figure
     <a class="ltx_ref" href="#S5.F4" title="Figure 4 ‣ Table 3 ‣ 5.3 Minecraft ‣ 5 Experiments ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     and Table
     <a class="ltx_ref" href="#S5.T3" title="Table 3 ‣ 5.3 Minecraft ‣ 5 Experiments ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     , we present empirical results in Minecraft Diamond. Baseline algorithm ELLM struggles in this complex environment, possibly due to high task complexity. DLLM demonstrates higher data efficiency in the early training stages, facilitating quicker acquisition of basic skills within fewer training steps compared to baseline methods. DLLM also maintains a significant advantage in later stages, indicating its ability to still derive reasonable and practical guidance from the LLM during the post-exploration training process. These findings underscore the effectiveness of DLLM in guiding exploration and training in highly complex environments with the support of the LLM, providing compelling evidence for hypothesis
     <span class="ltx_text ltx_font_bold" id="S5.SS3.p4.1.2">
      H3
     </span>
     .
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Conclusion and Discussion
  </h2>
  <div class="ltx_para" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    We propose DLLM, a multi-modal model-based RL method that leverages the guidance from LLMs to provide hints (goals) and generate intrinsic rewards in model rollouts. DLLM outperforms recent strong baselines in multiple challenging tasks with sparse rewards. Our experiments demonstrate that DLLM effectively utilizes language information from the environment and LLMs, and enhances its performance by improving language information quality.
   </p>
  </div>
  <div class="ltx_para" id="S6.p2">
   <p class="ltx_p" id="S6.p2.1">
    <span class="ltx_text ltx_font_bold" id="S6.p2.1.1">
     Limitations.
    </span>
    DLLM relies on the guidance provided by a large language model, making it susceptible to the inherent instability of LLM outputs. This introduces a potential risk to the stability of DLLM’s performance, even though the prompts used in our experiments contributed to relatively stable model outputs. Unreasonable goals may encourage the agent to make erroneous attempts, and correcting such misguided behavior may take time. We expect to address these challenges in future work.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [1]
    </span>
    <span class="ltx_bibblock">
     Joshua Achiam and Shankar Sastry.
    </span>
    <span class="ltx_bibblock">
     Surprise-based intrinsic motivation for deep reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">
      arXiv preprint arXiv:1703.01732
     </span>
     , 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [2]
    </span>
    <span class="ltx_bibblock">
     Hui Bai, Ran Cheng, and Yaochu Jin.
    </span>
    <span class="ltx_bibblock">
     Evolutionary reinforcement learning: A survey.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">
      Intelligent Computing
     </span>
     , 2, January 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [3]
    </span>
    <span class="ltx_bibblock">
     Adrien Baranes and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Active learning of inverse models with intrinsically motivated goal
exploration in robots.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">
      Robotics and Autonomous Systems
     </span>
     , 61(1):49–73, 2013.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [4]
    </span>
    <span class="ltx_bibblock">
     Marc G Bellemare, Will Dabney, and Rémi Munos.
    </span>
    <span class="ltx_bibblock">
     A distributional perspective on reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">
      International conference on machine learning
     </span>
     , pages
449–458. PMLR, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [5]
    </span>
    <span class="ltx_bibblock">
     Yuri Burda, Harrison Edwards, Deepak Pathak, Amos Storkey, Trevor Darrell, and
Alexei A Efros.
    </span>
    <span class="ltx_bibblock">
     Large-scale study of curiosity-driven learning.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">
      Seventh International Conference on Learning
Representations
     </span>
     , pages 1–17, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [6]
    </span>
    <span class="ltx_bibblock">
     Yuri Burda, Harrison Edwards, Amos Storkey, and Oleg Klimov.
    </span>
    <span class="ltx_bibblock">
     Exploration by random network distillation.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">
      International Conference on Learning Representations
     </span>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [7]
    </span>
    <span class="ltx_bibblock">
     Yuri Burda, Harrison Edwards, Amos Storkey, and Oleg Klimov.
    </span>
    <span class="ltx_bibblock">
     Exploration by random network distillation.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">
      Seventh International Conference on Learning
Representations
     </span>
     , pages 1–17, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [8]
    </span>
    <span class="ltx_bibblock">
     Thomas Carta, Clément Romac, Thomas Wolf, Sylvain Lamprier, Olivier Sigaud,
and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Grounding large language models in interactive environments with
online reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">
      arXiv preprint arXiv:2302.02662
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [9]
    </span>
    <span class="ltx_bibblock">
     Kristy Choi, Chris Cundy, Sanjari Srivastava, and Stefano Ermon.
    </span>
    <span class="ltx_bibblock">
     Lmpriors: Pre-trained language models as task-specific priors.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">
      NeurIPS 2022 Foundation Models for Decision Making Workshop
     </span>
     ,
2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [10]
    </span>
    <span class="ltx_bibblock">
     Cédric Colas, Tristan Karch, Olivier Sigaud, and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Autotelic agents with intrinsically motivated goal-conditioned
reinforcement learning: a short survey.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">
      Journal of Artificial Intelligence Research
     </span>
     , 74:1159–1199,
2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [11]
    </span>
    <span class="ltx_bibblock">
     Cédric Colas, Olivier Sigaud, and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Gep-pg: Decoupling exploration and exploitation in deep reinforcement
learning algorithms.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">
      International conference on machine learning
     </span>
     , pages
1039–1048. PMLR, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [12]
    </span>
    <span class="ltx_bibblock">
     Rati Devidze, Parameswaran Kamalaruban, and Adish Singla.
    </span>
    <span class="ltx_bibblock">
     Exploration-guided reward shaping for reinforcement learning under
sparse rewards.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">
      Advances in Neural Information Processing Systems
     </span>
     ,
35:5829–5842, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [13]
    </span>
    <span class="ltx_bibblock">
     Yuqing Du, Olivia Watkins, Zihan Wang, Cédric Colas, Trevor Darrell, Pieter
Abbeel, Abhishek Gupta, and Jacob Andreas.
    </span>
    <span class="ltx_bibblock">
     Guiding pretraining in reinforcement learning with large language
models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">
      arXiv preprint arXiv:2302.06692
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [14]
    </span>
    <span class="ltx_bibblock">
     Rachit Dubey, Pulkit Agrawal, Deepak Pathak, Tom Griffiths, and Alexei Efros.
    </span>
    <span class="ltx_bibblock">
     Investigating human priors for playing video games.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">
      International Conference on Machine Learning
     </span>
     , pages
1349–1357. PMLR, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [15]
    </span>
    <span class="ltx_bibblock">
     Lasse Espeholt, Hubert Soyer, Remi Munos, Karen Simonyan, Vlad Mnih, Tom Ward,
Yotam Doron, Vlad Firoiu, Tim Harley, Iain Dunning, et al.
    </span>
    <span class="ltx_bibblock">
     Impala: Scalable distributed deep-rl with importance weighted
actor-learner architectures.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">
      International conference on machine learning
     </span>
     , pages
1407–1416. PMLR, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [16]
    </span>
    <span class="ltx_bibblock">
     Tharindu Fernando, Simon Denman, Sridha Sridharan, and Clinton Fookes.
    </span>
    <span class="ltx_bibblock">
     Learning temporal strategic relationships using generative
adversarial imitation learning, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [17]
    </span>
    <span class="ltx_bibblock">
     William H Guss, Brandon Houghton, Nicholay Topin, Phillip Wang, Cayden Codel,
Manuela Veloso, and Ruslan Salakhutdinov.
    </span>
    <span class="ltx_bibblock">
     Minerl: A large-scale dataset of minecraft demonstrations.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">
      arXiv preprint arXiv:1907.13440
     </span>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [18]
    </span>
    <span class="ltx_bibblock">
     David Ha and Jürgen Schmidhuber.
    </span>
    <span class="ltx_bibblock">
     World models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">
      arXiv preprint arXiv:1803.10122
     </span>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [19]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner.
    </span>
    <span class="ltx_bibblock">
     Benchmarking the spectrum of agent capabilities, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [20]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Timothy Lillicrap, Jimmy Ba, and Mohammad Norouzi.
    </span>
    <span class="ltx_bibblock">
     Dream to control: Learning behaviors by latent imagination.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">
      arXiv preprint arXiv:1912.01603
     </span>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [21]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Timothy Lillicrap, Ian Fischer, Ruben Villegas, David Ha,
Honglak Lee, and James Davidson.
    </span>
    <span class="ltx_bibblock">
     Learning latent dynamics for planning from pixels.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">
      International conference on machine learning
     </span>
     , pages
2555–2565. PMLR, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [22]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Timothy Lillicrap, Mohammad Norouzi, and Jimmy Ba.
    </span>
    <span class="ltx_bibblock">
     Mastering atari with discrete world models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">
      arXiv preprint arXiv:2010.02193
     </span>
     , 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [23]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Jurgis Pasukonis, Jimmy Ba, and Timothy Lillicrap.
    </span>
    <span class="ltx_bibblock">
     Mastering diverse domains through world models, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [24]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Jurgis Pasukonis, Jimmy Ba, and Timothy Lillicrap.
    </span>
    <span class="ltx_bibblock">
     Mastering diverse domains through world models, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [25]
    </span>
    <span class="ltx_bibblock">
     Nicklas Hansen, Xiaolong Wang, and Hao Su.
    </span>
    <span class="ltx_bibblock">
     Temporal difference learning for model predictive control.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">
      arXiv preprint arXiv:2203.04955
     </span>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [26]
    </span>
    <span class="ltx_bibblock">
     Matteo Hessel, Joseph Modayil, Hado van Hasselt, Tom Schaul, Georg Ostrovski,
Will Dabney, Dan Horgan, Bilal Piot, Mohammad Azar, and David Silver.
    </span>
    <span class="ltx_bibblock">
     Rainbow: Combining improvements in deep reinforcement learning, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [27]
    </span>
    <span class="ltx_bibblock">
     David Janz, Jiri Hron, Przemysław Mazur, Katja Hofmann, José Miguel
Hernández-Lobato, and Sebastian Tschiatschek.
    </span>
    <span class="ltx_bibblock">
     Successor uncertainties: exploration and uncertainty in temporal
difference learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">
      Advances in Neural Information Processing Systems
     </span>
     , 32, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [28]
    </span>
    <span class="ltx_bibblock">
     Yash Kant, Arun Ramachandran, Sriram Yenamandra, Igor Gilitschenski, Dhruv
Batra, Andrew Szot, and Harsh Agrawal.
    </span>
    <span class="ltx_bibblock">
     Housekeep: Tidying virtual households using commonsense reasoning.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">
      European Conference on Computer Vision
     </span>
     , pages 355–373.
Springer, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [29]
    </span>
    <span class="ltx_bibblock">
     Durk P Kingma, Tim Salimans, Rafal Jozefowicz, Xi Chen, Ilya Sutskever, and Max
Welling.
    </span>
    <span class="ltx_bibblock">
     Improved variational inference with inverse autoregressive flow.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">
      Advances in neural information processing systems
     </span>
     , 29, 2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [30]
    </span>
    <span class="ltx_bibblock">
     Pawel Ladosz, Lilian Weng, Minwoo Kim, and Hyondong Oh.
    </span>
    <span class="ltx_bibblock">
     Exploration in deep reinforcement learning: A survey.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">
      Information Fusion
     </span>
     , 85:1–22, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [31]
    </span>
    <span class="ltx_bibblock">
     Jessy Lin, Yuqing Du, Olivia Watkins, Danijar Hafner, Pieter Abbeel, Dan Klein,
and Anca Dragan.
    </span>
    <span class="ltx_bibblock">
     Learning to model the world with language.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">
      arXiv preprint arXiv:2308.01399
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [32]
    </span>
    <span class="ltx_bibblock">
     Cam Linke, Nadia M Ady, Martha White, Thomas Degris, and Adam White.
    </span>
    <span class="ltx_bibblock">
     Adapting behavior via intrinsic reward: A survey and empirical study.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">
      Journal of artificial intelligence research
     </span>
     , 69:1287–1332,
2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [33]
    </span>
    <span class="ltx_bibblock">
     Qinghua Liu, Tim A Rand, Savitha Kalidas, Fenghe Du, Hyun-Eui Kim, Dean P
Smith, and Xiaodong Wang.
    </span>
    <span class="ltx_bibblock">
     R2d2, a bridge between the initiation and effector steps of the
drosophila rnai pathway.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">
      Science
     </span>
     , 301(5641):1921–1925, 2003.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [34]
    </span>
    <span class="ltx_bibblock">
     Kendall Lowrey, Aravind Rajeswaran, Sham Kakade, Emanuel Todorov, and Igor
Mordatch.
    </span>
    <span class="ltx_bibblock">
     Plan online, learn offline: Efficient learning and exploration via
model-based control.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">
      arXiv preprint arXiv:1811.01848
     </span>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [35]
    </span>
    <span class="ltx_bibblock">
     Ziyan Luo, Yijie Zhang, and Zhaoyue Wang.
    </span>
    <span class="ltx_bibblock">
     Does hierarchical reinforcement learning outperform standard
reinforcement learning in goal-oriented environments?
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">
      NeurIPS 2023 Workshop on Goal-Conditioned Reinforcement
Learning
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [36]
    </span>
    <span class="ltx_bibblock">
     TM Moerland, DJ Broekens, and CM Jonker.
    </span>
    <span class="ltx_bibblock">
     Efficient exploration with double uncertain value networks.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">
      Deep Reinforcement Learning Symposium, NIPS 2017
     </span>
     , 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [37]
    </span>
    <span class="ltx_bibblock">
     Ron Mokady, Amir Hertz, and Amit H Bermano.
    </span>
    <span class="ltx_bibblock">
     Clipcap: Clip prefix for image captioning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">
      arXiv preprint arXiv:2111.09734
     </span>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [38]
    </span>
    <span class="ltx_bibblock">
     Seungyong Moon, Junyoung Yeom, Bumsoo Park, and Hyun Oh Song.
    </span>
    <span class="ltx_bibblock">
     Discovering hierarchical achievements in reinforcement learning via
contrastive learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">
      Advances in Neural Information Processing Systems
     </span>
     , 36, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [39]
    </span>
    <span class="ltx_bibblock">
     Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela
Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John
Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda
Askell, Peter Welinder, Paul Christiano, Jan Leike, and Ryan Lowe.
    </span>
    <span class="ltx_bibblock">
     Training language models to follow instructions with human feedback,
2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [40]
    </span>
    <span class="ltx_bibblock">
     Deepak Pathak, Pulkit Agrawal, Alexei A Efros, and Trevor Darrell.
    </span>
    <span class="ltx_bibblock">
     Curiosity-driven exploration by self-supervised prediction.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">
      International conference on machine learning
     </span>
     , pages
2778–2787. PMLR, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [41]
    </span>
    <span class="ltx_bibblock">
     Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.
    </span>
    <span class="ltx_bibblock">
     Learning transferable visual models from natural language
supervision.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">
      International conference on machine learning
     </span>
     , pages
8748–8763. PMLR, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [42]
    </span>
    <span class="ltx_bibblock">
     Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya
Sutskever, et al.
    </span>
    <span class="ltx_bibblock">
     Language models are unsupervised multitask learners.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">
      OpenAI blog
     </span>
     , 1(8):9, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [43]
    </span>
    <span class="ltx_bibblock">
     Nils Reimers and Iryna Gurevych.
    </span>
    <span class="ltx_bibblock">
     Sentence-bert: Sentence embeddings using siamese bert-networks.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">
      arXiv preprint arXiv:1908.10084
     </span>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [44]
    </span>
    <span class="ltx_bibblock">
     Stuart Ian Reynolds.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">
      Reinforcement learning with exploration
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     PhD thesis, University of Birmingham, 2002.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [45]
    </span>
    <span class="ltx_bibblock">
     Martin Riedmiller, Roland Hafner, Thomas Lampe, Michael Neunert, Jonas Degrave,
Tom Wiele, Vlad Mnih, Nicolas Heess, and Jost Tobias Springenberg.
    </span>
    <span class="ltx_bibblock">
     Learning by playing solving sparse reward tasks from scratch.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">
      International conference on machine learning
     </span>
     , pages
4344–4353. PMLR, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [46]
    </span>
    <span class="ltx_bibblock">
     Julian Schrittwieser, Ioannis Antonoglou, Thomas Hubert, Karen Simonyan,
Laurent Sifre, Simon Schmitt, Arthur Guez, Edward Lockhart, Demis Hassabis,
Thore Graepel, et al.
    </span>
    <span class="ltx_bibblock">
     Mastering atari, go, chess and shogi by planning with a learned
model.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">
      Nature
     </span>
     , 588(7839):604–609, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [47]
    </span>
    <span class="ltx_bibblock">
     John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.
    </span>
    <span class="ltx_bibblock">
     Proximal policy optimization algorithms.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib47.1.1">
      arXiv preprint arXiv:1707.06347
     </span>
     , 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [48]
    </span>
    <span class="ltx_bibblock">
     Noah Shinn, Beck Labash, and Ashwin Gopinath.
    </span>
    <span class="ltx_bibblock">
     Reflexion: an autonomous agent with dynamic memory and
self-reflection.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">
      arXiv preprint arXiv:2303.11366
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [49]
    </span>
    <span class="ltx_bibblock">
     David Silver, Aja Huang, Chris J Maddison, Arthur Guez, Laurent Sifre, George
Van Den Driessche, Julian Schrittwieser, Ioannis Antonoglou, Veda
Panneershelvam, Marc Lanctot, et al.
    </span>
    <span class="ltx_bibblock">
     Mastering the game of go with deep neural networks and tree search.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib49.1.1">
      nature
     </span>
     , 529(7587):484–489, 2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [50]
    </span>
    <span class="ltx_bibblock">
     David Silver, Thomas Hubert, Julian Schrittwieser, Ioannis Antonoglou, Matthew
Lai, Arthur Guez, Marc Lanctot, Laurent Sifre, Dharshan Kumaran, Thore
Graepel, et al.
    </span>
    <span class="ltx_bibblock">
     A general reinforcement learning algorithm that masters chess, shogi,
and go through self-play.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib50.1.1">
      Science
     </span>
     , 362(6419):1140–1144, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [51]
    </span>
    <span class="ltx_bibblock">
     David Silver, Julian Schrittwieser, Karen Simonyan, Ioannis Antonoglou, Aja
Huang, Arthur Guez, Thomas Hubert, Lucas Baker, Matthew Lai, Adrian Bolton,
et al.
    </span>
    <span class="ltx_bibblock">
     Mastering the game of go without human knowledge.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib51.1.1">
      nature
     </span>
     , 550(7676):354–359, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [52]
    </span>
    <span class="ltx_bibblock">
     David Silver, Satinder Singh, Doina Precup, and Richard S Sutton.
    </span>
    <span class="ltx_bibblock">
     Reward is enough.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib52.1.1">
      Artificial Intelligence
     </span>
     , 299:103535, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [53]
    </span>
    <span class="ltx_bibblock">
     Bradly C Stadie, Sergey Levine, and Pieter Abbeel.
    </span>
    <span class="ltx_bibblock">
     Incentivizing exploration in reinforcement learning with deep
predictive models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib53.1.1">
      arXiv preprint arXiv:1507.00814
     </span>
     , 2015.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [54]
    </span>
    <span class="ltx_bibblock">
     Richard S Sutton and Andrew G Barto.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib54.1.1">
      Reinforcement learning: An introduction
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     MIT press, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [55]
    </span>
    <span class="ltx_bibblock">
     Teck-Hou Teng and Ah-Hwee Tan.
    </span>
    <span class="ltx_bibblock">
     Knowledge-based exploration for reinforcement learning in
self-organizing neural networks.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">
      2012 IEEE/WIC/ACM International Conferences on Web
Intelligence and Intelligent Agent Technology
     </span>
     , volume 2, pages 332–339.
IEEE, 2012.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib56">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [56]
    </span>
    <span class="ltx_bibblock">
     Alexander Trott, Stephan Zheng, Caiming Xiong, and Richard Socher.
    </span>
    <span class="ltx_bibblock">
     Keeping your distance: Solving sparse reward tasks using
self-balancing shaped rewards.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib56.1.1">
      Advances in Neural Information Processing Systems
     </span>
     , 32, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib57">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [57]
    </span>
    <span class="ltx_bibblock">
     Guanzhi Wang, Yuqi Xie, Yunfan Jiang, Ajay Mandlekar, Chaowei Xiao, Yuke Zhu,
Linxi Fan, and Anima Anandkumar.
    </span>
    <span class="ltx_bibblock">
     Voyager: An open-ended embodied agent with large language models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib57.1.1">
      arXiv preprint arXiv:2305.16291
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib58">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [58]
    </span>
    <span class="ltx_bibblock">
     Wenhui Wang, Furu Wei, Li Dong, Hangbo Bao, Nan Yang, and Ming Zhou.
    </span>
    <span class="ltx_bibblock">
     Minilm: Deep self-attention distillation for task-agnostic
compression of pre-trained transformers.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib58.1.1">
      Advances in Neural Information Processing Systems
     </span>
     ,
33:5776–5788, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib59">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [59]
    </span>
    <span class="ltx_bibblock">
     Xiyao Wang, Ruijie Zheng, Yanchao Sun, Ruonan Jia, Wichayaporn Wongkamjan,
Huazhe Xu, and Furong Huang.
    </span>
    <span class="ltx_bibblock">
     Coplanner: Plan to roll out conservatively but to explore
optimistically for model-based rl, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib60">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [60]
    </span>
    <span class="ltx_bibblock">
     Lisheng Wu and Ke Chen.
    </span>
    <span class="ltx_bibblock">
     Goal exploration augmentation via pre-trained skills for
sparse-reward long-horizon goal-conditioned reinforcement learning, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib61">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [61]
    </span>
    <span class="ltx_bibblock">
     Yue Wu, So Yeon Min, Shrimai Prabhumoye, Yonatan Bisk, Ruslan Salakhutdinov,
Amos Azaria, Tom Mitchell, and Yuanzhi Li.
    </span>
    <span class="ltx_bibblock">
     Spring: Gpt-4 out-performs rl algorithms by studying papers and
reasoning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib61.1.1">
      arXiv preprint arXiv:2305.15486
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib62">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [62]
    </span>
    <span class="ltx_bibblock">
     Tianbao Xie, Siheng Zhao, Chen Henry Wu, Yitao Liu, Qian Luo, Victor Zhong,
Yanchao Yang, and Tao Yu.
    </span>
    <span class="ltx_bibblock">
     Text2reward: Automated dense reward function generation for
reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib62.1.1">
      arXiv preprint arXiv:2309.11489
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib63">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [63]
    </span>
    <span class="ltx_bibblock">
     Kai Yang, Jian Tao, Jiafei Lyu, and Xiu Li.
    </span>
    <span class="ltx_bibblock">
     Exploration and anti-exploration with distributional random network
distillation.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib63.1.1">
      arXiv preprint arXiv:2401.09750
     </span>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib64">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [64]
    </span>
    <span class="ltx_bibblock">
     Tianpei Yang, Hongyao Tang, Chenjia Bai, Jinyi Liu, Jianye Hao, Zhaopeng Meng,
Peng Liu, and Zhen Wang.
    </span>
    <span class="ltx_bibblock">
     Exploration in deep reinforcement learning: a comprehensive survey.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib64.1.1">
      arXiv preprint arXiv:2109.06668
     </span>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib65">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [65]
    </span>
    <span class="ltx_bibblock">
     Shunyu Yao, Jeffrey Zhao, Dian Yu, Izhak Shafran, Karthik R Narasimhan, and
Yuan Cao.
    </span>
    <span class="ltx_bibblock">
     React: Synergizing reasoning and acting in language models.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="bib.bib65.1.1">
      NeurIPS 2022 Foundation Models for Decision Making Workshop
     </span>
     ,
2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib66">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [66]
    </span>
    <span class="ltx_bibblock">
     Jesse Zhang, Jiahui Zhang, Karl Pertsch, Ziyi Liu, Xiang Ren, Minsuk Chang,
Shao-Hua Sun, and Joseph J Lim.
    </span>
    <span class="ltx_bibblock">
     Bootstrap your own skills: Learning to solve new tasks with large
language model guidance.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib66.1.1">
      arXiv preprint arXiv:2310.10021
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib67">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [67]
    </span>
    <span class="ltx_bibblock">
     Jingwei Zhang, Niklas Wetzel, Nicolai Dorka, Joschka Boedecker, and Wolfram
Burgard.
    </span>
    <span class="ltx_bibblock">
     Scheduled intrinsic drive: A hierarchical take on intrinsically
motivated exploration.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib67.1.1">
      arXiv preprint arXiv:1903.07400
     </span>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib68">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [68]
    </span>
    <span class="ltx_bibblock">
     Tianjun Zhang, Paria Rashidinejad, Jiantao Jiao, Yuandong Tian, Joseph E
Gonzalez, and Stuart Russell.
    </span>
    <span class="ltx_bibblock">
     Made: Exploration via maximizing deviation from explored regions.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib68.1.1">
      Advances in Neural Information Processing Systems
     </span>
     ,
34:9663–9680, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib69">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [69]
    </span>
    <span class="ltx_bibblock">
     Wanpeng Zhang and Zongqing Lu.
    </span>
    <span class="ltx_bibblock">
     Adarefiner: Refining decisions of language models with adaptive
feedback, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib70">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [70]
    </span>
    <span class="ltx_bibblock">
     Zihao Zhou, Bin Hu, Pu Zhang, Chenyang Zhao, and Bin Liu.
    </span>
    <span class="ltx_bibblock">
     Large language model is a good policy teacher for training
reinforcement learning agents.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="bib.bib70.1.1">
      arXiv preprint arXiv:2311.13373
     </span>
     , 2023.
    </span>
   </li>
  </ul>
 </section>
 <section class="ltx_bibliography" id="biba">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="biba.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [1]
    </span>
    <span class="ltx_bibblock">
     Joshua Achiam and Shankar Sastry.
    </span>
    <span class="ltx_bibblock">
     Surprise-based intrinsic motivation for deep reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib1.1.1">
      arXiv preprint arXiv:1703.01732
     </span>
     , 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [2]
    </span>
    <span class="ltx_bibblock">
     Hui Bai, Ran Cheng, and Yaochu Jin.
    </span>
    <span class="ltx_bibblock">
     Evolutionary reinforcement learning: A survey.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib2.1.1">
      Intelligent Computing
     </span>
     , 2, January 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [3]
    </span>
    <span class="ltx_bibblock">
     Adrien Baranes and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Active learning of inverse models with intrinsically motivated goal
exploration in robots.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib3.1.1">
      Robotics and Autonomous Systems
     </span>
     , 61(1):49–73, 2013.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [4]
    </span>
    <span class="ltx_bibblock">
     Marc G Bellemare, Will Dabney, and Rémi Munos.
    </span>
    <span class="ltx_bibblock">
     A distributional perspective on reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib4.1.1">
      International conference on machine learning
     </span>
     , pages
449–458. PMLR, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [5]
    </span>
    <span class="ltx_bibblock">
     Yuri Burda, Harrison Edwards, Deepak Pathak, Amos Storkey, Trevor Darrell, and
Alexei A Efros.
    </span>
    <span class="ltx_bibblock">
     Large-scale study of curiosity-driven learning.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib5.1.1">
      Seventh International Conference on Learning
Representations
     </span>
     , pages 1–17, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [6]
    </span>
    <span class="ltx_bibblock">
     Yuri Burda, Harrison Edwards, Amos Storkey, and Oleg Klimov.
    </span>
    <span class="ltx_bibblock">
     Exploration by random network distillation.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib6.1.1">
      International Conference on Learning Representations
     </span>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [7]
    </span>
    <span class="ltx_bibblock">
     Yuri Burda, Harrison Edwards, Amos Storkey, and Oleg Klimov.
    </span>
    <span class="ltx_bibblock">
     Exploration by random network distillation.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib7.1.1">
      Seventh International Conference on Learning
Representations
     </span>
     , pages 1–17, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [8]
    </span>
    <span class="ltx_bibblock">
     Thomas Carta, Clément Romac, Thomas Wolf, Sylvain Lamprier, Olivier Sigaud,
and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Grounding large language models in interactive environments with
online reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib8.1.1">
      arXiv preprint arXiv:2302.02662
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [9]
    </span>
    <span class="ltx_bibblock">
     Kristy Choi, Chris Cundy, Sanjari Srivastava, and Stefano Ermon.
    </span>
    <span class="ltx_bibblock">
     Lmpriors: Pre-trained language models as task-specific priors.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib9.1.1">
      NeurIPS 2022 Foundation Models for Decision Making Workshop
     </span>
     ,
2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [10]
    </span>
    <span class="ltx_bibblock">
     Cédric Colas, Tristan Karch, Olivier Sigaud, and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Autotelic agents with intrinsically motivated goal-conditioned
reinforcement learning: a short survey.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib10.1.1">
      Journal of Artificial Intelligence Research
     </span>
     , 74:1159–1199,
2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [11]
    </span>
    <span class="ltx_bibblock">
     Cédric Colas, Olivier Sigaud, and Pierre-Yves Oudeyer.
    </span>
    <span class="ltx_bibblock">
     Gep-pg: Decoupling exploration and exploitation in deep reinforcement
learning algorithms.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib11.1.1">
      International conference on machine learning
     </span>
     , pages
1039–1048. PMLR, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [12]
    </span>
    <span class="ltx_bibblock">
     Rati Devidze, Parameswaran Kamalaruban, and Adish Singla.
    </span>
    <span class="ltx_bibblock">
     Exploration-guided reward shaping for reinforcement learning under
sparse rewards.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib12.1.1">
      Advances in Neural Information Processing Systems
     </span>
     ,
35:5829–5842, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [13]
    </span>
    <span class="ltx_bibblock">
     Yuqing Du, Olivia Watkins, Zihan Wang, Cédric Colas, Trevor Darrell, Pieter
Abbeel, Abhishek Gupta, and Jacob Andreas.
    </span>
    <span class="ltx_bibblock">
     Guiding pretraining in reinforcement learning with large language
models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib13.1.1">
      arXiv preprint arXiv:2302.06692
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [14]
    </span>
    <span class="ltx_bibblock">
     Rachit Dubey, Pulkit Agrawal, Deepak Pathak, Tom Griffiths, and Alexei Efros.
    </span>
    <span class="ltx_bibblock">
     Investigating human priors for playing video games.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib14.1.1">
      International Conference on Machine Learning
     </span>
     , pages
1349–1357. PMLR, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [15]
    </span>
    <span class="ltx_bibblock">
     Lasse Espeholt, Hubert Soyer, Remi Munos, Karen Simonyan, Vlad Mnih, Tom Ward,
Yotam Doron, Vlad Firoiu, Tim Harley, Iain Dunning, et al.
    </span>
    <span class="ltx_bibblock">
     Impala: Scalable distributed deep-rl with importance weighted
actor-learner architectures.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib15.1.1">
      International conference on machine learning
     </span>
     , pages
1407–1416. PMLR, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [16]
    </span>
    <span class="ltx_bibblock">
     Tharindu Fernando, Simon Denman, Sridha Sridharan, and Clinton Fookes.
    </span>
    <span class="ltx_bibblock">
     Learning temporal strategic relationships using generative
adversarial imitation learning, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [17]
    </span>
    <span class="ltx_bibblock">
     William H Guss, Brandon Houghton, Nicholay Topin, Phillip Wang, Cayden Codel,
Manuela Veloso, and Ruslan Salakhutdinov.
    </span>
    <span class="ltx_bibblock">
     Minerl: A large-scale dataset of minecraft demonstrations.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib17.1.1">
      arXiv preprint arXiv:1907.13440
     </span>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [18]
    </span>
    <span class="ltx_bibblock">
     David Ha and Jürgen Schmidhuber.
    </span>
    <span class="ltx_bibblock">
     World models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib18.1.1">
      arXiv preprint arXiv:1803.10122
     </span>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [19]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner.
    </span>
    <span class="ltx_bibblock">
     Benchmarking the spectrum of agent capabilities, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [20]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Timothy Lillicrap, Jimmy Ba, and Mohammad Norouzi.
    </span>
    <span class="ltx_bibblock">
     Dream to control: Learning behaviors by latent imagination.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib20.1.1">
      arXiv preprint arXiv:1912.01603
     </span>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [21]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Timothy Lillicrap, Ian Fischer, Ruben Villegas, David Ha,
Honglak Lee, and James Davidson.
    </span>
    <span class="ltx_bibblock">
     Learning latent dynamics for planning from pixels.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib21.1.1">
      International conference on machine learning
     </span>
     , pages
2555–2565. PMLR, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [22]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Timothy Lillicrap, Mohammad Norouzi, and Jimmy Ba.
    </span>
    <span class="ltx_bibblock">
     Mastering atari with discrete world models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib22.1.1">
      arXiv preprint arXiv:2010.02193
     </span>
     , 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [23]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Jurgis Pasukonis, Jimmy Ba, and Timothy Lillicrap.
    </span>
    <span class="ltx_bibblock">
     Mastering diverse domains through world models, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [24]
    </span>
    <span class="ltx_bibblock">
     Danijar Hafner, Jurgis Pasukonis, Jimmy Ba, and Timothy Lillicrap.
    </span>
    <span class="ltx_bibblock">
     Mastering diverse domains through world models, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [25]
    </span>
    <span class="ltx_bibblock">
     Nicklas Hansen, Xiaolong Wang, and Hao Su.
    </span>
    <span class="ltx_bibblock">
     Temporal difference learning for model predictive control.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib25.1.1">
      arXiv preprint arXiv:2203.04955
     </span>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [26]
    </span>
    <span class="ltx_bibblock">
     Matteo Hessel, Joseph Modayil, Hado van Hasselt, Tom Schaul, Georg Ostrovski,
Will Dabney, Dan Horgan, Bilal Piot, Mohammad Azar, and David Silver.
    </span>
    <span class="ltx_bibblock">
     Rainbow: Combining improvements in deep reinforcement learning, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [27]
    </span>
    <span class="ltx_bibblock">
     David Janz, Jiri Hron, Przemysław Mazur, Katja Hofmann, José Miguel
Hernández-Lobato, and Sebastian Tschiatschek.
    </span>
    <span class="ltx_bibblock">
     Successor uncertainties: exploration and uncertainty in temporal
difference learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib27.1.1">
      Advances in Neural Information Processing Systems
     </span>
     , 32, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [28]
    </span>
    <span class="ltx_bibblock">
     Yash Kant, Arun Ramachandran, Sriram Yenamandra, Igor Gilitschenski, Dhruv
Batra, Andrew Szot, and Harsh Agrawal.
    </span>
    <span class="ltx_bibblock">
     Housekeep: Tidying virtual households using commonsense reasoning.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib28.1.1">
      European Conference on Computer Vision
     </span>
     , pages 355–373.
Springer, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [29]
    </span>
    <span class="ltx_bibblock">
     Durk P Kingma, Tim Salimans, Rafal Jozefowicz, Xi Chen, Ilya Sutskever, and Max
Welling.
    </span>
    <span class="ltx_bibblock">
     Improved variational inference with inverse autoregressive flow.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib29.1.1">
      Advances in neural information processing systems
     </span>
     , 29, 2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [30]
    </span>
    <span class="ltx_bibblock">
     Pawel Ladosz, Lilian Weng, Minwoo Kim, and Hyondong Oh.
    </span>
    <span class="ltx_bibblock">
     Exploration in deep reinforcement learning: A survey.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib30.1.1">
      Information Fusion
     </span>
     , 85:1–22, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [31]
    </span>
    <span class="ltx_bibblock">
     Jessy Lin, Yuqing Du, Olivia Watkins, Danijar Hafner, Pieter Abbeel, Dan Klein,
and Anca Dragan.
    </span>
    <span class="ltx_bibblock">
     Learning to model the world with language.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib31.1.1">
      arXiv preprint arXiv:2308.01399
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [32]
    </span>
    <span class="ltx_bibblock">
     Cam Linke, Nadia M Ady, Martha White, Thomas Degris, and Adam White.
    </span>
    <span class="ltx_bibblock">
     Adapting behavior via intrinsic reward: A survey and empirical study.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib32.1.1">
      Journal of artificial intelligence research
     </span>
     , 69:1287–1332,
2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [33]
    </span>
    <span class="ltx_bibblock">
     Qinghua Liu, Tim A Rand, Savitha Kalidas, Fenghe Du, Hyun-Eui Kim, Dean P
Smith, and Xiaodong Wang.
    </span>
    <span class="ltx_bibblock">
     R2d2, a bridge between the initiation and effector steps of the
drosophila rnai pathway.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib33.1.1">
      Science
     </span>
     , 301(5641):1921–1925, 2003.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [34]
    </span>
    <span class="ltx_bibblock">
     Kendall Lowrey, Aravind Rajeswaran, Sham Kakade, Emanuel Todorov, and Igor
Mordatch.
    </span>
    <span class="ltx_bibblock">
     Plan online, learn offline: Efficient learning and exploration via
model-based control.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib34.1.1">
      arXiv preprint arXiv:1811.01848
     </span>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [35]
    </span>
    <span class="ltx_bibblock">
     Ziyan Luo, Yijie Zhang, and Zhaoyue Wang.
    </span>
    <span class="ltx_bibblock">
     Does hierarchical reinforcement learning outperform standard
reinforcement learning in goal-oriented environments?
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib35.1.1">
      NeurIPS 2023 Workshop on Goal-Conditioned Reinforcement
Learning
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [36]
    </span>
    <span class="ltx_bibblock">
     TM Moerland, DJ Broekens, and CM Jonker.
    </span>
    <span class="ltx_bibblock">
     Efficient exploration with double uncertain value networks.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib36.1.1">
      Deep Reinforcement Learning Symposium, NIPS 2017
     </span>
     , 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [37]
    </span>
    <span class="ltx_bibblock">
     Ron Mokady, Amir Hertz, and Amit H Bermano.
    </span>
    <span class="ltx_bibblock">
     Clipcap: Clip prefix for image captioning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib37.1.1">
      arXiv preprint arXiv:2111.09734
     </span>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [38]
    </span>
    <span class="ltx_bibblock">
     Seungyong Moon, Junyoung Yeom, Bumsoo Park, and Hyun Oh Song.
    </span>
    <span class="ltx_bibblock">
     Discovering hierarchical achievements in reinforcement learning via
contrastive learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib38.1.1">
      Advances in Neural Information Processing Systems
     </span>
     , 36, 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [39]
    </span>
    <span class="ltx_bibblock">
     Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela
Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John
Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda
Askell, Peter Welinder, Paul Christiano, Jan Leike, and Ryan Lowe.
    </span>
    <span class="ltx_bibblock">
     Training language models to follow instructions with human feedback,
2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [40]
    </span>
    <span class="ltx_bibblock">
     Deepak Pathak, Pulkit Agrawal, Alexei A Efros, and Trevor Darrell.
    </span>
    <span class="ltx_bibblock">
     Curiosity-driven exploration by self-supervised prediction.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib40.1.1">
      International conference on machine learning
     </span>
     , pages
2778–2787. PMLR, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [41]
    </span>
    <span class="ltx_bibblock">
     Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.
    </span>
    <span class="ltx_bibblock">
     Learning transferable visual models from natural language
supervision.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib41.1.1">
      International conference on machine learning
     </span>
     , pages
8748–8763. PMLR, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [42]
    </span>
    <span class="ltx_bibblock">
     Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya
Sutskever, et al.
    </span>
    <span class="ltx_bibblock">
     Language models are unsupervised multitask learners.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib42.1.1">
      OpenAI blog
     </span>
     , 1(8):9, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [43]
    </span>
    <span class="ltx_bibblock">
     Nils Reimers and Iryna Gurevych.
    </span>
    <span class="ltx_bibblock">
     Sentence-bert: Sentence embeddings using siamese bert-networks.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib43.1.1">
      arXiv preprint arXiv:1908.10084
     </span>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [44]
    </span>
    <span class="ltx_bibblock">
     Stuart Ian Reynolds.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib44.1.1">
      Reinforcement learning with exploration
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     PhD thesis, University of Birmingham, 2002.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [45]
    </span>
    <span class="ltx_bibblock">
     Martin Riedmiller, Roland Hafner, Thomas Lampe, Michael Neunert, Jonas Degrave,
Tom Wiele, Vlad Mnih, Nicolas Heess, and Jost Tobias Springenberg.
    </span>
    <span class="ltx_bibblock">
     Learning by playing solving sparse reward tasks from scratch.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib45.1.1">
      International conference on machine learning
     </span>
     , pages
4344–4353. PMLR, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [46]
    </span>
    <span class="ltx_bibblock">
     Julian Schrittwieser, Ioannis Antonoglou, Thomas Hubert, Karen Simonyan,
Laurent Sifre, Simon Schmitt, Arthur Guez, Edward Lockhart, Demis Hassabis,
Thore Graepel, et al.
    </span>
    <span class="ltx_bibblock">
     Mastering atari, go, chess and shogi by planning with a learned
model.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib46.1.1">
      Nature
     </span>
     , 588(7839):604–609, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [47]
    </span>
    <span class="ltx_bibblock">
     John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.
    </span>
    <span class="ltx_bibblock">
     Proximal policy optimization algorithms.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib47.1.1">
      arXiv preprint arXiv:1707.06347
     </span>
     , 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [48]
    </span>
    <span class="ltx_bibblock">
     Noah Shinn, Beck Labash, and Ashwin Gopinath.
    </span>
    <span class="ltx_bibblock">
     Reflexion: an autonomous agent with dynamic memory and
self-reflection.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib48.1.1">
      arXiv preprint arXiv:2303.11366
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [49]
    </span>
    <span class="ltx_bibblock">
     David Silver, Aja Huang, Chris J Maddison, Arthur Guez, Laurent Sifre, George
Van Den Driessche, Julian Schrittwieser, Ioannis Antonoglou, Veda
Panneershelvam, Marc Lanctot, et al.
    </span>
    <span class="ltx_bibblock">
     Mastering the game of go with deep neural networks and tree search.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib49.1.1">
      nature
     </span>
     , 529(7587):484–489, 2016.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [50]
    </span>
    <span class="ltx_bibblock">
     David Silver, Thomas Hubert, Julian Schrittwieser, Ioannis Antonoglou, Matthew
Lai, Arthur Guez, Marc Lanctot, Laurent Sifre, Dharshan Kumaran, Thore
Graepel, et al.
    </span>
    <span class="ltx_bibblock">
     A general reinforcement learning algorithm that masters chess, shogi,
and go through self-play.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib50.1.1">
      Science
     </span>
     , 362(6419):1140–1144, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [51]
    </span>
    <span class="ltx_bibblock">
     David Silver, Julian Schrittwieser, Karen Simonyan, Ioannis Antonoglou, Aja
Huang, Arthur Guez, Thomas Hubert, Lucas Baker, Matthew Lai, Adrian Bolton,
et al.
    </span>
    <span class="ltx_bibblock">
     Mastering the game of go without human knowledge.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib51.1.1">
      nature
     </span>
     , 550(7676):354–359, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [52]
    </span>
    <span class="ltx_bibblock">
     David Silver, Satinder Singh, Doina Precup, and Richard S Sutton.
    </span>
    <span class="ltx_bibblock">
     Reward is enough.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib52.1.1">
      Artificial Intelligence
     </span>
     , 299:103535, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [53]
    </span>
    <span class="ltx_bibblock">
     Bradly C Stadie, Sergey Levine, and Pieter Abbeel.
    </span>
    <span class="ltx_bibblock">
     Incentivizing exploration in reinforcement learning with deep
predictive models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib53.1.1">
      arXiv preprint arXiv:1507.00814
     </span>
     , 2015.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [54]
    </span>
    <span class="ltx_bibblock">
     Richard S Sutton and Andrew G Barto.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib54.1.1">
      Reinforcement learning: An introduction
     </span>
     .
    </span>
    <span class="ltx_bibblock">
     MIT press, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [55]
    </span>
    <span class="ltx_bibblock">
     Teck-Hou Teng and Ah-Hwee Tan.
    </span>
    <span class="ltx_bibblock">
     Knowledge-based exploration for reinforcement learning in
self-organizing neural networks.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib55.1.1">
      2012 IEEE/WIC/ACM International Conferences on Web
Intelligence and Intelligent Agent Technology
     </span>
     , volume 2, pages 332–339.
IEEE, 2012.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib56">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [56]
    </span>
    <span class="ltx_bibblock">
     Alexander Trott, Stephan Zheng, Caiming Xiong, and Richard Socher.
    </span>
    <span class="ltx_bibblock">
     Keeping your distance: Solving sparse reward tasks using
self-balancing shaped rewards.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib56.1.1">
      Advances in Neural Information Processing Systems
     </span>
     , 32, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib57">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [57]
    </span>
    <span class="ltx_bibblock">
     Guanzhi Wang, Yuqi Xie, Yunfan Jiang, Ajay Mandlekar, Chaowei Xiao, Yuke Zhu,
Linxi Fan, and Anima Anandkumar.
    </span>
    <span class="ltx_bibblock">
     Voyager: An open-ended embodied agent with large language models.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib57.1.1">
      arXiv preprint arXiv:2305.16291
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib58">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [58]
    </span>
    <span class="ltx_bibblock">
     Wenhui Wang, Furu Wei, Li Dong, Hangbo Bao, Nan Yang, and Ming Zhou.
    </span>
    <span class="ltx_bibblock">
     Minilm: Deep self-attention distillation for task-agnostic
compression of pre-trained transformers.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib58.1.1">
      Advances in Neural Information Processing Systems
     </span>
     ,
33:5776–5788, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib59">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [59]
    </span>
    <span class="ltx_bibblock">
     Xiyao Wang, Ruijie Zheng, Yanchao Sun, Ruonan Jia, Wichayaporn Wongkamjan,
Huazhe Xu, and Furong Huang.
    </span>
    <span class="ltx_bibblock">
     Coplanner: Plan to roll out conservatively but to explore
optimistically for model-based rl, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib60">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [60]
    </span>
    <span class="ltx_bibblock">
     Lisheng Wu and Ke Chen.
    </span>
    <span class="ltx_bibblock">
     Goal exploration augmentation via pre-trained skills for
sparse-reward long-horizon goal-conditioned reinforcement learning, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib61">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [61]
    </span>
    <span class="ltx_bibblock">
     Yue Wu, So Yeon Min, Shrimai Prabhumoye, Yonatan Bisk, Ruslan Salakhutdinov,
Amos Azaria, Tom Mitchell, and Yuanzhi Li.
    </span>
    <span class="ltx_bibblock">
     Spring: Gpt-4 out-performs rl algorithms by studying papers and
reasoning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib61.1.1">
      arXiv preprint arXiv:2305.15486
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib62">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [62]
    </span>
    <span class="ltx_bibblock">
     Tianbao Xie, Siheng Zhao, Chen Henry Wu, Yitao Liu, Qian Luo, Victor Zhong,
Yanchao Yang, and Tao Yu.
    </span>
    <span class="ltx_bibblock">
     Text2reward: Automated dense reward function generation for
reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib62.1.1">
      arXiv preprint arXiv:2309.11489
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib63">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [63]
    </span>
    <span class="ltx_bibblock">
     Kai Yang, Jian Tao, Jiafei Lyu, and Xiu Li.
    </span>
    <span class="ltx_bibblock">
     Exploration and anti-exploration with distributional random network
distillation.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib63.1.1">
      arXiv preprint arXiv:2401.09750
     </span>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib64">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [64]
    </span>
    <span class="ltx_bibblock">
     Tianpei Yang, Hongyao Tang, Chenjia Bai, Jinyi Liu, Jianye Hao, Zhaopeng Meng,
Peng Liu, and Zhen Wang.
    </span>
    <span class="ltx_bibblock">
     Exploration in deep reinforcement learning: a comprehensive survey.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib64.1.1">
      arXiv preprint arXiv:2109.06668
     </span>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib65">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [65]
    </span>
    <span class="ltx_bibblock">
     Shunyu Yao, Jeffrey Zhao, Dian Yu, Izhak Shafran, Karthik R Narasimhan, and
Yuan Cao.
    </span>
    <span class="ltx_bibblock">
     React: Synergizing reasoning and acting in language models.
    </span>
    <span class="ltx_bibblock">
     In
     <span class="ltx_text ltx_font_italic" id="biba.bib65.1.1">
      NeurIPS 2022 Foundation Models for Decision Making Workshop
     </span>
     ,
2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib66">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [66]
    </span>
    <span class="ltx_bibblock">
     Jesse Zhang, Jiahui Zhang, Karl Pertsch, Ziyi Liu, Xiang Ren, Minsuk Chang,
Shao-Hua Sun, and Joseph J Lim.
    </span>
    <span class="ltx_bibblock">
     Bootstrap your own skills: Learning to solve new tasks with large
language model guidance.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib66.1.1">
      arXiv preprint arXiv:2310.10021
     </span>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib67">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [67]
    </span>
    <span class="ltx_bibblock">
     Jingwei Zhang, Niklas Wetzel, Nicolai Dorka, Joschka Boedecker, and Wolfram
Burgard.
    </span>
    <span class="ltx_bibblock">
     Scheduled intrinsic drive: A hierarchical take on intrinsically
motivated exploration.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib67.1.1">
      arXiv preprint arXiv:1903.07400
     </span>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib68">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [68]
    </span>
    <span class="ltx_bibblock">
     Tianjun Zhang, Paria Rashidinejad, Jiantao Jiao, Yuandong Tian, Joseph E
Gonzalez, and Stuart Russell.
    </span>
    <span class="ltx_bibblock">
     Made: Exploration via maximizing deviation from explored regions.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib68.1.1">
      Advances in Neural Information Processing Systems
     </span>
     ,
34:9663–9680, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib69">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [69]
    </span>
    <span class="ltx_bibblock">
     Wanpeng Zhang and Zongqing Lu.
    </span>
    <span class="ltx_bibblock">
     Adarefiner: Refining decisions of language models with adaptive
feedback, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="biba.bib70">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     [70]
    </span>
    <span class="ltx_bibblock">
     Zihao Zhou, Bin Hu, Pu Zhang, Chenyang Zhao, and Bin Liu.
    </span>
    <span class="ltx_bibblock">
     Large language model is a good policy teacher for training
reinforcement learning agents.
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text ltx_font_italic" id="biba.bib70.1.1">
      arXiv preprint arXiv:2311.13373
     </span>
     , 2023.
    </span>
   </li>
  </ul>
 </section>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Environment Details
  </h2>
  <section class="ltx_subsection" id="A1.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.1
    </span>
    HomeGrid
   </h3>
   <section class="ltx_subsubsection" id="A1.SS1.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      A.1.1
     </span>
     Details of Environmental Adjustments
    </h4>
    <div class="ltx_para" id="A1.SS1.SSS1.p1">
     <p class="ltx_p" id="A1.SS1.SSS1.p1.1">
      “HomeGrid” is introduced by Dynalang
      <cite class="ltx_cite ltx_citemacro_cite">
       [
       <a class="ltx_ref" href="#biba.bib31" title="">
        31
       </a>
       ]
      </cite>
      , and our modified version is based on the “homegrid-task” setting. Aside from the pixel observation, this setting additionally provides language information describing the task assigned to the robotic agent. The original map of HomeGrid is a large 14x12 grid, as shown in Figure
      <span class="ltx_ref ltx_missing_label ltx_ref_self">
       LABEL:fig:homegrid_original
      </span>
      , and training on such a map would require an excessively long time. We have reduced the map size to a simplified version of 10x10 as in Figure
      <span class="ltx_ref ltx_missing_label ltx_ref_self">
       LABEL:fig:homegrid_mini
      </span>
      . In this smaller map, rooms have become more compact, but the width of passages between rooms remains unchanged. In addition to resizing the map, we have adjusted the refresh range for both the player and items, ensuring that players can always move and items can always be accessed. HomeGrid does not provide any visual signal when the robot takes the actions, including “pedal”, “lift”, and “grasp”, representing the different actions to open the bins, so the trained transition captioner needs additional information in the pixel observation. We add icons
      <span class="ltx_note ltx_role_footnote" id="footnote2">
       <sup class="ltx_note_mark">
        2
       </sup>
       <span class="ltx_note_outer">
        <span class="ltx_note_content">
         <sup class="ltx_note_mark">
          2
         </sup>
         <span class="ltx_tag ltx_tag_note">
          2
         </span>
         All assets of the icons are collected from
         <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://fontawesome.com/." target="_blank" title="">
          https://fontawesome.com/.
         </a>
        </span>
       </span>
      </span>
      for each of the three actions and make them appear when the related action is taken and the robot succeeds in opening any bin, as shown in Figure
      <span class="ltx_ref ltx_missing_label ltx_ref_self">
       LABEL:fig:homegrid_action
      </span>
      . Furthermore, there have been no alterations to HomeGrid’s task assignments, reward mechanisms, or total step count.
     </p>
    </div>
    <figure class="ltx_figure" id="A1.F7.sf1">
    </figure>
   </section>
   <section class="ltx_subsubsection" id="A1.SS1.SSS2">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      A.1.2
     </span>
     Full Prompt Details
    </h4>
    <div class="ltx_para" id="A1.SS1.SSS2.p1">
     <p class="ltx_p" id="A1.SS1.SSS2.p1.1">
      During each query to the LLM, we provide the agent with a concise overview of the fundamental aspects of the HomeGrid environment. The observation captioner interprets the current observational state of the environment into natural language, and we provide this to the LLM. We then direct the LLM to choose one goal for “what to do” and another for “where to go.” In order to ensure consistency in agent responses, we have incorporated mandatory statements and provided illustrative examples.
GPT’s performance can fluctuate, manifesting as inconsistent quality in generated outputs at different times of the day. We recommend capitalizing all the warning text. This can help alleviate the issue.
     </p>
    </div>
    <div class="ltx_para" id="A1.SS1.SSS2.p2">
     <p class="ltx_p" id="A1.SS1.SSS2.p2.1">
      The actual input provided to the LLM is divided into two parts: system information and game information. The part of system information is:
     </p>
    </div>
    <div class="ltx_para" id="A1.SS1.SSS2.p3">
     <p class="ltx_p" id="A1.SS1.SSS2.p3.1">
      <span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.SS1.SSS2.p3.1.1" style="width:433.6pt;">
       <span class="ltx_p" id="A1.SS1.SSS2.p3.1.1.1">
        <span class="ltx_text ltx_font_typewriter" id="A1.SS1.SSS2.p3.1.1.1.1">
         You are engaged in a game resembling AI2-THOR. You will receive details about your task, interactive items in view, carried items, and your current room. State the goals you wish to achieve from now on. Please select one thing to do and one room to go, and return them to me, with the format including:
         <br class="ltx_break"/>
         <br class="ltx_break"/>
         go to the [room],
         <br class="ltx_break"/>
         [action] the [object],
         <br class="ltx_break"/>
         [action] to [change the status of] (e.g., open) the [bin],
         <br class="ltx_break"/>
         [action] the [object] in/to the [bin/room].
         <br class="ltx_break"/>
         <br class="ltx_break"/>
         Commas should separate goals and should not contain any additional characters.
         <br class="ltx_break"/>
         <br class="ltx_break"/>
         An example is:
         <br class="ltx_break"/>
         get the bottle, go to the kitchen.
        </span>
       </span>
      </span>
     </p>
    </div>
    <div class="ltx_para" id="A1.SS1.SSS2.p4">
     <p class="ltx_p" id="A1.SS1.SSS2.p4.1">
      The format for game information is as follows:
     </p>
    </div>
    <div class="ltx_para" id="A1.SS1.SSS2.p5">
     <p class="ltx_p" id="A1.SS1.SSS2.p5.1">
      <span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.SS1.SSS2.p5.1.1" style="width:433.6pt;">
       <span class="ltx_p" id="A1.SS1.SSS2.p5.1.1.1">
        <span class="ltx_text ltx_font_typewriter" id="A1.SS1.SSS2.p5.1.1.1.1">
         Your task is [text],
         <br class="ltx_break"/>
         You see [objects],
         <br class="ltx_break"/>
         Your carrying is [object],
         <br class="ltx_break"/>
         [Extra information based on the setting of standard, key info, and full info].
        </span>
       </span>
      </span>
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection" id="A1.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.2
    </span>
    Crafter
   </h3>
   <div class="ltx_para" id="A1.SS2.p1">
    <p class="ltx_p" id="A1.SS2.p1.1">
     Crafter
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib19" title="">
       19
      </a>
      ]
     </cite>
     serves as a platform for reinforcement learning research drawing inspiration from Minecraft, featuring a 2D world where players engage in various survival activities. This game simplifies and optimizes familiar mechanics to enhance research productivity. Players explore a broad world comprising diverse terrains like forests, lakes, mountains, and caves. The game challenges players to maintain health, food, and water, with consequences for neglecting these essentials. The interaction with various creatures, which vary in behavior based on the time of day, adds to the game’s complexity.
    </p>
   </div>
   <section class="ltx_subsubsection" id="A1.SS2.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      A.2.1
     </span>
     Full Prompt Details
    </h4>
    <div class="ltx_para" id="A1.SS2.SSS1.p1">
     <p class="ltx_p" id="A1.SS2.SSS1.p1.1">
      During each query to the LLM, we start by presenting the framework of the Crafter environment, employing Minecraft as an analogy. Subsequently, we furnish the current observation information to the LLM, encompassing objects/creatures within the player’s field of view, the details of the player’s inventory, and the player’s status.
     </p>
    </div>
    <div class="ltx_para" id="A1.SS2.SSS1.p2">
     <p class="ltx_p" id="A1.SS2.SSS1.p2.1">
      In Crafter, we also divide the prompt for the LLM into two sections: system information and game information. The system information is as follows:
     </p>
    </div>
    <div class="ltx_para" id="A1.SS2.SSS1.p3">
     <p class="ltx_p" id="A1.SS2.SSS1.p3.1">
      <span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.SS2.SSS1.p3.1.1" style="width:433.6pt;">
       <span class="ltx_p" id="A1.SS2.SSS1.p3.1.1.1">
        <span class="ltx_text ltx_font_typewriter" id="A1.SS2.SSS1.p3.1.1.1.1">
         As a professional game analyst, you oversee an RL agent or a player in a game resembling Minecraft. You will receive a starting point that includes information about what the player sees, what the player has in his inventory, and the player’s status. For this starting point, please provide the top 5 key goals the player should achieve in the next several steps to maximize its game exploration.
         <br class="ltx_break"/>
        </span>
       </span>
       <span class="ltx_p" id="A1.SS2.SSS1.p3.1.1.2">
        <span class="ltx_text ltx_font_typewriter" id="A1.SS2.SSS1.p3.1.1.2.1">
         Consider the feasibility of each action in the current state and its importance to achieving the achievement. The response should only include valid actions separated by ’,’. Do not include any other letters, symbols, or words.
         <br class="ltx_break"/>
        </span>
       </span>
       <span class="ltx_p" id="A1.SS2.SSS1.p3.1.1.3">
        <span class="ltx_text ltx_font_typewriter" id="A1.SS2.SSS1.p3.1.1.3.1">
         An example is:
         <br class="ltx_break"/>
         collect wood, place table, collect stone, attack cow, attack zombie.
        </span>
       </span>
      </span>
     </p>
    </div>
    <div class="ltx_para" id="A1.SS2.SSS1.p4">
     <p class="ltx_p" id="A1.SS2.SSS1.p4.1">
      The format for game information is as follows:
     </p>
    </div>
    <div class="ltx_para" id="A1.SS2.SSS1.p5">
     <p class="ltx_p" id="A1.SS2.SSS1.p5.1">
      <span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.SS2.SSS1.p5.1.1" style="width:433.6pt;">
       <span class="ltx_p" id="A1.SS2.SSS1.p5.1.1.1">
        <span class="ltx_text ltx_font_typewriter" id="A1.SS2.SSS1.p5.1.1.1.1">
         The player sees [objects/creatures],
         <br class="ltx_break"/>
         The player has [objects],
         <br class="ltx_break"/>
         The status of the player is [text].
        </span>
       </span>
      </span>
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection" id="A1.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.3
    </span>
    Minecraft
   </h3>
   <div class="ltx_para" id="A1.SS3.p1">
    <p class="ltx_p" id="A1.SS3.p1.1">
     Minecraft Diamond
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#biba.bib23" title="">
       23
      </a>
      ]
     </cite>
     is an innovative environment developed on top of MineRL
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#biba.bib17" title="">
       17
      </a>
      ]
     </cite>
     , gaining significant attention in the research community within the expansive universe of Minecraft. Minecraft offers a procedurally generated 3D world with diverse biomes, such as forests, deserts, and mountains, all composed of one-meter blocks for player interaction. The primary challenge in this environment is the pursuit of diamonds, a rare and valuable resource found deep underground
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib35" title="">
       35
      </a>
      ]
     </cite>
     . This quest tests players’ abilities to navigate and survive in the diverse Minecraft world, requiring progression through a complex technology tree. Players interact with various creatures, gather resources, and craft items from over 379 recipes, ensuring their survival by managing food and safety.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS3.p2">
    <p class="ltx_p" id="A1.SS3.p2.1">
     Developers have meticulously addressed gameplay nuances identified through extensive human playtesting in the Minecraft Diamond environment. Key improvements include modifying the episode termination criteria based on player death or a fixed number of steps and refining the jump mechanism to enhance player interaction and strategy development. The environment, built on MineRL v0.4.415 and Minecraft version 1.11.2, offers a more consistent and engaging experience. The reward system is thoughtfully structured, encouraging players to reach 12 significant milestones culminating in acquiring a diamond. This system, while straightforward, requires strategic planning and resource management, as each item provides a reward only once per episode. The environment’s sensory inputs and action space are comprehensive and immersive, offering players a first-person view and a wide range of actions, from movement to crafting.
    </p>
   </div>
   <section class="ltx_subsubsection" id="A1.SS3.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      A.3.1
     </span>
     Full Prompt Details
    </h4>
    <div class="ltx_para" id="A1.SS3.SSS1.p1">
     <p class="ltx_p" id="A1.SS3.SSS1.p1.1">
      In Minecraft, we also split the LLM prompt into system and game info sections. The system information is as follows:
     </p>
    </div>
    <div class="ltx_para" id="A1.SS3.SSS1.p2">
     <p class="ltx_p" id="A1.SS3.SSS1.p2.1">
      <span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.SS3.SSS1.p2.1.1" style="width:433.6pt;">
       <span class="ltx_p" id="A1.SS3.SSS1.p2.1.1.1">
        <span class="ltx_text ltx_font_typewriter" id="A1.SS3.SSS1.p2.1.1.1.1">
         As a professional game analyst, you oversee an RL agent or a player in Minecraft, and your final goal is to collect a diamond. You will receive a starting point that includes information about what the player sees, what the player has in his inventory, and the player’s status. For this starting point, please provide the top 5 key goals the player should achieve in the next several steps to achieve his final goal.
         <br class="ltx_break"/>
         <br class="ltx_break"/>
         Take note of the game mechanics in Minecraft; you need to progressively accomplish goals. Each goal should be in the form of an action with an item after it. Please do not add any extra numbers or words.
         <br class="ltx_break"/>
         <br class="ltx_break"/>
         An example is:
         <br class="ltx_break"/>
         pick up log, attack creepers, drop cobblestone, craft wooden pickaxe, craft arrows.
        </span>
       </span>
      </span>
     </p>
    </div>
    <div class="ltx_para" id="A1.SS3.SSS1.p3">
     <p class="ltx_p" id="A1.SS3.SSS1.p3.1">
      An example of game information is as follows:
     </p>
    </div>
    <div class="ltx_para" id="A1.SS3.SSS1.p4">
     <p class="ltx_p" id="A1.SS3.SSS1.p4.1">
      <span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.SS3.SSS1.p4.1.1" style="width:433.6pt;">
       <span class="ltx_p" id="A1.SS3.SSS1.p4.1.1.1">
        <span class="ltx_text ltx_font_typewriter" id="A1.SS3.SSS1.p4.1.1.1.1">
         You have [objects]
         <br class="ltx_break"/>
         You have equipped [objects]
         <br class="ltx_break"/>
         The status of you is [text].
        </span>
       </span>
      </span>
     </p>
    </div>
   </section>
  </section>
 </section>
 <section class="ltx_appendix" id="A2">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix B
   </span>
   Additional Details of DLLM
  </h2>
  <section class="ltx_subsection" id="A2.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     B.1
    </span>
    Two-hot Reward Prediction
   </h3>
   <div class="ltx_para" id="A2.SS1.p1">
    <p class="ltx_p" id="A2.SS1.p1.1">
     We adopt the DreamerV3 approach for reward prediction, utilizing a softmax classifier with exponentially spaced bins. This classifier is employed to regress the two-hot encoding of real-valued rewards, ensuring that the gradient scale remains independent of the arbitrary scale of the rewards. Additionally, we apply a regularizer with a cap at one free nat
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib29" title="">
       29
      </a>
      ]
     </cite>
     to avoid over-regularization, a phenomenon known as posterior collapse.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A2.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     B.2
    </span>
    Pseudo Code
   </h3>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg1.2.1.1">
       Algorithm 1
      </span>
     </span>
     Dreaming with Large Language Models (DLLM)
    </figcaption>
    <div class="ltx_listing ltx_listing" id="alg1.3">
     <div class="ltx_listingline" id="alg1.l1">
      <span class="ltx_text ltx_font_bold" id="alg1.l1.1">
       while
      </span>
      acting
      <span class="ltx_text ltx_font_bold" id="alg1.l1.2">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l2">
      Observe in the environment
      <math alttext="r_{t},c_{t},x_{t},u_{t},o^{l}_{t}\leftarrow\operatorname{env}\left(a_{t-1}\right)" class="ltx_Math" display="inline" id="alg1.l2.m1.7">
       <semantics id="alg1.l2.m1.7a">
        <mrow id="alg1.l2.m1.7.7" xref="alg1.l2.m1.7.7.cmml">
         <mrow id="alg1.l2.m1.6.6.5.5" xref="alg1.l2.m1.6.6.5.6.cmml">
          <msub id="alg1.l2.m1.2.2.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.cmml">
           <mi id="alg1.l2.m1.2.2.1.1.1.2" xref="alg1.l2.m1.2.2.1.1.1.2.cmml">
            r
           </mi>
           <mi id="alg1.l2.m1.2.2.1.1.1.3" xref="alg1.l2.m1.2.2.1.1.1.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l2.m1.6.6.5.5.6" xref="alg1.l2.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msub id="alg1.l2.m1.3.3.2.2.2" xref="alg1.l2.m1.3.3.2.2.2.cmml">
           <mi id="alg1.l2.m1.3.3.2.2.2.2" xref="alg1.l2.m1.3.3.2.2.2.2.cmml">
            c
           </mi>
           <mi id="alg1.l2.m1.3.3.2.2.2.3" xref="alg1.l2.m1.3.3.2.2.2.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l2.m1.6.6.5.5.7" xref="alg1.l2.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msub id="alg1.l2.m1.4.4.3.3.3" xref="alg1.l2.m1.4.4.3.3.3.cmml">
           <mi id="alg1.l2.m1.4.4.3.3.3.2" xref="alg1.l2.m1.4.4.3.3.3.2.cmml">
            x
           </mi>
           <mi id="alg1.l2.m1.4.4.3.3.3.3" xref="alg1.l2.m1.4.4.3.3.3.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l2.m1.6.6.5.5.8" xref="alg1.l2.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msub id="alg1.l2.m1.5.5.4.4.4" xref="alg1.l2.m1.5.5.4.4.4.cmml">
           <mi id="alg1.l2.m1.5.5.4.4.4.2" xref="alg1.l2.m1.5.5.4.4.4.2.cmml">
            u
           </mi>
           <mi id="alg1.l2.m1.5.5.4.4.4.3" xref="alg1.l2.m1.5.5.4.4.4.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l2.m1.6.6.5.5.9" xref="alg1.l2.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l2.m1.6.6.5.5.5" xref="alg1.l2.m1.6.6.5.5.5.cmml">
           <mi id="alg1.l2.m1.6.6.5.5.5.2.2" xref="alg1.l2.m1.6.6.5.5.5.2.2.cmml">
            o
           </mi>
           <mi id="alg1.l2.m1.6.6.5.5.5.3" xref="alg1.l2.m1.6.6.5.5.5.3.cmml">
            t
           </mi>
           <mi id="alg1.l2.m1.6.6.5.5.5.2.3" xref="alg1.l2.m1.6.6.5.5.5.2.3.cmml">
            l
           </mi>
          </msubsup>
         </mrow>
         <mo id="alg1.l2.m1.7.7.7" stretchy="false" xref="alg1.l2.m1.7.7.7.cmml">
          ←
         </mo>
         <mrow id="alg1.l2.m1.7.7.6.1" xref="alg1.l2.m1.7.7.6.2.cmml">
          <mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">
           env
          </mi>
          <mo id="alg1.l2.m1.7.7.6.1a" xref="alg1.l2.m1.7.7.6.2.cmml">
           ⁡
          </mo>
          <mrow id="alg1.l2.m1.7.7.6.1.1" xref="alg1.l2.m1.7.7.6.2.cmml">
           <mo id="alg1.l2.m1.7.7.6.1.1.2" xref="alg1.l2.m1.7.7.6.2.cmml">
            (
           </mo>
           <msub id="alg1.l2.m1.7.7.6.1.1.1" xref="alg1.l2.m1.7.7.6.1.1.1.cmml">
            <mi id="alg1.l2.m1.7.7.6.1.1.1.2" xref="alg1.l2.m1.7.7.6.1.1.1.2.cmml">
             a
            </mi>
            <mrow id="alg1.l2.m1.7.7.6.1.1.1.3" xref="alg1.l2.m1.7.7.6.1.1.1.3.cmml">
             <mi id="alg1.l2.m1.7.7.6.1.1.1.3.2" xref="alg1.l2.m1.7.7.6.1.1.1.3.2.cmml">
              t
             </mi>
             <mo id="alg1.l2.m1.7.7.6.1.1.1.3.1" xref="alg1.l2.m1.7.7.6.1.1.1.3.1.cmml">
              −
             </mo>
             <mn id="alg1.l2.m1.7.7.6.1.1.1.3.3" xref="alg1.l2.m1.7.7.6.1.1.1.3.3.cmml">
              1
             </mn>
            </mrow>
           </msub>
           <mo id="alg1.l2.m1.7.7.6.1.1.3" xref="alg1.l2.m1.7.7.6.2.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m1.7b">
         <apply id="alg1.l2.m1.7.7.cmml" xref="alg1.l2.m1.7.7">
          <ci id="alg1.l2.m1.7.7.7.cmml" xref="alg1.l2.m1.7.7.7">
           ←
          </ci>
          <list id="alg1.l2.m1.6.6.5.6.cmml" xref="alg1.l2.m1.6.6.5.5">
           <apply id="alg1.l2.m1.2.2.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l2.m1.2.2.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1">
             subscript
            </csymbol>
            <ci id="alg1.l2.m1.2.2.1.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.1.2">
             𝑟
            </ci>
            <ci id="alg1.l2.m1.2.2.1.1.1.3.cmml" xref="alg1.l2.m1.2.2.1.1.1.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l2.m1.3.3.2.2.2.cmml" xref="alg1.l2.m1.3.3.2.2.2">
            <csymbol cd="ambiguous" id="alg1.l2.m1.3.3.2.2.2.1.cmml" xref="alg1.l2.m1.3.3.2.2.2">
             subscript
            </csymbol>
            <ci id="alg1.l2.m1.3.3.2.2.2.2.cmml" xref="alg1.l2.m1.3.3.2.2.2.2">
             𝑐
            </ci>
            <ci id="alg1.l2.m1.3.3.2.2.2.3.cmml" xref="alg1.l2.m1.3.3.2.2.2.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l2.m1.4.4.3.3.3.cmml" xref="alg1.l2.m1.4.4.3.3.3">
            <csymbol cd="ambiguous" id="alg1.l2.m1.4.4.3.3.3.1.cmml" xref="alg1.l2.m1.4.4.3.3.3">
             subscript
            </csymbol>
            <ci id="alg1.l2.m1.4.4.3.3.3.2.cmml" xref="alg1.l2.m1.4.4.3.3.3.2">
             𝑥
            </ci>
            <ci id="alg1.l2.m1.4.4.3.3.3.3.cmml" xref="alg1.l2.m1.4.4.3.3.3.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l2.m1.5.5.4.4.4.cmml" xref="alg1.l2.m1.5.5.4.4.4">
            <csymbol cd="ambiguous" id="alg1.l2.m1.5.5.4.4.4.1.cmml" xref="alg1.l2.m1.5.5.4.4.4">
             subscript
            </csymbol>
            <ci id="alg1.l2.m1.5.5.4.4.4.2.cmml" xref="alg1.l2.m1.5.5.4.4.4.2">
             𝑢
            </ci>
            <ci id="alg1.l2.m1.5.5.4.4.4.3.cmml" xref="alg1.l2.m1.5.5.4.4.4.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l2.m1.6.6.5.5.5.cmml" xref="alg1.l2.m1.6.6.5.5.5">
            <csymbol cd="ambiguous" id="alg1.l2.m1.6.6.5.5.5.1.cmml" xref="alg1.l2.m1.6.6.5.5.5">
             subscript
            </csymbol>
            <apply id="alg1.l2.m1.6.6.5.5.5.2.cmml" xref="alg1.l2.m1.6.6.5.5.5">
             <csymbol cd="ambiguous" id="alg1.l2.m1.6.6.5.5.5.2.1.cmml" xref="alg1.l2.m1.6.6.5.5.5">
              superscript
             </csymbol>
             <ci id="alg1.l2.m1.6.6.5.5.5.2.2.cmml" xref="alg1.l2.m1.6.6.5.5.5.2.2">
              𝑜
             </ci>
             <ci id="alg1.l2.m1.6.6.5.5.5.2.3.cmml" xref="alg1.l2.m1.6.6.5.5.5.2.3">
              𝑙
             </ci>
            </apply>
            <ci id="alg1.l2.m1.6.6.5.5.5.3.cmml" xref="alg1.l2.m1.6.6.5.5.5.3">
             𝑡
            </ci>
           </apply>
          </list>
          <apply id="alg1.l2.m1.7.7.6.2.cmml" xref="alg1.l2.m1.7.7.6.1">
           <ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">
            env
           </ci>
           <apply id="alg1.l2.m1.7.7.6.1.1.1.cmml" xref="alg1.l2.m1.7.7.6.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l2.m1.7.7.6.1.1.1.1.cmml" xref="alg1.l2.m1.7.7.6.1.1.1">
             subscript
            </csymbol>
            <ci id="alg1.l2.m1.7.7.6.1.1.1.2.cmml" xref="alg1.l2.m1.7.7.6.1.1.1.2">
             𝑎
            </ci>
            <apply id="alg1.l2.m1.7.7.6.1.1.1.3.cmml" xref="alg1.l2.m1.7.7.6.1.1.1.3">
             <minus id="alg1.l2.m1.7.7.6.1.1.1.3.1.cmml" xref="alg1.l2.m1.7.7.6.1.1.1.3.1">
             </minus>
             <ci id="alg1.l2.m1.7.7.6.1.1.1.3.2.cmml" xref="alg1.l2.m1.7.7.6.1.1.1.3.2">
              𝑡
             </ci>
             <cn id="alg1.l2.m1.7.7.6.1.1.1.3.3.cmml" type="integer" xref="alg1.l2.m1.7.7.6.1.1.1.3.3">
              1
             </cn>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m1.7c">
         r_{t},c_{t},x_{t},u_{t},o^{l}_{t}\leftarrow\operatorname{env}\left(a_{t-1}\right)
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l3">
      Acquire goals
      <math alttext="g^{t}_{1:K}\leftarrow\text{embed}(\operatorname{LLM}\left(o^{l}_{t}\right))" class="ltx_Math" display="inline" id="alg1.l3.m1.2">
       <semantics id="alg1.l3.m1.2a">
        <mrow id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">
         <msubsup id="alg1.l3.m1.2.2.3" xref="alg1.l3.m1.2.2.3.cmml">
          <mi id="alg1.l3.m1.2.2.3.2.2" xref="alg1.l3.m1.2.2.3.2.2.cmml">
           g
          </mi>
          <mrow id="alg1.l3.m1.2.2.3.3" xref="alg1.l3.m1.2.2.3.3.cmml">
           <mn id="alg1.l3.m1.2.2.3.3.2" xref="alg1.l3.m1.2.2.3.3.2.cmml">
            1
           </mn>
           <mo id="alg1.l3.m1.2.2.3.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l3.m1.2.2.3.3.1.cmml">
            :
           </mo>
           <mi id="alg1.l3.m1.2.2.3.3.3" xref="alg1.l3.m1.2.2.3.3.3.cmml">
            K
           </mi>
          </mrow>
          <mi id="alg1.l3.m1.2.2.3.2.3" xref="alg1.l3.m1.2.2.3.2.3.cmml">
           t
          </mi>
         </msubsup>
         <mo id="alg1.l3.m1.2.2.2" stretchy="false" xref="alg1.l3.m1.2.2.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l3.m1.2.2.1" xref="alg1.l3.m1.2.2.1.cmml">
          <mtext id="alg1.l3.m1.2.2.1.3" xref="alg1.l3.m1.2.2.1.3a.cmml">
           embed
          </mtext>
          <mo id="alg1.l3.m1.2.2.1.2" lspace="0em" rspace="0em" xref="alg1.l3.m1.2.2.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.l3.m1.2.2.1.1.1" xref="alg1.l3.m1.2.2.1.cmml">
           <mo id="alg1.l3.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l3.m1.2.2.1.cmml">
            (
           </mo>
           <mrow id="alg1.l3.m1.2.2.1.1.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.2.cmml">
            <mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">
             LLM
            </mi>
            <mo id="alg1.l3.m1.2.2.1.1.1.1.1a" xref="alg1.l3.m1.2.2.1.1.1.1.2.cmml">
             ⁡
            </mo>
            <mrow id="alg1.l3.m1.2.2.1.1.1.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.2.cmml">
             <mo id="alg1.l3.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l3.m1.2.2.1.1.1.1.2.cmml">
              (
             </mo>
             <msubsup id="alg1.l3.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.cmml">
              <mi id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.2" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">
               o
              </mi>
              <mi id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
              <mi id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.3" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">
               l
              </mi>
             </msubsup>
             <mo id="alg1.l3.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l3.m1.2.2.1.1.1.1.2.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="alg1.l3.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.l3.m1.2.2.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b">
         <apply id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">
          <ci id="alg1.l3.m1.2.2.2.cmml" xref="alg1.l3.m1.2.2.2">
           ←
          </ci>
          <apply id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.3">
           <csymbol cd="ambiguous" id="alg1.l3.m1.2.2.3.1.cmml" xref="alg1.l3.m1.2.2.3">
            subscript
           </csymbol>
           <apply id="alg1.l3.m1.2.2.3.2.cmml" xref="alg1.l3.m1.2.2.3">
            <csymbol cd="ambiguous" id="alg1.l3.m1.2.2.3.2.1.cmml" xref="alg1.l3.m1.2.2.3">
             superscript
            </csymbol>
            <ci id="alg1.l3.m1.2.2.3.2.2.cmml" xref="alg1.l3.m1.2.2.3.2.2">
             𝑔
            </ci>
            <ci id="alg1.l3.m1.2.2.3.2.3.cmml" xref="alg1.l3.m1.2.2.3.2.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l3.m1.2.2.3.3.cmml" xref="alg1.l3.m1.2.2.3.3">
            <ci id="alg1.l3.m1.2.2.3.3.1.cmml" xref="alg1.l3.m1.2.2.3.3.1">
             :
            </ci>
            <cn id="alg1.l3.m1.2.2.3.3.2.cmml" type="integer" xref="alg1.l3.m1.2.2.3.3.2">
             1
            </cn>
            <ci id="alg1.l3.m1.2.2.3.3.3.cmml" xref="alg1.l3.m1.2.2.3.3.3">
             𝐾
            </ci>
           </apply>
          </apply>
          <apply id="alg1.l3.m1.2.2.1.cmml" xref="alg1.l3.m1.2.2.1">
           <times id="alg1.l3.m1.2.2.1.2.cmml" xref="alg1.l3.m1.2.2.1.2">
           </times>
           <ci id="alg1.l3.m1.2.2.1.3a.cmml" xref="alg1.l3.m1.2.2.1.3">
            <mtext id="alg1.l3.m1.2.2.1.3.cmml" xref="alg1.l3.m1.2.2.1.3">
             embed
            </mtext>
           </ci>
           <apply id="alg1.l3.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1">
            <ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">
             LLM
            </ci>
            <apply id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <apply id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1">
               superscript
              </csymbol>
              <ci id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.2">
               𝑜
              </ci>
              <ci id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.2.3">
               𝑙
              </ci>
             </apply>
             <ci id="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l3.m1.2c">
         g^{t}_{1:K}\leftarrow\text{embed}(\operatorname{LLM}\left(o^{l}_{t}\right))
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l4">
      Encode observations
      <math alttext="z_{t}\sim\operatorname{enc}\left(x_{t},u_{t},h_{t}\right)" class="ltx_Math" display="inline" id="alg1.l4.m1.4">
       <semantics id="alg1.l4.m1.4a">
        <mrow id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml">
         <msub id="alg1.l4.m1.4.4.5" xref="alg1.l4.m1.4.4.5.cmml">
          <mi id="alg1.l4.m1.4.4.5.2" xref="alg1.l4.m1.4.4.5.2.cmml">
           z
          </mi>
          <mi id="alg1.l4.m1.4.4.5.3" xref="alg1.l4.m1.4.4.5.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l4.m1.4.4.4" xref="alg1.l4.m1.4.4.4.cmml">
          ∼
         </mo>
         <mrow id="alg1.l4.m1.4.4.3.3" xref="alg1.l4.m1.4.4.3.4.cmml">
          <mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">
           enc
          </mi>
          <mo id="alg1.l4.m1.4.4.3.3a" xref="alg1.l4.m1.4.4.3.4.cmml">
           ⁡
          </mo>
          <mrow id="alg1.l4.m1.4.4.3.3.3" xref="alg1.l4.m1.4.4.3.4.cmml">
           <mo id="alg1.l4.m1.4.4.3.3.3.4" xref="alg1.l4.m1.4.4.3.4.cmml">
            (
           </mo>
           <msub id="alg1.l4.m1.2.2.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.cmml">
            <mi id="alg1.l4.m1.2.2.1.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.1.2.cmml">
             x
            </mi>
            <mi id="alg1.l4.m1.2.2.1.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.1.3.cmml">
             t
            </mi>
           </msub>
           <mo id="alg1.l4.m1.4.4.3.3.3.5" xref="alg1.l4.m1.4.4.3.4.cmml">
            ,
           </mo>
           <msub id="alg1.l4.m1.3.3.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.2.cmml">
            <mi id="alg1.l4.m1.3.3.2.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.2.2.cmml">
             u
            </mi>
            <mi id="alg1.l4.m1.3.3.2.2.2.2.3" xref="alg1.l4.m1.3.3.2.2.2.2.3.cmml">
             t
            </mi>
           </msub>
           <mo id="alg1.l4.m1.4.4.3.3.3.6" xref="alg1.l4.m1.4.4.3.4.cmml">
            ,
           </mo>
           <msub id="alg1.l4.m1.4.4.3.3.3.3" xref="alg1.l4.m1.4.4.3.3.3.3.cmml">
            <mi id="alg1.l4.m1.4.4.3.3.3.3.2" xref="alg1.l4.m1.4.4.3.3.3.3.2.cmml">
             h
            </mi>
            <mi id="alg1.l4.m1.4.4.3.3.3.3.3" xref="alg1.l4.m1.4.4.3.3.3.3.3.cmml">
             t
            </mi>
           </msub>
           <mo id="alg1.l4.m1.4.4.3.3.3.7" xref="alg1.l4.m1.4.4.3.4.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b">
         <apply id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">
          <csymbol cd="latexml" id="alg1.l4.m1.4.4.4.cmml" xref="alg1.l4.m1.4.4.4">
           similar-to
          </csymbol>
          <apply id="alg1.l4.m1.4.4.5.cmml" xref="alg1.l4.m1.4.4.5">
           <csymbol cd="ambiguous" id="alg1.l4.m1.4.4.5.1.cmml" xref="alg1.l4.m1.4.4.5">
            subscript
           </csymbol>
           <ci id="alg1.l4.m1.4.4.5.2.cmml" xref="alg1.l4.m1.4.4.5.2">
            𝑧
           </ci>
           <ci id="alg1.l4.m1.4.4.5.3.cmml" xref="alg1.l4.m1.4.4.5.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l4.m1.4.4.3.4.cmml" xref="alg1.l4.m1.4.4.3.3">
           <ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">
            enc
           </ci>
           <apply id="alg1.l4.m1.2.2.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l4.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1">
             subscript
            </csymbol>
            <ci id="alg1.l4.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.2">
             𝑥
            </ci>
            <ci id="alg1.l4.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l4.m1.3.3.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2">
            <csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l4.m1.3.3.2.2.2.2">
             subscript
            </csymbol>
            <ci id="alg1.l4.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.2">
             𝑢
            </ci>
            <ci id="alg1.l4.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l4.m1.3.3.2.2.2.2.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l4.m1.4.4.3.3.3.3.cmml" xref="alg1.l4.m1.4.4.3.3.3.3">
            <csymbol cd="ambiguous" id="alg1.l4.m1.4.4.3.3.3.3.1.cmml" xref="alg1.l4.m1.4.4.3.3.3.3">
             subscript
            </csymbol>
            <ci id="alg1.l4.m1.4.4.3.3.3.3.2.cmml" xref="alg1.l4.m1.4.4.3.3.3.3.2">
             ℎ
            </ci>
            <ci id="alg1.l4.m1.4.4.3.3.3.3.3.cmml" xref="alg1.l4.m1.4.4.3.3.3.3.3">
             𝑡
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l4.m1.4c">
         z_{t}\sim\operatorname{enc}\left(x_{t},u_{t},h_{t}\right)
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l5">
      Execute action
      <math alttext="a_{t}\sim\pi\left(a_{t}\mid h_{t},z_{t}\right)" class="ltx_Math" display="inline" id="alg1.l5.m1.1">
       <semantics id="alg1.l5.m1.1a">
        <mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">
         <msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">
          <mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">
           a
          </mi>
          <mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">
          ∼
         </mo>
         <mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">
          <mi id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3.cmml">
           π
          </mi>
          <mo id="alg1.l5.m1.1.1.1.2" lspace="0em" rspace="0em" xref="alg1.l5.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">
           <mo id="alg1.l5.m1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">
            <msub id="alg1.l5.m1.1.1.1.1.1.1.4" xref="alg1.l5.m1.1.1.1.1.1.1.4.cmml">
             <mi id="alg1.l5.m1.1.1.1.1.1.1.4.2" xref="alg1.l5.m1.1.1.1.1.1.1.4.2.cmml">
              a
             </mi>
             <mi id="alg1.l5.m1.1.1.1.1.1.1.4.3" xref="alg1.l5.m1.1.1.1.1.1.1.4.3.cmml">
              t
             </mi>
            </msub>
            <mo id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">
             ∣
            </mo>
            <mrow id="alg1.l5.m1.1.1.1.1.1.1.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml">
             <msub id="alg1.l5.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml">
              <mi id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.cmml">
               h
              </mi>
              <mi id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="alg1.l5.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml">
              ,
             </mo>
             <msub id="alg1.l5.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.cmml">
              <mi id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.2.cmml">
               z
              </mi>
              <mi id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.3.cmml">
               t
              </mi>
             </msub>
            </mrow>
           </mrow>
           <mo id="alg1.l5.m1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b">
         <apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">
          <csymbol cd="latexml" id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">
           similar-to
          </csymbol>
          <apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">
            subscript
           </csymbol>
           <ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">
            𝑎
           </ci>
           <ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">
           <times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2">
           </times>
           <ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">
            𝜋
           </ci>
           <apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">
            <csymbol cd="latexml" id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">
             conditional
            </csymbol>
            <apply id="alg1.l5.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4">
             <csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4">
              subscript
             </csymbol>
             <ci id="alg1.l5.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4.2">
              𝑎
             </ci>
             <ci id="alg1.l5.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4.3">
              𝑡
             </ci>
            </apply>
            <list id="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2">
             <apply id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2">
               ℎ
              </ci>
              <ci id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2">
              <csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.2">
               𝑧
              </ci>
              <ci id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.3">
               𝑡
              </ci>
             </apply>
            </list>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m1.1c">
         a_{t}\sim\pi\left(a_{t}\mid h_{t},z_{t}\right)
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l6">
      Add
      <math alttext="\left(r_{t},c_{t},x_{t},u_{t},a_{t},g^{t}_{1:K}\right)" class="ltx_Math" display="inline" id="alg1.l6.m1.6">
       <semantics id="alg1.l6.m1.6a">
        <mrow id="alg1.l6.m1.6.6.6" xref="alg1.l6.m1.6.6.7.cmml">
         <mo id="alg1.l6.m1.6.6.6.7" xref="alg1.l6.m1.6.6.7.cmml">
          (
         </mo>
         <msub id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">
          <mi id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml">
           r
          </mi>
          <mi id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l6.m1.6.6.6.8" xref="alg1.l6.m1.6.6.7.cmml">
          ,
         </mo>
         <msub id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.cmml">
          <mi id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml">
           c
          </mi>
          <mi id="alg1.l6.m1.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l6.m1.6.6.6.9" xref="alg1.l6.m1.6.6.7.cmml">
          ,
         </mo>
         <msub id="alg1.l6.m1.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.cmml">
          <mi id="alg1.l6.m1.3.3.3.3.2" xref="alg1.l6.m1.3.3.3.3.2.cmml">
           x
          </mi>
          <mi id="alg1.l6.m1.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.3.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l6.m1.6.6.6.10" xref="alg1.l6.m1.6.6.7.cmml">
          ,
         </mo>
         <msub id="alg1.l6.m1.4.4.4.4" xref="alg1.l6.m1.4.4.4.4.cmml">
          <mi id="alg1.l6.m1.4.4.4.4.2" xref="alg1.l6.m1.4.4.4.4.2.cmml">
           u
          </mi>
          <mi id="alg1.l6.m1.4.4.4.4.3" xref="alg1.l6.m1.4.4.4.4.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l6.m1.6.6.6.11" xref="alg1.l6.m1.6.6.7.cmml">
          ,
         </mo>
         <msub id="alg1.l6.m1.5.5.5.5" xref="alg1.l6.m1.5.5.5.5.cmml">
          <mi id="alg1.l6.m1.5.5.5.5.2" xref="alg1.l6.m1.5.5.5.5.2.cmml">
           a
          </mi>
          <mi id="alg1.l6.m1.5.5.5.5.3" xref="alg1.l6.m1.5.5.5.5.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l6.m1.6.6.6.12" xref="alg1.l6.m1.6.6.7.cmml">
          ,
         </mo>
         <msubsup id="alg1.l6.m1.6.6.6.6" xref="alg1.l6.m1.6.6.6.6.cmml">
          <mi id="alg1.l6.m1.6.6.6.6.2.2" xref="alg1.l6.m1.6.6.6.6.2.2.cmml">
           g
          </mi>
          <mrow id="alg1.l6.m1.6.6.6.6.3" xref="alg1.l6.m1.6.6.6.6.3.cmml">
           <mn id="alg1.l6.m1.6.6.6.6.3.2" xref="alg1.l6.m1.6.6.6.6.3.2.cmml">
            1
           </mn>
           <mo id="alg1.l6.m1.6.6.6.6.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l6.m1.6.6.6.6.3.1.cmml">
            :
           </mo>
           <mi id="alg1.l6.m1.6.6.6.6.3.3" xref="alg1.l6.m1.6.6.6.6.3.3.cmml">
            K
           </mi>
          </mrow>
          <mi id="alg1.l6.m1.6.6.6.6.2.3" xref="alg1.l6.m1.6.6.6.6.2.3.cmml">
           t
          </mi>
         </msubsup>
         <mo id="alg1.l6.m1.6.6.6.13" xref="alg1.l6.m1.6.6.7.cmml">
          )
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m1.6b">
         <vector id="alg1.l6.m1.6.6.7.cmml" xref="alg1.l6.m1.6.6.6">
          <apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">
           <csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2">
            𝑟
           </ci>
           <ci id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2">
           <csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2">
            subscript
           </csymbol>
           <ci id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2">
            𝑐
           </ci>
           <ci id="alg1.l6.m1.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l6.m1.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3">
           <csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.3.1.cmml" xref="alg1.l6.m1.3.3.3.3">
            subscript
           </csymbol>
           <ci id="alg1.l6.m1.3.3.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.3.2">
            𝑥
           </ci>
           <ci id="alg1.l6.m1.3.3.3.3.3.cmml" xref="alg1.l6.m1.3.3.3.3.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l6.m1.4.4.4.4.cmml" xref="alg1.l6.m1.4.4.4.4">
           <csymbol cd="ambiguous" id="alg1.l6.m1.4.4.4.4.1.cmml" xref="alg1.l6.m1.4.4.4.4">
            subscript
           </csymbol>
           <ci id="alg1.l6.m1.4.4.4.4.2.cmml" xref="alg1.l6.m1.4.4.4.4.2">
            𝑢
           </ci>
           <ci id="alg1.l6.m1.4.4.4.4.3.cmml" xref="alg1.l6.m1.4.4.4.4.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l6.m1.5.5.5.5.cmml" xref="alg1.l6.m1.5.5.5.5">
           <csymbol cd="ambiguous" id="alg1.l6.m1.5.5.5.5.1.cmml" xref="alg1.l6.m1.5.5.5.5">
            subscript
           </csymbol>
           <ci id="alg1.l6.m1.5.5.5.5.2.cmml" xref="alg1.l6.m1.5.5.5.5.2">
            𝑎
           </ci>
           <ci id="alg1.l6.m1.5.5.5.5.3.cmml" xref="alg1.l6.m1.5.5.5.5.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l6.m1.6.6.6.6.cmml" xref="alg1.l6.m1.6.6.6.6">
           <csymbol cd="ambiguous" id="alg1.l6.m1.6.6.6.6.1.cmml" xref="alg1.l6.m1.6.6.6.6">
            subscript
           </csymbol>
           <apply id="alg1.l6.m1.6.6.6.6.2.cmml" xref="alg1.l6.m1.6.6.6.6">
            <csymbol cd="ambiguous" id="alg1.l6.m1.6.6.6.6.2.1.cmml" xref="alg1.l6.m1.6.6.6.6">
             superscript
            </csymbol>
            <ci id="alg1.l6.m1.6.6.6.6.2.2.cmml" xref="alg1.l6.m1.6.6.6.6.2.2">
             𝑔
            </ci>
            <ci id="alg1.l6.m1.6.6.6.6.2.3.cmml" xref="alg1.l6.m1.6.6.6.6.2.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l6.m1.6.6.6.6.3.cmml" xref="alg1.l6.m1.6.6.6.6.3">
            <ci id="alg1.l6.m1.6.6.6.6.3.1.cmml" xref="alg1.l6.m1.6.6.6.6.3.1">
             :
            </ci>
            <cn id="alg1.l6.m1.6.6.6.6.3.2.cmml" type="integer" xref="alg1.l6.m1.6.6.6.6.3.2">
             1
            </cn>
            <ci id="alg1.l6.m1.6.6.6.6.3.3.cmml" xref="alg1.l6.m1.6.6.6.6.3.3">
             𝐾
            </ci>
           </apply>
          </apply>
         </vector>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m1.6c">
         \left(r_{t},c_{t},x_{t},u_{t},a_{t},g^{t}_{1:K}\right)
        </annotation>
       </semantics>
      </math>
      to replay buffer.
     </div>
     <div class="ltx_listingline" id="alg1.l7">
      <span class="ltx_text ltx_font_bold" id="alg1.l7.1">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l7.2">
       while
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l8">
      <span class="ltx_text ltx_font_bold" id="alg1.l8.1">
       while
      </span>
      training
      <span class="ltx_text ltx_font_bold" id="alg1.l8.2">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l9">
      Draw batch
      <math alttext="\left\{\left(r_{t},c_{t},x_{t},u_{t},a_{t},g^{t}_{1:K}\right)\right\}" class="ltx_Math" display="inline" id="alg1.l9.m1.1">
       <semantics id="alg1.l9.m1.1a">
        <mrow id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.2.cmml">
         <mo id="alg1.l9.m1.1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">
          {
         </mo>
         <mrow id="alg1.l9.m1.1.1.1.1.6" xref="alg1.l9.m1.1.1.1.1.7.cmml">
          <mo id="alg1.l9.m1.1.1.1.1.6.7" xref="alg1.l9.m1.1.1.1.1.7.cmml">
           (
          </mo>
          <msub id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">
           <mi id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml">
            r
           </mi>
           <mi id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l9.m1.1.1.1.1.6.8" xref="alg1.l9.m1.1.1.1.1.7.cmml">
           ,
          </mo>
          <msub id="alg1.l9.m1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.2.2.cmml">
           <mi id="alg1.l9.m1.1.1.1.1.2.2.2" xref="alg1.l9.m1.1.1.1.1.2.2.2.cmml">
            c
           </mi>
           <mi id="alg1.l9.m1.1.1.1.1.2.2.3" xref="alg1.l9.m1.1.1.1.1.2.2.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l9.m1.1.1.1.1.6.9" xref="alg1.l9.m1.1.1.1.1.7.cmml">
           ,
          </mo>
          <msub id="alg1.l9.m1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.3.3.cmml">
           <mi id="alg1.l9.m1.1.1.1.1.3.3.2" xref="alg1.l9.m1.1.1.1.1.3.3.2.cmml">
            x
           </mi>
           <mi id="alg1.l9.m1.1.1.1.1.3.3.3" xref="alg1.l9.m1.1.1.1.1.3.3.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l9.m1.1.1.1.1.6.10" xref="alg1.l9.m1.1.1.1.1.7.cmml">
           ,
          </mo>
          <msub id="alg1.l9.m1.1.1.1.1.4.4" xref="alg1.l9.m1.1.1.1.1.4.4.cmml">
           <mi id="alg1.l9.m1.1.1.1.1.4.4.2" xref="alg1.l9.m1.1.1.1.1.4.4.2.cmml">
            u
           </mi>
           <mi id="alg1.l9.m1.1.1.1.1.4.4.3" xref="alg1.l9.m1.1.1.1.1.4.4.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l9.m1.1.1.1.1.6.11" xref="alg1.l9.m1.1.1.1.1.7.cmml">
           ,
          </mo>
          <msub id="alg1.l9.m1.1.1.1.1.5.5" xref="alg1.l9.m1.1.1.1.1.5.5.cmml">
           <mi id="alg1.l9.m1.1.1.1.1.5.5.2" xref="alg1.l9.m1.1.1.1.1.5.5.2.cmml">
            a
           </mi>
           <mi id="alg1.l9.m1.1.1.1.1.5.5.3" xref="alg1.l9.m1.1.1.1.1.5.5.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l9.m1.1.1.1.1.6.12" xref="alg1.l9.m1.1.1.1.1.7.cmml">
           ,
          </mo>
          <msubsup id="alg1.l9.m1.1.1.1.1.6.6" xref="alg1.l9.m1.1.1.1.1.6.6.cmml">
           <mi id="alg1.l9.m1.1.1.1.1.6.6.2.2" xref="alg1.l9.m1.1.1.1.1.6.6.2.2.cmml">
            g
           </mi>
           <mrow id="alg1.l9.m1.1.1.1.1.6.6.3" xref="alg1.l9.m1.1.1.1.1.6.6.3.cmml">
            <mn id="alg1.l9.m1.1.1.1.1.6.6.3.2" xref="alg1.l9.m1.1.1.1.1.6.6.3.2.cmml">
             1
            </mn>
            <mo id="alg1.l9.m1.1.1.1.1.6.6.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l9.m1.1.1.1.1.6.6.3.1.cmml">
             :
            </mo>
            <mi id="alg1.l9.m1.1.1.1.1.6.6.3.3" xref="alg1.l9.m1.1.1.1.1.6.6.3.3.cmml">
             K
            </mi>
           </mrow>
           <mi id="alg1.l9.m1.1.1.1.1.6.6.2.3" xref="alg1.l9.m1.1.1.1.1.6.6.2.3.cmml">
            t
           </mi>
          </msubsup>
          <mo id="alg1.l9.m1.1.1.1.1.6.13" xref="alg1.l9.m1.1.1.1.1.7.cmml">
           )
          </mo>
         </mrow>
         <mo id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.1.1.2.cmml">
          }
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b">
         <set id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1">
          <vector id="alg1.l9.m1.1.1.1.1.7.cmml" xref="alg1.l9.m1.1.1.1.1.6">
           <apply id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="alg1.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2">
             𝑟
            </ci>
            <ci id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l9.m1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.2.2">
            <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.2.2">
             subscript
            </csymbol>
            <ci id="alg1.l9.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.2.2.2">
             𝑐
            </ci>
            <ci id="alg1.l9.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.2.2.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l9.m1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.3.3">
            <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.3.3">
             subscript
            </csymbol>
            <ci id="alg1.l9.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.3.3.2">
             𝑥
            </ci>
            <ci id="alg1.l9.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.3.3.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l9.m1.1.1.1.1.4.4.cmml" xref="alg1.l9.m1.1.1.1.1.4.4">
            <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.4.4.1.cmml" xref="alg1.l9.m1.1.1.1.1.4.4">
             subscript
            </csymbol>
            <ci id="alg1.l9.m1.1.1.1.1.4.4.2.cmml" xref="alg1.l9.m1.1.1.1.1.4.4.2">
             𝑢
            </ci>
            <ci id="alg1.l9.m1.1.1.1.1.4.4.3.cmml" xref="alg1.l9.m1.1.1.1.1.4.4.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l9.m1.1.1.1.1.5.5.cmml" xref="alg1.l9.m1.1.1.1.1.5.5">
            <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.5.5.1.cmml" xref="alg1.l9.m1.1.1.1.1.5.5">
             subscript
            </csymbol>
            <ci id="alg1.l9.m1.1.1.1.1.5.5.2.cmml" xref="alg1.l9.m1.1.1.1.1.5.5.2">
             𝑎
            </ci>
            <ci id="alg1.l9.m1.1.1.1.1.5.5.3.cmml" xref="alg1.l9.m1.1.1.1.1.5.5.3">
             𝑡
            </ci>
           </apply>
           <apply id="alg1.l9.m1.1.1.1.1.6.6.cmml" xref="alg1.l9.m1.1.1.1.1.6.6">
            <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.6.6.1.cmml" xref="alg1.l9.m1.1.1.1.1.6.6">
             subscript
            </csymbol>
            <apply id="alg1.l9.m1.1.1.1.1.6.6.2.cmml" xref="alg1.l9.m1.1.1.1.1.6.6">
             <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.6.6.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.6.6">
              superscript
             </csymbol>
             <ci id="alg1.l9.m1.1.1.1.1.6.6.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.6.6.2.2">
              𝑔
             </ci>
             <ci id="alg1.l9.m1.1.1.1.1.6.6.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.6.6.2.3">
              𝑡
             </ci>
            </apply>
            <apply id="alg1.l9.m1.1.1.1.1.6.6.3.cmml" xref="alg1.l9.m1.1.1.1.1.6.6.3">
             <ci id="alg1.l9.m1.1.1.1.1.6.6.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.6.6.3.1">
              :
             </ci>
             <cn id="alg1.l9.m1.1.1.1.1.6.6.3.2.cmml" type="integer" xref="alg1.l9.m1.1.1.1.1.6.6.3.2">
              1
             </cn>
             <ci id="alg1.l9.m1.1.1.1.1.6.6.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.6.6.3.3">
              𝐾
             </ci>
            </apply>
           </apply>
          </vector>
         </set>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l9.m1.1c">
         \left\{\left(r_{t},c_{t},x_{t},u_{t},a_{t},g^{t}_{1:K}\right)\right\}
        </annotation>
       </semantics>
      </math>
      from replay buffer.
     </div>
     <div class="ltx_listingline" id="alg1.l10">
      Calculate intrinsic rewards
      <math alttext="i_{1:K}" class="ltx_Math" display="inline" id="alg1.l10.m1.1">
       <semantics id="alg1.l10.m1.1a">
        <msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">
         <mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">
          i
         </mi>
         <mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">
          <mn id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">
           1
          </mn>
          <mo id="alg1.l10.m1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l10.m1.1.1.3.1.cmml">
           :
          </mo>
          <mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">
           K
          </mi>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b">
         <apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">
           𝑖
          </ci>
          <apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">
           <ci id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1">
            :
           </ci>
           <cn id="alg1.l10.m1.1.1.3.2.cmml" type="integer" xref="alg1.l10.m1.1.1.3.2">
            1
           </cn>
           <ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">
            𝐾
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l10.m1.1c">
         i_{1:K}
        </annotation>
       </semantics>
      </math>
      for each goal using the RND method and update the RND network.
     </div>
     <div class="ltx_listingline" id="alg1.l11">
      Use world model to compute representations
      <math alttext="{z}_{t}" class="ltx_Math" display="inline" id="alg1.l11.m1.1">
       <semantics id="alg1.l11.m1.1a">
        <msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">
         <mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">
          z
         </mi>
         <mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">
          t
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b">
         <apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">
           𝑧
          </ci>
          <ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l11.m1.1c">
         {z}_{t}
        </annotation>
       </semantics>
      </math>
      , future predictions
      <math alttext="\hat{z}_{t+1}" class="ltx_Math" display="inline" id="alg1.l11.m2.1">
       <semantics id="alg1.l11.m2.1a">
        <msub id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml">
         <mover accent="true" id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">
          <mi id="alg1.l11.m2.1.1.2.2" xref="alg1.l11.m2.1.1.2.2.cmml">
           z
          </mi>
          <mo id="alg1.l11.m2.1.1.2.1" xref="alg1.l11.m2.1.1.2.1.cmml">
           ^
          </mo>
         </mover>
         <mrow id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">
          <mi id="alg1.l11.m2.1.1.3.2" xref="alg1.l11.m2.1.1.3.2.cmml">
           t
          </mi>
          <mo id="alg1.l11.m2.1.1.3.1" xref="alg1.l11.m2.1.1.3.1.cmml">
           +
          </mo>
          <mn id="alg1.l11.m2.1.1.3.3" xref="alg1.l11.m2.1.1.3.3.cmml">
           1
          </mn>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b">
         <apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">
           subscript
          </csymbol>
          <apply id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">
           <ci id="alg1.l11.m2.1.1.2.1.cmml" xref="alg1.l11.m2.1.1.2.1">
            ^
           </ci>
           <ci id="alg1.l11.m2.1.1.2.2.cmml" xref="alg1.l11.m2.1.1.2.2">
            𝑧
           </ci>
          </apply>
          <apply id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">
           <plus id="alg1.l11.m2.1.1.3.1.cmml" xref="alg1.l11.m2.1.1.3.1">
           </plus>
           <ci id="alg1.l11.m2.1.1.3.2.cmml" xref="alg1.l11.m2.1.1.3.2">
            𝑡
           </ci>
           <cn id="alg1.l11.m2.1.1.3.3.cmml" type="integer" xref="alg1.l11.m2.1.1.3.3">
            1
           </cn>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l11.m2.1c">
         \hat{z}_{t+1}
        </annotation>
       </semantics>
      </math>
      , and decode
      <math alttext="\hat{x}_{t},\hat{u}_{t},\hat{r}_{t},\hat{c}_{t}" class="ltx_Math" display="inline" id="alg1.l11.m3.4">
       <semantics id="alg1.l11.m3.4a">
        <mrow id="alg1.l11.m3.4.4.4" xref="alg1.l11.m3.4.4.5.cmml">
         <msub id="alg1.l11.m3.1.1.1.1" xref="alg1.l11.m3.1.1.1.1.cmml">
          <mover accent="true" id="alg1.l11.m3.1.1.1.1.2" xref="alg1.l11.m3.1.1.1.1.2.cmml">
           <mi id="alg1.l11.m3.1.1.1.1.2.2" xref="alg1.l11.m3.1.1.1.1.2.2.cmml">
            x
           </mi>
           <mo id="alg1.l11.m3.1.1.1.1.2.1" xref="alg1.l11.m3.1.1.1.1.2.1.cmml">
            ^
           </mo>
          </mover>
          <mi id="alg1.l11.m3.1.1.1.1.3" xref="alg1.l11.m3.1.1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l11.m3.4.4.4.5" xref="alg1.l11.m3.4.4.5.cmml">
          ,
         </mo>
         <msub id="alg1.l11.m3.2.2.2.2" xref="alg1.l11.m3.2.2.2.2.cmml">
          <mover accent="true" id="alg1.l11.m3.2.2.2.2.2" xref="alg1.l11.m3.2.2.2.2.2.cmml">
           <mi id="alg1.l11.m3.2.2.2.2.2.2" xref="alg1.l11.m3.2.2.2.2.2.2.cmml">
            u
           </mi>
           <mo id="alg1.l11.m3.2.2.2.2.2.1" xref="alg1.l11.m3.2.2.2.2.2.1.cmml">
            ^
           </mo>
          </mover>
          <mi id="alg1.l11.m3.2.2.2.2.3" xref="alg1.l11.m3.2.2.2.2.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l11.m3.4.4.4.6" xref="alg1.l11.m3.4.4.5.cmml">
          ,
         </mo>
         <msub id="alg1.l11.m3.3.3.3.3" xref="alg1.l11.m3.3.3.3.3.cmml">
          <mover accent="true" id="alg1.l11.m3.3.3.3.3.2" xref="alg1.l11.m3.3.3.3.3.2.cmml">
           <mi id="alg1.l11.m3.3.3.3.3.2.2" xref="alg1.l11.m3.3.3.3.3.2.2.cmml">
            r
           </mi>
           <mo id="alg1.l11.m3.3.3.3.3.2.1" xref="alg1.l11.m3.3.3.3.3.2.1.cmml">
            ^
           </mo>
          </mover>
          <mi id="alg1.l11.m3.3.3.3.3.3" xref="alg1.l11.m3.3.3.3.3.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l11.m3.4.4.4.7" xref="alg1.l11.m3.4.4.5.cmml">
          ,
         </mo>
         <msub id="alg1.l11.m3.4.4.4.4" xref="alg1.l11.m3.4.4.4.4.cmml">
          <mover accent="true" id="alg1.l11.m3.4.4.4.4.2" xref="alg1.l11.m3.4.4.4.4.2.cmml">
           <mi id="alg1.l11.m3.4.4.4.4.2.2" xref="alg1.l11.m3.4.4.4.4.2.2.cmml">
            c
           </mi>
           <mo id="alg1.l11.m3.4.4.4.4.2.1" xref="alg1.l11.m3.4.4.4.4.2.1.cmml">
            ^
           </mo>
          </mover>
          <mi id="alg1.l11.m3.4.4.4.4.3" xref="alg1.l11.m3.4.4.4.4.3.cmml">
           t
          </mi>
         </msub>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l11.m3.4b">
         <list id="alg1.l11.m3.4.4.5.cmml" xref="alg1.l11.m3.4.4.4">
          <apply id="alg1.l11.m3.1.1.1.1.cmml" xref="alg1.l11.m3.1.1.1.1">
           <csymbol cd="ambiguous" id="alg1.l11.m3.1.1.1.1.1.cmml" xref="alg1.l11.m3.1.1.1.1">
            subscript
           </csymbol>
           <apply id="alg1.l11.m3.1.1.1.1.2.cmml" xref="alg1.l11.m3.1.1.1.1.2">
            <ci id="alg1.l11.m3.1.1.1.1.2.1.cmml" xref="alg1.l11.m3.1.1.1.1.2.1">
             ^
            </ci>
            <ci id="alg1.l11.m3.1.1.1.1.2.2.cmml" xref="alg1.l11.m3.1.1.1.1.2.2">
             𝑥
            </ci>
           </apply>
           <ci id="alg1.l11.m3.1.1.1.1.3.cmml" xref="alg1.l11.m3.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l11.m3.2.2.2.2.cmml" xref="alg1.l11.m3.2.2.2.2">
           <csymbol cd="ambiguous" id="alg1.l11.m3.2.2.2.2.1.cmml" xref="alg1.l11.m3.2.2.2.2">
            subscript
           </csymbol>
           <apply id="alg1.l11.m3.2.2.2.2.2.cmml" xref="alg1.l11.m3.2.2.2.2.2">
            <ci id="alg1.l11.m3.2.2.2.2.2.1.cmml" xref="alg1.l11.m3.2.2.2.2.2.1">
             ^
            </ci>
            <ci id="alg1.l11.m3.2.2.2.2.2.2.cmml" xref="alg1.l11.m3.2.2.2.2.2.2">
             𝑢
            </ci>
           </apply>
           <ci id="alg1.l11.m3.2.2.2.2.3.cmml" xref="alg1.l11.m3.2.2.2.2.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l11.m3.3.3.3.3.cmml" xref="alg1.l11.m3.3.3.3.3">
           <csymbol cd="ambiguous" id="alg1.l11.m3.3.3.3.3.1.cmml" xref="alg1.l11.m3.3.3.3.3">
            subscript
           </csymbol>
           <apply id="alg1.l11.m3.3.3.3.3.2.cmml" xref="alg1.l11.m3.3.3.3.3.2">
            <ci id="alg1.l11.m3.3.3.3.3.2.1.cmml" xref="alg1.l11.m3.3.3.3.3.2.1">
             ^
            </ci>
            <ci id="alg1.l11.m3.3.3.3.3.2.2.cmml" xref="alg1.l11.m3.3.3.3.3.2.2">
             𝑟
            </ci>
           </apply>
           <ci id="alg1.l11.m3.3.3.3.3.3.cmml" xref="alg1.l11.m3.3.3.3.3.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l11.m3.4.4.4.4.cmml" xref="alg1.l11.m3.4.4.4.4">
           <csymbol cd="ambiguous" id="alg1.l11.m3.4.4.4.4.1.cmml" xref="alg1.l11.m3.4.4.4.4">
            subscript
           </csymbol>
           <apply id="alg1.l11.m3.4.4.4.4.2.cmml" xref="alg1.l11.m3.4.4.4.4.2">
            <ci id="alg1.l11.m3.4.4.4.4.2.1.cmml" xref="alg1.l11.m3.4.4.4.4.2.1">
             ^
            </ci>
            <ci id="alg1.l11.m3.4.4.4.4.2.2.cmml" xref="alg1.l11.m3.4.4.4.4.2.2">
             𝑐
            </ci>
           </apply>
           <ci id="alg1.l11.m3.4.4.4.4.3.cmml" xref="alg1.l11.m3.4.4.4.4.3">
            𝑡
           </ci>
          </apply>
         </list>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l11.m3.4c">
         \hat{x}_{t},\hat{u}_{t},\hat{r}_{t},\hat{c}_{t}
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l12">
      Update world model to minimize
      <math alttext="\mathcal{L}_{\rm total}" class="ltx_Math" display="inline" id="alg1.l12.m1.1">
       <semantics id="alg1.l12.m1.1a">
        <msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">
          ℒ
         </mi>
         <mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">
          total
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b">
         <apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">
           ℒ
          </ci>
          <ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">
           total
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l12.m1.1c">
         \mathcal{L}_{\rm total}
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l13">
      Imagine rollouts from all
      <math alttext="z_{t}" class="ltx_Math" display="inline" id="alg1.l13.m1.1">
       <semantics id="alg1.l13.m1.1a">
        <msub id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">
         <mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">
          z
         </mi>
         <mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">
          t
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b">
         <apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">
           𝑧
          </ci>
          <ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l13.m1.1c">
         z_{t}
        </annotation>
       </semantics>
      </math>
      using
      <math alttext="\pi" class="ltx_Math" display="inline" id="alg1.l13.m2.1">
       <semantics id="alg1.l13.m2.1a">
        <mi id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml">
         π
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b">
         <ci id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">
          𝜋
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l13.m2.1c">
         \pi
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l14">
      Calculate match scores
      <math alttext="w" class="ltx_Math" display="inline" id="alg1.l14.m1.1">
       <semantics id="alg1.l14.m1.1a">
        <mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">
         w
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b">
         <ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">
          𝑤
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l14.m1.1c">
         w
        </annotation>
       </semantics>
      </math>
      and the intrinsic reward
      <math alttext="r^{\rm int}" class="ltx_Math" display="inline" id="alg1.l14.m2.1">
       <semantics id="alg1.l14.m2.1a">
        <msup id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml">
         <mi id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml">
          r
         </mi>
         <mi id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml">
          int
         </mi>
        </msup>
        <annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b">
         <apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1">
           superscript
          </csymbol>
          <ci id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">
           𝑟
          </ci>
          <ci id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3">
           int
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l14.m2.1c">
         r^{\rm int}
        </annotation>
       </semantics>
      </math>
      for each step.
     </div>
     <div class="ltx_listingline" id="alg1.l15">
      Update actor to minimize
      <math alttext="\mathcal{L}_{\pi}" class="ltx_Math" display="inline" id="alg1.l15.m1.1">
       <semantics id="alg1.l15.m1.1a">
        <msub id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">
          ℒ
         </mi>
         <mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">
          π
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b">
         <apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">
           ℒ
          </ci>
          <ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">
           𝜋
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l15.m1.1c">
         \mathcal{L}_{\pi}
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l16">
      Update critic to minimize
      <math alttext="\mathcal{L}_{V}" class="ltx_Math" display="inline" id="alg1.l16.m1.1">
       <semantics id="alg1.l16.m1.1a">
        <msub id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">
          ℒ
         </mi>
         <mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml">
          V
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b">
         <apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">
           ℒ
          </ci>
          <ci id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">
           𝑉
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l16.m1.1c">
         \mathcal{L}_{V}
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l17">
      <span class="ltx_text ltx_font_bold" id="alg1.l17.1">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l17.2">
       while
      </span>
     </div>
    </div>
   </figure>
  </section>
 </section>
 <section class="ltx_appendix" id="A3">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix C
   </span>
   Details of Captioners
  </h2>
  <div class="ltx_para" id="A3.p1">
   <p class="ltx_p" id="A3.p1.1">
    For the implementation of the captioners, DLLM generally follows ELLM
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#biba.bib13" title="">
      13
     </a>
     ]
    </cite>
    , except that we use trained transition captioners throughout all our experiments to get the language description of the dynamics between two observations. We split the captions into two different parts: semantic parts and dynamic parts.
   </p>
  </div>
  <section class="ltx_subsection" id="A3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.1
    </span>
    Hard-coded Captioner for Semantic Parts
   </h3>
   <div class="ltx_para" id="A3.SS1.p1">
    <p class="ltx_p" id="A3.SS1.p1.1">
     The captioner of semantic parts follows the hard-coded captioner implementation outlined in Appendix I of ELLM
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib13" title="">
       13
      </a>
      ]
     </cite>
     . The overall semantic captions include the following categories:
    </p>
    <ul class="ltx_itemize" id="A3.I1">
     <li class="ltx_item" id="A3.I1.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="A3.I1.i1.p1">
       <p class="ltx_p" id="A3.I1.i1.p1.1">
        <span class="ltx_text ltx_font_bold" id="A3.I1.i1.p1.1.1">
         Field of view.
        </span>
        In the grid world environments (HomeGrid and Crafter), we collect the text description of all the interactable objects in the agent’s view, regardless of the object’s quantity, to form the caption for this section. Similarly, in the Minecraft environment, we obtain the list of all visible objects from the simulator’s semantic sensor.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="A3.I1.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="A3.I1.i2.p1">
       <p class="ltx_p" id="A3.I1.i2.p1.1">
        <span class="ltx_text ltx_font_bold" id="A3.I1.i2.p1.1.1">
         Inventory.
        </span>
        For HomeGrid, this will only include the item the robot carries. For Crafter and Minecraft, we convert each inventory item to the corresponding text descriptor. For Minecraft, we get this information directly from interpreting the observation.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="A3.I1.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="A3.I1.i3.p1">
       <p class="ltx_p" id="A3.I1.i3.p1.1">
        <span class="ltx_text ltx_font_bold" id="A3.I1.i3.p1.1.1">
         Health Status.
        </span>
        In Crafter and Minecraft, if any health statuses are below the maximum, we convert each to a corresponding language description (e.g., we say the agent is “hungry” if the hunger status is less than 9). There is no such information in HomeGrid, so we do not provide related captions. Note that the observation directly gives related information in Minecraft, so we simply translate them into natural language.
       </p>
      </div>
     </li>
    </ul>
   </div>
  </section>
  <section class="ltx_subsection" id="A3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     C.2
    </span>
    Trained Transition Captioner for Dynamics Parts
   </h3>
   <div class="ltx_para" id="A3.SS2.p1">
    <p class="ltx_p" id="A3.SS2.p1.1">
     The captioner for transitions (dynamics parts) is designed to translate the dynamics between two adjacent observations into natural language form. For convenience, we modify the original simulator to generate language labels for the training of the transition captioner. All language labels use a predetermined and fixed format established by humans. These language labels succinctly describe the dynamics of the environment in the most straightforward manner possible. Notably, these human-designed labels aid the agent in utilizing a similar approach to describe the environment dynamics with concise key words. The designs of all possible formats of language descriptions for transitions in each environment are as follows:
    </p>
   </div>
   <div class="ltx_para" id="A3.SS2.p2">
    <ul class="ltx_itemize" id="A3.I2">
     <li class="ltx_item" id="A3.I2.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="A3.I2.i1.p1">
       <p class="ltx_p" id="A3.I2.i1.p1.1">
        <span class="ltx_text ltx_font_bold" id="A3.I2.i1.p1.1.1">
         HomeGrid.
        </span>
       </p>
       <ul class="ltx_itemize" id="A3.I2.i1.I1">
        <li class="ltx_item" id="A3.I2.i1.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="A3.I2.i1.I1.i1.1.1.1">
           –
          </span>
         </span>
         <div class="ltx_para" id="A3.I2.i1.I1.i1.p1">
          <p class="ltx_p" id="A3.I2.i1.I1.i1.p1.1">
           <span class="ltx_text ltx_font_typewriter" id="A3.I2.i1.I1.i1.p1.1.1">
            go to the [room].
           </span>
          </p>
         </div>
        </li>
        <li class="ltx_item" id="A3.I2.i1.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="A3.I2.i1.I1.i2.1.1.1">
           –
          </span>
         </span>
         <div class="ltx_para" id="A3.I2.i1.I1.i2.p1">
          <p class="ltx_p" id="A3.I2.i1.I1.i2.p1.1">
           <span class="ltx_text ltx_font_typewriter" id="A3.I2.i1.I1.i2.p1.1.1">
            [action] the [object]. (e.g., pick up the plates)
           </span>
          </p>
         </div>
        </li>
        <li class="ltx_item" id="A3.I2.i1.I1.i3" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="A3.I2.i1.I1.i3.1.1.1">
           –
          </span>
         </span>
         <div class="ltx_para" id="A3.I2.i1.I1.i3.p1">
          <p class="ltx_p" id="A3.I2.i1.I1.i3.p1.1">
           <span class="ltx_text ltx_font_typewriter" id="A3.I2.i1.I1.i3.p1.1.1">
            [action] to [change the status of] (e.g., open) the [bin].
           </span>
          </p>
         </div>
        </li>
        <li class="ltx_item" id="A3.I2.i1.I1.i4" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="A3.I2.i1.I1.i4.1.1.1">
           –
          </span>
         </span>
         <div class="ltx_para" id="A3.I2.i1.I1.i4.p1">
          <p class="ltx_p" id="A3.I2.i1.I1.i4.p1.1">
           <span class="ltx_text ltx_font_typewriter" id="A3.I2.i1.I1.i4.p1.1.1">
            [action] the [object] in/to the [bin/room].
           </span>
          </p>
         </div>
        </li>
       </ul>
      </div>
     </li>
     <li class="ltx_item" id="A3.I2.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="A3.I2.i2.p1">
       <p class="ltx_p" id="A3.I2.i2.p1.1">
        <span class="ltx_text ltx_font_bold" id="A3.I2.i2.p1.1.1">
         Crafter.
        </span>
       </p>
       <ul class="ltx_itemize" id="A3.I2.i2.I1">
        <li class="ltx_item" id="A3.I2.i2.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="A3.I2.i2.I1.i1.1.1.1">
           –
          </span>
         </span>
         <div class="ltx_para" id="A3.I2.i2.I1.i1.p1">
          <p class="ltx_p" id="A3.I2.i2.I1.i1.p1.1">
           <span class="ltx_text ltx_font_typewriter" id="A3.I2.i2.I1.i1.p1.1.1">
            [action] (e.g., sleep, wake up)
           </span>
          </p>
         </div>
        </li>
        <li class="ltx_item" id="A3.I2.i2.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="A3.I2.i2.I1.i2.1.1.1">
           –
          </span>
         </span>
         <div class="ltx_para" id="A3.I2.i2.I1.i2.p1">
          <p class="ltx_p" id="A3.I2.i2.I1.i2.p1.1">
           <span class="ltx_text ltx_font_typewriter" id="A3.I2.i2.I1.i2.p1.1.1">
            [action] the [item/object]. (e.g., attack the zombie)
           </span>
          </p>
         </div>
        </li>
       </ul>
      </div>
     </li>
     <li class="ltx_item" id="A3.I2.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="A3.I2.i3.p1">
       <p class="ltx_p" id="A3.I2.i3.p1.1">
        <span class="ltx_text ltx_font_bold" id="A3.I2.i3.p1.1.1">
         Minecraft.
        </span>
       </p>
       <ul class="ltx_itemize" id="A3.I2.i3.I1">
        <li class="ltx_item" id="A3.I2.i3.I1.i1" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="A3.I2.i3.I1.i1.1.1.1">
           –
          </span>
         </span>
         <div class="ltx_para" id="A3.I2.i3.I1.i1.p1">
          <p class="ltx_p" id="A3.I2.i3.I1.i1.p1.1">
           <span class="ltx_text ltx_font_typewriter" id="A3.I2.i3.I1.i1.p1.1.1">
            [action] (e.g., forward, jump, sneak)
           </span>
          </p>
         </div>
        </li>
        <li class="ltx_item" id="A3.I2.i3.I1.i2" style="list-style-type:none;">
         <span class="ltx_tag ltx_tag_item">
          <span class="ltx_text ltx_font_bold" id="A3.I2.i3.I1.i2.1.1.1">
           –
          </span>
         </span>
         <div class="ltx_para" id="A3.I2.i3.I1.i2.p1">
          <p class="ltx_p" id="A3.I2.i3.I1.i2.p1.1">
           <span class="ltx_text ltx_font_typewriter" id="A3.I2.i3.I1.i2.p1.1.1">
            [action] the [object]. (e.g., craft the torch)
           </span>
          </p>
         </div>
        </li>
       </ul>
      </div>
     </li>
    </ul>
   </div>
   <div class="ltx_para" id="A3.SS2.p3">
    <p class="ltx_p" id="A3.SS2.p3.2">
     The training process of the captioner mainly follows the methodology outlined in Appendix J of ELLM
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib13" title="">
       13
      </a>
      ]
     </cite>
     ; we similarly apply a modified ClipCap algorithm
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib37" title="">
       37
      </a>
      ]
     </cite>
     to datasets of trajectories generated by trained agents, with details provided in Table
     <a class="ltx_ref" href="#A3.T4" title="Table 4 ‣ C.2 Trained Transition Captioner for Dynamics Parts ‣ Appendix C Details of Captioners ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     . Specifically, we embed the visual observations at timestep
     <math alttext="t" class="ltx_Math" display="inline" id="A3.SS2.p3.1.m1.1">
      <semantics id="A3.SS2.p3.1.m1.1a">
       <mi id="A3.SS2.p3.1.m1.1.1" xref="A3.SS2.p3.1.m1.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="A3.SS2.p3.1.m1.1b">
        <ci id="A3.SS2.p3.1.m1.1.1.cmml" xref="A3.SS2.p3.1.m1.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS2.p3.1.m1.1c">
        t
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="t+1" class="ltx_Math" display="inline" id="A3.SS2.p3.2.m2.1">
      <semantics id="A3.SS2.p3.2.m2.1a">
       <mrow id="A3.SS2.p3.2.m2.1.1" xref="A3.SS2.p3.2.m2.1.1.cmml">
        <mi id="A3.SS2.p3.2.m2.1.1.2" xref="A3.SS2.p3.2.m2.1.1.2.cmml">
         t
        </mi>
        <mo id="A3.SS2.p3.2.m2.1.1.1" xref="A3.SS2.p3.2.m2.1.1.1.cmml">
         +
        </mo>
        <mn id="A3.SS2.p3.2.m2.1.1.3" xref="A3.SS2.p3.2.m2.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A3.SS2.p3.2.m2.1b">
        <apply id="A3.SS2.p3.2.m2.1.1.cmml" xref="A3.SS2.p3.2.m2.1.1">
         <plus id="A3.SS2.p3.2.m2.1.1.1.cmml" xref="A3.SS2.p3.2.m2.1.1.1">
         </plus>
         <ci id="A3.SS2.p3.2.m2.1.1.2.cmml" xref="A3.SS2.p3.2.m2.1.1.2">
          𝑡
         </ci>
         <cn id="A3.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="A3.SS2.p3.2.m2.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A3.SS2.p3.2.m2.1c">
        t+1
       </annotation>
      </semantics>
     </math>
     with a pre-trained and frozen CLIP ViT-B-32 model
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib41" title="">
       41
      </a>
      ]
     </cite>
     ; the embedding is then concatenated together with the difference in semantic embeddings between the corresponding states. Semantic embeddings encompass the inventory and a multi-hot embedding of the set of objects/creatures present in the agent’s local view. The concatenated representation of the transition is then mapped through a learned mapping function to a sequence of 32 tokens. We use these tokens as a prefix and decode them with a trained and frozen GPT-2 to generate the caption
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#biba.bib42" title="">
       42
      </a>
      ]
     </cite>
     .
    </p>
   </div>
   <figure class="ltx_table" id="A3.T4">
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 4:
     </span>
     The algorithm used to generate samples, total steps, and scale of the generated dataset for each environment are as follows. We capture one sample every 1K steps during training.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T4.4">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="A3.T4.4.1.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T4.4.1.1.1">
        <span class="ltx_text" id="A3.T4.4.1.1.1.1" style="font-size:90%;">
         Environment
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T4.4.1.1.2">
        <span class="ltx_text" id="A3.T4.4.1.1.2.1" style="font-size:90%;">
         Algorithm
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T4.4.1.1.3">
        <span class="ltx_text" id="A3.T4.4.1.1.3.1" style="font-size:90%;">
         Steps
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T4.4.1.1.4">
        <span class="ltx_text" id="A3.T4.4.1.1.4.1" style="font-size:90%;">
         Scale
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A3.T4.4.2.1">
       <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T4.4.2.1.1">
        <span class="ltx_text" id="A3.T4.4.2.1.1.1" style="font-size:90%;">
         HomeGrid
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T4.4.2.1.2">
        <span class="ltx_text" id="A3.T4.4.2.1.2.1" style="font-size:90%;">
         Dynalang
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T4.4.2.1.3">
        <span class="ltx_text" id="A3.T4.4.2.1.3.1" style="font-size:90%;">
         10M
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A3.T4.4.2.1.4">
        <span class="ltx_text" id="A3.T4.4.2.1.4.1" style="font-size:90%;">
         10K
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A3.T4.4.3.2">
       <td class="ltx_td ltx_align_center" id="A3.T4.4.3.2.1">
        <span class="ltx_text" id="A3.T4.4.3.2.1.1" style="font-size:90%;">
         Crafter
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="A3.T4.4.3.2.2">
        <span class="ltx_text" id="A3.T4.4.3.2.2.1" style="font-size:90%;">
         Achievement Distillation
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="A3.T4.4.3.2.3">
        <span class="ltx_text" id="A3.T4.4.3.2.3.1" style="font-size:90%;">
         1M
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="A3.T4.4.3.2.4">
        <span class="ltx_text" id="A3.T4.4.3.2.4.1" style="font-size:90%;">
         1K
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A3.T4.4.4.3">
       <td class="ltx_td ltx_align_center ltx_border_b" id="A3.T4.4.4.3.1">
        <span class="ltx_text" id="A3.T4.4.4.3.1.1" style="font-size:90%;">
         Minecraft
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="A3.T4.4.4.3.2">
        <span class="ltx_text" id="A3.T4.4.4.3.2.1" style="font-size:90%;">
         DreamerV3
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="A3.T4.4.4.3.3">
        <span class="ltx_text" id="A3.T4.4.4.3.3.1" style="font-size:90%;">
         100M
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="A3.T4.4.4.3.4">
        <span class="ltx_text" id="A3.T4.4.4.3.4.1" style="font-size:90%;">
         100K
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para" id="A3.SS2.p4">
    <p class="ltx_p" id="A3.SS2.p4.1">
     We employ a reward confusion matrix in Figure
     <a class="ltx_ref" href="#A1.F7" title="Figure 7 ‣ C.2 Trained Transition Captioner for Dynamics Parts ‣ Appendix C Details of Captioners ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     to illustrate the accuracy of our trained transition captioner on HomeGrid, depicting the probability of each achieved goal being correctly rewarded or incorrectly rewarded for another goal during real interactions with the environment. Despite being based on a limited dataset, the captioner demonstrates strong accuracy even when extrapolated beyond the dataset distribution.
    </p>
   </div>
   <figure class="ltx_figure" id="A1.F7">
    <p class="ltx_p ltx_align_center ltx_align_center" id="A1.F7.1.1">
     <span class="ltx_text" id="A1.F7.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="415" id="A1.F7.1.1.1.g1" src="/html/2406.07381/assets/x3.png" width="415"/>
     </span>
    </p>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="A1.F7.3.1.1" style="font-size:90%;">
       Figure 7
      </span>
      :
     </span>
     <span class="ltx_text" id="A1.F7.4.2" style="font-size:90%;">
      The reward confusion matrix of the trained transition captioner on HomeGrid. Each square’s color indicates the probability that the action in the row will be rewarded with the achievement labels on the column. For example, if all action “go to the dining room” is recognized as the achievement “go to the dining room”, we will receive a 100% on the square corresponding to this row and column. The total in each row does not equal 100% because multiple rewards may be activated by a single achievement, depending on its description.
     </span>
    </figcaption>
   </figure>
  </section>
 </section>
 <section class="ltx_appendix" id="A4">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix D
   </span>
   Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis.
  </h2>
  <div class="ltx_para" id="A4.p1">
   <p class="ltx_p" id="A4.p1.1">
    Despite the superiority of GPT-3.5 and GPT-4, they may still output impractical or unachievable goals within the game mechanics. This section of ablation experiments primarily investigates the quality of guidance provided by different versions of LLMs in all the environments in which DLLM was conducted. A detailed explanation of the metrics for measuring the generated goals’ quality is shown in Table
    <a class="ltx_ref" href="#A4.T5" title="Table 5 ‣ Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
     <span class="ltx_text ltx_ref_tag">
      5
     </span>
    </a>
    .
   </p>
  </div>
  <figure class="ltx_table" id="A4.T5">
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 5:
    </span>
    Explanation of the metrics.
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T5.4">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A4.T5.4.1.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T5.4.1.1.1">
       <span class="ltx_text" id="A4.T5.4.1.1.1.1" style="font-size:90%;">
        Metrics
       </span>
      </th>
      <th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A4.T5.4.1.1.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T5.4.1.1.2.1">
        <span class="ltx_p" id="A4.T5.4.1.1.2.1.1" style="width:278.8pt;">
         <span class="ltx_text" id="A4.T5.4.1.1.2.1.1.1" style="font-size:90%;">
          Explanation
         </span>
        </span>
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A4.T5.4.2.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T5.4.2.1.1">
       <span class="ltx_text" id="A4.T5.4.2.1.1.1" style="font-size:90%;">
        Novelty
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A4.T5.4.2.1.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T5.4.2.1.2.1">
        <span class="ltx_p" id="A4.T5.4.2.1.2.1.1" style="width:278.8pt;">
         <span class="ltx_text" id="A4.T5.4.2.1.2.1.1.1" style="font-size:90%;">
          In exploratory environments like Crafter and Minecraft, a goal is “novel” when its prerequisites are fulfilled, but the goal remains unaccomplished in the current episode. For example, in Crafter, the goal “place table” is “novel” when it is unfulfilled when there are sufficient resources available to achieve it.
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T5.4.3.2">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.4.3.2.1">
       <span class="ltx_text" id="A4.T5.4.3.2.1.1" style="font-size:90%;">
        Correctness
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T5.4.3.2.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T5.4.3.2.2.1">
        <span class="ltx_p" id="A4.T5.4.3.2.2.1.1" style="width:278.8pt;">
         <span class="ltx_text" id="A4.T5.4.3.2.2.1.1.1" style="font-size:90%;">
          In task-oriented environments like HomeGrid, each situation has finite correct answers for goals, and other goals may be useless or even lead to task failure. A goal is considered “correct” if it is one of the correct answers. For example, “go to the kitchen” in HomeGrid is correct if the task is to “find the papers” and the papers are located in the kitchen.
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T5.4.4.3">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.4.4.3.1">
       <span class="ltx_text" id="A4.T5.4.4.3.1.1" style="font-size:90%;">
        Context sensitivity
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T5.4.4.3.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T5.4.4.3.2.1">
        <span class="ltx_p" id="A4.T5.4.4.3.2.1.1" style="width:278.8pt;">
         <span class="ltx_text" id="A4.T5.4.4.3.2.1.1.1" style="font-size:90%;">
          A goal is “context sensitivity” when the player’s current field of view and inventory satisfy all the conditions necessary for this goal, regardless of whether these goals are right or novel. e.g., “make wood pickaxe” when you have enough resources but already have a wood pickaxe in your inventory, and you see a table.
         </span>
        </span>
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A4.T5.4.5.4">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T5.4.5.4.1">
       <span class="ltx_text" id="A4.T5.4.5.4.1.1" style="font-size:90%;">
        Common-sense sensitivity
       </span>
      </th>
      <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A4.T5.4.5.4.2">
       <span class="ltx_inline-block ltx_align_top" id="A4.T5.4.5.4.2.1">
        <span class="ltx_p" id="A4.T5.4.5.4.2.1.1" style="width:278.8pt;">
         <span class="ltx_text" id="A4.T5.4.5.4.2.1.1.1" style="font-size:90%;">
          A goal is “common-sense sensitive” when it is feasible in the environment in at least one situation. A counterexample is “make path” in Crafter, which is impossible. Sometimes, the LLM may not fully understand a previously unknown environment (such as HomeGrid) through concise descriptions, leading to such situations.
         </span>
        </span>
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <section class="ltx_subsection" id="A4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     D.1
    </span>
    HomeGrid
   </h3>
   <div class="ltx_para" id="A4.SS1.p1">
    <p class="ltx_p" id="A4.SS1.p1.1">
     In HomeGrid, given the current observation (including the information about the task and the world state), there is a unique correct answer for “where to go” and “what to do”. To assess the quality of the generated goals, we conducted tests as shown in Table
     <a class="ltx_ref" href="#A4.T6" title="Table 6 ‣ D.1 HomeGrid ‣ Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     . In this task-oriented environment, we do not test the novelty of goals. The statistical results for each setting were obtained using 1M training samples generated from real interactions. The correctness of goals provided in the standard setting is low since the agent’s observation may lack relevant information. There is a noticeable improvement in the Key info setting and extra improvement in the Full info setting. Note that in the Oracle setting, the goals provided to the agent are always correct, so we do not include this setting.
    </p>
   </div>
   <figure class="ltx_table" id="A4.T6">
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 6:
     </span>
     Testing the quality of goals provided by LLM in each setting of HomeGrid. Ideally, the goals should exhibit high correctness, low context insensitivity, and low commonsense insensitivity.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T6.4">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="A4.T6.4.1.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T6.4.1.1.1">
        <span class="ltx_text" id="A4.T6.4.1.1.1.1" style="font-size:90%;">
         Setting
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T6.4.1.1.2">
        <span class="ltx_text" id="A4.T6.4.1.1.2.1" style="font-size:90%;">
         Standard
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T6.4.1.1.3">
        <span class="ltx_text" id="A4.T6.4.1.1.3.1" style="font-size:90%;">
         Key info
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T6.4.1.1.4">
        <span class="ltx_text" id="A4.T6.4.1.1.4.1" style="font-size:90%;">
         Full info
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A4.T6.4.2.1">
       <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T6.4.2.1.1">
        <span class="ltx_text" id="A4.T6.4.2.1.1.1" style="font-size:90%;">
         Correctness
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T6.4.2.1.2">
        <span class="ltx_text" id="A4.T6.4.2.1.2.1" style="font-size:90%;">
         52.55%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T6.4.2.1.3">
        <span class="ltx_text" id="A4.T6.4.2.1.3.1" style="font-size:90%;">
         61.64%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T6.4.2.1.4">
        <span class="ltx_text" id="A4.T6.4.2.1.4.1" style="font-size:90%;">
         66.92%
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A4.T6.4.3.2">
       <td class="ltx_td ltx_align_center" id="A4.T6.4.3.2.1">
        <span class="ltx_text" id="A4.T6.4.3.2.1.1" style="font-size:90%;">
         Context insensitivity
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="A4.T6.4.3.2.2">
        <span class="ltx_text" id="A4.T6.4.3.2.2.1" style="font-size:90%;">
         24.30%
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="A4.T6.4.3.2.3">
        <span class="ltx_text" id="A4.T6.4.3.2.3.1" style="font-size:90%;">
         18.34%
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="A4.T6.4.3.2.4">
        <span class="ltx_text" id="A4.T6.4.3.2.4.1" style="font-size:90%;">
         18.95%
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A4.T6.4.4.3">
       <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T6.4.4.3.1">
        <span class="ltx_text" id="A4.T6.4.4.3.1.1" style="font-size:90%;">
         Common-sense insensitivity
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T6.4.4.3.2">
        <span class="ltx_text" id="A4.T6.4.4.3.2.1" style="font-size:90%;">
         3.45%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T6.4.4.3.3">
        <span class="ltx_text" id="A4.T6.4.4.3.3.1" style="font-size:90%;">
         4.17%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T6.4.4.3.4">
        <span class="ltx_text" id="A4.T6.4.4.3.4.1" style="font-size:90%;">
         5.63%
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
  </section>
  <section class="ltx_subsection" id="A4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     D.2
    </span>
    Crafter
   </h3>
   <div class="ltx_para" id="A4.SS2.p1">
    <p class="ltx_p" id="A4.SS2.p1.1">
     Given the exploratory nature of the environment, it is hard to say if a goal is “correct” or not. Therefore, in evaluating Crafter’s goal quality, assessing its correctness holds minimal significance. Instead, our evaluation approach prioritizes novelty over correctness. Through testing various scenarios, the results presented in Table
     <a class="ltx_ref" href="#A4.T7" title="Table 7 ‣ D.2 Crafter ‣ Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     indicate that GPT-3.5 tends to offer practical suggestions, demonstrating a context-sensitive ratio of up to 79.41%. Conversely, GPT-4 leans towards proposing more radical and innovative recommendations, prioritizing novelty. Notably, a goal can exhibit both novelty and context sensitivity concurrently. Therefore, the proportions of “context insensitivity” and “common-sense insensitivity” in the table are acceptable. Despite GPT-4 showing higher ratios in both context insensitivity and common-sense insensitivity, experimental results underscore its exceptional assistance in enhancing performance. Statistical results for each choice of LLMs were derived from 1M training samples generated from real interactions, with scripts devised to assess these samples without humans in the loop.
    </p>
   </div>
   <figure class="ltx_table" id="A4.T7">
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 7:
     </span>
     Testing the quality of goals provided by GPT-3.5 and GPT-4 in Crafter.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T7.4">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="A4.T7.4.1.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.4.1.1.1">
        <span class="ltx_text" id="A4.T7.4.1.1.1.1" style="font-size:90%;">
         LLM
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.4.1.1.2">
        <span class="ltx_text" id="A4.T7.4.1.1.2.1" style="font-size:90%;">
         Novelty
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.4.1.1.3">
        <span class="ltx_text" id="A4.T7.4.1.1.3.1" style="font-size:90%;">
         Context insensitivity
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.4.1.1.4">
        <span class="ltx_text" id="A4.T7.4.1.1.4.1" style="font-size:90%;">
         Common-sense insensitivity
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A4.T7.4.2.1">
       <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.4.2.1.1">
        <span class="ltx_text" id="A4.T7.4.2.1.1.1" style="font-size:90%;">
         GPT-3.5
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.4.2.1.2">
        <span class="ltx_text" id="A4.T7.4.2.1.2.1" style="font-size:90%;">
         17.44%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.4.2.1.3">
        <span class="ltx_text" id="A4.T7.4.2.1.3.1" style="font-size:90%;">
         20.59%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A4.T7.4.2.1.4">
        <span class="ltx_text" id="A4.T7.4.2.1.4.1" style="font-size:90%;">
         8.26%
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A4.T7.4.3.2">
       <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.4.3.2.1">
        <span class="ltx_text" id="A4.T7.4.3.2.1.1" style="font-size:90%;">
         GPT-4
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.4.3.2.2">
        <span class="ltx_text" id="A4.T7.4.3.2.2.1" style="font-size:90%;">
         38.15%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.4.3.2.3">
        <span class="ltx_text" id="A4.T7.4.3.2.3.1" style="font-size:90%;">
         38.80%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.4.3.2.4">
        <span class="ltx_text" id="A4.T7.4.3.2.4.1" style="font-size:90%;">
         10.78%
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
  </section>
  <section class="ltx_subsection" id="A4.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     D.3
    </span>
    Minecraft
   </h3>
   <div class="ltx_para" id="A4.SS3.p1">
    <p class="ltx_p" id="A4.SS3.p1.1">
     Despite Minecraft’s relative complexity, GPT possesses a wealth of pretrained knowledge about it due to the abundance of relevant information in its training data. Similar to Crafter, correctness is not the primary focus in Minecraft. During the training process of the DLLM, we randomly sampled 1024 steps to collect an equal number of observations, resulting in 5120 goals (1024 multiplied by 5) aligned with the observations. Due to the complexity of elements encompassed within Minecraft, writing scripts to label the quality of goals proves exceedingly challenging. In light of this, we opted for a manual annotation process. This involved a detailed examination of each goal using human labeling. The results are presented in Table
     <a class="ltx_ref" href="#A4.T8" title="Table 8 ‣ D.3 Minecraft ‣ Appendix D Metrics to Test the Quality of Goals Generated by LLMs and Goal Analysis. ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     .
    </p>
   </div>
   <figure class="ltx_table" id="A4.T8">
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 8:
     </span>
     Testing the quality of goals provided by GPT-4 in Minecraft.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="A4.T8.4">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A4.T8.4.1.1">
       <td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T8.4.1.1.1">
        <span class="ltx_text" id="A4.T8.4.1.1.1.1" style="font-size:90%;">
         Novelty
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T8.4.1.1.2">
        <span class="ltx_text" id="A4.T8.4.1.1.2.1" style="font-size:90%;">
         Context insensitivity
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T8.4.1.1.3">
        <span class="ltx_text" id="A4.T8.4.1.1.3.1" style="font-size:90%;">
         Common-sense insensitivity
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="A4.T8.4.2.2">
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T8.4.2.2.1">
        <span class="ltx_text" id="A4.T8.4.2.2.1.1" style="font-size:90%;">
         73.63%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T8.4.2.2.2">
        <span class="ltx_text" id="A4.T8.4.2.2.2.1" style="font-size:90%;">
         7.66%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T8.4.2.2.3">
        <span class="ltx_text" id="A4.T8.4.2.2.3.1" style="font-size:90%;">
         0.53%
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_pagination ltx_role_newpage">
   </div>
  </section>
 </section>
 <section class="ltx_appendix" id="A5">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix E
   </span>
   Additional Ablation Studies
  </h2>
  <section class="ltx_subsection" id="A5.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.1
    </span>
    Token vs Sentence Embedding for Dynalang in HomeGrid
   </h3>
   <div class="ltx_para" id="A5.SS1.p1">
    <p class="ltx_p" id="A5.SS1.p1.1">
     This ablation study compares the performance difference of the Dynalang baseline when utilizing token or sentence embedding to acquire natural language information about the task. The results are shown in Figure
     <a class="ltx_ref" href="#A5.F8" title="Figure 8 ‣ E.1 Token vs Sentence Embedding for Dynalang in HomeGrid ‣ Appendix E Additional Ablation Studies ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     , and we do not observe significant differences between the two methods. Dynalang with token embedding does not outperform Dynalang with sentence embedding. We believe this is because, in our modified environment, Dynalang retrieves task information using tokens and cannot immediately access the complete task information compared to Dynalang using sentence embedding. This is because Dynalang is configured to display only one token per step, requiring time equal to the number of tokens to display all tokens in a sentence.
    </p>
   </div>
   <div class="ltx_para" id="A5.SS1.p2">
    <p class="ltx_p" id="A5.SS1.p2.1">
     We do not attempt a similar experiment for natural language information related to transitions and goals because each step in the environment may generate a transition and several goals, and it is impractical to transmit numerous transition tokens token by token to the agent.
    </p>
   </div>
   <figure class="ltx_figure" id="A5.F8">
    <p class="ltx_p ltx_align_center ltx_align_center" id="A5.F8.1.1">
     <span class="ltx_text" id="A5.F8.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="188" id="A5.F8.1.1.1.g1" src="/html/2406.07381/assets/x4.png" width="346"/>
     </span>
    </p>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="A5.F8.3.1.1" style="font-size:90%;">
       Figure 8
      </span>
      :
     </span>
     <span class="ltx_text" id="A5.F8.4.2" style="font-size:90%;">
      Token vs. sentence embedding performance for Dynalang, averaged across 5 seeds. Dynalang employs a token-by-token approach by tokenizing natural language and passing it into the environment token by token. In contrast, DLLM exclusively utilizes a sentence embedding implementation, as it helps compress a substantial amount of information into a single time step. Within the natural language information we use, task-related language can be separated and still follow Dynalang’s token-by-token format. In the HomeGrid environment, we have not observed significant differences.
     </span>
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="A5.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.2
    </span>
    Ablations of the Intrinsic Reward Scale in Crafter
   </h3>
   <div class="ltx_para" id="A5.SS2.p1">
    <p class="ltx_p" id="A5.SS2.p1.3">
     In our work, a Random Network Distillation (RND) network is employed to progressively reduce the intrinsic reward corresponding to each goal. We conduct an ablation experiment to illustrate the necessity of this measure. We set the hyperparameter
     <math alttext="\alpha\in" class="ltx_Math" display="inline" id="A5.SS2.p1.1.m1.1">
      <semantics id="A5.SS2.p1.1.m1.1a">
       <mrow id="A5.SS2.p1.1.m1.1.1" xref="A5.SS2.p1.1.m1.1.1.cmml">
        <mi id="A5.SS2.p1.1.m1.1.1.2" xref="A5.SS2.p1.1.m1.1.1.2.cmml">
         α
        </mi>
        <mo id="A5.SS2.p1.1.m1.1.1.1" xref="A5.SS2.p1.1.m1.1.1.1.cmml">
         ∈
        </mo>
        <mi id="A5.SS2.p1.1.m1.1.1.3" xref="A5.SS2.p1.1.m1.1.1.3.cmml">
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A5.SS2.p1.1.m1.1b">
        <apply id="A5.SS2.p1.1.m1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1">
         <in id="A5.SS2.p1.1.m1.1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1.1">
         </in>
         <ci id="A5.SS2.p1.1.m1.1.1.2.cmml" xref="A5.SS2.p1.1.m1.1.1.2">
          𝛼
         </ci>
         <csymbol cd="latexml" id="A5.SS2.p1.1.m1.1.1.3.cmml" xref="A5.SS2.p1.1.m1.1.1.3">
          absent
         </csymbol>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A5.SS2.p1.1.m1.1c">
        \alpha\in
       </annotation>
      </semantics>
     </math>
     {0.5, 2} and perform experiments for each value.
     <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.SS2.p1.2.m2.1">
      <semantics id="A5.SS2.p1.2.m2.1a">
       <mi id="A5.SS2.p1.2.m2.1.1" xref="A5.SS2.p1.2.m2.1.1.cmml">
        α
       </mi>
       <annotation-xml encoding="MathML-Content" id="A5.SS2.p1.2.m2.1b">
        <ci id="A5.SS2.p1.2.m2.1.1.cmml" xref="A5.SS2.p1.2.m2.1.1">
         𝛼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A5.SS2.p1.2.m2.1c">
        \alpha
       </annotation>
      </semantics>
     </math>
     = 2 resulted in catastrophic outcomes, whereas
     <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.SS2.p1.3.m3.1">
      <semantics id="A5.SS2.p1.3.m3.1a">
       <mi id="A5.SS2.p1.3.m3.1.1" xref="A5.SS2.p1.3.m3.1.1.cmml">
        α
       </mi>
       <annotation-xml encoding="MathML-Content" id="A5.SS2.p1.3.m3.1b">
        <ci id="A5.SS2.p1.3.m3.1.1.cmml" xref="A5.SS2.p1.3.m3.1.1">
         𝛼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A5.SS2.p1.3.m3.1c">
        \alpha
       </annotation>
      </semantics>
     </math>
     = 0.5 only led to a slight performance decrease. We conclude that excessively large intrinsic rewards tend to mislead the agent, e.g., try to obtain intrinsic rewards instead of environmental rewards. Conversely, excessively small intrinsic rewards result in inadequate guidance the DLLM provides, undermining its effectiveness in directing the agent’s behavior. Please refer to Figures
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:Aplot
     </span>
     and
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:Aspr
     </span>
     for the results.
    </p>
   </div>
   <figure class="ltx_figure" id="A5.F10.sf1">
   </figure>
  </section>
  <section class="ltx_subsection" id="A5.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.3
    </span>
    Decrease or not to decrease intrinsic rewards in Crafter
   </h3>
   <div class="ltx_para" id="A5.SS3.p1">
    <p class="ltx_p" id="A5.SS3.p1.1">
     This ablation study aims to demonstrate our claim in the paper that repeatedly providing the agent with a constant intrinsic reward for each goal will result in the agent consistently performing simple tasks
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib45" title="">
       45
      </a>
      ,
      <a class="ltx_ref" href="#biba.bib56" title="">
       56
      </a>
      ,
      <a class="ltx_ref" href="#biba.bib12" title="">
       12
      </a>
      ]
     </cite>
     , thereby reducing its exploration efficiency and the likelihood of acquiring new skills. We still use an RND network to provide intrinsic rewards in this experiment. However, by preventing the RND network from updating throughout the training process, we ensure that the intrinsic rewards corresponding to all goals remain constant and do not decrease over time. We observe a slight increase in performance during the earlier stages and a significant decline in the later stages, which is consistent with our claim. Please refer to Figures
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:norndspr
     </span>
     and
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:norndplot
     </span>
     for the results.
    </p>
   </div>
   <figure class="ltx_figure" id="A5.F10.sf2">
   </figure>
  </section>
  <section class="ltx_subsection" id="A5.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.4
    </span>
    Random Goals in Crafter
   </h3>
   <div class="ltx_para" id="A5.SS4.p1">
    <p class="ltx_p" id="A5.SS4.p1.1">
     In this ablation study, we investigate the effectiveness of guidance from the LLM using its pre-trained knowledge compared to randomly sampled goals. In this experiment, we instruct the LLM to sample goals without providing any information about the agent, resulting in entirely random goal sampling. However, we still require the LLM to adhere to the format specified in Appendix
     <a class="ltx_ref" href="#A1.SS2.SSS1" title="A.2.1 Full Prompt Details ‣ A.2 Crafter ‣ Appendix A Environment Details ‣ World Models with Hints of Large Language Models for Goal Achieving">
      <span class="ltx_text ltx_ref_tag">
       A.2.1
      </span>
     </a>
     . The results are presented in Figure
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:randomgoalspr
     </span>
     and
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:randomgoalplot
     </span>
     . We find that using random goals significantly reduces the performance of DLLM. Nonetheless, DLLM still maintains a certain advantage over recent popular algorithms like Dynalang. This is because providing basic information about the environment to the LLM still generates some reasonable goals in uncertain player conditions. These goals continue to provide effective guidance for the agent through the intrinsic rewards generated in model rollouts.
    </p>
   </div>
   <figure class="ltx_figure" id="A5.F10.sf3">
   </figure>
  </section>
  <section class="ltx_subsection" id="A5.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     E.5
    </span>
    Allow Repetition in Crafter
   </h3>
   <div class="ltx_para" id="A5.SS5.p1">
    <p class="ltx_p" id="A5.SS5.p1.1">
     In Method, we assert that when rewarding the same goal repeatedly within a single model rollout, there is a risk that the agent may tend to repetitively trigger simpler goals instead of attempting to unlock unexplored parts of the technology tree. Consequently, this may lead to decreased performance within Crafter environments primarily focused on exploration. This viewpoint aligns with ELLM
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#biba.bib13" title="">
       13
      </a>
      ]
     </cite>
     . Here, we conducted experiments to substantiate this claim, with results presented in Figure
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:notonepertrajspr
     </span>
     and
     <span class="ltx_ref ltx_missing_label ltx_ref_self">
      LABEL:fig:notonepertrajplot
     </span>
     . We observed a significant performance decline in DLLM when repetitive rewards for the same goal were allowed.
    </p>
   </div>
   <figure class="ltx_figure" id="A5.F10.sf4">
   </figure>
   <div class="ltx_pagination ltx_role_newpage">
   </div>
  </section>
 </section>
 <section class="ltx_appendix" id="A6">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix F
   </span>
   Additional results in Crafter
  </h2>
  <div class="ltx_para" id="A6.p1">
   <p class="ltx_p" id="A6.p1.1">
    Figure
    <a class="ltx_ref" href="#A5.F10" title="Figure 10 ‣ Appendix F Additional results in Crafter ‣ World Models with Hints of Large Language Models for Goal Achieving">
     <span class="ltx_text ltx_ref_tag">
      10
     </span>
    </a>
    presents the comparison of success rates on the total 22 achievements between DLLM and other baselines in Crafter at 5M steps. DLLM exhibits a higher success rate in unlocking fundamental achievements and outperforms other baselines.
   </p>
  </div>
  <figure class="ltx_figure" id="A5.F10">
   <br class="ltx_break"/>
   <p class="ltx_p ltx_align_center ltx_align_center" id="A5.F10.1.1">
    <span class="ltx_text" id="A5.F10.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="184" id="A5.F10.1.1.1.g1" src="/html/2406.07381/assets/x5.png" width="368"/>
    </span>
   </p>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="A5.F10.3.1.1" style="font-size:90%;">
      Figure 10
     </span>
     :
    </span>
    <span class="ltx_text" id="A5.F10.4.2" style="font-size:90%;">
     Logarithmic scale success rates for unlocking 22 distinct achievements at 5M steps.
    </span>
   </figcaption>
  </figure>
 </section>
 <section class="ltx_appendix" id="A7">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix G
   </span>
   Implementation Details
  </h2>
  <div class="ltx_para" id="A7.p1">
   <p class="ltx_p" id="A7.p1.2">
    For all the experiments, We employ the default hyperparameters for the XL DreamerV3 model
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#biba.bib24" title="">
      24
     </a>
     ]
    </cite>
    . Other hyperparameters are specified below. A uniform learning rate of 3e-4 is applied across all environments for the RND networks. Regarding the scale for intrinsic reward
    <math alttext="\alpha" class="ltx_Math" display="inline" id="A7.p1.1.m1.1">
     <semantics id="A7.p1.1.m1.1a">
      <mi id="A7.p1.1.m1.1.1" xref="A7.p1.1.m1.1.1.cmml">
       α
      </mi>
      <annotation-xml encoding="MathML-Content" id="A7.p1.1.m1.1b">
       <ci id="A7.p1.1.m1.1.1.cmml" xref="A7.p1.1.m1.1.1">
        𝛼
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A7.p1.1.m1.1c">
       \alpha
      </annotation>
     </semantics>
    </math>
    , we consistently set
    <math alttext="\alpha" class="ltx_Math" display="inline" id="A7.p1.2.m2.1">
     <semantics id="A7.p1.2.m2.1a">
      <mi id="A7.p1.2.m2.1.1" xref="A7.p1.2.m2.1.1.cmml">
       α
      </mi>
      <annotation-xml encoding="MathML-Content" id="A7.p1.2.m2.1b">
       <ci id="A7.p1.2.m2.1.1.cmml" xref="A7.p1.2.m2.1.1">
        𝛼
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A7.p1.2.m2.1c">
       \alpha
      </annotation>
     </semantics>
    </math>
    to be 1. We use 1 Nvidia A100 GPU for each single experiment. The training time includes the total GPT querying time, which should be near zero when reusing a cache to obtain the goals.
   </p>
  </div>
  <figure class="ltx_table" id="A7.T9">
   <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
    <span class="ltx_tag ltx_tag_table">
     Table 9:
    </span>
    Hyperparameters and training information for DLLM.
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T9.4">
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A7.T9.4.5.1">
      <th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="A7.T9.4.5.1.1">
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.4.5.1.2">
       <span class="ltx_text" id="A7.T9.4.5.1.2.1" style="font-size:90%;">
        HomeGrid
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.4.5.1.3">
       <span class="ltx_text" id="A7.T9.4.5.1.3.1" style="font-size:90%;">
        Crafter
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.4.5.1.4">
       <span class="ltx_text" id="A7.T9.4.5.1.4.1" style="font-size:90%;">
        Minecraft
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.1.1">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A7.T9.1.1.1">
       <span class="ltx_text" id="A7.T9.1.1.1.1" style="font-size:90%;">
        Imagination horizon
       </span>
       <math alttext="T" class="ltx_Math" display="inline" id="A7.T9.1.1.1.m1.1">
        <semantics id="A7.T9.1.1.1.m1.1a">
         <mi id="A7.T9.1.1.1.m1.1.1" mathsize="90%" xref="A7.T9.1.1.1.m1.1.1.cmml">
          T
         </mi>
         <annotation-xml encoding="MathML-Content" id="A7.T9.1.1.1.m1.1b">
          <ci id="A7.T9.1.1.1.m1.1.1.cmml" xref="A7.T9.1.1.1.m1.1.1">
           𝑇
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A7.T9.1.1.1.m1.1c">
          T
         </annotation>
        </semantics>
       </math>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.1.1.2">
       <span class="ltx_text" id="A7.T9.1.1.2.1" style="font-size:90%;">
        15
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.1.1.3">
       <span class="ltx_text" id="A7.T9.1.1.3.1" style="font-size:90%;">
        15
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.1.1.4">
       <span class="ltx_text" id="A7.T9.1.1.4.1" style="font-size:90%;">
        15
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.6.2">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.6.2.1">
       <span class="ltx_text" id="A7.T9.4.6.2.1.1" style="font-size:90%;">
        Language MLP layers
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.6.2.2">
       <span class="ltx_text" id="A7.T9.4.6.2.2.1" style="font-size:90%;">
        5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.6.2.3">
       <span class="ltx_text" id="A7.T9.4.6.2.3.1" style="font-size:90%;">
        5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.6.2.4">
       <span class="ltx_text" id="A7.T9.4.6.2.4.1" style="font-size:90%;">
        5
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.7.3">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.7.3.1">
       <span class="ltx_text" id="A7.T9.4.7.3.1.1" style="font-size:90%;">
        Language MLP units
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.7.3.2">
       <span class="ltx_text" id="A7.T9.4.7.3.2.1" style="font-size:90%;">
        1024
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.7.3.3">
       <span class="ltx_text" id="A7.T9.4.7.3.3.1" style="font-size:90%;">
        1024
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.7.3.4">
       <span class="ltx_text" id="A7.T9.4.7.3.4.1" style="font-size:90%;">
        1024
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.8.4">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.8.4.1">
       <span class="ltx_text" id="A7.T9.4.8.4.1.1" style="font-size:90%;">
        Image Size
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.8.4.2">
       <span class="ltx_text" id="A7.T9.4.8.4.2.1" style="font-size:90%;">
        (64, 64, 3)
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.8.4.3">
       <span class="ltx_text" id="A7.T9.4.8.4.3.1" style="font-size:90%;">
        (64, 64, 3)
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.8.4.4">
       <span class="ltx_text" id="A7.T9.4.8.4.4.1" style="font-size:90%;">
        (64, 64, 3)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.9.5">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.9.5.1">
       <span class="ltx_text" id="A7.T9.4.9.5.1.1" style="font-size:90%;">
        Train ratio
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.9.5.2">
       <span class="ltx_text" id="A7.T9.4.9.5.2.1" style="font-size:90%;">
        32
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.9.5.3">
       <span class="ltx_text" id="A7.T9.4.9.5.3.1" style="font-size:90%;">
        512
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.9.5.4">
       <span class="ltx_text" id="A7.T9.4.9.5.4.1" style="font-size:90%;">
        32
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.10.6">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.10.6.1">
       <span class="ltx_text" id="A7.T9.4.10.6.1.1" style="font-size:90%;">
        Batch size
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.10.6.2">
       <span class="ltx_text" id="A7.T9.4.10.6.2.1" style="font-size:90%;">
        16
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.10.6.3">
       <span class="ltx_text" id="A7.T9.4.10.6.3.1" style="font-size:90%;">
        16
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.10.6.4">
       <span class="ltx_text" id="A7.T9.4.10.6.4.1" style="font-size:90%;">
        16
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.11.7">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.11.7.1">
       <span class="ltx_text" id="A7.T9.4.11.7.1.1" style="font-size:90%;">
        Batch length
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.11.7.2">
       <span class="ltx_text" id="A7.T9.4.11.7.2.1" style="font-size:90%;">
        256
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.11.7.3">
       <span class="ltx_text" id="A7.T9.4.11.7.3.1" style="font-size:90%;">
        64
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.11.7.4">
       <span class="ltx_text" id="A7.T9.4.11.7.4.1" style="font-size:90%;">
        64
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.12.8">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.12.8.1">
       <span class="ltx_text" id="A7.T9.4.12.8.1.1" style="font-size:90%;">
        GRU recurrent units
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.12.8.2">
       <span class="ltx_text" id="A7.T9.4.12.8.2.1" style="font-size:90%;">
        4096
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.12.8.3">
       <span class="ltx_text" id="A7.T9.4.12.8.3.1" style="font-size:90%;">
        4096
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.12.8.4">
       <span class="ltx_text" id="A7.T9.4.12.8.4.1" style="font-size:90%;">
        8192
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.13.9">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.13.9.1">
       <span class="ltx_text" id="A7.T9.4.13.9.1.1" style="font-size:90%;">
        Learning rate for RND
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.13.9.2">
       <span class="ltx_text" id="A7.T9.4.13.9.2.1" style="font-size:90%;">
        3e-4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.13.9.3">
       <span class="ltx_text" id="A7.T9.4.13.9.3.1" style="font-size:90%;">
        3e-4
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.13.9.4">
       <span class="ltx_text" id="A7.T9.4.13.9.4.1" style="font-size:90%;">
        3e-4
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.2.2">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.2.2.1">
       <span class="ltx_text" id="A7.T9.2.2.1.1" style="font-size:90%;">
        The scale for intrinsic rewards
       </span>
       <math alttext="\alpha" class="ltx_Math" display="inline" id="A7.T9.2.2.1.m1.1">
        <semantics id="A7.T9.2.2.1.m1.1a">
         <mi id="A7.T9.2.2.1.m1.1.1" mathsize="90%" xref="A7.T9.2.2.1.m1.1.1.cmml">
          α
         </mi>
         <annotation-xml encoding="MathML-Content" id="A7.T9.2.2.1.m1.1b">
          <ci id="A7.T9.2.2.1.m1.1.1.cmml" xref="A7.T9.2.2.1.m1.1.1">
           𝛼
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A7.T9.2.2.1.m1.1c">
          \alpha
         </annotation>
        </semantics>
       </math>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.2.2.2">
       <span class="ltx_text" id="A7.T9.2.2.2.1" style="font-size:90%;">
        1.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.2.2.3">
       <span class="ltx_text" id="A7.T9.2.2.3.1" style="font-size:90%;">
        1.0
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.2.2.4">
       <span class="ltx_text" id="A7.T9.2.2.4.1" style="font-size:90%;">
        1.0
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.3.3">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.3.3.1">
       <span class="ltx_text" id="A7.T9.3.3.1.1" style="font-size:90%;">
        Similarity threshold
       </span>
       <math alttext="M" class="ltx_Math" display="inline" id="A7.T9.3.3.1.m1.1">
        <semantics id="A7.T9.3.3.1.m1.1a">
         <mi id="A7.T9.3.3.1.m1.1.1" mathsize="90%" xref="A7.T9.3.3.1.m1.1.1.cmml">
          M
         </mi>
         <annotation-xml encoding="MathML-Content" id="A7.T9.3.3.1.m1.1b">
          <ci id="A7.T9.3.3.1.m1.1.1.cmml" xref="A7.T9.3.3.1.m1.1.1">
           𝑀
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A7.T9.3.3.1.m1.1c">
          M
         </annotation>
        </semantics>
       </math>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.3.3.2">
       <span class="ltx_text" id="A7.T9.3.3.2.1" style="font-size:90%;">
        0.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.3.3.3">
       <span class="ltx_text" id="A7.T9.3.3.3.1" style="font-size:90%;">
        0.5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.3.3.4">
       <span class="ltx_text" id="A7.T9.3.3.4.1" style="font-size:90%;">
        0.5
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.4">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.4.1">
       <span class="ltx_text" id="A7.T9.4.4.1.1" style="font-size:90%;">
        Max goal numbers
       </span>
       <math alttext="K" class="ltx_Math" display="inline" id="A7.T9.4.4.1.m1.1">
        <semantics id="A7.T9.4.4.1.m1.1a">
         <mi id="A7.T9.4.4.1.m1.1.1" mathsize="90%" xref="A7.T9.4.4.1.m1.1.1.cmml">
          K
         </mi>
         <annotation-xml encoding="MathML-Content" id="A7.T9.4.4.1.m1.1b">
          <ci id="A7.T9.4.4.1.m1.1.1.cmml" xref="A7.T9.4.4.1.m1.1.1">
           𝐾
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A7.T9.4.4.1.m1.1c">
          K
         </annotation>
        </semantics>
       </math>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.4.2">
       <span class="ltx_text" id="A7.T9.4.4.2.1" style="font-size:90%;">
        2
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.4.3">
       <span class="ltx_text" id="A7.T9.4.4.3.1" style="font-size:90%;">
        5
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.4.4">
       <span class="ltx_text" id="A7.T9.4.4.4.1" style="font-size:90%;">
        5
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.14.10">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A7.T9.4.14.10.1">
       <span class="ltx_text" id="A7.T9.4.14.10.1.1" style="font-size:90%;">
        Env steps
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.4.14.10.2">
       <span class="ltx_text" id="A7.T9.4.14.10.2.1" style="font-size:90%;">
        10M
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.4.14.10.3">
       <span class="ltx_text" id="A7.T9.4.14.10.3.1" style="font-size:90%;">
        5M
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A7.T9.4.14.10.4">
       <span class="ltx_text" id="A7.T9.4.14.10.4.1" style="font-size:90%;">
        100M
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.15.11">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.15.11.1">
       <span class="ltx_text" id="A7.T9.4.15.11.1.1" style="font-size:90%;">
        Number of envs
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.15.11.2">
       <span class="ltx_text" id="A7.T9.4.15.11.2.1" style="font-size:90%;">
        66
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.15.11.3">
       <span class="ltx_text" id="A7.T9.4.15.11.3.1" style="font-size:90%;">
        1
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.15.11.4">
       <span class="ltx_text" id="A7.T9.4.15.11.4.1" style="font-size:90%;">
        64
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.16.12">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.16.12.1">
       <span class="ltx_text" id="A7.T9.4.16.12.1.1" style="font-size:90%;">
        Training Time (GPU days)
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.16.12.2">
       <span class="ltx_text" id="A7.T9.4.16.12.2.1" style="font-size:90%;">
        2.25
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.16.12.3">
       <span class="ltx_text" id="A7.T9.4.16.12.3.1" style="font-size:90%;">
        10.75
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.16.12.4">
       <span class="ltx_text" id="A7.T9.4.16.12.4.1" style="font-size:90%;">
        16.50
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.17.13">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.17.13.1">
       <span class="ltx_text" id="A7.T9.4.17.13.1.1" style="font-size:90%;">
        Total GPT querying Time (days)
       </span>
      </th>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.17.13.2">
       <span class="ltx_text" id="A7.T9.4.17.13.2.1" style="font-size:90%;">
        1.50
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.17.13.3">
       <span class="ltx_text" id="A7.T9.4.17.13.3.1" style="font-size:90%;">
        0.75
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A7.T9.4.17.13.4">
       <span class="ltx_text" id="A7.T9.4.17.13.4.1" style="font-size:90%;">
        7.50
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.18.14">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A7.T9.4.18.14.1">
       <span class="ltx_text" id="A7.T9.4.18.14.1.1" style="font-size:90%;">
        temperature of GPT
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="A7.T9.4.18.14.2">
       <span class="ltx_text" id="A7.T9.4.18.14.2.1" style="font-size:90%;">
        0.5
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.19.15">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.19.15.1">
       <span class="ltx_text" id="A7.T9.4.19.15.1.1" style="font-size:90%;">
        top_p of GPT
       </span>
      </th>
      <td class="ltx_td ltx_align_center" colspan="3" id="A7.T9.4.19.15.2">
       <span class="ltx_text" id="A7.T9.4.19.15.2.1" style="font-size:90%;">
        1.0
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.20.16">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.20.16.1">
       <span class="ltx_text" id="A7.T9.4.20.16.1.1" style="font-size:90%;">
        max_tokens of GPT
       </span>
      </th>
      <td class="ltx_td ltx_align_center" colspan="3" id="A7.T9.4.20.16.2">
       <span class="ltx_text" id="A7.T9.4.20.16.2.1" style="font-size:90%;">
        500
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.21.17">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A7.T9.4.21.17.1">
       <span class="ltx_text" id="A7.T9.4.21.17.1.1" style="font-size:90%;">
        CPU device
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="A7.T9.4.21.17.2">
       <span class="ltx_text" id="A7.T9.4.21.17.2.1" style="font-size:90%;">
        AMD EPYC 7452 32-Core Processor
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.22.18">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A7.T9.4.22.18.1">
       <span class="ltx_text" id="A7.T9.4.22.18.1.1" style="font-size:90%;">
        CUDA device
       </span>
      </th>
      <td class="ltx_td ltx_align_center" colspan="3" id="A7.T9.4.22.18.2">
       <span class="ltx_text" id="A7.T9.4.22.18.2.1" style="font-size:90%;">
        Nvidia A100 GPU
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A7.T9.4.23.19">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="A7.T9.4.23.19.1">
       <span class="ltx_text" id="A7.T9.4.23.19.1.1" style="font-size:90%;">
        RAM
       </span>
      </th>
      <td class="ltx_td ltx_align_center ltx_border_b" colspan="3" id="A7.T9.4.23.19.2">
       <span class="ltx_text" id="A7.T9.4.23.19.2.1" style="font-size:90%;">
        256G
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
 </section>
 <section class="ltx_appendix" id="A8">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix H
   </span>
   Licenses
  </h2>
  <div class="ltx_para" id="A8.p1">
   <p class="ltx_p" id="A8.p1.1">
    In our code, we have used the following libraries covered by the corresponding licenses:
   </p>
   <ul class="ltx_itemize" id="A8.I1">
    <li class="ltx_item" id="A8.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A8.I1.i1.p1">
      <p class="ltx_p" id="A8.I1.i1.p1.1">
       HomeGrid, with MIT license
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A8.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A8.I1.i2.p1">
      <p class="ltx_p" id="A8.I1.i2.p1.1">
       Crafter, with MIT license
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A8.I1.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A8.I1.i3.p1">
      <p class="ltx_p" id="A8.I1.i3.p1.1">
       Minecraft, with Attribution-NonCommercial-ShareAlike 4.0 International
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A8.I1.i4" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A8.I1.i4.p1">
      <p class="ltx_p" id="A8.I1.i4.p1.1">
       OpenAI GPT, with CC BY-NC-SA 4.0 license
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A8.I1.i5" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A8.I1.i5.p1">
      <p class="ltx_p" id="A8.I1.i5.p1.1">
       SentenceTransformer, with Apache-2.0 license
      </p>
     </div>
    </li>
    <li class="ltx_item" id="A8.I1.i6" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="A8.I1.i6.p1">
      <p class="ltx_p" id="A8.I1.i6.p1.1">
       DreamerV3, with MIT license
      </p>
     </div>
    </li>
   </ul>
  </div>
 </section>
 <section class="ltx_appendix" id="A9">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix I
   </span>
   Broader Impacts
  </h2>
  <div class="ltx_para" id="A9.p1">
   <p class="ltx_p" id="A9.p1.1">
    LLMs have the potential to produce harmful or biased information. We have not observed LLMs generating such content in our current experimental environments, including HomeGrid, Crafter, and Minecraft. However, applying DLLM in other contexts, especially real-world settings, requires increased attention to social safety concerns. Implementing necessary safety measures involves screening LLM outputs, incorporating restrictive statements in LLM prompts, or fine-tuning with curated data.
   </p>
  </div>
 </section>
</article>
