<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG</title>
<!--Generated on Mon Oct 14 03:46:33 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.10293v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S1" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S2" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S2.SS1" title="In 2 Preliminaries ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>General Retrieval Paradigm for RAG</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S2.SS2" title="In 2 Preliminaries ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Experiment for Assumption Validation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS1" title="In 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Coarse-to-Fine Progressive Retrieval</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS1.SSS1" title="In 3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Retrieval Stage</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS1.SSS2" title="In 3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Pre-ranking Stage</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS1.SSS3" title="In 3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.3 </span>Post-ranking Stage</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS2" title="In 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Distillation with Aggregated Signals</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.SS1" title="In 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.SS2" title="In 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Retrieval Performance (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.SS3" title="In 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Generation Performance (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.SS4" title="In 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Study of <span class="ltx_text ltx_font_smallcaps">FunnelRAG</span> (RQ3)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S5" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S6" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A1" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>More Details Related to Methods</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A1.SS1" title="In Appendix A More Details Related to Methods ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Cross-Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A1.SS2" title="In Appendix A More Details Related to Methods ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Representative Token Selection</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>More Details Related to Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.SS1" title="In Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.SS2" title="In Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>LLMs for QA</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.SS3" title="In Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Prompts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.SS4" title="In Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>Hardware and Software Configurations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>More In-depth Studies</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS1" title="In Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Study of Attention Aggregation Schema</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS2" title="In Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Ablation of Query Tokens</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS3" title="In Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Contextual Integrity Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS4" title="In Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>Retrieval Performance Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS5" title="In Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.5 </span>Case Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A4" title="In FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Cluster Document Algorithm</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id11.id1">FunnelRAG</span>: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xinping Zhao<sup class="ltx_sup" id="id12.11.id1"><span class="ltx_text ltx_font_italic" id="id12.11.id1.1">1</span></sup>, Yan Zhong<sup class="ltx_sup" id="id13.12.id2"><span class="ltx_text ltx_font_italic" id="id13.12.id2.1">2</span></sup>, Zetian Sun<sup class="ltx_sup" id="id14.13.id3"><span class="ltx_text ltx_font_italic" id="id14.13.id3.1">1</span></sup>, Xinshuo Hu<sup class="ltx_sup" id="id15.14.id4"><span class="ltx_text ltx_font_italic" id="id15.14.id4.1">1</span></sup>, 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id8.8.4">Zhenyu Liu<sup class="ltx_sup" id="id8.8.4.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id8.8.4.1.1">1</span></sup>, Dongfang Li<sup class="ltx_sup" id="id8.8.4.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id8.8.4.2.1">1</span></sup>, Baotian Hu<sup class="ltx_sup" id="id8.8.4.3"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id8.8.4.3.1">1</span></sup><sup class="ltx_sup" id="id8.8.4.4">🖂</sup>, Min Zhang<sup class="ltx_sup" id="id8.8.4.5"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id8.8.4.5.1">1</span></sup></span>
<br class="ltx_break"/><sup class="ltx_sup" id="id16.15.id5"><span class="ltx_text ltx_font_italic" id="id16.15.id5.1">1</span></sup>Harbin Institute of Technology (Shenzhen), <sup class="ltx_sup" id="id17.16.id6"><span class="ltx_text ltx_font_italic" id="id17.16.id6.1">2</span></sup>Peking University 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id18.17.id7">{zhaoxinping, 23S151141, 22S051034, 190110924}@stu.hit.edu.cn</span>, 
<br class="ltx_break"/>zhongyan@stu.pku.edu.cn, <span class="ltx_text ltx_font_typewriter" id="id19.18.id8">{lidongfang, hubaotian, zhangmin2021}@hit.edu.cn</span>
</span><span class="ltx_author_notes"><sup class="ltx_sup" id="id20.19.id1"><span class="ltx_text ltx_font_bold" id="id20.19.id1.1">🖂</span></sup><span class="ltx_text ltx_font_bold" id="id21.20.id2">Corresponding author.</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id22.id1">Retrieval-Augmented Generation (RAG) prevails in Large Language Models. It mainly consists of <span class="ltx_text ltx_font_italic" id="id22.id1.1">retrieval</span> and <span class="ltx_text ltx_font_italic" id="id22.id1.2">generation</span>.
The retrieval modules (<span class="ltx_text ltx_font_italic" id="id22.id1.3">a.k.a.</span> retrievers) aim to find useful information used to facilitate generation modules (<span class="ltx_text ltx_font_italic" id="id22.id1.4">a.k.a.</span> generators).
As such, generators’ performance largely depends on the effectiveness and efficiency of retrievers.
However, the retrieval paradigm that we design and use remains flat, which treats the retrieval procedures as a one-off deal with constant granularity.
Despite effectiveness, we argue that they suffer from two limitations: (1) <span class="ltx_text ltx_font_bold" id="id22.id1.5">flat retrieval</span> exerts a significant burden on one retriever; (2) <span class="ltx_text ltx_font_bold" id="id22.id1.6">constant granularity</span> limits the ceiling of retrieval performance.
In this work, we propose a progressive retrieval paradigm with coarse-to-fine granularity for RAG, termed <span class="ltx_text ltx_font_smallcaps" id="id22.id1.7">FunnelRAG</span>, so as to balance effectiveness and efficiency.
Specifically, <span class="ltx_text ltx_font_smallcaps" id="id22.id1.8">FunnelRAG</span> establishes a progressive retrieval pipeline by collaborating coarse-to-fine granularity, large-to-small quantity, and low-to-high capacity, which can relieve the burden on one retriever and also promote the ceiling of retrieval performance.
Extensive experiments manifest that <span class="ltx_text ltx_font_smallcaps" id="id22.id1.9">FunnelRAG</span> achieves comparable retrieval performance while the time overhead is reduced by nearly 40 percent<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Code will be released upon publication.</span></span></span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.10">
<p class="ltx_p" id="p1.10.11"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="p1.10.11.1">FunnelRAG<span class="ltx_text ltx_font_upright" id="p1.10.11.1.1">: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG</span></span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.10.10" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.10.10.10" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.10.10.10.10">
<span class="ltx_tr" id="p1.4.4.4.4.4">
<span class="ltx_td ltx_align_center" id="p1.4.4.4.4.4.4"><span class="ltx_text ltx_font_bold" id="p1.4.4.4.4.4.4.4">Xinping Zhao<sup class="ltx_sup" id="p1.4.4.4.4.4.4.4.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.4.4.4.4.4.4.4.1.1">1</span></sup>, Yan Zhong<sup class="ltx_sup" id="p1.4.4.4.4.4.4.4.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.4.4.4.4.4.4.4.2.1">2</span></sup>, Zetian Sun<sup class="ltx_sup" id="p1.4.4.4.4.4.4.4.3"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.4.4.4.4.4.4.4.3.1">1</span></sup>, Xinshuo Hu<sup class="ltx_sup" id="p1.4.4.4.4.4.4.4.4"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.4.4.4.4.4.4.4.4.1">1</span></sup>,</span></span></span>
<span class="ltx_tr" id="p1.8.8.8.8.8">
<span class="ltx_td ltx_align_center" id="p1.8.8.8.8.8.4"><span class="ltx_text ltx_font_bold" id="p1.8.8.8.8.8.4.4">Zhenyu Liu<sup class="ltx_sup" id="p1.8.8.8.8.8.4.4.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.8.8.8.8.8.4.4.1.1">1</span></sup>, Dongfang Li<sup class="ltx_sup" id="p1.8.8.8.8.8.4.4.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.8.8.8.8.8.4.4.2.1">1</span></sup>, Baotian Hu<sup class="ltx_sup" id="p1.8.8.8.8.8.4.4.3"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.8.8.8.8.8.4.4.3.1">1</span></sup><sup class="ltx_sup" id="p1.8.8.8.8.8.4.4.4">🖂</sup>, Min Zhang<sup class="ltx_sup" id="p1.8.8.8.8.8.4.4.5"><span class="ltx_text ltx_font_medium ltx_font_italic" id="p1.8.8.8.8.8.4.4.5.1">1</span></sup></span></span></span>
<span class="ltx_tr" id="p1.10.10.10.10.10">
<span class="ltx_td ltx_align_center" id="p1.10.10.10.10.10.2"><sup class="ltx_sup" id="p1.10.10.10.10.10.2.1"><span class="ltx_text ltx_font_italic" id="p1.10.10.10.10.10.2.1.1">1</span></sup>Harbin Institute of Technology (Shenzhen), <sup class="ltx_sup" id="p1.10.10.10.10.10.2.2"><span class="ltx_text ltx_font_italic" id="p1.10.10.10.10.10.2.2.1">2</span></sup>Peking University</span></span>
<span class="ltx_tr" id="p1.10.10.10.10.11">
<span class="ltx_td ltx_align_center" id="p1.10.10.10.10.11.1"><span class="ltx_text ltx_font_typewriter" id="p1.10.10.10.10.11.1.1">{zhaoxinping, 23S151141, 22S051034, 190110924}@stu.hit.edu.cn</span>,</span></span>
<span class="ltx_tr" id="p1.10.10.10.10.12">
<span class="ltx_td ltx_align_center" id="p1.10.10.10.10.12.1">zhongyan@stu.pku.edu.cn, <span class="ltx_text ltx_font_typewriter" id="p1.10.10.10.10.12.1.1">{lidongfang, hubaotian, zhangmin2021}@hit.edu.cn</span></span></span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<span class="ltx_note ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotetext: </span><sup class="ltx_sup" id="footnotex1.1">🖂</sup>Corresponding author.</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Retrieval-Augmented Generation (RAG) has been shown highly effective in enhancing Large Language Models (LLMs) <cite class="ltx_cite ltx_citemacro_cite">Gao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib11" title="">2023</a>); Shi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib46" title="">2023</a>)</cite> and has been widely adopted in the industry, such as Microsoft’s GraphRAG <cite class="ltx_cite ltx_citemacro_cite">Edge et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib9" title="">2024</a>)</cite>, Google’s REALM <cite class="ltx_cite ltx_citemacro_cite">Guu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib14" title="">2020</a>)</cite>, and Meta’s RA-DIT <cite class="ltx_cite ltx_citemacro_cite">Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib31" title="">2024</a>)</cite>. Its effectiveness mainly comes from retrieving external non-parametric knowledge into LLMs to remedy their incomplete, incorrect, or outdated internal parametric knowledge <cite class="ltx_cite ltx_citemacro_cite">Karpukhin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib25" title="">2020</a>); Min et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib34" title="">2019</a>)</cite>.
The de facto RAG framework usually segments documents into short retrieval units, such as 100-word passages <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib21" title="">2024</a>)</cite>, resulting in a massive corpus with tens of millions of candidate units. Then, the retriever is tasked to find the “needle” (<span class="ltx_text ltx_font_italic" id="S1.p1.1.1">i.e.,</span> the golden retrieval units) from the “haystack” (<span class="ltx_text ltx_font_italic" id="S1.p1.1.2">i.e.,</span> the enormous candidate corpus) <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib27" title="">2024</a>); Kamradt (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib24" title="">2023</a>)</cite>. Finally, the retrieved units serve as the input context to the generator to facilitate generation.
Its working flow is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a>(a). Wikipedia dump is used as the non-parametric knowledge source <cite class="ltx_cite ltx_citemacro_cite">Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib29" title="">2020</a>)</cite>, where each document is segmented into disjoint 100-word chunks, resulting in a total of 21M short passages. Then, the retriever seeks through a vast number of 21M candidates to get several potentially valuable passages, such as four.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="226" id="S1.F1.g1" src="extracted/5924118/figures/example.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison between <span class="ltx_text ltx_font_bold" id="S1.F1.6.1">(a)</span> the flat retrieval and <span class="ltx_text ltx_font_bold" id="S1.F1.7.2">(b)</span> the progressive retrieval paradigm, where <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="12" id="S1.F1.2.g1" src="extracted/5924118/figures/decomposition.png" width="12"/> is the segmentation operation. <span class="ltx_text ltx_font_smallcaps" id="S1.F1.8.3">FunnelRAG</span> performs progressive retrieval from large to small quantity, from coarse to fine granularity, and with simple to complex retrievers, which balances effectiveness and efficiency.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite effectiveness, the existing retrieval paradigms still suffer from two major  limitations:</p>
</div>
<figure class="ltx_table" id="S1.T1">
<table class="ltx_tabular ltx_align_middle" id="S1.T1.3">
<tr class="ltx_tr" id="S1.T1.3.4">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S1.T1.3.4.1" style="padding:1pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="S1.T1.3.4.1.1">Retrieval Paradigm</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S1.T1.3.4.2" style="padding:1pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="S1.T1.3.4.2.1">Retrieval Unit</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S1.T1.3.4.3" style="padding:1pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="S1.T1.3.4.3.1">Time to Chunk</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S1.T1.3.4.4" style="padding:1pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="S1.T1.3.4.4.1">Corpus Size</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S1.T1.3.4.5" style="padding:1pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="S1.T1.3.4.5.1">Unit Size</span></td>
</tr>
<tr class="ltx_tr" id="S1.T1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T1.1.1.2" style="padding:1pt 5.3pt;"><span class="ltx_text" id="S1.T1.1.1.2.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T1.1.1.1" style="padding:1pt 5.3pt;"><span class="ltx_text" id="S1.T1.1.1.1.1"><span class="ltx_text" id="S1.T1.1.1.1.1.2"></span> <span class="ltx_text" id="S1.T1.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S1.T1.1.1.1.1.1.1">
<span class="ltx_tr" id="S1.T1.1.1.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S1.T1.1.1.1.1.1.1.1.1" style="padding:1pt 5.3pt;">Passage <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.T1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S1.T1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S1.T1.1.1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S1.T1.1.1.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.T1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.T1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.T1.1.1.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.1.1.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.T1.1.1.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math> Passage (Optional)</span></span>
</span></span> <span class="ltx_text" id="S1.T1.1.1.1.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T1.1.1.3" style="padding:1pt 5.3pt;">Early Chunking</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T1.1.1.4" style="padding:1pt 5.3pt;">21M</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T1.1.1.5" style="padding:1pt 5.3pt;">100</td>
</tr>
<tr class="ltx_tr" id="S1.T1.3.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S1.T1.3.3.3" style="padding:1pt 5.3pt;"><span class="ltx_text" id="S1.T1.3.3.3.1">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S1.T1.3.3.2" style="padding:1pt 5.3pt;"><span class="ltx_text" id="S1.T1.3.3.2.2"><span class="ltx_text" id="S1.T1.3.3.2.2.3"></span> <span class="ltx_text" id="S1.T1.3.3.2.2.2">
<span class="ltx_tabular ltx_align_middle" id="S1.T1.3.3.2.2.2.2">
<span class="ltx_tr" id="S1.T1.3.3.2.2.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S1.T1.3.3.2.2.2.2.2.2" style="padding:1pt 5.3pt;">Clustered Document<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.T1.2.2.1.1.1.1.1.1.m1.1"><semantics id="S1.T1.2.2.1.1.1.1.1.1.m1.1a"><mo id="S1.T1.2.2.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S1.T1.2.2.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.T1.2.2.1.1.1.1.1.1.m1.1b"><ci id="S1.T1.2.2.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.T1.2.2.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.2.2.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.T1.2.2.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math> Document <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.T1.3.3.2.2.2.2.2.2.m2.1"><semantics id="S1.T1.3.3.2.2.2.2.2.2.m2.1a"><mo id="S1.T1.3.3.2.2.2.2.2.2.m2.1.1" stretchy="false" xref="S1.T1.3.3.2.2.2.2.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.T1.3.3.2.2.2.2.2.2.m2.1b"><ci id="S1.T1.3.3.2.2.2.2.2.2.m2.1.1.cmml" xref="S1.T1.3.3.2.2.2.2.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.3.3.2.2.2.2.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.T1.3.3.2.2.2.2.2.2.m2.1d">→</annotation></semantics></math> Passage</span></span>
</span></span> <span class="ltx_text" id="S1.T1.3.3.2.2.4"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S1.T1.3.3.4" style="padding:1pt 5.3pt;">Later Chunking</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S1.T1.3.3.5" style="padding:1pt 5.3pt;">600K</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S1.T1.3.3.6" style="padding:1pt 5.3pt;">4K</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Key feature comparison between the prevailing flat retrieval and the proposed progressive retrieval.</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Flat Retrieval.</span> Most RAG frameworks approach the retrieval stage as a one-off deal, where the retriever is requested to take tens of millions of candidates as input and to find the golden retrieval units at a sitting. However, these practices inflict a heavy burden on one retriever, which makes the retrieval stage less effective and efficient, since it is very tough and computationally complex to find golden units immediately from such an  enormous  candidate  pool  (<span class="ltx_text ltx_font_italic" id="S1.I1.i1.p1.1.2">e.g.,</span> 21M).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Constant Granularity.</span> Some RAG frameworks draw inspiration from recommender systems <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib52" title="">2020</a>); Covington et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib5" title="">2016</a>); Grbovic and Cheng (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib13" title="">2018</a>)</cite>, following a multi-stage cascade architecture, where candidates are extracted through <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.2">retrieval</span> and <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.3">reranking</span> as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a>(a). However, these practices directly introduce recommender systems’ experience into RAG and neglect the characteristics of RAG. Each entry in recommender systems is usually inseparable, while entries in RAG are usually separable. Unfortunately, existing RAG methods commonly treat entries as constant-grained retrieval units, ultimately restricting  performance.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The above issues inflict a heavy burden on one retriever and neglect the subdivisible characteristic of entries in RAG. In this work, we propose a progressive retrieval paradigm with coarse-to-fine granularity for RAG, termed <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.1">FunnelRAG</span>.
Specifically, it progressively reduces the scale of candidate entries, refines the granularity of retrieval units, and increases the level of retrievers’ capacity, whose working flow is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a>(b). Particularly, there are two important designs in <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.2">FunnelRAG</span>:</p>
</div>
<div class="ltx_para" id="S1.p5">
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.4"><span class="ltx_text ltx_font_bold" id="S1.I2.i1.p1.4.1">Progressive Retrieval.</span> Different from flat retrieval, we progressively reduce the scale of candidates (<span class="ltx_text ltx_font_italic" id="S1.I2.i1.p1.4.2">e.g.,</span> millions (0.6M) <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.I2.i1.p1.1.m1.1"><semantics id="S1.I2.i1.p1.1.m1.1a"><mo id="S1.I2.i1.p1.1.m1.1.1" stretchy="false" xref="S1.I2.i1.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.I2.i1.p1.1.m1.1b"><ci id="S1.I2.i1.p1.1.m1.1.1.cmml" xref="S1.I2.i1.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i1.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.I2.i1.p1.1.m1.1d">→</annotation></semantics></math> hundreds (100) <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.I2.i1.p1.2.m2.1"><semantics id="S1.I2.i1.p1.2.m2.1a"><mo id="S1.I2.i1.p1.2.m2.1.1" stretchy="false" xref="S1.I2.i1.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.I2.i1.p1.2.m2.1b"><ci id="S1.I2.i1.p1.2.m2.1.1.cmml" xref="S1.I2.i1.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i1.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.I2.i1.p1.2.m2.1d">→</annotation></semantics></math> dozens (42)) and increase the level of retrievers’ capacity (<span class="ltx_text ltx_font_italic" id="S1.I2.i1.p1.4.3">e.g.,</span> sparse retrievers (SR)<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.I2.i1.p1.3.m3.1"><semantics id="S1.I2.i1.p1.3.m3.1a"><mo id="S1.I2.i1.p1.3.m3.1.1" stretchy="false" xref="S1.I2.i1.p1.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.I2.i1.p1.3.m3.1b"><ci id="S1.I2.i1.p1.3.m3.1.1.cmml" xref="S1.I2.i1.p1.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i1.p1.3.m3.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.I2.i1.p1.3.m3.1d">→</annotation></semantics></math> dense retrievers (DR)<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.I2.i1.p1.4.m4.1"><semantics id="S1.I2.i1.p1.4.m4.1a"><mo id="S1.I2.i1.p1.4.m4.1.1" stretchy="false" xref="S1.I2.i1.p1.4.m4.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.I2.i1.p1.4.m4.1b"><ci id="S1.I2.i1.p1.4.m4.1.1.cmml" xref="S1.I2.i1.p1.4.m4.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i1.p1.4.m4.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.I2.i1.p1.4.m4.1d">→</annotation></semantics></math>small language models (SLM)), to make a better balance of effectiveness and efficiency.
This design enables load balancing and improves retrieval accuracy by using mixed-capacity retrievers. To improve the retrieval accuracy of the entire pipeline, we train SLM with retrieval-augmented fine-tuning to gain retrieval capacity. Then, we further distill the aggregated retrieval signals from SLM to DR so that DR could align  with  language models’ preferences.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.3"><span class="ltx_text ltx_font_bold" id="S1.I2.i2.p1.3.1">Coarse-to-Fine Granularity.</span> To complement mixed-capacity retrievers with each other, it is necessary to segment coarse-grained units into fine-grained ones, as the high-capacity retrievers (<span class="ltx_text ltx_font_italic" id="S1.I2.i2.p1.3.2">e.g.,</span> DR) perform relatively poor than low-capacity ones (<span class="ltx_text ltx_font_italic" id="S1.I2.i2.p1.3.3">e.g.,</span> SR) for coarse-grained units <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib3" title="">2024</a>)</cite>. As such, we first construct coarse-grained units with approximate 4K tokens by clustering multiple related documents before retrieval, which can considerably reduce the corpus size (<span class="ltx_text ltx_font_italic" id="S1.I2.i2.p1.3.4">e.g.,</span> 21M<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.I2.i2.p1.1.m1.1"><semantics id="S1.I2.i2.p1.1.m1.1a"><mo id="S1.I2.i2.p1.1.m1.1.1" stretchy="false" xref="S1.I2.i2.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.I2.i2.p1.1.m1.1b"><ci id="S1.I2.i2.p1.1.m1.1.1.cmml" xref="S1.I2.i2.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i2.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.I2.i2.p1.1.m1.1d">→</annotation></semantics></math>0.6M).
Then, coarse-grained units are segmented into document-level units (<span class="ltx_text ltx_font_italic" id="S1.I2.i2.p1.3.5">e.g.,</span> 4K<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.I2.i2.p1.2.m2.1"><semantics id="S1.I2.i2.p1.2.m2.1a"><mo id="S1.I2.i2.p1.2.m2.1.1" stretchy="false" xref="S1.I2.i2.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.I2.i2.p1.2.m2.1b"><ci id="S1.I2.i2.p1.2.m2.1.1.cmml" xref="S1.I2.i2.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i2.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.I2.i2.p1.2.m2.1d">→</annotation></semantics></math>1K) before pre-ranking. Finally, we segment document-level units into passage-level units (<span class="ltx_text ltx_font_italic" id="S1.I2.i2.p1.3.6">e.g.,</span> 1K<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.I2.i2.p1.3.m3.1"><semantics id="S1.I2.i2.p1.3.m3.1a"><mo id="S1.I2.i2.p1.3.m3.1.1" stretchy="false" xref="S1.I2.i2.p1.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.I2.i2.p1.3.m3.1b"><ci id="S1.I2.i2.p1.3.m3.1.1.cmml" xref="S1.I2.i2.p1.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i2.p1.3.m3.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.I2.i2.p1.3.m3.1d">→</annotation></semantics></math>100) before post-ranking. These three groups of varied granularity units are sequentially fed into SR, DR, and SLM to locate the golden units with high accuracy and low cost.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">These two novel designs jointly contribute to the considerable improvement of retrieval accuracy and efficiency in open-domain question answering (QA), such as Natural Question (NQ) <cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib26" title="">2019</a>)</cite> and Trivia QA (TQA) <cite class="ltx_cite ltx_citemacro_cite">Joshi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib23" title="">2017</a>)</cite>.
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S1.T1" title="Table 1 ‣ 1 Introduction ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a> shows the key differences between the progressive retrieval and the flat one.
<span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.1">FunnelRAG</span> features <span class="ltx_text ltx_font_bold" id="S1.p6.1.2">(1)</span> Coarse-to-fine granularity which balances load and accuracy; <span class="ltx_text ltx_font_bold" id="S1.p6.1.3">(2)</span> Later chunking which perceives the contextual information of retrieval units well<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Flat retrieval reranks passages that are not contextual integrity. However, our progressive retrieval perceives contextual information well in the post-ranking stage, since these passages are derived from documents with contextual integrity.</span></span></span>;
<span class="ltx_text ltx_font_bold" id="S1.p6.1.4">(3)</span> Compressed corpus (30x smaller from 21M to 600K) which reduces the burden on the retrieval stage; and <span class="ltx_text ltx_font_bold" id="S1.p6.1.5">(4)</span> Long retrieval unit which improves answer recall to the full extent. More details can be found in §<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3" title="3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">The main contributions of this work are summarized as three-folds: <span class="ltx_text ltx_font_bold" id="S1.p7.1.1">(1)</span> This work highlights the issues commonly encountered in real-world RAG systems while overlooked in the existing studies, <span class="ltx_text ltx_font_italic" id="S1.p7.1.2">i.e.,</span> the flat retrieval and constant granularity issues.
<span class="ltx_text ltx_font_bold" id="S1.p7.1.3">(2)</span> This work proposes <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.4">FunnelRAG</span>, a coarse-to-fine progressive retrieval paradigm for RAG, satisfying the three properties of being time-saving, fine-grained, and contextual-integrity.
<span class="ltx_text ltx_font_bold" id="S1.p7.1.5">(3)</span> Extensive experiments demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.6">FunnelRAG</span> can considerably reduce time overhead while the retrieval performance is comparable or even better in comparison  with  existing  retrieval  paradigms.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>General Retrieval Paradigm for RAG</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.11">In retrieval-augmented generation, we are given a query <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_q</annotation></semantics></math> and a document set <math alttext="\mathcal{D}=\{d_{1},d_{2},...,d_{|\mathcal{D}|}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.5"><semantics id="S2.SS1.p1.2.m2.5a"><mrow id="S2.SS1.p1.2.m2.5.5" xref="S2.SS1.p1.2.m2.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.5.5.5" xref="S2.SS1.p1.2.m2.5.5.5.cmml">𝒟</mi><mo id="S2.SS1.p1.2.m2.5.5.4" xref="S2.SS1.p1.2.m2.5.5.4.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.5.5.3.3" xref="S2.SS1.p1.2.m2.5.5.3.4.cmml"><mo id="S2.SS1.p1.2.m2.5.5.3.3.4" stretchy="false" xref="S2.SS1.p1.2.m2.5.5.3.4.cmml">{</mo><msub id="S2.SS1.p1.2.m2.3.3.1.1.1" xref="S2.SS1.p1.2.m2.3.3.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.3.3.1.1.1.2" xref="S2.SS1.p1.2.m2.3.3.1.1.1.2.cmml">d</mi><mn id="S2.SS1.p1.2.m2.3.3.1.1.1.3" xref="S2.SS1.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.5.5.3.3.5" xref="S2.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.4.4.2.2.2" xref="S2.SS1.p1.2.m2.4.4.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.4.4.2.2.2.2" xref="S2.SS1.p1.2.m2.4.4.2.2.2.2.cmml">d</mi><mn id="S2.SS1.p1.2.m2.4.4.2.2.2.3" xref="S2.SS1.p1.2.m2.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.2.m2.5.5.3.3.6" xref="S2.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><mi id="S2.SS1.p1.2.m2.2.2" mathvariant="normal" xref="S2.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S2.SS1.p1.2.m2.5.5.3.3.7" xref="S2.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.5.5.3.3.3" xref="S2.SS1.p1.2.m2.5.5.3.3.3.cmml"><mi id="S2.SS1.p1.2.m2.5.5.3.3.3.2" xref="S2.SS1.p1.2.m2.5.5.3.3.3.2.cmml">d</mi><mrow id="S2.SS1.p1.2.m2.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S2.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.cmml">𝒟</mi><mo id="S2.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S2.SS1.p1.2.m2.5.5.3.3.8" stretchy="false" xref="S2.SS1.p1.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.5b"><apply id="S2.SS1.p1.2.m2.5.5.cmml" xref="S2.SS1.p1.2.m2.5.5"><eq id="S2.SS1.p1.2.m2.5.5.4.cmml" xref="S2.SS1.p1.2.m2.5.5.4"></eq><ci id="S2.SS1.p1.2.m2.5.5.5.cmml" xref="S2.SS1.p1.2.m2.5.5.5">𝒟</ci><set id="S2.SS1.p1.2.m2.5.5.3.4.cmml" xref="S2.SS1.p1.2.m2.5.5.3.3"><apply id="S2.SS1.p1.2.m2.3.3.1.1.1.cmml" xref="S2.SS1.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.3.3.1.1.1.2">𝑑</ci><cn id="S2.SS1.p1.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.2.m2.4.4.2.2.2.cmml" xref="S2.SS1.p1.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.4.4.2.2.2.2">𝑑</ci><cn id="S2.SS1.p1.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.2.m2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2">…</ci><apply id="S2.SS1.p1.2.m2.5.5.3.3.3.cmml" xref="S2.SS1.p1.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.5.5.3.3.3.1.cmml" xref="S2.SS1.p1.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.5.5.3.3.3.2.cmml" xref="S2.SS1.p1.2.m2.5.5.3.3.3.2">𝑑</ci><apply id="S2.SS1.p1.2.m2.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.3"><abs id="S2.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S2.SS1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1">𝒟</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.5c">\mathcal{D}=\{d_{1},d_{2},...,d_{|\mathcal{D}|}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.5d">caligraphic_D = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_d start_POSTSUBSCRIPT | caligraphic_D | end_POSTSUBSCRIPT }</annotation></semantics></math>, where each document will be usually segmented into passage-level units, which results in a fine-grained corpus <math alttext="\mathcal{P}=\{p_{1},p_{2},...,p_{|\mathcal{P}|}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.5"><semantics id="S2.SS1.p1.3.m3.5a"><mrow id="S2.SS1.p1.3.m3.5.5" xref="S2.SS1.p1.3.m3.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.5.5.5" xref="S2.SS1.p1.3.m3.5.5.5.cmml">𝒫</mi><mo id="S2.SS1.p1.3.m3.5.5.4" xref="S2.SS1.p1.3.m3.5.5.4.cmml">=</mo><mrow id="S2.SS1.p1.3.m3.5.5.3.3" xref="S2.SS1.p1.3.m3.5.5.3.4.cmml"><mo id="S2.SS1.p1.3.m3.5.5.3.3.4" stretchy="false" xref="S2.SS1.p1.3.m3.5.5.3.4.cmml">{</mo><msub id="S2.SS1.p1.3.m3.3.3.1.1.1" xref="S2.SS1.p1.3.m3.3.3.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.3.3.1.1.1.2" xref="S2.SS1.p1.3.m3.3.3.1.1.1.2.cmml">p</mi><mn id="S2.SS1.p1.3.m3.3.3.1.1.1.3" xref="S2.SS1.p1.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.3.m3.5.5.3.3.5" xref="S2.SS1.p1.3.m3.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.3.m3.4.4.2.2.2" xref="S2.SS1.p1.3.m3.4.4.2.2.2.cmml"><mi id="S2.SS1.p1.3.m3.4.4.2.2.2.2" xref="S2.SS1.p1.3.m3.4.4.2.2.2.2.cmml">p</mi><mn id="S2.SS1.p1.3.m3.4.4.2.2.2.3" xref="S2.SS1.p1.3.m3.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.3.m3.5.5.3.3.6" xref="S2.SS1.p1.3.m3.5.5.3.4.cmml">,</mo><mi id="S2.SS1.p1.3.m3.2.2" mathvariant="normal" xref="S2.SS1.p1.3.m3.2.2.cmml">…</mi><mo id="S2.SS1.p1.3.m3.5.5.3.3.7" xref="S2.SS1.p1.3.m3.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.3.m3.5.5.3.3.3" xref="S2.SS1.p1.3.m3.5.5.3.3.3.cmml"><mi id="S2.SS1.p1.3.m3.5.5.3.3.3.2" xref="S2.SS1.p1.3.m3.5.5.3.3.3.2.cmml">p</mi><mrow id="S2.SS1.p1.3.m3.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.2.cmml"><mo id="S2.SS1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S2.SS1.p1.3.m3.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.cmml">𝒫</mi><mo id="S2.SS1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S2.SS1.p1.3.m3.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S2.SS1.p1.3.m3.5.5.3.3.8" stretchy="false" xref="S2.SS1.p1.3.m3.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.5b"><apply id="S2.SS1.p1.3.m3.5.5.cmml" xref="S2.SS1.p1.3.m3.5.5"><eq id="S2.SS1.p1.3.m3.5.5.4.cmml" xref="S2.SS1.p1.3.m3.5.5.4"></eq><ci id="S2.SS1.p1.3.m3.5.5.5.cmml" xref="S2.SS1.p1.3.m3.5.5.5">𝒫</ci><set id="S2.SS1.p1.3.m3.5.5.3.4.cmml" xref="S2.SS1.p1.3.m3.5.5.3.3"><apply id="S2.SS1.p1.3.m3.3.3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1.1.2">𝑝</ci><cn id="S2.SS1.p1.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.3.m3.4.4.2.2.2.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.3.m3.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2.2.2">𝑝</ci><cn id="S2.SS1.p1.3.m3.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.3.m3.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2">…</ci><apply id="S2.SS1.p1.3.m3.5.5.3.3.3.cmml" xref="S2.SS1.p1.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.5.5.3.3.3.1.cmml" xref="S2.SS1.p1.3.m3.5.5.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.3.m3.5.5.3.3.3.2.cmml" xref="S2.SS1.p1.3.m3.5.5.3.3.3.2">𝑝</ci><apply id="S2.SS1.p1.3.m3.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.3"><abs id="S2.SS1.p1.3.m3.1.1.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.3.1"></abs><ci id="S2.SS1.p1.3.m3.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1">𝒫</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.5c">\mathcal{P}=\{p_{1},p_{2},...,p_{|\mathcal{P}|}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.5d">caligraphic_P = { italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT | caligraphic_P | end_POSTSUBSCRIPT }</annotation></semantics></math> consisting of millions of short retrieval units. The de facto retrieval paradigm comprises two stages: <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.11.1">retrieval</span> and <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.11.2">reranking</span>.
The retrieval stage mostly employs a dense retriever, such as the Dense Passage Retriever <cite class="ltx_cite ltx_citemacro_cite">Karpukhin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib25" title="">2020</a>)</cite>, which projects each passage <math alttext="p\in\mathcal{P}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">p</mi><mo id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><in id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1"></in><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑝</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">p\in\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_p ∈ caligraphic_P</annotation></semantics></math> to an embedding <math alttext="\mathbf{E}(p)" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mrow id="S2.SS1.p1.5.m5.1.2" xref="S2.SS1.p1.5.m5.1.2.cmml"><mi id="S2.SS1.p1.5.m5.1.2.2" xref="S2.SS1.p1.5.m5.1.2.2.cmml">𝐄</mi><mo id="S2.SS1.p1.5.m5.1.2.1" xref="S2.SS1.p1.5.m5.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.5.m5.1.2.3.2" xref="S2.SS1.p1.5.m5.1.2.cmml"><mo id="S2.SS1.p1.5.m5.1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.5.m5.1.2.cmml">(</mo><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">p</mi><mo id="S2.SS1.p1.5.m5.1.2.3.2.2" stretchy="false" xref="S2.SS1.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.2.cmml" xref="S2.SS1.p1.5.m5.1.2"><times id="S2.SS1.p1.5.m5.1.2.1.cmml" xref="S2.SS1.p1.5.m5.1.2.1"></times><ci id="S2.SS1.p1.5.m5.1.2.2.cmml" xref="S2.SS1.p1.5.m5.1.2.2">𝐄</ci><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\mathbf{E}(p)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">bold_E ( italic_p )</annotation></semantics></math> and projects the query <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_q</annotation></semantics></math> to an embedding <math alttext="\mathbf{E}(q)" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mrow id="S2.SS1.p1.7.m7.1.2" xref="S2.SS1.p1.7.m7.1.2.cmml"><mi id="S2.SS1.p1.7.m7.1.2.2" xref="S2.SS1.p1.7.m7.1.2.2.cmml">𝐄</mi><mo id="S2.SS1.p1.7.m7.1.2.1" xref="S2.SS1.p1.7.m7.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.7.m7.1.2.3.2" xref="S2.SS1.p1.7.m7.1.2.cmml"><mo id="S2.SS1.p1.7.m7.1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.7.m7.1.2.cmml">(</mo><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">q</mi><mo id="S2.SS1.p1.7.m7.1.2.3.2.2" stretchy="false" xref="S2.SS1.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.2.cmml" xref="S2.SS1.p1.7.m7.1.2"><times id="S2.SS1.p1.7.m7.1.2.1.cmml" xref="S2.SS1.p1.7.m7.1.2.1"></times><ci id="S2.SS1.p1.7.m7.1.2.2.cmml" xref="S2.SS1.p1.7.m7.1.2.2">𝐄</ci><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">\mathbf{E}(q)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">bold_E ( italic_q )</annotation></semantics></math><span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Note that the embedding encoder <math alttext="\mathbf{E}(\cdot)" class="ltx_Math" display="inline" id="footnote3.m1.1"><semantics id="footnote3.m1.1b"><mrow id="footnote3.m1.1.2" xref="footnote3.m1.1.2.cmml"><mi id="footnote3.m1.1.2.2" xref="footnote3.m1.1.2.2.cmml">𝐄</mi><mo id="footnote3.m1.1.2.1" xref="footnote3.m1.1.2.1.cmml">⁢</mo><mrow id="footnote3.m1.1.2.3.2" xref="footnote3.m1.1.2.cmml"><mo id="footnote3.m1.1.2.3.2.1" stretchy="false" xref="footnote3.m1.1.2.cmml">(</mo><mo id="footnote3.m1.1.1" lspace="0em" rspace="0em" xref="footnote3.m1.1.1.cmml">⋅</mo><mo id="footnote3.m1.1.2.3.2.2" stretchy="false" xref="footnote3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote3.m1.1c"><apply id="footnote3.m1.1.2.cmml" xref="footnote3.m1.1.2"><times id="footnote3.m1.1.2.1.cmml" xref="footnote3.m1.1.2.1"></times><ci id="footnote3.m1.1.2.2.cmml" xref="footnote3.m1.1.2.2">𝐄</ci><ci id="footnote3.m1.1.1.cmml" xref="footnote3.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m1.1d">\mathbf{E}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="footnote3.m1.1e">bold_E ( ⋅ )</annotation></semantics></math> used for encoding queries and passages may not be the same, refer to <cite class="ltx_cite ltx_citemacro_cite">Karpukhin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib25" title="">2020</a>)</cite>. For  simplicity, we  do make no  distinction  here.</span></span></span>. Then, the top-<math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_k</annotation></semantics></math> relevant passages for query <math alttext="q" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">italic_q</annotation></semantics></math> are retrieved based on the query-passage embedding similarity, which is often computed by the dot product <math alttext="\mathbf{E}(q)^{\mathrm{T}}\mathbf{E}(p)" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.2"><semantics id="S2.SS1.p1.10.m10.2a"><mrow id="S2.SS1.p1.10.m10.2.3" xref="S2.SS1.p1.10.m10.2.3.cmml"><mi id="S2.SS1.p1.10.m10.2.3.2" xref="S2.SS1.p1.10.m10.2.3.2.cmml">𝐄</mi><mo id="S2.SS1.p1.10.m10.2.3.1" xref="S2.SS1.p1.10.m10.2.3.1.cmml">⁢</mo><msup id="S2.SS1.p1.10.m10.2.3.3" xref="S2.SS1.p1.10.m10.2.3.3.cmml"><mrow id="S2.SS1.p1.10.m10.2.3.3.2.2" xref="S2.SS1.p1.10.m10.2.3.3.cmml"><mo id="S2.SS1.p1.10.m10.2.3.3.2.2.1" stretchy="false" xref="S2.SS1.p1.10.m10.2.3.3.cmml">(</mo><mi id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml">q</mi><mo id="S2.SS1.p1.10.m10.2.3.3.2.2.2" stretchy="false" xref="S2.SS1.p1.10.m10.2.3.3.cmml">)</mo></mrow><mi id="S2.SS1.p1.10.m10.2.3.3.3" mathvariant="normal" xref="S2.SS1.p1.10.m10.2.3.3.3.cmml">T</mi></msup><mo id="S2.SS1.p1.10.m10.2.3.1a" xref="S2.SS1.p1.10.m10.2.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.10.m10.2.3.4" xref="S2.SS1.p1.10.m10.2.3.4.cmml">𝐄</mi><mo id="S2.SS1.p1.10.m10.2.3.1b" xref="S2.SS1.p1.10.m10.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.10.m10.2.3.5.2" xref="S2.SS1.p1.10.m10.2.3.cmml"><mo id="S2.SS1.p1.10.m10.2.3.5.2.1" stretchy="false" xref="S2.SS1.p1.10.m10.2.3.cmml">(</mo><mi id="S2.SS1.p1.10.m10.2.2" xref="S2.SS1.p1.10.m10.2.2.cmml">p</mi><mo id="S2.SS1.p1.10.m10.2.3.5.2.2" stretchy="false" xref="S2.SS1.p1.10.m10.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.2b"><apply id="S2.SS1.p1.10.m10.2.3.cmml" xref="S2.SS1.p1.10.m10.2.3"><times id="S2.SS1.p1.10.m10.2.3.1.cmml" xref="S2.SS1.p1.10.m10.2.3.1"></times><ci id="S2.SS1.p1.10.m10.2.3.2.cmml" xref="S2.SS1.p1.10.m10.2.3.2">𝐄</ci><apply id="S2.SS1.p1.10.m10.2.3.3.cmml" xref="S2.SS1.p1.10.m10.2.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.2.3.3.1.cmml" xref="S2.SS1.p1.10.m10.2.3.3">superscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">𝑞</ci><ci id="S2.SS1.p1.10.m10.2.3.3.3.cmml" xref="S2.SS1.p1.10.m10.2.3.3.3">T</ci></apply><ci id="S2.SS1.p1.10.m10.2.3.4.cmml" xref="S2.SS1.p1.10.m10.2.3.4">𝐄</ci><ci id="S2.SS1.p1.10.m10.2.2.cmml" xref="S2.SS1.p1.10.m10.2.2">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.2c">\mathbf{E}(q)^{\mathrm{T}}\mathbf{E}(p)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.2d">bold_E ( italic_q ) start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT bold_E ( italic_p )</annotation></semantics></math>.
After that, the reranking stage employs a higher capacity reranker (such as RankGPT <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib48" title="">2023</a>)</cite>) to filter out irrelevant passages. In the last, the top-<math alttext="n" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_n</annotation></semantics></math> ranked passages serve as the context of the generator to facilitate its generation.</p>
</div>
<figure class="ltx_figure" id="S2.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="248" id="S2.F2.sf1.g1" src="extracted/5924118/figures/coarse_to_fine_nq.png" width="295"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>NQ dataset.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="249" id="S2.F2.sf2.g1" src="extracted/5924118/figures/coarse_to_fine_tqa.png" width="281"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>TQA dataset.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>AR <span class="ltx_text ltx_font_italic" id="S2.F2.2.1">w.r.t.</span> coarse- and fine-grained retrieval. The bar denotes AR, while the line denotes the percentage of performance degradation compared to the cutoff position of 100%. The X-axis represents the percentage of units retrieved. Under the same percentile, the number of tokens retrieved by ‘Fine’ and ‘Coarse’ is equal.</figcaption>
</figure>
<figure class="ltx_figure" id="S2.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="150" id="S2.F3.sf1.g1" src="extracted/5924118/figures/high_to_low_nq.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>NQ dataset.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="147" id="S2.F3.sf2.g1" src="extracted/5924118/figures/high_to_low_tqa.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>TQA dataset.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Answer Recall <span class="ltx_text ltx_font_italic" id="S2.F3.2.1">w.r.t.</span> high- and low-capacity retrievers. The line denotes the percentage of performance improvement compared to  the  low-capacity  retriever.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Experiment for Assumption Validation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">As stated in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S1" title="1 Introduction ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a>, we emphasize the significance of (i) reducing the scale of candidates, (ii) refining the granularity of units, and (iii) increasing the level of retrievers’ capacity, throughout the retrieval paradigm. Here, we conduct empirical studies to verify claims (ii) and (iii), as it is obvious that claim (i) will lead to better retrieval accuracy<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Assuming a fixed number of golden units that exists in candidates, increasing the scale of candidates reduces the signal-to-noise ratio, inevitable degrading retrieval accuracy.</span></span></span> <cite class="ltx_cite ltx_citemacro_cite">Sawarkar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib43" title="">2024</a>)</cite>. We aim to evaluate whether these two claims can contribute to better retrieval performance, so as to validate that the progressive retrieval paradigm can balance effectiveness and efficiency well.
To empirically verify these claims, we construct two synthetic datasets for NQ and TQA. Specifically, for each query in NQ and TQA, we retrieve the top-10 relevant clustered documents from the coarse-grained corpus<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Referring to Section <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS1.SSS1" title="3.1.1 Retrieval Stage ‣ 3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3.1.1</span></a> and Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#alg1" title="Algorithm 1 ‣ Appendix D Cluster Document Algorithm ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a> for more technical details about how the clustered  documents  formulated.</span></span></span> using BM25 <cite class="ltx_cite ltx_citemacro_cite">Robertson and Zaragoza (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib41" title="">2009</a>)</cite>, where each one has approximate 4K tokens. Then, we segment each clustered document into document-level units with about 1K tokens, striking the coarse-fine contrast. On the other hand, we adopt bge-reranker-v2-m3 <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib3" title="">2024</a>)</cite> and BM25 to make a contrast between high- and low-capacity retrievers:</p>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.1.1">Coarse-Fine Contrast.</span> To simulate this scenario, we fix the retriever as bge-reranker-v2-m3 and use it to rerank coarse-grained (<span class="ltx_text ltx_font_italic" id="S2.I1.i1.p1.1.2">i.e.,</span> clustered documents) and fine-grained units (<span class="ltx_text ltx_font_italic" id="S2.I1.i1.p1.1.3">i.e.,</span> documents), respectively. We report the answer recall (AR) performance on the NQ and TQA<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>Answer Recall (AR) measures the recall of the answer string in all the retrieved units. We treat it as retrieval metric.</span></span></span>, which are presented in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S2.F2.sf1" title="In Figure 2 ‣ 2.1 General Retrieval Paradigm for RAG ‣ 2 Preliminaries ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">2(a)</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S2.F2.sf2" title="In Figure 2 ‣ 2.1 General Retrieval Paradigm for RAG ‣ 2 Preliminaries ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">2(b)</span></a>, respectively.
From the results, the answer recall with fine-grained retrieval substantially outperforms that with coarse-grained one. Additionally, the performance degradation with fine-grained retrieval is significantly slower than that with coarse-grained one. For example, on the NQ dataset, fine-grained retrieval only drops 2.25% of its original performance, while coarse-grained retrieval drops 37.93%, when the cutoff position is top 20%. Given the above, it is necessary and valuable to segment coarse-grained units into fine-grained units along progressive retrieval stages in order for  better  retrieval performance.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.1.1">High-Low Contrast.</span> To simulate this scenario, we fix the granularity of retrieval units as fine-grained ones and employ bge-reranker-v2-m3 and BM25 to rerank them, respectively. The experimental results are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S2.F3.sf1" title="In Figure 3 ‣ 2.1 General Retrieval Paradigm for RAG ‣ 2 Preliminaries ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3(a)</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S2.F3.sf2" title="In Figure 3 ‣ 2.1 General Retrieval Paradigm for RAG ‣ 2 Preliminaries ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3(b)</span></a>, respectively. From the results, we observe that the answer recall with the high-capacity retriever is consistently higher than that with the low-capacity one. In particular, the gain brought by the high-capacity retriever generally increases as the cutoff position decreases.
For example, on the NQ dataset, the retrieval performance improvement of ‘High’ over ‘Low’ is 5.45% and 0.60% in terms of cutoff@10% and cutoff@20%. These observations indicate that using high-capacity retrievers in later stages can retain the golden retrieval units to a large extent.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The overall framework of <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.1">FunnelRAG</span> is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.F4" title="Figure 4 ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">4</span></a>. Then, we introduce three progressive retrieval stages from coarse to fine (§<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS1" title="3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3.1</span></a>) and then describe how to distill aggregated signals from the succeeding retriever  to the  preceding  one  (§<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS2" title="3.2 Distillation with Aggregated Signals ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3.2</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="155" id="S3.F4.g1" src="extracted/5924118/figures/framework.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The overall system framework of <span class="ltx_text ltx_font_smallcaps" id="S3.F4.4.1">FunnelRAG</span>. The upper layer illustrates the working flow of the <span class="ltx_text ltx_font_bold" id="S3.F4.5.2" style="color:#385723;">flat retrieval paradigm</span>, while  the bottom  layer  illustrates the  working flow  of our <span class="ltx_text ltx_font_bold" id="S3.F4.6.3" style="color:#1F4E79;">progressive retrieval paradigm</span>.</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Coarse-to-Fine Progressive Retrieval</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">To better balance effectiveness and efficiency, we propose a progressive retrieval paradigm, which enables load balancing and improves retrieval accuracy by collaborating mixed-capacity retrievers, refining retrieval granularity, and reducing candidate scale.
It can be formulated into three stages: (1) Retrieval, which usually uses relatively simple bi-encoder models to retrieve coarse-grained units; (2) Pre-ranking, which adopts cross-encoder models to rank the previously retrieved units; and (3) Post-ranking, which employs relatively complex list-wise models to rank these fine-grained units. We provide an intuitive example in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS5" title="C.5 Case Study ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">C.5</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Retrieval Stage</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.3">This stage plays a role in improving answer recall (AR) to the full extent, without considering the granularity of the retrieval unit. Toward this end, we propose to convert the document set <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.1.m1.1"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.1.m1.1d">caligraphic_D</annotation></semantics></math> into long retrieval (coarse-grained) units, which is proven to be effective in improving AR <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib21" title="">2024</a>)</cite>.
Specifically, we cluster documents in <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.2.m2.1"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><ci id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.2.m2.1d">caligraphic_D</annotation></semantics></math> based on their relationships, <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS1.p1.3.1">i.e.,</span> hyperlinks embedded within each document, and finally results in  a  coarse-grained  corpus  <math alttext="\mathcal{C}=\{c_{1},c_{2},...,c_{|\mathcal{C}|}\}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.3.m3.5"><semantics id="S3.SS1.SSS1.p1.3.m3.5a"><mrow id="S3.SS1.SSS1.p1.3.m3.5.5" xref="S3.SS1.SSS1.p1.3.m3.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.3.m3.5.5.5" xref="S3.SS1.SSS1.p1.3.m3.5.5.5.cmml">𝒞</mi><mo id="S3.SS1.SSS1.p1.3.m3.5.5.4" xref="S3.SS1.SSS1.p1.3.m3.5.5.4.cmml">=</mo><mrow id="S3.SS1.SSS1.p1.3.m3.5.5.3.3" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.4.cmml"><mo id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.4" stretchy="false" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.4.cmml">{</mo><msub id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.2" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.2.cmml">c</mi><mn id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.5" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.2" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.2.cmml">c</mi><mn id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.3" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.6" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.4.cmml">,</mo><mi id="S3.SS1.SSS1.p1.3.m3.2.2" mathvariant="normal" xref="S3.SS1.SSS1.p1.3.m3.2.2.cmml">…</mi><mo id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.7" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3.2" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3.2.cmml">c</mi><mrow id="S3.SS1.SSS1.p1.3.m3.1.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.2.cmml"><mo id="S3.SS1.SSS1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.3.m3.1.1.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.1.cmml">𝒞</mi><mo id="S3.SS1.SSS1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.8" stretchy="false" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.5b"><apply id="S3.SS1.SSS1.p1.3.m3.5.5.cmml" xref="S3.SS1.SSS1.p1.3.m3.5.5"><eq id="S3.SS1.SSS1.p1.3.m3.5.5.4.cmml" xref="S3.SS1.SSS1.p1.3.m3.5.5.4"></eq><ci id="S3.SS1.SSS1.p1.3.m3.5.5.5.cmml" xref="S3.SS1.SSS1.p1.3.m3.5.5.5">𝒞</ci><set id="S3.SS1.SSS1.p1.3.m3.5.5.3.4.cmml" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.3"><apply id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.2">𝑐</ci><cn id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.2">𝑐</ci><cn id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS1.p1.3.m3.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.2.2">…</ci><apply id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.5.5.3.3.3.2">𝑐</ci><apply id="S3.SS1.SSS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.3"><abs id="S3.SS1.SSS1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.3.1"></abs><ci id="S3.SS1.SSS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.1">𝒞</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.5c">\mathcal{C}=\{c_{1},c_{2},...,c_{|\mathcal{C}|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.3.m3.5d">caligraphic_C = { italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT | caligraphic_C | end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p2">
<p class="ltx_p" id="S3.SS1.SSS1.p2.5">The clustering algorithm is presented in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A4" title="Appendix D Cluster Document Algorithm ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">D</span></a> in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#alg1" title="Algorithm 1 ‣ Appendix D Cluster Document Algorithm ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a>, where we draw inspiration from <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib21" title="">2024</a>)</cite> but make several major modifications.
Specially, we sort documents by their local cluster coefficient from high to low in Line 1, so that documents with highly relevant will be clustered first.
Furthermore, we measure the closeness centrality between document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.1.m1.1"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><mi id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><ci id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.1.m1.1d">italic_d</annotation></semantics></math> and its related clusters <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.2.m2.1"><semantics id="S3.SS1.SSS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p2.2.m2.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.2.m2.1b"><ci id="S3.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.2.m2.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.2.m2.1d">caligraphic_R</annotation></semantics></math> and sort them from high to low in Line 10, so that the most related cluster will be merged first. Each cluster <math alttext="c" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.3.m3.1"><semantics id="S3.SS1.SSS1.p2.3.m3.1a"><mi id="S3.SS1.SSS1.p2.3.m3.1.1" xref="S3.SS1.SSS1.p2.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.3.m3.1b"><ci id="S3.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.3.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.3.m3.1d">italic_c</annotation></semantics></math> in <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.4.m4.1"><semantics id="S3.SS1.SSS1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p2.4.m4.1.1" xref="S3.SS1.SSS1.p2.4.m4.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.4.m4.1b"><ci id="S3.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.4.m4.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.4.m4.1d">caligraphic_C</annotation></semantics></math> is a list of documents related to each other.
We set the max cluster size <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p2.5.m5.1"><semantics id="S3.SS1.SSS1.p2.5.m5.1a"><mi id="S3.SS1.SSS1.p2.5.m5.1.1" xref="S3.SS1.SSS1.p2.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.5.m5.1b"><ci id="S3.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p2.5.m5.1d">italic_S</annotation></semantics></math> as 4K tokens because the experimental results (§<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.SS4" title="4.4 Study of FunnelRAG (RQ3) ‣ 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">4.4</span></a>) demonstrate that overlength retrieval units do not bring much benefits to answer  recall.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p3">
<p class="ltx_p" id="S3.SS1.SSS1.p3.3">Currently, it is challenging and underperforming for dense retrievers to handle long context, even with the SOTA dense retrievers, <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS1.p3.3.1">e.g,</span> BGE-M3 <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib3" title="">2024</a>)</cite>.
In LongRAG <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib21" title="">2024</a>)</cite>, they handle long context by maximizing the scores of all chunks within each long retrieval unit, where they segment each long unit into 512-token chunks.
However, this practice has no essential difference with direct retrieval of short units and is computation-consuming. As the goal of this stage is to improve AR regardless of granularity, we use sparse retrievers to handle long context, which shows more effective than dense retrievers in long-doc retrieval <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib3" title="">2024</a>)</cite>.
Without loss of generality, we adopt the representative sparse retriever in this work, <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS1.p3.3.2">i.e.,</span> BM25 <cite class="ltx_cite ltx_citemacro_cite">Robertson and Zaragoza (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib41" title="">2009</a>)</cite>, whose computational cost is far below dense retrievers.
Lastly, we use BM25 to retrieve the top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p3.1.m1.1"><semantics id="S3.SS1.SSS1.p3.1.m1.1a"><mi id="S3.SS1.SSS1.p3.1.m1.1.1" xref="S3.SS1.SSS1.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.1.m1.1b"><ci id="S3.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p3.1.m1.1d">italic_K</annotation></semantics></math> relevant long units <math alttext="\mathcal{C}_{{l}}=\{c_{1}^{l},c_{2}^{l},...,c_{K}^{l}\}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p3.2.m2.4"><semantics id="S3.SS1.SSS1.p3.2.m2.4a"><mrow id="S3.SS1.SSS1.p3.2.m2.4.4" xref="S3.SS1.SSS1.p3.2.m2.4.4.cmml"><msub id="S3.SS1.SSS1.p3.2.m2.4.4.5" xref="S3.SS1.SSS1.p3.2.m2.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p3.2.m2.4.4.5.2" xref="S3.SS1.SSS1.p3.2.m2.4.4.5.2.cmml">𝒞</mi><mi id="S3.SS1.SSS1.p3.2.m2.4.4.5.3" xref="S3.SS1.SSS1.p3.2.m2.4.4.5.3.cmml">l</mi></msub><mo id="S3.SS1.SSS1.p3.2.m2.4.4.4" xref="S3.SS1.SSS1.p3.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS1.SSS1.p3.2.m2.4.4.3.3" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.4.cmml"><mo id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.4.cmml">{</mo><msubsup id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.2" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.2.cmml">c</mi><mn id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.3" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.3" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.3.cmml">l</mi></msubsup><mo id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.5" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.2" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.2.cmml">c</mi><mn id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.3" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.3" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.6" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS1.SSS1.p3.2.m2.1.1" mathvariant="normal" xref="S3.SS1.SSS1.p3.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.7" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.2" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.2.cmml">c</mi><mi id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.3" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.3.cmml">K</mi><mi id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.3" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.3.cmml">l</mi></msubsup><mo id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.2.m2.4b"><apply id="S3.SS1.SSS1.p3.2.m2.4.4.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4"><eq id="S3.SS1.SSS1.p3.2.m2.4.4.4.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.4"></eq><apply id="S3.SS1.SSS1.p3.2.m2.4.4.5.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.4.4.5.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.5">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.4.4.5.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.5.2">𝒞</ci><ci id="S3.SS1.SSS1.p3.2.m2.4.4.5.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.5.3">𝑙</ci></apply><set id="S3.SS1.SSS1.p3.2.m2.4.4.3.4.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3"><apply id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.2">𝑐</ci><cn id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.2.2.1.1.1.3">𝑙</ci></apply><apply id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2">superscript</csymbol><apply id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.2">𝑐</ci><cn id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.3.3.2.2.2.3">𝑙</ci></apply><ci id="S3.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1">…</ci><apply id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3">superscript</csymbol><apply id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.2">𝑐</ci><ci id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.2.3">𝐾</ci></apply><ci id="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.4.4.3.3.3.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.2.m2.4c">\mathcal{C}_{{l}}=\{c_{1}^{l},c_{2}^{l},...,c_{K}^{l}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p3.2.m2.4d">caligraphic_C start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = { italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT }</annotation></semantics></math>. We set <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p3.3.m3.1"><semantics id="S3.SS1.SSS1.p3.3.m3.1a"><mi id="S3.SS1.SSS1.p3.3.m3.1.1" xref="S3.SS1.SSS1.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.3.m3.1b"><ci id="S3.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p3.3.m3.1d">italic_K</annotation></semantics></math> as a proper value (<span class="ltx_text ltx_font_italic" id="S3.SS1.SSS1.p3.3.3">e.g.,</span> 80) to achieve relatively high AR and reduce the computational burden  of the following stages.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Pre-ranking Stage</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.5">This stage plays a role in finding the “needle” (<span class="ltx_text ltx_font_italic" id="S3.SS1.SSS2.p1.5.1">i.e.,</span> the document containing the answer string) from the “needle case” (<span class="ltx_text ltx_font_italic" id="S3.SS1.SSS2.p1.5.2">i.e.,</span> the retrieved clusters) rather than the “haystack” (millions in most cases).
The corpus size is the key difference between the existing retrieval paradigm and ours, where the corpus size of ours is hundreds, making it easy to find the “needle”. Formally, we first segment each cluster <math alttext="c^{l}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.1.m1.1"><semantics id="S3.SS1.SSS2.p1.1.m1.1a"><msup id="S3.SS1.SSS2.p1.1.m1.1.1" xref="S3.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.1.m1.1.1.2" xref="S3.SS1.SSS2.p1.1.m1.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS2.p1.1.m1.1.1.3" xref="S3.SS1.SSS2.p1.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.1.m1.1b"><apply id="S3.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.2">𝑐</ci><ci id="S3.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.1.m1.1c">c^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.1.m1.1d">italic_c start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> in <math alttext="\mathcal{C}_{{l}}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.2.m2.1"><semantics id="S3.SS1.SSS2.p1.2.m2.1a"><msub id="S3.SS1.SSS2.p1.2.m2.1.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p1.2.m2.1.1.2" xref="S3.SS1.SSS2.p1.2.m2.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.SSS2.p1.2.m2.1.1.3" xref="S3.SS1.SSS2.p1.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.2.m2.1b"><apply id="S3.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.2">𝒞</ci><ci id="S3.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.2.m2.1c">\mathcal{C}_{{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.2.m2.1d">caligraphic_C start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> into document-level units <math alttext="d" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.3.m3.1"><semantics id="S3.SS1.SSS2.p1.3.m3.1a"><mi id="S3.SS1.SSS2.p1.3.m3.1.1" xref="S3.SS1.SSS2.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.3.m3.1b"><ci id="S3.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.3.m3.1d">italic_d</annotation></semantics></math>. And then, we utilize a cross-encoder model, denoted as <math alttext="f(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.4.m4.1"><semantics id="S3.SS1.SSS2.p1.4.m4.1a"><mrow id="S3.SS1.SSS2.p1.4.m4.1.2" xref="S3.SS1.SSS2.p1.4.m4.1.2.cmml"><mi id="S3.SS1.SSS2.p1.4.m4.1.2.2" xref="S3.SS1.SSS2.p1.4.m4.1.2.2.cmml">f</mi><mo id="S3.SS1.SSS2.p1.4.m4.1.2.1" xref="S3.SS1.SSS2.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS2.p1.4.m4.1.2.3.2" xref="S3.SS1.SSS2.p1.4.m4.1.2.cmml"><mo id="S3.SS1.SSS2.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS2.p1.4.m4.1.2.cmml">(</mo><mo id="S3.SS1.SSS2.p1.4.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS1.SSS2.p1.4.m4.1.1.cmml">⋅</mo><mo id="S3.SS1.SSS2.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.4.m4.1b"><apply id="S3.SS1.SSS2.p1.4.m4.1.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.2"><times id="S3.SS1.SSS2.p1.4.m4.1.2.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.2.1"></times><ci id="S3.SS1.SSS2.p1.4.m4.1.2.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.2.2">𝑓</ci><ci id="S3.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.4.m4.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.4.m4.1d">italic_f ( ⋅ )</annotation></semantics></math>, to measure their  pre-ranking  scores  to  the query  <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.5.m5.1"><semantics id="S3.SS1.SSS2.p1.5.m5.1a"><mi id="S3.SS1.SSS2.p1.5.m5.1.1" xref="S3.SS1.SSS2.p1.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.5.m5.1b"><ci id="S3.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p1.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.5.m5.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.5.m5.1d">italic_q</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S^{{pre}}=f(q,d)." class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msup id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml">S</mi><mrow id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.2.3.2.cmml">p</mi><mo id="S3.E1.m1.3.3.1.1.2.3.1" xref="S3.E1.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.3.3" xref="S3.E1.m1.3.3.1.1.2.3.3.cmml">r</mi><mo id="S3.E1.m1.3.3.1.1.2.3.1a" xref="S3.E1.m1.3.3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.3.4" xref="S3.E1.m1.3.3.1.1.2.3.4.cmml">e</mi></mrow></msup><mo id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml">f</mi><mo id="S3.E1.m1.3.3.1.1.3.1" xref="S3.E1.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml"><mo id="S3.E1.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">q</mi><mo id="S3.E1.m1.3.3.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">d</mi><mo id="S3.E1.m1.3.3.1.1.3.3.2.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" lspace="0em" xref="S3.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"></eq><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2">𝑆</ci><apply id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3"><times id="S3.E1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.3.1"></times><ci id="S3.E1.m1.3.3.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.3.2">𝑝</ci><ci id="S3.E1.m1.3.3.1.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3.3">𝑟</ci><ci id="S3.E1.m1.3.3.1.1.2.3.4.cmml" xref="S3.E1.m1.3.3.1.1.2.3.4">𝑒</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><times id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1"></times><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">𝑓</ci><interval closure="open" id="S3.E1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑞</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑑</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">S^{{pre}}=f(q,d).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">italic_S start_POSTSUPERSCRIPT italic_p italic_r italic_e end_POSTSUPERSCRIPT = italic_f ( italic_q , italic_d ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS2.p1.7">Given pre-ranking scores, we retrieve top-<math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.6.m1.1"><semantics id="S3.SS1.SSS2.p1.6.m1.1a"><mi id="S3.SS1.SSS2.p1.6.m1.1.1" xref="S3.SS1.SSS2.p1.6.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.6.m1.1b"><ci id="S3.SS1.SSS2.p1.6.m1.1.1.cmml" xref="S3.SS1.SSS2.p1.6.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.6.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.6.m1.1d">italic_N</annotation></semantics></math> documents closest to the query <math alttext="\mathcal{D}_{m}=\{d_{1}^{m},d_{2}^{m},...,d_{N}^{m}\}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p1.7.m2.4"><semantics id="S3.SS1.SSS2.p1.7.m2.4a"><mrow id="S3.SS1.SSS2.p1.7.m2.4.4" xref="S3.SS1.SSS2.p1.7.m2.4.4.cmml"><msub id="S3.SS1.SSS2.p1.7.m2.4.4.5" xref="S3.SS1.SSS2.p1.7.m2.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p1.7.m2.4.4.5.2" xref="S3.SS1.SSS2.p1.7.m2.4.4.5.2.cmml">𝒟</mi><mi id="S3.SS1.SSS2.p1.7.m2.4.4.5.3" xref="S3.SS1.SSS2.p1.7.m2.4.4.5.3.cmml">m</mi></msub><mo id="S3.SS1.SSS2.p1.7.m2.4.4.4" xref="S3.SS1.SSS2.p1.7.m2.4.4.4.cmml">=</mo><mrow id="S3.SS1.SSS2.p1.7.m2.4.4.3.3" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.4.cmml"><mo id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.4" stretchy="false" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.4.cmml">{</mo><msubsup id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.2" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.2.cmml">d</mi><mn id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.3" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.3" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.3.cmml">m</mi></msubsup><mo id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.5" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.2" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.2.cmml">d</mi><mn id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.3" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.3" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.3.cmml">m</mi></msubsup><mo id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.6" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS1.SSS2.p1.7.m2.1.1" mathvariant="normal" xref="S3.SS1.SSS2.p1.7.m2.1.1.cmml">…</mi><mo id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.7" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.cmml"><mi id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.2" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.2.cmml">d</mi><mi id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.3" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.3.cmml">N</mi><mi id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.3" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.3.cmml">m</mi></msubsup><mo id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.8" stretchy="false" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.7.m2.4b"><apply id="S3.SS1.SSS2.p1.7.m2.4.4.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4"><eq id="S3.SS1.SSS2.p1.7.m2.4.4.4.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.4"></eq><apply id="S3.SS1.SSS2.p1.7.m2.4.4.5.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.7.m2.4.4.5.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.5">subscript</csymbol><ci id="S3.SS1.SSS2.p1.7.m2.4.4.5.2.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.5.2">𝒟</ci><ci id="S3.SS1.SSS2.p1.7.m2.4.4.5.3.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.5.3">𝑚</ci></apply><set id="S3.SS1.SSS2.p1.7.m2.4.4.3.4.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3"><apply id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.2">𝑑</ci><cn id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS2.p1.7.m2.2.2.1.1.1.3">𝑚</ci></apply><apply id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.cmml" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2">superscript</csymbol><apply id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.2">𝑑</ci><cn id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p1.7.m2.3.3.2.2.2.3">𝑚</ci></apply><ci id="S3.SS1.SSS2.p1.7.m2.1.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.1.1">…</ci><apply id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3">superscript</csymbol><apply id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.1.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.2.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.2">𝑑</ci><ci id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.3.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.2.3">𝑁</ci></apply><ci id="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.SSS2.p1.7.m2.4.4.3.3.3.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.7.m2.4c">\mathcal{D}_{m}=\{d_{1}^{m},d_{2}^{m},...,d_{N}^{m}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p1.7.m2.4d">caligraphic_D start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT , italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT , … , italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT }</annotation></semantics></math>.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S2.F2" title="Figure 2 ‣ 2.1 General Retrieval Paradigm for RAG ‣ 2 Preliminaries ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">2</span></a> shows the performance comparison between fine-grained and coarse-grained units. The results indicate that the finer retrieval units can significantly reduce the loss of retrieval performance.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Post-ranking Stage</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.3">This stage plays a role in identifying fine-grained units that align with language models’ preferences. We segment each document into passage-level units <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.1.m1.1"><semantics id="S3.SS1.SSS3.p1.1.m1.1a"><mi id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.1b"><ci id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.1.m1.1d">italic_p</annotation></semantics></math> in this relatively late stage.
Referring to <cite class="ltx_cite ltx_citemacro_cite">JinaAI (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib22" title="">2024</a>)</cite>, we term this technique as “<span class="ltx_text ltx_font_bold" id="S3.SS1.SSS3.p1.3.1">Later Chunking</span>”, which retrieves long units in the previous stages to preserve contextual semantics well and then segments long units into fine-grained units in the later stages for better retrieval applications.
After chunking, we obtain <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.2.m2.1"><semantics id="S3.SS1.SSS3.p1.2.m2.1a"><mi id="S3.SS1.SSS3.p1.2.m2.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m2.1b"><ci id="S3.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.2.m2.1d">italic_M</annotation></semantics></math> passages <math alttext="\{p_{1}^{f},p_{2}^{f},...,p_{M}^{f}\}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.3.m3.4"><semantics id="S3.SS1.SSS3.p1.3.m3.4a"><mrow id="S3.SS1.SSS3.p1.3.m3.4.4.3" xref="S3.SS1.SSS3.p1.3.m3.4.4.4.cmml"><mo id="S3.SS1.SSS3.p1.3.m3.4.4.3.4" stretchy="false" xref="S3.SS1.SSS3.p1.3.m3.4.4.4.cmml">{</mo><msubsup id="S3.SS1.SSS3.p1.3.m3.2.2.1.1" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.2" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.2.cmml">p</mi><mn id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.3" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.3" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.3.cmml">f</mi></msubsup><mo id="S3.SS1.SSS3.p1.3.m3.4.4.3.5" xref="S3.SS1.SSS3.p1.3.m3.4.4.4.cmml">,</mo><msubsup id="S3.SS1.SSS3.p1.3.m3.3.3.2.2" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.2.cmml">p</mi><mn id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.3" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.3.cmml">f</mi></msubsup><mo id="S3.SS1.SSS3.p1.3.m3.4.4.3.6" xref="S3.SS1.SSS3.p1.3.m3.4.4.4.cmml">,</mo><mi id="S3.SS1.SSS3.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS1.SSS3.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.SSS3.p1.3.m3.4.4.3.7" xref="S3.SS1.SSS3.p1.3.m3.4.4.4.cmml">,</mo><msubsup id="S3.SS1.SSS3.p1.3.m3.4.4.3.3" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3.cmml"><mi id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.2" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.2.cmml">p</mi><mi id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.3" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.3.cmml">M</mi><mi id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.3" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3.3.cmml">f</mi></msubsup><mo id="S3.SS1.SSS3.p1.3.m3.4.4.3.8" stretchy="false" xref="S3.SS1.SSS3.p1.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.3.m3.4b"><set id="S3.SS1.SSS3.p1.3.m3.4.4.4.cmml" xref="S3.SS1.SSS3.p1.3.m3.4.4.3"><apply id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.2">𝑝</ci><cn id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.3">𝑓</ci></apply><apply id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2">superscript</csymbol><apply id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.2">𝑝</ci><cn id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.3">𝑓</ci></apply><ci id="S3.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.1.1">…</ci><apply id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3">superscript</csymbol><apply id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.2">𝑝</ci><ci id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3.2.3">𝑀</ci></apply><ci id="S3.SS1.SSS3.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.4.4.3.3.3">𝑓</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.3.m3.4c">\{p_{1}^{f},p_{2}^{f},...,p_{M}^{f}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.3.m3.4d">{ italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT }</annotation></semantics></math>. Then, a practical question naturally arises: <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS3.p1.3.2">How do efficiently post-rank these fine-grained units to align language models’ preferences?</span>
A straightforward way is to serve LLMs as agents to post-rank passages with their preferences, <span class="ltx_text ltx_font_italic" id="S3.SS1.SSS3.p1.3.3">e.g.,</span> RankGPT <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib48" title="">2023</a>)</cite> and RankVicuna <cite class="ltx_cite ltx_citemacro_cite">Pradeep et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib38" title="">2023</a>)</cite>.
Nevertheless, directly using LLMs as rankers inevitably inflicts a significant computational burden on the post-ranking stage, making it  very  difficult  to  deploy  in  production.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS3.p2">
<p class="ltx_p" id="S3.SS1.SSS3.p2.2">Instead of heuristically instructing LLMs to post-rank, our post-ranker builds upon FiD (Fusion-in-Decoder) <cite class="ltx_cite ltx_citemacro_cite">Izacard and Grave (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib18" title="">2021b</a>)</cite>, a retrieval-augmented encoder-decoder language model. Specifically, each passage <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.1.m1.1"><semantics id="S3.SS1.SSS3.p2.1.m1.1a"><mi id="S3.SS1.SSS3.p2.1.m1.1.1" xref="S3.SS1.SSS3.p2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.1.m1.1b"><ci id="S3.SS1.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.1.m1.1d">italic_p</annotation></semantics></math> is paired with the query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.2.m2.1"><semantics id="S3.SS1.SSS3.p2.2.m2.1a"><mi id="S3.SS1.SSS3.p2.2.m2.1.1" xref="S3.SS1.SSS3.p2.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.2.m2.1b"><ci id="S3.SS1.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.2.m2.1d">italic_q</annotation></semantics></math> to be processed separately by the T5 <cite class="ltx_cite ltx_citemacro_cite">Raffel et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib39" title="">2020</a>)</cite> encoder.
Subsequently, the encoded representations are concatenated along the sequence dimension. Lastly, the T5 <cite class="ltx_cite ltx_citemacro_cite">Raffel et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib39" title="">2020</a>)</cite> decoder attends all of parts simultaneously:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{FiD}(q,\mathcal{P}_{f})=\text{Dec}\big{(}\mathbf{H}_{q,p_{1}^{f}}\|,...,%
\|\mathbf{H}_{q,p_{M}^{f}}\big{)}," class="ltx_math_unparsed" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5b"><mtext id="S3.E2.m1.5.6">FiD</mtext><mrow id="S3.E2.m1.5.7"><mo id="S3.E2.m1.5.7.1" stretchy="false">(</mo><mi id="S3.E2.m1.5.5">q</mi><mo id="S3.E2.m1.5.7.2">,</mo><msub id="S3.E2.m1.5.7.3"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.7.3.2">𝒫</mi><mi id="S3.E2.m1.5.7.3.3">f</mi></msub><mo id="S3.E2.m1.5.7.4" stretchy="false">)</mo></mrow><mo id="S3.E2.m1.5.8">=</mo><mtext id="S3.E2.m1.5.9">Dec</mtext><mrow id="S3.E2.m1.5.10"><mo id="S3.E2.m1.5.10.1" maxsize="120%" minsize="120%">(</mo><msub id="S3.E2.m1.5.10.2"><mi id="S3.E2.m1.5.10.2.2">𝐇</mi><mrow id="S3.E2.m1.2.2.2.2"><mi id="S3.E2.m1.1.1.1.1">q</mi><mo id="S3.E2.m1.2.2.2.2.2">,</mo><msubsup id="S3.E2.m1.2.2.2.2.1"><mi id="S3.E2.m1.2.2.2.2.1.2.2">p</mi><mn id="S3.E2.m1.2.2.2.2.1.2.3">1</mn><mi id="S3.E2.m1.2.2.2.2.1.3">f</mi></msubsup></mrow></msub><mo id="S3.E2.m1.5.10.3" lspace="0em" rspace="0.167em">∥</mo><mo id="S3.E2.m1.5.10.4">,</mo><mi id="S3.E2.m1.5.10.5" mathvariant="normal">…</mi><mo id="S3.E2.m1.5.10.6">,</mo><mo id="S3.E2.m1.5.10.7" lspace="0em" rspace="0.167em">∥</mo><msub id="S3.E2.m1.5.10.8"><mi id="S3.E2.m1.5.10.8.2">𝐇</mi><mrow id="S3.E2.m1.4.4.2.2"><mi id="S3.E2.m1.3.3.1.1">q</mi><mo id="S3.E2.m1.4.4.2.2.2">,</mo><msubsup id="S3.E2.m1.4.4.2.2.1"><mi id="S3.E2.m1.4.4.2.2.1.2.2">p</mi><mi id="S3.E2.m1.4.4.2.2.1.2.3">M</mi><mi id="S3.E2.m1.4.4.2.2.1.3">f</mi></msubsup></mrow></msub><mo id="S3.E2.m1.5.10.9" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S3.E2.m1.5.11">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\text{FiD}(q,\mathcal{P}_{f})=\text{Dec}\big{(}\mathbf{H}_{q,p_{1}^{f}}\|,...,%
\|\mathbf{H}_{q,p_{M}^{f}}\big{)},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">FiD ( italic_q , caligraphic_P start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ) = Dec ( bold_H start_POSTSUBSCRIPT italic_q , italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∥ , … , ∥ bold_H start_POSTSUBSCRIPT italic_q , italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS3.p2.10">where <math alttext="\mathbf{H}_{q,p^{f}}=\text{Enc}(q\oplus p^{f})" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.3.m1.3"><semantics id="S3.SS1.SSS3.p2.3.m1.3a"><mrow id="S3.SS1.SSS3.p2.3.m1.3.3" xref="S3.SS1.SSS3.p2.3.m1.3.3.cmml"><msub id="S3.SS1.SSS3.p2.3.m1.3.3.3" xref="S3.SS1.SSS3.p2.3.m1.3.3.3.cmml"><mi id="S3.SS1.SSS3.p2.3.m1.3.3.3.2" xref="S3.SS1.SSS3.p2.3.m1.3.3.3.2.cmml">𝐇</mi><mrow id="S3.SS1.SSS3.p2.3.m1.2.2.2.2" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.3.cmml"><mi id="S3.SS1.SSS3.p2.3.m1.1.1.1.1" xref="S3.SS1.SSS3.p2.3.m1.1.1.1.1.cmml">q</mi><mo id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.2" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.3.cmml">,</mo><msup id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.cmml"><mi id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.2" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.2.cmml">p</mi><mi id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.3" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.3.cmml">f</mi></msup></mrow></msub><mo id="S3.SS1.SSS3.p2.3.m1.3.3.2" xref="S3.SS1.SSS3.p2.3.m1.3.3.2.cmml">=</mo><mrow id="S3.SS1.SSS3.p2.3.m1.3.3.1" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.cmml"><mtext id="S3.SS1.SSS3.p2.3.m1.3.3.1.3" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.3a.cmml">Enc</mtext><mo id="S3.SS1.SSS3.p2.3.m1.3.3.1.2" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.cmml"><mo id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.2" stretchy="false" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.cmml"><mi id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.2" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.2.cmml">q</mi><mo id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.1" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.1.cmml">⊕</mo><msup id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.2" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.2.cmml">p</mi><mi id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.3" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.3.cmml">f</mi></msup></mrow><mo id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.3" stretchy="false" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.3.m1.3b"><apply id="S3.SS1.SSS3.p2.3.m1.3.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3"><eq id="S3.SS1.SSS3.p2.3.m1.3.3.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.2"></eq><apply id="S3.SS1.SSS3.p2.3.m1.3.3.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.3.m1.3.3.3.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.3.m1.3.3.3.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.3.2">𝐇</ci><list id="S3.SS1.SSS3.p2.3.m1.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2"><ci id="S3.SS1.SSS3.p2.3.m1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.1.1.1.1">𝑞</ci><apply id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.2">𝑝</ci><ci id="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.2.2.2.2.1.3">𝑓</ci></apply></list></apply><apply id="S3.SS1.SSS3.p2.3.m1.3.3.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1"><times id="S3.SS1.SSS3.p2.3.m1.3.3.1.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.2"></times><ci id="S3.SS1.SSS3.p2.3.m1.3.3.1.3a.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.3"><mtext id="S3.SS1.SSS3.p2.3.m1.3.3.1.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.3">Enc</mtext></ci><apply id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.1">direct-sum</csymbol><ci id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.2">𝑞</ci><apply id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.2">𝑝</ci><ci id="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.3.m1.3.3.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.3.m1.3c">\mathbf{H}_{q,p^{f}}=\text{Enc}(q\oplus p^{f})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.3.m1.3d">bold_H start_POSTSUBSCRIPT italic_q , italic_p start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = Enc ( italic_q ⊕ italic_p start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT )</annotation></semantics></math>; <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.4.m2.1"><semantics id="S3.SS1.SSS3.p2.4.m2.1a"><mo id="S3.SS1.SSS3.p2.4.m2.1.1" xref="S3.SS1.SSS3.p2.4.m2.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.4.m2.1b"><csymbol cd="latexml" id="S3.SS1.SSS3.p2.4.m2.1.1.cmml" xref="S3.SS1.SSS3.p2.4.m2.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.4.m2.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.4.m2.1d">⊕</annotation></semantics></math> and <math alttext="\|" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.5.m3.1"><semantics id="S3.SS1.SSS3.p2.5.m3.1a"><mo id="S3.SS1.SSS3.p2.5.m3.1.1" xref="S3.SS1.SSS3.p2.5.m3.1.1.cmml">∥</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.5.m3.1b"><ci id="S3.SS1.SSS3.p2.5.m3.1.1.cmml" xref="S3.SS1.SSS3.p2.5.m3.1.1">∥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.5.m3.1c">\|</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.5.m3.1d">∥</annotation></semantics></math> are the concatenation operator. By independently processing each (<math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.6.m4.1"><semantics id="S3.SS1.SSS3.p2.6.m4.1a"><mi id="S3.SS1.SSS3.p2.6.m4.1.1" xref="S3.SS1.SSS3.p2.6.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.6.m4.1b"><ci id="S3.SS1.SSS3.p2.6.m4.1.1.cmml" xref="S3.SS1.SSS3.p2.6.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.6.m4.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.6.m4.1d">italic_q</annotation></semantics></math>, <math alttext="p^{f}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.7.m5.1"><semantics id="S3.SS1.SSS3.p2.7.m5.1a"><msup id="S3.SS1.SSS3.p2.7.m5.1.1" xref="S3.SS1.SSS3.p2.7.m5.1.1.cmml"><mi id="S3.SS1.SSS3.p2.7.m5.1.1.2" xref="S3.SS1.SSS3.p2.7.m5.1.1.2.cmml">p</mi><mi id="S3.SS1.SSS3.p2.7.m5.1.1.3" xref="S3.SS1.SSS3.p2.7.m5.1.1.3.cmml">f</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.7.m5.1b"><apply id="S3.SS1.SSS3.p2.7.m5.1.1.cmml" xref="S3.SS1.SSS3.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.7.m5.1.1.1.cmml" xref="S3.SS1.SSS3.p2.7.m5.1.1">superscript</csymbol><ci id="S3.SS1.SSS3.p2.7.m5.1.1.2.cmml" xref="S3.SS1.SSS3.p2.7.m5.1.1.2">𝑝</ci><ci id="S3.SS1.SSS3.p2.7.m5.1.1.3.cmml" xref="S3.SS1.SSS3.p2.7.m5.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.7.m5.1c">p^{f}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.7.m5.1d">italic_p start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT</annotation></semantics></math>) pair, the encoder computes self-attention within one passage at a time.
As such, the computational cost scales linearly with the number of passages, making the post-ranking stage highly efficient.
Furthermore, the decoder’s cross-attention scores have shown to be remarkably effective in estimating the relative importance of the retrieval-augmented passage from the language models’ preferences
<cite class="ltx_cite ltx_citemacro_cite">Izacard and Grave (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib17" title="">2021a</a>); Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib61" title="">2023</a>); Izacard et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib19" title="">2023</a>); Shi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib47" title="">2024</a>)</cite>.
Given that, we average FiD cross-attention scores corresponding to each (<math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.8.m6.1"><semantics id="S3.SS1.SSS3.p2.8.m6.1a"><mi id="S3.SS1.SSS3.p2.8.m6.1.1" xref="S3.SS1.SSS3.p2.8.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.8.m6.1b"><ci id="S3.SS1.SSS3.p2.8.m6.1.1.cmml" xref="S3.SS1.SSS3.p2.8.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.8.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.8.m6.1d">italic_q</annotation></semantics></math>, <math alttext="p^{f}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.9.m7.1"><semantics id="S3.SS1.SSS3.p2.9.m7.1a"><msup id="S3.SS1.SSS3.p2.9.m7.1.1" xref="S3.SS1.SSS3.p2.9.m7.1.1.cmml"><mi id="S3.SS1.SSS3.p2.9.m7.1.1.2" xref="S3.SS1.SSS3.p2.9.m7.1.1.2.cmml">p</mi><mi id="S3.SS1.SSS3.p2.9.m7.1.1.3" xref="S3.SS1.SSS3.p2.9.m7.1.1.3.cmml">f</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.9.m7.1b"><apply id="S3.SS1.SSS3.p2.9.m7.1.1.cmml" xref="S3.SS1.SSS3.p2.9.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.9.m7.1.1.1.cmml" xref="S3.SS1.SSS3.p2.9.m7.1.1">superscript</csymbol><ci id="S3.SS1.SSS3.p2.9.m7.1.1.2.cmml" xref="S3.SS1.SSS3.p2.9.m7.1.1.2">𝑝</ci><ci id="S3.SS1.SSS3.p2.9.m7.1.1.3.cmml" xref="S3.SS1.SSS3.p2.9.m7.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.9.m7.1c">p^{f}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.9.m7.1d">italic_p start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT</annotation></semantics></math>) pair from the first decoder token<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>Here, we take the score of the first token, as it leads to satisfactory performance in general.
More analysis about attention aggregation schema can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS1" title="C.1 Study of Attention Aggregation Schema ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">C.1</span></a>.</span></span></span> over all the layers, all the heads, as well as all the representative tokens within <math alttext="q\oplus p^{f}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.10.m8.1"><semantics id="S3.SS1.SSS3.p2.10.m8.1a"><mrow id="S3.SS1.SSS3.p2.10.m8.1.1" xref="S3.SS1.SSS3.p2.10.m8.1.1.cmml"><mi id="S3.SS1.SSS3.p2.10.m8.1.1.2" xref="S3.SS1.SSS3.p2.10.m8.1.1.2.cmml">q</mi><mo id="S3.SS1.SSS3.p2.10.m8.1.1.1" xref="S3.SS1.SSS3.p2.10.m8.1.1.1.cmml">⊕</mo><msup id="S3.SS1.SSS3.p2.10.m8.1.1.3" xref="S3.SS1.SSS3.p2.10.m8.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.10.m8.1.1.3.2" xref="S3.SS1.SSS3.p2.10.m8.1.1.3.2.cmml">p</mi><mi id="S3.SS1.SSS3.p2.10.m8.1.1.3.3" xref="S3.SS1.SSS3.p2.10.m8.1.1.3.3.cmml">f</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.10.m8.1b"><apply id="S3.SS1.SSS3.p2.10.m8.1.1.cmml" xref="S3.SS1.SSS3.p2.10.m8.1.1"><csymbol cd="latexml" id="S3.SS1.SSS3.p2.10.m8.1.1.1.cmml" xref="S3.SS1.SSS3.p2.10.m8.1.1.1">direct-sum</csymbol><ci id="S3.SS1.SSS3.p2.10.m8.1.1.2.cmml" xref="S3.SS1.SSS3.p2.10.m8.1.1.2">𝑞</ci><apply id="S3.SS1.SSS3.p2.10.m8.1.1.3.cmml" xref="S3.SS1.SSS3.p2.10.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.10.m8.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.10.m8.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p2.10.m8.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.10.m8.1.1.3.2">𝑝</ci><ci id="S3.SS1.SSS3.p2.10.m8.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.10.m8.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.10.m8.1c">q\oplus p^{f}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.10.m8.1d">italic_q ⊕ italic_p start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S^{{post}}=\frac{1}{{ln}\times{lh}\times{lr}}\sum_{i=0}^{{ln}}\sum_{j=0}^{{lh}%
}\sum_{k=0}^{{lr}}\alpha_{0,i,j,\mathbf{r}[k]}," class="ltx_Math" display="block" id="S3.E3.m1.6"><semantics id="S3.E3.m1.6a"><mrow id="S3.E3.m1.6.6.1" xref="S3.E3.m1.6.6.1.1.cmml"><mrow id="S3.E3.m1.6.6.1.1" xref="S3.E3.m1.6.6.1.1.cmml"><msup id="S3.E3.m1.6.6.1.1.2" xref="S3.E3.m1.6.6.1.1.2.cmml"><mi id="S3.E3.m1.6.6.1.1.2.2" xref="S3.E3.m1.6.6.1.1.2.2.cmml">S</mi><mrow id="S3.E3.m1.6.6.1.1.2.3" xref="S3.E3.m1.6.6.1.1.2.3.cmml"><mi id="S3.E3.m1.6.6.1.1.2.3.2" xref="S3.E3.m1.6.6.1.1.2.3.2.cmml">p</mi><mo id="S3.E3.m1.6.6.1.1.2.3.1" xref="S3.E3.m1.6.6.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.2.3.3" xref="S3.E3.m1.6.6.1.1.2.3.3.cmml">o</mi><mo id="S3.E3.m1.6.6.1.1.2.3.1a" xref="S3.E3.m1.6.6.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.2.3.4" xref="S3.E3.m1.6.6.1.1.2.3.4.cmml">s</mi><mo id="S3.E3.m1.6.6.1.1.2.3.1b" xref="S3.E3.m1.6.6.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.2.3.5" xref="S3.E3.m1.6.6.1.1.2.3.5.cmml">t</mi></mrow></msup><mo id="S3.E3.m1.6.6.1.1.1" xref="S3.E3.m1.6.6.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.6.6.1.1.3" xref="S3.E3.m1.6.6.1.1.3.cmml"><mfrac id="S3.E3.m1.6.6.1.1.3.2" xref="S3.E3.m1.6.6.1.1.3.2.cmml"><mn id="S3.E3.m1.6.6.1.1.3.2.2" xref="S3.E3.m1.6.6.1.1.3.2.2.cmml">1</mn><mrow id="S3.E3.m1.6.6.1.1.3.2.3" xref="S3.E3.m1.6.6.1.1.3.2.3.cmml"><mrow id="S3.E3.m1.6.6.1.1.3.2.3.2" xref="S3.E3.m1.6.6.1.1.3.2.3.2.cmml"><mrow id="S3.E3.m1.6.6.1.1.3.2.3.2.2" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.cmml"><mrow id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.cmml"><mrow id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.cmml"><mi id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.2" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.2.cmml">l</mi><mo id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.1" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.3" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.3.cmml">n</mi></mrow><mo id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.1.cmml">×</mo><mi id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.3" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.3.cmml">l</mi></mrow><mo id="S3.E3.m1.6.6.1.1.3.2.3.2.2.1" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.3.2.3.2.2.3" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.3.cmml">h</mi></mrow><mo id="S3.E3.m1.6.6.1.1.3.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.6.6.1.1.3.2.3.2.1.cmml">×</mo><mi id="S3.E3.m1.6.6.1.1.3.2.3.2.3" xref="S3.E3.m1.6.6.1.1.3.2.3.2.3.cmml">l</mi></mrow><mo id="S3.E3.m1.6.6.1.1.3.2.3.1" xref="S3.E3.m1.6.6.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.3.2.3.3" xref="S3.E3.m1.6.6.1.1.3.2.3.3.cmml">r</mi></mrow></mfrac><mo id="S3.E3.m1.6.6.1.1.3.1" xref="S3.E3.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.6.6.1.1.3.3" xref="S3.E3.m1.6.6.1.1.3.3.cmml"><munderover id="S3.E3.m1.6.6.1.1.3.3.1" xref="S3.E3.m1.6.6.1.1.3.3.1.cmml"><mo id="S3.E3.m1.6.6.1.1.3.3.1.2.2" movablelimits="false" rspace="0em" xref="S3.E3.m1.6.6.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.6.6.1.1.3.3.1.2.3" xref="S3.E3.m1.6.6.1.1.3.3.1.2.3.cmml"><mi id="S3.E3.m1.6.6.1.1.3.3.1.2.3.2" xref="S3.E3.m1.6.6.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.6.6.1.1.3.3.1.2.3.1" xref="S3.E3.m1.6.6.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.6.6.1.1.3.3.1.2.3.3" xref="S3.E3.m1.6.6.1.1.3.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S3.E3.m1.6.6.1.1.3.3.1.3" xref="S3.E3.m1.6.6.1.1.3.3.1.3.cmml"><mi id="S3.E3.m1.6.6.1.1.3.3.1.3.2" xref="S3.E3.m1.6.6.1.1.3.3.1.3.2.cmml">l</mi><mo id="S3.E3.m1.6.6.1.1.3.3.1.3.1" xref="S3.E3.m1.6.6.1.1.3.3.1.3.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.3.3.1.3.3" xref="S3.E3.m1.6.6.1.1.3.3.1.3.3.cmml">n</mi></mrow></munderover><mrow id="S3.E3.m1.6.6.1.1.3.3.2" xref="S3.E3.m1.6.6.1.1.3.3.2.cmml"><munderover id="S3.E3.m1.6.6.1.1.3.3.2.1" xref="S3.E3.m1.6.6.1.1.3.3.2.1.cmml"><mo id="S3.E3.m1.6.6.1.1.3.3.2.1.2.2" movablelimits="false" rspace="0em" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.6.6.1.1.3.3.2.1.2.3" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.cmml"><mi id="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.2" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.2.cmml">j</mi><mo id="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.1" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.3" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.3.cmml">0</mn></mrow><mrow id="S3.E3.m1.6.6.1.1.3.3.2.1.3" xref="S3.E3.m1.6.6.1.1.3.3.2.1.3.cmml"><mi id="S3.E3.m1.6.6.1.1.3.3.2.1.3.2" xref="S3.E3.m1.6.6.1.1.3.3.2.1.3.2.cmml">l</mi><mo id="S3.E3.m1.6.6.1.1.3.3.2.1.3.1" xref="S3.E3.m1.6.6.1.1.3.3.2.1.3.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.3.3.2.1.3.3" xref="S3.E3.m1.6.6.1.1.3.3.2.1.3.3.cmml">h</mi></mrow></munderover><mrow id="S3.E3.m1.6.6.1.1.3.3.2.2" xref="S3.E3.m1.6.6.1.1.3.3.2.2.cmml"><munderover id="S3.E3.m1.6.6.1.1.3.3.2.2.1" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.cmml"><mo id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.2" movablelimits="false" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.cmml"><mi id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.2" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.2.cmml">k</mi><mo id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.1" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.3" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.3.cmml">0</mn></mrow><mrow id="S3.E3.m1.6.6.1.1.3.3.2.2.1.3" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.cmml"><mi id="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.2" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.2.cmml">l</mi><mo id="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.1" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.3" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.3.cmml">r</mi></mrow></munderover><msub id="S3.E3.m1.6.6.1.1.3.3.2.2.2" xref="S3.E3.m1.6.6.1.1.3.3.2.2.2.cmml"><mi id="S3.E3.m1.6.6.1.1.3.3.2.2.2.2" xref="S3.E3.m1.6.6.1.1.3.3.2.2.2.2.cmml">α</mi><mrow id="S3.E3.m1.5.5.5.5" xref="S3.E3.m1.5.5.5.6.cmml"><mn id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">0</mn><mo id="S3.E3.m1.5.5.5.5.2" xref="S3.E3.m1.5.5.5.6.cmml">,</mo><mi id="S3.E3.m1.3.3.3.3" xref="S3.E3.m1.3.3.3.3.cmml">i</mi><mo id="S3.E3.m1.5.5.5.5.3" xref="S3.E3.m1.5.5.5.6.cmml">,</mo><mi id="S3.E3.m1.4.4.4.4" xref="S3.E3.m1.4.4.4.4.cmml">j</mi><mo id="S3.E3.m1.5.5.5.5.4" xref="S3.E3.m1.5.5.5.6.cmml">,</mo><mrow id="S3.E3.m1.5.5.5.5.1" xref="S3.E3.m1.5.5.5.5.1.cmml"><mi id="S3.E3.m1.5.5.5.5.1.2" xref="S3.E3.m1.5.5.5.5.1.2.cmml">𝐫</mi><mo id="S3.E3.m1.5.5.5.5.1.1" xref="S3.E3.m1.5.5.5.5.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.5.5.1.3.2" xref="S3.E3.m1.5.5.5.5.1.3.1.cmml"><mo id="S3.E3.m1.5.5.5.5.1.3.2.1" stretchy="false" xref="S3.E3.m1.5.5.5.5.1.3.1.1.cmml">[</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">k</mi><mo id="S3.E3.m1.5.5.5.5.1.3.2.2" stretchy="false" xref="S3.E3.m1.5.5.5.5.1.3.1.1.cmml">]</mo></mrow></mrow></mrow></msub></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.6.6.1.2" xref="S3.E3.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.6b"><apply id="S3.E3.m1.6.6.1.1.cmml" xref="S3.E3.m1.6.6.1"><eq id="S3.E3.m1.6.6.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1"></eq><apply id="S3.E3.m1.6.6.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.2.1.cmml" xref="S3.E3.m1.6.6.1.1.2">superscript</csymbol><ci id="S3.E3.m1.6.6.1.1.2.2.cmml" xref="S3.E3.m1.6.6.1.1.2.2">𝑆</ci><apply id="S3.E3.m1.6.6.1.1.2.3.cmml" xref="S3.E3.m1.6.6.1.1.2.3"><times id="S3.E3.m1.6.6.1.1.2.3.1.cmml" xref="S3.E3.m1.6.6.1.1.2.3.1"></times><ci id="S3.E3.m1.6.6.1.1.2.3.2.cmml" xref="S3.E3.m1.6.6.1.1.2.3.2">𝑝</ci><ci id="S3.E3.m1.6.6.1.1.2.3.3.cmml" xref="S3.E3.m1.6.6.1.1.2.3.3">𝑜</ci><ci id="S3.E3.m1.6.6.1.1.2.3.4.cmml" xref="S3.E3.m1.6.6.1.1.2.3.4">𝑠</ci><ci id="S3.E3.m1.6.6.1.1.2.3.5.cmml" xref="S3.E3.m1.6.6.1.1.2.3.5">𝑡</ci></apply></apply><apply id="S3.E3.m1.6.6.1.1.3.cmml" xref="S3.E3.m1.6.6.1.1.3"><times id="S3.E3.m1.6.6.1.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.1"></times><apply id="S3.E3.m1.6.6.1.1.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.2"><divide id="S3.E3.m1.6.6.1.1.3.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2"></divide><cn id="S3.E3.m1.6.6.1.1.3.2.2.cmml" type="integer" xref="S3.E3.m1.6.6.1.1.3.2.2">1</cn><apply id="S3.E3.m1.6.6.1.1.3.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3"><times id="S3.E3.m1.6.6.1.1.3.2.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.1"></times><apply id="S3.E3.m1.6.6.1.1.3.2.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2"><times id="S3.E3.m1.6.6.1.1.3.2.3.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.1"></times><apply id="S3.E3.m1.6.6.1.1.3.2.3.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2"><times id="S3.E3.m1.6.6.1.1.3.2.3.2.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.1"></times><apply id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2"><times id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.1"></times><apply id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2"><times id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.1"></times><ci id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.2">𝑙</ci><ci id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.2.3">𝑛</ci></apply><ci id="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.2.3">𝑙</ci></apply><ci id="S3.E3.m1.6.6.1.1.3.2.3.2.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.2.3">ℎ</ci></apply><ci id="S3.E3.m1.6.6.1.1.3.2.3.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.2.3">𝑙</ci></apply><ci id="S3.E3.m1.6.6.1.1.3.2.3.3.cmml" xref="S3.E3.m1.6.6.1.1.3.2.3.3">𝑟</ci></apply></apply><apply id="S3.E3.m1.6.6.1.1.3.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3"><apply id="S3.E3.m1.6.6.1.1.3.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.3.3.1.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1">superscript</csymbol><apply id="S3.E3.m1.6.6.1.1.3.3.1.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.3.3.1.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1">subscript</csymbol><sum id="S3.E3.m1.6.6.1.1.3.3.1.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1.2.2"></sum><apply id="S3.E3.m1.6.6.1.1.3.3.1.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1.2.3"><eq id="S3.E3.m1.6.6.1.1.3.3.1.2.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.6.6.1.1.3.3.1.2.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S3.E3.m1.6.6.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.6.6.1.1.3.3.1.2.3.3">0</cn></apply></apply><apply id="S3.E3.m1.6.6.1.1.3.3.1.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1.3"><times id="S3.E3.m1.6.6.1.1.3.3.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1.3.1"></times><ci id="S3.E3.m1.6.6.1.1.3.3.1.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1.3.2">𝑙</ci><ci id="S3.E3.m1.6.6.1.1.3.3.1.3.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.1.3.3">𝑛</ci></apply></apply><apply id="S3.E3.m1.6.6.1.1.3.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2"><apply id="S3.E3.m1.6.6.1.1.3.3.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.3.3.2.1.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1">superscript</csymbol><apply id="S3.E3.m1.6.6.1.1.3.3.2.1.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.3.3.2.1.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1">subscript</csymbol><sum id="S3.E3.m1.6.6.1.1.3.3.2.1.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.2"></sum><apply id="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.3"><eq id="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.1"></eq><ci id="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.2">𝑗</ci><cn id="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.6.6.1.1.3.3.2.1.2.3.3">0</cn></apply></apply><apply id="S3.E3.m1.6.6.1.1.3.3.2.1.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1.3"><times id="S3.E3.m1.6.6.1.1.3.3.2.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1.3.1"></times><ci id="S3.E3.m1.6.6.1.1.3.3.2.1.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1.3.2">𝑙</ci><ci id="S3.E3.m1.6.6.1.1.3.3.2.1.3.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.1.3.3">ℎ</ci></apply></apply><apply id="S3.E3.m1.6.6.1.1.3.3.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2"><apply id="S3.E3.m1.6.6.1.1.3.3.2.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.3.3.2.2.1.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1">superscript</csymbol><apply id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1">subscript</csymbol><sum id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.2"></sum><apply id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3"><eq id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.1"></eq><ci id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.2">𝑘</ci><cn id="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.2.3.3">0</cn></apply></apply><apply id="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.3"><times id="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.1"></times><ci id="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.2">𝑙</ci><ci id="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.3.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.1.3.3">𝑟</ci></apply></apply><apply id="S3.E3.m1.6.6.1.1.3.3.2.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.3.3.2.2.2.1.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.2">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.3.3.2.2.2.2.cmml" xref="S3.E3.m1.6.6.1.1.3.3.2.2.2.2">𝛼</ci><list id="S3.E3.m1.5.5.5.6.cmml" xref="S3.E3.m1.5.5.5.5"><cn id="S3.E3.m1.2.2.2.2.cmml" type="integer" xref="S3.E3.m1.2.2.2.2">0</cn><ci id="S3.E3.m1.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3">𝑖</ci><ci id="S3.E3.m1.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4">𝑗</ci><apply id="S3.E3.m1.5.5.5.5.1.cmml" xref="S3.E3.m1.5.5.5.5.1"><times id="S3.E3.m1.5.5.5.5.1.1.cmml" xref="S3.E3.m1.5.5.5.5.1.1"></times><ci id="S3.E3.m1.5.5.5.5.1.2.cmml" xref="S3.E3.m1.5.5.5.5.1.2">𝐫</ci><apply id="S3.E3.m1.5.5.5.5.1.3.1.cmml" xref="S3.E3.m1.5.5.5.5.1.3.2"><csymbol cd="latexml" id="S3.E3.m1.5.5.5.5.1.3.1.1.cmml" xref="S3.E3.m1.5.5.5.5.1.3.2.1">delimited-[]</csymbol><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑘</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.6c">S^{{post}}=\frac{1}{{ln}\times{lh}\times{lr}}\sum_{i=0}^{{ln}}\sum_{j=0}^{{lh}%
}\sum_{k=0}^{{lr}}\alpha_{0,i,j,\mathbf{r}[k]},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.6d">italic_S start_POSTSUPERSCRIPT italic_p italic_o italic_s italic_t end_POSTSUPERSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_l italic_n × italic_l italic_h × italic_l italic_r end_ARG ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l italic_h end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l italic_r end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT 0 , italic_i , italic_j , bold_r [ italic_k ] end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS3.p2.23">where <math alttext="{ln}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.11.m1.1"><semantics id="S3.SS1.SSS3.p2.11.m1.1a"><mrow id="S3.SS1.SSS3.p2.11.m1.1.1" xref="S3.SS1.SSS3.p2.11.m1.1.1.cmml"><mi id="S3.SS1.SSS3.p2.11.m1.1.1.2" xref="S3.SS1.SSS3.p2.11.m1.1.1.2.cmml">l</mi><mo id="S3.SS1.SSS3.p2.11.m1.1.1.1" xref="S3.SS1.SSS3.p2.11.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS3.p2.11.m1.1.1.3" xref="S3.SS1.SSS3.p2.11.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.11.m1.1b"><apply id="S3.SS1.SSS3.p2.11.m1.1.1.cmml" xref="S3.SS1.SSS3.p2.11.m1.1.1"><times id="S3.SS1.SSS3.p2.11.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.11.m1.1.1.1"></times><ci id="S3.SS1.SSS3.p2.11.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.11.m1.1.1.2">𝑙</ci><ci id="S3.SS1.SSS3.p2.11.m1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.11.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.11.m1.1c">{ln}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.11.m1.1d">italic_l italic_n</annotation></semantics></math>, <math alttext="{lh}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.12.m2.1"><semantics id="S3.SS1.SSS3.p2.12.m2.1a"><mrow id="S3.SS1.SSS3.p2.12.m2.1.1" xref="S3.SS1.SSS3.p2.12.m2.1.1.cmml"><mi id="S3.SS1.SSS3.p2.12.m2.1.1.2" xref="S3.SS1.SSS3.p2.12.m2.1.1.2.cmml">l</mi><mo id="S3.SS1.SSS3.p2.12.m2.1.1.1" xref="S3.SS1.SSS3.p2.12.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS3.p2.12.m2.1.1.3" xref="S3.SS1.SSS3.p2.12.m2.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.12.m2.1b"><apply id="S3.SS1.SSS3.p2.12.m2.1.1.cmml" xref="S3.SS1.SSS3.p2.12.m2.1.1"><times id="S3.SS1.SSS3.p2.12.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p2.12.m2.1.1.1"></times><ci id="S3.SS1.SSS3.p2.12.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p2.12.m2.1.1.2">𝑙</ci><ci id="S3.SS1.SSS3.p2.12.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p2.12.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.12.m2.1c">{lh}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.12.m2.1d">italic_l italic_h</annotation></semantics></math>, and <math alttext="{lr}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.13.m3.1"><semantics id="S3.SS1.SSS3.p2.13.m3.1a"><mrow id="S3.SS1.SSS3.p2.13.m3.1.1" xref="S3.SS1.SSS3.p2.13.m3.1.1.cmml"><mi id="S3.SS1.SSS3.p2.13.m3.1.1.2" xref="S3.SS1.SSS3.p2.13.m3.1.1.2.cmml">l</mi><mo id="S3.SS1.SSS3.p2.13.m3.1.1.1" xref="S3.SS1.SSS3.p2.13.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS3.p2.13.m3.1.1.3" xref="S3.SS1.SSS3.p2.13.m3.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.13.m3.1b"><apply id="S3.SS1.SSS3.p2.13.m3.1.1.cmml" xref="S3.SS1.SSS3.p2.13.m3.1.1"><times id="S3.SS1.SSS3.p2.13.m3.1.1.1.cmml" xref="S3.SS1.SSS3.p2.13.m3.1.1.1"></times><ci id="S3.SS1.SSS3.p2.13.m3.1.1.2.cmml" xref="S3.SS1.SSS3.p2.13.m3.1.1.2">𝑙</ci><ci id="S3.SS1.SSS3.p2.13.m3.1.1.3.cmml" xref="S3.SS1.SSS3.p2.13.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.13.m3.1c">{lr}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.13.m3.1d">italic_l italic_r</annotation></semantics></math> denote the number of the layers, heads, and representative tokens, respectively; <math alttext="\alpha_{0,i,j,\mathbf{r}[k]}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.14.m4.5"><semantics id="S3.SS1.SSS3.p2.14.m4.5a"><msub id="S3.SS1.SSS3.p2.14.m4.5.6" xref="S3.SS1.SSS3.p2.14.m4.5.6.cmml"><mi id="S3.SS1.SSS3.p2.14.m4.5.6.2" xref="S3.SS1.SSS3.p2.14.m4.5.6.2.cmml">α</mi><mrow id="S3.SS1.SSS3.p2.14.m4.5.5.5.5" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.6.cmml"><mn id="S3.SS1.SSS3.p2.14.m4.2.2.2.2" xref="S3.SS1.SSS3.p2.14.m4.2.2.2.2.cmml">0</mn><mo id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.2" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.6.cmml">,</mo><mi id="S3.SS1.SSS3.p2.14.m4.3.3.3.3" xref="S3.SS1.SSS3.p2.14.m4.3.3.3.3.cmml">i</mi><mo id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.3" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.6.cmml">,</mo><mi id="S3.SS1.SSS3.p2.14.m4.4.4.4.4" xref="S3.SS1.SSS3.p2.14.m4.4.4.4.4.cmml">j</mi><mo id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.4" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.6.cmml">,</mo><mrow id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.cmml"><mi id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.2" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.2.cmml">𝐫</mi><mo id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.1" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.1.cmml">⁢</mo><mrow id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.2" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.1.cmml"><mo id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.2.1" stretchy="false" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.1.1.cmml">[</mo><mi id="S3.SS1.SSS3.p2.14.m4.1.1.1.1" xref="S3.SS1.SSS3.p2.14.m4.1.1.1.1.cmml">k</mi><mo id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.2.2" stretchy="false" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.1.1.cmml">]</mo></mrow></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.14.m4.5b"><apply id="S3.SS1.SSS3.p2.14.m4.5.6.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.6"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.14.m4.5.6.1.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.6">subscript</csymbol><ci id="S3.SS1.SSS3.p2.14.m4.5.6.2.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.6.2">𝛼</ci><list id="S3.SS1.SSS3.p2.14.m4.5.5.5.6.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5"><cn id="S3.SS1.SSS3.p2.14.m4.2.2.2.2.cmml" type="integer" xref="S3.SS1.SSS3.p2.14.m4.2.2.2.2">0</cn><ci id="S3.SS1.SSS3.p2.14.m4.3.3.3.3.cmml" xref="S3.SS1.SSS3.p2.14.m4.3.3.3.3">𝑖</ci><ci id="S3.SS1.SSS3.p2.14.m4.4.4.4.4.cmml" xref="S3.SS1.SSS3.p2.14.m4.4.4.4.4">𝑗</ci><apply id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1"><times id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.1.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.1"></times><ci id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.2.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.2">𝐫</ci><apply id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.1.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.2"><csymbol cd="latexml" id="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.1.1.cmml" xref="S3.SS1.SSS3.p2.14.m4.5.5.5.5.1.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.SSS3.p2.14.m4.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.14.m4.1.1.1.1">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.14.m4.5c">\alpha_{0,i,j,\mathbf{r}[k]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.14.m4.5d">italic_α start_POSTSUBSCRIPT 0 , italic_i , italic_j , bold_r [ italic_k ] end_POSTSUBSCRIPT</annotation></semantics></math> represents the score of the first decoder token in terms of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.15.m5.1"><semantics id="S3.SS1.SSS3.p2.15.m5.1a"><mi id="S3.SS1.SSS3.p2.15.m5.1.1" xref="S3.SS1.SSS3.p2.15.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.15.m5.1b"><ci id="S3.SS1.SSS3.p2.15.m5.1.1.cmml" xref="S3.SS1.SSS3.p2.15.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.15.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.15.m5.1d">italic_i</annotation></semantics></math>-th layer, <math alttext="j" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.16.m6.1"><semantics id="S3.SS1.SSS3.p2.16.m6.1a"><mi id="S3.SS1.SSS3.p2.16.m6.1.1" xref="S3.SS1.SSS3.p2.16.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.16.m6.1b"><ci id="S3.SS1.SSS3.p2.16.m6.1.1.cmml" xref="S3.SS1.SSS3.p2.16.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.16.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.16.m6.1d">italic_j</annotation></semantics></math>-th head, and <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.17.m7.1"><semantics id="S3.SS1.SSS3.p2.17.m7.1a"><mi id="S3.SS1.SSS3.p2.17.m7.1.1" xref="S3.SS1.SSS3.p2.17.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.17.m7.1b"><ci id="S3.SS1.SSS3.p2.17.m7.1.1.cmml" xref="S3.SS1.SSS3.p2.17.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.17.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.17.m7.1d">italic_k</annotation></semantics></math>-th representative token;
<math alttext="\mathbf{r}[k]" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.18.m8.1"><semantics id="S3.SS1.SSS3.p2.18.m8.1a"><mrow id="S3.SS1.SSS3.p2.18.m8.1.2" xref="S3.SS1.SSS3.p2.18.m8.1.2.cmml"><mi id="S3.SS1.SSS3.p2.18.m8.1.2.2" xref="S3.SS1.SSS3.p2.18.m8.1.2.2.cmml">𝐫</mi><mo id="S3.SS1.SSS3.p2.18.m8.1.2.1" xref="S3.SS1.SSS3.p2.18.m8.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS3.p2.18.m8.1.2.3.2" xref="S3.SS1.SSS3.p2.18.m8.1.2.3.1.cmml"><mo id="S3.SS1.SSS3.p2.18.m8.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS3.p2.18.m8.1.2.3.1.1.cmml">[</mo><mi id="S3.SS1.SSS3.p2.18.m8.1.1" xref="S3.SS1.SSS3.p2.18.m8.1.1.cmml">k</mi><mo id="S3.SS1.SSS3.p2.18.m8.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS3.p2.18.m8.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.18.m8.1b"><apply id="S3.SS1.SSS3.p2.18.m8.1.2.cmml" xref="S3.SS1.SSS3.p2.18.m8.1.2"><times id="S3.SS1.SSS3.p2.18.m8.1.2.1.cmml" xref="S3.SS1.SSS3.p2.18.m8.1.2.1"></times><ci id="S3.SS1.SSS3.p2.18.m8.1.2.2.cmml" xref="S3.SS1.SSS3.p2.18.m8.1.2.2">𝐫</ci><apply id="S3.SS1.SSS3.p2.18.m8.1.2.3.1.cmml" xref="S3.SS1.SSS3.p2.18.m8.1.2.3.2"><csymbol cd="latexml" id="S3.SS1.SSS3.p2.18.m8.1.2.3.1.1.cmml" xref="S3.SS1.SSS3.p2.18.m8.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.SSS3.p2.18.m8.1.1.cmml" xref="S3.SS1.SSS3.p2.18.m8.1.1">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.18.m8.1c">\mathbf{r}[k]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.18.m8.1d">bold_r [ italic_k ]</annotation></semantics></math> lookups the index of <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.19.m9.1"><semantics id="S3.SS1.SSS3.p2.19.m9.1a"><mi id="S3.SS1.SSS3.p2.19.m9.1.1" xref="S3.SS1.SSS3.p2.19.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.19.m9.1b"><ci id="S3.SS1.SSS3.p2.19.m9.1.1.cmml" xref="S3.SS1.SSS3.p2.19.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.19.m9.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.19.m9.1d">italic_k</annotation></semantics></math>-th representative token. We select <math alttext="{lr}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.20.m10.1"><semantics id="S3.SS1.SSS3.p2.20.m10.1a"><mrow id="S3.SS1.SSS3.p2.20.m10.1.1" xref="S3.SS1.SSS3.p2.20.m10.1.1.cmml"><mi id="S3.SS1.SSS3.p2.20.m10.1.1.2" xref="S3.SS1.SSS3.p2.20.m10.1.1.2.cmml">l</mi><mo id="S3.SS1.SSS3.p2.20.m10.1.1.1" xref="S3.SS1.SSS3.p2.20.m10.1.1.1.cmml">⁢</mo><mi id="S3.SS1.SSS3.p2.20.m10.1.1.3" xref="S3.SS1.SSS3.p2.20.m10.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.20.m10.1b"><apply id="S3.SS1.SSS3.p2.20.m10.1.1.cmml" xref="S3.SS1.SSS3.p2.20.m10.1.1"><times id="S3.SS1.SSS3.p2.20.m10.1.1.1.cmml" xref="S3.SS1.SSS3.p2.20.m10.1.1.1"></times><ci id="S3.SS1.SSS3.p2.20.m10.1.1.2.cmml" xref="S3.SS1.SSS3.p2.20.m10.1.1.2">𝑙</ci><ci id="S3.SS1.SSS3.p2.20.m10.1.1.3.cmml" xref="S3.SS1.SSS3.p2.20.m10.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.20.m10.1c">{lr}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.20.m10.1d">italic_l italic_r</annotation></semantics></math> tokens with the highest scores to serve as representative ones<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>Note that we do not consider query tokens in <math alttext="q" class="ltx_Math" display="inline" id="footnote8.m1.1"><semantics id="footnote8.m1.1b"><mi id="footnote8.m1.1.1" xref="footnote8.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="footnote8.m1.1c"><ci id="footnote8.m1.1.1.cmml" xref="footnote8.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m1.1d">q</annotation><annotation encoding="application/x-llamapun" id="footnote8.m1.1e">italic_q</annotation></semantics></math> when selecting representative tokens, refer to the ablation study
in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS2" title="C.2 Ablation of Query Tokens ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">C.2</span></a> for more details. More technical details about representative token selection can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A1.SS2" title="A.2 Representative Token Selection ‣ Appendix A More Details Related to Methods ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</span></span></span>.
The cross-attention mechanism is provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A1.SS1" title="A.1 Cross-Attention ‣ Appendix A More Details Related to Methods ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">A.1</span></a>. Before estimating the relative importance score, we train FiD to predict the answer with retrieval-augmented passages, so that FiD can learn to look for cues. After that, we obtain the post-ranking score and treat these passages with scores ranked in the top-<math alttext="H" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.21.m11.1"><semantics id="S3.SS1.SSS3.p2.21.m11.1a"><mi id="S3.SS1.SSS3.p2.21.m11.1.1" xref="S3.SS1.SSS3.p2.21.m11.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.21.m11.1b"><ci id="S3.SS1.SSS3.p2.21.m11.1.1.cmml" xref="S3.SS1.SSS3.p2.21.m11.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.21.m11.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.21.m11.1d">italic_H</annotation></semantics></math> as oracle passages <math alttext="\mathcal{P}_{f}=\{p_{1}^{f},p_{2}^{f},...,p_{H}^{f}\}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.22.m12.4"><semantics id="S3.SS1.SSS3.p2.22.m12.4a"><mrow id="S3.SS1.SSS3.p2.22.m12.4.4" xref="S3.SS1.SSS3.p2.22.m12.4.4.cmml"><msub id="S3.SS1.SSS3.p2.22.m12.4.4.5" xref="S3.SS1.SSS3.p2.22.m12.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p2.22.m12.4.4.5.2" xref="S3.SS1.SSS3.p2.22.m12.4.4.5.2.cmml">𝒫</mi><mi id="S3.SS1.SSS3.p2.22.m12.4.4.5.3" xref="S3.SS1.SSS3.p2.22.m12.4.4.5.3.cmml">f</mi></msub><mo id="S3.SS1.SSS3.p2.22.m12.4.4.4" xref="S3.SS1.SSS3.p2.22.m12.4.4.4.cmml">=</mo><mrow id="S3.SS1.SSS3.p2.22.m12.4.4.3.3" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.4.cmml"><mo id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.4" stretchy="false" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.4.cmml">{</mo><msubsup id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.2" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.2.cmml">p</mi><mn id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.3" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.3" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.3.cmml">f</mi></msubsup><mo id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.5" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.cmml"><mi id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.2" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.2.cmml">p</mi><mn id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.3" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.3" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.3.cmml">f</mi></msubsup><mo id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.6" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.4.cmml">,</mo><mi id="S3.SS1.SSS3.p2.22.m12.1.1" mathvariant="normal" xref="S3.SS1.SSS3.p2.22.m12.1.1.cmml">…</mi><mo id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.7" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.cmml"><mi id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.2" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.2.cmml">p</mi><mi id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.3" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.3.cmml">H</mi><mi id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.3" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.3.cmml">f</mi></msubsup><mo id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.8" stretchy="false" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.22.m12.4b"><apply id="S3.SS1.SSS3.p2.22.m12.4.4.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4"><eq id="S3.SS1.SSS3.p2.22.m12.4.4.4.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.4"></eq><apply id="S3.SS1.SSS3.p2.22.m12.4.4.5.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.22.m12.4.4.5.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.5">subscript</csymbol><ci id="S3.SS1.SSS3.p2.22.m12.4.4.5.2.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.5.2">𝒫</ci><ci id="S3.SS1.SSS3.p2.22.m12.4.4.5.3.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.5.3">𝑓</ci></apply><set id="S3.SS1.SSS3.p2.22.m12.4.4.3.4.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3"><apply id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.2">𝑝</ci><cn id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.22.m12.2.2.1.1.1.3">𝑓</ci></apply><apply id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.cmml" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2">superscript</csymbol><apply id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.2">𝑝</ci><cn id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.22.m12.3.3.2.2.2.3">𝑓</ci></apply><ci id="S3.SS1.SSS3.p2.22.m12.1.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.1.1">…</ci><apply id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3">superscript</csymbol><apply id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.1.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.2.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.2">𝑝</ci><ci id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.3.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.2.3">𝐻</ci></apply><ci id="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.3.cmml" xref="S3.SS1.SSS3.p2.22.m12.4.4.3.3.3.3">𝑓</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.22.m12.4c">\mathcal{P}_{f}=\{p_{1}^{f},p_{2}^{f},...,p_{H}^{f}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.22.m12.4d">caligraphic_P start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT = { italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_H end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT }</annotation></semantics></math>. The oracle passages <math alttext="\mathcal{P}_{f}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p2.23.m13.1"><semantics id="S3.SS1.SSS3.p2.23.m13.1a"><msub id="S3.SS1.SSS3.p2.23.m13.1.1" xref="S3.SS1.SSS3.p2.23.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p2.23.m13.1.1.2" xref="S3.SS1.SSS3.p2.23.m13.1.1.2.cmml">𝒫</mi><mi id="S3.SS1.SSS3.p2.23.m13.1.1.3" xref="S3.SS1.SSS3.p2.23.m13.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.23.m13.1b"><apply id="S3.SS1.SSS3.p2.23.m13.1.1.cmml" xref="S3.SS1.SSS3.p2.23.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.23.m13.1.1.1.cmml" xref="S3.SS1.SSS3.p2.23.m13.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.23.m13.1.1.2.cmml" xref="S3.SS1.SSS3.p2.23.m13.1.1.2">𝒫</ci><ci id="S3.SS1.SSS3.p2.23.m13.1.1.3.cmml" xref="S3.SS1.SSS3.p2.23.m13.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.23.m13.1c">\mathcal{P}_{f}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p2.23.m13.1d">caligraphic_P start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> will be fed into generators to  facilitate  generation.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Distillation with Aggregated Signals</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.12">Ideally, we would like the retrieval units containing oracle passages to be ranked at the forefront by the preceding retriever, so that the succeeding one can reach out to oracle passages.
To this end, we propose to distill retrieval knowledge from the succeeding to the preceding, termed local-to-global (L2G) distillation<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>In this work, we only distill retrieval knowledge from the post-ranking to pre-ranking stage, as we use sparse retrieval (BM25 <cite class="ltx_cite ltx_citemacro_cite">Robertson and Zaragoza (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib41" title="">2009</a>)</cite>) in the retrieval stage.</span></span></span>. While distilling, an issue emerges: the granularity of retrieval units between sequentially neighboring stages is different, hindering distillation.
Given that, we propose aggregating retrieval scores from local to global. By doing so, we can fill the granularity gap between two neighboring stages. Formally, we aggregate retrieval scores as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}S^{post\rightarrow pre}_{d}=\alpha\times\max_{p\in d}\left\{S^{{%
post}}_{p}\right\}+&amp;\\
(1-\alpha)\times\mathop{\text{mean}}\limits_{p\in d}\left\{S^{{post}}_{p}%
\right\},&amp;\end{split}" class="ltx_Math" display="block" id="S3.E4.m1.32"><semantics id="S3.E4.m1.32a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E4.m1.32.32.4" rowspacing="0pt"><mtr id="S3.E4.m1.32.32.4a"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.32.32.4b"><mrow id="S3.E4.m1.31.31.3.30.16.16"><msubsup id="S3.E4.m1.31.31.3.30.16.16.17"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">S</mi><mi id="S3.E4.m1.3.3.3.3.3.3.1" xref="S3.E4.m1.3.3.3.3.3.3.1.cmml">d</mi><mrow id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml"><mrow id="S3.E4.m1.2.2.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.2.2.1.2.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.1.2.2" xref="S3.E4.m1.2.2.2.2.2.2.1.2.2.cmml">p</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.2.3" xref="S3.E4.m1.2.2.2.2.2.2.1.2.3.cmml">o</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.2.1a" xref="S3.E4.m1.2.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.2.4" xref="S3.E4.m1.2.2.2.2.2.2.1.2.4.cmml">s</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.2.1b" xref="S3.E4.m1.2.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.2.5" xref="S3.E4.m1.2.2.2.2.2.2.1.2.5.cmml">t</mi></mrow><mo id="S3.E4.m1.2.2.2.2.2.2.1.1" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">→</mo><mrow id="S3.E4.m1.2.2.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.1.3.2" xref="S3.E4.m1.2.2.2.2.2.2.1.3.2.cmml">p</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.3.1" xref="S3.E4.m1.2.2.2.2.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.3.3" xref="S3.E4.m1.2.2.2.2.2.2.1.3.3.cmml">r</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.3.1a" xref="S3.E4.m1.2.2.2.2.2.2.1.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.3.4" xref="S3.E4.m1.2.2.2.2.2.2.1.3.4.cmml">e</mi></mrow></mrow></msubsup><mo id="S3.E4.m1.4.4.4.4.4.4" xref="S3.E4.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S3.E4.m1.31.31.3.30.16.16.16"><mrow id="S3.E4.m1.31.31.3.30.16.16.16.2"><mi id="S3.E4.m1.5.5.5.5.5.5" xref="S3.E4.m1.5.5.5.5.5.5.cmml">α</mi><mo id="S3.E4.m1.6.6.6.6.6.6" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.6.6.6.6.6.6.cmml">×</mo><mrow id="S3.E4.m1.31.31.3.30.16.16.16.2.2.2"><munder id="S3.E4.m1.30.30.2.29.15.15.15.1.1.1.1"><mi id="S3.E4.m1.7.7.7.7.7.7" xref="S3.E4.m1.7.7.7.7.7.7.cmml">max</mi><mrow id="S3.E4.m1.8.8.8.8.8.8.1" xref="S3.E4.m1.8.8.8.8.8.8.1.cmml"><mi id="S3.E4.m1.8.8.8.8.8.8.1.2" xref="S3.E4.m1.8.8.8.8.8.8.1.2.cmml">p</mi><mo id="S3.E4.m1.8.8.8.8.8.8.1.1" xref="S3.E4.m1.8.8.8.8.8.8.1.1.cmml">∈</mo><mi id="S3.E4.m1.8.8.8.8.8.8.1.3" xref="S3.E4.m1.8.8.8.8.8.8.1.3.cmml">d</mi></mrow></munder><mo id="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a" xref="S3.E4.m1.29.29.1.1.1.cmml">⁡</mo><mrow id="S3.E4.m1.31.31.3.30.16.16.16.2.2.2.2"><mo id="S3.E4.m1.9.9.9.9.9.9" xref="S3.E4.m1.29.29.1.1.1.cmml">{</mo><msubsup id="S3.E4.m1.31.31.3.30.16.16.16.2.2.2.2.1"><mi id="S3.E4.m1.10.10.10.10.10.10" xref="S3.E4.m1.10.10.10.10.10.10.cmml">S</mi><mi id="S3.E4.m1.12.12.12.12.12.12.1" xref="S3.E4.m1.12.12.12.12.12.12.1.cmml">p</mi><mrow id="S3.E4.m1.11.11.11.11.11.11.1" xref="S3.E4.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.E4.m1.11.11.11.11.11.11.1.2" xref="S3.E4.m1.11.11.11.11.11.11.1.2.cmml">p</mi><mo id="S3.E4.m1.11.11.11.11.11.11.1.1" xref="S3.E4.m1.11.11.11.11.11.11.1.1.cmml">⁢</mo><mi id="S3.E4.m1.11.11.11.11.11.11.1.3" xref="S3.E4.m1.11.11.11.11.11.11.1.3.cmml">o</mi><mo id="S3.E4.m1.11.11.11.11.11.11.1.1a" xref="S3.E4.m1.11.11.11.11.11.11.1.1.cmml">⁢</mo><mi id="S3.E4.m1.11.11.11.11.11.11.1.4" xref="S3.E4.m1.11.11.11.11.11.11.1.4.cmml">s</mi><mo id="S3.E4.m1.11.11.11.11.11.11.1.1b" xref="S3.E4.m1.11.11.11.11.11.11.1.1.cmml">⁢</mo><mi id="S3.E4.m1.11.11.11.11.11.11.1.5" xref="S3.E4.m1.11.11.11.11.11.11.1.5.cmml">t</mi></mrow></msubsup><mo id="S3.E4.m1.13.13.13.13.13.13" xref="S3.E4.m1.29.29.1.1.1.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E4.m1.14.14.14.14.14.14" xref="S3.E4.m1.14.14.14.14.14.14.cmml">+</mo></mrow></mrow></mtd><mtd id="S3.E4.m1.32.32.4c" xref="S3.E4.m1.29.29.1.1.1.cmml"></mtd></mtr><mtr id="S3.E4.m1.32.32.4d"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.32.32.4e"><mrow id="S3.E4.m1.32.32.4.31.15.15.15"><mrow id="S3.E4.m1.32.32.4.31.15.15.15.1"><mrow id="S3.E4.m1.32.32.4.31.15.15.15.1.1.1"><mo id="S3.E4.m1.15.15.15.1.1.1" stretchy="false" xref="S3.E4.m1.29.29.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.32.32.4.31.15.15.15.1.1.1.1"><mn id="S3.E4.m1.16.16.16.2.2.2" xref="S3.E4.m1.16.16.16.2.2.2.cmml">1</mn><mo id="S3.E4.m1.17.17.17.3.3.3" xref="S3.E4.m1.17.17.17.3.3.3.cmml">−</mo><mi id="S3.E4.m1.18.18.18.4.4.4" xref="S3.E4.m1.18.18.18.4.4.4.cmml">α</mi></mrow><mo id="S3.E4.m1.19.19.19.5.5.5" rspace="0.055em" stretchy="false" xref="S3.E4.m1.29.29.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.20.20.20.6.6.6" rspace="0.222em" xref="S3.E4.m1.20.20.20.6.6.6.cmml">×</mo><mrow id="S3.E4.m1.32.32.4.31.15.15.15.1.2"><munder id="S3.E4.m1.32.32.4.31.15.15.15.1.2.2"><mtext id="S3.E4.m1.21.21.21.7.7.7" xref="S3.E4.m1.21.21.21.7.7.7a.cmml">mean</mtext><mrow id="S3.E4.m1.22.22.22.8.8.8.1" xref="S3.E4.m1.22.22.22.8.8.8.1.cmml"><mi id="S3.E4.m1.22.22.22.8.8.8.1.2" xref="S3.E4.m1.22.22.22.8.8.8.1.2.cmml">p</mi><mo id="S3.E4.m1.22.22.22.8.8.8.1.1" xref="S3.E4.m1.22.22.22.8.8.8.1.1.cmml">∈</mo><mi id="S3.E4.m1.22.22.22.8.8.8.1.3" xref="S3.E4.m1.22.22.22.8.8.8.1.3.cmml">d</mi></mrow></munder><mrow id="S3.E4.m1.32.32.4.31.15.15.15.1.2.1.1"><mo id="S3.E4.m1.23.23.23.9.9.9" xref="S3.E4.m1.29.29.1.1.1.cmml">{</mo><msubsup id="S3.E4.m1.32.32.4.31.15.15.15.1.2.1.1.1"><mi id="S3.E4.m1.24.24.24.10.10.10" xref="S3.E4.m1.24.24.24.10.10.10.cmml">S</mi><mi id="S3.E4.m1.26.26.26.12.12.12.1" xref="S3.E4.m1.26.26.26.12.12.12.1.cmml">p</mi><mrow id="S3.E4.m1.25.25.25.11.11.11.1" xref="S3.E4.m1.25.25.25.11.11.11.1.cmml"><mi id="S3.E4.m1.25.25.25.11.11.11.1.2" xref="S3.E4.m1.25.25.25.11.11.11.1.2.cmml">p</mi><mo id="S3.E4.m1.25.25.25.11.11.11.1.1" xref="S3.E4.m1.25.25.25.11.11.11.1.1.cmml">⁢</mo><mi id="S3.E4.m1.25.25.25.11.11.11.1.3" xref="S3.E4.m1.25.25.25.11.11.11.1.3.cmml">o</mi><mo id="S3.E4.m1.25.25.25.11.11.11.1.1a" xref="S3.E4.m1.25.25.25.11.11.11.1.1.cmml">⁢</mo><mi id="S3.E4.m1.25.25.25.11.11.11.1.4" xref="S3.E4.m1.25.25.25.11.11.11.1.4.cmml">s</mi><mo id="S3.E4.m1.25.25.25.11.11.11.1.1b" xref="S3.E4.m1.25.25.25.11.11.11.1.1.cmml">⁢</mo><mi id="S3.E4.m1.25.25.25.11.11.11.1.5" xref="S3.E4.m1.25.25.25.11.11.11.1.5.cmml">t</mi></mrow></msubsup><mo id="S3.E4.m1.27.27.27.13.13.13" xref="S3.E4.m1.29.29.1.1.1.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E4.m1.28.28.28.14.14.14" xref="S3.E4.m1.29.29.1.1.1.cmml">,</mo></mrow></mtd><mtd id="S3.E4.m1.32.32.4f" xref="S3.E4.m1.29.29.1.1.1.cmml"></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.32b"><apply id="S3.E4.m1.29.29.1.1.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><eq id="S3.E4.m1.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4"></eq><apply id="S3.E4.m1.29.29.1.1.1.6.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.1.1.1.6.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a">subscript</csymbol><apply id="S3.E4.m1.29.29.1.1.1.6.2.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.1.1.1.6.2.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑆</ci><apply id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1"><ci id="S3.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.1">→</ci><apply id="S3.E4.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2"><times id="S3.E4.m1.2.2.2.2.2.2.1.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2.1"></times><ci id="S3.E4.m1.2.2.2.2.2.2.1.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2.2">𝑝</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2.3">𝑜</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.2.4.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2.4">𝑠</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.2.5.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2.5">𝑡</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3"><times id="S3.E4.m1.2.2.2.2.2.2.1.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3.1"></times><ci id="S3.E4.m1.2.2.2.2.2.2.1.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3.2">𝑝</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.3.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3.3">𝑟</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.3.4.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3.4">𝑒</ci></apply></apply></apply><ci id="S3.E4.m1.3.3.3.3.3.3.1.cmml" xref="S3.E4.m1.3.3.3.3.3.3.1">𝑑</ci></apply><apply id="S3.E4.m1.29.29.1.1.1.4.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><plus id="S3.E4.m1.14.14.14.14.14.14.cmml" xref="S3.E4.m1.14.14.14.14.14.14"></plus><apply id="S3.E4.m1.29.29.1.1.1.2.2.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><times id="S3.E4.m1.6.6.6.6.6.6.cmml" xref="S3.E4.m1.6.6.6.6.6.6"></times><ci id="S3.E4.m1.5.5.5.5.5.5.cmml" xref="S3.E4.m1.5.5.5.5.5.5">𝛼</ci><apply id="S3.E4.m1.29.29.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><apply id="S3.E4.m1.29.29.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a">subscript</csymbol><max id="S3.E4.m1.7.7.7.7.7.7.cmml" xref="S3.E4.m1.7.7.7.7.7.7"></max><apply id="S3.E4.m1.8.8.8.8.8.8.1.cmml" xref="S3.E4.m1.8.8.8.8.8.8.1"><in id="S3.E4.m1.8.8.8.8.8.8.1.1.cmml" xref="S3.E4.m1.8.8.8.8.8.8.1.1"></in><ci id="S3.E4.m1.8.8.8.8.8.8.1.2.cmml" xref="S3.E4.m1.8.8.8.8.8.8.1.2">𝑝</ci><ci id="S3.E4.m1.8.8.8.8.8.8.1.3.cmml" xref="S3.E4.m1.8.8.8.8.8.8.1.3">𝑑</ci></apply></apply><apply id="S3.E4.m1.29.29.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.1.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a">subscript</csymbol><apply id="S3.E4.m1.29.29.1.1.1.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.1.1.1.2.2.2.2.2.1.2.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a">superscript</csymbol><ci id="S3.E4.m1.10.10.10.10.10.10.cmml" xref="S3.E4.m1.10.10.10.10.10.10">𝑆</ci><apply id="S3.E4.m1.11.11.11.11.11.11.1.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1"><times id="S3.E4.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.1"></times><ci id="S3.E4.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2">𝑝</ci><ci id="S3.E4.m1.11.11.11.11.11.11.1.3.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.3">𝑜</ci><ci id="S3.E4.m1.11.11.11.11.11.11.1.4.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.4">𝑠</ci><ci id="S3.E4.m1.11.11.11.11.11.11.1.5.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.5">𝑡</ci></apply></apply><ci id="S3.E4.m1.12.12.12.12.12.12.1.cmml" xref="S3.E4.m1.12.12.12.12.12.12.1">𝑝</ci></apply></apply></apply><apply id="S3.E4.m1.29.29.1.1.1.4.4.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><times id="S3.E4.m1.20.20.20.6.6.6.cmml" xref="S3.E4.m1.20.20.20.6.6.6"></times><apply id="S3.E4.m1.29.29.1.1.1.3.3.1.1.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><minus id="S3.E4.m1.17.17.17.3.3.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3"></minus><cn id="S3.E4.m1.16.16.16.2.2.2.cmml" type="integer" xref="S3.E4.m1.16.16.16.2.2.2">1</cn><ci id="S3.E4.m1.18.18.18.4.4.4.cmml" xref="S3.E4.m1.18.18.18.4.4.4">𝛼</ci></apply><apply id="S3.E4.m1.29.29.1.1.1.4.4.2.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><apply id="S3.E4.m1.29.29.1.1.1.4.4.2.2.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.1.1.1.4.4.2.2.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a">subscript</csymbol><ci id="S3.E4.m1.21.21.21.7.7.7a.cmml" xref="S3.E4.m1.21.21.21.7.7.7"><mtext id="S3.E4.m1.21.21.21.7.7.7.cmml" xref="S3.E4.m1.21.21.21.7.7.7">mean</mtext></ci><apply id="S3.E4.m1.22.22.22.8.8.8.1.cmml" xref="S3.E4.m1.22.22.22.8.8.8.1"><in id="S3.E4.m1.22.22.22.8.8.8.1.1.cmml" xref="S3.E4.m1.22.22.22.8.8.8.1.1"></in><ci id="S3.E4.m1.22.22.22.8.8.8.1.2.cmml" xref="S3.E4.m1.22.22.22.8.8.8.1.2">𝑝</ci><ci id="S3.E4.m1.22.22.22.8.8.8.1.3.cmml" xref="S3.E4.m1.22.22.22.8.8.8.1.3">𝑑</ci></apply></apply><set id="S3.E4.m1.29.29.1.1.1.4.4.2.1.2.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><apply id="S3.E4.m1.29.29.1.1.1.4.4.2.1.1.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.1.1.1.4.4.2.1.1.1.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a">subscript</csymbol><apply id="S3.E4.m1.29.29.1.1.1.4.4.2.1.1.1.2.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.1.1.1.4.4.2.1.1.1.2.1.cmml" xref="S3.E4.m1.31.31.3.30.16.16.16.2.2.2a">superscript</csymbol><ci id="S3.E4.m1.24.24.24.10.10.10.cmml" xref="S3.E4.m1.24.24.24.10.10.10">𝑆</ci><apply id="S3.E4.m1.25.25.25.11.11.11.1.cmml" xref="S3.E4.m1.25.25.25.11.11.11.1"><times id="S3.E4.m1.25.25.25.11.11.11.1.1.cmml" xref="S3.E4.m1.25.25.25.11.11.11.1.1"></times><ci id="S3.E4.m1.25.25.25.11.11.11.1.2.cmml" xref="S3.E4.m1.25.25.25.11.11.11.1.2">𝑝</ci><ci id="S3.E4.m1.25.25.25.11.11.11.1.3.cmml" xref="S3.E4.m1.25.25.25.11.11.11.1.3">𝑜</ci><ci id="S3.E4.m1.25.25.25.11.11.11.1.4.cmml" xref="S3.E4.m1.25.25.25.11.11.11.1.4">𝑠</ci><ci id="S3.E4.m1.25.25.25.11.11.11.1.5.cmml" xref="S3.E4.m1.25.25.25.11.11.11.1.5">𝑡</ci></apply></apply><ci id="S3.E4.m1.26.26.26.12.12.12.1.cmml" xref="S3.E4.m1.26.26.26.12.12.12.1">𝑝</ci></apply></set></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.32c">\begin{split}S^{post\rightarrow pre}_{d}=\alpha\times\max_{p\in d}\left\{S^{{%
post}}_{p}\right\}+&amp;\\
(1-\alpha)\times\mathop{\text{mean}}\limits_{p\in d}\left\{S^{{post}}_{p}%
\right\},&amp;\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.32d">start_ROW start_CELL italic_S start_POSTSUPERSCRIPT italic_p italic_o italic_s italic_t → italic_p italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = italic_α × roman_max start_POSTSUBSCRIPT italic_p ∈ italic_d end_POSTSUBSCRIPT { italic_S start_POSTSUPERSCRIPT italic_p italic_o italic_s italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT } + end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL ( 1 - italic_α ) × mean start_POSTSUBSCRIPT italic_p ∈ italic_d end_POSTSUBSCRIPT { italic_S start_POSTSUPERSCRIPT italic_p italic_o italic_s italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT } , end_CELL start_CELL end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.5">where <math alttext="\alpha\in[0,1]" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.3" xref="S3.SS2.p1.1.m1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml">α</mi><mo id="S3.SS2.p1.1.m1.2.3.1" xref="S3.SS2.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p1.1.m1.2.3.3.2" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml"><mo id="S3.SS2.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">0</mn><mo id="S3.SS2.p1.1.m1.2.3.3.2.2" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">1</mn><mo id="S3.SS2.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3"><in id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.1"></in><ci id="S3.SS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2">𝛼</ci><interval closure="closed" id="S3.SS2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2"><cn id="S3.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1">0</cn><cn id="S3.SS2.p1.1.m1.2.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">\alpha\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">italic_α ∈ [ 0 , 1 ]</annotation></semantics></math> controls the strength of ‘<span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.1">max</span>’ and ‘<span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.2">mean</span>’ parts. When <math alttext="\alpha=1" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">α</mi><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><eq id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></eq><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝛼</ci><cn id="S3.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_α = 1</annotation></semantics></math>, the score focuses on the most important passage in the document; when <math alttext="\alpha=0" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">α</mi><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><eq id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></eq><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝛼</ci><cn id="S3.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\alpha=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_α = 0</annotation></semantics></math>, the score focuses on the average importance level of all passages in the document.
We annotate documents with <math alttext="\text{Top-}\mathcal{K}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mtext id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2a.cmml">Top-</mtext><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><times id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></times><ci id="S3.SS2.p1.4.m4.1.1.2a.cmml" xref="S3.SS2.p1.4.m4.1.1.2"><mtext id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">Top-</mtext></ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\text{Top-}\mathcal{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">Top- caligraphic_K</annotation></semantics></math> aggregated scores as positive. Inspired by <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib61" title="">2023</a>)</cite>, we annotate the ones <math alttext="\mathcal{D}^{h+}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msup id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">h</mi><mo id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml">+</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝒟</ci><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3">limit-from</csymbol><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">ℎ</ci><plus id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathcal{D}^{h+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">caligraphic_D start_POSTSUPERSCRIPT italic_h + end_POSTSUPERSCRIPT</annotation></semantics></math> that <span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.3">h</span>it the ground truth as positive to make the training process more robust:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{D}^{+}&amp;=\mathcal{D}^{h+}\cup\mathop{\text{Top-}\mathcal{%
K}}\limits_{S^{post\rightarrow pre}_{d}}\mathcal{D}_{m},\\
\mathcal{D}^{-}&amp;=\mathcal{D}_{m}\backslash\mathcal{D}^{+},\end{split}" class="ltx_Math" display="block" id="S3.E5.m1.23"><semantics id="S3.E5.m1.23a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E5.m1.23.23.3" rowspacing="0pt"><mtr id="S3.E5.m1.23.23.3a"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.23.23.3b"><msup id="S3.E5.m1.2.2.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">𝒟</mi><mo id="S3.E5.m1.2.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.2.1.cmml">+</mo></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.23.23.3c"><mrow id="S3.E5.m1.22.22.2.21.12.10.10"><mrow id="S3.E5.m1.22.22.2.21.12.10.10.1"><mi id="S3.E5.m1.22.22.2.21.12.10.10.1.1"></mi><mo id="S3.E5.m1.3.3.3.3.1.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E5.m1.22.22.2.21.12.10.10.1.2"><msup id="S3.E5.m1.22.22.2.21.12.10.10.1.2.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.4.4.2.2" xref="S3.E5.m1.4.4.4.4.2.2.cmml">𝒟</mi><mrow id="S3.E5.m1.5.5.5.5.3.3.1" xref="S3.E5.m1.5.5.5.5.3.3.1.cmml"><mi id="S3.E5.m1.5.5.5.5.3.3.1.2" xref="S3.E5.m1.5.5.5.5.3.3.1.2.cmml">h</mi><mo id="S3.E5.m1.5.5.5.5.3.3.1.3" xref="S3.E5.m1.5.5.5.5.3.3.1.3.cmml">+</mo></mrow></msup><mo id="S3.E5.m1.6.6.6.6.4.4" xref="S3.E5.m1.6.6.6.6.4.4.cmml">∪</mo><mrow id="S3.E5.m1.22.22.2.21.12.10.10.1.2.2"><munder id="S3.E5.m1.22.22.2.21.12.10.10.1.2.2.1"><mrow id="S3.E5.m1.7.7.7.7.5.5" xref="S3.E5.m1.7.7.7.7.5.5.cmml"><mtext id="S3.E5.m1.7.7.7.7.5.5.2" xref="S3.E5.m1.7.7.7.7.5.5.2a.cmml">Top-</mtext><mo id="S3.E5.m1.7.7.7.7.5.5.1" xref="S3.E5.m1.7.7.7.7.5.5.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.7.7.7.7.5.5.3" xref="S3.E5.m1.7.7.7.7.5.5.3.cmml">𝒦</mi></mrow><msubsup id="S3.E5.m1.8.8.8.8.6.6.1" xref="S3.E5.m1.8.8.8.8.6.6.1.cmml"><mi id="S3.E5.m1.8.8.8.8.6.6.1.2.2" xref="S3.E5.m1.8.8.8.8.6.6.1.2.2.cmml">S</mi><mi id="S3.E5.m1.8.8.8.8.6.6.1.3" xref="S3.E5.m1.8.8.8.8.6.6.1.3.cmml">d</mi><mrow id="S3.E5.m1.8.8.8.8.6.6.1.2.3" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.cmml"><mrow id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.cmml"><mi id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.2" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.2.cmml">p</mi><mo id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.1" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.3" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.3.cmml">o</mi><mo id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.1a" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.4" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.4.cmml">s</mi><mo id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.1b" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.5" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.5.cmml">t</mi></mrow><mo id="S3.E5.m1.8.8.8.8.6.6.1.2.3.1" stretchy="false" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.1.cmml">→</mo><mrow id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.cmml"><mi id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.2" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.2.cmml">p</mi><mo id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.1" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.3" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.3.cmml">r</mi><mo id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.1a" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.4" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.4.cmml">e</mi></mrow></mrow></msubsup></munder><msub id="S3.E5.m1.22.22.2.21.12.10.10.1.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.9.9.9.9.7.7" xref="S3.E5.m1.9.9.9.9.7.7.cmml">𝒟</mi><mi id="S3.E5.m1.10.10.10.10.8.8.1" xref="S3.E5.m1.10.10.10.10.8.8.1.cmml">m</mi></msub></mrow></mrow></mrow><mo id="S3.E5.m1.11.11.11.11.9.9">,</mo></mrow></mtd></mtr><mtr id="S3.E5.m1.23.23.3d"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.23.23.3e"><msup id="S3.E5.m1.13.13.13.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.12.12.12.1.1.1" xref="S3.E5.m1.12.12.12.1.1.1.cmml">𝒟</mi><mo id="S3.E5.m1.13.13.13.2.2.2.1" xref="S3.E5.m1.13.13.13.2.2.2.1.cmml">−</mo></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.23.23.3f"><mrow id="S3.E5.m1.23.23.3.22.10.8.8"><mrow id="S3.E5.m1.23.23.3.22.10.8.8.1"><mi id="S3.E5.m1.23.23.3.22.10.8.8.1.1"></mi><mo id="S3.E5.m1.14.14.14.3.1.1" xref="S3.E5.m1.14.14.14.3.1.1.cmml">=</mo><mrow id="S3.E5.m1.23.23.3.22.10.8.8.1.2"><msub id="S3.E5.m1.23.23.3.22.10.8.8.1.2.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.15.15.15.4.2.2" xref="S3.E5.m1.15.15.15.4.2.2.cmml">𝒟</mi><mi id="S3.E5.m1.16.16.16.5.3.3.1" xref="S3.E5.m1.16.16.16.5.3.3.1.cmml">m</mi></msub><mo id="S3.E5.m1.17.17.17.6.4.4" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.17.17.17.6.4.4.cmml">\</mo><msup id="S3.E5.m1.23.23.3.22.10.8.8.1.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.18.18.18.7.5.5" xref="S3.E5.m1.18.18.18.7.5.5.cmml">𝒟</mi><mo id="S3.E5.m1.19.19.19.8.6.6.1" xref="S3.E5.m1.19.19.19.8.6.6.1.cmml">+</mo></msup></mrow></mrow><mo id="S3.E5.m1.20.20.20.9.7.7">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.23b"><apply id="S3.E5.m1.21.21.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S3.E5.m1.21.21.1.1.1.1.1.cmml"><eq id="S3.E5.m1.3.3.3.3.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1"></eq><apply id="S3.E5.m1.21.21.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.1.1.1.1.1.2.1.cmml">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">𝒟</ci><plus id="S3.E5.m1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.1"></plus></apply><apply id="S3.E5.m1.21.21.1.1.1.1.1.3.cmml"><union id="S3.E5.m1.6.6.6.6.4.4.cmml" xref="S3.E5.m1.6.6.6.6.4.4"></union><apply id="S3.E5.m1.21.21.1.1.1.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.1.1.1.1.1.3.2.1.cmml">superscript</csymbol><ci id="S3.E5.m1.4.4.4.4.2.2.cmml" xref="S3.E5.m1.4.4.4.4.2.2">𝒟</ci><apply id="S3.E5.m1.5.5.5.5.3.3.1.cmml" xref="S3.E5.m1.5.5.5.5.3.3.1"><csymbol cd="latexml" id="S3.E5.m1.5.5.5.5.3.3.1.1.cmml" xref="S3.E5.m1.5.5.5.5.3.3.1">limit-from</csymbol><ci id="S3.E5.m1.5.5.5.5.3.3.1.2.cmml" xref="S3.E5.m1.5.5.5.5.3.3.1.2">ℎ</ci><plus id="S3.E5.m1.5.5.5.5.3.3.1.3.cmml" xref="S3.E5.m1.5.5.5.5.3.3.1.3"></plus></apply></apply><apply id="S3.E5.m1.21.21.1.1.1.1.1.3.3.cmml"><apply id="S3.E5.m1.21.21.1.1.1.1.1.3.3.1.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.1.1.1.1.1.3.3.1.1.cmml">subscript</csymbol><apply id="S3.E5.m1.7.7.7.7.5.5.cmml" xref="S3.E5.m1.7.7.7.7.5.5"><times id="S3.E5.m1.7.7.7.7.5.5.1.cmml" xref="S3.E5.m1.7.7.7.7.5.5.1"></times><ci id="S3.E5.m1.7.7.7.7.5.5.2a.cmml" xref="S3.E5.m1.7.7.7.7.5.5.2"><mtext id="S3.E5.m1.7.7.7.7.5.5.2.cmml" xref="S3.E5.m1.7.7.7.7.5.5.2">Top-</mtext></ci><ci id="S3.E5.m1.7.7.7.7.5.5.3.cmml" xref="S3.E5.m1.7.7.7.7.5.5.3">𝒦</ci></apply><apply id="S3.E5.m1.8.8.8.8.6.6.1.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.8.6.6.1.1.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1">subscript</csymbol><apply id="S3.E5.m1.8.8.8.8.6.6.1.2.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.8.6.6.1.2.1.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1">superscript</csymbol><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.2.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.2">𝑆</ci><apply id="S3.E5.m1.8.8.8.8.6.6.1.2.3.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3"><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.3.1.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.1">→</ci><apply id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2"><times id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.1.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.1"></times><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.2.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.2">𝑝</ci><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.3.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.3">𝑜</ci><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.4.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.4">𝑠</ci><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.5.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.2.5">𝑡</ci></apply><apply id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3"><times id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.1.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.1"></times><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.2.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.2">𝑝</ci><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.3.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.3">𝑟</ci><ci id="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.4.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.2.3.3.4">𝑒</ci></apply></apply></apply><ci id="S3.E5.m1.8.8.8.8.6.6.1.3.cmml" xref="S3.E5.m1.8.8.8.8.6.6.1.3">𝑑</ci></apply></apply><apply id="S3.E5.m1.21.21.1.1.1.1.1.3.3.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.1.1.1.1.1.3.3.2.1.cmml">subscript</csymbol><ci id="S3.E5.m1.9.9.9.9.7.7.cmml" xref="S3.E5.m1.9.9.9.9.7.7">𝒟</ci><ci id="S3.E5.m1.10.10.10.10.8.8.1.cmml" xref="S3.E5.m1.10.10.10.10.8.8.1">𝑚</ci></apply></apply></apply></apply><apply id="S3.E5.m1.21.21.1.1.1.2.2.cmml"><eq id="S3.E5.m1.14.14.14.3.1.1.cmml" xref="S3.E5.m1.14.14.14.3.1.1"></eq><apply id="S3.E5.m1.21.21.1.1.1.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.1.1.1.2.2.2.1.cmml">superscript</csymbol><ci id="S3.E5.m1.12.12.12.1.1.1.cmml" xref="S3.E5.m1.12.12.12.1.1.1">𝒟</ci><minus id="S3.E5.m1.13.13.13.2.2.2.1.cmml" xref="S3.E5.m1.13.13.13.2.2.2.1"></minus></apply><apply id="S3.E5.m1.21.21.1.1.1.2.2.3.cmml"><ci id="S3.E5.m1.17.17.17.6.4.4.cmml" xref="S3.E5.m1.17.17.17.6.4.4">\</ci><apply id="S3.E5.m1.21.21.1.1.1.2.2.3.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.1.1.1.2.2.3.2.1.cmml">subscript</csymbol><ci id="S3.E5.m1.15.15.15.4.2.2.cmml" xref="S3.E5.m1.15.15.15.4.2.2">𝒟</ci><ci id="S3.E5.m1.16.16.16.5.3.3.1.cmml" xref="S3.E5.m1.16.16.16.5.3.3.1">𝑚</ci></apply><apply id="S3.E5.m1.21.21.1.1.1.2.2.3.3.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.21.21.1.1.1.2.2.3.3.1.cmml">superscript</csymbol><ci id="S3.E5.m1.18.18.18.7.5.5.cmml" xref="S3.E5.m1.18.18.18.7.5.5">𝒟</ci><plus id="S3.E5.m1.19.19.19.8.6.6.1.cmml" xref="S3.E5.m1.19.19.19.8.6.6.1"></plus></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.23c">\begin{split}\mathcal{D}^{+}&amp;=\mathcal{D}^{h+}\cup\mathop{\text{Top-}\mathcal{%
K}}\limits_{S^{post\rightarrow pre}_{d}}\mathcal{D}_{m},\\
\mathcal{D}^{-}&amp;=\mathcal{D}_{m}\backslash\mathcal{D}^{+},\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.23d">start_ROW start_CELL caligraphic_D start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_CELL start_CELL = caligraphic_D start_POSTSUPERSCRIPT italic_h + end_POSTSUPERSCRIPT ∪ start_BIGOP Top- caligraphic_K end_BIGOP start_POSTSUBSCRIPT italic_S start_POSTSUPERSCRIPT italic_p italic_o italic_s italic_t → italic_p italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL caligraphic_D start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_CELL start_CELL = caligraphic_D start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT \ caligraphic_D start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.6">where the remaining documents (<span class="ltx_text ltx_font_italic" id="S3.SS2.p1.6.1">i.e.,</span> <math alttext="\mathcal{D}_{m}\backslash\mathcal{D}^{+}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m1.1"><semantics id="S3.SS2.p1.6.m1.1a"><mrow id="S3.SS2.p1.6.m1.1.1" xref="S3.SS2.p1.6.m1.1.1.cmml"><msub id="S3.SS2.p1.6.m1.1.1.2" xref="S3.SS2.p1.6.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m1.1.1.2.2" xref="S3.SS2.p1.6.m1.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.6.m1.1.1.2.3" xref="S3.SS2.p1.6.m1.1.1.2.3.cmml">m</mi></msub><mo id="S3.SS2.p1.6.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.6.m1.1.1.1.cmml">\</mo><msup id="S3.SS2.p1.6.m1.1.1.3" xref="S3.SS2.p1.6.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m1.1.1.3.2" xref="S3.SS2.p1.6.m1.1.1.3.2.cmml">𝒟</mi><mo id="S3.SS2.p1.6.m1.1.1.3.3" xref="S3.SS2.p1.6.m1.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m1.1b"><apply id="S3.SS2.p1.6.m1.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1"><ci id="S3.SS2.p1.6.m1.1.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1.1">\</ci><apply id="S3.SS2.p1.6.m1.1.1.2.cmml" xref="S3.SS2.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m1.1.1.2.1.cmml" xref="S3.SS2.p1.6.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.6.m1.1.1.2.2.cmml" xref="S3.SS2.p1.6.m1.1.1.2.2">𝒟</ci><ci id="S3.SS2.p1.6.m1.1.1.2.3.cmml" xref="S3.SS2.p1.6.m1.1.1.2.3">𝑚</ci></apply><apply id="S3.SS2.p1.6.m1.1.1.3.cmml" xref="S3.SS2.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.6.m1.1.1.3.2.cmml" xref="S3.SS2.p1.6.m1.1.1.3.2">𝒟</ci><plus id="S3.SS2.p1.6.m1.1.1.3.3.cmml" xref="S3.SS2.p1.6.m1.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m1.1c">\mathcal{D}_{m}\backslash\mathcal{D}^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT \ caligraphic_D start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math>) serves as negative ones.
Following ANCE <cite class="ltx_cite ltx_citemacro_cite">Xiong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib56" title="">2021</a>)</cite>, we adopt the pairwise Bayesian Personalized Ranking (BPR) loss <cite class="ltx_cite ltx_citemacro_cite">Rendle et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib40" title="">2009</a>)</cite>, enforcing the match score between the query and positive documents to be higher than negative ones:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\sum_{q}\sum_{d^{+}\in\mathcal{D}^{+}}\sum_{d^{-}\in\mathcal{D}^{-%
}}-\log\sigma(S^{{pre}}_{d^{+}}-S^{{pre}}_{d^{-}})," class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml">ℒ</mi><mo id="S3.E6.m1.1.1.1.1.2" rspace="0.111em" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml"><munder id="S3.E6.m1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.3.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.3.1.2" movablelimits="false" rspace="0em" xref="S3.E6.m1.1.1.1.1.1.3.1.2.cmml">∑</mo><mi id="S3.E6.m1.1.1.1.1.1.3.1.3" xref="S3.E6.m1.1.1.1.1.1.3.1.3.cmml">q</mi></munder><mrow id="S3.E6.m1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.cmml"><munder id="S3.E6.m1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.1.1.1.1.1.3.2.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.3.2.1.2" movablelimits="false" rspace="0em" xref="S3.E6.m1.1.1.1.1.1.3.2.1.2.cmml">∑</mo><mrow id="S3.E6.m1.1.1.1.1.1.3.2.1.3" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.cmml"><msup id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.2.cmml">d</mi><mo id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.3" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.3.cmml">+</mo></msup><mo id="S3.E6.m1.1.1.1.1.1.3.2.1.3.1" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.1.cmml">∈</mo><msup id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.2.cmml">𝒟</mi><mo id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.3.cmml">+</mo></msup></mrow></munder><munder id="S3.E6.m1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.3.2.2.2" movablelimits="false" rspace="0em" xref="S3.E6.m1.1.1.1.1.1.3.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.1.1.1.1.1.3.2.2.3" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.cmml"><msup id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.2.cmml">d</mi><mo id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.3" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.3.cmml">−</mo></msup><mo id="S3.E6.m1.1.1.1.1.1.3.2.2.3.1" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.1.cmml">∈</mo><msup id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.2.cmml">𝒟</mi><mo id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.3.cmml">−</mo></msup></mrow></munder></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.2" lspace="0em" xref="S3.E6.m1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E6.m1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E6.m1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">S</mi><msup id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">d</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">+</mo></msup><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">p</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">r</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.4" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.4.cmml">e</mi></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">S</mi><msup id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">d</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">−</mo></msup><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">p</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">r</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.4" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml">e</mi></mrow></msubsup></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><ci id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3">ℒ</ci><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><minus id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></minus><apply id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3"><apply id="S3.E6.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.1.3.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.1.2"></sum><ci id="S3.E6.m1.1.1.1.1.1.3.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.1.3">𝑞</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2"><apply id="S3.E6.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.1.3.2.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.2"></sum><apply id="S3.E6.m1.1.1.1.1.1.3.2.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3"><in id="S3.E6.m1.1.1.1.1.1.3.2.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.1"></in><apply id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.2">𝑑</ci><plus id="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.2.3"></plus></apply><apply id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.2">𝒟</ci><plus id="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.1.3.3.3"></plus></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.2"></sum><apply id="S3.E6.m1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3"><in id="S3.E6.m1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.1"></in><apply id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.2">𝑑</ci><minus id="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.2.3"></minus></apply><apply id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.2">𝒟</ci><minus id="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.3.3.3"></minus></apply></apply></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"><log id="S3.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.1"></log><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝑆</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑝</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑟</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.4">𝑒</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑑</ci><plus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.3"></plus></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑆</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑟</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.4">𝑒</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑑</ci><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3"></minus></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathcal{L}=\sum_{q}\sum_{d^{+}\in\mathcal{D}^{+}}\sum_{d^{-}\in\mathcal{D}^{-%
}}-\log\sigma(S^{{pre}}_{d^{+}}-S^{{pre}}_{d^{-}}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">caligraphic_L = ∑ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ∈ caligraphic_D start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ∈ caligraphic_D start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT - roman_log italic_σ ( italic_S start_POSTSUPERSCRIPT italic_p italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT - italic_S start_POSTSUPERSCRIPT italic_p italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.11">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m1.1"><semantics id="S3.SS2.p1.7.m1.1a"><mrow id="S3.SS2.p1.7.m1.1.2" xref="S3.SS2.p1.7.m1.1.2.cmml"><mi id="S3.SS2.p1.7.m1.1.2.2" xref="S3.SS2.p1.7.m1.1.2.2.cmml">σ</mi><mo id="S3.SS2.p1.7.m1.1.2.1" xref="S3.SS2.p1.7.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.7.m1.1.2.3.2" xref="S3.SS2.p1.7.m1.1.2.cmml"><mo id="S3.SS2.p1.7.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.7.m1.1.2.cmml">(</mo><mo id="S3.SS2.p1.7.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p1.7.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.p1.7.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.7.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m1.1b"><apply id="S3.SS2.p1.7.m1.1.2.cmml" xref="S3.SS2.p1.7.m1.1.2"><times id="S3.SS2.p1.7.m1.1.2.1.cmml" xref="S3.SS2.p1.7.m1.1.2.1"></times><ci id="S3.SS2.p1.7.m1.1.2.2.cmml" xref="S3.SS2.p1.7.m1.1.2.2">𝜎</ci><ci id="S3.SS2.p1.7.m1.1.1.cmml" xref="S3.SS2.p1.7.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m1.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m1.1d">italic_σ ( ⋅ )</annotation></semantics></math> denotes the sigmoid function; <math alttext="S^{{pre}}_{d^{+}}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m2.1"><semantics id="S3.SS2.p1.8.m2.1a"><msubsup id="S3.SS2.p1.8.m2.1.1" xref="S3.SS2.p1.8.m2.1.1.cmml"><mi id="S3.SS2.p1.8.m2.1.1.2.2" xref="S3.SS2.p1.8.m2.1.1.2.2.cmml">S</mi><msup id="S3.SS2.p1.8.m2.1.1.3" xref="S3.SS2.p1.8.m2.1.1.3.cmml"><mi id="S3.SS2.p1.8.m2.1.1.3.2" xref="S3.SS2.p1.8.m2.1.1.3.2.cmml">d</mi><mo id="S3.SS2.p1.8.m2.1.1.3.3" xref="S3.SS2.p1.8.m2.1.1.3.3.cmml">+</mo></msup><mrow id="S3.SS2.p1.8.m2.1.1.2.3" xref="S3.SS2.p1.8.m2.1.1.2.3.cmml"><mi id="S3.SS2.p1.8.m2.1.1.2.3.2" xref="S3.SS2.p1.8.m2.1.1.2.3.2.cmml">p</mi><mo id="S3.SS2.p1.8.m2.1.1.2.3.1" xref="S3.SS2.p1.8.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m2.1.1.2.3.3" xref="S3.SS2.p1.8.m2.1.1.2.3.3.cmml">r</mi><mo id="S3.SS2.p1.8.m2.1.1.2.3.1a" xref="S3.SS2.p1.8.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.8.m2.1.1.2.3.4" xref="S3.SS2.p1.8.m2.1.1.2.3.4.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m2.1b"><apply id="S3.SS2.p1.8.m2.1.1.cmml" xref="S3.SS2.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m2.1.1.1.cmml" xref="S3.SS2.p1.8.m2.1.1">subscript</csymbol><apply id="S3.SS2.p1.8.m2.1.1.2.cmml" xref="S3.SS2.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m2.1.1.2.1.cmml" xref="S3.SS2.p1.8.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.8.m2.1.1.2.2.cmml" xref="S3.SS2.p1.8.m2.1.1.2.2">𝑆</ci><apply id="S3.SS2.p1.8.m2.1.1.2.3.cmml" xref="S3.SS2.p1.8.m2.1.1.2.3"><times id="S3.SS2.p1.8.m2.1.1.2.3.1.cmml" xref="S3.SS2.p1.8.m2.1.1.2.3.1"></times><ci id="S3.SS2.p1.8.m2.1.1.2.3.2.cmml" xref="S3.SS2.p1.8.m2.1.1.2.3.2">𝑝</ci><ci id="S3.SS2.p1.8.m2.1.1.2.3.3.cmml" xref="S3.SS2.p1.8.m2.1.1.2.3.3">𝑟</ci><ci id="S3.SS2.p1.8.m2.1.1.2.3.4.cmml" xref="S3.SS2.p1.8.m2.1.1.2.3.4">𝑒</ci></apply></apply><apply id="S3.SS2.p1.8.m2.1.1.3.cmml" xref="S3.SS2.p1.8.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m2.1.1.3.1.cmml" xref="S3.SS2.p1.8.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.8.m2.1.1.3.2.cmml" xref="S3.SS2.p1.8.m2.1.1.3.2">𝑑</ci><plus id="S3.SS2.p1.8.m2.1.1.3.3.cmml" xref="S3.SS2.p1.8.m2.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m2.1c">S^{{pre}}_{d^{+}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m2.1d">italic_S start_POSTSUPERSCRIPT italic_p italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="S^{{pre}}_{d^{-}}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m3.1"><semantics id="S3.SS2.p1.9.m3.1a"><msubsup id="S3.SS2.p1.9.m3.1.1" xref="S3.SS2.p1.9.m3.1.1.cmml"><mi id="S3.SS2.p1.9.m3.1.1.2.2" xref="S3.SS2.p1.9.m3.1.1.2.2.cmml">S</mi><msup id="S3.SS2.p1.9.m3.1.1.3" xref="S3.SS2.p1.9.m3.1.1.3.cmml"><mi id="S3.SS2.p1.9.m3.1.1.3.2" xref="S3.SS2.p1.9.m3.1.1.3.2.cmml">d</mi><mo id="S3.SS2.p1.9.m3.1.1.3.3" xref="S3.SS2.p1.9.m3.1.1.3.3.cmml">−</mo></msup><mrow id="S3.SS2.p1.9.m3.1.1.2.3" xref="S3.SS2.p1.9.m3.1.1.2.3.cmml"><mi id="S3.SS2.p1.9.m3.1.1.2.3.2" xref="S3.SS2.p1.9.m3.1.1.2.3.2.cmml">p</mi><mo id="S3.SS2.p1.9.m3.1.1.2.3.1" xref="S3.SS2.p1.9.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m3.1.1.2.3.3" xref="S3.SS2.p1.9.m3.1.1.2.3.3.cmml">r</mi><mo id="S3.SS2.p1.9.m3.1.1.2.3.1a" xref="S3.SS2.p1.9.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m3.1.1.2.3.4" xref="S3.SS2.p1.9.m3.1.1.2.3.4.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m3.1b"><apply id="S3.SS2.p1.9.m3.1.1.cmml" xref="S3.SS2.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m3.1.1.1.cmml" xref="S3.SS2.p1.9.m3.1.1">subscript</csymbol><apply id="S3.SS2.p1.9.m3.1.1.2.cmml" xref="S3.SS2.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m3.1.1.2.1.cmml" xref="S3.SS2.p1.9.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.9.m3.1.1.2.2.cmml" xref="S3.SS2.p1.9.m3.1.1.2.2">𝑆</ci><apply id="S3.SS2.p1.9.m3.1.1.2.3.cmml" xref="S3.SS2.p1.9.m3.1.1.2.3"><times id="S3.SS2.p1.9.m3.1.1.2.3.1.cmml" xref="S3.SS2.p1.9.m3.1.1.2.3.1"></times><ci id="S3.SS2.p1.9.m3.1.1.2.3.2.cmml" xref="S3.SS2.p1.9.m3.1.1.2.3.2">𝑝</ci><ci id="S3.SS2.p1.9.m3.1.1.2.3.3.cmml" xref="S3.SS2.p1.9.m3.1.1.2.3.3">𝑟</ci><ci id="S3.SS2.p1.9.m3.1.1.2.3.4.cmml" xref="S3.SS2.p1.9.m3.1.1.2.3.4">𝑒</ci></apply></apply><apply id="S3.SS2.p1.9.m3.1.1.3.cmml" xref="S3.SS2.p1.9.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m3.1.1.3.1.cmml" xref="S3.SS2.p1.9.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.9.m3.1.1.3.2.cmml" xref="S3.SS2.p1.9.m3.1.1.3.2">𝑑</ci><minus id="S3.SS2.p1.9.m3.1.1.3.3.cmml" xref="S3.SS2.p1.9.m3.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m3.1c">S^{{pre}}_{d^{-}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m3.1d">italic_S start_POSTSUPERSCRIPT italic_p italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> denote  <math alttext="{f}(q,d^{+})" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m4.2"><semantics id="S3.SS2.p1.10.m4.2a"><mrow id="S3.SS2.p1.10.m4.2.2" xref="S3.SS2.p1.10.m4.2.2.cmml"><mi id="S3.SS2.p1.10.m4.2.2.3" xref="S3.SS2.p1.10.m4.2.2.3.cmml">f</mi><mo id="S3.SS2.p1.10.m4.2.2.2" xref="S3.SS2.p1.10.m4.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p1.10.m4.2.2.1.1" xref="S3.SS2.p1.10.m4.2.2.1.2.cmml"><mo id="S3.SS2.p1.10.m4.2.2.1.1.2" stretchy="false" xref="S3.SS2.p1.10.m4.2.2.1.2.cmml">(</mo><mi id="S3.SS2.p1.10.m4.1.1" xref="S3.SS2.p1.10.m4.1.1.cmml">q</mi><mo id="S3.SS2.p1.10.m4.2.2.1.1.3" xref="S3.SS2.p1.10.m4.2.2.1.2.cmml">,</mo><msup id="S3.SS2.p1.10.m4.2.2.1.1.1" xref="S3.SS2.p1.10.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.10.m4.2.2.1.1.1.2" xref="S3.SS2.p1.10.m4.2.2.1.1.1.2.cmml">d</mi><mo id="S3.SS2.p1.10.m4.2.2.1.1.1.3" xref="S3.SS2.p1.10.m4.2.2.1.1.1.3.cmml">+</mo></msup><mo id="S3.SS2.p1.10.m4.2.2.1.1.4" stretchy="false" xref="S3.SS2.p1.10.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m4.2b"><apply id="S3.SS2.p1.10.m4.2.2.cmml" xref="S3.SS2.p1.10.m4.2.2"><times id="S3.SS2.p1.10.m4.2.2.2.cmml" xref="S3.SS2.p1.10.m4.2.2.2"></times><ci id="S3.SS2.p1.10.m4.2.2.3.cmml" xref="S3.SS2.p1.10.m4.2.2.3">𝑓</ci><interval closure="open" id="S3.SS2.p1.10.m4.2.2.1.2.cmml" xref="S3.SS2.p1.10.m4.2.2.1.1"><ci id="S3.SS2.p1.10.m4.1.1.cmml" xref="S3.SS2.p1.10.m4.1.1">𝑞</ci><apply id="S3.SS2.p1.10.m4.2.2.1.1.1.cmml" xref="S3.SS2.p1.10.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.10.m4.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.10.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.10.m4.2.2.1.1.1.2">𝑑</ci><plus id="S3.SS2.p1.10.m4.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.10.m4.2.2.1.1.1.3"></plus></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m4.2c">{f}(q,d^{+})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m4.2d">italic_f ( italic_q , italic_d start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT )</annotation></semantics></math>  and  <math alttext="{f}(q,d^{-})" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m5.2"><semantics id="S3.SS2.p1.11.m5.2a"><mrow id="S3.SS2.p1.11.m5.2.2" xref="S3.SS2.p1.11.m5.2.2.cmml"><mi id="S3.SS2.p1.11.m5.2.2.3" xref="S3.SS2.p1.11.m5.2.2.3.cmml">f</mi><mo id="S3.SS2.p1.11.m5.2.2.2" xref="S3.SS2.p1.11.m5.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p1.11.m5.2.2.1.1" xref="S3.SS2.p1.11.m5.2.2.1.2.cmml"><mo id="S3.SS2.p1.11.m5.2.2.1.1.2" stretchy="false" xref="S3.SS2.p1.11.m5.2.2.1.2.cmml">(</mo><mi id="S3.SS2.p1.11.m5.1.1" xref="S3.SS2.p1.11.m5.1.1.cmml">q</mi><mo id="S3.SS2.p1.11.m5.2.2.1.1.3" xref="S3.SS2.p1.11.m5.2.2.1.2.cmml">,</mo><msup id="S3.SS2.p1.11.m5.2.2.1.1.1" xref="S3.SS2.p1.11.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.11.m5.2.2.1.1.1.2" xref="S3.SS2.p1.11.m5.2.2.1.1.1.2.cmml">d</mi><mo id="S3.SS2.p1.11.m5.2.2.1.1.1.3" xref="S3.SS2.p1.11.m5.2.2.1.1.1.3.cmml">−</mo></msup><mo id="S3.SS2.p1.11.m5.2.2.1.1.4" stretchy="false" xref="S3.SS2.p1.11.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m5.2b"><apply id="S3.SS2.p1.11.m5.2.2.cmml" xref="S3.SS2.p1.11.m5.2.2"><times id="S3.SS2.p1.11.m5.2.2.2.cmml" xref="S3.SS2.p1.11.m5.2.2.2"></times><ci id="S3.SS2.p1.11.m5.2.2.3.cmml" xref="S3.SS2.p1.11.m5.2.2.3">𝑓</ci><interval closure="open" id="S3.SS2.p1.11.m5.2.2.1.2.cmml" xref="S3.SS2.p1.11.m5.2.2.1.1"><ci id="S3.SS2.p1.11.m5.1.1.cmml" xref="S3.SS2.p1.11.m5.1.1">𝑞</ci><apply id="S3.SS2.p1.11.m5.2.2.1.1.1.cmml" xref="S3.SS2.p1.11.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.11.m5.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.11.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.11.m5.2.2.1.1.1.2">𝑑</ci><minus id="S3.SS2.p1.11.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.11.m5.2.2.1.1.1.3"></minus></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m5.2c">{f}(q,d^{-})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m5.2d">italic_f ( italic_q , italic_d start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT )</annotation></semantics></math>,  respectively.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we conduct extensive experiments on two QA benchmark datasets to answer the following Research Questions (<span class="ltx_text ltx_font_bold" id="S4.p1.1.1">RQs</span>): <span class="ltx_text ltx_font_bold" id="S4.p1.1.2">RQ1:</span> How does progressive retrieval perform <span class="ltx_text ltx_font_italic" id="S4.p1.1.3">w.r.t.</span> Answer Recall when compared to flat one? <span class="ltx_text ltx_font_bold" id="S4.p1.1.4">RQ2:</span> What are the benefits of performing <span class="ltx_text ltx_font_smallcaps" id="S4.p1.1.5">FunnelRAG</span> in Question Answering? <span class="ltx_text ltx_font_bold" id="S4.p1.1.6">RQ3:</span> How do different settings influence the effectiveness of progressive retrieval?</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Settings</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets.  </span> We experiment on two QA datasets: <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.2">i.e.,</span> Natural Question (NQ) <cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib26" title="">2019</a>)</cite> and Trivia QA (TQA) <cite class="ltx_cite ltx_citemacro_cite">Joshi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib23" title="">2017</a>)</cite>. Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.SS1" title="B.1 Datasets ‣ Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">B.1</span></a> provides the statistics of the datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Metrics.  </span> Following <cite class="ltx_cite ltx_citemacro_cite">Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib29" title="">2020</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib21" title="">2024</a>)</cite>, we employ Answer Recall (AR) and Exact Match (EM) to measure the performance of retrieval and generation, respectively. Besides, we use time cost as the metric of retrieval efficiency.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Retrievers.  </span> In progressive retrieval, we adopt BM25 <cite class="ltx_cite ltx_citemacro_cite">Robertson and Zaragoza (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib41" title="">2009</a>)</cite> for retrieval, employ bge-reranker-v2-m3 <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib3" title="">2024</a>)</cite> as our pre-ranker, and leverage FiD <cite class="ltx_cite ltx_citemacro_cite">Izacard and Grave (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib18" title="">2021b</a>)</cite> to perform post-ranking. As for flat retrieval, we use bge-large-en-v1.5 <cite class="ltx_cite ltx_citemacro_cite">Xiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib54" title="">2023</a>)</cite>, the SOTA embedding model, to retrieve passages, and use bge-reranker-v2-m3  to  rerank.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">Generators.  </span> We choose two representative open-source LLMs: Llama3-8B-Instruct <cite class="ltx_cite ltx_citemacro_cite">Dubey et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib8" title="">2024</a>)</cite> and Qwen2-7B-Instruct <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib59" title="">2024</a>)</cite>, for our QA evaluation<span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note">10</span>We use Llama3-8B and Qwen2-7B to represent Llama3-8B-Instruct and Qwen2-7B-Instruct, respectively, for brevity.</span></span></span>. More details related to experimental settings can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2" title="Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.18">
<tr class="ltx_tr" id="S4.T2.18.19">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.18.19.1" rowspan="2" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.18.19.1.1">Datasets</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.18.19.2" rowspan="2" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.18.19.2.1">Retrieval Paradigm</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.18.19.3" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.18.19.3.1">Retrieval Stages</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.18.19.4" rowspan="2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.18.19.4.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.18.19.4.1.1">
<span class="ltx_tr" id="S4.T2.18.19.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.18.19.4.1.1.1.1" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.18.19.4.1.1.1.1.1">Time Cost</span></span></span>
<span class="ltx_tr" id="S4.T2.18.19.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.18.19.4.1.1.2.1" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.18.19.4.1.1.2.1.1">(T)</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.18.19.5" rowspan="2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.18.19.5.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.18.19.5.1.1">
<span class="ltx_tr" id="S4.T2.18.19.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.18.19.5.1.1.1.1" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.18.19.5.1.1.1.1.1">Answer Recall</span></span></span>
<span class="ltx_tr" id="S4.T2.18.19.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.18.19.5.1.1.2.1" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.18.19.5.1.1.2.1.1">(AR)</span></span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.18.20">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.18.20.1" style="padding:1pt 3.6pt;">Retrieval</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.18.20.2" style="padding:1pt 3.6pt;">Pre/Re-ranking</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.18.20.3" style="padding:1pt 3.6pt;">Post-ranking</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1">
<td class="ltx_td ltx_border_t" id="S4.T2.1.1.2" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3" rowspan="2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.1.1.3.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.1" style="padding:1pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">→</annotation></semantics></math> 4p</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.4" style="padding:1pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.5" style="padding:1pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.1.1.6" style="padding:1pt 3.6pt;">4.90 (4.90+N/A+N/A)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.7" style="padding:1pt 3.6pt;">72.91</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3">
<td class="ltx_td" id="S4.T2.3.3.3" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T2.2.2.1" style="padding:1pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.2.2.1.m1.1"><semantics id="S4.T2.2.2.1.m1.1a"><mo id="S4.T2.2.2.1.m1.1.1" stretchy="false" xref="S4.T2.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><ci id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.m1.1d">→</annotation></semantics></math> 400p</td>
<td class="ltx_td ltx_align_left" id="S4.T2.3.3.2" style="padding:1pt 3.6pt;">400p <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.3.3.2.m1.1"><semantics id="S4.T2.3.3.2.m1.1a"><mo id="S4.T2.3.3.2.m1.1.1" stretchy="false" xref="S4.T2.3.3.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.2.m1.1b"><ci id="S4.T2.3.3.2.m1.1.1.cmml" xref="S4.T2.3.3.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.2.m1.1d">→</annotation></semantics></math> 4p</td>
<td class="ltx_td ltx_align_left" id="S4.T2.3.3.4" style="padding:1pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left" id="S4.T2.3.3.5" style="padding:1pt 3.6pt;">5.25 (4.90+0.35+N/A)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.6" style="padding:1pt 3.6pt;">75.90</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4">
<td class="ltx_td" id="S4.T2.4.4.2" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td" id="S4.T2.4.4.3" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T2.4.4.1" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.4.4.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.4.4.1.1.m1.1"><semantics id="S4.T2.4.4.1.1.m1.1a"><mo id="S4.T2.4.4.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.4.4.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.1.m1.1b"><ci id="S4.T2.4.4.1.1.m1.1.1.cmml" xref="S4.T2.4.4.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.1.1.m1.1d">→</annotation></semantics></math> 4c</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.4.4.4" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.4.4.4.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.4.4.5" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.4.4.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.4.4.6" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.4.4.6.1" style="background-color:#F0F0F0;">0.00 (0.00+N/A+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.7" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.4.4.7.1" style="background-color:#F0F0F0;">71.69</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6">
<td class="ltx_td" id="S4.T2.6.6.3" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td" id="S4.T2.6.6.4" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T2.5.5.1" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.5.5.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.5.5.1.1.m1.1"><semantics id="S4.T2.5.5.1.1.m1.1a"><mo id="S4.T2.5.5.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.5.5.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.1.1.m1.1b"><ci id="S4.T2.5.5.1.1.m1.1.1.cmml" xref="S4.T2.5.5.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.1.1.m1.1d">→</annotation></semantics></math> 20c</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.6.6.2.1" style="background-color:#F0F0F0;">20c <math alttext="\xrightarrow[]{\sim\text{180d}}" class="ltx_Math" display="inline" id="S4.T2.6.6.2.1.m1.1"><semantics id="S4.T2.6.6.2.1.m1.1a"><mover accent="true" id="S4.T2.6.6.2.1.m1.1.1" xref="S4.T2.6.6.2.1.m1.1.1.cmml"><mo id="S4.T2.6.6.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.6.6.2.1.m1.1.1.2.cmml">→</mo><mrow id="S4.T2.6.6.2.1.m1.1.1.1" xref="S4.T2.6.6.2.1.m1.1.1.1.cmml"><mi id="S4.T2.6.6.2.1.m1.1.1.1.2" xref="S4.T2.6.6.2.1.m1.1.1.1.2.cmml"></mi><mo id="S4.T2.6.6.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="S4.T2.6.6.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="S4.T2.6.6.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="S4.T2.6.6.2.1.m1.1.1.1.3a.cmml">180d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.2.1.m1.1b"><apply id="S4.T2.6.6.2.1.m1.1.1.cmml" xref="S4.T2.6.6.2.1.m1.1.1"><apply id="S4.T2.6.6.2.1.m1.1.1.1.cmml" xref="S4.T2.6.6.2.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T2.6.6.2.1.m1.1.1.1.1.cmml" xref="S4.T2.6.6.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.T2.6.6.2.1.m1.1.1.1.2.cmml" xref="S4.T2.6.6.2.1.m1.1.1.1.2">absent</csymbol><ci id="S4.T2.6.6.2.1.m1.1.1.1.3a.cmml" xref="S4.T2.6.6.2.1.m1.1.1.1.3"><mtext id="S4.T2.6.6.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="S4.T2.6.6.2.1.m1.1.1.1.3">180d</mtext></ci></apply><ci id="S4.T2.6.6.2.1.m1.1.1.2.cmml" xref="S4.T2.6.6.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.2.1.m1.1c">\xrightarrow[]{\sim\text{180d}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 180d end_OVERACCENT → end_ARROW</annotation></semantics></math> 4d</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.5" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.6.6.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.6" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.6.6.6.1" style="background-color:#F0F0F0;">0.49 (0.00+0.49+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.7" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.6.6.7.1" style="background-color:#F0F0F0;">74.57</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.9.9" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center" id="S4.T2.9.9.4" style="background-color:#FFFFFF;padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.9.9.4.1" style="background-color:#FFFFFF;"><span class="ltx_text" id="S4.T2.9.9.4.1.1">NQ</span></span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.9.5" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.9.9.5.1" style="background-color:#F0F0F0;">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.7.7.1" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.7.7.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.7.7.1.1.m1.1"><semantics id="S4.T2.7.7.1.1.m1.1a"><mo id="S4.T2.7.7.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.7.7.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.1.1.m1.1b"><ci id="S4.T2.7.7.1.1.m1.1.1.cmml" xref="S4.T2.7.7.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.1.1.m1.1d">→</annotation></semantics></math> 80c</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.8.8.2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.8.8.2.1" style="background-color:#F0F0F0;">80c <math alttext="\xrightarrow[]{\sim\text{740d}}" class="ltx_Math" display="inline" id="S4.T2.8.8.2.1.m1.1"><semantics id="S4.T2.8.8.2.1.m1.1a"><mover accent="true" id="S4.T2.8.8.2.1.m1.1.1" xref="S4.T2.8.8.2.1.m1.1.1.cmml"><mo id="S4.T2.8.8.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.8.8.2.1.m1.1.1.2.cmml">→</mo><mrow id="S4.T2.8.8.2.1.m1.1.1.1" xref="S4.T2.8.8.2.1.m1.1.1.1.cmml"><mi id="S4.T2.8.8.2.1.m1.1.1.1.2" xref="S4.T2.8.8.2.1.m1.1.1.1.2.cmml"></mi><mo id="S4.T2.8.8.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="S4.T2.8.8.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="S4.T2.8.8.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="S4.T2.8.8.2.1.m1.1.1.1.3a.cmml">740d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.2.1.m1.1b"><apply id="S4.T2.8.8.2.1.m1.1.1.cmml" xref="S4.T2.8.8.2.1.m1.1.1"><apply id="S4.T2.8.8.2.1.m1.1.1.1.cmml" xref="S4.T2.8.8.2.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T2.8.8.2.1.m1.1.1.1.1.cmml" xref="S4.T2.8.8.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.T2.8.8.2.1.m1.1.1.1.2.cmml" xref="S4.T2.8.8.2.1.m1.1.1.1.2">absent</csymbol><ci id="S4.T2.8.8.2.1.m1.1.1.1.3a.cmml" xref="S4.T2.8.8.2.1.m1.1.1.1.3"><mtext id="S4.T2.8.8.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="S4.T2.8.8.2.1.m1.1.1.1.3">740d</mtext></ci></apply><ci id="S4.T2.8.8.2.1.m1.1.1.2.cmml" xref="S4.T2.8.8.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.2.1.m1.1c">\xrightarrow[]{\sim\text{740d}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 740d end_OVERACCENT → end_ARROW</annotation></semantics></math> 8d</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.9.9.3" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.9.9.3.1" style="background-color:#F0F0F0;">8d <math alttext="\xrightarrow[]{\sim\text{50p}}" class="ltx_Math" display="inline" id="S4.T2.9.9.3.1.m1.1"><semantics id="S4.T2.9.9.3.1.m1.1a"><mover accent="true" id="S4.T2.9.9.3.1.m1.1.1" xref="S4.T2.9.9.3.1.m1.1.1.cmml"><mo id="S4.T2.9.9.3.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.9.9.3.1.m1.1.1.2.cmml">→</mo><mrow id="S4.T2.9.9.3.1.m1.1.1.1" xref="S4.T2.9.9.3.1.m1.1.1.1.cmml"><mi id="S4.T2.9.9.3.1.m1.1.1.1.2" xref="S4.T2.9.9.3.1.m1.1.1.1.2.cmml"></mi><mo id="S4.T2.9.9.3.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="S4.T2.9.9.3.1.m1.1.1.1.1.cmml">∼</mo><mtext id="S4.T2.9.9.3.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="S4.T2.9.9.3.1.m1.1.1.1.3a.cmml">50p</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.3.1.m1.1b"><apply id="S4.T2.9.9.3.1.m1.1.1.cmml" xref="S4.T2.9.9.3.1.m1.1.1"><apply id="S4.T2.9.9.3.1.m1.1.1.1.cmml" xref="S4.T2.9.9.3.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T2.9.9.3.1.m1.1.1.1.1.cmml" xref="S4.T2.9.9.3.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.T2.9.9.3.1.m1.1.1.1.2.cmml" xref="S4.T2.9.9.3.1.m1.1.1.1.2">absent</csymbol><ci id="S4.T2.9.9.3.1.m1.1.1.1.3a.cmml" xref="S4.T2.9.9.3.1.m1.1.1.1.3"><mtext id="S4.T2.9.9.3.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="S4.T2.9.9.3.1.m1.1.1.1.3">50p</mtext></ci></apply><ci id="S4.T2.9.9.3.1.m1.1.1.2.cmml" xref="S4.T2.9.9.3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.3.1.m1.1c">\xrightarrow[]{\sim\text{50p}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.9.3.1.m1.1d">start_ARROW start_OVERACCENT ∼ 50p end_OVERACCENT → end_ARROW</annotation></semantics></math> 4p</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.9.9.6" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.9.9.6.1" style="background-color:#F0F0F0;">2.97 (0.00+2.20+0.77)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.9.9.7" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.9.9.7.1" style="background-color:#F0F0F0;">75.43</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.10.10">
<td class="ltx_td ltx_border_t" id="S4.T2.10.10.2" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.10.10.3" rowspan="2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.10.10.3.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.10.10.1" style="padding:1pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.10.10.1.m1.1"><semantics id="S4.T2.10.10.1.m1.1a"><mo id="S4.T2.10.10.1.m1.1.1" stretchy="false" xref="S4.T2.10.10.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.1.m1.1b"><ci id="S4.T2.10.10.1.m1.1.1.cmml" xref="S4.T2.10.10.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.10.1.m1.1d">→</annotation></semantics></math> 4p</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.10.10.4" style="padding:1pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.10.10.5" style="padding:1pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.10.10.6" style="padding:1pt 3.6pt;">5.02 (5.02+N/A+N/A)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.10.10.7" style="padding:1pt 3.6pt;">75.22</td>
</tr>
<tr class="ltx_tr" id="S4.T2.12.12">
<td class="ltx_td" id="S4.T2.12.12.3" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T2.11.11.1" style="padding:1pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.11.11.1.m1.1"><semantics id="S4.T2.11.11.1.m1.1a"><mo id="S4.T2.11.11.1.m1.1.1" stretchy="false" xref="S4.T2.11.11.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.1.m1.1b"><ci id="S4.T2.11.11.1.m1.1.1.cmml" xref="S4.T2.11.11.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.11.1.m1.1d">→</annotation></semantics></math> 400p</td>
<td class="ltx_td ltx_align_left" id="S4.T2.12.12.2" style="padding:1pt 3.6pt;">400p <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.12.12.2.m1.1"><semantics id="S4.T2.12.12.2.m1.1a"><mo id="S4.T2.12.12.2.m1.1.1" stretchy="false" xref="S4.T2.12.12.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.2.m1.1b"><ci id="S4.T2.12.12.2.m1.1.1.cmml" xref="S4.T2.12.12.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.12.12.2.m1.1d">→</annotation></semantics></math> 4p</td>
<td class="ltx_td ltx_align_left" id="S4.T2.12.12.4" style="padding:1pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left" id="S4.T2.12.12.5" style="padding:1pt 3.6pt;">5.41 (5.02+0.39+N/A)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.12.6" style="padding:1pt 3.6pt;">81.29</td>
</tr>
<tr class="ltx_tr" id="S4.T2.13.13">
<td class="ltx_td" id="S4.T2.13.13.2" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td" id="S4.T2.13.13.3" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T2.13.13.1" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.13.13.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.13.13.1.1.m1.1"><semantics id="S4.T2.13.13.1.1.m1.1a"><mo id="S4.T2.13.13.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.13.13.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.1.1.m1.1b"><ci id="S4.T2.13.13.1.1.m1.1.1.cmml" xref="S4.T2.13.13.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.13.1.1.m1.1d">→</annotation></semantics></math> 4c</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.13.13.4" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.13.13.4.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.13.13.5" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.13.13.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.13.13.6" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.13.13.6.1" style="background-color:#F0F0F0;">0.00 (0.00+N/A+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.13.13.7" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.13.13.7.1" style="background-color:#F0F0F0;">78.94</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.15.15">
<td class="ltx_td" id="S4.T2.15.15.3" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td" id="S4.T2.15.15.4" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="S4.T2.14.14.1" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.14.14.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.14.14.1.1.m1.1"><semantics id="S4.T2.14.14.1.1.m1.1a"><mo id="S4.T2.14.14.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.14.14.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.1.1.m1.1b"><ci id="S4.T2.14.14.1.1.m1.1.1.cmml" xref="S4.T2.14.14.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.14.14.1.1.m1.1d">→</annotation></semantics></math> 20c</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.15.15.2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.15.15.2.1" style="background-color:#F0F0F0;">20c <math alttext="\xrightarrow[]{\sim\text{200d}}" class="ltx_Math" display="inline" id="S4.T2.15.15.2.1.m1.1"><semantics id="S4.T2.15.15.2.1.m1.1a"><mover accent="true" id="S4.T2.15.15.2.1.m1.1.1" xref="S4.T2.15.15.2.1.m1.1.1.cmml"><mo id="S4.T2.15.15.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.15.15.2.1.m1.1.1.2.cmml">→</mo><mrow id="S4.T2.15.15.2.1.m1.1.1.1" xref="S4.T2.15.15.2.1.m1.1.1.1.cmml"><mi id="S4.T2.15.15.2.1.m1.1.1.1.2" xref="S4.T2.15.15.2.1.m1.1.1.1.2.cmml"></mi><mo id="S4.T2.15.15.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="S4.T2.15.15.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="S4.T2.15.15.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="S4.T2.15.15.2.1.m1.1.1.1.3a.cmml">200d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.2.1.m1.1b"><apply id="S4.T2.15.15.2.1.m1.1.1.cmml" xref="S4.T2.15.15.2.1.m1.1.1"><apply id="S4.T2.15.15.2.1.m1.1.1.1.cmml" xref="S4.T2.15.15.2.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T2.15.15.2.1.m1.1.1.1.1.cmml" xref="S4.T2.15.15.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.T2.15.15.2.1.m1.1.1.1.2.cmml" xref="S4.T2.15.15.2.1.m1.1.1.1.2">absent</csymbol><ci id="S4.T2.15.15.2.1.m1.1.1.1.3a.cmml" xref="S4.T2.15.15.2.1.m1.1.1.1.3"><mtext id="S4.T2.15.15.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="S4.T2.15.15.2.1.m1.1.1.1.3">200d</mtext></ci></apply><ci id="S4.T2.15.15.2.1.m1.1.1.2.cmml" xref="S4.T2.15.15.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.2.1.m1.1c">\xrightarrow[]{\sim\text{200d}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.15.15.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 200d end_OVERACCENT → end_ARROW</annotation></semantics></math> 4d</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.15.15.5" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.15.15.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.15.15.6" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.15.15.6.1" style="background-color:#F0F0F0;">0.60 (0.00+0.60+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.15.15.7" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.15.15.7.1" style="background-color:#F0F0F0;">80.00</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.18.18" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.18.18.4" style="background-color:#FFFFFF;padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.18.18.4.1" style="background-color:#FFFFFF;"><span class="ltx_text" id="S4.T2.18.18.4.1.1">TQA</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.18.18.5" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.18.18.5.1" style="background-color:#F0F0F0;">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.16.16.1" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.16.16.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.16.16.1.1.m1.1"><semantics id="S4.T2.16.16.1.1.m1.1a"><mo id="S4.T2.16.16.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.16.16.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.16.16.1.1.m1.1b"><ci id="S4.T2.16.16.1.1.m1.1.1.cmml" xref="S4.T2.16.16.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.16.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.16.16.1.1.m1.1d">→</annotation></semantics></math> 80c</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.17.17.2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.17.17.2.1" style="background-color:#F0F0F0;">80c <math alttext="\xrightarrow[]{\sim\text{800d}}" class="ltx_Math" display="inline" id="S4.T2.17.17.2.1.m1.1"><semantics id="S4.T2.17.17.2.1.m1.1a"><mover accent="true" id="S4.T2.17.17.2.1.m1.1.1" xref="S4.T2.17.17.2.1.m1.1.1.cmml"><mo id="S4.T2.17.17.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.17.17.2.1.m1.1.1.2.cmml">→</mo><mrow id="S4.T2.17.17.2.1.m1.1.1.1" xref="S4.T2.17.17.2.1.m1.1.1.1.cmml"><mi id="S4.T2.17.17.2.1.m1.1.1.1.2" xref="S4.T2.17.17.2.1.m1.1.1.1.2.cmml"></mi><mo id="S4.T2.17.17.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="S4.T2.17.17.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="S4.T2.17.17.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="S4.T2.17.17.2.1.m1.1.1.1.3a.cmml">800d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="S4.T2.17.17.2.1.m1.1b"><apply id="S4.T2.17.17.2.1.m1.1.1.cmml" xref="S4.T2.17.17.2.1.m1.1.1"><apply id="S4.T2.17.17.2.1.m1.1.1.1.cmml" xref="S4.T2.17.17.2.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T2.17.17.2.1.m1.1.1.1.1.cmml" xref="S4.T2.17.17.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.T2.17.17.2.1.m1.1.1.1.2.cmml" xref="S4.T2.17.17.2.1.m1.1.1.1.2">absent</csymbol><ci id="S4.T2.17.17.2.1.m1.1.1.1.3a.cmml" xref="S4.T2.17.17.2.1.m1.1.1.1.3"><mtext id="S4.T2.17.17.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="S4.T2.17.17.2.1.m1.1.1.1.3">800d</mtext></ci></apply><ci id="S4.T2.17.17.2.1.m1.1.1.2.cmml" xref="S4.T2.17.17.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.17.2.1.m1.1c">\xrightarrow[]{\sim\text{800d}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.17.17.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 800d end_OVERACCENT → end_ARROW</annotation></semantics></math> 12d</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.18.18.3" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.18.18.3.1" style="background-color:#F0F0F0;">12d <math alttext="\xrightarrow[]{\sim\text{65p}}" class="ltx_Math" display="inline" id="S4.T2.18.18.3.1.m1.1"><semantics id="S4.T2.18.18.3.1.m1.1a"><mover accent="true" id="S4.T2.18.18.3.1.m1.1.1" xref="S4.T2.18.18.3.1.m1.1.1.cmml"><mo id="S4.T2.18.18.3.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="S4.T2.18.18.3.1.m1.1.1.2.cmml">→</mo><mrow id="S4.T2.18.18.3.1.m1.1.1.1" xref="S4.T2.18.18.3.1.m1.1.1.1.cmml"><mi id="S4.T2.18.18.3.1.m1.1.1.1.2" xref="S4.T2.18.18.3.1.m1.1.1.1.2.cmml"></mi><mo id="S4.T2.18.18.3.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="S4.T2.18.18.3.1.m1.1.1.1.1.cmml">∼</mo><mtext id="S4.T2.18.18.3.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="S4.T2.18.18.3.1.m1.1.1.1.3a.cmml">65p</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="S4.T2.18.18.3.1.m1.1b"><apply id="S4.T2.18.18.3.1.m1.1.1.cmml" xref="S4.T2.18.18.3.1.m1.1.1"><apply id="S4.T2.18.18.3.1.m1.1.1.1.cmml" xref="S4.T2.18.18.3.1.m1.1.1.1"><csymbol cd="latexml" id="S4.T2.18.18.3.1.m1.1.1.1.1.cmml" xref="S4.T2.18.18.3.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.T2.18.18.3.1.m1.1.1.1.2.cmml" xref="S4.T2.18.18.3.1.m1.1.1.1.2">absent</csymbol><ci id="S4.T2.18.18.3.1.m1.1.1.1.3a.cmml" xref="S4.T2.18.18.3.1.m1.1.1.1.3"><mtext id="S4.T2.18.18.3.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="S4.T2.18.18.3.1.m1.1.1.1.3">65p</mtext></ci></apply><ci id="S4.T2.18.18.3.1.m1.1.1.2.cmml" xref="S4.T2.18.18.3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.18.3.1.m1.1c">\xrightarrow[]{\sim\text{65p}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.18.18.3.1.m1.1d">start_ARROW start_OVERACCENT ∼ 65p end_OVERACCENT → end_ARROW</annotation></semantics></math> 4p</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.18.18.6" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.18.18.6.1" style="background-color:#F0F0F0;">3.47 (0.00+2.52+0.95)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.18.18.7" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T2.18.18.7.1" style="background-color:#F0F0F0;">80.69</span></td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Retrieval performance comparison <span class="ltx_text ltx_font_italic" id="S4.T2.22.1">w.r.t.</span> time cost and answer recall on NQ and TQA datasets, where ‘c’, ‘d’, and ‘p’ denote clustered documents, documents, and passages, respectively. The value on the arrow (<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.20.m1.1"><semantics id="S4.T2.20.m1.1b"><mo id="S4.T2.20.m1.1.1" stretchy="false" xref="S4.T2.20.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.20.m1.1c"><ci id="S4.T2.20.m1.1.1.cmml" xref="S4.T2.20.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.20.m1.1e">→</annotation></semantics></math>) indicates the number of fine-grained candidates after segmenting coarse-grained ones. The number of time cost is in seconds. We provide detailed hardware and software configurations for experiments on time cost in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.SS4" title="B.4 Hardware and Software Configurations ‣ Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">B.4</span></a>.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Retrieval Performance (RQ1)</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.3">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.T2" title="Table 2 ‣ 4.1 Experimental Settings ‣ 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.T10" title="Table 10 ‣ C.5 Case Study ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">10</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.T11" title="Table 11 ‣ C.5 Case Study ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">11</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.T12" title="Table 12 ‣ C.5 Case Study ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">12</span></a> shows the retrieval results on NQ and TQA datasets.
As BM25’s retrieval speed is breakneck, we mark its time cost as 0.00. From the results, we mainly have the following observations:
<span class="ltx_text ltx_font_bold" id="S4.SS2.p1.3.1">(1)</span> By adjusting the collaboration between large-to-small quantities, coarse-to-fine granularity, and simple-to-complex retrievers, progressive retrieval can find a gain-cost balance point.
Specifically, the time cost of progressive retrieval is considerably lower than that of the flat one (reduced by about 40%), while the AR is comparable to (or even better than) the flat one.
The main reason for this results is that progressive retrieval combines the advantage of different retrievers but circumvents their disadvantage<span class="ltx_note ltx_role_footnote" id="footnote11"><sup class="ltx_note_mark">11</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">11</sup><span class="ltx_tag ltx_tag_note">11</span>Progressive retrieval combines simple retrievers’ fast speed with complex ones’ high precision, while it avoids simple retrievers’ low precision and  complex  ones’ slow  speed.</span></span></span>.
<span class="ltx_text ltx_font_bold" id="S4.SS2.p1.3.2">(2)</span> By retrieving in a funnel manner (<span class="ltx_text ltx_font_italic" id="S4.SS2.p1.3.3">e.g.,</span> 600K<math alttext="\xrightarrow[]{\text{Retrieval}}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mover accent="true" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mo id="S4.SS2.p1.1.m1.1.1.2" stretchy="false" xref="S4.SS2.p1.1.m1.1.1.2.cmml">→</mo><mtext id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1a.cmml">Retrieval</mtext></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><ci id="S4.SS2.p1.1.m1.1.1.1a.cmml" xref="S4.SS2.p1.1.m1.1.1.1"><mtext id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">Retrieval</mtext></ci><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\xrightarrow[]{\text{Retrieval}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">start_ARROW overRetrieval → end_ARROW</annotation></semantics></math>80c<math alttext="\xrightarrow[]{\text{Pre-ranking}}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mover accent="true" id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mo id="S4.SS2.p1.2.m2.1.1.2" stretchy="false" xref="S4.SS2.p1.2.m2.1.1.2.cmml">→</mo><mtext id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1a.cmml">Pre-ranking</mtext></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><ci id="S4.SS2.p1.2.m2.1.1.1a.cmml" xref="S4.SS2.p1.2.m2.1.1.1"><mtext id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">Pre-ranking</mtext></ci><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\xrightarrow[]{\text{Pre-ranking}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">start_ARROW overPre-ranking → end_ARROW</annotation></semantics></math>8d<math alttext="\xrightarrow[]{\text{Post-ranking}}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mover accent="true" id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mo id="S4.SS2.p1.3.m3.1.1.2" stretchy="false" xref="S4.SS2.p1.3.m3.1.1.2.cmml">→</mo><mtext id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1a.cmml">Post-ranking</mtext></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><ci id="S4.SS2.p1.3.m3.1.1.1a.cmml" xref="S4.SS2.p1.3.m3.1.1.1"><mtext id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1">Post-ranking</mtext></ci><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\xrightarrow[]{\text{Post-ranking}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">start_ARROW overPost-ranking → end_ARROW</annotation></semantics></math>4p),
progressive retrieval enables load balancing. It assigns simple but computationally demanding tasks to low-capacity retrievers, <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.3.4">e.g.,</span> retrieving 80 clustered documents from 600K candidates.
With almost no loss of golden units, the number of candidates dropped 7500x, largely increasing the signal-to-noise ratio.
On the other hand, it assigns hard but computationally undemanding tasks to high-capacity retrievers, <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.3.5">e.g.,</span> retrieving 4p clustered documents from 8d candidates.
More retrieval performance comparisons can be seen in  appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS4" title="C.4 Retrieval Performance Comparison ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">C.4</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.1">
<tr class="ltx_tr" id="S4.T3.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1">Generators</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.2" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.2.1">@K</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T3.1.1.3" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.1">NQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="2" id="S4.T3.1.1.4" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.1">TQA</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.2">
<td class="ltx_td" id="S4.T3.1.2.1" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td" id="S4.T3.1.2.2" style="padding:1pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="S4.T3.1.2.3" style="padding:1pt 3.6pt;">Flat</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.4" style="padding:1pt 3.6pt;">Progressive</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="S4.T3.1.2.5" style="padding:1pt 3.6pt;">Flat</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.6" style="padding:1pt 3.6pt;">Progressive</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.3.1" rowspan="4" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T3.1.3.1.1">Llama3-8B</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.3.2" style="padding:1pt 3.6pt;">@1</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" id="S4.T3.1.3.3" style="padding:1pt 3.6pt;">43.88</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.1.3.4" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.3.4.1">51.27</span> (16.84%)</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" id="S4.T3.1.3.5" style="padding:1pt 3.6pt;">67.54</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.1.3.6" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.3.6.1">70.77</span> (4.78%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4">
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.1" style="padding:1pt 3.6pt;">@2</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.4.2" style="padding:1pt 3.6pt;">46.18</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.4.3" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.4.3.1">51.50</span> (11.52%)</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.4.4" style="padding:1pt 3.6pt;">66.84</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.4.5" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.4.5.1">67.66</span> (1.23%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5">
<td class="ltx_td ltx_align_center" id="S4.T3.1.5.1" style="padding:1pt 3.6pt;">@3</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.5.2" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.5.2.1">49.31</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.5.3" style="padding:1pt 3.6pt;">49.06 (-0.51%)</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.5.4" style="padding:1pt 3.6pt;">66.10</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.5.5" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.5.5.1">67.89</span> (2.71%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.6">
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.1" style="padding:1pt 3.6pt;">@4</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.6.2" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.6.2.1">51.44</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.6.3" style="padding:1pt 3.6pt;">48.86 (-5.02%)</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.6.4" style="padding:1pt 3.6pt;">67.10</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.6.5" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.6.5.1">68.47</span> (2.04%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.1" rowspan="4" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T3.1.7.1.1">Qwen2-7B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.7.2" style="padding:1pt 3.6pt;">@1</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="S4.T3.1.7.3" style="padding:1pt 3.6pt;">48.86</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.7.4" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.7.4.1">53.43</span> (9.35%)</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="S4.T3.1.7.5" style="padding:1pt 3.6pt;">72.01</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.7.6" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.7.6.1">72.39</span> (0.53%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.8">
<td class="ltx_td ltx_align_center" id="S4.T3.1.8.1" style="padding:1pt 3.6pt;">@2</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.8.2" style="padding:1pt 3.6pt;">53.32</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.8.3" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.8.3.1">54.27</span> (1.78%)</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.8.4" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.8.4.1">73.69</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.8.5" style="padding:1pt 3.6pt;">73.17 (-0.71%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.9">
<td class="ltx_td ltx_align_center" id="S4.T3.1.9.1" style="padding:1pt 3.6pt;">@3</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.9.2" style="padding:1pt 3.6pt;">54.63</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.9.3" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.9.3.1">55.07</span> (0.81%)</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.9.4" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.9.4.1">74.60</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.9.5" style="padding:1pt 3.6pt;">73.73 (-1.17%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.10">
<td class="ltx_td ltx_align_center" id="S4.T3.1.10.1" style="padding:1pt 3.6pt;">@4</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.10.2" style="padding:1pt 3.6pt;">55.46</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.10.3" style="padding:1pt 3.6pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.10.3.1">55.48</span> (0.04%)</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="S4.T3.1.10.4" style="padding:1pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.10.4.1">74.97</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.10.5" style="padding:1pt 3.6pt;">74.37 (-0.80%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.11">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" colspan="2" id="S4.T3.1.11.1" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T3.1.11.1.1">Average Performance</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_tt" id="S4.T3.1.11.2" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T3.1.11.2.1">50.39</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T3.1.11.3" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T3.1.11.3.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.11.3.1.1">52.37</span> (3.93%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_tt" id="S4.T3.1.11.4" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T3.1.11.4.1">70.36</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S4.T3.1.11.5" style="padding:1pt 3.6pt;"><span class="ltx_text" id="S4.T3.1.11.5.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.11.5.1.1">71.06</span> (0.99%)</span></td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Generation performance in terms of different retrieval paradigms. The <span class="ltx_text ltx_font_bold" id="S4.T3.3.1">bold</span> indicates the best results.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Generation Performance (RQ2)</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.T3" title="Table 3 ‣ 4.2 Retrieval Performance (RQ1) ‣ 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3</span></a> shows the generation performance <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.1">w.r.t.</span> flat and progressive retrieval.
From the results, we observe performance with progressive retrieval outperforms that with flat one in 13 out of 18 cases, indicating the superiority of supplementing LLMs with <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.2">FunnelRAG</span>. Specifically, when the cutoff position is small, progressive retrieval considerably outperforms flat one, such as the improvement of 16.87% and 9.35% on NQ dataset in terms of @1. When the cutoff position is high, progressive retrieval still outperforms flat one in half of cases, even if the AR of progressive one is slightly lower than flat one.
The reason is that passages retrieved by <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.3">FunnelRAG</span> have higher contextual integrity, refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS3" title="C.3 Contextual Integrity Analysis ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">C.3</span></a> for more details. Besides, we find Llama3-8B’s performance may deteriorate when provided with more passages, whereas Qwen2-7B does not. The main reason is the difference in the ability of them to handle long contexts.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="82" id="S4.F5.sf1.g1" src="extracted/5924118/figures/retrieval_granularity.png" width="189"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>AR <span class="ltx_text ltx_font_italic" id="S4.F5.sf1.2.1">w.r.t.</span> different granularity.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="83" id="S4.F5.sf2.g1" src="extracted/5924118/figures/rep_token_top4.png" width="189"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Impact of #rep tokens (in Top-4).</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="82" id="S4.F5.sf3.g1" src="extracted/5924118/figures/local_to_global_distill.png" width="196"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Effect of local-to-global distillation.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Model performance <span class="ltx_text ltx_font_italic" id="S4.F5.2.1">w.r.t.</span> (a) different granularity of clustered documents, (b) different number of representative tokens, and (c) L2G distillation. #Rep tokens is the abbr of “the number  of representative tokens”.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Study of <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.1.1">FunnelRAG</span> (RQ3)</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In this section, we move on to studying different settings in the proposed <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.1">FunnelRAG</span> framework:</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.4"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.4.1">(1) AR <span class="ltx_text ltx_font_italic" id="S4.SS4.p2.4.1.1">w.r.t.</span> different granularity:</span> As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.F5.sf1" title="In Figure 5 ‣ 4.3 Generation Performance (RQ2) ‣ 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">5(a)</span></a>, we experiment to evaluate the answer recall <span class="ltx_text ltx_font_italic" id="S4.SS4.p2.4.2">w.r.t.</span> different granularity of clustered documents, where we tune the max cluster size <math alttext="S" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_S</annotation></semantics></math> within the range of {1K, 2K, 4K, 8K}. It can be observed that setting <math alttext="S" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_S</annotation></semantics></math> as 8K does not bring much performance benefits compared to 4K. In contrast, setting <math alttext="S" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.1"><semantics id="S4.SS4.p2.3.m3.1a"><mi id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><ci id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.1d">italic_S</annotation></semantics></math> as a small value (<span class="ltx_text ltx_font_italic" id="S4.SS4.p2.4.3">e.g.,</span> 1K) considerably degrades the performance. In view of this, we set the max cluster  size <math alttext="S" class="ltx_Math" display="inline" id="S4.SS4.p2.4.m4.1"><semantics id="S4.SS4.p2.4.m4.1a"><mi id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><ci id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.4.m4.1d">italic_S</annotation></semantics></math> as 4K  tokens  in the  work.</p>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.2"><span class="ltx_text ltx_font_bold" id="S4.SS4.p3.2.1">(2) Impact of representative tokens:</span> As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.F5.sf2" title="In Figure 5 ‣ 4.3 Generation Performance (RQ2) ‣ 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">5(b)</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.F6" title="Figure 6 ‣ C.5 Case Study ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">6</span></a>, we experiment to investigate #rep tokens <math alttext="{lr}" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><mrow id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">l</mi><mo id="S4.SS4.p3.1.m1.1.1.1" xref="S4.SS4.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><times id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1.1"></times><ci id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">𝑙</ci><ci id="S4.SS4.p3.1.m1.1.1.3.cmml" xref="S4.SS4.p3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">{lr}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">italic_l italic_r</annotation></semantics></math>, where we search <math alttext="{lr}" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><mrow id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml"><mi id="S4.SS4.p3.2.m2.1.1.2" xref="S4.SS4.p3.2.m2.1.1.2.cmml">l</mi><mo id="S4.SS4.p3.2.m2.1.1.1" xref="S4.SS4.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS4.p3.2.m2.1.1.3" xref="S4.SS4.p3.2.m2.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1"><times id="S4.SS4.p3.2.m2.1.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1.1"></times><ci id="S4.SS4.p3.2.m2.1.1.2.cmml" xref="S4.SS4.p3.2.m2.1.1.2">𝑙</ci><ci id="S4.SS4.p3.2.m2.1.1.3.cmml" xref="S4.SS4.p3.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">{lr}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">italic_l italic_r</annotation></semantics></math> in the range of {2, 4, 8, 16, 24, 32}. We also aggregate FiD cross-attention scores across all tokens with/without query ones. We observe that the performance of aggregating rep tokens significantly outperforms that of aggregating all ones. On the other hand, it gets a peak value when selecting a few rep tokens, such as 4 in most cases. The results fully validate the necessity of selecting rep tokens.
More related details can be seen in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.SS2" title="C.2 Ablation of Query Tokens ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">C.2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.5"><span class="ltx_text ltx_font_bold" id="S4.SS4.p4.5.1">(3) Effect of local-to-global distillation:</span> As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.F5.sf3" title="In Figure 5 ‣ 4.3 Generation Performance (RQ2) ‣ 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">5(c)</span></a>, we experiment to explore the effect of local-to-global distillation, we tune <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.p4.1.m1.1"><semantics id="S4.SS4.p4.1.m1.1a"><mi id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b"><ci id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.1.m1.1d">italic_α</annotation></semantics></math> in the range of {0.25, 0.5, 0.75}. From the results, we observe that a higher value <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.p4.2.m2.1"><semantics id="S4.SS4.p4.2.m2.1a"><mi id="S4.SS4.p4.2.m2.1.1" xref="S4.SS4.p4.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.2.m2.1b"><ci id="S4.SS4.p4.2.m2.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.2.m2.1d">italic_α</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S4.SS4.p4.5.2">e.g.,</span> 0.75) usually leads to better performance and relatively high improvement on the top-ranked position (<span class="ltx_text ltx_font_italic" id="S4.SS4.p4.5.3">e.g.,</span> Top-1). The improvement is relatively trivial when <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.p4.3.m3.1"><semantics id="S4.SS4.p4.3.m3.1a"><mi id="S4.SS4.p4.3.m3.1.1" xref="S4.SS4.p4.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.3.m3.1b"><ci id="S4.SS4.p4.3.m3.1.1.cmml" xref="S4.SS4.p4.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.3.m3.1d">italic_α</annotation></semantics></math> is small (<span class="ltx_text ltx_font_italic" id="S4.SS4.p4.5.4">e.g.,</span> 0.25). When the cutoff position is large (<span class="ltx_text ltx_font_italic" id="S4.SS4.p4.5.5">e.g.,</span> Top-4), different values of <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.p4.4.m4.1"><semantics id="S4.SS4.p4.4.m4.1a"><mi id="S4.SS4.p4.4.m4.1.1" xref="S4.SS4.p4.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.4.m4.1b"><ci id="S4.SS4.p4.4.m4.1.1.cmml" xref="S4.SS4.p4.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.4.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.4.m4.1d">italic_α</annotation></semantics></math> bring similar performance improvements. In conclusion, we suggest tuning <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.p4.5.m5.1"><semantics id="S4.SS4.p4.5.m5.1a"><mi id="S4.SS4.p4.5.m5.1.1" xref="S4.SS4.p4.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.5.m5.1b"><ci id="S4.SS4.p4.5.m5.1.1.cmml" xref="S4.SS4.p4.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.5.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.5.m5.1d">italic_α</annotation></semantics></math> within the range of [0.5, 1.0).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Works</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Information Retrieval (IR).  </span> IR models contain two categories: (1) Sparse retrieval, which computes relevance scores via lexical similarity <cite class="ltx_cite ltx_citemacro_cite">Salton and Buckley (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib42" title="">1988</a>)</cite>; (2) Dense retrieval, which captures semantic similarity within dense space <cite class="ltx_cite ltx_citemacro_cite">Izacard et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib16" title="">2022</a>)</cite>. To further improve retrieval performance, the re-ranking module is proposed to re-estimate relevance scores using an extra model <cite class="ltx_cite ltx_citemacro_cite">Zhuang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib62" title="">2023</a>); Nogueira et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib35" title="">2020</a>); Hwang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib15" title="">2024</a>)</cite>.
Recently, LLMs have shown remarkable capability in re-ranking without further fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Liang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib30" title="">2023</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib48" title="">2023</a>); Pradeep et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib38" title="">2023</a>)</cite>.
Despite effectiveness, they have not fully disclosed coarse-to-fine granularity evolution.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Retrieval-Augmented Generation.  </span> Retrieving knowledge from external sources to supplement LLMs’ generation has been proven effective <cite class="ltx_cite ltx_citemacro_cite">Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib29" title="">2020</a>); Guu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib14" title="">2020</a>); Mialon et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib33" title="">2023</a>); Izacard et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib19" title="">2023</a>)</cite> in knowledge-intensive tasks <cite class="ltx_cite ltx_citemacro_cite">Petroni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib37" title="">2021</a>)</cite>. Specifically, RAG incorporates retrieval modules to provide external non-parametric knowledge into generation modules to remedy their incomplete, incorrect, or outdated internal parametric knowledge <cite class="ltx_cite ltx_citemacro_cite">Karpukhin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib25" title="">2020</a>); Min et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib34" title="">2019</a>)</cite>.
Previous works jointly train the retrieval and generation modules <cite class="ltx_cite ltx_citemacro_cite">Borgeaud et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib2" title="">2022</a>); Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib29" title="">2020</a>); Guu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib14" title="">2020</a>)</cite>. With the rise of LLMs <cite class="ltx_cite ltx_citemacro_cite">OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib36" title="">2023</a>)</cite>, most works directly serve them as generation modules without tuning due to their strong emergent abilities <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib57" title="">2024</a>); Jeong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib20" title="">2024</a>); Cheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib4" title="">2024</a>)</cite>.
Inspired by RAG’s strong practicality, a wide range of domains have developed specific RAG frameworks to perform their tasks, including computer vision <cite class="ltx_cite ltx_citemacro_cite">Xie et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib55" title="">2023</a>); Sharifymoghaddam et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib45" title="">2024</a>)</cite>, knowledge graph <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib60" title="">2022</a>); Edge et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib9" title="">2024</a>)</cite>, and speech <cite class="ltx_cite ltx_citemacro_cite">Xue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib58" title="">2024</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib51" title="">2024</a>)</cite>. Albeit studied for ages, the balance between the effectiveness and efficiency  of  retrievers  is  less  explored.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.3">In this paper, we propose a coarse-to-fine progressive retrieval paradigm for RAG, <span class="ltx_text ltx_font_smallcaps" id="S6.p1.3.1">FunnelRAG</span>, to enable load balancing and improve retrieval performance. The <span class="ltx_text ltx_font_smallcaps" id="S6.p1.3.2">FunnelRAG</span> framework efficiently retrieves useful passages by seamlessly collaborating different granularity (clustered document <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mo id="S6.p1.1.m1.1.1" stretchy="false" xref="S6.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">→</annotation></semantics></math> passage), quantity (21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.p1.2.m2.1"><semantics id="S6.p1.2.m2.1a"><mo id="S6.p1.2.m2.1.1" stretchy="false" xref="S6.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><ci id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S6.p1.2.m2.1d">→</annotation></semantics></math> 8d), and capacity (BM25 <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S6.p1.3.m3.1"><semantics id="S6.p1.3.m3.1a"><mo id="S6.p1.3.m3.1.1" stretchy="false" xref="S6.p1.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S6.p1.3.m3.1b"><ci id="S6.p1.3.m3.1.1.cmml" xref="S6.p1.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.3.m3.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S6.p1.3.m3.1d">→</annotation></semantics></math> FiD).
Applying our framework reduces time cost by nearly 40%, while the retrieval accuracy is comparable. In conclusion, our work sheds light on collaboration between complex and simple retrieval modules, and extensive experiments fully demonstrate  its feasibility  as  well  as  usefulness.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Limitations</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Despite our innovations and improvements, we must acknowledge certain limitations in our work:</p>
<ul class="ltx_itemize" id="Sx1.I1">
<li class="ltx_item" id="Sx1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i1.p1">
<p class="ltx_p" id="Sx1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I1.i1.p1.1.1">Heuristic Metric.</span> The answer recall (AR), which is the main retrieval metric adopted in the experiments, might overestimate the usefulness of the retrieved information because it mechanically measures whether the retrieved information contains the answer string, even if the retrieved information does not convey accurate semantics. Evaluating metrics for RAG remains an   open field that  still  needs  further  investigation.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i2.p1">
<p class="ltx_p" id="Sx1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I1.i2.p1.1.1">Hand-crafted Labor.</span> Although our method is able to balance effectiveness and efficiency well, some hand-crafted labors are required to fulfill this goal. Specifically, to enable load balancing and improve retrieval accuracy, some hyper-parameters needed to be tuned, such as the max cluster size <math alttext="S" class="ltx_Math" display="inline" id="Sx1.I1.i2.p1.1.m1.1"><semantics id="Sx1.I1.i2.p1.1.m1.1a"><mi id="Sx1.I1.i2.p1.1.m1.1.1" xref="Sx1.I1.i2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Sx1.I1.i2.p1.1.m1.1b"><ci id="Sx1.I1.i2.p1.1.m1.1.1.cmml" xref="Sx1.I1.i2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.I1.i2.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="Sx1.I1.i2.p1.1.m1.1d">italic_S</annotation></semantics></math>, and the data flow between each stage required to carefully collaborate, such as the quantity of the retrieved units  in each  stage.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i3.p1">
<p class="ltx_p" id="Sx1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I1.i3.p1.1.1">Compatibility Issue.</span> It is worth mentioning that <span class="ltx_text ltx_font_smallcaps" id="Sx1.I1.i3.p1.1.2">FunnelRAG</span> is a model-agnostic framework and can flexibly adapt to different retrievers. Therefore, the performance of <span class="ltx_text ltx_font_smallcaps" id="Sx1.I1.i3.p1.1.3">FunnelRAG</span> may be influenced by the characteristics of the retrievers. On the other hand, users can customize the retrievers to accommodate their specific scenarios. This work experiment on recently released retrievers and the results fully demonstrate  the  superiority  of  <span class="ltx_text ltx_font_smallcaps" id="Sx1.I1.i3.p1.1.4">FunnelRAG</span>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023)</span>
<span class="ltx_bibblock">
Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu Han, Fei Huang, Binyuan Hui, Luo Ji, Mei Li, Junyang Lin, Runji Lin, Dayiheng Liu, Gao Liu, Chengqiang Lu, Keming Lu, Jianxin Ma, Rui Men, Xingzhang Ren, Xuancheng Ren, Chuanqi Tan, Sinan Tan, Jianhong Tu, Peng Wang, Shijie Wang, Wei Wang, Shengguang Wu, Benfeng Xu, Jin Xu, An Yang, Hao Yang, Jian Yang, Shusheng Yang, Yang Yao, Bowen Yu, Hongyi Yuan, Zheng Yuan, Jianwei Zhang, Xingxuan Zhang, Yichang Zhang, Zhenru Zhang, Chang Zhou, Jingren Zhou, Xiaohuan Zhou, and Tianhang Zhu. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2309.16609" title="">Qwen technical report</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">CoRR</em>, abs/2309.16609.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borgeaud et al. (2022)</span>
<span class="ltx_bibblock">
Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza Rutherford, Katie Millican, George van den Driessche, Jean-Baptiste Lespiau, Bogdan Damoc, Aidan Clark, Diego de Las Casas, Aurelia Guy, Jacob Menick, Roman Ring, Tom Hennigan, Saffron Huang, Loren Maggiore, Chris Jones, Albin Cassirer, Andy Brock, Michela Paganini, Geoffrey Irving, Oriol Vinyals, Simon Osindero, Karen Simonyan, Jack W. Rae, Erich Elsen, and Laurent Sifre. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.mlr.press/v162/borgeaud22a.html" title="">Improving language models by retrieving from trillions of tokens</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of <em class="ltx_emph ltx_font_italic" id="bib.bib2.2.2">Proceedings of Machine Learning Research</em>, pages 2206–2240. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2024)</span>
<span class="ltx_bibblock">
Jianlv Chen, Shitao Xiao, Peitian Zhang, Kun Luo, Defu Lian, and Zheng Liu. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2402.03216" title="">BGE m3-embedding: Multi-lingual, multi-functionality, multi-granularity text embeddings through self-knowledge distillation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">CoRR</em>, abs/2402.03216.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2024)</span>
<span class="ltx_bibblock">
Xin Cheng, Xun Wang, Xingxing Zhang, Tao Ge, Si-Qing Chen, Furu Wei, Huishuai Zhang, and Dongyan Zhao. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2405.13792" title="">xrag: Extreme context compression for retrieval-augmented generation with one token</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">CoRR</em>, abs/2405.13792.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Covington et al. (2016)</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin. 2016.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/2959100.2959190" title="">Deep neural networks for youtube recommendations</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 10th ACM Conference on Recommender Systems, Boston, MA, USA, September 15-19, 2016</em>, pages 191–198. ACM.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2020)</span>
<span class="ltx_bibblock">
Zihang Dai, Guokun Lai, Yiming Yang, and Quoc Le. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper/2020/hash/2cd2915e69546904e4e5d4a2ac9e1652-Abstract.html" title="">Funnel-transformer: Filtering out sequential redundancy for efficient language processing</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2024)</span>
<span class="ltx_bibblock">
Boyi Deng, Wenjie Wang, Fengbin Zhu, Qifan Wang, and Fuli Feng. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2406.11497" title="">Cram: Credibility-aware attention modification in llms for combating misinformation in RAG</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">CoRR</em>, abs/2406.11497.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et al. (2024)</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, Anirudh Goyal, Anthony Hartshorn, Aobo Yang, Archi Mitra, Archie Sravankumar, Artem Korenev, Arthur Hinsvark, Arun Rao, Aston Zhang, Aurélien Rodriguez, Austen Gregerson, Ava Spataru, Baptiste Rozière, Bethany Biron, Binh Tang, Bobbie Chern, Charlotte Caucheteux, Chaya Nayak, Chloe Bi, Chris Marra, Chris McConnell, Christian Keller, Christophe Touret, Chunyang Wu, Corinne Wong, Cristian Canton Ferrer, Cyrus Nikolaidis, Damien Allonsius, Daniel Song, Danielle Pintz, Danny Livshits, David Esiobu, Dhruv Choudhary, Dhruv Mahajan, Diego Garcia-Olano, Diego Perino, Dieuwke Hupkes, Egor Lakomkin, Ehab AlBadawy, Elina Lobanova, Emily Dinan, Eric Michael Smith, Filip Radenovic, Frank Zhang, Gabriel Synnaeve, Gabrielle Lee, Georgia Lewis Anderson, Graeme Nail, Grégoire Mialon, Guan Pang, Guillem Cucurell, Hailey Nguyen, Hannah Korevaar, Hu Xu, Hugo
Touvron, Iliyan Zarov, Imanol Arrieta Ibarra, Isabel M. Kloumann, Ishan Misra, Ivan Evtimov, Jade Copet, Jaewon Lee, Jan Geffert, Jana Vranes, Jason Park, Jay Mahadeokar, Jeet Shah, Jelmer van der Linde, Jennifer Billock, Jenny Hong, Jenya Lee, Jeremy Fu, Jianfeng Chi, Jianyu Huang, Jiawen Liu, Jie Wang, Jiecao Yu, Joanna Bitton, Joe Spisak, Jongsoo Park, Joseph Rocca, Joshua Johnstun, Joshua Saxe, Junteng Jia, Kalyan Vasuden Alwala, Kartikeya Upasani, Kate Plawiak, Ke Li, Kenneth Heafield, Kevin Stone, and et al. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/pdf/2407.21783" title="">The llama 3 herd of models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">CoRR</em>, abs/2407.21783.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edge et al. (2024)</span>
<span class="ltx_bibblock">
Darren Edge, Ha Trinh, Newman Cheng, Joshua Bradley, Alex Chao, Apurva Mody, Steven Truitt, and Jonathan Larson. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2404.16130" title="">From local to global: A graph RAG approach to query-focused summarization</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">CoRR</em>, abs/2404.16130.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2022)</span>
<span class="ltx_bibblock">
Luyu Gao, Xueguang Ma, Jimmy Lin, and Jamie Callan. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2203.05765" title="">Tevatron: An efficient and flexible toolkit for dense retrieval</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">CoRR</em>, abs/2203.05765.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023)</span>
<span class="ltx_bibblock">
Yunfan Gao, Yun Xiong, Xinyu Gao, Kangxiang Jia, Jinliu Pan, Yuxi Bi, Yi Dai, Jiawei Sun, Qianyu Guo, Meng Wang, and Haofen Wang. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2312.10997" title="">Retrieval-augmented generation for large language models: A survey</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">CoRR</em>, abs/2312.10997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2020)</span>
<span class="ltx_bibblock">
Saurabh Goyal, Anamitra Roy Choudhury, Saurabh Raje, Venkatesan Chakaravarthy, Yogish Sabharwal, and Ashish Verma. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.mlr.press/v119/goyal20a/goyal20a.pdf" title="">Power-bert: Accelerating bert inference via progressive word-vector elimination</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">International Conference on Machine Learning</em>, pages 3690–3699. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grbovic and Cheng (2018)</span>
<span class="ltx_bibblock">
Mihajlo Grbovic and Haibin Cheng. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3219819.3219885" title="">Real-time personalization using embeddings for search ranking at airbnb</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, KDD 2018, London, UK, August 19-23, 2018</em>, pages 311–320. ACM.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guu et al. (2020)</span>
<span class="ltx_bibblock">
Kelvin Guu, Kenton Lee, Zora Tung, Panupong Pasupat, and Ming-Wei Chang. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2002.08909" title="">REALM: retrieval-augmented language model pre-training</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">CoRR</em>, abs/2002.08909.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hwang et al. (2024)</span>
<span class="ltx_bibblock">
Taeho Hwang, Soyeong Jeong, Sukmin Cho, Seungyoon Han, and Jong C. Park. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2407.03627" title="">DSLR: document refinement with sentence-level re-ranking and reconstruction to enhance retrieval-augmented generation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">CoRR</em>, abs/2407.03627.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard et al. (2022)</span>
<span class="ltx_bibblock">
Gautier Izacard, Mathilde Caron, Lucas Hosseini, Sebastian Riedel, Piotr Bojanowski, Armand Joulin, and Edouard Grave. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=jKN1pXi7b0" title="">Unsupervised dense information retrieval with contrastive learning</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Trans. Mach. Learn. Res.</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard and Grave (2021a)</span>
<span class="ltx_bibblock">
Gautier Izacard and Edouard Grave. 2021a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=NTEz-6wysdb" title="">Distilling knowledge from reader to retriever for question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard and Grave (2021b)</span>
<span class="ltx_bibblock">
Gautier Izacard and Edouard Grave. 2021b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2021.EACL-MAIN.74" title="">Leveraging passage retrieval with generative models for open domain question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 16th Conference of the European Chapter of the Association for Computational Linguistics: Main Volume, EACL 2021, Online, April 19 - 23, 2021</em>, pages 874–880. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard et al. (2023)</span>
<span class="ltx_bibblock">
Gautier Izacard, Patrick S. H. Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane Dwivedi-Yu, Armand Joulin, Sebastian Riedel, and Edouard Grave. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://jmlr.org/papers/v24/23-0037.html" title="">Atlas: Few-shot learning with retrieval augmented language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">J. Mach. Learn. Res.</em>, 24:251:1–251:43.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al. (2024)</span>
<span class="ltx_bibblock">
Soyeong Jeong, Jinheon Baek, Sukmin Cho, Sung Ju Hwang, and Jong Park. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2024.NAACL-LONG.389" title="">Adaptive-rag: Learning to adapt retrieval-augmented large language models through question complexity</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 2024 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies (Volume 1: Long Papers), NAACL 2024, Mexico City, Mexico, June 16-21, 2024</em>, pages 7036–7050. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2024)</span>
<span class="ltx_bibblock">
Ziyan Jiang, Xueguang Ma, and Wenhu Chen. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2406.15319" title="">Longrag: Enhancing retrieval-augmented generation with long-context llms</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">CoRR</em>, abs/2406.15319.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">JinaAI (2024)</span>
<span class="ltx_bibblock">
JinaAI. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://jina.ai/news/late-chunking-in-long-context-embedding-models/" title="">Late chunking in long-context embedding models</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et al. (2017)</span>
<span class="ltx_bibblock">
Mandar Joshi, Eunsol Choi, Daniel S. Weld, and Luke Zettlemoyer. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/P17-1147" title="">Triviaqa: A large scale distantly supervised challenge dataset for reading comprehension</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics, ACL 2017, Vancouver, Canada, July 30 - August 4, Volume 1: Long Papers</em>, pages 1601–1611. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kamradt (2023)</span>
<span class="ltx_bibblock">
Greg Kamradt. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://github.com/gkamradt/LLMTest_NeedleInAHaystack/tree/main" title="">Needle in a haystack - pressure testing llms</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpukhin et al. (2020)</span>
<span class="ltx_bibblock">
Vladimir Karpukhin, Barlas Oguz, Sewon Min, Patrick S. H. Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen-tau Yih. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2020.EMNLP-MAIN.550" title="">Dense passage retrieval for open-domain question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing, EMNLP 2020, Online, November 16-20, 2020</em>, pages 6769–6781. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et al. (2019)</span>
<span class="ltx_bibblock">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur P. Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, Kristina Toutanova, Llion Jones, Matthew Kelcey, Ming-Wei Chang, Andrew M. Dai, Jakob Uszkoreit, Quoc Le, and Slav Petrov. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1162/TACL_A_00276" title="">Natural questions: a benchmark for question answering research</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Trans. Assoc. Comput. Linguistics</em>, 7:452–466.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2024)</span>
<span class="ltx_bibblock">
Jinhyuk Lee, Anthony Chen, Zhuyun Dai, Dheeru Dua, Devendra Singh Sachan, Michael Boratko, Yi Luan, Sébastien M. R. Arnold, Vincent Perot, Siddharth Dalmia, Hexiang Hu, Xudong Lin, Panupong Pasupat, Aida Amini, Jeremy R. Cole, Sebastian Riedel, Iftekhar Naim, Ming-Wei Chang, and Kelvin Guu. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2406.13121" title="">Can long-context language models subsume retrieval, rag, sql, and more?</a>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">CoRR</em>, abs/2406.13121.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2019)</span>
<span class="ltx_bibblock">
Kenton Lee, Ming-Wei Chang, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/P19-1612" title="">Latent retrieval for weakly supervised open domain question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 57th Conference of the Association for Computational Linguistics, ACL 2019, Florence, Italy, July 28- August 2, 2019, Volume 1: Long Papers</em>, pages 6086–6096. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Patrick S. H. Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, Sebastian Riedel, and Douwe Kiela. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper/2020/hash/6b493230205f780e1bc26945df7481e5-Abstract.html" title="">Retrieval-augmented generation for knowledge-intensive NLP tasks</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2023)</span>
<span class="ltx_bibblock">
Percy Liang, Rishi Bommasani, Tony Lee, Dimitris Tsipras, Dilara Soylu, Michihiro Yasunaga, Yian Zhang, Deepak Narayanan, Yuhuai Wu, Ananya Kumar, Benjamin Newman, Binhang Yuan, Bobby Yan, Ce Zhang, Christian Cosgrove, Christopher D. Manning, Christopher Ré, Diana Acosta-Navas, Drew A. Hudson, Eric Zelikman, Esin Durmus, Faisal Ladhak, Frieda Rong, Hongyu Ren, Huaxiu Yao, Jue Wang, Keshav Santhanam, Laurel J. Orr, Lucia Zheng, Mert Yüksekgönül, Mirac Suzgun, Nathan Kim, Neel Guha, Niladri S. Chatterji, Omar Khattab, Peter Henderson, Qian Huang, Ryan Chi, Sang Michael Xie, Shibani Santurkar, Surya Ganguli, Tatsunori Hashimoto, Thomas Icard, Tianyi Zhang, Vishrav Chaudhary, William Wang, Xuechen Li, Yifan Mai, Yuhui Zhang, and Yuta Koreeda. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=iO4LZibEqW" title="">Holistic evaluation of language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Trans. Mach. Learn. Res.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2024)</span>
<span class="ltx_bibblock">
Xi Victoria Lin, Xilun Chen, Mingda Chen, Weijia Shi, Maria Lomeli, Richard James, Pedro Rodriguez, Jacob Kahn, Gergely Szilvasy, Mike Lewis, Luke Zettlemoyer, and Wen-tau Yih. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=22OTbutug9" title="">RA-DIT: retrieval-augmented dual instruction tuning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">The Twelfth International Conference on Learning Representations, ICLR 2024, Vienna, Austria, May 7-11, 2024</em>. OpenReview.net.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lù (2024)</span>
<span class="ltx_bibblock">
Xing Han Lù. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2407.03618" title="">Bm25s: Orders of magnitude faster lexical search via eager sparse scoring</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Preprint</em>, arXiv:2407.03618.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mialon et al. (2023)</span>
<span class="ltx_bibblock">
Grégoire Mialon, Roberto Dessì, Maria Lomeli, Christoforos Nalmpantis, Ramakanth Pasunuru, Roberta Raileanu, Baptiste Rozière, Timo Schick, Jane Dwivedi-Yu, Asli Celikyilmaz, Edouard Grave, Yann LeCun, and Thomas Scialom. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=jh7wH2AzKK" title="">Augmented language models: a survey</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Trans. Mach. Learn. Res.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et al. (2019)</span>
<span class="ltx_bibblock">
Sewon Min, Danqi Chen, Luke Zettlemoyer, and Hannaneh Hajishirzi. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/1911.03868" title="">Knowledge guided text retrieval and reading for open domain question answering</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">CoRR</em>, abs/1911.03868.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nogueira et al. (2020)</span>
<span class="ltx_bibblock">
Rodrigo Frassetto Nogueira, Zhiying Jiang, Ronak Pradeep, and Jimmy Lin. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2020.FINDINGS-EMNLP.63" title="">Document ranking with a pretrained sequence-to-sequence model</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Findings of the Association for Computational Linguistics: EMNLP 2020, Online Event, 16-20 November 2020</em>, volume EMNLP 2020 of <em class="ltx_emph ltx_font_italic" id="bib.bib35.2.2">Findings of ACL</em>, pages 708–718. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2303.08774" title="">GPT-4 technical report</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">CoRR</em>, abs/2303.08774.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petroni et al. (2021)</span>
<span class="ltx_bibblock">
Fabio Petroni, Aleksandra Piktus, Angela Fan, Patrick S. H. Lewis, Majid Yazdani, Nicola De Cao, James Thorne, Yacine Jernite, Vladimir Karpukhin, Jean Maillard, Vassilis Plachouras, Tim Rocktäschel, and Sebastian Riedel. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2021.NAACL-MAIN.200" title="">KILT: a benchmark for knowledge intensive language tasks</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, NAACL-HLT 2021, Online, June 6-11, 2021</em>, pages 2523–2544. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pradeep et al. (2023)</span>
<span class="ltx_bibblock">
Ronak Pradeep, Sahel Sharifymoghaddam, and Jimmy Lin. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2309.15088" title="">Rankvicuna: Zero-shot listwise document reranking with open-source large language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">CoRR</em>, abs/2309.15088.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://jmlr.org/papers/v21/20-074.html" title="">Exploring the limits of transfer learning with a unified text-to-text transformer</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">J. Mach. Learn. Res.</em>, 21:140:1–140:67.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al. (2009)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2009.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.auai.org/uai2009/papers/UAI2009_0139_48141db02b9f0b02bc7158819ebfa2c7.pdf" title="">BPR: bayesian personalized ranking from implicit feedback</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">UAI 2009, Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence, Montreal, QC, Canada, June 18-21, 2009</em>, pages 452–461. AUAI Press.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robertson and Zaragoza (2009)</span>
<span class="ltx_bibblock">
Stephen E. Robertson and Hugo Zaragoza. 2009.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1561/1500000019" title="">The probabilistic relevance framework: BM25 and beyond</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Found. Trends Inf. Retr.</em>, 3(4):333–389.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salton and Buckley (1988)</span>
<span class="ltx_bibblock">
Gerard Salton and Chris Buckley. 1988.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1016/0306-4573(88)90021-0" title="">Term-weighting approaches in automatic text retrieval</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Inf. Process. Manag.</em>, 24(5):513–523.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sawarkar et al. (2024)</span>
<span class="ltx_bibblock">
Kunal Sawarkar, Abhilasha Mangal, and Shivam Raj Solanki. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2404.07220" title="">Blended RAG: improving RAG (retriever-augmented generation) accuracy with semantic search and hybrid query-based retrievers</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">CoRR</em>, abs/2404.07220.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shannon (2001)</span>
<span class="ltx_bibblock">
Claude E. Shannon. 2001.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/584091.584093" title="">A mathematical theory of communication</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">ACM SIGMOBILE Mob. Comput. Commun. Rev.</em>, 5(1):3–55.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sharifymoghaddam et al. (2024)</span>
<span class="ltx_bibblock">
Sahel Sharifymoghaddam, Shivani Upadhyay, Wenhu Chen, and Jimmy Lin. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2405.10311" title="">Unirag: Universal retrieval augmentation for multi-modal large language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">CoRR</em>, abs/2405.10311.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2023)</span>
<span class="ltx_bibblock">
Weijia Shi, Sewon Min, Michihiro Yasunaga, Minjoon Seo, Rich James, Mike Lewis, Luke Zettlemoyer, and Wen-tau Yih. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2301.12652" title="">REPLUG: retrieval-augmented black-box language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">CoRR</em>, abs/2301.12652.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2024)</span>
<span class="ltx_bibblock">
Weijia Shi, Sewon Min, Michihiro Yasunaga, Minjoon Seo, Richard James, Mike Lewis, Luke Zettlemoyer, and Wen-tau Yih. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2024.NAACL-LONG.463" title="">REPLUG: retrieval-augmented black-box language models</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Proceedings of the 2024 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies (Volume 1: Long Papers), NAACL 2024, Mexico City, Mexico, June 16-21, 2024</em>, pages 8371–8384. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2023)</span>
<span class="ltx_bibblock">
Weiwei Sun, Lingyong Yan, Xinyu Ma, Shuaiqiang Wang, Pengjie Ren, Zhumin Chen, Dawei Yin, and Zhaochun Ren. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2023.EMNLP-MAIN.923" title="">Is chatgpt good at search? investigating large language models as re-ranking agents</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing, EMNLP 2023, Singapore, December 6-10, 2023</em>, pages 14918–14937. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton-Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa, Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurélien Rodriguez, Robert Stojnic, Sergey Edunov,
and Thomas Scialom. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2307.09288" title="">Llama 2: Open foundation and fine-tuned chat models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">CoRR</em>, abs/2307.09288.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://proceedings.neurips.cc/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" title="">Attention is all you need</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems 2017, December 4-9, 2017, Long Beach, CA, USA</em>, pages 5998–6008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Mingqiu Wang, Izhak Shafran, Hagen Soltau, Wei Han, Yuan Cao, Dian Yu, and Laurent El Shafey. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1109/ICASSP48485.2024.10447448" title="">Retrieval augmented end-to-end spoken dialog models</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">IEEE International Conference on Acoustics, Speech and Signal Processing, ICASSP 2024, Seoul, Republic of Korea, April 14-19, 2024</em>, pages 12056–12060. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Zhe Wang, Liqin Zhao, Biye Jiang, Guorui Zhou, Xiaoqiang Zhu, and Kun Gai. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2007.16122" title="">COLD: towards the next generation of pre-ranking system</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">CoRR</em>, abs/2007.16122.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf et al. (2020)</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest, and Alexander M. Rush. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2020.EMNLP-DEMOS.6" title="">Transformers: State-of-the-art natural language processing</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System Demonstrations, EMNLP 2020 - Demos, Online, November 16-20, 2020</em>, pages 38–45. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2023)</span>
<span class="ltx_bibblock">
Shitao Xiao, Zheng Liu, Peitian Zhang, and Niklas Muennighoff. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2309.07597" title="">C-pack: Packaged resources to advance general chinese embedding</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">CoRR</em>, abs/2309.07597.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2023)</span>
<span class="ltx_bibblock">
Chen-Wei Xie, Siyang Sun, Xiong Xiong, Yun Zheng, Deli Zhao, and Jingren Zhou. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1109/CVPR52729.2023.01846" title="">RA-CLIP: retrieval augmented contrastive language-image pre-training</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023</em>, pages 19265–19274. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2021)</span>
<span class="ltx_bibblock">
Lee Xiong, Chenyan Xiong, Ye Li, Kwok-Fung Tang, Jialin Liu, Paul N. Bennett, Junaid Ahmed, and Arnold Overwijk. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://openreview.net/forum?id=zeFrfgyZln" title="">Approximate nearest neighbor negative contrastive learning for dense text retrieval</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024)</span>
<span class="ltx_bibblock">
Zhipeng Xu, Zhenghao Liu, Yibin Liu, Chenyan Xiong, Yukun Yan, Shuo Wang, Shi Yu, Zhiyuan Liu, and Ge Yu. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2402.13547" title="">Activerag: Revealing the treasures of knowledge via active learning</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">CoRR</em>, abs/2402.13547.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et al. (2024)</span>
<span class="ltx_bibblock">
Jinlong Xue, Yayue Deng, Yingming Gao, and Ya Li. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/ARXIV.2406.03714" title="">Retrieval augmented generation in prompt-based text-to-speech synthesis with context-aware contrastive language-audio pretraining</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">CoRR</em>, abs/2406.03714.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2024)</span>
<span class="ltx_bibblock">
An Yang, Baosong Yang, Binyuan Hui, Bo Zheng, Bowen Yu, Chang Zhou, Chengpeng Li, Chengyuan Li, Dayiheng Liu, Fei Huang, Guanting Dong, Haoran Wei, Huan Lin, Jialong Tang, Jialin Wang, Jian Yang, Jianhong Tu, Jianwei Zhang, Jianxin Ma, Jin Xu, Jingren Zhou, Jinze Bai, Jinzheng He, Junyang Lin, Kai Dang, Keming Lu, Keqin Chen, Kexin Yang, Mei Li, Mingfeng Xue, Na Ni, Pei Zhang, Peng Wang, Ru Peng, Rui Men, Ruize Gao, Runji Lin, Shijie Wang, Shuai Bai, Sinan Tan, Tianhang Zhu, Tianhao Li, Tianyu Liu, Wenbin Ge, Xiaodong Deng, Xiaohuan Zhou, Xingzhang Ren, Xinyu Zhang, Xipin Wei, Xuancheng Ren, Yang Fan, Yang Yao, Yichang Zhang, Yu Wan, Yunfei Chu, Yuqiong Liu, Zeyu Cui, Zhenru Zhang, and Zhihao Fan. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2407.10671" title="">Qwen2 technical report</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">arXiv preprint arXiv:2407.10671</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022)</span>
<span class="ltx_bibblock">
Donghan Yu, Chenguang Zhu, Yuwei Fang, Wenhao Yu, Shuohang Wang, Yichong Xu, Xiang Ren, Yiming Yang, and Michael Zeng. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2022.ACL-LONG.340" title="">Kg-fid: Infusing knowledge graph in fusion-in-decoder for open-domain question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2022, Dublin, Ireland, May 22-27, 2022</em>, pages 4961–4974. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
<span class="ltx_bibblock">
Zichun Yu, Chenyan Xiong, Shi Yu, and Zhiyuan Liu. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/V1/2023.ACL-LONG.136" title="">Augmentation-adapted retriever improves generalization of language models as generic plug-in</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2023, Toronto, Canada, July 9-14, 2023</em>, pages 2421–2436. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al. (2023)</span>
<span class="ltx_bibblock">
Honglei Zhuang, Zhen Qin, Rolf Jagerman, Kai Hui, Ji Ma, Jing Lu, Jianmo Ni, Xuanhui Wang, and Michael Bendersky. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3539618.3592047" title="">Rankt5: Fine-tuning T5 for text ranking with ranking losses</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval, SIGIR 2023, Taipei, Taiwan, July 23-27, 2023</em>, pages 2308–2313. ACM.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>More Details Related to Methods</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Cross-Attention</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.6">Our model is built upon FiD <cite class="ltx_cite ltx_citemacro_cite">Izacard and Grave (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib18" title="">2021b</a>)</cite>, whose architecture is a sequence-to-sequence model that consists of an encoder and a decoder. The encoder encodes each query-passage pair separately. The output representations of the encoder are concatenated (Equ (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.E2" title="In 3.1.3 Post-ranking Stage ‣ 3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">2</span></a>)) along the sequence dimension to form a global representation <math alttext="\mathbf{H}=\|_{m=1}^{M}\mathbf{H}_{q,p_{m}^{f}}" class="ltx_math_unparsed" display="inline" id="A1.SS1.p1.1.m1.2"><semantics id="A1.SS1.p1.1.m1.2a"><mrow id="A1.SS1.p1.1.m1.2b"><mi id="A1.SS1.p1.1.m1.2.3">𝐇</mi><mo id="A1.SS1.p1.1.m1.2.4" rspace="0em">=</mo><msubsup id="A1.SS1.p1.1.m1.2.5"><mo id="A1.SS1.p1.1.m1.2.5.2.2" lspace="0em" rspace="0.167em">∥</mo><mrow id="A1.SS1.p1.1.m1.2.5.2.3"><mi id="A1.SS1.p1.1.m1.2.5.2.3.2">m</mi><mo id="A1.SS1.p1.1.m1.2.5.2.3.1">=</mo><mn id="A1.SS1.p1.1.m1.2.5.2.3.3">1</mn></mrow><mi id="A1.SS1.p1.1.m1.2.5.3">M</mi></msubsup><msub id="A1.SS1.p1.1.m1.2.6"><mi id="A1.SS1.p1.1.m1.2.6.2">𝐇</mi><mrow id="A1.SS1.p1.1.m1.2.2.2.2"><mi id="A1.SS1.p1.1.m1.1.1.1.1">q</mi><mo id="A1.SS1.p1.1.m1.2.2.2.2.2">,</mo><msubsup id="A1.SS1.p1.1.m1.2.2.2.2.1"><mi id="A1.SS1.p1.1.m1.2.2.2.2.1.2.2">p</mi><mi id="A1.SS1.p1.1.m1.2.2.2.2.1.2.3">m</mi><mi id="A1.SS1.p1.1.m1.2.2.2.2.1.3">f</mi></msubsup></mrow></msub></mrow><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.2c">\mathbf{H}=\|_{m=1}^{M}\mathbf{H}_{q,p_{m}^{f}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.2d">bold_H = ∥ start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT bold_H start_POSTSUBSCRIPT italic_q , italic_p start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.
Then, the decoder autoregressively attends this representation, which alternates self-attention, cross-attention, and feed-forward modules. In the decoder, only the cross-attention module explicitly takes the global representation <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><mi id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><ci id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">bold_H</annotation></semantics></math> of the encoder as the input. Let <span class="ltx_text ltx_markedasmath ltx_font_bold" id="A1.SS1.p1.6.1">X</span> denote the output of the previous self-attention layer of the decoder, the cross-attention operation consists of the following steps. First, three linear transformations are applied to produce queries <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A1.SS1.p1.4.m4.1"><semantics id="A1.SS1.p1.4.m4.1a"><mi id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><ci id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m4.1d">bold_Q</annotation></semantics></math>, keys <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A1.SS1.p1.5.m5.1"><semantics id="A1.SS1.p1.5.m5.1a"><mi id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.1b"><ci id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.5.m5.1d">bold_K</annotation></semantics></math>, and values <span class="ltx_text ltx_markedasmath ltx_font_bold" id="A1.SS1.p1.6.2">V</span>, which can be formulated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Q}=\mathbf{X}\mathbf{W}^{Q},\mathbf{K}=\mathbf{H}\mathbf{W}^{K},%
\mathbf{V}=\mathbf{H}\mathbf{W}^{V}." class="ltx_Math" display="block" id="A1.E7.m1.1"><semantics id="A1.E7.m1.1a"><mrow id="A1.E7.m1.1.1.1"><mrow id="A1.E7.m1.1.1.1.1.2" xref="A1.E7.m1.1.1.1.1.3.cmml"><mrow id="A1.E7.m1.1.1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.cmml"><mi id="A1.E7.m1.1.1.1.1.1.1.2" xref="A1.E7.m1.1.1.1.1.1.1.2.cmml">𝐐</mi><mo id="A1.E7.m1.1.1.1.1.1.1.1" xref="A1.E7.m1.1.1.1.1.1.1.1.cmml">=</mo><msup id="A1.E7.m1.1.1.1.1.1.1.3" xref="A1.E7.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.E7.m1.1.1.1.1.1.1.3.2" xref="A1.E7.m1.1.1.1.1.1.1.3.2.cmml">𝐗𝐖</mi><mi id="A1.E7.m1.1.1.1.1.1.1.3.3" xref="A1.E7.m1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo id="A1.E7.m1.1.1.1.1.2.3" xref="A1.E7.m1.1.1.1.1.3a.cmml">,</mo><mrow id="A1.E7.m1.1.1.1.1.2.2.2" xref="A1.E7.m1.1.1.1.1.2.2.3.cmml"><mrow id="A1.E7.m1.1.1.1.1.2.2.1.1" xref="A1.E7.m1.1.1.1.1.2.2.1.1.cmml"><mi id="A1.E7.m1.1.1.1.1.2.2.1.1.2" xref="A1.E7.m1.1.1.1.1.2.2.1.1.2.cmml">𝐊</mi><mo id="A1.E7.m1.1.1.1.1.2.2.1.1.1" xref="A1.E7.m1.1.1.1.1.2.2.1.1.1.cmml">=</mo><msup id="A1.E7.m1.1.1.1.1.2.2.1.1.3" xref="A1.E7.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="A1.E7.m1.1.1.1.1.2.2.1.1.3.2" xref="A1.E7.m1.1.1.1.1.2.2.1.1.3.2.cmml">𝐇𝐖</mi><mi id="A1.E7.m1.1.1.1.1.2.2.1.1.3.3" xref="A1.E7.m1.1.1.1.1.2.2.1.1.3.3.cmml">K</mi></msup></mrow><mo id="A1.E7.m1.1.1.1.1.2.2.2.3" xref="A1.E7.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="A1.E7.m1.1.1.1.1.2.2.2.2" xref="A1.E7.m1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.E7.m1.1.1.1.1.2.2.2.2.2" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2.cmml">𝐕</mi><mo id="A1.E7.m1.1.1.1.1.2.2.2.2.1" xref="A1.E7.m1.1.1.1.1.2.2.2.2.1.cmml">=</mo><msup id="A1.E7.m1.1.1.1.1.2.2.2.2.3" xref="A1.E7.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="A1.E7.m1.1.1.1.1.2.2.2.2.3.2" xref="A1.E7.m1.1.1.1.1.2.2.2.2.3.2.cmml">𝐇𝐖</mi><mi id="A1.E7.m1.1.1.1.1.2.2.2.2.3.3" xref="A1.E7.m1.1.1.1.1.2.2.2.2.3.3.cmml">V</mi></msup></mrow></mrow></mrow><mo id="A1.E7.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.1b"><apply id="A1.E7.m1.1.1.1.1.3.cmml" xref="A1.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.3a.cmml" xref="A1.E7.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E7.m1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1"><eq id="A1.E7.m1.1.1.1.1.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1.1"></eq><ci id="A1.E7.m1.1.1.1.1.1.1.2.cmml" xref="A1.E7.m1.1.1.1.1.1.1.2">𝐐</ci><apply id="A1.E7.m1.1.1.1.1.1.1.3.cmml" xref="A1.E7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E7.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E7.m1.1.1.1.1.1.1.3.2">𝐗𝐖</ci><ci id="A1.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E7.m1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="A1.E7.m1.1.1.1.1.2.2.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.2.2.3a.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.E7.m1.1.1.1.1.2.2.1.1.cmml" xref="A1.E7.m1.1.1.1.1.2.2.1.1"><eq id="A1.E7.m1.1.1.1.1.2.2.1.1.1.cmml" xref="A1.E7.m1.1.1.1.1.2.2.1.1.1"></eq><ci id="A1.E7.m1.1.1.1.1.2.2.1.1.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.1.1.2">𝐊</ci><apply id="A1.E7.m1.1.1.1.1.2.2.1.1.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="A1.E7.m1.1.1.1.1.2.2.1.1.3">superscript</csymbol><ci id="A1.E7.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.1.1.3.2">𝐇𝐖</ci><ci id="A1.E7.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.1.1.3.3">𝐾</ci></apply></apply><apply id="A1.E7.m1.1.1.1.1.2.2.2.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2"><eq id="A1.E7.m1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.1"></eq><ci id="A1.E7.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.2">𝐕</ci><apply id="A1.E7.m1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.E7.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="A1.E7.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.3.2">𝐇𝐖</ci><ci id="A1.E7.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A1.E7.m1.1.1.1.1.2.2.2.2.3.3">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.1c">\mathbf{Q}=\mathbf{X}\mathbf{W}^{Q},\mathbf{K}=\mathbf{H}\mathbf{W}^{K},%
\mathbf{V}=\mathbf{H}\mathbf{W}^{V}.</annotation><annotation encoding="application/x-llamapun" id="A1.E7.m1.1d">bold_Q = bold_XW start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , bold_K = bold_HW start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , bold_V = bold_HW start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.12">Then, the cross-attention scores are computed using the dot product between queries <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="A1.SS1.p1.7.m1.1"><semantics id="A1.SS1.p1.7.m1.1a"><mi id="A1.SS1.p1.7.m1.1.1" xref="A1.SS1.p1.7.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m1.1b"><ci id="A1.SS1.p1.7.m1.1.1.cmml" xref="A1.SS1.p1.7.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m1.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.7.m1.1d">bold_Q</annotation></semantics></math> and keys <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="A1.SS1.p1.8.m2.1"><semantics id="A1.SS1.p1.8.m2.1a"><mi id="A1.SS1.p1.8.m2.1.1" xref="A1.SS1.p1.8.m2.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.m2.1b"><ci id="A1.SS1.p1.8.m2.1.1.cmml" xref="A1.SS1.p1.8.m2.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m2.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.8.m2.1d">bold_K</annotation></semantics></math>. Taking the query at position <math alttext="i" class="ltx_Math" display="inline" id="A1.SS1.p1.9.m3.1"><semantics id="A1.SS1.p1.9.m3.1a"><mi id="A1.SS1.p1.9.m3.1.1" xref="A1.SS1.p1.9.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.m3.1b"><ci id="A1.SS1.p1.9.m3.1.1.cmml" xref="A1.SS1.p1.9.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.9.m3.1d">italic_i</annotation></semantics></math>, <math alttext="\mathbf{Q}_{i}" class="ltx_Math" display="inline" id="A1.SS1.p1.10.m4.1"><semantics id="A1.SS1.p1.10.m4.1a"><msub id="A1.SS1.p1.10.m4.1.1" xref="A1.SS1.p1.10.m4.1.1.cmml"><mi id="A1.SS1.p1.10.m4.1.1.2" xref="A1.SS1.p1.10.m4.1.1.2.cmml">𝐐</mi><mi id="A1.SS1.p1.10.m4.1.1.3" xref="A1.SS1.p1.10.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.10.m4.1b"><apply id="A1.SS1.p1.10.m4.1.1.cmml" xref="A1.SS1.p1.10.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.10.m4.1.1.1.cmml" xref="A1.SS1.p1.10.m4.1.1">subscript</csymbol><ci id="A1.SS1.p1.10.m4.1.1.2.cmml" xref="A1.SS1.p1.10.m4.1.1.2">𝐐</ci><ci id="A1.SS1.p1.10.m4.1.1.3.cmml" xref="A1.SS1.p1.10.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.10.m4.1c">\mathbf{Q}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.10.m4.1d">bold_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and the key at position <math alttext="j" class="ltx_Math" display="inline" id="A1.SS1.p1.11.m5.1"><semantics id="A1.SS1.p1.11.m5.1a"><mi id="A1.SS1.p1.11.m5.1.1" xref="A1.SS1.p1.11.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.11.m5.1b"><ci id="A1.SS1.p1.11.m5.1.1.cmml" xref="A1.SS1.p1.11.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.11.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.11.m5.1d">italic_j</annotation></semantics></math>, <math alttext="\mathbf{K}_{j}" class="ltx_Math" display="inline" id="A1.SS1.p1.12.m6.1"><semantics id="A1.SS1.p1.12.m6.1a"><msub id="A1.SS1.p1.12.m6.1.1" xref="A1.SS1.p1.12.m6.1.1.cmml"><mi id="A1.SS1.p1.12.m6.1.1.2" xref="A1.SS1.p1.12.m6.1.1.2.cmml">𝐊</mi><mi id="A1.SS1.p1.12.m6.1.1.3" xref="A1.SS1.p1.12.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.12.m6.1b"><apply id="A1.SS1.p1.12.m6.1.1.cmml" xref="A1.SS1.p1.12.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.12.m6.1.1.1.cmml" xref="A1.SS1.p1.12.m6.1.1">subscript</csymbol><ci id="A1.SS1.p1.12.m6.1.1.2.cmml" xref="A1.SS1.p1.12.m6.1.1.2">𝐊</ci><ci id="A1.SS1.p1.12.m6.1.1.3.cmml" xref="A1.SS1.p1.12.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.12.m6.1c">\mathbf{K}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.12.m6.1d">bold_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> for example, the cross-attention score and its normalized one can be  computed  as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha_{i,j}=\mathbf{Q}_{i}\mathbf{K}_{j},\quad\,\tilde{\alpha}_{i,j}=\frac{%
\exp(\alpha_{i,j})}{\sum_{k}\exp(\alpha_{i,k})}." class="ltx_Math" display="block" id="A1.E8.m1.13"><semantics id="A1.E8.m1.13a"><mrow id="A1.E8.m1.13.13.1"><mrow id="A1.E8.m1.13.13.1.1.2" xref="A1.E8.m1.13.13.1.1.3.cmml"><mrow id="A1.E8.m1.13.13.1.1.1.1" xref="A1.E8.m1.13.13.1.1.1.1.cmml"><msub id="A1.E8.m1.13.13.1.1.1.1.2" xref="A1.E8.m1.13.13.1.1.1.1.2.cmml"><mi id="A1.E8.m1.13.13.1.1.1.1.2.2" xref="A1.E8.m1.13.13.1.1.1.1.2.2.cmml">α</mi><mrow id="A1.E8.m1.2.2.2.4" xref="A1.E8.m1.2.2.2.3.cmml"><mi id="A1.E8.m1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.cmml">i</mi><mo id="A1.E8.m1.2.2.2.4.1" xref="A1.E8.m1.2.2.2.3.cmml">,</mo><mi id="A1.E8.m1.2.2.2.2" xref="A1.E8.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.E8.m1.13.13.1.1.1.1.1" xref="A1.E8.m1.13.13.1.1.1.1.1.cmml">=</mo><mrow id="A1.E8.m1.13.13.1.1.1.1.3" xref="A1.E8.m1.13.13.1.1.1.1.3.cmml"><msub id="A1.E8.m1.13.13.1.1.1.1.3.2" xref="A1.E8.m1.13.13.1.1.1.1.3.2.cmml"><mi id="A1.E8.m1.13.13.1.1.1.1.3.2.2" xref="A1.E8.m1.13.13.1.1.1.1.3.2.2.cmml">𝐐</mi><mi id="A1.E8.m1.13.13.1.1.1.1.3.2.3" xref="A1.E8.m1.13.13.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="A1.E8.m1.13.13.1.1.1.1.3.1" xref="A1.E8.m1.13.13.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.E8.m1.13.13.1.1.1.1.3.3" xref="A1.E8.m1.13.13.1.1.1.1.3.3.cmml"><mi id="A1.E8.m1.13.13.1.1.1.1.3.3.2" xref="A1.E8.m1.13.13.1.1.1.1.3.3.2.cmml">𝐊</mi><mi id="A1.E8.m1.13.13.1.1.1.1.3.3.3" xref="A1.E8.m1.13.13.1.1.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><mo id="A1.E8.m1.13.13.1.1.2.3" rspace="1.337em" xref="A1.E8.m1.13.13.1.1.3a.cmml">,</mo><mrow id="A1.E8.m1.13.13.1.1.2.2" xref="A1.E8.m1.13.13.1.1.2.2.cmml"><msub id="A1.E8.m1.13.13.1.1.2.2.2" xref="A1.E8.m1.13.13.1.1.2.2.2.cmml"><mover accent="true" id="A1.E8.m1.13.13.1.1.2.2.2.2" xref="A1.E8.m1.13.13.1.1.2.2.2.2.cmml"><mi id="A1.E8.m1.13.13.1.1.2.2.2.2.2" xref="A1.E8.m1.13.13.1.1.2.2.2.2.2.cmml">α</mi><mo id="A1.E8.m1.13.13.1.1.2.2.2.2.1" xref="A1.E8.m1.13.13.1.1.2.2.2.2.1.cmml">~</mo></mover><mrow id="A1.E8.m1.4.4.2.4" xref="A1.E8.m1.4.4.2.3.cmml"><mi id="A1.E8.m1.3.3.1.1" xref="A1.E8.m1.3.3.1.1.cmml">i</mi><mo id="A1.E8.m1.4.4.2.4.1" xref="A1.E8.m1.4.4.2.3.cmml">,</mo><mi id="A1.E8.m1.4.4.2.2" xref="A1.E8.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="A1.E8.m1.13.13.1.1.2.2.1" xref="A1.E8.m1.13.13.1.1.2.2.1.cmml">=</mo><mfrac id="A1.E8.m1.12.12" xref="A1.E8.m1.12.12.cmml"><mrow id="A1.E8.m1.8.8.4.4" xref="A1.E8.m1.8.8.4.5.cmml"><mi id="A1.E8.m1.7.7.3.3" xref="A1.E8.m1.7.7.3.3.cmml">exp</mi><mo id="A1.E8.m1.8.8.4.4a" xref="A1.E8.m1.8.8.4.5.cmml">⁡</mo><mrow id="A1.E8.m1.8.8.4.4.1" xref="A1.E8.m1.8.8.4.5.cmml"><mo id="A1.E8.m1.8.8.4.4.1.2" stretchy="false" xref="A1.E8.m1.8.8.4.5.cmml">(</mo><msub id="A1.E8.m1.8.8.4.4.1.1" xref="A1.E8.m1.8.8.4.4.1.1.cmml"><mi id="A1.E8.m1.8.8.4.4.1.1.2" xref="A1.E8.m1.8.8.4.4.1.1.2.cmml">α</mi><mrow id="A1.E8.m1.6.6.2.2.2.4" xref="A1.E8.m1.6.6.2.2.2.3.cmml"><mi id="A1.E8.m1.5.5.1.1.1.1" xref="A1.E8.m1.5.5.1.1.1.1.cmml">i</mi><mo id="A1.E8.m1.6.6.2.2.2.4.1" xref="A1.E8.m1.6.6.2.2.2.3.cmml">,</mo><mi id="A1.E8.m1.6.6.2.2.2.2" xref="A1.E8.m1.6.6.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.E8.m1.8.8.4.4.1.3" stretchy="false" xref="A1.E8.m1.8.8.4.5.cmml">)</mo></mrow></mrow><mrow id="A1.E8.m1.12.12.8" xref="A1.E8.m1.12.12.8.cmml"><msub id="A1.E8.m1.12.12.8.5" xref="A1.E8.m1.12.12.8.5.cmml"><mo id="A1.E8.m1.12.12.8.5.2" xref="A1.E8.m1.12.12.8.5.2.cmml">∑</mo><mi id="A1.E8.m1.12.12.8.5.3" xref="A1.E8.m1.12.12.8.5.3.cmml">k</mi></msub><mrow id="A1.E8.m1.12.12.8.4.1" xref="A1.E8.m1.12.12.8.4.2.cmml"><mi id="A1.E8.m1.11.11.7.3" xref="A1.E8.m1.11.11.7.3.cmml">exp</mi><mo id="A1.E8.m1.12.12.8.4.1a" xref="A1.E8.m1.12.12.8.4.2.cmml">⁡</mo><mrow id="A1.E8.m1.12.12.8.4.1.1" xref="A1.E8.m1.12.12.8.4.2.cmml"><mo id="A1.E8.m1.12.12.8.4.1.1.2" stretchy="false" xref="A1.E8.m1.12.12.8.4.2.cmml">(</mo><msub id="A1.E8.m1.12.12.8.4.1.1.1" xref="A1.E8.m1.12.12.8.4.1.1.1.cmml"><mi id="A1.E8.m1.12.12.8.4.1.1.1.2" xref="A1.E8.m1.12.12.8.4.1.1.1.2.cmml">α</mi><mrow id="A1.E8.m1.10.10.6.2.2.4" xref="A1.E8.m1.10.10.6.2.2.3.cmml"><mi id="A1.E8.m1.9.9.5.1.1.1" xref="A1.E8.m1.9.9.5.1.1.1.cmml">i</mi><mo id="A1.E8.m1.10.10.6.2.2.4.1" xref="A1.E8.m1.10.10.6.2.2.3.cmml">,</mo><mi id="A1.E8.m1.10.10.6.2.2.2" xref="A1.E8.m1.10.10.6.2.2.2.cmml">k</mi></mrow></msub><mo id="A1.E8.m1.12.12.8.4.1.1.3" stretchy="false" xref="A1.E8.m1.12.12.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><mo id="A1.E8.m1.13.13.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.13b"><apply id="A1.E8.m1.13.13.1.1.3.cmml" xref="A1.E8.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="A1.E8.m1.13.13.1.1.3a.cmml" xref="A1.E8.m1.13.13.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E8.m1.13.13.1.1.1.1.cmml" xref="A1.E8.m1.13.13.1.1.1.1"><eq id="A1.E8.m1.13.13.1.1.1.1.1.cmml" xref="A1.E8.m1.13.13.1.1.1.1.1"></eq><apply id="A1.E8.m1.13.13.1.1.1.1.2.cmml" xref="A1.E8.m1.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E8.m1.13.13.1.1.1.1.2.1.cmml" xref="A1.E8.m1.13.13.1.1.1.1.2">subscript</csymbol><ci id="A1.E8.m1.13.13.1.1.1.1.2.2.cmml" xref="A1.E8.m1.13.13.1.1.1.1.2.2">𝛼</ci><list id="A1.E8.m1.2.2.2.3.cmml" xref="A1.E8.m1.2.2.2.4"><ci id="A1.E8.m1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1">𝑖</ci><ci id="A1.E8.m1.2.2.2.2.cmml" xref="A1.E8.m1.2.2.2.2">𝑗</ci></list></apply><apply id="A1.E8.m1.13.13.1.1.1.1.3.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3"><times id="A1.E8.m1.13.13.1.1.1.1.3.1.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.1"></times><apply id="A1.E8.m1.13.13.1.1.1.1.3.2.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E8.m1.13.13.1.1.1.1.3.2.1.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E8.m1.13.13.1.1.1.1.3.2.2.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.2.2">𝐐</ci><ci id="A1.E8.m1.13.13.1.1.1.1.3.2.3.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="A1.E8.m1.13.13.1.1.1.1.3.3.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.13.13.1.1.1.1.3.3.1.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E8.m1.13.13.1.1.1.1.3.3.2.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.3.2">𝐊</ci><ci id="A1.E8.m1.13.13.1.1.1.1.3.3.3.cmml" xref="A1.E8.m1.13.13.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E8.m1.13.13.1.1.2.2.cmml" xref="A1.E8.m1.13.13.1.1.2.2"><eq id="A1.E8.m1.13.13.1.1.2.2.1.cmml" xref="A1.E8.m1.13.13.1.1.2.2.1"></eq><apply id="A1.E8.m1.13.13.1.1.2.2.2.cmml" xref="A1.E8.m1.13.13.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.13.13.1.1.2.2.2.1.cmml" xref="A1.E8.m1.13.13.1.1.2.2.2">subscript</csymbol><apply id="A1.E8.m1.13.13.1.1.2.2.2.2.cmml" xref="A1.E8.m1.13.13.1.1.2.2.2.2"><ci id="A1.E8.m1.13.13.1.1.2.2.2.2.1.cmml" xref="A1.E8.m1.13.13.1.1.2.2.2.2.1">~</ci><ci id="A1.E8.m1.13.13.1.1.2.2.2.2.2.cmml" xref="A1.E8.m1.13.13.1.1.2.2.2.2.2">𝛼</ci></apply><list id="A1.E8.m1.4.4.2.3.cmml" xref="A1.E8.m1.4.4.2.4"><ci id="A1.E8.m1.3.3.1.1.cmml" xref="A1.E8.m1.3.3.1.1">𝑖</ci><ci id="A1.E8.m1.4.4.2.2.cmml" xref="A1.E8.m1.4.4.2.2">𝑗</ci></list></apply><apply id="A1.E8.m1.12.12.cmml" xref="A1.E8.m1.12.12"><divide id="A1.E8.m1.12.12.9.cmml" xref="A1.E8.m1.12.12"></divide><apply id="A1.E8.m1.8.8.4.5.cmml" xref="A1.E8.m1.8.8.4.4"><exp id="A1.E8.m1.7.7.3.3.cmml" xref="A1.E8.m1.7.7.3.3"></exp><apply id="A1.E8.m1.8.8.4.4.1.1.cmml" xref="A1.E8.m1.8.8.4.4.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.8.8.4.4.1.1.1.cmml" xref="A1.E8.m1.8.8.4.4.1.1">subscript</csymbol><ci id="A1.E8.m1.8.8.4.4.1.1.2.cmml" xref="A1.E8.m1.8.8.4.4.1.1.2">𝛼</ci><list id="A1.E8.m1.6.6.2.2.2.3.cmml" xref="A1.E8.m1.6.6.2.2.2.4"><ci id="A1.E8.m1.5.5.1.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1">𝑖</ci><ci id="A1.E8.m1.6.6.2.2.2.2.cmml" xref="A1.E8.m1.6.6.2.2.2.2">𝑗</ci></list></apply></apply><apply id="A1.E8.m1.12.12.8.cmml" xref="A1.E8.m1.12.12.8"><apply id="A1.E8.m1.12.12.8.5.cmml" xref="A1.E8.m1.12.12.8.5"><csymbol cd="ambiguous" id="A1.E8.m1.12.12.8.5.1.cmml" xref="A1.E8.m1.12.12.8.5">subscript</csymbol><sum id="A1.E8.m1.12.12.8.5.2.cmml" xref="A1.E8.m1.12.12.8.5.2"></sum><ci id="A1.E8.m1.12.12.8.5.3.cmml" xref="A1.E8.m1.12.12.8.5.3">𝑘</ci></apply><apply id="A1.E8.m1.12.12.8.4.2.cmml" xref="A1.E8.m1.12.12.8.4.1"><exp id="A1.E8.m1.11.11.7.3.cmml" xref="A1.E8.m1.11.11.7.3"></exp><apply id="A1.E8.m1.12.12.8.4.1.1.1.cmml" xref="A1.E8.m1.12.12.8.4.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.12.12.8.4.1.1.1.1.cmml" xref="A1.E8.m1.12.12.8.4.1.1.1">subscript</csymbol><ci id="A1.E8.m1.12.12.8.4.1.1.1.2.cmml" xref="A1.E8.m1.12.12.8.4.1.1.1.2">𝛼</ci><list id="A1.E8.m1.10.10.6.2.2.3.cmml" xref="A1.E8.m1.10.10.6.2.2.4"><ci id="A1.E8.m1.9.9.5.1.1.1.cmml" xref="A1.E8.m1.9.9.5.1.1.1">𝑖</ci><ci id="A1.E8.m1.10.10.6.2.2.2.cmml" xref="A1.E8.m1.10.10.6.2.2.2">𝑘</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.13c">\alpha_{i,j}=\mathbf{Q}_{i}\mathbf{K}_{j},\quad\,\tilde{\alpha}_{i,j}=\frac{%
\exp(\alpha_{i,j})}{\sum_{k}\exp(\alpha_{i,k})}.</annotation><annotation encoding="application/x-llamapun" id="A1.E8.m1.13d">italic_α start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = bold_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = divide start_ARG roman_exp ( italic_α start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT roman_exp ( italic_α start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.13">A new representation is derived from a sum of the values, weighted by the normalized cross-attention scores, going through a final linear transformation:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{O}_{i}=\mathbf{W}_{O}\sum_{j}\tilde{\alpha}_{i,j}\mathbf{V}_{j}." class="ltx_Math" display="block" id="A1.E9.m1.3"><semantics id="A1.E9.m1.3a"><mrow id="A1.E9.m1.3.3.1" xref="A1.E9.m1.3.3.1.1.cmml"><mrow id="A1.E9.m1.3.3.1.1" xref="A1.E9.m1.3.3.1.1.cmml"><msub id="A1.E9.m1.3.3.1.1.2" xref="A1.E9.m1.3.3.1.1.2.cmml"><mi id="A1.E9.m1.3.3.1.1.2.2" xref="A1.E9.m1.3.3.1.1.2.2.cmml">𝐎</mi><mi id="A1.E9.m1.3.3.1.1.2.3" xref="A1.E9.m1.3.3.1.1.2.3.cmml">i</mi></msub><mo id="A1.E9.m1.3.3.1.1.1" xref="A1.E9.m1.3.3.1.1.1.cmml">=</mo><mrow id="A1.E9.m1.3.3.1.1.3" xref="A1.E9.m1.3.3.1.1.3.cmml"><msub id="A1.E9.m1.3.3.1.1.3.2" xref="A1.E9.m1.3.3.1.1.3.2.cmml"><mi id="A1.E9.m1.3.3.1.1.3.2.2" xref="A1.E9.m1.3.3.1.1.3.2.2.cmml">𝐖</mi><mi id="A1.E9.m1.3.3.1.1.3.2.3" xref="A1.E9.m1.3.3.1.1.3.2.3.cmml">O</mi></msub><mo id="A1.E9.m1.3.3.1.1.3.1" xref="A1.E9.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="A1.E9.m1.3.3.1.1.3.3" xref="A1.E9.m1.3.3.1.1.3.3.cmml"><munder id="A1.E9.m1.3.3.1.1.3.3.1" xref="A1.E9.m1.3.3.1.1.3.3.1.cmml"><mo id="A1.E9.m1.3.3.1.1.3.3.1.2" movablelimits="false" xref="A1.E9.m1.3.3.1.1.3.3.1.2.cmml">∑</mo><mi id="A1.E9.m1.3.3.1.1.3.3.1.3" xref="A1.E9.m1.3.3.1.1.3.3.1.3.cmml">j</mi></munder><mrow id="A1.E9.m1.3.3.1.1.3.3.2" xref="A1.E9.m1.3.3.1.1.3.3.2.cmml"><msub id="A1.E9.m1.3.3.1.1.3.3.2.2" xref="A1.E9.m1.3.3.1.1.3.3.2.2.cmml"><mover accent="true" id="A1.E9.m1.3.3.1.1.3.3.2.2.2" xref="A1.E9.m1.3.3.1.1.3.3.2.2.2.cmml"><mi id="A1.E9.m1.3.3.1.1.3.3.2.2.2.2" xref="A1.E9.m1.3.3.1.1.3.3.2.2.2.2.cmml">α</mi><mo id="A1.E9.m1.3.3.1.1.3.3.2.2.2.1" xref="A1.E9.m1.3.3.1.1.3.3.2.2.2.1.cmml">~</mo></mover><mrow id="A1.E9.m1.2.2.2.4" xref="A1.E9.m1.2.2.2.3.cmml"><mi id="A1.E9.m1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml">i</mi><mo id="A1.E9.m1.2.2.2.4.1" xref="A1.E9.m1.2.2.2.3.cmml">,</mo><mi id="A1.E9.m1.2.2.2.2" xref="A1.E9.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A1.E9.m1.3.3.1.1.3.3.2.1" xref="A1.E9.m1.3.3.1.1.3.3.2.1.cmml">⁢</mo><msub id="A1.E9.m1.3.3.1.1.3.3.2.3" xref="A1.E9.m1.3.3.1.1.3.3.2.3.cmml"><mi id="A1.E9.m1.3.3.1.1.3.3.2.3.2" xref="A1.E9.m1.3.3.1.1.3.3.2.3.2.cmml">𝐕</mi><mi id="A1.E9.m1.3.3.1.1.3.3.2.3.3" xref="A1.E9.m1.3.3.1.1.3.3.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow></mrow><mo id="A1.E9.m1.3.3.1.2" lspace="0em" xref="A1.E9.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.3b"><apply id="A1.E9.m1.3.3.1.1.cmml" xref="A1.E9.m1.3.3.1"><eq id="A1.E9.m1.3.3.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1"></eq><apply id="A1.E9.m1.3.3.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.2.1.cmml" xref="A1.E9.m1.3.3.1.1.2">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.2.2.cmml" xref="A1.E9.m1.3.3.1.1.2.2">𝐎</ci><ci id="A1.E9.m1.3.3.1.1.2.3.cmml" xref="A1.E9.m1.3.3.1.1.2.3">𝑖</ci></apply><apply id="A1.E9.m1.3.3.1.1.3.cmml" xref="A1.E9.m1.3.3.1.1.3"><times id="A1.E9.m1.3.3.1.1.3.1.cmml" xref="A1.E9.m1.3.3.1.1.3.1"></times><apply id="A1.E9.m1.3.3.1.1.3.2.cmml" xref="A1.E9.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.3.2.1.cmml" xref="A1.E9.m1.3.3.1.1.3.2">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.3.2.2.cmml" xref="A1.E9.m1.3.3.1.1.3.2.2">𝐖</ci><ci id="A1.E9.m1.3.3.1.1.3.2.3.cmml" xref="A1.E9.m1.3.3.1.1.3.2.3">𝑂</ci></apply><apply id="A1.E9.m1.3.3.1.1.3.3.cmml" xref="A1.E9.m1.3.3.1.1.3.3"><apply id="A1.E9.m1.3.3.1.1.3.3.1.cmml" xref="A1.E9.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.3.3.1.1.cmml" xref="A1.E9.m1.3.3.1.1.3.3.1">subscript</csymbol><sum id="A1.E9.m1.3.3.1.1.3.3.1.2.cmml" xref="A1.E9.m1.3.3.1.1.3.3.1.2"></sum><ci id="A1.E9.m1.3.3.1.1.3.3.1.3.cmml" xref="A1.E9.m1.3.3.1.1.3.3.1.3">𝑗</ci></apply><apply id="A1.E9.m1.3.3.1.1.3.3.2.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2"><times id="A1.E9.m1.3.3.1.1.3.3.2.1.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.1"></times><apply id="A1.E9.m1.3.3.1.1.3.3.2.2.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.3.3.2.2.1.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.2">subscript</csymbol><apply id="A1.E9.m1.3.3.1.1.3.3.2.2.2.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.2.2"><ci id="A1.E9.m1.3.3.1.1.3.3.2.2.2.1.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.2.2.1">~</ci><ci id="A1.E9.m1.3.3.1.1.3.3.2.2.2.2.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.2.2.2">𝛼</ci></apply><list id="A1.E9.m1.2.2.2.3.cmml" xref="A1.E9.m1.2.2.2.4"><ci id="A1.E9.m1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1">𝑖</ci><ci id="A1.E9.m1.2.2.2.2.cmml" xref="A1.E9.m1.2.2.2.2">𝑗</ci></list></apply><apply id="A1.E9.m1.3.3.1.1.3.3.2.3.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.3"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.3.3.2.3.1.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.3">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.3.3.2.3.2.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.3.2">𝐕</ci><ci id="A1.E9.m1.3.3.1.1.3.3.2.3.3.cmml" xref="A1.E9.m1.3.3.1.1.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.3c">\mathbf{O}_{i}=\mathbf{W}_{O}\sum_{j}\tilde{\alpha}_{i,j}\mathbf{V}_{j}.</annotation><annotation encoding="application/x-llamapun" id="A1.E9.m1.3d">bold_O start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT bold_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.14">We omit the layer and head indices for brevity in the above formula, refer to <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib50" title="">2017</a>)</cite> for more details on the structure  of  Transformers.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Representative Token Selection</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.6">Enlightened by the token redundancy in hidden states <cite class="ltx_cite ltx_citemacro_cite">Dai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib6" title="">2020</a>); Goyal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib12" title="">2020</a>)</cite>, we select several representative tokens per layer and head, to estimate the relative importance of each passage more accurately. Specifically, we select <math alttext="{lr}" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mrow id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">l</mi><mo id="A1.SS2.p1.1.m1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><times id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1"></times><ci id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2">𝑙</ci><ci id="A1.SS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">{lr}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">italic_l italic_r</annotation></semantics></math> tokens that have the highest cross-attention scores from the passage to represent it.
For the <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m2.1"><semantics id="A1.SS2.p1.2.m2.1a"><mi id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><ci id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m2.1d">italic_i</annotation></semantics></math>-th layer and <math alttext="j" class="ltx_Math" display="inline" id="A1.SS2.p1.3.m3.1"><semantics id="A1.SS2.p1.3.m3.1a"><mi id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><ci id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m3.1d">italic_j</annotation></semantics></math>-th head, we select the representative tokens according to their cross-attention scores and obtain an index list <math alttext="\mathbf{r}" class="ltx_Math" display="inline" id="A1.SS2.p1.4.m4.1"><semantics id="A1.SS2.p1.4.m4.1a"><mi id="A1.SS2.p1.4.m4.1.1" xref="A1.SS2.p1.4.m4.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m4.1b"><ci id="A1.SS2.p1.4.m4.1.1.cmml" xref="A1.SS2.p1.4.m4.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m4.1c">\mathbf{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.4.m4.1d">bold_r</annotation></semantics></math> that contains the index of <math alttext="{lr}" class="ltx_Math" display="inline" id="A1.SS2.p1.5.m5.1"><semantics id="A1.SS2.p1.5.m5.1a"><mrow id="A1.SS2.p1.5.m5.1.1" xref="A1.SS2.p1.5.m5.1.1.cmml"><mi id="A1.SS2.p1.5.m5.1.1.2" xref="A1.SS2.p1.5.m5.1.1.2.cmml">l</mi><mo id="A1.SS2.p1.5.m5.1.1.1" xref="A1.SS2.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="A1.SS2.p1.5.m5.1.1.3" xref="A1.SS2.p1.5.m5.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m5.1b"><apply id="A1.SS2.p1.5.m5.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1"><times id="A1.SS2.p1.5.m5.1.1.1.cmml" xref="A1.SS2.p1.5.m5.1.1.1"></times><ci id="A1.SS2.p1.5.m5.1.1.2.cmml" xref="A1.SS2.p1.5.m5.1.1.2">𝑙</ci><ci id="A1.SS2.p1.5.m5.1.1.3.cmml" xref="A1.SS2.p1.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m5.1c">{lr}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.5.m5.1d">italic_l italic_r</annotation></semantics></math> representative tokens. Then, we can average FiD cross-attention scores over representative tokens by looking  up  the  index  list  <math alttext="\mathbf{r}" class="ltx_Math" display="inline" id="A1.SS2.p1.6.m6.1"><semantics id="A1.SS2.p1.6.m6.1a"><mi id="A1.SS2.p1.6.m6.1.1" xref="A1.SS2.p1.6.m6.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.6.m6.1b"><ci id="A1.SS2.p1.6.m6.1.1.cmml" xref="A1.SS2.p1.6.m6.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.6.m6.1c">\mathbf{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.6.m6.1d">bold_r</annotation></semantics></math>, referring  to  Equ (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.E3" title="In 3.1.3 Post-ranking Stage ‣ 3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>More Details Related to Experiments</h2>
<figure class="ltx_table" id="A2.T4">
<table class="ltx_tabular ltx_align_middle" id="A2.T4.1">
<tr class="ltx_tr" id="A2.T4.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A2.T4.1.1.1" style="padding:1.25pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="A2.T4.1.1.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T4.1.1.2" style="padding:1.25pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="A2.T4.1.1.2.1">#Train</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T4.1.1.3" style="padding:1.25pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="A2.T4.1.1.3.1">#Dev</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T4.1.1.4" style="padding:1.25pt 5.3pt;"><span class="ltx_text ltx_font_bold" id="A2.T4.1.1.4.1">#Test</span></td>
</tr>
<tr class="ltx_tr" id="A2.T4.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T4.1.2.1" style="padding:1.25pt 5.3pt;">NQ <cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib26" title="">2019</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T4.1.2.2" style="padding:1.25pt 5.3pt;">79.1k</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T4.1.2.3" style="padding:1.25pt 5.3pt;">8.7k</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T4.1.2.4" style="padding:1.25pt 5.3pt;">3.6k</td>
</tr>
<tr class="ltx_tr" id="A2.T4.1.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T4.1.3.1" style="padding:1.25pt 5.3pt;">TQA <cite class="ltx_cite ltx_citemacro_cite">Joshi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib23" title="">2017</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T4.1.3.2" style="padding:1.25pt 5.3pt;">78.7k</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T4.1.3.3" style="padding:1.25pt 5.3pt;">8.8k</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T4.1.3.4" style="padding:1.25pt 5.3pt;">11.3k</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Statistics of the datasets.</figcaption>
</figure>
<figure class="ltx_table" id="A2.T5"><svg class="ltx_picture" height="176.94" id="A2.T5.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,176.94) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 171.04 C 0 174.3 2.64 176.94 5.91 176.94 L 594.09 176.94 C 597.36 176.94 600 174.3 600 171.04 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 171.04 C 1.97 173.21 3.73 174.98 5.91 174.98 L 594.09 174.98 C 596.27 174.98 598.03 173.21 598.03 171.04 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g color="#404040" fill="#404040" stroke="#404040" stroke-dasharray="2.84528pt,2.84528pt" stroke-dashoffset="1.42264pt" stroke-opacity="1.0"><path d="M 1.97 139.05 L 598.03 139.05" style="fill:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 150.86)"><foreignobject color="#000000" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.T5.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A2.T5.pic1.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A2.T5.pic1.1.1.1.1.1.1.1">Retrieval-Augmented Question Answering Prompt</span></span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="113.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A2.T5.pic1.2.2.2.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A2.T5.pic1.2.2.2.1.1.1"><span class="ltx_text ltx_font_bold" id="A2.T5.pic1.2.2.2.1.1.1.1">[Instruction]
<br class="ltx_break"/></span>Given the [‘context’, ‘question’], answer the question based on the context.</span>
<span class="ltx_p" id="A2.T5.pic1.2.2.2.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.T5.pic1.2.2.2.1.1.2.1">[Completion]
<br class="ltx_break"/></span>[context]: Nobel Prize in Physics The Nobel Prize in Physics () is a yearly award given by the Royal Swedish Academy of Sciences ……</span>
<span class="ltx_p" id="A2.T5.pic1.2.2.2.1.1.3">[question]: Who got the first nobel prize in physics?</span>
<span class="ltx_p" id="A2.T5.pic1.2.2.2.1.1.4">[answer]:</span>
</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>The prompt for retrieval-augmented QA. For intuition, we select a real example from the NQ dataset.</figcaption>
</figure>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Datasets</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">We experiment on NQ <cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib26" title="">2019</a>)</cite> and TQA <cite class="ltx_cite ltx_citemacro_cite">Joshi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib23" title="">2017</a>)</cite> datasets. Following <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib28" title="">2019</a>)</cite>, we discard answers with more than 5 tokens, as answers with many tokens often resemble extractive snippets instead of canonical ones. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.T4" title="Table 4 ‣ Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">4</span></a> shows the  statistics  of  the  datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>LLMs for QA</h3>
<div class="ltx_para" id="A2.SS2.p1">
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i1.p1.1.1">Llama3-8B-Instruct<span class="ltx_note ltx_role_footnote" id="footnote12"><sup class="ltx_note_mark">12</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">12</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote12.1.1.1">12</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://github.com/meta-llama/llama3" title="">https://github.com/meta-llama/llama3</a></span></span></span></span> is the developed version of Llama2 <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib49" title="">2023</a>)</cite>. Compared to Llama2, its training data volume has increased by seven times, showing higher reasoning and multilingual capabilities. For question answering, we use the Llama3-8B-Instruct, which is specifically optimized  for  the  instruction-following  ability.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i2.p1.1.1">Qwen2-7B-Instruct<span class="ltx_note ltx_role_footnote" id="footnote13"><sup class="ltx_note_mark">13</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">13</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote13.1.1.1">13</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://github.com/QwenLM/Qwen2" title="">https://github.com/QwenLM/Qwen2</a></span></span></span></span> is the developed version of Qwen <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib1" title="">2023</a>)</cite>. Except for Chinese and English, its training data has also added high-quality data related to 27 languages and it achieves significant improvement in code and math capabilities. We also use the instruction-following version for the same reason aforesaid.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Prompts</h3>
<div class="ltx_para" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">We provide the prompt that is used for retrieval-augmented question answering  (§<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.SS3" title="4.3 Generation Performance (RQ2) ‣ 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">4.3</span></a>) in  Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.T5" title="Table 5 ‣ Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Hardware and Software Configurations</h3>
<div class="ltx_para ltx_noindent" id="A2.SS4.p1">
<p class="ltx_p" id="A2.SS4.p1.1"><span class="ltx_text ltx_font_bold" id="A2.SS4.p1.1.1">Hardware Configurations.  </span> The experiments are conducted on a Linux server equipped with an AMD EPYC 7742 64-Core Processor, 1000GB RAM, and  2 NVIDIA A100-SXM4-40GB  GPUs.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS4.p2">
<p class="ltx_p" id="A2.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="A2.SS4.p2.1.1">Software Configurations.  </span> We run retrieval and generation experiments on the above hardware. We conduct experiments with the FlagEmbedding<span class="ltx_note ltx_role_footnote" id="footnote14"><sup class="ltx_note_mark">14</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">14</sup><span class="ltx_tag ltx_tag_note">14</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/FlagOpen/FlagEmbedding" title="">https://github.com/FlagOpen/FlagEmbedding</a></span></span></span> and huggingface transformers toolkit <cite class="ltx_cite ltx_citemacro_cite">Wolf et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib53" title="">2020</a>)</cite>.
For dense retrieval, we leverage the open-source retrieval toolkit Tevatron <cite class="ltx_cite ltx_citemacro_cite">Gao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib10" title="">2022</a>)</cite>. On the other hand, we adopt BM25S <cite class="ltx_cite ltx_citemacro_cite">Lù (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib32" title="">2024</a>)</cite> for sparse retrieval. Besides, we adopt T5-large<span class="ltx_note ltx_role_footnote" id="footnote15"><sup class="ltx_note_mark">15</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">15</sup><span class="ltx_tag ltx_tag_note">15</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/google-t5/t5-large" title="">https://huggingface.co/google-t5/t5-large</a></span></span></span> as the backbone of FiD (§<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS1.SSS3" title="3.1.3 Post-ranking Stage ‣ 3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3.1.3</span></a>). The detailed setting of the software environment is provided in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.T6" title="Table 6 ‣ B.4 Hardware and Software Configurations ‣ Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure class="ltx_table" id="A2.T6">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A2.T6.1">
<tr class="ltx_tr" id="A2.T6.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T6.1.1.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A2.T6.1.1.1.1">Configuration</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T6.1.1.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A2.T6.1.1.2.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A2.T6.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.1.2.1" style="padding:1.25pt 3.6pt;">Tevatron</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T6.1.2.2" style="padding:1.25pt 3.6pt;">V2</td>
</tr>
<tr class="ltx_tr" id="A2.T6.1.3">
<td class="ltx_td ltx_align_center" id="A2.T6.1.3.1" style="padding:1.25pt 3.6pt;">bm25s</td>
<td class="ltx_td ltx_align_center" id="A2.T6.1.3.2" style="padding:1.25pt 3.6pt;">0.1.10</td>
</tr>
<tr class="ltx_tr" id="A2.T6.1.4">
<td class="ltx_td ltx_align_center" id="A2.T6.1.4.1" style="padding:1.25pt 3.6pt;">faiss-cpu</td>
<td class="ltx_td ltx_align_center" id="A2.T6.1.4.2" style="padding:1.25pt 3.6pt;">1.8.0.post1</td>
</tr>
<tr class="ltx_tr" id="A2.T6.1.5">
<td class="ltx_td ltx_align_center" id="A2.T6.1.5.1" style="padding:1.25pt 3.6pt;">FlagEmbedding</td>
<td class="ltx_td ltx_align_center" id="A2.T6.1.5.2" style="padding:1.25pt 3.6pt;">1.2.11</td>
</tr>
<tr class="ltx_tr" id="A2.T6.1.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T6.1.6.1" style="padding:1.25pt 3.6pt;">transformers</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T6.1.6.2" style="padding:1.25pt 3.6pt;">4.44.2</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Detailed settings of the software environment.</figcaption>
</figure>
<figure class="ltx_table" id="A2.T7">
<table class="ltx_tabular ltx_align_middle" id="A2.T7.5">
<tr class="ltx_tr" id="A2.T7.5.6">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.5.6.1" rowspan="2" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.5.6.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="5" id="A2.T7.5.6.2" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.5.6.2.1">NQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" colspan="5" id="A2.T7.5.6.3" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.5.6.3.1">TQA</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.5.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="A2.T7.5.7.1" style="padding:1.25pt 5.0pt;">@1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.5.7.2" style="padding:1.25pt 5.0pt;">@2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.5.7.3" style="padding:1.25pt 5.0pt;">@3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.5.7.4" style="padding:1.25pt 5.0pt;">@4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.5.7.5" style="padding:1.25pt 5.0pt;">Avg</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="A2.T7.5.7.6" style="padding:1.25pt 5.0pt;">@1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.5.7.7" style="padding:1.25pt 5.0pt;">@2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.5.7.8" style="padding:1.25pt 5.0pt;">@3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.5.7.9" style="padding:1.25pt 5.0pt;">@4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.5.7.10" style="padding:1.25pt 5.0pt;">Avg</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A2.T7.1.1.1" style="padding:1.25pt 5.0pt;">(i) <math alttext="\text{mean}_{i,j,k}\alpha_{0,i,j,\mathbf{r}[k]}" class="ltx_Math" display="inline" id="A2.T7.1.1.1.m1.8"><semantics id="A2.T7.1.1.1.m1.8a"><mrow id="A2.T7.1.1.1.m1.8.9" xref="A2.T7.1.1.1.m1.8.9.cmml"><msub id="A2.T7.1.1.1.m1.8.9.2" xref="A2.T7.1.1.1.m1.8.9.2.cmml"><mtext id="A2.T7.1.1.1.m1.8.9.2.2" xref="A2.T7.1.1.1.m1.8.9.2.2a.cmml">mean</mtext><mrow id="A2.T7.1.1.1.m1.3.3.3.5" xref="A2.T7.1.1.1.m1.3.3.3.4.cmml"><mi id="A2.T7.1.1.1.m1.1.1.1.1" xref="A2.T7.1.1.1.m1.1.1.1.1.cmml">i</mi><mo id="A2.T7.1.1.1.m1.3.3.3.5.1" xref="A2.T7.1.1.1.m1.3.3.3.4.cmml">,</mo><mi id="A2.T7.1.1.1.m1.2.2.2.2" xref="A2.T7.1.1.1.m1.2.2.2.2.cmml">j</mi><mo id="A2.T7.1.1.1.m1.3.3.3.5.2" xref="A2.T7.1.1.1.m1.3.3.3.4.cmml">,</mo><mi id="A2.T7.1.1.1.m1.3.3.3.3" xref="A2.T7.1.1.1.m1.3.3.3.3.cmml">k</mi></mrow></msub><mo id="A2.T7.1.1.1.m1.8.9.1" xref="A2.T7.1.1.1.m1.8.9.1.cmml">⁢</mo><msub id="A2.T7.1.1.1.m1.8.9.3" xref="A2.T7.1.1.1.m1.8.9.3.cmml"><mi id="A2.T7.1.1.1.m1.8.9.3.2" xref="A2.T7.1.1.1.m1.8.9.3.2.cmml">α</mi><mrow id="A2.T7.1.1.1.m1.8.8.5.5" xref="A2.T7.1.1.1.m1.8.8.5.6.cmml"><mn id="A2.T7.1.1.1.m1.5.5.2.2" xref="A2.T7.1.1.1.m1.5.5.2.2.cmml">0</mn><mo id="A2.T7.1.1.1.m1.8.8.5.5.2" xref="A2.T7.1.1.1.m1.8.8.5.6.cmml">,</mo><mi id="A2.T7.1.1.1.m1.6.6.3.3" xref="A2.T7.1.1.1.m1.6.6.3.3.cmml">i</mi><mo id="A2.T7.1.1.1.m1.8.8.5.5.3" xref="A2.T7.1.1.1.m1.8.8.5.6.cmml">,</mo><mi id="A2.T7.1.1.1.m1.7.7.4.4" xref="A2.T7.1.1.1.m1.7.7.4.4.cmml">j</mi><mo id="A2.T7.1.1.1.m1.8.8.5.5.4" xref="A2.T7.1.1.1.m1.8.8.5.6.cmml">,</mo><mrow id="A2.T7.1.1.1.m1.8.8.5.5.1" xref="A2.T7.1.1.1.m1.8.8.5.5.1.cmml"><mi id="A2.T7.1.1.1.m1.8.8.5.5.1.2" xref="A2.T7.1.1.1.m1.8.8.5.5.1.2.cmml">𝐫</mi><mo id="A2.T7.1.1.1.m1.8.8.5.5.1.1" xref="A2.T7.1.1.1.m1.8.8.5.5.1.1.cmml">⁢</mo><mrow id="A2.T7.1.1.1.m1.8.8.5.5.1.3.2" xref="A2.T7.1.1.1.m1.8.8.5.5.1.3.1.cmml"><mo id="A2.T7.1.1.1.m1.8.8.5.5.1.3.2.1" stretchy="false" xref="A2.T7.1.1.1.m1.8.8.5.5.1.3.1.1.cmml">[</mo><mi id="A2.T7.1.1.1.m1.4.4.1.1" xref="A2.T7.1.1.1.m1.4.4.1.1.cmml">k</mi><mo id="A2.T7.1.1.1.m1.8.8.5.5.1.3.2.2" stretchy="false" xref="A2.T7.1.1.1.m1.8.8.5.5.1.3.1.1.cmml">]</mo></mrow></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.T7.1.1.1.m1.8b"><apply id="A2.T7.1.1.1.m1.8.9.cmml" xref="A2.T7.1.1.1.m1.8.9"><times id="A2.T7.1.1.1.m1.8.9.1.cmml" xref="A2.T7.1.1.1.m1.8.9.1"></times><apply id="A2.T7.1.1.1.m1.8.9.2.cmml" xref="A2.T7.1.1.1.m1.8.9.2"><csymbol cd="ambiguous" id="A2.T7.1.1.1.m1.8.9.2.1.cmml" xref="A2.T7.1.1.1.m1.8.9.2">subscript</csymbol><ci id="A2.T7.1.1.1.m1.8.9.2.2a.cmml" xref="A2.T7.1.1.1.m1.8.9.2.2"><mtext id="A2.T7.1.1.1.m1.8.9.2.2.cmml" xref="A2.T7.1.1.1.m1.8.9.2.2">mean</mtext></ci><list id="A2.T7.1.1.1.m1.3.3.3.4.cmml" xref="A2.T7.1.1.1.m1.3.3.3.5"><ci id="A2.T7.1.1.1.m1.1.1.1.1.cmml" xref="A2.T7.1.1.1.m1.1.1.1.1">𝑖</ci><ci id="A2.T7.1.1.1.m1.2.2.2.2.cmml" xref="A2.T7.1.1.1.m1.2.2.2.2">𝑗</ci><ci id="A2.T7.1.1.1.m1.3.3.3.3.cmml" xref="A2.T7.1.1.1.m1.3.3.3.3">𝑘</ci></list></apply><apply id="A2.T7.1.1.1.m1.8.9.3.cmml" xref="A2.T7.1.1.1.m1.8.9.3"><csymbol cd="ambiguous" id="A2.T7.1.1.1.m1.8.9.3.1.cmml" xref="A2.T7.1.1.1.m1.8.9.3">subscript</csymbol><ci id="A2.T7.1.1.1.m1.8.9.3.2.cmml" xref="A2.T7.1.1.1.m1.8.9.3.2">𝛼</ci><list id="A2.T7.1.1.1.m1.8.8.5.6.cmml" xref="A2.T7.1.1.1.m1.8.8.5.5"><cn id="A2.T7.1.1.1.m1.5.5.2.2.cmml" type="integer" xref="A2.T7.1.1.1.m1.5.5.2.2">0</cn><ci id="A2.T7.1.1.1.m1.6.6.3.3.cmml" xref="A2.T7.1.1.1.m1.6.6.3.3">𝑖</ci><ci id="A2.T7.1.1.1.m1.7.7.4.4.cmml" xref="A2.T7.1.1.1.m1.7.7.4.4">𝑗</ci><apply id="A2.T7.1.1.1.m1.8.8.5.5.1.cmml" xref="A2.T7.1.1.1.m1.8.8.5.5.1"><times id="A2.T7.1.1.1.m1.8.8.5.5.1.1.cmml" xref="A2.T7.1.1.1.m1.8.8.5.5.1.1"></times><ci id="A2.T7.1.1.1.m1.8.8.5.5.1.2.cmml" xref="A2.T7.1.1.1.m1.8.8.5.5.1.2">𝐫</ci><apply id="A2.T7.1.1.1.m1.8.8.5.5.1.3.1.cmml" xref="A2.T7.1.1.1.m1.8.8.5.5.1.3.2"><csymbol cd="latexml" id="A2.T7.1.1.1.m1.8.8.5.5.1.3.1.1.cmml" xref="A2.T7.1.1.1.m1.8.8.5.5.1.3.2.1">delimited-[]</csymbol><ci id="A2.T7.1.1.1.m1.4.4.1.1.cmml" xref="A2.T7.1.1.1.m1.4.4.1.1">𝑘</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.1.1.1.m1.8c">\text{mean}_{i,j,k}\alpha_{0,i,j,\mathbf{r}[k]}</annotation><annotation encoding="application/x-llamapun" id="A2.T7.1.1.1.m1.8d">mean start_POSTSUBSCRIPT italic_i , italic_j , italic_k end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT 0 , italic_i , italic_j , bold_r [ italic_k ] end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" id="A2.T7.1.1.2" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.2.1">63.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.1.1.3" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.3.1">71.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.1.1.4" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.4.1">73.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.1.1.5" style="padding:1.25pt 5.0pt;">75.43</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.1.1.6" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.6.1">71.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" id="A2.T7.1.1.7" style="padding:1.25pt 5.0pt;">74.57</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.1.1.8" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.8.1">78.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.1.1.9" style="padding:1.25pt 5.0pt;">79.83</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.1.1.10" style="padding:1.25pt 5.0pt;">80.69</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T7.1.1.11" style="padding:1.25pt 5.0pt;">78.35</td>
</tr>
<tr class="ltx_tr" id="A2.T7.2.2">
<td class="ltx_td ltx_align_left" id="A2.T7.2.2.1" style="padding:1.25pt 5.0pt;">(ii) <math alttext="\text{mean}_{j,k}\text{max}_{i}\alpha_{0,i,j,k}" class="ltx_Math" display="inline" id="A2.T7.2.2.1.m1.6"><semantics id="A2.T7.2.2.1.m1.6a"><mrow id="A2.T7.2.2.1.m1.6.7" xref="A2.T7.2.2.1.m1.6.7.cmml"><msub id="A2.T7.2.2.1.m1.6.7.2" xref="A2.T7.2.2.1.m1.6.7.2.cmml"><mtext id="A2.T7.2.2.1.m1.6.7.2.2" xref="A2.T7.2.2.1.m1.6.7.2.2a.cmml">mean</mtext><mrow id="A2.T7.2.2.1.m1.2.2.2.4" xref="A2.T7.2.2.1.m1.2.2.2.3.cmml"><mi id="A2.T7.2.2.1.m1.1.1.1.1" xref="A2.T7.2.2.1.m1.1.1.1.1.cmml">j</mi><mo id="A2.T7.2.2.1.m1.2.2.2.4.1" xref="A2.T7.2.2.1.m1.2.2.2.3.cmml">,</mo><mi id="A2.T7.2.2.1.m1.2.2.2.2" xref="A2.T7.2.2.1.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="A2.T7.2.2.1.m1.6.7.1" xref="A2.T7.2.2.1.m1.6.7.1.cmml">⁢</mo><msub id="A2.T7.2.2.1.m1.6.7.3" xref="A2.T7.2.2.1.m1.6.7.3.cmml"><mtext id="A2.T7.2.2.1.m1.6.7.3.2" xref="A2.T7.2.2.1.m1.6.7.3.2a.cmml">max</mtext><mi id="A2.T7.2.2.1.m1.6.7.3.3" xref="A2.T7.2.2.1.m1.6.7.3.3.cmml">i</mi></msub><mo id="A2.T7.2.2.1.m1.6.7.1a" xref="A2.T7.2.2.1.m1.6.7.1.cmml">⁢</mo><msub id="A2.T7.2.2.1.m1.6.7.4" xref="A2.T7.2.2.1.m1.6.7.4.cmml"><mi id="A2.T7.2.2.1.m1.6.7.4.2" xref="A2.T7.2.2.1.m1.6.7.4.2.cmml">α</mi><mrow id="A2.T7.2.2.1.m1.6.6.4.6" xref="A2.T7.2.2.1.m1.6.6.4.5.cmml"><mn id="A2.T7.2.2.1.m1.3.3.1.1" xref="A2.T7.2.2.1.m1.3.3.1.1.cmml">0</mn><mo id="A2.T7.2.2.1.m1.6.6.4.6.1" xref="A2.T7.2.2.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.2.2.1.m1.4.4.2.2" xref="A2.T7.2.2.1.m1.4.4.2.2.cmml">i</mi><mo id="A2.T7.2.2.1.m1.6.6.4.6.2" xref="A2.T7.2.2.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.2.2.1.m1.5.5.3.3" xref="A2.T7.2.2.1.m1.5.5.3.3.cmml">j</mi><mo id="A2.T7.2.2.1.m1.6.6.4.6.3" xref="A2.T7.2.2.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.2.2.1.m1.6.6.4.4" xref="A2.T7.2.2.1.m1.6.6.4.4.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.T7.2.2.1.m1.6b"><apply id="A2.T7.2.2.1.m1.6.7.cmml" xref="A2.T7.2.2.1.m1.6.7"><times id="A2.T7.2.2.1.m1.6.7.1.cmml" xref="A2.T7.2.2.1.m1.6.7.1"></times><apply id="A2.T7.2.2.1.m1.6.7.2.cmml" xref="A2.T7.2.2.1.m1.6.7.2"><csymbol cd="ambiguous" id="A2.T7.2.2.1.m1.6.7.2.1.cmml" xref="A2.T7.2.2.1.m1.6.7.2">subscript</csymbol><ci id="A2.T7.2.2.1.m1.6.7.2.2a.cmml" xref="A2.T7.2.2.1.m1.6.7.2.2"><mtext id="A2.T7.2.2.1.m1.6.7.2.2.cmml" xref="A2.T7.2.2.1.m1.6.7.2.2">mean</mtext></ci><list id="A2.T7.2.2.1.m1.2.2.2.3.cmml" xref="A2.T7.2.2.1.m1.2.2.2.4"><ci id="A2.T7.2.2.1.m1.1.1.1.1.cmml" xref="A2.T7.2.2.1.m1.1.1.1.1">𝑗</ci><ci id="A2.T7.2.2.1.m1.2.2.2.2.cmml" xref="A2.T7.2.2.1.m1.2.2.2.2">𝑘</ci></list></apply><apply id="A2.T7.2.2.1.m1.6.7.3.cmml" xref="A2.T7.2.2.1.m1.6.7.3"><csymbol cd="ambiguous" id="A2.T7.2.2.1.m1.6.7.3.1.cmml" xref="A2.T7.2.2.1.m1.6.7.3">subscript</csymbol><ci id="A2.T7.2.2.1.m1.6.7.3.2a.cmml" xref="A2.T7.2.2.1.m1.6.7.3.2"><mtext id="A2.T7.2.2.1.m1.6.7.3.2.cmml" xref="A2.T7.2.2.1.m1.6.7.3.2">max</mtext></ci><ci id="A2.T7.2.2.1.m1.6.7.3.3.cmml" xref="A2.T7.2.2.1.m1.6.7.3.3">𝑖</ci></apply><apply id="A2.T7.2.2.1.m1.6.7.4.cmml" xref="A2.T7.2.2.1.m1.6.7.4"><csymbol cd="ambiguous" id="A2.T7.2.2.1.m1.6.7.4.1.cmml" xref="A2.T7.2.2.1.m1.6.7.4">subscript</csymbol><ci id="A2.T7.2.2.1.m1.6.7.4.2.cmml" xref="A2.T7.2.2.1.m1.6.7.4.2">𝛼</ci><list id="A2.T7.2.2.1.m1.6.6.4.5.cmml" xref="A2.T7.2.2.1.m1.6.6.4.6"><cn id="A2.T7.2.2.1.m1.3.3.1.1.cmml" type="integer" xref="A2.T7.2.2.1.m1.3.3.1.1">0</cn><ci id="A2.T7.2.2.1.m1.4.4.2.2.cmml" xref="A2.T7.2.2.1.m1.4.4.2.2">𝑖</ci><ci id="A2.T7.2.2.1.m1.5.5.3.3.cmml" xref="A2.T7.2.2.1.m1.5.5.3.3">𝑗</ci><ci id="A2.T7.2.2.1.m1.6.6.4.4.cmml" xref="A2.T7.2.2.1.m1.6.6.4.4">𝑘</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.2.2.1.m1.6c">\text{mean}_{j,k}\text{max}_{i}\alpha_{0,i,j,k}</annotation><annotation encoding="application/x-llamapun" id="A2.T7.2.2.1.m1.6d">mean start_POSTSUBSCRIPT italic_j , italic_k end_POSTSUBSCRIPT max start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT 0 , italic_i , italic_j , italic_k end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T7.2.2.2" style="padding:1.25pt 5.0pt;">57.06</td>
<td class="ltx_td ltx_align_center" id="A2.T7.2.2.3" style="padding:1.25pt 5.0pt;">68.01</td>
<td class="ltx_td ltx_align_center" id="A2.T7.2.2.4" style="padding:1.25pt 5.0pt;">71.91</td>
<td class="ltx_td ltx_align_center" id="A2.T7.2.2.5" style="padding:1.25pt 5.0pt;">73.85</td>
<td class="ltx_td ltx_align_center" id="A2.T7.2.2.6" style="padding:1.25pt 5.0pt;">67.71</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T7.2.2.7" style="padding:1.25pt 5.0pt;">66.98</td>
<td class="ltx_td ltx_align_center" id="A2.T7.2.2.8" style="padding:1.25pt 5.0pt;">75.44</td>
<td class="ltx_td ltx_align_center" id="A2.T7.2.2.9" style="padding:1.25pt 5.0pt;">78.02</td>
<td class="ltx_td ltx_align_center" id="A2.T7.2.2.10" style="padding:1.25pt 5.0pt;">79.56</td>
<td class="ltx_td ltx_align_center" id="A2.T7.2.2.11" style="padding:1.25pt 5.0pt;">75.00</td>
</tr>
<tr class="ltx_tr" id="A2.T7.3.3">
<td class="ltx_td ltx_align_left" id="A2.T7.3.3.1" style="padding:1.25pt 5.0pt;">(iii) <math alttext="\text{mean}_{i,k}\text{max}_{j}\alpha_{0,i,j,k}" class="ltx_Math" display="inline" id="A2.T7.3.3.1.m1.6"><semantics id="A2.T7.3.3.1.m1.6a"><mrow id="A2.T7.3.3.1.m1.6.7" xref="A2.T7.3.3.1.m1.6.7.cmml"><msub id="A2.T7.3.3.1.m1.6.7.2" xref="A2.T7.3.3.1.m1.6.7.2.cmml"><mtext id="A2.T7.3.3.1.m1.6.7.2.2" xref="A2.T7.3.3.1.m1.6.7.2.2a.cmml">mean</mtext><mrow id="A2.T7.3.3.1.m1.2.2.2.4" xref="A2.T7.3.3.1.m1.2.2.2.3.cmml"><mi id="A2.T7.3.3.1.m1.1.1.1.1" xref="A2.T7.3.3.1.m1.1.1.1.1.cmml">i</mi><mo id="A2.T7.3.3.1.m1.2.2.2.4.1" xref="A2.T7.3.3.1.m1.2.2.2.3.cmml">,</mo><mi id="A2.T7.3.3.1.m1.2.2.2.2" xref="A2.T7.3.3.1.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="A2.T7.3.3.1.m1.6.7.1" xref="A2.T7.3.3.1.m1.6.7.1.cmml">⁢</mo><msub id="A2.T7.3.3.1.m1.6.7.3" xref="A2.T7.3.3.1.m1.6.7.3.cmml"><mtext id="A2.T7.3.3.1.m1.6.7.3.2" xref="A2.T7.3.3.1.m1.6.7.3.2a.cmml">max</mtext><mi id="A2.T7.3.3.1.m1.6.7.3.3" xref="A2.T7.3.3.1.m1.6.7.3.3.cmml">j</mi></msub><mo id="A2.T7.3.3.1.m1.6.7.1a" xref="A2.T7.3.3.1.m1.6.7.1.cmml">⁢</mo><msub id="A2.T7.3.3.1.m1.6.7.4" xref="A2.T7.3.3.1.m1.6.7.4.cmml"><mi id="A2.T7.3.3.1.m1.6.7.4.2" xref="A2.T7.3.3.1.m1.6.7.4.2.cmml">α</mi><mrow id="A2.T7.3.3.1.m1.6.6.4.6" xref="A2.T7.3.3.1.m1.6.6.4.5.cmml"><mn id="A2.T7.3.3.1.m1.3.3.1.1" xref="A2.T7.3.3.1.m1.3.3.1.1.cmml">0</mn><mo id="A2.T7.3.3.1.m1.6.6.4.6.1" xref="A2.T7.3.3.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.3.3.1.m1.4.4.2.2" xref="A2.T7.3.3.1.m1.4.4.2.2.cmml">i</mi><mo id="A2.T7.3.3.1.m1.6.6.4.6.2" xref="A2.T7.3.3.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.3.3.1.m1.5.5.3.3" xref="A2.T7.3.3.1.m1.5.5.3.3.cmml">j</mi><mo id="A2.T7.3.3.1.m1.6.6.4.6.3" xref="A2.T7.3.3.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.3.3.1.m1.6.6.4.4" xref="A2.T7.3.3.1.m1.6.6.4.4.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.T7.3.3.1.m1.6b"><apply id="A2.T7.3.3.1.m1.6.7.cmml" xref="A2.T7.3.3.1.m1.6.7"><times id="A2.T7.3.3.1.m1.6.7.1.cmml" xref="A2.T7.3.3.1.m1.6.7.1"></times><apply id="A2.T7.3.3.1.m1.6.7.2.cmml" xref="A2.T7.3.3.1.m1.6.7.2"><csymbol cd="ambiguous" id="A2.T7.3.3.1.m1.6.7.2.1.cmml" xref="A2.T7.3.3.1.m1.6.7.2">subscript</csymbol><ci id="A2.T7.3.3.1.m1.6.7.2.2a.cmml" xref="A2.T7.3.3.1.m1.6.7.2.2"><mtext id="A2.T7.3.3.1.m1.6.7.2.2.cmml" xref="A2.T7.3.3.1.m1.6.7.2.2">mean</mtext></ci><list id="A2.T7.3.3.1.m1.2.2.2.3.cmml" xref="A2.T7.3.3.1.m1.2.2.2.4"><ci id="A2.T7.3.3.1.m1.1.1.1.1.cmml" xref="A2.T7.3.3.1.m1.1.1.1.1">𝑖</ci><ci id="A2.T7.3.3.1.m1.2.2.2.2.cmml" xref="A2.T7.3.3.1.m1.2.2.2.2">𝑘</ci></list></apply><apply id="A2.T7.3.3.1.m1.6.7.3.cmml" xref="A2.T7.3.3.1.m1.6.7.3"><csymbol cd="ambiguous" id="A2.T7.3.3.1.m1.6.7.3.1.cmml" xref="A2.T7.3.3.1.m1.6.7.3">subscript</csymbol><ci id="A2.T7.3.3.1.m1.6.7.3.2a.cmml" xref="A2.T7.3.3.1.m1.6.7.3.2"><mtext id="A2.T7.3.3.1.m1.6.7.3.2.cmml" xref="A2.T7.3.3.1.m1.6.7.3.2">max</mtext></ci><ci id="A2.T7.3.3.1.m1.6.7.3.3.cmml" xref="A2.T7.3.3.1.m1.6.7.3.3">𝑗</ci></apply><apply id="A2.T7.3.3.1.m1.6.7.4.cmml" xref="A2.T7.3.3.1.m1.6.7.4"><csymbol cd="ambiguous" id="A2.T7.3.3.1.m1.6.7.4.1.cmml" xref="A2.T7.3.3.1.m1.6.7.4">subscript</csymbol><ci id="A2.T7.3.3.1.m1.6.7.4.2.cmml" xref="A2.T7.3.3.1.m1.6.7.4.2">𝛼</ci><list id="A2.T7.3.3.1.m1.6.6.4.5.cmml" xref="A2.T7.3.3.1.m1.6.6.4.6"><cn id="A2.T7.3.3.1.m1.3.3.1.1.cmml" type="integer" xref="A2.T7.3.3.1.m1.3.3.1.1">0</cn><ci id="A2.T7.3.3.1.m1.4.4.2.2.cmml" xref="A2.T7.3.3.1.m1.4.4.2.2">𝑖</ci><ci id="A2.T7.3.3.1.m1.5.5.3.3.cmml" xref="A2.T7.3.3.1.m1.5.5.3.3">𝑗</ci><ci id="A2.T7.3.3.1.m1.6.6.4.4.cmml" xref="A2.T7.3.3.1.m1.6.6.4.4">𝑘</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.3.3.1.m1.6c">\text{mean}_{i,k}\text{max}_{j}\alpha_{0,i,j,k}</annotation><annotation encoding="application/x-llamapun" id="A2.T7.3.3.1.m1.6d">mean start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT max start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT 0 , italic_i , italic_j , italic_k end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T7.3.3.2" style="padding:1.25pt 5.0pt;">57.65</td>
<td class="ltx_td ltx_align_center" id="A2.T7.3.3.3" style="padding:1.25pt 5.0pt;">68.14</td>
<td class="ltx_td ltx_align_center" id="A2.T7.3.3.4" style="padding:1.25pt 5.0pt;">71.86</td>
<td class="ltx_td ltx_align_center" id="A2.T7.3.3.5" style="padding:1.25pt 5.0pt;">73.77</td>
<td class="ltx_td ltx_align_center" id="A2.T7.3.3.6" style="padding:1.25pt 5.0pt;">67.86</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T7.3.3.7" style="padding:1.25pt 5.0pt;">68.32</td>
<td class="ltx_td ltx_align_center" id="A2.T7.3.3.8" style="padding:1.25pt 5.0pt;">75.70</td>
<td class="ltx_td ltx_align_center" id="A2.T7.3.3.9" style="padding:1.25pt 5.0pt;">78.12</td>
<td class="ltx_td ltx_align_center" id="A2.T7.3.3.10" style="padding:1.25pt 5.0pt;">79.47</td>
<td class="ltx_td ltx_align_center" id="A2.T7.3.3.11" style="padding:1.25pt 5.0pt;">75.40</td>
</tr>
<tr class="ltx_tr" id="A2.T7.4.4">
<td class="ltx_td ltx_align_left" id="A2.T7.4.4.1" style="padding:1.25pt 5.0pt;">(iv) <math alttext="\text{mean}_{i,j}\text{max}_{k}\alpha_{0,i,j,k}" class="ltx_Math" display="inline" id="A2.T7.4.4.1.m1.6"><semantics id="A2.T7.4.4.1.m1.6a"><mrow id="A2.T7.4.4.1.m1.6.7" xref="A2.T7.4.4.1.m1.6.7.cmml"><msub id="A2.T7.4.4.1.m1.6.7.2" xref="A2.T7.4.4.1.m1.6.7.2.cmml"><mtext id="A2.T7.4.4.1.m1.6.7.2.2" xref="A2.T7.4.4.1.m1.6.7.2.2a.cmml">mean</mtext><mrow id="A2.T7.4.4.1.m1.2.2.2.4" xref="A2.T7.4.4.1.m1.2.2.2.3.cmml"><mi id="A2.T7.4.4.1.m1.1.1.1.1" xref="A2.T7.4.4.1.m1.1.1.1.1.cmml">i</mi><mo id="A2.T7.4.4.1.m1.2.2.2.4.1" xref="A2.T7.4.4.1.m1.2.2.2.3.cmml">,</mo><mi id="A2.T7.4.4.1.m1.2.2.2.2" xref="A2.T7.4.4.1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="A2.T7.4.4.1.m1.6.7.1" xref="A2.T7.4.4.1.m1.6.7.1.cmml">⁢</mo><msub id="A2.T7.4.4.1.m1.6.7.3" xref="A2.T7.4.4.1.m1.6.7.3.cmml"><mtext id="A2.T7.4.4.1.m1.6.7.3.2" xref="A2.T7.4.4.1.m1.6.7.3.2a.cmml">max</mtext><mi id="A2.T7.4.4.1.m1.6.7.3.3" xref="A2.T7.4.4.1.m1.6.7.3.3.cmml">k</mi></msub><mo id="A2.T7.4.4.1.m1.6.7.1a" xref="A2.T7.4.4.1.m1.6.7.1.cmml">⁢</mo><msub id="A2.T7.4.4.1.m1.6.7.4" xref="A2.T7.4.4.1.m1.6.7.4.cmml"><mi id="A2.T7.4.4.1.m1.6.7.4.2" xref="A2.T7.4.4.1.m1.6.7.4.2.cmml">α</mi><mrow id="A2.T7.4.4.1.m1.6.6.4.6" xref="A2.T7.4.4.1.m1.6.6.4.5.cmml"><mn id="A2.T7.4.4.1.m1.3.3.1.1" xref="A2.T7.4.4.1.m1.3.3.1.1.cmml">0</mn><mo id="A2.T7.4.4.1.m1.6.6.4.6.1" xref="A2.T7.4.4.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.4.4.1.m1.4.4.2.2" xref="A2.T7.4.4.1.m1.4.4.2.2.cmml">i</mi><mo id="A2.T7.4.4.1.m1.6.6.4.6.2" xref="A2.T7.4.4.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.4.4.1.m1.5.5.3.3" xref="A2.T7.4.4.1.m1.5.5.3.3.cmml">j</mi><mo id="A2.T7.4.4.1.m1.6.6.4.6.3" xref="A2.T7.4.4.1.m1.6.6.4.5.cmml">,</mo><mi id="A2.T7.4.4.1.m1.6.6.4.4" xref="A2.T7.4.4.1.m1.6.6.4.4.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.T7.4.4.1.m1.6b"><apply id="A2.T7.4.4.1.m1.6.7.cmml" xref="A2.T7.4.4.1.m1.6.7"><times id="A2.T7.4.4.1.m1.6.7.1.cmml" xref="A2.T7.4.4.1.m1.6.7.1"></times><apply id="A2.T7.4.4.1.m1.6.7.2.cmml" xref="A2.T7.4.4.1.m1.6.7.2"><csymbol cd="ambiguous" id="A2.T7.4.4.1.m1.6.7.2.1.cmml" xref="A2.T7.4.4.1.m1.6.7.2">subscript</csymbol><ci id="A2.T7.4.4.1.m1.6.7.2.2a.cmml" xref="A2.T7.4.4.1.m1.6.7.2.2"><mtext id="A2.T7.4.4.1.m1.6.7.2.2.cmml" xref="A2.T7.4.4.1.m1.6.7.2.2">mean</mtext></ci><list id="A2.T7.4.4.1.m1.2.2.2.3.cmml" xref="A2.T7.4.4.1.m1.2.2.2.4"><ci id="A2.T7.4.4.1.m1.1.1.1.1.cmml" xref="A2.T7.4.4.1.m1.1.1.1.1">𝑖</ci><ci id="A2.T7.4.4.1.m1.2.2.2.2.cmml" xref="A2.T7.4.4.1.m1.2.2.2.2">𝑗</ci></list></apply><apply id="A2.T7.4.4.1.m1.6.7.3.cmml" xref="A2.T7.4.4.1.m1.6.7.3"><csymbol cd="ambiguous" id="A2.T7.4.4.1.m1.6.7.3.1.cmml" xref="A2.T7.4.4.1.m1.6.7.3">subscript</csymbol><ci id="A2.T7.4.4.1.m1.6.7.3.2a.cmml" xref="A2.T7.4.4.1.m1.6.7.3.2"><mtext id="A2.T7.4.4.1.m1.6.7.3.2.cmml" xref="A2.T7.4.4.1.m1.6.7.3.2">max</mtext></ci><ci id="A2.T7.4.4.1.m1.6.7.3.3.cmml" xref="A2.T7.4.4.1.m1.6.7.3.3">𝑘</ci></apply><apply id="A2.T7.4.4.1.m1.6.7.4.cmml" xref="A2.T7.4.4.1.m1.6.7.4"><csymbol cd="ambiguous" id="A2.T7.4.4.1.m1.6.7.4.1.cmml" xref="A2.T7.4.4.1.m1.6.7.4">subscript</csymbol><ci id="A2.T7.4.4.1.m1.6.7.4.2.cmml" xref="A2.T7.4.4.1.m1.6.7.4.2">𝛼</ci><list id="A2.T7.4.4.1.m1.6.6.4.5.cmml" xref="A2.T7.4.4.1.m1.6.6.4.6"><cn id="A2.T7.4.4.1.m1.3.3.1.1.cmml" type="integer" xref="A2.T7.4.4.1.m1.3.3.1.1">0</cn><ci id="A2.T7.4.4.1.m1.4.4.2.2.cmml" xref="A2.T7.4.4.1.m1.4.4.2.2">𝑖</ci><ci id="A2.T7.4.4.1.m1.5.5.3.3.cmml" xref="A2.T7.4.4.1.m1.5.5.3.3">𝑗</ci><ci id="A2.T7.4.4.1.m1.6.6.4.4.cmml" xref="A2.T7.4.4.1.m1.6.6.4.4">𝑘</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.4.4.1.m1.6c">\text{mean}_{i,j}\text{max}_{k}\alpha_{0,i,j,k}</annotation><annotation encoding="application/x-llamapun" id="A2.T7.4.4.1.m1.6d">mean start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT max start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT 0 , italic_i , italic_j , italic_k end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T7.4.4.2" style="padding:1.25pt 5.0pt;">63.32</td>
<td class="ltx_td ltx_align_center" id="A2.T7.4.4.3" style="padding:1.25pt 5.0pt;">70.69</td>
<td class="ltx_td ltx_align_center" id="A2.T7.4.4.4" style="padding:1.25pt 5.0pt;">73.52</td>
<td class="ltx_td ltx_align_center" id="A2.T7.4.4.5" style="padding:1.25pt 5.0pt;">75.12</td>
<td class="ltx_td ltx_align_center" id="A2.T7.4.4.6" style="padding:1.25pt 5.0pt;">70.66</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T7.4.4.7" style="padding:1.25pt 5.0pt;">74.10</td>
<td class="ltx_td ltx_align_center" id="A2.T7.4.4.8" style="padding:1.25pt 5.0pt;">78.11</td>
<td class="ltx_td ltx_align_center" id="A2.T7.4.4.9" style="padding:1.25pt 5.0pt;">79.70</td>
<td class="ltx_td ltx_align_center" id="A2.T7.4.4.10" style="padding:1.25pt 5.0pt;">80.59</td>
<td class="ltx_td ltx_align_center" id="A2.T7.4.4.11" style="padding:1.25pt 5.0pt;">78.13</td>
</tr>
<tr class="ltx_tr" id="A2.T7.5.5">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T7.5.5.1" style="padding:1.25pt 5.0pt;">(v) <math alttext="\text{mean}_{-6\leq i\leq-1,j,k}\alpha_{0,i,j,\mathbf{r}[k]}" class="ltx_Math" display="inline" id="A2.T7.5.5.1.m1.9"><semantics id="A2.T7.5.5.1.m1.9a"><mrow id="A2.T7.5.5.1.m1.9.10" xref="A2.T7.5.5.1.m1.9.10.cmml"><msub id="A2.T7.5.5.1.m1.9.10.2" xref="A2.T7.5.5.1.m1.9.10.2.cmml"><mtext id="A2.T7.5.5.1.m1.9.10.2.2" xref="A2.T7.5.5.1.m1.9.10.2.2a.cmml">mean</mtext><mrow id="A2.T7.5.5.1.m1.4.4.4.4" xref="A2.T7.5.5.1.m1.4.4.4.5.cmml"><mrow id="A2.T7.5.5.1.m1.3.3.3.3.1" xref="A2.T7.5.5.1.m1.3.3.3.3.1.cmml"><mrow id="A2.T7.5.5.1.m1.3.3.3.3.1.2" xref="A2.T7.5.5.1.m1.3.3.3.3.1.2.cmml"><mo id="A2.T7.5.5.1.m1.3.3.3.3.1.2a" xref="A2.T7.5.5.1.m1.3.3.3.3.1.2.cmml">−</mo><mn id="A2.T7.5.5.1.m1.3.3.3.3.1.2.2" xref="A2.T7.5.5.1.m1.3.3.3.3.1.2.2.cmml">6</mn></mrow><mo id="A2.T7.5.5.1.m1.3.3.3.3.1.3" xref="A2.T7.5.5.1.m1.3.3.3.3.1.3.cmml">≤</mo><mi id="A2.T7.5.5.1.m1.3.3.3.3.1.4" xref="A2.T7.5.5.1.m1.3.3.3.3.1.4.cmml">i</mi><mo id="A2.T7.5.5.1.m1.3.3.3.3.1.5" xref="A2.T7.5.5.1.m1.3.3.3.3.1.5.cmml">≤</mo><mrow id="A2.T7.5.5.1.m1.3.3.3.3.1.6" xref="A2.T7.5.5.1.m1.3.3.3.3.1.6.cmml"><mo id="A2.T7.5.5.1.m1.3.3.3.3.1.6a" xref="A2.T7.5.5.1.m1.3.3.3.3.1.6.cmml">−</mo><mn id="A2.T7.5.5.1.m1.3.3.3.3.1.6.2" xref="A2.T7.5.5.1.m1.3.3.3.3.1.6.2.cmml">1</mn></mrow></mrow><mo id="A2.T7.5.5.1.m1.4.4.4.4.3" xref="A2.T7.5.5.1.m1.4.4.4.5a.cmml">,</mo><mrow id="A2.T7.5.5.1.m1.4.4.4.4.2.2" xref="A2.T7.5.5.1.m1.4.4.4.4.2.1.cmml"><mi id="A2.T7.5.5.1.m1.1.1.1.1" xref="A2.T7.5.5.1.m1.1.1.1.1.cmml">j</mi><mo id="A2.T7.5.5.1.m1.4.4.4.4.2.2.1" xref="A2.T7.5.5.1.m1.4.4.4.4.2.1.cmml">,</mo><mi id="A2.T7.5.5.1.m1.2.2.2.2" xref="A2.T7.5.5.1.m1.2.2.2.2.cmml">k</mi></mrow></mrow></msub><mo id="A2.T7.5.5.1.m1.9.10.1" xref="A2.T7.5.5.1.m1.9.10.1.cmml">⁢</mo><msub id="A2.T7.5.5.1.m1.9.10.3" xref="A2.T7.5.5.1.m1.9.10.3.cmml"><mi id="A2.T7.5.5.1.m1.9.10.3.2" xref="A2.T7.5.5.1.m1.9.10.3.2.cmml">α</mi><mrow id="A2.T7.5.5.1.m1.9.9.5.5" xref="A2.T7.5.5.1.m1.9.9.5.6.cmml"><mn id="A2.T7.5.5.1.m1.6.6.2.2" xref="A2.T7.5.5.1.m1.6.6.2.2.cmml">0</mn><mo id="A2.T7.5.5.1.m1.9.9.5.5.2" xref="A2.T7.5.5.1.m1.9.9.5.6.cmml">,</mo><mi id="A2.T7.5.5.1.m1.7.7.3.3" xref="A2.T7.5.5.1.m1.7.7.3.3.cmml">i</mi><mo id="A2.T7.5.5.1.m1.9.9.5.5.3" xref="A2.T7.5.5.1.m1.9.9.5.6.cmml">,</mo><mi id="A2.T7.5.5.1.m1.8.8.4.4" xref="A2.T7.5.5.1.m1.8.8.4.4.cmml">j</mi><mo id="A2.T7.5.5.1.m1.9.9.5.5.4" xref="A2.T7.5.5.1.m1.9.9.5.6.cmml">,</mo><mrow id="A2.T7.5.5.1.m1.9.9.5.5.1" xref="A2.T7.5.5.1.m1.9.9.5.5.1.cmml"><mi id="A2.T7.5.5.1.m1.9.9.5.5.1.2" xref="A2.T7.5.5.1.m1.9.9.5.5.1.2.cmml">𝐫</mi><mo id="A2.T7.5.5.1.m1.9.9.5.5.1.1" xref="A2.T7.5.5.1.m1.9.9.5.5.1.1.cmml">⁢</mo><mrow id="A2.T7.5.5.1.m1.9.9.5.5.1.3.2" xref="A2.T7.5.5.1.m1.9.9.5.5.1.3.1.cmml"><mo id="A2.T7.5.5.1.m1.9.9.5.5.1.3.2.1" stretchy="false" xref="A2.T7.5.5.1.m1.9.9.5.5.1.3.1.1.cmml">[</mo><mi id="A2.T7.5.5.1.m1.5.5.1.1" xref="A2.T7.5.5.1.m1.5.5.1.1.cmml">k</mi><mo id="A2.T7.5.5.1.m1.9.9.5.5.1.3.2.2" stretchy="false" xref="A2.T7.5.5.1.m1.9.9.5.5.1.3.1.1.cmml">]</mo></mrow></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.T7.5.5.1.m1.9b"><apply id="A2.T7.5.5.1.m1.9.10.cmml" xref="A2.T7.5.5.1.m1.9.10"><times id="A2.T7.5.5.1.m1.9.10.1.cmml" xref="A2.T7.5.5.1.m1.9.10.1"></times><apply id="A2.T7.5.5.1.m1.9.10.2.cmml" xref="A2.T7.5.5.1.m1.9.10.2"><csymbol cd="ambiguous" id="A2.T7.5.5.1.m1.9.10.2.1.cmml" xref="A2.T7.5.5.1.m1.9.10.2">subscript</csymbol><ci id="A2.T7.5.5.1.m1.9.10.2.2a.cmml" xref="A2.T7.5.5.1.m1.9.10.2.2"><mtext id="A2.T7.5.5.1.m1.9.10.2.2.cmml" xref="A2.T7.5.5.1.m1.9.10.2.2">mean</mtext></ci><apply id="A2.T7.5.5.1.m1.4.4.4.5.cmml" xref="A2.T7.5.5.1.m1.4.4.4.4"><csymbol cd="ambiguous" id="A2.T7.5.5.1.m1.4.4.4.5a.cmml" xref="A2.T7.5.5.1.m1.4.4.4.4.3">formulae-sequence</csymbol><apply id="A2.T7.5.5.1.m1.3.3.3.3.1.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1"><and id="A2.T7.5.5.1.m1.3.3.3.3.1a.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1"></and><apply id="A2.T7.5.5.1.m1.3.3.3.3.1b.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1"><leq id="A2.T7.5.5.1.m1.3.3.3.3.1.3.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1.3"></leq><apply id="A2.T7.5.5.1.m1.3.3.3.3.1.2.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1.2"><minus id="A2.T7.5.5.1.m1.3.3.3.3.1.2.1.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1.2"></minus><cn id="A2.T7.5.5.1.m1.3.3.3.3.1.2.2.cmml" type="integer" xref="A2.T7.5.5.1.m1.3.3.3.3.1.2.2">6</cn></apply><ci id="A2.T7.5.5.1.m1.3.3.3.3.1.4.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1.4">𝑖</ci></apply><apply id="A2.T7.5.5.1.m1.3.3.3.3.1c.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1"><leq id="A2.T7.5.5.1.m1.3.3.3.3.1.5.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1.5"></leq><share href="https://arxiv.org/html/2410.10293v1#A2.T7.5.5.1.m1.3.3.3.3.1.4.cmml" id="A2.T7.5.5.1.m1.3.3.3.3.1d.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1"></share><apply id="A2.T7.5.5.1.m1.3.3.3.3.1.6.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1.6"><minus id="A2.T7.5.5.1.m1.3.3.3.3.1.6.1.cmml" xref="A2.T7.5.5.1.m1.3.3.3.3.1.6"></minus><cn id="A2.T7.5.5.1.m1.3.3.3.3.1.6.2.cmml" type="integer" xref="A2.T7.5.5.1.m1.3.3.3.3.1.6.2">1</cn></apply></apply></apply><list id="A2.T7.5.5.1.m1.4.4.4.4.2.1.cmml" xref="A2.T7.5.5.1.m1.4.4.4.4.2.2"><ci id="A2.T7.5.5.1.m1.1.1.1.1.cmml" xref="A2.T7.5.5.1.m1.1.1.1.1">𝑗</ci><ci id="A2.T7.5.5.1.m1.2.2.2.2.cmml" xref="A2.T7.5.5.1.m1.2.2.2.2">𝑘</ci></list></apply></apply><apply id="A2.T7.5.5.1.m1.9.10.3.cmml" xref="A2.T7.5.5.1.m1.9.10.3"><csymbol cd="ambiguous" id="A2.T7.5.5.1.m1.9.10.3.1.cmml" xref="A2.T7.5.5.1.m1.9.10.3">subscript</csymbol><ci id="A2.T7.5.5.1.m1.9.10.3.2.cmml" xref="A2.T7.5.5.1.m1.9.10.3.2">𝛼</ci><list id="A2.T7.5.5.1.m1.9.9.5.6.cmml" xref="A2.T7.5.5.1.m1.9.9.5.5"><cn id="A2.T7.5.5.1.m1.6.6.2.2.cmml" type="integer" xref="A2.T7.5.5.1.m1.6.6.2.2">0</cn><ci id="A2.T7.5.5.1.m1.7.7.3.3.cmml" xref="A2.T7.5.5.1.m1.7.7.3.3">𝑖</ci><ci id="A2.T7.5.5.1.m1.8.8.4.4.cmml" xref="A2.T7.5.5.1.m1.8.8.4.4">𝑗</ci><apply id="A2.T7.5.5.1.m1.9.9.5.5.1.cmml" xref="A2.T7.5.5.1.m1.9.9.5.5.1"><times id="A2.T7.5.5.1.m1.9.9.5.5.1.1.cmml" xref="A2.T7.5.5.1.m1.9.9.5.5.1.1"></times><ci id="A2.T7.5.5.1.m1.9.9.5.5.1.2.cmml" xref="A2.T7.5.5.1.m1.9.9.5.5.1.2">𝐫</ci><apply id="A2.T7.5.5.1.m1.9.9.5.5.1.3.1.cmml" xref="A2.T7.5.5.1.m1.9.9.5.5.1.3.2"><csymbol cd="latexml" id="A2.T7.5.5.1.m1.9.9.5.5.1.3.1.1.cmml" xref="A2.T7.5.5.1.m1.9.9.5.5.1.3.2.1">delimited-[]</csymbol><ci id="A2.T7.5.5.1.m1.5.5.1.1.cmml" xref="A2.T7.5.5.1.m1.5.5.1.1">𝑘</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.5.5.1.m1.9c">\text{mean}_{-6\leq i\leq-1,j,k}\alpha_{0,i,j,\mathbf{r}[k]}</annotation><annotation encoding="application/x-llamapun" id="A2.T7.5.5.1.m1.9d">mean start_POSTSUBSCRIPT - 6 ≤ italic_i ≤ - 1 , italic_j , italic_k end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT 0 , italic_i , italic_j , bold_r [ italic_k ] end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l" id="A2.T7.5.5.2" style="padding:1.25pt 5.0pt;">63.68</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.5.5.3" style="padding:1.25pt 5.0pt;">71.16</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.5.5.4" style="padding:1.25pt 5.0pt;">73.82</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.5.5.5" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.5.5.5.1">75.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.5.5.6" style="padding:1.25pt 5.0pt;">71.04</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l" id="A2.T7.5.5.7" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.5.5.7.1">74.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.5.5.8" style="padding:1.25pt 5.0pt;">78.26</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.5.5.9" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.5.5.9.1">79.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.5.5.10" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.5.5.10.1">80.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.5.5.11" style="padding:1.25pt 5.0pt;"><span class="ltx_text ltx_font_bold" id="A2.T7.5.5.11.1">78.43</span></td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Performance comparison of attention aggregation schemes on NQ and TQA datasets, where the index <math alttext="i" class="ltx_Math" display="inline" id="A2.T7.9.m1.1"><semantics id="A2.T7.9.m1.1b"><mi id="A2.T7.9.m1.1.1" xref="A2.T7.9.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.T7.9.m1.1c"><ci id="A2.T7.9.m1.1.1.cmml" xref="A2.T7.9.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.9.m1.1d">i</annotation><annotation encoding="application/x-llamapun" id="A2.T7.9.m1.1e">italic_i</annotation></semantics></math> corresponds to layers of the decoder, <math alttext="j" class="ltx_Math" display="inline" id="A2.T7.10.m2.1"><semantics id="A2.T7.10.m2.1b"><mi id="A2.T7.10.m2.1.1" xref="A2.T7.10.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A2.T7.10.m2.1c"><ci id="A2.T7.10.m2.1.1.cmml" xref="A2.T7.10.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.10.m2.1d">j</annotation><annotation encoding="application/x-llamapun" id="A2.T7.10.m2.1e">italic_j</annotation></semantics></math> corresponds to heads, and <math alttext="k" class="ltx_Math" display="inline" id="A2.T7.11.m3.1"><semantics id="A2.T7.11.m3.1b"><mi id="A2.T7.11.m3.1.1" xref="A2.T7.11.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A2.T7.11.m3.1c"><ci id="A2.T7.11.m3.1.1.cmml" xref="A2.T7.11.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.11.m3.1d">k</annotation><annotation encoding="application/x-llamapun" id="A2.T7.11.m3.1e">italic_k</annotation></semantics></math> corresponds to input tokens of a given passage.</figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>More In-depth Studies</h2>
<figure class="ltx_table" id="A3.T8">
<table class="ltx_tabular ltx_align_middle" id="A3.T8.1">
<tr class="ltx_tr" id="A3.T8.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T8.1.1.1" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.1.1">Datasets</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T8.1.1.2" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.2.1">@K</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" id="A3.T8.1.1.3" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.3.1">w/ query</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T8.1.1.4" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.4.1">w/o query</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" id="A3.T8.1.1.5" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.5.1">%Improv.</span></td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.2">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T8.1.2.1" rowspan="4" style="padding:1.25pt 4.3pt;"><span class="ltx_text" id="A3.T8.1.2.1.1">NQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T8.1.2.2" style="padding:1.25pt 4.3pt;">@1</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" id="A3.T8.1.2.3" style="padding:1.25pt 4.3pt;">56.79</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T8.1.2.4" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.2.4.1">57.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_tt" id="A3.T8.1.2.5" style="padding:1.25pt 4.3pt;">1.51%</td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.3">
<td class="ltx_td ltx_align_center" id="A3.T8.1.3.1" style="padding:1.25pt 4.3pt;">@2</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.3.2" style="padding:1.25pt 4.3pt;">67.51</td>
<td class="ltx_td ltx_align_center" id="A3.T8.1.3.3" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.3.3.1">67.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.3.4" style="padding:1.25pt 4.3pt;">0.49%</td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.4">
<td class="ltx_td ltx_align_center" id="A3.T8.1.4.1" style="padding:1.25pt 4.3pt;">@3</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.4.2" style="padding:1.25pt 4.3pt;">71.80</td>
<td class="ltx_td ltx_align_center" id="A3.T8.1.4.3" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.4.3.1">71.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.4.4" style="padding:1.25pt 4.3pt;">0.11%</td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.5">
<td class="ltx_td ltx_align_center" id="A3.T8.1.5.1" style="padding:1.25pt 4.3pt;">@4</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.5.2" style="padding:1.25pt 4.3pt;">73.55</td>
<td class="ltx_td ltx_align_center" id="A3.T8.1.5.3" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.5.3.1">73.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.5.4" style="padding:1.25pt 4.3pt;">0.11%</td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.6">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T8.1.6.1" rowspan="4" style="padding:1.25pt 4.3pt;"><span class="ltx_text" id="A3.T8.1.6.1.1">TQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.1.6.2" style="padding:1.25pt 4.3pt;">@1</td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="A3.T8.1.6.3" style="padding:1.25pt 4.3pt;">65.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.1.6.4" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.6.4.1">68.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="A3.T8.1.6.5" style="padding:1.25pt 4.3pt;">5.17%</td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.7">
<td class="ltx_td ltx_align_center" id="A3.T8.1.7.1" style="padding:1.25pt 4.3pt;">@2</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.7.2" style="padding:1.25pt 4.3pt;">74.67</td>
<td class="ltx_td ltx_align_center" id="A3.T8.1.7.3" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.7.3.1">75.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.7.4" style="padding:1.25pt 4.3pt;">1.59%</td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.8">
<td class="ltx_td ltx_align_center" id="A3.T8.1.8.1" style="padding:1.25pt 4.3pt;">@3</td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.8.2" style="padding:1.25pt 4.3pt;">77.49</td>
<td class="ltx_td ltx_align_center" id="A3.T8.1.8.3" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.8.3.1">78.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_l" id="A3.T8.1.8.4" style="padding:1.25pt 4.3pt;">1.01%</td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.9">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T8.1.9.1" style="padding:1.25pt 4.3pt;">@4</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l" id="A3.T8.1.9.2" style="padding:1.25pt 4.3pt;">78.94</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T8.1.9.3" style="padding:1.25pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T8.1.9.3.1">79.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l" id="A3.T8.1.9.4" style="padding:1.25pt 4.3pt;">0.61%</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>AR comparison with and without query tokens.</figcaption>
</figure>
<figure class="ltx_table" id="A3.T9">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T9.1">
<tr class="ltx_tr" id="A3.T9.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T9.1.1.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T9.1.1.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T9.1.1.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T9.1.1.2.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T9.1.1.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T9.1.1.3.1">Progressive Retrieval</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.1.2.1" style="padding:1.25pt 3.6pt;">NQ</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.1.2.2" style="padding:1.25pt 3.6pt;">1.330</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.1.2.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T9.1.2.3.1">1.259</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.1.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.1.3.1" style="padding:1.25pt 3.6pt;">TQA</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.1.3.2" style="padding:1.25pt 3.6pt;">1.760</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.1.3.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T9.1.3.3.1">1.494</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Contextual integrity measurement on passages. The lower the value, the better the  contextual  integrity.</figcaption>
</figure>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Study of Attention Aggregation Schema</h3>
<div class="ltx_para" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A2.T7" title="Table 7 ‣ B.4 Hardware and Software Configurations ‣ Appendix B More Details Related to Experiments ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">7</span></a> shows the results with different aggregation schemes. Particularly, we consider <span class="ltx_text ltx_font_bold" id="A3.SS1.p1.1.1">(1)</span> taking the average over all the layers, all the heads, and all the representative tokens; <span class="ltx_text ltx_font_bold" id="A3.SS1.p1.1.2">(2)</span> taking the max over the layers instead of the average; <span class="ltx_text ltx_font_bold" id="A3.SS1.p1.1.3">(3)</span> taking the max over the heads instead of the average; <span class="ltx_text ltx_font_bold" id="A3.SS1.p1.1.4">(4)</span> taking the max over input tokens instead of the average; <span class="ltx_text ltx_font_bold" id="A3.SS1.p1.1.5">(5)</span> taking the mean over the last 6 layers instead of all the layers.
In all of the above variants, we do not consider query tokens when aggregating. We observe that: (1) Aggregation schemes with representative tokens selection (<span class="ltx_text ltx_font_italic" id="A3.SS1.p1.1.6">i.e.,</span> (i), (iv), and (v)) outperform those without representative tokens selection by a large margin, which indicates the necessity of selecting representative tokens. (2) Comparing (i) and (iv), we find that setting #rep tokens to a small value (<span class="ltx_text ltx_font_italic" id="A3.SS1.p1.1.7">e.g.,</span> 1) will hurt the retrieval performance, which suggests setting #rep tokens to moderate values (<span class="ltx_text ltx_font_italic" id="A3.SS1.p1.1.8">e.g.,</span> 4). (3) Comparing (i) and (v), only considering part of the decoder layers may bring a little performance degradation. The main reason is that certain clues captured by the other layers have been neglected. (4) Comparing (ii) and (iii), taking the max over the heads generally performs better than that over the layers.
The main reason is taking the max over the heads may find the influential head that plays a key role in identifying clues <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib7" title="">2024</a>)</cite>, while taking the max over the layers will miss some key clues captured by the other layers. In conclusion, we suggest setting #rep tokens to moderate values, using all the layers, and trying to identify the influential heads.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Ablation of Query Tokens</h3>
<div class="ltx_para" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.2">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.T8" title="Table 8 ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">8</span></a>, we conduct experiments to verify the effectiveness of ablating query tokens when estimating the relative importance of each passage. Averaging the FiD cross-attention score of all tokens in <math alttext="q\oplus p^{f}" class="ltx_Math" display="inline" id="A3.SS2.p1.1.m1.1"><semantics id="A3.SS2.p1.1.m1.1a"><mrow id="A3.SS2.p1.1.m1.1.1" xref="A3.SS2.p1.1.m1.1.1.cmml"><mi id="A3.SS2.p1.1.m1.1.1.2" xref="A3.SS2.p1.1.m1.1.1.2.cmml">q</mi><mo id="A3.SS2.p1.1.m1.1.1.1" xref="A3.SS2.p1.1.m1.1.1.1.cmml">⊕</mo><msup id="A3.SS2.p1.1.m1.1.1.3" xref="A3.SS2.p1.1.m1.1.1.3.cmml"><mi id="A3.SS2.p1.1.m1.1.1.3.2" xref="A3.SS2.p1.1.m1.1.1.3.2.cmml">p</mi><mi id="A3.SS2.p1.1.m1.1.1.3.3" xref="A3.SS2.p1.1.m1.1.1.3.3.cmml">f</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.1.m1.1b"><apply id="A3.SS2.p1.1.m1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="A3.SS2.p1.1.m1.1.1.1.cmml" xref="A3.SS2.p1.1.m1.1.1.1">direct-sum</csymbol><ci id="A3.SS2.p1.1.m1.1.1.2.cmml" xref="A3.SS2.p1.1.m1.1.1.2">𝑞</ci><apply id="A3.SS2.p1.1.m1.1.1.3.cmml" xref="A3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.SS2.p1.1.m1.1.1.3.1.cmml" xref="A3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="A3.SS2.p1.1.m1.1.1.3.2.cmml" xref="A3.SS2.p1.1.m1.1.1.3.2">𝑝</ci><ci id="A3.SS2.p1.1.m1.1.1.3.3.cmml" xref="A3.SS2.p1.1.m1.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.1.m1.1c">q\oplus p^{f}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.1.m1.1d">italic_q ⊕ italic_p start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT</annotation></semantics></math> mentions “<span class="ltx_text ltx_font_bold" id="A3.SS2.p1.2.1">w/ query</span>” and averaging that of all tokens in <math alttext="p^{f}" class="ltx_Math" display="inline" id="A3.SS2.p1.2.m2.1"><semantics id="A3.SS2.p1.2.m2.1a"><msup id="A3.SS2.p1.2.m2.1.1" xref="A3.SS2.p1.2.m2.1.1.cmml"><mi id="A3.SS2.p1.2.m2.1.1.2" xref="A3.SS2.p1.2.m2.1.1.2.cmml">p</mi><mi id="A3.SS2.p1.2.m2.1.1.3" xref="A3.SS2.p1.2.m2.1.1.3.cmml">f</mi></msup><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.2.m2.1b"><apply id="A3.SS2.p1.2.m2.1.1.cmml" xref="A3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS2.p1.2.m2.1.1.1.cmml" xref="A3.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="A3.SS2.p1.2.m2.1.1.2.cmml" xref="A3.SS2.p1.2.m2.1.1.2">𝑝</ci><ci id="A3.SS2.p1.2.m2.1.1.3.cmml" xref="A3.SS2.p1.2.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.2.m2.1c">p^{f}</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.2.m2.1d">italic_p start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT</annotation></semantics></math> mentions “<span class="ltx_text ltx_font_bold" id="A3.SS2.p1.2.2">w/o query</span>”. Here, we do not consider selecting representative tokens so that we can verify the effectiveness of ablating query tokens straightforwardly. The results show that ablating query tokens consistently improves answer recall across different cutoff positions. Specifically, We find that the marginal benefit appears as the cutoff position increases.
For example, on the TQA dataset, <span class="ltx_text ltx_font_bold" id="A3.SS2.p1.2.3">w/o query</span> achieves 5.17% improvement over <span class="ltx_text ltx_font_bold" id="A3.SS2.p1.2.4">w/ query</span> at the Top-1 position, while it is 0.61% at the Top-4 position. It can be concluded that ablating query tokens can significantly improve answer recall in the top-ranked positions, however, the gain decreases as the number of passages retrieved increases. The main reason is that as the number of passages retrieved increases, it becomes more essential than ablating query tokens.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Contextual Integrity Analysis</h3>
<div class="ltx_para" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.1">Generally, a higher contextual integrity is in favor of most downstream tasks. To measure contextual integrity, we compute information entropy <cite class="ltx_cite ltx_citemacro_cite">Shannon (<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#bib.bib44" title="">2001</a>)</cite> on passages’ source in terms of Top-4 passages for each query, where we use the title of passages as the identifier. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.T9" title="Table 9 ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">9</span></a> shows the measurement results <span class="ltx_text ltx_font_italic" id="A3.SS3.p1.1.1">w.r.t.</span> flat and progressive retrieval.
From the results, we find that progressive retrieval achieves lower information entropy (<span class="ltx_text ltx_font_italic" id="A3.SS3.p1.1.2">i.e.,</span> higher contextual integrity) than flat one. Specifically, the improvement of progressive retrieval over flat one is 5.34% and 15.11% in terms of NQ and TQA datasets, respectively. The results fully verify that the proposed <span class="ltx_text ltx_font_smallcaps" id="A3.SS3.p1.1.3">FunnelRAG</span> can largely enhance the contextual integrity just as we discussed in §<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S1" title="1 Introduction ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>Retrieval Performance Comparison</h3>
<div class="ltx_para" id="A3.SS4.p1">
<p class="ltx_p" id="A3.SS4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.T10" title="Table 10 ‣ C.5 Case Study ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">10</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.T12" title="Table 12 ‣ C.5 Case Study ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">12</span></a> shows the retrieval performance on NQ and TQA datasets in terms of the cutoff position of 1, 2, and 3. The results show similar trends as Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S4.T2" title="Table 2 ‣ 4.1 Experimental Settings ‣ 4 Experiment ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">2</span></a>. Specifically, progressive retrieval usually achieves better performance while using less time cost.
For example, on the NQ dataset, progressive retrieval uses the time cost of 2.97s and obtains the <span class="ltx_text ltx_font_bold" id="A3.SS4.p1.1.1">AR</span> of 63.73, in terms of Top-1, while flat one takes 5.25s and only achieves the <span class="ltx_text ltx_font_bold" id="A3.SS4.p1.1.2">AR</span> of 56.09. The results verify the superiority of progressive retrieval in balancing effectiveness and efficiency.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.5 </span>Case Study</h3>
<div class="ltx_para" id="A3.SS5.p1">
<p class="ltx_p" id="A3.SS5.p1.3">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#A3.T13" title="Table 13 ‣ C.5 Case Study ‣ Appendix C More In-depth Studies ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">13</span></a> shows a data-flow example of <span class="ltx_text ltx_font_smallcaps" id="A3.SS5.p1.3.1">FunnelRAG</span> from the NQ dataset. It consists of three stages: Retrieval, Pre-ranking, and Post-ranking. From the retrieval to the post-ranking stage, the granularity evolves from coarse-grained clustered documents to fine-grained passages. Besides, the number of candidates decreases step by step (<span class="ltx_text ltx_font_italic" id="A3.SS5.p1.3.2">e.g.,</span> 600K<math alttext="\xrightarrow[]{\text{Retrieval}}" class="ltx_Math" display="inline" id="A3.SS5.p1.1.m1.1"><semantics id="A3.SS5.p1.1.m1.1a"><mover accent="true" id="A3.SS5.p1.1.m1.1.1" xref="A3.SS5.p1.1.m1.1.1.cmml"><mo id="A3.SS5.p1.1.m1.1.1.2" stretchy="false" xref="A3.SS5.p1.1.m1.1.1.2.cmml">→</mo><mtext id="A3.SS5.p1.1.m1.1.1.1" xref="A3.SS5.p1.1.m1.1.1.1a.cmml">Retrieval</mtext></mover><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.1.m1.1b"><apply id="A3.SS5.p1.1.m1.1.1.cmml" xref="A3.SS5.p1.1.m1.1.1"><ci id="A3.SS5.p1.1.m1.1.1.1a.cmml" xref="A3.SS5.p1.1.m1.1.1.1"><mtext id="A3.SS5.p1.1.m1.1.1.1.cmml" xref="A3.SS5.p1.1.m1.1.1.1">Retrieval</mtext></ci><ci id="A3.SS5.p1.1.m1.1.1.2.cmml" xref="A3.SS5.p1.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.1.m1.1c">\xrightarrow[]{\text{Retrieval}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.1.m1.1d">start_ARROW overRetrieval → end_ARROW</annotation></semantics></math>80c<math alttext="\xrightarrow[]{\text{Pre-ranking}}" class="ltx_Math" display="inline" id="A3.SS5.p1.2.m2.1"><semantics id="A3.SS5.p1.2.m2.1a"><mover accent="true" id="A3.SS5.p1.2.m2.1.1" xref="A3.SS5.p1.2.m2.1.1.cmml"><mo id="A3.SS5.p1.2.m2.1.1.2" stretchy="false" xref="A3.SS5.p1.2.m2.1.1.2.cmml">→</mo><mtext id="A3.SS5.p1.2.m2.1.1.1" xref="A3.SS5.p1.2.m2.1.1.1a.cmml">Pre-ranking</mtext></mover><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.2.m2.1b"><apply id="A3.SS5.p1.2.m2.1.1.cmml" xref="A3.SS5.p1.2.m2.1.1"><ci id="A3.SS5.p1.2.m2.1.1.1a.cmml" xref="A3.SS5.p1.2.m2.1.1.1"><mtext id="A3.SS5.p1.2.m2.1.1.1.cmml" xref="A3.SS5.p1.2.m2.1.1.1">Pre-ranking</mtext></ci><ci id="A3.SS5.p1.2.m2.1.1.2.cmml" xref="A3.SS5.p1.2.m2.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.2.m2.1c">\xrightarrow[]{\text{Pre-ranking}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.2.m2.1d">start_ARROW overPre-ranking → end_ARROW</annotation></semantics></math>8d<math alttext="\xrightarrow[]{\text{Post-ranking}}" class="ltx_Math" display="inline" id="A3.SS5.p1.3.m3.1"><semantics id="A3.SS5.p1.3.m3.1a"><mover accent="true" id="A3.SS5.p1.3.m3.1.1" xref="A3.SS5.p1.3.m3.1.1.cmml"><mo id="A3.SS5.p1.3.m3.1.1.2" stretchy="false" xref="A3.SS5.p1.3.m3.1.1.2.cmml">→</mo><mtext id="A3.SS5.p1.3.m3.1.1.1" xref="A3.SS5.p1.3.m3.1.1.1a.cmml">Post-ranking</mtext></mover><annotation-xml encoding="MathML-Content" id="A3.SS5.p1.3.m3.1b"><apply id="A3.SS5.p1.3.m3.1.1.cmml" xref="A3.SS5.p1.3.m3.1.1"><ci id="A3.SS5.p1.3.m3.1.1.1a.cmml" xref="A3.SS5.p1.3.m3.1.1.1"><mtext id="A3.SS5.p1.3.m3.1.1.1.cmml" xref="A3.SS5.p1.3.m3.1.1.1">Post-ranking</mtext></ci><ci id="A3.SS5.p1.3.m3.1.1.2.cmml" xref="A3.SS5.p1.3.m3.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS5.p1.3.m3.1c">\xrightarrow[]{\text{Post-ranking}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS5.p1.3.m3.1d">start_ARROW overPost-ranking → end_ARROW</annotation></semantics></math>4p). More importantly, we find that the proportion of candidates that contains the answer string gradually increases, which indicates that the signal-to-noise ratio is greatly improved through progressive retrieval.
Furthermore, with more advanced models, the pre-ranking and the post-ranking stage can perceive clues in the question, <span class="ltx_text ltx_font_italic" id="A3.SS5.p1.3.3">i.e.,</span> “<span class="ltx_text ltx_font_bold" id="A3.SS5.p1.3.4">the fifth season</span>”. Though the model becomes more complex, the number of candidates is limited, so the computational cost is small. As a result, “<span class="ltx_text ltx_font_bold" id="A3.SS5.p1.3.5">America’s Got Talent (season 5)</span>” has been ranked first. The above analyses fully verify the effectiveness and reasonability of the proposed retrieval paradigm for RAG, <span class="ltx_text ltx_font_italic" id="A3.SS5.p1.3.6">i.e.,</span> <span class="ltx_text ltx_font_smallcaps" id="A3.SS5.p1.3.7">FunnelRAG</span>, whose main design ideas are large-to-small quantities, coarse-to-fine granularity, as well as simple-to-complex  models.</p>
</div>
<figure class="ltx_table" id="A3.T10">
<table class="ltx_tabular ltx_align_middle" id="A3.T10.18">
<tr class="ltx_tr" id="A3.T10.18.19">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T10.18.19.1" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.18.19.1.1">Datasets</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T10.18.19.2" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.18.19.2.1">Retrieval Paradigm</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="A3.T10.18.19.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.18.19.3.1">Retrieval Stages</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T10.18.19.4" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.18.19.4.1">
<span class="ltx_tabular ltx_align_middle" id="A3.T10.18.19.4.1.1">
<span class="ltx_tr" id="A3.T10.18.19.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T10.18.19.4.1.1.1.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.18.19.4.1.1.1.1.1">Time Cost</span></span></span>
<span class="ltx_tr" id="A3.T10.18.19.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T10.18.19.4.1.1.2.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.18.19.4.1.1.2.1.1">(T)</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T10.18.19.5" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.18.19.5.1">
<span class="ltx_tabular ltx_align_middle" id="A3.T10.18.19.5.1.1">
<span class="ltx_tr" id="A3.T10.18.19.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T10.18.19.5.1.1.1.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.18.19.5.1.1.1.1.1">Answer Recall</span></span></span>
<span class="ltx_tr" id="A3.T10.18.19.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T10.18.19.5.1.1.2.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.18.19.5.1.1.2.1.1">(AR)</span></span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.18.20">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.18.20.1" style="padding:1.25pt 3.6pt;">Retrieval</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.18.20.2" style="padding:1.25pt 3.6pt;">Pre/Re-ranking</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.18.20.3" style="padding:1.25pt 3.6pt;">Post-ranking</td>
</tr>
<tr class="ltx_tr" id="A3.T10.1.1">
<td class="ltx_td ltx_border_t" id="A3.T10.1.1.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.1.1.3" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.1.1.3.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.1.1.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.1.1.1.m1.1"><semantics id="A3.T10.1.1.1.m1.1a"><mo id="A3.T10.1.1.1.m1.1.1" stretchy="false" xref="A3.T10.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.1.1.1.m1.1b"><ci id="A3.T10.1.1.1.m1.1.1.cmml" xref="A3.T10.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.1.1.1.m1.1d">→</annotation></semantics></math> 1p</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.1.1.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.1.1.5" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.1.1.6" style="padding:1.25pt 3.6pt;">4.90 (4.90+N/A+N/A)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.1.1.7" style="padding:1.25pt 3.6pt;">51.16</td>
</tr>
<tr class="ltx_tr" id="A3.T10.3.3">
<td class="ltx_td" id="A3.T10.3.3.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T10.2.2.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.2.2.1.m1.1"><semantics id="A3.T10.2.2.1.m1.1a"><mo id="A3.T10.2.2.1.m1.1.1" stretchy="false" xref="A3.T10.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.2.2.1.m1.1b"><ci id="A3.T10.2.2.1.m1.1.1.cmml" xref="A3.T10.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.2.2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.2.2.1.m1.1d">→</annotation></semantics></math> 400p</td>
<td class="ltx_td ltx_align_left" id="A3.T10.3.3.2" style="padding:1.25pt 3.6pt;">400p <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.3.3.2.m1.1"><semantics id="A3.T10.3.3.2.m1.1a"><mo id="A3.T10.3.3.2.m1.1.1" stretchy="false" xref="A3.T10.3.3.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.3.3.2.m1.1b"><ci id="A3.T10.3.3.2.m1.1.1.cmml" xref="A3.T10.3.3.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.3.3.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.3.3.2.m1.1d">→</annotation></semantics></math> 1p</td>
<td class="ltx_td ltx_align_left" id="A3.T10.3.3.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left" id="A3.T10.3.3.5" style="padding:1.25pt 3.6pt;">5.25 (4.90+0.35+N/A)</td>
<td class="ltx_td ltx_align_center" id="A3.T10.3.3.6" style="padding:1.25pt 3.6pt;">56.09</td>
</tr>
<tr class="ltx_tr" id="A3.T10.4.4">
<td class="ltx_td" id="A3.T10.4.4.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T10.4.4.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T10.4.4.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.4.4.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.4.4.1.1.m1.1"><semantics id="A3.T10.4.4.1.1.m1.1a"><mo id="A3.T10.4.4.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.4.4.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.4.4.1.1.m1.1b"><ci id="A3.T10.4.4.1.1.m1.1.1.cmml" xref="A3.T10.4.4.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.4.4.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.4.4.1.1.m1.1d">→</annotation></semantics></math> 1c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.4.4.4" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.4.4.4.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.4.4.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.4.4.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.4.4.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.4.4.6.1" style="background-color:#F0F0F0;">0.00 (0.00+N/A+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.4.4.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.4.4.7.1" style="background-color:#F0F0F0;">52.74</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.6.6">
<td class="ltx_td" id="A3.T10.6.6.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T10.6.6.4" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T10.5.5.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.5.5.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.5.5.1.1.m1.1"><semantics id="A3.T10.5.5.1.1.m1.1a"><mo id="A3.T10.5.5.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.5.5.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.5.5.1.1.m1.1b"><ci id="A3.T10.5.5.1.1.m1.1.1.cmml" xref="A3.T10.5.5.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.5.5.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.5.5.1.1.m1.1d">→</annotation></semantics></math> 20c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.6.6.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.6.6.2.1" style="background-color:#F0F0F0;">20c <math alttext="\xrightarrow[]{\sim\text{180d}}" class="ltx_Math" display="inline" id="A3.T10.6.6.2.1.m1.1"><semantics id="A3.T10.6.6.2.1.m1.1a"><mover accent="true" id="A3.T10.6.6.2.1.m1.1.1" xref="A3.T10.6.6.2.1.m1.1.1.cmml"><mo id="A3.T10.6.6.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.6.6.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T10.6.6.2.1.m1.1.1.1" xref="A3.T10.6.6.2.1.m1.1.1.1.cmml"><mi id="A3.T10.6.6.2.1.m1.1.1.1.2" xref="A3.T10.6.6.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T10.6.6.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T10.6.6.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T10.6.6.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T10.6.6.2.1.m1.1.1.1.3a.cmml">180d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T10.6.6.2.1.m1.1b"><apply id="A3.T10.6.6.2.1.m1.1.1.cmml" xref="A3.T10.6.6.2.1.m1.1.1"><apply id="A3.T10.6.6.2.1.m1.1.1.1.cmml" xref="A3.T10.6.6.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T10.6.6.2.1.m1.1.1.1.1.cmml" xref="A3.T10.6.6.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T10.6.6.2.1.m1.1.1.1.2.cmml" xref="A3.T10.6.6.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T10.6.6.2.1.m1.1.1.1.3a.cmml" xref="A3.T10.6.6.2.1.m1.1.1.1.3"><mtext id="A3.T10.6.6.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T10.6.6.2.1.m1.1.1.1.3">180d</mtext></ci></apply><ci id="A3.T10.6.6.2.1.m1.1.1.2.cmml" xref="A3.T10.6.6.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.6.6.2.1.m1.1c">\xrightarrow[]{\sim\text{180d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T10.6.6.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 180d end_OVERACCENT → end_ARROW</annotation></semantics></math> 1d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.6.6.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.6.6.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.6.6.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.6.6.6.1" style="background-color:#F0F0F0;">0.49 (0.00+0.49+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.6.6.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.6.6.7.1" style="background-color:#F0F0F0;">63.46</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.9.9" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center" id="A3.T10.9.9.4" style="background-color:#FFFFFF;padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.9.9.4.1" style="background-color:#FFFFFF;"><span class="ltx_text" id="A3.T10.9.9.4.1.1">NQ</span></span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.9.9.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.9.9.5.1" style="background-color:#F0F0F0;">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.7.7.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.7.7.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.7.7.1.1.m1.1"><semantics id="A3.T10.7.7.1.1.m1.1a"><mo id="A3.T10.7.7.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.7.7.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.7.7.1.1.m1.1b"><ci id="A3.T10.7.7.1.1.m1.1.1.cmml" xref="A3.T10.7.7.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.7.7.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.7.7.1.1.m1.1d">→</annotation></semantics></math> 80c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.8.8.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.8.8.2.1" style="background-color:#F0F0F0;">80c <math alttext="\xrightarrow[]{\sim\text{740d}}" class="ltx_Math" display="inline" id="A3.T10.8.8.2.1.m1.1"><semantics id="A3.T10.8.8.2.1.m1.1a"><mover accent="true" id="A3.T10.8.8.2.1.m1.1.1" xref="A3.T10.8.8.2.1.m1.1.1.cmml"><mo id="A3.T10.8.8.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.8.8.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T10.8.8.2.1.m1.1.1.1" xref="A3.T10.8.8.2.1.m1.1.1.1.cmml"><mi id="A3.T10.8.8.2.1.m1.1.1.1.2" xref="A3.T10.8.8.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T10.8.8.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T10.8.8.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T10.8.8.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T10.8.8.2.1.m1.1.1.1.3a.cmml">740d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T10.8.8.2.1.m1.1b"><apply id="A3.T10.8.8.2.1.m1.1.1.cmml" xref="A3.T10.8.8.2.1.m1.1.1"><apply id="A3.T10.8.8.2.1.m1.1.1.1.cmml" xref="A3.T10.8.8.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T10.8.8.2.1.m1.1.1.1.1.cmml" xref="A3.T10.8.8.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T10.8.8.2.1.m1.1.1.1.2.cmml" xref="A3.T10.8.8.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T10.8.8.2.1.m1.1.1.1.3a.cmml" xref="A3.T10.8.8.2.1.m1.1.1.1.3"><mtext id="A3.T10.8.8.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T10.8.8.2.1.m1.1.1.1.3">740d</mtext></ci></apply><ci id="A3.T10.8.8.2.1.m1.1.1.2.cmml" xref="A3.T10.8.8.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.8.8.2.1.m1.1c">\xrightarrow[]{\sim\text{740d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T10.8.8.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 740d end_OVERACCENT → end_ARROW</annotation></semantics></math> 8d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.9.9.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.9.9.3.1" style="background-color:#F0F0F0;">8d <math alttext="\xrightarrow[]{\sim\text{50p}}" class="ltx_Math" display="inline" id="A3.T10.9.9.3.1.m1.1"><semantics id="A3.T10.9.9.3.1.m1.1a"><mover accent="true" id="A3.T10.9.9.3.1.m1.1.1" xref="A3.T10.9.9.3.1.m1.1.1.cmml"><mo id="A3.T10.9.9.3.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.9.9.3.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T10.9.9.3.1.m1.1.1.1" xref="A3.T10.9.9.3.1.m1.1.1.1.cmml"><mi id="A3.T10.9.9.3.1.m1.1.1.1.2" xref="A3.T10.9.9.3.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T10.9.9.3.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T10.9.9.3.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T10.9.9.3.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T10.9.9.3.1.m1.1.1.1.3a.cmml">50p</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T10.9.9.3.1.m1.1b"><apply id="A3.T10.9.9.3.1.m1.1.1.cmml" xref="A3.T10.9.9.3.1.m1.1.1"><apply id="A3.T10.9.9.3.1.m1.1.1.1.cmml" xref="A3.T10.9.9.3.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T10.9.9.3.1.m1.1.1.1.1.cmml" xref="A3.T10.9.9.3.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T10.9.9.3.1.m1.1.1.1.2.cmml" xref="A3.T10.9.9.3.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T10.9.9.3.1.m1.1.1.1.3a.cmml" xref="A3.T10.9.9.3.1.m1.1.1.1.3"><mtext id="A3.T10.9.9.3.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T10.9.9.3.1.m1.1.1.1.3">50p</mtext></ci></apply><ci id="A3.T10.9.9.3.1.m1.1.1.2.cmml" xref="A3.T10.9.9.3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.9.9.3.1.m1.1c">\xrightarrow[]{\sim\text{50p}}</annotation><annotation encoding="application/x-llamapun" id="A3.T10.9.9.3.1.m1.1d">start_ARROW start_OVERACCENT ∼ 50p end_OVERACCENT → end_ARROW</annotation></semantics></math> 1p</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.9.9.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.9.9.6.1" style="background-color:#F0F0F0;">2.97 (0.00+2.20+0.77)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.9.9.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.9.9.7.1" style="background-color:#F0F0F0;">63.74</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.10.10">
<td class="ltx_td ltx_border_t" id="A3.T10.10.10.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.10.10.3" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.10.10.3.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.10.10.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.10.10.1.m1.1"><semantics id="A3.T10.10.10.1.m1.1a"><mo id="A3.T10.10.10.1.m1.1.1" stretchy="false" xref="A3.T10.10.10.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.10.10.1.m1.1b"><ci id="A3.T10.10.10.1.m1.1.1.cmml" xref="A3.T10.10.10.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.10.10.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.10.10.1.m1.1d">→</annotation></semantics></math> 1p</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.10.10.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.10.10.5" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T10.10.10.6" style="padding:1.25pt 3.6pt;">5.02 (5.02+N/A+N/A)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.10.10.7" style="padding:1.25pt 3.6pt;">60.29</td>
</tr>
<tr class="ltx_tr" id="A3.T10.12.12">
<td class="ltx_td" id="A3.T10.12.12.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T10.11.11.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.11.11.1.m1.1"><semantics id="A3.T10.11.11.1.m1.1a"><mo id="A3.T10.11.11.1.m1.1.1" stretchy="false" xref="A3.T10.11.11.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.11.11.1.m1.1b"><ci id="A3.T10.11.11.1.m1.1.1.cmml" xref="A3.T10.11.11.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.11.11.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.11.11.1.m1.1d">→</annotation></semantics></math> 400p</td>
<td class="ltx_td ltx_align_left" id="A3.T10.12.12.2" style="padding:1.25pt 3.6pt;">400p <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.12.12.2.m1.1"><semantics id="A3.T10.12.12.2.m1.1a"><mo id="A3.T10.12.12.2.m1.1.1" stretchy="false" xref="A3.T10.12.12.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.12.12.2.m1.1b"><ci id="A3.T10.12.12.2.m1.1.1.cmml" xref="A3.T10.12.12.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.12.12.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.12.12.2.m1.1d">→</annotation></semantics></math> 1p</td>
<td class="ltx_td ltx_align_left" id="A3.T10.12.12.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left" id="A3.T10.12.12.5" style="padding:1.25pt 3.6pt;">5.41 (5.02+0.39+N/A)</td>
<td class="ltx_td ltx_align_center" id="A3.T10.12.12.6" style="padding:1.25pt 3.6pt;">71.37</td>
</tr>
<tr class="ltx_tr" id="A3.T10.13.13">
<td class="ltx_td" id="A3.T10.13.13.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T10.13.13.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T10.13.13.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.13.13.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.13.13.1.1.m1.1"><semantics id="A3.T10.13.13.1.1.m1.1a"><mo id="A3.T10.13.13.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.13.13.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.13.13.1.1.m1.1b"><ci id="A3.T10.13.13.1.1.m1.1.1.cmml" xref="A3.T10.13.13.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.13.13.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.13.13.1.1.m1.1d">→</annotation></semantics></math> 1c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.13.13.4" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.13.13.4.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.13.13.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.13.13.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.13.13.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.13.13.6.1" style="background-color:#F0F0F0;">0.00 (0.00+N/A+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.13.13.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.13.13.7.1" style="background-color:#F0F0F0;">66.48</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.15.15">
<td class="ltx_td" id="A3.T10.15.15.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T10.15.15.4" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T10.14.14.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.14.14.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.14.14.1.1.m1.1"><semantics id="A3.T10.14.14.1.1.m1.1a"><mo id="A3.T10.14.14.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.14.14.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.14.14.1.1.m1.1b"><ci id="A3.T10.14.14.1.1.m1.1.1.cmml" xref="A3.T10.14.14.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.14.14.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.14.14.1.1.m1.1d">→</annotation></semantics></math> 20c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.15.15.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.15.15.2.1" style="background-color:#F0F0F0;">20c <math alttext="\xrightarrow[]{\sim\text{200d}}" class="ltx_Math" display="inline" id="A3.T10.15.15.2.1.m1.1"><semantics id="A3.T10.15.15.2.1.m1.1a"><mover accent="true" id="A3.T10.15.15.2.1.m1.1.1" xref="A3.T10.15.15.2.1.m1.1.1.cmml"><mo id="A3.T10.15.15.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.15.15.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T10.15.15.2.1.m1.1.1.1" xref="A3.T10.15.15.2.1.m1.1.1.1.cmml"><mi id="A3.T10.15.15.2.1.m1.1.1.1.2" xref="A3.T10.15.15.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T10.15.15.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T10.15.15.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T10.15.15.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T10.15.15.2.1.m1.1.1.1.3a.cmml">200d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T10.15.15.2.1.m1.1b"><apply id="A3.T10.15.15.2.1.m1.1.1.cmml" xref="A3.T10.15.15.2.1.m1.1.1"><apply id="A3.T10.15.15.2.1.m1.1.1.1.cmml" xref="A3.T10.15.15.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T10.15.15.2.1.m1.1.1.1.1.cmml" xref="A3.T10.15.15.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T10.15.15.2.1.m1.1.1.1.2.cmml" xref="A3.T10.15.15.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T10.15.15.2.1.m1.1.1.1.3a.cmml" xref="A3.T10.15.15.2.1.m1.1.1.1.3"><mtext id="A3.T10.15.15.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T10.15.15.2.1.m1.1.1.1.3">200d</mtext></ci></apply><ci id="A3.T10.15.15.2.1.m1.1.1.2.cmml" xref="A3.T10.15.15.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.15.15.2.1.m1.1c">\xrightarrow[]{\sim\text{200d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T10.15.15.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 200d end_OVERACCENT → end_ARROW</annotation></semantics></math> 1d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.15.15.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.15.15.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T10.15.15.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.15.15.6.1" style="background-color:#F0F0F0;">0.60 (0.00+0.60+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.15.15.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.15.15.7.1" style="background-color:#F0F0F0;">72.59</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.18.18" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.18.18.4" style="background-color:#FFFFFF;padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.18.18.4.1" style="background-color:#FFFFFF;"><span class="ltx_text" id="A3.T10.18.18.4.1.1">TQA</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.18.18.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.18.18.5.1" style="background-color:#F0F0F0;">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T10.16.16.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.16.16.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T10.16.16.1.1.m1.1"><semantics id="A3.T10.16.16.1.1.m1.1a"><mo id="A3.T10.16.16.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.16.16.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T10.16.16.1.1.m1.1b"><ci id="A3.T10.16.16.1.1.m1.1.1.cmml" xref="A3.T10.16.16.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.16.16.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T10.16.16.1.1.m1.1d">→</annotation></semantics></math> 80c</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T10.17.17.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.17.17.2.1" style="background-color:#F0F0F0;">80c <math alttext="\xrightarrow[]{\sim\text{800d}}" class="ltx_Math" display="inline" id="A3.T10.17.17.2.1.m1.1"><semantics id="A3.T10.17.17.2.1.m1.1a"><mover accent="true" id="A3.T10.17.17.2.1.m1.1.1" xref="A3.T10.17.17.2.1.m1.1.1.cmml"><mo id="A3.T10.17.17.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.17.17.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T10.17.17.2.1.m1.1.1.1" xref="A3.T10.17.17.2.1.m1.1.1.1.cmml"><mi id="A3.T10.17.17.2.1.m1.1.1.1.2" xref="A3.T10.17.17.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T10.17.17.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T10.17.17.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T10.17.17.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T10.17.17.2.1.m1.1.1.1.3a.cmml">800d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T10.17.17.2.1.m1.1b"><apply id="A3.T10.17.17.2.1.m1.1.1.cmml" xref="A3.T10.17.17.2.1.m1.1.1"><apply id="A3.T10.17.17.2.1.m1.1.1.1.cmml" xref="A3.T10.17.17.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T10.17.17.2.1.m1.1.1.1.1.cmml" xref="A3.T10.17.17.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T10.17.17.2.1.m1.1.1.1.2.cmml" xref="A3.T10.17.17.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T10.17.17.2.1.m1.1.1.1.3a.cmml" xref="A3.T10.17.17.2.1.m1.1.1.1.3"><mtext id="A3.T10.17.17.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T10.17.17.2.1.m1.1.1.1.3">800d</mtext></ci></apply><ci id="A3.T10.17.17.2.1.m1.1.1.2.cmml" xref="A3.T10.17.17.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.17.17.2.1.m1.1c">\xrightarrow[]{\sim\text{800d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T10.17.17.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 800d end_OVERACCENT → end_ARROW</annotation></semantics></math> 12d</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T10.18.18.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.18.18.3.1" style="background-color:#F0F0F0;">12d <math alttext="\xrightarrow[]{\sim\text{65p}}" class="ltx_Math" display="inline" id="A3.T10.18.18.3.1.m1.1"><semantics id="A3.T10.18.18.3.1.m1.1a"><mover accent="true" id="A3.T10.18.18.3.1.m1.1.1" xref="A3.T10.18.18.3.1.m1.1.1.cmml"><mo id="A3.T10.18.18.3.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T10.18.18.3.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T10.18.18.3.1.m1.1.1.1" xref="A3.T10.18.18.3.1.m1.1.1.1.cmml"><mi id="A3.T10.18.18.3.1.m1.1.1.1.2" xref="A3.T10.18.18.3.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T10.18.18.3.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T10.18.18.3.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T10.18.18.3.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T10.18.18.3.1.m1.1.1.1.3a.cmml">65p</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T10.18.18.3.1.m1.1b"><apply id="A3.T10.18.18.3.1.m1.1.1.cmml" xref="A3.T10.18.18.3.1.m1.1.1"><apply id="A3.T10.18.18.3.1.m1.1.1.1.cmml" xref="A3.T10.18.18.3.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T10.18.18.3.1.m1.1.1.1.1.cmml" xref="A3.T10.18.18.3.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T10.18.18.3.1.m1.1.1.1.2.cmml" xref="A3.T10.18.18.3.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T10.18.18.3.1.m1.1.1.1.3a.cmml" xref="A3.T10.18.18.3.1.m1.1.1.1.3"><mtext id="A3.T10.18.18.3.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T10.18.18.3.1.m1.1.1.1.3">65p</mtext></ci></apply><ci id="A3.T10.18.18.3.1.m1.1.1.2.cmml" xref="A3.T10.18.18.3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T10.18.18.3.1.m1.1c">\xrightarrow[]{\sim\text{65p}}</annotation><annotation encoding="application/x-llamapun" id="A3.T10.18.18.3.1.m1.1d">start_ARROW start_OVERACCENT ∼ 65p end_OVERACCENT → end_ARROW</annotation></semantics></math> 1p</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T10.18.18.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.18.18.6.1" style="background-color:#F0F0F0;">3.47 (0.00+2.52+0.95)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.18.18.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T10.18.18.7.1" style="background-color:#F0F0F0;">74.57</span></td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>Retrieval performance comparison (in Top-1) <span class="ltx_text ltx_font_italic" id="A3.T10.20.1">w.r.t.</span> time cost and answer recall on NQ and TQA datasets.</figcaption>
</figure>
<figure class="ltx_table" id="A3.T11">
<table class="ltx_tabular ltx_align_middle" id="A3.T11.18">
<tr class="ltx_tr" id="A3.T11.18.19">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T11.18.19.1" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T11.18.19.1.1">Datasets</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T11.18.19.2" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T11.18.19.2.1">Retrieval Paradigm</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="A3.T11.18.19.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T11.18.19.3.1">Retrieval Stages</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T11.18.19.4" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.18.19.4.1">
<span class="ltx_tabular ltx_align_middle" id="A3.T11.18.19.4.1.1">
<span class="ltx_tr" id="A3.T11.18.19.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T11.18.19.4.1.1.1.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T11.18.19.4.1.1.1.1.1">Time Cost</span></span></span>
<span class="ltx_tr" id="A3.T11.18.19.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T11.18.19.4.1.1.2.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T11.18.19.4.1.1.2.1.1">(T)</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T11.18.19.5" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.18.19.5.1">
<span class="ltx_tabular ltx_align_middle" id="A3.T11.18.19.5.1.1">
<span class="ltx_tr" id="A3.T11.18.19.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T11.18.19.5.1.1.1.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T11.18.19.5.1.1.1.1.1">Answer Recall</span></span></span>
<span class="ltx_tr" id="A3.T11.18.19.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T11.18.19.5.1.1.2.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T11.18.19.5.1.1.2.1.1">(AR)</span></span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="A3.T11.18.20">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T11.18.20.1" style="padding:1.25pt 3.6pt;">Retrieval</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T11.18.20.2" style="padding:1.25pt 3.6pt;">Pre/Re-ranking</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T11.18.20.3" style="padding:1.25pt 3.6pt;">Post-ranking</td>
</tr>
<tr class="ltx_tr" id="A3.T11.1.1">
<td class="ltx_td ltx_border_t" id="A3.T11.1.1.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T11.1.1.3" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.1.1.3.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T11.1.1.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.1.1.1.m1.1"><semantics id="A3.T11.1.1.1.m1.1a"><mo id="A3.T11.1.1.1.m1.1.1" stretchy="false" xref="A3.T11.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.1.1.1.m1.1b"><ci id="A3.T11.1.1.1.m1.1.1.cmml" xref="A3.T11.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.1.1.1.m1.1d">→</annotation></semantics></math> 2p</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T11.1.1.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T11.1.1.5" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T11.1.1.6" style="padding:1.25pt 3.6pt;">4.90 (4.90+N/A+N/A)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T11.1.1.7" style="padding:1.25pt 3.6pt;">64.21</td>
</tr>
<tr class="ltx_tr" id="A3.T11.3.3">
<td class="ltx_td" id="A3.T11.3.3.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T11.2.2.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.2.2.1.m1.1"><semantics id="A3.T11.2.2.1.m1.1a"><mo id="A3.T11.2.2.1.m1.1.1" stretchy="false" xref="A3.T11.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.2.2.1.m1.1b"><ci id="A3.T11.2.2.1.m1.1.1.cmml" xref="A3.T11.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.2.2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.2.2.1.m1.1d">→</annotation></semantics></math> 400p</td>
<td class="ltx_td ltx_align_left" id="A3.T11.3.3.2" style="padding:1.25pt 3.6pt;">400p <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.3.3.2.m1.1"><semantics id="A3.T11.3.3.2.m1.1a"><mo id="A3.T11.3.3.2.m1.1.1" stretchy="false" xref="A3.T11.3.3.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.3.3.2.m1.1b"><ci id="A3.T11.3.3.2.m1.1.1.cmml" xref="A3.T11.3.3.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.3.3.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.3.3.2.m1.1d">→</annotation></semantics></math> 2p</td>
<td class="ltx_td ltx_align_left" id="A3.T11.3.3.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left" id="A3.T11.3.3.5" style="padding:1.25pt 3.6pt;">5.25 (4.90+0.35+N/A)</td>
<td class="ltx_td ltx_align_center" id="A3.T11.3.3.6" style="padding:1.25pt 3.6pt;">67.34</td>
</tr>
<tr class="ltx_tr" id="A3.T11.4.4">
<td class="ltx_td" id="A3.T11.4.4.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T11.4.4.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T11.4.4.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.4.4.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.4.4.1.1.m1.1"><semantics id="A3.T11.4.4.1.1.m1.1a"><mo id="A3.T11.4.4.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.4.4.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.4.4.1.1.m1.1b"><ci id="A3.T11.4.4.1.1.m1.1.1.cmml" xref="A3.T11.4.4.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.4.4.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.4.4.1.1.m1.1d">→</annotation></semantics></math> 2c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.4.4.4" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.4.4.4.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.4.4.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.4.4.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.4.4.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.4.4.6.1" style="background-color:#F0F0F0;">0.00 (0.00+N/A+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T11.4.4.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.4.4.7.1" style="background-color:#F0F0F0;">63.57</span></td>
</tr>
<tr class="ltx_tr" id="A3.T11.6.6">
<td class="ltx_td" id="A3.T11.6.6.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T11.6.6.4" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T11.5.5.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.5.5.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.5.5.1.1.m1.1"><semantics id="A3.T11.5.5.1.1.m1.1a"><mo id="A3.T11.5.5.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.5.5.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.5.5.1.1.m1.1b"><ci id="A3.T11.5.5.1.1.m1.1.1.cmml" xref="A3.T11.5.5.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.5.5.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.5.5.1.1.m1.1d">→</annotation></semantics></math> 20c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.6.6.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.6.6.2.1" style="background-color:#F0F0F0;">20c <math alttext="\xrightarrow[]{\sim\text{180d}}" class="ltx_Math" display="inline" id="A3.T11.6.6.2.1.m1.1"><semantics id="A3.T11.6.6.2.1.m1.1a"><mover accent="true" id="A3.T11.6.6.2.1.m1.1.1" xref="A3.T11.6.6.2.1.m1.1.1.cmml"><mo id="A3.T11.6.6.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.6.6.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T11.6.6.2.1.m1.1.1.1" xref="A3.T11.6.6.2.1.m1.1.1.1.cmml"><mi id="A3.T11.6.6.2.1.m1.1.1.1.2" xref="A3.T11.6.6.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T11.6.6.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T11.6.6.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T11.6.6.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T11.6.6.2.1.m1.1.1.1.3a.cmml">180d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T11.6.6.2.1.m1.1b"><apply id="A3.T11.6.6.2.1.m1.1.1.cmml" xref="A3.T11.6.6.2.1.m1.1.1"><apply id="A3.T11.6.6.2.1.m1.1.1.1.cmml" xref="A3.T11.6.6.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T11.6.6.2.1.m1.1.1.1.1.cmml" xref="A3.T11.6.6.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T11.6.6.2.1.m1.1.1.1.2.cmml" xref="A3.T11.6.6.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T11.6.6.2.1.m1.1.1.1.3a.cmml" xref="A3.T11.6.6.2.1.m1.1.1.1.3"><mtext id="A3.T11.6.6.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T11.6.6.2.1.m1.1.1.1.3">180d</mtext></ci></apply><ci id="A3.T11.6.6.2.1.m1.1.1.2.cmml" xref="A3.T11.6.6.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.6.6.2.1.m1.1c">\xrightarrow[]{\sim\text{180d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T11.6.6.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 180d end_OVERACCENT → end_ARROW</annotation></semantics></math> 2d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.6.6.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.6.6.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.6.6.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.6.6.6.1" style="background-color:#F0F0F0;">0.49 (0.00+0.49+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T11.6.6.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.6.6.7.1" style="background-color:#F0F0F0;">70.17</span></td>
</tr>
<tr class="ltx_tr" id="A3.T11.9.9" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center" id="A3.T11.9.9.4" style="background-color:#FFFFFF;padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.9.9.4.1" style="background-color:#FFFFFF;"><span class="ltx_text" id="A3.T11.9.9.4.1.1">NQ</span></span></td>
<td class="ltx_td ltx_align_center" id="A3.T11.9.9.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.9.9.5.1" style="background-color:#F0F0F0;">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.7.7.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.7.7.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.7.7.1.1.m1.1"><semantics id="A3.T11.7.7.1.1.m1.1a"><mo id="A3.T11.7.7.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.7.7.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.7.7.1.1.m1.1b"><ci id="A3.T11.7.7.1.1.m1.1.1.cmml" xref="A3.T11.7.7.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.7.7.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.7.7.1.1.m1.1d">→</annotation></semantics></math> 80c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.8.8.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.8.8.2.1" style="background-color:#F0F0F0;">80c <math alttext="\xrightarrow[]{\sim\text{740d}}" class="ltx_Math" display="inline" id="A3.T11.8.8.2.1.m1.1"><semantics id="A3.T11.8.8.2.1.m1.1a"><mover accent="true" id="A3.T11.8.8.2.1.m1.1.1" xref="A3.T11.8.8.2.1.m1.1.1.cmml"><mo id="A3.T11.8.8.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.8.8.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T11.8.8.2.1.m1.1.1.1" xref="A3.T11.8.8.2.1.m1.1.1.1.cmml"><mi id="A3.T11.8.8.2.1.m1.1.1.1.2" xref="A3.T11.8.8.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T11.8.8.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T11.8.8.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T11.8.8.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T11.8.8.2.1.m1.1.1.1.3a.cmml">740d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T11.8.8.2.1.m1.1b"><apply id="A3.T11.8.8.2.1.m1.1.1.cmml" xref="A3.T11.8.8.2.1.m1.1.1"><apply id="A3.T11.8.8.2.1.m1.1.1.1.cmml" xref="A3.T11.8.8.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T11.8.8.2.1.m1.1.1.1.1.cmml" xref="A3.T11.8.8.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T11.8.8.2.1.m1.1.1.1.2.cmml" xref="A3.T11.8.8.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T11.8.8.2.1.m1.1.1.1.3a.cmml" xref="A3.T11.8.8.2.1.m1.1.1.1.3"><mtext id="A3.T11.8.8.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T11.8.8.2.1.m1.1.1.1.3">740d</mtext></ci></apply><ci id="A3.T11.8.8.2.1.m1.1.1.2.cmml" xref="A3.T11.8.8.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.8.8.2.1.m1.1c">\xrightarrow[]{\sim\text{740d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T11.8.8.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 740d end_OVERACCENT → end_ARROW</annotation></semantics></math> 8d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.9.9.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.9.9.3.1" style="background-color:#F0F0F0;">8d <math alttext="\xrightarrow[]{\sim\text{50p}}" class="ltx_Math" display="inline" id="A3.T11.9.9.3.1.m1.1"><semantics id="A3.T11.9.9.3.1.m1.1a"><mover accent="true" id="A3.T11.9.9.3.1.m1.1.1" xref="A3.T11.9.9.3.1.m1.1.1.cmml"><mo id="A3.T11.9.9.3.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.9.9.3.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T11.9.9.3.1.m1.1.1.1" xref="A3.T11.9.9.3.1.m1.1.1.1.cmml"><mi id="A3.T11.9.9.3.1.m1.1.1.1.2" xref="A3.T11.9.9.3.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T11.9.9.3.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T11.9.9.3.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T11.9.9.3.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T11.9.9.3.1.m1.1.1.1.3a.cmml">50p</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T11.9.9.3.1.m1.1b"><apply id="A3.T11.9.9.3.1.m1.1.1.cmml" xref="A3.T11.9.9.3.1.m1.1.1"><apply id="A3.T11.9.9.3.1.m1.1.1.1.cmml" xref="A3.T11.9.9.3.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T11.9.9.3.1.m1.1.1.1.1.cmml" xref="A3.T11.9.9.3.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T11.9.9.3.1.m1.1.1.1.2.cmml" xref="A3.T11.9.9.3.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T11.9.9.3.1.m1.1.1.1.3a.cmml" xref="A3.T11.9.9.3.1.m1.1.1.1.3"><mtext id="A3.T11.9.9.3.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T11.9.9.3.1.m1.1.1.1.3">50p</mtext></ci></apply><ci id="A3.T11.9.9.3.1.m1.1.1.2.cmml" xref="A3.T11.9.9.3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.9.9.3.1.m1.1c">\xrightarrow[]{\sim\text{50p}}</annotation><annotation encoding="application/x-llamapun" id="A3.T11.9.9.3.1.m1.1d">start_ARROW start_OVERACCENT ∼ 50p end_OVERACCENT → end_ARROW</annotation></semantics></math> 2p</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.9.9.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.9.9.6.1" style="background-color:#F0F0F0;">2.97 (0.00+2.20+0.77)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T11.9.9.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.9.9.7.1" style="background-color:#F0F0F0;">71.36</span></td>
</tr>
<tr class="ltx_tr" id="A3.T11.10.10">
<td class="ltx_td ltx_border_t" id="A3.T11.10.10.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T11.10.10.3" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.10.10.3.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T11.10.10.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.10.10.1.m1.1"><semantics id="A3.T11.10.10.1.m1.1a"><mo id="A3.T11.10.10.1.m1.1.1" stretchy="false" xref="A3.T11.10.10.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.10.10.1.m1.1b"><ci id="A3.T11.10.10.1.m1.1.1.cmml" xref="A3.T11.10.10.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.10.10.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.10.10.1.m1.1d">→</annotation></semantics></math> 2p</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T11.10.10.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T11.10.10.5" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T11.10.10.6" style="padding:1.25pt 3.6pt;">5.02 (5.02+N/A+N/A)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T11.10.10.7" style="padding:1.25pt 3.6pt;">68.98</td>
</tr>
<tr class="ltx_tr" id="A3.T11.12.12">
<td class="ltx_td" id="A3.T11.12.12.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T11.11.11.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.11.11.1.m1.1"><semantics id="A3.T11.11.11.1.m1.1a"><mo id="A3.T11.11.11.1.m1.1.1" stretchy="false" xref="A3.T11.11.11.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.11.11.1.m1.1b"><ci id="A3.T11.11.11.1.m1.1.1.cmml" xref="A3.T11.11.11.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.11.11.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.11.11.1.m1.1d">→</annotation></semantics></math> 400p</td>
<td class="ltx_td ltx_align_left" id="A3.T11.12.12.2" style="padding:1.25pt 3.6pt;">400p <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.12.12.2.m1.1"><semantics id="A3.T11.12.12.2.m1.1a"><mo id="A3.T11.12.12.2.m1.1.1" stretchy="false" xref="A3.T11.12.12.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.12.12.2.m1.1b"><ci id="A3.T11.12.12.2.m1.1.1.cmml" xref="A3.T11.12.12.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.12.12.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.12.12.2.m1.1d">→</annotation></semantics></math> 2p</td>
<td class="ltx_td ltx_align_left" id="A3.T11.12.12.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left" id="A3.T11.12.12.5" style="padding:1.25pt 3.6pt;">5.41 (5.02+0.39+N/A)</td>
<td class="ltx_td ltx_align_center" id="A3.T11.12.12.6" style="padding:1.25pt 3.6pt;">77.29</td>
</tr>
<tr class="ltx_tr" id="A3.T11.13.13">
<td class="ltx_td" id="A3.T11.13.13.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T11.13.13.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T11.13.13.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.13.13.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.13.13.1.1.m1.1"><semantics id="A3.T11.13.13.1.1.m1.1a"><mo id="A3.T11.13.13.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.13.13.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.13.13.1.1.m1.1b"><ci id="A3.T11.13.13.1.1.m1.1.1.cmml" xref="A3.T11.13.13.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.13.13.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.13.13.1.1.m1.1d">→</annotation></semantics></math> 2c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.13.13.4" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.13.13.4.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.13.13.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.13.13.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.13.13.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.13.13.6.1" style="background-color:#F0F0F0;">0.00 (0.00+N/A+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T11.13.13.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.13.13.7.1" style="background-color:#F0F0F0;">73.58</span></td>
</tr>
<tr class="ltx_tr" id="A3.T11.15.15">
<td class="ltx_td" id="A3.T11.15.15.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T11.15.15.4" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T11.14.14.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.14.14.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.14.14.1.1.m1.1"><semantics id="A3.T11.14.14.1.1.m1.1a"><mo id="A3.T11.14.14.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.14.14.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.14.14.1.1.m1.1b"><ci id="A3.T11.14.14.1.1.m1.1.1.cmml" xref="A3.T11.14.14.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.14.14.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.14.14.1.1.m1.1d">→</annotation></semantics></math> 20c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.15.15.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.15.15.2.1" style="background-color:#F0F0F0;">20c <math alttext="\xrightarrow[]{\sim\text{200d}}" class="ltx_Math" display="inline" id="A3.T11.15.15.2.1.m1.1"><semantics id="A3.T11.15.15.2.1.m1.1a"><mover accent="true" id="A3.T11.15.15.2.1.m1.1.1" xref="A3.T11.15.15.2.1.m1.1.1.cmml"><mo id="A3.T11.15.15.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.15.15.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T11.15.15.2.1.m1.1.1.1" xref="A3.T11.15.15.2.1.m1.1.1.1.cmml"><mi id="A3.T11.15.15.2.1.m1.1.1.1.2" xref="A3.T11.15.15.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T11.15.15.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T11.15.15.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T11.15.15.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T11.15.15.2.1.m1.1.1.1.3a.cmml">200d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T11.15.15.2.1.m1.1b"><apply id="A3.T11.15.15.2.1.m1.1.1.cmml" xref="A3.T11.15.15.2.1.m1.1.1"><apply id="A3.T11.15.15.2.1.m1.1.1.1.cmml" xref="A3.T11.15.15.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T11.15.15.2.1.m1.1.1.1.1.cmml" xref="A3.T11.15.15.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T11.15.15.2.1.m1.1.1.1.2.cmml" xref="A3.T11.15.15.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T11.15.15.2.1.m1.1.1.1.3a.cmml" xref="A3.T11.15.15.2.1.m1.1.1.1.3"><mtext id="A3.T11.15.15.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T11.15.15.2.1.m1.1.1.1.3">200d</mtext></ci></apply><ci id="A3.T11.15.15.2.1.m1.1.1.2.cmml" xref="A3.T11.15.15.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.15.15.2.1.m1.1c">\xrightarrow[]{\sim\text{200d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T11.15.15.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 200d end_OVERACCENT → end_ARROW</annotation></semantics></math> 2d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.15.15.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.15.15.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T11.15.15.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.15.15.6.1" style="background-color:#F0F0F0;">0.60 (0.00+0.60+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T11.15.15.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.15.15.7.1" style="background-color:#F0F0F0;">77.13</span></td>
</tr>
<tr class="ltx_tr" id="A3.T11.18.18" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T11.18.18.4" style="background-color:#FFFFFF;padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.18.18.4.1" style="background-color:#FFFFFF;"><span class="ltx_text" id="A3.T11.18.18.4.1.1">TQA</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T11.18.18.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.18.18.5.1" style="background-color:#F0F0F0;">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T11.16.16.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.16.16.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T11.16.16.1.1.m1.1"><semantics id="A3.T11.16.16.1.1.m1.1a"><mo id="A3.T11.16.16.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.16.16.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T11.16.16.1.1.m1.1b"><ci id="A3.T11.16.16.1.1.m1.1.1.cmml" xref="A3.T11.16.16.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.16.16.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T11.16.16.1.1.m1.1d">→</annotation></semantics></math> 80c</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T11.17.17.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.17.17.2.1" style="background-color:#F0F0F0;">80c <math alttext="\xrightarrow[]{\sim\text{800d}}" class="ltx_Math" display="inline" id="A3.T11.17.17.2.1.m1.1"><semantics id="A3.T11.17.17.2.1.m1.1a"><mover accent="true" id="A3.T11.17.17.2.1.m1.1.1" xref="A3.T11.17.17.2.1.m1.1.1.cmml"><mo id="A3.T11.17.17.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.17.17.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T11.17.17.2.1.m1.1.1.1" xref="A3.T11.17.17.2.1.m1.1.1.1.cmml"><mi id="A3.T11.17.17.2.1.m1.1.1.1.2" xref="A3.T11.17.17.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T11.17.17.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T11.17.17.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T11.17.17.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T11.17.17.2.1.m1.1.1.1.3a.cmml">800d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T11.17.17.2.1.m1.1b"><apply id="A3.T11.17.17.2.1.m1.1.1.cmml" xref="A3.T11.17.17.2.1.m1.1.1"><apply id="A3.T11.17.17.2.1.m1.1.1.1.cmml" xref="A3.T11.17.17.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T11.17.17.2.1.m1.1.1.1.1.cmml" xref="A3.T11.17.17.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T11.17.17.2.1.m1.1.1.1.2.cmml" xref="A3.T11.17.17.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T11.17.17.2.1.m1.1.1.1.3a.cmml" xref="A3.T11.17.17.2.1.m1.1.1.1.3"><mtext id="A3.T11.17.17.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T11.17.17.2.1.m1.1.1.1.3">800d</mtext></ci></apply><ci id="A3.T11.17.17.2.1.m1.1.1.2.cmml" xref="A3.T11.17.17.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.17.17.2.1.m1.1c">\xrightarrow[]{\sim\text{800d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T11.17.17.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 800d end_OVERACCENT → end_ARROW</annotation></semantics></math> 12d</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T11.18.18.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.18.18.3.1" style="background-color:#F0F0F0;">12d <math alttext="\xrightarrow[]{\sim\text{65p}}" class="ltx_Math" display="inline" id="A3.T11.18.18.3.1.m1.1"><semantics id="A3.T11.18.18.3.1.m1.1a"><mover accent="true" id="A3.T11.18.18.3.1.m1.1.1" xref="A3.T11.18.18.3.1.m1.1.1.cmml"><mo id="A3.T11.18.18.3.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T11.18.18.3.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T11.18.18.3.1.m1.1.1.1" xref="A3.T11.18.18.3.1.m1.1.1.1.cmml"><mi id="A3.T11.18.18.3.1.m1.1.1.1.2" xref="A3.T11.18.18.3.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T11.18.18.3.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T11.18.18.3.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T11.18.18.3.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T11.18.18.3.1.m1.1.1.1.3a.cmml">65p</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T11.18.18.3.1.m1.1b"><apply id="A3.T11.18.18.3.1.m1.1.1.cmml" xref="A3.T11.18.18.3.1.m1.1.1"><apply id="A3.T11.18.18.3.1.m1.1.1.1.cmml" xref="A3.T11.18.18.3.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T11.18.18.3.1.m1.1.1.1.1.cmml" xref="A3.T11.18.18.3.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T11.18.18.3.1.m1.1.1.1.2.cmml" xref="A3.T11.18.18.3.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T11.18.18.3.1.m1.1.1.1.3a.cmml" xref="A3.T11.18.18.3.1.m1.1.1.1.3"><mtext id="A3.T11.18.18.3.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T11.18.18.3.1.m1.1.1.1.3">65p</mtext></ci></apply><ci id="A3.T11.18.18.3.1.m1.1.1.2.cmml" xref="A3.T11.18.18.3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T11.18.18.3.1.m1.1c">\xrightarrow[]{\sim\text{65p}}</annotation><annotation encoding="application/x-llamapun" id="A3.T11.18.18.3.1.m1.1d">start_ARROW start_OVERACCENT ∼ 65p end_OVERACCENT → end_ARROW</annotation></semantics></math> 2p</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T11.18.18.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.18.18.6.1" style="background-color:#F0F0F0;">3.47 (0.00+2.52+0.95)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T11.18.18.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T11.18.18.7.1" style="background-color:#F0F0F0;">78.31</span></td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 11: </span>Retrieval performance comparison (in Top-2) <span class="ltx_text ltx_font_italic" id="A3.T11.20.1">w.r.t.</span> time cost and answer recall on NQ and TQA datasets.</figcaption>
</figure>
<figure class="ltx_table" id="A3.T12">
<table class="ltx_tabular ltx_align_middle" id="A3.T12.18">
<tr class="ltx_tr" id="A3.T12.18.19">
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T12.18.19.1" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T12.18.19.1.1">Datasets</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T12.18.19.2" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T12.18.19.2.1">Retrieval Paradigm</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="A3.T12.18.19.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T12.18.19.3.1">Retrieval Stages</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T12.18.19.4" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.18.19.4.1">
<span class="ltx_tabular ltx_align_middle" id="A3.T12.18.19.4.1.1">
<span class="ltx_tr" id="A3.T12.18.19.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T12.18.19.4.1.1.1.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T12.18.19.4.1.1.1.1.1">Time Cost</span></span></span>
<span class="ltx_tr" id="A3.T12.18.19.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T12.18.19.4.1.1.2.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T12.18.19.4.1.1.2.1.1">(T)</span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T12.18.19.5" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.18.19.5.1">
<span class="ltx_tabular ltx_align_middle" id="A3.T12.18.19.5.1.1">
<span class="ltx_tr" id="A3.T12.18.19.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T12.18.19.5.1.1.1.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T12.18.19.5.1.1.1.1.1">Answer Recall</span></span></span>
<span class="ltx_tr" id="A3.T12.18.19.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T12.18.19.5.1.1.2.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T12.18.19.5.1.1.2.1.1">(AR)</span></span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="A3.T12.18.20">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T12.18.20.1" style="padding:1.25pt 3.6pt;">Retrieval</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T12.18.20.2" style="padding:1.25pt 3.6pt;">Pre/Re-ranking</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T12.18.20.3" style="padding:1.25pt 3.6pt;">Post-ranking</td>
</tr>
<tr class="ltx_tr" id="A3.T12.1.1">
<td class="ltx_td ltx_border_t" id="A3.T12.1.1.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T12.1.1.3" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.1.1.3.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T12.1.1.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.1.1.1.m1.1"><semantics id="A3.T12.1.1.1.m1.1a"><mo id="A3.T12.1.1.1.m1.1.1" stretchy="false" xref="A3.T12.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.1.1.1.m1.1b"><ci id="A3.T12.1.1.1.m1.1.1.cmml" xref="A3.T12.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.1.1.1.m1.1d">→</annotation></semantics></math> 3p</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T12.1.1.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T12.1.1.5" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T12.1.1.6" style="padding:1.25pt 3.6pt;">4.90 (4.90+N/A+N/A)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T12.1.1.7" style="padding:1.25pt 3.6pt;">69.64</td>
</tr>
<tr class="ltx_tr" id="A3.T12.3.3">
<td class="ltx_td" id="A3.T12.3.3.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T12.2.2.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.2.2.1.m1.1"><semantics id="A3.T12.2.2.1.m1.1a"><mo id="A3.T12.2.2.1.m1.1.1" stretchy="false" xref="A3.T12.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.2.2.1.m1.1b"><ci id="A3.T12.2.2.1.m1.1.1.cmml" xref="A3.T12.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.2.2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.2.2.1.m1.1d">→</annotation></semantics></math> 400p</td>
<td class="ltx_td ltx_align_left" id="A3.T12.3.3.2" style="padding:1.25pt 3.6pt;">400p <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.3.3.2.m1.1"><semantics id="A3.T12.3.3.2.m1.1a"><mo id="A3.T12.3.3.2.m1.1.1" stretchy="false" xref="A3.T12.3.3.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.3.3.2.m1.1b"><ci id="A3.T12.3.3.2.m1.1.1.cmml" xref="A3.T12.3.3.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.3.3.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.3.3.2.m1.1d">→</annotation></semantics></math> 3p</td>
<td class="ltx_td ltx_align_left" id="A3.T12.3.3.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left" id="A3.T12.3.3.5" style="padding:1.25pt 3.6pt;">5.25 (4.90+0.35+N/A)</td>
<td class="ltx_td ltx_align_center" id="A3.T12.3.3.6" style="padding:1.25pt 3.6pt;">72.83</td>
</tr>
<tr class="ltx_tr" id="A3.T12.4.4">
<td class="ltx_td" id="A3.T12.4.4.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T12.4.4.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T12.4.4.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.4.4.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.4.4.1.1.m1.1"><semantics id="A3.T12.4.4.1.1.m1.1a"><mo id="A3.T12.4.4.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.4.4.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.4.4.1.1.m1.1b"><ci id="A3.T12.4.4.1.1.m1.1.1.cmml" xref="A3.T12.4.4.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.4.4.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.4.4.1.1.m1.1d">→</annotation></semantics></math> 3c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.4.4.4" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.4.4.4.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.4.4.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.4.4.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.4.4.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.4.4.6.1" style="background-color:#F0F0F0;">0.00 (0.00+N/A+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T12.4.4.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.4.4.7.1" style="background-color:#F0F0F0;">68.98</span></td>
</tr>
<tr class="ltx_tr" id="A3.T12.6.6">
<td class="ltx_td" id="A3.T12.6.6.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T12.6.6.4" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T12.5.5.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.5.5.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.5.5.1.1.m1.1"><semantics id="A3.T12.5.5.1.1.m1.1a"><mo id="A3.T12.5.5.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.5.5.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.5.5.1.1.m1.1b"><ci id="A3.T12.5.5.1.1.m1.1.1.cmml" xref="A3.T12.5.5.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.5.5.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.5.5.1.1.m1.1d">→</annotation></semantics></math> 20c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.6.6.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.6.6.2.1" style="background-color:#F0F0F0;">20c <math alttext="\xrightarrow[]{\sim\text{180d}}" class="ltx_Math" display="inline" id="A3.T12.6.6.2.1.m1.1"><semantics id="A3.T12.6.6.2.1.m1.1a"><mover accent="true" id="A3.T12.6.6.2.1.m1.1.1" xref="A3.T12.6.6.2.1.m1.1.1.cmml"><mo id="A3.T12.6.6.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.6.6.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T12.6.6.2.1.m1.1.1.1" xref="A3.T12.6.6.2.1.m1.1.1.1.cmml"><mi id="A3.T12.6.6.2.1.m1.1.1.1.2" xref="A3.T12.6.6.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T12.6.6.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T12.6.6.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T12.6.6.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T12.6.6.2.1.m1.1.1.1.3a.cmml">180d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T12.6.6.2.1.m1.1b"><apply id="A3.T12.6.6.2.1.m1.1.1.cmml" xref="A3.T12.6.6.2.1.m1.1.1"><apply id="A3.T12.6.6.2.1.m1.1.1.1.cmml" xref="A3.T12.6.6.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T12.6.6.2.1.m1.1.1.1.1.cmml" xref="A3.T12.6.6.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T12.6.6.2.1.m1.1.1.1.2.cmml" xref="A3.T12.6.6.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T12.6.6.2.1.m1.1.1.1.3a.cmml" xref="A3.T12.6.6.2.1.m1.1.1.1.3"><mtext id="A3.T12.6.6.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T12.6.6.2.1.m1.1.1.1.3">180d</mtext></ci></apply><ci id="A3.T12.6.6.2.1.m1.1.1.2.cmml" xref="A3.T12.6.6.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.6.6.2.1.m1.1c">\xrightarrow[]{\sim\text{180d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T12.6.6.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 180d end_OVERACCENT → end_ARROW</annotation></semantics></math> 3d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.6.6.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.6.6.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.6.6.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.6.6.6.1" style="background-color:#F0F0F0;">0.49 (0.00+0.49+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T12.6.6.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.6.6.7.1" style="background-color:#F0F0F0;">72.71</span></td>
</tr>
<tr class="ltx_tr" id="A3.T12.9.9" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center" id="A3.T12.9.9.4" style="background-color:#FFFFFF;padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.9.9.4.1" style="background-color:#FFFFFF;"><span class="ltx_text" id="A3.T12.9.9.4.1.1">NQ</span></span></td>
<td class="ltx_td ltx_align_center" id="A3.T12.9.9.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.9.9.5.1" style="background-color:#F0F0F0;">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.7.7.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.7.7.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.7.7.1.1.m1.1"><semantics id="A3.T12.7.7.1.1.m1.1a"><mo id="A3.T12.7.7.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.7.7.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.7.7.1.1.m1.1b"><ci id="A3.T12.7.7.1.1.m1.1.1.cmml" xref="A3.T12.7.7.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.7.7.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.7.7.1.1.m1.1d">→</annotation></semantics></math> 80c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.8.8.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.8.8.2.1" style="background-color:#F0F0F0;">80c <math alttext="\xrightarrow[]{\sim\text{740d}}" class="ltx_Math" display="inline" id="A3.T12.8.8.2.1.m1.1"><semantics id="A3.T12.8.8.2.1.m1.1a"><mover accent="true" id="A3.T12.8.8.2.1.m1.1.1" xref="A3.T12.8.8.2.1.m1.1.1.cmml"><mo id="A3.T12.8.8.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.8.8.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T12.8.8.2.1.m1.1.1.1" xref="A3.T12.8.8.2.1.m1.1.1.1.cmml"><mi id="A3.T12.8.8.2.1.m1.1.1.1.2" xref="A3.T12.8.8.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T12.8.8.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T12.8.8.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T12.8.8.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T12.8.8.2.1.m1.1.1.1.3a.cmml">740d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T12.8.8.2.1.m1.1b"><apply id="A3.T12.8.8.2.1.m1.1.1.cmml" xref="A3.T12.8.8.2.1.m1.1.1"><apply id="A3.T12.8.8.2.1.m1.1.1.1.cmml" xref="A3.T12.8.8.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T12.8.8.2.1.m1.1.1.1.1.cmml" xref="A3.T12.8.8.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T12.8.8.2.1.m1.1.1.1.2.cmml" xref="A3.T12.8.8.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T12.8.8.2.1.m1.1.1.1.3a.cmml" xref="A3.T12.8.8.2.1.m1.1.1.1.3"><mtext id="A3.T12.8.8.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T12.8.8.2.1.m1.1.1.1.3">740d</mtext></ci></apply><ci id="A3.T12.8.8.2.1.m1.1.1.2.cmml" xref="A3.T12.8.8.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.8.8.2.1.m1.1c">\xrightarrow[]{\sim\text{740d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T12.8.8.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 740d end_OVERACCENT → end_ARROW</annotation></semantics></math> 8d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.9.9.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.9.9.3.1" style="background-color:#F0F0F0;">8d <math alttext="\xrightarrow[]{\sim\text{50p}}" class="ltx_Math" display="inline" id="A3.T12.9.9.3.1.m1.1"><semantics id="A3.T12.9.9.3.1.m1.1a"><mover accent="true" id="A3.T12.9.9.3.1.m1.1.1" xref="A3.T12.9.9.3.1.m1.1.1.cmml"><mo id="A3.T12.9.9.3.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.9.9.3.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T12.9.9.3.1.m1.1.1.1" xref="A3.T12.9.9.3.1.m1.1.1.1.cmml"><mi id="A3.T12.9.9.3.1.m1.1.1.1.2" xref="A3.T12.9.9.3.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T12.9.9.3.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T12.9.9.3.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T12.9.9.3.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T12.9.9.3.1.m1.1.1.1.3a.cmml">50p</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T12.9.9.3.1.m1.1b"><apply id="A3.T12.9.9.3.1.m1.1.1.cmml" xref="A3.T12.9.9.3.1.m1.1.1"><apply id="A3.T12.9.9.3.1.m1.1.1.1.cmml" xref="A3.T12.9.9.3.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T12.9.9.3.1.m1.1.1.1.1.cmml" xref="A3.T12.9.9.3.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T12.9.9.3.1.m1.1.1.1.2.cmml" xref="A3.T12.9.9.3.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T12.9.9.3.1.m1.1.1.1.3a.cmml" xref="A3.T12.9.9.3.1.m1.1.1.1.3"><mtext id="A3.T12.9.9.3.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T12.9.9.3.1.m1.1.1.1.3">50p</mtext></ci></apply><ci id="A3.T12.9.9.3.1.m1.1.1.2.cmml" xref="A3.T12.9.9.3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.9.9.3.1.m1.1c">\xrightarrow[]{\sim\text{50p}}</annotation><annotation encoding="application/x-llamapun" id="A3.T12.9.9.3.1.m1.1d">start_ARROW start_OVERACCENT ∼ 50p end_OVERACCENT → end_ARROW</annotation></semantics></math> 3p</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.9.9.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.9.9.6.1" style="background-color:#F0F0F0;">2.97 (0.00+2.20+0.77)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T12.9.9.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.9.9.7.1" style="background-color:#F0F0F0;">73.88</span></td>
</tr>
<tr class="ltx_tr" id="A3.T12.10.10">
<td class="ltx_td ltx_border_t" id="A3.T12.10.10.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T12.10.10.3" rowspan="2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.10.10.3.1">Flat Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T12.10.10.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.10.10.1.m1.1"><semantics id="A3.T12.10.10.1.m1.1a"><mo id="A3.T12.10.10.1.m1.1.1" stretchy="false" xref="A3.T12.10.10.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.10.10.1.m1.1b"><ci id="A3.T12.10.10.1.m1.1.1.cmml" xref="A3.T12.10.10.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.10.10.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.10.10.1.m1.1d">→</annotation></semantics></math> 3p</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T12.10.10.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T12.10.10.5" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T12.10.10.6" style="padding:1.25pt 3.6pt;">5.02 (5.02+N/A+N/A)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T12.10.10.7" style="padding:1.25pt 3.6pt;">73.11</td>
</tr>
<tr class="ltx_tr" id="A3.T12.12.12">
<td class="ltx_td" id="A3.T12.12.12.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T12.11.11.1" style="padding:1.25pt 3.6pt;">21M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.11.11.1.m1.1"><semantics id="A3.T12.11.11.1.m1.1a"><mo id="A3.T12.11.11.1.m1.1.1" stretchy="false" xref="A3.T12.11.11.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.11.11.1.m1.1b"><ci id="A3.T12.11.11.1.m1.1.1.cmml" xref="A3.T12.11.11.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.11.11.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.11.11.1.m1.1d">→</annotation></semantics></math> 400p</td>
<td class="ltx_td ltx_align_left" id="A3.T12.12.12.2" style="padding:1.25pt 3.6pt;">400p <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.12.12.2.m1.1"><semantics id="A3.T12.12.12.2.m1.1a"><mo id="A3.T12.12.12.2.m1.1.1" stretchy="false" xref="A3.T12.12.12.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.12.12.2.m1.1b"><ci id="A3.T12.12.12.2.m1.1.1.cmml" xref="A3.T12.12.12.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.12.12.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.12.12.2.m1.1d">→</annotation></semantics></math> 3p</td>
<td class="ltx_td ltx_align_left" id="A3.T12.12.12.4" style="padding:1.25pt 3.6pt;">N/A</td>
<td class="ltx_td ltx_align_left" id="A3.T12.12.12.5" style="padding:1.25pt 3.6pt;">5.41 (5.02+0.39+N/A)</td>
<td class="ltx_td ltx_align_center" id="A3.T12.12.12.6" style="padding:1.25pt 3.6pt;">79.88</td>
</tr>
<tr class="ltx_tr" id="A3.T12.13.13">
<td class="ltx_td" id="A3.T12.13.13.2" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T12.13.13.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T12.13.13.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.13.13.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.13.13.1.1.m1.1"><semantics id="A3.T12.13.13.1.1.m1.1a"><mo id="A3.T12.13.13.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.13.13.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.13.13.1.1.m1.1b"><ci id="A3.T12.13.13.1.1.m1.1.1.cmml" xref="A3.T12.13.13.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.13.13.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.13.13.1.1.m1.1d">→</annotation></semantics></math> 3c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.13.13.4" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.13.13.4.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.13.13.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.13.13.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.13.13.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.13.13.6.1" style="background-color:#F0F0F0;">0.00 (0.00+N/A+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T12.13.13.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.13.13.7.1" style="background-color:#F0F0F0;">76.96</span></td>
</tr>
<tr class="ltx_tr" id="A3.T12.15.15">
<td class="ltx_td" id="A3.T12.15.15.3" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td" id="A3.T12.15.15.4" style="padding:1.25pt 3.6pt;"></td>
<td class="ltx_td ltx_align_left" id="A3.T12.14.14.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.14.14.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.14.14.1.1.m1.1"><semantics id="A3.T12.14.14.1.1.m1.1a"><mo id="A3.T12.14.14.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.14.14.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.14.14.1.1.m1.1b"><ci id="A3.T12.14.14.1.1.m1.1.1.cmml" xref="A3.T12.14.14.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.14.14.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.14.14.1.1.m1.1d">→</annotation></semantics></math> 20c</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.15.15.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.15.15.2.1" style="background-color:#F0F0F0;">20c <math alttext="\xrightarrow[]{\sim\text{200d}}" class="ltx_Math" display="inline" id="A3.T12.15.15.2.1.m1.1"><semantics id="A3.T12.15.15.2.1.m1.1a"><mover accent="true" id="A3.T12.15.15.2.1.m1.1.1" xref="A3.T12.15.15.2.1.m1.1.1.cmml"><mo id="A3.T12.15.15.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.15.15.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T12.15.15.2.1.m1.1.1.1" xref="A3.T12.15.15.2.1.m1.1.1.1.cmml"><mi id="A3.T12.15.15.2.1.m1.1.1.1.2" xref="A3.T12.15.15.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T12.15.15.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T12.15.15.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T12.15.15.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T12.15.15.2.1.m1.1.1.1.3a.cmml">200d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T12.15.15.2.1.m1.1b"><apply id="A3.T12.15.15.2.1.m1.1.1.cmml" xref="A3.T12.15.15.2.1.m1.1.1"><apply id="A3.T12.15.15.2.1.m1.1.1.1.cmml" xref="A3.T12.15.15.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T12.15.15.2.1.m1.1.1.1.1.cmml" xref="A3.T12.15.15.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T12.15.15.2.1.m1.1.1.1.2.cmml" xref="A3.T12.15.15.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T12.15.15.2.1.m1.1.1.1.3a.cmml" xref="A3.T12.15.15.2.1.m1.1.1.1.3"><mtext id="A3.T12.15.15.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T12.15.15.2.1.m1.1.1.1.3">200d</mtext></ci></apply><ci id="A3.T12.15.15.2.1.m1.1.1.2.cmml" xref="A3.T12.15.15.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.15.15.2.1.m1.1c">\xrightarrow[]{\sim\text{200d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T12.15.15.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 200d end_OVERACCENT → end_ARROW</annotation></semantics></math> 3d</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.15.15.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.15.15.5.1" style="background-color:#F0F0F0;">N/A</span></td>
<td class="ltx_td ltx_align_left" id="A3.T12.15.15.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.15.15.6.1" style="background-color:#F0F0F0;">0.60 (0.00+0.60+N/A)</span></td>
<td class="ltx_td ltx_align_center" id="A3.T12.15.15.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.15.15.7.1" style="background-color:#F0F0F0;">79.04</span></td>
</tr>
<tr class="ltx_tr" id="A3.T12.18.18" style="background-color:#F0F0F0;">
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T12.18.18.4" style="background-color:#FFFFFF;padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.18.18.4.1" style="background-color:#FFFFFF;"><span class="ltx_text" id="A3.T12.18.18.4.1.1">TQA</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T12.18.18.5" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.18.18.5.1" style="background-color:#F0F0F0;">Progressive Retrieval</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T12.16.16.1" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.16.16.1.1" style="background-color:#F0F0F0;">600K <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T12.16.16.1.1.m1.1"><semantics id="A3.T12.16.16.1.1.m1.1a"><mo id="A3.T12.16.16.1.1.m1.1.1" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.16.16.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T12.16.16.1.1.m1.1b"><ci id="A3.T12.16.16.1.1.m1.1.1.cmml" xref="A3.T12.16.16.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.16.16.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T12.16.16.1.1.m1.1d">→</annotation></semantics></math> 80c</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T12.17.17.2" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.17.17.2.1" style="background-color:#F0F0F0;">80c <math alttext="\xrightarrow[]{\sim\text{800d}}" class="ltx_Math" display="inline" id="A3.T12.17.17.2.1.m1.1"><semantics id="A3.T12.17.17.2.1.m1.1a"><mover accent="true" id="A3.T12.17.17.2.1.m1.1.1" xref="A3.T12.17.17.2.1.m1.1.1.cmml"><mo id="A3.T12.17.17.2.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.17.17.2.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T12.17.17.2.1.m1.1.1.1" xref="A3.T12.17.17.2.1.m1.1.1.1.cmml"><mi id="A3.T12.17.17.2.1.m1.1.1.1.2" xref="A3.T12.17.17.2.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T12.17.17.2.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T12.17.17.2.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T12.17.17.2.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T12.17.17.2.1.m1.1.1.1.3a.cmml">800d</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T12.17.17.2.1.m1.1b"><apply id="A3.T12.17.17.2.1.m1.1.1.cmml" xref="A3.T12.17.17.2.1.m1.1.1"><apply id="A3.T12.17.17.2.1.m1.1.1.1.cmml" xref="A3.T12.17.17.2.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T12.17.17.2.1.m1.1.1.1.1.cmml" xref="A3.T12.17.17.2.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T12.17.17.2.1.m1.1.1.1.2.cmml" xref="A3.T12.17.17.2.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T12.17.17.2.1.m1.1.1.1.3a.cmml" xref="A3.T12.17.17.2.1.m1.1.1.1.3"><mtext id="A3.T12.17.17.2.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T12.17.17.2.1.m1.1.1.1.3">800d</mtext></ci></apply><ci id="A3.T12.17.17.2.1.m1.1.1.2.cmml" xref="A3.T12.17.17.2.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.17.17.2.1.m1.1c">\xrightarrow[]{\sim\text{800d}}</annotation><annotation encoding="application/x-llamapun" id="A3.T12.17.17.2.1.m1.1d">start_ARROW start_OVERACCENT ∼ 800d end_OVERACCENT → end_ARROW</annotation></semantics></math> 12d</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T12.18.18.3" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.18.18.3.1" style="background-color:#F0F0F0;">12d <math alttext="\xrightarrow[]{\sim\text{65p}}" class="ltx_Math" display="inline" id="A3.T12.18.18.3.1.m1.1"><semantics id="A3.T12.18.18.3.1.m1.1a"><mover accent="true" id="A3.T12.18.18.3.1.m1.1.1" xref="A3.T12.18.18.3.1.m1.1.1.cmml"><mo id="A3.T12.18.18.3.1.m1.1.1.2" mathbackground="#F0F0F0" stretchy="false" xref="A3.T12.18.18.3.1.m1.1.1.2.cmml">→</mo><mrow id="A3.T12.18.18.3.1.m1.1.1.1" xref="A3.T12.18.18.3.1.m1.1.1.1.cmml"><mi id="A3.T12.18.18.3.1.m1.1.1.1.2" xref="A3.T12.18.18.3.1.m1.1.1.1.2.cmml"></mi><mo id="A3.T12.18.18.3.1.m1.1.1.1.1" mathbackground="#F0F0F0" xref="A3.T12.18.18.3.1.m1.1.1.1.1.cmml">∼</mo><mtext id="A3.T12.18.18.3.1.m1.1.1.1.3" mathbackground="#F0F0F0" xref="A3.T12.18.18.3.1.m1.1.1.1.3a.cmml">65p</mtext></mrow></mover><annotation-xml encoding="MathML-Content" id="A3.T12.18.18.3.1.m1.1b"><apply id="A3.T12.18.18.3.1.m1.1.1.cmml" xref="A3.T12.18.18.3.1.m1.1.1"><apply id="A3.T12.18.18.3.1.m1.1.1.1.cmml" xref="A3.T12.18.18.3.1.m1.1.1.1"><csymbol cd="latexml" id="A3.T12.18.18.3.1.m1.1.1.1.1.cmml" xref="A3.T12.18.18.3.1.m1.1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="A3.T12.18.18.3.1.m1.1.1.1.2.cmml" xref="A3.T12.18.18.3.1.m1.1.1.1.2">absent</csymbol><ci id="A3.T12.18.18.3.1.m1.1.1.1.3a.cmml" xref="A3.T12.18.18.3.1.m1.1.1.1.3"><mtext id="A3.T12.18.18.3.1.m1.1.1.1.3.cmml" mathbackground="#F0F0F0" xref="A3.T12.18.18.3.1.m1.1.1.1.3">65p</mtext></ci></apply><ci id="A3.T12.18.18.3.1.m1.1.1.2.cmml" xref="A3.T12.18.18.3.1.m1.1.1.2">→</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T12.18.18.3.1.m1.1c">\xrightarrow[]{\sim\text{65p}}</annotation><annotation encoding="application/x-llamapun" id="A3.T12.18.18.3.1.m1.1d">start_ARROW start_OVERACCENT ∼ 65p end_OVERACCENT → end_ARROW</annotation></semantics></math> 3p</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A3.T12.18.18.6" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.18.18.6.1" style="background-color:#F0F0F0;">3.47 (0.00+2.52+0.95)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T12.18.18.7" style="padding:1.25pt 3.6pt;"><span class="ltx_text" id="A3.T12.18.18.7.1" style="background-color:#F0F0F0;">79.83</span></td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 12: </span>Retrieval performance comparison (in Top-3) <span class="ltx_text ltx_font_italic" id="A3.T12.20.1">w.r.t.</span> time cost and answer recall on NQ and TQA datasets.</figcaption>
</figure>
<figure class="ltx_table" id="A3.T13">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T13.1">
<tr class="ltx_tr" id="A3.T13.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A3.T13.1.1.1" style="padding-top:2pt;padding-bottom:2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T13.1.1.1.1">
<span class="ltx_p" id="A3.T13.1.1.1.1.1" style="width:416.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T13.1.1.1.1.1.1">Question:</span> Who won the fifth season of America’s Got Talent?</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T13.1.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A3.T13.1.2.1" style="padding-top:2pt;padding-bottom:2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T13.1.2.1.1">
<span class="ltx_p" id="A3.T13.1.2.1.1.1" style="width:416.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T13.1.2.1.1.1.1">Answer:</span> [“Soul singer Michael Grimm”, “Michael Grimm”]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T13.1.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A3.T13.1.3.1" style="padding-top:2pt;padding-bottom:2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T13.1.3.1.1">
<span class="ltx_p" id="A3.T13.1.3.1.1.1" style="width:416.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T13.1.3.1.1.1.1">(1) Retrieval Stage (clustered documents):</span> (…, Miss Kansas USA, America’s Got Talent (season 9), Hurricane (Nick Fradiani album), …); (…, Preacher Lawson, <span class="ltx_text ltx_font_bold" id="A3.T13.1.3.1.1.1.2" style="color:#00A000;">America’s Got Talent</span>, Jodi Miller, …); (…, Kite line, <span class="ltx_text ltx_font_bold" id="A3.T13.1.3.1.1.1.3" style="color:#00A000;">Michael Grimm (album)</span>, <span class="ltx_text ltx_font_bold" id="A3.T13.1.3.1.1.1.4" style="color:#00A000;">America’s Got Talent (season 5)</span>, <span class="ltx_text ltx_font_bold" id="A3.T13.1.3.1.1.1.5" style="color:#00A000;">Michael Grimm (musician)</span>, Connor Doran, …); (America’s Got Talent (season 4), Kevin Skinner, The Spiritual Harmonizers, …) ……</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T13.1.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A3.T13.1.4.1" style="padding-top:2pt;padding-bottom:2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T13.1.4.1.1">
<span class="ltx_p" id="A3.T13.1.4.1.1.1" style="width:416.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T13.1.4.1.1.1.1">(2) Pre-ranking Stage (documents):</span> <span class="ltx_text ltx_font_bold" id="A3.T13.1.4.1.1.1.2" style="color:#00A000;">America’s Got Talent (season 5)</span>; <span class="ltx_text ltx_font_bold" id="A3.T13.1.4.1.1.1.3" style="color:#00A000;">Michael Grimm (musician)</span>; America’s Got Talent (season 12); America’s Got Talent (season 13); <span class="ltx_text ltx_font_bold" id="A3.T13.1.4.1.1.1.4" style="color:#00A000;">America’s Got Talent</span>; Got Talent; America’s Got Talent (season 9) ……</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T13.1.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A3.T13.1.5.1" style="padding-top:2pt;padding-bottom:2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T13.1.5.1.1">
<span class="ltx_p" id="A3.T13.1.5.1.1.1" style="width:416.3pt;"><span class="ltx_text ltx_font_bold" id="A3.T13.1.5.1.1.1.1">(3) Post-ranking Stage (passages):</span> <span class="ltx_text ltx_font_bold" id="A3.T13.1.5.1.1.1.2" style="color:#00A000;">America’s Got Talent (season 5)</span>; <span class="ltx_text ltx_font_bold" id="A3.T13.1.5.1.1.1.3" style="color:#00A000;">Michael Grimm (musician)</span>; America’s Got Talent; <span class="ltx_text ltx_font_bold" id="A3.T13.1.5.1.1.1.4" style="color:#00A000;">America’s Got Talent (season 5)</span>.</span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 13: </span>An example of <span class="ltx_text ltx_font_smallcaps" id="A3.T13.4.1">FunnelRAG</span>’s data flow from NQ dataset, where the retrieved information that contains the answer string is marked in <span class="ltx_text ltx_font_bold" id="A3.T13.5.2" style="color:#00A000;">green</span>. Note  that  we  only  present  the  title  of  the  retrieved information for brevity.</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A3.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="A3.F6.sf1.g1" src="extracted/5924118/figures/rep_token_top1.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Impact of #rep tokens (in Top-1).</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A3.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="A3.F6.sf2.g1" src="extracted/5924118/figures/rep_token_top2.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Impact of #rep tokens (in Top-2).</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A3.F6.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="A3.F6.sf3.g1" src="extracted/5924118/figures/rep_token_top3.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Impact of #rep tokens (in Top-3).</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Answer recall comparison (in Top-1, Top-2, and Top-3) of <span class="ltx_text ltx_font_smallcaps" id="A3.F6.2.1">FunnelRAG</span> in terms of different numbers of representative tokens. #Rep tokens is the abbreviation of “the number of  representative  tokens”.</figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Cluster Document Algorithm</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#alg1" title="Algorithm 1 ‣ Appendix D Cluster Document Algorithm ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">1</span></a> shows the document clustering algorithm used in the retrieval stage (§<a class="ltx_ref" href="https://arxiv.org/html/2410.10293v1#S3.SS1.SSS1" title="3.1.1 Retrieval Stage ‣ 3.1 Coarse-to-Fine Progressive Retrieval ‣ 3 Methodology ‣ FunnelRAG: A Coarse-to-Fine Progressive Retrieval Paradigm for RAG"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>). Simply put, documents that are highly relevant will be clustered together, where each cluster is a list of documents related to each other. And, the clustered documents serve as the coarse-grained retrieval units.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Cluster Document Algorithm</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">caligraphic_D</annotation></semantics></math> (documents), <math alttext="S" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_S</annotation></semantics></math> (max cluster size), <math alttext="\text{adj}[d]" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.2" xref="alg1.l1.m3.1.2.cmml"><mtext id="alg1.l1.m3.1.2.2" xref="alg1.l1.m3.1.2.2a.cmml">adj</mtext><mo id="alg1.l1.m3.1.2.1" xref="alg1.l1.m3.1.2.1.cmml">⁢</mo><mrow id="alg1.l1.m3.1.2.3.2" xref="alg1.l1.m3.1.2.3.1.cmml"><mo id="alg1.l1.m3.1.2.3.2.1" stretchy="false" xref="alg1.l1.m3.1.2.3.1.1.cmml">[</mo><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">d</mi><mo id="alg1.l1.m3.1.2.3.2.2" stretchy="false" xref="alg1.l1.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.2.cmml" xref="alg1.l1.m3.1.2"><times id="alg1.l1.m3.1.2.1.cmml" xref="alg1.l1.m3.1.2.1"></times><ci id="alg1.l1.m3.1.2.2a.cmml" xref="alg1.l1.m3.1.2.2"><mtext id="alg1.l1.m3.1.2.2.cmml" xref="alg1.l1.m3.1.2.2">adj</mtext></ci><apply id="alg1.l1.m3.1.2.3.1.cmml" xref="alg1.l1.m3.1.2.3.2"><csymbol cd="latexml" id="alg1.l1.m3.1.2.3.1.1.cmml" xref="alg1.l1.m3.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\text{adj}[d]</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">adj [ italic_d ]</annotation></semantics></math> (related documents for each <math alttext="d" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_d</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">caligraphic_C</annotation></semantics></math> (set of clusters)

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Sort <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">caligraphic_D</annotation></semantics></math> by their local cluster coefficient;

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Initialize an empty set of clusters <math alttext="\mathcal{C}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">𝒞</mi><mo id="alg1.l4.m1.1.1.1" stretchy="false" xref="alg1.l4.m1.1.1.1.cmml">←</mo><mi id="alg1.l4.m1.1.1.3" mathvariant="normal" xref="alg1.l4.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝒞</ci><emptyset id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathcal{C}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">caligraphic_C ← ∅</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span><span class="ltx_text ltx_font_bold" id="alg1.l5.1">for</span> each document <math alttext="d" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_d</annotation></semantics></math> in <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">caligraphic_D</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l5.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     Add <math alttext="\{d\}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.1.cmml"><mo id="alg1.l6.m1.1.2.2.1" stretchy="false" xref="alg1.l6.m1.1.2.1.cmml">{</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">d</mi><mo id="alg1.l6.m1.1.2.2.2" stretchy="false" xref="alg1.l6.m1.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><set id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2.2"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑑</ci></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\{d\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">{ italic_d }</annotation></semantics></math> to <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">caligraphic_C</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span><span class="ltx_text ltx_font_bold" id="alg1.l7.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span><span class="ltx_text ltx_font_bold" id="alg1.l8.1">for</span> each document <math alttext="d" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_d</annotation></semantics></math> in <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">caligraphic_D</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     Remove <math alttext="\{d\}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.2.2" xref="alg1.l9.m1.1.2.1.cmml"><mo id="alg1.l9.m1.1.2.2.1" stretchy="false" xref="alg1.l9.m1.1.2.1.cmml">{</mo><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">d</mi><mo id="alg1.l9.m1.1.2.2.2" stretchy="false" xref="alg1.l9.m1.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><set id="alg1.l9.m1.1.2.1.cmml" xref="alg1.l9.m1.1.2.2"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑑</ci></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\{d\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">{ italic_d }</annotation></semantics></math> from <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">caligraphic_C</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math alttext="\mathcal{R}\leftarrow\textsc{find\_related\_cluster}(d,\mathcal{C})" class="ltx_Math" display="inline" id="alg1.l10.m1.2"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.3" xref="alg1.l10.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.2.3.2" xref="alg1.l10.m1.2.3.2.cmml">ℛ</mi><mo id="alg1.l10.m1.2.3.1" stretchy="false" xref="alg1.l10.m1.2.3.1.cmml">←</mo><mrow id="alg1.l10.m1.2.3.3" xref="alg1.l10.m1.2.3.3.cmml"><mtext class="ltx_font_smallcaps" id="alg1.l10.m1.2.3.3.2" xref="alg1.l10.m1.2.3.3.2a.cmml">find_related_cluster</mtext><mo id="alg1.l10.m1.2.3.3.1" xref="alg1.l10.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l10.m1.2.3.3.3.2" xref="alg1.l10.m1.2.3.3.3.1.cmml"><mo id="alg1.l10.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l10.m1.2.3.3.3.1.cmml">(</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">d</mi><mo id="alg1.l10.m1.2.3.3.3.2.2" xref="alg1.l10.m1.2.3.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml">𝒞</mi><mo id="alg1.l10.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l10.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.3.cmml" xref="alg1.l10.m1.2.3"><ci id="alg1.l10.m1.2.3.1.cmml" xref="alg1.l10.m1.2.3.1">←</ci><ci id="alg1.l10.m1.2.3.2.cmml" xref="alg1.l10.m1.2.3.2">ℛ</ci><apply id="alg1.l10.m1.2.3.3.cmml" xref="alg1.l10.m1.2.3.3"><times id="alg1.l10.m1.2.3.3.1.cmml" xref="alg1.l10.m1.2.3.3.1"></times><ci id="alg1.l10.m1.2.3.3.2a.cmml" xref="alg1.l10.m1.2.3.3.2"><mtext class="ltx_font_smallcaps" id="alg1.l10.m1.2.3.3.2.cmml" xref="alg1.l10.m1.2.3.3.2">find_related_cluster</mtext></ci><interval closure="open" id="alg1.l10.m1.2.3.3.3.1.cmml" xref="alg1.l10.m1.2.3.3.3.2"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑑</ci><ci id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2">𝒞</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">\mathcal{R}\leftarrow\textsc{find\_related\_cluster}(d,\mathcal{C})</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.2d">caligraphic_R ← find_related_cluster ( italic_d , caligraphic_C )</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     Create a new cluster <math alttext="c_{\text{new}}=\{d\}" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.2" xref="alg1.l11.m1.1.2.cmml"><msub id="alg1.l11.m1.1.2.2" xref="alg1.l11.m1.1.2.2.cmml"><mi id="alg1.l11.m1.1.2.2.2" xref="alg1.l11.m1.1.2.2.2.cmml">c</mi><mtext id="alg1.l11.m1.1.2.2.3" xref="alg1.l11.m1.1.2.2.3a.cmml">new</mtext></msub><mo id="alg1.l11.m1.1.2.1" xref="alg1.l11.m1.1.2.1.cmml">=</mo><mrow id="alg1.l11.m1.1.2.3.2" xref="alg1.l11.m1.1.2.3.1.cmml"><mo id="alg1.l11.m1.1.2.3.2.1" stretchy="false" xref="alg1.l11.m1.1.2.3.1.cmml">{</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">d</mi><mo id="alg1.l11.m1.1.2.3.2.2" stretchy="false" xref="alg1.l11.m1.1.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.2.cmml" xref="alg1.l11.m1.1.2"><eq id="alg1.l11.m1.1.2.1.cmml" xref="alg1.l11.m1.1.2.1"></eq><apply id="alg1.l11.m1.1.2.2.cmml" xref="alg1.l11.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.2.2.1.cmml" xref="alg1.l11.m1.1.2.2">subscript</csymbol><ci id="alg1.l11.m1.1.2.2.2.cmml" xref="alg1.l11.m1.1.2.2.2">𝑐</ci><ci id="alg1.l11.m1.1.2.2.3a.cmml" xref="alg1.l11.m1.1.2.2.3"><mtext id="alg1.l11.m1.1.2.2.3.cmml" mathsize="70%" xref="alg1.l11.m1.1.2.2.3">new</mtext></ci></apply><set id="alg1.l11.m1.1.2.3.1.cmml" xref="alg1.l11.m1.1.2.3.2"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑑</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">c_{\text{new}}=\{d\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_c start_POSTSUBSCRIPT new end_POSTSUBSCRIPT = { italic_d }</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     Sort <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">caligraphic_R</annotation></semantics></math> by their closeness centrality to <math alttext="d" class="ltx_Math" display="inline" id="alg1.l12.m2.1"><semantics id="alg1.l12.m2.1a"><mi id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.1d">italic_d</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l13.1">for</span> each cluster c in <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">caligraphic_R</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l13.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l14.1">if</span> <math alttext="|c_{\text{new}}|+|c|\leq S" class="ltx_Math" display="inline" id="alg1.l14.m1.2"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml"><mrow id="alg1.l14.m1.2.2.1" xref="alg1.l14.m1.2.2.1.cmml"><mrow id="alg1.l14.m1.2.2.1.1.1" xref="alg1.l14.m1.2.2.1.1.2.cmml"><mo id="alg1.l14.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l14.m1.2.2.1.1.2.1.cmml">|</mo><msub id="alg1.l14.m1.2.2.1.1.1.1" xref="alg1.l14.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l14.m1.2.2.1.1.1.1.2" xref="alg1.l14.m1.2.2.1.1.1.1.2.cmml">c</mi><mtext id="alg1.l14.m1.2.2.1.1.1.1.3" xref="alg1.l14.m1.2.2.1.1.1.1.3a.cmml">new</mtext></msub><mo id="alg1.l14.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.l14.m1.2.2.1.1.2.1.cmml">|</mo></mrow><mo id="alg1.l14.m1.2.2.1.2" xref="alg1.l14.m1.2.2.1.2.cmml">+</mo><mrow id="alg1.l14.m1.2.2.1.3.2" xref="alg1.l14.m1.2.2.1.3.1.cmml"><mo id="alg1.l14.m1.2.2.1.3.2.1" stretchy="false" xref="alg1.l14.m1.2.2.1.3.1.1.cmml">|</mo><mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">c</mi><mo id="alg1.l14.m1.2.2.1.3.2.2" stretchy="false" xref="alg1.l14.m1.2.2.1.3.1.1.cmml">|</mo></mrow></mrow><mo id="alg1.l14.m1.2.2.2" xref="alg1.l14.m1.2.2.2.cmml">≤</mo><mi id="alg1.l14.m1.2.2.3" xref="alg1.l14.m1.2.2.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2"><leq id="alg1.l14.m1.2.2.2.cmml" xref="alg1.l14.m1.2.2.2"></leq><apply id="alg1.l14.m1.2.2.1.cmml" xref="alg1.l14.m1.2.2.1"><plus id="alg1.l14.m1.2.2.1.2.cmml" xref="alg1.l14.m1.2.2.1.2"></plus><apply id="alg1.l14.m1.2.2.1.1.2.cmml" xref="alg1.l14.m1.2.2.1.1.1"><abs id="alg1.l14.m1.2.2.1.1.2.1.cmml" xref="alg1.l14.m1.2.2.1.1.1.2"></abs><apply id="alg1.l14.m1.2.2.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.1.1.1.1.2">𝑐</ci><ci id="alg1.l14.m1.2.2.1.1.1.1.3a.cmml" xref="alg1.l14.m1.2.2.1.1.1.1.3"><mtext id="alg1.l14.m1.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l14.m1.2.2.1.1.1.1.3">new</mtext></ci></apply></apply><apply id="alg1.l14.m1.2.2.1.3.1.cmml" xref="alg1.l14.m1.2.2.1.3.2"><abs id="alg1.l14.m1.2.2.1.3.1.1.cmml" xref="alg1.l14.m1.2.2.1.3.2.1"></abs><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝑐</ci></apply></apply><ci id="alg1.l14.m1.2.2.3.cmml" xref="alg1.l14.m1.2.2.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">|c_{\text{new}}|+|c|\leq S</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.2d">| italic_c start_POSTSUBSCRIPT new end_POSTSUBSCRIPT | + | italic_c | ≤ italic_S</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l14.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>              <math alttext="c_{\text{new}}\leftarrow c_{\text{new}}\cup c" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msub id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml"><mi id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">c</mi><mtext id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3a.cmml">new</mtext></msub><mo id="alg1.l15.m1.1.1.1" stretchy="false" xref="alg1.l15.m1.1.1.1.cmml">←</mo><mrow id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><msub id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml"><mi id="alg1.l15.m1.1.1.3.2.2" xref="alg1.l15.m1.1.1.3.2.2.cmml">c</mi><mtext id="alg1.l15.m1.1.1.3.2.3" xref="alg1.l15.m1.1.1.3.2.3a.cmml">new</mtext></msub><mo id="alg1.l15.m1.1.1.3.1" xref="alg1.l15.m1.1.1.3.1.cmml">∪</mo><mi id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml">c</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1">←</ci><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.2">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">𝑐</ci><ci id="alg1.l15.m1.1.1.2.3a.cmml" xref="alg1.l15.m1.1.1.2.3"><mtext id="alg1.l15.m1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l15.m1.1.1.2.3">new</mtext></ci></apply><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><union id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3.1"></union><apply id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.2.1.cmml" xref="alg1.l15.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.2.cmml" xref="alg1.l15.m1.1.1.3.2.2">𝑐</ci><ci id="alg1.l15.m1.1.1.3.2.3a.cmml" xref="alg1.l15.m1.1.1.3.2.3"><mtext id="alg1.l15.m1.1.1.3.2.3.cmml" mathsize="70%" xref="alg1.l15.m1.1.1.3.2.3">new</mtext></ci></apply><ci id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">c_{\text{new}}\leftarrow c_{\text{new}}\cup c</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_c start_POSTSUBSCRIPT new end_POSTSUBSCRIPT ← italic_c start_POSTSUBSCRIPT new end_POSTSUBSCRIPT ∪ italic_c</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>              Remove <math alttext="c" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mi id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><ci id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_c</annotation></semantics></math> from <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l16.m2.1"><semantics id="alg1.l16.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m2.1d">caligraphic_C</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l17.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l17.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l18.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l18.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span>     Add <math alttext="c_{\text{new}}" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><msub id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">c</mi><mtext id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3a.cmml">new</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1">subscript</csymbol><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝑐</ci><ci id="alg1.l19.m1.1.1.3a.cmml" xref="alg1.l19.m1.1.1.3"><mtext id="alg1.l19.m1.1.1.3.cmml" mathsize="70%" xref="alg1.l19.m1.1.1.3">new</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">c_{\text{new}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">italic_c start_POSTSUBSCRIPT new end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l19.m2.1"><semantics id="alg1.l19.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><ci id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m2.1d">caligraphic_C</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span><span class="ltx_text ltx_font_bold" id="alg1.l20.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l20.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline">21:</span><span class="ltx_text ltx_font_bold" id="alg1.l21.1">return</span> <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><ci id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">caligraphic_C</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline">22:</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline">23:</span><span class="ltx_text ltx_font_bold" id="alg1.l23.1">function</span> <span class="ltx_text ltx_font_smallcaps" id="alg1.l23.2">find_related_cluster</span>(<math alttext="d" class="ltx_Math" display="inline" id="alg1.l23.m1.1"><semantics id="alg1.l23.m1.1a"><mi id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><ci id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.1d">italic_d</annotation></semantics></math>, <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l23.m2.1"><semantics id="alg1.l23.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l23.m2.1.1" xref="alg1.l23.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l23.m2.1b"><ci id="alg1.l23.m2.1.1.cmml" xref="alg1.l23.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m2.1d">caligraphic_C</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline">24:</span>     Initialize the set of related clusters <math alttext="\mathcal{R}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l24.m1.1"><semantics id="alg1.l24.m1.1a"><mrow id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2.cmml">ℛ</mi><mo id="alg1.l24.m1.1.1.1" stretchy="false" xref="alg1.l24.m1.1.1.1.cmml">←</mo><mi id="alg1.l24.m1.1.1.3" mathvariant="normal" xref="alg1.l24.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1"><ci id="alg1.l24.m1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1">←</ci><ci id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2">ℛ</ci><emptyset id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">\mathcal{R}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.1d">caligraphic_R ← ∅</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline">25:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l25.1">for</span> each related document <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="alg1.l25.m1.1"><semantics id="alg1.l25.m1.1a"><msup id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><mi id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml">d</mi><mo id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1">superscript</csymbol><ci id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2">𝑑</ci><ci id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> in <math alttext="\text{adj}[d]" class="ltx_Math" display="inline" id="alg1.l25.m2.1"><semantics id="alg1.l25.m2.1a"><mrow id="alg1.l25.m2.1.2" xref="alg1.l25.m2.1.2.cmml"><mtext id="alg1.l25.m2.1.2.2" xref="alg1.l25.m2.1.2.2a.cmml">adj</mtext><mo id="alg1.l25.m2.1.2.1" xref="alg1.l25.m2.1.2.1.cmml">⁢</mo><mrow id="alg1.l25.m2.1.2.3.2" xref="alg1.l25.m2.1.2.3.1.cmml"><mo id="alg1.l25.m2.1.2.3.2.1" stretchy="false" xref="alg1.l25.m2.1.2.3.1.1.cmml">[</mo><mi id="alg1.l25.m2.1.1" xref="alg1.l25.m2.1.1.cmml">d</mi><mo id="alg1.l25.m2.1.2.3.2.2" stretchy="false" xref="alg1.l25.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m2.1b"><apply id="alg1.l25.m2.1.2.cmml" xref="alg1.l25.m2.1.2"><times id="alg1.l25.m2.1.2.1.cmml" xref="alg1.l25.m2.1.2.1"></times><ci id="alg1.l25.m2.1.2.2a.cmml" xref="alg1.l25.m2.1.2.2"><mtext id="alg1.l25.m2.1.2.2.cmml" xref="alg1.l25.m2.1.2.2">adj</mtext></ci><apply id="alg1.l25.m2.1.2.3.1.cmml" xref="alg1.l25.m2.1.2.3.2"><csymbol cd="latexml" id="alg1.l25.m2.1.2.3.1.1.cmml" xref="alg1.l25.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l25.m2.1.1.cmml" xref="alg1.l25.m2.1.1">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m2.1c">\text{adj}[d]</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m2.1d">adj [ italic_d ]</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l25.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline">26:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l26.1">for</span> each cluster <math alttext="c" class="ltx_Math" display="inline" id="alg1.l26.m1.1"><semantics id="alg1.l26.m1.1a"><mi id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><ci id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m1.1d">italic_c</annotation></semantics></math> in <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l26.m2.1"><semantics id="alg1.l26.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l26.m2.1.1" xref="alg1.l26.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l26.m2.1b"><ci id="alg1.l26.m2.1.1.cmml" xref="alg1.l26.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m2.1d">caligraphic_C</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l26.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline">27:</span>              <span class="ltx_text ltx_font_bold" id="alg1.l27.1">if</span> <math alttext="d^{\prime}\in c" class="ltx_Math" display="inline" id="alg1.l27.m1.1"><semantics id="alg1.l27.m1.1a"><mrow id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml"><msup id="alg1.l27.m1.1.1.2" xref="alg1.l27.m1.1.1.2.cmml"><mi id="alg1.l27.m1.1.1.2.2" xref="alg1.l27.m1.1.1.2.2.cmml">d</mi><mo id="alg1.l27.m1.1.1.2.3" xref="alg1.l27.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg1.l27.m1.1.1.1" xref="alg1.l27.m1.1.1.1.cmml">∈</mo><mi id="alg1.l27.m1.1.1.3" xref="alg1.l27.m1.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b"><apply id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1"><in id="alg1.l27.m1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1"></in><apply id="alg1.l27.m1.1.1.2.cmml" xref="alg1.l27.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.1.2.1.cmml" xref="alg1.l27.m1.1.1.2">superscript</csymbol><ci id="alg1.l27.m1.1.1.2.2.cmml" xref="alg1.l27.m1.1.1.2.2">𝑑</ci><ci id="alg1.l27.m1.1.1.2.3.cmml" xref="alg1.l27.m1.1.1.2.3">′</ci></apply><ci id="alg1.l27.m1.1.1.3.cmml" xref="alg1.l27.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.1c">d^{\prime}\in c</annotation><annotation encoding="application/x-llamapun" id="alg1.l27.m1.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_c</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l27.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline">28:</span>                  <math alttext="\mathcal{R}\leftarrow\mathcal{R}\cup\{c\}" class="ltx_Math" display="inline" id="alg1.l28.m1.1"><semantics id="alg1.l28.m1.1a"><mrow id="alg1.l28.m1.1.2" xref="alg1.l28.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.1.2.2" xref="alg1.l28.m1.1.2.2.cmml">ℛ</mi><mo id="alg1.l28.m1.1.2.1" stretchy="false" xref="alg1.l28.m1.1.2.1.cmml">←</mo><mrow id="alg1.l28.m1.1.2.3" xref="alg1.l28.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.1.2.3.2" xref="alg1.l28.m1.1.2.3.2.cmml">ℛ</mi><mo id="alg1.l28.m1.1.2.3.1" xref="alg1.l28.m1.1.2.3.1.cmml">∪</mo><mrow id="alg1.l28.m1.1.2.3.3.2" xref="alg1.l28.m1.1.2.3.3.1.cmml"><mo id="alg1.l28.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l28.m1.1.2.3.3.1.cmml">{</mo><mi id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml">c</mi><mo id="alg1.l28.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l28.m1.1.2.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.1b"><apply id="alg1.l28.m1.1.2.cmml" xref="alg1.l28.m1.1.2"><ci id="alg1.l28.m1.1.2.1.cmml" xref="alg1.l28.m1.1.2.1">←</ci><ci id="alg1.l28.m1.1.2.2.cmml" xref="alg1.l28.m1.1.2.2">ℛ</ci><apply id="alg1.l28.m1.1.2.3.cmml" xref="alg1.l28.m1.1.2.3"><union id="alg1.l28.m1.1.2.3.1.cmml" xref="alg1.l28.m1.1.2.3.1"></union><ci id="alg1.l28.m1.1.2.3.2.cmml" xref="alg1.l28.m1.1.2.3.2">ℛ</ci><set id="alg1.l28.m1.1.2.3.3.1.cmml" xref="alg1.l28.m1.1.2.3.3.2"><ci id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1">𝑐</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.1c">\mathcal{R}\leftarrow\mathcal{R}\cup\{c\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l28.m1.1d">caligraphic_R ← caligraphic_R ∪ { italic_c }</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l29">
<span class="ltx_tag ltx_tag_listingline">29:</span>              <span class="ltx_text ltx_font_bold" id="alg1.l29.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l29.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l30">
<span class="ltx_tag ltx_tag_listingline">30:</span>         <span class="ltx_text ltx_font_bold" id="alg1.l30.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l30.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l31">
<span class="ltx_tag ltx_tag_listingline">31:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l31.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l31.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l32">
<span class="ltx_tag ltx_tag_listingline">32:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l32.1">return</span> The set of related clusters <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="alg1.l32.m1.1"><semantics id="alg1.l32.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l32.m1.1.1" xref="alg1.l32.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg1.l32.m1.1b"><ci id="alg1.l32.m1.1.1.cmml" xref="alg1.l32.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l32.m1.1d">caligraphic_R</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg1.l33">
<span class="ltx_tag ltx_tag_listingline">33:</span><span class="ltx_text ltx_font_bold" id="alg1.l33.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l33.2">function</span>
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Oct 14 03:46:33 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
