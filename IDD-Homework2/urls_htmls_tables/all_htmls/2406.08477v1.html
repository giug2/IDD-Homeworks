<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens</title>
<!--Generated on Tue Jun 11 11:25:06 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.08477v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S1" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S2" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.SS1" title="In 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Instruction Tuning for Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.SS2" title="In 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Represent Users/Items with In-Vocabulary Tokens</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.SS3" title="In 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Metric for Representation Evaluation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>META ID</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.SS1" title="In 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Meta-path-based Embedding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.SS2" title="In 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>OOV Token Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.SS3" title="In 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Integration of META ID with LLMs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS1" title="In 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Evaluation on Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS2" title="In 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Evaluation on Various Recommendation Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS3" title="In 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Evaluation of ID Representation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS4" title="In 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Ablation Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S6" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Details of META ID</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1.SS1" title="In Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>How to extract the meta-path-based embedding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1.SS2" title="In Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>How to generate OOV tokens</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1.SS3" title="In Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>How to incorporate META ID with LLMs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A2" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Details of memorization score (MS) and diversity score (DS)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Experimental Setups and Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.SS1" title="In Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Datasets Descriptions and Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.SS2" title="In Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.SS3" title="In Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.SS3.SSS1" title="In C.3 Implementation Details ‣ Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3.1 </span>Evaluation on Sequential and Direct Recommendation Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.SS3.SSS2" title="In C.3 Implementation Details ‣ Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3.2 </span>Evaluation on Rating, Explanation and Review Tasks</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A4" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Additional Experimental Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A5" title="In Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Discussions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Improving LLMs for Recommendation 
<br class="ltx_break"/>with Out-Of-Vocabulary Tokens</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ting-Ji Huang<sup class="ltx_sup" id="id11.11.id1"><span class="ltx_text ltx_font_italic" id="id11.11.id1.1">1,2</span></sup>    Jia-Qi Yang<sup class="ltx_sup" id="id12.12.id2"><span class="ltx_text ltx_font_italic" id="id12.12.id2.1">1,2</span></sup>    Chunxu Shen<sup class="ltx_sup" id="id13.13.id3">3</sup>    Kai-Qi Liu<sup class="ltx_sup" id="id14.14.id4">4</sup>    
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id5.5.1">De-Chuan Zhan<sup class="ltx_sup" id="id5.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id5.5.1.1.1">1,2</span></sup></span>     <span class="ltx_text ltx_font_bold" id="id7.7.3">Han-Jia Ye<sup class="ltx_sup" id="id7.7.3.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.3.1.1">1,2</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id7.7.3.2"><span class="ltx_text ltx_font_medium" id="id7.7.3.2.1">1</span></sup></span>School of Artificial Intelligence, Nanjing University
<br class="ltx_break"/><sup class="ltx_sup" id="id15.15.id5">2</sup>National Key Laboratory for Novel Software Technology, Nanjing University
<br class="ltx_break"/><sup class="ltx_sup" id="id16.16.id6">3</sup>WeChat Technical Architecture Department, Tencent Inc.
<br class="ltx_break"/><sup class="ltx_sup" id="id17.17.id7">4</sup>Software Institute, Nanjing University 
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Corresponding author, email: yehj@lamda.nju.edu.cn.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id18.id1">Characterizing users and items through vector representations is crucial for various tasks in recommender systems. Recent approaches attempt to apply Large Language Models (LLMs) in recommendation through a question&amp;answer format, where real users and items (<span class="ltx_text ltx_font_italic" id="id18.id1.1">e.g.</span>, Item No.2024) are represented with in-vocabulary tokens (<span class="ltx_text ltx_font_italic" id="id18.id1.2">e.g.</span>, “item”, “20”, “24”). However, since LLMs are typically pretrained on natural language tasks, these in-vocabulary tokens lack the expressive power for distinctive users and items, thereby weakening the recommendation ability even after fine-tuning on recommendation tasks. In this paper, we explore how to effectively tokenize users and items in LLM-based recommender systems. We emphasize the role of out-of-vocabulary (OOV) tokens in addition to the in-vocabulary ones and claim the <span class="ltx_text ltx_font_italic" id="id18.id1.3">memorization</span> of OOV tokens that capture correlations of users/items as well as <span class="ltx_text ltx_font_italic" id="id18.id1.4">diversity</span> of OOV tokens. By clustering the learned representations from historical user-item interactions, we make the representations of user/item combinations share the same OOV tokens if they have similar properties. Furthermore, integrating these OOV tokens into the LLM’s vocabulary allows for better distinction between users and items and enhanced capture of user-item relationships during fine-tuning on downstream tasks. Our proposed framework outperforms existing state-of-the-art methods across various downstream recommendation tasks.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Modern recommender systems (RS) play a crucial role in various applications like video recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib7" title=""><span class="ltx_text" style="font-size:90%;">7</span></a>]</cite>, e-commerce <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib4" title=""><span class="ltx_text" style="font-size:90%;">4</span></a>]</cite>, and social networking <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">10</span></a>]</cite>. The recent advent of large language models (LLMs) offers a new direction of exploration in this realm. Models such as T5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib29" title=""><span class="ltx_text" style="font-size:90%;">29</span></a>]</cite> and LLaMA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib37" title=""><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite>, training on massive natural language data, achieve impressive language understanding capabilities in text generation and conversation tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib48" title=""><span class="ltx_text" style="font-size:90%;">48</span></a>]</cite>. Their success drives explorations to use pre-trained LLMs as model backbones for handling various recommendation tasks like sequential recommendation, rating, and explanation task <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib42" title=""><span class="ltx_text" style="font-size:90%;">42</span></a>]</cite>. In such frameworks, we describe task inputs as a query and expect an LLM to directly answer task labels <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite>. After fine-tuning through this Q&amp;A format, we could ask the LLM to recommend something for a user and receive a real item answered.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="233" id="S1.F1.sf1.g1" src="x1.png" width="399"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="206" id="S1.F1.sf2.g1" src="x2.png" width="399"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.4.2" style="font-size:90%;"> (a) Two ID strategies for characterizing items through tokens in LLM-based recommendation. (b) Left: Mapping problems caused by numeric tokens when characterizing items. Two unrelated items might share the same numeric tokens, and consecutive numeric tokens are treated similarly by LLMs. Right: Heatmaps of item representations similarity learned with Random ID (RID), Sequential ID (SID) and META ID on Toys dataset. We randomly sample 50 items and take their ID representations to calculate cosine similarity. The ground Truth is their adjusted cosine similarities in the Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.E4" title="Equation 4 ‣ 3.3 Metric for Representation Evaluation ‣ 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4</span></a>.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">How to characterize users and items so that LLMs can learn their personalized information during fine-tuning? Since tokens are the basic building blocks for LLMs and represent the smallest unit of text the model can understand and process, we should allocate some tokens to represent users/items and let LLMs learn their characteristics through tokens. While early works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite> directly represent a real item by text tokens (<span class="ltx_text ltx_font_italic" id="S1.p2.1.1">e.g.</span>, “blue”, “casual”, “T-shirt”), LLMs might answer text that does not correspond to a real existing item <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite>. Recent advancements explore representing users/items with <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">Identifiers</span> (<span class="ltx_text ltx_font_italic" id="S1.p2.1.3">IDs</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib40" title=""><span class="ltx_text" style="font-size:90%;">40</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib12" title=""><span class="ltx_text" style="font-size:90%;">12</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">2</span></a>]</cite>. As illustrated in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:teaser_a</span>, a real item (Item No.2024) can be indexed with a sequence of in-vocabulary tokens (“item”, “20”, “24”), and we call such a token combination as an ID, where a numeric ID indicates that we use numeric tokens (“20”, “24”).</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Characterizing users and items with numeric IDs is straightforward but also introduces the <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">mapping problem</span>, where it is hard to align limited numeric tokens to thousands of items in recommender systems, and token combinations are prone to lead to language conflicts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>. As shown in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:teaser_b</span>, using numeric tokens to represent items leads to similar representations of distinctive items. One solution is to create OOV tokens specifically allocated for IDs to allow distinction, as in the previous work on Collaborative ID (CID) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>.
However, our experiments indicate that the use of OOV tokens defined in CID may improve diversity, it is hard for LLM to learn the correlations of users/items during fine-tuning (see Section <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.SS3" title="3.3 Metric for Representation Evaluation ‣ 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">3.3</span></a>). Therefore, we should utilize redefined OOV tokens capable of capturing user/item correlations (<span class="ltx_text ltx_font_italic" id="S1.p3.1.2">memorization</span>) while also distinguishing different items (<span class="ltx_text ltx_font_italic" id="S1.p3.1.3">diversity</span>), two dimensions that are positively correlated for the performance of recommendation tasks.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we present META ID (META-path-guided IDentifier), a framework for characterizing users/items using out-of-vocabulary (OOV) tokens for LLM-based recommendations. Initially, we generate meta-paths to represent user-item interactions and then obtain user and item representations from a skip-gram model trained on these meta-paths. A meta-path is a sequence that represents interactions between users and items in a graph structure. By clustering these meta-path-based representations, we create hierarchical groups that serve as OOV tokens for constructing user and item IDs. This approach extends beyond previous research, which has predominantly focused on item IDs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite>, by making the representations of users/item IDs share the same OOV tokens if they have similar properties. Finally, integrating these OOV tokens into the LLM’s vocabulary allows for better diversity and enhanced memorization during fine-tuning on downstream recommendation tasks. Additionally, we align the token embedding layer of LLMs with a linear transformation layer to enrich the OOV token representations as an augmentation. Our contributions are as follows:</p>
</div>
<div class="ltx_para" id="S1.p5">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce memorization and diversity scores to evaluate ID representations in LLM-based recommender systems, focusing on capturing user/item correlations and ensuring diversity.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We develop META ID, which uses out-of-vocabulary tokens to characterize users/items, enhancing the memorization and diversity of their representations for LLMs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">The experiments show that META ID improves memorization and diversity score, which leads to improvements in various recommendation tasks.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Characterizing Items by IDs</span>. Modern recommendation models usually use unique IDs to represent users and items, which are subsequently converted to embedding vectors as learnable parameters <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib11" title=""><span class="ltx_text" style="font-size:90%;">11</span></a>]</cite>. Common approaches include matrix factorization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib21" title=""><span class="ltx_text" style="font-size:90%;">21</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib32" title=""><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>, two-tower models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib38" title=""><span class="ltx_text" style="font-size:90%;">38</span></a>]</cite> and deep neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">35</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib46" title=""><span class="ltx_text" style="font-size:90%;">46</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib43" title=""><span class="ltx_text" style="font-size:90%;">43</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib39" title=""><span class="ltx_text" style="font-size:90%;">39</span></a>]</cite>, which make predictions by examining historical user-item interactions to identify behavioral patterns and enable collaborative recommendations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a>]</cite>. Some recent approaches adopt the concept of ID to represent the token combinations that characterize items in LLMs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>. We follow previous studies and also call these token combinations as ID. This paper aims to combine LLM with ID more efficiently by proposing a new ID construction method.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Instruction Tuning for Recommendation</span>. The integration of Large Language Models (LLMs) into diverse tasks has seen significant growth recently. Recent works fine-tuned pretrained language models on large-scale NLP datasets verbalized via human-readable prompts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">33</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib41" title=""><span class="ltx_text" style="font-size:90%;">41</span></a>]</cite>. These instruction tuning methods design prompts containing detailed task descriptions and adhere more to the natural language format. Driven by their exceptional natural language processing capabilities, researchers aim to transfer their linguistic ability to enhance recommender systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib25" title=""><span class="ltx_text" style="font-size:90%;">25</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib45" title=""><span class="ltx_text" style="font-size:90%;">45</span></a>]</cite>. These LLMs process user interactions as sequences of tokens and, through fine-tuning, predict users’ future interests based on past activities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib47" title=""><span class="ltx_text" style="font-size:90%;">47</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>]</cite>. Moreover, some studies reframe tasks like retrieval, rating, and explanation generation as language comprehension tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>]</cite>, allowing LLMs to function as multi-task recommenders, producing recommendations and explanations with a unified architecture. In this paper, we apply LLMs based on instruction tuning of multi-task scenarios.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">ID Construction with Tokens</span>. Recent studies explore using in-vocabulary tokens to characterize items in LLMs, where users and items are represented by token combinations called IDs. Early efforts such as P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> convert user-item interactions into natural language formats using numeric IDs constructed of in-vocabulary tokens of the T5 model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib29" title=""><span class="ltx_text" style="font-size:90%;">29</span></a>]</cite>. Further, sequential ID and collaborative ID are developed to enhance item information sharing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>. A relevant study <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite>, constructs IDs using hierarchical tokens through RQ-VAE. Despite these advancements in ID construction, challenges remain in the lack of ID construction criteria and the focus on item IDs. In contrast, our META ID approach assigns memorization and diversity scores for evaluation and constructs both user and item IDs, which improves the characterization of users and items.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminary</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We describe recommendation tasks (<span class="ltx_text ltx_font_italic" id="S3.p1.1.1">e.g.</span>, sequential recommendation) under the instruction tuning setting, in which all data such as user-item interactions are converted to natural language sequences in a question&amp;answer format (<span class="ltx_text ltx_font_italic" id="S3.p1.1.2">e.g.</span>, Input: <span class="ltx_text ltx_font_italic" id="S3.p1.1.3">Please recommend an item for user 2024 consider he has purchased item 2023</span>; Output: <span class="ltx_text ltx_font_italic" id="S3.p1.1.4">item 2024</span>). Details of this format are presented in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3" title="Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Instruction Tuning for Recommendation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.12">Given a user set <math alttext="\mathbf{U}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝐔</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_U</annotation></semantics></math>, an item set <math alttext="\mathbf{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">bold_I</annotation></semantics></math>, we formulate a recommendation task as a natural language instruction that pairs an input token sequence <math alttext="\mathbf{x}=(x_{1},...,x_{n},\boldsymbol{x}_{u},\boldsymbol{x}_{i})" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.5"><semantics id="S3.SS1.p1.3.m3.5a"><mrow id="S3.SS1.p1.3.m3.5.5" xref="S3.SS1.p1.3.m3.5.5.cmml"><mi id="S3.SS1.p1.3.m3.5.5.6" xref="S3.SS1.p1.3.m3.5.5.6.cmml">𝐱</mi><mo id="S3.SS1.p1.3.m3.5.5.5" xref="S3.SS1.p1.3.m3.5.5.5.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.5.5.4.4" xref="S3.SS1.p1.3.m3.5.5.4.5.cmml"><mo id="S3.SS1.p1.3.m3.5.5.4.4.5" stretchy="false" xref="S3.SS1.p1.3.m3.5.5.4.5.cmml">(</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">x</mi><mn id="S3.SS1.p1.3.m3.2.2.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.5.5.4.4.6" xref="S3.SS1.p1.3.m3.5.5.4.5.cmml">,</mo><mi id="S3.SS1.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p1.3.m3.5.5.4.4.7" xref="S3.SS1.p1.3.m3.5.5.4.5.cmml">,</mo><msub id="S3.SS1.p1.3.m3.3.3.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml">x</mi><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S3.SS1.p1.3.m3.5.5.4.4.8" xref="S3.SS1.p1.3.m3.5.5.4.5.cmml">,</mo><msub id="S3.SS1.p1.3.m3.4.4.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.4.4.3.3.3.2" xref="S3.SS1.p1.3.m3.4.4.3.3.3.2.cmml">𝒙</mi><mi id="S3.SS1.p1.3.m3.4.4.3.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.3.cmml">u</mi></msub><mo id="S3.SS1.p1.3.m3.5.5.4.4.9" xref="S3.SS1.p1.3.m3.5.5.4.5.cmml">,</mo><msub id="S3.SS1.p1.3.m3.5.5.4.4.4" xref="S3.SS1.p1.3.m3.5.5.4.4.4.cmml"><mi id="S3.SS1.p1.3.m3.5.5.4.4.4.2" xref="S3.SS1.p1.3.m3.5.5.4.4.4.2.cmml">𝒙</mi><mi id="S3.SS1.p1.3.m3.5.5.4.4.4.3" xref="S3.SS1.p1.3.m3.5.5.4.4.4.3.cmml">i</mi></msub><mo id="S3.SS1.p1.3.m3.5.5.4.4.10" stretchy="false" xref="S3.SS1.p1.3.m3.5.5.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.5b"><apply id="S3.SS1.p1.3.m3.5.5.cmml" xref="S3.SS1.p1.3.m3.5.5"><eq id="S3.SS1.p1.3.m3.5.5.5.cmml" xref="S3.SS1.p1.3.m3.5.5.5"></eq><ci id="S3.SS1.p1.3.m3.5.5.6.cmml" xref="S3.SS1.p1.3.m3.5.5.6">𝐱</ci><vector id="S3.SS1.p1.3.m3.5.5.4.5.cmml" xref="S3.SS1.p1.3.m3.5.5.4.4"><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2">𝑥</ci><cn id="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">…</ci><apply id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2">𝑥</ci><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3">𝑛</ci></apply><apply id="S3.SS1.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3.2">𝒙</ci><ci id="S3.SS1.p1.3.m3.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3.3">𝑢</ci></apply><apply id="S3.SS1.p1.3.m3.5.5.4.4.4.cmml" xref="S3.SS1.p1.3.m3.5.5.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.5.5.4.4.4.1.cmml" xref="S3.SS1.p1.3.m3.5.5.4.4.4">subscript</csymbol><ci id="S3.SS1.p1.3.m3.5.5.4.4.4.2.cmml" xref="S3.SS1.p1.3.m3.5.5.4.4.4.2">𝒙</ci><ci id="S3.SS1.p1.3.m3.5.5.4.4.4.3.cmml" xref="S3.SS1.p1.3.m3.5.5.4.4.4.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.5c">\mathbf{x}=(x_{1},...,x_{n},\boldsymbol{x}_{u},\boldsymbol{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.5d">bold_x = ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , bold_italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> with a corresponding label token sequence <math alttext="\mathbf{y}=(y_{1},...,y_{m},\boldsymbol{x}_{u},\boldsymbol{x}_{i})" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.5"><semantics id="S3.SS1.p1.4.m4.5a"><mrow id="S3.SS1.p1.4.m4.5.5" xref="S3.SS1.p1.4.m4.5.5.cmml"><mi id="S3.SS1.p1.4.m4.5.5.6" xref="S3.SS1.p1.4.m4.5.5.6.cmml">𝐲</mi><mo id="S3.SS1.p1.4.m4.5.5.5" xref="S3.SS1.p1.4.m4.5.5.5.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.5.5.4.4" xref="S3.SS1.p1.4.m4.5.5.4.5.cmml"><mo id="S3.SS1.p1.4.m4.5.5.4.4.5" stretchy="false" xref="S3.SS1.p1.4.m4.5.5.4.5.cmml">(</mo><msub id="S3.SS1.p1.4.m4.2.2.1.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml">y</mi><mn id="S3.SS1.p1.4.m4.2.2.1.1.1.3" xref="S3.SS1.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.4.m4.5.5.4.4.6" xref="S3.SS1.p1.4.m4.5.5.4.5.cmml">,</mo><mi id="S3.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S3.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS1.p1.4.m4.5.5.4.4.7" xref="S3.SS1.p1.4.m4.5.5.4.5.cmml">,</mo><msub id="S3.SS1.p1.4.m4.3.3.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.3.3.2.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.4.m4.3.3.2.2.2.3" xref="S3.SS1.p1.4.m4.3.3.2.2.2.3.cmml">m</mi></msub><mo id="S3.SS1.p1.4.m4.5.5.4.4.8" xref="S3.SS1.p1.4.m4.5.5.4.5.cmml">,</mo><msub id="S3.SS1.p1.4.m4.4.4.3.3.3" xref="S3.SS1.p1.4.m4.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.4.m4.4.4.3.3.3.2" xref="S3.SS1.p1.4.m4.4.4.3.3.3.2.cmml">𝒙</mi><mi id="S3.SS1.p1.4.m4.4.4.3.3.3.3" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3.cmml">u</mi></msub><mo id="S3.SS1.p1.4.m4.5.5.4.4.9" xref="S3.SS1.p1.4.m4.5.5.4.5.cmml">,</mo><msub id="S3.SS1.p1.4.m4.5.5.4.4.4" xref="S3.SS1.p1.4.m4.5.5.4.4.4.cmml"><mi id="S3.SS1.p1.4.m4.5.5.4.4.4.2" xref="S3.SS1.p1.4.m4.5.5.4.4.4.2.cmml">𝒙</mi><mi id="S3.SS1.p1.4.m4.5.5.4.4.4.3" xref="S3.SS1.p1.4.m4.5.5.4.4.4.3.cmml">i</mi></msub><mo id="S3.SS1.p1.4.m4.5.5.4.4.10" stretchy="false" xref="S3.SS1.p1.4.m4.5.5.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.5b"><apply id="S3.SS1.p1.4.m4.5.5.cmml" xref="S3.SS1.p1.4.m4.5.5"><eq id="S3.SS1.p1.4.m4.5.5.5.cmml" xref="S3.SS1.p1.4.m4.5.5.5"></eq><ci id="S3.SS1.p1.4.m4.5.5.6.cmml" xref="S3.SS1.p1.4.m4.5.5.6">𝐲</ci><vector id="S3.SS1.p1.4.m4.5.5.4.5.cmml" xref="S3.SS1.p1.4.m4.5.5.4.4"><apply id="S3.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2">𝑦</ci><cn id="S3.SS1.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">…</ci><apply id="S3.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2.3">𝑚</ci></apply><apply id="S3.SS1.p1.4.m4.4.4.3.3.3.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3.2">𝒙</ci><ci id="S3.SS1.p1.4.m4.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3">𝑢</ci></apply><apply id="S3.SS1.p1.4.m4.5.5.4.4.4.cmml" xref="S3.SS1.p1.4.m4.5.5.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.5.5.4.4.4.1.cmml" xref="S3.SS1.p1.4.m4.5.5.4.4.4">subscript</csymbol><ci id="S3.SS1.p1.4.m4.5.5.4.4.4.2.cmml" xref="S3.SS1.p1.4.m4.5.5.4.4.4.2">𝒙</ci><ci id="S3.SS1.p1.4.m4.5.5.4.4.4.3.cmml" xref="S3.SS1.p1.4.m4.5.5.4.4.4.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.5c">\mathbf{y}=(y_{1},...,y_{m},\boldsymbol{x}_{u},\boldsymbol{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.5d">bold_y = ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , bold_italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>. The goal is to train and LLM <math alttext="\mathcal{M}_{{\boldsymbol{\theta}}}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">ℳ</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{M}_{{\boldsymbol{\theta}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">caligraphic_M start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> to generate <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">bold_y</annotation></semantics></math> given <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">bold_x</annotation></semantics></math>. For simplification, we denote one token as <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑥</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> or <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">y</mi><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝑦</ci><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and represent the ID of an user <math alttext="u\in\mathbf{U}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">u</mi><mo id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">𝐔</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><in id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1"></in><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑢</ci><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝐔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">u\in\mathbf{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_u ∈ bold_U</annotation></semantics></math> by <math alttext="\boldsymbol{x}_{u}=(x_{u_{1}},x_{u_{2}},...)" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.3"><semantics id="S3.SS1.p1.11.m11.3a"><mrow id="S3.SS1.p1.11.m11.3.3" xref="S3.SS1.p1.11.m11.3.3.cmml"><msub id="S3.SS1.p1.11.m11.3.3.4" xref="S3.SS1.p1.11.m11.3.3.4.cmml"><mi id="S3.SS1.p1.11.m11.3.3.4.2" xref="S3.SS1.p1.11.m11.3.3.4.2.cmml">𝒙</mi><mi id="S3.SS1.p1.11.m11.3.3.4.3" xref="S3.SS1.p1.11.m11.3.3.4.3.cmml">u</mi></msub><mo id="S3.SS1.p1.11.m11.3.3.3" xref="S3.SS1.p1.11.m11.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.11.m11.3.3.2.2" xref="S3.SS1.p1.11.m11.3.3.2.3.cmml"><mo id="S3.SS1.p1.11.m11.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.11.m11.3.3.2.3.cmml">(</mo><msub id="S3.SS1.p1.11.m11.2.2.1.1.1" xref="S3.SS1.p1.11.m11.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.2.cmml">x</mi><msub id="S3.SS1.p1.11.m11.2.2.1.1.1.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.2.2.1.1.1.3.2" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3.2.cmml">u</mi><mn id="S3.SS1.p1.11.m11.2.2.1.1.1.3.3" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.SS1.p1.11.m11.3.3.2.2.4" xref="S3.SS1.p1.11.m11.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.11.m11.3.3.2.2.2" xref="S3.SS1.p1.11.m11.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.11.m11.3.3.2.2.2.2" xref="S3.SS1.p1.11.m11.3.3.2.2.2.2.cmml">x</mi><msub id="S3.SS1.p1.11.m11.3.3.2.2.2.3" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3.cmml"><mi id="S3.SS1.p1.11.m11.3.3.2.2.2.3.2" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3.2.cmml">u</mi><mn id="S3.SS1.p1.11.m11.3.3.2.2.2.3.3" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.SS1.p1.11.m11.3.3.2.2.5" xref="S3.SS1.p1.11.m11.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.11.m11.1.1" mathvariant="normal" xref="S3.SS1.p1.11.m11.1.1.cmml">…</mi><mo id="S3.SS1.p1.11.m11.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.11.m11.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.3b"><apply id="S3.SS1.p1.11.m11.3.3.cmml" xref="S3.SS1.p1.11.m11.3.3"><eq id="S3.SS1.p1.11.m11.3.3.3.cmml" xref="S3.SS1.p1.11.m11.3.3.3"></eq><apply id="S3.SS1.p1.11.m11.3.3.4.cmml" xref="S3.SS1.p1.11.m11.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.3.3.4.1.cmml" xref="S3.SS1.p1.11.m11.3.3.4">subscript</csymbol><ci id="S3.SS1.p1.11.m11.3.3.4.2.cmml" xref="S3.SS1.p1.11.m11.3.3.4.2">𝒙</ci><ci id="S3.SS1.p1.11.m11.3.3.4.3.cmml" xref="S3.SS1.p1.11.m11.3.3.4.3">𝑢</ci></apply><vector id="S3.SS1.p1.11.m11.3.3.2.3.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2"><apply id="S3.SS1.p1.11.m11.2.2.1.1.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.2">𝑥</ci><apply id="S3.SS1.p1.11.m11.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.2.2.1.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.2.2.1.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3.2">𝑢</ci><cn id="S3.SS1.p1.11.m11.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.11.m11.3.3.2.2.2.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2.2">𝑥</ci><apply id="S3.SS1.p1.11.m11.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.3.3.2.2.2.3.1.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.3.3.2.2.2.3.2.cmml" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3.2">𝑢</ci><cn id="S3.SS1.p1.11.m11.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.SS1.p1.11.m11.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">…</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.3c">\boldsymbol{x}_{u}=(x_{u_{1}},x_{u_{2}},...)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.3d">bold_italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = ( italic_x start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … )</annotation></semantics></math> as its token combination, using the same representation format to a item ID <math alttext="\boldsymbol{x}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">𝒙</mi><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝒙</ci><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\boldsymbol{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.3">The LLM <math alttext="\mathcal{M}_{{\boldsymbol{\theta}}}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">ℳ</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">ℳ</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{M}_{{\boldsymbol{\theta}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> employs a token embedding layer <math alttext="\boldsymbol{E}(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.2" xref="S3.SS1.p2.2.m2.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.2.2" xref="S3.SS1.p2.2.m2.1.2.2.cmml">𝑬</mi><mo id="S3.SS1.p2.2.m2.1.2.1" xref="S3.SS1.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.2.m2.1.2.3.2" xref="S3.SS1.p2.2.m2.1.2.cmml"><mo id="S3.SS1.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.2.m2.1.2.cmml">(</mo><mo id="S3.SS1.p2.2.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p2.2.m2.1.1.cmml">⋅</mo><mo id="S3.SS1.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.2.cmml" xref="S3.SS1.p2.2.m2.1.2"><times id="S3.SS1.p2.2.m2.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2.1"></times><ci id="S3.SS1.p2.2.m2.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.2">𝑬</ci><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\boldsymbol{E}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_italic_E ( ⋅ )</annotation></semantics></math> with parameters <math alttext="{{\boldsymbol{\theta}}}_{\boldsymbol{E}}\in{{\boldsymbol{\theta}}}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msub id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.cmml">𝜽</mi><mi id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">𝑬</mi></msub><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">∈</mo><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">𝜽</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><in id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></in><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2">𝜽</ci><ci id="S3.SS1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.3">𝑬</ci></apply><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">{{\boldsymbol{\theta}}}_{\boldsymbol{E}}\in{{\boldsymbol{\theta}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">bold_italic_θ start_POSTSUBSCRIPT bold_italic_E end_POSTSUBSCRIPT ∈ bold_italic_θ</annotation></semantics></math>, functioning as a lookup table that transforms each input token into a token embedding. It subsequently predicts the probability distribution of label tokens by forward propagation. The training objective is to minimize the negative log-likelihood of the label tokens conditioned on the input sequence and previously generated tokens, formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small{\boldsymbol{\theta}}^{*}=\operatorname*{arg\,min}_{{\boldsymbol{\theta}%
}}\mathcal{L}_{{\boldsymbol{\theta}}}=-\sum_{j=1}^{|\mathbf{y}|}\log P_{{%
\boldsymbol{\theta}}}\big{(}y_{j}\mid y_{&lt;j},\boldsymbol{E}(\mathbf{x})\big{)}," class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msup id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.3.2.cmml">𝜽</mi><mo id="S3.E1.m1.3.3.1.1.3.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.3.3.cmml">∗</mo></msup><mo id="S3.E1.m1.3.3.1.1.4" mathsize="90%" xref="S3.E1.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.5" xref="S3.E1.m1.3.3.1.1.5.cmml"><munder id="S3.E1.m1.3.3.1.1.5.1" xref="S3.E1.m1.3.3.1.1.5.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.5.1.2" xref="S3.E1.m1.3.3.1.1.5.1.2.cmml"><mi id="S3.E1.m1.3.3.1.1.5.1.2.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.5.1.2.2.cmml">arg</mi><mo id="S3.E1.m1.3.3.1.1.5.1.2.1" lspace="0.170em" xref="S3.E1.m1.3.3.1.1.5.1.2.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.5.1.2.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.5.1.2.3.cmml">min</mi></mrow><mi id="S3.E1.m1.3.3.1.1.5.1.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.5.1.3.cmml">𝜽</mi></munder><mo id="S3.E1.m1.3.3.1.1.5a" xref="S3.E1.m1.3.3.1.1.5.cmml">⁡</mo><msub id="S3.E1.m1.3.3.1.1.5.2" xref="S3.E1.m1.3.3.1.1.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.5.2.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.5.2.2.cmml">ℒ</mi><mi id="S3.E1.m1.3.3.1.1.5.2.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.5.2.3.cmml">𝜽</mi></msub></mrow><mo id="S3.E1.m1.3.3.1.1.6" mathsize="90%" xref="S3.E1.m1.3.3.1.1.6.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1a" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.cmml">−</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2.2.3.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E1.m1.3.3.1.1.1.1.2.2.3.1" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.1.1.1.1.2.2.3.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo><mi id="S3.E1.m1.1.1.1.1" mathsize="90%" xref="S3.E1.m1.1.1.1.1.cmml">𝐲</mi><mo id="S3.E1.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.3.1" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.3.2.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.3.2.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml">y</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml">j</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝑬</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2.1" maxsize="90%" minsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E1.m1.2.2" mathsize="90%" xref="S3.E1.m1.2.2.cmml">𝐱</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2.2" maxsize="90%" minsize="90%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" mathsize="90%" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><and id="S3.E1.m1.3.3.1.1a.cmml" xref="S3.E1.m1.3.3.1"></and><apply id="S3.E1.m1.3.3.1.1b.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">𝜽</ci><times id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3"></times></apply><apply id="S3.E1.m1.3.3.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.5"><apply id="S3.E1.m1.3.3.1.1.5.1.cmml" xref="S3.E1.m1.3.3.1.1.5.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.5.1.1.cmml" xref="S3.E1.m1.3.3.1.1.5.1">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.5.1.2.cmml" xref="S3.E1.m1.3.3.1.1.5.1.2"><times id="S3.E1.m1.3.3.1.1.5.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.5.1.2.1"></times><ci id="S3.E1.m1.3.3.1.1.5.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.5.1.2.2">arg</ci><ci id="S3.E1.m1.3.3.1.1.5.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.5.1.2.3">min</ci></apply><ci id="S3.E1.m1.3.3.1.1.5.1.3.cmml" xref="S3.E1.m1.3.3.1.1.5.1.3">𝜽</ci></apply><apply id="S3.E1.m1.3.3.1.1.5.2.cmml" xref="S3.E1.m1.3.3.1.1.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.5.2.1.cmml" xref="S3.E1.m1.3.3.1.1.5.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.5.2.2.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2">ℒ</ci><ci id="S3.E1.m1.3.3.1.1.5.2.3.cmml" xref="S3.E1.m1.3.3.1.1.5.2.3">𝜽</ci></apply></apply></apply><apply id="S3.E1.m1.3.3.1.1c.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.6"></eq><share href="https://arxiv.org/html/2406.08477v1#S3.E1.m1.3.3.1.1.5.cmml" id="S3.E1.m1.3.3.1.1d.cmml" xref="S3.E1.m1.3.3.1"></share><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><minus id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1"></minus><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E1.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.E1.m1.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.3"><abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.3.1"></abs><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝐲</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3"><log id="S3.E1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.1"></log><apply id="S3.E1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.3">𝜽</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.2">𝑦</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3">𝑗</ci></apply><list id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2">𝑬</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐱</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\small{\boldsymbol{\theta}}^{*}=\operatorname*{arg\,min}_{{\boldsymbol{\theta}%
}}\mathcal{L}_{{\boldsymbol{\theta}}}=-\sum_{j=1}^{|\mathbf{y}|}\log P_{{%
\boldsymbol{\theta}}}\big{(}y_{j}\mid y_{&lt;j},\boldsymbol{E}(\mathbf{x})\big{)},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">bold_italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | bold_y | end_POSTSUPERSCRIPT roman_log italic_P start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∣ italic_y start_POSTSUBSCRIPT &lt; italic_j end_POSTSUBSCRIPT , bold_italic_E ( bold_x ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.6">where <math alttext="{\boldsymbol{\theta}}^{*}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m1.1"><semantics id="S3.SS1.p2.4.m1.1a"><msup id="S3.SS1.p2.4.m1.1.1" xref="S3.SS1.p2.4.m1.1.1.cmml"><mi id="S3.SS1.p2.4.m1.1.1.2" xref="S3.SS1.p2.4.m1.1.1.2.cmml">𝜽</mi><mo id="S3.SS1.p2.4.m1.1.1.3" xref="S3.SS1.p2.4.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m1.1b"><apply id="S3.SS1.p2.4.m1.1.1.cmml" xref="S3.SS1.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m1.1.1.1.cmml" xref="S3.SS1.p2.4.m1.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m1.1.1.2.cmml" xref="S3.SS1.p2.4.m1.1.1.2">𝜽</ci><times id="S3.SS1.p2.4.m1.1.1.3.cmml" xref="S3.SS1.p2.4.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m1.1c">{\boldsymbol{\theta}}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m1.1d">bold_italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> represents the optimal set of parameters that we aim to learn. This supervised learning approach helps the model to internalize personalized information about users and items through the token embeddings of their respective IDs, <math alttext="\boldsymbol{x}_{u}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m2.1"><semantics id="S3.SS1.p2.5.m2.1a"><msub id="S3.SS1.p2.5.m2.1.1" xref="S3.SS1.p2.5.m2.1.1.cmml"><mi id="S3.SS1.p2.5.m2.1.1.2" xref="S3.SS1.p2.5.m2.1.1.2.cmml">𝒙</mi><mi id="S3.SS1.p2.5.m2.1.1.3" xref="S3.SS1.p2.5.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m2.1b"><apply id="S3.SS1.p2.5.m2.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m2.1.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m2.1.1.2.cmml" xref="S3.SS1.p2.5.m2.1.1.2">𝒙</ci><ci id="S3.SS1.p2.5.m2.1.1.3.cmml" xref="S3.SS1.p2.5.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m2.1c">\boldsymbol{x}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m2.1d">bold_italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\boldsymbol{x}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m3.1"><semantics id="S3.SS1.p2.6.m3.1a"><msub id="S3.SS1.p2.6.m3.1.1" xref="S3.SS1.p2.6.m3.1.1.cmml"><mi id="S3.SS1.p2.6.m3.1.1.2" xref="S3.SS1.p2.6.m3.1.1.2.cmml">𝒙</mi><mi id="S3.SS1.p2.6.m3.1.1.3" xref="S3.SS1.p2.6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m3.1b"><apply id="S3.SS1.p2.6.m3.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m3.1.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m3.1.1.2.cmml" xref="S3.SS1.p2.6.m3.1.1.2">𝒙</ci><ci id="S3.SS1.p2.6.m3.1.1.3.cmml" xref="S3.SS1.p2.6.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m3.1c">\boldsymbol{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m3.1d">bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Represent Users/Items with In-Vocabulary Tokens</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">The token embedding layer <math alttext="\boldsymbol{E}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝑬</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\boldsymbol{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_italic_E</annotation></semantics></math> in LLMs transforms input tokens into corresponding token embeddings. Since users and items are also represented by IDs constructed of tokens, the corresponding token embeddings of ID <math alttext="\boldsymbol{x}_{u}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝒙</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝒙</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\boldsymbol{x}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\boldsymbol{x}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">𝒙</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝒙</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\boldsymbol{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are the key to assess how LLMs capture and represent different items.
We define the <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.4.1">ID representation</span> for an ID <math alttext="\boldsymbol{x}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝒙</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝒙</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\boldsymbol{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as the average embeddings of its token combinations:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{e}_{i}=\frac{1}{|\boldsymbol{x}_{i}|}\sum_{x\in\boldsymbol{x}_{i}}%
\boldsymbol{E}(x)," class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><msub id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.2.cmml">𝐞</mi><mi id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mfrac id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mn id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">1</mn><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml"><munder id="S3.E2.m1.3.3.1.1.3.2.1" xref="S3.E2.m1.3.3.1.1.3.2.1.cmml"><mo id="S3.E2.m1.3.3.1.1.3.2.1.2" movablelimits="false" xref="S3.E2.m1.3.3.1.1.3.2.1.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.1.1.3.2.1.3" xref="S3.E2.m1.3.3.1.1.3.2.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.1.3.2.cmml">x</mi><mo id="S3.E2.m1.3.3.1.1.3.2.1.3.1" xref="S3.E2.m1.3.3.1.1.3.2.1.3.1.cmml">∈</mo><msub id="S3.E2.m1.3.3.1.1.3.2.1.3.3" xref="S3.E2.m1.3.3.1.1.3.2.1.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.2.1.3.3.2.cmml">𝒙</mi><mi id="S3.E2.m1.3.3.1.1.3.2.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.2.1.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S3.E2.m1.3.3.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.2.cmml">𝑬</mi><mo id="S3.E2.m1.3.3.1.1.3.2.2.1" xref="S3.E2.m1.3.3.1.1.3.2.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.3.2.2.3.2" xref="S3.E2.m1.3.3.1.1.3.2.2.cmml"><mo id="S3.E2.m1.3.3.1.1.3.2.2.3.2.1" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.2.2.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">x</mi><mo id="S3.E2.m1.3.3.1.1.3.2.2.3.2.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2">𝐞</ci><ci id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></times><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><divide id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1"></divide><cn id="S3.E2.m1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.3">1</cn><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2"></abs><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2"><apply id="S3.E2.m1.3.3.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.3.2.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1.2"></sum><apply id="S3.E2.m1.3.3.1.1.3.2.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1.3"><in id="S3.E2.m1.3.3.1.1.3.2.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1.3.1"></in><ci id="S3.E2.m1.3.3.1.1.3.2.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1.3.2">𝑥</ci><apply id="S3.E2.m1.3.3.1.1.3.2.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1.3.3.2">𝒙</ci><ci id="S3.E2.m1.3.3.1.1.3.2.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.3.3.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2"><times id="S3.E2.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.1"></times><ci id="S3.E2.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.2">𝑬</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\mathbf{e}_{i}=\frac{1}{|\boldsymbol{x}_{i}|}\sum_{x\in\boldsymbol{x}_{i}}%
\boldsymbol{E}(x),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG | bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_x ∈ bold_italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT bold_italic_E ( italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.6">where <math alttext="\boldsymbol{E}(x)" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m1.1"><semantics id="S3.SS2.p1.5.m1.1a"><mrow id="S3.SS2.p1.5.m1.1.2" xref="S3.SS2.p1.5.m1.1.2.cmml"><mi id="S3.SS2.p1.5.m1.1.2.2" xref="S3.SS2.p1.5.m1.1.2.2.cmml">𝑬</mi><mo id="S3.SS2.p1.5.m1.1.2.1" xref="S3.SS2.p1.5.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.5.m1.1.2.3.2" xref="S3.SS2.p1.5.m1.1.2.cmml"><mo id="S3.SS2.p1.5.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.5.m1.1.2.cmml">(</mo><mi id="S3.SS2.p1.5.m1.1.1" xref="S3.SS2.p1.5.m1.1.1.cmml">x</mi><mo id="S3.SS2.p1.5.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m1.1b"><apply id="S3.SS2.p1.5.m1.1.2.cmml" xref="S3.SS2.p1.5.m1.1.2"><times id="S3.SS2.p1.5.m1.1.2.1.cmml" xref="S3.SS2.p1.5.m1.1.2.1"></times><ci id="S3.SS2.p1.5.m1.1.2.2.cmml" xref="S3.SS2.p1.5.m1.1.2.2">𝑬</ci><ci id="S3.SS2.p1.5.m1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m1.1c">\boldsymbol{E}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m1.1d">bold_italic_E ( italic_x )</annotation></semantics></math> denotes the embedding vector of a token <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m2.1"><semantics id="S3.SS2.p1.6.m2.1a"><mi id="S3.SS2.p1.6.m2.1.1" xref="S3.SS2.p1.6.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m2.1b"><ci id="S3.SS2.p1.6.m2.1.1.cmml" xref="S3.SS2.p1.6.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m2.1d">italic_x</annotation></semantics></math>. For example, an item identified by “item 2024” is represented by the average embedding vectors of three tokens (“item”, “20”, “24”).</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="203" id="S3.F2.sf1.g1" src="x3.png" width="299"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="195" id="S3.F2.sf2.g1" src="x4.png" width="289"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.3.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.4.2" style="font-size:90%;"> (a) T-SNE visualizations of ID representations on Sports dataset; (b) Comparison of DS and MS of ID representations from RID, SID, CID and META ID.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Metric for Representation Evaluation</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">As mentioned above, using numeric IDs to represent items leads to similar representations of distinctive items. For an intuitive explanation, we first visualize the cosine similarity matrix between items using heatmaps in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">1</span></a>, where RID and SID result in a large number of similar items due to semantic conflicts, and META ID constructed of OOV tokens shows distinguished similarity closer to the ground truth. We further plot the ID representations using T-SNE visualization in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:score-tsne</span>. It is clear that RID and SID (using in-vocabulary tokens) shrink in a small place relative to CID (using OOV tokens), reflecting in-vocabulary tokens lacking expressive power for distinctive users and items. Details are in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS3" title="5.3 Evaluation of ID Representation ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">5.3</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">To quantify this, we introduce two metrics to assess the <span class="ltx_text ltx_font_italic" id="S3.SS3.p2.1.1">memorization</span> and <span class="ltx_text ltx_font_italic" id="S3.SS3.p2.1.2">diversity</span> of ID representations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.4"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.4.1">Diversity Score (DS)</span> is a metric designed to quantify the diversity of ID representations within LLMs. Items represented by ID representations should be easily distinguishable for the model. For a pair of items <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">italic_j</annotation></semantics></math>, their differentiation can be calculated using the Kullback-Leibler (KL) divergence on ID representations <math alttext="\mathbf{e}_{i}\in E" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><msub id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml">𝐞</mi><mi id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">∈</mo><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><in id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1"></in><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2">𝐞</ci><ci id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\mathbf{e}_{i}\in E</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_E</annotation></semantics></math> and <math alttext="\mathbf{e}_{j}\in\mathbf{E}" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><mrow id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><msub id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2.2" xref="S3.SS3.p3.4.m4.1.1.2.2.cmml">𝐞</mi><mi id="S3.SS3.p3.4.m4.1.1.2.3" xref="S3.SS3.p3.4.m4.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS3.p3.4.m4.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.cmml">∈</mo><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">𝐄</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><in id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1"></in><apply id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.2.1.cmml" xref="S3.SS3.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2.2">𝐞</ci><ci id="S3.SS3.p3.4.m4.1.1.2.3.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3">𝑗</ci></apply><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝐄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\mathbf{e}_{j}\in\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">bold_e start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ bold_E</annotation></semantics></math> from Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.E2" title="Equation 2 ‣ 3.2 Represent Users/Items with In-Vocabulary Tokens ‣ 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">2</span></a>, which reflects how distinct they are in the model’s embedding space:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\text{DS}(\mathbf{E})=\frac{1}{2N}\sum_{n=1}^{N}{\bigg{[}{D_{KL}(\mathbf%
{e}_{i}||\mathbf{e}_{j})+D_{KL}(\mathbf{e}_{j}||\mathbf{e}_{i})}\bigg{]}}." class="ltx_math_unparsed" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1b"><mtext id="S3.E3.m1.1.2" mathsize="90%">DS</mtext><mrow id="S3.E3.m1.1.3"><mo id="S3.E3.m1.1.3.1" maxsize="90%" minsize="90%">(</mo><mi id="S3.E3.m1.1.1" mathsize="90%">𝐄</mi><mo id="S3.E3.m1.1.3.2" maxsize="90%" minsize="90%">)</mo></mrow><mo id="S3.E3.m1.1.4" mathsize="90%">=</mo><mfrac id="S3.E3.m1.1.5"><mn id="S3.E3.m1.1.5.2" mathsize="90%">1</mn><mrow id="S3.E3.m1.1.5.3"><mn id="S3.E3.m1.1.5.3.2" mathsize="90%">2</mn><mo id="S3.E3.m1.1.5.3.1">⁢</mo><mi id="S3.E3.m1.1.5.3.3" mathsize="90%">N</mi></mrow></mfrac><munderover id="S3.E3.m1.1.6"><mo id="S3.E3.m1.1.6.2.2" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true">∑</mo><mrow id="S3.E3.m1.1.6.2.3"><mi id="S3.E3.m1.1.6.2.3.2" mathsize="90%">n</mi><mo id="S3.E3.m1.1.6.2.3.1" mathsize="90%">=</mo><mn id="S3.E3.m1.1.6.2.3.3" mathsize="90%">1</mn></mrow><mi id="S3.E3.m1.1.6.3" mathsize="90%">N</mi></munderover><mrow id="S3.E3.m1.1.7"><mo id="S3.E3.m1.1.7.1" maxsize="210%" minsize="210%">[</mo><msub id="S3.E3.m1.1.7.2"><mi id="S3.E3.m1.1.7.2.2" mathsize="90%">D</mi><mrow id="S3.E3.m1.1.7.2.3"><mi id="S3.E3.m1.1.7.2.3.2" mathsize="90%">K</mi><mo id="S3.E3.m1.1.7.2.3.1">⁢</mo><mi id="S3.E3.m1.1.7.2.3.3" mathsize="90%">L</mi></mrow></msub><mrow id="S3.E3.m1.1.7.3"><mo id="S3.E3.m1.1.7.3.1" maxsize="90%" minsize="90%">(</mo><msub id="S3.E3.m1.1.7.3.2"><mi id="S3.E3.m1.1.7.3.2.2" mathsize="90%">𝐞</mi><mi id="S3.E3.m1.1.7.3.2.3" mathsize="90%">i</mi></msub><mo fence="false" id="S3.E3.m1.1.7.3.3" maxsize="90%" minsize="90%" rspace="0.167em">|</mo><mo fence="false" id="S3.E3.m1.1.7.3.4" maxsize="90%" minsize="90%" rspace="0.167em">|</mo><msub id="S3.E3.m1.1.7.3.5"><mi id="S3.E3.m1.1.7.3.5.2" mathsize="90%">𝐞</mi><mi id="S3.E3.m1.1.7.3.5.3" mathsize="90%">j</mi></msub><mo id="S3.E3.m1.1.7.3.6" maxsize="90%" minsize="90%">)</mo></mrow><mo id="S3.E3.m1.1.7.4" mathsize="90%">+</mo><msub id="S3.E3.m1.1.7.5"><mi id="S3.E3.m1.1.7.5.2" mathsize="90%">D</mi><mrow id="S3.E3.m1.1.7.5.3"><mi id="S3.E3.m1.1.7.5.3.2" mathsize="90%">K</mi><mo id="S3.E3.m1.1.7.5.3.1">⁢</mo><mi id="S3.E3.m1.1.7.5.3.3" mathsize="90%">L</mi></mrow></msub><mrow id="S3.E3.m1.1.7.6"><mo id="S3.E3.m1.1.7.6.1" maxsize="90%" minsize="90%">(</mo><msub id="S3.E3.m1.1.7.6.2"><mi id="S3.E3.m1.1.7.6.2.2" mathsize="90%">𝐞</mi><mi id="S3.E3.m1.1.7.6.2.3" mathsize="90%">j</mi></msub><mo fence="false" id="S3.E3.m1.1.7.6.3" maxsize="90%" minsize="90%" rspace="0.167em">|</mo><mo fence="false" id="S3.E3.m1.1.7.6.4" maxsize="90%" minsize="90%" rspace="0.167em">|</mo><msub id="S3.E3.m1.1.7.6.5"><mi id="S3.E3.m1.1.7.6.5.2" mathsize="90%">𝐞</mi><mi id="S3.E3.m1.1.7.6.5.3" mathsize="90%">i</mi></msub><mo id="S3.E3.m1.1.7.6.6" maxsize="90%" minsize="90%">)</mo></mrow><mo id="S3.E3.m1.1.7.7" maxsize="210%" minsize="210%">]</mo></mrow><mo id="S3.E3.m1.1.8" lspace="0em" mathsize="90%">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\small\text{DS}(\mathbf{E})=\frac{1}{2N}\sum_{n=1}^{N}{\bigg{[}{D_{KL}(\mathbf%
{e}_{i}||\mathbf{e}_{j})+D_{KL}(\mathbf{e}_{j}||\mathbf{e}_{i})}\bigg{]}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">DS ( bold_E ) = divide start_ARG 1 end_ARG start_ARG 2 italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | | bold_e start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) + italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( bold_e start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | | bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.5">Here, <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m1.1"><semantics id="S3.SS3.p3.5.m1.1a"><mi id="S3.SS3.p3.5.m1.1.1" xref="S3.SS3.p3.5.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m1.1b"><ci id="S3.SS3.p3.5.m1.1.1.cmml" xref="S3.SS3.p3.5.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m1.1d">italic_N</annotation></semantics></math> represents the number of randomly selected item pairs, where we apply a sampling strategy to reduce the computational complexity, and we give a convergence analysis in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1.F6" title="Figure 6 ‣ A.3 How to incorporate META ID with LLMs ‣ Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.8"><span class="ltx_text ltx_font_bold" id="S3.SS3.p4.8.1">Memorization Score (MS)</span> quantifies the relationships captured by ID representations through measuring the similarity between items and users. We use the adjusted cosine similarity formula <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib34" title=""><span class="ltx_text" style="font-size:90%;">34</span></a>]</cite>, to provides ground truth relational values between users and items, which are given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\text{sim}(i,j)=\frac{\sum_{u\in U}(R_{u,i}-\bar{R}_{u})\cdot(R_{u,j}-%
\bar{R}_{u})}{{\sqrt{\sum_{u\in U}{(R_{u,i}-\bar{R}_{u})^{2}}\cdot{\sum_{u\in U%
}{(R_{u,j}-\bar{R}_{u})^{2}}}}}}," class="ltx_Math" display="block" id="S3.E4.m1.15"><semantics id="S3.E4.m1.15a"><mrow id="S3.E4.m1.15.15.1" xref="S3.E4.m1.15.15.1.1.cmml"><mrow id="S3.E4.m1.15.15.1.1" xref="S3.E4.m1.15.15.1.1.cmml"><mrow id="S3.E4.m1.15.15.1.1.2" xref="S3.E4.m1.15.15.1.1.2.cmml"><mtext id="S3.E4.m1.15.15.1.1.2.2" mathsize="90%" xref="S3.E4.m1.15.15.1.1.2.2a.cmml">sim</mtext><mo id="S3.E4.m1.15.15.1.1.2.1" xref="S3.E4.m1.15.15.1.1.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.15.15.1.1.2.3.2" xref="S3.E4.m1.15.15.1.1.2.3.1.cmml"><mo id="S3.E4.m1.15.15.1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S3.E4.m1.15.15.1.1.2.3.1.cmml">(</mo><mi id="S3.E4.m1.13.13" mathsize="90%" xref="S3.E4.m1.13.13.cmml">i</mi><mo id="S3.E4.m1.15.15.1.1.2.3.2.2" mathsize="90%" xref="S3.E4.m1.15.15.1.1.2.3.1.cmml">,</mo><mi id="S3.E4.m1.14.14" mathsize="90%" xref="S3.E4.m1.14.14.cmml">j</mi><mo id="S3.E4.m1.15.15.1.1.2.3.2.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.15.15.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.15.15.1.1.1" mathsize="90%" xref="S3.E4.m1.15.15.1.1.1.cmml">=</mo><mfrac id="S3.E4.m1.12.12" xref="S3.E4.m1.12.12.cmml"><mrow id="S3.E4.m1.6.6.6" xref="S3.E4.m1.6.6.6.cmml"><msub id="S3.E4.m1.6.6.6.7" xref="S3.E4.m1.6.6.6.7.cmml"><mo id="S3.E4.m1.6.6.6.7.2" maxsize="90%" minsize="90%" stretchy="true" xref="S3.E4.m1.6.6.6.7.2.cmml">∑</mo><mrow id="S3.E4.m1.6.6.6.7.3" xref="S3.E4.m1.6.6.6.7.3.cmml"><mi id="S3.E4.m1.6.6.6.7.3.2" mathsize="90%" xref="S3.E4.m1.6.6.6.7.3.2.cmml">u</mi><mo id="S3.E4.m1.6.6.6.7.3.1" mathsize="90%" xref="S3.E4.m1.6.6.6.7.3.1.cmml">∈</mo><mi id="S3.E4.m1.6.6.6.7.3.3" mathsize="90%" xref="S3.E4.m1.6.6.6.7.3.3.cmml">U</mi></mrow></msub><mrow id="S3.E4.m1.6.6.6.6" xref="S3.E4.m1.6.6.6.6.cmml"><mrow id="S3.E4.m1.5.5.5.5.1.1" xref="S3.E4.m1.5.5.5.5.1.1.1.cmml"><mo id="S3.E4.m1.5.5.5.5.1.1.2" lspace="0em" maxsize="90%" minsize="90%" xref="S3.E4.m1.5.5.5.5.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.5.5.5.5.1.1.1" xref="S3.E4.m1.5.5.5.5.1.1.1.cmml"><msub id="S3.E4.m1.5.5.5.5.1.1.1.2" xref="S3.E4.m1.5.5.5.5.1.1.1.2.cmml"><mi id="S3.E4.m1.5.5.5.5.1.1.1.2.2" mathsize="90%" xref="S3.E4.m1.5.5.5.5.1.1.1.2.2.cmml">R</mi><mrow id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" mathsize="90%" xref="S3.E4.m1.1.1.1.1.1.1.cmml">u</mi><mo id="S3.E4.m1.2.2.2.2.2.4.1" mathsize="90%" xref="S3.E4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.2.2" mathsize="90%" xref="S3.E4.m1.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E4.m1.5.5.5.5.1.1.1.1" mathsize="90%" xref="S3.E4.m1.5.5.5.5.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.5.5.5.5.1.1.1.3" xref="S3.E4.m1.5.5.5.5.1.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.5.5.5.5.1.1.1.3.2" xref="S3.E4.m1.5.5.5.5.1.1.1.3.2.cmml"><mi id="S3.E4.m1.5.5.5.5.1.1.1.3.2.2" mathsize="90%" xref="S3.E4.m1.5.5.5.5.1.1.1.3.2.2.cmml">R</mi><mo id="S3.E4.m1.5.5.5.5.1.1.1.3.2.1" mathsize="90%" xref="S3.E4.m1.5.5.5.5.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="S3.E4.m1.5.5.5.5.1.1.1.3.3" mathsize="90%" xref="S3.E4.m1.5.5.5.5.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="S3.E4.m1.5.5.5.5.1.1.3" maxsize="90%" minsize="90%" rspace="0.055em" xref="S3.E4.m1.5.5.5.5.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.6.6.6.6.3" mathsize="90%" rspace="0.222em" xref="S3.E4.m1.6.6.6.6.3.cmml">⋅</mo><mrow id="S3.E4.m1.6.6.6.6.2.1" xref="S3.E4.m1.6.6.6.6.2.1.1.cmml"><mo id="S3.E4.m1.6.6.6.6.2.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.6.6.6.6.2.1.1.cmml">(</mo><mrow id="S3.E4.m1.6.6.6.6.2.1.1" xref="S3.E4.m1.6.6.6.6.2.1.1.cmml"><msub id="S3.E4.m1.6.6.6.6.2.1.1.2" xref="S3.E4.m1.6.6.6.6.2.1.1.2.cmml"><mi id="S3.E4.m1.6.6.6.6.2.1.1.2.2" mathsize="90%" xref="S3.E4.m1.6.6.6.6.2.1.1.2.2.cmml">R</mi><mrow id="S3.E4.m1.4.4.4.4.2.4" xref="S3.E4.m1.4.4.4.4.2.3.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1" mathsize="90%" xref="S3.E4.m1.3.3.3.3.1.1.cmml">u</mi><mo id="S3.E4.m1.4.4.4.4.2.4.1" mathsize="90%" xref="S3.E4.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.4.4.4.4.2.2" mathsize="90%" xref="S3.E4.m1.4.4.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.E4.m1.6.6.6.6.2.1.1.1" mathsize="90%" xref="S3.E4.m1.6.6.6.6.2.1.1.1.cmml">−</mo><msub id="S3.E4.m1.6.6.6.6.2.1.1.3" xref="S3.E4.m1.6.6.6.6.2.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.6.6.6.6.2.1.1.3.2" xref="S3.E4.m1.6.6.6.6.2.1.1.3.2.cmml"><mi id="S3.E4.m1.6.6.6.6.2.1.1.3.2.2" mathsize="90%" xref="S3.E4.m1.6.6.6.6.2.1.1.3.2.2.cmml">R</mi><mo id="S3.E4.m1.6.6.6.6.2.1.1.3.2.1" mathsize="90%" xref="S3.E4.m1.6.6.6.6.2.1.1.3.2.1.cmml">¯</mo></mover><mi id="S3.E4.m1.6.6.6.6.2.1.1.3.3" mathsize="90%" xref="S3.E4.m1.6.6.6.6.2.1.1.3.3.cmml">u</mi></msub></mrow><mo id="S3.E4.m1.6.6.6.6.2.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.6.6.6.6.2.1.1.cmml">)</mo></mrow></mrow></mrow><msqrt id="S3.E4.m1.12.12.12" xref="S3.E4.m1.12.12.12.cmml"><mrow id="S3.E4.m1.12.12.12.6.6" xref="S3.E4.m1.12.12.12.6.6.cmml"><msub id="S3.E4.m1.12.12.12.6.6.7" xref="S3.E4.m1.12.12.12.6.6.7.cmml"><mo id="S3.E4.m1.12.12.12.6.6.7.2" maxsize="90%" minsize="90%" stretchy="true" xref="S3.E4.m1.12.12.12.6.6.7.2.cmml">∑</mo><mrow id="S3.E4.m1.12.12.12.6.6.7.3" xref="S3.E4.m1.12.12.12.6.6.7.3.cmml"><mi id="S3.E4.m1.12.12.12.6.6.7.3.2" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.7.3.2.cmml">u</mi><mo id="S3.E4.m1.12.12.12.6.6.7.3.1" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.7.3.1.cmml">∈</mo><mi id="S3.E4.m1.12.12.12.6.6.7.3.3" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.7.3.3.cmml">U</mi></mrow></msub><mrow id="S3.E4.m1.12.12.12.6.6.6" xref="S3.E4.m1.12.12.12.6.6.6.cmml"><msup id="S3.E4.m1.11.11.11.5.5.5.1" xref="S3.E4.m1.11.11.11.5.5.5.1.cmml"><mrow id="S3.E4.m1.11.11.11.5.5.5.1.1.1" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.cmml"><mo id="S3.E4.m1.11.11.11.5.5.5.1.1.1.2" lspace="0em" maxsize="90%" minsize="90%" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.cmml"><msub id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2.cmml"><mi id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2.2" mathsize="90%" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2.2.cmml">R</mi><mrow id="S3.E4.m1.8.8.8.2.2.2.2.4" xref="S3.E4.m1.8.8.8.2.2.2.2.3.cmml"><mi id="S3.E4.m1.7.7.7.1.1.1.1.1" mathsize="90%" xref="S3.E4.m1.7.7.7.1.1.1.1.1.cmml">u</mi><mo id="S3.E4.m1.8.8.8.2.2.2.2.4.1" mathsize="90%" xref="S3.E4.m1.8.8.8.2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.8.8.8.2.2.2.2.2" mathsize="90%" xref="S3.E4.m1.8.8.8.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.1" mathsize="90%" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.cmml"><mi id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.2" mathsize="90%" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.2.cmml">R</mi><mo id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.1" mathsize="90%" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.3" mathsize="90%" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="S3.E4.m1.11.11.11.5.5.5.1.1.1.3" maxsize="90%" minsize="90%" rspace="0.055em" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E4.m1.11.11.11.5.5.5.1.3" mathsize="90%" xref="S3.E4.m1.11.11.11.5.5.5.1.3.cmml">2</mn></msup><mo id="S3.E4.m1.12.12.12.6.6.6.3" mathsize="90%" rspace="0.055em" xref="S3.E4.m1.12.12.12.6.6.6.3.cmml">⋅</mo><mrow id="S3.E4.m1.12.12.12.6.6.6.2" xref="S3.E4.m1.12.12.12.6.6.6.2.cmml"><msub id="S3.E4.m1.12.12.12.6.6.6.2.2" xref="S3.E4.m1.12.12.12.6.6.6.2.2.cmml"><mo id="S3.E4.m1.12.12.12.6.6.6.2.2.2" maxsize="90%" minsize="90%" rspace="0em" stretchy="true" xref="S3.E4.m1.12.12.12.6.6.6.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.12.12.12.6.6.6.2.2.3" xref="S3.E4.m1.12.12.12.6.6.6.2.2.3.cmml"><mi id="S3.E4.m1.12.12.12.6.6.6.2.2.3.2" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.2.3.2.cmml">u</mi><mo id="S3.E4.m1.12.12.12.6.6.6.2.2.3.1" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.2.3.1.cmml">∈</mo><mi id="S3.E4.m1.12.12.12.6.6.6.2.2.3.3" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.2.3.3.cmml">U</mi></mrow></msub><msup id="S3.E4.m1.12.12.12.6.6.6.2.1" xref="S3.E4.m1.12.12.12.6.6.6.2.1.cmml"><mrow id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.cmml"><mo id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.cmml"><msub id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2.cmml"><mi id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2.2" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2.2.cmml">R</mi><mrow id="S3.E4.m1.10.10.10.4.4.4.2.4" xref="S3.E4.m1.10.10.10.4.4.4.2.3.cmml"><mi id="S3.E4.m1.9.9.9.3.3.3.1.1" mathsize="90%" xref="S3.E4.m1.9.9.9.3.3.3.1.1.cmml">u</mi><mo id="S3.E4.m1.10.10.10.4.4.4.2.4.1" mathsize="90%" xref="S3.E4.m1.10.10.10.4.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.10.10.10.4.4.4.2.2" mathsize="90%" xref="S3.E4.m1.10.10.10.4.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.1" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.cmml"><mi id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.2" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.2.cmml">R</mi><mo id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.1" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.3" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E4.m1.12.12.12.6.6.6.2.1.3" mathsize="90%" xref="S3.E4.m1.12.12.12.6.6.6.2.1.3.cmml">2</mn></msup></mrow></mrow></mrow></msqrt></mfrac></mrow><mo id="S3.E4.m1.15.15.1.2" mathsize="90%" xref="S3.E4.m1.15.15.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.15b"><apply id="S3.E4.m1.15.15.1.1.cmml" xref="S3.E4.m1.15.15.1"><eq id="S3.E4.m1.15.15.1.1.1.cmml" xref="S3.E4.m1.15.15.1.1.1"></eq><apply id="S3.E4.m1.15.15.1.1.2.cmml" xref="S3.E4.m1.15.15.1.1.2"><times id="S3.E4.m1.15.15.1.1.2.1.cmml" xref="S3.E4.m1.15.15.1.1.2.1"></times><ci id="S3.E4.m1.15.15.1.1.2.2a.cmml" xref="S3.E4.m1.15.15.1.1.2.2"><mtext id="S3.E4.m1.15.15.1.1.2.2.cmml" mathsize="90%" xref="S3.E4.m1.15.15.1.1.2.2">sim</mtext></ci><interval closure="open" id="S3.E4.m1.15.15.1.1.2.3.1.cmml" xref="S3.E4.m1.15.15.1.1.2.3.2"><ci id="S3.E4.m1.13.13.cmml" xref="S3.E4.m1.13.13">𝑖</ci><ci id="S3.E4.m1.14.14.cmml" xref="S3.E4.m1.14.14">𝑗</ci></interval></apply><apply id="S3.E4.m1.12.12.cmml" xref="S3.E4.m1.12.12"><divide id="S3.E4.m1.12.12.13.cmml" xref="S3.E4.m1.12.12"></divide><apply id="S3.E4.m1.6.6.6.cmml" xref="S3.E4.m1.6.6.6"><apply id="S3.E4.m1.6.6.6.7.cmml" xref="S3.E4.m1.6.6.6.7"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.7.1.cmml" xref="S3.E4.m1.6.6.6.7">subscript</csymbol><sum id="S3.E4.m1.6.6.6.7.2.cmml" xref="S3.E4.m1.6.6.6.7.2"></sum><apply id="S3.E4.m1.6.6.6.7.3.cmml" xref="S3.E4.m1.6.6.6.7.3"><in id="S3.E4.m1.6.6.6.7.3.1.cmml" xref="S3.E4.m1.6.6.6.7.3.1"></in><ci id="S3.E4.m1.6.6.6.7.3.2.cmml" xref="S3.E4.m1.6.6.6.7.3.2">𝑢</ci><ci id="S3.E4.m1.6.6.6.7.3.3.cmml" xref="S3.E4.m1.6.6.6.7.3.3">𝑈</ci></apply></apply><apply id="S3.E4.m1.6.6.6.6.cmml" xref="S3.E4.m1.6.6.6.6"><ci id="S3.E4.m1.6.6.6.6.3.cmml" xref="S3.E4.m1.6.6.6.6.3">⋅</ci><apply id="S3.E4.m1.5.5.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1"><minus id="S3.E4.m1.5.5.5.5.1.1.1.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.1"></minus><apply id="S3.E4.m1.5.5.5.5.1.1.1.2.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.5.1.1.1.2.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.5.5.5.5.1.1.1.2.2.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.2.2">𝑅</ci><list id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑢</ci><ci id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E4.m1.5.5.5.5.1.1.1.3.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.5.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.5.5.5.5.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3.2"><ci id="S3.E4.m1.5.5.5.5.1.1.1.3.2.1.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3.2.1">¯</ci><ci id="S3.E4.m1.5.5.5.5.1.1.1.3.2.2.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3.2.2">𝑅</ci></apply><ci id="S3.E4.m1.5.5.5.5.1.1.1.3.3.cmml" xref="S3.E4.m1.5.5.5.5.1.1.1.3.3">𝑢</ci></apply></apply><apply id="S3.E4.m1.6.6.6.6.2.1.1.cmml" xref="S3.E4.m1.6.6.6.6.2.1"><minus id="S3.E4.m1.6.6.6.6.2.1.1.1.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.1"></minus><apply id="S3.E4.m1.6.6.6.6.2.1.1.2.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.6.2.1.1.2.1.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.2">subscript</csymbol><ci id="S3.E4.m1.6.6.6.6.2.1.1.2.2.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.2.2">𝑅</ci><list id="S3.E4.m1.4.4.4.4.2.3.cmml" xref="S3.E4.m1.4.4.4.4.2.4"><ci id="S3.E4.m1.3.3.3.3.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1">𝑢</ci><ci id="S3.E4.m1.4.4.4.4.2.2.cmml" xref="S3.E4.m1.4.4.4.4.2.2">𝑗</ci></list></apply><apply id="S3.E4.m1.6.6.6.6.2.1.1.3.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.6.2.1.1.3.1.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.3">subscript</csymbol><apply id="S3.E4.m1.6.6.6.6.2.1.1.3.2.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.3.2"><ci id="S3.E4.m1.6.6.6.6.2.1.1.3.2.1.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.3.2.1">¯</ci><ci id="S3.E4.m1.6.6.6.6.2.1.1.3.2.2.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.3.2.2">𝑅</ci></apply><ci id="S3.E4.m1.6.6.6.6.2.1.1.3.3.cmml" xref="S3.E4.m1.6.6.6.6.2.1.1.3.3">𝑢</ci></apply></apply></apply></apply><apply id="S3.E4.m1.12.12.12.cmml" xref="S3.E4.m1.12.12.12"><root id="S3.E4.m1.12.12.12a.cmml" xref="S3.E4.m1.12.12.12"></root><apply id="S3.E4.m1.12.12.12.6.6.cmml" xref="S3.E4.m1.12.12.12.6.6"><apply id="S3.E4.m1.12.12.12.6.6.7.cmml" xref="S3.E4.m1.12.12.12.6.6.7"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.6.6.7.1.cmml" xref="S3.E4.m1.12.12.12.6.6.7">subscript</csymbol><sum id="S3.E4.m1.12.12.12.6.6.7.2.cmml" xref="S3.E4.m1.12.12.12.6.6.7.2"></sum><apply id="S3.E4.m1.12.12.12.6.6.7.3.cmml" xref="S3.E4.m1.12.12.12.6.6.7.3"><in id="S3.E4.m1.12.12.12.6.6.7.3.1.cmml" xref="S3.E4.m1.12.12.12.6.6.7.3.1"></in><ci id="S3.E4.m1.12.12.12.6.6.7.3.2.cmml" xref="S3.E4.m1.12.12.12.6.6.7.3.2">𝑢</ci><ci id="S3.E4.m1.12.12.12.6.6.7.3.3.cmml" xref="S3.E4.m1.12.12.12.6.6.7.3.3">𝑈</ci></apply></apply><apply id="S3.E4.m1.12.12.12.6.6.6.cmml" xref="S3.E4.m1.12.12.12.6.6.6"><ci id="S3.E4.m1.12.12.12.6.6.6.3.cmml" xref="S3.E4.m1.12.12.12.6.6.6.3">⋅</ci><apply id="S3.E4.m1.11.11.11.5.5.5.1.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.11.5.5.5.1.2.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1">superscript</csymbol><apply id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1"><minus id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.1"></minus><apply id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2.1.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2.2.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.2.2">𝑅</ci><list id="S3.E4.m1.8.8.8.2.2.2.2.3.cmml" xref="S3.E4.m1.8.8.8.2.2.2.2.4"><ci id="S3.E4.m1.7.7.7.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.7.1.1.1.1.1">𝑢</ci><ci id="S3.E4.m1.8.8.8.2.2.2.2.2.cmml" xref="S3.E4.m1.8.8.8.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.1.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2"><ci id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.1">¯</ci><ci id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.2.2">𝑅</ci></apply><ci id="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.3.cmml" xref="S3.E4.m1.11.11.11.5.5.5.1.1.1.1.3.3">𝑢</ci></apply></apply><cn id="S3.E4.m1.11.11.11.5.5.5.1.3.cmml" type="integer" xref="S3.E4.m1.11.11.11.5.5.5.1.3">2</cn></apply><apply id="S3.E4.m1.12.12.12.6.6.6.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2"><apply id="S3.E4.m1.12.12.12.6.6.6.2.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.6.6.6.2.2.1.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.2">subscript</csymbol><sum id="S3.E4.m1.12.12.12.6.6.6.2.2.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.2.2"></sum><apply id="S3.E4.m1.12.12.12.6.6.6.2.2.3.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.2.3"><in id="S3.E4.m1.12.12.12.6.6.6.2.2.3.1.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.2.3.1"></in><ci id="S3.E4.m1.12.12.12.6.6.6.2.2.3.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.2.3.2">𝑢</ci><ci id="S3.E4.m1.12.12.12.6.6.6.2.2.3.3.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.2.3.3">𝑈</ci></apply></apply><apply id="S3.E4.m1.12.12.12.6.6.6.2.1.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.6.6.6.2.1.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1">superscript</csymbol><apply id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1"><minus id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.1.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.1"></minus><apply id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2.1.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.2.2">𝑅</ci><list id="S3.E4.m1.10.10.10.4.4.4.2.3.cmml" xref="S3.E4.m1.10.10.10.4.4.4.2.4"><ci id="S3.E4.m1.9.9.9.3.3.3.1.1.cmml" xref="S3.E4.m1.9.9.9.3.3.3.1.1">𝑢</ci><ci id="S3.E4.m1.10.10.10.4.4.4.2.2.cmml" xref="S3.E4.m1.10.10.10.4.4.4.2.2">𝑗</ci></list></apply><apply id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.1.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2"><ci id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.1">¯</ci><ci id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.2">𝑅</ci></apply><ci id="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.3.cmml" xref="S3.E4.m1.12.12.12.6.6.6.2.1.1.1.1.3.3">𝑢</ci></apply></apply><cn id="S3.E4.m1.12.12.12.6.6.6.2.1.3.cmml" type="integer" xref="S3.E4.m1.12.12.12.6.6.6.2.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.15c">\small\text{sim}(i,j)=\frac{\sum_{u\in U}(R_{u,i}-\bar{R}_{u})\cdot(R_{u,j}-%
\bar{R}_{u})}{{\sqrt{\sum_{u\in U}{(R_{u,i}-\bar{R}_{u})^{2}}\cdot{\sum_{u\in U%
}{(R_{u,j}-\bar{R}_{u})^{2}}}}}},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.15d">sim ( italic_i , italic_j ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) ⋅ ( italic_R start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) end_ARG start_ARG square-root start_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p4.7">where <math alttext="R_{u,i}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.2"><semantics id="S3.SS3.p4.1.m1.2a"><msub id="S3.SS3.p4.1.m1.2.3" xref="S3.SS3.p4.1.m1.2.3.cmml"><mi id="S3.SS3.p4.1.m1.2.3.2" xref="S3.SS3.p4.1.m1.2.3.2.cmml">R</mi><mrow id="S3.SS3.p4.1.m1.2.2.2.4" xref="S3.SS3.p4.1.m1.2.2.2.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.cmml">u</mi><mo id="S3.SS3.p4.1.m1.2.2.2.4.1" xref="S3.SS3.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.1.m1.2.2.2.2" xref="S3.SS3.p4.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.2b"><apply id="S3.SS3.p4.1.m1.2.3.cmml" xref="S3.SS3.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.2.3.1.cmml" xref="S3.SS3.p4.1.m1.2.3">subscript</csymbol><ci id="S3.SS3.p4.1.m1.2.3.2.cmml" xref="S3.SS3.p4.1.m1.2.3.2">𝑅</ci><list id="S3.SS3.p4.1.m1.2.2.2.3.cmml" xref="S3.SS3.p4.1.m1.2.2.2.4"><ci id="S3.SS3.p4.1.m1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1">𝑢</ci><ci id="S3.SS3.p4.1.m1.2.2.2.2.cmml" xref="S3.SS3.p4.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.2c">R_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.2d">italic_R start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="R_{u,j}" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.2"><semantics id="S3.SS3.p4.2.m2.2a"><msub id="S3.SS3.p4.2.m2.2.3" xref="S3.SS3.p4.2.m2.2.3.cmml"><mi id="S3.SS3.p4.2.m2.2.3.2" xref="S3.SS3.p4.2.m2.2.3.2.cmml">R</mi><mrow id="S3.SS3.p4.2.m2.2.2.2.4" xref="S3.SS3.p4.2.m2.2.2.2.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.cmml">u</mi><mo id="S3.SS3.p4.2.m2.2.2.2.4.1" xref="S3.SS3.p4.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p4.2.m2.2.2.2.2" xref="S3.SS3.p4.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.2b"><apply id="S3.SS3.p4.2.m2.2.3.cmml" xref="S3.SS3.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.2.3.1.cmml" xref="S3.SS3.p4.2.m2.2.3">subscript</csymbol><ci id="S3.SS3.p4.2.m2.2.3.2.cmml" xref="S3.SS3.p4.2.m2.2.3.2">𝑅</ci><list id="S3.SS3.p4.2.m2.2.2.2.3.cmml" xref="S3.SS3.p4.2.m2.2.2.2.4"><ci id="S3.SS3.p4.2.m2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1">𝑢</ci><ci id="S3.SS3.p4.2.m2.2.2.2.2.cmml" xref="S3.SS3.p4.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.2c">R_{u,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.2d">italic_R start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denote user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.1"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.1d">italic_u</annotation></semantics></math>’s ratings for items <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1"><semantics id="S3.SS3.p4.4.m4.1a"><mi id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><ci id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.1"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.1d">italic_j</annotation></semantics></math>, and <math alttext="\bar{R}_{u}" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m6.1"><semantics id="S3.SS3.p4.6.m6.1a"><msub id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mover accent="true" id="S3.SS3.p4.6.m6.1.1.2" xref="S3.SS3.p4.6.m6.1.1.2.cmml"><mi id="S3.SS3.p4.6.m6.1.1.2.2" xref="S3.SS3.p4.6.m6.1.1.2.2.cmml">R</mi><mo id="S3.SS3.p4.6.m6.1.1.2.1" xref="S3.SS3.p4.6.m6.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">subscript</csymbol><apply id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2"><ci id="S3.SS3.p4.6.m6.1.1.2.1.cmml" xref="S3.SS3.p4.6.m6.1.1.2.1">¯</ci><ci id="S3.SS3.p4.6.m6.1.1.2.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2.2">𝑅</ci></apply><ci id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\bar{R}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.6.m6.1d">over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS3.p4.7.m7.1"><semantics id="S3.SS3.p4.7.m7.1a"><mi id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><ci id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.7.m7.1d">italic_u</annotation></semantics></math>’s average ratings. To assess the relationship captured by learned ID representations, we employ Mean Square Error (MSE) to calculate the similarity bias on their cosine similarity with their corresponding ground truth relation values, which forms the basis of the MS:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\text{MS}(\mathbf{E})=\frac{2}{|N|(|N|-1)}\sum_{i,j\in N,i&lt;j}\left(\frac%
{\mathbf{e}_{i}^{\top}\mathbf{e}_{j}}{|\mathbf{e}_{i}||\mathbf{e}_{j}|}-\text{%
sim}(i,j)\right)^{2}." class="ltx_Math" display="block" id="S3.E5.m1.13"><semantics id="S3.E5.m1.13a"><mrow id="S3.E5.m1.13.13.1" xref="S3.E5.m1.13.13.1.1.cmml"><mrow id="S3.E5.m1.13.13.1.1" xref="S3.E5.m1.13.13.1.1.cmml"><mrow id="S3.E5.m1.13.13.1.1.3" xref="S3.E5.m1.13.13.1.1.3.cmml"><mtext id="S3.E5.m1.13.13.1.1.3.2" mathsize="90%" xref="S3.E5.m1.13.13.1.1.3.2a.cmml">MS</mtext><mo id="S3.E5.m1.13.13.1.1.3.1" xref="S3.E5.m1.13.13.1.1.3.1.cmml">⁢</mo><mrow id="S3.E5.m1.13.13.1.1.3.3.2" xref="S3.E5.m1.13.13.1.1.3.cmml"><mo id="S3.E5.m1.13.13.1.1.3.3.2.1" maxsize="90%" minsize="90%" xref="S3.E5.m1.13.13.1.1.3.cmml">(</mo><mi id="S3.E5.m1.10.10" mathsize="90%" xref="S3.E5.m1.10.10.cmml">𝐄</mi><mo id="S3.E5.m1.13.13.1.1.3.3.2.2" maxsize="90%" minsize="90%" xref="S3.E5.m1.13.13.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.13.13.1.1.2" mathsize="90%" xref="S3.E5.m1.13.13.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.13.13.1.1.1" xref="S3.E5.m1.13.13.1.1.1.cmml"><mfrac id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><mn id="S3.E5.m1.3.3.5" mathsize="90%" xref="S3.E5.m1.3.3.5.cmml">2</mn><mrow id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3.cmml"><mrow id="S3.E5.m1.3.3.3.5.2" xref="S3.E5.m1.3.3.3.5.1.cmml"><mo id="S3.E5.m1.3.3.3.5.2.1" maxsize="90%" minsize="90%" xref="S3.E5.m1.3.3.3.5.1.1.cmml">|</mo><mi id="S3.E5.m1.1.1.1.1" mathsize="90%" xref="S3.E5.m1.1.1.1.1.cmml">N</mi><mo id="S3.E5.m1.3.3.3.5.2.2" maxsize="90%" minsize="90%" xref="S3.E5.m1.3.3.3.5.1.1.cmml">|</mo></mrow><mo id="S3.E5.m1.3.3.3.4" xref="S3.E5.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.3.3.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml"><mo id="S3.E5.m1.3.3.3.3.1.2" maxsize="90%" minsize="90%" xref="S3.E5.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.3.3.1.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.3.3.1.1.2.2" xref="S3.E5.m1.3.3.3.3.1.1.2.1.cmml"><mo id="S3.E5.m1.3.3.3.3.1.1.2.2.1" maxsize="90%" minsize="90%" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml">|</mo><mi id="S3.E5.m1.2.2.2.2" mathsize="90%" xref="S3.E5.m1.2.2.2.2.cmml">N</mi><mo id="S3.E5.m1.3.3.3.3.1.1.2.2.2" maxsize="90%" minsize="90%" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.E5.m1.3.3.3.3.1.1.1" mathsize="90%" xref="S3.E5.m1.3.3.3.3.1.1.1.cmml">−</mo><mn id="S3.E5.m1.3.3.3.3.1.1.3" mathsize="90%" xref="S3.E5.m1.3.3.3.3.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.3.3.3.3.1.3" maxsize="90%" minsize="90%" xref="S3.E5.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E5.m1.13.13.1.1.1.2" xref="S3.E5.m1.13.13.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.13.13.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.cmml"><munder id="S3.E5.m1.13.13.1.1.1.1.2" xref="S3.E5.m1.13.13.1.1.1.1.2.cmml"><mo id="S3.E5.m1.13.13.1.1.1.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" xref="S3.E5.m1.13.13.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.7.7.4.4" xref="S3.E5.m1.7.7.4.5.cmml"><mrow id="S3.E5.m1.6.6.3.3.1" xref="S3.E5.m1.6.6.3.3.1.cmml"><mrow id="S3.E5.m1.6.6.3.3.1.2.2" xref="S3.E5.m1.6.6.3.3.1.2.1.cmml"><mi id="S3.E5.m1.4.4.1.1" mathsize="90%" xref="S3.E5.m1.4.4.1.1.cmml">i</mi><mo id="S3.E5.m1.6.6.3.3.1.2.2.1" mathsize="90%" xref="S3.E5.m1.6.6.3.3.1.2.1.cmml">,</mo><mi id="S3.E5.m1.5.5.2.2" mathsize="90%" xref="S3.E5.m1.5.5.2.2.cmml">j</mi></mrow><mo id="S3.E5.m1.6.6.3.3.1.1" mathsize="90%" xref="S3.E5.m1.6.6.3.3.1.1.cmml">∈</mo><mi id="S3.E5.m1.6.6.3.3.1.3" mathsize="90%" xref="S3.E5.m1.6.6.3.3.1.3.cmml">N</mi></mrow><mo id="S3.E5.m1.7.7.4.4.3" mathsize="90%" xref="S3.E5.m1.7.7.4.5a.cmml">,</mo><mrow id="S3.E5.m1.7.7.4.4.2" xref="S3.E5.m1.7.7.4.4.2.cmml"><mi id="S3.E5.m1.7.7.4.4.2.2" mathsize="90%" xref="S3.E5.m1.7.7.4.4.2.2.cmml">i</mi><mo id="S3.E5.m1.7.7.4.4.2.1" mathsize="90%" xref="S3.E5.m1.7.7.4.4.2.1.cmml">&lt;</mo><mi id="S3.E5.m1.7.7.4.4.2.3" mathsize="90%" xref="S3.E5.m1.7.7.4.4.2.3.cmml">j</mi></mrow></mrow></munder><msup id="S3.E5.m1.13.13.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.13.13.1.1.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.1.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.cmml"><mfrac id="S3.E5.m1.9.9" xref="S3.E5.m1.9.9.cmml"><mrow id="S3.E5.m1.9.9.4" xref="S3.E5.m1.9.9.4.cmml"><msubsup id="S3.E5.m1.9.9.4.2" xref="S3.E5.m1.9.9.4.2.cmml"><mi id="S3.E5.m1.9.9.4.2.2.2" mathsize="90%" xref="S3.E5.m1.9.9.4.2.2.2.cmml">𝐞</mi><mi id="S3.E5.m1.9.9.4.2.2.3" mathsize="90%" xref="S3.E5.m1.9.9.4.2.2.3.cmml">i</mi><mo id="S3.E5.m1.9.9.4.2.3" mathsize="90%" xref="S3.E5.m1.9.9.4.2.3.cmml">⊤</mo></msubsup><mo id="S3.E5.m1.9.9.4.1" xref="S3.E5.m1.9.9.4.1.cmml">⁢</mo><msub id="S3.E5.m1.9.9.4.3" xref="S3.E5.m1.9.9.4.3.cmml"><mi id="S3.E5.m1.9.9.4.3.2" mathsize="90%" xref="S3.E5.m1.9.9.4.3.2.cmml">𝐞</mi><mi id="S3.E5.m1.9.9.4.3.3" mathsize="90%" xref="S3.E5.m1.9.9.4.3.3.cmml">j</mi></msub></mrow><mrow id="S3.E5.m1.9.9.2" xref="S3.E5.m1.9.9.2.cmml"><mrow id="S3.E5.m1.8.8.1.1.1" xref="S3.E5.m1.8.8.1.1.2.cmml"><mo id="S3.E5.m1.8.8.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E5.m1.8.8.1.1.2.1.cmml">|</mo><msub id="S3.E5.m1.8.8.1.1.1.1" xref="S3.E5.m1.8.8.1.1.1.1.cmml"><mi id="S3.E5.m1.8.8.1.1.1.1.2" mathsize="90%" xref="S3.E5.m1.8.8.1.1.1.1.2.cmml">𝐞</mi><mi id="S3.E5.m1.8.8.1.1.1.1.3" mathsize="90%" xref="S3.E5.m1.8.8.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.8.8.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E5.m1.8.8.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E5.m1.9.9.2.3" xref="S3.E5.m1.9.9.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.9.9.2.2.1" xref="S3.E5.m1.9.9.2.2.2.cmml"><mo id="S3.E5.m1.9.9.2.2.1.2" maxsize="90%" minsize="90%" xref="S3.E5.m1.9.9.2.2.2.1.cmml">|</mo><msub id="S3.E5.m1.9.9.2.2.1.1" xref="S3.E5.m1.9.9.2.2.1.1.cmml"><mi id="S3.E5.m1.9.9.2.2.1.1.2" mathsize="90%" xref="S3.E5.m1.9.9.2.2.1.1.2.cmml">𝐞</mi><mi id="S3.E5.m1.9.9.2.2.1.1.3" mathsize="90%" xref="S3.E5.m1.9.9.2.2.1.1.3.cmml">j</mi></msub><mo id="S3.E5.m1.9.9.2.2.1.3" maxsize="90%" minsize="90%" xref="S3.E5.m1.9.9.2.2.2.1.cmml">|</mo></mrow></mrow></mfrac><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1" mathsize="90%" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.cmml"><mtext id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.2a.cmml">sim</mtext><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.1" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E5.m1.11.11" mathsize="90%" xref="S3.E5.m1.11.11.cmml">i</mi><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.2.2" mathsize="90%" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E5.m1.12.12" mathsize="90%" xref="S3.E5.m1.12.12.cmml">j</mi><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.2.3" maxsize="90%" minsize="90%" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.1.3" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E5.m1.13.13.1.1.1.1.1.3" mathsize="90%" xref="S3.E5.m1.13.13.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S3.E5.m1.13.13.1.2" lspace="0em" mathsize="90%" xref="S3.E5.m1.13.13.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.13b"><apply id="S3.E5.m1.13.13.1.1.cmml" xref="S3.E5.m1.13.13.1"><eq id="S3.E5.m1.13.13.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.2"></eq><apply id="S3.E5.m1.13.13.1.1.3.cmml" xref="S3.E5.m1.13.13.1.1.3"><times id="S3.E5.m1.13.13.1.1.3.1.cmml" xref="S3.E5.m1.13.13.1.1.3.1"></times><ci id="S3.E5.m1.13.13.1.1.3.2a.cmml" xref="S3.E5.m1.13.13.1.1.3.2"><mtext id="S3.E5.m1.13.13.1.1.3.2.cmml" mathsize="90%" xref="S3.E5.m1.13.13.1.1.3.2">MS</mtext></ci><ci id="S3.E5.m1.10.10.cmml" xref="S3.E5.m1.10.10">𝐄</ci></apply><apply id="S3.E5.m1.13.13.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1"><times id="S3.E5.m1.13.13.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.1.2"></times><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><divide id="S3.E5.m1.3.3.4.cmml" xref="S3.E5.m1.3.3"></divide><cn id="S3.E5.m1.3.3.5.cmml" type="integer" xref="S3.E5.m1.3.3.5">2</cn><apply id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3"><times id="S3.E5.m1.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.4"></times><apply id="S3.E5.m1.3.3.3.5.1.cmml" xref="S3.E5.m1.3.3.3.5.2"><abs id="S3.E5.m1.3.3.3.5.1.1.cmml" xref="S3.E5.m1.3.3.3.5.2.1"></abs><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑁</ci></apply><apply id="S3.E5.m1.3.3.3.3.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1"><minus id="S3.E5.m1.3.3.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1"></minus><apply id="S3.E5.m1.3.3.3.3.1.1.2.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.2.2"><abs id="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.2.2.1"></abs><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑁</ci></apply><cn id="S3.E5.m1.3.3.3.3.1.1.3.cmml" type="integer" xref="S3.E5.m1.3.3.3.3.1.1.3">1</cn></apply></apply></apply><apply id="S3.E5.m1.13.13.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1"><apply id="S3.E5.m1.13.13.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.1.1.2.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.2">subscript</csymbol><sum id="S3.E5.m1.13.13.1.1.1.1.2.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.2.2"></sum><apply id="S3.E5.m1.7.7.4.5.cmml" xref="S3.E5.m1.7.7.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.4.5a.cmml" xref="S3.E5.m1.7.7.4.4.3">formulae-sequence</csymbol><apply id="S3.E5.m1.6.6.3.3.1.cmml" xref="S3.E5.m1.6.6.3.3.1"><in id="S3.E5.m1.6.6.3.3.1.1.cmml" xref="S3.E5.m1.6.6.3.3.1.1"></in><list id="S3.E5.m1.6.6.3.3.1.2.1.cmml" xref="S3.E5.m1.6.6.3.3.1.2.2"><ci id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1.1">𝑖</ci><ci id="S3.E5.m1.5.5.2.2.cmml" xref="S3.E5.m1.5.5.2.2">𝑗</ci></list><ci id="S3.E5.m1.6.6.3.3.1.3.cmml" xref="S3.E5.m1.6.6.3.3.1.3">𝑁</ci></apply><apply id="S3.E5.m1.7.7.4.4.2.cmml" xref="S3.E5.m1.7.7.4.4.2"><lt id="S3.E5.m1.7.7.4.4.2.1.cmml" xref="S3.E5.m1.7.7.4.4.2.1"></lt><ci id="S3.E5.m1.7.7.4.4.2.2.cmml" xref="S3.E5.m1.7.7.4.4.2.2">𝑖</ci><ci id="S3.E5.m1.7.7.4.4.2.3.cmml" xref="S3.E5.m1.7.7.4.4.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E5.m1.13.13.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1"><minus id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E5.m1.9.9.cmml" xref="S3.E5.m1.9.9"><divide id="S3.E5.m1.9.9.3.cmml" xref="S3.E5.m1.9.9"></divide><apply id="S3.E5.m1.9.9.4.cmml" xref="S3.E5.m1.9.9.4"><times id="S3.E5.m1.9.9.4.1.cmml" xref="S3.E5.m1.9.9.4.1"></times><apply id="S3.E5.m1.9.9.4.2.cmml" xref="S3.E5.m1.9.9.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.4.2.1.cmml" xref="S3.E5.m1.9.9.4.2">superscript</csymbol><apply id="S3.E5.m1.9.9.4.2.2.cmml" xref="S3.E5.m1.9.9.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.4.2.2.1.cmml" xref="S3.E5.m1.9.9.4.2">subscript</csymbol><ci id="S3.E5.m1.9.9.4.2.2.2.cmml" xref="S3.E5.m1.9.9.4.2.2.2">𝐞</ci><ci id="S3.E5.m1.9.9.4.2.2.3.cmml" xref="S3.E5.m1.9.9.4.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.E5.m1.9.9.4.2.3.cmml" xref="S3.E5.m1.9.9.4.2.3">top</csymbol></apply><apply id="S3.E5.m1.9.9.4.3.cmml" xref="S3.E5.m1.9.9.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.4.3.1.cmml" xref="S3.E5.m1.9.9.4.3">subscript</csymbol><ci id="S3.E5.m1.9.9.4.3.2.cmml" xref="S3.E5.m1.9.9.4.3.2">𝐞</ci><ci id="S3.E5.m1.9.9.4.3.3.cmml" xref="S3.E5.m1.9.9.4.3.3">𝑗</ci></apply></apply><apply id="S3.E5.m1.9.9.2.cmml" xref="S3.E5.m1.9.9.2"><times id="S3.E5.m1.9.9.2.3.cmml" xref="S3.E5.m1.9.9.2.3"></times><apply id="S3.E5.m1.8.8.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1"><abs id="S3.E5.m1.8.8.1.1.2.1.cmml" xref="S3.E5.m1.8.8.1.1.1.2"></abs><apply id="S3.E5.m1.8.8.1.1.1.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.1.1.1.cmml" xref="S3.E5.m1.8.8.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.8.8.1.1.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.1.1.2">𝐞</ci><ci id="S3.E5.m1.8.8.1.1.1.1.3.cmml" xref="S3.E5.m1.8.8.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E5.m1.9.9.2.2.2.cmml" xref="S3.E5.m1.9.9.2.2.1"><abs id="S3.E5.m1.9.9.2.2.2.1.cmml" xref="S3.E5.m1.9.9.2.2.1.2"></abs><apply id="S3.E5.m1.9.9.2.2.1.1.cmml" xref="S3.E5.m1.9.9.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.2.2.1.1.1.cmml" xref="S3.E5.m1.9.9.2.2.1.1">subscript</csymbol><ci id="S3.E5.m1.9.9.2.2.1.1.2.cmml" xref="S3.E5.m1.9.9.2.2.1.1.2">𝐞</ci><ci id="S3.E5.m1.9.9.2.2.1.1.3.cmml" xref="S3.E5.m1.9.9.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2"><times id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.2"><mtext id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.2.cmml" mathsize="90%" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.2">sim</mtext></ci><interval closure="open" id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.2.3.2"><ci id="S3.E5.m1.11.11.cmml" xref="S3.E5.m1.11.11">𝑖</ci><ci id="S3.E5.m1.12.12.cmml" xref="S3.E5.m1.12.12">𝑗</ci></interval></apply></apply><cn id="S3.E5.m1.13.13.1.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.13.13.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.13c">\small\text{MS}(\mathbf{E})=\frac{2}{|N|(|N|-1)}\sum_{i,j\in N,i&lt;j}\left(\frac%
{\mathbf{e}_{i}^{\top}\mathbf{e}_{j}}{|\mathbf{e}_{i}||\mathbf{e}_{j}|}-\text{%
sim}(i,j)\right)^{2}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.13d">MS ( bold_E ) = divide start_ARG 2 end_ARG start_ARG | italic_N | ( | italic_N | - 1 ) end_ARG ∑ start_POSTSUBSCRIPT italic_i , italic_j ∈ italic_N , italic_i &lt; italic_j end_POSTSUBSCRIPT ( divide start_ARG bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_e start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG | bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | | bold_e start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | end_ARG - sim ( italic_i , italic_j ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">Our quantitative assessment of the quality of these ID representations using the introduced metrics reveals some interesting findings. In Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:score</span>, it shows that constructing IDs of in-vocabulary tokens (RID and SID) performs poorly in both diversity and memorization dimensions. While the use of OOV tokens (CID) may improve diversity, its memorization score leaves much to be desired. This suggests the need to explore better explore better forms of OOV tokens to construct IDs, to make them capture user/item correlations while also distinguishing different items.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.1">Our quantitative assessment, based on the metrics we introduced, reveals intriguing insights into the quality of these ID representations. Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:score</span> illustrates that IDs constructed from in-vocabulary tokens (RID and SID) perform poorly in terms of both diversity and memorization. Although the use of OOV tokens (CID) enhances diversity, its memorization score is unsatisfactory. These findings highlight the need to further develop more effective forms of OOV tokens for ID construction, aiming to improve LLMs’ ability to capture user/item correlations and distinguish items.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>META ID</h2>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="212" id="S4.F3.sf1.g1" src="x5.png" width="357"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="246" id="S4.F3.sf2.g1" src="x6.png" width="465"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Illustration of the proposed framework: (a) The first step involves sampling meta-paths to train a skip-gram model to learn the representation of users and items. Following this, users and items are represented by META IDs constructed of OOV token combinations through clustering their representations. (b) A large language model (LLM) integrated with META ID is utilized for sequential recommendation. The LLM first encodes the input sequence into tokens and then lookup their embeddings through the token embedding layer. Here, the OOV tokens undergo an extra transformation layer before the token embedding layer of LLMs as a representation augmentation.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We now introduce the META ID framework to enhance LLMs in recommendation tasks. META ID involves creating out-of-vocabulary (OOV) tokens for constructing user and item IDs, which provide a rich, expressive space and encapsulate comprehensive, collaborative information. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.F3" title="Figure 3 ‣ 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">3</span></a>, our process begins with sampling meta-paths from user-item interaction history. We then apply a skip-gram model to learn user and item representations from these meta-path sequences. This process ensures that users’ and items’ features are projected into a shared space to capture their interaction relationship better. This is followed by K-Means clustering to group similar users or items, after which unique OOV tokens are assigned to each cluster to construct the META ID.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Meta-path-based Embedding</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.4">We frame user-item interactions within a graph embedding learning paradigm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">8</span></a>]</cite>, constructing an interaction graph composed of user nodes <math alttext="U" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_U</annotation></semantics></math> and item nodes <math alttext="I" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_I</annotation></semantics></math>, linked by interaction history with ratings <math alttext="R" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_R</annotation></semantics></math>. The core of this embedding learning strategy involves meta-paths <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">8</span></a>]</cite> — a sequence of connections that reflect composite relationships within the graph. Our primary meta-path, denoted as <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.4.1">U-I-U</span>, materializes when users consistently rate an item with the same score <math alttext="R_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">R</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑅</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">R_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, forming a path:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small p=\{U_{1}\xrightarrow{R_{i}}I_{2}\xrightarrow{R_{i}}U_{3}\xrightarrow{R%
_{i}}I_{4}...\xrightarrow{R_{i}}U_{k}\}^{|R|}_{i=1}." class="ltx_Math" display="block" id="S4.E6.m1.2"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.2.1" xref="S4.E6.m1.2.2.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.3.cmml">p</mi><mo id="S4.E6.m1.2.2.1.1.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.2.cmml">=</mo><msubsup id="S4.E6.m1.2.2.1.1.1" xref="S4.E6.m1.2.2.1.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.E6.m1.2.2.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">U</mi><mn id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mover accent="true" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.2" mathsize="90%" stretchy="false" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">→</mo><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.2.cmml">R</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.3.cmml">i</mi></msub></mover><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.4" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.2.cmml">I</mi><mn id="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.3.cmml">2</mn></msub><mover accent="true" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.cmml"><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.2" mathsize="90%" stretchy="false" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.2.cmml">→</mo><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.2.cmml">R</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.3.cmml">i</mi></msub></mover><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.6" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.2.cmml">U</mi><mn id="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.3.cmml">3</mn></msub><mover accent="true" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.cmml"><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.2" mathsize="90%" stretchy="false" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.2.cmml">→</mo><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.2.cmml">R</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.3.cmml">i</mi></msub></mover><mrow id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.cmml"><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.2.cmml">I</mi><mn id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.3.cmml">4</mn></msub><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.3" mathsize="90%" mathvariant="normal" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.3.cmml">…</mi></mrow><mover accent="true" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.cmml"><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.2" mathsize="90%" stretchy="false" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.2.cmml">→</mo><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.2.cmml">R</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.3.cmml">i</mi></msub></mover><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.10" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.2.cmml">U</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.3.cmml">k</mi></msub></mrow><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E6.m1.2.2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.E6.m1.2.2.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.3.cmml"><mi id="S4.E6.m1.2.2.1.1.1.3.2" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.3.2.cmml">i</mi><mo id="S4.E6.m1.2.2.1.1.1.3.1" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.3.1.cmml">=</mo><mn id="S4.E6.m1.2.2.1.1.1.3.3" mathsize="90%" xref="S4.E6.m1.2.2.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.2.cmml"><mo id="S4.E6.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="S4.E6.m1.1.1.1.2.1.cmml">|</mo><mi id="S4.E6.m1.1.1.1.1" mathsize="90%" xref="S4.E6.m1.1.1.1.1.cmml">R</mi><mo id="S4.E6.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="S4.E6.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><mo id="S4.E6.m1.2.2.1.2" lspace="0em" mathsize="90%" xref="S4.E6.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.2.1.1.cmml" xref="S4.E6.m1.2.2.1"><eq id="S4.E6.m1.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.2"></eq><ci id="S4.E6.m1.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.3">𝑝</ci><apply id="S4.E6.m1.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1">subscript</csymbol><apply id="S4.E6.m1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1">superscript</csymbol><set id="S4.E6.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"><and id="S4.E6.m1.2.2.1.1.1.1.1.1.1a.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"></and><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1b.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.2">𝑅</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.3">𝑖</ci></apply><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.2">→</ci></apply><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.2">𝑈</ci><cn id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.2">𝐼</ci><cn id="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.3.cmml" type="integer" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.4.3">2</cn></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1c.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.2">𝑅</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.1.3">𝑖</ci></apply><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.5.2">→</ci></apply><share href="https://arxiv.org/html/2406.08477v1#S4.E6.m1.2.2.1.1.1.1.1.1.1.4.cmml" id="S4.E6.m1.2.2.1.1.1.1.1.1.1d.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"></share><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.2">𝑈</ci><cn id="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.3.cmml" type="integer" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.6.3">3</cn></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1e.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.2">𝑅</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.1.3">𝑖</ci></apply><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.7.2">→</ci></apply><share href="https://arxiv.org/html/2406.08477v1#S4.E6.m1.2.2.1.1.1.1.1.1.1.6.cmml" id="S4.E6.m1.2.2.1.1.1.1.1.1.1f.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"></share><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8"><times id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.1"></times><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.2">𝐼</ci><cn id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.3.cmml" type="integer" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.2.3">4</cn></apply><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.8.3">…</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1g.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9"><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.2">𝑅</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.1.3">𝑖</ci></apply><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.9.2">→</ci></apply><share href="https://arxiv.org/html/2406.08477v1#S4.E6.m1.2.2.1.1.1.1.1.1.1.8.cmml" id="S4.E6.m1.2.2.1.1.1.1.1.1.1h.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"></share><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.10"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.10">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.2">𝑈</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.10.3">𝑘</ci></apply></apply></apply></set><apply id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.3"><abs id="S4.E6.m1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.3.1"></abs><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝑅</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3"><eq id="S4.E6.m1.2.2.1.1.1.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.3.1"></eq><ci id="S4.E6.m1.2.2.1.1.1.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.3.2">𝑖</ci><cn id="S4.E6.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="S4.E6.m1.2.2.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">\small p=\{U_{1}\xrightarrow{R_{i}}I_{2}\xrightarrow{R_{i}}U_{3}\xrightarrow{R%
_{i}}I_{4}...\xrightarrow{R_{i}}U_{k}\}^{|R|}_{i=1}.</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.2d">italic_p = { italic_U start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_ARROW start_OVERACCENT italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_OVERACCENT → end_ARROW italic_I start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_ARROW start_OVERACCENT italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_OVERACCENT → end_ARROW italic_U start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT start_ARROW start_OVERACCENT italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_OVERACCENT → end_ARROW italic_I start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT … start_ARROW start_OVERACCENT italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_OVERACCENT → end_ARROW italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT | italic_R | end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.5">We employ a skip-gram model to capture the interaction dynamics represented by these meta-paths. This model is trained on sequences generated from meta-path-based random walks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">8</span></a>]</cite>, producing representations <math alttext="\mathbf{W_{U}}=[\mathbf{w}_{u_{1}}^{\top},...,\mathbf{w}_{u_{m}}^{\top}]\in%
\mathbb{R}^{d\times m}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.3"><semantics id="S4.SS1.p2.1.m1.3a"><mrow id="S4.SS1.p2.1.m1.3.3" xref="S4.SS1.p2.1.m1.3.3.cmml"><msub id="S4.SS1.p2.1.m1.3.3.4" xref="S4.SS1.p2.1.m1.3.3.4.cmml"><mi id="S4.SS1.p2.1.m1.3.3.4.2" xref="S4.SS1.p2.1.m1.3.3.4.2.cmml">𝐖</mi><mi id="S4.SS1.p2.1.m1.3.3.4.3" xref="S4.SS1.p2.1.m1.3.3.4.3.cmml">𝐔</mi></msub><mo id="S4.SS1.p2.1.m1.3.3.5" xref="S4.SS1.p2.1.m1.3.3.5.cmml">=</mo><mrow id="S4.SS1.p2.1.m1.3.3.2.2" xref="S4.SS1.p2.1.m1.3.3.2.3.cmml"><mo id="S4.SS1.p2.1.m1.3.3.2.2.3" stretchy="false" xref="S4.SS1.p2.1.m1.3.3.2.3.cmml">[</mo><msubsup id="S4.SS1.p2.1.m1.2.2.1.1.1" xref="S4.SS1.p2.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.2.2.1.1.1.2.2" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.2.cmml">𝐰</mi><msub id="S4.SS1.p2.1.m1.2.2.1.1.1.2.3" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.cmml"><mi id="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.2" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.2.cmml">u</mi><mn id="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.3" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.3.cmml">1</mn></msub><mo id="S4.SS1.p2.1.m1.2.2.1.1.1.3" xref="S4.SS1.p2.1.m1.2.2.1.1.1.3.cmml">⊤</mo></msubsup><mo id="S4.SS1.p2.1.m1.3.3.2.2.4" xref="S4.SS1.p2.1.m1.3.3.2.3.cmml">,</mo><mi id="S4.SS1.p2.1.m1.1.1" mathvariant="normal" xref="S4.SS1.p2.1.m1.1.1.cmml">…</mi><mo id="S4.SS1.p2.1.m1.3.3.2.2.5" xref="S4.SS1.p2.1.m1.3.3.2.3.cmml">,</mo><msubsup id="S4.SS1.p2.1.m1.3.3.2.2.2" xref="S4.SS1.p2.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS1.p2.1.m1.3.3.2.2.2.2.2" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.2.cmml">𝐰</mi><msub id="S4.SS1.p2.1.m1.3.3.2.2.2.2.3" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.2" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.2.cmml">u</mi><mi id="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.3" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.3.cmml">m</mi></msub><mo id="S4.SS1.p2.1.m1.3.3.2.2.2.3" xref="S4.SS1.p2.1.m1.3.3.2.2.2.3.cmml">⊤</mo></msubsup><mo id="S4.SS1.p2.1.m1.3.3.2.2.6" stretchy="false" xref="S4.SS1.p2.1.m1.3.3.2.3.cmml">]</mo></mrow><mo id="S4.SS1.p2.1.m1.3.3.6" xref="S4.SS1.p2.1.m1.3.3.6.cmml">∈</mo><msup id="S4.SS1.p2.1.m1.3.3.7" xref="S4.SS1.p2.1.m1.3.3.7.cmml"><mi id="S4.SS1.p2.1.m1.3.3.7.2" xref="S4.SS1.p2.1.m1.3.3.7.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.1.m1.3.3.7.3" xref="S4.SS1.p2.1.m1.3.3.7.3.cmml"><mi id="S4.SS1.p2.1.m1.3.3.7.3.2" xref="S4.SS1.p2.1.m1.3.3.7.3.2.cmml">d</mi><mo id="S4.SS1.p2.1.m1.3.3.7.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.1.m1.3.3.7.3.1.cmml">×</mo><mi id="S4.SS1.p2.1.m1.3.3.7.3.3" xref="S4.SS1.p2.1.m1.3.3.7.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.3b"><apply id="S4.SS1.p2.1.m1.3.3.cmml" xref="S4.SS1.p2.1.m1.3.3"><and id="S4.SS1.p2.1.m1.3.3a.cmml" xref="S4.SS1.p2.1.m1.3.3"></and><apply id="S4.SS1.p2.1.m1.3.3b.cmml" xref="S4.SS1.p2.1.m1.3.3"><eq id="S4.SS1.p2.1.m1.3.3.5.cmml" xref="S4.SS1.p2.1.m1.3.3.5"></eq><apply id="S4.SS1.p2.1.m1.3.3.4.cmml" xref="S4.SS1.p2.1.m1.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.3.3.4.1.cmml" xref="S4.SS1.p2.1.m1.3.3.4">subscript</csymbol><ci id="S4.SS1.p2.1.m1.3.3.4.2.cmml" xref="S4.SS1.p2.1.m1.3.3.4.2">𝐖</ci><ci id="S4.SS1.p2.1.m1.3.3.4.3.cmml" xref="S4.SS1.p2.1.m1.3.3.4.3">𝐔</ci></apply><list id="S4.SS1.p2.1.m1.3.3.2.3.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2"><apply id="S4.SS1.p2.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.2">𝐰</ci><apply id="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.1.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.2.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.2">𝑢</ci><cn id="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS1.p2.1.m1.2.2.1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="S4.SS1.p2.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.1.3">top</csymbol></apply><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">…</ci><apply id="S4.SS1.p2.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S4.SS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.2">𝐰</ci><apply id="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.3">subscript</csymbol><ci id="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.2.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.2">𝑢</ci><ci id="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2.2.3.3">𝑚</ci></apply></apply><csymbol cd="latexml" id="S4.SS1.p2.1.m1.3.3.2.2.2.3.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2.3">top</csymbol></apply></list></apply><apply id="S4.SS1.p2.1.m1.3.3c.cmml" xref="S4.SS1.p2.1.m1.3.3"><in id="S4.SS1.p2.1.m1.3.3.6.cmml" xref="S4.SS1.p2.1.m1.3.3.6"></in><share href="https://arxiv.org/html/2406.08477v1#S4.SS1.p2.1.m1.3.3.2.cmml" id="S4.SS1.p2.1.m1.3.3d.cmml" xref="S4.SS1.p2.1.m1.3.3"></share><apply id="S4.SS1.p2.1.m1.3.3.7.cmml" xref="S4.SS1.p2.1.m1.3.3.7"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.3.3.7.1.cmml" xref="S4.SS1.p2.1.m1.3.3.7">superscript</csymbol><ci id="S4.SS1.p2.1.m1.3.3.7.2.cmml" xref="S4.SS1.p2.1.m1.3.3.7.2">ℝ</ci><apply id="S4.SS1.p2.1.m1.3.3.7.3.cmml" xref="S4.SS1.p2.1.m1.3.3.7.3"><times id="S4.SS1.p2.1.m1.3.3.7.3.1.cmml" xref="S4.SS1.p2.1.m1.3.3.7.3.1"></times><ci id="S4.SS1.p2.1.m1.3.3.7.3.2.cmml" xref="S4.SS1.p2.1.m1.3.3.7.3.2">𝑑</ci><ci id="S4.SS1.p2.1.m1.3.3.7.3.3.cmml" xref="S4.SS1.p2.1.m1.3.3.7.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.3c">\mathbf{W_{U}}=[\mathbf{w}_{u_{1}}^{\top},...,\mathbf{w}_{u_{m}}^{\top}]\in%
\mathbb{R}^{d\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.3d">bold_W start_POSTSUBSCRIPT bold_U end_POSTSUBSCRIPT = [ bold_w start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT , … , bold_w start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{W_{I}}=[\mathbf{w}_{i_{1}}^{\top},...,\mathbf{w}_{i_{n}}^{\top}]\in%
\mathbb{R}^{d\times n}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.3"><semantics id="S4.SS1.p2.2.m2.3a"><mrow id="S4.SS1.p2.2.m2.3.3" xref="S4.SS1.p2.2.m2.3.3.cmml"><msub id="S4.SS1.p2.2.m2.3.3.4" xref="S4.SS1.p2.2.m2.3.3.4.cmml"><mi id="S4.SS1.p2.2.m2.3.3.4.2" xref="S4.SS1.p2.2.m2.3.3.4.2.cmml">𝐖</mi><mi id="S4.SS1.p2.2.m2.3.3.4.3" xref="S4.SS1.p2.2.m2.3.3.4.3.cmml">𝐈</mi></msub><mo id="S4.SS1.p2.2.m2.3.3.5" xref="S4.SS1.p2.2.m2.3.3.5.cmml">=</mo><mrow id="S4.SS1.p2.2.m2.3.3.2.2" xref="S4.SS1.p2.2.m2.3.3.2.3.cmml"><mo id="S4.SS1.p2.2.m2.3.3.2.2.3" stretchy="false" xref="S4.SS1.p2.2.m2.3.3.2.3.cmml">[</mo><msubsup id="S4.SS1.p2.2.m2.2.2.1.1.1" xref="S4.SS1.p2.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.p2.2.m2.2.2.1.1.1.2.2" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.2.cmml">𝐰</mi><msub id="S4.SS1.p2.2.m2.2.2.1.1.1.2.3" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.cmml"><mi id="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.2" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.2.cmml">i</mi><mn id="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.3" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.3.cmml">1</mn></msub><mo id="S4.SS1.p2.2.m2.2.2.1.1.1.3" xref="S4.SS1.p2.2.m2.2.2.1.1.1.3.cmml">⊤</mo></msubsup><mo id="S4.SS1.p2.2.m2.3.3.2.2.4" xref="S4.SS1.p2.2.m2.3.3.2.3.cmml">,</mo><mi id="S4.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S4.SS1.p2.2.m2.1.1.cmml">…</mi><mo id="S4.SS1.p2.2.m2.3.3.2.2.5" xref="S4.SS1.p2.2.m2.3.3.2.3.cmml">,</mo><msubsup id="S4.SS1.p2.2.m2.3.3.2.2.2" xref="S4.SS1.p2.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.p2.2.m2.3.3.2.2.2.2.2" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.2.cmml">𝐰</mi><msub id="S4.SS1.p2.2.m2.3.3.2.2.2.2.3" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.2" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.2.cmml">i</mi><mi id="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.3" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.3.cmml">n</mi></msub><mo id="S4.SS1.p2.2.m2.3.3.2.2.2.3" xref="S4.SS1.p2.2.m2.3.3.2.2.2.3.cmml">⊤</mo></msubsup><mo id="S4.SS1.p2.2.m2.3.3.2.2.6" stretchy="false" xref="S4.SS1.p2.2.m2.3.3.2.3.cmml">]</mo></mrow><mo id="S4.SS1.p2.2.m2.3.3.6" xref="S4.SS1.p2.2.m2.3.3.6.cmml">∈</mo><msup id="S4.SS1.p2.2.m2.3.3.7" xref="S4.SS1.p2.2.m2.3.3.7.cmml"><mi id="S4.SS1.p2.2.m2.3.3.7.2" xref="S4.SS1.p2.2.m2.3.3.7.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.2.m2.3.3.7.3" xref="S4.SS1.p2.2.m2.3.3.7.3.cmml"><mi id="S4.SS1.p2.2.m2.3.3.7.3.2" xref="S4.SS1.p2.2.m2.3.3.7.3.2.cmml">d</mi><mo id="S4.SS1.p2.2.m2.3.3.7.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.2.m2.3.3.7.3.1.cmml">×</mo><mi id="S4.SS1.p2.2.m2.3.3.7.3.3" xref="S4.SS1.p2.2.m2.3.3.7.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.3b"><apply id="S4.SS1.p2.2.m2.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3"><and id="S4.SS1.p2.2.m2.3.3a.cmml" xref="S4.SS1.p2.2.m2.3.3"></and><apply id="S4.SS1.p2.2.m2.3.3b.cmml" xref="S4.SS1.p2.2.m2.3.3"><eq id="S4.SS1.p2.2.m2.3.3.5.cmml" xref="S4.SS1.p2.2.m2.3.3.5"></eq><apply id="S4.SS1.p2.2.m2.3.3.4.cmml" xref="S4.SS1.p2.2.m2.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.4.1.cmml" xref="S4.SS1.p2.2.m2.3.3.4">subscript</csymbol><ci id="S4.SS1.p2.2.m2.3.3.4.2.cmml" xref="S4.SS1.p2.2.m2.3.3.4.2">𝐖</ci><ci id="S4.SS1.p2.2.m2.3.3.4.3.cmml" xref="S4.SS1.p2.2.m2.3.3.4.3">𝐈</ci></apply><list id="S4.SS1.p2.2.m2.3.3.2.3.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2"><apply id="S4.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.1.1.1.2.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.2">𝐰</ci><apply id="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.2.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.2">𝑖</ci><cn id="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS1.p2.2.m2.2.2.1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="S4.SS1.p2.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.p2.2.m2.2.2.1.1.1.3">top</csymbol></apply><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">…</ci><apply id="S4.SS1.p2.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2">superscript</csymbol><apply id="S4.SS1.p2.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.2.m2.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.2">𝐰</ci><apply id="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.3">subscript</csymbol><ci id="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.2">𝑖</ci><ci id="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2.2.3.3">𝑛</ci></apply></apply><csymbol cd="latexml" id="S4.SS1.p2.2.m2.3.3.2.2.2.3.cmml" xref="S4.SS1.p2.2.m2.3.3.2.2.2.3">top</csymbol></apply></list></apply><apply id="S4.SS1.p2.2.m2.3.3c.cmml" xref="S4.SS1.p2.2.m2.3.3"><in id="S4.SS1.p2.2.m2.3.3.6.cmml" xref="S4.SS1.p2.2.m2.3.3.6"></in><share href="https://arxiv.org/html/2406.08477v1#S4.SS1.p2.2.m2.3.3.2.cmml" id="S4.SS1.p2.2.m2.3.3d.cmml" xref="S4.SS1.p2.2.m2.3.3"></share><apply id="S4.SS1.p2.2.m2.3.3.7.cmml" xref="S4.SS1.p2.2.m2.3.3.7"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.7.1.cmml" xref="S4.SS1.p2.2.m2.3.3.7">superscript</csymbol><ci id="S4.SS1.p2.2.m2.3.3.7.2.cmml" xref="S4.SS1.p2.2.m2.3.3.7.2">ℝ</ci><apply id="S4.SS1.p2.2.m2.3.3.7.3.cmml" xref="S4.SS1.p2.2.m2.3.3.7.3"><times id="S4.SS1.p2.2.m2.3.3.7.3.1.cmml" xref="S4.SS1.p2.2.m2.3.3.7.3.1"></times><ci id="S4.SS1.p2.2.m2.3.3.7.3.2.cmml" xref="S4.SS1.p2.2.m2.3.3.7.3.2">𝑑</ci><ci id="S4.SS1.p2.2.m2.3.3.7.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3.7.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.3c">\mathbf{W_{I}}=[\mathbf{w}_{i_{1}}^{\top},...,\mathbf{w}_{i_{n}}^{\top}]\in%
\mathbb{R}^{d\times n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.3d">bold_W start_POSTSUBSCRIPT bold_I end_POSTSUBSCRIPT = [ bold_w start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT , … , bold_w start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, denoted the representations for <math alttext="m" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_m</annotation></semantics></math> users and <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">italic_n</annotation></semantics></math> items in a <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">italic_d</annotation></semantics></math>-dimension space respectively. Through this process, we acquire deep representations of user and item interactions, which are instrumental in enhancing the accuracy and relevance of our recommendation system.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>OOV Token Generation</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.2">To balance diversity and memorization in large-scale recommendation systems, we adopt a cluster-based approach. Representations derived from user-item interactions are organized into a shared embedding space and segmented into <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_G</annotation></semantics></math> clusters. Each cluster center, <math alttext="\mathbf{\mu}_{g}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">μ</mi><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝜇</ci><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mathbf{\mu}_{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_μ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, is defined by the average of representations within that cluster, effectively capturing the collective characteristics of its members. These centroids then categorize each user and item, providing a refined foundation for constructing granular IDs. The generation process is a two-step procedure:</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.3.1">1). Assign coarse-grained tokens based on centroids</span>. We first cluster the learned representations <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS2.p2.3.2">W</span> and set the number of clusters as <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_G</annotation></semantics></math>. Each cluster centroid <math alttext="\mathbf{\mu}_{g}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">μ</mi><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝜇</ci><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\mathbf{\mu}_{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_μ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> is calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathbf{\mu}_{g}=\left\{\frac{1}{|\mathbb{I}(g_{i}=g)|}\sum_{(\mathbf{w}%
_{i},g_{i})\in(\mathbf{W},G)}{\big{[}\mathbf{w}_{i}\cdot\mathbb{I}(g_{i}=g)%
\big{]}}\right\}_{g\in[1,G]}," class="ltx_Math" display="block" id="S4.E7.m1.8"><semantics id="S4.E7.m1.8a"><mrow id="S4.E7.m1.8.8.1" xref="S4.E7.m1.8.8.1.1.cmml"><mrow id="S4.E7.m1.8.8.1.1" xref="S4.E7.m1.8.8.1.1.cmml"><msub id="S4.E7.m1.8.8.1.1.3" xref="S4.E7.m1.8.8.1.1.3.cmml"><mi id="S4.E7.m1.8.8.1.1.3.2" mathsize="90%" xref="S4.E7.m1.8.8.1.1.3.2.cmml">μ</mi><mi id="S4.E7.m1.8.8.1.1.3.3" mathsize="90%" xref="S4.E7.m1.8.8.1.1.3.3.cmml">g</mi></msub><mo id="S4.E7.m1.8.8.1.1.2" mathsize="90%" xref="S4.E7.m1.8.8.1.1.2.cmml">=</mo><msub id="S4.E7.m1.8.8.1.1.1" xref="S4.E7.m1.8.8.1.1.1.cmml"><mrow id="S4.E7.m1.8.8.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.2.cmml"><mo id="S4.E7.m1.8.8.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.1.1.2.cmml">{</mo><mrow id="S4.E7.m1.8.8.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.1.cmml"><mfrac id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><mn id="S4.E7.m1.1.1.3" mathsize="90%" xref="S4.E7.m1.1.1.3.cmml">1</mn><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.2.cmml"><mo id="S4.E7.m1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E7.m1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.3" mathsize="90%" xref="S4.E7.m1.1.1.1.1.1.3.cmml">𝕀</mi><mo id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.1" mathsize="90%" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E7.m1.1.1.1.1.1.1.1.1.3.cmml">g</mi></mrow><mo id="S4.E7.m1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E7.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.8.8.1.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.cmml"><munder id="S4.E7.m1.8.8.1.1.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E7.m1.5.5.4" xref="S4.E7.m1.5.5.4.cmml"><mrow id="S4.E7.m1.5.5.4.4.2" xref="S4.E7.m1.5.5.4.4.3.cmml"><mo id="S4.E7.m1.5.5.4.4.2.3" maxsize="90%" minsize="90%" xref="S4.E7.m1.5.5.4.4.3.cmml">(</mo><msub id="S4.E7.m1.4.4.3.3.1.1" xref="S4.E7.m1.4.4.3.3.1.1.cmml"><mi id="S4.E7.m1.4.4.3.3.1.1.2" mathsize="90%" xref="S4.E7.m1.4.4.3.3.1.1.2.cmml">𝐰</mi><mi id="S4.E7.m1.4.4.3.3.1.1.3" mathsize="90%" xref="S4.E7.m1.4.4.3.3.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.5.5.4.4.2.4" mathsize="90%" xref="S4.E7.m1.5.5.4.4.3.cmml">,</mo><msub id="S4.E7.m1.5.5.4.4.2.2" xref="S4.E7.m1.5.5.4.4.2.2.cmml"><mi id="S4.E7.m1.5.5.4.4.2.2.2" mathsize="90%" xref="S4.E7.m1.5.5.4.4.2.2.2.cmml">g</mi><mi id="S4.E7.m1.5.5.4.4.2.2.3" mathsize="90%" xref="S4.E7.m1.5.5.4.4.2.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.5.5.4.4.2.5" maxsize="90%" minsize="90%" xref="S4.E7.m1.5.5.4.4.3.cmml">)</mo></mrow><mo id="S4.E7.m1.5.5.4.5" mathsize="90%" xref="S4.E7.m1.5.5.4.5.cmml">∈</mo><mrow id="S4.E7.m1.5.5.4.6.2" xref="S4.E7.m1.5.5.4.6.1.cmml"><mo id="S4.E7.m1.5.5.4.6.2.1" maxsize="90%" minsize="90%" xref="S4.E7.m1.5.5.4.6.1.cmml">(</mo><mi id="S4.E7.m1.2.2.1.1" mathsize="90%" xref="S4.E7.m1.2.2.1.1.cmml">𝐖</mi><mo id="S4.E7.m1.5.5.4.6.2.2" mathsize="90%" xref="S4.E7.m1.5.5.4.6.1.cmml">,</mo><mi id="S4.E7.m1.3.3.2.2" mathsize="90%" xref="S4.E7.m1.3.3.2.2.cmml">G</mi><mo id="S4.E7.m1.5.5.4.6.2.3" maxsize="90%" minsize="90%" xref="S4.E7.m1.5.5.4.6.1.cmml">)</mo></mrow></mrow></munder><mrow id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2" mathsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐰</mi><mi id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3" mathsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝕀</mi></mrow><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1" mathsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">g</mi></mrow><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E7.m1.8.8.1.1.1.1.1.3" xref="S4.E7.m1.8.8.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.E7.m1.7.7.2" xref="S4.E7.m1.7.7.2.cmml"><mi id="S4.E7.m1.7.7.2.4" mathsize="90%" xref="S4.E7.m1.7.7.2.4.cmml">g</mi><mo id="S4.E7.m1.7.7.2.3" mathsize="90%" xref="S4.E7.m1.7.7.2.3.cmml">∈</mo><mrow id="S4.E7.m1.7.7.2.5.2" xref="S4.E7.m1.7.7.2.5.1.cmml"><mo id="S4.E7.m1.7.7.2.5.2.1" maxsize="90%" minsize="90%" xref="S4.E7.m1.7.7.2.5.1.cmml">[</mo><mn id="S4.E7.m1.6.6.1.1" mathsize="90%" xref="S4.E7.m1.6.6.1.1.cmml">1</mn><mo id="S4.E7.m1.7.7.2.5.2.2" mathsize="90%" xref="S4.E7.m1.7.7.2.5.1.cmml">,</mo><mi id="S4.E7.m1.7.7.2.2" mathsize="90%" xref="S4.E7.m1.7.7.2.2.cmml">G</mi><mo id="S4.E7.m1.7.7.2.5.2.3" maxsize="90%" minsize="90%" xref="S4.E7.m1.7.7.2.5.1.cmml">]</mo></mrow></mrow></msub></mrow><mo id="S4.E7.m1.8.8.1.2" mathsize="90%" xref="S4.E7.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.8b"><apply id="S4.E7.m1.8.8.1.1.cmml" xref="S4.E7.m1.8.8.1"><eq id="S4.E7.m1.8.8.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.2"></eq><apply id="S4.E7.m1.8.8.1.1.3.cmml" xref="S4.E7.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.3.1.cmml" xref="S4.E7.m1.8.8.1.1.3">subscript</csymbol><ci id="S4.E7.m1.8.8.1.1.3.2.cmml" xref="S4.E7.m1.8.8.1.1.3.2">𝜇</ci><ci id="S4.E7.m1.8.8.1.1.3.3.cmml" xref="S4.E7.m1.8.8.1.1.3.3">𝑔</ci></apply><apply id="S4.E7.m1.8.8.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1">subscript</csymbol><set id="S4.E7.m1.8.8.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1"><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1"><times id="S4.E7.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.2"></times><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><divide id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1"></divide><cn id="S4.E7.m1.1.1.3.cmml" type="integer" xref="S4.E7.m1.1.1.3">1</cn><apply id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1"><abs id="S4.E7.m1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.2"></abs><apply id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><times id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.2"></times><ci id="S4.E7.m1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3">𝕀</ci><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1"><eq id="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply></apply></apply></apply><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1"><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E7.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.2.2"></sum><apply id="S4.E7.m1.5.5.4.cmml" xref="S4.E7.m1.5.5.4"><in id="S4.E7.m1.5.5.4.5.cmml" xref="S4.E7.m1.5.5.4.5"></in><interval closure="open" id="S4.E7.m1.5.5.4.4.3.cmml" xref="S4.E7.m1.5.5.4.4.2"><apply id="S4.E7.m1.4.4.3.3.1.1.cmml" xref="S4.E7.m1.4.4.3.3.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.3.3.1.1.1.cmml" xref="S4.E7.m1.4.4.3.3.1.1">subscript</csymbol><ci id="S4.E7.m1.4.4.3.3.1.1.2.cmml" xref="S4.E7.m1.4.4.3.3.1.1.2">𝐰</ci><ci id="S4.E7.m1.4.4.3.3.1.1.3.cmml" xref="S4.E7.m1.4.4.3.3.1.1.3">𝑖</ci></apply><apply id="S4.E7.m1.5.5.4.4.2.2.cmml" xref="S4.E7.m1.5.5.4.4.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.4.4.2.2.1.cmml" xref="S4.E7.m1.5.5.4.4.2.2">subscript</csymbol><ci id="S4.E7.m1.5.5.4.4.2.2.2.cmml" xref="S4.E7.m1.5.5.4.4.2.2.2">𝑔</ci><ci id="S4.E7.m1.5.5.4.4.2.2.3.cmml" xref="S4.E7.m1.5.5.4.4.2.2.3">𝑖</ci></apply></interval><interval closure="open" id="S4.E7.m1.5.5.4.6.1.cmml" xref="S4.E7.m1.5.5.4.6.2"><ci id="S4.E7.m1.2.2.1.1.cmml" xref="S4.E7.m1.2.2.1.1">𝐖</ci><ci id="S4.E7.m1.3.3.2.2.cmml" xref="S4.E7.m1.3.3.2.2">𝐺</ci></interval></apply></apply><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1"><times id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3"><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐰</ci><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.3">𝕀</ci></apply><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1"><eq id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply></apply></apply></apply></apply></set><apply id="S4.E7.m1.7.7.2.cmml" xref="S4.E7.m1.7.7.2"><in id="S4.E7.m1.7.7.2.3.cmml" xref="S4.E7.m1.7.7.2.3"></in><ci id="S4.E7.m1.7.7.2.4.cmml" xref="S4.E7.m1.7.7.2.4">𝑔</ci><interval closure="closed" id="S4.E7.m1.7.7.2.5.1.cmml" xref="S4.E7.m1.7.7.2.5.2"><cn id="S4.E7.m1.6.6.1.1.cmml" type="integer" xref="S4.E7.m1.6.6.1.1">1</cn><ci id="S4.E7.m1.7.7.2.2.cmml" xref="S4.E7.m1.7.7.2.2">𝐺</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.8c">\small\mathbf{\mu}_{g}=\left\{\frac{1}{|\mathbb{I}(g_{i}=g)|}\sum_{(\mathbf{w}%
_{i},g_{i})\in(\mathbf{W},G)}{\big{[}\mathbf{w}_{i}\cdot\mathbb{I}(g_{i}=g)%
\big{]}}\right\}_{g\in[1,G]},</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.8d">italic_μ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT = { divide start_ARG 1 end_ARG start_ARG | blackboard_I ( italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_g ) | end_ARG ∑ start_POSTSUBSCRIPT ( bold_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ ( bold_W , italic_G ) end_POSTSUBSCRIPT [ bold_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ blackboard_I ( italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_g ) ] } start_POSTSUBSCRIPT italic_g ∈ [ 1 , italic_G ] end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.5">in which we use <math alttext="i" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m1.1"><semantics id="S4.SS2.p2.4.m1.1a"><mi id="S4.SS2.p2.4.m1.1.1" xref="S4.SS2.p2.4.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m1.1b"><ci id="S4.SS2.p2.4.m1.1.1.cmml" xref="S4.SS2.p2.4.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m1.1d">italic_i</annotation></semantics></math> to represent a user/item for simplification. As a coarse-grained distinction between users and items, we assign an OOV token “<math alttext="\left\langle CT_{i}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m2.1"><semantics id="S4.SS2.p2.5.m2.1a"><mrow id="S4.SS2.p2.5.m2.1.1.1" xref="S4.SS2.p2.5.m2.1.1.2.cmml"><mo id="S4.SS2.p2.5.m2.1.1.1.2" xref="S4.SS2.p2.5.m2.1.1.2.1.cmml">⟨</mo><mrow id="S4.SS2.p2.5.m2.1.1.1.1" xref="S4.SS2.p2.5.m2.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m2.1.1.1.1.2" xref="S4.SS2.p2.5.m2.1.1.1.1.2.cmml">C</mi><mo id="S4.SS2.p2.5.m2.1.1.1.1.1" xref="S4.SS2.p2.5.m2.1.1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p2.5.m2.1.1.1.1.3" xref="S4.SS2.p2.5.m2.1.1.1.1.3.cmml"><mi id="S4.SS2.p2.5.m2.1.1.1.1.3.2" xref="S4.SS2.p2.5.m2.1.1.1.1.3.2.cmml">T</mi><mi id="S4.SS2.p2.5.m2.1.1.1.1.3.3" xref="S4.SS2.p2.5.m2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.SS2.p2.5.m2.1.1.1.3" xref="S4.SS2.p2.5.m2.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m2.1b"><apply id="S4.SS2.p2.5.m2.1.1.2.cmml" xref="S4.SS2.p2.5.m2.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.5.m2.1.1.2.1.cmml" xref="S4.SS2.p2.5.m2.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S4.SS2.p2.5.m2.1.1.1.1.cmml" xref="S4.SS2.p2.5.m2.1.1.1.1"><times id="S4.SS2.p2.5.m2.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m2.1.1.1.1.1"></times><ci id="S4.SS2.p2.5.m2.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m2.1.1.1.1.2">𝐶</ci><apply id="S4.SS2.p2.5.m2.1.1.1.1.3.cmml" xref="S4.SS2.p2.5.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m2.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.5.m2.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.5.m2.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.5.m2.1.1.1.1.3.2">𝑇</ci><ci id="S4.SS2.p2.5.m2.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.5.m2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m2.1c">\left\langle CT_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m2.1d">⟨ italic_C italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>” to each centroid.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">2). Assign fine-grained tokens based on distance</span>. Within each cluster, assign a token based on the distance to the centroid. In detail, we assign fine-grained tokens “<math alttext="\left\langle y_{i}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.2.cmml"><mo id="S4.SS2.p3.1.m1.1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.1.cmml">⟨</mo><msub id="S4.SS2.p3.1.m1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.1.1.2.cmml">y</mi><mi id="S4.SS2.p3.1.m1.1.1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p3.1.m1.1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p3.1.m1.1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S4.SS2.p3.1.m1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p3.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\left\langle y_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">⟨ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>” in ascending order according to their distance from the cluster centroid, and use it as a fine-grained token.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.7">The resulting identifiers, META ID, combine a coarse-grained token and a fine-grained one that uniquely identifies each user or item within that cluster. For example, an item might be represented as “<math alttext="\left\langle\text{{Item}}\right\rangle\left\langle CT_{i}\right\rangle\left%
\langle y_{i}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.3"><semantics id="S4.SS2.p4.1.m1.3a"><mrow id="S4.SS2.p4.1.m1.3.3" xref="S4.SS2.p4.1.m1.3.3.cmml"><mrow id="S4.SS2.p4.1.m1.3.3.4.2" xref="S4.SS2.p4.1.m1.3.3.4.1.cmml"><mo id="S4.SS2.p4.1.m1.3.3.4.2.1" xref="S4.SS2.p4.1.m1.3.3.4.1.1.cmml">⟨</mo><mtext id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1a.cmml">Item</mtext><mo id="S4.SS2.p4.1.m1.3.3.4.2.2" xref="S4.SS2.p4.1.m1.3.3.4.1.1.cmml">⟩</mo></mrow><mo id="S4.SS2.p4.1.m1.3.3.3" xref="S4.SS2.p4.1.m1.3.3.3.cmml">⁢</mo><mrow id="S4.SS2.p4.1.m1.2.2.1.1" xref="S4.SS2.p4.1.m1.2.2.1.2.cmml"><mo id="S4.SS2.p4.1.m1.2.2.1.1.2" xref="S4.SS2.p4.1.m1.2.2.1.2.1.cmml">⟨</mo><mrow id="S4.SS2.p4.1.m1.2.2.1.1.1" xref="S4.SS2.p4.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.2.2.1.1.1.2" xref="S4.SS2.p4.1.m1.2.2.1.1.1.2.cmml">C</mi><mo id="S4.SS2.p4.1.m1.2.2.1.1.1.1" xref="S4.SS2.p4.1.m1.2.2.1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p4.1.m1.2.2.1.1.1.3" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p4.1.m1.2.2.1.1.1.3.2" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3.2.cmml">T</mi><mi id="S4.SS2.p4.1.m1.2.2.1.1.1.3.3" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.SS2.p4.1.m1.2.2.1.1.3" xref="S4.SS2.p4.1.m1.2.2.1.2.1.cmml">⟩</mo></mrow><mo id="S4.SS2.p4.1.m1.3.3.3a" xref="S4.SS2.p4.1.m1.3.3.3.cmml">⁢</mo><mrow id="S4.SS2.p4.1.m1.3.3.2.1" xref="S4.SS2.p4.1.m1.3.3.2.2.cmml"><mo id="S4.SS2.p4.1.m1.3.3.2.1.2" xref="S4.SS2.p4.1.m1.3.3.2.2.1.cmml">⟨</mo><msub id="S4.SS2.p4.1.m1.3.3.2.1.1" xref="S4.SS2.p4.1.m1.3.3.2.1.1.cmml"><mi id="S4.SS2.p4.1.m1.3.3.2.1.1.2" xref="S4.SS2.p4.1.m1.3.3.2.1.1.2.cmml">y</mi><mi id="S4.SS2.p4.1.m1.3.3.2.1.1.3" xref="S4.SS2.p4.1.m1.3.3.2.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p4.1.m1.3.3.2.1.3" xref="S4.SS2.p4.1.m1.3.3.2.2.1.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.3b"><apply id="S4.SS2.p4.1.m1.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3"><times id="S4.SS2.p4.1.m1.3.3.3.cmml" xref="S4.SS2.p4.1.m1.3.3.3"></times><apply id="S4.SS2.p4.1.m1.3.3.4.1.cmml" xref="S4.SS2.p4.1.m1.3.3.4.2"><csymbol cd="latexml" id="S4.SS2.p4.1.m1.3.3.4.1.1.cmml" xref="S4.SS2.p4.1.m1.3.3.4.2.1">delimited-⟨⟩</csymbol><ci id="S4.SS2.p4.1.m1.1.1a.cmml" xref="S4.SS2.p4.1.m1.1.1"><mtext id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">Item</mtext></ci></apply><apply id="S4.SS2.p4.1.m1.2.2.1.2.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1"><csymbol cd="latexml" id="S4.SS2.p4.1.m1.2.2.1.2.1.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.2">delimited-⟨⟩</csymbol><apply id="S4.SS2.p4.1.m1.2.2.1.1.1.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1"><times id="S4.SS2.p4.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1.1"></times><ci id="S4.SS2.p4.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1.2">𝐶</ci><apply id="S4.SS2.p4.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.1.m1.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3.2">𝑇</ci><ci id="S4.SS2.p4.1.m1.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p4.1.m1.2.2.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S4.SS2.p4.1.m1.3.3.2.2.cmml" xref="S4.SS2.p4.1.m1.3.3.2.1"><csymbol cd="latexml" id="S4.SS2.p4.1.m1.3.3.2.2.1.cmml" xref="S4.SS2.p4.1.m1.3.3.2.1.2">delimited-⟨⟩</csymbol><apply id="S4.SS2.p4.1.m1.3.3.2.1.1.cmml" xref="S4.SS2.p4.1.m1.3.3.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.3.3.2.1.1.1.cmml" xref="S4.SS2.p4.1.m1.3.3.2.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.3.3.2.1.1.2.cmml" xref="S4.SS2.p4.1.m1.3.3.2.1.1.2">𝑦</ci><ci id="S4.SS2.p4.1.m1.3.3.2.1.1.3.cmml" xref="S4.SS2.p4.1.m1.3.3.2.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.3c">\left\langle\text{{Item}}\right\rangle\left\langle CT_{i}\right\rangle\left%
\langle y_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.3d">⟨ Item ⟩ ⟨ italic_C italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩ ⟨ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>” labeled with three tokens, “<math alttext="\left\langle\text{{Item}}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.2.2" xref="S4.SS2.p4.2.m2.1.2.1.cmml"><mo id="S4.SS2.p4.2.m2.1.2.2.1" xref="S4.SS2.p4.2.m2.1.2.1.1.cmml">⟨</mo><mtext id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1a.cmml">Item</mtext><mo id="S4.SS2.p4.2.m2.1.2.2.2" xref="S4.SS2.p4.2.m2.1.2.1.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.2.1.cmml" xref="S4.SS2.p4.2.m2.1.2.2"><csymbol cd="latexml" id="S4.SS2.p4.2.m2.1.2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.2.2.1">delimited-⟨⟩</csymbol><ci id="S4.SS2.p4.2.m2.1.1a.cmml" xref="S4.SS2.p4.2.m2.1.1"><mtext id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">Item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\left\langle\text{{Item}}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">⟨ Item ⟩</annotation></semantics></math>”, “<math alttext="\left\langle CT_{i}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.2.cmml"><mo id="S4.SS2.p4.3.m3.1.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.1.cmml">⟨</mo><mrow id="S4.SS2.p4.3.m3.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.1.1.2" xref="S4.SS2.p4.3.m3.1.1.1.1.2.cmml">C</mi><mo id="S4.SS2.p4.3.m3.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p4.3.m3.1.1.1.1.3" xref="S4.SS2.p4.3.m3.1.1.1.1.3.cmml"><mi id="S4.SS2.p4.3.m3.1.1.1.1.3.2" xref="S4.SS2.p4.3.m3.1.1.1.1.3.2.cmml">T</mi><mi id="S4.SS2.p4.3.m3.1.1.1.1.3.3" xref="S4.SS2.p4.3.m3.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.SS2.p4.3.m3.1.1.1.3" xref="S4.SS2.p4.3.m3.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1"><csymbol cd="latexml" id="S4.SS2.p4.3.m3.1.1.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S4.SS2.p4.3.m3.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1"><times id="S4.SS2.p4.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1"></times><ci id="S4.SS2.p4.3.m3.1.1.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.2">𝐶</ci><apply id="S4.SS2.p4.3.m3.1.1.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.3.2">𝑇</ci><ci id="S4.SS2.p4.3.m3.1.1.1.1.3.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\left\langle CT_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">⟨ italic_C italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>”, “<math alttext="\left\langle y_{i}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m4.1"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1.1.1" xref="S4.SS2.p4.4.m4.1.1.2.cmml"><mo id="S4.SS2.p4.4.m4.1.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.1.cmml">⟨</mo><msub id="S4.SS2.p4.4.m4.1.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.1.1.2" xref="S4.SS2.p4.4.m4.1.1.1.1.2.cmml">y</mi><mi id="S4.SS2.p4.4.m4.1.1.1.1.3" xref="S4.SS2.p4.4.m4.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p4.4.m4.1.1.1.3" xref="S4.SS2.p4.4.m4.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.1"><csymbol cd="latexml" id="S4.SS2.p4.4.m4.1.1.2.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S4.SS2.p4.4.m4.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p4.4.m4.1.1.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p4.4.m4.1.1.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">\left\langle y_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.1d">⟨ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>”, where “<math alttext="\left\langle\text{{Item}}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m5.1"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1.2.2" xref="S4.SS2.p4.5.m5.1.2.1.cmml"><mo id="S4.SS2.p4.5.m5.1.2.2.1" xref="S4.SS2.p4.5.m5.1.2.1.1.cmml">⟨</mo><mtext id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1a.cmml">Item</mtext><mo id="S4.SS2.p4.5.m5.1.2.2.2" xref="S4.SS2.p4.5.m5.1.2.1.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.2.1.cmml" xref="S4.SS2.p4.5.m5.1.2.2"><csymbol cd="latexml" id="S4.SS2.p4.5.m5.1.2.1.1.cmml" xref="S4.SS2.p4.5.m5.1.2.2.1">delimited-⟨⟩</csymbol><ci id="S4.SS2.p4.5.m5.1.1a.cmml" xref="S4.SS2.p4.5.m5.1.1"><mtext id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">Item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">\left\langle\text{{Item}}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m5.1d">⟨ Item ⟩</annotation></semantics></math>” denotes it as an item, “<math alttext="\left\langle CT_{i}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m6.1"><semantics id="S4.SS2.p4.6.m6.1a"><mrow id="S4.SS2.p4.6.m6.1.1.1" xref="S4.SS2.p4.6.m6.1.1.2.cmml"><mo id="S4.SS2.p4.6.m6.1.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2.1.cmml">⟨</mo><mrow id="S4.SS2.p4.6.m6.1.1.1.1" xref="S4.SS2.p4.6.m6.1.1.1.1.cmml"><mi id="S4.SS2.p4.6.m6.1.1.1.1.2" xref="S4.SS2.p4.6.m6.1.1.1.1.2.cmml">C</mi><mo id="S4.SS2.p4.6.m6.1.1.1.1.1" xref="S4.SS2.p4.6.m6.1.1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p4.6.m6.1.1.1.1.3" xref="S4.SS2.p4.6.m6.1.1.1.1.3.cmml"><mi id="S4.SS2.p4.6.m6.1.1.1.1.3.2" xref="S4.SS2.p4.6.m6.1.1.1.1.3.2.cmml">T</mi><mi id="S4.SS2.p4.6.m6.1.1.1.1.3.3" xref="S4.SS2.p4.6.m6.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.SS2.p4.6.m6.1.1.1.3" xref="S4.SS2.p4.6.m6.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><apply id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.1"><csymbol cd="latexml" id="S4.SS2.p4.6.m6.1.1.2.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S4.SS2.p4.6.m6.1.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1.1"><times id="S4.SS2.p4.6.m6.1.1.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1.1.1"></times><ci id="S4.SS2.p4.6.m6.1.1.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.1.1.2">𝐶</ci><apply id="S4.SS2.p4.6.m6.1.1.1.1.3.cmml" xref="S4.SS2.p4.6.m6.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.6.m6.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.6.m6.1.1.1.1.3.2">𝑇</ci><ci id="S4.SS2.p4.6.m6.1.1.1.1.3.3.cmml" xref="S4.SS2.p4.6.m6.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">\left\langle CT_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m6.1d">⟨ italic_C italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>” is its coarse-grained token and “<math alttext="\left\langle y_{i}\right\rangle" class="ltx_Math" display="inline" id="S4.SS2.p4.7.m7.1"><semantics id="S4.SS2.p4.7.m7.1a"><mrow id="S4.SS2.p4.7.m7.1.1.1" xref="S4.SS2.p4.7.m7.1.1.2.cmml"><mo id="S4.SS2.p4.7.m7.1.1.1.2" xref="S4.SS2.p4.7.m7.1.1.2.1.cmml">⟨</mo><msub id="S4.SS2.p4.7.m7.1.1.1.1" xref="S4.SS2.p4.7.m7.1.1.1.1.cmml"><mi id="S4.SS2.p4.7.m7.1.1.1.1.2" xref="S4.SS2.p4.7.m7.1.1.1.1.2.cmml">y</mi><mi id="S4.SS2.p4.7.m7.1.1.1.1.3" xref="S4.SS2.p4.7.m7.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p4.7.m7.1.1.1.3" xref="S4.SS2.p4.7.m7.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><apply id="S4.SS2.p4.7.m7.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1.1"><csymbol cd="latexml" id="S4.SS2.p4.7.m7.1.1.2.1.cmml" xref="S4.SS2.p4.7.m7.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S4.SS2.p4.7.m7.1.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.1.1.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p4.7.m7.1.1.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1.1.1.2">𝑦</ci><ci id="S4.SS2.p4.7.m7.1.1.1.1.3.cmml" xref="S4.SS2.p4.7.m7.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">\left\langle y_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.7.m7.1d">⟨ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>” is its fine-grained token.</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">This clustering and labeling process effectively compresses the vocabulary needed for ID representation while preserving the rich information necessary for recommendation tasks. In our implementation, we apply K-Means clustering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">1</span></a>]</cite>, utilizing cosine similarity to measure the affinity of representations to cluster centers. This method simplifies the complexity of representations space management and proves to be robust in our experimental validations of Section <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS4" title="5.4 Ablation Studies ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">5.4</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Integration of META ID with LLMs</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.6">The integration of OOV tokens of META ID, denoted as <math alttext="\mathbf{x_{\text{OOV}}}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">𝐱</mi><mtext id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3a.cmml">OOV</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝐱</ci><ci id="S4.SS3.p1.1.m1.1.1.3a.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><mtext id="S4.SS3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p1.1.m1.1.1.3">OOV</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathbf{x_{\text{OOV}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">bold_x start_POSTSUBSCRIPT OOV end_POSTSUBSCRIPT</annotation></semantics></math>, with LLMs involves expanding the vocabularies. This is achieved by extending the token embedding layer’s parameters from <math alttext="{\boldsymbol{\theta}}_{\boldsymbol{E}}\in\mathbb{R}^{N\times d}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><msub id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.2.2.cmml">𝜽</mi><mi id="S4.SS3.p1.2.m2.1.1.2.3" xref="S4.SS3.p1.2.m2.1.1.2.3.cmml">𝑬</mi></msub><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.3.2" xref="S4.SS3.p1.2.m2.1.1.3.3.2.cmml">N</mi><mo id="S4.SS3.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p1.2.m2.1.1.3.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><in id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></in><apply id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.2">𝜽</ci><ci id="S4.SS3.p1.2.m2.1.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3">𝑬</ci></apply><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3"><times id="S4.SS3.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.2">𝑁</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">{\boldsymbol{\theta}}_{\boldsymbol{E}}\in\mathbb{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">bold_italic_θ start_POSTSUBSCRIPT bold_italic_E end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="{\boldsymbol{\theta}}_{\boldsymbol{E}^{\prime}}\in\mathbb{R}^{(N+n)\times d}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.2" xref="S4.SS3.p1.3.m3.1.2.cmml"><msub id="S4.SS3.p1.3.m3.1.2.2" xref="S4.SS3.p1.3.m3.1.2.2.cmml"><mi id="S4.SS3.p1.3.m3.1.2.2.2" xref="S4.SS3.p1.3.m3.1.2.2.2.cmml">𝜽</mi><msup id="S4.SS3.p1.3.m3.1.2.2.3" xref="S4.SS3.p1.3.m3.1.2.2.3.cmml"><mi id="S4.SS3.p1.3.m3.1.2.2.3.2" xref="S4.SS3.p1.3.m3.1.2.2.3.2.cmml">𝑬</mi><mo id="S4.SS3.p1.3.m3.1.2.2.3.3" xref="S4.SS3.p1.3.m3.1.2.2.3.3.cmml">′</mo></msup></msub><mo id="S4.SS3.p1.3.m3.1.2.1" xref="S4.SS3.p1.3.m3.1.2.1.cmml">∈</mo><msup id="S4.SS3.p1.3.m3.1.2.3" xref="S4.SS3.p1.3.m3.1.2.3.cmml"><mi id="S4.SS3.p1.3.m3.1.2.3.2" xref="S4.SS3.p1.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml"><mrow id="S4.SS3.p1.3.m3.1.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.3.m3.1.1.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.cmml">N</mi><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.1.cmml">+</mo><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS3.p1.3.m3.1.1.1.2" rspace="0.222em" xref="S4.SS3.p1.3.m3.1.1.1.2.cmml">×</mo><mi id="S4.SS3.p1.3.m3.1.1.1.3" xref="S4.SS3.p1.3.m3.1.1.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.2.cmml" xref="S4.SS3.p1.3.m3.1.2"><in id="S4.SS3.p1.3.m3.1.2.1.cmml" xref="S4.SS3.p1.3.m3.1.2.1"></in><apply id="S4.SS3.p1.3.m3.1.2.2.cmml" xref="S4.SS3.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.2.2.1.cmml" xref="S4.SS3.p1.3.m3.1.2.2">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.2.2.2.cmml" xref="S4.SS3.p1.3.m3.1.2.2.2">𝜽</ci><apply id="S4.SS3.p1.3.m3.1.2.2.3.cmml" xref="S4.SS3.p1.3.m3.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.2.2.3.1.cmml" xref="S4.SS3.p1.3.m3.1.2.2.3">superscript</csymbol><ci id="S4.SS3.p1.3.m3.1.2.2.3.2.cmml" xref="S4.SS3.p1.3.m3.1.2.2.3.2">𝑬</ci><ci id="S4.SS3.p1.3.m3.1.2.2.3.3.cmml" xref="S4.SS3.p1.3.m3.1.2.2.3.3">′</ci></apply></apply><apply id="S4.SS3.p1.3.m3.1.2.3.cmml" xref="S4.SS3.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.2.3.1.cmml" xref="S4.SS3.p1.3.m3.1.2.3">superscript</csymbol><ci id="S4.SS3.p1.3.m3.1.2.3.2.cmml" xref="S4.SS3.p1.3.m3.1.2.3.2">ℝ</ci><apply id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"><times id="S4.SS3.p1.3.m3.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.2"></times><apply id="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1"><plus id="S4.SS3.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.1"></plus><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2">𝑁</ci><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3">𝑛</ci></apply><ci id="S4.SS3.p1.3.m3.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">{\boldsymbol{\theta}}_{\boldsymbol{E}^{\prime}}\in\mathbb{R}^{(N+n)\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">bold_italic_θ start_POSTSUBSCRIPT bold_italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_N + italic_n ) × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="N" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">italic_N</annotation></semantics></math> is the number of in-vocabulary tokens, <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">italic_n</annotation></semantics></math> is the number of OOV tokens, and <math alttext="d" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m6.1"><semantics id="S4.SS3.p1.6.m6.1a"><mi id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><ci id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m6.1d">italic_d</annotation></semantics></math> is the dimension of the token embeddings.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.2">A good initialization helps token embedding learning, here we give a representation augmentation approach different from previous works using random initialization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>. As shown in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:method_b</span>, the OOV tokens undergo a linear layer <math alttext="\boldsymbol{F}(\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.2" xref="S4.SS3.p2.1.m1.1.2.cmml"><mi id="S4.SS3.p2.1.m1.1.2.2" xref="S4.SS3.p2.1.m1.1.2.2.cmml">𝑭</mi><mo id="S4.SS3.p2.1.m1.1.2.1" xref="S4.SS3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.p2.1.m1.1.2.3.2" xref="S4.SS3.p2.1.m1.1.2.cmml"><mo id="S4.SS3.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS3.p2.1.m1.1.2.cmml">(</mo><mo id="S4.SS3.p2.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p2.1.m1.1.1.cmml">⋅</mo><mo id="S4.SS3.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.2"><times id="S4.SS3.p2.1.m1.1.2.1.cmml" xref="S4.SS3.p2.1.m1.1.2.1"></times><ci id="S4.SS3.p2.1.m1.1.2.2.cmml" xref="S4.SS3.p2.1.m1.1.2.2">𝑭</ci><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\boldsymbol{F}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">bold_italic_F ( ⋅ )</annotation></semantics></math> initialized with the category embeddings <math alttext="\mathbf{\mu}_{g}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">μ</mi><mi id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝜇</ci><ci id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\mathbf{\mu}_{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_μ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> from Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.E7" title="Equation 7 ‣ 4.2 OOV Token Generation ‣ 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">7</span></a>. Finally, the training objective for integrating META ID into LLMs is reformulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small{\boldsymbol{\theta}}^{\prime*}=\operatorname*{arg\,min}_{({\boldsymbol{%
\theta}}^{\prime},\boldsymbol{F})}\mathcal{L}_{{\boldsymbol{\theta}}^{\prime}}%
=-\sum_{j=1}^{|\mathbf{y}|}\log P_{\theta^{\prime}}\big{(}y_{j}\mid y_{&lt;j},%
\boldsymbol{E}^{\prime}(\mathbf{x}),\boldsymbol{F}(\mathbf{x_{\text{OOV}}})%
\big{)}," class="ltx_Math" display="block" id="S4.E8.m1.7"><semantics id="S4.E8.m1.7a"><mrow id="S4.E8.m1.7.7.1" xref="S4.E8.m1.7.7.1.1.cmml"><mrow id="S4.E8.m1.7.7.1.1" xref="S4.E8.m1.7.7.1.1.cmml"><msup id="S4.E8.m1.7.7.1.1.3" xref="S4.E8.m1.7.7.1.1.3.cmml"><mi id="S4.E8.m1.7.7.1.1.3.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.3.2.cmml">𝜽</mi><mrow id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.3.cmml"><mo id="S4.E8.m1.2.2.2.2.1" mathsize="142%" xref="S4.E8.m1.2.2.2.2.1.cmml">′</mo><mo id="S4.E8.m1.2.2.2.2.2" lspace="0.222em" xref="S4.E8.m1.2.2.2.3.cmml">⁣</mo><mo id="S4.E8.m1.1.1.1.1" mathsize="90%" xref="S4.E8.m1.1.1.1.1.cmml">∗</mo></mrow></msup><mo id="S4.E8.m1.7.7.1.1.4" mathsize="90%" xref="S4.E8.m1.7.7.1.1.4.cmml">=</mo><mrow id="S4.E8.m1.7.7.1.1.5" xref="S4.E8.m1.7.7.1.1.5.cmml"><munder id="S4.E8.m1.7.7.1.1.5.1" xref="S4.E8.m1.7.7.1.1.5.1.cmml"><mrow id="S4.E8.m1.7.7.1.1.5.1.2" xref="S4.E8.m1.7.7.1.1.5.1.2.cmml"><mi id="S4.E8.m1.7.7.1.1.5.1.2.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.5.1.2.2.cmml">arg</mi><mo id="S4.E8.m1.7.7.1.1.5.1.2.1" lspace="0.170em" xref="S4.E8.m1.7.7.1.1.5.1.2.1.cmml">⁢</mo><mi id="S4.E8.m1.7.7.1.1.5.1.2.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.5.1.2.3.cmml">min</mi></mrow><mrow id="S4.E8.m1.4.4.2.2" xref="S4.E8.m1.4.4.2.3.cmml"><mo id="S4.E8.m1.4.4.2.2.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.4.4.2.3.cmml">(</mo><msup id="S4.E8.m1.4.4.2.2.1" xref="S4.E8.m1.4.4.2.2.1.cmml"><mi id="S4.E8.m1.4.4.2.2.1.2" mathsize="90%" xref="S4.E8.m1.4.4.2.2.1.2.cmml">𝜽</mi><mo id="S4.E8.m1.4.4.2.2.1.3" mathsize="90%" xref="S4.E8.m1.4.4.2.2.1.3.cmml">′</mo></msup><mo id="S4.E8.m1.4.4.2.2.3" mathsize="90%" xref="S4.E8.m1.4.4.2.3.cmml">,</mo><mi id="S4.E8.m1.3.3.1.1" mathsize="90%" xref="S4.E8.m1.3.3.1.1.cmml">𝑭</mi><mo id="S4.E8.m1.4.4.2.2.4" maxsize="90%" minsize="90%" xref="S4.E8.m1.4.4.2.3.cmml">)</mo></mrow></munder><mo id="S4.E8.m1.7.7.1.1.5a" xref="S4.E8.m1.7.7.1.1.5.cmml">⁡</mo><msub id="S4.E8.m1.7.7.1.1.5.2" xref="S4.E8.m1.7.7.1.1.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.7.7.1.1.5.2.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.5.2.2.cmml">ℒ</mi><msup id="S4.E8.m1.7.7.1.1.5.2.3" xref="S4.E8.m1.7.7.1.1.5.2.3.cmml"><mi id="S4.E8.m1.7.7.1.1.5.2.3.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.5.2.3.2.cmml">𝜽</mi><mo id="S4.E8.m1.7.7.1.1.5.2.3.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.5.2.3.3.cmml">′</mo></msup></msub></mrow><mo id="S4.E8.m1.7.7.1.1.6" mathsize="90%" xref="S4.E8.m1.7.7.1.1.6.cmml">=</mo><mrow id="S4.E8.m1.7.7.1.1.1" xref="S4.E8.m1.7.7.1.1.1.cmml"><mo id="S4.E8.m1.7.7.1.1.1a" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.cmml">−</mo><mrow id="S4.E8.m1.7.7.1.1.1.1" xref="S4.E8.m1.7.7.1.1.1.1.cmml"><munderover id="S4.E8.m1.7.7.1.1.1.1.2" xref="S4.E8.m1.7.7.1.1.1.1.2.cmml"><mo id="S4.E8.m1.7.7.1.1.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S4.E8.m1.7.7.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.2.2.3" xref="S4.E8.m1.7.7.1.1.1.1.2.2.3.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.2.2.3.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S4.E8.m1.7.7.1.1.1.1.2.2.3.1" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E8.m1.7.7.1.1.1.1.2.2.3.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E8.m1.5.5.1.3" xref="S4.E8.m1.5.5.1.2.cmml"><mo id="S4.E8.m1.5.5.1.3.1" maxsize="90%" minsize="90%" xref="S4.E8.m1.5.5.1.2.1.cmml">|</mo><mi id="S4.E8.m1.5.5.1.1" mathsize="90%" xref="S4.E8.m1.5.5.1.1.cmml">𝐲</mi><mo id="S4.E8.m1.5.5.1.3.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.5.5.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E8.m1.7.7.1.1.1.1.1" xref="S4.E8.m1.7.7.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.7.7.1.1.1.1.1.3" xref="S4.E8.m1.7.7.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.3.1" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E8.m1.7.7.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E8.m1.7.7.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E8.m1.7.7.1.1.1.1.1.3.2" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.3.2.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.2.cmml">P</mi><msup id="S4.E8.m1.7.7.1.1.1.1.1.3.2.3" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mo id="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.3.cmml">′</mo></msup></msub></mrow><mo id="S4.E8.m1.7.7.1.1.1.1.1.2" xref="S4.E8.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.1.1.1" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.2.cmml">y</mi><mi id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.3.cmml">j</mi></msub><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.4" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.4.cmml">∣</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.4.cmml"><msub id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.4" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml"><msup id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝑬</mi><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">′</mo></msup><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml"><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.3.2.1" maxsize="90%" minsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S4.E8.m1.6.6" mathsize="90%" xref="S4.E8.m1.6.6.cmml">𝐱</mi><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.3.2.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.5" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.3.cmml">𝑭</mi><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.2" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.2.cmml">⁢</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml"><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml">(</mo><msub id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml"><mi id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.cmml">𝐱</mi><mtext id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3a.cmml">OOV</mtext></msub><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.3" maxsize="90%" minsize="90%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.7.7.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.7.7.1.2" mathsize="90%" xref="S4.E8.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.7b"><apply id="S4.E8.m1.7.7.1.1.cmml" xref="S4.E8.m1.7.7.1"><and id="S4.E8.m1.7.7.1.1a.cmml" xref="S4.E8.m1.7.7.1"></and><apply id="S4.E8.m1.7.7.1.1b.cmml" xref="S4.E8.m1.7.7.1"><eq id="S4.E8.m1.7.7.1.1.4.cmml" xref="S4.E8.m1.7.7.1.1.4"></eq><apply id="S4.E8.m1.7.7.1.1.3.cmml" xref="S4.E8.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.3.1.cmml" xref="S4.E8.m1.7.7.1.1.3">superscript</csymbol><ci id="S4.E8.m1.7.7.1.1.3.2.cmml" xref="S4.E8.m1.7.7.1.1.3.2">𝜽</ci><list id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2"><ci id="S4.E8.m1.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1">′</ci><times id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1"></times></list></apply><apply id="S4.E8.m1.7.7.1.1.5.cmml" xref="S4.E8.m1.7.7.1.1.5"><apply id="S4.E8.m1.7.7.1.1.5.1.cmml" xref="S4.E8.m1.7.7.1.1.5.1"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.5.1.1.cmml" xref="S4.E8.m1.7.7.1.1.5.1">subscript</csymbol><apply id="S4.E8.m1.7.7.1.1.5.1.2.cmml" xref="S4.E8.m1.7.7.1.1.5.1.2"><times id="S4.E8.m1.7.7.1.1.5.1.2.1.cmml" xref="S4.E8.m1.7.7.1.1.5.1.2.1"></times><ci id="S4.E8.m1.7.7.1.1.5.1.2.2.cmml" xref="S4.E8.m1.7.7.1.1.5.1.2.2">arg</ci><ci id="S4.E8.m1.7.7.1.1.5.1.2.3.cmml" xref="S4.E8.m1.7.7.1.1.5.1.2.3">min</ci></apply><interval closure="open" id="S4.E8.m1.4.4.2.3.cmml" xref="S4.E8.m1.4.4.2.2"><apply id="S4.E8.m1.4.4.2.2.1.cmml" xref="S4.E8.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.2.2.1.1.cmml" xref="S4.E8.m1.4.4.2.2.1">superscript</csymbol><ci id="S4.E8.m1.4.4.2.2.1.2.cmml" xref="S4.E8.m1.4.4.2.2.1.2">𝜽</ci><ci id="S4.E8.m1.4.4.2.2.1.3.cmml" xref="S4.E8.m1.4.4.2.2.1.3">′</ci></apply><ci id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1">𝑭</ci></interval></apply><apply id="S4.E8.m1.7.7.1.1.5.2.cmml" xref="S4.E8.m1.7.7.1.1.5.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.5.2.1.cmml" xref="S4.E8.m1.7.7.1.1.5.2">subscript</csymbol><ci id="S4.E8.m1.7.7.1.1.5.2.2.cmml" xref="S4.E8.m1.7.7.1.1.5.2.2">ℒ</ci><apply id="S4.E8.m1.7.7.1.1.5.2.3.cmml" xref="S4.E8.m1.7.7.1.1.5.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.5.2.3.1.cmml" xref="S4.E8.m1.7.7.1.1.5.2.3">superscript</csymbol><ci id="S4.E8.m1.7.7.1.1.5.2.3.2.cmml" xref="S4.E8.m1.7.7.1.1.5.2.3.2">𝜽</ci><ci id="S4.E8.m1.7.7.1.1.5.2.3.3.cmml" xref="S4.E8.m1.7.7.1.1.5.2.3.3">′</ci></apply></apply></apply></apply><apply id="S4.E8.m1.7.7.1.1c.cmml" xref="S4.E8.m1.7.7.1"><eq id="S4.E8.m1.7.7.1.1.6.cmml" xref="S4.E8.m1.7.7.1.1.6"></eq><share href="https://arxiv.org/html/2406.08477v1#S4.E8.m1.7.7.1.1.5.cmml" id="S4.E8.m1.7.7.1.1d.cmml" xref="S4.E8.m1.7.7.1"></share><apply id="S4.E8.m1.7.7.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1"><minus id="S4.E8.m1.7.7.1.1.1.2.cmml" xref="S4.E8.m1.7.7.1.1.1"></minus><apply id="S4.E8.m1.7.7.1.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1"><apply id="S4.E8.m1.7.7.1.1.1.1.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.2">superscript</csymbol><apply id="S4.E8.m1.7.7.1.1.1.1.2.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.2">subscript</csymbol><sum id="S4.E8.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.2.2.2"></sum><apply id="S4.E8.m1.7.7.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.2.2.3"><eq id="S4.E8.m1.7.7.1.1.1.1.2.2.3.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.2.2.3.1"></eq><ci id="S4.E8.m1.7.7.1.1.1.1.2.2.3.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S4.E8.m1.7.7.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E8.m1.7.7.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E8.m1.5.5.1.2.cmml" xref="S4.E8.m1.5.5.1.3"><abs id="S4.E8.m1.5.5.1.2.1.cmml" xref="S4.E8.m1.5.5.1.3.1"></abs><ci id="S4.E8.m1.5.5.1.1.cmml" xref="S4.E8.m1.5.5.1.1">𝐲</ci></apply></apply><apply id="S4.E8.m1.7.7.1.1.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1"><times id="S4.E8.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.2"></times><apply id="S4.E8.m1.7.7.1.1.1.1.1.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3"><log id="S4.E8.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3.1"></log><apply id="S4.E8.m1.7.7.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E8.m1.7.7.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.2">𝑃</ci><apply id="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.3">superscript</csymbol><ci id="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.2">𝜃</ci><ci id="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.3.2.3.3">′</ci></apply></apply></apply><apply id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.4">conditional</csymbol><apply id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.2">𝑦</ci><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.5.3">𝑗</ci></apply><list id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3"><apply id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2"><times id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.1"></times><apply id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑬</ci><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.2.3">′</ci></apply><ci id="S4.E8.m1.6.6.cmml" xref="S4.E8.m1.6.6">𝐱</ci></apply><apply id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3"><times id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.2"></times><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.3">𝑭</ci><apply id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1">subscript</csymbol><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2">𝐱</ci><ci id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3a.cmml" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3"><mtext id="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3.cmml" mathsize="63%" xref="S4.E8.m1.7.7.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3">OOV</mtext></ci></apply></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.7c">\small{\boldsymbol{\theta}}^{\prime*}=\operatorname*{arg\,min}_{({\boldsymbol{%
\theta}}^{\prime},\boldsymbol{F})}\mathcal{L}_{{\boldsymbol{\theta}}^{\prime}}%
=-\sum_{j=1}^{|\mathbf{y}|}\log P_{\theta^{\prime}}\big{(}y_{j}\mid y_{&lt;j},%
\boldsymbol{E}^{\prime}(\mathbf{x}),\boldsymbol{F}(\mathbf{x_{\text{OOV}}})%
\big{)},</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.7d">bold_italic_θ start_POSTSUPERSCRIPT ′ ∗ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT ( bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , bold_italic_F ) end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | bold_y | end_POSTSUPERSCRIPT roman_log italic_P start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∣ italic_y start_POSTSUBSCRIPT &lt; italic_j end_POSTSUBSCRIPT , bold_italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( bold_x ) , bold_italic_F ( bold_x start_POSTSUBSCRIPT OOV end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.6">where <math alttext="{\boldsymbol{\theta}}^{\prime}" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m1.1"><semantics id="S4.SS3.p2.3.m1.1a"><msup id="S4.SS3.p2.3.m1.1.1" xref="S4.SS3.p2.3.m1.1.1.cmml"><mi id="S4.SS3.p2.3.m1.1.1.2" xref="S4.SS3.p2.3.m1.1.1.2.cmml">𝜽</mi><mo id="S4.SS3.p2.3.m1.1.1.3" xref="S4.SS3.p2.3.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m1.1b"><apply id="S4.SS3.p2.3.m1.1.1.cmml" xref="S4.SS3.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m1.1.1.1.cmml" xref="S4.SS3.p2.3.m1.1.1">superscript</csymbol><ci id="S4.SS3.p2.3.m1.1.1.2.cmml" xref="S4.SS3.p2.3.m1.1.1.2">𝜽</ci><ci id="S4.SS3.p2.3.m1.1.1.3.cmml" xref="S4.SS3.p2.3.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m1.1c">{\boldsymbol{\theta}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m1.1d">bold_italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> now includes <math alttext="\boldsymbol{F}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m2.1"><semantics id="S4.SS3.p2.4.m2.1a"><mi id="S4.SS3.p2.4.m2.1.1" xref="S4.SS3.p2.4.m2.1.1.cmml">𝑭</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m2.1b"><ci id="S4.SS3.p2.4.m2.1.1.cmml" xref="S4.SS3.p2.4.m2.1.1">𝑭</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m2.1c">\boldsymbol{F}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m2.1d">bold_italic_F</annotation></semantics></math>, aligning with our modified embedding layer <math alttext="{\boldsymbol{\theta}}_{\boldsymbol{E}^{\prime}}" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m3.1"><semantics id="S4.SS3.p2.5.m3.1a"><msub id="S4.SS3.p2.5.m3.1.1" xref="S4.SS3.p2.5.m3.1.1.cmml"><mi id="S4.SS3.p2.5.m3.1.1.2" xref="S4.SS3.p2.5.m3.1.1.2.cmml">𝜽</mi><msup id="S4.SS3.p2.5.m3.1.1.3" xref="S4.SS3.p2.5.m3.1.1.3.cmml"><mi id="S4.SS3.p2.5.m3.1.1.3.2" xref="S4.SS3.p2.5.m3.1.1.3.2.cmml">𝑬</mi><mo id="S4.SS3.p2.5.m3.1.1.3.3" xref="S4.SS3.p2.5.m3.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m3.1b"><apply id="S4.SS3.p2.5.m3.1.1.cmml" xref="S4.SS3.p2.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m3.1.1.1.cmml" xref="S4.SS3.p2.5.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.5.m3.1.1.2.cmml" xref="S4.SS3.p2.5.m3.1.1.2">𝜽</ci><apply id="S4.SS3.p2.5.m3.1.1.3.cmml" xref="S4.SS3.p2.5.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m3.1.1.3.1.cmml" xref="S4.SS3.p2.5.m3.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.5.m3.1.1.3.2.cmml" xref="S4.SS3.p2.5.m3.1.1.3.2">𝑬</ci><ci id="S4.SS3.p2.5.m3.1.1.3.3.cmml" xref="S4.SS3.p2.5.m3.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m3.1c">{\boldsymbol{\theta}}_{\boldsymbol{E}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m3.1d">bold_italic_θ start_POSTSUBSCRIPT bold_italic_E start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to optimize the model’s performance with the OOV tokens <math alttext="\mathbf{x_{\text{OOV}}}" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m4.1"><semantics id="S4.SS3.p2.6.m4.1a"><msub id="S4.SS3.p2.6.m4.1.1" xref="S4.SS3.p2.6.m4.1.1.cmml"><mi id="S4.SS3.p2.6.m4.1.1.2" xref="S4.SS3.p2.6.m4.1.1.2.cmml">𝐱</mi><mtext id="S4.SS3.p2.6.m4.1.1.3" xref="S4.SS3.p2.6.m4.1.1.3a.cmml">OOV</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m4.1b"><apply id="S4.SS3.p2.6.m4.1.1.cmml" xref="S4.SS3.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m4.1.1.1.cmml" xref="S4.SS3.p2.6.m4.1.1">subscript</csymbol><ci id="S4.SS3.p2.6.m4.1.1.2.cmml" xref="S4.SS3.p2.6.m4.1.1.2">𝐱</ci><ci id="S4.SS3.p2.6.m4.1.1.3a.cmml" xref="S4.SS3.p2.6.m4.1.1.3"><mtext id="S4.SS3.p2.6.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p2.6.m4.1.1.3">OOV</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m4.1c">\mathbf{x_{\text{OOV}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m4.1d">bold_x start_POSTSUBSCRIPT OOV end_POSTSUBSCRIPT</annotation></semantics></math>. This training goal ensures the model can effectively distinguish between diverse users and items, improving its ability to capture user-item relationships. By enhancing memorization and diversity of OOV tokens, the model achieves better performance in recommendation tasks, leading to more accurate and personalized recommendations in our experiments.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance comparison of different methods on sequential recommendation task. META ID (T) and META ID (L) refer to the use of T5 and LLaMA2-7b as the backbone. The best and second-best performance methods are denoted in bold and underlined fonts respectively.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.1" style="width:523.1pt;height:271pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S4.T1.1.1"><span class="ltx_text" id="S4.T1.1.1.1" style="font-size:90%;"> 
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.1.1.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="S4.T1.1.1.1.1.2.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S4.T1.1.1.1.1.2.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S4.T1.1.1.1.1.2.1.1.1">Methods</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_4" id="S4.T1.1.1.1.1.2.1.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.2.1.2.1">Sports</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_4" id="S4.T1.1.1.1.1.2.1.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.2.1.3.1">Beauty</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_4" id="S4.T1.1.1.1.1.2.1.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.2.1.4.1">Toys</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.3.2">
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.2" style="padding-left:2.0pt;padding-right:2.0pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.3" style="padding-left:2.0pt;padding-right:2.0pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.4" style="padding-left:2.0pt;padding-right:2.0pt;">N@10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.5" style="padding-left:2.0pt;padding-right:2.0pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.6" style="padding-left:2.0pt;padding-right:2.0pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.7" style="padding-left:2.0pt;padding-right:2.0pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.8" style="padding-left:2.0pt;padding-right:2.0pt;">N@10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.9" style="padding-left:2.0pt;padding-right:2.0pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.10" style="padding-left:2.0pt;padding-right:2.0pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.11" style="padding-left:2.0pt;padding-right:2.0pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.3.2.12" style="padding-left:2.0pt;padding-right:2.0pt;">N@10</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.4.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.1.1.1.4.3.1" style="padding-left:2.0pt;padding-right:2.0pt;">Caser <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib36" title=""><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0116</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0072</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0194</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0097</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0205</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0131</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0347</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0176</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0166</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0107</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0270</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.4.3.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0141</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.5.4">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.5.4.1" style="padding-left:2.0pt;padding-right:2.0pt;">HGN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0189</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0120</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0313</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0159</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0325</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0206</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0512</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0266</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0321</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0221</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0497</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0277</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.6.5">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.6.5.1" style="padding-left:2.0pt;padding-right:2.0pt;">GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">15</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0129</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0086</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0204</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0110</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0164</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0099</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0283</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0137</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0097</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0059</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0176</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0084</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.7.6">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.7.6.1" style="padding-left:2.0pt;padding-right:2.0pt;">BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">35</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0115</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0075</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0191</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0099</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0203</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0124</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0347</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0170</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0116</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0071</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0203</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.7.6.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0099</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.8.7">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.8.7.1" style="padding-left:2.0pt;padding-right:2.0pt;">FDSA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">14</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0182</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0122</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0288</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0156</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0267</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0163</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0407</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0208</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0228</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0140</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0381</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.8.7.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0189</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.9.8">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.9.8.1" style="padding-left:2.0pt;padding-right:2.0pt;">SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0233</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0154</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0350</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0192</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0387</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0249</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0605</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0318</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.9.8.10.1">0.0463</span></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.11" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.9.8.11.1">0.0306</span></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0675</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0374</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">S<sup class="ltx_sup" id="S4.T1.1.1.1.1.1.1.1">3</sup>-Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0251</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0161</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0385</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0204</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0387</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0244</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0647</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0327</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0443</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0294</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.12" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.1.12.1">0.0700</span></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.1.13" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.1.13.1">0.0376</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.10.9">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.10.9.1" style="padding-left:2.0pt;padding-right:2.0pt;">CL4SRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib43" title=""><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0219</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0138</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0358</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0182</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0330</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0201</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0546</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0270</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0427</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0244</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0617</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.9.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0305</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.11.10">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.1.1.1.11.10.1" style="padding-left:2.0pt;padding-right:2.0pt;">RID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0208</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0122</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0288</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0153</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0213</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0178</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0479</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0277</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0044</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0029</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0062</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.11.10.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0035</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.12.11">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.12.11.1" style="padding-left:2.0pt;padding-right:2.0pt;">SID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0223</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0173</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0294</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0196</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0404</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0299</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0573</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0354</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0050</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0031</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0088</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.11.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0043</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.13.12">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1.1.13.12.1" style="padding-left:2.0pt;padding-right:2.0pt;">CID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.0269</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.0196</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.0378</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.0231</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.0336</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.0227</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.8" style="padding-left:2.0pt;padding-right:2.0pt;">0.0507</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.9" style="padding-left:2.0pt;padding-right:2.0pt;">0.0281</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0172</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0109</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0279</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.13.12.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0143</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.14.13">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.1.1.1.14.13.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.1.1">META ID (T)</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.14.13.2.1">0.0322</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.14.13.3.1">0.0223</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.14.13.4.1">0.0487</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.14.13.5.1">0.0277</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.6.1">0.0510</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.7.1">0.0351</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.8.1">0.0753</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.9.1">0.0429</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.10" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.10.1">0.0503</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.11" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.11.1">0.0352</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.12" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.12.1">0.0742</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.13.13" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.13.13.1">0.0429</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.15.14">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.1.1.1.1.15.14.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.15.14.1.1">META ID (L)</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.15.14.2.1">0.0392</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.15.14.3.1">0.0278</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.15.14.4.1">0.0561</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.15.14.5.1">0.0332</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.15.14.6.1">0.0458</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.15.14.7.1">0.0320</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.8" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.15.14.8.1">0.0678</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.9" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.1.1.1.1.15.14.9.1">0.0391</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.10" style="padding-left:2.0pt;padding-right:2.0pt;">0.0387</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.11" style="padding-left:2.0pt;padding-right:2.0pt;">0.0264</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.12" style="padding-left:2.0pt;padding-right:2.0pt;">0.0535</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1.15.14.13" style="padding-left:2.0pt;padding-right:2.0pt;">0.0312</span></span>
</span>
</span></span></p>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiment</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We evaluate META ID on five downstream recommendation tasks: sequential recommendation, direct recommendation, rating prediction, explanation generation, and review related tasks. We analyze the influence of critical components in META ID and assess the ID representations through visualization and our proposed metrics. Details of task descriptions and pre-processing are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3" title="Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Evaluation on Sequential Recommendation</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Setups</span>. We evaluate our META ID framework on three public real-world datasets from the Amazon Product Reviews dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite>, focusing specifically on Sports, Beauty, and Toys. The datasets are processed following the methodology in P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Baselines</span>. We compare to a variety of established models (which are described briefly in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3" title="Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">C</span></a>), spanning from CNN-based to LLM-based frameworks. Caser <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib36" title=""><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite>, HGN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>, GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">15</span></a>]</cite>, BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">35</span></a>]</cite>, FDSA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">14</span></a>]</cite>, SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite>, S<sup class="ltx_sup" id="S5.SS1.p2.1.2">3</sup>-Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite> and CL4SRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib43" title=""><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>. Specifically, we provide P5 with its variations, equipped with different ID construction strategies like Sequential ID (SID), Random ID (RID), and Collaborative ID (CID) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">Evaluations</span>. We apply widely accepted metrics, top-k Hit ratio (H@K) and Normalized discounted cumulative gain (N@K) with K = 5, 10 to evaluate the recommendation performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Implementation Details</span>. For constructing META IDs, the clustering groups are limited to <math alttext="|G|" class="ltx_Math" display="inline" id="S5.SS1.p4.1.m1.1"><semantics id="S5.SS1.p4.1.m1.1a"><mrow id="S5.SS1.p4.1.m1.1.2.2" xref="S5.SS1.p4.1.m1.1.2.1.cmml"><mo id="S5.SS1.p4.1.m1.1.2.2.1" stretchy="false" xref="S5.SS1.p4.1.m1.1.2.1.1.cmml">|</mo><mi id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">G</mi><mo id="S5.SS1.p4.1.m1.1.2.2.2" stretchy="false" xref="S5.SS1.p4.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><apply id="S5.SS1.p4.1.m1.1.2.1.cmml" xref="S5.SS1.p4.1.m1.1.2.2"><abs id="S5.SS1.p4.1.m1.1.2.1.1.cmml" xref="S5.SS1.p4.1.m1.1.2.2.1"></abs><ci id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">|G|</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p4.1.m1.1d">| italic_G |</annotation></semantics></math>=100 (200 for Toys). For LLM fine-tuning, we consider both encoder-decoder architecture T5-small <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib28" title=""><span class="ltx_text" style="font-size:90%;">28</span></a>]</cite> and decoder-only architecture LLaMA2-7b <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib37" title=""><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite>. We fully fine-tune the T5 model and employ the LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite> to fine-tune LLaMA2-7b. Vocabulary sizes of these models are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.T9" title="Table 9 ‣ C.3 Implementation Details ‣ Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">9</span></a>. For LLM inferencing, we use beam search to generate potential items evaluated under the all-item setting.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p5.1.1">Results</span>. Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.T1" title="Table 1 ‣ 4.3 Integration of META ID with LLMs ‣ 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">1</span></a> presents our findings for sequential recommendation task <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We show the standard error of the metrics for META ID in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A4.T11" title="Table 11 ‣ Appendix D Additional Experimental Results ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">11</span></a>.</span></span></span>. Our observations are as follows: 1) META ID demonstrates superior performance on all three datasets, underscoring its robustness. 2) IDs constructed of in-vocabulary tokens, RID and SID, underperform on Toys, suggesting limitations in their recommendation efficacy for LLMs. 3) CID shows marked improvements over RID and SID on Toys dataset, highlighting the benefits of incorporating OOV tokens with collaborative information. 4). While the LLaMA2-7b backbone is better in the Sports dataset, its performance in the Beauty and Toys dataset is not as good as T5, which could be linked to the distinct fine-tuning methodologies applied to these models.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluation on Various Recommendation Tasks</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">Setups</span>. To validate META ID’s adaptability, we extend our evaluation to include direct recommendation, rating prediction, explanation generation, and review tasks, akin to P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite>. For direct recommendation, the model is asked to recommend item for users directly without providing user’s interaction history. For rating prediction, the model predicts a numerical rating between 1 and 5 based on user-item data. For explanation tasks, it generates textual justifications for a user’s preference towards an item, while in review tasks, it summarizes lengthy reviews into concise titles.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">Baselines</span>. We compare to three different ID construction strategies: RID, SID, and CID.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">Evaluations</span>. For direct recommendation, we apply the same metrics as in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS1" title="5.1 Evaluation on Sequential Recommendation ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">5.1</span></a>. For rating prediction, we use MSE metric. For explanation and review tasks, we employ BLEU-1/4 metrics.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.1">Implementation Details</span>. For inferencing, we apply greedy decoding for rating, explanation, and review tasks, and beam search under the all-item setting for direct recommendation task.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p5.1.1">Results</span>.
For direct recommendation (Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.T2" title="Table 2 ‣ 5.2 Evaluation on Various Recommendation Tasks ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">2</span></a>), META ID exceeds other methods across datasets in all-item setting. This suggests that META ID effectively model the direct relationship between users and items. The results for the other three tasks in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.T3" title="Table 3 ‣ 5.2 Evaluation on Various Recommendation Tasks ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">3</span></a>, show that META ID significantly improves the BLEU scores Sports and Beauty compared to other methods. This result suggests that META ID can improve performance in text relevance tasks, including the interpretation of recommendations.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.3.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.4.2" style="font-size:90%;">Performance comparison of different methods on direct recommendation task. </span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T2.5" style="width:587.6pt;height:109pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S5.T2.5.1"><span class="ltx_text" id="S5.T2.5.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.5.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="S5.T2.5.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S5.T2.5.1.1.1.1.1.1" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="S5.T2.5.1.1.1.1.1.1.1">Methods</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="S5.T2.5.1.1.1.1.1.2" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.1.1.2.1">Sports</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="S5.T2.5.1.1.1.1.1.3" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.1.1.3.1">Beauty</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="S5.T2.5.1.1.1.1.1.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.1.1.4.1">Toys</span></span></span>
<span class="ltx_tr" id="S5.T2.5.1.1.1.2.2">
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.1" style="padding-left:2.3pt;padding-right:2.3pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.2" style="padding-left:2.3pt;padding-right:2.3pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.3" style="padding-left:2.3pt;padding-right:2.3pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.4" style="padding-left:2.3pt;padding-right:2.3pt;">N@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.5" style="padding-left:2.3pt;padding-right:2.3pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.6" style="padding-left:2.3pt;padding-right:2.3pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.7" style="padding-left:2.3pt;padding-right:2.3pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.8" style="padding-left:2.3pt;padding-right:2.3pt;">N@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.9" style="padding-left:2.3pt;padding-right:2.3pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.10" style="padding-left:2.3pt;padding-right:2.3pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.11" style="padding-left:2.3pt;padding-right:2.3pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T2.5.1.1.1.2.2.12" style="padding-left:2.3pt;padding-right:2.3pt;">N@10</span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="S5.T2.5.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.5.1.1.1.3.1.1" style="padding-left:2.3pt;padding-right:2.3pt;">RID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.2" style="padding-left:2.3pt;padding-right:2.3pt;">0.0030</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.3" style="padding-left:2.3pt;padding-right:2.3pt;">0.0023</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.4" style="padding-left:2.3pt;padding-right:2.3pt;">0.0042</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.5" style="padding-left:2.3pt;padding-right:2.3pt;">0.0027</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.6" style="padding-left:2.3pt;padding-right:2.3pt;">0.0203</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.7" style="padding-left:2.3pt;padding-right:2.3pt;">0.0155</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.8" style="padding-left:2.3pt;padding-right:2.3pt;">0.0276</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.9" style="padding-left:2.3pt;padding-right:2.3pt;">0.0178</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.10" style="padding-left:2.3pt;padding-right:2.3pt;">0.0046</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.11" style="padding-left:2.3pt;padding-right:2.3pt;">0.0030</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.12" style="padding-left:2.3pt;padding-right:2.3pt;">0.0063</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1.3.1.13" style="padding-left:2.3pt;padding-right:2.3pt;">0.0035</span></span>
<span class="ltx_tr" id="S5.T2.5.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.5.1.1.1.4.2.1" style="padding-left:2.3pt;padding-right:2.3pt;">SID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.2" style="padding-left:2.3pt;padding-right:2.3pt;">0.0211</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.3" style="padding-left:2.3pt;padding-right:2.3pt;">0.0169</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.4" style="padding-left:2.3pt;padding-right:2.3pt;">0.0267</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.5" style="padding-left:2.3pt;padding-right:2.3pt;">0.0187</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.6" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.4.2.6.1">0.0296</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.7" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.4.2.7.1">0.0226</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.8" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.4.2.8.1">0.0405</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.9" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.4.2.9.1">0.0261</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.10" style="padding-left:2.3pt;padding-right:2.3pt;">0.0025</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.11" style="padding-left:2.3pt;padding-right:2.3pt;">0.0014</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.12" style="padding-left:2.3pt;padding-right:2.3pt;">0.0041</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.4.2.13" style="padding-left:2.3pt;padding-right:2.3pt;">0.0019</span></span>
<span class="ltx_tr" id="S5.T2.5.1.1.1.5.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.5.1.1.1.5.3.1" style="padding-left:2.3pt;padding-right:2.3pt;">CID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.2" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.5.3.2.1">0.0250</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.3" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.5.3.3.1">0.0189</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.5.3.4.1">0.0342</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.5" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.5.3.5.1">0.0219</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.6" style="padding-left:2.3pt;padding-right:2.3pt;">0.0216</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.7" style="padding-left:2.3pt;padding-right:2.3pt;">0.0147</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.8" style="padding-left:2.3pt;padding-right:2.3pt;">0.0340</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.9" style="padding-left:2.3pt;padding-right:2.3pt;">0.0187</span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.10" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.5.3.10.1">0.0076</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.11" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.5.3.11.1">0.0049</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.12" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.5.3.12.1">0.0014</span></span>
<span class="ltx_td ltx_align_center" id="S5.T2.5.1.1.1.5.3.13" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.5.1.1.1.5.3.13.1">0.0070</span></span></span>
<span class="ltx_tr" id="S5.T2.5.1.1.1.6.4">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T2.5.1.1.1.6.4.1" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.1.1">META ID</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.2" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.2.1">0.0357</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.3" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.3.1">0.0256</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.4.1">0.0520</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.5" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.5.1">0.0308</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.6" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.6.1">0.0480</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.7" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.7.1">0.0336</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.8" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.8.1">0.0689</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.9" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.9.1">0.0403</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.10" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.10.1">0.0564</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.11" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.11.1">0.0391</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.12" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.12.1">0.0803</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.5.1.1.1.6.4.13" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.6.4.13.1">0.0468</span></span></span>
</span>
</span></span></p>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.3.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.4.2" style="font-size:90%;">Performance comparison of different methods on rating prediction, explanation generation, and review tasks. Due to space constraints, see Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.T10" title="Table 10 ‣ C.3.1 Evaluation on Sequential and Direct Recommendation Tasks ‣ C.3 Implementation Details ‣ Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">10</span></a> for full results.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T3.5" style="width:408.5pt;height:126pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S5.T3.5.1"><span class="ltx_text" id="S5.T3.5.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.5.1.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="S5.T3.5.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S5.T3.5.1.1.1.1.1.1" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="S5.T3.5.1.1.1.1.1.1.1">Task Type</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S5.T3.5.1.1.1.1.1.2" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="S5.T3.5.1.1.1.1.1.2.1">Metric</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_4" id="S5.T3.5.1.1.1.1.1.3" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.1.1.3.1">Sports</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_4" id="S5.T3.5.1.1.1.1.1.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.1.1.4.1">Beauty</span></span></span>
<span class="ltx_tr" id="S5.T3.5.1.1.1.2.2">
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.2.2.1" style="padding-left:3.4pt;padding-right:3.4pt;">RID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.2.2.2" style="padding-left:3.4pt;padding-right:3.4pt;">SID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.2.2.3" style="padding-left:3.4pt;padding-right:3.4pt;">CID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.2.2.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.2.2.4.1">META ID</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.2.2.5" style="padding-left:3.4pt;padding-right:3.4pt;">RID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.2.2.6" style="padding-left:3.4pt;padding-right:3.4pt;">SID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.2.2.7" style="padding-left:3.4pt;padding-right:3.4pt;">CID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.2.2.8" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.2.2.8.1">META ID</span></span></span>
<span class="ltx_tr" id="S5.T3.5.1.1.1.3.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.5.1.1.1.3.3.1" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="S5.T3.5.1.1.1.3.3.1.1">Rating</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.2" style="padding-left:3.4pt;padding-right:3.4pt;">RMSE</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.3" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.3.3.3.1">1.0382</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.4" style="padding-left:3.4pt;padding-right:3.4pt;">1.0486</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.5" style="padding-left:3.4pt;padding-right:3.4pt;">1.0383</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.6" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.3.3.6.1">1.0327</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.7" style="padding-left:3.4pt;padding-right:3.4pt;">1.2829</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.8" style="padding-left:3.4pt;padding-right:3.4pt;">1.3098</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.3.3.9.1">1.2819</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.3.3.10" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.3.3.10.1">1.2818</span></span></span>
<span class="ltx_tr" id="S5.T3.5.1.1.1.4.4">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t ltx_rowspan ltx_rowspan_2" id="S5.T3.5.1.1.1.4.4.1" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="S5.T3.5.1.1.1.4.4.1.1">Explanation</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.2" style="padding-left:3.4pt;padding-right:3.4pt;">BLEU-1</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.3" style="padding-left:3.4pt;padding-right:3.4pt;">16.2567</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.4" style="padding-left:3.4pt;padding-right:3.4pt;">16.5825</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.5" style="padding-left:3.4pt;padding-right:3.4pt;">16.6121</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.6" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.4.4.6.1">16.9005</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.7" style="padding-left:3.4pt;padding-right:3.4pt;">18.2299</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.8" style="padding-left:3.4pt;padding-right:3.4pt;">18.3981</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.4.4.9.1">19.3499</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.4.4.10" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.4.4.10.1">19.5106</span></span></span>
<span class="ltx_tr" id="S5.T3.5.1.1.1.5.5">
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.1" style="padding-left:3.4pt;padding-right:3.4pt;">BLEU-4</span>
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.2" style="padding-left:3.4pt;padding-right:3.4pt;">2.1782</span>
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.3" style="padding-left:3.4pt;padding-right:3.4pt;">2.1944</span>
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.5.5.4.1">2.2332</span></span>
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.5" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.5.5.5.1">2.3481</span></span>
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.6" style="padding-left:3.4pt;padding-right:3.4pt;">2.9027</span>
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.7" style="padding-left:3.4pt;padding-right:3.4pt;">2.8071</span>
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.8" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.5.5.8.1">3.0626</span></span>
<span class="ltx_td ltx_align_center" id="S5.T3.5.1.1.1.5.5.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.5.5.9.1">3.0592</span></span></span>
<span class="ltx_tr" id="S5.T3.5.1.1.1.6.6">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_2" id="S5.T3.5.1.1.1.6.6.1" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="S5.T3.5.1.1.1.6.6.1.1">Review</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.2" style="padding-left:3.4pt;padding-right:3.4pt;">BLEU-1</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.3" style="padding-left:3.4pt;padding-right:3.4pt;">7.6140</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.6.6.4.1">7.7948</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.5" style="padding-left:3.4pt;padding-right:3.4pt;">7.6586</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.6" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.6.6.6.1">7.8819</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.7" style="padding-left:3.4pt;padding-right:3.4pt;">6.2282</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.8" style="padding-left:3.4pt;padding-right:3.4pt;">6.5055</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.6.6.9.1">6.5854</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.5.1.1.1.6.6.10" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.6.6.10.1">7.0500</span></span></span>
<span class="ltx_tr" id="S5.T3.5.1.1.1.7.7">
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.1" style="padding-left:3.4pt;padding-right:3.4pt;">BLEU-4</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.2" style="padding-left:3.4pt;padding-right:3.4pt;">2.3228</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.3" style="padding-left:3.4pt;padding-right:3.4pt;">1.2406</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.7.7.4.1">2.4109</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.5" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.7.7.5.1">2.6546</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.6" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.5.1.1.1.7.7.6.1">1.9891</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.7" style="padding-left:3.4pt;padding-right:3.4pt;">1.2406</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.8" style="padding-left:3.4pt;padding-right:3.4pt;">1.9718</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.5.1.1.1.7.7.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.5.1.1.1.7.7.9.1">2.7485</span></span></span>
</span>
</span></span></p>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Evaluation of ID Representation</h3>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p1.1.1">Visualization</span>. The amount of numeric tokens available in LLMs is relatively limited, which complicates the establishment of unique one-to-one ID relationships, and two unrelated items might share the tokens as ID. For an intuitive explanation, we visualized the cosine similarity matrix between items using heatmaps in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">1</span></a>, where we random sample 50 items from the Toys dataset and take their adjusted cosine similarity from Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.E4" title="Equation 4 ‣ 3.3 Metric for Representation Evaluation ‣ 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4</span></a> as ground truth compared with RID, SID and META ID. RID and SID result in a large number of similar items due to semantic conflicts, while META ID shows distinguished similarity closer to ground truth. This suggests that using META ID allows LLMs to better capture relationships between users and items.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p2.1.1">Quantitative Analysis</span>. We quantitatively assess the quality of these ID representations by the proposed two metrics (Section <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.SS3" title="3.3 Metric for Representation Evaluation ‣ 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">3.3</span></a>): memorization score (MS) and diversity score (DS). Our results, shown in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:score</span>, indicate that constructing IDs of in-vocabulary tokens (RID and SID) perform poorly in the diversity dimension. For intuitive interpretation, we further employ t-SNE visualization to map ID representations and observe a tendency for these tokens to cluster narrowly in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:score</span>. META ID shows robust memorization and diversity across three datasets, reflecting its ability to</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="156" id="S5.F4.g1" src="x7.png" width="381"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.3.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S5.F4.4.2" style="font-size:90%;"> Correlation between DS and MS with NDCG@10 on sequential recommendation task.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">capture correlations between users and items from historical data while ensuring items remain distinguishable.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS3.p4.1.1">Metrics Analysis</span>. Furthermore, we conduct a correlation analysis to explore the relationship between MS/DS and sequential recommendation performance. We sum the MS and DS of different ID strategies and plot their performance on the sequential recommendation task. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.F4" title="Figure 4 ‣ 5.3 Evaluation of ID Representation ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4</span></a>, the sum of the MS and DS positively correlate with NDCG@10, suggesting that memorization and diversity of IDs are two essential properties in recommendation tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Ablation Studies</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">We analyze the properties of META ID following the evaluation in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS1" title="5.1 Evaluation on Sequential Recommendation ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">5.1</span></a>, including the impact of</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S5.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="188" id="S5.F5.sf1.g1" src="x8.png" width="299"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="183" id="S5.F5.sf2.g1" src="x9.png" width="288"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.3.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S5.F5.4.2" style="font-size:90%;"> Performance comparison of (a) different OOV token size within META ID on three datasets; (b) whether indexing both items and users on Beauty dataset.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">grouping methods, the size of OOV tokens, and different indexing ranges on the performance of META ID.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.3.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S5.T4.4.2" style="font-size:90%;">Performance of different grouping methods for META ID on sequential recommendation task.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T4.5" style="width:572.7pt;height:109pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S5.T4.5.1"><span class="ltx_text" id="S5.T4.5.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.5.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="S5.T4.5.1.1.1.1.1">
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S5.T4.5.1.1.1.1.1.1" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="S5.T4.5.1.1.1.1.1.1.1">Methods</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="S5.T4.5.1.1.1.1.1.2" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.1.1.2.1">Sports</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="S5.T4.5.1.1.1.1.1.3" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.1.1.3.1">Beauty</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="S5.T4.5.1.1.1.1.1.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.1.1.4.1">Toys</span></span></span>
<span class="ltx_tr" id="S5.T4.5.1.1.1.2.2">
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.1" style="padding-left:2.3pt;padding-right:2.3pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.2" style="padding-left:2.3pt;padding-right:2.3pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.3" style="padding-left:2.3pt;padding-right:2.3pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.4" style="padding-left:2.3pt;padding-right:2.3pt;">N@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.5" style="padding-left:2.3pt;padding-right:2.3pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.6" style="padding-left:2.3pt;padding-right:2.3pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.7" style="padding-left:2.3pt;padding-right:2.3pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.8" style="padding-left:2.3pt;padding-right:2.3pt;">N@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.9" style="padding-left:2.3pt;padding-right:2.3pt;">H@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.10" style="padding-left:2.3pt;padding-right:2.3pt;">N@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.11" style="padding-left:2.3pt;padding-right:2.3pt;">H@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.5.1.1.1.2.2.12" style="padding-left:2.3pt;padding-right:2.3pt;">N@10</span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="S5.T4.5.1.1.1.3.1">
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.1" style="padding-left:2.3pt;padding-right:2.3pt;">DBSCAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib9" title=""><span class="ltx_text" style="font-size:90%;">9</span></a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.2" style="padding-left:2.3pt;padding-right:2.3pt;">0.0078</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.3" style="padding-left:2.3pt;padding-right:2.3pt;">0.0043</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.4" style="padding-left:2.3pt;padding-right:2.3pt;">0.0145</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.5" style="padding-left:2.3pt;padding-right:2.3pt;">0.0065</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.6" style="padding-left:2.3pt;padding-right:2.3pt;">0.0257</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.7" style="padding-left:2.3pt;padding-right:2.3pt;">0.0168</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.8" style="padding-left:2.3pt;padding-right:2.3pt;">0.0428</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.9" style="padding-left:2.3pt;padding-right:2.3pt;">0.0223</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.10" style="padding-left:2.3pt;padding-right:2.3pt;">0.0180</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.11" style="padding-left:2.3pt;padding-right:2.3pt;">0.0109</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.12" style="padding-left:2.3pt;padding-right:2.3pt;">0.0304</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.5.1.1.1.3.1.13" style="padding-left:2.3pt;padding-right:2.3pt;">0.0149</span></span>
<span class="ltx_tr" id="S5.T4.5.1.1.1.4.2">
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.1" style="padding-left:2.3pt;padding-right:2.3pt;">Spectral <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.2" style="padding-left:2.3pt;padding-right:2.3pt;">0.0199</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.3" style="padding-left:2.3pt;padding-right:2.3pt;">0.0124</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.4" style="padding-left:2.3pt;padding-right:2.3pt;">0.0336</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.5" style="padding-left:2.3pt;padding-right:2.3pt;">0.0167</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.6" style="padding-left:2.3pt;padding-right:2.3pt;">0.0360</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.7" style="padding-left:2.3pt;padding-right:2.3pt;">0.0236</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.8" style="padding-left:2.3pt;padding-right:2.3pt;">0.0588</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.9" style="padding-left:2.3pt;padding-right:2.3pt;">0.0310</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.10" style="padding-left:2.3pt;padding-right:2.3pt;">0.0295</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.11" style="padding-left:2.3pt;padding-right:2.3pt;">0.0184</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.12" style="padding-left:2.3pt;padding-right:2.3pt;">0.0514</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.4.2.13" style="padding-left:2.3pt;padding-right:2.3pt;">0.0254</span></span>
<span class="ltx_tr" id="S5.T4.5.1.1.1.5.3">
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.1" style="padding-left:2.3pt;padding-right:2.3pt;">RQ-VAE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib44" title=""><span class="ltx_text" style="font-size:90%;">44</span></a>]</cite></span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.2" style="padding-left:2.3pt;padding-right:2.3pt;">0.0122</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.3" style="padding-left:2.3pt;padding-right:2.3pt;">0.0077</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.4" style="padding-left:2.3pt;padding-right:2.3pt;">0.0171</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.5" style="padding-left:2.3pt;padding-right:2.3pt;">0.0093</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.6" style="padding-left:2.3pt;padding-right:2.3pt;">0.0368</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.7" style="padding-left:2.3pt;padding-right:2.3pt;">0.0254</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.8" style="padding-left:2.3pt;padding-right:2.3pt;">0.0536</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.9" style="padding-left:2.3pt;padding-right:2.3pt;">0.0309</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.10" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.5.3.10.1">0.0511</span></span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.11" style="padding-left:2.3pt;padding-right:2.3pt;">0.0335</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.12" style="padding-left:2.3pt;padding-right:2.3pt;">0.0667</span>
<span class="ltx_td ltx_align_center" id="S5.T4.5.1.1.1.5.3.13" style="padding-left:2.3pt;padding-right:2.3pt;">0.0395</span></span>
<span class="ltx_tr" id="S5.T4.5.1.1.1.6.4">
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.1" style="padding-left:2.3pt;padding-right:2.3pt;">K-Means <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">1</span></a>]</cite></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.2" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.2.1">0.0322</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.3" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.3.1">0.0223</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.4.1">0.0487</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.5" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.5.1">0.0277</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.6" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.6.1">0.0510</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.7" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.7.1">0.0351</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.8" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.8.1">0.0753</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.9" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.9.1">0.0429</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.10" style="padding-left:2.3pt;padding-right:2.3pt;">0.0503</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.11" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.11.1">0.0352</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.12" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.12.1">0.0742</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.5.1.1.1.6.4.13" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.5.1.1.1.6.4.13.1">0.0429</span></span></span>
</span>
</span></span></p>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p3.1.1">Token Grouping</span>.
We study the importance of different grouping methods for OOV token generation in our framework. In Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.T4" title="Table 4 ‣ 5.4 Ablation Studies ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4</span></a>, we compare the performance of DBSCAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib9" title=""><span class="ltx_text" style="font-size:90%;">9</span></a>]</cite> and Spectral Clustering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite> against K-Means clustering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">1</span></a>]</cite>. Since related work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite> has not yet opened source code, here we implement it ourselves by generating OOV tokens with RQ-VAE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib44" title=""><span class="ltx_text" style="font-size:90%;">44</span></a>]</cite> using meta-path-based embeddings. Our results show that simply applying K-Means outperforms other grouping methods in most cases.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS4.p4">
<p class="ltx_p" id="S5.SS4.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p4.1.1">OOV Token Size</span>. Since varying cluster sizes <math alttext="G" class="ltx_Math" display="inline" id="S5.SS4.p4.1.m1.1"><semantics id="S5.SS4.p4.1.m1.1a"><mi id="S5.SS4.p4.1.m1.1.1" xref="S5.SS4.p4.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.1.m1.1b"><ci id="S5.SS4.p4.1.m1.1.1.cmml" xref="S5.SS4.p4.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.1.m1.1d">italic_G</annotation></semantics></math> result in different numbers of OOV tokens, we also investigate the impact of different cluster sizes for META ID in Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:token_a</span>. We find that the granularity of token clusters plays a crucial role in recommendation performance. An excessive token scale can introduce noise, reducing the performance. Therefore, finding an optimal token size is vital to ensure that META ID effectively adapts to various datasets’ nuances.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS4.p5">
<p class="ltx_p" id="S5.SS4.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.p5.1.1">User or Item Indexing</span>.
Previous ID strategies for LLMs only consider indexing for items, which come from the convention that users are typically represented by a sequence of interacted items in sequential recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite>. While META ID models users and items, as shown in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:token_b</span>, reveals that the combined user-item indexing (User&amp;Item) outperforms either user-only or item-only indexing. This result shows the importance of incorporating user preferences and item attributes for LLMs to enhance the accuracy of the recommendations.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This study introduces META ID, a method enhancing Large Language Models (LLMs) for recommender systems using OOV tokens. Moving beyond constructing IDs with in-vocabulary tokens, META ID incorporates user-item interaction information to align LLMs more effectively with recommendation tasks. We learn representations from user-item interactions utilizing meta-paths sampling. By clustering these representations we generate OOV tokens to construct META ID. This approach guarantees tokens capturing correlations between users and items from historical data while ensuring distinctiveness among item. Our experiments across various real-world datasets demonstrate META ID’s robust performance in diverse recommendation tasks, including sequential and direct recommendation, as well as complex tasks requiring detailed textual responses.
Essentially, META ID effectively combines the capabilities of LLMs with the nuanced requirements of recommendation scenarios, such as planning highly personalized content for users as virtual shopping assistants.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib1.4.4.1" style="font-size:90%;">Arthur and Vassilvitskii [2007]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.6.1" style="font-size:90%;">
David Arthur and Sergei Vassilvitskii.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.7.1" style="font-size:90%;">k-means++: the advantages of careful seeding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.8.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib1.9.2" style="font-size:90%;">Proceedings of the Eighteenth Annual ACM-SIAM Symposium on Discrete Algorithms, SODA 2007, New Orleans, Louisiana, USA, January 7-9, 2007</em><span class="ltx_text" id="bib.bib1.10.3" style="font-size:90%;">, pages 1027–1035. SIAM, 2007.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib2.5.5.1" style="font-size:90%;">Bao et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.7.1" style="font-size:90%;">
Keqin Bao, Jizhi Zhang, Yang Zhang, Wenjie Wang, Fuli Feng, and Xiangnan He.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.8.1" style="font-size:90%;">Tallrec: An effective and efficient tuning framework to align large language model with recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib2.10.2" style="font-size:90%;">Proceedings of the 17th ACM Conference on Recommender Systems, RecSys 2023, Singapore, Singapore, September 18-22, 2023</em><span class="ltx_text" id="bib.bib2.11.3" style="font-size:90%;">, pages 1007–1014. ACM, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib3.5.5.1" style="font-size:90%;">Bi et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.7.1" style="font-size:90%;">
Qiwei Bi, Jian Li, Lifeng Shang, Xin Jiang, Qun Liu, and Hanfang Yang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.8.1" style="font-size:90%;">Mtrec: Multi-task learning over BERT for news recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib3.10.2" style="font-size:90%;">Findings of the Association for Computational Linguistics: ACL 2022, Dublin, Ireland, May 22-27, 2022</em><span class="ltx_text" id="bib.bib3.11.3" style="font-size:90%;">, pages 2663–2669. Association for Computational Linguistics, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib4.5.5.1" style="font-size:90%;">Chen et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.7.1" style="font-size:90%;">
Qiwei Chen, Huan Zhao, Wei Li, Pipei Huang, and Wenwu Ou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.8.1" style="font-size:90%;">Behavior sequence transformer for e-commerce recommendation in alibaba.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib4.10.2" style="font-size:90%;">Proceedings of the 1st International Workshop on Deep Learning Practice for High-Dimensional Sparse Data</em><span class="ltx_text" id="bib.bib4.11.3" style="font-size:90%;">, DLP-KDD ’19. Association for Computing Machinery, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib5.4.4.1" style="font-size:90%;">Chen [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.6.1" style="font-size:90%;">
Zheng Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.7.1" style="font-size:90%;">PALR: personalization aware llms for recommendation.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.8.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib5.9.2" style="font-size:90%;">, abs/2305.07622, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib6.5.5.1" style="font-size:90%;">Cui et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.7.1" style="font-size:90%;">
Zeyu Cui, Jianxin Ma, Chang Zhou, Jingren Zhou, and Hongxia Yang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.8.1" style="font-size:90%;">M6-rec: Generative pretrained language models are open-ended recommender systems.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib6.10.2" style="font-size:90%;">, abs/2205.08084, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib7.5.5.1" style="font-size:90%;">Davidson et al. [2010]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.7.1" style="font-size:90%;">
James Davidson, Benjamin Liebald, Junning Liu, Palash Nandy, Taylor Van Vleet, Ullas Gargi, Sujoy Gupta, Yu He, Mike Lambert, Blake Livingston, and Dasarathi Sampath.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.8.1" style="font-size:90%;">The youtube video recommendation system.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib7.10.2" style="font-size:90%;">Proceedings of the 2010 ACM Conference on Recommender Systems, RecSys 2010, Barcelona, Spain, September 26-30, 2010</em><span class="ltx_text" id="bib.bib7.11.3" style="font-size:90%;">, pages 293–296. ACM, 2010.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib8.5.5.1" style="font-size:90%;">Dong et al. [2017]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.7.1" style="font-size:90%;">
Yuxiao Dong, Nitesh V. Chawla, and Ananthram Swami.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.8.1" style="font-size:90%;">metapath2vec: Scalable representation learning for heterogeneous networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib8.10.2" style="font-size:90%;">Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, Halifax, NS, Canada, August 13 - 17, 2017</em><span class="ltx_text" id="bib.bib8.11.3" style="font-size:90%;">, pages 135–144. ACM, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib9.5.5.1" style="font-size:90%;">Ester et al. [1996]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.7.1" style="font-size:90%;">
Martin Ester, Hans-Peter Kriegel, Jörg Sander, and Xiaowei Xu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.8.1" style="font-size:90%;">A density-based algorithm for discovering clusters in large spatial databases with noise.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib9.10.2" style="font-size:90%;">Proceedings of the Second International Conference on Knowledge Discovery and Data Mining (KDD-96), Portland, Oregon, USA</em><span class="ltx_text" id="bib.bib9.11.3" style="font-size:90%;">, pages 226–231. AAAI Press, 1996.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib10.5.5.1" style="font-size:90%;">Fan et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.7.1" style="font-size:90%;">
Wenqi Fan, Yao Ma, Qing Li, Yuan He, Yihong Eric Zhao, Jiliang Tang, and Dawei Yin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.8.1" style="font-size:90%;">Graph neural networks for social recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib10.10.2" style="font-size:90%;">The World Wide Web Conference, WWW 2019, San Francisco, CA, USA, May 13-17, 2019</em><span class="ltx_text" id="bib.bib10.11.3" style="font-size:90%;">, pages 417–426. ACM, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib11.5.5.1" style="font-size:90%;">Fan et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.7.1" style="font-size:90%;">
Wenqi Fan, Zihuai Zhao, Jiatong Li, Yunqing Liu, Xiaowei Mei, Yiqi Wang, Jiliang Tang, and Qing Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.8.1" style="font-size:90%;">Recommender systems in the era of large language models (llms).
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib11.10.2" style="font-size:90%;">, abs/2307.02046, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib12.5.5.1" style="font-size:90%;">Gao et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.7.1" style="font-size:90%;">
Yunfan Gao, Tao Sheng, Youlin Xiang, Yun Xiong, Haofen Wang, and Jiawei Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.8.1" style="font-size:90%;">Chat-rec: Towards interactive and explainable llms-augmented recommender system.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib12.10.2" style="font-size:90%;">, abs/2303.14524, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib13.5.5.1" style="font-size:90%;">Geng et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.7.1" style="font-size:90%;">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.8.1" style="font-size:90%;">Recommendation as language processing (RLP): A unified pretrain, personalized prompt &amp; predict paradigm (P5).
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib13.10.2" style="font-size:90%;">RecSys ’22: Sixteenth ACM Conference on Recommender Systems, Seattle, WA, USA, September 18 - 23, 2022</em><span class="ltx_text" id="bib.bib13.11.3" style="font-size:90%;">, pages 299–315. ACM, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib14.5.5.1" style="font-size:90%;">Hao et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.7.1" style="font-size:90%;">
Yongjing Hao, Tingting Zhang, Pengpeng Zhao, Yanchi Liu, Victor S. Sheng, Jiajie Xu, Guanfeng Liu, and Xiaofang Zhou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.8.1" style="font-size:90%;">Feature-level deeper self-attention network with contrastive learning for sequential recommendation.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.9.1" style="font-size:90%;">IEEE Trans. Knowl. Data Eng.</em><span class="ltx_text" id="bib.bib14.10.2" style="font-size:90%;">, 35(10):10112–10124, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib15.5.5.1" style="font-size:90%;">Hidasi et al. [2016]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.7.1" style="font-size:90%;">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.8.1" style="font-size:90%;">Session-based recommendations with recurrent neural networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib15.10.2" style="font-size:90%;">4th International Conference on Learning Representations, ICLR 2016, San Juan, Puerto Rico, May 2-4, 2016, Conference Track Proceedings</em><span class="ltx_text" id="bib.bib15.11.3" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib16.5.5.1" style="font-size:90%;">Hu et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.7.1" style="font-size:90%;">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.8.1" style="font-size:90%;">Lora: Low-rank adaptation of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib16.10.2" style="font-size:90%;">The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022</em><span class="ltx_text" id="bib.bib16.11.3" style="font-size:90%;">. OpenReview.net, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib17.5.5.1" style="font-size:90%;">Hua et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.7.1" style="font-size:90%;">
Wenyue Hua, Shuyuan Xu, Yingqiang Ge, and Yongfeng Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.8.1" style="font-size:90%;">How to index item ids for recommendation foundation models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.9.1" style="font-size:90%;">pages 195–204, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib18.5.5.1" style="font-size:90%;">Ji et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.7.1" style="font-size:90%;">
Ziwei Ji, Nayeon Lee, Rita Frieske, Tiezheng Yu, Dan Su, Yan Xu, Etsuko Ishii, Yejin Bang, Andrea Madotto, and Pascale Fung.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.8.1" style="font-size:90%;">Survey of hallucination in natural language generation.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.9.1" style="font-size:90%;">ACM Comput. Surv.</em><span class="ltx_text" id="bib.bib18.10.2" style="font-size:90%;">, 55(12):248:1–248:38, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib19.4.4.1" style="font-size:90%;">Kang and McAuley [2018]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.6.1" style="font-size:90%;">
Wang-Cheng Kang and Julian J. McAuley.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.7.1" style="font-size:90%;">Self-attentive sequential recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.8.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib19.9.2" style="font-size:90%;">IEEE International Conference on Data Mining, ICDM 2018, Singapore, November 17-20, 2018</em><span class="ltx_text" id="bib.bib19.10.3" style="font-size:90%;">, pages 197–206. IEEE Computer Society, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib20.5.5.1" style="font-size:90%;">Kluger et al. [2003]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.7.1" style="font-size:90%;">
Yuval Kluger, Ronen Basri, Joseph T Chang, and Mark Gerstein.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.8.1" style="font-size:90%;">Spectral biclustering of microarray data: coclustering genes and conditions.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.9.1" style="font-size:90%;">Genome research</em><span class="ltx_text" id="bib.bib20.10.2" style="font-size:90%;">, 13(4):703–716, 2003.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib21.5.5.1" style="font-size:90%;">Koren et al. [2009]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.7.1" style="font-size:90%;">
Yehuda Koren, Robert M. Bell, and Chris Volinsky.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.8.1" style="font-size:90%;">Matrix factorization techniques for recommender systems.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.9.1" style="font-size:90%;">Computer</em><span class="ltx_text" id="bib.bib21.10.2" style="font-size:90%;">, 42(8):30–37, 2009.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib22.5.5.1" style="font-size:90%;">Koren et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.7.1" style="font-size:90%;">
Yehuda Koren, Steffen Rendle, and Robert M. Bell.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.8.1" style="font-size:90%;">Advances in collaborative filtering.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib22.10.2" style="font-size:90%;">Recommender Systems Handbook</em><span class="ltx_text" id="bib.bib22.11.3" style="font-size:90%;">, pages 91–142. Springer US, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib23.5.5.1" style="font-size:90%;">Li et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.7.1" style="font-size:90%;">
Jinming Li, Wentao Zhang, Tian Wang, Guanglei Xiong, Alan Lu, and Gerard Medioni.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.8.1" style="font-size:90%;">Gpt4rec: A generative framework for personalized recommendation and user interests interpretation.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib23.10.2" style="font-size:90%;">, abs/2304.03879, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib24.5.5.1" style="font-size:90%;">Li et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.7.1" style="font-size:90%;">
Lei Li, Yongfeng Zhang, and Li Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.8.1" style="font-size:90%;">Generate neural template explanations for recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib24.10.2" style="font-size:90%;">CIKM ’20: The 29th ACM International Conference on Information and Knowledge Management, Virtual Event, Ireland, October 19-23, 2020</em><span class="ltx_text" id="bib.bib24.11.3" style="font-size:90%;">, pages 755–764. ACM, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib25.5.5.1" style="font-size:90%;">Li et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.7.1" style="font-size:90%;">
Lei Li, Yongfeng Zhang, and Li Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.8.1" style="font-size:90%;">Personalized transformer for explainable recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib25.10.2" style="font-size:90%;">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing, ACL/IJCNLP 2021, (Volume 1: Long Papers), Virtual Event, August 1-6, 2021</em><span class="ltx_text" id="bib.bib25.11.3" style="font-size:90%;">, pages 4947–4957. Association for Computational Linguistics, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib26.5.5.1" style="font-size:90%;">Ma et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.7.1" style="font-size:90%;">
Chen Ma, Peng Kang, and Xue Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.8.1" style="font-size:90%;">Hierarchical gating networks for sequential recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib26.10.2" style="font-size:90%;">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, KDD 2019, Anchorage, AK, USA, August 4-8, 2019</em><span class="ltx_text" id="bib.bib26.11.3" style="font-size:90%;">, pages 825–833. ACM, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib27.5.5.1" style="font-size:90%;">Ni et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.7.1" style="font-size:90%;">
Jianmo Ni, Jiacheng Li, and Julian McAuley.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.8.1" style="font-size:90%;">Justifying recommendations using distantly-labeled reviews and fine-grained aspects.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib27.10.2" style="font-size:90%;">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em><span class="ltx_text" id="bib.bib27.11.3" style="font-size:90%;">, pages 188–197, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib28.5.5.1" style="font-size:90%;">Raffel et al. [2020a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.7.1" style="font-size:90%;">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.8.1" style="font-size:90%;">Exploring the limits of transfer learning with a unified text-to-text transformer.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.9.1" style="font-size:90%;">J. Mach. Learn. Res.</em><span class="ltx_text" id="bib.bib28.10.2" style="font-size:90%;">, 21:140:1–140:67, 2020a.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib29.5.5.1" style="font-size:90%;">Raffel et al. [2020b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.7.1" style="font-size:90%;">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.8.1" style="font-size:90%;">Exploring the limits of transfer learning with a unified text-to-text transformer.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.9.1" style="font-size:90%;">J. Mach. Learn. Res.</em><span class="ltx_text" id="bib.bib29.10.2" style="font-size:90%;">, 21:140:1–140:67, 2020b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib30.5.5.1" style="font-size:90%;">Rajput et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.7.1" style="font-size:90%;">
Shashank Rajput, Nikhil Mehta, Anima Singh, Raghunandan H. Keshavan, Trung Vu, Lukasz Heldt, Lichan Hong, Yi Tay, Vinh Q. Tran, Jonah Samost, Maciej Kula, Ed H. Chi, and Maheswaran Sathiamoorthy.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.8.1" style="font-size:90%;">Recommender systems with generative retrieval.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib30.10.2" style="font-size:90%;">, abs/2305.05065, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib31.5.5.1" style="font-size:90%;">Ren et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.7.1" style="font-size:90%;">
Ruiyang Ren, Zhaoyang Liu, Yaliang Li, Wayne Xin Zhao, Hui Wang, Bolin Ding, and Ji-Rong Wen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.8.1" style="font-size:90%;">Sequential recommendation with self-attentive multi-adversarial network.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib31.10.2" style="font-size:90%;">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval, SIGIR 2020, Virtual Event, China, July 25-30, 2020</em><span class="ltx_text" id="bib.bib31.11.3" style="font-size:90%;">, pages 89–98. ACM, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib32.5.5.1" style="font-size:90%;">Rendle et al. [2009]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.7.1" style="font-size:90%;">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.8.1" style="font-size:90%;">BPR: bayesian personalized ranking from implicit feedback.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib32.10.2" style="font-size:90%;">UAI 2009, Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence, Montreal, QC, Canada, June 18-21, 2009</em><span class="ltx_text" id="bib.bib32.11.3" style="font-size:90%;">, pages 452–461. AUAI Press, 2009.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib33.5.5.1" style="font-size:90%;">Sanh et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.7.1" style="font-size:90%;">
Victor Sanh, Albert Webson, Colin Raffel, Stephen H. Bach, Lintang Sutawika, Zaid Alyafeai, Antoine Chaffin, Arnaud Stiegler, Arun Raja, Manan Dey, M Saiful Bari, Canwen Xu, Urmish Thakker, Shanya Sharma Sharma, Eliza Szczechla, Taewoon Kim, Gunjan Chhablani, Nihal V. Nayak, Debajyoti Datta, Jonathan Chang, Mike Tian-Jian Jiang, Han Wang, Matteo Manica, Sheng Shen, Zheng Xin Yong, Harshit Pandey, Rachel Bawden, Thomas Wang, Trishala Neeraj, Jos Rozen, Abheesht Sharma, Andrea Santilli, Thibault Févry, Jason Alan Fries, Ryan Teehan, Teven Le Scao, Stella Biderman, Leo Gao, Thomas Wolf, and Alexander M. Rush.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.8.1" style="font-size:90%;">Multitask prompted training enables zero-shot task generalization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib33.10.2" style="font-size:90%;">The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022</em><span class="ltx_text" id="bib.bib33.11.3" style="font-size:90%;">. OpenReview.net, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib34.5.5.1" style="font-size:90%;">Sarwar et al. [2001]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.7.1" style="font-size:90%;">
Badrul Munir Sarwar, George Karypis, Joseph A. Konstan, and John Riedl.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.8.1" style="font-size:90%;">Item-based collaborative filtering recommendation algorithms.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib34.10.2" style="font-size:90%;">Proceedings of the Tenth International World Wide Web Conference, WWW 10, Hong Kong, China, May 1-5, 2001</em><span class="ltx_text" id="bib.bib34.11.3" style="font-size:90%;">, pages 285–295. ACM, 2001.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib35.5.5.1" style="font-size:90%;">Sun et al. [2019]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.7.1" style="font-size:90%;">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.8.1" style="font-size:90%;">Bert4rec: Sequential recommendation with bidirectional encoder representations from transformer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib35.10.2" style="font-size:90%;">Proceedings of the 28th ACM International Conference on Information and Knowledge Management, CIKM 2019, Beijing, China, November 3-7, 2019</em><span class="ltx_text" id="bib.bib35.11.3" style="font-size:90%;">, pages 1441–1450. ACM, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib36.4.4.1" style="font-size:90%;">Tang and Wang [2018]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.6.1" style="font-size:90%;">
Jiaxi Tang and Ke Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.7.1" style="font-size:90%;">Personalized top-n sequential recommendation via convolutional sequence embedding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.8.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib36.9.2" style="font-size:90%;">Proceedings of the Eleventh ACM International Conference on Web Search and Data Mining, WSDM 2018, Marina Del Rey, CA, USA, February 5-9, 2018</em><span class="ltx_text" id="bib.bib36.10.3" style="font-size:90%;">, pages 565–573. ACM, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib37.5.5.1" style="font-size:90%;">Touvron et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.7.1" style="font-size:90%;">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton-Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa, Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurélien Rodriguez, Robert Stojnic, Sergey Edunov,
and Thomas Scialom.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.8.1" style="font-size:90%;">Llama 2: Open foundation and fine-tuned chat models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib37.10.2" style="font-size:90%;">, abs/2307.09288, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib38.5.5.1" style="font-size:90%;">Wang et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.7.1" style="font-size:90%;">
Jinpeng Wang, Jieming Zhu, and Xiuqiang He.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.8.1" style="font-size:90%;">Cross-batch negative sampling for training two-tower recommenders.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib38.10.2" style="font-size:90%;">SIGIR ’21: The 44th International ACM SIGIR Conference on Research and Development in Information Retrieval, Virtual Event, Canada, July 11-15, 2021</em><span class="ltx_text" id="bib.bib38.11.3" style="font-size:90%;">, pages 1632–1636. ACM, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib39.5.5.1" style="font-size:90%;">Wang et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.7.1" style="font-size:90%;">
Qi-Wei Wang, Hongyu Lu, Yu Chen, Da-Wei Zhou, De-Chuan Zhan, Ming Chen, and Han-Jia Ye.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.8.1" style="font-size:90%;">Streaming CTR prediction: Rethinking recommendation task for real-world streaming data.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib39.10.2" style="font-size:90%;">, abs/2307.07509, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib40.5.5.1" style="font-size:90%;">Wang et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.7.1" style="font-size:90%;">
Wei-Yao Wang, Wei-Wei Du, and Wen-Chih Peng.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.8.1" style="font-size:90%;">Recformer: personalized temporal-aware transformer for fair music recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib40.10.2" style="font-size:90%;">Proceedings of the CIKM 2022 Workshops co-located with 31st ACM International Conference on Information and Knowledge Management (CIKM 2022), Atlanta, USA, October 17-21, 2022</em><span class="ltx_text" id="bib.bib40.11.3" style="font-size:90%;">, volume 3318 of </span><em class="ltx_emph ltx_font_italic" id="bib.bib40.12.4" style="font-size:90%;">CEUR Workshop Proceedings</em><span class="ltx_text" id="bib.bib40.13.5" style="font-size:90%;">. CEUR-WS.org, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib41.5.5.1" style="font-size:90%;">Wei et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.7.1" style="font-size:90%;">
Jason Wei, Maarten Bosma, Vincent Y. Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M. Dai, and Quoc V. Le.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.8.1" style="font-size:90%;">Finetuned language models are zero-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib41.10.2" style="font-size:90%;">The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022</em><span class="ltx_text" id="bib.bib41.11.3" style="font-size:90%;">. OpenReview.net, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib42.5.5.1" style="font-size:90%;">Wu et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.7.1" style="font-size:90%;">
Chuhan Wu, Fangzhao Wu, Tao Qi, and Yongfeng Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.8.1" style="font-size:90%;">Empowering news recommendation with pre-trained language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib42.10.2" style="font-size:90%;">SIGIR ’21: The 44th International ACM SIGIR Conference on Research and Development in Information Retrieval, Virtual Event, Canada, July 11-15, 2021</em><span class="ltx_text" id="bib.bib42.11.3" style="font-size:90%;">, pages 1652–1656. ACM, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib43.5.5.1" style="font-size:90%;">Xie et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.7.1" style="font-size:90%;">
Xu Xie, Fei Sun, Zhaoyang Liu, Shiwen Wu, Jinyang Gao, Jiandong Zhang, Bolin Ding, and Bin Cui.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.8.1" style="font-size:90%;">Contrastive learning for sequential recommendation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib43.10.2" style="font-size:90%;">38th IEEE International Conference on Data Engineering, ICDE 2022, Kuala Lumpur, Malaysia, May 9-12, 2022</em><span class="ltx_text" id="bib.bib43.11.3" style="font-size:90%;">, pages 1259–1273. IEEE, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib44.5.5.1" style="font-size:90%;">Zeghidour et al. [2022]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.7.1" style="font-size:90%;">
Neil Zeghidour, Alejandro Luebs, Ahmed Omran, Jan Skoglund, and Marco Tagliasacchi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.8.1" style="font-size:90%;">Soundstream: An end-to-end neural audio codec.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.9.1" style="font-size:90%;">IEEE ACM Trans. Audio Speech Lang. Process.</em><span class="ltx_text" id="bib.bib44.10.2" style="font-size:90%;">, 30:495–507, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib45.5.5.1" style="font-size:90%;">Zhang et al. [2023a]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.7.1" style="font-size:90%;">
Junjie Zhang, Ruobing Xie, Yupeng Hou, Wayne Xin Zhao, Leyu Lin, and Ji-Rong Wen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.8.1" style="font-size:90%;">Recommendation as instruction following: A large language model empowered recommendation approach.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib45.10.2" style="font-size:90%;">, abs/2305.07001, 2023a.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib46.5.5.1" style="font-size:90%;">Zhang et al. [2023b]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.7.1" style="font-size:90%;">
Yi-Kai Zhang, Ting-Ji Huang, Yao-Xiang Ding, De-Chuan Zhan, and Han-Jia Ye.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.8.1" style="font-size:90%;">Model spider: Learning to rank pre-trained models efficiently.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib46.10.2" style="font-size:90%;">Advances in Neural Information Processing Systems 36: Annual Conference on Neural Information Processing Systems 2023, NeurIPS 2023, New Orleans, LA, USA, December 10 - 16, 2023</em><span class="ltx_text" id="bib.bib46.11.3" style="font-size:90%;">, 2023b.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib47.5.5.1" style="font-size:90%;">Zhang et al. [2021]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.7.1" style="font-size:90%;">
Yuhui Zhang, HAO DING, Zeren Shui, Yifei Ma, James Zou, Anoop Deoras, and Hao Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.8.1" style="font-size:90%;">Language models as recommender systems: Evaluations and limitations.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib47.10.2" style="font-size:90%;">I (Still) Can’t Believe It’s Not Better! NeurIPS 2021 Workshop</em><span class="ltx_text" id="bib.bib47.11.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib48.5.5.1" style="font-size:90%;">Zhao et al. [2023]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.7.1" style="font-size:90%;">
Wayne Xin Zhao, Kun Zhou, Junyi Li, Tianyi Tang, Xiaolei Wang, Yupeng Hou, Yingqian Min, Beichen Zhang, Junjie Zhang, Zican Dong, Yifan Du, Chen Yang, Yushuo Chen, Zhipeng Chen, Jinhao Jiang, Ruiyang Ren, Yifan Li, Xinyu Tang, Zikang Liu, Peiyu Liu, Jian-Yun Nie, and Ji-Rong Wen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.8.1" style="font-size:90%;">A survey of large language models.
</span>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.9.1" style="font-size:90%;">CoRR</em><span class="ltx_text" id="bib.bib48.10.2" style="font-size:90%;">, abs/2303.18223, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib49.5.5.1" style="font-size:90%;">Zhou et al. [2020]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.7.1" style="font-size:90%;">
Kun Zhou, Hui Wang, Wayne Xin Zhao, Yutao Zhu, Sirui Wang, Fuzheng Zhang, Zhongyuan Wang, and Ji-Rong Wen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.8.1" style="font-size:90%;">S3-rec: Self-supervised learning for sequential recommendation with mutual information maximization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.9.1" style="font-size:90%;">In </span><em class="ltx_emph ltx_font_italic" id="bib.bib49.10.2" style="font-size:90%;">CIKM ’20: The 29th ACM International Conference on Information and Knowledge Management, Virtual Event, Ireland, October 19-23, 2020</em><span class="ltx_text" id="bib.bib49.11.3" style="font-size:90%;">, pages 1893–1902. ACM, 2020.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para" id="p1">
<p class="ltx_p ltx_align_center" id="p1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1" style="font-size:120%;">Appendix</span></p>
</div>
<div class="ltx_para" id="p2">
<p class="ltx_p" id="p2.1">We provide details omitted in the main paper.</p>
<ul class="ltx_itemize" id="A0.I1">
<li class="ltx_item" id="A0.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A0.I1.i1.p1">
<p class="ltx_p" id="A0.I1.i1.p1.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2406.08477v1#A1" title="Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">Appendix A</span></a>: Workflow of META ID, encompassing the construction of OOV tokens.</p>
</div>
</li>
<li class="ltx_item" id="A0.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A0.I1.i2.p1">
<p class="ltx_p" id="A0.I1.i2.p1.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2406.08477v1#A2" title="Appendix B Details of memorization score (MS) and diversity score (DS) ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">Appendix B</span></a>: Details of memorization score (MS) and diversity score (DS).</p>
</div>
</li>
<li class="ltx_item" id="A0.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A0.I1.i3.p1">
<p class="ltx_p" id="A0.I1.i3.p1.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2406.08477v1#A3" title="Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">Appendix C</span></a>: Experimental setups and implementation details of META ID.</p>
</div>
</li>
<li class="ltx_item" id="A0.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A0.I1.i4.p1">
<p class="ltx_p" id="A0.I1.i4.p1.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2406.08477v1#A4" title="Appendix D Additional Experimental Results ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">Appendix D</span></a>: Additional experimental result analysis.</p>
</div>
</li>
<li class="ltx_item" id="A0.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A0.I1.i5.p1">
<p class="ltx_p" id="A0.I1.i5.p1.1"><a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2406.08477v1#A5" title="Appendix E Discussions ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">Appendix E</span></a>: Discussions and limitations of META ID.</p>
</div>
</li>
</ul>
</div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Details of META ID</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In the Section <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4" title="4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4</span></a> of the main text, we elucidate the comprehensive workflow for generating META ID. This process encompasses three main steps, including (1) the extraction of meta-path-based embedding, (2) the generation of OOV tokens, and (3) the incorporation of META ID with LLMs, thereby handling with various downstream recommendation tasks.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>How to extract the meta-path-based embedding</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">This section supplements the details of subsection <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.SS1" title="4.1 Meta-path-based Embedding ‣ 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4.1</span></a>, <span class="ltx_text ltx_font_italic" id="A1.SS1.p1.1.1">i.e.</span>, the users / items representations extracted from a skip-gram model, including the sampling process of meta-paths as training data.</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.2">In META ID, we enable a skip-gram model to learn effective users / items representations from the sampled meta-paths, which is learning user representations <math alttext="\mathbf{W}_{U}" class="ltx_Math" display="inline" id="A1.SS1.p2.1.m1.1"><semantics id="A1.SS1.p2.1.m1.1a"><msub id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml"><mi id="A1.SS1.p2.1.m1.1.1.2" xref="A1.SS1.p2.1.m1.1.1.2.cmml">𝐖</mi><mi id="A1.SS1.p2.1.m1.1.1.3" xref="A1.SS1.p2.1.m1.1.1.3.cmml">U</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><apply id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p2.1.m1.1.1.2.cmml" xref="A1.SS1.p2.1.m1.1.1.2">𝐖</ci><ci id="A1.SS1.p2.1.m1.1.1.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">\mathbf{W}_{U}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.1d">bold_W start_POSTSUBSCRIPT italic_U end_POSTSUBSCRIPT</annotation></semantics></math> and item representations <math alttext="\mathbf{W}_{I}" class="ltx_Math" display="inline" id="A1.SS1.p2.2.m2.1"><semantics id="A1.SS1.p2.2.m2.1a"><msub id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml"><mi id="A1.SS1.p2.2.m2.1.1.2" xref="A1.SS1.p2.2.m2.1.1.2.cmml">𝐖</mi><mi id="A1.SS1.p2.2.m2.1.1.3" xref="A1.SS1.p2.2.m2.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><apply id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.2.m2.1.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p2.2.m2.1.1.2.cmml" xref="A1.SS1.p2.2.m2.1.1.2">𝐖</ci><ci id="A1.SS1.p2.2.m2.1.1.3.cmml" xref="A1.SS1.p2.2.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">\mathbf{W}_{I}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.2.m2.1d">bold_W start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>. The objective of the skip-gram model learning paradigm is to map the users and items in the meta-paths seqeuences into a lower-dimensional space as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">8</span></a>]</cite></p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.5"><span class="ltx_text ltx_font_bold" id="A1.SS1.p3.5.1">Meta-paths sampling</span>. Firstly, we constructs a node sequence based on random walks of meta-paths. A meta-path <math alttext="p=P_{1}\xrightarrow{R_{1}}P_{2}\xrightarrow{R_{2}}...\xrightarrow{R_{k-1}}P_{k}" class="ltx_Math" display="inline" id="A1.SS1.p3.1.m1.1"><semantics id="A1.SS1.p3.1.m1.1a"><mrow id="A1.SS1.p3.1.m1.1.1" xref="A1.SS1.p3.1.m1.1.1.cmml"><mi id="A1.SS1.p3.1.m1.1.1.2" xref="A1.SS1.p3.1.m1.1.1.2.cmml">p</mi><mo id="A1.SS1.p3.1.m1.1.1.3" xref="A1.SS1.p3.1.m1.1.1.3.cmml">=</mo><msub id="A1.SS1.p3.1.m1.1.1.4" xref="A1.SS1.p3.1.m1.1.1.4.cmml"><mi id="A1.SS1.p3.1.m1.1.1.4.2" xref="A1.SS1.p3.1.m1.1.1.4.2.cmml">P</mi><mn id="A1.SS1.p3.1.m1.1.1.4.3" xref="A1.SS1.p3.1.m1.1.1.4.3.cmml">1</mn></msub><mover accent="true" id="A1.SS1.p3.1.m1.1.1.5" xref="A1.SS1.p3.1.m1.1.1.5.cmml"><mo id="A1.SS1.p3.1.m1.1.1.5.2" stretchy="false" xref="A1.SS1.p3.1.m1.1.1.5.2.cmml">→</mo><msub id="A1.SS1.p3.1.m1.1.1.5.1" xref="A1.SS1.p3.1.m1.1.1.5.1.cmml"><mi id="A1.SS1.p3.1.m1.1.1.5.1.2" xref="A1.SS1.p3.1.m1.1.1.5.1.2.cmml">R</mi><mn id="A1.SS1.p3.1.m1.1.1.5.1.3" xref="A1.SS1.p3.1.m1.1.1.5.1.3.cmml">1</mn></msub></mover><msub id="A1.SS1.p3.1.m1.1.1.6" xref="A1.SS1.p3.1.m1.1.1.6.cmml"><mi id="A1.SS1.p3.1.m1.1.1.6.2" xref="A1.SS1.p3.1.m1.1.1.6.2.cmml">P</mi><mn id="A1.SS1.p3.1.m1.1.1.6.3" xref="A1.SS1.p3.1.m1.1.1.6.3.cmml">2</mn></msub><mover accent="true" id="A1.SS1.p3.1.m1.1.1.7" xref="A1.SS1.p3.1.m1.1.1.7.cmml"><mo id="A1.SS1.p3.1.m1.1.1.7.2" stretchy="false" xref="A1.SS1.p3.1.m1.1.1.7.2.cmml">→</mo><msub id="A1.SS1.p3.1.m1.1.1.7.1" xref="A1.SS1.p3.1.m1.1.1.7.1.cmml"><mi id="A1.SS1.p3.1.m1.1.1.7.1.2" xref="A1.SS1.p3.1.m1.1.1.7.1.2.cmml">R</mi><mn id="A1.SS1.p3.1.m1.1.1.7.1.3" xref="A1.SS1.p3.1.m1.1.1.7.1.3.cmml">2</mn></msub></mover><mi id="A1.SS1.p3.1.m1.1.1.8" mathvariant="normal" xref="A1.SS1.p3.1.m1.1.1.8.cmml">…</mi><mover accent="true" id="A1.SS1.p3.1.m1.1.1.9" xref="A1.SS1.p3.1.m1.1.1.9.cmml"><mo id="A1.SS1.p3.1.m1.1.1.9.2" stretchy="false" xref="A1.SS1.p3.1.m1.1.1.9.2.cmml">→</mo><msub id="A1.SS1.p3.1.m1.1.1.9.1" xref="A1.SS1.p3.1.m1.1.1.9.1.cmml"><mi id="A1.SS1.p3.1.m1.1.1.9.1.2" xref="A1.SS1.p3.1.m1.1.1.9.1.2.cmml">R</mi><mrow id="A1.SS1.p3.1.m1.1.1.9.1.3" xref="A1.SS1.p3.1.m1.1.1.9.1.3.cmml"><mi id="A1.SS1.p3.1.m1.1.1.9.1.3.2" xref="A1.SS1.p3.1.m1.1.1.9.1.3.2.cmml">k</mi><mo id="A1.SS1.p3.1.m1.1.1.9.1.3.1" xref="A1.SS1.p3.1.m1.1.1.9.1.3.1.cmml">−</mo><mn id="A1.SS1.p3.1.m1.1.1.9.1.3.3" xref="A1.SS1.p3.1.m1.1.1.9.1.3.3.cmml">1</mn></mrow></msub></mover><msub id="A1.SS1.p3.1.m1.1.1.10" xref="A1.SS1.p3.1.m1.1.1.10.cmml"><mi id="A1.SS1.p3.1.m1.1.1.10.2" xref="A1.SS1.p3.1.m1.1.1.10.2.cmml">P</mi><mi id="A1.SS1.p3.1.m1.1.1.10.3" xref="A1.SS1.p3.1.m1.1.1.10.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.1.m1.1b"><apply id="A1.SS1.p3.1.m1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1"><and id="A1.SS1.p3.1.m1.1.1a.cmml" xref="A1.SS1.p3.1.m1.1.1"></and><apply id="A1.SS1.p3.1.m1.1.1b.cmml" xref="A1.SS1.p3.1.m1.1.1"><eq id="A1.SS1.p3.1.m1.1.1.3.cmml" xref="A1.SS1.p3.1.m1.1.1.3"></eq><ci id="A1.SS1.p3.1.m1.1.1.2.cmml" xref="A1.SS1.p3.1.m1.1.1.2">𝑝</ci><apply id="A1.SS1.p3.1.m1.1.1.4.cmml" xref="A1.SS1.p3.1.m1.1.1.4"><csymbol cd="ambiguous" id="A1.SS1.p3.1.m1.1.1.4.1.cmml" xref="A1.SS1.p3.1.m1.1.1.4">subscript</csymbol><ci id="A1.SS1.p3.1.m1.1.1.4.2.cmml" xref="A1.SS1.p3.1.m1.1.1.4.2">𝑃</ci><cn id="A1.SS1.p3.1.m1.1.1.4.3.cmml" type="integer" xref="A1.SS1.p3.1.m1.1.1.4.3">1</cn></apply></apply><apply id="A1.SS1.p3.1.m1.1.1c.cmml" xref="A1.SS1.p3.1.m1.1.1"><apply id="A1.SS1.p3.1.m1.1.1.5.cmml" xref="A1.SS1.p3.1.m1.1.1.5"><apply id="A1.SS1.p3.1.m1.1.1.5.1.cmml" xref="A1.SS1.p3.1.m1.1.1.5.1"><csymbol cd="ambiguous" id="A1.SS1.p3.1.m1.1.1.5.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1.5.1">subscript</csymbol><ci id="A1.SS1.p3.1.m1.1.1.5.1.2.cmml" xref="A1.SS1.p3.1.m1.1.1.5.1.2">𝑅</ci><cn id="A1.SS1.p3.1.m1.1.1.5.1.3.cmml" type="integer" xref="A1.SS1.p3.1.m1.1.1.5.1.3">1</cn></apply><ci id="A1.SS1.p3.1.m1.1.1.5.2.cmml" xref="A1.SS1.p3.1.m1.1.1.5.2">→</ci></apply><share href="https://arxiv.org/html/2406.08477v1#A1.SS1.p3.1.m1.1.1.4.cmml" id="A1.SS1.p3.1.m1.1.1d.cmml" xref="A1.SS1.p3.1.m1.1.1"></share><apply id="A1.SS1.p3.1.m1.1.1.6.cmml" xref="A1.SS1.p3.1.m1.1.1.6"><csymbol cd="ambiguous" id="A1.SS1.p3.1.m1.1.1.6.1.cmml" xref="A1.SS1.p3.1.m1.1.1.6">subscript</csymbol><ci id="A1.SS1.p3.1.m1.1.1.6.2.cmml" xref="A1.SS1.p3.1.m1.1.1.6.2">𝑃</ci><cn id="A1.SS1.p3.1.m1.1.1.6.3.cmml" type="integer" xref="A1.SS1.p3.1.m1.1.1.6.3">2</cn></apply></apply><apply id="A1.SS1.p3.1.m1.1.1e.cmml" xref="A1.SS1.p3.1.m1.1.1"><apply id="A1.SS1.p3.1.m1.1.1.7.cmml" xref="A1.SS1.p3.1.m1.1.1.7"><apply id="A1.SS1.p3.1.m1.1.1.7.1.cmml" xref="A1.SS1.p3.1.m1.1.1.7.1"><csymbol cd="ambiguous" id="A1.SS1.p3.1.m1.1.1.7.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1.7.1">subscript</csymbol><ci id="A1.SS1.p3.1.m1.1.1.7.1.2.cmml" xref="A1.SS1.p3.1.m1.1.1.7.1.2">𝑅</ci><cn id="A1.SS1.p3.1.m1.1.1.7.1.3.cmml" type="integer" xref="A1.SS1.p3.1.m1.1.1.7.1.3">2</cn></apply><ci id="A1.SS1.p3.1.m1.1.1.7.2.cmml" xref="A1.SS1.p3.1.m1.1.1.7.2">→</ci></apply><share href="https://arxiv.org/html/2406.08477v1#A1.SS1.p3.1.m1.1.1.6.cmml" id="A1.SS1.p3.1.m1.1.1f.cmml" xref="A1.SS1.p3.1.m1.1.1"></share><ci id="A1.SS1.p3.1.m1.1.1.8.cmml" xref="A1.SS1.p3.1.m1.1.1.8">…</ci></apply><apply id="A1.SS1.p3.1.m1.1.1g.cmml" xref="A1.SS1.p3.1.m1.1.1"><apply id="A1.SS1.p3.1.m1.1.1.9.cmml" xref="A1.SS1.p3.1.m1.1.1.9"><apply id="A1.SS1.p3.1.m1.1.1.9.1.cmml" xref="A1.SS1.p3.1.m1.1.1.9.1"><csymbol cd="ambiguous" id="A1.SS1.p3.1.m1.1.1.9.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1.9.1">subscript</csymbol><ci id="A1.SS1.p3.1.m1.1.1.9.1.2.cmml" xref="A1.SS1.p3.1.m1.1.1.9.1.2">𝑅</ci><apply id="A1.SS1.p3.1.m1.1.1.9.1.3.cmml" xref="A1.SS1.p3.1.m1.1.1.9.1.3"><minus id="A1.SS1.p3.1.m1.1.1.9.1.3.1.cmml" xref="A1.SS1.p3.1.m1.1.1.9.1.3.1"></minus><ci id="A1.SS1.p3.1.m1.1.1.9.1.3.2.cmml" xref="A1.SS1.p3.1.m1.1.1.9.1.3.2">𝑘</ci><cn id="A1.SS1.p3.1.m1.1.1.9.1.3.3.cmml" type="integer" xref="A1.SS1.p3.1.m1.1.1.9.1.3.3">1</cn></apply></apply><ci id="A1.SS1.p3.1.m1.1.1.9.2.cmml" xref="A1.SS1.p3.1.m1.1.1.9.2">→</ci></apply><share href="https://arxiv.org/html/2406.08477v1#A1.SS1.p3.1.m1.1.1.8.cmml" id="A1.SS1.p3.1.m1.1.1h.cmml" xref="A1.SS1.p3.1.m1.1.1"></share><apply id="A1.SS1.p3.1.m1.1.1.10.cmml" xref="A1.SS1.p3.1.m1.1.1.10"><csymbol cd="ambiguous" id="A1.SS1.p3.1.m1.1.1.10.1.cmml" xref="A1.SS1.p3.1.m1.1.1.10">subscript</csymbol><ci id="A1.SS1.p3.1.m1.1.1.10.2.cmml" xref="A1.SS1.p3.1.m1.1.1.10.2">𝑃</ci><ci id="A1.SS1.p3.1.m1.1.1.10.3.cmml" xref="A1.SS1.p3.1.m1.1.1.10.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.1.m1.1c">p=P_{1}\xrightarrow{R_{1}}P_{2}\xrightarrow{R_{2}}...\xrightarrow{R_{k-1}}P_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.1.m1.1d">italic_p = italic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_ARROW start_OVERACCENT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_OVERACCENT → end_ARROW italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_ARROW start_OVERACCENT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_OVERACCENT → end_ARROW … start_ARROW start_OVERACCENT italic_R start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT end_OVERACCENT → end_ARROW italic_P start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a path that is defined on a graph, where <math alttext="R_{i}" class="ltx_Math" display="inline" id="A1.SS1.p3.2.m2.1"><semantics id="A1.SS1.p3.2.m2.1a"><msub id="A1.SS1.p3.2.m2.1.1" xref="A1.SS1.p3.2.m2.1.1.cmml"><mi id="A1.SS1.p3.2.m2.1.1.2" xref="A1.SS1.p3.2.m2.1.1.2.cmml">R</mi><mi id="A1.SS1.p3.2.m2.1.1.3" xref="A1.SS1.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.2.m2.1b"><apply id="A1.SS1.p3.2.m2.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p3.2.m2.1.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p3.2.m2.1.1.2.cmml" xref="A1.SS1.p3.2.m2.1.1.2">𝑅</ci><ci id="A1.SS1.p3.2.m2.1.1.3.cmml" xref="A1.SS1.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.2.m2.1c">R_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.2.m2.1d">italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> signifies a composite relation between different node <math alttext="P" class="ltx_Math" display="inline" id="A1.SS1.p3.3.m3.1"><semantics id="A1.SS1.p3.3.m3.1a"><mi id="A1.SS1.p3.3.m3.1.1" xref="A1.SS1.p3.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.3.m3.1b"><ci id="A1.SS1.p3.3.m3.1.1.cmml" xref="A1.SS1.p3.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.3.m3.1c">P</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.3.m3.1d">italic_P</annotation></semantics></math>. We define user-item-user (<span class="ltx_text ltx_font_italic" id="A1.SS1.p3.5.2">U-I-U</span>) as our meta-path, where paths only exist if users has given the same ratings <math alttext="R_{i}" class="ltx_Math" display="inline" id="A1.SS1.p3.4.m4.1"><semantics id="A1.SS1.p3.4.m4.1a"><msub id="A1.SS1.p3.4.m4.1.1" xref="A1.SS1.p3.4.m4.1.1.cmml"><mi id="A1.SS1.p3.4.m4.1.1.2" xref="A1.SS1.p3.4.m4.1.1.2.cmml">R</mi><mi id="A1.SS1.p3.4.m4.1.1.3" xref="A1.SS1.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.4.m4.1b"><apply id="A1.SS1.p3.4.m4.1.1.cmml" xref="A1.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p3.4.m4.1.1.1.cmml" xref="A1.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="A1.SS1.p3.4.m4.1.1.2.cmml" xref="A1.SS1.p3.4.m4.1.1.2">𝑅</ci><ci id="A1.SS1.p3.4.m4.1.1.3.cmml" xref="A1.SS1.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.4.m4.1c">R_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.4.m4.1d">italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to one item. We sample 32 rounds starting from each user and item with the sampled length <math alttext="k=64" class="ltx_Math" display="inline" id="A1.SS1.p3.5.m5.1"><semantics id="A1.SS1.p3.5.m5.1a"><mrow id="A1.SS1.p3.5.m5.1.1" xref="A1.SS1.p3.5.m5.1.1.cmml"><mi id="A1.SS1.p3.5.m5.1.1.2" xref="A1.SS1.p3.5.m5.1.1.2.cmml">k</mi><mo id="A1.SS1.p3.5.m5.1.1.1" xref="A1.SS1.p3.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS1.p3.5.m5.1.1.3" xref="A1.SS1.p3.5.m5.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.5.m5.1b"><apply id="A1.SS1.p3.5.m5.1.1.cmml" xref="A1.SS1.p3.5.m5.1.1"><eq id="A1.SS1.p3.5.m5.1.1.1.cmml" xref="A1.SS1.p3.5.m5.1.1.1"></eq><ci id="A1.SS1.p3.5.m5.1.1.2.cmml" xref="A1.SS1.p3.5.m5.1.1.2">𝑘</ci><cn id="A1.SS1.p3.5.m5.1.1.3.cmml" type="integer" xref="A1.SS1.p3.5.m5.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.5.m5.1c">k=64</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p3.5.m5.1d">italic_k = 64</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.4"><span class="ltx_text ltx_font_bold" id="A1.SS1.p4.4.1">Skip-gram model training</span>. In the second step, through sampling meta-paths based on random walks as training corpus, we train a skip-gram model thus learn the vector representations <math alttext="(\mathbf{W}_{U},\mathbf{W}_{I})" class="ltx_Math" display="inline" id="A1.SS1.p4.1.m1.2"><semantics id="A1.SS1.p4.1.m1.2a"><mrow id="A1.SS1.p4.1.m1.2.2.2" xref="A1.SS1.p4.1.m1.2.2.3.cmml"><mo id="A1.SS1.p4.1.m1.2.2.2.3" stretchy="false" xref="A1.SS1.p4.1.m1.2.2.3.cmml">(</mo><msub id="A1.SS1.p4.1.m1.1.1.1.1" xref="A1.SS1.p4.1.m1.1.1.1.1.cmml"><mi id="A1.SS1.p4.1.m1.1.1.1.1.2" xref="A1.SS1.p4.1.m1.1.1.1.1.2.cmml">𝐖</mi><mi id="A1.SS1.p4.1.m1.1.1.1.1.3" xref="A1.SS1.p4.1.m1.1.1.1.1.3.cmml">U</mi></msub><mo id="A1.SS1.p4.1.m1.2.2.2.4" xref="A1.SS1.p4.1.m1.2.2.3.cmml">,</mo><msub id="A1.SS1.p4.1.m1.2.2.2.2" xref="A1.SS1.p4.1.m1.2.2.2.2.cmml"><mi id="A1.SS1.p4.1.m1.2.2.2.2.2" xref="A1.SS1.p4.1.m1.2.2.2.2.2.cmml">𝐖</mi><mi id="A1.SS1.p4.1.m1.2.2.2.2.3" xref="A1.SS1.p4.1.m1.2.2.2.2.3.cmml">I</mi></msub><mo id="A1.SS1.p4.1.m1.2.2.2.5" stretchy="false" xref="A1.SS1.p4.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.1.m1.2b"><interval closure="open" id="A1.SS1.p4.1.m1.2.2.3.cmml" xref="A1.SS1.p4.1.m1.2.2.2"><apply id="A1.SS1.p4.1.m1.1.1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p4.1.m1.1.1.1.1.2.cmml" xref="A1.SS1.p4.1.m1.1.1.1.1.2">𝐖</ci><ci id="A1.SS1.p4.1.m1.1.1.1.1.3.cmml" xref="A1.SS1.p4.1.m1.1.1.1.1.3">𝑈</ci></apply><apply id="A1.SS1.p4.1.m1.2.2.2.2.cmml" xref="A1.SS1.p4.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p4.1.m1.2.2.2.2.1.cmml" xref="A1.SS1.p4.1.m1.2.2.2.2">subscript</csymbol><ci id="A1.SS1.p4.1.m1.2.2.2.2.2.cmml" xref="A1.SS1.p4.1.m1.2.2.2.2.2">𝐖</ci><ci id="A1.SS1.p4.1.m1.2.2.2.2.3.cmml" xref="A1.SS1.p4.1.m1.2.2.2.2.3">𝐼</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.1.m1.2c">(\mathbf{W}_{U},\mathbf{W}_{I})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.1.m1.2d">( bold_W start_POSTSUBSCRIPT italic_U end_POSTSUBSCRIPT , bold_W start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT )</annotation></semantics></math> for all users and items. The objective of the skip-gram model is to maximize the conditional probability <math alttext="P(n_{i}|v)" class="ltx_Math" display="inline" id="A1.SS1.p4.2.m2.1"><semantics id="A1.SS1.p4.2.m2.1a"><mrow id="A1.SS1.p4.2.m2.1.1" xref="A1.SS1.p4.2.m2.1.1.cmml"><mi id="A1.SS1.p4.2.m2.1.1.3" xref="A1.SS1.p4.2.m2.1.1.3.cmml">P</mi><mo id="A1.SS1.p4.2.m2.1.1.2" xref="A1.SS1.p4.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p4.2.m2.1.1.1.1" xref="A1.SS1.p4.2.m2.1.1.1.1.1.cmml"><mo id="A1.SS1.p4.2.m2.1.1.1.1.2" stretchy="false" xref="A1.SS1.p4.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p4.2.m2.1.1.1.1.1" xref="A1.SS1.p4.2.m2.1.1.1.1.1.cmml"><msub id="A1.SS1.p4.2.m2.1.1.1.1.1.2" xref="A1.SS1.p4.2.m2.1.1.1.1.1.2.cmml"><mi id="A1.SS1.p4.2.m2.1.1.1.1.1.2.2" xref="A1.SS1.p4.2.m2.1.1.1.1.1.2.2.cmml">n</mi><mi id="A1.SS1.p4.2.m2.1.1.1.1.1.2.3" xref="A1.SS1.p4.2.m2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="A1.SS1.p4.2.m2.1.1.1.1.1.1" xref="A1.SS1.p4.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS1.p4.2.m2.1.1.1.1.1.3" xref="A1.SS1.p4.2.m2.1.1.1.1.1.3.cmml">v</mi></mrow><mo id="A1.SS1.p4.2.m2.1.1.1.1.3" stretchy="false" xref="A1.SS1.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.2.m2.1b"><apply id="A1.SS1.p4.2.m2.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1"><times id="A1.SS1.p4.2.m2.1.1.2.cmml" xref="A1.SS1.p4.2.m2.1.1.2"></times><ci id="A1.SS1.p4.2.m2.1.1.3.cmml" xref="A1.SS1.p4.2.m2.1.1.3">𝑃</ci><apply id="A1.SS1.p4.2.m2.1.1.1.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.p4.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="A1.SS1.p4.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS1.p4.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p4.2.m2.1.1.1.1.1.2.1.cmml" xref="A1.SS1.p4.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS1.p4.2.m2.1.1.1.1.1.2.2.cmml" xref="A1.SS1.p4.2.m2.1.1.1.1.1.2.2">𝑛</ci><ci id="A1.SS1.p4.2.m2.1.1.1.1.1.2.3.cmml" xref="A1.SS1.p4.2.m2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.p4.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS1.p4.2.m2.1.1.1.1.1.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.2.m2.1c">P(n_{i}|v)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.2.m2.1d">italic_P ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_v )</annotation></semantics></math> for the node <math alttext="v\in V" class="ltx_Math" display="inline" id="A1.SS1.p4.3.m3.1"><semantics id="A1.SS1.p4.3.m3.1a"><mrow id="A1.SS1.p4.3.m3.1.1" xref="A1.SS1.p4.3.m3.1.1.cmml"><mi id="A1.SS1.p4.3.m3.1.1.2" xref="A1.SS1.p4.3.m3.1.1.2.cmml">v</mi><mo id="A1.SS1.p4.3.m3.1.1.1" xref="A1.SS1.p4.3.m3.1.1.1.cmml">∈</mo><mi id="A1.SS1.p4.3.m3.1.1.3" xref="A1.SS1.p4.3.m3.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.3.m3.1b"><apply id="A1.SS1.p4.3.m3.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1"><in id="A1.SS1.p4.3.m3.1.1.1.cmml" xref="A1.SS1.p4.3.m3.1.1.1"></in><ci id="A1.SS1.p4.3.m3.1.1.2.cmml" xref="A1.SS1.p4.3.m3.1.1.2">𝑣</ci><ci id="A1.SS1.p4.3.m3.1.1.3.cmml" xref="A1.SS1.p4.3.m3.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.3.m3.1c">v\in V</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.3.m3.1d">italic_v ∈ italic_V</annotation></semantics></math> of its neighboring node <math alttext="n_{i}\in N_{v}" class="ltx_Math" display="inline" id="A1.SS1.p4.4.m4.1"><semantics id="A1.SS1.p4.4.m4.1a"><mrow id="A1.SS1.p4.4.m4.1.1" xref="A1.SS1.p4.4.m4.1.1.cmml"><msub id="A1.SS1.p4.4.m4.1.1.2" xref="A1.SS1.p4.4.m4.1.1.2.cmml"><mi id="A1.SS1.p4.4.m4.1.1.2.2" xref="A1.SS1.p4.4.m4.1.1.2.2.cmml">n</mi><mi id="A1.SS1.p4.4.m4.1.1.2.3" xref="A1.SS1.p4.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="A1.SS1.p4.4.m4.1.1.1" xref="A1.SS1.p4.4.m4.1.1.1.cmml">∈</mo><msub id="A1.SS1.p4.4.m4.1.1.3" xref="A1.SS1.p4.4.m4.1.1.3.cmml"><mi id="A1.SS1.p4.4.m4.1.1.3.2" xref="A1.SS1.p4.4.m4.1.1.3.2.cmml">N</mi><mi id="A1.SS1.p4.4.m4.1.1.3.3" xref="A1.SS1.p4.4.m4.1.1.3.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.4.m4.1b"><apply id="A1.SS1.p4.4.m4.1.1.cmml" xref="A1.SS1.p4.4.m4.1.1"><in id="A1.SS1.p4.4.m4.1.1.1.cmml" xref="A1.SS1.p4.4.m4.1.1.1"></in><apply id="A1.SS1.p4.4.m4.1.1.2.cmml" xref="A1.SS1.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p4.4.m4.1.1.2.1.cmml" xref="A1.SS1.p4.4.m4.1.1.2">subscript</csymbol><ci id="A1.SS1.p4.4.m4.1.1.2.2.cmml" xref="A1.SS1.p4.4.m4.1.1.2.2">𝑛</ci><ci id="A1.SS1.p4.4.m4.1.1.2.3.cmml" xref="A1.SS1.p4.4.m4.1.1.2.3">𝑖</ci></apply><apply id="A1.SS1.p4.4.m4.1.1.3.cmml" xref="A1.SS1.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.4.m4.1.1.3.1.cmml" xref="A1.SS1.p4.4.m4.1.1.3">subscript</csymbol><ci id="A1.SS1.p4.4.m4.1.1.3.2.cmml" xref="A1.SS1.p4.4.m4.1.1.3.2">𝑁</ci><ci id="A1.SS1.p4.4.m4.1.1.3.3.cmml" xref="A1.SS1.p4.4.m4.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.4.m4.1c">n_{i}\in N_{v}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.4.m4.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_N start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\arg\max_{\theta}\sum_{v\in V}\sum_{t\in{U,I}}\sum_{n_{i}\in N_{v}}\log P%
(n_{i}|v)" class="ltx_Math" display="block" id="A1.E9.m1.3"><semantics id="A1.E9.m1.3a"><mrow id="A1.E9.m1.3.3" xref="A1.E9.m1.3.3.cmml"><mrow id="A1.E9.m1.3.3.3" xref="A1.E9.m1.3.3.3.cmml"><mi id="A1.E9.m1.3.3.3.1" mathsize="90%" xref="A1.E9.m1.3.3.3.1.cmml">arg</mi><mo id="A1.E9.m1.3.3.3a" lspace="0.167em" xref="A1.E9.m1.3.3.3.cmml">⁡</mo><munder id="A1.E9.m1.3.3.3.2" xref="A1.E9.m1.3.3.3.2.cmml"><mi id="A1.E9.m1.3.3.3.2.2" mathsize="90%" xref="A1.E9.m1.3.3.3.2.2.cmml">max</mi><mi id="A1.E9.m1.3.3.3.2.3" mathsize="90%" xref="A1.E9.m1.3.3.3.2.3.cmml">θ</mi></munder></mrow><mo id="A1.E9.m1.3.3.2" xref="A1.E9.m1.3.3.2.cmml">⁢</mo><mrow id="A1.E9.m1.3.3.1" xref="A1.E9.m1.3.3.1.cmml"><munder id="A1.E9.m1.3.3.1.2" xref="A1.E9.m1.3.3.1.2.cmml"><mo id="A1.E9.m1.3.3.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" xref="A1.E9.m1.3.3.1.2.2.cmml">∑</mo><mrow id="A1.E9.m1.3.3.1.2.3" xref="A1.E9.m1.3.3.1.2.3.cmml"><mi id="A1.E9.m1.3.3.1.2.3.2" mathsize="90%" xref="A1.E9.m1.3.3.1.2.3.2.cmml">v</mi><mo id="A1.E9.m1.3.3.1.2.3.1" mathsize="90%" xref="A1.E9.m1.3.3.1.2.3.1.cmml">∈</mo><mi id="A1.E9.m1.3.3.1.2.3.3" mathsize="90%" xref="A1.E9.m1.3.3.1.2.3.3.cmml">V</mi></mrow></munder><mrow id="A1.E9.m1.3.3.1.1" xref="A1.E9.m1.3.3.1.1.cmml"><munder id="A1.E9.m1.3.3.1.1.2" xref="A1.E9.m1.3.3.1.1.2.cmml"><mo id="A1.E9.m1.3.3.1.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" xref="A1.E9.m1.3.3.1.1.2.2.cmml">∑</mo><mrow id="A1.E9.m1.2.2.2" xref="A1.E9.m1.2.2.2.cmml"><mi id="A1.E9.m1.2.2.2.4" mathsize="90%" xref="A1.E9.m1.2.2.2.4.cmml">t</mi><mo id="A1.E9.m1.2.2.2.3" mathsize="90%" xref="A1.E9.m1.2.2.2.3.cmml">∈</mo><mrow id="A1.E9.m1.2.2.2.5.2" xref="A1.E9.m1.2.2.2.5.1.cmml"><mi id="A1.E9.m1.1.1.1.1" mathsize="90%" xref="A1.E9.m1.1.1.1.1.cmml">U</mi><mo id="A1.E9.m1.2.2.2.5.2.1" mathsize="90%" xref="A1.E9.m1.2.2.2.5.1.cmml">,</mo><mi id="A1.E9.m1.2.2.2.2" mathsize="90%" xref="A1.E9.m1.2.2.2.2.cmml">I</mi></mrow></mrow></munder><mrow id="A1.E9.m1.3.3.1.1.1" xref="A1.E9.m1.3.3.1.1.1.cmml"><munder id="A1.E9.m1.3.3.1.1.1.2" xref="A1.E9.m1.3.3.1.1.1.2.cmml"><mo id="A1.E9.m1.3.3.1.1.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="A1.E9.m1.3.3.1.1.1.2.2.cmml">∑</mo><mrow id="A1.E9.m1.3.3.1.1.1.2.3" xref="A1.E9.m1.3.3.1.1.1.2.3.cmml"><msub id="A1.E9.m1.3.3.1.1.1.2.3.2" xref="A1.E9.m1.3.3.1.1.1.2.3.2.cmml"><mi id="A1.E9.m1.3.3.1.1.1.2.3.2.2" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.2.3.2.2.cmml">n</mi><mi id="A1.E9.m1.3.3.1.1.1.2.3.2.3" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.2.3.2.3.cmml">i</mi></msub><mo id="A1.E9.m1.3.3.1.1.1.2.3.1" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.2.3.1.cmml">∈</mo><msub id="A1.E9.m1.3.3.1.1.1.2.3.3" xref="A1.E9.m1.3.3.1.1.1.2.3.3.cmml"><mi id="A1.E9.m1.3.3.1.1.1.2.3.3.2" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.2.3.3.2.cmml">N</mi><mi id="A1.E9.m1.3.3.1.1.1.2.3.3.3" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.2.3.3.3.cmml">v</mi></msub></mrow></munder><mrow id="A1.E9.m1.3.3.1.1.1.1" xref="A1.E9.m1.3.3.1.1.1.1.cmml"><mrow id="A1.E9.m1.3.3.1.1.1.1.3" xref="A1.E9.m1.3.3.1.1.1.1.3.cmml"><mi id="A1.E9.m1.3.3.1.1.1.1.3.1" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.1.3.1.cmml">log</mi><mo id="A1.E9.m1.3.3.1.1.1.1.3a" lspace="0.167em" xref="A1.E9.m1.3.3.1.1.1.1.3.cmml">⁡</mo><mi id="A1.E9.m1.3.3.1.1.1.1.3.2" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="A1.E9.m1.3.3.1.1.1.1.2" xref="A1.E9.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.3.3.1.1.1.1.1.1" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.3.3.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E9.m1.3.3.1.1.1.1.1.1.1" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="A1.E9.m1.3.3.1.1.1.1.1.1.1.2" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E9.m1.3.3.1.1.1.1.1.1.1.3" mathsize="90%" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml">v</mi></mrow><mo id="A1.E9.m1.3.3.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.3b"><apply id="A1.E9.m1.3.3.cmml" xref="A1.E9.m1.3.3"><times id="A1.E9.m1.3.3.2.cmml" xref="A1.E9.m1.3.3.2"></times><apply id="A1.E9.m1.3.3.3.cmml" xref="A1.E9.m1.3.3.3"><arg id="A1.E9.m1.3.3.3.1.cmml" xref="A1.E9.m1.3.3.3.1"></arg><apply id="A1.E9.m1.3.3.3.2.cmml" xref="A1.E9.m1.3.3.3.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.3.2.1.cmml" xref="A1.E9.m1.3.3.3.2">subscript</csymbol><max id="A1.E9.m1.3.3.3.2.2.cmml" xref="A1.E9.m1.3.3.3.2.2"></max><ci id="A1.E9.m1.3.3.3.2.3.cmml" xref="A1.E9.m1.3.3.3.2.3">𝜃</ci></apply></apply><apply id="A1.E9.m1.3.3.1.cmml" xref="A1.E9.m1.3.3.1"><apply id="A1.E9.m1.3.3.1.2.cmml" xref="A1.E9.m1.3.3.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.2.1.cmml" xref="A1.E9.m1.3.3.1.2">subscript</csymbol><sum id="A1.E9.m1.3.3.1.2.2.cmml" xref="A1.E9.m1.3.3.1.2.2"></sum><apply id="A1.E9.m1.3.3.1.2.3.cmml" xref="A1.E9.m1.3.3.1.2.3"><in id="A1.E9.m1.3.3.1.2.3.1.cmml" xref="A1.E9.m1.3.3.1.2.3.1"></in><ci id="A1.E9.m1.3.3.1.2.3.2.cmml" xref="A1.E9.m1.3.3.1.2.3.2">𝑣</ci><ci id="A1.E9.m1.3.3.1.2.3.3.cmml" xref="A1.E9.m1.3.3.1.2.3.3">𝑉</ci></apply></apply><apply id="A1.E9.m1.3.3.1.1.cmml" xref="A1.E9.m1.3.3.1.1"><apply id="A1.E9.m1.3.3.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.2.1.cmml" xref="A1.E9.m1.3.3.1.1.2">subscript</csymbol><sum id="A1.E9.m1.3.3.1.1.2.2.cmml" xref="A1.E9.m1.3.3.1.1.2.2"></sum><apply id="A1.E9.m1.2.2.2.cmml" xref="A1.E9.m1.2.2.2"><in id="A1.E9.m1.2.2.2.3.cmml" xref="A1.E9.m1.2.2.2.3"></in><ci id="A1.E9.m1.2.2.2.4.cmml" xref="A1.E9.m1.2.2.2.4">𝑡</ci><list id="A1.E9.m1.2.2.2.5.1.cmml" xref="A1.E9.m1.2.2.2.5.2"><ci id="A1.E9.m1.1.1.1.1.cmml" xref="A1.E9.m1.1.1.1.1">𝑈</ci><ci id="A1.E9.m1.2.2.2.2.cmml" xref="A1.E9.m1.2.2.2.2">𝐼</ci></list></apply></apply><apply id="A1.E9.m1.3.3.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1"><apply id="A1.E9.m1.3.3.1.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.2.1.cmml" xref="A1.E9.m1.3.3.1.1.1.2">subscript</csymbol><sum id="A1.E9.m1.3.3.1.1.1.2.2.cmml" xref="A1.E9.m1.3.3.1.1.1.2.2"></sum><apply id="A1.E9.m1.3.3.1.1.1.2.3.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3"><in id="A1.E9.m1.3.3.1.1.1.2.3.1.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.1"></in><apply id="A1.E9.m1.3.3.1.1.1.2.3.2.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.2.3.2.1.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.2">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.1.2.3.2.2.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.2.2">𝑛</ci><ci id="A1.E9.m1.3.3.1.1.1.2.3.2.3.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.2.3">𝑖</ci></apply><apply id="A1.E9.m1.3.3.1.1.1.2.3.3.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.2.3.3.1.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.3">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.1.2.3.3.2.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.3.2">𝑁</ci><ci id="A1.E9.m1.3.3.1.1.1.2.3.3.3.cmml" xref="A1.E9.m1.3.3.1.1.1.2.3.3.3">𝑣</ci></apply></apply></apply><apply id="A1.E9.m1.3.3.1.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1"><times id="A1.E9.m1.3.3.1.1.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.2"></times><apply id="A1.E9.m1.3.3.1.1.1.1.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.3"><log id="A1.E9.m1.3.3.1.1.1.1.3.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.3.1"></log><ci id="A1.E9.m1.3.3.1.1.1.1.3.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.3.2">𝑃</ci></apply><apply id="A1.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.2">𝑛</ci><ci id="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A1.E9.m1.3.3.1.1.1.1.1.1.1.3">𝑣</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.3c">\small\arg\max_{\theta}\sum_{v\in V}\sum_{t\in{U,I}}\sum_{n_{i}\in N_{v}}\log P%
(n_{i}|v)</annotation><annotation encoding="application/x-llamapun" id="A1.E9.m1.3d">roman_arg roman_max start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_v ∈ italic_V end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t ∈ italic_U , italic_I end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_N start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_P ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_v )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p4.5">and the <math alttext="P(n_{i}|v)" class="ltx_Math" display="inline" id="A1.SS1.p4.5.m1.1"><semantics id="A1.SS1.p4.5.m1.1a"><mrow id="A1.SS1.p4.5.m1.1.1" xref="A1.SS1.p4.5.m1.1.1.cmml"><mi id="A1.SS1.p4.5.m1.1.1.3" xref="A1.SS1.p4.5.m1.1.1.3.cmml">P</mi><mo id="A1.SS1.p4.5.m1.1.1.2" xref="A1.SS1.p4.5.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p4.5.m1.1.1.1.1" xref="A1.SS1.p4.5.m1.1.1.1.1.1.cmml"><mo id="A1.SS1.p4.5.m1.1.1.1.1.2" stretchy="false" xref="A1.SS1.p4.5.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p4.5.m1.1.1.1.1.1" xref="A1.SS1.p4.5.m1.1.1.1.1.1.cmml"><msub id="A1.SS1.p4.5.m1.1.1.1.1.1.2" xref="A1.SS1.p4.5.m1.1.1.1.1.1.2.cmml"><mi id="A1.SS1.p4.5.m1.1.1.1.1.1.2.2" xref="A1.SS1.p4.5.m1.1.1.1.1.1.2.2.cmml">n</mi><mi id="A1.SS1.p4.5.m1.1.1.1.1.1.2.3" xref="A1.SS1.p4.5.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="A1.SS1.p4.5.m1.1.1.1.1.1.1" xref="A1.SS1.p4.5.m1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS1.p4.5.m1.1.1.1.1.1.3" xref="A1.SS1.p4.5.m1.1.1.1.1.1.3.cmml">v</mi></mrow><mo id="A1.SS1.p4.5.m1.1.1.1.1.3" stretchy="false" xref="A1.SS1.p4.5.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.5.m1.1b"><apply id="A1.SS1.p4.5.m1.1.1.cmml" xref="A1.SS1.p4.5.m1.1.1"><times id="A1.SS1.p4.5.m1.1.1.2.cmml" xref="A1.SS1.p4.5.m1.1.1.2"></times><ci id="A1.SS1.p4.5.m1.1.1.3.cmml" xref="A1.SS1.p4.5.m1.1.1.3">𝑃</ci><apply id="A1.SS1.p4.5.m1.1.1.1.1.1.cmml" xref="A1.SS1.p4.5.m1.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.p4.5.m1.1.1.1.1.1.1.cmml" xref="A1.SS1.p4.5.m1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.SS1.p4.5.m1.1.1.1.1.1.2.cmml" xref="A1.SS1.p4.5.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p4.5.m1.1.1.1.1.1.2.1.cmml" xref="A1.SS1.p4.5.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS1.p4.5.m1.1.1.1.1.1.2.2.cmml" xref="A1.SS1.p4.5.m1.1.1.1.1.1.2.2">𝑛</ci><ci id="A1.SS1.p4.5.m1.1.1.1.1.1.2.3.cmml" xref="A1.SS1.p4.5.m1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.SS1.p4.5.m1.1.1.1.1.1.3.cmml" xref="A1.SS1.p4.5.m1.1.1.1.1.1.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.5.m1.1c">P(n_{i}|v)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.5.m1.1d">italic_P ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_v )</annotation></semantics></math> is calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small P(n_{i}|v)=\frac{\exp(w_{n_{i}}^{T}w_{v})}{\sum_{j\in V}\exp(w_{j}^{T}w%
_{v})}" class="ltx_Math" display="block" id="A1.E10.m1.5"><semantics id="A1.E10.m1.5a"><mrow id="A1.E10.m1.5.5" xref="A1.E10.m1.5.5.cmml"><mrow id="A1.E10.m1.5.5.1" xref="A1.E10.m1.5.5.1.cmml"><mi id="A1.E10.m1.5.5.1.3" mathsize="90%" xref="A1.E10.m1.5.5.1.3.cmml">P</mi><mo id="A1.E10.m1.5.5.1.2" xref="A1.E10.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.E10.m1.5.5.1.1.1" xref="A1.E10.m1.5.5.1.1.1.1.cmml"><mo id="A1.E10.m1.5.5.1.1.1.2" maxsize="90%" minsize="90%" xref="A1.E10.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="A1.E10.m1.5.5.1.1.1.1" xref="A1.E10.m1.5.5.1.1.1.1.cmml"><msub id="A1.E10.m1.5.5.1.1.1.1.2" xref="A1.E10.m1.5.5.1.1.1.1.2.cmml"><mi id="A1.E10.m1.5.5.1.1.1.1.2.2" mathsize="90%" xref="A1.E10.m1.5.5.1.1.1.1.2.2.cmml">n</mi><mi id="A1.E10.m1.5.5.1.1.1.1.2.3" mathsize="90%" xref="A1.E10.m1.5.5.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="A1.E10.m1.5.5.1.1.1.1.1" mathsize="90%" xref="A1.E10.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="A1.E10.m1.5.5.1.1.1.1.3" mathsize="90%" xref="A1.E10.m1.5.5.1.1.1.1.3.cmml">v</mi></mrow><mo id="A1.E10.m1.5.5.1.1.1.3" maxsize="90%" minsize="90%" xref="A1.E10.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E10.m1.5.5.2" mathsize="90%" xref="A1.E10.m1.5.5.2.cmml">=</mo><mfrac id="A1.E10.m1.4.4" xref="A1.E10.m1.4.4.cmml"><mrow id="A1.E10.m1.2.2.2.2" xref="A1.E10.m1.2.2.2.3.cmml"><mi id="A1.E10.m1.1.1.1.1" mathsize="90%" xref="A1.E10.m1.1.1.1.1.cmml">exp</mi><mo id="A1.E10.m1.2.2.2.2a" xref="A1.E10.m1.2.2.2.3.cmml">⁡</mo><mrow id="A1.E10.m1.2.2.2.2.1" xref="A1.E10.m1.2.2.2.3.cmml"><mo id="A1.E10.m1.2.2.2.2.1.2" maxsize="90%" minsize="90%" xref="A1.E10.m1.2.2.2.3.cmml">(</mo><mrow id="A1.E10.m1.2.2.2.2.1.1" xref="A1.E10.m1.2.2.2.2.1.1.cmml"><msubsup id="A1.E10.m1.2.2.2.2.1.1.2" xref="A1.E10.m1.2.2.2.2.1.1.2.cmml"><mi id="A1.E10.m1.2.2.2.2.1.1.2.2.2" mathsize="90%" xref="A1.E10.m1.2.2.2.2.1.1.2.2.2.cmml">w</mi><msub id="A1.E10.m1.2.2.2.2.1.1.2.2.3" xref="A1.E10.m1.2.2.2.2.1.1.2.2.3.cmml"><mi id="A1.E10.m1.2.2.2.2.1.1.2.2.3.2" mathsize="90%" xref="A1.E10.m1.2.2.2.2.1.1.2.2.3.2.cmml">n</mi><mi id="A1.E10.m1.2.2.2.2.1.1.2.2.3.3" mathsize="90%" xref="A1.E10.m1.2.2.2.2.1.1.2.2.3.3.cmml">i</mi></msub><mi id="A1.E10.m1.2.2.2.2.1.1.2.3" mathsize="90%" xref="A1.E10.m1.2.2.2.2.1.1.2.3.cmml">T</mi></msubsup><mo id="A1.E10.m1.2.2.2.2.1.1.1" xref="A1.E10.m1.2.2.2.2.1.1.1.cmml">⁢</mo><msub id="A1.E10.m1.2.2.2.2.1.1.3" xref="A1.E10.m1.2.2.2.2.1.1.3.cmml"><mi id="A1.E10.m1.2.2.2.2.1.1.3.2" mathsize="90%" xref="A1.E10.m1.2.2.2.2.1.1.3.2.cmml">w</mi><mi id="A1.E10.m1.2.2.2.2.1.1.3.3" mathsize="90%" xref="A1.E10.m1.2.2.2.2.1.1.3.3.cmml">v</mi></msub></mrow><mo id="A1.E10.m1.2.2.2.2.1.3" maxsize="90%" minsize="90%" xref="A1.E10.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.E10.m1.4.4.4" xref="A1.E10.m1.4.4.4.cmml"><msub id="A1.E10.m1.4.4.4.3" xref="A1.E10.m1.4.4.4.3.cmml"><mo id="A1.E10.m1.4.4.4.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="A1.E10.m1.4.4.4.3.2.cmml">∑</mo><mrow id="A1.E10.m1.4.4.4.3.3" xref="A1.E10.m1.4.4.4.3.3.cmml"><mi id="A1.E10.m1.4.4.4.3.3.2" mathsize="90%" xref="A1.E10.m1.4.4.4.3.3.2.cmml">j</mi><mo id="A1.E10.m1.4.4.4.3.3.1" mathsize="90%" xref="A1.E10.m1.4.4.4.3.3.1.cmml">∈</mo><mi id="A1.E10.m1.4.4.4.3.3.3" mathsize="90%" xref="A1.E10.m1.4.4.4.3.3.3.cmml">V</mi></mrow></msub><mrow id="A1.E10.m1.4.4.4.2.1" xref="A1.E10.m1.4.4.4.2.2.cmml"><mi id="A1.E10.m1.3.3.3.1" mathsize="90%" xref="A1.E10.m1.3.3.3.1.cmml">exp</mi><mo id="A1.E10.m1.4.4.4.2.1a" xref="A1.E10.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="A1.E10.m1.4.4.4.2.1.1" xref="A1.E10.m1.4.4.4.2.2.cmml"><mo id="A1.E10.m1.4.4.4.2.1.1.2" maxsize="90%" minsize="90%" xref="A1.E10.m1.4.4.4.2.2.cmml">(</mo><mrow id="A1.E10.m1.4.4.4.2.1.1.1" xref="A1.E10.m1.4.4.4.2.1.1.1.cmml"><msubsup id="A1.E10.m1.4.4.4.2.1.1.1.2" xref="A1.E10.m1.4.4.4.2.1.1.1.2.cmml"><mi id="A1.E10.m1.4.4.4.2.1.1.1.2.2.2" mathsize="90%" xref="A1.E10.m1.4.4.4.2.1.1.1.2.2.2.cmml">w</mi><mi id="A1.E10.m1.4.4.4.2.1.1.1.2.2.3" mathsize="90%" xref="A1.E10.m1.4.4.4.2.1.1.1.2.2.3.cmml">j</mi><mi id="A1.E10.m1.4.4.4.2.1.1.1.2.3" mathsize="90%" xref="A1.E10.m1.4.4.4.2.1.1.1.2.3.cmml">T</mi></msubsup><mo id="A1.E10.m1.4.4.4.2.1.1.1.1" xref="A1.E10.m1.4.4.4.2.1.1.1.1.cmml">⁢</mo><msub id="A1.E10.m1.4.4.4.2.1.1.1.3" xref="A1.E10.m1.4.4.4.2.1.1.1.3.cmml"><mi id="A1.E10.m1.4.4.4.2.1.1.1.3.2" mathsize="90%" xref="A1.E10.m1.4.4.4.2.1.1.1.3.2.cmml">w</mi><mi id="A1.E10.m1.4.4.4.2.1.1.1.3.3" mathsize="90%" xref="A1.E10.m1.4.4.4.2.1.1.1.3.3.cmml">v</mi></msub></mrow><mo id="A1.E10.m1.4.4.4.2.1.1.3" maxsize="90%" minsize="90%" xref="A1.E10.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.5b"><apply id="A1.E10.m1.5.5.cmml" xref="A1.E10.m1.5.5"><eq id="A1.E10.m1.5.5.2.cmml" xref="A1.E10.m1.5.5.2"></eq><apply id="A1.E10.m1.5.5.1.cmml" xref="A1.E10.m1.5.5.1"><times id="A1.E10.m1.5.5.1.2.cmml" xref="A1.E10.m1.5.5.1.2"></times><ci id="A1.E10.m1.5.5.1.3.cmml" xref="A1.E10.m1.5.5.1.3">𝑃</ci><apply id="A1.E10.m1.5.5.1.1.1.1.cmml" xref="A1.E10.m1.5.5.1.1.1"><csymbol cd="latexml" id="A1.E10.m1.5.5.1.1.1.1.1.cmml" xref="A1.E10.m1.5.5.1.1.1.1.1">conditional</csymbol><apply id="A1.E10.m1.5.5.1.1.1.1.2.cmml" xref="A1.E10.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.5.5.1.1.1.1.2.1.cmml" xref="A1.E10.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="A1.E10.m1.5.5.1.1.1.1.2.2.cmml" xref="A1.E10.m1.5.5.1.1.1.1.2.2">𝑛</ci><ci id="A1.E10.m1.5.5.1.1.1.1.2.3.cmml" xref="A1.E10.m1.5.5.1.1.1.1.2.3">𝑖</ci></apply><ci id="A1.E10.m1.5.5.1.1.1.1.3.cmml" xref="A1.E10.m1.5.5.1.1.1.1.3">𝑣</ci></apply></apply><apply id="A1.E10.m1.4.4.cmml" xref="A1.E10.m1.4.4"><divide id="A1.E10.m1.4.4.5.cmml" xref="A1.E10.m1.4.4"></divide><apply id="A1.E10.m1.2.2.2.3.cmml" xref="A1.E10.m1.2.2.2.2"><exp id="A1.E10.m1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1"></exp><apply id="A1.E10.m1.2.2.2.2.1.1.cmml" xref="A1.E10.m1.2.2.2.2.1.1"><times id="A1.E10.m1.2.2.2.2.1.1.1.cmml" xref="A1.E10.m1.2.2.2.2.1.1.1"></times><apply id="A1.E10.m1.2.2.2.2.1.1.2.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.1.1.2.1.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2">superscript</csymbol><apply id="A1.E10.m1.2.2.2.2.1.1.2.2.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.1.1.2.2.1.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="A1.E10.m1.2.2.2.2.1.1.2.2.2.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2.2.2">𝑤</ci><apply id="A1.E10.m1.2.2.2.2.1.1.2.2.3.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.1.1.2.2.3.1.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2.2.3">subscript</csymbol><ci id="A1.E10.m1.2.2.2.2.1.1.2.2.3.2.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2.2.3.2">𝑛</ci><ci id="A1.E10.m1.2.2.2.2.1.1.2.2.3.3.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2.2.3.3">𝑖</ci></apply></apply><ci id="A1.E10.m1.2.2.2.2.1.1.2.3.cmml" xref="A1.E10.m1.2.2.2.2.1.1.2.3">𝑇</ci></apply><apply id="A1.E10.m1.2.2.2.2.1.1.3.cmml" xref="A1.E10.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.1.1.3.1.cmml" xref="A1.E10.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="A1.E10.m1.2.2.2.2.1.1.3.2.cmml" xref="A1.E10.m1.2.2.2.2.1.1.3.2">𝑤</ci><ci id="A1.E10.m1.2.2.2.2.1.1.3.3.cmml" xref="A1.E10.m1.2.2.2.2.1.1.3.3">𝑣</ci></apply></apply></apply><apply id="A1.E10.m1.4.4.4.cmml" xref="A1.E10.m1.4.4.4"><apply id="A1.E10.m1.4.4.4.3.cmml" xref="A1.E10.m1.4.4.4.3"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.3.1.cmml" xref="A1.E10.m1.4.4.4.3">subscript</csymbol><sum id="A1.E10.m1.4.4.4.3.2.cmml" xref="A1.E10.m1.4.4.4.3.2"></sum><apply id="A1.E10.m1.4.4.4.3.3.cmml" xref="A1.E10.m1.4.4.4.3.3"><in id="A1.E10.m1.4.4.4.3.3.1.cmml" xref="A1.E10.m1.4.4.4.3.3.1"></in><ci id="A1.E10.m1.4.4.4.3.3.2.cmml" xref="A1.E10.m1.4.4.4.3.3.2">𝑗</ci><ci id="A1.E10.m1.4.4.4.3.3.3.cmml" xref="A1.E10.m1.4.4.4.3.3.3">𝑉</ci></apply></apply><apply id="A1.E10.m1.4.4.4.2.2.cmml" xref="A1.E10.m1.4.4.4.2.1"><exp id="A1.E10.m1.3.3.3.1.cmml" xref="A1.E10.m1.3.3.3.1"></exp><apply id="A1.E10.m1.4.4.4.2.1.1.1.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1"><times id="A1.E10.m1.4.4.4.2.1.1.1.1.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.1"></times><apply id="A1.E10.m1.4.4.4.2.1.1.1.2.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.2.1.1.1.2.1.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.2">superscript</csymbol><apply id="A1.E10.m1.4.4.4.2.1.1.1.2.2.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.2.1.1.1.2.2.1.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.2">subscript</csymbol><ci id="A1.E10.m1.4.4.4.2.1.1.1.2.2.2.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.2.2.2">𝑤</ci><ci id="A1.E10.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.2.2.3">𝑗</ci></apply><ci id="A1.E10.m1.4.4.4.2.1.1.1.2.3.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.2.3">𝑇</ci></apply><apply id="A1.E10.m1.4.4.4.2.1.1.1.3.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.4.2.1.1.1.3.1.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="A1.E10.m1.4.4.4.2.1.1.1.3.2.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.3.2">𝑤</ci><ci id="A1.E10.m1.4.4.4.2.1.1.1.3.3.cmml" xref="A1.E10.m1.4.4.4.2.1.1.1.3.3">𝑣</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.5c">\small P(n_{i}|v)=\frac{\exp(w_{n_{i}}^{T}w_{v})}{\sum_{j\in V}\exp(w_{j}^{T}w%
_{v})}</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.5d">italic_P ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_v ) = divide start_ARG roman_exp ( italic_w start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ italic_V end_POSTSUBSCRIPT roman_exp ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p4.6">where <math alttext="w" class="ltx_Math" display="inline" id="A1.SS1.p4.6.m1.1"><semantics id="A1.SS1.p4.6.m1.1a"><mi id="A1.SS1.p4.6.m1.1.1" xref="A1.SS1.p4.6.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.6.m1.1b"><ci id="A1.SS1.p4.6.m1.1.1.cmml" xref="A1.SS1.p4.6.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.6.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p4.6.m1.1d">italic_w</annotation></semantics></math> means the representation of one user or item. In experiments, we set number of negative sampling to 5, and train the skip-gram model for 10 epoch with learning rate of 0.001.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>How to generate OOV tokens</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">This section complements subsection <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.SS2" title="4.2 OOV Token Generation ‣ 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4.2</span></a>, where we generate OOV tokens from users and items representations for constructing META ID. Essentially, we need to build a hierarchical classification system for IDs in order to express a wider range of items and users with as few OOV tokens as possible, so that similar items and users are under the same hierarchical branch.</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1">This hierarchical construction mechanism is very reminiscent of clustering methods, as we apply in META ID, in which we use out-of-class indexes and in-class indexes as two levels of IDs. Though more sophisticated clustering method s for multi-levels structure can be applied, in experiments, we use the simple K-Means clustering, which is more suitable for large-scale data volume due to its simple and easy to optimize nature. We also demonstrate the effectiveness of this approach in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.T4" title="Table 4 ‣ 5.4 Ablation Studies ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.12">In experiments, we cluster user and item representations together. We then create the between-cluster tokens <math alttext="\left\langle CT_{i}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><mrow id="A1.SS2.p3.1.m1.1.1.1" xref="A1.SS2.p3.1.m1.1.1.2.cmml"><mo id="A1.SS2.p3.1.m1.1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2.1.cmml">⟨</mo><mrow id="A1.SS2.p3.1.m1.1.1.1.1" xref="A1.SS2.p3.1.m1.1.1.1.1.cmml"><mi id="A1.SS2.p3.1.m1.1.1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.1.1.2.cmml">C</mi><mo id="A1.SS2.p3.1.m1.1.1.1.1.1" xref="A1.SS2.p3.1.m1.1.1.1.1.1.cmml">⁢</mo><msub id="A1.SS2.p3.1.m1.1.1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.1.1.3.cmml"><mi id="A1.SS2.p3.1.m1.1.1.1.1.3.2" xref="A1.SS2.p3.1.m1.1.1.1.1.3.2.cmml">T</mi><mi id="A1.SS2.p3.1.m1.1.1.1.1.3.3" xref="A1.SS2.p3.1.m1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.SS2.p3.1.m1.1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p3.1.m1.1.1.2.1.cmml" xref="A1.SS2.p3.1.m1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="A1.SS2.p3.1.m1.1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1.1.1"><times id="A1.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1.1.1.1"></times><ci id="A1.SS2.p3.1.m1.1.1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.1.1.2">𝐶</ci><apply id="A1.SS2.p3.1.m1.1.1.1.1.3.cmml" xref="A1.SS2.p3.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.1.m1.1.1.1.1.3.1.cmml" xref="A1.SS2.p3.1.m1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.1.m1.1.1.1.1.3.2.cmml" xref="A1.SS2.p3.1.m1.1.1.1.1.3.2">𝑇</ci><ci id="A1.SS2.p3.1.m1.1.1.1.1.3.3.cmml" xref="A1.SS2.p3.1.m1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">\left\langle CT_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">⟨ italic_C italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math> for cluster <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p3.2.m2.1"><semantics id="A1.SS2.p3.2.m2.1a"><mi id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><ci id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.1d">italic_i</annotation></semantics></math>, and sort the in-cluster users / items based on the cosine distance to the cluster centroids to get in-cluster tokens <math alttext="\left\langle y_{i}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.3.m3.1"><semantics id="A1.SS2.p3.3.m3.1a"><mrow id="A1.SS2.p3.3.m3.1.1.1" xref="A1.SS2.p3.3.m3.1.1.2.cmml"><mo id="A1.SS2.p3.3.m3.1.1.1.2" xref="A1.SS2.p3.3.m3.1.1.2.1.cmml">⟨</mo><msub id="A1.SS2.p3.3.m3.1.1.1.1" xref="A1.SS2.p3.3.m3.1.1.1.1.cmml"><mi id="A1.SS2.p3.3.m3.1.1.1.1.2" xref="A1.SS2.p3.3.m3.1.1.1.1.2.cmml">y</mi><mi id="A1.SS2.p3.3.m3.1.1.1.1.3" xref="A1.SS2.p3.3.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p3.3.m3.1.1.1.3" xref="A1.SS2.p3.3.m3.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.1b"><apply id="A1.SS2.p3.3.m3.1.1.2.cmml" xref="A1.SS2.p3.3.m3.1.1.1"><csymbol cd="latexml" id="A1.SS2.p3.3.m3.1.1.2.1.cmml" xref="A1.SS2.p3.3.m3.1.1.1.2">delimited-⟨⟩</csymbol><apply id="A1.SS2.p3.3.m3.1.1.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.1.1.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p3.3.m3.1.1.1.1.2.cmml" xref="A1.SS2.p3.3.m3.1.1.1.1.2">𝑦</ci><ci id="A1.SS2.p3.3.m3.1.1.1.1.3.cmml" xref="A1.SS2.p3.3.m3.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.1c">\left\langle y_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.3.m3.1d">⟨ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>. Finally, we add a prefix token <math alttext="\left\langle\text{{Item}}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.4.m4.1"><semantics id="A1.SS2.p3.4.m4.1a"><mrow id="A1.SS2.p3.4.m4.1.2.2" xref="A1.SS2.p3.4.m4.1.2.1.cmml"><mo id="A1.SS2.p3.4.m4.1.2.2.1" xref="A1.SS2.p3.4.m4.1.2.1.1.cmml">⟨</mo><mtext class="ltx_mathvariant_italic" id="A1.SS2.p3.4.m4.1.1" xref="A1.SS2.p3.4.m4.1.1a.cmml">Item</mtext><mo id="A1.SS2.p3.4.m4.1.2.2.2" xref="A1.SS2.p3.4.m4.1.2.1.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m4.1b"><apply id="A1.SS2.p3.4.m4.1.2.1.cmml" xref="A1.SS2.p3.4.m4.1.2.2"><csymbol cd="latexml" id="A1.SS2.p3.4.m4.1.2.1.1.cmml" xref="A1.SS2.p3.4.m4.1.2.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS2.p3.4.m4.1.1a.cmml" xref="A1.SS2.p3.4.m4.1.1"><mtext class="ltx_mathvariant_italic" id="A1.SS2.p3.4.m4.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1">Item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m4.1c">\left\langle\text{{Item}}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.4.m4.1d">⟨ Item ⟩</annotation></semantics></math> or <math alttext="\left\langle\text{{User}}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.5.m5.1"><semantics id="A1.SS2.p3.5.m5.1a"><mrow id="A1.SS2.p3.5.m5.1.2.2" xref="A1.SS2.p3.5.m5.1.2.1.cmml"><mo id="A1.SS2.p3.5.m5.1.2.2.1" xref="A1.SS2.p3.5.m5.1.2.1.1.cmml">⟨</mo><mtext class="ltx_mathvariant_italic" id="A1.SS2.p3.5.m5.1.1" xref="A1.SS2.p3.5.m5.1.1a.cmml">User</mtext><mo id="A1.SS2.p3.5.m5.1.2.2.2" xref="A1.SS2.p3.5.m5.1.2.1.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m5.1b"><apply id="A1.SS2.p3.5.m5.1.2.1.cmml" xref="A1.SS2.p3.5.m5.1.2.2"><csymbol cd="latexml" id="A1.SS2.p3.5.m5.1.2.1.1.cmml" xref="A1.SS2.p3.5.m5.1.2.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS2.p3.5.m5.1.1a.cmml" xref="A1.SS2.p3.5.m5.1.1"><mtext class="ltx_mathvariant_italic" id="A1.SS2.p3.5.m5.1.1.cmml" xref="A1.SS2.p3.5.m5.1.1">User</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m5.1c">\left\langle\text{{User}}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.5.m5.1d">⟨ User ⟩</annotation></semantics></math> to denote its type. For example, an item might be represented as "<math alttext="\left\langle\text{{Item}}\right\rangle\left\langle CT_{i}\right\rangle\left%
\langle j\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.6.m6.3"><semantics id="A1.SS2.p3.6.m6.3a"><mrow id="A1.SS2.p3.6.m6.3.3" xref="A1.SS2.p3.6.m6.3.3.cmml"><mrow id="A1.SS2.p3.6.m6.3.3.3.2" xref="A1.SS2.p3.6.m6.3.3.3.1.cmml"><mo id="A1.SS2.p3.6.m6.3.3.3.2.1" xref="A1.SS2.p3.6.m6.3.3.3.1.1.cmml">⟨</mo><mtext id="A1.SS2.p3.6.m6.1.1" xref="A1.SS2.p3.6.m6.1.1a.cmml">Item</mtext><mo id="A1.SS2.p3.6.m6.3.3.3.2.2" xref="A1.SS2.p3.6.m6.3.3.3.1.1.cmml">⟩</mo></mrow><mo id="A1.SS2.p3.6.m6.3.3.2" xref="A1.SS2.p3.6.m6.3.3.2.cmml">⁢</mo><mrow id="A1.SS2.p3.6.m6.3.3.1.1" xref="A1.SS2.p3.6.m6.3.3.1.2.cmml"><mo id="A1.SS2.p3.6.m6.3.3.1.1.2" xref="A1.SS2.p3.6.m6.3.3.1.2.1.cmml">⟨</mo><mrow id="A1.SS2.p3.6.m6.3.3.1.1.1" xref="A1.SS2.p3.6.m6.3.3.1.1.1.cmml"><mi id="A1.SS2.p3.6.m6.3.3.1.1.1.2" xref="A1.SS2.p3.6.m6.3.3.1.1.1.2.cmml">C</mi><mo id="A1.SS2.p3.6.m6.3.3.1.1.1.1" xref="A1.SS2.p3.6.m6.3.3.1.1.1.1.cmml">⁢</mo><msub id="A1.SS2.p3.6.m6.3.3.1.1.1.3" xref="A1.SS2.p3.6.m6.3.3.1.1.1.3.cmml"><mi id="A1.SS2.p3.6.m6.3.3.1.1.1.3.2" xref="A1.SS2.p3.6.m6.3.3.1.1.1.3.2.cmml">T</mi><mi id="A1.SS2.p3.6.m6.3.3.1.1.1.3.3" xref="A1.SS2.p3.6.m6.3.3.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.SS2.p3.6.m6.3.3.1.1.3" xref="A1.SS2.p3.6.m6.3.3.1.2.1.cmml">⟩</mo></mrow><mo id="A1.SS2.p3.6.m6.3.3.2a" xref="A1.SS2.p3.6.m6.3.3.2.cmml">⁢</mo><mrow id="A1.SS2.p3.6.m6.3.3.4.2" xref="A1.SS2.p3.6.m6.3.3.4.1.cmml"><mo id="A1.SS2.p3.6.m6.3.3.4.2.1" xref="A1.SS2.p3.6.m6.3.3.4.1.1.cmml">⟨</mo><mi id="A1.SS2.p3.6.m6.2.2" xref="A1.SS2.p3.6.m6.2.2.cmml">j</mi><mo id="A1.SS2.p3.6.m6.3.3.4.2.2" xref="A1.SS2.p3.6.m6.3.3.4.1.1.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.6.m6.3b"><apply id="A1.SS2.p3.6.m6.3.3.cmml" xref="A1.SS2.p3.6.m6.3.3"><times id="A1.SS2.p3.6.m6.3.3.2.cmml" xref="A1.SS2.p3.6.m6.3.3.2"></times><apply id="A1.SS2.p3.6.m6.3.3.3.1.cmml" xref="A1.SS2.p3.6.m6.3.3.3.2"><csymbol cd="latexml" id="A1.SS2.p3.6.m6.3.3.3.1.1.cmml" xref="A1.SS2.p3.6.m6.3.3.3.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS2.p3.6.m6.1.1a.cmml" xref="A1.SS2.p3.6.m6.1.1"><mtext id="A1.SS2.p3.6.m6.1.1.cmml" xref="A1.SS2.p3.6.m6.1.1">Item</mtext></ci></apply><apply id="A1.SS2.p3.6.m6.3.3.1.2.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1"><csymbol cd="latexml" id="A1.SS2.p3.6.m6.3.3.1.2.1.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1.2">delimited-⟨⟩</csymbol><apply id="A1.SS2.p3.6.m6.3.3.1.1.1.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1.1"><times id="A1.SS2.p3.6.m6.3.3.1.1.1.1.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1.1.1"></times><ci id="A1.SS2.p3.6.m6.3.3.1.1.1.2.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1.1.2">𝐶</ci><apply id="A1.SS2.p3.6.m6.3.3.1.1.1.3.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.6.m6.3.3.1.1.1.3.1.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.6.m6.3.3.1.1.1.3.2.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1.1.3.2">𝑇</ci><ci id="A1.SS2.p3.6.m6.3.3.1.1.1.3.3.cmml" xref="A1.SS2.p3.6.m6.3.3.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="A1.SS2.p3.6.m6.3.3.4.1.cmml" xref="A1.SS2.p3.6.m6.3.3.4.2"><csymbol cd="latexml" id="A1.SS2.p3.6.m6.3.3.4.1.1.cmml" xref="A1.SS2.p3.6.m6.3.3.4.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS2.p3.6.m6.2.2.cmml" xref="A1.SS2.p3.6.m6.2.2">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.6.m6.3c">\left\langle\text{{Item}}\right\rangle\left\langle CT_{i}\right\rangle\left%
\langle j\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.6.m6.3d">⟨ Item ⟩ ⟨ italic_C italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩ ⟨ italic_j ⟩</annotation></semantics></math>" labeled with three tokens ("<math alttext="\left\langle\text{{Item}}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.7.m7.1"><semantics id="A1.SS2.p3.7.m7.1a"><mrow id="A1.SS2.p3.7.m7.1.2.2" xref="A1.SS2.p3.7.m7.1.2.1.cmml"><mo id="A1.SS2.p3.7.m7.1.2.2.1" xref="A1.SS2.p3.7.m7.1.2.1.1.cmml">⟨</mo><mtext id="A1.SS2.p3.7.m7.1.1" xref="A1.SS2.p3.7.m7.1.1a.cmml">Item</mtext><mo id="A1.SS2.p3.7.m7.1.2.2.2" xref="A1.SS2.p3.7.m7.1.2.1.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.7.m7.1b"><apply id="A1.SS2.p3.7.m7.1.2.1.cmml" xref="A1.SS2.p3.7.m7.1.2.2"><csymbol cd="latexml" id="A1.SS2.p3.7.m7.1.2.1.1.cmml" xref="A1.SS2.p3.7.m7.1.2.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS2.p3.7.m7.1.1a.cmml" xref="A1.SS2.p3.7.m7.1.1"><mtext id="A1.SS2.p3.7.m7.1.1.cmml" xref="A1.SS2.p3.7.m7.1.1">Item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.7.m7.1c">\left\langle\text{{Item}}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.7.m7.1d">⟨ Item ⟩</annotation></semantics></math>", "<math alttext="\left\langle CT_{i}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.8.m8.1"><semantics id="A1.SS2.p3.8.m8.1a"><mrow id="A1.SS2.p3.8.m8.1.1.1" xref="A1.SS2.p3.8.m8.1.1.2.cmml"><mo id="A1.SS2.p3.8.m8.1.1.1.2" xref="A1.SS2.p3.8.m8.1.1.2.1.cmml">⟨</mo><mrow id="A1.SS2.p3.8.m8.1.1.1.1" xref="A1.SS2.p3.8.m8.1.1.1.1.cmml"><mi id="A1.SS2.p3.8.m8.1.1.1.1.2" xref="A1.SS2.p3.8.m8.1.1.1.1.2.cmml">C</mi><mo id="A1.SS2.p3.8.m8.1.1.1.1.1" xref="A1.SS2.p3.8.m8.1.1.1.1.1.cmml">⁢</mo><msub id="A1.SS2.p3.8.m8.1.1.1.1.3" xref="A1.SS2.p3.8.m8.1.1.1.1.3.cmml"><mi id="A1.SS2.p3.8.m8.1.1.1.1.3.2" xref="A1.SS2.p3.8.m8.1.1.1.1.3.2.cmml">T</mi><mi id="A1.SS2.p3.8.m8.1.1.1.1.3.3" xref="A1.SS2.p3.8.m8.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.SS2.p3.8.m8.1.1.1.3" xref="A1.SS2.p3.8.m8.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.8.m8.1b"><apply id="A1.SS2.p3.8.m8.1.1.2.cmml" xref="A1.SS2.p3.8.m8.1.1.1"><csymbol cd="latexml" id="A1.SS2.p3.8.m8.1.1.2.1.cmml" xref="A1.SS2.p3.8.m8.1.1.1.2">delimited-⟨⟩</csymbol><apply id="A1.SS2.p3.8.m8.1.1.1.1.cmml" xref="A1.SS2.p3.8.m8.1.1.1.1"><times id="A1.SS2.p3.8.m8.1.1.1.1.1.cmml" xref="A1.SS2.p3.8.m8.1.1.1.1.1"></times><ci id="A1.SS2.p3.8.m8.1.1.1.1.2.cmml" xref="A1.SS2.p3.8.m8.1.1.1.1.2">𝐶</ci><apply id="A1.SS2.p3.8.m8.1.1.1.1.3.cmml" xref="A1.SS2.p3.8.m8.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.8.m8.1.1.1.1.3.1.cmml" xref="A1.SS2.p3.8.m8.1.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.8.m8.1.1.1.1.3.2.cmml" xref="A1.SS2.p3.8.m8.1.1.1.1.3.2">𝑇</ci><ci id="A1.SS2.p3.8.m8.1.1.1.1.3.3.cmml" xref="A1.SS2.p3.8.m8.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.8.m8.1c">\left\langle CT_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.8.m8.1d">⟨ italic_C italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>", "<math alttext="\left\langle j\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.9.m9.1"><semantics id="A1.SS2.p3.9.m9.1a"><mrow id="A1.SS2.p3.9.m9.1.2.2" xref="A1.SS2.p3.9.m9.1.2.1.cmml"><mo id="A1.SS2.p3.9.m9.1.2.2.1" xref="A1.SS2.p3.9.m9.1.2.1.1.cmml">⟨</mo><mi id="A1.SS2.p3.9.m9.1.1" xref="A1.SS2.p3.9.m9.1.1.cmml">j</mi><mo id="A1.SS2.p3.9.m9.1.2.2.2" xref="A1.SS2.p3.9.m9.1.2.1.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.9.m9.1b"><apply id="A1.SS2.p3.9.m9.1.2.1.cmml" xref="A1.SS2.p3.9.m9.1.2.2"><csymbol cd="latexml" id="A1.SS2.p3.9.m9.1.2.1.1.cmml" xref="A1.SS2.p3.9.m9.1.2.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS2.p3.9.m9.1.1.cmml" xref="A1.SS2.p3.9.m9.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.9.m9.1c">\left\langle j\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.9.m9.1d">⟨ italic_j ⟩</annotation></semantics></math>"), where "<math alttext="\left\langle\text{{Item}}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.10.m10.1"><semantics id="A1.SS2.p3.10.m10.1a"><mrow id="A1.SS2.p3.10.m10.1.2.2" xref="A1.SS2.p3.10.m10.1.2.1.cmml"><mo id="A1.SS2.p3.10.m10.1.2.2.1" xref="A1.SS2.p3.10.m10.1.2.1.1.cmml">⟨</mo><mtext id="A1.SS2.p3.10.m10.1.1" xref="A1.SS2.p3.10.m10.1.1a.cmml">Item</mtext><mo id="A1.SS2.p3.10.m10.1.2.2.2" xref="A1.SS2.p3.10.m10.1.2.1.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.10.m10.1b"><apply id="A1.SS2.p3.10.m10.1.2.1.cmml" xref="A1.SS2.p3.10.m10.1.2.2"><csymbol cd="latexml" id="A1.SS2.p3.10.m10.1.2.1.1.cmml" xref="A1.SS2.p3.10.m10.1.2.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS2.p3.10.m10.1.1a.cmml" xref="A1.SS2.p3.10.m10.1.1"><mtext id="A1.SS2.p3.10.m10.1.1.cmml" xref="A1.SS2.p3.10.m10.1.1">Item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.10.m10.1c">\left\langle\text{{Item}}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.10.m10.1d">⟨ Item ⟩</annotation></semantics></math>" denotes it as an item, "<math alttext="\left\langle CT_{i}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.11.m11.1"><semantics id="A1.SS2.p3.11.m11.1a"><mrow id="A1.SS2.p3.11.m11.1.1.1" xref="A1.SS2.p3.11.m11.1.1.2.cmml"><mo id="A1.SS2.p3.11.m11.1.1.1.2" xref="A1.SS2.p3.11.m11.1.1.2.1.cmml">⟨</mo><mrow id="A1.SS2.p3.11.m11.1.1.1.1" xref="A1.SS2.p3.11.m11.1.1.1.1.cmml"><mi id="A1.SS2.p3.11.m11.1.1.1.1.2" xref="A1.SS2.p3.11.m11.1.1.1.1.2.cmml">C</mi><mo id="A1.SS2.p3.11.m11.1.1.1.1.1" xref="A1.SS2.p3.11.m11.1.1.1.1.1.cmml">⁢</mo><msub id="A1.SS2.p3.11.m11.1.1.1.1.3" xref="A1.SS2.p3.11.m11.1.1.1.1.3.cmml"><mi id="A1.SS2.p3.11.m11.1.1.1.1.3.2" xref="A1.SS2.p3.11.m11.1.1.1.1.3.2.cmml">T</mi><mi id="A1.SS2.p3.11.m11.1.1.1.1.3.3" xref="A1.SS2.p3.11.m11.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.SS2.p3.11.m11.1.1.1.3" xref="A1.SS2.p3.11.m11.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.11.m11.1b"><apply id="A1.SS2.p3.11.m11.1.1.2.cmml" xref="A1.SS2.p3.11.m11.1.1.1"><csymbol cd="latexml" id="A1.SS2.p3.11.m11.1.1.2.1.cmml" xref="A1.SS2.p3.11.m11.1.1.1.2">delimited-⟨⟩</csymbol><apply id="A1.SS2.p3.11.m11.1.1.1.1.cmml" xref="A1.SS2.p3.11.m11.1.1.1.1"><times id="A1.SS2.p3.11.m11.1.1.1.1.1.cmml" xref="A1.SS2.p3.11.m11.1.1.1.1.1"></times><ci id="A1.SS2.p3.11.m11.1.1.1.1.2.cmml" xref="A1.SS2.p3.11.m11.1.1.1.1.2">𝐶</ci><apply id="A1.SS2.p3.11.m11.1.1.1.1.3.cmml" xref="A1.SS2.p3.11.m11.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.11.m11.1.1.1.1.3.1.cmml" xref="A1.SS2.p3.11.m11.1.1.1.1.3">subscript</csymbol><ci id="A1.SS2.p3.11.m11.1.1.1.1.3.2.cmml" xref="A1.SS2.p3.11.m11.1.1.1.1.3.2">𝑇</ci><ci id="A1.SS2.p3.11.m11.1.1.1.1.3.3.cmml" xref="A1.SS2.p3.11.m11.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.11.m11.1c">\left\langle CT_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.11.m11.1d">⟨ italic_C italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>" is its cluster token, and "<math alttext="\left\langle y_{i}\right\rangle" class="ltx_Math" display="inline" id="A1.SS2.p3.12.m12.1"><semantics id="A1.SS2.p3.12.m12.1a"><mrow id="A1.SS2.p3.12.m12.1.1.1" xref="A1.SS2.p3.12.m12.1.1.2.cmml"><mo id="A1.SS2.p3.12.m12.1.1.1.2" xref="A1.SS2.p3.12.m12.1.1.2.1.cmml">⟨</mo><msub id="A1.SS2.p3.12.m12.1.1.1.1" xref="A1.SS2.p3.12.m12.1.1.1.1.cmml"><mi id="A1.SS2.p3.12.m12.1.1.1.1.2" xref="A1.SS2.p3.12.m12.1.1.1.1.2.cmml">y</mi><mi id="A1.SS2.p3.12.m12.1.1.1.1.3" xref="A1.SS2.p3.12.m12.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.SS2.p3.12.m12.1.1.1.3" xref="A1.SS2.p3.12.m12.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.12.m12.1b"><apply id="A1.SS2.p3.12.m12.1.1.2.cmml" xref="A1.SS2.p3.12.m12.1.1.1"><csymbol cd="latexml" id="A1.SS2.p3.12.m12.1.1.2.1.cmml" xref="A1.SS2.p3.12.m12.1.1.1.2">delimited-⟨⟩</csymbol><apply id="A1.SS2.p3.12.m12.1.1.1.1.cmml" xref="A1.SS2.p3.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.12.m12.1.1.1.1.1.cmml" xref="A1.SS2.p3.12.m12.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p3.12.m12.1.1.1.1.2.cmml" xref="A1.SS2.p3.12.m12.1.1.1.1.2">𝑦</ci><ci id="A1.SS2.p3.12.m12.1.1.1.1.3.cmml" xref="A1.SS2.p3.12.m12.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.12.m12.1c">\left\langle y_{i}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.12.m12.1d">⟨ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩</annotation></semantics></math>" is its in-cluster token.</p>
</div>
<div class="ltx_para" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.1">It is worth noting that a naive approach to generating user and item IDs is to assign an independent OOV token as ID (IID) that needs to be learned for each item and user. However, this is not applicable to modern recommender systems with a large number of items and users, as the training time may be too long if a large number of new tokens need to be created. We also show it in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1.T7" title="Table 7 ‣ A.2 How to generate OOV tokens ‣ Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">7</span></a>, where we use the meta-path-based embeddings with a linear projection layer for initialization, which shows that it is ineffective compared to META ID.</p>
</div>
<figure class="ltx_table" id="A1.T5">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5: </span>Examples of prompts for recommendation tasks (Part 1).</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T5.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T5.4.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="A1.T5.4.1.1.1"></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A1.T5.4.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.1.1.2.1">
<span class="ltx_p" id="A1.T5.4.1.1.2.1.1" style="width:130.1pt;"><span class="ltx_text ltx_font_bold" id="A1.T5.4.1.1.2.1.1.1" style="font-size:90%;">Sequential Recommendation</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A1.T5.4.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.1.1.3.1">
<span class="ltx_p" id="A1.T5.4.1.1.3.1.1" style="width:108.4pt;"><span class="ltx_text ltx_font_bold" id="A1.T5.4.1.1.3.1.1.1" style="font-size:90%;">Direct Recommendation</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A1.T5.4.1.1.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.1.1.4.1">
<span class="ltx_p" id="A1.T5.4.1.1.4.1.1" style="width:108.4pt;"><span class="ltx_text ltx_font_bold" id="A1.T5.4.1.1.4.1.1.1" style="font-size:90%;">Rating Prediction</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T5.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T5.4.2.1.1"><span class="ltx_text" id="A1.T5.4.2.1.1.1" style="font-size:90%;">Task Input:</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T5.4.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.2.1.2.1">
<span class="ltx_p" id="A1.T5.4.2.1.2.1.1" style="width:130.1pt;"><span class="ltx_text" id="A1.T5.4.2.1.2.1.1.1" style="font-size:90%;">Considering </span><span class="ltx_text ltx_font_bold" id="A1.T5.4.2.1.2.1.1.2" style="font-size:90%;">user_2024</span><span class="ltx_text" id="A1.T5.4.2.1.2.1.1.3" style="font-size:90%;"> has interacted with items </span><span class="ltx_text ltx_font_bold" id="A1.T5.4.2.1.2.1.1.4" style="font-size:90%;">item_1</span><span class="ltx_text" id="A1.T5.4.2.1.2.1.1.5" style="font-size:90%;">, </span><span class="ltx_text ltx_font_bold" id="A1.T5.4.2.1.2.1.1.6" style="font-size:90%;">item_2</span><span class="ltx_text" id="A1.T5.4.2.1.2.1.1.7" style="font-size:90%;">. What is the next recommendation for the user?</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T5.4.2.1.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.2.1.3.1">
<span class="ltx_p" id="A1.T5.4.2.1.3.1.1" style="width:108.4pt;"><span class="ltx_text" id="A1.T5.4.2.1.3.1.1.1" style="font-size:90%;">What should we recommend for </span><span class="ltx_text ltx_font_bold" id="A1.T5.4.2.1.3.1.1.2" style="font-size:90%;">user_2024</span><span class="ltx_text" id="A1.T5.4.2.1.3.1.1.3" style="font-size:90%;">?</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T5.4.2.1.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.2.1.4.1">
<span class="ltx_p" id="A1.T5.4.2.1.4.1.1" style="width:108.4pt;"><span class="ltx_text" id="A1.T5.4.2.1.4.1.1.1" style="font-size:90%;">Which star rating will </span><span class="ltx_text ltx_font_bold" id="A1.T5.4.2.1.4.1.1.2" style="font-size:90%;">user_2024</span><span class="ltx_text" id="A1.T5.4.2.1.4.1.1.3" style="font-size:90%;"> give to item </span><span class="ltx_text ltx_font_bold" id="A1.T5.4.2.1.4.1.1.4" style="font-size:90%;">item_2</span><span class="ltx_text" id="A1.T5.4.2.1.4.1.1.5" style="font-size:90%;">? (1 being the lowest and 5 being the highest).</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A1.T5.4.3.2.1"><span class="ltx_text" id="A1.T5.4.3.2.1.1" style="font-size:90%;">Task Output:</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A1.T5.4.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.3.2.2.1">
<span class="ltx_p" id="A1.T5.4.3.2.2.1.1" style="width:130.1pt;"><span class="ltx_text ltx_font_bold" id="A1.T5.4.3.2.2.1.1.1" style="font-size:90%;">item_2024</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A1.T5.4.3.2.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.3.2.3.1">
<span class="ltx_p" id="A1.T5.4.3.2.3.1.1" style="width:108.4pt;"><span class="ltx_text ltx_font_bold" id="A1.T5.4.3.2.3.1.1.1" style="font-size:90%;">item_2024</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A1.T5.4.3.2.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.3.2.4.1">
<span class="ltx_p" id="A1.T5.4.3.2.4.1.1" style="width:108.4pt;"><span class="ltx_text" id="A1.T5.4.3.2.4.1.1.1" style="font-size:90%;">5</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 6: </span>Examples of prompts for recommendation tasks (Part 2).</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T6.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T6.4.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="A1.T6.4.1.1.1"></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A1.T6.4.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.4.1.1.2.1">
<span class="ltx_p" id="A1.T6.4.1.1.2.1.1" style="width:151.8pt;"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.1.2.1.1.1" style="font-size:90%;">Explanation</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="A1.T6.4.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.4.1.1.3.1">
<span class="ltx_p" id="A1.T6.4.1.1.3.1.1" style="width:151.8pt;"><span class="ltx_text ltx_font_bold" id="A1.T6.4.1.1.3.1.1.1" style="font-size:90%;">Review</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T6.4.2.1.1"><span class="ltx_text" id="A1.T6.4.2.1.1.1" style="font-size:90%;">Task Input:</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T6.4.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.4.2.1.2.1">
<span class="ltx_p" id="A1.T6.4.2.1.2.1.1" style="width:151.8pt;"><span class="ltx_text" id="A1.T6.4.2.1.2.1.1.1" style="font-size:90%;">According to the feature word quality, generate a 5-star explanation for </span><span class="ltx_text ltx_font_bold" id="A1.T6.4.2.1.2.1.1.2" style="font-size:90%;">user_2</span><span class="ltx_text" id="A1.T6.4.2.1.2.1.1.3" style="font-size:90%;"> about </span><span class="ltx_text ltx_font_bold" id="A1.T6.4.2.1.2.1.1.4" style="font-size:90%;">item_2</span><span class="ltx_text" id="A1.T6.4.2.1.2.1.1.5" style="font-size:90%;">.</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T6.4.2.1.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.4.2.1.3.1">
<span class="ltx_p" id="A1.T6.4.2.1.3.1.1" style="width:151.8pt;"><span class="ltx_text" id="A1.T6.4.2.1.3.1.1.1" style="font-size:90%;">Write a short sentence to summarize the following product review from </span><span class="ltx_text ltx_font_bold" id="A1.T6.4.2.1.3.1.1.2" style="font-size:90%;">user_2</span><span class="ltx_text" id="A1.T6.4.2.1.3.1.1.3" style="font-size:90%;">: Absolutely great product. I bought this for …</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T6.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A1.T6.4.3.2.1"><span class="ltx_text" id="A1.T6.4.3.2.1.1" style="font-size:90%;">Task Output:</span></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A1.T6.4.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.4.3.2.2.1">
<span class="ltx_p" id="A1.T6.4.3.2.2.1.1" style="width:151.8pt;"><span class="ltx_text" id="A1.T6.4.3.2.2.1.1.1" style="font-size:90%;">Absolutely great product!</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A1.T6.4.3.2.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T6.4.3.2.3.1">
<span class="ltx_p" id="A1.T6.4.3.2.3.1.1" style="width:151.8pt;"><span class="ltx_text" id="A1.T6.4.3.2.3.1.1.1" style="font-size:90%;">Perfect!</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T7.2.1.1" style="font-size:90%;">Table 7</span>: </span><span class="ltx_text" id="A1.T7.3.2" style="font-size:90%;"> Comparison of independent ID (IID) with META ID on sequential recommendation task.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="A1.T7.4" style="width:561.1pt;height:73pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="A1.T7.4.1"><span class="ltx_text" id="A1.T7.4.1.1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T7.4.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A1.T7.4.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt ltx_rowspan ltx_rowspan_2" id="A1.T7.4.1.1.1.1.1.1" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text" id="A1.T7.4.1.1.1.1.1.1.1">Methods</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="A1.T7.4.1.1.1.1.1.2" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.1.1.2.1">Sports</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="A1.T7.4.1.1.1.1.1.3" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.1.1.3.1">Beauty</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_4" id="A1.T7.4.1.1.1.1.1.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.1.1.4.1">Toys</span></span></span>
<span class="ltx_tr" id="A1.T7.4.1.1.1.2.2">
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.1" style="padding-left:2.3pt;padding-right:2.3pt;">HR@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.2" style="padding-left:2.3pt;padding-right:2.3pt;">NDCG@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.3" style="padding-left:2.3pt;padding-right:2.3pt;">HR@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.4" style="padding-left:2.3pt;padding-right:2.3pt;">NDCG@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.5" style="padding-left:2.3pt;padding-right:2.3pt;">HR@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.6" style="padding-left:2.3pt;padding-right:2.3pt;">NDCG@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.7" style="padding-left:2.3pt;padding-right:2.3pt;">HR@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.8" style="padding-left:2.3pt;padding-right:2.3pt;">NDCG@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.9" style="padding-left:2.3pt;padding-right:2.3pt;">HR@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.10" style="padding-left:2.3pt;padding-right:2.3pt;">NDCG@5</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.11" style="padding-left:2.3pt;padding-right:2.3pt;">HR@10</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T7.4.1.1.1.2.2.12" style="padding-left:2.3pt;padding-right:2.3pt;">NDCG@10</span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A1.T7.4.1.1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T7.4.1.1.1.3.1.1" style="padding-left:2.3pt;padding-right:2.3pt;">IID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.2" style="padding-left:2.3pt;padding-right:2.3pt;">0.0114</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.3" style="padding-left:2.3pt;padding-right:2.3pt;">0.0073</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.4" style="padding-left:2.3pt;padding-right:2.3pt;">0.0208</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.5" style="padding-left:2.3pt;padding-right:2.3pt;">0.0103</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.6" style="padding-left:2.3pt;padding-right:2.3pt;">0.0302</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.7" style="padding-left:2.3pt;padding-right:2.3pt;">0.0194</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.8" style="padding-left:2.3pt;padding-right:2.3pt;">0.0494</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.9" style="padding-left:2.3pt;padding-right:2.3pt;">0.0256</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.10" style="padding-left:2.3pt;padding-right:2.3pt;">0.0146</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.11" style="padding-left:2.3pt;padding-right:2.3pt;">0.0091</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.12" style="padding-left:2.3pt;padding-right:2.3pt;">0.0217</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.4.1.1.1.3.1.13" style="padding-left:2.3pt;padding-right:2.3pt;">0.0114</span></span>
<span class="ltx_tr" id="A1.T7.4.1.1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T7.4.1.1.1.4.2.1" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.1.1">META ID</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.2" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.2.1">0.0357</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.3" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.3.1">0.0256</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.4" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.4.1">0.0520</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.5" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.5.1">0.0308</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.6" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.6.1">0.0480</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.7" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.7.1">0.0336</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.8" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.8.1">0.0689</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.9" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.9.1">0.0403</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.10" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.10.1">0.0564</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.11" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.11.1">0.0391</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.12" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.12.1">0.0803</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A1.T7.4.1.1.1.4.2.13" style="padding-left:2.3pt;padding-right:2.3pt;"><span class="ltx_text ltx_font_bold" id="A1.T7.4.1.1.1.4.2.13.1">0.0468</span></span></span>
</span>
</span></span></p>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>How to incorporate META ID with LLMs</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">As mentioned in subsection <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.SS1" title="3.1 Instruction Tuning for Recommendation ‣ 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we convert every recommendation tasks into question&amp;answering template, in which we describe the recommendation tasks in natural language form, and replace user and item IDs with different dataset like a cloze test. The full templates for every tasks in this format is from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite>, where we give some examples in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1.T5" title="Table 5 ‣ A.2 How to generate OOV tokens ‣ Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">5</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1.T6" title="Table 6 ‣ A.2 How to generate OOV tokens ‣ Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div class="ltx_para" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.2">Take rating prediction task as example. We might ask the LLM, "Which star rating will user <math alttext="\left\langle\text{User}\right\rangle\left\langle CT_{1}\right\rangle\left%
\langle 18\right\rangle" class="ltx_Math" display="inline" id="A1.SS3.p2.1.m1.3"><semantics id="A1.SS3.p2.1.m1.3a"><mrow id="A1.SS3.p2.1.m1.3.3" xref="A1.SS3.p2.1.m1.3.3.cmml"><mrow id="A1.SS3.p2.1.m1.3.3.3.2" xref="A1.SS3.p2.1.m1.3.3.3.1.cmml"><mo id="A1.SS3.p2.1.m1.3.3.3.2.1" xref="A1.SS3.p2.1.m1.3.3.3.1.1.cmml">⟨</mo><mtext id="A1.SS3.p2.1.m1.1.1" xref="A1.SS3.p2.1.m1.1.1a.cmml">User</mtext><mo id="A1.SS3.p2.1.m1.3.3.3.2.2" xref="A1.SS3.p2.1.m1.3.3.3.1.1.cmml">⟩</mo></mrow><mo id="A1.SS3.p2.1.m1.3.3.2" xref="A1.SS3.p2.1.m1.3.3.2.cmml">⁢</mo><mrow id="A1.SS3.p2.1.m1.3.3.1.1" xref="A1.SS3.p2.1.m1.3.3.1.2.cmml"><mo id="A1.SS3.p2.1.m1.3.3.1.1.2" xref="A1.SS3.p2.1.m1.3.3.1.2.1.cmml">⟨</mo><mrow id="A1.SS3.p2.1.m1.3.3.1.1.1" xref="A1.SS3.p2.1.m1.3.3.1.1.1.cmml"><mi id="A1.SS3.p2.1.m1.3.3.1.1.1.2" xref="A1.SS3.p2.1.m1.3.3.1.1.1.2.cmml">C</mi><mo id="A1.SS3.p2.1.m1.3.3.1.1.1.1" xref="A1.SS3.p2.1.m1.3.3.1.1.1.1.cmml">⁢</mo><msub id="A1.SS3.p2.1.m1.3.3.1.1.1.3" xref="A1.SS3.p2.1.m1.3.3.1.1.1.3.cmml"><mi id="A1.SS3.p2.1.m1.3.3.1.1.1.3.2" xref="A1.SS3.p2.1.m1.3.3.1.1.1.3.2.cmml">T</mi><mn id="A1.SS3.p2.1.m1.3.3.1.1.1.3.3" xref="A1.SS3.p2.1.m1.3.3.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A1.SS3.p2.1.m1.3.3.1.1.3" xref="A1.SS3.p2.1.m1.3.3.1.2.1.cmml">⟩</mo></mrow><mo id="A1.SS3.p2.1.m1.3.3.2a" xref="A1.SS3.p2.1.m1.3.3.2.cmml">⁢</mo><mrow id="A1.SS3.p2.1.m1.3.3.4.2" xref="A1.SS3.p2.1.m1.3.3.4.1.cmml"><mo id="A1.SS3.p2.1.m1.3.3.4.2.1" xref="A1.SS3.p2.1.m1.3.3.4.1.1.cmml">⟨</mo><mn id="A1.SS3.p2.1.m1.2.2" xref="A1.SS3.p2.1.m1.2.2.cmml">18</mn><mo id="A1.SS3.p2.1.m1.3.3.4.2.2" xref="A1.SS3.p2.1.m1.3.3.4.1.1.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.1.m1.3b"><apply id="A1.SS3.p2.1.m1.3.3.cmml" xref="A1.SS3.p2.1.m1.3.3"><times id="A1.SS3.p2.1.m1.3.3.2.cmml" xref="A1.SS3.p2.1.m1.3.3.2"></times><apply id="A1.SS3.p2.1.m1.3.3.3.1.cmml" xref="A1.SS3.p2.1.m1.3.3.3.2"><csymbol cd="latexml" id="A1.SS3.p2.1.m1.3.3.3.1.1.cmml" xref="A1.SS3.p2.1.m1.3.3.3.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS3.p2.1.m1.1.1a.cmml" xref="A1.SS3.p2.1.m1.1.1"><mtext id="A1.SS3.p2.1.m1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1">User</mtext></ci></apply><apply id="A1.SS3.p2.1.m1.3.3.1.2.cmml" xref="A1.SS3.p2.1.m1.3.3.1.1"><csymbol cd="latexml" id="A1.SS3.p2.1.m1.3.3.1.2.1.cmml" xref="A1.SS3.p2.1.m1.3.3.1.1.2">delimited-⟨⟩</csymbol><apply id="A1.SS3.p2.1.m1.3.3.1.1.1.cmml" xref="A1.SS3.p2.1.m1.3.3.1.1.1"><times id="A1.SS3.p2.1.m1.3.3.1.1.1.1.cmml" xref="A1.SS3.p2.1.m1.3.3.1.1.1.1"></times><ci id="A1.SS3.p2.1.m1.3.3.1.1.1.2.cmml" xref="A1.SS3.p2.1.m1.3.3.1.1.1.2">𝐶</ci><apply id="A1.SS3.p2.1.m1.3.3.1.1.1.3.cmml" xref="A1.SS3.p2.1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p2.1.m1.3.3.1.1.1.3.1.cmml" xref="A1.SS3.p2.1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A1.SS3.p2.1.m1.3.3.1.1.1.3.2.cmml" xref="A1.SS3.p2.1.m1.3.3.1.1.1.3.2">𝑇</ci><cn id="A1.SS3.p2.1.m1.3.3.1.1.1.3.3.cmml" type="integer" xref="A1.SS3.p2.1.m1.3.3.1.1.1.3.3">1</cn></apply></apply></apply><apply id="A1.SS3.p2.1.m1.3.3.4.1.cmml" xref="A1.SS3.p2.1.m1.3.3.4.2"><csymbol cd="latexml" id="A1.SS3.p2.1.m1.3.3.4.1.1.cmml" xref="A1.SS3.p2.1.m1.3.3.4.2.1">delimited-⟨⟩</csymbol><cn id="A1.SS3.p2.1.m1.2.2.cmml" type="integer" xref="A1.SS3.p2.1.m1.2.2">18</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.1.m1.3c">\left\langle\text{User}\right\rangle\left\langle CT_{1}\right\rangle\left%
\langle 18\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.1.m1.3d">⟨ User ⟩ ⟨ italic_C italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⟩ ⟨ 18 ⟩</annotation></semantics></math> give item <math alttext="\left\langle\text{Item}\right\rangle\left\langle CT_{8}\right\rangle\left%
\langle 24\right\rangle" class="ltx_Math" display="inline" id="A1.SS3.p2.2.m2.3"><semantics id="A1.SS3.p2.2.m2.3a"><mrow id="A1.SS3.p2.2.m2.3.3" xref="A1.SS3.p2.2.m2.3.3.cmml"><mrow id="A1.SS3.p2.2.m2.3.3.3.2" xref="A1.SS3.p2.2.m2.3.3.3.1.cmml"><mo id="A1.SS3.p2.2.m2.3.3.3.2.1" xref="A1.SS3.p2.2.m2.3.3.3.1.1.cmml">⟨</mo><mtext id="A1.SS3.p2.2.m2.1.1" xref="A1.SS3.p2.2.m2.1.1a.cmml">Item</mtext><mo id="A1.SS3.p2.2.m2.3.3.3.2.2" xref="A1.SS3.p2.2.m2.3.3.3.1.1.cmml">⟩</mo></mrow><mo id="A1.SS3.p2.2.m2.3.3.2" xref="A1.SS3.p2.2.m2.3.3.2.cmml">⁢</mo><mrow id="A1.SS3.p2.2.m2.3.3.1.1" xref="A1.SS3.p2.2.m2.3.3.1.2.cmml"><mo id="A1.SS3.p2.2.m2.3.3.1.1.2" xref="A1.SS3.p2.2.m2.3.3.1.2.1.cmml">⟨</mo><mrow id="A1.SS3.p2.2.m2.3.3.1.1.1" xref="A1.SS3.p2.2.m2.3.3.1.1.1.cmml"><mi id="A1.SS3.p2.2.m2.3.3.1.1.1.2" xref="A1.SS3.p2.2.m2.3.3.1.1.1.2.cmml">C</mi><mo id="A1.SS3.p2.2.m2.3.3.1.1.1.1" xref="A1.SS3.p2.2.m2.3.3.1.1.1.1.cmml">⁢</mo><msub id="A1.SS3.p2.2.m2.3.3.1.1.1.3" xref="A1.SS3.p2.2.m2.3.3.1.1.1.3.cmml"><mi id="A1.SS3.p2.2.m2.3.3.1.1.1.3.2" xref="A1.SS3.p2.2.m2.3.3.1.1.1.3.2.cmml">T</mi><mn id="A1.SS3.p2.2.m2.3.3.1.1.1.3.3" xref="A1.SS3.p2.2.m2.3.3.1.1.1.3.3.cmml">8</mn></msub></mrow><mo id="A1.SS3.p2.2.m2.3.3.1.1.3" xref="A1.SS3.p2.2.m2.3.3.1.2.1.cmml">⟩</mo></mrow><mo id="A1.SS3.p2.2.m2.3.3.2a" xref="A1.SS3.p2.2.m2.3.3.2.cmml">⁢</mo><mrow id="A1.SS3.p2.2.m2.3.3.4.2" xref="A1.SS3.p2.2.m2.3.3.4.1.cmml"><mo id="A1.SS3.p2.2.m2.3.3.4.2.1" xref="A1.SS3.p2.2.m2.3.3.4.1.1.cmml">⟨</mo><mn id="A1.SS3.p2.2.m2.2.2" xref="A1.SS3.p2.2.m2.2.2.cmml">24</mn><mo id="A1.SS3.p2.2.m2.3.3.4.2.2" xref="A1.SS3.p2.2.m2.3.3.4.1.1.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.2.m2.3b"><apply id="A1.SS3.p2.2.m2.3.3.cmml" xref="A1.SS3.p2.2.m2.3.3"><times id="A1.SS3.p2.2.m2.3.3.2.cmml" xref="A1.SS3.p2.2.m2.3.3.2"></times><apply id="A1.SS3.p2.2.m2.3.3.3.1.cmml" xref="A1.SS3.p2.2.m2.3.3.3.2"><csymbol cd="latexml" id="A1.SS3.p2.2.m2.3.3.3.1.1.cmml" xref="A1.SS3.p2.2.m2.3.3.3.2.1">delimited-⟨⟩</csymbol><ci id="A1.SS3.p2.2.m2.1.1a.cmml" xref="A1.SS3.p2.2.m2.1.1"><mtext id="A1.SS3.p2.2.m2.1.1.cmml" xref="A1.SS3.p2.2.m2.1.1">Item</mtext></ci></apply><apply id="A1.SS3.p2.2.m2.3.3.1.2.cmml" xref="A1.SS3.p2.2.m2.3.3.1.1"><csymbol cd="latexml" id="A1.SS3.p2.2.m2.3.3.1.2.1.cmml" xref="A1.SS3.p2.2.m2.3.3.1.1.2">delimited-⟨⟩</csymbol><apply id="A1.SS3.p2.2.m2.3.3.1.1.1.cmml" xref="A1.SS3.p2.2.m2.3.3.1.1.1"><times id="A1.SS3.p2.2.m2.3.3.1.1.1.1.cmml" xref="A1.SS3.p2.2.m2.3.3.1.1.1.1"></times><ci id="A1.SS3.p2.2.m2.3.3.1.1.1.2.cmml" xref="A1.SS3.p2.2.m2.3.3.1.1.1.2">𝐶</ci><apply id="A1.SS3.p2.2.m2.3.3.1.1.1.3.cmml" xref="A1.SS3.p2.2.m2.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.p2.2.m2.3.3.1.1.1.3.1.cmml" xref="A1.SS3.p2.2.m2.3.3.1.1.1.3">subscript</csymbol><ci id="A1.SS3.p2.2.m2.3.3.1.1.1.3.2.cmml" xref="A1.SS3.p2.2.m2.3.3.1.1.1.3.2">𝑇</ci><cn id="A1.SS3.p2.2.m2.3.3.1.1.1.3.3.cmml" type="integer" xref="A1.SS3.p2.2.m2.3.3.1.1.1.3.3">8</cn></apply></apply></apply><apply id="A1.SS3.p2.2.m2.3.3.4.1.cmml" xref="A1.SS3.p2.2.m2.3.3.4.2"><csymbol cd="latexml" id="A1.SS3.p2.2.m2.3.3.4.1.1.cmml" xref="A1.SS3.p2.2.m2.3.3.4.2.1">delimited-⟨⟩</csymbol><cn id="A1.SS3.p2.2.m2.2.2.cmml" type="integer" xref="A1.SS3.p2.2.m2.2.2">24</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.2.m2.3c">\left\langle\text{Item}\right\rangle\left\langle CT_{8}\right\rangle\left%
\langle 24\right\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.2.m2.3d">⟨ Item ⟩ ⟨ italic_C italic_T start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT ⟩ ⟨ 24 ⟩</annotation></semantics></math> ?", and expect the LLM to answer "5".</p>
</div>
<div class="ltx_para" id="A1.SS3.p3">
<p class="ltx_p" id="A1.SS3.p3.1">We construct the fine-tuning and testing dataset for LLM in this unified way. Then LLM is able to acquire the generalized knowledge across different tasks, and even carve out user and item characteristics through those tokens constructing IDs to handle different recommendation tasks.</p>
</div>
<figure class="ltx_figure" id="A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="272" id="A1.F6.g1" src="x10.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="A1.F6.3.2" style="font-size:90%;">Convergence analysis of DS metric for Beauty and Sports datasets, with 95% confidence interval error bars indicating variability across 5 trials.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Details of memorization score (MS) and diversity score (DS)</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">This section complements subsection <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S3.SS3" title="3.3 Metric for Representation Evaluation ‣ 3 Preliminary ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">3.3</span></a>. The token embedding layer in LLMs transforms each input token into token embedding vectors. And we use ID representation to indicate that these token embedding vectors corresponding to an ID, <span class="ltx_text ltx_font_italic" id="A2.p1.1.1">i.e.</span>, the representation of an item or user in LLMs.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.4"><span class="ltx_text ltx_font_bold" id="A2.p2.4.1">The convergence of DS</span>. DS is a metric designed to quantify the diversity of ID representations in LLMs. Given the high computational demand of calculating KL divergence for all embedding pairs in large datasets, DS employs a random sampling approach, thus we present a convergence analysis for DS in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1.F6" title="Figure 6 ‣ A.3 How to incorporate META ID with LLMs ‣ Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">6</span></a>. The stability of DS is evident across both datasets, demonstrating a trend towards convergence as the number of sampled pairs grows. This sampling strategy reducesthe computational complexity from <math alttext="O(|I|^{2}\cdot D)" class="ltx_Math" display="inline" id="A2.p2.1.m1.2"><semantics id="A2.p2.1.m1.2a"><mrow id="A2.p2.1.m1.2.2" xref="A2.p2.1.m1.2.2.cmml"><mi id="A2.p2.1.m1.2.2.3" xref="A2.p2.1.m1.2.2.3.cmml">O</mi><mo id="A2.p2.1.m1.2.2.2" xref="A2.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="A2.p2.1.m1.2.2.1.1" xref="A2.p2.1.m1.2.2.1.1.1.cmml"><mo id="A2.p2.1.m1.2.2.1.1.2" stretchy="false" xref="A2.p2.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="A2.p2.1.m1.2.2.1.1.1" xref="A2.p2.1.m1.2.2.1.1.1.cmml"><msup id="A2.p2.1.m1.2.2.1.1.1.2" xref="A2.p2.1.m1.2.2.1.1.1.2.cmml"><mrow id="A2.p2.1.m1.2.2.1.1.1.2.2.2" xref="A2.p2.1.m1.2.2.1.1.1.2.2.1.cmml"><mo id="A2.p2.1.m1.2.2.1.1.1.2.2.2.1" stretchy="false" xref="A2.p2.1.m1.2.2.1.1.1.2.2.1.1.cmml">|</mo><mi id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">I</mi><mo id="A2.p2.1.m1.2.2.1.1.1.2.2.2.2" rspace="0.055em" stretchy="false" xref="A2.p2.1.m1.2.2.1.1.1.2.2.1.1.cmml">|</mo></mrow><mn id="A2.p2.1.m1.2.2.1.1.1.2.3" xref="A2.p2.1.m1.2.2.1.1.1.2.3.cmml">2</mn></msup><mo id="A2.p2.1.m1.2.2.1.1.1.1" rspace="0.222em" xref="A2.p2.1.m1.2.2.1.1.1.1.cmml">⋅</mo><mi id="A2.p2.1.m1.2.2.1.1.1.3" xref="A2.p2.1.m1.2.2.1.1.1.3.cmml">D</mi></mrow><mo id="A2.p2.1.m1.2.2.1.1.3" stretchy="false" xref="A2.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.2b"><apply id="A2.p2.1.m1.2.2.cmml" xref="A2.p2.1.m1.2.2"><times id="A2.p2.1.m1.2.2.2.cmml" xref="A2.p2.1.m1.2.2.2"></times><ci id="A2.p2.1.m1.2.2.3.cmml" xref="A2.p2.1.m1.2.2.3">𝑂</ci><apply id="A2.p2.1.m1.2.2.1.1.1.cmml" xref="A2.p2.1.m1.2.2.1.1"><ci id="A2.p2.1.m1.2.2.1.1.1.1.cmml" xref="A2.p2.1.m1.2.2.1.1.1.1">⋅</ci><apply id="A2.p2.1.m1.2.2.1.1.1.2.cmml" xref="A2.p2.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="A2.p2.1.m1.2.2.1.1.1.2">superscript</csymbol><apply id="A2.p2.1.m1.2.2.1.1.1.2.2.1.cmml" xref="A2.p2.1.m1.2.2.1.1.1.2.2.2"><abs id="A2.p2.1.m1.2.2.1.1.1.2.2.1.1.cmml" xref="A2.p2.1.m1.2.2.1.1.1.2.2.2.1"></abs><ci id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1">𝐼</ci></apply><cn id="A2.p2.1.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="A2.p2.1.m1.2.2.1.1.1.2.3">2</cn></apply><ci id="A2.p2.1.m1.2.2.1.1.1.3.cmml" xref="A2.p2.1.m1.2.2.1.1.1.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.2c">O(|I|^{2}\cdot D)</annotation><annotation encoding="application/x-llamapun" id="A2.p2.1.m1.2d">italic_O ( | italic_I | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_D )</annotation></semantics></math> to <math alttext="O(N\cdot D)" class="ltx_Math" display="inline" id="A2.p2.2.m2.1"><semantics id="A2.p2.2.m2.1a"><mrow id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml"><mi id="A2.p2.2.m2.1.1.3" xref="A2.p2.2.m2.1.1.3.cmml">O</mi><mo id="A2.p2.2.m2.1.1.2" xref="A2.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="A2.p2.2.m2.1.1.1.1" xref="A2.p2.2.m2.1.1.1.1.1.cmml"><mo id="A2.p2.2.m2.1.1.1.1.2" stretchy="false" xref="A2.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A2.p2.2.m2.1.1.1.1.1" xref="A2.p2.2.m2.1.1.1.1.1.cmml"><mi id="A2.p2.2.m2.1.1.1.1.1.2" xref="A2.p2.2.m2.1.1.1.1.1.2.cmml">N</mi><mo id="A2.p2.2.m2.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.2.m2.1.1.1.1.1.1.cmml">⋅</mo><mi id="A2.p2.2.m2.1.1.1.1.1.3" xref="A2.p2.2.m2.1.1.1.1.1.3.cmml">D</mi></mrow><mo id="A2.p2.2.m2.1.1.1.1.3" stretchy="false" xref="A2.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><apply id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1"><times id="A2.p2.2.m2.1.1.2.cmml" xref="A2.p2.2.m2.1.1.2"></times><ci id="A2.p2.2.m2.1.1.3.cmml" xref="A2.p2.2.m2.1.1.3">𝑂</ci><apply id="A2.p2.2.m2.1.1.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1.1"><ci id="A2.p2.2.m2.1.1.1.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1.1.1.1">⋅</ci><ci id="A2.p2.2.m2.1.1.1.1.1.2.cmml" xref="A2.p2.2.m2.1.1.1.1.1.2">𝑁</ci><ci id="A2.p2.2.m2.1.1.1.1.1.3.cmml" xref="A2.p2.2.m2.1.1.1.1.1.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">O(N\cdot D)</annotation><annotation encoding="application/x-llamapun" id="A2.p2.2.m2.1d">italic_O ( italic_N ⋅ italic_D )</annotation></semantics></math>, where the <math alttext="|I|" class="ltx_Math" display="inline" id="A2.p2.3.m3.1"><semantics id="A2.p2.3.m3.1a"><mrow id="A2.p2.3.m3.1.2.2" xref="A2.p2.3.m3.1.2.1.cmml"><mo id="A2.p2.3.m3.1.2.2.1" stretchy="false" xref="A2.p2.3.m3.1.2.1.1.cmml">|</mo><mi id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml">I</mi><mo id="A2.p2.3.m3.1.2.2.2" stretchy="false" xref="A2.p2.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><apply id="A2.p2.3.m3.1.2.1.cmml" xref="A2.p2.3.m3.1.2.2"><abs id="A2.p2.3.m3.1.2.1.1.cmml" xref="A2.p2.3.m3.1.2.2.1"></abs><ci id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">|I|</annotation><annotation encoding="application/x-llamapun" id="A2.p2.3.m3.1d">| italic_I |</annotation></semantics></math> means the size of items, <math alttext="D" class="ltx_Math" display="inline" id="A2.p2.4.m4.1"><semantics id="A2.p2.4.m4.1a"><mi id="A2.p2.4.m4.1.1" xref="A2.p2.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A2.p2.4.m4.1b"><ci id="A2.p2.4.m4.1.1.cmml" xref="A2.p2.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="A2.p2.4.m4.1d">italic_D</annotation></semantics></math> is the dimension of ID representation, which is equal to the LLM’s token embedding dimension.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p3">
<p class="ltx_p" id="A2.p3.8"><span class="ltx_text ltx_font_bold" id="A2.p3.8.1">The approximate value of MS</span>. The adjusted cosine similarity for items is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{sim}(i,j)=\frac{\sum_{u\in U}(R_{u,i}-\bar{R}_{u})\cdot(R_{u,j}-\bar{R}_%
{u})}{{\sqrt{\sum_{u\in U}{(R_{u,i}-\bar{R}_{u})^{2}}\cdot{\sum_{u\in U}{(R_{u%
,j}-\bar{R}_{u})^{2}}}}}}" class="ltx_Math" display="block" id="A2.E11.m1.14"><semantics id="A2.E11.m1.14a"><mrow id="A2.E11.m1.14.15" xref="A2.E11.m1.14.15.cmml"><mrow id="A2.E11.m1.14.15.2" xref="A2.E11.m1.14.15.2.cmml"><mtext id="A2.E11.m1.14.15.2.2" xref="A2.E11.m1.14.15.2.2a.cmml">sim</mtext><mo id="A2.E11.m1.14.15.2.1" xref="A2.E11.m1.14.15.2.1.cmml">⁢</mo><mrow id="A2.E11.m1.14.15.2.3.2" xref="A2.E11.m1.14.15.2.3.1.cmml"><mo id="A2.E11.m1.14.15.2.3.2.1" stretchy="false" xref="A2.E11.m1.14.15.2.3.1.cmml">(</mo><mi id="A2.E11.m1.13.13" xref="A2.E11.m1.13.13.cmml">i</mi><mo id="A2.E11.m1.14.15.2.3.2.2" xref="A2.E11.m1.14.15.2.3.1.cmml">,</mo><mi id="A2.E11.m1.14.14" xref="A2.E11.m1.14.14.cmml">j</mi><mo id="A2.E11.m1.14.15.2.3.2.3" stretchy="false" xref="A2.E11.m1.14.15.2.3.1.cmml">)</mo></mrow></mrow><mo id="A2.E11.m1.14.15.1" xref="A2.E11.m1.14.15.1.cmml">=</mo><mfrac id="A2.E11.m1.12.12" xref="A2.E11.m1.12.12.cmml"><mrow id="A2.E11.m1.6.6.6" xref="A2.E11.m1.6.6.6.cmml"><msub id="A2.E11.m1.6.6.6.7" xref="A2.E11.m1.6.6.6.7.cmml"><mo id="A2.E11.m1.6.6.6.7.2" xref="A2.E11.m1.6.6.6.7.2.cmml">∑</mo><mrow id="A2.E11.m1.6.6.6.7.3" xref="A2.E11.m1.6.6.6.7.3.cmml"><mi id="A2.E11.m1.6.6.6.7.3.2" xref="A2.E11.m1.6.6.6.7.3.2.cmml">u</mi><mo id="A2.E11.m1.6.6.6.7.3.1" xref="A2.E11.m1.6.6.6.7.3.1.cmml">∈</mo><mi id="A2.E11.m1.6.6.6.7.3.3" xref="A2.E11.m1.6.6.6.7.3.3.cmml">U</mi></mrow></msub><mrow id="A2.E11.m1.6.6.6.6" xref="A2.E11.m1.6.6.6.6.cmml"><mrow id="A2.E11.m1.5.5.5.5.1.1" xref="A2.E11.m1.5.5.5.5.1.1.1.cmml"><mo id="A2.E11.m1.5.5.5.5.1.1.2" lspace="0em" stretchy="false" xref="A2.E11.m1.5.5.5.5.1.1.1.cmml">(</mo><mrow id="A2.E11.m1.5.5.5.5.1.1.1" xref="A2.E11.m1.5.5.5.5.1.1.1.cmml"><msub id="A2.E11.m1.5.5.5.5.1.1.1.2" xref="A2.E11.m1.5.5.5.5.1.1.1.2.cmml"><mi id="A2.E11.m1.5.5.5.5.1.1.1.2.2" xref="A2.E11.m1.5.5.5.5.1.1.1.2.2.cmml">R</mi><mrow id="A2.E11.m1.2.2.2.2.2.4" xref="A2.E11.m1.2.2.2.2.2.3.cmml"><mi id="A2.E11.m1.1.1.1.1.1.1" xref="A2.E11.m1.1.1.1.1.1.1.cmml">u</mi><mo id="A2.E11.m1.2.2.2.2.2.4.1" xref="A2.E11.m1.2.2.2.2.2.3.cmml">,</mo><mi id="A2.E11.m1.2.2.2.2.2.2" xref="A2.E11.m1.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="A2.E11.m1.5.5.5.5.1.1.1.1" xref="A2.E11.m1.5.5.5.5.1.1.1.1.cmml">−</mo><msub id="A2.E11.m1.5.5.5.5.1.1.1.3" xref="A2.E11.m1.5.5.5.5.1.1.1.3.cmml"><mover accent="true" id="A2.E11.m1.5.5.5.5.1.1.1.3.2" xref="A2.E11.m1.5.5.5.5.1.1.1.3.2.cmml"><mi id="A2.E11.m1.5.5.5.5.1.1.1.3.2.2" xref="A2.E11.m1.5.5.5.5.1.1.1.3.2.2.cmml">R</mi><mo id="A2.E11.m1.5.5.5.5.1.1.1.3.2.1" xref="A2.E11.m1.5.5.5.5.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="A2.E11.m1.5.5.5.5.1.1.1.3.3" xref="A2.E11.m1.5.5.5.5.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="A2.E11.m1.5.5.5.5.1.1.3" rspace="0.055em" stretchy="false" xref="A2.E11.m1.5.5.5.5.1.1.1.cmml">)</mo></mrow><mo id="A2.E11.m1.6.6.6.6.3" rspace="0.222em" xref="A2.E11.m1.6.6.6.6.3.cmml">⋅</mo><mrow id="A2.E11.m1.6.6.6.6.2.1" xref="A2.E11.m1.6.6.6.6.2.1.1.cmml"><mo id="A2.E11.m1.6.6.6.6.2.1.2" stretchy="false" xref="A2.E11.m1.6.6.6.6.2.1.1.cmml">(</mo><mrow id="A2.E11.m1.6.6.6.6.2.1.1" xref="A2.E11.m1.6.6.6.6.2.1.1.cmml"><msub id="A2.E11.m1.6.6.6.6.2.1.1.2" xref="A2.E11.m1.6.6.6.6.2.1.1.2.cmml"><mi id="A2.E11.m1.6.6.6.6.2.1.1.2.2" xref="A2.E11.m1.6.6.6.6.2.1.1.2.2.cmml">R</mi><mrow id="A2.E11.m1.4.4.4.4.2.4" xref="A2.E11.m1.4.4.4.4.2.3.cmml"><mi id="A2.E11.m1.3.3.3.3.1.1" xref="A2.E11.m1.3.3.3.3.1.1.cmml">u</mi><mo id="A2.E11.m1.4.4.4.4.2.4.1" xref="A2.E11.m1.4.4.4.4.2.3.cmml">,</mo><mi id="A2.E11.m1.4.4.4.4.2.2" xref="A2.E11.m1.4.4.4.4.2.2.cmml">j</mi></mrow></msub><mo id="A2.E11.m1.6.6.6.6.2.1.1.1" xref="A2.E11.m1.6.6.6.6.2.1.1.1.cmml">−</mo><msub id="A2.E11.m1.6.6.6.6.2.1.1.3" xref="A2.E11.m1.6.6.6.6.2.1.1.3.cmml"><mover accent="true" id="A2.E11.m1.6.6.6.6.2.1.1.3.2" xref="A2.E11.m1.6.6.6.6.2.1.1.3.2.cmml"><mi id="A2.E11.m1.6.6.6.6.2.1.1.3.2.2" xref="A2.E11.m1.6.6.6.6.2.1.1.3.2.2.cmml">R</mi><mo id="A2.E11.m1.6.6.6.6.2.1.1.3.2.1" xref="A2.E11.m1.6.6.6.6.2.1.1.3.2.1.cmml">¯</mo></mover><mi id="A2.E11.m1.6.6.6.6.2.1.1.3.3" xref="A2.E11.m1.6.6.6.6.2.1.1.3.3.cmml">u</mi></msub></mrow><mo id="A2.E11.m1.6.6.6.6.2.1.3" stretchy="false" xref="A2.E11.m1.6.6.6.6.2.1.1.cmml">)</mo></mrow></mrow></mrow><msqrt id="A2.E11.m1.12.12.12" xref="A2.E11.m1.12.12.12.cmml"><mrow id="A2.E11.m1.12.12.12.6.6" xref="A2.E11.m1.12.12.12.6.6.cmml"><msub id="A2.E11.m1.12.12.12.6.6.7" xref="A2.E11.m1.12.12.12.6.6.7.cmml"><mo id="A2.E11.m1.12.12.12.6.6.7.2" xref="A2.E11.m1.12.12.12.6.6.7.2.cmml">∑</mo><mrow id="A2.E11.m1.12.12.12.6.6.7.3" xref="A2.E11.m1.12.12.12.6.6.7.3.cmml"><mi id="A2.E11.m1.12.12.12.6.6.7.3.2" xref="A2.E11.m1.12.12.12.6.6.7.3.2.cmml">u</mi><mo id="A2.E11.m1.12.12.12.6.6.7.3.1" xref="A2.E11.m1.12.12.12.6.6.7.3.1.cmml">∈</mo><mi id="A2.E11.m1.12.12.12.6.6.7.3.3" xref="A2.E11.m1.12.12.12.6.6.7.3.3.cmml">U</mi></mrow></msub><mrow id="A2.E11.m1.12.12.12.6.6.6" xref="A2.E11.m1.12.12.12.6.6.6.cmml"><msup id="A2.E11.m1.11.11.11.5.5.5.1" xref="A2.E11.m1.11.11.11.5.5.5.1.cmml"><mrow id="A2.E11.m1.11.11.11.5.5.5.1.1.1" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.cmml"><mo id="A2.E11.m1.11.11.11.5.5.5.1.1.1.2" lspace="0em" stretchy="false" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.cmml">(</mo><mrow id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.cmml"><msub id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2.cmml"><mi id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2.2" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2.2.cmml">R</mi><mrow id="A2.E11.m1.8.8.8.2.2.2.2.4" xref="A2.E11.m1.8.8.8.2.2.2.2.3.cmml"><mi id="A2.E11.m1.7.7.7.1.1.1.1.1" xref="A2.E11.m1.7.7.7.1.1.1.1.1.cmml">u</mi><mo id="A2.E11.m1.8.8.8.2.2.2.2.4.1" xref="A2.E11.m1.8.8.8.2.2.2.2.3.cmml">,</mo><mi id="A2.E11.m1.8.8.8.2.2.2.2.2" xref="A2.E11.m1.8.8.8.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.1" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.1.cmml">−</mo><msub id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.cmml"><mover accent="true" id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.cmml"><mi id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.2" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.2.cmml">R</mi><mo id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.1" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.3" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="A2.E11.m1.11.11.11.5.5.5.1.1.1.3" rspace="0.055em" stretchy="false" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.cmml">)</mo></mrow><mn id="A2.E11.m1.11.11.11.5.5.5.1.3" xref="A2.E11.m1.11.11.11.5.5.5.1.3.cmml">2</mn></msup><mo id="A2.E11.m1.12.12.12.6.6.6.3" rspace="0.055em" xref="A2.E11.m1.12.12.12.6.6.6.3.cmml">⋅</mo><mrow id="A2.E11.m1.12.12.12.6.6.6.2" xref="A2.E11.m1.12.12.12.6.6.6.2.cmml"><msub id="A2.E11.m1.12.12.12.6.6.6.2.2" xref="A2.E11.m1.12.12.12.6.6.6.2.2.cmml"><mo id="A2.E11.m1.12.12.12.6.6.6.2.2.2" rspace="0em" xref="A2.E11.m1.12.12.12.6.6.6.2.2.2.cmml">∑</mo><mrow id="A2.E11.m1.12.12.12.6.6.6.2.2.3" xref="A2.E11.m1.12.12.12.6.6.6.2.2.3.cmml"><mi id="A2.E11.m1.12.12.12.6.6.6.2.2.3.2" xref="A2.E11.m1.12.12.12.6.6.6.2.2.3.2.cmml">u</mi><mo id="A2.E11.m1.12.12.12.6.6.6.2.2.3.1" xref="A2.E11.m1.12.12.12.6.6.6.2.2.3.1.cmml">∈</mo><mi id="A2.E11.m1.12.12.12.6.6.6.2.2.3.3" xref="A2.E11.m1.12.12.12.6.6.6.2.2.3.3.cmml">U</mi></mrow></msub><msup id="A2.E11.m1.12.12.12.6.6.6.2.1" xref="A2.E11.m1.12.12.12.6.6.6.2.1.cmml"><mrow id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.cmml"><mo id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.2" stretchy="false" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.cmml">(</mo><mrow id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.cmml"><msub id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2.cmml"><mi id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2.2" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2.2.cmml">R</mi><mrow id="A2.E11.m1.10.10.10.4.4.4.2.4" xref="A2.E11.m1.10.10.10.4.4.4.2.3.cmml"><mi id="A2.E11.m1.9.9.9.3.3.3.1.1" xref="A2.E11.m1.9.9.9.3.3.3.1.1.cmml">u</mi><mo id="A2.E11.m1.10.10.10.4.4.4.2.4.1" xref="A2.E11.m1.10.10.10.4.4.4.2.3.cmml">,</mo><mi id="A2.E11.m1.10.10.10.4.4.4.2.2" xref="A2.E11.m1.10.10.10.4.4.4.2.2.cmml">j</mi></mrow></msub><mo id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.1" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.1.cmml">−</mo><msub id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.cmml"><mover accent="true" id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.cmml"><mi id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.2" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.2.cmml">R</mi><mo id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.1" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.3" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.3" stretchy="false" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.cmml">)</mo></mrow><mn id="A2.E11.m1.12.12.12.6.6.6.2.1.3" xref="A2.E11.m1.12.12.12.6.6.6.2.1.3.cmml">2</mn></msup></mrow></mrow></mrow></msqrt></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.E11.m1.14b"><apply id="A2.E11.m1.14.15.cmml" xref="A2.E11.m1.14.15"><eq id="A2.E11.m1.14.15.1.cmml" xref="A2.E11.m1.14.15.1"></eq><apply id="A2.E11.m1.14.15.2.cmml" xref="A2.E11.m1.14.15.2"><times id="A2.E11.m1.14.15.2.1.cmml" xref="A2.E11.m1.14.15.2.1"></times><ci id="A2.E11.m1.14.15.2.2a.cmml" xref="A2.E11.m1.14.15.2.2"><mtext id="A2.E11.m1.14.15.2.2.cmml" xref="A2.E11.m1.14.15.2.2">sim</mtext></ci><interval closure="open" id="A2.E11.m1.14.15.2.3.1.cmml" xref="A2.E11.m1.14.15.2.3.2"><ci id="A2.E11.m1.13.13.cmml" xref="A2.E11.m1.13.13">𝑖</ci><ci id="A2.E11.m1.14.14.cmml" xref="A2.E11.m1.14.14">𝑗</ci></interval></apply><apply id="A2.E11.m1.12.12.cmml" xref="A2.E11.m1.12.12"><divide id="A2.E11.m1.12.12.13.cmml" xref="A2.E11.m1.12.12"></divide><apply id="A2.E11.m1.6.6.6.cmml" xref="A2.E11.m1.6.6.6"><apply id="A2.E11.m1.6.6.6.7.cmml" xref="A2.E11.m1.6.6.6.7"><csymbol cd="ambiguous" id="A2.E11.m1.6.6.6.7.1.cmml" xref="A2.E11.m1.6.6.6.7">subscript</csymbol><sum id="A2.E11.m1.6.6.6.7.2.cmml" xref="A2.E11.m1.6.6.6.7.2"></sum><apply id="A2.E11.m1.6.6.6.7.3.cmml" xref="A2.E11.m1.6.6.6.7.3"><in id="A2.E11.m1.6.6.6.7.3.1.cmml" xref="A2.E11.m1.6.6.6.7.3.1"></in><ci id="A2.E11.m1.6.6.6.7.3.2.cmml" xref="A2.E11.m1.6.6.6.7.3.2">𝑢</ci><ci id="A2.E11.m1.6.6.6.7.3.3.cmml" xref="A2.E11.m1.6.6.6.7.3.3">𝑈</ci></apply></apply><apply id="A2.E11.m1.6.6.6.6.cmml" xref="A2.E11.m1.6.6.6.6"><ci id="A2.E11.m1.6.6.6.6.3.cmml" xref="A2.E11.m1.6.6.6.6.3">⋅</ci><apply id="A2.E11.m1.5.5.5.5.1.1.1.cmml" xref="A2.E11.m1.5.5.5.5.1.1"><minus id="A2.E11.m1.5.5.5.5.1.1.1.1.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.1"></minus><apply id="A2.E11.m1.5.5.5.5.1.1.1.2.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.2"><csymbol cd="ambiguous" id="A2.E11.m1.5.5.5.5.1.1.1.2.1.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.2">subscript</csymbol><ci id="A2.E11.m1.5.5.5.5.1.1.1.2.2.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.2.2">𝑅</ci><list id="A2.E11.m1.2.2.2.2.2.3.cmml" xref="A2.E11.m1.2.2.2.2.2.4"><ci id="A2.E11.m1.1.1.1.1.1.1.cmml" xref="A2.E11.m1.1.1.1.1.1.1">𝑢</ci><ci id="A2.E11.m1.2.2.2.2.2.2.cmml" xref="A2.E11.m1.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="A2.E11.m1.5.5.5.5.1.1.1.3.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.3"><csymbol cd="ambiguous" id="A2.E11.m1.5.5.5.5.1.1.1.3.1.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.3">subscript</csymbol><apply id="A2.E11.m1.5.5.5.5.1.1.1.3.2.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.3.2"><ci id="A2.E11.m1.5.5.5.5.1.1.1.3.2.1.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.3.2.1">¯</ci><ci id="A2.E11.m1.5.5.5.5.1.1.1.3.2.2.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.3.2.2">𝑅</ci></apply><ci id="A2.E11.m1.5.5.5.5.1.1.1.3.3.cmml" xref="A2.E11.m1.5.5.5.5.1.1.1.3.3">𝑢</ci></apply></apply><apply id="A2.E11.m1.6.6.6.6.2.1.1.cmml" xref="A2.E11.m1.6.6.6.6.2.1"><minus id="A2.E11.m1.6.6.6.6.2.1.1.1.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.1"></minus><apply id="A2.E11.m1.6.6.6.6.2.1.1.2.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.2"><csymbol cd="ambiguous" id="A2.E11.m1.6.6.6.6.2.1.1.2.1.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.2">subscript</csymbol><ci id="A2.E11.m1.6.6.6.6.2.1.1.2.2.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.2.2">𝑅</ci><list id="A2.E11.m1.4.4.4.4.2.3.cmml" xref="A2.E11.m1.4.4.4.4.2.4"><ci id="A2.E11.m1.3.3.3.3.1.1.cmml" xref="A2.E11.m1.3.3.3.3.1.1">𝑢</ci><ci id="A2.E11.m1.4.4.4.4.2.2.cmml" xref="A2.E11.m1.4.4.4.4.2.2">𝑗</ci></list></apply><apply id="A2.E11.m1.6.6.6.6.2.1.1.3.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.3"><csymbol cd="ambiguous" id="A2.E11.m1.6.6.6.6.2.1.1.3.1.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.3">subscript</csymbol><apply id="A2.E11.m1.6.6.6.6.2.1.1.3.2.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.3.2"><ci id="A2.E11.m1.6.6.6.6.2.1.1.3.2.1.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.3.2.1">¯</ci><ci id="A2.E11.m1.6.6.6.6.2.1.1.3.2.2.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.3.2.2">𝑅</ci></apply><ci id="A2.E11.m1.6.6.6.6.2.1.1.3.3.cmml" xref="A2.E11.m1.6.6.6.6.2.1.1.3.3">𝑢</ci></apply></apply></apply></apply><apply id="A2.E11.m1.12.12.12.cmml" xref="A2.E11.m1.12.12.12"><root id="A2.E11.m1.12.12.12a.cmml" xref="A2.E11.m1.12.12.12"></root><apply id="A2.E11.m1.12.12.12.6.6.cmml" xref="A2.E11.m1.12.12.12.6.6"><apply id="A2.E11.m1.12.12.12.6.6.7.cmml" xref="A2.E11.m1.12.12.12.6.6.7"><csymbol cd="ambiguous" id="A2.E11.m1.12.12.12.6.6.7.1.cmml" xref="A2.E11.m1.12.12.12.6.6.7">subscript</csymbol><sum id="A2.E11.m1.12.12.12.6.6.7.2.cmml" xref="A2.E11.m1.12.12.12.6.6.7.2"></sum><apply id="A2.E11.m1.12.12.12.6.6.7.3.cmml" xref="A2.E11.m1.12.12.12.6.6.7.3"><in id="A2.E11.m1.12.12.12.6.6.7.3.1.cmml" xref="A2.E11.m1.12.12.12.6.6.7.3.1"></in><ci id="A2.E11.m1.12.12.12.6.6.7.3.2.cmml" xref="A2.E11.m1.12.12.12.6.6.7.3.2">𝑢</ci><ci id="A2.E11.m1.12.12.12.6.6.7.3.3.cmml" xref="A2.E11.m1.12.12.12.6.6.7.3.3">𝑈</ci></apply></apply><apply id="A2.E11.m1.12.12.12.6.6.6.cmml" xref="A2.E11.m1.12.12.12.6.6.6"><ci id="A2.E11.m1.12.12.12.6.6.6.3.cmml" xref="A2.E11.m1.12.12.12.6.6.6.3">⋅</ci><apply id="A2.E11.m1.11.11.11.5.5.5.1.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1"><csymbol cd="ambiguous" id="A2.E11.m1.11.11.11.5.5.5.1.2.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1">superscript</csymbol><apply id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1"><minus id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.1.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.1"></minus><apply id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2.1.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2">subscript</csymbol><ci id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2.2.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.2.2">𝑅</ci><list id="A2.E11.m1.8.8.8.2.2.2.2.3.cmml" xref="A2.E11.m1.8.8.8.2.2.2.2.4"><ci id="A2.E11.m1.7.7.7.1.1.1.1.1.cmml" xref="A2.E11.m1.7.7.7.1.1.1.1.1">𝑢</ci><ci id="A2.E11.m1.8.8.8.2.2.2.2.2.cmml" xref="A2.E11.m1.8.8.8.2.2.2.2.2">𝑖</ci></list></apply><apply id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.1.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3">subscript</csymbol><apply id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2"><ci id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.1.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.1">¯</ci><ci id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.2.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.2.2">𝑅</ci></apply><ci id="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.3.cmml" xref="A2.E11.m1.11.11.11.5.5.5.1.1.1.1.3.3">𝑢</ci></apply></apply><cn id="A2.E11.m1.11.11.11.5.5.5.1.3.cmml" type="integer" xref="A2.E11.m1.11.11.11.5.5.5.1.3">2</cn></apply><apply id="A2.E11.m1.12.12.12.6.6.6.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2"><apply id="A2.E11.m1.12.12.12.6.6.6.2.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.2"><csymbol cd="ambiguous" id="A2.E11.m1.12.12.12.6.6.6.2.2.1.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.2">subscript</csymbol><sum id="A2.E11.m1.12.12.12.6.6.6.2.2.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.2.2"></sum><apply id="A2.E11.m1.12.12.12.6.6.6.2.2.3.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.2.3"><in id="A2.E11.m1.12.12.12.6.6.6.2.2.3.1.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.2.3.1"></in><ci id="A2.E11.m1.12.12.12.6.6.6.2.2.3.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.2.3.2">𝑢</ci><ci id="A2.E11.m1.12.12.12.6.6.6.2.2.3.3.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.2.3.3">𝑈</ci></apply></apply><apply id="A2.E11.m1.12.12.12.6.6.6.2.1.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1"><csymbol cd="ambiguous" id="A2.E11.m1.12.12.12.6.6.6.2.1.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1">superscript</csymbol><apply id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1"><minus id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.1.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.1"></minus><apply id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2.1.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2">subscript</csymbol><ci id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.2.2">𝑅</ci><list id="A2.E11.m1.10.10.10.4.4.4.2.3.cmml" xref="A2.E11.m1.10.10.10.4.4.4.2.4"><ci id="A2.E11.m1.9.9.9.3.3.3.1.1.cmml" xref="A2.E11.m1.9.9.9.3.3.3.1.1">𝑢</ci><ci id="A2.E11.m1.10.10.10.4.4.4.2.2.cmml" xref="A2.E11.m1.10.10.10.4.4.4.2.2">𝑗</ci></list></apply><apply id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.1.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3">subscript</csymbol><apply id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2"><ci id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.1.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.1">¯</ci><ci id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.2.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.2.2">𝑅</ci></apply><ci id="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.3.cmml" xref="A2.E11.m1.12.12.12.6.6.6.2.1.1.1.1.3.3">𝑢</ci></apply></apply><cn id="A2.E11.m1.12.12.12.6.6.6.2.1.3.cmml" type="integer" xref="A2.E11.m1.12.12.12.6.6.6.2.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E11.m1.14c">\text{sim}(i,j)=\frac{\sum_{u\in U}(R_{u,i}-\bar{R}_{u})\cdot(R_{u,j}-\bar{R}_%
{u})}{{\sqrt{\sum_{u\in U}{(R_{u,i}-\bar{R}_{u})^{2}}\cdot{\sum_{u\in U}{(R_{u%
,j}-\bar{R}_{u})^{2}}}}}}</annotation><annotation encoding="application/x-llamapun" id="A2.E11.m1.14d">sim ( italic_i , italic_j ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) ⋅ ( italic_R start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) end_ARG start_ARG square-root start_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p3.7">where <math alttext="R_{u,i}" class="ltx_Math" display="inline" id="A2.p3.1.m1.2"><semantics id="A2.p3.1.m1.2a"><msub id="A2.p3.1.m1.2.3" xref="A2.p3.1.m1.2.3.cmml"><mi id="A2.p3.1.m1.2.3.2" xref="A2.p3.1.m1.2.3.2.cmml">R</mi><mrow id="A2.p3.1.m1.2.2.2.4" xref="A2.p3.1.m1.2.2.2.3.cmml"><mi id="A2.p3.1.m1.1.1.1.1" xref="A2.p3.1.m1.1.1.1.1.cmml">u</mi><mo id="A2.p3.1.m1.2.2.2.4.1" xref="A2.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="A2.p3.1.m1.2.2.2.2" xref="A2.p3.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.p3.1.m1.2b"><apply id="A2.p3.1.m1.2.3.cmml" xref="A2.p3.1.m1.2.3"><csymbol cd="ambiguous" id="A2.p3.1.m1.2.3.1.cmml" xref="A2.p3.1.m1.2.3">subscript</csymbol><ci id="A2.p3.1.m1.2.3.2.cmml" xref="A2.p3.1.m1.2.3.2">𝑅</ci><list id="A2.p3.1.m1.2.2.2.3.cmml" xref="A2.p3.1.m1.2.2.2.4"><ci id="A2.p3.1.m1.1.1.1.1.cmml" xref="A2.p3.1.m1.1.1.1.1">𝑢</ci><ci id="A2.p3.1.m1.2.2.2.2.cmml" xref="A2.p3.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.1.m1.2c">R_{u,i}</annotation><annotation encoding="application/x-llamapun" id="A2.p3.1.m1.2d">italic_R start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="R_{u,j}" class="ltx_Math" display="inline" id="A2.p3.2.m2.2"><semantics id="A2.p3.2.m2.2a"><msub id="A2.p3.2.m2.2.3" xref="A2.p3.2.m2.2.3.cmml"><mi id="A2.p3.2.m2.2.3.2" xref="A2.p3.2.m2.2.3.2.cmml">R</mi><mrow id="A2.p3.2.m2.2.2.2.4" xref="A2.p3.2.m2.2.2.2.3.cmml"><mi id="A2.p3.2.m2.1.1.1.1" xref="A2.p3.2.m2.1.1.1.1.cmml">u</mi><mo id="A2.p3.2.m2.2.2.2.4.1" xref="A2.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="A2.p3.2.m2.2.2.2.2" xref="A2.p3.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.p3.2.m2.2b"><apply id="A2.p3.2.m2.2.3.cmml" xref="A2.p3.2.m2.2.3"><csymbol cd="ambiguous" id="A2.p3.2.m2.2.3.1.cmml" xref="A2.p3.2.m2.2.3">subscript</csymbol><ci id="A2.p3.2.m2.2.3.2.cmml" xref="A2.p3.2.m2.2.3.2">𝑅</ci><list id="A2.p3.2.m2.2.2.2.3.cmml" xref="A2.p3.2.m2.2.2.2.4"><ci id="A2.p3.2.m2.1.1.1.1.cmml" xref="A2.p3.2.m2.1.1.1.1">𝑢</ci><ci id="A2.p3.2.m2.2.2.2.2.cmml" xref="A2.p3.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.2.m2.2c">R_{u,j}</annotation><annotation encoding="application/x-llamapun" id="A2.p3.2.m2.2d">italic_R start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denote user <math alttext="u" class="ltx_Math" display="inline" id="A2.p3.3.m3.1"><semantics id="A2.p3.3.m3.1a"><mi id="A2.p3.3.m3.1.1" xref="A2.p3.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A2.p3.3.m3.1b"><ci id="A2.p3.3.m3.1.1.cmml" xref="A2.p3.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="A2.p3.3.m3.1d">italic_u</annotation></semantics></math>’s ratings for items <math alttext="i" class="ltx_Math" display="inline" id="A2.p3.4.m4.1"><semantics id="A2.p3.4.m4.1a"><mi id="A2.p3.4.m4.1.1" xref="A2.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.p3.4.m4.1b"><ci id="A2.p3.4.m4.1.1.cmml" xref="A2.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.p3.4.m4.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="A2.p3.5.m5.1"><semantics id="A2.p3.5.m5.1a"><mi id="A2.p3.5.m5.1.1" xref="A2.p3.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A2.p3.5.m5.1b"><ci id="A2.p3.5.m5.1.1.cmml" xref="A2.p3.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="A2.p3.5.m5.1d">italic_j</annotation></semantics></math>, respectively, while <math alttext="\bar{R}_{u}" class="ltx_Math" display="inline" id="A2.p3.6.m6.1"><semantics id="A2.p3.6.m6.1a"><msub id="A2.p3.6.m6.1.1" xref="A2.p3.6.m6.1.1.cmml"><mover accent="true" id="A2.p3.6.m6.1.1.2" xref="A2.p3.6.m6.1.1.2.cmml"><mi id="A2.p3.6.m6.1.1.2.2" xref="A2.p3.6.m6.1.1.2.2.cmml">R</mi><mo id="A2.p3.6.m6.1.1.2.1" xref="A2.p3.6.m6.1.1.2.1.cmml">¯</mo></mover><mi id="A2.p3.6.m6.1.1.3" xref="A2.p3.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p3.6.m6.1b"><apply id="A2.p3.6.m6.1.1.cmml" xref="A2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="A2.p3.6.m6.1.1.1.cmml" xref="A2.p3.6.m6.1.1">subscript</csymbol><apply id="A2.p3.6.m6.1.1.2.cmml" xref="A2.p3.6.m6.1.1.2"><ci id="A2.p3.6.m6.1.1.2.1.cmml" xref="A2.p3.6.m6.1.1.2.1">¯</ci><ci id="A2.p3.6.m6.1.1.2.2.cmml" xref="A2.p3.6.m6.1.1.2.2">𝑅</ci></apply><ci id="A2.p3.6.m6.1.1.3.cmml" xref="A2.p3.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.6.m6.1c">\bar{R}_{u}</annotation><annotation encoding="application/x-llamapun" id="A2.p3.6.m6.1d">over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is user <math alttext="u" class="ltx_Math" display="inline" id="A2.p3.7.m7.1"><semantics id="A2.p3.7.m7.1a"><mi id="A2.p3.7.m7.1.1" xref="A2.p3.7.m7.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A2.p3.7.m7.1b"><ci id="A2.p3.7.m7.1.1.cmml" xref="A2.p3.7.m7.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.7.m7.1c">u</annotation><annotation encoding="application/x-llamapun" id="A2.p3.7.m7.1d">italic_u</annotation></semantics></math>’s average rating. To enhance computational efficiency, especially for large-scale datasets, we precalculate the rating deviation sums and squared sums for each item and user:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{sim}^{\prime}(i,j)=\frac{\text{Dev}(i)\cdot\text{Dev}(j)}{\sqrt{\text{%
DevS}(i)}\cdot\sqrt{\text{DevS}(j)}}" class="ltx_Math" display="block" id="A2.E12.m1.6"><semantics id="A2.E12.m1.6a"><mrow id="A2.E12.m1.6.7" xref="A2.E12.m1.6.7.cmml"><mrow id="A2.E12.m1.6.7.2" xref="A2.E12.m1.6.7.2.cmml"><msup id="A2.E12.m1.6.7.2.2" xref="A2.E12.m1.6.7.2.2.cmml"><mtext id="A2.E12.m1.6.7.2.2.2" xref="A2.E12.m1.6.7.2.2.2a.cmml">sim</mtext><mo id="A2.E12.m1.6.7.2.2.3" xref="A2.E12.m1.6.7.2.2.3.cmml">′</mo></msup><mo id="A2.E12.m1.6.7.2.1" xref="A2.E12.m1.6.7.2.1.cmml">⁢</mo><mrow id="A2.E12.m1.6.7.2.3.2" xref="A2.E12.m1.6.7.2.3.1.cmml"><mo id="A2.E12.m1.6.7.2.3.2.1" stretchy="false" xref="A2.E12.m1.6.7.2.3.1.cmml">(</mo><mi id="A2.E12.m1.5.5" xref="A2.E12.m1.5.5.cmml">i</mi><mo id="A2.E12.m1.6.7.2.3.2.2" xref="A2.E12.m1.6.7.2.3.1.cmml">,</mo><mi id="A2.E12.m1.6.6" xref="A2.E12.m1.6.6.cmml">j</mi><mo id="A2.E12.m1.6.7.2.3.2.3" stretchy="false" xref="A2.E12.m1.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="A2.E12.m1.6.7.1" xref="A2.E12.m1.6.7.1.cmml">=</mo><mfrac id="A2.E12.m1.4.4" xref="A2.E12.m1.4.4.cmml"><mrow id="A2.E12.m1.2.2.2" xref="A2.E12.m1.2.2.2.cmml"><mrow id="A2.E12.m1.2.2.2.4" xref="A2.E12.m1.2.2.2.4.cmml"><mrow id="A2.E12.m1.2.2.2.4.2" xref="A2.E12.m1.2.2.2.4.2.cmml"><mtext id="A2.E12.m1.2.2.2.4.2.2" xref="A2.E12.m1.2.2.2.4.2.2a.cmml">Dev</mtext><mo id="A2.E12.m1.2.2.2.4.2.1" xref="A2.E12.m1.2.2.2.4.2.1.cmml">⁢</mo><mrow id="A2.E12.m1.2.2.2.4.2.3.2" xref="A2.E12.m1.2.2.2.4.2.cmml"><mo id="A2.E12.m1.2.2.2.4.2.3.2.1" stretchy="false" xref="A2.E12.m1.2.2.2.4.2.cmml">(</mo><mi id="A2.E12.m1.1.1.1.1" xref="A2.E12.m1.1.1.1.1.cmml">i</mi><mo id="A2.E12.m1.2.2.2.4.2.3.2.2" rspace="0.055em" stretchy="false" xref="A2.E12.m1.2.2.2.4.2.cmml">)</mo></mrow></mrow><mo id="A2.E12.m1.2.2.2.4.1" rspace="0.222em" xref="A2.E12.m1.2.2.2.4.1.cmml">⋅</mo><mtext id="A2.E12.m1.2.2.2.4.3" xref="A2.E12.m1.2.2.2.4.3a.cmml">Dev</mtext></mrow><mo id="A2.E12.m1.2.2.2.3" xref="A2.E12.m1.2.2.2.3.cmml">⁢</mo><mrow id="A2.E12.m1.2.2.2.5.2" xref="A2.E12.m1.2.2.2.cmml"><mo id="A2.E12.m1.2.2.2.5.2.1" stretchy="false" xref="A2.E12.m1.2.2.2.cmml">(</mo><mi id="A2.E12.m1.2.2.2.2" xref="A2.E12.m1.2.2.2.2.cmml">j</mi><mo id="A2.E12.m1.2.2.2.5.2.2" stretchy="false" xref="A2.E12.m1.2.2.2.cmml">)</mo></mrow></mrow><mrow id="A2.E12.m1.4.4.4" xref="A2.E12.m1.4.4.4.cmml"><msqrt id="A2.E12.m1.3.3.3.1" xref="A2.E12.m1.3.3.3.1.cmml"><mrow id="A2.E12.m1.3.3.3.1.1" xref="A2.E12.m1.3.3.3.1.1.cmml"><mtext id="A2.E12.m1.3.3.3.1.1.3" xref="A2.E12.m1.3.3.3.1.1.3a.cmml">DevS</mtext><mo id="A2.E12.m1.3.3.3.1.1.2" xref="A2.E12.m1.3.3.3.1.1.2.cmml">⁢</mo><mrow id="A2.E12.m1.3.3.3.1.1.4.2" xref="A2.E12.m1.3.3.3.1.1.cmml"><mo id="A2.E12.m1.3.3.3.1.1.4.2.1" stretchy="false" xref="A2.E12.m1.3.3.3.1.1.cmml">(</mo><mi id="A2.E12.m1.3.3.3.1.1.1" xref="A2.E12.m1.3.3.3.1.1.1.cmml">i</mi><mo id="A2.E12.m1.3.3.3.1.1.4.2.2" stretchy="false" xref="A2.E12.m1.3.3.3.1.1.cmml">)</mo></mrow></mrow></msqrt><mo id="A2.E12.m1.4.4.4.3" lspace="0.222em" rspace="0.222em" xref="A2.E12.m1.4.4.4.3.cmml">⋅</mo><msqrt id="A2.E12.m1.4.4.4.2" xref="A2.E12.m1.4.4.4.2.cmml"><mrow id="A2.E12.m1.4.4.4.2.1" xref="A2.E12.m1.4.4.4.2.1.cmml"><mtext id="A2.E12.m1.4.4.4.2.1.3" xref="A2.E12.m1.4.4.4.2.1.3a.cmml">DevS</mtext><mo id="A2.E12.m1.4.4.4.2.1.2" xref="A2.E12.m1.4.4.4.2.1.2.cmml">⁢</mo><mrow id="A2.E12.m1.4.4.4.2.1.4.2" xref="A2.E12.m1.4.4.4.2.1.cmml"><mo id="A2.E12.m1.4.4.4.2.1.4.2.1" stretchy="false" xref="A2.E12.m1.4.4.4.2.1.cmml">(</mo><mi id="A2.E12.m1.4.4.4.2.1.1" xref="A2.E12.m1.4.4.4.2.1.1.cmml">j</mi><mo id="A2.E12.m1.4.4.4.2.1.4.2.2" stretchy="false" xref="A2.E12.m1.4.4.4.2.1.cmml">)</mo></mrow></mrow></msqrt></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.E12.m1.6b"><apply id="A2.E12.m1.6.7.cmml" xref="A2.E12.m1.6.7"><eq id="A2.E12.m1.6.7.1.cmml" xref="A2.E12.m1.6.7.1"></eq><apply id="A2.E12.m1.6.7.2.cmml" xref="A2.E12.m1.6.7.2"><times id="A2.E12.m1.6.7.2.1.cmml" xref="A2.E12.m1.6.7.2.1"></times><apply id="A2.E12.m1.6.7.2.2.cmml" xref="A2.E12.m1.6.7.2.2"><csymbol cd="ambiguous" id="A2.E12.m1.6.7.2.2.1.cmml" xref="A2.E12.m1.6.7.2.2">superscript</csymbol><ci id="A2.E12.m1.6.7.2.2.2a.cmml" xref="A2.E12.m1.6.7.2.2.2"><mtext id="A2.E12.m1.6.7.2.2.2.cmml" xref="A2.E12.m1.6.7.2.2.2">sim</mtext></ci><ci id="A2.E12.m1.6.7.2.2.3.cmml" xref="A2.E12.m1.6.7.2.2.3">′</ci></apply><interval closure="open" id="A2.E12.m1.6.7.2.3.1.cmml" xref="A2.E12.m1.6.7.2.3.2"><ci id="A2.E12.m1.5.5.cmml" xref="A2.E12.m1.5.5">𝑖</ci><ci id="A2.E12.m1.6.6.cmml" xref="A2.E12.m1.6.6">𝑗</ci></interval></apply><apply id="A2.E12.m1.4.4.cmml" xref="A2.E12.m1.4.4"><divide id="A2.E12.m1.4.4.5.cmml" xref="A2.E12.m1.4.4"></divide><apply id="A2.E12.m1.2.2.2.cmml" xref="A2.E12.m1.2.2.2"><times id="A2.E12.m1.2.2.2.3.cmml" xref="A2.E12.m1.2.2.2.3"></times><apply id="A2.E12.m1.2.2.2.4.cmml" xref="A2.E12.m1.2.2.2.4"><ci id="A2.E12.m1.2.2.2.4.1.cmml" xref="A2.E12.m1.2.2.2.4.1">⋅</ci><apply id="A2.E12.m1.2.2.2.4.2.cmml" xref="A2.E12.m1.2.2.2.4.2"><times id="A2.E12.m1.2.2.2.4.2.1.cmml" xref="A2.E12.m1.2.2.2.4.2.1"></times><ci id="A2.E12.m1.2.2.2.4.2.2a.cmml" xref="A2.E12.m1.2.2.2.4.2.2"><mtext id="A2.E12.m1.2.2.2.4.2.2.cmml" xref="A2.E12.m1.2.2.2.4.2.2">Dev</mtext></ci><ci id="A2.E12.m1.1.1.1.1.cmml" xref="A2.E12.m1.1.1.1.1">𝑖</ci></apply><ci id="A2.E12.m1.2.2.2.4.3a.cmml" xref="A2.E12.m1.2.2.2.4.3"><mtext id="A2.E12.m1.2.2.2.4.3.cmml" xref="A2.E12.m1.2.2.2.4.3">Dev</mtext></ci></apply><ci id="A2.E12.m1.2.2.2.2.cmml" xref="A2.E12.m1.2.2.2.2">𝑗</ci></apply><apply id="A2.E12.m1.4.4.4.cmml" xref="A2.E12.m1.4.4.4"><ci id="A2.E12.m1.4.4.4.3.cmml" xref="A2.E12.m1.4.4.4.3">⋅</ci><apply id="A2.E12.m1.3.3.3.1.cmml" xref="A2.E12.m1.3.3.3.1"><root id="A2.E12.m1.3.3.3.1a.cmml" xref="A2.E12.m1.3.3.3.1"></root><apply id="A2.E12.m1.3.3.3.1.1.cmml" xref="A2.E12.m1.3.3.3.1.1"><times id="A2.E12.m1.3.3.3.1.1.2.cmml" xref="A2.E12.m1.3.3.3.1.1.2"></times><ci id="A2.E12.m1.3.3.3.1.1.3a.cmml" xref="A2.E12.m1.3.3.3.1.1.3"><mtext id="A2.E12.m1.3.3.3.1.1.3.cmml" xref="A2.E12.m1.3.3.3.1.1.3">DevS</mtext></ci><ci id="A2.E12.m1.3.3.3.1.1.1.cmml" xref="A2.E12.m1.3.3.3.1.1.1">𝑖</ci></apply></apply><apply id="A2.E12.m1.4.4.4.2.cmml" xref="A2.E12.m1.4.4.4.2"><root id="A2.E12.m1.4.4.4.2a.cmml" xref="A2.E12.m1.4.4.4.2"></root><apply id="A2.E12.m1.4.4.4.2.1.cmml" xref="A2.E12.m1.4.4.4.2.1"><times id="A2.E12.m1.4.4.4.2.1.2.cmml" xref="A2.E12.m1.4.4.4.2.1.2"></times><ci id="A2.E12.m1.4.4.4.2.1.3a.cmml" xref="A2.E12.m1.4.4.4.2.1.3"><mtext id="A2.E12.m1.4.4.4.2.1.3.cmml" xref="A2.E12.m1.4.4.4.2.1.3">DevS</mtext></ci><ci id="A2.E12.m1.4.4.4.2.1.1.cmml" xref="A2.E12.m1.4.4.4.2.1.1">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E12.m1.6c">\text{sim}^{\prime}(i,j)=\frac{\text{Dev}(i)\cdot\text{Dev}(j)}{\sqrt{\text{%
DevS}(i)}\cdot\sqrt{\text{DevS}(j)}}</annotation><annotation encoding="application/x-llamapun" id="A2.E12.m1.6d">sim start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_i , italic_j ) = divide start_ARG Dev ( italic_i ) ⋅ Dev ( italic_j ) end_ARG start_ARG square-root start_ARG DevS ( italic_i ) end_ARG ⋅ square-root start_ARG DevS ( italic_j ) end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p3.9">where the rating deviation sums and squared sums for each item is:</p>
<table class="ltx_equation ltx_eqn_table" id="A2.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Dev}(i)=\sum_{u\in U_{i}}(R_{u,i}-\bar{R}_{u}),\ \text{DevS}(i)=\sum_{u%
\in U_{i}}(R_{u,i}-\bar{R}_{u})^{2}" class="ltx_Math" display="block" id="A2.E13.m1.8"><semantics id="A2.E13.m1.8a"><mrow id="A2.E13.m1.8.8.2" xref="A2.E13.m1.8.8.3.cmml"><mrow id="A2.E13.m1.7.7.1.1" xref="A2.E13.m1.7.7.1.1.cmml"><mrow id="A2.E13.m1.7.7.1.1.3" xref="A2.E13.m1.7.7.1.1.3.cmml"><mtext id="A2.E13.m1.7.7.1.1.3.2" xref="A2.E13.m1.7.7.1.1.3.2a.cmml">Dev</mtext><mo id="A2.E13.m1.7.7.1.1.3.1" xref="A2.E13.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="A2.E13.m1.7.7.1.1.3.3.2" xref="A2.E13.m1.7.7.1.1.3.cmml"><mo id="A2.E13.m1.7.7.1.1.3.3.2.1" stretchy="false" xref="A2.E13.m1.7.7.1.1.3.cmml">(</mo><mi id="A2.E13.m1.5.5" xref="A2.E13.m1.5.5.cmml">i</mi><mo id="A2.E13.m1.7.7.1.1.3.3.2.2" stretchy="false" xref="A2.E13.m1.7.7.1.1.3.cmml">)</mo></mrow></mrow><mo id="A2.E13.m1.7.7.1.1.2" rspace="0.111em" xref="A2.E13.m1.7.7.1.1.2.cmml">=</mo><mrow id="A2.E13.m1.7.7.1.1.1" xref="A2.E13.m1.7.7.1.1.1.cmml"><munder id="A2.E13.m1.7.7.1.1.1.2" xref="A2.E13.m1.7.7.1.1.1.2.cmml"><mo id="A2.E13.m1.7.7.1.1.1.2.2" movablelimits="false" rspace="0em" xref="A2.E13.m1.7.7.1.1.1.2.2.cmml">∑</mo><mrow id="A2.E13.m1.7.7.1.1.1.2.3" xref="A2.E13.m1.7.7.1.1.1.2.3.cmml"><mi id="A2.E13.m1.7.7.1.1.1.2.3.2" xref="A2.E13.m1.7.7.1.1.1.2.3.2.cmml">u</mi><mo id="A2.E13.m1.7.7.1.1.1.2.3.1" xref="A2.E13.m1.7.7.1.1.1.2.3.1.cmml">∈</mo><msub id="A2.E13.m1.7.7.1.1.1.2.3.3" xref="A2.E13.m1.7.7.1.1.1.2.3.3.cmml"><mi id="A2.E13.m1.7.7.1.1.1.2.3.3.2" xref="A2.E13.m1.7.7.1.1.1.2.3.3.2.cmml">U</mi><mi id="A2.E13.m1.7.7.1.1.1.2.3.3.3" xref="A2.E13.m1.7.7.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="A2.E13.m1.7.7.1.1.1.1.1" xref="A2.E13.m1.7.7.1.1.1.1.1.1.cmml"><mo id="A2.E13.m1.7.7.1.1.1.1.1.2" stretchy="false" xref="A2.E13.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E13.m1.7.7.1.1.1.1.1.1" xref="A2.E13.m1.7.7.1.1.1.1.1.1.cmml"><msub id="A2.E13.m1.7.7.1.1.1.1.1.1.2" xref="A2.E13.m1.7.7.1.1.1.1.1.1.2.cmml"><mi id="A2.E13.m1.7.7.1.1.1.1.1.1.2.2" xref="A2.E13.m1.7.7.1.1.1.1.1.1.2.2.cmml">R</mi><mrow id="A2.E13.m1.2.2.2.4" xref="A2.E13.m1.2.2.2.3.cmml"><mi id="A2.E13.m1.1.1.1.1" xref="A2.E13.m1.1.1.1.1.cmml">u</mi><mo id="A2.E13.m1.2.2.2.4.1" xref="A2.E13.m1.2.2.2.3.cmml">,</mo><mi id="A2.E13.m1.2.2.2.2" xref="A2.E13.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="A2.E13.m1.7.7.1.1.1.1.1.1.1" xref="A2.E13.m1.7.7.1.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E13.m1.7.7.1.1.1.1.1.1.3" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.cmml"><mover accent="true" id="A2.E13.m1.7.7.1.1.1.1.1.1.3.2" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.cmml"><mi id="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.2" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.2.cmml">R</mi><mo id="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.1" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="A2.E13.m1.7.7.1.1.1.1.1.1.3.3" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="A2.E13.m1.7.7.1.1.1.1.1.3" stretchy="false" xref="A2.E13.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E13.m1.8.8.2.3" rspace="0.667em" xref="A2.E13.m1.8.8.3a.cmml">,</mo><mrow id="A2.E13.m1.8.8.2.2" xref="A2.E13.m1.8.8.2.2.cmml"><mrow id="A2.E13.m1.8.8.2.2.3" xref="A2.E13.m1.8.8.2.2.3.cmml"><mtext id="A2.E13.m1.8.8.2.2.3.2" xref="A2.E13.m1.8.8.2.2.3.2a.cmml">DevS</mtext><mo id="A2.E13.m1.8.8.2.2.3.1" xref="A2.E13.m1.8.8.2.2.3.1.cmml">⁢</mo><mrow id="A2.E13.m1.8.8.2.2.3.3.2" xref="A2.E13.m1.8.8.2.2.3.cmml"><mo id="A2.E13.m1.8.8.2.2.3.3.2.1" stretchy="false" xref="A2.E13.m1.8.8.2.2.3.cmml">(</mo><mi id="A2.E13.m1.6.6" xref="A2.E13.m1.6.6.cmml">i</mi><mo id="A2.E13.m1.8.8.2.2.3.3.2.2" stretchy="false" xref="A2.E13.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow><mo id="A2.E13.m1.8.8.2.2.2" rspace="0.111em" xref="A2.E13.m1.8.8.2.2.2.cmml">=</mo><mrow id="A2.E13.m1.8.8.2.2.1" xref="A2.E13.m1.8.8.2.2.1.cmml"><munder id="A2.E13.m1.8.8.2.2.1.2" xref="A2.E13.m1.8.8.2.2.1.2.cmml"><mo id="A2.E13.m1.8.8.2.2.1.2.2" movablelimits="false" rspace="0em" xref="A2.E13.m1.8.8.2.2.1.2.2.cmml">∑</mo><mrow id="A2.E13.m1.8.8.2.2.1.2.3" xref="A2.E13.m1.8.8.2.2.1.2.3.cmml"><mi id="A2.E13.m1.8.8.2.2.1.2.3.2" xref="A2.E13.m1.8.8.2.2.1.2.3.2.cmml">u</mi><mo id="A2.E13.m1.8.8.2.2.1.2.3.1" xref="A2.E13.m1.8.8.2.2.1.2.3.1.cmml">∈</mo><msub id="A2.E13.m1.8.8.2.2.1.2.3.3" xref="A2.E13.m1.8.8.2.2.1.2.3.3.cmml"><mi id="A2.E13.m1.8.8.2.2.1.2.3.3.2" xref="A2.E13.m1.8.8.2.2.1.2.3.3.2.cmml">U</mi><mi id="A2.E13.m1.8.8.2.2.1.2.3.3.3" xref="A2.E13.m1.8.8.2.2.1.2.3.3.3.cmml">i</mi></msub></mrow></munder><msup id="A2.E13.m1.8.8.2.2.1.1" xref="A2.E13.m1.8.8.2.2.1.1.cmml"><mrow id="A2.E13.m1.8.8.2.2.1.1.1.1" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.cmml"><mo id="A2.E13.m1.8.8.2.2.1.1.1.1.2" stretchy="false" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A2.E13.m1.8.8.2.2.1.1.1.1.1" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.cmml"><msub id="A2.E13.m1.8.8.2.2.1.1.1.1.1.2" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.2.cmml"><mi id="A2.E13.m1.8.8.2.2.1.1.1.1.1.2.2" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.2.2.cmml">R</mi><mrow id="A2.E13.m1.4.4.2.4" xref="A2.E13.m1.4.4.2.3.cmml"><mi id="A2.E13.m1.3.3.1.1" xref="A2.E13.m1.3.3.1.1.cmml">u</mi><mo id="A2.E13.m1.4.4.2.4.1" xref="A2.E13.m1.4.4.2.3.cmml">,</mo><mi id="A2.E13.m1.4.4.2.2" xref="A2.E13.m1.4.4.2.2.cmml">i</mi></mrow></msub><mo id="A2.E13.m1.8.8.2.2.1.1.1.1.1.1" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.cmml"><mover accent="true" id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.cmml"><mi id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.2" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.2.cmml">R</mi><mo id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.1" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.3" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="A2.E13.m1.8.8.2.2.1.1.1.1.3" stretchy="false" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.cmml">)</mo></mrow><mn id="A2.E13.m1.8.8.2.2.1.1.3" xref="A2.E13.m1.8.8.2.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E13.m1.8b"><apply id="A2.E13.m1.8.8.3.cmml" xref="A2.E13.m1.8.8.2"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.3a.cmml" xref="A2.E13.m1.8.8.2.3">formulae-sequence</csymbol><apply id="A2.E13.m1.7.7.1.1.cmml" xref="A2.E13.m1.7.7.1.1"><eq id="A2.E13.m1.7.7.1.1.2.cmml" xref="A2.E13.m1.7.7.1.1.2"></eq><apply id="A2.E13.m1.7.7.1.1.3.cmml" xref="A2.E13.m1.7.7.1.1.3"><times id="A2.E13.m1.7.7.1.1.3.1.cmml" xref="A2.E13.m1.7.7.1.1.3.1"></times><ci id="A2.E13.m1.7.7.1.1.3.2a.cmml" xref="A2.E13.m1.7.7.1.1.3.2"><mtext id="A2.E13.m1.7.7.1.1.3.2.cmml" xref="A2.E13.m1.7.7.1.1.3.2">Dev</mtext></ci><ci id="A2.E13.m1.5.5.cmml" xref="A2.E13.m1.5.5">𝑖</ci></apply><apply id="A2.E13.m1.7.7.1.1.1.cmml" xref="A2.E13.m1.7.7.1.1.1"><apply id="A2.E13.m1.7.7.1.1.1.2.cmml" xref="A2.E13.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="A2.E13.m1.7.7.1.1.1.2.1.cmml" xref="A2.E13.m1.7.7.1.1.1.2">subscript</csymbol><sum id="A2.E13.m1.7.7.1.1.1.2.2.cmml" xref="A2.E13.m1.7.7.1.1.1.2.2"></sum><apply id="A2.E13.m1.7.7.1.1.1.2.3.cmml" xref="A2.E13.m1.7.7.1.1.1.2.3"><in id="A2.E13.m1.7.7.1.1.1.2.3.1.cmml" xref="A2.E13.m1.7.7.1.1.1.2.3.1"></in><ci id="A2.E13.m1.7.7.1.1.1.2.3.2.cmml" xref="A2.E13.m1.7.7.1.1.1.2.3.2">𝑢</ci><apply id="A2.E13.m1.7.7.1.1.1.2.3.3.cmml" xref="A2.E13.m1.7.7.1.1.1.2.3.3"><csymbol cd="ambiguous" id="A2.E13.m1.7.7.1.1.1.2.3.3.1.cmml" xref="A2.E13.m1.7.7.1.1.1.2.3.3">subscript</csymbol><ci id="A2.E13.m1.7.7.1.1.1.2.3.3.2.cmml" xref="A2.E13.m1.7.7.1.1.1.2.3.3.2">𝑈</ci><ci id="A2.E13.m1.7.7.1.1.1.2.3.3.3.cmml" xref="A2.E13.m1.7.7.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="A2.E13.m1.7.7.1.1.1.1.1.1.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1"><minus id="A2.E13.m1.7.7.1.1.1.1.1.1.1.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.1"></minus><apply id="A2.E13.m1.7.7.1.1.1.1.1.1.2.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E13.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E13.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.2.2">𝑅</ci><list id="A2.E13.m1.2.2.2.3.cmml" xref="A2.E13.m1.2.2.2.4"><ci id="A2.E13.m1.1.1.1.1.cmml" xref="A2.E13.m1.1.1.1.1">𝑢</ci><ci id="A2.E13.m1.2.2.2.2.cmml" xref="A2.E13.m1.2.2.2.2">𝑖</ci></list></apply><apply id="A2.E13.m1.7.7.1.1.1.1.1.1.3.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E13.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3">subscript</csymbol><apply id="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.2"><ci id="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.1.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.1">¯</ci><ci id="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.2.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.2.2">𝑅</ci></apply><ci id="A2.E13.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="A2.E13.m1.7.7.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply></apply><apply id="A2.E13.m1.8.8.2.2.cmml" xref="A2.E13.m1.8.8.2.2"><eq id="A2.E13.m1.8.8.2.2.2.cmml" xref="A2.E13.m1.8.8.2.2.2"></eq><apply id="A2.E13.m1.8.8.2.2.3.cmml" xref="A2.E13.m1.8.8.2.2.3"><times id="A2.E13.m1.8.8.2.2.3.1.cmml" xref="A2.E13.m1.8.8.2.2.3.1"></times><ci id="A2.E13.m1.8.8.2.2.3.2a.cmml" xref="A2.E13.m1.8.8.2.2.3.2"><mtext id="A2.E13.m1.8.8.2.2.3.2.cmml" xref="A2.E13.m1.8.8.2.2.3.2">DevS</mtext></ci><ci id="A2.E13.m1.6.6.cmml" xref="A2.E13.m1.6.6">𝑖</ci></apply><apply id="A2.E13.m1.8.8.2.2.1.cmml" xref="A2.E13.m1.8.8.2.2.1"><apply id="A2.E13.m1.8.8.2.2.1.2.cmml" xref="A2.E13.m1.8.8.2.2.1.2"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.2.2.1.2.1.cmml" xref="A2.E13.m1.8.8.2.2.1.2">subscript</csymbol><sum id="A2.E13.m1.8.8.2.2.1.2.2.cmml" xref="A2.E13.m1.8.8.2.2.1.2.2"></sum><apply id="A2.E13.m1.8.8.2.2.1.2.3.cmml" xref="A2.E13.m1.8.8.2.2.1.2.3"><in id="A2.E13.m1.8.8.2.2.1.2.3.1.cmml" xref="A2.E13.m1.8.8.2.2.1.2.3.1"></in><ci id="A2.E13.m1.8.8.2.2.1.2.3.2.cmml" xref="A2.E13.m1.8.8.2.2.1.2.3.2">𝑢</ci><apply id="A2.E13.m1.8.8.2.2.1.2.3.3.cmml" xref="A2.E13.m1.8.8.2.2.1.2.3.3"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.2.2.1.2.3.3.1.cmml" xref="A2.E13.m1.8.8.2.2.1.2.3.3">subscript</csymbol><ci id="A2.E13.m1.8.8.2.2.1.2.3.3.2.cmml" xref="A2.E13.m1.8.8.2.2.1.2.3.3.2">𝑈</ci><ci id="A2.E13.m1.8.8.2.2.1.2.3.3.3.cmml" xref="A2.E13.m1.8.8.2.2.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="A2.E13.m1.8.8.2.2.1.1.cmml" xref="A2.E13.m1.8.8.2.2.1.1"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.2.2.1.1.2.cmml" xref="A2.E13.m1.8.8.2.2.1.1">superscript</csymbol><apply id="A2.E13.m1.8.8.2.2.1.1.1.1.1.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1"><minus id="A2.E13.m1.8.8.2.2.1.1.1.1.1.1.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.1"></minus><apply id="A2.E13.m1.8.8.2.2.1.1.1.1.1.2.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.2.2.1.1.1.1.1.2.1.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="A2.E13.m1.8.8.2.2.1.1.1.1.1.2.2.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.2.2">𝑅</ci><list id="A2.E13.m1.4.4.2.3.cmml" xref="A2.E13.m1.4.4.2.4"><ci id="A2.E13.m1.3.3.1.1.cmml" xref="A2.E13.m1.3.3.1.1">𝑢</ci><ci id="A2.E13.m1.4.4.2.2.cmml" xref="A2.E13.m1.4.4.2.2">𝑖</ci></list></apply><apply id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.1.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3">subscript</csymbol><apply id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2"><ci id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.1.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.1">¯</ci><ci id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.2.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.2.2">𝑅</ci></apply><ci id="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.3.cmml" xref="A2.E13.m1.8.8.2.2.1.1.1.1.1.3.3">𝑢</ci></apply></apply><cn id="A2.E13.m1.8.8.2.2.1.1.3.cmml" type="integer" xref="A2.E13.m1.8.8.2.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E13.m1.8c">\text{Dev}(i)=\sum_{u\in U_{i}}(R_{u,i}-\bar{R}_{u}),\ \text{DevS}(i)=\sum_{u%
\in U_{i}}(R_{u,i}-\bar{R}_{u})^{2}</annotation><annotation encoding="application/x-llamapun" id="A2.E13.m1.8d">Dev ( italic_i ) = ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) , DevS ( italic_i ) = ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_R start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT - over¯ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A2.p4">
<p class="ltx_p" id="A2.p4.2">This approach reduces complexity from <math alttext="O(|U|\cdot|I|^{2})" class="ltx_Math" display="inline" id="A2.p4.1.m1.3"><semantics id="A2.p4.1.m1.3a"><mrow id="A2.p4.1.m1.3.3" xref="A2.p4.1.m1.3.3.cmml"><mi id="A2.p4.1.m1.3.3.3" xref="A2.p4.1.m1.3.3.3.cmml">O</mi><mo id="A2.p4.1.m1.3.3.2" xref="A2.p4.1.m1.3.3.2.cmml">⁢</mo><mrow id="A2.p4.1.m1.3.3.1.1" xref="A2.p4.1.m1.3.3.1.1.1.cmml"><mo id="A2.p4.1.m1.3.3.1.1.2" stretchy="false" xref="A2.p4.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="A2.p4.1.m1.3.3.1.1.1" xref="A2.p4.1.m1.3.3.1.1.1.cmml"><mrow id="A2.p4.1.m1.3.3.1.1.1.2.2" xref="A2.p4.1.m1.3.3.1.1.1.2.1.cmml"><mo id="A2.p4.1.m1.3.3.1.1.1.2.2.1" stretchy="false" xref="A2.p4.1.m1.3.3.1.1.1.2.1.1.cmml">|</mo><mi id="A2.p4.1.m1.1.1" xref="A2.p4.1.m1.1.1.cmml">U</mi><mo id="A2.p4.1.m1.3.3.1.1.1.2.2.2" rspace="0.055em" stretchy="false" xref="A2.p4.1.m1.3.3.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="A2.p4.1.m1.3.3.1.1.1.1" rspace="0.222em" xref="A2.p4.1.m1.3.3.1.1.1.1.cmml">⋅</mo><msup id="A2.p4.1.m1.3.3.1.1.1.3" xref="A2.p4.1.m1.3.3.1.1.1.3.cmml"><mrow id="A2.p4.1.m1.3.3.1.1.1.3.2.2" xref="A2.p4.1.m1.3.3.1.1.1.3.2.1.cmml"><mo id="A2.p4.1.m1.3.3.1.1.1.3.2.2.1" stretchy="false" xref="A2.p4.1.m1.3.3.1.1.1.3.2.1.1.cmml">|</mo><mi id="A2.p4.1.m1.2.2" xref="A2.p4.1.m1.2.2.cmml">I</mi><mo id="A2.p4.1.m1.3.3.1.1.1.3.2.2.2" stretchy="false" xref="A2.p4.1.m1.3.3.1.1.1.3.2.1.1.cmml">|</mo></mrow><mn id="A2.p4.1.m1.3.3.1.1.1.3.3" xref="A2.p4.1.m1.3.3.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="A2.p4.1.m1.3.3.1.1.3" stretchy="false" xref="A2.p4.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p4.1.m1.3b"><apply id="A2.p4.1.m1.3.3.cmml" xref="A2.p4.1.m1.3.3"><times id="A2.p4.1.m1.3.3.2.cmml" xref="A2.p4.1.m1.3.3.2"></times><ci id="A2.p4.1.m1.3.3.3.cmml" xref="A2.p4.1.m1.3.3.3">𝑂</ci><apply id="A2.p4.1.m1.3.3.1.1.1.cmml" xref="A2.p4.1.m1.3.3.1.1"><ci id="A2.p4.1.m1.3.3.1.1.1.1.cmml" xref="A2.p4.1.m1.3.3.1.1.1.1">⋅</ci><apply id="A2.p4.1.m1.3.3.1.1.1.2.1.cmml" xref="A2.p4.1.m1.3.3.1.1.1.2.2"><abs id="A2.p4.1.m1.3.3.1.1.1.2.1.1.cmml" xref="A2.p4.1.m1.3.3.1.1.1.2.2.1"></abs><ci id="A2.p4.1.m1.1.1.cmml" xref="A2.p4.1.m1.1.1">𝑈</ci></apply><apply id="A2.p4.1.m1.3.3.1.1.1.3.cmml" xref="A2.p4.1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A2.p4.1.m1.3.3.1.1.1.3.1.cmml" xref="A2.p4.1.m1.3.3.1.1.1.3">superscript</csymbol><apply id="A2.p4.1.m1.3.3.1.1.1.3.2.1.cmml" xref="A2.p4.1.m1.3.3.1.1.1.3.2.2"><abs id="A2.p4.1.m1.3.3.1.1.1.3.2.1.1.cmml" xref="A2.p4.1.m1.3.3.1.1.1.3.2.2.1"></abs><ci id="A2.p4.1.m1.2.2.cmml" xref="A2.p4.1.m1.2.2">𝐼</ci></apply><cn id="A2.p4.1.m1.3.3.1.1.1.3.3.cmml" type="integer" xref="A2.p4.1.m1.3.3.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.1.m1.3c">O(|U|\cdot|I|^{2})</annotation><annotation encoding="application/x-llamapun" id="A2.p4.1.m1.3d">italic_O ( | italic_U | ⋅ | italic_I | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> to <math alttext="O(|I|^{2})" class="ltx_Math" display="inline" id="A2.p4.2.m2.2"><semantics id="A2.p4.2.m2.2a"><mrow id="A2.p4.2.m2.2.2" xref="A2.p4.2.m2.2.2.cmml"><mi id="A2.p4.2.m2.2.2.3" xref="A2.p4.2.m2.2.2.3.cmml">O</mi><mo id="A2.p4.2.m2.2.2.2" xref="A2.p4.2.m2.2.2.2.cmml">⁢</mo><mrow id="A2.p4.2.m2.2.2.1.1" xref="A2.p4.2.m2.2.2.1.1.1.cmml"><mo id="A2.p4.2.m2.2.2.1.1.2" stretchy="false" xref="A2.p4.2.m2.2.2.1.1.1.cmml">(</mo><msup id="A2.p4.2.m2.2.2.1.1.1" xref="A2.p4.2.m2.2.2.1.1.1.cmml"><mrow id="A2.p4.2.m2.2.2.1.1.1.2.2" xref="A2.p4.2.m2.2.2.1.1.1.2.1.cmml"><mo id="A2.p4.2.m2.2.2.1.1.1.2.2.1" stretchy="false" xref="A2.p4.2.m2.2.2.1.1.1.2.1.1.cmml">|</mo><mi id="A2.p4.2.m2.1.1" xref="A2.p4.2.m2.1.1.cmml">I</mi><mo id="A2.p4.2.m2.2.2.1.1.1.2.2.2" stretchy="false" xref="A2.p4.2.m2.2.2.1.1.1.2.1.1.cmml">|</mo></mrow><mn id="A2.p4.2.m2.2.2.1.1.1.3" xref="A2.p4.2.m2.2.2.1.1.1.3.cmml">2</mn></msup><mo id="A2.p4.2.m2.2.2.1.1.3" stretchy="false" xref="A2.p4.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p4.2.m2.2b"><apply id="A2.p4.2.m2.2.2.cmml" xref="A2.p4.2.m2.2.2"><times id="A2.p4.2.m2.2.2.2.cmml" xref="A2.p4.2.m2.2.2.2"></times><ci id="A2.p4.2.m2.2.2.3.cmml" xref="A2.p4.2.m2.2.2.3">𝑂</ci><apply id="A2.p4.2.m2.2.2.1.1.1.cmml" xref="A2.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="A2.p4.2.m2.2.2.1.1.1.1.cmml" xref="A2.p4.2.m2.2.2.1.1">superscript</csymbol><apply id="A2.p4.2.m2.2.2.1.1.1.2.1.cmml" xref="A2.p4.2.m2.2.2.1.1.1.2.2"><abs id="A2.p4.2.m2.2.2.1.1.1.2.1.1.cmml" xref="A2.p4.2.m2.2.2.1.1.1.2.2.1"></abs><ci id="A2.p4.2.m2.1.1.cmml" xref="A2.p4.2.m2.1.1">𝐼</ci></apply><cn id="A2.p4.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="A2.p4.2.m2.2.2.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.2.m2.2c">O(|I|^{2})</annotation><annotation encoding="application/x-llamapun" id="A2.p4.2.m2.2d">italic_O ( | italic_I | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, a significant improvement for large-scale datasets.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experimental Setups and Implementation Details</h2>
<figure class="ltx_table" id="A3.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T8.2.1.1" style="font-size:90%;">Table 8</span>: </span><span class="ltx_text" id="A3.T8.3.2" style="font-size:90%;">Basic statistics of the experimental datasets.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T8.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T8.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A3.T8.4.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A3.T8.4.1.1.2"><span class="ltx_text ltx_font_bold" id="A3.T8.4.1.1.2.1">Sports</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A3.T8.4.1.1.3"><span class="ltx_text ltx_font_bold" id="A3.T8.4.1.1.3.1">Beauty</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="A3.T8.4.1.1.4"><span class="ltx_text ltx_font_bold" id="A3.T8.4.1.1.4.1">Toys</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T8.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T8.4.2.1.1">#Users</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="A3.T8.4.2.1.2">35,598</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A3.T8.4.2.1.3">22,363</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A3.T8.4.2.1.4">19,412</td>
</tr>
<tr class="ltx_tr" id="A3.T8.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T8.4.3.2.1">#Items</th>
<td class="ltx_td ltx_align_right" id="A3.T8.4.3.2.2">18,357</td>
<td class="ltx_td ltx_align_right" id="A3.T8.4.3.2.3">12,101</td>
<td class="ltx_td ltx_align_right" id="A3.T8.4.3.2.4">11,924</td>
</tr>
<tr class="ltx_tr" id="A3.T8.4.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T8.4.4.3.1">#Reviews</th>
<td class="ltx_td ltx_align_right" id="A3.T8.4.4.3.2">296,337</td>
<td class="ltx_td ltx_align_right" id="A3.T8.4.4.3.3">198,502</td>
<td class="ltx_td ltx_align_right" id="A3.T8.4.4.3.4">167,597</td>
</tr>
<tr class="ltx_tr" id="A3.T8.4.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A3.T8.4.5.4.1">#Sparsity (%)</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A3.T8.4.5.4.2">0.0453</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A3.T8.4.5.4.3">0.0734</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="A3.T8.4.5.4.4">0.0724</td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Datasets Descriptions and Preprocessing</h3>
<div class="ltx_para" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">We conduct extensive experiments over three real-world datasets. The Amazon datasets are collected from <span class="ltx_text ltx_font_italic" id="A3.SS1.p1.1.1">Amazon platform<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_upright" id="footnote2.1.1.1">2</span></span><span class="ltx_text ltx_font_upright" id="footnote2.9">https://nijianmo.github.io/amazon</span></span></span></span></span> with user ratings and reviews on 29 categories of products. In this paper, we adopt three of them to evaluate our method, Sports&amp;Outdoors, Beauty, Toys&amp;Games. We follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> and use transaction records between January 1, 2019 to December 31, 2019. Detailed dataset statistics are available in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.T8" title="Table 8 ‣ Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<div class="ltx_para" id="A3.SS1.p2">
<p class="ltx_p" id="A3.SS1.p2.1">We divide tasks into ratings, explanations, and reviews, adhering to the data-splitting approaches of similar studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib25" title=""><span class="ltx_text" style="font-size:90%;">25</span></a>]</cite>. For both sequential and direct recommendation tasks, we adopt the methodology of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib31" title=""><span class="ltx_text" style="font-size:90%;">31</span></a>]</cite>, using the final item in a user’s interaction sequence for testing while carefully structuring the training data to avoid leakage. For rating, explanation, and review task families, we randomly split each dataset into training (80%), validation (10%) and testing (10%) sets, and ensure that there is at least one instance included in the training set for each user and item.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Baselines</h3>
<div class="ltx_para" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">Our approach is compared to a variety of established models, spanning from CNN-based to LLM-based frameworks. Caser <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib36" title=""><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite> applies CNNs to capture high-order Markov Chains in sequential recommendation. HGN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite> utilizes hierarchical gating networks for modeling long and short-term user interests. GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">15</span></a>]</cite> employs GRUs for session-based recommendation, representing items with embedding vectors. BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">35</span></a>]</cite>, S<sup class="ltx_sup" id="A3.SS2.p1.1.1">3</sup>-rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite> and SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite> employ self-attention mechanisms for sequential recommendation, focusing on bidirectional understanding and multi-head attention, respectively. FDSA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">14</span></a>]</cite> adopts feature-level self-attention for feature transitions. CL4SRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib43" title=""><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite> introduces contrastive learning with data augmentation in sequential recommendation. P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> learns different tasks with the same language modeling objective during pretraining, serving as the foundation model for various downstream recommendation tasks. P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> is a recent method that uses a pretrained Large Language Model (LLM) to unify different recommendation tasks in a single model. Since there is no open source code for the recent work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite> yet, we implemented the key ID construction of it ourselves in subsection <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S5.SS4" title="5.4 Ablation Studies ‣ 5 Experiment ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">5.4</span></a>.</p>
</div>
<div class="ltx_para" id="A3.SS2.p2">
<p class="ltx_p" id="A3.SS2.p2.1">In particular, we provide P5 with its variations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>, equipped with different ID constructs like Sequential IDs (SID), Random IDs (RID), and Collaborative IDs (CID) as a benchmark for exploring the impact of different ID strategies. RID Assigns each item with a random number as the item ID. The number is further tokenized into a sequence of sub-tokens, as did in P5. For example, an item is randomly assigned the number "2024", and "2024" is represented as a sequence of tokens "20""24". SID is a straightforward method to leverage collaborative information for item indexing, where items interacted consecutively by a user are assigned consecutive numerical indices, reflecting their co-occurrence. CID approach employs spectral clustering based on spectral matrix factorization to generate item IDs. This method is based on the premise that items with more frequent co-occurrence are more similar and should share more overlapping tokens in ID construction. The results for all baselines except P5 with its variations are reproduced through open source code <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib49" title=""><span class="ltx_text" style="font-size:90%;">49</span></a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Implementation Details</h3>
<div class="ltx_para" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.2">As mentioned in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A1" title="Appendix A Details of META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">A</span></a>, we generate the META ID for users and items for each dataset, generalized to all experiments below. For constructing META IDs, we sampling rating-based meta-paths in each dataset, where adjacent users assigned equal ratings to an item. We set the sampling path length to 64, and use a skip-gram model for training, with a window size of 5 and learning rate set at <math alttext="1e^{-3}" class="ltx_Math" display="inline" id="A3.SS3.p1.1.m1.1"><semantics id="A3.SS3.p1.1.m1.1a"><mrow id="A3.SS3.p1.1.m1.1.1" xref="A3.SS3.p1.1.m1.1.1.cmml"><mn id="A3.SS3.p1.1.m1.1.1.2" xref="A3.SS3.p1.1.m1.1.1.2.cmml">1</mn><mo id="A3.SS3.p1.1.m1.1.1.1" xref="A3.SS3.p1.1.m1.1.1.1.cmml">⁢</mo><msup id="A3.SS3.p1.1.m1.1.1.3" xref="A3.SS3.p1.1.m1.1.1.3.cmml"><mi id="A3.SS3.p1.1.m1.1.1.3.2" xref="A3.SS3.p1.1.m1.1.1.3.2.cmml">e</mi><mrow id="A3.SS3.p1.1.m1.1.1.3.3" xref="A3.SS3.p1.1.m1.1.1.3.3.cmml"><mo id="A3.SS3.p1.1.m1.1.1.3.3a" xref="A3.SS3.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.SS3.p1.1.m1.1.1.3.3.2" xref="A3.SS3.p1.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.1.m1.1b"><apply id="A3.SS3.p1.1.m1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1"><times id="A3.SS3.p1.1.m1.1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1.1"></times><cn id="A3.SS3.p1.1.m1.1.1.2.cmml" type="integer" xref="A3.SS3.p1.1.m1.1.1.2">1</cn><apply id="A3.SS3.p1.1.m1.1.1.3.cmml" xref="A3.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.SS3.p1.1.m1.1.1.3.1.cmml" xref="A3.SS3.p1.1.m1.1.1.3">superscript</csymbol><ci id="A3.SS3.p1.1.m1.1.1.3.2.cmml" xref="A3.SS3.p1.1.m1.1.1.3.2">𝑒</ci><apply id="A3.SS3.p1.1.m1.1.1.3.3.cmml" xref="A3.SS3.p1.1.m1.1.1.3.3"><minus id="A3.SS3.p1.1.m1.1.1.3.3.1.cmml" xref="A3.SS3.p1.1.m1.1.1.3.3"></minus><cn id="A3.SS3.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.SS3.p1.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.1.m1.1c">1e^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.1.m1.1d">1 italic_e start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>. The embedding clusters groups are limited to <math alttext="|G|=100" class="ltx_Math" display="inline" id="A3.SS3.p1.2.m2.1"><semantics id="A3.SS3.p1.2.m2.1a"><mrow id="A3.SS3.p1.2.m2.1.2" xref="A3.SS3.p1.2.m2.1.2.cmml"><mrow id="A3.SS3.p1.2.m2.1.2.2.2" xref="A3.SS3.p1.2.m2.1.2.2.1.cmml"><mo id="A3.SS3.p1.2.m2.1.2.2.2.1" stretchy="false" xref="A3.SS3.p1.2.m2.1.2.2.1.1.cmml">|</mo><mi id="A3.SS3.p1.2.m2.1.1" xref="A3.SS3.p1.2.m2.1.1.cmml">G</mi><mo id="A3.SS3.p1.2.m2.1.2.2.2.2" stretchy="false" xref="A3.SS3.p1.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="A3.SS3.p1.2.m2.1.2.1" xref="A3.SS3.p1.2.m2.1.2.1.cmml">=</mo><mn id="A3.SS3.p1.2.m2.1.2.3" xref="A3.SS3.p1.2.m2.1.2.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.2.m2.1b"><apply id="A3.SS3.p1.2.m2.1.2.cmml" xref="A3.SS3.p1.2.m2.1.2"><eq id="A3.SS3.p1.2.m2.1.2.1.cmml" xref="A3.SS3.p1.2.m2.1.2.1"></eq><apply id="A3.SS3.p1.2.m2.1.2.2.1.cmml" xref="A3.SS3.p1.2.m2.1.2.2.2"><abs id="A3.SS3.p1.2.m2.1.2.2.1.1.cmml" xref="A3.SS3.p1.2.m2.1.2.2.2.1"></abs><ci id="A3.SS3.p1.2.m2.1.1.cmml" xref="A3.SS3.p1.2.m2.1.1">𝐺</ci></apply><cn id="A3.SS3.p1.2.m2.1.2.3.cmml" type="integer" xref="A3.SS3.p1.2.m2.1.2.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.2.m2.1c">|G|=100</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.2.m2.1d">| italic_G | = 100</annotation></semantics></math> (200 for Toys) to manage vocabulary size effectively. The OOV tokens size is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.T9" title="Table 9 ‣ C.3 Implementation Details ‣ Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<figure class="ltx_table" id="A3.T9">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 9: </span>Table of the size of OOV tokens used by IDs.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T9.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T9.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A3.T9.4.1.1.1"><span class="ltx_text" id="A3.T9.4.1.1.1.1" style="font-size:90%;">OOV Tokens Size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.4.1.1.2"><span class="ltx_text ltx_font_bold" id="A3.T9.4.1.1.2.1" style="font-size:90%;">Sports</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.4.1.1.3"><span class="ltx_text ltx_font_bold" id="A3.T9.4.1.1.3.1" style="font-size:90%;">Beauty</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T9.4.1.1.4"><span class="ltx_text ltx_font_bold" id="A3.T9.4.1.1.4.1" style="font-size:90%;">Toys</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T9.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T9.4.2.1.1"><span class="ltx_text" id="A3.T9.4.2.1.1.1" style="font-size:90%;">RID</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.4.2.1.2"><span class="ltx_text" id="A3.T9.4.2.1.2.1" style="font-size:90%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.4.2.1.3"><span class="ltx_text" id="A3.T9.4.2.1.3.1" style="font-size:90%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.4.2.1.4"><span class="ltx_text" id="A3.T9.4.2.1.4.1" style="font-size:90%;">0</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T9.4.3.2.1"><span class="ltx_text" id="A3.T9.4.3.2.1.1" style="font-size:90%;">SID</span></th>
<td class="ltx_td ltx_align_center" id="A3.T9.4.3.2.2"><span class="ltx_text" id="A3.T9.4.3.2.2.1" style="font-size:90%;">0</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.3.2.3"><span class="ltx_text" id="A3.T9.4.3.2.3.1" style="font-size:90%;">0</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.3.2.4"><span class="ltx_text" id="A3.T9.4.3.2.4.1" style="font-size:90%;">0</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T9.4.4.3.1"><span class="ltx_text" id="A3.T9.4.4.3.1.1" style="font-size:90%;">CID</span></th>
<td class="ltx_td ltx_align_center" id="A3.T9.4.4.3.2"><span class="ltx_text" id="A3.T9.4.4.3.2.1" style="font-size:90%;">448</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.4.3.3"><span class="ltx_text" id="A3.T9.4.4.3.3.1" style="font-size:90%;">437</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.4.3.4"><span class="ltx_text" id="A3.T9.4.4.3.4.1" style="font-size:90%;">487</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A3.T9.4.5.4.1"><span class="ltx_text" id="A3.T9.4.5.4.1.1" style="font-size:90%;">IID</span></th>
<td class="ltx_td ltx_align_center" id="A3.T9.4.5.4.2"><span class="ltx_text" id="A3.T9.4.5.4.2.1" style="font-size:90%;">18357</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.5.4.3"><span class="ltx_text" id="A3.T9.4.5.4.3.1" style="font-size:90%;">12101</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.4.5.4.4"><span class="ltx_text" id="A3.T9.4.5.4.4.1" style="font-size:90%;">11924</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A3.T9.4.6.5.1"><span class="ltx_text ltx_font_bold" id="A3.T9.4.6.5.1.1" style="font-size:90%;">META ID</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.4.6.5.2"><span class="ltx_text" id="A3.T9.4.6.5.2.1" style="font-size:90%;">1600</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.4.6.5.3"><span class="ltx_text" id="A3.T9.4.6.5.3.1" style="font-size:90%;">1319</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T9.4.6.5.4"><span class="ltx_text" id="A3.T9.4.6.5.4.1" style="font-size:90%;">727</span></td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsubsection" id="A3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">C.3.1 </span>Evaluation on Sequential and Direct Recommendation Tasks</h4>
<div class="ltx_para" id="A3.SS3.SSS1.p1">
<p class="ltx_p" id="A3.SS3.SSS1.p1.1">We first evaluate META ID on sequential recommendation tasks and direct recommendation tasks following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>. Our implementation first utilizes T5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib28" title=""><span class="ltx_text" style="font-size:90%;">28</span></a>]</cite> as the backbone with parameters around 60.75 million. As mentioned in subsection <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.SS3" title="4.3 Integration of META ID with LLMs ‣ 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4.3</span></a>, we add a linear layer where the OOV tokens undergo an extra linear transformation before the token embedding layer for a better initialization with <math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="A3.SS3.SSS1.p1.1.m1.1"><semantics id="A3.SS3.SSS1.p1.1.m1.1a"><mrow id="A3.SS3.SSS1.p1.1.m1.1.1" xref="A3.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="A3.SS3.SSS1.p1.1.m1.1.1.2" xref="A3.SS3.SSS1.p1.1.m1.1.1.2.cmml">α</mi><mo id="A3.SS3.SSS1.p1.1.m1.1.1.1" xref="A3.SS3.SSS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS3.SSS1.p1.1.m1.1.1.3" xref="A3.SS3.SSS1.p1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.SSS1.p1.1.m1.1b"><apply id="A3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="A3.SS3.SSS1.p1.1.m1.1.1"><eq id="A3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="A3.SS3.SSS1.p1.1.m1.1.1.1"></eq><ci id="A3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="A3.SS3.SSS1.p1.1.m1.1.1.2">𝛼</ci><cn id="A3.SS3.SSS1.p1.1.m1.1.1.3.cmml" type="float" xref="A3.SS3.SSS1.p1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.SSS1.p1.1.m1.1c">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.SSS1.p1.1.m1.1d">italic_α = 0.1</annotation></semantics></math>. We also consider decoder-only architecture LLaMA2-7b <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib37" title=""><span class="ltx_text" style="font-size:90%;">37</span></a>]</cite> with 7B parameters. For tokenization, we use the default SentencePiece tokenizer with extended OOV tokens for parsing sub-word units. We use the same sequential recommendation and direct recommendation prompts in P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> to convert sequential information into texts.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS3.SSS1.p2">
<p class="ltx_p" id="A3.SS3.SSS1.p2.2"><span class="ltx_text ltx_font_bold" id="A3.SS3.SSS1.p2.2.1">For LLM fine-tuning</span>, we pre-train T5 for 10 epochs using AdamW optimizer on two NVIDIA RTX 3090 GPUs with a batch size of 64, a peak learning rate of <math alttext="1e^{-3}" class="ltx_Math" display="inline" id="A3.SS3.SSS1.p2.1.m1.1"><semantics id="A3.SS3.SSS1.p2.1.m1.1a"><mrow id="A3.SS3.SSS1.p2.1.m1.1.1" xref="A3.SS3.SSS1.p2.1.m1.1.1.cmml"><mn id="A3.SS3.SSS1.p2.1.m1.1.1.2" xref="A3.SS3.SSS1.p2.1.m1.1.1.2.cmml">1</mn><mo id="A3.SS3.SSS1.p2.1.m1.1.1.1" xref="A3.SS3.SSS1.p2.1.m1.1.1.1.cmml">⁢</mo><msup id="A3.SS3.SSS1.p2.1.m1.1.1.3" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.cmml"><mi id="A3.SS3.SSS1.p2.1.m1.1.1.3.2" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.2.cmml">e</mi><mrow id="A3.SS3.SSS1.p2.1.m1.1.1.3.3" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.3.cmml"><mo id="A3.SS3.SSS1.p2.1.m1.1.1.3.3a" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.SS3.SSS1.p2.1.m1.1.1.3.3.2" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.SSS1.p2.1.m1.1b"><apply id="A3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="A3.SS3.SSS1.p2.1.m1.1.1"><times id="A3.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="A3.SS3.SSS1.p2.1.m1.1.1.1"></times><cn id="A3.SS3.SSS1.p2.1.m1.1.1.2.cmml" type="integer" xref="A3.SS3.SSS1.p2.1.m1.1.1.2">1</cn><apply id="A3.SS3.SSS1.p2.1.m1.1.1.3.cmml" xref="A3.SS3.SSS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.SS3.SSS1.p2.1.m1.1.1.3.1.cmml" xref="A3.SS3.SSS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="A3.SS3.SSS1.p2.1.m1.1.1.3.2.cmml" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.2">𝑒</ci><apply id="A3.SS3.SSS1.p2.1.m1.1.1.3.3.cmml" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.3"><minus id="A3.SS3.SSS1.p2.1.m1.1.1.3.3.1.cmml" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.3"></minus><cn id="A3.SS3.SSS1.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.SS3.SSS1.p2.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.SSS1.p2.1.m1.1c">1e^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.SSS1.p2.1.m1.1d">1 italic_e start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>. We apply warm-up for the first 5% of all training steps to adjust the learning rate, a maximum input token length of 1024. We use the lora <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite> technique to fine-tune the token embedding layer and linear head layer of LLaMA2-7b for 1 epochs using AdamW optimizer on two NVIDIA RTX A6000 GPUs with a batch size of 28, a peak learning rate of <math alttext="1e^{-5}" class="ltx_Math" display="inline" id="A3.SS3.SSS1.p2.2.m2.1"><semantics id="A3.SS3.SSS1.p2.2.m2.1a"><mrow id="A3.SS3.SSS1.p2.2.m2.1.1" xref="A3.SS3.SSS1.p2.2.m2.1.1.cmml"><mn id="A3.SS3.SSS1.p2.2.m2.1.1.2" xref="A3.SS3.SSS1.p2.2.m2.1.1.2.cmml">1</mn><mo id="A3.SS3.SSS1.p2.2.m2.1.1.1" xref="A3.SS3.SSS1.p2.2.m2.1.1.1.cmml">⁢</mo><msup id="A3.SS3.SSS1.p2.2.m2.1.1.3" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.cmml"><mi id="A3.SS3.SSS1.p2.2.m2.1.1.3.2" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.2.cmml">e</mi><mrow id="A3.SS3.SSS1.p2.2.m2.1.1.3.3" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.3.cmml"><mo id="A3.SS3.SSS1.p2.2.m2.1.1.3.3a" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.3.cmml">−</mo><mn id="A3.SS3.SSS1.p2.2.m2.1.1.3.3.2" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.SSS1.p2.2.m2.1b"><apply id="A3.SS3.SSS1.p2.2.m2.1.1.cmml" xref="A3.SS3.SSS1.p2.2.m2.1.1"><times id="A3.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="A3.SS3.SSS1.p2.2.m2.1.1.1"></times><cn id="A3.SS3.SSS1.p2.2.m2.1.1.2.cmml" type="integer" xref="A3.SS3.SSS1.p2.2.m2.1.1.2">1</cn><apply id="A3.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="A3.SS3.SSS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A3.SS3.SSS1.p2.2.m2.1.1.3.1.cmml" xref="A3.SS3.SSS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="A3.SS3.SSS1.p2.2.m2.1.1.3.2.cmml" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.2">𝑒</ci><apply id="A3.SS3.SSS1.p2.2.m2.1.1.3.3.cmml" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.3"><minus id="A3.SS3.SSS1.p2.2.m2.1.1.3.3.1.cmml" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.3"></minus><cn id="A3.SS3.SSS1.p2.2.m2.1.1.3.3.2.cmml" type="integer" xref="A3.SS3.SSS1.p2.2.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.SSS1.p2.2.m2.1c">1e^{-5}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.SSS1.p2.2.m2.1d">1 italic_e start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>, the lora attention dimension of 16 and the alpha parameter of 32.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS3.SSS1.p3">
<p class="ltx_p" id="A3.SS3.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="A3.SS3.SSS1.p3.1.1">For LLM inferencing</span>, beam search is utilized to generate a list of potential next items, evaluated under the all-item setting. To prevent the generation of non-existent IDs, we apply a constrained decoding method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>, setting the generation probability of invalid IDs to zero.</p>
</div>
<figure class="ltx_table" id="A3.T10">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T10.3.1.1" style="font-size:90%;">Table 10</span>: </span><span class="ltx_text" id="A3.T10.4.2" style="font-size:90%;">Performance comparison of different methods on rating, explanation, and review task.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="A3.T10.5" style="width:555.3pt;height:127pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="A3.T10.5.1"><span class="ltx_text" id="A3.T10.5.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T10.5.1.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="A3.T10.5.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_rowspan ltx_rowspan_2" id="A3.T10.5.1.1.1.1.1.1" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="A3.T10.5.1.1.1.1.1.1.1">Task Type</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_rowspan ltx_rowspan_2" id="A3.T10.5.1.1.1.1.1.2" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="A3.T10.5.1.1.1.1.1.2.1">Metric</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_4" id="A3.T10.5.1.1.1.1.1.3" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.1.1.3.1">Sports</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_4" id="A3.T10.5.1.1.1.1.1.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.1.1.4.1">Beauty</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_4" id="A3.T10.5.1.1.1.1.1.5" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.1.1.5.1">Toys</span></span></span>
<span class="ltx_tr" id="A3.T10.5.1.1.1.2.2">
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.1" style="padding-left:3.4pt;padding-right:3.4pt;">RID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.2" style="padding-left:3.4pt;padding-right:3.4pt;">SID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.3" style="padding-left:3.4pt;padding-right:3.4pt;">CID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.2.2.4.1">META ID</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.5" style="padding-left:3.4pt;padding-right:3.4pt;">RID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.6" style="padding-left:3.4pt;padding-right:3.4pt;">SID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.7" style="padding-left:3.4pt;padding-right:3.4pt;">CID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.8" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.2.2.8.1">META ID</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.9" style="padding-left:3.4pt;padding-right:3.4pt;">RID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.10" style="padding-left:3.4pt;padding-right:3.4pt;">SID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.11" style="padding-left:3.4pt;padding-right:3.4pt;">CID</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.2.2.12" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.2.2.12.1">META ID</span></span></span>
<span class="ltx_tr" id="A3.T10.5.1.1.1.3.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A3.T10.5.1.1.1.3.3.1" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="A3.T10.5.1.1.1.3.3.1.1">Rating</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.2" style="padding-left:3.4pt;padding-right:3.4pt;">RMSE</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.3" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.3.3.3.1">1.0382</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.4" style="padding-left:3.4pt;padding-right:3.4pt;">1.0486</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.5" style="padding-left:3.4pt;padding-right:3.4pt;">1.0383</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.6" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.3.3.6.1">1.0327</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.7" style="padding-left:3.4pt;padding-right:3.4pt;">1.2829</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.8" style="padding-left:3.4pt;padding-right:3.4pt;">1.3098</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.3.3.9.1">1.2819</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.10" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.3.3.10.1">1.2818</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.11" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.3.3.11.1">1.0725</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.12" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.3.3.12.1">1.0693</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.13" style="padding-left:3.4pt;padding-right:3.4pt;">1.0766</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.3.3.14" style="padding-left:3.4pt;padding-right:3.4pt;">1.0770</span></span>
<span class="ltx_tr" id="A3.T10.5.1.1.1.4.4">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t ltx_rowspan ltx_rowspan_2" id="A3.T10.5.1.1.1.4.4.1" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="A3.T10.5.1.1.1.4.4.1.1">Explan.</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.2" style="padding-left:3.4pt;padding-right:3.4pt;">BLEU-1</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.3" style="padding-left:3.4pt;padding-right:3.4pt;">16.2567</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.4" style="padding-left:3.4pt;padding-right:3.4pt;">16.5825</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.5" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.4.4.5.1">16.6121</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.6" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.4.4.6.1">16.9005</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.7" style="padding-left:3.4pt;padding-right:3.4pt;">18.2299</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.8" style="padding-left:3.4pt;padding-right:3.4pt;">18.3981</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.4.4.9.1">19.3499</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.10" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.4.4.10.1">19.5106</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.11" style="padding-left:3.4pt;padding-right:3.4pt;">19.9858</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.12" style="padding-left:3.4pt;padding-right:3.4pt;">20.2198</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.13" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.4.4.13.1">20.4570</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.4.4.14" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.4.4.14.1">20.2270</span></span></span>
<span class="ltx_tr" id="A3.T10.5.1.1.1.5.5">
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.1" style="padding-left:3.4pt;padding-right:3.4pt;">BLEU-4</span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.2" style="padding-left:3.4pt;padding-right:3.4pt;">2.1782</span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.3" style="padding-left:3.4pt;padding-right:3.4pt;">2.1944</span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.5.5.4.1">2.2332</span></span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.5" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.5.5.5.1">2.3481</span></span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.6" style="padding-left:3.4pt;padding-right:3.4pt;">2.9027</span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.7" style="padding-left:3.4pt;padding-right:3.4pt;">2.8071</span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.8" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.5.5.8.1">3.0626</span></span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.5.5.9.1">3.0592</span></span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.10" style="padding-left:3.4pt;padding-right:3.4pt;">4.3495</span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.11" style="padding-left:3.4pt;padding-right:3.4pt;">4.3701</span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.12" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.5.5.12.1">4.5844</span></span>
<span class="ltx_td ltx_align_center" id="A3.T10.5.1.1.1.5.5.13" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.5.5.13.1">4.4945</span></span></span>
<span class="ltx_tr" id="A3.T10.5.1.1.1.6.6">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_2" id="A3.T10.5.1.1.1.6.6.1" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text" id="A3.T10.5.1.1.1.6.6.1.1">Review</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.2" style="padding-left:3.4pt;padding-right:3.4pt;">BLEU-1</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.3" style="padding-left:3.4pt;padding-right:3.4pt;">7.6140</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.6.6.4.1">7.7948</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.5" style="padding-left:3.4pt;padding-right:3.4pt;">7.6586</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.6" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.6.6.6.1">7.8819</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.7" style="padding-left:3.4pt;padding-right:3.4pt;">6.2282</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.8" style="padding-left:3.4pt;padding-right:3.4pt;">6.5055</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.6.6.9.1">6.5854</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.10" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.6.6.10.1">7.0500</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.11" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.6.6.11.1">8.5336</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.12" style="padding-left:3.4pt;padding-right:3.4pt;">8.0862</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.13" style="padding-left:3.4pt;padding-right:3.4pt;">7.3846</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.5.1.1.1.6.6.14" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.6.6.14.1">8.3080</span></span></span>
<span class="ltx_tr" id="A3.T10.5.1.1.1.7.7">
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.1" style="padding-left:3.4pt;padding-right:3.4pt;">BLEU-4</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.2" style="padding-left:3.4pt;padding-right:3.4pt;">2.3228</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.3" style="padding-left:3.4pt;padding-right:3.4pt;">1.2406</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.4" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.7.7.4.1">2.4109</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.5" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.7.7.5.1">2.6546</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.6" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.7.7.6.1">1.9891</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.7" style="padding-left:3.4pt;padding-right:3.4pt;">1.2406</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.8" style="padding-left:3.4pt;padding-right:3.4pt;">1.9718</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.9" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.7.7.9.1">2.7485</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.10" style="padding-left:3.4pt;padding-right:3.4pt;">1.1315</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.11" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_font_bold" id="A3.T10.5.1.1.1.7.7.11.1">1.8366</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.12" style="padding-left:3.4pt;padding-right:3.4pt;">1.2128</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A3.T10.5.1.1.1.7.7.13" style="padding-left:3.4pt;padding-right:3.4pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="A3.T10.5.1.1.1.7.7.13.1">1.7061</span></span></span>
</span>
</span></span></p>
</span></div>
</figure>
</section>
<section class="ltx_subsubsection" id="A3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">C.3.2 </span>Evaluation on Rating, Explanation and Review Tasks</h4>
<div class="ltx_para" id="A3.SS3.SSS2.p1">
<p class="ltx_p" id="A3.SS3.SSS2.p1.1">To validate META ID’s adaptability, we extend our evaluation to rating prediction, explanation generation, and review tasks, akin to P5. We use the same prompts in P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> to convert all information into training texts.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS3.SSS2.p2">
<p class="ltx_p" id="A3.SS3.SSS2.p2.1"><span class="ltx_text ltx_font_bold" id="A3.SS3.SSS2.p2.1.1">For LLM fine-tuning</span>, we pre-train T5 for 10 epochs using AdamW optimizer on two NVIDIA RTX 3090 GPUs with a batch size of 32, a peak learning rate of <math alttext="1e^{-3}" class="ltx_Math" display="inline" id="A3.SS3.SSS2.p2.1.m1.1"><semantics id="A3.SS3.SSS2.p2.1.m1.1a"><mrow id="A3.SS3.SSS2.p2.1.m1.1.1" xref="A3.SS3.SSS2.p2.1.m1.1.1.cmml"><mn id="A3.SS3.SSS2.p2.1.m1.1.1.2" xref="A3.SS3.SSS2.p2.1.m1.1.1.2.cmml">1</mn><mo id="A3.SS3.SSS2.p2.1.m1.1.1.1" xref="A3.SS3.SSS2.p2.1.m1.1.1.1.cmml">⁢</mo><msup id="A3.SS3.SSS2.p2.1.m1.1.1.3" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mi id="A3.SS3.SSS2.p2.1.m1.1.1.3.2" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.2.cmml">e</mi><mrow id="A3.SS3.SSS2.p2.1.m1.1.1.3.3" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml"><mo id="A3.SS3.SSS2.p2.1.m1.1.1.3.3a" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="A3.SS3.SSS2.p2.1.m1.1.1.3.3.2" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.SSS2.p2.1.m1.1b"><apply id="A3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="A3.SS3.SSS2.p2.1.m1.1.1"><times id="A3.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="A3.SS3.SSS2.p2.1.m1.1.1.1"></times><cn id="A3.SS3.SSS2.p2.1.m1.1.1.2.cmml" type="integer" xref="A3.SS3.SSS2.p2.1.m1.1.1.2">1</cn><apply id="A3.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="A3.SS3.SSS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="A3.SS3.SSS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="A3.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.2">𝑒</ci><apply id="A3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.3"><minus id="A3.SS3.SSS2.p2.1.m1.1.1.3.3.1.cmml" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.3"></minus><cn id="A3.SS3.SSS2.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A3.SS3.SSS2.p2.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.SSS2.p2.1.m1.1c">1e^{-3}</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.SSS2.p2.1.m1.1d">1 italic_e start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>. We apply warm-up for the first 5% of all training steps to adjust the learning rate, a maximum input token length of 512 and maximum generation length of 64.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS3.SSS2.p3">
<p class="ltx_p" id="A3.SS3.SSS2.p3.1"><span class="ltx_text ltx_font_bold" id="A3.SS3.SSS2.p3.1.1">For LLM inferencing</span>, greedy decoding is applied for rating prediction, explanation generation, and review tasks.</p>
</div>
<div class="ltx_para" id="A3.SS3.SSS2.p4">
<p class="ltx_p" id="A3.SS3.SSS2.p4.1">The full results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3.T10" title="Table 10 ‣ C.3.1 Evaluation on Sequential and Direct Recommendation Tasks ‣ C.3 Implementation Details ‣ Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Additional Experimental Results</h2>
<figure class="ltx_figure" id="A4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="210" id="A4.F7.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A4.F7.2.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="A4.F7.3.2" style="font-size:90%;">Performance comparision between random initialization (Random Init.) and initializing ID token embeddings using pre-trained ones (Embedding Init.). For RID and SID, random initialization does not have a positive effect compared to keeping T5’s original token embeddings. For META ID, initializing using a learned strategy with the help of cluster centroid embeddings (Embedding Init.) learned from meta-paths can significantly enhance the recommendation performance of META ID compared to random initialization.</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1"><span class="ltx_text ltx_font_bold" id="A4.p1.1.1">Initialization Approaches</span>. We explore the impact of different token initialization methods on the performance of META ID. Recognizing that the LLM’s vocabulary includes numeric tokens for linguistic IDs, we first consider whether reinitializing these numeric tokens helps LLM for recommendation. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A4.F7" title="Figure 7 ‣ Appendix D Additional Experimental Results ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">7</span></a>, our experiment, contrasting random initializing numeric tokens (Random Init.) with keeping T5’s original token embeddings (Embedding Init.), reveals that random initialization does not enhance performance, and be detrimental on Sports and Toys datasets. This suggests that the influence of pre-training on these tokens cannot be effectively negated through simple random initialization, thus not suitable for building IDs. This result emphasizes the importance of introducing extra tokens for IDs in LLM-based recommender systems. We also compare two initialization approaches for META ID: random initialization (Random Init.) and initializing OOV tokens using the augmentation (Embedding Init.) (See Section <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#S4.SS2" title="4.2 OOV Token Generation ‣ 4 META ID ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">4.2</span></a>). Our findings show that the latter method substantially improves META ID’s performance, underlining the critical nature of the token initialization method in achieving better results.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.p2">
<p class="ltx_p" id="A4.p2.1"><span class="ltx_text ltx_font_bold" id="A4.p2.1.1">Visualization of ID-related tokens</span>. Directly applying in-vocabulary tokens to construct IDs (RID and SID) brings poor performance in Toys dataset. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A4.F8" title="Figure 8 ‣ Appendix D Additional Experimental Results ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">8</span></a>a, We use t-SNE visualization to map ID token embeddings and observed that these tokens tend to be homogeneous, whereas CID and META IDs that use OOV tokens to construct IDs have a wider distribution, reflecting difference and diversity between their representations.</p>
</div>
<div class="ltx_para" id="A4.p3">
<p class="ltx_p" id="A4.p3.1">To further illustrate the impact on representation, we visualized the attention mechanism in sequence recommendation generation in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A4.F8" title="Figure 8 ‣ Appendix D Additional Experimental Results ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">8</span></a>(b). This revealed that SID leads to uniform attention patterns, not distinguishing between different items and user IDs. In contrast, META ID demonstrates distinct attention patterns, successfully differentiating items and emphasizing user IDs, thereby allowing models to grasp more personalized and distinct information.</p>
</div>
<figure class="ltx_figure" id="A4.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="263" id="A4.F8.g1" src="x12.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A4.F8.3.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="A4.F8.4.2" style="font-size:90%;">(a)Token embeddings projected into 2D via t-SNE, with colors indicating different type of tokens.(b) Visualization of attention between input and output tokens in sequence recommendation generation, where we aggregate tokens within one ID for clarity. The visualization indicates that SID leads to undifferentiated attention across items and neglects the user ID, whereas META ID distinctly allocates attention to sequence items, outputting item containing the "<span class="ltx_text ltx_font_italic" id="A4.F8.4.2.1">&lt;CT18&gt;</span>" token in both the user ID and item ID with the highest attention values.</span></figcaption>
</figure>
<figure class="ltx_table" id="A4.T11">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A4.T11.2.1.1" style="font-size:90%;">Table 11</span>: </span><span class="ltx_text" id="A4.T11.3.2" style="font-size:90%;">The standard error of the metrics for META ID on sequential recommendation task.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="A4.T11.4" style="width:352.5pt;height:72pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="A4.T11.4.1"><span class="ltx_text" id="A4.T11.4.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T11.4.1.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="A4.T11.4.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T11.4.1.1.1.1.1.1" style="padding-left:4.6pt;padding-right:4.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T11.4.1.1.1.1.1.1.1">Datasets</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T11.4.1.1.1.1.1.2" style="padding-left:4.6pt;padding-right:4.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T11.4.1.1.1.1.1.2.1">HR@5</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T11.4.1.1.1.1.1.3" style="padding-left:4.6pt;padding-right:4.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T11.4.1.1.1.1.1.3.1">NCDG@5</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T11.4.1.1.1.1.1.4" style="padding-left:4.6pt;padding-right:4.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T11.4.1.1.1.1.1.4.1">HR@10</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T11.4.1.1.1.1.1.5" style="padding-left:4.6pt;padding-right:4.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T11.4.1.1.1.1.1.5.1">NCDG@10</span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="A4.T11.4.1.1.1.2.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T11.4.1.1.1.2.1.1" style="padding-left:4.6pt;padding-right:4.6pt;">Beauty</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.4.1.1.1.2.1.2" style="padding-left:4.6pt;padding-right:4.6pt;">0.0510 ± 0.00038</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.4.1.1.1.2.1.3" style="padding-left:4.6pt;padding-right:4.6pt;">0.0351 ± 0.00044</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.4.1.1.1.2.1.4" style="padding-left:4.6pt;padding-right:4.6pt;">0.0752 ± 0.00131</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A4.T11.4.1.1.1.2.1.5" style="padding-left:4.6pt;padding-right:4.6pt;">0.0429 ± 0.00075</span></span>
<span class="ltx_tr" id="A4.T11.4.1.1.1.3.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T11.4.1.1.1.3.2.1" style="padding-left:4.6pt;padding-right:4.6pt;">Sports</span>
<span class="ltx_td ltx_align_center" id="A4.T11.4.1.1.1.3.2.2" style="padding-left:4.6pt;padding-right:4.6pt;">0.0322 ± 0.00061</span>
<span class="ltx_td ltx_align_center" id="A4.T11.4.1.1.1.3.2.3" style="padding-left:4.6pt;padding-right:4.6pt;">0.0223 ± 0.00060</span>
<span class="ltx_td ltx_align_center" id="A4.T11.4.1.1.1.3.2.4" style="padding-left:4.6pt;padding-right:4.6pt;">0.0487 ± 0.00073</span>
<span class="ltx_td ltx_align_center" id="A4.T11.4.1.1.1.3.2.5" style="padding-left:4.6pt;padding-right:4.6pt;">0.0277 ± 0.00055</span></span>
<span class="ltx_tr" id="A4.T11.4.1.1.1.4.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T11.4.1.1.1.4.3.1" style="padding-left:4.6pt;padding-right:4.6pt;">Toys</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.4.1.1.1.4.3.2" style="padding-left:4.6pt;padding-right:4.6pt;">0.0503 ± 0.00091</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.4.1.1.1.4.3.3" style="padding-left:4.6pt;padding-right:4.6pt;">0.0352 ± 0.00067</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.4.1.1.1.4.3.4" style="padding-left:4.6pt;padding-right:4.6pt;">0.0742 ± 0.00138</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="A4.T11.4.1.1.1.4.3.5" style="padding-left:4.6pt;padding-right:4.6pt;">0.0429 ± 0.00078</span></span>
</span>
</span></span></p>
</span></div>
</figure>
<figure class="ltx_table" id="A4.T12">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 12: </span>Average inference time (in milliseconds) of T5 with META ID on different tasks on the Toy dataset.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T12.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T12.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T12.4.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T12.4.1.1.1.1" style="font-size:90%;">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="A4.T12.4.1.1.2"><span class="ltx_text ltx_font_bold" id="A4.T12.4.1.1.2.1" style="font-size:90%;">per user</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="A4.T12.4.1.1.3"><span class="ltx_text ltx_font_bold" id="A4.T12.4.1.1.3.1" style="font-size:90%;">per user-item pair</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="A4.T12.4.1.1.4"><span class="ltx_text ltx_font_bold" id="A4.T12.4.1.1.4.1" style="font-size:90%;">per review</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T12.4.2.1">
<th class="ltx_td ltx_th ltx_th_row" id="A4.T12.4.2.1.1"></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.4.2.1.2"><span class="ltx_text ltx_font_bold" id="A4.T12.4.2.1.2.1" style="font-size:90%;">Sequential</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.4.2.1.3"><span class="ltx_text ltx_font_bold" id="A4.T12.4.2.1.3.1" style="font-size:90%;">Direct</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.4.2.1.4"><span class="ltx_text ltx_font_bold" id="A4.T12.4.2.1.4.1" style="font-size:90%;">Rating</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.4.2.1.5"><span class="ltx_text ltx_font_bold" id="A4.T12.4.2.1.5.1" style="font-size:90%;">Explanation</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.4.2.1.6"><span class="ltx_text ltx_font_bold" id="A4.T12.4.2.1.6.1" style="font-size:90%;">Summarization</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T12.4.2.1.7"><span class="ltx_text ltx_font_bold" id="A4.T12.4.2.1.7.1" style="font-size:90%;">Preference</span></td>
</tr>
<tr class="ltx_tr" id="A4.T12.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A4.T12.4.3.2.1"><span class="ltx_text ltx_font_bold" id="A4.T12.4.3.2.1.1" style="font-size:90%;">META ID (T)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T12.4.3.2.2"><span class="ltx_text" id="A4.T12.4.3.2.2.1" style="font-size:90%;">74.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T12.4.3.2.3"><span class="ltx_text" id="A4.T12.4.3.2.3.1" style="font-size:90%;">68.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T12.4.3.2.4"><span class="ltx_text" id="A4.T12.4.3.2.4.1" style="font-size:90%;">5.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T12.4.3.2.5"><span class="ltx_text" id="A4.T12.4.3.2.5.1" style="font-size:90%;">17.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T12.4.3.2.6"><span class="ltx_text" id="A4.T12.4.3.2.6.1" style="font-size:90%;">9.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T12.4.3.2.7"><span class="ltx_text" id="A4.T12.4.3.2.7.1" style="font-size:90%;">8.55</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A4.p4">
<p class="ltx_p" id="A4.p4.1"><span class="ltx_text ltx_font_bold" id="A4.p4.1.1">Statistics on training &amp; Inference Time</span>. We provide statistics on the training and inference time of P5 models, we collect the running time on the Toys dataset.
As mentioned in subsection <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A3" title="Appendix C Experimental Setups and Implementation Details ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">C</span></a>, we trained and test our models on two RTX 3090 GPUs. For training on sequential recommendation and direct recommendation tasks, the T5 model spent 3.5 hours to finish training. The average inference time of T5 model on dferent tasks are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.08477v1#A4.T12" title="Table 12 ‣ Appendix D Additional Experimental Results ‣ Improving LLMs for Recommendation with Out-Of-Vocabulary Tokens"><span class="ltx_text ltx_ref_tag">12</span></a>. Sequential and direct recommendation tasks require much longer inference time than other tasks due to the beam search step. Overall, the inference is very fast. It is also promising to further reduce the training and inference time with the help of effcient Transformer techniques.</p>
</div>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Discussions</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">There are two promising directions of META ID. First, META ID uses a fixed database of users and items, while newly appearing items and users do not have interaction history. This could be solved using methods related to the cold start issue. Second, META ID applies two-level tokens for constructing IDs, while a more complicated hierarchical structure could be considered. Then, META ID could be applied to modern recommender system containing trillions of users and items.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Jun 11 11:25:06 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
