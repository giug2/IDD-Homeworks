<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.08506] DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning</title><meta property="og:description" content="Federated learning (FL) has emerged as a powerful paradigm for learning from decentralized data, and federated domain generalization further considers the test dataset (target domain) is absent from the decentralized t…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.08506">

<!--Generated on Fri Apr  5 14:55:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">DiPrompT: Disentangled Prompt Tuning for 
<br class="ltx_break">Multiple Latent Domain Generalization in Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sikai Bai<sup id="id1.1.1" class="ltx_sup">1<math id="id1.1.1.m1.1" class="ltx_Math" alttext="\ast" display="inline"><semantics id="id1.1.1.m1.1a"><mo id="id1.1.1.m1.1.1" xref="id1.1.1.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="id1.1.1.m1.1b"><ci id="id1.1.1.m1.1.1.cmml" xref="id1.1.1.m1.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.1.m1.1c">\ast</annotation></semantics></math></sup>, Jie Zhang<sup id="id2.2.2" class="ltx_sup">2<math id="id2.2.2.m1.1" class="ltx_Math" alttext="\ast" display="inline"><semantics id="id2.2.2.m1.1a"><mo id="id2.2.2.m1.1.1" xref="id2.2.2.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="id2.2.2.m1.1b"><ci id="id2.2.2.m1.1.1.cmml" xref="id2.2.2.m1.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.2.2.m1.1c">\ast</annotation></semantics></math></sup>, Shuaicheng Li<sup id="id3.3.3" class="ltx_sup">3 <math id="id3.3.3.m1.2" class="ltx_Math" alttext="{\dagger}{\ddagger}" display="inline"><semantics id="id3.3.3.m1.2a"><mrow id="id3.3.3.m1.2.3.2" xref="id3.3.3.m1.2.3.1.cmml"><mo id="id3.3.3.m1.1.1" xref="id3.3.3.m1.1.1.cmml">†</mo><mo lspace="0em" id="id3.3.3.m1.2.3.2.1" xref="id3.3.3.m1.2.3.1.cmml">⁣</mo><mo id="id3.3.3.m1.2.2" xref="id3.3.3.m1.2.2.cmml">‡</mo></mrow><annotation-xml encoding="MathML-Content" id="id3.3.3.m1.2b"><list id="id3.3.3.m1.2.3.1.cmml" xref="id3.3.3.m1.2.3.2"><ci id="id3.3.3.m1.1.1.cmml" xref="id3.3.3.m1.1.1">†</ci><ci id="id3.3.3.m1.2.2.cmml" xref="id3.3.3.m1.2.2">‡</ci></list></annotation-xml><annotation encoding="application/x-tex" id="id3.3.3.m1.2c">{\dagger}{\ddagger}</annotation></semantics></math></sup>, 
<br class="ltx_break">Song Guo<sup id="id4.4.4" class="ltx_sup">1<math id="id4.4.4.m1.1" class="ltx_Math" alttext="{\dagger}" display="inline"><semantics id="id4.4.4.m1.1a"><mo id="id4.4.4.m1.1.1" xref="id4.4.4.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id4.4.4.m1.1b"><ci id="id4.4.4.m1.1.1.cmml" xref="id4.4.4.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id4.4.4.m1.1c">{\dagger}</annotation></semantics></math></sup>, Jingcai Guo<sup id="id5.5.id1" class="ltx_sup">2</sup>, Jun Hou<sup id="id6.6.id2" class="ltx_sup">3</sup>, Tao Han<sup id="id7.7.id3" class="ltx_sup">1</sup>, Xiaocheng Lu<sup id="id8.8.id4" class="ltx_sup">1</sup> 
<br class="ltx_break"><sup id="id9.9.id5" class="ltx_sup">1</sup>The Hong Kong University of Science and Technology,
<sup id="id10.10.id6" class="ltx_sup">2</sup>The Hong Kong Polytechnic University, 
<br class="ltx_break"><sup id="id11.11.id7" class="ltx_sup">3</sup>SenseTime Research
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id12.id1" class="ltx_p">Federated learning (FL) has emerged as a powerful paradigm for learning from decentralized data, and federated domain generalization further considers the test dataset (target domain) is absent from the decentralized training data (source domains).
However, most existing FL methods assume that domain labels are provided during training, and their evaluation imposes explicit constraints on the number of domains, which must strictly match the number of clients. Because of the underutilization of numerous edge devices and additional cross-client domain annotations in the real world, such restrictions may be impractical and involve potential privacy leaks.
In this paper, we propose an efficient and novel approach, called <span id="id12.id1.1" class="ltx_text ltx_font_bold">Di</span>sentangled <span id="id12.id1.2" class="ltx_text ltx_font_bold">Promp</span>t <span id="id12.id1.3" class="ltx_text ltx_font_bold">T</span>uning (<span id="id12.id1.4" class="ltx_text ltx_font_bold">DiPrompT</span>),
a method that tackles the above restrictions by learning adaptive prompts for domain generalization in a distributed manner.
Specifically, we first design two types of prompts, i.e., global prompt to capture general knowledge across all clients and domain prompts to capture domain-specific knowledge. They eliminate the restriction on the one-to-one mapping between source domains and local clients.
<span id="id12.id1.5" class="ltx_text" style="color:#000000;">Furthermore, a dynamic query metric is introduced to automatically search the suitable domain label for each sample, which includes two-substep text-image alignments based on prompt tuning without labor-intensive annotation.</span>
Extensive experiments on multiple datasets demonstrate that our DiPrompT achieves superior domain generalization performance over state-of-the-art FL methods when domain labels are not provided, and even outperforms many centralized learning methods using domain labels.</p>
</div>
<span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotetext: </span><math id="footnotex1.m1.1" class="ltx_Math" alttext="\ast" display="inline"><semantics id="footnotex1.m1.1b"><mo id="footnotex1.m1.1.1" xref="footnotex1.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="footnotex1.m1.1c"><ci id="footnotex1.m1.1.1.cmml" xref="footnotex1.m1.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="footnotex1.m1.1d">\ast</annotation></semantics></math> Equal contribution, <math id="footnotex1.m2.1" class="ltx_Math" alttext="{\dagger}" display="inline"><semantics id="footnotex1.m2.1b"><mo id="footnotex1.m2.1.1" xref="footnotex1.m2.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="footnotex1.m2.1c"><ci id="footnotex1.m2.1.1.cmml" xref="footnotex1.m2.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="footnotex1.m2.1d">{\dagger}</annotation></semantics></math> Corresponding authors, <math id="footnotex1.m3.1" class="ltx_Math" alttext="{\ddagger}" display="inline"><semantics id="footnotex1.m3.1b"><mo id="footnotex1.m3.1.1" xref="footnotex1.m3.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="footnotex1.m3.1c"><ci id="footnotex1.m3.1.1.cmml" xref="footnotex1.m3.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="footnotex1.m3.1d">{\ddagger}</annotation></semantics></math> Project leader</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) is an emerging privacy-preserving machine-learning technique <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib24" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite>, which enables multiple clients (e.g., mobile devices or organizations) to collaboratively learn a global model without exchanging their private data.
However, a practical concern with conventional FL methods is that they usually ignore the possible domain shift between training data (source domains) and test data (target domain) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">1</span></a>]</cite>, which can incur poor performance on unseen target domains due to domain discrepancies.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2403.08506/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="261" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">The motivation example and our main idea. (a) When clients outnumber source domains, learning domain-invariant features may become challenging due to imbalanced contributions across domains/clients. Note that the contribution imbalance of local data is measured through its feature distances with the target domain.
(b) DiPrompT separates domain-specific features and general knowledge during local training. (c) DiPrompT adaptive ensembles for generic and valuable specific knowledge for better target domain prediction during inference.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Recently, some research efforts have attempted to incorporate domain generalization into the FL framework. For example, FedDG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">21</span></a>]</cite> shares the amplitude spectrum of images among local clients for medical image segmentation. FedSR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite> builds a simple algorithm that utilizes two local regularizers for domain generalization. These methods extract domain-invariant features across all source domains.
Nevertheless, most of these methods only focus on domain-invariant features across clients, and they rely on the assumption of one-to-one mapping of client and domain.
<span id="S1.p2.1.1" class="ltx_text" style="color:#000000;">When the quantity of local clients increases regardless of source domains, a more severe and real-world challenge emerges. In this scenario, data from a source domain can be dispersed among multiple clients, resulting in initially general knowledge that may be limited to certain clients and become specific.</span>
Thus learning sufficient invariant knowledge across all clients becomes infeasible. In Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a), for the horse class, the only general thing across all clients is shape. However, <span id="S1.p2.1.2" class="ltx_text" style="color:#000000;">some specific knowledge from certain clients possess a smaller feature distance with the target domain than others (e.g., the horse features distance between client 2 and the target domain is only 70.59).</span> Intuitively, we can additionally harness these features throughout the training phase to facilitate performance in the target domain.
Unfortunately, due to interference from spurious specific information and the entanglement between generic and specific features, it is non-trivial to separately extract generic and specific knowledge for each domain with a single model.
Moreover, domain information is indispensable for each local sample in these methods, but it is prohibitively expensive and may risk privacy leakage to annotate to which domain each sample belongs in a decentralized setting.
</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To tackle the above issues, we propose a novel and efficient method termed Disentangled Prompt Tuning (DiPrompT) for domain generalization in FL settings.
The motivation is to simultaneously spin off domain-specific and general features with different lightweight components in local training, minimizing their interference and removing irrelevant specifics. Furthermore, we can gain crucial complementary information by adaptive ensembling of specific and generic knowledge for the target domain in the test stage.
Specifically, DiPrompT first introduces two types of prompts: 1) <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">Global prompt (G-Prompt)</span> maintains the domain-invariant representation across all clients. It would be invariant to the domain shift brought by all clients in decentralized training. 2)<span id="S1.p3.1.2" class="ltx_text ltx_font_bold">Domain prompts (D-Prompts)</span>: <span id="S1.p3.1.3" class="ltx_text" style="color:#000000;">Inspired by prototype learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">34</span></a>]</cite>, we construct a prototypical prompt for each predefined source domain, encapsulating discriminative specific knowledge from each source domain into the respective prompts. It resolves the count consistency restriction between clients and domains by domain-wise optimization and aggregation, while enhancing cross-client representation for each domain.</span>
Furthermore, when domain labels are unknown during both training and test periods (i.e., latent domains),
we design an adaptive query mechanism to explore the potential domain for each sample. An additional prompt (<span id="S1.p3.1.4" class="ltx_text ltx_font_bold">Q-prompt</span>) is introduced, which automatically queries the domain label for each sample from all possible
options by image-text alignments after excluding the interference of semantic categories. Finally, at inference time, we leverage a collaborative ensemble metric to provide valuable complementary information from G-Prompt and D-Prompts for better target prediction.</p>
</div>
<div id="S1.p4" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">To the best of our knowledge, this is the first lightweight work that handles federated domain generalization through prompt tuning.
We aspire that our research and findings can offer a fresh perspective toward solving cutting-edge challenges in domain generalization and federated learning.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose DiPrompT, a novel federated domain generalization framework based on prompt tuning. It removes two impractical restrictions and provides complementary knowledge for generalization on unseen target domains with small-scale operations.
</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Extensive experiments on multiple domain generalization tasks verify the superiority of DiPrompT over state-of-the-art methods, which even outperforms some domain generalization methods with domain labels.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2403.08506/assets/x2.png" id="S1.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="346" height="130" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.4.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S1.F2.5.2" class="ltx_text" style="font-size:90%;">
Illustration of <span id="S1.F2.5.2.1" class="ltx_text ltx_font_bold">Disentangled Prompt Tuning (DiPrompT) during traing</span>. We devise an alternative optimization strategy to update two key modules (disentangled prompt learning and dynamic query scheme), which mainly contain six steps except communication between clients and server. We first generate image embeddings and update Q-Prompt via steps 2 and 3, respectively. Then the suitable D-Prompt is selected using Q-prompt in step 4. G-Prompt and D-Prompt in disentangled prompt learning are simultaneously optimized using steps 5 and 6. Finally, we perform the beta moving average update for D-Prompts to avoid client drift in the central server in step 8.</span></figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Federated learning (FL)</span> is a decentralized training technique that leaves training data distributed on multiple decentralized clients and learns a global model by aggregating the locally uploaded parameters in a central server <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib38" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">38</span></a>]</cite>. In FL, clients protect data privacy as raw data are always kept locally<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">4</span></a>]</cite>. FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite> is the first and most common FL work, which aggregates model updates by weighted averaging. One of the important challenges in FL is statistical heterogeneity among clients, in which each client contains different local data distribution with each other. A plethora of research has been done to tackle this problem, such as FedProx<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>, MOON<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">14</span></a>]</cite>, and FCCL<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">11</span></a>]</cite>. While these FL studies have dealt with distribution heterogeneity among local clients (source domains), they ignored generalization to unseen target domains, which is the problem we mainly focus on in this paper.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Domain generalization (DG)</span> generalizes a learned model from multiple source domains to unseen target domains and motivates extensive studies in a centralized setting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>. Representative methods either learn domain-invariant knowledge across multiple source domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">26</span></a>, <a href="#bib.bib37" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">37</span></a>, <a href="#bib.bib2" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">2</span></a>, <a href="#bib.bib18" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite> or employ the idea of meta-learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">7</span></a>, <a href="#bib.bib13" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite>. However, these DG methods require access to data from all source domains in a centralized server and ground-truth domain labels for each sample, which is usually impractical in FL scenarios due to privacy protection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite>. Moreover, some methods perform domain generalization without domain labels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">42</span></a>, <a href="#bib.bib23" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">23</span></a>]</cite>, assuming the latent domain of images is reflected in their style or divided into multiple latent domains using clustering algorithms, then assigning pseudo domain labels to each sample. However, they cannot utilize text information about underlying domains. Recently, several works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">35</span></a>, <a href="#bib.bib27" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">27</span></a>, <a href="#bib.bib41" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">41</span></a>]</cite> try to solve the DG task in the FL context.
In this paper, we consider a more realistic and challenging scenario, where the number of clients is more flexible regardless of source domains, and the domain labels are unknown. </p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Prompt Tuning</span> is a super efficient transfer learning paradigm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">20</span></a>, <a href="#bib.bib32" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">32</span></a>]</cite>,
whose core idea is to add little learnable embeddings at the input tokens and fast adaptation for the large language model to various downstream tasks without re-training model parameters. Early works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">28</span></a>, <a href="#bib.bib29" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">29</span></a>]</cite> aim to manually design prompt templates based on human prior knowledge. Furthermore, CoOp <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">45</span></a>]</cite> and its extended versions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">6</span></a>, <a href="#bib.bib39" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">39</span></a>, <a href="#bib.bib44" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">44</span></a>]</cite> utilize a set of continuous vectors in the language branch of a large vision-language pre-trained model (CLIP), and achieve great performance improvement on multiple few-shot visual recognition tasks<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">16</span></a>, <a href="#bib.bib15" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">15</span></a>, <a href="#bib.bib3" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite>. Compared with these methods, DiPrompT further extends prompt tuning into federated domain generalization by extracting multiple valuable knowledge based on prompt tuning and achieves superior generalization ability.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we present preliminary knowledge, followed by the introduction of two key modules in training time: disentangled prompt learning and a dynamic query metric for domain queries. The overall pipeline is illustrated in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, with accompanying pseudo-code in the supplementary materials. Finally, we introduce a collaborative ensemble scheme during inference.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminary and Notations</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.12" class="ltx_p"><span id="S3.SS1.p1.5.5" class="ltx_text" style="color:#000000;">Federated Learning (FL) aims to utilize <math id="S3.SS1.p1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.1.m1.1a"><mi mathcolor="#000000" id="S3.SS1.p1.1.1.m1.1.1" xref="S3.SS1.p1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.1.m1.1b"><ci id="S3.SS1.p1.1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.1.m1.1c">K</annotation></semantics></math> local models
to train a global model <math id="S3.SS1.p1.2.2.m2.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.SS1.p1.2.2.m2.1a"><msub id="S3.SS1.p1.2.2.m2.1.1" xref="S3.SS1.p1.2.2.m2.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.p1.2.2.m2.1.1.2" xref="S3.SS1.p1.2.2.m2.1.1.2.cmml">f</mi><mi mathcolor="#000000" id="S3.SS1.p1.2.2.m2.1.1.3" xref="S3.SS1.p1.2.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.2.m2.1b"><apply id="S3.SS1.p1.2.2.m2.1.1.cmml" xref="S3.SS1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.2.m2.1.1.2">𝑓</ci><ci id="S3.SS1.p1.2.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.2.m2.1c">f_{g}</annotation></semantics></math> with parameter <math id="S3.SS1.p1.3.3.m3.1" class="ltx_Math" alttext="\theta_{g}" display="inline"><semantics id="S3.SS1.p1.3.3.m3.1a"><msub id="S3.SS1.p1.3.3.m3.1.1" xref="S3.SS1.p1.3.3.m3.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.p1.3.3.m3.1.1.2" xref="S3.SS1.p1.3.3.m3.1.1.2.cmml">θ</mi><mi mathcolor="#000000" id="S3.SS1.p1.3.3.m3.1.1.3" xref="S3.SS1.p1.3.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.3.m3.1b"><apply id="S3.SS1.p1.3.3.m3.1.1.cmml" xref="S3.SS1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.3.m3.1.1.2">𝜃</ci><ci id="S3.SS1.p1.3.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.3.m3.1c">\theta_{g}</annotation></semantics></math> through <math id="S3.SS1.p1.4.4.m4.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS1.p1.4.4.m4.1a"><mi mathcolor="#000000" id="S3.SS1.p1.4.4.m4.1.1" xref="S3.SS1.p1.4.4.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.4.m4.1b"><ci id="S3.SS1.p1.4.4.m4.1.1.cmml" xref="S3.SS1.p1.4.4.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.4.m4.1c">R</annotation></semantics></math> global rounds, in which each randomly selected local model is trained with <math id="S3.SS1.p1.5.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p1.5.5.m5.1a"><mi mathcolor="#000000" id="S3.SS1.p1.5.5.m5.1.1" xref="S3.SS1.p1.5.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.5.m5.1b"><ci id="S3.SS1.p1.5.5.m5.1.1.cmml" xref="S3.SS1.p1.5.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.5.m5.1c">T</annotation></semantics></math> local iterations per global round.</span> Domain generalization (DG) trains a model using <math id="S3.SS1.p1.6.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.6.m1.1a"><mi id="S3.SS1.p1.6.m1.1.1" xref="S3.SS1.p1.6.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m1.1b"><ci id="S3.SS1.p1.6.m1.1.1.cmml" xref="S3.SS1.p1.6.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m1.1c">M</annotation></semantics></math> source domains <math id="S3.SS1.p1.7.m2.1" class="ltx_Math" alttext="D^{S}=\left\{D_{m}^{S}\right\}^{M}_{m=1}" display="inline"><semantics id="S3.SS1.p1.7.m2.1a"><mrow id="S3.SS1.p1.7.m2.1.1" xref="S3.SS1.p1.7.m2.1.1.cmml"><msup id="S3.SS1.p1.7.m2.1.1.3" xref="S3.SS1.p1.7.m2.1.1.3.cmml"><mi id="S3.SS1.p1.7.m2.1.1.3.2" xref="S3.SS1.p1.7.m2.1.1.3.2.cmml">D</mi><mi id="S3.SS1.p1.7.m2.1.1.3.3" xref="S3.SS1.p1.7.m2.1.1.3.3.cmml">S</mi></msup><mo id="S3.SS1.p1.7.m2.1.1.2" xref="S3.SS1.p1.7.m2.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p1.7.m2.1.1.1" xref="S3.SS1.p1.7.m2.1.1.1.cmml"><mrow id="S3.SS1.p1.7.m2.1.1.1.1.1.1" xref="S3.SS1.p1.7.m2.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.7.m2.1.1.1.1.1.1.2" xref="S3.SS1.p1.7.m2.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.2.cmml">D</mi><mi id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.3.cmml">m</mi><mi id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.3.cmml">S</mi></msubsup><mo id="S3.SS1.p1.7.m2.1.1.1.1.1.1.3" xref="S3.SS1.p1.7.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.7.m2.1.1.1.3" xref="S3.SS1.p1.7.m2.1.1.1.3.cmml"><mi id="S3.SS1.p1.7.m2.1.1.1.3.2" xref="S3.SS1.p1.7.m2.1.1.1.3.2.cmml">m</mi><mo id="S3.SS1.p1.7.m2.1.1.1.3.1" xref="S3.SS1.p1.7.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.7.m2.1.1.1.3.3" xref="S3.SS1.p1.7.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.7.m2.1.1.1.1.3" xref="S3.SS1.p1.7.m2.1.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m2.1b"><apply id="S3.SS1.p1.7.m2.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1"><eq id="S3.SS1.p1.7.m2.1.1.2.cmml" xref="S3.SS1.p1.7.m2.1.1.2"></eq><apply id="S3.SS1.p1.7.m2.1.1.3.cmml" xref="S3.SS1.p1.7.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m2.1.1.3.1.cmml" xref="S3.SS1.p1.7.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.7.m2.1.1.3.2.cmml" xref="S3.SS1.p1.7.m2.1.1.3.2">𝐷</ci><ci id="S3.SS1.p1.7.m2.1.1.3.3.cmml" xref="S3.SS1.p1.7.m2.1.1.3.3">𝑆</ci></apply><apply id="S3.SS1.p1.7.m2.1.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m2.1.1.1.2.cmml" xref="S3.SS1.p1.7.m2.1.1.1">subscript</csymbol><apply id="S3.SS1.p1.7.m2.1.1.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m2.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m2.1.1.1">superscript</csymbol><set id="S3.SS1.p1.7.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1"><apply id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.2">𝐷</ci><ci id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.1.1.1.3">𝑆</ci></apply></set><ci id="S3.SS1.p1.7.m2.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m2.1.1.1.1.3">𝑀</ci></apply><apply id="S3.SS1.p1.7.m2.1.1.1.3.cmml" xref="S3.SS1.p1.7.m2.1.1.1.3"><eq id="S3.SS1.p1.7.m2.1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m2.1.1.1.3.1"></eq><ci id="S3.SS1.p1.7.m2.1.1.1.3.2.cmml" xref="S3.SS1.p1.7.m2.1.1.1.3.2">𝑚</ci><cn type="integer" id="S3.SS1.p1.7.m2.1.1.1.3.3.cmml" xref="S3.SS1.p1.7.m2.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m2.1c">D^{S}=\left\{D_{m}^{S}\right\}^{M}_{m=1}</annotation></semantics></math> and is targeted to achieve decent performance on the unseen target domain <math id="S3.SS1.p1.8.m3.1" class="ltx_Math" alttext="D^{t}" display="inline"><semantics id="S3.SS1.p1.8.m3.1a"><msup id="S3.SS1.p1.8.m3.1.1" xref="S3.SS1.p1.8.m3.1.1.cmml"><mi id="S3.SS1.p1.8.m3.1.1.2" xref="S3.SS1.p1.8.m3.1.1.2.cmml">D</mi><mi id="S3.SS1.p1.8.m3.1.1.3" xref="S3.SS1.p1.8.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m3.1b"><apply id="S3.SS1.p1.8.m3.1.1.cmml" xref="S3.SS1.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m3.1.1.1.cmml" xref="S3.SS1.p1.8.m3.1.1">superscript</csymbol><ci id="S3.SS1.p1.8.m3.1.1.2.cmml" xref="S3.SS1.p1.8.m3.1.1.2">𝐷</ci><ci id="S3.SS1.p1.8.m3.1.1.3.cmml" xref="S3.SS1.p1.8.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m3.1c">D^{t}</annotation></semantics></math>. Each source domain has a unique data distribution but shares the same task (e.g., image classification) with other domains. <math id="S3.SS1.p1.9.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.9.m4.1a"><mi id="S3.SS1.p1.9.m4.1.1" xref="S3.SS1.p1.9.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m4.1b"><ci id="S3.SS1.p1.9.m4.1.1.cmml" xref="S3.SS1.p1.9.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m4.1c">m</annotation></semantics></math>-th domain <math id="S3.SS1.p1.10.m5.1" class="ltx_Math" alttext="D_{m}^{S}" display="inline"><semantics id="S3.SS1.p1.10.m5.1a"><msubsup id="S3.SS1.p1.10.m5.1.1" xref="S3.SS1.p1.10.m5.1.1.cmml"><mi id="S3.SS1.p1.10.m5.1.1.2.2" xref="S3.SS1.p1.10.m5.1.1.2.2.cmml">D</mi><mi id="S3.SS1.p1.10.m5.1.1.2.3" xref="S3.SS1.p1.10.m5.1.1.2.3.cmml">m</mi><mi id="S3.SS1.p1.10.m5.1.1.3" xref="S3.SS1.p1.10.m5.1.1.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m5.1b"><apply id="S3.SS1.p1.10.m5.1.1.cmml" xref="S3.SS1.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.1.1.1.cmml" xref="S3.SS1.p1.10.m5.1.1">superscript</csymbol><apply id="S3.SS1.p1.10.m5.1.1.2.cmml" xref="S3.SS1.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m5.1.1.2.1.cmml" xref="S3.SS1.p1.10.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m5.1.1.2.2.cmml" xref="S3.SS1.p1.10.m5.1.1.2.2">𝐷</ci><ci id="S3.SS1.p1.10.m5.1.1.2.3.cmml" xref="S3.SS1.p1.10.m5.1.1.2.3">𝑚</ci></apply><ci id="S3.SS1.p1.10.m5.1.1.3.cmml" xref="S3.SS1.p1.10.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m5.1c">D_{m}^{S}</annotation></semantics></math> can be represented as <math id="S3.SS1.p1.11.m6.3" class="ltx_Math" alttext="\left\{x_{j},y_{j},d_{m}\right\}^{M_{m}}_{j=1}" display="inline"><semantics id="S3.SS1.p1.11.m6.3a"><msubsup id="S3.SS1.p1.11.m6.3.3" xref="S3.SS1.p1.11.m6.3.3.cmml"><mrow id="S3.SS1.p1.11.m6.3.3.3.3.3" xref="S3.SS1.p1.11.m6.3.3.3.3.4.cmml"><mo id="S3.SS1.p1.11.m6.3.3.3.3.3.4" xref="S3.SS1.p1.11.m6.3.3.3.3.4.cmml">{</mo><msub id="S3.SS1.p1.11.m6.1.1.1.1.1.1" xref="S3.SS1.p1.11.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.11.m6.1.1.1.1.1.1.2" xref="S3.SS1.p1.11.m6.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.11.m6.1.1.1.1.1.1.3" xref="S3.SS1.p1.11.m6.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS1.p1.11.m6.3.3.3.3.3.5" xref="S3.SS1.p1.11.m6.3.3.3.3.4.cmml">,</mo><msub id="S3.SS1.p1.11.m6.2.2.2.2.2.2" xref="S3.SS1.p1.11.m6.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.11.m6.2.2.2.2.2.2.2" xref="S3.SS1.p1.11.m6.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.11.m6.2.2.2.2.2.2.3" xref="S3.SS1.p1.11.m6.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS1.p1.11.m6.3.3.3.3.3.6" xref="S3.SS1.p1.11.m6.3.3.3.3.4.cmml">,</mo><msub id="S3.SS1.p1.11.m6.3.3.3.3.3.3" xref="S3.SS1.p1.11.m6.3.3.3.3.3.3.cmml"><mi id="S3.SS1.p1.11.m6.3.3.3.3.3.3.2" xref="S3.SS1.p1.11.m6.3.3.3.3.3.3.2.cmml">d</mi><mi id="S3.SS1.p1.11.m6.3.3.3.3.3.3.3" xref="S3.SS1.p1.11.m6.3.3.3.3.3.3.3.cmml">m</mi></msub><mo id="S3.SS1.p1.11.m6.3.3.3.3.3.7" xref="S3.SS1.p1.11.m6.3.3.3.3.4.cmml">}</mo></mrow><mrow id="S3.SS1.p1.11.m6.3.3.5" xref="S3.SS1.p1.11.m6.3.3.5.cmml"><mi id="S3.SS1.p1.11.m6.3.3.5.2" xref="S3.SS1.p1.11.m6.3.3.5.2.cmml">j</mi><mo id="S3.SS1.p1.11.m6.3.3.5.1" xref="S3.SS1.p1.11.m6.3.3.5.1.cmml">=</mo><mn id="S3.SS1.p1.11.m6.3.3.5.3" xref="S3.SS1.p1.11.m6.3.3.5.3.cmml">1</mn></mrow><msub id="S3.SS1.p1.11.m6.3.3.3.5" xref="S3.SS1.p1.11.m6.3.3.3.5.cmml"><mi id="S3.SS1.p1.11.m6.3.3.3.5.2" xref="S3.SS1.p1.11.m6.3.3.3.5.2.cmml">M</mi><mi id="S3.SS1.p1.11.m6.3.3.3.5.3" xref="S3.SS1.p1.11.m6.3.3.3.5.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m6.3b"><apply id="S3.SS1.p1.11.m6.3.3.cmml" xref="S3.SS1.p1.11.m6.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m6.3.3.4.cmml" xref="S3.SS1.p1.11.m6.3.3">subscript</csymbol><apply id="S3.SS1.p1.11.m6.3.3.3.cmml" xref="S3.SS1.p1.11.m6.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m6.3.3.3.4.cmml" xref="S3.SS1.p1.11.m6.3.3">superscript</csymbol><set id="S3.SS1.p1.11.m6.3.3.3.3.4.cmml" xref="S3.SS1.p1.11.m6.3.3.3.3.3"><apply id="S3.SS1.p1.11.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m6.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.11.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m6.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS1.p1.11.m6.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.11.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m6.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.11.m6.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m6.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.11.m6.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.11.m6.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.11.m6.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="S3.SS1.p1.11.m6.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.11.m6.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m6.3.3.3.3.3.3.1.cmml" xref="S3.SS1.p1.11.m6.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.11.m6.3.3.3.3.3.3.2.cmml" xref="S3.SS1.p1.11.m6.3.3.3.3.3.3.2">𝑑</ci><ci id="S3.SS1.p1.11.m6.3.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.11.m6.3.3.3.3.3.3.3">𝑚</ci></apply></set><apply id="S3.SS1.p1.11.m6.3.3.3.5.cmml" xref="S3.SS1.p1.11.m6.3.3.3.5"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m6.3.3.3.5.1.cmml" xref="S3.SS1.p1.11.m6.3.3.3.5">subscript</csymbol><ci id="S3.SS1.p1.11.m6.3.3.3.5.2.cmml" xref="S3.SS1.p1.11.m6.3.3.3.5.2">𝑀</ci><ci id="S3.SS1.p1.11.m6.3.3.3.5.3.cmml" xref="S3.SS1.p1.11.m6.3.3.3.5.3">𝑚</ci></apply></apply><apply id="S3.SS1.p1.11.m6.3.3.5.cmml" xref="S3.SS1.p1.11.m6.3.3.5"><eq id="S3.SS1.p1.11.m6.3.3.5.1.cmml" xref="S3.SS1.p1.11.m6.3.3.5.1"></eq><ci id="S3.SS1.p1.11.m6.3.3.5.2.cmml" xref="S3.SS1.p1.11.m6.3.3.5.2">𝑗</ci><cn type="integer" id="S3.SS1.p1.11.m6.3.3.5.3.cmml" xref="S3.SS1.p1.11.m6.3.3.5.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m6.3c">\left\{x_{j},y_{j},d_{m}\right\}^{M_{m}}_{j=1}</annotation></semantics></math> if the domain label of each sample is known and denoted as <math id="S3.SS1.p1.12.m7.1" class="ltx_Math" alttext="d_{m}" display="inline"><semantics id="S3.SS1.p1.12.m7.1a"><msub id="S3.SS1.p1.12.m7.1.1" xref="S3.SS1.p1.12.m7.1.1.cmml"><mi id="S3.SS1.p1.12.m7.1.1.2" xref="S3.SS1.p1.12.m7.1.1.2.cmml">d</mi><mi id="S3.SS1.p1.12.m7.1.1.3" xref="S3.SS1.p1.12.m7.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m7.1b"><apply id="S3.SS1.p1.12.m7.1.1.cmml" xref="S3.SS1.p1.12.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m7.1.1.1.cmml" xref="S3.SS1.p1.12.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m7.1.1.2.cmml" xref="S3.SS1.p1.12.m7.1.1.2">𝑑</ci><ci id="S3.SS1.p1.12.m7.1.1.3.cmml" xref="S3.SS1.p1.12.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m7.1c">d_{m}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.6" class="ltx_p"><span id="S3.SS1.p2.1.1" class="ltx_text" style="color:#000000;">For conventional federated DG settings, the client/domain number is limited and there exists a strict one-to-one mapping between clients and domains (i.e., <math id="S3.SS1.p2.1.1.m1.1" class="ltx_Math" alttext="K=M" display="inline"><semantics id="S3.SS1.p2.1.1.m1.1a"><mrow id="S3.SS1.p2.1.1.m1.1.1" xref="S3.SS1.p2.1.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.p2.1.1.m1.1.1.2" xref="S3.SS1.p2.1.1.m1.1.1.2.cmml">K</mi><mo mathcolor="#000000" id="S3.SS1.p2.1.1.m1.1.1.1" xref="S3.SS1.p2.1.1.m1.1.1.1.cmml">=</mo><mi mathcolor="#000000" id="S3.SS1.p2.1.1.m1.1.1.3" xref="S3.SS1.p2.1.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.1.m1.1b"><apply id="S3.SS1.p2.1.1.m1.1.1.cmml" xref="S3.SS1.p2.1.1.m1.1.1"><eq id="S3.SS1.p2.1.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.1.m1.1.1.1"></eq><ci id="S3.SS1.p2.1.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.1.m1.1.1.2">𝐾</ci><ci id="S3.SS1.p2.1.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.1.m1.1c">K=M</annotation></semantics></math>). </span>
<span id="S3.SS1.p2.6.4" class="ltx_text" style="color:#000000;">In contrast,</span> we relax the above limitation into cross-device scenarios, allowing for greater flexibility in choosing the number of clients. <math id="S3.SS1.p2.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p2.2.m1.1a"><mi mathcolor="#000000" id="S3.SS1.p2.2.m1.1.1" xref="S3.SS1.p2.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m1.1b"><ci id="S3.SS1.p2.2.m1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m1.1c">K</annotation></semantics></math><span id="S3.SS1.p2.4.3" class="ltx_text" style="color:#000000;"> can significantly exceed <math id="S3.SS1.p2.3.2.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p2.3.2.m1.1a"><mi mathcolor="#000000" id="S3.SS1.p2.3.2.m1.1.1" xref="S3.SS1.p2.3.2.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.2.m1.1b"><ci id="S3.SS1.p2.3.2.m1.1.1.cmml" xref="S3.SS1.p2.3.2.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.2.m1.1c">M</annotation></semantics></math> (i.e., <math id="S3.SS1.p2.4.3.m2.1" class="ltx_Math" alttext="K\gg M" display="inline"><semantics id="S3.SS1.p2.4.3.m2.1a"><mrow id="S3.SS1.p2.4.3.m2.1.1" xref="S3.SS1.p2.4.3.m2.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.p2.4.3.m2.1.1.2" xref="S3.SS1.p2.4.3.m2.1.1.2.cmml">K</mi><mo mathcolor="#000000" id="S3.SS1.p2.4.3.m2.1.1.1" xref="S3.SS1.p2.4.3.m2.1.1.1.cmml">≫</mo><mi mathcolor="#000000" id="S3.SS1.p2.4.3.m2.1.1.3" xref="S3.SS1.p2.4.3.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.3.m2.1b"><apply id="S3.SS1.p2.4.3.m2.1.1.cmml" xref="S3.SS1.p2.4.3.m2.1.1"><csymbol cd="latexml" id="S3.SS1.p2.4.3.m2.1.1.1.cmml" xref="S3.SS1.p2.4.3.m2.1.1.1">much-greater-than</csymbol><ci id="S3.SS1.p2.4.3.m2.1.1.2.cmml" xref="S3.SS1.p2.4.3.m2.1.1.2">𝐾</ci><ci id="S3.SS1.p2.4.3.m2.1.1.3.cmml" xref="S3.SS1.p2.4.3.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.3.m2.1c">K\gg M</annotation></semantics></math>) and multiple clients may possess datasets originating from a common domain. </span>
Meanwhile, we consider a more practical requirement called latent domain generalization, where <math id="S3.SS1.p2.5.m2.2" class="ltx_Math" alttext="D_{m}^{S}=\left\{x_{j},y_{j}\right\}^{M_{m}}_{j=1}" display="inline"><semantics id="S3.SS1.p2.5.m2.2a"><mrow id="S3.SS1.p2.5.m2.2.2" xref="S3.SS1.p2.5.m2.2.2.cmml"><msubsup id="S3.SS1.p2.5.m2.2.2.4" xref="S3.SS1.p2.5.m2.2.2.4.cmml"><mi id="S3.SS1.p2.5.m2.2.2.4.2.2" xref="S3.SS1.p2.5.m2.2.2.4.2.2.cmml">D</mi><mi id="S3.SS1.p2.5.m2.2.2.4.2.3" xref="S3.SS1.p2.5.m2.2.2.4.2.3.cmml">m</mi><mi id="S3.SS1.p2.5.m2.2.2.4.3" xref="S3.SS1.p2.5.m2.2.2.4.3.cmml">S</mi></msubsup><mo id="S3.SS1.p2.5.m2.2.2.3" xref="S3.SS1.p2.5.m2.2.2.3.cmml">=</mo><msubsup id="S3.SS1.p2.5.m2.2.2.2" xref="S3.SS1.p2.5.m2.2.2.2.cmml"><mrow id="S3.SS1.p2.5.m2.2.2.2.2.2.2" xref="S3.SS1.p2.5.m2.2.2.2.2.2.3.cmml"><mo id="S3.SS1.p2.5.m2.2.2.2.2.2.2.3" xref="S3.SS1.p2.5.m2.2.2.2.2.2.3.cmml">{</mo><msub id="S3.SS1.p2.5.m2.1.1.1.1.1.1.1" xref="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS1.p2.5.m2.2.2.2.2.2.2.4" xref="S3.SS1.p2.5.m2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.5.m2.2.2.2.2.2.2.2" xref="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.2" xref="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.3" xref="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS1.p2.5.m2.2.2.2.2.2.2.5" xref="S3.SS1.p2.5.m2.2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS1.p2.5.m2.2.2.2.4" xref="S3.SS1.p2.5.m2.2.2.2.4.cmml"><mi id="S3.SS1.p2.5.m2.2.2.2.4.2" xref="S3.SS1.p2.5.m2.2.2.2.4.2.cmml">j</mi><mo id="S3.SS1.p2.5.m2.2.2.2.4.1" xref="S3.SS1.p2.5.m2.2.2.2.4.1.cmml">=</mo><mn id="S3.SS1.p2.5.m2.2.2.2.4.3" xref="S3.SS1.p2.5.m2.2.2.2.4.3.cmml">1</mn></mrow><msub id="S3.SS1.p2.5.m2.2.2.2.2.4" xref="S3.SS1.p2.5.m2.2.2.2.2.4.cmml"><mi id="S3.SS1.p2.5.m2.2.2.2.2.4.2" xref="S3.SS1.p2.5.m2.2.2.2.2.4.2.cmml">M</mi><mi id="S3.SS1.p2.5.m2.2.2.2.2.4.3" xref="S3.SS1.p2.5.m2.2.2.2.2.4.3.cmml">m</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m2.2b"><apply id="S3.SS1.p2.5.m2.2.2.cmml" xref="S3.SS1.p2.5.m2.2.2"><eq id="S3.SS1.p2.5.m2.2.2.3.cmml" xref="S3.SS1.p2.5.m2.2.2.3"></eq><apply id="S3.SS1.p2.5.m2.2.2.4.cmml" xref="S3.SS1.p2.5.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m2.2.2.4.1.cmml" xref="S3.SS1.p2.5.m2.2.2.4">superscript</csymbol><apply id="S3.SS1.p2.5.m2.2.2.4.2.cmml" xref="S3.SS1.p2.5.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m2.2.2.4.2.1.cmml" xref="S3.SS1.p2.5.m2.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.5.m2.2.2.4.2.2.cmml" xref="S3.SS1.p2.5.m2.2.2.4.2.2">𝐷</ci><ci id="S3.SS1.p2.5.m2.2.2.4.2.3.cmml" xref="S3.SS1.p2.5.m2.2.2.4.2.3">𝑚</ci></apply><ci id="S3.SS1.p2.5.m2.2.2.4.3.cmml" xref="S3.SS1.p2.5.m2.2.2.4.3">𝑆</ci></apply><apply id="S3.SS1.p2.5.m2.2.2.2.cmml" xref="S3.SS1.p2.5.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m2.2.2.2.3.cmml" xref="S3.SS1.p2.5.m2.2.2.2">subscript</csymbol><apply id="S3.SS1.p2.5.m2.2.2.2.2.cmml" xref="S3.SS1.p2.5.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m2.2.2.2.2.3.cmml" xref="S3.SS1.p2.5.m2.2.2.2">superscript</csymbol><set id="S3.SS1.p2.5.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.2.2"><apply id="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.5.m2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.2.2.2.3">𝑗</ci></apply></set><apply id="S3.SS1.p2.5.m2.2.2.2.2.4.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m2.2.2.2.2.4.1.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.5.m2.2.2.2.2.4.2.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.4.2">𝑀</ci><ci id="S3.SS1.p2.5.m2.2.2.2.2.4.3.cmml" xref="S3.SS1.p2.5.m2.2.2.2.2.4.3">𝑚</ci></apply></apply><apply id="S3.SS1.p2.5.m2.2.2.2.4.cmml" xref="S3.SS1.p2.5.m2.2.2.2.4"><eq id="S3.SS1.p2.5.m2.2.2.2.4.1.cmml" xref="S3.SS1.p2.5.m2.2.2.2.4.1"></eq><ci id="S3.SS1.p2.5.m2.2.2.2.4.2.cmml" xref="S3.SS1.p2.5.m2.2.2.2.4.2">𝑗</ci><cn type="integer" id="S3.SS1.p2.5.m2.2.2.2.4.3.cmml" xref="S3.SS1.p2.5.m2.2.2.2.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m2.2c">D_{m}^{S}=\left\{x_{j},y_{j}\right\}^{M_{m}}_{j=1}</annotation></semantics></math> since domain label <math id="S3.SS1.p2.6.m3.1" class="ltx_Math" alttext="d_{m}" display="inline"><semantics id="S3.SS1.p2.6.m3.1a"><msub id="S3.SS1.p2.6.m3.1.1" xref="S3.SS1.p2.6.m3.1.1.cmml"><mi id="S3.SS1.p2.6.m3.1.1.2" xref="S3.SS1.p2.6.m3.1.1.2.cmml">d</mi><mi id="S3.SS1.p2.6.m3.1.1.3" xref="S3.SS1.p2.6.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m3.1b"><apply id="S3.SS1.p2.6.m3.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m3.1.1.1.cmml" xref="S3.SS1.p2.6.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m3.1.1.2.cmml" xref="S3.SS1.p2.6.m3.1.1.2">𝑑</ci><ci id="S3.SS1.p2.6.m3.1.1.3.cmml" xref="S3.SS1.p2.6.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m3.1c">d_{m}</annotation></semantics></math> is not given.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Disentangled Prompt Learning</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Although learning a single shared prompt across all source domains/clients enables extracting invariant knowledge, it may be too casual and filter out valuable information that only appeared on a subset of clients, especially when the number of clients dramatically exceeds the volume of source domains. Thus, we present disentangled prompt learning, which includes two key subcomponents: global prompt tuning and domain prompt tuning. The former aims to achieve global optimization across all clients, and the latter is utilized to extract valuable specific knowledge from different domains. We will make a detailed introduction for them as follows.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Global Prompt Tuning (G-Prompt)</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.14" class="ltx_p">To capture generic characteristics shared among all clients, G-Prompt performs global optimization using a single prompt. Concretely, each client is equipped with a pre-trained vision-language model (CLIP), which includes a frozen text encoder <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">g</annotation></semantics></math> and visual encoder <math id="S3.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mi id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">f</annotation></semantics></math>. Given an image <math id="S3.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mi id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><ci id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">x</annotation></semantics></math> along with its label <math id="S3.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mi id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">y</annotation></semantics></math>, the visual embeddings <math id="S3.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="I=f(x)" display="inline"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><mrow id="S3.SS2.SSS1.p1.5.m5.1.2" xref="S3.SS2.SSS1.p1.5.m5.1.2.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.2.2" xref="S3.SS2.SSS1.p1.5.m5.1.2.2.cmml">I</mi><mo id="S3.SS2.SSS1.p1.5.m5.1.2.1" xref="S3.SS2.SSS1.p1.5.m5.1.2.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.5.m5.1.2.3" xref="S3.SS2.SSS1.p1.5.m5.1.2.3.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.2.3.2" xref="S3.SS2.SSS1.p1.5.m5.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.5.m5.1.2.3.1" xref="S3.SS2.SSS1.p1.5.m5.1.2.3.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p1.5.m5.1.2.3.3.2" xref="S3.SS2.SSS1.p1.5.m5.1.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.5.m5.1.2.3.3.2.1" xref="S3.SS2.SSS1.p1.5.m5.1.2.3.cmml">(</mo><mi id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.SSS1.p1.5.m5.1.2.3.3.2.2" xref="S3.SS2.SSS1.p1.5.m5.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.p1.5.m5.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.2"><eq id="S3.SS2.SSS1.p1.5.m5.1.2.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.2.1"></eq><ci id="S3.SS2.SSS1.p1.5.m5.1.2.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.2.2">𝐼</ci><apply id="S3.SS2.SSS1.p1.5.m5.1.2.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.2.3"><times id="S3.SS2.SSS1.p1.5.m5.1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.2.3.1"></times><ci id="S3.SS2.SSS1.p1.5.m5.1.2.3.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.2.3.2">𝑓</ci><ci id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">I=f(x)</annotation></semantics></math> can be extracted by the visual encoder. For text embeddings, the context prompt is a set of <math id="S3.SS2.SSS1.p1.6.m6.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mi id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><ci id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">L</annotation></semantics></math> learnable vectors <math id="S3.SS2.SSS1.p1.7.m7.4" class="ltx_Math" alttext="V^{G}=\left\{v_{1}^{G},v_{2}^{G},...,v_{L}^{G}\right\}" display="inline"><semantics id="S3.SS2.SSS1.p1.7.m7.4a"><mrow id="S3.SS2.SSS1.p1.7.m7.4.4" xref="S3.SS2.SSS1.p1.7.m7.4.4.cmml"><msup id="S3.SS2.SSS1.p1.7.m7.4.4.5" xref="S3.SS2.SSS1.p1.7.m7.4.4.5.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.4.4.5.2" xref="S3.SS2.SSS1.p1.7.m7.4.4.5.2.cmml">V</mi><mi id="S3.SS2.SSS1.p1.7.m7.4.4.5.3" xref="S3.SS2.SSS1.p1.7.m7.4.4.5.3.cmml">G</mi></msup><mo id="S3.SS2.SSS1.p1.7.m7.4.4.4" xref="S3.SS2.SSS1.p1.7.m7.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.7.m7.4.4.3.3" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.4.cmml"><mo id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.4" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.4.cmml">{</mo><msubsup id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.2.cmml">v</mi><mn id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.3" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.3.cmml">G</mi></msubsup><mo id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.5" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.2.cmml">v</mi><mn id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.3" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.3" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.3.cmml">G</mi></msubsup><mo id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.6" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p1.7.m7.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.7" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.2" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.2.cmml">v</mi><mi id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.3" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.3.cmml">L</mi><mi id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.3" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.3.cmml">G</mi></msubsup><mo id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.8" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m7.4b"><apply id="S3.SS2.SSS1.p1.7.m7.4.4.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4"><eq id="S3.SS2.SSS1.p1.7.m7.4.4.4.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.4"></eq><apply id="S3.SS2.SSS1.p1.7.m7.4.4.5.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.4.4.5.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.5">superscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.4.4.5.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.5.2">𝑉</ci><ci id="S3.SS2.SSS1.p1.7.m7.4.4.5.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.5.3">𝐺</ci></apply><set id="S3.SS2.SSS1.p1.7.m7.4.4.3.4.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3"><apply id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.2">𝑣</ci><cn type="integer" id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.1.1.1.3">𝐺</ci></apply><apply id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.2">𝑣</ci><cn type="integer" id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.3.3.2.2.2.3">𝐺</ci></apply><ci id="S3.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1">…</ci><apply id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.2">𝑣</ci><ci id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.2.3">𝐿</ci></apply><ci id="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.3.3.3.3">𝐺</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m7.4c">V^{G}=\left\{v_{1}^{G},v_{2}^{G},...,v_{L}^{G}\right\}</annotation></semantics></math>, where the embedding dimension of each element is <math id="S3.SS2.SSS1.p1.8.m8.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.SSS1.p1.8.m8.1a"><mi id="S3.SS2.SSS1.p1.8.m8.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m8.1b"><ci id="S3.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m8.1c">d</annotation></semantics></math>. For the <math id="S3.SS2.SSS1.p1.9.m9.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS1.p1.9.m9.1a"><mi id="S3.SS2.SSS1.p1.9.m9.1.1" xref="S3.SS2.SSS1.p1.9.m9.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.9.m9.1b"><ci id="S3.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m9.1c">j</annotation></semantics></math>-th class, the whole input for the text encoder is
<math id="S3.SS2.SSS1.p1.10.m10.2" class="ltx_Math" alttext="t_{j}=\left\{V_{g},c_{j}\right\}" display="inline"><semantics id="S3.SS2.SSS1.p1.10.m10.2a"><mrow id="S3.SS2.SSS1.p1.10.m10.2.2" xref="S3.SS2.SSS1.p1.10.m10.2.2.cmml"><msub id="S3.SS2.SSS1.p1.10.m10.2.2.4" xref="S3.SS2.SSS1.p1.10.m10.2.2.4.cmml"><mi id="S3.SS2.SSS1.p1.10.m10.2.2.4.2" xref="S3.SS2.SSS1.p1.10.m10.2.2.4.2.cmml">t</mi><mi id="S3.SS2.SSS1.p1.10.m10.2.2.4.3" xref="S3.SS2.SSS1.p1.10.m10.2.2.4.3.cmml">j</mi></msub><mo id="S3.SS2.SSS1.p1.10.m10.2.2.3" xref="S3.SS2.SSS1.p1.10.m10.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.10.m10.2.2.2.2" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.3.cmml"><mo id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.3" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.3.cmml">{</mo><msub id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.2.cmml">V</mi><mi id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.3.cmml">g</mi></msub><mo id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.4" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.2" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.2.cmml">c</mi><mi id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.3" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.5" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.10.m10.2b"><apply id="S3.SS2.SSS1.p1.10.m10.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2"><eq id="S3.SS2.SSS1.p1.10.m10.2.2.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.3"></eq><apply id="S3.SS2.SSS1.p1.10.m10.2.2.4.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.2.2.4.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m10.2.2.4.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.4.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.10.m10.2.2.4.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.4.3">𝑗</ci></apply><set id="S3.SS2.SSS1.p1.10.m10.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.2"><apply id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.2">𝑉</ci><ci id="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.2">𝑐</ci><ci id="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.2.2.2.2.2.3">𝑗</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.10.m10.2c">t_{j}=\left\{V_{g},c_{j}\right\}</annotation></semantics></math>, <span id="S3.SS2.SSS1.p1.13.3" class="ltx_text" style="color:#000000;">where <math id="S3.SS2.SSS1.p1.11.1.m1.1" class="ltx_Math" alttext="c_{j}" display="inline"><semantics id="S3.SS2.SSS1.p1.11.1.m1.1a"><msub id="S3.SS2.SSS1.p1.11.1.m1.1.1" xref="S3.SS2.SSS1.p1.11.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS1.p1.11.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.11.1.m1.1.1.2.cmml">c</mi><mi mathcolor="#000000" id="S3.SS2.SSS1.p1.11.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.11.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.11.1.m1.1b"><apply id="S3.SS2.SSS1.p1.11.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.11.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.11.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.11.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.11.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.11.1.m1.1.1.2">𝑐</ci><ci id="S3.SS2.SSS1.p1.11.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.11.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.11.1.m1.1c">c_{j}</annotation></semantics></math> indicates the word embedding corresponding to <math id="S3.SS2.SSS1.p1.12.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS1.p1.12.2.m2.1a"><mi mathcolor="#000000" id="S3.SS2.SSS1.p1.12.2.m2.1.1" xref="S3.SS2.SSS1.p1.12.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.12.2.m2.1b"><ci id="S3.SS2.SSS1.p1.12.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.12.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.12.2.m2.1c">j</annotation></semantics></math>-th class name with the same embedding dimension <math id="S3.SS2.SSS1.p1.13.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.SSS1.p1.13.3.m3.1a"><mi mathcolor="#000000" id="S3.SS2.SSS1.p1.13.3.m3.1.1" xref="S3.SS2.SSS1.p1.13.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.13.3.m3.1b"><ci id="S3.SS2.SSS1.p1.13.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.13.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.13.3.m3.1c">d</annotation></semantics></math></span>. Thus, we can obtain corresponding text embeddings as <math id="S3.SS2.SSS1.p1.14.m11.1" class="ltx_Math" alttext="Z_{j}^{G}=g(t_{j})" display="inline"><semantics id="S3.SS2.SSS1.p1.14.m11.1a"><mrow id="S3.SS2.SSS1.p1.14.m11.1.1" xref="S3.SS2.SSS1.p1.14.m11.1.1.cmml"><msubsup id="S3.SS2.SSS1.p1.14.m11.1.1.3" xref="S3.SS2.SSS1.p1.14.m11.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.14.m11.1.1.3.2.2" xref="S3.SS2.SSS1.p1.14.m11.1.1.3.2.2.cmml">Z</mi><mi id="S3.SS2.SSS1.p1.14.m11.1.1.3.2.3" xref="S3.SS2.SSS1.p1.14.m11.1.1.3.2.3.cmml">j</mi><mi id="S3.SS2.SSS1.p1.14.m11.1.1.3.3" xref="S3.SS2.SSS1.p1.14.m11.1.1.3.3.cmml">G</mi></msubsup><mo id="S3.SS2.SSS1.p1.14.m11.1.1.2" xref="S3.SS2.SSS1.p1.14.m11.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.14.m11.1.1.1" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.14.m11.1.1.1.3" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.14.m11.1.1.1.2" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.2.cmml">t</mi><mi id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.14.m11.1b"><apply id="S3.SS2.SSS1.p1.14.m11.1.1.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1"><eq id="S3.SS2.SSS1.p1.14.m11.1.1.2.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.2"></eq><apply id="S3.SS2.SSS1.p1.14.m11.1.1.3.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.14.m11.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.3">superscript</csymbol><apply id="S3.SS2.SSS1.p1.14.m11.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.14.m11.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.14.m11.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.3.2.2">𝑍</ci><ci id="S3.SS2.SSS1.p1.14.m11.1.1.3.2.3.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.3.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS1.p1.14.m11.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.3.3">𝐺</ci></apply><apply id="S3.SS2.SSS1.p1.14.m11.1.1.1.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.1"><times id="S3.SS2.SSS1.p1.14.m11.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.2"></times><ci id="S3.SS2.SSS1.p1.14.m11.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.3">𝑔</ci><apply id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.14.m11.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.14.m11.1c">Z_{j}^{G}=g(t_{j})</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.2" class="ltx_p">Furthermore, the local model computes the prediction probability <math id="S3.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="P(y=j|x)" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mrow id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.1.m1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.2.cmml">j</mi><mo fence="false" id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1"><times id="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.2"></times><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3">𝑃</ci><apply id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1"><eq id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.1"></eq><ci id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.2">𝑦</ci><apply id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">P(y=j|x)</annotation></semantics></math> using the extracted image-text embeddings pair, which maximizes the cosine similarity score <math id="S3.SS2.SSS1.p2.2.m2.2" class="ltx_Math" alttext="{\rm sim}(\cdot,\cdot)" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.2a"><mrow id="S3.SS2.SSS1.p2.2.m2.2.3" xref="S3.SS2.SSS1.p2.2.m2.2.3.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.2.3.2" xref="S3.SS2.SSS1.p2.2.m2.2.3.2.cmml">sim</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.2.m2.2.3.1" xref="S3.SS2.SSS1.p2.2.m2.2.3.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p2.2.m2.2.3.3.2" xref="S3.SS2.SSS1.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.2.m2.2.3.3.2.1" xref="S3.SS2.SSS1.p2.2.m2.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.SSS1.p2.2.m2.2.3.3.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.2.m2.2.2" xref="S3.SS2.SSS1.p2.2.m2.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.SSS1.p2.2.m2.2.3.3.2.3" xref="S3.SS2.SSS1.p2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.2b"><apply id="S3.SS2.SSS1.p2.2.m2.2.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.3"><times id="S3.SS2.SSS1.p2.2.m2.2.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.3.1"></times><ci id="S3.SS2.SSS1.p2.2.m2.2.3.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.3.2">sim</ci><interval closure="open" id="S3.SS2.SSS1.p2.2.m2.2.3.3.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.3.3.2"><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">⋅</ci><ci id="S3.SS2.SSS1.p2.2.m2.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.2c">{\rm sim}(\cdot,\cdot)</annotation></semantics></math> for the correct pairs while minimizing those incorrect pairs. It can be formularized as:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.5" class="ltx_Math" alttext="P_{g}(y=j|x)=\frac{{\rm exp}({\rm sim}(I,Z_{j})/\tau)}{\sum_{i=1}^{C}{\rm exp}({\rm sim}(I,Z_{i})/\tau)}," display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml"><msub id="S3.E1.m1.5.5.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.3.2.cmml">P</mi><mi id="S3.E1.m1.5.5.1.1.1.3.3" xref="S3.E1.m1.5.5.1.1.1.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.2.cmml">j</mi><mo fence="false" id="S3.E1.m1.5.5.1.1.1.1.1.1.3.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml">=</mo><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.1.3.cmml">sim</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.1.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.2.2.1.1.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">I</mi><mo id="S3.E1.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.1.1.2.cmml">,</mo><msub id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">Z</mi><mi id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E1.m1.2.2.2.2.1.1.1.1.1.4" xref="S3.E1.m1.2.2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.2.cmml">/</mo><mi id="S3.E1.m1.2.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E1.m1.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.4.4.4" xref="S3.E1.m1.4.4.4.cmml"><msubsup id="S3.E1.m1.4.4.4.3" xref="S3.E1.m1.4.4.4.3.cmml"><mo id="S3.E1.m1.4.4.4.3.2.2" xref="S3.E1.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.4.4.4.3.2.3" xref="S3.E1.m1.4.4.4.3.2.3.cmml"><mi id="S3.E1.m1.4.4.4.3.2.3.2" xref="S3.E1.m1.4.4.4.3.2.3.2.cmml">i</mi><mo id="S3.E1.m1.4.4.4.3.2.3.1" xref="S3.E1.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.4.4.4.3.2.3.3" xref="S3.E1.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.4.4.4.3.3" xref="S3.E1.m1.4.4.4.3.3.cmml">C</mi></msubsup><mrow id="S3.E1.m1.4.4.4.2" xref="S3.E1.m1.4.4.4.2.cmml"><mi id="S3.E1.m1.4.4.4.2.3" xref="S3.E1.m1.4.4.4.2.3.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.2.2" xref="S3.E1.m1.4.4.4.2.2.cmml">​</mo><mrow id="S3.E1.m1.4.4.4.2.1.1" xref="S3.E1.m1.4.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.4.2.1.1.2" xref="S3.E1.m1.4.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.4.4.4.2.1.1.1" xref="S3.E1.m1.4.4.4.2.1.1.1.cmml"><mrow id="S3.E1.m1.4.4.4.2.1.1.1.1" xref="S3.E1.m1.4.4.4.2.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.4.2.1.1.1.1.3" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.cmml">sim</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.2.1.1.1.1.2" xref="S3.E1.m1.4.4.4.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.3.3.3.1" xref="S3.E1.m1.3.3.3.1.cmml">I</mi><mo id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml">Z</mi><mi id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.4" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.4.2.1.1.1.2" xref="S3.E1.m1.4.4.4.2.1.1.1.2.cmml">/</mo><mi id="S3.E1.m1.4.4.4.2.1.1.1.3" xref="S3.E1.m1.4.4.4.2.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E1.m1.4.4.4.2.1.1.3" xref="S3.E1.m1.4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"></eq><apply id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"><times id="S3.E1.m1.5.5.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2"></times><apply id="S3.E1.m1.5.5.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.3.2">𝑃</ci><ci id="S3.E1.m1.5.5.1.1.1.3.3.cmml" xref="S3.E1.m1.5.5.1.1.1.3.3">𝑔</ci></apply><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1"><eq id="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1"></eq><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><divide id="S3.E1.m1.4.4.5.cmml" xref="S3.E1.m1.4.4"></divide><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><times id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></times><ci id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4">exp</ci><apply id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1"><divide id="S3.E1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2"></divide><apply id="S3.E1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1"><times id="S3.E1.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.2"></times><ci id="S3.E1.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.3">sim</ci><interval closure="open" id="S3.E1.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝐼</ci><apply id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.2">𝑍</ci><ci id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.3">𝑗</ci></apply></interval></apply><ci id="S3.E1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3">𝜏</ci></apply></apply><apply id="S3.E1.m1.4.4.4.cmml" xref="S3.E1.m1.4.4.4"><apply id="S3.E1.m1.4.4.4.3.cmml" xref="S3.E1.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.3.1.cmml" xref="S3.E1.m1.4.4.4.3">superscript</csymbol><apply id="S3.E1.m1.4.4.4.3.2.cmml" xref="S3.E1.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.3.2.1.cmml" xref="S3.E1.m1.4.4.4.3">subscript</csymbol><sum id="S3.E1.m1.4.4.4.3.2.2.cmml" xref="S3.E1.m1.4.4.4.3.2.2"></sum><apply id="S3.E1.m1.4.4.4.3.2.3.cmml" xref="S3.E1.m1.4.4.4.3.2.3"><eq id="S3.E1.m1.4.4.4.3.2.3.1.cmml" xref="S3.E1.m1.4.4.4.3.2.3.1"></eq><ci id="S3.E1.m1.4.4.4.3.2.3.2.cmml" xref="S3.E1.m1.4.4.4.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.4.4.4.3.2.3.3.cmml" xref="S3.E1.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.4.4.4.3.3.cmml" xref="S3.E1.m1.4.4.4.3.3">𝐶</ci></apply><apply id="S3.E1.m1.4.4.4.2.cmml" xref="S3.E1.m1.4.4.4.2"><times id="S3.E1.m1.4.4.4.2.2.cmml" xref="S3.E1.m1.4.4.4.2.2"></times><ci id="S3.E1.m1.4.4.4.2.3.cmml" xref="S3.E1.m1.4.4.4.2.3">exp</ci><apply id="S3.E1.m1.4.4.4.2.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1"><divide id="S3.E1.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.2"></divide><apply id="S3.E1.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1"><times id="S3.E1.m1.4.4.4.2.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.2"></times><ci id="S3.E1.m1.4.4.4.2.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3">sim</ci><interval closure="open" id="S3.E1.m1.4.4.4.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.1"><ci id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1">𝐼</ci><apply id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.2">𝑍</ci><ci id="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply><ci id="S3.E1.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">P_{g}(y=j|x)=\frac{{\rm exp}({\rm sim}(I,Z_{j})/\tau)}{\sum_{i=1}^{C}{\rm exp}({\rm sim}(I,Z_{i})/\tau)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p2.3" class="ltx_p">where <math id="S3.SS2.SSS1.p2.3.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m1.1a"><mi id="S3.SS2.SSS1.p2.3.m1.1.1" xref="S3.SS2.SSS1.p2.3.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m1.1b"><ci id="S3.SS2.SSS1.p2.3.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m1.1c">C</annotation></semantics></math> is the number of categories. We optimize the global prompt with the cross-entropy loss between the prediction probability and its label during local iterations as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.6" class="ltx_Math" alttext="\mathcal{L}_{G}(x,y)=\mathbb{E}_{x,j}\mathcal{L}_{ce}(y,P_{g}(y=j|x))." display="block"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.3" xref="S3.E2.m1.6.6.1.1.3.cmml"><msub id="S3.E2.m1.6.6.1.1.3.2" xref="S3.E2.m1.6.6.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.1.1.3.2.2" xref="S3.E2.m1.6.6.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E2.m1.6.6.1.1.3.2.3" xref="S3.E2.m1.6.6.1.1.3.2.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.3.1" xref="S3.E2.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.3.3.2" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.3.3.2.1" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">x</mi><mo id="S3.E2.m1.6.6.1.1.3.3.2.2" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">,</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E2.m1.6.6.1.1.3.3.2.3" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.2" xref="S3.E2.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml"><msub id="S3.E2.m1.6.6.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">x</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.2.cmml">​</mo><msub id="S3.E2.m1.6.6.1.1.1.4" xref="S3.E2.m1.6.6.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.1.1.1.4.2" xref="S3.E2.m1.6.6.1.1.1.4.2.cmml">ℒ</mi><mrow id="S3.E2.m1.6.6.1.1.1.4.3" xref="S3.E2.m1.6.6.1.1.1.4.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.4.3.2" xref="S3.E2.m1.6.6.1.1.1.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.4.3.1" xref="S3.E2.m1.6.6.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E2.m1.6.6.1.1.1.4.3.3" xref="S3.E2.m1.6.6.1.1.1.4.3.3.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.2a" xref="S3.E2.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">y</mi><mo id="S3.E2.m1.6.6.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">,</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.6.6.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.2.cmml">P</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.3.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml">j</mi><mo fence="false" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo stretchy="false" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.6.6.1.1.1.1.1.4" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.6.6.1.2" xref="S3.E2.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2"></eq><apply id="S3.E2.m1.6.6.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.3"><times id="S3.E2.m1.6.6.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.1"></times><apply id="S3.E2.m1.6.6.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.3.2.1.cmml" xref="S3.E2.m1.6.6.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.3.2.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2.2">ℒ</ci><ci id="S3.E2.m1.6.6.1.1.3.2.3.cmml" xref="S3.E2.m1.6.6.1.1.3.2.3">𝐺</ci></apply><interval closure="open" id="S3.E2.m1.6.6.1.1.3.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.3.2"><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑥</ci><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝑦</ci></interval></apply><apply id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"></times><apply id="S3.E2.m1.6.6.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.3.2">𝔼</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑥</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E2.m1.6.6.1.1.1.4.cmml" xref="S3.E2.m1.6.6.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.4.1.cmml" xref="S3.E2.m1.6.6.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.4.2.cmml" xref="S3.E2.m1.6.6.1.1.1.4.2">ℒ</ci><apply id="S3.E2.m1.6.6.1.1.1.4.3.cmml" xref="S3.E2.m1.6.6.1.1.1.4.3"><times id="S3.E2.m1.6.6.1.1.1.4.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.4.3.1"></times><ci id="S3.E2.m1.6.6.1.1.1.4.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.4.3.2">𝑐</ci><ci id="S3.E2.m1.6.6.1.1.1.4.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.4.3.3">𝑒</ci></apply></apply><interval closure="open" id="S3.E2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1"><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝑦</ci><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.2">𝑃</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.3">𝑔</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1"><eq id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1"></eq><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">\mathcal{L}_{G}(x,y)=\mathbb{E}_{x,j}\mathcal{L}_{ce}(y,P_{g}(y=j|x)).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Domain Prompts Tuning (D-Prompts)</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.9" class="ltx_p"><span id="S3.SS2.SSS2.p1.9.1" class="ltx_text" style="color:#000000;">While G-Prompt acquires generic knowledge across all clients, it may overlook other valuable information from diverse clients. This is particularly evident when the number of clients significantly surpasses the domains, and diverse clients may hold data originating from a shared domain.</span>
<span id="S3.SS2.SSS2.p1.9.2" class="ltx_text" style="color:#000000;">To this end, we devise domain-specific prototypical prompts, to separately extract the distinct knowledge from the corresponding domains.</span> Specifically, we build a pool of domain-wise prompt pool <math id="S3.SS2.SSS2.p1.1.m1.3" class="ltx_Math" alttext="V^{D}=\left\{V_{1}^{D},...,V_{M}^{D}\right\}" display="inline"><semantics id="S3.SS2.SSS2.p1.1.m1.3a"><mrow id="S3.SS2.SSS2.p1.1.m1.3.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.cmml"><msup id="S3.SS2.SSS2.p1.1.m1.3.3.4" xref="S3.SS2.SSS2.p1.1.m1.3.3.4.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.3.3.4.2" xref="S3.SS2.SSS2.p1.1.m1.3.3.4.2.cmml">V</mi><mi id="S3.SS2.SSS2.p1.1.m1.3.3.4.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.4.3.cmml">D</mi></msup><mo id="S3.SS2.SSS2.p1.1.m1.3.3.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.1.m1.3.3.2.2" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.3.cmml"><mo id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.3.cmml">{</mo><msubsup id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.2.cmml">V</mi><mn id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.3" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.3.cmml">D</mi></msubsup><mo id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.4" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.5" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.2.cmml">V</mi><mi id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.3.cmml">M</mi><mi id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.3.cmml">D</mi></msubsup><mo id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.6" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.3b"><apply id="S3.SS2.SSS2.p1.1.m1.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3"><eq id="S3.SS2.SSS2.p1.1.m1.3.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3"></eq><apply id="S3.SS2.SSS2.p1.1.m1.3.3.4.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.3.3.4.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.4">superscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.3.3.4.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.4.2">𝑉</ci><ci id="S3.SS2.SSS2.p1.1.m1.3.3.4.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.4.3">𝐷</ci></apply><set id="S3.SS2.SSS2.p1.1.m1.3.3.2.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2"><apply id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.2">𝑉</ci><cn type="integer" id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.3">𝐷</ci></apply><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.2">𝑉</ci><ci id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.2.3">𝑀</ci></apply><ci id="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.2.2.2.3">𝐷</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.3c">V^{D}=\left\{V_{1}^{D},...,V_{M}^{D}\right\}</annotation></semantics></math>, where <math id="S3.SS2.SSS2.p1.2.m2.5" class="ltx_Math" alttext="V_{m}^{D}=\left\{v_{1}^{D},v_{2}^{D},...,v_{L}^{D},s_{m}\right\}" display="inline"><semantics id="S3.SS2.SSS2.p1.2.m2.5a"><mrow id="S3.SS2.SSS2.p1.2.m2.5.5" xref="S3.SS2.SSS2.p1.2.m2.5.5.cmml"><msubsup id="S3.SS2.SSS2.p1.2.m2.5.5.6" xref="S3.SS2.SSS2.p1.2.m2.5.5.6.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.5.5.6.2.2" xref="S3.SS2.SSS2.p1.2.m2.5.5.6.2.2.cmml">V</mi><mi id="S3.SS2.SSS2.p1.2.m2.5.5.6.2.3" xref="S3.SS2.SSS2.p1.2.m2.5.5.6.2.3.cmml">m</mi><mi id="S3.SS2.SSS2.p1.2.m2.5.5.6.3" xref="S3.SS2.SSS2.p1.2.m2.5.5.6.3.cmml">D</mi></msubsup><mo id="S3.SS2.SSS2.p1.2.m2.5.5.5" xref="S3.SS2.SSS2.p1.2.m2.5.5.5.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.2.m2.5.5.4.4" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.5.cmml"><mo id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.5" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.5.cmml">{</mo><msubsup id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.2" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.2.cmml">v</mi><mn id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.3" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.3.cmml">D</mi></msubsup><mo id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.6" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.5.cmml">,</mo><msubsup id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.2" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.2.cmml">v</mi><mn id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.3" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.3" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.3.cmml">D</mi></msubsup><mo id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.7" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.8" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.5.cmml">,</mo><msubsup id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.2" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.2.cmml">v</mi><mi id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.3" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.3.cmml">L</mi><mi id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.3" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.3.cmml">D</mi></msubsup><mo id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.9" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.5.cmml">,</mo><msub id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.2" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.2.cmml">s</mi><mi id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.3" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.3.cmml">m</mi></msub><mo id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.10" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.5b"><apply id="S3.SS2.SSS2.p1.2.m2.5.5.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5"><eq id="S3.SS2.SSS2.p1.2.m2.5.5.5.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.5"></eq><apply id="S3.SS2.SSS2.p1.2.m2.5.5.6.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.6"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.5.5.6.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.6">superscript</csymbol><apply id="S3.SS2.SSS2.p1.2.m2.5.5.6.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.6"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.5.5.6.2.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.6">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.5.5.6.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.6.2.2">𝑉</ci><ci id="S3.SS2.SSS2.p1.2.m2.5.5.6.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.6.2.3">𝑚</ci></apply><ci id="S3.SS2.SSS2.p1.2.m2.5.5.6.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.6.3">𝐷</ci></apply><set id="S3.SS2.SSS2.p1.2.m2.5.5.4.5.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.4"><apply id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.2">𝑣</ci><cn type="integer" id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2.1.1.1.3">𝐷</ci></apply><apply id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.2">𝑣</ci><cn type="integer" id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.3.3.2.2.2.3">𝐷</ci></apply><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">…</ci><apply id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.2">𝑣</ci><ci id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.2.3">𝐿</ci></apply><ci id="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.4.4.3.3.3.3">𝐷</ci></apply><apply id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.2">𝑠</ci><ci id="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.5.5.4.4.4.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.5c">V_{m}^{D}=\left\{v_{1}^{D},v_{2}^{D},...,v_{L}^{D},s_{m}\right\}</annotation></semantics></math> is the prompt for <math id="S3.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mi id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><ci id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">m</annotation></semantics></math>-th source domains and <math id="S3.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="s_{m}" display="inline"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><msub id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS2.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.2">𝑠</ci><ci id="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">s_{m}</annotation></semantics></math> denotes the text embeddings corresponding to <math id="S3.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p1.5.m5.1a"><mi id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m5.1b"><ci id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">m</annotation></semantics></math>-th source domain name. For <math id="S3.SS2.SSS2.p1.6.m6.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS2.p1.6.m6.1a"><mi id="S3.SS2.SSS2.p1.6.m6.1.1" xref="S3.SS2.SSS2.p1.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.6.m6.1b"><ci id="S3.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.6.m6.1c">j</annotation></semantics></math>-th class from <math id="S3.SS2.SSS2.p1.7.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p1.7.m7.1a"><mi id="S3.SS2.SSS2.p1.7.m7.1.1" xref="S3.SS2.SSS2.p1.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.7.m7.1b"><ci id="S3.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.7.m7.1c">m</annotation></semantics></math> source domain, the text encoder produce embeddings <math id="S3.SS2.SSS2.p1.8.m8.1" class="ltx_Math" alttext="Z_{j}^{m}=g(t_{j}^{m})" display="inline"><semantics id="S3.SS2.SSS2.p1.8.m8.1a"><mrow id="S3.SS2.SSS2.p1.8.m8.1.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.cmml"><msubsup id="S3.SS2.SSS2.p1.8.m8.1.1.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.8.m8.1.1.3.2.2" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.2.2.cmml">Z</mi><mi id="S3.SS2.SSS2.p1.8.m8.1.1.3.2.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.2.3.cmml">j</mi><mi id="S3.SS2.SSS2.p1.8.m8.1.1.3.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.3.cmml">m</mi></msubsup><mo id="S3.SS2.SSS2.p1.8.m8.1.1.2" xref="S3.SS2.SSS2.p1.8.m8.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.8.m8.1.1.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.8.m8.1.1.1.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p1.8.m8.1.1.1.2" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.2.cmml">t</mi><mi id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.8.m8.1b"><apply id="S3.SS2.SSS2.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1"><eq id="S3.SS2.SSS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.2"></eq><apply id="S3.SS2.SSS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.8.m8.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3">superscript</csymbol><apply id="S3.SS2.SSS2.p1.8.m8.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.8.m8.1.1.3.2.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.8.m8.1.1.3.2.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.2.2">𝑍</ci><ci id="S3.SS2.SSS2.p1.8.m8.1.1.3.2.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS2.p1.8.m8.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.3">𝑚</ci></apply><apply id="S3.SS2.SSS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1"><times id="S3.SS2.SSS2.p1.8.m8.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.2"></times><ci id="S3.SS2.SSS2.p1.8.m8.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.3">𝑔</ci><apply id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.2">𝑡</ci><ci id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.8.m8.1c">Z_{j}^{m}=g(t_{j}^{m})</annotation></semantics></math>, where <math id="S3.SS2.SSS2.p1.9.m9.2" class="ltx_Math" alttext="t_{j}^{m}=\left\{V_{m}^{D},c_{j}\right\}" display="inline"><semantics id="S3.SS2.SSS2.p1.9.m9.2a"><mrow id="S3.SS2.SSS2.p1.9.m9.2.2" xref="S3.SS2.SSS2.p1.9.m9.2.2.cmml"><msubsup id="S3.SS2.SSS2.p1.9.m9.2.2.4" xref="S3.SS2.SSS2.p1.9.m9.2.2.4.cmml"><mi id="S3.SS2.SSS2.p1.9.m9.2.2.4.2.2" xref="S3.SS2.SSS2.p1.9.m9.2.2.4.2.2.cmml">t</mi><mi id="S3.SS2.SSS2.p1.9.m9.2.2.4.2.3" xref="S3.SS2.SSS2.p1.9.m9.2.2.4.2.3.cmml">j</mi><mi id="S3.SS2.SSS2.p1.9.m9.2.2.4.3" xref="S3.SS2.SSS2.p1.9.m9.2.2.4.3.cmml">m</mi></msubsup><mo id="S3.SS2.SSS2.p1.9.m9.2.2.3" xref="S3.SS2.SSS2.p1.9.m9.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.9.m9.2.2.2.2" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.3.cmml"><mo id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.3" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.3.cmml">{</mo><msubsup id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.2" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.2.cmml">V</mi><mi id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.3" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.3.cmml">m</mi><mi id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.3.cmml">D</mi></msubsup><mo id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.4" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.2.cmml">c</mi><mi id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.3" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.5" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.9.m9.2b"><apply id="S3.SS2.SSS2.p1.9.m9.2.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2"><eq id="S3.SS2.SSS2.p1.9.m9.2.2.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.3"></eq><apply id="S3.SS2.SSS2.p1.9.m9.2.2.4.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.9.m9.2.2.4.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.4">superscript</csymbol><apply id="S3.SS2.SSS2.p1.9.m9.2.2.4.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.9.m9.2.2.4.2.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS2.p1.9.m9.2.2.4.2.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.4.2.2">𝑡</ci><ci id="S3.SS2.SSS2.p1.9.m9.2.2.4.2.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.4.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS2.p1.9.m9.2.2.4.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.4.3">𝑚</ci></apply><set id="S3.SS2.SSS2.p1.9.m9.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.2"><apply id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.2">𝑉</ci><ci id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.1.1.3">𝐷</ci></apply><apply id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.2">𝑐</ci><ci id="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.2.2.2.2.2.3">𝑗</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.9.m9.2c">t_{j}^{m}=\left\{V_{m}^{D},c_{j}\right\}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.p2.1" class="ltx_p">To train D-Prompts in local clients, we first optimize each element using cross-entropy loss between the prediction probability of image-text pairs and the ground-truth label.
Moreover, to prevent them from progressively converging towards the same point, a contrastive loss is employed, where positive pairs involve hand-crafted prompts with the same domain names and negative pairs incorporate D-Prompts from other domains. Formally, the optimization of <math id="S3.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mi id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><ci id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">m</annotation></semantics></math>-th domain prompt can be expressed as follows:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.26" class="ltx_math_unparsed" alttext="\begin{split}\mathcal{L}_{D}^{m}(x,y)&amp;=\mathcal{L}_{ce}^{m}+\mathcal{L}_{cont}^{m}\\
&amp;=\mathcal{L}_{ce}^{m}-\log\frac{{\rm exp}({\rm sim}(V_{m}^{D}\cdot\tilde{V}_{m})))}{\sum_{i=1}^{M}{\rm exp}({\rm sim}(V_{m}^{D}\cdot V_{i}^{D}))},\end{split}" display="block"><semantics id="S3.E3.m1.26a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E3.m1.26.26.2"><mtr id="S3.E3.m1.26.26.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.26.26.2b"><mrow id="S3.E3.m1.8.8.8.8.8"><msubsup id="S3.E3.m1.8.8.8.8.8.10"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.1.1">ℒ</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1">D</mi><mi id="S3.E3.m1.3.3.3.3.3.3.1">m</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.8.8.8.9">​</mo><mrow id="S3.E3.m1.8.8.8.8.8.11"><mo stretchy="false" id="S3.E3.m1.4.4.4.4.4.4">(</mo><mi id="S3.E3.m1.5.5.5.5.5.5">x</mi><mo id="S3.E3.m1.6.6.6.6.6.6">,</mo><mi id="S3.E3.m1.7.7.7.7.7.7">y</mi><mo stretchy="false" id="S3.E3.m1.8.8.8.8.8.8">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.26.26.2c"><mrow id="S3.E3.m1.16.16.16.16.8"><mi id="S3.E3.m1.16.16.16.16.8.9"></mi><mo id="S3.E3.m1.9.9.9.9.1.1">=</mo><mrow id="S3.E3.m1.16.16.16.16.8.10"><msubsup id="S3.E3.m1.16.16.16.16.8.10.1"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.10.10.10.10.2.2">ℒ</mi><mrow id="S3.E3.m1.11.11.11.11.3.3.1"><mi id="S3.E3.m1.11.11.11.11.3.3.1.2">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.11.11.11.11.3.3.1.1">​</mo><mi id="S3.E3.m1.11.11.11.11.3.3.1.3">e</mi></mrow><mi id="S3.E3.m1.12.12.12.12.4.4.1">m</mi></msubsup><mo id="S3.E3.m1.13.13.13.13.5.5">+</mo><msubsup id="S3.E3.m1.16.16.16.16.8.10.2"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.14.14.14.14.6.6">ℒ</mi><mrow id="S3.E3.m1.15.15.15.15.7.7.1"><mi id="S3.E3.m1.15.15.15.15.7.7.1.2">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.7.7.1.1">​</mo><mi id="S3.E3.m1.15.15.15.15.7.7.1.3">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.7.7.1.1a">​</mo><mi id="S3.E3.m1.15.15.15.15.7.7.1.4">n</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.7.7.1.1b">​</mo><mi id="S3.E3.m1.15.15.15.15.7.7.1.5">t</mi></mrow><mi id="S3.E3.m1.16.16.16.16.8.8.1">m</mi></msubsup></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.26.26.2d"><mtd id="S3.E3.m1.26.26.2e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.26.26.2f"><mrow id="S3.E3.m1.26.26.2.25.9.9.9"><mrow id="S3.E3.m1.26.26.2.25.9.9.9.1"><mi id="S3.E3.m1.26.26.2.25.9.9.9.1.1"></mi><mo id="S3.E3.m1.17.17.17.1.1.1">=</mo><mrow id="S3.E3.m1.26.26.2.25.9.9.9.1.2"><msubsup id="S3.E3.m1.26.26.2.25.9.9.9.1.2.1"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.18.18.18.2.2.2">ℒ</mi><mrow id="S3.E3.m1.19.19.19.3.3.3.1"><mi id="S3.E3.m1.19.19.19.3.3.3.1.2">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.19.19.19.3.3.3.1.1">​</mo><mi id="S3.E3.m1.19.19.19.3.3.3.1.3">e</mi></mrow><mi id="S3.E3.m1.20.20.20.4.4.4.1">m</mi></msubsup><mo id="S3.E3.m1.21.21.21.5.5.5">−</mo><mrow id="S3.E3.m1.26.26.2.25.9.9.9.1.2.2"><mi id="S3.E3.m1.22.22.22.6.6.6">log</mi><mo lspace="0.167em" id="S3.E3.m1.26.26.2.25.9.9.9.1.2.2a">⁡</mo><mfrac id="S3.E3.m1.23.23.23.7.7.7"><mrow id="S3.E3.m1.23.23.23.7.7.7.3"><mi id="S3.E3.m1.23.23.23.7.7.7.3.1">exp</mi><mrow id="S3.E3.m1.23.23.23.7.7.7.3.2"><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.3.2.1">(</mo><mi id="S3.E3.m1.23.23.23.7.7.7.3.2.2">sim</mi><mrow id="S3.E3.m1.23.23.23.7.7.7.3.2.3"><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.3.2.3.1">(</mo><msubsup id="S3.E3.m1.23.23.23.7.7.7.3.2.3.2"><mi id="S3.E3.m1.23.23.23.7.7.7.3.2.3.2.2.2">V</mi><mi id="S3.E3.m1.23.23.23.7.7.7.3.2.3.2.2.3">m</mi><mi id="S3.E3.m1.23.23.23.7.7.7.3.2.3.2.3">D</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.23.23.23.7.7.7.3.2.3.3">⋅</mo><msub id="S3.E3.m1.23.23.23.7.7.7.3.2.3.4"><mover accent="true" id="S3.E3.m1.23.23.23.7.7.7.3.2.3.4.2"><mi id="S3.E3.m1.23.23.23.7.7.7.3.2.3.4.2.2">V</mi><mo id="S3.E3.m1.23.23.23.7.7.7.3.2.3.4.2.1">~</mo></mover><mi id="S3.E3.m1.23.23.23.7.7.7.3.2.3.4.3">m</mi></msub><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.3.2.3.5">)</mo></mrow><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.3.2.4">)</mo></mrow><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.3.3">)</mo></mrow><mrow id="S3.E3.m1.23.23.23.7.7.7.1"><msubsup id="S3.E3.m1.23.23.23.7.7.7.1.2"><mo id="S3.E3.m1.23.23.23.7.7.7.1.2.2.2">∑</mo><mrow id="S3.E3.m1.23.23.23.7.7.7.1.2.2.3"><mi id="S3.E3.m1.23.23.23.7.7.7.1.2.2.3.2">i</mi><mo id="S3.E3.m1.23.23.23.7.7.7.1.2.2.3.1">=</mo><mn id="S3.E3.m1.23.23.23.7.7.7.1.2.2.3.3">1</mn></mrow><mi id="S3.E3.m1.23.23.23.7.7.7.1.2.3">M</mi></msubsup><mrow id="S3.E3.m1.23.23.23.7.7.7.1.1"><mi id="S3.E3.m1.23.23.23.7.7.7.1.1.3">exp</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.23.23.23.7.7.7.1.1.2">​</mo><mrow id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1"><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.2">(</mo><mrow id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1"><mi id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.3">sim</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.2">​</mo><mrow id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.2">(</mo><mrow id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1"><msubsup id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.2"><mi id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.2.2.2">V</mi><mi id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.2.2.3">m</mi><mi id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.2.3">D</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.1">⋅</mo><msubsup id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.3"><mi id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.3.2.2">V</mi><mi id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.3.2.3">i</mi><mi id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.1.3.3">D</mi></msubsup></mrow><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.23.23.23.7.7.7.1.1.1.1.3">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E3.m1.24.24.24.8.8.8">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E3.m1.26b">\begin{split}\mathcal{L}_{D}^{m}(x,y)&amp;=\mathcal{L}_{ce}^{m}+\mathcal{L}_{cont}^{m}\\
&amp;=\mathcal{L}_{ce}^{m}-\log\frac{{\rm exp}({\rm sim}(V_{m}^{D}\cdot\tilde{V}_{m})))}{\sum_{i=1}^{M}{\rm exp}({\rm sim}(V_{m}^{D}\cdot V_{i}^{D}))},\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p2.8" class="ltx_p">where <math id="S3.SS2.SSS2.p2.2.m1.4" class="ltx_Math" alttext="\mathcal{L}_{ce}^{m}=\mathbb{E}_{x,j}\mathcal{L}_{ce}(y,P_{m}(y=j|x))" display="inline"><semantics id="S3.SS2.SSS2.p2.2.m1.4a"><mrow id="S3.SS2.SSS2.p2.2.m1.4.4" xref="S3.SS2.SSS2.p2.2.m1.4.4.cmml"><msubsup id="S3.SS2.SSS2.p2.2.m1.4.4.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.2.cmml">ℒ</mi><mrow id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.cmml"><mi id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.3.cmml">e</mi></mrow><mi id="S3.SS2.SSS2.p2.2.m1.4.4.3.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.3.cmml">m</mi></msubsup><mo id="S3.SS2.SSS2.p2.2.m1.4.4.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.2.cmml">=</mo><mrow id="S3.SS2.SSS2.p2.2.m1.4.4.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.cmml"><msub id="S3.SS2.SSS2.p2.2.m1.4.4.1.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.3.cmml"><mi id="S3.SS2.SSS2.p2.2.m1.4.4.1.3.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.3.2.cmml">𝔼</mi><mrow id="S3.SS2.SSS2.p2.2.m1.2.2.2.4" xref="S3.SS2.SSS2.p2.2.m1.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p2.2.m1.1.1.1.1" xref="S3.SS2.SSS2.p2.2.m1.1.1.1.1.cmml">x</mi><mo id="S3.SS2.SSS2.p2.2.m1.2.2.2.4.1" xref="S3.SS2.SSS2.p2.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS2.p2.2.m1.2.2.2.2" xref="S3.SS2.SSS2.p2.2.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.2.m1.4.4.1.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.2.cmml">​</mo><msub id="S3.SS2.SSS2.p2.2.m1.4.4.1.4" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.2.cmml">ℒ</mi><mrow id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.cmml"><mi id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.1.cmml">​</mo><mi id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.3.cmml">e</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.2.m1.4.4.1.2a" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.p2.2.m1.3.3" xref="S3.SS2.SSS2.p2.2.m1.3.3.cmml">y</mi><mo id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.2.cmml">,</mo><mrow id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.2.cmml">P</mi><mi id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">j</mi><mo fence="false" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.4" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m1.4b"><apply id="S3.SS2.SSS2.p2.2.m1.4.4.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4"><eq id="S3.SS2.SSS2.p2.2.m1.4.4.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.2"></eq><apply id="S3.SS2.SSS2.p2.2.m1.4.4.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m1.4.4.3.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3">superscript</csymbol><apply id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3">subscript</csymbol><ci id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.2">ℒ</ci><apply id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3"><times id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.1"></times><ci id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.2">𝑐</ci><ci id="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.2.3.3">𝑒</ci></apply></apply><ci id="S3.SS2.SSS2.p2.2.m1.4.4.3.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.3.3">𝑚</ci></apply><apply id="S3.SS2.SSS2.p2.2.m1.4.4.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1"><times id="S3.SS2.SSS2.p2.2.m1.4.4.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.2"></times><apply id="S3.SS2.SSS2.p2.2.m1.4.4.1.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m1.4.4.1.3.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.3.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.3.2">𝔼</ci><list id="S3.SS2.SSS2.p2.2.m1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.2.2.2.4"><ci id="S3.SS2.SSS2.p2.2.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.1.1.1.1">𝑥</ci><ci id="S3.SS2.SSS2.p2.2.m1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4">subscript</csymbol><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.2">ℒ</ci><apply id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3"><times id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.1"></times><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.2">𝑐</ci><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.4.3.3">𝑒</ci></apply></apply><interval closure="open" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1"><ci id="S3.SS2.SSS2.p2.2.m1.3.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.3.3">𝑦</ci><apply id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1"><times id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.2"></times><apply id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.2">𝑃</ci><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.3.3">𝑚</ci></apply><apply id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1"><eq id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.1"></eq><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.2.m1.4.4.1.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m1.4c">\mathcal{L}_{ce}^{m}=\mathbb{E}_{x,j}\mathcal{L}_{ce}(y,P_{m}(y=j|x))</annotation></semantics></math>. and <math id="S3.SS2.SSS2.p2.3.m2.4" class="ltx_math_unparsed" alttext="P_{m}(y=j|x)=\frac{{\rm exp}({\rm sim}(I,Z_{j}^{m}))/\tau)}{\sum_{i=1}^{C}{\rm exp}({\rm sim}(I,Z_{i}^{m})/\tau)}" display="inline"><semantics id="S3.SS2.SSS2.p2.3.m2.4a"><mrow id="S3.SS2.SSS2.p2.3.m2.4.4"><mrow id="S3.SS2.SSS2.p2.3.m2.4.4.1"><msub id="S3.SS2.SSS2.p2.3.m2.4.4.1.3"><mi id="S3.SS2.SSS2.p2.3.m2.4.4.1.3.2">P</mi><mi id="S3.SS2.SSS2.p2.3.m2.4.4.1.3.3">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.3.m2.4.4.1.2">​</mo><mrow id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1"><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.2">(</mo><mrow id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.1"><mi id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.1.2">y</mi><mo id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.1.1">=</mo><mrow id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.1.3"><mi id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.1.3.2">j</mi><mo fence="false" id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.1.3.1">|</mo><mi id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.1.3.3">x</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.4.4.1.1.1.3">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p2.3.m2.4.4.2">=</mo><mfrac id="S3.SS2.SSS2.p2.3.m2.3.3"><mrow id="S3.SS2.SSS2.p2.3.m2.1.1.1"><mi id="S3.SS2.SSS2.p2.3.m2.1.1.1.2">exp</mi><mrow id="S3.SS2.SSS2.p2.3.m2.1.1.1.3"><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.1">(</mo><mi id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.2">sim</mi><mrow id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.3"><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.3.1">(</mo><mi id="S3.SS2.SSS2.p2.3.m2.1.1.1.1">I</mi><mo id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.3.2">,</mo><msubsup id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.3.3"><mi id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.3.3.2.2">Z</mi><mi id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.3.3.2.3">j</mi><mi id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.3.3.3">m</mi></msubsup><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.3.4">)</mo></mrow><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.1.1.1.3.4">)</mo></mrow><mo id="S3.SS2.SSS2.p2.3.m2.1.1.1.4">/</mo><mi id="S3.SS2.SSS2.p2.3.m2.1.1.1.5">τ</mi><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.1.1.1.6">)</mo></mrow><mrow id="S3.SS2.SSS2.p2.3.m2.3.3.3"><mstyle displaystyle="false" id="S3.SS2.SSS2.p2.3.m2.3.3.3.3"><msubsup id="S3.SS2.SSS2.p2.3.m2.3.3.3.3a"><mo id="S3.SS2.SSS2.p2.3.m2.3.3.3.3.2.2">∑</mo><mrow id="S3.SS2.SSS2.p2.3.m2.3.3.3.3.2.3"><mi id="S3.SS2.SSS2.p2.3.m2.3.3.3.3.2.3.2">i</mi><mo id="S3.SS2.SSS2.p2.3.m2.3.3.3.3.2.3.1">=</mo><mn id="S3.SS2.SSS2.p2.3.m2.3.3.3.3.2.3.3">1</mn></mrow><mi id="S3.SS2.SSS2.p2.3.m2.3.3.3.3.3">C</mi></msubsup></mstyle><mrow id="S3.SS2.SSS2.p2.3.m2.3.3.3.2"><mi id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.3">exp</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.2">​</mo><mrow id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1"><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.2">(</mo><mrow id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1"><mrow id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1"><mi id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.3">sim</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.2">​</mo><mrow id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.1.1"><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.1.1.2">(</mo><mi id="S3.SS2.SSS2.p2.3.m2.2.2.2.1">I</mi><mo id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.1.1.3">,</mo><msubsup id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.1.1.1"><mi id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.1.1.1.2.2">Z</mi><mi id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.1.1.1.2.3">i</mi><mi id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.1.1.1.3">m</mi></msubsup><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.1.1.1.4">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.2">/</mo><mi id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.1.3">τ</mi></mrow><mo stretchy="false" id="S3.SS2.SSS2.p2.3.m2.3.3.3.2.1.1.3">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m2.4b">P_{m}(y=j|x)=\frac{{\rm exp}({\rm sim}(I,Z_{j}^{m}))/\tau)}{\sum_{i=1}^{C}{\rm exp}({\rm sim}(I,Z_{i}^{m})/\tau)}</annotation></semantics></math> denotes the prediction probability with <math id="S3.SS2.SSS2.p2.4.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p2.4.m3.1a"><mi id="S3.SS2.SSS2.p2.4.m3.1.1" xref="S3.SS2.SSS2.p2.4.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m3.1b"><ci id="S3.SS2.SSS2.p2.4.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m3.1c">m</annotation></semantics></math>-th domain prompt for <math id="S3.SS2.SSS2.p2.5.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.SSS2.p2.5.m4.1a"><mi id="S3.SS2.SSS2.p2.5.m4.1.1" xref="S3.SS2.SSS2.p2.5.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.5.m4.1b"><ci id="S3.SS2.SSS2.p2.5.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.5.m4.1c">j</annotation></semantics></math>-th class. Besides, <math id="S3.SS2.SSS2.p2.6.m5.1" class="ltx_Math" alttext="\tilde{V}_{m}" display="inline"><semantics id="S3.SS2.SSS2.p2.6.m5.1a"><msub id="S3.SS2.SSS2.p2.6.m5.1.1" xref="S3.SS2.SSS2.p2.6.m5.1.1.cmml"><mover accent="true" id="S3.SS2.SSS2.p2.6.m5.1.1.2" xref="S3.SS2.SSS2.p2.6.m5.1.1.2.cmml"><mi id="S3.SS2.SSS2.p2.6.m5.1.1.2.2" xref="S3.SS2.SSS2.p2.6.m5.1.1.2.2.cmml">V</mi><mo id="S3.SS2.SSS2.p2.6.m5.1.1.2.1" xref="S3.SS2.SSS2.p2.6.m5.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS2.SSS2.p2.6.m5.1.1.3" xref="S3.SS2.SSS2.p2.6.m5.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.6.m5.1b"><apply id="S3.SS2.SSS2.p2.6.m5.1.1.cmml" xref="S3.SS2.SSS2.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.6.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p2.6.m5.1.1">subscript</csymbol><apply id="S3.SS2.SSS2.p2.6.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p2.6.m5.1.1.2"><ci id="S3.SS2.SSS2.p2.6.m5.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.6.m5.1.1.2.1">~</ci><ci id="S3.SS2.SSS2.p2.6.m5.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.6.m5.1.1.2.2">𝑉</ci></apply><ci id="S3.SS2.SSS2.p2.6.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p2.6.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.6.m5.1c">\tilde{V}_{m}</annotation></semantics></math> indicates the hand-crafted prompt for <math id="S3.SS2.SSS2.p2.7.m6.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p2.7.m6.1a"><mi id="S3.SS2.SSS2.p2.7.m6.1.1" xref="S3.SS2.SSS2.p2.7.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.7.m6.1b"><ci id="S3.SS2.SSS2.p2.7.m6.1.1.cmml" xref="S3.SS2.SSS2.p2.7.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.7.m6.1c">m</annotation></semantics></math>-th domain, i.e., “a photo of a [class] with the domain of &lt;domain &gt;”, where “&lt;domain &gt;” is the text of <math id="S3.SS2.SSS2.p2.8.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p2.8.m7.1a"><mi id="S3.SS2.SSS2.p2.8.m7.1.1" xref="S3.SS2.SSS2.p2.8.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.8.m7.1b"><ci id="S3.SS2.SSS2.p2.8.m7.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.8.m7.1c">m</annotation></semantics></math>-th domain and “[class]” denotes all potential category options.</p>
</div>
<div id="S3.SS2.SSS2.p3" class="ltx_para">
<p id="S3.SS2.SSS2.p3.1" class="ltx_p">Furthermore, since multiple clients may hold data originating from a shared domain. When <math id="S3.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="K&gt;M" display="inline"><semantics id="S3.SS2.SSS2.p3.1.m1.1a"><mrow id="S3.SS2.SSS2.p3.1.m1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p3.1.m1.1.1.2" xref="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml">K</mi><mo id="S3.SS2.SSS2.p3.1.m1.1.1.1" xref="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml">&gt;</mo><mi id="S3.SS2.SSS2.p3.1.m1.1.1.3" xref="S3.SS2.SSS2.p3.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.1.m1.1b"><apply id="S3.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1"><gt id="S3.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.1"></gt><ci id="S3.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.2">𝐾</ci><ci id="S3.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.1.m1.1c">K&gt;M</annotation></semantics></math>, we devise a domain-wise aggregation strategy to aggregate knowledge from the same domains. <span id="S3.SS2.SSS2.p3.1.1" class="ltx_text" style="color:#000000;">It can be represented as a weighted combination of those prompts from the same domain</span>:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.15" class="ltx_Math" alttext="V_{m}^{D,{r+1}}=V_{m}^{D,{r}}+\frac{\sum_{i=1}^{K}(|\mathcal{D}_{i}|*\mathcal{I}_{m,i})\cdot\triangle V_{m,i}^{D,{r+1}}}{\sum_{i=1}^{K}(|\mathcal{D}_{i}|*\mathcal{I}_{m,i})}," display="block"><semantics id="S3.E4.m1.15a"><mrow id="S3.E4.m1.15.15.1" xref="S3.E4.m1.15.15.1.1.cmml"><mrow id="S3.E4.m1.15.15.1.1" xref="S3.E4.m1.15.15.1.1.cmml"><msubsup id="S3.E4.m1.15.15.1.1.2" xref="S3.E4.m1.15.15.1.1.2.cmml"><mi id="S3.E4.m1.15.15.1.1.2.2.2" xref="S3.E4.m1.15.15.1.1.2.2.2.cmml">V</mi><mi id="S3.E4.m1.15.15.1.1.2.2.3" xref="S3.E4.m1.15.15.1.1.2.2.3.cmml">m</mi><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">D</mi><mo id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E4.m1.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.1.2.cmml">r</mi><mo id="S3.E4.m1.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E4.m1.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo id="S3.E4.m1.15.15.1.1.1" xref="S3.E4.m1.15.15.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.15.15.1.1.3" xref="S3.E4.m1.15.15.1.1.3.cmml"><msubsup id="S3.E4.m1.15.15.1.1.3.2" xref="S3.E4.m1.15.15.1.1.3.2.cmml"><mi id="S3.E4.m1.15.15.1.1.3.2.2.2" xref="S3.E4.m1.15.15.1.1.3.2.2.2.cmml">V</mi><mi id="S3.E4.m1.15.15.1.1.3.2.2.3" xref="S3.E4.m1.15.15.1.1.3.2.2.3.cmml">m</mi><mrow id="S3.E4.m1.4.4.2.4" xref="S3.E4.m1.4.4.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">D</mi><mo id="S3.E4.m1.4.4.2.4.1" xref="S3.E4.m1.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml">r</mi></mrow></msubsup><mo id="S3.E4.m1.15.15.1.1.3.1" xref="S3.E4.m1.15.15.1.1.3.1.cmml">+</mo><mfrac id="S3.E4.m1.14.14" xref="S3.E4.m1.14.14.cmml"><mrow id="S3.E4.m1.11.11.7" xref="S3.E4.m1.11.11.7.cmml"><msubsup id="S3.E4.m1.11.11.7.8" xref="S3.E4.m1.11.11.7.8.cmml"><mo id="S3.E4.m1.11.11.7.8.2.2" xref="S3.E4.m1.11.11.7.8.2.2.cmml">∑</mo><mrow id="S3.E4.m1.11.11.7.8.2.3" xref="S3.E4.m1.11.11.7.8.2.3.cmml"><mi id="S3.E4.m1.11.11.7.8.2.3.2" xref="S3.E4.m1.11.11.7.8.2.3.2.cmml">i</mi><mo id="S3.E4.m1.11.11.7.8.2.3.1" xref="S3.E4.m1.11.11.7.8.2.3.1.cmml">=</mo><mn id="S3.E4.m1.11.11.7.8.2.3.3" xref="S3.E4.m1.11.11.7.8.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.11.11.7.8.3" xref="S3.E4.m1.11.11.7.8.3.cmml">K</mi></msubsup><mrow id="S3.E4.m1.11.11.7.7" xref="S3.E4.m1.11.11.7.7.cmml"><mrow id="S3.E4.m1.11.11.7.7.1" xref="S3.E4.m1.11.11.7.7.1.cmml"><mrow id="S3.E4.m1.11.11.7.7.1.1.1" xref="S3.E4.m1.11.11.7.7.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S3.E4.m1.11.11.7.7.1.1.1.2" xref="S3.E4.m1.11.11.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.11.11.7.7.1.1.1.1" xref="S3.E4.m1.11.11.7.7.1.1.1.1.cmml"><mrow id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.2" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.2" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.3" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.055em" stretchy="false" id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.3" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S3.E4.m1.11.11.7.7.1.1.1.1.2" xref="S3.E4.m1.11.11.7.7.1.1.1.1.2.cmml">∗</mo><msub id="S3.E4.m1.11.11.7.7.1.1.1.1.3" xref="S3.E4.m1.11.11.7.7.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.11.11.7.7.1.1.1.1.3.2" xref="S3.E4.m1.11.11.7.7.1.1.1.1.3.2.cmml">ℐ</mi><mrow id="S3.E4.m1.6.6.2.2.2.4" xref="S3.E4.m1.6.6.2.2.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.cmml">m</mi><mo id="S3.E4.m1.6.6.2.2.2.4.1" xref="S3.E4.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.6.6.2.2.2.2" xref="S3.E4.m1.6.6.2.2.2.2.cmml">i</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E4.m1.11.11.7.7.1.1.1.3" xref="S3.E4.m1.11.11.7.7.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E4.m1.11.11.7.7.1.2" xref="S3.E4.m1.11.11.7.7.1.2.cmml">⋅</mo><mi mathvariant="normal" id="S3.E4.m1.11.11.7.7.1.3" xref="S3.E4.m1.11.11.7.7.1.3.cmml">△</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.7.7.2" xref="S3.E4.m1.11.11.7.7.2.cmml">​</mo><msubsup id="S3.E4.m1.11.11.7.7.3" xref="S3.E4.m1.11.11.7.7.3.cmml"><mi id="S3.E4.m1.11.11.7.7.3.2.2" xref="S3.E4.m1.11.11.7.7.3.2.2.cmml">V</mi><mrow id="S3.E4.m1.8.8.4.4.2.4" xref="S3.E4.m1.8.8.4.4.2.3.cmml"><mi id="S3.E4.m1.7.7.3.3.1.1" xref="S3.E4.m1.7.7.3.3.1.1.cmml">m</mi><mo id="S3.E4.m1.8.8.4.4.2.4.1" xref="S3.E4.m1.8.8.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.8.8.4.4.2.2" xref="S3.E4.m1.8.8.4.4.2.2.cmml">i</mi></mrow><mrow id="S3.E4.m1.10.10.6.6.2.2" xref="S3.E4.m1.10.10.6.6.2.3.cmml"><mi id="S3.E4.m1.9.9.5.5.1.1" xref="S3.E4.m1.9.9.5.5.1.1.cmml">D</mi><mo id="S3.E4.m1.10.10.6.6.2.2.2" xref="S3.E4.m1.10.10.6.6.2.3.cmml">,</mo><mrow id="S3.E4.m1.10.10.6.6.2.2.1" xref="S3.E4.m1.10.10.6.6.2.2.1.cmml"><mi id="S3.E4.m1.10.10.6.6.2.2.1.2" xref="S3.E4.m1.10.10.6.6.2.2.1.2.cmml">r</mi><mo id="S3.E4.m1.10.10.6.6.2.2.1.1" xref="S3.E4.m1.10.10.6.6.2.2.1.1.cmml">+</mo><mn id="S3.E4.m1.10.10.6.6.2.2.1.3" xref="S3.E4.m1.10.10.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup></mrow></mrow><mrow id="S3.E4.m1.14.14.10" xref="S3.E4.m1.14.14.10.cmml"><msubsup id="S3.E4.m1.14.14.10.4" xref="S3.E4.m1.14.14.10.4.cmml"><mo id="S3.E4.m1.14.14.10.4.2.2" xref="S3.E4.m1.14.14.10.4.2.2.cmml">∑</mo><mrow id="S3.E4.m1.14.14.10.4.2.3" xref="S3.E4.m1.14.14.10.4.2.3.cmml"><mi id="S3.E4.m1.14.14.10.4.2.3.2" xref="S3.E4.m1.14.14.10.4.2.3.2.cmml">i</mi><mo id="S3.E4.m1.14.14.10.4.2.3.1" xref="S3.E4.m1.14.14.10.4.2.3.1.cmml">=</mo><mn id="S3.E4.m1.14.14.10.4.2.3.3" xref="S3.E4.m1.14.14.10.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.14.14.10.4.3" xref="S3.E4.m1.14.14.10.4.3.cmml">K</mi></msubsup><mrow id="S3.E4.m1.14.14.10.3.1" xref="S3.E4.m1.14.14.10.3.1.1.cmml"><mo lspace="0em" stretchy="false" id="S3.E4.m1.14.14.10.3.1.2" xref="S3.E4.m1.14.14.10.3.1.1.cmml">(</mo><mrow id="S3.E4.m1.14.14.10.3.1.1" xref="S3.E4.m1.14.14.10.3.1.1.cmml"><mrow id="S3.E4.m1.14.14.10.3.1.1.1.1" xref="S3.E4.m1.14.14.10.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.14.14.10.3.1.1.1.1.2" xref="S3.E4.m1.14.14.10.3.1.1.1.2.1.cmml">|</mo><msub id="S3.E4.m1.14.14.10.3.1.1.1.1.1" xref="S3.E4.m1.14.14.10.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.14.14.10.3.1.1.1.1.1.2" xref="S3.E4.m1.14.14.10.3.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E4.m1.14.14.10.3.1.1.1.1.1.3" xref="S3.E4.m1.14.14.10.3.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.055em" stretchy="false" id="S3.E4.m1.14.14.10.3.1.1.1.1.3" xref="S3.E4.m1.14.14.10.3.1.1.1.2.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S3.E4.m1.14.14.10.3.1.1.2" xref="S3.E4.m1.14.14.10.3.1.1.2.cmml">∗</mo><msub id="S3.E4.m1.14.14.10.3.1.1.3" xref="S3.E4.m1.14.14.10.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.14.14.10.3.1.1.3.2" xref="S3.E4.m1.14.14.10.3.1.1.3.2.cmml">ℐ</mi><mrow id="S3.E4.m1.13.13.9.2.2.4" xref="S3.E4.m1.13.13.9.2.2.3.cmml"><mi id="S3.E4.m1.12.12.8.1.1.1" xref="S3.E4.m1.12.12.8.1.1.1.cmml">m</mi><mo id="S3.E4.m1.13.13.9.2.2.4.1" xref="S3.E4.m1.13.13.9.2.2.3.cmml">,</mo><mi id="S3.E4.m1.13.13.9.2.2.2" xref="S3.E4.m1.13.13.9.2.2.2.cmml">i</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E4.m1.14.14.10.3.1.3" xref="S3.E4.m1.14.14.10.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S3.E4.m1.15.15.1.2" xref="S3.E4.m1.15.15.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.15b"><apply id="S3.E4.m1.15.15.1.1.cmml" xref="S3.E4.m1.15.15.1"><eq id="S3.E4.m1.15.15.1.1.1.cmml" xref="S3.E4.m1.15.15.1.1.1"></eq><apply id="S3.E4.m1.15.15.1.1.2.cmml" xref="S3.E4.m1.15.15.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.15.15.1.1.2.1.cmml" xref="S3.E4.m1.15.15.1.1.2">superscript</csymbol><apply id="S3.E4.m1.15.15.1.1.2.2.cmml" xref="S3.E4.m1.15.15.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.15.15.1.1.2.2.1.cmml" xref="S3.E4.m1.15.15.1.1.2">subscript</csymbol><ci id="S3.E4.m1.15.15.1.1.2.2.2.cmml" xref="S3.E4.m1.15.15.1.1.2.2.2">𝑉</ci><ci id="S3.E4.m1.15.15.1.1.2.2.3.cmml" xref="S3.E4.m1.15.15.1.1.2.2.3">𝑚</ci></apply><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝐷</ci><apply id="S3.E4.m1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1"><plus id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1"></plus><ci id="S3.E4.m1.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.2">𝑟</ci><cn type="integer" id="S3.E4.m1.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S3.E4.m1.15.15.1.1.3.cmml" xref="S3.E4.m1.15.15.1.1.3"><plus id="S3.E4.m1.15.15.1.1.3.1.cmml" xref="S3.E4.m1.15.15.1.1.3.1"></plus><apply id="S3.E4.m1.15.15.1.1.3.2.cmml" xref="S3.E4.m1.15.15.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.15.15.1.1.3.2.1.cmml" xref="S3.E4.m1.15.15.1.1.3.2">superscript</csymbol><apply id="S3.E4.m1.15.15.1.1.3.2.2.cmml" xref="S3.E4.m1.15.15.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.15.15.1.1.3.2.2.1.cmml" xref="S3.E4.m1.15.15.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.15.15.1.1.3.2.2.2.cmml" xref="S3.E4.m1.15.15.1.1.3.2.2.2">𝑉</ci><ci id="S3.E4.m1.15.15.1.1.3.2.2.3.cmml" xref="S3.E4.m1.15.15.1.1.3.2.2.3">𝑚</ci></apply><list id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.4"><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝐷</ci><ci id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2">𝑟</ci></list></apply><apply id="S3.E4.m1.14.14.cmml" xref="S3.E4.m1.14.14"><divide id="S3.E4.m1.14.14.11.cmml" xref="S3.E4.m1.14.14"></divide><apply id="S3.E4.m1.11.11.7.cmml" xref="S3.E4.m1.11.11.7"><apply id="S3.E4.m1.11.11.7.8.cmml" xref="S3.E4.m1.11.11.7.8"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.7.8.1.cmml" xref="S3.E4.m1.11.11.7.8">superscript</csymbol><apply id="S3.E4.m1.11.11.7.8.2.cmml" xref="S3.E4.m1.11.11.7.8"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.7.8.2.1.cmml" xref="S3.E4.m1.11.11.7.8">subscript</csymbol><sum id="S3.E4.m1.11.11.7.8.2.2.cmml" xref="S3.E4.m1.11.11.7.8.2.2"></sum><apply id="S3.E4.m1.11.11.7.8.2.3.cmml" xref="S3.E4.m1.11.11.7.8.2.3"><eq id="S3.E4.m1.11.11.7.8.2.3.1.cmml" xref="S3.E4.m1.11.11.7.8.2.3.1"></eq><ci id="S3.E4.m1.11.11.7.8.2.3.2.cmml" xref="S3.E4.m1.11.11.7.8.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.11.11.7.8.2.3.3.cmml" xref="S3.E4.m1.11.11.7.8.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.11.11.7.8.3.cmml" xref="S3.E4.m1.11.11.7.8.3">𝐾</ci></apply><apply id="S3.E4.m1.11.11.7.7.cmml" xref="S3.E4.m1.11.11.7.7"><times id="S3.E4.m1.11.11.7.7.2.cmml" xref="S3.E4.m1.11.11.7.7.2"></times><apply id="S3.E4.m1.11.11.7.7.1.cmml" xref="S3.E4.m1.11.11.7.7.1"><ci id="S3.E4.m1.11.11.7.7.1.2.cmml" xref="S3.E4.m1.11.11.7.7.1.2">⋅</ci><apply id="S3.E4.m1.11.11.7.7.1.1.1.1.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1"><times id="S3.E4.m1.11.11.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.2"></times><apply id="S3.E4.m1.11.11.7.7.1.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1"><abs id="S3.E4.m1.11.11.7.7.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.2"></abs><apply id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.11.11.7.7.1.1.1.1.3.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.7.7.1.1.1.1.3.1.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.11.11.7.7.1.1.1.1.3.2.cmml" xref="S3.E4.m1.11.11.7.7.1.1.1.1.3.2">ℐ</ci><list id="S3.E4.m1.6.6.2.2.2.3.cmml" xref="S3.E4.m1.6.6.2.2.2.4"><ci id="S3.E4.m1.5.5.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1">𝑚</ci><ci id="S3.E4.m1.6.6.2.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2.2.2">𝑖</ci></list></apply></apply><ci id="S3.E4.m1.11.11.7.7.1.3.cmml" xref="S3.E4.m1.11.11.7.7.1.3">△</ci></apply><apply id="S3.E4.m1.11.11.7.7.3.cmml" xref="S3.E4.m1.11.11.7.7.3"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.7.7.3.1.cmml" xref="S3.E4.m1.11.11.7.7.3">superscript</csymbol><apply id="S3.E4.m1.11.11.7.7.3.2.cmml" xref="S3.E4.m1.11.11.7.7.3"><csymbol cd="ambiguous" id="S3.E4.m1.11.11.7.7.3.2.1.cmml" xref="S3.E4.m1.11.11.7.7.3">subscript</csymbol><ci id="S3.E4.m1.11.11.7.7.3.2.2.cmml" xref="S3.E4.m1.11.11.7.7.3.2.2">𝑉</ci><list id="S3.E4.m1.8.8.4.4.2.3.cmml" xref="S3.E4.m1.8.8.4.4.2.4"><ci id="S3.E4.m1.7.7.3.3.1.1.cmml" xref="S3.E4.m1.7.7.3.3.1.1">𝑚</ci><ci id="S3.E4.m1.8.8.4.4.2.2.cmml" xref="S3.E4.m1.8.8.4.4.2.2">𝑖</ci></list></apply><list id="S3.E4.m1.10.10.6.6.2.3.cmml" xref="S3.E4.m1.10.10.6.6.2.2"><ci id="S3.E4.m1.9.9.5.5.1.1.cmml" xref="S3.E4.m1.9.9.5.5.1.1">𝐷</ci><apply id="S3.E4.m1.10.10.6.6.2.2.1.cmml" xref="S3.E4.m1.10.10.6.6.2.2.1"><plus id="S3.E4.m1.10.10.6.6.2.2.1.1.cmml" xref="S3.E4.m1.10.10.6.6.2.2.1.1"></plus><ci id="S3.E4.m1.10.10.6.6.2.2.1.2.cmml" xref="S3.E4.m1.10.10.6.6.2.2.1.2">𝑟</ci><cn type="integer" id="S3.E4.m1.10.10.6.6.2.2.1.3.cmml" xref="S3.E4.m1.10.10.6.6.2.2.1.3">1</cn></apply></list></apply></apply></apply><apply id="S3.E4.m1.14.14.10.cmml" xref="S3.E4.m1.14.14.10"><apply id="S3.E4.m1.14.14.10.4.cmml" xref="S3.E4.m1.14.14.10.4"><csymbol cd="ambiguous" id="S3.E4.m1.14.14.10.4.1.cmml" xref="S3.E4.m1.14.14.10.4">superscript</csymbol><apply id="S3.E4.m1.14.14.10.4.2.cmml" xref="S3.E4.m1.14.14.10.4"><csymbol cd="ambiguous" id="S3.E4.m1.14.14.10.4.2.1.cmml" xref="S3.E4.m1.14.14.10.4">subscript</csymbol><sum id="S3.E4.m1.14.14.10.4.2.2.cmml" xref="S3.E4.m1.14.14.10.4.2.2"></sum><apply id="S3.E4.m1.14.14.10.4.2.3.cmml" xref="S3.E4.m1.14.14.10.4.2.3"><eq id="S3.E4.m1.14.14.10.4.2.3.1.cmml" xref="S3.E4.m1.14.14.10.4.2.3.1"></eq><ci id="S3.E4.m1.14.14.10.4.2.3.2.cmml" xref="S3.E4.m1.14.14.10.4.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.14.14.10.4.2.3.3.cmml" xref="S3.E4.m1.14.14.10.4.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.14.14.10.4.3.cmml" xref="S3.E4.m1.14.14.10.4.3">𝐾</ci></apply><apply id="S3.E4.m1.14.14.10.3.1.1.cmml" xref="S3.E4.m1.14.14.10.3.1"><times id="S3.E4.m1.14.14.10.3.1.1.2.cmml" xref="S3.E4.m1.14.14.10.3.1.1.2"></times><apply id="S3.E4.m1.14.14.10.3.1.1.1.2.cmml" xref="S3.E4.m1.14.14.10.3.1.1.1.1"><abs id="S3.E4.m1.14.14.10.3.1.1.1.2.1.cmml" xref="S3.E4.m1.14.14.10.3.1.1.1.1.2"></abs><apply id="S3.E4.m1.14.14.10.3.1.1.1.1.1.cmml" xref="S3.E4.m1.14.14.10.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.14.14.10.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.14.14.10.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.14.14.10.3.1.1.1.1.1.2.cmml" xref="S3.E4.m1.14.14.10.3.1.1.1.1.1.2">𝒟</ci><ci id="S3.E4.m1.14.14.10.3.1.1.1.1.1.3.cmml" xref="S3.E4.m1.14.14.10.3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.14.14.10.3.1.1.3.cmml" xref="S3.E4.m1.14.14.10.3.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.14.14.10.3.1.1.3.1.cmml" xref="S3.E4.m1.14.14.10.3.1.1.3">subscript</csymbol><ci id="S3.E4.m1.14.14.10.3.1.1.3.2.cmml" xref="S3.E4.m1.14.14.10.3.1.1.3.2">ℐ</ci><list id="S3.E4.m1.13.13.9.2.2.3.cmml" xref="S3.E4.m1.13.13.9.2.2.4"><ci id="S3.E4.m1.12.12.8.1.1.1.cmml" xref="S3.E4.m1.12.12.8.1.1.1">𝑚</ci><ci id="S3.E4.m1.13.13.9.2.2.2.cmml" xref="S3.E4.m1.13.13.9.2.2.2">𝑖</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.15c">V_{m}^{D,{r+1}}=V_{m}^{D,{r}}+\frac{\sum_{i=1}^{K}(|\mathcal{D}_{i}|*\mathcal{I}_{m,i})\cdot\triangle V_{m,i}^{D,{r+1}}}{\sum_{i=1}^{K}(|\mathcal{D}_{i}|*\mathcal{I}_{m,i})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p3.12" class="ltx_p"><span id="S3.SS2.SSS2.p3.12.11" class="ltx_text" style="color:#000000;">where <math id="S3.SS2.SSS2.p3.2.1.m1.10" class="ltx_Math" alttext="\triangle V_{m,i}^{D,{r+1}}=V_{m,i}^{D,{r+1}}-V_{m}^{D,{r}}" display="inline"><semantics id="S3.SS2.SSS2.p3.2.1.m1.10a"><mrow id="S3.SS2.SSS2.p3.2.1.m1.10.11" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.cmml"><mrow id="S3.SS2.SSS2.p3.2.1.m1.10.11.2" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.cmml"><mi mathcolor="#000000" mathvariant="normal" id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.2.cmml">△</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.1" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.1.cmml">​</mo><msubsup id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.2.2.cmml">V</mi><mrow id="S3.SS2.SSS2.p3.2.1.m1.2.2.2.4" xref="S3.SS2.SSS2.p3.2.1.m1.2.2.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p3.2.1.m1.1.1.1.1.cmml">m</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.2.2.2.4.1" xref="S3.SS2.SSS2.p3.2.1.m1.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.2.2.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.3.3.1.1" xref="S3.SS2.SSS2.p3.2.1.m1.3.3.1.1.cmml">D</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.2" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.2.cmml">r</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.1" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.1.cmml">+</mo><mn mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.3" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup></mrow><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.10.11.1" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p3.2.1.m1.10.11.3" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.cmml"><msubsup id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.2.2.cmml">V</mi><mrow id="S3.SS2.SSS2.p3.2.1.m1.6.6.2.4" xref="S3.SS2.SSS2.p3.2.1.m1.6.6.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.5.5.1.1" xref="S3.SS2.SSS2.p3.2.1.m1.5.5.1.1.cmml">m</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.6.6.2.4.1" xref="S3.SS2.SSS2.p3.2.1.m1.6.6.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.6.6.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.6.6.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.7.7.1.1" xref="S3.SS2.SSS2.p3.2.1.m1.7.7.1.1.cmml">D</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.2" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.2.cmml">r</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.1" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.1.cmml">+</mo><mn mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.3" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.1" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.1.cmml">−</mo><msubsup id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.2.cmml">V</mi><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.3" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.3.cmml">m</mi><mrow id="S3.SS2.SSS2.p3.2.1.m1.10.10.2.4" xref="S3.SS2.SSS2.p3.2.1.m1.10.10.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.9.9.1.1" xref="S3.SS2.SSS2.p3.2.1.m1.9.9.1.1.cmml">D</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.10.10.2.4.1" xref="S3.SS2.SSS2.p3.2.1.m1.10.10.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.2.1.m1.10.10.2.2" xref="S3.SS2.SSS2.p3.2.1.m1.10.10.2.2.cmml">r</mi></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.2.1.m1.10b"><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11"><eq id="S3.SS2.SSS2.p3.2.1.m1.10.11.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.1"></eq><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2"><times id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.1"></times><ci id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.2">△</ci><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3">superscript</csymbol><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.2.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.2.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.2.3.2.2">𝑉</ci><list id="S3.SS2.SSS2.p3.2.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.2.2.2.4"><ci id="S3.SS2.SSS2.p3.2.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.1.1.1.1">𝑚</ci><ci id="S3.SS2.SSS2.p3.2.1.m1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2"><ci id="S3.SS2.SSS2.p3.2.1.m1.3.3.1.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.3.3.1.1">𝐷</ci><apply id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1"><plus id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.1"></plus><ci id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.2">𝑟</ci><cn type="integer" id="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.4.4.2.2.1.3">1</cn></apply></list></apply></apply><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3"><minus id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.1"></minus><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2">superscript</csymbol><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.2.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2">subscript</csymbol><ci id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.2.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.2.2.2">𝑉</ci><list id="S3.SS2.SSS2.p3.2.1.m1.6.6.2.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.6.6.2.4"><ci id="S3.SS2.SSS2.p3.2.1.m1.5.5.1.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.5.5.1.1">𝑚</ci><ci id="S3.SS2.SSS2.p3.2.1.m1.6.6.2.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.6.6.2.2">𝑖</ci></list></apply><list id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2"><ci id="S3.SS2.SSS2.p3.2.1.m1.7.7.1.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.7.7.1.1">𝐷</ci><apply id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1"><plus id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.1"></plus><ci id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.2">𝑟</ci><cn type="integer" id="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.8.8.2.2.1.3">1</cn></apply></list></apply><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3">superscript</csymbol><apply id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.2">𝑉</ci><ci id="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.11.3.3.2.3">𝑚</ci></apply><list id="S3.SS2.SSS2.p3.2.1.m1.10.10.2.3.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.10.2.4"><ci id="S3.SS2.SSS2.p3.2.1.m1.9.9.1.1.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.9.9.1.1">𝐷</ci><ci id="S3.SS2.SSS2.p3.2.1.m1.10.10.2.2.cmml" xref="S3.SS2.SSS2.p3.2.1.m1.10.10.2.2">𝑟</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.2.1.m1.10c">\triangle V_{m,i}^{D,{r+1}}=V_{m,i}^{D,{r+1}}-V_{m}^{D,{r}}</annotation></semantics></math>. For <math id="S3.SS2.SSS2.p3.3.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p3.3.2.m2.1a"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.3.2.m2.1.1" xref="S3.SS2.SSS2.p3.3.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.3.2.m2.1b"><ci id="S3.SS2.SSS2.p3.3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p3.3.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.3.2.m2.1c">m</annotation></semantics></math>-th domain, <math id="S3.SS2.SSS2.p3.4.3.m3.4" class="ltx_Math" alttext="V_{m,i}^{D,{r+1}}" display="inline"><semantics id="S3.SS2.SSS2.p3.4.3.m3.4a"><msubsup id="S3.SS2.SSS2.p3.4.3.m3.4.5" xref="S3.SS2.SSS2.p3.4.3.m3.4.5.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.4.5.2.2" xref="S3.SS2.SSS2.p3.4.3.m3.4.5.2.2.cmml">V</mi><mrow id="S3.SS2.SSS2.p3.4.3.m3.2.2.2.4" xref="S3.SS2.SSS2.p3.4.3.m3.2.2.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.1.1.1.1" xref="S3.SS2.SSS2.p3.4.3.m3.1.1.1.1.cmml">m</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.2.2.2.4.1" xref="S3.SS2.SSS2.p3.4.3.m3.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.2.2.2.2" xref="S3.SS2.SSS2.p3.4.3.m3.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.3.3.1.1" xref="S3.SS2.SSS2.p3.4.3.m3.3.3.1.1.cmml">D</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.2" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.2" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.2.cmml">r</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.1" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.1.cmml">+</mo><mn mathcolor="#000000" id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.3" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.4.3.m3.4b"><apply id="S3.SS2.SSS2.p3.4.3.m3.4.5.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.4.3.m3.4.5.1.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.5">superscript</csymbol><apply id="S3.SS2.SSS2.p3.4.3.m3.4.5.2.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.4.3.m3.4.5.2.1.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.5">subscript</csymbol><ci id="S3.SS2.SSS2.p3.4.3.m3.4.5.2.2.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.5.2.2">𝑉</ci><list id="S3.SS2.SSS2.p3.4.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.2.2.2.4"><ci id="S3.SS2.SSS2.p3.4.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.1.1.1.1">𝑚</ci><ci id="S3.SS2.SSS2.p3.4.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.3.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2"><ci id="S3.SS2.SSS2.p3.4.3.m3.3.3.1.1.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.3.3.1.1">𝐷</ci><apply id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1"><plus id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.1.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.1"></plus><ci id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.2.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.2">𝑟</ci><cn type="integer" id="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.3.cmml" xref="S3.SS2.SSS2.p3.4.3.m3.4.4.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.4.3.m3.4c">V_{m,i}^{D,{r+1}}</annotation></semantics></math> is uploaded prompt from <math id="S3.SS2.SSS2.p3.5.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS2.p3.5.4.m4.1a"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.5.4.m4.1.1" xref="S3.SS2.SSS2.p3.5.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.5.4.m4.1b"><ci id="S3.SS2.SSS2.p3.5.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p3.5.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.5.4.m4.1c">i</annotation></semantics></math>-th client in <math id="S3.SS2.SSS2.p3.6.5.m5.1" class="ltx_Math" alttext="r+1" display="inline"><semantics id="S3.SS2.SSS2.p3.6.5.m5.1a"><mrow id="S3.SS2.SSS2.p3.6.5.m5.1.1" xref="S3.SS2.SSS2.p3.6.5.m5.1.1.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.6.5.m5.1.1.2" xref="S3.SS2.SSS2.p3.6.5.m5.1.1.2.cmml">r</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.6.5.m5.1.1.1" xref="S3.SS2.SSS2.p3.6.5.m5.1.1.1.cmml">+</mo><mn mathcolor="#000000" id="S3.SS2.SSS2.p3.6.5.m5.1.1.3" xref="S3.SS2.SSS2.p3.6.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.6.5.m5.1b"><apply id="S3.SS2.SSS2.p3.6.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p3.6.5.m5.1.1"><plus id="S3.SS2.SSS2.p3.6.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p3.6.5.m5.1.1.1"></plus><ci id="S3.SS2.SSS2.p3.6.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p3.6.5.m5.1.1.2">𝑟</ci><cn type="integer" id="S3.SS2.SSS2.p3.6.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p3.6.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.6.5.m5.1c">r+1</annotation></semantics></math>-th global round, and <math id="S3.SS2.SSS2.p3.7.6.m6.2" class="ltx_Math" alttext="V_{m}^{D,{r}}" display="inline"><semantics id="S3.SS2.SSS2.p3.7.6.m6.2a"><msubsup id="S3.SS2.SSS2.p3.7.6.m6.2.3" xref="S3.SS2.SSS2.p3.7.6.m6.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.7.6.m6.2.3.2.2" xref="S3.SS2.SSS2.p3.7.6.m6.2.3.2.2.cmml">V</mi><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.7.6.m6.2.3.2.3" xref="S3.SS2.SSS2.p3.7.6.m6.2.3.2.3.cmml">m</mi><mrow id="S3.SS2.SSS2.p3.7.6.m6.2.2.2.4" xref="S3.SS2.SSS2.p3.7.6.m6.2.2.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.7.6.m6.1.1.1.1" xref="S3.SS2.SSS2.p3.7.6.m6.1.1.1.1.cmml">D</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.7.6.m6.2.2.2.4.1" xref="S3.SS2.SSS2.p3.7.6.m6.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.7.6.m6.2.2.2.2" xref="S3.SS2.SSS2.p3.7.6.m6.2.2.2.2.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.7.6.m6.2b"><apply id="S3.SS2.SSS2.p3.7.6.m6.2.3.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.7.6.m6.2.3.1.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.2.3">superscript</csymbol><apply id="S3.SS2.SSS2.p3.7.6.m6.2.3.2.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.7.6.m6.2.3.2.1.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.7.6.m6.2.3.2.2.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.2.3.2.2">𝑉</ci><ci id="S3.SS2.SSS2.p3.7.6.m6.2.3.2.3.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.2.3.2.3">𝑚</ci></apply><list id="S3.SS2.SSS2.p3.7.6.m6.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.2.2.2.4"><ci id="S3.SS2.SSS2.p3.7.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.1.1.1.1">𝐷</ci><ci id="S3.SS2.SSS2.p3.7.6.m6.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.7.6.m6.2.2.2.2">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.7.6.m6.2c">V_{m}^{D,{r}}</annotation></semantics></math> denotes updated prompt after aggregation in <math id="S3.SS2.SSS2.p3.8.7.m7.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS2.SSS2.p3.8.7.m7.1a"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.8.7.m7.1.1" xref="S3.SS2.SSS2.p3.8.7.m7.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.8.7.m7.1b"><ci id="S3.SS2.SSS2.p3.8.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p3.8.7.m7.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.8.7.m7.1c">r</annotation></semantics></math>-th global round.
<math id="S3.SS2.SSS2.p3.9.8.m8.2" class="ltx_Math" alttext="\mathcal{I}_{m,i}" display="inline"><semantics id="S3.SS2.SSS2.p3.9.8.m8.2a"><msub id="S3.SS2.SSS2.p3.9.8.m8.2.3" xref="S3.SS2.SSS2.p3.9.8.m8.2.3.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS2.SSS2.p3.9.8.m8.2.3.2" xref="S3.SS2.SSS2.p3.9.8.m8.2.3.2.cmml">ℐ</mi><mrow id="S3.SS2.SSS2.p3.9.8.m8.2.2.2.4" xref="S3.SS2.SSS2.p3.9.8.m8.2.2.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.9.8.m8.1.1.1.1" xref="S3.SS2.SSS2.p3.9.8.m8.1.1.1.1.cmml">m</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.9.8.m8.2.2.2.4.1" xref="S3.SS2.SSS2.p3.9.8.m8.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.9.8.m8.2.2.2.2" xref="S3.SS2.SSS2.p3.9.8.m8.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.9.8.m8.2b"><apply id="S3.SS2.SSS2.p3.9.8.m8.2.3.cmml" xref="S3.SS2.SSS2.p3.9.8.m8.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.9.8.m8.2.3.1.cmml" xref="S3.SS2.SSS2.p3.9.8.m8.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.9.8.m8.2.3.2.cmml" xref="S3.SS2.SSS2.p3.9.8.m8.2.3.2">ℐ</ci><list id="S3.SS2.SSS2.p3.9.8.m8.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.9.8.m8.2.2.2.4"><ci id="S3.SS2.SSS2.p3.9.8.m8.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.9.8.m8.1.1.1.1">𝑚</ci><ci id="S3.SS2.SSS2.p3.9.8.m8.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.9.8.m8.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.9.8.m8.2c">\mathcal{I}_{m,i}</annotation></semantics></math> is the output (0 or 1) of indicator function <math id="S3.SS2.SSS2.p3.10.9.m9.5" class="ltx_Math" alttext="\mathcal{I}(|\triangle V_{m,i}^{D,{r+1}}|)" display="inline"><semantics id="S3.SS2.SSS2.p3.10.9.m9.5a"><mrow id="S3.SS2.SSS2.p3.10.9.m9.5.5" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.5.5.3" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.3.cmml">ℐ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p3.10.9.m9.5.5.2" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.2" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.cmml">(</mo><mrow id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.2" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.2.1.cmml">|</mo><mrow id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.cmml"><mi mathcolor="#000000" mathvariant="normal" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.2" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.2.cmml">△</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.1" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.2.2" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.2.2.cmml">V</mi><mrow id="S3.SS2.SSS2.p3.10.9.m9.2.2.2.4" xref="S3.SS2.SSS2.p3.10.9.m9.2.2.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.1.1.1.1" xref="S3.SS2.SSS2.p3.10.9.m9.1.1.1.1.cmml">m</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.2.2.2.4.1" xref="S3.SS2.SSS2.p3.10.9.m9.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.2.2.2.2" xref="S3.SS2.SSS2.p3.10.9.m9.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.3.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.3.3.1.1" xref="S3.SS2.SSS2.p3.10.9.m9.3.3.1.1.cmml">D</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.2" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.cmml"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.2" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.2.cmml">r</mi><mo mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.1" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.1.cmml">+</mo><mn mathcolor="#000000" id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.3" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup></mrow><mo mathcolor="#000000" stretchy="false" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.3" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.2.1.cmml">|</mo></mrow><mo mathcolor="#000000" stretchy="false" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.3" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.10.9.m9.5b"><apply id="S3.SS2.SSS2.p3.10.9.m9.5.5.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5"><times id="S3.SS2.SSS2.p3.10.9.m9.5.5.2.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.2"></times><ci id="S3.SS2.SSS2.p3.10.9.m9.5.5.3.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.3">ℐ</ci><apply id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1"><abs id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.2"></abs><apply id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1"><times id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.1"></times><ci id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.2">△</ci><apply id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3">superscript</csymbol><apply id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.5.5.1.1.1.1.1.3.2.2">𝑉</ci><list id="S3.SS2.SSS2.p3.10.9.m9.2.2.2.3.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.2.2.2.4"><ci id="S3.SS2.SSS2.p3.10.9.m9.1.1.1.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.1.1.1.1">𝑚</ci><ci id="S3.SS2.SSS2.p3.10.9.m9.2.2.2.2.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.3.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2"><ci id="S3.SS2.SSS2.p3.10.9.m9.3.3.1.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.3.3.1.1">𝐷</ci><apply id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1"><plus id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.1.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.1"></plus><ci id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.2.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.2">𝑟</ci><cn type="integer" id="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.3.cmml" xref="S3.SS2.SSS2.p3.10.9.m9.4.4.2.2.1.3">1</cn></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.10.9.m9.5c">\mathcal{I}(|\triangle V_{m,i}^{D,{r+1}}|)</annotation></semantics></math> and <math id="S3.SS2.SSS2.p3.11.10.m10.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS2.SSS2.p3.11.10.m10.1a"><msub id="S3.SS2.SSS2.p3.11.10.m10.1.1" xref="S3.SS2.SSS2.p3.11.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S3.SS2.SSS2.p3.11.10.m10.1.1.2" xref="S3.SS2.SSS2.p3.11.10.m10.1.1.2.cmml">𝒟</mi><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.11.10.m10.1.1.3" xref="S3.SS2.SSS2.p3.11.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.11.10.m10.1b"><apply id="S3.SS2.SSS2.p3.11.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p3.11.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p3.11.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.p3.11.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p3.11.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.p3.11.10.m10.1.1.2">𝒟</ci><ci id="S3.SS2.SSS2.p3.11.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.p3.11.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.11.10.m10.1c">\mathcal{D}_{i}</annotation></semantics></math> indicate the local data in <math id="S3.SS2.SSS2.p3.12.11.m11.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS2.p3.12.11.m11.1a"><mi mathcolor="#000000" id="S3.SS2.SSS2.p3.12.11.m11.1.1" xref="S3.SS2.SSS2.p3.12.11.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p3.12.11.m11.1b"><ci id="S3.SS2.SSS2.p3.12.11.m11.1.1.cmml" xref="S3.SS2.SSS2.p3.12.11.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p3.12.11.m11.1c">i</annotation></semantics></math>-th client. The operation only aggregates those updated prompts and filters those unchanged ones to ensure valid learning.</span></p>
</div>
<div id="S3.SS2.SSS2.p4" class="ltx_para">
<p id="S3.SS2.SSS2.p4.6" class="ltx_p">Despite diversified knowledge extracted from different domains, separately optimizing the domain prompt for each domain risks client drift.
Inspired by the pre-trained vision-language update in CLIPood <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">33</span></a>]</cite>, We employ a beta momentum averaging mechanism to update domain prompts. Unlike exponential moving averages that underweight initial parameters, beta momentum averaging can avoid forgetting domain information appending at the initial period. Specifically, when <math id="S3.SS2.SSS2.p4.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.SSS2.p4.1.m1.1a"><mi id="S3.SS2.SSS2.p4.1.m1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.1.m1.1b"><ci id="S3.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.1.m1.1c">m</annotation></semantics></math>-th domain prompt is updated from <math id="S3.SS2.SSS2.p4.2.m2.2" class="ltx_Math" alttext="V_{m}^{D,r}" display="inline"><semantics id="S3.SS2.SSS2.p4.2.m2.2a"><msubsup id="S3.SS2.SSS2.p4.2.m2.2.3" xref="S3.SS2.SSS2.p4.2.m2.2.3.cmml"><mi id="S3.SS2.SSS2.p4.2.m2.2.3.2.2" xref="S3.SS2.SSS2.p4.2.m2.2.3.2.2.cmml">V</mi><mi id="S3.SS2.SSS2.p4.2.m2.2.3.2.3" xref="S3.SS2.SSS2.p4.2.m2.2.3.2.3.cmml">m</mi><mrow id="S3.SS2.SSS2.p4.2.m2.2.2.2.4" xref="S3.SS2.SSS2.p4.2.m2.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p4.2.m2.1.1.1.1" xref="S3.SS2.SSS2.p4.2.m2.1.1.1.1.cmml">D</mi><mo id="S3.SS2.SSS2.p4.2.m2.2.2.2.4.1" xref="S3.SS2.SSS2.p4.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS2.p4.2.m2.2.2.2.2" xref="S3.SS2.SSS2.p4.2.m2.2.2.2.2.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.2.m2.2b"><apply id="S3.SS2.SSS2.p4.2.m2.2.3.cmml" xref="S3.SS2.SSS2.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.2.m2.2.3.1.cmml" xref="S3.SS2.SSS2.p4.2.m2.2.3">superscript</csymbol><apply id="S3.SS2.SSS2.p4.2.m2.2.3.2.cmml" xref="S3.SS2.SSS2.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.2.m2.2.3.2.1.cmml" xref="S3.SS2.SSS2.p4.2.m2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p4.2.m2.2.3.2.2.cmml" xref="S3.SS2.SSS2.p4.2.m2.2.3.2.2">𝑉</ci><ci id="S3.SS2.SSS2.p4.2.m2.2.3.2.3.cmml" xref="S3.SS2.SSS2.p4.2.m2.2.3.2.3">𝑚</ci></apply><list id="S3.SS2.SSS2.p4.2.m2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p4.2.m2.2.2.2.4"><ci id="S3.SS2.SSS2.p4.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.2.m2.1.1.1.1">𝐷</ci><ci id="S3.SS2.SSS2.p4.2.m2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p4.2.m2.2.2.2.2">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.2.m2.2c">V_{m}^{D,r}</annotation></semantics></math> to <math id="S3.SS2.SSS2.p4.3.m3.2" class="ltx_Math" alttext="V_{m}^{D,{r+1}}" display="inline"><semantics id="S3.SS2.SSS2.p4.3.m3.2a"><msubsup id="S3.SS2.SSS2.p4.3.m3.2.3" xref="S3.SS2.SSS2.p4.3.m3.2.3.cmml"><mi id="S3.SS2.SSS2.p4.3.m3.2.3.2.2" xref="S3.SS2.SSS2.p4.3.m3.2.3.2.2.cmml">V</mi><mi id="S3.SS2.SSS2.p4.3.m3.2.3.2.3" xref="S3.SS2.SSS2.p4.3.m3.2.3.2.3.cmml">m</mi><mrow id="S3.SS2.SSS2.p4.3.m3.2.2.2.2" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p4.3.m3.1.1.1.1" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1.cmml">D</mi><mo id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.2" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.cmml"><mi id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.2" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.2.cmml">r</mi><mo id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.1" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.1.cmml">+</mo><mn id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.3" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.3.m3.2b"><apply id="S3.SS2.SSS2.p4.3.m3.2.3.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.3.m3.2.3.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.3">superscript</csymbol><apply id="S3.SS2.SSS2.p4.3.m3.2.3.2.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.3.m3.2.3.2.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p4.3.m3.2.3.2.2.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.3.2.2">𝑉</ci><ci id="S3.SS2.SSS2.p4.3.m3.2.3.2.3.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.3.2.3">𝑚</ci></apply><list id="S3.SS2.SSS2.p4.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2"><ci id="S3.SS2.SSS2.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.1.1.1.1">𝐷</ci><apply id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1"><plus id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.1"></plus><ci id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.2.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.2">𝑟</ci><cn type="integer" id="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.3.cmml" xref="S3.SS2.SSS2.p4.3.m3.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.3.m3.2c">V_{m}^{D,{r+1}}</annotation></semantics></math> between two adjacent rounds <math id="S3.SS2.SSS2.p4.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS2.SSS2.p4.4.m4.1a"><mi id="S3.SS2.SSS2.p4.4.m4.1.1" xref="S3.SS2.SSS2.p4.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.4.m4.1b"><ci id="S3.SS2.SSS2.p4.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p4.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.4.m4.1c">r</annotation></semantics></math> and <math id="S3.SS2.SSS2.p4.5.m5.1" class="ltx_Math" alttext="r+1" display="inline"><semantics id="S3.SS2.SSS2.p4.5.m5.1a"><mrow id="S3.SS2.SSS2.p4.5.m5.1.1" xref="S3.SS2.SSS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p4.5.m5.1.1.2" xref="S3.SS2.SSS2.p4.5.m5.1.1.2.cmml">r</mi><mo id="S3.SS2.SSS2.p4.5.m5.1.1.1" xref="S3.SS2.SSS2.p4.5.m5.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS2.p4.5.m5.1.1.3" xref="S3.SS2.SSS2.p4.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.5.m5.1b"><apply id="S3.SS2.SSS2.p4.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p4.5.m5.1.1"><plus id="S3.SS2.SSS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p4.5.m5.1.1.1"></plus><ci id="S3.SS2.SSS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p4.5.m5.1.1.2">𝑟</ci><cn type="integer" id="S3.SS2.SSS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.5.m5.1c">r+1</annotation></semantics></math>, a momentum average prompt <math id="S3.SS2.SSS2.p4.6.m6.2" class="ltx_Math" alttext="\hat{V}_{m}^{D,{r+1}}" display="inline"><semantics id="S3.SS2.SSS2.p4.6.m6.2a"><msubsup id="S3.SS2.SSS2.p4.6.m6.2.3" xref="S3.SS2.SSS2.p4.6.m6.2.3.cmml"><mover accent="true" id="S3.SS2.SSS2.p4.6.m6.2.3.2.2" xref="S3.SS2.SSS2.p4.6.m6.2.3.2.2.cmml"><mi id="S3.SS2.SSS2.p4.6.m6.2.3.2.2.2" xref="S3.SS2.SSS2.p4.6.m6.2.3.2.2.2.cmml">V</mi><mo id="S3.SS2.SSS2.p4.6.m6.2.3.2.2.1" xref="S3.SS2.SSS2.p4.6.m6.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS2.p4.6.m6.2.3.2.3" xref="S3.SS2.SSS2.p4.6.m6.2.3.2.3.cmml">m</mi><mrow id="S3.SS2.SSS2.p4.6.m6.2.2.2.2" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p4.6.m6.1.1.1.1" xref="S3.SS2.SSS2.p4.6.m6.1.1.1.1.cmml">D</mi><mo id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.2" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.cmml"><mi id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.2" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.2.cmml">r</mi><mo id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.1" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.1.cmml">+</mo><mn id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.3" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.6.m6.2b"><apply id="S3.SS2.SSS2.p4.6.m6.2.3.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.6.m6.2.3.1.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.3">superscript</csymbol><apply id="S3.SS2.SSS2.p4.6.m6.2.3.2.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.6.m6.2.3.2.1.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.3">subscript</csymbol><apply id="S3.SS2.SSS2.p4.6.m6.2.3.2.2.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.3.2.2"><ci id="S3.SS2.SSS2.p4.6.m6.2.3.2.2.1.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.3.2.2.1">^</ci><ci id="S3.SS2.SSS2.p4.6.m6.2.3.2.2.2.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.3.2.2.2">𝑉</ci></apply><ci id="S3.SS2.SSS2.p4.6.m6.2.3.2.3.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.3.2.3">𝑚</ci></apply><list id="S3.SS2.SSS2.p4.6.m6.2.2.2.3.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2"><ci id="S3.SS2.SSS2.p4.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.6.m6.1.1.1.1">𝐷</ci><apply id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1"><plus id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.1.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.1"></plus><ci id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.2.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.2">𝑟</ci><cn type="integer" id="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.3.cmml" xref="S3.SS2.SSS2.p4.6.m6.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.6.m6.2c">\hat{V}_{m}^{D,{r+1}}</annotation></semantics></math> can be computed by:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.7" class="ltx_Math" alttext="\hat{V}_{m}^{D,{r+1}}=\frac{\sum_{i=0}^{r}\alpha_{i}}{\sum_{i=0}^{r+1}\alpha_{i}}\hat{V}_{m}^{D,r}+\frac{\alpha_{r}}{\sum_{i=0}^{r}}V_{m}^{D,{r+1}}," display="block"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7.1" xref="S3.E5.m1.7.7.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml"><msubsup id="S3.E5.m1.7.7.1.1.2" xref="S3.E5.m1.7.7.1.1.2.cmml"><mover accent="true" id="S3.E5.m1.7.7.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.2.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.2.cmml">V</mi><mo id="S3.E5.m1.7.7.1.1.2.2.2.1" xref="S3.E5.m1.7.7.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.7.7.1.1.2.2.3" xref="S3.E5.m1.7.7.1.1.2.2.3.cmml">m</mi><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">D</mi><mo id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.2" xref="S3.E5.m1.2.2.2.2.1.2.cmml">r</mi><mo id="S3.E5.m1.2.2.2.2.1.1" xref="S3.E5.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E5.m1.2.2.2.2.1.3" xref="S3.E5.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo id="S3.E5.m1.7.7.1.1.1" xref="S3.E5.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.7.7.1.1.3" xref="S3.E5.m1.7.7.1.1.3.cmml"><mrow id="S3.E5.m1.7.7.1.1.3.2" xref="S3.E5.m1.7.7.1.1.3.2.cmml"><mfrac id="S3.E5.m1.7.7.1.1.3.2.2" xref="S3.E5.m1.7.7.1.1.3.2.2.cmml"><mrow id="S3.E5.m1.7.7.1.1.3.2.2.2" xref="S3.E5.m1.7.7.1.1.3.2.2.2.cmml"><msubsup id="S3.E5.m1.7.7.1.1.3.2.2.2.1" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.cmml"><mo id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.2" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.2" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.2.cmml">i</mi><mo id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.1" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.3" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.3.cmml">0</mn></mrow><mi id="S3.E5.m1.7.7.1.1.3.2.2.2.1.3" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.3.cmml">r</mi></msubsup><msub id="S3.E5.m1.7.7.1.1.3.2.2.2.2" xref="S3.E5.m1.7.7.1.1.3.2.2.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.3.2.2.2.2.2" xref="S3.E5.m1.7.7.1.1.3.2.2.2.2.2.cmml">α</mi><mi id="S3.E5.m1.7.7.1.1.3.2.2.2.2.3" xref="S3.E5.m1.7.7.1.1.3.2.2.2.2.3.cmml">i</mi></msub></mrow><mrow id="S3.E5.m1.7.7.1.1.3.2.2.3" xref="S3.E5.m1.7.7.1.1.3.2.2.3.cmml"><msubsup id="S3.E5.m1.7.7.1.1.3.2.2.3.1" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.cmml"><mo id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.2" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.2" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.1" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.3" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S3.E5.m1.7.7.1.1.3.2.2.3.1.3" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.2" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.2.cmml">r</mi><mo id="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.1" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.1.cmml">+</mo><mn id="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.3" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="S3.E5.m1.7.7.1.1.3.2.2.3.2" xref="S3.E5.m1.7.7.1.1.3.2.2.3.2.cmml"><mi id="S3.E5.m1.7.7.1.1.3.2.2.3.2.2" xref="S3.E5.m1.7.7.1.1.3.2.2.3.2.2.cmml">α</mi><mi id="S3.E5.m1.7.7.1.1.3.2.2.3.2.3" xref="S3.E5.m1.7.7.1.1.3.2.2.3.2.3.cmml">i</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.3.2.1" xref="S3.E5.m1.7.7.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E5.m1.7.7.1.1.3.2.3" xref="S3.E5.m1.7.7.1.1.3.2.3.cmml"><mover accent="true" id="S3.E5.m1.7.7.1.1.3.2.3.2.2" xref="S3.E5.m1.7.7.1.1.3.2.3.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.3.2.3.2.2.2" xref="S3.E5.m1.7.7.1.1.3.2.3.2.2.2.cmml">V</mi><mo id="S3.E5.m1.7.7.1.1.3.2.3.2.2.1" xref="S3.E5.m1.7.7.1.1.3.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.7.7.1.1.3.2.3.2.3" xref="S3.E5.m1.7.7.1.1.3.2.3.2.3.cmml">m</mi><mrow id="S3.E5.m1.4.4.2.4" xref="S3.E5.m1.4.4.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml">D</mi><mo id="S3.E5.m1.4.4.2.4.1" xref="S3.E5.m1.4.4.2.3.cmml">,</mo><mi id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.2.cmml">r</mi></mrow></msubsup></mrow><mo id="S3.E5.m1.7.7.1.1.3.1" xref="S3.E5.m1.7.7.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.7.7.1.1.3.3" xref="S3.E5.m1.7.7.1.1.3.3.cmml"><mfrac id="S3.E5.m1.7.7.1.1.3.3.2" xref="S3.E5.m1.7.7.1.1.3.3.2.cmml"><msub id="S3.E5.m1.7.7.1.1.3.3.2.2" xref="S3.E5.m1.7.7.1.1.3.3.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.3.3.2.2.2" xref="S3.E5.m1.7.7.1.1.3.3.2.2.2.cmml">α</mi><mi id="S3.E5.m1.7.7.1.1.3.3.2.2.3" xref="S3.E5.m1.7.7.1.1.3.3.2.2.3.cmml">r</mi></msub><msubsup id="S3.E5.m1.7.7.1.1.3.3.2.3" xref="S3.E5.m1.7.7.1.1.3.3.2.3.cmml"><mo id="S3.E5.m1.7.7.1.1.3.3.2.3.2.2" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.2.cmml">∑</mo><mrow id="S3.E5.m1.7.7.1.1.3.3.2.3.2.3" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.2" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.2.cmml">i</mi><mo id="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.1" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.1.cmml">=</mo><mn id="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.3" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.3.cmml">0</mn></mrow><mi id="S3.E5.m1.7.7.1.1.3.3.2.3.3" xref="S3.E5.m1.7.7.1.1.3.3.2.3.3.cmml">r</mi></msubsup></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.3.3.1" xref="S3.E5.m1.7.7.1.1.3.3.1.cmml">​</mo><msubsup id="S3.E5.m1.7.7.1.1.3.3.3" xref="S3.E5.m1.7.7.1.1.3.3.3.cmml"><mi id="S3.E5.m1.7.7.1.1.3.3.3.2.2" xref="S3.E5.m1.7.7.1.1.3.3.3.2.2.cmml">V</mi><mi id="S3.E5.m1.7.7.1.1.3.3.3.2.3" xref="S3.E5.m1.7.7.1.1.3.3.3.2.3.cmml">m</mi><mrow id="S3.E5.m1.6.6.2.2" xref="S3.E5.m1.6.6.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml">D</mi><mo id="S3.E5.m1.6.6.2.2.2" xref="S3.E5.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E5.m1.6.6.2.2.1" xref="S3.E5.m1.6.6.2.2.1.cmml"><mi id="S3.E5.m1.6.6.2.2.1.2" xref="S3.E5.m1.6.6.2.2.1.2.cmml">r</mi><mo id="S3.E5.m1.6.6.2.2.1.1" xref="S3.E5.m1.6.6.2.2.1.1.cmml">+</mo><mn id="S3.E5.m1.6.6.2.2.1.3" xref="S3.E5.m1.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E5.m1.7.7.1.2" xref="S3.E5.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1"><eq id="S3.E5.m1.7.7.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1"></eq><apply id="S3.E5.m1.7.7.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2">subscript</csymbol><apply id="S3.E5.m1.7.7.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2"><ci id="S3.E5.m1.7.7.1.1.2.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.1">^</ci><ci id="S3.E5.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2.2">𝑉</ci></apply><ci id="S3.E5.m1.7.7.1.1.2.2.3.cmml" xref="S3.E5.m1.7.7.1.1.2.2.3">𝑚</ci></apply><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝐷</ci><apply id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1"><plus id="S3.E5.m1.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1"></plus><ci id="S3.E5.m1.2.2.2.2.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.2">𝑟</ci><cn type="integer" id="S3.E5.m1.2.2.2.2.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S3.E5.m1.7.7.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.3"><plus id="S3.E5.m1.7.7.1.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.1"></plus><apply id="S3.E5.m1.7.7.1.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2"><times id="S3.E5.m1.7.7.1.1.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.1"></times><apply id="S3.E5.m1.7.7.1.1.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2"><divide id="S3.E5.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2"></divide><apply id="S3.E5.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2"><apply id="S3.E5.m1.7.7.1.1.3.2.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.2.2.2.1.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1">subscript</csymbol><sum id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.2"></sum><apply id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3"><eq id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.1"></eq><ci id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.2.3.3">0</cn></apply></apply><ci id="S3.E5.m1.7.7.1.1.3.2.2.2.1.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.1.3">𝑟</ci></apply><apply id="S3.E5.m1.7.7.1.1.3.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.2.2.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.3.2.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.2.2">𝛼</ci><ci id="S3.E5.m1.7.7.1.1.3.2.2.2.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.2.2.3">𝑖</ci></apply></apply><apply id="S3.E5.m1.7.7.1.1.3.2.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3"><apply id="S3.E5.m1.7.7.1.1.3.2.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.2.2.3.1.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1">subscript</csymbol><sum id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.2"></sum><apply id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3"><eq id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.1"></eq><ci id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.2.3.3">0</cn></apply></apply><apply id="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.3"><plus id="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.1"></plus><ci id="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.2">𝑟</ci><cn type="integer" id="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.1.3.3">1</cn></apply></apply><apply id="S3.E5.m1.7.7.1.1.3.2.2.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.2.2.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.3.2.2.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.2.2">𝛼</ci><ci id="S3.E5.m1.7.7.1.1.3.2.2.3.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.2.3.2.3">𝑖</ci></apply></apply></apply><apply id="S3.E5.m1.7.7.1.1.3.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.3">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.3.2.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.2.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.3">subscript</csymbol><apply id="S3.E5.m1.7.7.1.1.3.2.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.3.2.2"><ci id="S3.E5.m1.7.7.1.1.3.2.3.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.2.3.2.2.1">^</ci><ci id="S3.E5.m1.7.7.1.1.3.2.3.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.2.3.2.2.2">𝑉</ci></apply><ci id="S3.E5.m1.7.7.1.1.3.2.3.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.2.3.2.3">𝑚</ci></apply><list id="S3.E5.m1.4.4.2.3.cmml" xref="S3.E5.m1.4.4.2.4"><ci id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1">𝐷</ci><ci id="S3.E5.m1.4.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2">𝑟</ci></list></apply></apply><apply id="S3.E5.m1.7.7.1.1.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3"><times id="S3.E5.m1.7.7.1.1.3.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.1"></times><apply id="S3.E5.m1.7.7.1.1.3.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2"><divide id="S3.E5.m1.7.7.1.1.3.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2"></divide><apply id="S3.E5.m1.7.7.1.1.3.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.3.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.3.3.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.2.2">𝛼</ci><ci id="S3.E5.m1.7.7.1.1.3.3.2.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.2.3">𝑟</ci></apply><apply id="S3.E5.m1.7.7.1.1.3.3.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.3.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.3.3.2.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.3.2.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3">subscript</csymbol><sum id="S3.E5.m1.7.7.1.1.3.3.2.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.2"></sum><apply id="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.3"><eq id="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.1"></eq><ci id="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3.2.3.3">0</cn></apply></apply><ci id="S3.E5.m1.7.7.1.1.3.3.2.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.2.3.3">𝑟</ci></apply></apply><apply id="S3.E5.m1.7.7.1.1.3.3.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.3.3.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.3.3.3.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3.3.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.3.3.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.2.2">𝑉</ci><ci id="S3.E5.m1.7.7.1.1.3.3.3.2.3.cmml" xref="S3.E5.m1.7.7.1.1.3.3.3.2.3">𝑚</ci></apply><list id="S3.E5.m1.6.6.2.3.cmml" xref="S3.E5.m1.6.6.2.2"><ci id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1.1">𝐷</ci><apply id="S3.E5.m1.6.6.2.2.1.cmml" xref="S3.E5.m1.6.6.2.2.1"><plus id="S3.E5.m1.6.6.2.2.1.1.cmml" xref="S3.E5.m1.6.6.2.2.1.1"></plus><ci id="S3.E5.m1.6.6.2.2.1.2.cmml" xref="S3.E5.m1.6.6.2.2.1.2">𝑟</ci><cn type="integer" id="S3.E5.m1.6.6.2.2.1.3.cmml" xref="S3.E5.m1.6.6.2.2.1.3">1</cn></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">\hat{V}_{m}^{D,{r+1}}=\frac{\sum_{i=0}^{r}\alpha_{i}}{\sum_{i=0}^{r+1}\alpha_{i}}\hat{V}_{m}^{D,r}+\frac{\alpha_{r}}{\sum_{i=0}^{r}}V_{m}^{D,{r+1}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p4.11" class="ltx_p">where <math id="S3.SS2.SSS2.p4.7.m1.3" class="ltx_Math" alttext="\alpha_{i}=\textbf{B}(\beta,\beta)(\frac{i+0.5}{R+1})" display="inline"><semantics id="S3.SS2.SSS2.p4.7.m1.3a"><mrow id="S3.SS2.SSS2.p4.7.m1.3.4" xref="S3.SS2.SSS2.p4.7.m1.3.4.cmml"><msub id="S3.SS2.SSS2.p4.7.m1.3.4.2" xref="S3.SS2.SSS2.p4.7.m1.3.4.2.cmml"><mi id="S3.SS2.SSS2.p4.7.m1.3.4.2.2" xref="S3.SS2.SSS2.p4.7.m1.3.4.2.2.cmml">α</mi><mi id="S3.SS2.SSS2.p4.7.m1.3.4.2.3" xref="S3.SS2.SSS2.p4.7.m1.3.4.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.p4.7.m1.3.4.1" xref="S3.SS2.SSS2.p4.7.m1.3.4.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p4.7.m1.3.4.3" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.p4.7.m1.3.4.3.2" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.2a.cmml">B</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p4.7.m1.3.4.3.1" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.1.cmml">​</mo><mrow id="S3.SS2.SSS2.p4.7.m1.3.4.3.3.2" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p4.7.m1.3.4.3.3.2.1" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.3.1.cmml">(</mo><mi id="S3.SS2.SSS2.p4.7.m1.1.1" xref="S3.SS2.SSS2.p4.7.m1.1.1.cmml">β</mi><mo id="S3.SS2.SSS2.p4.7.m1.3.4.3.3.2.2" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.3.1.cmml">,</mo><mi id="S3.SS2.SSS2.p4.7.m1.2.2" xref="S3.SS2.SSS2.p4.7.m1.2.2.cmml">β</mi><mo stretchy="false" id="S3.SS2.SSS2.p4.7.m1.3.4.3.3.2.3" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.3.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p4.7.m1.3.4.3.1a" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.1.cmml">​</mo><mrow id="S3.SS2.SSS2.p4.7.m1.3.4.3.4.2" xref="S3.SS2.SSS2.p4.7.m1.3.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p4.7.m1.3.4.3.4.2.1" xref="S3.SS2.SSS2.p4.7.m1.3.3.cmml">(</mo><mfrac id="S3.SS2.SSS2.p4.7.m1.3.3" xref="S3.SS2.SSS2.p4.7.m1.3.3.cmml"><mrow id="S3.SS2.SSS2.p4.7.m1.3.3.2" xref="S3.SS2.SSS2.p4.7.m1.3.3.2.cmml"><mi id="S3.SS2.SSS2.p4.7.m1.3.3.2.2" xref="S3.SS2.SSS2.p4.7.m1.3.3.2.2.cmml">i</mi><mo id="S3.SS2.SSS2.p4.7.m1.3.3.2.1" xref="S3.SS2.SSS2.p4.7.m1.3.3.2.1.cmml">+</mo><mn id="S3.SS2.SSS2.p4.7.m1.3.3.2.3" xref="S3.SS2.SSS2.p4.7.m1.3.3.2.3.cmml">0.5</mn></mrow><mrow id="S3.SS2.SSS2.p4.7.m1.3.3.3" xref="S3.SS2.SSS2.p4.7.m1.3.3.3.cmml"><mi id="S3.SS2.SSS2.p4.7.m1.3.3.3.2" xref="S3.SS2.SSS2.p4.7.m1.3.3.3.2.cmml">R</mi><mo id="S3.SS2.SSS2.p4.7.m1.3.3.3.1" xref="S3.SS2.SSS2.p4.7.m1.3.3.3.1.cmml">+</mo><mn id="S3.SS2.SSS2.p4.7.m1.3.3.3.3" xref="S3.SS2.SSS2.p4.7.m1.3.3.3.3.cmml">1</mn></mrow></mfrac><mo stretchy="false" id="S3.SS2.SSS2.p4.7.m1.3.4.3.4.2.2" xref="S3.SS2.SSS2.p4.7.m1.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.7.m1.3b"><apply id="S3.SS2.SSS2.p4.7.m1.3.4.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4"><eq id="S3.SS2.SSS2.p4.7.m1.3.4.1.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.1"></eq><apply id="S3.SS2.SSS2.p4.7.m1.3.4.2.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.7.m1.3.4.2.1.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.2">subscript</csymbol><ci id="S3.SS2.SSS2.p4.7.m1.3.4.2.2.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.2.2">𝛼</ci><ci id="S3.SS2.SSS2.p4.7.m1.3.4.2.3.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.p4.7.m1.3.4.3.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.3"><times id="S3.SS2.SSS2.p4.7.m1.3.4.3.1.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.1"></times><ci id="S3.SS2.SSS2.p4.7.m1.3.4.3.2a.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.p4.7.m1.3.4.3.2.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.2">B</mtext></ci><interval closure="open" id="S3.SS2.SSS2.p4.7.m1.3.4.3.3.1.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.3.2"><ci id="S3.SS2.SSS2.p4.7.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.7.m1.1.1">𝛽</ci><ci id="S3.SS2.SSS2.p4.7.m1.2.2.cmml" xref="S3.SS2.SSS2.p4.7.m1.2.2">𝛽</ci></interval><apply id="S3.SS2.SSS2.p4.7.m1.3.3.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.4.2"><divide id="S3.SS2.SSS2.p4.7.m1.3.3.1.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.4.3.4.2"></divide><apply id="S3.SS2.SSS2.p4.7.m1.3.3.2.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.3.2"><plus id="S3.SS2.SSS2.p4.7.m1.3.3.2.1.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.3.2.1"></plus><ci id="S3.SS2.SSS2.p4.7.m1.3.3.2.2.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.3.2.2">𝑖</ci><cn type="float" id="S3.SS2.SSS2.p4.7.m1.3.3.2.3.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.3.2.3">0.5</cn></apply><apply id="S3.SS2.SSS2.p4.7.m1.3.3.3.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.3.3"><plus id="S3.SS2.SSS2.p4.7.m1.3.3.3.1.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.3.3.1"></plus><ci id="S3.SS2.SSS2.p4.7.m1.3.3.3.2.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.3.3.2">𝑅</ci><cn type="integer" id="S3.SS2.SSS2.p4.7.m1.3.3.3.3.cmml" xref="S3.SS2.SSS2.p4.7.m1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.7.m1.3c">\alpha_{i}=\textbf{B}(\beta,\beta)(\frac{i+0.5}{R+1})</annotation></semantics></math> and <math id="S3.SS2.SSS2.p4.8.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS2.SSS2.p4.8.m2.1a"><mi id="S3.SS2.SSS2.p4.8.m2.1.1" xref="S3.SS2.SSS2.p4.8.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.8.m2.1b"><ci id="S3.SS2.SSS2.p4.8.m2.1.1.cmml" xref="S3.SS2.SSS2.p4.8.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.8.m2.1c">\beta</annotation></semantics></math> is a hyper-parameter for beta distribution <math id="S3.SS2.SSS2.p4.9.m3.2" class="ltx_Math" alttext="\textbf{B}(\cdot,\cdot)" display="inline"><semantics id="S3.SS2.SSS2.p4.9.m3.2a"><mrow id="S3.SS2.SSS2.p4.9.m3.2.3" xref="S3.SS2.SSS2.p4.9.m3.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.p4.9.m3.2.3.2" xref="S3.SS2.SSS2.p4.9.m3.2.3.2a.cmml">B</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p4.9.m3.2.3.1" xref="S3.SS2.SSS2.p4.9.m3.2.3.1.cmml">​</mo><mrow id="S3.SS2.SSS2.p4.9.m3.2.3.3.2" xref="S3.SS2.SSS2.p4.9.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p4.9.m3.2.3.3.2.1" xref="S3.SS2.SSS2.p4.9.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p4.9.m3.1.1" xref="S3.SS2.SSS2.p4.9.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.SSS2.p4.9.m3.2.3.3.2.2" xref="S3.SS2.SSS2.p4.9.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p4.9.m3.2.2" xref="S3.SS2.SSS2.p4.9.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.SSS2.p4.9.m3.2.3.3.2.3" xref="S3.SS2.SSS2.p4.9.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.9.m3.2b"><apply id="S3.SS2.SSS2.p4.9.m3.2.3.cmml" xref="S3.SS2.SSS2.p4.9.m3.2.3"><times id="S3.SS2.SSS2.p4.9.m3.2.3.1.cmml" xref="S3.SS2.SSS2.p4.9.m3.2.3.1"></times><ci id="S3.SS2.SSS2.p4.9.m3.2.3.2a.cmml" xref="S3.SS2.SSS2.p4.9.m3.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.SSS2.p4.9.m3.2.3.2.cmml" xref="S3.SS2.SSS2.p4.9.m3.2.3.2">B</mtext></ci><interval closure="open" id="S3.SS2.SSS2.p4.9.m3.2.3.3.1.cmml" xref="S3.SS2.SSS2.p4.9.m3.2.3.3.2"><ci id="S3.SS2.SSS2.p4.9.m3.1.1.cmml" xref="S3.SS2.SSS2.p4.9.m3.1.1">⋅</ci><ci id="S3.SS2.SSS2.p4.9.m3.2.2.cmml" xref="S3.SS2.SSS2.p4.9.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.9.m3.2c">\textbf{B}(\cdot,\cdot)</annotation></semantics></math>. We set <math id="S3.SS2.SSS2.p4.10.m4.1" class="ltx_Math" alttext="\beta=0.2" display="inline"><semantics id="S3.SS2.SSS2.p4.10.m4.1a"><mrow id="S3.SS2.SSS2.p4.10.m4.1.1" xref="S3.SS2.SSS2.p4.10.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p4.10.m4.1.1.2" xref="S3.SS2.SSS2.p4.10.m4.1.1.2.cmml">β</mi><mo id="S3.SS2.SSS2.p4.10.m4.1.1.1" xref="S3.SS2.SSS2.p4.10.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS2.p4.10.m4.1.1.3" xref="S3.SS2.SSS2.p4.10.m4.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.10.m4.1b"><apply id="S3.SS2.SSS2.p4.10.m4.1.1.cmml" xref="S3.SS2.SSS2.p4.10.m4.1.1"><eq id="S3.SS2.SSS2.p4.10.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p4.10.m4.1.1.1"></eq><ci id="S3.SS2.SSS2.p4.10.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p4.10.m4.1.1.2">𝛽</ci><cn type="float" id="S3.SS2.SSS2.p4.10.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p4.10.m4.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.10.m4.1c">\beta=0.2</annotation></semantics></math> to preserve current optimization and initial domain knowledge attached at the beginning of training. <math id="S3.SS2.SSS2.p4.11.m5.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS2.SSS2.p4.11.m5.1a"><mi id="S3.SS2.SSS2.p4.11.m5.1.1" xref="S3.SS2.SSS2.p4.11.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.11.m5.1b"><ci id="S3.SS2.SSS2.p4.11.m5.1.1.cmml" xref="S3.SS2.SSS2.p4.11.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.11.m5.1c">R</annotation></semantics></math> is the number of global rounds.</p>
</div>
<div id="S3.SS2.SSS2.p5" class="ltx_para">
<p id="S3.SS2.SSS2.p5.1" class="ltx_p">After <math id="S3.SS2.SSS2.p5.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.SSS2.p5.1.m1.1a"><mi id="S3.SS2.SSS2.p5.1.m1.1.1" xref="S3.SS2.SSS2.p5.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.1.m1.1b"><ci id="S3.SS2.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.1.m1.1c">T</annotation></semantics></math> local iterations, only G-Prompt and D-Prompts are uploaded to the central server. Like FedAvg, the server updates the global prompt using a weighted aggregation of prompts from received clients in the current round. The process continues for next round by sending updated G-Prompt and momentum-averaged D-Prompts to newly selected clients.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Dynamic Query Scheme (Q-Prompt)</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.5" class="ltx_p">To efficiently learn prompts with unknown domain labels,
we design a dynamic query scheme based on prompt tuning, which automatically selects appropriate domain prompts for different source inputs. Considering data is naturally separated according to semantic categories, most prior methods cannot avoid interference from the semantic category labels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">43</span></a>]</cite>. Our query scheme adopts a two-substep strategy as shown in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> middle left (gray area), where each input image is first classified into a category and then grouped to an underlying domain.
Practically, we construct a learnable prompt called Q-Prompt <math id="S3.SS3.p1.1.m1.4" class="ltx_Math" alttext="V^{Q}=\left\{v_{1}^{Q},v_{2}^{Q},...,v_{L}^{Q}\right\}" display="inline"><semantics id="S3.SS3.p1.1.m1.4a"><mrow id="S3.SS3.p1.1.m1.4.4" xref="S3.SS3.p1.1.m1.4.4.cmml"><msup id="S3.SS3.p1.1.m1.4.4.5" xref="S3.SS3.p1.1.m1.4.4.5.cmml"><mi id="S3.SS3.p1.1.m1.4.4.5.2" xref="S3.SS3.p1.1.m1.4.4.5.2.cmml">V</mi><mi id="S3.SS3.p1.1.m1.4.4.5.3" xref="S3.SS3.p1.1.m1.4.4.5.3.cmml">Q</mi></msup><mo id="S3.SS3.p1.1.m1.4.4.4" xref="S3.SS3.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.p1.1.m1.4.4.3.3" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS3.p1.1.m1.4.4.3.3.4" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">{</mo><msubsup id="S3.SS3.p1.1.m1.2.2.1.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.2.cmml">v</mi><mn id="S3.SS3.p1.1.m1.2.2.1.1.1.2.3" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS3.p1.1.m1.2.2.1.1.1.3" xref="S3.SS3.p1.1.m1.2.2.1.1.1.3.cmml">Q</mi></msubsup><mo id="S3.SS3.p1.1.m1.4.4.3.3.5" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.1.m1.3.3.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.2.cmml">v</mi><mn id="S3.SS3.p1.1.m1.3.3.2.2.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS3.p1.1.m1.3.3.2.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3.cmml">Q</mi></msubsup><mo id="S3.SS3.p1.1.m1.4.4.3.3.6" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p1.1.m1.4.4.3.3.7" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.1.m1.4.4.3.3.3" xref="S3.SS3.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.p1.1.m1.4.4.3.3.3.2.2" xref="S3.SS3.p1.1.m1.4.4.3.3.3.2.2.cmml">v</mi><mi id="S3.SS3.p1.1.m1.4.4.3.3.3.2.3" xref="S3.SS3.p1.1.m1.4.4.3.3.3.2.3.cmml">L</mi><mi id="S3.SS3.p1.1.m1.4.4.3.3.3.3" xref="S3.SS3.p1.1.m1.4.4.3.3.3.3.cmml">Q</mi></msubsup><mo id="S3.SS3.p1.1.m1.4.4.3.3.8" xref="S3.SS3.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.4b"><apply id="S3.SS3.p1.1.m1.4.4.cmml" xref="S3.SS3.p1.1.m1.4.4"><eq id="S3.SS3.p1.1.m1.4.4.4.cmml" xref="S3.SS3.p1.1.m1.4.4.4"></eq><apply id="S3.SS3.p1.1.m1.4.4.5.cmml" xref="S3.SS3.p1.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.5.1.cmml" xref="S3.SS3.p1.1.m1.4.4.5">superscript</csymbol><ci id="S3.SS3.p1.1.m1.4.4.5.2.cmml" xref="S3.SS3.p1.1.m1.4.4.5.2">𝑉</ci><ci id="S3.SS3.p1.1.m1.4.4.5.3.cmml" xref="S3.SS3.p1.1.m1.4.4.5.3">𝑄</ci></apply><set id="S3.SS3.p1.1.m1.4.4.3.4.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3"><apply id="S3.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.2">𝑣</ci><cn type="integer" id="S3.SS3.p1.1.m1.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.3">𝑄</ci></apply><apply id="S3.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.2">𝑣</ci><cn type="integer" id="S3.SS3.p1.1.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2.3">𝑄</ci></apply><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">…</ci><apply id="S3.SS3.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3.2.2">𝑣</ci><ci id="S3.SS3.p1.1.m1.4.4.3.3.3.2.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3.2.3">𝐿</ci></apply><ci id="S3.SS3.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3.3.3.3">𝑄</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.4c">V^{Q}=\left\{v_{1}^{Q},v_{2}^{Q},...,v_{L}^{Q}\right\}</annotation></semantics></math> that is shared among all classes and domains. For <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">j</annotation></semantics></math>-th class and <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">m</annotation></semantics></math>-th domain, the output text embedding is <math id="S3.SS3.p1.4.m4.5" class="ltx_Math" alttext="Z_{j,m}^{Q}=g(t_{j,m})" display="inline"><semantics id="S3.SS3.p1.4.m4.5a"><mrow id="S3.SS3.p1.4.m4.5.5" xref="S3.SS3.p1.4.m4.5.5.cmml"><msubsup id="S3.SS3.p1.4.m4.5.5.3" xref="S3.SS3.p1.4.m4.5.5.3.cmml"><mi id="S3.SS3.p1.4.m4.5.5.3.2.2" xref="S3.SS3.p1.4.m4.5.5.3.2.2.cmml">Z</mi><mrow id="S3.SS3.p1.4.m4.2.2.2.4" xref="S3.SS3.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.cmml">j</mi><mo id="S3.SS3.p1.4.m4.2.2.2.4.1" xref="S3.SS3.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.4.m4.2.2.2.2" xref="S3.SS3.p1.4.m4.2.2.2.2.cmml">m</mi></mrow><mi id="S3.SS3.p1.4.m4.5.5.3.3" xref="S3.SS3.p1.4.m4.5.5.3.3.cmml">Q</mi></msubsup><mo id="S3.SS3.p1.4.m4.5.5.2" xref="S3.SS3.p1.4.m4.5.5.2.cmml">=</mo><mrow id="S3.SS3.p1.4.m4.5.5.1" xref="S3.SS3.p1.4.m4.5.5.1.cmml"><mi id="S3.SS3.p1.4.m4.5.5.1.3" xref="S3.SS3.p1.4.m4.5.5.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.5.5.1.2" xref="S3.SS3.p1.4.m4.5.5.1.2.cmml">​</mo><mrow id="S3.SS3.p1.4.m4.5.5.1.1.1" xref="S3.SS3.p1.4.m4.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m4.5.5.1.1.1.2" xref="S3.SS3.p1.4.m4.5.5.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.4.m4.5.5.1.1.1.1" xref="S3.SS3.p1.4.m4.5.5.1.1.1.1.cmml"><mi id="S3.SS3.p1.4.m4.5.5.1.1.1.1.2" xref="S3.SS3.p1.4.m4.5.5.1.1.1.1.2.cmml">t</mi><mrow id="S3.SS3.p1.4.m4.4.4.2.4" xref="S3.SS3.p1.4.m4.4.4.2.3.cmml"><mi id="S3.SS3.p1.4.m4.3.3.1.1" xref="S3.SS3.p1.4.m4.3.3.1.1.cmml">j</mi><mo id="S3.SS3.p1.4.m4.4.4.2.4.1" xref="S3.SS3.p1.4.m4.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p1.4.m4.4.4.2.2" xref="S3.SS3.p1.4.m4.4.4.2.2.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p1.4.m4.5.5.1.1.1.3" xref="S3.SS3.p1.4.m4.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.5b"><apply id="S3.SS3.p1.4.m4.5.5.cmml" xref="S3.SS3.p1.4.m4.5.5"><eq id="S3.SS3.p1.4.m4.5.5.2.cmml" xref="S3.SS3.p1.4.m4.5.5.2"></eq><apply id="S3.SS3.p1.4.m4.5.5.3.cmml" xref="S3.SS3.p1.4.m4.5.5.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.5.5.3.1.cmml" xref="S3.SS3.p1.4.m4.5.5.3">superscript</csymbol><apply id="S3.SS3.p1.4.m4.5.5.3.2.cmml" xref="S3.SS3.p1.4.m4.5.5.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.5.5.3.2.1.cmml" xref="S3.SS3.p1.4.m4.5.5.3">subscript</csymbol><ci id="S3.SS3.p1.4.m4.5.5.3.2.2.cmml" xref="S3.SS3.p1.4.m4.5.5.3.2.2">𝑍</ci><list id="S3.SS3.p1.4.m4.2.2.2.3.cmml" xref="S3.SS3.p1.4.m4.2.2.2.4"><ci id="S3.SS3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1">𝑗</ci><ci id="S3.SS3.p1.4.m4.2.2.2.2.cmml" xref="S3.SS3.p1.4.m4.2.2.2.2">𝑚</ci></list></apply><ci id="S3.SS3.p1.4.m4.5.5.3.3.cmml" xref="S3.SS3.p1.4.m4.5.5.3.3">𝑄</ci></apply><apply id="S3.SS3.p1.4.m4.5.5.1.cmml" xref="S3.SS3.p1.4.m4.5.5.1"><times id="S3.SS3.p1.4.m4.5.5.1.2.cmml" xref="S3.SS3.p1.4.m4.5.5.1.2"></times><ci id="S3.SS3.p1.4.m4.5.5.1.3.cmml" xref="S3.SS3.p1.4.m4.5.5.1.3">𝑔</ci><apply id="S3.SS3.p1.4.m4.5.5.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.5.5.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.5.5.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.5.5.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.5.5.1.1.1.1.2">𝑡</ci><list id="S3.SS3.p1.4.m4.4.4.2.3.cmml" xref="S3.SS3.p1.4.m4.4.4.2.4"><ci id="S3.SS3.p1.4.m4.3.3.1.1.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1">𝑗</ci><ci id="S3.SS3.p1.4.m4.4.4.2.2.cmml" xref="S3.SS3.p1.4.m4.4.4.2.2">𝑚</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.5c">Z_{j,m}^{Q}=g(t_{j,m})</annotation></semantics></math>, where <math id="S3.SS3.p1.5.m5.5" class="ltx_Math" alttext="t_{j,m}=\left\{V^{Q},c_{j},s_{m}\right\}" display="inline"><semantics id="S3.SS3.p1.5.m5.5a"><mrow id="S3.SS3.p1.5.m5.5.5" xref="S3.SS3.p1.5.m5.5.5.cmml"><msub id="S3.SS3.p1.5.m5.5.5.5" xref="S3.SS3.p1.5.m5.5.5.5.cmml"><mi id="S3.SS3.p1.5.m5.5.5.5.2" xref="S3.SS3.p1.5.m5.5.5.5.2.cmml">t</mi><mrow id="S3.SS3.p1.5.m5.2.2.2.4" xref="S3.SS3.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.cmml">j</mi><mo id="S3.SS3.p1.5.m5.2.2.2.4.1" xref="S3.SS3.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.5.m5.2.2.2.2" xref="S3.SS3.p1.5.m5.2.2.2.2.cmml">m</mi></mrow></msub><mo id="S3.SS3.p1.5.m5.5.5.4" xref="S3.SS3.p1.5.m5.5.5.4.cmml">=</mo><mrow id="S3.SS3.p1.5.m5.5.5.3.3" xref="S3.SS3.p1.5.m5.5.5.3.4.cmml"><mo id="S3.SS3.p1.5.m5.5.5.3.3.4" xref="S3.SS3.p1.5.m5.5.5.3.4.cmml">{</mo><msup id="S3.SS3.p1.5.m5.3.3.1.1.1" xref="S3.SS3.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.SS3.p1.5.m5.3.3.1.1.1.2" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.cmml">V</mi><mi id="S3.SS3.p1.5.m5.3.3.1.1.1.3" xref="S3.SS3.p1.5.m5.3.3.1.1.1.3.cmml">Q</mi></msup><mo id="S3.SS3.p1.5.m5.5.5.3.3.5" xref="S3.SS3.p1.5.m5.5.5.3.4.cmml">,</mo><msub id="S3.SS3.p1.5.m5.4.4.2.2.2" xref="S3.SS3.p1.5.m5.4.4.2.2.2.cmml"><mi id="S3.SS3.p1.5.m5.4.4.2.2.2.2" xref="S3.SS3.p1.5.m5.4.4.2.2.2.2.cmml">c</mi><mi id="S3.SS3.p1.5.m5.4.4.2.2.2.3" xref="S3.SS3.p1.5.m5.4.4.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS3.p1.5.m5.5.5.3.3.6" xref="S3.SS3.p1.5.m5.5.5.3.4.cmml">,</mo><msub id="S3.SS3.p1.5.m5.5.5.3.3.3" xref="S3.SS3.p1.5.m5.5.5.3.3.3.cmml"><mi id="S3.SS3.p1.5.m5.5.5.3.3.3.2" xref="S3.SS3.p1.5.m5.5.5.3.3.3.2.cmml">s</mi><mi id="S3.SS3.p1.5.m5.5.5.3.3.3.3" xref="S3.SS3.p1.5.m5.5.5.3.3.3.3.cmml">m</mi></msub><mo id="S3.SS3.p1.5.m5.5.5.3.3.7" xref="S3.SS3.p1.5.m5.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.5b"><apply id="S3.SS3.p1.5.m5.5.5.cmml" xref="S3.SS3.p1.5.m5.5.5"><eq id="S3.SS3.p1.5.m5.5.5.4.cmml" xref="S3.SS3.p1.5.m5.5.5.4"></eq><apply id="S3.SS3.p1.5.m5.5.5.5.cmml" xref="S3.SS3.p1.5.m5.5.5.5"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.5.5.5.1.cmml" xref="S3.SS3.p1.5.m5.5.5.5">subscript</csymbol><ci id="S3.SS3.p1.5.m5.5.5.5.2.cmml" xref="S3.SS3.p1.5.m5.5.5.5.2">𝑡</ci><list id="S3.SS3.p1.5.m5.2.2.2.3.cmml" xref="S3.SS3.p1.5.m5.2.2.2.4"><ci id="S3.SS3.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">𝑗</ci><ci id="S3.SS3.p1.5.m5.2.2.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.2.2">𝑚</ci></list></apply><set id="S3.SS3.p1.5.m5.5.5.3.4.cmml" xref="S3.SS3.p1.5.m5.5.5.3.3"><apply id="S3.SS3.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2">𝑉</ci><ci id="S3.SS3.p1.5.m5.3.3.1.1.1.3.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.3">𝑄</ci></apply><apply id="S3.SS3.p1.5.m5.4.4.2.2.2.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2.2.2">𝑐</ci><ci id="S3.SS3.p1.5.m5.4.4.2.2.2.3.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2.2.3">𝑗</ci></apply><apply id="S3.SS3.p1.5.m5.5.5.3.3.3.cmml" xref="S3.SS3.p1.5.m5.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.5.5.3.3.3.1.cmml" xref="S3.SS3.p1.5.m5.5.5.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.5.m5.5.5.3.3.3.2.cmml" xref="S3.SS3.p1.5.m5.5.5.3.3.3.2">𝑠</ci><ci id="S3.SS3.p1.5.m5.5.5.3.3.3.3.cmml" xref="S3.SS3.p1.5.m5.5.5.3.3.3.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.5c">t_{j,m}=\left\{V^{Q},c_{j},s_{m}\right\}</annotation></semantics></math>. We perform class and domain similarity matching on the input text-image pairs by:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.9" class="ltx_Math" alttext="P(y=j,d=m|x)=\frac{{\rm exp}({\rm sim}(I,Z_{j,m}^{Q})/\tau)}{\sum\limits_{p=1}^{C}\sum\limits_{q=1}^{M}{\rm exp}({\rm sim}(I,Z_{p,q}^{Q})/\tau)}," display="block"><semantics id="S3.E6.m1.9a"><mrow id="S3.E6.m1.9.9.1" xref="S3.E6.m1.9.9.1.1.cmml"><mrow id="S3.E6.m1.9.9.1.1" xref="S3.E6.m1.9.9.1.1.cmml"><mrow id="S3.E6.m1.9.9.1.1.1" xref="S3.E6.m1.9.9.1.1.1.cmml"><mi id="S3.E6.m1.9.9.1.1.1.3" xref="S3.E6.m1.9.9.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.9.9.1.1.1.2" xref="S3.E6.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.9.9.1.1.1.1.1" xref="S3.E6.m1.9.9.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.9.9.1.1.1.1.1.2" xref="S3.E6.m1.9.9.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.9.9.1.1.1.1.1.1.2" xref="S3.E6.m1.9.9.1.1.1.1.1.1.3.cmml"><mrow id="S3.E6.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml">j</mi></mrow><mo id="S3.E6.m1.9.9.1.1.1.1.1.1.2.3" xref="S3.E6.m1.9.9.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.2.cmml">d</mi><mo id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.1" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.1.cmml">=</mo><mrow id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.2" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.2.cmml">m</mi><mo fence="false" id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.1" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.1.cmml">|</mo><mi id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.3" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.3.cmml">x</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E6.m1.9.9.1.1.1.1.1.3" xref="S3.E6.m1.9.9.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.9.9.1.1.2" xref="S3.E6.m1.9.9.1.1.2.cmml">=</mo><mfrac id="S3.E6.m1.8.8" xref="S3.E6.m1.8.8.cmml"><mrow id="S3.E6.m1.4.4.4" xref="S3.E6.m1.4.4.4.cmml"><mi id="S3.E6.m1.4.4.4.6" xref="S3.E6.m1.4.4.4.6.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.4.5" xref="S3.E6.m1.4.4.4.5.cmml">​</mo><mrow id="S3.E6.m1.4.4.4.4.1" xref="S3.E6.m1.4.4.4.4.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.4.4.1.2" xref="S3.E6.m1.4.4.4.4.1.1.cmml">(</mo><mrow id="S3.E6.m1.4.4.4.4.1.1" xref="S3.E6.m1.4.4.4.4.1.1.cmml"><mrow id="S3.E6.m1.4.4.4.4.1.1.1" xref="S3.E6.m1.4.4.4.4.1.1.1.cmml"><mi id="S3.E6.m1.4.4.4.4.1.1.1.3" xref="S3.E6.m1.4.4.4.4.1.1.1.3.cmml">sim</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.4.4.1.1.1.2" xref="S3.E6.m1.4.4.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.4.4.4.4.1.1.1.1.1" xref="S3.E6.m1.4.4.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.4.4.1.1.1.1.1.2" xref="S3.E6.m1.4.4.4.4.1.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.3.3.3.3" xref="S3.E6.m1.3.3.3.3.cmml">I</mi><mo id="S3.E6.m1.4.4.4.4.1.1.1.1.1.3" xref="S3.E6.m1.4.4.4.4.1.1.1.1.2.cmml">,</mo><msubsup id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.2.2" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.2.2.cmml">Z</mi><mrow id="S3.E6.m1.2.2.2.2.2.4" xref="S3.E6.m1.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">j</mi><mo id="S3.E6.m1.2.2.2.2.2.4.1" xref="S3.E6.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.cmml">m</mi></mrow><mi id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.3.cmml">Q</mi></msubsup><mo stretchy="false" id="S3.E6.m1.4.4.4.4.1.1.1.1.1.4" xref="S3.E6.m1.4.4.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.4.4.4.4.1.1.2" xref="S3.E6.m1.4.4.4.4.1.1.2.cmml">/</mo><mi id="S3.E6.m1.4.4.4.4.1.1.3" xref="S3.E6.m1.4.4.4.4.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E6.m1.4.4.4.4.1.3" xref="S3.E6.m1.4.4.4.4.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E6.m1.8.8.8" xref="S3.E6.m1.8.8.8.cmml"><munderover id="S3.E6.m1.8.8.8.5" xref="S3.E6.m1.8.8.8.5.cmml"><mo movablelimits="false" id="S3.E6.m1.8.8.8.5.2.2" xref="S3.E6.m1.8.8.8.5.2.2.cmml">∑</mo><mrow id="S3.E6.m1.8.8.8.5.2.3" xref="S3.E6.m1.8.8.8.5.2.3.cmml"><mi id="S3.E6.m1.8.8.8.5.2.3.2" xref="S3.E6.m1.8.8.8.5.2.3.2.cmml">p</mi><mo id="S3.E6.m1.8.8.8.5.2.3.1" xref="S3.E6.m1.8.8.8.5.2.3.1.cmml">=</mo><mn id="S3.E6.m1.8.8.8.5.2.3.3" xref="S3.E6.m1.8.8.8.5.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.8.8.8.5.3" xref="S3.E6.m1.8.8.8.5.3.cmml">C</mi></munderover><mrow id="S3.E6.m1.8.8.8.4" xref="S3.E6.m1.8.8.8.4.cmml"><munderover id="S3.E6.m1.8.8.8.4.2" xref="S3.E6.m1.8.8.8.4.2.cmml"><mo lspace="0.167em" movablelimits="false" id="S3.E6.m1.8.8.8.4.2.2.2" xref="S3.E6.m1.8.8.8.4.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.8.8.8.4.2.2.3" xref="S3.E6.m1.8.8.8.4.2.2.3.cmml"><mi id="S3.E6.m1.8.8.8.4.2.2.3.2" xref="S3.E6.m1.8.8.8.4.2.2.3.2.cmml">q</mi><mo id="S3.E6.m1.8.8.8.4.2.2.3.1" xref="S3.E6.m1.8.8.8.4.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.8.8.8.4.2.2.3.3" xref="S3.E6.m1.8.8.8.4.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.8.8.8.4.2.3" xref="S3.E6.m1.8.8.8.4.2.3.cmml">M</mi></munderover><mrow id="S3.E6.m1.8.8.8.4.1" xref="S3.E6.m1.8.8.8.4.1.cmml"><mi id="S3.E6.m1.8.8.8.4.1.3" xref="S3.E6.m1.8.8.8.4.1.3.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.8.4.1.2" xref="S3.E6.m1.8.8.8.4.1.2.cmml">​</mo><mrow id="S3.E6.m1.8.8.8.4.1.1.1" xref="S3.E6.m1.8.8.8.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.8.4.1.1.1.2" xref="S3.E6.m1.8.8.8.4.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.8.8.8.4.1.1.1.1" xref="S3.E6.m1.8.8.8.4.1.1.1.1.cmml"><mrow id="S3.E6.m1.8.8.8.4.1.1.1.1.1" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.cmml"><mi id="S3.E6.m1.8.8.8.4.1.1.1.1.1.3" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.3.cmml">sim</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.8.4.1.1.1.1.1.2" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.2" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.7.7.7.3" xref="S3.E6.m1.7.7.7.3.cmml">I</mi><mo id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.3" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.2.cmml">,</mo><msubsup id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.2.cmml">Z</mi><mrow id="S3.E6.m1.6.6.6.2.2.4" xref="S3.E6.m1.6.6.6.2.2.3.cmml"><mi id="S3.E6.m1.5.5.5.1.1.1" xref="S3.E6.m1.5.5.5.1.1.1.cmml">p</mi><mo id="S3.E6.m1.6.6.6.2.2.4.1" xref="S3.E6.m1.6.6.6.2.2.3.cmml">,</mo><mi id="S3.E6.m1.6.6.6.2.2.2" xref="S3.E6.m1.6.6.6.2.2.2.cmml">q</mi></mrow><mi id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.3.cmml">Q</mi></msubsup><mo stretchy="false" id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.4" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.8.8.8.4.1.1.1.1.2" xref="S3.E6.m1.8.8.8.4.1.1.1.1.2.cmml">/</mo><mi id="S3.E6.m1.8.8.8.4.1.1.1.1.3" xref="S3.E6.m1.8.8.8.4.1.1.1.1.3.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E6.m1.8.8.8.4.1.1.1.3" xref="S3.E6.m1.8.8.8.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E6.m1.9.9.1.2" xref="S3.E6.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.9b"><apply id="S3.E6.m1.9.9.1.1.cmml" xref="S3.E6.m1.9.9.1"><eq id="S3.E6.m1.9.9.1.1.2.cmml" xref="S3.E6.m1.9.9.1.1.2"></eq><apply id="S3.E6.m1.9.9.1.1.1.cmml" xref="S3.E6.m1.9.9.1.1.1"><times id="S3.E6.m1.9.9.1.1.1.2.cmml" xref="S3.E6.m1.9.9.1.1.1.2"></times><ci id="S3.E6.m1.9.9.1.1.1.3.cmml" xref="S3.E6.m1.9.9.1.1.1.3">𝑃</ci><apply id="S3.E6.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.9.9.1.1.1.1.1.1.3a.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.1.1"><eq id="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.1"></eq><ci id="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2"><eq id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.1"></eq><ci id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.2">𝑑</ci><apply id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3"><csymbol cd="latexml" id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.1">conditional</csymbol><ci id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.2">𝑚</ci><ci id="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E6.m1.9.9.1.1.1.1.1.1.2.2.3.3">𝑥</ci></apply></apply></apply></apply><apply id="S3.E6.m1.8.8.cmml" xref="S3.E6.m1.8.8"><divide id="S3.E6.m1.8.8.9.cmml" xref="S3.E6.m1.8.8"></divide><apply id="S3.E6.m1.4.4.4.cmml" xref="S3.E6.m1.4.4.4"><times id="S3.E6.m1.4.4.4.5.cmml" xref="S3.E6.m1.4.4.4.5"></times><ci id="S3.E6.m1.4.4.4.6.cmml" xref="S3.E6.m1.4.4.4.6">exp</ci><apply id="S3.E6.m1.4.4.4.4.1.1.cmml" xref="S3.E6.m1.4.4.4.4.1"><divide id="S3.E6.m1.4.4.4.4.1.1.2.cmml" xref="S3.E6.m1.4.4.4.4.1.1.2"></divide><apply id="S3.E6.m1.4.4.4.4.1.1.1.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1"><times id="S3.E6.m1.4.4.4.4.1.1.1.2.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.2"></times><ci id="S3.E6.m1.4.4.4.4.1.1.1.3.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.3">sim</ci><interval closure="open" id="S3.E6.m1.4.4.4.4.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1"><ci id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3">𝐼</ci><apply id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.2.2">𝑍</ci><list id="S3.E6.m1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">𝑗</ci><ci id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2">𝑚</ci></list></apply><ci id="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.4.4.1.1.1.1.1.1.3">𝑄</ci></apply></interval></apply><ci id="S3.E6.m1.4.4.4.4.1.1.3.cmml" xref="S3.E6.m1.4.4.4.4.1.1.3">𝜏</ci></apply></apply><apply id="S3.E6.m1.8.8.8.cmml" xref="S3.E6.m1.8.8.8"><apply id="S3.E6.m1.8.8.8.5.cmml" xref="S3.E6.m1.8.8.8.5"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.5.1.cmml" xref="S3.E6.m1.8.8.8.5">superscript</csymbol><apply id="S3.E6.m1.8.8.8.5.2.cmml" xref="S3.E6.m1.8.8.8.5"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.5.2.1.cmml" xref="S3.E6.m1.8.8.8.5">subscript</csymbol><sum id="S3.E6.m1.8.8.8.5.2.2.cmml" xref="S3.E6.m1.8.8.8.5.2.2"></sum><apply id="S3.E6.m1.8.8.8.5.2.3.cmml" xref="S3.E6.m1.8.8.8.5.2.3"><eq id="S3.E6.m1.8.8.8.5.2.3.1.cmml" xref="S3.E6.m1.8.8.8.5.2.3.1"></eq><ci id="S3.E6.m1.8.8.8.5.2.3.2.cmml" xref="S3.E6.m1.8.8.8.5.2.3.2">𝑝</ci><cn type="integer" id="S3.E6.m1.8.8.8.5.2.3.3.cmml" xref="S3.E6.m1.8.8.8.5.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.8.8.8.5.3.cmml" xref="S3.E6.m1.8.8.8.5.3">𝐶</ci></apply><apply id="S3.E6.m1.8.8.8.4.cmml" xref="S3.E6.m1.8.8.8.4"><apply id="S3.E6.m1.8.8.8.4.2.cmml" xref="S3.E6.m1.8.8.8.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.4.2.1.cmml" xref="S3.E6.m1.8.8.8.4.2">superscript</csymbol><apply id="S3.E6.m1.8.8.8.4.2.2.cmml" xref="S3.E6.m1.8.8.8.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.4.2.2.1.cmml" xref="S3.E6.m1.8.8.8.4.2">subscript</csymbol><sum id="S3.E6.m1.8.8.8.4.2.2.2.cmml" xref="S3.E6.m1.8.8.8.4.2.2.2"></sum><apply id="S3.E6.m1.8.8.8.4.2.2.3.cmml" xref="S3.E6.m1.8.8.8.4.2.2.3"><eq id="S3.E6.m1.8.8.8.4.2.2.3.1.cmml" xref="S3.E6.m1.8.8.8.4.2.2.3.1"></eq><ci id="S3.E6.m1.8.8.8.4.2.2.3.2.cmml" xref="S3.E6.m1.8.8.8.4.2.2.3.2">𝑞</ci><cn type="integer" id="S3.E6.m1.8.8.8.4.2.2.3.3.cmml" xref="S3.E6.m1.8.8.8.4.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.8.8.8.4.2.3.cmml" xref="S3.E6.m1.8.8.8.4.2.3">𝑀</ci></apply><apply id="S3.E6.m1.8.8.8.4.1.cmml" xref="S3.E6.m1.8.8.8.4.1"><times id="S3.E6.m1.8.8.8.4.1.2.cmml" xref="S3.E6.m1.8.8.8.4.1.2"></times><ci id="S3.E6.m1.8.8.8.4.1.3.cmml" xref="S3.E6.m1.8.8.8.4.1.3">exp</ci><apply id="S3.E6.m1.8.8.8.4.1.1.1.1.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1"><divide id="S3.E6.m1.8.8.8.4.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.2"></divide><apply id="S3.E6.m1.8.8.8.4.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1"><times id="S3.E6.m1.8.8.8.4.1.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.2"></times><ci id="S3.E6.m1.8.8.8.4.1.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.3">sim</ci><interval closure="open" id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1"><ci id="S3.E6.m1.7.7.7.3.cmml" xref="S3.E6.m1.7.7.7.3">𝐼</ci><apply id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.2">𝑍</ci><list id="S3.E6.m1.6.6.6.2.2.3.cmml" xref="S3.E6.m1.6.6.6.2.2.4"><ci id="S3.E6.m1.5.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.5.1.1.1">𝑝</ci><ci id="S3.E6.m1.6.6.6.2.2.2.cmml" xref="S3.E6.m1.6.6.6.2.2.2">𝑞</ci></list></apply><ci id="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.1.1.1.1.3">𝑄</ci></apply></interval></apply><ci id="S3.E6.m1.8.8.8.4.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.8.4.1.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.9c">P(y=j,d=m|x)=\frac{{\rm exp}({\rm sim}(I,Z_{j,m}^{Q})/\tau)}{\sum\limits_{p=1}^{C}\sum\limits_{q=1}^{M}{\rm exp}({\rm sim}(I,Z_{p,q}^{Q})/\tau)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.6" class="ltx_p">where we select the domain with the highest probability under the ground-truth class during training and across all categories when testing on the target domain.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.9" class="ltx_p">To ensure the effectiveness of the Q-prompt during the early period training, we initialize it with word embeddings derived from the hand-crafted prompt, i.e., “a photo of a [class] with the domain of [domain]”. Furthermore, we utilize two self-consistent regularization terms to perform Q-prompt tuning for better adaptation to downstream tasks. Specifically, MSE loss regulates feature-level alignments between the current prompt and beta momentum averaging counterpart, while we impose logits-level constraints by minimizing the Kullback-Leibler divergence between input images with current and momentum prompts, respectively. Formally, the optimization can be formalized as:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.53" class="ltx_math_unparsed" alttext="\begin{split}\mathcal{L}_{Q}&amp;=\mathcal{L}_{mse}+\mathcal{L}_{KL}=\mathbb{E}_{x,y}\sum_{m=1}^{M}[(Z_{y,m}^{Q})-(\hat{Z}_{y,m}^{Q})]^{2}\\
&amp;+\mathcal{D}_{KL}({\rm sim}(I,Z_{y,m}^{Q}),{\rm sim}(I,\hat{Z}_{y,m}^{Q}))],\end{split}" display="block"><semantics id="S3.E7.m1.53a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E7.m1.53.53.1"><mtr id="S3.E7.m1.53.53.1a"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.53.53.1b"><msub id="S3.E7.m1.2.2.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.1">ℒ</mi><mi id="S3.E7.m1.2.2.2.2.2.2.1">Q</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.53.53.1c"><mrow id="S3.E7.m1.53.53.1.53.29.27"><mi id="S3.E7.m1.53.53.1.53.29.27.29"></mi><mo id="S3.E7.m1.3.3.3.3.1.1">=</mo><mrow id="S3.E7.m1.53.53.1.53.29.27.30"><msub id="S3.E7.m1.53.53.1.53.29.27.30.1"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.4.4.4.4.2.2">ℒ</mi><mrow id="S3.E7.m1.5.5.5.5.3.3.1"><mi id="S3.E7.m1.5.5.5.5.3.3.1.2">m</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.5.3.3.1.1">​</mo><mi id="S3.E7.m1.5.5.5.5.3.3.1.3">s</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.5.3.3.1.1a">​</mo><mi id="S3.E7.m1.5.5.5.5.3.3.1.4">e</mi></mrow></msub><mo id="S3.E7.m1.6.6.6.6.4.4">+</mo><msub id="S3.E7.m1.53.53.1.53.29.27.30.2"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.7.7.7.7.5.5">ℒ</mi><mrow id="S3.E7.m1.8.8.8.8.6.6.1"><mi id="S3.E7.m1.8.8.8.8.6.6.1.2">K</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.8.8.6.6.1.1">​</mo><mi id="S3.E7.m1.8.8.8.8.6.6.1.3">L</mi></mrow></msub></mrow><mo id="S3.E7.m1.9.9.9.9.7.7">=</mo><mrow id="S3.E7.m1.53.53.1.53.29.27.27"><msub id="S3.E7.m1.53.53.1.53.29.27.27.3"><mi id="S3.E7.m1.10.10.10.10.8.8">𝔼</mi><mrow id="S3.E7.m1.11.11.11.11.9.9.1.4"><mi id="S3.E7.m1.11.11.11.11.9.9.1.1">x</mi><mo id="S3.E7.m1.11.11.11.11.9.9.1.4.1">,</mo><mi id="S3.E7.m1.11.11.11.11.9.9.1.2">y</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.53.53.1.53.29.27.27.2">​</mo><mrow id="S3.E7.m1.53.53.1.53.29.27.27.1"><munderover id="S3.E7.m1.53.53.1.53.29.27.27.1.2"><mo movablelimits="false" rspace="0em" id="S3.E7.m1.12.12.12.12.10.10">∑</mo><mrow id="S3.E7.m1.13.13.13.13.11.11.1"><mi id="S3.E7.m1.13.13.13.13.11.11.1.2">m</mi><mo id="S3.E7.m1.13.13.13.13.11.11.1.1">=</mo><mn id="S3.E7.m1.13.13.13.13.11.11.1.3">1</mn></mrow><mi id="S3.E7.m1.14.14.14.14.12.12.1">M</mi></munderover><msup id="S3.E7.m1.53.53.1.53.29.27.27.1.1"><mrow id="S3.E7.m1.53.53.1.53.29.27.27.1.1.1.1"><mo stretchy="false" id="S3.E7.m1.15.15.15.15.13.13">[</mo><mrow id="S3.E7.m1.53.53.1.53.29.27.27.1.1.1.1.1"><mrow id="S3.E7.m1.53.53.1.53.29.27.27.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E7.m1.16.16.16.16.14.14">(</mo><msubsup id="S3.E7.m1.53.53.1.53.29.27.27.1.1.1.1.1.1.1.1"><mi id="S3.E7.m1.17.17.17.17.15.15">Z</mi><mrow id="S3.E7.m1.18.18.18.18.16.16.1.4"><mi id="S3.E7.m1.18.18.18.18.16.16.1.1">y</mi><mo id="S3.E7.m1.18.18.18.18.16.16.1.4.1">,</mo><mi id="S3.E7.m1.18.18.18.18.16.16.1.2">m</mi></mrow><mi id="S3.E7.m1.19.19.19.19.17.17.1">Q</mi></msubsup><mo stretchy="false" id="S3.E7.m1.20.20.20.20.18.18">)</mo></mrow><mo id="S3.E7.m1.21.21.21.21.19.19">−</mo><mrow id="S3.E7.m1.53.53.1.53.29.27.27.1.1.1.1.1.2.1"><mo stretchy="false" id="S3.E7.m1.22.22.22.22.20.20">(</mo><msubsup id="S3.E7.m1.53.53.1.53.29.27.27.1.1.1.1.1.2.1.1"><mover accent="true" id="S3.E7.m1.23.23.23.23.21.21"><mi id="S3.E7.m1.23.23.23.23.21.21.2">Z</mi><mo id="S3.E7.m1.23.23.23.23.21.21.1">^</mo></mover><mrow id="S3.E7.m1.24.24.24.24.22.22.1.4"><mi id="S3.E7.m1.24.24.24.24.22.22.1.1">y</mi><mo id="S3.E7.m1.24.24.24.24.22.22.1.4.1">,</mo><mi id="S3.E7.m1.24.24.24.24.22.22.1.2">m</mi></mrow><mi id="S3.E7.m1.25.25.25.25.23.23.1">Q</mi></msubsup><mo stretchy="false" id="S3.E7.m1.26.26.26.26.24.24">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7.m1.27.27.27.27.25.25">]</mo></mrow><mn id="S3.E7.m1.28.28.28.28.26.26.1">2</mn></msup></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.53.53.1d"><mtd id="S3.E7.m1.53.53.1e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.53.53.1f"><mrow id="S3.E7.m1.52.52.52.24.24"><mo id="S3.E7.m1.29.29.29.1.1.1">+</mo><msub id="S3.E7.m1.52.52.52.24.24.25"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.30.30.30.2.2.2">𝒟</mi><mrow id="S3.E7.m1.31.31.31.3.3.3.1"><mi id="S3.E7.m1.31.31.31.3.3.3.1.2">K</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.31.31.31.3.3.3.1.1">​</mo><mi id="S3.E7.m1.31.31.31.3.3.3.1.3">L</mi></mrow></msub><mrow id="S3.E7.m1.52.52.52.24.24.26"><mo stretchy="false" id="S3.E7.m1.32.32.32.4.4.4">(</mo><mi id="S3.E7.m1.33.33.33.5.5.5">sim</mi><mrow id="S3.E7.m1.52.52.52.24.24.26.1"><mo stretchy="false" id="S3.E7.m1.34.34.34.6.6.6">(</mo><mi id="S3.E7.m1.35.35.35.7.7.7">I</mi><mo id="S3.E7.m1.36.36.36.8.8.8">,</mo><msubsup id="S3.E7.m1.52.52.52.24.24.26.1.1"><mi id="S3.E7.m1.37.37.37.9.9.9">Z</mi><mrow id="S3.E7.m1.38.38.38.10.10.10.1.4"><mi id="S3.E7.m1.38.38.38.10.10.10.1.1">y</mi><mo id="S3.E7.m1.38.38.38.10.10.10.1.4.1">,</mo><mi id="S3.E7.m1.38.38.38.10.10.10.1.2">m</mi></mrow><mi id="S3.E7.m1.39.39.39.11.11.11.1">Q</mi></msubsup><mo stretchy="false" id="S3.E7.m1.40.40.40.12.12.12">)</mo></mrow><mo id="S3.E7.m1.41.41.41.13.13.13">,</mo><mi id="S3.E7.m1.42.42.42.14.14.14">sim</mi><mrow id="S3.E7.m1.52.52.52.24.24.26.2"><mo stretchy="false" id="S3.E7.m1.43.43.43.15.15.15">(</mo><mi id="S3.E7.m1.44.44.44.16.16.16">I</mi><mo id="S3.E7.m1.45.45.45.17.17.17">,</mo><msubsup id="S3.E7.m1.52.52.52.24.24.26.2.1"><mover accent="true" id="S3.E7.m1.46.46.46.18.18.18"><mi id="S3.E7.m1.46.46.46.18.18.18.2">Z</mi><mo id="S3.E7.m1.46.46.46.18.18.18.1">^</mo></mover><mrow id="S3.E7.m1.47.47.47.19.19.19.1.4"><mi id="S3.E7.m1.47.47.47.19.19.19.1.1">y</mi><mo id="S3.E7.m1.47.47.47.19.19.19.1.4.1">,</mo><mi id="S3.E7.m1.47.47.47.19.19.19.1.2">m</mi></mrow><mi id="S3.E7.m1.48.48.48.20.20.20.1">Q</mi></msubsup><mo stretchy="false" id="S3.E7.m1.49.49.49.21.21.21">)</mo></mrow><mo stretchy="false" id="S3.E7.m1.50.50.50.22.22.22">)</mo></mrow><mo stretchy="false" id="S3.E7.m1.51.51.51.23.23.23">]</mo><mo id="S3.E7.m1.52.52.52.24.24.24">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E7.m1.53b">\begin{split}\mathcal{L}_{Q}&amp;=\mathcal{L}_{mse}+\mathcal{L}_{KL}=\mathbb{E}_{x,y}\sum_{m=1}^{M}[(Z_{y,m}^{Q})-(\hat{Z}_{y,m}^{Q})]^{2}\\
&amp;+\mathcal{D}_{KL}({\rm sim}(I,Z_{y,m}^{Q}),{\rm sim}(I,\hat{Z}_{y,m}^{Q}))],\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.8" class="ltx_p"><span id="S3.SS3.p2.2.2" class="ltx_text" style="color:#000000;">where <math id="S3.SS3.p2.1.1.m1.3" class="ltx_Math" alttext="Z^{Q}_{y,m}=g(\left\{V^{Q},c_{y},s_{m}\right\})" display="inline"><semantics id="S3.SS3.p2.1.1.m1.3a"><mrow id="S3.SS3.p2.1.1.m1.3.3" xref="S3.SS3.p2.1.1.m1.3.3.cmml"><msubsup id="S3.SS3.p2.1.1.m1.3.3.3" xref="S3.SS3.p2.1.1.m1.3.3.3.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.3.2.2" xref="S3.SS3.p2.1.1.m1.3.3.3.2.2.cmml">Z</mi><mrow id="S3.SS3.p2.1.1.m1.2.2.2.4" xref="S3.SS3.p2.1.1.m1.2.2.2.3.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.1.1.1.1" xref="S3.SS3.p2.1.1.m1.1.1.1.1.cmml">y</mi><mo mathcolor="#000000" id="S3.SS3.p2.1.1.m1.2.2.2.4.1" xref="S3.SS3.p2.1.1.m1.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.2.2.2.2" xref="S3.SS3.p2.1.1.m1.2.2.2.2.cmml">m</mi></mrow><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.3.2.3" xref="S3.SS3.p2.1.1.m1.3.3.3.2.3.cmml">Q</mi></msubsup><mo mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.2" xref="S3.SS3.p2.1.1.m1.3.3.2.cmml">=</mo><mrow id="S3.SS3.p2.1.1.m1.3.3.1" xref="S3.SS3.p2.1.1.m1.3.3.1.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.3" xref="S3.SS3.p2.1.1.m1.3.3.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.1.m1.3.3.1.2" xref="S3.SS3.p2.1.1.m1.3.3.1.2.cmml">​</mo><mrow id="S3.SS3.p2.1.1.m1.3.3.1.1.1" xref="S3.SS3.p2.1.1.m1.3.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.2" xref="S3.SS3.p2.1.1.m1.3.3.1.cmml">(</mo><mrow id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.4.cmml"><mo mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.4" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.4.cmml">{</mo><msup id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">V</mi><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml">Q</mi></msup><mo mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.5" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.4.cmml">,</mo><msub id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.2" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.2.cmml">c</mi><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.3" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.3.cmml">y</mi></msub><mo mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.6" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.4.cmml">,</mo><msub id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.2" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.2.cmml">s</mi><mi mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.3" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.3.cmml">m</mi></msub><mo mathcolor="#000000" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.7" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.4.cmml">}</mo></mrow><mo mathcolor="#000000" stretchy="false" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.3" xref="S3.SS3.p2.1.1.m1.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.1.m1.3b"><apply id="S3.SS3.p2.1.1.m1.3.3.cmml" xref="S3.SS3.p2.1.1.m1.3.3"><eq id="S3.SS3.p2.1.1.m1.3.3.2.cmml" xref="S3.SS3.p2.1.1.m1.3.3.2"></eq><apply id="S3.SS3.p2.1.1.m1.3.3.3.cmml" xref="S3.SS3.p2.1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.1.m1.3.3.3.1.cmml" xref="S3.SS3.p2.1.1.m1.3.3.3">subscript</csymbol><apply id="S3.SS3.p2.1.1.m1.3.3.3.2.cmml" xref="S3.SS3.p2.1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.1.m1.3.3.3.2.1.cmml" xref="S3.SS3.p2.1.1.m1.3.3.3">superscript</csymbol><ci id="S3.SS3.p2.1.1.m1.3.3.3.2.2.cmml" xref="S3.SS3.p2.1.1.m1.3.3.3.2.2">𝑍</ci><ci id="S3.SS3.p2.1.1.m1.3.3.3.2.3.cmml" xref="S3.SS3.p2.1.1.m1.3.3.3.2.3">𝑄</ci></apply><list id="S3.SS3.p2.1.1.m1.2.2.2.3.cmml" xref="S3.SS3.p2.1.1.m1.2.2.2.4"><ci id="S3.SS3.p2.1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p2.1.1.m1.1.1.1.1">𝑦</ci><ci id="S3.SS3.p2.1.1.m1.2.2.2.2.cmml" xref="S3.SS3.p2.1.1.m1.2.2.2.2">𝑚</ci></list></apply><apply id="S3.SS3.p2.1.1.m1.3.3.1.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1"><times id="S3.SS3.p2.1.1.m1.3.3.1.2.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.2"></times><ci id="S3.SS3.p2.1.1.m1.3.3.1.3.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.3">𝑔</ci><set id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.4.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3"><apply id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.2">𝑉</ci><ci id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.2">𝑐</ci><ci id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.2.2.3">𝑦</ci></apply><apply id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.2">𝑠</ci><ci id="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S3.SS3.p2.1.1.m1.3.3.1.1.1.1.3.3.3">𝑚</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.1.m1.3c">Z^{Q}_{y,m}=g(\left\{V^{Q},c_{y},s_{m}\right\})</annotation></semantics></math> and <math id="S3.SS3.p2.2.2.m2.3" class="ltx_Math" alttext="\hat{Z}^{Q}_{y,m}=g(\left\{\hat{V}^{Q},c_{y},s_{m}\right\})" display="inline"><semantics id="S3.SS3.p2.2.2.m2.3a"><mrow id="S3.SS3.p2.2.2.m2.3.3" xref="S3.SS3.p2.2.2.m2.3.3.cmml"><msubsup id="S3.SS3.p2.2.2.m2.3.3.3" xref="S3.SS3.p2.2.2.m2.3.3.3.cmml"><mover accent="true" id="S3.SS3.p2.2.2.m2.3.3.3.2.2" xref="S3.SS3.p2.2.2.m2.3.3.3.2.2.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.3.2.2.2" xref="S3.SS3.p2.2.2.m2.3.3.3.2.2.2.cmml">Z</mi><mo mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.3.2.2.1" xref="S3.SS3.p2.2.2.m2.3.3.3.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p2.2.2.m2.2.2.2.4" xref="S3.SS3.p2.2.2.m2.2.2.2.3.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.1.1.1.1" xref="S3.SS3.p2.2.2.m2.1.1.1.1.cmml">y</mi><mo mathcolor="#000000" id="S3.SS3.p2.2.2.m2.2.2.2.4.1" xref="S3.SS3.p2.2.2.m2.2.2.2.3.cmml">,</mo><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.2.2.2.2" xref="S3.SS3.p2.2.2.m2.2.2.2.2.cmml">m</mi></mrow><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.3.2.3" xref="S3.SS3.p2.2.2.m2.3.3.3.2.3.cmml">Q</mi></msubsup><mo mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.2" xref="S3.SS3.p2.2.2.m2.3.3.2.cmml">=</mo><mrow id="S3.SS3.p2.2.2.m2.3.3.1" xref="S3.SS3.p2.2.2.m2.3.3.1.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.3" xref="S3.SS3.p2.2.2.m2.3.3.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.2.m2.3.3.1.2" xref="S3.SS3.p2.2.2.m2.3.3.1.2.cmml">​</mo><mrow id="S3.SS3.p2.2.2.m2.3.3.1.1.1" xref="S3.SS3.p2.2.2.m2.3.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.2" xref="S3.SS3.p2.2.2.m2.3.3.1.cmml">(</mo><mrow id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.4.cmml"><mo mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.4" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.4.cmml">{</mo><msup id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.2.cmml">V</mi><mo mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.1" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.3" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.3.cmml">Q</mi></msup><mo mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.5" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.4.cmml">,</mo><msub id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.2" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.2.cmml">c</mi><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.3" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.3.cmml">y</mi></msub><mo mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.6" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.4.cmml">,</mo><msub id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.cmml"><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.2" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.2.cmml">s</mi><mi mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.3" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.3.cmml">m</mi></msub><mo mathcolor="#000000" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.7" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.4.cmml">}</mo></mrow><mo mathcolor="#000000" stretchy="false" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.3" xref="S3.SS3.p2.2.2.m2.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.2.m2.3b"><apply id="S3.SS3.p2.2.2.m2.3.3.cmml" xref="S3.SS3.p2.2.2.m2.3.3"><eq id="S3.SS3.p2.2.2.m2.3.3.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.2"></eq><apply id="S3.SS3.p2.2.2.m2.3.3.3.cmml" xref="S3.SS3.p2.2.2.m2.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.2.m2.3.3.3.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.3">subscript</csymbol><apply id="S3.SS3.p2.2.2.m2.3.3.3.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.2.m2.3.3.3.2.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.3">superscript</csymbol><apply id="S3.SS3.p2.2.2.m2.3.3.3.2.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.3.2.2"><ci id="S3.SS3.p2.2.2.m2.3.3.3.2.2.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.3.2.2.1">^</ci><ci id="S3.SS3.p2.2.2.m2.3.3.3.2.2.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.3.2.2.2">𝑍</ci></apply><ci id="S3.SS3.p2.2.2.m2.3.3.3.2.3.cmml" xref="S3.SS3.p2.2.2.m2.3.3.3.2.3">𝑄</ci></apply><list id="S3.SS3.p2.2.2.m2.2.2.2.3.cmml" xref="S3.SS3.p2.2.2.m2.2.2.2.4"><ci id="S3.SS3.p2.2.2.m2.1.1.1.1.cmml" xref="S3.SS3.p2.2.2.m2.1.1.1.1">𝑦</ci><ci id="S3.SS3.p2.2.2.m2.2.2.2.2.cmml" xref="S3.SS3.p2.2.2.m2.2.2.2.2">𝑚</ci></list></apply><apply id="S3.SS3.p2.2.2.m2.3.3.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1"><times id="S3.SS3.p2.2.2.m2.3.3.1.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.2"></times><ci id="S3.SS3.p2.2.2.m2.3.3.1.3.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.3">𝑔</ci><set id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.4.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3"><apply id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2"><ci id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.2.2">𝑉</ci></apply><ci id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.2">𝑐</ci><ci id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.2.2.3">𝑦</ci></apply><apply id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.2">𝑠</ci><ci id="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.3.cmml" xref="S3.SS3.p2.2.2.m2.3.3.1.1.1.1.3.3.3">𝑚</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.2.m2.3c">\hat{Z}^{Q}_{y,m}=g(\left\{\hat{V}^{Q},c_{y},s_{m}\right\})</annotation></semantics></math></span>. <math id="S3.SS3.p2.3.m1.1" class="ltx_Math" alttext="\hat{V}^{Q}" display="inline"><semantics id="S3.SS3.p2.3.m1.1a"><msup id="S3.SS3.p2.3.m1.1.1" xref="S3.SS3.p2.3.m1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.3.m1.1.1.2" xref="S3.SS3.p2.3.m1.1.1.2.cmml"><mi id="S3.SS3.p2.3.m1.1.1.2.2" xref="S3.SS3.p2.3.m1.1.1.2.2.cmml">V</mi><mo id="S3.SS3.p2.3.m1.1.1.2.1" xref="S3.SS3.p2.3.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.3.m1.1.1.3" xref="S3.SS3.p2.3.m1.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m1.1b"><apply id="S3.SS3.p2.3.m1.1.1.cmml" xref="S3.SS3.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m1.1.1.1.cmml" xref="S3.SS3.p2.3.m1.1.1">superscript</csymbol><apply id="S3.SS3.p2.3.m1.1.1.2.cmml" xref="S3.SS3.p2.3.m1.1.1.2"><ci id="S3.SS3.p2.3.m1.1.1.2.1.cmml" xref="S3.SS3.p2.3.m1.1.1.2.1">^</ci><ci id="S3.SS3.p2.3.m1.1.1.2.2.cmml" xref="S3.SS3.p2.3.m1.1.1.2.2">𝑉</ci></apply><ci id="S3.SS3.p2.3.m1.1.1.3.cmml" xref="S3.SS3.p2.3.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m1.1c">\hat{V}^{Q}</annotation></semantics></math> is the beta momentum average for Q-Prompt <math id="S3.SS3.p2.4.m2.1" class="ltx_Math" alttext="V^{Q}" display="inline"><semantics id="S3.SS3.p2.4.m2.1a"><msup id="S3.SS3.p2.4.m2.1.1" xref="S3.SS3.p2.4.m2.1.1.cmml"><mi id="S3.SS3.p2.4.m2.1.1.2" xref="S3.SS3.p2.4.m2.1.1.2.cmml">V</mi><mi id="S3.SS3.p2.4.m2.1.1.3" xref="S3.SS3.p2.4.m2.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m2.1b"><apply id="S3.SS3.p2.4.m2.1.1.cmml" xref="S3.SS3.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m2.1.1.1.cmml" xref="S3.SS3.p2.4.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.4.m2.1.1.2.cmml" xref="S3.SS3.p2.4.m2.1.1.2">𝑉</ci><ci id="S3.SS3.p2.4.m2.1.1.3.cmml" xref="S3.SS3.p2.4.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m2.1c">V^{Q}</annotation></semantics></math>. Given input data <math id="S3.SS3.p2.5.m3.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S3.SS3.p2.5.m3.2a"><mrow id="S3.SS3.p2.5.m3.2.3.2" xref="S3.SS3.p2.5.m3.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.5.m3.2.3.2.1" xref="S3.SS3.p2.5.m3.2.3.1.cmml">(</mo><mi id="S3.SS3.p2.5.m3.1.1" xref="S3.SS3.p2.5.m3.1.1.cmml">x</mi><mo id="S3.SS3.p2.5.m3.2.3.2.2" xref="S3.SS3.p2.5.m3.2.3.1.cmml">,</mo><mi id="S3.SS3.p2.5.m3.2.2" xref="S3.SS3.p2.5.m3.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS3.p2.5.m3.2.3.2.3" xref="S3.SS3.p2.5.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m3.2b"><interval closure="open" id="S3.SS3.p2.5.m3.2.3.1.cmml" xref="S3.SS3.p2.5.m3.2.3.2"><ci id="S3.SS3.p2.5.m3.1.1.cmml" xref="S3.SS3.p2.5.m3.1.1">𝑥</ci><ci id="S3.SS3.p2.5.m3.2.2.cmml" xref="S3.SS3.p2.5.m3.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m3.2c">(x,y)</annotation></semantics></math>, the overall optimization for disentangled prompt tuning is <math id="S3.SS3.p2.6.m4.6" class="ltx_Math" alttext="\mathcal{L}(x,y)=\mathcal{L}_{G}(x,y)+\lambda\mathcal{L}^{m}_{D}(x,y)" display="inline"><semantics id="S3.SS3.p2.6.m4.6a"><mrow id="S3.SS3.p2.6.m4.6.7" xref="S3.SS3.p2.6.m4.6.7.cmml"><mrow id="S3.SS3.p2.6.m4.6.7.2" xref="S3.SS3.p2.6.m4.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.6.m4.6.7.2.2" xref="S3.SS3.p2.6.m4.6.7.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m4.6.7.2.1" xref="S3.SS3.p2.6.m4.6.7.2.1.cmml">​</mo><mrow id="S3.SS3.p2.6.m4.6.7.2.3.2" xref="S3.SS3.p2.6.m4.6.7.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m4.6.7.2.3.2.1" xref="S3.SS3.p2.6.m4.6.7.2.3.1.cmml">(</mo><mi id="S3.SS3.p2.6.m4.1.1" xref="S3.SS3.p2.6.m4.1.1.cmml">x</mi><mo id="S3.SS3.p2.6.m4.6.7.2.3.2.2" xref="S3.SS3.p2.6.m4.6.7.2.3.1.cmml">,</mo><mi id="S3.SS3.p2.6.m4.2.2" xref="S3.SS3.p2.6.m4.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS3.p2.6.m4.6.7.2.3.2.3" xref="S3.SS3.p2.6.m4.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.6.m4.6.7.1" xref="S3.SS3.p2.6.m4.6.7.1.cmml">=</mo><mrow id="S3.SS3.p2.6.m4.6.7.3" xref="S3.SS3.p2.6.m4.6.7.3.cmml"><mrow id="S3.SS3.p2.6.m4.6.7.3.2" xref="S3.SS3.p2.6.m4.6.7.3.2.cmml"><msub id="S3.SS3.p2.6.m4.6.7.3.2.2" xref="S3.SS3.p2.6.m4.6.7.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.6.m4.6.7.3.2.2.2" xref="S3.SS3.p2.6.m4.6.7.3.2.2.2.cmml">ℒ</mi><mi id="S3.SS3.p2.6.m4.6.7.3.2.2.3" xref="S3.SS3.p2.6.m4.6.7.3.2.2.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m4.6.7.3.2.1" xref="S3.SS3.p2.6.m4.6.7.3.2.1.cmml">​</mo><mrow id="S3.SS3.p2.6.m4.6.7.3.2.3.2" xref="S3.SS3.p2.6.m4.6.7.3.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m4.6.7.3.2.3.2.1" xref="S3.SS3.p2.6.m4.6.7.3.2.3.1.cmml">(</mo><mi id="S3.SS3.p2.6.m4.3.3" xref="S3.SS3.p2.6.m4.3.3.cmml">x</mi><mo id="S3.SS3.p2.6.m4.6.7.3.2.3.2.2" xref="S3.SS3.p2.6.m4.6.7.3.2.3.1.cmml">,</mo><mi id="S3.SS3.p2.6.m4.4.4" xref="S3.SS3.p2.6.m4.4.4.cmml">y</mi><mo stretchy="false" id="S3.SS3.p2.6.m4.6.7.3.2.3.2.3" xref="S3.SS3.p2.6.m4.6.7.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.6.m4.6.7.3.1" xref="S3.SS3.p2.6.m4.6.7.3.1.cmml">+</mo><mrow id="S3.SS3.p2.6.m4.6.7.3.3" xref="S3.SS3.p2.6.m4.6.7.3.3.cmml"><mi id="S3.SS3.p2.6.m4.6.7.3.3.2" xref="S3.SS3.p2.6.m4.6.7.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m4.6.7.3.3.1" xref="S3.SS3.p2.6.m4.6.7.3.3.1.cmml">​</mo><msubsup id="S3.SS3.p2.6.m4.6.7.3.3.3" xref="S3.SS3.p2.6.m4.6.7.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.6.m4.6.7.3.3.3.2.2" xref="S3.SS3.p2.6.m4.6.7.3.3.3.2.2.cmml">ℒ</mi><mi id="S3.SS3.p2.6.m4.6.7.3.3.3.3" xref="S3.SS3.p2.6.m4.6.7.3.3.3.3.cmml">D</mi><mi id="S3.SS3.p2.6.m4.6.7.3.3.3.2.3" xref="S3.SS3.p2.6.m4.6.7.3.3.3.2.3.cmml">m</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m4.6.7.3.3.1a" xref="S3.SS3.p2.6.m4.6.7.3.3.1.cmml">​</mo><mrow id="S3.SS3.p2.6.m4.6.7.3.3.4.2" xref="S3.SS3.p2.6.m4.6.7.3.3.4.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m4.6.7.3.3.4.2.1" xref="S3.SS3.p2.6.m4.6.7.3.3.4.1.cmml">(</mo><mi id="S3.SS3.p2.6.m4.5.5" xref="S3.SS3.p2.6.m4.5.5.cmml">x</mi><mo id="S3.SS3.p2.6.m4.6.7.3.3.4.2.2" xref="S3.SS3.p2.6.m4.6.7.3.3.4.1.cmml">,</mo><mi id="S3.SS3.p2.6.m4.6.6" xref="S3.SS3.p2.6.m4.6.6.cmml">y</mi><mo stretchy="false" id="S3.SS3.p2.6.m4.6.7.3.3.4.2.3" xref="S3.SS3.p2.6.m4.6.7.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m4.6b"><apply id="S3.SS3.p2.6.m4.6.7.cmml" xref="S3.SS3.p2.6.m4.6.7"><eq id="S3.SS3.p2.6.m4.6.7.1.cmml" xref="S3.SS3.p2.6.m4.6.7.1"></eq><apply id="S3.SS3.p2.6.m4.6.7.2.cmml" xref="S3.SS3.p2.6.m4.6.7.2"><times id="S3.SS3.p2.6.m4.6.7.2.1.cmml" xref="S3.SS3.p2.6.m4.6.7.2.1"></times><ci id="S3.SS3.p2.6.m4.6.7.2.2.cmml" xref="S3.SS3.p2.6.m4.6.7.2.2">ℒ</ci><interval closure="open" id="S3.SS3.p2.6.m4.6.7.2.3.1.cmml" xref="S3.SS3.p2.6.m4.6.7.2.3.2"><ci id="S3.SS3.p2.6.m4.1.1.cmml" xref="S3.SS3.p2.6.m4.1.1">𝑥</ci><ci id="S3.SS3.p2.6.m4.2.2.cmml" xref="S3.SS3.p2.6.m4.2.2">𝑦</ci></interval></apply><apply id="S3.SS3.p2.6.m4.6.7.3.cmml" xref="S3.SS3.p2.6.m4.6.7.3"><plus id="S3.SS3.p2.6.m4.6.7.3.1.cmml" xref="S3.SS3.p2.6.m4.6.7.3.1"></plus><apply id="S3.SS3.p2.6.m4.6.7.3.2.cmml" xref="S3.SS3.p2.6.m4.6.7.3.2"><times id="S3.SS3.p2.6.m4.6.7.3.2.1.cmml" xref="S3.SS3.p2.6.m4.6.7.3.2.1"></times><apply id="S3.SS3.p2.6.m4.6.7.3.2.2.cmml" xref="S3.SS3.p2.6.m4.6.7.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m4.6.7.3.2.2.1.cmml" xref="S3.SS3.p2.6.m4.6.7.3.2.2">subscript</csymbol><ci id="S3.SS3.p2.6.m4.6.7.3.2.2.2.cmml" xref="S3.SS3.p2.6.m4.6.7.3.2.2.2">ℒ</ci><ci id="S3.SS3.p2.6.m4.6.7.3.2.2.3.cmml" xref="S3.SS3.p2.6.m4.6.7.3.2.2.3">𝐺</ci></apply><interval closure="open" id="S3.SS3.p2.6.m4.6.7.3.2.3.1.cmml" xref="S3.SS3.p2.6.m4.6.7.3.2.3.2"><ci id="S3.SS3.p2.6.m4.3.3.cmml" xref="S3.SS3.p2.6.m4.3.3">𝑥</ci><ci id="S3.SS3.p2.6.m4.4.4.cmml" xref="S3.SS3.p2.6.m4.4.4">𝑦</ci></interval></apply><apply id="S3.SS3.p2.6.m4.6.7.3.3.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3"><times id="S3.SS3.p2.6.m4.6.7.3.3.1.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.1"></times><ci id="S3.SS3.p2.6.m4.6.7.3.3.2.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.2">𝜆</ci><apply id="S3.SS3.p2.6.m4.6.7.3.3.3.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m4.6.7.3.3.3.1.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.3">subscript</csymbol><apply id="S3.SS3.p2.6.m4.6.7.3.3.3.2.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m4.6.7.3.3.3.2.1.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.3">superscript</csymbol><ci id="S3.SS3.p2.6.m4.6.7.3.3.3.2.2.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.3.2.2">ℒ</ci><ci id="S3.SS3.p2.6.m4.6.7.3.3.3.2.3.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.3.2.3">𝑚</ci></apply><ci id="S3.SS3.p2.6.m4.6.7.3.3.3.3.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.3.3">𝐷</ci></apply><interval closure="open" id="S3.SS3.p2.6.m4.6.7.3.3.4.1.cmml" xref="S3.SS3.p2.6.m4.6.7.3.3.4.2"><ci id="S3.SS3.p2.6.m4.5.5.cmml" xref="S3.SS3.p2.6.m4.5.5">𝑥</ci><ci id="S3.SS3.p2.6.m4.6.6.cmml" xref="S3.SS3.p2.6.m4.6.6">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m4.6c">\mathcal{L}(x,y)=\mathcal{L}_{G}(x,y)+\lambda\mathcal{L}^{m}_{D}(x,y)</annotation></semantics></math>, where <math id="S3.SS3.p2.7.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p2.7.m5.1a"><mi id="S3.SS3.p2.7.m5.1.1" xref="S3.SS3.p2.7.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m5.1b"><ci id="S3.SS3.p2.7.m5.1.1.cmml" xref="S3.SS3.p2.7.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m5.1c">\lambda</annotation></semantics></math> is a weighted coefficient to balance G-Prompt and D-Prompts, and <math id="S3.SS3.p2.8.m6.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS3.p2.8.m6.1a"><mi id="S3.SS3.p2.8.m6.1.1" xref="S3.SS3.p2.8.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m6.1b"><ci id="S3.SS3.p2.8.m6.1.1.cmml" xref="S3.SS3.p2.8.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m6.1c">m</annotation></semantics></math> is the predicted domain via Q-Prompt.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Collaborative Ensemble Process</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.3" class="ltx_p">During training, we can learn general and specific knowledge from different source domains via G-Prompt and D-Prompts. In inference time, it is essential to extend this valuable knowledge into the target domain. One straightforward way is to average the information from all optimized prompts. However, this method ignores the relationship (feature distance) differences between target samples and different source domains. To this end, we build a dynamic ensemble metric in our DiPrompT, which considers the above vary while effectively exploiting valuable knowledge in global prompt and various domain prompts for better target inference. Concretely, we construct ensembled text features <math id="S3.SS4.p1.1.m1.3" class="ltx_Math" alttext="Z=\left\{Z_{1},...,Z_{C}\right\}" display="inline"><semantics id="S3.SS4.p1.1.m1.3a"><mrow id="S3.SS4.p1.1.m1.3.3" xref="S3.SS4.p1.1.m1.3.3.cmml"><mi id="S3.SS4.p1.1.m1.3.3.4" xref="S3.SS4.p1.1.m1.3.3.4.cmml">Z</mi><mo id="S3.SS4.p1.1.m1.3.3.3" xref="S3.SS4.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS4.p1.1.m1.3.3.2.2" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml"><mo id="S3.SS4.p1.1.m1.3.3.2.2.3" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS4.p1.1.m1.2.2.1.1.1" xref="S3.SS4.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.2.2.1.1.1.2" xref="S3.SS4.p1.1.m1.2.2.1.1.1.2.cmml">Z</mi><mn id="S3.SS4.p1.1.m1.2.2.1.1.1.3" xref="S3.SS4.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p1.1.m1.3.3.2.2.4" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS4.p1.1.m1.3.3.2.2.5" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS4.p1.1.m1.3.3.2.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS4.p1.1.m1.3.3.2.2.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.2.2.cmml">Z</mi><mi id="S3.SS4.p1.1.m1.3.3.2.2.2.3" xref="S3.SS4.p1.1.m1.3.3.2.2.2.3.cmml">C</mi></msub><mo id="S3.SS4.p1.1.m1.3.3.2.2.6" xref="S3.SS4.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.3b"><apply id="S3.SS4.p1.1.m1.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3"><eq id="S3.SS4.p1.1.m1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.3"></eq><ci id="S3.SS4.p1.1.m1.3.3.4.cmml" xref="S3.SS4.p1.1.m1.3.3.4">𝑍</ci><set id="S3.SS4.p1.1.m1.3.3.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2"><apply id="S3.SS4.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.2">𝑍</ci><cn type="integer" id="S3.SS4.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">…</ci><apply id="S3.SS4.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2.2">𝑍</ci><ci id="S3.SS4.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2.3">𝐶</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.3c">Z=\left\{Z_{1},...,Z_{C}\right\}</annotation></semantics></math> for each target domain sample, which is a dynamic weighted combination of knowledge from different prompts. The ensembled text embeddings <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="Z_{j}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">Z</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑍</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">Z_{j}</annotation></semantics></math> for <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">j</annotation></semantics></math>-th class is defined as:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="Z_{j}=\sum_{m=1}^{M}w_{m}Z^{m}_{j}+w_{g}Z^{G}_{j}," display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml">Z</mi><mi id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.2.3.cmml">j</mi></msub><mo rspace="0.111em" id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><munderover id="S3.E8.m1.1.1.1.1.3.2.1" xref="S3.E8.m1.1.1.1.1.3.2.1.cmml"><mo movablelimits="false" id="S3.E8.m1.1.1.1.1.3.2.1.2.2" xref="S3.E8.m1.1.1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.1.1.1.1.3.2.1.2.3" xref="S3.E8.m1.1.1.1.1.3.2.1.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.1.2.3.2" xref="S3.E8.m1.1.1.1.1.3.2.1.2.3.2.cmml">m</mi><mo id="S3.E8.m1.1.1.1.1.3.2.1.2.3.1" xref="S3.E8.m1.1.1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.1.1.1.1.3.2.1.2.3.3" xref="S3.E8.m1.1.1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.1.1.1.1.3.2.1.3" xref="S3.E8.m1.1.1.1.1.3.2.1.3.cmml">M</mi></munderover><mrow id="S3.E8.m1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.cmml"><msub id="S3.E8.m1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.2.2.cmml">w</mi><mi id="S3.E8.m1.1.1.1.1.3.2.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.2.2.1" xref="S3.E8.m1.1.1.1.1.3.2.2.1.cmml">​</mo><msubsup id="S3.E8.m1.1.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.3.2.2.cmml">Z</mi><mi id="S3.E8.m1.1.1.1.1.3.2.2.3.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3.3.cmml">j</mi><mi id="S3.E8.m1.1.1.1.1.3.2.2.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3.2.3.cmml">m</mi></msubsup></mrow></mrow><mo id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml"><msub id="S3.E8.m1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.2.2" xref="S3.E8.m1.1.1.1.1.3.3.2.2.cmml">w</mi><mi id="S3.E8.m1.1.1.1.1.3.3.2.3" xref="S3.E8.m1.1.1.1.1.3.3.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.3.3.1" xref="S3.E8.m1.1.1.1.1.3.3.1.cmml">​</mo><msubsup id="S3.E8.m1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.3.2.2" xref="S3.E8.m1.1.1.1.1.3.3.3.2.2.cmml">Z</mi><mi id="S3.E8.m1.1.1.1.1.3.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.3.cmml">j</mi><mi id="S3.E8.m1.1.1.1.1.3.3.3.2.3" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3.cmml">G</mi></msubsup></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2">𝑍</ci><ci id="S3.E8.m1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><plus id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><apply id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.2.1.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1">subscript</csymbol><sum id="S3.E8.m1.1.1.1.1.3.2.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1.2.2"></sum><apply id="S3.E8.m1.1.1.1.1.3.2.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1.2.3"><eq id="S3.E8.m1.1.1.1.1.3.2.1.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1.2.3.1"></eq><ci id="S3.E8.m1.1.1.1.1.3.2.1.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1.2.3.2">𝑚</ci><cn type="integer" id="S3.E8.m1.1.1.1.1.3.2.1.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.1.1.1.1.3.2.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1.3">𝑀</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2"><times id="S3.E8.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.1"></times><apply id="S3.E8.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2.2">𝑤</ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2.3">𝑚</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.2.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3.2.2">𝑍</ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3.2.3">𝑚</ci></apply><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><times id="S3.E8.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.1"></times><apply id="S3.E8.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.2">𝑤</ci><ci id="S3.E8.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3">𝑔</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.2">𝑍</ci><ci id="S3.E8.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.2.3">𝐺</ci></apply><ci id="S3.E8.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">Z_{j}=\sum_{m=1}^{M}w_{m}Z^{m}_{j}+w_{g}Z^{G}_{j},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.6" class="ltx_p">where we set <math id="S3.SS4.p1.4.m1.1" class="ltx_Math" alttext="w_{g}=1" display="inline"><semantics id="S3.SS4.p1.4.m1.1a"><mrow id="S3.SS4.p1.4.m1.1.1" xref="S3.SS4.p1.4.m1.1.1.cmml"><msub id="S3.SS4.p1.4.m1.1.1.2" xref="S3.SS4.p1.4.m1.1.1.2.cmml"><mi id="S3.SS4.p1.4.m1.1.1.2.2" xref="S3.SS4.p1.4.m1.1.1.2.2.cmml">w</mi><mi id="S3.SS4.p1.4.m1.1.1.2.3" xref="S3.SS4.p1.4.m1.1.1.2.3.cmml">g</mi></msub><mo id="S3.SS4.p1.4.m1.1.1.1" xref="S3.SS4.p1.4.m1.1.1.1.cmml">=</mo><mn id="S3.SS4.p1.4.m1.1.1.3" xref="S3.SS4.p1.4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m1.1b"><apply id="S3.SS4.p1.4.m1.1.1.cmml" xref="S3.SS4.p1.4.m1.1.1"><eq id="S3.SS4.p1.4.m1.1.1.1.cmml" xref="S3.SS4.p1.4.m1.1.1.1"></eq><apply id="S3.SS4.p1.4.m1.1.1.2.cmml" xref="S3.SS4.p1.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m1.1.1.2.1.cmml" xref="S3.SS4.p1.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.4.m1.1.1.2.2.cmml" xref="S3.SS4.p1.4.m1.1.1.2.2">𝑤</ci><ci id="S3.SS4.p1.4.m1.1.1.2.3.cmml" xref="S3.SS4.p1.4.m1.1.1.2.3">𝑔</ci></apply><cn type="integer" id="S3.SS4.p1.4.m1.1.1.3.cmml" xref="S3.SS4.p1.4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m1.1c">w_{g}=1</annotation></semantics></math>. <math id="S3.SS4.p1.5.m2.1" class="ltx_Math" alttext="w_{m}=\frac{\max_{j}{\rm sim}(I\cdot Z^{m}_{j})}{\sum_{i=1}^{M}\max_{j}I\cdot Z^{i}_{j}}" display="inline"><semantics id="S3.SS4.p1.5.m2.1a"><mrow id="S3.SS4.p1.5.m2.1.2" xref="S3.SS4.p1.5.m2.1.2.cmml"><msub id="S3.SS4.p1.5.m2.1.2.2" xref="S3.SS4.p1.5.m2.1.2.2.cmml"><mi id="S3.SS4.p1.5.m2.1.2.2.2" xref="S3.SS4.p1.5.m2.1.2.2.2.cmml">w</mi><mi id="S3.SS4.p1.5.m2.1.2.2.3" xref="S3.SS4.p1.5.m2.1.2.2.3.cmml">m</mi></msub><mo id="S3.SS4.p1.5.m2.1.2.1" xref="S3.SS4.p1.5.m2.1.2.1.cmml">=</mo><mfrac id="S3.SS4.p1.5.m2.1.1" xref="S3.SS4.p1.5.m2.1.1.cmml"><mrow id="S3.SS4.p1.5.m2.1.1.1" xref="S3.SS4.p1.5.m2.1.1.1.cmml"><mrow id="S3.SS4.p1.5.m2.1.1.1.3" xref="S3.SS4.p1.5.m2.1.1.1.3.cmml"><msub id="S3.SS4.p1.5.m2.1.1.1.3.1" xref="S3.SS4.p1.5.m2.1.1.1.3.1.cmml"><mi id="S3.SS4.p1.5.m2.1.1.1.3.1.2" xref="S3.SS4.p1.5.m2.1.1.1.3.1.2.cmml">max</mi><mi id="S3.SS4.p1.5.m2.1.1.1.3.1.3" xref="S3.SS4.p1.5.m2.1.1.1.3.1.3.cmml">j</mi></msub><mo lspace="0.167em" id="S3.SS4.p1.5.m2.1.1.1.3a" xref="S3.SS4.p1.5.m2.1.1.1.3.cmml">⁡</mo><mi id="S3.SS4.p1.5.m2.1.1.1.3.2" xref="S3.SS4.p1.5.m2.1.1.1.3.2.cmml">sim</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p1.5.m2.1.1.1.2" xref="S3.SS4.p1.5.m2.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p1.5.m2.1.1.1.1.1" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p1.5.m2.1.1.1.1.1.2" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.5.m2.1.1.1.1.1.1" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.5.m2.1.1.1.1.1.1.2" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.2.cmml">I</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.5.m2.1.1.1.1.1.1.1" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.1.cmml">⋅</mo><msubsup id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.2" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.2.cmml">Z</mi><mi id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.3" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.3.cmml">j</mi><mi id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.3" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.3.cmml">m</mi></msubsup></mrow><mo stretchy="false" id="S3.SS4.p1.5.m2.1.1.1.1.1.3" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.SS4.p1.5.m2.1.1.3" xref="S3.SS4.p1.5.m2.1.1.3.cmml"><mstyle displaystyle="false" id="S3.SS4.p1.5.m2.1.1.3.1" xref="S3.SS4.p1.5.m2.1.1.3.1.cmml"><msubsup id="S3.SS4.p1.5.m2.1.1.3.1a" xref="S3.SS4.p1.5.m2.1.1.3.1.cmml"><mo id="S3.SS4.p1.5.m2.1.1.3.1.2.2" xref="S3.SS4.p1.5.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS4.p1.5.m2.1.1.3.1.2.3" xref="S3.SS4.p1.5.m2.1.1.3.1.2.3.cmml"><mi id="S3.SS4.p1.5.m2.1.1.3.1.2.3.2" xref="S3.SS4.p1.5.m2.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.SS4.p1.5.m2.1.1.3.1.2.3.1" xref="S3.SS4.p1.5.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS4.p1.5.m2.1.1.3.1.2.3.3" xref="S3.SS4.p1.5.m2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS4.p1.5.m2.1.1.3.1.3" xref="S3.SS4.p1.5.m2.1.1.3.1.3.cmml">M</mi></msubsup></mstyle><mrow id="S3.SS4.p1.5.m2.1.1.3.2" xref="S3.SS4.p1.5.m2.1.1.3.2.cmml"><msub id="S3.SS4.p1.5.m2.1.1.3.2.1" xref="S3.SS4.p1.5.m2.1.1.3.2.1.cmml"><mi id="S3.SS4.p1.5.m2.1.1.3.2.1.2" xref="S3.SS4.p1.5.m2.1.1.3.2.1.2.cmml">max</mi><mi id="S3.SS4.p1.5.m2.1.1.3.2.1.3" xref="S3.SS4.p1.5.m2.1.1.3.2.1.3.cmml">j</mi></msub><mo lspace="0.167em" id="S3.SS4.p1.5.m2.1.1.3.2a" xref="S3.SS4.p1.5.m2.1.1.3.2.cmml">⁡</mo><mrow id="S3.SS4.p1.5.m2.1.1.3.2.2" xref="S3.SS4.p1.5.m2.1.1.3.2.2.cmml"><mi id="S3.SS4.p1.5.m2.1.1.3.2.2.2" xref="S3.SS4.p1.5.m2.1.1.3.2.2.2.cmml">I</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.5.m2.1.1.3.2.2.1" xref="S3.SS4.p1.5.m2.1.1.3.2.2.1.cmml">⋅</mo><msubsup id="S3.SS4.p1.5.m2.1.1.3.2.2.3" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3.cmml"><mi id="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.2" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.2.cmml">Z</mi><mi id="S3.SS4.p1.5.m2.1.1.3.2.2.3.3" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3.3.cmml">j</mi><mi id="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.3" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.3.cmml">i</mi></msubsup></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m2.1b"><apply id="S3.SS4.p1.5.m2.1.2.cmml" xref="S3.SS4.p1.5.m2.1.2"><eq id="S3.SS4.p1.5.m2.1.2.1.cmml" xref="S3.SS4.p1.5.m2.1.2.1"></eq><apply id="S3.SS4.p1.5.m2.1.2.2.cmml" xref="S3.SS4.p1.5.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.2.2.1.cmml" xref="S3.SS4.p1.5.m2.1.2.2">subscript</csymbol><ci id="S3.SS4.p1.5.m2.1.2.2.2.cmml" xref="S3.SS4.p1.5.m2.1.2.2.2">𝑤</ci><ci id="S3.SS4.p1.5.m2.1.2.2.3.cmml" xref="S3.SS4.p1.5.m2.1.2.2.3">𝑚</ci></apply><apply id="S3.SS4.p1.5.m2.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1"><divide id="S3.SS4.p1.5.m2.1.1.2.cmml" xref="S3.SS4.p1.5.m2.1.1"></divide><apply id="S3.SS4.p1.5.m2.1.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1.1"><times id="S3.SS4.p1.5.m2.1.1.1.2.cmml" xref="S3.SS4.p1.5.m2.1.1.1.2"></times><apply id="S3.SS4.p1.5.m2.1.1.1.3.cmml" xref="S3.SS4.p1.5.m2.1.1.1.3"><apply id="S3.SS4.p1.5.m2.1.1.1.3.1.cmml" xref="S3.SS4.p1.5.m2.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.1.3.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1.1.3.1">subscript</csymbol><max id="S3.SS4.p1.5.m2.1.1.1.3.1.2.cmml" xref="S3.SS4.p1.5.m2.1.1.1.3.1.2"></max><ci id="S3.SS4.p1.5.m2.1.1.1.3.1.3.cmml" xref="S3.SS4.p1.5.m2.1.1.1.3.1.3">𝑗</ci></apply><ci id="S3.SS4.p1.5.m2.1.1.1.3.2.cmml" xref="S3.SS4.p1.5.m2.1.1.1.3.2">sim</ci></apply><apply id="S3.SS4.p1.5.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1"><ci id="S3.SS4.p1.5.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.1">⋅</ci><ci id="S3.SS4.p1.5.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.2">𝐼</ci><apply id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.2">𝑍</ci><ci id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.2.3">𝑚</ci></apply><ci id="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p1.5.m2.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.SS4.p1.5.m2.1.1.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3"><apply id="S3.SS4.p1.5.m2.1.1.3.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.3.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1">superscript</csymbol><apply id="S3.SS4.p1.5.m2.1.1.3.1.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.3.1.2.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1">subscript</csymbol><sum id="S3.SS4.p1.5.m2.1.1.3.1.2.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1.2.2"></sum><apply id="S3.SS4.p1.5.m2.1.1.3.1.2.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1.2.3"><eq id="S3.SS4.p1.5.m2.1.1.3.1.2.3.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1.2.3.1"></eq><ci id="S3.SS4.p1.5.m2.1.1.3.1.2.3.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS4.p1.5.m2.1.1.3.1.2.3.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS4.p1.5.m2.1.1.3.1.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3.1.3">𝑀</ci></apply><apply id="S3.SS4.p1.5.m2.1.1.3.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2"><apply id="S3.SS4.p1.5.m2.1.1.3.2.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.3.2.1.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.1">subscript</csymbol><max id="S3.SS4.p1.5.m2.1.1.3.2.1.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.1.2"></max><ci id="S3.SS4.p1.5.m2.1.1.3.2.1.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.1.3">𝑗</ci></apply><apply id="S3.SS4.p1.5.m2.1.1.3.2.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2"><ci id="S3.SS4.p1.5.m2.1.1.3.2.2.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.1">⋅</ci><ci id="S3.SS4.p1.5.m2.1.1.3.2.2.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.2">𝐼</ci><apply id="S3.SS4.p1.5.m2.1.1.3.2.2.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.3.2.2.3.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3">subscript</csymbol><apply id="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.1.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3">superscript</csymbol><ci id="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.2.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.2">𝑍</ci><ci id="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3.2.3">𝑖</ci></apply><ci id="S3.SS4.p1.5.m2.1.1.3.2.2.3.3.cmml" xref="S3.SS4.p1.5.m2.1.1.3.2.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m2.1c">w_{m}=\frac{\max_{j}{\rm sim}(I\cdot Z^{m}_{j})}{\sum_{i=1}^{M}\max_{j}I\cdot Z^{i}_{j}}</annotation></semantics></math> represents the highest prediction for <math id="S3.SS4.p1.6.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS4.p1.6.m3.1a"><mi id="S3.SS4.p1.6.m3.1.1" xref="S3.SS4.p1.6.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m3.1b"><ci id="S3.SS4.p1.6.m3.1.1.cmml" xref="S3.SS4.p1.6.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m3.1c">m</annotation></semantics></math>-th domain aross all categories.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we conduct extensive experiments in three benchmark datasets with domain distribution shifts to demonstrate the effectiveness and robustness of our method. More details and additional experiments can be found in the supplementary material.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:472.0pt;height:205.8pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-33.6pt,14.6pt) scale(0.875445448472395,0.875445448472395) ;">
<table id="S4.T1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.2.1.1" class="ltx_tr">
<td id="S4.T1.2.1.1.1" class="ltx_td ltx_border_r ltx_border_t" colspan="2"></td>
<td id="S4.T1.2.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="5">PACS</td>
<td id="S4.T1.2.1.1.3" class="ltx_td ltx_align_center ltx_border_t" colspan="5">Officehome</td>
</tr>
<tr id="S4.T1.2.1.2" class="ltx_tr">
<td id="S4.T1.2.1.2.1" class="ltx_td ltx_align_center ltx_border_r" colspan="2">Methods</td>
<td id="S4.T1.2.1.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Art</td>
<td id="S4.T1.2.1.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Cartoon</td>
<td id="S4.T1.2.1.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Photo</td>
<td id="S4.T1.2.1.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Sketch</td>
<td id="S4.T1.2.1.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Avg</td>
<td id="S4.T1.2.1.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Art</td>
<td id="S4.T1.2.1.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Clipart</td>
<td id="S4.T1.2.1.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Product</td>
<td id="S4.T1.2.1.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Real</td>
<td id="S4.T1.2.1.2.11" class="ltx_td ltx_align_center ltx_border_t">Avg</td>
</tr>
<tr id="S4.T1.2.1.3" class="ltx_tr">
<td id="S4.T1.2.1.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="3"><span id="S4.T1.2.1.3.1.1" class="ltx_text">
<span id="S4.T1.2.1.3.1.1.1" class="ltx_inline-block">
<span id="S4.T1.2.1.3.1.1.1.1" class="ltx_p">Centralized</span>
<span id="S4.T1.2.1.3.1.1.1.2" class="ltx_p">Learning</span>
</span></span></td>
<td id="S4.T1.2.1.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">SWAD</td>
<td id="S4.T1.2.1.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">89.30</td>
<td id="S4.T1.2.1.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">83.40</td>
<td id="S4.T1.2.1.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">98.10</td>
<td id="S4.T1.2.1.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">82.60</td>
<td id="S4.T1.2.1.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">88.79</td>
<td id="S4.T1.2.1.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">66.10</td>
<td id="S4.T1.2.1.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">59.90</td>
<td id="S4.T1.2.1.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">78.70</td>
<td id="S4.T1.2.1.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">80.70</td>
<td id="S4.T1.2.1.3.12" class="ltx_td ltx_align_center ltx_border_tt">70.60</td>
</tr>
<tr id="S4.T1.2.1.4" class="ltx_tr">
<td id="S4.T1.2.1.4.1" class="ltx_td ltx_align_center ltx_border_r">I2ADR</td>
<td id="S4.T1.2.1.4.2" class="ltx_td ltx_align_center ltx_border_r">82.90</td>
<td id="S4.T1.2.1.4.3" class="ltx_td ltx_align_center ltx_border_r">80.80</td>
<td id="S4.T1.2.1.4.4" class="ltx_td ltx_align_center ltx_border_r">95.00</td>
<td id="S4.T1.2.1.4.5" class="ltx_td ltx_align_center ltx_border_r">83.50</td>
<td id="S4.T1.2.1.4.6" class="ltx_td ltx_align_center ltx_border_r">85.60</td>
<td id="S4.T1.2.1.4.7" class="ltx_td ltx_align_center ltx_border_r">70.30</td>
<td id="S4.T1.2.1.4.8" class="ltx_td ltx_align_center ltx_border_r">55.10</td>
<td id="S4.T1.2.1.4.9" class="ltx_td ltx_align_center ltx_border_r">80.70</td>
<td id="S4.T1.2.1.4.10" class="ltx_td ltx_align_center ltx_border_r">79.20</td>
<td id="S4.T1.2.1.4.11" class="ltx_td ltx_align_center">71.40</td>
</tr>
<tr id="S4.T1.2.1.5" class="ltx_tr">
<td id="S4.T1.2.1.5.1" class="ltx_td ltx_align_center ltx_border_r">PCL</td>
<td id="S4.T1.2.1.5.2" class="ltx_td ltx_align_center ltx_border_r">90.20</td>
<td id="S4.T1.2.1.5.3" class="ltx_td ltx_align_center ltx_border_r">83.90</td>
<td id="S4.T1.2.1.5.4" class="ltx_td ltx_align_center ltx_border_r">98.10</td>
<td id="S4.T1.2.1.5.5" class="ltx_td ltx_align_center ltx_border_r">82.60</td>
<td id="S4.T1.2.1.5.6" class="ltx_td ltx_align_center ltx_border_r">88.70</td>
<td id="S4.T1.2.1.5.7" class="ltx_td ltx_align_center ltx_border_r">67.30</td>
<td id="S4.T1.2.1.5.8" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.2.1.5.8.1" class="ltx_text ltx_font_bold">59.90</span></td>
<td id="S4.T1.2.1.5.9" class="ltx_td ltx_align_center ltx_border_r">78.70</td>
<td id="S4.T1.2.1.5.10" class="ltx_td ltx_align_center ltx_border_r">80.70</td>
<td id="S4.T1.2.1.5.11" class="ltx_td ltx_align_center">71.60</td>
</tr>
<tr id="S4.T1.2.1.6" class="ltx_tr">
<td id="S4.T1.2.1.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T1.2.1.6.1.1" class="ltx_text">FL</span></td>
<td id="S4.T1.2.1.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="S4.T1.2.1.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">80.41</td>
<td id="S4.T1.2.1.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">77.55</td>
<td id="S4.T1.2.1.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">92.33</td>
<td id="S4.T1.2.1.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63.31</td>
<td id="S4.T1.2.1.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.39</td>
<td id="S4.T1.2.1.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">61.84</td>
<td id="S4.T1.2.1.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.15</td>
<td id="S4.T1.2.1.6.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76.41</td>
<td id="S4.T1.2.1.6.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">77.39</td>
<td id="S4.T1.2.1.6.12" class="ltx_td ltx_align_center ltx_border_t">66.69</td>
</tr>
<tr id="S4.T1.2.1.7" class="ltx_tr">
<td id="S4.T1.2.1.7.1" class="ltx_td ltx_align_center ltx_border_r">FedProx</td>
<td id="S4.T1.2.1.7.2" class="ltx_td ltx_align_center ltx_border_r">79.19</td>
<td id="S4.T1.2.1.7.3" class="ltx_td ltx_align_center ltx_border_r">78.96</td>
<td id="S4.T1.2.1.7.4" class="ltx_td ltx_align_center ltx_border_r">94.92</td>
<td id="S4.T1.2.1.7.5" class="ltx_td ltx_align_center ltx_border_r">64.28</td>
<td id="S4.T1.2.1.7.6" class="ltx_td ltx_align_center ltx_border_r">79.33</td>
<td id="S4.T1.2.1.7.7" class="ltx_td ltx_align_center ltx_border_r">62.34</td>
<td id="S4.T1.2.1.7.8" class="ltx_td ltx_align_center ltx_border_r">52.00</td>
<td id="S4.T1.2.1.7.9" class="ltx_td ltx_align_center ltx_border_r">76.62</td>
<td id="S4.T1.2.1.7.10" class="ltx_td ltx_align_center ltx_border_r">78.56</td>
<td id="S4.T1.2.1.7.11" class="ltx_td ltx_align_center">67.37</td>
</tr>
<tr id="S4.T1.2.1.8" class="ltx_tr">
<td id="S4.T1.2.1.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T1.2.1.8.1.1" class="ltx_text">FL+DG</span></td>
<td id="S4.T1.2.1.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedADG</td>
<td id="S4.T1.2.1.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.02</td>
<td id="S4.T1.2.1.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">79.24</td>
<td id="S4.T1.2.1.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">88.50</td>
<td id="S4.T1.2.1.8.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.25</td>
<td id="S4.T1.2.1.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">77.50</td>
<td id="S4.T1.2.1.8.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">62.75</td>
<td id="S4.T1.2.1.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.43</td>
<td id="S4.T1.2.1.8.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">74.07</td>
<td id="S4.T1.2.1.8.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">77.98</td>
<td id="S4.T1.2.1.8.12" class="ltx_td ltx_align_center ltx_border_t">66.55</td>
</tr>
<tr id="S4.T1.2.1.9" class="ltx_tr">
<td id="S4.T1.2.1.9.1" class="ltx_td ltx_align_center ltx_border_r">FedSR</td>
<td id="S4.T1.2.1.9.2" class="ltx_td ltx_align_center ltx_border_r">82.00</td>
<td id="S4.T1.2.1.9.3" class="ltx_td ltx_align_center ltx_border_r">82.95</td>
<td id="S4.T1.2.1.9.4" class="ltx_td ltx_align_center ltx_border_r">93.53</td>
<td id="S4.T1.2.1.9.5" class="ltx_td ltx_align_center ltx_border_r">66.29</td>
<td id="S4.T1.2.1.9.6" class="ltx_td ltx_align_center ltx_border_r">81.19</td>
<td id="S4.T1.2.1.9.7" class="ltx_td ltx_align_center ltx_border_r">62.75</td>
<td id="S4.T1.2.1.9.8" class="ltx_td ltx_align_center ltx_border_r">49.85</td>
<td id="S4.T1.2.1.9.9" class="ltx_td ltx_align_center ltx_border_r">72.24</td>
<td id="S4.T1.2.1.9.10" class="ltx_td ltx_align_center ltx_border_r">74.10</td>
<td id="S4.T1.2.1.9.11" class="ltx_td ltx_align_center">64.73</td>
</tr>
<tr id="S4.T1.2.1.10" class="ltx_tr">
<td id="S4.T1.2.1.10.1" class="ltx_td ltx_align_center ltx_border_r">FedGMA</td>
<td id="S4.T1.2.1.10.2" class="ltx_td ltx_align_center ltx_border_r">83.88</td>
<td id="S4.T1.2.1.10.3" class="ltx_td ltx_align_center ltx_border_r">80.04</td>
<td id="S4.T1.2.1.10.4" class="ltx_td ltx_align_center ltx_border_r">95.78</td>
<td id="S4.T1.2.1.10.5" class="ltx_td ltx_align_center ltx_border_r">69.17</td>
<td id="S4.T1.2.1.10.6" class="ltx_td ltx_align_center ltx_border_r">82.21</td>
<td id="S4.T1.2.1.10.7" class="ltx_td ltx_align_center ltx_border_r">65.34</td>
<td id="S4.T1.2.1.10.8" class="ltx_td ltx_align_center ltx_border_r">52.11</td>
<td id="S4.T1.2.1.10.9" class="ltx_td ltx_align_center ltx_border_r">75.98</td>
<td id="S4.T1.2.1.10.10" class="ltx_td ltx_align_center ltx_border_r">79.59</td>
<td id="S4.T1.2.1.10.11" class="ltx_td ltx_align_center">68.25</td>
</tr>
<tr id="S4.T1.2.1.11" class="ltx_tr">
<td id="S4.T1.2.1.11.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T1.2.1.11.1.1" class="ltx_text">
<span id="S4.T1.2.1.11.1.1.1" class="ltx_inline-block">
<span id="S4.T1.2.1.11.1.1.1.1" class="ltx_p">FL+</span>
<span id="S4.T1.2.1.11.1.1.1.2" class="ltx_p">Adapter/Prompt</span>
</span></span></td>
<td id="S4.T1.2.1.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PromptFL</td>
<td id="S4.T1.2.1.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">92.77</td>
<td id="S4.T1.2.1.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">94.24</td>
<td id="S4.T1.2.1.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">99.40</td>
<td id="S4.T1.2.1.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">82.13</td>
<td id="S4.T1.2.1.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">92.13</td>
<td id="S4.T1.2.1.11.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.18</td>
<td id="S4.T1.2.1.11.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">56.88</td>
<td id="S4.T1.2.1.11.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">82.13</td>
<td id="S4.T1.2.1.11.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">84.78</td>
<td id="S4.T1.2.1.11.12" class="ltx_td ltx_align_center ltx_border_t">73.99</td>
</tr>
<tr id="S4.T1.2.1.12" class="ltx_tr">
<td id="S4.T1.2.1.12.1" class="ltx_td ltx_align_center ltx_border_r">FedCLIP</td>
<td id="S4.T1.2.1.12.2" class="ltx_td ltx_align_center ltx_border_r">92.93</td>
<td id="S4.T1.2.1.12.3" class="ltx_td ltx_align_center ltx_border_r">94.80</td>
<td id="S4.T1.2.1.12.4" class="ltx_td ltx_align_center ltx_border_r">99.52</td>
<td id="S4.T1.2.1.12.5" class="ltx_td ltx_align_center ltx_border_r">82.26</td>
<td id="S4.T1.2.1.12.6" class="ltx_td ltx_align_center ltx_border_r">92.37</td>
<td id="S4.T1.2.1.12.7" class="ltx_td ltx_align_center ltx_border_r">71.03</td>
<td id="S4.T1.2.1.12.8" class="ltx_td ltx_align_center ltx_border_r">56.13</td>
<td id="S4.T1.2.1.12.9" class="ltx_td ltx_align_center ltx_border_r">83.76</td>
<td id="S4.T1.2.1.12.10" class="ltx_td ltx_align_center ltx_border_r">84.14</td>
<td id="S4.T1.2.1.12.11" class="ltx_td ltx_align_center">73.76</td>
</tr>
<tr id="S4.T1.2.1.13" class="ltx_tr">
<td id="S4.T1.2.1.13.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.1.1" class="ltx_text ltx_font_bold">Ours</span></td>
<td id="S4.T1.2.1.13.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.2.1" class="ltx_text ltx_font_bold">94.97</span></td>
<td id="S4.T1.2.1.13.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.3.1" class="ltx_text ltx_font_bold">96.25</span></td>
<td id="S4.T1.2.1.13.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.4.1" class="ltx_text ltx_font_bold">99.56</span></td>
<td id="S4.T1.2.1.13.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.5.1" class="ltx_text ltx_font_bold">84.72</span></td>
<td id="S4.T1.2.1.13.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.6.1" class="ltx_text ltx_font_bold">93.88</span></td>
<td id="S4.T1.2.1.13.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.7.1" class="ltx_text ltx_font_bold">74.21</span></td>
<td id="S4.T1.2.1.13.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">58.90</td>
<td id="S4.T1.2.1.13.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.9.1" class="ltx_text ltx_font_bold">85.51</span></td>
<td id="S4.T1.2.1.13.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.2.1.13.10.1" class="ltx_text ltx_font_bold">86.12</span></td>
<td id="S4.T1.2.1.13.11" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T1.2.1.13.11.1" class="ltx_text ltx_font_bold">76.18</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.4.2" class="ltx_text" style="font-size:90%;">Performance comparison of our proposed DiPrompT with state-of-the-art methods on PACS and Officehome datasets. FedDure outperforms all other methods</span></figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:216.8pt;height:189.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-25.8pt,22.5pt) scale(0.807986251417501,0.807986251417501) ;">
<table id="S4.T2.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.2.1.1" class="ltx_tr">
<td id="S4.T2.2.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T2.2.1.1.1.1" class="ltx_text">Methods</span></td>
<td id="S4.T2.2.1.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="5">VLCS</td>
</tr>
<tr id="S4.T2.2.1.2" class="ltx_tr">
<td id="S4.T2.2.1.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Caltech</td>
<td id="S4.T2.2.1.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Labelme</td>
<td id="S4.T2.2.1.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Pascal</td>
<td id="S4.T2.2.1.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Sun</td>
<td id="S4.T2.2.1.2.5" class="ltx_td ltx_align_center ltx_border_t">Avg</td>
</tr>
<tr id="S4.T2.2.1.3" class="ltx_tr">
<td id="S4.T2.2.1.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Fishr</td>
<td id="S4.T2.2.1.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">98.90</td>
<td id="S4.T2.2.1.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">64.0</td>
<td id="S4.T2.2.1.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">71.50</td>
<td id="S4.T2.2.1.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">76.80</td>
<td id="S4.T2.2.1.3.6" class="ltx_td ltx_align_center ltx_border_tt">77.80</td>
</tr>
<tr id="S4.T2.2.1.4" class="ltx_tr">
<td id="S4.T2.2.1.4.1" class="ltx_td ltx_align_center ltx_border_r">ITL-NET</td>
<td id="S4.T2.2.1.4.2" class="ltx_td ltx_align_center ltx_border_r">98.30</td>
<td id="S4.T2.2.1.4.3" class="ltx_td ltx_align_center ltx_border_r">65.40</td>
<td id="S4.T2.2.1.4.4" class="ltx_td ltx_align_center ltx_border_r">75.10</td>
<td id="S4.T2.2.1.4.5" class="ltx_td ltx_align_center ltx_border_r">76.80</td>
<td id="S4.T2.2.1.4.6" class="ltx_td ltx_align_center">78.90</td>
</tr>
<tr id="S4.T2.2.1.5" class="ltx_tr">
<td id="S4.T2.2.1.5.1" class="ltx_td ltx_align_center ltx_border_r">VAUE</td>
<td id="S4.T2.2.1.5.2" class="ltx_td ltx_align_center ltx_border_r">99.00</td>
<td id="S4.T2.2.1.5.3" class="ltx_td ltx_align_center ltx_border_r">64.70</td>
<td id="S4.T2.2.1.5.4" class="ltx_td ltx_align_center ltx_border_r">75.10</td>
<td id="S4.T2.2.1.5.5" class="ltx_td ltx_align_center ltx_border_r">79.40</td>
<td id="S4.T2.2.1.5.6" class="ltx_td ltx_align_center">79.40</td>
</tr>
<tr id="S4.T2.2.1.6" class="ltx_tr">
<td id="S4.T2.2.1.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="S4.T2.2.1.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">93.54</td>
<td id="S4.T2.2.1.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.69</td>
<td id="S4.T2.2.1.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.22</td>
<td id="S4.T2.2.1.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">74.66</td>
<td id="S4.T2.2.1.6.6" class="ltx_td ltx_align_center ltx_border_t">75.27</td>
</tr>
<tr id="S4.T2.2.1.7" class="ltx_tr">
<td id="S4.T2.2.1.7.1" class="ltx_td ltx_align_center ltx_border_r">FedProx</td>
<td id="S4.T2.2.1.7.2" class="ltx_td ltx_align_center ltx_border_r">94.55</td>
<td id="S4.T2.2.1.7.3" class="ltx_td ltx_align_center ltx_border_r">61.55</td>
<td id="S4.T2.2.1.7.4" class="ltx_td ltx_align_center ltx_border_r">73.75</td>
<td id="S4.T2.2.1.7.5" class="ltx_td ltx_align_center ltx_border_r">75.52</td>
<td id="S4.T2.2.1.7.6" class="ltx_td ltx_align_center">76.34</td>
</tr>
<tr id="S4.T2.2.1.8" class="ltx_tr">
<td id="S4.T2.2.1.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedADG</td>
<td id="S4.T2.2.1.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">95.96</td>
<td id="S4.T2.2.1.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">61.43</td>
<td id="S4.T2.2.1.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.30</td>
<td id="S4.T2.2.1.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.44</td>
<td id="S4.T2.2.1.8.6" class="ltx_td ltx_align_center ltx_border_t">74.03</td>
</tr>
<tr id="S4.T2.2.1.9" class="ltx_tr">
<td id="S4.T2.2.1.9.1" class="ltx_td ltx_align_center ltx_border_r">FedSR</td>
<td id="S4.T2.2.1.9.2" class="ltx_td ltx_align_center ltx_border_r">96.37</td>
<td id="S4.T2.2.1.9.3" class="ltx_td ltx_align_center ltx_border_r">60.15</td>
<td id="S4.T2.2.1.9.4" class="ltx_td ltx_align_center ltx_border_r">69.74</td>
<td id="S4.T2.2.1.9.5" class="ltx_td ltx_align_center ltx_border_r">73.40</td>
<td id="S4.T2.2.1.9.6" class="ltx_td ltx_align_center">74.91</td>
</tr>
<tr id="S4.T2.2.1.10" class="ltx_tr">
<td id="S4.T2.2.1.10.1" class="ltx_td ltx_align_center ltx_border_r">FedGMA</td>
<td id="S4.T2.2.1.10.2" class="ltx_td ltx_align_center ltx_border_r">97.88</td>
<td id="S4.T2.2.1.10.3" class="ltx_td ltx_align_center ltx_border_r">61.47</td>
<td id="S4.T2.2.1.10.4" class="ltx_td ltx_align_center ltx_border_r">73.76</td>
<td id="S4.T2.2.1.10.5" class="ltx_td ltx_align_center ltx_border_r">76.19</td>
<td id="S4.T2.2.1.10.6" class="ltx_td ltx_align_center">77.32</td>
</tr>
<tr id="S4.T2.2.1.11" class="ltx_tr">
<td id="S4.T2.2.1.11.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PromptFL</td>
<td id="S4.T2.2.1.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">99.49</td>
<td id="S4.T2.2.1.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65.36</td>
<td id="S4.T2.2.1.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.54</td>
<td id="S4.T2.2.1.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.75</td>
<td id="S4.T2.2.1.11.6" class="ltx_td ltx_align_center ltx_border_t">80.53</td>
</tr>
<tr id="S4.T2.2.1.12" class="ltx_tr">
<td id="S4.T2.2.1.12.1" class="ltx_td ltx_align_center ltx_border_r">FedCLIP</td>
<td id="S4.T2.2.1.12.2" class="ltx_td ltx_align_center ltx_border_r">99.39</td>
<td id="S4.T2.2.1.12.3" class="ltx_td ltx_align_center ltx_border_r">66.70</td>
<td id="S4.T2.2.1.12.4" class="ltx_td ltx_align_center ltx_border_r">82.24</td>
<td id="S4.T2.2.1.12.5" class="ltx_td ltx_align_center ltx_border_r">78.62</td>
<td id="S4.T2.2.1.12.6" class="ltx_td ltx_align_center">81.73</td>
</tr>
<tr id="S4.T2.2.1.13" class="ltx_tr">
<td id="S4.T2.2.1.13.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.2.1.13.1.1" class="ltx_text ltx_font_bold">Ours</span></td>
<td id="S4.T2.2.1.13.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.2.1.13.2.1" class="ltx_text ltx_font_bold">99.70</span></td>
<td id="S4.T2.2.1.13.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.2.1.13.3.1" class="ltx_text ltx_font_bold">69.23</span></td>
<td id="S4.T2.2.1.13.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.2.1.13.4.1" class="ltx_text ltx_font_bold">84.16</span></td>
<td id="S4.T2.2.1.13.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T2.2.1.13.5.1" class="ltx_text ltx_font_bold">81.72</span></td>
<td id="S4.T2.2.1.13.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.2.1.13.6.1" class="ltx_text ltx_font_bold">83.70</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.3.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.4.2" class="ltx_text" style="font-size:90%;">Performance comparison of our proposed DiPrompT with state-of-the-art methods on VLCS dataset.</span></figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Datasets.</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">We perform comprehensive experiments on three widely used datasets in domain generalization tasks, including PACS (4 domains: photo, art-painting, cartoon, and sketch) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">12</span></a>]</cite>, Officehome (4 domains: Art, Clipart, Product, and Real World) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">36</span></a>]</cite>, and VLCS (4 domains: Pascal, Labelme, Caltech and Sun) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">8</span></a>]</cite>. To conduct our analysis on each dataset, we adopt the ”leave-one-domain-out” strategy, wherein we select one domain as the target domain and utilize the remaining domains as source domains. We provide detailed dataset descriptions in supplementary materials.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Baselines.</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">We compare our DiPrompT with the following state-of-the-art methods. SWAD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">5</span></a>]</cite>, I2ADR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">25</span></a>]</cite>, PCL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">40</span></a>]</cite>, Fishr <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">31</span></a>]</cite>, ITL-Net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">9</span></a>]</cite> and VAUE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite> are sota centralized learning methods that learned a generalized model by using all sources domains in a data pool regardless of data privacy. Meanwhile, we consider recent FL algorithms as our main competitors. FedAvg and FedProx are common FL algorithms that aimed to tackle data heterogeneity between clients. FedADG<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">41</span></a>]</cite>, FedSR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite>, and FedGMA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">35</span></a>]</cite> focused on solving the Federated domain generalization (FL+DG). PromptFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">10</span></a>]</cite> and FedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">22</span></a>]</cite> adapted pre-trained vision-language models in FL tasks via prompt and adapter tuning, respectively.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2403.08506/assets/x3.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="528" height="528" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">((a))</span> </span><span id="S4.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">PACS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2403.08506/assets/x4.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="528" height="528" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">((b))</span> </span><span id="S4.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">VLCS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/2403.08506/assets/x5.png" id="S4.F3.sf3.g1" class="ltx_graphics ltx_img_square" width="528" height="515" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf3.2.1.1" class="ltx_text" style="font-size:90%;">((c))</span> </span><span id="S4.F3.sf3.3.2" class="ltx_text" style="font-size:90%;">PACS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F3.sf4" class="ltx_figure ltx_figure_panel"><img src="" id="S4.F3.sf4.g1" class="ltx_graphics ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf4.2.1.1" class="ltx_text" style="font-size:90%;">((d))</span> </span><span id="S4.F3.sf4.3.2" class="ltx_text" style="font-size:90%;">VLCS</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Analysis in terms of few shots settings and different backbone architectures on PACS and VLCS datasets.</span></figcaption>
</figure>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Implementation Details.</h4>

<div id="S4.SS1.SSS3.p1" class="ltx_para">
<p id="S4.SS1.SSS3.p1.6" class="ltx_p">In our experiment, we conducted model training using PyTorch on GeForce RTX 3090 GPU. The training process for all models involved the utilization of the Adam optimizer with a learning rate set at 5e-4. It’s worth noting that this uniform configuration applied to all methods under consideration, with the exception of FedGMA. For FedGMA, we tailored its optimizer parameters to align with its best-reported hyperparameters
in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">35</span></a>]</cite>, ensuring a comprehensive and consistent approach across our experimental design. Furthermore, our default settings also include the weighted coefficient <math id="S4.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\lambda=1.0" display="inline"><semantics id="S4.SS1.SSS3.p1.1.m1.1a"><mrow id="S4.SS1.SSS3.p1.1.m1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml">λ</mi><mo id="S4.SS1.SSS3.p1.1.m1.1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.1.m1.1b"><apply id="S4.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1"><eq id="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.2">𝜆</ci><cn type="float" id="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.1.m1.1c">\lambda=1.0</annotation></semantics></math>, batch size <math id="S4.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="b=16" display="inline"><semantics id="S4.SS1.SSS3.p1.2.m2.1a"><mrow id="S4.SS1.SSS3.p1.2.m2.1.1" xref="S4.SS1.SSS3.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS3.p1.2.m2.1.1.2" xref="S4.SS1.SSS3.p1.2.m2.1.1.2.cmml">b</mi><mo id="S4.SS1.SSS3.p1.2.m2.1.1.1" xref="S4.SS1.SSS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.2.m2.1.1.3" xref="S4.SS1.SSS3.p1.2.m2.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.2.m2.1b"><apply id="S4.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1"><eq id="S4.SS1.SSS3.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1.2">𝑏</ci><cn type="integer" id="S4.SS1.SSS3.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.2.m2.1c">b=16</annotation></semantics></math>, local iterations <math id="S4.SS1.SSS3.p1.3.m3.1" class="ltx_Math" alttext="T=1" display="inline"><semantics id="S4.SS1.SSS3.p1.3.m3.1a"><mrow id="S4.SS1.SSS3.p1.3.m3.1.1" xref="S4.SS1.SSS3.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS3.p1.3.m3.1.1.2" xref="S4.SS1.SSS3.p1.3.m3.1.1.2.cmml">T</mi><mo id="S4.SS1.SSS3.p1.3.m3.1.1.1" xref="S4.SS1.SSS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.3.m3.1.1.3" xref="S4.SS1.SSS3.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.3.m3.1b"><apply id="S4.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1"><eq id="S4.SS1.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1.2">𝑇</ci><cn type="integer" id="S4.SS1.SSS3.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.3.m3.1c">T=1</annotation></semantics></math>, the selected clients in each round <math id="S4.SS1.SSS3.p1.4.m4.1" class="ltx_Math" alttext="H=5" display="inline"><semantics id="S4.SS1.SSS3.p1.4.m4.1a"><mrow id="S4.SS1.SSS3.p1.4.m4.1.1" xref="S4.SS1.SSS3.p1.4.m4.1.1.cmml"><mi id="S4.SS1.SSS3.p1.4.m4.1.1.2" xref="S4.SS1.SSS3.p1.4.m4.1.1.2.cmml">H</mi><mo id="S4.SS1.SSS3.p1.4.m4.1.1.1" xref="S4.SS1.SSS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.4.m4.1.1.3" xref="S4.SS1.SSS3.p1.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.4.m4.1b"><apply id="S4.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1"><eq id="S4.SS1.SSS3.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1.2">𝐻</ci><cn type="integer" id="S4.SS1.SSS3.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.4.m4.1c">H=5</annotation></semantics></math>, the number of clients <math id="S4.SS1.SSS3.p1.5.m5.1" class="ltx_Math" alttext="K=20" display="inline"><semantics id="S4.SS1.SSS3.p1.5.m5.1a"><mrow id="S4.SS1.SSS3.p1.5.m5.1.1" xref="S4.SS1.SSS3.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS3.p1.5.m5.1.1.2" xref="S4.SS1.SSS3.p1.5.m5.1.1.2.cmml">K</mi><mo id="S4.SS1.SSS3.p1.5.m5.1.1.1" xref="S4.SS1.SSS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.5.m5.1.1.3" xref="S4.SS1.SSS3.p1.5.m5.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.5.m5.1b"><apply id="S4.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1"><eq id="S4.SS1.SSS3.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1.2">𝐾</ci><cn type="integer" id="S4.SS1.SSS3.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.5.m5.1c">K=20</annotation></semantics></math>, and the number of global rounds <math id="S4.SS1.SSS3.p1.6.m6.1" class="ltx_Math" alttext="R=100" display="inline"><semantics id="S4.SS1.SSS3.p1.6.m6.1a"><mrow id="S4.SS1.SSS3.p1.6.m6.1.1" xref="S4.SS1.SSS3.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS3.p1.6.m6.1.1.2" xref="S4.SS1.SSS3.p1.6.m6.1.1.2.cmml">R</mi><mo id="S4.SS1.SSS3.p1.6.m6.1.1.1" xref="S4.SS1.SSS3.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.6.m6.1.1.3" xref="S4.SS1.SSS3.p1.6.m6.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.6.m6.1b"><apply id="S4.SS1.SSS3.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1"><eq id="S4.SS1.SSS3.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1.2">𝑅</ci><cn type="integer" id="S4.SS1.SSS3.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.6.m6.1c">R=100</annotation></semantics></math>. Following CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref"><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite>, we adopt ResNet50 as the backbone architecture of an image encoder and use a masked self-attention Transformer as a text encoder. Note that if there is no specified description, we use the same hyper-parameters and backbone architecture for DiPrompT and other methods in all experiments to implement fair comparison.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<div id="S4.T3.3.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:216.8pt;height:140.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-44.0pt,28.6pt) scale(0.711499184965121,0.711499184965121) ;">
<table id="S4.T3.3.3.3" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.3.3.3.4" class="ltx_tr">
<td id="S4.T3.3.3.3.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T3.3.3.3.4.1.1" class="ltx_text">Ablated components</span></td>
<td id="S4.T3.3.3.3.4.2" class="ltx_td ltx_align_center ltx_border_t" colspan="5">PACS</td>
</tr>
<tr id="S4.T3.3.3.3.5" class="ltx_tr">
<td id="S4.T3.3.3.3.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Art</td>
<td id="S4.T3.3.3.3.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Cartoon</td>
<td id="S4.T3.3.3.3.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Photo</td>
<td id="S4.T3.3.3.3.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Sketch</td>
<td id="S4.T3.3.3.3.5.5" class="ltx_td ltx_align_center ltx_border_t">Avg</td>
</tr>
<tr id="S4.T3.3.3.3.6" class="ltx_tr">
<td id="S4.T3.3.3.3.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">w/o G-Prompt</td>
<td id="S4.T3.3.3.3.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">88.87</td>
<td id="S4.T3.3.3.3.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">91.42</td>
<td id="S4.T3.3.3.3.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">98.22</td>
<td id="S4.T3.3.3.3.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">75.47</td>
<td id="S4.T3.3.3.3.6.6" class="ltx_td ltx_align_center ltx_border_tt">88.50</td>
</tr>
<tr id="S4.T3.3.3.3.7" class="ltx_tr">
<td id="S4.T3.3.3.3.7.1" class="ltx_td ltx_align_center ltx_border_r">w/o D-Prompts</td>
<td id="S4.T3.3.3.3.7.2" class="ltx_td ltx_align_center ltx_border_r">92.77</td>
<td id="S4.T3.3.3.3.7.3" class="ltx_td ltx_align_center ltx_border_r">94.24</td>
<td id="S4.T3.3.3.3.7.4" class="ltx_td ltx_align_center ltx_border_r">99.40</td>
<td id="S4.T3.3.3.3.7.5" class="ltx_td ltx_align_center ltx_border_r">82.13</td>
<td id="S4.T3.3.3.3.7.6" class="ltx_td ltx_align_center">92.13</td>
</tr>
<tr id="S4.T3.1.1.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r">w/o <math id="S4.T3.1.1.1.1.1.m1.1" class="ltx_Math" alttext="L_{cont}" display="inline"><semantics id="S4.T3.1.1.1.1.1.m1.1a"><msub id="S4.T3.1.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.1.m1.1.1.cmml"><mi id="S4.T3.1.1.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.1.1.m1.1.1.2.cmml">L</mi><mrow id="S4.T3.1.1.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T3.1.1.1.1.1.m1.1.1.3.2" xref="S4.T3.1.1.1.1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.T3.1.1.1.1.1.m1.1.1.3.1" xref="S4.T3.1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.1.1.1.1.1.m1.1.1.3.3" xref="S4.T3.1.1.1.1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.T3.1.1.1.1.1.m1.1.1.3.1a" xref="S4.T3.1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.1.1.1.1.1.m1.1.1.3.4" xref="S4.T3.1.1.1.1.1.m1.1.1.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.T3.1.1.1.1.1.m1.1.1.3.1b" xref="S4.T3.1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.1.1.1.1.1.m1.1.1.3.5" xref="S4.T3.1.1.1.1.1.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T3.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1.2">𝐿</ci><apply id="S4.T3.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1.3"><times id="S4.T3.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T3.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1.3.2">𝑐</ci><ci id="S4.T3.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1.3.3">𝑜</ci><ci id="S4.T3.1.1.1.1.1.m1.1.1.3.4.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1.3.4">𝑛</ci><ci id="S4.T3.1.1.1.1.1.m1.1.1.3.5.cmml" xref="S4.T3.1.1.1.1.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.1.m1.1c">L_{cont}</annotation></semantics></math>
</td>
<td id="S4.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r">94.57</td>
<td id="S4.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r">95.61</td>
<td id="S4.T3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r">99.52</td>
<td id="S4.T3.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r">84.27</td>
<td id="S4.T3.1.1.1.1.6" class="ltx_td ltx_align_center">93.49</td>
</tr>
<tr id="S4.T3.3.3.3.8" class="ltx_tr">
<td id="S4.T3.3.3.3.8.1" class="ltx_td ltx_align_center ltx_border_r">w/o Q-Prompt</td>
<td id="S4.T3.3.3.3.8.2" class="ltx_td ltx_align_center ltx_border_r">93.35</td>
<td id="S4.T3.3.3.3.8.3" class="ltx_td ltx_align_center ltx_border_r">93.69</td>
<td id="S4.T3.3.3.3.8.4" class="ltx_td ltx_align_center ltx_border_r">99.44</td>
<td id="S4.T3.3.3.3.8.5" class="ltx_td ltx_align_center ltx_border_r">83.16</td>
<td id="S4.T3.3.3.3.8.6" class="ltx_td ltx_align_center">92.40</td>
</tr>
<tr id="S4.T3.3.3.3.9" class="ltx_tr">
<td id="S4.T3.3.3.3.9.1" class="ltx_td ltx_align_center ltx_border_r">w/o ensemble</td>
<td id="S4.T3.3.3.3.9.2" class="ltx_td ltx_align_center ltx_border_r">94.19</td>
<td id="S4.T3.3.3.3.9.3" class="ltx_td ltx_align_center ltx_border_r">94.88</td>
<td id="S4.T3.3.3.3.9.4" class="ltx_td ltx_align_center ltx_border_r">99.52</td>
<td id="S4.T3.3.3.3.9.5" class="ltx_td ltx_align_center ltx_border_r">83.4</td>
<td id="S4.T3.3.3.3.9.6" class="ltx_td ltx_align_center">93.00</td>
</tr>
<tr id="S4.T3.2.2.2.2" class="ltx_tr">
<td id="S4.T3.2.2.2.2.1" class="ltx_td ltx_align_center ltx_border_r">w/o <math id="S4.T3.2.2.2.2.1.m1.1" class="ltx_Math" alttext="L_{KL}" display="inline"><semantics id="S4.T3.2.2.2.2.1.m1.1a"><msub id="S4.T3.2.2.2.2.1.m1.1.1" xref="S4.T3.2.2.2.2.1.m1.1.1.cmml"><mi id="S4.T3.2.2.2.2.1.m1.1.1.2" xref="S4.T3.2.2.2.2.1.m1.1.1.2.cmml">L</mi><mrow id="S4.T3.2.2.2.2.1.m1.1.1.3" xref="S4.T3.2.2.2.2.1.m1.1.1.3.cmml"><mi id="S4.T3.2.2.2.2.1.m1.1.1.3.2" xref="S4.T3.2.2.2.2.1.m1.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.T3.2.2.2.2.1.m1.1.1.3.1" xref="S4.T3.2.2.2.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.2.2.2.2.1.m1.1.1.3.3" xref="S4.T3.2.2.2.2.1.m1.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.1.m1.1b"><apply id="S4.T3.2.2.2.2.1.m1.1.1.cmml" xref="S4.T3.2.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.2.2.2.2.1.m1.1.1.1.cmml" xref="S4.T3.2.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S4.T3.2.2.2.2.1.m1.1.1.2.cmml" xref="S4.T3.2.2.2.2.1.m1.1.1.2">𝐿</ci><apply id="S4.T3.2.2.2.2.1.m1.1.1.3.cmml" xref="S4.T3.2.2.2.2.1.m1.1.1.3"><times id="S4.T3.2.2.2.2.1.m1.1.1.3.1.cmml" xref="S4.T3.2.2.2.2.1.m1.1.1.3.1"></times><ci id="S4.T3.2.2.2.2.1.m1.1.1.3.2.cmml" xref="S4.T3.2.2.2.2.1.m1.1.1.3.2">𝐾</ci><ci id="S4.T3.2.2.2.2.1.m1.1.1.3.3.cmml" xref="S4.T3.2.2.2.2.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.1.m1.1c">L_{KL}</annotation></semantics></math>
</td>
<td id="S4.T3.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r">94.04</td>
<td id="S4.T3.2.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r">95.56</td>
<td id="S4.T3.2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r">99.40</td>
<td id="S4.T3.2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r">81.19</td>
<td id="S4.T3.2.2.2.2.6" class="ltx_td ltx_align_center">92.54</td>
</tr>
<tr id="S4.T3.3.3.3.3" class="ltx_tr">
<td id="S4.T3.3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_r">w/o <math id="S4.T3.3.3.3.3.1.m1.1" class="ltx_Math" alttext="L_{mse}" display="inline"><semantics id="S4.T3.3.3.3.3.1.m1.1a"><msub id="S4.T3.3.3.3.3.1.m1.1.1" xref="S4.T3.3.3.3.3.1.m1.1.1.cmml"><mi id="S4.T3.3.3.3.3.1.m1.1.1.2" xref="S4.T3.3.3.3.3.1.m1.1.1.2.cmml">L</mi><mrow id="S4.T3.3.3.3.3.1.m1.1.1.3" xref="S4.T3.3.3.3.3.1.m1.1.1.3.cmml"><mi id="S4.T3.3.3.3.3.1.m1.1.1.3.2" xref="S4.T3.3.3.3.3.1.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T3.3.3.3.3.1.m1.1.1.3.1" xref="S4.T3.3.3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.3.3.3.3.1.m1.1.1.3.3" xref="S4.T3.3.3.3.3.1.m1.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.T3.3.3.3.3.1.m1.1.1.3.1a" xref="S4.T3.3.3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.3.3.3.3.1.m1.1.1.3.4" xref="S4.T3.3.3.3.3.1.m1.1.1.3.4.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.1.m1.1b"><apply id="S4.T3.3.3.3.3.1.m1.1.1.cmml" xref="S4.T3.3.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.3.3.3.3.1.m1.1.1.1.cmml" xref="S4.T3.3.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S4.T3.3.3.3.3.1.m1.1.1.2.cmml" xref="S4.T3.3.3.3.3.1.m1.1.1.2">𝐿</ci><apply id="S4.T3.3.3.3.3.1.m1.1.1.3.cmml" xref="S4.T3.3.3.3.3.1.m1.1.1.3"><times id="S4.T3.3.3.3.3.1.m1.1.1.3.1.cmml" xref="S4.T3.3.3.3.3.1.m1.1.1.3.1"></times><ci id="S4.T3.3.3.3.3.1.m1.1.1.3.2.cmml" xref="S4.T3.3.3.3.3.1.m1.1.1.3.2">𝑚</ci><ci id="S4.T3.3.3.3.3.1.m1.1.1.3.3.cmml" xref="S4.T3.3.3.3.3.1.m1.1.1.3.3">𝑠</ci><ci id="S4.T3.3.3.3.3.1.m1.1.1.3.4.cmml" xref="S4.T3.3.3.3.3.1.m1.1.1.3.4">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.1.m1.1c">L_{mse}</annotation></semantics></math>
</td>
<td id="S4.T3.3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_r">93.75</td>
<td id="S4.T3.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r">95.01</td>
<td id="S4.T3.3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r">99.34</td>
<td id="S4.T3.3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r">80.80</td>
<td id="S4.T3.3.3.3.3.6" class="ltx_td ltx_align_center">92.23</td>
</tr>
<tr id="S4.T3.3.3.3.10" class="ltx_tr">
<td id="S4.T3.3.3.3.10.1" class="ltx_td ltx_align_center ltx_border_r">w domain</td>
<td id="S4.T3.3.3.3.10.2" class="ltx_td ltx_align_center ltx_border_r">95.82</td>
<td id="S4.T3.3.3.3.10.3" class="ltx_td ltx_align_center ltx_border_r">96.81</td>
<td id="S4.T3.3.3.3.10.4" class="ltx_td ltx_align_center ltx_border_r">99.64</td>
<td id="S4.T3.3.3.3.10.5" class="ltx_td ltx_align_center ltx_border_r">84.80</td>
<td id="S4.T3.3.3.3.10.6" class="ltx_td ltx_align_center">94.26</td>
</tr>
<tr id="S4.T3.3.3.3.11" class="ltx_tr">
<td id="S4.T3.3.3.3.11.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.3.3.3.11.1.1" class="ltx_text ltx_font_bold">Ours</span></td>
<td id="S4.T3.3.3.3.11.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">94.47</td>
<td id="S4.T3.3.3.3.11.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">96.25</td>
<td id="S4.T3.3.3.3.11.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">99.56</td>
<td id="S4.T3.3.3.3.11.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">84.72</td>
<td id="S4.T3.3.3.3.11.6" class="ltx_td ltx_align_center ltx_border_b">93.88</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.5.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.6.2" class="ltx_text" style="font-size:90%;">Quantitative analysis of components of DiPrompT.</span></figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance Comparison</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We report the experimental results of DiPrompT and other state-of-the-art methods in Table <a href="#S4.T1" title="Table 1 ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a href="#S4.T2" title="Table 2 ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, which involves 12 domain generalization tasks on the PACS, OfficeHome, and VLCS datasets. All results are the average of three runs, and bold text represents the best results. Specifically, as mentioned earlier, we considered a more flexible scenario when <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="K&gt;M" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">K</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">&gt;</mo><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><gt id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></gt><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝐾</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">K&gt;M</annotation></semantics></math>, thus there is no one-to-one mapping between local clients and domains.
It can be observed that the previous federated domain generalization (FL+DG) methods perform poorly, even worse than the FL methods designed for client heterogeneity. FedGMA’s performance is comparable to FedAvg and FedProx, while FedADG and FedSR exhibit lower performance in many DG tasks compared to FedAvg and FedProx. The phenomenon might stem from FL+DG methods struggling with valuable knowledge as client volume significantly surpasses the number of source domains.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Furthermore, we compare our DiPrompT with state-of-the-art methods from centralized learning, FL, and FL+DG. It is noted that due to the dependencies on domain labels and interrelationships between source domains, centralized learning methods cannot be applied to this domain-separated setting. They are not direct competitors to our model due to the different setups (FL vs. centralized learning), and we adopt the results taken from their original papers. With prompt tuning from the textual branch, DiPrompT outperforms centralized methods as well as FL and FL+DG techniques by a big margin, where we adopt the same image backbone (i.e. ResNet50) even when domain labels are unknown for DiPrompT. Moreover, due to complementary knowledge from G-Prompt and D-Prompts, our DiPrompT shows significant superiority over PromptFL and FedCLIP, which utilize the same pre-trained vision-language model (CLIP) as our methods. Overall, DiPrompT achieves the best average accuracy across four benchmark datasets. When examining the results for each target domain setting within each dataset, DiPrompT outperforms previous methods in 11 out of 12 settings. These quantitative results demonstrate the effectiveness of our approach.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study</h3>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Effectiveness of Components.</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">To measure the importance of each component in our DiPrompT, we conduct an ablation analysis for the following variants using the PACS dataset in Table <a href="#S4.T3" title="Table 3 ‣ 4.1.3 Implementation Details. ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S4.SS3.SSS1.p2" class="ltx_para">
<p id="S4.SS3.SSS1.p2.2" class="ltx_p">Row 1 denotes that DiPrompT removes G-Prompts in each local model. Row 2 indicates the variant that eliminates D-Prompts in our DiPrompT, while only updating G-Prompt, which is essentially equivalent to PromptFL. Compared with DiPrompT, the dramatic performance drop shows that the two components are both effective and can provide value complementary knowledge by ensembling them.
In Row 3, we remove the built contrastive loss during D-Prompts optimization and find a slight drop.
Instead of learnable Q-Prompt, we use static prompts in Row 4 (i.e., “a photo of a [CLASS] with the domain of [Domain].”) to look up domain prompts for each sample. As results show, learnable Q-Prompt plays an important role in exploring domain information in latent domain learning.
In Row 5, we only choose the domain prompt with the highest weight rather than ensembling knowledge from different source domains during inference. The performance decrease suggests that the collaborative ensemble metric enables the sufficient exploitation of more valuable knowledge.
Moreover, the results in Row 6 and 7 implicitly showcase the benefit of <math id="S4.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="L_{KL}" display="inline"><semantics id="S4.SS3.SSS1.p2.1.m1.1a"><msub id="S4.SS3.SSS1.p2.1.m1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS1.p2.1.m1.1.1.2" xref="S4.SS3.SSS1.p2.1.m1.1.1.2.cmml">L</mi><mrow id="S4.SS3.SSS1.p2.1.m1.1.1.3" xref="S4.SS3.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.SSS1.p2.1.m1.1.1.3.2" xref="S4.SS3.SSS1.p2.1.m1.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS1.p2.1.m1.1.1.3.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.SSS1.p2.1.m1.1.1.3.3" xref="S4.SS3.SSS1.p2.1.m1.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.1.m1.1b"><apply id="S4.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.2">𝐿</ci><apply id="S4.SS3.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.3"><times id="S4.SS3.SSS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.3.1"></times><ci id="S4.SS3.SSS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.3.2">𝐾</ci><ci id="S4.SS3.SSS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.1.m1.1c">L_{KL}</annotation></semantics></math> and <math id="S4.SS3.SSS1.p2.2.m2.1" class="ltx_Math" alttext="L_{mse}" display="inline"><semantics id="S4.SS3.SSS1.p2.2.m2.1a"><msub id="S4.SS3.SSS1.p2.2.m2.1.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="S4.SS3.SSS1.p2.2.m2.1.1.2" xref="S4.SS3.SSS1.p2.2.m2.1.1.2.cmml">L</mi><mrow id="S4.SS3.SSS1.p2.2.m2.1.1.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS1.p2.2.m2.1.1.3.2" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS1.p2.2.m2.1.1.3.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.SSS1.p2.2.m2.1.1.3.3" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS1.p2.2.m2.1.1.3.1a" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.SSS1.p2.2.m2.1.1.3.4" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.4.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.2.m2.1b"><apply id="S4.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.2">𝐿</ci><apply id="S4.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3"><times id="S4.SS3.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.1"></times><ci id="S4.SS3.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS3.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.3">𝑠</ci><ci id="S4.SS3.SSS1.p2.2.m2.1.1.3.4.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.3.4">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.2.m2.1c">L_{mse}</annotation></semantics></math> for Q-Prompt optimization.
When the domain labels are given for all local training data, we can observe that our DiPrompT is close to its upper bound.
These evaluations verify the effectiveness of each component, and DiPrompT can obtain complementary knowledge and eliminate the dependency on the domain label for better generalization on the unseen target domain.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2403.08506/assets/x7.png" id="S4.F4.sf1.g1" class="ltx_graphics ltx_img_square" width="528" height="526" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf1.4.2.1" class="ltx_text" style="font-size:90%;">((a))</span> </span><span id="S4.F4.sf1.2.1" class="ltx_text" style="font-size:90%;">The number of Client <math id="S4.F4.sf1.2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.F4.sf1.2.1.m1.1b"><mi id="S4.F4.sf1.2.1.m1.1.1" xref="S4.F4.sf1.2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F4.sf1.2.1.m1.1c"><ci id="S4.F4.sf1.2.1.m1.1.1.cmml" xref="S4.F4.sf1.2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.sf1.2.1.m1.1d">K</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2403.08506/assets/x8.png" id="S4.F4.sf2.g1" class="ltx_graphics ltx_img_square" width="528" height="541" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.sf2.4.2.1" class="ltx_text" style="font-size:90%;">((b))</span> </span><span id="S4.F4.sf2.2.1" class="ltx_text" style="font-size:90%;"> Weight coefficient <math id="S4.F4.sf2.2.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.F4.sf2.2.1.m1.1b"><mi id="S4.F4.sf2.2.1.m1.1.1" xref="S4.F4.sf2.2.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.sf2.2.1.m1.1c"><ci id="S4.F4.sf2.2.1.m1.1.1.cmml" xref="S4.F4.sf2.2.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.sf2.2.1.m1.1d">\lambda</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.6.3.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.4.2" class="ltx_text" style="font-size:90%;">Hyperparameters analysis in terms of the number of clients <math id="S4.F4.3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.F4.3.1.m1.1b"><mi id="S4.F4.3.1.m1.1.1" xref="S4.F4.3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F4.3.1.m1.1c"><ci id="S4.F4.3.1.m1.1.1.cmml" xref="S4.F4.3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.3.1.m1.1d">K</annotation></semantics></math> and weight coefficient <math id="S4.F4.4.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.F4.4.2.m2.1b"><mi id="S4.F4.4.2.m2.1.1" xref="S4.F4.4.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.4.2.m2.1c"><ci id="S4.F4.4.2.m2.1.1.cmml" xref="S4.F4.4.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.2.m2.1d">\lambda</annotation></semantics></math> on PACS.</span></figcaption>
</figure>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2403.08506/assets/x9.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_img_square" width="528" height="540" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf1.2.1.1" class="ltx_text" style="font-size:90%;">((a))</span> </span><span id="S4.F5.sf1.3.2" class="ltx_text" style="font-size:90%;">Communication cost</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2403.08506/assets/x10.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_img_square" width="528" height="540" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf2.2.1.1" class="ltx_text" style="font-size:90%;">((b))</span> </span><span id="S4.F5.sf2.3.2" class="ltx_text" style="font-size:90%;"> Computation cost</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.3.2" class="ltx_text" style="font-size:90%;">Comparison of computation and communication cost of DiPrompT and other federated domain generalization methods.</span></figcaption>
</figure>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Results on Few-shot Recognition.</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">To explore the effectiveness of our framework with extremely limited data, we compare the generalization performance of DiPrompT with some state-of-the-art methods across various few-shot settings (i.e., 1, 2, 4, 8, 16 shots). As depicted in Figure <a href="#S4.F3.sf1" title="Figure 3(a) ‣ Figure 3 ‣ 4.1.2 Baselines. ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> and shots <a href="#S4.F3.sf2" title="Figure 3(b) ‣ Figure 3 ‣ 4.1.2 Baselines. ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a>, we observe that as the number of training samples per class on each client increases, the performance of all methods is enhanced. Meanwhile, DiPrompT achieves significant performance improvements across all shot settings on PACS and VLCS datasets, and shows higher gains in minimal data cases (e.g. 1, 2 shots). Thereby, these results demonstrate the robustness of DiPrompT in acquiring complementary knowledge in data-scarce scenarios.</p>
</div>
</section>
<section id="S4.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Impacts of Backbone Architecture.</h4>

<div id="S4.SS3.SSS3.p1" class="ltx_para">
<p id="S4.SS3.SSS3.p1.1" class="ltx_p">To investigate how the choice of backbone architecture impacts generalization performance, we summarize the generalization effect of multiple methods based on different image encoders, including Reset50, ViT-B/32, and ViT-B/16. As shown in Figure <a href="#S4.F3.sf3" title="Figure 3(c) ‣ Figure 3 ‣ 4.1.2 Baselines. ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(c)</span></a> and <a href="#S4.F3.sf4" title="Figure 3(d) ‣ Figure 3 ‣ 4.1.2 Baselines. ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(d)</span></a>, the more advanced the backbone architecture is, the better the performance of all methods can achieve. More importantly, our DiPrompT is significantly better than other state-of-the-art methods across all backbone on PACS and VLCS datasets, which show the robustness of our DiPrompT in terms of backbones.</p>
</div>
</section>
<section id="S4.SS3.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.4 </span>Effect of Hyperparameters.</h4>

<div id="S4.SS3.SSS4.p1" class="ltx_para">
<p id="S4.SS3.SSS4.p1.7" class="ltx_p">There are two key hyperparameters, including the number of clients <math id="S4.SS3.SSS4.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.SSS4.p1.1.m1.1a"><mi id="S4.SS3.SSS4.p1.1.m1.1.1" xref="S4.SS3.SSS4.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS4.p1.1.m1.1b"><ci id="S4.SS3.SSS4.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS4.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS4.p1.1.m1.1c">K</annotation></semantics></math> and the value of the weight <math id="S4.SS3.SSS4.p1.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS3.SSS4.p1.2.m2.1a"><mi id="S4.SS3.SSS4.p1.2.m2.1.1" xref="S4.SS3.SSS4.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS4.p1.2.m2.1b"><ci id="S4.SS3.SSS4.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS4.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS4.p1.2.m2.1c">\lambda</annotation></semantics></math> between G-Prompt and D-Prompts. We first investigate the performance impact of the number of total clients, which varies in <math id="S4.SS3.SSS4.p1.3.m3.5" class="ltx_Math" alttext="\left\{3,5,10,20,50\right\}" display="inline"><semantics id="S4.SS3.SSS4.p1.3.m3.5a"><mrow id="S4.SS3.SSS4.p1.3.m3.5.6.2" xref="S4.SS3.SSS4.p1.3.m3.5.6.1.cmml"><mo id="S4.SS3.SSS4.p1.3.m3.5.6.2.1" xref="S4.SS3.SSS4.p1.3.m3.5.6.1.cmml">{</mo><mn id="S4.SS3.SSS4.p1.3.m3.1.1" xref="S4.SS3.SSS4.p1.3.m3.1.1.cmml">3</mn><mo id="S4.SS3.SSS4.p1.3.m3.5.6.2.2" xref="S4.SS3.SSS4.p1.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.SSS4.p1.3.m3.2.2" xref="S4.SS3.SSS4.p1.3.m3.2.2.cmml">5</mn><mo id="S4.SS3.SSS4.p1.3.m3.5.6.2.3" xref="S4.SS3.SSS4.p1.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.SSS4.p1.3.m3.3.3" xref="S4.SS3.SSS4.p1.3.m3.3.3.cmml">10</mn><mo id="S4.SS3.SSS4.p1.3.m3.5.6.2.4" xref="S4.SS3.SSS4.p1.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.SSS4.p1.3.m3.4.4" xref="S4.SS3.SSS4.p1.3.m3.4.4.cmml">20</mn><mo id="S4.SS3.SSS4.p1.3.m3.5.6.2.5" xref="S4.SS3.SSS4.p1.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.SSS4.p1.3.m3.5.5" xref="S4.SS3.SSS4.p1.3.m3.5.5.cmml">50</mn><mo id="S4.SS3.SSS4.p1.3.m3.5.6.2.6" xref="S4.SS3.SSS4.p1.3.m3.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS4.p1.3.m3.5b"><set id="S4.SS3.SSS4.p1.3.m3.5.6.1.cmml" xref="S4.SS3.SSS4.p1.3.m3.5.6.2"><cn type="integer" id="S4.SS3.SSS4.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS4.p1.3.m3.1.1">3</cn><cn type="integer" id="S4.SS3.SSS4.p1.3.m3.2.2.cmml" xref="S4.SS3.SSS4.p1.3.m3.2.2">5</cn><cn type="integer" id="S4.SS3.SSS4.p1.3.m3.3.3.cmml" xref="S4.SS3.SSS4.p1.3.m3.3.3">10</cn><cn type="integer" id="S4.SS3.SSS4.p1.3.m3.4.4.cmml" xref="S4.SS3.SSS4.p1.3.m3.4.4">20</cn><cn type="integer" id="S4.SS3.SSS4.p1.3.m3.5.5.cmml" xref="S4.SS3.SSS4.p1.3.m3.5.5">50</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS4.p1.3.m3.5c">\left\{3,5,10,20,50\right\}</annotation></semantics></math>. Note that we assign a source domain to a single client when <math id="S4.SS3.SSS4.p1.4.m4.1" class="ltx_Math" alttext="K=3" display="inline"><semantics id="S4.SS3.SSS4.p1.4.m4.1a"><mrow id="S4.SS3.SSS4.p1.4.m4.1.1" xref="S4.SS3.SSS4.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS4.p1.4.m4.1.1.2" xref="S4.SS3.SSS4.p1.4.m4.1.1.2.cmml">K</mi><mo id="S4.SS3.SSS4.p1.4.m4.1.1.1" xref="S4.SS3.SSS4.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS4.p1.4.m4.1.1.3" xref="S4.SS3.SSS4.p1.4.m4.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS4.p1.4.m4.1b"><apply id="S4.SS3.SSS4.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS4.p1.4.m4.1.1"><eq id="S4.SS3.SSS4.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS4.p1.4.m4.1.1.1"></eq><ci id="S4.SS3.SSS4.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS4.p1.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S4.SS3.SSS4.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS4.p1.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS4.p1.4.m4.1c">K=3</annotation></semantics></math> and randomly select 5 clients per round when <math id="S4.SS3.SSS4.p1.5.m5.1" class="ltx_Math" alttext="K&gt;=5" display="inline"><semantics id="S4.SS3.SSS4.p1.5.m5.1a"><mrow id="S4.SS3.SSS4.p1.5.m5.1.1" xref="S4.SS3.SSS4.p1.5.m5.1.1.cmml"><mi id="S4.SS3.SSS4.p1.5.m5.1.1.2" xref="S4.SS3.SSS4.p1.5.m5.1.1.2.cmml">K</mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.SSS4.p1.5.m5.1.1.1" xref="S4.SS3.SSS4.p1.5.m5.1.1.1.cmml">&gt;=</mo><mn id="S4.SS3.SSS4.p1.5.m5.1.1.3" xref="S4.SS3.SSS4.p1.5.m5.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS4.p1.5.m5.1b"><apply id="S4.SS3.SSS4.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS4.p1.5.m5.1.1"><geq id="S4.SS3.SSS4.p1.5.m5.1.1.1.cmml" xref="S4.SS3.SSS4.p1.5.m5.1.1.1"></geq><ci id="S4.SS3.SSS4.p1.5.m5.1.1.2.cmml" xref="S4.SS3.SSS4.p1.5.m5.1.1.2">𝐾</ci><cn type="integer" id="S4.SS3.SSS4.p1.5.m5.1.1.3.cmml" xref="S4.SS3.SSS4.p1.5.m5.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS4.p1.5.m5.1c">K&gt;=5</annotation></semantics></math>. As illustrated in Figure <a href="#S4.F4.sf1" title="Figure 4(a) ‣ Figure 4 ‣ 4.3.1 Effectiveness of Components. ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(a)</span></a>, although there is inevitable performance degradation for all methods by increasing total clients, our DiPrompT only has a light performance drop (about 1%) and outperforms other methods across all numerical settings. This phenomenon demonstrates the challenges posed by a large number of clients in federated domain generalization as well as the effectiveness of DiPrompT. Finally, we examine the impacts of the different values of the weight hyperparameter <math id="S4.SS3.SSS4.p1.6.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS3.SSS4.p1.6.m6.1a"><mi id="S4.SS3.SSS4.p1.6.m6.1.1" xref="S4.SS3.SSS4.p1.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS4.p1.6.m6.1b"><ci id="S4.SS3.SSS4.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS4.p1.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS4.p1.6.m6.1c">\lambda</annotation></semantics></math> between G-Prompt and D-Prompts on performance. As shown in Figure <a href="#S4.F4.sf2" title="Figure 4(b) ‣ Figure 4 ‣ 4.3.1 Effectiveness of Components. ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(b)</span></a>, we observe that the optimal performance is achieved when setting <math id="S4.SS3.SSS4.p1.7.m7.1" class="ltx_Math" alttext="\lambda=1" display="inline"><semantics id="S4.SS3.SSS4.p1.7.m7.1a"><mrow id="S4.SS3.SSS4.p1.7.m7.1.1" xref="S4.SS3.SSS4.p1.7.m7.1.1.cmml"><mi id="S4.SS3.SSS4.p1.7.m7.1.1.2" xref="S4.SS3.SSS4.p1.7.m7.1.1.2.cmml">λ</mi><mo id="S4.SS3.SSS4.p1.7.m7.1.1.1" xref="S4.SS3.SSS4.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS4.p1.7.m7.1.1.3" xref="S4.SS3.SSS4.p1.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS4.p1.7.m7.1b"><apply id="S4.SS3.SSS4.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS4.p1.7.m7.1.1"><eq id="S4.SS3.SSS4.p1.7.m7.1.1.1.cmml" xref="S4.SS3.SSS4.p1.7.m7.1.1.1"></eq><ci id="S4.SS3.SSS4.p1.7.m7.1.1.2.cmml" xref="S4.SS3.SSS4.p1.7.m7.1.1.2">𝜆</ci><cn type="integer" id="S4.SS3.SSS4.p1.7.m7.1.1.3.cmml" xref="S4.SS3.SSS4.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS4.p1.7.m7.1c">\lambda=1</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS3.SSS5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.5 </span>Cost Analysis.</h4>

<div id="S4.SS3.SSS5.p1" class="ltx_para">
<p id="S4.SS3.SSS5.p1.1" class="ltx_p"><span id="S4.SS3.SSS5.p1.1.1" class="ltx_text" style="color:#000000;">Finally, we analyze the efficiency of DiPrompT in terms of the computation and communication cost in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3.1 Effectiveness of Components. ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ DiPrompT: Disentangled Prompt Tuning for Multiple Latent Domain Generalization in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We measure the communication cost by the size of uploaded data per round. It can be observed that DiPrompT can save at most 830 times communication cost per round compared to FedADG and 625 times for FedGM, indicating that DiPrompT can significantly reduce communication burden. For the computation cost, we report the comparison of GPU time as in the same mini-batch, where DiPrompT outperforms FedADG around 2 times and is comparable computation cost with FedGMA. It is noted that we don’t compare with other FL and FL+DG methods (i.e FedAvg, FedProx, and FedSR) since they have almost the same communication and computation costs as FedGMA, while PrompFL and FedCLIP have similar costs with our DiPrompT. These results demonstrate the efficiency of our DiPrompT, which can be applied to many real-world scenarios.</span></p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work, we propose a novel framework named DiPrompT, the first attempt to introduce prompt tuning to federated domain generalization. Specifically, DiPrompT aims to learn general knowledge as well as valuable specific information across all clients, especially when the number of clients and source domains is inconsistent during training and different clients may store data originating from a shared domain. It provides more complementary knowledge for unseen target prediction during inference. Moreover, we build an adaptive query mechanism based on prompt tuning, which automatically searches the suitable domain for each sample when domain labels are not given for all local data. Extensive experiments show that our DiPrompT outperforms state-of-the-art methods, and is even better than many centralized learning strategies using domain labels.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib1.5.5.1" class="ltx_text" style="font-size:90%;">Bai et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib1.7.1" class="ltx_text" style="font-size:90%;">
Ruqi Bai, Saurabh Bagchi, and David I Inouye.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.8.1" class="ltx_text" style="font-size:90%;">Benchmarking algorithms for federated domain generalization.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib1.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2307.04942</em><span id="bib.bib1.10.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib2.5.5.1" class="ltx_text" style="font-size:90%;">Bai et al. [2021a]</span></span>
<span class="ltx_bibblock"><span id="bib.bib2.7.1" class="ltx_text" style="font-size:90%;">
Sikai Bai, Junyu Gao, Qi Wang, and Xuelong Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.8.1" class="ltx_text" style="font-size:90%;">Multi-domain synchronous refinement network for unsupervised cross-domain person re-identification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib2.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2021 IEEE International Conference on Multimedia and Expo (ICME)</em><span id="bib.bib2.11.3" class="ltx_text" style="font-size:90%;">, pages 1–6, 2021a.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib3.5.5.1" class="ltx_text" style="font-size:90%;">Bai et al. [2021b]</span></span>
<span class="ltx_bibblock"><span id="bib.bib3.7.1" class="ltx_text" style="font-size:90%;">
Sikai Bai, Qi Wang, and Xuelong Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.8.1" class="ltx_text" style="font-size:90%;">Mfi: Multi-range feature interchange for video action recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib3.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2020 25th International Conference on Pattern Recognition (ICPR)</em><span id="bib.bib3.11.3" class="ltx_text" style="font-size:90%;">, pages 6664–6671. IEEE, 2021b.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib4.5.5.1" class="ltx_text" style="font-size:90%;">Bai et al. [2024]</span></span>
<span class="ltx_bibblock"><span id="bib.bib4.7.1" class="ltx_text" style="font-size:90%;">
Sikai Bai, Shuaicheng Li, Weiming Zhuang, Kunlin Yang, Jun Hou, Shuai Yi, Shuai Zhang, Junyu Gao, Jie Zhang, and Song Guo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.8.1" class="ltx_text" style="font-size:90%;">Combating data imbalances in federated semi-supervised learning with dual regulators.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.9.1" class="ltx_text" style="font-size:90%;">2024.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib5.5.5.1" class="ltx_text" style="font-size:90%;">Cha et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib5.7.1" class="ltx_text" style="font-size:90%;">
Junbum Cha, Kyungjae Lee, Sungrae Park, and Sanghyuk Chun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.8.1" class="ltx_text" style="font-size:90%;">Domain generalization by mutual-information regularization with pre-trained models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib5.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">European Conference on Computer Vision</em><span id="bib.bib5.11.3" class="ltx_text" style="font-size:90%;">, pages 440–457. Springer, 2022.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib6.5.5.1" class="ltx_text" style="font-size:90%;">Chen et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib6.7.1" class="ltx_text" style="font-size:90%;">
Guangyi Chen, Weiran Yao, Xiangchen Song, Xinyue Li, Yongming Rao, and Kun Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.8.1" class="ltx_text" style="font-size:90%;">Prompt learning with optimal transport for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.9.1" class="ltx_text" style="font-size:90%;">2023.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib7.5.5.1" class="ltx_text" style="font-size:90%;">Du et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib7.7.1" class="ltx_text" style="font-size:90%;">
Yingjun Du, Jun Xu, Huan Xiong, Qiang Qiu, Xiantong Zhen, Cees GM Snoek, and Ling Shao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.8.1" class="ltx_text" style="font-size:90%;">Learning to learn with variational information bottleneck for domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib7.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part X 16</em><span id="bib.bib7.11.3" class="ltx_text" style="font-size:90%;">, pages 200–216, 2020.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib8.5.5.1" class="ltx_text" style="font-size:90%;">Fang et al. [2013]</span></span>
<span class="ltx_bibblock"><span id="bib.bib8.7.1" class="ltx_text" style="font-size:90%;">
Chen Fang, Ye Xu, and Daniel N Rockmore.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.8.1" class="ltx_text" style="font-size:90%;">Unbiased metric learning: On the utilization of multiple datasets and web images for softening bias.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib8.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Conference on Computer Vision</em><span id="bib.bib8.11.3" class="ltx_text" style="font-size:90%;">, pages 1657–1664, 2013.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib9.5.5.1" class="ltx_text" style="font-size:90%;">Gao et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib9.7.1" class="ltx_text" style="font-size:90%;">
Boyan Gao, Henry Gouk, Yongxin Yang, and Timothy Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.8.1" class="ltx_text" style="font-size:90%;">Loss function learning for domain generalization by implicit gradient.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib9.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</em><span id="bib.bib9.11.3" class="ltx_text" style="font-size:90%;">, pages 7002–7016, 2022.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib10.5.5.1" class="ltx_text" style="font-size:90%;">Guo et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib10.7.1" class="ltx_text" style="font-size:90%;">
Tao Guo, Song Guo, Junxiao Wang, and Wenchao Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.8.1" class="ltx_text" style="font-size:90%;">Promptfl: Let federated participants cooperatively learn prompts instead of models–federated learning in age of foundation model.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib10.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2208.11625</em><span id="bib.bib10.10.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib11.5.5.1" class="ltx_text" style="font-size:90%;">Huang et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib11.7.1" class="ltx_text" style="font-size:90%;">
Wenke Huang, Mang Ye, and Bo Du.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.8.1" class="ltx_text" style="font-size:90%;">Learn from others and be yourself in heterogeneous federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib11.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span id="bib.bib11.11.3" class="ltx_text" style="font-size:90%;">, pages 10143–10153, 2022.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib12.5.5.1" class="ltx_text" style="font-size:90%;">Li et al. [2017]</span></span>
<span class="ltx_bibblock"><span id="bib.bib12.7.1" class="ltx_text" style="font-size:90%;">
Da Li, Yongxin Yang, Yi-Zhe Song, and Timothy M Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.8.1" class="ltx_text" style="font-size:90%;">Deeper, broader and artier domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib12.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE international conference on computer vision</em><span id="bib.bib12.11.3" class="ltx_text" style="font-size:90%;">, pages 5542–5550, 2017.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib13.5.5.1" class="ltx_text" style="font-size:90%;">Li et al. [2018a]</span></span>
<span class="ltx_bibblock"><span id="bib.bib13.7.1" class="ltx_text" style="font-size:90%;">
Da Li, Yongxin Yang, Yi-Zhe Song, and Timothy Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.8.1" class="ltx_text" style="font-size:90%;">Learning to generalize: Meta-learning for domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib13.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI conference on artificial intelligence</em><span id="bib.bib13.11.3" class="ltx_text" style="font-size:90%;">, 2018a.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib14.5.5.1" class="ltx_text" style="font-size:90%;">Li et al. [2021a]</span></span>
<span class="ltx_bibblock"><span id="bib.bib14.7.1" class="ltx_text" style="font-size:90%;">
Qinbin Li, Bingsheng He, and Dawn Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.8.1" class="ltx_text" style="font-size:90%;">Model-contrastive federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib14.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em><span id="bib.bib14.11.3" class="ltx_text" style="font-size:90%;">, pages 10713–10722, 2021a.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib15.5.5.1" class="ltx_text" style="font-size:90%;">Li et al. [2021b]</span></span>
<span class="ltx_bibblock"><span id="bib.bib15.7.1" class="ltx_text" style="font-size:90%;">
Shuaicheng Li, Qianggang Cao, Lingbo Liu, Kunlin Yang, Shinan Liu, Jun Hou, and Shuai Yi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.8.1" class="ltx_text" style="font-size:90%;">Groupformer: Group activity recognition with clustered spatial-temporal transformer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib15.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</em><span id="bib.bib15.11.3" class="ltx_text" style="font-size:90%;">, pages 13668–13677, 2021b.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib16.5.5.1" class="ltx_text" style="font-size:90%;">Li et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib16.7.1" class="ltx_text" style="font-size:90%;">
Shuaicheng Li, Feng Zhang, Kunlin Yang, Lingbo Liu, Shinan Liu, Jun Hou, and Shuai Yi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.8.1" class="ltx_text" style="font-size:90%;">Probing visual-audio representation for video highlight detection via hard-pairs guided contrastive learning.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib16.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2206.10157</em><span id="bib.bib16.10.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib17.5.5.1" class="ltx_text" style="font-size:90%;">Li et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib17.7.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.8.1" class="ltx_text" style="font-size:90%;">Federated optimization in heterogeneous networks.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib17.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of Machine learning and systems</em><span id="bib.bib17.10.2" class="ltx_text" style="font-size:90%;">, 2:429–450, 2020.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib18.5.5.1" class="ltx_text" style="font-size:90%;">Li et al. [2018b]</span></span>
<span class="ltx_bibblock"><span id="bib.bib18.7.1" class="ltx_text" style="font-size:90%;">
Ya Li, Mingming Gong, Xinmei Tian, Tongliang Liu, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.8.1" class="ltx_text" style="font-size:90%;">Domain generalization via conditional invariant representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib18.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI conference on artificial intelligence</em><span id="bib.bib18.11.3" class="ltx_text" style="font-size:90%;">, 2018b.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib19.5.5.1" class="ltx_text" style="font-size:90%;">Lin et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib19.7.1" class="ltx_text" style="font-size:90%;">
Jianxin Lin, Yongqiang Tang, Junping Wang, and Wensheng Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.8.1" class="ltx_text" style="font-size:90%;">Mitigating both covariate and conditional shift for domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib19.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2022 IEEE 8th International Conference on Cloud Computing and Intelligent Systems (CCIS)</em><span id="bib.bib19.11.3" class="ltx_text" style="font-size:90%;">, pages 437–443, 2022.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib20.5.5.1" class="ltx_text" style="font-size:90%;">Liu et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib20.7.1" class="ltx_text" style="font-size:90%;">
Pengfei Liu, Weizhe Yuan, Jinlan Fu, Zhengbao Jiang, Hiroaki Hayashi, and Graham Neubig.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.8.1" class="ltx_text" style="font-size:90%;">Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib20.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">ACM Computing Surveys</em><span id="bib.bib20.10.2" class="ltx_text" style="font-size:90%;">, 55(9):1–35, 2023.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib21.5.5.1" class="ltx_text" style="font-size:90%;">Liu et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib21.7.1" class="ltx_text" style="font-size:90%;">
Quande Liu, Cheng Chen, Jing Qin, Qi Dou, and Pheng-Ann Heng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.8.1" class="ltx_text" style="font-size:90%;">Feddg: Federated domain generalization on medical image segmentation via episodic learning in continuous frequency space.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib21.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span id="bib.bib21.11.3" class="ltx_text" style="font-size:90%;">, pages 1013–1023, 2021.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib22.5.5.1" class="ltx_text" style="font-size:90%;">Lu et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib22.7.1" class="ltx_text" style="font-size:90%;">
Wang Lu, Xixu Hu, Jindong Wang, and Xing Xie.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.8.1" class="ltx_text" style="font-size:90%;">Fedclip: Fast generalization and personalization for clip in federated learning.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib22.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2302.13485</em><span id="bib.bib22.10.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib23.4.4.1" class="ltx_text" style="font-size:90%;">Matsuura and Harada [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib23.6.1" class="ltx_text" style="font-size:90%;">
Toshihiko Matsuura and Tatsuya Harada.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.7.1" class="ltx_text" style="font-size:90%;">Domain generalization using a mixture of multiple latent domains.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.8.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib23.9.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial Intelligence</em><span id="bib.bib23.10.3" class="ltx_text" style="font-size:90%;">, pages 11749–11756, 2020.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib24.5.5.1" class="ltx_text" style="font-size:90%;">McMahan et al. [2017]</span></span>
<span class="ltx_bibblock"><span id="bib.bib24.7.1" class="ltx_text" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.8.1" class="ltx_text" style="font-size:90%;">Communication-efficient learning of deep networks from decentralized data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib24.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Artificial intelligence and statistics</em><span id="bib.bib24.11.3" class="ltx_text" style="font-size:90%;">, pages 1273–1282. PMLR, 2017.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib25.5.5.1" class="ltx_text" style="font-size:90%;">Meng et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib25.7.1" class="ltx_text" style="font-size:90%;">
Rang Meng, Xianfeng Li, Weijie Chen, Shicai Yang, Jie Song, Xinchao Wang, Lei Zhang, Mingli Song, Di Xie, and Shiliang Pu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.8.1" class="ltx_text" style="font-size:90%;">Attention diversification for domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib25.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">European conference on computer vision</em><span id="bib.bib25.11.3" class="ltx_text" style="font-size:90%;">, pages 322–340. Springer, 2022.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib26.5.5.1" class="ltx_text" style="font-size:90%;">Nguyen et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib26.7.1" class="ltx_text" style="font-size:90%;">
A Tuan Nguyen, Toan Tran, Yarin Gal, and Atilim Gunes Baydin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.8.1" class="ltx_text" style="font-size:90%;">Domain invariant representation learning with domain density transformations.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib26.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span id="bib.bib26.10.2" class="ltx_text" style="font-size:90%;">, 34:5264–5275, 2021.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib27.5.5.1" class="ltx_text" style="font-size:90%;">Nguyen et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib27.7.1" class="ltx_text" style="font-size:90%;">
A Tuan Nguyen, Philip Torr, and Ser Nam Lim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.8.1" class="ltx_text" style="font-size:90%;">Fedsr: A simple and effective domain generalization method for federated learning.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib27.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span id="bib.bib27.10.2" class="ltx_text" style="font-size:90%;">, 35:38831–38843, 2022.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib28.5.5.1" class="ltx_text" style="font-size:90%;">Petroni et al. [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib28.7.1" class="ltx_text" style="font-size:90%;">
Fabio Petroni, Tim Rocktäschel, Patrick Lewis, Anton Bakhtin, Yuxiang Wu, Alexander H Miller, and Sebastian Riedel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.8.1" class="ltx_text" style="font-size:90%;">Language models as knowledge bases?
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib28.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1909.01066</em><span id="bib.bib28.10.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib29.5.5.1" class="ltx_text" style="font-size:90%;">Poerner et al. [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib29.7.1" class="ltx_text" style="font-size:90%;">
Nina Poerner, Ulli Waltinger, and Hinrich Schütze.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.8.1" class="ltx_text" style="font-size:90%;">E-bert: Efficient-yet-effective entity embeddings for bert.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib29.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1911.03681</em><span id="bib.bib29.10.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib30.5.5.1" class="ltx_text" style="font-size:90%;">Radford et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib30.7.1" class="ltx_text" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.8.1" class="ltx_text" style="font-size:90%;">Learning transferable visual models from natural language supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib30.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">International conference on machine learning</em><span id="bib.bib30.11.3" class="ltx_text" style="font-size:90%;">, pages 8748–8763. PMLR, 2021.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib31.5.5.1" class="ltx_text" style="font-size:90%;">Rame et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib31.7.1" class="ltx_text" style="font-size:90%;">
Alexandre Rame, Corentin Dancette, and Matthieu Cord.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.8.1" class="ltx_text" style="font-size:90%;">Fishr: Invariant gradient variances for out-of-distribution generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib31.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</em><span id="bib.bib31.11.3" class="ltx_text" style="font-size:90%;">, pages 18347–18377, 2022.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib32.5.5.1" class="ltx_text" style="font-size:90%;">Shin et al. [2020]</span></span>
<span class="ltx_bibblock"><span id="bib.bib32.7.1" class="ltx_text" style="font-size:90%;">
Taylor Shin, Yasaman Razeghi, Robert L Logan IV, Eric Wallace, and Sameer Singh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.8.1" class="ltx_text" style="font-size:90%;">Autoprompt: Eliciting knowledge from language models with automatically generated prompts.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.9.1" class="ltx_text" style="font-size:90%;">pages 4222–4235, 2020.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib33.5.5.1" class="ltx_text" style="font-size:90%;">Shu et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib33.7.1" class="ltx_text" style="font-size:90%;">
Yang Shu, Xingzhuo Guo, Jialong Wu, Ximei Wang, Jianmin Wang, and Mingsheng Long.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.8.1" class="ltx_text" style="font-size:90%;">Clipood: Generalizing clip to out-of-distributions.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib33.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2302.00864</em><span id="bib.bib33.10.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib34.5.5.1" class="ltx_text" style="font-size:90%;">Snell et al. [2017]</span></span>
<span class="ltx_bibblock"><span id="bib.bib34.7.1" class="ltx_text" style="font-size:90%;">
Jake Snell, Kevin Swersky, and Richard S. Zemel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.8.1" class="ltx_text" style="font-size:90%;">Prototypical networks for few-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib34.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</em><span id="bib.bib34.11.3" class="ltx_text" style="font-size:90%;">, pages 4077–4087, 2017.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib35.5.5.1" class="ltx_text" style="font-size:90%;">Tenison et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib35.7.1" class="ltx_text" style="font-size:90%;">
Irene Tenison, Sai Aravind Sreeramadas, Vaikkunth Mugunthan, Edouard Oyallon, Eugene Belilovsky, and Irina Rish.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.8.1" class="ltx_text" style="font-size:90%;">Gradient masked averaging for federated learning.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib35.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2201.11986</em><span id="bib.bib35.10.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib36.5.5.1" class="ltx_text" style="font-size:90%;">Venkateswara et al. [2017]</span></span>
<span class="ltx_bibblock"><span id="bib.bib36.7.1" class="ltx_text" style="font-size:90%;">
Hemanth Venkateswara, Jose Eusebio, Shayok Chakraborty, and Sethuraman Panchanathan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.8.1" class="ltx_text" style="font-size:90%;">Deep hashing network for unsupervised domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib36.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</em><span id="bib.bib36.11.3" class="ltx_text" style="font-size:90%;">, pages 5018–5027, 2017.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib37.5.5.1" class="ltx_text" style="font-size:90%;">Wang et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib37.7.1" class="ltx_text" style="font-size:90%;">
Qi Wang, Sikai Bai, Junyu Gao, Yuan Yuan, and Xuelong Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.8.1" class="ltx_text" style="font-size:90%;">Unsupervised domain adaptive learning via synthetic data for person re-identification.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib37.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2109.05542</em><span id="bib.bib37.10.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib38.5.5.1" class="ltx_text" style="font-size:90%;">Yang et al. [2019]</span></span>
<span class="ltx_bibblock"><span id="bib.bib38.7.1" class="ltx_text" style="font-size:90%;">
Qiang Yang, Yang Liu, Tianjian Chen, and Yongxin Tong.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.8.1" class="ltx_text" style="font-size:90%;">Federated machine learning: Concept and applications.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib38.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">ACM Transactions on Intelligent Systems and Technology (TIST)</em><span id="bib.bib38.10.2" class="ltx_text" style="font-size:90%;">, 10(2):1–19, 2019.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib39.5.5.1" class="ltx_text" style="font-size:90%;">Yao et al. [2023]</span></span>
<span class="ltx_bibblock"><span id="bib.bib39.7.1" class="ltx_text" style="font-size:90%;">
Hantao Yao, Rui Zhang, and Changsheng Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.8.1" class="ltx_text" style="font-size:90%;">Visual-language prompt tuning with knowledge-guided context optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib39.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span id="bib.bib39.11.3" class="ltx_text" style="font-size:90%;">, pages 6757–6767, 2023.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib40.5.5.1" class="ltx_text" style="font-size:90%;">Yao et al. [2022]</span></span>
<span class="ltx_bibblock"><span id="bib.bib40.7.1" class="ltx_text" style="font-size:90%;">
Xufeng Yao, Yang Bai, Xinyun Zhang, Yuechen Zhang, Qi Sun, Ran Chen, Ruiyu Li, and Bei Yu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.8.1" class="ltx_text" style="font-size:90%;">Pcl: Proxy-based contrastive learning for domain generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib40.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span id="bib.bib40.11.3" class="ltx_text" style="font-size:90%;">, pages 7097–7107, 2022.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib41.5.5.1" class="ltx_text" style="font-size:90%;">Zhang et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib41.7.1" class="ltx_text" style="font-size:90%;">
Liling Zhang, Xinyu Lei, Yichun Shi, Hongyu Huang, and Chao Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.8.1" class="ltx_text" style="font-size:90%;">Federated learning with domain generalization.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib41.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2111.10487</em><span id="bib.bib41.10.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib42.5.5.1" class="ltx_text" style="font-size:90%;">Zhou et al. [2021]</span></span>
<span class="ltx_bibblock"><span id="bib.bib42.7.1" class="ltx_text" style="font-size:90%;">
Kaiyang Zhou, Yongxin Yang, Yu Qiao, and Tao Xiang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.8.1" class="ltx_text" style="font-size:90%;">Domain generalization with mixstyle.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib42.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2104.02008</em><span id="bib.bib42.10.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib43.5.5.1" class="ltx_text" style="font-size:90%;">Zhou et al. [2022a]</span></span>
<span class="ltx_bibblock"><span id="bib.bib43.7.1" class="ltx_text" style="font-size:90%;">
Kaiyang Zhou, Ziwei Liu, Yu Qiao, Tao Xiang, and Chen Change Loy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.8.1" class="ltx_text" style="font-size:90%;">Domain generalization: A survey.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib43.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">IEEE Transactions on Pattern Analysis and Machine Intelligence</em><span id="bib.bib43.10.2" class="ltx_text" style="font-size:90%;">, 2022a.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib44.5.5.1" class="ltx_text" style="font-size:90%;">Zhou et al. [2022b]</span></span>
<span class="ltx_bibblock"><span id="bib.bib44.7.1" class="ltx_text" style="font-size:90%;">
Kaiyang Zhou, Jingkang Yang, Chen Change Loy, and Ziwei Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.8.1" class="ltx_text" style="font-size:90%;">Conditional prompt learning for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.9.1" class="ltx_text" style="font-size:90%;">In </span><em id="bib.bib44.10.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em><span id="bib.bib44.11.3" class="ltx_text" style="font-size:90%;">, pages 16816–16825, 2022b.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span id="bib.bib45.5.5.1" class="ltx_text" style="font-size:90%;">Zhou et al. [2022c]</span></span>
<span class="ltx_bibblock"><span id="bib.bib45.7.1" class="ltx_text" style="font-size:90%;">
Kaiyang Zhou, Jingkang Yang, Chen Change Loy, and Ziwei Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.8.1" class="ltx_text" style="font-size:90%;">Learning to prompt for vision-language models.
</span>
</span>
<span class="ltx_bibblock"><em id="bib.bib45.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">International Journal of Computer Vision</em><span id="bib.bib45.10.2" class="ltx_text" style="font-size:90%;">, 130(9):2337–2348, 2022c.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.08505" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.08506" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.08506">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.08506" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.08507" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 14:55:32 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
