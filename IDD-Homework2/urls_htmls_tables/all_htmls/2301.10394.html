<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2301.10394] Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning</title><meta property="og:description" content="Federated Learning (FL) has become a popular distributed learning paradigm that involves multiple clients training a global model collaboratively in a data privacy-preserving manner. However, the data samples usually f…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2301.10394">

<!--Generated on Fri Mar  1 05:45:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wenkai Yang<sup id="id10.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Deli Chen<sup id="id11.2.id1" class="ltx_sup">2</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hao Zhou<sup id="id12.2.id1" class="ltx_sup"><span id="id12.2.id1.1" class="ltx_text ltx_font_italic">2</span></sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fandong Meng<sup id="id13.2.id1" class="ltx_sup"><span id="id13.2.id1.1" class="ltx_text ltx_font_italic">2</span></sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jie Zhou<sup id="id14.6.id1" class="ltx_sup"><span id="id14.6.id1.1" class="ltx_text ltx_font_italic">2</span></sup>
&amp;Xu Sun<sup id="id15.7.id2" class="ltx_sup"><span id="id15.7.id2.1" class="ltx_text ltx_font_italic">3</span></sup>
<sup id="id16.8.id3" class="ltx_sup">1</sup>Center for Data Science, Peking University
<br class="ltx_break"><sup id="id17.9.id4" class="ltx_sup">2</sup>Pattern Recognition Center, WeChat AI, Tencent Inc., China
<br class="ltx_break"><sup id="id18.10.id5" class="ltx_sup">3</sup>MOE Key Lab of Computational Linguistics, School of Computer Science, Peking University
wkyang@stu.pku.edu.cn,
xusun@pku.edu.cn,
<br class="ltx_break">{delichen, tuxzhou, fandongmeng, withtomzhou}@tencent.com
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id19.id1" class="ltx_p">Federated Learning (FL) has become a popular distributed learning paradigm that involves multiple clients training a global model collaboratively in a data privacy-preserving manner. However, the data samples usually follow a long-tailed distribution in the real world, and FL on the decentralized and long-tailed data yields a poorly-behaved global model severely biased to the head classes with the majority of the training samples.
To alleviate this issue, decoupled training has recently been introduced to FL, considering it has achieved promising results in centralized long-tailed learning by re-balancing the biased classifier after the instance-balanced training.
However, the current study restricts the capacity of decoupled training in federated long-tailed learning with a sub-optimal classifier re-trained on a set of pseudo features, due to the unavailability of a global balanced dataset in FL.
In this work, in order to re-balance the classifier more effectively,
we integrate the local real data with the global gradient prototypes to form the local balanced datasets, and thus re-balance the classifier during the local training.
Furthermore, we introduce an extra classifier in the training phase to help model the global data distribution, which addresses the problem of contradictory optimization goals caused by performing classifier re-balancing locally.
Extensive experiments show that our method consistently outperforms the existing state-of-the-art methods in various settings.
</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> is proposed as an effective distributed learning framework to enable local clients to collaboratively train a global model without exposing their local private data to each other. In the real world, there are two data distribution phenomena that introduce great challenges to the good convergence of FL algorithms. One is that the data samples are not identically and independently distributed (non-i.i.d.) across different clients. Furthermore, the other important phenomenon is that the global data distribution (i.e., the data distribution of the training samples merged from all clients’ local data) usually shows a long-tailed/class-imbalanced pattern <cite class="ltx_cite ltx_citemacro_cite">Zhang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite>, where head classes occupy a much larger proportion of the training samples than tail classes. Directly applying FL on such long-tailed data will produce a global model with poor generalization ability that is severely biased to the head classes <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. However, it is challenging to deal with FL on the non-i.i.d. and long-tailed data due to two aspects. <span id="S1.p1.1.1" class="ltx_text ltx_font_bold">First</span>, affected by the non-i.i.d. data partitions, the local data distributions (i.e., local imbalance) show inconsistent long-tailed patterns with that of the global data distribution (i.e., global imbalance) <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. Thus, tackling the local imbalance problem only (e.g., Fed-Focal Loss <cite class="ltx_cite ltx_citemacro_cite">Sarkar <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>) will not help to address the global imbalance problem in FL. <span id="S1.p1.1.2" class="ltx_text ltx_font_bold">Second</span>, considering the data privacy concern, it is infeasible to obtain the imbalance pattern of the global data distribution from the local data information. This further limits the application of the global class re-weighting strategy <cite class="ltx_cite ltx_citemacro_cite">Cui <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To deal with the above problems, some existing studies manage to estimate the global imbalance pattern by utilizing either the uploaded gradients w.r.t. the classifier <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite> or the values of local training losses <cite class="ltx_cite ltx_citemacro_cite">Shen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite>. They then apply the class-level <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite> or client-level <cite class="ltx_cite ltx_citemacro_cite">Shen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> re-weighting practice to focus more on the gradients contributed by tail classes or poorly-learned clients. However, previous studies <cite class="ltx_cite ltx_citemacro_cite">Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2019</a>); Zhou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib27" title="" class="ltx_ref">2020</a>)</cite> have shown that the re-weighting practice will do harm to the representation learning phase. Therefore, the improvement brought by this kind of method is limited.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recently, some centralized long-tailed learning studies <cite class="ltx_cite ltx_citemacro_cite">Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2019</a>); Zhou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib27" title="" class="ltx_ref">2020</a>)</cite> manage to decouple the model learning on long-tailed data into the representation learning phase and the classifier learning phase, and find that the instance-balanced training (i.e., uniform sampling on the entire training set to make the contribution of each sample the same) leads to the well-learned representations but a biased classifier. Therefore, centralized decoupled training aims re-train the classifier on a small balanced dataset after the instance-balanced training, and has achieved very promising results. However, decoupled training is difficult to be implemented in FL due to the lack of a public balanced dataset. Then, CReFF <cite class="ltx_cite ltx_citemacro_cite">Shang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>)</cite> proposes to re-train the classifier on a set of pseudo features created on the server.
Nevertheless, the improvement brought by CReFF is restricted by the high similarity of the pseudo features per class, and the fundamental problem – lack of real balanced data still exists.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To better solve the lack of the real balanced data issue in the application of decoupled training in FL, we propose a different yet more effective classifier re-balancing algorithm, and achieve state-of-the-art results in federated long-tailed learning. That is,
we choose to take full advantage of the abundant real data stored in the local clients, and allow the clients to re-balance the classifier during local training. Specifically, we make each client re-balance the classifier on a local balanced dataset that is mixed with the local real data and the global gradient prototypes of the classifier sent by the server, while the latter is supposed to address the issue of missing classes in the local datasets.
Additionally, we add an extra classifier in the local training phase to jointly model the global data distribution. This practice helps to overcome the optimization difficulty on the global representation learning brought by the practice of local classifier re-balancing.
Compared with CReFF, we allow the clients to collaboratively train a balanced classifier with their sufficient real data during local training, which needs no extra requirements on the server and produces an optimal classifier with better generalization ability. We conduct extensive experiments on the three popular long-tailed image classification tasks, and the results show that our method can significantly outperform all existing federated long-tailed learning methods in various settings.
</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> is the most widely-used FL algorithm, but it has been shown that the performance of FedAvg drops greatly when the data is non-i.i.d. <cite class="ltx_cite ltx_citemacro_cite">Karimireddy <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>. Therefore, plenty of existing FL studies target on dealing with the non-i.i.d. data partitions in FL. For example, FedProx <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib15" title="" class="ltx_ref">2018</a>)</cite> and FedDyn <cite class="ltx_cite ltx_citemacro_cite">Acar <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite> manage to make the local models converge to the same global optimum by adding the regularization terms in the local training objectives, SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">Karimireddy <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite> chooses to correct the local gradient in each step with the gradients from other clients to reduce the gradient variance across different clients. FedAvgM <cite class="ltx_cite ltx_citemacro_cite">Hsu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> and FedOPT <cite class="ltx_cite ltx_citemacro_cite">Reddi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite> adopt the server momentum and the adaptive server optimizer in the server aggregation phase.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Long-Tailed/Imbalanced Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">In the real world, the data points usually show a long-tailed distribution pattern.
Therefore, learning good models on the long-tailed/class-imbalanced data has been widely studied <cite class="ltx_cite ltx_citemacro_cite">Zhang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite> in the traditional centralized learning, and attracts more and more attention in the FL setting.</p>
</div>
<section id="S2.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Centralized Long-Tailed Learning</h5>

<div id="S2.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS2.SSS0.Px1.p1.1" class="ltx_p">The methods to tackle the class imbalance problem in the centralized long-tailed learning can be mainly divided into three categories: (1) <span id="S2.SS2.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_bold">Class-level re-balancing methods</span> that includes over-sampling training samples from tail classes <cite class="ltx_cite ltx_citemacro_cite">Chawla <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2002</a>)</cite>, under-sampling data points from head classes <cite class="ltx_cite ltx_citemacro_cite">Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2008</a>)</cite>, or re-weighting the loss values or the gradients of different training samples based on the label frequencies <cite class="ltx_cite ltx_citemacro_cite">Cui <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2019</a>); Cao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite> or the predicted probabilities of the model <cite class="ltx_cite ltx_citemacro_cite">Lin <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite>. (2) <span id="S2.SS2.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_bold">Augmentation-based methods</span> aim to create more data samples for tail classes either from the perspective of the feature space <cite class="ltx_cite ltx_citemacro_cite">Chu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib5" title="" class="ltx_ref">2020</a>); Zang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite> or the sample space <cite class="ltx_cite ltx_citemacro_cite">Chou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite>. (3) <span id="S2.SS2.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_bold">Classifier re-balancing mechanisms</span> are based on the finding that the uniform sampling on the whole dataset during training benefits the representation learning but leads to a biased classifier, so they design specific algorithms to adjust the classifier during or after the representation learning phase <cite class="ltx_cite ltx_citemacro_cite">Zhou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib27" title="" class="ltx_ref">2020</a>); Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Federated Long-Tailed Learning</h5>

<div id="S2.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS2.SSS0.Px2.p1.1" class="ltx_p">Recently, a few studies begin to focus on the class imbalance problem in FL, as FL becomes a more practical and popular learning paradigm and the long-tailed data distribution is unavoidable in the real world. Fed-Focal Loss <cite class="ltx_cite ltx_citemacro_cite">Sarkar <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite> directly applies Focal Loss <cite class="ltx_cite ltx_citemacro_cite">Lin <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite> in the clients’ local training, but it neglects the fact that the local imbalance pattern is inconsistent with the global imbalance pattern. Ratio Loss <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite> utilizes an auxiliary dataset on the server (which is usually impractical in real cases) to estimate the global data distribution, and send the estimated information to clients to perform class-level re-weighting during local training. CLIMB <cite class="ltx_cite ltx_citemacro_cite">Shen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> is proposed as a client-level re-weighting method to give more aggregation weights to the clients with larger local training losses. However, both Ratio Loss and CLIMB bring negative effects to the representation learning caused by the re-weighting practice. FEDIC <cite class="ltx_cite ltx_citemacro_cite">Shang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib21" title="" class="ltx_ref">2022a</a>)</cite> also needs the impractical assumption to own an auxiliary balanced dataset for fine-tuning the global model on the server, and uses the fine-tuned model along with the local models as teachers to perform knowledge distillation on the original global model. Most recently, CReFF <cite class="ltx_cite ltx_citemacro_cite">Shang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>)</cite> adopts the decoupled training idea to re-train the classifier on the server by creating a number of federated features for each class, and achieves previously state-of-the-art performance. However, the low quality and the limited number of federated features restrict its potential.</p>
</div>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Definition</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.3" class="ltx_p">In the FL framework, each client <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">k</annotation></semantics></math> (<math id="S3.SS1.p1.2.m2.3" class="ltx_Math" alttext="k=1,\cdots,N" display="inline"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.4" xref="S3.SS1.p1.2.m2.3.4.cmml"><mi id="S3.SS1.p1.2.m2.3.4.2" xref="S3.SS1.p1.2.m2.3.4.2.cmml">k</mi><mo id="S3.SS1.p1.2.m2.3.4.1" xref="S3.SS1.p1.2.m2.3.4.1.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.3.4.3.2" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml"><mn id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS1.p1.2.m2.3.4.3.2.1" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml">⋯</mi><mo id="S3.SS1.p1.2.m2.3.4.3.2.2" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><apply id="S3.SS1.p1.2.m2.3.4.cmml" xref="S3.SS1.p1.2.m2.3.4"><eq id="S3.SS1.p1.2.m2.3.4.1.cmml" xref="S3.SS1.p1.2.m2.3.4.1"></eq><ci id="S3.SS1.p1.2.m2.3.4.2.cmml" xref="S3.SS1.p1.2.m2.3.4.2">𝑘</ci><list id="S3.SS1.p1.2.m2.3.4.3.1.cmml" xref="S3.SS1.p1.2.m2.3.4.3.2"><cn type="integer" id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">1</cn><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">⋯</ci><ci id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">k=1,\cdots,N</annotation></semantics></math>) has its own local dataset <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝒟</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{D}_{k}</annotation></semantics></math>, and all clients form a federation to jointly train a good global model under the constraint that the local data is always kept in the local devices. Then, the optimization goal of FL can be formulated as</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<div id="S3.E1.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_transformed_outer" style="width:418.1pt;height:60.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(109.1pt,-15.7pt) scale(2.09162774805074,2.09162774805074) ;">
<p id="S3.E1.m1.1.1.1.1" class="ltx_p"><math id="S3.E1.m1.1.1.1.1.m1.5" class="ltx_Math" alttext="\begin{aligned} \boldsymbol{\theta}^{*}=\mathop{\arg\min}\limits_{\boldsymbol{\theta}}L(\boldsymbol{\theta})=\mathop{\arg\min}\limits_{\boldsymbol{\theta}}\sum_{k=1}^{N}\frac{|\mathcal{D}_{k}|}{\sum_{i=1}^{N}|\mathcal{D}_{i}|}L(\boldsymbol{\theta};\mathcal{D}_{k}),\end{aligned}" display="inline"><semantics id="S3.E1.m1.1.1.1.1.m1.5a"><mtable id="S3.E1.m1.1.1.1.1.m1.5.5" xref="S3.E1.m1.1.1.1.1.m1.5.5.cmml"><mtr id="S3.E1.m1.1.1.1.1.m1.5.5a" xref="S3.E1.m1.1.1.1.1.m1.5.5.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.1.1.1.1.m1.5.5b" xref="S3.E1.m1.1.1.1.1.m1.5.5.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.cmml"><msup id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.2.cmml">𝜽</mi><mo id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.3.cmml">∗</mo></msup><mo id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.4" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.4.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.cmml"><munder id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2a" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.cmml">⁡</mo><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.2.cmml">min</mi></mrow><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.3.cmml">𝜽</mi></munder><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.1.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.3.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.3.2.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.3.3" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.3.3.cmml">𝜽</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.3.2.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.6" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.6.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.cmml"><munder id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2a" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.cmml">⁡</mo><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.2.cmml">min</mi></mrow><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.3.cmml">𝜽</mi></munder><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml"><mfrac id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2a" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.cmml"><msubsup id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.1" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.3" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.3.cmml">N</mi></msubsup><mrow id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.2.cmml"><mo lspace="0em" stretchy="false" id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.2.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.2.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.m1.4.4.4.4.4.4" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.4.4.4.cmml">𝜽</mi><mo id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.2" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1.1.1.1.m1.5b"><matrix id="S3.E1.m1.1.1.1.1.m1.5.5.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5"><matrixrow id="S3.E1.m1.1.1.1.1.m1.5.5a.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5"><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5"><and id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1a.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5"></and><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1b.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5"><eq id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.4.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.4"></eq><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.2">𝜽</ci><times id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.3.3"></times></apply><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5"><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2"><arg id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.1"></arg><min id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.2.2"></min></apply><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.1.3">𝜽</ci></apply><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2"><times id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.1"></times><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.2.2">𝐿</ci><ci id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.3.3">𝜽</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1c.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5"><eq id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.6.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.6"></eq><share href="#S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.5.cmml" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1d.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5"></share><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1"><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2"><arg id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.1"></arg><min id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.2.2"></min></apply><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.2.3">𝜽</ci></apply><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1"><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2"><divide id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2"></divide><apply id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1"><abs id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3"><eq id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1"><abs id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2"></abs><apply id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.2">𝒟</ci><ci id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.3">𝐿</ci><list id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1"><ci id="S3.E1.m1.1.1.1.1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.4.4.4">𝜽</ci><apply id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.5.5.5.5.1.1.1.1.1.1.1.3">𝑘</ci></apply></list></apply></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1.1.1.1.m1.5c">\begin{aligned} \boldsymbol{\theta}^{*}=\mathop{\arg\min}\limits_{\boldsymbol{\theta}}L(\boldsymbol{\theta})=\mathop{\arg\min}\limits_{\boldsymbol{\theta}}\sum_{k=1}^{N}\frac{|\mathcal{D}_{k}|}{\sum_{i=1}^{N}|\mathcal{D}_{i}|}L(\boldsymbol{\theta};\mathcal{D}_{k}),\end{aligned}</annotation></semantics></math></p>
</span></div>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="0" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.7" class="ltx_p">where <math id="S3.SS1.p1.4.m1.1" class="ltx_Math" alttext="|\mathcal{D}_{k}|" display="inline"><semantics id="S3.SS1.p1.4.m1.1a"><mrow id="S3.SS1.p1.4.m1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m1.1.1.1.2" xref="S3.SS1.p1.4.m1.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.4.m1.1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m1.1.1.1.1.2" xref="S3.SS1.p1.4.m1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.4.m1.1.1.1.1.3" xref="S3.SS1.p1.4.m1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS1.p1.4.m1.1.1.1.3" xref="S3.SS1.p1.4.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m1.1b"><apply id="S3.SS1.p1.4.m1.1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.1.1"><abs id="S3.SS1.p1.4.m1.1.1.2.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.2"></abs><apply id="S3.SS1.p1.4.m1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1.2">𝒟</ci><ci id="S3.SS1.p1.4.m1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m1.1c">|\mathcal{D}_{k}|</annotation></semantics></math> represents the total number of training samples in <math id="S3.SS1.p1.5.m2.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p1.5.m2.1a"><msub id="S3.SS1.p1.5.m2.1.1" xref="S3.SS1.p1.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m2.1.1.2" xref="S3.SS1.p1.5.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.5.m2.1.1.3" xref="S3.SS1.p1.5.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m2.1b"><apply id="S3.SS1.p1.5.m2.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m2.1.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m2.1.1.2.cmml" xref="S3.SS1.p1.5.m2.1.1.2">𝒟</ci><ci id="S3.SS1.p1.5.m2.1.1.3.cmml" xref="S3.SS1.p1.5.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m2.1c">\mathcal{D}_{k}</annotation></semantics></math>, and <math id="S3.SS1.p1.6.m3.2" class="ltx_Math" alttext="L(\cdot;\mathcal{D}_{k})" display="inline"><semantics id="S3.SS1.p1.6.m3.2a"><mrow id="S3.SS1.p1.6.m3.2.2" xref="S3.SS1.p1.6.m3.2.2.cmml"><mi id="S3.SS1.p1.6.m3.2.2.3" xref="S3.SS1.p1.6.m3.2.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m3.2.2.2" xref="S3.SS1.p1.6.m3.2.2.2.cmml">​</mo><mrow id="S3.SS1.p1.6.m3.2.2.1.1" xref="S3.SS1.p1.6.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m3.2.2.1.1.2" xref="S3.SS1.p1.6.m3.2.2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m3.1.1" xref="S3.SS1.p1.6.m3.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.6.m3.2.2.1.1.3" xref="S3.SS1.p1.6.m3.2.2.1.2.cmml">;</mo><msub id="S3.SS1.p1.6.m3.2.2.1.1.1" xref="S3.SS1.p1.6.m3.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m3.2.2.1.1.1.2" xref="S3.SS1.p1.6.m3.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.6.m3.2.2.1.1.1.3" xref="S3.SS1.p1.6.m3.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS1.p1.6.m3.2.2.1.1.4" xref="S3.SS1.p1.6.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m3.2b"><apply id="S3.SS1.p1.6.m3.2.2.cmml" xref="S3.SS1.p1.6.m3.2.2"><times id="S3.SS1.p1.6.m3.2.2.2.cmml" xref="S3.SS1.p1.6.m3.2.2.2"></times><ci id="S3.SS1.p1.6.m3.2.2.3.cmml" xref="S3.SS1.p1.6.m3.2.2.3">𝐿</ci><list id="S3.SS1.p1.6.m3.2.2.1.2.cmml" xref="S3.SS1.p1.6.m3.2.2.1.1"><ci id="S3.SS1.p1.6.m3.1.1.cmml" xref="S3.SS1.p1.6.m3.1.1">⋅</ci><apply id="S3.SS1.p1.6.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.6.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.6.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.6.m3.2.2.1.1.1.2">𝒟</ci><ci id="S3.SS1.p1.6.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.6.m3.2.2.1.1.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m3.2c">L(\cdot;\mathcal{D}_{k})</annotation></semantics></math> is the local training objective in client <math id="S3.SS1.p1.7.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.7.m4.1a"><mi id="S3.SS1.p1.7.m4.1.1" xref="S3.SS1.p1.7.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m4.1b"><ci id="S3.SS1.p1.7.m4.1.1.cmml" xref="S3.SS1.p1.7.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m4.1c">k</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.8" class="ltx_p">Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> is the most popular FL framework to solve the above optimization problem. Specifically, at the beginning of each communication round <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">t</annotation></semantics></math>, the server sends the updated global model <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\boldsymbol{\theta}^{t-1}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msup id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">𝜽</mi><mrow id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p2.2.m2.1.1.3.1" xref="S3.SS1.p2.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝜽</ci><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><minus id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3.1"></minus><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\boldsymbol{\theta}^{t-1}</annotation></semantics></math> from the last round to all available/sampled clients <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="k\in\mathcal{C}^{t}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">k</mi><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">𝒞</mi><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><in id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></in><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑘</ci><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">𝒞</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">k\in\mathcal{C}^{t}</annotation></semantics></math> in the current round, and each client <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">k</annotation></semantics></math> takes <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="\boldsymbol{\theta}^{t-1}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msup id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">𝜽</mi><mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p2.5.m5.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝜽</ci><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><minus id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1"></minus><ci id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\boldsymbol{\theta}^{t-1}</annotation></semantics></math> as the initial model to perform multiple updates on its local dataset <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝒟</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathcal{D}_{k}</annotation></semantics></math> and gets the new model <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="\boldsymbol{\theta}^{t}_{k}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><msubsup id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2.2" xref="S3.SS1.p2.7.m7.1.1.2.2.cmml">𝜽</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">k</mi><mi id="S3.SS1.p2.7.m7.1.1.2.3" xref="S3.SS1.p2.7.m7.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><apply id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2.2">𝜽</ci><ci id="S3.SS1.p2.7.m7.1.1.2.3.cmml" xref="S3.SS1.p2.7.m7.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\boldsymbol{\theta}^{t}_{k}</annotation></semantics></math>. Then the clients will only send the accumulated gradients <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="\boldsymbol{g}^{t}_{k}=\boldsymbol{\theta}^{t-1}-\boldsymbol{\theta}^{t}_{k}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><msubsup id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2.2.2" xref="S3.SS1.p2.8.m8.1.1.2.2.2.cmml">𝒈</mi><mi id="S3.SS1.p2.8.m8.1.1.2.3" xref="S3.SS1.p2.8.m8.1.1.2.3.cmml">k</mi><mi id="S3.SS1.p2.8.m8.1.1.2.2.3" xref="S3.SS1.p2.8.m8.1.1.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS1.p2.8.m8.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml"><msup id="S3.SS1.p2.8.m8.1.1.3.2" xref="S3.SS1.p2.8.m8.1.1.3.2.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.2.2" xref="S3.SS1.p2.8.m8.1.1.3.2.2.cmml">𝜽</mi><mrow id="S3.SS1.p2.8.m8.1.1.3.2.3" xref="S3.SS1.p2.8.m8.1.1.3.2.3.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.2.3.2" xref="S3.SS1.p2.8.m8.1.1.3.2.3.2.cmml">t</mi><mo id="S3.SS1.p2.8.m8.1.1.3.2.3.1" xref="S3.SS1.p2.8.m8.1.1.3.2.3.1.cmml">−</mo><mn id="S3.SS1.p2.8.m8.1.1.3.2.3.3" xref="S3.SS1.p2.8.m8.1.1.3.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS1.p2.8.m8.1.1.3.1" xref="S3.SS1.p2.8.m8.1.1.3.1.cmml">−</mo><msubsup id="S3.SS1.p2.8.m8.1.1.3.3" xref="S3.SS1.p2.8.m8.1.1.3.3.cmml"><mi id="S3.SS1.p2.8.m8.1.1.3.3.2.2" xref="S3.SS1.p2.8.m8.1.1.3.3.2.2.cmml">𝜽</mi><mi id="S3.SS1.p2.8.m8.1.1.3.3.3" xref="S3.SS1.p2.8.m8.1.1.3.3.3.cmml">k</mi><mi id="S3.SS1.p2.8.m8.1.1.3.3.2.3" xref="S3.SS1.p2.8.m8.1.1.3.3.2.3.cmml">t</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><eq id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1"></eq><apply id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.2">subscript</csymbol><apply id="S3.SS1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2.2">𝒈</ci><ci id="S3.SS1.p2.8.m8.1.1.2.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3"><minus id="S3.SS1.p2.8.m8.1.1.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.1"></minus><apply id="S3.SS1.p2.8.m8.1.1.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.3.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2.2">𝜽</ci><apply id="S3.SS1.p2.8.m8.1.1.3.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2.3"><minus id="S3.SS1.p2.8.m8.1.1.3.2.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2.3.1"></minus><ci id="S3.SS1.p2.8.m8.1.1.3.2.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.8.m8.1.1.3.2.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.8.m8.1.1.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.3.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3">subscript</csymbol><apply id="S3.SS1.p2.8.m8.1.1.3.3.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.2.2">𝜽</ci><ci id="S3.SS1.p2.8.m8.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.3.3.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\boldsymbol{g}^{t}_{k}=\boldsymbol{\theta}^{t-1}-\boldsymbol{\theta}^{t}_{k}</annotation></semantics></math> back to the server, the server aggregates the collected local gradients and updates the global model as the following:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\boldsymbol{\theta}^{t}=\boldsymbol{\theta}^{t-1}-\eta_{s}\frac{1}{|\mathcal{C}^{t}|}\sum\limits_{k\in\mathcal{C}^{t}}\frac{|\mathcal{D}_{k}|}{\sum_{i\in\mathcal{C}^{t}}|\mathcal{D}_{i}|}\boldsymbol{g}_{k}^{t}," display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><msup id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml"><mi id="S3.E2.m1.4.4.1.1.2.2" xref="S3.E2.m1.4.4.1.1.2.2.cmml">𝜽</mi><mi id="S3.E2.m1.4.4.1.1.2.3" xref="S3.E2.m1.4.4.1.1.2.3.cmml">t</mi></msup><mo id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml"><msup id="S3.E2.m1.4.4.1.1.3.2" xref="S3.E2.m1.4.4.1.1.3.2.cmml"><mi id="S3.E2.m1.4.4.1.1.3.2.2" xref="S3.E2.m1.4.4.1.1.3.2.2.cmml">𝜽</mi><mrow id="S3.E2.m1.4.4.1.1.3.2.3" xref="S3.E2.m1.4.4.1.1.3.2.3.cmml"><mi id="S3.E2.m1.4.4.1.1.3.2.3.2" xref="S3.E2.m1.4.4.1.1.3.2.3.2.cmml">t</mi><mo id="S3.E2.m1.4.4.1.1.3.2.3.1" xref="S3.E2.m1.4.4.1.1.3.2.3.1.cmml">−</mo><mn id="S3.E2.m1.4.4.1.1.3.2.3.3" xref="S3.E2.m1.4.4.1.1.3.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.E2.m1.4.4.1.1.3.1" xref="S3.E2.m1.4.4.1.1.3.1.cmml">−</mo><mrow id="S3.E2.m1.4.4.1.1.3.3" xref="S3.E2.m1.4.4.1.1.3.3.cmml"><msub id="S3.E2.m1.4.4.1.1.3.3.2" xref="S3.E2.m1.4.4.1.1.3.3.2.cmml"><mi id="S3.E2.m1.4.4.1.1.3.3.2.2" xref="S3.E2.m1.4.4.1.1.3.3.2.2.cmml">η</mi><mi id="S3.E2.m1.4.4.1.1.3.3.2.3" xref="S3.E2.m1.4.4.1.1.3.3.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.3.3.1" xref="S3.E2.m1.4.4.1.1.3.3.1.cmml">​</mo><mfrac id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mn id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">1</mn><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><msup id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.3.3.1a" xref="S3.E2.m1.4.4.1.1.3.3.1.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.3.3.3" xref="S3.E2.m1.4.4.1.1.3.3.3.cmml"><munder id="S3.E2.m1.4.4.1.1.3.3.3.1" xref="S3.E2.m1.4.4.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.4.4.1.1.3.3.3.1.2" xref="S3.E2.m1.4.4.1.1.3.3.3.1.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.1.1.3.3.3.1.3" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.3.3.3.1.3.2" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.2.cmml">k</mi><mo id="S3.E2.m1.4.4.1.1.3.3.3.1.3.1" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.1.cmml">∈</mo><msup id="S3.E2.m1.4.4.1.1.3.3.3.1.3.3" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.2" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.2.cmml">𝒞</mi><mi id="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.3" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.3.cmml">t</mi></msup></mrow></munder><mrow id="S3.E2.m1.4.4.1.1.3.3.3.2" xref="S3.E2.m1.4.4.1.1.3.3.3.2.cmml"><mfrac id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.2.1.cmml">|</mo></mrow><mrow id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.2.cmml"><msub id="S3.E2.m1.3.3.2.2" xref="S3.E2.m1.3.3.2.2.cmml"><mo id="S3.E2.m1.3.3.2.2.2" xref="S3.E2.m1.3.3.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.2.2.3" xref="S3.E2.m1.3.3.2.2.3.cmml"><mi id="S3.E2.m1.3.3.2.2.3.2" xref="S3.E2.m1.3.3.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.3.3.2.2.3.1" xref="S3.E2.m1.3.3.2.2.3.1.cmml">∈</mo><msup id="S3.E2.m1.3.3.2.2.3.3" xref="S3.E2.m1.3.3.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.2.2.3.3.2" xref="S3.E2.m1.3.3.2.2.3.3.2.cmml">𝒞</mi><mi id="S3.E2.m1.3.3.2.2.3.3.3" xref="S3.E2.m1.3.3.2.2.3.3.3.cmml">t</mi></msup></mrow></msub><mrow id="S3.E2.m1.3.3.2.1.1" xref="S3.E2.m1.3.3.2.1.2.cmml"><mo lspace="0em" stretchy="false" id="S3.E2.m1.3.3.2.1.1.2" xref="S3.E2.m1.3.3.2.1.2.1.cmml">|</mo><msub id="S3.E2.m1.3.3.2.1.1.1" xref="S3.E2.m1.3.3.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.2.1.1.1.2" xref="S3.E2.m1.3.3.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E2.m1.3.3.2.1.1.1.3" xref="S3.E2.m1.3.3.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.3.3.2.1.1.3" xref="S3.E2.m1.3.3.2.1.2.1.cmml">|</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.3.3.3.2.1" xref="S3.E2.m1.4.4.1.1.3.3.3.2.1.cmml">​</mo><msubsup id="S3.E2.m1.4.4.1.1.3.3.3.2.2" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2.cmml"><mi id="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.2" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.2.cmml">𝒈</mi><mi id="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.3" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.3.cmml">k</mi><mi id="S3.E2.m1.4.4.1.1.3.3.3.2.2.3" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1"><eq id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"></eq><apply id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.2">superscript</csymbol><ci id="S3.E2.m1.4.4.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.2.2">𝜽</ci><ci id="S3.E2.m1.4.4.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.2.3">𝑡</ci></apply><apply id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"><minus id="S3.E2.m1.4.4.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.1"></minus><apply id="S3.E2.m1.4.4.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.2.1.cmml" xref="S3.E2.m1.4.4.1.1.3.2">superscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.2.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2.2">𝜽</ci><apply id="S3.E2.m1.4.4.1.1.3.2.3.cmml" xref="S3.E2.m1.4.4.1.1.3.2.3"><minus id="S3.E2.m1.4.4.1.1.3.2.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.2.3.1"></minus><ci id="S3.E2.m1.4.4.1.1.3.2.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.3.2.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.4.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3"><times id="S3.E2.m1.4.4.1.1.3.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.1"></times><apply id="S3.E2.m1.4.4.1.1.3.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.3.2.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.2">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.3.2.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.2.2">𝜂</ci><ci id="S3.E2.m1.4.4.1.1.3.3.2.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3.2.3">𝑠</ci></apply><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><divide id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1"></divide><cn type="integer" id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">1</cn><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2"></abs><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝒞</ci><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m1.4.4.1.1.3.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3"><apply id="S3.E2.m1.4.4.1.1.3.3.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.3.3.1.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E2.m1.4.4.1.1.3.3.3.1.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1.2"></sum><apply id="S3.E2.m1.4.4.1.1.3.3.3.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3"><in id="S3.E2.m1.4.4.1.1.3.3.3.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.1"></in><ci id="S3.E2.m1.4.4.1.1.3.3.3.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.2">𝑘</ci><apply id="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.3">superscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.2">𝒞</ci><ci id="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m1.4.4.1.1.3.3.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2"><times id="S3.E2.m1.4.4.1.1.3.3.3.2.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2.1"></times><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><divide id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3"></divide><apply id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.1"><abs id="S3.E2.m1.2.2.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2"></abs><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2">𝒟</ci><ci id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2"><apply id="S3.E2.m1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.1.cmml" xref="S3.E2.m1.3.3.2.2">subscript</csymbol><sum id="S3.E2.m1.3.3.2.2.2.cmml" xref="S3.E2.m1.3.3.2.2.2"></sum><apply id="S3.E2.m1.3.3.2.2.3.cmml" xref="S3.E2.m1.3.3.2.2.3"><in id="S3.E2.m1.3.3.2.2.3.1.cmml" xref="S3.E2.m1.3.3.2.2.3.1"></in><ci id="S3.E2.m1.3.3.2.2.3.2.cmml" xref="S3.E2.m1.3.3.2.2.3.2">𝑖</ci><apply id="S3.E2.m1.3.3.2.2.3.3.cmml" xref="S3.E2.m1.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.3.3.1.cmml" xref="S3.E2.m1.3.3.2.2.3.3">superscript</csymbol><ci id="S3.E2.m1.3.3.2.2.3.3.2.cmml" xref="S3.E2.m1.3.3.2.2.3.3.2">𝒞</ci><ci id="S3.E2.m1.3.3.2.2.3.3.3.cmml" xref="S3.E2.m1.3.3.2.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m1.3.3.2.1.2.cmml" xref="S3.E2.m1.3.3.2.1.1"><abs id="S3.E2.m1.3.3.2.1.2.1.cmml" xref="S3.E2.m1.3.3.2.1.1.2"></abs><apply id="S3.E2.m1.3.3.2.1.1.1.cmml" xref="S3.E2.m1.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.1.1.1.1.cmml" xref="S3.E2.m1.3.3.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.2.1.1.1.2.cmml" xref="S3.E2.m1.3.3.2.1.1.1.2">𝒟</ci><ci id="S3.E2.m1.3.3.2.1.1.1.3.cmml" xref="S3.E2.m1.3.3.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E2.m1.4.4.1.1.3.3.3.2.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.3.3.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2">superscript</csymbol><apply id="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.2">𝒈</ci><ci id="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2.2.3">𝑘</ci></apply><ci id="S3.E2.m1.4.4.1.1.3.3.3.2.2.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3.2.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\boldsymbol{\theta}^{t}=\boldsymbol{\theta}^{t-1}-\eta_{s}\frac{1}{|\mathcal{C}^{t}|}\sum\limits_{k\in\mathcal{C}^{t}}\frac{|\mathcal{D}_{k}|}{\sum_{i\in\mathcal{C}^{t}}|\mathcal{D}_{i}|}\boldsymbol{g}_{k}^{t},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.10" class="ltx_p">where <math id="S3.SS1.p2.9.m1.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="S3.SS1.p2.9.m1.1a"><msub id="S3.SS1.p2.9.m1.1.1" xref="S3.SS1.p2.9.m1.1.1.cmml"><mi id="S3.SS1.p2.9.m1.1.1.2" xref="S3.SS1.p2.9.m1.1.1.2.cmml">η</mi><mi id="S3.SS1.p2.9.m1.1.1.3" xref="S3.SS1.p2.9.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m1.1b"><apply id="S3.SS1.p2.9.m1.1.1.cmml" xref="S3.SS1.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m1.1.1.1.cmml" xref="S3.SS1.p2.9.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m1.1.1.2.cmml" xref="S3.SS1.p2.9.m1.1.1.2">𝜂</ci><ci id="S3.SS1.p2.9.m1.1.1.3.cmml" xref="S3.SS1.p2.9.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m1.1c">\eta_{s}</annotation></semantics></math> is the server learning rate, <math id="S3.SS1.p2.10.m2.1" class="ltx_Math" alttext="|\mathcal{C}^{t}|" display="inline"><semantics id="S3.SS1.p2.10.m2.1a"><mrow id="S3.SS1.p2.10.m2.1.1.1" xref="S3.SS1.p2.10.m2.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.10.m2.1.1.1.2" xref="S3.SS1.p2.10.m2.1.1.2.1.cmml">|</mo><msup id="S3.SS1.p2.10.m2.1.1.1.1" xref="S3.SS1.p2.10.m2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.10.m2.1.1.1.1.2" xref="S3.SS1.p2.10.m2.1.1.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p2.10.m2.1.1.1.1.3" xref="S3.SS1.p2.10.m2.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.SS1.p2.10.m2.1.1.1.3" xref="S3.SS1.p2.10.m2.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m2.1b"><apply id="S3.SS1.p2.10.m2.1.1.2.cmml" xref="S3.SS1.p2.10.m2.1.1.1"><abs id="S3.SS1.p2.10.m2.1.1.2.1.cmml" xref="S3.SS1.p2.10.m2.1.1.1.2"></abs><apply id="S3.SS1.p2.10.m2.1.1.1.1.cmml" xref="S3.SS1.p2.10.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.10.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.10.m2.1.1.1.1.2.cmml" xref="S3.SS1.p2.10.m2.1.1.1.1.2">𝒞</ci><ci id="S3.SS1.p2.10.m2.1.1.1.1.3.cmml" xref="S3.SS1.p2.10.m2.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m2.1c">|\mathcal{C}^{t}|</annotation></semantics></math> is the number of clients participating in the current round.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">In this paper, we study the optimization problem of FL in the setting where the global data distribution <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}=\bigcup_{k}\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><msub id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml"><mo id="S3.SS1.p3.1.m1.1.1.3.1.2" xref="S3.SS1.p3.1.m1.1.1.3.1.2.cmml">⋃</mo><mi id="S3.SS1.p3.1.m1.1.1.3.1.3" xref="S3.SS1.p3.1.m1.1.1.3.1.3.cmml">k</mi></msub><msub id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1.3.2.2" xref="S3.SS1.p3.1.m1.1.1.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p3.1.m1.1.1.3.2.3" xref="S3.SS1.p3.1.m1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><eq id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></eq><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝒟</ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><apply id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.3.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1">subscript</csymbol><union id="S3.SS1.p3.1.m1.1.1.3.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1.2"></union><ci id="S3.SS1.p3.1.m1.1.1.3.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1.3">𝑘</ci></apply><apply id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.3.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.3.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2.2">𝒟</ci><ci id="S3.SS1.p3.1.m1.1.1.3.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathcal{D}=\bigcup_{k}\mathcal{D}_{k}</annotation></semantics></math> is long-tailed. Previous studies in centralized long-tailed learning <cite class="ltx_cite ltx_citemacro_cite">Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite> propose to decouple the training on the long-tailed classification tasks into the representation learning and classifier learning phases, and point out that performing class-level re-weighting rather than instance-balanced training brings negative impact on the representation learning, and the imbalanced data distribution mainly affects the classifier learning. Thus, <span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_bold">our main motivation is to effectively re-balance the classifier when dealing with the long-tailed global data.</span> Specifically, in order to tackle the problem of the lack of a global balanced dataset in FL, we manage to make each client re-balance the classifier locally during training, by taking great advantage of the abundant real data stored in the local datasets.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Our Optimization Target</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.5" class="ltx_p">We split the original model architecture <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\theta}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\boldsymbol{\theta}</annotation></semantics></math> into two parts: the representation encoder <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{P}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\boldsymbol{P}</annotation></semantics></math> and the classifier <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\boldsymbol{W}</annotation></semantics></math>, and aim to re-balance <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\boldsymbol{W}</annotation></semantics></math> during the local training to make it behave well on the class-balanced data distribution <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}^{bal}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msup id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.3.1" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.3.1a" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.3.4" xref="S3.SS2.p1.5.m5.1.1.3.4.cmml">l</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝒟</ci><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><times id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">𝑏</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3">𝑎</ci><ci id="S3.SS2.p1.5.m5.1.1.3.4.cmml" xref="S3.SS2.p1.5.m5.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathcal{D}^{bal}</annotation></semantics></math>. However, re-balancing classifier during (instead of after) the representation learning phase leads to a contradictory optimization target:</p>
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle(\boldsymbol{P}^{*},\boldsymbol{W}^{*})" display="inline"><semantics id="S3.E3X.2.1.1.m1.2a"><mrow id="S3.E3X.2.1.1.m1.2.2.2" xref="S3.E3X.2.1.1.m1.2.2.3.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.2.2.2.3" xref="S3.E3X.2.1.1.m1.2.2.3.cmml">(</mo><msup id="S3.E3X.2.1.1.m1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.1.1.1.1.2.cmml">𝑷</mi><mo id="S3.E3X.2.1.1.m1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E3X.2.1.1.m1.2.2.2.4" xref="S3.E3X.2.1.1.m1.2.2.3.cmml">,</mo><msup id="S3.E3X.2.1.1.m1.2.2.2.2" xref="S3.E3X.2.1.1.m1.2.2.2.2.cmml"><mi id="S3.E3X.2.1.1.m1.2.2.2.2.2" xref="S3.E3X.2.1.1.m1.2.2.2.2.2.cmml">𝑾</mi><mo id="S3.E3X.2.1.1.m1.2.2.2.2.3" xref="S3.E3X.2.1.1.m1.2.2.2.2.3.cmml">∗</mo></msup><mo stretchy="false" id="S3.E3X.2.1.1.m1.2.2.2.5" xref="S3.E3X.2.1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.2b"><interval closure="open" id="S3.E3X.2.1.1.m1.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.2.2.2"><apply id="S3.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.E3X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.2">𝑷</ci><times id="S3.E3X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1.3"></times></apply><apply id="S3.E3X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.2.2.2.2">superscript</csymbol><ci id="S3.E3X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2.2.2.2">𝑾</ci><times id="S3.E3X.2.1.1.m1.2.2.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.2.2.2.2.3"></times></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.2c">\displaystyle(\boldsymbol{P}^{*},\boldsymbol{W}^{*})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{P},\boldsymbol{W}}L(\boldsymbol{P},\boldsymbol{W};\bigcup_{k}\mathcal{D}_{k})" display="inline"><semantics id="S3.E3X.3.2.2.m1.5a"><mrow id="S3.E3X.3.2.2.m1.5.5" xref="S3.E3X.3.2.2.m1.5.5.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.3" xref="S3.E3X.3.2.2.m1.5.5.3.cmml"></mi><mo id="S3.E3X.3.2.2.m1.5.5.2" xref="S3.E3X.3.2.2.m1.5.5.2.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.5.5.1" xref="S3.E3X.3.2.2.m1.5.5.1.cmml"><munder id="S3.E3X.3.2.2.m1.5.5.1.2" xref="S3.E3X.3.2.2.m1.5.5.1.2.cmml"><mrow id="S3.E3X.3.2.2.m1.5.5.1.2.2" xref="S3.E3X.3.2.2.m1.5.5.1.2.2.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.1.2.2.1" xref="S3.E3X.3.2.2.m1.5.5.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E3X.3.2.2.m1.5.5.1.2.2a" xref="S3.E3X.3.2.2.m1.5.5.1.2.2.cmml">⁡</mo><mi id="S3.E3X.3.2.2.m1.5.5.1.2.2.2" xref="S3.E3X.3.2.2.m1.5.5.1.2.2.2.cmml">min</mi></mrow><mrow id="S3.E3X.3.2.2.m1.2.2.2.4" xref="S3.E3X.3.2.2.m1.2.2.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.1.1.1.1" xref="S3.E3X.3.2.2.m1.1.1.1.1.cmml">𝑷</mi><mo id="S3.E3X.3.2.2.m1.2.2.2.4.1" xref="S3.E3X.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.2.2.2.2" xref="S3.E3X.3.2.2.m1.2.2.2.2.cmml">𝑾</mi></mrow></munder><mrow id="S3.E3X.3.2.2.m1.5.5.1.1" xref="S3.E3X.3.2.2.m1.5.5.1.1.cmml"><mi id="S3.E3X.3.2.2.m1.5.5.1.1.3" xref="S3.E3X.3.2.2.m1.5.5.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E3X.3.2.2.m1.5.5.1.1.2" xref="S3.E3X.3.2.2.m1.5.5.1.1.2.cmml">​</mo><mrow id="S3.E3X.3.2.2.m1.5.5.1.1.1.1" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.2.cmml">(</mo><mi id="S3.E3X.3.2.2.m1.3.3" xref="S3.E3X.3.2.2.m1.3.3.cmml">𝑷</mi><mo id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.2.cmml">,</mo><mi id="S3.E3X.3.2.2.m1.4.4" xref="S3.E3X.3.2.2.m1.4.4.cmml">𝑾</mi><mo id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.4" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.2.cmml">;</mo><mrow id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><munder id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1a" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml">⋃</mo><mi id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.3.cmml">k</mi></munder></mstyle><msub id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.2" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.3" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.5" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.5b"><apply id="S3.E3X.3.2.2.m1.5.5.cmml" xref="S3.E3X.3.2.2.m1.5.5"><eq id="S3.E3X.3.2.2.m1.5.5.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.2"></eq><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.5.5.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.3">absent</csymbol><apply id="S3.E3X.3.2.2.m1.5.5.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.1"><apply id="S3.E3X.3.2.2.m1.5.5.1.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.5.5.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.2">subscript</csymbol><apply id="S3.E3X.3.2.2.m1.5.5.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.2.2"><arg id="S3.E3X.3.2.2.m1.5.5.1.2.2.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.2.2.1"></arg><min id="S3.E3X.3.2.2.m1.5.5.1.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.2.2.2"></min></apply><list id="S3.E3X.3.2.2.m1.2.2.2.3.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.4"><ci id="S3.E3X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1.1.1">𝑷</ci><ci id="S3.E3X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E3X.3.2.2.m1.2.2.2.2">𝑾</ci></list></apply><apply id="S3.E3X.3.2.2.m1.5.5.1.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1"><times id="S3.E3X.3.2.2.m1.5.5.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.2"></times><ci id="S3.E3X.3.2.2.m1.5.5.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.3">𝐿</ci><vector id="S3.E3X.3.2.2.m1.5.5.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1"><ci id="S3.E3X.3.2.2.m1.3.3.cmml" xref="S3.E3X.3.2.2.m1.3.3">𝑷</ci><ci id="S3.E3X.3.2.2.m1.4.4.cmml" xref="S3.E3X.3.2.2.m1.4.4">𝑾</ci><apply id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1"><apply id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1">subscript</csymbol><union id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.2"></union><ci id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.2">𝒟</ci><ci id="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.5.5.1.1.1.1.1.2.3">𝑘</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.5c">\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{P},\boldsymbol{W}}L(\boldsymbol{P},\boldsymbol{W};\bigcup_{k}\mathcal{D}_{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.7" class="ltx_Math" alttext="\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{P},\boldsymbol{W}}\sum_{k=1}^{N}\frac{|\mathcal{D}_{k}|}{\sum_{i=1}^{N}|\mathcal{D}_{i}|}L(\boldsymbol{P},\boldsymbol{W};\mathcal{D}_{k})," display="inline"><semantics id="S3.E3Xa.2.1.1.m1.7a"><mrow id="S3.E3Xa.2.1.1.m1.7.7.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.7.7.1.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.7.7.1.1.3" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.3.cmml"></mi><mo id="S3.E3Xa.2.1.1.m1.7.7.1.1.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E3Xa.2.1.1.m1.7.7.1.1.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.cmml"><munder id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.cmml"><mrow id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2a" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.cmml">⁡</mo><mi id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S3.E3Xa.2.1.1.m1.2.2.2.4" xref="S3.E3Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml">𝑷</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.2.4.1" xref="S3.E3Xa.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3Xa.2.1.1.m1.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.2.2.cmml">𝑾</mi></mrow></munder><mrow id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.cmml"><munderover id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2a" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.3" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.3" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.4.4" xref="S3.E3Xa.2.1.1.m1.4.4.cmml"><mfrac id="S3.E3Xa.2.1.1.m1.4.4a" xref="S3.E3Xa.2.1.1.m1.4.4.cmml"><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.2.1.cmml">|</mo><msub id="S3.E3Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.2.cmml">𝒟</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.3.3.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="S3.E3Xa.2.1.1.m1.4.4.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.cmml"><msubsup id="S3.E3Xa.2.1.1.m1.4.4.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.cmml"><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.2.cmml">∑</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.2.cmml">i</mi><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.1.cmml">=</mo><mn id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.cmml">N</mi></msubsup><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.2.cmml"><mo lspace="0em" stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.2.1.cmml">|</mo><msub id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.2a" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E3Xa.2.1.1.m1.5.5" xref="S3.E3Xa.2.1.1.m1.5.5.cmml">𝑷</mi><mo id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E3Xa.2.1.1.m1.6.6" xref="S3.E3Xa.2.1.1.m1.6.6.cmml">𝑾</mi><mo id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.4" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.5" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.7.7.1.2" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.7b"><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1"><eq id="S3.E3Xa.2.1.1.m1.7.7.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.2"></eq><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.7.7.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.3">absent</csymbol><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1"><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2">subscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2"><arg id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.1"></arg><min id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.2.2.2"></min></apply><list id="S3.E3Xa.2.1.1.m1.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.4"><ci id="S3.E3Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1.1.1">𝑷</ci><ci id="S3.E3Xa.2.1.1.m1.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.2.2">𝑾</ci></list></apply><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1"><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2">subscript</csymbol><sum id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.2"></sum><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3"><eq id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.1"></eq><ci id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1"><times id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.2"></times><apply id="S3.E3Xa.2.1.1.m1.4.4.cmml" xref="S3.E3Xa.2.1.1.m1.4.4"><divide id="S3.E3Xa.2.1.1.m1.4.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4"></divide><apply id="S3.E3Xa.2.1.1.m1.3.3.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1"><abs id="S3.E3Xa.2.1.1.m1.3.3.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.2"></abs><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.2">𝒟</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2"><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2">subscript</csymbol><sum id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.2"></sum><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3"><eq id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.1"></eq><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3">𝑁</ci></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.2.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1"><abs id="S3.E3Xa.2.1.1.m1.4.4.2.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1.2"></abs><apply id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.2">𝒟</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><ci id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.3">𝐿</ci><vector id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1"><ci id="S3.E3Xa.2.1.1.m1.5.5.cmml" xref="S3.E3Xa.2.1.1.m1.5.5">𝑷</ci><ci id="S3.E3Xa.2.1.1.m1.6.6.cmml" xref="S3.E3Xa.2.1.1.m1.6.6">𝑾</ci><apply id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.7c">\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{P},\boldsymbol{W}}\sum_{k=1}^{N}\frac{|\mathcal{D}_{k}|}{\sum_{i=1}^{N}|\mathcal{D}_{i}|}L(\boldsymbol{P},\boldsymbol{W};\mathcal{D}_{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E3Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3Xb.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\text{s.t.}\qquad\boldsymbol{W}^{*}" display="inline"><semantics id="S3.E3Xb.2.1.1.m1.2a"><mrow id="S3.E3Xb.2.1.1.m1.2.2.1" xref="S3.E3Xb.2.1.1.m1.2.2.2.cmml"><mtext id="S3.E3Xb.2.1.1.m1.1.1" xref="S3.E3Xb.2.1.1.m1.1.1a.cmml">s.t.</mtext><mspace width="2em" id="S3.E3Xb.2.1.1.m1.2.2.1.2" xref="S3.E3Xb.2.1.1.m1.2.2.2.cmml"></mspace><msup id="S3.E3Xb.2.1.1.m1.2.2.1.1" xref="S3.E3Xb.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E3Xb.2.1.1.m1.2.2.1.1.2" xref="S3.E3Xb.2.1.1.m1.2.2.1.1.2.cmml">𝑾</mi><mo id="S3.E3Xb.2.1.1.m1.2.2.1.1.3" xref="S3.E3Xb.2.1.1.m1.2.2.1.1.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xb.2.1.1.m1.2b"><list id="S3.E3Xb.2.1.1.m1.2.2.2.cmml" xref="S3.E3Xb.2.1.1.m1.2.2.1"><ci id="S3.E3Xb.2.1.1.m1.1.1a.cmml" xref="S3.E3Xb.2.1.1.m1.1.1"><mtext id="S3.E3Xb.2.1.1.m1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.1.1">s.t.</mtext></ci><apply id="S3.E3Xb.2.1.1.m1.2.2.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3Xb.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E3Xb.2.1.1.m1.2.2.1.1">superscript</csymbol><ci id="S3.E3Xb.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E3Xb.2.1.1.m1.2.2.1.1.2">𝑾</ci><times id="S3.E3Xb.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E3Xb.2.1.1.m1.2.2.1.1.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xb.2.1.1.m1.2c">\displaystyle\text{s.t.}\qquad\boldsymbol{W}^{*}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xb.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{W}}L(\boldsymbol{P}^{*},\boldsymbol{W};\mathcal{D}^{bal})," display="inline"><semantics id="S3.E3Xb.3.2.2.m1.2a"><mrow id="S3.E3Xb.3.2.2.m1.2.2.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.cmml"><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.4" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.4.cmml"></mi><mo id="S3.E3Xb.3.2.2.m1.2.2.1.1.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.cmml"><munder id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.cmml"><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.cmml"><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2a" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.cmml">⁡</mo><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.2.cmml">min</mi></mrow><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.3.cmml">𝑾</mi></munder><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.cmml"><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.4" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.cmml">​</mo><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">(</mo><msup id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝑷</mi><mo id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.4" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">,</mo><mi id="S3.E3Xb.3.2.2.m1.1.1" xref="S3.E3Xb.3.2.2.m1.1.1.cmml">𝑾</mi><mo id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.5" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">;</mo><msup id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.2.cmml">𝒟</mi><mrow id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.3" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1a" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.4" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.4.cmml">l</mi></mrow></msup><mo stretchy="false" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.6" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3Xb.3.2.2.m1.2.2.1.2" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xb.3.2.2.m1.2b"><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1"><eq id="S3.E3Xb.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.3"></eq><csymbol cd="latexml" id="S3.E3Xb.3.2.2.m1.2.2.1.1.4.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.4">absent</csymbol><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2"><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3">subscript</csymbol><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2"><arg id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.1"></arg><min id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.2.2"></min></apply><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.3.3">𝑾</ci></apply><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2"><times id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.3"></times><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.4.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.4">𝐿</ci><vector id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2"><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.2">𝑷</ci><times id="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.3"></times></apply><ci id="S3.E3Xb.3.2.2.m1.1.1.cmml" xref="S3.E3Xb.3.2.2.m1.1.1">𝑾</ci><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.2">𝒟</ci><apply id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3"><times id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.2">𝑏</ci><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.3">𝑎</ci><ci id="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.4.cmml" xref="S3.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.4">𝑙</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xb.3.2.2.m1.2c">\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{W}}L(\boldsymbol{P}^{*},\boldsymbol{W};\mathcal{D}^{bal}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.p1.10" class="ltx_p">As we can see, when the global data distribution <math id="S3.SS2.p1.6.m1.1" class="ltx_Math" alttext="\mathcal{D}=\bigcup_{k}\mathcal{D}_{k}" display="inline"><semantics id="S3.SS2.p1.6.m1.1a"><mrow id="S3.SS2.p1.6.m1.1.1" xref="S3.SS2.p1.6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m1.1.1.2" xref="S3.SS2.p1.6.m1.1.1.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.SS2.p1.6.m1.1.1.1" xref="S3.SS2.p1.6.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.6.m1.1.1.3" xref="S3.SS2.p1.6.m1.1.1.3.cmml"><msub id="S3.SS2.p1.6.m1.1.1.3.1" xref="S3.SS2.p1.6.m1.1.1.3.1.cmml"><mo id="S3.SS2.p1.6.m1.1.1.3.1.2" xref="S3.SS2.p1.6.m1.1.1.3.1.2.cmml">⋃</mo><mi id="S3.SS2.p1.6.m1.1.1.3.1.3" xref="S3.SS2.p1.6.m1.1.1.3.1.3.cmml">k</mi></msub><msub id="S3.SS2.p1.6.m1.1.1.3.2" xref="S3.SS2.p1.6.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m1.1.1.3.2.2" xref="S3.SS2.p1.6.m1.1.1.3.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.6.m1.1.1.3.2.3" xref="S3.SS2.p1.6.m1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m1.1b"><apply id="S3.SS2.p1.6.m1.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1"><eq id="S3.SS2.p1.6.m1.1.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1.1"></eq><ci id="S3.SS2.p1.6.m1.1.1.2.cmml" xref="S3.SS2.p1.6.m1.1.1.2">𝒟</ci><apply id="S3.SS2.p1.6.m1.1.1.3.cmml" xref="S3.SS2.p1.6.m1.1.1.3"><apply id="S3.SS2.p1.6.m1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m1.1.1.3.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1.3.1">subscript</csymbol><union id="S3.SS2.p1.6.m1.1.1.3.1.2.cmml" xref="S3.SS2.p1.6.m1.1.1.3.1.2"></union><ci id="S3.SS2.p1.6.m1.1.1.3.1.3.cmml" xref="S3.SS2.p1.6.m1.1.1.3.1.3">𝑘</ci></apply><apply id="S3.SS2.p1.6.m1.1.1.3.2.cmml" xref="S3.SS2.p1.6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m1.1.1.3.2.1.cmml" xref="S3.SS2.p1.6.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS2.p1.6.m1.1.1.3.2.2.cmml" xref="S3.SS2.p1.6.m1.1.1.3.2.2">𝒟</ci><ci id="S3.SS2.p1.6.m1.1.1.3.2.3.cmml" xref="S3.SS2.p1.6.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m1.1c">\mathcal{D}=\bigcup_{k}\mathcal{D}_{k}</annotation></semantics></math> is long-tailed, the above optimization problem has no solution, caused by the contradictory goals when updating <math id="S3.SS2.p1.7.m2.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS2.p1.7.m2.1a"><mi id="S3.SS2.p1.7.m2.1.1" xref="S3.SS2.p1.7.m2.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m2.1b"><ci id="S3.SS2.p1.7.m2.1.1.cmml" xref="S3.SS2.p1.7.m2.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m2.1c">\boldsymbol{W}</annotation></semantics></math>. To address to negative impact of performing local classifier re-balancing, we design an architecture of the two-stream classifiers by adding a new classifier <math id="S3.SS2.p1.8.m3.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}" display="inline"><semantics id="S3.SS2.p1.8.m3.1a"><mover accent="true" id="S3.SS2.p1.8.m3.1.1" xref="S3.SS2.p1.8.m3.1.1.cmml"><mi id="S3.SS2.p1.8.m3.1.1.2" xref="S3.SS2.p1.8.m3.1.1.2.cmml">𝑾</mi><mo id="S3.SS2.p1.8.m3.1.1.1" xref="S3.SS2.p1.8.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m3.1b"><apply id="S3.SS2.p1.8.m3.1.1.cmml" xref="S3.SS2.p1.8.m3.1.1"><ci id="S3.SS2.p1.8.m3.1.1.1.cmml" xref="S3.SS2.p1.8.m3.1.1.1">^</ci><ci id="S3.SS2.p1.8.m3.1.1.2.cmml" xref="S3.SS2.p1.8.m3.1.1.2">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m3.1c">\widehat{\boldsymbol{W}}</annotation></semantics></math> in the training phase, in order to help model the global data distribution <math id="S3.SS2.p1.9.m4.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS2.p1.9.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m4.1.1" xref="S3.SS2.p1.9.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m4.1b"><ci id="S3.SS2.p1.9.m4.1.1.cmml" xref="S3.SS2.p1.9.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m4.1c">\mathcal{D}</annotation></semantics></math> and make re-balancing <math id="S3.SS2.p1.10.m5.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS2.p1.10.m5.1a"><mi id="S3.SS2.p1.10.m5.1.1" xref="S3.SS2.p1.10.m5.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m5.1b"><ci id="S3.SS2.p1.10.m5.1.1.cmml" xref="S3.SS2.p1.10.m5.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m5.1c">\boldsymbol{W}</annotation></semantics></math> possible. The full illustrations of our model architecture and training process are in Figure <a href="#S3.F1" title="Figure 1 ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, and we re-formulate our global optimization target as:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<div id="S3.E4.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_transformed_outer" style="width:418.1pt;height:109.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(112.3pt,-29.5pt) scale(2.16088888300021,2.16088888300021) ;">
<p id="S3.E4.m1.1.1.1.1" class="ltx_p"><math id="S3.E4.m1.1.1.1.1.m1.16" class="ltx_Math" alttext="\begin{aligned} (\boldsymbol{P}^{*},\boldsymbol{W}^{*},\widehat{\boldsymbol{W}^{*}})&amp;=(\boldsymbol{\theta}^{*},\widehat{\boldsymbol{W}^{*}})\\
&amp;=\mathop{\arg\min}\limits_{\boldsymbol{\theta},\widehat{\boldsymbol{W}}}\sum_{k=1}^{N}\frac{|\mathcal{D}_{k}|}{\sum_{i=1}^{N}|\mathcal{D}_{i}|}L(\boldsymbol{\theta},\widehat{\boldsymbol{W}};\mathcal{D}_{k}),\\
\text{s.t.}\qquad\boldsymbol{W}^{*}&amp;=\mathop{\arg\min}\limits_{\boldsymbol{W}}L(\boldsymbol{P}^{*},\boldsymbol{W};\mathcal{D}^{bal}).\end{aligned}" display="inline"><semantics id="S3.E4.m1.1.1.1.1.m1.16a"><mtable columnspacing="0pt" rowspacing="0pt" id="S3.E4.m1.1.1.1.1.m1.16.16" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mtr id="S3.E4.m1.1.1.1.1.m1.16.16a" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.1.1.1.1.m1.16.16b" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.4.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.3" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.4.cmml">(</mo><msup id="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.2" xref="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.2.cmml">𝑷</mi><mo id="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.3" xref="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.3.cmml">∗</mo></msup><mo id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.4" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.4.cmml">,</mo><msup id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.2" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.2.cmml">𝑾</mi><mo id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.3" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.3.cmml">∗</mo></msup><mo id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.5" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.4.cmml">,</mo><mover accent="true" id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.cmml"><msup id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mo id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.3.cmml">∗</mo></msup><mo id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.6" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.4.cmml">)</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.1.1.1.1.m1.16.16c" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.4" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.4.cmml"></mi><mo id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.3" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.3.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.2" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.2.cmml">(</mo><msup id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.2.cmml">𝜽</mi><mo id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.3.cmml">∗</mo></msup><mo id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.3" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.2.cmml">,</mo><mover accent="true" id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.cmml"><msup id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.2" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.2.cmml">𝑾</mi><mo id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.3" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.3.cmml">∗</mo></msup><mo id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.4" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.2.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E4.m1.1.1.1.1.m1.16.16d" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mtd id="S3.E4.m1.1.1.1.1.m1.16.16e" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.1.1.1.1.m1.16.16f" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.3" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.3.cmml"></mi><mo id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.cmml"><munder id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.1" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2a" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.cmml">⁡</mo><mi id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.4" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.6.6.6.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.6.6.6.1.1.1.1.1.cmml">𝜽</mi><mo id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.4.1" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.3.cmml">,</mo><mover accent="true" id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.2.cmml">𝑾</mi><mo id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.1" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.1.cmml">^</mo></mover></mrow></munder><mrow id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.cmml"><munderover id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2a" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.1" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.3" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.cmml"><mfrac id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4a" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.2.1.cmml">|</mo><msub id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.2.cmml">𝒟</mi><mi id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.2.1.cmml">|</mo></mrow><mrow id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.cmml"><msubsup id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.cmml"><mo id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.2" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.1" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.3" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.3" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.3.cmml">N</mi></msubsup><mrow id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.2.cmml"><mo lspace="0em" stretchy="false" id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.2.1.cmml">|</mo><msub id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.2.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.2a" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1.m1.10.10.10.5.5.5" xref="S3.E4.m1.1.1.1.1.m1.10.10.10.5.5.5.cmml">𝜽</mi><mo id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6" xref="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.2" xref="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.2.cmml">𝑾</mi><mo id="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.1" xref="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.1.cmml">^</mo></mover><mo id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.2" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E4.m1.1.1.1.1.m1.16.16g" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.1.1.1.1.m1.16.16h" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.3.cmml"><mtext id="S3.E4.m1.1.1.1.1.m1.13.13.13.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.13.13.13.1.1.1a.cmml">s.t.</mtext><mspace width="2em" id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.3.cmml"></mspace><msup id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.2" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.2.cmml">𝑾</mi><mo id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.3" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.3.cmml">∗</mo></msup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.1.1.1.1.m1.16.16i" xref="S3.E4.m1.1.1.1.1.m1.16.16.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.4" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.4.cmml"></mi><mo id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.3" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.3.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.cmml"><munder id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.cmml"><mrow id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.1" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2a" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.cmml">⁡</mo><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.2.cmml">min</mi></mrow><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.3" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.3.cmml">𝑾</mi></munder><mrow id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.4" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.3" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.3.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.3.cmml">(</mo><msup id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.2.cmml">𝑷</mi><mo id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.4" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.1.1.1.1.m1.15.15.15.3.1.1" xref="S3.E4.m1.1.1.1.1.m1.15.15.15.3.1.1.cmml">𝑾</mi><mo id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.5" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.3.cmml">;</mo><msup id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.2.cmml">𝒟</mi><mrow id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.1" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.3" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.1a" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.4" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.4.cmml">l</mi></mrow></msup><mo stretchy="false" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.6" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.2" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1.1.1.1.m1.16b"><matrix id="S3.E4.m1.1.1.1.1.m1.16.16.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16"><matrixrow id="S3.E4.m1.1.1.1.1.m1.16.16a.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16"><vector id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.4.cmml" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3"><apply id="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.2">𝑷</ci><times id="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.2.2.2.2.2.2.1.3"></times></apply><apply id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.2">𝑾</ci><times id="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.3.3.3.3.3.3.2.3"></times></apply><apply id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1"><ci id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.1">^</ci><apply id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.2">𝑾</ci><times id="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.1.1.1.1.1.1.2.3"></times></apply></apply></vector><apply id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2"><eq id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.3"></eq><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.4.cmml" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.4">absent</csymbol><interval closure="open" id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1"><apply id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.2">𝜽</ci><times id="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.5.5.5.5.2.2.1.1.3"></times></apply><apply id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1"><ci id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.1">^</ci><apply id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.2">𝑾</ci><times id="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.4.4.4.4.1.1.2.3"></times></apply></apply></interval></apply></matrixrow><matrixrow id="S3.E4.m1.1.1.1.1.m1.16.16b.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16"><cerror id="S3.E4.m1.1.1.1.1.m1.16.16c.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.16.16d.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16">missing-subexpression</csymbol></cerror><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7"><eq id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.2"></eq><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.3">absent</csymbol><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1"><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2"><arg id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.1"></arg><min id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.2.2.2"></min></apply><list id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.m1.6.6.6.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.6.6.6.1.1.1.1.1">𝜽</ci><apply id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2"><ci id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.1">^</ci><ci id="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.7.7.7.2.2.2.2.2.2">𝑾</ci></apply></list></apply><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1"><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3"><eq id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4"><divide id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4"></divide><apply id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1"><abs id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.2"></abs><apply id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.2">𝒟</ci><ci id="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.8.8.8.3.3.3.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2"><apply id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.2"></sum><apply id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3"><eq id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.2.3">𝑁</ci></apply><apply id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1"><abs id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.2"></abs><apply id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.2">𝒟</ci><ci id="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.9.9.9.4.4.4.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><ci id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.3">𝐿</ci><vector id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1"><ci id="S3.E4.m1.1.1.1.1.m1.10.10.10.5.5.5.cmml" xref="S3.E4.m1.1.1.1.1.m1.10.10.10.5.5.5">𝜽</ci><apply id="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.cmml" xref="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6"><ci id="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.1">^</ci><ci id="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.11.11.11.6.6.6.2">𝑾</ci></apply><apply id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.12.12.12.7.7.7.1.1.1.1.1.1.1.3">𝑘</ci></apply></vector></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E4.m1.1.1.1.1.m1.16.16e.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16"><list id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2"><ci id="S3.E4.m1.1.1.1.1.m1.13.13.13.1.1.1a.cmml" xref="S3.E4.m1.1.1.1.1.m1.13.13.13.1.1.1"><mtext id="S3.E4.m1.1.1.1.1.m1.13.13.13.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.13.13.13.1.1.1">s.t.</mtext></ci><apply id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.2">𝑾</ci><times id="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.14.14.14.2.2.2.1.3"></times></apply></list><apply id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2"><eq id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.3"></eq><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.4.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.4">absent</csymbol><apply id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2"><apply id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2"><arg id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.1"></arg><min id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.2.2"></min></apply><ci id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.3.3">𝑾</ci></apply><apply id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2"><times id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.3"></times><ci id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.4.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.4">𝐿</ci><vector id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2"><apply id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.2">𝑷</ci><times id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.1.1.1.1.1.3"></times></apply><ci id="S3.E4.m1.1.1.1.1.m1.15.15.15.3.1.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.15.15.15.3.1.1">𝑾</ci><apply id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.2">𝒟</ci><apply id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3"><times id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.1"></times><ci id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.2">𝑏</ci><ci id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.3">𝑎</ci><ci id="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.4.cmml" xref="S3.E4.m1.1.1.1.1.m1.16.16.16.4.2.2.1.2.2.2.2.2.3.4">𝑙</ci></apply></apply></vector></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1.1.1.1.m1.16c">\begin{aligned} (\boldsymbol{P}^{*},\boldsymbol{W}^{*},\widehat{\boldsymbol{W}^{*}})&amp;=(\boldsymbol{\theta}^{*},\widehat{\boldsymbol{W}^{*}})\\
&amp;=\mathop{\arg\min}\limits_{\boldsymbol{\theta},\widehat{\boldsymbol{W}}}\sum_{k=1}^{N}\frac{|\mathcal{D}_{k}|}{\sum_{i=1}^{N}|\mathcal{D}_{i}|}L(\boldsymbol{\theta},\widehat{\boldsymbol{W}};\mathcal{D}_{k}),\\
\text{s.t.}\qquad\boldsymbol{W}^{*}&amp;=\mathop{\arg\min}\limits_{\boldsymbol{W}}L(\boldsymbol{P}^{*},\boldsymbol{W};\mathcal{D}^{bal}).\end{aligned}</annotation></semantics></math></p>
</span></div>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="0" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.11" class="ltx_p">By making the combination of two classifiers model the global data distribution in the first part of Eq. (<a href="#S3.E4" title="In 3.2 Our Optimization Target ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), we make sure that the representation encoder is trained under the instance-balanced training paradigm, which benefits the representation learning most. In the following, we introduce our algorithm to solve Eq. (<a href="#S3.E4" title="In 3.2 Our Optimization Target ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) from three aspects, including the local training stage, the server aggregation stage, and the inference stage.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes</h3>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2301.10394/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="259" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The full illustration of our method. We add a new global classifier <math id="S3.F1.5.m1.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}" display="inline"><semantics id="S3.F1.5.m1.1b"><mover accent="true" id="S3.F1.5.m1.1.1" xref="S3.F1.5.m1.1.1.cmml"><mi id="S3.F1.5.m1.1.1.2" xref="S3.F1.5.m1.1.1.2.cmml">𝑾</mi><mo id="S3.F1.5.m1.1.1.1" xref="S3.F1.5.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F1.5.m1.1c"><apply id="S3.F1.5.m1.1.1.cmml" xref="S3.F1.5.m1.1.1"><ci id="S3.F1.5.m1.1.1.1.cmml" xref="S3.F1.5.m1.1.1.1">^</ci><ci id="S3.F1.5.m1.1.1.2.cmml" xref="S3.F1.5.m1.1.1.2">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.5.m1.1d">\widehat{\boldsymbol{W}}</annotation></semantics></math>, and perform the instance-balanced training on the whole network (including the encoder and the two classifiers). Furthermore, we propose a novel algorithm to re-balance the original classifier during the local training by integrating the local real data and the global gradient prototypes (<math id="S3.F1.6.m2.2" class="ltx_Math" alttext="\boldsymbol{g}_{\boldsymbol{W},c}^{pro}" display="inline"><semantics id="S3.F1.6.m2.2b"><msubsup id="S3.F1.6.m2.2.3" xref="S3.F1.6.m2.2.3.cmml"><mi id="S3.F1.6.m2.2.3.2.2" xref="S3.F1.6.m2.2.3.2.2.cmml">𝒈</mi><mrow id="S3.F1.6.m2.2.2.2.4" xref="S3.F1.6.m2.2.2.2.3.cmml"><mi id="S3.F1.6.m2.1.1.1.1" xref="S3.F1.6.m2.1.1.1.1.cmml">𝑾</mi><mo id="S3.F1.6.m2.2.2.2.4.1" xref="S3.F1.6.m2.2.2.2.3.cmml">,</mo><mi id="S3.F1.6.m2.2.2.2.2" xref="S3.F1.6.m2.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.F1.6.m2.2.3.3" xref="S3.F1.6.m2.2.3.3.cmml"><mi id="S3.F1.6.m2.2.3.3.2" xref="S3.F1.6.m2.2.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.F1.6.m2.2.3.3.1" xref="S3.F1.6.m2.2.3.3.1.cmml">​</mo><mi id="S3.F1.6.m2.2.3.3.3" xref="S3.F1.6.m2.2.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.F1.6.m2.2.3.3.1b" xref="S3.F1.6.m2.2.3.3.1.cmml">​</mo><mi id="S3.F1.6.m2.2.3.3.4" xref="S3.F1.6.m2.2.3.3.4.cmml">o</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.F1.6.m2.2c"><apply id="S3.F1.6.m2.2.3.cmml" xref="S3.F1.6.m2.2.3"><csymbol cd="ambiguous" id="S3.F1.6.m2.2.3.1.cmml" xref="S3.F1.6.m2.2.3">superscript</csymbol><apply id="S3.F1.6.m2.2.3.2.cmml" xref="S3.F1.6.m2.2.3"><csymbol cd="ambiguous" id="S3.F1.6.m2.2.3.2.1.cmml" xref="S3.F1.6.m2.2.3">subscript</csymbol><ci id="S3.F1.6.m2.2.3.2.2.cmml" xref="S3.F1.6.m2.2.3.2.2">𝒈</ci><list id="S3.F1.6.m2.2.2.2.3.cmml" xref="S3.F1.6.m2.2.2.2.4"><ci id="S3.F1.6.m2.1.1.1.1.cmml" xref="S3.F1.6.m2.1.1.1.1">𝑾</ci><ci id="S3.F1.6.m2.2.2.2.2.cmml" xref="S3.F1.6.m2.2.2.2.2">𝑐</ci></list></apply><apply id="S3.F1.6.m2.2.3.3.cmml" xref="S3.F1.6.m2.2.3.3"><times id="S3.F1.6.m2.2.3.3.1.cmml" xref="S3.F1.6.m2.2.3.3.1"></times><ci id="S3.F1.6.m2.2.3.3.2.cmml" xref="S3.F1.6.m2.2.3.3.2">𝑝</ci><ci id="S3.F1.6.m2.2.3.3.3.cmml" xref="S3.F1.6.m2.2.3.3.3">𝑟</ci><ci id="S3.F1.6.m2.2.3.3.4.cmml" xref="S3.F1.6.m2.2.3.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.6.m2.2d">\boldsymbol{g}_{\boldsymbol{W},c}^{pro}</annotation></semantics></math> in the figure) to form a local balanced dataset for adjusting the original classifier. In the inference phase, we only keep the global encoder <math id="S3.F1.7.m3.1" class="ltx_Math" alttext="\boldsymbol{P}" display="inline"><semantics id="S3.F1.7.m3.1b"><mi id="S3.F1.7.m3.1.1" xref="S3.F1.7.m3.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S3.F1.7.m3.1c"><ci id="S3.F1.7.m3.1.1.cmml" xref="S3.F1.7.m3.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.7.m3.1d">\boldsymbol{P}</annotation></semantics></math> and the re-balanced classifier <math id="S3.F1.8.m4.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.F1.8.m4.1b"><mi id="S3.F1.8.m4.1.1" xref="S3.F1.8.m4.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.F1.8.m4.1c"><ci id="S3.F1.8.m4.1.1.cmml" xref="S3.F1.8.m4.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.8.m4.1d">\boldsymbol{W}</annotation></semantics></math>.</figcaption>
</figure>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.7.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Local Training Process of RedGrape</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.5" class="ltx_p ltx_figure_panel"><span id="alg1.5.1" class="ltx_text ltx_font_bold">Input</span>: Round number <math id="alg1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">t</annotation></semantics></math>, local data <math id="alg1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="alg1.2.m2.1a"><msub id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.2.m2.1.1.2" xref="alg1.2.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.2.m2.1.1.3" xref="alg1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><apply id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.m2.1.1.1.cmml" xref="alg1.2.m2.1.1">subscript</csymbol><ci id="alg1.2.m2.1.1.2.cmml" xref="alg1.2.m2.1.1.2">𝒟</ci><ci id="alg1.2.m2.1.1.3.cmml" xref="alg1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">\mathcal{D}_{k}</annotation></semantics></math> with local label set <math id="alg1.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="alg1.3.m3.1a"><msub id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.3.m3.1.1.2" xref="alg1.3.m3.1.1.2.cmml">ℒ</mi><mi id="alg1.3.m3.1.1.3" xref="alg1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><apply id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.3.m3.1.1.1.cmml" xref="alg1.3.m3.1.1">subscript</csymbol><ci id="alg1.3.m3.1.1.2.cmml" xref="alg1.3.m3.1.1.2">ℒ</ci><ci id="alg1.3.m3.1.1.3.cmml" xref="alg1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">\mathcal{L}_{k}</annotation></semantics></math>, global model <math id="alg1.4.m4.3" class="ltx_Math" alttext="(\boldsymbol{P}^{t-1},\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t-1})" display="inline"><semantics id="alg1.4.m4.3a"><mrow id="alg1.4.m4.3.3.3" xref="alg1.4.m4.3.3.4.cmml"><mo stretchy="false" id="alg1.4.m4.3.3.3.4" xref="alg1.4.m4.3.3.4.cmml">(</mo><msup id="alg1.4.m4.1.1.1.1" xref="alg1.4.m4.1.1.1.1.cmml"><mi id="alg1.4.m4.1.1.1.1.2" xref="alg1.4.m4.1.1.1.1.2.cmml">𝑷</mi><mrow id="alg1.4.m4.1.1.1.1.3" xref="alg1.4.m4.1.1.1.1.3.cmml"><mi id="alg1.4.m4.1.1.1.1.3.2" xref="alg1.4.m4.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.4.m4.1.1.1.1.3.1" xref="alg1.4.m4.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.4.m4.1.1.1.1.3.3" xref="alg1.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.4.m4.3.3.3.5" xref="alg1.4.m4.3.3.4.cmml">,</mo><msup id="alg1.4.m4.2.2.2.2" xref="alg1.4.m4.2.2.2.2.cmml"><mi id="alg1.4.m4.2.2.2.2.2" xref="alg1.4.m4.2.2.2.2.2.cmml">𝑾</mi><mrow id="alg1.4.m4.2.2.2.2.3" xref="alg1.4.m4.2.2.2.2.3.cmml"><mi id="alg1.4.m4.2.2.2.2.3.2" xref="alg1.4.m4.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.4.m4.2.2.2.2.3.1" xref="alg1.4.m4.2.2.2.2.3.1.cmml">−</mo><mn id="alg1.4.m4.2.2.2.2.3.3" xref="alg1.4.m4.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo id="alg1.4.m4.3.3.3.6" xref="alg1.4.m4.3.3.4.cmml">,</mo><msup id="alg1.4.m4.3.3.3.3" xref="alg1.4.m4.3.3.3.3.cmml"><mover accent="true" id="alg1.4.m4.3.3.3.3.2" xref="alg1.4.m4.3.3.3.3.2.cmml"><mi id="alg1.4.m4.3.3.3.3.2.2" xref="alg1.4.m4.3.3.3.3.2.2.cmml">𝑾</mi><mo id="alg1.4.m4.3.3.3.3.2.1" xref="alg1.4.m4.3.3.3.3.2.1.cmml">^</mo></mover><mrow id="alg1.4.m4.3.3.3.3.3" xref="alg1.4.m4.3.3.3.3.3.cmml"><mi id="alg1.4.m4.3.3.3.3.3.2" xref="alg1.4.m4.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.4.m4.3.3.3.3.3.1" xref="alg1.4.m4.3.3.3.3.3.1.cmml">−</mo><mn id="alg1.4.m4.3.3.3.3.3.3" xref="alg1.4.m4.3.3.3.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="alg1.4.m4.3.3.3.7" xref="alg1.4.m4.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.m4.3b"><vector id="alg1.4.m4.3.3.4.cmml" xref="alg1.4.m4.3.3.3"><apply id="alg1.4.m4.1.1.1.1.cmml" xref="alg1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.1.1.cmml" xref="alg1.4.m4.1.1.1.1">superscript</csymbol><ci id="alg1.4.m4.1.1.1.1.2.cmml" xref="alg1.4.m4.1.1.1.1.2">𝑷</ci><apply id="alg1.4.m4.1.1.1.1.3.cmml" xref="alg1.4.m4.1.1.1.1.3"><minus id="alg1.4.m4.1.1.1.1.3.1.cmml" xref="alg1.4.m4.1.1.1.1.3.1"></minus><ci id="alg1.4.m4.1.1.1.1.3.2.cmml" xref="alg1.4.m4.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.4.m4.1.1.1.1.3.3.cmml" xref="alg1.4.m4.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.4.m4.2.2.2.2.cmml" xref="alg1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.4.m4.2.2.2.2.1.cmml" xref="alg1.4.m4.2.2.2.2">superscript</csymbol><ci id="alg1.4.m4.2.2.2.2.2.cmml" xref="alg1.4.m4.2.2.2.2.2">𝑾</ci><apply id="alg1.4.m4.2.2.2.2.3.cmml" xref="alg1.4.m4.2.2.2.2.3"><minus id="alg1.4.m4.2.2.2.2.3.1.cmml" xref="alg1.4.m4.2.2.2.2.3.1"></minus><ci id="alg1.4.m4.2.2.2.2.3.2.cmml" xref="alg1.4.m4.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.4.m4.2.2.2.2.3.3.cmml" xref="alg1.4.m4.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.4.m4.3.3.3.3.cmml" xref="alg1.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="alg1.4.m4.3.3.3.3.1.cmml" xref="alg1.4.m4.3.3.3.3">superscript</csymbol><apply id="alg1.4.m4.3.3.3.3.2.cmml" xref="alg1.4.m4.3.3.3.3.2"><ci id="alg1.4.m4.3.3.3.3.2.1.cmml" xref="alg1.4.m4.3.3.3.3.2.1">^</ci><ci id="alg1.4.m4.3.3.3.3.2.2.cmml" xref="alg1.4.m4.3.3.3.3.2.2">𝑾</ci></apply><apply id="alg1.4.m4.3.3.3.3.3.cmml" xref="alg1.4.m4.3.3.3.3.3"><minus id="alg1.4.m4.3.3.3.3.3.1.cmml" xref="alg1.4.m4.3.3.3.3.3.1"></minus><ci id="alg1.4.m4.3.3.3.3.3.2.cmml" xref="alg1.4.m4.3.3.3.3.3.2">𝑡</ci><cn type="integer" id="alg1.4.m4.3.3.3.3.3.3.cmml" xref="alg1.4.m4.3.3.3.3.3.3">1</cn></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.3c">(\boldsymbol{P}^{t-1},\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t-1})</annotation></semantics></math>, global gradient prototypes <math id="alg1.5.m5.4" class="ltx_Math" alttext="\{\boldsymbol{g}_{\boldsymbol{W}^{t-2},c}^{pro}|c\in\mathcal{L}\}" display="inline"><semantics id="alg1.5.m5.4a"><mrow id="alg1.5.m5.4.4.2" xref="alg1.5.m5.4.4.3.cmml"><mo stretchy="false" id="alg1.5.m5.4.4.2.3" xref="alg1.5.m5.4.4.3.1.cmml">{</mo><msubsup id="alg1.5.m5.3.3.1.1" xref="alg1.5.m5.3.3.1.1.cmml"><mi id="alg1.5.m5.3.3.1.1.2.2" xref="alg1.5.m5.3.3.1.1.2.2.cmml">𝒈</mi><mrow id="alg1.5.m5.2.2.2.2" xref="alg1.5.m5.2.2.2.3.cmml"><msup id="alg1.5.m5.2.2.2.2.1" xref="alg1.5.m5.2.2.2.2.1.cmml"><mi id="alg1.5.m5.2.2.2.2.1.2" xref="alg1.5.m5.2.2.2.2.1.2.cmml">𝑾</mi><mrow id="alg1.5.m5.2.2.2.2.1.3" xref="alg1.5.m5.2.2.2.2.1.3.cmml"><mi id="alg1.5.m5.2.2.2.2.1.3.2" xref="alg1.5.m5.2.2.2.2.1.3.2.cmml">t</mi><mo id="alg1.5.m5.2.2.2.2.1.3.1" xref="alg1.5.m5.2.2.2.2.1.3.1.cmml">−</mo><mn id="alg1.5.m5.2.2.2.2.1.3.3" xref="alg1.5.m5.2.2.2.2.1.3.3.cmml">2</mn></mrow></msup><mo id="alg1.5.m5.2.2.2.2.2" xref="alg1.5.m5.2.2.2.3.cmml">,</mo><mi id="alg1.5.m5.1.1.1.1" xref="alg1.5.m5.1.1.1.1.cmml">c</mi></mrow><mrow id="alg1.5.m5.3.3.1.1.3" xref="alg1.5.m5.3.3.1.1.3.cmml"><mi id="alg1.5.m5.3.3.1.1.3.2" xref="alg1.5.m5.3.3.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.5.m5.3.3.1.1.3.1" xref="alg1.5.m5.3.3.1.1.3.1.cmml">​</mo><mi id="alg1.5.m5.3.3.1.1.3.3" xref="alg1.5.m5.3.3.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.5.m5.3.3.1.1.3.1a" xref="alg1.5.m5.3.3.1.1.3.1.cmml">​</mo><mi id="alg1.5.m5.3.3.1.1.3.4" xref="alg1.5.m5.3.3.1.1.3.4.cmml">o</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.5.m5.4.4.2.4" xref="alg1.5.m5.4.4.3.1.cmml">|</mo><mrow id="alg1.5.m5.4.4.2.2" xref="alg1.5.m5.4.4.2.2.cmml"><mi id="alg1.5.m5.4.4.2.2.2" xref="alg1.5.m5.4.4.2.2.2.cmml">c</mi><mo id="alg1.5.m5.4.4.2.2.1" xref="alg1.5.m5.4.4.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.5.m5.4.4.2.2.3" xref="alg1.5.m5.4.4.2.2.3.cmml">ℒ</mi></mrow><mo stretchy="false" id="alg1.5.m5.4.4.2.5" xref="alg1.5.m5.4.4.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.m5.4b"><apply id="alg1.5.m5.4.4.3.cmml" xref="alg1.5.m5.4.4.2"><csymbol cd="latexml" id="alg1.5.m5.4.4.3.1.cmml" xref="alg1.5.m5.4.4.2.3">conditional-set</csymbol><apply id="alg1.5.m5.3.3.1.1.cmml" xref="alg1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="alg1.5.m5.3.3.1.1.1.cmml" xref="alg1.5.m5.3.3.1.1">superscript</csymbol><apply id="alg1.5.m5.3.3.1.1.2.cmml" xref="alg1.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="alg1.5.m5.3.3.1.1.2.1.cmml" xref="alg1.5.m5.3.3.1.1">subscript</csymbol><ci id="alg1.5.m5.3.3.1.1.2.2.cmml" xref="alg1.5.m5.3.3.1.1.2.2">𝒈</ci><list id="alg1.5.m5.2.2.2.3.cmml" xref="alg1.5.m5.2.2.2.2"><apply id="alg1.5.m5.2.2.2.2.1.cmml" xref="alg1.5.m5.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.5.m5.2.2.2.2.1.1.cmml" xref="alg1.5.m5.2.2.2.2.1">superscript</csymbol><ci id="alg1.5.m5.2.2.2.2.1.2.cmml" xref="alg1.5.m5.2.2.2.2.1.2">𝑾</ci><apply id="alg1.5.m5.2.2.2.2.1.3.cmml" xref="alg1.5.m5.2.2.2.2.1.3"><minus id="alg1.5.m5.2.2.2.2.1.3.1.cmml" xref="alg1.5.m5.2.2.2.2.1.3.1"></minus><ci id="alg1.5.m5.2.2.2.2.1.3.2.cmml" xref="alg1.5.m5.2.2.2.2.1.3.2">𝑡</ci><cn type="integer" id="alg1.5.m5.2.2.2.2.1.3.3.cmml" xref="alg1.5.m5.2.2.2.2.1.3.3">2</cn></apply></apply><ci id="alg1.5.m5.1.1.1.1.cmml" xref="alg1.5.m5.1.1.1.1">𝑐</ci></list></apply><apply id="alg1.5.m5.3.3.1.1.3.cmml" xref="alg1.5.m5.3.3.1.1.3"><times id="alg1.5.m5.3.3.1.1.3.1.cmml" xref="alg1.5.m5.3.3.1.1.3.1"></times><ci id="alg1.5.m5.3.3.1.1.3.2.cmml" xref="alg1.5.m5.3.3.1.1.3.2">𝑝</ci><ci id="alg1.5.m5.3.3.1.1.3.3.cmml" xref="alg1.5.m5.3.3.1.1.3.3">𝑟</ci><ci id="alg1.5.m5.3.3.1.1.3.4.cmml" xref="alg1.5.m5.3.3.1.1.3.4">𝑜</ci></apply></apply><apply id="alg1.5.m5.4.4.2.2.cmml" xref="alg1.5.m5.4.4.2.2"><in id="alg1.5.m5.4.4.2.2.1.cmml" xref="alg1.5.m5.4.4.2.2.1"></in><ci id="alg1.5.m5.4.4.2.2.2.cmml" xref="alg1.5.m5.4.4.2.2.2">𝑐</ci><ci id="alg1.5.m5.4.4.2.2.3.cmml" xref="alg1.5.m5.4.4.2.2.3">ℒ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.4c">\{\boldsymbol{g}_{\boldsymbol{W}^{t-2},c}^{pro}|c\in\mathcal{L}\}</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.8" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Calculate local gradient prototypes <math id="alg1.l1.m1.5" class="ltx_Math" alttext="\{\boldsymbol{g}_{\boldsymbol{W}^{t},k,c}^{pro}|c\in\mathcal{L}_{k}\}" display="inline"><semantics id="alg1.l1.m1.5a"><mrow id="alg1.l1.m1.5.5.2" xref="alg1.l1.m1.5.5.3.cmml"><mo stretchy="false" id="alg1.l1.m1.5.5.2.3" xref="alg1.l1.m1.5.5.3.1.cmml">{</mo><msubsup id="alg1.l1.m1.4.4.1.1" xref="alg1.l1.m1.4.4.1.1.cmml"><mi id="alg1.l1.m1.4.4.1.1.2.2" xref="alg1.l1.m1.4.4.1.1.2.2.cmml">𝒈</mi><mrow id="alg1.l1.m1.3.3.3.3" xref="alg1.l1.m1.3.3.3.4.cmml"><msup id="alg1.l1.m1.3.3.3.3.1" xref="alg1.l1.m1.3.3.3.3.1.cmml"><mi id="alg1.l1.m1.3.3.3.3.1.2" xref="alg1.l1.m1.3.3.3.3.1.2.cmml">𝑾</mi><mi id="alg1.l1.m1.3.3.3.3.1.3" xref="alg1.l1.m1.3.3.3.3.1.3.cmml">t</mi></msup><mo id="alg1.l1.m1.3.3.3.3.2" xref="alg1.l1.m1.3.3.3.4.cmml">,</mo><mi id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l1.m1.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.4.cmml">,</mo><mi id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.cmml">c</mi></mrow><mrow id="alg1.l1.m1.4.4.1.1.3" xref="alg1.l1.m1.4.4.1.1.3.cmml"><mi id="alg1.l1.m1.4.4.1.1.3.2" xref="alg1.l1.m1.4.4.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.4.4.1.1.3.1" xref="alg1.l1.m1.4.4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.4.4.1.1.3.3" xref="alg1.l1.m1.4.4.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.4.4.1.1.3.1a" xref="alg1.l1.m1.4.4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.4.4.1.1.3.4" xref="alg1.l1.m1.4.4.1.1.3.4.cmml">o</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l1.m1.5.5.2.4" xref="alg1.l1.m1.5.5.3.1.cmml">|</mo><mrow id="alg1.l1.m1.5.5.2.2" xref="alg1.l1.m1.5.5.2.2.cmml"><mi id="alg1.l1.m1.5.5.2.2.2" xref="alg1.l1.m1.5.5.2.2.2.cmml">c</mi><mo id="alg1.l1.m1.5.5.2.2.1" xref="alg1.l1.m1.5.5.2.2.1.cmml">∈</mo><msub id="alg1.l1.m1.5.5.2.2.3" xref="alg1.l1.m1.5.5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.5.5.2.2.3.2" xref="alg1.l1.m1.5.5.2.2.3.2.cmml">ℒ</mi><mi id="alg1.l1.m1.5.5.2.2.3.3" xref="alg1.l1.m1.5.5.2.2.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="alg1.l1.m1.5.5.2.5" xref="alg1.l1.m1.5.5.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.5b"><apply id="alg1.l1.m1.5.5.3.cmml" xref="alg1.l1.m1.5.5.2"><csymbol cd="latexml" id="alg1.l1.m1.5.5.3.1.cmml" xref="alg1.l1.m1.5.5.2.3">conditional-set</csymbol><apply id="alg1.l1.m1.4.4.1.1.cmml" xref="alg1.l1.m1.4.4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.4.4.1.1.1.cmml" xref="alg1.l1.m1.4.4.1.1">superscript</csymbol><apply id="alg1.l1.m1.4.4.1.1.2.cmml" xref="alg1.l1.m1.4.4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.4.4.1.1.2.1.cmml" xref="alg1.l1.m1.4.4.1.1">subscript</csymbol><ci id="alg1.l1.m1.4.4.1.1.2.2.cmml" xref="alg1.l1.m1.4.4.1.1.2.2">𝒈</ci><list id="alg1.l1.m1.3.3.3.4.cmml" xref="alg1.l1.m1.3.3.3.3"><apply id="alg1.l1.m1.3.3.3.3.1.cmml" xref="alg1.l1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.3.3.1.1.cmml" xref="alg1.l1.m1.3.3.3.3.1">superscript</csymbol><ci id="alg1.l1.m1.3.3.3.3.1.2.cmml" xref="alg1.l1.m1.3.3.3.3.1.2">𝑾</ci><ci id="alg1.l1.m1.3.3.3.3.1.3.cmml" xref="alg1.l1.m1.3.3.3.3.1.3">𝑡</ci></apply><ci id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1">𝑘</ci><ci id="alg1.l1.m1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2">𝑐</ci></list></apply><apply id="alg1.l1.m1.4.4.1.1.3.cmml" xref="alg1.l1.m1.4.4.1.1.3"><times id="alg1.l1.m1.4.4.1.1.3.1.cmml" xref="alg1.l1.m1.4.4.1.1.3.1"></times><ci id="alg1.l1.m1.4.4.1.1.3.2.cmml" xref="alg1.l1.m1.4.4.1.1.3.2">𝑝</ci><ci id="alg1.l1.m1.4.4.1.1.3.3.cmml" xref="alg1.l1.m1.4.4.1.1.3.3">𝑟</ci><ci id="alg1.l1.m1.4.4.1.1.3.4.cmml" xref="alg1.l1.m1.4.4.1.1.3.4">𝑜</ci></apply></apply><apply id="alg1.l1.m1.5.5.2.2.cmml" xref="alg1.l1.m1.5.5.2.2"><in id="alg1.l1.m1.5.5.2.2.1.cmml" xref="alg1.l1.m1.5.5.2.2.1"></in><ci id="alg1.l1.m1.5.5.2.2.2.cmml" xref="alg1.l1.m1.5.5.2.2.2">𝑐</ci><apply id="alg1.l1.m1.5.5.2.2.3.cmml" xref="alg1.l1.m1.5.5.2.2.3"><csymbol cd="ambiguous" id="alg1.l1.m1.5.5.2.2.3.1.cmml" xref="alg1.l1.m1.5.5.2.2.3">subscript</csymbol><ci id="alg1.l1.m1.5.5.2.2.3.2.cmml" xref="alg1.l1.m1.5.5.2.2.3.2">ℒ</ci><ci id="alg1.l1.m1.5.5.2.2.3.3.cmml" xref="alg1.l1.m1.5.5.2.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.5c">\{\boldsymbol{g}_{\boldsymbol{W}^{t},k,c}^{pro}|c\in\mathcal{L}_{k}\}</annotation></semantics></math> based on Eq. (<a href="#S3.E10" title="In Updating 𝑾. ‣ Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>).

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> Local step <math id="alg1.l2.m1.4" class="ltx_Math" alttext="i=1,2,\cdots,I" display="inline"><semantics id="alg1.l2.m1.4a"><mrow id="alg1.l2.m1.4.5" xref="alg1.l2.m1.4.5.cmml"><mi id="alg1.l2.m1.4.5.2" xref="alg1.l2.m1.4.5.2.cmml">i</mi><mo id="alg1.l2.m1.4.5.1" xref="alg1.l2.m1.4.5.1.cmml">=</mo><mrow id="alg1.l2.m1.4.5.3.2" xref="alg1.l2.m1.4.5.3.1.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.4.5.3.2.1" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">2</mn><mo id="alg1.l2.m1.4.5.3.2.2" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">⋯</mi><mo id="alg1.l2.m1.4.5.3.2.3" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l2.m1.4.4" xref="alg1.l2.m1.4.4.cmml">I</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.4b"><apply id="alg1.l2.m1.4.5.cmml" xref="alg1.l2.m1.4.5"><eq id="alg1.l2.m1.4.5.1.cmml" xref="alg1.l2.m1.4.5.1"></eq><ci id="alg1.l2.m1.4.5.2.cmml" xref="alg1.l2.m1.4.5.2">𝑖</ci><list id="alg1.l2.m1.4.5.3.1.cmml" xref="alg1.l2.m1.4.5.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><cn type="integer" id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">2</cn><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">⋯</ci><ci id="alg1.l2.m1.4.4.cmml" xref="alg1.l2.m1.4.4">𝐼</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.4c">i=1,2,\cdots,I</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Update <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\boldsymbol{P}" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\boldsymbol{P}</annotation></semantics></math> and <math id="alg1.l3.m2.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}" display="inline"><semantics id="alg1.l3.m2.1a"><mover accent="true" id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">𝑾</mi><mo id="alg1.l3.m2.1.1.1" xref="alg1.l3.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><ci id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1.1">^</ci><ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\widehat{\boldsymbol{W}}</annotation></semantics></math> based on Eq. (<a href="#S3.E6" title="In Updating 𝑷 and 𝑾̂. ‣ Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>).

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     Compute batch gradients for <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\boldsymbol{W}</annotation></semantics></math> based on Eq. (<a href="#S3.E7" title="In Updating 𝑾. ‣ Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>).

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     Compute re-balancing gradients for <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\boldsymbol{W}</annotation></semantics></math> based on Eq. (<a href="#S3.E9" title="In Updating 𝑾. ‣ Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) and Eq. (<a href="#S3.E11" title="In Updating 𝑾. ‣ Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>).

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     Update <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="alg1.l6.m1.1a"><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\boldsymbol{W}</annotation></semantics></math> based on Eq. (<a href="#S3.E12" title="In Updating 𝑾. ‣ Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>).

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>  <span id="alg1.l8.2" class="ltx_text ltx_font_bold">return</span> Local gradients <math id="alg1.l8.m1.3" class="ltx_Math" alttext="(\boldsymbol{P}^{t}_{k}-\boldsymbol{P}^{t-1},\boldsymbol{W}^{t}_{k}-\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t}_{k}-\widehat{\boldsymbol{W}}^{t-1})" display="inline"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.3.3" xref="alg1.l8.m1.3.3.4.cmml"><mo stretchy="false" id="alg1.l8.m1.3.3.3.4" xref="alg1.l8.m1.3.3.4.cmml">(</mo><mrow id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml"><msubsup id="alg1.l8.m1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.2.2.2" xref="alg1.l8.m1.1.1.1.1.2.2.2.cmml">𝑷</mi><mi id="alg1.l8.m1.1.1.1.1.2.3" xref="alg1.l8.m1.1.1.1.1.2.3.cmml">k</mi><mi id="alg1.l8.m1.1.1.1.1.2.2.3" xref="alg1.l8.m1.1.1.1.1.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml">−</mo><msup id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.3.2.cmml">𝑷</mi><mrow id="alg1.l8.m1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.3.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.3.3.2" xref="alg1.l8.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l8.m1.1.1.1.1.3.3.1" xref="alg1.l8.m1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l8.m1.1.1.1.1.3.3.3" xref="alg1.l8.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="alg1.l8.m1.3.3.3.5" xref="alg1.l8.m1.3.3.4.cmml">,</mo><mrow id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.cmml"><msubsup id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.cmml">𝑾</mi><mi id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.3.cmml">k</mi><mi id="alg1.l8.m1.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l8.m1.2.2.2.2.1" xref="alg1.l8.m1.2.2.2.2.1.cmml">−</mo><msup id="alg1.l8.m1.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.2.2.3.2" xref="alg1.l8.m1.2.2.2.2.3.2.cmml">𝑾</mi><mrow id="alg1.l8.m1.2.2.2.2.3.3" xref="alg1.l8.m1.2.2.2.2.3.3.cmml"><mi id="alg1.l8.m1.2.2.2.2.3.3.2" xref="alg1.l8.m1.2.2.2.2.3.3.2.cmml">t</mi><mo id="alg1.l8.m1.2.2.2.2.3.3.1" xref="alg1.l8.m1.2.2.2.2.3.3.1.cmml">−</mo><mn id="alg1.l8.m1.2.2.2.2.3.3.3" xref="alg1.l8.m1.2.2.2.2.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="alg1.l8.m1.3.3.3.6" xref="alg1.l8.m1.3.3.4.cmml">,</mo><mrow id="alg1.l8.m1.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.cmml"><msubsup id="alg1.l8.m1.3.3.3.3.2" xref="alg1.l8.m1.3.3.3.3.2.cmml"><mover accent="true" id="alg1.l8.m1.3.3.3.3.2.2.2" xref="alg1.l8.m1.3.3.3.3.2.2.2.cmml"><mi id="alg1.l8.m1.3.3.3.3.2.2.2.2" xref="alg1.l8.m1.3.3.3.3.2.2.2.2.cmml">𝑾</mi><mo id="alg1.l8.m1.3.3.3.3.2.2.2.1" xref="alg1.l8.m1.3.3.3.3.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l8.m1.3.3.3.3.2.3" xref="alg1.l8.m1.3.3.3.3.2.3.cmml">k</mi><mi id="alg1.l8.m1.3.3.3.3.2.2.3" xref="alg1.l8.m1.3.3.3.3.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l8.m1.3.3.3.3.1" xref="alg1.l8.m1.3.3.3.3.1.cmml">−</mo><msup id="alg1.l8.m1.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.cmml"><mover accent="true" id="alg1.l8.m1.3.3.3.3.3.2" xref="alg1.l8.m1.3.3.3.3.3.2.cmml"><mi id="alg1.l8.m1.3.3.3.3.3.2.2" xref="alg1.l8.m1.3.3.3.3.3.2.2.cmml">𝑾</mi><mo id="alg1.l8.m1.3.3.3.3.3.2.1" xref="alg1.l8.m1.3.3.3.3.3.2.1.cmml">^</mo></mover><mrow id="alg1.l8.m1.3.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l8.m1.3.3.3.3.3.3.2" xref="alg1.l8.m1.3.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.l8.m1.3.3.3.3.3.3.1" xref="alg1.l8.m1.3.3.3.3.3.3.1.cmml">−</mo><mn id="alg1.l8.m1.3.3.3.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.3.3.3.cmml">1</mn></mrow></msup></mrow><mo stretchy="false" id="alg1.l8.m1.3.3.3.7" xref="alg1.l8.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><vector id="alg1.l8.m1.3.3.4.cmml" xref="alg1.l8.m1.3.3.3"><apply id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1"><minus id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1"></minus><apply id="alg1.l8.m1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.2">superscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.2.2.2">𝑷</ci><ci id="alg1.l8.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l8.m1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l8.m1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.3">superscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.3.2">𝑷</ci><apply id="alg1.l8.m1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.3.3"><minus id="alg1.l8.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.3.3.1"></minus><ci id="alg1.l8.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l8.m1.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2"><minus id="alg1.l8.m1.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.1"></minus><apply id="alg1.l8.m1.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2">𝑾</ci><ci id="alg1.l8.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l8.m1.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3">𝑘</ci></apply><apply id="alg1.l8.m1.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.2.2.3">superscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.2.2.3.2">𝑾</ci><apply id="alg1.l8.m1.2.2.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.2.2.3.3"><minus id="alg1.l8.m1.2.2.2.2.3.3.1.cmml" xref="alg1.l8.m1.2.2.2.2.3.3.1"></minus><ci id="alg1.l8.m1.2.2.2.2.3.3.2.cmml" xref="alg1.l8.m1.2.2.2.2.3.3.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.2.2.2.2.3.3.3.cmml" xref="alg1.l8.m1.2.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l8.m1.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3"><minus id="alg1.l8.m1.3.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3.3.1"></minus><apply id="alg1.l8.m1.3.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.3.2.1.cmml" xref="alg1.l8.m1.3.3.3.3.2">subscript</csymbol><apply id="alg1.l8.m1.3.3.3.3.2.2.cmml" xref="alg1.l8.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.3.2.2.1.cmml" xref="alg1.l8.m1.3.3.3.3.2">superscript</csymbol><apply id="alg1.l8.m1.3.3.3.3.2.2.2.cmml" xref="alg1.l8.m1.3.3.3.3.2.2.2"><ci id="alg1.l8.m1.3.3.3.3.2.2.2.1.cmml" xref="alg1.l8.m1.3.3.3.3.2.2.2.1">^</ci><ci id="alg1.l8.m1.3.3.3.3.2.2.2.2.cmml" xref="alg1.l8.m1.3.3.3.3.2.2.2.2">𝑾</ci></apply><ci id="alg1.l8.m1.3.3.3.3.2.2.3.cmml" xref="alg1.l8.m1.3.3.3.3.2.2.3">𝑡</ci></apply><ci id="alg1.l8.m1.3.3.3.3.2.3.cmml" xref="alg1.l8.m1.3.3.3.3.2.3">𝑘</ci></apply><apply id="alg1.l8.m1.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3.3.3">superscript</csymbol><apply id="alg1.l8.m1.3.3.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3.3.3.2"><ci id="alg1.l8.m1.3.3.3.3.3.2.1.cmml" xref="alg1.l8.m1.3.3.3.3.3.2.1">^</ci><ci id="alg1.l8.m1.3.3.3.3.3.2.2.cmml" xref="alg1.l8.m1.3.3.3.3.3.2.2">𝑾</ci></apply><apply id="alg1.l8.m1.3.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3.3"><minus id="alg1.l8.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3.3.3.3.1"></minus><ci id="alg1.l8.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3.3.3.3.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3.3.3.3">1</cn></apply></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">(\boldsymbol{P}^{t}_{k}-\boldsymbol{P}^{t-1},\boldsymbol{W}^{t}_{k}-\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t}_{k}-\widehat{\boldsymbol{W}}^{t-1})</annotation></semantics></math>, local gradient prototypes <math id="alg1.l8.m2.5" class="ltx_Math" alttext="\{\boldsymbol{g}_{\boldsymbol{W}^{t-1},k,c}^{pro}|c\in\mathcal{L}_{k}\}" display="inline"><semantics id="alg1.l8.m2.5a"><mrow id="alg1.l8.m2.5.5.2" xref="alg1.l8.m2.5.5.3.cmml"><mo stretchy="false" id="alg1.l8.m2.5.5.2.3" xref="alg1.l8.m2.5.5.3.1.cmml">{</mo><msubsup id="alg1.l8.m2.4.4.1.1" xref="alg1.l8.m2.4.4.1.1.cmml"><mi id="alg1.l8.m2.4.4.1.1.2.2" xref="alg1.l8.m2.4.4.1.1.2.2.cmml">𝒈</mi><mrow id="alg1.l8.m2.3.3.3.3" xref="alg1.l8.m2.3.3.3.4.cmml"><msup id="alg1.l8.m2.3.3.3.3.1" xref="alg1.l8.m2.3.3.3.3.1.cmml"><mi id="alg1.l8.m2.3.3.3.3.1.2" xref="alg1.l8.m2.3.3.3.3.1.2.cmml">𝑾</mi><mrow id="alg1.l8.m2.3.3.3.3.1.3" xref="alg1.l8.m2.3.3.3.3.1.3.cmml"><mi id="alg1.l8.m2.3.3.3.3.1.3.2" xref="alg1.l8.m2.3.3.3.3.1.3.2.cmml">t</mi><mo id="alg1.l8.m2.3.3.3.3.1.3.1" xref="alg1.l8.m2.3.3.3.3.1.3.1.cmml">−</mo><mn id="alg1.l8.m2.3.3.3.3.1.3.3" xref="alg1.l8.m2.3.3.3.3.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l8.m2.3.3.3.3.2" xref="alg1.l8.m2.3.3.3.4.cmml">,</mo><mi id="alg1.l8.m2.1.1.1.1" xref="alg1.l8.m2.1.1.1.1.cmml">k</mi><mo id="alg1.l8.m2.3.3.3.3.3" xref="alg1.l8.m2.3.3.3.4.cmml">,</mo><mi id="alg1.l8.m2.2.2.2.2" xref="alg1.l8.m2.2.2.2.2.cmml">c</mi></mrow><mrow id="alg1.l8.m2.4.4.1.1.3" xref="alg1.l8.m2.4.4.1.1.3.cmml"><mi id="alg1.l8.m2.4.4.1.1.3.2" xref="alg1.l8.m2.4.4.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m2.4.4.1.1.3.1" xref="alg1.l8.m2.4.4.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m2.4.4.1.1.3.3" xref="alg1.l8.m2.4.4.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m2.4.4.1.1.3.1a" xref="alg1.l8.m2.4.4.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m2.4.4.1.1.3.4" xref="alg1.l8.m2.4.4.1.1.3.4.cmml">o</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l8.m2.5.5.2.4" xref="alg1.l8.m2.5.5.3.1.cmml">|</mo><mrow id="alg1.l8.m2.5.5.2.2" xref="alg1.l8.m2.5.5.2.2.cmml"><mi id="alg1.l8.m2.5.5.2.2.2" xref="alg1.l8.m2.5.5.2.2.2.cmml">c</mi><mo id="alg1.l8.m2.5.5.2.2.1" xref="alg1.l8.m2.5.5.2.2.1.cmml">∈</mo><msub id="alg1.l8.m2.5.5.2.2.3" xref="alg1.l8.m2.5.5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.5.5.2.2.3.2" xref="alg1.l8.m2.5.5.2.2.3.2.cmml">ℒ</mi><mi id="alg1.l8.m2.5.5.2.2.3.3" xref="alg1.l8.m2.5.5.2.2.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="alg1.l8.m2.5.5.2.5" xref="alg1.l8.m2.5.5.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.5b"><apply id="alg1.l8.m2.5.5.3.cmml" xref="alg1.l8.m2.5.5.2"><csymbol cd="latexml" id="alg1.l8.m2.5.5.3.1.cmml" xref="alg1.l8.m2.5.5.2.3">conditional-set</csymbol><apply id="alg1.l8.m2.4.4.1.1.cmml" xref="alg1.l8.m2.4.4.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.4.4.1.1.1.cmml" xref="alg1.l8.m2.4.4.1.1">superscript</csymbol><apply id="alg1.l8.m2.4.4.1.1.2.cmml" xref="alg1.l8.m2.4.4.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.4.4.1.1.2.1.cmml" xref="alg1.l8.m2.4.4.1.1">subscript</csymbol><ci id="alg1.l8.m2.4.4.1.1.2.2.cmml" xref="alg1.l8.m2.4.4.1.1.2.2">𝒈</ci><list id="alg1.l8.m2.3.3.3.4.cmml" xref="alg1.l8.m2.3.3.3.3"><apply id="alg1.l8.m2.3.3.3.3.1.cmml" xref="alg1.l8.m2.3.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l8.m2.3.3.3.3.1.1.cmml" xref="alg1.l8.m2.3.3.3.3.1">superscript</csymbol><ci id="alg1.l8.m2.3.3.3.3.1.2.cmml" xref="alg1.l8.m2.3.3.3.3.1.2">𝑾</ci><apply id="alg1.l8.m2.3.3.3.3.1.3.cmml" xref="alg1.l8.m2.3.3.3.3.1.3"><minus id="alg1.l8.m2.3.3.3.3.1.3.1.cmml" xref="alg1.l8.m2.3.3.3.3.1.3.1"></minus><ci id="alg1.l8.m2.3.3.3.3.1.3.2.cmml" xref="alg1.l8.m2.3.3.3.3.1.3.2">𝑡</ci><cn type="integer" id="alg1.l8.m2.3.3.3.3.1.3.3.cmml" xref="alg1.l8.m2.3.3.3.3.1.3.3">1</cn></apply></apply><ci id="alg1.l8.m2.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1">𝑘</ci><ci id="alg1.l8.m2.2.2.2.2.cmml" xref="alg1.l8.m2.2.2.2.2">𝑐</ci></list></apply><apply id="alg1.l8.m2.4.4.1.1.3.cmml" xref="alg1.l8.m2.4.4.1.1.3"><times id="alg1.l8.m2.4.4.1.1.3.1.cmml" xref="alg1.l8.m2.4.4.1.1.3.1"></times><ci id="alg1.l8.m2.4.4.1.1.3.2.cmml" xref="alg1.l8.m2.4.4.1.1.3.2">𝑝</ci><ci id="alg1.l8.m2.4.4.1.1.3.3.cmml" xref="alg1.l8.m2.4.4.1.1.3.3">𝑟</ci><ci id="alg1.l8.m2.4.4.1.1.3.4.cmml" xref="alg1.l8.m2.4.4.1.1.3.4">𝑜</ci></apply></apply><apply id="alg1.l8.m2.5.5.2.2.cmml" xref="alg1.l8.m2.5.5.2.2"><in id="alg1.l8.m2.5.5.2.2.1.cmml" xref="alg1.l8.m2.5.5.2.2.1"></in><ci id="alg1.l8.m2.5.5.2.2.2.cmml" xref="alg1.l8.m2.5.5.2.2.2">𝑐</ci><apply id="alg1.l8.m2.5.5.2.2.3.cmml" xref="alg1.l8.m2.5.5.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m2.5.5.2.2.3.1.cmml" xref="alg1.l8.m2.5.5.2.2.3">subscript</csymbol><ci id="alg1.l8.m2.5.5.2.2.3.2.cmml" xref="alg1.l8.m2.5.5.2.2.3.2">ℒ</ci><ci id="alg1.l8.m2.5.5.2.2.3.3.cmml" xref="alg1.l8.m2.5.5.2.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.5c">\{\boldsymbol{g}_{\boldsymbol{W}^{t-1},k,c}^{pro}|c\in\mathcal{L}_{k}\}</annotation></semantics></math>.

</div>
</div>
</div>
</div>
</figure>
<section id="S3.SS3.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Local Training Stage</h4>

<div id="S3.SS3.SSSx1.p1" class="ltx_para">
<p id="S3.SS3.SSSx1.p1.7" class="ltx_p">In the local training, each client aims to solve the sub-problem of Eq. (<a href="#S3.E4" title="In 3.2 Our Optimization Target ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) as</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle(\boldsymbol{P}^{*},\boldsymbol{W}^{*},\widehat{\boldsymbol{W}^{*}})" display="inline"><semantics id="S3.E5X.2.1.1.m1.3a"><mrow id="S3.E5X.2.1.1.m1.3.3.2" xref="S3.E5X.2.1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.E5X.2.1.1.m1.3.3.2.3" xref="S3.E5X.2.1.1.m1.3.3.3.cmml">(</mo><msup id="S3.E5X.2.1.1.m1.2.2.1.1" xref="S3.E5X.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.2.2.1.1.2" xref="S3.E5X.2.1.1.m1.2.2.1.1.2.cmml">𝑷</mi><mo id="S3.E5X.2.1.1.m1.2.2.1.1.3" xref="S3.E5X.2.1.1.m1.2.2.1.1.3.cmml">∗</mo></msup><mo id="S3.E5X.2.1.1.m1.3.3.2.4" xref="S3.E5X.2.1.1.m1.3.3.3.cmml">,</mo><msup id="S3.E5X.2.1.1.m1.3.3.2.2" xref="S3.E5X.2.1.1.m1.3.3.2.2.cmml"><mi id="S3.E5X.2.1.1.m1.3.3.2.2.2" xref="S3.E5X.2.1.1.m1.3.3.2.2.2.cmml">𝑾</mi><mo id="S3.E5X.2.1.1.m1.3.3.2.2.3" xref="S3.E5X.2.1.1.m1.3.3.2.2.3.cmml">∗</mo></msup><mo id="S3.E5X.2.1.1.m1.3.3.2.5" xref="S3.E5X.2.1.1.m1.3.3.3.cmml">,</mo><mover accent="true" id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><msup id="S3.E5X.2.1.1.m1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.2.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2.2" xref="S3.E5X.2.1.1.m1.1.1.2.2.cmml">𝑾</mi><mo id="S3.E5X.2.1.1.m1.1.1.2.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.cmml">∗</mo></msup><mo id="S3.E5X.2.1.1.m1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S3.E5X.2.1.1.m1.3.3.2.6" xref="S3.E5X.2.1.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.3b"><vector id="S3.E5X.2.1.1.m1.3.3.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.2"><apply id="S3.E5X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E5X.2.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.2.2.1.1">superscript</csymbol><ci id="S3.E5X.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.2.2.1.1.2">𝑷</ci><times id="S3.E5X.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.2.2.1.1.3"></times></apply><apply id="S3.E5X.2.1.1.m1.3.3.2.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.3.3.2.2.1.cmml" xref="S3.E5X.2.1.1.m1.3.3.2.2">superscript</csymbol><ci id="S3.E5X.2.1.1.m1.3.3.2.2.2.cmml" xref="S3.E5X.2.1.1.m1.3.3.2.2.2">𝑾</ci><times id="S3.E5X.2.1.1.m1.3.3.2.2.3.cmml" xref="S3.E5X.2.1.1.m1.3.3.2.2.3"></times></apply><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><ci id="S3.E5X.2.1.1.m1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1">^</ci><apply id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2">superscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2">𝑾</ci><times id="S3.E5X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3"></times></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.3c">\displaystyle(\boldsymbol{P}^{*},\boldsymbol{W}^{*},\widehat{\boldsymbol{W}^{*}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.7" class="ltx_Math" alttext="\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{P},\boldsymbol{W},\widehat{\boldsymbol{W}}}L(\boldsymbol{P},\boldsymbol{W},\widehat{\boldsymbol{W}};\mathcal{D}_{k})," display="inline"><semantics id="S3.E5X.3.2.2.m1.7a"><mrow id="S3.E5X.3.2.2.m1.7.7.1" xref="S3.E5X.3.2.2.m1.7.7.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.7.7.1.1" xref="S3.E5X.3.2.2.m1.7.7.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.7.7.1.1.3" xref="S3.E5X.3.2.2.m1.7.7.1.1.3.cmml"></mi><mo id="S3.E5X.3.2.2.m1.7.7.1.1.2" xref="S3.E5X.3.2.2.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.7.7.1.1.1" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.cmml"><munder id="S3.E5X.3.2.2.m1.7.7.1.1.1.2" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2.cmml"><mrow id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.1" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2a" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.cmml">⁡</mo><mi id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.2" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S3.E5X.3.2.2.m1.3.3.3.5" xref="S3.E5X.3.2.2.m1.3.3.3.4.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml">𝑷</mi><mo id="S3.E5X.3.2.2.m1.3.3.3.5.1" xref="S3.E5X.3.2.2.m1.3.3.3.4.cmml">,</mo><mi id="S3.E5X.3.2.2.m1.2.2.2.2" xref="S3.E5X.3.2.2.m1.2.2.2.2.cmml">𝑾</mi><mo id="S3.E5X.3.2.2.m1.3.3.3.5.2" xref="S3.E5X.3.2.2.m1.3.3.3.4.cmml">,</mo><mover accent="true" id="S3.E5X.3.2.2.m1.3.3.3.3" xref="S3.E5X.3.2.2.m1.3.3.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.3.3.3.3.2" xref="S3.E5X.3.2.2.m1.3.3.3.3.2.cmml">𝑾</mi><mo id="S3.E5X.3.2.2.m1.3.3.3.3.1" xref="S3.E5X.3.2.2.m1.3.3.3.3.1.cmml">^</mo></mover></mrow></munder><mrow id="S3.E5X.3.2.2.m1.7.7.1.1.1.1" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5X.3.2.2.m1.4.4" xref="S3.E5X.3.2.2.m1.4.4.cmml">𝑷</mi><mo id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E5X.3.2.2.m1.5.5" xref="S3.E5X.3.2.2.m1.5.5.cmml">𝑾</mi><mo id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.4" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.E5X.3.2.2.m1.6.6" xref="S3.E5X.3.2.2.m1.6.6.cmml"><mi id="S3.E5X.3.2.2.m1.6.6.2" xref="S3.E5X.3.2.2.m1.6.6.2.cmml">𝑾</mi><mo id="S3.E5X.3.2.2.m1.6.6.1" xref="S3.E5X.3.2.2.m1.6.6.1.cmml">^</mo></mover><mo id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.5" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.6" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5X.3.2.2.m1.7.7.1.2" xref="S3.E5X.3.2.2.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.7b"><apply id="S3.E5X.3.2.2.m1.7.7.1.1.cmml" xref="S3.E5X.3.2.2.m1.7.7.1"><eq id="S3.E5X.3.2.2.m1.7.7.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.2"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.7.7.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.3">absent</csymbol><apply id="S3.E5X.3.2.2.m1.7.7.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1"><apply id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2"><arg id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.1"></arg><min id="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.2.2.2"></min></apply><list id="S3.E5X.3.2.2.m1.3.3.3.4.cmml" xref="S3.E5X.3.2.2.m1.3.3.3.5"><ci id="S3.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1">𝑷</ci><ci id="S3.E5X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.2.2">𝑾</ci><apply id="S3.E5X.3.2.2.m1.3.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.3.3.3.3"><ci id="S3.E5X.3.2.2.m1.3.3.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.3.3.3.3.1">^</ci><ci id="S3.E5X.3.2.2.m1.3.3.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.3.3.3.3.2">𝑾</ci></apply></list></apply><apply id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1"><times id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.2"></times><ci id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.3">𝐿</ci><vector id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1"><ci id="S3.E5X.3.2.2.m1.4.4.cmml" xref="S3.E5X.3.2.2.m1.4.4">𝑷</ci><ci id="S3.E5X.3.2.2.m1.5.5.cmml" xref="S3.E5X.3.2.2.m1.5.5">𝑾</ci><apply id="S3.E5X.3.2.2.m1.6.6.cmml" xref="S3.E5X.3.2.2.m1.6.6"><ci id="S3.E5X.3.2.2.m1.6.6.1.cmml" xref="S3.E5X.3.2.2.m1.6.6.1">^</ci><ci id="S3.E5X.3.2.2.m1.6.6.2.cmml" xref="S3.E5X.3.2.2.m1.6.6.2">𝑾</ci></apply><apply id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.7.7.1.1.1.1.1.1.1.3">𝑘</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.7c">\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{P},\boldsymbol{W},\widehat{\boldsymbol{W}}}L(\boldsymbol{P},\boldsymbol{W},\widehat{\boldsymbol{W}};\mathcal{D}_{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\text{s.t.}\qquad\boldsymbol{W}^{*}" display="inline"><semantics id="S3.E5Xa.2.1.1.m1.2a"><mrow id="S3.E5Xa.2.1.1.m1.2.2.1" xref="S3.E5Xa.2.1.1.m1.2.2.2.cmml"><mtext id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1a.cmml">s.t.</mtext><mspace width="2em" id="S3.E5Xa.2.1.1.m1.2.2.1.2" xref="S3.E5Xa.2.1.1.m1.2.2.2.cmml"></mspace><msup id="S3.E5Xa.2.1.1.m1.2.2.1.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2.cmml">𝑾</mi><mo id="S3.E5Xa.2.1.1.m1.2.2.1.1.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.2b"><list id="S3.E5Xa.2.1.1.m1.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1"><ci id="S3.E5Xa.2.1.1.m1.1.1a.cmml" xref="S3.E5Xa.2.1.1.m1.1.1"><mtext id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1">s.t.</mtext></ci><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1">superscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.2">𝑾</ci><times id="S3.E5Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.2c">\displaystyle\text{s.t.}\qquad\boldsymbol{W}^{*}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{W}}L(\boldsymbol{P}^{*},\boldsymbol{W};\mathcal{D}^{bal})." display="inline"><semantics id="S3.E5Xa.3.2.2.m1.2a"><mrow id="S3.E5Xa.3.2.2.m1.2.2.1" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.cmml"><mrow id="S3.E5Xa.3.2.2.m1.2.2.1.1" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.4" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.4.cmml"></mi><mo id="S3.E5Xa.3.2.2.m1.2.2.1.1.3" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E5Xa.3.2.2.m1.2.2.1.1.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.cmml"><munder id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.cmml"><mrow id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.1" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2a" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.cmml">⁡</mo><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.2.cmml">min</mi></mrow><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.3" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.3.cmml">𝑾</mi></munder><mrow id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.4" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.3" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml">​</mo><mrow id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.3" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">(</mo><msup id="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝑷</mi><mo id="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.4" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">,</mo><mi id="S3.E5Xa.3.2.2.m1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.cmml">𝑾</mi><mo id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.5" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">;</mo><msup id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.2.cmml">𝒟</mi><mrow id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.3" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1a" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.4" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.4.cmml">l</mi></mrow></msup><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.6" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5Xa.3.2.2.m1.2.2.1.2" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.2b"><apply id="S3.E5Xa.3.2.2.m1.2.2.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1"><eq id="S3.E5Xa.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.3"></eq><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.2.2.1.1.4.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.4">absent</csymbol><apply id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2"><apply id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3">subscript</csymbol><apply id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2"><arg id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.1"></arg><min id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.2.2"></min></apply><ci id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.3.3">𝑾</ci></apply><apply id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2"><times id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.3"></times><ci id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.4.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.4">𝐿</ci><vector id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2"><apply id="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2">𝑷</ci><times id="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3"></times></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1">𝑾</ci><apply id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.2">𝒟</ci><apply id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3"><times id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.2">𝑏</ci><ci id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.3">𝑎</ci><ci id="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.4.cmml" xref="S3.E5Xa.3.2.2.m1.2.2.1.1.2.2.2.2.2.3.4">𝑙</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.2c">\displaystyle=\mathop{\arg\min}\limits_{\boldsymbol{W}}L(\boldsymbol{P}^{*},\boldsymbol{W};\mathcal{D}^{bal}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.SSSx1.p1.6" class="ltx_p">It is a constrained optimization problem that is non-trivial to solve, we choose to address it by considering it as a multi-target learning task and optimizing all parameters concurrently. We briefly summarize the whole process of local training in our method in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. To specific, the encoder parameters <math id="S3.SS3.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{P}" display="inline"><semantics id="S3.SS3.SSSx1.p1.1.m1.1a"><mi id="S3.SS3.SSSx1.p1.1.m1.1.1" xref="S3.SS3.SSSx1.p1.1.m1.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.1.m1.1b"><ci id="S3.SS3.SSSx1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSSx1.p1.1.m1.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.1.m1.1c">\boldsymbol{P}</annotation></semantics></math> and the additional classifier <math id="S3.SS3.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}" display="inline"><semantics id="S3.SS3.SSSx1.p1.2.m2.1a"><mover accent="true" id="S3.SS3.SSSx1.p1.2.m2.1.1" xref="S3.SS3.SSSx1.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSSx1.p1.2.m2.1.1.2" xref="S3.SS3.SSSx1.p1.2.m2.1.1.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.p1.2.m2.1.1.1" xref="S3.SS3.SSSx1.p1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.2.m2.1b"><apply id="S3.SS3.SSSx1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSSx1.p1.2.m2.1.1"><ci id="S3.SS3.SSSx1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSSx1.p1.2.m2.1.1.1">^</ci><ci id="S3.SS3.SSSx1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSSx1.p1.2.m2.1.1.2">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.2.m2.1c">\widehat{\boldsymbol{W}}</annotation></semantics></math> will be trained under an instance-balanced manner (Line 3). When updating <math id="S3.SS3.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS3.SSSx1.p1.3.m3.1a"><mi id="S3.SS3.SSSx1.p1.3.m3.1.1" xref="S3.SS3.SSSx1.p1.3.m3.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.3.m3.1b"><ci id="S3.SS3.SSSx1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSSx1.p1.3.m3.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.3.m3.1c">\boldsymbol{W}</annotation></semantics></math>, besides the gradients of the batch samples from <math id="S3.SS3.SSSx1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.p1.4.m4.1a"><msub id="S3.SS3.SSSx1.p1.4.m4.1.1" xref="S3.SS3.SSSx1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.p1.4.m4.1.1.2" xref="S3.SS3.SSSx1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.p1.4.m4.1.1.3" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.4.m4.1b"><apply id="S3.SS3.SSSx1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1.2">𝒟</ci><ci id="S3.SS3.SSSx1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSSx1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.4.m4.1c">\mathcal{D}_{k}</annotation></semantics></math> (Line 4), our method creates a local balanced dataset <math id="S3.SS3.SSSx1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}^{bal}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.p1.5.m5.1a"><msubsup id="S3.SS3.SSSx1.p1.5.m5.1.1" xref="S3.SS3.SSSx1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.p1.5.m5.1.1.2.2" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.p1.5.m5.1.1.3" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.2" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.1" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.3" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.1a" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.4" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.5.m5.1b"><apply id="S3.SS3.SSSx1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.2">𝒟</ci><apply id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3"><times id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.1"></times><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.2">𝑏</ci><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.4.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.2.3.4">𝑙</ci></apply></apply><ci id="S3.SS3.SSSx1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSSx1.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.5.m5.1c">\mathcal{D}^{bal}_{k}</annotation></semantics></math> to help re-balancing <math id="S3.SS3.SSSx1.p1.6.m6.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS3.SSSx1.p1.6.m6.1a"><mi id="S3.SS3.SSSx1.p1.6.m6.1.1" xref="S3.SS3.SSSx1.p1.6.m6.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.p1.6.m6.1b"><ci id="S3.SS3.SSSx1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSSx1.p1.6.m6.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.p1.6.m6.1c">\boldsymbol{W}</annotation></semantics></math> (Line 5-6) following the second target of Eq. (<a href="#S3.E5" title="In Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). The detailed steps including the following parts:</p>
</div>
<section id="S3.SS3.SSSx1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Updating <math id="S3.SS3.SSSx1.Px1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{P}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.1.m1.1b"><mi id="S3.SS3.SSSx1.Px1.1.m1.1.1" xref="S3.SS3.SSSx1.Px1.1.m1.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.1.m1.1c"><ci id="S3.SS3.SSSx1.Px1.1.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.1.m1.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.1.m1.1d">\boldsymbol{P}</annotation></semantics></math> and <math id="S3.SS3.SSSx1.Px1.2.m2.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.2.m2.1b"><mover accent="true" id="S3.SS3.SSSx1.Px1.2.m2.1.1" xref="S3.SS3.SSSx1.Px1.2.m2.1.1.cmml"><mi id="S3.SS3.SSSx1.Px1.2.m2.1.1.2" xref="S3.SS3.SSSx1.Px1.2.m2.1.1.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px1.2.m2.1.1.1" xref="S3.SS3.SSSx1.Px1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.2.m2.1c"><apply id="S3.SS3.SSSx1.Px1.2.m2.1.1.cmml" xref="S3.SS3.SSSx1.Px1.2.m2.1.1"><ci id="S3.SS3.SSSx1.Px1.2.m2.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.2.m2.1.1.1">^</ci><ci id="S3.SS3.SSSx1.Px1.2.m2.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.2.m2.1.1.2">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.2.m2.1d">\widehat{\boldsymbol{W}}</annotation></semantics></math>.</h5>

<div id="S3.SS3.SSSx1.Px1.p1" class="ltx_para">
<p id="S3.SS3.SSSx1.Px1.p1.6" class="ltx_p">In the <math id="S3.SS3.SSSx1.Px1.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSSx1.Px1.p1.1.m1.1.1" xref="S3.SS3.SSSx1.Px1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSSx1.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.1.m1.1c">t</annotation></semantics></math>-th round,
we perform the normal stochastic gradient decent mechanism<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We do not have the assumption about the local optimizer, and any local optimizer (e.g., SGDM or Adam <cite class="ltx_cite ltx_citemacro_cite">Kingma and Ba (<a href="#bib.bib12" title="" class="ltx_ref">2014</a>)</cite>) is acceptable. Here, we take SGD as an example.</span></span></span> in which an instance-balanced dataloader is applied to update <math id="S3.SS3.SSSx1.Px1.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{P}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.2.m2.1a"><mi id="S3.SS3.SSSx1.Px1.p1.2.m2.1.1" xref="S3.SS3.SSSx1.Px1.p1.2.m2.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.2.m2.1b"><ci id="S3.SS3.SSSx1.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.2.m2.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.2.m2.1c">\boldsymbol{P}</annotation></semantics></math> and <math id="S3.SS3.SSSx1.Px1.p1.3.m3.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.3.m3.1a"><mover accent="true" id="S3.SS3.SSSx1.Px1.p1.3.m3.1.1" xref="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.2" xref="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.1" xref="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.3.m3.1.1"><ci id="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.1">^</ci><ci id="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.3.m3.1.1.2">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.3.m3.1c">\widehat{\boldsymbol{W}}</annotation></semantics></math>.<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>For simplicity, we omit the bias term here, while our method is still applicable when the bias term exists.</span></span></span> That is,
for the local step <math id="S3.SS3.SSSx1.Px1.p1.4.m4.4" class="ltx_Math" alttext="i=1,2,\cdots,I" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.4.m4.4a"><mrow id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.2" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.2.cmml">i</mi><mo id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.1" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.1.cmml">=</mo><mrow id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.2" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.1.cmml"><mn id="S3.SS3.SSSx1.Px1.p1.4.m4.1.1" xref="S3.SS3.SSSx1.Px1.p1.4.m4.1.1.cmml">1</mn><mo id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.2.1" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.1.cmml">,</mo><mn id="S3.SS3.SSSx1.Px1.p1.4.m4.2.2" xref="S3.SS3.SSSx1.Px1.p1.4.m4.2.2.cmml">2</mn><mo id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.2.2" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.SSSx1.Px1.p1.4.m4.3.3" xref="S3.SS3.SSSx1.Px1.p1.4.m4.3.3.cmml">⋯</mi><mo id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.2.3" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.1.cmml">,</mo><mi id="S3.SS3.SSSx1.Px1.p1.4.m4.4.4" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.4.cmml">I</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.4.m4.4b"><apply id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.cmml" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5"><eq id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.1"></eq><ci id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.2">𝑖</ci><list id="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.5.3.2"><cn type="integer" id="S3.SS3.SSSx1.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.4.m4.1.1">1</cn><cn type="integer" id="S3.SS3.SSSx1.Px1.p1.4.m4.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.4.m4.2.2">2</cn><ci id="S3.SS3.SSSx1.Px1.p1.4.m4.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.4.m4.3.3">⋯</ci><ci id="S3.SS3.SSSx1.Px1.p1.4.m4.4.4.cmml" xref="S3.SS3.SSSx1.Px1.p1.4.m4.4.4">𝐼</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.4.m4.4c">i=1,2,\cdots,I</annotation></semantics></math>, a random batch of examples <math id="S3.SS3.SSSx1.Px1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{B}_{k}^{i}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.5.m5.1a"><msubsup id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.2" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.2.cmml">ℬ</mi><mi id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.3" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.3.cmml">k</mi><mi id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.3" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.2">ℬ</ci><ci id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.5.m5.1c">\mathcal{B}_{k}^{i}</annotation></semantics></math> is sampled from <math id="S3.SS3.SSSx1.Px1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.6.m6.1a"><msub id="S3.SS3.SSSx1.Px1.p1.6.m6.1.1" xref="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.2" xref="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.3" xref="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.6.m6.1b"><apply id="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.2">𝒟</ci><ci id="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.6.m6.1c">\mathcal{D}_{k}</annotation></semantics></math> to perform that:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<div id="S3.E6.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_transformed_outer" style="width:418.1pt;height:79.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(139.9pt,-26.5pt) scale(3.02231410209601,3.02231410209601) ;">
<p id="S3.E6.m1.1.1.1.1" class="ltx_p"><math id="S3.E6.m1.1.1.1.1.m1.2" class="ltx_Math" alttext="\begin{aligned} \boldsymbol{P}^{i}_{k}&amp;=\boldsymbol{P}^{i-1}_{k}-\eta_{l}\nabla_{\boldsymbol{P}^{i-1}_{k}}L(\boldsymbol{P}^{i-1}_{k},\boldsymbol{W}^{i-1}_{k},\widehat{\boldsymbol{W}}^{i-1}_{k};\mathcal{B}_{k}^{i}),\\
\widehat{\boldsymbol{W}}^{i}_{k}&amp;=\widehat{\boldsymbol{W}}^{i-1}_{k}-\eta_{l}\nabla_{\widehat{\boldsymbol{W}}^{i-1}_{k}}L(\boldsymbol{P}^{i-1}_{k},\boldsymbol{W}^{i-1}_{k},\widehat{\boldsymbol{W}}^{i-1}_{k};\mathcal{B}_{k}^{i}),\end{aligned}" display="inline"><semantics id="S3.E6.m1.1.1.1.1.m1.2a"><mtable columnspacing="0pt" rowspacing="0pt" id="S3.E6.m1.1.1.1.1.m1.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.cmml"><mtr id="S3.E6.m1.1.1.1.1.m1.2.2a" xref="S3.E6.m1.1.1.1.1.m1.2.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.1.1.1.1.m1.2.2b" xref="S3.E6.m1.1.1.1.1.m1.2.2.cmml"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.2.cmml">𝑷</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.3.cmml">k</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.3.cmml">i</mi></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.1.1.1.1.m1.2.2c" xref="S3.E6.m1.1.1.1.1.m1.2.2.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.6" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.6.cmml"></mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.5" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.cmml"><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.2.cmml">𝑷</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.5" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.5.cmml">−</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.cmml"><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.2.cmml">η</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.3.cmml">l</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.5" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.5.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.cmml"><msub id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.cmml"><mo rspace="0.167em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.2.cmml">∇</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.2.cmml">𝑷</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.3.cmml">1</mn></mrow></msubsup></msub><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.5a" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.5.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.5.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.5" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.5.cmml">(</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝑷</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.6" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.5.cmml">,</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.7" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.5.cmml">,</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.2.cmml">𝑾</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.8" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.5.cmml">;</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.2.cmml">ℬ</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.3.cmml">k</mi><mi id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.3" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.9" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.5.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.m1.2.2d" xref="S3.E6.m1.1.1.1.1.m1.2.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.1.1.1.1.m1.2.2e" xref="S3.E6.m1.1.1.1.1.m1.2.2.cmml"><msubsup id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.2.cmml">𝑾</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.3.cmml">k</mi><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.3.cmml">i</mi></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E6.m1.1.1.1.1.m1.2.2f" xref="S3.E6.m1.1.1.1.1.m1.2.2.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.6" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.6.cmml"></mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.5" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.5.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.cmml"><msubsup id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.2.cmml">𝑾</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.5" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.5.cmml">−</mo><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.cmml"><msub id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.2.cmml">η</mi><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.3.cmml">l</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.5" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.5.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.cmml"><msub id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.cmml"><mo rspace="0.167em" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.2.cmml">∇</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.2.cmml">𝑾</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.3.cmml">1</mn></mrow></msubsup></msub><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.5a" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.5.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.5.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.5" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.5.cmml">(</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝑷</mi><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.6" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.5.cmml">,</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.7" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.5.cmml">,</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.2.cmml">𝑾</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.3.cmml">k</mi><mrow id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.1" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.8" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.5.cmml">;</mo><msubsup id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.2.cmml">ℬ</mi><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.3.cmml">k</mi><mi id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.3" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.9" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.5.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.2" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1.1.1.1.m1.2b"><matrix id="S3.E6.m1.1.1.1.1.m1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2"><matrixrow id="S3.E6.m1.1.1.1.1.m1.2.2a.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2"><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.2">𝑷</ci><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.2.3">𝑖</ci></apply><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.2.1.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.5"></eq><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.6.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.6">absent</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4"><minus id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.5"></minus><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.2">𝑷</ci><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.6.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4"><times id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.5"></times><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.2">𝜂</ci><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.6.3">𝑙</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7"><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.2">∇</ci><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.2">𝑷</ci><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.1.3.3">𝑘</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.7.2">𝐿</ci></apply><vector id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4"><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑷</ci><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.2">𝑾</ci><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.2.2.2.2.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2"><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.1">^</ci><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.2.2">𝑾</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.3.3.3.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.2">ℬ</ci><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.2.3">𝑘</ci></apply><ci id="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.1.1.1.1.1.1.1.4.4.4.4.4.3">𝑖</ci></apply></vector></apply></apply></apply></matrixrow><matrixrow id="S3.E6.m1.1.1.1.1.m1.2.2b.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2"><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2"><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.1">^</ci><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.2.2">𝑾</ci></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.2.3">𝑖</ci></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.2.1.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1"><eq id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.5"></eq><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.6.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.6">absent</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4"><minus id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.5"></minus><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2"><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.1">^</ci><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.2.2">𝑾</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.6.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4"><times id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.5"></times><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.2">𝜂</ci><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.6.3">𝑙</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7"><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.2">∇</ci><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2"><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.1">^</ci><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.2.2">𝑾</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.1.3.3">𝑘</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.7.2">𝐿</ci></apply><vector id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.5.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4"><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑷</ci><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.2">𝑾</ci><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.2.2.2.2.2.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2"><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.1">^</ci><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.2.2">𝑾</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3"><minus id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.3.3.3.3.3.3">𝑘</ci></apply><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.1.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.2">ℬ</ci><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.2.3">𝑘</ci></apply><ci id="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.3.cmml" xref="S3.E6.m1.1.1.1.1.m1.2.2.2.1.1.1.1.4.4.4.4.4.3">𝑖</ci></apply></vector></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1.1.1.1.m1.2c">\begin{aligned} \boldsymbol{P}^{i}_{k}&amp;=\boldsymbol{P}^{i-1}_{k}-\eta_{l}\nabla_{\boldsymbol{P}^{i-1}_{k}}L(\boldsymbol{P}^{i-1}_{k},\boldsymbol{W}^{i-1}_{k},\widehat{\boldsymbol{W}}^{i-1}_{k};\mathcal{B}_{k}^{i}),\\
\widehat{\boldsymbol{W}}^{i}_{k}&amp;=\widehat{\boldsymbol{W}}^{i-1}_{k}-\eta_{l}\nabla_{\widehat{\boldsymbol{W}}^{i-1}_{k}}L(\boldsymbol{P}^{i-1}_{k},\boldsymbol{W}^{i-1}_{k},\widehat{\boldsymbol{W}}^{i-1}_{k};\mathcal{B}_{k}^{i}),\end{aligned}</annotation></semantics></math></p>
</span></div>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="0" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSSx1.Px1.p1.16" class="ltx_p">in which the initial model <math id="S3.SS3.SSSx1.Px1.p1.7.m1.3" class="ltx_Math" alttext="(\boldsymbol{P}^{0}_{k},\boldsymbol{W}^{0}_{k},\widehat{\boldsymbol{W}}^{0}_{k})" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.7.m1.3a"><mrow id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.4" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.4.cmml">(</mo><msubsup id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.2" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.2.cmml">𝑷</mi><mi id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.3" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.3.cmml">k</mi><mn id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.3" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.5" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.2" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.3" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.3.cmml">k</mi><mn id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.3" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.3.cmml">0</mn></msubsup><mo id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.6" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.cmml"><mover accent="true" id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.2" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.1" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.3" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.3.cmml">k</mi><mn id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.3" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.7" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.7.m1.3b"><vector id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.4.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3"><apply id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.2">𝑷</ci><cn type="integer" id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.2.3">0</cn></apply><ci id="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.2">𝑾</ci><cn type="integer" id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.2.3">0</cn></apply><ci id="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.2.2.2.2.3">𝑘</ci></apply><apply id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3">subscript</csymbol><apply id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3">superscript</csymbol><apply id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2"><ci id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.1">^</ci><ci id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.2.2">𝑾</ci></apply><cn type="integer" id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.2.3">0</cn></apply><ci id="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.7.m1.3.3.3.3.3">𝑘</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.7.m1.3c">(\boldsymbol{P}^{0}_{k},\boldsymbol{W}^{0}_{k},\widehat{\boldsymbol{W}}^{0}_{k})</annotation></semantics></math> is chosen as the global model <math id="S3.SS3.SSSx1.Px1.p1.8.m2.3" class="ltx_Math" alttext="(\boldsymbol{P}^{t-1},\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t-1})" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.8.m2.3a"><mrow id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.4" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.4.cmml">(</mo><msup id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.2" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.2.cmml">𝑷</mi><mrow id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.2" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.1" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.3" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.5" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.4.cmml">,</mo><msup id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.2" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.2.cmml">𝑾</mi><mrow id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.2" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.1" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.3" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.6" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.4.cmml">,</mo><msup id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.cmml"><mover accent="true" id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.2" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.1" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.1.cmml">^</mo></mover><mrow id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.2" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.1" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.3" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.7" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.8.m2.3b"><vector id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.4.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3"><apply id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.2">𝑷</ci><apply id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3"><minus id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3"><minus id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.1"></minus><ci id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3">superscript</csymbol><apply id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2"><ci id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.1">^</ci><ci id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.2.2">𝑾</ci></apply><apply id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3"><minus id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.1"></minus><ci id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.8.m2.3.3.3.3.3.3">1</cn></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.8.m2.3c">(\boldsymbol{P}^{t-1},\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t-1})</annotation></semantics></math> received from the server in the current round, <math id="S3.SS3.SSSx1.Px1.p1.9.m3.1" class="ltx_Math" alttext="\eta_{l}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.9.m3.1a"><msub id="S3.SS3.SSSx1.Px1.p1.9.m3.1.1" xref="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.2" xref="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.2.cmml">η</mi><mi id="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.3" xref="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.9.m3.1b"><apply id="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.9.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.2">𝜂</ci><ci id="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.9.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.9.m3.1c">\eta_{l}</annotation></semantics></math> is the local learning rate. One important thing is, when calculating the above loss <math id="S3.SS3.SSSx1.Px1.p1.10.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.10.m4.1a"><mi id="S3.SS3.SSSx1.Px1.p1.10.m4.1.1" xref="S3.SS3.SSSx1.Px1.p1.10.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.10.m4.1b"><ci id="S3.SS3.SSSx1.Px1.p1.10.m4.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.10.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.10.m4.1c">l</annotation></semantics></math> on each sample <math id="S3.SS3.SSSx1.Px1.p1.11.m5.2" class="ltx_Math" alttext="(\boldsymbol{x},y)" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.11.m5.2a"><mrow id="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.2" xref="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.2.1" xref="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.1.cmml">(</mo><mi id="S3.SS3.SSSx1.Px1.p1.11.m5.1.1" xref="S3.SS3.SSSx1.Px1.p1.11.m5.1.1.cmml">𝒙</mi><mo id="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.2.2" xref="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.1.cmml">,</mo><mi id="S3.SS3.SSSx1.Px1.p1.11.m5.2.2" xref="S3.SS3.SSSx1.Px1.p1.11.m5.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.2.3" xref="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.11.m5.2b"><interval closure="open" id="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.11.m5.2.3.2"><ci id="S3.SS3.SSSx1.Px1.p1.11.m5.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.11.m5.1.1">𝒙</ci><ci id="S3.SS3.SSSx1.Px1.p1.11.m5.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.11.m5.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.11.m5.2c">(\boldsymbol{x},y)</annotation></semantics></math>, the representation vector <math id="S3.SS3.SSSx1.Px1.p1.12.m6.2" class="ltx_Math" alttext="\boldsymbol{h}:=f(\boldsymbol{x};\boldsymbol{P})" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.12.m6.2a"><mrow id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.2" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.2.cmml">𝒉</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.1" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.1.cmml">:=</mo><mrow id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.2" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.1" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.1.cmml">​</mo><mrow id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.2" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.2.1" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.1.cmml">(</mo><mi id="S3.SS3.SSSx1.Px1.p1.12.m6.1.1" xref="S3.SS3.SSSx1.Px1.p1.12.m6.1.1.cmml">𝒙</mi><mo id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.2.2" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.1.cmml">;</mo><mi id="S3.SS3.SSSx1.Px1.p1.12.m6.2.2" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.2.cmml">𝑷</mi><mo stretchy="false" id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.2.3" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.12.m6.2b"><apply id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3"><csymbol cd="latexml" id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.1">assign</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.2">𝒉</ci><apply id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3"><times id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.1"></times><ci id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.2">𝑓</ci><list id="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.3.3.3.2"><ci id="S3.SS3.SSSx1.Px1.p1.12.m6.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.1.1">𝒙</ci><ci id="S3.SS3.SSSx1.Px1.p1.12.m6.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.12.m6.2.2">𝑷</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.12.m6.2c">\boldsymbol{h}:=f(\boldsymbol{x};\boldsymbol{P})</annotation></semantics></math> will be first fed into both two classifiers and get two logits <math id="S3.SS3.SSSx1.Px1.p1.13.m7.1" class="ltx_Math" alttext="\boldsymbol{W}^{T}\boldsymbol{h}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.13.m7.1a"><mrow id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.cmml"><msup id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.2" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.2.cmml">𝑾</mi><mi id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.3" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.1" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.3" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.3.cmml">𝒉</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.13.m7.1b"><apply id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1"><times id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.1"></times><apply id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.2">𝑾</ci><ci id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.2.3">𝑇</ci></apply><ci id="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.13.m7.1.1.3">𝒉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.13.m7.1c">\boldsymbol{W}^{T}\boldsymbol{h}</annotation></semantics></math> and <math id="S3.SS3.SSSx1.Px1.p1.14.m8.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}^{T}\boldsymbol{h}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.14.m8.1a"><mrow id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.cmml"><msup id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.cmml"><mover accent="true" id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.2" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.1" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.3" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.1" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.3" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.3.cmml">𝒉</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.14.m8.1b"><apply id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1"><times id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.1"></times><apply id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2">superscript</csymbol><apply id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2"><ci id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.1">^</ci><ci id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.2.2">𝑾</ci></apply><ci id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.2.3">𝑇</ci></apply><ci id="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.14.m8.1.1.3">𝒉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.14.m8.1c">\widehat{\boldsymbol{W}}^{T}\boldsymbol{h}</annotation></semantics></math>. Then we perform the element-wise addition to get the final logits <math id="S3.SS3.SSSx1.Px1.p1.15.m9.1" class="ltx_Math" alttext="\boldsymbol{z}=\boldsymbol{W}^{T}\boldsymbol{h}+\widehat{\boldsymbol{W}}^{T}\boldsymbol{h}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.15.m9.1a"><mrow id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.2" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.2.cmml">𝒛</mi><mo id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.1" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.cmml"><mrow id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.cmml"><msup id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.2" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.2.cmml">𝑾</mi><mi id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.3" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.1" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.3" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.3.cmml">𝒉</mi></mrow><mo id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.1" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.1.cmml">+</mo><mrow id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.cmml"><msup id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.cmml"><mover accent="true" id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.cmml"><mi id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.2" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.1" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.3" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.1" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.3" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.3.cmml">𝒉</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.15.m9.1b"><apply id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1"><eq id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.1"></eq><ci id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.2">𝒛</ci><apply id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3"><plus id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.1"></plus><apply id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2"><times id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.1"></times><apply id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.2">𝑾</ci><ci id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.2.3">𝑇</ci></apply><ci id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.2.3">𝒉</ci></apply><apply id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3"><times id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.1"></times><apply id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2">superscript</csymbol><apply id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2"><ci id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.1">^</ci><ci id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.2.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.2.2">𝑾</ci></apply><ci id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.2.3">𝑇</ci></apply><ci id="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.3.cmml" xref="S3.SS3.SSSx1.Px1.p1.15.m9.1.1.3.3.3">𝒉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.15.m9.1c">\boldsymbol{z}=\boldsymbol{W}^{T}\boldsymbol{h}+\widehat{\boldsymbol{W}}^{T}\boldsymbol{h}</annotation></semantics></math>, and use <math id="S3.SS3.SSSx1.Px1.p1.16.m10.1" class="ltx_Math" alttext="\boldsymbol{z}" display="inline"><semantics id="S3.SS3.SSSx1.Px1.p1.16.m10.1a"><mi id="S3.SS3.SSSx1.Px1.p1.16.m10.1.1" xref="S3.SS3.SSSx1.Px1.p1.16.m10.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px1.p1.16.m10.1b"><ci id="S3.SS3.SSSx1.Px1.p1.16.m10.1.1.cmml" xref="S3.SS3.SSSx1.Px1.p1.16.m10.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px1.p1.16.m10.1c">\boldsymbol{z}</annotation></semantics></math> for the loss calculation.</p>
</div>
</section>
<section id="S3.SS3.SSSx1.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Updating <math id="S3.SS3.SSSx1.Px2.1.m1.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.1.m1.1b"><mi id="S3.SS3.SSSx1.Px2.1.m1.1.1" xref="S3.SS3.SSSx1.Px2.1.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.1.m1.1c"><ci id="S3.SS3.SSSx1.Px2.1.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.1.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.1.m1.1d">\boldsymbol{W}</annotation></semantics></math>.</h5>

<div id="S3.SS3.SSSx1.Px2.p1" class="ltx_para">
<p id="S3.SS3.SSSx1.Px2.p1.2" class="ltx_p">When updating <math id="S3.SS3.SSSx1.Px2.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.1.m1.1a"><mi id="S3.SS3.SSSx1.Px2.p1.1.m1.1.1" xref="S3.SS3.SSSx1.Px2.p1.1.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.1.m1.1b"><ci id="S3.SS3.SSSx1.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.1.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.1.m1.1c">\boldsymbol{W}</annotation></semantics></math>, one part of gradients comes from the above back propagation process on <math id="S3.SS3.SSSx1.Px2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{B}_{k}^{i}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.2.m2.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.2.cmml">ℬ</mi><mi id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.3.cmml">k</mi><mi id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.2.m2.1b"><apply id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.2">ℬ</ci><ci id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.2.m2.1c">\mathcal{B}_{k}^{i}</annotation></semantics></math> as</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{local}=\nabla_{\boldsymbol{W}^{i-1}_{k}}L(\boldsymbol{P}^{i-1}_{k},\boldsymbol{W}^{i-1}_{k},\widehat{\boldsymbol{W}}^{i-1}_{k};\mathcal{B}_{k}^{i})," display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.1.1.1.1.6" xref="S3.E7.m1.1.1.1.1.6.cmml"><mi id="S3.E7.m1.1.1.1.1.6.2.2" xref="S3.E7.m1.1.1.1.1.6.2.2.cmml">𝒈</mi><msubsup id="S3.E7.m1.1.1.1.1.6.2.3" xref="S3.E7.m1.1.1.1.1.6.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.6.2.3.2.2" xref="S3.E7.m1.1.1.1.1.6.2.3.2.2.cmml">𝑾</mi><mi id="S3.E7.m1.1.1.1.1.6.2.3.3" xref="S3.E7.m1.1.1.1.1.6.2.3.3.cmml">k</mi><mrow id="S3.E7.m1.1.1.1.1.6.2.3.2.3" xref="S3.E7.m1.1.1.1.1.6.2.3.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.6.2.3.2.3.2" xref="S3.E7.m1.1.1.1.1.6.2.3.2.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.6.2.3.2.3.1" xref="S3.E7.m1.1.1.1.1.6.2.3.2.3.1.cmml">−</mo><mn id="S3.E7.m1.1.1.1.1.6.2.3.2.3.3" xref="S3.E7.m1.1.1.1.1.6.2.3.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E7.m1.1.1.1.1.6.3" xref="S3.E7.m1.1.1.1.1.6.3.cmml"><mi id="S3.E7.m1.1.1.1.1.6.3.2" xref="S3.E7.m1.1.1.1.1.6.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.6.3.1" xref="S3.E7.m1.1.1.1.1.6.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.6.3.3" xref="S3.E7.m1.1.1.1.1.6.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.6.3.1a" xref="S3.E7.m1.1.1.1.1.6.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.6.3.4" xref="S3.E7.m1.1.1.1.1.6.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.6.3.1b" xref="S3.E7.m1.1.1.1.1.6.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.6.3.5" xref="S3.E7.m1.1.1.1.1.6.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.6.3.1c" xref="S3.E7.m1.1.1.1.1.6.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.1.6.3.6" xref="S3.E7.m1.1.1.1.1.6.3.6.cmml">l</mi></mrow></msubsup><mo id="S3.E7.m1.1.1.1.1.5" xref="S3.E7.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.4.cmml"><mrow id="S3.E7.m1.1.1.1.1.4.6" xref="S3.E7.m1.1.1.1.1.4.6.cmml"><msub id="S3.E7.m1.1.1.1.1.4.6.1" xref="S3.E7.m1.1.1.1.1.4.6.1.cmml"><mo rspace="0.167em" id="S3.E7.m1.1.1.1.1.4.6.1.2" xref="S3.E7.m1.1.1.1.1.4.6.1.2.cmml">∇</mo><msubsup id="S3.E7.m1.1.1.1.1.4.6.1.3" xref="S3.E7.m1.1.1.1.1.4.6.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.4.6.1.3.2.2" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.2.cmml">𝑾</mi><mi id="S3.E7.m1.1.1.1.1.4.6.1.3.3" xref="S3.E7.m1.1.1.1.1.4.6.1.3.3.cmml">k</mi><mrow id="S3.E7.m1.1.1.1.1.4.6.1.3.2.3" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.2" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.1" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.1.cmml">−</mo><mn id="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.3" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.3.cmml">1</mn></mrow></msubsup></msub><mi id="S3.E7.m1.1.1.1.1.4.6.2" xref="S3.E7.m1.1.1.1.1.4.6.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.4.5" xref="S3.E7.m1.1.1.1.1.4.5.cmml">​</mo><mrow id="S3.E7.m1.1.1.1.1.4.4.4" xref="S3.E7.m1.1.1.1.1.4.4.5.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.4.4.4.5" xref="S3.E7.m1.1.1.1.1.4.4.5.cmml">(</mo><msubsup id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝑷</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E7.m1.1.1.1.1.4.4.4.6" xref="S3.E7.m1.1.1.1.1.4.4.5.cmml">,</mo><msubsup id="S3.E7.m1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.E7.m1.1.1.1.1.2.2.2.2.3" xref="S3.E7.m1.1.1.1.1.2.2.2.2.3.cmml">k</mi><mrow id="S3.E7.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.2" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.1" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.3" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E7.m1.1.1.1.1.4.4.4.7" xref="S3.E7.m1.1.1.1.1.4.4.5.cmml">,</mo><msubsup id="S3.E7.m1.1.1.1.1.3.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.3.cmml"><mover accent="true" id="S3.E7.m1.1.1.1.1.3.3.3.3.2.2" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.2" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.2.cmml">𝑾</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.1" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.3.3.cmml">k</mi><mrow id="S3.E7.m1.1.1.1.1.3.3.3.3.2.3" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.2" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.1" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.1.cmml">−</mo><mn id="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E7.m1.1.1.1.1.4.4.4.8" xref="S3.E7.m1.1.1.1.1.4.4.5.cmml">;</mo><msubsup id="S3.E7.m1.1.1.1.1.4.4.4.4" xref="S3.E7.m1.1.1.1.1.4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.4.4.4.4.2.2" xref="S3.E7.m1.1.1.1.1.4.4.4.4.2.2.cmml">ℬ</mi><mi id="S3.E7.m1.1.1.1.1.4.4.4.4.2.3" xref="S3.E7.m1.1.1.1.1.4.4.4.4.2.3.cmml">k</mi><mi id="S3.E7.m1.1.1.1.1.4.4.4.4.3" xref="S3.E7.m1.1.1.1.1.4.4.4.4.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E7.m1.1.1.1.1.4.4.4.9" xref="S3.E7.m1.1.1.1.1.4.4.5.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.5.cmml" xref="S3.E7.m1.1.1.1.1.5"></eq><apply id="S3.E7.m1.1.1.1.1.6.cmml" xref="S3.E7.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.6.1.cmml" xref="S3.E7.m1.1.1.1.1.6">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.6.2.cmml" xref="S3.E7.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.6.2.1.cmml" xref="S3.E7.m1.1.1.1.1.6">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.6.2.2.cmml" xref="S3.E7.m1.1.1.1.1.6.2.2">𝒈</ci><apply id="S3.E7.m1.1.1.1.1.6.2.3.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.6.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.6.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.6.2.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.6.2.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3.2.2">𝑾</ci><apply id="S3.E7.m1.1.1.1.1.6.2.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3.2.3"><minus id="S3.E7.m1.1.1.1.1.6.2.3.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3.2.3.1"></minus><ci id="S3.E7.m1.1.1.1.1.6.2.3.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.1.1.1.1.6.2.3.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.1.1.1.1.6.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.6.2.3.3">𝑘</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.6.3.cmml" xref="S3.E7.m1.1.1.1.1.6.3"><times id="S3.E7.m1.1.1.1.1.6.3.1.cmml" xref="S3.E7.m1.1.1.1.1.6.3.1"></times><ci id="S3.E7.m1.1.1.1.1.6.3.2.cmml" xref="S3.E7.m1.1.1.1.1.6.3.2">𝑙</ci><ci id="S3.E7.m1.1.1.1.1.6.3.3.cmml" xref="S3.E7.m1.1.1.1.1.6.3.3">𝑜</ci><ci id="S3.E7.m1.1.1.1.1.6.3.4.cmml" xref="S3.E7.m1.1.1.1.1.6.3.4">𝑐</ci><ci id="S3.E7.m1.1.1.1.1.6.3.5.cmml" xref="S3.E7.m1.1.1.1.1.6.3.5">𝑎</ci><ci id="S3.E7.m1.1.1.1.1.6.3.6.cmml" xref="S3.E7.m1.1.1.1.1.6.3.6">𝑙</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.4"><times id="S3.E7.m1.1.1.1.1.4.5.cmml" xref="S3.E7.m1.1.1.1.1.4.5"></times><apply id="S3.E7.m1.1.1.1.1.4.6.cmml" xref="S3.E7.m1.1.1.1.1.4.6"><apply id="S3.E7.m1.1.1.1.1.4.6.1.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.4.6.1.1.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.4.6.1.2.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.2">∇</ci><apply id="S3.E7.m1.1.1.1.1.4.6.1.3.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.4.6.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.4.6.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.4.6.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.4.6.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.2">𝑾</ci><apply id="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.3"><minus id="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.1"></minus><ci id="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.1.1.1.1.4.6.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.4.6.1.3.3">𝑘</ci></apply></apply><ci id="S3.E7.m1.1.1.1.1.4.6.2.cmml" xref="S3.E7.m1.1.1.1.1.4.6.2">𝐿</ci></apply><vector id="S3.E7.m1.1.1.1.1.4.4.5.cmml" xref="S3.E7.m1.1.1.1.1.4.4.4"><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.2">𝑷</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3"><minus id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E7.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.2">𝑾</ci><apply id="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.3"><minus id="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.1"></minus><ci id="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.2"><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.1">^</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.2.2">𝑾</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.3"><minus id="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.1"></minus><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3.3">𝑘</ci></apply><apply id="S3.E7.m1.1.1.1.1.4.4.4.4.cmml" xref="S3.E7.m1.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.4.4.4.4.1.cmml" xref="S3.E7.m1.1.1.1.1.4.4.4.4">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.4.4.4.4.2.cmml" xref="S3.E7.m1.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.4.4.4.4.2.1.cmml" xref="S3.E7.m1.1.1.1.1.4.4.4.4">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.4.4.4.4.2.2.cmml" xref="S3.E7.m1.1.1.1.1.4.4.4.4.2.2">ℬ</ci><ci id="S3.E7.m1.1.1.1.1.4.4.4.4.2.3.cmml" xref="S3.E7.m1.1.1.1.1.4.4.4.4.2.3">𝑘</ci></apply><ci id="S3.E7.m1.1.1.1.1.4.4.4.4.3.cmml" xref="S3.E7.m1.1.1.1.1.4.4.4.4.3">𝑖</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{local}=\nabla_{\boldsymbol{W}^{i-1}_{k}}L(\boldsymbol{P}^{i-1}_{k},\boldsymbol{W}^{i-1}_{k},\widehat{\boldsymbol{W}}^{i-1}_{k};\mathcal{B}_{k}^{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSSx1.Px2.p1.20" class="ltx_p">which corresponds to the first part in Eq. (<a href="#S3.E5" title="In Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). For the second part of Eq. (<a href="#S3.E5" title="In Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), it needs to calculate the gradients of <math id="S3.SS3.SSSx1.Px2.p1.3.m1.1" class="ltx_Math" alttext="\boldsymbol{W}^{i-1}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.3.m1.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.2.cmml">𝑾</mi><mi id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.3.m1.1b"><apply id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3"><minus id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.3.m1.1c">\boldsymbol{W}^{i-1}_{k}</annotation></semantics></math> on a small balanced set <math id="S3.SS3.SSSx1.Px2.p1.4.m2.1" class="ltx_Math" alttext="\mathcal{D}^{bal}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.4.m2.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.1a" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.4" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.4.m2.1b"><apply id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.2">𝒟</ci><apply id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3"><times id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.2">𝑏</ci><ci id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.2.3.4">𝑙</ci></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.4.m2.1c">\mathcal{D}^{bal}_{k}</annotation></semantics></math>, that is supposed to be created in the local. However, there exists difficulty in constructing <math id="S3.SS3.SSSx1.Px2.p1.5.m3.1" class="ltx_Math" alttext="\mathcal{D}^{bal}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.5.m3.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.1a" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.4" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.5.m3.1b"><apply id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.2">𝒟</ci><apply id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3"><times id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.2">𝑏</ci><ci id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.2.3.4">𝑙</ci></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.5.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.5.m3.1c">\mathcal{D}^{bal}_{k}</annotation></semantics></math> from <math id="S3.SS3.SSSx1.Px2.p1.6.m4.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.6.m4.1a"><msub id="S3.SS3.SSSx1.Px2.p1.6.m4.1.1" xref="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.6.m4.1b"><apply id="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.6.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.2">𝒟</ci><ci id="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.6.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.6.m4.1c">\mathcal{D}_{k}</annotation></semantics></math>, since it is very likely that there are some classes missing in the local label set <math id="S3.SS3.SSSx1.Px2.p1.7.m5.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.7.m5.1a"><msub id="S3.SS3.SSSx1.Px2.p1.7.m5.1.1" xref="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.7.m5.1b"><apply id="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.7.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.2">ℒ</ci><ci id="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.7.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.7.m5.1c">\mathcal{L}_{k}</annotation></semantics></math> of <math id="S3.SS3.SSSx1.Px2.p1.8.m6.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.8.m6.1a"><msub id="S3.SS3.SSSx1.Px2.p1.8.m6.1.1" xref="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.8.m6.1b"><apply id="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.8.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.8.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.2">𝒟</ci><ci id="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.8.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.8.m6.1c">\mathcal{D}_{k}</annotation></semantics></math> due to the non-i.i.d. data partitions. Then, we propose a <span id="S3.SS3.SSSx1.Px2.p1.20.1" class="ltx_text ltx_font_italic">mixed gradient re-balancing mechanism</span> to overcome this challenge by integ<span id="S3.SS3.SSSx1.Px2.p1.20.2" class="ltx_text ltx_font_bold">R</span>ating local r<span id="S3.SS3.SSSx1.Px2.p1.20.3" class="ltx_text ltx_font_bold">E</span>al <span id="S3.SS3.SSSx1.Px2.p1.20.4" class="ltx_text ltx_font_bold">D</span>ata with <span id="S3.SS3.SSSx1.Px2.p1.20.5" class="ltx_text ltx_font_bold">G</span>lobal g<span id="S3.SS3.SSSx1.Px2.p1.20.6" class="ltx_text ltx_font_bold">RA</span>dient prototy<span id="S3.SS3.SSSx1.Px2.p1.20.7" class="ltx_text ltx_font_bold">PE</span>s (<span id="S3.SS3.SSSx1.Px2.p1.20.8" class="ltx_text ltx_font_bold">RedGrape</span> as our method).
Specifically, for each class <math id="S3.SS3.SSSx1.Px2.p1.9.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.9.m7.1a"><mi id="S3.SS3.SSSx1.Px2.p1.9.m7.1.1" xref="S3.SS3.SSSx1.Px2.p1.9.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.9.m7.1b"><ci id="S3.SS3.SSSx1.Px2.p1.9.m7.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.9.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.9.m7.1c">c</annotation></semantics></math>, <span id="S3.SS3.SSSx1.Px2.p1.20.9" class="ltx_text ltx_font_bold">(1)</span> if the sample quantity of class <math id="S3.SS3.SSSx1.Px2.p1.10.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.10.m8.1a"><mi id="S3.SS3.SSSx1.Px2.p1.10.m8.1.1" xref="S3.SS3.SSSx1.Px2.p1.10.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.10.m8.1b"><ci id="S3.SS3.SSSx1.Px2.p1.10.m8.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.10.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.10.m8.1c">c</annotation></semantics></math> in <math id="S3.SS3.SSSx1.Px2.p1.11.m9.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.11.m9.1a"><msub id="S3.SS3.SSSx1.Px2.p1.11.m9.1.1" xref="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.11.m9.1b"><apply id="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.11.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.11.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.2">𝒟</ci><ci id="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.11.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.11.m9.1c">\mathcal{D}_{k}</annotation></semantics></math> reaches a threshold <math id="S3.SS3.SSSx1.Px2.p1.12.m10.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.12.m10.1a"><mi id="S3.SS3.SSSx1.Px2.p1.12.m10.1.1" xref="S3.SS3.SSSx1.Px2.p1.12.m10.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.12.m10.1b"><ci id="S3.SS3.SSSx1.Px2.p1.12.m10.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.12.m10.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.12.m10.1c">T</annotation></semantics></math>, we think client <math id="S3.SS3.SSSx1.Px2.p1.13.m11.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.13.m11.1a"><mi id="S3.SS3.SSSx1.Px2.p1.13.m11.1.1" xref="S3.SS3.SSSx1.Px2.p1.13.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.13.m11.1b"><ci id="S3.SS3.SSSx1.Px2.p1.13.m11.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.13.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.13.m11.1c">k</annotation></semantics></math> have sufficient samples of class <math id="S3.SS3.SSSx1.Px2.p1.14.m12.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.14.m12.1a"><mi id="S3.SS3.SSSx1.Px2.p1.14.m12.1.1" xref="S3.SS3.SSSx1.Px2.p1.14.m12.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.14.m12.1b"><ci id="S3.SS3.SSSx1.Px2.p1.14.m12.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.14.m12.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.14.m12.1c">c</annotation></semantics></math> in its local dataset, and randomly sample <math id="S3.SS3.SSSx1.Px2.p1.15.m13.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.15.m13.1a"><mi id="S3.SS3.SSSx1.Px2.p1.15.m13.1.1" xref="S3.SS3.SSSx1.Px2.p1.15.m13.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.15.m13.1b"><ci id="S3.SS3.SSSx1.Px2.p1.15.m13.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.15.m13.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.15.m13.1c">T</annotation></semantics></math> training samples of class <math id="S3.SS3.SSSx1.Px2.p1.16.m14.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.16.m14.1a"><mi id="S3.SS3.SSSx1.Px2.p1.16.m14.1.1" xref="S3.SS3.SSSx1.Px2.p1.16.m14.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.16.m14.1b"><ci id="S3.SS3.SSSx1.Px2.p1.16.m14.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.16.m14.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.16.m14.1c">c</annotation></semantics></math> to form <math id="S3.SS3.SSSx1.Px2.p1.17.m15.2" class="ltx_Math" alttext="\mathcal{D}^{bal}_{k,c}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.17.m15.2a"><msubsup id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.2" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.2.cmml">𝒟</mi><mrow id="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.4" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.17.m15.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.17.m15.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.4.1" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.1a" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.4" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.17.m15.2b"><apply id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.2">𝒟</ci><apply id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3"><times id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.2">𝑏</ci><ci id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.3">𝑎</ci><ci id="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.3.2.3.4">𝑙</ci></apply></apply><list id="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.4"><ci id="S3.SS3.SSSx1.Px2.p1.17.m15.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.17.m15.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.17.m15.2c">\mathcal{D}^{bal}_{k,c}</annotation></semantics></math> for <math id="S3.SS3.SSSx1.Px2.p1.18.m16.1" class="ltx_Math" alttext="\mathcal{D}^{bal}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.18.m16.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.1a" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.4" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.18.m16.1b"><apply id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.2">𝒟</ci><apply id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3"><times id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.2">𝑏</ci><ci id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.2.3.4">𝑙</ci></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.18.m16.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.18.m16.1c">\mathcal{D}^{bal}_{k}</annotation></semantics></math>.<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>In different rounds, client <math id="footnote3.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="footnote3.m1.1b"><mi id="footnote3.m1.1.1" xref="footnote3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="footnote3.m1.1c"><ci id="footnote3.m1.1.1.cmml" xref="footnote3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m1.1d">k</annotation></semantics></math> can choose different <math id="footnote3.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="footnote3.m2.1b"><mi id="footnote3.m2.1.1" xref="footnote3.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="footnote3.m2.1c"><ci id="footnote3.m2.1.1.cmml" xref="footnote3.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m2.1d">T</annotation></semantics></math> samples of class <math id="footnote3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="footnote3.m3.1b"><mi id="footnote3.m3.1.1" xref="footnote3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="footnote3.m3.1c"><ci id="footnote3.m3.1.1.cmml" xref="footnote3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m3.1d">c</annotation></semantics></math> for <math id="footnote3.m4.2" class="ltx_Math" alttext="\mathcal{D}^{bal}_{k,c}" display="inline"><semantics id="footnote3.m4.2b"><msubsup id="footnote3.m4.2.3" xref="footnote3.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="footnote3.m4.2.3.2.2" xref="footnote3.m4.2.3.2.2.cmml">𝒟</mi><mrow id="footnote3.m4.2.2.2.4" xref="footnote3.m4.2.2.2.3.cmml"><mi id="footnote3.m4.1.1.1.1" xref="footnote3.m4.1.1.1.1.cmml">k</mi><mo id="footnote3.m4.2.2.2.4.1" xref="footnote3.m4.2.2.2.3.cmml">,</mo><mi id="footnote3.m4.2.2.2.2" xref="footnote3.m4.2.2.2.2.cmml">c</mi></mrow><mrow id="footnote3.m4.2.3.2.3" xref="footnote3.m4.2.3.2.3.cmml"><mi id="footnote3.m4.2.3.2.3.2" xref="footnote3.m4.2.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="footnote3.m4.2.3.2.3.1" xref="footnote3.m4.2.3.2.3.1.cmml">​</mo><mi id="footnote3.m4.2.3.2.3.3" xref="footnote3.m4.2.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="footnote3.m4.2.3.2.3.1b" xref="footnote3.m4.2.3.2.3.1.cmml">​</mo><mi id="footnote3.m4.2.3.2.3.4" xref="footnote3.m4.2.3.2.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="footnote3.m4.2c"><apply id="footnote3.m4.2.3.cmml" xref="footnote3.m4.2.3"><csymbol cd="ambiguous" id="footnote3.m4.2.3.1.cmml" xref="footnote3.m4.2.3">subscript</csymbol><apply id="footnote3.m4.2.3.2.cmml" xref="footnote3.m4.2.3"><csymbol cd="ambiguous" id="footnote3.m4.2.3.2.1.cmml" xref="footnote3.m4.2.3">superscript</csymbol><ci id="footnote3.m4.2.3.2.2.cmml" xref="footnote3.m4.2.3.2.2">𝒟</ci><apply id="footnote3.m4.2.3.2.3.cmml" xref="footnote3.m4.2.3.2.3"><times id="footnote3.m4.2.3.2.3.1.cmml" xref="footnote3.m4.2.3.2.3.1"></times><ci id="footnote3.m4.2.3.2.3.2.cmml" xref="footnote3.m4.2.3.2.3.2">𝑏</ci><ci id="footnote3.m4.2.3.2.3.3.cmml" xref="footnote3.m4.2.3.2.3.3">𝑎</ci><ci id="footnote3.m4.2.3.2.3.4.cmml" xref="footnote3.m4.2.3.2.3.4">𝑙</ci></apply></apply><list id="footnote3.m4.2.2.2.3.cmml" xref="footnote3.m4.2.2.2.4"><ci id="footnote3.m4.1.1.1.1.cmml" xref="footnote3.m4.1.1.1.1">𝑘</ci><ci id="footnote3.m4.2.2.2.2.cmml" xref="footnote3.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m4.2d">\mathcal{D}^{bal}_{k,c}</annotation></semantics></math>, in order to make fully use of the local real data.</span></span></span> Then, the gradients contributed by class <math id="S3.SS3.SSSx1.Px2.p1.19.m17.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.19.m17.1a"><mi id="S3.SS3.SSSx1.Px2.p1.19.m17.1.1" xref="S3.SS3.SSSx1.Px2.p1.19.m17.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.19.m17.1b"><ci id="S3.SS3.SSSx1.Px2.p1.19.m17.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.19.m17.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.19.m17.1c">c</annotation></semantics></math> in <math id="S3.SS3.SSSx1.Px2.p1.20.m18.1" class="ltx_Math" alttext="\mathcal{D}^{bal}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.20.m18.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.1a" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.4" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.20.m18.1b"><apply id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.2">𝒟</ci><apply id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3"><times id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.2">𝑏</ci><ci id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.2.3.4">𝑙</ci></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.20.m18.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.20.m18.1c">\mathcal{D}^{bal}_{k}</annotation></semantics></math> is</p>
<table id="S3.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8X.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k},c}=\nabla_{\boldsymbol{W}^{i-1}_{k}}L(\boldsymbol{P}^{i-1}_{k},\boldsymbol{W}^{i-1}_{k};D^{bal}_{k,c})." display="inline"><semantics id="S3.E8X.2.1.1.m1.5a"><mrow id="S3.E8X.2.1.1.m1.5.5.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.cmml"><mrow id="S3.E8X.2.1.1.m1.5.5.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.cmml"><msub id="S3.E8X.2.1.1.m1.5.5.1.1.5" xref="S3.E8X.2.1.1.m1.5.5.1.1.5.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.5.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.5.2.cmml">𝒈</mi><mrow id="S3.E8X.2.1.1.m1.2.2.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.3.cmml"><msubsup id="S3.E8X.2.1.1.m1.2.2.2.2.1" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.2.cmml">𝑾</mi><mi id="S3.E8X.2.1.1.m1.2.2.2.2.1.3" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.3.cmml">k</mi><mrow id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.2" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.2.cmml">i</mi><mo id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.1" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.1.cmml">−</mo><mn id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.3" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E8X.2.1.1.m1.2.2.2.2.2" xref="S3.E8X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E8X.2.1.1.m1.1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.1.cmml">c</mi></mrow></msub><mo id="S3.E8X.2.1.1.m1.5.5.1.1.4" xref="S3.E8X.2.1.1.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.cmml"><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.3.5" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.cmml"><msub id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.cmml"><mo rspace="0.167em" id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.2.cmml">∇</mo><msubsup id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.2.cmml">𝑾</mi><mi id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.3.cmml">k</mi><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.2.cmml">i</mi><mo id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.1.cmml">−</mo><mn id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.3.cmml">1</mn></mrow></msubsup></msub><mi id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E8X.2.1.1.m1.5.5.1.1.3.4" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.4.cmml">​</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.4" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝑷</mi><mi id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.3.cmml">k</mi><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.5" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.3.cmml">k</mi><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.6" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.4.cmml">;</mo><msubsup id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.2.cmml">D</mi><mrow id="S3.E8X.2.1.1.m1.4.4.2.4" xref="S3.E8X.2.1.1.m1.4.4.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.3.3.1.1" xref="S3.E8X.2.1.1.m1.3.3.1.1.cmml">k</mi><mo id="S3.E8X.2.1.1.m1.4.4.2.4.1" xref="S3.E8X.2.1.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.E8X.2.1.1.m1.4.4.2.2" xref="S3.E8X.2.1.1.m1.4.4.2.2.cmml">c</mi></mrow><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.1.cmml">​</mo><mi id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.1a" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.1.cmml">​</mo><mi id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.4" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.4.cmml">l</mi></mrow></msubsup><mo stretchy="false" id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.7" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E8X.2.1.1.m1.5.5.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.2.1.1.m1.5b"><apply id="S3.E8X.2.1.1.m1.5.5.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1"><eq id="S3.E8X.2.1.1.m1.5.5.1.1.4.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.4"></eq><apply id="S3.E8X.2.1.1.m1.5.5.1.1.5.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.5.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.5">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.5.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.5.2">𝒈</ci><list id="S3.E8X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2"><apply id="S3.E8X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.2">𝑾</ci><apply id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3"><minus id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.1"></minus><ci id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E8X.2.1.1.m1.2.2.2.2.1.3.cmml" xref="S3.E8X.2.1.1.m1.2.2.2.2.1.3">𝑘</ci></apply><ci id="S3.E8X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1.1">𝑐</ci></list></apply><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3"><times id="S3.E8X.2.1.1.m1.5.5.1.1.3.4.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.4"></times><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5"><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.2">∇</ci><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.2">𝑾</ci><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3"><minus id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.1"></minus><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.2.3.3">1</cn></apply></apply><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.1.3.3">𝑘</ci></apply></apply><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.5.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.5.2">𝐿</ci></apply><vector id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.4.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3"><apply id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.2">𝑷</ci><apply id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3"><minus id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.2">𝑾</ci><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3"><minus id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.1"></minus><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.2.2.2.3">𝑘</ci></apply><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3">subscript</csymbol><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3">superscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.2">𝐷</ci><apply id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3"><times id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.1"></times><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.2">𝑏</ci><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.3">𝑎</ci><ci id="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.4.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.3.3.3.2.3.4">𝑙</ci></apply></apply><list id="S3.E8X.2.1.1.m1.4.4.2.3.cmml" xref="S3.E8X.2.1.1.m1.4.4.2.4"><ci id="S3.E8X.2.1.1.m1.3.3.1.1.cmml" xref="S3.E8X.2.1.1.m1.3.3.1.1">𝑘</ci><ci id="S3.E8X.2.1.1.m1.4.4.2.2.cmml" xref="S3.E8X.2.1.1.m1.4.4.2.2">𝑐</ci></list></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.5c">\displaystyle\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k},c}=\nabla_{\boldsymbol{W}^{i-1}_{k}}L(\boldsymbol{P}^{i-1}_{k},\boldsymbol{W}^{i-1}_{k};D^{bal}_{k,c}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.SSSx1.Px2.p1.27" class="ltx_p"><span id="S3.SS3.SSSx1.Px2.p1.27.1" class="ltx_text ltx_font_bold">(2)</span> If client <math id="S3.SS3.SSSx1.Px2.p1.21.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.21.m1.1a"><mi id="S3.SS3.SSSx1.Px2.p1.21.m1.1.1" xref="S3.SS3.SSSx1.Px2.p1.21.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.21.m1.1b"><ci id="S3.SS3.SSSx1.Px2.p1.21.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.21.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.21.m1.1c">k</annotation></semantics></math> does not have enough data of class <math id="S3.SS3.SSSx1.Px2.p1.22.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.22.m2.1a"><mi id="S3.SS3.SSSx1.Px2.p1.22.m2.1.1" xref="S3.SS3.SSSx1.Px2.p1.22.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.22.m2.1b"><ci id="S3.SS3.SSSx1.Px2.p1.22.m2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.22.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.22.m2.1c">c</annotation></semantics></math> in its local dataset, we choose to estimate the gradient contribution of class <math id="S3.SS3.SSSx1.Px2.p1.23.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.23.m3.1a"><mi id="S3.SS3.SSSx1.Px2.p1.23.m3.1.1" xref="S3.SS3.SSSx1.Px2.p1.23.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.23.m3.1b"><ci id="S3.SS3.SSSx1.Px2.p1.23.m3.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.23.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.23.m3.1c">c</annotation></semantics></math> with the global gradient prototype of class <math id="S3.SS3.SSSx1.Px2.p1.24.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.24.m4.1a"><mi id="S3.SS3.SSSx1.Px2.p1.24.m4.1.1" xref="S3.SS3.SSSx1.Px2.p1.24.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.24.m4.1b"><ci id="S3.SS3.SSSx1.Px2.p1.24.m4.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.24.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.24.m4.1c">c</annotation></semantics></math> in the <math id="S3.SS3.SSSx1.Px2.p1.25.m5.1" class="ltx_Math" alttext="(t-1)" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.25.m5.1a"><mrow id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.25.m5.1b"><apply id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1"><minus id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.25.m5.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.25.m5.1c">(t-1)</annotation></semantics></math>-th round, which is the averaged gradient of training samples belonging to class <math id="S3.SS3.SSSx1.Px2.p1.26.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.26.m6.1a"><mi id="S3.SS3.SSSx1.Px2.p1.26.m6.1.1" xref="S3.SS3.SSSx1.Px2.p1.26.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.26.m6.1b"><ci id="S3.SS3.SSSx1.Px2.p1.26.m6.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.26.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.26.m6.1c">c</annotation></semantics></math> w.r.t. the classifier <math id="S3.SS3.SSSx1.Px2.p1.27.m7.1" class="ltx_Math" alttext="\boldsymbol{W}^{t-2}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.27.m7.1a"><msup id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.2.cmml">𝑾</mi><mrow id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.1" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.3.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.27.m7.1b"><apply id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3"><minus id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.27.m7.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.27.m7.1c">\boldsymbol{W}^{t-2}</annotation></semantics></math> across all available clients in the last round <cite class="ltx_cite ltx_citemacro_cite">Shang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>)</cite>:</p>
<table id="S3.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9X.2.1.1.m1.7" class="ltx_Math" alttext="\displaystyle\boldsymbol{g}_{\boldsymbol{W}^{t-2},c}^{pro}=\frac{1}{|\mathcal{C}^{t-1}_{c}|}\sum_{k\in\mathcal{C}^{t-1}_{c}}\boldsymbol{g}^{pro}_{\boldsymbol{W}^{t-2},k,c}," display="inline"><semantics id="S3.E9X.2.1.1.m1.7a"><mrow id="S3.E9X.2.1.1.m1.7.7.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.cmml"><mrow id="S3.E9X.2.1.1.m1.7.7.1.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.cmml"><msubsup id="S3.E9X.2.1.1.m1.7.7.1.1.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.cmml"><mi id="S3.E9X.2.1.1.m1.7.7.1.1.2.2.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.2.2.cmml">𝒈</mi><mrow id="S3.E9X.2.1.1.m1.2.2.2.2" xref="S3.E9X.2.1.1.m1.2.2.2.3.cmml"><msup id="S3.E9X.2.1.1.m1.2.2.2.2.1" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.cmml"><mi id="S3.E9X.2.1.1.m1.2.2.2.2.1.2" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.2.cmml">𝑾</mi><mrow id="S3.E9X.2.1.1.m1.2.2.2.2.1.3" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.3.cmml"><mi id="S3.E9X.2.1.1.m1.2.2.2.2.1.3.2" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.3.2.cmml">t</mi><mo id="S3.E9X.2.1.1.m1.2.2.2.2.1.3.1" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.3.1.cmml">−</mo><mn id="S3.E9X.2.1.1.m1.2.2.2.2.1.3.3" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.3.3.cmml">2</mn></mrow></msup><mo id="S3.E9X.2.1.1.m1.2.2.2.2.2" xref="S3.E9X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E9X.2.1.1.m1.1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.1.cmml">c</mi></mrow><mrow id="S3.E9X.2.1.1.m1.7.7.1.1.2.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.cmml"><mi id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.1.cmml">​</mo><mi id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.1a" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.1.cmml">​</mo><mi id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.4" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.4.cmml">o</mi></mrow></msubsup><mo id="S3.E9X.2.1.1.m1.7.7.1.1.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E9X.2.1.1.m1.7.7.1.1.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E9X.2.1.1.m1.3.3" xref="S3.E9X.2.1.1.m1.3.3.cmml"><mfrac id="S3.E9X.2.1.1.m1.3.3a" xref="S3.E9X.2.1.1.m1.3.3.cmml"><mn id="S3.E9X.2.1.1.m1.3.3.3" xref="S3.E9X.2.1.1.m1.3.3.3.cmml">1</mn><mrow id="S3.E9X.2.1.1.m1.3.3.1.1" xref="S3.E9X.2.1.1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.E9X.2.1.1.m1.3.3.1.1.2" xref="S3.E9X.2.1.1.m1.3.3.1.2.1.cmml">|</mo><msubsup id="S3.E9X.2.1.1.m1.3.3.1.1.1" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.2" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.2.cmml">𝒞</mi><mi id="S3.E9X.2.1.1.m1.3.3.1.1.1.3" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.3.cmml">c</mi><mrow id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.2" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.1" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.3" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.E9X.2.1.1.m1.3.3.1.1.3" xref="S3.E9X.2.1.1.m1.3.3.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E9X.2.1.1.m1.7.7.1.1.3.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="S3.E9X.2.1.1.m1.7.7.1.1.3.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.cmml"><munder id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1a" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.cmml"><mo movablelimits="false" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.2.cmml">∑</mo><mrow id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.cmml"><mi id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.2.cmml">k</mi><mo id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.1.cmml">∈</mo><msubsup id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.2.cmml">𝒞</mi><mi id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.3.cmml">c</mi><mrow id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.cmml"><mi id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.2.cmml">t</mi><mo id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.1.cmml">−</mo><mn id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow></munder></mstyle><msubsup id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.cmml"><mi id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.2.cmml">𝒈</mi><mrow id="S3.E9X.2.1.1.m1.6.6.3.3" xref="S3.E9X.2.1.1.m1.6.6.3.4.cmml"><msup id="S3.E9X.2.1.1.m1.6.6.3.3.1" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.cmml"><mi id="S3.E9X.2.1.1.m1.6.6.3.3.1.2" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.2.cmml">𝑾</mi><mrow id="S3.E9X.2.1.1.m1.6.6.3.3.1.3" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.3.cmml"><mi id="S3.E9X.2.1.1.m1.6.6.3.3.1.3.2" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.3.2.cmml">t</mi><mo id="S3.E9X.2.1.1.m1.6.6.3.3.1.3.1" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.3.1.cmml">−</mo><mn id="S3.E9X.2.1.1.m1.6.6.3.3.1.3.3" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.3.3.cmml">2</mn></mrow></msup><mo id="S3.E9X.2.1.1.m1.6.6.3.3.2" xref="S3.E9X.2.1.1.m1.6.6.3.4.cmml">,</mo><mi id="S3.E9X.2.1.1.m1.4.4.1.1" xref="S3.E9X.2.1.1.m1.4.4.1.1.cmml">k</mi><mo id="S3.E9X.2.1.1.m1.6.6.3.3.3" xref="S3.E9X.2.1.1.m1.6.6.3.4.cmml">,</mo><mi id="S3.E9X.2.1.1.m1.5.5.2.2" xref="S3.E9X.2.1.1.m1.5.5.2.2.cmml">c</mi></mrow><mrow id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.cmml"><mi id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.1" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.3" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.1a" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.4" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.4.cmml">o</mi></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E9X.2.1.1.m1.7.7.1.2" xref="S3.E9X.2.1.1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9X.2.1.1.m1.7b"><apply id="S3.E9X.2.1.1.m1.7.7.1.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1"><eq id="S3.E9X.2.1.1.m1.7.7.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.1"></eq><apply id="S3.E9X.2.1.1.m1.7.7.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.7.7.1.1.2.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2">superscript</csymbol><apply id="S3.E9X.2.1.1.m1.7.7.1.1.2.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.7.7.1.1.2.2.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.7.7.1.1.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.2.2">𝒈</ci><list id="S3.E9X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E9X.2.1.1.m1.2.2.2.2"><apply id="S3.E9X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E9X.2.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E9X.2.1.1.m1.2.2.2.2.1">superscript</csymbol><ci id="S3.E9X.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.2">𝑾</ci><apply id="S3.E9X.2.1.1.m1.2.2.2.2.1.3.cmml" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.3"><minus id="S3.E9X.2.1.1.m1.2.2.2.2.1.3.1.cmml" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.3.1"></minus><ci id="S3.E9X.2.1.1.m1.2.2.2.2.1.3.2.cmml" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.E9X.2.1.1.m1.2.2.2.2.1.3.3.cmml" xref="S3.E9X.2.1.1.m1.2.2.2.2.1.3.3">2</cn></apply></apply><ci id="S3.E9X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1.1">𝑐</ci></list></apply><apply id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3"><times id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.1"></times><ci id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.2">𝑝</ci><ci id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.3">𝑟</ci><ci id="S3.E9X.2.1.1.m1.7.7.1.1.2.3.4.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.2.3.4">𝑜</ci></apply></apply><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3"><times id="S3.E9X.2.1.1.m1.7.7.1.1.3.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.1"></times><apply id="S3.E9X.2.1.1.m1.3.3.cmml" xref="S3.E9X.2.1.1.m1.3.3"><divide id="S3.E9X.2.1.1.m1.3.3.2.cmml" xref="S3.E9X.2.1.1.m1.3.3"></divide><cn type="integer" id="S3.E9X.2.1.1.m1.3.3.3.cmml" xref="S3.E9X.2.1.1.m1.3.3.3">1</cn><apply id="S3.E9X.2.1.1.m1.3.3.1.2.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1"><abs id="S3.E9X.2.1.1.m1.3.3.1.2.1.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.2"></abs><apply id="S3.E9X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1">subscript</csymbol><apply id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1">superscript</csymbol><ci id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.2">𝒞</ci><apply id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3"><minus id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.1"></minus><ci id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.3.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E9X.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.3.3.1.1.1.3">𝑐</ci></apply></apply></apply><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2"><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1">subscript</csymbol><sum id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.2"></sum><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3"><in id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.1"></in><ci id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.2">𝑘</ci><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3">subscript</csymbol><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3">superscript</csymbol><ci id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.2">𝒞</ci><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3"><minus id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.1"></minus><ci id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.2.3.3">1</cn></apply></apply><ci id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.1.3.3.3">𝑐</ci></apply></apply></apply><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2">subscript</csymbol><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2">superscript</csymbol><ci id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.2">𝒈</ci><apply id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3"><times id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.1.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.1"></times><ci id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.2.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.2">𝑝</ci><ci id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.3.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.3">𝑟</ci><ci id="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.4.cmml" xref="S3.E9X.2.1.1.m1.7.7.1.1.3.2.2.2.3.4">𝑜</ci></apply></apply><list id="S3.E9X.2.1.1.m1.6.6.3.4.cmml" xref="S3.E9X.2.1.1.m1.6.6.3.3"><apply id="S3.E9X.2.1.1.m1.6.6.3.3.1.cmml" xref="S3.E9X.2.1.1.m1.6.6.3.3.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.6.6.3.3.1.1.cmml" xref="S3.E9X.2.1.1.m1.6.6.3.3.1">superscript</csymbol><ci id="S3.E9X.2.1.1.m1.6.6.3.3.1.2.cmml" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.2">𝑾</ci><apply id="S3.E9X.2.1.1.m1.6.6.3.3.1.3.cmml" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.3"><minus id="S3.E9X.2.1.1.m1.6.6.3.3.1.3.1.cmml" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.3.1"></minus><ci id="S3.E9X.2.1.1.m1.6.6.3.3.1.3.2.cmml" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.3.2">𝑡</ci><cn type="integer" id="S3.E9X.2.1.1.m1.6.6.3.3.1.3.3.cmml" xref="S3.E9X.2.1.1.m1.6.6.3.3.1.3.3">2</cn></apply></apply><ci id="S3.E9X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E9X.2.1.1.m1.4.4.1.1">𝑘</ci><ci id="S3.E9X.2.1.1.m1.5.5.2.2.cmml" xref="S3.E9X.2.1.1.m1.5.5.2.2">𝑐</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.2.1.1.m1.7c">\displaystyle\boldsymbol{g}_{\boldsymbol{W}^{t-2},c}^{pro}=\frac{1}{|\mathcal{C}^{t-1}_{c}|}\sum_{k\in\mathcal{C}^{t-1}_{c}}\boldsymbol{g}^{pro}_{\boldsymbol{W}^{t-2},k,c},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
</tbody>
</table>
<table id="S3.E10" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E10X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10X.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle\boldsymbol{g}_{\boldsymbol{W}^{t-2},k,c}^{pro}=\nabla_{\boldsymbol{W}^{t-2}}L(\boldsymbol{P}^{t-2},\boldsymbol{W}^{t-2};\mathcal{D}_{k,c})," display="inline"><semantics id="S3.E10X.2.1.1.m1.6a"><mrow id="S3.E10X.2.1.1.m1.6.6.1" xref="S3.E10X.2.1.1.m1.6.6.1.1.cmml"><mrow id="S3.E10X.2.1.1.m1.6.6.1.1" xref="S3.E10X.2.1.1.m1.6.6.1.1.cmml"><msubsup id="S3.E10X.2.1.1.m1.6.6.1.1.5" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.cmml"><mi id="S3.E10X.2.1.1.m1.6.6.1.1.5.2.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.2.2.cmml">𝒈</mi><mrow id="S3.E10X.2.1.1.m1.3.3.3.3" xref="S3.E10X.2.1.1.m1.3.3.3.4.cmml"><msup id="S3.E10X.2.1.1.m1.3.3.3.3.1" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.cmml"><mi id="S3.E10X.2.1.1.m1.3.3.3.3.1.2" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.2.cmml">𝑾</mi><mrow id="S3.E10X.2.1.1.m1.3.3.3.3.1.3" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.3.cmml"><mi id="S3.E10X.2.1.1.m1.3.3.3.3.1.3.2" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.3.2.cmml">t</mi><mo id="S3.E10X.2.1.1.m1.3.3.3.3.1.3.1" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.3.1.cmml">−</mo><mn id="S3.E10X.2.1.1.m1.3.3.3.3.1.3.3" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.3.3.cmml">2</mn></mrow></msup><mo id="S3.E10X.2.1.1.m1.3.3.3.3.2" xref="S3.E10X.2.1.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.cmml">k</mi><mo id="S3.E10X.2.1.1.m1.3.3.3.3.3" xref="S3.E10X.2.1.1.m1.3.3.3.4.cmml">,</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.2" xref="S3.E10X.2.1.1.m1.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.E10X.2.1.1.m1.6.6.1.1.5.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.cmml"><mi id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.1" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.1.cmml">​</mo><mi id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.1a" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.1.cmml">​</mo><mi id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.4" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.4.cmml">o</mi></mrow></msubsup><mo id="S3.E10X.2.1.1.m1.6.6.1.1.4" xref="S3.E10X.2.1.1.m1.6.6.1.1.4.cmml">=</mo><mrow id="S3.E10X.2.1.1.m1.6.6.1.1.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.cmml"><mrow id="S3.E10X.2.1.1.m1.6.6.1.1.3.5" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.cmml"><msub id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.cmml"><mo rspace="0.167em" id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.2.cmml">∇</mo><msup id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.cmml"><mi id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.2.cmml">𝑾</mi><mrow id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.cmml"><mi id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.2.cmml">t</mi><mo id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.1" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.1.cmml">−</mo><mn id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.3.cmml">2</mn></mrow></msup></msub><mi id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E10X.2.1.1.m1.6.6.1.1.3.4" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.4.cmml">​</mo><mrow id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.4" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.4.cmml">(</mo><msup id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.2.cmml">𝑷</mi><mrow id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.3.cmml">2</mn></mrow></msup><mo id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.5" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.4.cmml">,</mo><msup id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.2.cmml">𝑾</mi><mrow id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.cmml"><mi id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.1" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.3.cmml">2</mn></mrow></msup><mo id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.6" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.4.cmml">;</mo><msub id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3.2.cmml">𝒟</mi><mrow id="S3.E10X.2.1.1.m1.5.5.2.4" xref="S3.E10X.2.1.1.m1.5.5.2.3.cmml"><mi id="S3.E10X.2.1.1.m1.4.4.1.1" xref="S3.E10X.2.1.1.m1.4.4.1.1.cmml">k</mi><mo id="S3.E10X.2.1.1.m1.5.5.2.4.1" xref="S3.E10X.2.1.1.m1.5.5.2.3.cmml">,</mo><mi id="S3.E10X.2.1.1.m1.5.5.2.2" xref="S3.E10X.2.1.1.m1.5.5.2.2.cmml">c</mi></mrow></msub><mo stretchy="false" id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.7" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10X.2.1.1.m1.6.6.1.2" xref="S3.E10X.2.1.1.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10X.2.1.1.m1.6b"><apply id="S3.E10X.2.1.1.m1.6.6.1.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1"><eq id="S3.E10X.2.1.1.m1.6.6.1.1.4.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.4"></eq><apply id="S3.E10X.2.1.1.m1.6.6.1.1.5.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.6.6.1.1.5.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5">superscript</csymbol><apply id="S3.E10X.2.1.1.m1.6.6.1.1.5.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.6.6.1.1.5.2.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.6.6.1.1.5.2.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.2.2">𝒈</ci><list id="S3.E10X.2.1.1.m1.3.3.3.4.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.3"><apply id="S3.E10X.2.1.1.m1.3.3.3.3.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.3.3.3.3.1.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.3.1">superscript</csymbol><ci id="S3.E10X.2.1.1.m1.3.3.3.3.1.2.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.2">𝑾</ci><apply id="S3.E10X.2.1.1.m1.3.3.3.3.1.3.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.3"><minus id="S3.E10X.2.1.1.m1.3.3.3.3.1.3.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.3.1"></minus><ci id="S3.E10X.2.1.1.m1.3.3.3.3.1.3.2.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.3.2">𝑡</ci><cn type="integer" id="S3.E10X.2.1.1.m1.3.3.3.3.1.3.3.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.3.1.3.3">2</cn></apply></apply><ci id="S3.E10X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1">𝑘</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.2">𝑐</ci></list></apply><apply id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3"><times id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.1"></times><ci id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.2">𝑝</ci><ci id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.3">𝑟</ci><ci id="S3.E10X.2.1.1.m1.6.6.1.1.5.3.4.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.5.3.4">𝑜</ci></apply></apply><apply id="S3.E10X.2.1.1.m1.6.6.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3"><times id="S3.E10X.2.1.1.m1.6.6.1.1.3.4.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.4"></times><apply id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5"><apply id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.2">∇</ci><apply id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3">superscript</csymbol><ci id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.2">𝑾</ci><apply id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3"><minus id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.1"></minus><ci id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.2">𝑡</ci><cn type="integer" id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.1.3.3.3">2</cn></apply></apply></apply><ci id="S3.E10X.2.1.1.m1.6.6.1.1.3.5.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.5.2">𝐿</ci></apply><vector id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.4.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3"><apply id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.2">𝑷</ci><apply id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3"><minus id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1"></minus><ci id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.2">𝑾</ci><apply id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3"><minus id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.1"></minus><ci id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.2.2.2.2.3.3">2</cn></apply></apply><apply id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3.1.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3.2.cmml" xref="S3.E10X.2.1.1.m1.6.6.1.1.3.3.3.3.2">𝒟</ci><list id="S3.E10X.2.1.1.m1.5.5.2.3.cmml" xref="S3.E10X.2.1.1.m1.5.5.2.4"><ci id="S3.E10X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E10X.2.1.1.m1.4.4.1.1">𝑘</ci><ci id="S3.E10X.2.1.1.m1.5.5.2.2.cmml" xref="S3.E10X.2.1.1.m1.5.5.2.2">𝑐</ci></list></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10X.2.1.1.m1.6c">\displaystyle\boldsymbol{g}_{\boldsymbol{W}^{t-2},k,c}^{pro}=\nabla_{\boldsymbol{W}^{t-2}}L(\boldsymbol{P}^{t-2},\boldsymbol{W}^{t-2};\mathcal{D}_{k,c}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.SSSx1.Px2.p1.36" class="ltx_p">where <math id="S3.SS3.SSSx1.Px2.p1.28.m1.1" class="ltx_Math" alttext="\mathcal{C}_{c}^{t-1}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.28.m1.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.2.cmml">𝒞</mi><mi id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.3.cmml">c</mi><mrow id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.1" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.28.m1.1b"><apply id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.2">𝒞</ci><ci id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3"><minus id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.28.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.28.m1.1c">\mathcal{C}_{c}^{t-1}</annotation></semantics></math> represents the set of clients sampled in the <math id="S3.SS3.SSSx1.Px2.p1.29.m2.1" class="ltx_Math" alttext="(t-1)" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.29.m2.1a"><mrow id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.29.m2.1b"><apply id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1"><minus id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.29.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.29.m2.1c">(t-1)</annotation></semantics></math>-th round and have the training samples of class <math id="S3.SS3.SSSx1.Px2.p1.30.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.30.m3.1a"><mi id="S3.SS3.SSSx1.Px2.p1.30.m3.1.1" xref="S3.SS3.SSSx1.Px2.p1.30.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.30.m3.1b"><ci id="S3.SS3.SSSx1.Px2.p1.30.m3.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.30.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.30.m3.1c">c</annotation></semantics></math>, and <math id="S3.SS3.SSSx1.Px2.p1.31.m4.2" class="ltx_Math" alttext="\mathcal{D}_{k,c}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.31.m4.2a"><msub id="S3.SS3.SSSx1.Px2.p1.31.m4.2.3" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.31.m4.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.3.2.cmml">𝒟</mi><mrow id="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.4" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.31.m4.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.31.m4.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.4.1" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.31.m4.2b"><apply id="S3.SS3.SSSx1.Px2.p1.31.m4.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.31.m4.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.3">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.31.m4.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.3.2">𝒟</ci><list id="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.4"><ci id="S3.SS3.SSSx1.Px2.p1.31.m4.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.31.m4.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.31.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.31.m4.2c">\mathcal{D}_{k,c}</annotation></semantics></math> denotes all training samples of class <math id="S3.SS3.SSSx1.Px2.p1.32.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.32.m5.1a"><mi id="S3.SS3.SSSx1.Px2.p1.32.m5.1.1" xref="S3.SS3.SSSx1.Px2.p1.32.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.32.m5.1b"><ci id="S3.SS3.SSSx1.Px2.p1.32.m5.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.32.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.32.m5.1c">c</annotation></semantics></math> in <math id="S3.SS3.SSSx1.Px2.p1.33.m6.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.33.m6.1a"><msub id="S3.SS3.SSSx1.Px2.p1.33.m6.1.1" xref="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.33.m6.1b"><apply id="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.33.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.33.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.2">𝒟</ci><ci id="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.33.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.33.m6.1c">\mathcal{D}_{k}</annotation></semantics></math>. Thus, it requires each client sampled in the previous round to first calculate the local gradient prototype of each class <math id="S3.SS3.SSSx1.Px2.p1.34.m7.1" class="ltx_Math" alttext="c\in\mathcal{L}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.34.m7.1a"><mrow id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.2.cmml">c</mi><mo id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.1.cmml">∈</mo><msub id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.2.cmml">ℒ</mi><mi id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.34.m7.1b"><apply id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1"><in id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.1"></in><ci id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.2">𝑐</ci><apply id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.2">ℒ</ci><ci id="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.34.m7.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.34.m7.1c">c\in\mathcal{L}_{k}</annotation></semantics></math> on the same model <math id="S3.SS3.SSSx1.Px2.p1.35.m8.2" class="ltx_Math" alttext="(\boldsymbol{P}^{t-2},\boldsymbol{W}^{t-2})" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.35.m8.2a"><mrow id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.3" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.3.cmml">(</mo><msup id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.2.cmml">𝑷</mi><mrow id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.1" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.3.cmml">2</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.4" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.3.cmml">,</mo><msup id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.2.cmml">𝑾</mi><mrow id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.3.cmml">2</mn></mrow></msup><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.5" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.35.m8.2b"><interval closure="open" id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2"><apply id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.2">𝑷</ci><apply id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3"><minus id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.1.1.1.1.3.3">2</cn></apply></apply><apply id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3"><minus id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.35.m8.2.2.2.2.3.3">2</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.35.m8.2c">(\boldsymbol{P}^{t-2},\boldsymbol{W}^{t-2})</annotation></semantics></math>, return <math id="S3.SS3.SSSx1.Px2.p1.36.m9.5" class="ltx_Math" alttext="\{\boldsymbol{g}_{\boldsymbol{W}^{t-2},k,c}^{pro}|c\in\mathcal{L}_{k}\}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.36.m9.5a"><mrow id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.3.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.3.1.cmml">{</mo><msubsup id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.2.2.cmml">𝒈</mi><mrow id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.4.cmml"><msup id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.2.cmml">𝑾</mi><mrow id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.1" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.3.cmml">2</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.4.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.36.m9.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.4.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.1" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.1a" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.4" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.4.cmml">o</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.4" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.3.1.cmml">|</mo><mrow id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.2.cmml">c</mi><mo id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.1" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.1.cmml">∈</mo><msub id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.2.cmml">ℒ</mi><mi id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.5" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.36.m9.5b"><apply id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2"><csymbol cd="latexml" id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.3">conditional-set</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.2.2">𝒈</ci><list id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3"><apply id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3"><minus id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.3.3.3.3.1.3.3">2</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.2.2.2.2">𝑐</ci></list></apply><apply id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3"><times id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.2">𝑝</ci><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.3">𝑟</ci><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.4.4.1.1.3.4">𝑜</ci></apply></apply><apply id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2"><in id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.1"></in><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.2">𝑐</ci><apply id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.2">ℒ</ci><ci id="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.36.m9.5.5.2.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.36.m9.5c">\{\boldsymbol{g}_{\boldsymbol{W}^{t-2},k,c}^{pro}|c\in\mathcal{L}_{k}\}</annotation></semantics></math> back to the server along with other local gradients, and receive the global gradient prototypes averaged and sent by the server.
Then, the final gradients on the local balanced dataset to optimize the second part of Eq. (<a href="#S3.E5" title="In Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) is</p>
<table id="S3.E11" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E11X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11X.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}=\frac{1}{|\mathcal{L}|}(\sum\limits_{c\in\mathcal{L}_{k}^{bal}}\boldsymbol{g}_{\boldsymbol{W}_{k}^{i-1},c}+\sum\limits_{c\in\mathcal{L}\backslash\mathcal{L}_{k}^{bal}}\boldsymbol{g}_{\boldsymbol{W}^{t-2},c}^{pro})," display="inline"><semantics id="S3.E11X.2.1.1.m1.6a"><mrow id="S3.E11X.2.1.1.m1.6.6.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.cmml"><mrow id="S3.E11X.2.1.1.m1.6.6.1.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.cmml"><msubsup id="S3.E11X.2.1.1.m1.6.6.1.1.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.2.cmml">𝒈</mi><msubsup id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.2.cmml">𝑾</mi><mi id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.3.cmml">k</mi><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.2.cmml">i</mi><mo id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.1.cmml">−</mo><mn id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.1a" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.4" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.4.cmml">l</mi></mrow></msubsup><mo id="S3.E11X.2.1.1.m1.6.6.1.1.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E11X.2.1.1.m1.1.1" xref="S3.E11X.2.1.1.m1.1.1.cmml"><mfrac id="S3.E11X.2.1.1.m1.1.1a" xref="S3.E11X.2.1.1.m1.1.1.cmml"><mn id="S3.E11X.2.1.1.m1.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.3.cmml">1</mn><mrow id="S3.E11X.2.1.1.m1.1.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E11X.2.1.1.m1.1.1.1.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E11X.2.1.1.m1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml">ℒ</mi><mo stretchy="false" id="S3.E11X.2.1.1.m1.1.1.1.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.1.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.cmml"><munder id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1a" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.cmml"><mo movablelimits="false" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.2.cmml">c</mi><mo id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.1.cmml">∈</mo><msubsup id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.2.cmml">ℒ</mi><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.3.cmml">k</mi><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.1a" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.4" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.4.cmml">l</mi></mrow></msubsup></mrow></munder></mstyle><msub id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2.2.cmml">𝒈</mi><mrow id="S3.E11X.2.1.1.m1.3.3.2.2" xref="S3.E11X.2.1.1.m1.3.3.2.3.cmml"><msubsup id="S3.E11X.2.1.1.m1.3.3.2.2.1" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.cmml"><mi id="S3.E11X.2.1.1.m1.3.3.2.2.1.2.2" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.2.2.cmml">𝑾</mi><mi id="S3.E11X.2.1.1.m1.3.3.2.2.1.2.3" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.2.3.cmml">k</mi><mrow id="S3.E11X.2.1.1.m1.3.3.2.2.1.3" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.3.cmml"><mi id="S3.E11X.2.1.1.m1.3.3.2.2.1.3.2" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.3.2.cmml">i</mi><mo id="S3.E11X.2.1.1.m1.3.3.2.2.1.3.1" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.3.1.cmml">−</mo><mn id="S3.E11X.2.1.1.m1.3.3.2.2.1.3.3" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E11X.2.1.1.m1.3.3.2.2.2" xref="S3.E11X.2.1.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.E11X.2.1.1.m1.2.2.1.1" xref="S3.E11X.2.1.1.m1.2.2.1.1.cmml">c</mi></mrow></msub></mrow><mo id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.cmml"><munder id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1a" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.2.cmml">c</mi><mo id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.1.cmml">∈</mo><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.2.cmml">ℒ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.1.cmml">\</mo><msubsup id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.2.cmml">ℒ</mi><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.3.cmml">k</mi><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.1a" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.4" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.4.cmml">l</mi></mrow></msubsup></mrow></mrow></munder></mstyle><msubsup id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.2.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.2.2.cmml">𝒈</mi><mrow id="S3.E11X.2.1.1.m1.5.5.2.2" xref="S3.E11X.2.1.1.m1.5.5.2.3.cmml"><msup id="S3.E11X.2.1.1.m1.5.5.2.2.1" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.cmml"><mi id="S3.E11X.2.1.1.m1.5.5.2.2.1.2" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.2.cmml">𝑾</mi><mrow id="S3.E11X.2.1.1.m1.5.5.2.2.1.3" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.3.cmml"><mi id="S3.E11X.2.1.1.m1.5.5.2.2.1.3.2" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.3.2.cmml">t</mi><mo id="S3.E11X.2.1.1.m1.5.5.2.2.1.3.1" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.3.1.cmml">−</mo><mn id="S3.E11X.2.1.1.m1.5.5.2.2.1.3.3" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.3.3.cmml">2</mn></mrow></msup><mo id="S3.E11X.2.1.1.m1.5.5.2.2.2" xref="S3.E11X.2.1.1.m1.5.5.2.3.cmml">,</mo><mi id="S3.E11X.2.1.1.m1.4.4.1.1" xref="S3.E11X.2.1.1.m1.4.4.1.1.cmml">c</mi></mrow><mrow id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.1" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.1a" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.4" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.4.cmml">o</mi></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.3" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11X.2.1.1.m1.6.6.1.2" xref="S3.E11X.2.1.1.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11X.2.1.1.m1.6b"><apply id="S3.E11X.2.1.1.m1.6.6.1.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1"><eq id="S3.E11X.2.1.1.m1.6.6.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.2"></eq><apply id="S3.E11X.2.1.1.m1.6.6.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3">superscript</csymbol><apply id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.2">𝒈</ci><apply id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3">subscript</csymbol><apply id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3">superscript</csymbol><ci id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.2">𝑾</ci><apply id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3"><minus id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.1"></minus><ci id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3"><times id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.1"></times><ci id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.2">𝑏</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.3">𝑎</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.3.3.4.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.3.3.4">𝑙</ci></apply></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1"><times id="S3.E11X.2.1.1.m1.6.6.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.2"></times><apply id="S3.E11X.2.1.1.m1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1"><divide id="S3.E11X.2.1.1.m1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1"></divide><cn type="integer" id="S3.E11X.2.1.1.m1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.3">1</cn><apply id="S3.E11X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.3"><abs id="S3.E11X.2.1.1.m1.1.1.1.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.3.1"></abs><ci id="S3.E11X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1">ℒ</ci></apply></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1"><plus id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.1"></plus><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2"><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.2"></sum><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3"><in id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.1"></in><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.2">𝑐</ci><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3">superscript</csymbol><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.2">ℒ</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.2.3">𝑘</ci></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3"><times id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.1"></times><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.2">𝑏</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.3">𝑎</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.4.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.1.3.3.3.4">𝑙</ci></apply></apply></apply></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.2.2.2">𝒈</ci><list id="S3.E11X.2.1.1.m1.3.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2"><apply id="S3.E11X.2.1.1.m1.3.3.2.2.1.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.3.3.2.2.1.1.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1">superscript</csymbol><apply id="S3.E11X.2.1.1.m1.3.3.2.2.1.2.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.3.3.2.2.1.2.1.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.3.3.2.2.1.2.2.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.2.2">𝑾</ci><ci id="S3.E11X.2.1.1.m1.3.3.2.2.1.2.3.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.2.3">𝑘</ci></apply><apply id="S3.E11X.2.1.1.m1.3.3.2.2.1.3.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.3"><minus id="S3.E11X.2.1.1.m1.3.3.2.2.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.3.1"></minus><ci id="S3.E11X.2.1.1.m1.3.3.2.2.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.3.2">𝑖</ci><cn type="integer" id="S3.E11X.2.1.1.m1.3.3.2.2.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.3.3.2.2.1.3.3">1</cn></apply></apply><ci id="S3.E11X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E11X.2.1.1.m1.2.2.1.1">𝑐</ci></list></apply></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3"><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.2"></sum><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3"><in id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.1"></in><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.2">𝑐</ci><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3"><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.1">\</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.2">ℒ</ci><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3">superscript</csymbol><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.2">ℒ</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.2.3">𝑘</ci></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3"><times id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.1"></times><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.2">𝑏</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.3">𝑎</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.4.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.1.3.3.3.3.4">𝑙</ci></apply></apply></apply></apply></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.2.2">𝒈</ci><list id="S3.E11X.2.1.1.m1.5.5.2.3.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2"><apply id="S3.E11X.2.1.1.m1.5.5.2.2.1.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.1"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.5.5.2.2.1.1.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.1">superscript</csymbol><ci id="S3.E11X.2.1.1.m1.5.5.2.2.1.2.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.2">𝑾</ci><apply id="S3.E11X.2.1.1.m1.5.5.2.2.1.3.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.3"><minus id="S3.E11X.2.1.1.m1.5.5.2.2.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.3.1"></minus><ci id="S3.E11X.2.1.1.m1.5.5.2.2.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.E11X.2.1.1.m1.5.5.2.2.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.3.3">2</cn></apply></apply><ci id="S3.E11X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E11X.2.1.1.m1.4.4.1.1">𝑐</ci></list></apply><apply id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3"><times id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.3">𝑟</ci><ci id="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.4.cmml" xref="S3.E11X.2.1.1.m1.6.6.1.1.1.1.1.1.3.2.3.4">𝑜</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11X.2.1.1.m1.6c">\displaystyle\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}=\frac{1}{|\mathcal{L}|}(\sum\limits_{c\in\mathcal{L}_{k}^{bal}}\boldsymbol{g}_{\boldsymbol{W}_{k}^{i-1},c}+\sum\limits_{c\in\mathcal{L}\backslash\mathcal{L}_{k}^{bal}}\boldsymbol{g}_{\boldsymbol{W}^{t-2},c}^{pro}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.SSSx1.Px2.p1.40" class="ltx_p">where <math id="S3.SS3.SSSx1.Px2.p1.37.m1.1" class="ltx_Math" alttext="\mathcal{L}^{bal}_{k}\subset\mathcal{L}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.37.m1.1a"><mrow id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.cmml"><msubsup id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.1a" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.4" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.4.cmml">l</mi></mrow></msubsup><mo id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.1.cmml">⊂</mo><msub id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.2.cmml">ℒ</mi><mi id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.37.m1.1b"><apply id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1"><subset id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.1"></subset><apply id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.2">ℒ</ci><apply id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3"><times id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.2">𝑏</ci><ci id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.3">𝑎</ci><ci id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.2.3.4">𝑙</ci></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.2">ℒ</ci><ci id="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.37.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.37.m1.1c">\mathcal{L}^{bal}_{k}\subset\mathcal{L}_{k}</annotation></semantics></math> is the label set in which each classe consists of more than <math id="S3.SS3.SSSx1.Px2.p1.38.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.38.m2.1a"><mi id="S3.SS3.SSSx1.Px2.p1.38.m2.1.1" xref="S3.SS3.SSSx1.Px2.p1.38.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.38.m2.1b"><ci id="S3.SS3.SSSx1.Px2.p1.38.m2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.38.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.38.m2.1c">T</annotation></semantics></math> samples and <math id="S3.SS3.SSSx1.Px2.p1.39.m3.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.39.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p1.39.m3.1.1" xref="S3.SS3.SSSx1.Px2.p1.39.m3.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.39.m3.1b"><ci id="S3.SS3.SSSx1.Px2.p1.39.m3.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.39.m3.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.39.m3.1c">\mathcal{L}</annotation></semantics></math> is the entire label set. Finally, the updating rule for <math id="S3.SS3.SSSx1.Px2.p1.40.m4.1" class="ltx_Math" alttext="\boldsymbol{W}^{i-1}_{k}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.40.m4.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.2.cmml">𝑾</mi><mi id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.40.m4.1b"><apply id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3"><minus id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.40.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.40.m4.1c">\boldsymbol{W}^{i-1}_{k}</annotation></semantics></math> is<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The local classifier re-balancing starts from the 2nd round.</span></span></span></p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<div id="S3.E12.m1.1.1.1" class="ltx_inline-block ltx_markedasmath ltx_transformed_outer" style="width:418.1pt;height:72.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(145.5pt,-25.3pt) scale(3.28916105226171,3.28916105226171) ;">
<p id="S3.E12.m1.1.1.1.1" class="ltx_p"><math id="S3.E12.m1.1.1.1.1.m1.3" class="ltx_Math" alttext="\begin{aligned} \boldsymbol{W}^{i}_{k}=\boldsymbol{W}^{i-1}_{k}-\eta_{l}&amp;\left[\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{local}+\lambda\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}\frac{\|\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{local}\|}{\|\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}\|}\right],\end{aligned}" display="inline"><semantics id="S3.E12.m1.1.1.1.1.m1.3a"><mtable columnspacing="0pt" id="S3.E12.m1.1.1.1.1.m1.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.cmml"><mtr id="S3.E12.m1.1.1.1.1.m1.3.3a" xref="S3.E12.m1.1.1.1.1.m1.3.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E12.m1.1.1.1.1.m1.3.3b" xref="S3.E12.m1.1.1.1.1.m1.3.3.cmml"><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.cmml"><msubsup id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.2.cmml">𝑾</mi><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.3.cmml">k</mi><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.3.cmml">i</mi></msubsup><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.1.cmml">=</mo><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.cmml"><msubsup id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.2.cmml">𝑾</mi><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.3.cmml">k</mi><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.2.cmml">i</mi><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.1.cmml">−</mo><mn id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.1.cmml">−</mo><msub id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.2.cmml">η</mi><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.3.cmml">l</mi></msub></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E12.m1.1.1.1.1.m1.3.3c" xref="S3.E12.m1.1.1.1.1.m1.3.3.cmml"><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.cmml"><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.2.cmml"><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.2.1.cmml">[</mo><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.cmml"><msubsup id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.2.cmml">𝒈</mi><msubsup id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.2.cmml">𝑾</mi><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.3.cmml">k</mi><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.1.cmml">−</mo><mn id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1a" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.4" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1b" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.5" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1c" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.6" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.6.cmml">l</mi></mrow></msubsup><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.1.cmml">+</mo><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.1.cmml">​</mo><msubsup id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.2.cmml">𝒈</mi><msubsup id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.2.cmml">𝑾</mi><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.3.cmml">k</mi><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.2.cmml">i</mi><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.1.cmml">−</mo><mn id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.1" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.1a" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.4" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.4.cmml">l</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.1a" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.1.cmml">​</mo><mstyle displaystyle="true" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml"><mfrac id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2a" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml"><mrow id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒈</mi><msubsup id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">𝑾</mi><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">k</mi><mrow id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.2" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.2.cmml">i</mi><mo id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.1" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.1.cmml">−</mo><mn id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1b" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.5" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1c" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.6" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.6.cmml">l</mi></mrow></msubsup><mo stretchy="false" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.2" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.1.cmml">‖</mo><msubsup id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.2" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.2.cmml">𝒈</mi><msubsup id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.2" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.2.cmml">𝑾</mi><mi id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.3.cmml">k</mi><mrow id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.2" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.2.cmml">i</mi><mo id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.1" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.1.cmml">−</mo><mn id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.3" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.2" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.1" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.3" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.1a" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.4" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.4.cmml">l</mi></mrow></msubsup><mo stretchy="false" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.3" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.1.cmml">‖</mo></mrow></mfrac></mstyle></mrow></mrow><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.3" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.2.1.cmml">]</mo></mrow><mo id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.2" xref="S3.E12.m1.1.1.1.1.m1.3.3.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1.1.1.1.m1.3b"><matrix id="S3.E12.m1.1.1.1.1.m1.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3"><matrixrow id="S3.E12.m1.1.1.1.1.m1.3.3a.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3"><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1"><eq id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.1"></eq><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2">subscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.2">𝑾</ci><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.2.3">𝑖</ci></apply><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.2.3">𝑘</ci></apply><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3"><minus id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.1"></minus><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2">subscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.2">𝑾</ci><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3"><minus id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.1"></minus><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.2.3">𝑘</ci></apply><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.2">𝜂</ci><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.4.1.3.3.3">𝑙</ci></apply></apply></apply><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1"><csymbol cd="latexml" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.2">delimited-[]</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1"><plus id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.1"></plus><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.2">𝒈</ci><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3">subscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.2">𝑾</ci><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3"><minus id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.1"></minus><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.2.3.3">𝑘</ci></apply></apply><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3"><times id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.1"></times><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.2">𝑙</ci><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.3">𝑜</ci><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.4.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.4">𝑐</ci><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.5.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.5">𝑎</ci><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.6.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3"><times id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.1"></times><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.2">𝜆</ci><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.2">𝒈</ci><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3">subscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.2">𝑾</ci><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3"><minus id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.1"></minus><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3"><times id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.1"></times><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.2">𝑏</ci><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.3">𝑎</ci><ci id="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.4.cmml" xref="S3.E12.m1.1.1.1.1.m1.3.3.3.3.3.3.1.1.1.3.3.3.4">𝑙</ci></apply></apply><apply id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2"><divide id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2"></divide><apply id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2">𝒈</ci><apply id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.2">𝑾</ci><apply id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3"><minus id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.1"></minus><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">𝑜</ci><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.4">𝑐</ci><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.5">𝑎</ci><ci id="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.6.cmml" xref="S3.E12.m1.1.1.1.1.m1.1.1.1.1.1.1.1.1.1.3.6">𝑙</ci></apply></apply></apply><apply id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.2">norm</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.2">𝒈</ci><apply id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3">subscript</csymbol><apply id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3">superscript</csymbol><ci id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.2">𝑾</ci><apply id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3"><minus id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.1"></minus><ci id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3"><times id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.1"></times><ci id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.2">𝑏</ci><ci id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.3">𝑎</ci><ci id="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.4.cmml" xref="S3.E12.m1.1.1.1.1.m1.2.2.2.2.2.2.2.1.1.3.4">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1.1.1.1.m1.3c">\begin{aligned} \boldsymbol{W}^{i}_{k}=\boldsymbol{W}^{i-1}_{k}-\eta_{l}&amp;\left[\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{local}+\lambda\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}\frac{\|\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{local}\|}{\|\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}\|}\right],\end{aligned}</annotation></semantics></math></p>
</span></div>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="0" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSSx1.Px2.p1.44" class="ltx_p">where <math id="S3.SS3.SSSx1.Px2.p1.41.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.41.m1.1a"><mi id="S3.SS3.SSSx1.Px2.p1.41.m1.1.1" xref="S3.SS3.SSSx1.Px2.p1.41.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.41.m1.1b"><ci id="S3.SS3.SSSx1.Px2.p1.41.m1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.41.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.41.m1.1c">\lambda</annotation></semantics></math> is a re-balance factor to control the re-balancing strength for updating <math id="S3.SS3.SSSx1.Px2.p1.42.m2.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.42.m2.1a"><mi id="S3.SS3.SSSx1.Px2.p1.42.m2.1.1" xref="S3.SS3.SSSx1.Px2.p1.42.m2.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.42.m2.1b"><ci id="S3.SS3.SSSx1.Px2.p1.42.m2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.42.m2.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.42.m2.1c">\boldsymbol{W}</annotation></semantics></math>. In Eq. (<a href="#S3.E12" title="In Updating 𝑾. ‣ Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>), we normalize the scale<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Here, <math id="footnote5.m1.1" class="ltx_math_unparsed" alttext="\|\cdot\|" display="inline"><semantics id="footnote5.m1.1b"><mrow id="footnote5.m1.1c"><mo rspace="0em" id="footnote5.m1.1.1">∥</mo><mo lspace="0em" rspace="0em" id="footnote5.m1.1.2">⋅</mo><mo lspace="0em" id="footnote5.m1.1.3">∥</mo></mrow><annotation encoding="application/x-tex" id="footnote5.m1.1d">\|\cdot\|</annotation></semantics></math> represents the Frobenius Norm.</span></span></span> of <math id="S3.SS3.SSSx1.Px2.p1.43.m3.1" class="ltx_Math" alttext="\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.43.m3.1a"><msubsup id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.2.cmml">𝒈</mi><msubsup id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.2" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.2.cmml">𝑾</mi><mi id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.3.cmml">k</mi><mrow id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.2" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.2.cmml">i</mi><mo id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.1" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.1" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.1a" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.4" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.43.m3.1b"><apply id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.2">𝒈</ci><apply id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3"><minus id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3"><times id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.2">𝑏</ci><ci id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.3">𝑎</ci><ci id="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.43.m3.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.43.m3.1c">\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}</annotation></semantics></math> at each step in order to address the unstable training caused by the constant part of <math id="S3.SS3.SSSx1.Px2.p1.44.m4.2" class="ltx_Math" alttext="\boldsymbol{g}_{\boldsymbol{W}^{t-1},c}^{pro}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p1.44.m4.2a"><msubsup id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.2.2" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.2.2.cmml">𝒈</mi><mrow id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.3.cmml"><msup id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.2" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.2.cmml">𝑾</mi><mrow id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.2" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.1" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.3" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p1.44.m4.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p1.44.m4.1.1.1.1.cmml">c</mi></mrow><mrow id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.2" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.1" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.3" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.1a" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.4" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.4.cmml">o</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p1.44.m4.2b"><apply id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.2.2">𝒈</ci><list id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2"><apply id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3"><minus id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.2.2.2.1.3.3">1</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p1.44.m4.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.1.1.1.1">𝑐</ci></list></apply><apply id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3"><times id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.2">𝑝</ci><ci id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.3">𝑟</ci><ci id="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p1.44.m4.2.3.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p1.44.m4.2c">\boldsymbol{g}_{\boldsymbol{W}^{t-1},c}^{pro}</annotation></semantics></math>, by making its scale consistent with the decreasing trend of the scale of real gradients during training.</p>
</div>
<div id="S3.SS3.SSSx1.Px2.p2" class="ltx_para">
<p id="S3.SS3.SSSx1.Px2.p2.4" class="ltx_p">After training, the new model is <math id="S3.SS3.SSSx1.Px2.p2.1.m1.3" class="ltx_Math" alttext="(\boldsymbol{P}^{t}_{k},\boldsymbol{W}^{t}_{k},\widehat{\boldsymbol{W}}^{t}_{k})" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p2.1.m1.3a"><mrow id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.4.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.4" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.4.cmml">(</mo><msubsup id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.2.cmml">𝑷</mi><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.3" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.3.cmml">k</mi><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.5" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.3" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.3.cmml">k</mi><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.3" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.6" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.4.cmml">,</mo><msubsup id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.cmml"><mover accent="true" id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.1" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.3.cmml">k</mi><mi id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.3" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.7" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p2.1.m1.3b"><vector id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3"><apply id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.2">𝑷</ci><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.2">𝑾</ci><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.2.2.2.2.3">𝑘</ci></apply><apply id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2"><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.1">^</ci><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.2.2">𝑾</ci></apply><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.1.m1.3.3.3.3.3">𝑘</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p2.1.m1.3c">(\boldsymbol{P}^{t}_{k},\boldsymbol{W}^{t}_{k},\widehat{\boldsymbol{W}}^{t}_{k})</annotation></semantics></math>, and client <math id="S3.SS3.SSSx1.Px2.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p2.2.m2.1a"><mi id="S3.SS3.SSSx1.Px2.p2.2.m2.1.1" xref="S3.SS3.SSSx1.Px2.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p2.2.m2.1b"><ci id="S3.SS3.SSSx1.Px2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p2.2.m2.1c">k</annotation></semantics></math> sends the local gradients <math id="S3.SS3.SSSx1.Px2.p2.3.m3.12" class="ltx_Math" alttext="(\boldsymbol{g}_{\boldsymbol{P}^{t-1},k},\boldsymbol{g}_{\boldsymbol{W}^{t-1},k},\boldsymbol{g}_{\widehat{\boldsymbol{W}}^{t-1},k})=(\boldsymbol{P}^{t}_{k}-\boldsymbol{P}^{t-1},\boldsymbol{W}^{t}_{k}-\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t}_{k}-\widehat{\boldsymbol{W}}^{t-1})" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p2.3.m3.12a"><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.cmml"><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.4.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.4" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.4.cmml">(</mo><msub id="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1.2.cmml">𝒈</mi><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.3.cmml"><msup id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.2.cmml">𝑷</mi><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.1.1.1.1.cmml">k</mi></mrow></msub><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.5" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.4.cmml">,</mo><msub id="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2.2.cmml">𝒈</mi><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.3.cmml"><msup id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.2.cmml">𝑾</mi><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.3.3.1.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.3.3.1.1.cmml">k</mi></mrow></msub><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.6" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.4.cmml">,</mo><msub id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3.2.cmml">𝒈</mi><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.3.cmml"><msup id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.cmml"><mover accent="true" id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.1.cmml">^</mo></mover><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.3.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.5.5.1.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.5.5.1.1.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.7" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.4.cmml">)</mo></mrow><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.7" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.7.cmml">=</mo><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.4.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.4" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.4.cmml">(</mo><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.cmml"><msubsup id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.2.cmml">𝑷</mi><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.3.cmml">k</mi><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.1.cmml">−</mo><msup id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.2.cmml">𝑷</mi><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.5" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.4.cmml">,</mo><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.cmml"><msubsup id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.3.cmml">k</mi><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.1.cmml">−</mo><msup id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.2.cmml">𝑾</mi><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.6" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.4.cmml">,</mo><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.cmml"><msubsup id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.cmml"><mover accent="true" id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.3.cmml">k</mi><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.1.cmml">−</mo><msup id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.cmml"><mover accent="true" id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.2.cmml">𝑾</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.1.cmml">^</mo></mover><mrow id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.2" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.1" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.3.cmml">1</mn></mrow></msup></mrow><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.7" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p2.3.m3.12b"><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12"><eq id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.7.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.7"></eq><vector id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3"><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.7.7.1.1.1.2">𝒈</ci><list id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2"><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.2">𝑷</ci><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.2.2.2.2.1.3.3">1</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.1.1.1.1">𝑘</ci></list></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.8.8.2.2.2.2">𝒈</ci><list id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2"><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.4.4.2.2.1.3.3">1</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.3.3.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.3.3.1.1">𝑘</ci></list></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.9.9.3.3.3.2">𝒈</ci><list id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2"><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2"><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.1">^</ci><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.2.2">𝑾</ci></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.6.6.2.2.1.3.3">1</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.5.5.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.5.5.1.1">𝑘</ci></list></apply></vector><vector id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.4.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3"><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.1"></minus><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.2">𝑷</ci><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.2">𝑷</ci><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.10.10.4.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.1"></minus><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.2">𝑾</ci><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.2.3">𝑡</ci></apply><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.2.3">𝑘</ci></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.11.11.5.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.1"></minus><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2">subscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2"><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.1">^</ci><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.2.2">𝑾</ci></apply><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.2.3">𝑡</ci></apply><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.2.3">𝑘</ci></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2"><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.1">^</ci><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.2.2">𝑾</ci></apply><apply id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3"><minus id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.3.m3.12.12.6.3.3.3.3.3">1</cn></apply></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p2.3.m3.12c">(\boldsymbol{g}_{\boldsymbol{P}^{t-1},k},\boldsymbol{g}_{\boldsymbol{W}^{t-1},k},\boldsymbol{g}_{\widehat{\boldsymbol{W}}^{t-1},k})=(\boldsymbol{P}^{t}_{k}-\boldsymbol{P}^{t-1},\boldsymbol{W}^{t}_{k}-\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t}_{k}-\widehat{\boldsymbol{W}}^{t-1})</annotation></semantics></math>
along with the local gradient prototypes <math id="S3.SS3.SSSx1.Px2.p2.4.m4.5" class="ltx_Math" alttext="\{\boldsymbol{g}_{\boldsymbol{W}^{t-1},k,c}^{pro}|c\in\mathcal{L}_{k}\}" display="inline"><semantics id="S3.SS3.SSSx1.Px2.p2.4.m4.5a"><mrow id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.3.cmml"><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.3.1.cmml">{</mo><msubsup id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.2.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.2.2.cmml">𝒈</mi><mrow id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.4.cmml"><msup id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.2.cmml">𝑾</mi><mrow id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.2.cmml">t</mi><mo id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.1" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.1.cmml">−</mo><mn id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.4.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.1.1.1.1" xref="S3.SS3.SSSx1.Px2.p2.4.m4.1.1.1.1.cmml">k</mi><mo id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.4.cmml">,</mo><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.2.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.2.2.2.2.cmml">c</mi></mrow><mrow id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.1" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.1a" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.4" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.4.cmml">o</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.4" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.3.1.cmml">|</mo><mrow id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.cmml"><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.2.cmml">c</mi><mo id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.1" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.1.cmml">∈</mo><msub id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.2" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.2.cmml">ℒ</mi><mi id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.3" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.5" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSSx1.Px2.p2.4.m4.5b"><apply id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2"><csymbol cd="latexml" id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.3">conditional-set</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1">superscript</csymbol><apply id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.2.2">𝒈</ci><list id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3"><apply id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1">superscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.2">𝑾</ci><apply id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3"><minus id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.1"></minus><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.3.3.3.3.1.3.3">1</cn></apply></apply><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.1.1.1.1">𝑘</ci><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.2.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.2.2.2.2">𝑐</ci></list></apply><apply id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3"><times id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.1"></times><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.2">𝑝</ci><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.3">𝑟</ci><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.4.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.4.4.1.1.3.4">𝑜</ci></apply></apply><apply id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2"><in id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.1"></in><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.2">𝑐</ci><apply id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.1.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3">subscript</csymbol><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.2.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.2">ℒ</ci><ci id="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.3.cmml" xref="S3.SS3.SSSx1.Px2.p2.4.m4.5.5.2.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSSx1.Px2.p2.4.m4.5c">\{\boldsymbol{g}_{\boldsymbol{W}^{t-1},k,c}^{pro}|c\in\mathcal{L}_{k}\}</annotation></semantics></math> to the server.</p>
</div>
</section>
</section>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Server Aggregation Stage</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.4" class="ltx_p">The server first aggregates the gradients and updates the global model as</p>
<table id="S3.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13X.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle(\boldsymbol{P}^{t},\boldsymbol{W}^{t},\widehat{\boldsymbol{W}}^{t})=(\boldsymbol{P}^{t-1},\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t-1})" display="inline"><semantics id="S3.E13X.2.1.1.m1.6a"><mrow id="S3.E13X.2.1.1.m1.6.6" xref="S3.E13X.2.1.1.m1.6.6.cmml"><mrow id="S3.E13X.2.1.1.m1.3.3.3.3" xref="S3.E13X.2.1.1.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.3.3.3.3.4" xref="S3.E13X.2.1.1.m1.3.3.3.4.cmml">(</mo><msup id="S3.E13X.2.1.1.m1.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.cmml">𝑷</mi><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S3.E13X.2.1.1.m1.3.3.3.3.5" xref="S3.E13X.2.1.1.m1.3.3.3.4.cmml">,</mo><msup id="S3.E13X.2.1.1.m1.2.2.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S3.E13X.2.1.1.m1.2.2.2.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.E13X.2.1.1.m1.2.2.2.2.2.3" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.3.cmml">t</mi></msup><mo id="S3.E13X.2.1.1.m1.3.3.3.3.6" xref="S3.E13X.2.1.1.m1.3.3.3.4.cmml">,</mo><msup id="S3.E13X.2.1.1.m1.3.3.3.3.3" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.cmml"><mover accent="true" id="S3.E13X.2.1.1.m1.3.3.3.3.3.2" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.2.cmml"><mi id="S3.E13X.2.1.1.m1.3.3.3.3.3.2.2" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.2.2.cmml">𝑾</mi><mo id="S3.E13X.2.1.1.m1.3.3.3.3.3.2.1" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.2.1.cmml">^</mo></mover><mi id="S3.E13X.2.1.1.m1.3.3.3.3.3.3" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.3.cmml">t</mi></msup><mo stretchy="false" id="S3.E13X.2.1.1.m1.3.3.3.3.7" xref="S3.E13X.2.1.1.m1.3.3.3.4.cmml">)</mo></mrow><mo id="S3.E13X.2.1.1.m1.6.6.7" xref="S3.E13X.2.1.1.m1.6.6.7.cmml">=</mo><mrow id="S3.E13X.2.1.1.m1.6.6.6.3" xref="S3.E13X.2.1.1.m1.6.6.6.4.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.6.6.6.3.4" xref="S3.E13X.2.1.1.m1.6.6.6.4.cmml">(</mo><msup id="S3.E13X.2.1.1.m1.4.4.4.1.1" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.4.1.1.2" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.2.cmml">𝑷</mi><mrow id="S3.E13X.2.1.1.m1.4.4.4.1.1.3" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.3.cmml"><mi id="S3.E13X.2.1.1.m1.4.4.4.1.1.3.2" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.3.2.cmml">t</mi><mo id="S3.E13X.2.1.1.m1.4.4.4.1.1.3.1" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.3.1.cmml">−</mo><mn id="S3.E13X.2.1.1.m1.4.4.4.1.1.3.3" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.E13X.2.1.1.m1.6.6.6.3.5" xref="S3.E13X.2.1.1.m1.6.6.6.4.cmml">,</mo><msup id="S3.E13X.2.1.1.m1.5.5.5.2.2" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.cmml"><mi id="S3.E13X.2.1.1.m1.5.5.5.2.2.2" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.2.cmml">𝑾</mi><mrow id="S3.E13X.2.1.1.m1.5.5.5.2.2.3" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.3.cmml"><mi id="S3.E13X.2.1.1.m1.5.5.5.2.2.3.2" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.3.2.cmml">t</mi><mo id="S3.E13X.2.1.1.m1.5.5.5.2.2.3.1" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.3.1.cmml">−</mo><mn id="S3.E13X.2.1.1.m1.5.5.5.2.2.3.3" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.E13X.2.1.1.m1.6.6.6.3.6" xref="S3.E13X.2.1.1.m1.6.6.6.4.cmml">,</mo><msup id="S3.E13X.2.1.1.m1.6.6.6.3.3" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.cmml"><mover accent="true" id="S3.E13X.2.1.1.m1.6.6.6.3.3.2" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.2.cmml"><mi id="S3.E13X.2.1.1.m1.6.6.6.3.3.2.2" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.2.2.cmml">𝑾</mi><mo id="S3.E13X.2.1.1.m1.6.6.6.3.3.2.1" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.2.1.cmml">^</mo></mover><mrow id="S3.E13X.2.1.1.m1.6.6.6.3.3.3" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.3.cmml"><mi id="S3.E13X.2.1.1.m1.6.6.6.3.3.3.2" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.3.2.cmml">t</mi><mo id="S3.E13X.2.1.1.m1.6.6.6.3.3.3.1" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.3.1.cmml">−</mo><mn id="S3.E13X.2.1.1.m1.6.6.6.3.3.3.3" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.E13X.2.1.1.m1.6.6.6.3.7" xref="S3.E13X.2.1.1.m1.6.6.6.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13X.2.1.1.m1.6b"><apply id="S3.E13X.2.1.1.m1.6.6.cmml" xref="S3.E13X.2.1.1.m1.6.6"><eq id="S3.E13X.2.1.1.m1.6.6.7.cmml" xref="S3.E13X.2.1.1.m1.6.6.7"></eq><vector id="S3.E13X.2.1.1.m1.3.3.3.4.cmml" xref="S3.E13X.2.1.1.m1.3.3.3.3"><apply id="S3.E13X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2">𝑷</ci><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E13X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.E13X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.2">𝑾</ci><ci id="S3.E13X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E13X.2.1.1.m1.3.3.3.3.3.cmml" xref="S3.E13X.2.1.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.3.3.3.3.3.1.cmml" xref="S3.E13X.2.1.1.m1.3.3.3.3.3">superscript</csymbol><apply id="S3.E13X.2.1.1.m1.3.3.3.3.3.2.cmml" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.2"><ci id="S3.E13X.2.1.1.m1.3.3.3.3.3.2.1.cmml" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.2.1">^</ci><ci id="S3.E13X.2.1.1.m1.3.3.3.3.3.2.2.cmml" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.2.2">𝑾</ci></apply><ci id="S3.E13X.2.1.1.m1.3.3.3.3.3.3.cmml" xref="S3.E13X.2.1.1.m1.3.3.3.3.3.3">𝑡</ci></apply></vector><vector id="S3.E13X.2.1.1.m1.6.6.6.4.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3"><apply id="S3.E13X.2.1.1.m1.4.4.4.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.4.1.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.4.4.4.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.4.1.1">superscript</csymbol><ci id="S3.E13X.2.1.1.m1.4.4.4.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.2">𝑷</ci><apply id="S3.E13X.2.1.1.m1.4.4.4.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.3"><minus id="S3.E13X.2.1.1.m1.4.4.4.1.1.3.1.cmml" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.3.1"></minus><ci id="S3.E13X.2.1.1.m1.4.4.4.1.1.3.2.cmml" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E13X.2.1.1.m1.4.4.4.1.1.3.3.cmml" xref="S3.E13X.2.1.1.m1.4.4.4.1.1.3.3">1</cn></apply></apply><apply id="S3.E13X.2.1.1.m1.5.5.5.2.2.cmml" xref="S3.E13X.2.1.1.m1.5.5.5.2.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.5.5.5.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.5.5.5.2.2">superscript</csymbol><ci id="S3.E13X.2.1.1.m1.5.5.5.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.2">𝑾</ci><apply id="S3.E13X.2.1.1.m1.5.5.5.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.3"><minus id="S3.E13X.2.1.1.m1.5.5.5.2.2.3.1.cmml" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.3.1"></minus><ci id="S3.E13X.2.1.1.m1.5.5.5.2.2.3.2.cmml" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E13X.2.1.1.m1.5.5.5.2.2.3.3.cmml" xref="S3.E13X.2.1.1.m1.5.5.5.2.2.3.3">1</cn></apply></apply><apply id="S3.E13X.2.1.1.m1.6.6.6.3.3.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.6.6.6.3.3.1.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3">superscript</csymbol><apply id="S3.E13X.2.1.1.m1.6.6.6.3.3.2.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.2"><ci id="S3.E13X.2.1.1.m1.6.6.6.3.3.2.1.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.2.1">^</ci><ci id="S3.E13X.2.1.1.m1.6.6.6.3.3.2.2.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.2.2">𝑾</ci></apply><apply id="S3.E13X.2.1.1.m1.6.6.6.3.3.3.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.3"><minus id="S3.E13X.2.1.1.m1.6.6.6.3.3.3.1.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.3.1"></minus><ci id="S3.E13X.2.1.1.m1.6.6.6.3.3.3.2.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.3.2">𝑡</ci><cn type="integer" id="S3.E13X.2.1.1.m1.6.6.6.3.3.3.3.cmml" xref="S3.E13X.2.1.1.m1.6.6.6.3.3.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.2.1.1.m1.6c">\displaystyle(\boldsymbol{P}^{t},\boldsymbol{W}^{t},\widehat{\boldsymbol{W}}^{t})=(\boldsymbol{P}^{t-1},\boldsymbol{W}^{t-1},\widehat{\boldsymbol{W}}^{t-1})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
<tr id="S3.E13Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13Xa.2.1.1.m1.9" class="ltx_Math" alttext="\displaystyle-\eta_{s}\sum\limits_{k\in\mathcal{C}^{t}}{\frac{|\mathcal{D}_{k}|}{\sum_{i\in\mathcal{C}^{t}}|\mathcal{D}_{i}|}}(\boldsymbol{g}_{\boldsymbol{P}^{t-1},k},\boldsymbol{g}_{\boldsymbol{W}^{t-1},k},\boldsymbol{g}_{\widehat{\boldsymbol{W}}^{t-1},k})." display="inline"><semantics id="S3.E13Xa.2.1.1.m1.9a"><mrow id="S3.E13Xa.2.1.1.m1.9.9.1" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.cmml"><mrow id="S3.E13Xa.2.1.1.m1.9.9.1.1" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.cmml"><mo id="S3.E13Xa.2.1.1.m1.9.9.1.1a" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.cmml">−</mo><mrow id="S3.E13Xa.2.1.1.m1.9.9.1.1.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.cmml"><msub id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.cmml"><mi id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.2.cmml">η</mi><mi id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.4" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.4.cmml">​</mo><mrow id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.cmml"><munder id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4a" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.cmml"><mo movablelimits="false" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.2.cmml">∑</mo><mrow id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.cmml"><mi id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.2.cmml">k</mi><mo id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.1" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.1.cmml">∈</mo><msup id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.2.cmml">𝒞</mi><mi id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.3.cmml">t</mi></msup></mrow></munder></mstyle><mrow id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.cmml"><mstyle displaystyle="true" id="S3.E13Xa.2.1.1.m1.2.2" xref="S3.E13Xa.2.1.1.m1.2.2.cmml"><mfrac id="S3.E13Xa.2.1.1.m1.2.2a" xref="S3.E13Xa.2.1.1.m1.2.2.cmml"><mrow id="S3.E13Xa.2.1.1.m1.1.1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E13Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E13Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E13Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E13Xa.2.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E13Xa.2.1.1.m1.2.2.2" xref="S3.E13Xa.2.1.1.m1.2.2.2.cmml"><msub id="S3.E13Xa.2.1.1.m1.2.2.2.2" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.cmml"><mo id="S3.E13Xa.2.1.1.m1.2.2.2.2.2" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E13Xa.2.1.1.m1.2.2.2.2.3" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.cmml"><mi id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.2" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.1" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.1.cmml">∈</mo><msup id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.2" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.2.cmml">𝒞</mi><mi id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.3" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.3.cmml">t</mi></msup></mrow></msub><mrow id="S3.E13Xa.2.1.1.m1.2.2.2.1.1" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.2.cmml"><mo lspace="0em" stretchy="false" id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.2" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.2.1.cmml">|</mo><msub id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.2" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.3" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.3" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.4" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.4.cmml">​</mo><mrow id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.4.cmml"><mo stretchy="false" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.4" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.4.cmml">(</mo><msub id="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mrow id="S3.E13Xa.2.1.1.m1.4.4.2.2" xref="S3.E13Xa.2.1.1.m1.4.4.2.3.cmml"><msup id="S3.E13Xa.2.1.1.m1.4.4.2.2.1" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.cmml"><mi id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.2" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.2.cmml">𝑷</mi><mrow id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.cmml"><mi id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.2" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.2.cmml">t</mi><mo id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.1" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.1.cmml">−</mo><mn id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.3" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.E13Xa.2.1.1.m1.4.4.2.2.2" xref="S3.E13Xa.2.1.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.E13Xa.2.1.1.m1.3.3.1.1" xref="S3.E13Xa.2.1.1.m1.3.3.1.1.cmml">k</mi></mrow></msub><mo id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.5" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.4.cmml">,</mo><msub id="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.2.cmml">𝒈</mi><mrow id="S3.E13Xa.2.1.1.m1.6.6.2.2" xref="S3.E13Xa.2.1.1.m1.6.6.2.3.cmml"><msup id="S3.E13Xa.2.1.1.m1.6.6.2.2.1" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.cmml"><mi id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.2" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.2.cmml">𝑾</mi><mrow id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.cmml"><mi id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.2" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.2.cmml">t</mi><mo id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.1" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.1.cmml">−</mo><mn id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.3" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.E13Xa.2.1.1.m1.6.6.2.2.2" xref="S3.E13Xa.2.1.1.m1.6.6.2.3.cmml">,</mo><mi id="S3.E13Xa.2.1.1.m1.5.5.1.1" xref="S3.E13Xa.2.1.1.m1.5.5.1.1.cmml">k</mi></mrow></msub><mo id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.6" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.4.cmml">,</mo><msub id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3.cmml"><mi id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3.2.cmml">𝒈</mi><mrow id="S3.E13Xa.2.1.1.m1.8.8.2.2" xref="S3.E13Xa.2.1.1.m1.8.8.2.3.cmml"><msup id="S3.E13Xa.2.1.1.m1.8.8.2.2.1" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.cmml"><mover accent="true" id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.cmml"><mi id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.2" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.2.cmml">𝑾</mi><mo id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.1" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.1.cmml">^</mo></mover><mrow id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.cmml"><mi id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.2" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.2.cmml">t</mi><mo id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.1" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.1.cmml">−</mo><mn id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.3" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.E13Xa.2.1.1.m1.8.8.2.2.2" xref="S3.E13Xa.2.1.1.m1.8.8.2.3.cmml">,</mo><mi id="S3.E13Xa.2.1.1.m1.7.7.1.1" xref="S3.E13Xa.2.1.1.m1.7.7.1.1.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.7" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E13Xa.2.1.1.m1.9.9.1.2" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13Xa.2.1.1.m1.9b"><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1"><minus id="S3.E13Xa.2.1.1.m1.9.9.1.1.4.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1"></minus><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3"><times id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.4.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.4"></times><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.2.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.2">𝜂</ci><ci id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.3.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.5.3">𝑠</ci></apply><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3"><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4">subscript</csymbol><sum id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.2.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.2"></sum><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3"><in id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.1"></in><ci id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.2">𝑘</ci><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3">superscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.2">𝒞</ci><ci id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.4.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3"><times id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.4.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.4"></times><apply id="S3.E13Xa.2.1.1.m1.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.2.2"><divide id="S3.E13Xa.2.1.1.m1.2.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.2.2"></divide><apply id="S3.E13Xa.2.1.1.m1.1.1.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1"><abs id="S3.E13Xa.2.1.1.m1.1.1.1.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.2"></abs><apply id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E13Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E13Xa.2.1.1.m1.2.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2"><apply id="S3.E13Xa.2.1.1.m1.2.2.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2">subscript</csymbol><sum id="S3.E13Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.2"></sum><apply id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3"><in id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.1"></in><ci id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.2">𝑖</ci><apply id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3">superscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.2">𝒞</ci><ci id="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E13Xa.2.1.1.m1.2.2.2.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1"><abs id="S3.E13Xa.2.1.1.m1.2.2.2.1.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1.2"></abs><apply id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.2">𝒟</ci><ci id="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply><vector id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.4.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3"><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.2">𝒈</ci><list id="S3.E13Xa.2.1.1.m1.4.4.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.4.4.2.2"><apply id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1">superscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.2">𝑷</ci><apply id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3"><minus id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.1"></minus><ci id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.4.4.2.2.1.3.3">1</cn></apply></apply><ci id="S3.E13Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.3.3.1.1">𝑘</ci></list></apply><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.2.2.2.2.2.2.2">𝒈</ci><list id="S3.E13Xa.2.1.1.m1.6.6.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.6.6.2.2"><apply id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1">superscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.2">𝑾</ci><apply id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3"><minus id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.1"></minus><ci id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.6.6.2.2.1.3.3">1</cn></apply></apply><ci id="S3.E13Xa.2.1.1.m1.5.5.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.5.5.1.1">𝑘</ci></list></apply><apply id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.9.9.1.1.3.3.3.3.3.3.2">𝒈</ci><list id="S3.E13Xa.2.1.1.m1.8.8.2.3.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2"><apply id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1"><csymbol cd="ambiguous" id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1">superscript</csymbol><apply id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2"><ci id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.1.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.1">^</ci><ci id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.2.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.2.2">𝑾</ci></apply><apply id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3"><minus id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.1.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.1"></minus><ci id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.2.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.2">𝑡</ci><cn type="integer" id="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.3.cmml" xref="S3.E13Xa.2.1.1.m1.8.8.2.2.1.3.3">1</cn></apply></apply><ci id="S3.E13Xa.2.1.1.m1.7.7.1.1.cmml" xref="S3.E13Xa.2.1.1.m1.7.7.1.1">𝑘</ci></list></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13Xa.2.1.1.m1.9c">\displaystyle-\eta_{s}\sum\limits_{k\in\mathcal{C}^{t}}{\frac{|\mathcal{D}_{k}|}{\sum_{i\in\mathcal{C}^{t}}|\mathcal{D}_{i}|}}(\boldsymbol{g}_{\boldsymbol{P}^{t-1},k},\boldsymbol{g}_{\boldsymbol{W}^{t-1},k},\boldsymbol{g}_{\widehat{\boldsymbol{W}}^{t-1},k}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.SSS1.p1.5" class="ltx_p">Also, the server needs to update the global gradient prototypes as</p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.10" class="ltx_math_unparsed" alttext="\boldsymbol{g}_{\boldsymbol{W}^{t-1},c}^{pro}=\left\{\begin{aligned} &amp;\frac{1}{|\mathcal{C}^{t}_{c}|}\sum_{k\in\mathcal{C}^{t}_{c}}\boldsymbol{g}^{pro}_{\boldsymbol{W}^{t-1},k,c},\quad\mathcal{C}_{c}^{t}\neq\emptyset,\\
&amp;\boldsymbol{g}_{\boldsymbol{W}^{t-2},c}^{pro},\quad\mathcal{C}_{c}^{t}=\emptyset,\end{aligned}\right." display="block"><semantics id="S3.E14.m1.10a"><mrow id="S3.E14.m1.10b"><msubsup id="S3.E14.m1.10.11"><mi id="S3.E14.m1.10.11.2.2">𝒈</mi><mrow id="S3.E14.m1.2.2.2.2"><msup id="S3.E14.m1.2.2.2.2.1"><mi id="S3.E14.m1.2.2.2.2.1.2">𝑾</mi><mrow id="S3.E14.m1.2.2.2.2.1.3"><mi id="S3.E14.m1.2.2.2.2.1.3.2">t</mi><mo id="S3.E14.m1.2.2.2.2.1.3.1">−</mo><mn id="S3.E14.m1.2.2.2.2.1.3.3">1</mn></mrow></msup><mo id="S3.E14.m1.2.2.2.2.2">,</mo><mi id="S3.E14.m1.1.1.1.1">c</mi></mrow><mrow id="S3.E14.m1.10.11.3"><mi id="S3.E14.m1.10.11.3.2">p</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.10.11.3.1">​</mo><mi id="S3.E14.m1.10.11.3.3">r</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.10.11.3.1a">​</mo><mi id="S3.E14.m1.10.11.3.4">o</mi></mrow></msubsup><mo id="S3.E14.m1.10.12">=</mo><mrow id="S3.E14.m1.10.13"><mo id="S3.E14.m1.10.13.1">{</mo><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E14.m1.10.10"><mtr id="S3.E14.m1.10.10a"><mtd id="S3.E14.m1.10.10b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E14.m1.10.10c"><mrow id="S3.E14.m1.7.7.5.5.5.5"><mrow id="S3.E14.m1.7.7.5.5.5.5.1"><mrow id="S3.E14.m1.7.7.5.5.5.5.1.2.2"><mrow id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1"><mfrac id="S3.E14.m1.3.3.1.1.1.1"><mn id="S3.E14.m1.3.3.1.1.1.1.3">1</mn><mrow id="S3.E14.m1.3.3.1.1.1.1.1.1"><mo stretchy="false" id="S3.E14.m1.3.3.1.1.1.1.1.1.2">|</mo><msubsup id="S3.E14.m1.3.3.1.1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.3.3.1.1.1.1.1.1.1.2.2">𝒞</mi><mi id="S3.E14.m1.3.3.1.1.1.1.1.1.1.3">c</mi><mi id="S3.E14.m1.3.3.1.1.1.1.1.1.1.2.3">t</mi></msubsup><mo stretchy="false" id="S3.E14.m1.3.3.1.1.1.1.1.1.3">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.1">​</mo><mrow id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2"><munder id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1"><mo movablelimits="false" id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1.2">∑</mo><mrow id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1.3"><mi id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1.3.2">k</mi><mo id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1.3.1">∈</mo><msubsup id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1.3.3"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1.3.3.2.2">𝒞</mi><mi id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1.3.3.3">c</mi><mi id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.1.3.3.2.3">t</mi></msubsup></mrow></munder><msubsup id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.2"><mi id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.2.2.2">𝒈</mi><mrow id="S3.E14.m1.6.6.4.4.4.4.3.3"><msup id="S3.E14.m1.6.6.4.4.4.4.3.3.1"><mi id="S3.E14.m1.6.6.4.4.4.4.3.3.1.2">𝑾</mi><mrow id="S3.E14.m1.6.6.4.4.4.4.3.3.1.3"><mi id="S3.E14.m1.6.6.4.4.4.4.3.3.1.3.2">t</mi><mo id="S3.E14.m1.6.6.4.4.4.4.3.3.1.3.1">−</mo><mn id="S3.E14.m1.6.6.4.4.4.4.3.3.1.3.3">1</mn></mrow></msup><mo id="S3.E14.m1.6.6.4.4.4.4.3.3.2">,</mo><mi id="S3.E14.m1.4.4.2.2.2.2.1.1">k</mi><mo id="S3.E14.m1.6.6.4.4.4.4.3.3.3">,</mo><mi id="S3.E14.m1.5.5.3.3.3.3.2.2">c</mi></mrow><mrow id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.2.2.3"><mi id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.2.2.3.2">p</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.2.2.3.1">​</mo><mi id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.2.2.3.3">r</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.2.2.3.1a">​</mo><mi id="S3.E14.m1.7.7.5.5.5.5.1.1.1.1.2.2.2.3.4">o</mi></mrow></msubsup></mrow></mrow><mo rspace="1.167em" id="S3.E14.m1.7.7.5.5.5.5.1.2.2.3">,</mo><msubsup id="S3.E14.m1.7.7.5.5.5.5.1.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.7.7.5.5.5.5.1.2.2.2.2.2">𝒞</mi><mi id="S3.E14.m1.7.7.5.5.5.5.1.2.2.2.2.3">c</mi><mi id="S3.E14.m1.7.7.5.5.5.5.1.2.2.2.3">t</mi></msubsup></mrow><mo id="S3.E14.m1.7.7.5.5.5.5.1.3">≠</mo><mi mathvariant="normal" id="S3.E14.m1.7.7.5.5.5.5.1.4">∅</mi></mrow><mo id="S3.E14.m1.7.7.5.5.5.5.2">,</mo></mrow></mtd></mtr><mtr id="S3.E14.m1.10.10d"><mtd id="S3.E14.m1.10.10e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E14.m1.10.10f"><mrow id="S3.E14.m1.10.10.8.3.3.3"><mrow id="S3.E14.m1.10.10.8.3.3.3.1"><mrow id="S3.E14.m1.10.10.8.3.3.3.1.2.2"><msubsup id="S3.E14.m1.10.10.8.3.3.3.1.1.1.1"><mi id="S3.E14.m1.10.10.8.3.3.3.1.1.1.1.2.2">𝒈</mi><mrow id="S3.E14.m1.9.9.7.2.2.2.2.2"><msup id="S3.E14.m1.9.9.7.2.2.2.2.2.1"><mi id="S3.E14.m1.9.9.7.2.2.2.2.2.1.2">𝑾</mi><mrow id="S3.E14.m1.9.9.7.2.2.2.2.2.1.3"><mi id="S3.E14.m1.9.9.7.2.2.2.2.2.1.3.2">t</mi><mo id="S3.E14.m1.9.9.7.2.2.2.2.2.1.3.1">−</mo><mn id="S3.E14.m1.9.9.7.2.2.2.2.2.1.3.3">2</mn></mrow></msup><mo id="S3.E14.m1.9.9.7.2.2.2.2.2.2">,</mo><mi id="S3.E14.m1.8.8.6.1.1.1.1.1">c</mi></mrow><mrow id="S3.E14.m1.10.10.8.3.3.3.1.1.1.1.3"><mi id="S3.E14.m1.10.10.8.3.3.3.1.1.1.1.3.2">p</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.10.10.8.3.3.3.1.1.1.1.3.1">​</mo><mi id="S3.E14.m1.10.10.8.3.3.3.1.1.1.1.3.3">r</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.10.10.8.3.3.3.1.1.1.1.3.1a">​</mo><mi id="S3.E14.m1.10.10.8.3.3.3.1.1.1.1.3.4">o</mi></mrow></msubsup><mo rspace="1.167em" id="S3.E14.m1.10.10.8.3.3.3.1.2.2.3">,</mo><msubsup id="S3.E14.m1.10.10.8.3.3.3.1.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.10.10.8.3.3.3.1.2.2.2.2.2">𝒞</mi><mi id="S3.E14.m1.10.10.8.3.3.3.1.2.2.2.2.3">c</mi><mi id="S3.E14.m1.10.10.8.3.3.3.1.2.2.2.3">t</mi></msubsup></mrow><mo id="S3.E14.m1.10.10.8.3.3.3.1.3">=</mo><mi mathvariant="normal" id="S3.E14.m1.10.10.8.3.3.3.1.4">∅</mi></mrow><mo id="S3.E14.m1.10.10.8.3.3.3.2">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S3.E14.m1.10c">\boldsymbol{g}_{\boldsymbol{W}^{t-1},c}^{pro}=\left\{\begin{aligned} &amp;\frac{1}{|\mathcal{C}^{t}_{c}|}\sum_{k\in\mathcal{C}^{t}_{c}}\boldsymbol{g}^{pro}_{\boldsymbol{W}^{t-1},k,c},\quad\mathcal{C}_{c}^{t}\neq\emptyset,\\
&amp;\boldsymbol{g}_{\boldsymbol{W}^{t-2},c}^{pro},\quad\mathcal{C}_{c}^{t}=\emptyset,\end{aligned}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS1.p1.3" class="ltx_p">in which the second case corresponds to the situation where all clients in <math id="S3.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="C^{t}" display="inline"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><msup id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml">C</mi><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">𝐶</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">C^{t}</annotation></semantics></math> from the current round do not contain samples of class <math id="S3.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">c</annotation></semantics></math>. In this case, we re-use the global gradient prototype of class <math id="S3.SS3.SSS1.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><mi id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><ci id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">c</annotation></semantics></math> from the previous round.
The updated global model and global gradient prototypes are broadcast to the sampled clients in the next round.</p>
</div>
</section>
</section>
<section id="S3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Inference Stage</h3>

<div id="S3.SSx1.p1" class="ltx_para">
<p id="S3.SSx1.p1.2" class="ltx_p">After federated training, we only keep the re-balanced classifier <math id="S3.SSx1.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S3.SSx1.p1.1.m1.1a"><mi id="S3.SSx1.p1.1.m1.1.1" xref="S3.SSx1.p1.1.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SSx1.p1.1.m1.1b"><ci id="S3.SSx1.p1.1.m1.1.1.cmml" xref="S3.SSx1.p1.1.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SSx1.p1.1.m1.1c">\boldsymbol{W}</annotation></semantics></math> and abandon <math id="S3.SSx1.p1.2.m2.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}" display="inline"><semantics id="S3.SSx1.p1.2.m2.1a"><mover accent="true" id="S3.SSx1.p1.2.m2.1.1" xref="S3.SSx1.p1.2.m2.1.1.cmml"><mi id="S3.SSx1.p1.2.m2.1.1.2" xref="S3.SSx1.p1.2.m2.1.1.2.cmml">𝑾</mi><mo id="S3.SSx1.p1.2.m2.1.1.1" xref="S3.SSx1.p1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SSx1.p1.2.m2.1b"><apply id="S3.SSx1.p1.2.m2.1.1.cmml" xref="S3.SSx1.p1.2.m2.1.1"><ci id="S3.SSx1.p1.2.m2.1.1.1.cmml" xref="S3.SSx1.p1.2.m2.1.1.1">^</ci><ci id="S3.SSx1.p1.2.m2.1.1.2.cmml" xref="S3.SSx1.p1.2.m2.1.1.2">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SSx1.p1.2.m2.1c">\widehat{\boldsymbol{W}}</annotation></semantics></math> in the reference stage:</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E15.m1.3" class="ltx_Math" alttext="y_{\text{pred}}=\mathop{\arg\max}_{i}[\boldsymbol{W}^{T}f(x;\boldsymbol{P})]." display="block"><semantics id="S3.E15.m1.3a"><mrow id="S3.E15.m1.3.3.1" xref="S3.E15.m1.3.3.1.1.cmml"><mrow id="S3.E15.m1.3.3.1.1" xref="S3.E15.m1.3.3.1.1.cmml"><msub id="S3.E15.m1.3.3.1.1.3" xref="S3.E15.m1.3.3.1.1.3.cmml"><mi id="S3.E15.m1.3.3.1.1.3.2" xref="S3.E15.m1.3.3.1.1.3.2.cmml">y</mi><mtext id="S3.E15.m1.3.3.1.1.3.3" xref="S3.E15.m1.3.3.1.1.3.3a.cmml">pred</mtext></msub><mo id="S3.E15.m1.3.3.1.1.2" xref="S3.E15.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E15.m1.3.3.1.1.1" xref="S3.E15.m1.3.3.1.1.1.cmml"><munder id="S3.E15.m1.3.3.1.1.1.2" xref="S3.E15.m1.3.3.1.1.1.2.cmml"><mrow id="S3.E15.m1.3.3.1.1.1.2.2" xref="S3.E15.m1.3.3.1.1.1.2.2.cmml"><mi id="S3.E15.m1.3.3.1.1.1.2.2.1" xref="S3.E15.m1.3.3.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E15.m1.3.3.1.1.1.2.2a" xref="S3.E15.m1.3.3.1.1.1.2.2.cmml">⁡</mo><mi id="S3.E15.m1.3.3.1.1.1.2.2.2" xref="S3.E15.m1.3.3.1.1.1.2.2.2.cmml">max</mi></mrow><mi id="S3.E15.m1.3.3.1.1.1.2.3" xref="S3.E15.m1.3.3.1.1.1.2.3.cmml">i</mi></munder><mrow id="S3.E15.m1.3.3.1.1.1.1.1" xref="S3.E15.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E15.m1.3.3.1.1.1.1.1.2" xref="S3.E15.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E15.m1.3.3.1.1.1.1.1.1" xref="S3.E15.m1.3.3.1.1.1.1.1.1.cmml"><msup id="S3.E15.m1.3.3.1.1.1.1.1.1.2" xref="S3.E15.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E15.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E15.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mi id="S3.E15.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E15.m1.3.3.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E15.m1.3.3.1.1.1.1.1.1.1" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E15.m1.3.3.1.1.1.1.1.1.3" xref="S3.E15.m1.3.3.1.1.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.3.3.1.1.1.1.1.1.1a" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E15.m1.3.3.1.1.1.1.1.1.4.2" xref="S3.E15.m1.3.3.1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E15.m1.3.3.1.1.1.1.1.1.4.2.1" xref="S3.E15.m1.3.3.1.1.1.1.1.1.4.1.cmml">(</mo><mi id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml">x</mi><mo id="S3.E15.m1.3.3.1.1.1.1.1.1.4.2.2" xref="S3.E15.m1.3.3.1.1.1.1.1.1.4.1.cmml">;</mo><mi id="S3.E15.m1.2.2" xref="S3.E15.m1.2.2.cmml">𝑷</mi><mo stretchy="false" id="S3.E15.m1.3.3.1.1.1.1.1.1.4.2.3" xref="S3.E15.m1.3.3.1.1.1.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E15.m1.3.3.1.1.1.1.1.3" xref="S3.E15.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E15.m1.3.3.1.2" xref="S3.E15.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.3b"><apply id="S3.E15.m1.3.3.1.1.cmml" xref="S3.E15.m1.3.3.1"><eq id="S3.E15.m1.3.3.1.1.2.cmml" xref="S3.E15.m1.3.3.1.1.2"></eq><apply id="S3.E15.m1.3.3.1.1.3.cmml" xref="S3.E15.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.3.1.cmml" xref="S3.E15.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E15.m1.3.3.1.1.3.2.cmml" xref="S3.E15.m1.3.3.1.1.3.2">𝑦</ci><ci id="S3.E15.m1.3.3.1.1.3.3a.cmml" xref="S3.E15.m1.3.3.1.1.3.3"><mtext mathsize="70%" id="S3.E15.m1.3.3.1.1.3.3.cmml" xref="S3.E15.m1.3.3.1.1.3.3">pred</mtext></ci></apply><apply id="S3.E15.m1.3.3.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.1"><apply id="S3.E15.m1.3.3.1.1.1.2.cmml" xref="S3.E15.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.1.2.1.cmml" xref="S3.E15.m1.3.3.1.1.1.2">subscript</csymbol><apply id="S3.E15.m1.3.3.1.1.1.2.2.cmml" xref="S3.E15.m1.3.3.1.1.1.2.2"><arg id="S3.E15.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E15.m1.3.3.1.1.1.2.2.1"></arg><max id="S3.E15.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E15.m1.3.3.1.1.1.2.2.2"></max></apply><ci id="S3.E15.m1.3.3.1.1.1.2.3.cmml" xref="S3.E15.m1.3.3.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E15.m1.3.3.1.1.1.1.2.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E15.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E15.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1"><times id="S3.E15.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.1"></times><apply id="S3.E15.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E15.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.2.2">𝑾</ci><ci id="S3.E15.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S3.E15.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.3">𝑓</ci><list id="S3.E15.m1.3.3.1.1.1.1.1.1.4.1.cmml" xref="S3.E15.m1.3.3.1.1.1.1.1.1.4.2"><ci id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1">𝑥</ci><ci id="S3.E15.m1.2.2.cmml" xref="S3.E15.m1.2.2">𝑷</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.3c">y_{\text{pred}}=\mathop{\arg\max}_{i}[\boldsymbol{W}^{T}f(x;\boldsymbol{P})].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and Analysis</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Settings</h3>

<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Datasets and Models</h5>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.6" class="ltx_p">We conduct experiments on three popular image classification benchmarks: MNIST <cite class="ltx_cite ltx_citemacro_cite">LeCun <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">1998</a>)</cite>, CIFAR-10 and CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">Krizhevsky <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2009</a>)</cite>. We follow existing studies <cite class="ltx_cite ltx_citemacro_cite">Cao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>); Shang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>)</cite> to create the long-tailed versions of training sets of above three datasets (i.e., MNIST-LT, CIFAR-10/100-LT), and keep the test sets as balanced. We first define the term <span id="S4.SS1.SSS0.Px1.p1.6.1" class="ltx_text ltx_font_italic">Imbalance Ratio</span>: <math id="S4.SS1.SSS0.Px1.p1.1.m1.4" class="ltx_Math" alttext="\text{IR}=\frac{\max_{c}\{n_{c}\}}{\min_{c}\{n_{c}\}}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.4a"><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.4.5" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.5.cmml"><mtext id="S4.SS1.SSS0.Px1.p1.1.m1.4.5.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.5.2a.cmml">IR</mtext><mo id="S4.SS1.SSS0.Px1.p1.1.m1.4.5.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.5.1.cmml">=</mo><mfrac id="S4.SS1.SSS0.Px1.p1.1.m1.4.4" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.cmml"><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.3.cmml"><msub id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml">max</mi><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2a" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.3.cmml">{</mo><msub id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.2.cmml">n</mi><mi id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.3.cmml"><msub id="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.2.cmml">min</mi><mi id="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2a" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.3.cmml">⁡</mo><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.3.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.3.cmml">{</mo><msub id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.2.cmml">n</mi><mi id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.3" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.3.cmml">}</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.4b"><apply id="S4.SS1.SSS0.Px1.p1.1.m1.4.5.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.5"><eq id="S4.SS1.SSS0.Px1.p1.1.m1.4.5.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.5.1"></eq><ci id="S4.SS1.SSS0.Px1.p1.1.m1.4.5.2a.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.5.2"><mtext id="S4.SS1.SSS0.Px1.p1.1.m1.4.5.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.5.2">IR</mtext></ci><apply id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4"><divide id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.5.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4"></divide><apply id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2"><apply id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1">subscript</csymbol><max id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.2"></max><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.2">𝑛</ci><ci id="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.2.2.2.2.2.1.3">𝑐</ci></apply></apply><apply id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2"><apply id="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1">subscript</csymbol><min id="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.2"></min><ci id="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.3.3.3.1.1.3">𝑐</ci></apply><apply id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.2">𝑛</ci><ci id="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.4.4.4.2.2.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.4c">\text{IR}=\frac{\max_{c}\{n_{c}\}}{\min_{c}\{n_{c}\}}</annotation></semantics></math>, which is the ratio between the maximum sample number across all classes and the minimum sample number across all classes, to reflect the imbalance degree of the global data distribution. Then, the training sample quantity of each class follows an exponential decay. We choose <math id="S4.SS1.SSS0.Px1.p1.2.m2.3" class="ltx_Math" alttext="\text{IR}=10,50,100" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.3a"><mrow id="S4.SS1.SSS0.Px1.p1.2.m2.3.4" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.cmml"><mtext id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.2a.cmml">IR</mtext><mo id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.1.cmml">=</mo><mrow id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.3.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.3.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">10</mn><mo id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.3.2.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.3.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p1.2.m2.2.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.2.2.cmml">50</mn><mo id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.3.2.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.3.1.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p1.2.m2.3.3" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.3.cmml">100</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.3b"><apply id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4"><eq id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.1"></eq><ci id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.2a.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.2"><mtext id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.2">IR</mtext></ci><list id="S4.SS1.SSS0.Px1.p1.2.m2.3.4.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.4.3.2"><cn type="integer" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">10</cn><cn type="integer" id="S4.SS1.SSS0.Px1.p1.2.m2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.2.2">50</cn><cn type="integer" id="S4.SS1.SSS0.Px1.p1.2.m2.3.3.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.3.3">100</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.3c">\text{IR}=10,50,100</annotation></semantics></math> in our main experiments. Furthermore, we follow the existing studies <cite class="ltx_cite ltx_citemacro_cite">Reddi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2020</a>); Shang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>)</cite> to adopt the Dirichlet distribution <math id="S4.SS1.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\text{Dir}(\alpha)" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px1.p1.3.m3.1.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.cmml"><mtext id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.2a.cmml">Dir</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.3.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.3.2.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">α</mi><mo stretchy="false" id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.3.2.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2"><times id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.1"></times><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.2a.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.2"><mtext id="S4.SS1.SSS0.Px1.p1.3.m3.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.2.2">Dir</mtext></ci><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.1c">\text{Dir}(\alpha)</annotation></semantics></math> for the non-i.i.d. data partitioning, in which <math id="S4.SS1.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.4.m4.1c">\alpha</annotation></semantics></math> controls the non-i.i.d. degree. We set <math id="S4.SS1.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.5.m5.1a"><mrow id="S4.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">α</mi><mo id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1"><eq id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1"></eq><ci id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2">𝛼</ci><cn type="float" id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.5.m5.1c">\alpha=1.0</annotation></semantics></math> in our main experiments, and put the results of other <math id="S4.SS1.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.6.m6.1a"><mi id="S4.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.6.m6.1b"><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.6.m6.1c">\alpha</annotation></semantics></math>s in the Appendix. We use the convolutional neural network (CNN) <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> for MNIST, and use ResNet-56 <cite class="ltx_cite ltx_citemacro_cite">He <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2016</a>)</cite> for CIFAR-10/100 datasets.
More details can be found in the Appendix.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baseline Methods</h5>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.1" class="ltx_p">We compare our method with the existing federated long-tailed learning algorithms, including the traditional FedAvg algorithm with the CrossEntropy Loss (FedAvg+CE) applied in the local training <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite>, Fed-Focal Loss <cite class="ltx_cite ltx_citemacro_cite">Sarkar <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>, Ratio Loss <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>, CLIMB <cite class="ltx_cite ltx_citemacro_cite">Shen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite>, and the state-of-the-art method CReFF <cite class="ltx_cite ltx_citemacro_cite">Shang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training Details</h5>

<div id="S4.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px3.p1.3" class="ltx_p">We conduct experiments in two popular FL settings based on the ratio of clients participating in each round: (1) <span id="S4.SS1.SSS0.Px3.p1.3.1" class="ltx_text ltx_font_bold">Full client participation</span> setting: all clients participate in updating the global model in each round, and the total number of clients is 10 in this setting; (2) <span id="S4.SS1.SSS0.Px3.p1.3.2" class="ltx_text ltx_font_bold">Partial client participation</span> setting: the total number of clients is 50 but only 10 clients are randomly sampled in each round. We adopt SGDM as the optimizer for local training. The local learning rate is 0.01 for MNIST-LT and 0.1 for CIFAR-10/100-LT. The number of local epochs is 5 for all datasets. As for our method, the re-balance factor <math id="S4.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">\lambda</annotation></semantics></math> is fixed as 0.1 in all experiments, and we explore the effect of different values of <math id="S4.SS1.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.2.m2.1c">\lambda</annotation></semantics></math> in Section <a href="#S5.SS1" title="5.1 Re-Balancing Strength Decides on The Convergence Trade-off ‣ 5 Further Explorations ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>. The quantity threshold <math id="S4.SS1.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.3.m3.1a"><mi id="S4.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.3.m3.1b"><ci id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.3.m3.1c">T</annotation></semantics></math> for each class to create the local balanced dataset is set as 8 for MNIST-LT and CIFAR-10-LT, and 2 for CIFAR-100-LT, and we put further discussion in Section <a href="#S5.SS2" title="5.2 Local Real Data Plays An Important Role in Re-Balancing The Classifier ‣ 5 Further Explorations ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>. Each experiment is run on 3 random seeds. Complete training details (e.g., the number of communication rounds in each setting, detailed hyper-parameters of other baselines) are in the Appendix.
Our code is implemented on the FedML <cite class="ltx_cite ltx_citemacro_cite">He <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite> platform.<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>Our code will be released upon acceptance.</span></span></span></p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Main Results</h3>

<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.9.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.9.9.10.1" class="ltx_tr">
<th id="S4.T1.9.9.10.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T1.9.9.10.1.1.1" class="ltx_text">
<span id="S4.T1.9.9.10.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.9.9.10.1.1.1.1.1" class="ltx_tr">
<span id="S4.T1.9.9.10.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Method</span></span>
</span></span></th>
<th id="S4.T1.9.9.10.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">MNIST-LT</th>
<th id="S4.T1.9.9.10.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-10-LT</th>
<th id="S4.T1.9.9.10.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-100-LT</th>
</tr>
<tr id="S4.T1.9.9.9" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mtext id="S4.T1.1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.1.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><eq id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1.1"></eq><ci id="S4.T1.1.1.1.1.m1.1.1.2a.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2"><mtext id="S4.T1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="S4.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="S4.T1.2.2.2.2.m1.1a"><mrow id="S4.T1.2.2.2.2.m1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.cmml"><mtext id="S4.T1.2.2.2.2.m1.1.1.2" xref="S4.T1.2.2.2.2.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.2.2.2.2.m1.1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T1.2.2.2.2.m1.1.1.3" xref="S4.T1.2.2.2.2.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1"><eq id="S4.T1.2.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1.1"></eq><ci id="S4.T1.2.2.2.2.m1.1.1.2a.cmml" xref="S4.T1.2.2.2.2.m1.1.1.2"><mtext id="S4.T1.2.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.2.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.2.2.2.2.m1.1.1.3.cmml" xref="S4.T1.2.2.2.2.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="S4.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.3.3.3.3.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.T1.3.3.3.3.m1.1a"><mrow id="S4.T1.3.3.3.3.m1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.cmml"><mtext id="S4.T1.3.3.3.3.m1.1.1.2" xref="S4.T1.3.3.3.3.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.3.3.3.3.m1.1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S4.T1.3.3.3.3.m1.1.1.3" xref="S4.T1.3.3.3.3.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.m1.1b"><apply id="S4.T1.3.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1"><eq id="S4.T1.3.3.3.3.m1.1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1.1"></eq><ci id="S4.T1.3.3.3.3.m1.1.1.2a.cmml" xref="S4.T1.3.3.3.3.m1.1.1.2"><mtext id="S4.T1.3.3.3.3.m1.1.1.2.cmml" xref="S4.T1.3.3.3.3.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.3.3.3.3.m1.1.1.3.cmml" xref="S4.T1.3.3.3.3.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.m1.1c">\text{IR}=100</annotation></semantics></math></th>
<th id="S4.T1.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.4.4.4.4.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="S4.T1.4.4.4.4.m1.1a"><mrow id="S4.T1.4.4.4.4.m1.1.1" xref="S4.T1.4.4.4.4.m1.1.1.cmml"><mtext id="S4.T1.4.4.4.4.m1.1.1.2" xref="S4.T1.4.4.4.4.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.4.4.4.4.m1.1.1.1" xref="S4.T1.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="S4.T1.4.4.4.4.m1.1.1.3" xref="S4.T1.4.4.4.4.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.4.m1.1b"><apply id="S4.T1.4.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.4.m1.1.1"><eq id="S4.T1.4.4.4.4.m1.1.1.1.cmml" xref="S4.T1.4.4.4.4.m1.1.1.1"></eq><ci id="S4.T1.4.4.4.4.m1.1.1.2a.cmml" xref="S4.T1.4.4.4.4.m1.1.1.2"><mtext id="S4.T1.4.4.4.4.m1.1.1.2.cmml" xref="S4.T1.4.4.4.4.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.4.4.4.4.m1.1.1.3.cmml" xref="S4.T1.4.4.4.4.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.4.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="S4.T1.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.5.5.5.5.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="S4.T1.5.5.5.5.m1.1a"><mrow id="S4.T1.5.5.5.5.m1.1.1" xref="S4.T1.5.5.5.5.m1.1.1.cmml"><mtext id="S4.T1.5.5.5.5.m1.1.1.2" xref="S4.T1.5.5.5.5.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.5.5.5.5.m1.1.1.1" xref="S4.T1.5.5.5.5.m1.1.1.1.cmml">=</mo><mn id="S4.T1.5.5.5.5.m1.1.1.3" xref="S4.T1.5.5.5.5.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.5.m1.1b"><apply id="S4.T1.5.5.5.5.m1.1.1.cmml" xref="S4.T1.5.5.5.5.m1.1.1"><eq id="S4.T1.5.5.5.5.m1.1.1.1.cmml" xref="S4.T1.5.5.5.5.m1.1.1.1"></eq><ci id="S4.T1.5.5.5.5.m1.1.1.2a.cmml" xref="S4.T1.5.5.5.5.m1.1.1.2"><mtext id="S4.T1.5.5.5.5.m1.1.1.2.cmml" xref="S4.T1.5.5.5.5.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.5.5.5.5.m1.1.1.3.cmml" xref="S4.T1.5.5.5.5.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.5.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="S4.T1.6.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.6.6.6.6.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.T1.6.6.6.6.m1.1a"><mrow id="S4.T1.6.6.6.6.m1.1.1" xref="S4.T1.6.6.6.6.m1.1.1.cmml"><mtext id="S4.T1.6.6.6.6.m1.1.1.2" xref="S4.T1.6.6.6.6.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.6.6.6.6.m1.1.1.1" xref="S4.T1.6.6.6.6.m1.1.1.1.cmml">=</mo><mn id="S4.T1.6.6.6.6.m1.1.1.3" xref="S4.T1.6.6.6.6.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.6.m1.1b"><apply id="S4.T1.6.6.6.6.m1.1.1.cmml" xref="S4.T1.6.6.6.6.m1.1.1"><eq id="S4.T1.6.6.6.6.m1.1.1.1.cmml" xref="S4.T1.6.6.6.6.m1.1.1.1"></eq><ci id="S4.T1.6.6.6.6.m1.1.1.2a.cmml" xref="S4.T1.6.6.6.6.m1.1.1.2"><mtext id="S4.T1.6.6.6.6.m1.1.1.2.cmml" xref="S4.T1.6.6.6.6.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.6.6.6.6.m1.1.1.3.cmml" xref="S4.T1.6.6.6.6.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.6.m1.1c">\text{IR}=100</annotation></semantics></math></th>
<th id="S4.T1.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.7.7.7.7.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="S4.T1.7.7.7.7.m1.1a"><mrow id="S4.T1.7.7.7.7.m1.1.1" xref="S4.T1.7.7.7.7.m1.1.1.cmml"><mtext id="S4.T1.7.7.7.7.m1.1.1.2" xref="S4.T1.7.7.7.7.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.7.7.7.7.m1.1.1.1" xref="S4.T1.7.7.7.7.m1.1.1.1.cmml">=</mo><mn id="S4.T1.7.7.7.7.m1.1.1.3" xref="S4.T1.7.7.7.7.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.7.m1.1b"><apply id="S4.T1.7.7.7.7.m1.1.1.cmml" xref="S4.T1.7.7.7.7.m1.1.1"><eq id="S4.T1.7.7.7.7.m1.1.1.1.cmml" xref="S4.T1.7.7.7.7.m1.1.1.1"></eq><ci id="S4.T1.7.7.7.7.m1.1.1.2a.cmml" xref="S4.T1.7.7.7.7.m1.1.1.2"><mtext id="S4.T1.7.7.7.7.m1.1.1.2.cmml" xref="S4.T1.7.7.7.7.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.7.7.7.7.m1.1.1.3.cmml" xref="S4.T1.7.7.7.7.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.7.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="S4.T1.8.8.8.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.8.8.8.8.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="S4.T1.8.8.8.8.m1.1a"><mrow id="S4.T1.8.8.8.8.m1.1.1" xref="S4.T1.8.8.8.8.m1.1.1.cmml"><mtext id="S4.T1.8.8.8.8.m1.1.1.2" xref="S4.T1.8.8.8.8.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.8.8.8.8.m1.1.1.1" xref="S4.T1.8.8.8.8.m1.1.1.1.cmml">=</mo><mn id="S4.T1.8.8.8.8.m1.1.1.3" xref="S4.T1.8.8.8.8.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.8.m1.1b"><apply id="S4.T1.8.8.8.8.m1.1.1.cmml" xref="S4.T1.8.8.8.8.m1.1.1"><eq id="S4.T1.8.8.8.8.m1.1.1.1.cmml" xref="S4.T1.8.8.8.8.m1.1.1.1"></eq><ci id="S4.T1.8.8.8.8.m1.1.1.2a.cmml" xref="S4.T1.8.8.8.8.m1.1.1.2"><mtext id="S4.T1.8.8.8.8.m1.1.1.2.cmml" xref="S4.T1.8.8.8.8.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.8.8.8.8.m1.1.1.3.cmml" xref="S4.T1.8.8.8.8.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.8.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="S4.T1.9.9.9.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T1.9.9.9.9.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.T1.9.9.9.9.m1.1a"><mrow id="S4.T1.9.9.9.9.m1.1.1" xref="S4.T1.9.9.9.9.m1.1.1.cmml"><mtext id="S4.T1.9.9.9.9.m1.1.1.2" xref="S4.T1.9.9.9.9.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T1.9.9.9.9.m1.1.1.1" xref="S4.T1.9.9.9.9.m1.1.1.1.cmml">=</mo><mn id="S4.T1.9.9.9.9.m1.1.1.3" xref="S4.T1.9.9.9.9.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.9.m1.1b"><apply id="S4.T1.9.9.9.9.m1.1.1.cmml" xref="S4.T1.9.9.9.9.m1.1.1"><eq id="S4.T1.9.9.9.9.m1.1.1.1.cmml" xref="S4.T1.9.9.9.9.m1.1.1.1"></eq><ci id="S4.T1.9.9.9.9.m1.1.1.2a.cmml" xref="S4.T1.9.9.9.9.m1.1.1.2"><mtext id="S4.T1.9.9.9.9.m1.1.1.2.cmml" xref="S4.T1.9.9.9.9.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T1.9.9.9.9.m1.1.1.3.cmml" xref="S4.T1.9.9.9.9.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.9.m1.1c">\text{IR}=100</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.9.9.11.1" class="ltx_tr">
<th id="S4.T1.9.9.11.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg+CE</th>
<td id="S4.T1.9.9.11.1.2" class="ltx_td ltx_align_center ltx_border_t">97.99</td>
<td id="S4.T1.9.9.11.1.3" class="ltx_td ltx_align_center ltx_border_t">95.98</td>
<td id="S4.T1.9.9.11.1.4" class="ltx_td ltx_align_center ltx_border_t">92.71</td>
<td id="S4.T1.9.9.11.1.5" class="ltx_td ltx_align_center ltx_border_t">76.21</td>
<td id="S4.T1.9.9.11.1.6" class="ltx_td ltx_align_center ltx_border_t">68.41</td>
<td id="S4.T1.9.9.11.1.7" class="ltx_td ltx_align_center ltx_border_t">59.83</td>
<td id="S4.T1.9.9.11.1.8" class="ltx_td ltx_align_center ltx_border_t">49.08</td>
<td id="S4.T1.9.9.11.1.9" class="ltx_td ltx_align_center ltx_border_t">36.47</td>
<td id="S4.T1.9.9.11.1.10" class="ltx_td ltx_align_center ltx_border_t">33.28</td>
</tr>
<tr id="S4.T1.9.9.12.2" class="ltx_tr">
<th id="S4.T1.9.9.12.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Fed-Focal Loss</th>
<td id="S4.T1.9.9.12.2.2" class="ltx_td ltx_align_center">97.90</td>
<td id="S4.T1.9.9.12.2.3" class="ltx_td ltx_align_center">96.14</td>
<td id="S4.T1.9.9.12.2.4" class="ltx_td ltx_align_center">92.97</td>
<td id="S4.T1.9.9.12.2.5" class="ltx_td ltx_align_center">77.92</td>
<td id="S4.T1.9.9.12.2.6" class="ltx_td ltx_align_center">61.21</td>
<td id="S4.T1.9.9.12.2.7" class="ltx_td ltx_align_center">59.86</td>
<td id="S4.T1.9.9.12.2.8" class="ltx_td ltx_align_center">48.14</td>
<td id="S4.T1.9.9.12.2.9" class="ltx_td ltx_align_center">35.51</td>
<td id="S4.T1.9.9.12.2.10" class="ltx_td ltx_align_center">30.05</td>
</tr>
<tr id="S4.T1.9.9.13.3" class="ltx_tr">
<th id="S4.T1.9.9.13.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Ratio Loss</th>
<td id="S4.T1.9.9.13.3.2" class="ltx_td ltx_align_center">97.96</td>
<td id="S4.T1.9.9.13.3.3" class="ltx_td ltx_align_center">96.20</td>
<td id="S4.T1.9.9.13.3.4" class="ltx_td ltx_align_center">92.99</td>
<td id="S4.T1.9.9.13.3.5" class="ltx_td ltx_align_center">78.58</td>
<td id="S4.T1.9.9.13.3.6" class="ltx_td ltx_align_center">68.01</td>
<td id="S4.T1.9.9.13.3.7" class="ltx_td ltx_align_center">59.27</td>
<td id="S4.T1.9.9.13.3.8" class="ltx_td ltx_align_center">48.30</td>
<td id="S4.T1.9.9.13.3.9" class="ltx_td ltx_align_center">37.62</td>
<td id="S4.T1.9.9.13.3.10" class="ltx_td ltx_align_center">31.92</td>
</tr>
<tr id="S4.T1.9.9.14.4" class="ltx_tr">
<th id="S4.T1.9.9.14.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CLIMB</th>
<td id="S4.T1.9.9.14.4.2" class="ltx_td ltx_align_center">97.89</td>
<td id="S4.T1.9.9.14.4.3" class="ltx_td ltx_align_center">95.87</td>
<td id="S4.T1.9.9.14.4.4" class="ltx_td ltx_align_center">92.71</td>
<td id="S4.T1.9.9.14.4.5" class="ltx_td ltx_align_center">78.95</td>
<td id="S4.T1.9.9.14.4.6" class="ltx_td ltx_align_center">66.25</td>
<td id="S4.T1.9.9.14.4.7" class="ltx_td ltx_align_center">57.67</td>
<td id="S4.T1.9.9.14.4.8" class="ltx_td ltx_align_center">49.27</td>
<td id="S4.T1.9.9.14.4.9" class="ltx_td ltx_align_center">36.13</td>
<td id="S4.T1.9.9.14.4.10" class="ltx_td ltx_align_center">32.18</td>
</tr>
<tr id="S4.T1.9.9.15.5" class="ltx_tr">
<th id="S4.T1.9.9.15.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CReFF</th>
<td id="S4.T1.9.9.15.5.2" class="ltx_td ltx_align_center">97.68</td>
<td id="S4.T1.9.9.15.5.3" class="ltx_td ltx_align_center">96.49</td>
<td id="S4.T1.9.9.15.5.4" class="ltx_td ltx_align_center">93.85</td>
<td id="S4.T1.9.9.15.5.5" class="ltx_td ltx_align_center">83.18</td>
<td id="S4.T1.9.9.15.5.6" class="ltx_td ltx_align_center">73.46</td>
<td id="S4.T1.9.9.15.5.7" class="ltx_td ltx_align_center">69.36</td>
<td id="S4.T1.9.9.15.5.8" class="ltx_td ltx_align_center">46.58</td>
<td id="S4.T1.9.9.15.5.9" class="ltx_td ltx_align_center">35.82</td>
<td id="S4.T1.9.9.15.5.10" class="ltx_td ltx_align_center">33.46</td>
</tr>
<tr id="S4.T1.9.9.16.6" class="ltx_tr">
<th id="S4.T1.9.9.16.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">Ours</th>
<td id="S4.T1.9.9.16.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.2.1" class="ltx_text ltx_font_bold">98.34</span></td>
<td id="S4.T1.9.9.16.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.3.1" class="ltx_text ltx_font_bold">97.06</span></td>
<td id="S4.T1.9.9.16.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.4.1" class="ltx_text ltx_font_bold">95.73</span></td>
<td id="S4.T1.9.9.16.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.5.1" class="ltx_text ltx_font_bold">83.74</span></td>
<td id="S4.T1.9.9.16.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.6.1" class="ltx_text ltx_font_bold">74.01</span></td>
<td id="S4.T1.9.9.16.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.7.1" class="ltx_text ltx_font_bold">71.04</span></td>
<td id="S4.T1.9.9.16.6.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.8.1" class="ltx_text ltx_font_bold">51.09</span></td>
<td id="S4.T1.9.9.16.6.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.9.1" class="ltx_text ltx_font_bold">38.49</span></td>
<td id="S4.T1.9.9.16.6.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.9.9.16.6.10.1" class="ltx_text ltx_font_bold">34.63</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Results under the <span id="S4.T1.11.1" class="ltx_text ltx_font_bold">full client participation</span> setting. We report the overall test accuracy on the balanced testing set of each dataset.</figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.9.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.9.9.10.1" class="ltx_tr">
<th id="S4.T2.9.9.10.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S4.T2.9.9.10.1.1.1" class="ltx_text">
<span id="S4.T2.9.9.10.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.9.9.10.1.1.1.1.1" class="ltx_tr">
<span id="S4.T2.9.9.10.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Method</span></span>
</span></span></th>
<th id="S4.T2.9.9.10.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">MNIST-LT</th>
<th id="S4.T2.9.9.10.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-10-LT</th>
<th id="S4.T2.9.9.10.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-100-LT</th>
</tr>
<tr id="S4.T2.9.9.9" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mtext id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.1.1.1.1.m1.1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><eq id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1"></eq><ci id="S4.T2.1.1.1.1.m1.1.1.2a.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2"><mtext id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mrow id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml"><mtext id="S4.T2.2.2.2.2.m1.1.1.2" xref="S4.T2.2.2.2.2.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.2.2.2.2.m1.1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T2.2.2.2.2.m1.1.1.3" xref="S4.T2.2.2.2.2.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1"><eq id="S4.T2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1.1"></eq><ci id="S4.T2.2.2.2.2.m1.1.1.2a.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2"><mtext id="S4.T2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mrow id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml"><mtext id="S4.T2.3.3.3.3.m1.1.1.2" xref="S4.T2.3.3.3.3.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.3.3.3.3.m1.1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S4.T2.3.3.3.3.m1.1.1.3" xref="S4.T2.3.3.3.3.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><apply id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1"><eq id="S4.T2.3.3.3.3.m1.1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1.1"></eq><ci id="S4.T2.3.3.3.3.m1.1.1.2a.cmml" xref="S4.T2.3.3.3.3.m1.1.1.2"><mtext id="S4.T2.3.3.3.3.m1.1.1.2.cmml" xref="S4.T2.3.3.3.3.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.3.3.3.3.m1.1.1.3.cmml" xref="S4.T2.3.3.3.3.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">\text{IR}=100</annotation></semantics></math></th>
<th id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.4.4.4.4.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="S4.T2.4.4.4.4.m1.1a"><mrow id="S4.T2.4.4.4.4.m1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.cmml"><mtext id="S4.T2.4.4.4.4.m1.1.1.2" xref="S4.T2.4.4.4.4.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.4.4.4.4.m1.1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="S4.T2.4.4.4.4.m1.1.1.3" xref="S4.T2.4.4.4.4.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.m1.1b"><apply id="S4.T2.4.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1"><eq id="S4.T2.4.4.4.4.m1.1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1.1"></eq><ci id="S4.T2.4.4.4.4.m1.1.1.2a.cmml" xref="S4.T2.4.4.4.4.m1.1.1.2"><mtext id="S4.T2.4.4.4.4.m1.1.1.2.cmml" xref="S4.T2.4.4.4.4.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.4.4.4.4.m1.1.1.3.cmml" xref="S4.T2.4.4.4.4.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="S4.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.5.5.5.5.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="S4.T2.5.5.5.5.m1.1a"><mrow id="S4.T2.5.5.5.5.m1.1.1" xref="S4.T2.5.5.5.5.m1.1.1.cmml"><mtext id="S4.T2.5.5.5.5.m1.1.1.2" xref="S4.T2.5.5.5.5.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.5.5.5.5.m1.1.1.1" xref="S4.T2.5.5.5.5.m1.1.1.1.cmml">=</mo><mn id="S4.T2.5.5.5.5.m1.1.1.3" xref="S4.T2.5.5.5.5.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.5.m1.1b"><apply id="S4.T2.5.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1"><eq id="S4.T2.5.5.5.5.m1.1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1.1"></eq><ci id="S4.T2.5.5.5.5.m1.1.1.2a.cmml" xref="S4.T2.5.5.5.5.m1.1.1.2"><mtext id="S4.T2.5.5.5.5.m1.1.1.2.cmml" xref="S4.T2.5.5.5.5.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.5.5.5.5.m1.1.1.3.cmml" xref="S4.T2.5.5.5.5.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.5.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="S4.T2.6.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.6.6.6.6.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.T2.6.6.6.6.m1.1a"><mrow id="S4.T2.6.6.6.6.m1.1.1" xref="S4.T2.6.6.6.6.m1.1.1.cmml"><mtext id="S4.T2.6.6.6.6.m1.1.1.2" xref="S4.T2.6.6.6.6.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.6.6.6.6.m1.1.1.1" xref="S4.T2.6.6.6.6.m1.1.1.1.cmml">=</mo><mn id="S4.T2.6.6.6.6.m1.1.1.3" xref="S4.T2.6.6.6.6.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.6.m1.1b"><apply id="S4.T2.6.6.6.6.m1.1.1.cmml" xref="S4.T2.6.6.6.6.m1.1.1"><eq id="S4.T2.6.6.6.6.m1.1.1.1.cmml" xref="S4.T2.6.6.6.6.m1.1.1.1"></eq><ci id="S4.T2.6.6.6.6.m1.1.1.2a.cmml" xref="S4.T2.6.6.6.6.m1.1.1.2"><mtext id="S4.T2.6.6.6.6.m1.1.1.2.cmml" xref="S4.T2.6.6.6.6.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.6.6.6.6.m1.1.1.3.cmml" xref="S4.T2.6.6.6.6.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.6.m1.1c">\text{IR}=100</annotation></semantics></math></th>
<th id="S4.T2.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.7.7.7.7.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="S4.T2.7.7.7.7.m1.1a"><mrow id="S4.T2.7.7.7.7.m1.1.1" xref="S4.T2.7.7.7.7.m1.1.1.cmml"><mtext id="S4.T2.7.7.7.7.m1.1.1.2" xref="S4.T2.7.7.7.7.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.7.7.7.7.m1.1.1.1" xref="S4.T2.7.7.7.7.m1.1.1.1.cmml">=</mo><mn id="S4.T2.7.7.7.7.m1.1.1.3" xref="S4.T2.7.7.7.7.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.7.m1.1b"><apply id="S4.T2.7.7.7.7.m1.1.1.cmml" xref="S4.T2.7.7.7.7.m1.1.1"><eq id="S4.T2.7.7.7.7.m1.1.1.1.cmml" xref="S4.T2.7.7.7.7.m1.1.1.1"></eq><ci id="S4.T2.7.7.7.7.m1.1.1.2a.cmml" xref="S4.T2.7.7.7.7.m1.1.1.2"><mtext id="S4.T2.7.7.7.7.m1.1.1.2.cmml" xref="S4.T2.7.7.7.7.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.7.7.7.7.m1.1.1.3.cmml" xref="S4.T2.7.7.7.7.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.7.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="S4.T2.8.8.8.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.8.8.8.8.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="S4.T2.8.8.8.8.m1.1a"><mrow id="S4.T2.8.8.8.8.m1.1.1" xref="S4.T2.8.8.8.8.m1.1.1.cmml"><mtext id="S4.T2.8.8.8.8.m1.1.1.2" xref="S4.T2.8.8.8.8.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.8.8.8.8.m1.1.1.1" xref="S4.T2.8.8.8.8.m1.1.1.1.cmml">=</mo><mn id="S4.T2.8.8.8.8.m1.1.1.3" xref="S4.T2.8.8.8.8.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.8.m1.1b"><apply id="S4.T2.8.8.8.8.m1.1.1.cmml" xref="S4.T2.8.8.8.8.m1.1.1"><eq id="S4.T2.8.8.8.8.m1.1.1.1.cmml" xref="S4.T2.8.8.8.8.m1.1.1.1"></eq><ci id="S4.T2.8.8.8.8.m1.1.1.2a.cmml" xref="S4.T2.8.8.8.8.m1.1.1.2"><mtext id="S4.T2.8.8.8.8.m1.1.1.2.cmml" xref="S4.T2.8.8.8.8.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.8.8.8.8.m1.1.1.3.cmml" xref="S4.T2.8.8.8.8.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.8.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="S4.T2.9.9.9.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.9.9.9.9.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.T2.9.9.9.9.m1.1a"><mrow id="S4.T2.9.9.9.9.m1.1.1" xref="S4.T2.9.9.9.9.m1.1.1.cmml"><mtext id="S4.T2.9.9.9.9.m1.1.1.2" xref="S4.T2.9.9.9.9.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T2.9.9.9.9.m1.1.1.1" xref="S4.T2.9.9.9.9.m1.1.1.1.cmml">=</mo><mn id="S4.T2.9.9.9.9.m1.1.1.3" xref="S4.T2.9.9.9.9.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.9.m1.1b"><apply id="S4.T2.9.9.9.9.m1.1.1.cmml" xref="S4.T2.9.9.9.9.m1.1.1"><eq id="S4.T2.9.9.9.9.m1.1.1.1.cmml" xref="S4.T2.9.9.9.9.m1.1.1.1"></eq><ci id="S4.T2.9.9.9.9.m1.1.1.2a.cmml" xref="S4.T2.9.9.9.9.m1.1.1.2"><mtext id="S4.T2.9.9.9.9.m1.1.1.2.cmml" xref="S4.T2.9.9.9.9.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T2.9.9.9.9.m1.1.1.3.cmml" xref="S4.T2.9.9.9.9.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.9.m1.1c">\text{IR}=100</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.9.9.11.1" class="ltx_tr">
<th id="S4.T2.9.9.11.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg+CE</th>
<td id="S4.T2.9.9.11.1.2" class="ltx_td ltx_align_center ltx_border_t">95.51</td>
<td id="S4.T2.9.9.11.1.3" class="ltx_td ltx_align_center ltx_border_t">91.82</td>
<td id="S4.T2.9.9.11.1.4" class="ltx_td ltx_align_center ltx_border_t">89.92</td>
<td id="S4.T2.9.9.11.1.5" class="ltx_td ltx_align_center ltx_border_t">60.38</td>
<td id="S4.T2.9.9.11.1.6" class="ltx_td ltx_align_center ltx_border_t">45.15</td>
<td id="S4.T2.9.9.11.1.7" class="ltx_td ltx_align_center ltx_border_t">40.06</td>
<td id="S4.T2.9.9.11.1.8" class="ltx_td ltx_align_center ltx_border_t">40.81</td>
<td id="S4.T2.9.9.11.1.9" class="ltx_td ltx_align_center ltx_border_t">24.62</td>
<td id="S4.T2.9.9.11.1.10" class="ltx_td ltx_align_center ltx_border_t">22.08</td>
</tr>
<tr id="S4.T2.9.9.12.2" class="ltx_tr">
<th id="S4.T2.9.9.12.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Fed-Focal Loss</th>
<td id="S4.T2.9.9.12.2.2" class="ltx_td ltx_align_center">96.79</td>
<td id="S4.T2.9.9.12.2.3" class="ltx_td ltx_align_center">92.59</td>
<td id="S4.T2.9.9.12.2.4" class="ltx_td ltx_align_center">90.45</td>
<td id="S4.T2.9.9.12.2.5" class="ltx_td ltx_align_center">61.16</td>
<td id="S4.T2.9.9.12.2.6" class="ltx_td ltx_align_center">46.20</td>
<td id="S4.T2.9.9.12.2.7" class="ltx_td ltx_align_center">41.10</td>
<td id="S4.T2.9.9.12.2.8" class="ltx_td ltx_align_center">40.85</td>
<td id="S4.T2.9.9.12.2.9" class="ltx_td ltx_align_center">24.73</td>
<td id="S4.T2.9.9.12.2.10" class="ltx_td ltx_align_center">20.17</td>
</tr>
<tr id="S4.T2.9.9.13.3" class="ltx_tr">
<th id="S4.T2.9.9.13.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Ratio Loss</th>
<td id="S4.T2.9.9.13.3.2" class="ltx_td ltx_align_center">95.17</td>
<td id="S4.T2.9.9.13.3.3" class="ltx_td ltx_align_center">91.10</td>
<td id="S4.T2.9.9.13.3.4" class="ltx_td ltx_align_center">89.64</td>
<td id="S4.T2.9.9.13.3.5" class="ltx_td ltx_align_center">63.97</td>
<td id="S4.T2.9.9.13.3.6" class="ltx_td ltx_align_center">44.22</td>
<td id="S4.T2.9.9.13.3.7" class="ltx_td ltx_align_center">42.11</td>
<td id="S4.T2.9.9.13.3.8" class="ltx_td ltx_align_center">40.96</td>
<td id="S4.T2.9.9.13.3.9" class="ltx_td ltx_align_center">24.12</td>
<td id="S4.T2.9.9.13.3.10" class="ltx_td ltx_align_center">23.06</td>
</tr>
<tr id="S4.T2.9.9.14.4" class="ltx_tr">
<th id="S4.T2.9.9.14.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CLIMB</th>
<td id="S4.T2.9.9.14.4.2" class="ltx_td ltx_align_center">95.67</td>
<td id="S4.T2.9.9.14.4.3" class="ltx_td ltx_align_center">92.24</td>
<td id="S4.T2.9.9.14.4.4" class="ltx_td ltx_align_center">89.75</td>
<td id="S4.T2.9.9.14.4.5" class="ltx_td ltx_align_center">61.75</td>
<td id="S4.T2.9.9.14.4.6" class="ltx_td ltx_align_center">46.91</td>
<td id="S4.T2.9.9.14.4.7" class="ltx_td ltx_align_center">42.02</td>
<td id="S4.T2.9.9.14.4.8" class="ltx_td ltx_align_center">40.64</td>
<td id="S4.T2.9.9.14.4.9" class="ltx_td ltx_align_center">23.99</td>
<td id="S4.T2.9.9.14.4.10" class="ltx_td ltx_align_center">21.44</td>
</tr>
<tr id="S4.T2.9.9.15.5" class="ltx_tr">
<th id="S4.T2.9.9.15.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CReFF</th>
<td id="S4.T2.9.9.15.5.2" class="ltx_td ltx_align_center">96.29</td>
<td id="S4.T2.9.9.15.5.3" class="ltx_td ltx_align_center">94.16</td>
<td id="S4.T2.9.9.15.5.4" class="ltx_td ltx_align_center">92.16</td>
<td id="S4.T2.9.9.15.5.5" class="ltx_td ltx_align_center">69.38</td>
<td id="S4.T2.9.9.15.5.6" class="ltx_td ltx_align_center">60.52</td>
<td id="S4.T2.9.9.15.5.7" class="ltx_td ltx_align_center">55.63</td>
<td id="S4.T2.9.9.15.5.8" class="ltx_td ltx_align_center">39.38</td>
<td id="S4.T2.9.9.15.5.9" class="ltx_td ltx_align_center">25.42</td>
<td id="S4.T2.9.9.15.5.10" class="ltx_td ltx_align_center">24.77</td>
</tr>
<tr id="S4.T2.9.9.16.6" class="ltx_tr">
<th id="S4.T2.9.9.16.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">Ours</th>
<td id="S4.T2.9.9.16.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.2.1" class="ltx_text ltx_font_bold">97.54</span></td>
<td id="S4.T2.9.9.16.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.3.1" class="ltx_text ltx_font_bold">95.17</span></td>
<td id="S4.T2.9.9.16.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.4.1" class="ltx_text ltx_font_bold">93.61</span></td>
<td id="S4.T2.9.9.16.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.5.1" class="ltx_text ltx_font_bold">71.68</span></td>
<td id="S4.T2.9.9.16.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.6.1" class="ltx_text ltx_font_bold">61.42</span></td>
<td id="S4.T2.9.9.16.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.7.1" class="ltx_text ltx_font_bold">57.11</span></td>
<td id="S4.T2.9.9.16.6.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.8.1" class="ltx_text ltx_font_bold">42.97</span></td>
<td id="S4.T2.9.9.16.6.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.9.1" class="ltx_text ltx_font_bold">27.73</span></td>
<td id="S4.T2.9.9.16.6.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.9.9.16.6.10.1" class="ltx_text ltx_font_bold">25.64</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results under the <span id="S4.T2.11.1" class="ltx_text ltx_font_bold">partial client participation</span> setting. We report the overall test accuracy on the balanced testing set of each dataset.</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In the main paper, we report the averaged accuracy over the last 10 rounds on the balanced testing set of each dataset following existing studies <cite class="ltx_cite ltx_citemacro_cite">Reddi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>. We also display the averaged test accuracy on tail classes in each setting in the Appendix to show that our method can significantly bring improvement to the model’s performance on tail classes. The results under the full client participation setting are in Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Main Results ‣ 4 Experiments and Analysis ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, and Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Main Results ‣ 4 Experiments and Analysis ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> displays the results under the partial client participation setting. We can draw the main conclusion from these tables as: <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">our method can consistently outperform the existing algorithms in all settings.</span></p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">As we can see, Fed-Focal Loss achieves lower performance than the FedAvg with CE loss in some settings, which validates the claim that directly applying the centralized long-tailed learning methods can not help to address the global class imbalance problem in FL, as it ignores the mismatch between the global and the local imbalance patterns. Ratio Loss and CLIMB apply the class-level re-weighting and client-level re-weighting idea separately, and gain slight improvement compared with FedAvg. We analyze that the reason for the limited improvement lies in that though the re-weighting practice helps the model to focus more on the learning of tail classes, it is not conducive to the representation learning on the abundant data of the head classes <cite class="ltx_cite ltx_citemacro_cite">Kang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite>. Moreover, the assumption of obtaining a global auxiliary dataset makes Ratio Loss impractical in real cases.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2301.10394/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="247" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The test accuracy curves on CIFAR-10-LT with <math id="S4.F2.2.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.F2.2.m1.1b"><mrow id="S4.F2.2.m1.1.1" xref="S4.F2.2.m1.1.1.cmml"><mtext id="S4.F2.2.m1.1.1.2" xref="S4.F2.2.m1.1.1.2a.cmml">IR</mtext><mo id="S4.F2.2.m1.1.1.1" xref="S4.F2.2.m1.1.1.1.cmml">=</mo><mn id="S4.F2.2.m1.1.1.3" xref="S4.F2.2.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.2.m1.1c"><apply id="S4.F2.2.m1.1.1.cmml" xref="S4.F2.2.m1.1.1"><eq id="S4.F2.2.m1.1.1.1.cmml" xref="S4.F2.2.m1.1.1.1"></eq><ci id="S4.F2.2.m1.1.1.2a.cmml" xref="S4.F2.2.m1.1.1.2"><mtext id="S4.F2.2.m1.1.1.2.cmml" xref="S4.F2.2.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.F2.2.m1.1.1.3.cmml" xref="S4.F2.2.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.m1.1d">\text{IR}=100</annotation></semantics></math> under the full client participation setting. Our method achieves faster convergence speed and better performance than all existing baselines.</figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">The superior performance of CReFF helps to validates the effectiveness of the classifier re-balancing on the final performance. However, the optimization of the federated features requires massive computations on the server (especially when the number of classes is large), and the federated features from the same class may converge to be similar. Thus, the re-trained classifier faces the problem that it may overfit on the highly similar and small amount of the federated features (reflected in the poorer performance under smaller <span id="S4.SS2.p3.1.1" class="ltx_text ltx_markedasmath">IR</span>). Our method instead takes full advantage of the local real data integrated with the global gradient prototypes to locally re-balance the classifier while maintaining the good effects of instance-balanced training on the representation learning, and consistently outperforms all previous methods by a large margin. Compared with CReFF and Ratio Loss, we do not have extra requirements except for the aggregation procedures on the server, and produce a re-balanced classifier that has better generalization ability with the help of abundant real data.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">We further display the evaluation accuracy curve after each round in CIFAR-10-LT (<math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mtext id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2a.cmml">IR</mtext><mo id="S4.SS2.p4.1.m1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><eq id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1"></eq><ci id="S4.SS2.p4.1.m1.1.1.2a.cmml" xref="S4.SS2.p4.1.m1.1.1.2"><mtext id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\text{IR}=100</annotation></semantics></math>) under the full client participation setting in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.2 Main Results ‣ 4 Experiments and Analysis ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. As we can see, <span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_bold">our method not only has the best converged performance, but also achieves much faster convergence speed than all baseline methods.</span> That is because our method re-balances the classifier at each local training step, and this makes it converge faster to the optimal balanced classifier.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results in Another Class Imbalance Setting</h3>

<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;" rowspan="2"><span id="S4.T3.3.1.1.1.1" class="ltx_text" style="font-size:90%;">
<span id="S4.T3.3.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.3.1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T3.3.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:5.0pt;padding-right:5.0pt;">Method</span></span>
</span></span></th>
<th id="S4.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;" colspan="2"><span id="S4.T3.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Full Participation</span></th>
<th id="S4.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.0pt;padding-right:5.0pt;" colspan="2"><span id="S4.T3.3.1.1.3.1" class="ltx_text" style="font-size:90%;">Partial Participation</span></th>
</tr>
<tr id="S4.T3.3.2.2" class="ltx_tr">
<th id="S4.T3.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.2.2.1.1" class="ltx_text" style="font-size:90%;">MNIST</span></th>
<th id="S4.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.2.2.2.1" class="ltx_text" style="font-size:90%;">CIFAR-10</span></th>
<th id="S4.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.2.2.3.1" class="ltx_text" style="font-size:90%;">MNIST</span></th>
<th id="S4.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.2.2.4.1" class="ltx_text" style="font-size:90%;">CIFAR-10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.3.3.1" class="ltx_tr">
<th id="S4.T3.3.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.3.1.1.1" class="ltx_text" style="font-size:90%;">FedAvg+CE</span></th>
<td id="S4.T3.3.3.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.3.1.2.1" class="ltx_text" style="font-size:90%;">93.91</span></td>
<td id="S4.T3.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.3.1.3.1" class="ltx_text" style="font-size:90%;">70.91</span></td>
<td id="S4.T3.3.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.3.1.4.1" class="ltx_text" style="font-size:90%;">91.97</span></td>
<td id="S4.T3.3.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.3.1.5.1" class="ltx_text" style="font-size:90%;">61.27</span></td>
</tr>
<tr id="S4.T3.3.4.2" class="ltx_tr">
<th id="S4.T3.3.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.4.2.1.1" class="ltx_text" style="font-size:90%;">Fed-Focal Loss</span></th>
<td id="S4.T3.3.4.2.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.4.2.2.1" class="ltx_text" style="font-size:90%;">93.53</span></td>
<td id="S4.T3.3.4.2.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.4.2.3.1" class="ltx_text" style="font-size:90%;">70.77</span></td>
<td id="S4.T3.3.4.2.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.4.2.4.1" class="ltx_text" style="font-size:90%;">91.77</span></td>
<td id="S4.T3.3.4.2.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.4.2.5.1" class="ltx_text" style="font-size:90%;">59.18</span></td>
</tr>
<tr id="S4.T3.3.5.3" class="ltx_tr">
<th id="S4.T3.3.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.5.3.1.1" class="ltx_text" style="font-size:90%;">Ratio Loss</span></th>
<td id="S4.T3.3.5.3.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.5.3.2.1" class="ltx_text" style="font-size:90%;">94.23</span></td>
<td id="S4.T3.3.5.3.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.5.3.3.1" class="ltx_text" style="font-size:90%;">73.22</span></td>
<td id="S4.T3.3.5.3.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.5.3.4.1" class="ltx_text" style="font-size:90%;">92.32</span></td>
<td id="S4.T3.3.5.3.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.5.3.5.1" class="ltx_text" style="font-size:90%;">62.86</span></td>
</tr>
<tr id="S4.T3.3.6.4" class="ltx_tr">
<th id="S4.T3.3.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.6.4.1.1" class="ltx_text" style="font-size:90%;">CLIMB</span></th>
<td id="S4.T3.3.6.4.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.6.4.2.1" class="ltx_text" style="font-size:90%;">93.89</span></td>
<td id="S4.T3.3.6.4.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.6.4.3.1" class="ltx_text" style="font-size:90%;">72.04</span></td>
<td id="S4.T3.3.6.4.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.6.4.4.1" class="ltx_text" style="font-size:90%;">92.11</span></td>
<td id="S4.T3.3.6.4.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.6.4.5.1" class="ltx_text" style="font-size:90%;">63.18</span></td>
</tr>
<tr id="S4.T3.3.7.5" class="ltx_tr">
<th id="S4.T3.3.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.7.5.1.1" class="ltx_text" style="font-size:90%;">CReFF</span></th>
<td id="S4.T3.3.7.5.2" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.7.5.2.1" class="ltx_text" style="font-size:90%;">96.70</span></td>
<td id="S4.T3.3.7.5.3" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.7.5.3.1" class="ltx_text" style="font-size:90%;">78.98</span></td>
<td id="S4.T3.3.7.5.4" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.7.5.4.1" class="ltx_text" style="font-size:90%;">96.01</span></td>
<td id="S4.T3.3.7.5.5" class="ltx_td ltx_align_center" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.7.5.5.1" class="ltx_text" style="font-size:90%;">71.41</span></td>
</tr>
<tr id="S4.T3.3.8.6" class="ltx_tr">
<th id="S4.T3.3.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.8.6.1.1" class="ltx_text" style="font-size:90%;">Ours</span></th>
<td id="S4.T3.3.8.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.8.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">96.86</span></td>
<td id="S4.T3.3.8.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.8.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">79.88</span></td>
<td id="S4.T3.3.8.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.8.6.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">96.43</span></td>
<td id="S4.T3.3.8.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:5.0pt;padding-right:5.0pt;"><span id="S4.T3.3.8.6.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">73.31</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results in the binary class imbalance setting. <math id="S4.T3.2.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.T3.2.m1.1b"><mrow id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml"><mtext id="S4.T3.2.m1.1.1.2" xref="S4.T3.2.m1.1.1.2a.cmml">IR</mtext><mo id="S4.T3.2.m1.1.1.1" xref="S4.T3.2.m1.1.1.1.cmml">=</mo><mn id="S4.T3.2.m1.1.1.3" xref="S4.T3.2.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><apply id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1"><eq id="S4.T3.2.m1.1.1.1.cmml" xref="S4.T3.2.m1.1.1.1"></eq><ci id="S4.T3.2.m1.1.1.2a.cmml" xref="S4.T3.2.m1.1.1.2"><mtext id="S4.T3.2.m1.1.1.2.cmml" xref="S4.T3.2.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S4.T3.2.m1.1.1.3.cmml" xref="S4.T3.2.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">\text{IR}=100</annotation></semantics></math> and the randomly chosen tail classes are 0, 7 and 8.</figcaption>
</figure>
<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">We also conduct experiments in a binary class imbalance setting in FL <cite class="ltx_cite ltx_citemacro_cite">Shen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite>, in which three classes are randomly chosen as the tail classes, and they are assigned with <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="1/\text{IR}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">1</mn><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">/</mo><mtext id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3a.cmml">IR</mtext></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><divide id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></divide><cn type="integer" id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">1</cn><ci id="S4.SS3.p1.1.m1.1.1.3a.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><mtext id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">IR</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">1/\text{IR}</annotation></semantics></math> number of sampled compared with other normal/head classes. The experiments are conducted on MNIST and CIFAR-10 datasets with <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mtext id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2a.cmml">IR</mtext><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><eq id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></eq><ci id="S4.SS3.p1.2.m2.1.1.2a.cmml" xref="S4.SS3.p1.2.m2.1.1.2"><mtext id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">IR</mtext></ci><cn type="integer" id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\text{IR}=100</annotation></semantics></math>, and other experimental settings are kept as the same as that in our main experiments. The results are in Table <a href="#S4.T3" title="Table 3 ‣ 4.3 Results in Another Class Imbalance Setting ‣ 4 Experiments and Analysis ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The conclusion remains the same that, <span id="S4.SS3.p1.2.1" class="ltx_text ltx_font_bold">our method achieves the best performance in all cases.</span></p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Further Explorations</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we make further explorations about the two crucial hyper-parameters of our method. The following experiments are conducted on CIFAR-10-LT with <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mtext id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2a.cmml">IR</mtext><mo id="S5.p1.1.m1.1.1.1" xref="S5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><eq id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1.1"></eq><ci id="S5.p1.1.m1.1.1.2a.cmml" xref="S5.p1.1.m1.1.1.2"><mtext id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">IR</mtext></ci><cn type="integer" id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\text{IR}=100</annotation></semantics></math> under the full client participation setting.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Re-Balancing Strength Decides on The Convergence Trade-off</h3>

<figure id="S5.F3" class="ltx_figure"><img src="/html/2301.10394/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="247" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The test accuracy of using different re-balance factor <math id="S5.F3.3.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.F3.3.m1.1b"><mi id="S5.F3.3.m1.1.1" xref="S5.F3.3.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F3.3.m1.1c"><ci id="S5.F3.3.m1.1.1.cmml" xref="S5.F3.3.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.3.m1.1d">\lambda</annotation></semantics></math> in CIFAR-10-LT. Smaller <math id="S5.F3.4.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.F3.4.m2.1b"><mi id="S5.F3.4.m2.1.1" xref="S5.F3.4.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F3.4.m2.1c"><ci id="S5.F3.4.m2.1.1.cmml" xref="S5.F3.4.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.4.m2.1d">\lambda</annotation></semantics></math> leads to slower convergence speed but relatively better generalization ability.</figcaption>
</figure>
<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.9" class="ltx_p">In order to solve the optimization target of Eq. (<a href="#S3.E4" title="In 3.2 Our Optimization Target ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), we consider updating <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mi id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><ci id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\boldsymbol{W}</annotation></semantics></math> in a multi-task learning setting as Eq. (<a href="#S3.E12" title="In Updating 𝑾. ‣ Local Training Stage ‣ 3.3 Classifier Re-Balancing by Integrating Local Real Data with Global Gradient Prototypes ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>), where a re-balance factor <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><ci id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\lambda</annotation></semantics></math> is used to control the re-balancing strength. Here, we conduct experiments to explore the effect of different <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mi id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><ci id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\lambda</annotation></semantics></math>s on the model’s performance, and the results are shown in Figure <a href="#S5.F3" title="Figure 3 ‣ 5.1 Re-Balancing Strength Decides on The Convergence Trade-off ‣ 5 Further Explorations ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We find that the smaller <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><mi id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><ci id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">\lambda</annotation></semantics></math> results in slower convergence speed but obtains relatively better performance of the converged model. We analyze the reason lies in that, the <math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><msubsup id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml"><mi id="S5.SS1.p1.5.m5.1.1.2.2" xref="S5.SS1.p1.5.m5.1.1.2.2.cmml">𝒈</mi><msubsup id="S5.SS1.p1.5.m5.1.1.2.3" xref="S5.SS1.p1.5.m5.1.1.2.3.cmml"><mi id="S5.SS1.p1.5.m5.1.1.2.3.2.2" xref="S5.SS1.p1.5.m5.1.1.2.3.2.2.cmml">𝑾</mi><mi id="S5.SS1.p1.5.m5.1.1.2.3.3" xref="S5.SS1.p1.5.m5.1.1.2.3.3.cmml">k</mi><mrow id="S5.SS1.p1.5.m5.1.1.2.3.2.3" xref="S5.SS1.p1.5.m5.1.1.2.3.2.3.cmml"><mi id="S5.SS1.p1.5.m5.1.1.2.3.2.3.2" xref="S5.SS1.p1.5.m5.1.1.2.3.2.3.2.cmml">i</mi><mo id="S5.SS1.p1.5.m5.1.1.2.3.2.3.1" xref="S5.SS1.p1.5.m5.1.1.2.3.2.3.1.cmml">−</mo><mn id="S5.SS1.p1.5.m5.1.1.2.3.2.3.3" xref="S5.SS1.p1.5.m5.1.1.2.3.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S5.SS1.p1.5.m5.1.1.3" xref="S5.SS1.p1.5.m5.1.1.3.cmml"><mi id="S5.SS1.p1.5.m5.1.1.3.2" xref="S5.SS1.p1.5.m5.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.5.m5.1.1.3.1" xref="S5.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p1.5.m5.1.1.3.3" xref="S5.SS1.p1.5.m5.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.5.m5.1.1.3.1a" xref="S5.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p1.5.m5.1.1.3.4" xref="S5.SS1.p1.5.m5.1.1.3.4.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><apply id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.5.m5.1.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1">superscript</csymbol><apply id="S5.SS1.p1.5.m5.1.1.2.cmml" xref="S5.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.5.m5.1.1.2.1.cmml" xref="S5.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S5.SS1.p1.5.m5.1.1.2.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2.2">𝒈</ci><apply id="S5.SS1.p1.5.m5.1.1.2.3.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.5.m5.1.1.2.3.1.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3">subscript</csymbol><apply id="S5.SS1.p1.5.m5.1.1.2.3.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.5.m5.1.1.2.3.2.1.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3">superscript</csymbol><ci id="S5.SS1.p1.5.m5.1.1.2.3.2.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3.2.2">𝑾</ci><apply id="S5.SS1.p1.5.m5.1.1.2.3.2.3.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3.2.3"><minus id="S5.SS1.p1.5.m5.1.1.2.3.2.3.1.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3.2.3.1"></minus><ci id="S5.SS1.p1.5.m5.1.1.2.3.2.3.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S5.SS1.p1.5.m5.1.1.2.3.2.3.3.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S5.SS1.p1.5.m5.1.1.2.3.3.cmml" xref="S5.SS1.p1.5.m5.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S5.SS1.p1.5.m5.1.1.3.cmml" xref="S5.SS1.p1.5.m5.1.1.3"><times id="S5.SS1.p1.5.m5.1.1.3.1.cmml" xref="S5.SS1.p1.5.m5.1.1.3.1"></times><ci id="S5.SS1.p1.5.m5.1.1.3.2.cmml" xref="S5.SS1.p1.5.m5.1.1.3.2">𝑏</ci><ci id="S5.SS1.p1.5.m5.1.1.3.3.cmml" xref="S5.SS1.p1.5.m5.1.1.3.3">𝑎</ci><ci id="S5.SS1.p1.5.m5.1.1.3.4.cmml" xref="S5.SS1.p1.5.m5.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">\boldsymbol{g}_{\boldsymbol{W}^{i-1}_{k}}^{bal}</annotation></semantics></math> contains a part of global gradient prototypes calculated in the previous round and is a constant when updating <math id="S5.SS1.p1.6.m6.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="S5.SS1.p1.6.m6.1a"><mi id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><ci id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">\boldsymbol{W}</annotation></semantics></math>. It will adversely affect the model’s convergence in the late stage of the training when we are still using a large <math id="S5.SS1.p1.7.m7.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS1.p1.7.m7.1a"><mi id="S5.SS1.p1.7.m7.1.1" xref="S5.SS1.p1.7.m7.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m7.1b"><ci id="S5.SS1.p1.7.m7.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m7.1c">\lambda</annotation></semantics></math> to re-balance the classifier. An interesting direction to improve our method is designing an adaptive <math id="S5.SS1.p1.8.m8.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS1.p1.8.m8.1a"><mi id="S5.SS1.p1.8.m8.1.1" xref="S5.SS1.p1.8.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.8.m8.1b"><ci id="S5.SS1.p1.8.m8.1.1.cmml" xref="S5.SS1.p1.8.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.8.m8.1c">\lambda</annotation></semantics></math> that decays along with the training, which we leave to future work. When <math id="S5.SS1.p1.9.m9.1" class="ltx_Math" alttext="\lambda=0.0" display="inline"><semantics id="S5.SS1.p1.9.m9.1a"><mrow id="S5.SS1.p1.9.m9.1.1" xref="S5.SS1.p1.9.m9.1.1.cmml"><mi id="S5.SS1.p1.9.m9.1.1.2" xref="S5.SS1.p1.9.m9.1.1.2.cmml">λ</mi><mo id="S5.SS1.p1.9.m9.1.1.1" xref="S5.SS1.p1.9.m9.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.9.m9.1.1.3" xref="S5.SS1.p1.9.m9.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.9.m9.1b"><apply id="S5.SS1.p1.9.m9.1.1.cmml" xref="S5.SS1.p1.9.m9.1.1"><eq id="S5.SS1.p1.9.m9.1.1.1.cmml" xref="S5.SS1.p1.9.m9.1.1.1"></eq><ci id="S5.SS1.p1.9.m9.1.1.2.cmml" xref="S5.SS1.p1.9.m9.1.1.2">𝜆</ci><cn type="float" id="S5.SS1.p1.9.m9.1.1.3.cmml" xref="S5.SS1.p1.9.m9.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.9.m9.1c">\lambda=0.0</annotation></semantics></math>, the addition of two classifiers equals to one normal classifier used in FedAvg, so FedAvg is a special case of our method in this case.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Local Real Data Plays An Important Role in Re-Balancing The Classifier</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.7" class="ltx_p">During creating the local balanced datasets, we set a threshold <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">T</annotation></semantics></math> to decide whether the local clients own the enough data of a specific class. Larger <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">T</annotation></semantics></math> decreases the number of available classes in which the real data can be used to calculate the gradients for classifier re-balancing, while smaller <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">T</annotation></semantics></math> leads to the relatively unreliable gradients of class <math id="S5.SS2.p1.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S5.SS2.p1.4.m4.1a"><mi id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><ci id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">c</annotation></semantics></math>. We then explore the effect of different <math id="S5.SS2.p1.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS2.p1.5.m5.1a"><mi id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><ci id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">T</annotation></semantics></math>s, and put the results in Figure <a href="#S5.F4" title="Figure 4 ‣ 5.2 Local Real Data Plays An Important Role in Re-Balancing The Classifier ‣ 5 Further Explorations ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We indeed observe a trade-off pattern as expected and find that <math id="S5.SS2.p1.6.m6.2" class="ltx_Math" alttext="T=4,8" display="inline"><semantics id="S5.SS2.p1.6.m6.2a"><mrow id="S5.SS2.p1.6.m6.2.3" xref="S5.SS2.p1.6.m6.2.3.cmml"><mi id="S5.SS2.p1.6.m6.2.3.2" xref="S5.SS2.p1.6.m6.2.3.2.cmml">T</mi><mo id="S5.SS2.p1.6.m6.2.3.1" xref="S5.SS2.p1.6.m6.2.3.1.cmml">=</mo><mrow id="S5.SS2.p1.6.m6.2.3.3.2" xref="S5.SS2.p1.6.m6.2.3.3.1.cmml"><mn id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml">4</mn><mo id="S5.SS2.p1.6.m6.2.3.3.2.1" xref="S5.SS2.p1.6.m6.2.3.3.1.cmml">,</mo><mn id="S5.SS2.p1.6.m6.2.2" xref="S5.SS2.p1.6.m6.2.2.cmml">8</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.2b"><apply id="S5.SS2.p1.6.m6.2.3.cmml" xref="S5.SS2.p1.6.m6.2.3"><eq id="S5.SS2.p1.6.m6.2.3.1.cmml" xref="S5.SS2.p1.6.m6.2.3.1"></eq><ci id="S5.SS2.p1.6.m6.2.3.2.cmml" xref="S5.SS2.p1.6.m6.2.3.2">𝑇</ci><list id="S5.SS2.p1.6.m6.2.3.3.1.cmml" xref="S5.SS2.p1.6.m6.2.3.3.2"><cn type="integer" id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1">4</cn><cn type="integer" id="S5.SS2.p1.6.m6.2.2.cmml" xref="S5.SS2.p1.6.m6.2.2">8</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.2c">T=4,8</annotation></semantics></math> are the most proper choices. <math id="S5.SS2.p1.7.m7.1" class="ltx_Math" alttext="T=\infty" display="inline"><semantics id="S5.SS2.p1.7.m7.1a"><mrow id="S5.SS2.p1.7.m7.1.1" xref="S5.SS2.p1.7.m7.1.1.cmml"><mi id="S5.SS2.p1.7.m7.1.1.2" xref="S5.SS2.p1.7.m7.1.1.2.cmml">T</mi><mo id="S5.SS2.p1.7.m7.1.1.1" xref="S5.SS2.p1.7.m7.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S5.SS2.p1.7.m7.1.1.3" xref="S5.SS2.p1.7.m7.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m7.1b"><apply id="S5.SS2.p1.7.m7.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1"><eq id="S5.SS2.p1.7.m7.1.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1.1"></eq><ci id="S5.SS2.p1.7.m7.1.1.2.cmml" xref="S5.SS2.p1.7.m7.1.1.2">𝑇</ci><infinity id="S5.SS2.p1.7.m7.1.1.3.cmml" xref="S5.SS2.p1.7.m7.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m7.1c">T=\infty</annotation></semantics></math> means we remove the role of local real data on the classifier re-balancing and only use the global gradient prototypes instead, and we find the performance degrades greatly, which verifies the large benefits of using local real data to adjust the classifier.</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2301.10394/assets/x4.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="257" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The test accuracy of using different sample quantity thresholds for each class when creating the local balanced datasets in CIFAR-10-LT.</figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, motivated by the decoupled training idea, we propose a novel and effective classifier re-balancing algorithm for tackling federated long-tailed learning.
In order to overcome the lack of a public balanced dataset in FL, we propose to re-balance the classifier during local training by integrating local real data with global gradient prototypes. Furthermore, in order to address the problem of contradictory optimization goals during training brought by performing local classifier re-balancing, we introduce a two-stream classifiers architecture to help model the global data distribution. Thorough experiments verify the great effectiveness of our method over strong baselines without extra data requirements.
</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Ethical Statement</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Our purpose is to address the optimization problem of FL on the non-i.i.d. and long-tailed data and help to learn a better global model that has good performance on all classes. The datasets used in our experiments are all publicly available. Also, our method only requires the normal gradients transmission between the server and the clients, which will not expose the local data privacy and does not have any ethical concerns.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p">This work was supported by a Tencent Research Grant. Xu Sun is the corresponding author of this paper.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Acar <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas, Matthew Mattina, Paul Whatmough,
and Venkatesh Saligrama.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao <span id="bib.bib2.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Kaidi Cao, Colin Wei, Adrien Gaidon, Nikos Arechiga, and Tengyu Ma.

</span>
<span class="ltx_bibblock">Learning imbalanced datasets with label-distribution-aware margin
loss.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 32, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chawla <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2002]</span>
<span class="ltx_bibblock">
Nitesh V Chawla, Kevin W Bowyer, Lawrence O Hall, and W Philip Kegelmeyer.

</span>
<span class="ltx_bibblock">Smote: synthetic minority over-sampling technique.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">Journal of artificial intelligence research</span>, 16:321–357, 2002.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chou <span id="bib.bib4.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Hsin-Ping Chou, Shih-Chieh Chang, Jia-Yu Pan, Wei Wei, and Da-Cheng Juan.

</span>
<span class="ltx_bibblock">Remix: rebalanced mixup.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.3.1" class="ltx_text ltx_font_italic">European Conference on Computer Vision</span>, pages 95–110.
Springer, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chu <span id="bib.bib5.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Peng Chu, Xiao Bian, Shaopeng Liu, and Haibin Ling.

</span>
<span class="ltx_bibblock">Feature space augmentation for long-tailed data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">European Conference on Computer Vision</span>, pages 694–710.
Springer, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui <span id="bib.bib6.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Yin Cui, Menglin Jia, Tsung-Yi Lin, Yang Song, and Serge Belongie.

</span>
<span class="ltx_bibblock">Class-balanced loss based on effective number of samples.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span>, pages 9268–9277, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2016]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 770–778, 2016.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Chaoyang He, Songze Li, Jinhyun So, Xiao Zeng, Mi Zhang, Hongyi Wang, Xiaoyang
Wang, Praneeth Vepakomma, Abhishek Singh, Hang Qiu, et al.

</span>
<span class="ltx_bibblock">Fedml: A research library and benchmark for federated machine
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2007.13518</span>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu <span id="bib.bib9.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.06335</span>, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Bingyi Kang, Saining Xie, Marcus Rohrbach, Zhicheng Yan, Albert Gordo, Jiashi
Feng, and Yannis Kalantidis.

</span>
<span class="ltx_bibblock">Decoupling representation and classifier for long-tailed recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy <span id="bib.bib11.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.3.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba [2014]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1412.6980</span>, 2014.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2009]</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [1998]</span>
<span class="ltx_bibblock">
Yann LeCun, Léon Bottou, Yoshua Bengio, and Patrick Haffner.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, 86(11):2278–2324, 1998.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib15.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.06127</span>, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár.

</span>
<span class="ltx_bibblock">Focal loss for dense object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</span>, pages 2980–2988, 2017.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib17.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2008]</span>
<span class="ltx_bibblock">
Xu-Ying Liu, Jianxin Wu, and Zhi-Hua Zhou.

</span>
<span class="ltx_bibblock">Exploratory undersampling for class-imbalance learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Systems, Man, and Cybernetics, Part B
(Cybernetics)</span>, 39(2):539–550, 2008.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan <span id="bib.bib18.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.3.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Sashank J Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush,
Jakub Konečnỳ, Sanjiv Kumar, and Hugh Brendan McMahan.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarkar <span id="bib.bib20.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Dipankar Sarkar, Ankur Narang, and Sumit Rai.

</span>
<span class="ltx_bibblock">Fed-focal loss for imbalanced data classification in federated
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2011.06283</span>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang <span id="bib.bib21.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022a]</span>
<span class="ltx_bibblock">
Xinyi Shang, Yang Lu, Yiu-ming Cheung, and Hanzi Wang.

</span>
<span class="ltx_bibblock">Fedic: Federated learning on non-iid and long-tailed data via
calibrated distillation.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2205.00172</span>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang <span id="bib.bib22.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022b]</span>
<span class="ltx_bibblock">
Xinyi Shang, Yang Lu, Gang Huang, and Hanzi Wang.

</span>
<span class="ltx_bibblock">Federated learning on heterogeneous and long-tailed data via
classifier re-training with federated features.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2204.13399</span>, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen <span id="bib.bib23.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Zebang Shen, Juan Cervino, Hamed Hassani, and Alejandro Ribeiro.

</span>
<span class="ltx_bibblock">An agnostic approach to federated learning with class imbalance.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.3.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang <span id="bib.bib24.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Lixu Wang, Shichao Xu, Xiao Wang, and Qi Zhu.

</span>
<span class="ltx_bibblock">Addressing class imbalance in federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.3.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, volume 35, pages 10165–10173, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zang <span id="bib.bib25.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Yuhang Zang, Chen Huang, and Chen Change Loy.

</span>
<span class="ltx_bibblock">Fasa: Feature augmentation and sampling adaptation for long-tailed
instance segmentation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span>, pages 3457–3466, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang <span id="bib.bib26.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Yifan Zhang, Bingyi Kang, Bryan Hooi, Shuicheng Yan, and Jiashi Feng.

</span>
<span class="ltx_bibblock">Deep long-tailed learning: A survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2110.04596</span>, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou <span id="bib.bib27.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Boyan Zhou, Quan Cui, Xiu-Shen Wei, and Zhao-Min Chen.

</span>
<span class="ltx_bibblock">Bbn: Bilateral-branch network with cumulative learning for
long-tailed visual recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span>, pages 9719–9728, 2020.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Detailed Experimental Settings</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Datasets and Models</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.3" class="ltx_p">Here, we introduce the datasets and the backbone models we used in our experiments. We choose three classical image classification tasks, including MNIST <cite class="ltx_cite ltx_citemacro_cite">LeCun <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib14" title="" class="ltx_ref">1998</a>]</cite>, CIFAR-10 and CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">Krizhevsky <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib13" title="" class="ltx_ref">2009</a>]</cite>. We then follow existing centralized and federated long-tailed learning studies <cite class="ltx_cite ltx_citemacro_cite">Cao <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib2" title="" class="ltx_ref">2019</a>]; Shang <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>]</cite> to create the long-tailed versions of the training sets of above datasets (i.e., MNIST-LT, CIFAR-10/100-LT). Specifically, the long-tailed degree is controlled by a ratio called the <span id="A1.SS1.p1.3.1" class="ltx_text ltx_font_italic">Imbalance Ratio</span>: <math id="A1.SS1.p1.1.m1.4" class="ltx_Math" alttext="\text{IR=}\frac{\max_{c}\{n_{c}\}}{\min_{c}\{n_{c}\}}" display="inline"><semantics id="A1.SS1.p1.1.m1.4a"><mrow id="A1.SS1.p1.1.m1.4.5" xref="A1.SS1.p1.1.m1.4.5.cmml"><mtext id="A1.SS1.p1.1.m1.4.5.2" xref="A1.SS1.p1.1.m1.4.5.2a.cmml">IR=</mtext><mo lspace="0em" rspace="0em" id="A1.SS1.p1.1.m1.4.5.1" xref="A1.SS1.p1.1.m1.4.5.1.cmml">​</mo><mfrac id="A1.SS1.p1.1.m1.4.4" xref="A1.SS1.p1.1.m1.4.4.cmml"><mrow id="A1.SS1.p1.1.m1.2.2.2.2" xref="A1.SS1.p1.1.m1.2.2.2.3.cmml"><msub id="A1.SS1.p1.1.m1.1.1.1.1.1" xref="A1.SS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.1.1.1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.1.1.1.2.cmml">max</mi><mi id="A1.SS1.p1.1.m1.1.1.1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="A1.SS1.p1.1.m1.2.2.2.2a" xref="A1.SS1.p1.1.m1.2.2.2.3.cmml">⁡</mo><mrow id="A1.SS1.p1.1.m1.2.2.2.2.2" xref="A1.SS1.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS1.p1.1.m1.2.2.2.2.2.2" xref="A1.SS1.p1.1.m1.2.2.2.3.cmml">{</mo><msub id="A1.SS1.p1.1.m1.2.2.2.2.2.1" xref="A1.SS1.p1.1.m1.2.2.2.2.2.1.cmml"><mi id="A1.SS1.p1.1.m1.2.2.2.2.2.1.2" xref="A1.SS1.p1.1.m1.2.2.2.2.2.1.2.cmml">n</mi><mi id="A1.SS1.p1.1.m1.2.2.2.2.2.1.3" xref="A1.SS1.p1.1.m1.2.2.2.2.2.1.3.cmml">c</mi></msub><mo stretchy="false" id="A1.SS1.p1.1.m1.2.2.2.2.2.3" xref="A1.SS1.p1.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><mrow id="A1.SS1.p1.1.m1.4.4.4.2" xref="A1.SS1.p1.1.m1.4.4.4.3.cmml"><msub id="A1.SS1.p1.1.m1.3.3.3.1.1" xref="A1.SS1.p1.1.m1.3.3.3.1.1.cmml"><mi id="A1.SS1.p1.1.m1.3.3.3.1.1.2" xref="A1.SS1.p1.1.m1.3.3.3.1.1.2.cmml">min</mi><mi id="A1.SS1.p1.1.m1.3.3.3.1.1.3" xref="A1.SS1.p1.1.m1.3.3.3.1.1.3.cmml">c</mi></msub><mo id="A1.SS1.p1.1.m1.4.4.4.2a" xref="A1.SS1.p1.1.m1.4.4.4.3.cmml">⁡</mo><mrow id="A1.SS1.p1.1.m1.4.4.4.2.2" xref="A1.SS1.p1.1.m1.4.4.4.3.cmml"><mo stretchy="false" id="A1.SS1.p1.1.m1.4.4.4.2.2.2" xref="A1.SS1.p1.1.m1.4.4.4.3.cmml">{</mo><msub id="A1.SS1.p1.1.m1.4.4.4.2.2.1" xref="A1.SS1.p1.1.m1.4.4.4.2.2.1.cmml"><mi id="A1.SS1.p1.1.m1.4.4.4.2.2.1.2" xref="A1.SS1.p1.1.m1.4.4.4.2.2.1.2.cmml">n</mi><mi id="A1.SS1.p1.1.m1.4.4.4.2.2.1.3" xref="A1.SS1.p1.1.m1.4.4.4.2.2.1.3.cmml">c</mi></msub><mo stretchy="false" id="A1.SS1.p1.1.m1.4.4.4.2.2.3" xref="A1.SS1.p1.1.m1.4.4.4.3.cmml">}</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.4b"><apply id="A1.SS1.p1.1.m1.4.5.cmml" xref="A1.SS1.p1.1.m1.4.5"><times id="A1.SS1.p1.1.m1.4.5.1.cmml" xref="A1.SS1.p1.1.m1.4.5.1"></times><ci id="A1.SS1.p1.1.m1.4.5.2a.cmml" xref="A1.SS1.p1.1.m1.4.5.2"><mtext id="A1.SS1.p1.1.m1.4.5.2.cmml" xref="A1.SS1.p1.1.m1.4.5.2">IR=</mtext></ci><apply id="A1.SS1.p1.1.m1.4.4.cmml" xref="A1.SS1.p1.1.m1.4.4"><divide id="A1.SS1.p1.1.m1.4.4.5.cmml" xref="A1.SS1.p1.1.m1.4.4"></divide><apply id="A1.SS1.p1.1.m1.2.2.2.3.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2"><apply id="A1.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1.1.1.1">subscript</csymbol><max id="A1.SS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.1.1.1.2"></max><ci id="A1.SS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.1.1.1.3">𝑐</ci></apply><apply id="A1.SS1.p1.1.m1.2.2.2.2.2.1.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.2.2.2.2.2.1.1.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2.2.1">subscript</csymbol><ci id="A1.SS1.p1.1.m1.2.2.2.2.2.1.2.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2.2.1.2">𝑛</ci><ci id="A1.SS1.p1.1.m1.2.2.2.2.2.1.3.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2.2.1.3">𝑐</ci></apply></apply><apply id="A1.SS1.p1.1.m1.4.4.4.3.cmml" xref="A1.SS1.p1.1.m1.4.4.4.2"><apply id="A1.SS1.p1.1.m1.3.3.3.1.1.cmml" xref="A1.SS1.p1.1.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.3.3.3.1.1.1.cmml" xref="A1.SS1.p1.1.m1.3.3.3.1.1">subscript</csymbol><min id="A1.SS1.p1.1.m1.3.3.3.1.1.2.cmml" xref="A1.SS1.p1.1.m1.3.3.3.1.1.2"></min><ci id="A1.SS1.p1.1.m1.3.3.3.1.1.3.cmml" xref="A1.SS1.p1.1.m1.3.3.3.1.1.3">𝑐</ci></apply><apply id="A1.SS1.p1.1.m1.4.4.4.2.2.1.cmml" xref="A1.SS1.p1.1.m1.4.4.4.2.2.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.4.4.4.2.2.1.1.cmml" xref="A1.SS1.p1.1.m1.4.4.4.2.2.1">subscript</csymbol><ci id="A1.SS1.p1.1.m1.4.4.4.2.2.1.2.cmml" xref="A1.SS1.p1.1.m1.4.4.4.2.2.1.2">𝑛</ci><ci id="A1.SS1.p1.1.m1.4.4.4.2.2.1.3.cmml" xref="A1.SS1.p1.1.m1.4.4.4.2.2.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.4c">\text{IR=}\frac{\max_{c}\{n_{c}\}}{\min_{c}\{n_{c}\}}</annotation></semantics></math>, where <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><msub id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">n</mi><mi id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝑛</ci><ci id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">n_{c}</annotation></semantics></math> represents the sample quantity of class <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">c</annotation></semantics></math> (0-indexed). Then, we manage to make the sample quantity of each class follow an exponential decay trend:</p>
<table id="A1.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E16.m1.4" class="ltx_Math" alttext="n_{c}=n_{0}\times\left(\frac{1}{\text{IR}}\right)^{\frac{c}{C-1}},\quad c=0,\cdots,C-1." display="block"><semantics id="A1.E16.m1.4a"><mrow id="A1.E16.m1.4.4.1"><mrow id="A1.E16.m1.4.4.1.1.2" xref="A1.E16.m1.4.4.1.1.3.cmml"><mrow id="A1.E16.m1.4.4.1.1.1.1" xref="A1.E16.m1.4.4.1.1.1.1.cmml"><msub id="A1.E16.m1.4.4.1.1.1.1.2" xref="A1.E16.m1.4.4.1.1.1.1.2.cmml"><mi id="A1.E16.m1.4.4.1.1.1.1.2.2" xref="A1.E16.m1.4.4.1.1.1.1.2.2.cmml">n</mi><mi id="A1.E16.m1.4.4.1.1.1.1.2.3" xref="A1.E16.m1.4.4.1.1.1.1.2.3.cmml">c</mi></msub><mo id="A1.E16.m1.4.4.1.1.1.1.1" xref="A1.E16.m1.4.4.1.1.1.1.1.cmml">=</mo><mrow id="A1.E16.m1.4.4.1.1.1.1.3" xref="A1.E16.m1.4.4.1.1.1.1.3.cmml"><msub id="A1.E16.m1.4.4.1.1.1.1.3.2" xref="A1.E16.m1.4.4.1.1.1.1.3.2.cmml"><mi id="A1.E16.m1.4.4.1.1.1.1.3.2.2" xref="A1.E16.m1.4.4.1.1.1.1.3.2.2.cmml">n</mi><mn id="A1.E16.m1.4.4.1.1.1.1.3.2.3" xref="A1.E16.m1.4.4.1.1.1.1.3.2.3.cmml">0</mn></msub><mo lspace="0.222em" rspace="0.222em" id="A1.E16.m1.4.4.1.1.1.1.3.1" xref="A1.E16.m1.4.4.1.1.1.1.3.1.cmml">×</mo><msup id="A1.E16.m1.4.4.1.1.1.1.3.3" xref="A1.E16.m1.4.4.1.1.1.1.3.3.cmml"><mrow id="A1.E16.m1.4.4.1.1.1.1.3.3.2.2" xref="A1.E16.m1.1.1.cmml"><mo id="A1.E16.m1.4.4.1.1.1.1.3.3.2.2.1" xref="A1.E16.m1.1.1.cmml">(</mo><mfrac id="A1.E16.m1.1.1" xref="A1.E16.m1.1.1.cmml"><mn id="A1.E16.m1.1.1.2" xref="A1.E16.m1.1.1.2.cmml">1</mn><mtext id="A1.E16.m1.1.1.3" xref="A1.E16.m1.1.1.3a.cmml">IR</mtext></mfrac><mo id="A1.E16.m1.4.4.1.1.1.1.3.3.2.2.2" xref="A1.E16.m1.1.1.cmml">)</mo></mrow><mfrac id="A1.E16.m1.4.4.1.1.1.1.3.3.3" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.cmml"><mi id="A1.E16.m1.4.4.1.1.1.1.3.3.3.2" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.2.cmml">c</mi><mrow id="A1.E16.m1.4.4.1.1.1.1.3.3.3.3" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.cmml"><mi id="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.2" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.2.cmml">C</mi><mo id="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.1" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.1.cmml">−</mo><mn id="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.3" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.3.cmml">1</mn></mrow></mfrac></msup></mrow></mrow><mo rspace="1.167em" id="A1.E16.m1.4.4.1.1.2.3" xref="A1.E16.m1.4.4.1.1.3a.cmml">,</mo><mrow id="A1.E16.m1.4.4.1.1.2.2" xref="A1.E16.m1.4.4.1.1.2.2.cmml"><mi id="A1.E16.m1.4.4.1.1.2.2.3" xref="A1.E16.m1.4.4.1.1.2.2.3.cmml">c</mi><mo id="A1.E16.m1.4.4.1.1.2.2.2" xref="A1.E16.m1.4.4.1.1.2.2.2.cmml">=</mo><mrow id="A1.E16.m1.4.4.1.1.2.2.1.1" xref="A1.E16.m1.4.4.1.1.2.2.1.2.cmml"><mn id="A1.E16.m1.2.2" xref="A1.E16.m1.2.2.cmml">0</mn><mo id="A1.E16.m1.4.4.1.1.2.2.1.1.2" xref="A1.E16.m1.4.4.1.1.2.2.1.2.cmml">,</mo><mi mathvariant="normal" id="A1.E16.m1.3.3" xref="A1.E16.m1.3.3.cmml">⋯</mi><mo id="A1.E16.m1.4.4.1.1.2.2.1.1.3" xref="A1.E16.m1.4.4.1.1.2.2.1.2.cmml">,</mo><mrow id="A1.E16.m1.4.4.1.1.2.2.1.1.1" xref="A1.E16.m1.4.4.1.1.2.2.1.1.1.cmml"><mi id="A1.E16.m1.4.4.1.1.2.2.1.1.1.2" xref="A1.E16.m1.4.4.1.1.2.2.1.1.1.2.cmml">C</mi><mo id="A1.E16.m1.4.4.1.1.2.2.1.1.1.1" xref="A1.E16.m1.4.4.1.1.2.2.1.1.1.1.cmml">−</mo><mn id="A1.E16.m1.4.4.1.1.2.2.1.1.1.3" xref="A1.E16.m1.4.4.1.1.2.2.1.1.1.3.cmml">1</mn></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E16.m1.4.4.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.4b"><apply id="A1.E16.m1.4.4.1.1.3.cmml" xref="A1.E16.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.4.4.1.1.3a.cmml" xref="A1.E16.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E16.m1.4.4.1.1.1.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1"><eq id="A1.E16.m1.4.4.1.1.1.1.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.1"></eq><apply id="A1.E16.m1.4.4.1.1.1.1.2.cmml" xref="A1.E16.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E16.m1.4.4.1.1.1.1.2.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="A1.E16.m1.4.4.1.1.1.1.2.2.cmml" xref="A1.E16.m1.4.4.1.1.1.1.2.2">𝑛</ci><ci id="A1.E16.m1.4.4.1.1.1.1.2.3.cmml" xref="A1.E16.m1.4.4.1.1.1.1.2.3">𝑐</ci></apply><apply id="A1.E16.m1.4.4.1.1.1.1.3.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3"><times id="A1.E16.m1.4.4.1.1.1.1.3.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.1"></times><apply id="A1.E16.m1.4.4.1.1.1.1.3.2.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E16.m1.4.4.1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E16.m1.4.4.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.2.2">𝑛</ci><cn type="integer" id="A1.E16.m1.4.4.1.1.1.1.3.2.3.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.2.3">0</cn></apply><apply id="A1.E16.m1.4.4.1.1.1.1.3.3.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E16.m1.4.4.1.1.1.1.3.3.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3">superscript</csymbol><apply id="A1.E16.m1.1.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.2.2"><divide id="A1.E16.m1.1.1.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.2.2"></divide><cn type="integer" id="A1.E16.m1.1.1.2.cmml" xref="A1.E16.m1.1.1.2">1</cn><ci id="A1.E16.m1.1.1.3a.cmml" xref="A1.E16.m1.1.1.3"><mtext id="A1.E16.m1.1.1.3.cmml" xref="A1.E16.m1.1.1.3">IR</mtext></ci></apply><apply id="A1.E16.m1.4.4.1.1.1.1.3.3.3.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3"><divide id="A1.E16.m1.4.4.1.1.1.1.3.3.3.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3"></divide><ci id="A1.E16.m1.4.4.1.1.1.1.3.3.3.2.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.2">𝑐</ci><apply id="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.3"><minus id="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.1"></minus><ci id="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.2.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.2">𝐶</ci><cn type="integer" id="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.3.cmml" xref="A1.E16.m1.4.4.1.1.1.1.3.3.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="A1.E16.m1.4.4.1.1.2.2.cmml" xref="A1.E16.m1.4.4.1.1.2.2"><eq id="A1.E16.m1.4.4.1.1.2.2.2.cmml" xref="A1.E16.m1.4.4.1.1.2.2.2"></eq><ci id="A1.E16.m1.4.4.1.1.2.2.3.cmml" xref="A1.E16.m1.4.4.1.1.2.2.3">𝑐</ci><list id="A1.E16.m1.4.4.1.1.2.2.1.2.cmml" xref="A1.E16.m1.4.4.1.1.2.2.1.1"><cn type="integer" id="A1.E16.m1.2.2.cmml" xref="A1.E16.m1.2.2">0</cn><ci id="A1.E16.m1.3.3.cmml" xref="A1.E16.m1.3.3">⋯</ci><apply id="A1.E16.m1.4.4.1.1.2.2.1.1.1.cmml" xref="A1.E16.m1.4.4.1.1.2.2.1.1.1"><minus id="A1.E16.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="A1.E16.m1.4.4.1.1.2.2.1.1.1.1"></minus><ci id="A1.E16.m1.4.4.1.1.2.2.1.1.1.2.cmml" xref="A1.E16.m1.4.4.1.1.2.2.1.1.1.2">𝐶</ci><cn type="integer" id="A1.E16.m1.4.4.1.1.2.2.1.1.1.3.cmml" xref="A1.E16.m1.4.4.1.1.2.2.1.1.1.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.4c">n_{c}=n_{0}\times\left(\frac{1}{\text{IR}}\right)^{\frac{c}{C-1}},\quad c=0,\cdots,C-1.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="A1.SS1.p1.7" class="ltx_p">As for the non-i.i.d. data partitioning, we follow existing studies <cite class="ltx_cite ltx_citemacro_cite">Reddi <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib19" title="" class="ltx_ref">2020</a>]; Shang <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>]</cite> to adopt the Dirichlet distribution <math id="A1.SS1.p1.4.m1.1" class="ltx_Math" alttext="\text{Dir}(\alpha)" display="inline"><semantics id="A1.SS1.p1.4.m1.1a"><mrow id="A1.SS1.p1.4.m1.1.2" xref="A1.SS1.p1.4.m1.1.2.cmml"><mtext id="A1.SS1.p1.4.m1.1.2.2" xref="A1.SS1.p1.4.m1.1.2.2a.cmml">Dir</mtext><mo lspace="0em" rspace="0em" id="A1.SS1.p1.4.m1.1.2.1" xref="A1.SS1.p1.4.m1.1.2.1.cmml">​</mo><mrow id="A1.SS1.p1.4.m1.1.2.3.2" xref="A1.SS1.p1.4.m1.1.2.cmml"><mo stretchy="false" id="A1.SS1.p1.4.m1.1.2.3.2.1" xref="A1.SS1.p1.4.m1.1.2.cmml">(</mo><mi id="A1.SS1.p1.4.m1.1.1" xref="A1.SS1.p1.4.m1.1.1.cmml">α</mi><mo stretchy="false" id="A1.SS1.p1.4.m1.1.2.3.2.2" xref="A1.SS1.p1.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m1.1b"><apply id="A1.SS1.p1.4.m1.1.2.cmml" xref="A1.SS1.p1.4.m1.1.2"><times id="A1.SS1.p1.4.m1.1.2.1.cmml" xref="A1.SS1.p1.4.m1.1.2.1"></times><ci id="A1.SS1.p1.4.m1.1.2.2a.cmml" xref="A1.SS1.p1.4.m1.1.2.2"><mtext id="A1.SS1.p1.4.m1.1.2.2.cmml" xref="A1.SS1.p1.4.m1.1.2.2">Dir</mtext></ci><ci id="A1.SS1.p1.4.m1.1.1.cmml" xref="A1.SS1.p1.4.m1.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m1.1c">\text{Dir}(\alpha)</annotation></semantics></math>. Smaller <math id="A1.SS1.p1.5.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.SS1.p1.5.m2.1a"><mi id="A1.SS1.p1.5.m2.1.1" xref="A1.SS1.p1.5.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m2.1b"><ci id="A1.SS1.p1.5.m2.1.1.cmml" xref="A1.SS1.p1.5.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m2.1c">\alpha</annotation></semantics></math> means the heavier non-i.i.d. degree. We choose <math id="A1.SS1.p1.6.m3.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A1.SS1.p1.6.m3.1a"><mrow id="A1.SS1.p1.6.m3.1.1" xref="A1.SS1.p1.6.m3.1.1.cmml"><mi id="A1.SS1.p1.6.m3.1.1.2" xref="A1.SS1.p1.6.m3.1.1.2.cmml">α</mi><mo id="A1.SS1.p1.6.m3.1.1.1" xref="A1.SS1.p1.6.m3.1.1.1.cmml">=</mo><mn id="A1.SS1.p1.6.m3.1.1.3" xref="A1.SS1.p1.6.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m3.1b"><apply id="A1.SS1.p1.6.m3.1.1.cmml" xref="A1.SS1.p1.6.m3.1.1"><eq id="A1.SS1.p1.6.m3.1.1.1.cmml" xref="A1.SS1.p1.6.m3.1.1.1"></eq><ci id="A1.SS1.p1.6.m3.1.1.2.cmml" xref="A1.SS1.p1.6.m3.1.1.2">𝛼</ci><cn type="float" id="A1.SS1.p1.6.m3.1.1.3.cmml" xref="A1.SS1.p1.6.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m3.1c">\alpha=1.0</annotation></semantics></math> in our main paper, and we also put the results on different <math id="A1.SS1.p1.7.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.SS1.p1.7.m4.1a"><mi id="A1.SS1.p1.7.m4.1.1" xref="A1.SS1.p1.7.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m4.1b"><ci id="A1.SS1.p1.7.m4.1.1.cmml" xref="A1.SS1.p1.7.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m4.1c">\alpha</annotation></semantics></math>s in Appendix <a href="#A3" title="Appendix C Experiments on Different Non-I.I.D. Degrees ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<div id="A1.SS1.p2" class="ltx_para">
<p id="A1.SS1.p2.1" class="ltx_p">We use the same convolutional neural network (CNN) used in <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib18" title="" class="ltx_ref">2017</a>]</cite> for experiments on MNIST-LT, and adopt the ResNet-56 <cite class="ltx_cite ltx_citemacro_cite">He <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib7" title="" class="ltx_ref">2016</a>]</cite> as the backbone model for CIFAR-10/100-LT.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Complete Training Details</h3>

<section id="A1.SS2.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Local Training Settings</h4>

<div id="A1.SS2.SSSx1.p1" class="ltx_para">
<p id="A1.SS2.SSSx1.p1.2" class="ltx_p">We utilize SGDM as the local optimizer in all experiments. The local learning rate is <math id="A1.SS2.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.SS2.SSSx1.p1.1.m1.1a"><mn id="A1.SS2.SSSx1.p1.1.m1.1.1" xref="A1.SS2.SSSx1.p1.1.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx1.p1.1.m1.1b"><cn type="float" id="A1.SS2.SSSx1.p1.1.m1.1.1.cmml" xref="A1.SS2.SSSx1.p1.1.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx1.p1.1.m1.1c">0.01</annotation></semantics></math> for MNIST-LT, and <math id="A1.SS2.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A1.SS2.SSSx1.p1.2.m2.1a"><mn id="A1.SS2.SSSx1.p1.2.m2.1.1" xref="A1.SS2.SSSx1.p1.2.m2.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx1.p1.2.m2.1b"><cn type="float" id="A1.SS2.SSSx1.p1.2.m2.1.1.cmml" xref="A1.SS2.SSSx1.p1.2.m2.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx1.p1.2.m2.1c">0.1</annotation></semantics></math> for CIFAR-10/100-LT. For all three datasets, the batch size for local training is 64, and the number of local training epochs is 5. As mentioned in main paper, we perform experiments in both full client participation and partial client participation settings. We set different total communication rounds in different setting considering the different convergence speeds of the global models: (1) In the full client participation setting, the number of communication rounds is 200 for MNIST-LT, and 500 for CIFAR-10/100-LT. (2) In the full client participation setting, the number of communication rounds is 500 and 1000 for MNIST-LT and CIFAR-10/100-LT separately.</p>
</div>
</section>
<section id="A1.SS2.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Server Aggregation Settings</h4>

<div id="A1.SS2.SSSx2.p1" class="ltx_para">
<p id="A1.SS2.SSSx2.p1.1" class="ltx_p">During server aggregation, we follow the same procedure as that in FedAvg to aggregate the collected local gradients in the current round, and update the global model with the averaged gradients. The server learning rate is tuned as <math id="A1.SS2.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="A1.SS2.SSSx2.p1.1.m1.1a"><mn id="A1.SS2.SSSx2.p1.1.m1.1.1" xref="A1.SS2.SSSx2.p1.1.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx2.p1.1.m1.1b"><cn type="float" id="A1.SS2.SSSx2.p1.1.m1.1.1.cmml" xref="A1.SS2.SSSx2.p1.1.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx2.p1.1.m1.1c">1.0</annotation></semantics></math> for all experiments. Furthermore, as for CReFF and our method, the server needs to update the global gradient prototypes (refer to Section 3.3 in our main paper) by averaging local gradient prototypes. However, compared with CReFF, we do not have extra requirements on the server to make it perform further optimization and training process.</p>
</div>
</section>
<section id="A1.SS2.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Hyper-Parameters of Each Method</h4>

<div id="A1.SS2.SSSx3.p1" class="ltx_para">
<p id="A1.SS2.SSSx3.p1.1" class="ltx_p">Here, we introduce the choices of hyper-parameters used in each method in detail.</p>
</div>
<section id="A1.SS2.SSSx3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Fed-Focal Loss:</h5>

<div id="A1.SS2.SSSx3.Px1.p1" class="ltx_para">
<p id="A1.SS2.SSSx3.Px1.p1.3" class="ltx_p">Fed-Focal Loss <cite class="ltx_cite ltx_citemacro_cite">Sarkar <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib20" title="" class="ltx_ref">2020</a>]</cite> directly applies Focal Loss <cite class="ltx_cite ltx_citemacro_cite">Lin <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib16" title="" class="ltx_ref">2017</a>]</cite> to the local training. The form of Focal Loss is</p>
<table id="A1.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E17.m1.2" class="ltx_Math" alttext="L_{focal}=-(1-p_{T})^{\gamma}\log(p_{T})," display="block"><semantics id="A1.E17.m1.2a"><mrow id="A1.E17.m1.2.2.1" xref="A1.E17.m1.2.2.1.1.cmml"><mrow id="A1.E17.m1.2.2.1.1" xref="A1.E17.m1.2.2.1.1.cmml"><msub id="A1.E17.m1.2.2.1.1.4" xref="A1.E17.m1.2.2.1.1.4.cmml"><mi id="A1.E17.m1.2.2.1.1.4.2" xref="A1.E17.m1.2.2.1.1.4.2.cmml">L</mi><mrow id="A1.E17.m1.2.2.1.1.4.3" xref="A1.E17.m1.2.2.1.1.4.3.cmml"><mi id="A1.E17.m1.2.2.1.1.4.3.2" xref="A1.E17.m1.2.2.1.1.4.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="A1.E17.m1.2.2.1.1.4.3.1" xref="A1.E17.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="A1.E17.m1.2.2.1.1.4.3.3" xref="A1.E17.m1.2.2.1.1.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A1.E17.m1.2.2.1.1.4.3.1a" xref="A1.E17.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="A1.E17.m1.2.2.1.1.4.3.4" xref="A1.E17.m1.2.2.1.1.4.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="A1.E17.m1.2.2.1.1.4.3.1b" xref="A1.E17.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="A1.E17.m1.2.2.1.1.4.3.5" xref="A1.E17.m1.2.2.1.1.4.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.E17.m1.2.2.1.1.4.3.1c" xref="A1.E17.m1.2.2.1.1.4.3.1.cmml">​</mo><mi id="A1.E17.m1.2.2.1.1.4.3.6" xref="A1.E17.m1.2.2.1.1.4.3.6.cmml">l</mi></mrow></msub><mo id="A1.E17.m1.2.2.1.1.3" xref="A1.E17.m1.2.2.1.1.3.cmml">=</mo><mrow id="A1.E17.m1.2.2.1.1.2" xref="A1.E17.m1.2.2.1.1.2.cmml"><mo id="A1.E17.m1.2.2.1.1.2a" xref="A1.E17.m1.2.2.1.1.2.cmml">−</mo><mrow id="A1.E17.m1.2.2.1.1.2.2" xref="A1.E17.m1.2.2.1.1.2.2.cmml"><msup id="A1.E17.m1.2.2.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.1.cmml"><mrow id="A1.E17.m1.2.2.1.1.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E17.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mn id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">T</mi></msub></mrow><mo stretchy="false" id="A1.E17.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E17.m1.2.2.1.1.1.1.1.3" xref="A1.E17.m1.2.2.1.1.1.1.1.3.cmml">γ</mi></msup><mo lspace="0.167em" rspace="0em" id="A1.E17.m1.2.2.1.1.2.2.3" xref="A1.E17.m1.2.2.1.1.2.2.3.cmml">​</mo><mrow id="A1.E17.m1.2.2.1.1.2.2.2.1" xref="A1.E17.m1.2.2.1.1.2.2.2.2.cmml"><mi id="A1.E17.m1.1.1" xref="A1.E17.m1.1.1.cmml">log</mi><mo id="A1.E17.m1.2.2.1.1.2.2.2.1a" xref="A1.E17.m1.2.2.1.1.2.2.2.2.cmml">⁡</mo><mrow id="A1.E17.m1.2.2.1.1.2.2.2.1.1" xref="A1.E17.m1.2.2.1.1.2.2.2.2.cmml"><mo stretchy="false" id="A1.E17.m1.2.2.1.1.2.2.2.1.1.2" xref="A1.E17.m1.2.2.1.1.2.2.2.2.cmml">(</mo><msub id="A1.E17.m1.2.2.1.1.2.2.2.1.1.1" xref="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.cmml"><mi id="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.2" xref="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.2.cmml">p</mi><mi id="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.3" xref="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.3.cmml">T</mi></msub><mo stretchy="false" id="A1.E17.m1.2.2.1.1.2.2.2.1.1.3" xref="A1.E17.m1.2.2.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="A1.E17.m1.2.2.1.2" xref="A1.E17.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.2b"><apply id="A1.E17.m1.2.2.1.1.cmml" xref="A1.E17.m1.2.2.1"><eq id="A1.E17.m1.2.2.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.3"></eq><apply id="A1.E17.m1.2.2.1.1.4.cmml" xref="A1.E17.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.4.1.cmml" xref="A1.E17.m1.2.2.1.1.4">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.4.2.cmml" xref="A1.E17.m1.2.2.1.1.4.2">𝐿</ci><apply id="A1.E17.m1.2.2.1.1.4.3.cmml" xref="A1.E17.m1.2.2.1.1.4.3"><times id="A1.E17.m1.2.2.1.1.4.3.1.cmml" xref="A1.E17.m1.2.2.1.1.4.3.1"></times><ci id="A1.E17.m1.2.2.1.1.4.3.2.cmml" xref="A1.E17.m1.2.2.1.1.4.3.2">𝑓</ci><ci id="A1.E17.m1.2.2.1.1.4.3.3.cmml" xref="A1.E17.m1.2.2.1.1.4.3.3">𝑜</ci><ci id="A1.E17.m1.2.2.1.1.4.3.4.cmml" xref="A1.E17.m1.2.2.1.1.4.3.4">𝑐</ci><ci id="A1.E17.m1.2.2.1.1.4.3.5.cmml" xref="A1.E17.m1.2.2.1.1.4.3.5">𝑎</ci><ci id="A1.E17.m1.2.2.1.1.4.3.6.cmml" xref="A1.E17.m1.2.2.1.1.4.3.6">𝑙</ci></apply></apply><apply id="A1.E17.m1.2.2.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2"><minus id="A1.E17.m1.2.2.1.1.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2"></minus><apply id="A1.E17.m1.2.2.1.1.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.2"><times id="A1.E17.m1.2.2.1.1.2.2.3.cmml" xref="A1.E17.m1.2.2.1.1.2.2.3"></times><apply id="A1.E17.m1.2.2.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1"><minus id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.2">1</cn><apply id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply><ci id="A1.E17.m1.2.2.1.1.1.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.1.1.1.3">𝛾</ci></apply><apply id="A1.E17.m1.2.2.1.1.2.2.2.2.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.1"><log id="A1.E17.m1.1.1.cmml" xref="A1.E17.m1.1.1"></log><apply id="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.2">𝑝</ci><ci id="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.3.cmml" xref="A1.E17.m1.2.2.1.1.2.2.2.1.1.1.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.2c">L_{focal}=-(1-p_{T})^{\gamma}\log(p_{T}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.SSSx3.Px1.p1.2" class="ltx_p">where <math id="A1.SS2.SSSx3.Px1.p1.1.m1.1" class="ltx_Math" alttext="p_{T}" display="inline"><semantics id="A1.SS2.SSSx3.Px1.p1.1.m1.1a"><msub id="A1.SS2.SSSx3.Px1.p1.1.m1.1.1" xref="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.cmml"><mi id="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.2" xref="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.2.cmml">p</mi><mi id="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.3" xref="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px1.p1.1.m1.1b"><apply id="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.cmml" xref="A1.SS2.SSSx3.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSSx3.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.2.cmml" xref="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.2">𝑝</ci><ci id="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.3.cmml" xref="A1.SS2.SSSx3.Px1.p1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px1.p1.1.m1.1c">p_{T}</annotation></semantics></math> is the predicted probability of the sample corresponding to the ground truth class. We set <math id="A1.SS2.SSSx3.Px1.p1.2.m2.1" class="ltx_Math" alttext="\gamma=2" display="inline"><semantics id="A1.SS2.SSSx3.Px1.p1.2.m2.1a"><mrow id="A1.SS2.SSSx3.Px1.p1.2.m2.1.1" xref="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.cmml"><mi id="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.2" xref="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.2.cmml">γ</mi><mo id="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.1" xref="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.3" xref="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px1.p1.2.m2.1b"><apply id="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.cmml" xref="A1.SS2.SSSx3.Px1.p1.2.m2.1.1"><eq id="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.1.cmml" xref="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.1"></eq><ci id="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.2.cmml" xref="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.2">𝛾</ci><cn type="integer" id="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.3.cmml" xref="A1.SS2.SSSx3.Px1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px1.p1.2.m2.1c">\gamma=2</annotation></semantics></math> in our experiments.</p>
</div>
</section>
<section id="A1.SS2.SSSx3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Ratio Loss:</h5>

<div id="A1.SS2.SSSx3.Px2.p1" class="ltx_para">
<p id="A1.SS2.SSSx3.Px2.p1.7" class="ltx_p">Ratio Loss <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib24" title="" class="ltx_ref">2021</a>]</cite> applies the class-level re-weighting practice by first estimating the global imbalance pattern on the server with an auxiliary balanced dataset. Its form can be written as</p>
<table id="A1.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E18.m1.1" class="ltx_Math" alttext="L_{ratio}=(\alpha+\beta\mathbb{R})L_{CE}," display="block"><semantics id="A1.E18.m1.1a"><mrow id="A1.E18.m1.1.1.1" xref="A1.E18.m1.1.1.1.1.cmml"><mrow id="A1.E18.m1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.cmml"><msub id="A1.E18.m1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.3.cmml"><mi id="A1.E18.m1.1.1.1.1.3.2" xref="A1.E18.m1.1.1.1.1.3.2.cmml">L</mi><mrow id="A1.E18.m1.1.1.1.1.3.3" xref="A1.E18.m1.1.1.1.1.3.3.cmml"><mi id="A1.E18.m1.1.1.1.1.3.3.2" xref="A1.E18.m1.1.1.1.1.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.E18.m1.1.1.1.1.3.3.1" xref="A1.E18.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A1.E18.m1.1.1.1.1.3.3.3" xref="A1.E18.m1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.E18.m1.1.1.1.1.3.3.1a" xref="A1.E18.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A1.E18.m1.1.1.1.1.3.3.4" xref="A1.E18.m1.1.1.1.1.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="A1.E18.m1.1.1.1.1.3.3.1b" xref="A1.E18.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A1.E18.m1.1.1.1.1.3.3.5" xref="A1.E18.m1.1.1.1.1.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="A1.E18.m1.1.1.1.1.3.3.1c" xref="A1.E18.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A1.E18.m1.1.1.1.1.3.3.6" xref="A1.E18.m1.1.1.1.1.3.3.6.cmml">o</mi></mrow></msub><mo id="A1.E18.m1.1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.E18.m1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.cmml"><mrow id="A1.E18.m1.1.1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E18.m1.1.1.1.1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.1.1.1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E18.m1.1.1.1.1.1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.1.1.1.1.2.cmml">α</mi><mo id="A1.E18.m1.1.1.1.1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E18.m1.1.1.1.1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E18.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E18.m1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="A1.E18.m1.1.1.1.1.1.1.1.1.3.1" xref="A1.E18.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A1.E18.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E18.m1.1.1.1.1.1.1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><mo stretchy="false" id="A1.E18.m1.1.1.1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.E18.m1.1.1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.1.2.cmml">​</mo><msub id="A1.E18.m1.1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.1.3.cmml"><mi id="A1.E18.m1.1.1.1.1.1.3.2" xref="A1.E18.m1.1.1.1.1.1.3.2.cmml">L</mi><mrow id="A1.E18.m1.1.1.1.1.1.3.3" xref="A1.E18.m1.1.1.1.1.1.3.3.cmml"><mi id="A1.E18.m1.1.1.1.1.1.3.3.2" xref="A1.E18.m1.1.1.1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="A1.E18.m1.1.1.1.1.1.3.3.1" xref="A1.E18.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A1.E18.m1.1.1.1.1.1.3.3.3" xref="A1.E18.m1.1.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub></mrow></mrow><mo id="A1.E18.m1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.1b"><apply id="A1.E18.m1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1"><eq id="A1.E18.m1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.2"></eq><apply id="A1.E18.m1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.2">𝐿</ci><apply id="A1.E18.m1.1.1.1.1.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.3"><times id="A1.E18.m1.1.1.1.1.3.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.3.1"></times><ci id="A1.E18.m1.1.1.1.1.3.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.3.2">𝑟</ci><ci id="A1.E18.m1.1.1.1.1.3.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3">𝑎</ci><ci id="A1.E18.m1.1.1.1.1.3.3.4.cmml" xref="A1.E18.m1.1.1.1.1.3.3.4">𝑡</ci><ci id="A1.E18.m1.1.1.1.1.3.3.5.cmml" xref="A1.E18.m1.1.1.1.1.3.3.5">𝑖</ci><ci id="A1.E18.m1.1.1.1.1.3.3.6.cmml" xref="A1.E18.m1.1.1.1.1.3.3.6">𝑜</ci></apply></apply><apply id="A1.E18.m1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1"><times id="A1.E18.m1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.2"></times><apply id="A1.E18.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1"><plus id="A1.E18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="A1.E18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.1.2">𝛼</ci><apply id="A1.E18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.1.3"><times id="A1.E18.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="A1.E18.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><ci id="A1.E18.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E18.m1.1.1.1.1.1.1.1.1.3.3">ℝ</ci></apply></apply><apply id="A1.E18.m1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.1.3.2.cmml" xref="A1.E18.m1.1.1.1.1.1.3.2">𝐿</ci><apply id="A1.E18.m1.1.1.1.1.1.3.3.cmml" xref="A1.E18.m1.1.1.1.1.1.3.3"><times id="A1.E18.m1.1.1.1.1.1.3.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.3.3.1"></times><ci id="A1.E18.m1.1.1.1.1.1.3.3.2.cmml" xref="A1.E18.m1.1.1.1.1.1.3.3.2">𝐶</ci><ci id="A1.E18.m1.1.1.1.1.1.3.3.3.cmml" xref="A1.E18.m1.1.1.1.1.1.3.3.3">𝐸</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.1c">L_{ratio}=(\alpha+\beta\mathbb{R})L_{CE},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="A1.SS2.SSSx3.Px2.p1.6" class="ltx_p">where <math id="A1.SS2.SSSx3.Px2.p1.1.m1.1" class="ltx_Math" alttext="L_{CE}" display="inline"><semantics id="A1.SS2.SSSx3.Px2.p1.1.m1.1a"><msub id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.2" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.2.cmml">L</mi><mrow id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.cmml"><mi id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.2" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.1" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.3" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px2.p1.1.m1.1b"><apply id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.2">𝐿</ci><apply id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3"><times id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.1"></times><ci id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.2.cmml" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.2">𝐶</ci><ci id="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.3.cmml" xref="A1.SS2.SSSx3.Px2.p1.1.m1.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px2.p1.1.m1.1c">L_{CE}</annotation></semantics></math> is the traditional CrossEntropy Loss, <math id="A1.SS2.SSSx3.Px2.p1.2.m2.1" class="ltx_Math" alttext="\mathbb{R}" display="inline"><semantics id="A1.SS2.SSSx3.Px2.p1.2.m2.1a"><mi id="A1.SS2.SSSx3.Px2.p1.2.m2.1.1" xref="A1.SS2.SSSx3.Px2.p1.2.m2.1.1.cmml">ℝ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px2.p1.2.m2.1b"><ci id="A1.SS2.SSSx3.Px2.p1.2.m2.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.2.m2.1.1">ℝ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px2.p1.2.m2.1c">\mathbb{R}</annotation></semantics></math> is the ratio vector that contains the relatively estimated sample quantity of each class on the server, <math id="A1.SS2.SSSx3.Px2.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.SS2.SSSx3.Px2.p1.3.m3.1a"><mi id="A1.SS2.SSSx3.Px2.p1.3.m3.1.1" xref="A1.SS2.SSSx3.Px2.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px2.p1.3.m3.1b"><ci id="A1.SS2.SSSx3.Px2.p1.3.m3.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px2.p1.3.m3.1c">\alpha</annotation></semantics></math> and <math id="A1.SS2.SSSx3.Px2.p1.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.SS2.SSSx3.Px2.p1.4.m4.1a"><mi id="A1.SS2.SSSx3.Px2.p1.4.m4.1.1" xref="A1.SS2.SSSx3.Px2.p1.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px2.p1.4.m4.1b"><ci id="A1.SS2.SSSx3.Px2.p1.4.m4.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px2.p1.4.m4.1c">\beta</annotation></semantics></math> are two hyper-parameters. Thus, we follow the original study <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib24" title="" class="ltx_ref">2021</a>]</cite> to set the sample number of each class on the auxiliary balanced dataset to be 32, <math id="A1.SS2.SSSx3.Px2.p1.5.m5.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A1.SS2.SSSx3.Px2.p1.5.m5.1a"><mrow id="A1.SS2.SSSx3.Px2.p1.5.m5.1.1" xref="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.cmml"><mi id="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.2" xref="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.2.cmml">α</mi><mo id="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.1" xref="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.3" xref="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px2.p1.5.m5.1b"><apply id="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.5.m5.1.1"><eq id="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.1"></eq><ci id="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.2.cmml" xref="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.2">𝛼</ci><cn type="float" id="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.3.cmml" xref="A1.SS2.SSSx3.Px2.p1.5.m5.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px2.p1.5.m5.1c">\alpha=1.0</annotation></semantics></math>, <math id="A1.SS2.SSSx3.Px2.p1.6.m6.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="A1.SS2.SSSx3.Px2.p1.6.m6.1a"><mrow id="A1.SS2.SSSx3.Px2.p1.6.m6.1.1" xref="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.cmml"><mi id="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.2" xref="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.2.cmml">β</mi><mo id="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.1" xref="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.1.cmml">=</mo><mn id="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.3" xref="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px2.p1.6.m6.1b"><apply id="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.6.m6.1.1"><eq id="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.1.cmml" xref="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.1"></eq><ci id="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.2.cmml" xref="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.2">𝛽</ci><cn type="float" id="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.3.cmml" xref="A1.SS2.SSSx3.Px2.p1.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px2.p1.6.m6.1c">\beta=0.1</annotation></semantics></math>.</p>
</div>
</section>
<section id="A1.SS2.SSSx3.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">CLIMB:</h5>

<div id="A1.SS2.SSSx3.Px3.p1" class="ltx_para">
<p id="A1.SS2.SSSx3.Px3.p1.5" class="ltx_p">CLIMB <cite class="ltx_cite ltx_citemacro_cite">Shen <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib23" title="" class="ltx_ref">2021</a>]</cite> aims to perform the client-level re-weighting to up-weight the aggregation weights for the local gradients with larger local training losses, as the global model behaves poorly on these clients’ local data. The hyper-parameters in CLIMB includes a tolerance constant <math id="A1.SS2.SSSx3.Px3.p1.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="A1.SS2.SSSx3.Px3.p1.1.m1.1a"><mi id="A1.SS2.SSSx3.Px3.p1.1.m1.1.1" xref="A1.SS2.SSSx3.Px3.p1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px3.p1.1.m1.1b"><ci id="A1.SS2.SSSx3.Px3.p1.1.m1.1.1.cmml" xref="A1.SS2.SSSx3.Px3.p1.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px3.p1.1.m1.1c">\epsilon</annotation></semantics></math> and a dual step size <math id="A1.SS2.SSSx3.Px3.p1.2.m2.1" class="ltx_Math" alttext="\eta_{D}" display="inline"><semantics id="A1.SS2.SSSx3.Px3.p1.2.m2.1a"><msub id="A1.SS2.SSSx3.Px3.p1.2.m2.1.1" xref="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.cmml"><mi id="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.2" xref="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.2.cmml">η</mi><mi id="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.3" xref="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px3.p1.2.m2.1b"><apply id="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.cmml" xref="A1.SS2.SSSx3.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.1.cmml" xref="A1.SS2.SSSx3.Px3.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.2.cmml" xref="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.2">𝜂</ci><ci id="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.3.cmml" xref="A1.SS2.SSSx3.Px3.p1.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px3.p1.2.m2.1c">\eta_{D}</annotation></semantics></math>. In our experiments, we follow the original setting to set <math id="A1.SS2.SSSx3.Px3.p1.3.m3.1" class="ltx_Math" alttext="\epsilon=0.01" display="inline"><semantics id="A1.SS2.SSSx3.Px3.p1.3.m3.1a"><mrow id="A1.SS2.SSSx3.Px3.p1.3.m3.1.1" xref="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.cmml"><mi id="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.2" xref="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.2.cmml">ϵ</mi><mo id="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.1" xref="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.3" xref="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px3.p1.3.m3.1b"><apply id="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.cmml" xref="A1.SS2.SSSx3.Px3.p1.3.m3.1.1"><eq id="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.1.cmml" xref="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.1"></eq><ci id="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.2.cmml" xref="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.2">italic-ϵ</ci><cn type="float" id="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.3.cmml" xref="A1.SS2.SSSx3.Px3.p1.3.m3.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px3.p1.3.m3.1c">\epsilon=0.01</annotation></semantics></math> for MNIST-LT and <math id="A1.SS2.SSSx3.Px3.p1.4.m4.1" class="ltx_Math" alttext="\epsilon=0.1" display="inline"><semantics id="A1.SS2.SSSx3.Px3.p1.4.m4.1a"><mrow id="A1.SS2.SSSx3.Px3.p1.4.m4.1.1" xref="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.cmml"><mi id="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.2" xref="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.2.cmml">ϵ</mi><mo id="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.1" xref="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.1.cmml">=</mo><mn id="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.3" xref="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px3.p1.4.m4.1b"><apply id="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.cmml" xref="A1.SS2.SSSx3.Px3.p1.4.m4.1.1"><eq id="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.1.cmml" xref="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.1"></eq><ci id="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.2.cmml" xref="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.2">italic-ϵ</ci><cn type="float" id="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.3.cmml" xref="A1.SS2.SSSx3.Px3.p1.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px3.p1.4.m4.1c">\epsilon=0.1</annotation></semantics></math> for CIFAR-10/100-LT, set <math id="A1.SS2.SSSx3.Px3.p1.5.m5.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="A1.SS2.SSSx3.Px3.p1.5.m5.1a"><mi id="A1.SS2.SSSx3.Px3.p1.5.m5.1.1" xref="A1.SS2.SSSx3.Px3.p1.5.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px3.p1.5.m5.1b"><ci id="A1.SS2.SSSx3.Px3.p1.5.m5.1.1.cmml" xref="A1.SS2.SSSx3.Px3.p1.5.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px3.p1.5.m5.1c">\eta</annotation></semantics></math> as 2.0 and 0.1 for MNIST-LT and CIFAR-10/100-LT separately.</p>
</div>
</section>
<section id="A1.SS2.SSSx3.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">CReFF:</h5>

<div id="A1.SS2.SSSx3.Px4.p1" class="ltx_para">
<p id="A1.SS2.SSSx3.Px4.p1.1" class="ltx_p">CReFF <cite class="ltx_cite ltx_citemacro_cite">Shang <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib22" title="" class="ltx_ref">2022b</a>]</cite> needs to create a set of federated features on the server, of which the number per class is 100. Following the original setting, the optimization steps on the federated features is 100, the classifier re-training steps is 300. Further, the learning rate of optimizing the federated features is 0.1 for all datasets, and the learning rate of classifier re-training is kept as the same as that used in the local training on that dataset.</p>
</div>
</section>
<section id="A1.SS2.SSSx3.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">RedGrape (Ours):</h5>

<div id="A1.SS2.SSSx3.Px5.p1" class="ltx_para">
<p id="A1.SS2.SSSx3.Px5.p1.6" class="ltx_p">Our method introduces two hyper-parameters: <math id="A1.SS2.SSSx3.Px5.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A1.SS2.SSSx3.Px5.p1.1.m1.1a"><mi id="A1.SS2.SSSx3.Px5.p1.1.m1.1.1" xref="A1.SS2.SSSx3.Px5.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px5.p1.1.m1.1b"><ci id="A1.SS2.SSSx3.Px5.p1.1.m1.1.1.cmml" xref="A1.SS2.SSSx3.Px5.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px5.p1.1.m1.1c">\lambda</annotation></semantics></math> for the classifier re-balancing strength, and <math id="A1.SS2.SSSx3.Px5.p1.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A1.SS2.SSSx3.Px5.p1.2.m2.1a"><mi id="A1.SS2.SSSx3.Px5.p1.2.m2.1.1" xref="A1.SS2.SSSx3.Px5.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px5.p1.2.m2.1b"><ci id="A1.SS2.SSSx3.Px5.p1.2.m2.1.1.cmml" xref="A1.SS2.SSSx3.Px5.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px5.p1.2.m2.1c">T</annotation></semantics></math> for the sample quantity threshold of each class on creating local balanced datasets. We put the detailed discussions about these two hyper-parameters in our main paper. The recommended search grids for <math id="A1.SS2.SSSx3.Px5.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A1.SS2.SSSx3.Px5.p1.3.m3.1a"><mi id="A1.SS2.SSSx3.Px5.p1.3.m3.1.1" xref="A1.SS2.SSSx3.Px5.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px5.p1.3.m3.1b"><ci id="A1.SS2.SSSx3.Px5.p1.3.m3.1.1.cmml" xref="A1.SS2.SSSx3.Px5.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px5.p1.3.m3.1c">\lambda</annotation></semantics></math> are <math id="A1.SS2.SSSx3.Px5.p1.4.m4.3" class="ltx_Math" alttext="\{1.0,0.1,0.01\}" display="inline"><semantics id="A1.SS2.SSSx3.Px5.p1.4.m4.3a"><mrow id="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.2" xref="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.2.1" xref="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.1.cmml">{</mo><mn id="A1.SS2.SSSx3.Px5.p1.4.m4.1.1" xref="A1.SS2.SSSx3.Px5.p1.4.m4.1.1.cmml">1.0</mn><mo id="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.2.2" xref="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.1.cmml">,</mo><mn id="A1.SS2.SSSx3.Px5.p1.4.m4.2.2" xref="A1.SS2.SSSx3.Px5.p1.4.m4.2.2.cmml">0.1</mn><mo id="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.2.3" xref="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.1.cmml">,</mo><mn id="A1.SS2.SSSx3.Px5.p1.4.m4.3.3" xref="A1.SS2.SSSx3.Px5.p1.4.m4.3.3.cmml">0.01</mn><mo stretchy="false" id="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.2.4" xref="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px5.p1.4.m4.3b"><set id="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.1.cmml" xref="A1.SS2.SSSx3.Px5.p1.4.m4.3.4.2"><cn type="float" id="A1.SS2.SSSx3.Px5.p1.4.m4.1.1.cmml" xref="A1.SS2.SSSx3.Px5.p1.4.m4.1.1">1.0</cn><cn type="float" id="A1.SS2.SSSx3.Px5.p1.4.m4.2.2.cmml" xref="A1.SS2.SSSx3.Px5.p1.4.m4.2.2">0.1</cn><cn type="float" id="A1.SS2.SSSx3.Px5.p1.4.m4.3.3.cmml" xref="A1.SS2.SSSx3.Px5.p1.4.m4.3.3">0.01</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px5.p1.4.m4.3c">\{1.0,0.1,0.01\}</annotation></semantics></math>, and <math id="A1.SS2.SSSx3.Px5.p1.5.m5.3" class="ltx_Math" alttext="\{2,4,8\}" display="inline"><semantics id="A1.SS2.SSSx3.Px5.p1.5.m5.3a"><mrow id="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.2" xref="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.1.cmml"><mo stretchy="false" id="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.2.1" xref="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.1.cmml">{</mo><mn id="A1.SS2.SSSx3.Px5.p1.5.m5.1.1" xref="A1.SS2.SSSx3.Px5.p1.5.m5.1.1.cmml">2</mn><mo id="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.2.2" xref="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.1.cmml">,</mo><mn id="A1.SS2.SSSx3.Px5.p1.5.m5.2.2" xref="A1.SS2.SSSx3.Px5.p1.5.m5.2.2.cmml">4</mn><mo id="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.2.3" xref="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.1.cmml">,</mo><mn id="A1.SS2.SSSx3.Px5.p1.5.m5.3.3" xref="A1.SS2.SSSx3.Px5.p1.5.m5.3.3.cmml">8</mn><mo stretchy="false" id="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.2.4" xref="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px5.p1.5.m5.3b"><set id="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.1.cmml" xref="A1.SS2.SSSx3.Px5.p1.5.m5.3.4.2"><cn type="integer" id="A1.SS2.SSSx3.Px5.p1.5.m5.1.1.cmml" xref="A1.SS2.SSSx3.Px5.p1.5.m5.1.1">2</cn><cn type="integer" id="A1.SS2.SSSx3.Px5.p1.5.m5.2.2.cmml" xref="A1.SS2.SSSx3.Px5.p1.5.m5.2.2">4</cn><cn type="integer" id="A1.SS2.SSSx3.Px5.p1.5.m5.3.3.cmml" xref="A1.SS2.SSSx3.Px5.p1.5.m5.3.3">8</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px5.p1.5.m5.3c">\{2,4,8\}</annotation></semantics></math> for <math id="A1.SS2.SSSx3.Px5.p1.6.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A1.SS2.SSSx3.Px5.p1.6.m6.1a"><mi id="A1.SS2.SSSx3.Px5.p1.6.m6.1.1" xref="A1.SS2.SSSx3.Px5.p1.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSSx3.Px5.p1.6.m6.1b"><ci id="A1.SS2.SSSx3.Px5.p1.6.m6.1.1.cmml" xref="A1.SS2.SSSx3.Px5.p1.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSSx3.Px5.p1.6.m6.1c">T</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="A1.SS2.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Code and Infrastructure</h4>

<div id="A1.SS2.SSSx4.p1" class="ltx_para">
<p id="A1.SS2.SSSx4.p1.1" class="ltx_p">Our code is implemented based on the open-sourced FL platform FedML <cite class="ltx_cite ltx_citemacro_cite">He <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib8" title="" class="ltx_ref">2020</a>]</cite>. We will release our code upon acceptance. Our experiments are conducted on 8 * GeForce RTX 2080 Ti.</p>
</div>
<figure id="A1.T4" class="ltx_table">
<table id="A1.T4.9.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.9.9.10.1" class="ltx_tr">
<th id="A1.T4.9.9.10.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="A1.T4.9.9.10.1.1.1" class="ltx_text">
<span id="A1.T4.9.9.10.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T4.9.9.10.1.1.1.1.1" class="ltx_tr">
<span id="A1.T4.9.9.10.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Method</span></span>
</span></span></th>
<th id="A1.T4.9.9.10.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">MNIST-LT</th>
<th id="A1.T4.9.9.10.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-10-LT</th>
<th id="A1.T4.9.9.10.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-100-LT</th>
</tr>
<tr id="A1.T4.9.9.9" class="ltx_tr">
<th id="A1.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="A1.T4.1.1.1.1.m1.1a"><mrow id="A1.T4.1.1.1.1.m1.1.1" xref="A1.T4.1.1.1.1.m1.1.1.cmml"><mtext id="A1.T4.1.1.1.1.m1.1.1.2" xref="A1.T4.1.1.1.1.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.1.1.1.1.m1.1.1.1" xref="A1.T4.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A1.T4.1.1.1.1.m1.1.1.3" xref="A1.T4.1.1.1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.1.m1.1b"><apply id="A1.T4.1.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.1.m1.1.1"><eq id="A1.T4.1.1.1.1.m1.1.1.1.cmml" xref="A1.T4.1.1.1.1.m1.1.1.1"></eq><ci id="A1.T4.1.1.1.1.m1.1.1.2a.cmml" xref="A1.T4.1.1.1.1.m1.1.1.2"><mtext id="A1.T4.1.1.1.1.m1.1.1.2.cmml" xref="A1.T4.1.1.1.1.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.1.1.1.1.m1.1.1.3.cmml" xref="A1.T4.1.1.1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.1.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="A1.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.2.2.2.2.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="A1.T4.2.2.2.2.m1.1a"><mrow id="A1.T4.2.2.2.2.m1.1.1" xref="A1.T4.2.2.2.2.m1.1.1.cmml"><mtext id="A1.T4.2.2.2.2.m1.1.1.2" xref="A1.T4.2.2.2.2.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.2.2.2.2.m1.1.1.1" xref="A1.T4.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="A1.T4.2.2.2.2.m1.1.1.3" xref="A1.T4.2.2.2.2.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.2.2.2.2.m1.1b"><apply id="A1.T4.2.2.2.2.m1.1.1.cmml" xref="A1.T4.2.2.2.2.m1.1.1"><eq id="A1.T4.2.2.2.2.m1.1.1.1.cmml" xref="A1.T4.2.2.2.2.m1.1.1.1"></eq><ci id="A1.T4.2.2.2.2.m1.1.1.2a.cmml" xref="A1.T4.2.2.2.2.m1.1.1.2"><mtext id="A1.T4.2.2.2.2.m1.1.1.2.cmml" xref="A1.T4.2.2.2.2.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.2.2.2.2.m1.1.1.3.cmml" xref="A1.T4.2.2.2.2.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.2.2.2.2.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="A1.T4.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.3.3.3.3.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="A1.T4.3.3.3.3.m1.1a"><mrow id="A1.T4.3.3.3.3.m1.1.1" xref="A1.T4.3.3.3.3.m1.1.1.cmml"><mtext id="A1.T4.3.3.3.3.m1.1.1.2" xref="A1.T4.3.3.3.3.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.3.3.3.3.m1.1.1.1" xref="A1.T4.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="A1.T4.3.3.3.3.m1.1.1.3" xref="A1.T4.3.3.3.3.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.3.3.3.3.m1.1b"><apply id="A1.T4.3.3.3.3.m1.1.1.cmml" xref="A1.T4.3.3.3.3.m1.1.1"><eq id="A1.T4.3.3.3.3.m1.1.1.1.cmml" xref="A1.T4.3.3.3.3.m1.1.1.1"></eq><ci id="A1.T4.3.3.3.3.m1.1.1.2a.cmml" xref="A1.T4.3.3.3.3.m1.1.1.2"><mtext id="A1.T4.3.3.3.3.m1.1.1.2.cmml" xref="A1.T4.3.3.3.3.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.3.3.3.3.m1.1.1.3.cmml" xref="A1.T4.3.3.3.3.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.3.3.3.3.m1.1c">\text{IR}=100</annotation></semantics></math></th>
<th id="A1.T4.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.4.4.4.4.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="A1.T4.4.4.4.4.m1.1a"><mrow id="A1.T4.4.4.4.4.m1.1.1" xref="A1.T4.4.4.4.4.m1.1.1.cmml"><mtext id="A1.T4.4.4.4.4.m1.1.1.2" xref="A1.T4.4.4.4.4.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.4.4.4.4.m1.1.1.1" xref="A1.T4.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="A1.T4.4.4.4.4.m1.1.1.3" xref="A1.T4.4.4.4.4.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.4.4.4.4.m1.1b"><apply id="A1.T4.4.4.4.4.m1.1.1.cmml" xref="A1.T4.4.4.4.4.m1.1.1"><eq id="A1.T4.4.4.4.4.m1.1.1.1.cmml" xref="A1.T4.4.4.4.4.m1.1.1.1"></eq><ci id="A1.T4.4.4.4.4.m1.1.1.2a.cmml" xref="A1.T4.4.4.4.4.m1.1.1.2"><mtext id="A1.T4.4.4.4.4.m1.1.1.2.cmml" xref="A1.T4.4.4.4.4.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.4.4.4.4.m1.1.1.3.cmml" xref="A1.T4.4.4.4.4.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.4.4.4.4.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="A1.T4.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.5.5.5.5.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="A1.T4.5.5.5.5.m1.1a"><mrow id="A1.T4.5.5.5.5.m1.1.1" xref="A1.T4.5.5.5.5.m1.1.1.cmml"><mtext id="A1.T4.5.5.5.5.m1.1.1.2" xref="A1.T4.5.5.5.5.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.5.5.5.5.m1.1.1.1" xref="A1.T4.5.5.5.5.m1.1.1.1.cmml">=</mo><mn id="A1.T4.5.5.5.5.m1.1.1.3" xref="A1.T4.5.5.5.5.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.5.5.5.5.m1.1b"><apply id="A1.T4.5.5.5.5.m1.1.1.cmml" xref="A1.T4.5.5.5.5.m1.1.1"><eq id="A1.T4.5.5.5.5.m1.1.1.1.cmml" xref="A1.T4.5.5.5.5.m1.1.1.1"></eq><ci id="A1.T4.5.5.5.5.m1.1.1.2a.cmml" xref="A1.T4.5.5.5.5.m1.1.1.2"><mtext id="A1.T4.5.5.5.5.m1.1.1.2.cmml" xref="A1.T4.5.5.5.5.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.5.5.5.5.m1.1.1.3.cmml" xref="A1.T4.5.5.5.5.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.5.5.5.5.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="A1.T4.6.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.6.6.6.6.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="A1.T4.6.6.6.6.m1.1a"><mrow id="A1.T4.6.6.6.6.m1.1.1" xref="A1.T4.6.6.6.6.m1.1.1.cmml"><mtext id="A1.T4.6.6.6.6.m1.1.1.2" xref="A1.T4.6.6.6.6.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.6.6.6.6.m1.1.1.1" xref="A1.T4.6.6.6.6.m1.1.1.1.cmml">=</mo><mn id="A1.T4.6.6.6.6.m1.1.1.3" xref="A1.T4.6.6.6.6.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.6.6.6.6.m1.1b"><apply id="A1.T4.6.6.6.6.m1.1.1.cmml" xref="A1.T4.6.6.6.6.m1.1.1"><eq id="A1.T4.6.6.6.6.m1.1.1.1.cmml" xref="A1.T4.6.6.6.6.m1.1.1.1"></eq><ci id="A1.T4.6.6.6.6.m1.1.1.2a.cmml" xref="A1.T4.6.6.6.6.m1.1.1.2"><mtext id="A1.T4.6.6.6.6.m1.1.1.2.cmml" xref="A1.T4.6.6.6.6.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.6.6.6.6.m1.1.1.3.cmml" xref="A1.T4.6.6.6.6.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.6.6.6.6.m1.1c">\text{IR}=100</annotation></semantics></math></th>
<th id="A1.T4.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.7.7.7.7.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="A1.T4.7.7.7.7.m1.1a"><mrow id="A1.T4.7.7.7.7.m1.1.1" xref="A1.T4.7.7.7.7.m1.1.1.cmml"><mtext id="A1.T4.7.7.7.7.m1.1.1.2" xref="A1.T4.7.7.7.7.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.7.7.7.7.m1.1.1.1" xref="A1.T4.7.7.7.7.m1.1.1.1.cmml">=</mo><mn id="A1.T4.7.7.7.7.m1.1.1.3" xref="A1.T4.7.7.7.7.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.7.7.7.7.m1.1b"><apply id="A1.T4.7.7.7.7.m1.1.1.cmml" xref="A1.T4.7.7.7.7.m1.1.1"><eq id="A1.T4.7.7.7.7.m1.1.1.1.cmml" xref="A1.T4.7.7.7.7.m1.1.1.1"></eq><ci id="A1.T4.7.7.7.7.m1.1.1.2a.cmml" xref="A1.T4.7.7.7.7.m1.1.1.2"><mtext id="A1.T4.7.7.7.7.m1.1.1.2.cmml" xref="A1.T4.7.7.7.7.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.7.7.7.7.m1.1.1.3.cmml" xref="A1.T4.7.7.7.7.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.7.7.7.7.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="A1.T4.8.8.8.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.8.8.8.8.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="A1.T4.8.8.8.8.m1.1a"><mrow id="A1.T4.8.8.8.8.m1.1.1" xref="A1.T4.8.8.8.8.m1.1.1.cmml"><mtext id="A1.T4.8.8.8.8.m1.1.1.2" xref="A1.T4.8.8.8.8.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.8.8.8.8.m1.1.1.1" xref="A1.T4.8.8.8.8.m1.1.1.1.cmml">=</mo><mn id="A1.T4.8.8.8.8.m1.1.1.3" xref="A1.T4.8.8.8.8.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.8.8.8.8.m1.1b"><apply id="A1.T4.8.8.8.8.m1.1.1.cmml" xref="A1.T4.8.8.8.8.m1.1.1"><eq id="A1.T4.8.8.8.8.m1.1.1.1.cmml" xref="A1.T4.8.8.8.8.m1.1.1.1"></eq><ci id="A1.T4.8.8.8.8.m1.1.1.2a.cmml" xref="A1.T4.8.8.8.8.m1.1.1.2"><mtext id="A1.T4.8.8.8.8.m1.1.1.2.cmml" xref="A1.T4.8.8.8.8.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.8.8.8.8.m1.1.1.3.cmml" xref="A1.T4.8.8.8.8.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.8.8.8.8.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="A1.T4.9.9.9.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T4.9.9.9.9.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="A1.T4.9.9.9.9.m1.1a"><mrow id="A1.T4.9.9.9.9.m1.1.1" xref="A1.T4.9.9.9.9.m1.1.1.cmml"><mtext id="A1.T4.9.9.9.9.m1.1.1.2" xref="A1.T4.9.9.9.9.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T4.9.9.9.9.m1.1.1.1" xref="A1.T4.9.9.9.9.m1.1.1.1.cmml">=</mo><mn id="A1.T4.9.9.9.9.m1.1.1.3" xref="A1.T4.9.9.9.9.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.9.9.9.9.m1.1b"><apply id="A1.T4.9.9.9.9.m1.1.1.cmml" xref="A1.T4.9.9.9.9.m1.1.1"><eq id="A1.T4.9.9.9.9.m1.1.1.1.cmml" xref="A1.T4.9.9.9.9.m1.1.1.1"></eq><ci id="A1.T4.9.9.9.9.m1.1.1.2a.cmml" xref="A1.T4.9.9.9.9.m1.1.1.2"><mtext id="A1.T4.9.9.9.9.m1.1.1.2.cmml" xref="A1.T4.9.9.9.9.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T4.9.9.9.9.m1.1.1.3.cmml" xref="A1.T4.9.9.9.9.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.9.9.9.9.m1.1c">\text{IR}=100</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.9.9.11.1" class="ltx_tr">
<td id="A1.T4.9.9.11.1.1" class="ltx_td ltx_align_left ltx_border_t">FedAvg+CE</td>
<td id="A1.T4.9.9.11.1.2" class="ltx_td ltx_align_center ltx_border_t">96.05</td>
<td id="A1.T4.9.9.11.1.3" class="ltx_td ltx_align_center ltx_border_t">90.23</td>
<td id="A1.T4.9.9.11.1.4" class="ltx_td ltx_align_center ltx_border_t">82.21</td>
<td id="A1.T4.9.9.11.1.5" class="ltx_td ltx_align_center ltx_border_t">67.87</td>
<td id="A1.T4.9.9.11.1.6" class="ltx_td ltx_align_center ltx_border_t">55.26</td>
<td id="A1.T4.9.9.11.1.7" class="ltx_td ltx_align_center ltx_border_t">29.24</td>
<td id="A1.T4.9.9.11.1.8" class="ltx_td ltx_align_center ltx_border_t">36.25</td>
<td id="A1.T4.9.9.11.1.9" class="ltx_td ltx_align_center ltx_border_t">13.37</td>
<td id="A1.T4.9.9.11.1.10" class="ltx_td ltx_align_center ltx_border_t">
<span id="A1.T4.9.9.11.1.10.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>8.50</td>
</tr>
<tr id="A1.T4.9.9.12.2" class="ltx_tr">
<td id="A1.T4.9.9.12.2.1" class="ltx_td ltx_align_left">Fed-Focal Loss</td>
<td id="A1.T4.9.9.12.2.2" class="ltx_td ltx_align_center">95.84</td>
<td id="A1.T4.9.9.12.2.3" class="ltx_td ltx_align_center">90.47</td>
<td id="A1.T4.9.9.12.2.4" class="ltx_td ltx_align_center">82.62</td>
<td id="A1.T4.9.9.12.2.5" class="ltx_td ltx_align_center">74.94</td>
<td id="A1.T4.9.9.12.2.6" class="ltx_td ltx_align_center">47.37</td>
<td id="A1.T4.9.9.12.2.7" class="ltx_td ltx_align_center">33.86</td>
<td id="A1.T4.9.9.12.2.8" class="ltx_td ltx_align_center">34.40</td>
<td id="A1.T4.9.9.12.2.9" class="ltx_td ltx_align_center">12.53</td>
<td id="A1.T4.9.9.12.2.10" class="ltx_td ltx_align_center">
<span id="A1.T4.9.9.12.2.10.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>6.49</td>
</tr>
<tr id="A1.T4.9.9.13.3" class="ltx_tr">
<td id="A1.T4.9.9.13.3.1" class="ltx_td ltx_align_left">Ratio Loss</td>
<td id="A1.T4.9.9.13.3.2" class="ltx_td ltx_align_center">96.04</td>
<td id="A1.T4.9.9.13.3.3" class="ltx_td ltx_align_center">90.76</td>
<td id="A1.T4.9.9.13.3.4" class="ltx_td ltx_align_center">83.01</td>
<td id="A1.T4.9.9.13.3.5" class="ltx_td ltx_align_center">71.27</td>
<td id="A1.T4.9.9.13.3.6" class="ltx_td ltx_align_center">55.79</td>
<td id="A1.T4.9.9.13.3.7" class="ltx_td ltx_align_center">33.28</td>
<td id="A1.T4.9.9.13.3.8" class="ltx_td ltx_align_center">34.55</td>
<td id="A1.T4.9.9.13.3.9" class="ltx_td ltx_align_center">15.35</td>
<td id="A1.T4.9.9.13.3.10" class="ltx_td ltx_align_center">
<span id="A1.T4.9.9.13.3.10.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>7.98</td>
</tr>
<tr id="A1.T4.9.9.14.4" class="ltx_tr">
<td id="A1.T4.9.9.14.4.1" class="ltx_td ltx_align_left">CLIMB</td>
<td id="A1.T4.9.9.14.4.2" class="ltx_td ltx_align_center">95.70</td>
<td id="A1.T4.9.9.14.4.3" class="ltx_td ltx_align_center">89.93</td>
<td id="A1.T4.9.9.14.4.4" class="ltx_td ltx_align_center">82.01</td>
<td id="A1.T4.9.9.14.4.5" class="ltx_td ltx_align_center">73.68</td>
<td id="A1.T4.9.9.14.4.6" class="ltx_td ltx_align_center">55.86</td>
<td id="A1.T4.9.9.14.4.7" class="ltx_td ltx_align_center">30.95</td>
<td id="A1.T4.9.9.14.4.8" class="ltx_td ltx_align_center">35.81</td>
<td id="A1.T4.9.9.14.4.9" class="ltx_td ltx_align_center">13.31</td>
<td id="A1.T4.9.9.14.4.10" class="ltx_td ltx_align_center">
<span id="A1.T4.9.9.14.4.10.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>8.65</td>
</tr>
<tr id="A1.T4.9.9.15.5" class="ltx_tr">
<td id="A1.T4.9.9.15.5.1" class="ltx_td ltx_align_left">CReFF</td>
<td id="A1.T4.9.9.15.5.2" class="ltx_td ltx_align_center">95.98</td>
<td id="A1.T4.9.9.15.5.3" class="ltx_td ltx_align_center">91.98</td>
<td id="A1.T4.9.9.15.5.4" class="ltx_td ltx_align_center">86.62</td>
<td id="A1.T4.9.9.15.5.5" class="ltx_td ltx_align_center">82.87</td>
<td id="A1.T4.9.9.15.5.6" class="ltx_td ltx_align_center">66.10</td>
<td id="A1.T4.9.9.15.5.7" class="ltx_td ltx_align_center">57.03</td>
<td id="A1.T4.9.9.15.5.8" class="ltx_td ltx_align_center">38.18</td>
<td id="A1.T4.9.9.15.5.9" class="ltx_td ltx_align_center"><span id="A1.T4.9.9.15.5.9.1" class="ltx_text ltx_font_bold">22.77</span></td>
<td id="A1.T4.9.9.15.5.10" class="ltx_td ltx_align_center"><span id="A1.T4.9.9.15.5.10.1" class="ltx_text ltx_font_bold">18.98</span></td>
</tr>
<tr id="A1.T4.9.9.16.6" class="ltx_tr">
<td id="A1.T4.9.9.16.6.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Ours</td>
<td id="A1.T4.9.9.16.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T4.9.9.16.6.2.1" class="ltx_text ltx_font_bold">96.78</span></td>
<td id="A1.T4.9.9.16.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T4.9.9.16.6.3.1" class="ltx_text ltx_font_bold">92.97</span></td>
<td id="A1.T4.9.9.16.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T4.9.9.16.6.4.1" class="ltx_text ltx_font_bold">89.59</span></td>
<td id="A1.T4.9.9.16.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T4.9.9.16.6.5.1" class="ltx_text ltx_font_bold">83.86</span></td>
<td id="A1.T4.9.9.16.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T4.9.9.16.6.6.1" class="ltx_text ltx_font_bold">69.74</span></td>
<td id="A1.T4.9.9.16.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T4.9.9.16.6.7.1" class="ltx_text ltx_font_bold">60.41</span></td>
<td id="A1.T4.9.9.16.6.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T4.9.9.16.6.8.1" class="ltx_text ltx_font_bold">40.11</span></td>
<td id="A1.T4.9.9.16.6.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">20.19</td>
<td id="A1.T4.9.9.16.6.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">15.58</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Averaged evaluation accuracy on the tail classes under the <span id="A1.T4.11.1" class="ltx_text ltx_font_bold">full client participation</span> setting in main experiments.</figcaption>
</figure>
<figure id="A1.T5" class="ltx_table">
<table id="A1.T5.9.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T5.9.9.10.1" class="ltx_tr">
<th id="A1.T5.9.9.10.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="A1.T5.9.9.10.1.1.1" class="ltx_text">
<span id="A1.T5.9.9.10.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A1.T5.9.9.10.1.1.1.1.1" class="ltx_tr">
<span id="A1.T5.9.9.10.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Method</span></span>
</span></span></th>
<th id="A1.T5.9.9.10.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">MNIST-LT</th>
<th id="A1.T5.9.9.10.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-10-LT</th>
<th id="A1.T5.9.9.10.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-100-LT</th>
</tr>
<tr id="A1.T5.9.9.9" class="ltx_tr">
<th id="A1.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="A1.T5.1.1.1.1.m1.1a"><mrow id="A1.T5.1.1.1.1.m1.1.1" xref="A1.T5.1.1.1.1.m1.1.1.cmml"><mtext id="A1.T5.1.1.1.1.m1.1.1.2" xref="A1.T5.1.1.1.1.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.1.1.1.1.m1.1.1.1" xref="A1.T5.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.1.1.1.1.m1.1.1.3" xref="A1.T5.1.1.1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.1.1.1.1.m1.1b"><apply id="A1.T5.1.1.1.1.m1.1.1.cmml" xref="A1.T5.1.1.1.1.m1.1.1"><eq id="A1.T5.1.1.1.1.m1.1.1.1.cmml" xref="A1.T5.1.1.1.1.m1.1.1.1"></eq><ci id="A1.T5.1.1.1.1.m1.1.1.2a.cmml" xref="A1.T5.1.1.1.1.m1.1.1.2"><mtext id="A1.T5.1.1.1.1.m1.1.1.2.cmml" xref="A1.T5.1.1.1.1.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.1.1.1.1.m1.1.1.3.cmml" xref="A1.T5.1.1.1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.1.1.1.1.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="A1.T5.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.2.2.2.2.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="A1.T5.2.2.2.2.m1.1a"><mrow id="A1.T5.2.2.2.2.m1.1.1" xref="A1.T5.2.2.2.2.m1.1.1.cmml"><mtext id="A1.T5.2.2.2.2.m1.1.1.2" xref="A1.T5.2.2.2.2.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.2.2.2.2.m1.1.1.1" xref="A1.T5.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="A1.T5.2.2.2.2.m1.1.1.3" xref="A1.T5.2.2.2.2.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.2.2.2.2.m1.1b"><apply id="A1.T5.2.2.2.2.m1.1.1.cmml" xref="A1.T5.2.2.2.2.m1.1.1"><eq id="A1.T5.2.2.2.2.m1.1.1.1.cmml" xref="A1.T5.2.2.2.2.m1.1.1.1"></eq><ci id="A1.T5.2.2.2.2.m1.1.1.2a.cmml" xref="A1.T5.2.2.2.2.m1.1.1.2"><mtext id="A1.T5.2.2.2.2.m1.1.1.2.cmml" xref="A1.T5.2.2.2.2.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.2.2.2.2.m1.1.1.3.cmml" xref="A1.T5.2.2.2.2.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.2.2.2.2.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="A1.T5.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.3.3.3.3.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="A1.T5.3.3.3.3.m1.1a"><mrow id="A1.T5.3.3.3.3.m1.1.1" xref="A1.T5.3.3.3.3.m1.1.1.cmml"><mtext id="A1.T5.3.3.3.3.m1.1.1.2" xref="A1.T5.3.3.3.3.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.3.3.3.3.m1.1.1.1" xref="A1.T5.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.3.3.3.3.m1.1.1.3" xref="A1.T5.3.3.3.3.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.3.3.3.3.m1.1b"><apply id="A1.T5.3.3.3.3.m1.1.1.cmml" xref="A1.T5.3.3.3.3.m1.1.1"><eq id="A1.T5.3.3.3.3.m1.1.1.1.cmml" xref="A1.T5.3.3.3.3.m1.1.1.1"></eq><ci id="A1.T5.3.3.3.3.m1.1.1.2a.cmml" xref="A1.T5.3.3.3.3.m1.1.1.2"><mtext id="A1.T5.3.3.3.3.m1.1.1.2.cmml" xref="A1.T5.3.3.3.3.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.3.3.3.3.m1.1.1.3.cmml" xref="A1.T5.3.3.3.3.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.3.3.3.3.m1.1c">\text{IR}=100</annotation></semantics></math></th>
<th id="A1.T5.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.4.4.4.4.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="A1.T5.4.4.4.4.m1.1a"><mrow id="A1.T5.4.4.4.4.m1.1.1" xref="A1.T5.4.4.4.4.m1.1.1.cmml"><mtext id="A1.T5.4.4.4.4.m1.1.1.2" xref="A1.T5.4.4.4.4.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.4.4.4.4.m1.1.1.1" xref="A1.T5.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.4.4.4.4.m1.1.1.3" xref="A1.T5.4.4.4.4.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.4.4.4.4.m1.1b"><apply id="A1.T5.4.4.4.4.m1.1.1.cmml" xref="A1.T5.4.4.4.4.m1.1.1"><eq id="A1.T5.4.4.4.4.m1.1.1.1.cmml" xref="A1.T5.4.4.4.4.m1.1.1.1"></eq><ci id="A1.T5.4.4.4.4.m1.1.1.2a.cmml" xref="A1.T5.4.4.4.4.m1.1.1.2"><mtext id="A1.T5.4.4.4.4.m1.1.1.2.cmml" xref="A1.T5.4.4.4.4.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.4.4.4.4.m1.1.1.3.cmml" xref="A1.T5.4.4.4.4.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.4.4.4.4.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="A1.T5.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.5.5.5.5.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="A1.T5.5.5.5.5.m1.1a"><mrow id="A1.T5.5.5.5.5.m1.1.1" xref="A1.T5.5.5.5.5.m1.1.1.cmml"><mtext id="A1.T5.5.5.5.5.m1.1.1.2" xref="A1.T5.5.5.5.5.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.5.5.5.5.m1.1.1.1" xref="A1.T5.5.5.5.5.m1.1.1.1.cmml">=</mo><mn id="A1.T5.5.5.5.5.m1.1.1.3" xref="A1.T5.5.5.5.5.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.5.5.5.5.m1.1b"><apply id="A1.T5.5.5.5.5.m1.1.1.cmml" xref="A1.T5.5.5.5.5.m1.1.1"><eq id="A1.T5.5.5.5.5.m1.1.1.1.cmml" xref="A1.T5.5.5.5.5.m1.1.1.1"></eq><ci id="A1.T5.5.5.5.5.m1.1.1.2a.cmml" xref="A1.T5.5.5.5.5.m1.1.1.2"><mtext id="A1.T5.5.5.5.5.m1.1.1.2.cmml" xref="A1.T5.5.5.5.5.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.5.5.5.5.m1.1.1.3.cmml" xref="A1.T5.5.5.5.5.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.5.5.5.5.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="A1.T5.6.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.6.6.6.6.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="A1.T5.6.6.6.6.m1.1a"><mrow id="A1.T5.6.6.6.6.m1.1.1" xref="A1.T5.6.6.6.6.m1.1.1.cmml"><mtext id="A1.T5.6.6.6.6.m1.1.1.2" xref="A1.T5.6.6.6.6.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.6.6.6.6.m1.1.1.1" xref="A1.T5.6.6.6.6.m1.1.1.1.cmml">=</mo><mn id="A1.T5.6.6.6.6.m1.1.1.3" xref="A1.T5.6.6.6.6.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.6.6.6.6.m1.1b"><apply id="A1.T5.6.6.6.6.m1.1.1.cmml" xref="A1.T5.6.6.6.6.m1.1.1"><eq id="A1.T5.6.6.6.6.m1.1.1.1.cmml" xref="A1.T5.6.6.6.6.m1.1.1.1"></eq><ci id="A1.T5.6.6.6.6.m1.1.1.2a.cmml" xref="A1.T5.6.6.6.6.m1.1.1.2"><mtext id="A1.T5.6.6.6.6.m1.1.1.2.cmml" xref="A1.T5.6.6.6.6.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.6.6.6.6.m1.1.1.3.cmml" xref="A1.T5.6.6.6.6.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.6.6.6.6.m1.1c">\text{IR}=100</annotation></semantics></math></th>
<th id="A1.T5.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.7.7.7.7.m1.1" class="ltx_Math" alttext="\text{IR}=10" display="inline"><semantics id="A1.T5.7.7.7.7.m1.1a"><mrow id="A1.T5.7.7.7.7.m1.1.1" xref="A1.T5.7.7.7.7.m1.1.1.cmml"><mtext id="A1.T5.7.7.7.7.m1.1.1.2" xref="A1.T5.7.7.7.7.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.7.7.7.7.m1.1.1.1" xref="A1.T5.7.7.7.7.m1.1.1.1.cmml">=</mo><mn id="A1.T5.7.7.7.7.m1.1.1.3" xref="A1.T5.7.7.7.7.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.7.7.7.7.m1.1b"><apply id="A1.T5.7.7.7.7.m1.1.1.cmml" xref="A1.T5.7.7.7.7.m1.1.1"><eq id="A1.T5.7.7.7.7.m1.1.1.1.cmml" xref="A1.T5.7.7.7.7.m1.1.1.1"></eq><ci id="A1.T5.7.7.7.7.m1.1.1.2a.cmml" xref="A1.T5.7.7.7.7.m1.1.1.2"><mtext id="A1.T5.7.7.7.7.m1.1.1.2.cmml" xref="A1.T5.7.7.7.7.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.7.7.7.7.m1.1.1.3.cmml" xref="A1.T5.7.7.7.7.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.7.7.7.7.m1.1c">\text{IR}=10</annotation></semantics></math></th>
<th id="A1.T5.8.8.8.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.8.8.8.8.m1.1" class="ltx_Math" alttext="\text{IR}=50" display="inline"><semantics id="A1.T5.8.8.8.8.m1.1a"><mrow id="A1.T5.8.8.8.8.m1.1.1" xref="A1.T5.8.8.8.8.m1.1.1.cmml"><mtext id="A1.T5.8.8.8.8.m1.1.1.2" xref="A1.T5.8.8.8.8.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.8.8.8.8.m1.1.1.1" xref="A1.T5.8.8.8.8.m1.1.1.1.cmml">=</mo><mn id="A1.T5.8.8.8.8.m1.1.1.3" xref="A1.T5.8.8.8.8.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.8.8.8.8.m1.1b"><apply id="A1.T5.8.8.8.8.m1.1.1.cmml" xref="A1.T5.8.8.8.8.m1.1.1"><eq id="A1.T5.8.8.8.8.m1.1.1.1.cmml" xref="A1.T5.8.8.8.8.m1.1.1.1"></eq><ci id="A1.T5.8.8.8.8.m1.1.1.2a.cmml" xref="A1.T5.8.8.8.8.m1.1.1.2"><mtext id="A1.T5.8.8.8.8.m1.1.1.2.cmml" xref="A1.T5.8.8.8.8.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.8.8.8.8.m1.1.1.3.cmml" xref="A1.T5.8.8.8.8.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.8.8.8.8.m1.1c">\text{IR}=50</annotation></semantics></math></th>
<th id="A1.T5.9.9.9.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A1.T5.9.9.9.9.m1.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="A1.T5.9.9.9.9.m1.1a"><mrow id="A1.T5.9.9.9.9.m1.1.1" xref="A1.T5.9.9.9.9.m1.1.1.cmml"><mtext id="A1.T5.9.9.9.9.m1.1.1.2" xref="A1.T5.9.9.9.9.m1.1.1.2a.cmml">IR</mtext><mo id="A1.T5.9.9.9.9.m1.1.1.1" xref="A1.T5.9.9.9.9.m1.1.1.1.cmml">=</mo><mn id="A1.T5.9.9.9.9.m1.1.1.3" xref="A1.T5.9.9.9.9.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.9.9.9.9.m1.1b"><apply id="A1.T5.9.9.9.9.m1.1.1.cmml" xref="A1.T5.9.9.9.9.m1.1.1"><eq id="A1.T5.9.9.9.9.m1.1.1.1.cmml" xref="A1.T5.9.9.9.9.m1.1.1.1"></eq><ci id="A1.T5.9.9.9.9.m1.1.1.2a.cmml" xref="A1.T5.9.9.9.9.m1.1.1.2"><mtext id="A1.T5.9.9.9.9.m1.1.1.2.cmml" xref="A1.T5.9.9.9.9.m1.1.1.2">IR</mtext></ci><cn type="integer" id="A1.T5.9.9.9.9.m1.1.1.3.cmml" xref="A1.T5.9.9.9.9.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.9.9.9.9.m1.1c">\text{IR}=100</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T5.9.9.11.1" class="ltx_tr">
<td id="A1.T5.9.9.11.1.1" class="ltx_td ltx_align_left ltx_border_t">FedAvg+CE</td>
<td id="A1.T5.9.9.11.1.2" class="ltx_td ltx_align_center ltx_border_t">89.75</td>
<td id="A1.T5.9.9.11.1.3" class="ltx_td ltx_align_center ltx_border_t">80.05</td>
<td id="A1.T5.9.9.11.1.4" class="ltx_td ltx_align_center ltx_border_t">74.35</td>
<td id="A1.T5.9.9.11.1.5" class="ltx_td ltx_align_center ltx_border_t">51.99</td>
<td id="A1.T5.9.9.11.1.6" class="ltx_td ltx_align_center ltx_border_t">24.03</td>
<td id="A1.T5.9.9.11.1.7" class="ltx_td ltx_align_center ltx_border_t">
<span id="A1.T5.9.9.11.1.7.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>2.64</td>
<td id="A1.T5.9.9.11.1.8" class="ltx_td ltx_align_center ltx_border_t">29.65</td>
<td id="A1.T5.9.9.11.1.9" class="ltx_td ltx_align_center ltx_border_t">
<span id="A1.T5.9.9.11.1.9.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>8.55</td>
<td id="A1.T5.9.9.11.1.10" class="ltx_td ltx_align_center ltx_border_t">
<span id="A1.T5.9.9.11.1.10.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>5.74</td>
</tr>
<tr id="A1.T5.9.9.12.2" class="ltx_tr">
<td id="A1.T5.9.9.12.2.1" class="ltx_td ltx_align_left">Fed-Focal Loss</td>
<td id="A1.T5.9.9.12.2.2" class="ltx_td ltx_align_center">92.65</td>
<td id="A1.T5.9.9.12.2.3" class="ltx_td ltx_align_center">82.43</td>
<td id="A1.T5.9.9.12.2.4" class="ltx_td ltx_align_center">75.46</td>
<td id="A1.T5.9.9.12.2.5" class="ltx_td ltx_align_center">49.78</td>
<td id="A1.T5.9.9.12.2.6" class="ltx_td ltx_align_center">27.43</td>
<td id="A1.T5.9.9.12.2.7" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.12.2.7.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>5.68</td>
<td id="A1.T5.9.9.12.2.8" class="ltx_td ltx_align_center">29.51</td>
<td id="A1.T5.9.9.12.2.9" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.12.2.9.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>8.89</td>
<td id="A1.T5.9.9.12.2.10" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.12.2.10.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>4.08</td>
</tr>
<tr id="A1.T5.9.9.13.3" class="ltx_tr">
<td id="A1.T5.9.9.13.3.1" class="ltx_td ltx_align_left">Ratio Loss</td>
<td id="A1.T5.9.9.13.3.2" class="ltx_td ltx_align_center">89.83</td>
<td id="A1.T5.9.9.13.3.3" class="ltx_td ltx_align_center">77.93</td>
<td id="A1.T5.9.9.13.3.4" class="ltx_td ltx_align_center">73.35</td>
<td id="A1.T5.9.9.13.3.5" class="ltx_td ltx_align_center">55.54</td>
<td id="A1.T5.9.9.13.3.6" class="ltx_td ltx_align_center">23.81</td>
<td id="A1.T5.9.9.13.3.7" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.13.3.7.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>4.87</td>
<td id="A1.T5.9.9.13.3.8" class="ltx_td ltx_align_center">29.28</td>
<td id="A1.T5.9.9.13.3.9" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.13.3.9.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>8.36</td>
<td id="A1.T5.9.9.13.3.10" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.13.3.10.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>5.86</td>
</tr>
<tr id="A1.T5.9.9.14.4" class="ltx_tr">
<td id="A1.T5.9.9.14.4.1" class="ltx_td ltx_align_left">CLIMB</td>
<td id="A1.T5.9.9.14.4.2" class="ltx_td ltx_align_center">90.09</td>
<td id="A1.T5.9.9.14.4.3" class="ltx_td ltx_align_center">81.49</td>
<td id="A1.T5.9.9.14.4.4" class="ltx_td ltx_align_center">74.58</td>
<td id="A1.T5.9.9.14.4.5" class="ltx_td ltx_align_center">54.45</td>
<td id="A1.T5.9.9.14.4.6" class="ltx_td ltx_align_center">23.90</td>
<td id="A1.T5.9.9.14.4.7" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.14.4.7.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>4.14</td>
<td id="A1.T5.9.9.14.4.8" class="ltx_td ltx_align_center">29.85</td>
<td id="A1.T5.9.9.14.4.9" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.14.4.9.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>8.37</td>
<td id="A1.T5.9.9.14.4.10" class="ltx_td ltx_align_center">
<span id="A1.T5.9.9.14.4.10.1" class="ltx_text ltx_phantom"><span style="visibility:hidden">0</span></span>4.97</td>
</tr>
<tr id="A1.T5.9.9.15.5" class="ltx_tr">
<td id="A1.T5.9.9.15.5.1" class="ltx_td ltx_align_left">CReFF</td>
<td id="A1.T5.9.9.15.5.2" class="ltx_td ltx_align_center">92.87</td>
<td id="A1.T5.9.9.15.5.3" class="ltx_td ltx_align_center">88.94</td>
<td id="A1.T5.9.9.15.5.4" class="ltx_td ltx_align_center">83.75</td>
<td id="A1.T5.9.9.15.5.5" class="ltx_td ltx_align_center">74.81</td>
<td id="A1.T5.9.9.15.5.6" class="ltx_td ltx_align_center">62.67</td>
<td id="A1.T5.9.9.15.5.7" class="ltx_td ltx_align_center"><span id="A1.T5.9.9.15.5.7.1" class="ltx_text ltx_font_bold">45.30</span></td>
<td id="A1.T5.9.9.15.5.8" class="ltx_td ltx_align_center">34.38</td>
<td id="A1.T5.9.9.15.5.9" class="ltx_td ltx_align_center">17.46</td>
<td id="A1.T5.9.9.15.5.10" class="ltx_td ltx_align_center"><span id="A1.T5.9.9.15.5.10.1" class="ltx_text ltx_font_bold">16.58</span></td>
</tr>
<tr id="A1.T5.9.9.16.6" class="ltx_tr">
<td id="A1.T5.9.9.16.6.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Ours</td>
<td id="A1.T5.9.9.16.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T5.9.9.16.6.2.1" class="ltx_text ltx_font_bold">94.82</span></td>
<td id="A1.T5.9.9.16.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T5.9.9.16.6.3.1" class="ltx_text ltx_font_bold">90.06</span></td>
<td id="A1.T5.9.9.16.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T5.9.9.16.6.4.1" class="ltx_text ltx_font_bold">86.38</span></td>
<td id="A1.T5.9.9.16.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T5.9.9.16.6.5.1" class="ltx_text ltx_font_bold">75.71</span></td>
<td id="A1.T5.9.9.16.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T5.9.9.16.6.6.1" class="ltx_text ltx_font_bold">63.58</span></td>
<td id="A1.T5.9.9.16.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">43.92</td>
<td id="A1.T5.9.9.16.6.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T5.9.9.16.6.8.1" class="ltx_text ltx_font_bold">35.34</span></td>
<td id="A1.T5.9.9.16.6.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A1.T5.9.9.16.6.9.1" class="ltx_text ltx_font_bold">17.91</span></td>
<td id="A1.T5.9.9.16.6.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">13.39</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Averaged evaluation accuracy on the tail classes under the <span id="A1.T5.11.1" class="ltx_text ltx_font_bold">partial client participation</span> setting in main experiments.</figcaption>
</figure>
</section>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Results on The Tail Classes in Main Experiments</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">In our main paper, we put the results of the overall accuracy on the balanced testing sets of each method, and we have that <span id="A2.p1.1.1" class="ltx_text ltx_font_bold">our method consistently outperform all other methods in all settings.</span> Here, we put the averaged accuracy on the tail classes of each method. Specifically, we define the tail classes as the last 30% classes the minimum sample quantity.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">The results are in Table <a href="#A1.T4" title="Table 4 ‣ Code and Infrastructure ‣ A.2 Complete Training Details ‣ Appendix A Detailed Experimental Settings ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and Table <a href="#A1.T5" title="Table 5 ‣ Code and Infrastructure ‣ A.2 Complete Training Details ‣ Appendix A Detailed Experimental Settings ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. As we can see, <span id="A2.p2.1.1" class="ltx_text ltx_font_bold">our method brings significant improvement on the tail classes in most cases.</span> Also, we find that CReFF tends to achieve better performance on the tail classes when the imbalance degree is larger. However, the performance of CReFF on the overall testing sets is worse than our method according to the results in our main paper. This partly validates our analysis that, re-training the classifier on a set number of federated features on the server can indeed re-balance the classifier to some extent, but it is likely to produce a sub-optimal classifier that overfits on these limited number of pseudo features.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experiments on Different Non-I.I.D. Degrees</h2>

<figure id="A3.T6" class="ltx_table">
<table id="A3.T6.9.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T6.9.9.10.1" class="ltx_tr">
<th id="A3.T6.9.9.10.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="A3.T6.9.9.10.1.1.1" class="ltx_text">
<span id="A3.T6.9.9.10.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A3.T6.9.9.10.1.1.1.1.1" class="ltx_tr">
<span id="A3.T6.9.9.10.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Method</span></span>
</span></span></th>
<th id="A3.T6.9.9.10.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">MNIST-LT</th>
<th id="A3.T6.9.9.10.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-10-LT</th>
<th id="A3.T6.9.9.10.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3">CIFAR-100-LT</th>
</tr>
<tr id="A3.T6.9.9.9" class="ltx_tr">
<th id="A3.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A3.T6.1.1.1.1.m1.1a"><mrow id="A3.T6.1.1.1.1.m1.1.1" xref="A3.T6.1.1.1.1.m1.1.1.cmml"><mi id="A3.T6.1.1.1.1.m1.1.1.2" xref="A3.T6.1.1.1.1.m1.1.1.2.cmml">α</mi><mo id="A3.T6.1.1.1.1.m1.1.1.1" xref="A3.T6.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A3.T6.1.1.1.1.m1.1.1.3" xref="A3.T6.1.1.1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.1.1.1.1.m1.1b"><apply id="A3.T6.1.1.1.1.m1.1.1.cmml" xref="A3.T6.1.1.1.1.m1.1.1"><eq id="A3.T6.1.1.1.1.m1.1.1.1.cmml" xref="A3.T6.1.1.1.1.m1.1.1.1"></eq><ci id="A3.T6.1.1.1.1.m1.1.1.2.cmml" xref="A3.T6.1.1.1.1.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.1.1.1.1.m1.1.1.3.cmml" xref="A3.T6.1.1.1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.1.1.1.1.m1.1c">\alpha=0.1</annotation></semantics></math></th>
<th id="A3.T6.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.2.2.2.2.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.T6.2.2.2.2.m1.1a"><mrow id="A3.T6.2.2.2.2.m1.1.1" xref="A3.T6.2.2.2.2.m1.1.1.cmml"><mi id="A3.T6.2.2.2.2.m1.1.1.2" xref="A3.T6.2.2.2.2.m1.1.1.2.cmml">α</mi><mo id="A3.T6.2.2.2.2.m1.1.1.1" xref="A3.T6.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="A3.T6.2.2.2.2.m1.1.1.3" xref="A3.T6.2.2.2.2.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.2.2.2.2.m1.1b"><apply id="A3.T6.2.2.2.2.m1.1.1.cmml" xref="A3.T6.2.2.2.2.m1.1.1"><eq id="A3.T6.2.2.2.2.m1.1.1.1.cmml" xref="A3.T6.2.2.2.2.m1.1.1.1"></eq><ci id="A3.T6.2.2.2.2.m1.1.1.2.cmml" xref="A3.T6.2.2.2.2.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.2.2.2.2.m1.1.1.3.cmml" xref="A3.T6.2.2.2.2.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.2.2.2.2.m1.1c">\alpha=1.0</annotation></semantics></math></th>
<th id="A3.T6.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.3.3.3.3.m1.1" class="ltx_Math" alttext="\alpha=10.0" display="inline"><semantics id="A3.T6.3.3.3.3.m1.1a"><mrow id="A3.T6.3.3.3.3.m1.1.1" xref="A3.T6.3.3.3.3.m1.1.1.cmml"><mi id="A3.T6.3.3.3.3.m1.1.1.2" xref="A3.T6.3.3.3.3.m1.1.1.2.cmml">α</mi><mo id="A3.T6.3.3.3.3.m1.1.1.1" xref="A3.T6.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="A3.T6.3.3.3.3.m1.1.1.3" xref="A3.T6.3.3.3.3.m1.1.1.3.cmml">10.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.3.3.3.3.m1.1b"><apply id="A3.T6.3.3.3.3.m1.1.1.cmml" xref="A3.T6.3.3.3.3.m1.1.1"><eq id="A3.T6.3.3.3.3.m1.1.1.1.cmml" xref="A3.T6.3.3.3.3.m1.1.1.1"></eq><ci id="A3.T6.3.3.3.3.m1.1.1.2.cmml" xref="A3.T6.3.3.3.3.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.3.3.3.3.m1.1.1.3.cmml" xref="A3.T6.3.3.3.3.m1.1.1.3">10.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.3.3.3.3.m1.1c">\alpha=10.0</annotation></semantics></math></th>
<th id="A3.T6.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.4.4.4.4.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A3.T6.4.4.4.4.m1.1a"><mrow id="A3.T6.4.4.4.4.m1.1.1" xref="A3.T6.4.4.4.4.m1.1.1.cmml"><mi id="A3.T6.4.4.4.4.m1.1.1.2" xref="A3.T6.4.4.4.4.m1.1.1.2.cmml">α</mi><mo id="A3.T6.4.4.4.4.m1.1.1.1" xref="A3.T6.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="A3.T6.4.4.4.4.m1.1.1.3" xref="A3.T6.4.4.4.4.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.4.4.4.4.m1.1b"><apply id="A3.T6.4.4.4.4.m1.1.1.cmml" xref="A3.T6.4.4.4.4.m1.1.1"><eq id="A3.T6.4.4.4.4.m1.1.1.1.cmml" xref="A3.T6.4.4.4.4.m1.1.1.1"></eq><ci id="A3.T6.4.4.4.4.m1.1.1.2.cmml" xref="A3.T6.4.4.4.4.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.4.4.4.4.m1.1.1.3.cmml" xref="A3.T6.4.4.4.4.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.4.4.4.4.m1.1c">\alpha=0.1</annotation></semantics></math></th>
<th id="A3.T6.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.5.5.5.5.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.T6.5.5.5.5.m1.1a"><mrow id="A3.T6.5.5.5.5.m1.1.1" xref="A3.T6.5.5.5.5.m1.1.1.cmml"><mi id="A3.T6.5.5.5.5.m1.1.1.2" xref="A3.T6.5.5.5.5.m1.1.1.2.cmml">α</mi><mo id="A3.T6.5.5.5.5.m1.1.1.1" xref="A3.T6.5.5.5.5.m1.1.1.1.cmml">=</mo><mn id="A3.T6.5.5.5.5.m1.1.1.3" xref="A3.T6.5.5.5.5.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.5.5.5.5.m1.1b"><apply id="A3.T6.5.5.5.5.m1.1.1.cmml" xref="A3.T6.5.5.5.5.m1.1.1"><eq id="A3.T6.5.5.5.5.m1.1.1.1.cmml" xref="A3.T6.5.5.5.5.m1.1.1.1"></eq><ci id="A3.T6.5.5.5.5.m1.1.1.2.cmml" xref="A3.T6.5.5.5.5.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.5.5.5.5.m1.1.1.3.cmml" xref="A3.T6.5.5.5.5.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.5.5.5.5.m1.1c">\alpha=1.0</annotation></semantics></math></th>
<th id="A3.T6.6.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.6.6.6.6.m1.1" class="ltx_Math" alttext="\alpha=10.0" display="inline"><semantics id="A3.T6.6.6.6.6.m1.1a"><mrow id="A3.T6.6.6.6.6.m1.1.1" xref="A3.T6.6.6.6.6.m1.1.1.cmml"><mi id="A3.T6.6.6.6.6.m1.1.1.2" xref="A3.T6.6.6.6.6.m1.1.1.2.cmml">α</mi><mo id="A3.T6.6.6.6.6.m1.1.1.1" xref="A3.T6.6.6.6.6.m1.1.1.1.cmml">=</mo><mn id="A3.T6.6.6.6.6.m1.1.1.3" xref="A3.T6.6.6.6.6.m1.1.1.3.cmml">10.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.6.6.6.6.m1.1b"><apply id="A3.T6.6.6.6.6.m1.1.1.cmml" xref="A3.T6.6.6.6.6.m1.1.1"><eq id="A3.T6.6.6.6.6.m1.1.1.1.cmml" xref="A3.T6.6.6.6.6.m1.1.1.1"></eq><ci id="A3.T6.6.6.6.6.m1.1.1.2.cmml" xref="A3.T6.6.6.6.6.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.6.6.6.6.m1.1.1.3.cmml" xref="A3.T6.6.6.6.6.m1.1.1.3">10.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.6.6.6.6.m1.1c">\alpha=10.0</annotation></semantics></math></th>
<th id="A3.T6.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.7.7.7.7.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A3.T6.7.7.7.7.m1.1a"><mrow id="A3.T6.7.7.7.7.m1.1.1" xref="A3.T6.7.7.7.7.m1.1.1.cmml"><mi id="A3.T6.7.7.7.7.m1.1.1.2" xref="A3.T6.7.7.7.7.m1.1.1.2.cmml">α</mi><mo id="A3.T6.7.7.7.7.m1.1.1.1" xref="A3.T6.7.7.7.7.m1.1.1.1.cmml">=</mo><mn id="A3.T6.7.7.7.7.m1.1.1.3" xref="A3.T6.7.7.7.7.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.7.7.7.7.m1.1b"><apply id="A3.T6.7.7.7.7.m1.1.1.cmml" xref="A3.T6.7.7.7.7.m1.1.1"><eq id="A3.T6.7.7.7.7.m1.1.1.1.cmml" xref="A3.T6.7.7.7.7.m1.1.1.1"></eq><ci id="A3.T6.7.7.7.7.m1.1.1.2.cmml" xref="A3.T6.7.7.7.7.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.7.7.7.7.m1.1.1.3.cmml" xref="A3.T6.7.7.7.7.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.7.7.7.7.m1.1c">\alpha=0.1</annotation></semantics></math></th>
<th id="A3.T6.8.8.8.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.8.8.8.8.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.T6.8.8.8.8.m1.1a"><mrow id="A3.T6.8.8.8.8.m1.1.1" xref="A3.T6.8.8.8.8.m1.1.1.cmml"><mi id="A3.T6.8.8.8.8.m1.1.1.2" xref="A3.T6.8.8.8.8.m1.1.1.2.cmml">α</mi><mo id="A3.T6.8.8.8.8.m1.1.1.1" xref="A3.T6.8.8.8.8.m1.1.1.1.cmml">=</mo><mn id="A3.T6.8.8.8.8.m1.1.1.3" xref="A3.T6.8.8.8.8.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.8.8.8.8.m1.1b"><apply id="A3.T6.8.8.8.8.m1.1.1.cmml" xref="A3.T6.8.8.8.8.m1.1.1"><eq id="A3.T6.8.8.8.8.m1.1.1.1.cmml" xref="A3.T6.8.8.8.8.m1.1.1.1"></eq><ci id="A3.T6.8.8.8.8.m1.1.1.2.cmml" xref="A3.T6.8.8.8.8.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.8.8.8.8.m1.1.1.3.cmml" xref="A3.T6.8.8.8.8.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.8.8.8.8.m1.1c">\alpha=1.0</annotation></semantics></math></th>
<th id="A3.T6.9.9.9.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="A3.T6.9.9.9.9.m1.1" class="ltx_Math" alttext="\alpha=10.0" display="inline"><semantics id="A3.T6.9.9.9.9.m1.1a"><mrow id="A3.T6.9.9.9.9.m1.1.1" xref="A3.T6.9.9.9.9.m1.1.1.cmml"><mi id="A3.T6.9.9.9.9.m1.1.1.2" xref="A3.T6.9.9.9.9.m1.1.1.2.cmml">α</mi><mo id="A3.T6.9.9.9.9.m1.1.1.1" xref="A3.T6.9.9.9.9.m1.1.1.1.cmml">=</mo><mn id="A3.T6.9.9.9.9.m1.1.1.3" xref="A3.T6.9.9.9.9.m1.1.1.3.cmml">10.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T6.9.9.9.9.m1.1b"><apply id="A3.T6.9.9.9.9.m1.1.1.cmml" xref="A3.T6.9.9.9.9.m1.1.1"><eq id="A3.T6.9.9.9.9.m1.1.1.1.cmml" xref="A3.T6.9.9.9.9.m1.1.1.1"></eq><ci id="A3.T6.9.9.9.9.m1.1.1.2.cmml" xref="A3.T6.9.9.9.9.m1.1.1.2">𝛼</ci><cn type="float" id="A3.T6.9.9.9.9.m1.1.1.3.cmml" xref="A3.T6.9.9.9.9.m1.1.1.3">10.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T6.9.9.9.9.m1.1c">\alpha=10.0</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T6.9.9.11.1" class="ltx_tr">
<th id="A3.T6.9.9.11.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg+CE</th>
<td id="A3.T6.9.9.11.1.2" class="ltx_td ltx_align_center ltx_border_t">93.42</td>
<td id="A3.T6.9.9.11.1.3" class="ltx_td ltx_align_center ltx_border_t">92.71</td>
<td id="A3.T6.9.9.11.1.4" class="ltx_td ltx_align_center ltx_border_t">94.09</td>
<td id="A3.T6.9.9.11.1.5" class="ltx_td ltx_align_center ltx_border_t">59.46</td>
<td id="A3.T6.9.9.11.1.6" class="ltx_td ltx_align_center ltx_border_t">59.83</td>
<td id="A3.T6.9.9.11.1.7" class="ltx_td ltx_align_center ltx_border_t">63.01</td>
<td id="A3.T6.9.9.11.1.8" class="ltx_td ltx_align_center ltx_border_t">31.18</td>
<td id="A3.T6.9.9.11.1.9" class="ltx_td ltx_align_center ltx_border_t">33.28</td>
<td id="A3.T6.9.9.11.1.10" class="ltx_td ltx_align_center ltx_border_t">31.74</td>
</tr>
<tr id="A3.T6.9.9.12.2" class="ltx_tr">
<th id="A3.T6.9.9.12.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Fed-Focal Loss</th>
<td id="A3.T6.9.9.12.2.2" class="ltx_td ltx_align_center">94.16</td>
<td id="A3.T6.9.9.12.2.3" class="ltx_td ltx_align_center">92.97</td>
<td id="A3.T6.9.9.12.2.4" class="ltx_td ltx_align_center">94.21</td>
<td id="A3.T6.9.9.12.2.5" class="ltx_td ltx_align_center">53.47</td>
<td id="A3.T6.9.9.12.2.6" class="ltx_td ltx_align_center">59.86</td>
<td id="A3.T6.9.9.12.2.7" class="ltx_td ltx_align_center">61.06</td>
<td id="A3.T6.9.9.12.2.8" class="ltx_td ltx_align_center">31.72</td>
<td id="A3.T6.9.9.12.2.9" class="ltx_td ltx_align_center">30.05</td>
<td id="A3.T6.9.9.12.2.10" class="ltx_td ltx_align_center">30.18</td>
</tr>
<tr id="A3.T6.9.9.13.3" class="ltx_tr">
<th id="A3.T6.9.9.13.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Ratio Loss</th>
<td id="A3.T6.9.9.13.3.2" class="ltx_td ltx_align_center">93.50</td>
<td id="A3.T6.9.9.13.3.3" class="ltx_td ltx_align_center">92.99</td>
<td id="A3.T6.9.9.13.3.4" class="ltx_td ltx_align_center">94.34</td>
<td id="A3.T6.9.9.13.3.5" class="ltx_td ltx_align_center">59.30</td>
<td id="A3.T6.9.9.13.3.6" class="ltx_td ltx_align_center">59.27</td>
<td id="A3.T6.9.9.13.3.7" class="ltx_td ltx_align_center">61.82</td>
<td id="A3.T6.9.9.13.3.8" class="ltx_td ltx_align_center">32.60</td>
<td id="A3.T6.9.9.13.3.9" class="ltx_td ltx_align_center">31.92</td>
<td id="A3.T6.9.9.13.3.10" class="ltx_td ltx_align_center">31.93</td>
</tr>
<tr id="A3.T6.9.9.14.4" class="ltx_tr">
<th id="A3.T6.9.9.14.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CLIMB</th>
<td id="A3.T6.9.9.14.4.2" class="ltx_td ltx_align_center">93.80</td>
<td id="A3.T6.9.9.14.4.3" class="ltx_td ltx_align_center">92.71</td>
<td id="A3.T6.9.9.14.4.4" class="ltx_td ltx_align_center">94.23</td>
<td id="A3.T6.9.9.14.4.5" class="ltx_td ltx_align_center">61.10</td>
<td id="A3.T6.9.9.14.4.6" class="ltx_td ltx_align_center">57.67</td>
<td id="A3.T6.9.9.14.4.7" class="ltx_td ltx_align_center">61.46</td>
<td id="A3.T6.9.9.14.4.8" class="ltx_td ltx_align_center">31.64</td>
<td id="A3.T6.9.9.14.4.9" class="ltx_td ltx_align_center">32.18</td>
<td id="A3.T6.9.9.14.4.10" class="ltx_td ltx_align_center">32.45</td>
</tr>
<tr id="A3.T6.9.9.15.5" class="ltx_tr">
<th id="A3.T6.9.9.15.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">CReFF</th>
<td id="A3.T6.9.9.15.5.2" class="ltx_td ltx_align_center">93.94</td>
<td id="A3.T6.9.9.15.5.3" class="ltx_td ltx_align_center">93.85</td>
<td id="A3.T6.9.9.15.5.4" class="ltx_td ltx_align_center">94.76</td>
<td id="A3.T6.9.9.15.5.5" class="ltx_td ltx_align_center">63.25</td>
<td id="A3.T6.9.9.15.5.6" class="ltx_td ltx_align_center">69.36</td>
<td id="A3.T6.9.9.15.5.7" class="ltx_td ltx_align_center">70.30</td>
<td id="A3.T6.9.9.15.5.8" class="ltx_td ltx_align_center">32.20</td>
<td id="A3.T6.9.9.15.5.9" class="ltx_td ltx_align_center">33.46</td>
<td id="A3.T6.9.9.15.5.10" class="ltx_td ltx_align_center">31.60</td>
</tr>
<tr id="A3.T6.9.9.16.6" class="ltx_tr">
<th id="A3.T6.9.9.16.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">Ours</th>
<td id="A3.T6.9.9.16.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.2.1" class="ltx_text ltx_font_bold">95.34</span></td>
<td id="A3.T6.9.9.16.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.3.1" class="ltx_text ltx_font_bold">95.73</span></td>
<td id="A3.T6.9.9.16.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.4.1" class="ltx_text ltx_font_bold">95.93</span></td>
<td id="A3.T6.9.9.16.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.5.1" class="ltx_text ltx_font_bold">64.30</span></td>
<td id="A3.T6.9.9.16.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.6.1" class="ltx_text ltx_font_bold">71.04</span></td>
<td id="A3.T6.9.9.16.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.7.1" class="ltx_text ltx_font_bold">71.82</span></td>
<td id="A3.T6.9.9.16.6.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.8.1" class="ltx_text ltx_font_bold">32.86</span></td>
<td id="A3.T6.9.9.16.6.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.9.1" class="ltx_text ltx_font_bold">34.63</span></td>
<td id="A3.T6.9.9.16.6.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="A3.T6.9.9.16.6.10.1" class="ltx_text ltx_font_bold">34.42</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>The overall accuracy on the balanced testing sets under different non-i.i.d. degrees. Our method consistently outperforms all baselines.</figcaption>
</figure>
<div id="A3.p1" class="ltx_para">
<p id="A3.p1.4" class="ltx_p">In our main experiments, we fix the non-i.i.d. degree <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.p1.1.m1.1a"><mrow id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml"><mi id="A3.p1.1.m1.1.1.2" xref="A3.p1.1.m1.1.1.2.cmml">α</mi><mo id="A3.p1.1.m1.1.1.1" xref="A3.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.p1.1.m1.1.1.3" xref="A3.p1.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><apply id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1"><eq id="A3.p1.1.m1.1.1.1.cmml" xref="A3.p1.1.m1.1.1.1"></eq><ci id="A3.p1.1.m1.1.1.2.cmml" xref="A3.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="A3.p1.1.m1.1.1.3.cmml" xref="A3.p1.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">\alpha=1.0</annotation></semantics></math>, in order to mainly explore the effects of different imbalance degrees. Here, we conduct extra experiments with <math id="A3.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A3.p1.2.m2.1a"><mrow id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml"><mi id="A3.p1.2.m2.1.1.2" xref="A3.p1.2.m2.1.1.2.cmml">α</mi><mo id="A3.p1.2.m2.1.1.1" xref="A3.p1.2.m2.1.1.1.cmml">=</mo><mn id="A3.p1.2.m2.1.1.3" xref="A3.p1.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><apply id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1"><eq id="A3.p1.2.m2.1.1.1.cmml" xref="A3.p1.2.m2.1.1.1"></eq><ci id="A3.p1.2.m2.1.1.2.cmml" xref="A3.p1.2.m2.1.1.2">𝛼</ci><cn type="float" id="A3.p1.2.m2.1.1.3.cmml" xref="A3.p1.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">\alpha=0.1</annotation></semantics></math> and <math id="A3.p1.3.m3.1" class="ltx_Math" alttext="\alpha=10.0" display="inline"><semantics id="A3.p1.3.m3.1a"><mrow id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml"><mi id="A3.p1.3.m3.1.1.2" xref="A3.p1.3.m3.1.1.2.cmml">α</mi><mo id="A3.p1.3.m3.1.1.1" xref="A3.p1.3.m3.1.1.1.cmml">=</mo><mn id="A3.p1.3.m3.1.1.3" xref="A3.p1.3.m3.1.1.3.cmml">10.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><apply id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1"><eq id="A3.p1.3.m3.1.1.1.cmml" xref="A3.p1.3.m3.1.1.1"></eq><ci id="A3.p1.3.m3.1.1.2.cmml" xref="A3.p1.3.m3.1.1.2">𝛼</ci><cn type="float" id="A3.p1.3.m3.1.1.3.cmml" xref="A3.p1.3.m3.1.1.3">10.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">\alpha=10.0</annotation></semantics></math>, and fix the imbalance ratio <math id="A3.p1.4.m4.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="A3.p1.4.m4.1a"><mrow id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml"><mtext id="A3.p1.4.m4.1.1.2" xref="A3.p1.4.m4.1.1.2a.cmml">IR</mtext><mo id="A3.p1.4.m4.1.1.1" xref="A3.p1.4.m4.1.1.1.cmml">=</mo><mn id="A3.p1.4.m4.1.1.3" xref="A3.p1.4.m4.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><apply id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1"><eq id="A3.p1.4.m4.1.1.1.cmml" xref="A3.p1.4.m4.1.1.1"></eq><ci id="A3.p1.4.m4.1.1.2a.cmml" xref="A3.p1.4.m4.1.1.2"><mtext id="A3.p1.4.m4.1.1.2.cmml" xref="A3.p1.4.m4.1.1.2">IR</mtext></ci><cn type="integer" id="A3.p1.4.m4.1.1.3.cmml" xref="A3.p1.4.m4.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">\text{IR}=100</annotation></semantics></math>. We conduct experiment on MNIST-LT and CIFAR-10 under the full client participation setting, and other experimental settings are kept as the same as that in our main experiments.</p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.1" class="ltx_p">We put the results in Table <a href="#A3.T6" title="Table 6 ‣ Appendix C Experiments on Different Non-I.I.D. Degrees ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. We can draw the main conclusion from the table that, <span id="A3.p2.1.1" class="ltx_text ltx_font_bold">our method can achieve the best performance under different non-i.i.d. degrees</span>.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Explorations on The Role of The Additional Global Classifier</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.5" class="ltx_p">As we discussed in Section <a href="#S3.SS2" title="3.2 Our Optimization Target ‣ 3 Methodology ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, in order to address the issue of the contradictory optimization goals on updating <math id="A4.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="A4.p1.1.m1.1a"><mi id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><ci id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">\boldsymbol{W}</annotation></semantics></math> caused by re-balancing the classifier during local training, we add an extra classifier <math id="A4.p1.2.m2.1" class="ltx_Math" alttext="\widehat{\boldsymbol{W}}" display="inline"><semantics id="A4.p1.2.m2.1a"><mover accent="true" id="A4.p1.2.m2.1.1" xref="A4.p1.2.m2.1.1.cmml"><mi id="A4.p1.2.m2.1.1.2" xref="A4.p1.2.m2.1.1.2.cmml">𝑾</mi><mo id="A4.p1.2.m2.1.1.1" xref="A4.p1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.1b"><apply id="A4.p1.2.m2.1.1.cmml" xref="A4.p1.2.m2.1.1"><ci id="A4.p1.2.m2.1.1.1.cmml" xref="A4.p1.2.m2.1.1.1">^</ci><ci id="A4.p1.2.m2.1.1.2.cmml" xref="A4.p1.2.m2.1.1.2">𝑾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.1c">\widehat{\boldsymbol{W}}</annotation></semantics></math> to help model the global data distribution and make re-balancing <math id="A4.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{W}" display="inline"><semantics id="A4.p1.3.m3.1a"><mi id="A4.p1.3.m3.1.1" xref="A4.p1.3.m3.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.1b"><ci id="A4.p1.3.m3.1.1.cmml" xref="A4.p1.3.m3.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.1c">\boldsymbol{W}</annotation></semantics></math> possible. Here, we want to draw comparisons between our proposed two-stream classifier architecture and using one classifier only through experiments on CIFAR-10/100-LT datasets (<math id="A4.p1.4.m4.1" class="ltx_Math" alttext="\text{IR}=100" display="inline"><semantics id="A4.p1.4.m4.1a"><mrow id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml"><mtext id="A4.p1.4.m4.1.1.2" xref="A4.p1.4.m4.1.1.2a.cmml">IR</mtext><mo id="A4.p1.4.m4.1.1.1" xref="A4.p1.4.m4.1.1.1.cmml">=</mo><mn id="A4.p1.4.m4.1.1.3" xref="A4.p1.4.m4.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><apply id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1"><eq id="A4.p1.4.m4.1.1.1.cmml" xref="A4.p1.4.m4.1.1.1"></eq><ci id="A4.p1.4.m4.1.1.2a.cmml" xref="A4.p1.4.m4.1.1.2"><mtext id="A4.p1.4.m4.1.1.2.cmml" xref="A4.p1.4.m4.1.1.2">IR</mtext></ci><cn type="integer" id="A4.p1.4.m4.1.1.3.cmml" xref="A4.p1.4.m4.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">\text{IR}=100</annotation></semantics></math>, <math id="A4.p1.5.m5.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A4.p1.5.m5.1a"><mrow id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml"><mi id="A4.p1.5.m5.1.1.2" xref="A4.p1.5.m5.1.1.2.cmml">α</mi><mo id="A4.p1.5.m5.1.1.1" xref="A4.p1.5.m5.1.1.1.cmml">=</mo><mn id="A4.p1.5.m5.1.1.3" xref="A4.p1.5.m5.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.1b"><apply id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1"><eq id="A4.p1.5.m5.1.1.1.cmml" xref="A4.p1.5.m5.1.1.1"></eq><ci id="A4.p1.5.m5.1.1.2.cmml" xref="A4.p1.5.m5.1.1.2">𝛼</ci><cn type="float" id="A4.p1.5.m5.1.1.3.cmml" xref="A4.p1.5.m5.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.1c">\alpha=1.0</annotation></semantics></math>) under the full client participation situation. The results in the partial client participation setting are similar.</p>
</div>
<div id="A4.p2" class="ltx_para">
<p id="A4.p2.1" class="ltx_p">The results are displayed in Figure <a href="#A4.F5" title="Figure 5 ‣ Appendix D Explorations on The Role of The Additional Global Classifier ‣ Integrating Local Real Data with Global Gradient Prototypes for Classifier Re-Balancing in Federated Long-Tailed Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We observe that if we do not add the extra classifier in the training phase, the model will converge to a bad local optimum and behave much worse than that if we adopt the two-stream classifier architecture. <span id="A4.p2.1.1" class="ltx_text ltx_font_bold">This helps to validate our motivation and the great effectiveness of introducing a new global classifier to address the optimization difficulty brought by the local classifier re-balancing practice.</span></p>
</div>
<figure id="A4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="A4.F5.sf1.1.1" class="ltx_p ltx_minipage ltx_align_top" style="width:208.1pt;"><span id="A4.F5.sf1.1.1.1" class="ltx_text"><img src="/html/2301.10394/assets/x5.png" id="A4.F5.sf1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="247" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A4.F5.sf1.3.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="A4.F5.sf1.4.2" class="ltx_text" style="font-size:80%;">Results on CIFAR-10-LT.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="A4.F5.sf2.1.1" class="ltx_p ltx_minipage ltx_align_top" style="width:208.1pt;"><span id="A4.F5.sf2.1.1.1" class="ltx_text"><img src="/html/2301.10394/assets/x6.png" id="A4.F5.sf2.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="247" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A4.F5.sf2.3.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="A4.F5.sf2.4.2" class="ltx_text" style="font-size:80%;">Results on CIFAR-100-LT.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The positive effect of adding an extra classifier in the training phase to help model the global data distribution when locally re-balancing the classifier by our method.</figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2301.10393" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2301.10394" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2301.10394">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2301.10394" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2301.10395" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 05:45:54 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
