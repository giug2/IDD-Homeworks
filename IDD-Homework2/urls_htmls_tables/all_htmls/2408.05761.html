<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2408.05761] Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas</title><meta property="og:description" content="The increasing generation of data in different areas of life, such as the environment, highlights the need to explore new techniques for processing and exploiting data for useful purposes. In this context, artificial i…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2408.05761">

<!--Generated on Thu Sep  5 16:58:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p">[1]Judith Sáinz-Pardo Díaz</p>
</div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p">1]<span id="p2.1.1" class="ltx_ERROR undefined">\orgname</span>Instituto de Física de Cantabria (IFCA), CSIC-UC., <span id="p2.1.2" class="ltx_ERROR undefined">\orgaddress</span><span id="p2.1.3" class="ltx_ERROR undefined">\street</span>Avda. los Castros s/n., <span id="p2.1.4" class="ltx_ERROR undefined">\city</span>Santander, <span id="p2.1.5" class="ltx_ERROR undefined">\postcode</span>39005, <span id="p2.1.6" class="ltx_ERROR undefined">\country</span>Spain</p>
</div>
<div id="p3" class="ltx_para">
<p id="p3.1" class="ltx_p">2]<span id="p3.1.1" class="ltx_ERROR undefined">\orgname</span>MicroStep-MIS, <span id="p3.1.2" class="ltx_ERROR undefined">\orgaddress</span><span id="p3.1.3" class="ltx_ERROR undefined">\street</span>Čavojského 1, <span id="p3.1.4" class="ltx_ERROR undefined">\city</span>Bratislava, <span id="p3.1.5" class="ltx_ERROR undefined">\postcode</span>841 04, <span id="p3.1.6" class="ltx_ERROR undefined">\country</span>Slovakia</p>
</div>
<div id="p4" class="ltx_para">
<p id="p4.1" class="ltx_p">3]<span id="p4.1.1" class="ltx_ERROR undefined">\orgdiv</span>Scientific Computing Center (SCC), <span id="p4.1.2" class="ltx_ERROR undefined">\orgname</span>Karlsruhe Institute of Technology (KIT), <span id="p4.1.3" class="ltx_ERROR undefined">\orgaddress</span><span id="p4.1.4" class="ltx_ERROR undefined">\city</span>Karlsruhe, <span id="p4.1.5" class="ltx_ERROR undefined">\country</span>Germany</p>
</div>
<h1 class="ltx_title ltx_title_document">Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:sainzpardo@ifca.unican.es">sainzpardo@ifca.unican.es</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">María Castrillo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:castrillo@ifca.unican.es">castrillo@ifca.unican.es</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Juraj Bartok
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:juraj.bartok@microstep-mis.com">juraj.bartok@microstep-mis.com</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ignacio Heredia Cachá
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:iheredia@ifca.unican.es">iheredia@ifca.unican.es</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Irina Malkin Ondík
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:irina.malkin.ondik@microstep-mis.com">irina.malkin.ondik@microstep-mis.com</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ivan Martynovskyi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ivan.martynovskyi@microstep-mis.com">ivan.martynovskyi@microstep-mis.com</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Khadijeh Alibabaei
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:khadijeh.alibabaei@kit.edu">khadijeh.alibabaei@kit.edu</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lisana Berberi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:lisana.berberi@kit.edu">lisana.berberi@kit.edu</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Valentin Kozlov
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:valentin.kozlov@kit.edu">valentin.kozlov@kit.edu</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Álvaro López García
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:aloga@ifca.unican.es">aloga@ifca.unican.es</a>
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">0</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">0</sup><span class="ltx_note_type">footnotetext: </span><span id="footnotex1.1" class="ltx_text ltx_font_italic">Accepted for publication in Earth Science Informatics</span></span></span></span>
<p id="id1.id1" class="ltx_p">The increasing generation of data in different areas of life, such as the environment, highlights the need to explore new techniques for processing and exploiting data for useful purposes. In this context, artificial intelligence techniques, especially through deep learning models, are key tools to be used on the large amount of data that can be obtained, for example, from weather radars. In many cases, the information collected by these radars is not open, or belongs to different institutions, thus needing to deal with the distributed nature of this data. In this work, the applicability of a personalized federated learning architecture, which has been called <span id="id1.id1.1" class="ltx_text ltx_font_italic">adapFL</span>, on distributed weather radar images is addressed. To this end, given a single available radar covering 400 km in diameter, the captured images are divided in such a way that they are disjointly distributed into four different federated clients. The results obtained with <span id="id1.id1.2" class="ltx_text ltx_font_italic">adapFL</span> are analyzed in each zone, as well as in a central area covering part of the surface of each of the previously distributed areas. The ultimate goal of this work is to study the generalization capability of this type of learning technique for its extrapolation to use cases in which a representative number of radars is available, whose data can not be centralized due to technical, legal or administrative concerns. The results of this preliminary study indicate that the performance obtained in each zone with the <span id="id1.id1.3" class="ltx_text ltx_font_italic">adapFL</span> approach allows improving the results of the federated learning approach, the individual deep learning models and the classical Continuity Tracking Radar Echoes by Correlation approach.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>Federated learning, deep learning, meteorology, radar images
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction and motivation</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Privacy issues and legal restrictions that apply to the field of images and their processing through machine and deep learning (ML and DL) models are clear, for example, in the medical field, where it is essential to preserve the privacy of patients. In this case, it happens that in many cases the images taken in a certain center, such as a hospital, cannot be centralized together with images taken by other institutions. However, this problem regarding data centralization can be due to other reasons and in other areas, such as those related to data storage capacity, connectivity restrictions, or even a lack of computational resources that prevent the training of models on large amounts of data, making decentralization more convenient. In this context, federated learning (FL) architectures allow training ML/DL models in a distributed way, without having to centralize the data in a central server <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. These architectures achieve robustness by aggregating models trained individually by each data owner or client.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">This work is focused on images captured by weather radars. Nowadays, there is an increasing demand for weather forecasts with high spatial accuracy, which is boosting private weather forecasting products, e.g. through the installation of private infrastructure such as radars. Their distributed nature, as well as the often proprietary nature of the data, makes it an ideal fit for the FL approach. In addition, high resolution radars produce large data volumes, which are inconvenient to share in order to train a centralized model.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In particular, weather radars are an effective tool for precipitation nowcasting, whose frequency and intensity is expected to be affected by climate change, as well as various other types of extreme weather events <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. There are several references that provide clear evidence, such as a fatal flash flood <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> and the deadliest European tornado since 2001 <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, we develop a novel personalized federated learning (PFL) approach due to the inherent heterogeneous nature of radar-based precipitation data. The aim of PFL is to address the main challenges that faces FL, like its poor convergence on highly heterogeneous data and its lack of generalization ability beyond the global distribution of the data <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. For this study, the images captured by the radar are divided in four quadrants, simulating a use case in which each radar would cover a sub-area of the total region of interest. We study the predictive and generalization capacity of the resulting models, in order to assess the applicability of these methods to real-world use cases, in which data comes from different radars potentially located in different countries. The motivation for addressing this study is two-fold: (1) to enhance collaboration between institutions handling such data without sharing it, (2) to study if training models under a personalized federated learning architecture provide better results than training with individual data from each radar or area of capturing. This is of particular interest when data cannot be centralized due to technical, computational or storage restrictions. In addition, we can mobilize computing wherever data is available, even using isolated GPUs or compute nodes for this task.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The remainder of this work is structured as follows: Section <a href="#S2" title="2 State of the art ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the state of the art regarding the research areas concerning artificial intelligence models and meteorology, together with the recent state of the art concerning the application of FL in different use cases and PFL. Section <a href="#S3" title="3 Data ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> summarizes the data used during this study, as well as the distribution carried out for the purpose of applying the FL and PFL approaches. Section <a href="#S4" title="4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> describes the methodology implemented for the development of the models used to carry out the predictions, together with the proposal of a novel PFL architecture (namely adaptive FL, <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">adapFL</span>). Section <a href="#S5" title="5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> presents the results, together with their analysis. In Section <a href="#S6" title="6 Discussion ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> a discussion concerning different limitations of the study and the data used is presented. Finally, Section <a href="#S7" title="7 Conclusions ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> draws the conclusions together with future lines of work.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>State of the art</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">The state of the art in relation to image processing, meteorology-oriented DL, precipitation nowcasting using DL models, as well as FL and PFL applications is discussed and evaluated in this section.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Deep learning techniques for meteorology</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Concerning AI-based models and techniques, specifically the development of DL models, there are several fields that are relevant for the meteorological domain. First, image processing focuses on the analysis of digital images and videos by software programs from statistically based approaches <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> to modern neural networks <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. This field is further subdivided into multiple subdomains, such as object detection, object tracking, object recognition, etc. The aim of object detection is to identify and localize relevant objects from a digital image. Convolutional neural networks, first applied in 1988 to alphabet recognition <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> are especially well suited for this task. Specifically, object tracking and recognition aims to identify an object in a sequence of images and can attempt to predict its movement. A recent paper <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> describes how to solve both of these tasks at the same time. Siamese neural networks (e.g., DaSiamRPN <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, Cascaded SiamRPN <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, SiamMask <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, SiamRPN++ <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, Deeper and Wider SiamRPN <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>), are also useful in object tracking.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Regarding meteorology-oriented DL, blurry predictions are a tremendous challenge <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, requiring a special treatment of loss functions. Generative Adversarial Network (GAN) <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> has been recently successfully applied to solve this challenge. The approach called DGMR <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> is currently the state-of-the-art in the radar-based storm nowcasting.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Concerning precipitation nowcasting using DL models, several works analyze the use of different models to better accomplish this task. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> the authors propose the use of the <span id="S2.SS1.p3.1.1" class="ltx_text ltx_font_italic">Trajectory GRU</span> model instead of the classic Convolutional LSTM (ConvLSTM) which was used for example in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. In addition, in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> the authors also propose a novel deep learning neural network and they start presenting the COTREC method (also compared in this study) and the ConvLSTM. They compare the performance of the different models on composite reflectivity data concerning the critical success index (CSI) over 30 and 60 min. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> a novel loss function is also used to mitigate the class imbalance problem in the CSI in the case of heavy rainfall. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> a Deep Transfer Learning approach is proposed for radar nowcasting using a CNN as benchmark and two transfer learning models with few data belonging to the target area (data from 5 days regarding the target area for training and 3 days for testing). Finally, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> presents different DL models for weather radar nowcasting together with some drawbacks encountered, highlight in Table 2 a review of ML models used for weather nowcasting from the literarure.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Federated Learning and Personalized Federated Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">With regard to the use of FL in data analysis, the use cases addressed in the state of the art are quite broad. In particular, numerous studies have been conducted in the medical field, due to the obvious privacy restrictions that apply in such environments <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. Other applications deal with intrusion detection systems <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, credit card fraud detection <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, but also applications that arise when dealing with wireless communications applications <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. Concerning climate sciences and more particularly the study of water quality, the classical FL architecture is applied in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> to predict the concentration of chlorophyll given different physico-chemical and meteorological features, using two different sites of data gathering, specifically two tributaries of the River Thames. However, to our knowledge, there is not any study in which FL or PFL architectures have been applied to try to improve the predictions from classical models using meteorological radar images.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">PFL includes a wide group of different strategies to further tailor an FL model to better fit each client’s data, while maintaining privacy and security <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. According to the taxonomy proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, PFL approaches can be classified in two main types: Global Model Personalization and Learning Personalized Models. The approach presented in this work falls into the first group because, at least initially, there is a global model. In fact, it could be considered a kind of Transfer Learning in which the knowledge learned from a source domain (the weights from the whole ensemble of clients) is transferred to a target domain (each particular client). In the following, we will refer to the approach followed in this study regarding PFL as <span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_italic">adapFL</span> (standing for adaptive federated learning). The idea behind this novel approach is explained in Section <a href="#S4" title="4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Data</h2>

<div id="S3.F1" class="ltx_figure ltx_transformed_outer" style="width:274.2pt;height:504.4pt;vertical-align:-0.0pt;"><div class="ltx_transformed_inner" style="width:504.4pt;transform:translate(-115.13pt,-114.63pt) rotate(-90deg) ;"><figure><img src="/html/2408.05761/assets/fig/example_radar.jpg" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="698" height="378" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Example of the area covered by the radar in the borderland between Czech and Slovak republic and the information captured: continuous white-blue-green-orange clouds - depiction of different values of radar rainfall (Vertically Integrated Liquid), green/yellow/red/orange polygons of districts - nowcast alerting regions where the rainfall is expected to be.</figcaption>
</figure></div></div>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Throughout this study, we utilize compact X-band meteorological radar, used for municipalities and in agrosector as a gap filler in large meteorological radar coverage. It is located in the borderland between Czech and Slovak republic. The radar features a parabolic antenna with a diameter 1160 mm which results in half power beam width 1.8°. The device sensitivity is 10 dBZ at 200km range and the central frequency of the X-band radar is 9410 MHz. In addition, the radiometric resolution is 8bit, the spatial resolution is 1<math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.p1.1.m1.1a"><mo id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><times id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\times</annotation></semantics></math>1km and the bandwidth is 1 MHz. An example of the captured data is shown in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Data ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">The radar detects precipitation as 3D volumes of high reflectivity (radar beam reflections on water droplets, ice crystals and hail). Data are available as hdf5 files storing each day’s information. In each file there are measurement products (ground truth) approximately every five minutes throughout the day and forecasts from five to forty minutes.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.2" class="ltx_p">There are many different types of radar products generated as various 2D sections of the 3D data, but we are focusing on vertically integrated liquid (VIL) products, i.e. reflectivity recalculated to water content by Marshall-Palmer formula and summed vertically. Then the VIL (<math id="S3.p3.1.m1.1" class="ltx_Math" alttext="kg/m^{2}" display="inline"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mrow id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml"><mi id="S3.p3.1.m1.1.1.2.2" xref="S3.p3.1.m1.1.1.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.1.1.2.1" xref="S3.p3.1.m1.1.1.2.1.cmml">​</mo><mi id="S3.p3.1.m1.1.1.2.3" xref="S3.p3.1.m1.1.1.2.3.cmml">g</mi></mrow><mo id="S3.p3.1.m1.1.1.1" xref="S3.p3.1.m1.1.1.1.cmml">/</mo><msup id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml"><mi id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml">m</mi><mn id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><divide id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1"></divide><apply id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2"><times id="S3.p3.1.m1.1.1.2.1.cmml" xref="S3.p3.1.m1.1.1.2.1"></times><ci id="S3.p3.1.m1.1.1.2.2.cmml" xref="S3.p3.1.m1.1.1.2.2">𝑘</ci><ci id="S3.p3.1.m1.1.1.2.3.cmml" xref="S3.p3.1.m1.1.1.2.3">𝑔</ci></apply><apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2">𝑚</ci><cn type="integer" id="S3.p3.1.m1.1.1.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">kg/m^{2}</annotation></semantics></math>) is defined as the vertical integrated quantity of liquid water content (LWC) (<math id="S3.p3.2.m2.1" class="ltx_Math" alttext="kg/m^{3}" display="inline"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mrow id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml"><mi id="S3.p3.2.m2.1.1.2.2" xref="S3.p3.2.m2.1.1.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m2.1.1.2.1" xref="S3.p3.2.m2.1.1.2.1.cmml">​</mo><mi id="S3.p3.2.m2.1.1.2.3" xref="S3.p3.2.m2.1.1.2.3.cmml">g</mi></mrow><mo id="S3.p3.2.m2.1.1.1" xref="S3.p3.2.m2.1.1.1.cmml">/</mo><msup id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml"><mi id="S3.p3.2.m2.1.1.3.2" xref="S3.p3.2.m2.1.1.3.2.cmml">m</mi><mn id="S3.p3.2.m2.1.1.3.3" xref="S3.p3.2.m2.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><divide id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1"></divide><apply id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2"><times id="S3.p3.2.m2.1.1.2.1.cmml" xref="S3.p3.2.m2.1.1.2.1"></times><ci id="S3.p3.2.m2.1.1.2.2.cmml" xref="S3.p3.2.m2.1.1.2.2">𝑘</ci><ci id="S3.p3.2.m2.1.1.2.3.cmml" xref="S3.p3.2.m2.1.1.2.3">𝑔</ci></apply><apply id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.3.1.cmml" xref="S3.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.p3.2.m2.1.1.3.2.cmml" xref="S3.p3.2.m2.1.1.3.2">𝑚</ci><cn type="integer" id="S3.p3.2.m2.1.1.3.3.cmml" xref="S3.p3.2.m2.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">kg/m^{3}</annotation></semantics></math>).</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">Radar image data related to VIL are highly dependent on the season and the time of the year. Therefore, in this case, having images captured every 5 minutes, we have chosen to use data from four months of the first available year. Specifically, we have selected the first four months available, April, May, June and July 2016, which can also represent significant periods in terms of precipitation.</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.3" class="ltx_p">The original radar images are 400km wide square centered at the radar position. However, since most of the information is concentrated in the center of the images, they were cropped from 400<math id="S3.p5.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.p5.1.m1.1a"><mo id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><times id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\times</annotation></semantics></math>400km to 100<math id="S3.p5.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.p5.2.m2.1a"><mo id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><times id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\times</annotation></semantics></math>100km (centered in the middle of the original image). Afterwards, they were used on the different models described in Section <a href="#S4" title="4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> to make 5-minute predictions (nowcast) of those images. Some examples of the available images after re-scaling the resolution to the new dimensions (100<math id="S3.p5.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.p5.3.m3.1a"><mo id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><times id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">\times</annotation></semantics></math>100) are shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Data ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Note that most of the information is concentrated in the center of the image due to the degradation in the radar resolution caused by the conversion of measured points coordinates from polar coordinate system to cartesian.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2408.05761/assets/fig/example_xtrain.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="334" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Example of the radar images under study after reducing to 100<math id="S3.F2.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.F2.2.m1.1b"><mo id="S3.F2.2.m1.1.1" xref="S3.F2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F2.2.m1.1c"><times id="S3.F2.2.m1.1.1.cmml" xref="S3.F2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.2.m1.1d">\times</annotation></semantics></math>100 resolution with the information on vertically integrated liquid.</figcaption>
</figure>
<div id="S3.p6" class="ltx_para">
<p id="S3.p6.1" class="ltx_p">From Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Data ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we can draw several conclusions. The first one is that the information in each of the images is clearly located in the center of the images. In addition, it can be seen that a large part of each image does not contain any precipitation (no rain present), most of them being totally blank images (for example, the last image in the second row). This goes hand in hand with the meteorological events that occurred at the time the radar image was acquired.</p>
</div>
<div id="S3.p7" class="ltx_para">
<p id="S3.p7.2" class="ltx_p">For training and testing the models, a split has been made following the temporal order of the images, so that the first 80<math id="S3.p7.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S3.p7.1.m1.1a"><mo id="S3.p7.1.m1.1.1" xref="S3.p7.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S3.p7.1.m1.1b"><csymbol cd="latexml" id="S3.p7.1.m1.1.1.cmml" xref="S3.p7.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.1.m1.1c">\%</annotation></semantics></math> of images (28025) is used as the training set, and the last 20<math id="S3.p7.2.m2.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S3.p7.2.m2.1a"><mo id="S3.p7.2.m2.1.1" xref="S3.p7.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S3.p7.2.m2.1b"><csymbol cd="latexml" id="S3.p7.2.m2.1.1.cmml" xref="S3.p7.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.2.m2.1c">\%</annotation></semantics></math> (7007 images) is used as test set. In addition, since many of the available images are blank (no rainfall), additional processing has been performed on them, which is explained later. In addition, the validation process was performed once the data had been distributed, in order to apply the approach that should be followed in a real-world scenario. This is explained in the methodology (Section <a href="#S4" title="4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div id="S3.p8" class="ltx_para">
<p id="S3.p8.1" class="ltx_p">Table <a href="#S3.T1" title="Table 1 ‣ 3 Data ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows some relevant statistics according to the images to be predicted in the test set, after data processing. Specifically, these statistics are those related to the mean of the VIL in each of the images.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics regarding the mean VIL in each of the images to be predicted in the test set of each of the four zones under study. In the case of the minimum and the maximum, the average of the min and max values for each of the images are shown.</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S3.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S3.T1.1.1.1.2.1" class="ltx_text ltx_font_italic">Min</span></th>
<th id="S3.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.1.1.1.3.1" class="ltx_text ltx_font_italic">Max</span></th>
<th id="S3.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.1.1.1.4.1" class="ltx_text ltx_font_italic">Mean</span></th>
<th id="S3.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.1.1.1.5.1" class="ltx_text ltx_font_italic">Median</span></th>
<th id="S3.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.1.1.1.6.1" class="ltx_text ltx_font_italic">Variance</span></th>
<th id="S3.T1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.1.1.1.7.1" class="ltx_text ltx_font_italic">Skewness</span></th>
<th id="S3.T1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.1.1.1.8.1" class="ltx_text ltx_font_italic">Kurtosis</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.1.2.1.1.1" class="ltx_text ltx_font_italic">Zone 1</span></th>
<th id="S3.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0</th>
<td id="S3.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">4.2192</td>
<td id="S3.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.1201</td>
<td id="S3.T1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">0.0224</td>
<td id="S3.T1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">0.0500</td>
<td id="S3.T1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">3.1100</td>
<td id="S3.T1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">12.2513</td>
</tr>
<tr id="S3.T1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.3.2.1.1" class="ltx_text ltx_font_italic">Zone 2</span></th>
<th id="S3.T1.1.3.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">0</th>
<td id="S3.T1.1.3.2.3" class="ltx_td ltx_align_center">3.1011</td>
<td id="S3.T1.1.3.2.4" class="ltx_td ltx_align_center">0.1193</td>
<td id="S3.T1.1.3.2.5" class="ltx_td ltx_align_center">0.0236</td>
<td id="S3.T1.1.3.2.6" class="ltx_td ltx_align_center">0.0592</td>
<td id="S3.T1.1.3.2.7" class="ltx_td ltx_align_center">4.0793</td>
<td id="S3.T1.1.3.2.8" class="ltx_td ltx_align_center">22.2058</td>
</tr>
<tr id="S3.T1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.1.4.3.1.1" class="ltx_text ltx_font_italic">Zone 3</span></th>
<th id="S3.T1.1.4.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">0</th>
<td id="S3.T1.1.4.3.3" class="ltx_td ltx_align_center">3.7380</td>
<td id="S3.T1.1.4.3.4" class="ltx_td ltx_align_center">0.1133</td>
<td id="S3.T1.1.4.3.5" class="ltx_td ltx_align_center">0.0249</td>
<td id="S3.T1.1.4.3.6" class="ltx_td ltx_align_center">0.0452</td>
<td id="S3.T1.1.4.3.7" class="ltx_td ltx_align_center">3.0060</td>
<td id="S3.T1.1.4.3.8" class="ltx_td ltx_align_center">10.0654</td>
</tr>
<tr id="S3.T1.1.5.4" class="ltx_tr">
<th id="S3.T1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S3.T1.1.5.4.1.1" class="ltx_text ltx_font_italic">Zone 4</span></th>
<th id="S3.T1.1.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">0</th>
<td id="S3.T1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_bb">3.2316</td>
<td id="S3.T1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_bb">0.0956</td>
<td id="S3.T1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_bb">0.0158</td>
<td id="S3.T1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_bb">0.0316</td>
<td id="S3.T1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_bb">2.8355</td>
<td id="S3.T1.1.5.4.8" class="ltx_td ltx_align_center ltx_border_bb">9.2811</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, the different models used to perform the 5-minutes nowcast of the VIL based on radar images are described.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Classical models</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_italic">Tracking of Radar Echoes by Correlation</span> (TREC) <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> is a nowcasting method that is based on a comparison of two consecutive images of radar reflectivity. For each block of radar pixels, TREC identifies a motion vector by maximizing the cross-correlation coefficient between the two consecutive reflectivity images. It is an image processing algorithm, which does not include any dynamic equations related to the motion and/or the evolution of the detected weather fields.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">As <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> emphasizes, “while TREC is successful in tracking the movements of individual radar echoes, in practice, it usually captures the direction of individual rain cells instead of moving the entire meteorological system on a larger scale”. Due to this drawback of the TREC method, various alternatives such as COTREC (Continuity Tracking Radar Echoes by Correlation) <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, have been developed. A recent paper <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> presents a detailed overview of the features of the novel refined methods of the TREC concept that emerged during the last decades.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">In this paper, we will use COTREC as a baseline classical model to compare with the resulting deep learning models and the different learning approaches.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Deep Learning and Federated Learning models</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">As motivated in Section <a href="#S1" title="1 Introduction and motivation ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, in view of the heterogeneous distributed nature of the radar images under study, we address this challenge with an horizontal federated learning architecture and a novel personalized federated learning method.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">First, we divide the data artificially into 4 different zones, splitting the images into four quadrants as shown in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2 Deep Learning and Federated Learning models ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, in which an example of a training image is shown.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2408.05761/assets/fig/split_zones.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="419" height="350" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Example of an image where the four quadrants into which it has been divided to create the four zones are shown in blue.</figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">It is important to note that, for training the deep learning models, we have processed the input data in the following way: for predicting the image captured in the next 5 minutes, we introduced the 3 images available immediately before. Thus, by taking the three images we are not only be capturing the speed of the movement and the change in the amount of vertical integrated liquid, but also the acceleration. In addition, one important part of the processing carried out is that we have eliminated from both the train set and the test set those records in which the three images prior to the predictor were empty (blank, no rain). This has also been extrapolated to analyze the results with the COTREC method, taking into account only the error obtained when predicting with the remaining images. The motivation lies in the fact that in these cases, the natural answer would be to predict that there will be no rain (as the three previous images were without rain). Including in the neural network so many empty images can lead to a lack of appropriate adjustment in cases where there are heavy rain events, which as can be seen in the distribution are infrequent even after carrying out this processing (see Appendix <a href="#A1" title="Appendix A Data distribution ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>), but at the same time are an important factor that nowcasting models must predict accurately. Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Deep Learning and Federated Learning models ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the number of data for train and test in each of the four zones after carrying out this pre-processing.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Number of data after processing in each zone for train and test.</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.1.1.1.2.1" class="ltx_text ltx_font_italic">Train</span></th>
<th id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.1.1.1.3.1" class="ltx_text ltx_font_italic">Test</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<th id="S4.T2.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S4.T2.1.2.1.1.1" class="ltx_text ltx_font_italic">Zone 1</span></th>
<td id="S4.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">4194</td>
<td id="S4.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">1585</td>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<th id="S4.T2.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.1.3.2.1.1" class="ltx_text ltx_font_italic">Zone 2</span></th>
<td id="S4.T2.1.3.2.2" class="ltx_td ltx_align_center">4055</td>
<td id="S4.T2.1.3.2.3" class="ltx_td ltx_align_center">1286</td>
</tr>
<tr id="S4.T2.1.4.3" class="ltx_tr">
<th id="S4.T2.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.1.4.3.1.1" class="ltx_text ltx_font_italic">Zone 3</span></th>
<td id="S4.T2.1.4.3.2" class="ltx_td ltx_align_center">4022</td>
<td id="S4.T2.1.4.3.3" class="ltx_td ltx_align_center">1380</td>
</tr>
<tr id="S4.T2.1.5.4" class="ltx_tr">
<th id="S4.T2.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S4.T2.1.5.4.1.1" class="ltx_text ltx_font_italic">Zone 4</span></th>
<td id="S4.T2.1.5.4.2" class="ltx_td ltx_align_center ltx_border_bb">4457</td>
<td id="S4.T2.1.5.4.3" class="ltx_td ltx_align_center ltx_border_bb">1494</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">In order to analyze the characteristics of the images available in each zone, Figure <a href="#S4.F4" title="Figure 4 ‣ 4.2 Deep Learning and Federated Learning models ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the mean of the images captured during the months of April, May, June and July 2016 in each artificially divided area once pre-processed as explained above. In particular, the average of the images to be predicted in train and test is shown. Note than in each case the the color bar represents the magnitude associated with the mean VIL in each pixel.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2408.05761/assets/fig/mean_zones.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="419" height="349" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Average of all the radar images available in April, May, June and July 2016 by zone once processed by area.</figcaption>
</figure>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p">In view of Figure <a href="#S4.F4" title="Figure 4 ‣ 4.2 Deep Learning and Federated Learning models ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we can note that the distribution of the images in each quadrant are very different from each other, being quite heterogeneous zones, as will be further explained in Section <a href="#S6" title="6 Discussion ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Then, when training the model in a federated way, this may difficult the model convergence, since each model would have seen data with different statistics. However, we are interested in keeping these differences because they better reflect real use cases, where radar images will have very distinct distributions if they come from clearly differentiated areas, such as radars located in various countries.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.1" class="ltx_p">In addition, in order to select the model to be used for testing purposes, we need the carry out a validation process. In this case, we have performed k-fold cross validation with five folds. Time Series cross-validator from <span id="S4.SS2.p6.1.1" class="ltx_text ltx_font_italic">scikit-learn</span> has been used for this purpose in order to keep the temporal order of the images. A key point here is to decide on which dataset to perform the validation (as we would not centralize the data). Following a real use case, the four data owners (corresponding to the four zones involved) must agree on the model to be trained. In this case, in view of Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Deep Learning and Federated Learning models ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we have decided to carry out the validation process using the data from zone 4, as it has the largest number of data for training after processing. Several simple convolutional network architectures have been tested as well as different values for the batch size. The selected one is presented in Section <a href="#S4.SS3" title="4.3 Convolutional neural architecture ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
<div id="S4.SS2.p7" class="ltx_para">
<p id="S4.SS2.p7.2" class="ltx_p">The implemented FL scheme follows the idea presented in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, such that the aggregation of the models trained in each zone (in this use case each zone represents a client), is performed using a weighted average according to the number of training data of each client. In addition, a novel PFL paradigm is considered once the federated training has been carried out for each client during a certain number of epochs (<math id="S4.SS2.p7.1.m1.1" class="ltx_Math" alttext="N_{e}" display="inline"><semantics id="S4.SS2.p7.1.m1.1a"><msub id="S4.SS2.p7.1.m1.1.1" xref="S4.SS2.p7.1.m1.1.1.cmml"><mi id="S4.SS2.p7.1.m1.1.1.2" xref="S4.SS2.p7.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS2.p7.1.m1.1.1.3" xref="S4.SS2.p7.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.1.m1.1b"><apply id="S4.SS2.p7.1.m1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p7.1.m1.1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p7.1.m1.1.1.2.cmml" xref="S4.SS2.p7.1.m1.1.1.2">𝑁</ci><ci id="S4.SS2.p7.1.m1.1.1.3.cmml" xref="S4.SS2.p7.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.1.m1.1c">N_{e}</annotation></semantics></math>) and a given number of rounds (<math id="S4.SS2.p7.2.m2.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="S4.SS2.p7.2.m2.1a"><msub id="S4.SS2.p7.2.m2.1.1" xref="S4.SS2.p7.2.m2.1.1.cmml"><mi id="S4.SS2.p7.2.m2.1.1.2" xref="S4.SS2.p7.2.m2.1.1.2.cmml">N</mi><mi id="S4.SS2.p7.2.m2.1.1.3" xref="S4.SS2.p7.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.2.m2.1b"><apply id="S4.SS2.p7.2.m2.1.1.cmml" xref="S4.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p7.2.m2.1.1.1.cmml" xref="S4.SS2.p7.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p7.2.m2.1.1.2.cmml" xref="S4.SS2.p7.2.m2.1.1.2">𝑁</ci><ci id="S4.SS2.p7.2.m2.1.1.3.cmml" xref="S4.SS2.p7.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.2.m2.1c">N_{r}</annotation></semantics></math>). In this use case, the variability in each zone with respect to the others is high, as shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Data ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Therefore, it is appropriate that after conducting the federated training, in order to achieve a more robust model by having been trained with more data, these are trained a certain number of epochs on the data of each zone locally, which we have called <em id="S4.SS2.p7.2.1" class="ltx_emph ltx_font_italic">adaptive federated training (adapFL)</em>. The idea is to be able to capture in each case the peculiarities of each zone before evaluating the results in the test set of that area, but starting with the knowledge and generalization ability provided by the FL model. In short, the three learning schemes (including the individual one) are presented in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.2 Deep Learning and Federated Learning models ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2408.05761/assets/fig/learning_architectures.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="513" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Schema of the three learning paradigms implemented: individual, federated and adaptive federated learning.</figcaption>
</figure>
<div id="S4.SS2.p8" class="ltx_para">
<p id="S4.SS2.p8.1" class="ltx_p">In particular, in this work we are interested in analyzing the feasibility of the <span id="S4.SS2.p8.1.1" class="ltx_text ltx_font_italic">adapFL</span> approach for the case in which images from different areas are available. The goal is to study whether this potential collaboration while maintaining the privacy of the images by not sharing them, can allow improving the results that would be obtained by training locally in each zone (as a greater number of data will be available to train the models in a distributed way), or if on the contrary, it is more convenient to carry out an individual training in each zone, respecting the differential factors of each one of them. An intuitive idea of such implemented architecture is summarized in the pseudocode given in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.2 Deep Learning and Federated Learning models ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.6.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Adaptive federated training pseudocode</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.4" class="ltx_p ltx_figure_panel"><span id="alg1.4.1" class="ltx_text ltx_font_bold">INPUT:</span> <span id="alg1.4.2" class="ltx_text ltx_font_italic">clients:</span> list with all the clients participating on the training (with <math id="alg1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">x</annotation></semantics></math> the features and <math id="alg1.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">y</annotation></semantics></math> the labels for each client). 
<br class="ltx_break">      <span id="alg1.4.3" class="ltx_text ltx_font_bold">INPUT:</span> <span id="alg1.4.4" class="ltx_text ltx_font_italic">n:</span> total number of training data from all clients.
<br class="ltx_break">      <span id="alg1.4.5" class="ltx_text ltx_font_bold">INPUT:</span> <span id="alg1.4.6" class="ltx_text ltx_font_italic">model:</span> machine learning model to be trained.
<br class="ltx_break">      <span id="alg1.4.7" class="ltx_text ltx_font_bold">INPUT:</span> <math id="alg1.3.m3.1" class="ltx_Math" alttext="n_{e}" display="inline"><semantics id="alg1.3.m3.1a"><msub id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml"><mi id="alg1.3.m3.1.1.2" xref="alg1.3.m3.1.1.2.cmml">n</mi><mi id="alg1.3.m3.1.1.3" xref="alg1.3.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><apply id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.3.m3.1.1.1.cmml" xref="alg1.3.m3.1.1">subscript</csymbol><ci id="alg1.3.m3.1.1.2.cmml" xref="alg1.3.m3.1.1.2">𝑛</ci><ci id="alg1.3.m3.1.1.3.cmml" xref="alg1.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">n_{e}</annotation></semantics></math><span id="alg1.4.8" class="ltx_text ltx_font_italic">:</span> number of epochs. 
<br class="ltx_break">      <span id="alg1.4.9" class="ltx_text ltx_font_bold">INPUT:</span> <span id="alg1.4.10" class="ltx_text ltx_font_italic">batch_size:</span> batch size. 
<br class="ltx_break">      <span id="alg1.4.11" class="ltx_text ltx_font_bold">INPUT:</span> <math id="alg1.4.m4.1" class="ltx_Math" alttext="n_{r}" display="inline"><semantics id="alg1.4.m4.1a"><msub id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml"><mi id="alg1.4.m4.1.1.2" xref="alg1.4.m4.1.1.2.cmml">n</mi><mi id="alg1.4.m4.1.1.3" xref="alg1.4.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><apply id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.cmml" xref="alg1.4.m4.1.1">subscript</csymbol><ci id="alg1.4.m4.1.1.2.cmml" xref="alg1.4.m4.1.1.2">𝑛</ci><ci id="alg1.4.m4.1.1.3.cmml" xref="alg1.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">n_{r}</annotation></semantics></math><span id="alg1.4.12" class="ltx_text ltx_font_italic">:</span> number of rounds of the FL training.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.7" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">function</span> <span id="alg1.l1.3" class="ltx_text ltx_font_smallcaps">AdaptativeFederatedTraining</span>(<math id="alg1.l1.m1.1" class="ltx_Math" alttext="clients" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1a" xref="alg1.l1.m1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.4" xref="alg1.l1.m1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1b" xref="alg1.l1.m1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.5" xref="alg1.l1.m1.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1c" xref="alg1.l1.m1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.6" xref="alg1.l1.m1.1.1.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1d" xref="alg1.l1.m1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.7" xref="alg1.l1.m1.1.1.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1e" xref="alg1.l1.m1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.8" xref="alg1.l1.m1.1.1.8.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><times id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></times><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑐</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑙</ci><ci id="alg1.l1.m1.1.1.4.cmml" xref="alg1.l1.m1.1.1.4">𝑖</ci><ci id="alg1.l1.m1.1.1.5.cmml" xref="alg1.l1.m1.1.1.5">𝑒</ci><ci id="alg1.l1.m1.1.1.6.cmml" xref="alg1.l1.m1.1.1.6">𝑛</ci><ci id="alg1.l1.m1.1.1.7.cmml" xref="alg1.l1.m1.1.1.7">𝑡</ci><ci id="alg1.l1.m1.1.1.8.cmml" xref="alg1.l1.m1.1.1.8">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">clients</annotation></semantics></math>, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">n</annotation></semantics></math>, <math id="alg1.l1.m3.1" class="ltx_Math" alttext="model" display="inline"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">​</mo><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m3.1.1.1a" xref="alg1.l1.m3.1.1.1.cmml">​</mo><mi id="alg1.l1.m3.1.1.4" xref="alg1.l1.m3.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m3.1.1.1b" xref="alg1.l1.m3.1.1.1.cmml">​</mo><mi id="alg1.l1.m3.1.1.5" xref="alg1.l1.m3.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m3.1.1.1c" xref="alg1.l1.m3.1.1.1.cmml">​</mo><mi id="alg1.l1.m3.1.1.6" xref="alg1.l1.m3.1.1.6.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><times id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></times><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑚</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝑜</ci><ci id="alg1.l1.m3.1.1.4.cmml" xref="alg1.l1.m3.1.1.4">𝑑</ci><ci id="alg1.l1.m3.1.1.5.cmml" xref="alg1.l1.m3.1.1.5">𝑒</ci><ci id="alg1.l1.m3.1.1.6.cmml" xref="alg1.l1.m3.1.1.6">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">model</annotation></semantics></math>, <math id="alg1.l1.m4.1" class="ltx_Math" alttext="n_{e}" display="inline"><semantics id="alg1.l1.m4.1a"><msub id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">n</mi><mi id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝑛</ci><ci id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">n_{e}</annotation></semantics></math>, <math id="alg1.l1.m5.1" class="ltx_Math" alttext="batch\_size" display="inline"><semantics id="alg1.l1.m5.1a"><mrow id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1a" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.4" xref="alg1.l1.m5.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1b" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.5" xref="alg1.l1.m5.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1c" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.6" xref="alg1.l1.m5.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1d" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l1.m5.1.1.7" xref="alg1.l1.m5.1.1.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1e" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.8" xref="alg1.l1.m5.1.1.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1f" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.9" xref="alg1.l1.m5.1.1.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1g" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.10" xref="alg1.l1.m5.1.1.10.cmml">z</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.1.1h" xref="alg1.l1.m5.1.1.1.cmml">​</mo><mi id="alg1.l1.m5.1.1.11" xref="alg1.l1.m5.1.1.11.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><times id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1.1"></times><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝑏</ci><ci id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3">𝑎</ci><ci id="alg1.l1.m5.1.1.4.cmml" xref="alg1.l1.m5.1.1.4">𝑡</ci><ci id="alg1.l1.m5.1.1.5.cmml" xref="alg1.l1.m5.1.1.5">𝑐</ci><ci id="alg1.l1.m5.1.1.6.cmml" xref="alg1.l1.m5.1.1.6">ℎ</ci><ci id="alg1.l1.m5.1.1.7.cmml" xref="alg1.l1.m5.1.1.7">_</ci><ci id="alg1.l1.m5.1.1.8.cmml" xref="alg1.l1.m5.1.1.8">𝑠</ci><ci id="alg1.l1.m5.1.1.9.cmml" xref="alg1.l1.m5.1.1.9">𝑖</ci><ci id="alg1.l1.m5.1.1.10.cmml" xref="alg1.l1.m5.1.1.10">𝑧</ci><ci id="alg1.l1.m5.1.1.11.cmml" xref="alg1.l1.m5.1.1.11">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">batch\_size</annotation></semantics></math>, <math id="alg1.l1.m6.1" class="ltx_Math" alttext="n_{r}" display="inline"><semantics id="alg1.l1.m6.1a"><msub id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml"><mi id="alg1.l1.m6.1.1.2" xref="alg1.l1.m6.1.1.2.cmml">n</mi><mi id="alg1.l1.m6.1.1.3" xref="alg1.l1.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><apply id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1"><csymbol cd="ambiguous" id="alg1.l1.m6.1.1.1.cmml" xref="alg1.l1.m6.1.1">subscript</csymbol><ci id="alg1.l1.m6.1.1.2.cmml" xref="alg1.l1.m6.1.1.2">𝑛</ci><ci id="alg1.l1.m6.1.1.3.cmml" xref="alg1.l1.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">n_{r}</annotation></semantics></math>)

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.3" class="ltx_Math" alttext="i\in[1,\ldots,n_{r}]" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml"><mi id="alg1.l2.m1.3.3.3" xref="alg1.l2.m1.3.3.3.cmml">i</mi><mo id="alg1.l2.m1.3.3.2" xref="alg1.l2.m1.3.3.2.cmml">∈</mo><mrow id="alg1.l2.m1.3.3.1.1" xref="alg1.l2.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.3.3.1.1.2" xref="alg1.l2.m1.3.3.1.2.cmml">[</mo><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.3.3.1.1.3" xref="alg1.l2.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">…</mi><mo id="alg1.l2.m1.3.3.1.1.4" xref="alg1.l2.m1.3.3.1.2.cmml">,</mo><msub id="alg1.l2.m1.3.3.1.1.1" xref="alg1.l2.m1.3.3.1.1.1.cmml"><mi id="alg1.l2.m1.3.3.1.1.1.2" xref="alg1.l2.m1.3.3.1.1.1.2.cmml">n</mi><mi id="alg1.l2.m1.3.3.1.1.1.3" xref="alg1.l2.m1.3.3.1.1.1.3.cmml">r</mi></msub><mo stretchy="false" id="alg1.l2.m1.3.3.1.1.5" xref="alg1.l2.m1.3.3.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3"><in id="alg1.l2.m1.3.3.2.cmml" xref="alg1.l2.m1.3.3.2"></in><ci id="alg1.l2.m1.3.3.3.cmml" xref="alg1.l2.m1.3.3.3">𝑖</ci><list id="alg1.l2.m1.3.3.1.2.cmml" xref="alg1.l2.m1.3.3.1.1"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">…</ci><apply id="alg1.l2.m1.3.3.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.3.3.1.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.3.3.1.1.1.2.cmml" xref="alg1.l2.m1.3.3.1.1.1.2">𝑛</ci><ci id="alg1.l2.m1.3.3.1.1.1.3.cmml" xref="alg1.l2.m1.3.3.1.1.1.3">𝑟</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">i\in[1,\ldots,n_{r}]</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.2.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>         <math id="alg1.l3.m1.1" class="ltx_Math" alttext="w\leftarrow[\hskip 2.84544pt]" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">w</mi><mo stretchy="false" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mrow id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.cmml"><mo rspace="0.280em" stretchy="false" id="alg1.l3.m1.1.1.3.2.1" xref="alg1.l3.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg1.l3.m1.1.1.3.2.2" xref="alg1.l3.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑤</ci><list id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">w\leftarrow[\hskip 2.84544pt]</annotation></semantics></math> <span id="alg1.l3.1" class="ltx_text" style="float:right;"><math id="alg1.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation></semantics></math> empty list for saving the weights
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>         <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l4.m1.1" class="ltx_Math" alttext="client\in clients" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1a" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.4" xref="alg1.l4.m1.1.1.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1b" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.5" xref="alg1.l4.m1.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1c" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.6" xref="alg1.l4.m1.1.1.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1d" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.7" xref="alg1.l4.m1.1.1.2.7.cmml">t</mi></mrow><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1a" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.4" xref="alg1.l4.m1.1.1.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1b" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.5" xref="alg1.l4.m1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1c" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.6" xref="alg1.l4.m1.1.1.3.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1d" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.7" xref="alg1.l4.m1.1.1.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1e" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.8" xref="alg1.l4.m1.1.1.3.8.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><times id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2.1"></times><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝑐</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑙</ci><ci id="alg1.l4.m1.1.1.2.4.cmml" xref="alg1.l4.m1.1.1.2.4">𝑖</ci><ci id="alg1.l4.m1.1.1.2.5.cmml" xref="alg1.l4.m1.1.1.2.5">𝑒</ci><ci id="alg1.l4.m1.1.1.2.6.cmml" xref="alg1.l4.m1.1.1.2.6">𝑛</ci><ci id="alg1.l4.m1.1.1.2.7.cmml" xref="alg1.l4.m1.1.1.2.7">𝑡</ci></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝑐</ci><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑙</ci><ci id="alg1.l4.m1.1.1.3.4.cmml" xref="alg1.l4.m1.1.1.3.4">𝑖</ci><ci id="alg1.l4.m1.1.1.3.5.cmml" xref="alg1.l4.m1.1.1.3.5">𝑒</ci><ci id="alg1.l4.m1.1.1.3.6.cmml" xref="alg1.l4.m1.1.1.3.6">𝑛</ci><ci id="alg1.l4.m1.1.1.3.7.cmml" xref="alg1.l4.m1.1.1.3.7">𝑡</ci><ci id="alg1.l4.m1.1.1.3.8.cmml" xref="alg1.l4.m1.1.1.3.8">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">client\in clients</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.2.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>              <span id="alg1.l5.1" class="ltx_text ltx_font_italic">model.train(client[‘x’], client[‘y’], epochs=<math id="alg1.l5.1.m1.1" class="ltx_Math" alttext="n_{e}" display="inline"><semantics id="alg1.l5.1.m1.1a"><msub id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml"><mi id="alg1.l5.1.m1.1.1.2" xref="alg1.l5.1.m1.1.1.2.cmml">n</mi><mi id="alg1.l5.1.m1.1.1.3" xref="alg1.l5.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><apply id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.1.m1.1.1.1.cmml" xref="alg1.l5.1.m1.1.1">subscript</csymbol><ci id="alg1.l5.1.m1.1.1.2.cmml" xref="alg1.l5.1.m1.1.1.2">𝑛</ci><ci id="alg1.l5.1.m1.1.1.3.cmml" xref="alg1.l5.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">n_{e}</annotation></semantics></math>, batch_size=batch_size)</span>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.2.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>              <span id="alg1.l6.1" class="ltx_text ltx_font_italic">w_client <math id="alg1.l6.1.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l6.1.m1.1a"><mo stretchy="false" id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\leftarrow</annotation></semantics></math> model.get_weights()</span>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.4.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>              <span id="alg1.l7.2" class="ltx_text ltx_font_italic">w <math id="alg1.l7.1.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l7.1.m1.1a"><mo stretchy="false" id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\leftarrow</annotation></semantics></math> w + <math id="alg1.l7.2.m2.2" class="ltx_Math" alttext="\left(\frac{|client[`y^{\prime}]|}{\sum n}\cdot w\_client\right)" display="inline"><semantics id="alg1.l7.2.m2.2a"><mrow id="alg1.l7.2.m2.2.2.1" xref="alg1.l7.2.m2.2.2.1.1.cmml"><mo id="alg1.l7.2.m2.2.2.1.2" xref="alg1.l7.2.m2.2.2.1.1.cmml">(</mo><mrow id="alg1.l7.2.m2.2.2.1.1" xref="alg1.l7.2.m2.2.2.1.1.cmml"><mrow id="alg1.l7.2.m2.2.2.1.1.2" xref="alg1.l7.2.m2.2.2.1.1.2.cmml"><mfrac id="alg1.l7.2.m2.1.1" xref="alg1.l7.2.m2.1.1.cmml"><mrow id="alg1.l7.2.m2.1.1.1.1" xref="alg1.l7.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l7.2.m2.1.1.1.1.2" xref="alg1.l7.2.m2.1.1.1.2.1.cmml">|</mo><mrow id="alg1.l7.2.m2.1.1.1.1.1" xref="alg1.l7.2.m2.1.1.1.1.1.cmml"><mi id="alg1.l7.2.m2.1.1.1.1.1.3" xref="alg1.l7.2.m2.1.1.1.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.1.1.1.1.1.2" xref="alg1.l7.2.m2.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l7.2.m2.1.1.1.1.1.4" xref="alg1.l7.2.m2.1.1.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.1.1.1.1.1.2a" xref="alg1.l7.2.m2.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l7.2.m2.1.1.1.1.1.5" xref="alg1.l7.2.m2.1.1.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.1.1.1.1.1.2b" xref="alg1.l7.2.m2.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l7.2.m2.1.1.1.1.1.6" xref="alg1.l7.2.m2.1.1.1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.1.1.1.1.1.2c" xref="alg1.l7.2.m2.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l7.2.m2.1.1.1.1.1.7" xref="alg1.l7.2.m2.1.1.1.1.1.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.1.1.1.1.1.2d" xref="alg1.l7.2.m2.1.1.1.1.1.2.cmml">​</mo><mi id="alg1.l7.2.m2.1.1.1.1.1.8" xref="alg1.l7.2.m2.1.1.1.1.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.1.1.1.1.1.2e" xref="alg1.l7.2.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l7.2.m2.1.1.1.1.1.1.1" xref="alg1.l7.2.m2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l7.2.m2.1.1.1.1.1.1.1.2" xref="alg1.l7.2.m2.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l7.2.m2.1.1.1.1.1.1.1.1" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.2" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.2.cmml">`</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.1" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.1.cmml">​</mo><msup id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.2" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mo id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.3" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo stretchy="false" id="alg1.l7.2.m2.1.1.1.1.1.1.1.3" xref="alg1.l7.2.m2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo stretchy="false" id="alg1.l7.2.m2.1.1.1.1.3" xref="alg1.l7.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mstyle scriptlevel="-1" id="alg1.l7.2.m2.1.1.3" xref="alg1.l7.2.m2.1.1.3.cmml"><mrow id="alg1.l7.2.m2.1.1.3a" xref="alg1.l7.2.m2.1.1.3.cmml"><mo id="alg1.l7.2.m2.1.1.3.1" xref="alg1.l7.2.m2.1.1.3.1.cmml">∑</mo><mi id="alg1.l7.2.m2.1.1.3.2" xref="alg1.l7.2.m2.1.1.3.2.cmml">n</mi></mrow></mstyle></mfrac><mo lspace="0.222em" rspace="0.222em" id="alg1.l7.2.m2.2.2.1.1.2.1" xref="alg1.l7.2.m2.2.2.1.1.2.1.cmml">⋅</mo><mi id="alg1.l7.2.m2.2.2.1.1.2.2" xref="alg1.l7.2.m2.2.2.1.1.2.2.cmml">w</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.2.2.1.1.1" xref="alg1.l7.2.m2.2.2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l7.2.m2.2.2.1.1.3" xref="alg1.l7.2.m2.2.2.1.1.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.2.2.1.1.1a" xref="alg1.l7.2.m2.2.2.1.1.1.cmml">​</mo><mi id="alg1.l7.2.m2.2.2.1.1.4" xref="alg1.l7.2.m2.2.2.1.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.2.2.1.1.1b" xref="alg1.l7.2.m2.2.2.1.1.1.cmml">​</mo><mi id="alg1.l7.2.m2.2.2.1.1.5" xref="alg1.l7.2.m2.2.2.1.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.2.2.1.1.1c" xref="alg1.l7.2.m2.2.2.1.1.1.cmml">​</mo><mi id="alg1.l7.2.m2.2.2.1.1.6" xref="alg1.l7.2.m2.2.2.1.1.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.2.2.1.1.1d" xref="alg1.l7.2.m2.2.2.1.1.1.cmml">​</mo><mi id="alg1.l7.2.m2.2.2.1.1.7" xref="alg1.l7.2.m2.2.2.1.1.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.2.2.1.1.1e" xref="alg1.l7.2.m2.2.2.1.1.1.cmml">​</mo><mi id="alg1.l7.2.m2.2.2.1.1.8" xref="alg1.l7.2.m2.2.2.1.1.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l7.2.m2.2.2.1.1.1f" xref="alg1.l7.2.m2.2.2.1.1.1.cmml">​</mo><mi id="alg1.l7.2.m2.2.2.1.1.9" xref="alg1.l7.2.m2.2.2.1.1.9.cmml">t</mi></mrow><mo id="alg1.l7.2.m2.2.2.1.3" xref="alg1.l7.2.m2.2.2.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.2.m2.2b"><apply id="alg1.l7.2.m2.2.2.1.1.cmml" xref="alg1.l7.2.m2.2.2.1"><times id="alg1.l7.2.m2.2.2.1.1.1.cmml" xref="alg1.l7.2.m2.2.2.1.1.1"></times><apply id="alg1.l7.2.m2.2.2.1.1.2.cmml" xref="alg1.l7.2.m2.2.2.1.1.2"><ci id="alg1.l7.2.m2.2.2.1.1.2.1.cmml" xref="alg1.l7.2.m2.2.2.1.1.2.1">⋅</ci><apply id="alg1.l7.2.m2.1.1.cmml" xref="alg1.l7.2.m2.1.1"><divide id="alg1.l7.2.m2.1.1.2.cmml" xref="alg1.l7.2.m2.1.1"></divide><apply id="alg1.l7.2.m2.1.1.1.2.cmml" xref="alg1.l7.2.m2.1.1.1.1"><abs id="alg1.l7.2.m2.1.1.1.2.1.cmml" xref="alg1.l7.2.m2.1.1.1.1.2"></abs><apply id="alg1.l7.2.m2.1.1.1.1.1.cmml" xref="alg1.l7.2.m2.1.1.1.1.1"><times id="alg1.l7.2.m2.1.1.1.1.1.2.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.2"></times><ci id="alg1.l7.2.m2.1.1.1.1.1.3.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.3">𝑐</ci><ci id="alg1.l7.2.m2.1.1.1.1.1.4.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.4">𝑙</ci><ci id="alg1.l7.2.m2.1.1.1.1.1.5.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.5">𝑖</ci><ci id="alg1.l7.2.m2.1.1.1.1.1.6.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.6">𝑒</ci><ci id="alg1.l7.2.m2.1.1.1.1.1.7.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.7">𝑛</ci><ci id="alg1.l7.2.m2.1.1.1.1.1.8.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.8">𝑡</ci><apply id="alg1.l7.2.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l7.2.m2.1.1.1.1.1.1.2.1.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1"><times id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.2">`</ci><apply id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l7.2.m2.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply><apply id="alg1.l7.2.m2.1.1.3.cmml" xref="alg1.l7.2.m2.1.1.3"><sum id="alg1.l7.2.m2.1.1.3.1.cmml" xref="alg1.l7.2.m2.1.1.3.1"></sum><ci id="alg1.l7.2.m2.1.1.3.2.cmml" xref="alg1.l7.2.m2.1.1.3.2">𝑛</ci></apply></apply><ci id="alg1.l7.2.m2.2.2.1.1.2.2.cmml" xref="alg1.l7.2.m2.2.2.1.1.2.2">𝑤</ci></apply><ci id="alg1.l7.2.m2.2.2.1.1.3.cmml" xref="alg1.l7.2.m2.2.2.1.1.3">_</ci><ci id="alg1.l7.2.m2.2.2.1.1.4.cmml" xref="alg1.l7.2.m2.2.2.1.1.4">𝑐</ci><ci id="alg1.l7.2.m2.2.2.1.1.5.cmml" xref="alg1.l7.2.m2.2.2.1.1.5">𝑙</ci><ci id="alg1.l7.2.m2.2.2.1.1.6.cmml" xref="alg1.l7.2.m2.2.2.1.1.6">𝑖</ci><ci id="alg1.l7.2.m2.2.2.1.1.7.cmml" xref="alg1.l7.2.m2.2.2.1.1.7">𝑒</ci><ci id="alg1.l7.2.m2.2.2.1.1.8.cmml" xref="alg1.l7.2.m2.2.2.1.1.8">𝑛</ci><ci id="alg1.l7.2.m2.2.2.1.1.9.cmml" xref="alg1.l7.2.m2.2.2.1.1.9">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.2.m2.2c">\left(\frac{|client[`y^{\prime}]|}{\sum n}\cdot w\_client\right)</annotation></semantics></math></span> <span id="alg1.l7.3" class="ltx_text" style="float:right;"><math id="alg1.l7.3.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l7.3.m1.1a"><mo id="alg1.l7.3.m1.1.1" xref="alg1.l7.3.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.3.m1.1b"><ci id="alg1.l7.3.m1.1.1.cmml" xref="alg1.l7.3.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.3.m1.1c">\triangleright</annotation></semantics></math> Add to the list
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>         <span id="alg1.l8.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>         <math id="alg1.l9.m1.1" class="ltx_Math" alttext="w\leftarrow\sum w" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">w</mi><mo rspace="0.111em" stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mo id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml">∑</mo><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">w</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑤</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><sum id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"></sum><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">w\leftarrow\sum w</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.2.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>         <span id="alg1.l10.3" class="ltx_text ltx_font_italic">model.set_weights(w)</span>
<span id="alg1.l10.1" class="ltx_text" style="float:right;"><math id="alg1.l10.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation></semantics></math> Update the model with the new aggregated weights
</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     <math id="alg1.l12.m1.1" class="ltx_Math" alttext="j\leftarrow 1" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">j</mi><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mn id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑗</ci><cn type="integer" id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">j\leftarrow 1</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l13.m1.1" class="ltx_Math" alttext="client\in clients" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mrow id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.2.1" xref="alg1.l13.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.2.1a" xref="alg1.l13.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.2.4" xref="alg1.l13.m1.1.1.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.2.1b" xref="alg1.l13.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.2.5" xref="alg1.l13.m1.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.2.1c" xref="alg1.l13.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.2.6" xref="alg1.l13.m1.1.1.2.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.2.1d" xref="alg1.l13.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.2.7" xref="alg1.l13.m1.1.1.2.7.cmml">t</mi></mrow><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">∈</mo><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1a" xref="alg1.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.3.4" xref="alg1.l13.m1.1.1.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1b" xref="alg1.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.3.5" xref="alg1.l13.m1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1c" xref="alg1.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.3.6" xref="alg1.l13.m1.1.1.3.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1d" xref="alg1.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.3.7" xref="alg1.l13.m1.1.1.3.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1e" xref="alg1.l13.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l13.m1.1.1.3.8" xref="alg1.l13.m1.1.1.3.8.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><in id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></in><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><times id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2.1"></times><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝑐</ci><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">𝑙</ci><ci id="alg1.l13.m1.1.1.2.4.cmml" xref="alg1.l13.m1.1.1.2.4">𝑖</ci><ci id="alg1.l13.m1.1.1.2.5.cmml" xref="alg1.l13.m1.1.1.2.5">𝑒</ci><ci id="alg1.l13.m1.1.1.2.6.cmml" xref="alg1.l13.m1.1.1.2.6">𝑛</ci><ci id="alg1.l13.m1.1.1.2.7.cmml" xref="alg1.l13.m1.1.1.2.7">𝑡</ci></apply><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><times id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></times><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝑐</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑙</ci><ci id="alg1.l13.m1.1.1.3.4.cmml" xref="alg1.l13.m1.1.1.3.4">𝑖</ci><ci id="alg1.l13.m1.1.1.3.5.cmml" xref="alg1.l13.m1.1.1.3.5">𝑒</ci><ci id="alg1.l13.m1.1.1.3.6.cmml" xref="alg1.l13.m1.1.1.3.6">𝑛</ci><ci id="alg1.l13.m1.1.1.3.7.cmml" xref="alg1.l13.m1.1.1.3.7">𝑡</ci><ci id="alg1.l13.m1.1.1.3.8.cmml" xref="alg1.l13.m1.1.1.3.8">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">client\in clients</annotation></semantics></math> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.2.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>         <span id="alg1.l14.1" class="ltx_text ltx_font_italic">model.train(client[‘x’], client[‘y’], epochs=<math id="alg1.l14.1.m1.1" class="ltx_Math" alttext="n_{e}" display="inline"><semantics id="alg1.l14.1.m1.1a"><msub id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml"><mi id="alg1.l14.1.m1.1.1.2" xref="alg1.l14.1.m1.1.1.2.cmml">n</mi><mi id="alg1.l14.1.m1.1.1.3" xref="alg1.l14.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><apply id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l14.1.m1.1.1.1.cmml" xref="alg1.l14.1.m1.1.1">subscript</csymbol><ci id="alg1.l14.1.m1.1.1.2.cmml" xref="alg1.l14.1.m1.1.1.2">𝑛</ci><ci id="alg1.l14.1.m1.1.1.3.cmml" xref="alg1.l14.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">n_{e}</annotation></semantics></math>, batch_size=batch_size)</span>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>         <span id="alg1.l15.2" class="ltx_text ltx_font_italic">model.save(f‘model_ind_</span>{<span id="alg1.l15.3" class="ltx_text ltx_font_italic">j</span>}<span id="alg1.l15.4" class="ltx_text ltx_font_italic">.h5’)</span>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>         <math id="alg1.l16.m1.1" class="ltx_Math" alttext="j\leftarrow j+1" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">j</mi><mo stretchy="false" id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml">←</mo><mrow id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml">j</mi><mo id="alg1.l16.m1.1.1.3.1" xref="alg1.l16.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1">←</ci><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">𝑗</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><plus id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3.1"></plus><ci id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2">𝑗</ci><cn type="integer" id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">j\leftarrow j+1</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>     <span id="alg1.l17.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l17.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span><span id="alg1.l18.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.3" class="ltx_text ltx_font_bold">function</span>
</div>
</div>
</div>
</div>
</figure>
<div id="S4.SS2.p9" class="ltx_para">
<p id="S4.SS2.p9.4" class="ltx_p">In this sense, as the federated training can be carried out in each zone in parallel, it is desirable that the total number of epochs that are trained individually (<math id="S4.SS2.p9.1.m1.1" class="ltx_Math" alttext="N_{e}^{(I)}" display="inline"><semantics id="S4.SS2.p9.1.m1.1a"><msubsup id="S4.SS2.p9.1.m1.1.2" xref="S4.SS2.p9.1.m1.1.2.cmml"><mi id="S4.SS2.p9.1.m1.1.2.2.2" xref="S4.SS2.p9.1.m1.1.2.2.2.cmml">N</mi><mi id="S4.SS2.p9.1.m1.1.2.2.3" xref="S4.SS2.p9.1.m1.1.2.2.3.cmml">e</mi><mrow id="S4.SS2.p9.1.m1.1.1.1.3" xref="S4.SS2.p9.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p9.1.m1.1.1.1.3.1" xref="S4.SS2.p9.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p9.1.m1.1.1.1.1" xref="S4.SS2.p9.1.m1.1.1.1.1.cmml">I</mi><mo stretchy="false" id="S4.SS2.p9.1.m1.1.1.1.3.2" xref="S4.SS2.p9.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.1.m1.1b"><apply id="S4.SS2.p9.1.m1.1.2.cmml" xref="S4.SS2.p9.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.1.m1.1.2.1.cmml" xref="S4.SS2.p9.1.m1.1.2">superscript</csymbol><apply id="S4.SS2.p9.1.m1.1.2.2.cmml" xref="S4.SS2.p9.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.1.m1.1.2.2.1.cmml" xref="S4.SS2.p9.1.m1.1.2">subscript</csymbol><ci id="S4.SS2.p9.1.m1.1.2.2.2.cmml" xref="S4.SS2.p9.1.m1.1.2.2.2">𝑁</ci><ci id="S4.SS2.p9.1.m1.1.2.2.3.cmml" xref="S4.SS2.p9.1.m1.1.2.2.3">𝑒</ci></apply><ci id="S4.SS2.p9.1.m1.1.1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.1.m1.1c">N_{e}^{(I)}</annotation></semantics></math>) is equal to the number of epochs that the model is trained locally in the federated scheme (<math id="S4.SS2.p9.2.m2.1" class="ltx_Math" alttext="N_{e}^{(FL)}" display="inline"><semantics id="S4.SS2.p9.2.m2.1a"><msubsup id="S4.SS2.p9.2.m2.1.2" xref="S4.SS2.p9.2.m2.1.2.cmml"><mi id="S4.SS2.p9.2.m2.1.2.2.2" xref="S4.SS2.p9.2.m2.1.2.2.2.cmml">N</mi><mi id="S4.SS2.p9.2.m2.1.2.2.3" xref="S4.SS2.p9.2.m2.1.2.2.3.cmml">e</mi><mrow id="S4.SS2.p9.2.m2.1.1.1.1" xref="S4.SS2.p9.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p9.2.m2.1.1.1.1.2" xref="S4.SS2.p9.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p9.2.m2.1.1.1.1.1" xref="S4.SS2.p9.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.p9.2.m2.1.1.1.1.1.2" xref="S4.SS2.p9.2.m2.1.1.1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p9.2.m2.1.1.1.1.1.1" xref="S4.SS2.p9.2.m2.1.1.1.1.1.1.cmml">​</mo><mi id="S4.SS2.p9.2.m2.1.1.1.1.1.3" xref="S4.SS2.p9.2.m2.1.1.1.1.1.3.cmml">L</mi></mrow><mo stretchy="false" id="S4.SS2.p9.2.m2.1.1.1.1.3" xref="S4.SS2.p9.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.2.m2.1b"><apply id="S4.SS2.p9.2.m2.1.2.cmml" xref="S4.SS2.p9.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.2.m2.1.2.1.cmml" xref="S4.SS2.p9.2.m2.1.2">superscript</csymbol><apply id="S4.SS2.p9.2.m2.1.2.2.cmml" xref="S4.SS2.p9.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.2.m2.1.2.2.1.cmml" xref="S4.SS2.p9.2.m2.1.2">subscript</csymbol><ci id="S4.SS2.p9.2.m2.1.2.2.2.cmml" xref="S4.SS2.p9.2.m2.1.2.2.2">𝑁</ci><ci id="S4.SS2.p9.2.m2.1.2.2.3.cmml" xref="S4.SS2.p9.2.m2.1.2.2.3">𝑒</ci></apply><apply id="S4.SS2.p9.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1.1.1"><times id="S4.SS2.p9.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1.1.1.1.1"></times><ci id="S4.SS2.p9.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p9.2.m2.1.1.1.1.1.2">𝐹</ci><ci id="S4.SS2.p9.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p9.2.m2.1.1.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.2.m2.1c">N_{e}^{(FL)}</annotation></semantics></math>) times the number of rounds (<math id="S4.SS2.p9.3.m3.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="S4.SS2.p9.3.m3.1a"><msub id="S4.SS2.p9.3.m3.1.1" xref="S4.SS2.p9.3.m3.1.1.cmml"><mi id="S4.SS2.p9.3.m3.1.1.2" xref="S4.SS2.p9.3.m3.1.1.2.cmml">N</mi><mi id="S4.SS2.p9.3.m3.1.1.3" xref="S4.SS2.p9.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.3.m3.1b"><apply id="S4.SS2.p9.3.m3.1.1.cmml" xref="S4.SS2.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.3.m3.1.1.1.cmml" xref="S4.SS2.p9.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p9.3.m3.1.1.2.cmml" xref="S4.SS2.p9.3.m3.1.1.2">𝑁</ci><ci id="S4.SS2.p9.3.m3.1.1.3.cmml" xref="S4.SS2.p9.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.3.m3.1c">N_{r}</annotation></semantics></math>) of the federated training plus the number of epochs the model is trained later in each zone (<math id="S4.SS2.p9.4.m4.1" class="ltx_Math" alttext="N_{e}^{(L)}" display="inline"><semantics id="S4.SS2.p9.4.m4.1a"><msubsup id="S4.SS2.p9.4.m4.1.2" xref="S4.SS2.p9.4.m4.1.2.cmml"><mi id="S4.SS2.p9.4.m4.1.2.2.2" xref="S4.SS2.p9.4.m4.1.2.2.2.cmml">N</mi><mi id="S4.SS2.p9.4.m4.1.2.2.3" xref="S4.SS2.p9.4.m4.1.2.2.3.cmml">e</mi><mrow id="S4.SS2.p9.4.m4.1.1.1.3" xref="S4.SS2.p9.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p9.4.m4.1.1.1.3.1" xref="S4.SS2.p9.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.p9.4.m4.1.1.1.1" xref="S4.SS2.p9.4.m4.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS2.p9.4.m4.1.1.1.3.2" xref="S4.SS2.p9.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.4.m4.1b"><apply id="S4.SS2.p9.4.m4.1.2.cmml" xref="S4.SS2.p9.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.4.m4.1.2.1.cmml" xref="S4.SS2.p9.4.m4.1.2">superscript</csymbol><apply id="S4.SS2.p9.4.m4.1.2.2.cmml" xref="S4.SS2.p9.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.4.m4.1.2.2.1.cmml" xref="S4.SS2.p9.4.m4.1.2">subscript</csymbol><ci id="S4.SS2.p9.4.m4.1.2.2.2.cmml" xref="S4.SS2.p9.4.m4.1.2.2.2">𝑁</ci><ci id="S4.SS2.p9.4.m4.1.2.2.3.cmml" xref="S4.SS2.p9.4.m4.1.2.2.3">𝑒</ci></apply><ci id="S4.SS2.p9.4.m4.1.1.1.1.cmml" xref="S4.SS2.p9.4.m4.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.4.m4.1c">N_{e}^{(L)}</annotation></semantics></math>) in the <span id="S4.SS2.p9.4.1" class="ltx_text ltx_font_italic">adapFL</span> approach, i.e:</p>
</div>
<div id="S4.SS2.p10" class="ltx_para">
<table id="S4.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.Ex1.m1.3" class="ltx_Math" alttext="N_{e}^{(I)}=N_{r}\cdot N_{e}^{(FL)}+N_{e}^{(L)}" display="block"><semantics id="S4.Ex1.m1.3a"><mrow id="S4.Ex1.m1.3.4" xref="S4.Ex1.m1.3.4.cmml"><msubsup id="S4.Ex1.m1.3.4.2" xref="S4.Ex1.m1.3.4.2.cmml"><mi id="S4.Ex1.m1.3.4.2.2.2" xref="S4.Ex1.m1.3.4.2.2.2.cmml">N</mi><mi id="S4.Ex1.m1.3.4.2.2.3" xref="S4.Ex1.m1.3.4.2.2.3.cmml">e</mi><mrow id="S4.Ex1.m1.1.1.1.3" xref="S4.Ex1.m1.3.4.2.cmml"><mo stretchy="false" id="S4.Ex1.m1.1.1.1.3.1" xref="S4.Ex1.m1.3.4.2.cmml">(</mo><mi id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml">I</mi><mo stretchy="false" id="S4.Ex1.m1.1.1.1.3.2" xref="S4.Ex1.m1.3.4.2.cmml">)</mo></mrow></msubsup><mo id="S4.Ex1.m1.3.4.1" xref="S4.Ex1.m1.3.4.1.cmml">=</mo><mrow id="S4.Ex1.m1.3.4.3" xref="S4.Ex1.m1.3.4.3.cmml"><mrow id="S4.Ex1.m1.3.4.3.2" xref="S4.Ex1.m1.3.4.3.2.cmml"><msub id="S4.Ex1.m1.3.4.3.2.2" xref="S4.Ex1.m1.3.4.3.2.2.cmml"><mi id="S4.Ex1.m1.3.4.3.2.2.2" xref="S4.Ex1.m1.3.4.3.2.2.2.cmml">N</mi><mi id="S4.Ex1.m1.3.4.3.2.2.3" xref="S4.Ex1.m1.3.4.3.2.2.3.cmml">r</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.Ex1.m1.3.4.3.2.1" xref="S4.Ex1.m1.3.4.3.2.1.cmml">⋅</mo><msubsup id="S4.Ex1.m1.3.4.3.2.3" xref="S4.Ex1.m1.3.4.3.2.3.cmml"><mi id="S4.Ex1.m1.3.4.3.2.3.2.2" xref="S4.Ex1.m1.3.4.3.2.3.2.2.cmml">N</mi><mi id="S4.Ex1.m1.3.4.3.2.3.2.3" xref="S4.Ex1.m1.3.4.3.2.3.2.3.cmml">e</mi><mrow id="S4.Ex1.m1.2.2.1.1" xref="S4.Ex1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.2" xref="S4.Ex1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.2.2.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.cmml"><mi id="S4.Ex1.m1.2.2.1.1.1.2" xref="S4.Ex1.m1.2.2.1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.1.1.1.1" xref="S4.Ex1.m1.2.2.1.1.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.1.1.1.3" xref="S4.Ex1.m1.2.2.1.1.1.3.cmml">L</mi></mrow><mo stretchy="false" id="S4.Ex1.m1.2.2.1.1.3" xref="S4.Ex1.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.Ex1.m1.3.4.3.1" xref="S4.Ex1.m1.3.4.3.1.cmml">+</mo><msubsup id="S4.Ex1.m1.3.4.3.3" xref="S4.Ex1.m1.3.4.3.3.cmml"><mi id="S4.Ex1.m1.3.4.3.3.2.2" xref="S4.Ex1.m1.3.4.3.3.2.2.cmml">N</mi><mi id="S4.Ex1.m1.3.4.3.3.2.3" xref="S4.Ex1.m1.3.4.3.3.2.3.cmml">e</mi><mrow id="S4.Ex1.m1.3.3.1.3" xref="S4.Ex1.m1.3.4.3.3.cmml"><mo stretchy="false" id="S4.Ex1.m1.3.3.1.3.1" xref="S4.Ex1.m1.3.4.3.3.cmml">(</mo><mi id="S4.Ex1.m1.3.3.1.1" xref="S4.Ex1.m1.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S4.Ex1.m1.3.3.1.3.2" xref="S4.Ex1.m1.3.4.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.3b"><apply id="S4.Ex1.m1.3.4.cmml" xref="S4.Ex1.m1.3.4"><eq id="S4.Ex1.m1.3.4.1.cmml" xref="S4.Ex1.m1.3.4.1"></eq><apply id="S4.Ex1.m1.3.4.2.cmml" xref="S4.Ex1.m1.3.4.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.4.2.1.cmml" xref="S4.Ex1.m1.3.4.2">superscript</csymbol><apply id="S4.Ex1.m1.3.4.2.2.cmml" xref="S4.Ex1.m1.3.4.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.4.2.2.1.cmml" xref="S4.Ex1.m1.3.4.2">subscript</csymbol><ci id="S4.Ex1.m1.3.4.2.2.2.cmml" xref="S4.Ex1.m1.3.4.2.2.2">𝑁</ci><ci id="S4.Ex1.m1.3.4.2.2.3.cmml" xref="S4.Ex1.m1.3.4.2.2.3">𝑒</ci></apply><ci id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">𝐼</ci></apply><apply id="S4.Ex1.m1.3.4.3.cmml" xref="S4.Ex1.m1.3.4.3"><plus id="S4.Ex1.m1.3.4.3.1.cmml" xref="S4.Ex1.m1.3.4.3.1"></plus><apply id="S4.Ex1.m1.3.4.3.2.cmml" xref="S4.Ex1.m1.3.4.3.2"><ci id="S4.Ex1.m1.3.4.3.2.1.cmml" xref="S4.Ex1.m1.3.4.3.2.1">⋅</ci><apply id="S4.Ex1.m1.3.4.3.2.2.cmml" xref="S4.Ex1.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.4.3.2.2.1.cmml" xref="S4.Ex1.m1.3.4.3.2.2">subscript</csymbol><ci id="S4.Ex1.m1.3.4.3.2.2.2.cmml" xref="S4.Ex1.m1.3.4.3.2.2.2">𝑁</ci><ci id="S4.Ex1.m1.3.4.3.2.2.3.cmml" xref="S4.Ex1.m1.3.4.3.2.2.3">𝑟</ci></apply><apply id="S4.Ex1.m1.3.4.3.2.3.cmml" xref="S4.Ex1.m1.3.4.3.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.4.3.2.3.1.cmml" xref="S4.Ex1.m1.3.4.3.2.3">superscript</csymbol><apply id="S4.Ex1.m1.3.4.3.2.3.2.cmml" xref="S4.Ex1.m1.3.4.3.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.4.3.2.3.2.1.cmml" xref="S4.Ex1.m1.3.4.3.2.3">subscript</csymbol><ci id="S4.Ex1.m1.3.4.3.2.3.2.2.cmml" xref="S4.Ex1.m1.3.4.3.2.3.2.2">𝑁</ci><ci id="S4.Ex1.m1.3.4.3.2.3.2.3.cmml" xref="S4.Ex1.m1.3.4.3.2.3.2.3">𝑒</ci></apply><apply id="S4.Ex1.m1.2.2.1.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1"><times id="S4.Ex1.m1.2.2.1.1.1.1.cmml" xref="S4.Ex1.m1.2.2.1.1.1.1"></times><ci id="S4.Ex1.m1.2.2.1.1.1.2.cmml" xref="S4.Ex1.m1.2.2.1.1.1.2">𝐹</ci><ci id="S4.Ex1.m1.2.2.1.1.1.3.cmml" xref="S4.Ex1.m1.2.2.1.1.1.3">𝐿</ci></apply></apply></apply><apply id="S4.Ex1.m1.3.4.3.3.cmml" xref="S4.Ex1.m1.3.4.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.4.3.3.1.cmml" xref="S4.Ex1.m1.3.4.3.3">superscript</csymbol><apply id="S4.Ex1.m1.3.4.3.3.2.cmml" xref="S4.Ex1.m1.3.4.3.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.4.3.3.2.1.cmml" xref="S4.Ex1.m1.3.4.3.3">subscript</csymbol><ci id="S4.Ex1.m1.3.4.3.3.2.2.cmml" xref="S4.Ex1.m1.3.4.3.3.2.2">𝑁</ci><ci id="S4.Ex1.m1.3.4.3.3.2.3.cmml" xref="S4.Ex1.m1.3.4.3.3.2.3">𝑒</ci></apply><ci id="S4.Ex1.m1.3.3.1.1.cmml" xref="S4.Ex1.m1.3.3.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.3c">N_{e}^{(I)}=N_{r}\cdot N_{e}^{(FL)}+N_{e}^{(L)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p11" class="ltx_para">
<p id="S4.SS2.p11.4" class="ltx_p">In this final implemented model the following values have been fixed: <math id="S4.SS2.p11.1.m1.1" class="ltx_Math" alttext="N_{e}^{(I)}=100" display="inline"><semantics id="S4.SS2.p11.1.m1.1a"><mrow id="S4.SS2.p11.1.m1.1.2" xref="S4.SS2.p11.1.m1.1.2.cmml"><msubsup id="S4.SS2.p11.1.m1.1.2.2" xref="S4.SS2.p11.1.m1.1.2.2.cmml"><mi id="S4.SS2.p11.1.m1.1.2.2.2.2" xref="S4.SS2.p11.1.m1.1.2.2.2.2.cmml">N</mi><mi id="S4.SS2.p11.1.m1.1.2.2.2.3" xref="S4.SS2.p11.1.m1.1.2.2.2.3.cmml">e</mi><mrow id="S4.SS2.p11.1.m1.1.1.1.3" xref="S4.SS2.p11.1.m1.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p11.1.m1.1.1.1.3.1" xref="S4.SS2.p11.1.m1.1.2.2.cmml">(</mo><mi id="S4.SS2.p11.1.m1.1.1.1.1" xref="S4.SS2.p11.1.m1.1.1.1.1.cmml">I</mi><mo stretchy="false" id="S4.SS2.p11.1.m1.1.1.1.3.2" xref="S4.SS2.p11.1.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.p11.1.m1.1.2.1" xref="S4.SS2.p11.1.m1.1.2.1.cmml">=</mo><mn id="S4.SS2.p11.1.m1.1.2.3" xref="S4.SS2.p11.1.m1.1.2.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p11.1.m1.1b"><apply id="S4.SS2.p11.1.m1.1.2.cmml" xref="S4.SS2.p11.1.m1.1.2"><eq id="S4.SS2.p11.1.m1.1.2.1.cmml" xref="S4.SS2.p11.1.m1.1.2.1"></eq><apply id="S4.SS2.p11.1.m1.1.2.2.cmml" xref="S4.SS2.p11.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p11.1.m1.1.2.2.1.cmml" xref="S4.SS2.p11.1.m1.1.2.2">superscript</csymbol><apply id="S4.SS2.p11.1.m1.1.2.2.2.cmml" xref="S4.SS2.p11.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p11.1.m1.1.2.2.2.1.cmml" xref="S4.SS2.p11.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.p11.1.m1.1.2.2.2.2.cmml" xref="S4.SS2.p11.1.m1.1.2.2.2.2">𝑁</ci><ci id="S4.SS2.p11.1.m1.1.2.2.2.3.cmml" xref="S4.SS2.p11.1.m1.1.2.2.2.3">𝑒</ci></apply><ci id="S4.SS2.p11.1.m1.1.1.1.1.cmml" xref="S4.SS2.p11.1.m1.1.1.1.1">𝐼</ci></apply><cn type="integer" id="S4.SS2.p11.1.m1.1.2.3.cmml" xref="S4.SS2.p11.1.m1.1.2.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p11.1.m1.1c">N_{e}^{(I)}=100</annotation></semantics></math>, <math id="S4.SS2.p11.2.m2.2" class="ltx_Math" alttext="N_{e}^{(FL)}=N_{e}^{(L)}=10" display="inline"><semantics id="S4.SS2.p11.2.m2.2a"><mrow id="S4.SS2.p11.2.m2.2.3" xref="S4.SS2.p11.2.m2.2.3.cmml"><msubsup id="S4.SS2.p11.2.m2.2.3.2" xref="S4.SS2.p11.2.m2.2.3.2.cmml"><mi id="S4.SS2.p11.2.m2.2.3.2.2.2" xref="S4.SS2.p11.2.m2.2.3.2.2.2.cmml">N</mi><mi id="S4.SS2.p11.2.m2.2.3.2.2.3" xref="S4.SS2.p11.2.m2.2.3.2.2.3.cmml">e</mi><mrow id="S4.SS2.p11.2.m2.1.1.1.1" xref="S4.SS2.p11.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p11.2.m2.1.1.1.1.2" xref="S4.SS2.p11.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p11.2.m2.1.1.1.1.1" xref="S4.SS2.p11.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.p11.2.m2.1.1.1.1.1.2" xref="S4.SS2.p11.2.m2.1.1.1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p11.2.m2.1.1.1.1.1.1" xref="S4.SS2.p11.2.m2.1.1.1.1.1.1.cmml">​</mo><mi id="S4.SS2.p11.2.m2.1.1.1.1.1.3" xref="S4.SS2.p11.2.m2.1.1.1.1.1.3.cmml">L</mi></mrow><mo stretchy="false" id="S4.SS2.p11.2.m2.1.1.1.1.3" xref="S4.SS2.p11.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.p11.2.m2.2.3.3" xref="S4.SS2.p11.2.m2.2.3.3.cmml">=</mo><msubsup id="S4.SS2.p11.2.m2.2.3.4" xref="S4.SS2.p11.2.m2.2.3.4.cmml"><mi id="S4.SS2.p11.2.m2.2.3.4.2.2" xref="S4.SS2.p11.2.m2.2.3.4.2.2.cmml">N</mi><mi id="S4.SS2.p11.2.m2.2.3.4.2.3" xref="S4.SS2.p11.2.m2.2.3.4.2.3.cmml">e</mi><mrow id="S4.SS2.p11.2.m2.2.2.1.3" xref="S4.SS2.p11.2.m2.2.3.4.cmml"><mo stretchy="false" id="S4.SS2.p11.2.m2.2.2.1.3.1" xref="S4.SS2.p11.2.m2.2.3.4.cmml">(</mo><mi id="S4.SS2.p11.2.m2.2.2.1.1" xref="S4.SS2.p11.2.m2.2.2.1.1.cmml">L</mi><mo stretchy="false" id="S4.SS2.p11.2.m2.2.2.1.3.2" xref="S4.SS2.p11.2.m2.2.3.4.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.p11.2.m2.2.3.5" xref="S4.SS2.p11.2.m2.2.3.5.cmml">=</mo><mn id="S4.SS2.p11.2.m2.2.3.6" xref="S4.SS2.p11.2.m2.2.3.6.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p11.2.m2.2b"><apply id="S4.SS2.p11.2.m2.2.3.cmml" xref="S4.SS2.p11.2.m2.2.3"><and id="S4.SS2.p11.2.m2.2.3a.cmml" xref="S4.SS2.p11.2.m2.2.3"></and><apply id="S4.SS2.p11.2.m2.2.3b.cmml" xref="S4.SS2.p11.2.m2.2.3"><eq id="S4.SS2.p11.2.m2.2.3.3.cmml" xref="S4.SS2.p11.2.m2.2.3.3"></eq><apply id="S4.SS2.p11.2.m2.2.3.2.cmml" xref="S4.SS2.p11.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p11.2.m2.2.3.2.1.cmml" xref="S4.SS2.p11.2.m2.2.3.2">superscript</csymbol><apply id="S4.SS2.p11.2.m2.2.3.2.2.cmml" xref="S4.SS2.p11.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p11.2.m2.2.3.2.2.1.cmml" xref="S4.SS2.p11.2.m2.2.3.2">subscript</csymbol><ci id="S4.SS2.p11.2.m2.2.3.2.2.2.cmml" xref="S4.SS2.p11.2.m2.2.3.2.2.2">𝑁</ci><ci id="S4.SS2.p11.2.m2.2.3.2.2.3.cmml" xref="S4.SS2.p11.2.m2.2.3.2.2.3">𝑒</ci></apply><apply id="S4.SS2.p11.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p11.2.m2.1.1.1.1"><times id="S4.SS2.p11.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p11.2.m2.1.1.1.1.1.1"></times><ci id="S4.SS2.p11.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p11.2.m2.1.1.1.1.1.2">𝐹</ci><ci id="S4.SS2.p11.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p11.2.m2.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S4.SS2.p11.2.m2.2.3.4.cmml" xref="S4.SS2.p11.2.m2.2.3.4"><csymbol cd="ambiguous" id="S4.SS2.p11.2.m2.2.3.4.1.cmml" xref="S4.SS2.p11.2.m2.2.3.4">superscript</csymbol><apply id="S4.SS2.p11.2.m2.2.3.4.2.cmml" xref="S4.SS2.p11.2.m2.2.3.4"><csymbol cd="ambiguous" id="S4.SS2.p11.2.m2.2.3.4.2.1.cmml" xref="S4.SS2.p11.2.m2.2.3.4">subscript</csymbol><ci id="S4.SS2.p11.2.m2.2.3.4.2.2.cmml" xref="S4.SS2.p11.2.m2.2.3.4.2.2">𝑁</ci><ci id="S4.SS2.p11.2.m2.2.3.4.2.3.cmml" xref="S4.SS2.p11.2.m2.2.3.4.2.3">𝑒</ci></apply><ci id="S4.SS2.p11.2.m2.2.2.1.1.cmml" xref="S4.SS2.p11.2.m2.2.2.1.1">𝐿</ci></apply></apply><apply id="S4.SS2.p11.2.m2.2.3c.cmml" xref="S4.SS2.p11.2.m2.2.3"><eq id="S4.SS2.p11.2.m2.2.3.5.cmml" xref="S4.SS2.p11.2.m2.2.3.5"></eq><share href="#S4.SS2.p11.2.m2.2.3.4.cmml" id="S4.SS2.p11.2.m2.2.3d.cmml" xref="S4.SS2.p11.2.m2.2.3"></share><cn type="integer" id="S4.SS2.p11.2.m2.2.3.6.cmml" xref="S4.SS2.p11.2.m2.2.3.6">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p11.2.m2.2c">N_{e}^{(FL)}=N_{e}^{(L)}=10</annotation></semantics></math> and <math id="S4.SS2.p11.3.m3.1" class="ltx_Math" alttext="N_{r}=10" display="inline"><semantics id="S4.SS2.p11.3.m3.1a"><mrow id="S4.SS2.p11.3.m3.1.1" xref="S4.SS2.p11.3.m3.1.1.cmml"><msub id="S4.SS2.p11.3.m3.1.1.2" xref="S4.SS2.p11.3.m3.1.1.2.cmml"><mi id="S4.SS2.p11.3.m3.1.1.2.2" xref="S4.SS2.p11.3.m3.1.1.2.2.cmml">N</mi><mi id="S4.SS2.p11.3.m3.1.1.2.3" xref="S4.SS2.p11.3.m3.1.1.2.3.cmml">r</mi></msub><mo id="S4.SS2.p11.3.m3.1.1.1" xref="S4.SS2.p11.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p11.3.m3.1.1.3" xref="S4.SS2.p11.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p11.3.m3.1b"><apply id="S4.SS2.p11.3.m3.1.1.cmml" xref="S4.SS2.p11.3.m3.1.1"><eq id="S4.SS2.p11.3.m3.1.1.1.cmml" xref="S4.SS2.p11.3.m3.1.1.1"></eq><apply id="S4.SS2.p11.3.m3.1.1.2.cmml" xref="S4.SS2.p11.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p11.3.m3.1.1.2.1.cmml" xref="S4.SS2.p11.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p11.3.m3.1.1.2.2.cmml" xref="S4.SS2.p11.3.m3.1.1.2.2">𝑁</ci><ci id="S4.SS2.p11.3.m3.1.1.2.3.cmml" xref="S4.SS2.p11.3.m3.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S4.SS2.p11.3.m3.1.1.3.cmml" xref="S4.SS2.p11.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p11.3.m3.1c">N_{r}=10</annotation></semantics></math> for the classic FL approach and <math id="S4.SS2.p11.4.m4.1" class="ltx_Math" alttext="N_{r}=9" display="inline"><semantics id="S4.SS2.p11.4.m4.1a"><mrow id="S4.SS2.p11.4.m4.1.1" xref="S4.SS2.p11.4.m4.1.1.cmml"><msub id="S4.SS2.p11.4.m4.1.1.2" xref="S4.SS2.p11.4.m4.1.1.2.cmml"><mi id="S4.SS2.p11.4.m4.1.1.2.2" xref="S4.SS2.p11.4.m4.1.1.2.2.cmml">N</mi><mi id="S4.SS2.p11.4.m4.1.1.2.3" xref="S4.SS2.p11.4.m4.1.1.2.3.cmml">r</mi></msub><mo id="S4.SS2.p11.4.m4.1.1.1" xref="S4.SS2.p11.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p11.4.m4.1.1.3" xref="S4.SS2.p11.4.m4.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p11.4.m4.1b"><apply id="S4.SS2.p11.4.m4.1.1.cmml" xref="S4.SS2.p11.4.m4.1.1"><eq id="S4.SS2.p11.4.m4.1.1.1.cmml" xref="S4.SS2.p11.4.m4.1.1.1"></eq><apply id="S4.SS2.p11.4.m4.1.1.2.cmml" xref="S4.SS2.p11.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p11.4.m4.1.1.2.1.cmml" xref="S4.SS2.p11.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p11.4.m4.1.1.2.2.cmml" xref="S4.SS2.p11.4.m4.1.1.2.2">𝑁</ci><ci id="S4.SS2.p11.4.m4.1.1.2.3.cmml" xref="S4.SS2.p11.4.m4.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S4.SS2.p11.4.m4.1.1.3.cmml" xref="S4.SS2.p11.4.m4.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p11.4.m4.1c">N_{r}=9</annotation></semantics></math> for the <span id="S4.SS2.p11.4.1" class="ltx_text ltx_font_italic">adapFL</span> approach.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Convolutional neural architecture</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Both in the case of individual learning in each zone and in the case of the <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">adapFL</span> schema, we have developed a neural network architecture composed of the following convolutional layers presented in Table <a href="#S4.T3" title="Table 3 ‣ 4.3 Convolutional neural architecture ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (further detailed in Figures <a href="#A5.F16" title="Figure 16 ‣ Appendix E Diagram of the neural network implemented ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a> and <a href="#A5.F17" title="Figure 17 ‣ Appendix E Diagram of the neural network implemented ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a> from Appendix <a href="#A5" title="Appendix E Diagram of the neural network implemented ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>):</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Convolutional neural network implemented, layers, output shape, number of parameters and activation function applied.</figcaption>
<table id="S4.T3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T3.1.1.1.1.1" class="ltx_text ltx_font_bold">Layer (type)</span></th>
<th id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T3.1.1.1.2.1" class="ltx_text ltx_font_bold">Output Shape</span></th>
<th id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T3.1.1.1.3.1" class="ltx_text ltx_font_bold">Param #</span></th>
<th id="S4.T3.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T3.1.1.1.4.1" class="ltx_text ltx_font_bold">Activation</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<td id="S4.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">conv2d_46 (Conv2D)</td>
<td id="S4.T3.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">(None, 48, 48, 128)</td>
<td id="S4.T3.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">3584</td>
<td id="S4.T3.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">Relu</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<td id="S4.T3.1.3.2.1" class="ltx_td ltx_align_left">conv2d_47 (Conv2D)</td>
<td id="S4.T3.1.3.2.2" class="ltx_td ltx_align_left">(None, 46, 46, 64)</td>
<td id="S4.T3.1.3.2.3" class="ltx_td ltx_align_left">73792</td>
<td id="S4.T3.1.3.2.4" class="ltx_td ltx_align_left">Relu</td>
</tr>
<tr id="S4.T3.1.4.3" class="ltx_tr">
<td id="S4.T3.1.4.3.1" class="ltx_td ltx_align_left">conv2d_48 (Conv2D)</td>
<td id="S4.T3.1.4.3.2" class="ltx_td ltx_align_left">(None, 44, 44, 32)</td>
<td id="S4.T3.1.4.3.3" class="ltx_td ltx_align_left">18464</td>
<td id="S4.T3.1.4.3.4" class="ltx_td ltx_align_left">Relu</td>
</tr>
<tr id="S4.T3.1.5.4" class="ltx_tr">
<td id="S4.T3.1.5.4.1" class="ltx_td ltx_align_left">conv2d_49 (Conv2D)</td>
<td id="S4.T3.1.5.4.2" class="ltx_td ltx_align_left">(None, 42, 42, 16)</td>
<td id="S4.T3.1.5.4.3" class="ltx_td ltx_align_left">4624</td>
<td id="S4.T3.1.5.4.4" class="ltx_td ltx_align_left">Relu</td>
</tr>
<tr id="S4.T3.1.6.5" class="ltx_tr">
<td id="S4.T3.1.6.5.1" class="ltx_td ltx_align_left">conv2d_50 (Conv2D)</td>
<td id="S4.T3.1.6.5.2" class="ltx_td ltx_align_left">(None, 40, 40, 16)</td>
<td id="S4.T3.1.6.5.3" class="ltx_td ltx_align_left">2320</td>
<td id="S4.T3.1.6.5.4" class="ltx_td ltx_align_left">Relu</td>
</tr>
<tr id="S4.T3.1.7.6" class="ltx_tr">
<td id="S4.T3.1.7.6.1" class="ltx_td ltx_align_left">conv2d_51 (Conv2D)</td>
<td id="S4.T3.1.7.6.2" class="ltx_td ltx_align_left">(None, 38, 38, 32)</td>
<td id="S4.T3.1.7.6.3" class="ltx_td ltx_align_left">4640</td>
<td id="S4.T3.1.7.6.4" class="ltx_td ltx_align_left">Relu</td>
</tr>
<tr id="S4.T3.1.8.7" class="ltx_tr">
<td id="S4.T3.1.8.7.1" class="ltx_td ltx_align_left">conv2d_52 (Conv2D)</td>
<td id="S4.T3.1.8.7.2" class="ltx_td ltx_align_left">(None, 36, 36, 64)</td>
<td id="S4.T3.1.8.7.3" class="ltx_td ltx_align_left">18496</td>
<td id="S4.T3.1.8.7.4" class="ltx_td ltx_align_left">Relu</td>
</tr>
<tr id="S4.T3.1.9.8" class="ltx_tr">
<td id="S4.T3.1.9.8.1" class="ltx_td ltx_align_left">conv2d_53 (Conv2D)</td>
<td id="S4.T3.1.9.8.2" class="ltx_td ltx_align_left">(None, 34, 34, 128)</td>
<td id="S4.T3.1.9.8.3" class="ltx_td ltx_align_left">73856</td>
<td id="S4.T3.1.9.8.4" class="ltx_td ltx_align_left">Relu</td>
</tr>
<tr id="S4.T3.1.10.9" class="ltx_tr">
<td id="S4.T3.1.10.9.1" class="ltx_td ltx_align_left ltx_border_b">conv2d_54 (Conv2D)</td>
<td id="S4.T3.1.10.9.2" class="ltx_td ltx_align_left ltx_border_b">(None, 32, 32, 1)</td>
<td id="S4.T3.1.10.9.3" class="ltx_td ltx_align_left ltx_border_b">1153</td>
<td id="S4.T3.1.10.9.4" class="ltx_td ltx_align_left ltx_border_b">Relu</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">The architecture is kept purposely simple, as the intent of this paper is to evaluate the potential of the FL and PFL approaches for this use case, not to establish a new SotA model in precipitation nowcasting based on radar images.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">The model has been compiled with <span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_italic">Adam</span> <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> as optimizer and the <span id="S4.SS3.p3.1.2" class="ltx_text ltx_font_italic">mean squared error (MSE)</span> as loss function and the MSE and the <span id="S4.SS3.p3.1.3" class="ltx_text ltx_font_italic">mean absolute error (MAE)</span> as quality metrics for monitoring.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">Again, as previously explained, this model has been validated using the data from zone 4. Specifically, the average MSE obtained in the five folds is 0.0326.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.5" class="ltx_p">In addition, we have calculated other metrics such us the RMSE and the <span id="S4.SS3.p5.5.1" class="ltx_text ltx_font_italic">skill score</span> (like in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>), which can be obtained from the MSE, so the tendency observed will be analogous, but they can be used for comparison with other cases. The RMSE is defined as the squared root of the mean of the squared errors, and the skill score for the model <math id="S4.SS3.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S4.SS3.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><ci id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">\mathcal{M}</annotation></semantics></math> (<math id="S4.SS3.p5.2.m2.1" class="ltx_Math" alttext="SkillScore_{\mathcal{M}}" display="inline"><semantics id="S4.SS3.p5.2.m2.1a"><mrow id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml"><mi id="S4.SS3.p5.2.m2.1.1.2" xref="S4.SS3.p5.2.m2.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.2.m2.1.1.3" xref="S4.SS3.p5.2.m2.1.1.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1a" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.2.m2.1.1.4" xref="S4.SS3.p5.2.m2.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1b" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.2.m2.1.1.5" xref="S4.SS3.p5.2.m2.1.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1c" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.2.m2.1.1.6" xref="S4.SS3.p5.2.m2.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1d" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.2.m2.1.1.7" xref="S4.SS3.p5.2.m2.1.1.7.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1e" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.2.m2.1.1.8" xref="S4.SS3.p5.2.m2.1.1.8.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1f" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.2.m2.1.1.9" xref="S4.SS3.p5.2.m2.1.1.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1g" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.2.m2.1.1.10" xref="S4.SS3.p5.2.m2.1.1.10.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.2.m2.1.1.1h" xref="S4.SS3.p5.2.m2.1.1.1.cmml">​</mo><msub id="S4.SS3.p5.2.m2.1.1.11" xref="S4.SS3.p5.2.m2.1.1.11.cmml"><mi id="S4.SS3.p5.2.m2.1.1.11.2" xref="S4.SS3.p5.2.m2.1.1.11.2.cmml">e</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.2.m2.1.1.11.3" xref="S4.SS3.p5.2.m2.1.1.11.3.cmml">ℳ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><apply id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1"><times id="S4.SS3.p5.2.m2.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1.1"></times><ci id="S4.SS3.p5.2.m2.1.1.2.cmml" xref="S4.SS3.p5.2.m2.1.1.2">𝑆</ci><ci id="S4.SS3.p5.2.m2.1.1.3.cmml" xref="S4.SS3.p5.2.m2.1.1.3">𝑘</ci><ci id="S4.SS3.p5.2.m2.1.1.4.cmml" xref="S4.SS3.p5.2.m2.1.1.4">𝑖</ci><ci id="S4.SS3.p5.2.m2.1.1.5.cmml" xref="S4.SS3.p5.2.m2.1.1.5">𝑙</ci><ci id="S4.SS3.p5.2.m2.1.1.6.cmml" xref="S4.SS3.p5.2.m2.1.1.6">𝑙</ci><ci id="S4.SS3.p5.2.m2.1.1.7.cmml" xref="S4.SS3.p5.2.m2.1.1.7">𝑆</ci><ci id="S4.SS3.p5.2.m2.1.1.8.cmml" xref="S4.SS3.p5.2.m2.1.1.8">𝑐</ci><ci id="S4.SS3.p5.2.m2.1.1.9.cmml" xref="S4.SS3.p5.2.m2.1.1.9">𝑜</ci><ci id="S4.SS3.p5.2.m2.1.1.10.cmml" xref="S4.SS3.p5.2.m2.1.1.10">𝑟</ci><apply id="S4.SS3.p5.2.m2.1.1.11.cmml" xref="S4.SS3.p5.2.m2.1.1.11"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.1.1.11.1.cmml" xref="S4.SS3.p5.2.m2.1.1.11">subscript</csymbol><ci id="S4.SS3.p5.2.m2.1.1.11.2.cmml" xref="S4.SS3.p5.2.m2.1.1.11.2">𝑒</ci><ci id="S4.SS3.p5.2.m2.1.1.11.3.cmml" xref="S4.SS3.p5.2.m2.1.1.11.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">SkillScore_{\mathcal{M}}</annotation></semantics></math> can be defined as given in Equation <a href="#S4.E1" title="In 4.3 Convolutional neural architecture ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, being <math id="S4.SS3.p5.3.m3.1" class="ltx_Math" alttext="MSE_{\mathcal{M}}" display="inline"><semantics id="S4.SS3.p5.3.m3.1a"><mrow id="S4.SS3.p5.3.m3.1.1" xref="S4.SS3.p5.3.m3.1.1.cmml"><mi id="S4.SS3.p5.3.m3.1.1.2" xref="S4.SS3.p5.3.m3.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.3.m3.1.1.1" xref="S4.SS3.p5.3.m3.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.3.m3.1.1.3" xref="S4.SS3.p5.3.m3.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.3.m3.1.1.1a" xref="S4.SS3.p5.3.m3.1.1.1.cmml">​</mo><msub id="S4.SS3.p5.3.m3.1.1.4" xref="S4.SS3.p5.3.m3.1.1.4.cmml"><mi id="S4.SS3.p5.3.m3.1.1.4.2" xref="S4.SS3.p5.3.m3.1.1.4.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.3.m3.1.1.4.3" xref="S4.SS3.p5.3.m3.1.1.4.3.cmml">ℳ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m3.1b"><apply id="S4.SS3.p5.3.m3.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1"><times id="S4.SS3.p5.3.m3.1.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1.1"></times><ci id="S4.SS3.p5.3.m3.1.1.2.cmml" xref="S4.SS3.p5.3.m3.1.1.2">𝑀</ci><ci id="S4.SS3.p5.3.m3.1.1.3.cmml" xref="S4.SS3.p5.3.m3.1.1.3">𝑆</ci><apply id="S4.SS3.p5.3.m3.1.1.4.cmml" xref="S4.SS3.p5.3.m3.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p5.3.m3.1.1.4.1.cmml" xref="S4.SS3.p5.3.m3.1.1.4">subscript</csymbol><ci id="S4.SS3.p5.3.m3.1.1.4.2.cmml" xref="S4.SS3.p5.3.m3.1.1.4.2">𝐸</ci><ci id="S4.SS3.p5.3.m3.1.1.4.3.cmml" xref="S4.SS3.p5.3.m3.1.1.4.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m3.1c">MSE_{\mathcal{M}}</annotation></semantics></math> the MSE for the model <math id="S4.SS3.p5.4.m4.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S4.SS3.p5.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.4.m4.1.1" xref="S4.SS3.p5.4.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.4.m4.1b"><ci id="S4.SS3.p5.4.m4.1.1.cmml" xref="S4.SS3.p5.4.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.4.m4.1c">\mathcal{M}</annotation></semantics></math> and <math id="S4.SS3.p5.5.m5.1" class="ltx_Math" alttext="MSE_{\mathcal{B}}" display="inline"><semantics id="S4.SS3.p5.5.m5.1a"><mrow id="S4.SS3.p5.5.m5.1.1" xref="S4.SS3.p5.5.m5.1.1.cmml"><mi id="S4.SS3.p5.5.m5.1.1.2" xref="S4.SS3.p5.5.m5.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.5.m5.1.1.1" xref="S4.SS3.p5.5.m5.1.1.1.cmml">​</mo><mi id="S4.SS3.p5.5.m5.1.1.3" xref="S4.SS3.p5.5.m5.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.5.m5.1.1.1a" xref="S4.SS3.p5.5.m5.1.1.1.cmml">​</mo><msub id="S4.SS3.p5.5.m5.1.1.4" xref="S4.SS3.p5.5.m5.1.1.4.cmml"><mi id="S4.SS3.p5.5.m5.1.1.4.2" xref="S4.SS3.p5.5.m5.1.1.4.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.5.m5.1.1.4.3" xref="S4.SS3.p5.5.m5.1.1.4.3.cmml">ℬ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.5.m5.1b"><apply id="S4.SS3.p5.5.m5.1.1.cmml" xref="S4.SS3.p5.5.m5.1.1"><times id="S4.SS3.p5.5.m5.1.1.1.cmml" xref="S4.SS3.p5.5.m5.1.1.1"></times><ci id="S4.SS3.p5.5.m5.1.1.2.cmml" xref="S4.SS3.p5.5.m5.1.1.2">𝑀</ci><ci id="S4.SS3.p5.5.m5.1.1.3.cmml" xref="S4.SS3.p5.5.m5.1.1.3">𝑆</ci><apply id="S4.SS3.p5.5.m5.1.1.4.cmml" xref="S4.SS3.p5.5.m5.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p5.5.m5.1.1.4.1.cmml" xref="S4.SS3.p5.5.m5.1.1.4">subscript</csymbol><ci id="S4.SS3.p5.5.m5.1.1.4.2.cmml" xref="S4.SS3.p5.5.m5.1.1.4.2">𝐸</ci><ci id="S4.SS3.p5.5.m5.1.1.4.3.cmml" xref="S4.SS3.p5.5.m5.1.1.4.3">ℬ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.5.m5.1c">MSE_{\mathcal{B}}</annotation></semantics></math> the MSE for a baseline model. In our study we have considered COTREC as the baseline model for calculating the skill score.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para">
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E1.m1.1" class="ltx_Math" alttext="SkillScore_{\mathcal{M}}=1-\frac{MSE_{\mathcal{M}}}{MSE_{\mathcal{B}}}" display="block"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><mrow id="S4.E1.m1.1.1.2" xref="S4.E1.m1.1.1.2.cmml"><mi id="S4.E1.m1.1.1.2.2" xref="S4.E1.m1.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.2.3" xref="S4.E1.m1.1.1.2.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1a" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.2.4" xref="S4.E1.m1.1.1.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1b" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.2.5" xref="S4.E1.m1.1.1.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1c" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.2.6" xref="S4.E1.m1.1.1.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1d" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.2.7" xref="S4.E1.m1.1.1.2.7.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1e" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.2.8" xref="S4.E1.m1.1.1.2.8.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1f" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.2.9" xref="S4.E1.m1.1.1.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1g" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.2.10" xref="S4.E1.m1.1.1.2.10.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.2.1h" xref="S4.E1.m1.1.1.2.1.cmml">​</mo><msub id="S4.E1.m1.1.1.2.11" xref="S4.E1.m1.1.1.2.11.cmml"><mi id="S4.E1.m1.1.1.2.11.2" xref="S4.E1.m1.1.1.2.11.2.cmml">e</mi><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.2.11.3" xref="S4.E1.m1.1.1.2.11.3.cmml">ℳ</mi></msub></mrow><mo id="S4.E1.m1.1.1.1" xref="S4.E1.m1.1.1.1.cmml">=</mo><mrow id="S4.E1.m1.1.1.3" xref="S4.E1.m1.1.1.3.cmml"><mn id="S4.E1.m1.1.1.3.2" xref="S4.E1.m1.1.1.3.2.cmml">1</mn><mo id="S4.E1.m1.1.1.3.1" xref="S4.E1.m1.1.1.3.1.cmml">−</mo><mfrac id="S4.E1.m1.1.1.3.3" xref="S4.E1.m1.1.1.3.3.cmml"><mrow id="S4.E1.m1.1.1.3.3.2" xref="S4.E1.m1.1.1.3.3.2.cmml"><mi id="S4.E1.m1.1.1.3.3.2.2" xref="S4.E1.m1.1.1.3.3.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.3.3.2.1" xref="S4.E1.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S4.E1.m1.1.1.3.3.2.3" xref="S4.E1.m1.1.1.3.3.2.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.3.3.2.1a" xref="S4.E1.m1.1.1.3.3.2.1.cmml">​</mo><msub id="S4.E1.m1.1.1.3.3.2.4" xref="S4.E1.m1.1.1.3.3.2.4.cmml"><mi id="S4.E1.m1.1.1.3.3.2.4.2" xref="S4.E1.m1.1.1.3.3.2.4.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.3.3.2.4.3" xref="S4.E1.m1.1.1.3.3.2.4.3.cmml">ℳ</mi></msub></mrow><mrow id="S4.E1.m1.1.1.3.3.3" xref="S4.E1.m1.1.1.3.3.3.cmml"><mi id="S4.E1.m1.1.1.3.3.3.2" xref="S4.E1.m1.1.1.3.3.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.3.3.3.1" xref="S4.E1.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E1.m1.1.1.3.3.3.3" xref="S4.E1.m1.1.1.3.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.3.3.3.1a" xref="S4.E1.m1.1.1.3.3.3.1.cmml">​</mo><msub id="S4.E1.m1.1.1.3.3.3.4" xref="S4.E1.m1.1.1.3.3.3.4.cmml"><mi id="S4.E1.m1.1.1.3.3.3.4.2" xref="S4.E1.m1.1.1.3.3.3.4.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.1.1.3.3.3.4.3" xref="S4.E1.m1.1.1.3.3.3.4.3.cmml">ℬ</mi></msub></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1"><eq id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.1.1"></eq><apply id="S4.E1.m1.1.1.2.cmml" xref="S4.E1.m1.1.1.2"><times id="S4.E1.m1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.2.1"></times><ci id="S4.E1.m1.1.1.2.2.cmml" xref="S4.E1.m1.1.1.2.2">𝑆</ci><ci id="S4.E1.m1.1.1.2.3.cmml" xref="S4.E1.m1.1.1.2.3">𝑘</ci><ci id="S4.E1.m1.1.1.2.4.cmml" xref="S4.E1.m1.1.1.2.4">𝑖</ci><ci id="S4.E1.m1.1.1.2.5.cmml" xref="S4.E1.m1.1.1.2.5">𝑙</ci><ci id="S4.E1.m1.1.1.2.6.cmml" xref="S4.E1.m1.1.1.2.6">𝑙</ci><ci id="S4.E1.m1.1.1.2.7.cmml" xref="S4.E1.m1.1.1.2.7">𝑆</ci><ci id="S4.E1.m1.1.1.2.8.cmml" xref="S4.E1.m1.1.1.2.8">𝑐</ci><ci id="S4.E1.m1.1.1.2.9.cmml" xref="S4.E1.m1.1.1.2.9">𝑜</ci><ci id="S4.E1.m1.1.1.2.10.cmml" xref="S4.E1.m1.1.1.2.10">𝑟</ci><apply id="S4.E1.m1.1.1.2.11.cmml" xref="S4.E1.m1.1.1.2.11"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.2.11.1.cmml" xref="S4.E1.m1.1.1.2.11">subscript</csymbol><ci id="S4.E1.m1.1.1.2.11.2.cmml" xref="S4.E1.m1.1.1.2.11.2">𝑒</ci><ci id="S4.E1.m1.1.1.2.11.3.cmml" xref="S4.E1.m1.1.1.2.11.3">ℳ</ci></apply></apply><apply id="S4.E1.m1.1.1.3.cmml" xref="S4.E1.m1.1.1.3"><minus id="S4.E1.m1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.3.1"></minus><cn type="integer" id="S4.E1.m1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.3.2">1</cn><apply id="S4.E1.m1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.3.3"><divide id="S4.E1.m1.1.1.3.3.1.cmml" xref="S4.E1.m1.1.1.3.3"></divide><apply id="S4.E1.m1.1.1.3.3.2.cmml" xref="S4.E1.m1.1.1.3.3.2"><times id="S4.E1.m1.1.1.3.3.2.1.cmml" xref="S4.E1.m1.1.1.3.3.2.1"></times><ci id="S4.E1.m1.1.1.3.3.2.2.cmml" xref="S4.E1.m1.1.1.3.3.2.2">𝑀</ci><ci id="S4.E1.m1.1.1.3.3.2.3.cmml" xref="S4.E1.m1.1.1.3.3.2.3">𝑆</ci><apply id="S4.E1.m1.1.1.3.3.2.4.cmml" xref="S4.E1.m1.1.1.3.3.2.4"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.3.3.2.4.1.cmml" xref="S4.E1.m1.1.1.3.3.2.4">subscript</csymbol><ci id="S4.E1.m1.1.1.3.3.2.4.2.cmml" xref="S4.E1.m1.1.1.3.3.2.4.2">𝐸</ci><ci id="S4.E1.m1.1.1.3.3.2.4.3.cmml" xref="S4.E1.m1.1.1.3.3.2.4.3">ℳ</ci></apply></apply><apply id="S4.E1.m1.1.1.3.3.3.cmml" xref="S4.E1.m1.1.1.3.3.3"><times id="S4.E1.m1.1.1.3.3.3.1.cmml" xref="S4.E1.m1.1.1.3.3.3.1"></times><ci id="S4.E1.m1.1.1.3.3.3.2.cmml" xref="S4.E1.m1.1.1.3.3.3.2">𝑀</ci><ci id="S4.E1.m1.1.1.3.3.3.3.cmml" xref="S4.E1.m1.1.1.3.3.3.3">𝑆</ci><apply id="S4.E1.m1.1.1.3.3.3.4.cmml" xref="S4.E1.m1.1.1.3.3.3.4"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.3.3.3.4.1.cmml" xref="S4.E1.m1.1.1.3.3.3.4">subscript</csymbol><ci id="S4.E1.m1.1.1.3.3.3.4.2.cmml" xref="S4.E1.m1.1.1.3.3.3.4.2">𝐸</ci><ci id="S4.E1.m1.1.1.3.3.3.4.3.cmml" xref="S4.E1.m1.1.1.3.3.3.4.3">ℬ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">SkillScore_{\mathcal{M}}=1-\frac{MSE_{\mathcal{M}}}{MSE_{\mathcal{B}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Computing resources</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">The experiments have been carried out using the AI4EOSC platform <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Specifically, an environment with 16 GB of RAM, 10 GB of disk, 8 CPU cores, and one GPU NVIDIA Tesla T4 has been deployed. The programming language used was Python 3 and the TensorFlow library <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> was used to develop the deep learning models.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results and analysis</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, the results obtained in each of the zones when evaluating each of the following approaches are presented:</p>
</div>
<div id="S5.p2" class="ltx_para">
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">The classic COTREC model as baseline,</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">An individual learning model trained for 100 epochs in the same zone (IL),</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">An FL model trained 10 epochs for 10 rounds (FL),</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p">A PFL model trained 10 epochs for 9 rounds, ending with a local training of 10 epochs on the data of the testing zone (<span id="S5.I1.i4.p1.1.1" class="ltx_text ltx_font_italic">adapFL</span>).</p>
</div>
</li>
</ul>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">Table <a href="#S5.T4" title="Table 4 ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> summarizes the results obtained in terms of the MSE and the MAE in the test set of each of the four zones and with the four approaches.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p">In view of the results shown in Table <a href="#S5.T4" title="Table 4 ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the best results are obtained with the <span id="S5.p4.1.1" class="ltx_text ltx_font_italic">adapFL</span> architecture. Moreover, all the three DL approaches achieve better results than the COTREC model. It should be noted that with the conventional FL architecture, the results of the COTREC model were improved substantially, but not those of the IL, since the latter has a better capacity to adapt to the data captured in its corresponding area. Thus, with the adaptive step of the <span id="S5.p4.1.2" class="ltx_text ltx_font_italic">adapFL</span> architecture, we managed to improve the results of the FL architecture, but also those of the IL approach. Note that the adaptive step in <span id="S5.p4.1.3" class="ltx_text ltx_font_italic">adapFL</span> can be seen as a kind of transfer learning from the FL model. In Figures <a href="#A3.F12" title="Figure 12 ‣ Appendix C Example of predictions obtained for each area ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> and <a href="#A3.F13" title="Figure 13 ‣ Appendix C Example of predictions obtained for each area ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> of Appendix <a href="#A3" title="Appendix C Example of predictions obtained for each area ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>, it can be observed for each of the four zones, six examples of observed images together with the corresponding prediction obtained with the best analyzed model according to the results presented in Table <a href="#S5.T4" title="Table 4 ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, which corresponds to the <span id="S5.p4.1.4" class="ltx_text ltx_font_italic">adapFL</span> approach.
Within those figures we can observe that the predictions obtained are very similar to the actual observed images in the six cases shown for each of the four zones.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.1" class="ltx_p">Note that we have calculated these metrics, both MSE and MAE, taking the mean error in each image, and then the mean of all of them as stated in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>MSE and MAE (<math id="S5.T4.2.m1.1" class="ltx_Math" alttext="kg/m^{2}" display="inline"><semantics id="S5.T4.2.m1.1b"><mrow id="S5.T4.2.m1.1.1" xref="S5.T4.2.m1.1.1.cmml"><mrow id="S5.T4.2.m1.1.1.2" xref="S5.T4.2.m1.1.1.2.cmml"><mi id="S5.T4.2.m1.1.1.2.2" xref="S5.T4.2.m1.1.1.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S5.T4.2.m1.1.1.2.1" xref="S5.T4.2.m1.1.1.2.1.cmml">​</mo><mi id="S5.T4.2.m1.1.1.2.3" xref="S5.T4.2.m1.1.1.2.3.cmml">g</mi></mrow><mo id="S5.T4.2.m1.1.1.1" xref="S5.T4.2.m1.1.1.1.cmml">/</mo><msup id="S5.T4.2.m1.1.1.3" xref="S5.T4.2.m1.1.1.3.cmml"><mi id="S5.T4.2.m1.1.1.3.2" xref="S5.T4.2.m1.1.1.3.2.cmml">m</mi><mn id="S5.T4.2.m1.1.1.3.3" xref="S5.T4.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.2.m1.1c"><apply id="S5.T4.2.m1.1.1.cmml" xref="S5.T4.2.m1.1.1"><divide id="S5.T4.2.m1.1.1.1.cmml" xref="S5.T4.2.m1.1.1.1"></divide><apply id="S5.T4.2.m1.1.1.2.cmml" xref="S5.T4.2.m1.1.1.2"><times id="S5.T4.2.m1.1.1.2.1.cmml" xref="S5.T4.2.m1.1.1.2.1"></times><ci id="S5.T4.2.m1.1.1.2.2.cmml" xref="S5.T4.2.m1.1.1.2.2">𝑘</ci><ci id="S5.T4.2.m1.1.1.2.3.cmml" xref="S5.T4.2.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T4.2.m1.1.1.3.cmml" xref="S5.T4.2.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T4.2.m1.1.1.3.1.cmml" xref="S5.T4.2.m1.1.1.3">superscript</csymbol><ci id="S5.T4.2.m1.1.1.3.2.cmml" xref="S5.T4.2.m1.1.1.3.2">𝑚</ci><cn type="integer" id="S5.T4.2.m1.1.1.3.3.cmml" xref="S5.T4.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.m1.1d">kg/m^{2}</annotation></semantics></math>) obtained in the test set with the different approaches in each zone.</figcaption>
<table id="S5.T4.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.3.1.1" class="ltx_tr">
<th id="S5.T4.3.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S5.T4.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S5.T4.3.1.1.2.1" class="ltx_text ltx_font_italic">MSE</span></th>
<th id="S5.T4.3.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S5.T4.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S5.T4.3.1.1.4.1" class="ltx_text ltx_font_italic">MAE</span></th>
</tr>
<tr id="S5.T4.3.2.2" class="ltx_tr">
<th id="S5.T4.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row"><span id="S5.T4.3.2.2.1.1" class="ltx_text ltx_font_italic">Zone</span></th>
<th id="S5.T4.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T4.3.2.2.2.1" class="ltx_text ltx_font_italic">COTREC</span></th>
<th id="S5.T4.3.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T4.3.2.2.3.1" class="ltx_text ltx_font_italic">IL</span></th>
<th id="S5.T4.3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T4.3.2.2.4.1" class="ltx_text ltx_font_italic">FL</span></th>
<th id="S5.T4.3.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T4.3.2.2.5.1" class="ltx_text ltx_font_italic">adapFL</span></th>
<th id="S5.T4.3.2.2.6" class="ltx_td ltx_th ltx_th_column"></th>
<th id="S5.T4.3.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T4.3.2.2.7.1" class="ltx_text ltx_font_italic">COTREC</span></th>
<th id="S5.T4.3.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T4.3.2.2.8.1" class="ltx_text ltx_font_italic">IL</span></th>
<th id="S5.T4.3.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T4.3.2.2.9.1" class="ltx_text ltx_font_italic">FL</span></th>
<th id="S5.T4.3.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T4.3.2.2.10.1" class="ltx_text ltx_font_italic">adapFL</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.3.3.1" class="ltx_tr">
<th id="S5.T4.3.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S5.T4.3.3.1.1.1" class="ltx_text ltx_font_italic">1</span></th>
<td id="S5.T4.3.3.1.2" class="ltx_td ltx_align_center ltx_border_t">0.2306</td>
<td id="S5.T4.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t">0.1399</td>
<td id="S5.T4.3.3.1.4" class="ltx_td ltx_align_center ltx_border_t">0.2000</td>
<td id="S5.T4.3.3.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.3.1.5.1" class="ltx_text ltx_font_bold">0.1352</span></td>
<td id="S5.T4.3.3.1.6" class="ltx_td ltx_border_t"></td>
<td id="S5.T4.3.3.1.7" class="ltx_td ltx_align_center ltx_border_t">0.0708</td>
<td id="S5.T4.3.3.1.8" class="ltx_td ltx_align_center ltx_border_t">0.0618</td>
<td id="S5.T4.3.3.1.9" class="ltx_td ltx_align_center ltx_border_t">0.0649</td>
<td id="S5.T4.3.3.1.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.3.3.1.10.1" class="ltx_text ltx_font_bold">0.0606</span></td>
</tr>
<tr id="S5.T4.3.4.2" class="ltx_tr">
<th id="S5.T4.3.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S5.T4.3.4.2.1.1" class="ltx_text ltx_font_italic">2</span></th>
<td id="S5.T4.3.4.2.2" class="ltx_td ltx_align_center">0.1756</td>
<td id="S5.T4.3.4.2.3" class="ltx_td ltx_align_center">0.1057</td>
<td id="S5.T4.3.4.2.4" class="ltx_td ltx_align_center">0.1612</td>
<td id="S5.T4.3.4.2.5" class="ltx_td ltx_align_center"><span id="S5.T4.3.4.2.5.1" class="ltx_text ltx_font_bold">0.1005</span></td>
<td id="S5.T4.3.4.2.6" class="ltx_td"></td>
<td id="S5.T4.3.4.2.7" class="ltx_td ltx_align_center">0.0650</td>
<td id="S5.T4.3.4.2.8" class="ltx_td ltx_align_center">0.0530</td>
<td id="S5.T4.3.4.2.9" class="ltx_td ltx_align_center">0.0590</td>
<td id="S5.T4.3.4.2.10" class="ltx_td ltx_align_center"><span id="S5.T4.3.4.2.10.1" class="ltx_text ltx_font_bold">0.0517</span></td>
</tr>
<tr id="S5.T4.3.5.3" class="ltx_tr">
<th id="S5.T4.3.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S5.T4.3.5.3.1.1" class="ltx_text ltx_font_italic">3</span></th>
<td id="S5.T4.3.5.3.2" class="ltx_td ltx_align_center">0.2235</td>
<td id="S5.T4.3.5.3.3" class="ltx_td ltx_align_center">0.1220</td>
<td id="S5.T4.3.5.3.4" class="ltx_td ltx_align_center">0.1286</td>
<td id="S5.T4.3.5.3.5" class="ltx_td ltx_align_center"><span id="S5.T4.3.5.3.5.1" class="ltx_text ltx_font_bold">0.1082</span></td>
<td id="S5.T4.3.5.3.6" class="ltx_td"></td>
<td id="S5.T4.3.5.3.7" class="ltx_td ltx_align_center">0.0729</td>
<td id="S5.T4.3.5.3.8" class="ltx_td ltx_align_center">0.0607</td>
<td id="S5.T4.3.5.3.9" class="ltx_td ltx_align_center">0.0576</td>
<td id="S5.T4.3.5.3.10" class="ltx_td ltx_align_center"><span id="S5.T4.3.5.3.10.1" class="ltx_text ltx_font_bold">0.0565</span></td>
</tr>
<tr id="S5.T4.3.6.4" class="ltx_tr">
<th id="S5.T4.3.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S5.T4.3.6.4.1.1" class="ltx_text ltx_font_italic">4</span></th>
<td id="S5.T4.3.6.4.2" class="ltx_td ltx_align_center ltx_border_bb">0.1095</td>
<td id="S5.T4.3.6.4.3" class="ltx_td ltx_align_center ltx_border_bb">0.0852</td>
<td id="S5.T4.3.6.4.4" class="ltx_td ltx_align_center ltx_border_bb">0.0958</td>
<td id="S5.T4.3.6.4.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.3.6.4.5.1" class="ltx_text ltx_font_bold">0.0815</span></td>
<td id="S5.T4.3.6.4.6" class="ltx_td ltx_border_bb"></td>
<td id="S5.T4.3.6.4.7" class="ltx_td ltx_align_center ltx_border_bb">0.0514</td>
<td id="S5.T4.3.6.4.8" class="ltx_td ltx_align_center ltx_border_bb">0.0482</td>
<td id="S5.T4.3.6.4.9" class="ltx_td ltx_align_center ltx_border_bb">0.0484</td>
<td id="S5.T4.3.6.4.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.3.6.4.10.1" class="ltx_text ltx_font_bold">0.0464</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.8" class="ltx_p">The idea of taking the current configuration of the <span id="S5.p6.8.3" class="ltx_text ltx_font_italic">adapFL</span> approach is motivated by achieving an adaptation by customizing the conditions of each specific zone, while trying to preserve the generalization capacity of the FL architecture. However, we have sought to compare the different configurations, given by <span id="S5.p6.2.2" class="ltx_text ltx_font_italic">(<math id="S5.p6.1.1.m1.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="S5.p6.1.1.m1.1a"><msub id="S5.p6.1.1.m1.1.1" xref="S5.p6.1.1.m1.1.1.cmml"><mi id="S5.p6.1.1.m1.1.1.2" xref="S5.p6.1.1.m1.1.1.2.cmml">N</mi><mi id="S5.p6.1.1.m1.1.1.3" xref="S5.p6.1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p6.1.1.m1.1b"><apply id="S5.p6.1.1.m1.1.1.cmml" xref="S5.p6.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p6.1.1.m1.1.1.1.cmml" xref="S5.p6.1.1.m1.1.1">subscript</csymbol><ci id="S5.p6.1.1.m1.1.1.2.cmml" xref="S5.p6.1.1.m1.1.1.2">𝑁</ci><ci id="S5.p6.1.1.m1.1.1.3.cmml" xref="S5.p6.1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.1.1.m1.1c">N_{r}</annotation></semantics></math>, <math id="S5.p6.2.2.m2.1" class="ltx_Math" alttext="N_{e}^{(L)}" display="inline"><semantics id="S5.p6.2.2.m2.1a"><msubsup id="S5.p6.2.2.m2.1.2" xref="S5.p6.2.2.m2.1.2.cmml"><mi id="S5.p6.2.2.m2.1.2.2.2" xref="S5.p6.2.2.m2.1.2.2.2.cmml">N</mi><mi id="S5.p6.2.2.m2.1.2.2.3" xref="S5.p6.2.2.m2.1.2.2.3.cmml">e</mi><mrow id="S5.p6.2.2.m2.1.1.1.3" xref="S5.p6.2.2.m2.1.2.cmml"><mo stretchy="false" id="S5.p6.2.2.m2.1.1.1.3.1" xref="S5.p6.2.2.m2.1.2.cmml">(</mo><mi id="S5.p6.2.2.m2.1.1.1.1" xref="S5.p6.2.2.m2.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S5.p6.2.2.m2.1.1.1.3.2" xref="S5.p6.2.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.p6.2.2.m2.1b"><apply id="S5.p6.2.2.m2.1.2.cmml" xref="S5.p6.2.2.m2.1.2"><csymbol cd="ambiguous" id="S5.p6.2.2.m2.1.2.1.cmml" xref="S5.p6.2.2.m2.1.2">superscript</csymbol><apply id="S5.p6.2.2.m2.1.2.2.cmml" xref="S5.p6.2.2.m2.1.2"><csymbol cd="ambiguous" id="S5.p6.2.2.m2.1.2.2.1.cmml" xref="S5.p6.2.2.m2.1.2">subscript</csymbol><ci id="S5.p6.2.2.m2.1.2.2.2.cmml" xref="S5.p6.2.2.m2.1.2.2.2">𝑁</ci><ci id="S5.p6.2.2.m2.1.2.2.3.cmml" xref="S5.p6.2.2.m2.1.2.2.3">𝑒</ci></apply><ci id="S5.p6.2.2.m2.1.1.1.1.cmml" xref="S5.p6.2.2.m2.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.2.2.m2.1c">N_{e}^{(L)}</annotation></semantics></math>)</span>, <math id="S5.p6.3.m1.3" class="ltx_Math" alttext="\forall N_{r}\in\{1,\ldots,10\}" display="inline"><semantics id="S5.p6.3.m1.3a"><mrow id="S5.p6.3.m1.3.4" xref="S5.p6.3.m1.3.4.cmml"><mrow id="S5.p6.3.m1.3.4.2" xref="S5.p6.3.m1.3.4.2.cmml"><mo rspace="0.167em" id="S5.p6.3.m1.3.4.2.1" xref="S5.p6.3.m1.3.4.2.1.cmml">∀</mo><msub id="S5.p6.3.m1.3.4.2.2" xref="S5.p6.3.m1.3.4.2.2.cmml"><mi id="S5.p6.3.m1.3.4.2.2.2" xref="S5.p6.3.m1.3.4.2.2.2.cmml">N</mi><mi id="S5.p6.3.m1.3.4.2.2.3" xref="S5.p6.3.m1.3.4.2.2.3.cmml">r</mi></msub></mrow><mo id="S5.p6.3.m1.3.4.1" xref="S5.p6.3.m1.3.4.1.cmml">∈</mo><mrow id="S5.p6.3.m1.3.4.3.2" xref="S5.p6.3.m1.3.4.3.1.cmml"><mo stretchy="false" id="S5.p6.3.m1.3.4.3.2.1" xref="S5.p6.3.m1.3.4.3.1.cmml">{</mo><mn id="S5.p6.3.m1.1.1" xref="S5.p6.3.m1.1.1.cmml">1</mn><mo id="S5.p6.3.m1.3.4.3.2.2" xref="S5.p6.3.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S5.p6.3.m1.2.2" xref="S5.p6.3.m1.2.2.cmml">…</mi><mo id="S5.p6.3.m1.3.4.3.2.3" xref="S5.p6.3.m1.3.4.3.1.cmml">,</mo><mn id="S5.p6.3.m1.3.3" xref="S5.p6.3.m1.3.3.cmml">10</mn><mo stretchy="false" id="S5.p6.3.m1.3.4.3.2.4" xref="S5.p6.3.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.3.m1.3b"><apply id="S5.p6.3.m1.3.4.cmml" xref="S5.p6.3.m1.3.4"><in id="S5.p6.3.m1.3.4.1.cmml" xref="S5.p6.3.m1.3.4.1"></in><apply id="S5.p6.3.m1.3.4.2.cmml" xref="S5.p6.3.m1.3.4.2"><csymbol cd="latexml" id="S5.p6.3.m1.3.4.2.1.cmml" xref="S5.p6.3.m1.3.4.2.1">for-all</csymbol><apply id="S5.p6.3.m1.3.4.2.2.cmml" xref="S5.p6.3.m1.3.4.2.2"><csymbol cd="ambiguous" id="S5.p6.3.m1.3.4.2.2.1.cmml" xref="S5.p6.3.m1.3.4.2.2">subscript</csymbol><ci id="S5.p6.3.m1.3.4.2.2.2.cmml" xref="S5.p6.3.m1.3.4.2.2.2">𝑁</ci><ci id="S5.p6.3.m1.3.4.2.2.3.cmml" xref="S5.p6.3.m1.3.4.2.2.3">𝑟</ci></apply></apply><set id="S5.p6.3.m1.3.4.3.1.cmml" xref="S5.p6.3.m1.3.4.3.2"><cn type="integer" id="S5.p6.3.m1.1.1.cmml" xref="S5.p6.3.m1.1.1">1</cn><ci id="S5.p6.3.m1.2.2.cmml" xref="S5.p6.3.m1.2.2">…</ci><cn type="integer" id="S5.p6.3.m1.3.3.cmml" xref="S5.p6.3.m1.3.3">10</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.3.m1.3c">\forall N_{r}\in\{1,\ldots,10\}</annotation></semantics></math>, and <math id="S5.p6.4.m2.2" class="ltx_Math" alttext="N_{e}^{(L)}=100-(10\cdot N_{r})" display="inline"><semantics id="S5.p6.4.m2.2a"><mrow id="S5.p6.4.m2.2.2" xref="S5.p6.4.m2.2.2.cmml"><msubsup id="S5.p6.4.m2.2.2.3" xref="S5.p6.4.m2.2.2.3.cmml"><mi id="S5.p6.4.m2.2.2.3.2.2" xref="S5.p6.4.m2.2.2.3.2.2.cmml">N</mi><mi id="S5.p6.4.m2.2.2.3.2.3" xref="S5.p6.4.m2.2.2.3.2.3.cmml">e</mi><mrow id="S5.p6.4.m2.1.1.1.3" xref="S5.p6.4.m2.2.2.3.cmml"><mo stretchy="false" id="S5.p6.4.m2.1.1.1.3.1" xref="S5.p6.4.m2.2.2.3.cmml">(</mo><mi id="S5.p6.4.m2.1.1.1.1" xref="S5.p6.4.m2.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S5.p6.4.m2.1.1.1.3.2" xref="S5.p6.4.m2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S5.p6.4.m2.2.2.2" xref="S5.p6.4.m2.2.2.2.cmml">=</mo><mrow id="S5.p6.4.m2.2.2.1" xref="S5.p6.4.m2.2.2.1.cmml"><mn id="S5.p6.4.m2.2.2.1.3" xref="S5.p6.4.m2.2.2.1.3.cmml">100</mn><mo id="S5.p6.4.m2.2.2.1.2" xref="S5.p6.4.m2.2.2.1.2.cmml">−</mo><mrow id="S5.p6.4.m2.2.2.1.1.1" xref="S5.p6.4.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S5.p6.4.m2.2.2.1.1.1.2" xref="S5.p6.4.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S5.p6.4.m2.2.2.1.1.1.1" xref="S5.p6.4.m2.2.2.1.1.1.1.cmml"><mn id="S5.p6.4.m2.2.2.1.1.1.1.2" xref="S5.p6.4.m2.2.2.1.1.1.1.2.cmml">10</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p6.4.m2.2.2.1.1.1.1.1" xref="S5.p6.4.m2.2.2.1.1.1.1.1.cmml">⋅</mo><msub id="S5.p6.4.m2.2.2.1.1.1.1.3" xref="S5.p6.4.m2.2.2.1.1.1.1.3.cmml"><mi id="S5.p6.4.m2.2.2.1.1.1.1.3.2" xref="S5.p6.4.m2.2.2.1.1.1.1.3.2.cmml">N</mi><mi id="S5.p6.4.m2.2.2.1.1.1.1.3.3" xref="S5.p6.4.m2.2.2.1.1.1.1.3.3.cmml">r</mi></msub></mrow><mo stretchy="false" id="S5.p6.4.m2.2.2.1.1.1.3" xref="S5.p6.4.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.4.m2.2b"><apply id="S5.p6.4.m2.2.2.cmml" xref="S5.p6.4.m2.2.2"><eq id="S5.p6.4.m2.2.2.2.cmml" xref="S5.p6.4.m2.2.2.2"></eq><apply id="S5.p6.4.m2.2.2.3.cmml" xref="S5.p6.4.m2.2.2.3"><csymbol cd="ambiguous" id="S5.p6.4.m2.2.2.3.1.cmml" xref="S5.p6.4.m2.2.2.3">superscript</csymbol><apply id="S5.p6.4.m2.2.2.3.2.cmml" xref="S5.p6.4.m2.2.2.3"><csymbol cd="ambiguous" id="S5.p6.4.m2.2.2.3.2.1.cmml" xref="S5.p6.4.m2.2.2.3">subscript</csymbol><ci id="S5.p6.4.m2.2.2.3.2.2.cmml" xref="S5.p6.4.m2.2.2.3.2.2">𝑁</ci><ci id="S5.p6.4.m2.2.2.3.2.3.cmml" xref="S5.p6.4.m2.2.2.3.2.3">𝑒</ci></apply><ci id="S5.p6.4.m2.1.1.1.1.cmml" xref="S5.p6.4.m2.1.1.1.1">𝐿</ci></apply><apply id="S5.p6.4.m2.2.2.1.cmml" xref="S5.p6.4.m2.2.2.1"><minus id="S5.p6.4.m2.2.2.1.2.cmml" xref="S5.p6.4.m2.2.2.1.2"></minus><cn type="integer" id="S5.p6.4.m2.2.2.1.3.cmml" xref="S5.p6.4.m2.2.2.1.3">100</cn><apply id="S5.p6.4.m2.2.2.1.1.1.1.cmml" xref="S5.p6.4.m2.2.2.1.1.1"><ci id="S5.p6.4.m2.2.2.1.1.1.1.1.cmml" xref="S5.p6.4.m2.2.2.1.1.1.1.1">⋅</ci><cn type="integer" id="S5.p6.4.m2.2.2.1.1.1.1.2.cmml" xref="S5.p6.4.m2.2.2.1.1.1.1.2">10</cn><apply id="S5.p6.4.m2.2.2.1.1.1.1.3.cmml" xref="S5.p6.4.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.p6.4.m2.2.2.1.1.1.1.3.1.cmml" xref="S5.p6.4.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S5.p6.4.m2.2.2.1.1.1.1.3.2.cmml" xref="S5.p6.4.m2.2.2.1.1.1.1.3.2">𝑁</ci><ci id="S5.p6.4.m2.2.2.1.1.1.1.3.3.cmml" xref="S5.p6.4.m2.2.2.1.1.1.1.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.4.m2.2c">N_{e}^{(L)}=100-(10\cdot N_{r})</annotation></semantics></math>, with <math id="S5.p6.5.m3.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="S5.p6.5.m3.1a"><msub id="S5.p6.5.m3.1.1" xref="S5.p6.5.m3.1.1.cmml"><mi id="S5.p6.5.m3.1.1.2" xref="S5.p6.5.m3.1.1.2.cmml">N</mi><mi id="S5.p6.5.m3.1.1.3" xref="S5.p6.5.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p6.5.m3.1b"><apply id="S5.p6.5.m3.1.1.cmml" xref="S5.p6.5.m3.1.1"><csymbol cd="ambiguous" id="S5.p6.5.m3.1.1.1.cmml" xref="S5.p6.5.m3.1.1">subscript</csymbol><ci id="S5.p6.5.m3.1.1.2.cmml" xref="S5.p6.5.m3.1.1.2">𝑁</ci><ci id="S5.p6.5.m3.1.1.3.cmml" xref="S5.p6.5.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.5.m3.1c">N_{r}</annotation></semantics></math> the number of rounds of the FL architecture and <math id="S5.p6.6.m4.1" class="ltx_Math" alttext="N_{e}^{(L)}" display="inline"><semantics id="S5.p6.6.m4.1a"><msubsup id="S5.p6.6.m4.1.2" xref="S5.p6.6.m4.1.2.cmml"><mi id="S5.p6.6.m4.1.2.2.2" xref="S5.p6.6.m4.1.2.2.2.cmml">N</mi><mi id="S5.p6.6.m4.1.2.2.3" xref="S5.p6.6.m4.1.2.2.3.cmml">e</mi><mrow id="S5.p6.6.m4.1.1.1.3" xref="S5.p6.6.m4.1.2.cmml"><mo stretchy="false" id="S5.p6.6.m4.1.1.1.3.1" xref="S5.p6.6.m4.1.2.cmml">(</mo><mi id="S5.p6.6.m4.1.1.1.1" xref="S5.p6.6.m4.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S5.p6.6.m4.1.1.1.3.2" xref="S5.p6.6.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.p6.6.m4.1b"><apply id="S5.p6.6.m4.1.2.cmml" xref="S5.p6.6.m4.1.2"><csymbol cd="ambiguous" id="S5.p6.6.m4.1.2.1.cmml" xref="S5.p6.6.m4.1.2">superscript</csymbol><apply id="S5.p6.6.m4.1.2.2.cmml" xref="S5.p6.6.m4.1.2"><csymbol cd="ambiguous" id="S5.p6.6.m4.1.2.2.1.cmml" xref="S5.p6.6.m4.1.2">subscript</csymbol><ci id="S5.p6.6.m4.1.2.2.2.cmml" xref="S5.p6.6.m4.1.2.2.2">𝑁</ci><ci id="S5.p6.6.m4.1.2.2.3.cmml" xref="S5.p6.6.m4.1.2.2.3">𝑒</ci></apply><ci id="S5.p6.6.m4.1.1.1.1.cmml" xref="S5.p6.6.m4.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.6.m4.1c">N_{e}^{(L)}</annotation></semantics></math> the number of epochs that the model has been trained specifically in each zone after obtaining the federated global model (note that if <math id="S5.p6.7.m5.1" class="ltx_Math" alttext="N_{r}=10" display="inline"><semantics id="S5.p6.7.m5.1a"><mrow id="S5.p6.7.m5.1.1" xref="S5.p6.7.m5.1.1.cmml"><msub id="S5.p6.7.m5.1.1.2" xref="S5.p6.7.m5.1.1.2.cmml"><mi id="S5.p6.7.m5.1.1.2.2" xref="S5.p6.7.m5.1.1.2.2.cmml">N</mi><mi id="S5.p6.7.m5.1.1.2.3" xref="S5.p6.7.m5.1.1.2.3.cmml">r</mi></msub><mo id="S5.p6.7.m5.1.1.1" xref="S5.p6.7.m5.1.1.1.cmml">=</mo><mn id="S5.p6.7.m5.1.1.3" xref="S5.p6.7.m5.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.7.m5.1b"><apply id="S5.p6.7.m5.1.1.cmml" xref="S5.p6.7.m5.1.1"><eq id="S5.p6.7.m5.1.1.1.cmml" xref="S5.p6.7.m5.1.1.1"></eq><apply id="S5.p6.7.m5.1.1.2.cmml" xref="S5.p6.7.m5.1.1.2"><csymbol cd="ambiguous" id="S5.p6.7.m5.1.1.2.1.cmml" xref="S5.p6.7.m5.1.1.2">subscript</csymbol><ci id="S5.p6.7.m5.1.1.2.2.cmml" xref="S5.p6.7.m5.1.1.2.2">𝑁</ci><ci id="S5.p6.7.m5.1.1.2.3.cmml" xref="S5.p6.7.m5.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S5.p6.7.m5.1.1.3.cmml" xref="S5.p6.7.m5.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.7.m5.1c">N_{r}=10</annotation></semantics></math>, we are in the case of the classic FL approach). The results as a function of the MSE and the MAE for each test set are displayed in Figures <a href="#A2.F10" title="Figure 10 ‣ Appendix B AdapFL architecture: MSE and MAE ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> and <a href="#A2.F11" title="Figure 11 ‣ Appendix B AdapFL architecture: MSE and MAE ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> from Appendix <a href="#A2" title="Appendix B AdapFL architecture: MSE and MAE ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>. It can be observed that that a lower value of <math id="S5.p6.8.m6.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="S5.p6.8.m6.1a"><msub id="S5.p6.8.m6.1.1" xref="S5.p6.8.m6.1.1.cmml"><mi id="S5.p6.8.m6.1.1.2" xref="S5.p6.8.m6.1.1.2.cmml">N</mi><mi id="S5.p6.8.m6.1.1.3" xref="S5.p6.8.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p6.8.m6.1b"><apply id="S5.p6.8.m6.1.1.cmml" xref="S5.p6.8.m6.1.1"><csymbol cd="ambiguous" id="S5.p6.8.m6.1.1.1.cmml" xref="S5.p6.8.m6.1.1">subscript</csymbol><ci id="S5.p6.8.m6.1.1.2.cmml" xref="S5.p6.8.m6.1.1.2">𝑁</ci><ci id="S5.p6.8.m6.1.1.3.cmml" xref="S5.p6.8.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.8.m6.1c">N_{r}</annotation></semantics></math> is related to a reduction of the MAE and the MSE in train, which is explained as a higher adjustment to the zone under analysis. However, this is also linked to a reduction of the generalization capability that can be extracted from the federated architecture. Therefore, the selected configuration is (9, 10), i.e. 9 rounds of the FL architecture and 10 final epochs of personalized training in each zone.</p>
</div>
<div id="S5.p7" class="ltx_para">
<p id="S5.p7.1" class="ltx_p">Finally, the RMSE and skill score for the four areas can be calculated from the MSE pressented in Table <a href="#S5.T4" title="Table 4 ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, and are shown in Table <a href="#S5.T5" title="Table 5 ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. In view of the skill score from Table <a href="#S5.T5" title="Table 5 ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we can note that the greatest improvement of the best approach (in this case <span id="S5.p7.1.1" class="ltx_text ltx_font_italic">adapFL</span>) in relation to the baseline model (COTREC), is obtained for zone 3. As the objective of the skill score is to observe whether the model is better than a given base model, we have highlighted for each zone the greater one (which is <span id="S5.p7.1.2" class="ltx_text ltx_font_italic">adapFL</span> in all the four cases).</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>RMSE (<math id="S5.T5.2.m1.1" class="ltx_Math" alttext="kg/m^{2}" display="inline"><semantics id="S5.T5.2.m1.1b"><mrow id="S5.T5.2.m1.1.1" xref="S5.T5.2.m1.1.1.cmml"><mrow id="S5.T5.2.m1.1.1.2" xref="S5.T5.2.m1.1.1.2.cmml"><mi id="S5.T5.2.m1.1.1.2.2" xref="S5.T5.2.m1.1.1.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S5.T5.2.m1.1.1.2.1" xref="S5.T5.2.m1.1.1.2.1.cmml">​</mo><mi id="S5.T5.2.m1.1.1.2.3" xref="S5.T5.2.m1.1.1.2.3.cmml">g</mi></mrow><mo id="S5.T5.2.m1.1.1.1" xref="S5.T5.2.m1.1.1.1.cmml">/</mo><msup id="S5.T5.2.m1.1.1.3" xref="S5.T5.2.m1.1.1.3.cmml"><mi id="S5.T5.2.m1.1.1.3.2" xref="S5.T5.2.m1.1.1.3.2.cmml">m</mi><mn id="S5.T5.2.m1.1.1.3.3" xref="S5.T5.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T5.2.m1.1c"><apply id="S5.T5.2.m1.1.1.cmml" xref="S5.T5.2.m1.1.1"><divide id="S5.T5.2.m1.1.1.1.cmml" xref="S5.T5.2.m1.1.1.1"></divide><apply id="S5.T5.2.m1.1.1.2.cmml" xref="S5.T5.2.m1.1.1.2"><times id="S5.T5.2.m1.1.1.2.1.cmml" xref="S5.T5.2.m1.1.1.2.1"></times><ci id="S5.T5.2.m1.1.1.2.2.cmml" xref="S5.T5.2.m1.1.1.2.2">𝑘</ci><ci id="S5.T5.2.m1.1.1.2.3.cmml" xref="S5.T5.2.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T5.2.m1.1.1.3.cmml" xref="S5.T5.2.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T5.2.m1.1.1.3.1.cmml" xref="S5.T5.2.m1.1.1.3">superscript</csymbol><ci id="S5.T5.2.m1.1.1.3.2.cmml" xref="S5.T5.2.m1.1.1.3.2">𝑚</ci><cn type="integer" id="S5.T5.2.m1.1.1.3.3.cmml" xref="S5.T5.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.m1.1d">kg/m^{2}</annotation></semantics></math>) and skill score obtained in the test set with the different approaches in each zone.</figcaption>
<table id="S5.T5.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.3.1.1" class="ltx_tr">
<th id="S5.T5.3.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S5.T5.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S5.T5.3.1.1.2.1" class="ltx_text ltx_font_italic">RMSE</span></th>
<th id="S5.T5.3.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S5.T5.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4"><span id="S5.T5.3.1.1.4.1" class="ltx_text ltx_font_italic">Skill Score</span></th>
</tr>
<tr id="S5.T5.3.2.2" class="ltx_tr">
<th id="S5.T5.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row"><span id="S5.T5.3.2.2.1.1" class="ltx_text ltx_font_italic">Zone</span></th>
<th id="S5.T5.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.3.2.2.2.1" class="ltx_text ltx_font_italic">COTREC</span></th>
<th id="S5.T5.3.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.3.2.2.3.1" class="ltx_text ltx_font_italic">IL</span></th>
<th id="S5.T5.3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.3.2.2.4.1" class="ltx_text ltx_font_italic">FL</span></th>
<th id="S5.T5.3.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.3.2.2.5.1" class="ltx_text ltx_font_italic">adapFL</span></th>
<th id="S5.T5.3.2.2.6" class="ltx_td ltx_th ltx_th_column"></th>
<th id="S5.T5.3.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.3.2.2.7.1" class="ltx_text ltx_font_italic">COTREC</span></th>
<th id="S5.T5.3.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.3.2.2.8.1" class="ltx_text ltx_font_italic">IL</span></th>
<th id="S5.T5.3.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.3.2.2.9.1" class="ltx_text ltx_font_italic">FL</span></th>
<th id="S5.T5.3.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T5.3.2.2.10.1" class="ltx_text ltx_font_italic">adapFL</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.3.3.1" class="ltx_tr">
<th id="S5.T5.3.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S5.T5.3.3.1.1.1" class="ltx_text ltx_font_italic">1</span></th>
<td id="S5.T5.3.3.1.2" class="ltx_td ltx_align_center ltx_border_t">0.4802</td>
<td id="S5.T5.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t">0.3740</td>
<td id="S5.T5.3.3.1.4" class="ltx_td ltx_align_center ltx_border_t">0.4472</td>
<td id="S5.T5.3.3.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.3.3.1.5.1" class="ltx_text ltx_font_bold">0.3677</span></td>
<td id="S5.T5.3.3.1.6" class="ltx_td ltx_border_t"></td>
<td id="S5.T5.3.3.1.7" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S5.T5.3.3.1.8" class="ltx_td ltx_align_center ltx_border_t">0.3933</td>
<td id="S5.T5.3.3.1.9" class="ltx_td ltx_align_center ltx_border_t">0.1327</td>
<td id="S5.T5.3.3.1.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.3.3.1.10.1" class="ltx_text ltx_font_bold">0.4137</span></td>
</tr>
<tr id="S5.T5.3.4.2" class="ltx_tr">
<th id="S5.T5.3.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S5.T5.3.4.2.1.1" class="ltx_text ltx_font_italic">2</span></th>
<td id="S5.T5.3.4.2.2" class="ltx_td ltx_align_center">0.4190</td>
<td id="S5.T5.3.4.2.3" class="ltx_td ltx_align_center">0.3251</td>
<td id="S5.T5.3.4.2.4" class="ltx_td ltx_align_center">0.4015</td>
<td id="S5.T5.3.4.2.5" class="ltx_td ltx_align_center"><span id="S5.T5.3.4.2.5.1" class="ltx_text ltx_font_bold">0.3170</span></td>
<td id="S5.T5.3.4.2.6" class="ltx_td"></td>
<td id="S5.T5.3.4.2.7" class="ltx_td ltx_align_center">-</td>
<td id="S5.T5.3.4.2.8" class="ltx_td ltx_align_center">0.3981</td>
<td id="S5.T5.3.4.2.9" class="ltx_td ltx_align_center">0.0820</td>
<td id="S5.T5.3.4.2.10" class="ltx_td ltx_align_center"><span id="S5.T5.3.4.2.10.1" class="ltx_text ltx_font_bold">0.4277</span></td>
</tr>
<tr id="S5.T5.3.5.3" class="ltx_tr">
<th id="S5.T5.3.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S5.T5.3.5.3.1.1" class="ltx_text ltx_font_italic">3</span></th>
<td id="S5.T5.3.5.3.2" class="ltx_td ltx_align_center">0.4728</td>
<td id="S5.T5.3.5.3.3" class="ltx_td ltx_align_center">0.3493</td>
<td id="S5.T5.3.5.3.4" class="ltx_td ltx_align_center">0.3586</td>
<td id="S5.T5.3.5.3.5" class="ltx_td ltx_align_center"><span id="S5.T5.3.5.3.5.1" class="ltx_text ltx_font_bold">0.3289</span></td>
<td id="S5.T5.3.5.3.6" class="ltx_td"></td>
<td id="S5.T5.3.5.3.7" class="ltx_td ltx_align_center">-</td>
<td id="S5.T5.3.5.3.8" class="ltx_td ltx_align_center">0.4541</td>
<td id="S5.T5.3.5.3.9" class="ltx_td ltx_align_center">0.4246</td>
<td id="S5.T5.3.5.3.10" class="ltx_td ltx_align_center"><span id="S5.T5.3.5.3.10.1" class="ltx_text ltx_font_bold">0.5159</span></td>
</tr>
<tr id="S5.T5.3.6.4" class="ltx_tr">
<th id="S5.T5.3.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S5.T5.3.6.4.1.1" class="ltx_text ltx_font_italic">4</span></th>
<td id="S5.T5.3.6.4.2" class="ltx_td ltx_align_center ltx_border_bb">0.3309</td>
<td id="S5.T5.3.6.4.3" class="ltx_td ltx_align_center ltx_border_bb">0.2919</td>
<td id="S5.T5.3.6.4.4" class="ltx_td ltx_align_center ltx_border_bb">0.3095</td>
<td id="S5.T5.3.6.4.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T5.3.6.4.5.1" class="ltx_text ltx_font_bold">0.2855</span></td>
<td id="S5.T5.3.6.4.6" class="ltx_td ltx_border_bb"></td>
<td id="S5.T5.3.6.4.7" class="ltx_td ltx_align_center ltx_border_bb">-</td>
<td id="S5.T5.3.6.4.8" class="ltx_td ltx_align_center ltx_border_bb">0.2219</td>
<td id="S5.T5.3.6.4.9" class="ltx_td ltx_align_center ltx_border_bb">0.1251</td>
<td id="S5.T5.3.6.4.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T5.3.6.4.10.1" class="ltx_text ltx_font_bold">0.2557</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.p8" class="ltx_para">
<p id="S5.p8.1" class="ltx_p">Finally, the distribution of the MAE and the MSE for each image of the test set of each zone is shown in Appendix <a href="#A4" title="Appendix D MAE and MSE obtained in each image from the test set ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a> by means of histograms.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Central area</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">Once we have the four individual models and the models trained in a federated way, we are interested in seeing how the last ones perform in a different region. To do this, we take the 50<math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mo id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><times id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\times</annotation></semantics></math>50 central crop of the original image (so that it is of the same resolution as the images of each of the 4 zones). An example of an image where this division is taken is shown in Figure <a href="#S5.F6" title="Figure 6 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, where the central area selected is the one framed within the red square.</p>
</div>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2408.05761/assets/fig/central_zone_example.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="419" height="350" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Example of an image where the four quadrants into which it has been divided to create the four zones are shown in blue and the central area is marked in red.</figcaption>
</figure>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">Let us consider all the images within this quadrant and evaluate the predictions that would be obtained with the FL model and the four adaptive FL models for each of the 4 initial areas. Also, we compare it with the IL model on that area and the <span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_italic">adapFL</span> one with the adaptive phase performed in such zone (the central one), but the FL model only on the first 4 zones. Since part of the images that we evaluate are part of the training set of each individual zone, we will take the same test set as in the previous cases, corresponding to the last 20<math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mo id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><csymbol cd="latexml" id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\%</annotation></semantics></math>. Again, the same processing will be carried out in each zone regarding the blank (empty, no-rain) images and the input for the DL models. The results obtained in each case for the train and test set and both for the MSE and the MAE are shown in Table <a href="#S5.T6" title="Table 6 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Note from this table that the first three rows correspond to models that have explicitly seen data from the central zone training set (COTREC, IL over the central zone, and <span id="S5.SS1.p2.1.2" class="ltx_text ltx_font_italic">adapFL</span> with FL over the four initial zones and personalized with the adaptive phase over the central area with a configuration (9,10)). The rest of the models shown in Table <a href="#S5.T6" title="Table 6 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> have not directly seen training data from the central zone, although each of the four initial zones contain part of the data from the central area.</p>
</div>
<figure id="S5.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Comparison of the MSE and MAE (<math id="S5.T6.2.m1.1" class="ltx_Math" alttext="kg/m^{2}" display="inline"><semantics id="S5.T6.2.m1.1b"><mrow id="S5.T6.2.m1.1.1" xref="S5.T6.2.m1.1.1.cmml"><mrow id="S5.T6.2.m1.1.1.2" xref="S5.T6.2.m1.1.1.2.cmml"><mi id="S5.T6.2.m1.1.1.2.2" xref="S5.T6.2.m1.1.1.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S5.T6.2.m1.1.1.2.1" xref="S5.T6.2.m1.1.1.2.1.cmml">​</mo><mi id="S5.T6.2.m1.1.1.2.3" xref="S5.T6.2.m1.1.1.2.3.cmml">g</mi></mrow><mo id="S5.T6.2.m1.1.1.1" xref="S5.T6.2.m1.1.1.1.cmml">/</mo><msup id="S5.T6.2.m1.1.1.3" xref="S5.T6.2.m1.1.1.3.cmml"><mi id="S5.T6.2.m1.1.1.3.2" xref="S5.T6.2.m1.1.1.3.2.cmml">m</mi><mn id="S5.T6.2.m1.1.1.3.3" xref="S5.T6.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.2.m1.1c"><apply id="S5.T6.2.m1.1.1.cmml" xref="S5.T6.2.m1.1.1"><divide id="S5.T6.2.m1.1.1.1.cmml" xref="S5.T6.2.m1.1.1.1"></divide><apply id="S5.T6.2.m1.1.1.2.cmml" xref="S5.T6.2.m1.1.1.2"><times id="S5.T6.2.m1.1.1.2.1.cmml" xref="S5.T6.2.m1.1.1.2.1"></times><ci id="S5.T6.2.m1.1.1.2.2.cmml" xref="S5.T6.2.m1.1.1.2.2">𝑘</ci><ci id="S5.T6.2.m1.1.1.2.3.cmml" xref="S5.T6.2.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T6.2.m1.1.1.3.cmml" xref="S5.T6.2.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T6.2.m1.1.1.3.1.cmml" xref="S5.T6.2.m1.1.1.3">superscript</csymbol><ci id="S5.T6.2.m1.1.1.3.2.cmml" xref="S5.T6.2.m1.1.1.3.2">𝑚</ci><cn type="integer" id="S5.T6.2.m1.1.1.3.3.cmml" xref="S5.T6.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.2.m1.1d">kg/m^{2}</annotation></semantics></math>) obtained in the train and test sets of the central zone with the different approaches analyzed.</figcaption>
<table id="S5.T6.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T6.3.1.1" class="ltx_tr">
<th id="S5.T6.3.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S5.T6.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S5.T6.3.1.1.2.1" class="ltx_text ltx_font_italic">Central zone</span></td>
</tr>
<tr id="S5.T6.3.2.2" class="ltx_tr">
<th id="S5.T6.3.2.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S5.T6.3.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.3.2.2.2.1" class="ltx_text ltx_font_italic">MSE</span></td>
<td id="S5.T6.3.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.3.2.2.3.1" class="ltx_text ltx_font_italic">MSE</span></td>
<td id="S5.T6.3.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.3.2.2.4.1" class="ltx_text ltx_font_italic">MAE</span></td>
<td id="S5.T6.3.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.3.2.2.5.1" class="ltx_text ltx_font_italic">MAE</span></td>
</tr>
<tr id="S5.T6.3.3.3" class="ltx_tr">
<th id="S5.T6.3.3.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T6.3.3.3.1.1" class="ltx_text ltx_font_italic">Model</span></th>
<td id="S5.T6.3.3.3.2" class="ltx_td ltx_align_center"><span id="S5.T6.3.3.3.2.1" class="ltx_text ltx_font_italic">Train</span></td>
<td id="S5.T6.3.3.3.3" class="ltx_td ltx_align_center"><span id="S5.T6.3.3.3.3.1" class="ltx_text ltx_font_italic">Test</span></td>
<td id="S5.T6.3.3.3.4" class="ltx_td ltx_align_center"><span id="S5.T6.3.3.3.4.1" class="ltx_text ltx_font_italic">Train</span></td>
<td id="S5.T6.3.3.3.5" class="ltx_td ltx_align_center"><span id="S5.T6.3.3.3.5.1" class="ltx_text ltx_font_italic">Test</span></td>
</tr>
<tr id="S5.T6.3.4.4" class="ltx_tr">
<th id="S5.T6.3.4.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t"><span id="S5.T6.3.4.4.1.1" class="ltx_text ltx_font_italic">COTREC</span></th>
<td id="S5.T6.3.4.4.2" class="ltx_td ltx_align_center ltx_border_t">0.0798</td>
<td id="S5.T6.3.4.4.3" class="ltx_td ltx_align_center ltx_border_t">0.2547</td>
<td id="S5.T6.3.4.4.4" class="ltx_td ltx_align_center ltx_border_t">0.0308</td>
<td id="S5.T6.3.4.4.5" class="ltx_td ltx_align_center ltx_border_t">0.0735</td>
</tr>
<tr id="S5.T6.3.5.5" class="ltx_tr">
<th id="S5.T6.3.5.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T6.3.5.5.1.1" class="ltx_text ltx_font_italic">IL zone central</span></th>
<td id="S5.T6.3.5.5.2" class="ltx_td ltx_align_center">0.0118</td>
<td id="S5.T6.3.5.5.3" class="ltx_td ltx_align_center"><span id="S5.T6.3.5.5.3.1" class="ltx_text ltx_font_bold">0.0121</span></td>
<td id="S5.T6.3.5.5.4" class="ltx_td ltx_align_center"><span id="S5.T6.3.5.5.4.1" class="ltx_text ltx_font_bold">0.0130</span></td>
<td id="S5.T6.3.5.5.5" class="ltx_td ltx_align_center">0.0207</td>
</tr>
<tr id="S5.T6.3.6.6" class="ltx_tr">
<th id="S5.T6.3.6.6.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T6.3.6.6.1.1" class="ltx_text ltx_font_italic">adapFL (central)</span></th>
<td id="S5.T6.3.6.6.2" class="ltx_td ltx_align_center"><span id="S5.T6.3.6.6.2.1" class="ltx_text ltx_font_bold">0.0067</span></td>
<td id="S5.T6.3.6.6.3" class="ltx_td ltx_align_center">0.0129</td>
<td id="S5.T6.3.6.6.4" class="ltx_td ltx_align_center">0.0149</td>
<td id="S5.T6.3.6.6.5" class="ltx_td ltx_align_center"><span id="S5.T6.3.6.6.5.1" class="ltx_text ltx_font_bold">0.0199</span></td>
</tr>
<tr id="S5.T6.3.7.7" class="ltx_tr">
<th id="S5.T6.3.7.7.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t"><span id="S5.T6.3.7.7.1.1" class="ltx_text ltx_font_italic">FL (four areas)</span></th>
<td id="S5.T6.3.7.7.2" class="ltx_td ltx_align_center ltx_border_t">0.0128</td>
<td id="S5.T6.3.7.7.3" class="ltx_td ltx_align_center ltx_border_t">0.0140</td>
<td id="S5.T6.3.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.3.7.7.4.1" class="ltx_text ltx_font_bold">0.0161</span></td>
<td id="S5.T6.3.7.7.5" class="ltx_td ltx_align_center ltx_border_t">0.0195</td>
</tr>
<tr id="S5.T6.3.8.8" class="ltx_tr">
<th id="S5.T6.3.8.8.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T6.3.8.8.1.1" class="ltx_text ltx_font_italic">adapFL (zone 1)</span></th>
<td id="S5.T6.3.8.8.2" class="ltx_td ltx_align_center">0.0111</td>
<td id="S5.T6.3.8.8.3" class="ltx_td ltx_align_center">0.0130</td>
<td id="S5.T6.3.8.8.4" class="ltx_td ltx_align_center">0.0174</td>
<td id="S5.T6.3.8.8.5" class="ltx_td ltx_align_center">0.0210</td>
</tr>
<tr id="S5.T6.3.9.9" class="ltx_tr">
<th id="S5.T6.3.9.9.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T6.3.9.9.1.1" class="ltx_text ltx_font_italic">adapFL (zone 2)</span></th>
<td id="S5.T6.3.9.9.2" class="ltx_td ltx_align_center"><span id="S5.T6.3.9.9.2.1" class="ltx_text ltx_font_bold">0.0103</span></td>
<td id="S5.T6.3.9.9.3" class="ltx_td ltx_align_center">0.0134</td>
<td id="S5.T6.3.9.9.4" class="ltx_td ltx_align_center">0.0165</td>
<td id="S5.T6.3.9.9.5" class="ltx_td ltx_align_center">0.0201</td>
</tr>
<tr id="S5.T6.3.10.10" class="ltx_tr">
<th id="S5.T6.3.10.10.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T6.3.10.10.1.1" class="ltx_text ltx_font_italic">adapFL (zone 3)</span></th>
<td id="S5.T6.3.10.10.2" class="ltx_td ltx_align_center">0.0112</td>
<td id="S5.T6.3.10.10.3" class="ltx_td ltx_align_center"><span id="S5.T6.3.10.10.3.1" class="ltx_text ltx_font_bold">0.0123</span></td>
<td id="S5.T6.3.10.10.4" class="ltx_td ltx_align_center">0.0169</td>
<td id="S5.T6.3.10.10.5" class="ltx_td ltx_align_center">0.0200</td>
</tr>
<tr id="S5.T6.3.11.11" class="ltx_tr">
<th id="S5.T6.3.11.11.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb"><span id="S5.T6.3.11.11.1.1" class="ltx_text ltx_font_italic">adapFL (zone 4)</span></th>
<td id="S5.T6.3.11.11.2" class="ltx_td ltx_align_center ltx_border_bb">0.0114</td>
<td id="S5.T6.3.11.11.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T6.3.11.11.3.1" class="ltx_text ltx_font_bold">0.0123</span></td>
<td id="S5.T6.3.11.11.4" class="ltx_td ltx_align_center ltx_border_bb">0.0159</td>
<td id="S5.T6.3.11.11.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T6.3.11.11.5.1" class="ltx_text ltx_font_bold">0.0187</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">From Table <a href="#S5.T6" title="Table 6 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we can highlight the following points: (1) it makes sense to analyze the performance of the FL model since each initial area has part of the central zone analyzed in this case. (2) Intuitively, the best results should be obtained with the models trained in the same zone, in this case IL in the central zone and <span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_italic">adapFL</span> on the central zone. (3) The COTREC model is largely worse than the other approaches analyzed, so it can be extrapolated that in this scenario it is more convenient to apply DL models. (4) In the training set the <span id="S5.SS1.p3.1.2" class="ltx_text ltx_font_italic">adapFL</span> model over the central zone is the best in terms of MSE, and the individual one with respect to the MAE (followed by <span id="S5.SS1.p3.1.3" class="ltx_text ltx_font_italic">adapFL</span> over the central zone). (5) In the test set the best results for MSE are obtained with the individual model, followed by the <span id="S5.SS1.p3.1.4" class="ltx_text ltx_font_italic">adapFL</span> ones over zones 3 and 4. (6) In the test set the best result with respect to the MAE is obtained with the <span id="S5.SS1.p3.1.5" class="ltx_text ltx_font_italic">adapFL</span> model over zone 4 followed by the basic FL model, being in this case the FL approach better than the individual model trained over the current area of study.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">Again in this case we have calculated from Table <a href="#S5.T6" title="Table 6 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> the RMSE and the skill score (with COTREC as baseline) for the prediction on the central zone. The results for these two metrics can be found in Table <a href="#S5.T7" title="Table 7 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. Note that in this case the results for the skill score show a greater difference between the MSE for the baseline model and the other approaches than in the previous case where the four initial zones were analyzed.</p>
</div>
<figure id="S5.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Comparison of the MSE (<math id="S5.T7.2.m1.1" class="ltx_Math" alttext="kg/m^{2}" display="inline"><semantics id="S5.T7.2.m1.1b"><mrow id="S5.T7.2.m1.1.1" xref="S5.T7.2.m1.1.1.cmml"><mrow id="S5.T7.2.m1.1.1.2" xref="S5.T7.2.m1.1.1.2.cmml"><mi id="S5.T7.2.m1.1.1.2.2" xref="S5.T7.2.m1.1.1.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S5.T7.2.m1.1.1.2.1" xref="S5.T7.2.m1.1.1.2.1.cmml">​</mo><mi id="S5.T7.2.m1.1.1.2.3" xref="S5.T7.2.m1.1.1.2.3.cmml">g</mi></mrow><mo id="S5.T7.2.m1.1.1.1" xref="S5.T7.2.m1.1.1.1.cmml">/</mo><msup id="S5.T7.2.m1.1.1.3" xref="S5.T7.2.m1.1.1.3.cmml"><mi id="S5.T7.2.m1.1.1.3.2" xref="S5.T7.2.m1.1.1.3.2.cmml">m</mi><mn id="S5.T7.2.m1.1.1.3.3" xref="S5.T7.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T7.2.m1.1c"><apply id="S5.T7.2.m1.1.1.cmml" xref="S5.T7.2.m1.1.1"><divide id="S5.T7.2.m1.1.1.1.cmml" xref="S5.T7.2.m1.1.1.1"></divide><apply id="S5.T7.2.m1.1.1.2.cmml" xref="S5.T7.2.m1.1.1.2"><times id="S5.T7.2.m1.1.1.2.1.cmml" xref="S5.T7.2.m1.1.1.2.1"></times><ci id="S5.T7.2.m1.1.1.2.2.cmml" xref="S5.T7.2.m1.1.1.2.2">𝑘</ci><ci id="S5.T7.2.m1.1.1.2.3.cmml" xref="S5.T7.2.m1.1.1.2.3">𝑔</ci></apply><apply id="S5.T7.2.m1.1.1.3.cmml" xref="S5.T7.2.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T7.2.m1.1.1.3.1.cmml" xref="S5.T7.2.m1.1.1.3">superscript</csymbol><ci id="S5.T7.2.m1.1.1.3.2.cmml" xref="S5.T7.2.m1.1.1.3.2">𝑚</ci><cn type="integer" id="S5.T7.2.m1.1.1.3.3.cmml" xref="S5.T7.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.2.m1.1d">kg/m^{2}</annotation></semantics></math>) and skill score obtained in the train and test sets of the central zone with the different approaches analyzed.</figcaption>
<table id="S5.T7.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T7.3.1.1" class="ltx_tr">
<th id="S5.T7.3.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S5.T7.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S5.T7.3.1.1.2.1" class="ltx_text ltx_font_italic">Central zone</span></td>
</tr>
<tr id="S5.T7.3.2.2" class="ltx_tr">
<th id="S5.T7.3.2.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S5.T7.3.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T7.3.2.2.2.1" class="ltx_text ltx_font_italic">RMSE</span></td>
<td id="S5.T7.3.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T7.3.2.2.3.1" class="ltx_text ltx_font_italic">RMSE</span></td>
<td id="S5.T7.3.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T7.3.2.2.4.1" class="ltx_text ltx_font_italic">Skill Score</span></td>
<td id="S5.T7.3.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T7.3.2.2.5.1" class="ltx_text ltx_font_italic">Skill Score</span></td>
</tr>
<tr id="S5.T7.3.3.3" class="ltx_tr">
<th id="S5.T7.3.3.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T7.3.3.3.1.1" class="ltx_text ltx_font_italic">Model</span></th>
<td id="S5.T7.3.3.3.2" class="ltx_td ltx_align_center"><span id="S5.T7.3.3.3.2.1" class="ltx_text ltx_font_italic">Train</span></td>
<td id="S5.T7.3.3.3.3" class="ltx_td ltx_align_center"><span id="S5.T7.3.3.3.3.1" class="ltx_text ltx_font_italic">Test</span></td>
<td id="S5.T7.3.3.3.4" class="ltx_td ltx_align_center"><span id="S5.T7.3.3.3.4.1" class="ltx_text ltx_font_italic">Train</span></td>
<td id="S5.T7.3.3.3.5" class="ltx_td ltx_align_center"><span id="S5.T7.3.3.3.5.1" class="ltx_text ltx_font_italic">Test</span></td>
</tr>
<tr id="S5.T7.3.4.4" class="ltx_tr">
<th id="S5.T7.3.4.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t"><span id="S5.T7.3.4.4.1.1" class="ltx_text ltx_font_italic">COTREC</span></th>
<td id="S5.T7.3.4.4.2" class="ltx_td ltx_align_center ltx_border_t">0.2825</td>
<td id="S5.T7.3.4.4.3" class="ltx_td ltx_align_center ltx_border_t">0.5047</td>
<td id="S5.T7.3.4.4.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S5.T7.3.4.4.5" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S5.T7.3.5.5" class="ltx_tr">
<th id="S5.T7.3.5.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T7.3.5.5.1.1" class="ltx_text ltx_font_italic">IL zone central</span></th>
<td id="S5.T7.3.5.5.2" class="ltx_td ltx_align_center">0.1086</td>
<td id="S5.T7.3.5.5.3" class="ltx_td ltx_align_center"><span id="S5.T7.3.5.5.3.1" class="ltx_text ltx_font_bold">0.1100</span></td>
<td id="S5.T7.3.5.5.4" class="ltx_td ltx_align_center">0.8521</td>
<td id="S5.T7.3.5.5.5" class="ltx_td ltx_align_center"><span id="S5.T7.3.5.5.5.1" class="ltx_text ltx_font_bold">0.9525</span></td>
</tr>
<tr id="S5.T7.3.6.6" class="ltx_tr">
<th id="S5.T7.3.6.6.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T7.3.6.6.1.1" class="ltx_text ltx_font_italic">adapFL (central)</span></th>
<td id="S5.T7.3.6.6.2" class="ltx_td ltx_align_center"><span id="S5.T7.3.6.6.2.1" class="ltx_text ltx_font_bold">0.0819</span></td>
<td id="S5.T7.3.6.6.3" class="ltx_td ltx_align_center">0.1136</td>
<td id="S5.T7.3.6.6.4" class="ltx_td ltx_align_center"><span id="S5.T7.3.6.6.4.1" class="ltx_text ltx_font_bold">0.9160</span></td>
<td id="S5.T7.3.6.6.5" class="ltx_td ltx_align_center">0.9494</td>
</tr>
<tr id="S5.T7.3.7.7" class="ltx_tr">
<th id="S5.T7.3.7.7.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t"><span id="S5.T7.3.7.7.1.1" class="ltx_text ltx_font_italic">FL (four areas)</span></th>
<td id="S5.T7.3.7.7.2" class="ltx_td ltx_align_center ltx_border_t">0.1131</td>
<td id="S5.T7.3.7.7.3" class="ltx_td ltx_align_center ltx_border_t">0.1183</td>
<td id="S5.T7.3.7.7.4" class="ltx_td ltx_align_center ltx_border_t">0.8396</td>
<td id="S5.T7.3.7.7.5" class="ltx_td ltx_align_center ltx_border_t">0.9450</td>
</tr>
<tr id="S5.T7.3.8.8" class="ltx_tr">
<th id="S5.T7.3.8.8.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T7.3.8.8.1.1" class="ltx_text ltx_font_italic">adapFL (zone 1)</span></th>
<td id="S5.T7.3.8.8.2" class="ltx_td ltx_align_center">0.1054</td>
<td id="S5.T7.3.8.8.3" class="ltx_td ltx_align_center">0.1140</td>
<td id="S5.T7.3.8.8.4" class="ltx_td ltx_align_center">0.8609</td>
<td id="S5.T7.3.8.8.5" class="ltx_td ltx_align_center">0.9490</td>
</tr>
<tr id="S5.T7.3.9.9" class="ltx_tr">
<th id="S5.T7.3.9.9.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T7.3.9.9.1.1" class="ltx_text ltx_font_italic">adapFL (zone 2)</span></th>
<td id="S5.T7.3.9.9.2" class="ltx_td ltx_align_center"><span id="S5.T7.3.9.9.2.1" class="ltx_text ltx_font_bold">0.1015</span></td>
<td id="S5.T7.3.9.9.3" class="ltx_td ltx_align_center">0.1158</td>
<td id="S5.T7.3.9.9.4" class="ltx_td ltx_align_center"><span id="S5.T7.3.9.9.4.1" class="ltx_text ltx_font_bold">0.8709</span></td>
<td id="S5.T7.3.9.9.5" class="ltx_td ltx_align_center">0.9474</td>
</tr>
<tr id="S5.T7.3.10.10" class="ltx_tr">
<th id="S5.T7.3.10.10.1" class="ltx_td ltx_align_right ltx_th ltx_th_row"><span id="S5.T7.3.10.10.1.1" class="ltx_text ltx_font_italic">adapFL (zone 3)</span></th>
<td id="S5.T7.3.10.10.2" class="ltx_td ltx_align_center">0.1058</td>
<td id="S5.T7.3.10.10.3" class="ltx_td ltx_align_center"><span id="S5.T7.3.10.10.3.1" class="ltx_text ltx_font_bold">0.1109</span></td>
<td id="S5.T7.3.10.10.4" class="ltx_td ltx_align_center">0.8596</td>
<td id="S5.T7.3.10.10.5" class="ltx_td ltx_align_center"><span id="S5.T7.3.10.10.5.1" class="ltx_text ltx_font_bold">0.9517</span></td>
</tr>
<tr id="S5.T7.3.11.11" class="ltx_tr">
<th id="S5.T7.3.11.11.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb"><span id="S5.T7.3.11.11.1.1" class="ltx_text ltx_font_italic">adapFL (zone 4)</span></th>
<td id="S5.T7.3.11.11.2" class="ltx_td ltx_align_center ltx_border_bb">0.1068</td>
<td id="S5.T7.3.11.11.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T7.3.11.11.3.1" class="ltx_text ltx_font_bold">0.1109</span></td>
<td id="S5.T7.3.11.11.4" class="ltx_td ltx_align_center ltx_border_bb">0.8571</td>
<td id="S5.T7.3.11.11.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T7.3.11.11.5.1" class="ltx_text ltx_font_bold">0.9517</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.1" class="ltx_p">Furthermore, Figure <a href="#S5.F7" title="Figure 7 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows three images in the conditions mentioned above (central quadrant of resolution <math id="S5.SS1.p5.1.m1.1" class="ltx_Math" alttext="50\times 50" display="inline"><semantics id="S5.SS1.p5.1.m1.1a"><mrow id="S5.SS1.p5.1.m1.1.1" xref="S5.SS1.p5.1.m1.1.1.cmml"><mn id="S5.SS1.p5.1.m1.1.1.2" xref="S5.SS1.p5.1.m1.1.1.2.cmml">50</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p5.1.m1.1.1.1" xref="S5.SS1.p5.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS1.p5.1.m1.1.1.3" xref="S5.SS1.p5.1.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.1.m1.1b"><apply id="S5.SS1.p5.1.m1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1"><times id="S5.SS1.p5.1.m1.1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1.1"></times><cn type="integer" id="S5.SS1.p5.1.m1.1.1.2.cmml" xref="S5.SS1.p5.1.m1.1.1.2">50</cn><cn type="integer" id="S5.SS1.p5.1.m1.1.1.3.cmml" xref="S5.SS1.p5.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.1.m1.1c">50\times 50</annotation></semantics></math>), and their corresponding prediction obtained using the FL approach applied to the four initial areas and the <span id="S5.SS1.p5.1.1" class="ltx_text ltx_font_italic">adapFL</span> one (adapted to the central area).</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2408.05761/assets/fig/fl_central_pred.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="539" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Example of predictions of the test set of the central zone. Federated learning approach with <math id="S5.F7.3.m1.1" class="ltx_Math" alttext="N_{r}=10" display="inline"><semantics id="S5.F7.3.m1.1b"><mrow id="S5.F7.3.m1.1.1" xref="S5.F7.3.m1.1.1.cmml"><msub id="S5.F7.3.m1.1.1.2" xref="S5.F7.3.m1.1.1.2.cmml"><mi id="S5.F7.3.m1.1.1.2.2" xref="S5.F7.3.m1.1.1.2.2.cmml">N</mi><mi id="S5.F7.3.m1.1.1.2.3" xref="S5.F7.3.m1.1.1.2.3.cmml">r</mi></msub><mo id="S5.F7.3.m1.1.1.1" xref="S5.F7.3.m1.1.1.1.cmml">=</mo><mn id="S5.F7.3.m1.1.1.3" xref="S5.F7.3.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.3.m1.1c"><apply id="S5.F7.3.m1.1.1.cmml" xref="S5.F7.3.m1.1.1"><eq id="S5.F7.3.m1.1.1.1.cmml" xref="S5.F7.3.m1.1.1.1"></eq><apply id="S5.F7.3.m1.1.1.2.cmml" xref="S5.F7.3.m1.1.1.2"><csymbol cd="ambiguous" id="S5.F7.3.m1.1.1.2.1.cmml" xref="S5.F7.3.m1.1.1.2">subscript</csymbol><ci id="S5.F7.3.m1.1.1.2.2.cmml" xref="S5.F7.3.m1.1.1.2.2">𝑁</ci><ci id="S5.F7.3.m1.1.1.2.3.cmml" xref="S5.F7.3.m1.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S5.F7.3.m1.1.1.3.cmml" xref="S5.F7.3.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.3.m1.1d">N_{r}=10</annotation></semantics></math> and <math id="S5.F7.4.m2.1" class="ltx_Math" alttext="N_{e}=10" display="inline"><semantics id="S5.F7.4.m2.1b"><mrow id="S5.F7.4.m2.1.1" xref="S5.F7.4.m2.1.1.cmml"><msub id="S5.F7.4.m2.1.1.2" xref="S5.F7.4.m2.1.1.2.cmml"><mi id="S5.F7.4.m2.1.1.2.2" xref="S5.F7.4.m2.1.1.2.2.cmml">N</mi><mi id="S5.F7.4.m2.1.1.2.3" xref="S5.F7.4.m2.1.1.2.3.cmml">e</mi></msub><mo id="S5.F7.4.m2.1.1.1" xref="S5.F7.4.m2.1.1.1.cmml">=</mo><mn id="S5.F7.4.m2.1.1.3" xref="S5.F7.4.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.4.m2.1c"><apply id="S5.F7.4.m2.1.1.cmml" xref="S5.F7.4.m2.1.1"><eq id="S5.F7.4.m2.1.1.1.cmml" xref="S5.F7.4.m2.1.1.1"></eq><apply id="S5.F7.4.m2.1.1.2.cmml" xref="S5.F7.4.m2.1.1.2"><csymbol cd="ambiguous" id="S5.F7.4.m2.1.1.2.1.cmml" xref="S5.F7.4.m2.1.1.2">subscript</csymbol><ci id="S5.F7.4.m2.1.1.2.2.cmml" xref="S5.F7.4.m2.1.1.2.2">𝑁</ci><ci id="S5.F7.4.m2.1.1.2.3.cmml" xref="S5.F7.4.m2.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S5.F7.4.m2.1.1.3.cmml" xref="S5.F7.4.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.4.m2.1d">N_{e}=10</annotation></semantics></math> and <span id="S5.F7.6.1" class="ltx_text ltx_font_italic">adapFL</span> method with the configuration (9,10).</figcaption>
</figure>
<div id="S5.SS1.p6" class="ltx_para">
<p id="S5.SS1.p6.5" class="ltx_p">Finally, it is interesting to analyze the non-independent identically distributed (i.i.d.) nature of each of the five zones proposed. Assuming the privacy-preserving deep learning approach (FL and <span id="S5.SS1.p6.5.1" class="ltx_text ltx_font_italic">adapFL</span>) in which we do not have access to all the raw images in order to preserve privacy, technical or legal considerations that may apply to each image (e.g. may belong to different data owners), this analysis is carried out on the only information that the central server that performs the federated training would have available: the weights that define the model. In this sense, the divergence of the weights between each pair of zones <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> was analyzed. Specifically, we repeated the training in the 5 zones (including the central zone) from the initial model when training only 10 epochs individually (as done in each round of the FL training), and we kept the weights obtained in each case. Be <math id="S5.SS1.p6.1.m1.1" class="ltx_math_unparsed" alttext="||\cdot||_{F}" display="inline"><semantics id="S5.SS1.p6.1.m1.1a"><mrow id="S5.SS1.p6.1.m1.1b"><mo fence="false" rspace="0.167em" stretchy="false" id="S5.SS1.p6.1.m1.1.1">|</mo><mo fence="false" stretchy="false" id="S5.SS1.p6.1.m1.1.2">|</mo><mo lspace="0em" rspace="0em" id="S5.SS1.p6.1.m1.1.3">⋅</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S5.SS1.p6.1.m1.1.4">|</mo><msub id="S5.SS1.p6.1.m1.1.5"><mo fence="false" stretchy="false" id="S5.SS1.p6.1.m1.1.5.2">|</mo><mi id="S5.SS1.p6.1.m1.1.5.3">F</mi></msub></mrow><annotation encoding="application/x-tex" id="S5.SS1.p6.1.m1.1c">||\cdot||_{F}</annotation></semantics></math> the Frobenius norm, and <math id="S5.SS1.p6.2.m2.1" class="ltx_Math" alttext="w_{i}^{(n)}" display="inline"><semantics id="S5.SS1.p6.2.m2.1a"><msubsup id="S5.SS1.p6.2.m2.1.2" xref="S5.SS1.p6.2.m2.1.2.cmml"><mi id="S5.SS1.p6.2.m2.1.2.2.2" xref="S5.SS1.p6.2.m2.1.2.2.2.cmml">w</mi><mi id="S5.SS1.p6.2.m2.1.2.2.3" xref="S5.SS1.p6.2.m2.1.2.2.3.cmml">i</mi><mrow id="S5.SS1.p6.2.m2.1.1.1.3" xref="S5.SS1.p6.2.m2.1.2.cmml"><mo stretchy="false" id="S5.SS1.p6.2.m2.1.1.1.3.1" xref="S5.SS1.p6.2.m2.1.2.cmml">(</mo><mi id="S5.SS1.p6.2.m2.1.1.1.1" xref="S5.SS1.p6.2.m2.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S5.SS1.p6.2.m2.1.1.1.3.2" xref="S5.SS1.p6.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.2.m2.1b"><apply id="S5.SS1.p6.2.m2.1.2.cmml" xref="S5.SS1.p6.2.m2.1.2"><csymbol cd="ambiguous" id="S5.SS1.p6.2.m2.1.2.1.cmml" xref="S5.SS1.p6.2.m2.1.2">superscript</csymbol><apply id="S5.SS1.p6.2.m2.1.2.2.cmml" xref="S5.SS1.p6.2.m2.1.2"><csymbol cd="ambiguous" id="S5.SS1.p6.2.m2.1.2.2.1.cmml" xref="S5.SS1.p6.2.m2.1.2">subscript</csymbol><ci id="S5.SS1.p6.2.m2.1.2.2.2.cmml" xref="S5.SS1.p6.2.m2.1.2.2.2">𝑤</ci><ci id="S5.SS1.p6.2.m2.1.2.2.3.cmml" xref="S5.SS1.p6.2.m2.1.2.2.3">𝑖</ci></apply><ci id="S5.SS1.p6.2.m2.1.1.1.1.cmml" xref="S5.SS1.p6.2.m2.1.1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.2.m2.1c">w_{i}^{(n)}</annotation></semantics></math> the weights obtained when training with the data from client <math id="S5.SS1.p6.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p6.3.m3.1a"><mi id="S5.SS1.p6.3.m3.1.1" xref="S5.SS1.p6.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.3.m3.1b"><ci id="S5.SS1.p6.3.m3.1.1.cmml" xref="S5.SS1.p6.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.3.m3.1c">i</annotation></semantics></math> in round <math id="S5.SS1.p6.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S5.SS1.p6.4.m4.1a"><mi id="S5.SS1.p6.4.m4.1.1" xref="S5.SS1.p6.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.4.m4.1b"><ci id="S5.SS1.p6.4.m4.1.1.cmml" xref="S5.SS1.p6.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.4.m4.1c">n</annotation></semantics></math>, we define the divergence in a symmetric way <math id="S5.SS1.p6.5.m5.3" class="ltx_Math" alttext="d_{i,j}^{(n)}" display="inline"><semantics id="S5.SS1.p6.5.m5.3a"><msubsup id="S5.SS1.p6.5.m5.3.4" xref="S5.SS1.p6.5.m5.3.4.cmml"><mi id="S5.SS1.p6.5.m5.3.4.2.2" xref="S5.SS1.p6.5.m5.3.4.2.2.cmml">d</mi><mrow id="S5.SS1.p6.5.m5.2.2.2.4" xref="S5.SS1.p6.5.m5.2.2.2.3.cmml"><mi id="S5.SS1.p6.5.m5.1.1.1.1" xref="S5.SS1.p6.5.m5.1.1.1.1.cmml">i</mi><mo id="S5.SS1.p6.5.m5.2.2.2.4.1" xref="S5.SS1.p6.5.m5.2.2.2.3.cmml">,</mo><mi id="S5.SS1.p6.5.m5.2.2.2.2" xref="S5.SS1.p6.5.m5.2.2.2.2.cmml">j</mi></mrow><mrow id="S5.SS1.p6.5.m5.3.3.1.3" xref="S5.SS1.p6.5.m5.3.4.cmml"><mo stretchy="false" id="S5.SS1.p6.5.m5.3.3.1.3.1" xref="S5.SS1.p6.5.m5.3.4.cmml">(</mo><mi id="S5.SS1.p6.5.m5.3.3.1.1" xref="S5.SS1.p6.5.m5.3.3.1.1.cmml">n</mi><mo stretchy="false" id="S5.SS1.p6.5.m5.3.3.1.3.2" xref="S5.SS1.p6.5.m5.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.5.m5.3b"><apply id="S5.SS1.p6.5.m5.3.4.cmml" xref="S5.SS1.p6.5.m5.3.4"><csymbol cd="ambiguous" id="S5.SS1.p6.5.m5.3.4.1.cmml" xref="S5.SS1.p6.5.m5.3.4">superscript</csymbol><apply id="S5.SS1.p6.5.m5.3.4.2.cmml" xref="S5.SS1.p6.5.m5.3.4"><csymbol cd="ambiguous" id="S5.SS1.p6.5.m5.3.4.2.1.cmml" xref="S5.SS1.p6.5.m5.3.4">subscript</csymbol><ci id="S5.SS1.p6.5.m5.3.4.2.2.cmml" xref="S5.SS1.p6.5.m5.3.4.2.2">𝑑</ci><list id="S5.SS1.p6.5.m5.2.2.2.3.cmml" xref="S5.SS1.p6.5.m5.2.2.2.4"><ci id="S5.SS1.p6.5.m5.1.1.1.1.cmml" xref="S5.SS1.p6.5.m5.1.1.1.1">𝑖</ci><ci id="S5.SS1.p6.5.m5.2.2.2.2.cmml" xref="S5.SS1.p6.5.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S5.SS1.p6.5.m5.3.3.1.1.cmml" xref="S5.SS1.p6.5.m5.3.3.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.5.m5.3c">d_{i,j}^{(n)}</annotation></semantics></math> as follows:</p>
</div>
<div id="S5.SS1.p7" class="ltx_para">
<table id="S5.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S5.E2.m1.9" class="ltx_Math" alttext="d_{i,j}^{(n)}=\frac{||w_{i}^{(n)}-w_{j}^{(n)}||_{F}}{\frac{1}{2}(||w_{i}^{(n)}||_{F}+||w_{j}^{(n)}||_{F})}" display="block"><semantics id="S5.E2.m1.9a"><mrow id="S5.E2.m1.9.10" xref="S5.E2.m1.9.10.cmml"><msubsup id="S5.E2.m1.9.10.2" xref="S5.E2.m1.9.10.2.cmml"><mi id="S5.E2.m1.9.10.2.2.2" xref="S5.E2.m1.9.10.2.2.2.cmml">d</mi><mrow id="S5.E2.m1.2.2.2.4" xref="S5.E2.m1.2.2.2.3.cmml"><mi id="S5.E2.m1.1.1.1.1" xref="S5.E2.m1.1.1.1.1.cmml">i</mi><mo id="S5.E2.m1.2.2.2.4.1" xref="S5.E2.m1.2.2.2.3.cmml">,</mo><mi id="S5.E2.m1.2.2.2.2" xref="S5.E2.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="S5.E2.m1.3.3.1.3" xref="S5.E2.m1.9.10.2.cmml"><mo stretchy="false" id="S5.E2.m1.3.3.1.3.1" xref="S5.E2.m1.9.10.2.cmml">(</mo><mi id="S5.E2.m1.3.3.1.1" xref="S5.E2.m1.3.3.1.1.cmml">n</mi><mo stretchy="false" id="S5.E2.m1.3.3.1.3.2" xref="S5.E2.m1.9.10.2.cmml">)</mo></mrow></msubsup><mo id="S5.E2.m1.9.10.1" xref="S5.E2.m1.9.10.1.cmml">=</mo><mfrac id="S5.E2.m1.9.9" xref="S5.E2.m1.9.9.cmml"><msub id="S5.E2.m1.6.6.3" xref="S5.E2.m1.6.6.3.cmml"><mrow id="S5.E2.m1.6.6.3.3.1" xref="S5.E2.m1.6.6.3.3.2.cmml"><mo stretchy="false" id="S5.E2.m1.6.6.3.3.1.2" xref="S5.E2.m1.6.6.3.3.2.1.cmml">‖</mo><mrow id="S5.E2.m1.6.6.3.3.1.1" xref="S5.E2.m1.6.6.3.3.1.1.cmml"><msubsup id="S5.E2.m1.6.6.3.3.1.1.2" xref="S5.E2.m1.6.6.3.3.1.1.2.cmml"><mi id="S5.E2.m1.6.6.3.3.1.1.2.2.2" xref="S5.E2.m1.6.6.3.3.1.1.2.2.2.cmml">w</mi><mi id="S5.E2.m1.6.6.3.3.1.1.2.2.3" xref="S5.E2.m1.6.6.3.3.1.1.2.2.3.cmml">i</mi><mrow id="S5.E2.m1.4.4.1.1.1.3" xref="S5.E2.m1.6.6.3.3.1.1.2.cmml"><mo stretchy="false" id="S5.E2.m1.4.4.1.1.1.3.1" xref="S5.E2.m1.6.6.3.3.1.1.2.cmml">(</mo><mi id="S5.E2.m1.4.4.1.1.1.1" xref="S5.E2.m1.4.4.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S5.E2.m1.4.4.1.1.1.3.2" xref="S5.E2.m1.6.6.3.3.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S5.E2.m1.6.6.3.3.1.1.1" xref="S5.E2.m1.6.6.3.3.1.1.1.cmml">−</mo><msubsup id="S5.E2.m1.6.6.3.3.1.1.3" xref="S5.E2.m1.6.6.3.3.1.1.3.cmml"><mi id="S5.E2.m1.6.6.3.3.1.1.3.2.2" xref="S5.E2.m1.6.6.3.3.1.1.3.2.2.cmml">w</mi><mi id="S5.E2.m1.6.6.3.3.1.1.3.2.3" xref="S5.E2.m1.6.6.3.3.1.1.3.2.3.cmml">j</mi><mrow id="S5.E2.m1.5.5.2.2.1.3" xref="S5.E2.m1.6.6.3.3.1.1.3.cmml"><mo stretchy="false" id="S5.E2.m1.5.5.2.2.1.3.1" xref="S5.E2.m1.6.6.3.3.1.1.3.cmml">(</mo><mi id="S5.E2.m1.5.5.2.2.1.1" xref="S5.E2.m1.5.5.2.2.1.1.cmml">n</mi><mo stretchy="false" id="S5.E2.m1.5.5.2.2.1.3.2" xref="S5.E2.m1.6.6.3.3.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S5.E2.m1.6.6.3.3.1.3" xref="S5.E2.m1.6.6.3.3.2.1.cmml">‖</mo></mrow><mi id="S5.E2.m1.6.6.3.5" xref="S5.E2.m1.6.6.3.5.cmml">F</mi></msub><mrow id="S5.E2.m1.9.9.6" xref="S5.E2.m1.9.9.6.cmml"><mfrac id="S5.E2.m1.9.9.6.5" xref="S5.E2.m1.9.9.6.5.cmml"><mn id="S5.E2.m1.9.9.6.5.2" xref="S5.E2.m1.9.9.6.5.2.cmml">1</mn><mn id="S5.E2.m1.9.9.6.5.3" xref="S5.E2.m1.9.9.6.5.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S5.E2.m1.9.9.6.4" xref="S5.E2.m1.9.9.6.4.cmml">​</mo><mrow id="S5.E2.m1.9.9.6.3.1" xref="S5.E2.m1.9.9.6.3.1.1.cmml"><mo stretchy="false" id="S5.E2.m1.9.9.6.3.1.2" xref="S5.E2.m1.9.9.6.3.1.1.cmml">(</mo><mrow id="S5.E2.m1.9.9.6.3.1.1" xref="S5.E2.m1.9.9.6.3.1.1.cmml"><msub id="S5.E2.m1.9.9.6.3.1.1.1" xref="S5.E2.m1.9.9.6.3.1.1.1.cmml"><mrow id="S5.E2.m1.9.9.6.3.1.1.1.1.1" xref="S5.E2.m1.9.9.6.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E2.m1.9.9.6.3.1.1.1.1.1.2" xref="S5.E2.m1.9.9.6.3.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.cmml"><mi id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.2" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.3" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S5.E2.m1.7.7.4.1.1.3" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E2.m1.7.7.4.1.1.3.1" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.cmml">(</mo><mi id="S5.E2.m1.7.7.4.1.1.1" xref="S5.E2.m1.7.7.4.1.1.1.cmml">n</mi><mo stretchy="false" id="S5.E2.m1.7.7.4.1.1.3.2" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S5.E2.m1.9.9.6.3.1.1.1.1.1.3" xref="S5.E2.m1.9.9.6.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S5.E2.m1.9.9.6.3.1.1.1.3" xref="S5.E2.m1.9.9.6.3.1.1.1.3.cmml">F</mi></msub><mo id="S5.E2.m1.9.9.6.3.1.1.3" xref="S5.E2.m1.9.9.6.3.1.1.3.cmml">+</mo><msub id="S5.E2.m1.9.9.6.3.1.1.2" xref="S5.E2.m1.9.9.6.3.1.1.2.cmml"><mrow id="S5.E2.m1.9.9.6.3.1.1.2.1.1" xref="S5.E2.m1.9.9.6.3.1.1.2.1.2.cmml"><mo stretchy="false" id="S5.E2.m1.9.9.6.3.1.1.2.1.1.2" xref="S5.E2.m1.9.9.6.3.1.1.2.1.2.1.cmml">‖</mo><msubsup id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.cmml"><mi id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.2" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.2.cmml">w</mi><mi id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.3" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.3.cmml">j</mi><mrow id="S5.E2.m1.8.8.5.2.1.3" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S5.E2.m1.8.8.5.2.1.3.1" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.cmml">(</mo><mi id="S5.E2.m1.8.8.5.2.1.1" xref="S5.E2.m1.8.8.5.2.1.1.cmml">n</mi><mo stretchy="false" id="S5.E2.m1.8.8.5.2.1.3.2" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S5.E2.m1.9.9.6.3.1.1.2.1.1.3" xref="S5.E2.m1.9.9.6.3.1.1.2.1.2.1.cmml">‖</mo></mrow><mi id="S5.E2.m1.9.9.6.3.1.1.2.3" xref="S5.E2.m1.9.9.6.3.1.1.2.3.cmml">F</mi></msub></mrow><mo stretchy="false" id="S5.E2.m1.9.9.6.3.1.3" xref="S5.E2.m1.9.9.6.3.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.E2.m1.9b"><apply id="S5.E2.m1.9.10.cmml" xref="S5.E2.m1.9.10"><eq id="S5.E2.m1.9.10.1.cmml" xref="S5.E2.m1.9.10.1"></eq><apply id="S5.E2.m1.9.10.2.cmml" xref="S5.E2.m1.9.10.2"><csymbol cd="ambiguous" id="S5.E2.m1.9.10.2.1.cmml" xref="S5.E2.m1.9.10.2">superscript</csymbol><apply id="S5.E2.m1.9.10.2.2.cmml" xref="S5.E2.m1.9.10.2"><csymbol cd="ambiguous" id="S5.E2.m1.9.10.2.2.1.cmml" xref="S5.E2.m1.9.10.2">subscript</csymbol><ci id="S5.E2.m1.9.10.2.2.2.cmml" xref="S5.E2.m1.9.10.2.2.2">𝑑</ci><list id="S5.E2.m1.2.2.2.3.cmml" xref="S5.E2.m1.2.2.2.4"><ci id="S5.E2.m1.1.1.1.1.cmml" xref="S5.E2.m1.1.1.1.1">𝑖</ci><ci id="S5.E2.m1.2.2.2.2.cmml" xref="S5.E2.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S5.E2.m1.3.3.1.1.cmml" xref="S5.E2.m1.3.3.1.1">𝑛</ci></apply><apply id="S5.E2.m1.9.9.cmml" xref="S5.E2.m1.9.9"><divide id="S5.E2.m1.9.9.7.cmml" xref="S5.E2.m1.9.9"></divide><apply id="S5.E2.m1.6.6.3.cmml" xref="S5.E2.m1.6.6.3"><csymbol cd="ambiguous" id="S5.E2.m1.6.6.3.4.cmml" xref="S5.E2.m1.6.6.3">subscript</csymbol><apply id="S5.E2.m1.6.6.3.3.2.cmml" xref="S5.E2.m1.6.6.3.3.1"><csymbol cd="latexml" id="S5.E2.m1.6.6.3.3.2.1.cmml" xref="S5.E2.m1.6.6.3.3.1.2">norm</csymbol><apply id="S5.E2.m1.6.6.3.3.1.1.cmml" xref="S5.E2.m1.6.6.3.3.1.1"><minus id="S5.E2.m1.6.6.3.3.1.1.1.cmml" xref="S5.E2.m1.6.6.3.3.1.1.1"></minus><apply id="S5.E2.m1.6.6.3.3.1.1.2.cmml" xref="S5.E2.m1.6.6.3.3.1.1.2"><csymbol cd="ambiguous" id="S5.E2.m1.6.6.3.3.1.1.2.1.cmml" xref="S5.E2.m1.6.6.3.3.1.1.2">superscript</csymbol><apply id="S5.E2.m1.6.6.3.3.1.1.2.2.cmml" xref="S5.E2.m1.6.6.3.3.1.1.2"><csymbol cd="ambiguous" id="S5.E2.m1.6.6.3.3.1.1.2.2.1.cmml" xref="S5.E2.m1.6.6.3.3.1.1.2">subscript</csymbol><ci id="S5.E2.m1.6.6.3.3.1.1.2.2.2.cmml" xref="S5.E2.m1.6.6.3.3.1.1.2.2.2">𝑤</ci><ci id="S5.E2.m1.6.6.3.3.1.1.2.2.3.cmml" xref="S5.E2.m1.6.6.3.3.1.1.2.2.3">𝑖</ci></apply><ci id="S5.E2.m1.4.4.1.1.1.1.cmml" xref="S5.E2.m1.4.4.1.1.1.1">𝑛</ci></apply><apply id="S5.E2.m1.6.6.3.3.1.1.3.cmml" xref="S5.E2.m1.6.6.3.3.1.1.3"><csymbol cd="ambiguous" id="S5.E2.m1.6.6.3.3.1.1.3.1.cmml" xref="S5.E2.m1.6.6.3.3.1.1.3">superscript</csymbol><apply id="S5.E2.m1.6.6.3.3.1.1.3.2.cmml" xref="S5.E2.m1.6.6.3.3.1.1.3"><csymbol cd="ambiguous" id="S5.E2.m1.6.6.3.3.1.1.3.2.1.cmml" xref="S5.E2.m1.6.6.3.3.1.1.3">subscript</csymbol><ci id="S5.E2.m1.6.6.3.3.1.1.3.2.2.cmml" xref="S5.E2.m1.6.6.3.3.1.1.3.2.2">𝑤</ci><ci id="S5.E2.m1.6.6.3.3.1.1.3.2.3.cmml" xref="S5.E2.m1.6.6.3.3.1.1.3.2.3">𝑗</ci></apply><ci id="S5.E2.m1.5.5.2.2.1.1.cmml" xref="S5.E2.m1.5.5.2.2.1.1">𝑛</ci></apply></apply></apply><ci id="S5.E2.m1.6.6.3.5.cmml" xref="S5.E2.m1.6.6.3.5">𝐹</ci></apply><apply id="S5.E2.m1.9.9.6.cmml" xref="S5.E2.m1.9.9.6"><times id="S5.E2.m1.9.9.6.4.cmml" xref="S5.E2.m1.9.9.6.4"></times><apply id="S5.E2.m1.9.9.6.5.cmml" xref="S5.E2.m1.9.9.6.5"><divide id="S5.E2.m1.9.9.6.5.1.cmml" xref="S5.E2.m1.9.9.6.5"></divide><cn type="integer" id="S5.E2.m1.9.9.6.5.2.cmml" xref="S5.E2.m1.9.9.6.5.2">1</cn><cn type="integer" id="S5.E2.m1.9.9.6.5.3.cmml" xref="S5.E2.m1.9.9.6.5.3">2</cn></apply><apply id="S5.E2.m1.9.9.6.3.1.1.cmml" xref="S5.E2.m1.9.9.6.3.1"><plus id="S5.E2.m1.9.9.6.3.1.1.3.cmml" xref="S5.E2.m1.9.9.6.3.1.1.3"></plus><apply id="S5.E2.m1.9.9.6.3.1.1.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.9.9.6.3.1.1.1.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1">subscript</csymbol><apply id="S5.E2.m1.9.9.6.3.1.1.1.1.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1"><csymbol cd="latexml" id="S5.E2.m1.9.9.6.3.1.1.1.1.2.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.2">norm</csymbol><apply id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1">superscript</csymbol><apply id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.3.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.E2.m1.7.7.4.1.1.1.cmml" xref="S5.E2.m1.7.7.4.1.1.1">𝑛</ci></apply></apply><ci id="S5.E2.m1.9.9.6.3.1.1.1.3.cmml" xref="S5.E2.m1.9.9.6.3.1.1.1.3">𝐹</ci></apply><apply id="S5.E2.m1.9.9.6.3.1.1.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2"><csymbol cd="ambiguous" id="S5.E2.m1.9.9.6.3.1.1.2.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2">subscript</csymbol><apply id="S5.E2.m1.9.9.6.3.1.1.2.1.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1"><csymbol cd="latexml" id="S5.E2.m1.9.9.6.3.1.1.2.1.2.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.2">norm</csymbol><apply id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1">superscript</csymbol><apply id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.1.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1">subscript</csymbol><ci id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.2.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.2">𝑤</ci><ci id="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.3.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.1.1.1.2.3">𝑗</ci></apply><ci id="S5.E2.m1.8.8.5.2.1.1.cmml" xref="S5.E2.m1.8.8.5.2.1.1">𝑛</ci></apply></apply><ci id="S5.E2.m1.9.9.6.3.1.1.2.3.cmml" xref="S5.E2.m1.9.9.6.3.1.1.2.3">𝐹</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E2.m1.9c">d_{i,j}^{(n)}=\frac{||w_{i}^{(n)}-w_{j}^{(n)}||_{F}}{\frac{1}{2}(||w_{i}^{(n)}||_{F}+||w_{j}^{(n)}||_{F})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S5.SS1.p8" class="ltx_para">
<p id="S5.SS1.p8.1" class="ltx_p">Equation <a href="#S5.E2" title="In 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents a modification regarding the divergence equation proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> in order to make it symmetric, In order to do so the norm of the differences is divided by the mean of the Frobenius norm of each weights.</p>
</div>
<div id="S5.SS1.p9" class="ltx_para">
<p id="S5.SS1.p9.1" class="ltx_p">Specifically, in order to calculate the norm of the weights corresponding to each grid, the corresponding norm of each layer has been calculated individually and then the norm of the resulting vector has been computed. The results obtained in each case for <math id="S5.SS1.p9.1.m1.3" class="ltx_Math" alttext="d_{i,j}^{(1)}" display="inline"><semantics id="S5.SS1.p9.1.m1.3a"><msubsup id="S5.SS1.p9.1.m1.3.4" xref="S5.SS1.p9.1.m1.3.4.cmml"><mi id="S5.SS1.p9.1.m1.3.4.2.2" xref="S5.SS1.p9.1.m1.3.4.2.2.cmml">d</mi><mrow id="S5.SS1.p9.1.m1.2.2.2.4" xref="S5.SS1.p9.1.m1.2.2.2.3.cmml"><mi id="S5.SS1.p9.1.m1.1.1.1.1" xref="S5.SS1.p9.1.m1.1.1.1.1.cmml">i</mi><mo id="S5.SS1.p9.1.m1.2.2.2.4.1" xref="S5.SS1.p9.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.SS1.p9.1.m1.2.2.2.2" xref="S5.SS1.p9.1.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="S5.SS1.p9.1.m1.3.3.1.3" xref="S5.SS1.p9.1.m1.3.4.cmml"><mo stretchy="false" id="S5.SS1.p9.1.m1.3.3.1.3.1" xref="S5.SS1.p9.1.m1.3.4.cmml">(</mo><mn id="S5.SS1.p9.1.m1.3.3.1.1" xref="S5.SS1.p9.1.m1.3.3.1.1.cmml">1</mn><mo stretchy="false" id="S5.SS1.p9.1.m1.3.3.1.3.2" xref="S5.SS1.p9.1.m1.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p9.1.m1.3b"><apply id="S5.SS1.p9.1.m1.3.4.cmml" xref="S5.SS1.p9.1.m1.3.4"><csymbol cd="ambiguous" id="S5.SS1.p9.1.m1.3.4.1.cmml" xref="S5.SS1.p9.1.m1.3.4">superscript</csymbol><apply id="S5.SS1.p9.1.m1.3.4.2.cmml" xref="S5.SS1.p9.1.m1.3.4"><csymbol cd="ambiguous" id="S5.SS1.p9.1.m1.3.4.2.1.cmml" xref="S5.SS1.p9.1.m1.3.4">subscript</csymbol><ci id="S5.SS1.p9.1.m1.3.4.2.2.cmml" xref="S5.SS1.p9.1.m1.3.4.2.2">𝑑</ci><list id="S5.SS1.p9.1.m1.2.2.2.3.cmml" xref="S5.SS1.p9.1.m1.2.2.2.4"><ci id="S5.SS1.p9.1.m1.1.1.1.1.cmml" xref="S5.SS1.p9.1.m1.1.1.1.1">𝑖</ci><ci id="S5.SS1.p9.1.m1.2.2.2.2.cmml" xref="S5.SS1.p9.1.m1.2.2.2.2">𝑗</ci></list></apply><cn type="integer" id="S5.SS1.p9.1.m1.3.3.1.1.cmml" xref="S5.SS1.p9.1.m1.3.3.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p9.1.m1.3c">d_{i,j}^{(1)}</annotation></semantics></math> are summarized in Table <a href="#S5.T8" title="Table 8 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure id="S5.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span><math id="S5.T8.2.m1.2" class="ltx_Math" alttext="d_{i,j}" display="inline"><semantics id="S5.T8.2.m1.2b"><msub id="S5.T8.2.m1.2.3" xref="S5.T8.2.m1.2.3.cmml"><mi id="S5.T8.2.m1.2.3.2" xref="S5.T8.2.m1.2.3.2.cmml">d</mi><mrow id="S5.T8.2.m1.2.2.2.4" xref="S5.T8.2.m1.2.2.2.3.cmml"><mi id="S5.T8.2.m1.1.1.1.1" xref="S5.T8.2.m1.1.1.1.1.cmml">i</mi><mo id="S5.T8.2.m1.2.2.2.4.1" xref="S5.T8.2.m1.2.2.2.3.cmml">,</mo><mi id="S5.T8.2.m1.2.2.2.2" xref="S5.T8.2.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T8.2.m1.2c"><apply id="S5.T8.2.m1.2.3.cmml" xref="S5.T8.2.m1.2.3"><csymbol cd="ambiguous" id="S5.T8.2.m1.2.3.1.cmml" xref="S5.T8.2.m1.2.3">subscript</csymbol><ci id="S5.T8.2.m1.2.3.2.cmml" xref="S5.T8.2.m1.2.3.2">𝑑</ci><list id="S5.T8.2.m1.2.2.2.3.cmml" xref="S5.T8.2.m1.2.2.2.4"><ci id="S5.T8.2.m1.1.1.1.1.cmml" xref="S5.T8.2.m1.1.1.1.1">𝑖</ci><ci id="S5.T8.2.m1.2.2.2.2.cmml" xref="S5.T8.2.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T8.2.m1.2d">d_{i,j}</annotation></semantics></math> calculated for each combination of zones.</figcaption>
<table id="S5.T8.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T8.3.1.1" class="ltx_tr">
<th id="S5.T8.3.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r"><span id="S5.T8.3.1.1.1.1" class="ltx_text ltx_font_italic">i,j</span></th>
<th id="S5.T8.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T8.3.1.1.2.1" class="ltx_text ltx_font_italic">1</span></th>
<th id="S5.T8.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T8.3.1.1.3.1" class="ltx_text ltx_font_italic">2</span></th>
<th id="S5.T8.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T8.3.1.1.4.1" class="ltx_text ltx_font_italic">3</span></th>
<th id="S5.T8.3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T8.3.1.1.5.1" class="ltx_text ltx_font_italic">4</span></th>
<th id="S5.T8.3.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T8.3.1.1.6.1" class="ltx_text ltx_font_italic">Central</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T8.3.2.1" class="ltx_tr">
<th id="S5.T8.3.2.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S5.T8.3.2.1.1.1" class="ltx_text ltx_font_italic">1</span></th>
<td id="S5.T8.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S5.T8.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.6563</td>
<td id="S5.T8.3.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.6310</td>
<td id="S5.T8.3.2.1.5" class="ltx_td ltx_align_center ltx_border_t">0.6413</td>
<td id="S5.T8.3.2.1.6" class="ltx_td ltx_align_center ltx_border_t">0.5729</td>
</tr>
<tr id="S5.T8.3.3.2" class="ltx_tr">
<th id="S5.T8.3.3.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r"><span id="S5.T8.3.3.2.1.1" class="ltx_text ltx_font_italic">2</span></th>
<td id="S5.T8.3.3.2.2" class="ltx_td ltx_align_center">0.6563</td>
<td id="S5.T8.3.3.2.3" class="ltx_td ltx_align_center">-</td>
<td id="S5.T8.3.3.2.4" class="ltx_td ltx_align_center">0.6275</td>
<td id="S5.T8.3.3.2.5" class="ltx_td ltx_align_center">0.6296</td>
<td id="S5.T8.3.3.2.6" class="ltx_td ltx_align_center">0.5850</td>
</tr>
<tr id="S5.T8.3.4.3" class="ltx_tr">
<th id="S5.T8.3.4.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r"><span id="S5.T8.3.4.3.1.1" class="ltx_text ltx_font_italic">3</span></th>
<td id="S5.T8.3.4.3.2" class="ltx_td ltx_align_center">0.6310</td>
<td id="S5.T8.3.4.3.3" class="ltx_td ltx_align_center">0.6275</td>
<td id="S5.T8.3.4.3.4" class="ltx_td ltx_align_center">-</td>
<td id="S5.T8.3.4.3.5" class="ltx_td ltx_align_center">0.6055</td>
<td id="S5.T8.3.4.3.6" class="ltx_td ltx_align_center">0.5677</td>
</tr>
<tr id="S5.T8.3.5.4" class="ltx_tr">
<th id="S5.T8.3.5.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r"><span id="S5.T8.3.5.4.1.1" class="ltx_text ltx_font_italic">4</span></th>
<td id="S5.T8.3.5.4.2" class="ltx_td ltx_align_center">0.6413</td>
<td id="S5.T8.3.5.4.3" class="ltx_td ltx_align_center">0.6296</td>
<td id="S5.T8.3.5.4.4" class="ltx_td ltx_align_center">0.6055</td>
<td id="S5.T8.3.5.4.5" class="ltx_td ltx_align_center">-</td>
<td id="S5.T8.3.5.4.6" class="ltx_td ltx_align_center">0.5743</td>
</tr>
<tr id="S5.T8.3.6.5" class="ltx_tr">
<th id="S5.T8.3.6.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r"><span id="S5.T8.3.6.5.1.1" class="ltx_text ltx_font_italic">Central</span></th>
<td id="S5.T8.3.6.5.2" class="ltx_td ltx_align_center">0.5729</td>
<td id="S5.T8.3.6.5.3" class="ltx_td ltx_align_center">0.5850</td>
<td id="S5.T8.3.6.5.4" class="ltx_td ltx_align_center">0.5677</td>
<td id="S5.T8.3.6.5.5" class="ltx_td ltx_align_center">0.5743</td>
<td id="S5.T8.3.6.5.6" class="ltx_td ltx_align_center">-</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p10" class="ltx_para">
<p id="S5.SS1.p10.2" class="ltx_p">In view of the values obtained for <math id="S5.SS1.p10.1.m1.2" class="ltx_Math" alttext="d_{i,central}" display="inline"><semantics id="S5.SS1.p10.1.m1.2a"><msub id="S5.SS1.p10.1.m1.2.3" xref="S5.SS1.p10.1.m1.2.3.cmml"><mi id="S5.SS1.p10.1.m1.2.3.2" xref="S5.SS1.p10.1.m1.2.3.2.cmml">d</mi><mrow id="S5.SS1.p10.1.m1.2.2.2.2" xref="S5.SS1.p10.1.m1.2.2.2.3.cmml"><mi id="S5.SS1.p10.1.m1.1.1.1.1" xref="S5.SS1.p10.1.m1.1.1.1.1.cmml">i</mi><mo id="S5.SS1.p10.1.m1.2.2.2.2.2" xref="S5.SS1.p10.1.m1.2.2.2.3.cmml">,</mo><mrow id="S5.SS1.p10.1.m1.2.2.2.2.1" xref="S5.SS1.p10.1.m1.2.2.2.2.1.cmml"><mi id="S5.SS1.p10.1.m1.2.2.2.2.1.2" xref="S5.SS1.p10.1.m1.2.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p10.1.m1.2.2.2.2.1.1" xref="S5.SS1.p10.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p10.1.m1.2.2.2.2.1.3" xref="S5.SS1.p10.1.m1.2.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p10.1.m1.2.2.2.2.1.1a" xref="S5.SS1.p10.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p10.1.m1.2.2.2.2.1.4" xref="S5.SS1.p10.1.m1.2.2.2.2.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p10.1.m1.2.2.2.2.1.1b" xref="S5.SS1.p10.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p10.1.m1.2.2.2.2.1.5" xref="S5.SS1.p10.1.m1.2.2.2.2.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p10.1.m1.2.2.2.2.1.1c" xref="S5.SS1.p10.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p10.1.m1.2.2.2.2.1.6" xref="S5.SS1.p10.1.m1.2.2.2.2.1.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p10.1.m1.2.2.2.2.1.1d" xref="S5.SS1.p10.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p10.1.m1.2.2.2.2.1.7" xref="S5.SS1.p10.1.m1.2.2.2.2.1.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p10.1.m1.2.2.2.2.1.1e" xref="S5.SS1.p10.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p10.1.m1.2.2.2.2.1.8" xref="S5.SS1.p10.1.m1.2.2.2.2.1.8.cmml">l</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p10.1.m1.2b"><apply id="S5.SS1.p10.1.m1.2.3.cmml" xref="S5.SS1.p10.1.m1.2.3"><csymbol cd="ambiguous" id="S5.SS1.p10.1.m1.2.3.1.cmml" xref="S5.SS1.p10.1.m1.2.3">subscript</csymbol><ci id="S5.SS1.p10.1.m1.2.3.2.cmml" xref="S5.SS1.p10.1.m1.2.3.2">𝑑</ci><list id="S5.SS1.p10.1.m1.2.2.2.3.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2"><ci id="S5.SS1.p10.1.m1.1.1.1.1.cmml" xref="S5.SS1.p10.1.m1.1.1.1.1">𝑖</ci><apply id="S5.SS1.p10.1.m1.2.2.2.2.1.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1"><times id="S5.SS1.p10.1.m1.2.2.2.2.1.1.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1.1"></times><ci id="S5.SS1.p10.1.m1.2.2.2.2.1.2.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1.2">𝑐</ci><ci id="S5.SS1.p10.1.m1.2.2.2.2.1.3.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1.3">𝑒</ci><ci id="S5.SS1.p10.1.m1.2.2.2.2.1.4.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1.4">𝑛</ci><ci id="S5.SS1.p10.1.m1.2.2.2.2.1.5.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1.5">𝑡</ci><ci id="S5.SS1.p10.1.m1.2.2.2.2.1.6.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1.6">𝑟</ci><ci id="S5.SS1.p10.1.m1.2.2.2.2.1.7.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1.7">𝑎</ci><ci id="S5.SS1.p10.1.m1.2.2.2.2.1.8.cmml" xref="S5.SS1.p10.1.m1.2.2.2.2.1.8">𝑙</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p10.1.m1.2c">d_{i,central}</annotation></semantics></math> <math id="S5.SS1.p10.2.m2.4" class="ltx_Math" alttext="\forall i\in\{1,2,3,4\}" display="inline"><semantics id="S5.SS1.p10.2.m2.4a"><mrow id="S5.SS1.p10.2.m2.4.5" xref="S5.SS1.p10.2.m2.4.5.cmml"><mrow id="S5.SS1.p10.2.m2.4.5.2" xref="S5.SS1.p10.2.m2.4.5.2.cmml"><mo rspace="0.167em" id="S5.SS1.p10.2.m2.4.5.2.1" xref="S5.SS1.p10.2.m2.4.5.2.1.cmml">∀</mo><mi id="S5.SS1.p10.2.m2.4.5.2.2" xref="S5.SS1.p10.2.m2.4.5.2.2.cmml">i</mi></mrow><mo id="S5.SS1.p10.2.m2.4.5.1" xref="S5.SS1.p10.2.m2.4.5.1.cmml">∈</mo><mrow id="S5.SS1.p10.2.m2.4.5.3.2" xref="S5.SS1.p10.2.m2.4.5.3.1.cmml"><mo stretchy="false" id="S5.SS1.p10.2.m2.4.5.3.2.1" xref="S5.SS1.p10.2.m2.4.5.3.1.cmml">{</mo><mn id="S5.SS1.p10.2.m2.1.1" xref="S5.SS1.p10.2.m2.1.1.cmml">1</mn><mo id="S5.SS1.p10.2.m2.4.5.3.2.2" xref="S5.SS1.p10.2.m2.4.5.3.1.cmml">,</mo><mn id="S5.SS1.p10.2.m2.2.2" xref="S5.SS1.p10.2.m2.2.2.cmml">2</mn><mo id="S5.SS1.p10.2.m2.4.5.3.2.3" xref="S5.SS1.p10.2.m2.4.5.3.1.cmml">,</mo><mn id="S5.SS1.p10.2.m2.3.3" xref="S5.SS1.p10.2.m2.3.3.cmml">3</mn><mo id="S5.SS1.p10.2.m2.4.5.3.2.4" xref="S5.SS1.p10.2.m2.4.5.3.1.cmml">,</mo><mn id="S5.SS1.p10.2.m2.4.4" xref="S5.SS1.p10.2.m2.4.4.cmml">4</mn><mo stretchy="false" id="S5.SS1.p10.2.m2.4.5.3.2.5" xref="S5.SS1.p10.2.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p10.2.m2.4b"><apply id="S5.SS1.p10.2.m2.4.5.cmml" xref="S5.SS1.p10.2.m2.4.5"><in id="S5.SS1.p10.2.m2.4.5.1.cmml" xref="S5.SS1.p10.2.m2.4.5.1"></in><apply id="S5.SS1.p10.2.m2.4.5.2.cmml" xref="S5.SS1.p10.2.m2.4.5.2"><csymbol cd="latexml" id="S5.SS1.p10.2.m2.4.5.2.1.cmml" xref="S5.SS1.p10.2.m2.4.5.2.1">for-all</csymbol><ci id="S5.SS1.p10.2.m2.4.5.2.2.cmml" xref="S5.SS1.p10.2.m2.4.5.2.2">𝑖</ci></apply><set id="S5.SS1.p10.2.m2.4.5.3.1.cmml" xref="S5.SS1.p10.2.m2.4.5.3.2"><cn type="integer" id="S5.SS1.p10.2.m2.1.1.cmml" xref="S5.SS1.p10.2.m2.1.1">1</cn><cn type="integer" id="S5.SS1.p10.2.m2.2.2.cmml" xref="S5.SS1.p10.2.m2.2.2">2</cn><cn type="integer" id="S5.SS1.p10.2.m2.3.3.cmml" xref="S5.SS1.p10.2.m2.3.3">3</cn><cn type="integer" id="S5.SS1.p10.2.m2.4.4.cmml" xref="S5.SS1.p10.2.m2.4.4">4</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p10.2.m2.4c">\forall i\in\{1,2,3,4\}</annotation></semantics></math>, the lowest value is obtained with respect to the third zone, which is consistent with this being the <span id="S5.SS1.p10.2.1" class="ltx_text ltx_font_italic">adapFL</span> model that gives the best results in the central zone in the test set regarding the MSE. However, the best test result is obtained with zone 4 (for MAE and 3 and 4 for the MSE), which is the second with the greatest divergence, and is also the model with the greatest error in the train (of the indexed ones). This high divergence in training is reflected in the MSE of the train, while allowing a better generalization in the test. Presumably, this is due to the rainfall levels in zone 4 during the period incorporated in the training, which will be similar to that of the central zone test (covering summer periods). It is evident that the divergence between the central zone and the other four areas represents the lowest values (last row of Table <a href="#S5.T8" title="Table 8 ‣ 5.1 Central area ‣ 5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>), since each of the 4 initial zones contains a quarter of the information of the central one. The table above provides information on the differences between the different zones, highlighting for example that the smallest divergence regarding the initial four areas is reached between zones 3 and 4, so it may be reasonable to create models agreed between these two areas, separately from the other two, making clients’ clusters. Finally, note that zone 1 presents the greater divergence with respect to the other three initial areas, so including this one may be damaging the performance of the overall FL model.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this work, we have analyzed the applicability of a novel PFL approach in comparison with a DL model trained individually on each set of data and with a classic FL architecture, for precipitation nowcasting based on radar images. However, it is important to discuss the limitations of the data used in this study as a benchmark to extrapolate the applicability of the <span id="S6.p1.1.1" class="ltx_text ltx_font_italic">adapFL</span> architecture to use cases with a sufficient number of available clients.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">The first limitation is that we have information captured by a single radar. However, the coverage area of this radar is so wide and representative that it allows us to carry out an artificial division in such a way that we distribute the captured images into different clients, each of them composed of different parts of the original images. It is important to note that in a real use case scenario in which we would have radars that capture images with different resolutions, it would be necessary to perform a careful preprocessing. In the same way, in this case, we have the advantage of all clients having images captured with the same type of radar. This is important to take into account because in a case where we have different radars, the sensitivity of these as well as their measurement parameters are determining factors when it comes to damage the accuracy of a jointly built deep learning model.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">Another particularity of the data used in this study is that the information contained in the images usually lies in the center of the initial full image. Therefore, dividing them in four quadrants to have four artificial clients results in a high divergence among them. In consequence, while the client with the data from the upper left quadrant of the original image will have more information in the lower right corner, this is reversed for the client with the images in the lower right quadrant. However, this is convenient in order to compare this case and use it as a benchmark to extrapolate to different scenarios with multiple radars, since in both cases such divergences will also be appreciated, being data captured in different regions or countries.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">In addition, as shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Data ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, many parts of the images do not contain relevant precipitation events, besides being data with a high seasonal component. This characteristic of the data would have added more complexity during model training and evaluation so the data have been pre-processed accordingly.</p>
</div>
<div id="S6.p5" class="ltx_para">
<p id="S6.p5.1" class="ltx_p">These limitations are important to understand the scope and constraints of our study. Nonetheless, in spite of the advantages and disadvantages of using a single client to simulate the presence of four clients to perform FL, the obtained results are robust enough to assess the viability of the novel PFL approach
<span id="S6.p5.1.1" class="ltx_text ltx_font_italic">adapFL</span>. As revealed by the skill score, this novel approach had a better performance in the four zones under study, in comparison with the IL approach and the classical FL one. To the best of our knowledge, it is the first time that the FL paradigm is applied to enhance the precipitation nowcasting using radar images and this contribution may be of interest to other researchers and practitioners that develop DL models for such purpose, including other convolutional ANN architectures and even with the addition of more input variables, as proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. This work has demonstrated that the use of FL and PFL techniques in regression tasks not only presents the inherent advantages of this methods, which are mentioned in the introduction, but also it is possible to reach better predictions in terms of error. Therefore, even in the case that no privacy issues affect the use of the radar images, the <span id="S6.p5.1.2" class="ltx_text ltx_font_italic">adapFL</span> approach is of particular interest.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusions</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">Our main objective towards this study was to analyze the feasibility of a novel PFL architecture, in particular the so-called <span id="S7.p1.1.1" class="ltx_text ltx_font_italic">adapFL</span> approach, to a use case of meteorological radar images. Specifically, the objective was to use the available images to predict the precipitation expressed as VIL in the next 5 minutes. The complexity of this task, involving the use of images, invites using DL models based on convolutional neural networks.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">In particular, to analyze the applicability of the PFL technique to this case, the results obtained in the four artificially distributed zones were compared with the COTREC method, as well as with the training of the same convolutional network on each of the zones individually and the training with a conventional FL architecture. Specifically, for the test set, we obtained improvements in all four cases when applying the <span id="S7.p2.1.1" class="ltx_text ltx_font_italic">adapFL</span> architecture both for the MSE and MAE. Moreover, when we extrapolated these results to the central zone, which has a part in each of the four initial ones, the optimal results for the training set regarding the MSE are also achieved with the application of the <span id="S7.p2.1.2" class="ltx_text ltx_font_italic">adapFL</span> architecture trained on all the four initial areas and adapted to the central one. Regarding only the individual models, in this case, the best results are achieved with the individual training on the fourth zone, which is in contrast with the results obtained for the divergence between the different artificial regions. This may be attributed to these regions having more in common in the test set than in the train, e.g. due to seasonality.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.1" class="ltx_p">The results obtained throughout this study give us a promising idea about the applicability of this PFL architecture to this type of meteorological radar images, since as mentioned, the results improve those of individual training in all the analyzed cases and that of the classic COTREC method. In this sense, future work has been drawn from the very approach of this benchmark study, and it is to extrapolate this type of analysis to radar data distributed in different countries or regions. In that case, the differential behavior of each zone may lead to the introduction of measures considering these divergences, like the creation of different clusters of clients. It should be noted that in this study one of the zones was very different regarding the data used for training from the others on average (see Figure <a href="#S4.F4" title="Figure 4 ‣ 4.2 Deep Learning and Federated Learning models ‣ 4 Methodology ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, zone 3), but the model was not degraded. Instead, this variability in the data distribution in the different clients in some cases may even lead to better generalization ability in the event of unseen data.

<br class="ltx_break"></p>
</div>
<div id="S7.p4" class="ltx_para">
<span id="S7.p4.1" class="ltx_ERROR undefined">\bmhead</span>
<p id="S7.p4.2" class="ltx_p">Acknowledgements</p>
</div>
<div id="S7.p5" class="ltx_para">
<p id="S7.p5.1" class="ltx_p">The authors acknowledge the funding and the support from the project AI4EOSC “Artificial Intelligence for the European Open Science Cloud” that has received funding from the European Union’s Horizon Europe research and innovation programme under grant agreement number 101058593.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Declarations</h2>

<div id="Sx1.p1" class="ltx_para">
<span id="Sx1.p1.1" class="ltx_ERROR undefined">\bmhead</span>
<p id="Sx1.p1.2" class="ltx_p">Funding</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">This work has been funded by the project AI4EOSC “Artificial Intelligence for the European Open Science Cloud” that has received funding from the European Union’s Horizon Europe research and innovation programme under grant agreement number 101058593.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<span id="Sx1.p3.1" class="ltx_ERROR undefined">\bmhead</span>
<p id="Sx1.p3.2" class="ltx_p">Declaration of Competing Interest</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<span id="Sx1.p5.1" class="ltx_ERROR undefined">\bmhead</span>
<p id="Sx1.p5.2" class="ltx_p">Author Contributions Statement</p>
</div>
<div id="Sx1.p6" class="ltx_para">
<p id="Sx1.p6.1" class="ltx_p">J.S-P.D. conducted the research, performed the experiments and the training of the models and wrote the main manuscript. M.C., J.B., I.H.C., K.A., L.B. and A.L.G. contributed to writing-reviewing the manuscript.
J.B., I.M.O. and I.M. acquired, processed, curated and stored the original data used in this study.
J.S-P.D., M.C., J.B., I.H.C., K.A., L.B, V.K. and A.L.G. participated in scientific discussions that led to this research.
V.K. and A.L.G. contributed to project management and funding acquisition.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Data distribution</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.2" class="ltx_p">As previously stated, the main objective of this work is to predict rainfall events (given by the VIL) 5 minutes in advance. The deep learning models used for this purpose include as input the three available images prior to the time of the prediction. In order to avoid over-training the models with non-rain events, we have eliminated those cases where the predictand (the three images previously available at the time of prediction), are empty (blank) images (no rain). Eliminating these data significantly reduces the amount of training data. This processing has been carried out individually on the train and test sets of each of the zones, as would be appropriate in cases where the data are distributed. Thus, Figure <a href="#A1.F8" title="Figure 8 ‣ Appendix A Data distribution ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows the accumulated VIL in each image to be predicted in the train in each of the zones, and in Figure <a href="#A1.F9" title="Figure 9 ‣ Appendix A Data distribution ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, the corresponding VIL in the test set in each case. To calculate the accumulated VIL displayed in the following images we have summed the VIL associated with each pixel of a given image and divided it by the surface of the image (<math id="A1.p1.1.m1.1" class="ltx_Math" alttext="50^{2}" display="inline"><semantics id="A1.p1.1.m1.1a"><msup id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mn id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">50</mn><mn id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2">50</cn><cn type="integer" id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">50^{2}</annotation></semantics></math> <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="km^{2}" display="inline"><semantics id="A1.p1.2.m2.1a"><mrow id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mi id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="A1.p1.2.m2.1.1.1" xref="A1.p1.2.m2.1.1.1.cmml">​</mo><msup id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml"><mi id="A1.p1.2.m2.1.1.3.2" xref="A1.p1.2.m2.1.1.3.2.cmml">m</mi><mn id="A1.p1.2.m2.1.1.3.3" xref="A1.p1.2.m2.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><times id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1"></times><ci id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2">𝑘</ci><apply id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.3.1.cmml" xref="A1.p1.2.m2.1.1.3">superscript</csymbol><ci id="A1.p1.2.m2.1.1.3.2.cmml" xref="A1.p1.2.m2.1.1.3.2">𝑚</ci><cn type="integer" id="A1.p1.2.m2.1.1.3.3.cmml" xref="A1.p1.2.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">km^{2}</annotation></semantics></math>).</p>
</div>
<figure id="A1.F8" class="ltx_figure"><img src="/html/2408.05761/assets/fig/distribution_train.png" id="A1.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="421" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Distribution of the VIL accumulated in the train data (y) in each zone after processing.</figcaption>
</figure>
<figure id="A1.F9" class="ltx_figure"><img src="/html/2408.05761/assets/fig/distribution_test.png" id="A1.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Distribution of the VIL accumulated in the test data (y) in each zone after processing.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span><span id="A2.1.1" class="ltx_text ltx_font_italic">AdapFL</span> architecture: MSE and MAE</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.6" class="ltx_p">In this section we aim to compare the different configurations of the proposed <span id="A2.p1.6.3" class="ltx_text ltx_font_italic">adapFL</span> architecture. Specifically, this configurations are given by <span id="A2.p1.2.2" class="ltx_text ltx_font_italic">(<math id="A2.p1.1.1.m1.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="A2.p1.1.1.m1.1a"><msub id="A2.p1.1.1.m1.1.1" xref="A2.p1.1.1.m1.1.1.cmml"><mi id="A2.p1.1.1.m1.1.1.2" xref="A2.p1.1.1.m1.1.1.2.cmml">N</mi><mi id="A2.p1.1.1.m1.1.1.3" xref="A2.p1.1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.1.1.m1.1b"><apply id="A2.p1.1.1.m1.1.1.cmml" xref="A2.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.1.1.m1.1.1.1.cmml" xref="A2.p1.1.1.m1.1.1">subscript</csymbol><ci id="A2.p1.1.1.m1.1.1.2.cmml" xref="A2.p1.1.1.m1.1.1.2">𝑁</ci><ci id="A2.p1.1.1.m1.1.1.3.cmml" xref="A2.p1.1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.1.m1.1c">N_{r}</annotation></semantics></math>, <math id="A2.p1.2.2.m2.1" class="ltx_Math" alttext="N_{e}^{(L)}" display="inline"><semantics id="A2.p1.2.2.m2.1a"><msubsup id="A2.p1.2.2.m2.1.2" xref="A2.p1.2.2.m2.1.2.cmml"><mi id="A2.p1.2.2.m2.1.2.2.2" xref="A2.p1.2.2.m2.1.2.2.2.cmml">N</mi><mi id="A2.p1.2.2.m2.1.2.2.3" xref="A2.p1.2.2.m2.1.2.2.3.cmml">e</mi><mrow id="A2.p1.2.2.m2.1.1.1.3" xref="A2.p1.2.2.m2.1.2.cmml"><mo stretchy="false" id="A2.p1.2.2.m2.1.1.1.3.1" xref="A2.p1.2.2.m2.1.2.cmml">(</mo><mi id="A2.p1.2.2.m2.1.1.1.1" xref="A2.p1.2.2.m2.1.1.1.1.cmml">L</mi><mo stretchy="false" id="A2.p1.2.2.m2.1.1.1.3.2" xref="A2.p1.2.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A2.p1.2.2.m2.1b"><apply id="A2.p1.2.2.m2.1.2.cmml" xref="A2.p1.2.2.m2.1.2"><csymbol cd="ambiguous" id="A2.p1.2.2.m2.1.2.1.cmml" xref="A2.p1.2.2.m2.1.2">superscript</csymbol><apply id="A2.p1.2.2.m2.1.2.2.cmml" xref="A2.p1.2.2.m2.1.2"><csymbol cd="ambiguous" id="A2.p1.2.2.m2.1.2.2.1.cmml" xref="A2.p1.2.2.m2.1.2">subscript</csymbol><ci id="A2.p1.2.2.m2.1.2.2.2.cmml" xref="A2.p1.2.2.m2.1.2.2.2">𝑁</ci><ci id="A2.p1.2.2.m2.1.2.2.3.cmml" xref="A2.p1.2.2.m2.1.2.2.3">𝑒</ci></apply><ci id="A2.p1.2.2.m2.1.1.1.1.cmml" xref="A2.p1.2.2.m2.1.1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.2.m2.1c">N_{e}^{(L)}</annotation></semantics></math>)</span>, <math id="A2.p1.3.m1.3" class="ltx_Math" alttext="\forall N_{r}\in\{1,\ldots,10\}" display="inline"><semantics id="A2.p1.3.m1.3a"><mrow id="A2.p1.3.m1.3.4" xref="A2.p1.3.m1.3.4.cmml"><mrow id="A2.p1.3.m1.3.4.2" xref="A2.p1.3.m1.3.4.2.cmml"><mo rspace="0.167em" id="A2.p1.3.m1.3.4.2.1" xref="A2.p1.3.m1.3.4.2.1.cmml">∀</mo><msub id="A2.p1.3.m1.3.4.2.2" xref="A2.p1.3.m1.3.4.2.2.cmml"><mi id="A2.p1.3.m1.3.4.2.2.2" xref="A2.p1.3.m1.3.4.2.2.2.cmml">N</mi><mi id="A2.p1.3.m1.3.4.2.2.3" xref="A2.p1.3.m1.3.4.2.2.3.cmml">r</mi></msub></mrow><mo id="A2.p1.3.m1.3.4.1" xref="A2.p1.3.m1.3.4.1.cmml">∈</mo><mrow id="A2.p1.3.m1.3.4.3.2" xref="A2.p1.3.m1.3.4.3.1.cmml"><mo stretchy="false" id="A2.p1.3.m1.3.4.3.2.1" xref="A2.p1.3.m1.3.4.3.1.cmml">{</mo><mn id="A2.p1.3.m1.1.1" xref="A2.p1.3.m1.1.1.cmml">1</mn><mo id="A2.p1.3.m1.3.4.3.2.2" xref="A2.p1.3.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="A2.p1.3.m1.2.2" xref="A2.p1.3.m1.2.2.cmml">…</mi><mo id="A2.p1.3.m1.3.4.3.2.3" xref="A2.p1.3.m1.3.4.3.1.cmml">,</mo><mn id="A2.p1.3.m1.3.3" xref="A2.p1.3.m1.3.3.cmml">10</mn><mo stretchy="false" id="A2.p1.3.m1.3.4.3.2.4" xref="A2.p1.3.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m1.3b"><apply id="A2.p1.3.m1.3.4.cmml" xref="A2.p1.3.m1.3.4"><in id="A2.p1.3.m1.3.4.1.cmml" xref="A2.p1.3.m1.3.4.1"></in><apply id="A2.p1.3.m1.3.4.2.cmml" xref="A2.p1.3.m1.3.4.2"><csymbol cd="latexml" id="A2.p1.3.m1.3.4.2.1.cmml" xref="A2.p1.3.m1.3.4.2.1">for-all</csymbol><apply id="A2.p1.3.m1.3.4.2.2.cmml" xref="A2.p1.3.m1.3.4.2.2"><csymbol cd="ambiguous" id="A2.p1.3.m1.3.4.2.2.1.cmml" xref="A2.p1.3.m1.3.4.2.2">subscript</csymbol><ci id="A2.p1.3.m1.3.4.2.2.2.cmml" xref="A2.p1.3.m1.3.4.2.2.2">𝑁</ci><ci id="A2.p1.3.m1.3.4.2.2.3.cmml" xref="A2.p1.3.m1.3.4.2.2.3">𝑟</ci></apply></apply><set id="A2.p1.3.m1.3.4.3.1.cmml" xref="A2.p1.3.m1.3.4.3.2"><cn type="integer" id="A2.p1.3.m1.1.1.cmml" xref="A2.p1.3.m1.1.1">1</cn><ci id="A2.p1.3.m1.2.2.cmml" xref="A2.p1.3.m1.2.2">…</ci><cn type="integer" id="A2.p1.3.m1.3.3.cmml" xref="A2.p1.3.m1.3.3">10</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m1.3c">\forall N_{r}\in\{1,\ldots,10\}</annotation></semantics></math>, and <math id="A2.p1.4.m2.2" class="ltx_Math" alttext="N_{e}^{(L)}=100-(10\cdot N_{r})" display="inline"><semantics id="A2.p1.4.m2.2a"><mrow id="A2.p1.4.m2.2.2" xref="A2.p1.4.m2.2.2.cmml"><msubsup id="A2.p1.4.m2.2.2.3" xref="A2.p1.4.m2.2.2.3.cmml"><mi id="A2.p1.4.m2.2.2.3.2.2" xref="A2.p1.4.m2.2.2.3.2.2.cmml">N</mi><mi id="A2.p1.4.m2.2.2.3.2.3" xref="A2.p1.4.m2.2.2.3.2.3.cmml">e</mi><mrow id="A2.p1.4.m2.1.1.1.3" xref="A2.p1.4.m2.2.2.3.cmml"><mo stretchy="false" id="A2.p1.4.m2.1.1.1.3.1" xref="A2.p1.4.m2.2.2.3.cmml">(</mo><mi id="A2.p1.4.m2.1.1.1.1" xref="A2.p1.4.m2.1.1.1.1.cmml">L</mi><mo stretchy="false" id="A2.p1.4.m2.1.1.1.3.2" xref="A2.p1.4.m2.2.2.3.cmml">)</mo></mrow></msubsup><mo id="A2.p1.4.m2.2.2.2" xref="A2.p1.4.m2.2.2.2.cmml">=</mo><mrow id="A2.p1.4.m2.2.2.1" xref="A2.p1.4.m2.2.2.1.cmml"><mn id="A2.p1.4.m2.2.2.1.3" xref="A2.p1.4.m2.2.2.1.3.cmml">100</mn><mo id="A2.p1.4.m2.2.2.1.2" xref="A2.p1.4.m2.2.2.1.2.cmml">−</mo><mrow id="A2.p1.4.m2.2.2.1.1.1" xref="A2.p1.4.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A2.p1.4.m2.2.2.1.1.1.2" xref="A2.p1.4.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="A2.p1.4.m2.2.2.1.1.1.1" xref="A2.p1.4.m2.2.2.1.1.1.1.cmml"><mn id="A2.p1.4.m2.2.2.1.1.1.1.2" xref="A2.p1.4.m2.2.2.1.1.1.1.2.cmml">10</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p1.4.m2.2.2.1.1.1.1.1" xref="A2.p1.4.m2.2.2.1.1.1.1.1.cmml">⋅</mo><msub id="A2.p1.4.m2.2.2.1.1.1.1.3" xref="A2.p1.4.m2.2.2.1.1.1.1.3.cmml"><mi id="A2.p1.4.m2.2.2.1.1.1.1.3.2" xref="A2.p1.4.m2.2.2.1.1.1.1.3.2.cmml">N</mi><mi id="A2.p1.4.m2.2.2.1.1.1.1.3.3" xref="A2.p1.4.m2.2.2.1.1.1.1.3.3.cmml">r</mi></msub></mrow><mo stretchy="false" id="A2.p1.4.m2.2.2.1.1.1.3" xref="A2.p1.4.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m2.2b"><apply id="A2.p1.4.m2.2.2.cmml" xref="A2.p1.4.m2.2.2"><eq id="A2.p1.4.m2.2.2.2.cmml" xref="A2.p1.4.m2.2.2.2"></eq><apply id="A2.p1.4.m2.2.2.3.cmml" xref="A2.p1.4.m2.2.2.3"><csymbol cd="ambiguous" id="A2.p1.4.m2.2.2.3.1.cmml" xref="A2.p1.4.m2.2.2.3">superscript</csymbol><apply id="A2.p1.4.m2.2.2.3.2.cmml" xref="A2.p1.4.m2.2.2.3"><csymbol cd="ambiguous" id="A2.p1.4.m2.2.2.3.2.1.cmml" xref="A2.p1.4.m2.2.2.3">subscript</csymbol><ci id="A2.p1.4.m2.2.2.3.2.2.cmml" xref="A2.p1.4.m2.2.2.3.2.2">𝑁</ci><ci id="A2.p1.4.m2.2.2.3.2.3.cmml" xref="A2.p1.4.m2.2.2.3.2.3">𝑒</ci></apply><ci id="A2.p1.4.m2.1.1.1.1.cmml" xref="A2.p1.4.m2.1.1.1.1">𝐿</ci></apply><apply id="A2.p1.4.m2.2.2.1.cmml" xref="A2.p1.4.m2.2.2.1"><minus id="A2.p1.4.m2.2.2.1.2.cmml" xref="A2.p1.4.m2.2.2.1.2"></minus><cn type="integer" id="A2.p1.4.m2.2.2.1.3.cmml" xref="A2.p1.4.m2.2.2.1.3">100</cn><apply id="A2.p1.4.m2.2.2.1.1.1.1.cmml" xref="A2.p1.4.m2.2.2.1.1.1"><ci id="A2.p1.4.m2.2.2.1.1.1.1.1.cmml" xref="A2.p1.4.m2.2.2.1.1.1.1.1">⋅</ci><cn type="integer" id="A2.p1.4.m2.2.2.1.1.1.1.2.cmml" xref="A2.p1.4.m2.2.2.1.1.1.1.2">10</cn><apply id="A2.p1.4.m2.2.2.1.1.1.1.3.cmml" xref="A2.p1.4.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.p1.4.m2.2.2.1.1.1.1.3.1.cmml" xref="A2.p1.4.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="A2.p1.4.m2.2.2.1.1.1.1.3.2.cmml" xref="A2.p1.4.m2.2.2.1.1.1.1.3.2">𝑁</ci><ci id="A2.p1.4.m2.2.2.1.1.1.1.3.3.cmml" xref="A2.p1.4.m2.2.2.1.1.1.1.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m2.2c">N_{e}^{(L)}=100-(10\cdot N_{r})</annotation></semantics></math>, as explained in Section <a href="#S5" title="5 Results and analysis ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Figures <a href="#A2.F10" title="Figure 10 ‣ Appendix B AdapFL architecture: MSE and MAE ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> and <a href="#A2.F11" title="Figure 11 ‣ Appendix B AdapFL architecture: MSE and MAE ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> show the MSE and the MAE for the test set of each zone with each proposed configuration of the <span id="A2.p1.6.4" class="ltx_text ltx_font_italic">adapFL</span> approach. Note than in the case in which <math id="A2.p1.5.m3.1" class="ltx_Math" alttext="N_{r}=0" display="inline"><semantics id="A2.p1.5.m3.1a"><mrow id="A2.p1.5.m3.1.1" xref="A2.p1.5.m3.1.1.cmml"><msub id="A2.p1.5.m3.1.1.2" xref="A2.p1.5.m3.1.1.2.cmml"><mi id="A2.p1.5.m3.1.1.2.2" xref="A2.p1.5.m3.1.1.2.2.cmml">N</mi><mi id="A2.p1.5.m3.1.1.2.3" xref="A2.p1.5.m3.1.1.2.3.cmml">r</mi></msub><mo id="A2.p1.5.m3.1.1.1" xref="A2.p1.5.m3.1.1.1.cmml">=</mo><mn id="A2.p1.5.m3.1.1.3" xref="A2.p1.5.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.5.m3.1b"><apply id="A2.p1.5.m3.1.1.cmml" xref="A2.p1.5.m3.1.1"><eq id="A2.p1.5.m3.1.1.1.cmml" xref="A2.p1.5.m3.1.1.1"></eq><apply id="A2.p1.5.m3.1.1.2.cmml" xref="A2.p1.5.m3.1.1.2"><csymbol cd="ambiguous" id="A2.p1.5.m3.1.1.2.1.cmml" xref="A2.p1.5.m3.1.1.2">subscript</csymbol><ci id="A2.p1.5.m3.1.1.2.2.cmml" xref="A2.p1.5.m3.1.1.2.2">𝑁</ci><ci id="A2.p1.5.m3.1.1.2.3.cmml" xref="A2.p1.5.m3.1.1.2.3">𝑟</ci></apply><cn type="integer" id="A2.p1.5.m3.1.1.3.cmml" xref="A2.p1.5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.5.m3.1c">N_{r}=0</annotation></semantics></math>, we are displaying the results for the individual approach (IL), and when <math id="A2.p1.6.m4.1" class="ltx_Math" alttext="N_{r}=10" display="inline"><semantics id="A2.p1.6.m4.1a"><mrow id="A2.p1.6.m4.1.1" xref="A2.p1.6.m4.1.1.cmml"><msub id="A2.p1.6.m4.1.1.2" xref="A2.p1.6.m4.1.1.2.cmml"><mi id="A2.p1.6.m4.1.1.2.2" xref="A2.p1.6.m4.1.1.2.2.cmml">N</mi><mi id="A2.p1.6.m4.1.1.2.3" xref="A2.p1.6.m4.1.1.2.3.cmml">r</mi></msub><mo id="A2.p1.6.m4.1.1.1" xref="A2.p1.6.m4.1.1.1.cmml">=</mo><mn id="A2.p1.6.m4.1.1.3" xref="A2.p1.6.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.6.m4.1b"><apply id="A2.p1.6.m4.1.1.cmml" xref="A2.p1.6.m4.1.1"><eq id="A2.p1.6.m4.1.1.1.cmml" xref="A2.p1.6.m4.1.1.1"></eq><apply id="A2.p1.6.m4.1.1.2.cmml" xref="A2.p1.6.m4.1.1.2"><csymbol cd="ambiguous" id="A2.p1.6.m4.1.1.2.1.cmml" xref="A2.p1.6.m4.1.1.2">subscript</csymbol><ci id="A2.p1.6.m4.1.1.2.2.cmml" xref="A2.p1.6.m4.1.1.2.2">𝑁</ci><ci id="A2.p1.6.m4.1.1.2.3.cmml" xref="A2.p1.6.m4.1.1.2.3">𝑟</ci></apply><cn type="integer" id="A2.p1.6.m4.1.1.3.cmml" xref="A2.p1.6.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.6.m4.1c">N_{r}=10</annotation></semantics></math>, those of the classic FL approach.</p>
</div>
<figure id="A2.F10" class="ltx_figure"><img src="/html/2408.05761/assets/fig/mse_test_adapfl_il_fl.png" id="A2.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="282" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>MSE for the test set of each zone under different <span id="A2.F10.2.1" class="ltx_text ltx_font_italic">adapFL</span> configurations, including IL and FL.</figcaption>
</figure>
<figure id="A2.F11" class="ltx_figure"><img src="/html/2408.05761/assets/fig/mae_test_adapfl_il_fl.png" id="A2.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="449" height="280" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>MAE for the test set of each zone under different <span id="A2.F11.2.1" class="ltx_text ltx_font_italic">adapFL</span> configurations, including IL and FL.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Example of predictions obtained for each area</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">Figures <a href="#A3.F12" title="Figure 12 ‣ Appendix C Example of predictions obtained for each area ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> and <a href="#A3.F13" title="Figure 13 ‣ Appendix C Example of predictions obtained for each area ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> show, for each of the four initial artificially distributed zones, six images together with the corresponding predictions obtained with the <span id="A3.p1.1.1" class="ltx_text ltx_font_italic">adapFL</span> approach implemented.</p>
</div>
<figure id="A3.F12" class="ltx_figure"><img src="/html/2408.05761/assets/fig/adapfl_pred.png" id="A3.F12.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="407" height="680" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Example of predictions obtained with the adaptive federated learning approach in each of the four zones (1/2).</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="A3.F13" class="ltx_figure"><img src="/html/2408.05761/assets/fig/adapfl_pred_2.png" id="A3.F13.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="407" height="680" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Example of predictions obtained with the adaptive federated learning approach in each of the four zones (2/2).</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>MAE and MSE obtained in each image from the test set</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">In order to check the robustness of the proposed PFL method, <span id="A4.p1.1.1" class="ltx_text ltx_font_italic">adapFL</span>, in this section we show an histogram for the MSE and MAE of each area for each image. We can note that in the vast majority of the images both the MSE and the MAE are near to zero.</p>
</div>
<figure id="A4.F14" class="ltx_figure"><img src="/html/2408.05761/assets/fig/mae_adapfl.png" id="A4.F14.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="422" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Histogram with the MAE obtained for the images of the test set using the <span id="A4.F14.2.1" class="ltx_text ltx_font_italic">adapFL</span> method.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="A4.F15" class="ltx_figure"><img src="/html/2408.05761/assets/fig/mse_adapfl.png" id="A4.F15.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="418" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Histogram with the MSE obtained for the images of the test set using the <span id="A4.F15.2.1" class="ltx_text ltx_font_italic">adapFL</span> method.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Diagram of the neural network implemented</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">The schema of the neural network implemented in this study is shown in Figures <a href="#A5.F16" title="Figure 16 ‣ Appendix E Diagram of the neural network implemented ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a> and <a href="#A5.F17" title="Figure 17 ‣ Appendix E Diagram of the neural network implemented ‣ Personalized Federated Learning for improving radar based precipitation nowcasting on heterogeneous areas" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a>.</p>
</div>
<figure id="A5.F16" class="ltx_figure"><img src="/html/2408.05761/assets/fig/ann1.png" id="A5.F16.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="84" height="676" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Convolutional neural network implemented (1/2).</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="A5.F17" class="ltx_figure"><img src="/html/2408.05761/assets/fig/ann2.png" id="A5.F17.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="84" height="798" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Convolutional neural network implemented (2/2).</figcaption>
</figure>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.1.1" class="ltx_bibitem">
<span class="ltx_bibblock"><span id="bib.1.1.1.1" class="ltx_ERROR undefined">\bibcommenthead</span>
</span>
</li>
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abadi et al [2015]</span>
<span class="ltx_bibblock">
Abadi M, Agarwal A, Barham P, et al (2015) TensorFlow: Large-scale machine learning on heterogeneous systems. URL <a target="_blank" href="https://www.tensorflow.org/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.tensorflow.org/</a>, software available from tensorflow.org

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al [2019]</span>
<span class="ltx_bibblock">
Agrawal S, Barrington L, Bromberg C, et al (2019) Machine learning for precipitation nowcasting from radar images. <a href="1912.12132" title="" class="ltx_ref ltx_url ltx_font_typewriter">1912.12132</a>

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al [2022]</span>
<span class="ltx_bibblock">
Agrawal S, Sarkar S, Aouedi O, et al (2022) Federated learning for intrusion detection system: Concepts, challenges and future directions. Computer Communications 195:346–361. <a target="_blank" href="https:/doi.org/https://doi.org/10.1016/j.comcom.2022.09.012" title="" class="ltx_ref">https://doi.org/10.1016/j.comcom.2022.09.012</a>, URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0140366422003516" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0140366422003516</a>

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AI4EOSC project [2024]</span>
<span class="ltx_bibblock">
AI4EOSC project (2024) AI4EOSC website. URL <a target="_blank" href="https://ai4eosc.eu/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ai4eosc.eu/</a>, [Accessed 19-02-2024]

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al [2020]</span>
<span class="ltx_bibblock">
Chen L, Cao Y, Ma L, et al (2020) A deep learning-based methodology for precipitation nowcasting with radar. Earth and Space Science 7(2):e2019EA000812

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cuomo and Chandrasekar [2021]</span>
<span class="ltx_bibblock">
Cuomo J, Chandrasekar V (2021) Use of deep learning for weather radar nowcasting. Journal of Atmospheric and Oceanic Technology 38(9):1641–1656

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan and Ling [2018]</span>
<span class="ltx_bibblock">
Fan H, Ling H (2018) Siamese cascaded region proposal networks for real-time visual tracking. <a href="1812.06148" title="" class="ltx_ref ltx_url ltx_font_typewriter">1812.06148</a>

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al [2014]</span>
<span class="ltx_bibblock">
Goodfellow I, Pouget-Abadie J, Mirza M, et al (2014) Generative adversarial nets. In: Ghahramani Z, Welling M, Cortes C, et al (eds) Advances in Neural Information Processing Systems, vol 27. Curran Associates, Inc., URL <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2014/file/5ca3e9b122f61f8f06494c97b1afccf3-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2014/file/5ca3e9b122f61f8f06494c97b1afccf3-Paper.pdf</a>

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al [2018]</span>
<span class="ltx_bibblock">
Gu J, Wang Z, Kuen J, et al (2018) Recent advances in convolutional neural networks. Pattern Recognition 77:354–377. <a target="_blank" href="https:/doi.org/10.1016/j.patcog.2017.10.013" title="" class="ltx_ref">10.1016/j.patcog.2017.10.013</a>

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al [2023]</span>
<span class="ltx_bibblock">
Han D, Shin Y, Im J, et al (2023) Key factors for quantitative precipitation nowcasting using ground weather radar data based on deep learning. Geoscientific Model Development Discussions 2023:1–43

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al [2022]</span>
<span class="ltx_bibblock">
Han L, Zhao Y, Chen H, et al (2022) Advancing radar nowcasting through deep transfer learning. IEEE Transactions on Geoscience and Remote Sensing 60:1–9. <a target="_blank" href="https:/doi.org/10.1109/TGRS.2021.3056470" title="" class="ltx_ref">10.1109/TGRS.2021.3056470</a>

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanel and Buishand [2010]</span>
<span class="ltx_bibblock">
Hanel M, Buishand TA (2010) On the value of hourly precipitation extremes in regional climate model simulations. Journal of Hydrology 393(3):265–273. <a target="_blank" href="https:/doi.org/10.1016/j.jhydrol.2010.08.024" title="" class="ltx_ref">10.1016/j.jhydrol.2010.08.024</a>

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hosseinzadehtalaei et al [2020]</span>
<span class="ltx_bibblock">
Hosseinzadehtalaei P, Tabari H, Willems P (2020) Climate change impact on short-duration extreme precipitation and intensity–duration–frequency curves over europe. Journal of Hydrology 590:125249. <a target="_blank" href="https:/doi.org/10.1016/j.jhydrol.2020.125249" title="" class="ltx_ref">10.1016/j.jhydrol.2020.125249</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jolliffe and Stephenson [2012]</span>
<span class="ltx_bibblock">
Jolliffe IT, Stephenson DB (2012) Forecast verification: a practitioner’s guide in atmospheric science. John Wiley &amp; Sons

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kesa et al [2022]</span>
<span class="ltx_bibblock">
Kesa O, Styles O, Sanchez V (2022) Multiple object tracking and forecasting: Jointly predicting current and future object locations. In: 2022 IEEE/CVF Winter Conference on Applications of Computer Vision Workshops (WACVW), pp 560–569, <a target="_blank" href="https:/doi.org/10.1109/WACVW54805.2022.00062" title="" class="ltx_ref">10.1109/WACVW54805.2022.00062</a>

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al [2005]</span>
<span class="ltx_bibblock">
Kim J, Fisher JW, Yezzi A, et al (2005) A nonparametric statistical method for image segmentation using information theory and curve evolution. IEEE Transactions on Image Processing 14(10):1486–1502. <a target="_blank" href="https:/doi.org/10.1109/TIP.2005.854442" title="" class="ltx_ref">10.1109/TIP.2005.854442</a>

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba [2014]</span>
<span class="ltx_bibblock">
Kingma DP, Ba J (2014) Adam: A method for stochastic optimization. arXiv preprint arXiv:14126980

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ko et al [2022]</span>
<span class="ltx_bibblock">
Ko J, Lee K, Hwang H, et al (2022) Effective training strategies for deep-learning-based precipitation nowcasting and estimation. Computers &amp; Geosciences 161:105072. <a target="_blank" href="https:/doi.org/https://doi.org/10.1016/j.cageo.2022.105072" title="" class="ltx_ref">https://doi.org/10.1016/j.cageo.2022.105072</a>, URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S009830042200036X" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S009830042200036X</a>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Komjáti et al [2022]</span>
<span class="ltx_bibblock">
Komjáti K, Varga ÁJ, Méri L, et al (2022) Investigation of a supercell merger leading to the ef4 tornado in the czech republic on june 24, 2021 using radar data and numerical model outputs. Idöjárás 126(4)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Korosec [2021]</span>
<span class="ltx_bibblock">
Korosec M (2021) The most powerful tornado on record hit the czech republic, leaving several fatalities and 200+ injured across the hodonin district. Weather Report URL <a target="_blank" href="https://www.severe-weather.eu/weather-report/europe-severe-weather-tornado-hodonin-czech-republic-mk/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.severe-weather.eu/weather-report/europe-severe-weather-tornado-hodonin-czech-republic-mk/</a>, published: 25/06/2021

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al [2024]</span>
<span class="ltx_bibblock">
Kumar B, Haral H, Kalapureddy M, et al (2024) Utilizing deep learning for near real-time rainfall forecasting based on radar data. Physics and Chemistry of the Earth, Parts A/B/C 135:103600. <a target="_blank" href="https:/doi.org/https://doi.org/10.1016/j.pce.2024.103600" title="" class="ltx_ref">https://doi.org/10.1016/j.pce.2024.103600</a>, URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S1474706524000585" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S1474706524000585</a>

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al [2018]</span>
<span class="ltx_bibblock">
Li B, Wu W, Wang Q, et al (2018) Siamrpn++: Evolution of siamese visual tracking with very deep networks. <a href="1812.11703" title="" class="ltx_ref ltx_url ltx_font_typewriter">1812.11703</a>

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al [2017]</span>
<span class="ltx_bibblock">
McMahan B, Moore E, Ramage D, et al (2017) Communication-Efficient Learning of Deep Networks from Decentralized Data. In: Singh A, Zhu J (eds) Proceedings of the 20th International Conference on Artificial Intelligence and Statistics, Proceedings of Machine Learning Research, vol 54. PMLR, pp 1273–1282, URL <a target="_blank" href="https://proceedings.mlr.press/v54/mcmahan17a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v54/mcmahan17a.html</a>

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Niknam et al [2020]</span>
<span class="ltx_bibblock">
Niknam S, Dhillon HS, Reed JH (2020) Federated learning for wireless communications: Motivation, opportunities, and challenges. IEEE Communications Magazine 58(6):46–51. <a target="_blank" href="https:/doi.org/10.1109/MCOM.001.1900461" title="" class="ltx_ref">10.1109/MCOM.001.1900461</a>

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Novak [2007]</span>
<span class="ltx_bibblock">
Novak P (2007) The czech hydrometeorological institute’s severe storm nowcasting system. Atmospheric Research 83(2):450–457. <a target="_blank" href="https:/doi.org/https://doi.org/10.1016/j.atmosres.2005.09.014" title="" class="ltx_ref">https://doi.org/10.1016/j.atmosres.2005.09.014</a>, european Conference on Severe Storms 2004

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pavlík et al [2022]</span>
<span class="ltx_bibblock">
Pavlík P, Rozinajová V, Ezzeddine AB (2022) Radar-based volumetric precipitation nowcasting: A 3d convolutional neural network with u-net architecture. In: 2nd Workshop on Complex Data Challenges in Earth Observation (CDCEO 2022), URL <a target="_blank" href="https://ceur-ws.org/Vol-3207/paper10.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ceur-ws.org/Vol-3207/paper10.pdf</a>

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pfitzner et al [2021]</span>
<span class="ltx_bibblock">
Pfitzner B, Steckhan N, Arnrich B (2021) Federated learning in a medical context: A systematic literature review. ACM Trans Internet Technol 21(2). <a target="_blank" href="https:/doi.org/10.1145/3412357" title="" class="ltx_ref">10.1145/3412357</a>, URL <a target="_blank" href="https://doi.org/10.1145/3412357" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3412357</a>

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajczak and Schär [2017]</span>
<span class="ltx_bibblock">
Rajczak J, Schär C (2017) Projections of future precipitation extremes over europe: A multimodel assessment of climate simulations. Journal of Geophysical Research: Atmospheres 122(20):10,773–10,800. <a target="_blank" href="https:/doi.org/10.1002/2017JD027176" title="" class="ltx_ref">10.1002/2017JD027176</a>

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ravuri et al [2021]</span>
<span class="ltx_bibblock">
Ravuri S, Lenc K, Willson M, et al (2021) Skilful precipitation nowcasting using deep generative models of radar. Nature 597:672–677. <a target="_blank" href="https:/doi.org/https://doi.org/10.1038/s41586-021-03854-z" title="" class="ltx_ref">https://doi.org/10.1038/s41586-021-03854-z</a>

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rieke et al [2020]</span>
<span class="ltx_bibblock">
Rieke N, Hancox J, Li W, et al (2020) The future of digital health with federated learning. NPJ digital medicine 3(1):119

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rinehart and Garvey [1978]</span>
<span class="ltx_bibblock">
Rinehart R, Garvey E (1978) Three-dimensional storm motion detection by conventional weather radar. Nature 273(5660):287–289

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sabah et al [2024]</span>
<span class="ltx_bibblock">
Sabah F, Chen Y, Yang Z, et al (2024) Model optimization techniques in personalized federated learning: A survey. Expert Systems with Applications 243:122874. <a target="_blank" href="https:/doi.org/https://doi.org/10.1016/j.eswa.2023.122874" title="" class="ltx_ref">https://doi.org/10.1016/j.eswa.2023.122874</a>, URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0957417423033766" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0957417423033766</a>

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sáinz-Pardo Díaz and López García [2023]</span>
<span class="ltx_bibblock">
Sáinz-Pardo Díaz J, López García Á (2023) Study of the performance and scalability of federated learning for medical imaging with intermittent clients. Neurocomputing 518:142–154

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al [2015]</span>
<span class="ltx_bibblock">
Shi X, Chen Z, Wang H, et al (2015) Convolutional lstm network: A machine learning approach for precipitation nowcasting. Advances in neural information processing systems 28

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al [2017]</span>
<span class="ltx_bibblock">
Shi X, Gao Z, Lausen L, et al (2017) Deep learning for precipitation nowcasting: A benchmark and a new model. In: Guyon I, Luxburg UV, Bengio S, et al (eds) Advances in Neural Information Processing Systems, vol 30. Curran Associates, Inc., URL <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/a6db4ed04f1621a119799fd3d7545d3d-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2017/file/a6db4ed04f1621a119799fd3d7545d3d-Paper.pdf</a>

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Svoboda and Pekárová [1998]</span>
<span class="ltx_bibblock">
Svoboda A, Pekárová P (1998) The catastrophic flood of july 1998 in the malá svinka catchment – simulation of its course [in slovak]. Vodohospodársky časopis 46(6):356–365

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Svoboda et al [3916]</span>
<span class="ltx_bibblock">
Svoboda V, Hanel M, Máca P, et al (3916) Projected changes of rainfall event characteristics for the czech republic. Journal of Hydrology and Hydromechanics 64(4):415–425. <a target="_blank" href="https:/doi.org/doi:10.1515/johh-2016-0036" title="" class="ltx_ref">doi:10.1515/johh-2016-0036</a>

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sáinz-Pardo Díaz et al [2023]</span>
<span class="ltx_bibblock">
Sáinz-Pardo Díaz J, Castrillo M, Álvaro López García (2023) Deep learning based soft-sensor for continuous chlorophyll estimation on decentralized data. Water Research 246:120726. <a target="_blank" href="https:/doi.org/https://doi.org/10.1016/j.watres.2023.120726" title="" class="ltx_ref">https://doi.org/10.1016/j.watres.2023.120726</a>, URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0043135423011661" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0043135423011661</a>

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al [2022]</span>
<span class="ltx_bibblock">
Tan AZ, Yu H, Cui L, et al (2022) Towards personalized federated learning. IEEE Transactions on Neural Networks and Learning Systems

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tanaka [2002]</span>
<span class="ltx_bibblock">
Tanaka K (2002) Statistical-mechanical approach to image processing. Journal of Physics A: Mathematical and General 35(37):R81. <a target="_blank" href="https:/doi.org/10.1088/0305-4470/35/37/201" title="" class="ltx_ref">10.1088/0305-4470/35/37/201</a>

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Matyas [2018]</span>
<span class="ltx_bibblock">
Tang J, Matyas C (2018) A nowcasting model for tropical cyclone precipitation regions based on the trec motion vector retrieval with a semi-lagrangian scheme for doppler weather radar. Atmosphere 9(5). <a target="_blank" href="https:/doi.org/10.3390/atmos9050200" title="" class="ltx_ref">10.3390/atmos9050200</a>

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al [2019]</span>
<span class="ltx_bibblock">
Wang Q, Zhang L, Bertinetto L, et al (2019) Fast online object tracking and segmentation: A unifying approach. <a href="1812.05050" title="" class="ltx_ref ltx_url ltx_font_typewriter">1812.05050</a>

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Woo and Wong [2017]</span>
<span class="ltx_bibblock">
Woo Wc, Wong Wk (2017) Operational application of optical flow techniques to radar-based rainfall nowcasting. Atmosphere 8(3). <a target="_blank" href="https:/doi.org/10.3390/atmos8030048" title="" class="ltx_ref">10.3390/atmos8030048</a>

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al [2019]</span>
<span class="ltx_bibblock">
Yang W, Zhang Y, Ye K, et al (2019) Ffd: A federated learning based method for credit card fraud detection. In: Big Data–BigData 2019: 8th International Congress, Held as Part of the Services Conference Federation, SCF 2019, San Diego, CA, USA, June 25–30, 2019, Proceedings 8, Springer, pp 18–32

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al [1988]</span>
<span class="ltx_bibblock">
Zhang W, Tanida J, Itoh K, et al (1988) Shift-invariant pattern recognition neural network and its optical architecture. In: Proceedings of annual conference of the Japan Society of Applied Physics, Montreal, CA

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al [2021]</span>
<span class="ltx_bibblock">
Zhang W, Wang X, Zhou P, et al (2021) Client selection for federated learning with non-iid data in mobile edge computing. IEEE Access 9:24462–24474. <a target="_blank" href="https:/doi.org/10.1109/ACCESS.2021.3056919" title="" class="ltx_ref">10.1109/ACCESS.2021.3056919</a>

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Peng [2019]</span>
<span class="ltx_bibblock">
Zhang Z, Peng H (2019) Deeper and wider siamese networks for real-time visual tracking. <a href="1901.01660" title="" class="ltx_ref ltx_url ltx_font_typewriter">1901.01660</a>

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al [2018]</span>
<span class="ltx_bibblock">
Zhu Z, Wang Q, Li B, et al (2018) Distractor-aware siamese networks for visual object tracking. <a href="1808.06048" title="" class="ltx_ref ltx_url ltx_font_typewriter">1808.06048</a>

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2408.05760" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2408.05761" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2408.05761">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2408.05761" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2408.05762" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Sep  5 16:58:50 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
