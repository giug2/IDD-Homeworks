<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.15598] Federated Learning with Only Positive Labels by Exploring Label Correlations</title><meta property="og:description" content="Federated learning aims to collaboratively learn a model by using the data from multiple users under privacy constraints. In this paper, we study the multi-label classification problem under the federated learning sett…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning with Only Positive Labels by Exploring Label Correlations">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning with Only Positive Labels by Exploring Label Correlations">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.15598">

<!--Generated on Sun May  5 17:49:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated learning,  multi-label,  positive label,  label correlation,  fixed class embedding.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning with Only Positive Labels by Exploring Label Correlations</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xuming An,
Dui Wang,
Li Shen,
Yong Luo,
Han Hu,
Bo Du,
Yonggang Wen ,
Dacheng Tao
</span><span class="ltx_author_notes">X. An and H. Hu are with the School of Information and Electronics, Beijing Institute of Technology, Beijing 100081, China (email: anxuming@bit.edu.cn; hhu@bit.edu.cn).D. Wang, Y. Luo and B. Du are with the National Engineering Research Center for Multimedia Software, School of Computer Science, Institute of Artificial Intelligence and Hubei Key Laboratory of Multimedia and Network Communication Engineering, Wuhan University, Wuhan 430072, China (e-mail: wangdui@whu.edu.cn; yluo180@gmail.com; dubo@whu.edu.cn).L. Shen and D. Tao are with the JD Explore Academy, Beijing, 100000, China (email: mathshenli@gmail.com, dacheng.tao@gmail.com).Y. Wen is with the School of Computer Science and Engineering, Nanyang Technological University, Singapore 639798 (e-mail: ygwen@ntu.edu.sg).</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning aims to collaboratively learn a model by using the data from multiple users under privacy constraints. In this paper, we study the multi-label classification problem under the federated learning setting, where trivial solution and extremely poor performance may be obtained, especially when only positive data w.r.t. a single class label are provided for each client. This issue can be addressed by adding a specially designed regularizer on the server-side. Although effective sometimes, the label correlations are simply ignored and thus sub-optimal performance may be obtained. Besides, it is expensive and unsafe to exchange user’s private embeddings between server and clients frequently, especially when training model in the contrastive way. To remedy these drawbacks, we propose a novel and generic method termed Federated Averaging by exploring Label Correlations (FedALC). Specifically, FedALC estimates the label correlations in the class embedding learning for different label pairs and utilizes it to improve the model training. To further improve the safety and also reduce the communication overhead, we propose a variant to learn fixed class embedding for each client, so that the server and clients only need to exchange class embeddings once. Extensive experiments on multiple popular datasets demonstrate that our FedALC can significantly outperform existing counterparts.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated learning, multi-label, positive label, label correlation, fixed class embedding.

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> is a novel machine learning paradigm that trains an algorithm across multiple decentralized clients (such as edge devices) or servers without exchanging local data samples. Since clients can only access the local datasets, the user’s privacy can be well protected, and this paradigm has attracted increasing attention in recent years <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
In this paper, we study the challenge problem of learning a multi-label classification model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> under the federated learning setting, where each user has only local positive data related to a single class label <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. This setting can be treated as the extremely label-skew case in the data heterogeneity of federated learning, which is popular in real-world applications. For example, a user verification (UV) model is decentralized and cooperatively trained by aggregating sensitive information of multiple users, and each client has only access to specific information (such as voice <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, face <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, fingerprint<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and iris<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>) of a single user.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">The key challenges for federated learning with only positive labels is that collapsing may occur for embedding-based discriminative models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, such as the popular neural network based classifier.
In our setting, each client lacks negative information including negative instances and negative class embeddings. Naively employing vanilla federated learning algorithms such as Federated Averaging (FedAvg), may lead to the collapsing of class embeddings and result in a trivial solution or extremely poor performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. This is because that the client neglects the negative loss and only indiscriminately minimizes the distance between the positive instance embedding and class embedding. In this case, different class scores on a test sample will be similar and indistinguishable, and hence the resulting model is meaningless.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">This issue is investigated and initially addressed by a recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, where an algorithm termed Federated Averaging with Spreadout (FedAwS) is proposed by imposing a geometric regularization on the server-side to separate different class embeddings and prevent them collapsing to a single point.
This approach, however, treats different labels equally in the spreadout (class embedding separation) process. That is, embeddings of class labels that are highly correlated and significantly different in multiple labels’ space are separated in the same way. This is not reasonable since embeddings should be close for correlated labels, and dissimilar otherwise. For example, we assume that the class labels ‘Desktop computer’ and ‘Desk’ often appear in the same instance, thus these two corresponding class embedding vectors can be deemed high-correlation and may be relatively close compared with others, such as class labels ‘aircraft’, ‘automobile’, etc. Besides, since the instance and class embeddings are trained on clients and server respectively, the class embeddings should be transmitted frequently between the server and clients. This leads to not only high communication and training time costs, but also privacy leakage in the transmission process. The leakage risk would increase significantly with an increasing number of transmissions.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2404.15598/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="922" height="518" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.10.1" class="ltx_text ltx_font_bold">Overview of the proposed federated averaging by exploring label correlations (FedALC) method</span>. <span id="S1.F1.11.2" class="ltx_text ltx_font_bold">(1)</span> Our FedALC computes gradients for parameter updating and hash code for each instance locally. The instance hash code is utilized for calculating label correlations and <span id="S1.F1.12.3" class="ltx_text ltx_font_bold">only need transmission once</span>; <span id="S1.F1.13.4" class="ltx_text ltx_font_bold">(2)</span> The client sends the locally updated model parameters, class embedding, and hash codes to the server; On the server, <span id="S1.F1.14.5" class="ltx_text ltx_font_bold">(3)</span> the global model is obtained via parameter aggregation; <span id="S1.F1.15.6" class="ltx_text ltx_font_bold">(4)</span> the different class embeddings are merged as a matrix, and label distribution is obtained by comparing the hash codes; <span id="S1.F1.16.7" class="ltx_text ltx_font_bold">(5)</span> The server then utilizes our designed correlation regularizer based on the label distribution to optimize the class embedding matrix; <span id="S1.F1.17.8" class="ltx_text ltx_font_bold">(6)</span> and eventually transmits global model parameters and corresponding class embeddings to different clients.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Given the issue of model collapsing and limitations of prior art, we propose a novel method termed Federated Averaging by exploring Label Correlations, named FedALC (see Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), for FL with only positive labels. In particular, we construct a novel regularizer to optimize the class embedding matrix by taking the label correlations into consideration. This is achieved by adding a correlation-based weight for each label pair in the spreadout, so that embeddings of similar labels are relatively close and dissimilar labels are far away. In this way, the label correlation can be well considered, and meanwhile the issue of collapsing can be addressed. To obtain the label correlations for regularization, we also propose an encrypted transmission strategy to collect label information across clients and obtain label distributions on the server. The label distributions are then utilized for calculating the weight of the correlation between different labels. Besides, to reduce both the computational cost and transmission overhead, we propose a variant to learn fixed class embedding matrix so that only a single transmission of class embeddings between the server and clients should be conducted.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.3" class="ltx_p">To summarize, the main contributions of this paper are:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel method termed FedALC to exploit the correlations between different class labels for federated learning with only positive labels. Our method can make the embeddings of relevant labels close to each other and stay away from irrelevant labels in class embedding learning;</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We design an encrypted and communication-efficiency strategy for calculating label correlations by collecting labels across clients and constructing label distributions on the server;</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We propose a variant that learns fixed class embeddings to improve safety and reduce transmission overhead and training cost.</p>
</div>
</li>
</ul>
<p id="S1.p5.2" class="ltx_p">We conduct extensive experiments on three popular visual datasets and two challenging multi-label text datasets. The results demonstrate significant improvements over the competitive counterparts. For example, we achieve relative improvements of <math id="S1.p5.1.m1.1" class="ltx_Math" alttext="8.17\%" display="inline"><semantics id="S1.p5.1.m1.1a"><mrow id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml"><mn id="S1.p5.1.m1.1.1.2" xref="S1.p5.1.m1.1.1.2.cmml">8.17</mn><mo id="S1.p5.1.m1.1.1.1" xref="S1.p5.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1"><csymbol cd="latexml" id="S1.p5.1.m1.1.1.1.cmml" xref="S1.p5.1.m1.1.1.1">percent</csymbol><cn type="float" id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.2">8.17</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">8.17\%</annotation></semantics></math> and <math id="S1.p5.2.m2.1" class="ltx_Math" alttext="19.3\%" display="inline"><semantics id="S1.p5.2.m2.1a"><mrow id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml"><mn id="S1.p5.2.m2.1.1.2" xref="S1.p5.2.m2.1.1.2.cmml">19.3</mn><mo id="S1.p5.2.m2.1.1.1" xref="S1.p5.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><apply id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1"><csymbol cd="latexml" id="S1.p5.2.m2.1.1.1.cmml" xref="S1.p5.2.m2.1.1.1">percent</csymbol><cn type="float" id="S1.p5.2.m2.1.1.2.cmml" xref="S1.p5.2.m2.1.1.2">19.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">19.3\%</annotation></semantics></math> on the VOC 2012 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and Bibtex <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> datasets respectively compared with FedAwS.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The rest of paper is organized as follows. In section <a href="#S2" title="II Related Work ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, we review related works about multi-label learning and federated learning. Section <a href="#S3" title="III Problem Formulation ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> introduces the problem of multi-label federated learning with positive labels. Details of the proposed FedACL method is presented in Section <a href="#S4" title="IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. The experimental results and analysis are shown in  <a href="#S5" title="V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>, and we conclude this paper in <a href="#S6" title="VI Conclusion and Discussion ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Multi-label learning</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Multi-class learning aims to classify instances into one of multiple classes. In contrast to the traditional multi-class classification, where only a single class label is assigned to an instance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, a single instance may have more than one label in multi-label classification (MLC), which can be utilized in a variety of applications ranging from protein function classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, document categorization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, to automatic image annotation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. A dozen of approaches have been proposed for various settings of MLC. For example, partial multi-label (PML) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> studies a problem that a superset of labels is given, where some irrelevant labels may be contained in the superset. Multi-label learning with weak labels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> assumes that only a subset of labels is provided. That is, some proper labels are absence for an instance. A thorough review of multi-label methods can be found in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.
Besides, in this era of big data, the extreme multi-label learning (XMLC) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> that handles a large number of labels has attracted more and more attention and becomes a new mainstream direction of MLC.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Federated learning</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Federated learning (FL) is a distributed machine learning paradigm that multiple clients collaborate to complete a learning task without exchanging private data, while maintaining communication efficiency. A well-known and commonly used FL algorithm is Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, which learns a global model by simple averaging.
Recently, numerous and more sophisticated algorithms or aggregation strategies have been proposed to address various FL challenges. For example, the performance of local models may be better than the global model due to the distribution divergence issue <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, and personalized federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> was proposed to address this issue by adopting a personalized method to optimize the global model for each client.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, some new approaches are designed for better privacy protection, while other works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> mainly focused on reducing communication cost. More recent works assume a heterogeneous setup that data on different clients hold different distributions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. Client clustering and selection are also studied <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. In this paper, we study a challenging FL setting that each client has only access to positive data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">The most related work to our proposed FedALC is FedAwS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. However, our work is different from the former work in the following aspects: 1) FedAwS simply constructs a regularizer to make different classes separate, while our method constructs the regularizer in a more fine-grained manner by considering the label correlations; 2) To construct our correlation regularizer on the server, a novel strategy is designed to collect label correlations across clients with the guarantee of safety and communication efficiency; 3) To further improve safety and reduce communication overhead, we also develop a variant of our approach to learn fixed class embedding for each client, and thus client and server only need to transmit class embedding once.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Problem Formulation</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.12" class="ltx_p">We consider the embedding-based model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> to complete multi-label classification task under the federated learning setting, where each client has only access to the local dataset associated with a single label. We suppose that there are <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">m</annotation></semantics></math> clients, and the <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">i</annotation></semantics></math>-th client is associated with a single label <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="y^{i}" display="inline"><semantics id="S3.p1.3.m3.1a"><msup id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">y</mi><mi id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">superscript</csymbol><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝑦</ci><ci id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">y^{i}</annotation></semantics></math>. In multi-label classification, an instance may have multiple labels, and hence the same instance may be distributed in different clients. For <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="i\in[m]" display="inline"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.2" xref="S3.p1.4.m4.1.2.cmml"><mi id="S3.p1.4.m4.1.2.2" xref="S3.p1.4.m4.1.2.2.cmml">i</mi><mo id="S3.p1.4.m4.1.2.1" xref="S3.p1.4.m4.1.2.1.cmml">∈</mo><mrow id="S3.p1.4.m4.1.2.3.2" xref="S3.p1.4.m4.1.2.3.1.cmml"><mo stretchy="false" id="S3.p1.4.m4.1.2.3.2.1" xref="S3.p1.4.m4.1.2.3.1.1.cmml">[</mo><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">m</mi><mo stretchy="false" id="S3.p1.4.m4.1.2.3.2.2" xref="S3.p1.4.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.2.cmml" xref="S3.p1.4.m4.1.2"><in id="S3.p1.4.m4.1.2.1.cmml" xref="S3.p1.4.m4.1.2.1"></in><ci id="S3.p1.4.m4.1.2.2.cmml" xref="S3.p1.4.m4.1.2.2">𝑖</ci><apply id="S3.p1.4.m4.1.2.3.1.cmml" xref="S3.p1.4.m4.1.2.3.2"><csymbol cd="latexml" id="S3.p1.4.m4.1.2.3.1.1.cmml" xref="S3.p1.4.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">i\in[m]</annotation></semantics></math>, the <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="{i}" display="inline"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">{i}</annotation></semantics></math>-th client has access to the local dataset <math id="S3.p1.6.m6.4" class="ltx_Math" alttext="\mathcal{S}^{i}=\{(\mathbf{x}_{1}^{i},y^{i}),(\mathbf{x}_{2}^{i},y^{i}),\cdots,(\mathbf{x}_{n_{i}}^{i},y^{i})\}" display="inline"><semantics id="S3.p1.6.m6.4a"><mrow id="S3.p1.6.m6.4.4" xref="S3.p1.6.m6.4.4.cmml"><msup id="S3.p1.6.m6.4.4.5" xref="S3.p1.6.m6.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.4.4.5.2" xref="S3.p1.6.m6.4.4.5.2.cmml">𝒮</mi><mi id="S3.p1.6.m6.4.4.5.3" xref="S3.p1.6.m6.4.4.5.3.cmml">i</mi></msup><mo id="S3.p1.6.m6.4.4.4" xref="S3.p1.6.m6.4.4.4.cmml">=</mo><mrow id="S3.p1.6.m6.4.4.3.3" xref="S3.p1.6.m6.4.4.3.4.cmml"><mo stretchy="false" id="S3.p1.6.m6.4.4.3.3.4" xref="S3.p1.6.m6.4.4.3.4.cmml">{</mo><mrow id="S3.p1.6.m6.2.2.1.1.1.2" xref="S3.p1.6.m6.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S3.p1.6.m6.2.2.1.1.1.2.3" xref="S3.p1.6.m6.2.2.1.1.1.3.cmml">(</mo><msubsup id="S3.p1.6.m6.2.2.1.1.1.1.1" xref="S3.p1.6.m6.2.2.1.1.1.1.1.cmml"><mi id="S3.p1.6.m6.2.2.1.1.1.1.1.2.2" xref="S3.p1.6.m6.2.2.1.1.1.1.1.2.2.cmml">𝐱</mi><mn id="S3.p1.6.m6.2.2.1.1.1.1.1.2.3" xref="S3.p1.6.m6.2.2.1.1.1.1.1.2.3.cmml">1</mn><mi id="S3.p1.6.m6.2.2.1.1.1.1.1.3" xref="S3.p1.6.m6.2.2.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.p1.6.m6.2.2.1.1.1.2.4" xref="S3.p1.6.m6.2.2.1.1.1.3.cmml">,</mo><msup id="S3.p1.6.m6.2.2.1.1.1.2.2" xref="S3.p1.6.m6.2.2.1.1.1.2.2.cmml"><mi id="S3.p1.6.m6.2.2.1.1.1.2.2.2" xref="S3.p1.6.m6.2.2.1.1.1.2.2.2.cmml">y</mi><mi id="S3.p1.6.m6.2.2.1.1.1.2.2.3" xref="S3.p1.6.m6.2.2.1.1.1.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.p1.6.m6.2.2.1.1.1.2.5" xref="S3.p1.6.m6.2.2.1.1.1.3.cmml">)</mo></mrow><mo id="S3.p1.6.m6.4.4.3.3.5" xref="S3.p1.6.m6.4.4.3.4.cmml">,</mo><mrow id="S3.p1.6.m6.3.3.2.2.2.2" xref="S3.p1.6.m6.3.3.2.2.2.3.cmml"><mo stretchy="false" id="S3.p1.6.m6.3.3.2.2.2.2.3" xref="S3.p1.6.m6.3.3.2.2.2.3.cmml">(</mo><msubsup id="S3.p1.6.m6.3.3.2.2.2.1.1" xref="S3.p1.6.m6.3.3.2.2.2.1.1.cmml"><mi id="S3.p1.6.m6.3.3.2.2.2.1.1.2.2" xref="S3.p1.6.m6.3.3.2.2.2.1.1.2.2.cmml">𝐱</mi><mn id="S3.p1.6.m6.3.3.2.2.2.1.1.2.3" xref="S3.p1.6.m6.3.3.2.2.2.1.1.2.3.cmml">2</mn><mi id="S3.p1.6.m6.3.3.2.2.2.1.1.3" xref="S3.p1.6.m6.3.3.2.2.2.1.1.3.cmml">i</mi></msubsup><mo id="S3.p1.6.m6.3.3.2.2.2.2.4" xref="S3.p1.6.m6.3.3.2.2.2.3.cmml">,</mo><msup id="S3.p1.6.m6.3.3.2.2.2.2.2" xref="S3.p1.6.m6.3.3.2.2.2.2.2.cmml"><mi id="S3.p1.6.m6.3.3.2.2.2.2.2.2" xref="S3.p1.6.m6.3.3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.p1.6.m6.3.3.2.2.2.2.2.3" xref="S3.p1.6.m6.3.3.2.2.2.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.p1.6.m6.3.3.2.2.2.2.5" xref="S3.p1.6.m6.3.3.2.2.2.3.cmml">)</mo></mrow><mo id="S3.p1.6.m6.4.4.3.3.6" xref="S3.p1.6.m6.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">⋯</mi><mo id="S3.p1.6.m6.4.4.3.3.7" xref="S3.p1.6.m6.4.4.3.4.cmml">,</mo><mrow id="S3.p1.6.m6.4.4.3.3.3.2" xref="S3.p1.6.m6.4.4.3.3.3.3.cmml"><mo stretchy="false" id="S3.p1.6.m6.4.4.3.3.3.2.3" xref="S3.p1.6.m6.4.4.3.3.3.3.cmml">(</mo><msubsup id="S3.p1.6.m6.4.4.3.3.3.1.1" xref="S3.p1.6.m6.4.4.3.3.3.1.1.cmml"><mi id="S3.p1.6.m6.4.4.3.3.3.1.1.2.2" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.2.cmml">𝐱</mi><msub id="S3.p1.6.m6.4.4.3.3.3.1.1.2.3" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.cmml"><mi id="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.2" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.2.cmml">n</mi><mi id="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.3" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.3.cmml">i</mi></msub><mi id="S3.p1.6.m6.4.4.3.3.3.1.1.3" xref="S3.p1.6.m6.4.4.3.3.3.1.1.3.cmml">i</mi></msubsup><mo id="S3.p1.6.m6.4.4.3.3.3.2.4" xref="S3.p1.6.m6.4.4.3.3.3.3.cmml">,</mo><msup id="S3.p1.6.m6.4.4.3.3.3.2.2" xref="S3.p1.6.m6.4.4.3.3.3.2.2.cmml"><mi id="S3.p1.6.m6.4.4.3.3.3.2.2.2" xref="S3.p1.6.m6.4.4.3.3.3.2.2.2.cmml">y</mi><mi id="S3.p1.6.m6.4.4.3.3.3.2.2.3" xref="S3.p1.6.m6.4.4.3.3.3.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.p1.6.m6.4.4.3.3.3.2.5" xref="S3.p1.6.m6.4.4.3.3.3.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.p1.6.m6.4.4.3.3.8" xref="S3.p1.6.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.4b"><apply id="S3.p1.6.m6.4.4.cmml" xref="S3.p1.6.m6.4.4"><eq id="S3.p1.6.m6.4.4.4.cmml" xref="S3.p1.6.m6.4.4.4"></eq><apply id="S3.p1.6.m6.4.4.5.cmml" xref="S3.p1.6.m6.4.4.5"><csymbol cd="ambiguous" id="S3.p1.6.m6.4.4.5.1.cmml" xref="S3.p1.6.m6.4.4.5">superscript</csymbol><ci id="S3.p1.6.m6.4.4.5.2.cmml" xref="S3.p1.6.m6.4.4.5.2">𝒮</ci><ci id="S3.p1.6.m6.4.4.5.3.cmml" xref="S3.p1.6.m6.4.4.5.3">𝑖</ci></apply><set id="S3.p1.6.m6.4.4.3.4.cmml" xref="S3.p1.6.m6.4.4.3.3"><interval closure="open" id="S3.p1.6.m6.2.2.1.1.1.3.cmml" xref="S3.p1.6.m6.2.2.1.1.1.2"><apply id="S3.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.p1.6.m6.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.1.1.1.1.1.1.cmml" xref="S3.p1.6.m6.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.p1.6.m6.2.2.1.1.1.1.1.2.cmml" xref="S3.p1.6.m6.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.1.1.1.1.1.2.1.cmml" xref="S3.p1.6.m6.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.6.m6.2.2.1.1.1.1.1.2.2.cmml" xref="S3.p1.6.m6.2.2.1.1.1.1.1.2.2">𝐱</ci><cn type="integer" id="S3.p1.6.m6.2.2.1.1.1.1.1.2.3.cmml" xref="S3.p1.6.m6.2.2.1.1.1.1.1.2.3">1</cn></apply><ci id="S3.p1.6.m6.2.2.1.1.1.1.1.3.cmml" xref="S3.p1.6.m6.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p1.6.m6.2.2.1.1.1.2.2.cmml" xref="S3.p1.6.m6.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.1.1.1.2.2.1.cmml" xref="S3.p1.6.m6.2.2.1.1.1.2.2">superscript</csymbol><ci id="S3.p1.6.m6.2.2.1.1.1.2.2.2.cmml" xref="S3.p1.6.m6.2.2.1.1.1.2.2.2">𝑦</ci><ci id="S3.p1.6.m6.2.2.1.1.1.2.2.3.cmml" xref="S3.p1.6.m6.2.2.1.1.1.2.2.3">𝑖</ci></apply></interval><interval closure="open" id="S3.p1.6.m6.3.3.2.2.2.3.cmml" xref="S3.p1.6.m6.3.3.2.2.2.2"><apply id="S3.p1.6.m6.3.3.2.2.2.1.1.cmml" xref="S3.p1.6.m6.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.3.3.2.2.2.1.1.1.cmml" xref="S3.p1.6.m6.3.3.2.2.2.1.1">superscript</csymbol><apply id="S3.p1.6.m6.3.3.2.2.2.1.1.2.cmml" xref="S3.p1.6.m6.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.3.3.2.2.2.1.1.2.1.cmml" xref="S3.p1.6.m6.3.3.2.2.2.1.1">subscript</csymbol><ci id="S3.p1.6.m6.3.3.2.2.2.1.1.2.2.cmml" xref="S3.p1.6.m6.3.3.2.2.2.1.1.2.2">𝐱</ci><cn type="integer" id="S3.p1.6.m6.3.3.2.2.2.1.1.2.3.cmml" xref="S3.p1.6.m6.3.3.2.2.2.1.1.2.3">2</cn></apply><ci id="S3.p1.6.m6.3.3.2.2.2.1.1.3.cmml" xref="S3.p1.6.m6.3.3.2.2.2.1.1.3">𝑖</ci></apply><apply id="S3.p1.6.m6.3.3.2.2.2.2.2.cmml" xref="S3.p1.6.m6.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.3.3.2.2.2.2.2.1.cmml" xref="S3.p1.6.m6.3.3.2.2.2.2.2">superscript</csymbol><ci id="S3.p1.6.m6.3.3.2.2.2.2.2.2.cmml" xref="S3.p1.6.m6.3.3.2.2.2.2.2.2">𝑦</ci><ci id="S3.p1.6.m6.3.3.2.2.2.2.2.3.cmml" xref="S3.p1.6.m6.3.3.2.2.2.2.2.3">𝑖</ci></apply></interval><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">⋯</ci><interval closure="open" id="S3.p1.6.m6.4.4.3.3.3.3.cmml" xref="S3.p1.6.m6.4.4.3.3.3.2"><apply id="S3.p1.6.m6.4.4.3.3.3.1.1.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.4.4.3.3.3.1.1.1.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1">superscript</csymbol><apply id="S3.p1.6.m6.4.4.3.3.3.1.1.2.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.4.4.3.3.3.1.1.2.1.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1">subscript</csymbol><ci id="S3.p1.6.m6.4.4.3.3.3.1.1.2.2.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.2">𝐱</ci><apply id="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.1.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.3">subscript</csymbol><ci id="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.2.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.2">𝑛</ci><ci id="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.3.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.p1.6.m6.4.4.3.3.3.1.1.3.cmml" xref="S3.p1.6.m6.4.4.3.3.3.1.1.3">𝑖</ci></apply><apply id="S3.p1.6.m6.4.4.3.3.3.2.2.cmml" xref="S3.p1.6.m6.4.4.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.4.4.3.3.3.2.2.1.cmml" xref="S3.p1.6.m6.4.4.3.3.3.2.2">superscript</csymbol><ci id="S3.p1.6.m6.4.4.3.3.3.2.2.2.cmml" xref="S3.p1.6.m6.4.4.3.3.3.2.2.2">𝑦</ci><ci id="S3.p1.6.m6.4.4.3.3.3.2.2.3.cmml" xref="S3.p1.6.m6.4.4.3.3.3.2.2.3">𝑖</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.4c">\mathcal{S}^{i}=\{(\mathbf{x}_{1}^{i},y^{i}),(\mathbf{x}_{2}^{i},y^{i}),\cdots,(\mathbf{x}_{n_{i}}^{i},y^{i})\}</annotation></semantics></math>. An embedding network <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="g_{\theta}:\chi\rightarrow\mathbb{R}^{D}" display="inline"><semantics id="S3.p1.7.m7.1a"><mrow id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><msub id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml"><mi id="S3.p1.7.m7.1.1.2.2" xref="S3.p1.7.m7.1.1.2.2.cmml">g</mi><mi id="S3.p1.7.m7.1.1.2.3" xref="S3.p1.7.m7.1.1.2.3.cmml">θ</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.p1.7.m7.1.1.1" xref="S3.p1.7.m7.1.1.1.cmml">:</mo><mrow id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml"><mi id="S3.p1.7.m7.1.1.3.2" xref="S3.p1.7.m7.1.1.3.2.cmml">χ</mi><mo stretchy="false" id="S3.p1.7.m7.1.1.3.1" xref="S3.p1.7.m7.1.1.3.1.cmml">→</mo><msup id="S3.p1.7.m7.1.1.3.3" xref="S3.p1.7.m7.1.1.3.3.cmml"><mi id="S3.p1.7.m7.1.1.3.3.2" xref="S3.p1.7.m7.1.1.3.3.2.cmml">ℝ</mi><mi id="S3.p1.7.m7.1.1.3.3.3" xref="S3.p1.7.m7.1.1.3.3.3.cmml">D</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><ci id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1">:</ci><apply id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.2.1.cmml" xref="S3.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.2.cmml" xref="S3.p1.7.m7.1.1.2.2">𝑔</ci><ci id="S3.p1.7.m7.1.1.2.3.cmml" xref="S3.p1.7.m7.1.1.2.3">𝜃</ci></apply><apply id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3"><ci id="S3.p1.7.m7.1.1.3.1.cmml" xref="S3.p1.7.m7.1.1.3.1">→</ci><ci id="S3.p1.7.m7.1.1.3.2.cmml" xref="S3.p1.7.m7.1.1.3.2">𝜒</ci><apply id="S3.p1.7.m7.1.1.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.3.3.1.cmml" xref="S3.p1.7.m7.1.1.3.3">superscript</csymbol><ci id="S3.p1.7.m7.1.1.3.3.2.cmml" xref="S3.p1.7.m7.1.1.3.3.2">ℝ</ci><ci id="S3.p1.7.m7.1.1.3.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">g_{\theta}:\chi\rightarrow\mathbb{R}^{D}</annotation></semantics></math> maps the input <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.p1.8.m8.1a"><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\mathbf{x}</annotation></semantics></math> as the <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">D</annotation></semantics></math>-dimensional instance embedding <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="g_{\theta}(\mathbf{x})" display="inline"><semantics id="S3.p1.10.m10.1a"><mrow id="S3.p1.10.m10.1.2" xref="S3.p1.10.m10.1.2.cmml"><msub id="S3.p1.10.m10.1.2.2" xref="S3.p1.10.m10.1.2.2.cmml"><mi id="S3.p1.10.m10.1.2.2.2" xref="S3.p1.10.m10.1.2.2.2.cmml">g</mi><mi id="S3.p1.10.m10.1.2.2.3" xref="S3.p1.10.m10.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.10.m10.1.2.1" xref="S3.p1.10.m10.1.2.1.cmml">​</mo><mrow id="S3.p1.10.m10.1.2.3.2" xref="S3.p1.10.m10.1.2.cmml"><mo stretchy="false" id="S3.p1.10.m10.1.2.3.2.1" xref="S3.p1.10.m10.1.2.cmml">(</mo><mi id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.p1.10.m10.1.2.3.2.2" xref="S3.p1.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.2.cmml" xref="S3.p1.10.m10.1.2"><times id="S3.p1.10.m10.1.2.1.cmml" xref="S3.p1.10.m10.1.2.1"></times><apply id="S3.p1.10.m10.1.2.2.cmml" xref="S3.p1.10.m10.1.2.2"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.2.2.1.cmml" xref="S3.p1.10.m10.1.2.2">subscript</csymbol><ci id="S3.p1.10.m10.1.2.2.2.cmml" xref="S3.p1.10.m10.1.2.2.2">𝑔</ci><ci id="S3.p1.10.m10.1.2.2.3.cmml" xref="S3.p1.10.m10.1.2.2.3">𝜃</ci></apply><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">g_{\theta}(\mathbf{x})</annotation></semantics></math>. The label of all <math id="S3.p1.11.m11.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S3.p1.11.m11.1a"><msub id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml"><mi id="S3.p1.11.m11.1.1.2" xref="S3.p1.11.m11.1.1.2.cmml">n</mi><mi id="S3.p1.11.m11.1.1.3" xref="S3.p1.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><apply id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.1.1.cmml" xref="S3.p1.11.m11.1.1">subscript</csymbol><ci id="S3.p1.11.m11.1.1.2.cmml" xref="S3.p1.11.m11.1.1.2">𝑛</ci><ci id="S3.p1.11.m11.1.1.3.cmml" xref="S3.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">n_{i}</annotation></semantics></math> instances are the same since each client only has a single label.
Given a distance measure <math id="S3.p1.12.m12.2" class="ltx_Math" alttext="d(\cdot,\cdot)" display="inline"><semantics id="S3.p1.12.m12.2a"><mrow id="S3.p1.12.m12.2.3" xref="S3.p1.12.m12.2.3.cmml"><mi id="S3.p1.12.m12.2.3.2" xref="S3.p1.12.m12.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.p1.12.m12.2.3.1" xref="S3.p1.12.m12.2.3.1.cmml">​</mo><mrow id="S3.p1.12.m12.2.3.3.2" xref="S3.p1.12.m12.2.3.3.1.cmml"><mo stretchy="false" id="S3.p1.12.m12.2.3.3.2.1" xref="S3.p1.12.m12.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.p1.12.m12.2.3.3.2.2" xref="S3.p1.12.m12.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.p1.12.m12.2.2" xref="S3.p1.12.m12.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.p1.12.m12.2.3.3.2.3" xref="S3.p1.12.m12.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.2b"><apply id="S3.p1.12.m12.2.3.cmml" xref="S3.p1.12.m12.2.3"><times id="S3.p1.12.m12.2.3.1.cmml" xref="S3.p1.12.m12.2.3.1"></times><ci id="S3.p1.12.m12.2.3.2.cmml" xref="S3.p1.12.m12.2.3.2">𝑑</ci><interval closure="open" id="S3.p1.12.m12.2.3.3.1.cmml" xref="S3.p1.12.m12.2.3.3.2"><ci id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">⋅</ci><ci id="S3.p1.12.m12.2.2.cmml" xref="S3.p1.12.m12.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.2c">d(\cdot,\cdot)</annotation></semantics></math>, the contrastive loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> used in clients can be given by:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.65" class="ltx_Math" alttext="\begin{split}\ell_{\mathrm{cl}}(\mathbf{x}_{j}^{i},y^{i};\theta,W)=\alpha\cdot\left(d\left(g_{\bm{\theta}}(\mathbf{x}_{j}^{i}),\mathbf{w}_{y^{i}}\right)\right)^{2}+\quad\quad\quad\quad\quad\\
\quad\quad\quad\beta\cdot\sum_{c\neq i}\left(\max\left\{0,\nu-d\left(g_{\bm{\theta}}(\mathbf{x}_{j}^{i}),\mathbf{w}_{y^{c}}\right)\right\}\right)^{2}\quad,\end{split}" display="block"><semantics id="S3.E1.m1.65a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E1.m1.65.65.3"><mtr id="S3.E1.m1.65.65.3a"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.65.65.3b"><mrow id="S3.E1.m1.64.64.2.63.35.35.35"><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1"><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.2"><msub id="S3.E1.m1.64.64.2.63.35.35.35.1.2.4"><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">ℓ</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml">cl</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.64.64.2.63.35.35.35.1.2.3" xref="S3.E1.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.2.2.2"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.63.63.1.1.1.cmml">(</mo><msubsup id="S3.E1.m1.64.64.2.63.35.35.35.1.1.1.1.1"><mi id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.4.cmml">𝐱</mi><mi id="S3.E1.m1.5.5.5.5.5.5.1" xref="S3.E1.m1.5.5.5.5.5.5.1.cmml">j</mi><mi id="S3.E1.m1.6.6.6.6.6.6.1" xref="S3.E1.m1.6.6.6.6.6.6.1.cmml">i</mi></msubsup><mo id="S3.E1.m1.7.7.7.7.7.7" xref="S3.E1.m1.63.63.1.1.1.cmml">,</mo><msup id="S3.E1.m1.64.64.2.63.35.35.35.1.2.2.2.2"><mi id="S3.E1.m1.8.8.8.8.8.8" xref="S3.E1.m1.8.8.8.8.8.8.cmml">y</mi><mi id="S3.E1.m1.9.9.9.9.9.9.1" xref="S3.E1.m1.9.9.9.9.9.9.1.cmml">i</mi></msup><mo id="S3.E1.m1.10.10.10.10.10.10" xref="S3.E1.m1.63.63.1.1.1.cmml">;</mo><mi id="S3.E1.m1.11.11.11.11.11.11" xref="S3.E1.m1.11.11.11.11.11.11.cmml">θ</mi><mo id="S3.E1.m1.12.12.12.12.12.12" xref="S3.E1.m1.63.63.1.1.1.cmml">,</mo><mi id="S3.E1.m1.13.13.13.13.13.13" xref="S3.E1.m1.13.13.13.13.13.13.cmml">W</mi><mo stretchy="false" id="S3.E1.m1.14.14.14.14.14.14" xref="S3.E1.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.15.15.15.15.15.15" xref="S3.E1.m1.15.15.15.15.15.15.cmml">=</mo><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.3"><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1"><mi id="S3.E1.m1.16.16.16.16.16.16" xref="S3.E1.m1.16.16.16.16.16.16.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.17.17.17.17.17.17" xref="S3.E1.m1.17.17.17.17.17.17.cmml">⋅</mo><msup id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1"><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1"><mo id="S3.E1.m1.18.18.18.18.18.18" xref="S3.E1.m1.63.63.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1"><mi id="S3.E1.m1.19.19.19.19.19.19" xref="S3.E1.m1.19.19.19.19.19.19.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1.3" xref="S3.E1.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1.2.2"><mo id="S3.E1.m1.20.20.20.20.20.20" xref="S3.E1.m1.63.63.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1.1.1.1"><msub id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1.1.1.1.3"><mi id="S3.E1.m1.21.21.21.21.21.21" xref="S3.E1.m1.21.21.21.21.21.21.cmml">g</mi><mi id="S3.E1.m1.22.22.22.22.22.22.1" xref="S3.E1.m1.22.22.22.22.22.22.1.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E1.m1.23.23.23.23.23.23" xref="S3.E1.m1.63.63.1.1.1.cmml">(</mo><msubsup id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E1.m1.24.24.24.24.24.24" xref="S3.E1.m1.24.24.24.24.24.24.cmml">𝐱</mi><mi id="S3.E1.m1.25.25.25.25.25.25.1" xref="S3.E1.m1.25.25.25.25.25.25.1.cmml">j</mi><mi id="S3.E1.m1.26.26.26.26.26.26.1" xref="S3.E1.m1.26.26.26.26.26.26.1.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E1.m1.27.27.27.27.27.27" xref="S3.E1.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.28.28.28.28.28.28" xref="S3.E1.m1.63.63.1.1.1.cmml">,</mo><msub id="S3.E1.m1.64.64.2.63.35.35.35.1.3.1.1.1.1.1.2.2.2"><mi id="S3.E1.m1.29.29.29.29.29.29" xref="S3.E1.m1.29.29.29.29.29.29.cmml">𝐰</mi><msup id="S3.E1.m1.30.30.30.30.30.30.1" xref="S3.E1.m1.30.30.30.30.30.30.1.cmml"><mi id="S3.E1.m1.30.30.30.30.30.30.1.2" xref="S3.E1.m1.30.30.30.30.30.30.1.2.cmml">y</mi><mi id="S3.E1.m1.30.30.30.30.30.30.1.3" xref="S3.E1.m1.30.30.30.30.30.30.1.3.cmml">i</mi></msup></msub><mo id="S3.E1.m1.31.31.31.31.31.31" xref="S3.E1.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.32.32.32.32.32.32" xref="S3.E1.m1.63.63.1.1.1.cmml">)</mo></mrow><mn id="S3.E1.m1.33.33.33.33.33.33.1" xref="S3.E1.m1.33.33.33.33.33.33.1.cmml">2</mn></msup></mrow><mo id="S3.E1.m1.34.34.34.34.34.34" xref="S3.E1.m1.34.34.34.34.34.34.cmml">+</mo></mrow></mrow><mspace width="5em" id="S3.E1.m1.64.64.2.63.35.35.35.2" xref="S3.E1.m1.63.63.1.1.1.cmml"></mspace></mrow></mtd></mtr><mtr id="S3.E1.m1.65.65.3c"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.65.65.3d"><mrow id="S3.E1.m1.65.65.3.64.29.29.29"><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1"><mi id="S3.E1.m1.35.35.35.1.1.1" xref="S3.E1.m1.35.35.35.1.1.1.cmml">β</mi><mo lspace="0.222em" rspace="0.055em" id="S3.E1.m1.36.36.36.2.2.2" xref="S3.E1.m1.36.36.36.2.2.2.cmml">⋅</mo><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1"><munder id="S3.E1.m1.65.65.3.64.29.29.29.1.1.2"><mo movablelimits="false" rspace="0em" id="S3.E1.m1.37.37.37.3.3.3" xref="S3.E1.m1.37.37.37.3.3.3.cmml">∑</mo><mrow id="S3.E1.m1.38.38.38.4.4.4.1" xref="S3.E1.m1.38.38.38.4.4.4.1.cmml"><mi id="S3.E1.m1.38.38.38.4.4.4.1.2" xref="S3.E1.m1.38.38.38.4.4.4.1.2.cmml">c</mi><mo id="S3.E1.m1.38.38.38.4.4.4.1.1" xref="S3.E1.m1.38.38.38.4.4.4.1.1.cmml">≠</mo><mi id="S3.E1.m1.38.38.38.4.4.4.1.3" xref="S3.E1.m1.38.38.38.4.4.4.1.3.cmml">i</mi></mrow></munder><msup id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1"><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1"><mo id="S3.E1.m1.39.39.39.5.5.5" xref="S3.E1.m1.63.63.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1"><mi id="S3.E1.m1.40.40.40.6.6.6" xref="S3.E1.m1.40.40.40.6.6.6.cmml">max</mi><mo id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1a" xref="S3.E1.m1.63.63.1.1.1.cmml">⁡</mo><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1"><mo id="S3.E1.m1.41.41.41.7.7.7" xref="S3.E1.m1.63.63.1.1.1.cmml">{</mo><mn id="S3.E1.m1.42.42.42.8.8.8" xref="S3.E1.m1.42.42.42.8.8.8.cmml">0</mn><mo id="S3.E1.m1.43.43.43.9.9.9" xref="S3.E1.m1.63.63.1.1.1.cmml">,</mo><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1"><mi id="S3.E1.m1.44.44.44.10.10.10" xref="S3.E1.m1.44.44.44.10.10.10.cmml">ν</mi><mo id="S3.E1.m1.45.45.45.11.11.11" xref="S3.E1.m1.45.45.45.11.11.11.cmml">−</mo><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.2"><mi id="S3.E1.m1.46.46.46.12.12.12" xref="S3.E1.m1.46.46.46.12.12.12.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.2.2.2"><mo id="S3.E1.m1.47.47.47.13.13.13" xref="S3.E1.m1.63.63.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1"><msub id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mi id="S3.E1.m1.48.48.48.14.14.14" xref="S3.E1.m1.48.48.48.14.14.14.cmml">g</mi><mi id="S3.E1.m1.49.49.49.15.15.15.1" xref="S3.E1.m1.49.49.49.15.15.15.1.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E1.m1.50.50.50.16.16.16" xref="S3.E1.m1.63.63.1.1.1.cmml">(</mo><msubsup id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E1.m1.51.51.51.17.17.17" xref="S3.E1.m1.51.51.51.17.17.17.cmml">𝐱</mi><mi id="S3.E1.m1.52.52.52.18.18.18.1" xref="S3.E1.m1.52.52.52.18.18.18.1.cmml">j</mi><mi id="S3.E1.m1.53.53.53.19.19.19.1" xref="S3.E1.m1.53.53.53.19.19.19.1.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E1.m1.54.54.54.20.20.20" xref="S3.E1.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.55.55.55.21.21.21" xref="S3.E1.m1.63.63.1.1.1.cmml">,</mo><msub id="S3.E1.m1.65.65.3.64.29.29.29.1.1.1.1.1.1.1.1.1.2.2.2.2"><mi id="S3.E1.m1.56.56.56.22.22.22" xref="S3.E1.m1.56.56.56.22.22.22.cmml">𝐰</mi><msup id="S3.E1.m1.57.57.57.23.23.23.1" xref="S3.E1.m1.57.57.57.23.23.23.1.cmml"><mi id="S3.E1.m1.57.57.57.23.23.23.1.2" xref="S3.E1.m1.57.57.57.23.23.23.1.2.cmml">y</mi><mi id="S3.E1.m1.57.57.57.23.23.23.1.3" xref="S3.E1.m1.57.57.57.23.23.23.1.3.cmml">c</mi></msup></msub><mo id="S3.E1.m1.58.58.58.24.24.24" xref="S3.E1.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.59.59.59.25.25.25" xref="S3.E1.m1.63.63.1.1.1.cmml">}</mo></mrow></mrow><mo id="S3.E1.m1.60.60.60.26.26.26" xref="S3.E1.m1.63.63.1.1.1.cmml">)</mo></mrow><mn id="S3.E1.m1.61.61.61.27.27.27.1" xref="S3.E1.m1.61.61.61.27.27.27.1.cmml">2</mn></msup></mrow></mrow><mspace width="1em" id="S3.E1.m1.65.65.3.64.29.29.29.2" xref="S3.E1.m1.63.63.1.1.1.cmml"></mspace><mo id="S3.E1.m1.62.62.62.28.28.28" xref="S3.E1.m1.63.63.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.65b"><apply id="S3.E1.m1.63.63.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><eq id="S3.E1.m1.15.15.15.15.15.15.cmml" xref="S3.E1.m1.15.15.15.15.15.15"></eq><apply id="S3.E1.m1.63.63.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><times id="S3.E1.m1.63.63.1.1.1.2.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"></times><apply id="S3.E1.m1.63.63.1.1.1.2.4.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.2.4.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">ℓ</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1">cl</ci></apply><vector id="S3.E1.m1.63.63.1.1.1.2.2.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><apply id="S3.E1.m1.63.63.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">superscript</csymbol><apply id="S3.E1.m1.63.63.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4.4">𝐱</ci><ci id="S3.E1.m1.5.5.5.5.5.5.1.cmml" xref="S3.E1.m1.5.5.5.5.5.5.1">𝑗</ci></apply><ci id="S3.E1.m1.6.6.6.6.6.6.1.cmml" xref="S3.E1.m1.6.6.6.6.6.6.1">𝑖</ci></apply><apply id="S3.E1.m1.63.63.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">superscript</csymbol><ci id="S3.E1.m1.8.8.8.8.8.8.cmml" xref="S3.E1.m1.8.8.8.8.8.8">𝑦</ci><ci id="S3.E1.m1.9.9.9.9.9.9.1.cmml" xref="S3.E1.m1.9.9.9.9.9.9.1">𝑖</ci></apply><ci id="S3.E1.m1.11.11.11.11.11.11.cmml" xref="S3.E1.m1.11.11.11.11.11.11">𝜃</ci><ci id="S3.E1.m1.13.13.13.13.13.13.cmml" xref="S3.E1.m1.13.13.13.13.13.13">𝑊</ci></vector></apply><list id="S3.E1.m1.63.63.1.1.1.4.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="latexml" id="S3.E1.m1.63.63.1.1.1.3.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">limit-from</csymbol><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><ci id="S3.E1.m1.17.17.17.17.17.17.cmml" xref="S3.E1.m1.17.17.17.17.17.17">⋅</ci><ci id="S3.E1.m1.16.16.16.16.16.16.cmml" xref="S3.E1.m1.16.16.16.16.16.16">𝛼</ci><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">superscript</csymbol><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><times id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"></times><ci id="S3.E1.m1.19.19.19.19.19.19.cmml" xref="S3.E1.m1.19.19.19.19.19.19">𝑑</ci><interval closure="open" id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><times id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"></times><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><ci id="S3.E1.m1.21.21.21.21.21.21.cmml" xref="S3.E1.m1.21.21.21.21.21.21">𝑔</ci><ci id="S3.E1.m1.22.22.22.22.22.22.1.cmml" xref="S3.E1.m1.22.22.22.22.22.22.1">𝜽</ci></apply><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">superscript</csymbol><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><ci id="S3.E1.m1.24.24.24.24.24.24.cmml" xref="S3.E1.m1.24.24.24.24.24.24">𝐱</ci><ci id="S3.E1.m1.25.25.25.25.25.25.1.cmml" xref="S3.E1.m1.25.25.25.25.25.25.1">𝑗</ci></apply><ci id="S3.E1.m1.26.26.26.26.26.26.1.cmml" xref="S3.E1.m1.26.26.26.26.26.26.1">𝑖</ci></apply></apply><apply id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><ci id="S3.E1.m1.29.29.29.29.29.29.cmml" xref="S3.E1.m1.29.29.29.29.29.29">𝐰</ci><apply id="S3.E1.m1.30.30.30.30.30.30.1.cmml" xref="S3.E1.m1.30.30.30.30.30.30.1"><csymbol cd="ambiguous" id="S3.E1.m1.30.30.30.30.30.30.1.1.cmml" xref="S3.E1.m1.30.30.30.30.30.30.1">superscript</csymbol><ci id="S3.E1.m1.30.30.30.30.30.30.1.2.cmml" xref="S3.E1.m1.30.30.30.30.30.30.1.2">𝑦</ci><ci id="S3.E1.m1.30.30.30.30.30.30.1.3.cmml" xref="S3.E1.m1.30.30.30.30.30.30.1.3">𝑖</ci></apply></apply></interval></apply><cn type="integer" id="S3.E1.m1.33.33.33.33.33.33.1.cmml" xref="S3.E1.m1.33.33.33.33.33.33.1">2</cn></apply></apply><plus id="S3.E1.m1.34.34.34.34.34.34.cmml" xref="S3.E1.m1.34.34.34.34.34.34"></plus></apply><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><ci id="S3.E1.m1.36.36.36.2.2.2.cmml" xref="S3.E1.m1.36.36.36.2.2.2">⋅</ci><ci id="S3.E1.m1.35.35.35.1.1.1.cmml" xref="S3.E1.m1.35.35.35.1.1.1">𝛽</ci><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.4.2.2.1.2.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><sum id="S3.E1.m1.37.37.37.3.3.3.cmml" xref="S3.E1.m1.37.37.37.3.3.3"></sum><apply id="S3.E1.m1.38.38.38.4.4.4.1.cmml" xref="S3.E1.m1.38.38.38.4.4.4.1"><neq id="S3.E1.m1.38.38.38.4.4.4.1.1.cmml" xref="S3.E1.m1.38.38.38.4.4.4.1.1"></neq><ci id="S3.E1.m1.38.38.38.4.4.4.1.2.cmml" xref="S3.E1.m1.38.38.38.4.4.4.1.2">𝑐</ci><ci id="S3.E1.m1.38.38.38.4.4.4.1.3.cmml" xref="S3.E1.m1.38.38.38.4.4.4.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">superscript</csymbol><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><max id="S3.E1.m1.40.40.40.6.6.6.cmml" xref="S3.E1.m1.40.40.40.6.6.6"></max><cn type="integer" id="S3.E1.m1.42.42.42.8.8.8.cmml" xref="S3.E1.m1.42.42.42.8.8.8">0</cn><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><minus id="S3.E1.m1.45.45.45.11.11.11.cmml" xref="S3.E1.m1.45.45.45.11.11.11"></minus><ci id="S3.E1.m1.44.44.44.10.10.10.cmml" xref="S3.E1.m1.44.44.44.10.10.10">𝜈</ci><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><times id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"></times><ci id="S3.E1.m1.46.46.46.12.12.12.cmml" xref="S3.E1.m1.46.46.46.12.12.12">𝑑</ci><interval closure="open" id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><times id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"></times><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><ci id="S3.E1.m1.48.48.48.14.14.14.cmml" xref="S3.E1.m1.48.48.48.14.14.14">𝑔</ci><ci id="S3.E1.m1.49.49.49.15.15.15.1.cmml" xref="S3.E1.m1.49.49.49.15.15.15.1">𝜽</ci></apply><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">superscript</csymbol><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><ci id="S3.E1.m1.51.51.51.17.17.17.cmml" xref="S3.E1.m1.51.51.51.17.17.17">𝐱</ci><ci id="S3.E1.m1.52.52.52.18.18.18.1.cmml" xref="S3.E1.m1.52.52.52.18.18.18.1">𝑗</ci></apply><ci id="S3.E1.m1.53.53.53.19.19.19.1.cmml" xref="S3.E1.m1.53.53.53.19.19.19.1">𝑖</ci></apply></apply><apply id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.63.63.1.1.1.4.2.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.64.64.2.63.35.35.35.1.2.3">subscript</csymbol><ci id="S3.E1.m1.56.56.56.22.22.22.cmml" xref="S3.E1.m1.56.56.56.22.22.22">𝐰</ci><apply id="S3.E1.m1.57.57.57.23.23.23.1.cmml" xref="S3.E1.m1.57.57.57.23.23.23.1"><csymbol cd="ambiguous" id="S3.E1.m1.57.57.57.23.23.23.1.1.cmml" xref="S3.E1.m1.57.57.57.23.23.23.1">superscript</csymbol><ci id="S3.E1.m1.57.57.57.23.23.23.1.2.cmml" xref="S3.E1.m1.57.57.57.23.23.23.1.2">𝑦</ci><ci id="S3.E1.m1.57.57.57.23.23.23.1.3.cmml" xref="S3.E1.m1.57.57.57.23.23.23.1.3">𝑐</ci></apply></apply></interval></apply></apply></apply><cn type="integer" id="S3.E1.m1.61.61.61.27.27.27.1.cmml" xref="S3.E1.m1.61.61.61.27.27.27.1">2</cn></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.65c">\begin{split}\ell_{\mathrm{cl}}(\mathbf{x}_{j}^{i},y^{i};\theta,W)=\alpha\cdot\left(d\left(g_{\bm{\theta}}(\mathbf{x}_{j}^{i}),\mathbf{w}_{y^{i}}\right)\right)^{2}+\quad\quad\quad\quad\quad\\
\quad\quad\quad\beta\cdot\sum_{c\neq i}\left(\max\left\{0,\nu-d\left(g_{\bm{\theta}}(\mathbf{x}_{j}^{i}),\mathbf{w}_{y^{c}}\right)\right\}\right)^{2}\quad,\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.20" class="ltx_p">where <math id="S3.p1.13.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.p1.13.m1.1a"><mi id="S3.p1.13.m1.1.1" xref="S3.p1.13.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.p1.13.m1.1b"><ci id="S3.p1.13.m1.1.1.cmml" xref="S3.p1.13.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m1.1c">\alpha</annotation></semantics></math> and <math id="S3.p1.14.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.p1.14.m2.1a"><mi id="S3.p1.14.m2.1.1" xref="S3.p1.14.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.p1.14.m2.1b"><ci id="S3.p1.14.m2.1.1.cmml" xref="S3.p1.14.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m2.1c">\beta</annotation></semantics></math> are trade-off hyper-parameters, <math id="S3.p1.15.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p1.15.m3.1a"><mi id="S3.p1.15.m3.1.1" xref="S3.p1.15.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.15.m3.1b"><ci id="S3.p1.15.m3.1.1.cmml" xref="S3.p1.15.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m3.1c">\theta</annotation></semantics></math> is parameters of model (feature extractor), <math id="S3.p1.16.m4.1" class="ltx_Math" alttext="W\in\mathbb{R}^{C\times D}" display="inline"><semantics id="S3.p1.16.m4.1a"><mrow id="S3.p1.16.m4.1.1" xref="S3.p1.16.m4.1.1.cmml"><mi id="S3.p1.16.m4.1.1.2" xref="S3.p1.16.m4.1.1.2.cmml">W</mi><mo id="S3.p1.16.m4.1.1.1" xref="S3.p1.16.m4.1.1.1.cmml">∈</mo><msup id="S3.p1.16.m4.1.1.3" xref="S3.p1.16.m4.1.1.3.cmml"><mi id="S3.p1.16.m4.1.1.3.2" xref="S3.p1.16.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.16.m4.1.1.3.3" xref="S3.p1.16.m4.1.1.3.3.cmml"><mi id="S3.p1.16.m4.1.1.3.3.2" xref="S3.p1.16.m4.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.16.m4.1.1.3.3.1" xref="S3.p1.16.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.16.m4.1.1.3.3.3" xref="S3.p1.16.m4.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.16.m4.1b"><apply id="S3.p1.16.m4.1.1.cmml" xref="S3.p1.16.m4.1.1"><in id="S3.p1.16.m4.1.1.1.cmml" xref="S3.p1.16.m4.1.1.1"></in><ci id="S3.p1.16.m4.1.1.2.cmml" xref="S3.p1.16.m4.1.1.2">𝑊</ci><apply id="S3.p1.16.m4.1.1.3.cmml" xref="S3.p1.16.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m4.1.1.3.1.cmml" xref="S3.p1.16.m4.1.1.3">superscript</csymbol><ci id="S3.p1.16.m4.1.1.3.2.cmml" xref="S3.p1.16.m4.1.1.3.2">ℝ</ci><apply id="S3.p1.16.m4.1.1.3.3.cmml" xref="S3.p1.16.m4.1.1.3.3"><times id="S3.p1.16.m4.1.1.3.3.1.cmml" xref="S3.p1.16.m4.1.1.3.3.1"></times><ci id="S3.p1.16.m4.1.1.3.3.2.cmml" xref="S3.p1.16.m4.1.1.3.3.2">𝐶</ci><ci id="S3.p1.16.m4.1.1.3.3.3.cmml" xref="S3.p1.16.m4.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m4.1c">W\in\mathbb{R}^{C\times D}</annotation></semantics></math> is the class embedding matrix (<math id="S3.p1.17.m5.1" class="ltx_Math" alttext="C=m" display="inline"><semantics id="S3.p1.17.m5.1a"><mrow id="S3.p1.17.m5.1.1" xref="S3.p1.17.m5.1.1.cmml"><mi id="S3.p1.17.m5.1.1.2" xref="S3.p1.17.m5.1.1.2.cmml">C</mi><mo id="S3.p1.17.m5.1.1.1" xref="S3.p1.17.m5.1.1.1.cmml">=</mo><mi id="S3.p1.17.m5.1.1.3" xref="S3.p1.17.m5.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.17.m5.1b"><apply id="S3.p1.17.m5.1.1.cmml" xref="S3.p1.17.m5.1.1"><eq id="S3.p1.17.m5.1.1.1.cmml" xref="S3.p1.17.m5.1.1.1"></eq><ci id="S3.p1.17.m5.1.1.2.cmml" xref="S3.p1.17.m5.1.1.2">𝐶</ci><ci id="S3.p1.17.m5.1.1.3.cmml" xref="S3.p1.17.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m5.1c">C=m</annotation></semantics></math> in our setting) and <math id="S3.p1.18.m6.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.p1.18.m6.1a"><mi id="S3.p1.18.m6.1.1" xref="S3.p1.18.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.p1.18.m6.1b"><ci id="S3.p1.18.m6.1.1.cmml" xref="S3.p1.18.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m6.1c">D</annotation></semantics></math> is the dimension of embedding, with each row being a class embedding <math id="S3.p1.19.m7.1" class="ltx_Math" alttext="\mathbf{w}_{y^{c}}" display="inline"><semantics id="S3.p1.19.m7.1a"><msub id="S3.p1.19.m7.1.1" xref="S3.p1.19.m7.1.1.cmml"><mi id="S3.p1.19.m7.1.1.2" xref="S3.p1.19.m7.1.1.2.cmml">𝐰</mi><msup id="S3.p1.19.m7.1.1.3" xref="S3.p1.19.m7.1.1.3.cmml"><mi id="S3.p1.19.m7.1.1.3.2" xref="S3.p1.19.m7.1.1.3.2.cmml">y</mi><mi id="S3.p1.19.m7.1.1.3.3" xref="S3.p1.19.m7.1.1.3.3.cmml">c</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S3.p1.19.m7.1b"><apply id="S3.p1.19.m7.1.1.cmml" xref="S3.p1.19.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.19.m7.1.1.1.cmml" xref="S3.p1.19.m7.1.1">subscript</csymbol><ci id="S3.p1.19.m7.1.1.2.cmml" xref="S3.p1.19.m7.1.1.2">𝐰</ci><apply id="S3.p1.19.m7.1.1.3.cmml" xref="S3.p1.19.m7.1.1.3"><csymbol cd="ambiguous" id="S3.p1.19.m7.1.1.3.1.cmml" xref="S3.p1.19.m7.1.1.3">superscript</csymbol><ci id="S3.p1.19.m7.1.1.3.2.cmml" xref="S3.p1.19.m7.1.1.3.2">𝑦</ci><ci id="S3.p1.19.m7.1.1.3.3.cmml" xref="S3.p1.19.m7.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m7.1c">\mathbf{w}_{y^{c}}</annotation></semantics></math>. The first and second terms of Eq. (<a href="#S3.E1" title="In III Problem Formulation ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) are the positive loss and negative loss, respectively;
<math id="S3.p1.20.m8.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.p1.20.m8.1a"><mi id="S3.p1.20.m8.1.1" xref="S3.p1.20.m8.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.p1.20.m8.1b"><ci id="S3.p1.20.m8.1.1.cmml" xref="S3.p1.20.m8.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.20.m8.1c">v</annotation></semantics></math> is the edge hyper-parameter, which is a margin for the maximum distance between the positive label and the negative label embedding to stabilize model training<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>.
Then, the prediction function can be expressed as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="f(\mathbf{x})=Wg_{\bm{\theta}}(\mathbf{x})." display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.2.1" xref="S3.E2.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.2.3.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2.3.2.1" xref="S3.E2.m1.3.3.1.1.2.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2.3.2.2" xref="S3.E2.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">​</mo><msub id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.2.cmml">g</mi><mi id="S3.E2.m1.3.3.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.1a" xref="S3.E2.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.3.4.2" xref="S3.E2.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.4.2.1" xref="S3.E2.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝐱</mi><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.4.2.2" xref="S3.E2.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><times id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1"></times><ci id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2">𝑓</ci><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐱</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></times><ci id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2">𝑊</ci><apply id="S3.E2.m1.3.3.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2">𝑔</ci><ci id="S3.E2.m1.3.3.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3">𝜽</ci></apply><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">f(\mathbf{x})=Wg_{\bm{\theta}}(\mathbf{x}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.21" class="ltx_p">The output of <math id="S3.p1.21.m1.1" class="ltx_Math" alttext="f(x)" display="inline"><semantics id="S3.p1.21.m1.1a"><mrow id="S3.p1.21.m1.1.2" xref="S3.p1.21.m1.1.2.cmml"><mi id="S3.p1.21.m1.1.2.2" xref="S3.p1.21.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p1.21.m1.1.2.1" xref="S3.p1.21.m1.1.2.1.cmml">​</mo><mrow id="S3.p1.21.m1.1.2.3.2" xref="S3.p1.21.m1.1.2.cmml"><mo stretchy="false" id="S3.p1.21.m1.1.2.3.2.1" xref="S3.p1.21.m1.1.2.cmml">(</mo><mi id="S3.p1.21.m1.1.1" xref="S3.p1.21.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.p1.21.m1.1.2.3.2.2" xref="S3.p1.21.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.21.m1.1b"><apply id="S3.p1.21.m1.1.2.cmml" xref="S3.p1.21.m1.1.2"><times id="S3.p1.21.m1.1.2.1.cmml" xref="S3.p1.21.m1.1.2.1"></times><ci id="S3.p1.21.m1.1.2.2.cmml" xref="S3.p1.21.m1.1.2.2">𝑓</ci><ci id="S3.p1.21.m1.1.1.cmml" xref="S3.p1.21.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.21.m1.1c">f(x)</annotation></semantics></math> yields a real valued tensor, with each slot corresponding to a specific class. Following a methodology similar to FedAwS algorithm, we employ the top-k largest value method to predict the labels.
Since the client has no access to the instances of negative classes in our setting, we rewrite the loss function Eq. (<a href="#S3.E1" title="In III Problem Formulation ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) as the following form by dropping the negative loss:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="{\ell^{\mathrm{pos}}_{cl}(\mathbf{x}_{j}^{i},y^{i})=\left(d\left(g_{\bm{\theta}}(\mathbf{x}_{j}^{i}),\mathbf{w}_{y^{i}}\right)\right)^{2}.}" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml"><msubsup id="S3.E3.m1.1.1.1.1.2.4" xref="S3.E3.m1.1.1.1.1.2.4.cmml"><mi mathvariant="normal" id="S3.E3.m1.1.1.1.1.2.4.2.2" xref="S3.E3.m1.1.1.1.1.2.4.2.2.cmml">ℓ</mi><mrow id="S3.E3.m1.1.1.1.1.2.4.3" xref="S3.E3.m1.1.1.1.1.2.4.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.4.3.2" xref="S3.E3.m1.1.1.1.1.2.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.2.4.3.1" xref="S3.E3.m1.1.1.1.1.2.4.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.2.4.3.3" xref="S3.E3.m1.1.1.1.1.2.4.3.3.cmml">l</mi></mrow><mi id="S3.E3.m1.1.1.1.1.2.4.2.3" xref="S3.E3.m1.1.1.1.1.2.4.2.3.cmml">pos</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.2.2.2.4" xref="S3.E3.m1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S3.E3.m1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E3.m1.1.1.1.1.2.2.2.5" xref="S3.E3.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.4.cmml">=</mo><msup id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.3.1.1" xref="S3.E3.m1.1.1.1.1.3.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.3.1.1.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.3.1.1.1" xref="S3.E3.m1.1.1.1.1.3.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.4" xref="S3.E3.m1.1.1.1.1.3.1.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.3.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.3.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.3.cmml"><mo id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.3.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.cmml">g</mi><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.4" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.3.cmml">,</mo><msub id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.2.cmml">𝐰</mi><msup id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.2" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.2.cmml">y</mi><mi id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.3.cmml">i</mi></msup></msub><mo id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.5" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.3.1.1.3" xref="S3.E3.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow><mn id="S3.E3.m1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo lspace="0em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.4"></eq><apply id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"><times id="S3.E3.m1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.3"></times><apply id="S3.E3.m1.1.1.1.1.2.4.cmml" xref="S3.E3.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.4.1.cmml" xref="S3.E3.m1.1.1.1.1.2.4">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.4.2.cmml" xref="S3.E3.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.4.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.4">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.4.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.4.2.2">ℓ</ci><ci id="S3.E3.m1.1.1.1.1.2.4.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.4.2.3">pos</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.4.3.cmml" xref="S3.E3.m1.1.1.1.1.2.4.3"><times id="S3.E3.m1.1.1.1.1.2.4.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.4.3.1"></times><ci id="S3.E3.m1.1.1.1.1.2.4.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.4.3.2">𝑐</ci><ci id="S3.E3.m1.1.1.1.1.2.4.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.4.3.3">𝑙</ci></apply></apply><interval closure="open" id="S3.E3.m1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2">𝑦</ci><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.3.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1"><times id="S3.E3.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.3"></times><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.4">𝑑</ci><interval closure="open" id="S3.E3.m1.1.1.1.1.3.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2"><apply id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.2">𝐰</ci><apply id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.2">𝑦</ci><ci id="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.1.1.1.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply><cn type="integer" id="S3.E3.m1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">{\ell^{\mathrm{pos}}_{cl}(\mathbf{x}_{j}^{i},y^{i})=\left(d\left(g_{\bm{\theta}}(\mathbf{x}_{j}^{i}),\mathbf{w}_{y^{i}}\right)\right)^{2}.}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.22" class="ltx_p">Then the empirical loss on the local dataset <math id="S3.p1.22.m1.1" class="ltx_Math" alttext="\mathcal{S}^{i}" display="inline"><semantics id="S3.p1.22.m1.1a"><msup id="S3.p1.22.m1.1.1" xref="S3.p1.22.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.22.m1.1.1.2" xref="S3.p1.22.m1.1.1.2.cmml">𝒮</mi><mi id="S3.p1.22.m1.1.1.3" xref="S3.p1.22.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.22.m1.1b"><apply id="S3.p1.22.m1.1.1.cmml" xref="S3.p1.22.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m1.1.1.1.cmml" xref="S3.p1.22.m1.1.1">superscript</csymbol><ci id="S3.p1.22.m1.1.1.2.cmml" xref="S3.p1.22.m1.1.1.2">𝒮</ci><ci id="S3.p1.22.m1.1.1.3.cmml" xref="S3.p1.22.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.22.m1.1c">\mathcal{S}^{i}</annotation></semantics></math> can be given by:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.2" class="ltx_Math" alttext="{\hat{\mathcal{R}}_{\mathrm{pos}}\left(\mathcal{S}^{i},y^{i}\right):=\frac{1}{n_{i}}\sum_{j\in\left[n_{i}\right]}\ell^{\mathrm{pos}}_{cl}\left(\mathbf{x}_{j}^{i},y^{i}\right).}" display="block"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml"><msub id="S3.E4.m1.2.2.1.1.2.4" xref="S3.E4.m1.2.2.1.1.2.4.cmml"><mover accent="true" id="S3.E4.m1.2.2.1.1.2.4.2" xref="S3.E4.m1.2.2.1.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.1.1.2.4.2.2" xref="S3.E4.m1.2.2.1.1.2.4.2.2.cmml">ℛ</mi><mo id="S3.E4.m1.2.2.1.1.2.4.2.1" xref="S3.E4.m1.2.2.1.1.2.4.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.2.2.1.1.2.4.3" xref="S3.E4.m1.2.2.1.1.2.4.3.cmml">pos</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.2.3" xref="S3.E4.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml"><mo id="S3.E4.m1.2.2.1.1.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml">(</mo><msup id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.E4.m1.2.2.1.1.2.2.2.4" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml">,</mo><msup id="S3.E4.m1.2.2.1.1.2.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.2.2.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2.cmml">y</mi><mi id="S3.E4.m1.2.2.1.1.2.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.2.2.3.cmml">i</mi></msup><mo rspace="0.278em" id="S3.E4.m1.2.2.1.1.2.2.2.5" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.E4.m1.2.2.1.1.5" xref="S3.E4.m1.2.2.1.1.5.cmml">:=</mo><mrow id="S3.E4.m1.2.2.1.1.4" xref="S3.E4.m1.2.2.1.1.4.cmml"><mfrac id="S3.E4.m1.2.2.1.1.4.4" xref="S3.E4.m1.2.2.1.1.4.4.cmml"><mn id="S3.E4.m1.2.2.1.1.4.4.2" xref="S3.E4.m1.2.2.1.1.4.4.2.cmml">1</mn><msub id="S3.E4.m1.2.2.1.1.4.4.3" xref="S3.E4.m1.2.2.1.1.4.4.3.cmml"><mi id="S3.E4.m1.2.2.1.1.4.4.3.2" xref="S3.E4.m1.2.2.1.1.4.4.3.2.cmml">n</mi><mi id="S3.E4.m1.2.2.1.1.4.4.3.3" xref="S3.E4.m1.2.2.1.1.4.4.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.4.3" xref="S3.E4.m1.2.2.1.1.4.3.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.4.2" xref="S3.E4.m1.2.2.1.1.4.2.cmml"><munder id="S3.E4.m1.2.2.1.1.4.2.3" xref="S3.E4.m1.2.2.1.1.4.2.3.cmml"><mo movablelimits="false" id="S3.E4.m1.2.2.1.1.4.2.3.2" xref="S3.E4.m1.2.2.1.1.4.2.3.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml">j</mi><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">∈</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">n</mi><mi id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></munder><mrow id="S3.E4.m1.2.2.1.1.4.2.2" xref="S3.E4.m1.2.2.1.1.4.2.2.cmml"><msubsup id="S3.E4.m1.2.2.1.1.4.2.2.4" xref="S3.E4.m1.2.2.1.1.4.2.2.4.cmml"><mi mathvariant="normal" id="S3.E4.m1.2.2.1.1.4.2.2.4.2.2" xref="S3.E4.m1.2.2.1.1.4.2.2.4.2.2.cmml">ℓ</mi><mrow id="S3.E4.m1.2.2.1.1.4.2.2.4.3" xref="S3.E4.m1.2.2.1.1.4.2.2.4.3.cmml"><mi id="S3.E4.m1.2.2.1.1.4.2.2.4.3.2" xref="S3.E4.m1.2.2.1.1.4.2.2.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.4.2.2.4.3.1" xref="S3.E4.m1.2.2.1.1.4.2.2.4.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.1.1.4.2.2.4.3.3" xref="S3.E4.m1.2.2.1.1.4.2.2.4.3.3.cmml">l</mi></mrow><mi id="S3.E4.m1.2.2.1.1.4.2.2.4.2.3" xref="S3.E4.m1.2.2.1.1.4.2.2.4.2.3.cmml">pos</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.4.2.2.3" xref="S3.E4.m1.2.2.1.1.4.2.2.3.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.4.2.2.2.2" xref="S3.E4.m1.2.2.1.1.4.2.2.2.3.cmml"><mo id="S3.E4.m1.2.2.1.1.4.2.2.2.2.3" xref="S3.E4.m1.2.2.1.1.4.2.2.2.3.cmml">(</mo><msubsup id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E4.m1.2.2.1.1.4.2.2.2.2.4" xref="S3.E4.m1.2.2.1.1.4.2.2.2.3.cmml">,</mo><msup id="S3.E4.m1.2.2.1.1.4.2.2.2.2.2" xref="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.2" xref="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.3" xref="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.3.cmml">i</mi></msup><mo id="S3.E4.m1.2.2.1.1.4.2.2.2.2.5" xref="S3.E4.m1.2.2.1.1.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.5">assign</csymbol><apply id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2"><times id="S3.E4.m1.2.2.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.3"></times><apply id="S3.E4.m1.2.2.1.1.2.4.cmml" xref="S3.E4.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.4.1.cmml" xref="S3.E4.m1.2.2.1.1.2.4">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.2.4.2.cmml" xref="S3.E4.m1.2.2.1.1.2.4.2"><ci id="S3.E4.m1.2.2.1.1.2.4.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.4.2.1">^</ci><ci id="S3.E4.m1.2.2.1.1.2.4.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.4.2.2">ℛ</ci></apply><ci id="S3.E4.m1.2.2.1.1.2.4.3.cmml" xref="S3.E4.m1.2.2.1.1.2.4.3">pos</ci></apply><interval closure="open" id="S3.E4.m1.2.2.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2"><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2">𝒮</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2">𝑦</ci><ci id="S3.E4.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E4.m1.2.2.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.4"><times id="S3.E4.m1.2.2.1.1.4.3.cmml" xref="S3.E4.m1.2.2.1.1.4.3"></times><apply id="S3.E4.m1.2.2.1.1.4.4.cmml" xref="S3.E4.m1.2.2.1.1.4.4"><divide id="S3.E4.m1.2.2.1.1.4.4.1.cmml" xref="S3.E4.m1.2.2.1.1.4.4"></divide><cn type="integer" id="S3.E4.m1.2.2.1.1.4.4.2.cmml" xref="S3.E4.m1.2.2.1.1.4.4.2">1</cn><apply id="S3.E4.m1.2.2.1.1.4.4.3.cmml" xref="S3.E4.m1.2.2.1.1.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.4.4.3.1.cmml" xref="S3.E4.m1.2.2.1.1.4.4.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.4.4.3.2.cmml" xref="S3.E4.m1.2.2.1.1.4.4.3.2">𝑛</ci><ci id="S3.E4.m1.2.2.1.1.4.4.3.3.cmml" xref="S3.E4.m1.2.2.1.1.4.4.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.4.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2"><apply id="S3.E4.m1.2.2.1.1.4.2.3.cmml" xref="S3.E4.m1.2.2.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.4.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.4.2.3">subscript</csymbol><sum id="S3.E4.m1.2.2.1.1.4.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2.3.2"></sum><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><in id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></in><ci id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3">𝑗</ci><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝑛</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E4.m1.2.2.1.1.4.2.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2"><times id="S3.E4.m1.2.2.1.1.4.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.3"></times><apply id="S3.E4.m1.2.2.1.1.4.2.2.4.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.4.2.2.4.1.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.4.2.2.4.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.4.2.2.4.2.1.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.4.2.2.4.2.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4.2.2">ℓ</ci><ci id="S3.E4.m1.2.2.1.1.4.2.2.4.2.3.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4.2.3">pos</ci></apply><apply id="S3.E4.m1.2.2.1.1.4.2.2.4.3.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4.3"><times id="S3.E4.m1.2.2.1.1.4.2.2.4.3.1.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4.3.1"></times><ci id="S3.E4.m1.2.2.1.1.4.2.2.4.3.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4.3.2">𝑐</ci><ci id="S3.E4.m1.2.2.1.1.4.2.2.4.3.3.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.4.3.3">𝑙</ci></apply></apply><interval closure="open" id="S3.E4.m1.2.2.1.1.4.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.2.2"><apply id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.2">𝑦</ci><ci id="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.4.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">{\hat{\mathcal{R}}_{\mathrm{pos}}\left(\mathcal{S}^{i},y^{i}\right):=\frac{1}{n_{i}}\sum_{j\in\left[n_{i}\right]}\ell^{\mathrm{pos}}_{cl}\left(\mathbf{x}_{j}^{i},y^{i}\right).}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.6" class="ltx_p">To avoid the collapsing of class embedding matrix in our setting, we adopt the classic strategy that adds a geometric regularizer to let the matrix be spreadout, and the whole objective function is given as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.37" class="ltx_math_unparsed" alttext="\begin{split}&amp;\qquad\qquad\qquad\quad\min\limits_{\theta,W}\mathcal{L}(\mathcal{S};\theta,W),\\
&amp;\operatorname{s.t.}{\ \mathcal{L}}:=\sum_{i\in[m]}\frac{|\mathcal{S}^{i}|}{|\mathcal{S}|}\hat{\mathcal{R}}_{\mathrm{pos}}\left(\mathcal{S}^{i},y_{i}\right)+\lambda\cdot\mathrm{reg}(W),\\
\end{split}" display="block"><semantics id="S3.E5.m1.37a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E5.m1.37.37.3"><mtr id="S3.E5.m1.37.37.3a"><mtd id="S3.E5.m1.37.37.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.37.37.3c"><mrow id="S3.E5.m1.36.36.2.35.12.12.12"><mrow id="S3.E5.m1.36.36.2.35.12.12.12.1"><mrow id="S3.E5.m1.36.36.2.35.12.12.12.1.2"><munder id="S3.E5.m1.36.36.2.35.12.12.12.1.2.1"><mi id="S3.E5.m1.1.1.1.1.1.1">min</mi><mrow id="S3.E5.m1.2.2.2.2.2.2.1.4"><mi id="S3.E5.m1.2.2.2.2.2.2.1.1">θ</mi><mo id="S3.E5.m1.2.2.2.2.2.2.1.4.1">,</mo><mi id="S3.E5.m1.2.2.2.2.2.2.1.2">W</mi></mrow></munder><mo lspace="0.167em" id="S3.E5.m1.36.36.2.35.12.12.12.1.2a">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.3.3.3.3">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.36.36.2.35.12.12.12.1.1">​</mo><mrow id="S3.E5.m1.36.36.2.35.12.12.12.1.3"><mo stretchy="false" id="S3.E5.m1.4.4.4.4.4.4">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.5.5.5.5">𝒮</mi><mo id="S3.E5.m1.6.6.6.6.6.6">;</mo><mi id="S3.E5.m1.7.7.7.7.7.7">θ</mi><mo id="S3.E5.m1.8.8.8.8.8.8">,</mo><mi id="S3.E5.m1.9.9.9.9.9.9">W</mi><mo stretchy="false" id="S3.E5.m1.10.10.10.10.10.10">)</mo></mrow></mrow><mo id="S3.E5.m1.11.11.11.11.11.11">,</mo></mrow></mtd></mtr><mtr id="S3.E5.m1.37.37.3d"><mtd id="S3.E5.m1.37.37.3e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.37.37.3f"><mrow id="S3.E5.m1.37.37.3.36.24.24.24"><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1"><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1.3"><mrow id="S3.E5.m1.12.12.12.1.1.1"><mi mathvariant="normal" id="S3.E5.m1.12.12.12.1.1.1.1">s</mi><mo lspace="0em" rspace="0.167em" id="S3.E5.m1.12.12.12.1.1.1.3">.</mo><mi mathvariant="normal" id="S3.E5.m1.12.12.12.1.1.1.2">t</mi><mo lspace="0em" id="S3.E5.m1.12.12.12.1.1.1.4">.</mo></mrow><mo lspace="0.167em" id="S3.E5.m1.37.37.3.36.24.24.24.1.3a">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.13.13.13.2.2.2">ℒ</mi></mrow><mo lspace="0.278em" rspace="0.111em" id="S3.E5.m1.14.14.14.3.3.3">:=</mo><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1.2"><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1.2.2"><munder id="S3.E5.m1.37.37.3.36.24.24.24.1.2.2.3"><mo movablelimits="false" id="S3.E5.m1.15.15.15.4.4.4">∑</mo><mrow id="S3.E5.m1.16.16.16.5.5.5.1"><mi id="S3.E5.m1.16.16.16.5.5.5.1.3">i</mi><mo id="S3.E5.m1.16.16.16.5.5.5.1.2">∈</mo><mrow id="S3.E5.m1.16.16.16.5.5.5.1.4.2"><mo stretchy="false" id="S3.E5.m1.16.16.16.5.5.5.1.4.2.1">[</mo><mi id="S3.E5.m1.16.16.16.5.5.5.1.1">m</mi><mo stretchy="false" id="S3.E5.m1.16.16.16.5.5.5.1.4.2.2">]</mo></mrow></mrow></munder><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1.2.2.2"><mfrac id="S3.E5.m1.17.17.17.6.6.6"><mrow id="S3.E5.m1.17.17.17.6.6.6.1.1"><mo stretchy="false" id="S3.E5.m1.17.17.17.6.6.6.1.1.2">|</mo><msup id="S3.E5.m1.17.17.17.6.6.6.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.17.17.17.6.6.6.1.1.1.2">𝒮</mi><mi id="S3.E5.m1.17.17.17.6.6.6.1.1.1.3">i</mi></msup><mo stretchy="false" id="S3.E5.m1.17.17.17.6.6.6.1.1.3">|</mo></mrow><mrow id="S3.E5.m1.17.17.17.6.6.6.2.3"><mo stretchy="false" id="S3.E5.m1.17.17.17.6.6.6.2.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.17.17.17.6.6.6.2.1">𝒮</mi><mo stretchy="false" id="S3.E5.m1.17.17.17.6.6.6.2.3.2">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.37.37.3.36.24.24.24.1.2.2.2.3">​</mo><msub id="S3.E5.m1.37.37.3.36.24.24.24.1.2.2.2.4"><mover accent="true" id="S3.E5.m1.18.18.18.7.7.7"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.18.18.18.7.7.7.2">ℛ</mi><mo id="S3.E5.m1.18.18.18.7.7.7.1">^</mo></mover><mi id="S3.E5.m1.19.19.19.8.8.8.1">pos</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.37.37.3.36.24.24.24.1.2.2.2.3a">​</mo><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1.2.2.2.2.2"><mo id="S3.E5.m1.20.20.20.9.9.9">(</mo><msup id="S3.E5.m1.37.37.3.36.24.24.24.1.1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.21.21.21.10.10.10">𝒮</mi><mi id="S3.E5.m1.22.22.22.11.11.11.1">i</mi></msup><mo id="S3.E5.m1.23.23.23.12.12.12">,</mo><msub id="S3.E5.m1.37.37.3.36.24.24.24.1.2.2.2.2.2.2"><mi id="S3.E5.m1.24.24.24.13.13.13">y</mi><mi id="S3.E5.m1.25.25.25.14.14.14.1">i</mi></msub><mo id="S3.E5.m1.26.26.26.15.15.15">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.27.27.27.16.16.16">+</mo><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1.2.3"><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1.2.3.2"><mi id="S3.E5.m1.28.28.28.17.17.17">λ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.29.29.29.18.18.18">⋅</mo><mi id="S3.E5.m1.30.30.30.19.19.19">reg</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.37.37.3.36.24.24.24.1.2.3.1">​</mo><mrow id="S3.E5.m1.37.37.3.36.24.24.24.1.2.3.3"><mo stretchy="false" id="S3.E5.m1.31.31.31.20.20.20">(</mo><mi id="S3.E5.m1.32.32.32.21.21.21">W</mi><mo stretchy="false" id="S3.E5.m1.33.33.33.22.22.22">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.34.34.34.23.23.23">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S3.E5.m1.37b">\begin{split}&amp;\qquad\qquad\qquad\quad\min\limits_{\theta,W}\mathcal{L}(\mathcal{S};\theta,W),\\
&amp;\operatorname{s.t.}{\ \mathcal{L}}:=\sum_{i\in[m]}\frac{|\mathcal{S}^{i}|}{|\mathcal{S}|}\hat{\mathcal{R}}_{\mathrm{pos}}\left(\mathcal{S}^{i},y_{i}\right)+\lambda\cdot\mathrm{reg}(W),\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.5" class="ltx_p">where <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathcal{S}</annotation></semantics></math> is the union of all <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{S}^{i}" display="inline"><semantics id="S3.p2.2.m2.1a"><msup id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">𝒮</mi><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝒮</ci><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathcal{S}^{i}</annotation></semantics></math>, and <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\lambda\geq 0" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">λ</mi><mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">≥</mo><mn id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><geq id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"></geq><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝜆</ci><cn type="integer" id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\lambda\geq 0</annotation></semantics></math> is the balancing parameter. The objective is to minimize both the sum of all clients’ empirical risks and the structure risk w.r.t. the class embedding matrix. The former term encourages instance embeddings <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="g_{\bm{\theta}}(\mathbf{x}^{i})" display="inline"><semantics id="S3.p2.4.m4.1a"><mrow id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><msub id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml"><mi id="S3.p2.4.m4.1.1.3.2" xref="S3.p2.4.m4.1.1.3.2.cmml">g</mi><mi id="S3.p2.4.m4.1.1.3.3" xref="S3.p2.4.m4.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">​</mo><mrow id="S3.p2.4.m4.1.1.1.1" xref="S3.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.4.m4.1.1.1.1.2" xref="S3.p2.4.m4.1.1.1.1.1.cmml">(</mo><msup id="S3.p2.4.m4.1.1.1.1.1" xref="S3.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.p2.4.m4.1.1.1.1.1.2" xref="S3.p2.4.m4.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.p2.4.m4.1.1.1.1.1.3" xref="S3.p2.4.m4.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.p2.4.m4.1.1.1.1.3" xref="S3.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><times id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2"></times><apply id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.3.1.cmml" xref="S3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.p2.4.m4.1.1.3.2.cmml" xref="S3.p2.4.m4.1.1.3.2">𝑔</ci><ci id="S3.p2.4.m4.1.1.3.3.cmml" xref="S3.p2.4.m4.1.1.3.3">𝜽</ci></apply><apply id="S3.p2.4.m4.1.1.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1.1">superscript</csymbol><ci id="S3.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.p2.4.m4.1.1.1.1.1.2">𝐱</ci><ci id="S3.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.p2.4.m4.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">g_{\bm{\theta}}(\mathbf{x}^{i})</annotation></semantics></math> to be close to the corresponding class embedding <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{w}_{y^{i}}" display="inline"><semantics id="S3.p2.5.m5.1a"><msub id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">𝐰</mi><msup id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml"><mi id="S3.p2.5.m5.1.1.3.2" xref="S3.p2.5.m5.1.1.3.2.cmml">y</mi><mi id="S3.p2.5.m5.1.1.3.3" xref="S3.p2.5.m5.1.1.3.3.cmml">i</mi></msup></msub><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝐰</ci><apply id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.3.1.cmml" xref="S3.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.p2.5.m5.1.1.3.2.cmml" xref="S3.p2.5.m5.1.1.3.2">𝑦</ci><ci id="S3.p2.5.m5.1.1.3.3.cmml" xref="S3.p2.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\mathbf{w}_{y^{i}}</annotation></semantics></math>, which is performed on the client. The latter disperses the class embedding matrix, which is performed on the server.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Federated Averaging by Exploring Label Correlations</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we propose methods that leverage label correlations to alleviate the issue of the model collapsing in FL with only positive labels. Initially, we introduce the most related work FedAwS, which employs a geometric regularizer to encourage class embeddings to be distinct from each other. Subsequently, we present the Federated Averaging by exploring the Label Correlations (FedALC) algorithm, wherein the server optimizes a correlation regularizer utilizing negative label pairs in each FL round. Through the correlation regularizer, the server can obtain a matrix where positive class embeddings are distanced
from negative class embeddings. To expedite convergence and reduce the communication round, we devise a novel correlation regularizer that learns a fixed class embedding matrix by incorporating both positive and negative label pairs before the model training (FedALC-fixed). We then conduct an analysis of the convergence and optimality of our proposed method. Lastly, we introduce a label collection method to obtain the label correlations safely.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Discussion on FedAwS</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Based on the FedAvg framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, a recent work termed Federated Averaging with Spreadout (FedAwS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is presented to handle this federated setting that clients have only access to the positive data for a single class. To address the challenge, the FedAwS framework uses a spreadout strategy to optimize the class embedding matrix, which can disperse the embedding matrix and alleviate the issue of collapsing. This is achieved by letting the server perform an geometric regularizer to ensure that class embeddings are separated from each other, in addition to averaging shared model parameters.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.16" class="ltx_p">This process can be formulated as applying the following geometric regularization in each communication round on the server:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.5" class="ltx_Math" alttext="\operatorname{reg}_{\mathrm{sp}}(W)=\sum_{u\in[K]}\sum_{u^{\prime}\neq u}\left(\max\left(0,\nu-d\left(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}}\right)\right)\right)^{2}," display="block"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.2.cmml"><msub id="S4.E6.m1.5.5.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.1.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.1.1.2.cmml">reg</mi><mi id="S4.E6.m1.5.5.1.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.1.1.1.3.cmml">sp</mi></msub><mo id="S4.E6.m1.5.5.1.1.1.1a" xref="S4.E6.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.5.5.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.1.1.1.1.2.1" xref="S4.E6.m1.5.5.1.1.1.2.cmml">(</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">W</mi><mo stretchy="false" id="S4.E6.m1.5.5.1.1.1.1.2.2" xref="S4.E6.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E6.m1.5.5.1.1.3" xref="S4.E6.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E6.m1.5.5.1.1.2" xref="S4.E6.m1.5.5.1.1.2.cmml"><munder id="S4.E6.m1.5.5.1.1.2.2" xref="S4.E6.m1.5.5.1.1.2.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E6.m1.5.5.1.1.2.2.2" xref="S4.E6.m1.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3.cmml">u</mi><mo id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml">∈</mo><mrow id="S4.E6.m1.1.1.1.4.2" xref="S4.E6.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.4.2.1" xref="S4.E6.m1.1.1.1.4.1.1.cmml">[</mo><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">K</mi><mo stretchy="false" id="S4.E6.m1.1.1.1.4.2.2" xref="S4.E6.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder><mrow id="S4.E6.m1.5.5.1.1.2.1" xref="S4.E6.m1.5.5.1.1.2.1.cmml"><munder id="S4.E6.m1.5.5.1.1.2.1.2" xref="S4.E6.m1.5.5.1.1.2.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E6.m1.5.5.1.1.2.1.2.2" xref="S4.E6.m1.5.5.1.1.2.1.2.2.cmml">∑</mo><mrow id="S4.E6.m1.5.5.1.1.2.1.2.3" xref="S4.E6.m1.5.5.1.1.2.1.2.3.cmml"><msup id="S4.E6.m1.5.5.1.1.2.1.2.3.2" xref="S4.E6.m1.5.5.1.1.2.1.2.3.2.cmml"><mi id="S4.E6.m1.5.5.1.1.2.1.2.3.2.2" xref="S4.E6.m1.5.5.1.1.2.1.2.3.2.2.cmml">u</mi><mo id="S4.E6.m1.5.5.1.1.2.1.2.3.2.3" xref="S4.E6.m1.5.5.1.1.2.1.2.3.2.3.cmml">′</mo></msup><mo id="S4.E6.m1.5.5.1.1.2.1.2.3.1" xref="S4.E6.m1.5.5.1.1.2.1.2.3.1.cmml">≠</mo><mi id="S4.E6.m1.5.5.1.1.2.1.2.3.3" xref="S4.E6.m1.5.5.1.1.2.1.2.3.3.cmml">u</mi></mrow></munder><msup id="S4.E6.m1.5.5.1.1.2.1.1" xref="S4.E6.m1.5.5.1.1.2.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1.2.1.1.1.1" xref="S4.E6.m1.5.5.1.1.2.1.1.cmml"><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.2.1.1.cmml">(</mo><mrow id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">max</mi><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1a" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml"><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">(</mo><mn id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml">0</mn><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">,</mo><mrow id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.4" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.4.cmml">ν</mi><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.4" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐰</mi><msup id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">u</mi><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">′</mo></msup></msub><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.5" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.4" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.5.5.1.1.2.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.2.1.1.cmml">)</mo></mrow><mn id="S4.E6.m1.5.5.1.1.2.1.1.3" xref="S4.E6.m1.5.5.1.1.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S4.E6.m1.5.5.1.2" xref="S4.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1"><eq id="S4.E6.m1.5.5.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.3"></eq><apply id="S4.E6.m1.5.5.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1"><apply id="S4.E6.m1.5.5.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.2">reg</ci><ci id="S4.E6.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.3">sp</ci></apply><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝑊</ci></apply><apply id="S4.E6.m1.5.5.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2"><apply id="S4.E6.m1.5.5.1.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2.2">subscript</csymbol><sum id="S4.E6.m1.5.5.1.1.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.2.2"></sum><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><in id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></in><ci id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3">𝑢</ci><apply id="S4.E6.m1.1.1.1.4.1.cmml" xref="S4.E6.m1.1.1.1.4.2"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.4.1.1.cmml" xref="S4.E6.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝐾</ci></apply></apply></apply><apply id="S4.E6.m1.5.5.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1"><apply id="S4.E6.m1.5.5.1.1.2.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2">subscript</csymbol><sum id="S4.E6.m1.5.5.1.1.2.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2.2"></sum><apply id="S4.E6.m1.5.5.1.1.2.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2.3"><neq id="S4.E6.m1.5.5.1.1.2.1.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2.3.1"></neq><apply id="S4.E6.m1.5.5.1.1.2.1.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.2.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2.3.2">superscript</csymbol><ci id="S4.E6.m1.5.5.1.1.2.1.2.3.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2.3.2.2">𝑢</ci><ci id="S4.E6.m1.5.5.1.1.2.1.2.3.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2.3.2.3">′</ci></apply><ci id="S4.E6.m1.5.5.1.1.2.1.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.2.3.3">𝑢</ci></apply></apply><apply id="S4.E6.m1.5.5.1.1.2.1.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1">superscript</csymbol><apply id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1"><max id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3"></max><cn type="integer" id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4">0</cn><apply id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1"><minus id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3"></minus><ci id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.4">𝜈</ci><apply id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2"><times id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.3"></times><ci id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.4">𝑑</ci><interval closure="open" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2"><apply id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐰</ci><apply id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.2">𝑢</ci><ci id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.3">′</ci></apply></apply></interval></apply></apply></apply><cn type="integer" id="S4.E6.m1.5.5.1.1.2.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">\operatorname{reg}_{\mathrm{sp}}(W)=\sum_{u\in[K]}\sum_{u^{\prime}\neq u}\left(\max\left(0,\nu-d\left(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}}\right)\right)\right)^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.2" class="ltx_p">where <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">K</annotation></semantics></math> is the number of classes. Since the hyper-parameter <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\nu" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">ν</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝜈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\nu</annotation></semantics></math> may be very hard to choose, FedAwS also reformulate (3) as:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.3" class="ltx_math_unparsed" alttext="\operatorname{reg}_{\mathrm{sp}}^{\mathrm{top}}(W)=\sum_{u\in[K]}\sum_{u^{\prime}\in\mathcal{K}^{\prime},\atop u^{\prime}\neq u}-\left(d\left(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}}\right)\right)^{2}\cdot\llbracket u^{\prime}\in\mathcal{N}_{k}(u)\rrbracket," display="block"><semantics id="S4.E7.m1.3a"><mrow id="S4.E7.m1.3b"><msubsup id="S4.E7.m1.3.4"><mi id="S4.E7.m1.3.4.2.2">reg</mi><mi id="S4.E7.m1.3.4.2.3">sp</mi><mi id="S4.E7.m1.3.4.3">top</mi></msubsup><mrow id="S4.E7.m1.3.5"><mo stretchy="false" id="S4.E7.m1.3.5.1">(</mo><mi id="S4.E7.m1.2.2">W</mi><mo stretchy="false" id="S4.E7.m1.3.5.2">)</mo></mrow><mo rspace="0.111em" id="S4.E7.m1.3.6">=</mo><munder id="S4.E7.m1.3.7"><mo movablelimits="false" rspace="0em" id="S4.E7.m1.3.7.2">∑</mo><mrow id="S4.E7.m1.1.1.1"><mi id="S4.E7.m1.1.1.1.3">u</mi><mo id="S4.E7.m1.1.1.1.2">∈</mo><mrow id="S4.E7.m1.1.1.1.4.2"><mo stretchy="false" id="S4.E7.m1.1.1.1.4.2.1">[</mo><mi id="S4.E7.m1.1.1.1.1">K</mi><mo stretchy="false" id="S4.E7.m1.1.1.1.4.2.2">]</mo></mrow></mrow></munder><munder id="S4.E7.m1.3.8"><mo movablelimits="false" rspace="0em" id="S4.E7.m1.3.8.2">∑</mo><mfrac linethickness="0pt" id="S4.E7.m1.3.8.3"><mrow id="S4.E7.m1.3.8.3.2"><msup id="S4.E7.m1.3.8.3.2.1"><mi id="S4.E7.m1.3.8.3.2.1.2">u</mi><mo id="S4.E7.m1.3.8.3.2.1.3">′</mo></msup><mo id="S4.E7.m1.3.8.3.2.2">∈</mo><msup id="S4.E7.m1.3.8.3.2.3"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.3.8.3.2.3.2">𝒦</mi><mo id="S4.E7.m1.3.8.3.2.3.3">′</mo></msup><mo id="S4.E7.m1.3.8.3.2.4">,</mo></mrow><mrow id="S4.E7.m1.3.8.3.3"><msup id="S4.E7.m1.3.8.3.3.2"><mi id="S4.E7.m1.3.8.3.3.2.2">u</mi><mo id="S4.E7.m1.3.8.3.3.2.3">′</mo></msup><mo id="S4.E7.m1.3.8.3.3.1">≠</mo><mi id="S4.E7.m1.3.8.3.3.3">u</mi></mrow></mfrac></munder><mo lspace="0em" id="S4.E7.m1.3.9">−</mo><msup id="S4.E7.m1.3.10"><mrow id="S4.E7.m1.3.10.2"><mo id="S4.E7.m1.3.10.2.1">(</mo><mi id="S4.E7.m1.3.10.2.2">d</mi><mrow id="S4.E7.m1.3.10.2.3"><mo id="S4.E7.m1.3.10.2.3.1">(</mo><msub id="S4.E7.m1.3.10.2.3.2"><mi id="S4.E7.m1.3.10.2.3.2.2">𝐰</mi><mi id="S4.E7.m1.3.10.2.3.2.3">u</mi></msub><mo id="S4.E7.m1.3.10.2.3.3">,</mo><msub id="S4.E7.m1.3.10.2.3.4"><mi id="S4.E7.m1.3.10.2.3.4.2">𝐰</mi><msup id="S4.E7.m1.3.10.2.3.4.3"><mi id="S4.E7.m1.3.10.2.3.4.3.2">u</mi><mo id="S4.E7.m1.3.10.2.3.4.3.3">′</mo></msup></msub><mo id="S4.E7.m1.3.10.2.3.5">)</mo></mrow><mo rspace="0.055em" id="S4.E7.m1.3.10.2.4">)</mo></mrow><mn id="S4.E7.m1.3.10.3">2</mn></msup><mo rspace="0.222em" id="S4.E7.m1.3.11">⋅</mo><mrow id="S4.E7.m1.3.12"><mo stretchy="false" id="S4.E7.m1.3.12.1">⟦</mo><msup id="S4.E7.m1.3.12.2"><mi id="S4.E7.m1.3.12.2.2">u</mi><mo id="S4.E7.m1.3.12.2.3">′</mo></msup><mo id="S4.E7.m1.3.12.3">∈</mo><msub id="S4.E7.m1.3.12.4"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.3.12.4.2">𝒩</mi><mi id="S4.E7.m1.3.12.4.3">k</mi></msub><mrow id="S4.E7.m1.3.12.5"><mo stretchy="false" id="S4.E7.m1.3.12.5.1">(</mo><mi id="S4.E7.m1.3.3">u</mi><mo stretchy="false" id="S4.E7.m1.3.12.5.2">)</mo></mrow><mo stretchy="false" id="S4.E7.m1.3.12.6">⟧</mo></mrow><mo id="S4.E7.m1.3.13">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E7.m1.3c">\operatorname{reg}_{\mathrm{sp}}^{\mathrm{top}}(W)=\sum_{u\in[K]}\sum_{u^{\prime}\in\mathcal{K}^{\prime},\atop u^{\prime}\neq u}-\left(d\left(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}}\right)\right)^{2}\cdot\llbracket u^{\prime}\in\mathcal{N}_{k}(u)\rrbracket,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.15" class="ltx_p">where <math id="S4.SS1.p2.3.m1.1" class="ltx_Math" alttext="\mathcal{K}^{\prime}" display="inline"><semantics id="S4.SS1.p2.3.m1.1a"><msup id="S4.SS1.p2.3.m1.1.1" xref="S4.SS1.p2.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.3.m1.1.1.2" xref="S4.SS1.p2.3.m1.1.1.2.cmml">𝒦</mi><mo id="S4.SS1.p2.3.m1.1.1.3" xref="S4.SS1.p2.3.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m1.1b"><apply id="S4.SS1.p2.3.m1.1.1.cmml" xref="S4.SS1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m1.1.1.1.cmml" xref="S4.SS1.p2.3.m1.1.1">superscript</csymbol><ci id="S4.SS1.p2.3.m1.1.1.2.cmml" xref="S4.SS1.p2.3.m1.1.1.2">𝒦</ci><ci id="S4.SS1.p2.3.m1.1.1.3.cmml" xref="S4.SS1.p2.3.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m1.1c">\mathcal{K}^{\prime}</annotation></semantics></math> is a subset of classes, and <math id="S4.SS1.p2.4.m2.1" class="ltx_Math" alttext="\mathcal{N}_{k}(u)" display="inline"><semantics id="S4.SS1.p2.4.m2.1a"><mrow id="S4.SS1.p2.4.m2.1.2" xref="S4.SS1.p2.4.m2.1.2.cmml"><msub id="S4.SS1.p2.4.m2.1.2.2" xref="S4.SS1.p2.4.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.4.m2.1.2.2.2" xref="S4.SS1.p2.4.m2.1.2.2.2.cmml">𝒩</mi><mi id="S4.SS1.p2.4.m2.1.2.2.3" xref="S4.SS1.p2.4.m2.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p2.4.m2.1.2.1" xref="S4.SS1.p2.4.m2.1.2.1.cmml">​</mo><mrow id="S4.SS1.p2.4.m2.1.2.3.2" xref="S4.SS1.p2.4.m2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.4.m2.1.2.3.2.1" xref="S4.SS1.p2.4.m2.1.2.cmml">(</mo><mi id="S4.SS1.p2.4.m2.1.1" xref="S4.SS1.p2.4.m2.1.1.cmml">u</mi><mo stretchy="false" id="S4.SS1.p2.4.m2.1.2.3.2.2" xref="S4.SS1.p2.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m2.1b"><apply id="S4.SS1.p2.4.m2.1.2.cmml" xref="S4.SS1.p2.4.m2.1.2"><times id="S4.SS1.p2.4.m2.1.2.1.cmml" xref="S4.SS1.p2.4.m2.1.2.1"></times><apply id="S4.SS1.p2.4.m2.1.2.2.cmml" xref="S4.SS1.p2.4.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m2.1.2.2.1.cmml" xref="S4.SS1.p2.4.m2.1.2.2">subscript</csymbol><ci id="S4.SS1.p2.4.m2.1.2.2.2.cmml" xref="S4.SS1.p2.4.m2.1.2.2.2">𝒩</ci><ci id="S4.SS1.p2.4.m2.1.2.2.3.cmml" xref="S4.SS1.p2.4.m2.1.2.2.3">𝑘</ci></apply><ci id="S4.SS1.p2.4.m2.1.1.cmml" xref="S4.SS1.p2.4.m2.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m2.1c">\mathcal{N}_{k}(u)</annotation></semantics></math> is the set of <math id="S4.SS1.p2.5.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p2.5.m3.1a"><mi id="S4.SS1.p2.5.m3.1.1" xref="S4.SS1.p2.5.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m3.1b"><ci id="S4.SS1.p2.5.m3.1.1.cmml" xref="S4.SS1.p2.5.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m3.1c">k</annotation></semantics></math> classes that are close to the class <math id="S4.SS1.p2.6.m4.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS1.p2.6.m4.1a"><mi id="S4.SS1.p2.6.m4.1.1" xref="S4.SS1.p2.6.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m4.1b"><ci id="S4.SS1.p2.6.m4.1.1.cmml" xref="S4.SS1.p2.6.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m4.1c">u</annotation></semantics></math> in the embedding space.
The relationship of equation (11) and (12) comes from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. According to Section 4.2 in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, by adaptively setting hyperparameter <math id="S4.SS1.p2.7.m5.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S4.SS1.p2.7.m5.1a"><mi id="S4.SS1.p2.7.m5.1.1" xref="S4.SS1.p2.7.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m5.1b"><ci id="S4.SS1.p2.7.m5.1.1.cmml" xref="S4.SS1.p2.7.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m5.1c">v</annotation></semantics></math> to be the distance between the class <math id="S4.SS1.p2.8.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p2.8.m6.1a"><mi id="S4.SS1.p2.8.m6.1.1" xref="S4.SS1.p2.8.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m6.1b"><ci id="S4.SS1.p2.8.m6.1.1.cmml" xref="S4.SS1.p2.8.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m6.1c">c</annotation></semantics></math>’s embedding <math id="S4.SS1.p2.9.m7.1" class="ltx_Math" alttext="w_{c}" display="inline"><semantics id="S4.SS1.p2.9.m7.1a"><msub id="S4.SS1.p2.9.m7.1.1" xref="S4.SS1.p2.9.m7.1.1.cmml"><mi id="S4.SS1.p2.9.m7.1.1.2" xref="S4.SS1.p2.9.m7.1.1.2.cmml">w</mi><mi id="S4.SS1.p2.9.m7.1.1.3" xref="S4.SS1.p2.9.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m7.1b"><apply id="S4.SS1.p2.9.m7.1.1.cmml" xref="S4.SS1.p2.9.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m7.1.1.1.cmml" xref="S4.SS1.p2.9.m7.1.1">subscript</csymbol><ci id="S4.SS1.p2.9.m7.1.1.2.cmml" xref="S4.SS1.p2.9.m7.1.1.2">𝑤</ci><ci id="S4.SS1.p2.9.m7.1.1.3.cmml" xref="S4.SS1.p2.9.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m7.1c">w_{c}</annotation></semantics></math> and its <math id="S4.SS1.p2.10.m8.1" class="ltx_Math" alttext="(k+1)-" display="inline"><semantics id="S4.SS1.p2.10.m8.1a"><mrow id="S4.SS1.p2.10.m8.1.1" xref="S4.SS1.p2.10.m8.1.1.cmml"><mrow id="S4.SS1.p2.10.m8.1.1.1.1" xref="S4.SS1.p2.10.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.10.m8.1.1.1.1.2" xref="S4.SS1.p2.10.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.10.m8.1.1.1.1.1" xref="S4.SS1.p2.10.m8.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.10.m8.1.1.1.1.1.2" xref="S4.SS1.p2.10.m8.1.1.1.1.1.2.cmml">k</mi><mo id="S4.SS1.p2.10.m8.1.1.1.1.1.1" xref="S4.SS1.p2.10.m8.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS1.p2.10.m8.1.1.1.1.1.3" xref="S4.SS1.p2.10.m8.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS1.p2.10.m8.1.1.1.1.3" xref="S4.SS1.p2.10.m8.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS1.p2.10.m8.1.1.3" xref="S4.SS1.p2.10.m8.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m8.1b"><apply id="S4.SS1.p2.10.m8.1.1.cmml" xref="S4.SS1.p2.10.m8.1.1"><csymbol cd="latexml" id="S4.SS1.p2.10.m8.1.1.2.cmml" xref="S4.SS1.p2.10.m8.1.1">limit-from</csymbol><apply id="S4.SS1.p2.10.m8.1.1.1.1.1.cmml" xref="S4.SS1.p2.10.m8.1.1.1.1"><plus id="S4.SS1.p2.10.m8.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.10.m8.1.1.1.1.1.1"></plus><ci id="S4.SS1.p2.10.m8.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.10.m8.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="S4.SS1.p2.10.m8.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.10.m8.1.1.1.1.1.3">1</cn></apply><minus id="S4.SS1.p2.10.m8.1.1.3.cmml" xref="S4.SS1.p2.10.m8.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m8.1c">(k+1)-</annotation></semantics></math>th closest class’s embedding, we have the term <math id="S4.SS1.p2.11.m9.5" class="ltx_Math" alttext="\max\left\{0,v-d(w_{c},w_{c^{{}^{\prime}}})\right\}=0,\forall c^{{}^{\prime}}\notin\mathcal{N}_{k}(c)" display="inline"><semantics id="S4.SS1.p2.11.m9.5a"><mrow id="S4.SS1.p2.11.m9.5.5.2" xref="S4.SS1.p2.11.m9.5.5.3.cmml"><mrow id="S4.SS1.p2.11.m9.4.4.1.1" xref="S4.SS1.p2.11.m9.4.4.1.1.cmml"><mrow id="S4.SS1.p2.11.m9.4.4.1.1.1.1" xref="S4.SS1.p2.11.m9.4.4.1.1.1.2.cmml"><mi id="S4.SS1.p2.11.m9.1.1" xref="S4.SS1.p2.11.m9.1.1.cmml">max</mi><mo id="S4.SS1.p2.11.m9.4.4.1.1.1.1a" xref="S4.SS1.p2.11.m9.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1" xref="S4.SS1.p2.11.m9.4.4.1.1.1.2.cmml"><mo id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.2" xref="S4.SS1.p2.11.m9.4.4.1.1.1.2.cmml">{</mo><mn id="S4.SS1.p2.11.m9.2.2" xref="S4.SS1.p2.11.m9.2.2.cmml">0</mn><mo id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.3" xref="S4.SS1.p2.11.m9.4.4.1.1.1.2.cmml">,</mo><mrow id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.4" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.4.cmml">v</mi><mo id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.3" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.4" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.3" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.3" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.4" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.2" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml">w</mi><msup id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.2" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.2.cmml">c</mi><msup id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3a" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml"></mi><mo id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3.1" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml">′</mo></msup></msup></msub><mo stretchy="false" id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.5" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.4" xref="S4.SS1.p2.11.m9.4.4.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S4.SS1.p2.11.m9.4.4.1.1.2" xref="S4.SS1.p2.11.m9.4.4.1.1.2.cmml">=</mo><mn id="S4.SS1.p2.11.m9.4.4.1.1.3" xref="S4.SS1.p2.11.m9.4.4.1.1.3.cmml">0</mn></mrow><mo id="S4.SS1.p2.11.m9.5.5.2.3" xref="S4.SS1.p2.11.m9.5.5.3a.cmml">,</mo><mrow id="S4.SS1.p2.11.m9.5.5.2.2" xref="S4.SS1.p2.11.m9.5.5.2.2.cmml"><mrow id="S4.SS1.p2.11.m9.5.5.2.2.2" xref="S4.SS1.p2.11.m9.5.5.2.2.2.cmml"><mo rspace="0.167em" id="S4.SS1.p2.11.m9.5.5.2.2.2.1" xref="S4.SS1.p2.11.m9.5.5.2.2.2.1.cmml">∀</mo><msup id="S4.SS1.p2.11.m9.5.5.2.2.2.2" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2.cmml"><mi id="S4.SS1.p2.11.m9.5.5.2.2.2.2.2" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2.2.cmml">c</mi><msup id="S4.SS1.p2.11.m9.5.5.2.2.2.2.3" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.11.m9.5.5.2.2.2.2.3a" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2.3.cmml"></mi><mo id="S4.SS1.p2.11.m9.5.5.2.2.2.2.3.1" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2.3.1.cmml">′</mo></msup></msup></mrow><mo id="S4.SS1.p2.11.m9.5.5.2.2.1" xref="S4.SS1.p2.11.m9.5.5.2.2.1.cmml">∉</mo><mrow id="S4.SS1.p2.11.m9.5.5.2.2.3" xref="S4.SS1.p2.11.m9.5.5.2.2.3.cmml"><msub id="S4.SS1.p2.11.m9.5.5.2.2.3.2" xref="S4.SS1.p2.11.m9.5.5.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.11.m9.5.5.2.2.3.2.2" xref="S4.SS1.p2.11.m9.5.5.2.2.3.2.2.cmml">𝒩</mi><mi id="S4.SS1.p2.11.m9.5.5.2.2.3.2.3" xref="S4.SS1.p2.11.m9.5.5.2.2.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p2.11.m9.5.5.2.2.3.1" xref="S4.SS1.p2.11.m9.5.5.2.2.3.1.cmml">​</mo><mrow id="S4.SS1.p2.11.m9.5.5.2.2.3.3.2" xref="S4.SS1.p2.11.m9.5.5.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.11.m9.5.5.2.2.3.3.2.1" xref="S4.SS1.p2.11.m9.5.5.2.2.3.cmml">(</mo><mi id="S4.SS1.p2.11.m9.3.3" xref="S4.SS1.p2.11.m9.3.3.cmml">c</mi><mo stretchy="false" id="S4.SS1.p2.11.m9.5.5.2.2.3.3.2.2" xref="S4.SS1.p2.11.m9.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m9.5b"><apply id="S4.SS1.p2.11.m9.5.5.3.cmml" xref="S4.SS1.p2.11.m9.5.5.2"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m9.5.5.3a.cmml" xref="S4.SS1.p2.11.m9.5.5.2.3">formulae-sequence</csymbol><apply id="S4.SS1.p2.11.m9.4.4.1.1.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1"><eq id="S4.SS1.p2.11.m9.4.4.1.1.2.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.2"></eq><apply id="S4.SS1.p2.11.m9.4.4.1.1.1.2.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1"><max id="S4.SS1.p2.11.m9.1.1.cmml" xref="S4.SS1.p2.11.m9.1.1"></max><cn type="integer" id="S4.SS1.p2.11.m9.2.2.cmml" xref="S4.SS1.p2.11.m9.2.2">0</cn><apply id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1"><minus id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.3"></minus><ci id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.4.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.4">𝑣</ci><apply id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2"><times id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.3"></times><ci id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.4.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.4">𝑑</ci><interval closure="open" id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2"><apply id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.2">𝑤</ci><apply id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.2">𝑐</ci><apply id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3"><ci id="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.1.1.1.1.2.2.2.2.3.3.1">′</ci></apply></apply></apply></interval></apply></apply></apply><cn type="integer" id="S4.SS1.p2.11.m9.4.4.1.1.3.cmml" xref="S4.SS1.p2.11.m9.4.4.1.1.3">0</cn></apply><apply id="S4.SS1.p2.11.m9.5.5.2.2.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2"><notin id="S4.SS1.p2.11.m9.5.5.2.2.1.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.1"></notin><apply id="S4.SS1.p2.11.m9.5.5.2.2.2.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.2"><csymbol cd="latexml" id="S4.SS1.p2.11.m9.5.5.2.2.2.1.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.2.1">for-all</csymbol><apply id="S4.SS1.p2.11.m9.5.5.2.2.2.2.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m9.5.5.2.2.2.2.1.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p2.11.m9.5.5.2.2.2.2.2.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2.2">𝑐</ci><apply id="S4.SS1.p2.11.m9.5.5.2.2.2.2.3.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2.3"><ci id="S4.SS1.p2.11.m9.5.5.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.2.2.3.1">′</ci></apply></apply></apply><apply id="S4.SS1.p2.11.m9.5.5.2.2.3.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.3"><times id="S4.SS1.p2.11.m9.5.5.2.2.3.1.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.3.1"></times><apply id="S4.SS1.p2.11.m9.5.5.2.2.3.2.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m9.5.5.2.2.3.2.1.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.3.2">subscript</csymbol><ci id="S4.SS1.p2.11.m9.5.5.2.2.3.2.2.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.3.2.2">𝒩</ci><ci id="S4.SS1.p2.11.m9.5.5.2.2.3.2.3.cmml" xref="S4.SS1.p2.11.m9.5.5.2.2.3.2.3">𝑘</ci></apply><ci id="S4.SS1.p2.11.m9.3.3.cmml" xref="S4.SS1.p2.11.m9.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m9.5c">\max\left\{0,v-d(w_{c},w_{c^{{}^{\prime}}})\right\}=0,\forall c^{{}^{\prime}}\notin\mathcal{N}_{k}(c)</annotation></semantics></math> and <math id="S4.SS1.p2.12.m10.5" class="ltx_Math" alttext="\max\left\{0,v-d(w_{c},w_{c^{{}^{\prime}}})\right\}=v-d(w_{c},w_{c^{{}^{\prime}}}),\forall c^{{}^{\prime}}\in\mathcal{N}_{k}(c)" display="inline"><semantics id="S4.SS1.p2.12.m10.5a"><mrow id="S4.SS1.p2.12.m10.5.5.2" xref="S4.SS1.p2.12.m10.5.5.3.cmml"><mrow id="S4.SS1.p2.12.m10.4.4.1.1" xref="S4.SS1.p2.12.m10.4.4.1.1.cmml"><mrow id="S4.SS1.p2.12.m10.4.4.1.1.1.1" xref="S4.SS1.p2.12.m10.4.4.1.1.1.2.cmml"><mi id="S4.SS1.p2.12.m10.1.1" xref="S4.SS1.p2.12.m10.1.1.cmml">max</mi><mo id="S4.SS1.p2.12.m10.4.4.1.1.1.1a" xref="S4.SS1.p2.12.m10.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1" xref="S4.SS1.p2.12.m10.4.4.1.1.1.2.cmml"><mo id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.2" xref="S4.SS1.p2.12.m10.4.4.1.1.1.2.cmml">{</mo><mn id="S4.SS1.p2.12.m10.2.2" xref="S4.SS1.p2.12.m10.2.2.cmml">0</mn><mo id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.3" xref="S4.SS1.p2.12.m10.4.4.1.1.1.2.cmml">,</mo><mrow id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.4" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.4.cmml">v</mi><mo id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.3" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.4" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.3" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.3" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.4" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.2" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml">w</mi><msup id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.2" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.2.cmml">c</mi><msup id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3a" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml"></mi><mo id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3.1" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml">′</mo></msup></msup></msub><mo stretchy="false" id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.5" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.4" xref="S4.SS1.p2.12.m10.4.4.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S4.SS1.p2.12.m10.4.4.1.1.4" xref="S4.SS1.p2.12.m10.4.4.1.1.4.cmml">=</mo><mrow id="S4.SS1.p2.12.m10.4.4.1.1.3" xref="S4.SS1.p2.12.m10.4.4.1.1.3.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.3.4" xref="S4.SS1.p2.12.m10.4.4.1.1.3.4.cmml">v</mi><mo id="S4.SS1.p2.12.m10.4.4.1.1.3.3" xref="S4.SS1.p2.12.m10.4.4.1.1.3.3.cmml">−</mo><mrow id="S4.SS1.p2.12.m10.4.4.1.1.3.2" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.3.2.4" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.12.m10.4.4.1.1.3.2.3" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.3.cmml">​</mo><mrow id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.3" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.3.cmml">(</mo><msub id="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1" xref="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.2" xref="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.2.cmml">w</mi><mi id="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.3" xref="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.4" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.3.cmml">,</mo><msub id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.2" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.2.cmml">w</mi><msup id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.2" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.2.cmml">c</mi><msup id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3.cmml"><mi id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3a" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3.cmml"></mi><mo id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3.1" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3.1.cmml">′</mo></msup></msup></msub><mo stretchy="false" id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.5" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.SS1.p2.12.m10.5.5.2.3" xref="S4.SS1.p2.12.m10.5.5.3a.cmml">,</mo><mrow id="S4.SS1.p2.12.m10.5.5.2.2" xref="S4.SS1.p2.12.m10.5.5.2.2.cmml"><mrow id="S4.SS1.p2.12.m10.5.5.2.2.2" xref="S4.SS1.p2.12.m10.5.5.2.2.2.cmml"><mo rspace="0.167em" id="S4.SS1.p2.12.m10.5.5.2.2.2.1" xref="S4.SS1.p2.12.m10.5.5.2.2.2.1.cmml">∀</mo><msup id="S4.SS1.p2.12.m10.5.5.2.2.2.2" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2.cmml"><mi id="S4.SS1.p2.12.m10.5.5.2.2.2.2.2" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2.2.cmml">c</mi><msup id="S4.SS1.p2.12.m10.5.5.2.2.2.2.3" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.12.m10.5.5.2.2.2.2.3a" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2.3.cmml"></mi><mo id="S4.SS1.p2.12.m10.5.5.2.2.2.2.3.1" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2.3.1.cmml">′</mo></msup></msup></mrow><mo id="S4.SS1.p2.12.m10.5.5.2.2.1" xref="S4.SS1.p2.12.m10.5.5.2.2.1.cmml">∈</mo><mrow id="S4.SS1.p2.12.m10.5.5.2.2.3" xref="S4.SS1.p2.12.m10.5.5.2.2.3.cmml"><msub id="S4.SS1.p2.12.m10.5.5.2.2.3.2" xref="S4.SS1.p2.12.m10.5.5.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.12.m10.5.5.2.2.3.2.2" xref="S4.SS1.p2.12.m10.5.5.2.2.3.2.2.cmml">𝒩</mi><mi id="S4.SS1.p2.12.m10.5.5.2.2.3.2.3" xref="S4.SS1.p2.12.m10.5.5.2.2.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p2.12.m10.5.5.2.2.3.1" xref="S4.SS1.p2.12.m10.5.5.2.2.3.1.cmml">​</mo><mrow id="S4.SS1.p2.12.m10.5.5.2.2.3.3.2" xref="S4.SS1.p2.12.m10.5.5.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.12.m10.5.5.2.2.3.3.2.1" xref="S4.SS1.p2.12.m10.5.5.2.2.3.cmml">(</mo><mi id="S4.SS1.p2.12.m10.3.3" xref="S4.SS1.p2.12.m10.3.3.cmml">c</mi><mo stretchy="false" id="S4.SS1.p2.12.m10.5.5.2.2.3.3.2.2" xref="S4.SS1.p2.12.m10.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m10.5b"><apply id="S4.SS1.p2.12.m10.5.5.3.cmml" xref="S4.SS1.p2.12.m10.5.5.2"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.5.5.3a.cmml" xref="S4.SS1.p2.12.m10.5.5.2.3">formulae-sequence</csymbol><apply id="S4.SS1.p2.12.m10.4.4.1.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1"><eq id="S4.SS1.p2.12.m10.4.4.1.1.4.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.4"></eq><apply id="S4.SS1.p2.12.m10.4.4.1.1.1.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1"><max id="S4.SS1.p2.12.m10.1.1.cmml" xref="S4.SS1.p2.12.m10.1.1"></max><cn type="integer" id="S4.SS1.p2.12.m10.2.2.cmml" xref="S4.SS1.p2.12.m10.2.2">0</cn><apply id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1"><minus id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.3"></minus><ci id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.4.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.4">𝑣</ci><apply id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2"><times id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.3"></times><ci id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.4.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.4">𝑑</ci><interval closure="open" id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2"><apply id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.2">𝑤</ci><apply id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.2">𝑐</ci><apply id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3"><ci id="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.1.1.1.1.2.2.2.2.3.3.1">′</ci></apply></apply></apply></interval></apply></apply></apply><apply id="S4.SS1.p2.12.m10.4.4.1.1.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3"><minus id="S4.SS1.p2.12.m10.4.4.1.1.3.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.3"></minus><ci id="S4.SS1.p2.12.m10.4.4.1.1.3.4.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.4">𝑣</ci><apply id="S4.SS1.p2.12.m10.4.4.1.1.3.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2"><times id="S4.SS1.p2.12.m10.4.4.1.1.3.2.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.3"></times><ci id="S4.SS1.p2.12.m10.4.4.1.1.3.2.4.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.4">𝑑</ci><interval closure="open" id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2"><apply id="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.2">𝑤</ci><ci id="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.2.1.1.1.1.3">𝑐</ci></apply><apply id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.2">𝑤</ci><apply id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.2.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.2">𝑐</ci><apply id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3"><ci id="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3.1.cmml" xref="S4.SS1.p2.12.m10.4.4.1.1.3.2.2.2.2.3.3.1">′</ci></apply></apply></apply></interval></apply></apply></apply><apply id="S4.SS1.p2.12.m10.5.5.2.2.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2"><in id="S4.SS1.p2.12.m10.5.5.2.2.1.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.1"></in><apply id="S4.SS1.p2.12.m10.5.5.2.2.2.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.2"><csymbol cd="latexml" id="S4.SS1.p2.12.m10.5.5.2.2.2.1.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.2.1">for-all</csymbol><apply id="S4.SS1.p2.12.m10.5.5.2.2.2.2.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.5.5.2.2.2.2.1.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p2.12.m10.5.5.2.2.2.2.2.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2.2">𝑐</ci><apply id="S4.SS1.p2.12.m10.5.5.2.2.2.2.3.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2.3"><ci id="S4.SS1.p2.12.m10.5.5.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.2.2.3.1">′</ci></apply></apply></apply><apply id="S4.SS1.p2.12.m10.5.5.2.2.3.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.3"><times id="S4.SS1.p2.12.m10.5.5.2.2.3.1.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.3.1"></times><apply id="S4.SS1.p2.12.m10.5.5.2.2.3.2.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m10.5.5.2.2.3.2.1.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.3.2">subscript</csymbol><ci id="S4.SS1.p2.12.m10.5.5.2.2.3.2.2.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.3.2.2">𝒩</ci><ci id="S4.SS1.p2.12.m10.5.5.2.2.3.2.3.cmml" xref="S4.SS1.p2.12.m10.5.5.2.2.3.2.3">𝑘</ci></apply><ci id="S4.SS1.p2.12.m10.3.3.cmml" xref="S4.SS1.p2.12.m10.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m10.5c">\max\left\{0,v-d(w_{c},w_{c^{{}^{\prime}}})\right\}=v-d(w_{c},w_{c^{{}^{\prime}}}),\forall c^{{}^{\prime}}\in\mathcal{N}_{k}(c)</annotation></semantics></math>. Since <math id="S4.SS1.p2.13.m11.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S4.SS1.p2.13.m11.1a"><mi id="S4.SS1.p2.13.m11.1.1" xref="S4.SS1.p2.13.m11.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m11.1b"><ci id="S4.SS1.p2.13.m11.1.1.cmml" xref="S4.SS1.p2.13.m11.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m11.1c">v</annotation></semantics></math> is a constant, minimization of <math id="S4.SS1.p2.14.m12.2" class="ltx_Math" alttext="v-d(w_{c},w_{c^{{}^{\prime}}})" display="inline"><semantics id="S4.SS1.p2.14.m12.2a"><mrow id="S4.SS1.p2.14.m12.2.2" xref="S4.SS1.p2.14.m12.2.2.cmml"><mi id="S4.SS1.p2.14.m12.2.2.4" xref="S4.SS1.p2.14.m12.2.2.4.cmml">v</mi><mo id="S4.SS1.p2.14.m12.2.2.3" xref="S4.SS1.p2.14.m12.2.2.3.cmml">−</mo><mrow id="S4.SS1.p2.14.m12.2.2.2" xref="S4.SS1.p2.14.m12.2.2.2.cmml"><mi id="S4.SS1.p2.14.m12.2.2.2.4" xref="S4.SS1.p2.14.m12.2.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.14.m12.2.2.2.3" xref="S4.SS1.p2.14.m12.2.2.2.3.cmml">​</mo><mrow id="S4.SS1.p2.14.m12.2.2.2.2.2" xref="S4.SS1.p2.14.m12.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.14.m12.2.2.2.2.2.3" xref="S4.SS1.p2.14.m12.2.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p2.14.m12.1.1.1.1.1.1" xref="S4.SS1.p2.14.m12.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.14.m12.1.1.1.1.1.1.2" xref="S4.SS1.p2.14.m12.1.1.1.1.1.1.2.cmml">w</mi><mi id="S4.SS1.p2.14.m12.1.1.1.1.1.1.3" xref="S4.SS1.p2.14.m12.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.p2.14.m12.2.2.2.2.2.4" xref="S4.SS1.p2.14.m12.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p2.14.m12.2.2.2.2.2.2" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.14.m12.2.2.2.2.2.2.2" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.2.cmml">w</mi><msup id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.2" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.2.cmml">c</mi><msup id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3.cmml"><mi id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3a" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3.cmml"></mi><mo id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3.1" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3.1.cmml">′</mo></msup></msup></msub><mo stretchy="false" id="S4.SS1.p2.14.m12.2.2.2.2.2.5" xref="S4.SS1.p2.14.m12.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.14.m12.2b"><apply id="S4.SS1.p2.14.m12.2.2.cmml" xref="S4.SS1.p2.14.m12.2.2"><minus id="S4.SS1.p2.14.m12.2.2.3.cmml" xref="S4.SS1.p2.14.m12.2.2.3"></minus><ci id="S4.SS1.p2.14.m12.2.2.4.cmml" xref="S4.SS1.p2.14.m12.2.2.4">𝑣</ci><apply id="S4.SS1.p2.14.m12.2.2.2.cmml" xref="S4.SS1.p2.14.m12.2.2.2"><times id="S4.SS1.p2.14.m12.2.2.2.3.cmml" xref="S4.SS1.p2.14.m12.2.2.2.3"></times><ci id="S4.SS1.p2.14.m12.2.2.2.4.cmml" xref="S4.SS1.p2.14.m12.2.2.2.4">𝑑</ci><interval closure="open" id="S4.SS1.p2.14.m12.2.2.2.2.3.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2"><apply id="S4.SS1.p2.14.m12.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.14.m12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m12.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.14.m12.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.14.m12.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.14.m12.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.SS1.p2.14.m12.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.14.m12.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.SS1.p2.14.m12.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m12.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.14.m12.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.2">𝑤</ci><apply id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.2.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.2">𝑐</ci><apply id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3"><ci id="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3.1.cmml" xref="S4.SS1.p2.14.m12.2.2.2.2.2.2.3.3.1">′</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.14.m12.2c">v-d(w_{c},w_{c^{{}^{\prime}}})</annotation></semantics></math> is consistent with minimizing <math id="S4.SS1.p2.15.m13.2" class="ltx_Math" alttext="-d(w_{c},w_{c^{{}^{\prime}}})" display="inline"><semantics id="S4.SS1.p2.15.m13.2a"><mrow id="S4.SS1.p2.15.m13.2.2" xref="S4.SS1.p2.15.m13.2.2.cmml"><mo id="S4.SS1.p2.15.m13.2.2a" xref="S4.SS1.p2.15.m13.2.2.cmml">−</mo><mrow id="S4.SS1.p2.15.m13.2.2.2" xref="S4.SS1.p2.15.m13.2.2.2.cmml"><mi id="S4.SS1.p2.15.m13.2.2.2.4" xref="S4.SS1.p2.15.m13.2.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.15.m13.2.2.2.3" xref="S4.SS1.p2.15.m13.2.2.2.3.cmml">​</mo><mrow id="S4.SS1.p2.15.m13.2.2.2.2.2" xref="S4.SS1.p2.15.m13.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.15.m13.2.2.2.2.2.3" xref="S4.SS1.p2.15.m13.2.2.2.2.3.cmml">(</mo><msub id="S4.SS1.p2.15.m13.1.1.1.1.1.1" xref="S4.SS1.p2.15.m13.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.15.m13.1.1.1.1.1.1.2" xref="S4.SS1.p2.15.m13.1.1.1.1.1.1.2.cmml">w</mi><mi id="S4.SS1.p2.15.m13.1.1.1.1.1.1.3" xref="S4.SS1.p2.15.m13.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S4.SS1.p2.15.m13.2.2.2.2.2.4" xref="S4.SS1.p2.15.m13.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p2.15.m13.2.2.2.2.2.2" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.15.m13.2.2.2.2.2.2.2" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.2.cmml">w</mi><msup id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.2" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.2.cmml">c</mi><msup id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3.cmml"><mi id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3a" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3.cmml"></mi><mo id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3.1" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3.1.cmml">′</mo></msup></msup></msub><mo stretchy="false" id="S4.SS1.p2.15.m13.2.2.2.2.2.5" xref="S4.SS1.p2.15.m13.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.15.m13.2b"><apply id="S4.SS1.p2.15.m13.2.2.cmml" xref="S4.SS1.p2.15.m13.2.2"><minus id="S4.SS1.p2.15.m13.2.2.3.cmml" xref="S4.SS1.p2.15.m13.2.2"></minus><apply id="S4.SS1.p2.15.m13.2.2.2.cmml" xref="S4.SS1.p2.15.m13.2.2.2"><times id="S4.SS1.p2.15.m13.2.2.2.3.cmml" xref="S4.SS1.p2.15.m13.2.2.2.3"></times><ci id="S4.SS1.p2.15.m13.2.2.2.4.cmml" xref="S4.SS1.p2.15.m13.2.2.2.4">𝑑</ci><interval closure="open" id="S4.SS1.p2.15.m13.2.2.2.2.3.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2"><apply id="S4.SS1.p2.15.m13.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.15.m13.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.15.m13.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.15.m13.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.15.m13.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.15.m13.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.SS1.p2.15.m13.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.15.m13.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.SS1.p2.15.m13.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.15.m13.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.15.m13.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.2">𝑤</ci><apply id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.2.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.2">𝑐</ci><apply id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3"><ci id="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3.1.cmml" xref="S4.SS1.p2.15.m13.2.2.2.2.2.2.3.3.1">′</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.15.m13.2c">-d(w_{c},w_{c^{{}^{\prime}}})</annotation></semantics></math>, (11) is equivalent with (12).
This is motivated by the stochastic negative mining approach <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>. Since only the distances between close class embeddings are maximized, the computational cost can be reduced.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">A main drawback of FedAwS is that the embeddings of different classes are separated in the same way without considering the correlations between different class labels as mentioned above. The simple spreadout regularizer is effective in the task of multi-class classification but may be coarse in multi-label task, where some labels are usually highly correlated, especially in the XMLC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> scenario. This issue is appropriately tackled by exploring label correlations in our method. In comparison to FedAwS, the proposed FedALC (or FedALC-fixed) holds the advantage of leveraging label correlation to optimize the class embedding matrix. The assessment of correlation among multiple labels is accomplished by tallying the frequency of the labels cooccuring with the same instance. To safeguard against the server discerning the specific labels tagged to a given instance, in addition to hashing the instance, the labels themselves can also be hashed. Further elaboration on this method is provided in Section <a href="#S4.SS5" title="IV-E Label sets collection ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-E</span></span></a>. This approach ensures that the server can ascertain label correlations while remaining oblivious to the association between instances and specific labels.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Spreadout by exploring label correlations (FedALC)</span>
</h3>

<figure id="S4.F2" class="ltx_figure"><img src="/html/2404.15598/assets/x2.png" id="S4.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="332" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Mechanism of the designed correlation regularizer under the federated learning paradigm. The orange, blue and green dots indicate the instance, positive class and negative class respectively.</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The correlation of class(label) has two meanings: Firstly, if two labels consecutively arise in one sample, then the correlation of the two labels are strong; alternatively, if they appear infrequently together, then the correlation is weak. Secondly, there are semantical connections between the classes (labels) such as, similarity and hierarchical relationship. For instance, the labels ”train” and ”car” as well as ”train” and ”vehicle” show strong correlations, whereas the labels ”train” and ”elephant” have a weak correlation.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.9" class="ltx_p">To exploit label correlations, we need to first collect the label set for each instance. This process will be described later. Given the collected label sets, we propose to add a correlation regularizer on the server-side to improve the dispersion of class embedding matrix by taking the label correlations into consideration. We first define <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="L_{j}^{P}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msubsup id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.cmml">L</mi><mi id="S4.SS2.p2.1.m1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.2.3.cmml">j</mi><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">P</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2">𝐿</ci><ci id="S4.SS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">L_{j}^{P}</annotation></semantics></math> and <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="L_{j}^{N}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msubsup id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.2.2.cmml">L</mi><mi id="S4.SS2.p2.2.m2.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.2.3.cmml">j</mi><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.2">𝐿</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">L_{j}^{N}</annotation></semantics></math> as the positive and negative label set for the <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">j</annotation></semantics></math>-th instance, respectively. For example, in a five-class classification problem, there is an instance with labels <math id="S4.SS2.p2.4.m4.3" class="ltx_Math" alttext="\{0,1,2\}" display="inline"><semantics id="S4.SS2.p2.4.m4.3a"><mrow id="S4.SS2.p2.4.m4.3.4.2" xref="S4.SS2.p2.4.m4.3.4.1.cmml"><mo stretchy="false" id="S4.SS2.p2.4.m4.3.4.2.1" xref="S4.SS2.p2.4.m4.3.4.1.cmml">{</mo><mn id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">0</mn><mo id="S4.SS2.p2.4.m4.3.4.2.2" xref="S4.SS2.p2.4.m4.3.4.1.cmml">,</mo><mn id="S4.SS2.p2.4.m4.2.2" xref="S4.SS2.p2.4.m4.2.2.cmml">1</mn><mo id="S4.SS2.p2.4.m4.3.4.2.3" xref="S4.SS2.p2.4.m4.3.4.1.cmml">,</mo><mn id="S4.SS2.p2.4.m4.3.3" xref="S4.SS2.p2.4.m4.3.3.cmml">2</mn><mo stretchy="false" id="S4.SS2.p2.4.m4.3.4.2.4" xref="S4.SS2.p2.4.m4.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.3b"><set id="S4.SS2.p2.4.m4.3.4.1.cmml" xref="S4.SS2.p2.4.m4.3.4.2"><cn type="integer" id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">0</cn><cn type="integer" id="S4.SS2.p2.4.m4.2.2.cmml" xref="S4.SS2.p2.4.m4.2.2">1</cn><cn type="integer" id="S4.SS2.p2.4.m4.3.3.cmml" xref="S4.SS2.p2.4.m4.3.3">2</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.3c">\{0,1,2\}</annotation></semantics></math>, and then its label set is <math id="S4.SS2.p2.5.m5.2" class="ltx_Math" alttext="L_{j}=[L_{j}^{P},L_{j}^{N}]" display="inline"><semantics id="S4.SS2.p2.5.m5.2a"><mrow id="S4.SS2.p2.5.m5.2.2" xref="S4.SS2.p2.5.m5.2.2.cmml"><msub id="S4.SS2.p2.5.m5.2.2.4" xref="S4.SS2.p2.5.m5.2.2.4.cmml"><mi id="S4.SS2.p2.5.m5.2.2.4.2" xref="S4.SS2.p2.5.m5.2.2.4.2.cmml">L</mi><mi id="S4.SS2.p2.5.m5.2.2.4.3" xref="S4.SS2.p2.5.m5.2.2.4.3.cmml">j</mi></msub><mo id="S4.SS2.p2.5.m5.2.2.3" xref="S4.SS2.p2.5.m5.2.2.3.cmml">=</mo><mrow id="S4.SS2.p2.5.m5.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.2.2.2.2.3" xref="S4.SS2.p2.5.m5.2.2.2.3.cmml">[</mo><msubsup id="S4.SS2.p2.5.m5.1.1.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.1.1.1.2.2" xref="S4.SS2.p2.5.m5.1.1.1.1.1.2.2.cmml">L</mi><mi id="S4.SS2.p2.5.m5.1.1.1.1.1.2.3" xref="S4.SS2.p2.5.m5.1.1.1.1.1.2.3.cmml">j</mi><mi id="S4.SS2.p2.5.m5.1.1.1.1.1.3" xref="S4.SS2.p2.5.m5.1.1.1.1.1.3.cmml">P</mi></msubsup><mo id="S4.SS2.p2.5.m5.2.2.2.2.4" xref="S4.SS2.p2.5.m5.2.2.2.3.cmml">,</mo><msubsup id="S4.SS2.p2.5.m5.2.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.2.2.cmml"><mi id="S4.SS2.p2.5.m5.2.2.2.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.2.2.2.2.cmml">L</mi><mi id="S4.SS2.p2.5.m5.2.2.2.2.2.2.3" xref="S4.SS2.p2.5.m5.2.2.2.2.2.2.3.cmml">j</mi><mi id="S4.SS2.p2.5.m5.2.2.2.2.2.3" xref="S4.SS2.p2.5.m5.2.2.2.2.2.3.cmml">N</mi></msubsup><mo stretchy="false" id="S4.SS2.p2.5.m5.2.2.2.2.5" xref="S4.SS2.p2.5.m5.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.2b"><apply id="S4.SS2.p2.5.m5.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2"><eq id="S4.SS2.p2.5.m5.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.3"></eq><apply id="S4.SS2.p2.5.m5.2.2.4.cmml" xref="S4.SS2.p2.5.m5.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.4.1.cmml" xref="S4.SS2.p2.5.m5.2.2.4">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.2.4.2.cmml" xref="S4.SS2.p2.5.m5.2.2.4.2">𝐿</ci><ci id="S4.SS2.p2.5.m5.2.2.4.3.cmml" xref="S4.SS2.p2.5.m5.2.2.4.3">𝑗</ci></apply><interval closure="closed" id="S4.SS2.p2.5.m5.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2"><apply id="S4.SS2.p2.5.m5.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.1.2.2">𝐿</ci><ci id="S4.SS2.p2.5.m5.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.5.m5.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.1.3">𝑃</ci></apply><apply id="S4.SS2.p2.5.m5.2.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p2.5.m5.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2.2.2">𝐿</ci><ci id="S4.SS2.p2.5.m5.2.2.2.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.5.m5.2.2.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2.3">𝑁</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.2c">L_{j}=[L_{j}^{P},L_{j}^{N}]</annotation></semantics></math>, where the positive label set <math id="S4.SS2.p2.6.m6.3" class="ltx_Math" alttext="L_{j}^{P}=[0,1,2]" display="inline"><semantics id="S4.SS2.p2.6.m6.3a"><mrow id="S4.SS2.p2.6.m6.3.4" xref="S4.SS2.p2.6.m6.3.4.cmml"><msubsup id="S4.SS2.p2.6.m6.3.4.2" xref="S4.SS2.p2.6.m6.3.4.2.cmml"><mi id="S4.SS2.p2.6.m6.3.4.2.2.2" xref="S4.SS2.p2.6.m6.3.4.2.2.2.cmml">L</mi><mi id="S4.SS2.p2.6.m6.3.4.2.2.3" xref="S4.SS2.p2.6.m6.3.4.2.2.3.cmml">j</mi><mi id="S4.SS2.p2.6.m6.3.4.2.3" xref="S4.SS2.p2.6.m6.3.4.2.3.cmml">P</mi></msubsup><mo id="S4.SS2.p2.6.m6.3.4.1" xref="S4.SS2.p2.6.m6.3.4.1.cmml">=</mo><mrow id="S4.SS2.p2.6.m6.3.4.3.2" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.6.m6.3.4.3.2.1" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml">[</mo><mn id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">0</mn><mo id="S4.SS2.p2.6.m6.3.4.3.2.2" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml">,</mo><mn id="S4.SS2.p2.6.m6.2.2" xref="S4.SS2.p2.6.m6.2.2.cmml">1</mn><mo id="S4.SS2.p2.6.m6.3.4.3.2.3" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml">,</mo><mn id="S4.SS2.p2.6.m6.3.3" xref="S4.SS2.p2.6.m6.3.3.cmml">2</mn><mo stretchy="false" id="S4.SS2.p2.6.m6.3.4.3.2.4" xref="S4.SS2.p2.6.m6.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.3b"><apply id="S4.SS2.p2.6.m6.3.4.cmml" xref="S4.SS2.p2.6.m6.3.4"><eq id="S4.SS2.p2.6.m6.3.4.1.cmml" xref="S4.SS2.p2.6.m6.3.4.1"></eq><apply id="S4.SS2.p2.6.m6.3.4.2.cmml" xref="S4.SS2.p2.6.m6.3.4.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.3.4.2.1.cmml" xref="S4.SS2.p2.6.m6.3.4.2">superscript</csymbol><apply id="S4.SS2.p2.6.m6.3.4.2.2.cmml" xref="S4.SS2.p2.6.m6.3.4.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.3.4.2.2.1.cmml" xref="S4.SS2.p2.6.m6.3.4.2">subscript</csymbol><ci id="S4.SS2.p2.6.m6.3.4.2.2.2.cmml" xref="S4.SS2.p2.6.m6.3.4.2.2.2">𝐿</ci><ci id="S4.SS2.p2.6.m6.3.4.2.2.3.cmml" xref="S4.SS2.p2.6.m6.3.4.2.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.6.m6.3.4.2.3.cmml" xref="S4.SS2.p2.6.m6.3.4.2.3">𝑃</ci></apply><list id="S4.SS2.p2.6.m6.3.4.3.1.cmml" xref="S4.SS2.p2.6.m6.3.4.3.2"><cn type="integer" id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">0</cn><cn type="integer" id="S4.SS2.p2.6.m6.2.2.cmml" xref="S4.SS2.p2.6.m6.2.2">1</cn><cn type="integer" id="S4.SS2.p2.6.m6.3.3.cmml" xref="S4.SS2.p2.6.m6.3.3">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.3c">L_{j}^{P}=[0,1,2]</annotation></semantics></math> and negative label set <math id="S4.SS2.p2.7.m7.2" class="ltx_Math" alttext="L_{j}^{N}=[3,4]" display="inline"><semantics id="S4.SS2.p2.7.m7.2a"><mrow id="S4.SS2.p2.7.m7.2.3" xref="S4.SS2.p2.7.m7.2.3.cmml"><msubsup id="S4.SS2.p2.7.m7.2.3.2" xref="S4.SS2.p2.7.m7.2.3.2.cmml"><mi id="S4.SS2.p2.7.m7.2.3.2.2.2" xref="S4.SS2.p2.7.m7.2.3.2.2.2.cmml">L</mi><mi id="S4.SS2.p2.7.m7.2.3.2.2.3" xref="S4.SS2.p2.7.m7.2.3.2.2.3.cmml">j</mi><mi id="S4.SS2.p2.7.m7.2.3.2.3" xref="S4.SS2.p2.7.m7.2.3.2.3.cmml">N</mi></msubsup><mo id="S4.SS2.p2.7.m7.2.3.1" xref="S4.SS2.p2.7.m7.2.3.1.cmml">=</mo><mrow id="S4.SS2.p2.7.m7.2.3.3.2" xref="S4.SS2.p2.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.7.m7.2.3.3.2.1" xref="S4.SS2.p2.7.m7.2.3.3.1.cmml">[</mo><mn id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">3</mn><mo id="S4.SS2.p2.7.m7.2.3.3.2.2" xref="S4.SS2.p2.7.m7.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p2.7.m7.2.2" xref="S4.SS2.p2.7.m7.2.2.cmml">4</mn><mo stretchy="false" id="S4.SS2.p2.7.m7.2.3.3.2.3" xref="S4.SS2.p2.7.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.2b"><apply id="S4.SS2.p2.7.m7.2.3.cmml" xref="S4.SS2.p2.7.m7.2.3"><eq id="S4.SS2.p2.7.m7.2.3.1.cmml" xref="S4.SS2.p2.7.m7.2.3.1"></eq><apply id="S4.SS2.p2.7.m7.2.3.2.cmml" xref="S4.SS2.p2.7.m7.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.2.3.2.1.cmml" xref="S4.SS2.p2.7.m7.2.3.2">superscript</csymbol><apply id="S4.SS2.p2.7.m7.2.3.2.2.cmml" xref="S4.SS2.p2.7.m7.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.2.3.2.2.1.cmml" xref="S4.SS2.p2.7.m7.2.3.2">subscript</csymbol><ci id="S4.SS2.p2.7.m7.2.3.2.2.2.cmml" xref="S4.SS2.p2.7.m7.2.3.2.2.2">𝐿</ci><ci id="S4.SS2.p2.7.m7.2.3.2.2.3.cmml" xref="S4.SS2.p2.7.m7.2.3.2.2.3">𝑗</ci></apply><ci id="S4.SS2.p2.7.m7.2.3.2.3.cmml" xref="S4.SS2.p2.7.m7.2.3.2.3">𝑁</ci></apply><interval closure="closed" id="S4.SS2.p2.7.m7.2.3.3.1.cmml" xref="S4.SS2.p2.7.m7.2.3.3.2"><cn type="integer" id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">3</cn><cn type="integer" id="S4.SS2.p2.7.m7.2.2.cmml" xref="S4.SS2.p2.7.m7.2.2">4</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.2c">L_{j}^{N}=[3,4]</annotation></semantics></math>. We collect the label sets of all clients’ instances and merge them on the server, and the resulting whole label set is: <math id="S4.SS2.p2.8.m8.4" class="ltx_Math" alttext="{L}=\{(L_{1}^{P},L_{1}^{N}),(L_{2}^{P},L_{2}^{N}),...,(L_{n_{\mathrm{all}}}^{P},L_{n_{\mathrm{all}}}^{N})\}" display="inline"><semantics id="S4.SS2.p2.8.m8.4a"><mrow id="S4.SS2.p2.8.m8.4.4" xref="S4.SS2.p2.8.m8.4.4.cmml"><mi id="S4.SS2.p2.8.m8.4.4.5" xref="S4.SS2.p2.8.m8.4.4.5.cmml">L</mi><mo id="S4.SS2.p2.8.m8.4.4.4" xref="S4.SS2.p2.8.m8.4.4.4.cmml">=</mo><mrow id="S4.SS2.p2.8.m8.4.4.3.3" xref="S4.SS2.p2.8.m8.4.4.3.4.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.4.4.3.3.4" xref="S4.SS2.p2.8.m8.4.4.3.4.cmml">{</mo><mrow id="S4.SS2.p2.8.m8.2.2.1.1.1.2" xref="S4.SS2.p2.8.m8.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.2.2.1.1.1.2.3" xref="S4.SS2.p2.8.m8.2.2.1.1.1.3.cmml">(</mo><msubsup id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.2" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.2.cmml">L</mi><mn id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.3" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.3.cmml">1</mn><mi id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.3" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.3.cmml">P</mi></msubsup><mo id="S4.SS2.p2.8.m8.2.2.1.1.1.2.4" xref="S4.SS2.p2.8.m8.2.2.1.1.1.3.cmml">,</mo><msubsup id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.cmml"><mi id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.2" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.2.cmml">L</mi><mn id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.3" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.3.cmml">1</mn><mi id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.3" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.3.cmml">N</mi></msubsup><mo stretchy="false" id="S4.SS2.p2.8.m8.2.2.1.1.1.2.5" xref="S4.SS2.p2.8.m8.2.2.1.1.1.3.cmml">)</mo></mrow><mo id="S4.SS2.p2.8.m8.4.4.3.3.5" xref="S4.SS2.p2.8.m8.4.4.3.4.cmml">,</mo><mrow id="S4.SS2.p2.8.m8.3.3.2.2.2.2" xref="S4.SS2.p2.8.m8.3.3.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.3.3.2.2.2.2.3" xref="S4.SS2.p2.8.m8.3.3.2.2.2.3.cmml">(</mo><msubsup id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.cmml"><mi id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.2" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.2.cmml">L</mi><mn id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.3" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.3.cmml">2</mn><mi id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.3" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.3.cmml">P</mi></msubsup><mo id="S4.SS2.p2.8.m8.3.3.2.2.2.2.4" xref="S4.SS2.p2.8.m8.3.3.2.2.2.3.cmml">,</mo><msubsup id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.cmml"><mi id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.2" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.2.cmml">L</mi><mn id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.3" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.3.cmml">2</mn><mi id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.3" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.3.cmml">N</mi></msubsup><mo stretchy="false" id="S4.SS2.p2.8.m8.3.3.2.2.2.2.5" xref="S4.SS2.p2.8.m8.3.3.2.2.2.3.cmml">)</mo></mrow><mo id="S4.SS2.p2.8.m8.4.4.3.3.6" xref="S4.SS2.p2.8.m8.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">…</mi><mo id="S4.SS2.p2.8.m8.4.4.3.3.7" xref="S4.SS2.p2.8.m8.4.4.3.4.cmml">,</mo><mrow id="S4.SS2.p2.8.m8.4.4.3.3.3.2" xref="S4.SS2.p2.8.m8.4.4.3.3.3.3.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.4.4.3.3.3.2.3" xref="S4.SS2.p2.8.m8.4.4.3.3.3.3.cmml">(</mo><msubsup id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.cmml"><mi id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.2" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.2.cmml">L</mi><msub id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.cmml"><mi id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.2" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.2.cmml">n</mi><mi id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.3" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.3.cmml">all</mi></msub><mi id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.3" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.3.cmml">P</mi></msubsup><mo id="S4.SS2.p2.8.m8.4.4.3.3.3.2.4" xref="S4.SS2.p2.8.m8.4.4.3.3.3.3.cmml">,</mo><msubsup id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.cmml"><mi id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.2" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.2.cmml">L</mi><msub id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.cmml"><mi id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.2" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.2.cmml">n</mi><mi id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.3" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.3.cmml">all</mi></msub><mi id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.3" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.3.cmml">N</mi></msubsup><mo stretchy="false" id="S4.SS2.p2.8.m8.4.4.3.3.3.2.5" xref="S4.SS2.p2.8.m8.4.4.3.3.3.3.cmml">)</mo></mrow><mo stretchy="false" id="S4.SS2.p2.8.m8.4.4.3.3.8" xref="S4.SS2.p2.8.m8.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.4b"><apply id="S4.SS2.p2.8.m8.4.4.cmml" xref="S4.SS2.p2.8.m8.4.4"><eq id="S4.SS2.p2.8.m8.4.4.4.cmml" xref="S4.SS2.p2.8.m8.4.4.4"></eq><ci id="S4.SS2.p2.8.m8.4.4.5.cmml" xref="S4.SS2.p2.8.m8.4.4.5">𝐿</ci><set id="S4.SS2.p2.8.m8.4.4.3.4.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3"><interval closure="open" id="S4.SS2.p2.8.m8.2.2.1.1.1.3.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2"><apply id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.2">𝐿</ci><cn type="integer" id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.2.3">1</cn></apply><ci id="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.1.1.3">𝑃</ci></apply><apply id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.1.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2">superscript</csymbol><apply id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.2">𝐿</ci><cn type="integer" id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.2.3">1</cn></apply><ci id="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.3.cmml" xref="S4.SS2.p2.8.m8.2.2.1.1.1.2.2.3">𝑁</ci></apply></interval><interval closure="open" id="S4.SS2.p2.8.m8.3.3.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2"><apply id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.1.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1">superscript</csymbol><apply id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.1.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.2.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.2">𝐿</ci><cn type="integer" id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.3.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.2.3">2</cn></apply><ci id="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.3.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.1.1.3">𝑃</ci></apply><apply id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.2">𝐿</ci><cn type="integer" id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.2.3">2</cn></apply><ci id="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.3.3.2.2.2.2.2.3">𝑁</ci></apply></interval><ci id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">…</ci><interval closure="open" id="S4.SS2.p2.8.m8.4.4.3.3.3.3.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2"><apply id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.1.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1">superscript</csymbol><apply id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.1.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.2.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.2">𝐿</ci><apply id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.1.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.2.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.2">𝑛</ci><ci id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.3.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.2.3.3">all</ci></apply></apply><ci id="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.3.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.1.1.3">𝑃</ci></apply><apply id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.1.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2">superscript</csymbol><apply id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.1.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2">subscript</csymbol><ci id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.2">𝐿</ci><apply id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.1.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.2.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.2">𝑛</ci><ci id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.3.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.2.3.3">all</ci></apply></apply><ci id="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.3.cmml" xref="S4.SS2.p2.8.m8.4.4.3.3.3.2.2.3">𝑁</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.4c">{L}=\{(L_{1}^{P},L_{1}^{N}),(L_{2}^{P},L_{2}^{N}),...,(L_{n_{\mathrm{all}}}^{P},L_{n_{\mathrm{all}}}^{N})\}</annotation></semantics></math>, where <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="n_{\mathrm{all}}" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><msub id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml"><mi id="S4.SS2.p2.9.m9.1.1.2" xref="S4.SS2.p2.9.m9.1.1.2.cmml">n</mi><mi id="S4.SS2.p2.9.m9.1.1.3" xref="S4.SS2.p2.9.m9.1.1.3.cmml">all</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><apply id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2">𝑛</ci><ci id="S4.SS2.p2.9.m9.1.1.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3">all</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">n_{\mathrm{all}}</annotation></semantics></math> is number of all clients’ instances. Then the correlation regularizer can be given as follow:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.97" class="ltx_math_unparsed" alttext="\begin{split}&amp;\operatorname{reg}_{\mathrm{cr}}(W)=\sum_{i\in[m]}\frac{|\mathcal{S}^{i}|}{|\mathcal{S}|}\hat{\mathcal{R}}_{\mathrm{neg}}\left(\mathcal{S}^{i}\right)\\
&amp;\!=\!\!\frac{1}{n_{all}}\sum\limits_{i\in[m]}\sum\limits_{j\in[n_{i}]}\ell^{\mathrm{neg}}_{cl}({L_{j}^{P}},{L_{j}^{N}},W)\!\!\\
&amp;\!=\!\!\frac{1}{n_{all}}\sum\limits_{j\in[n_{\mathrm{all}}]}\!\!\left(\sum\limits_{y_{j}\in L_{j}^{P},\atop y_{j}^{\prime}\in L_{j}^{N}}\!\left(\max\left\{0,\nu\!-\!d(\mathbf{w}_{y_{j}},\mathbf{w}_{y_{j}^{\prime}})\right\}\right)^{2}\right)\\
&amp;\!=\!\!\sum_{u\in[C]}\!\!\left(\sigma_{uu^{\prime}}\cdot\sum_{u^{\prime}\neq u}\left(\max\left(0,\nu\!-\!d(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}})\right)\right)^{2}\right),\end{split}" display="block"><semantics id="S4.E8.m1.97a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E8.m1.97.97.7"><mtr id="S4.E8.m1.97.97.7a"><mtd id="S4.E8.m1.97.97.7b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.97.97.7c"><mrow id="S4.E8.m1.93.93.3.92.17.17"><mrow id="S4.E8.m1.92.92.2.91.16.16.16.1"><msub id="S4.E8.m1.92.92.2.91.16.16.16.1.1"><mi id="S4.E8.m1.1.1.1.1.1.1">reg</mi><mi id="S4.E8.m1.2.2.2.2.2.2.1">cr</mi></msub><mo id="S4.E8.m1.92.92.2.91.16.16.16.1a">⁡</mo><mrow id="S4.E8.m1.92.92.2.91.16.16.16.1.2"><mo stretchy="false" id="S4.E8.m1.3.3.3.3.3.3">(</mo><mi id="S4.E8.m1.4.4.4.4.4.4">W</mi><mo stretchy="false" id="S4.E8.m1.5.5.5.5.5.5">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E8.m1.6.6.6.6.6.6">=</mo><mrow id="S4.E8.m1.93.93.3.92.17.17.17"><munder id="S4.E8.m1.93.93.3.92.17.17.17.2"><mo movablelimits="false" id="S4.E8.m1.7.7.7.7.7.7">∑</mo><mrow id="S4.E8.m1.8.8.8.8.8.8.1"><mi id="S4.E8.m1.8.8.8.8.8.8.1.3">i</mi><mo id="S4.E8.m1.8.8.8.8.8.8.1.2">∈</mo><mrow id="S4.E8.m1.8.8.8.8.8.8.1.4.2"><mo stretchy="false" id="S4.E8.m1.8.8.8.8.8.8.1.4.2.1">[</mo><mi id="S4.E8.m1.8.8.8.8.8.8.1.1">m</mi><mo stretchy="false" id="S4.E8.m1.8.8.8.8.8.8.1.4.2.2">]</mo></mrow></mrow></munder><mrow id="S4.E8.m1.93.93.3.92.17.17.17.1"><mfrac id="S4.E8.m1.9.9.9.9.9.9"><mrow id="S4.E8.m1.9.9.9.9.9.9.1.1"><mo stretchy="false" id="S4.E8.m1.9.9.9.9.9.9.1.1.2">|</mo><msup id="S4.E8.m1.9.9.9.9.9.9.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.9.9.9.9.9.9.1.1.1.2">𝒮</mi><mi id="S4.E8.m1.9.9.9.9.9.9.1.1.1.3">i</mi></msup><mo stretchy="false" id="S4.E8.m1.9.9.9.9.9.9.1.1.3">|</mo></mrow><mrow id="S4.E8.m1.9.9.9.9.9.9.2.3"><mo stretchy="false" id="S4.E8.m1.9.9.9.9.9.9.2.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.9.9.9.9.9.9.2.1">𝒮</mi><mo stretchy="false" id="S4.E8.m1.9.9.9.9.9.9.2.3.2">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E8.m1.93.93.3.92.17.17.17.1.2">​</mo><msub id="S4.E8.m1.93.93.3.92.17.17.17.1.3"><mover accent="true" id="S4.E8.m1.10.10.10.10.10.10"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.10.10.10.10.10.10.2">ℛ</mi><mo id="S4.E8.m1.10.10.10.10.10.10.1">^</mo></mover><mi id="S4.E8.m1.11.11.11.11.11.11.1">neg</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.93.93.3.92.17.17.17.1.2a">​</mo><mrow id="S4.E8.m1.93.93.3.92.17.17.17.1.1.1"><mo id="S4.E8.m1.12.12.12.12.12.12">(</mo><msup id="S4.E8.m1.93.93.3.92.17.17.17.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.13.13.13.13.13.13">𝒮</mi><mi id="S4.E8.m1.14.14.14.14.14.14.1">i</mi></msup><mo id="S4.E8.m1.15.15.15.15.15.15">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E8.m1.97.97.7d"><mtd id="S4.E8.m1.97.97.7e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.97.97.7f"><mrow id="S4.E8.m1.95.95.5.94.22.22"><mi id="S4.E8.m1.95.95.5.94.22.22.23"></mi><mpadded width="0.726em"><mo lspace="0.108em" id="S4.E8.m1.16.16.16.1.1.1">=</mo></mpadded><mrow id="S4.E8.m1.95.95.5.94.22.22.22"><mfrac id="S4.E8.m1.17.17.17.2.2.2"><mn id="S4.E8.m1.17.17.17.2.2.2.2">1</mn><msub id="S4.E8.m1.17.17.17.2.2.2.3"><mi id="S4.E8.m1.17.17.17.2.2.2.3.2">n</mi><mrow id="S4.E8.m1.17.17.17.2.2.2.3.3"><mi id="S4.E8.m1.17.17.17.2.2.2.3.3.2">a</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.17.17.17.2.2.2.3.3.1">​</mo><mi id="S4.E8.m1.17.17.17.2.2.2.3.3.3">l</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.17.17.17.2.2.2.3.3.1a">​</mo><mi id="S4.E8.m1.17.17.17.2.2.2.3.3.4">l</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.E8.m1.95.95.5.94.22.22.22.3">​</mo><mrow id="S4.E8.m1.95.95.5.94.22.22.22.2"><munder id="S4.E8.m1.95.95.5.94.22.22.22.2.3"><mo movablelimits="false" rspace="0em" id="S4.E8.m1.18.18.18.3.3.3">∑</mo><mrow id="S4.E8.m1.19.19.19.4.4.4.1"><mi id="S4.E8.m1.19.19.19.4.4.4.1.3">i</mi><mo id="S4.E8.m1.19.19.19.4.4.4.1.2">∈</mo><mrow id="S4.E8.m1.19.19.19.4.4.4.1.4.2"><mo stretchy="false" id="S4.E8.m1.19.19.19.4.4.4.1.4.2.1">[</mo><mi id="S4.E8.m1.19.19.19.4.4.4.1.1">m</mi><mo stretchy="false" id="S4.E8.m1.19.19.19.4.4.4.1.4.2.2">]</mo></mrow></mrow></munder><mrow id="S4.E8.m1.95.95.5.94.22.22.22.2.2"><munder id="S4.E8.m1.95.95.5.94.22.22.22.2.2.3"><mo movablelimits="false" id="S4.E8.m1.20.20.20.5.5.5">∑</mo><mrow id="S4.E8.m1.21.21.21.6.6.6.1"><mi id="S4.E8.m1.21.21.21.6.6.6.1.3">j</mi><mo id="S4.E8.m1.21.21.21.6.6.6.1.2">∈</mo><mrow id="S4.E8.m1.21.21.21.6.6.6.1.1.1"><mo stretchy="false" id="S4.E8.m1.21.21.21.6.6.6.1.1.1.2">[</mo><msub id="S4.E8.m1.21.21.21.6.6.6.1.1.1.1"><mi id="S4.E8.m1.21.21.21.6.6.6.1.1.1.1.2">n</mi><mi id="S4.E8.m1.21.21.21.6.6.6.1.1.1.1.3">i</mi></msub><mo stretchy="false" id="S4.E8.m1.21.21.21.6.6.6.1.1.1.3">]</mo></mrow></mrow></munder><mrow id="S4.E8.m1.95.95.5.94.22.22.22.2.2.2"><msubsup id="S4.E8.m1.95.95.5.94.22.22.22.2.2.2.4"><mi mathvariant="normal" id="S4.E8.m1.22.22.22.7.7.7">ℓ</mi><mrow id="S4.E8.m1.24.24.24.9.9.9.1"><mi id="S4.E8.m1.24.24.24.9.9.9.1.2">c</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.24.24.24.9.9.9.1.1">​</mo><mi id="S4.E8.m1.24.24.24.9.9.9.1.3">l</mi></mrow><mi id="S4.E8.m1.23.23.23.8.8.8.1">neg</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.95.95.5.94.22.22.22.2.2.2.3">​</mo><mrow id="S4.E8.m1.95.95.5.94.22.22.22.2.2.2.2.2"><mo stretchy="false" id="S4.E8.m1.25.25.25.10.10.10">(</mo><msubsup id="S4.E8.m1.94.94.4.93.21.21.21.1.1.1.1.1.1"><mi id="S4.E8.m1.26.26.26.11.11.11">L</mi><mi id="S4.E8.m1.27.27.27.12.12.12.1">j</mi><mi id="S4.E8.m1.28.28.28.13.13.13.1">P</mi></msubsup><mo id="S4.E8.m1.29.29.29.14.14.14">,</mo><msubsup id="S4.E8.m1.95.95.5.94.22.22.22.2.2.2.2.2.2"><mi id="S4.E8.m1.30.30.30.15.15.15">L</mi><mi id="S4.E8.m1.31.31.31.16.16.16.1">j</mi><mi id="S4.E8.m1.32.32.32.17.17.17.1">N</mi></msubsup><mo id="S4.E8.m1.33.33.33.18.18.18">,</mo><mi id="S4.E8.m1.34.34.34.19.19.19">W</mi><mo stretchy="false" id="S4.E8.m1.35.35.35.20.20.20">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E8.m1.97.97.7g"><mtd id="S4.E8.m1.97.97.7h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.97.97.7i"><mrow id="S4.E8.m1.96.96.6.95.27.27"><mi id="S4.E8.m1.96.96.6.95.27.27.28"></mi><mpadded width="0.726em"><mo lspace="0.108em" id="S4.E8.m1.36.36.36.1.1.1">=</mo></mpadded><mrow id="S4.E8.m1.96.96.6.95.27.27.27"><mfrac id="S4.E8.m1.37.37.37.2.2.2"><mn id="S4.E8.m1.37.37.37.2.2.2.2">1</mn><msub id="S4.E8.m1.37.37.37.2.2.2.3"><mi id="S4.E8.m1.37.37.37.2.2.2.3.2">n</mi><mrow id="S4.E8.m1.37.37.37.2.2.2.3.3"><mi id="S4.E8.m1.37.37.37.2.2.2.3.3.2">a</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.37.37.37.2.2.2.3.3.1">​</mo><mi id="S4.E8.m1.37.37.37.2.2.2.3.3.3">l</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.37.37.37.2.2.2.3.3.1a">​</mo><mi id="S4.E8.m1.37.37.37.2.2.2.3.3.4">l</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.E8.m1.96.96.6.95.27.27.27.2">​</mo><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1"><munder id="S4.E8.m1.96.96.6.95.27.27.27.1.2"><mo movablelimits="false" rspace="0em" id="S4.E8.m1.38.38.38.3.3.3">∑</mo><mrow id="S4.E8.m1.39.39.39.4.4.4.1"><mi id="S4.E8.m1.39.39.39.4.4.4.1.3">j</mi><mo id="S4.E8.m1.39.39.39.4.4.4.1.2">∈</mo><mrow id="S4.E8.m1.39.39.39.4.4.4.1.1.1"><mo stretchy="false" id="S4.E8.m1.39.39.39.4.4.4.1.1.1.2">[</mo><msub id="S4.E8.m1.39.39.39.4.4.4.1.1.1.1"><mi id="S4.E8.m1.39.39.39.4.4.4.1.1.1.1.2">n</mi><mi id="S4.E8.m1.39.39.39.4.4.4.1.1.1.1.3">all</mi></msub><mo stretchy="false" id="S4.E8.m1.39.39.39.4.4.4.1.1.1.3">]</mo></mrow></mrow></munder><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1"><mo id="S4.E8.m1.40.40.40.5.5.5">(</mo><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1"><munder id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.2"><mo lspace="0em" movablelimits="false" rspace="0em" id="S4.E8.m1.41.41.41.6.6.6">∑</mo><mfrac linethickness="0pt" id="S4.E8.m1.42.42.42.7.7.7.1"><mrow id="S4.E8.m1.42.42.42.7.7.7.1.2"><msub id="S4.E8.m1.42.42.42.7.7.7.1.2.1"><mi id="S4.E8.m1.42.42.42.7.7.7.1.2.1.2">y</mi><mi id="S4.E8.m1.42.42.42.7.7.7.1.2.1.3">j</mi></msub><mo id="S4.E8.m1.42.42.42.7.7.7.1.2.2">∈</mo><msubsup id="S4.E8.m1.42.42.42.7.7.7.1.2.3"><mi id="S4.E8.m1.42.42.42.7.7.7.1.2.3.2.2">L</mi><mi id="S4.E8.m1.42.42.42.7.7.7.1.2.3.2.3">j</mi><mi id="S4.E8.m1.42.42.42.7.7.7.1.2.3.3">P</mi></msubsup><mo id="S4.E8.m1.42.42.42.7.7.7.1.2.4">,</mo></mrow><mrow id="S4.E8.m1.42.42.42.7.7.7.1.3"><msubsup id="S4.E8.m1.42.42.42.7.7.7.1.3.2"><mi id="S4.E8.m1.42.42.42.7.7.7.1.3.2.2.2">y</mi><mi id="S4.E8.m1.42.42.42.7.7.7.1.3.2.2.3">j</mi><mo id="S4.E8.m1.42.42.42.7.7.7.1.3.2.3">′</mo></msubsup><mo id="S4.E8.m1.42.42.42.7.7.7.1.3.1">∈</mo><msubsup id="S4.E8.m1.42.42.42.7.7.7.1.3.3"><mi id="S4.E8.m1.42.42.42.7.7.7.1.3.3.2.2">L</mi><mi id="S4.E8.m1.42.42.42.7.7.7.1.3.3.2.3">j</mi><mi id="S4.E8.m1.42.42.42.7.7.7.1.3.3.3">N</mi></msubsup></mrow></mfrac></munder><msup id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1"><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1"><mo id="S4.E8.m1.43.43.43.8.8.8">(</mo><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.44.44.44.9.9.9">max</mi><mo id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1a">⁡</mo><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1.1.1"><mo id="S4.E8.m1.45.45.45.10.10.10">{</mo><mn id="S4.E8.m1.46.46.46.11.11.11">0</mn><mo id="S4.E8.m1.47.47.47.12.12.12">,</mo><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.48.48.48.13.13.13">ν</mi><mo lspace="0.052em" rspace="0.052em" id="S4.E8.m1.49.49.49.14.14.14">−</mo><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1.1.1.1.2"><mi id="S4.E8.m1.50.50.50.15.15.15">d</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1.1.1.1.2.3">​</mo><mrow id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><mo stretchy="false" id="S4.E8.m1.51.51.51.16.16.16">(</mo><msub id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.52.52.52.17.17.17">𝐰</mi><msub id="S4.E8.m1.53.53.53.18.18.18.1"><mi id="S4.E8.m1.53.53.53.18.18.18.1.2">y</mi><mi id="S4.E8.m1.53.53.53.18.18.18.1.3">j</mi></msub></msub><mo id="S4.E8.m1.54.54.54.19.19.19">,</mo><msub id="S4.E8.m1.96.96.6.95.27.27.27.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><mi id="S4.E8.m1.55.55.55.20.20.20">𝐰</mi><msubsup id="S4.E8.m1.56.56.56.21.21.21.1"><mi id="S4.E8.m1.56.56.56.21.21.21.1.2.2">y</mi><mi id="S4.E8.m1.56.56.56.21.21.21.1.2.3">j</mi><mo id="S4.E8.m1.56.56.56.21.21.21.1.3">′</mo></msubsup></msub><mo stretchy="false" id="S4.E8.m1.57.57.57.22.22.22">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.58.58.58.23.23.23">}</mo></mrow></mrow><mo id="S4.E8.m1.59.59.59.24.24.24">)</mo></mrow><mn id="S4.E8.m1.60.60.60.25.25.25.1">2</mn></msup></mrow><mo id="S4.E8.m1.61.61.61.26.26.26">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E8.m1.97.97.7j"><mtd id="S4.E8.m1.97.97.7k"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E8.m1.97.97.7l"><mrow id="S4.E8.m1.97.97.7.96.30.30.30"><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1"><mi id="S4.E8.m1.97.97.7.96.30.30.30.1.2"></mi><mpadded width="0.726em"><mo lspace="0.108em" id="S4.E8.m1.62.62.62.1.1.1">=</mo></mpadded><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1"><munder id="S4.E8.m1.97.97.7.96.30.30.30.1.1.2"><mo movablelimits="false" rspace="0em" id="S4.E8.m1.63.63.63.2.2.2">∑</mo><mrow id="S4.E8.m1.64.64.64.3.3.3.1"><mi id="S4.E8.m1.64.64.64.3.3.3.1.3">u</mi><mo id="S4.E8.m1.64.64.64.3.3.3.1.2">∈</mo><mrow id="S4.E8.m1.64.64.64.3.3.3.1.4.2"><mo stretchy="false" id="S4.E8.m1.64.64.64.3.3.3.1.4.2.1">[</mo><mi id="S4.E8.m1.64.64.64.3.3.3.1.1">C</mi><mo stretchy="false" id="S4.E8.m1.64.64.64.3.3.3.1.4.2.2">]</mo></mrow></mrow></munder><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1"><mo id="S4.E8.m1.65.65.65.4.4.4">(</mo><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1"><msub id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.2"><mi id="S4.E8.m1.66.66.66.5.5.5">σ</mi><mrow id="S4.E8.m1.67.67.67.6.6.6.1"><mi id="S4.E8.m1.67.67.67.6.6.6.1.2">u</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.67.67.67.6.6.6.1.1">​</mo><msup id="S4.E8.m1.67.67.67.6.6.6.1.3"><mi id="S4.E8.m1.67.67.67.6.6.6.1.3.2">u</mi><mo id="S4.E8.m1.67.67.67.6.6.6.1.3.3">′</mo></msup></mrow></msub><mo lspace="0.222em" rspace="0.055em" id="S4.E8.m1.68.68.68.7.7.7">⋅</mo><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1"><munder id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.2"><mo movablelimits="false" rspace="0em" id="S4.E8.m1.69.69.69.8.8.8">∑</mo><mrow id="S4.E8.m1.70.70.70.9.9.9.1"><msup id="S4.E8.m1.70.70.70.9.9.9.1.2"><mi id="S4.E8.m1.70.70.70.9.9.9.1.2.2">u</mi><mo id="S4.E8.m1.70.70.70.9.9.9.1.2.3">′</mo></msup><mo id="S4.E8.m1.70.70.70.9.9.9.1.1">≠</mo><mi id="S4.E8.m1.70.70.70.9.9.9.1.3">u</mi></mrow></munder><msup id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1"><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1"><mo id="S4.E8.m1.71.71.71.10.10.10">(</mo><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.72.72.72.11.11.11">max</mi><mo id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1a">⁡</mo><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1"><mo id="S4.E8.m1.73.73.73.12.12.12">(</mo><mn id="S4.E8.m1.74.74.74.13.13.13">0</mn><mo id="S4.E8.m1.75.75.75.14.14.14">,</mo><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.76.76.76.15.15.15">ν</mi><mo lspace="0.052em" rspace="0.052em" id="S4.E8.m1.77.77.77.16.16.16">−</mo><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mi id="S4.E8.m1.78.78.78.17.17.17">d</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">​</mo><mrow id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><mo stretchy="false" id="S4.E8.m1.79.79.79.18.18.18">(</mo><msub id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.80.80.80.19.19.19">𝐰</mi><mi id="S4.E8.m1.81.81.81.20.20.20.1">u</mi></msub><mo id="S4.E8.m1.82.82.82.21.21.21">,</mo><msub id="S4.E8.m1.97.97.7.96.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><mi id="S4.E8.m1.83.83.83.22.22.22">𝐰</mi><msup id="S4.E8.m1.84.84.84.23.23.23.1"><mi id="S4.E8.m1.84.84.84.23.23.23.1.2">u</mi><mo id="S4.E8.m1.84.84.84.23.23.23.1.3">′</mo></msup></msub><mo stretchy="false" id="S4.E8.m1.85.85.85.24.24.24">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.86.86.86.25.25.25">)</mo></mrow></mrow><mo id="S4.E8.m1.87.87.87.26.26.26">)</mo></mrow><mn id="S4.E8.m1.88.88.88.27.27.27.1">2</mn></msup></mrow></mrow><mo id="S4.E8.m1.89.89.89.28.28.28">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.90.90.90.29.29.29">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E8.m1.97b">\begin{split}&amp;\operatorname{reg}_{\mathrm{cr}}(W)=\sum_{i\in[m]}\frac{|\mathcal{S}^{i}|}{|\mathcal{S}|}\hat{\mathcal{R}}_{\mathrm{neg}}\left(\mathcal{S}^{i}\right)\\
&amp;\!=\!\!\frac{1}{n_{all}}\sum\limits_{i\in[m]}\sum\limits_{j\in[n_{i}]}\ell^{\mathrm{neg}}_{cl}({L_{j}^{P}},{L_{j}^{N}},W)\!\!\\
&amp;\!=\!\!\frac{1}{n_{all}}\sum\limits_{j\in[n_{\mathrm{all}}]}\!\!\left(\sum\limits_{y_{j}\in L_{j}^{P},\atop y_{j}^{\prime}\in L_{j}^{N}}\!\left(\max\left\{0,\nu\!-\!d(\mathbf{w}_{y_{j}},\mathbf{w}_{y_{j}^{\prime}})\right\}\right)^{2}\right)\\
&amp;\!=\!\!\sum_{u\in[C]}\!\!\left(\sigma_{uu^{\prime}}\cdot\sum_{u^{\prime}\neq u}\left(\max\left(0,\nu\!-\!d(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}})\right)\right)^{2}\right),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.10" class="ltx_p">where <math id="S4.SS2.p2.10.m1.1" class="ltx_Math" alttext="\sigma_{uu^{\prime}}" display="inline"><semantics id="S4.SS2.p2.10.m1.1a"><msub id="S4.SS2.p2.10.m1.1.1" xref="S4.SS2.p2.10.m1.1.1.cmml"><mi id="S4.SS2.p2.10.m1.1.1.2" xref="S4.SS2.p2.10.m1.1.1.2.cmml">σ</mi><mrow id="S4.SS2.p2.10.m1.1.1.3" xref="S4.SS2.p2.10.m1.1.1.3.cmml"><mi id="S4.SS2.p2.10.m1.1.1.3.2" xref="S4.SS2.p2.10.m1.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.10.m1.1.1.3.1" xref="S4.SS2.p2.10.m1.1.1.3.1.cmml">​</mo><msup id="S4.SS2.p2.10.m1.1.1.3.3" xref="S4.SS2.p2.10.m1.1.1.3.3.cmml"><mi id="S4.SS2.p2.10.m1.1.1.3.3.2" xref="S4.SS2.p2.10.m1.1.1.3.3.2.cmml">u</mi><mo id="S4.SS2.p2.10.m1.1.1.3.3.3" xref="S4.SS2.p2.10.m1.1.1.3.3.3.cmml">′</mo></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m1.1b"><apply id="S4.SS2.p2.10.m1.1.1.cmml" xref="S4.SS2.p2.10.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m1.1.1.1.cmml" xref="S4.SS2.p2.10.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m1.1.1.2.cmml" xref="S4.SS2.p2.10.m1.1.1.2">𝜎</ci><apply id="S4.SS2.p2.10.m1.1.1.3.cmml" xref="S4.SS2.p2.10.m1.1.1.3"><times id="S4.SS2.p2.10.m1.1.1.3.1.cmml" xref="S4.SS2.p2.10.m1.1.1.3.1"></times><ci id="S4.SS2.p2.10.m1.1.1.3.2.cmml" xref="S4.SS2.p2.10.m1.1.1.3.2">𝑢</ci><apply id="S4.SS2.p2.10.m1.1.1.3.3.cmml" xref="S4.SS2.p2.10.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.10.m1.1.1.3.3">superscript</csymbol><ci id="S4.SS2.p2.10.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.10.m1.1.1.3.3.2">𝑢</ci><ci id="S4.SS2.p2.10.m1.1.1.3.3.3.cmml" xref="S4.SS2.p2.10.m1.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m1.1c">\sigma_{uu^{\prime}}</annotation></semantics></math> is a weight that reflects the correlation between different class labels, and can be calculated as:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.2" class="ltx_Math" alttext="\sigma_{uu^{\prime}}=\frac{1}{n_{all}}\sum_{j\in[n_{\mathrm{all}}]}I\left((u\in L_{j}^{P})\And(u^{\prime}\in L_{j}^{N})\right)," display="block"><semantics id="S4.E9.m1.2a"><mrow id="S4.E9.m1.2.2.1" xref="S4.E9.m1.2.2.1.1.cmml"><mrow id="S4.E9.m1.2.2.1.1" xref="S4.E9.m1.2.2.1.1.cmml"><msub id="S4.E9.m1.2.2.1.1.3" xref="S4.E9.m1.2.2.1.1.3.cmml"><mi id="S4.E9.m1.2.2.1.1.3.2" xref="S4.E9.m1.2.2.1.1.3.2.cmml">σ</mi><mrow id="S4.E9.m1.2.2.1.1.3.3" xref="S4.E9.m1.2.2.1.1.3.3.cmml"><mi id="S4.E9.m1.2.2.1.1.3.3.2" xref="S4.E9.m1.2.2.1.1.3.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.3.3.1" xref="S4.E9.m1.2.2.1.1.3.3.1.cmml">​</mo><msup id="S4.E9.m1.2.2.1.1.3.3.3" xref="S4.E9.m1.2.2.1.1.3.3.3.cmml"><mi id="S4.E9.m1.2.2.1.1.3.3.3.2" xref="S4.E9.m1.2.2.1.1.3.3.3.2.cmml">u</mi><mo id="S4.E9.m1.2.2.1.1.3.3.3.3" xref="S4.E9.m1.2.2.1.1.3.3.3.3.cmml">′</mo></msup></mrow></msub><mo id="S4.E9.m1.2.2.1.1.2" xref="S4.E9.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E9.m1.2.2.1.1.1" xref="S4.E9.m1.2.2.1.1.1.cmml"><mfrac id="S4.E9.m1.2.2.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.3.cmml"><mn id="S4.E9.m1.2.2.1.1.1.3.2" xref="S4.E9.m1.2.2.1.1.1.3.2.cmml">1</mn><msub id="S4.E9.m1.2.2.1.1.1.3.3" xref="S4.E9.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.3.3.2" xref="S4.E9.m1.2.2.1.1.1.3.3.2.cmml">n</mi><mrow id="S4.E9.m1.2.2.1.1.1.3.3.3" xref="S4.E9.m1.2.2.1.1.1.3.3.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.3.3.3.2" xref="S4.E9.m1.2.2.1.1.1.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.3.3.3.1" xref="S4.E9.m1.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E9.m1.2.2.1.1.1.3.3.3.3" xref="S4.E9.m1.2.2.1.1.1.3.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.3.3.3.1a" xref="S4.E9.m1.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E9.m1.2.2.1.1.1.3.3.3.4" xref="S4.E9.m1.2.2.1.1.1.3.3.3.4.cmml">l</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.2.2.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.cmml"><munder id="S4.E9.m1.2.2.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E9.m1.2.2.1.1.1.1.2.2" xref="S4.E9.m1.2.2.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.3" xref="S4.E9.m1.1.1.1.3.cmml">j</mi><mo id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.2.cmml">∈</mo><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.1.cmml">[</mo><msub id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml">n</mi><mi id="S4.E9.m1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.3.cmml">all</mi></msub><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></munder><mrow id="S4.E9.m1.2.2.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.1.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">u</mi><mo id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∈</mo><msubsup id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">L</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">j</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">P</mi></msubsup></mrow><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">&amp;</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml"><msup id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml">u</mi><mo id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml">′</mo></msup><mo id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.1.cmml">∈</mo><msubsup id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.cmml"><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.2" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.2.cmml">L</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.3.cmml">j</mi><mi id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml">N</mi></msubsup></mrow><mo stretchy="false" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E9.m1.2.2.1.2" xref="S4.E9.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.2b"><apply id="S4.E9.m1.2.2.1.1.cmml" xref="S4.E9.m1.2.2.1"><eq id="S4.E9.m1.2.2.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.2"></eq><apply id="S4.E9.m1.2.2.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.3.2">𝜎</ci><apply id="S4.E9.m1.2.2.1.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.3.3"><times id="S4.E9.m1.2.2.1.1.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.3.3.1"></times><ci id="S4.E9.m1.2.2.1.1.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.3.3.2">𝑢</ci><apply id="S4.E9.m1.2.2.1.1.3.3.3.cmml" xref="S4.E9.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.3.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.3.3.3">superscript</csymbol><ci id="S4.E9.m1.2.2.1.1.3.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.3.3.3.2">𝑢</ci><ci id="S4.E9.m1.2.2.1.1.3.3.3.3.cmml" xref="S4.E9.m1.2.2.1.1.3.3.3.3">′</ci></apply></apply></apply><apply id="S4.E9.m1.2.2.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1"><times id="S4.E9.m1.2.2.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.2"></times><apply id="S4.E9.m1.2.2.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3"><divide id="S4.E9.m1.2.2.1.1.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.3"></divide><cn type="integer" id="S4.E9.m1.2.2.1.1.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.3.2">1</cn><apply id="S4.E9.m1.2.2.1.1.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.2">𝑛</ci><apply id="S4.E9.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.3"><times id="S4.E9.m1.2.2.1.1.1.3.3.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.3.1"></times><ci id="S4.E9.m1.2.2.1.1.1.3.3.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.3.2">𝑎</ci><ci id="S4.E9.m1.2.2.1.1.1.3.3.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.3.3">𝑙</ci><ci id="S4.E9.m1.2.2.1.1.1.3.3.3.4.cmml" xref="S4.E9.m1.2.2.1.1.1.3.3.3.4">𝑙</ci></apply></apply></apply><apply id="S4.E9.m1.2.2.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1"><apply id="S4.E9.m1.2.2.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.2.2"></sum><apply id="S4.E9.m1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><in id="S4.E9.m1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.2"></in><ci id="S4.E9.m1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.3">𝑗</ci><apply id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2">𝑛</ci><ci id="S4.E9.m1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3">all</ci></apply></apply></apply></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1"><times id="S4.E9.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.2"></times><ci id="S4.E9.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.3">𝐼</ci><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1"><and id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.3"></and><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1"><in id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"></in><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑢</ci><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑗</ci></apply><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑃</ci></apply></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1"><in id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.1"></in><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2">superscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.2">𝑢</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.2.3">′</ci></apply><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3">superscript</csymbol><apply id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.2.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.2">𝐿</ci><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.2.3">𝑗</ci></apply><ci id="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml" xref="S4.E9.m1.2.2.1.1.1.1.1.1.1.1.2.1.1.3.3">𝑁</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.2c">\sigma_{uu^{\prime}}=\frac{1}{n_{all}}\sum_{j\in[n_{\mathrm{all}}]}I\left((u\in L_{j}^{P})\And(u^{\prime}\in L_{j}^{N})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.14" class="ltx_p">where <math id="S4.SS2.p2.11.m1.1" class="ltx_Math" alttext="I(\cdot)" display="inline"><semantics id="S4.SS2.p2.11.m1.1a"><mrow id="S4.SS2.p2.11.m1.1.2" xref="S4.SS2.p2.11.m1.1.2.cmml"><mi id="S4.SS2.p2.11.m1.1.2.2" xref="S4.SS2.p2.11.m1.1.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.11.m1.1.2.1" xref="S4.SS2.p2.11.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p2.11.m1.1.2.3.2" xref="S4.SS2.p2.11.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.11.m1.1.2.3.2.1" xref="S4.SS2.p2.11.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p2.11.m1.1.1" xref="S4.SS2.p2.11.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p2.11.m1.1.2.3.2.2" xref="S4.SS2.p2.11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m1.1b"><apply id="S4.SS2.p2.11.m1.1.2.cmml" xref="S4.SS2.p2.11.m1.1.2"><times id="S4.SS2.p2.11.m1.1.2.1.cmml" xref="S4.SS2.p2.11.m1.1.2.1"></times><ci id="S4.SS2.p2.11.m1.1.2.2.cmml" xref="S4.SS2.p2.11.m1.1.2.2">𝐼</ci><ci id="S4.SS2.p2.11.m1.1.1.cmml" xref="S4.SS2.p2.11.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m1.1c">I(\cdot)</annotation></semantics></math> is an indicator function (<math id="S4.SS2.p2.12.m2.1" class="ltx_Math" alttext="I(E)=1" display="inline"><semantics id="S4.SS2.p2.12.m2.1a"><mrow id="S4.SS2.p2.12.m2.1.2" xref="S4.SS2.p2.12.m2.1.2.cmml"><mrow id="S4.SS2.p2.12.m2.1.2.2" xref="S4.SS2.p2.12.m2.1.2.2.cmml"><mi id="S4.SS2.p2.12.m2.1.2.2.2" xref="S4.SS2.p2.12.m2.1.2.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.12.m2.1.2.2.1" xref="S4.SS2.p2.12.m2.1.2.2.1.cmml">​</mo><mrow id="S4.SS2.p2.12.m2.1.2.2.3.2" xref="S4.SS2.p2.12.m2.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p2.12.m2.1.2.2.3.2.1" xref="S4.SS2.p2.12.m2.1.2.2.cmml">(</mo><mi id="S4.SS2.p2.12.m2.1.1" xref="S4.SS2.p2.12.m2.1.1.cmml">E</mi><mo stretchy="false" id="S4.SS2.p2.12.m2.1.2.2.3.2.2" xref="S4.SS2.p2.12.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.12.m2.1.2.1" xref="S4.SS2.p2.12.m2.1.2.1.cmml">=</mo><mn id="S4.SS2.p2.12.m2.1.2.3" xref="S4.SS2.p2.12.m2.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m2.1b"><apply id="S4.SS2.p2.12.m2.1.2.cmml" xref="S4.SS2.p2.12.m2.1.2"><eq id="S4.SS2.p2.12.m2.1.2.1.cmml" xref="S4.SS2.p2.12.m2.1.2.1"></eq><apply id="S4.SS2.p2.12.m2.1.2.2.cmml" xref="S4.SS2.p2.12.m2.1.2.2"><times id="S4.SS2.p2.12.m2.1.2.2.1.cmml" xref="S4.SS2.p2.12.m2.1.2.2.1"></times><ci id="S4.SS2.p2.12.m2.1.2.2.2.cmml" xref="S4.SS2.p2.12.m2.1.2.2.2">𝐼</ci><ci id="S4.SS2.p2.12.m2.1.1.cmml" xref="S4.SS2.p2.12.m2.1.1">𝐸</ci></apply><cn type="integer" id="S4.SS2.p2.12.m2.1.2.3.cmml" xref="S4.SS2.p2.12.m2.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m2.1c">I(E)=1</annotation></semantics></math> if event <math id="S4.SS2.p2.13.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS2.p2.13.m3.1a"><mi id="S4.SS2.p2.13.m3.1.1" xref="S4.SS2.p2.13.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m3.1b"><ci id="S4.SS2.p2.13.m3.1.1.cmml" xref="S4.SS2.p2.13.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m3.1c">E</annotation></semantics></math> is true, and <math id="S4.SS2.p2.14.m4.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS2.p2.14.m4.1a"><mn id="S4.SS2.p2.14.m4.1.1" xref="S4.SS2.p2.14.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m4.1b"><cn type="integer" id="S4.SS2.p2.14.m4.1.1.cmml" xref="S4.SS2.p2.14.m4.1.1">0</cn></annotation-xml></semantics></math> otherwise). The weight of label correlations is calculated based on the distribute of labels over the dataset. The weight is larger for more dissimilar labels and thus the dispersion would focus more on these labels. Since the number of instances for different labels may vary significantly, we add a normalization term to balance different labels, i.e.,</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.36" class="ltx_Math" alttext="\begin{split}\operatorname{reg}_{\mathrm{cr}}(W)&amp;\!=\!\!\sum_{u\in[C]}\!\left(\gamma_{uu^{\prime}}\sum_{u^{\prime}\neq u}\left(\max\{0,\nu\!-\!d\left(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}}\right)\}\right)^{2}\right),\end{split}" display="block"><semantics id="S4.E10.m1.36a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E10.m1.36.36.3"><mtr id="S4.E10.m1.36.36.3a"><mtd class="ltx_align_right" columnalign="right" id="S4.E10.m1.36.36.3b"><mrow id="S4.E10.m1.35.35.2.34.34.6.6"><msub id="S4.E10.m1.35.35.2.34.34.6.6.1"><mi id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml">reg</mi><mi id="S4.E10.m1.2.2.2.2.2.2.1" xref="S4.E10.m1.2.2.2.2.2.2.1.cmml">cr</mi></msub><mo id="S4.E10.m1.35.35.2.34.34.6.6a" xref="S4.E10.m1.34.34.1.1.1.cmml">⁡</mo><mrow id="S4.E10.m1.35.35.2.34.34.6.6.2"><mo stretchy="false" id="S4.E10.m1.3.3.3.3.3.3" xref="S4.E10.m1.34.34.1.1.1.cmml">(</mo><mi id="S4.E10.m1.4.4.4.4.4.4" xref="S4.E10.m1.4.4.4.4.4.4.cmml">W</mi><mo stretchy="false" id="S4.E10.m1.5.5.5.5.5.5" xref="S4.E10.m1.34.34.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E10.m1.36.36.3c"><mrow id="S4.E10.m1.36.36.3.35.35.29.29"><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1"><mi id="S4.E10.m1.36.36.3.35.35.29.29.1.2" xref="S4.E10.m1.34.34.1.1.1.cmml"></mi><mpadded width="0.726em"><mo lspace="0.108em" id="S4.E10.m1.6.6.6.6.1.1" xref="S4.E10.m1.6.6.6.6.1.1.cmml">=</mo></mpadded><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1"><munder id="S4.E10.m1.36.36.3.35.35.29.29.1.1.2"><mo movablelimits="false" rspace="0em" id="S4.E10.m1.7.7.7.7.2.2" xref="S4.E10.m1.7.7.7.7.2.2.cmml">∑</mo><mrow id="S4.E10.m1.8.8.8.8.3.3.1" xref="S4.E10.m1.8.8.8.8.3.3.1.cmml"><mi id="S4.E10.m1.8.8.8.8.3.3.1.3" xref="S4.E10.m1.8.8.8.8.3.3.1.3.cmml">u</mi><mo id="S4.E10.m1.8.8.8.8.3.3.1.2" xref="S4.E10.m1.8.8.8.8.3.3.1.2.cmml">∈</mo><mrow id="S4.E10.m1.8.8.8.8.3.3.1.4.2" xref="S4.E10.m1.8.8.8.8.3.3.1.4.1.cmml"><mo stretchy="false" id="S4.E10.m1.8.8.8.8.3.3.1.4.2.1" xref="S4.E10.m1.8.8.8.8.3.3.1.4.1.1.cmml">[</mo><mi id="S4.E10.m1.8.8.8.8.3.3.1.1" xref="S4.E10.m1.8.8.8.8.3.3.1.1.cmml">C</mi><mo stretchy="false" id="S4.E10.m1.8.8.8.8.3.3.1.4.2.2" xref="S4.E10.m1.8.8.8.8.3.3.1.4.1.1.cmml">]</mo></mrow></mrow></munder><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1"><mo id="S4.E10.m1.9.9.9.9.4.4" xref="S4.E10.m1.34.34.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1"><msub id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.3"><mi id="S4.E10.m1.10.10.10.10.5.5" xref="S4.E10.m1.10.10.10.10.5.5.cmml">γ</mi><mrow id="S4.E10.m1.11.11.11.11.6.6.1" xref="S4.E10.m1.11.11.11.11.6.6.1.cmml"><mi id="S4.E10.m1.11.11.11.11.6.6.1.2" xref="S4.E10.m1.11.11.11.11.6.6.1.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.11.11.11.11.6.6.1.1" xref="S4.E10.m1.11.11.11.11.6.6.1.1.cmml">​</mo><msup id="S4.E10.m1.11.11.11.11.6.6.1.3" xref="S4.E10.m1.11.11.11.11.6.6.1.3.cmml"><mi id="S4.E10.m1.11.11.11.11.6.6.1.3.2" xref="S4.E10.m1.11.11.11.11.6.6.1.3.2.cmml">u</mi><mo id="S4.E10.m1.11.11.11.11.6.6.1.3.3" xref="S4.E10.m1.11.11.11.11.6.6.1.3.3.cmml">′</mo></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.2" xref="S4.E10.m1.34.34.1.1.1.cmml">​</mo><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1"><munder id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.2"><mo movablelimits="false" rspace="0em" id="S4.E10.m1.12.12.12.12.7.7" xref="S4.E10.m1.12.12.12.12.7.7.cmml">∑</mo><mrow id="S4.E10.m1.13.13.13.13.8.8.1" xref="S4.E10.m1.13.13.13.13.8.8.1.cmml"><msup id="S4.E10.m1.13.13.13.13.8.8.1.2" xref="S4.E10.m1.13.13.13.13.8.8.1.2.cmml"><mi id="S4.E10.m1.13.13.13.13.8.8.1.2.2" xref="S4.E10.m1.13.13.13.13.8.8.1.2.2.cmml">u</mi><mo id="S4.E10.m1.13.13.13.13.8.8.1.2.3" xref="S4.E10.m1.13.13.13.13.8.8.1.2.3.cmml">′</mo></msup><mo id="S4.E10.m1.13.13.13.13.8.8.1.1" xref="S4.E10.m1.13.13.13.13.8.8.1.1.cmml">≠</mo><mi id="S4.E10.m1.13.13.13.13.8.8.1.3" xref="S4.E10.m1.13.13.13.13.8.8.1.3.cmml">u</mi></mrow></munder><msup id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1"><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1"><mo id="S4.E10.m1.14.14.14.14.9.9" xref="S4.E10.m1.34.34.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E10.m1.15.15.15.15.10.10" xref="S4.E10.m1.15.15.15.15.10.10.cmml">max</mi><mo id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1a" xref="S4.E10.m1.34.34.1.1.1.cmml">⁡</mo><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S4.E10.m1.16.16.16.16.11.11" xref="S4.E10.m1.34.34.1.1.1.cmml">{</mo><mn id="S4.E10.m1.17.17.17.17.12.12" xref="S4.E10.m1.17.17.17.17.12.12.cmml">0</mn><mo id="S4.E10.m1.18.18.18.18.13.13" xref="S4.E10.m1.34.34.1.1.1.cmml">,</mo><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E10.m1.19.19.19.19.14.14" xref="S4.E10.m1.19.19.19.19.14.14.cmml">ν</mi><mo lspace="0.052em" rspace="0.052em" id="S4.E10.m1.20.20.20.20.15.15" xref="S4.E10.m1.20.20.20.20.15.15.cmml">−</mo><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mi id="S4.E10.m1.21.21.21.21.16.16" xref="S4.E10.m1.21.21.21.21.16.16.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E10.m1.34.34.1.1.1.cmml">​</mo><mrow id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><mo id="S4.E10.m1.22.22.22.22.17.17" xref="S4.E10.m1.34.34.1.1.1.cmml">(</mo><msub id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E10.m1.23.23.23.23.18.18" xref="S4.E10.m1.23.23.23.23.18.18.cmml">𝐰</mi><mi id="S4.E10.m1.24.24.24.24.19.19.1" xref="S4.E10.m1.24.24.24.24.19.19.1.cmml">u</mi></msub><mo id="S4.E10.m1.25.25.25.25.20.20" xref="S4.E10.m1.34.34.1.1.1.cmml">,</mo><msub id="S4.E10.m1.36.36.3.35.35.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><mi id="S4.E10.m1.26.26.26.26.21.21" xref="S4.E10.m1.26.26.26.26.21.21.cmml">𝐰</mi><msup id="S4.E10.m1.27.27.27.27.22.22.1" xref="S4.E10.m1.27.27.27.27.22.22.1.cmml"><mi id="S4.E10.m1.27.27.27.27.22.22.1.2" xref="S4.E10.m1.27.27.27.27.22.22.1.2.cmml">u</mi><mo id="S4.E10.m1.27.27.27.27.22.22.1.3" xref="S4.E10.m1.27.27.27.27.22.22.1.3.cmml">′</mo></msup></msub><mo id="S4.E10.m1.28.28.28.28.23.23" xref="S4.E10.m1.34.34.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E10.m1.29.29.29.29.24.24" xref="S4.E10.m1.34.34.1.1.1.cmml">}</mo></mrow></mrow><mo id="S4.E10.m1.30.30.30.30.25.25" xref="S4.E10.m1.34.34.1.1.1.cmml">)</mo></mrow><mn id="S4.E10.m1.31.31.31.31.26.26.1" xref="S4.E10.m1.31.31.31.31.26.26.1.cmml">2</mn></msup></mrow></mrow><mo id="S4.E10.m1.32.32.32.32.27.27" xref="S4.E10.m1.34.34.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E10.m1.33.33.33.33.28.28" xref="S4.E10.m1.34.34.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E10.m1.36b"><apply id="S4.E10.m1.34.34.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><eq id="S4.E10.m1.6.6.6.6.1.1.cmml" xref="S4.E10.m1.6.6.6.6.1.1"></eq><apply id="S4.E10.m1.34.34.1.1.1.1.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><apply id="S4.E10.m1.34.34.1.1.1.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><csymbol cd="ambiguous" id="S4.E10.m1.34.34.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1">reg</ci><ci id="S4.E10.m1.2.2.2.2.2.2.1.cmml" xref="S4.E10.m1.2.2.2.2.2.2.1">cr</ci></apply><ci id="S4.E10.m1.4.4.4.4.4.4.cmml" xref="S4.E10.m1.4.4.4.4.4.4">𝑊</ci></apply><apply id="S4.E10.m1.34.34.1.1.1.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><apply id="S4.E10.m1.34.34.1.1.1.2.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><csymbol cd="ambiguous" id="S4.E10.m1.34.34.1.1.1.2.2.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a">subscript</csymbol><sum id="S4.E10.m1.7.7.7.7.2.2.cmml" xref="S4.E10.m1.7.7.7.7.2.2"></sum><apply id="S4.E10.m1.8.8.8.8.3.3.1.cmml" xref="S4.E10.m1.8.8.8.8.3.3.1"><in id="S4.E10.m1.8.8.8.8.3.3.1.2.cmml" xref="S4.E10.m1.8.8.8.8.3.3.1.2"></in><ci id="S4.E10.m1.8.8.8.8.3.3.1.3.cmml" xref="S4.E10.m1.8.8.8.8.3.3.1.3">𝑢</ci><apply id="S4.E10.m1.8.8.8.8.3.3.1.4.1.cmml" xref="S4.E10.m1.8.8.8.8.3.3.1.4.2"><csymbol cd="latexml" id="S4.E10.m1.8.8.8.8.3.3.1.4.1.1.cmml" xref="S4.E10.m1.8.8.8.8.3.3.1.4.2.1">delimited-[]</csymbol><ci id="S4.E10.m1.8.8.8.8.3.3.1.1.cmml" xref="S4.E10.m1.8.8.8.8.3.3.1.1">𝐶</ci></apply></apply></apply><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><times id="S4.E10.m1.34.34.1.1.1.2.1.1.1.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"></times><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.3.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><csymbol cd="ambiguous" id="S4.E10.m1.34.34.1.1.1.2.1.1.1.3.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a">subscript</csymbol><ci id="S4.E10.m1.10.10.10.10.5.5.cmml" xref="S4.E10.m1.10.10.10.10.5.5">𝛾</ci><apply id="S4.E10.m1.11.11.11.11.6.6.1.cmml" xref="S4.E10.m1.11.11.11.11.6.6.1"><times id="S4.E10.m1.11.11.11.11.6.6.1.1.cmml" xref="S4.E10.m1.11.11.11.11.6.6.1.1"></times><ci id="S4.E10.m1.11.11.11.11.6.6.1.2.cmml" xref="S4.E10.m1.11.11.11.11.6.6.1.2">𝑢</ci><apply id="S4.E10.m1.11.11.11.11.6.6.1.3.cmml" xref="S4.E10.m1.11.11.11.11.6.6.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.11.11.6.6.1.3.1.cmml" xref="S4.E10.m1.11.11.11.11.6.6.1.3">superscript</csymbol><ci id="S4.E10.m1.11.11.11.11.6.6.1.3.2.cmml" xref="S4.E10.m1.11.11.11.11.6.6.1.3.2">𝑢</ci><ci id="S4.E10.m1.11.11.11.11.6.6.1.3.3.cmml" xref="S4.E10.m1.11.11.11.11.6.6.1.3.3">′</ci></apply></apply></apply><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><csymbol cd="ambiguous" id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a">subscript</csymbol><sum id="S4.E10.m1.12.12.12.12.7.7.cmml" xref="S4.E10.m1.12.12.12.12.7.7"></sum><apply id="S4.E10.m1.13.13.13.13.8.8.1.cmml" xref="S4.E10.m1.13.13.13.13.8.8.1"><neq id="S4.E10.m1.13.13.13.13.8.8.1.1.cmml" xref="S4.E10.m1.13.13.13.13.8.8.1.1"></neq><apply id="S4.E10.m1.13.13.13.13.8.8.1.2.cmml" xref="S4.E10.m1.13.13.13.13.8.8.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.13.13.13.13.8.8.1.2.1.cmml" xref="S4.E10.m1.13.13.13.13.8.8.1.2">superscript</csymbol><ci id="S4.E10.m1.13.13.13.13.8.8.1.2.2.cmml" xref="S4.E10.m1.13.13.13.13.8.8.1.2.2">𝑢</ci><ci id="S4.E10.m1.13.13.13.13.8.8.1.2.3.cmml" xref="S4.E10.m1.13.13.13.13.8.8.1.2.3">′</ci></apply><ci id="S4.E10.m1.13.13.13.13.8.8.1.3.cmml" xref="S4.E10.m1.13.13.13.13.8.8.1.3">𝑢</ci></apply></apply><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><csymbol cd="ambiguous" id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a">superscript</csymbol><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><max id="S4.E10.m1.15.15.15.15.10.10.cmml" xref="S4.E10.m1.15.15.15.15.10.10"></max><cn type="integer" id="S4.E10.m1.17.17.17.17.12.12.cmml" xref="S4.E10.m1.17.17.17.17.12.12">0</cn><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><minus id="S4.E10.m1.20.20.20.20.15.15.cmml" xref="S4.E10.m1.20.20.20.20.15.15"></minus><ci id="S4.E10.m1.19.19.19.19.14.14.cmml" xref="S4.E10.m1.19.19.19.19.14.14">𝜈</ci><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><times id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"></times><ci id="S4.E10.m1.21.21.21.21.16.16.cmml" xref="S4.E10.m1.21.21.21.21.16.16">𝑑</ci><interval closure="open" id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><csymbol cd="ambiguous" id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a">subscript</csymbol><ci id="S4.E10.m1.23.23.23.23.18.18.cmml" xref="S4.E10.m1.23.23.23.23.18.18">𝐰</ci><ci id="S4.E10.m1.24.24.24.24.19.19.1.cmml" xref="S4.E10.m1.24.24.24.24.19.19.1">𝑢</ci></apply><apply id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a"><csymbol cd="ambiguous" id="S4.E10.m1.34.34.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E10.m1.35.35.2.34.34.6.6a">subscript</csymbol><ci id="S4.E10.m1.26.26.26.26.21.21.cmml" xref="S4.E10.m1.26.26.26.26.21.21">𝐰</ci><apply id="S4.E10.m1.27.27.27.27.22.22.1.cmml" xref="S4.E10.m1.27.27.27.27.22.22.1"><csymbol cd="ambiguous" id="S4.E10.m1.27.27.27.27.22.22.1.1.cmml" xref="S4.E10.m1.27.27.27.27.22.22.1">superscript</csymbol><ci id="S4.E10.m1.27.27.27.27.22.22.1.2.cmml" xref="S4.E10.m1.27.27.27.27.22.22.1.2">𝑢</ci><ci id="S4.E10.m1.27.27.27.27.22.22.1.3.cmml" xref="S4.E10.m1.27.27.27.27.22.22.1.3">′</ci></apply></apply></interval></apply></apply></apply><cn type="integer" id="S4.E10.m1.31.31.31.31.26.26.1.cmml" xref="S4.E10.m1.31.31.31.31.26.26.1">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.36c">\begin{split}\operatorname{reg}_{\mathrm{cr}}(W)&amp;\!=\!\!\sum_{u\in[C]}\!\left(\gamma_{uu^{\prime}}\sum_{u^{\prime}\neq u}\left(\max\{0,\nu\!-\!d\left(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}}\right)\}\right)^{2}\right),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.16" class="ltx_p">where <math id="S4.SS2.p2.15.m1.1" class="ltx_Math" alttext="\gamma_{uu^{\prime}}=\frac{\sigma_{uu^{\prime}}}{\sum_{u^{\prime}\neq u}{\sigma_{uu^{\prime}}}}" display="inline"><semantics id="S4.SS2.p2.15.m1.1a"><mrow id="S4.SS2.p2.15.m1.1.1" xref="S4.SS2.p2.15.m1.1.1.cmml"><msub id="S4.SS2.p2.15.m1.1.1.2" xref="S4.SS2.p2.15.m1.1.1.2.cmml"><mi id="S4.SS2.p2.15.m1.1.1.2.2" xref="S4.SS2.p2.15.m1.1.1.2.2.cmml">γ</mi><mrow id="S4.SS2.p2.15.m1.1.1.2.3" xref="S4.SS2.p2.15.m1.1.1.2.3.cmml"><mi id="S4.SS2.p2.15.m1.1.1.2.3.2" xref="S4.SS2.p2.15.m1.1.1.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.15.m1.1.1.2.3.1" xref="S4.SS2.p2.15.m1.1.1.2.3.1.cmml">​</mo><msup id="S4.SS2.p2.15.m1.1.1.2.3.3" xref="S4.SS2.p2.15.m1.1.1.2.3.3.cmml"><mi id="S4.SS2.p2.15.m1.1.1.2.3.3.2" xref="S4.SS2.p2.15.m1.1.1.2.3.3.2.cmml">u</mi><mo id="S4.SS2.p2.15.m1.1.1.2.3.3.3" xref="S4.SS2.p2.15.m1.1.1.2.3.3.3.cmml">′</mo></msup></mrow></msub><mo id="S4.SS2.p2.15.m1.1.1.1" xref="S4.SS2.p2.15.m1.1.1.1.cmml">=</mo><mfrac id="S4.SS2.p2.15.m1.1.1.3" xref="S4.SS2.p2.15.m1.1.1.3.cmml"><msub id="S4.SS2.p2.15.m1.1.1.3.2" xref="S4.SS2.p2.15.m1.1.1.3.2.cmml"><mi id="S4.SS2.p2.15.m1.1.1.3.2.2" xref="S4.SS2.p2.15.m1.1.1.3.2.2.cmml">σ</mi><mrow id="S4.SS2.p2.15.m1.1.1.3.2.3" xref="S4.SS2.p2.15.m1.1.1.3.2.3.cmml"><mi id="S4.SS2.p2.15.m1.1.1.3.2.3.2" xref="S4.SS2.p2.15.m1.1.1.3.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.15.m1.1.1.3.2.3.1" xref="S4.SS2.p2.15.m1.1.1.3.2.3.1.cmml">​</mo><msup id="S4.SS2.p2.15.m1.1.1.3.2.3.3" xref="S4.SS2.p2.15.m1.1.1.3.2.3.3.cmml"><mi id="S4.SS2.p2.15.m1.1.1.3.2.3.3.2" xref="S4.SS2.p2.15.m1.1.1.3.2.3.3.2.cmml">u</mi><mo id="S4.SS2.p2.15.m1.1.1.3.2.3.3.3" xref="S4.SS2.p2.15.m1.1.1.3.2.3.3.3.cmml">′</mo></msup></mrow></msub><mrow id="S4.SS2.p2.15.m1.1.1.3.3" xref="S4.SS2.p2.15.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="S4.SS2.p2.15.m1.1.1.3.3.1" xref="S4.SS2.p2.15.m1.1.1.3.3.1.cmml"><msub id="S4.SS2.p2.15.m1.1.1.3.3.1a" xref="S4.SS2.p2.15.m1.1.1.3.3.1.cmml"><mo id="S4.SS2.p2.15.m1.1.1.3.3.1.2" xref="S4.SS2.p2.15.m1.1.1.3.3.1.2.cmml">∑</mo><mrow id="S4.SS2.p2.15.m1.1.1.3.3.1.3" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.cmml"><msup id="S4.SS2.p2.15.m1.1.1.3.3.1.3.2" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.cmml"><mi id="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.2" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.2.cmml">u</mi><mo id="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.3" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.3.cmml">′</mo></msup><mo id="S4.SS2.p2.15.m1.1.1.3.3.1.3.1" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.1.cmml">≠</mo><mi id="S4.SS2.p2.15.m1.1.1.3.3.1.3.3" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.3.cmml">u</mi></mrow></msub></mstyle><msub id="S4.SS2.p2.15.m1.1.1.3.3.2" xref="S4.SS2.p2.15.m1.1.1.3.3.2.cmml"><mi id="S4.SS2.p2.15.m1.1.1.3.3.2.2" xref="S4.SS2.p2.15.m1.1.1.3.3.2.2.cmml">σ</mi><mrow id="S4.SS2.p2.15.m1.1.1.3.3.2.3" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.cmml"><mi id="S4.SS2.p2.15.m1.1.1.3.3.2.3.2" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.15.m1.1.1.3.3.2.3.1" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.1.cmml">​</mo><msup id="S4.SS2.p2.15.m1.1.1.3.3.2.3.3" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.cmml"><mi id="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.2" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.2.cmml">u</mi><mo id="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.3" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.3.cmml">′</mo></msup></mrow></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m1.1b"><apply id="S4.SS2.p2.15.m1.1.1.cmml" xref="S4.SS2.p2.15.m1.1.1"><eq id="S4.SS2.p2.15.m1.1.1.1.cmml" xref="S4.SS2.p2.15.m1.1.1.1"></eq><apply id="S4.SS2.p2.15.m1.1.1.2.cmml" xref="S4.SS2.p2.15.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.2.1.cmml" xref="S4.SS2.p2.15.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.2.2.cmml" xref="S4.SS2.p2.15.m1.1.1.2.2">𝛾</ci><apply id="S4.SS2.p2.15.m1.1.1.2.3.cmml" xref="S4.SS2.p2.15.m1.1.1.2.3"><times id="S4.SS2.p2.15.m1.1.1.2.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.2.3.1"></times><ci id="S4.SS2.p2.15.m1.1.1.2.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.2.3.2">𝑢</ci><apply id="S4.SS2.p2.15.m1.1.1.2.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.2.3.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.2.3.3">superscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.2.3.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.2.3.3.2">𝑢</ci><ci id="S4.SS2.p2.15.m1.1.1.2.3.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.2.3.3.3">′</ci></apply></apply></apply><apply id="S4.SS2.p2.15.m1.1.1.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3"><divide id="S4.SS2.p2.15.m1.1.1.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3"></divide><apply id="S4.SS2.p2.15.m1.1.1.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.3.2.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.3.2.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2.2">𝜎</ci><apply id="S4.SS2.p2.15.m1.1.1.3.2.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2.3"><times id="S4.SS2.p2.15.m1.1.1.3.2.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2.3.1"></times><ci id="S4.SS2.p2.15.m1.1.1.3.2.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2.3.2">𝑢</ci><apply id="S4.SS2.p2.15.m1.1.1.3.2.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.3.2.3.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2.3.3">superscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.3.2.3.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2.3.3.2">𝑢</ci><ci id="S4.SS2.p2.15.m1.1.1.3.2.3.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2.3.3.3">′</ci></apply></apply></apply><apply id="S4.SS2.p2.15.m1.1.1.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3"><apply id="S4.SS2.p2.15.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.3.3.1.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1">subscript</csymbol><sum id="S4.SS2.p2.15.m1.1.1.3.3.1.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1.2"></sum><apply id="S4.SS2.p2.15.m1.1.1.3.3.1.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3"><neq id="S4.SS2.p2.15.m1.1.1.3.3.1.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.1"></neq><apply id="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.2">superscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.2">𝑢</ci><ci id="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.2.3">′</ci></apply><ci id="S4.SS2.p2.15.m1.1.1.3.3.1.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1.3.3">𝑢</ci></apply></apply><apply id="S4.SS2.p2.15.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.3.3.2.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.3.3.2.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.2">𝜎</ci><apply id="S4.SS2.p2.15.m1.1.1.3.3.2.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3"><times id="S4.SS2.p2.15.m1.1.1.3.3.2.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.1"></times><ci id="S4.SS2.p2.15.m1.1.1.3.3.2.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.2">𝑢</ci><apply id="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.3">superscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.2">𝑢</ci><ci id="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.3.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m1.1c">\gamma_{uu^{\prime}}=\frac{\sigma_{uu^{\prime}}}{\sum_{u^{\prime}\neq u}{\sigma_{uu^{\prime}}}}</annotation></semantics></math>.
To avoid the exhaustive tuning of hyper-parameter <math id="S4.SS2.p2.16.m2.1" class="ltx_Math" alttext="\nu" display="inline"><semantics id="S4.SS2.p2.16.m2.1a"><mi id="S4.SS2.p2.16.m2.1.1" xref="S4.SS2.p2.16.m2.1.1.cmml">ν</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.m2.1b"><ci id="S4.SS2.p2.16.m2.1.1.cmml" xref="S4.SS2.p2.16.m2.1.1">𝜈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.m2.1c">\nu</annotation></semantics></math>, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> to employ a negative mining strategy and reformulate (<a href="#S4.E8" title="In IV-B Spreadout by exploring label correlations (FedALC) ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) as:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.37" class="ltx_math_unparsed" alttext="\begin{split}\operatorname{reg}_{\mathrm{cr}}^{\mathrm{top}}(W)&amp;\!=\!\!\sum_{u\in[C]}\!\!\left(\sigma_{uu^{\prime}}\sum_{u^{\prime}\neq u,\atop u^{\prime}\in\mathcal{N}_{\mathcal{K}}(u)}\left(\max\left(0,\nu\!-\!d(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}})\right)\right)^{2}\right),\end{split}" display="block"><semantics id="S4.E11.m1.37a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E11.m1.37.37.3"><mtr id="S4.E11.m1.37.37.3a"><mtd class="ltx_align_right" columnalign="right" id="S4.E11.m1.37.37.3b"><mrow id="S4.E11.m1.36.36.2.35.35.7.7"><msubsup id="S4.E11.m1.36.36.2.35.35.7.7.1"><mi id="S4.E11.m1.1.1.1.1.1.1">reg</mi><mi id="S4.E11.m1.2.2.2.2.2.2.1">cr</mi><mi id="S4.E11.m1.3.3.3.3.3.3.1">top</mi></msubsup><mo id="S4.E11.m1.36.36.2.35.35.7.7a">⁡</mo><mrow id="S4.E11.m1.36.36.2.35.35.7.7.2"><mo stretchy="false" id="S4.E11.m1.4.4.4.4.4.4">(</mo><mi id="S4.E11.m1.5.5.5.5.5.5">W</mi><mo stretchy="false" id="S4.E11.m1.6.6.6.6.6.6">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E11.m1.37.37.3c"><mrow id="S4.E11.m1.37.37.3.36.36.29.29"><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1"><mi id="S4.E11.m1.37.37.3.36.36.29.29.1.2"></mi><mpadded width="0.726em"><mo lspace="0.108em" id="S4.E11.m1.7.7.7.7.1.1">=</mo></mpadded><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1"><munder id="S4.E11.m1.37.37.3.36.36.29.29.1.1.2"><mo movablelimits="false" rspace="0em" id="S4.E11.m1.8.8.8.8.2.2">∑</mo><mrow id="S4.E11.m1.9.9.9.9.3.3.1"><mi id="S4.E11.m1.9.9.9.9.3.3.1.3">u</mi><mo id="S4.E11.m1.9.9.9.9.3.3.1.2">∈</mo><mrow id="S4.E11.m1.9.9.9.9.3.3.1.4.2"><mo stretchy="false" id="S4.E11.m1.9.9.9.9.3.3.1.4.2.1">[</mo><mi id="S4.E11.m1.9.9.9.9.3.3.1.1">C</mi><mo stretchy="false" id="S4.E11.m1.9.9.9.9.3.3.1.4.2.2">]</mo></mrow></mrow></munder><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1"><mo id="S4.E11.m1.10.10.10.10.4.4">(</mo><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1"><msub id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.3"><mi id="S4.E11.m1.11.11.11.11.5.5">σ</mi><mrow id="S4.E11.m1.12.12.12.12.6.6.1"><mi id="S4.E11.m1.12.12.12.12.6.6.1.2">u</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.12.12.12.12.6.6.1.1">​</mo><msup id="S4.E11.m1.12.12.12.12.6.6.1.3"><mi id="S4.E11.m1.12.12.12.12.6.6.1.3.2">u</mi><mo id="S4.E11.m1.12.12.12.12.6.6.1.3.3">′</mo></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.2">​</mo><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1"><munder id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.2"><mo movablelimits="false" rspace="0em" id="S4.E11.m1.13.13.13.13.7.7">∑</mo><mfrac linethickness="0pt" id="S4.E11.m1.14.14.14.14.8.8.1"><mrow id="S4.E11.m1.14.14.14.14.8.8.1.3"><msup id="S4.E11.m1.14.14.14.14.8.8.1.3.1"><mi id="S4.E11.m1.14.14.14.14.8.8.1.3.1.2">u</mi><mo id="S4.E11.m1.14.14.14.14.8.8.1.3.1.3">′</mo></msup><mo id="S4.E11.m1.14.14.14.14.8.8.1.3.2">≠</mo><mi id="S4.E11.m1.14.14.14.14.8.8.1.3.3">u</mi><mo id="S4.E11.m1.14.14.14.14.8.8.1.3.4">,</mo></mrow><mrow id="S4.E11.m1.14.14.14.14.8.8.1.1.1"><msup id="S4.E11.m1.14.14.14.14.8.8.1.1.1.3"><mi id="S4.E11.m1.14.14.14.14.8.8.1.1.1.3.2">u</mi><mo id="S4.E11.m1.14.14.14.14.8.8.1.1.1.3.3">′</mo></msup><mo id="S4.E11.m1.14.14.14.14.8.8.1.1.1.2">∈</mo><mrow id="S4.E11.m1.14.14.14.14.8.8.1.1.1.4"><msub id="S4.E11.m1.14.14.14.14.8.8.1.1.1.4.2"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.14.14.14.14.8.8.1.1.1.4.2.2">𝒩</mi><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.14.14.14.14.8.8.1.1.1.4.2.3">𝒦</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.14.14.14.14.8.8.1.1.1.4.1">​</mo><mrow id="S4.E11.m1.14.14.14.14.8.8.1.1.1.4.3.2"><mo stretchy="false" id="S4.E11.m1.14.14.14.14.8.8.1.1.1.4.3.2.1">(</mo><mi id="S4.E11.m1.14.14.14.14.8.8.1.1.1.1">u</mi><mo stretchy="false" id="S4.E11.m1.14.14.14.14.8.8.1.1.1.4.3.2.2">)</mo></mrow></mrow></mrow></mfrac></munder><msup id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1"><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1"><mo id="S4.E11.m1.15.15.15.15.9.9">(</mo><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E11.m1.16.16.16.16.10.10">max</mi><mo id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1a">⁡</mo><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1.1.1"><mo id="S4.E11.m1.17.17.17.17.11.11">(</mo><mn id="S4.E11.m1.18.18.18.18.12.12">0</mn><mo id="S4.E11.m1.19.19.19.19.13.13">,</mo><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E11.m1.20.20.20.20.14.14">ν</mi><mo lspace="0.052em" rspace="0.052em" id="S4.E11.m1.21.21.21.21.15.15">−</mo><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mi id="S4.E11.m1.22.22.22.22.16.16">d</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">​</mo><mrow id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><mo stretchy="false" id="S4.E11.m1.23.23.23.23.17.17">(</mo><msub id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E11.m1.24.24.24.24.18.18">𝐰</mi><mi id="S4.E11.m1.25.25.25.25.19.19.1">u</mi></msub><mo id="S4.E11.m1.26.26.26.26.20.20">,</mo><msub id="S4.E11.m1.37.37.3.36.36.29.29.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><mi id="S4.E11.m1.27.27.27.27.21.21">𝐰</mi><msup id="S4.E11.m1.28.28.28.28.22.22.1"><mi id="S4.E11.m1.28.28.28.28.22.22.1.2">u</mi><mo id="S4.E11.m1.28.28.28.28.22.22.1.3">′</mo></msup></msub><mo stretchy="false" id="S4.E11.m1.29.29.29.29.23.23">)</mo></mrow></mrow></mrow><mo id="S4.E11.m1.30.30.30.30.24.24">)</mo></mrow></mrow><mo id="S4.E11.m1.31.31.31.31.25.25">)</mo></mrow><mn id="S4.E11.m1.32.32.32.32.26.26.1">2</mn></msup></mrow></mrow><mo id="S4.E11.m1.33.33.33.33.27.27">)</mo></mrow></mrow></mrow><mo id="S4.E11.m1.34.34.34.34.28.28">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E11.m1.37b">\begin{split}\operatorname{reg}_{\mathrm{cr}}^{\mathrm{top}}(W)&amp;\!=\!\!\sum_{u\in[C]}\!\!\left(\sigma_{uu^{\prime}}\sum_{u^{\prime}\neq u,\atop u^{\prime}\in\mathcal{N}_{\mathcal{K}}(u)}\left(\max\left(0,\nu\!-\!d(\mathbf{w}_{u},\mathbf{w}_{u^{\prime}})\right)\right)^{2}\right),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.22" class="ltx_p">where <math id="S4.SS2.p2.17.m1.1" class="ltx_Math" alttext="\mathcal{K}" display="inline"><semantics id="S4.SS2.p2.17.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.17.m1.1.1" xref="S4.SS2.p2.17.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.17.m1.1b"><ci id="S4.SS2.p2.17.m1.1.1.cmml" xref="S4.SS2.p2.17.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.17.m1.1c">\mathcal{K}</annotation></semantics></math> is the number of a subset of classes, and <math id="S4.SS2.p2.18.m2.1" class="ltx_Math" alttext="\mathcal{N}_{k}(u)" display="inline"><semantics id="S4.SS2.p2.18.m2.1a"><mrow id="S4.SS2.p2.18.m2.1.2" xref="S4.SS2.p2.18.m2.1.2.cmml"><msub id="S4.SS2.p2.18.m2.1.2.2" xref="S4.SS2.p2.18.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.18.m2.1.2.2.2" xref="S4.SS2.p2.18.m2.1.2.2.2.cmml">𝒩</mi><mi id="S4.SS2.p2.18.m2.1.2.2.3" xref="S4.SS2.p2.18.m2.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.18.m2.1.2.1" xref="S4.SS2.p2.18.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.p2.18.m2.1.2.3.2" xref="S4.SS2.p2.18.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.18.m2.1.2.3.2.1" xref="S4.SS2.p2.18.m2.1.2.cmml">(</mo><mi id="S4.SS2.p2.18.m2.1.1" xref="S4.SS2.p2.18.m2.1.1.cmml">u</mi><mo stretchy="false" id="S4.SS2.p2.18.m2.1.2.3.2.2" xref="S4.SS2.p2.18.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.18.m2.1b"><apply id="S4.SS2.p2.18.m2.1.2.cmml" xref="S4.SS2.p2.18.m2.1.2"><times id="S4.SS2.p2.18.m2.1.2.1.cmml" xref="S4.SS2.p2.18.m2.1.2.1"></times><apply id="S4.SS2.p2.18.m2.1.2.2.cmml" xref="S4.SS2.p2.18.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.18.m2.1.2.2.1.cmml" xref="S4.SS2.p2.18.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.18.m2.1.2.2.2.cmml" xref="S4.SS2.p2.18.m2.1.2.2.2">𝒩</ci><ci id="S4.SS2.p2.18.m2.1.2.2.3.cmml" xref="S4.SS2.p2.18.m2.1.2.2.3">𝑘</ci></apply><ci id="S4.SS2.p2.18.m2.1.1.cmml" xref="S4.SS2.p2.18.m2.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.18.m2.1c">\mathcal{N}_{k}(u)</annotation></semantics></math> is the set of <math id="S4.SS2.p2.19.m3.1" class="ltx_Math" alttext="\mathcal{K}" display="inline"><semantics id="S4.SS2.p2.19.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.19.m3.1.1" xref="S4.SS2.p2.19.m3.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.19.m3.1b"><ci id="S4.SS2.p2.19.m3.1.1.cmml" xref="S4.SS2.p2.19.m3.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.19.m3.1c">\mathcal{K}</annotation></semantics></math> classes that are most close to the class <math id="S4.SS2.p2.20.m4.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S4.SS2.p2.20.m4.1a"><mi id="S4.SS2.p2.20.m4.1.1" xref="S4.SS2.p2.20.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.20.m4.1b"><ci id="S4.SS2.p2.20.m4.1.1.cmml" xref="S4.SS2.p2.20.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.20.m4.1c">u</annotation></semantics></math> in the embedding space. We can also normalize the weight of correlations <math id="S4.SS2.p2.21.m5.1" class="ltx_Math" alttext="\sigma_{uu^{\prime}}" display="inline"><semantics id="S4.SS2.p2.21.m5.1a"><msub id="S4.SS2.p2.21.m5.1.1" xref="S4.SS2.p2.21.m5.1.1.cmml"><mi id="S4.SS2.p2.21.m5.1.1.2" xref="S4.SS2.p2.21.m5.1.1.2.cmml">σ</mi><mrow id="S4.SS2.p2.21.m5.1.1.3" xref="S4.SS2.p2.21.m5.1.1.3.cmml"><mi id="S4.SS2.p2.21.m5.1.1.3.2" xref="S4.SS2.p2.21.m5.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.21.m5.1.1.3.1" xref="S4.SS2.p2.21.m5.1.1.3.1.cmml">​</mo><msup id="S4.SS2.p2.21.m5.1.1.3.3" xref="S4.SS2.p2.21.m5.1.1.3.3.cmml"><mi id="S4.SS2.p2.21.m5.1.1.3.3.2" xref="S4.SS2.p2.21.m5.1.1.3.3.2.cmml">u</mi><mo id="S4.SS2.p2.21.m5.1.1.3.3.3" xref="S4.SS2.p2.21.m5.1.1.3.3.3.cmml">′</mo></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.21.m5.1b"><apply id="S4.SS2.p2.21.m5.1.1.cmml" xref="S4.SS2.p2.21.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.21.m5.1.1.1.cmml" xref="S4.SS2.p2.21.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.21.m5.1.1.2.cmml" xref="S4.SS2.p2.21.m5.1.1.2">𝜎</ci><apply id="S4.SS2.p2.21.m5.1.1.3.cmml" xref="S4.SS2.p2.21.m5.1.1.3"><times id="S4.SS2.p2.21.m5.1.1.3.1.cmml" xref="S4.SS2.p2.21.m5.1.1.3.1"></times><ci id="S4.SS2.p2.21.m5.1.1.3.2.cmml" xref="S4.SS2.p2.21.m5.1.1.3.2">𝑢</ci><apply id="S4.SS2.p2.21.m5.1.1.3.3.cmml" xref="S4.SS2.p2.21.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.21.m5.1.1.3.3.1.cmml" xref="S4.SS2.p2.21.m5.1.1.3.3">superscript</csymbol><ci id="S4.SS2.p2.21.m5.1.1.3.3.2.cmml" xref="S4.SS2.p2.21.m5.1.1.3.3.2">𝑢</ci><ci id="S4.SS2.p2.21.m5.1.1.3.3.3.cmml" xref="S4.SS2.p2.21.m5.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.21.m5.1c">\sigma_{uu^{\prime}}</annotation></semantics></math> to obtain <math id="S4.SS2.p2.22.m6.1" class="ltx_Math" alttext="\gamma_{uu^{\prime}}" display="inline"><semantics id="S4.SS2.p2.22.m6.1a"><msub id="S4.SS2.p2.22.m6.1.1" xref="S4.SS2.p2.22.m6.1.1.cmml"><mi id="S4.SS2.p2.22.m6.1.1.2" xref="S4.SS2.p2.22.m6.1.1.2.cmml">γ</mi><mrow id="S4.SS2.p2.22.m6.1.1.3" xref="S4.SS2.p2.22.m6.1.1.3.cmml"><mi id="S4.SS2.p2.22.m6.1.1.3.2" xref="S4.SS2.p2.22.m6.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.22.m6.1.1.3.1" xref="S4.SS2.p2.22.m6.1.1.3.1.cmml">​</mo><msup id="S4.SS2.p2.22.m6.1.1.3.3" xref="S4.SS2.p2.22.m6.1.1.3.3.cmml"><mi id="S4.SS2.p2.22.m6.1.1.3.3.2" xref="S4.SS2.p2.22.m6.1.1.3.3.2.cmml">u</mi><mo id="S4.SS2.p2.22.m6.1.1.3.3.3" xref="S4.SS2.p2.22.m6.1.1.3.3.3.cmml">′</mo></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.22.m6.1b"><apply id="S4.SS2.p2.22.m6.1.1.cmml" xref="S4.SS2.p2.22.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.22.m6.1.1.1.cmml" xref="S4.SS2.p2.22.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.22.m6.1.1.2.cmml" xref="S4.SS2.p2.22.m6.1.1.2">𝛾</ci><apply id="S4.SS2.p2.22.m6.1.1.3.cmml" xref="S4.SS2.p2.22.m6.1.1.3"><times id="S4.SS2.p2.22.m6.1.1.3.1.cmml" xref="S4.SS2.p2.22.m6.1.1.3.1"></times><ci id="S4.SS2.p2.22.m6.1.1.3.2.cmml" xref="S4.SS2.p2.22.m6.1.1.3.2">𝑢</ci><apply id="S4.SS2.p2.22.m6.1.1.3.3.cmml" xref="S4.SS2.p2.22.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.22.m6.1.1.3.3.1.cmml" xref="S4.SS2.p2.22.m6.1.1.3.3">superscript</csymbol><ci id="S4.SS2.p2.22.m6.1.1.3.3.2.cmml" xref="S4.SS2.p2.22.m6.1.1.3.3.2">𝑢</ci><ci id="S4.SS2.p2.22.m6.1.1.3.3.3.cmml" xref="S4.SS2.p2.22.m6.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.22.m6.1c">\gamma_{uu^{\prime}}</annotation></semantics></math> in this case. From the instance viewpoint, our correlation regularizer regards the set of positive class embeddings as the surrogate of its instance embeddings in the client negative loss of Eq. (<a href="#S3.E1" title="In III Problem Formulation ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Hence, the surrogate negative loss doesn’t need instance embeddings and only needs class embeddings, which can be accessed in the server. According to the class embedding matrix and collected label sets, the surrogate negative losses of all clients can be jointly calculated on the server-side. Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-B Spreadout by exploring label correlations (FedALC) ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the mechanism of our correlation regularizer under the federated learning paradigms.
Under the federated learning paradigm, in the client optimization, the local steps presented in Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> enforce the instance embedding to be close to positive class embeddings. On the server side, the correlation regularizer makes the positive and negative class embeddings stay away from each other.
In general, there tend to be more negative class pairs than positive class pairs. In specific tasks, such as the AmazonCat dataset containing 13000 labels, a label typically triggers a positive class pair with approximately five other labels on average. Moreover, each label can potentially form a negative
class pair with most of the other labels within 13000. Consequently, the quantity of negative class pairs is significantly higher. Storing the negative class pairs necessitates 4GB of storage, which constitutes a substantial resource overhead, whereas storing the positive class pairs only requires 800MB. The burden of storing negative class pairs may prove to be overly taxing for practical FL scenarios.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2404.15598/assets/x3.png" id="S4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="320" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>FedALC with a fixed class embedding matrix. On the server side, positive class embeddings are enforced to be close and separated from negative class embeddings. Then the fixed class embeddings are obtained; On the client side, the instance are enforced to approach its positive classes.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.4.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.5.2" class="ltx_text ltx_font_italic">Learning fixed class embedding (FedALC-fixed)</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In the above mentioned approach, the class embeddings are transmitted frequently between the server and clients. This may lead to the occurrence of privacy leakage, since the class embedding may contain the identity information of users.
To remedy this drawback and also reduce the communication overhead and computational cost, we propose a variant of our method to learn fixed class embeddings so that the transmission of class embeddings is performed only once. Since we want the class embedding matrix to be fixed and cannot be updated alternatively, the learned embedding matrix should be of high quality. This is achieved by using the positive class embedding to replace the corresponding instance embedding in both terms of Eq. (<a href="#S3.E1" title="In III Problem Formulation ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) to learn a fixed class embedding matrix. According to the distribution of label sets, we define the correlation regularizer for learning the fixed class embedding matrix as follows:</p>
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.108" class="ltx_math_unparsed" alttext="\begin{split}&amp;\mathrm{reg}_{\mathrm{fc}}(W)=\sum_{i\in[m]}\frac{|\mathcal{S}^{i}|}{|\mathcal{S}|}\left((\hat{\mathcal{R}}_{\mathrm{pos}}\left(\mathcal{S}^{i}\right)+\hat{\mathcal{R}}_{\mathrm{neg}}\left(\mathcal{S}^{i}\right)\right)\\
&amp;=\frac{1}{n_{all}}\sum\limits_{i\in[m]}\sum\limits_{j\in[n_{i}]}\left(\ell^{\mathrm{pos}}_{cl}({L_{j}^{P}},{L_{j}^{N}},W)+\ell^{\mathrm{neg}}_{cl}({L_{j}^{P}},{L_{j}^{N}},W)\right)\\
&amp;=\frac{1}{n_{all}}\sum\limits_{j\in[n_{\mathrm{all}}]}\left(\alpha\cdot\sum\limits_{y_{j}\in L_{j}^{P},\atop y_{j}^{\prime}\in L_{j}^{P}\And y_{j}^{\prime}\neq y_{j}}\left(d(\mathbf{w}_{y_{j}},\mathbf{w}_{y_{j}^{\prime}})\right)^{2}\right.\\
&amp;\left.+\beta\cdot\sum\limits_{y_{j}\in L_{j}^{P},\atop y_{j}^{\prime}\in L_{j}^{N}}\left(\max\left\{0,\nu-d(\mathbf{w}_{y_{j}},\mathbf{w}_{y_{j}^{\prime}})\right\}\right)^{2}\right).\end{split}" display="block"><semantics id="S4.E12.m1.108a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E12.m1.108.108.1"><mtr id="S4.E12.m1.108.108.1a"><mtd id="S4.E12.m1.108.108.1b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.108.108.1c"><mrow id="S4.E12.m1.25.25.25.25.25"><msub id="S4.E12.m1.25.25.25.25.25.26"><mi id="S4.E12.m1.1.1.1.1.1.1">reg</mi><mi id="S4.E12.m1.2.2.2.2.2.2.1">fc</mi></msub><mrow id="S4.E12.m1.25.25.25.25.25.27"><mo stretchy="false" id="S4.E12.m1.3.3.3.3.3.3">(</mo><mi id="S4.E12.m1.4.4.4.4.4.4">W</mi><mo stretchy="false" id="S4.E12.m1.5.5.5.5.5.5">)</mo></mrow><mo rspace="0.111em" id="S4.E12.m1.6.6.6.6.6.6">=</mo><munder id="S4.E12.m1.25.25.25.25.25.28"><mo movablelimits="false" id="S4.E12.m1.7.7.7.7.7.7">∑</mo><mrow id="S4.E12.m1.8.8.8.8.8.8.1"><mi id="S4.E12.m1.8.8.8.8.8.8.1.3">i</mi><mo id="S4.E12.m1.8.8.8.8.8.8.1.2">∈</mo><mrow id="S4.E12.m1.8.8.8.8.8.8.1.4.2"><mo stretchy="false" id="S4.E12.m1.8.8.8.8.8.8.1.4.2.1">[</mo><mi id="S4.E12.m1.8.8.8.8.8.8.1.1">m</mi><mo stretchy="false" id="S4.E12.m1.8.8.8.8.8.8.1.4.2.2">]</mo></mrow></mrow></munder><mfrac id="S4.E12.m1.9.9.9.9.9.9"><mrow id="S4.E12.m1.9.9.9.9.9.9.1.1"><mo stretchy="false" id="S4.E12.m1.9.9.9.9.9.9.1.1.2">|</mo><msup id="S4.E12.m1.9.9.9.9.9.9.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.9.9.9.9.9.9.1.1.1.2">𝒮</mi><mi id="S4.E12.m1.9.9.9.9.9.9.1.1.1.3">i</mi></msup><mo stretchy="false" id="S4.E12.m1.9.9.9.9.9.9.1.1.3">|</mo></mrow><mrow id="S4.E12.m1.9.9.9.9.9.9.2.3"><mo stretchy="false" id="S4.E12.m1.9.9.9.9.9.9.2.3.1">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.9.9.9.9.9.9.2.1">𝒮</mi><mo stretchy="false" id="S4.E12.m1.9.9.9.9.9.9.2.3.2">|</mo></mrow></mfrac><mrow id="S4.E12.m1.25.25.25.25.25.29"><mo id="S4.E12.m1.10.10.10.10.10.10">(</mo><mrow id="S4.E12.m1.25.25.25.25.25.29.1"><mo stretchy="false" id="S4.E12.m1.11.11.11.11.11.11">(</mo><msub id="S4.E12.m1.25.25.25.25.25.29.1.1"><mover accent="true" id="S4.E12.m1.12.12.12.12.12.12"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.12.12.12.12.12.12.2">ℛ</mi><mo id="S4.E12.m1.12.12.12.12.12.12.1">^</mo></mover><mi id="S4.E12.m1.13.13.13.13.13.13.1">pos</mi></msub><mrow id="S4.E12.m1.25.25.25.25.25.29.1.2"><mo id="S4.E12.m1.14.14.14.14.14.14">(</mo><msup id="S4.E12.m1.25.25.25.25.25.29.1.2.1"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.15.15.15.15.15.15">𝒮</mi><mi id="S4.E12.m1.16.16.16.16.16.16.1">i</mi></msup><mo id="S4.E12.m1.17.17.17.17.17.17">)</mo></mrow><mo id="S4.E12.m1.18.18.18.18.18.18">+</mo><msub id="S4.E12.m1.25.25.25.25.25.29.1.3"><mover accent="true" id="S4.E12.m1.19.19.19.19.19.19"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.19.19.19.19.19.19.2">ℛ</mi><mo id="S4.E12.m1.19.19.19.19.19.19.1">^</mo></mover><mi id="S4.E12.m1.20.20.20.20.20.20.1">neg</mi></msub><mrow id="S4.E12.m1.25.25.25.25.25.29.1.4"><mo id="S4.E12.m1.21.21.21.21.21.21">(</mo><msup id="S4.E12.m1.25.25.25.25.25.29.1.4.1"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.22.22.22.22.22.22">𝒮</mi><mi id="S4.E12.m1.23.23.23.23.23.23.1">i</mi></msup><mo id="S4.E12.m1.24.24.24.24.24.24">)</mo></mrow><mo id="S4.E12.m1.25.25.25.25.25.25">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E12.m1.108.108.1d"><mtd id="S4.E12.m1.108.108.1e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.108.108.1f"><mrow id="S4.E12.m1.108.108.1.108.38.38"><mi id="S4.E12.m1.108.108.1.108.38.38.39"></mi><mo id="S4.E12.m1.26.26.26.1.1.1">=</mo><mrow id="S4.E12.m1.108.108.1.108.38.38.38"><mfrac id="S4.E12.m1.27.27.27.2.2.2"><mn id="S4.E12.m1.27.27.27.2.2.2.2">1</mn><msub id="S4.E12.m1.27.27.27.2.2.2.3"><mi id="S4.E12.m1.27.27.27.2.2.2.3.2">n</mi><mrow id="S4.E12.m1.27.27.27.2.2.2.3.3"><mi id="S4.E12.m1.27.27.27.2.2.2.3.3.2">a</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.27.27.27.2.2.2.3.3.1">​</mo><mi id="S4.E12.m1.27.27.27.2.2.2.3.3.3">l</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.27.27.27.2.2.2.3.3.1a">​</mo><mi id="S4.E12.m1.27.27.27.2.2.2.3.3.4">l</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.E12.m1.108.108.1.108.38.38.38.2">​</mo><mrow id="S4.E12.m1.108.108.1.108.38.38.38.1"><munder id="S4.E12.m1.108.108.1.108.38.38.38.1.2"><mo movablelimits="false" rspace="0em" id="S4.E12.m1.28.28.28.3.3.3">∑</mo><mrow id="S4.E12.m1.29.29.29.4.4.4.1"><mi id="S4.E12.m1.29.29.29.4.4.4.1.3">i</mi><mo id="S4.E12.m1.29.29.29.4.4.4.1.2">∈</mo><mrow id="S4.E12.m1.29.29.29.4.4.4.1.4.2"><mo stretchy="false" id="S4.E12.m1.29.29.29.4.4.4.1.4.2.1">[</mo><mi id="S4.E12.m1.29.29.29.4.4.4.1.1">m</mi><mo stretchy="false" id="S4.E12.m1.29.29.29.4.4.4.1.4.2.2">]</mo></mrow></mrow></munder><mrow id="S4.E12.m1.108.108.1.108.38.38.38.1.1"><munder id="S4.E12.m1.108.108.1.108.38.38.38.1.1.2"><mo movablelimits="false" rspace="0em" id="S4.E12.m1.30.30.30.5.5.5">∑</mo><mrow id="S4.E12.m1.31.31.31.6.6.6.1"><mi id="S4.E12.m1.31.31.31.6.6.6.1.3">j</mi><mo id="S4.E12.m1.31.31.31.6.6.6.1.2">∈</mo><mrow id="S4.E12.m1.31.31.31.6.6.6.1.1.1"><mo stretchy="false" id="S4.E12.m1.31.31.31.6.6.6.1.1.1.2">[</mo><msub id="S4.E12.m1.31.31.31.6.6.6.1.1.1.1"><mi id="S4.E12.m1.31.31.31.6.6.6.1.1.1.1.2">n</mi><mi id="S4.E12.m1.31.31.31.6.6.6.1.1.1.1.3">i</mi></msub><mo stretchy="false" id="S4.E12.m1.31.31.31.6.6.6.1.1.1.3">]</mo></mrow></mrow></munder><mrow id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1"><mo id="S4.E12.m1.32.32.32.7.7.7">(</mo><mrow id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1"><mrow id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.2"><msubsup id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.2.4"><mi mathvariant="normal" id="S4.E12.m1.33.33.33.8.8.8">ℓ</mi><mrow id="S4.E12.m1.35.35.35.10.10.10.1"><mi id="S4.E12.m1.35.35.35.10.10.10.1.2">c</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.35.35.35.10.10.10.1.1">​</mo><mi id="S4.E12.m1.35.35.35.10.10.10.1.3">l</mi></mrow><mi id="S4.E12.m1.34.34.34.9.9.9.1">pos</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.2.3">​</mo><mrow id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.2.2.2"><mo stretchy="false" id="S4.E12.m1.36.36.36.11.11.11">(</mo><msubsup id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.1.1.1.1"><mi id="S4.E12.m1.37.37.37.12.12.12">L</mi><mi id="S4.E12.m1.38.38.38.13.13.13.1">j</mi><mi id="S4.E12.m1.39.39.39.14.14.14.1">P</mi></msubsup><mo id="S4.E12.m1.40.40.40.15.15.15">,</mo><msubsup id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.2.2.2.2"><mi id="S4.E12.m1.41.41.41.16.16.16">L</mi><mi id="S4.E12.m1.42.42.42.17.17.17.1">j</mi><mi id="S4.E12.m1.43.43.43.18.18.18.1">N</mi></msubsup><mo id="S4.E12.m1.44.44.44.19.19.19">,</mo><mi id="S4.E12.m1.45.45.45.20.20.20">W</mi><mo stretchy="false" id="S4.E12.m1.46.46.46.21.21.21">)</mo></mrow></mrow><mo id="S4.E12.m1.47.47.47.22.22.22">+</mo><mrow id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.4"><msubsup id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.4.4"><mi mathvariant="normal" id="S4.E12.m1.48.48.48.23.23.23">ℓ</mi><mrow id="S4.E12.m1.50.50.50.25.25.25.1"><mi id="S4.E12.m1.50.50.50.25.25.25.1.2">c</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.50.50.50.25.25.25.1.1">​</mo><mi id="S4.E12.m1.50.50.50.25.25.25.1.3">l</mi></mrow><mi id="S4.E12.m1.49.49.49.24.24.24.1">neg</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.4.3">​</mo><mrow id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.4.2.2"><mo stretchy="false" id="S4.E12.m1.51.51.51.26.26.26">(</mo><msubsup id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.3.1.1.1"><mi id="S4.E12.m1.52.52.52.27.27.27">L</mi><mi id="S4.E12.m1.53.53.53.28.28.28.1">j</mi><mi id="S4.E12.m1.54.54.54.29.29.29.1">P</mi></msubsup><mo id="S4.E12.m1.55.55.55.30.30.30">,</mo><msubsup id="S4.E12.m1.108.108.1.108.38.38.38.1.1.1.1.1.4.2.2.2"><mi id="S4.E12.m1.56.56.56.31.31.31">L</mi><mi id="S4.E12.m1.57.57.57.32.32.32.1">j</mi><mi id="S4.E12.m1.58.58.58.33.33.33.1">N</mi></msubsup><mo id="S4.E12.m1.59.59.59.34.34.34">,</mo><mi id="S4.E12.m1.60.60.60.35.35.35">W</mi><mo stretchy="false" id="S4.E12.m1.61.61.61.36.36.36">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.62.62.62.37.37.37">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E12.m1.108.108.1g"><mtd id="S4.E12.m1.108.108.1h"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.108.108.1i"><mrow id="S4.E12.m1.82.82.82.20.20"><mo id="S4.E12.m1.63.63.63.1.1.1">=</mo><mfrac id="S4.E12.m1.64.64.64.2.2.2"><mn id="S4.E12.m1.64.64.64.2.2.2.2">1</mn><msub id="S4.E12.m1.64.64.64.2.2.2.3"><mi id="S4.E12.m1.64.64.64.2.2.2.3.2">n</mi><mrow id="S4.E12.m1.64.64.64.2.2.2.3.3"><mi id="S4.E12.m1.64.64.64.2.2.2.3.3.2">a</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.64.64.64.2.2.2.3.3.1">​</mo><mi id="S4.E12.m1.64.64.64.2.2.2.3.3.3">l</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.64.64.64.2.2.2.3.3.1a">​</mo><mi id="S4.E12.m1.64.64.64.2.2.2.3.3.4">l</mi></mrow></msub></mfrac><munder id="S4.E12.m1.82.82.82.20.20.21"><mo movablelimits="false" rspace="0em" id="S4.E12.m1.65.65.65.3.3.3">∑</mo><mrow id="S4.E12.m1.66.66.66.4.4.4.1"><mi id="S4.E12.m1.66.66.66.4.4.4.1.3">j</mi><mo id="S4.E12.m1.66.66.66.4.4.4.1.2">∈</mo><mrow id="S4.E12.m1.66.66.66.4.4.4.1.1.1"><mo stretchy="false" id="S4.E12.m1.66.66.66.4.4.4.1.1.1.2">[</mo><msub id="S4.E12.m1.66.66.66.4.4.4.1.1.1.1"><mi id="S4.E12.m1.66.66.66.4.4.4.1.1.1.1.2">n</mi><mi id="S4.E12.m1.66.66.66.4.4.4.1.1.1.1.3">all</mi></msub><mo stretchy="false" id="S4.E12.m1.66.66.66.4.4.4.1.1.1.3">]</mo></mrow></mrow></munder><mrow id="S4.E12.m1.82.82.82.20.20.22"><mo id="S4.E12.m1.67.67.67.5.5.5">(</mo><mi id="S4.E12.m1.68.68.68.6.6.6">α</mi><mo lspace="0.222em" rspace="0.055em" id="S4.E12.m1.69.69.69.7.7.7">⋅</mo><munder id="S4.E12.m1.82.82.82.20.20.22.1"><mo movablelimits="false" rspace="0em" id="S4.E12.m1.70.70.70.8.8.8">∑</mo><mfrac linethickness="0pt" id="S4.E12.m1.71.71.71.9.9.9.1"><mrow id="S4.E12.m1.71.71.71.9.9.9.1.2"><msub id="S4.E12.m1.71.71.71.9.9.9.1.2.1"><mi id="S4.E12.m1.71.71.71.9.9.9.1.2.1.2">y</mi><mi id="S4.E12.m1.71.71.71.9.9.9.1.2.1.3">j</mi></msub><mo id="S4.E12.m1.71.71.71.9.9.9.1.2.2">∈</mo><msubsup id="S4.E12.m1.71.71.71.9.9.9.1.2.3"><mi id="S4.E12.m1.71.71.71.9.9.9.1.2.3.2.2">L</mi><mi id="S4.E12.m1.71.71.71.9.9.9.1.2.3.2.3">j</mi><mi id="S4.E12.m1.71.71.71.9.9.9.1.2.3.3">P</mi></msubsup><mo id="S4.E12.m1.71.71.71.9.9.9.1.2.4">,</mo></mrow><mrow id="S4.E12.m1.71.71.71.9.9.9.1.3"><msubsup id="S4.E12.m1.71.71.71.9.9.9.1.3.2"><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.2.2.2">y</mi><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.2.2.3">j</mi><mo id="S4.E12.m1.71.71.71.9.9.9.1.3.2.3">′</mo></msubsup><mo id="S4.E12.m1.71.71.71.9.9.9.1.3.3">∈</mo><mrow id="S4.E12.m1.71.71.71.9.9.9.1.3.4"><msubsup id="S4.E12.m1.71.71.71.9.9.9.1.3.4.2"><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.4.2.2.2">L</mi><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.4.2.2.3">j</mi><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.4.2.3">P</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S4.E12.m1.71.71.71.9.9.9.1.3.4.1">&amp;</mo><msubsup id="S4.E12.m1.71.71.71.9.9.9.1.3.4.3"><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.4.3.2.2">y</mi><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.4.3.2.3">j</mi><mo id="S4.E12.m1.71.71.71.9.9.9.1.3.4.3.3">′</mo></msubsup></mrow><mo id="S4.E12.m1.71.71.71.9.9.9.1.3.5">≠</mo><msub id="S4.E12.m1.71.71.71.9.9.9.1.3.6"><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.6.2">y</mi><mi id="S4.E12.m1.71.71.71.9.9.9.1.3.6.3">j</mi></msub></mrow></mfrac></munder><msup id="S4.E12.m1.82.82.82.20.20.22.2"><mrow id="S4.E12.m1.82.82.82.20.20.22.2.2"><mo id="S4.E12.m1.72.72.72.10.10.10">(</mo><mi id="S4.E12.m1.73.73.73.11.11.11">d</mi><mrow id="S4.E12.m1.82.82.82.20.20.22.2.2.1"><mo stretchy="false" id="S4.E12.m1.74.74.74.12.12.12">(</mo><msub id="S4.E12.m1.82.82.82.20.20.22.2.2.1.1"><mi id="S4.E12.m1.75.75.75.13.13.13">𝐰</mi><msub id="S4.E12.m1.76.76.76.14.14.14.1"><mi id="S4.E12.m1.76.76.76.14.14.14.1.2">y</mi><mi id="S4.E12.m1.76.76.76.14.14.14.1.3">j</mi></msub></msub><mo id="S4.E12.m1.77.77.77.15.15.15">,</mo><msub id="S4.E12.m1.82.82.82.20.20.22.2.2.1.2"><mi id="S4.E12.m1.78.78.78.16.16.16">𝐰</mi><msubsup id="S4.E12.m1.79.79.79.17.17.17.1"><mi id="S4.E12.m1.79.79.79.17.17.17.1.2.2">y</mi><mi id="S4.E12.m1.79.79.79.17.17.17.1.2.3">j</mi><mo id="S4.E12.m1.79.79.79.17.17.17.1.3">′</mo></msubsup></msub><mo stretchy="false" id="S4.E12.m1.80.80.80.18.18.18">)</mo></mrow><mo id="S4.E12.m1.81.81.81.19.19.19">)</mo></mrow><mn id="S4.E12.m1.82.82.82.20.20.20.1">2</mn></msup></mrow></mrow></mtd></mtr><mtr id="S4.E12.m1.108.108.1j"><mtd id="S4.E12.m1.108.108.1k"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.108.108.1l"><mrow id="S4.E12.m1.107.107.107.25.25"><mo id="S4.E12.m1.83.83.83.1.1.1">+</mo><mi id="S4.E12.m1.84.84.84.2.2.2">β</mi><mo lspace="0.222em" rspace="0.055em" id="S4.E12.m1.85.85.85.3.3.3">⋅</mo><munder id="S4.E12.m1.107.107.107.25.25.26"><mo movablelimits="false" rspace="0em" id="S4.E12.m1.86.86.86.4.4.4">∑</mo><mfrac linethickness="0pt" id="S4.E12.m1.87.87.87.5.5.5.1"><mrow id="S4.E12.m1.87.87.87.5.5.5.1.2"><msub id="S4.E12.m1.87.87.87.5.5.5.1.2.1"><mi id="S4.E12.m1.87.87.87.5.5.5.1.2.1.2">y</mi><mi id="S4.E12.m1.87.87.87.5.5.5.1.2.1.3">j</mi></msub><mo id="S4.E12.m1.87.87.87.5.5.5.1.2.2">∈</mo><msubsup id="S4.E12.m1.87.87.87.5.5.5.1.2.3"><mi id="S4.E12.m1.87.87.87.5.5.5.1.2.3.2.2">L</mi><mi id="S4.E12.m1.87.87.87.5.5.5.1.2.3.2.3">j</mi><mi id="S4.E12.m1.87.87.87.5.5.5.1.2.3.3">P</mi></msubsup><mo id="S4.E12.m1.87.87.87.5.5.5.1.2.4">,</mo></mrow><mrow id="S4.E12.m1.87.87.87.5.5.5.1.3"><msubsup id="S4.E12.m1.87.87.87.5.5.5.1.3.2"><mi id="S4.E12.m1.87.87.87.5.5.5.1.3.2.2.2">y</mi><mi id="S4.E12.m1.87.87.87.5.5.5.1.3.2.2.3">j</mi><mo id="S4.E12.m1.87.87.87.5.5.5.1.3.2.3">′</mo></msubsup><mo id="S4.E12.m1.87.87.87.5.5.5.1.3.1">∈</mo><msubsup id="S4.E12.m1.87.87.87.5.5.5.1.3.3"><mi id="S4.E12.m1.87.87.87.5.5.5.1.3.3.2.2">L</mi><mi id="S4.E12.m1.87.87.87.5.5.5.1.3.3.2.3">j</mi><mi id="S4.E12.m1.87.87.87.5.5.5.1.3.3.3">N</mi></msubsup></mrow></mfrac></munder><msup id="S4.E12.m1.107.107.107.25.25.27"><mrow id="S4.E12.m1.107.107.107.25.25.27.2"><mo id="S4.E12.m1.88.88.88.6.6.6">(</mo><mi id="S4.E12.m1.89.89.89.7.7.7">max</mi><mrow id="S4.E12.m1.107.107.107.25.25.27.2.1"><mo id="S4.E12.m1.90.90.90.8.8.8">{</mo><mn id="S4.E12.m1.91.91.91.9.9.9">0</mn><mo id="S4.E12.m1.92.92.92.10.10.10">,</mo><mi id="S4.E12.m1.93.93.93.11.11.11">ν</mi><mo id="S4.E12.m1.94.94.94.12.12.12">−</mo><mi id="S4.E12.m1.95.95.95.13.13.13">d</mi><mrow id="S4.E12.m1.107.107.107.25.25.27.2.1.1"><mo stretchy="false" id="S4.E12.m1.96.96.96.14.14.14">(</mo><msub id="S4.E12.m1.107.107.107.25.25.27.2.1.1.1"><mi id="S4.E12.m1.97.97.97.15.15.15">𝐰</mi><msub id="S4.E12.m1.98.98.98.16.16.16.1"><mi id="S4.E12.m1.98.98.98.16.16.16.1.2">y</mi><mi id="S4.E12.m1.98.98.98.16.16.16.1.3">j</mi></msub></msub><mo id="S4.E12.m1.99.99.99.17.17.17">,</mo><msub id="S4.E12.m1.107.107.107.25.25.27.2.1.1.2"><mi id="S4.E12.m1.100.100.100.18.18.18">𝐰</mi><msubsup id="S4.E12.m1.101.101.101.19.19.19.1"><mi id="S4.E12.m1.101.101.101.19.19.19.1.2.2">y</mi><mi id="S4.E12.m1.101.101.101.19.19.19.1.2.3">j</mi><mo id="S4.E12.m1.101.101.101.19.19.19.1.3">′</mo></msubsup></msub><mo stretchy="false" id="S4.E12.m1.102.102.102.20.20.20">)</mo></mrow><mo id="S4.E12.m1.103.103.103.21.21.21">}</mo></mrow><mo id="S4.E12.m1.104.104.104.22.22.22">)</mo></mrow><mn id="S4.E12.m1.105.105.105.23.23.23.1">2</mn></msup><mo id="S4.E12.m1.106.106.106.24.24.24">)</mo><mo lspace="0em" id="S4.E12.m1.107.107.107.25.25.25">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E12.m1.108b">\begin{split}&amp;\mathrm{reg}_{\mathrm{fc}}(W)=\sum_{i\in[m]}\frac{|\mathcal{S}^{i}|}{|\mathcal{S}|}\left((\hat{\mathcal{R}}_{\mathrm{pos}}\left(\mathcal{S}^{i}\right)+\hat{\mathcal{R}}_{\mathrm{neg}}\left(\mathcal{S}^{i}\right)\right)\\
&amp;=\frac{1}{n_{all}}\sum\limits_{i\in[m]}\sum\limits_{j\in[n_{i}]}\left(\ell^{\mathrm{pos}}_{cl}({L_{j}^{P}},{L_{j}^{N}},W)+\ell^{\mathrm{neg}}_{cl}({L_{j}^{P}},{L_{j}^{N}},W)\right)\\
&amp;=\frac{1}{n_{all}}\sum\limits_{j\in[n_{\mathrm{all}}]}\left(\alpha\cdot\sum\limits_{y_{j}\in L_{j}^{P},\atop y_{j}^{\prime}\in L_{j}^{P}\And y_{j}^{\prime}\neq y_{j}}\left(d(\mathbf{w}_{y_{j}},\mathbf{w}_{y_{j}^{\prime}})\right)^{2}\right.\\
&amp;\left.+\beta\cdot\sum\limits_{y_{j}\in L_{j}^{P},\atop y_{j}^{\prime}\in L_{j}^{N}}\left(\max\left\{0,\nu-d(\mathbf{w}_{y_{j}},\mathbf{w}_{y_{j}^{\prime}})\right\}\right)^{2}\right).\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.2" class="ltx_p">For each instance, the positive loss in Eq. (<a href="#S4.E12" title="In IV-C Learning fixed class embedding (FedALC-fixed) ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>) encourages the positive embedding to be close and the negative loss encourages negative and positive embedding to be far away from each other. This process is illustrated in Figure <a href="#S4.F3" title="Figure 3 ‣ IV-B Spreadout by exploring label correlations (FedALC) ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, where the server learns a fixed class embedding matrix using regularizer Eq. (<a href="#S4.E12" title="In IV-C Learning fixed class embedding (FedALC-fixed) ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>) and sends it to each clients. In the client optimization, the local step makes the instance embedding approach its positive class embeddings. The transmission of fixed class embeddings between clients and the server is only conducted once since the obtained class embeddings are unchanged during the process of federated learning.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.4.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.5.2" class="ltx_text ltx_font_italic">Convergence and Optimality for Training</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.9" class="ltx_p">Due to the <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="\max" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">max</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><max id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"></max></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\max</annotation></semantics></math> opreator, our loss function is Lipschitz continuity but non-smooth. According to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>, under full clients participation setting and using FedAvg optimizer, FL converges to the global optimal solution at a linear rate with proper learning parameters.
That is, for <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">N</annotation></semantics></math> clients satisfying <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\epsilon</annotation></semantics></math> precision (training loss function <math id="S4.SS4.p1.4.m4.2" class="ltx_Math" alttext="L(w,x)\leq\epsilon" display="inline"><semantics id="S4.SS4.p1.4.m4.2a"><mrow id="S4.SS4.p1.4.m4.2.3" xref="S4.SS4.p1.4.m4.2.3.cmml"><mrow id="S4.SS4.p1.4.m4.2.3.2" xref="S4.SS4.p1.4.m4.2.3.2.cmml"><mi id="S4.SS4.p1.4.m4.2.3.2.2" xref="S4.SS4.p1.4.m4.2.3.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.4.m4.2.3.2.1" xref="S4.SS4.p1.4.m4.2.3.2.1.cmml">​</mo><mrow id="S4.SS4.p1.4.m4.2.3.2.3.2" xref="S4.SS4.p1.4.m4.2.3.2.3.1.cmml"><mo stretchy="false" id="S4.SS4.p1.4.m4.2.3.2.3.2.1" xref="S4.SS4.p1.4.m4.2.3.2.3.1.cmml">(</mo><mi id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">w</mi><mo id="S4.SS4.p1.4.m4.2.3.2.3.2.2" xref="S4.SS4.p1.4.m4.2.3.2.3.1.cmml">,</mo><mi id="S4.SS4.p1.4.m4.2.2" xref="S4.SS4.p1.4.m4.2.2.cmml">x</mi><mo stretchy="false" id="S4.SS4.p1.4.m4.2.3.2.3.2.3" xref="S4.SS4.p1.4.m4.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p1.4.m4.2.3.1" xref="S4.SS4.p1.4.m4.2.3.1.cmml">≤</mo><mi id="S4.SS4.p1.4.m4.2.3.3" xref="S4.SS4.p1.4.m4.2.3.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.2b"><apply id="S4.SS4.p1.4.m4.2.3.cmml" xref="S4.SS4.p1.4.m4.2.3"><leq id="S4.SS4.p1.4.m4.2.3.1.cmml" xref="S4.SS4.p1.4.m4.2.3.1"></leq><apply id="S4.SS4.p1.4.m4.2.3.2.cmml" xref="S4.SS4.p1.4.m4.2.3.2"><times id="S4.SS4.p1.4.m4.2.3.2.1.cmml" xref="S4.SS4.p1.4.m4.2.3.2.1"></times><ci id="S4.SS4.p1.4.m4.2.3.2.2.cmml" xref="S4.SS4.p1.4.m4.2.3.2.2">𝐿</ci><interval closure="open" id="S4.SS4.p1.4.m4.2.3.2.3.1.cmml" xref="S4.SS4.p1.4.m4.2.3.2.3.2"><ci id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">𝑤</ci><ci id="S4.SS4.p1.4.m4.2.2.cmml" xref="S4.SS4.p1.4.m4.2.2">𝑥</ci></interval></apply><ci id="S4.SS4.p1.4.m4.2.3.3.cmml" xref="S4.SS4.p1.4.m4.2.3.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.2c">L(w,x)\leq\epsilon</annotation></semantics></math>), there are at least <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="T=\mathcal{O}\left(\frac{N}{\lambda\eta_{l}\eta_{g}K}*\log{1/\epsilon}\right)" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><mrow id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml"><mi id="S4.SS4.p1.5.m5.1.1.3" xref="S4.SS4.p1.5.m5.1.1.3.cmml">T</mi><mo id="S4.SS4.p1.5.m5.1.1.2" xref="S4.SS4.p1.5.m5.1.1.2.cmml">=</mo><mrow id="S4.SS4.p1.5.m5.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.5.m5.1.1.1.3" xref="S4.SS4.p1.5.m5.1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.5.m5.1.1.1.2" xref="S4.SS4.p1.5.m5.1.1.1.2.cmml">​</mo><mrow id="S4.SS4.p1.5.m5.1.1.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="S4.SS4.p1.5.m5.1.1.1.1.1.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.p1.5.m5.1.1.1.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.cmml"><mfrac id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.cmml"><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.2.cmml">N</mi><mrow id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.1" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.1.cmml">​</mo><msub id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.cmml"><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.2.cmml">η</mi><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.1a" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.1.cmml">​</mo><msub id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.cmml"><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.2.cmml">η</mi><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.1b" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.5" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.5.cmml">K</mi></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.1.cmml">∗</mo><mrow id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.1" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3a" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.cmml"><mn id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.2" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.2.cmml">1</mn><mo id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.1" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.1.cmml">/</mo><mi id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.3.cmml">ϵ</mi></mrow></mrow></mrow><mo id="S4.SS4.p1.5.m5.1.1.1.1.1.3" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><apply id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><eq id="S4.SS4.p1.5.m5.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.2"></eq><ci id="S4.SS4.p1.5.m5.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3">𝑇</ci><apply id="S4.SS4.p1.5.m5.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1"><times id="S4.SS4.p1.5.m5.1.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.2"></times><ci id="S4.SS4.p1.5.m5.1.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.3">𝒪</ci><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1"><times id="S4.SS4.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.1"></times><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2"><divide id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2"></divide><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.2">𝑁</ci><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3"><times id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.1"></times><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.2">𝜆</ci><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.2">𝜂</ci><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.3.3">𝑙</ci></apply><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4">subscript</csymbol><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.2">𝜂</ci><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.4.3">𝑔</ci></apply><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.5.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.2.3.5">𝐾</ci></apply></apply><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3"><log id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.1"></log><apply id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2"><divide id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.1"></divide><cn type="integer" id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.2">1</cn><ci id="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS4.p1.5.m5.1.1.1.1.1.1.3.2.3">italic-ϵ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">T=\mathcal{O}\left(\frac{N}{\lambda\eta_{l}\eta_{g}K}*\log{1/\epsilon}\right)</annotation></semantics></math> communication rounds, where <math id="S4.SS4.p1.6.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS4.p1.6.m6.1a"><mi id="S4.SS4.p1.6.m6.1.1" xref="S4.SS4.p1.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.1b"><ci id="S4.SS4.p1.6.m6.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.1c">\lambda</annotation></semantics></math> is the minimal eignvalue of Gram matrix (aka pairwise data point gradient), <math id="S4.SS4.p1.7.m7.1" class="ltx_Math" alttext="\eta_{l}" display="inline"><semantics id="S4.SS4.p1.7.m7.1a"><msub id="S4.SS4.p1.7.m7.1.1" xref="S4.SS4.p1.7.m7.1.1.cmml"><mi id="S4.SS4.p1.7.m7.1.1.2" xref="S4.SS4.p1.7.m7.1.1.2.cmml">η</mi><mi id="S4.SS4.p1.7.m7.1.1.3" xref="S4.SS4.p1.7.m7.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m7.1b"><apply id="S4.SS4.p1.7.m7.1.1.cmml" xref="S4.SS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.7.m7.1.1.1.cmml" xref="S4.SS4.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS4.p1.7.m7.1.1.2.cmml" xref="S4.SS4.p1.7.m7.1.1.2">𝜂</ci><ci id="S4.SS4.p1.7.m7.1.1.3.cmml" xref="S4.SS4.p1.7.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m7.1c">\eta_{l}</annotation></semantics></math> and <math id="S4.SS4.p1.8.m8.1" class="ltx_Math" alttext="\eta_{g}" display="inline"><semantics id="S4.SS4.p1.8.m8.1a"><msub id="S4.SS4.p1.8.m8.1.1" xref="S4.SS4.p1.8.m8.1.1.cmml"><mi id="S4.SS4.p1.8.m8.1.1.2" xref="S4.SS4.p1.8.m8.1.1.2.cmml">η</mi><mi id="S4.SS4.p1.8.m8.1.1.3" xref="S4.SS4.p1.8.m8.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m8.1b"><apply id="S4.SS4.p1.8.m8.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.8.m8.1.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS4.p1.8.m8.1.1.2.cmml" xref="S4.SS4.p1.8.m8.1.1.2">𝜂</ci><ci id="S4.SS4.p1.8.m8.1.1.3.cmml" xref="S4.SS4.p1.8.m8.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m8.1c">\eta_{g}</annotation></semantics></math> are learning rate at client and server, <math id="S4.SS4.p1.9.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS4.p1.9.m9.1a"><mi id="S4.SS4.p1.9.m9.1.1" xref="S4.SS4.p1.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.9.m9.1b"><ci id="S4.SS4.p1.9.m9.1.1.cmml" xref="S4.SS4.p1.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.9.m9.1c">K</annotation></semantics></math> is the local interval. Since we also adopt the FedAvg opitmizer and the full participation setting, our proposed FedALC can also achieves a linear convergence rate. Our method focuses on spreading out the class embedding by exploiting label correlation, which avoids class embedding collapse and thus reduce the misclassification rate. FedALC doesn’t consider new design for local optimizers or server-side model aggregation method. The enhancements of regularization on class embeddings are difficult to reflect in the convergence rate’s order.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.4.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.5.2" class="ltx_text ltx_font_italic">Label sets collection</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">There still remains a question on how to collect the labels for each instance. In multi-label classification, an instance may have multiple labels. Since each client is associated with a single label, the same instance may be distributed in different clients. To collect the labels for each instance, we propose to first use the irreversible hash algorithm, such as MD5 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> or SHA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> and all other Message Digest algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>, to map the instance embedding into the low-dimensional hash vector on the client side. Here, we assume that embeddings of the same instance on different clients are the same (i.e., the same feature extractor is adopted). Then the hash messages together with the associated labels are sent to the server. Finally, the received messages are compared and labels of the same messages are merged to obtain the label sets. The main procedure is illustrated in Figure <a href="#S4.F4" title="Figure 4 ‣ IV-E Label sets collection ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, where we transmit the hash messages instead of the original instance embeddings since: 1) instance embedding contains the user’s identity information, and it is unsafe to exchange them between the server and clients. Some techniques (such as GAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>) can be adopted to recover the user’s data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>; 2) the embedding may be of large size and thus incur a large communication overhead.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2404.15598/assets/collect.png" id="S4.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="442" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Label sets collection for each instance in the federated setting. Embeddings of the same data point on different clients are mapped as hash messages, which are sent to the server together with the label information. Then the server compare the messages and aggregate the labels that have the same message.</figcaption>
</figure>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">In this way, the server can indeed learn the distribution of labels of all data (in this paper, i.e., which client holds the data with some certain label) by collecting hash codes of data. However, the server cannot restore the original data samples from the hash codes due to the irreversibility of the hash function, and is not able to establish connections between data features and labels. Therefore, the model training needs to be done on each client, and the label distribution information obtained by the server plays the role of establishing the label correlation to avoid the model collapse.
In order to compute the correlation between labels, the hash codes of all the training data need to be transmitted from the clients to the server only once at the beginning of the FL process. The size of one hash code is small (32 Bytes using SHA-256 or 64 Bytes using SHA-512). Let’s take VOC2012 dataset as an example, there are 11540 images and the client needs to transmit 0.15 MB hash codes to the server. Compared with the communication cost of the model parameter (23.5183M for ResNet-50), the cost incurred by hash codes is tolerable.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">To mitigate the risk of label leakage, the client employs a hash function to encrypt the labels before uploading the encrypted instance and label to the server. This procedure ensures that the server solely accesses the correlation between labels, without any knowledge of their actual names, thereby rendering it impossible to establish the correspondence between instances and labels. This approach is particularly well-suited for real FL scenarios, safeguarding privacy and enhancing security.</p>
</div>
<div id="S4.SS5.p4" class="ltx_para">
<p id="S4.SS5.p4.2" class="ltx_p">The encryption and transmission process may lead to data leakage. All clients have the same initialization model and the same instance has the same hash code. Therefore, the malicious clients can infer other clients’ data statistical from the embedding matrix <math id="S4.SS5.p4.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS5.p4.1.m1.1a"><mi id="S4.SS5.p4.1.m1.1.1" xref="S4.SS5.p4.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.1.m1.1b"><ci id="S4.SS5.p4.1.m1.1.1.cmml" xref="S4.SS5.p4.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.1.m1.1c">W</annotation></semantics></math> under the setting of our method. To protect the privacy of the clients, we can conduct the embedding matrix <math id="S4.SS5.p4.2.m2.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS5.p4.2.m2.1a"><mi id="S4.SS5.p4.2.m2.1.1" xref="S4.SS5.p4.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p4.2.m2.1b"><ci id="S4.SS5.p4.2.m2.1.1.cmml" xref="S4.SS5.p4.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p4.2.m2.1c">W</annotation></semantics></math> training in a differential privacy manner.
Specifically, differential privacy, a classical security method, is defined as follows:</p>
</div>
<div id="Thmdefinition1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span id="Thmdefinition1.1.1.1" class="ltx_text ltx_font_bold">Definition 1</span></span></h6>
<div id="Thmdefinition1.p1" class="ltx_para">
<p id="Thmdefinition1.p1.5" class="ltx_p"><span id="Thmdefinition1.p1.5.5" class="ltx_text ltx_font_italic">(Defined in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>.)
A randomized algorithm <math id="Thmdefinition1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{M}:\mathcal{D}\mapsto\mathcal{R}" display="inline"><semantics id="Thmdefinition1.p1.1.1.m1.1a"><mrow id="Thmdefinition1.p1.1.1.m1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.1.1.m1.1.1.2" xref="Thmdefinition1.p1.1.1.m1.1.1.2.cmml">ℳ</mi><mo lspace="0.278em" rspace="0.278em" id="Thmdefinition1.p1.1.1.m1.1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.1.cmml">:</mo><mrow id="Thmdefinition1.p1.1.1.m1.1.1.3" xref="Thmdefinition1.p1.1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.1.1.m1.1.1.3.2" xref="Thmdefinition1.p1.1.1.m1.1.1.3.2.cmml">𝒟</mi><mo stretchy="false" id="Thmdefinition1.p1.1.1.m1.1.1.3.1" xref="Thmdefinition1.p1.1.1.m1.1.1.3.1.cmml">↦</mo><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.1.1.m1.1.1.3.3" xref="Thmdefinition1.p1.1.1.m1.1.1.3.3.cmml">ℛ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.1b"><apply id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1"><ci id="Thmdefinition1.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1">:</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.2">ℳ</ci><apply id="Thmdefinition1.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3"><csymbol cd="latexml" id="Thmdefinition1.p1.1.1.m1.1.1.3.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3.1">maps-to</csymbol><ci id="Thmdefinition1.p1.1.1.m1.1.1.3.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3.2">𝒟</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.3.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3.3">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.1c">\mathcal{M}:\mathcal{D}\mapsto\mathcal{R}</annotation></semantics></math> satisfies <math id="Thmdefinition1.p1.2.2.m2.2" class="ltx_Math" alttext="\left(\epsilon,\delta\right)" display="inline"><semantics id="Thmdefinition1.p1.2.2.m2.2a"><mrow id="Thmdefinition1.p1.2.2.m2.2.3.2" xref="Thmdefinition1.p1.2.2.m2.2.3.1.cmml"><mo id="Thmdefinition1.p1.2.2.m2.2.3.2.1" xref="Thmdefinition1.p1.2.2.m2.2.3.1.cmml">(</mo><mi id="Thmdefinition1.p1.2.2.m2.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.cmml">ϵ</mi><mo id="Thmdefinition1.p1.2.2.m2.2.3.2.2" xref="Thmdefinition1.p1.2.2.m2.2.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.2.2.m2.2.2" xref="Thmdefinition1.p1.2.2.m2.2.2.cmml">δ</mi><mo id="Thmdefinition1.p1.2.2.m2.2.3.2.3" xref="Thmdefinition1.p1.2.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.m2.2b"><interval closure="open" id="Thmdefinition1.p1.2.2.m2.2.3.1.cmml" xref="Thmdefinition1.p1.2.2.m2.2.3.2"><ci id="Thmdefinition1.p1.2.2.m2.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1">italic-ϵ</ci><ci id="Thmdefinition1.p1.2.2.m2.2.2.cmml" xref="Thmdefinition1.p1.2.2.m2.2.2">𝛿</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.m2.2c">\left(\epsilon,\delta\right)</annotation></semantics></math>-differential privacy (DP) if and only if for any two adjacent input datasets <math id="Thmdefinition1.p1.3.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="Thmdefinition1.p1.3.3.m3.1a"><mi id="Thmdefinition1.p1.3.3.m3.1.1" xref="Thmdefinition1.p1.3.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.3.3.m3.1b"><ci id="Thmdefinition1.p1.3.3.m3.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.3.3.m3.1c">D</annotation></semantics></math> and <math id="Thmdefinition1.p1.4.4.m4.1" class="ltx_Math" alttext="D^{{}^{\prime}}" display="inline"><semantics id="Thmdefinition1.p1.4.4.m4.1a"><msup id="Thmdefinition1.p1.4.4.m4.1.1" xref="Thmdefinition1.p1.4.4.m4.1.1.cmml"><mi id="Thmdefinition1.p1.4.4.m4.1.1.2" xref="Thmdefinition1.p1.4.4.m4.1.1.2.cmml">D</mi><msup id="Thmdefinition1.p1.4.4.m4.1.1.3" xref="Thmdefinition1.p1.4.4.m4.1.1.3.cmml"><mi id="Thmdefinition1.p1.4.4.m4.1.1.3a" xref="Thmdefinition1.p1.4.4.m4.1.1.3.cmml"></mi><mo id="Thmdefinition1.p1.4.4.m4.1.1.3.1" xref="Thmdefinition1.p1.4.4.m4.1.1.3.1.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.4.4.m4.1b"><apply id="Thmdefinition1.p1.4.4.m4.1.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.4.4.m4.1.1.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1">superscript</csymbol><ci id="Thmdefinition1.p1.4.4.m4.1.1.2.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1.2">𝐷</ci><apply id="Thmdefinition1.p1.4.4.m4.1.1.3.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1.3"><ci id="Thmdefinition1.p1.4.4.m4.1.1.3.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.4.4.m4.1c">D^{{}^{\prime}}</annotation></semantics></math> that differ in a single entry and for any subsets of outputs <math id="Thmdefinition1.p1.5.5.m5.1" class="ltx_Math" alttext="\mathcal{S}\subset\mathcal{R}" display="inline"><semantics id="Thmdefinition1.p1.5.5.m5.1a"><mrow id="Thmdefinition1.p1.5.5.m5.1.1" xref="Thmdefinition1.p1.5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.5.5.m5.1.1.2" xref="Thmdefinition1.p1.5.5.m5.1.1.2.cmml">𝒮</mi><mo id="Thmdefinition1.p1.5.5.m5.1.1.1" xref="Thmdefinition1.p1.5.5.m5.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="Thmdefinition1.p1.5.5.m5.1.1.3" xref="Thmdefinition1.p1.5.5.m5.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.5.5.m5.1b"><apply id="Thmdefinition1.p1.5.5.m5.1.1.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1"><subset id="Thmdefinition1.p1.5.5.m5.1.1.1.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.1"></subset><ci id="Thmdefinition1.p1.5.5.m5.1.1.2.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.2">𝒮</ci><ci id="Thmdefinition1.p1.5.5.m5.1.1.3.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.5.5.m5.1c">\mathcal{S}\subset\mathcal{R}</annotation></semantics></math> it holds that</span></p>
<table id="S4.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex1.m1.1" class="ltx_math_unparsed" alttext="Pr\left[\mathcal{M}:\mathcal{D}\in\mathcal{S}\right]\leq e^{\epsilon}Pr\left[\mathcal{M}:\mathcal{D^{{}^{\prime}}}\in\mathcal{S}\right]+\delta." display="block"><semantics id="S4.Ex1.m1.1a"><mrow id="S4.Ex1.m1.1b"><mi id="S4.Ex1.m1.1.1">P</mi><mi id="S4.Ex1.m1.1.2">r</mi><mrow id="S4.Ex1.m1.1.3"><mo id="S4.Ex1.m1.1.3.1">[</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.1.3.2">ℳ</mi><mo lspace="0.278em" rspace="0.278em" id="S4.Ex1.m1.1.3.3">:</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.1.3.4">𝒟</mi><mo id="S4.Ex1.m1.1.3.5">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.1.3.6">𝒮</mi><mo id="S4.Ex1.m1.1.3.7">]</mo></mrow><mo id="S4.Ex1.m1.1.4">≤</mo><msup id="S4.Ex1.m1.1.5"><mi id="S4.Ex1.m1.1.5.2">e</mi><mi id="S4.Ex1.m1.1.5.3">ϵ</mi></msup><mi id="S4.Ex1.m1.1.6">P</mi><mi id="S4.Ex1.m1.1.7">r</mi><mrow id="S4.Ex1.m1.1.8"><mo id="S4.Ex1.m1.1.8.1">[</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.1.8.2">ℳ</mi><mo lspace="0.278em" rspace="0.278em" id="S4.Ex1.m1.1.8.3">:</mo><msup id="S4.Ex1.m1.1.8.4"><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.1.8.4.2">𝒟</mi><msup id="S4.Ex1.m1.1.8.4.3"><mi id="S4.Ex1.m1.1.8.4.3a"></mi><mo id="S4.Ex1.m1.1.8.4.3.1">′</mo></msup></msup><mo id="S4.Ex1.m1.1.8.5">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1.m1.1.8.6">𝒮</mi><mo id="S4.Ex1.m1.1.8.7">]</mo></mrow><mo id="S4.Ex1.m1.1.9">+</mo><mi id="S4.Ex1.m1.1.10">δ</mi><mo lspace="0em" id="S4.Ex1.m1.1.11">.</mo></mrow><annotation encoding="application/x-tex" id="S4.Ex1.m1.1c">Pr\left[\mathcal{M}:\mathcal{D}\in\mathcal{S}\right]\leq e^{\epsilon}Pr\left[\mathcal{M}:\mathcal{D^{{}^{\prime}}}\in\mathcal{S}\right]+\delta.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S4.SS5.p5" class="ltx_para">
<p id="S4.SS5.p5.4" class="ltx_p">It has been demonstrated that with the DP-SGD<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> algorithm, the obatained embedding matrix <math id="S4.SS5.p5.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS5.p5.1.m1.1a"><mi id="S4.SS5.p5.1.m1.1.1" xref="S4.SS5.p5.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.1.m1.1b"><ci id="S4.SS5.p5.1.m1.1.1.cmml" xref="S4.SS5.p5.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.1.m1.1c">W</annotation></semantics></math> is guaranteed to be <math id="S4.SS5.p5.2.m2.2" class="ltx_Math" alttext="\left(\epsilon,\delta\right)-" display="inline"><semantics id="S4.SS5.p5.2.m2.2a"><mrow id="S4.SS5.p5.2.m2.2.3" xref="S4.SS5.p5.2.m2.2.3.cmml"><mrow id="S4.SS5.p5.2.m2.2.3.2.2" xref="S4.SS5.p5.2.m2.2.3.2.1.cmml"><mo id="S4.SS5.p5.2.m2.2.3.2.2.1" xref="S4.SS5.p5.2.m2.2.3.2.1.cmml">(</mo><mi id="S4.SS5.p5.2.m2.1.1" xref="S4.SS5.p5.2.m2.1.1.cmml">ϵ</mi><mo id="S4.SS5.p5.2.m2.2.3.2.2.2" xref="S4.SS5.p5.2.m2.2.3.2.1.cmml">,</mo><mi id="S4.SS5.p5.2.m2.2.2" xref="S4.SS5.p5.2.m2.2.2.cmml">δ</mi><mo id="S4.SS5.p5.2.m2.2.3.2.2.3" xref="S4.SS5.p5.2.m2.2.3.2.1.cmml">)</mo></mrow><mo id="S4.SS5.p5.2.m2.2.3.3" xref="S4.SS5.p5.2.m2.2.3.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.2.m2.2b"><apply id="S4.SS5.p5.2.m2.2.3.cmml" xref="S4.SS5.p5.2.m2.2.3"><csymbol cd="latexml" id="S4.SS5.p5.2.m2.2.3.1.cmml" xref="S4.SS5.p5.2.m2.2.3">limit-from</csymbol><interval closure="open" id="S4.SS5.p5.2.m2.2.3.2.1.cmml" xref="S4.SS5.p5.2.m2.2.3.2.2"><ci id="S4.SS5.p5.2.m2.1.1.cmml" xref="S4.SS5.p5.2.m2.1.1">italic-ϵ</ci><ci id="S4.SS5.p5.2.m2.2.2.cmml" xref="S4.SS5.p5.2.m2.2.2">𝛿</ci></interval><minus id="S4.SS5.p5.2.m2.2.3.3.cmml" xref="S4.SS5.p5.2.m2.2.3.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.2.m2.2c">\left(\epsilon,\delta\right)-</annotation></semantics></math>differentially private<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>, where <math id="S4.SS5.p5.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS5.p5.3.m3.1a"><mi id="S4.SS5.p5.3.m3.1.1" xref="S4.SS5.p5.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.3.m3.1b"><ci id="S4.SS5.p5.3.m3.1.1.cmml" xref="S4.SS5.p5.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.3.m3.1c">\epsilon</annotation></semantics></math> and <math id="S4.SS5.p5.4.m4.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S4.SS5.p5.4.m4.1a"><mi id="S4.SS5.p5.4.m4.1.1" xref="S4.SS5.p5.4.m4.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.4.m4.1b"><ci id="S4.SS5.p5.4.m4.1.1.cmml" xref="S4.SS5.p5.4.m4.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.4.m4.1c">\delta</annotation></semantics></math> are the training privacy budget and training privacy tolerance hyperparameters, respectively. Following prior works in DP-SGD under the federated learning setting<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>, we can add Gaussian noise into the gradients during class embedding training at the server to provide a DP guarantee.</p>
</div>
<div id="S4.SS5.p6" class="ltx_para">
<p id="S4.SS5.p6.1" class="ltx_p">This work proposes two algorithms: FedALC and FedALC-fixed. FedALC is outlined in Fig <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, Algorithm <a href="#alg1" title="Algorithm 1 ‣ IV-E Label sets collection ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and elaborated upon in Section IV-B. The primary distinction between FedALC and FedALC-fixed lies in their optimization strategies for updating the class embedding matrix. Specifcally, FedALC employs one-step stochastic gradient descent to update the class embedding matrix within each round, whereas FedALC-fixed utilizes multiple steps of stochastic gradient descent to update the class embedding matrix before commencing the federated learning process, after which the class embedding matrix remains fixed throughout the subsequent training process. Fig <a href="#S4.F3" title="Figure 3 ‣ IV-B Spreadout by exploring label correlations (FedALC) ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, Section IV-C and Algorithm <a href="#alg2" title="Algorithm 2 ‣ IV-E Label sets collection ‣ IV Federated Averaging by Exploring Label Correlations ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> delineate the FedALC-fixed algorithm. The most prominent disparity between the FedALC and FedALC-fixed is highlighted in the “Training the fixed class embeddings ” section at the server in FedALC-fixed, indicated by blue coloring. We separate the label collection part and the learning part in the light of clarity. Actually, the label collection can be performed together with the class embedding updates at the first round of communication.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated Averaging by exploring Label Correlations (FedALC) with collecting label sets</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Input:</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">m</annotation></semantics></math> clients, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\mathcal{S}^{i}" display="inline"><semantics id="alg1.l1.m2.1a"><msup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">𝒮</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝒮</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathcal{S}^{i}</annotation></semantics></math> at the <math id="alg1.l1.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">i</annotation></semantics></math>-th client.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Server initializes parameters <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\theta^{0}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">θ</mi><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝜃</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\theta^{0}</annotation></semantics></math>, embeddings <math id="alg1.l2.m2.1" class="ltx_Math" alttext="W^{0}" display="inline"><semantics id="alg1.l2.m2.1a"><msup id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">W</mi><mn id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">superscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑊</ci><cn type="integer" id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">W^{0}</annotation></semantics></math>, hashing function <math id="alg1.l2.m3.1" class="ltx_Math" alttext="H" display="inline"><semantics id="alg1.l2.m3.1a"><mi id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><ci id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">H</annotation></semantics></math>.

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  Server sends the initialization to clients.

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <span id="alg1.l4.2" class="ltx_text ltx_font_bold">Collecting label sets:</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>  <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span> i=1,2,3,…,m <span id="alg1.l5.3" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>   The <math id="alg1.l6.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l6.m1.1a"><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">i</annotation></semantics></math>-<math id="alg1.l6.m2.1" class="ltx_Math" alttext="th" display="inline"><semantics id="alg1.l6.m2.1a"><mrow id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m2.1.1.1" xref="alg1.l6.m2.1.1.1.cmml">​</mo><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><times id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1.1"></times><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑡</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">th</annotation></semantics></math> client downloads the initialization.

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>   Compute hash vectors on the local data set: <math id="alg1.l7.m1.1" class="ltx_Math" alttext="M_{i}\leftarrow H(g_{\theta}(\mathcal{S}^{i}))" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">M</mi><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">←</mo><mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.1.1.1.3.2.cmml">g</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="alg1.l7.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">←</ci><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝑀</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"><times id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2"></times><ci id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3">𝐻</ci><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><times id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2"></times><apply id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.2">𝒮</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">M_{i}\leftarrow H(g_{\theta}(\mathcal{S}^{i}))</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>   The <math id="alg1.l8.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">i</annotation></semantics></math>-th client sends the <math id="alg1.l8.m2.1" class="ltx_Math" alttext="M_{i}" display="inline"><semantics id="alg1.l8.m2.1a"><msub id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">M</mi><mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">subscript</csymbol><ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">𝑀</ci><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">M_{i}</annotation></semantics></math> to the server.

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  Server integrates the <math id="alg1.l10.m1.1" class="ltx_Math" alttext="M_{i}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">M</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑀</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">M_{i}</annotation></semantics></math>: <math id="alg1.l10.m2.1" class="ltx_Math" alttext="L\leftarrow\mathrm{merge}(M_{i})" display="inline"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">L</mi><mo stretchy="false" id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml">←</mo><mrow id="alg1.l10.m2.1.1.1" xref="alg1.l10.m2.1.1.1.cmml"><mi id="alg1.l10.m2.1.1.1.3" xref="alg1.l10.m2.1.1.1.3.cmml">merge</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.1.2" xref="alg1.l10.m2.1.1.1.2.cmml">​</mo><mrow id="alg1.l10.m2.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m2.1.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l10.m2.1.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m2.1.1.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.1.1.2.cmml">M</mi><mi id="alg1.l10.m2.1.1.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l10.m2.1.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><ci id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2">←</ci><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝐿</ci><apply id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1.1"><times id="alg1.l10.m2.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.2"></times><ci id="alg1.l10.m2.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.3">merge</ci><apply id="alg1.l10.m2.1.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.1.1.1.2">𝑀</ci><ci id="alg1.l10.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">L\leftarrow\mathrm{merge}(M_{i})</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>  <span id="alg1.l11.2" class="ltx_text ltx_font_bold">Federated learning process:</span>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <span id="alg1.l12.2" class="ltx_text ltx_font_bold">for</span> t=0,1,2,…,T-1 <span id="alg1.l12.3" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>   Server sends <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\theta^{t}" display="inline"><semantics id="alg1.l13.m1.1a"><msup id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">θ</mi><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">superscript</csymbol><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝜃</ci><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\theta^{t}</annotation></semantics></math>, <math id="alg1.l13.m2.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="alg1.l13.m2.1a"><msup id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml"><mi id="alg1.l13.m2.1.1.2" xref="alg1.l13.m2.1.1.2.cmml">W</mi><mi id="alg1.l13.m2.1.1.3" xref="alg1.l13.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.cmml" xref="alg1.l13.m2.1.1">superscript</csymbol><ci id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1.2">𝑊</ci><ci id="alg1.l13.m2.1.1.3.cmml" xref="alg1.l13.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">W^{t}</annotation></semantics></math> to the <math id="alg1.l13.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l13.m3.1a"><mi id="alg1.l13.m3.1.1" xref="alg1.l13.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m3.1b"><ci id="alg1.l13.m3.1.1.cmml" xref="alg1.l13.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m3.1c">i</annotation></semantics></math>-th client

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>   <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span> i=1,2,…,C <span id="alg1.l14.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>    <math id="alg1.l15.m1.7" class="ltx_Math" alttext="\left(\theta^{t}_{i},\mathbf{w}^{t}_{y_{i}}\right)\leftarrow\left(\theta^{t}_{i},\mathbf{w}^{t}_{y_{i}}\right)-\eta\nabla_{\left(\theta^{t},\mathbf{w}^{t}_{y_{i}}\right)}\hat{\mathcal{R}}_{\text{pos }}\left(\mathcal{S}^{i}\right)" display="inline"><semantics id="alg1.l15.m1.7a"><mrow id="alg1.l15.m1.7.7" xref="alg1.l15.m1.7.7.cmml"><mrow id="alg1.l15.m1.4.4.2.2" xref="alg1.l15.m1.4.4.2.3.cmml"><mo id="alg1.l15.m1.4.4.2.2.3" xref="alg1.l15.m1.4.4.2.3.cmml">(</mo><msubsup id="alg1.l15.m1.3.3.1.1.1" xref="alg1.l15.m1.3.3.1.1.1.cmml"><mi id="alg1.l15.m1.3.3.1.1.1.2.2" xref="alg1.l15.m1.3.3.1.1.1.2.2.cmml">θ</mi><mi id="alg1.l15.m1.3.3.1.1.1.3" xref="alg1.l15.m1.3.3.1.1.1.3.cmml">i</mi><mi id="alg1.l15.m1.3.3.1.1.1.2.3" xref="alg1.l15.m1.3.3.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l15.m1.4.4.2.2.4" xref="alg1.l15.m1.4.4.2.3.cmml">,</mo><msubsup id="alg1.l15.m1.4.4.2.2.2" xref="alg1.l15.m1.4.4.2.2.2.cmml"><mi id="alg1.l15.m1.4.4.2.2.2.2.2" xref="alg1.l15.m1.4.4.2.2.2.2.2.cmml">𝐰</mi><msub id="alg1.l15.m1.4.4.2.2.2.3" xref="alg1.l15.m1.4.4.2.2.2.3.cmml"><mi id="alg1.l15.m1.4.4.2.2.2.3.2" xref="alg1.l15.m1.4.4.2.2.2.3.2.cmml">y</mi><mi id="alg1.l15.m1.4.4.2.2.2.3.3" xref="alg1.l15.m1.4.4.2.2.2.3.3.cmml">i</mi></msub><mi id="alg1.l15.m1.4.4.2.2.2.2.3" xref="alg1.l15.m1.4.4.2.2.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l15.m1.4.4.2.2.5" xref="alg1.l15.m1.4.4.2.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l15.m1.7.7.6" xref="alg1.l15.m1.7.7.6.cmml">←</mo><mrow id="alg1.l15.m1.7.7.5" xref="alg1.l15.m1.7.7.5.cmml"><mrow id="alg1.l15.m1.6.6.4.2.2" xref="alg1.l15.m1.6.6.4.2.3.cmml"><mo id="alg1.l15.m1.6.6.4.2.2.3" xref="alg1.l15.m1.6.6.4.2.3.cmml">(</mo><msubsup id="alg1.l15.m1.5.5.3.1.1.1" xref="alg1.l15.m1.5.5.3.1.1.1.cmml"><mi id="alg1.l15.m1.5.5.3.1.1.1.2.2" xref="alg1.l15.m1.5.5.3.1.1.1.2.2.cmml">θ</mi><mi id="alg1.l15.m1.5.5.3.1.1.1.3" xref="alg1.l15.m1.5.5.3.1.1.1.3.cmml">i</mi><mi id="alg1.l15.m1.5.5.3.1.1.1.2.3" xref="alg1.l15.m1.5.5.3.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l15.m1.6.6.4.2.2.4" xref="alg1.l15.m1.6.6.4.2.3.cmml">,</mo><msubsup id="alg1.l15.m1.6.6.4.2.2.2" xref="alg1.l15.m1.6.6.4.2.2.2.cmml"><mi id="alg1.l15.m1.6.6.4.2.2.2.2.2" xref="alg1.l15.m1.6.6.4.2.2.2.2.2.cmml">𝐰</mi><msub id="alg1.l15.m1.6.6.4.2.2.2.3" xref="alg1.l15.m1.6.6.4.2.2.2.3.cmml"><mi id="alg1.l15.m1.6.6.4.2.2.2.3.2" xref="alg1.l15.m1.6.6.4.2.2.2.3.2.cmml">y</mi><mi id="alg1.l15.m1.6.6.4.2.2.2.3.3" xref="alg1.l15.m1.6.6.4.2.2.2.3.3.cmml">i</mi></msub><mi id="alg1.l15.m1.6.6.4.2.2.2.2.3" xref="alg1.l15.m1.6.6.4.2.2.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l15.m1.6.6.4.2.2.5" xref="alg1.l15.m1.6.6.4.2.3.cmml">)</mo></mrow><mo id="alg1.l15.m1.7.7.5.4" xref="alg1.l15.m1.7.7.5.4.cmml">−</mo><mrow id="alg1.l15.m1.7.7.5.3" xref="alg1.l15.m1.7.7.5.3.cmml"><mi id="alg1.l15.m1.7.7.5.3.3" xref="alg1.l15.m1.7.7.5.3.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l15.m1.7.7.5.3.2" xref="alg1.l15.m1.7.7.5.3.2.cmml">​</mo><mrow id="alg1.l15.m1.7.7.5.3.4" xref="alg1.l15.m1.7.7.5.3.4.cmml"><msub id="alg1.l15.m1.7.7.5.3.4.1" xref="alg1.l15.m1.7.7.5.3.4.1.cmml"><mo rspace="0.167em" id="alg1.l15.m1.7.7.5.3.4.1.2" xref="alg1.l15.m1.7.7.5.3.4.1.2.cmml">∇</mo><mrow id="alg1.l15.m1.2.2.2.2" xref="alg1.l15.m1.2.2.2.3.cmml"><mo id="alg1.l15.m1.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.3.cmml">(</mo><msup id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="alg1.l15.m1.2.2.2.2.4" xref="alg1.l15.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l15.m1.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.2.cmml">𝐰</mi><msub id="alg1.l15.m1.2.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.3.2" xref="alg1.l15.m1.2.2.2.2.2.3.2.cmml">y</mi><mi id="alg1.l15.m1.2.2.2.2.2.3.3" xref="alg1.l15.m1.2.2.2.2.2.3.3.cmml">i</mi></msub><mi id="alg1.l15.m1.2.2.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l15.m1.2.2.2.2.5" xref="alg1.l15.m1.2.2.2.3.cmml">)</mo></mrow></msub><msub id="alg1.l15.m1.7.7.5.3.4.2" xref="alg1.l15.m1.7.7.5.3.4.2.cmml"><mover accent="true" id="alg1.l15.m1.7.7.5.3.4.2.2" xref="alg1.l15.m1.7.7.5.3.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.7.7.5.3.4.2.2.2" xref="alg1.l15.m1.7.7.5.3.4.2.2.2.cmml">ℛ</mi><mo id="alg1.l15.m1.7.7.5.3.4.2.2.1" xref="alg1.l15.m1.7.7.5.3.4.2.2.1.cmml">^</mo></mover><mtext id="alg1.l15.m1.7.7.5.3.4.2.3" xref="alg1.l15.m1.7.7.5.3.4.2.3a.cmml">pos </mtext></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l15.m1.7.7.5.3.2a" xref="alg1.l15.m1.7.7.5.3.2.cmml">​</mo><mrow id="alg1.l15.m1.7.7.5.3.1.1" xref="alg1.l15.m1.7.7.5.3.1.1.1.cmml"><mo id="alg1.l15.m1.7.7.5.3.1.1.2" xref="alg1.l15.m1.7.7.5.3.1.1.1.cmml">(</mo><msup id="alg1.l15.m1.7.7.5.3.1.1.1" xref="alg1.l15.m1.7.7.5.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.7.7.5.3.1.1.1.2" xref="alg1.l15.m1.7.7.5.3.1.1.1.2.cmml">𝒮</mi><mi id="alg1.l15.m1.7.7.5.3.1.1.1.3" xref="alg1.l15.m1.7.7.5.3.1.1.1.3.cmml">i</mi></msup><mo id="alg1.l15.m1.7.7.5.3.1.1.3" xref="alg1.l15.m1.7.7.5.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.7b"><apply id="alg1.l15.m1.7.7.cmml" xref="alg1.l15.m1.7.7"><ci id="alg1.l15.m1.7.7.6.cmml" xref="alg1.l15.m1.7.7.6">←</ci><interval closure="open" id="alg1.l15.m1.4.4.2.3.cmml" xref="alg1.l15.m1.4.4.2.2"><apply id="alg1.l15.m1.3.3.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.1.1.1.1.cmml" xref="alg1.l15.m1.3.3.1.1.1">subscript</csymbol><apply id="alg1.l15.m1.3.3.1.1.1.2.cmml" xref="alg1.l15.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l15.m1.3.3.1.1.1">superscript</csymbol><ci id="alg1.l15.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l15.m1.3.3.1.1.1.2.2">𝜃</ci><ci id="alg1.l15.m1.3.3.1.1.1.2.3.cmml" xref="alg1.l15.m1.3.3.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l15.m1.3.3.1.1.1.3.cmml" xref="alg1.l15.m1.3.3.1.1.1.3">𝑖</ci></apply><apply id="alg1.l15.m1.4.4.2.2.2.cmml" xref="alg1.l15.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.2.2.2.1.cmml" xref="alg1.l15.m1.4.4.2.2.2">subscript</csymbol><apply id="alg1.l15.m1.4.4.2.2.2.2.cmml" xref="alg1.l15.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l15.m1.4.4.2.2.2">superscript</csymbol><ci id="alg1.l15.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l15.m1.4.4.2.2.2.2.2">𝐰</ci><ci id="alg1.l15.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l15.m1.4.4.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l15.m1.4.4.2.2.2.3.cmml" xref="alg1.l15.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.4.4.2.2.2.3.1.cmml" xref="alg1.l15.m1.4.4.2.2.2.3">subscript</csymbol><ci id="alg1.l15.m1.4.4.2.2.2.3.2.cmml" xref="alg1.l15.m1.4.4.2.2.2.3.2">𝑦</ci><ci id="alg1.l15.m1.4.4.2.2.2.3.3.cmml" xref="alg1.l15.m1.4.4.2.2.2.3.3">𝑖</ci></apply></apply></interval><apply id="alg1.l15.m1.7.7.5.cmml" xref="alg1.l15.m1.7.7.5"><minus id="alg1.l15.m1.7.7.5.4.cmml" xref="alg1.l15.m1.7.7.5.4"></minus><interval closure="open" id="alg1.l15.m1.6.6.4.2.3.cmml" xref="alg1.l15.m1.6.6.4.2.2"><apply id="alg1.l15.m1.5.5.3.1.1.1.cmml" xref="alg1.l15.m1.5.5.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.3.1.1.1.1.cmml" xref="alg1.l15.m1.5.5.3.1.1.1">subscript</csymbol><apply id="alg1.l15.m1.5.5.3.1.1.1.2.cmml" xref="alg1.l15.m1.5.5.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.3.1.1.1.2.1.cmml" xref="alg1.l15.m1.5.5.3.1.1.1">superscript</csymbol><ci id="alg1.l15.m1.5.5.3.1.1.1.2.2.cmml" xref="alg1.l15.m1.5.5.3.1.1.1.2.2">𝜃</ci><ci id="alg1.l15.m1.5.5.3.1.1.1.2.3.cmml" xref="alg1.l15.m1.5.5.3.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l15.m1.5.5.3.1.1.1.3.cmml" xref="alg1.l15.m1.5.5.3.1.1.1.3">𝑖</ci></apply><apply id="alg1.l15.m1.6.6.4.2.2.2.cmml" xref="alg1.l15.m1.6.6.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.6.6.4.2.2.2.1.cmml" xref="alg1.l15.m1.6.6.4.2.2.2">subscript</csymbol><apply id="alg1.l15.m1.6.6.4.2.2.2.2.cmml" xref="alg1.l15.m1.6.6.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.6.6.4.2.2.2.2.1.cmml" xref="alg1.l15.m1.6.6.4.2.2.2">superscript</csymbol><ci id="alg1.l15.m1.6.6.4.2.2.2.2.2.cmml" xref="alg1.l15.m1.6.6.4.2.2.2.2.2">𝐰</ci><ci id="alg1.l15.m1.6.6.4.2.2.2.2.3.cmml" xref="alg1.l15.m1.6.6.4.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l15.m1.6.6.4.2.2.2.3.cmml" xref="alg1.l15.m1.6.6.4.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.6.6.4.2.2.2.3.1.cmml" xref="alg1.l15.m1.6.6.4.2.2.2.3">subscript</csymbol><ci id="alg1.l15.m1.6.6.4.2.2.2.3.2.cmml" xref="alg1.l15.m1.6.6.4.2.2.2.3.2">𝑦</ci><ci id="alg1.l15.m1.6.6.4.2.2.2.3.3.cmml" xref="alg1.l15.m1.6.6.4.2.2.2.3.3">𝑖</ci></apply></apply></interval><apply id="alg1.l15.m1.7.7.5.3.cmml" xref="alg1.l15.m1.7.7.5.3"><times id="alg1.l15.m1.7.7.5.3.2.cmml" xref="alg1.l15.m1.7.7.5.3.2"></times><ci id="alg1.l15.m1.7.7.5.3.3.cmml" xref="alg1.l15.m1.7.7.5.3.3">𝜂</ci><apply id="alg1.l15.m1.7.7.5.3.4.cmml" xref="alg1.l15.m1.7.7.5.3.4"><apply id="alg1.l15.m1.7.7.5.3.4.1.cmml" xref="alg1.l15.m1.7.7.5.3.4.1"><csymbol cd="ambiguous" id="alg1.l15.m1.7.7.5.3.4.1.1.cmml" xref="alg1.l15.m1.7.7.5.3.4.1">subscript</csymbol><ci id="alg1.l15.m1.7.7.5.3.4.1.2.cmml" xref="alg1.l15.m1.7.7.5.3.4.1.2">∇</ci><interval closure="open" id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2"><apply id="alg1.l15.m1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l15.m1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l15.m1.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l15.m1.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.2">𝐰</ci><ci id="alg1.l15.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l15.m1.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l15.m1.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.3.2">𝑦</ci><ci id="alg1.l15.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply><apply id="alg1.l15.m1.7.7.5.3.4.2.cmml" xref="alg1.l15.m1.7.7.5.3.4.2"><csymbol cd="ambiguous" id="alg1.l15.m1.7.7.5.3.4.2.1.cmml" xref="alg1.l15.m1.7.7.5.3.4.2">subscript</csymbol><apply id="alg1.l15.m1.7.7.5.3.4.2.2.cmml" xref="alg1.l15.m1.7.7.5.3.4.2.2"><ci id="alg1.l15.m1.7.7.5.3.4.2.2.1.cmml" xref="alg1.l15.m1.7.7.5.3.4.2.2.1">^</ci><ci id="alg1.l15.m1.7.7.5.3.4.2.2.2.cmml" xref="alg1.l15.m1.7.7.5.3.4.2.2.2">ℛ</ci></apply><ci id="alg1.l15.m1.7.7.5.3.4.2.3a.cmml" xref="alg1.l15.m1.7.7.5.3.4.2.3"><mtext mathsize="70%" id="alg1.l15.m1.7.7.5.3.4.2.3.cmml" xref="alg1.l15.m1.7.7.5.3.4.2.3">pos </mtext></ci></apply></apply><apply id="alg1.l15.m1.7.7.5.3.1.1.1.cmml" xref="alg1.l15.m1.7.7.5.3.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.7.7.5.3.1.1.1.1.cmml" xref="alg1.l15.m1.7.7.5.3.1.1">superscript</csymbol><ci id="alg1.l15.m1.7.7.5.3.1.1.1.2.cmml" xref="alg1.l15.m1.7.7.5.3.1.1.1.2">𝒮</ci><ci id="alg1.l15.m1.7.7.5.3.1.1.1.3.cmml" xref="alg1.l15.m1.7.7.5.3.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.7c">\left(\theta^{t}_{i},\mathbf{w}^{t}_{y_{i}}\right)\leftarrow\left(\theta^{t}_{i},\mathbf{w}^{t}_{y_{i}}\right)-\eta\nabla_{\left(\theta^{t},\mathbf{w}^{t}_{y_{i}}\right)}\hat{\mathcal{R}}_{\text{pos }}\left(\mathcal{S}^{i}\right)</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>    <math id="alg1.l16.m1.2" class="ltx_Math" alttext="\text{where }\hat{\mathcal{R}}_{\text{pos }}\left(\mathcal{S}^{i}\right)=\frac{1}{n_{i}}\sum_{j\in\left[n_{i}\right]}\ell_{\mathrm{cl}}^{\mathrm{pos}}(\mathbf{x}^{i}_{j},w^{t}_{y_{i}})." display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.2.1" xref="alg1.l16.m1.2.2.1.1.cmml"><mrow id="alg1.l16.m1.2.2.1.1" xref="alg1.l16.m1.2.2.1.1.cmml"><mrow id="alg1.l16.m1.2.2.1.1.1" xref="alg1.l16.m1.2.2.1.1.1.cmml"><mtext id="alg1.l16.m1.2.2.1.1.1.3" xref="alg1.l16.m1.2.2.1.1.1.3a.cmml">where </mtext><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.2.1.1.1.2" xref="alg1.l16.m1.2.2.1.1.1.2.cmml">​</mo><msub id="alg1.l16.m1.2.2.1.1.1.4" xref="alg1.l16.m1.2.2.1.1.1.4.cmml"><mover accent="true" id="alg1.l16.m1.2.2.1.1.1.4.2" xref="alg1.l16.m1.2.2.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.2.2.1.1.1.4.2.2" xref="alg1.l16.m1.2.2.1.1.1.4.2.2.cmml">ℛ</mi><mo id="alg1.l16.m1.2.2.1.1.1.4.2.1" xref="alg1.l16.m1.2.2.1.1.1.4.2.1.cmml">^</mo></mover><mtext id="alg1.l16.m1.2.2.1.1.1.4.3" xref="alg1.l16.m1.2.2.1.1.1.4.3a.cmml">pos </mtext></msub><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.2.1.1.1.2a" xref="alg1.l16.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.2.2.1.1.1.1.1" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml"><mo id="alg1.l16.m1.2.2.1.1.1.1.1.2" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="alg1.l16.m1.2.2.1.1.1.1.1.1" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="alg1.l16.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="alg1.l16.m1.2.2.1.1.1.1.1.3" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l16.m1.2.2.1.1.4" xref="alg1.l16.m1.2.2.1.1.4.cmml">=</mo><mrow id="alg1.l16.m1.2.2.1.1.3" xref="alg1.l16.m1.2.2.1.1.3.cmml"><mfrac id="alg1.l16.m1.2.2.1.1.3.4" xref="alg1.l16.m1.2.2.1.1.3.4.cmml"><mn id="alg1.l16.m1.2.2.1.1.3.4.2" xref="alg1.l16.m1.2.2.1.1.3.4.2.cmml">1</mn><msub id="alg1.l16.m1.2.2.1.1.3.4.3" xref="alg1.l16.m1.2.2.1.1.3.4.3.cmml"><mi id="alg1.l16.m1.2.2.1.1.3.4.3.2" xref="alg1.l16.m1.2.2.1.1.3.4.3.2.cmml">n</mi><mi id="alg1.l16.m1.2.2.1.1.3.4.3.3" xref="alg1.l16.m1.2.2.1.1.3.4.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.2.1.1.3.3" xref="alg1.l16.m1.2.2.1.1.3.3.cmml">​</mo><mrow id="alg1.l16.m1.2.2.1.1.3.2" xref="alg1.l16.m1.2.2.1.1.3.2.cmml"><msub id="alg1.l16.m1.2.2.1.1.3.2.3" xref="alg1.l16.m1.2.2.1.1.3.2.3.cmml"><mo id="alg1.l16.m1.2.2.1.1.3.2.3.2" xref="alg1.l16.m1.2.2.1.1.3.2.3.2.cmml">∑</mo><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml">j</mi><mo id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">∈</mo><mrow id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.2.cmml"><mo id="alg1.l16.m1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.2.1.cmml">[</mo><msub id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.2.cmml">n</mi><mi id="alg1.l16.m1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></msub><mrow id="alg1.l16.m1.2.2.1.1.3.2.2" xref="alg1.l16.m1.2.2.1.1.3.2.2.cmml"><msubsup id="alg1.l16.m1.2.2.1.1.3.2.2.4" xref="alg1.l16.m1.2.2.1.1.3.2.2.4.cmml"><mi mathvariant="normal" id="alg1.l16.m1.2.2.1.1.3.2.2.4.2.2" xref="alg1.l16.m1.2.2.1.1.3.2.2.4.2.2.cmml">ℓ</mi><mi id="alg1.l16.m1.2.2.1.1.3.2.2.4.2.3" xref="alg1.l16.m1.2.2.1.1.3.2.2.4.2.3.cmml">cl</mi><mi id="alg1.l16.m1.2.2.1.1.3.2.2.4.3" xref="alg1.l16.m1.2.2.1.1.3.2.2.4.3.cmml">pos</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.2.1.1.3.2.2.3" xref="alg1.l16.m1.2.2.1.1.3.2.2.3.cmml">​</mo><mrow id="alg1.l16.m1.2.2.1.1.3.2.2.2.2" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.3" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.3.cmml">(</mo><msubsup id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.2" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.3" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.3.cmml">j</mi><mi id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.3" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.4" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.3.cmml">,</mo><msubsup id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.cmml"><mi id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.2.cmml">w</mi><msub id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.cmml"><mi id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.2" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.2.cmml">y</mi><mi id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.3" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.3.cmml">i</mi></msub><mi id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.5" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="alg1.l16.m1.2.2.1.2" xref="alg1.l16.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.2.1.1.cmml" xref="alg1.l16.m1.2.2.1"><eq id="alg1.l16.m1.2.2.1.1.4.cmml" xref="alg1.l16.m1.2.2.1.1.4"></eq><apply id="alg1.l16.m1.2.2.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1.1"><times id="alg1.l16.m1.2.2.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.1.1.1.2"></times><ci id="alg1.l16.m1.2.2.1.1.1.3a.cmml" xref="alg1.l16.m1.2.2.1.1.1.3"><mtext id="alg1.l16.m1.2.2.1.1.1.3.cmml" xref="alg1.l16.m1.2.2.1.1.1.3">where </mtext></ci><apply id="alg1.l16.m1.2.2.1.1.1.4.cmml" xref="alg1.l16.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.1.4.1.cmml" xref="alg1.l16.m1.2.2.1.1.1.4">subscript</csymbol><apply id="alg1.l16.m1.2.2.1.1.1.4.2.cmml" xref="alg1.l16.m1.2.2.1.1.1.4.2"><ci id="alg1.l16.m1.2.2.1.1.1.4.2.1.cmml" xref="alg1.l16.m1.2.2.1.1.1.4.2.1">^</ci><ci id="alg1.l16.m1.2.2.1.1.1.4.2.2.cmml" xref="alg1.l16.m1.2.2.1.1.1.4.2.2">ℛ</ci></apply><ci id="alg1.l16.m1.2.2.1.1.1.4.3a.cmml" xref="alg1.l16.m1.2.2.1.1.1.4.3"><mtext mathsize="70%" id="alg1.l16.m1.2.2.1.1.1.4.3.cmml" xref="alg1.l16.m1.2.2.1.1.1.4.3">pos </mtext></ci></apply><apply id="alg1.l16.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l16.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.2">𝒮</ci><ci id="alg1.l16.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l16.m1.2.2.1.1.3.cmml" xref="alg1.l16.m1.2.2.1.1.3"><times id="alg1.l16.m1.2.2.1.1.3.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.3"></times><apply id="alg1.l16.m1.2.2.1.1.3.4.cmml" xref="alg1.l16.m1.2.2.1.1.3.4"><divide id="alg1.l16.m1.2.2.1.1.3.4.1.cmml" xref="alg1.l16.m1.2.2.1.1.3.4"></divide><cn type="integer" id="alg1.l16.m1.2.2.1.1.3.4.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.4.2">1</cn><apply id="alg1.l16.m1.2.2.1.1.3.4.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.4.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.3.4.3.1.cmml" xref="alg1.l16.m1.2.2.1.1.3.4.3">subscript</csymbol><ci id="alg1.l16.m1.2.2.1.1.3.4.3.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.4.3.2">𝑛</ci><ci id="alg1.l16.m1.2.2.1.1.3.4.3.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.4.3.3">𝑖</ci></apply></apply><apply id="alg1.l16.m1.2.2.1.1.3.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2"><apply id="alg1.l16.m1.2.2.1.1.3.2.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.3.2.3.1.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.3">subscript</csymbol><sum id="alg1.l16.m1.2.2.1.1.3.2.3.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.3.2"></sum><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><in id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></in><ci id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3">𝑗</ci><apply id="alg1.l16.m1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l16.m1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2">𝑛</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="alg1.l16.m1.2.2.1.1.3.2.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2"><times id="alg1.l16.m1.2.2.1.1.3.2.2.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.3"></times><apply id="alg1.l16.m1.2.2.1.1.3.2.2.4.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.4"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.3.2.2.4.1.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.4">superscript</csymbol><apply id="alg1.l16.m1.2.2.1.1.3.2.2.4.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.4"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.3.2.2.4.2.1.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.4">subscript</csymbol><ci id="alg1.l16.m1.2.2.1.1.3.2.2.4.2.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.4.2.2">ℓ</ci><ci id="alg1.l16.m1.2.2.1.1.3.2.2.4.2.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.4.2.3">cl</ci></apply><ci id="alg1.l16.m1.2.2.1.1.3.2.2.4.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.4.3">pos</ci></apply><interval closure="open" id="alg1.l16.m1.2.2.1.1.3.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2"><apply id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1">subscript</csymbol><apply id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.2">𝐱</ci><ci id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.2.2.1.1.2.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2">subscript</csymbol><apply id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2">superscript</csymbol><ci id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.2">𝑤</ci><ci id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.1.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.2.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.2">𝑦</ci><ci id="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.3.cmml" xref="alg1.l16.m1.2.2.1.1.3.2.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">\text{where }\hat{\mathcal{R}}_{\text{pos }}\left(\mathcal{S}^{i}\right)=\frac{1}{n_{i}}\sum_{j\in\left[n_{i}\right]}\ell_{\mathrm{cl}}^{\mathrm{pos}}(\mathbf{x}^{i}_{j},w^{t}_{y_{i}}).</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>    The <math id="alg1.l17.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l17.m1.1a"><mi id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><ci id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">i</annotation></semantics></math>-th client sends <math id="alg1.l17.m2.2" class="ltx_Math" alttext="(\theta^{t}_{i},\mathbf{w}^{t}_{y_{i}})" display="inline"><semantics id="alg1.l17.m2.2a"><mrow id="alg1.l17.m2.2.2.2" xref="alg1.l17.m2.2.2.3.cmml"><mo stretchy="false" id="alg1.l17.m2.2.2.2.3" xref="alg1.l17.m2.2.2.3.cmml">(</mo><msubsup id="alg1.l17.m2.1.1.1.1" xref="alg1.l17.m2.1.1.1.1.cmml"><mi id="alg1.l17.m2.1.1.1.1.2.2" xref="alg1.l17.m2.1.1.1.1.2.2.cmml">θ</mi><mi id="alg1.l17.m2.1.1.1.1.3" xref="alg1.l17.m2.1.1.1.1.3.cmml">i</mi><mi id="alg1.l17.m2.1.1.1.1.2.3" xref="alg1.l17.m2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l17.m2.2.2.2.4" xref="alg1.l17.m2.2.2.3.cmml">,</mo><msubsup id="alg1.l17.m2.2.2.2.2" xref="alg1.l17.m2.2.2.2.2.cmml"><mi id="alg1.l17.m2.2.2.2.2.2.2" xref="alg1.l17.m2.2.2.2.2.2.2.cmml">𝐰</mi><msub id="alg1.l17.m2.2.2.2.2.3" xref="alg1.l17.m2.2.2.2.2.3.cmml"><mi id="alg1.l17.m2.2.2.2.2.3.2" xref="alg1.l17.m2.2.2.2.2.3.2.cmml">y</mi><mi id="alg1.l17.m2.2.2.2.2.3.3" xref="alg1.l17.m2.2.2.2.2.3.3.cmml">i</mi></msub><mi id="alg1.l17.m2.2.2.2.2.2.3" xref="alg1.l17.m2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l17.m2.2.2.2.5" xref="alg1.l17.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m2.2b"><interval closure="open" id="alg1.l17.m2.2.2.3.cmml" xref="alg1.l17.m2.2.2.2"><apply id="alg1.l17.m2.1.1.1.1.cmml" xref="alg1.l17.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m2.1.1.1.1.1.cmml" xref="alg1.l17.m2.1.1.1.1">subscript</csymbol><apply id="alg1.l17.m2.1.1.1.1.2.cmml" xref="alg1.l17.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m2.1.1.1.1.2.1.cmml" xref="alg1.l17.m2.1.1.1.1">superscript</csymbol><ci id="alg1.l17.m2.1.1.1.1.2.2.cmml" xref="alg1.l17.m2.1.1.1.1.2.2">𝜃</ci><ci id="alg1.l17.m2.1.1.1.1.2.3.cmml" xref="alg1.l17.m2.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l17.m2.1.1.1.1.3.cmml" xref="alg1.l17.m2.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l17.m2.2.2.2.2.cmml" xref="alg1.l17.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l17.m2.2.2.2.2.1.cmml" xref="alg1.l17.m2.2.2.2.2">subscript</csymbol><apply id="alg1.l17.m2.2.2.2.2.2.cmml" xref="alg1.l17.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l17.m2.2.2.2.2.2.1.cmml" xref="alg1.l17.m2.2.2.2.2">superscript</csymbol><ci id="alg1.l17.m2.2.2.2.2.2.2.cmml" xref="alg1.l17.m2.2.2.2.2.2.2">𝐰</ci><ci id="alg1.l17.m2.2.2.2.2.2.3.cmml" xref="alg1.l17.m2.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l17.m2.2.2.2.2.3.cmml" xref="alg1.l17.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l17.m2.2.2.2.2.3.1.cmml" xref="alg1.l17.m2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l17.m2.2.2.2.2.3.2.cmml" xref="alg1.l17.m2.2.2.2.2.3.2">𝑦</ci><ci id="alg1.l17.m2.2.2.2.2.3.3.cmml" xref="alg1.l17.m2.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m2.2c">(\theta^{t}_{i},\mathbf{w}^{t}_{y_{i}})</annotation></semantics></math> to the server.

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>   <span id="alg1.l18.2" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>   Server updates the model parameters by averaging : <math id="alg1.l19.m1.1" class="ltx_Math" alttext="\theta^{t+1}=\frac{1}{C}\sum\limits_{i\in[C]}\theta^{t}_{i}" display="inline"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.2" xref="alg1.l19.m1.1.2.cmml"><msup id="alg1.l19.m1.1.2.2" xref="alg1.l19.m1.1.2.2.cmml"><mi id="alg1.l19.m1.1.2.2.2" xref="alg1.l19.m1.1.2.2.2.cmml">θ</mi><mrow id="alg1.l19.m1.1.2.2.3" xref="alg1.l19.m1.1.2.2.3.cmml"><mi id="alg1.l19.m1.1.2.2.3.2" xref="alg1.l19.m1.1.2.2.3.2.cmml">t</mi><mo id="alg1.l19.m1.1.2.2.3.1" xref="alg1.l19.m1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l19.m1.1.2.2.3.3" xref="alg1.l19.m1.1.2.2.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l19.m1.1.2.1" xref="alg1.l19.m1.1.2.1.cmml">=</mo><mrow id="alg1.l19.m1.1.2.3" xref="alg1.l19.m1.1.2.3.cmml"><mfrac id="alg1.l19.m1.1.2.3.2" xref="alg1.l19.m1.1.2.3.2.cmml"><mn id="alg1.l19.m1.1.2.3.2.2" xref="alg1.l19.m1.1.2.3.2.2.cmml">1</mn><mi id="alg1.l19.m1.1.2.3.2.3" xref="alg1.l19.m1.1.2.3.2.3.cmml">C</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l19.m1.1.2.3.1" xref="alg1.l19.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l19.m1.1.2.3.3" xref="alg1.l19.m1.1.2.3.3.cmml"><munder id="alg1.l19.m1.1.2.3.3.1" xref="alg1.l19.m1.1.2.3.3.1.cmml"><mo movablelimits="false" id="alg1.l19.m1.1.2.3.3.1.2" xref="alg1.l19.m1.1.2.3.3.1.2.cmml">∑</mo><mrow id="alg1.l19.m1.1.1.1" xref="alg1.l19.m1.1.1.1.cmml"><mi id="alg1.l19.m1.1.1.1.3" xref="alg1.l19.m1.1.1.1.3.cmml">i</mi><mo id="alg1.l19.m1.1.1.1.2" xref="alg1.l19.m1.1.1.1.2.cmml">∈</mo><mrow id="alg1.l19.m1.1.1.1.4.2" xref="alg1.l19.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="alg1.l19.m1.1.1.1.4.2.1" xref="alg1.l19.m1.1.1.1.4.1.1.cmml">[</mo><mi id="alg1.l19.m1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.cmml">C</mi><mo stretchy="false" id="alg1.l19.m1.1.1.1.4.2.2" xref="alg1.l19.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder><msubsup id="alg1.l19.m1.1.2.3.3.2" xref="alg1.l19.m1.1.2.3.3.2.cmml"><mi id="alg1.l19.m1.1.2.3.3.2.2.2" xref="alg1.l19.m1.1.2.3.3.2.2.2.cmml">θ</mi><mi id="alg1.l19.m1.1.2.3.3.2.3" xref="alg1.l19.m1.1.2.3.3.2.3.cmml">i</mi><mi id="alg1.l19.m1.1.2.3.3.2.2.3" xref="alg1.l19.m1.1.2.3.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.2.cmml" xref="alg1.l19.m1.1.2"><eq id="alg1.l19.m1.1.2.1.cmml" xref="alg1.l19.m1.1.2.1"></eq><apply id="alg1.l19.m1.1.2.2.cmml" xref="alg1.l19.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.2.2.1.cmml" xref="alg1.l19.m1.1.2.2">superscript</csymbol><ci id="alg1.l19.m1.1.2.2.2.cmml" xref="alg1.l19.m1.1.2.2.2">𝜃</ci><apply id="alg1.l19.m1.1.2.2.3.cmml" xref="alg1.l19.m1.1.2.2.3"><plus id="alg1.l19.m1.1.2.2.3.1.cmml" xref="alg1.l19.m1.1.2.2.3.1"></plus><ci id="alg1.l19.m1.1.2.2.3.2.cmml" xref="alg1.l19.m1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l19.m1.1.2.2.3.3.cmml" xref="alg1.l19.m1.1.2.2.3.3">1</cn></apply></apply><apply id="alg1.l19.m1.1.2.3.cmml" xref="alg1.l19.m1.1.2.3"><times id="alg1.l19.m1.1.2.3.1.cmml" xref="alg1.l19.m1.1.2.3.1"></times><apply id="alg1.l19.m1.1.2.3.2.cmml" xref="alg1.l19.m1.1.2.3.2"><divide id="alg1.l19.m1.1.2.3.2.1.cmml" xref="alg1.l19.m1.1.2.3.2"></divide><cn type="integer" id="alg1.l19.m1.1.2.3.2.2.cmml" xref="alg1.l19.m1.1.2.3.2.2">1</cn><ci id="alg1.l19.m1.1.2.3.2.3.cmml" xref="alg1.l19.m1.1.2.3.2.3">𝐶</ci></apply><apply id="alg1.l19.m1.1.2.3.3.cmml" xref="alg1.l19.m1.1.2.3.3"><apply id="alg1.l19.m1.1.2.3.3.1.cmml" xref="alg1.l19.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l19.m1.1.2.3.3.1.1.cmml" xref="alg1.l19.m1.1.2.3.3.1">subscript</csymbol><sum id="alg1.l19.m1.1.2.3.3.1.2.cmml" xref="alg1.l19.m1.1.2.3.3.1.2"></sum><apply id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1"><in id="alg1.l19.m1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.2"></in><ci id="alg1.l19.m1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.3">𝑖</ci><apply id="alg1.l19.m1.1.1.1.4.1.cmml" xref="alg1.l19.m1.1.1.1.4.2"><csymbol cd="latexml" id="alg1.l19.m1.1.1.1.4.1.1.cmml" xref="alg1.l19.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="alg1.l19.m1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1">𝐶</ci></apply></apply></apply><apply id="alg1.l19.m1.1.2.3.3.2.cmml" xref="alg1.l19.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.2.3.3.2.1.cmml" xref="alg1.l19.m1.1.2.3.3.2">subscript</csymbol><apply id="alg1.l19.m1.1.2.3.3.2.2.cmml" xref="alg1.l19.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.2.3.3.2.2.1.cmml" xref="alg1.l19.m1.1.2.3.3.2">superscript</csymbol><ci id="alg1.l19.m1.1.2.3.3.2.2.2.cmml" xref="alg1.l19.m1.1.2.3.3.2.2.2">𝜃</ci><ci id="alg1.l19.m1.1.2.3.3.2.2.3.cmml" xref="alg1.l19.m1.1.2.3.3.2.2.3">𝑡</ci></apply><ci id="alg1.l19.m1.1.2.3.3.2.3.cmml" xref="alg1.l19.m1.1.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\theta^{t+1}=\frac{1}{C}\sum\limits_{i\in[C]}\theta^{t}_{i}</annotation></semantics></math>,

</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>   Server merges the class embedding  and obtains <math id="alg1.l20.m1.1" class="ltx_Math" alttext="\tilde{W}^{t+1}=W^{t}" display="inline"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><msup id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml"><mover accent="true" id="alg1.l20.m1.1.1.2.2" xref="alg1.l20.m1.1.1.2.2.cmml"><mi id="alg1.l20.m1.1.1.2.2.2" xref="alg1.l20.m1.1.1.2.2.2.cmml">W</mi><mo id="alg1.l20.m1.1.1.2.2.1" xref="alg1.l20.m1.1.1.2.2.1.cmml">~</mo></mover><mrow id="alg1.l20.m1.1.1.2.3" xref="alg1.l20.m1.1.1.2.3.cmml"><mi id="alg1.l20.m1.1.1.2.3.2" xref="alg1.l20.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l20.m1.1.1.2.3.1" xref="alg1.l20.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l20.m1.1.1.2.3.3" xref="alg1.l20.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml">=</mo><msup id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml"><mi id="alg1.l20.m1.1.1.3.2" xref="alg1.l20.m1.1.1.3.2.cmml">W</mi><mi id="alg1.l20.m1.1.1.3.3" xref="alg1.l20.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><eq id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1"></eq><apply id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.2.1.cmml" xref="alg1.l20.m1.1.1.2">superscript</csymbol><apply id="alg1.l20.m1.1.1.2.2.cmml" xref="alg1.l20.m1.1.1.2.2"><ci id="alg1.l20.m1.1.1.2.2.1.cmml" xref="alg1.l20.m1.1.1.2.2.1">~</ci><ci id="alg1.l20.m1.1.1.2.2.2.cmml" xref="alg1.l20.m1.1.1.2.2.2">𝑊</ci></apply><apply id="alg1.l20.m1.1.1.2.3.cmml" xref="alg1.l20.m1.1.1.2.3"><plus id="alg1.l20.m1.1.1.2.3.1.cmml" xref="alg1.l20.m1.1.1.2.3.1"></plus><ci id="alg1.l20.m1.1.1.2.3.2.cmml" xref="alg1.l20.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l20.m1.1.1.2.3.3.cmml" xref="alg1.l20.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.3.1.cmml" xref="alg1.l20.m1.1.1.3">superscript</csymbol><ci id="alg1.l20.m1.1.1.3.2.cmml" xref="alg1.l20.m1.1.1.3.2">𝑊</ci><ci id="alg1.l20.m1.1.1.3.3.cmml" xref="alg1.l20.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">\tilde{W}^{t+1}=W^{t}</annotation></semantics></math>

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>   <math id="alg1.l21.m1.2" class="ltx_Math" alttext="W^{t+1}\leftarrow\tilde{W}^{t+1}-\lambda\eta\nabla_{\tilde{W}^{t+1}}\operatorname{reg}_{\mathrm{c}}\left(\tilde{W}^{t+1}\right)" display="inline"><semantics id="alg1.l21.m1.2a"><mrow id="alg1.l21.m1.2.2" xref="alg1.l21.m1.2.2.cmml"><msup id="alg1.l21.m1.2.2.4" xref="alg1.l21.m1.2.2.4.cmml"><mi id="alg1.l21.m1.2.2.4.2" xref="alg1.l21.m1.2.2.4.2.cmml">W</mi><mrow id="alg1.l21.m1.2.2.4.3" xref="alg1.l21.m1.2.2.4.3.cmml"><mi id="alg1.l21.m1.2.2.4.3.2" xref="alg1.l21.m1.2.2.4.3.2.cmml">t</mi><mo id="alg1.l21.m1.2.2.4.3.1" xref="alg1.l21.m1.2.2.4.3.1.cmml">+</mo><mn id="alg1.l21.m1.2.2.4.3.3" xref="alg1.l21.m1.2.2.4.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="alg1.l21.m1.2.2.3" xref="alg1.l21.m1.2.2.3.cmml">←</mo><mrow id="alg1.l21.m1.2.2.2" xref="alg1.l21.m1.2.2.2.cmml"><msup id="alg1.l21.m1.2.2.2.4" xref="alg1.l21.m1.2.2.2.4.cmml"><mover accent="true" id="alg1.l21.m1.2.2.2.4.2" xref="alg1.l21.m1.2.2.2.4.2.cmml"><mi id="alg1.l21.m1.2.2.2.4.2.2" xref="alg1.l21.m1.2.2.2.4.2.2.cmml">W</mi><mo id="alg1.l21.m1.2.2.2.4.2.1" xref="alg1.l21.m1.2.2.2.4.2.1.cmml">~</mo></mover><mrow id="alg1.l21.m1.2.2.2.4.3" xref="alg1.l21.m1.2.2.2.4.3.cmml"><mi id="alg1.l21.m1.2.2.2.4.3.2" xref="alg1.l21.m1.2.2.2.4.3.2.cmml">t</mi><mo id="alg1.l21.m1.2.2.2.4.3.1" xref="alg1.l21.m1.2.2.2.4.3.1.cmml">+</mo><mn id="alg1.l21.m1.2.2.2.4.3.3" xref="alg1.l21.m1.2.2.2.4.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l21.m1.2.2.2.3" xref="alg1.l21.m1.2.2.2.3.cmml">−</mo><mrow id="alg1.l21.m1.2.2.2.2" xref="alg1.l21.m1.2.2.2.2.cmml"><mi id="alg1.l21.m1.2.2.2.2.4" xref="alg1.l21.m1.2.2.2.2.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.2.2.3" xref="alg1.l21.m1.2.2.2.2.3.cmml">​</mo><mi id="alg1.l21.m1.2.2.2.2.5" xref="alg1.l21.m1.2.2.2.2.5.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l21.m1.2.2.2.2.3a" xref="alg1.l21.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l21.m1.2.2.2.2.2.2" xref="alg1.l21.m1.2.2.2.2.2.3.cmml"><mrow id="alg1.l21.m1.1.1.1.1.1.1.1" xref="alg1.l21.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l21.m1.1.1.1.1.1.1.1.1" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="alg1.l21.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.2.cmml">∇</mo><msup id="alg1.l21.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mo id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.1" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.1" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup></msub><msub id="alg1.l21.m1.1.1.1.1.1.1.1.2" xref="alg1.l21.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l21.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l21.m1.1.1.1.1.1.1.1.2.2.cmml">reg</mi><mi mathvariant="normal" id="alg1.l21.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l21.m1.1.1.1.1.1.1.1.2.3.cmml">c</mi></msub></mrow><mo id="alg1.l21.m1.2.2.2.2.2.2a" xref="alg1.l21.m1.2.2.2.2.2.3.cmml">⁡</mo><mrow id="alg1.l21.m1.2.2.2.2.2.2.2" xref="alg1.l21.m1.2.2.2.2.2.3.cmml"><mo id="alg1.l21.m1.2.2.2.2.2.2.2.2" xref="alg1.l21.m1.2.2.2.2.2.3.cmml">(</mo><msup id="alg1.l21.m1.2.2.2.2.2.2.2.1" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.cmml"><mover accent="true" id="alg1.l21.m1.2.2.2.2.2.2.2.1.2" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.2.cmml"><mi id="alg1.l21.m1.2.2.2.2.2.2.2.1.2.2" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.2.2.cmml">W</mi><mo id="alg1.l21.m1.2.2.2.2.2.2.2.1.2.1" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.2.1.cmml">~</mo></mover><mrow id="alg1.l21.m1.2.2.2.2.2.2.2.1.3" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.3.cmml"><mi id="alg1.l21.m1.2.2.2.2.2.2.2.1.3.2" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.3.2.cmml">t</mi><mo id="alg1.l21.m1.2.2.2.2.2.2.2.1.3.1" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.3.1.cmml">+</mo><mn id="alg1.l21.m1.2.2.2.2.2.2.2.1.3.3" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l21.m1.2.2.2.2.2.2.2.3" xref="alg1.l21.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.2b"><apply id="alg1.l21.m1.2.2.cmml" xref="alg1.l21.m1.2.2"><ci id="alg1.l21.m1.2.2.3.cmml" xref="alg1.l21.m1.2.2.3">←</ci><apply id="alg1.l21.m1.2.2.4.cmml" xref="alg1.l21.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.4.1.cmml" xref="alg1.l21.m1.2.2.4">superscript</csymbol><ci id="alg1.l21.m1.2.2.4.2.cmml" xref="alg1.l21.m1.2.2.4.2">𝑊</ci><apply id="alg1.l21.m1.2.2.4.3.cmml" xref="alg1.l21.m1.2.2.4.3"><plus id="alg1.l21.m1.2.2.4.3.1.cmml" xref="alg1.l21.m1.2.2.4.3.1"></plus><ci id="alg1.l21.m1.2.2.4.3.2.cmml" xref="alg1.l21.m1.2.2.4.3.2">𝑡</ci><cn type="integer" id="alg1.l21.m1.2.2.4.3.3.cmml" xref="alg1.l21.m1.2.2.4.3.3">1</cn></apply></apply><apply id="alg1.l21.m1.2.2.2.cmml" xref="alg1.l21.m1.2.2.2"><minus id="alg1.l21.m1.2.2.2.3.cmml" xref="alg1.l21.m1.2.2.2.3"></minus><apply id="alg1.l21.m1.2.2.2.4.cmml" xref="alg1.l21.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.2.4.1.cmml" xref="alg1.l21.m1.2.2.2.4">superscript</csymbol><apply id="alg1.l21.m1.2.2.2.4.2.cmml" xref="alg1.l21.m1.2.2.2.4.2"><ci id="alg1.l21.m1.2.2.2.4.2.1.cmml" xref="alg1.l21.m1.2.2.2.4.2.1">~</ci><ci id="alg1.l21.m1.2.2.2.4.2.2.cmml" xref="alg1.l21.m1.2.2.2.4.2.2">𝑊</ci></apply><apply id="alg1.l21.m1.2.2.2.4.3.cmml" xref="alg1.l21.m1.2.2.2.4.3"><plus id="alg1.l21.m1.2.2.2.4.3.1.cmml" xref="alg1.l21.m1.2.2.2.4.3.1"></plus><ci id="alg1.l21.m1.2.2.2.4.3.2.cmml" xref="alg1.l21.m1.2.2.2.4.3.2">𝑡</ci><cn type="integer" id="alg1.l21.m1.2.2.2.4.3.3.cmml" xref="alg1.l21.m1.2.2.2.4.3.3">1</cn></apply></apply><apply id="alg1.l21.m1.2.2.2.2.cmml" xref="alg1.l21.m1.2.2.2.2"><times id="alg1.l21.m1.2.2.2.2.3.cmml" xref="alg1.l21.m1.2.2.2.2.3"></times><ci id="alg1.l21.m1.2.2.2.2.4.cmml" xref="alg1.l21.m1.2.2.2.2.4">𝜆</ci><ci id="alg1.l21.m1.2.2.2.2.5.cmml" xref="alg1.l21.m1.2.2.2.2.5">𝜂</ci><apply id="alg1.l21.m1.2.2.2.2.2.3.cmml" xref="alg1.l21.m1.2.2.2.2.2.2"><apply id="alg1.l21.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1"><apply id="alg1.l21.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l21.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.2">∇</ci><apply id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2"><ci id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.2.2">𝑊</ci></apply><apply id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3"><plus id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l21.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l21.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.2.2">reg</ci><ci id="alg1.l21.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l21.m1.1.1.1.1.1.1.1.2.3">c</ci></apply></apply><apply id="alg1.l21.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.2.2.2.2.2.1.1.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1">superscript</csymbol><apply id="alg1.l21.m1.2.2.2.2.2.2.2.1.2.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.2"><ci id="alg1.l21.m1.2.2.2.2.2.2.2.1.2.1.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.2.1">~</ci><ci id="alg1.l21.m1.2.2.2.2.2.2.2.1.2.2.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.2.2">𝑊</ci></apply><apply id="alg1.l21.m1.2.2.2.2.2.2.2.1.3.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.3"><plus id="alg1.l21.m1.2.2.2.2.2.2.2.1.3.1.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.3.1"></plus><ci id="alg1.l21.m1.2.2.2.2.2.2.2.1.3.2.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.3.2">𝑡</ci><cn type="integer" id="alg1.l21.m1.2.2.2.2.2.2.2.1.3.3.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2.1.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.2c">W^{t+1}\leftarrow\tilde{W}^{t+1}-\lambda\eta\nabla_{\tilde{W}^{t+1}}\operatorname{reg}_{\mathrm{c}}\left(\tilde{W}^{t+1}\right)</annotation></semantics></math>.

</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>  <span id="alg1.l22.2" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>  <span id="alg1.l23.2" class="ltx_text ltx_font_bold">Output:</span> <math id="alg1.l23.m1.2" class="ltx_Math" alttext="\theta^{\mathrm{opt}},W^{\mathrm{opt}}" display="inline"><semantics id="alg1.l23.m1.2a"><mrow id="alg1.l23.m1.2.2.2" xref="alg1.l23.m1.2.2.3.cmml"><msup id="alg1.l23.m1.1.1.1.1" xref="alg1.l23.m1.1.1.1.1.cmml"><mi id="alg1.l23.m1.1.1.1.1.2" xref="alg1.l23.m1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l23.m1.1.1.1.1.3" xref="alg1.l23.m1.1.1.1.1.3.cmml">opt</mi></msup><mo id="alg1.l23.m1.2.2.2.3" xref="alg1.l23.m1.2.2.3.cmml">,</mo><msup id="alg1.l23.m1.2.2.2.2" xref="alg1.l23.m1.2.2.2.2.cmml"><mi id="alg1.l23.m1.2.2.2.2.2" xref="alg1.l23.m1.2.2.2.2.2.cmml">W</mi><mi id="alg1.l23.m1.2.2.2.2.3" xref="alg1.l23.m1.2.2.2.2.3.cmml">opt</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.2b"><list id="alg1.l23.m1.2.2.3.cmml" xref="alg1.l23.m1.2.2.2"><apply id="alg1.l23.m1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l23.m1.1.1.1.1.2.cmml" xref="alg1.l23.m1.1.1.1.1.2">𝜃</ci><ci id="alg1.l23.m1.1.1.1.1.3.cmml" xref="alg1.l23.m1.1.1.1.1.3">opt</ci></apply><apply id="alg1.l23.m1.2.2.2.2.cmml" xref="alg1.l23.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.2.2.1.cmml" xref="alg1.l23.m1.2.2.2.2">superscript</csymbol><ci id="alg1.l23.m1.2.2.2.2.2.cmml" xref="alg1.l23.m1.2.2.2.2.2">𝑊</ci><ci id="alg1.l23.m1.2.2.2.2.3.cmml" xref="alg1.l23.m1.2.2.2.2.3">opt</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.2c">\theta^{\mathrm{opt}},W^{\mathrm{opt}}</annotation></semantics></math>.

</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Federated Averaging by exploring Label Correlations with fixed embeddings (FedALC-fixed)</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg2.l1.2" class="ltx_text ltx_font_bold">Input:</span> <math id="alg2.l1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">m</annotation></semantics></math> clients, <math id="alg2.l1.m2.1" class="ltx_Math" alttext="\mathcal{S}^{i}" display="inline"><semantics id="alg2.l1.m2.1a"><msup id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml">𝒮</mi><mi id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1">superscript</csymbol><ci id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2">𝒮</ci><ci id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">\mathcal{S}^{i}</annotation></semantics></math> at the <math id="alg2.l1.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l1.m3.1a"><mi id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><ci id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">i</annotation></semantics></math>-th client.

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Server initializes parameters <math id="alg2.l2.m1.1" class="ltx_Math" alttext="\theta^{0}" display="inline"><semantics id="alg2.l2.m1.1a"><msup id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">θ</mi><mn id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">superscript</csymbol><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝜃</ci><cn type="integer" id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\theta^{0}</annotation></semantics></math>, embeddings <math id="alg2.l2.m2.1" class="ltx_Math" alttext="W^{0}" display="inline"><semantics id="alg2.l2.m2.1a"><msup id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml"><mi id="alg2.l2.m2.1.1.2" xref="alg2.l2.m2.1.1.2.cmml">W</mi><mn id="alg2.l2.m2.1.1.3" xref="alg2.l2.m2.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><apply id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.cmml" xref="alg2.l2.m2.1.1">superscript</csymbol><ci id="alg2.l2.m2.1.1.2.cmml" xref="alg2.l2.m2.1.1.2">𝑊</ci><cn type="integer" id="alg2.l2.m2.1.1.3.cmml" xref="alg2.l2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">W^{0}</annotation></semantics></math>, hashing function <math id="alg2.l2.m3.1" class="ltx_Math" alttext="H" display="inline"><semantics id="alg2.l2.m3.1a"><mi id="alg2.l2.m3.1.1" xref="alg2.l2.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m3.1b"><ci id="alg2.l2.m3.1.1.cmml" xref="alg2.l2.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m3.1c">H</annotation></semantics></math>.

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  Server sends the initialization to clients.

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <span id="alg2.l4.2" class="ltx_text ltx_font_bold">Collecting label sets:</span>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>  <span id="alg2.l5.2" class="ltx_text ltx_font_bold">for</span> i=1,2,3,…,m <span id="alg2.l5.3" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>   The <math id="alg2.l6.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">i</annotation></semantics></math>-<math id="alg2.l6.m2.1" class="ltx_Math" alttext="th" display="inline"><semantics id="alg2.l6.m2.1a"><mrow id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml"><mi id="alg2.l6.m2.1.1.2" xref="alg2.l6.m2.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m2.1.1.1" xref="alg2.l6.m2.1.1.1.cmml">​</mo><mi id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"><times id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1.1"></times><ci id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2">𝑡</ci><ci id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">th</annotation></semantics></math> client downloads the initialization.

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>   Compute hash vectors on the local data set: <math id="alg2.l7.m1.1" class="ltx_Math" alttext="M_{i}\leftarrow H(g_{\theta}(\mathcal{S}^{i}))" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><msub id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"><mi id="alg2.l7.m1.1.1.3.2" xref="alg2.l7.m1.1.1.3.2.cmml">M</mi><mi id="alg2.l7.m1.1.1.3.3" xref="alg2.l7.m1.1.1.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">←</mo><mrow id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml"><mi id="alg2.l7.m1.1.1.1.3" xref="alg2.l7.m1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.2" xref="alg2.l7.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l7.m1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l7.m1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><msub id="alg2.l7.m1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.3.2.cmml">g</mi><mi id="alg2.l7.m1.1.1.1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="alg2.l7.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">←</ci><apply id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.3.2">𝑀</ci><ci id="alg2.l7.m1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.3.3">𝑖</ci></apply><apply id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"><times id="alg2.l7.m1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.2"></times><ci id="alg2.l7.m1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.3">𝐻</ci><apply id="alg2.l7.m1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1"><times id="alg2.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.2"></times><apply id="alg2.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2">𝒮</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">M_{i}\leftarrow H(g_{\theta}(\mathcal{S}^{i}))</annotation></semantics></math>

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>   The <math id="alg2.l8.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l8.m1.1a"><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">i</annotation></semantics></math>-th client sends the <math id="alg2.l8.m2.1" class="ltx_Math" alttext="M_{i}" display="inline"><semantics id="alg2.l8.m2.1a"><msub id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml"><mi id="alg2.l8.m2.1.1.2" xref="alg2.l8.m2.1.1.2.cmml">M</mi><mi id="alg2.l8.m2.1.1.3" xref="alg2.l8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.1b"><apply id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1"><csymbol cd="ambiguous" id="alg2.l8.m2.1.1.1.cmml" xref="alg2.l8.m2.1.1">subscript</csymbol><ci id="alg2.l8.m2.1.1.2.cmml" xref="alg2.l8.m2.1.1.2">𝑀</ci><ci id="alg2.l8.m2.1.1.3.cmml" xref="alg2.l8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.1c">M_{i}</annotation></semantics></math> to the server.

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  <span id="alg2.l9.2" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  Server integrates the <math id="alg2.l10.m1.1" class="ltx_Math" alttext="M_{i}" display="inline"><semantics id="alg2.l10.m1.1a"><msub id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">M</mi><mi id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1">subscript</csymbol><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝑀</ci><ci id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">M_{i}</annotation></semantics></math>: <math id="alg2.l10.m2.1" class="ltx_Math" alttext="L\leftarrow\mathrm{merge}(M_{i})" display="inline"><semantics id="alg2.l10.m2.1a"><mrow id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml"><mi id="alg2.l10.m2.1.1.3" xref="alg2.l10.m2.1.1.3.cmml">L</mi><mo stretchy="false" id="alg2.l10.m2.1.1.2" xref="alg2.l10.m2.1.1.2.cmml">←</mo><mrow id="alg2.l10.m2.1.1.1" xref="alg2.l10.m2.1.1.1.cmml"><mi id="alg2.l10.m2.1.1.1.3" xref="alg2.l10.m2.1.1.1.3.cmml">merge</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m2.1.1.1.2" xref="alg2.l10.m2.1.1.1.2.cmml">​</mo><mrow id="alg2.l10.m2.1.1.1.1.1" xref="alg2.l10.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l10.m2.1.1.1.1.1.2" xref="alg2.l10.m2.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l10.m2.1.1.1.1.1.1" xref="alg2.l10.m2.1.1.1.1.1.1.cmml"><mi id="alg2.l10.m2.1.1.1.1.1.1.2" xref="alg2.l10.m2.1.1.1.1.1.1.2.cmml">M</mi><mi id="alg2.l10.m2.1.1.1.1.1.1.3" xref="alg2.l10.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l10.m2.1.1.1.1.1.3" xref="alg2.l10.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><apply id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1"><ci id="alg2.l10.m2.1.1.2.cmml" xref="alg2.l10.m2.1.1.2">←</ci><ci id="alg2.l10.m2.1.1.3.cmml" xref="alg2.l10.m2.1.1.3">𝐿</ci><apply id="alg2.l10.m2.1.1.1.cmml" xref="alg2.l10.m2.1.1.1"><times id="alg2.l10.m2.1.1.1.2.cmml" xref="alg2.l10.m2.1.1.1.2"></times><ci id="alg2.l10.m2.1.1.1.3.cmml" xref="alg2.l10.m2.1.1.1.3">merge</ci><apply id="alg2.l10.m2.1.1.1.1.1.1.cmml" xref="alg2.l10.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l10.m2.1.1.1.1.1">subscript</csymbol><ci id="alg2.l10.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l10.m2.1.1.1.1.1.1.2">𝑀</ci><ci id="alg2.l10.m2.1.1.1.1.1.1.3.cmml" xref="alg2.l10.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">L\leftarrow\mathrm{merge}(M_{i})</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>  <span id="alg2.l11.2" class="ltx_text ltx_font_bold">Training the fixed class embeddings:</span>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <span id="alg2.l12.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l12.m1.5" class="ltx_Math" alttext="t^{{}^{\prime}}=0,1,2,...,T^{{}^{\prime}}-1" display="inline"><semantics id="alg2.l12.m1.5a"><mrow id="alg2.l12.m1.5.5" xref="alg2.l12.m1.5.5.cmml"><msup id="alg2.l12.m1.5.5.3" xref="alg2.l12.m1.5.5.3.cmml"><mi id="alg2.l12.m1.5.5.3.2" xref="alg2.l12.m1.5.5.3.2.cmml">t</mi><msup id="alg2.l12.m1.5.5.3.3" xref="alg2.l12.m1.5.5.3.3.cmml"><mi id="alg2.l12.m1.5.5.3.3a" xref="alg2.l12.m1.5.5.3.3.cmml"></mi><mo id="alg2.l12.m1.5.5.3.3.1" xref="alg2.l12.m1.5.5.3.3.1.cmml">′</mo></msup></msup><mo id="alg2.l12.m1.5.5.2" xref="alg2.l12.m1.5.5.2.cmml">=</mo><mrow id="alg2.l12.m1.5.5.1.1" xref="alg2.l12.m1.5.5.1.2.cmml"><mn id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml">0</mn><mo id="alg2.l12.m1.5.5.1.1.2" xref="alg2.l12.m1.5.5.1.2.cmml">,</mo><mn id="alg2.l12.m1.2.2" xref="alg2.l12.m1.2.2.cmml">1</mn><mo id="alg2.l12.m1.5.5.1.1.3" xref="alg2.l12.m1.5.5.1.2.cmml">,</mo><mn id="alg2.l12.m1.3.3" xref="alg2.l12.m1.3.3.cmml">2</mn><mo id="alg2.l12.m1.5.5.1.1.4" xref="alg2.l12.m1.5.5.1.2.cmml">,</mo><mi mathvariant="normal" id="alg2.l12.m1.4.4" xref="alg2.l12.m1.4.4.cmml">…</mi><mo id="alg2.l12.m1.5.5.1.1.5" xref="alg2.l12.m1.5.5.1.2.cmml">,</mo><mrow id="alg2.l12.m1.5.5.1.1.1" xref="alg2.l12.m1.5.5.1.1.1.cmml"><msup id="alg2.l12.m1.5.5.1.1.1.2" xref="alg2.l12.m1.5.5.1.1.1.2.cmml"><mi id="alg2.l12.m1.5.5.1.1.1.2.2" xref="alg2.l12.m1.5.5.1.1.1.2.2.cmml">T</mi><msup id="alg2.l12.m1.5.5.1.1.1.2.3" xref="alg2.l12.m1.5.5.1.1.1.2.3.cmml"><mi id="alg2.l12.m1.5.5.1.1.1.2.3a" xref="alg2.l12.m1.5.5.1.1.1.2.3.cmml"></mi><mo id="alg2.l12.m1.5.5.1.1.1.2.3.1" xref="alg2.l12.m1.5.5.1.1.1.2.3.1.cmml">′</mo></msup></msup><mo id="alg2.l12.m1.5.5.1.1.1.1" xref="alg2.l12.m1.5.5.1.1.1.1.cmml">−</mo><mn id="alg2.l12.m1.5.5.1.1.1.3" xref="alg2.l12.m1.5.5.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.5b"><apply id="alg2.l12.m1.5.5.cmml" xref="alg2.l12.m1.5.5"><eq id="alg2.l12.m1.5.5.2.cmml" xref="alg2.l12.m1.5.5.2"></eq><apply id="alg2.l12.m1.5.5.3.cmml" xref="alg2.l12.m1.5.5.3"><csymbol cd="ambiguous" id="alg2.l12.m1.5.5.3.1.cmml" xref="alg2.l12.m1.5.5.3">superscript</csymbol><ci id="alg2.l12.m1.5.5.3.2.cmml" xref="alg2.l12.m1.5.5.3.2">𝑡</ci><apply id="alg2.l12.m1.5.5.3.3.cmml" xref="alg2.l12.m1.5.5.3.3"><ci id="alg2.l12.m1.5.5.3.3.1.cmml" xref="alg2.l12.m1.5.5.3.3.1">′</ci></apply></apply><list id="alg2.l12.m1.5.5.1.2.cmml" xref="alg2.l12.m1.5.5.1.1"><cn type="integer" id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">0</cn><cn type="integer" id="alg2.l12.m1.2.2.cmml" xref="alg2.l12.m1.2.2">1</cn><cn type="integer" id="alg2.l12.m1.3.3.cmml" xref="alg2.l12.m1.3.3">2</cn><ci id="alg2.l12.m1.4.4.cmml" xref="alg2.l12.m1.4.4">…</ci><apply id="alg2.l12.m1.5.5.1.1.1.cmml" xref="alg2.l12.m1.5.5.1.1.1"><minus id="alg2.l12.m1.5.5.1.1.1.1.cmml" xref="alg2.l12.m1.5.5.1.1.1.1"></minus><apply id="alg2.l12.m1.5.5.1.1.1.2.cmml" xref="alg2.l12.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l12.m1.5.5.1.1.1.2.1.cmml" xref="alg2.l12.m1.5.5.1.1.1.2">superscript</csymbol><ci id="alg2.l12.m1.5.5.1.1.1.2.2.cmml" xref="alg2.l12.m1.5.5.1.1.1.2.2">𝑇</ci><apply id="alg2.l12.m1.5.5.1.1.1.2.3.cmml" xref="alg2.l12.m1.5.5.1.1.1.2.3"><ci id="alg2.l12.m1.5.5.1.1.1.2.3.1.cmml" xref="alg2.l12.m1.5.5.1.1.1.2.3.1">′</ci></apply></apply><cn type="integer" id="alg2.l12.m1.5.5.1.1.1.3.cmml" xref="alg2.l12.m1.5.5.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.5c">t^{{}^{\prime}}=0,1,2,...,T^{{}^{\prime}}-1</annotation></semantics></math> <span id="alg2.l12.3" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>   <math id="alg2.l13.m1.2" class="ltx_Math" alttext="\tilde{W}^{t^{{}^{\prime}}+1}\leftarrow\tilde{W}^{t^{{}^{\prime}}}-\lambda\eta\nabla_{\tilde{W}^{t^{{}^{\prime}}}}\operatorname{reg}_{\mathrm{fc}}\left(\tilde{W}^{t^{{}^{\prime}}}\right)" display="inline"><semantics id="alg2.l13.m1.2a"><mrow id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2.cmml"><msup id="alg2.l13.m1.2.2.4" xref="alg2.l13.m1.2.2.4.cmml"><mover accent="true" id="alg2.l13.m1.2.2.4.2" xref="alg2.l13.m1.2.2.4.2.cmml"><mi id="alg2.l13.m1.2.2.4.2.2" xref="alg2.l13.m1.2.2.4.2.2.cmml">W</mi><mo id="alg2.l13.m1.2.2.4.2.1" xref="alg2.l13.m1.2.2.4.2.1.cmml">~</mo></mover><mrow id="alg2.l13.m1.2.2.4.3" xref="alg2.l13.m1.2.2.4.3.cmml"><msup id="alg2.l13.m1.2.2.4.3.2" xref="alg2.l13.m1.2.2.4.3.2.cmml"><mi id="alg2.l13.m1.2.2.4.3.2.2" xref="alg2.l13.m1.2.2.4.3.2.2.cmml">t</mi><msup id="alg2.l13.m1.2.2.4.3.2.3" xref="alg2.l13.m1.2.2.4.3.2.3.cmml"><mi id="alg2.l13.m1.2.2.4.3.2.3a" xref="alg2.l13.m1.2.2.4.3.2.3.cmml"></mi><mo id="alg2.l13.m1.2.2.4.3.2.3.1" xref="alg2.l13.m1.2.2.4.3.2.3.1.cmml">′</mo></msup></msup><mo id="alg2.l13.m1.2.2.4.3.1" xref="alg2.l13.m1.2.2.4.3.1.cmml">+</mo><mn id="alg2.l13.m1.2.2.4.3.3" xref="alg2.l13.m1.2.2.4.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="alg2.l13.m1.2.2.3" xref="alg2.l13.m1.2.2.3.cmml">←</mo><mrow id="alg2.l13.m1.2.2.2" xref="alg2.l13.m1.2.2.2.cmml"><msup id="alg2.l13.m1.2.2.2.4" xref="alg2.l13.m1.2.2.2.4.cmml"><mover accent="true" id="alg2.l13.m1.2.2.2.4.2" xref="alg2.l13.m1.2.2.2.4.2.cmml"><mi id="alg2.l13.m1.2.2.2.4.2.2" xref="alg2.l13.m1.2.2.2.4.2.2.cmml">W</mi><mo id="alg2.l13.m1.2.2.2.4.2.1" xref="alg2.l13.m1.2.2.2.4.2.1.cmml">~</mo></mover><msup id="alg2.l13.m1.2.2.2.4.3" xref="alg2.l13.m1.2.2.2.4.3.cmml"><mi id="alg2.l13.m1.2.2.2.4.3.2" xref="alg2.l13.m1.2.2.2.4.3.2.cmml">t</mi><msup id="alg2.l13.m1.2.2.2.4.3.3" xref="alg2.l13.m1.2.2.2.4.3.3.cmml"><mi id="alg2.l13.m1.2.2.2.4.3.3a" xref="alg2.l13.m1.2.2.2.4.3.3.cmml"></mi><mo id="alg2.l13.m1.2.2.2.4.3.3.1" xref="alg2.l13.m1.2.2.2.4.3.3.1.cmml">′</mo></msup></msup></msup><mo id="alg2.l13.m1.2.2.2.3" xref="alg2.l13.m1.2.2.2.3.cmml">−</mo><mrow id="alg2.l13.m1.2.2.2.2" xref="alg2.l13.m1.2.2.2.2.cmml"><mi id="alg2.l13.m1.2.2.2.2.4" xref="alg2.l13.m1.2.2.2.2.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="alg2.l13.m1.2.2.2.2.3" xref="alg2.l13.m1.2.2.2.2.3.cmml">​</mo><mi id="alg2.l13.m1.2.2.2.2.5" xref="alg2.l13.m1.2.2.2.2.5.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg2.l13.m1.2.2.2.2.3a" xref="alg2.l13.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l13.m1.2.2.2.2.2.2" xref="alg2.l13.m1.2.2.2.2.2.3.cmml"><mrow id="alg2.l13.m1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.cmml"><msub id="alg2.l13.m1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="alg2.l13.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.2.cmml">∇</mo><msup id="alg2.l13.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><msup id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><msup id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3a" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3.cmml"></mi><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml">′</mo></msup></msup></msup></msub><msub id="alg2.l13.m1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.2.2.cmml">reg</mi><mi id="alg2.l13.m1.1.1.1.1.1.1.1.2.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.2.3.cmml">fc</mi></msub></mrow><mo id="alg2.l13.m1.2.2.2.2.2.2a" xref="alg2.l13.m1.2.2.2.2.2.3.cmml">⁡</mo><mrow id="alg2.l13.m1.2.2.2.2.2.2.2" xref="alg2.l13.m1.2.2.2.2.2.3.cmml"><mo id="alg2.l13.m1.2.2.2.2.2.2.2.2" xref="alg2.l13.m1.2.2.2.2.2.3.cmml">(</mo><msup id="alg2.l13.m1.2.2.2.2.2.2.2.1" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.cmml"><mover accent="true" id="alg2.l13.m1.2.2.2.2.2.2.2.1.2" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.2.cmml"><mi id="alg2.l13.m1.2.2.2.2.2.2.2.1.2.2" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.2.2.cmml">W</mi><mo id="alg2.l13.m1.2.2.2.2.2.2.2.1.2.1" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.2.1.cmml">~</mo></mover><msup id="alg2.l13.m1.2.2.2.2.2.2.2.1.3" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3.cmml"><mi id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.2" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3.2.cmml">t</mi><msup id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3.cmml"><mi id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3a" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3.cmml"></mi><mo id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3.1" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3.1.cmml">′</mo></msup></msup></msup><mo id="alg2.l13.m1.2.2.2.2.2.2.2.3" xref="alg2.l13.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.2b"><apply id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2"><ci id="alg2.l13.m1.2.2.3.cmml" xref="alg2.l13.m1.2.2.3">←</ci><apply id="alg2.l13.m1.2.2.4.cmml" xref="alg2.l13.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.4.1.cmml" xref="alg2.l13.m1.2.2.4">superscript</csymbol><apply id="alg2.l13.m1.2.2.4.2.cmml" xref="alg2.l13.m1.2.2.4.2"><ci id="alg2.l13.m1.2.2.4.2.1.cmml" xref="alg2.l13.m1.2.2.4.2.1">~</ci><ci id="alg2.l13.m1.2.2.4.2.2.cmml" xref="alg2.l13.m1.2.2.4.2.2">𝑊</ci></apply><apply id="alg2.l13.m1.2.2.4.3.cmml" xref="alg2.l13.m1.2.2.4.3"><plus id="alg2.l13.m1.2.2.4.3.1.cmml" xref="alg2.l13.m1.2.2.4.3.1"></plus><apply id="alg2.l13.m1.2.2.4.3.2.cmml" xref="alg2.l13.m1.2.2.4.3.2"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.4.3.2.1.cmml" xref="alg2.l13.m1.2.2.4.3.2">superscript</csymbol><ci id="alg2.l13.m1.2.2.4.3.2.2.cmml" xref="alg2.l13.m1.2.2.4.3.2.2">𝑡</ci><apply id="alg2.l13.m1.2.2.4.3.2.3.cmml" xref="alg2.l13.m1.2.2.4.3.2.3"><ci id="alg2.l13.m1.2.2.4.3.2.3.1.cmml" xref="alg2.l13.m1.2.2.4.3.2.3.1">′</ci></apply></apply><cn type="integer" id="alg2.l13.m1.2.2.4.3.3.cmml" xref="alg2.l13.m1.2.2.4.3.3">1</cn></apply></apply><apply id="alg2.l13.m1.2.2.2.cmml" xref="alg2.l13.m1.2.2.2"><minus id="alg2.l13.m1.2.2.2.3.cmml" xref="alg2.l13.m1.2.2.2.3"></minus><apply id="alg2.l13.m1.2.2.2.4.cmml" xref="alg2.l13.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.2.4.1.cmml" xref="alg2.l13.m1.2.2.2.4">superscript</csymbol><apply id="alg2.l13.m1.2.2.2.4.2.cmml" xref="alg2.l13.m1.2.2.2.4.2"><ci id="alg2.l13.m1.2.2.2.4.2.1.cmml" xref="alg2.l13.m1.2.2.2.4.2.1">~</ci><ci id="alg2.l13.m1.2.2.2.4.2.2.cmml" xref="alg2.l13.m1.2.2.2.4.2.2">𝑊</ci></apply><apply id="alg2.l13.m1.2.2.2.4.3.cmml" xref="alg2.l13.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.2.4.3.1.cmml" xref="alg2.l13.m1.2.2.2.4.3">superscript</csymbol><ci id="alg2.l13.m1.2.2.2.4.3.2.cmml" xref="alg2.l13.m1.2.2.2.4.3.2">𝑡</ci><apply id="alg2.l13.m1.2.2.2.4.3.3.cmml" xref="alg2.l13.m1.2.2.2.4.3.3"><ci id="alg2.l13.m1.2.2.2.4.3.3.1.cmml" xref="alg2.l13.m1.2.2.2.4.3.3.1">′</ci></apply></apply></apply><apply id="alg2.l13.m1.2.2.2.2.cmml" xref="alg2.l13.m1.2.2.2.2"><times id="alg2.l13.m1.2.2.2.2.3.cmml" xref="alg2.l13.m1.2.2.2.2.3"></times><ci id="alg2.l13.m1.2.2.2.2.4.cmml" xref="alg2.l13.m1.2.2.2.2.4">𝜆</ci><ci id="alg2.l13.m1.2.2.2.2.5.cmml" xref="alg2.l13.m1.2.2.2.2.5">𝜂</ci><apply id="alg2.l13.m1.2.2.2.2.2.3.cmml" xref="alg2.l13.m1.2.2.2.2.2.2"><apply id="alg2.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1"><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.2">∇</ci><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2"><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.2.2">𝑊</ci></apply><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3"><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.3.3.3.1">′</ci></apply></apply></apply></apply><apply id="alg2.l13.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.2.2">reg</ci><ci id="alg2.l13.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.2.3">fc</ci></apply></apply><apply id="alg2.l13.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.2.2.2.2.2.1.1.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1">superscript</csymbol><apply id="alg2.l13.m1.2.2.2.2.2.2.2.1.2.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.2"><ci id="alg2.l13.m1.2.2.2.2.2.2.2.1.2.1.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.2.1">~</ci><ci id="alg2.l13.m1.2.2.2.2.2.2.2.1.2.2.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.2.2">𝑊</ci></apply><apply id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.1.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3">superscript</csymbol><ci id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.2.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3.2">𝑡</ci><apply id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3"><ci id="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3.1.cmml" xref="alg2.l13.m1.2.2.2.2.2.2.2.1.3.3.1">′</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.2c">\tilde{W}^{t^{{}^{\prime}}+1}\leftarrow\tilde{W}^{t^{{}^{\prime}}}-\lambda\eta\nabla_{\tilde{W}^{t^{{}^{\prime}}}}\operatorname{reg}_{\mathrm{fc}}\left(\tilde{W}^{t^{{}^{\prime}}}\right)</annotation></semantics></math>.

</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  <span id="alg2.l14.2" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>  The fixed class embedding matrix <math id="alg2.l15.m1.1" class="ltx_Math" alttext="W=\tilde{W}^{T^{{}^{\prime}}}" display="inline"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">W</mi><mo id="alg2.l15.m1.1.1.1" xref="alg2.l15.m1.1.1.1.cmml">=</mo><msup id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml"><mover accent="true" id="alg2.l15.m1.1.1.3.2" xref="alg2.l15.m1.1.1.3.2.cmml"><mi id="alg2.l15.m1.1.1.3.2.2" xref="alg2.l15.m1.1.1.3.2.2.cmml">W</mi><mo id="alg2.l15.m1.1.1.3.2.1" xref="alg2.l15.m1.1.1.3.2.1.cmml">~</mo></mover><msup id="alg2.l15.m1.1.1.3.3" xref="alg2.l15.m1.1.1.3.3.cmml"><mi id="alg2.l15.m1.1.1.3.3.2" xref="alg2.l15.m1.1.1.3.3.2.cmml">T</mi><msup id="alg2.l15.m1.1.1.3.3.3" xref="alg2.l15.m1.1.1.3.3.3.cmml"><mi id="alg2.l15.m1.1.1.3.3.3a" xref="alg2.l15.m1.1.1.3.3.3.cmml"></mi><mo id="alg2.l15.m1.1.1.3.3.3.1" xref="alg2.l15.m1.1.1.3.3.3.1.cmml">′</mo></msup></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><eq id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"></eq><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝑊</ci><apply id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.3">superscript</csymbol><apply id="alg2.l15.m1.1.1.3.2.cmml" xref="alg2.l15.m1.1.1.3.2"><ci id="alg2.l15.m1.1.1.3.2.1.cmml" xref="alg2.l15.m1.1.1.3.2.1">~</ci><ci id="alg2.l15.m1.1.1.3.2.2.cmml" xref="alg2.l15.m1.1.1.3.2.2">𝑊</ci></apply><apply id="alg2.l15.m1.1.1.3.3.cmml" xref="alg2.l15.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.3.1.cmml" xref="alg2.l15.m1.1.1.3.3">superscript</csymbol><ci id="alg2.l15.m1.1.1.3.3.2.cmml" xref="alg2.l15.m1.1.1.3.3.2">𝑇</ci><apply id="alg2.l15.m1.1.1.3.3.3.cmml" xref="alg2.l15.m1.1.1.3.3.3"><ci id="alg2.l15.m1.1.1.3.3.3.1.cmml" xref="alg2.l15.m1.1.1.3.3.3.1">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">W=\tilde{W}^{T^{{}^{\prime}}}</annotation></semantics></math>.

</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg2.l16.2" class="ltx_text ltx_font_bold">Federated learning process:</span>

</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>  <span id="alg2.l17.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l17.m1.5" class="ltx_Math" alttext="t=0,1,2,...,T-1" display="inline"><semantics id="alg2.l17.m1.5a"><mrow id="alg2.l17.m1.5.5" xref="alg2.l17.m1.5.5.cmml"><mi id="alg2.l17.m1.5.5.3" xref="alg2.l17.m1.5.5.3.cmml">t</mi><mo id="alg2.l17.m1.5.5.2" xref="alg2.l17.m1.5.5.2.cmml">=</mo><mrow id="alg2.l17.m1.5.5.1.1" xref="alg2.l17.m1.5.5.1.2.cmml"><mn id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml">0</mn><mo id="alg2.l17.m1.5.5.1.1.2" xref="alg2.l17.m1.5.5.1.2.cmml">,</mo><mn id="alg2.l17.m1.2.2" xref="alg2.l17.m1.2.2.cmml">1</mn><mo id="alg2.l17.m1.5.5.1.1.3" xref="alg2.l17.m1.5.5.1.2.cmml">,</mo><mn id="alg2.l17.m1.3.3" xref="alg2.l17.m1.3.3.cmml">2</mn><mo id="alg2.l17.m1.5.5.1.1.4" xref="alg2.l17.m1.5.5.1.2.cmml">,</mo><mi mathvariant="normal" id="alg2.l17.m1.4.4" xref="alg2.l17.m1.4.4.cmml">…</mi><mo id="alg2.l17.m1.5.5.1.1.5" xref="alg2.l17.m1.5.5.1.2.cmml">,</mo><mrow id="alg2.l17.m1.5.5.1.1.1" xref="alg2.l17.m1.5.5.1.1.1.cmml"><mi id="alg2.l17.m1.5.5.1.1.1.2" xref="alg2.l17.m1.5.5.1.1.1.2.cmml">T</mi><mo id="alg2.l17.m1.5.5.1.1.1.1" xref="alg2.l17.m1.5.5.1.1.1.1.cmml">−</mo><mn id="alg2.l17.m1.5.5.1.1.1.3" xref="alg2.l17.m1.5.5.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.5b"><apply id="alg2.l17.m1.5.5.cmml" xref="alg2.l17.m1.5.5"><eq id="alg2.l17.m1.5.5.2.cmml" xref="alg2.l17.m1.5.5.2"></eq><ci id="alg2.l17.m1.5.5.3.cmml" xref="alg2.l17.m1.5.5.3">𝑡</ci><list id="alg2.l17.m1.5.5.1.2.cmml" xref="alg2.l17.m1.5.5.1.1"><cn type="integer" id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1">0</cn><cn type="integer" id="alg2.l17.m1.2.2.cmml" xref="alg2.l17.m1.2.2">1</cn><cn type="integer" id="alg2.l17.m1.3.3.cmml" xref="alg2.l17.m1.3.3">2</cn><ci id="alg2.l17.m1.4.4.cmml" xref="alg2.l17.m1.4.4">…</ci><apply id="alg2.l17.m1.5.5.1.1.1.cmml" xref="alg2.l17.m1.5.5.1.1.1"><minus id="alg2.l17.m1.5.5.1.1.1.1.cmml" xref="alg2.l17.m1.5.5.1.1.1.1"></minus><ci id="alg2.l17.m1.5.5.1.1.1.2.cmml" xref="alg2.l17.m1.5.5.1.1.1.2">𝑇</ci><cn type="integer" id="alg2.l17.m1.5.5.1.1.1.3.cmml" xref="alg2.l17.m1.5.5.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.5c">t=0,1,2,...,T-1</annotation></semantics></math> <span id="alg2.l17.3" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>   Server sends <math id="alg2.l18.m1.1" class="ltx_Math" alttext="\theta^{t}" display="inline"><semantics id="alg2.l18.m1.1a"><msup id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><mi id="alg2.l18.m1.1.1.2" xref="alg2.l18.m1.1.1.2.cmml">θ</mi><mi id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1">superscript</csymbol><ci id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2">𝜃</ci><ci id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">\theta^{t}</annotation></semantics></math>, <math id="alg2.l18.m2.1" class="ltx_Math" alttext="W^{t}" display="inline"><semantics id="alg2.l18.m2.1a"><msup id="alg2.l18.m2.1.1" xref="alg2.l18.m2.1.1.cmml"><mi id="alg2.l18.m2.1.1.2" xref="alg2.l18.m2.1.1.2.cmml">W</mi><mi id="alg2.l18.m2.1.1.3" xref="alg2.l18.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l18.m2.1b"><apply id="alg2.l18.m2.1.1.cmml" xref="alg2.l18.m2.1.1"><csymbol cd="ambiguous" id="alg2.l18.m2.1.1.1.cmml" xref="alg2.l18.m2.1.1">superscript</csymbol><ci id="alg2.l18.m2.1.1.2.cmml" xref="alg2.l18.m2.1.1.2">𝑊</ci><ci id="alg2.l18.m2.1.1.3.cmml" xref="alg2.l18.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m2.1c">W^{t}</annotation></semantics></math> to the <math id="alg2.l18.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l18.m3.1a"><mi id="alg2.l18.m3.1.1" xref="alg2.l18.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l18.m3.1b"><ci id="alg2.l18.m3.1.1.cmml" xref="alg2.l18.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m3.1c">i</annotation></semantics></math>-th client

</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>   <span id="alg2.l19.2" class="ltx_text ltx_font_bold">for</span> i=1,2,…,C <span id="alg2.l19.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>    <math id="alg2.l20.m1.1" class="ltx_Math" alttext="\theta^{t+1}_{i}\leftarrow\theta^{t}_{i}-\eta\nabla_{\theta^{t}}\hat{\mathcal{R}}_{\text{pos }}\left(\mathcal{S}^{i}\right)" display="inline"><semantics id="alg2.l20.m1.1a"><mrow id="alg2.l20.m1.1.1" xref="alg2.l20.m1.1.1.cmml"><msubsup id="alg2.l20.m1.1.1.3" xref="alg2.l20.m1.1.1.3.cmml"><mi id="alg2.l20.m1.1.1.3.2.2" xref="alg2.l20.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l20.m1.1.1.3.3" xref="alg2.l20.m1.1.1.3.3.cmml">i</mi><mrow id="alg2.l20.m1.1.1.3.2.3" xref="alg2.l20.m1.1.1.3.2.3.cmml"><mi id="alg2.l20.m1.1.1.3.2.3.2" xref="alg2.l20.m1.1.1.3.2.3.2.cmml">t</mi><mo id="alg2.l20.m1.1.1.3.2.3.1" xref="alg2.l20.m1.1.1.3.2.3.1.cmml">+</mo><mn id="alg2.l20.m1.1.1.3.2.3.3" xref="alg2.l20.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg2.l20.m1.1.1.2" xref="alg2.l20.m1.1.1.2.cmml">←</mo><mrow id="alg2.l20.m1.1.1.1" xref="alg2.l20.m1.1.1.1.cmml"><msubsup id="alg2.l20.m1.1.1.1.3" xref="alg2.l20.m1.1.1.1.3.cmml"><mi id="alg2.l20.m1.1.1.1.3.2.2" xref="alg2.l20.m1.1.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l20.m1.1.1.1.3.3" xref="alg2.l20.m1.1.1.1.3.3.cmml">i</mi><mi id="alg2.l20.m1.1.1.1.3.2.3" xref="alg2.l20.m1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="alg2.l20.m1.1.1.1.2" xref="alg2.l20.m1.1.1.1.2.cmml">−</mo><mrow id="alg2.l20.m1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.cmml"><mi id="alg2.l20.m1.1.1.1.1.3" xref="alg2.l20.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg2.l20.m1.1.1.1.1.2" xref="alg2.l20.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l20.m1.1.1.1.1.4" xref="alg2.l20.m1.1.1.1.1.4.cmml"><msub id="alg2.l20.m1.1.1.1.1.4.1" xref="alg2.l20.m1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="alg2.l20.m1.1.1.1.1.4.1.2" xref="alg2.l20.m1.1.1.1.1.4.1.2.cmml">∇</mo><msup id="alg2.l20.m1.1.1.1.1.4.1.3" xref="alg2.l20.m1.1.1.1.1.4.1.3.cmml"><mi id="alg2.l20.m1.1.1.1.1.4.1.3.2" xref="alg2.l20.m1.1.1.1.1.4.1.3.2.cmml">θ</mi><mi id="alg2.l20.m1.1.1.1.1.4.1.3.3" xref="alg2.l20.m1.1.1.1.1.4.1.3.3.cmml">t</mi></msup></msub><msub id="alg2.l20.m1.1.1.1.1.4.2" xref="alg2.l20.m1.1.1.1.1.4.2.cmml"><mover accent="true" id="alg2.l20.m1.1.1.1.1.4.2.2" xref="alg2.l20.m1.1.1.1.1.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l20.m1.1.1.1.1.4.2.2.2" xref="alg2.l20.m1.1.1.1.1.4.2.2.2.cmml">ℛ</mi><mo id="alg2.l20.m1.1.1.1.1.4.2.2.1" xref="alg2.l20.m1.1.1.1.1.4.2.2.1.cmml">^</mo></mover><mtext id="alg2.l20.m1.1.1.1.1.4.2.3" xref="alg2.l20.m1.1.1.1.1.4.2.3a.cmml">pos </mtext></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l20.m1.1.1.1.1.2a" xref="alg2.l20.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l20.m1.1.1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l20.m1.1.1.1.1.1.1.2" xref="alg2.l20.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="alg2.l20.m1.1.1.1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l20.m1.1.1.1.1.1.1.1.2" xref="alg2.l20.m1.1.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="alg2.l20.m1.1.1.1.1.1.1.1.3" xref="alg2.l20.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="alg2.l20.m1.1.1.1.1.1.1.3" xref="alg2.l20.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l20.m1.1b"><apply id="alg2.l20.m1.1.1.cmml" xref="alg2.l20.m1.1.1"><ci id="alg2.l20.m1.1.1.2.cmml" xref="alg2.l20.m1.1.1.2">←</ci><apply id="alg2.l20.m1.1.1.3.cmml" xref="alg2.l20.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.3.1.cmml" xref="alg2.l20.m1.1.1.3">subscript</csymbol><apply id="alg2.l20.m1.1.1.3.2.cmml" xref="alg2.l20.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.3.2.1.cmml" xref="alg2.l20.m1.1.1.3">superscript</csymbol><ci id="alg2.l20.m1.1.1.3.2.2.cmml" xref="alg2.l20.m1.1.1.3.2.2">𝜃</ci><apply id="alg2.l20.m1.1.1.3.2.3.cmml" xref="alg2.l20.m1.1.1.3.2.3"><plus id="alg2.l20.m1.1.1.3.2.3.1.cmml" xref="alg2.l20.m1.1.1.3.2.3.1"></plus><ci id="alg2.l20.m1.1.1.3.2.3.2.cmml" xref="alg2.l20.m1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="alg2.l20.m1.1.1.3.2.3.3.cmml" xref="alg2.l20.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="alg2.l20.m1.1.1.3.3.cmml" xref="alg2.l20.m1.1.1.3.3">𝑖</ci></apply><apply id="alg2.l20.m1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1"><minus id="alg2.l20.m1.1.1.1.2.cmml" xref="alg2.l20.m1.1.1.1.2"></minus><apply id="alg2.l20.m1.1.1.1.3.cmml" xref="alg2.l20.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.3.1.cmml" xref="alg2.l20.m1.1.1.1.3">subscript</csymbol><apply id="alg2.l20.m1.1.1.1.3.2.cmml" xref="alg2.l20.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.3.2.1.cmml" xref="alg2.l20.m1.1.1.1.3">superscript</csymbol><ci id="alg2.l20.m1.1.1.1.3.2.2.cmml" xref="alg2.l20.m1.1.1.1.3.2.2">𝜃</ci><ci id="alg2.l20.m1.1.1.1.3.2.3.cmml" xref="alg2.l20.m1.1.1.1.3.2.3">𝑡</ci></apply><ci id="alg2.l20.m1.1.1.1.3.3.cmml" xref="alg2.l20.m1.1.1.1.3.3">𝑖</ci></apply><apply id="alg2.l20.m1.1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1.1"><times id="alg2.l20.m1.1.1.1.1.2.cmml" xref="alg2.l20.m1.1.1.1.1.2"></times><ci id="alg2.l20.m1.1.1.1.1.3.cmml" xref="alg2.l20.m1.1.1.1.1.3">𝜂</ci><apply id="alg2.l20.m1.1.1.1.1.4.cmml" xref="alg2.l20.m1.1.1.1.1.4"><apply id="alg2.l20.m1.1.1.1.1.4.1.cmml" xref="alg2.l20.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.1.4.1.1.cmml" xref="alg2.l20.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg2.l20.m1.1.1.1.1.4.1.2.cmml" xref="alg2.l20.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg2.l20.m1.1.1.1.1.4.1.3.cmml" xref="alg2.l20.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.1.4.1.3.1.cmml" xref="alg2.l20.m1.1.1.1.1.4.1.3">superscript</csymbol><ci id="alg2.l20.m1.1.1.1.1.4.1.3.2.cmml" xref="alg2.l20.m1.1.1.1.1.4.1.3.2">𝜃</ci><ci id="alg2.l20.m1.1.1.1.1.4.1.3.3.cmml" xref="alg2.l20.m1.1.1.1.1.4.1.3.3">𝑡</ci></apply></apply><apply id="alg2.l20.m1.1.1.1.1.4.2.cmml" xref="alg2.l20.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.1.4.2.1.cmml" xref="alg2.l20.m1.1.1.1.1.4.2">subscript</csymbol><apply id="alg2.l20.m1.1.1.1.1.4.2.2.cmml" xref="alg2.l20.m1.1.1.1.1.4.2.2"><ci id="alg2.l20.m1.1.1.1.1.4.2.2.1.cmml" xref="alg2.l20.m1.1.1.1.1.4.2.2.1">^</ci><ci id="alg2.l20.m1.1.1.1.1.4.2.2.2.cmml" xref="alg2.l20.m1.1.1.1.1.4.2.2.2">ℛ</ci></apply><ci id="alg2.l20.m1.1.1.1.1.4.2.3a.cmml" xref="alg2.l20.m1.1.1.1.1.4.2.3"><mtext mathsize="70%" id="alg2.l20.m1.1.1.1.1.4.2.3.cmml" xref="alg2.l20.m1.1.1.1.1.4.2.3">pos </mtext></ci></apply></apply><apply id="alg2.l20.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l20.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l20.m1.1.1.1.1.1.1.1.2">𝒮</ci><ci id="alg2.l20.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l20.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m1.1c">\theta^{t+1}_{i}\leftarrow\theta^{t}_{i}-\eta\nabla_{\theta^{t}}\hat{\mathcal{R}}_{\text{pos }}\left(\mathcal{S}^{i}\right)</annotation></semantics></math>

</div>
<div id="alg2.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>    <math id="alg2.l21.m1.3" class="ltx_Math" alttext="\text{where }\hat{\mathcal{R}}_{\text{pos }}\left(\mathcal{S}^{i}\right)=\frac{1}{n_{i}}\sum_{j\in\left[n_{i}\right]}\ell_{\mathrm{cl}}^{\mathrm{pos}}(\mathbf{x}^{i}_{j},W)." display="inline"><semantics id="alg2.l21.m1.3a"><mrow id="alg2.l21.m1.3.3.1" xref="alg2.l21.m1.3.3.1.1.cmml"><mrow id="alg2.l21.m1.3.3.1.1" xref="alg2.l21.m1.3.3.1.1.cmml"><mrow id="alg2.l21.m1.3.3.1.1.1" xref="alg2.l21.m1.3.3.1.1.1.cmml"><mtext id="alg2.l21.m1.3.3.1.1.1.3" xref="alg2.l21.m1.3.3.1.1.1.3a.cmml">where </mtext><mo lspace="0em" rspace="0em" id="alg2.l21.m1.3.3.1.1.1.2" xref="alg2.l21.m1.3.3.1.1.1.2.cmml">​</mo><msub id="alg2.l21.m1.3.3.1.1.1.4" xref="alg2.l21.m1.3.3.1.1.1.4.cmml"><mover accent="true" id="alg2.l21.m1.3.3.1.1.1.4.2" xref="alg2.l21.m1.3.3.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l21.m1.3.3.1.1.1.4.2.2" xref="alg2.l21.m1.3.3.1.1.1.4.2.2.cmml">ℛ</mi><mo id="alg2.l21.m1.3.3.1.1.1.4.2.1" xref="alg2.l21.m1.3.3.1.1.1.4.2.1.cmml">^</mo></mover><mtext id="alg2.l21.m1.3.3.1.1.1.4.3" xref="alg2.l21.m1.3.3.1.1.1.4.3a.cmml">pos </mtext></msub><mo lspace="0em" rspace="0em" id="alg2.l21.m1.3.3.1.1.1.2a" xref="alg2.l21.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="alg2.l21.m1.3.3.1.1.1.1.1" xref="alg2.l21.m1.3.3.1.1.1.1.1.1.cmml"><mo id="alg2.l21.m1.3.3.1.1.1.1.1.2" xref="alg2.l21.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="alg2.l21.m1.3.3.1.1.1.1.1.1" xref="alg2.l21.m1.3.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l21.m1.3.3.1.1.1.1.1.1.2" xref="alg2.l21.m1.3.3.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="alg2.l21.m1.3.3.1.1.1.1.1.1.3" xref="alg2.l21.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="alg2.l21.m1.3.3.1.1.1.1.1.3" xref="alg2.l21.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l21.m1.3.3.1.1.3" xref="alg2.l21.m1.3.3.1.1.3.cmml">=</mo><mrow id="alg2.l21.m1.3.3.1.1.2" xref="alg2.l21.m1.3.3.1.1.2.cmml"><mfrac id="alg2.l21.m1.3.3.1.1.2.3" xref="alg2.l21.m1.3.3.1.1.2.3.cmml"><mn id="alg2.l21.m1.3.3.1.1.2.3.2" xref="alg2.l21.m1.3.3.1.1.2.3.2.cmml">1</mn><msub id="alg2.l21.m1.3.3.1.1.2.3.3" xref="alg2.l21.m1.3.3.1.1.2.3.3.cmml"><mi id="alg2.l21.m1.3.3.1.1.2.3.3.2" xref="alg2.l21.m1.3.3.1.1.2.3.3.2.cmml">n</mi><mi id="alg2.l21.m1.3.3.1.1.2.3.3.3" xref="alg2.l21.m1.3.3.1.1.2.3.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="alg2.l21.m1.3.3.1.1.2.2" xref="alg2.l21.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="alg2.l21.m1.3.3.1.1.2.1" xref="alg2.l21.m1.3.3.1.1.2.1.cmml"><msub id="alg2.l21.m1.3.3.1.1.2.1.2" xref="alg2.l21.m1.3.3.1.1.2.1.2.cmml"><mo id="alg2.l21.m1.3.3.1.1.2.1.2.2" xref="alg2.l21.m1.3.3.1.1.2.1.2.2.cmml">∑</mo><mrow id="alg2.l21.m1.1.1.1" xref="alg2.l21.m1.1.1.1.cmml"><mi id="alg2.l21.m1.1.1.1.3" xref="alg2.l21.m1.1.1.1.3.cmml">j</mi><mo id="alg2.l21.m1.1.1.1.2" xref="alg2.l21.m1.1.1.1.2.cmml">∈</mo><mrow id="alg2.l21.m1.1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.2.cmml"><mo id="alg2.l21.m1.1.1.1.1.1.2" xref="alg2.l21.m1.1.1.1.1.2.1.cmml">[</mo><msub id="alg2.l21.m1.1.1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l21.m1.1.1.1.1.1.1.2" xref="alg2.l21.m1.1.1.1.1.1.1.2.cmml">n</mi><mi id="alg2.l21.m1.1.1.1.1.1.1.3" xref="alg2.l21.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l21.m1.1.1.1.1.1.3" xref="alg2.l21.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></msub><mrow id="alg2.l21.m1.3.3.1.1.2.1.1" xref="alg2.l21.m1.3.3.1.1.2.1.1.cmml"><msubsup id="alg2.l21.m1.3.3.1.1.2.1.1.3" xref="alg2.l21.m1.3.3.1.1.2.1.1.3.cmml"><mi mathvariant="normal" id="alg2.l21.m1.3.3.1.1.2.1.1.3.2.2" xref="alg2.l21.m1.3.3.1.1.2.1.1.3.2.2.cmml">ℓ</mi><mi id="alg2.l21.m1.3.3.1.1.2.1.1.3.2.3" xref="alg2.l21.m1.3.3.1.1.2.1.1.3.2.3.cmml">cl</mi><mi id="alg2.l21.m1.3.3.1.1.2.1.1.3.3" xref="alg2.l21.m1.3.3.1.1.2.1.1.3.3.cmml">pos</mi></msubsup><mo lspace="0em" rspace="0em" id="alg2.l21.m1.3.3.1.1.2.1.1.2" xref="alg2.l21.m1.3.3.1.1.2.1.1.2.cmml">​</mo><mrow id="alg2.l21.m1.3.3.1.1.2.1.1.1.1" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.2" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.2.cmml">(</mo><msubsup id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.2" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.3" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">j</mi><mi id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.3" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.3" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.2.cmml">,</mo><mi id="alg2.l21.m1.2.2" xref="alg2.l21.m1.2.2.cmml">W</mi><mo stretchy="false" id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.4" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="alg2.l21.m1.3.3.1.2" xref="alg2.l21.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.3b"><apply id="alg2.l21.m1.3.3.1.1.cmml" xref="alg2.l21.m1.3.3.1"><eq id="alg2.l21.m1.3.3.1.1.3.cmml" xref="alg2.l21.m1.3.3.1.1.3"></eq><apply id="alg2.l21.m1.3.3.1.1.1.cmml" xref="alg2.l21.m1.3.3.1.1.1"><times id="alg2.l21.m1.3.3.1.1.1.2.cmml" xref="alg2.l21.m1.3.3.1.1.1.2"></times><ci id="alg2.l21.m1.3.3.1.1.1.3a.cmml" xref="alg2.l21.m1.3.3.1.1.1.3"><mtext id="alg2.l21.m1.3.3.1.1.1.3.cmml" xref="alg2.l21.m1.3.3.1.1.1.3">where </mtext></ci><apply id="alg2.l21.m1.3.3.1.1.1.4.cmml" xref="alg2.l21.m1.3.3.1.1.1.4"><csymbol cd="ambiguous" id="alg2.l21.m1.3.3.1.1.1.4.1.cmml" xref="alg2.l21.m1.3.3.1.1.1.4">subscript</csymbol><apply id="alg2.l21.m1.3.3.1.1.1.4.2.cmml" xref="alg2.l21.m1.3.3.1.1.1.4.2"><ci id="alg2.l21.m1.3.3.1.1.1.4.2.1.cmml" xref="alg2.l21.m1.3.3.1.1.1.4.2.1">^</ci><ci id="alg2.l21.m1.3.3.1.1.1.4.2.2.cmml" xref="alg2.l21.m1.3.3.1.1.1.4.2.2">ℛ</ci></apply><ci id="alg2.l21.m1.3.3.1.1.1.4.3a.cmml" xref="alg2.l21.m1.3.3.1.1.1.4.3"><mtext mathsize="70%" id="alg2.l21.m1.3.3.1.1.1.4.3.cmml" xref="alg2.l21.m1.3.3.1.1.1.4.3">pos </mtext></ci></apply><apply id="alg2.l21.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l21.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="alg2.l21.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg2.l21.m1.3.3.1.1.1.1.1.1.2">𝒮</ci><ci id="alg2.l21.m1.3.3.1.1.1.1.1.1.3.cmml" xref="alg2.l21.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg2.l21.m1.3.3.1.1.2.cmml" xref="alg2.l21.m1.3.3.1.1.2"><times id="alg2.l21.m1.3.3.1.1.2.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.2"></times><apply id="alg2.l21.m1.3.3.1.1.2.3.cmml" xref="alg2.l21.m1.3.3.1.1.2.3"><divide id="alg2.l21.m1.3.3.1.1.2.3.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.3"></divide><cn type="integer" id="alg2.l21.m1.3.3.1.1.2.3.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.3.2">1</cn><apply id="alg2.l21.m1.3.3.1.1.2.3.3.cmml" xref="alg2.l21.m1.3.3.1.1.2.3.3"><csymbol cd="ambiguous" id="alg2.l21.m1.3.3.1.1.2.3.3.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.3.3">subscript</csymbol><ci id="alg2.l21.m1.3.3.1.1.2.3.3.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.3.3.2">𝑛</ci><ci id="alg2.l21.m1.3.3.1.1.2.3.3.3.cmml" xref="alg2.l21.m1.3.3.1.1.2.3.3.3">𝑖</ci></apply></apply><apply id="alg2.l21.m1.3.3.1.1.2.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.1"><apply id="alg2.l21.m1.3.3.1.1.2.1.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.2"><csymbol cd="ambiguous" id="alg2.l21.m1.3.3.1.1.2.1.2.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.2">subscript</csymbol><sum id="alg2.l21.m1.3.3.1.1.2.1.2.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.2.2"></sum><apply id="alg2.l21.m1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1"><in id="alg2.l21.m1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.2"></in><ci id="alg2.l21.m1.1.1.1.3.cmml" xref="alg2.l21.m1.1.1.1.3">𝑗</ci><apply id="alg2.l21.m1.1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l21.m1.1.1.1.1.2.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.l21.m1.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l21.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.1.1.1.2">𝑛</ci><ci id="alg2.l21.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l21.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="alg2.l21.m1.3.3.1.1.2.1.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1"><times id="alg2.l21.m1.3.3.1.1.2.1.1.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.2"></times><apply id="alg2.l21.m1.3.3.1.1.2.1.1.3.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.3.3.1.1.2.1.1.3.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.3">superscript</csymbol><apply id="alg2.l21.m1.3.3.1.1.2.1.1.3.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.3.3.1.1.2.1.1.3.2.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.3">subscript</csymbol><ci id="alg2.l21.m1.3.3.1.1.2.1.1.3.2.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.3.2.2">ℓ</ci><ci id="alg2.l21.m1.3.3.1.1.2.1.1.3.2.3.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.3.2.3">cl</ci></apply><ci id="alg2.l21.m1.3.3.1.1.2.1.1.3.3.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.3.3">pos</ci></apply><interval closure="open" id="alg2.l21.m1.3.3.1.1.2.1.1.1.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1"><apply id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1">subscript</csymbol><apply id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.1.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1">superscript</csymbol><ci id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.2.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.2">𝐱</ci><ci id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.3.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="alg2.l21.m1.3.3.1.1.2.1.1.1.1.1.3">𝑗</ci></apply><ci id="alg2.l21.m1.2.2.cmml" xref="alg2.l21.m1.2.2">𝑊</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.3c">\text{where }\hat{\mathcal{R}}_{\text{pos }}\left(\mathcal{S}^{i}\right)=\frac{1}{n_{i}}\sum_{j\in\left[n_{i}\right]}\ell_{\mathrm{cl}}^{\mathrm{pos}}(\mathbf{x}^{i}_{j},W).</annotation></semantics></math>

</div>
<div id="alg2.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>    The <math id="alg2.l22.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l22.m1.1a"><mi id="alg2.l22.m1.1.1" xref="alg2.l22.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l22.m1.1b"><ci id="alg2.l22.m1.1.1.cmml" xref="alg2.l22.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.m1.1c">i</annotation></semantics></math>-th client sends <math id="alg2.l22.m2.1" class="ltx_Math" alttext="\theta^{t}_{i}" display="inline"><semantics id="alg2.l22.m2.1a"><msubsup id="alg2.l22.m2.1.1" xref="alg2.l22.m2.1.1.cmml"><mi id="alg2.l22.m2.1.1.2.2" xref="alg2.l22.m2.1.1.2.2.cmml">θ</mi><mi id="alg2.l22.m2.1.1.3" xref="alg2.l22.m2.1.1.3.cmml">i</mi><mi id="alg2.l22.m2.1.1.2.3" xref="alg2.l22.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l22.m2.1b"><apply id="alg2.l22.m2.1.1.cmml" xref="alg2.l22.m2.1.1"><csymbol cd="ambiguous" id="alg2.l22.m2.1.1.1.cmml" xref="alg2.l22.m2.1.1">subscript</csymbol><apply id="alg2.l22.m2.1.1.2.cmml" xref="alg2.l22.m2.1.1"><csymbol cd="ambiguous" id="alg2.l22.m2.1.1.2.1.cmml" xref="alg2.l22.m2.1.1">superscript</csymbol><ci id="alg2.l22.m2.1.1.2.2.cmml" xref="alg2.l22.m2.1.1.2.2">𝜃</ci><ci id="alg2.l22.m2.1.1.2.3.cmml" xref="alg2.l22.m2.1.1.2.3">𝑡</ci></apply><ci id="alg2.l22.m2.1.1.3.cmml" xref="alg2.l22.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.m2.1c">\theta^{t}_{i}</annotation></semantics></math> to the server.

</div>
<div id="alg2.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>   <span id="alg2.l23.2" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg2.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>   Server updates the model parameters by averaging : <math id="alg2.l24.m1.1" class="ltx_Math" alttext="\theta^{t+1}=\frac{1}{C}\sum\limits_{i\in[C]}\theta^{t}_{i}" display="inline"><semantics id="alg2.l24.m1.1a"><mrow id="alg2.l24.m1.1.2" xref="alg2.l24.m1.1.2.cmml"><msup id="alg2.l24.m1.1.2.2" xref="alg2.l24.m1.1.2.2.cmml"><mi id="alg2.l24.m1.1.2.2.2" xref="alg2.l24.m1.1.2.2.2.cmml">θ</mi><mrow id="alg2.l24.m1.1.2.2.3" xref="alg2.l24.m1.1.2.2.3.cmml"><mi id="alg2.l24.m1.1.2.2.3.2" xref="alg2.l24.m1.1.2.2.3.2.cmml">t</mi><mo id="alg2.l24.m1.1.2.2.3.1" xref="alg2.l24.m1.1.2.2.3.1.cmml">+</mo><mn id="alg2.l24.m1.1.2.2.3.3" xref="alg2.l24.m1.1.2.2.3.3.cmml">1</mn></mrow></msup><mo id="alg2.l24.m1.1.2.1" xref="alg2.l24.m1.1.2.1.cmml">=</mo><mrow id="alg2.l24.m1.1.2.3" xref="alg2.l24.m1.1.2.3.cmml"><mfrac id="alg2.l24.m1.1.2.3.2" xref="alg2.l24.m1.1.2.3.2.cmml"><mn id="alg2.l24.m1.1.2.3.2.2" xref="alg2.l24.m1.1.2.3.2.2.cmml">1</mn><mi id="alg2.l24.m1.1.2.3.2.3" xref="alg2.l24.m1.1.2.3.2.3.cmml">C</mi></mfrac><mo lspace="0em" rspace="0em" id="alg2.l24.m1.1.2.3.1" xref="alg2.l24.m1.1.2.3.1.cmml">​</mo><mrow id="alg2.l24.m1.1.2.3.3" xref="alg2.l24.m1.1.2.3.3.cmml"><munder id="alg2.l24.m1.1.2.3.3.1" xref="alg2.l24.m1.1.2.3.3.1.cmml"><mo movablelimits="false" id="alg2.l24.m1.1.2.3.3.1.2" xref="alg2.l24.m1.1.2.3.3.1.2.cmml">∑</mo><mrow id="alg2.l24.m1.1.1.1" xref="alg2.l24.m1.1.1.1.cmml"><mi id="alg2.l24.m1.1.1.1.3" xref="alg2.l24.m1.1.1.1.3.cmml">i</mi><mo id="alg2.l24.m1.1.1.1.2" xref="alg2.l24.m1.1.1.1.2.cmml">∈</mo><mrow id="alg2.l24.m1.1.1.1.4.2" xref="alg2.l24.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="alg2.l24.m1.1.1.1.4.2.1" xref="alg2.l24.m1.1.1.1.4.1.1.cmml">[</mo><mi id="alg2.l24.m1.1.1.1.1" xref="alg2.l24.m1.1.1.1.1.cmml">C</mi><mo stretchy="false" id="alg2.l24.m1.1.1.1.4.2.2" xref="alg2.l24.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder><msubsup id="alg2.l24.m1.1.2.3.3.2" xref="alg2.l24.m1.1.2.3.3.2.cmml"><mi id="alg2.l24.m1.1.2.3.3.2.2.2" xref="alg2.l24.m1.1.2.3.3.2.2.2.cmml">θ</mi><mi id="alg2.l24.m1.1.2.3.3.2.3" xref="alg2.l24.m1.1.2.3.3.2.3.cmml">i</mi><mi id="alg2.l24.m1.1.2.3.3.2.2.3" xref="alg2.l24.m1.1.2.3.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l24.m1.1b"><apply id="alg2.l24.m1.1.2.cmml" xref="alg2.l24.m1.1.2"><eq id="alg2.l24.m1.1.2.1.cmml" xref="alg2.l24.m1.1.2.1"></eq><apply id="alg2.l24.m1.1.2.2.cmml" xref="alg2.l24.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l24.m1.1.2.2.1.cmml" xref="alg2.l24.m1.1.2.2">superscript</csymbol><ci id="alg2.l24.m1.1.2.2.2.cmml" xref="alg2.l24.m1.1.2.2.2">𝜃</ci><apply id="alg2.l24.m1.1.2.2.3.cmml" xref="alg2.l24.m1.1.2.2.3"><plus id="alg2.l24.m1.1.2.2.3.1.cmml" xref="alg2.l24.m1.1.2.2.3.1"></plus><ci id="alg2.l24.m1.1.2.2.3.2.cmml" xref="alg2.l24.m1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg2.l24.m1.1.2.2.3.3.cmml" xref="alg2.l24.m1.1.2.2.3.3">1</cn></apply></apply><apply id="alg2.l24.m1.1.2.3.cmml" xref="alg2.l24.m1.1.2.3"><times id="alg2.l24.m1.1.2.3.1.cmml" xref="alg2.l24.m1.1.2.3.1"></times><apply id="alg2.l24.m1.1.2.3.2.cmml" xref="alg2.l24.m1.1.2.3.2"><divide id="alg2.l24.m1.1.2.3.2.1.cmml" xref="alg2.l24.m1.1.2.3.2"></divide><cn type="integer" id="alg2.l24.m1.1.2.3.2.2.cmml" xref="alg2.l24.m1.1.2.3.2.2">1</cn><ci id="alg2.l24.m1.1.2.3.2.3.cmml" xref="alg2.l24.m1.1.2.3.2.3">𝐶</ci></apply><apply id="alg2.l24.m1.1.2.3.3.cmml" xref="alg2.l24.m1.1.2.3.3"><apply id="alg2.l24.m1.1.2.3.3.1.cmml" xref="alg2.l24.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="alg2.l24.m1.1.2.3.3.1.1.cmml" xref="alg2.l24.m1.1.2.3.3.1">subscript</csymbol><sum id="alg2.l24.m1.1.2.3.3.1.2.cmml" xref="alg2.l24.m1.1.2.3.3.1.2"></sum><apply id="alg2.l24.m1.1.1.1.cmml" xref="alg2.l24.m1.1.1.1"><in id="alg2.l24.m1.1.1.1.2.cmml" xref="alg2.l24.m1.1.1.1.2"></in><ci id="alg2.l24.m1.1.1.1.3.cmml" xref="alg2.l24.m1.1.1.1.3">𝑖</ci><apply id="alg2.l24.m1.1.1.1.4.1.cmml" xref="alg2.l24.m1.1.1.1.4.2"><csymbol cd="latexml" id="alg2.l24.m1.1.1.1.4.1.1.cmml" xref="alg2.l24.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="alg2.l24.m1.1.1.1.1.cmml" xref="alg2.l24.m1.1.1.1.1">𝐶</ci></apply></apply></apply><apply id="alg2.l24.m1.1.2.3.3.2.cmml" xref="alg2.l24.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l24.m1.1.2.3.3.2.1.cmml" xref="alg2.l24.m1.1.2.3.3.2">subscript</csymbol><apply id="alg2.l24.m1.1.2.3.3.2.2.cmml" xref="alg2.l24.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l24.m1.1.2.3.3.2.2.1.cmml" xref="alg2.l24.m1.1.2.3.3.2">superscript</csymbol><ci id="alg2.l24.m1.1.2.3.3.2.2.2.cmml" xref="alg2.l24.m1.1.2.3.3.2.2.2">𝜃</ci><ci id="alg2.l24.m1.1.2.3.3.2.2.3.cmml" xref="alg2.l24.m1.1.2.3.3.2.2.3">𝑡</ci></apply><ci id="alg2.l24.m1.1.2.3.3.2.3.cmml" xref="alg2.l24.m1.1.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l24.m1.1c">\theta^{t+1}=\frac{1}{C}\sum\limits_{i\in[C]}\theta^{t}_{i}</annotation></semantics></math>.

</div>
<div id="alg2.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span>  <span id="alg2.l25.2" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg2.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span>  <span id="alg2.l26.2" class="ltx_text ltx_font_bold">Output:</span> <math id="alg2.l26.m1.2" class="ltx_Math" alttext="\theta^{\mathrm{opt}},W" display="inline"><semantics id="alg2.l26.m1.2a"><mrow id="alg2.l26.m1.2.2.1" xref="alg2.l26.m1.2.2.2.cmml"><msup id="alg2.l26.m1.2.2.1.1" xref="alg2.l26.m1.2.2.1.1.cmml"><mi id="alg2.l26.m1.2.2.1.1.2" xref="alg2.l26.m1.2.2.1.1.2.cmml">θ</mi><mi id="alg2.l26.m1.2.2.1.1.3" xref="alg2.l26.m1.2.2.1.1.3.cmml">opt</mi></msup><mo id="alg2.l26.m1.2.2.1.2" xref="alg2.l26.m1.2.2.2.cmml">,</mo><mi id="alg2.l26.m1.1.1" xref="alg2.l26.m1.1.1.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l26.m1.2b"><list id="alg2.l26.m1.2.2.2.cmml" xref="alg2.l26.m1.2.2.1"><apply id="alg2.l26.m1.2.2.1.1.cmml" xref="alg2.l26.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l26.m1.2.2.1.1.1.cmml" xref="alg2.l26.m1.2.2.1.1">superscript</csymbol><ci id="alg2.l26.m1.2.2.1.1.2.cmml" xref="alg2.l26.m1.2.2.1.1.2">𝜃</ci><ci id="alg2.l26.m1.2.2.1.1.3.cmml" xref="alg2.l26.m1.2.2.1.1.3">opt</ci></apply><ci id="alg2.l26.m1.1.1.cmml" xref="alg2.l26.m1.1.1">𝑊</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l26.m1.2c">\theta^{\mathrm{opt}},W</annotation></semantics></math>.

</div>
</div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.3" class="ltx_p">We empirically evaluate the proposed FedALC method on diverse multi-label datasets, including both the popular visual and some challenging textual datasets. We use cosine similarity to define the distance, i.e.,</p>
<table id="S5.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E13.m1.3" class="ltx_Math" alttext="{d}_{\cos}\left({x},{y}\right)=1-{x}^{\top}{y},\quad\forall{x},{y}\in\mathbb{R}^{d}." display="block"><semantics id="S5.E13.m1.3a"><mrow id="S5.E13.m1.3.3.1"><mrow id="S5.E13.m1.3.3.1.1.2" xref="S5.E13.m1.3.3.1.1.3.cmml"><mrow id="S5.E13.m1.3.3.1.1.1.1" xref="S5.E13.m1.3.3.1.1.1.1.cmml"><mrow id="S5.E13.m1.3.3.1.1.1.1.4" xref="S5.E13.m1.3.3.1.1.1.1.4.cmml"><msub id="S5.E13.m1.3.3.1.1.1.1.4.2" xref="S5.E13.m1.3.3.1.1.1.1.4.2.cmml"><mi id="S5.E13.m1.3.3.1.1.1.1.4.2.2" xref="S5.E13.m1.3.3.1.1.1.1.4.2.2.cmml">d</mi><mi id="S5.E13.m1.3.3.1.1.1.1.4.2.3" xref="S5.E13.m1.3.3.1.1.1.1.4.2.3.cmml">cos</mi></msub><mo lspace="0em" rspace="0em" id="S5.E13.m1.3.3.1.1.1.1.4.1" xref="S5.E13.m1.3.3.1.1.1.1.4.1.cmml">​</mo><mrow id="S5.E13.m1.3.3.1.1.1.1.4.3.2" xref="S5.E13.m1.3.3.1.1.1.1.4.3.1.cmml"><mo id="S5.E13.m1.3.3.1.1.1.1.4.3.2.1" xref="S5.E13.m1.3.3.1.1.1.1.4.3.1.cmml">(</mo><mi id="S5.E13.m1.1.1" xref="S5.E13.m1.1.1.cmml">x</mi><mo id="S5.E13.m1.3.3.1.1.1.1.4.3.2.2" xref="S5.E13.m1.3.3.1.1.1.1.4.3.1.cmml">,</mo><mi id="S5.E13.m1.2.2" xref="S5.E13.m1.2.2.cmml">y</mi><mo id="S5.E13.m1.3.3.1.1.1.1.4.3.2.3" xref="S5.E13.m1.3.3.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S5.E13.m1.3.3.1.1.1.1.3" xref="S5.E13.m1.3.3.1.1.1.1.3.cmml">=</mo><mrow id="S5.E13.m1.3.3.1.1.1.1.2.2" xref="S5.E13.m1.3.3.1.1.1.1.2.3.cmml"><mrow id="S5.E13.m1.3.3.1.1.1.1.1.1.1" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.cmml"><mn id="S5.E13.m1.3.3.1.1.1.1.1.1.1.2" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.E13.m1.3.3.1.1.1.1.1.1.1.1" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.cmml"><msup id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml">x</mi><mo id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">y</mi></mrow></mrow><mo rspace="1.167em" id="S5.E13.m1.3.3.1.1.1.1.2.2.3" xref="S5.E13.m1.3.3.1.1.1.1.2.3.cmml">,</mo><mrow id="S5.E13.m1.3.3.1.1.1.1.2.2.2" xref="S5.E13.m1.3.3.1.1.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S5.E13.m1.3.3.1.1.1.1.2.2.2.1" xref="S5.E13.m1.3.3.1.1.1.1.2.2.2.1.cmml">∀</mo><mi id="S5.E13.m1.3.3.1.1.1.1.2.2.2.2" xref="S5.E13.m1.3.3.1.1.1.1.2.2.2.2.cmml">x</mi></mrow></mrow></mrow><mo id="S5.E13.m1.3.3.1.1.2.3" xref="S5.E13.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S5.E13.m1.3.3.1.1.2.2" xref="S5.E13.m1.3.3.1.1.2.2.cmml"><mi id="S5.E13.m1.3.3.1.1.2.2.2" xref="S5.E13.m1.3.3.1.1.2.2.2.cmml">y</mi><mo id="S5.E13.m1.3.3.1.1.2.2.1" xref="S5.E13.m1.3.3.1.1.2.2.1.cmml">∈</mo><msup id="S5.E13.m1.3.3.1.1.2.2.3" xref="S5.E13.m1.3.3.1.1.2.2.3.cmml"><mi id="S5.E13.m1.3.3.1.1.2.2.3.2" xref="S5.E13.m1.3.3.1.1.2.2.3.2.cmml">ℝ</mi><mi id="S5.E13.m1.3.3.1.1.2.2.3.3" xref="S5.E13.m1.3.3.1.1.2.2.3.3.cmml">d</mi></msup></mrow></mrow><mo lspace="0em" id="S5.E13.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E13.m1.3b"><apply id="S5.E13.m1.3.3.1.1.3.cmml" xref="S5.E13.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S5.E13.m1.3.3.1.1.3a.cmml" xref="S5.E13.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S5.E13.m1.3.3.1.1.1.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1"><eq id="S5.E13.m1.3.3.1.1.1.1.3.cmml" xref="S5.E13.m1.3.3.1.1.1.1.3"></eq><apply id="S5.E13.m1.3.3.1.1.1.1.4.cmml" xref="S5.E13.m1.3.3.1.1.1.1.4"><times id="S5.E13.m1.3.3.1.1.1.1.4.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1.4.1"></times><apply id="S5.E13.m1.3.3.1.1.1.1.4.2.cmml" xref="S5.E13.m1.3.3.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S5.E13.m1.3.3.1.1.1.1.4.2.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1.4.2">subscript</csymbol><ci id="S5.E13.m1.3.3.1.1.1.1.4.2.2.cmml" xref="S5.E13.m1.3.3.1.1.1.1.4.2.2">𝑑</ci><cos id="S5.E13.m1.3.3.1.1.1.1.4.2.3.cmml" xref="S5.E13.m1.3.3.1.1.1.1.4.2.3"></cos></apply><interval closure="open" id="S5.E13.m1.3.3.1.1.1.1.4.3.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1.4.3.2"><ci id="S5.E13.m1.1.1.cmml" xref="S5.E13.m1.1.1">𝑥</ci><ci id="S5.E13.m1.2.2.cmml" xref="S5.E13.m1.2.2">𝑦</ci></interval></apply><list id="S5.E13.m1.3.3.1.1.1.1.2.3.cmml" xref="S5.E13.m1.3.3.1.1.1.1.2.2"><apply id="S5.E13.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1"><minus id="S5.E13.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S5.E13.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.2">1</cn><apply id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3"><times id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.1"></times><apply id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.2">𝑥</ci><csymbol cd="latexml" id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.2.3">top</csymbol></apply><ci id="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S5.E13.m1.3.3.1.1.1.1.1.1.1.3.3">𝑦</ci></apply></apply><apply id="S5.E13.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S5.E13.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S5.E13.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S5.E13.m1.3.3.1.1.1.1.2.2.2.1">for-all</csymbol><ci id="S5.E13.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S5.E13.m1.3.3.1.1.1.1.2.2.2.2">𝑥</ci></apply></list></apply><apply id="S5.E13.m1.3.3.1.1.2.2.cmml" xref="S5.E13.m1.3.3.1.1.2.2"><in id="S5.E13.m1.3.3.1.1.2.2.1.cmml" xref="S5.E13.m1.3.3.1.1.2.2.1"></in><ci id="S5.E13.m1.3.3.1.1.2.2.2.cmml" xref="S5.E13.m1.3.3.1.1.2.2.2">𝑦</ci><apply id="S5.E13.m1.3.3.1.1.2.2.3.cmml" xref="S5.E13.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S5.E13.m1.3.3.1.1.2.2.3.1.cmml" xref="S5.E13.m1.3.3.1.1.2.2.3">superscript</csymbol><ci id="S5.E13.m1.3.3.1.1.2.2.3.2.cmml" xref="S5.E13.m1.3.3.1.1.2.2.3.2">ℝ</ci><ci id="S5.E13.m1.3.3.1.1.2.2.3.3.cmml" xref="S5.E13.m1.3.3.1.1.2.2.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E13.m1.3c">{d}_{\cos}\left({x},{y}\right)=1-{x}^{\top}{y},\quad\forall{x},{y}\in\mathbb{R}^{d}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S5.p1.4" class="ltx_p">Given the specific distance function, the positive loss in the client can be given as follow:</p>
<table id="S5.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E14.m1.5" class="ltx_math_unparsed" alttext="\ell_{cl}^{\mathrm{pos}}(\mathbf{x},y)={\max}({0,0.9-g_{\theta}({\mathbf{x}})^{T}\mathbf{w}_{y}})^{2}." display="block"><semantics id="S5.E14.m1.5a"><mrow id="S5.E14.m1.5b"><msubsup id="S5.E14.m1.5.6"><mi mathvariant="normal" id="S5.E14.m1.5.6.2.2">ℓ</mi><mrow id="S5.E14.m1.5.6.2.3"><mi id="S5.E14.m1.5.6.2.3.2">c</mi><mo lspace="0em" rspace="0em" id="S5.E14.m1.5.6.2.3.1">​</mo><mi id="S5.E14.m1.5.6.2.3.3">l</mi></mrow><mi id="S5.E14.m1.5.6.3">pos</mi></msubsup><mrow id="S5.E14.m1.5.7"><mo stretchy="false" id="S5.E14.m1.5.7.1">(</mo><mi id="S5.E14.m1.1.1">𝐱</mi><mo id="S5.E14.m1.5.7.2">,</mo><mi id="S5.E14.m1.2.2">y</mi><mo stretchy="false" id="S5.E14.m1.5.7.3">)</mo></mrow><mo id="S5.E14.m1.5.8">=</mo><mi id="S5.E14.m1.4.4">max</mi><msup id="S5.E14.m1.5.9"><mrow id="S5.E14.m1.5.9.2"><mo stretchy="false" id="S5.E14.m1.5.9.2.1">(</mo><mn id="S5.E14.m1.5.5">0</mn><mo id="S5.E14.m1.5.9.2.2">,</mo><mn id="S5.E14.m1.5.9.2.3">0.9</mn><mo id="S5.E14.m1.5.9.2.4">−</mo><msub id="S5.E14.m1.5.9.2.5"><mi id="S5.E14.m1.5.9.2.5.2">g</mi><mi id="S5.E14.m1.5.9.2.5.3">θ</mi></msub><msup id="S5.E14.m1.5.9.2.6"><mrow id="S5.E14.m1.5.9.2.6.2"><mo stretchy="false" id="S5.E14.m1.5.9.2.6.2.1">(</mo><mi id="S5.E14.m1.3.3">𝐱</mi><mo stretchy="false" id="S5.E14.m1.5.9.2.6.2.2">)</mo></mrow><mi id="S5.E14.m1.5.9.2.6.3">T</mi></msup><msub id="S5.E14.m1.5.9.2.7"><mi id="S5.E14.m1.5.9.2.7.2">𝐰</mi><mi id="S5.E14.m1.5.9.2.7.3">y</mi></msub><mo stretchy="false" id="S5.E14.m1.5.9.2.8">)</mo></mrow><mn id="S5.E14.m1.5.9.3">2</mn></msup><mo lspace="0em" id="S5.E14.m1.5.10">.</mo></mrow><annotation encoding="application/x-tex" id="S5.E14.m1.5c">\ell_{cl}^{\mathrm{pos}}(\mathbf{x},y)={\max}({0,0.9-g_{\theta}({\mathbf{x}})^{T}\mathbf{w}_{y}})^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S5.p1.2" class="ltx_p">In our experiment, we follow the setting of positive loss in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> that encourages all pairs of positive instance and its label <math id="S5.p1.1.m1.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S5.p1.1.m1.2a"><mrow id="S5.p1.1.m1.2.3.2" xref="S5.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S5.p1.1.m1.2.3.2.1" xref="S5.p1.1.m1.2.3.1.cmml">(</mo><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">x</mi><mo id="S5.p1.1.m1.2.3.2.2" xref="S5.p1.1.m1.2.3.1.cmml">,</mo><mi id="S5.p1.1.m1.2.2" xref="S5.p1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S5.p1.1.m1.2.3.2.3" xref="S5.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.2b"><interval closure="open" id="S5.p1.1.m1.2.3.1.cmml" xref="S5.p1.1.m1.2.3.2"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝑥</ci><ci id="S5.p1.1.m1.2.2.cmml" xref="S5.p1.1.m1.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.2c">(x,y)</annotation></semantics></math> to have dot product larger than <math id="S5.p1.2.m2.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S5.p1.2.m2.1a"><mn id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><cn type="float" id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">0.9</annotation></semantics></math> in the embedding space.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>A summary of the datasets used in multi-label image classification experiments.</figcaption>
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S5.T1.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Dataset</span></th>
<th id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Labels</span></th>
<th id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Training images</span></th>
<th id="S5.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Validation images</span></th>
<th id="S5.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.1.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Test images</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.2.1" class="ltx_tr">
<th id="S5.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">COCO</th>
<td id="S5.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">80</td>
<td id="S5.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">73,873</td>
<td id="S5.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">8,208</td>
<td id="S5.T1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">4,0136</td>
</tr>
<tr id="S5.T1.1.3.2" class="ltx_tr">
<th id="S5.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">VOC12</th>
<td id="S5.T1.1.3.2.2" class="ltx_td ltx_align_center">20</td>
<td id="S5.T1.1.3.2.3" class="ltx_td ltx_align_center">10,963</td>
<td id="S5.T1.1.3.2.4" class="ltx_td ltx_align_center">577</td>
<td id="S5.T1.1.3.2.5" class="ltx_td ltx_align_center">5,823</td>
</tr>
<tr id="S5.T1.1.4.3" class="ltx_tr">
<th id="S5.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">VOC07</th>
<td id="S5.T1.1.4.3.2" class="ltx_td ltx_align_center">20</td>
<td id="S5.T1.1.4.3.3" class="ltx_td ltx_align_center">4,761</td>
<td id="S5.T1.1.4.3.4" class="ltx_td ltx_align_center">250</td>
<td id="S5.T1.1.4.3.5" class="ltx_td ltx_align_center">4,952</td>
</tr>
<tr id="S5.T1.1.5.4" class="ltx_tr">
<th id="S5.T1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">FLAIR</th>
<td id="S5.T1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_bb">1,628</td>
<td id="S5.T1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_bb">345,879</td>
<td id="S5.T1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_bb">39,239</td>
<td id="S5.T1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_bb">43,960</td>
</tr>
</tbody>
</table>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.4.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.5.2" class="ltx_text ltx_font_italic">Datasets</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.3" class="ltx_p">We use three benchmark datasets for multi-label image classiﬁcation, i.e., COCO<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>, VOC 2012<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, VOC 2007<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and FLAIR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite> dataset. A summary of three datasets is presented in Table <a href="#S5.T1" title="TABLE I ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.
The <span id="S5.SS1.p1.3.1" class="ltx_text ltx_font_bold">COCO</span> dataset contains a total number of 122,218 images associated with 80 labels. We use the original training set and randomly select <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">10</mn><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">10\%</annotation></semantics></math> for validation. The original validation set is used for testing. The VOC 2012 (<span id="S5.SS1.p1.3.2" class="ltx_text ltx_font_bold">VOC12</span>) dataset contains a total of 17,363 images associated with 20 labels. The original training set contains 11,540 images for training and validation, and we randomly select <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="5\%" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">5</mn><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">5\%</annotation></semantics></math> for validation and the rest for training. The original validation set containing 5,823 is used for testing. The VOC 2007 (<span id="S5.SS1.p1.3.3" class="ltx_text ltx_font_bold">VOC07</span>) dataset contains a total number of 9,963 images associated with 20 labels. The original training set contains 5,011 images for training and validation. Similar to VOC12, we randomly select <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="5\%" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mn id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">5</mn><mo id="S5.SS1.p1.3.m3.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">5\%</annotation></semantics></math> for validation and the rest for training. The original Validation set containing 4,952 is used for testing. The <span id="S5.SS1.p1.3.4" class="ltx_text ltx_font_bold">FLAIR</span> dataset contains a total of 429,078 images associated with 1,628 labels. The original training and validation set contain 385,118 images for training. The original test set containing 43,960 is used for testing. The original <span id="S5.SS1.p1.3.5" class="ltx_text ltx_font_bold">FLAIR</span> dataset access are available at https://github.com/apple/ml-flair in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Summary of the textual datasets: N and M are the numbers of training and test instances, respectively. F is the feature dimension, L is the number of class labels, I/L is the average number of instances per label, and L/I is the average number of labels per instance.</figcaption>
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<th id="S5.T2.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"></th>
<th id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;">N</th>
<th id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;">M</th>
<th id="S5.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;">F</th>
<th id="S5.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;">L</th>
<th id="S5.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;">I/L</th>
<th id="S5.T2.1.1.1.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;">L/I</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.2.1" class="ltx_tr">
<th id="S5.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">EURLex</th>
<td id="S5.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">15539</td>
<td id="S5.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">3809</td>
<td id="S5.T2.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">5000</td>
<td id="S5.T2.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">3993</td>
<td id="S5.T2.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">25.73</td>
<td id="S5.T2.1.2.1.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">5.31</td>
</tr>
<tr id="S5.T2.1.3.2" class="ltx_tr">
<th id="S5.T2.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">Bibtex</th>
<td id="S5.T2.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">4880</td>
<td id="S5.T2.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">2515</td>
<td id="S5.T2.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">1836</td>
<td id="S5.T2.1.3.2.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">159</td>
<td id="S5.T2.1.3.2.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">111.71</td>
<td id="S5.T2.1.3.2.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">2.40</td>
</tr>
<tr id="S5.T2.1.4.3" class="ltx_tr">
<th id="S5.T2.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">AmazonCat</th>
<td id="S5.T2.1.4.3.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">1,186,239</td>
<td id="S5.T2.1.4.3.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">306,782</td>
<td id="S5.T2.1.4.3.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">203,882</td>
<td id="S5.T2.1.4.3.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">13,330</td>
<td id="S5.T2.1.4.3.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">448.57</td>
<td id="S5.T2.1.4.3.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">5.04</td>
</tr>
<tr id="S5.T2.1.5.4" class="ltx_tr">
<th id="S5.T2.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">Amazon670K</th>
<td id="S5.T2.1.5.4.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">485,176</td>
<td id="S5.T2.1.5.4.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">150,875</td>
<td id="S5.T2.1.5.4.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">66,666</td>
<td id="S5.T2.1.5.4.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">670,091</td>
<td id="S5.T2.1.5.4.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">5.11</td>
<td id="S5.T2.1.5.4.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">5.99</td>
</tr>
<tr id="S5.T2.1.6.5" class="ltx_tr">
<th id="S5.T2.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">WikiLSHTC</th>
<td id="S5.T2.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">1,778,351</td>
<td id="S5.T2.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">587,084</td>
<td id="S5.T2.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">1,617,899</td>
<td id="S5.T2.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">325,056</td>
<td id="S5.T2.1.6.5.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">17.46</td>
<td id="S5.T2.1.6.5.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">3.19</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">We also evaluate our algorithm on extreme multi-label text datasets: EURLex<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>, Bibtex<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, AmazonCat<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite>, WikiLSHTC<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> and Amazon670K<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite>.
These datasets are available in the Extreme Classification Repository<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Most of the popular extreme classification datasets are available on the website: http://manikvarma.org/downloads/XC/XMLRepository.html</span></span></span>. A statistic of the sample, feature and class label of these multi-label textual datasets are shown in Table <a href="#S5.T2" title="TABLE II ‣ V-A Datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.4.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.5.2" class="ltx_text ltx_font_italic">Model architecture</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.10" class="ltx_p">As mentioned earlier, we adopt the embedding-based classification model. For image datasets, we use <span id="S5.SS2.p1.10.1" class="ltx_text ltx_font_bold">RESNET-50</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite> as the backbone. The feature is then mapped into <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mn id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><cn type="integer" id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">512</annotation></semantics></math>-dimensional vector using linear transformation. Finally, the embedding is normalized so that its <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><msub id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">l</mi><mn id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2">𝑙</ci><cn type="integer" id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">l_{2}</annotation></semantics></math>-norm is <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><mn id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><cn type="integer" id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">1</annotation></semantics></math>. In regard to the text datasets, high-dimensional sparse vector is embedded into <math id="S5.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mathbb{R}^{512}" display="inline"><semantics id="S5.SS2.p1.4.m4.1a"><msup id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml"><mi id="S5.SS2.p1.4.m4.1.1.2" xref="S5.SS2.p1.4.m4.1.1.2.cmml">ℝ</mi><mn id="S5.SS2.p1.4.m4.1.1.3" xref="S5.SS2.p1.4.m4.1.1.3.cmml">512</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><apply id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">superscript</csymbol><ci id="S5.SS2.p1.4.m4.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.2">ℝ</ci><cn type="integer" id="S5.SS2.p1.4.m4.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">\mathbb{R}^{512}</annotation></semantics></math> by embedding layer. The output is then passed through three linear layers with the size of <math id="S5.SS2.p1.5.m5.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S5.SS2.p1.5.m5.1a"><mn id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><cn type="integer" id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">1024</annotation></semantics></math>, <math id="S5.SS2.p1.6.m6.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S5.SS2.p1.6.m6.1a"><mn id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.1b"><cn type="integer" id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.1c">1024</annotation></semantics></math> and <math id="S5.SS2.p1.7.m7.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S5.SS2.p1.7.m7.1a"><mn id="S5.SS2.p1.7.m7.1.1" xref="S5.SS2.p1.7.m7.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m7.1b"><cn type="integer" id="S5.SS2.p1.7.m7.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m7.1c">512</annotation></semantics></math>. The first two layers use a <math id="S5.SS2.p1.8.m8.1" class="ltx_Math" alttext="{ReLU}" display="inline"><semantics id="S5.SS2.p1.8.m8.1a"><mrow id="S5.SS2.p1.8.m8.1.1" xref="S5.SS2.p1.8.m8.1.1.cmml"><mi id="S5.SS2.p1.8.m8.1.1.2" xref="S5.SS2.p1.8.m8.1.1.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.8.m8.1.1.1" xref="S5.SS2.p1.8.m8.1.1.1.cmml">​</mo><mi id="S5.SS2.p1.8.m8.1.1.3" xref="S5.SS2.p1.8.m8.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.8.m8.1.1.1a" xref="S5.SS2.p1.8.m8.1.1.1.cmml">​</mo><mi id="S5.SS2.p1.8.m8.1.1.4" xref="S5.SS2.p1.8.m8.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.8.m8.1.1.1b" xref="S5.SS2.p1.8.m8.1.1.1.cmml">​</mo><mi id="S5.SS2.p1.8.m8.1.1.5" xref="S5.SS2.p1.8.m8.1.1.5.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.8.m8.1b"><apply id="S5.SS2.p1.8.m8.1.1.cmml" xref="S5.SS2.p1.8.m8.1.1"><times id="S5.SS2.p1.8.m8.1.1.1.cmml" xref="S5.SS2.p1.8.m8.1.1.1"></times><ci id="S5.SS2.p1.8.m8.1.1.2.cmml" xref="S5.SS2.p1.8.m8.1.1.2">𝑅</ci><ci id="S5.SS2.p1.8.m8.1.1.3.cmml" xref="S5.SS2.p1.8.m8.1.1.3">𝑒</ci><ci id="S5.SS2.p1.8.m8.1.1.4.cmml" xref="S5.SS2.p1.8.m8.1.1.4">𝐿</ci><ci id="S5.SS2.p1.8.m8.1.1.5.cmml" xref="S5.SS2.p1.8.m8.1.1.5">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.8.m8.1c">{ReLU}</annotation></semantics></math> activation function. The output is then normalized to an unit vector. The instance embedding and class embedding are all <math id="S5.SS2.p1.9.m9.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S5.SS2.p1.9.m9.1a"><msub id="S5.SS2.p1.9.m9.1.1" xref="S5.SS2.p1.9.m9.1.1.cmml"><mi id="S5.SS2.p1.9.m9.1.1.2" xref="S5.SS2.p1.9.m9.1.1.2.cmml">l</mi><mn id="S5.SS2.p1.9.m9.1.1.3" xref="S5.SS2.p1.9.m9.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.9.m9.1b"><apply id="S5.SS2.p1.9.m9.1.1.cmml" xref="S5.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.9.m9.1.1.1.cmml" xref="S5.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S5.SS2.p1.9.m9.1.1.2.cmml" xref="S5.SS2.p1.9.m9.1.1.2">𝑙</ci><cn type="integer" id="S5.SS2.p1.9.m9.1.1.3.cmml" xref="S5.SS2.p1.9.m9.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.9.m9.1c">l_{2}</annotation></semantics></math> normalized, and thus the predicted score belongs to the <math id="S5.SS2.p1.10.m10.2" class="ltx_Math" alttext="[-1,1]" display="inline"><semantics id="S5.SS2.p1.10.m10.2a"><mrow id="S5.SS2.p1.10.m10.2.2.1" xref="S5.SS2.p1.10.m10.2.2.2.cmml"><mo stretchy="false" id="S5.SS2.p1.10.m10.2.2.1.2" xref="S5.SS2.p1.10.m10.2.2.2.cmml">[</mo><mrow id="S5.SS2.p1.10.m10.2.2.1.1" xref="S5.SS2.p1.10.m10.2.2.1.1.cmml"><mo id="S5.SS2.p1.10.m10.2.2.1.1a" xref="S5.SS2.p1.10.m10.2.2.1.1.cmml">−</mo><mn id="S5.SS2.p1.10.m10.2.2.1.1.2" xref="S5.SS2.p1.10.m10.2.2.1.1.2.cmml">1</mn></mrow><mo id="S5.SS2.p1.10.m10.2.2.1.3" xref="S5.SS2.p1.10.m10.2.2.2.cmml">,</mo><mn id="S5.SS2.p1.10.m10.1.1" xref="S5.SS2.p1.10.m10.1.1.cmml">1</mn><mo stretchy="false" id="S5.SS2.p1.10.m10.2.2.1.4" xref="S5.SS2.p1.10.m10.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.10.m10.2b"><interval closure="closed" id="S5.SS2.p1.10.m10.2.2.2.cmml" xref="S5.SS2.p1.10.m10.2.2.1"><apply id="S5.SS2.p1.10.m10.2.2.1.1.cmml" xref="S5.SS2.p1.10.m10.2.2.1.1"><minus id="S5.SS2.p1.10.m10.2.2.1.1.1.cmml" xref="S5.SS2.p1.10.m10.2.2.1.1"></minus><cn type="integer" id="S5.SS2.p1.10.m10.2.2.1.1.2.cmml" xref="S5.SS2.p1.10.m10.2.2.1.1.2">1</cn></apply><cn type="integer" id="S5.SS2.p1.10.m10.1.1.cmml" xref="S5.SS2.p1.10.m10.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.10.m10.2c">[-1,1]</annotation></semantics></math> interval.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.4.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.5.2" class="ltx_text ltx_font_italic">Implementation detail</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.7" class="ltx_p">The methods are implemented using PyTorch, and all experiments are performed on server containing CPUs of 2.60GHz and GPUs of GeForce RTX 3090. SGD (stochastic gradient descent) is used to optimize the embedding-based model.
In this paper, each client corresponds to a label and the client only has the data whose label set includes the specified label. In this way, the number of clients equal to the number of labels. Since the data has multiple labels, the same data may appear in different clients.
From <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>, we can get that if Dirichlet distribution is used to split the training dataset over clients, the client would have data with the negative label.
In addition, Dirichlet distribution method assumes each class is independent, which conflicts with multi-label properties<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>.
Therefore, we donn’t use Dirichlet distribution.
We follow the setting in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> to use a large learning rate (<math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mn id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><cn type="float" id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">0.1</annotation></semantics></math>) when optimizing the instance embeddings on the clients, to accelerate the learning process. The learning rate on the server is set as <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="0.0001" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mn id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><cn type="float" id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">0.0001</annotation></semantics></math>. Most of the hyper-parameters in our FedALC method are the same as in FedAwS, where the balancing hyper-parameter <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mi id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><ci id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">\lambda</annotation></semantics></math> is tuned to achieve the best performance. Fig. <a href="#S5.F5" title="Figure 5 ‣ V-C Implementation detail ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> is a statistic of the number of instances for all labels (clients) on the EURlex dataset, where we can see that the numbers vary significantly for different labels, and exhibit a long-tail distribution.
Such distribution also exists in other datasets in our experiments. In the following experiments, we let all clients participate in the communication to accelerate the training process. For image datasets, we run <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mn id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><cn type="integer" id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">100</annotation></semantics></math> global communication rounds on COCO and FLAIR and <math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="300" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mn id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml">300</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><cn type="integer" id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">300</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">300</annotation></semantics></math> rounds on VOC12 and VOC07. For text datasets, we set the global communication rounds to be <math id="S5.SS3.p1.6.m6.1" class="ltx_Math" alttext="300" display="inline"><semantics id="S5.SS3.p1.6.m6.1a"><mn id="S5.SS3.p1.6.m6.1.1" xref="S5.SS3.p1.6.m6.1.1.cmml">300</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m6.1b"><cn type="integer" id="S5.SS3.p1.6.m6.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1">300</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m6.1c">300</annotation></semantics></math> and <math id="S5.SS3.p1.7.m7.1" class="ltx_Math" alttext="500" display="inline"><semantics id="S5.SS3.p1.7.m7.1a"><mn id="S5.SS3.p1.7.m7.1.1" xref="S5.SS3.p1.7.m7.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.7.m7.1b"><cn type="integer" id="S5.SS3.p1.7.m7.1.1.cmml" xref="S5.SS3.p1.7.m7.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.7.m7.1c">500</annotation></semantics></math> in the experiments of dynamic class embedding and fixed embedding variant, respectively (on both datasets).</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/2404.15598/assets/x4.png" id="S5.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="259" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Visualization of number heterogeneity among users on EURlex dataset.</figcaption>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS4.4.1.1" class="ltx_text">V-D</span> </span><span id="S5.SS4.5.2" class="ltx_text ltx_font_italic">Compared approaches</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">To show the effectiveness of the proposed method, we compare with the following approaches:</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">SLEEC<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib70" title="" class="ltx_ref">70</a>]</cite>:</span> Training by employing SLEEC in the oracle mode, which has access to both positive and negative embeddings.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">FedAvg<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>:</span> Training by employing FedAvg with only positive loss. In order to reduce the possibility of collapsing as much as possible, we initialize the class embedding matrix that is almost spreadout.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">FedAwS<cite class="ltx_cite ltx_citemacro_cite"><span id="S5.I1.i3.p1.1.1.1.1" class="ltx_text ltx_font_medium">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S5.I1.i3.p1.1.1.2.2" class="ltx_text ltx_font_medium">]</span></cite></span>: Training by employing FedAwS with stochastic negative mining and the balancing hyper-parameter <math id="S5.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.I1.i3.p1.1.m1.1a"><mi id="S5.I1.i3.p1.1.m1.1.1" xref="S5.I1.i3.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.I1.i3.p1.1.m1.1b"><ci id="S5.I1.i3.p1.1.m1.1.1.cmml" xref="S5.I1.i3.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i3.p1.1.m1.1c">\lambda</annotation></semantics></math> controlling the effect of the spreadout on the class embedding matrix.</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p"><span id="S5.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">FedAvg-fixed:</span> Training by employing FedAvg with only positive loss with the fixed class embedding, which is generated by random.</p>
</div>
</li>
<li id="S5.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i5.p1" class="ltx_para">
<p id="S5.I1.i5.p1.1" class="ltx_p"><span id="S5.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">FedMLH<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib71" title="" class="ltx_ref">71</a>]</cite></span>: leverages label hashing to reduce the model size and achieve low communication cost. The class embedding matrix adopted are the same as FedAvg-fixed.</p>
</div>
</li>
<li id="S5.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i6.p1" class="ltx_para">
<p id="S5.I1.i6.p1.1" class="ltx_p"><span id="S5.I1.i6.p1.1.1" class="ltx_text ltx_font_bold">FLAG<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite></span>: proposes a novel aggregation method based on label distribution and occurrence in the client dataset. The class embedding matrix adopted are the same as FedAvg-fixed.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS5.4.1.1" class="ltx_text">V-E</span> </span><span id="S5.SS5.5.2" class="ltx_text ltx_font_italic">Evaluation criteria</span>
</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.5" class="ltx_p">For multi-label classification datasets, especially text datasets, even though the label space is very large, each instance only has several relevant labels. Hence, it is crucial to choose the short and most relevant label list for each test instance and evaluate the prediction quality, where the label list is the short ranked list of potentially relevant labels. The classic evaluation metric for the multi-label text classification is the top <math id="S5.SS5.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS5.p1.1.m1.1a"><mi id="S5.SS5.p1.1.m1.1.1" xref="S5.SS5.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.1.m1.1b"><ci id="S5.SS5.p1.1.m1.1.1.cmml" xref="S5.SS5.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.1.m1.1c">K</annotation></semantics></math> precision (<math id="S5.SS5.p1.2.m2.1" class="ltx_Math" alttext="P@K" display="inline"><semantics id="S5.SS5.p1.2.m2.1a"><mrow id="S5.SS5.p1.2.m2.1.1" xref="S5.SS5.p1.2.m2.1.1.cmml"><mi id="S5.SS5.p1.2.m2.1.1.2" xref="S5.SS5.p1.2.m2.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.2.m2.1.1.1" xref="S5.SS5.p1.2.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS5.p1.2.m2.1.1.3" xref="S5.SS5.p1.2.m2.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.2.m2.1.1.1a" xref="S5.SS5.p1.2.m2.1.1.1.cmml">​</mo><mi id="S5.SS5.p1.2.m2.1.1.4" xref="S5.SS5.p1.2.m2.1.1.4.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.2.m2.1b"><apply id="S5.SS5.p1.2.m2.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1"><times id="S5.SS5.p1.2.m2.1.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1.1"></times><ci id="S5.SS5.p1.2.m2.1.1.2.cmml" xref="S5.SS5.p1.2.m2.1.1.2">𝑃</ci><ci id="S5.SS5.p1.2.m2.1.1.3.cmml" xref="S5.SS5.p1.2.m2.1.1.3">@</ci><ci id="S5.SS5.p1.2.m2.1.1.4.cmml" xref="S5.SS5.p1.2.m2.1.1.4">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.2.m2.1c">P@K</annotation></semantics></math>). We use this metric to evaluate the quality of the prediction with <math id="S5.SS5.p1.3.m3.3" class="ltx_Math" alttext="K=1,3,5" display="inline"><semantics id="S5.SS5.p1.3.m3.3a"><mrow id="S5.SS5.p1.3.m3.3.4" xref="S5.SS5.p1.3.m3.3.4.cmml"><mi id="S5.SS5.p1.3.m3.3.4.2" xref="S5.SS5.p1.3.m3.3.4.2.cmml">K</mi><mo id="S5.SS5.p1.3.m3.3.4.1" xref="S5.SS5.p1.3.m3.3.4.1.cmml">=</mo><mrow id="S5.SS5.p1.3.m3.3.4.3.2" xref="S5.SS5.p1.3.m3.3.4.3.1.cmml"><mn id="S5.SS5.p1.3.m3.1.1" xref="S5.SS5.p1.3.m3.1.1.cmml">1</mn><mo id="S5.SS5.p1.3.m3.3.4.3.2.1" xref="S5.SS5.p1.3.m3.3.4.3.1.cmml">,</mo><mn id="S5.SS5.p1.3.m3.2.2" xref="S5.SS5.p1.3.m3.2.2.cmml">3</mn><mo id="S5.SS5.p1.3.m3.3.4.3.2.2" xref="S5.SS5.p1.3.m3.3.4.3.1.cmml">,</mo><mn id="S5.SS5.p1.3.m3.3.3" xref="S5.SS5.p1.3.m3.3.3.cmml">5</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.3.m3.3b"><apply id="S5.SS5.p1.3.m3.3.4.cmml" xref="S5.SS5.p1.3.m3.3.4"><eq id="S5.SS5.p1.3.m3.3.4.1.cmml" xref="S5.SS5.p1.3.m3.3.4.1"></eq><ci id="S5.SS5.p1.3.m3.3.4.2.cmml" xref="S5.SS5.p1.3.m3.3.4.2">𝐾</ci><list id="S5.SS5.p1.3.m3.3.4.3.1.cmml" xref="S5.SS5.p1.3.m3.3.4.3.2"><cn type="integer" id="S5.SS5.p1.3.m3.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1">1</cn><cn type="integer" id="S5.SS5.p1.3.m3.2.2.cmml" xref="S5.SS5.p1.3.m3.2.2">3</cn><cn type="integer" id="S5.SS5.p1.3.m3.3.3.cmml" xref="S5.SS5.p1.3.m3.3.3">5</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.3.m3.3c">K=1,3,5</annotation></semantics></math>. We denote <math id="S5.SS5.p1.4.m4.2" class="ltx_Math" alttext="y\in\{0,1\}^{L}" display="inline"><semantics id="S5.SS5.p1.4.m4.2a"><mrow id="S5.SS5.p1.4.m4.2.3" xref="S5.SS5.p1.4.m4.2.3.cmml"><mi id="S5.SS5.p1.4.m4.2.3.2" xref="S5.SS5.p1.4.m4.2.3.2.cmml">y</mi><mo id="S5.SS5.p1.4.m4.2.3.1" xref="S5.SS5.p1.4.m4.2.3.1.cmml">∈</mo><msup id="S5.SS5.p1.4.m4.2.3.3" xref="S5.SS5.p1.4.m4.2.3.3.cmml"><mrow id="S5.SS5.p1.4.m4.2.3.3.2.2" xref="S5.SS5.p1.4.m4.2.3.3.2.1.cmml"><mo stretchy="false" id="S5.SS5.p1.4.m4.2.3.3.2.2.1" xref="S5.SS5.p1.4.m4.2.3.3.2.1.cmml">{</mo><mn id="S5.SS5.p1.4.m4.1.1" xref="S5.SS5.p1.4.m4.1.1.cmml">0</mn><mo id="S5.SS5.p1.4.m4.2.3.3.2.2.2" xref="S5.SS5.p1.4.m4.2.3.3.2.1.cmml">,</mo><mn id="S5.SS5.p1.4.m4.2.2" xref="S5.SS5.p1.4.m4.2.2.cmml">1</mn><mo stretchy="false" id="S5.SS5.p1.4.m4.2.3.3.2.2.3" xref="S5.SS5.p1.4.m4.2.3.3.2.1.cmml">}</mo></mrow><mi id="S5.SS5.p1.4.m4.2.3.3.3" xref="S5.SS5.p1.4.m4.2.3.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.4.m4.2b"><apply id="S5.SS5.p1.4.m4.2.3.cmml" xref="S5.SS5.p1.4.m4.2.3"><in id="S5.SS5.p1.4.m4.2.3.1.cmml" xref="S5.SS5.p1.4.m4.2.3.1"></in><ci id="S5.SS5.p1.4.m4.2.3.2.cmml" xref="S5.SS5.p1.4.m4.2.3.2">𝑦</ci><apply id="S5.SS5.p1.4.m4.2.3.3.cmml" xref="S5.SS5.p1.4.m4.2.3.3"><csymbol cd="ambiguous" id="S5.SS5.p1.4.m4.2.3.3.1.cmml" xref="S5.SS5.p1.4.m4.2.3.3">superscript</csymbol><set id="S5.SS5.p1.4.m4.2.3.3.2.1.cmml" xref="S5.SS5.p1.4.m4.2.3.3.2.2"><cn type="integer" id="S5.SS5.p1.4.m4.1.1.cmml" xref="S5.SS5.p1.4.m4.1.1">0</cn><cn type="integer" id="S5.SS5.p1.4.m4.2.2.cmml" xref="S5.SS5.p1.4.m4.2.2">1</cn></set><ci id="S5.SS5.p1.4.m4.2.3.3.3.cmml" xref="S5.SS5.p1.4.m4.2.3.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.4.m4.2c">y\in\{0,1\}^{L}</annotation></semantics></math> as the vector of true labels of an instance, and <math id="S5.SS5.p1.5.m5.1" class="ltx_Math" alttext="\hat{y}\in R^{L}" display="inline"><semantics id="S5.SS5.p1.5.m5.1a"><mrow id="S5.SS5.p1.5.m5.1.1" xref="S5.SS5.p1.5.m5.1.1.cmml"><mover accent="true" id="S5.SS5.p1.5.m5.1.1.2" xref="S5.SS5.p1.5.m5.1.1.2.cmml"><mi id="S5.SS5.p1.5.m5.1.1.2.2" xref="S5.SS5.p1.5.m5.1.1.2.2.cmml">y</mi><mo id="S5.SS5.p1.5.m5.1.1.2.1" xref="S5.SS5.p1.5.m5.1.1.2.1.cmml">^</mo></mover><mo id="S5.SS5.p1.5.m5.1.1.1" xref="S5.SS5.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S5.SS5.p1.5.m5.1.1.3" xref="S5.SS5.p1.5.m5.1.1.3.cmml"><mi id="S5.SS5.p1.5.m5.1.1.3.2" xref="S5.SS5.p1.5.m5.1.1.3.2.cmml">R</mi><mi id="S5.SS5.p1.5.m5.1.1.3.3" xref="S5.SS5.p1.5.m5.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.5.m5.1b"><apply id="S5.SS5.p1.5.m5.1.1.cmml" xref="S5.SS5.p1.5.m5.1.1"><in id="S5.SS5.p1.5.m5.1.1.1.cmml" xref="S5.SS5.p1.5.m5.1.1.1"></in><apply id="S5.SS5.p1.5.m5.1.1.2.cmml" xref="S5.SS5.p1.5.m5.1.1.2"><ci id="S5.SS5.p1.5.m5.1.1.2.1.cmml" xref="S5.SS5.p1.5.m5.1.1.2.1">^</ci><ci id="S5.SS5.p1.5.m5.1.1.2.2.cmml" xref="S5.SS5.p1.5.m5.1.1.2.2">𝑦</ci></apply><apply id="S5.SS5.p1.5.m5.1.1.3.cmml" xref="S5.SS5.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S5.SS5.p1.5.m5.1.1.3.1.cmml" xref="S5.SS5.p1.5.m5.1.1.3">superscript</csymbol><ci id="S5.SS5.p1.5.m5.1.1.3.2.cmml" xref="S5.SS5.p1.5.m5.1.1.3.2">𝑅</ci><ci id="S5.SS5.p1.5.m5.1.1.3.3.cmml" xref="S5.SS5.p1.5.m5.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.5.m5.1c">\hat{y}\in R^{L}</annotation></semantics></math> as the algorithm-predicted score for the instance. Then the metric can be defined as :</p>
<table id="S5.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E15.m1.1" class="ltx_Math" alttext="P@K=\frac{1}{k}\sum\limits_{l\in r_{k}(\hat{y})}y_{l}" display="block"><semantics id="S5.E15.m1.1a"><mrow id="S5.E15.m1.1.2" xref="S5.E15.m1.1.2.cmml"><mrow id="S5.E15.m1.1.2.2" xref="S5.E15.m1.1.2.2.cmml"><mi id="S5.E15.m1.1.2.2.2" xref="S5.E15.m1.1.2.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.E15.m1.1.2.2.1" xref="S5.E15.m1.1.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S5.E15.m1.1.2.2.3" xref="S5.E15.m1.1.2.2.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.E15.m1.1.2.2.1a" xref="S5.E15.m1.1.2.2.1.cmml">​</mo><mi id="S5.E15.m1.1.2.2.4" xref="S5.E15.m1.1.2.2.4.cmml">K</mi></mrow><mo id="S5.E15.m1.1.2.1" xref="S5.E15.m1.1.2.1.cmml">=</mo><mrow id="S5.E15.m1.1.2.3" xref="S5.E15.m1.1.2.3.cmml"><mfrac id="S5.E15.m1.1.2.3.2" xref="S5.E15.m1.1.2.3.2.cmml"><mn id="S5.E15.m1.1.2.3.2.2" xref="S5.E15.m1.1.2.3.2.2.cmml">1</mn><mi id="S5.E15.m1.1.2.3.2.3" xref="S5.E15.m1.1.2.3.2.3.cmml">k</mi></mfrac><mo lspace="0em" rspace="0em" id="S5.E15.m1.1.2.3.1" xref="S5.E15.m1.1.2.3.1.cmml">​</mo><mrow id="S5.E15.m1.1.2.3.3" xref="S5.E15.m1.1.2.3.3.cmml"><munder id="S5.E15.m1.1.2.3.3.1" xref="S5.E15.m1.1.2.3.3.1.cmml"><mo movablelimits="false" id="S5.E15.m1.1.2.3.3.1.2" xref="S5.E15.m1.1.2.3.3.1.2.cmml">∑</mo><mrow id="S5.E15.m1.1.1.1" xref="S5.E15.m1.1.1.1.cmml"><mi id="S5.E15.m1.1.1.1.3" xref="S5.E15.m1.1.1.1.3.cmml">l</mi><mo id="S5.E15.m1.1.1.1.2" xref="S5.E15.m1.1.1.1.2.cmml">∈</mo><mrow id="S5.E15.m1.1.1.1.4" xref="S5.E15.m1.1.1.1.4.cmml"><msub id="S5.E15.m1.1.1.1.4.2" xref="S5.E15.m1.1.1.1.4.2.cmml"><mi id="S5.E15.m1.1.1.1.4.2.2" xref="S5.E15.m1.1.1.1.4.2.2.cmml">r</mi><mi id="S5.E15.m1.1.1.1.4.2.3" xref="S5.E15.m1.1.1.1.4.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S5.E15.m1.1.1.1.4.1" xref="S5.E15.m1.1.1.1.4.1.cmml">​</mo><mrow id="S5.E15.m1.1.1.1.4.3.2" xref="S5.E15.m1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E15.m1.1.1.1.4.3.2.1" xref="S5.E15.m1.1.1.1.1.cmml">(</mo><mover accent="true" id="S5.E15.m1.1.1.1.1" xref="S5.E15.m1.1.1.1.1.cmml"><mi id="S5.E15.m1.1.1.1.1.2" xref="S5.E15.m1.1.1.1.1.2.cmml">y</mi><mo id="S5.E15.m1.1.1.1.1.1" xref="S5.E15.m1.1.1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S5.E15.m1.1.1.1.4.3.2.2" xref="S5.E15.m1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><msub id="S5.E15.m1.1.2.3.3.2" xref="S5.E15.m1.1.2.3.3.2.cmml"><mi id="S5.E15.m1.1.2.3.3.2.2" xref="S5.E15.m1.1.2.3.3.2.2.cmml">y</mi><mi id="S5.E15.m1.1.2.3.3.2.3" xref="S5.E15.m1.1.2.3.3.2.3.cmml">l</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E15.m1.1b"><apply id="S5.E15.m1.1.2.cmml" xref="S5.E15.m1.1.2"><eq id="S5.E15.m1.1.2.1.cmml" xref="S5.E15.m1.1.2.1"></eq><apply id="S5.E15.m1.1.2.2.cmml" xref="S5.E15.m1.1.2.2"><times id="S5.E15.m1.1.2.2.1.cmml" xref="S5.E15.m1.1.2.2.1"></times><ci id="S5.E15.m1.1.2.2.2.cmml" xref="S5.E15.m1.1.2.2.2">𝑃</ci><ci id="S5.E15.m1.1.2.2.3.cmml" xref="S5.E15.m1.1.2.2.3">@</ci><ci id="S5.E15.m1.1.2.2.4.cmml" xref="S5.E15.m1.1.2.2.4">𝐾</ci></apply><apply id="S5.E15.m1.1.2.3.cmml" xref="S5.E15.m1.1.2.3"><times id="S5.E15.m1.1.2.3.1.cmml" xref="S5.E15.m1.1.2.3.1"></times><apply id="S5.E15.m1.1.2.3.2.cmml" xref="S5.E15.m1.1.2.3.2"><divide id="S5.E15.m1.1.2.3.2.1.cmml" xref="S5.E15.m1.1.2.3.2"></divide><cn type="integer" id="S5.E15.m1.1.2.3.2.2.cmml" xref="S5.E15.m1.1.2.3.2.2">1</cn><ci id="S5.E15.m1.1.2.3.2.3.cmml" xref="S5.E15.m1.1.2.3.2.3">𝑘</ci></apply><apply id="S5.E15.m1.1.2.3.3.cmml" xref="S5.E15.m1.1.2.3.3"><apply id="S5.E15.m1.1.2.3.3.1.cmml" xref="S5.E15.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S5.E15.m1.1.2.3.3.1.1.cmml" xref="S5.E15.m1.1.2.3.3.1">subscript</csymbol><sum id="S5.E15.m1.1.2.3.3.1.2.cmml" xref="S5.E15.m1.1.2.3.3.1.2"></sum><apply id="S5.E15.m1.1.1.1.cmml" xref="S5.E15.m1.1.1.1"><in id="S5.E15.m1.1.1.1.2.cmml" xref="S5.E15.m1.1.1.1.2"></in><ci id="S5.E15.m1.1.1.1.3.cmml" xref="S5.E15.m1.1.1.1.3">𝑙</ci><apply id="S5.E15.m1.1.1.1.4.cmml" xref="S5.E15.m1.1.1.1.4"><times id="S5.E15.m1.1.1.1.4.1.cmml" xref="S5.E15.m1.1.1.1.4.1"></times><apply id="S5.E15.m1.1.1.1.4.2.cmml" xref="S5.E15.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S5.E15.m1.1.1.1.4.2.1.cmml" xref="S5.E15.m1.1.1.1.4.2">subscript</csymbol><ci id="S5.E15.m1.1.1.1.4.2.2.cmml" xref="S5.E15.m1.1.1.1.4.2.2">𝑟</ci><ci id="S5.E15.m1.1.1.1.4.2.3.cmml" xref="S5.E15.m1.1.1.1.4.2.3">𝑘</ci></apply><apply id="S5.E15.m1.1.1.1.1.cmml" xref="S5.E15.m1.1.1.1.4.3.2"><ci id="S5.E15.m1.1.1.1.1.1.cmml" xref="S5.E15.m1.1.1.1.1.1">^</ci><ci id="S5.E15.m1.1.1.1.1.2.cmml" xref="S5.E15.m1.1.1.1.1.2">𝑦</ci></apply></apply></apply></apply><apply id="S5.E15.m1.1.2.3.3.2.cmml" xref="S5.E15.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="S5.E15.m1.1.2.3.3.2.1.cmml" xref="S5.E15.m1.1.2.3.3.2">subscript</csymbol><ci id="S5.E15.m1.1.2.3.3.2.2.cmml" xref="S5.E15.m1.1.2.3.3.2.2">𝑦</ci><ci id="S5.E15.m1.1.2.3.3.2.3.cmml" xref="S5.E15.m1.1.2.3.3.2.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E15.m1.1c">P@K=\frac{1}{k}\sum\limits_{l\in r_{k}(\hat{y})}y_{l}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S5.SS5.p1.8" class="ltx_p">where <math id="S5.SS5.p1.6.m1.1" class="ltx_Math" alttext="r_{k}(\hat{y})" display="inline"><semantics id="S5.SS5.p1.6.m1.1a"><mrow id="S5.SS5.p1.6.m1.1.2" xref="S5.SS5.p1.6.m1.1.2.cmml"><msub id="S5.SS5.p1.6.m1.1.2.2" xref="S5.SS5.p1.6.m1.1.2.2.cmml"><mi id="S5.SS5.p1.6.m1.1.2.2.2" xref="S5.SS5.p1.6.m1.1.2.2.2.cmml">r</mi><mi id="S5.SS5.p1.6.m1.1.2.2.3" xref="S5.SS5.p1.6.m1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS5.p1.6.m1.1.2.1" xref="S5.SS5.p1.6.m1.1.2.1.cmml">​</mo><mrow id="S5.SS5.p1.6.m1.1.2.3.2" xref="S5.SS5.p1.6.m1.1.1.cmml"><mo stretchy="false" id="S5.SS5.p1.6.m1.1.2.3.2.1" xref="S5.SS5.p1.6.m1.1.1.cmml">(</mo><mover accent="true" id="S5.SS5.p1.6.m1.1.1" xref="S5.SS5.p1.6.m1.1.1.cmml"><mi id="S5.SS5.p1.6.m1.1.1.2" xref="S5.SS5.p1.6.m1.1.1.2.cmml">y</mi><mo id="S5.SS5.p1.6.m1.1.1.1" xref="S5.SS5.p1.6.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S5.SS5.p1.6.m1.1.2.3.2.2" xref="S5.SS5.p1.6.m1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.6.m1.1b"><apply id="S5.SS5.p1.6.m1.1.2.cmml" xref="S5.SS5.p1.6.m1.1.2"><times id="S5.SS5.p1.6.m1.1.2.1.cmml" xref="S5.SS5.p1.6.m1.1.2.1"></times><apply id="S5.SS5.p1.6.m1.1.2.2.cmml" xref="S5.SS5.p1.6.m1.1.2.2"><csymbol cd="ambiguous" id="S5.SS5.p1.6.m1.1.2.2.1.cmml" xref="S5.SS5.p1.6.m1.1.2.2">subscript</csymbol><ci id="S5.SS5.p1.6.m1.1.2.2.2.cmml" xref="S5.SS5.p1.6.m1.1.2.2.2">𝑟</ci><ci id="S5.SS5.p1.6.m1.1.2.2.3.cmml" xref="S5.SS5.p1.6.m1.1.2.2.3">𝑘</ci></apply><apply id="S5.SS5.p1.6.m1.1.1.cmml" xref="S5.SS5.p1.6.m1.1.2.3.2"><ci id="S5.SS5.p1.6.m1.1.1.1.cmml" xref="S5.SS5.p1.6.m1.1.1.1">^</ci><ci id="S5.SS5.p1.6.m1.1.1.2.cmml" xref="S5.SS5.p1.6.m1.1.1.2">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.6.m1.1c">r_{k}(\hat{y})</annotation></semantics></math> is the set of rank indices of the truly relevant labels among the top-<math id="S5.SS5.p1.7.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS5.p1.7.m2.1a"><mi id="S5.SS5.p1.7.m2.1.1" xref="S5.SS5.p1.7.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.7.m2.1b"><ci id="S5.SS5.p1.7.m2.1.1.cmml" xref="S5.SS5.p1.7.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.7.m2.1c">k</annotation></semantics></math> portion of the algorithm-predicted ranked list for an instance. In multi-label image classification, we use the classic mean average precision (MAP)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite> and also <math id="S5.SS5.p1.8.m3.1" class="ltx_Math" alttext="P@K" display="inline"><semantics id="S5.SS5.p1.8.m3.1a"><mrow id="S5.SS5.p1.8.m3.1.1" xref="S5.SS5.p1.8.m3.1.1.cmml"><mi id="S5.SS5.p1.8.m3.1.1.2" xref="S5.SS5.p1.8.m3.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.8.m3.1.1.1" xref="S5.SS5.p1.8.m3.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS5.p1.8.m3.1.1.3" xref="S5.SS5.p1.8.m3.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS5.p1.8.m3.1.1.1a" xref="S5.SS5.p1.8.m3.1.1.1.cmml">​</mo><mi id="S5.SS5.p1.8.m3.1.1.4" xref="S5.SS5.p1.8.m3.1.1.4.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.8.m3.1b"><apply id="S5.SS5.p1.8.m3.1.1.cmml" xref="S5.SS5.p1.8.m3.1.1"><times id="S5.SS5.p1.8.m3.1.1.1.cmml" xref="S5.SS5.p1.8.m3.1.1.1"></times><ci id="S5.SS5.p1.8.m3.1.1.2.cmml" xref="S5.SS5.p1.8.m3.1.1.2">𝑃</ci><ci id="S5.SS5.p1.8.m3.1.1.3.cmml" xref="S5.SS5.p1.8.m3.1.1.3">@</ci><ci id="S5.SS5.p1.8.m3.1.1.4.cmml" xref="S5.SS5.p1.8.m3.1.1.4">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.8.m3.1c">P@K</annotation></semantics></math> as the evaluation criteria.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>MAP(<math id="S5.T3.3.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T3.3.m1.1b"><mo id="S5.T3.3.m1.1.1" xref="S5.T3.3.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.m1.1c"><csymbol cd="latexml" id="S5.T3.3.m1.1.1.cmml" xref="S5.T3.3.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.m1.1d">\%</annotation></semantics></math>) and Top-k(<math id="S5.T3.4.m2.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T3.4.m2.1b"><mo id="S5.T3.4.m2.1.1" xref="S5.T3.4.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.m2.1c"><csymbol cd="latexml" id="S5.T3.4.m2.1.1.cmml" xref="S5.T3.4.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.m2.1d">\%</annotation></semantics></math>) on multi-label image datasets.</figcaption>
<table id="S5.T3.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.5.1.1" class="ltx_tr">
<th id="S5.T3.5.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">Dataset</th>
<th id="S5.T3.5.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">Method</th>
<th id="S5.T3.5.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">MAP</th>
<th id="S5.T3.5.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">P@3</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.5.2.1" class="ltx_tr">
<th id="S5.T3.5.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" rowspan="6"><span id="S5.T3.5.2.1.1.1" class="ltx_text">COCO</span></th>
<td id="S5.T3.5.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">FedAwS</td>
<td id="S5.T3.5.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">30.33</td>
<td id="S5.T3.5.2.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.2.1.4.1" class="ltx_text ltx_font_bold">25.72</span></td>
</tr>
<tr id="S5.T3.5.3.2" class="ltx_tr">
<td id="S5.T3.5.3.2.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">FLAG</td>
<td id="S5.T3.5.3.2.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">26.55</td>
<td id="S5.T3.5.3.2.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">19.60</td>
</tr>
<tr id="S5.T3.5.4.3" class="ltx_tr">
<td id="S5.T3.5.4.3.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">FedMLH</td>
<td id="S5.T3.5.4.3.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">26.14</td>
<td id="S5.T3.5.4.3.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">20.98</td>
</tr>
<tr id="S5.T3.5.5.4" class="ltx_tr">
<td id="S5.T3.5.5.4.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.5.4.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></td>
<td id="S5.T3.5.5.4.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.5.4.2.1" class="ltx_text ltx_font_bold">30.35</span></td>
<td id="S5.T3.5.5.4.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">25.60</td>
</tr>
<tr id="S5.T3.5.6.5" class="ltx_tr">
<td id="S5.T3.5.6.5.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">FedAvg-fixed</td>
<td id="S5.T3.5.6.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">26.86</td>
<td id="S5.T3.5.6.5.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">20.26</td>
</tr>
<tr id="S5.T3.5.7.6" class="ltx_tr">
<td id="S5.T3.5.7.6.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.7.6.1.1" class="ltx_text ltx_font_bold">FedALC-fixed (Our)</span></td>
<td id="S5.T3.5.7.6.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.7.6.2.1" class="ltx_text ltx_font_bold">30.22</span></td>
<td id="S5.T3.5.7.6.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.7.6.3.1" class="ltx_text ltx_font_bold">25.03</span></td>
</tr>
<tr id="S5.T3.5.8.7" class="ltx_tr">
<th id="S5.T3.5.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" rowspan="6"><span id="S5.T3.5.8.7.1.1" class="ltx_text">VOC12</span></th>
<td id="S5.T3.5.8.7.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">FedAwS</td>
<td id="S5.T3.5.8.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">37.70</td>
<td id="S5.T3.5.8.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">18.04</td>
</tr>
<tr id="S5.T3.5.9.8" class="ltx_tr">
<td id="S5.T3.5.9.8.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">FLAG</td>
<td id="S5.T3.5.9.8.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">35.16</td>
<td id="S5.T3.5.9.8.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">16.33</td>
</tr>
<tr id="S5.T3.5.10.9" class="ltx_tr">
<td id="S5.T3.5.10.9.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">FedMLH</td>
<td id="S5.T3.5.10.9.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">35.24</td>
<td id="S5.T3.5.10.9.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">16.24</td>
</tr>
<tr id="S5.T3.5.11.10" class="ltx_tr">
<td id="S5.T3.5.11.10.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.11.10.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></td>
<td id="S5.T3.5.11.10.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.11.10.2.1" class="ltx_text ltx_font_bold">40.78</span></td>
<td id="S5.T3.5.11.10.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.11.10.3.1" class="ltx_text ltx_font_bold">20.41</span></td>
</tr>
<tr id="S5.T3.5.12.11" class="ltx_tr">
<td id="S5.T3.5.12.11.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">FedAvg-fixed</td>
<td id="S5.T3.5.12.11.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">37.19</td>
<td id="S5.T3.5.12.11.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">17.40</td>
</tr>
<tr id="S5.T3.5.13.12" class="ltx_tr">
<td id="S5.T3.5.13.12.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.13.12.1.1" class="ltx_text ltx_font_bold">FedALC-fixed(Our)</span></td>
<td id="S5.T3.5.13.12.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.13.12.2.1" class="ltx_text ltx_font_bold">43.33</span></td>
<td id="S5.T3.5.13.12.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.13.12.3.1" class="ltx_text ltx_font_bold">19.77</span></td>
</tr>
<tr id="S5.T3.5.14.13" class="ltx_tr">
<th id="S5.T3.5.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" rowspan="6"><span id="S5.T3.5.14.13.1.1" class="ltx_text">VOC07</span></th>
<td id="S5.T3.5.14.13.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">FedAwS</td>
<td id="S5.T3.5.14.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">41.65</td>
<td id="S5.T3.5.14.13.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">21.16</td>
</tr>
<tr id="S5.T3.5.15.14" class="ltx_tr">
<td id="S5.T3.5.15.14.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">FLAG</td>
<td id="S5.T3.5.15.14.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">37.54</td>
<td id="S5.T3.5.15.14.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">19.86</td>
</tr>
<tr id="S5.T3.5.16.15" class="ltx_tr">
<td id="S5.T3.5.16.15.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">FedMLH</td>
<td id="S5.T3.5.16.15.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">38.02</td>
<td id="S5.T3.5.16.15.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">20.16</td>
</tr>
<tr id="S5.T3.5.17.16" class="ltx_tr">
<td id="S5.T3.5.17.16.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.17.16.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></td>
<td id="S5.T3.5.17.16.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.17.16.2.1" class="ltx_text ltx_font_bold">42.73</span></td>
<td id="S5.T3.5.17.16.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.17.16.3.1" class="ltx_text ltx_font_bold">23.00</span></td>
</tr>
<tr id="S5.T3.5.18.17" class="ltx_tr">
<td id="S5.T3.5.18.17.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">FedAvg-fixed</td>
<td id="S5.T3.5.18.17.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">41.54</td>
<td id="S5.T3.5.18.17.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">21.56</td>
</tr>
<tr id="S5.T3.5.19.18" class="ltx_tr">
<td id="S5.T3.5.19.18.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.19.18.1.1" class="ltx_text ltx_font_bold">FedALC-fixed (Our)</span></td>
<td id="S5.T3.5.19.18.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.19.18.2.1" class="ltx_text ltx_font_bold">42.66</span></td>
<td id="S5.T3.5.19.18.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.19.18.3.1" class="ltx_text ltx_font_bold">21.56</span></td>
</tr>
<tr id="S5.T3.5.20.19" class="ltx_tr">
<th id="S5.T3.5.20.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" rowspan="6"><span id="S5.T3.5.20.19.1.1" class="ltx_text">FLAIR</span></th>
<td id="S5.T3.5.20.19.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">FedAwS</td>
<td id="S5.T3.5.20.19.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">16.78</td>
<td id="S5.T3.5.20.19.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">5.15</td>
</tr>
<tr id="S5.T3.5.21.20" class="ltx_tr">
<td id="S5.T3.5.21.20.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">FLAG</td>
<td id="S5.T3.5.21.20.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">13.84</td>
<td id="S5.T3.5.21.20.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">3.86</td>
</tr>
<tr id="S5.T3.5.22.21" class="ltx_tr">
<td id="S5.T3.5.22.21.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">FedMLH</td>
<td id="S5.T3.5.22.21.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">13.96</td>
<td id="S5.T3.5.22.21.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">3.94</td>
</tr>
<tr id="S5.T3.5.23.22" class="ltx_tr">
<td id="S5.T3.5.23.22.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.23.22.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></td>
<td id="S5.T3.5.23.22.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.23.22.2.1" class="ltx_text ltx_font_bold">17.34</span></td>
<td id="S5.T3.5.23.22.3" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.23.22.3.1" class="ltx_text ltx_font_bold">5.92</span></td>
</tr>
<tr id="S5.T3.5.24.23" class="ltx_tr">
<td id="S5.T3.5.24.23.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">FedAvg-fixed</td>
<td id="S5.T3.5.24.23.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">14.35</td>
<td id="S5.T3.5.24.23.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">4.12</td>
</tr>
<tr id="S5.T3.5.25.24" class="ltx_tr">
<td id="S5.T3.5.25.24.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.25.24.1.1" class="ltx_text ltx_font_bold">FedALC-fixed (Our)</span></td>
<td id="S5.T3.5.25.24.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.25.24.2.1" class="ltx_text ltx_font_bold">16.96</span></td>
<td id="S5.T3.5.25.24.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T3.5.25.24.3.1" class="ltx_text ltx_font_bold">5.56</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS6.4.1.1" class="ltx_text">V-F</span> </span><span id="S5.SS6.5.2" class="ltx_text ltx_font_italic">Experiments on multi-label image datasets</span>
</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.6" class="ltx_p">The results are shown in Table <a href="#S5.T3" title="TABLE III ‣ V-E Evaluation criteria ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>.
FedALC improves the mean average precision (MAP) <math id="S5.SS6.p1.1.m1.1" class="ltx_Math" alttext="1.00\%" display="inline"><semantics id="S5.SS6.p1.1.m1.1a"><mrow id="S5.SS6.p1.1.m1.1.1" xref="S5.SS6.p1.1.m1.1.1.cmml"><mn id="S5.SS6.p1.1.m1.1.1.2" xref="S5.SS6.p1.1.m1.1.1.2.cmml">1.00</mn><mo id="S5.SS6.p1.1.m1.1.1.1" xref="S5.SS6.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.1.m1.1b"><apply id="S5.SS6.p1.1.m1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS6.p1.1.m1.1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.SS6.p1.1.m1.1.1.2.cmml" xref="S5.SS6.p1.1.m1.1.1.2">1.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.1.m1.1c">1.00\%</annotation></semantics></math>, <math id="S5.SS6.p1.2.m2.1" class="ltx_Math" alttext="8.17\%" display="inline"><semantics id="S5.SS6.p1.2.m2.1a"><mrow id="S5.SS6.p1.2.m2.1.1" xref="S5.SS6.p1.2.m2.1.1.cmml"><mn id="S5.SS6.p1.2.m2.1.1.2" xref="S5.SS6.p1.2.m2.1.1.2.cmml">8.17</mn><mo id="S5.SS6.p1.2.m2.1.1.1" xref="S5.SS6.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.2.m2.1b"><apply id="S5.SS6.p1.2.m2.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS6.p1.2.m2.1.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S5.SS6.p1.2.m2.1.1.2.cmml" xref="S5.SS6.p1.2.m2.1.1.2">8.17</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.2.m2.1c">8.17\%</annotation></semantics></math>, <math id="S5.SS6.p1.3.m3.1" class="ltx_Math" alttext="2.35\%" display="inline"><semantics id="S5.SS6.p1.3.m3.1a"><mrow id="S5.SS6.p1.3.m3.1.1" xref="S5.SS6.p1.3.m3.1.1.cmml"><mn id="S5.SS6.p1.3.m3.1.1.2" xref="S5.SS6.p1.3.m3.1.1.2.cmml">2.35</mn><mo id="S5.SS6.p1.3.m3.1.1.1" xref="S5.SS6.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.3.m3.1b"><apply id="S5.SS6.p1.3.m3.1.1.cmml" xref="S5.SS6.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS6.p1.3.m3.1.1.1.cmml" xref="S5.SS6.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="S5.SS6.p1.3.m3.1.1.2.cmml" xref="S5.SS6.p1.3.m3.1.1.2">2.35</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.3.m3.1c">2.35\%</annotation></semantics></math> and <math id="S5.SS6.p1.4.m4.1" class="ltx_Math" alttext="3.34\%" display="inline"><semantics id="S5.SS6.p1.4.m4.1a"><mrow id="S5.SS6.p1.4.m4.1.1" xref="S5.SS6.p1.4.m4.1.1.cmml"><mn id="S5.SS6.p1.4.m4.1.1.2" xref="S5.SS6.p1.4.m4.1.1.2.cmml">3.34</mn><mo id="S5.SS6.p1.4.m4.1.1.1" xref="S5.SS6.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.4.m4.1b"><apply id="S5.SS6.p1.4.m4.1.1.cmml" xref="S5.SS6.p1.4.m4.1.1"><csymbol cd="latexml" id="S5.SS6.p1.4.m4.1.1.1.cmml" xref="S5.SS6.p1.4.m4.1.1.1">percent</csymbol><cn type="float" id="S5.SS6.p1.4.m4.1.1.2.cmml" xref="S5.SS6.p1.4.m4.1.1.2">3.34</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.4.m4.1c">3.34\%</annotation></semantics></math> over the best baseline FedAwS on COCO, VOC12, VOC07 and FLAIR datasets.
From the table, we can see that: 1) since the number of labels is not very large for these datasets, the superiority of FedAwS compared with FedAvg is limited. This may be because the numbers of labels are not very large in these datasets, and it is easy to initialize a dispersed class embedding matrix, which is similar to the one obtained by simple spreadout, as adopted in FedAwS. By exploring label correlations, our FedALC consistently outperforms FedAvg under different criteria; 2) our method consistently outperforms FedAwS in terms of MAP, and is superior to FedAwS in most cases at <math id="S5.SS6.p1.5.m5.1" class="ltx_Math" alttext="P@3" display="inline"><semantics id="S5.SS6.p1.5.m5.1a"><mrow id="S5.SS6.p1.5.m5.1.1" xref="S5.SS6.p1.5.m5.1.1.cmml"><mi id="S5.SS6.p1.5.m5.1.1.2" xref="S5.SS6.p1.5.m5.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS6.p1.5.m5.1.1.1" xref="S5.SS6.p1.5.m5.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS6.p1.5.m5.1.1.3" xref="S5.SS6.p1.5.m5.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS6.p1.5.m5.1.1.1a" xref="S5.SS6.p1.5.m5.1.1.1.cmml">​</mo><mn id="S5.SS6.p1.5.m5.1.1.4" xref="S5.SS6.p1.5.m5.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.5.m5.1b"><apply id="S5.SS6.p1.5.m5.1.1.cmml" xref="S5.SS6.p1.5.m5.1.1"><times id="S5.SS6.p1.5.m5.1.1.1.cmml" xref="S5.SS6.p1.5.m5.1.1.1"></times><ci id="S5.SS6.p1.5.m5.1.1.2.cmml" xref="S5.SS6.p1.5.m5.1.1.2">𝑃</ci><ci id="S5.SS6.p1.5.m5.1.1.3.cmml" xref="S5.SS6.p1.5.m5.1.1.3">@</ci><cn type="integer" id="S5.SS6.p1.5.m5.1.1.4.cmml" xref="S5.SS6.p1.5.m5.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.5.m5.1c">P@3</annotation></semantics></math>. In particular, we achieve a significant <math id="S5.SS6.p1.6.m6.1" class="ltx_Math" alttext="8.17\%" display="inline"><semantics id="S5.SS6.p1.6.m6.1a"><mrow id="S5.SS6.p1.6.m6.1.1" xref="S5.SS6.p1.6.m6.1.1.cmml"><mn id="S5.SS6.p1.6.m6.1.1.2" xref="S5.SS6.p1.6.m6.1.1.2.cmml">8.17</mn><mo id="S5.SS6.p1.6.m6.1.1.1" xref="S5.SS6.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.6.m6.1b"><apply id="S5.SS6.p1.6.m6.1.1.cmml" xref="S5.SS6.p1.6.m6.1.1"><csymbol cd="latexml" id="S5.SS6.p1.6.m6.1.1.1.cmml" xref="S5.SS6.p1.6.m6.1.1.1">percent</csymbol><cn type="float" id="S5.SS6.p1.6.m6.1.1.2.cmml" xref="S5.SS6.p1.6.m6.1.1.2">8.17</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.6.m6.1c">8.17\%</annotation></semantics></math> relative improvement in terms of MAP on VOC12.
we also find that the performance on fixed class embeddings is better than the dynamic one in the experiment of VOC12. The reasons may be that: 1) the high-quality fixed class embedding which is spreadout enough and contains label correlations may achieve satisfactory performance; 2) the number of labels is limited in the multi-label images datasets, where the number of classes is often lower than 100 (compared with the thousands in the text datasets). In this case, it is easy to train the class embeddings to be high quality, and thus better performance are achieved. Regarding the dynamic embeddings, optimizations of class embeddings try to push some of them to be close on the client, and disperse some of them on the server. This contradictory operations may get stuck in training process.
In addtion to FedAwS, the other three baselines (FedAvg, FedMLH, FLAG) are all relatively weak because they donn’t consider the collapsing of class embedding matrix introduced by the lack of data with the negative label. Conversely, since FedAwS mitigates class embedding collapse by spreading out each class pair’s geometric distances, similar performance to FedALC can be achieved. It demonstrates that the class embedding matrix collapsing is the bottleneck of Federated Learning with only positive labels and FedALC can achieve better performance than FedAwS is due to the exploration of labels correlations.</p>
</div>
<div id="S5.SS6.p2" class="ltx_para">
<p id="S5.SS6.p2.1" class="ltx_p">To discuss the communication cost of our method, we evaluate the total volume of data transmitted by both the server and clients during FL training. The findings for multi-label image classification tasks are succinctly presented in table <a href="#S5.T4" title="TABLE IV ‣ V-F Experiments on multi-label image datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>The size of data transmitted by the server and the client for multi-label image datasets (MB).</figcaption>
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.1.1.1" class="ltx_tr">
<td id="S5.T4.1.1.1.1" class="ltx_td ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;"></td>
<th id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;" colspan="2">FedALC</th>
<th id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;" colspan="2">FedALC-fixed</th>
<th id="S5.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.8pt;padding-right:2.8pt;" colspan="2">FedAWS</th>
</tr>
<tr id="S5.T4.1.2.2" class="ltx_tr">
<td id="S5.T4.1.2.2.1" class="ltx_td ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"></td>
<th id="S5.T4.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">server</th>
<th id="S5.T4.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">client</th>
<th id="S5.T4.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">server</th>
<th id="S5.T4.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">client</th>
<th id="S5.T4.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">server</th>
<th id="S5.T4.1.2.2.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">client</th>
</tr>
<tr id="S5.T4.1.3.3" class="ltx_tr">
<td id="S5.T4.1.3.3.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">FLAIR</td>
<td id="S5.T4.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">2940</td>
<td id="S5.T4.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">2300.4</td>
<td id="S5.T4.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">2306.4</td>
<td id="S5.T4.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">2300</td>
<td id="S5.T4.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">2940</td>
<td id="S5.T4.1.3.3.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">2300.4</td>
</tr>
<tr id="S5.T4.1.4.4" class="ltx_tr">
<td id="S5.T4.1.4.4.1" class="ltx_td ltx_align_left" style="padding-left:2.8pt;padding-right:2.8pt;">VOC12</td>
<td id="S5.T4.1.4.4.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6924</td>
<td id="S5.T4.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6901.2</td>
<td id="S5.T4.1.4.4.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6900.1</td>
<td id="S5.T4.1.4.4.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6900</td>
<td id="S5.T4.1.4.4.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6924</td>
<td id="S5.T4.1.4.4.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6901.2</td>
</tr>
<tr id="S5.T4.1.5.5" class="ltx_tr">
<td id="S5.T4.1.5.5.1" class="ltx_td ltx_align_left" style="padding-left:2.8pt;padding-right:2.8pt;">VOC07</td>
<td id="S5.T4.1.5.5.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6924</td>
<td id="S5.T4.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6901.2</td>
<td id="S5.T4.1.5.5.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6900.1</td>
<td id="S5.T4.1.5.5.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6900</td>
<td id="S5.T4.1.5.5.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6924</td>
<td id="S5.T4.1.5.5.7" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">6901.2</td>
</tr>
<tr id="S5.T4.1.6.6" class="ltx_tr">
<td id="S5.T4.1.6.6.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">COCO</td>
<td id="S5.T4.1.6.6.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">2430</td>
<td id="S5.T4.1.6.6.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">2316</td>
<td id="S5.T4.1.6.6.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">2301.3</td>
<td id="S5.T4.1.6.6.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">2300</td>
<td id="S5.T4.1.6.6.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">2430</td>
<td id="S5.T4.1.6.6.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:2.8pt;padding-right:2.8pt;">2316</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS6.p3" class="ltx_para">
<p id="S5.SS6.p3.2" class="ltx_p">For the server, our proposed FedALC-fixed demonstrates the minimal volume of data transmitted. This reduction in data volume stems from the fact that under FedALC-fixed, the server transmits the class embedding matrix only once during the FL training, whereas under both FedALC and FedAWS,
the server transmits the class embedding matrix in each round. The most substantial reduction in data volume is observed in the FLAIR task. This is attributed to FLAIR having the largest number of labels(1628) and thus the class embedding matrix being of the largest size(<math id="S5.SS6.p3.1.m1.1" class="ltx_Math" alttext="1628\times 512" display="inline"><semantics id="S5.SS6.p3.1.m1.1a"><mrow id="S5.SS6.p3.1.m1.1.1" xref="S5.SS6.p3.1.m1.1.1.cmml"><mn id="S5.SS6.p3.1.m1.1.1.2" xref="S5.SS6.p3.1.m1.1.1.2.cmml">1628</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS6.p3.1.m1.1.1.1" xref="S5.SS6.p3.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS6.p3.1.m1.1.1.3" xref="S5.SS6.p3.1.m1.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.1.m1.1b"><apply id="S5.SS6.p3.1.m1.1.1.cmml" xref="S5.SS6.p3.1.m1.1.1"><times id="S5.SS6.p3.1.m1.1.1.1.cmml" xref="S5.SS6.p3.1.m1.1.1.1"></times><cn type="integer" id="S5.SS6.p3.1.m1.1.1.2.cmml" xref="S5.SS6.p3.1.m1.1.1.2">1628</cn><cn type="integer" id="S5.SS6.p3.1.m1.1.1.3.cmml" xref="S5.SS6.p3.1.m1.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.1.m1.1c">1628\times 512</annotation></semantics></math>). In comparison, the VOC07 and VOC12 tasks have the fewest labels (20), resulting in the smallest matrix size (<math id="S5.SS6.p3.2.m2.1" class="ltx_Math" alttext="20\times 512" display="inline"><semantics id="S5.SS6.p3.2.m2.1a"><mrow id="S5.SS6.p3.2.m2.1.1" xref="S5.SS6.p3.2.m2.1.1.cmml"><mn id="S5.SS6.p3.2.m2.1.1.2" xref="S5.SS6.p3.2.m2.1.1.2.cmml">20</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS6.p3.2.m2.1.1.1" xref="S5.SS6.p3.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS6.p3.2.m2.1.1.3" xref="S5.SS6.p3.2.m2.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.2.m2.1b"><apply id="S5.SS6.p3.2.m2.1.1.cmml" xref="S5.SS6.p3.2.m2.1.1"><times id="S5.SS6.p3.2.m2.1.1.1.cmml" xref="S5.SS6.p3.2.m2.1.1.1"></times><cn type="integer" id="S5.SS6.p3.2.m2.1.1.2.cmml" xref="S5.SS6.p3.2.m2.1.1.2">20</cn><cn type="integer" id="S5.SS6.p3.2.m2.1.1.3.cmml" xref="S5.SS6.p3.2.m2.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.2.m2.1c">20\times 512</annotation></semantics></math>), which minimally impacts communication costs. Consequently, the reduction in data size is less apparent for VOC07 and VOC12. In summary, when the size of the class embedding matrix is large, the proposed FedALC-fixed effectively mitigates communication cost for the server.</p>
</div>
<div id="S5.SS6.p4" class="ltx_para">
<p id="S5.SS6.p4.1" class="ltx_p">For the client, FedALC-fixed also achieves minimal data volume in communication. This is because, in the settings of FedALC-fixed, the client only transmits the model without any class embedding during each FL round, unlike FedAWS and FedALC. FedALC reduces the data volume of communication for the client to a lesser extent compared with the server. This is because, under FedALC and FedAWS, the client only transmits the class embedding vector of the specified label, while the server must transmit the class embedding matrix for all labels. The most substantial reduction in data volume is observed in the COCO task, attributed to its larger class embedding dimension (2048) compared with the dimension of 512 for other tasks. Consequently, we can draw a conclusion that when the dimension of the class embedding vector is large, the proposed FedALC-fixed effectively reduces the communication cost for the client.</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Precision@1,3,5(<math id="S5.T5.3.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T5.3.m1.1b"><mo id="S5.T5.3.m1.1.1" xref="S5.T5.3.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T5.3.m1.1c"><csymbol cd="latexml" id="S5.T5.3.m1.1.1.cmml" xref="S5.T5.3.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.m1.1d">\%</annotation></semantics></math>) with <math id="S5.T5.4.m2.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="S5.T5.4.m2.1b"><mrow id="S5.T5.4.m2.1.1" xref="S5.T5.4.m2.1.1.cmml"><mi id="S5.T5.4.m2.1.1.2" xref="S5.T5.4.m2.1.1.2.cmml">K</mi><mo id="S5.T5.4.m2.1.1.1" xref="S5.T5.4.m2.1.1.1.cmml">=</mo><mn id="S5.T5.4.m2.1.1.3" xref="S5.T5.4.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T5.4.m2.1c"><apply id="S5.T5.4.m2.1.1.cmml" xref="S5.T5.4.m2.1.1"><eq id="S5.T5.4.m2.1.1.1.cmml" xref="S5.T5.4.m2.1.1.1"></eq><ci id="S5.T5.4.m2.1.1.2.cmml" xref="S5.T5.4.m2.1.1.2">𝐾</ci><cn type="integer" id="S5.T5.4.m2.1.1.3.cmml" xref="S5.T5.4.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.m2.1d">K=10</annotation></semantics></math> on EURlex.</figcaption>
<table id="S5.T5.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T5.5.1" class="ltx_tr">
<th id="S5.T5.5.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">Method</th>
<td id="S5.T5.5.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;"><math id="S5.T5.5.1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.T5.5.1.1.m1.1a"><mi id="S5.T5.5.1.1.m1.1.1" xref="S5.T5.5.1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.T5.5.1.1.m1.1b"><ci id="S5.T5.5.1.1.m1.1.1.cmml" xref="S5.T5.5.1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.5.1.1.m1.1c">\lambda</annotation></semantics></math></td>
<td id="S5.T5.5.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">P@1</td>
<td id="S5.T5.5.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">P@3</td>
<td id="S5.T5.5.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">P@5</td>
</tr>
<tr id="S5.T5.6.3.1" class="ltx_tr">
<th id="S5.T5.6.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">SLEEC (Oracle)</th>
<td id="S5.T5.6.3.1.2" class="ltx_td ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td id="S5.T5.6.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">63.40</td>
<td id="S5.T5.6.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">50.35</td>
<td id="S5.T5.6.3.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">41.28</td>
</tr>
<tr id="S5.T5.6.4.2" class="ltx_tr">
<th id="S5.T5.6.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;">FLAG</th>
<td id="S5.T5.6.4.2.2" class="ltx_td" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td id="S5.T5.6.4.2.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">28.50</td>
<td id="S5.T5.6.4.2.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">20.66</td>
<td id="S5.T5.6.4.2.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">17.87</td>
</tr>
<tr id="S5.T5.6.5.3" class="ltx_tr">
<th id="S5.T5.6.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;">FedMLH</th>
<td id="S5.T5.6.5.3.2" class="ltx_td" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td id="S5.T5.6.5.3.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">29.01</td>
<td id="S5.T5.6.5.3.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">21.74</td>
<td id="S5.T5.6.5.3.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">17.64</td>
</tr>
<tr id="S5.T5.6.6.4" class="ltx_tr">
<th id="S5.T5.6.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;">FedAvg</th>
<td id="S5.T5.6.6.4.2" class="ltx_td" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td id="S5.T5.6.6.4.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">29.61</td>
<td id="S5.T5.6.6.4.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">21.85</td>
<td id="S5.T5.6.6.4.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">17.95</td>
</tr>
<tr id="S5.T5.6.2" class="ltx_tr">
<th id="S5.T5.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" colspan="5"><math id="S5.T5.6.2.1.m1.1" class="ltx_Math" alttext="\mathbf{K=10}" display="inline"><semantics id="S5.T5.6.2.1.m1.1a"><mrow id="S5.T5.6.2.1.m1.1.1" xref="S5.T5.6.2.1.m1.1.1.cmml"><mi id="S5.T5.6.2.1.m1.1.1.2" xref="S5.T5.6.2.1.m1.1.1.2.cmml">𝐊</mi><mo id="S5.T5.6.2.1.m1.1.1.1" xref="S5.T5.6.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.T5.6.2.1.m1.1.1.3" xref="S5.T5.6.2.1.m1.1.1.3.cmml">𝟏𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T5.6.2.1.m1.1b"><apply id="S5.T5.6.2.1.m1.1.1.cmml" xref="S5.T5.6.2.1.m1.1.1"><eq id="S5.T5.6.2.1.m1.1.1.1.cmml" xref="S5.T5.6.2.1.m1.1.1.1"></eq><ci id="S5.T5.6.2.1.m1.1.1.2.cmml" xref="S5.T5.6.2.1.m1.1.1.2">𝐊</ci><cn type="integer" id="S5.T5.6.2.1.m1.1.1.3.cmml" xref="S5.T5.6.2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.6.2.1.m1.1c">\mathbf{K=10}</annotation></semantics></math></th>
</tr>
<tr id="S5.T5.6.7.5" class="ltx_tr">
<th id="S5.T5.6.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" rowspan="6"><span id="S5.T5.6.7.5.1.1" class="ltx_text">FedAwS</span></th>
<td id="S5.T5.6.7.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">1</td>
<td id="S5.T5.6.7.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">46.25</td>
<td id="S5.T5.6.7.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">32.94</td>
<td id="S5.T5.6.7.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">27.01</td>
</tr>
<tr id="S5.T5.6.8.6" class="ltx_tr">
<td id="S5.T5.6.8.6.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">10</td>
<td id="S5.T5.6.8.6.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">49.92</td>
<td id="S5.T5.6.8.6.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">36.65</td>
<td id="S5.T5.6.8.6.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">29.94</td>
</tr>
<tr id="S5.T5.6.9.7" class="ltx_tr">
<td id="S5.T5.6.9.7.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">100</td>
<td id="S5.T5.6.9.7.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">47.05</td>
<td id="S5.T5.6.9.7.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">34.65</td>
<td id="S5.T5.6.9.7.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">27.16</td>
</tr>
<tr id="S5.T5.6.10.8" class="ltx_tr">
<td id="S5.T5.6.10.8.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">150</td>
<td id="S5.T5.6.10.8.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">44.07</td>
<td id="S5.T5.6.10.8.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">31.39</td>
<td id="S5.T5.6.10.8.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">25.76</td>
</tr>
<tr id="S5.T5.6.11.9" class="ltx_tr">
<td id="S5.T5.6.11.9.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">200</td>
<td id="S5.T5.6.11.9.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">40.04</td>
<td id="S5.T5.6.11.9.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">28.64</td>
<td id="S5.T5.6.11.9.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">23.61</td>
</tr>
<tr id="S5.T5.6.12.10" class="ltx_tr">
<td id="S5.T5.6.12.10.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">500</td>
<td id="S5.T5.6.12.10.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">38.37</td>
<td id="S5.T5.6.12.10.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">27.14</td>
<td id="S5.T5.6.12.10.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">22.48</td>
</tr>
<tr id="S5.T5.6.13.11" class="ltx_tr">
<th id="S5.T5.6.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" rowspan="6"><span id="S5.T5.6.13.11.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></th>
<td id="S5.T5.6.13.11.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">1</td>
<td id="S5.T5.6.13.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T5.6.13.11.3.1" class="ltx_text ltx_font_bold">54.37</span></td>
<td id="S5.T5.6.13.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T5.6.13.11.4.1" class="ltx_text ltx_font_bold">38.68</span></td>
<td id="S5.T5.6.13.11.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T5.6.13.11.5.1" class="ltx_text ltx_font_bold">31.99</span></td>
</tr>
<tr id="S5.T5.6.14.12" class="ltx_tr">
<td id="S5.T5.6.14.12.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">10</td>
<td id="S5.T5.6.14.12.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">54.06</td>
<td id="S5.T5.6.14.12.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">38.44</td>
<td id="S5.T5.6.14.12.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">31.79</td>
</tr>
<tr id="S5.T5.6.15.13" class="ltx_tr">
<td id="S5.T5.6.15.13.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">100</td>
<td id="S5.T5.6.15.13.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">52.05</td>
<td id="S5.T5.6.15.13.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">37.18</td>
<td id="S5.T5.6.15.13.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">30.86</td>
</tr>
<tr id="S5.T5.6.16.14" class="ltx_tr">
<td id="S5.T5.6.16.14.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">150</td>
<td id="S5.T5.6.16.14.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">50.54</td>
<td id="S5.T5.6.16.14.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">36.01</td>
<td id="S5.T5.6.16.14.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">29.93</td>
</tr>
<tr id="S5.T5.6.17.15" class="ltx_tr">
<td id="S5.T5.6.17.15.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">200</td>
<td id="S5.T5.6.17.15.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">50.04</td>
<td id="S5.T5.6.17.15.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">35.42</td>
<td id="S5.T5.6.17.15.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">29.27</td>
</tr>
<tr id="S5.T5.6.18.16" class="ltx_tr">
<td id="S5.T5.6.18.16.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;">500</td>
<td id="S5.T5.6.18.16.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;">47.66</td>
<td id="S5.T5.6.18.16.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;">34.22</td>
<td id="S5.T5.6.18.16.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;">28.25</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Precision@1,3,5(<math id="S5.T6.3.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T6.3.m1.1b"><mo id="S5.T6.3.m1.1.1" xref="S5.T6.3.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T6.3.m1.1c"><csymbol cd="latexml" id="S5.T6.3.m1.1.1.cmml" xref="S5.T6.3.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.3.m1.1d">\%</annotation></semantics></math>) with <math id="S5.T6.4.m2.1" class="ltx_Math" alttext="K=5" display="inline"><semantics id="S5.T6.4.m2.1b"><mrow id="S5.T6.4.m2.1.1" xref="S5.T6.4.m2.1.1.cmml"><mi id="S5.T6.4.m2.1.1.2" xref="S5.T6.4.m2.1.1.2.cmml">K</mi><mo id="S5.T6.4.m2.1.1.1" xref="S5.T6.4.m2.1.1.1.cmml">=</mo><mn id="S5.T6.4.m2.1.1.3" xref="S5.T6.4.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.4.m2.1c"><apply id="S5.T6.4.m2.1.1.cmml" xref="S5.T6.4.m2.1.1"><eq id="S5.T6.4.m2.1.1.1.cmml" xref="S5.T6.4.m2.1.1.1"></eq><ci id="S5.T6.4.m2.1.1.2.cmml" xref="S5.T6.4.m2.1.1.2">𝐾</ci><cn type="integer" id="S5.T6.4.m2.1.1.3.cmml" xref="S5.T6.4.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.4.m2.1d">K=5</annotation></semantics></math> on Bibtex.</figcaption>
<table id="S5.T6.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T6.5.1" class="ltx_tr">
<th id="S5.T6.5.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">Method</th>
<td id="S5.T6.5.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;"><math id="S5.T6.5.1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.T6.5.1.1.m1.1a"><mi id="S5.T6.5.1.1.m1.1.1" xref="S5.T6.5.1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.T6.5.1.1.m1.1b"><ci id="S5.T6.5.1.1.m1.1.1.cmml" xref="S5.T6.5.1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.5.1.1.m1.1c">\lambda</annotation></semantics></math></td>
<td id="S5.T6.5.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">P@1</td>
<td id="S5.T6.5.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">P@3</td>
<td id="S5.T6.5.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:14.2pt;padding-right:14.2pt;">P@5</td>
</tr>
<tr id="S5.T6.6.3.1" class="ltx_tr">
<th id="S5.T6.6.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">SLEEC (Oracle)</th>
<td id="S5.T6.6.3.1.2" class="ltx_td ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td id="S5.T6.6.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">65.08</td>
<td id="S5.T6.6.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">39.64</td>
<td id="S5.T6.6.3.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">28.87</td>
</tr>
<tr id="S5.T6.6.4.2" class="ltx_tr">
<th id="S5.T6.6.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;">FLAG</th>
<td id="S5.T6.6.4.2.2" class="ltx_td" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td id="S5.T6.6.4.2.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">11.43</td>
<td id="S5.T6.6.4.2.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">9.08</td>
<td id="S5.T6.6.4.2.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">7.36</td>
</tr>
<tr id="S5.T6.6.5.3" class="ltx_tr">
<th id="S5.T6.6.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;">FedMLH</th>
<td id="S5.T6.6.5.3.2" class="ltx_td" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td id="S5.T6.6.5.3.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">11.14</td>
<td id="S5.T6.6.5.3.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">8.91</td>
<td id="S5.T6.6.5.3.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">7.47</td>
</tr>
<tr id="S5.T6.6.6.4" class="ltx_tr">
<th id="S5.T6.6.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;">FedAvg</th>
<td id="S5.T6.6.6.4.2" class="ltx_td" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td id="S5.T6.6.6.4.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">11.6</td>
<td id="S5.T6.6.6.4.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">9.11</td>
<td id="S5.T6.6.6.4.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">7.84</td>
</tr>
<tr id="S5.T6.6.2" class="ltx_tr">
<th id="S5.T6.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" colspan="5"><math id="S5.T6.6.2.1.m1.1" class="ltx_Math" alttext="\mathbf{K=5}" display="inline"><semantics id="S5.T6.6.2.1.m1.1a"><mrow id="S5.T6.6.2.1.m1.1.1" xref="S5.T6.6.2.1.m1.1.1.cmml"><mi id="S5.T6.6.2.1.m1.1.1.2" xref="S5.T6.6.2.1.m1.1.1.2.cmml">𝐊</mi><mo id="S5.T6.6.2.1.m1.1.1.1" xref="S5.T6.6.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.T6.6.2.1.m1.1.1.3" xref="S5.T6.6.2.1.m1.1.1.3.cmml">𝟓</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T6.6.2.1.m1.1b"><apply id="S5.T6.6.2.1.m1.1.1.cmml" xref="S5.T6.6.2.1.m1.1.1"><eq id="S5.T6.6.2.1.m1.1.1.1.cmml" xref="S5.T6.6.2.1.m1.1.1.1"></eq><ci id="S5.T6.6.2.1.m1.1.1.2.cmml" xref="S5.T6.6.2.1.m1.1.1.2">𝐊</ci><cn type="integer" id="S5.T6.6.2.1.m1.1.1.3.cmml" xref="S5.T6.6.2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T6.6.2.1.m1.1c">\mathbf{K=5}</annotation></semantics></math></th>
</tr>
<tr id="S5.T6.6.7.5" class="ltx_tr">
<th id="S5.T6.6.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" rowspan="3"><span id="S5.T6.6.7.5.1.1" class="ltx_text">FedAwS</span></th>
<td id="S5.T6.6.7.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">1</td>
<td id="S5.T6.6.7.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">16.42</td>
<td id="S5.T6.6.7.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">11.91</td>
<td id="S5.T6.6.7.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">10.45</td>
</tr>
<tr id="S5.T6.6.8.6" class="ltx_tr">
<td id="S5.T6.6.8.6.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">10</td>
<td id="S5.T6.6.8.6.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">26.79</td>
<td id="S5.T6.6.8.6.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">18.05</td>
<td id="S5.T6.6.8.6.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">14.58</td>
</tr>
<tr id="S5.T6.6.9.7" class="ltx_tr">
<td id="S5.T6.6.9.7.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">100</td>
<td id="S5.T6.6.9.7.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">48.31</td>
<td id="S5.T6.6.9.7.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">30.85</td>
<td id="S5.T6.6.9.7.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">23.66</td>
</tr>
<tr id="S5.T6.6.10.8" class="ltx_tr">
<th id="S5.T6.6.10.8.1" class="ltx_td ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;"></th>
<td id="S5.T6.6.10.8.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">150</td>
<td id="S5.T6.6.10.8.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">48.42</td>
<td id="S5.T6.6.10.8.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">30.78</td>
<td id="S5.T6.6.10.8.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">23.42</td>
</tr>
<tr id="S5.T6.6.11.9" class="ltx_tr">
<th id="S5.T6.6.11.9.1" class="ltx_td ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;"></th>
<td id="S5.T6.6.11.9.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">200</td>
<td id="S5.T6.6.11.9.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">49.22</td>
<td id="S5.T6.6.11.9.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">30.74</td>
<td id="S5.T6.6.11.9.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">23.11</td>
</tr>
<tr id="S5.T6.6.12.10" class="ltx_tr">
<th id="S5.T6.6.12.10.1" class="ltx_td ltx_th ltx_th_row ltx_border_r" style="padding-left:14.2pt;padding-right:14.2pt;"></th>
<td id="S5.T6.6.12.10.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">500</td>
<td id="S5.T6.6.12.10.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">45.65</td>
<td id="S5.T6.6.12.10.4" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">28.09</td>
<td id="S5.T6.6.12.10.5" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">21.43</td>
</tr>
<tr id="S5.T6.6.13.11" class="ltx_tr">
<th id="S5.T6.6.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;" rowspan="6"><span id="S5.T6.6.13.11.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></th>
<td id="S5.T6.6.13.11.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">1</td>
<td id="S5.T6.6.13.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">58.72</td>
<td id="S5.T6.6.13.11.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">35.83</td>
<td id="S5.T6.6.13.11.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:14.2pt;padding-right:14.2pt;">26.62</td>
</tr>
<tr id="S5.T6.6.14.12" class="ltx_tr">
<td id="S5.T6.6.14.12.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">10</td>
<td id="S5.T6.6.14.12.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T6.6.14.12.2.1" class="ltx_text ltx_font_bold">59.67</span></td>
<td id="S5.T6.6.14.12.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T6.6.14.12.3.1" class="ltx_text ltx_font_bold">36.04</span></td>
<td id="S5.T6.6.14.12.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;"><span id="S5.T6.6.14.12.4.1" class="ltx_text ltx_font_bold">27.18</span></td>
</tr>
<tr id="S5.T6.6.15.13" class="ltx_tr">
<td id="S5.T6.6.15.13.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">100</td>
<td id="S5.T6.6.15.13.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">59.31</td>
<td id="S5.T6.6.15.13.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">34.86</td>
<td id="S5.T6.6.15.13.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">26.35</td>
</tr>
<tr id="S5.T6.6.16.14" class="ltx_tr">
<td id="S5.T6.6.16.14.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">150</td>
<td id="S5.T6.6.16.14.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">55.16</td>
<td id="S5.T6.6.16.14.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">33.27</td>
<td id="S5.T6.6.16.14.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">25.97</td>
</tr>
<tr id="S5.T6.6.17.15" class="ltx_tr">
<td id="S5.T6.6.17.15.1" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">200</td>
<td id="S5.T6.6.17.15.2" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">48.68</td>
<td id="S5.T6.6.17.15.3" class="ltx_td ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">29.18</td>
<td id="S5.T6.6.17.15.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:14.2pt;padding-right:14.2pt;">22.64</td>
</tr>
<tr id="S5.T6.6.18.16" class="ltx_tr">
<td id="S5.T6.6.18.16.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;">500</td>
<td id="S5.T6.6.18.16.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;">40.15</td>
<td id="S5.T6.6.18.16.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;">24.31</td>
<td id="S5.T6.6.18.16.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:14.2pt;padding-right:14.2pt;">18.86</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T7" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VII: </span>Precision@1,3,5(<math id="S5.T7.3.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T7.3.m1.1b"><mo id="S5.T7.3.m1.1.1" xref="S5.T7.3.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T7.3.m1.1c"><csymbol cd="latexml" id="S5.T7.3.m1.1.1.cmml" xref="S5.T7.3.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.3.m1.1d">\%</annotation></semantics></math>) with <math id="S5.T7.4.m2.1" class="ltx_Math" alttext="K=50" display="inline"><semantics id="S5.T7.4.m2.1b"><mrow id="S5.T7.4.m2.1.1" xref="S5.T7.4.m2.1.1.cmml"><mi id="S5.T7.4.m2.1.1.2" xref="S5.T7.4.m2.1.1.2.cmml">K</mi><mo id="S5.T7.4.m2.1.1.1" xref="S5.T7.4.m2.1.1.1.cmml">=</mo><mn id="S5.T7.4.m2.1.1.3" xref="S5.T7.4.m2.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T7.4.m2.1c"><apply id="S5.T7.4.m2.1.1.cmml" xref="S5.T7.4.m2.1.1"><eq id="S5.T7.4.m2.1.1.1.cmml" xref="S5.T7.4.m2.1.1.1"></eq><ci id="S5.T7.4.m2.1.1.2.cmml" xref="S5.T7.4.m2.1.1.2">𝐾</ci><cn type="integer" id="S5.T7.4.m2.1.1.3.cmml" xref="S5.T7.4.m2.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T7.4.m2.1d">K=50</annotation></semantics></math> on 
<br class="ltx_break">AmazonCat, Amazon670K, WikiLSHTC.</figcaption>
<table id="S5.T7.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T7.5.1.1" class="ltx_tr">
<th id="S5.T7.5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" style="padding-left:21.1pt;padding-right:21.1pt;" colspan="4">       AmazonCat</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T7.5.2.1" class="ltx_tr">
<th id="S5.T7.5.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       Method</th>
<td id="S5.T7.5.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       P@1</td>
<td id="S5.T7.5.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       P@3</td>
<td id="S5.T7.5.2.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       P@5</td>
</tr>
<tr id="S5.T7.5.3.2" class="ltx_tr">
<th id="S5.T7.5.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       SLEEC (Oracle)</th>
<td id="S5.T7.5.3.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       90.50</td>
<td id="S5.T7.5.3.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       76.31</td>
<td id="S5.T7.5.3.2.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       61.50</td>
</tr>
<tr id="S5.T7.5.4.3" class="ltx_tr">
<th id="S5.T7.5.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FLAG</th>
<td id="S5.T7.5.4.3.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       59.51</td>
<td id="S5.T7.5.4.3.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       40.62</td>
<td id="S5.T7.5.4.3.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       30.90</td>
</tr>
<tr id="S5.T7.5.5.4" class="ltx_tr">
<th id="S5.T7.5.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedMLH</th>
<td id="S5.T7.5.5.4.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       57.83</td>
<td id="S5.T7.5.5.4.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       39.39</td>
<td id="S5.T7.5.5.4.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       28.24</td>
</tr>
<tr id="S5.T7.5.6.5" class="ltx_tr">
<th id="S5.T7.5.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedAvg</th>
<td id="S5.T7.5.6.5.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       59.31</td>
<td id="S5.T7.5.6.5.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       41.19</td>
<td id="S5.T7.5.6.5.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       29.83</td>
</tr>
<tr id="S5.T7.5.7.6" class="ltx_tr">
<th id="S5.T7.5.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedAwS</th>
<td id="S5.T7.5.7.6.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       85.40</td>
<td id="S5.T7.5.7.6.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       65.60</td>
<td id="S5.T7.5.7.6.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       48.12</td>
</tr>
<tr id="S5.T7.5.8.7" class="ltx_tr">
<th id="S5.T7.5.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.8.7.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></th>
<td id="S5.T7.5.8.7.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.8.7.2.1" class="ltx_text ltx_font_bold">86.92</span></td>
<td id="S5.T7.5.8.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.8.7.3.1" class="ltx_text ltx_font_bold">66.68</span></td>
<td id="S5.T7.5.8.7.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.8.7.4.1" class="ltx_text ltx_font_bold">48.92</span>
</td>
</tr>
<tr id="S5.T7.5.9.8" class="ltx_tr">
<th id="S5.T7.5.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;" colspan="4">       Amazon670K</th>
</tr>
<tr id="S5.T7.5.10.9" class="ltx_tr">
<th id="S5.T7.5.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       SLEEC (Oracle)</th>
<td id="S5.T7.5.10.9.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       35.11</td>
<td id="S5.T7.5.10.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       31.33</td>
<td id="S5.T7.5.10.9.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       28.58</td>
</tr>
<tr id="S5.T7.5.11.10" class="ltx_tr">
<th id="S5.T7.5.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FLAG</th>
<td id="S5.T7.5.11.10.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       2.98</td>
<td id="S5.T7.5.11.10.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       1.81</td>
<td id="S5.T7.5.11.10.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       1.41</td>
</tr>
<tr id="S5.T7.5.12.11" class="ltx_tr">
<th id="S5.T7.5.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedMLH</th>
<td id="S5.T7.5.12.11.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       3.21</td>
<td id="S5.T7.5.12.11.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       1.91</td>
<td id="S5.T7.5.12.11.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       1.52</td>
</tr>
<tr id="S5.T7.5.13.12" class="ltx_tr">
<th id="S5.T7.5.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedAvg</th>
<td id="S5.T7.5.13.12.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       3.10</td>
<td id="S5.T7.5.13.12.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       2.04</td>
<td id="S5.T7.5.13.12.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       1.68</td>
</tr>
<tr id="S5.T7.5.14.13" class="ltx_tr">
<th id="S5.T7.5.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedAwS</th>
<td id="S5.T7.5.14.13.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.14.13.2.1" class="ltx_text ltx_font_bold">31.61</span></td>
<td id="S5.T7.5.14.13.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       28.22</td>
<td id="S5.T7.5.14.13.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       24.89</td>
</tr>
<tr id="S5.T7.5.15.14" class="ltx_tr">
<th id="S5.T7.5.15.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.15.14.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></th>
<td id="S5.T7.5.15.14.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       31.22</td>
<td id="S5.T7.5.15.14.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.15.14.3.1" class="ltx_text ltx_font_bold">28.43</span></td>
<td id="S5.T7.5.15.14.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.15.14.4.1" class="ltx_text ltx_font_bold">25.30</span>
</td>
</tr>
<tr id="S5.T7.5.16.15" class="ltx_tr">
<th id="S5.T7.5.16.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;" colspan="4">       WikiLSHTC</th>
</tr>
<tr id="S5.T7.5.17.16" class="ltx_tr">
<th id="S5.T7.5.17.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       SLEEC (Oracle)</th>
<td id="S5.T7.5.17.16.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       54.81</td>
<td id="S5.T7.5.17.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       33.41</td>
<td id="S5.T7.5.17.16.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       23.92</td>
</tr>
<tr id="S5.T7.5.18.17" class="ltx_tr">
<th id="S5.T7.5.18.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FLAG</th>
<td id="S5.T7.5.18.17.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       6.32</td>
<td id="S5.T7.5.18.17.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       2.83</td>
<td id="S5.T7.5.18.17.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       1.74</td>
</tr>
<tr id="S5.T7.5.19.18" class="ltx_tr">
<th id="S5.T7.5.19.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedMLH</th>
<td id="S5.T7.5.19.18.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       6.22</td>
<td id="S5.T7.5.19.18.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       2.69</td>
<td id="S5.T7.5.19.18.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       1.91</td>
</tr>
<tr id="S5.T7.5.20.19" class="ltx_tr">
<th id="S5.T7.5.20.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedAvg</th>
<td id="S5.T7.5.20.19.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       6.43</td>
<td id="S5.T7.5.20.19.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       2.75</td>
<td id="S5.T7.5.20.19.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       1.86</td>
</tr>
<tr id="S5.T7.5.21.20" class="ltx_tr">
<th id="S5.T7.5.21.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:21.1pt;padding-right:21.1pt;">       FedAwS</th>
<td id="S5.T7.5.21.20.2" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       36.28</td>
<td id="S5.T7.5.21.20.3" class="ltx_td ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       21.87</td>
<td id="S5.T7.5.21.20.4" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:21.1pt;padding-right:21.1pt;">       14.80</td>
</tr>
<tr id="S5.T7.5.22.21" class="ltx_tr">
<th id="S5.T7.5.22.21.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.22.21.1.1" class="ltx_text ltx_font_bold">FedALC (Our)</span></th>
<td id="S5.T7.5.22.21.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.22.21.2.1" class="ltx_text ltx_font_bold">36.54</span></td>
<td id="S5.T7.5.22.21.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.22.21.3.1" class="ltx_text ltx_font_bold">22.09</span></td>
<td id="S5.T7.5.22.21.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:21.1pt;padding-right:21.1pt;">       <span id="S5.T7.5.22.21.4.1" class="ltx_text ltx_font_bold">15.17</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2404.15598/assets/x5.png" id="S5.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="528" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Performance (<math id="S5.F6.3.m1.1" class="ltx_Math" alttext="P@k" display="inline"><semantics id="S5.F6.3.m1.1b"><mrow id="S5.F6.3.m1.1.1" xref="S5.F6.3.m1.1.1.cmml"><mi id="S5.F6.3.m1.1.1.2" xref="S5.F6.3.m1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.F6.3.m1.1.1.1" xref="S5.F6.3.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.F6.3.m1.1.1.3" xref="S5.F6.3.m1.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.F6.3.m1.1.1.1b" xref="S5.F6.3.m1.1.1.1.cmml">​</mo><mi id="S5.F6.3.m1.1.1.4" xref="S5.F6.3.m1.1.1.4.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.3.m1.1c"><apply id="S5.F6.3.m1.1.1.cmml" xref="S5.F6.3.m1.1.1"><times id="S5.F6.3.m1.1.1.1.cmml" xref="S5.F6.3.m1.1.1.1"></times><ci id="S5.F6.3.m1.1.1.2.cmml" xref="S5.F6.3.m1.1.1.2">𝑃</ci><ci id="S5.F6.3.m1.1.1.3.cmml" xref="S5.F6.3.m1.1.1.3">@</ci><ci id="S5.F6.3.m1.1.1.4.cmml" xref="S5.F6.3.m1.1.1.4">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.3.m1.1d">P@k</annotation></semantics></math>) comparison of FedALC-fixed and FedAvg-fixed, FedAvg on the EURlex and Bibtex datasets.</figcaption>
</figure>
</section>
<section id="S5.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS7.4.1.1" class="ltx_text">V-G</span> </span><span id="S5.SS7.5.2" class="ltx_text ltx_font_italic">Experiments on extreme multi-label text datasets</span>
</h3>

<div id="S5.SS7.p1" class="ltx_para">
<p id="S5.SS7.p1.3" class="ltx_p">The overall results on EURlex are reported in Table <a href="#S5.T5" title="TABLE V ‣ V-F Experiments on multi-label image datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> and Fig. <a href="#S5.F6" title="Figure 6 ‣ V-F Experiments on multi-label image datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(a), the results on AmazonCat, WikiLSHTC and Amazon670K are summarized in Table <a href="#S5.T7" title="TABLE VII ‣ V-F Experiments on multi-label image datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>, and the results on Bibtex are shown in Table <a href="#S5.T6" title="TABLE VI ‣ V-F Experiments on multi-label image datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a> and Fig. <a href="#S5.F6" title="Figure 6 ‣ V-F Experiments on multi-label image datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(b). In particular, the learning curves of our FedALC and the most competitive FedAwS under different <math id="S5.SS7.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS7.p1.1.m1.1a"><mi id="S5.SS7.p1.1.m1.1.1" xref="S5.SS7.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS7.p1.1.m1.1b"><ci id="S5.SS7.p1.1.m1.1.1.cmml" xref="S5.SS7.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p1.1.m1.1c">\lambda</annotation></semantics></math> in terms of <math id="S5.SS7.p1.2.m2.1" class="ltx_Math" alttext="P@1" display="inline"><semantics id="S5.SS7.p1.2.m2.1a"><mrow id="S5.SS7.p1.2.m2.1.1" xref="S5.SS7.p1.2.m2.1.1.cmml"><mi id="S5.SS7.p1.2.m2.1.1.2" xref="S5.SS7.p1.2.m2.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p1.2.m2.1.1.1" xref="S5.SS7.p1.2.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p1.2.m2.1.1.3" xref="S5.SS7.p1.2.m2.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p1.2.m2.1.1.1a" xref="S5.SS7.p1.2.m2.1.1.1.cmml">​</mo><mn id="S5.SS7.p1.2.m2.1.1.4" xref="S5.SS7.p1.2.m2.1.1.4.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p1.2.m2.1b"><apply id="S5.SS7.p1.2.m2.1.1.cmml" xref="S5.SS7.p1.2.m2.1.1"><times id="S5.SS7.p1.2.m2.1.1.1.cmml" xref="S5.SS7.p1.2.m2.1.1.1"></times><ci id="S5.SS7.p1.2.m2.1.1.2.cmml" xref="S5.SS7.p1.2.m2.1.1.2">𝑃</ci><ci id="S5.SS7.p1.2.m2.1.1.3.cmml" xref="S5.SS7.p1.2.m2.1.1.3">@</ci><cn type="integer" id="S5.SS7.p1.2.m2.1.1.4.cmml" xref="S5.SS7.p1.2.m2.1.1.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p1.2.m2.1c">P@1</annotation></semantics></math> on the Eurlex dataset are shown in Fig. <a href="#S5.F7" title="Figure 7 ‣ V-G Experiments on extreme multi-label text datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, and the corresponding results in terms of precision at different <math id="S5.SS7.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS7.p1.3.m3.1a"><mi id="S5.SS7.p1.3.m3.1.1" xref="S5.SS7.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS7.p1.3.m3.1b"><ci id="S5.SS7.p1.3.m3.1.1.cmml" xref="S5.SS7.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p1.3.m3.1c">k</annotation></semantics></math> are shown in Fig. <a href="#S5.F8" title="Figure 8 ‣ V-G Experiments on extreme multi-label text datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2404.15598/assets/x6.png" id="S5.F7.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="461" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>A comparison of our FedALC and the FedAwS counterpart under different hyper-parameter settings for <math id="S5.F7.6.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.F7.6.m1.1b"><mi id="S5.F7.6.m1.1.1" xref="S5.F7.6.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F7.6.m1.1c"><ci id="S5.F7.6.m1.1.1.cmml" xref="S5.F7.6.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.6.m1.1d">\lambda</annotation></semantics></math> (e.g., “_100” indicates <math id="S5.F7.7.m2.1" class="ltx_Math" alttext="\lambda=100" display="inline"><semantics id="S5.F7.7.m2.1b"><mrow id="S5.F7.7.m2.1.1" xref="S5.F7.7.m2.1.1.cmml"><mi id="S5.F7.7.m2.1.1.2" xref="S5.F7.7.m2.1.1.2.cmml">λ</mi><mo id="S5.F7.7.m2.1.1.1" xref="S5.F7.7.m2.1.1.1.cmml">=</mo><mn id="S5.F7.7.m2.1.1.3" xref="S5.F7.7.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.7.m2.1c"><apply id="S5.F7.7.m2.1.1.cmml" xref="S5.F7.7.m2.1.1"><eq id="S5.F7.7.m2.1.1.1.cmml" xref="S5.F7.7.m2.1.1.1"></eq><ci id="S5.F7.7.m2.1.1.2.cmml" xref="S5.F7.7.m2.1.1.2">𝜆</ci><cn type="integer" id="S5.F7.7.m2.1.1.3.cmml" xref="S5.F7.7.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.7.m2.1d">\lambda=100</annotation></semantics></math>) in terms of P@1(<math id="S5.F7.8.m3.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.F7.8.m3.1b"><mo id="S5.F7.8.m3.1.1" xref="S5.F7.8.m3.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.F7.8.m3.1c"><csymbol cd="latexml" id="S5.F7.8.m3.1.1.cmml" xref="S5.F7.8.m3.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.8.m3.1d">\%</annotation></semantics></math>) with <math id="S5.F7.9.m4.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="S5.F7.9.m4.1b"><mrow id="S5.F7.9.m4.1.1" xref="S5.F7.9.m4.1.1.cmml"><mi id="S5.F7.9.m4.1.1.2" xref="S5.F7.9.m4.1.1.2.cmml">K</mi><mo id="S5.F7.9.m4.1.1.1" xref="S5.F7.9.m4.1.1.1.cmml">=</mo><mn id="S5.F7.9.m4.1.1.3" xref="S5.F7.9.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.9.m4.1c"><apply id="S5.F7.9.m4.1.1.cmml" xref="S5.F7.9.m4.1.1"><eq id="S5.F7.9.m4.1.1.1.cmml" xref="S5.F7.9.m4.1.1.1"></eq><ci id="S5.F7.9.m4.1.1.2.cmml" xref="S5.F7.9.m4.1.1.2">𝐾</ci><cn type="integer" id="S5.F7.9.m4.1.1.3.cmml" xref="S5.F7.9.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.9.m4.1d">K=10</annotation></semantics></math> on the EURlex dataset.</figcaption>
</figure>
<figure id="S5.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F8.sf1.6" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.2pt;">
<img src="/html/2404.15598/assets/x7.png" id="S5.F8.sf1.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x8.png" id="S5.F8.sf1.2.g2" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x9.png" id="S5.F8.sf1.3.g3" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x10.png" id="S5.F8.sf1.4.g4" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x11.png" id="S5.F8.sf1.5.g5" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x12.png" id="S5.F8.sf1.6.g6" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Precision@1,3,5 (<math id="S5.F8.sf1.9.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.F8.sf1.9.m1.1b"><mo id="S5.F8.sf1.9.m1.1.1" xref="S5.F8.sf1.9.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.F8.sf1.9.m1.1c"><csymbol cd="latexml" id="S5.F8.sf1.9.m1.1.1.cmml" xref="S5.F8.sf1.9.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.sf1.9.m1.1d">\%</annotation></semantics></math>) of FedALC on EURlex under (<math id="S5.F8.sf1.10.m2.6" class="ltx_Math" alttext="\lambda=1,10,100,150,200,500" display="inline"><semantics id="S5.F8.sf1.10.m2.6b"><mrow id="S5.F8.sf1.10.m2.6.7" xref="S5.F8.sf1.10.m2.6.7.cmml"><mi id="S5.F8.sf1.10.m2.6.7.2" xref="S5.F8.sf1.10.m2.6.7.2.cmml">λ</mi><mo id="S5.F8.sf1.10.m2.6.7.1" xref="S5.F8.sf1.10.m2.6.7.1.cmml">=</mo><mrow id="S5.F8.sf1.10.m2.6.7.3.2" xref="S5.F8.sf1.10.m2.6.7.3.1.cmml"><mn id="S5.F8.sf1.10.m2.1.1" xref="S5.F8.sf1.10.m2.1.1.cmml">1</mn><mo id="S5.F8.sf1.10.m2.6.7.3.2.1" xref="S5.F8.sf1.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf1.10.m2.2.2" xref="S5.F8.sf1.10.m2.2.2.cmml">10</mn><mo id="S5.F8.sf1.10.m2.6.7.3.2.2" xref="S5.F8.sf1.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf1.10.m2.3.3" xref="S5.F8.sf1.10.m2.3.3.cmml">100</mn><mo id="S5.F8.sf1.10.m2.6.7.3.2.3" xref="S5.F8.sf1.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf1.10.m2.4.4" xref="S5.F8.sf1.10.m2.4.4.cmml">150</mn><mo id="S5.F8.sf1.10.m2.6.7.3.2.4" xref="S5.F8.sf1.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf1.10.m2.5.5" xref="S5.F8.sf1.10.m2.5.5.cmml">200</mn><mo id="S5.F8.sf1.10.m2.6.7.3.2.5" xref="S5.F8.sf1.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf1.10.m2.6.6" xref="S5.F8.sf1.10.m2.6.6.cmml">500</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.sf1.10.m2.6c"><apply id="S5.F8.sf1.10.m2.6.7.cmml" xref="S5.F8.sf1.10.m2.6.7"><eq id="S5.F8.sf1.10.m2.6.7.1.cmml" xref="S5.F8.sf1.10.m2.6.7.1"></eq><ci id="S5.F8.sf1.10.m2.6.7.2.cmml" xref="S5.F8.sf1.10.m2.6.7.2">𝜆</ci><list id="S5.F8.sf1.10.m2.6.7.3.1.cmml" xref="S5.F8.sf1.10.m2.6.7.3.2"><cn type="integer" id="S5.F8.sf1.10.m2.1.1.cmml" xref="S5.F8.sf1.10.m2.1.1">1</cn><cn type="integer" id="S5.F8.sf1.10.m2.2.2.cmml" xref="S5.F8.sf1.10.m2.2.2">10</cn><cn type="integer" id="S5.F8.sf1.10.m2.3.3.cmml" xref="S5.F8.sf1.10.m2.3.3">100</cn><cn type="integer" id="S5.F8.sf1.10.m2.4.4.cmml" xref="S5.F8.sf1.10.m2.4.4">150</cn><cn type="integer" id="S5.F8.sf1.10.m2.5.5.cmml" xref="S5.F8.sf1.10.m2.5.5">200</cn><cn type="integer" id="S5.F8.sf1.10.m2.6.6.cmml" xref="S5.F8.sf1.10.m2.6.6">500</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.sf1.10.m2.6d">\lambda=1,10,100,150,200,500</annotation></semantics></math>) settings.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F8.sf2.6" class="ltx_block ltx_minipage ltx_align_middle" style="width:433.2pt;">
<img src="/html/2404.15598/assets/x13.png" id="S5.F8.sf2.1.g1" class="ltx_graphics ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x14.png" id="S5.F8.sf2.2.g2" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x15.png" id="S5.F8.sf2.3.g3" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x16.png" id="S5.F8.sf2.4.g4" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x17.png" id="S5.F8.sf2.5.g5" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption"><img src="/html/2404.15598/assets/x18.png" id="S5.F8.sf2.6.g6" class="ltx_graphics ltx_centering ltx_img_square" width="138" height="138" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Precision@1,3,5 (<math id="S5.F8.sf2.9.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.F8.sf2.9.m1.1b"><mo id="S5.F8.sf2.9.m1.1.1" xref="S5.F8.sf2.9.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.F8.sf2.9.m1.1c"><csymbol cd="latexml" id="S5.F8.sf2.9.m1.1.1.cmml" xref="S5.F8.sf2.9.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.sf2.9.m1.1d">\%</annotation></semantics></math>) of FedAwS on EurLex under (<math id="S5.F8.sf2.10.m2.6" class="ltx_Math" alttext="\lambda=1,10,100,150,200,500" display="inline"><semantics id="S5.F8.sf2.10.m2.6b"><mrow id="S5.F8.sf2.10.m2.6.7" xref="S5.F8.sf2.10.m2.6.7.cmml"><mi id="S5.F8.sf2.10.m2.6.7.2" xref="S5.F8.sf2.10.m2.6.7.2.cmml">λ</mi><mo id="S5.F8.sf2.10.m2.6.7.1" xref="S5.F8.sf2.10.m2.6.7.1.cmml">=</mo><mrow id="S5.F8.sf2.10.m2.6.7.3.2" xref="S5.F8.sf2.10.m2.6.7.3.1.cmml"><mn id="S5.F8.sf2.10.m2.1.1" xref="S5.F8.sf2.10.m2.1.1.cmml">1</mn><mo id="S5.F8.sf2.10.m2.6.7.3.2.1" xref="S5.F8.sf2.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf2.10.m2.2.2" xref="S5.F8.sf2.10.m2.2.2.cmml">10</mn><mo id="S5.F8.sf2.10.m2.6.7.3.2.2" xref="S5.F8.sf2.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf2.10.m2.3.3" xref="S5.F8.sf2.10.m2.3.3.cmml">100</mn><mo id="S5.F8.sf2.10.m2.6.7.3.2.3" xref="S5.F8.sf2.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf2.10.m2.4.4" xref="S5.F8.sf2.10.m2.4.4.cmml">150</mn><mo id="S5.F8.sf2.10.m2.6.7.3.2.4" xref="S5.F8.sf2.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf2.10.m2.5.5" xref="S5.F8.sf2.10.m2.5.5.cmml">200</mn><mo id="S5.F8.sf2.10.m2.6.7.3.2.5" xref="S5.F8.sf2.10.m2.6.7.3.1.cmml">,</mo><mn id="S5.F8.sf2.10.m2.6.6" xref="S5.F8.sf2.10.m2.6.6.cmml">500</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.sf2.10.m2.6c"><apply id="S5.F8.sf2.10.m2.6.7.cmml" xref="S5.F8.sf2.10.m2.6.7"><eq id="S5.F8.sf2.10.m2.6.7.1.cmml" xref="S5.F8.sf2.10.m2.6.7.1"></eq><ci id="S5.F8.sf2.10.m2.6.7.2.cmml" xref="S5.F8.sf2.10.m2.6.7.2">𝜆</ci><list id="S5.F8.sf2.10.m2.6.7.3.1.cmml" xref="S5.F8.sf2.10.m2.6.7.3.2"><cn type="integer" id="S5.F8.sf2.10.m2.1.1.cmml" xref="S5.F8.sf2.10.m2.1.1">1</cn><cn type="integer" id="S5.F8.sf2.10.m2.2.2.cmml" xref="S5.F8.sf2.10.m2.2.2">10</cn><cn type="integer" id="S5.F8.sf2.10.m2.3.3.cmml" xref="S5.F8.sf2.10.m2.3.3">100</cn><cn type="integer" id="S5.F8.sf2.10.m2.4.4.cmml" xref="S5.F8.sf2.10.m2.4.4">150</cn><cn type="integer" id="S5.F8.sf2.10.m2.5.5.cmml" xref="S5.F8.sf2.10.m2.5.5">200</cn><cn type="integer" id="S5.F8.sf2.10.m2.6.6.cmml" xref="S5.F8.sf2.10.m2.6.6">500</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.sf2.10.m2.6d">\lambda=1,10,100,150,200,500</annotation></semantics></math>) settings.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span id="S5.F8.4.2" class="ltx_text" style="font-size:90%;">A comparison of our FedALC and the FedAwS counterpart under different hyper-parameters <math id="S5.F8.3.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.F8.3.1.m1.1b"><mi id="S5.F8.3.1.m1.1.1" xref="S5.F8.3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F8.3.1.m1.1c"><ci id="S5.F8.3.1.m1.1.1.cmml" xref="S5.F8.3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.3.1.m1.1d">\lambda</annotation></semantics></math> in terms of Precision@1,3,5(%) with <math id="S5.F8.4.2.m2.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="S5.F8.4.2.m2.1b"><mrow id="S5.F8.4.2.m2.1.1" xref="S5.F8.4.2.m2.1.1.cmml"><mi id="S5.F8.4.2.m2.1.1.2" xref="S5.F8.4.2.m2.1.1.2.cmml">K</mi><mo id="S5.F8.4.2.m2.1.1.1" xref="S5.F8.4.2.m2.1.1.1.cmml">=</mo><mn id="S5.F8.4.2.m2.1.1.3" xref="S5.F8.4.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.4.2.m2.1c"><apply id="S5.F8.4.2.m2.1.1.cmml" xref="S5.F8.4.2.m2.1.1"><eq id="S5.F8.4.2.m2.1.1.1.cmml" xref="S5.F8.4.2.m2.1.1.1"></eq><ci id="S5.F8.4.2.m2.1.1.2.cmml" xref="S5.F8.4.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S5.F8.4.2.m2.1.1.3.cmml" xref="S5.F8.4.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.4.2.m2.1d">K=10</annotation></semantics></math> on the EURlex dataset.</span></figcaption>
</figure>
<div id="S5.SS7.p2" class="ltx_para">
<p id="S5.SS7.p2.9" class="ltx_p">From the results of Bibtex and EurLex, we can see that: 1) FedALC achieves higher precision <math id="S5.SS7.p2.1.m1.3" class="ltx_Math" alttext="P@1,P@3,P@5" display="inline"><semantics id="S5.SS7.p2.1.m1.3a"><mrow id="S5.SS7.p2.1.m1.3.3.3" xref="S5.SS7.p2.1.m1.3.3.4.cmml"><mrow id="S5.SS7.p2.1.m1.1.1.1.1" xref="S5.SS7.p2.1.m1.1.1.1.1.cmml"><mi id="S5.SS7.p2.1.m1.1.1.1.1.2" xref="S5.SS7.p2.1.m1.1.1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p2.1.m1.1.1.1.1.1" xref="S5.SS7.p2.1.m1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p2.1.m1.1.1.1.1.3" xref="S5.SS7.p2.1.m1.1.1.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p2.1.m1.1.1.1.1.1a" xref="S5.SS7.p2.1.m1.1.1.1.1.1.cmml">​</mo><mn id="S5.SS7.p2.1.m1.1.1.1.1.4" xref="S5.SS7.p2.1.m1.1.1.1.1.4.cmml">1</mn></mrow><mo id="S5.SS7.p2.1.m1.3.3.3.4" xref="S5.SS7.p2.1.m1.3.3.4.cmml">,</mo><mrow id="S5.SS7.p2.1.m1.2.2.2.2" xref="S5.SS7.p2.1.m1.2.2.2.2.cmml"><mi id="S5.SS7.p2.1.m1.2.2.2.2.2" xref="S5.SS7.p2.1.m1.2.2.2.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p2.1.m1.2.2.2.2.1" xref="S5.SS7.p2.1.m1.2.2.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p2.1.m1.2.2.2.2.3" xref="S5.SS7.p2.1.m1.2.2.2.2.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p2.1.m1.2.2.2.2.1a" xref="S5.SS7.p2.1.m1.2.2.2.2.1.cmml">​</mo><mn id="S5.SS7.p2.1.m1.2.2.2.2.4" xref="S5.SS7.p2.1.m1.2.2.2.2.4.cmml">3</mn></mrow><mo id="S5.SS7.p2.1.m1.3.3.3.5" xref="S5.SS7.p2.1.m1.3.3.4.cmml">,</mo><mrow id="S5.SS7.p2.1.m1.3.3.3.3" xref="S5.SS7.p2.1.m1.3.3.3.3.cmml"><mi id="S5.SS7.p2.1.m1.3.3.3.3.2" xref="S5.SS7.p2.1.m1.3.3.3.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p2.1.m1.3.3.3.3.1" xref="S5.SS7.p2.1.m1.3.3.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p2.1.m1.3.3.3.3.3" xref="S5.SS7.p2.1.m1.3.3.3.3.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p2.1.m1.3.3.3.3.1a" xref="S5.SS7.p2.1.m1.3.3.3.3.1.cmml">​</mo><mn id="S5.SS7.p2.1.m1.3.3.3.3.4" xref="S5.SS7.p2.1.m1.3.3.3.3.4.cmml">5</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.1.m1.3b"><list id="S5.SS7.p2.1.m1.3.3.4.cmml" xref="S5.SS7.p2.1.m1.3.3.3"><apply id="S5.SS7.p2.1.m1.1.1.1.1.cmml" xref="S5.SS7.p2.1.m1.1.1.1.1"><times id="S5.SS7.p2.1.m1.1.1.1.1.1.cmml" xref="S5.SS7.p2.1.m1.1.1.1.1.1"></times><ci id="S5.SS7.p2.1.m1.1.1.1.1.2.cmml" xref="S5.SS7.p2.1.m1.1.1.1.1.2">𝑃</ci><ci id="S5.SS7.p2.1.m1.1.1.1.1.3.cmml" xref="S5.SS7.p2.1.m1.1.1.1.1.3">@</ci><cn type="integer" id="S5.SS7.p2.1.m1.1.1.1.1.4.cmml" xref="S5.SS7.p2.1.m1.1.1.1.1.4">1</cn></apply><apply id="S5.SS7.p2.1.m1.2.2.2.2.cmml" xref="S5.SS7.p2.1.m1.2.2.2.2"><times id="S5.SS7.p2.1.m1.2.2.2.2.1.cmml" xref="S5.SS7.p2.1.m1.2.2.2.2.1"></times><ci id="S5.SS7.p2.1.m1.2.2.2.2.2.cmml" xref="S5.SS7.p2.1.m1.2.2.2.2.2">𝑃</ci><ci id="S5.SS7.p2.1.m1.2.2.2.2.3.cmml" xref="S5.SS7.p2.1.m1.2.2.2.2.3">@</ci><cn type="integer" id="S5.SS7.p2.1.m1.2.2.2.2.4.cmml" xref="S5.SS7.p2.1.m1.2.2.2.2.4">3</cn></apply><apply id="S5.SS7.p2.1.m1.3.3.3.3.cmml" xref="S5.SS7.p2.1.m1.3.3.3.3"><times id="S5.SS7.p2.1.m1.3.3.3.3.1.cmml" xref="S5.SS7.p2.1.m1.3.3.3.3.1"></times><ci id="S5.SS7.p2.1.m1.3.3.3.3.2.cmml" xref="S5.SS7.p2.1.m1.3.3.3.3.2">𝑃</ci><ci id="S5.SS7.p2.1.m1.3.3.3.3.3.cmml" xref="S5.SS7.p2.1.m1.3.3.3.3.3">@</ci><cn type="integer" id="S5.SS7.p2.1.m1.3.3.3.3.4.cmml" xref="S5.SS7.p2.1.m1.3.3.3.3.4">5</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.1.m1.3c">P@1,P@3,P@5</annotation></semantics></math> than FedAwS (except for <math id="S5.SS7.p2.2.m2.1" class="ltx_Math" alttext="\lambda=200" display="inline"><semantics id="S5.SS7.p2.2.m2.1a"><mrow id="S5.SS7.p2.2.m2.1.1" xref="S5.SS7.p2.2.m2.1.1.cmml"><mi id="S5.SS7.p2.2.m2.1.1.2" xref="S5.SS7.p2.2.m2.1.1.2.cmml">λ</mi><mo id="S5.SS7.p2.2.m2.1.1.1" xref="S5.SS7.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS7.p2.2.m2.1.1.3" xref="S5.SS7.p2.2.m2.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.2.m2.1b"><apply id="S5.SS7.p2.2.m2.1.1.cmml" xref="S5.SS7.p2.2.m2.1.1"><eq id="S5.SS7.p2.2.m2.1.1.1.cmml" xref="S5.SS7.p2.2.m2.1.1.1"></eq><ci id="S5.SS7.p2.2.m2.1.1.2.cmml" xref="S5.SS7.p2.2.m2.1.1.2">𝜆</ci><cn type="integer" id="S5.SS7.p2.2.m2.1.1.3.cmml" xref="S5.SS7.p2.2.m2.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.2.m2.1c">\lambda=200</annotation></semantics></math>), the best test accuracy of FedALC is achieved with <math id="S5.SS7.p2.3.m3.1" class="ltx_Math" alttext="\lambda=1" display="inline"><semantics id="S5.SS7.p2.3.m3.1a"><mrow id="S5.SS7.p2.3.m3.1.1" xref="S5.SS7.p2.3.m3.1.1.cmml"><mi id="S5.SS7.p2.3.m3.1.1.2" xref="S5.SS7.p2.3.m3.1.1.2.cmml">λ</mi><mo id="S5.SS7.p2.3.m3.1.1.1" xref="S5.SS7.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS7.p2.3.m3.1.1.3" xref="S5.SS7.p2.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.3.m3.1b"><apply id="S5.SS7.p2.3.m3.1.1.cmml" xref="S5.SS7.p2.3.m3.1.1"><eq id="S5.SS7.p2.3.m3.1.1.1.cmml" xref="S5.SS7.p2.3.m3.1.1.1"></eq><ci id="S5.SS7.p2.3.m3.1.1.2.cmml" xref="S5.SS7.p2.3.m3.1.1.2">𝜆</ci><cn type="integer" id="S5.SS7.p2.3.m3.1.1.3.cmml" xref="S5.SS7.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.3.m3.1c">\lambda=1</annotation></semantics></math> and <math id="S5.SS7.p2.4.m4.1" class="ltx_Math" alttext="\lambda=10" display="inline"><semantics id="S5.SS7.p2.4.m4.1a"><mrow id="S5.SS7.p2.4.m4.1.1" xref="S5.SS7.p2.4.m4.1.1.cmml"><mi id="S5.SS7.p2.4.m4.1.1.2" xref="S5.SS7.p2.4.m4.1.1.2.cmml">λ</mi><mo id="S5.SS7.p2.4.m4.1.1.1" xref="S5.SS7.p2.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS7.p2.4.m4.1.1.3" xref="S5.SS7.p2.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.4.m4.1b"><apply id="S5.SS7.p2.4.m4.1.1.cmml" xref="S5.SS7.p2.4.m4.1.1"><eq id="S5.SS7.p2.4.m4.1.1.1.cmml" xref="S5.SS7.p2.4.m4.1.1.1"></eq><ci id="S5.SS7.p2.4.m4.1.1.2.cmml" xref="S5.SS7.p2.4.m4.1.1.2">𝜆</ci><cn type="integer" id="S5.SS7.p2.4.m4.1.1.3.cmml" xref="S5.SS7.p2.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.4.m4.1c">\lambda=10</annotation></semantics></math> on EURlex and Bibtex and the FedAvg, FLAG and FedMLH algorithm prematurely converged and lead to relatively low accuracy because of the collapsing issue; 2) the proposed FedALC is much better than FedAvg in learning either dynamic or fixed class embeddings since our correlations regularizer can appropriately deal with the issue of collapsing; 3) compared with FedALC, FedAwS is more sensitive to the hyper-parameter <math id="S5.SS7.p2.5.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS7.p2.5.m5.1a"><mi id="S5.SS7.p2.5.m5.1.1" xref="S5.SS7.p2.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.5.m5.1b"><ci id="S5.SS7.p2.5.m5.1.1.cmml" xref="S5.SS7.p2.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.5.m5.1c">\lambda</annotation></semantics></math>. When the value of <math id="S5.SS7.p2.6.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS7.p2.6.m6.1a"><mi id="S5.SS7.p2.6.m6.1.1" xref="S5.SS7.p2.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.6.m6.1b"><ci id="S5.SS7.p2.6.m6.1.1.cmml" xref="S5.SS7.p2.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.6.m6.1c">\lambda</annotation></semantics></math> is too small, the class embeddings cannot be well separated and this leads to collapsing issue and thus low accuracy. When <math id="S5.SS7.p2.7.m7.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS7.p2.7.m7.1a"><mi id="S5.SS7.p2.7.m7.1.1" xref="S5.SS7.p2.7.m7.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.7.m7.1b"><ci id="S5.SS7.p2.7.m7.1.1.cmml" xref="S5.SS7.p2.7.m7.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.7.m7.1c">\lambda</annotation></semantics></math> is too large, the class embedding matrix is over spreadout. The instance embedding is hard to approach corresponding positive class embeddings, and hence the performance may also be poor; 4) our FedALC can balance the dispersion and closeness of positive embeddings to some degree by exploring label correlations and automatically setting the weights for different label pairs. In particular, we achieve a significant <math id="S5.SS7.p2.8.m8.1" class="ltx_Math" alttext="19.3\%" display="inline"><semantics id="S5.SS7.p2.8.m8.1a"><mrow id="S5.SS7.p2.8.m8.1.1" xref="S5.SS7.p2.8.m8.1.1.cmml"><mn id="S5.SS7.p2.8.m8.1.1.2" xref="S5.SS7.p2.8.m8.1.1.2.cmml">19.3</mn><mo id="S5.SS7.p2.8.m8.1.1.1" xref="S5.SS7.p2.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.8.m8.1b"><apply id="S5.SS7.p2.8.m8.1.1.cmml" xref="S5.SS7.p2.8.m8.1.1"><csymbol cd="latexml" id="S5.SS7.p2.8.m8.1.1.1.cmml" xref="S5.SS7.p2.8.m8.1.1.1">percent</csymbol><cn type="float" id="S5.SS7.p2.8.m8.1.1.2.cmml" xref="S5.SS7.p2.8.m8.1.1.2">19.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.8.m8.1c">19.3\%</annotation></semantics></math> relative improvement in terms of <math id="S5.SS7.p2.9.m9.1" class="ltx_Math" alttext="P@1" display="inline"><semantics id="S5.SS7.p2.9.m9.1a"><mrow id="S5.SS7.p2.9.m9.1.1" xref="S5.SS7.p2.9.m9.1.1.cmml"><mi id="S5.SS7.p2.9.m9.1.1.2" xref="S5.SS7.p2.9.m9.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p2.9.m9.1.1.1" xref="S5.SS7.p2.9.m9.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p2.9.m9.1.1.3" xref="S5.SS7.p2.9.m9.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p2.9.m9.1.1.1a" xref="S5.SS7.p2.9.m9.1.1.1.cmml">​</mo><mn id="S5.SS7.p2.9.m9.1.1.4" xref="S5.SS7.p2.9.m9.1.1.4.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.9.m9.1b"><apply id="S5.SS7.p2.9.m9.1.1.cmml" xref="S5.SS7.p2.9.m9.1.1"><times id="S5.SS7.p2.9.m9.1.1.1.cmml" xref="S5.SS7.p2.9.m9.1.1.1"></times><ci id="S5.SS7.p2.9.m9.1.1.2.cmml" xref="S5.SS7.p2.9.m9.1.1.2">𝑃</ci><ci id="S5.SS7.p2.9.m9.1.1.3.cmml" xref="S5.SS7.p2.9.m9.1.1.3">@</ci><cn type="integer" id="S5.SS7.p2.9.m9.1.1.4.cmml" xref="S5.SS7.p2.9.m9.1.1.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.9.m9.1c">P@1</annotation></semantics></math> on the Bibtex dataset. FedALC disperses the matrix by taking label correlations into consideration, highly-correlated classes would be closer than those in FedAwS, and thus instance embedding would be easier to get close to its positive class embeddings and results in larger similarity. In regard to FedAwS utilizing stochastic negative mining, the given label and most of the selected neighbors are correlated with each other. Simply making them be arbitrary spreadout is thus sub-optimal. Whereas in our FedALC, more attention is paid on dispersing the embeddings of uncorrelated labels, and hence better performance can be obtained;
 5) compared with multi-label image datasets, on EurLex and Bibtex datasets the improvement of FedALC over FedAwS are much stronger. The reason behind that is in these multi-label textual task, there are many labels are highly correlated<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and our method explores these correlations.
This further verifies the benefit of exploring the label correlations.</p>
</div>
<div id="S5.SS7.p3" class="ltx_para">
<p id="S5.SS7.p3.13" class="ltx_p">From Table <a href="#S5.T7" title="TABLE VII ‣ V-F Experiments on multi-label image datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>, for AmazonCat, Amazon670K and WikiLSHTC datasets, the situation is more complex. The baselines without considering class embedding matrix collapsing are relatively weak on all the three datasets. On AmazonCat dataset, FedALC improves <math id="S5.SS7.p3.1.m1.1" class="ltx_Math" alttext="P@1" display="inline"><semantics id="S5.SS7.p3.1.m1.1a"><mrow id="S5.SS7.p3.1.m1.1.1" xref="S5.SS7.p3.1.m1.1.1.cmml"><mi id="S5.SS7.p3.1.m1.1.1.2" xref="S5.SS7.p3.1.m1.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.1.m1.1.1.1" xref="S5.SS7.p3.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p3.1.m1.1.1.3" xref="S5.SS7.p3.1.m1.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.1.m1.1.1.1a" xref="S5.SS7.p3.1.m1.1.1.1.cmml">​</mo><mn id="S5.SS7.p3.1.m1.1.1.4" xref="S5.SS7.p3.1.m1.1.1.4.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.1.m1.1b"><apply id="S5.SS7.p3.1.m1.1.1.cmml" xref="S5.SS7.p3.1.m1.1.1"><times id="S5.SS7.p3.1.m1.1.1.1.cmml" xref="S5.SS7.p3.1.m1.1.1.1"></times><ci id="S5.SS7.p3.1.m1.1.1.2.cmml" xref="S5.SS7.p3.1.m1.1.1.2">𝑃</ci><ci id="S5.SS7.p3.1.m1.1.1.3.cmml" xref="S5.SS7.p3.1.m1.1.1.3">@</ci><cn type="integer" id="S5.SS7.p3.1.m1.1.1.4.cmml" xref="S5.SS7.p3.1.m1.1.1.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.1.m1.1c">P@1</annotation></semantics></math> (<math id="S5.SS7.p3.2.m2.1" class="ltx_Math" alttext="P@3" display="inline"><semantics id="S5.SS7.p3.2.m2.1a"><mrow id="S5.SS7.p3.2.m2.1.1" xref="S5.SS7.p3.2.m2.1.1.cmml"><mi id="S5.SS7.p3.2.m2.1.1.2" xref="S5.SS7.p3.2.m2.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.2.m2.1.1.1" xref="S5.SS7.p3.2.m2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p3.2.m2.1.1.3" xref="S5.SS7.p3.2.m2.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.2.m2.1.1.1a" xref="S5.SS7.p3.2.m2.1.1.1.cmml">​</mo><mn id="S5.SS7.p3.2.m2.1.1.4" xref="S5.SS7.p3.2.m2.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.2.m2.1b"><apply id="S5.SS7.p3.2.m2.1.1.cmml" xref="S5.SS7.p3.2.m2.1.1"><times id="S5.SS7.p3.2.m2.1.1.1.cmml" xref="S5.SS7.p3.2.m2.1.1.1"></times><ci id="S5.SS7.p3.2.m2.1.1.2.cmml" xref="S5.SS7.p3.2.m2.1.1.2">𝑃</ci><ci id="S5.SS7.p3.2.m2.1.1.3.cmml" xref="S5.SS7.p3.2.m2.1.1.3">@</ci><cn type="integer" id="S5.SS7.p3.2.m2.1.1.4.cmml" xref="S5.SS7.p3.2.m2.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.2.m2.1c">P@3</annotation></semantics></math>, <math id="S5.SS7.p3.3.m3.1" class="ltx_Math" alttext="P@5" display="inline"><semantics id="S5.SS7.p3.3.m3.1a"><mrow id="S5.SS7.p3.3.m3.1.1" xref="S5.SS7.p3.3.m3.1.1.cmml"><mi id="S5.SS7.p3.3.m3.1.1.2" xref="S5.SS7.p3.3.m3.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.3.m3.1.1.1" xref="S5.SS7.p3.3.m3.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p3.3.m3.1.1.3" xref="S5.SS7.p3.3.m3.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.3.m3.1.1.1a" xref="S5.SS7.p3.3.m3.1.1.1.cmml">​</mo><mn id="S5.SS7.p3.3.m3.1.1.4" xref="S5.SS7.p3.3.m3.1.1.4.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.3.m3.1b"><apply id="S5.SS7.p3.3.m3.1.1.cmml" xref="S5.SS7.p3.3.m3.1.1"><times id="S5.SS7.p3.3.m3.1.1.1.cmml" xref="S5.SS7.p3.3.m3.1.1.1"></times><ci id="S5.SS7.p3.3.m3.1.1.2.cmml" xref="S5.SS7.p3.3.m3.1.1.2">𝑃</ci><ci id="S5.SS7.p3.3.m3.1.1.3.cmml" xref="S5.SS7.p3.3.m3.1.1.3">@</ci><cn type="integer" id="S5.SS7.p3.3.m3.1.1.4.cmml" xref="S5.SS7.p3.3.m3.1.1.4">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.3.m3.1c">P@5</annotation></semantics></math>) precision <math id="S5.SS7.p3.4.m4.1" class="ltx_Math" alttext="1.78\%" display="inline"><semantics id="S5.SS7.p3.4.m4.1a"><mrow id="S5.SS7.p3.4.m4.1.1" xref="S5.SS7.p3.4.m4.1.1.cmml"><mn id="S5.SS7.p3.4.m4.1.1.2" xref="S5.SS7.p3.4.m4.1.1.2.cmml">1.78</mn><mo id="S5.SS7.p3.4.m4.1.1.1" xref="S5.SS7.p3.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.4.m4.1b"><apply id="S5.SS7.p3.4.m4.1.1.cmml" xref="S5.SS7.p3.4.m4.1.1"><csymbol cd="latexml" id="S5.SS7.p3.4.m4.1.1.1.cmml" xref="S5.SS7.p3.4.m4.1.1.1">percent</csymbol><cn type="float" id="S5.SS7.p3.4.m4.1.1.2.cmml" xref="S5.SS7.p3.4.m4.1.1.2">1.78</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.4.m4.1c">1.78\%</annotation></semantics></math> (<math id="S5.SS7.p3.5.m5.1" class="ltx_Math" alttext="1.92\%" display="inline"><semantics id="S5.SS7.p3.5.m5.1a"><mrow id="S5.SS7.p3.5.m5.1.1" xref="S5.SS7.p3.5.m5.1.1.cmml"><mn id="S5.SS7.p3.5.m5.1.1.2" xref="S5.SS7.p3.5.m5.1.1.2.cmml">1.92</mn><mo id="S5.SS7.p3.5.m5.1.1.1" xref="S5.SS7.p3.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.5.m5.1b"><apply id="S5.SS7.p3.5.m5.1.1.cmml" xref="S5.SS7.p3.5.m5.1.1"><csymbol cd="latexml" id="S5.SS7.p3.5.m5.1.1.1.cmml" xref="S5.SS7.p3.5.m5.1.1.1">percent</csymbol><cn type="float" id="S5.SS7.p3.5.m5.1.1.2.cmml" xref="S5.SS7.p3.5.m5.1.1.2">1.92</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.5.m5.1c">1.92\%</annotation></semantics></math>, <math id="S5.SS7.p3.6.m6.1" class="ltx_Math" alttext="1.66\%" display="inline"><semantics id="S5.SS7.p3.6.m6.1a"><mrow id="S5.SS7.p3.6.m6.1.1" xref="S5.SS7.p3.6.m6.1.1.cmml"><mn id="S5.SS7.p3.6.m6.1.1.2" xref="S5.SS7.p3.6.m6.1.1.2.cmml">1.66</mn><mo id="S5.SS7.p3.6.m6.1.1.1" xref="S5.SS7.p3.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.6.m6.1b"><apply id="S5.SS7.p3.6.m6.1.1.cmml" xref="S5.SS7.p3.6.m6.1.1"><csymbol cd="latexml" id="S5.SS7.p3.6.m6.1.1.1.cmml" xref="S5.SS7.p3.6.m6.1.1.1">percent</csymbol><cn type="float" id="S5.SS7.p3.6.m6.1.1.2.cmml" xref="S5.SS7.p3.6.m6.1.1.2">1.66</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.6.m6.1c">1.66\%</annotation></semantics></math>) over the best baseline FedAwS. On WikiLSHTC dataset, the improvements are relatively small (<math id="S5.SS7.p3.7.m7.1" class="ltx_Math" alttext="0.72\%" display="inline"><semantics id="S5.SS7.p3.7.m7.1a"><mrow id="S5.SS7.p3.7.m7.1.1" xref="S5.SS7.p3.7.m7.1.1.cmml"><mn id="S5.SS7.p3.7.m7.1.1.2" xref="S5.SS7.p3.7.m7.1.1.2.cmml">0.72</mn><mo id="S5.SS7.p3.7.m7.1.1.1" xref="S5.SS7.p3.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.7.m7.1b"><apply id="S5.SS7.p3.7.m7.1.1.cmml" xref="S5.SS7.p3.7.m7.1.1"><csymbol cd="latexml" id="S5.SS7.p3.7.m7.1.1.1.cmml" xref="S5.SS7.p3.7.m7.1.1.1">percent</csymbol><cn type="float" id="S5.SS7.p3.7.m7.1.1.2.cmml" xref="S5.SS7.p3.7.m7.1.1.2">0.72</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.7.m7.1c">0.72\%</annotation></semantics></math>, <math id="S5.SS7.p3.8.m8.1" class="ltx_Math" alttext="1.01\%" display="inline"><semantics id="S5.SS7.p3.8.m8.1a"><mrow id="S5.SS7.p3.8.m8.1.1" xref="S5.SS7.p3.8.m8.1.1.cmml"><mn id="S5.SS7.p3.8.m8.1.1.2" xref="S5.SS7.p3.8.m8.1.1.2.cmml">1.01</mn><mo id="S5.SS7.p3.8.m8.1.1.1" xref="S5.SS7.p3.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.8.m8.1b"><apply id="S5.SS7.p3.8.m8.1.1.cmml" xref="S5.SS7.p3.8.m8.1.1"><csymbol cd="latexml" id="S5.SS7.p3.8.m8.1.1.1.cmml" xref="S5.SS7.p3.8.m8.1.1.1">percent</csymbol><cn type="float" id="S5.SS7.p3.8.m8.1.1.2.cmml" xref="S5.SS7.p3.8.m8.1.1.2">1.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.8.m8.1c">1.01\%</annotation></semantics></math>, <math id="S5.SS7.p3.9.m9.1" class="ltx_Math" alttext="1.07\%" display="inline"><semantics id="S5.SS7.p3.9.m9.1a"><mrow id="S5.SS7.p3.9.m9.1.1" xref="S5.SS7.p3.9.m9.1.1.cmml"><mn id="S5.SS7.p3.9.m9.1.1.2" xref="S5.SS7.p3.9.m9.1.1.2.cmml">1.07</mn><mo id="S5.SS7.p3.9.m9.1.1.1" xref="S5.SS7.p3.9.m9.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.9.m9.1b"><apply id="S5.SS7.p3.9.m9.1.1.cmml" xref="S5.SS7.p3.9.m9.1.1"><csymbol cd="latexml" id="S5.SS7.p3.9.m9.1.1.1.cmml" xref="S5.SS7.p3.9.m9.1.1.1">percent</csymbol><cn type="float" id="S5.SS7.p3.9.m9.1.1.2.cmml" xref="S5.SS7.p3.9.m9.1.1.2">1.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.9.m9.1c">1.07\%</annotation></semantics></math> on <math id="S5.SS7.p3.10.m10.1" class="ltx_Math" alttext="P@1" display="inline"><semantics id="S5.SS7.p3.10.m10.1a"><mrow id="S5.SS7.p3.10.m10.1.1" xref="S5.SS7.p3.10.m10.1.1.cmml"><mi id="S5.SS7.p3.10.m10.1.1.2" xref="S5.SS7.p3.10.m10.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.10.m10.1.1.1" xref="S5.SS7.p3.10.m10.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p3.10.m10.1.1.3" xref="S5.SS7.p3.10.m10.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.10.m10.1.1.1a" xref="S5.SS7.p3.10.m10.1.1.1.cmml">​</mo><mn id="S5.SS7.p3.10.m10.1.1.4" xref="S5.SS7.p3.10.m10.1.1.4.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.10.m10.1b"><apply id="S5.SS7.p3.10.m10.1.1.cmml" xref="S5.SS7.p3.10.m10.1.1"><times id="S5.SS7.p3.10.m10.1.1.1.cmml" xref="S5.SS7.p3.10.m10.1.1.1"></times><ci id="S5.SS7.p3.10.m10.1.1.2.cmml" xref="S5.SS7.p3.10.m10.1.1.2">𝑃</ci><ci id="S5.SS7.p3.10.m10.1.1.3.cmml" xref="S5.SS7.p3.10.m10.1.1.3">@</ci><cn type="integer" id="S5.SS7.p3.10.m10.1.1.4.cmml" xref="S5.SS7.p3.10.m10.1.1.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.10.m10.1c">P@1</annotation></semantics></math>, <math id="S5.SS7.p3.11.m11.1" class="ltx_Math" alttext="P@3" display="inline"><semantics id="S5.SS7.p3.11.m11.1a"><mrow id="S5.SS7.p3.11.m11.1.1" xref="S5.SS7.p3.11.m11.1.1.cmml"><mi id="S5.SS7.p3.11.m11.1.1.2" xref="S5.SS7.p3.11.m11.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.11.m11.1.1.1" xref="S5.SS7.p3.11.m11.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p3.11.m11.1.1.3" xref="S5.SS7.p3.11.m11.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.11.m11.1.1.1a" xref="S5.SS7.p3.11.m11.1.1.1.cmml">​</mo><mn id="S5.SS7.p3.11.m11.1.1.4" xref="S5.SS7.p3.11.m11.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.11.m11.1b"><apply id="S5.SS7.p3.11.m11.1.1.cmml" xref="S5.SS7.p3.11.m11.1.1"><times id="S5.SS7.p3.11.m11.1.1.1.cmml" xref="S5.SS7.p3.11.m11.1.1.1"></times><ci id="S5.SS7.p3.11.m11.1.1.2.cmml" xref="S5.SS7.p3.11.m11.1.1.2">𝑃</ci><ci id="S5.SS7.p3.11.m11.1.1.3.cmml" xref="S5.SS7.p3.11.m11.1.1.3">@</ci><cn type="integer" id="S5.SS7.p3.11.m11.1.1.4.cmml" xref="S5.SS7.p3.11.m11.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.11.m11.1c">P@3</annotation></semantics></math> and <math id="S5.SS7.p3.12.m12.1" class="ltx_Math" alttext="P@5" display="inline"><semantics id="S5.SS7.p3.12.m12.1a"><mrow id="S5.SS7.p3.12.m12.1.1" xref="S5.SS7.p3.12.m12.1.1.cmml"><mi id="S5.SS7.p3.12.m12.1.1.2" xref="S5.SS7.p3.12.m12.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.12.m12.1.1.1" xref="S5.SS7.p3.12.m12.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p3.12.m12.1.1.3" xref="S5.SS7.p3.12.m12.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.12.m12.1.1.1a" xref="S5.SS7.p3.12.m12.1.1.1.cmml">​</mo><mn id="S5.SS7.p3.12.m12.1.1.4" xref="S5.SS7.p3.12.m12.1.1.4.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.12.m12.1b"><apply id="S5.SS7.p3.12.m12.1.1.cmml" xref="S5.SS7.p3.12.m12.1.1"><times id="S5.SS7.p3.12.m12.1.1.1.cmml" xref="S5.SS7.p3.12.m12.1.1.1"></times><ci id="S5.SS7.p3.12.m12.1.1.2.cmml" xref="S5.SS7.p3.12.m12.1.1.2">𝑃</ci><ci id="S5.SS7.p3.12.m12.1.1.3.cmml" xref="S5.SS7.p3.12.m12.1.1.3">@</ci><cn type="integer" id="S5.SS7.p3.12.m12.1.1.4.cmml" xref="S5.SS7.p3.12.m12.1.1.4">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.12.m12.1c">P@5</annotation></semantics></math> precision). On Amazon670K dataset, FedALC achieves a similar performance with FedAwS and on <math id="S5.SS7.p3.13.m13.1" class="ltx_Math" alttext="P@1" display="inline"><semantics id="S5.SS7.p3.13.m13.1a"><mrow id="S5.SS7.p3.13.m13.1.1" xref="S5.SS7.p3.13.m13.1.1.cmml"><mi id="S5.SS7.p3.13.m13.1.1.2" xref="S5.SS7.p3.13.m13.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.13.m13.1.1.1" xref="S5.SS7.p3.13.m13.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S5.SS7.p3.13.m13.1.1.3" xref="S5.SS7.p3.13.m13.1.1.3.cmml">@</mi><mo lspace="0em" rspace="0em" id="S5.SS7.p3.13.m13.1.1.1a" xref="S5.SS7.p3.13.m13.1.1.1.cmml">​</mo><mn id="S5.SS7.p3.13.m13.1.1.4" xref="S5.SS7.p3.13.m13.1.1.4.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.13.m13.1b"><apply id="S5.SS7.p3.13.m13.1.1.cmml" xref="S5.SS7.p3.13.m13.1.1"><times id="S5.SS7.p3.13.m13.1.1.1.cmml" xref="S5.SS7.p3.13.m13.1.1.1"></times><ci id="S5.SS7.p3.13.m13.1.1.2.cmml" xref="S5.SS7.p3.13.m13.1.1.2">𝑃</ci><ci id="S5.SS7.p3.13.m13.1.1.3.cmml" xref="S5.SS7.p3.13.m13.1.1.3">@</ci><cn type="integer" id="S5.SS7.p3.13.m13.1.1.4.cmml" xref="S5.SS7.p3.13.m13.1.1.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.13.m13.1c">P@1</annotation></semantics></math> precision, the FedALC is lower than FedAwS. The reasons behind that are label correlations. For multi-label tasks, more instances per label means that label is positive correlated with more other labels. From Table <a href="#S5.T2" title="TABLE II ‣ V-A Datasets ‣ V Experiments ‣ Federated Learning with Only Positive Labels by Exploring Label Correlations" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, we can observe that labels correlations on AmazonCat are strongest (the largest average number of instances per label) and the labels correlations on Amazon670K are the weakest (the least average instances per label). Our method explores the label correlation and achieves the largest improvement on the dataset with the strongest label correlations.</p>
</div>
<div id="S5.SS7.p4" class="ltx_para">
<p id="S5.SS7.p4.1" class="ltx_p">From all the above results, we can find FedAvg, FLAG and FedMLH are relatively weak because that they donn’t consider the class embedding collapsing introduced by the lack of negative label data. FedALC and FedAwS achieve relatively strong performance due to the fact that spreading out the class embedding matrix can effectly mitigate the class embedding matrix collapsing. FedALC achieves the highest accuracy in most cases, because we spreadout the class embedding with the consideration of label correlations.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion and Discussion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we investigate the problem of the multi-label classification in the federated learning setting, where each client has only access to the local dataset associated with positive data, and propose a novel method that explores the label correlations to improve the quality of the class embedding matrix. Existing algorithm treats different labels equally, while our FedALC can explore label correlations by making the best use of label distributions. To improve safety and reduce the computational cost and communication overhead, we further propose a variant of our FedALC by learning a fixed class embedding matrix, where the server and clients only need to exchange class embeddings once. Moreover, a sophisticated strategy is designed for label collection. The experiments show that our algorithm is more adaptive and effective for the challenging federated multi-label setting.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">In regard to limitations, simply using positive class embedding to replace the corresponding instance embedding may lead to information loss, especially in the variant of learning fixed class embedding. Exploring how to find better surrogate for instance embedding may further improve the performance and also accelerate the learning process.
Besides, we intend to verify the effectiveness of our method on more massive-scale extreme multi-label datasets.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Q. Yang, Y. Liu, T. Chen, and Y. Tong, “Federated machine learning: Concept
and applications,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology (TIST)</em>, vol. 10, no. 2, pp. 1–19, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, A. Talwalkar, and V. Smith, “Federated learning:
Challenges, methods, and future directions,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing
Magazine</em>, vol. 37, no. 3, pp. 50–60, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Q. Li, Z. Wen, Z. Wu, S. Hu, N. Wang, Y. Li, X. Liu, and B. He, “A survey on
federated learning systems: vision, hype and reality for data privacy and
protection,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Knowledge and Data Engineering</em>,
2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
J. Liu, W.-C. Chang, Y. Wu, and Y. Yang, “Deep learning for extreme
multi-label text classification,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 40th
international ACM SIGIR conference on research and development in information
retrieval</em>, 2017, pp. 115–124.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M. Shi, Y. Tang, and X. Zhu, “Mlne: Multi-label network embedding,”
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>, vol. 31,
no. 9, pp. 3682–3695, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
F. Yu, A. S. Rawat, A. Menon, and S. Kumar, “Federated learning with only
positive labels,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine
Learning</em>.   PMLR, 2020, pp.
10 946–10 956.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
D. Snyder, D. Garcia-Romero, D. Povey, and S. Khudanpur, “Deep neural network
embeddings for text-independent speaker verification,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Interspeech
2017</em>, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
F. Wang, J. Cheng, W. Liu, and H. Liu, “Additive margin softmax for face
verification,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Letters</em>, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Cao, Kai, Jain, and K. Anil, “Automated latent fingerprint recognition,”
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
K. Nguyen, C. Fookes, A. Ross, and S. Sridharan, “Iris recognition with
off-the-shelf cnn features: A deep learning perspective,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE
Access</em>, vol. 6, pp. 18 848–18 855, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
Ł. Kaiser, and I. Polosukhin, “Attention is all you need,” in
<em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 2017, pp.
5998–6008.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
J. Konečnỳ, H. B. McMahan, F. X. Yu, P. Richtárik, A. T. Suresh,
and D. Bacon, “Federated learning: Strategies for improving communication
efficiency,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
P. Bojanowski and A. Joulin, “Unsupervised learning by predicting noise,” in
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2017, pp. 517–526.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Everingham, L. Van Gool, C. K. Williams, J. Winn, and A. Zisserman, “The
pascal visual object classes (voc) challenge,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International journal
of computer vision</em>, vol. 88, no. 2, pp. 303–338, 2010.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
I. Katakis, I. Vlahavas, and G. Tsoumakas, “Multilabel text classification for
automated tag suggestion,” 2008.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Q. Wang, N. Jia, and T. Breckon, “A baseline for multi-label image
classification using ensemble deep cnn,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1811.08412</em>, 2018.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
G. Tsoumakas, I. Katakis, and I. Vlahavas, “Mining multi-label data,” in
<em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Data mining and knowledge discovery handbook</em>.   Springer, 2009, pp. 667–685.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
M.-L. Zhang and Z.-H. Zhou, “A review on multi-label learning algorithms,”
<em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on knowledge and data engineering</em>, vol. 26, no. 8,
pp. 1819–1837, 2013.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Z. Barutcuoglu, R. E. Schapire, and O. G. Troyanskaya, “Hierarchical
multi-label prediction of gene function,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Bioinformatics</em>, vol. 22,
no. 7, pp. 830–836, 2006.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Z. Yang, D. Yang, C. Dyer, X. He, A. Smola, and E. Hovy, “Hierarchical
attention networks for document classification,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
2016 conference of the North American chapter of the association for
computational linguistics: human language technologies</em>, 2016, pp.
1480–1489.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
J. Wang, Y. Yang, J. Mao, Z. Huang, C. Huang, and W. Xu, “Cnn-rnn: A unified
framework for multi-label image classification,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE conference on computer vision and pattern recognition</em>, 2016, pp.
2285–2294.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
T. Gu, Z. Wang, Z. Fang, Z. Zhu, H. Yang, D. Li, and W. Du, “Multilabel
convolutional network with feature denoising and details supplement,”
<em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>, pp. 1–13,
2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
M.-K. Xie and S.-J. Huang, “Partial multi-label learning,” in
<em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
vol. 32, no. 1, 2018.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
——, “Partial multi-label learning with noisy label identification,”
<em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Y.-Y. Sun, Y. Zhang, and Z.-H. Zhou, “Multi-label learning with weak label,”
in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Twenty-fourth AAAI conference on artificial intelligence</em>, 2010.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
W. Liu, H. Wang, X. Shen, and I. Tsang, “The emerging trends of multi-label
learning,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine
Intelligence</em>, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
H. Jain, Y. Prabhu, and M. Varma, “Extreme multi-label loss functions for
recommendation, tagging, ranking &amp; other missing label applications,” in
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 22nd ACM SIGKDD International Conference on
Knowledge Discovery and Data Mining</em>, 2016, pp. 935–944.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
J. Huang, C.-M. Vong, C. L. P. Chen, and Y. Zhou, “Accurate and efficient
large-scale multi-label learning with reduced feature broad learning system
using label correlation,” <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and
Learning Systems</em>, pp. 1–14, 2022.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Y. Xu, Q. Zhang, J. Zhang, and D. Tao, “Vitae: Vision transformer advanced by
exploring intrinsic inductive bias,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>, vol. 34, 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Q. Zhang, Y. Xu, J. Zhang, and D. Tao, “Vitaev2: Vision transformer advanced
by exploring inductive bias for image recognition and beyond,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2202.10108</em>, 2022.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
L. Collins, H. Hassani, A. Mokhtari, and S. Shakkottai, “Exploiting shared
representations for personalized federated learning,” 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
A. Shamsian, A. Navon, E. Fetaya, and G. Chechik, “Personalized federated
learning using hypernetworks,” 2021.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
T. Li, S. Hu, A. Beirami, and V. Smith, “Ditto: Fair and robust federated
learning through personalization,” 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
A. Z. Tan, H. Yu, L. Cui, and Q. Yang, “Towards personalized federated
learning,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>,
pp. 1–17, 2022.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
J. C. Duchi, M. I. Jordan, and M. J. Wainwright, “Privacy aware learning,”
2012.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
W. Zhu, P. Kairouz, H. Sun, B. Mcmahan, and W. Li, “Federated heavy hitters
discovery with differential privacy,” 2019.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Z. Li, D. Kovalev, X. Qian, and P. Richtárik, “Acceleration for compressed
gradient descent in distributed and federated optimization,” 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
D. Basu, D. Data, C. Karakus, and S. N. Diggavi, “Qsparse-local-sgd:
Distributed sgd with quantization, sparsification, and local computations,”
2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
J. Xu, W. Du, Y. Jin, W. He, and R. Cheng, “Ternary compression for
communication-efficient federated learning,” <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on
Neural Networks and Learning Systems</em>, 2020.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Z. Zhu, J. Hong, and J. Zhou, “Data-free knowledge distillation for
heterogeneous federated learning,” 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
T. Murata and T. Suzuki, “Bias-variance reduced local sgd for less
heterogeneous federated learning,” 2021.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
H. Z. Feng, Z. You, M. Chen, T. Zhang, and W. Chen, “Kd3a: Unsupervised
multi-source decentralized domain adaptation via knowledge distillation,”
2020.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
F. Sattler, S. Wiedemann, K.-R. Müller, and W. Samek, “Robust and
communication-efficient federated learning from non-iid data,” <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">IEEE
transactions on neural networks and learning systems</em>, vol. 31, no. 9, pp.
3400–3413, 2019.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
D. K. Dennis, T. Li, and V. Smith, “Heterogeneity for the win: One-shot
federated clustering,” 2021.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Y. Fraboni, R. Vidal, L. Kameni, and M. Lorenzi, “Clustered sampling:
Low-variance and improved representativity for clients selection in federated
learning,” 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
H. Jamali-Rad, M. Abdizadeh, and A. Singh, “Federated learning with taskonomy
for non-iid data,” <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning
Systems</em>, 2022.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Z. Li, Y. He, H. Yu, J. Kang, X. Li, Z. Xu, and D. Niyato, “Data
heterogeneity-robust federated learning via group client selection in
industrial iot,” <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>, 2022.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
A. v. d. Oord, Y. Li, and O. Vinyals, “Representation learning with
contrastive predictive coding,” <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1807.03748</em>,
2018.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
S. J. Reddi, S. Kale, F. Yu, D. Holtmann-Rice, J. Chen, and S. Kumar,
“Stochastic negative mining for learning with large output spaces,” in
<em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">The 22nd International Conference on Artificial Intelligence and
Statistics</em>.   PMLR, 2019, pp.
1940–1949.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
B. Huang, X. Li, Z. Song, and X. Yang, “FL-NTK: A neural tangent
kernel-based framework for federated learning analysis,” in
<em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on Machine Learning,
ICML 2021, 18-24 July 2021, Virtual Event</em>, vol. 139.   PMLR, 2021, pp. 4423–4434.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
R. Rivest and S. Dusse, “The md5 message-digest algorithm,” 1992.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
X. Wang, Y. L. Yin, and H. Yu, “Finding collisions in the full sha-1,” in
<em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Annual international cryptology conference</em>.   Springer, 2005, pp. 17–36.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
S. M. Bellovin and E. K. Rescorla, “Deploying a new hash algorithm,” 2005.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
J.-S. Coron, Y. Dodis, C. Malinaud, and P. Puniya, “Merkle-damgård
revisited: How to construct a hash function,” in <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Annual International
Cryptology Conference</em>.   Springer,
2005, pp. 430–448.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Y. Pantazis, D. Paul, M. Fasoulakis, Y. Stylianou, and M. A. Katsoulakis,
“Cumulant gan,” <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning
Systems</em>, pp. 1–12, 2022.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
J. Sun, A. Li, B. Wang, H. Yang, H. Li, and Y. Chen, “Soteria: Provable
defense against privacy leakage in federated learning from representation
perspective,” in <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition (CVPR)</em>, June 2021, pp. 9311–9319.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
C. Dwork, F. McSherry, K. Nissim, and A. D. Smith, “Calibrating noise to
sensitivity in private data analysis,” in <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Theory of Cryptography,
Third Theory of Cryptography Conference, TCC 2006, New York, NY, USA, March
4-7, 2006, Proceedings</em>, ser. Lecture Notes in Computer Science, vol.
3876.   Springer, 2006, pp. 265–284.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
M. Abadi, A. Chu, I. J. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and
L. Zhang, “Deep learning with differential privacy,” in <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the 2016 ACM SIGSAC Conference on Computer and Communications
Security, Vienna, Austria, October 24-28, 2016</em>.   ACM, 2016, pp. 308–318.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
B. Liu, M. Ding, S. Shaham, W. Rahayu, F. Farokhi, and Z. Lin, “When machine
learning meets privacy: A survey and outlook,” <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">ACM Comput. Surv.</em>,
vol. 54, no. 2, pp. 31:1–31:36, 2022.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
H. B. McMahan, D. Ramage, K. Talwar, and L. Zhang, “Learning differentially
private recurrent language models,” in <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">6th International Conference on
Learning Representations, ICLR 2018, Vancouver, BC, Canada, April 30 - May
3, 2018, Conference Track Proceedings</em>, 2018.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ramanan,
P. Dollár, and C. L. Zitnick, “Microsoft coco: Common objects in
context,” in <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>.   Springer, 2014, pp. 740–755.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
C. Song, F. Granqvist, and K. Talwar, “FLAIR: federated learning annotated
image repository,” in <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
E. L. Mencía and J. Fürnkranz, “Efficient pairwise multilabel
classification for large-scale problems in the legal domain,” in
<em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">ECML/PKDD</em>, 2008.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
L. Guan, M. H. Alam, W. Ryu, and S. Lee, “A phrase-based model to discover
hidden factors and hidden topics in recommender systems,” in <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">2016
International Conference on Big Data and Smart Computing, BigComp 2016, Hong
Kong, China, January 18-20, 2016</em>.   IEEE Computer Society, 2016, pp. 337–340.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
I. Partalas, A. Kosmopoulos, N. Baskiotis, T. Artières, G. Paliouras,
É. Gaussier, I. Androutsopoulos, M. Amini, and P. Gallinari, “LSHTC:
A benchmark for large-scale text classification,” <em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, vol.
abs/1503.08581, 2015.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in <em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision
and pattern recognition</em>, 2016, pp. 770–778.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
T. H. Hsu, H. Qi, and M. Brown, “Measuring the effects of non-identical data
distribution for federated visual classification,” <em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2019.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
S. Chang, B. W. Hsu, T. Chang, and V. S. Tseng, “FLAG: fast label-adaptive
aggregation for multi-label classification in federated learning,”
<em id="bib.bib69.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, vol. abs/2302.13571, 2023.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
K. Bhatia, H. Jain, P. Kar, M. Varma, and P. Jain, “Sparse local embeddings
for extreme multi-label classification.” in <em id="bib.bib70.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, vol. 29, 2015, pp.
730–738.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
Z. Dai, C. Dun, Y. Tang, A. Kyrillidis, and A. Shrivastava, “Federated
multiple label hashing (fedmlh): Communication efficient federated learning
on extreme classification tasks,” <em id="bib.bib71.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, vol. abs/2110.12292, 2021.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
Q. Wang and K. Chen, “Multi-label zero-shot human action recognition via joint
latent ranking embedding,” <em id="bib.bib72.1.1" class="ltx_emph ltx_font_italic">Neural Networks</em>, vol. 122, pp. 1–23,
2020.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.15597" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.15598" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.15598">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.15598" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.15599" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 17:49:59 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
