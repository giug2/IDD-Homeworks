<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling</title>
<!--Generated on Fri Jun 14 06:07:19 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.09742v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S1" title="In IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S2" title="In IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S2.SS1" title="In 2. Related Work ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Lifelong Sequence Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S2.SS2" title="In 2. Related Work ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Efficient Transformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S2.SS3" title="In 2. Related Work ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Relationship Aware Modeling</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S3" title="In IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4" title="In IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Interaction Fidelity Attention Model</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.SS1" title="In 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.SS2" title="In 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Model Structure</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.SS3" title="In 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.SS4" title="In 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Fast Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.SS5" title="In 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Time Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5" title="In IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.SS1" title="In 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.SS2" title="In 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Performance of IFA Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.SS3" title="In 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.SS4" title="In 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Performance of AB test</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S6" title="In IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Future Work</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenhui Yu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_state" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yuwenhui07@kuaishou.com">yuwenhui07@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chao Feng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_state" id="id6.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:fengchao08@kuaishou.com">fengchao08@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yanze Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_state" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhangyanze@kuaishou.com">zhangyanze@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lantao Hu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_state" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:hulantao@kuaishou.com">hulantao@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Peng Jiang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_state" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jiangpeng@kuaishou.com">jiangpeng@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Han Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_state" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lihan08@kuaishou.com">lihan08@kuaishou.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id19.id1">The lifelong user behavior sequence provides abundant information of user preference and gains impressive improvement in the recommendation task, however increases computational consumption significantly. To meet the severe latency requirement in online service, a short sub-sequence is sampled based on similarity to the target item. Unfortunately, items not in the sub-sequence are abandoned, leading to serious information loss.</p>
<p class="ltx_p" id="id20.id2">In this paper, we propose a new efficient paradigm to model the full lifelong sequence, which is named as <span class="ltx_text ltx_font_bold" id="id20.id2.1">I</span>nteraction <span class="ltx_text ltx_font_bold" id="id20.id2.2">F</span>idelity <span class="ltx_text ltx_font_bold" id="id20.id2.3">A</span>ttention (<span class="ltx_text ltx_font_bold" id="id20.id2.4">IFA</span>). In IFA, we input all target items in the candidate set into the model at once, and leverage linear transformer to reduce the time complexity of the cross attention between the candidate set and the sequence without any interaction information loss. We also additionally model the relationship of all target items for optimal set generation, and design loss function for better consistency of training and inference. We demonstrate the effectiveness and efficiency of our model by off-line and online experiments in the recommender system of Kuaishou.</p>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct conference title from your rights confirmation email; June 03–05, 2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommender system learns preference based on history records and predicts preferred items for each user. It is important in all online platforms due to the efficient information matching. In most recomenders, users and items are represented by dense embeddings and the match scores are derived by inner product <cite class="ltx_cite ltx_citemacro_citep">(Koren, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib15" title="">2009</a>; Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib25" title="">2009</a>; Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib24" title="">2011</a>)</cite> or fully-connected layers <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib11" title="">2017</a>; He and Chua, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib9" title="">2017</a>; Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib7" title="">2017</a>)</cite>. To learn better preference, more information <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib24" title="">2011</a>; He and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib8" title="">2016</a>; Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib35" title="">2018</a>; McAuley and Leskovec, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib20" title="">2013</a>; Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib26" title="">2015</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib30" title="">2019</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib39" title="">2016</a>)</cite> and complex structures <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib10" title="">2020</a>; Ying et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib31" title="">2018</a>; Yu and Qin, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib33" title="">2020a</a>; Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib36" title="">2022</a>; Yu and Qin, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib34" title="">2020b</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib6" title="">2017</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib12" title="">2018</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib40" title="">2024</a>)</cite> are used.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In industry recommendation, user behaviour sequence is very important <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib42" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib41" title="">2019</a>; Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib23" title="">2020</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib4" title="">2023a</a>)</cite>. Deep Interest Network (DIN) learns interactions between target item and behaviour sequence items by target attention <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib42" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib41" title="">2019</a>)</cite>. In real-world application, we can improve the accuracy of the model significantly by increasing the length of the sequence, yet the computational consumption also increases. To reduce the complexity, Search-based Interest Model (SIM) separates target attention into two-step concatenation <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib23" title="">2020</a>)</cite>: (1) A simple General Search Unit (GSU) is used to select a sub-sequence from the long sequence base on certain similarity rule to the target item, such as the same category (hard search) or embedding similarity (soft search). (2) An Exact Search Unit (ESU) is then used for target attention. In this paradigm, interactions between the target item and the sequence items which are not in the sub-sequence are missed, nevertheless these interactions are also very important. We give an example to demonstrate this point.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="282" id="S1.F1.sf1.g1" src="x1.png" width="107"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S1.F1.sf1.3.2" style="font-size:80%;">Target item</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="282" id="S1.F1.sf2.g1" src="x2.png" width="553"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S1.F1.sf2.3.2" style="font-size:80%;">Long sequence</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Sampling mechanism in SIM</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.5">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">1</span></a> shows the sequence sampling mechanism in SIM. Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S1.F1.sf1" title="In Figure 1 ‣ 1. Introduction ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">1(a)</span></a> is the target time <math alttext="i_{T}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msub id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">i</mi><mi id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">𝑖</ci><ci id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">i_{T}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_i start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>, which is an anime. Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S1.F1.sf2" title="In Figure 1 ‣ 1. Introduction ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">1(b)</span></a> is the user lifelong sequence <math alttext="\{i_{1},i_{2},i_{3},i_{4},i_{5}\}" class="ltx_Math" display="inline" id="S1.p3.2.m2.5"><semantics id="S1.p3.2.m2.5a"><mrow id="S1.p3.2.m2.5.5.5" xref="S1.p3.2.m2.5.5.6.cmml"><mo id="S1.p3.2.m2.5.5.5.6" stretchy="false" xref="S1.p3.2.m2.5.5.6.cmml">{</mo><msub id="S1.p3.2.m2.1.1.1.1" xref="S1.p3.2.m2.1.1.1.1.cmml"><mi id="S1.p3.2.m2.1.1.1.1.2" xref="S1.p3.2.m2.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.2.m2.1.1.1.1.3" xref="S1.p3.2.m2.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.2.m2.5.5.5.7" xref="S1.p3.2.m2.5.5.6.cmml">,</mo><msub id="S1.p3.2.m2.2.2.2.2" xref="S1.p3.2.m2.2.2.2.2.cmml"><mi id="S1.p3.2.m2.2.2.2.2.2" xref="S1.p3.2.m2.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.2.m2.2.2.2.2.3" xref="S1.p3.2.m2.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.2.m2.5.5.5.8" xref="S1.p3.2.m2.5.5.6.cmml">,</mo><msub id="S1.p3.2.m2.3.3.3.3" xref="S1.p3.2.m2.3.3.3.3.cmml"><mi id="S1.p3.2.m2.3.3.3.3.2" xref="S1.p3.2.m2.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.2.m2.3.3.3.3.3" xref="S1.p3.2.m2.3.3.3.3.3.cmml">3</mn></msub><mo id="S1.p3.2.m2.5.5.5.9" xref="S1.p3.2.m2.5.5.6.cmml">,</mo><msub id="S1.p3.2.m2.4.4.4.4" xref="S1.p3.2.m2.4.4.4.4.cmml"><mi id="S1.p3.2.m2.4.4.4.4.2" xref="S1.p3.2.m2.4.4.4.4.2.cmml">i</mi><mn id="S1.p3.2.m2.4.4.4.4.3" xref="S1.p3.2.m2.4.4.4.4.3.cmml">4</mn></msub><mo id="S1.p3.2.m2.5.5.5.10" xref="S1.p3.2.m2.5.5.6.cmml">,</mo><msub id="S1.p3.2.m2.5.5.5.5" xref="S1.p3.2.m2.5.5.5.5.cmml"><mi id="S1.p3.2.m2.5.5.5.5.2" xref="S1.p3.2.m2.5.5.5.5.2.cmml">i</mi><mn id="S1.p3.2.m2.5.5.5.5.3" xref="S1.p3.2.m2.5.5.5.5.3.cmml">5</mn></msub><mo id="S1.p3.2.m2.5.5.5.11" stretchy="false" xref="S1.p3.2.m2.5.5.6.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.5b"><set id="S1.p3.2.m2.5.5.6.cmml" xref="S1.p3.2.m2.5.5.5"><apply id="S1.p3.2.m2.1.1.1.1.cmml" xref="S1.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.1.1.cmml" xref="S1.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S1.p3.2.m2.1.1.1.1.2.cmml" xref="S1.p3.2.m2.1.1.1.1.2">𝑖</ci><cn id="S1.p3.2.m2.1.1.1.1.3.cmml" type="integer" xref="S1.p3.2.m2.1.1.1.1.3">1</cn></apply><apply id="S1.p3.2.m2.2.2.2.2.cmml" xref="S1.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.2.m2.2.2.2.2.1.cmml" xref="S1.p3.2.m2.2.2.2.2">subscript</csymbol><ci id="S1.p3.2.m2.2.2.2.2.2.cmml" xref="S1.p3.2.m2.2.2.2.2.2">𝑖</ci><cn id="S1.p3.2.m2.2.2.2.2.3.cmml" type="integer" xref="S1.p3.2.m2.2.2.2.2.3">2</cn></apply><apply id="S1.p3.2.m2.3.3.3.3.cmml" xref="S1.p3.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.2.m2.3.3.3.3.1.cmml" xref="S1.p3.2.m2.3.3.3.3">subscript</csymbol><ci id="S1.p3.2.m2.3.3.3.3.2.cmml" xref="S1.p3.2.m2.3.3.3.3.2">𝑖</ci><cn id="S1.p3.2.m2.3.3.3.3.3.cmml" type="integer" xref="S1.p3.2.m2.3.3.3.3.3">3</cn></apply><apply id="S1.p3.2.m2.4.4.4.4.cmml" xref="S1.p3.2.m2.4.4.4.4"><csymbol cd="ambiguous" id="S1.p3.2.m2.4.4.4.4.1.cmml" xref="S1.p3.2.m2.4.4.4.4">subscript</csymbol><ci id="S1.p3.2.m2.4.4.4.4.2.cmml" xref="S1.p3.2.m2.4.4.4.4.2">𝑖</ci><cn id="S1.p3.2.m2.4.4.4.4.3.cmml" type="integer" xref="S1.p3.2.m2.4.4.4.4.3">4</cn></apply><apply id="S1.p3.2.m2.5.5.5.5.cmml" xref="S1.p3.2.m2.5.5.5.5"><csymbol cd="ambiguous" id="S1.p3.2.m2.5.5.5.5.1.cmml" xref="S1.p3.2.m2.5.5.5.5">subscript</csymbol><ci id="S1.p3.2.m2.5.5.5.5.2.cmml" xref="S1.p3.2.m2.5.5.5.5.2">𝑖</ci><cn id="S1.p3.2.m2.5.5.5.5.3.cmml" type="integer" xref="S1.p3.2.m2.5.5.5.5.3">5</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.5c">\{i_{1},i_{2},i_{3},i_{4},i_{5}\}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.5d">{ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT }</annotation></semantics></math>, including anime, pet, and skincare categories. Taking hard search as example, assuming the sub-sequence is <math alttext="\{i_{1},i_{2}\}" class="ltx_Math" display="inline" id="S1.p3.3.m3.2"><semantics id="S1.p3.3.m3.2a"><mrow id="S1.p3.3.m3.2.2.2" xref="S1.p3.3.m3.2.2.3.cmml"><mo id="S1.p3.3.m3.2.2.2.3" stretchy="false" xref="S1.p3.3.m3.2.2.3.cmml">{</mo><msub id="S1.p3.3.m3.1.1.1.1" xref="S1.p3.3.m3.1.1.1.1.cmml"><mi id="S1.p3.3.m3.1.1.1.1.2" xref="S1.p3.3.m3.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.3.m3.1.1.1.1.3" xref="S1.p3.3.m3.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.p3.3.m3.2.2.2.4" xref="S1.p3.3.m3.2.2.3.cmml">,</mo><msub id="S1.p3.3.m3.2.2.2.2" xref="S1.p3.3.m3.2.2.2.2.cmml"><mi id="S1.p3.3.m3.2.2.2.2.2" xref="S1.p3.3.m3.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.3.m3.2.2.2.2.3" xref="S1.p3.3.m3.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p3.3.m3.2.2.2.5" stretchy="false" xref="S1.p3.3.m3.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.2b"><set id="S1.p3.3.m3.2.2.3.cmml" xref="S1.p3.3.m3.2.2.2"><apply id="S1.p3.3.m3.1.1.1.1.cmml" xref="S1.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.1.1.cmml" xref="S1.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="S1.p3.3.m3.1.1.1.1.2.cmml" xref="S1.p3.3.m3.1.1.1.1.2">𝑖</ci><cn id="S1.p3.3.m3.1.1.1.1.3.cmml" type="integer" xref="S1.p3.3.m3.1.1.1.1.3">1</cn></apply><apply id="S1.p3.3.m3.2.2.2.2.cmml" xref="S1.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.3.m3.2.2.2.2.1.cmml" xref="S1.p3.3.m3.2.2.2.2">subscript</csymbol><ci id="S1.p3.3.m3.2.2.2.2.2.cmml" xref="S1.p3.3.m3.2.2.2.2.2">𝑖</ci><cn id="S1.p3.3.m3.2.2.2.2.3.cmml" type="integer" xref="S1.p3.3.m3.2.2.2.2.3">2</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.2c">\{i_{1},i_{2}\}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.2d">{ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT }</annotation></semantics></math>, interactions of <math alttext="i_{T}" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><msub id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml"><mi id="S1.p3.4.m4.1.1.2" xref="S1.p3.4.m4.1.1.2.cmml">i</mi><mi id="S1.p3.4.m4.1.1.3" xref="S1.p3.4.m4.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><apply id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p3.4.m4.1.1.1.cmml" xref="S1.p3.4.m4.1.1">subscript</csymbol><ci id="S1.p3.4.m4.1.1.2.cmml" xref="S1.p3.4.m4.1.1.2">𝑖</ci><ci id="S1.p3.4.m4.1.1.3.cmml" xref="S1.p3.4.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">i_{T}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">italic_i start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\{i_{3},i_{4},i_{5}\}" class="ltx_Math" display="inline" id="S1.p3.5.m5.3"><semantics id="S1.p3.5.m5.3a"><mrow id="S1.p3.5.m5.3.3.3" xref="S1.p3.5.m5.3.3.4.cmml"><mo id="S1.p3.5.m5.3.3.3.4" stretchy="false" xref="S1.p3.5.m5.3.3.4.cmml">{</mo><msub id="S1.p3.5.m5.1.1.1.1" xref="S1.p3.5.m5.1.1.1.1.cmml"><mi id="S1.p3.5.m5.1.1.1.1.2" xref="S1.p3.5.m5.1.1.1.1.2.cmml">i</mi><mn id="S1.p3.5.m5.1.1.1.1.3" xref="S1.p3.5.m5.1.1.1.1.3.cmml">3</mn></msub><mo id="S1.p3.5.m5.3.3.3.5" xref="S1.p3.5.m5.3.3.4.cmml">,</mo><msub id="S1.p3.5.m5.2.2.2.2" xref="S1.p3.5.m5.2.2.2.2.cmml"><mi id="S1.p3.5.m5.2.2.2.2.2" xref="S1.p3.5.m5.2.2.2.2.2.cmml">i</mi><mn id="S1.p3.5.m5.2.2.2.2.3" xref="S1.p3.5.m5.2.2.2.2.3.cmml">4</mn></msub><mo id="S1.p3.5.m5.3.3.3.6" xref="S1.p3.5.m5.3.3.4.cmml">,</mo><msub id="S1.p3.5.m5.3.3.3.3" xref="S1.p3.5.m5.3.3.3.3.cmml"><mi id="S1.p3.5.m5.3.3.3.3.2" xref="S1.p3.5.m5.3.3.3.3.2.cmml">i</mi><mn id="S1.p3.5.m5.3.3.3.3.3" xref="S1.p3.5.m5.3.3.3.3.3.cmml">5</mn></msub><mo id="S1.p3.5.m5.3.3.3.7" stretchy="false" xref="S1.p3.5.m5.3.3.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.3b"><set id="S1.p3.5.m5.3.3.4.cmml" xref="S1.p3.5.m5.3.3.3"><apply id="S1.p3.5.m5.1.1.1.1.cmml" xref="S1.p3.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S1.p3.5.m5.1.1.1.1.1.cmml" xref="S1.p3.5.m5.1.1.1.1">subscript</csymbol><ci id="S1.p3.5.m5.1.1.1.1.2.cmml" xref="S1.p3.5.m5.1.1.1.1.2">𝑖</ci><cn id="S1.p3.5.m5.1.1.1.1.3.cmml" type="integer" xref="S1.p3.5.m5.1.1.1.1.3">3</cn></apply><apply id="S1.p3.5.m5.2.2.2.2.cmml" xref="S1.p3.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S1.p3.5.m5.2.2.2.2.1.cmml" xref="S1.p3.5.m5.2.2.2.2">subscript</csymbol><ci id="S1.p3.5.m5.2.2.2.2.2.cmml" xref="S1.p3.5.m5.2.2.2.2.2">𝑖</ci><cn id="S1.p3.5.m5.2.2.2.2.3.cmml" type="integer" xref="S1.p3.5.m5.2.2.2.2.3">4</cn></apply><apply id="S1.p3.5.m5.3.3.3.3.cmml" xref="S1.p3.5.m5.3.3.3.3"><csymbol cd="ambiguous" id="S1.p3.5.m5.3.3.3.3.1.cmml" xref="S1.p3.5.m5.3.3.3.3">subscript</csymbol><ci id="S1.p3.5.m5.3.3.3.3.2.cmml" xref="S1.p3.5.m5.3.3.3.3.2">𝑖</ci><cn id="S1.p3.5.m5.3.3.3.3.3.cmml" type="integer" xref="S1.p3.5.m5.3.3.3.3.3">5</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.3c">\{i_{3},i_{4},i_{5}\}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m5.3d">{ italic_i start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT }</annotation></semantics></math> are missed in this case. Unfortunately, these interactions are important, and we will illustrate in tree aspects:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.2">The similarity rule of GSU is simple, hence sequence items which are relevant to the target item may be missed. For example, <math alttext="i_{4}" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><msub id="S1.I1.i1.p1.1.m1.1.1" xref="S1.I1.i1.p1.1.m1.1.1.cmml"><mi id="S1.I1.i1.p1.1.m1.1.1.2" xref="S1.I1.i1.p1.1.m1.1.1.2.cmml">i</mi><mn id="S1.I1.i1.p1.1.m1.1.1.3" xref="S1.I1.i1.p1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><apply id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.I1.i1.p1.1.m1.1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S1.I1.i1.p1.1.m1.1.1.2.cmml" xref="S1.I1.i1.p1.1.m1.1.1.2">𝑖</ci><cn id="S1.I1.i1.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.I1.i1.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">i_{4}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">italic_i start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> has the same topic (cat) with <math alttext="i_{T}" class="ltx_Math" display="inline" id="S1.I1.i1.p1.2.m2.1"><semantics id="S1.I1.i1.p1.2.m2.1a"><msub id="S1.I1.i1.p1.2.m2.1.1" xref="S1.I1.i1.p1.2.m2.1.1.cmml"><mi id="S1.I1.i1.p1.2.m2.1.1.2" xref="S1.I1.i1.p1.2.m2.1.1.2.cmml">i</mi><mi id="S1.I1.i1.p1.2.m2.1.1.3" xref="S1.I1.i1.p1.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.2.m2.1b"><apply id="S1.I1.i1.p1.2.m2.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S1.I1.i1.p1.2.m2.1.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S1.I1.i1.p1.2.m2.1.1.2.cmml" xref="S1.I1.i1.p1.2.m2.1.1.2">𝑖</ci><ci id="S1.I1.i1.p1.2.m2.1.1.3.cmml" xref="S1.I1.i1.p1.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.2.m2.1c">i_{T}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.2.m2.1d">italic_i start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>, yet is discarded due to the different categories. Though complex GSUs are proposed to alleviate this issue, such as soft search <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib23" title="">2020</a>)</cite> or a lightweight target attention <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib4" title="">2023a</a>)</cite>, they cannot solve it completely since GSU has to trade off the accuracy and efficiency.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Sequence items which are irrelevant to the target item may also provide important information of user profile. For example, from <math alttext="i_{5}" class="ltx_Math" display="inline" id="S1.I1.i2.p1.1.m1.1"><semantics id="S1.I1.i2.p1.1.m1.1a"><msub id="S1.I1.i2.p1.1.m1.1.1" xref="S1.I1.i2.p1.1.m1.1.1.cmml"><mi id="S1.I1.i2.p1.1.m1.1.1.2" xref="S1.I1.i2.p1.1.m1.1.1.2.cmml">i</mi><mn id="S1.I1.i2.p1.1.m1.1.1.3" xref="S1.I1.i2.p1.1.m1.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.m1.1b"><apply id="S1.I1.i2.p1.1.m1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.I1.i2.p1.1.m1.1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S1.I1.i2.p1.1.m1.1.1.2.cmml" xref="S1.I1.i2.p1.1.m1.1.1.2">𝑖</ci><cn id="S1.I1.i2.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.I1.i2.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.m1.1c">i_{5}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.1.m1.1d">italic_i start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math> we can infer that the user may be a young woman, with good education and aesthetic taste.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Restricted by length of the sub-sequence, sequence items which are similar to the target item may also be discarded. For example, assuming the max length of the sub-sequence is 2, we have to discard <math alttext="i_{3}" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><msub id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml"><mi id="S1.I1.i3.p1.1.m1.1.1.2" xref="S1.I1.i3.p1.1.m1.1.1.2.cmml">i</mi><mn id="S1.I1.i3.p1.1.m1.1.1.3" xref="S1.I1.i3.p1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><apply id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.I1.i3.p1.1.m1.1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S1.I1.i3.p1.1.m1.1.1.2.cmml" xref="S1.I1.i3.p1.1.m1.1.1.2">𝑖</ci><cn id="S1.I1.i3.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.I1.i3.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">i_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">italic_i start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> even it is also in the anime category.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.4">We come to the conclusion that the sampling paradigm damages abundant interaction information and hurt the performance of the model seriously. For better interaction fidelity, we propose a new paradigm, which reserves the whole sequence. To design a new paradigm, we first analyze why the existing paradigm has to damage interaction information to simplify computation. We argue that the reason is that only one target item is predicted for each time, thus the complexity of attention with a <math alttext="n" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mi id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">italic_n</annotation></semantics></math>-length sequence is <math alttext="O(n)" class="ltx_Math" display="inline" id="S1.p5.2.m2.1"><semantics id="S1.p5.2.m2.1a"><mrow id="S1.p5.2.m2.1.2" xref="S1.p5.2.m2.1.2.cmml"><mi id="S1.p5.2.m2.1.2.2" xref="S1.p5.2.m2.1.2.2.cmml">O</mi><mo id="S1.p5.2.m2.1.2.1" xref="S1.p5.2.m2.1.2.1.cmml">⁢</mo><mrow id="S1.p5.2.m2.1.2.3.2" xref="S1.p5.2.m2.1.2.cmml"><mo id="S1.p5.2.m2.1.2.3.2.1" stretchy="false" xref="S1.p5.2.m2.1.2.cmml">(</mo><mi id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml">n</mi><mo id="S1.p5.2.m2.1.2.3.2.2" stretchy="false" xref="S1.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><apply id="S1.p5.2.m2.1.2.cmml" xref="S1.p5.2.m2.1.2"><times id="S1.p5.2.m2.1.2.1.cmml" xref="S1.p5.2.m2.1.2.1"></times><ci id="S1.p5.2.m2.1.2.2.cmml" xref="S1.p5.2.m2.1.2.2">𝑂</ci><ci id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">O(n)</annotation><annotation encoding="application/x-llamapun" id="S1.p5.2.m2.1d">italic_O ( italic_n )</annotation></semantics></math>. The optimization space of linear complexity is small, thus the simplification strategy is very limited, and causes information loss inevitably. A <math alttext="k" class="ltx_Math" display="inline" id="S1.p5.3.m3.1"><semantics id="S1.p5.3.m3.1a"><mi id="S1.p5.3.m3.1.1" xref="S1.p5.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p5.3.m3.1b"><ci id="S1.p5.3.m3.1.1.cmml" xref="S1.p5.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S1.p5.3.m3.1d">italic_k</annotation></semantics></math>-length sub-sequence is sampled to reduce the complexity to <math alttext="O(k)\sim O(\log n)" class="ltx_Math" display="inline" id="S1.p5.4.m4.2"><semantics id="S1.p5.4.m4.2a"><mrow id="S1.p5.4.m4.2.2" xref="S1.p5.4.m4.2.2.cmml"><mrow id="S1.p5.4.m4.2.2.3" xref="S1.p5.4.m4.2.2.3.cmml"><mi id="S1.p5.4.m4.2.2.3.2" xref="S1.p5.4.m4.2.2.3.2.cmml">O</mi><mo id="S1.p5.4.m4.2.2.3.1" xref="S1.p5.4.m4.2.2.3.1.cmml">⁢</mo><mrow id="S1.p5.4.m4.2.2.3.3.2" xref="S1.p5.4.m4.2.2.3.cmml"><mo id="S1.p5.4.m4.2.2.3.3.2.1" stretchy="false" xref="S1.p5.4.m4.2.2.3.cmml">(</mo><mi id="S1.p5.4.m4.1.1" xref="S1.p5.4.m4.1.1.cmml">k</mi><mo id="S1.p5.4.m4.2.2.3.3.2.2" stretchy="false" xref="S1.p5.4.m4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S1.p5.4.m4.2.2.2" xref="S1.p5.4.m4.2.2.2.cmml">∼</mo><mrow id="S1.p5.4.m4.2.2.1" xref="S1.p5.4.m4.2.2.1.cmml"><mi id="S1.p5.4.m4.2.2.1.3" xref="S1.p5.4.m4.2.2.1.3.cmml">O</mi><mo id="S1.p5.4.m4.2.2.1.2" xref="S1.p5.4.m4.2.2.1.2.cmml">⁢</mo><mrow id="S1.p5.4.m4.2.2.1.1.1" xref="S1.p5.4.m4.2.2.1.1.1.1.cmml"><mo id="S1.p5.4.m4.2.2.1.1.1.2" stretchy="false" xref="S1.p5.4.m4.2.2.1.1.1.1.cmml">(</mo><mrow id="S1.p5.4.m4.2.2.1.1.1.1" xref="S1.p5.4.m4.2.2.1.1.1.1.cmml"><mi id="S1.p5.4.m4.2.2.1.1.1.1.1" xref="S1.p5.4.m4.2.2.1.1.1.1.1.cmml">log</mi><mo id="S1.p5.4.m4.2.2.1.1.1.1a" lspace="0.167em" xref="S1.p5.4.m4.2.2.1.1.1.1.cmml">⁡</mo><mi id="S1.p5.4.m4.2.2.1.1.1.1.2" xref="S1.p5.4.m4.2.2.1.1.1.1.2.cmml">n</mi></mrow><mo id="S1.p5.4.m4.2.2.1.1.1.3" stretchy="false" xref="S1.p5.4.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.4.m4.2b"><apply id="S1.p5.4.m4.2.2.cmml" xref="S1.p5.4.m4.2.2"><csymbol cd="latexml" id="S1.p5.4.m4.2.2.2.cmml" xref="S1.p5.4.m4.2.2.2">similar-to</csymbol><apply id="S1.p5.4.m4.2.2.3.cmml" xref="S1.p5.4.m4.2.2.3"><times id="S1.p5.4.m4.2.2.3.1.cmml" xref="S1.p5.4.m4.2.2.3.1"></times><ci id="S1.p5.4.m4.2.2.3.2.cmml" xref="S1.p5.4.m4.2.2.3.2">𝑂</ci><ci id="S1.p5.4.m4.1.1.cmml" xref="S1.p5.4.m4.1.1">𝑘</ci></apply><apply id="S1.p5.4.m4.2.2.1.cmml" xref="S1.p5.4.m4.2.2.1"><times id="S1.p5.4.m4.2.2.1.2.cmml" xref="S1.p5.4.m4.2.2.1.2"></times><ci id="S1.p5.4.m4.2.2.1.3.cmml" xref="S1.p5.4.m4.2.2.1.3">𝑂</ci><apply id="S1.p5.4.m4.2.2.1.1.1.1.cmml" xref="S1.p5.4.m4.2.2.1.1.1"><log id="S1.p5.4.m4.2.2.1.1.1.1.1.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1.1"></log><ci id="S1.p5.4.m4.2.2.1.1.1.1.2.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.4.m4.2c">O(k)\sim O(\log n)</annotation><annotation encoding="application/x-llamapun" id="S1.p5.4.m4.2d">italic_O ( italic_k ) ∼ italic_O ( roman_log italic_n )</annotation></semantics></math> in SIM, and interaction information is lost.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.8">However, there are <math alttext="m" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><mi id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">italic_m</annotation></semantics></math> target items in the candidate set to be scored in the serving stage, hence we need to perform the <math alttext="O(n)" class="ltx_Math" display="inline" id="S1.p6.2.m2.1"><semantics id="S1.p6.2.m2.1a"><mrow id="S1.p6.2.m2.1.2" xref="S1.p6.2.m2.1.2.cmml"><mi id="S1.p6.2.m2.1.2.2" xref="S1.p6.2.m2.1.2.2.cmml">O</mi><mo id="S1.p6.2.m2.1.2.1" xref="S1.p6.2.m2.1.2.1.cmml">⁢</mo><mrow id="S1.p6.2.m2.1.2.3.2" xref="S1.p6.2.m2.1.2.cmml"><mo id="S1.p6.2.m2.1.2.3.2.1" stretchy="false" xref="S1.p6.2.m2.1.2.cmml">(</mo><mi id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml">n</mi><mo id="S1.p6.2.m2.1.2.3.2.2" stretchy="false" xref="S1.p6.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><apply id="S1.p6.2.m2.1.2.cmml" xref="S1.p6.2.m2.1.2"><times id="S1.p6.2.m2.1.2.1.cmml" xref="S1.p6.2.m2.1.2.1"></times><ci id="S1.p6.2.m2.1.2.2.cmml" xref="S1.p6.2.m2.1.2.2">𝑂</ci><ci id="S1.p6.2.m2.1.1.cmml" xref="S1.p6.2.m2.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">O(n)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.2.m2.1d">italic_O ( italic_n )</annotation></semantics></math> computation <math alttext="m" class="ltx_Math" display="inline" id="S1.p6.3.m3.1"><semantics id="S1.p6.3.m3.1a"><mi id="S1.p6.3.m3.1.1" xref="S1.p6.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.p6.3.m3.1b"><ci id="S1.p6.3.m3.1.1.cmml" xref="S1.p6.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.p6.3.m3.1d">italic_m</annotation></semantics></math> times. Inspired by this, we input the whole candidate set into the model for one time to achieve quadratic time complexity <math alttext="O(mn)" class="ltx_Math" display="inline" id="S1.p6.4.m4.1"><semantics id="S1.p6.4.m4.1a"><mrow id="S1.p6.4.m4.1.1" xref="S1.p6.4.m4.1.1.cmml"><mi id="S1.p6.4.m4.1.1.3" xref="S1.p6.4.m4.1.1.3.cmml">O</mi><mo id="S1.p6.4.m4.1.1.2" xref="S1.p6.4.m4.1.1.2.cmml">⁢</mo><mrow id="S1.p6.4.m4.1.1.1.1" xref="S1.p6.4.m4.1.1.1.1.1.cmml"><mo id="S1.p6.4.m4.1.1.1.1.2" stretchy="false" xref="S1.p6.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.4.m4.1.1.1.1.1" xref="S1.p6.4.m4.1.1.1.1.1.cmml"><mi id="S1.p6.4.m4.1.1.1.1.1.2" xref="S1.p6.4.m4.1.1.1.1.1.2.cmml">m</mi><mo id="S1.p6.4.m4.1.1.1.1.1.1" xref="S1.p6.4.m4.1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.p6.4.m4.1.1.1.1.1.3" xref="S1.p6.4.m4.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S1.p6.4.m4.1.1.1.1.3" stretchy="false" xref="S1.p6.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.4.m4.1b"><apply id="S1.p6.4.m4.1.1.cmml" xref="S1.p6.4.m4.1.1"><times id="S1.p6.4.m4.1.1.2.cmml" xref="S1.p6.4.m4.1.1.2"></times><ci id="S1.p6.4.m4.1.1.3.cmml" xref="S1.p6.4.m4.1.1.3">𝑂</ci><apply id="S1.p6.4.m4.1.1.1.1.1.cmml" xref="S1.p6.4.m4.1.1.1.1"><times id="S1.p6.4.m4.1.1.1.1.1.1.cmml" xref="S1.p6.4.m4.1.1.1.1.1.1"></times><ci id="S1.p6.4.m4.1.1.1.1.1.2.cmml" xref="S1.p6.4.m4.1.1.1.1.1.2">𝑚</ci><ci id="S1.p6.4.m4.1.1.1.1.1.3.cmml" xref="S1.p6.4.m4.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.4.m4.1c">O(mn)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.4.m4.1d">italic_O ( italic_m italic_n )</annotation></semantics></math> without any extra computation. Now we have larger optimization space and more choices. To perform cross attention of the candidate set and behaviour sequence efficiently, we adopt linear transformer <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib13" title="">2020</a>)</cite> to reduce the complexity to <math alttext="O(m+n)" class="ltx_Math" display="inline" id="S1.p6.5.m5.1"><semantics id="S1.p6.5.m5.1a"><mrow id="S1.p6.5.m5.1.1" xref="S1.p6.5.m5.1.1.cmml"><mi id="S1.p6.5.m5.1.1.3" xref="S1.p6.5.m5.1.1.3.cmml">O</mi><mo id="S1.p6.5.m5.1.1.2" xref="S1.p6.5.m5.1.1.2.cmml">⁢</mo><mrow id="S1.p6.5.m5.1.1.1.1" xref="S1.p6.5.m5.1.1.1.1.1.cmml"><mo id="S1.p6.5.m5.1.1.1.1.2" stretchy="false" xref="S1.p6.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.5.m5.1.1.1.1.1" xref="S1.p6.5.m5.1.1.1.1.1.cmml"><mi id="S1.p6.5.m5.1.1.1.1.1.2" xref="S1.p6.5.m5.1.1.1.1.1.2.cmml">m</mi><mo id="S1.p6.5.m5.1.1.1.1.1.1" xref="S1.p6.5.m5.1.1.1.1.1.1.cmml">+</mo><mi id="S1.p6.5.m5.1.1.1.1.1.3" xref="S1.p6.5.m5.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S1.p6.5.m5.1.1.1.1.3" stretchy="false" xref="S1.p6.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.5.m5.1b"><apply id="S1.p6.5.m5.1.1.cmml" xref="S1.p6.5.m5.1.1"><times id="S1.p6.5.m5.1.1.2.cmml" xref="S1.p6.5.m5.1.1.2"></times><ci id="S1.p6.5.m5.1.1.3.cmml" xref="S1.p6.5.m5.1.1.3">𝑂</ci><apply id="S1.p6.5.m5.1.1.1.1.1.cmml" xref="S1.p6.5.m5.1.1.1.1"><plus id="S1.p6.5.m5.1.1.1.1.1.1.cmml" xref="S1.p6.5.m5.1.1.1.1.1.1"></plus><ci id="S1.p6.5.m5.1.1.1.1.1.2.cmml" xref="S1.p6.5.m5.1.1.1.1.1.2">𝑚</ci><ci id="S1.p6.5.m5.1.1.1.1.1.3.cmml" xref="S1.p6.5.m5.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.5.m5.1c">O(m+n)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.5.m5.1d">italic_O ( italic_m + italic_n )</annotation></semantics></math> without any interaction information loss. In this case, inferring one target item costs <math alttext="O(1+n/m)" class="ltx_Math" display="inline" id="S1.p6.6.m6.1"><semantics id="S1.p6.6.m6.1a"><mrow id="S1.p6.6.m6.1.1" xref="S1.p6.6.m6.1.1.cmml"><mi id="S1.p6.6.m6.1.1.3" xref="S1.p6.6.m6.1.1.3.cmml">O</mi><mo id="S1.p6.6.m6.1.1.2" xref="S1.p6.6.m6.1.1.2.cmml">⁢</mo><mrow id="S1.p6.6.m6.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.cmml"><mo id="S1.p6.6.m6.1.1.1.1.2" stretchy="false" xref="S1.p6.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.6.m6.1.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.cmml"><mn id="S1.p6.6.m6.1.1.1.1.1.2" xref="S1.p6.6.m6.1.1.1.1.1.2.cmml">1</mn><mo id="S1.p6.6.m6.1.1.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.1.cmml">+</mo><mrow id="S1.p6.6.m6.1.1.1.1.1.3" xref="S1.p6.6.m6.1.1.1.1.1.3.cmml"><mi id="S1.p6.6.m6.1.1.1.1.1.3.2" xref="S1.p6.6.m6.1.1.1.1.1.3.2.cmml">n</mi><mo id="S1.p6.6.m6.1.1.1.1.1.3.1" xref="S1.p6.6.m6.1.1.1.1.1.3.1.cmml">/</mo><mi id="S1.p6.6.m6.1.1.1.1.1.3.3" xref="S1.p6.6.m6.1.1.1.1.1.3.3.cmml">m</mi></mrow></mrow><mo id="S1.p6.6.m6.1.1.1.1.3" stretchy="false" xref="S1.p6.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.6.m6.1b"><apply id="S1.p6.6.m6.1.1.cmml" xref="S1.p6.6.m6.1.1"><times id="S1.p6.6.m6.1.1.2.cmml" xref="S1.p6.6.m6.1.1.2"></times><ci id="S1.p6.6.m6.1.1.3.cmml" xref="S1.p6.6.m6.1.1.3">𝑂</ci><apply id="S1.p6.6.m6.1.1.1.1.1.cmml" xref="S1.p6.6.m6.1.1.1.1"><plus id="S1.p6.6.m6.1.1.1.1.1.1.cmml" xref="S1.p6.6.m6.1.1.1.1.1.1"></plus><cn id="S1.p6.6.m6.1.1.1.1.1.2.cmml" type="integer" xref="S1.p6.6.m6.1.1.1.1.1.2">1</cn><apply id="S1.p6.6.m6.1.1.1.1.1.3.cmml" xref="S1.p6.6.m6.1.1.1.1.1.3"><divide id="S1.p6.6.m6.1.1.1.1.1.3.1.cmml" xref="S1.p6.6.m6.1.1.1.1.1.3.1"></divide><ci id="S1.p6.6.m6.1.1.1.1.1.3.2.cmml" xref="S1.p6.6.m6.1.1.1.1.1.3.2">𝑛</ci><ci id="S1.p6.6.m6.1.1.1.1.1.3.3.cmml" xref="S1.p6.6.m6.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.6.m6.1c">O(1+n/m)</annotation><annotation encoding="application/x-llamapun" id="S1.p6.6.m6.1d">italic_O ( 1 + italic_n / italic_m )</annotation></semantics></math> time, which is a constant if <math alttext="m" class="ltx_Math" display="inline" id="S1.p6.7.m7.1"><semantics id="S1.p6.7.m7.1a"><mi id="S1.p6.7.m7.1.1" xref="S1.p6.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.p6.7.m7.1b"><ci id="S1.p6.7.m7.1.1.cmml" xref="S1.p6.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.7.m7.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.p6.7.m7.1d">italic_m</annotation></semantics></math> and <math alttext="n" class="ltx_Math" display="inline" id="S1.p6.8.m8.1"><semantics id="S1.p6.8.m8.1a"><mi id="S1.p6.8.m8.1.1" xref="S1.p6.8.m8.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S1.p6.8.m8.1b"><ci id="S1.p6.8.m8.1.1.cmml" xref="S1.p6.8.m8.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.8.m8.1c">n</annotation><annotation encoding="application/x-llamapun" id="S1.p6.8.m8.1d">italic_n</annotation></semantics></math> are similar. We call our model <span class="ltx_text ltx_font_bold" id="S1.p6.8.1">I</span>nteraction <span class="ltx_text ltx_font_bold" id="S1.p6.8.2">F</span>idelity <span class="ltx_text ltx_font_bold" id="S1.p6.8.3">A</span>ttention (<span class="ltx_text ltx_font_bold" id="S1.p6.8.4">IFA</span>), which is a new paradigm for full long behaviour sequence modeling.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.8">As we need to input the whole candidate set into IFA, thus we additionally propose two optimizations: (1) Ranking task is to generate an optimal <math alttext="m^{\prime}" class="ltx_Math" display="inline" id="S1.p7.1.m1.1"><semantics id="S1.p7.1.m1.1a"><msup id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml"><mi id="S1.p7.1.m1.1.1.2" xref="S1.p7.1.m1.1.1.2.cmml">m</mi><mo id="S1.p7.1.m1.1.1.3" xref="S1.p7.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><apply id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p7.1.m1.1.1.1.cmml" xref="S1.p7.1.m1.1.1">superscript</csymbol><ci id="S1.p7.1.m1.1.1.2.cmml" xref="S1.p7.1.m1.1.1.2">𝑚</ci><ci id="S1.p7.1.m1.1.1.3.cmml" xref="S1.p7.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.p7.1.m1.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>-size candidate set from the <math alttext="m" class="ltx_Math" display="inline" id="S1.p7.2.m2.1"><semantics id="S1.p7.2.m2.1a"><mi id="S1.p7.2.m2.1.1" xref="S1.p7.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.p7.2.m2.1b"><ci id="S1.p7.2.m2.1.1.cmml" xref="S1.p7.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.p7.2.m2.1d">italic_m</annotation></semantics></math>-size one, where <math alttext="m^{\prime}\ll m" class="ltx_Math" display="inline" id="S1.p7.3.m3.1"><semantics id="S1.p7.3.m3.1a"><mrow id="S1.p7.3.m3.1.1" xref="S1.p7.3.m3.1.1.cmml"><msup id="S1.p7.3.m3.1.1.2" xref="S1.p7.3.m3.1.1.2.cmml"><mi id="S1.p7.3.m3.1.1.2.2" xref="S1.p7.3.m3.1.1.2.2.cmml">m</mi><mo id="S1.p7.3.m3.1.1.2.3" xref="S1.p7.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="S1.p7.3.m3.1.1.1" xref="S1.p7.3.m3.1.1.1.cmml">≪</mo><mi id="S1.p7.3.m3.1.1.3" xref="S1.p7.3.m3.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p7.3.m3.1b"><apply id="S1.p7.3.m3.1.1.cmml" xref="S1.p7.3.m3.1.1"><csymbol cd="latexml" id="S1.p7.3.m3.1.1.1.cmml" xref="S1.p7.3.m3.1.1.1">much-less-than</csymbol><apply id="S1.p7.3.m3.1.1.2.cmml" xref="S1.p7.3.m3.1.1.2"><csymbol cd="ambiguous" id="S1.p7.3.m3.1.1.2.1.cmml" xref="S1.p7.3.m3.1.1.2">superscript</csymbol><ci id="S1.p7.3.m3.1.1.2.2.cmml" xref="S1.p7.3.m3.1.1.2.2">𝑚</ci><ci id="S1.p7.3.m3.1.1.2.3.cmml" xref="S1.p7.3.m3.1.1.2.3">′</ci></apply><ci id="S1.p7.3.m3.1.1.3.cmml" xref="S1.p7.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.3.m3.1c">m^{\prime}\ll m</annotation><annotation encoding="application/x-llamapun" id="S1.p7.3.m3.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ≪ italic_m</annotation></semantics></math>. Considering that widely-used ranking models <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib42" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib41" title="">2019</a>; Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib23" title="">2020</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib4" title="">2023a</a>)</cite> learn a set of <math alttext="m^{\prime}" class="ltx_Math" display="inline" id="S1.p7.4.m4.1"><semantics id="S1.p7.4.m4.1a"><msup id="S1.p7.4.m4.1.1" xref="S1.p7.4.m4.1.1.cmml"><mi id="S1.p7.4.m4.1.1.2" xref="S1.p7.4.m4.1.1.2.cmml">m</mi><mo id="S1.p7.4.m4.1.1.3" xref="S1.p7.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S1.p7.4.m4.1b"><apply id="S1.p7.4.m4.1.1.cmml" xref="S1.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p7.4.m4.1.1.1.cmml" xref="S1.p7.4.m4.1.1">superscript</csymbol><ci id="S1.p7.4.m4.1.1.2.cmml" xref="S1.p7.4.m4.1.1.2">𝑚</ci><ci id="S1.p7.4.m4.1.1.3.cmml" xref="S1.p7.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.4.m4.1c">m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.p7.4.m4.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> top-1 items rather than a best top-<math alttext="m^{\prime}" class="ltx_Math" display="inline" id="S1.p7.5.m5.1"><semantics id="S1.p7.5.m5.1a"><msup id="S1.p7.5.m5.1.1" xref="S1.p7.5.m5.1.1.cmml"><mi id="S1.p7.5.m5.1.1.2" xref="S1.p7.5.m5.1.1.2.cmml">m</mi><mo id="S1.p7.5.m5.1.1.3" xref="S1.p7.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S1.p7.5.m5.1b"><apply id="S1.p7.5.m5.1.1.cmml" xref="S1.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p7.5.m5.1.1.1.cmml" xref="S1.p7.5.m5.1.1">superscript</csymbol><ci id="S1.p7.5.m5.1.1.2.cmml" xref="S1.p7.5.m5.1.1.2">𝑚</ci><ci id="S1.p7.5.m5.1.1.3.cmml" xref="S1.p7.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.5.m5.1c">m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.p7.5.m5.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> set in a point wise way, we design an efficient relationship aware module to model the relationship for large-scale candidate sets. (2) We solve the Sample Selection Bias (SSB) issue <cite class="ltx_cite ltx_citemacro_citep">(Zadrozny, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib37" title="">2004</a>)</cite> by training and inferring on candidate set. To learn better probability contribution, we model <span class="ltx_text ltx_font_italic" id="S1.p7.8.1">cli</span>ck through <span class="ltx_text ltx_font_italic" id="S1.p7.8.2">imp</span>ression rate <math alttext="pCTR=p(cli|imp)" class="ltx_Math" display="inline" id="S1.p7.6.m6.1"><semantics id="S1.p7.6.m6.1a"><mrow id="S1.p7.6.m6.1.1" xref="S1.p7.6.m6.1.1.cmml"><mrow id="S1.p7.6.m6.1.1.3" xref="S1.p7.6.m6.1.1.3.cmml"><mi id="S1.p7.6.m6.1.1.3.2" xref="S1.p7.6.m6.1.1.3.2.cmml">p</mi><mo id="S1.p7.6.m6.1.1.3.1" xref="S1.p7.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.6.m6.1.1.3.3" xref="S1.p7.6.m6.1.1.3.3.cmml">C</mi><mo id="S1.p7.6.m6.1.1.3.1a" xref="S1.p7.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.6.m6.1.1.3.4" xref="S1.p7.6.m6.1.1.3.4.cmml">T</mi><mo id="S1.p7.6.m6.1.1.3.1b" xref="S1.p7.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.6.m6.1.1.3.5" xref="S1.p7.6.m6.1.1.3.5.cmml">R</mi></mrow><mo id="S1.p7.6.m6.1.1.2" xref="S1.p7.6.m6.1.1.2.cmml">=</mo><mrow id="S1.p7.6.m6.1.1.1" xref="S1.p7.6.m6.1.1.1.cmml"><mi id="S1.p7.6.m6.1.1.1.3" xref="S1.p7.6.m6.1.1.1.3.cmml">p</mi><mo id="S1.p7.6.m6.1.1.1.2" xref="S1.p7.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S1.p7.6.m6.1.1.1.1.1" xref="S1.p7.6.m6.1.1.1.1.1.1.cmml"><mo id="S1.p7.6.m6.1.1.1.1.1.2" stretchy="false" xref="S1.p7.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p7.6.m6.1.1.1.1.1.1" xref="S1.p7.6.m6.1.1.1.1.1.1.cmml"><mrow id="S1.p7.6.m6.1.1.1.1.1.1.2" xref="S1.p7.6.m6.1.1.1.1.1.1.2.cmml"><mi id="S1.p7.6.m6.1.1.1.1.1.1.2.2" xref="S1.p7.6.m6.1.1.1.1.1.1.2.2.cmml">c</mi><mo id="S1.p7.6.m6.1.1.1.1.1.1.2.1" xref="S1.p7.6.m6.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S1.p7.6.m6.1.1.1.1.1.1.2.3" xref="S1.p7.6.m6.1.1.1.1.1.1.2.3.cmml">l</mi><mo id="S1.p7.6.m6.1.1.1.1.1.1.2.1a" xref="S1.p7.6.m6.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S1.p7.6.m6.1.1.1.1.1.1.2.4" xref="S1.p7.6.m6.1.1.1.1.1.1.2.4.cmml">i</mi></mrow><mo fence="false" id="S1.p7.6.m6.1.1.1.1.1.1.1" xref="S1.p7.6.m6.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S1.p7.6.m6.1.1.1.1.1.1.3" xref="S1.p7.6.m6.1.1.1.1.1.1.3.cmml"><mi id="S1.p7.6.m6.1.1.1.1.1.1.3.2" xref="S1.p7.6.m6.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S1.p7.6.m6.1.1.1.1.1.1.3.1" xref="S1.p7.6.m6.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.6.m6.1.1.1.1.1.1.3.3" xref="S1.p7.6.m6.1.1.1.1.1.1.3.3.cmml">m</mi><mo id="S1.p7.6.m6.1.1.1.1.1.1.3.1a" xref="S1.p7.6.m6.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.6.m6.1.1.1.1.1.1.3.4" xref="S1.p7.6.m6.1.1.1.1.1.1.3.4.cmml">p</mi></mrow></mrow><mo id="S1.p7.6.m6.1.1.1.1.1.3" stretchy="false" xref="S1.p7.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p7.6.m6.1b"><apply id="S1.p7.6.m6.1.1.cmml" xref="S1.p7.6.m6.1.1"><eq id="S1.p7.6.m6.1.1.2.cmml" xref="S1.p7.6.m6.1.1.2"></eq><apply id="S1.p7.6.m6.1.1.3.cmml" xref="S1.p7.6.m6.1.1.3"><times id="S1.p7.6.m6.1.1.3.1.cmml" xref="S1.p7.6.m6.1.1.3.1"></times><ci id="S1.p7.6.m6.1.1.3.2.cmml" xref="S1.p7.6.m6.1.1.3.2">𝑝</ci><ci id="S1.p7.6.m6.1.1.3.3.cmml" xref="S1.p7.6.m6.1.1.3.3">𝐶</ci><ci id="S1.p7.6.m6.1.1.3.4.cmml" xref="S1.p7.6.m6.1.1.3.4">𝑇</ci><ci id="S1.p7.6.m6.1.1.3.5.cmml" xref="S1.p7.6.m6.1.1.3.5">𝑅</ci></apply><apply id="S1.p7.6.m6.1.1.1.cmml" xref="S1.p7.6.m6.1.1.1"><times id="S1.p7.6.m6.1.1.1.2.cmml" xref="S1.p7.6.m6.1.1.1.2"></times><ci id="S1.p7.6.m6.1.1.1.3.cmml" xref="S1.p7.6.m6.1.1.1.3">𝑝</ci><apply id="S1.p7.6.m6.1.1.1.1.1.1.cmml" xref="S1.p7.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S1.p7.6.m6.1.1.1.1.1.1.1.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.1">conditional</csymbol><apply id="S1.p7.6.m6.1.1.1.1.1.1.2.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.2"><times id="S1.p7.6.m6.1.1.1.1.1.1.2.1.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.2.1"></times><ci id="S1.p7.6.m6.1.1.1.1.1.1.2.2.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S1.p7.6.m6.1.1.1.1.1.1.2.3.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.2.3">𝑙</ci><ci id="S1.p7.6.m6.1.1.1.1.1.1.2.4.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.2.4">𝑖</ci></apply><apply id="S1.p7.6.m6.1.1.1.1.1.1.3.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.3"><times id="S1.p7.6.m6.1.1.1.1.1.1.3.1.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.3.1"></times><ci id="S1.p7.6.m6.1.1.1.1.1.1.3.2.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S1.p7.6.m6.1.1.1.1.1.1.3.3.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.3.3">𝑚</ci><ci id="S1.p7.6.m6.1.1.1.1.1.1.3.4.cmml" xref="S1.p7.6.m6.1.1.1.1.1.1.3.4">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.6.m6.1c">pCTR=p(cli|imp)</annotation><annotation encoding="application/x-llamapun" id="S1.p7.6.m6.1d">italic_p italic_C italic_T italic_R = italic_p ( italic_c italic_l italic_i | italic_i italic_m italic_p )</annotation></semantics></math> and <span class="ltx_text ltx_font_italic" id="S1.p7.8.3">imp</span>ression through <span class="ltx_text ltx_font_italic" id="S1.p7.8.4">can</span>didate rate <math alttext="pITR=p(imp|can)" class="ltx_Math" display="inline" id="S1.p7.7.m7.1"><semantics id="S1.p7.7.m7.1a"><mrow id="S1.p7.7.m7.1.1" xref="S1.p7.7.m7.1.1.cmml"><mrow id="S1.p7.7.m7.1.1.3" xref="S1.p7.7.m7.1.1.3.cmml"><mi id="S1.p7.7.m7.1.1.3.2" xref="S1.p7.7.m7.1.1.3.2.cmml">p</mi><mo id="S1.p7.7.m7.1.1.3.1" xref="S1.p7.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.7.m7.1.1.3.3" xref="S1.p7.7.m7.1.1.3.3.cmml">I</mi><mo id="S1.p7.7.m7.1.1.3.1a" xref="S1.p7.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.7.m7.1.1.3.4" xref="S1.p7.7.m7.1.1.3.4.cmml">T</mi><mo id="S1.p7.7.m7.1.1.3.1b" xref="S1.p7.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.7.m7.1.1.3.5" xref="S1.p7.7.m7.1.1.3.5.cmml">R</mi></mrow><mo id="S1.p7.7.m7.1.1.2" xref="S1.p7.7.m7.1.1.2.cmml">=</mo><mrow id="S1.p7.7.m7.1.1.1" xref="S1.p7.7.m7.1.1.1.cmml"><mi id="S1.p7.7.m7.1.1.1.3" xref="S1.p7.7.m7.1.1.1.3.cmml">p</mi><mo id="S1.p7.7.m7.1.1.1.2" xref="S1.p7.7.m7.1.1.1.2.cmml">⁢</mo><mrow id="S1.p7.7.m7.1.1.1.1.1" xref="S1.p7.7.m7.1.1.1.1.1.1.cmml"><mo id="S1.p7.7.m7.1.1.1.1.1.2" stretchy="false" xref="S1.p7.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p7.7.m7.1.1.1.1.1.1" xref="S1.p7.7.m7.1.1.1.1.1.1.cmml"><mrow id="S1.p7.7.m7.1.1.1.1.1.1.2" xref="S1.p7.7.m7.1.1.1.1.1.1.2.cmml"><mi id="S1.p7.7.m7.1.1.1.1.1.1.2.2" xref="S1.p7.7.m7.1.1.1.1.1.1.2.2.cmml">i</mi><mo id="S1.p7.7.m7.1.1.1.1.1.1.2.1" xref="S1.p7.7.m7.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S1.p7.7.m7.1.1.1.1.1.1.2.3" xref="S1.p7.7.m7.1.1.1.1.1.1.2.3.cmml">m</mi><mo id="S1.p7.7.m7.1.1.1.1.1.1.2.1a" xref="S1.p7.7.m7.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S1.p7.7.m7.1.1.1.1.1.1.2.4" xref="S1.p7.7.m7.1.1.1.1.1.1.2.4.cmml">p</mi></mrow><mo fence="false" id="S1.p7.7.m7.1.1.1.1.1.1.1" xref="S1.p7.7.m7.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S1.p7.7.m7.1.1.1.1.1.1.3" xref="S1.p7.7.m7.1.1.1.1.1.1.3.cmml"><mi id="S1.p7.7.m7.1.1.1.1.1.1.3.2" xref="S1.p7.7.m7.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S1.p7.7.m7.1.1.1.1.1.1.3.1" xref="S1.p7.7.m7.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.7.m7.1.1.1.1.1.1.3.3" xref="S1.p7.7.m7.1.1.1.1.1.1.3.3.cmml">a</mi><mo id="S1.p7.7.m7.1.1.1.1.1.1.3.1a" xref="S1.p7.7.m7.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.7.m7.1.1.1.1.1.1.3.4" xref="S1.p7.7.m7.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></mrow><mo id="S1.p7.7.m7.1.1.1.1.1.3" stretchy="false" xref="S1.p7.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p7.7.m7.1b"><apply id="S1.p7.7.m7.1.1.cmml" xref="S1.p7.7.m7.1.1"><eq id="S1.p7.7.m7.1.1.2.cmml" xref="S1.p7.7.m7.1.1.2"></eq><apply id="S1.p7.7.m7.1.1.3.cmml" xref="S1.p7.7.m7.1.1.3"><times id="S1.p7.7.m7.1.1.3.1.cmml" xref="S1.p7.7.m7.1.1.3.1"></times><ci id="S1.p7.7.m7.1.1.3.2.cmml" xref="S1.p7.7.m7.1.1.3.2">𝑝</ci><ci id="S1.p7.7.m7.1.1.3.3.cmml" xref="S1.p7.7.m7.1.1.3.3">𝐼</ci><ci id="S1.p7.7.m7.1.1.3.4.cmml" xref="S1.p7.7.m7.1.1.3.4">𝑇</ci><ci id="S1.p7.7.m7.1.1.3.5.cmml" xref="S1.p7.7.m7.1.1.3.5">𝑅</ci></apply><apply id="S1.p7.7.m7.1.1.1.cmml" xref="S1.p7.7.m7.1.1.1"><times id="S1.p7.7.m7.1.1.1.2.cmml" xref="S1.p7.7.m7.1.1.1.2"></times><ci id="S1.p7.7.m7.1.1.1.3.cmml" xref="S1.p7.7.m7.1.1.1.3">𝑝</ci><apply id="S1.p7.7.m7.1.1.1.1.1.1.cmml" xref="S1.p7.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="S1.p7.7.m7.1.1.1.1.1.1.1.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.1">conditional</csymbol><apply id="S1.p7.7.m7.1.1.1.1.1.1.2.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.2"><times id="S1.p7.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.2.1"></times><ci id="S1.p7.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.2.2">𝑖</ci><ci id="S1.p7.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.2.3">𝑚</ci><ci id="S1.p7.7.m7.1.1.1.1.1.1.2.4.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.2.4">𝑝</ci></apply><apply id="S1.p7.7.m7.1.1.1.1.1.1.3.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.3"><times id="S1.p7.7.m7.1.1.1.1.1.1.3.1.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.3.1"></times><ci id="S1.p7.7.m7.1.1.1.1.1.1.3.2.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S1.p7.7.m7.1.1.1.1.1.1.3.3.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.3.3">𝑎</ci><ci id="S1.p7.7.m7.1.1.1.1.1.1.3.4.cmml" xref="S1.p7.7.m7.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.7.m7.1c">pITR=p(imp|can)</annotation><annotation encoding="application/x-llamapun" id="S1.p7.7.m7.1d">italic_p italic_I italic_T italic_R = italic_p ( italic_i italic_m italic_p | italic_c italic_a italic_n )</annotation></semantics></math>, and combine them into impression through &amp; click through rate <math alttext="pITCTR=p(cli|can)" class="ltx_Math" display="inline" id="S1.p7.8.m8.1"><semantics id="S1.p7.8.m8.1a"><mrow id="S1.p7.8.m8.1.1" xref="S1.p7.8.m8.1.1.cmml"><mrow id="S1.p7.8.m8.1.1.3" xref="S1.p7.8.m8.1.1.3.cmml"><mi id="S1.p7.8.m8.1.1.3.2" xref="S1.p7.8.m8.1.1.3.2.cmml">p</mi><mo id="S1.p7.8.m8.1.1.3.1" xref="S1.p7.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.3.3" xref="S1.p7.8.m8.1.1.3.3.cmml">I</mi><mo id="S1.p7.8.m8.1.1.3.1a" xref="S1.p7.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.3.4" xref="S1.p7.8.m8.1.1.3.4.cmml">T</mi><mo id="S1.p7.8.m8.1.1.3.1b" xref="S1.p7.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.3.5" xref="S1.p7.8.m8.1.1.3.5.cmml">C</mi><mo id="S1.p7.8.m8.1.1.3.1c" xref="S1.p7.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.3.6" xref="S1.p7.8.m8.1.1.3.6.cmml">T</mi><mo id="S1.p7.8.m8.1.1.3.1d" xref="S1.p7.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.3.7" xref="S1.p7.8.m8.1.1.3.7.cmml">R</mi></mrow><mo id="S1.p7.8.m8.1.1.2" xref="S1.p7.8.m8.1.1.2.cmml">=</mo><mrow id="S1.p7.8.m8.1.1.1" xref="S1.p7.8.m8.1.1.1.cmml"><mi id="S1.p7.8.m8.1.1.1.3" xref="S1.p7.8.m8.1.1.1.3.cmml">p</mi><mo id="S1.p7.8.m8.1.1.1.2" xref="S1.p7.8.m8.1.1.1.2.cmml">⁢</mo><mrow id="S1.p7.8.m8.1.1.1.1.1" xref="S1.p7.8.m8.1.1.1.1.1.1.cmml"><mo id="S1.p7.8.m8.1.1.1.1.1.2" stretchy="false" xref="S1.p7.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p7.8.m8.1.1.1.1.1.1" xref="S1.p7.8.m8.1.1.1.1.1.1.cmml"><mrow id="S1.p7.8.m8.1.1.1.1.1.1.2" xref="S1.p7.8.m8.1.1.1.1.1.1.2.cmml"><mi id="S1.p7.8.m8.1.1.1.1.1.1.2.2" xref="S1.p7.8.m8.1.1.1.1.1.1.2.2.cmml">c</mi><mo id="S1.p7.8.m8.1.1.1.1.1.1.2.1" xref="S1.p7.8.m8.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.1.1.1.1.2.3" xref="S1.p7.8.m8.1.1.1.1.1.1.2.3.cmml">l</mi><mo id="S1.p7.8.m8.1.1.1.1.1.1.2.1a" xref="S1.p7.8.m8.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.1.1.1.1.2.4" xref="S1.p7.8.m8.1.1.1.1.1.1.2.4.cmml">i</mi></mrow><mo fence="false" id="S1.p7.8.m8.1.1.1.1.1.1.1" xref="S1.p7.8.m8.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S1.p7.8.m8.1.1.1.1.1.1.3" xref="S1.p7.8.m8.1.1.1.1.1.1.3.cmml"><mi id="S1.p7.8.m8.1.1.1.1.1.1.3.2" xref="S1.p7.8.m8.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S1.p7.8.m8.1.1.1.1.1.1.3.1" xref="S1.p7.8.m8.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.1.1.1.1.3.3" xref="S1.p7.8.m8.1.1.1.1.1.1.3.3.cmml">a</mi><mo id="S1.p7.8.m8.1.1.1.1.1.1.3.1a" xref="S1.p7.8.m8.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S1.p7.8.m8.1.1.1.1.1.1.3.4" xref="S1.p7.8.m8.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></mrow><mo id="S1.p7.8.m8.1.1.1.1.1.3" stretchy="false" xref="S1.p7.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p7.8.m8.1b"><apply id="S1.p7.8.m8.1.1.cmml" xref="S1.p7.8.m8.1.1"><eq id="S1.p7.8.m8.1.1.2.cmml" xref="S1.p7.8.m8.1.1.2"></eq><apply id="S1.p7.8.m8.1.1.3.cmml" xref="S1.p7.8.m8.1.1.3"><times id="S1.p7.8.m8.1.1.3.1.cmml" xref="S1.p7.8.m8.1.1.3.1"></times><ci id="S1.p7.8.m8.1.1.3.2.cmml" xref="S1.p7.8.m8.1.1.3.2">𝑝</ci><ci id="S1.p7.8.m8.1.1.3.3.cmml" xref="S1.p7.8.m8.1.1.3.3">𝐼</ci><ci id="S1.p7.8.m8.1.1.3.4.cmml" xref="S1.p7.8.m8.1.1.3.4">𝑇</ci><ci id="S1.p7.8.m8.1.1.3.5.cmml" xref="S1.p7.8.m8.1.1.3.5">𝐶</ci><ci id="S1.p7.8.m8.1.1.3.6.cmml" xref="S1.p7.8.m8.1.1.3.6">𝑇</ci><ci id="S1.p7.8.m8.1.1.3.7.cmml" xref="S1.p7.8.m8.1.1.3.7">𝑅</ci></apply><apply id="S1.p7.8.m8.1.1.1.cmml" xref="S1.p7.8.m8.1.1.1"><times id="S1.p7.8.m8.1.1.1.2.cmml" xref="S1.p7.8.m8.1.1.1.2"></times><ci id="S1.p7.8.m8.1.1.1.3.cmml" xref="S1.p7.8.m8.1.1.1.3">𝑝</ci><apply id="S1.p7.8.m8.1.1.1.1.1.1.cmml" xref="S1.p7.8.m8.1.1.1.1.1"><csymbol cd="latexml" id="S1.p7.8.m8.1.1.1.1.1.1.1.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.1">conditional</csymbol><apply id="S1.p7.8.m8.1.1.1.1.1.1.2.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.2"><times id="S1.p7.8.m8.1.1.1.1.1.1.2.1.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.2.1"></times><ci id="S1.p7.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S1.p7.8.m8.1.1.1.1.1.1.2.3.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.2.3">𝑙</ci><ci id="S1.p7.8.m8.1.1.1.1.1.1.2.4.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.2.4">𝑖</ci></apply><apply id="S1.p7.8.m8.1.1.1.1.1.1.3.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.3"><times id="S1.p7.8.m8.1.1.1.1.1.1.3.1.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.3.1"></times><ci id="S1.p7.8.m8.1.1.1.1.1.1.3.2.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S1.p7.8.m8.1.1.1.1.1.1.3.3.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.3.3">𝑎</ci><ci id="S1.p7.8.m8.1.1.1.1.1.1.3.4.cmml" xref="S1.p7.8.m8.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.8.m8.1c">pITCTR=p(cli|can)</annotation><annotation encoding="application/x-llamapun" id="S1.p7.8.m8.1d">italic_p italic_I italic_T italic_C italic_T italic_R = italic_p ( italic_c italic_l italic_i | italic_c italic_a italic_n )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">The contributions are listed as follows:</p>
</div>
<div class="ltx_para" id="S1.p9">
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">We propose an Interaction Fidelity Attention (IFA) model to construct interactions between target items and sequence items without any information loss efficiently.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1">We model the relationship between target items in the candidate set to return an optimal top-<math alttext="m^{\prime}" class="ltx_Math" display="inline" id="S1.I2.i2.p1.1.m1.1"><semantics id="S1.I2.i2.p1.1.m1.1a"><msup id="S1.I2.i2.p1.1.m1.1.1" xref="S1.I2.i2.p1.1.m1.1.1.cmml"><mi id="S1.I2.i2.p1.1.m1.1.1.2" xref="S1.I2.i2.p1.1.m1.1.1.2.cmml">m</mi><mo id="S1.I2.i2.p1.1.m1.1.1.3" xref="S1.I2.i2.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S1.I2.i2.p1.1.m1.1b"><apply id="S1.I2.i2.p1.1.m1.1.1.cmml" xref="S1.I2.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.I2.i2.p1.1.m1.1.1.1.cmml" xref="S1.I2.i2.p1.1.m1.1.1">superscript</csymbol><ci id="S1.I2.i2.p1.1.m1.1.1.2.cmml" xref="S1.I2.i2.p1.1.m1.1.1.2">𝑚</ci><ci id="S1.I2.i2.p1.1.m1.1.1.3.cmml" xref="S1.I2.i2.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I2.i2.p1.1.m1.1c">m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S1.I2.i2.p1.1.m1.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> set.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1">We design a loss function for better consistency of training and inference.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i4.p1">
<p class="ltx_p" id="S1.I2.i4.p1.1">We design comprehensive experiments to demonstrate the effectiveness of our proposed IFA model.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we introduce some related work about lifelong sequence ranking models, efficient transformer, and relationship aware models.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Lifelong Sequence Modeling</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Behaviour sequence provides abundant information of user interests and is widely-used in industry recommendation models. <cite class="ltx_cite ltx_citemacro_citet">Zhou et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib42" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib41" title="">2019</a>)</cite> perform attention with the target item as query and short-term user behavior sequence as key and value, to search if there are historical items similar to the target item. Real-world applications show that the performance increases significantly with the increasing of sequence length. To involve in lifelong sequence, SIM and variants are proposed by separating the target attention into a concatenation of GSU (to sample sub-sequence) and ESU (to build interactions of target item and sub-sequence) <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib23" title="">2020</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib4" title="">2023a</a>)</cite>. GSU is a simple similarity rule, such as in the same category or cluster <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib23" title="">2020</a>)</cite> and a lightweight target attention <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib4" title="">2023a</a>)</cite>. All existing models for lifelong sequence adopt this two-step structure thus lose interaction information. In this paper, we design a new paradigm to reserve all items in the sequence.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Efficient Transformer</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Our IFA model needs efficient transformer to simplify quadratic-complexity attention. There are three paths: (1) sampling interactions <cite class="ltx_cite ltx_citemacro_citep">(Kitaev et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib14" title="">2020</a>; Beltagy et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib2" title="">2020</a>; Zaheer et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib38" title="">2020</a>)</cite>; (2) building coarse-grained interactions by clustering centers <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib21" title="">2021</a>; Vyas et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib28" title="">2020</a>; Lee et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib16" title="">2019</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib29" title="">2020</a>)</cite>; and (3) using kernel function to replace softmax and changing the order of matrix multiplication <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib13" title="">2020</a>)</cite>. Considering paths 1 and 2 both damage the interaction information (coverage and accuracy of interaction), we adopt path 3 in IFA model. To be specific, we leverage Linear Transformer <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib13" title="">2020</a>)</cite> to replace the standard attention.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Relationship Aware Modeling</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.2">We aim to generate the best top-<math alttext="m^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><msup id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">m</mi><mo id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑚</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> set in the ranking stage, however, existing models only consider if the item fit the user’s preference, which generate a set of <math alttext="m^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><msup id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">m</mi><mo id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝑚</ci><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">m^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">italic_m start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> top-1 items. To close this gap, <cite class="ltx_cite ltx_citemacro_citep">(Pei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib22" title="">2019</a>)</cite> leverages transformer to model the mutual influence of target items in the candidate set. However, this method is for the re-ranking task, where the candidate set is small. In this paper, we design an efficient module for relation aware in large-scale candidate set.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Preliminary</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.10">In this section, we introduce the preliminary about Linear Transformer. In this paper, we use Italic letters to indicate numbers, and use bold uppercase/lowercase letters refer to matrices/vectors. For example, <math alttext="{\bm{{\rm A}}}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">{\bm{{\rm A}}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">bold_A</annotation></semantics></math> is a matrix, <math alttext="{\bm{{\rm A}}}_{x}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">𝐀</mi><mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝐀</ci><ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">{\bm{{\rm A}}}_{x}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">bold_A start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> is a matrix for attribute <math alttext="x" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_x</annotation></semantics></math>. For input matrices of query <math alttext="{\bm{{\rm E}}}_{Q}\in\mathbb{R}^{m\times d_{Q}}" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><msub id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml"><mi id="S3.p1.4.m4.1.1.2.2" xref="S3.p1.4.m4.1.1.2.2.cmml">𝐄</mi><mi id="S3.p1.4.m4.1.1.2.3" xref="S3.p1.4.m4.1.1.2.3.cmml">Q</mi></msub><mo id="S3.p1.4.m4.1.1.1" xref="S3.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml"><mi id="S3.p1.4.m4.1.1.3.2" xref="S3.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.4.m4.1.1.3.3" xref="S3.p1.4.m4.1.1.3.3.cmml"><mi id="S3.p1.4.m4.1.1.3.3.2" xref="S3.p1.4.m4.1.1.3.3.2.cmml">m</mi><mo id="S3.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.p1.4.m4.1.1.3.3.3" xref="S3.p1.4.m4.1.1.3.3.3.cmml"><mi id="S3.p1.4.m4.1.1.3.3.3.2" xref="S3.p1.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.p1.4.m4.1.1.3.3.3.3" xref="S3.p1.4.m4.1.1.3.3.3.3.cmml">Q</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><in id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1"></in><apply id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.2.1.cmml" xref="S3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.2.cmml" xref="S3.p1.4.m4.1.1.2.2">𝐄</ci><ci id="S3.p1.4.m4.1.1.2.3.cmml" xref="S3.p1.4.m4.1.1.2.3">𝑄</ci></apply><apply id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.3.1.cmml" xref="S3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.p1.4.m4.1.1.3.2.cmml" xref="S3.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.p1.4.m4.1.1.3.3.cmml" xref="S3.p1.4.m4.1.1.3.3"><times id="S3.p1.4.m4.1.1.3.3.1.cmml" xref="S3.p1.4.m4.1.1.3.3.1"></times><ci id="S3.p1.4.m4.1.1.3.3.2.cmml" xref="S3.p1.4.m4.1.1.3.3.2">𝑚</ci><apply id="S3.p1.4.m4.1.1.3.3.3.cmml" xref="S3.p1.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.3.3.3.1.cmml" xref="S3.p1.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.p1.4.m4.1.1.3.3.3.2.cmml" xref="S3.p1.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.p1.4.m4.1.1.3.3.3.3.cmml" xref="S3.p1.4.m4.1.1.3.3.3.3">𝑄</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">{\bm{{\rm E}}}_{Q}\in\mathbb{R}^{m\times d_{Q}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">bold_E start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, key <math alttext="{\bm{{\rm E}}}_{K}\in\mathbb{R}^{n\times d_{K}}" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><msub id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml"><mi id="S3.p1.5.m5.1.1.2.2" xref="S3.p1.5.m5.1.1.2.2.cmml">𝐄</mi><mi id="S3.p1.5.m5.1.1.2.3" xref="S3.p1.5.m5.1.1.2.3.cmml">K</mi></msub><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml"><mi id="S3.p1.5.m5.1.1.3.2" xref="S3.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.5.m5.1.1.3.3" xref="S3.p1.5.m5.1.1.3.3.cmml"><mi id="S3.p1.5.m5.1.1.3.3.2" xref="S3.p1.5.m5.1.1.3.3.2.cmml">n</mi><mo id="S3.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S3.p1.5.m5.1.1.3.3.3" xref="S3.p1.5.m5.1.1.3.3.3.cmml"><mi id="S3.p1.5.m5.1.1.3.3.3.2" xref="S3.p1.5.m5.1.1.3.3.3.2.cmml">d</mi><mi id="S3.p1.5.m5.1.1.3.3.3.3" xref="S3.p1.5.m5.1.1.3.3.3.3.cmml">K</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><in id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></in><apply id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.2.1.cmml" xref="S3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.2.cmml" xref="S3.p1.5.m5.1.1.2.2">𝐄</ci><ci id="S3.p1.5.m5.1.1.2.3.cmml" xref="S3.p1.5.m5.1.1.2.3">𝐾</ci></apply><apply id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.3.1.cmml" xref="S3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.p1.5.m5.1.1.3.2.cmml" xref="S3.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.p1.5.m5.1.1.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3"><times id="S3.p1.5.m5.1.1.3.3.1.cmml" xref="S3.p1.5.m5.1.1.3.3.1"></times><ci id="S3.p1.5.m5.1.1.3.3.2.cmml" xref="S3.p1.5.m5.1.1.3.3.2">𝑛</ci><apply id="S3.p1.5.m5.1.1.3.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.3.3.3.1.cmml" xref="S3.p1.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S3.p1.5.m5.1.1.3.3.3.2.cmml" xref="S3.p1.5.m5.1.1.3.3.3.2">𝑑</ci><ci id="S3.p1.5.m5.1.1.3.3.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">{\bm{{\rm E}}}_{K}\in\mathbb{R}^{n\times d_{K}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">bold_E start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and value <math alttext="{\bm{{\rm E}}}_{V}\in\mathbb{R}^{n\times d_{V}}" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mrow id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><msub id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml"><mi id="S3.p1.6.m6.1.1.2.2" xref="S3.p1.6.m6.1.1.2.2.cmml">𝐄</mi><mi id="S3.p1.6.m6.1.1.2.3" xref="S3.p1.6.m6.1.1.2.3.cmml">V</mi></msub><mo id="S3.p1.6.m6.1.1.1" xref="S3.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml"><mi id="S3.p1.6.m6.1.1.3.2" xref="S3.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.6.m6.1.1.3.3" xref="S3.p1.6.m6.1.1.3.3.cmml"><mi id="S3.p1.6.m6.1.1.3.3.2" xref="S3.p1.6.m6.1.1.3.3.2.cmml">n</mi><mo id="S3.p1.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S3.p1.6.m6.1.1.3.3.3" xref="S3.p1.6.m6.1.1.3.3.3.cmml"><mi id="S3.p1.6.m6.1.1.3.3.3.2" xref="S3.p1.6.m6.1.1.3.3.3.2.cmml">d</mi><mi id="S3.p1.6.m6.1.1.3.3.3.3" xref="S3.p1.6.m6.1.1.3.3.3.3.cmml">V</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><in id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1"></in><apply id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.2.1.cmml" xref="S3.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.2.cmml" xref="S3.p1.6.m6.1.1.2.2">𝐄</ci><ci id="S3.p1.6.m6.1.1.2.3.cmml" xref="S3.p1.6.m6.1.1.2.3">𝑉</ci></apply><apply id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.3.1.cmml" xref="S3.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.p1.6.m6.1.1.3.2.cmml" xref="S3.p1.6.m6.1.1.3.2">ℝ</ci><apply id="S3.p1.6.m6.1.1.3.3.cmml" xref="S3.p1.6.m6.1.1.3.3"><times id="S3.p1.6.m6.1.1.3.3.1.cmml" xref="S3.p1.6.m6.1.1.3.3.1"></times><ci id="S3.p1.6.m6.1.1.3.3.2.cmml" xref="S3.p1.6.m6.1.1.3.3.2">𝑛</ci><apply id="S3.p1.6.m6.1.1.3.3.3.cmml" xref="S3.p1.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.3.3.3.1.cmml" xref="S3.p1.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S3.p1.6.m6.1.1.3.3.3.2.cmml" xref="S3.p1.6.m6.1.1.3.3.3.2">𝑑</ci><ci id="S3.p1.6.m6.1.1.3.3.3.3.cmml" xref="S3.p1.6.m6.1.1.3.3.3.3">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">{\bm{{\rm E}}}_{V}\in\mathbb{R}^{n\times d_{V}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">bold_E start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, the cross attention is defined as <math alttext="{\bm{{\rm E}}}={\rm softmax}(\frac{{\bm{{\rm Q}}}{\bm{{\rm K}}}^{\mathsf{T}}}{%
\sqrt{d}}){\bm{{\rm V}}}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><mrow id="S3.p1.7.m7.1.2" xref="S3.p1.7.m7.1.2.cmml"><mi id="S3.p1.7.m7.1.2.2" xref="S3.p1.7.m7.1.2.2.cmml">𝐄</mi><mo id="S3.p1.7.m7.1.2.1" xref="S3.p1.7.m7.1.2.1.cmml">=</mo><mrow id="S3.p1.7.m7.1.2.3" xref="S3.p1.7.m7.1.2.3.cmml"><mi id="S3.p1.7.m7.1.2.3.2" xref="S3.p1.7.m7.1.2.3.2.cmml">softmax</mi><mo id="S3.p1.7.m7.1.2.3.1" xref="S3.p1.7.m7.1.2.3.1.cmml">⁢</mo><mrow id="S3.p1.7.m7.1.2.3.3.2" xref="S3.p1.7.m7.1.1.cmml"><mo id="S3.p1.7.m7.1.2.3.3.2.1" stretchy="false" xref="S3.p1.7.m7.1.1.cmml">(</mo><mfrac id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><msup id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml"><mi id="S3.p1.7.m7.1.1.2.2" xref="S3.p1.7.m7.1.1.2.2.cmml">𝐐𝐊</mi><mi id="S3.p1.7.m7.1.1.2.3" xref="S3.p1.7.m7.1.1.2.3.cmml">𝖳</mi></msup><msqrt id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml"><mi id="S3.p1.7.m7.1.1.3.2" xref="S3.p1.7.m7.1.1.3.2.cmml">d</mi></msqrt></mfrac><mo id="S3.p1.7.m7.1.2.3.3.2.2" stretchy="false" xref="S3.p1.7.m7.1.1.cmml">)</mo></mrow><mo id="S3.p1.7.m7.1.2.3.1a" xref="S3.p1.7.m7.1.2.3.1.cmml">⁢</mo><mi id="S3.p1.7.m7.1.2.3.4" xref="S3.p1.7.m7.1.2.3.4.cmml">𝐕</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.2.cmml" xref="S3.p1.7.m7.1.2"><eq id="S3.p1.7.m7.1.2.1.cmml" xref="S3.p1.7.m7.1.2.1"></eq><ci id="S3.p1.7.m7.1.2.2.cmml" xref="S3.p1.7.m7.1.2.2">𝐄</ci><apply id="S3.p1.7.m7.1.2.3.cmml" xref="S3.p1.7.m7.1.2.3"><times id="S3.p1.7.m7.1.2.3.1.cmml" xref="S3.p1.7.m7.1.2.3.1"></times><ci id="S3.p1.7.m7.1.2.3.2.cmml" xref="S3.p1.7.m7.1.2.3.2">softmax</ci><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.2.3.3.2"><divide id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.2.3.3.2"></divide><apply id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.2.1.cmml" xref="S3.p1.7.m7.1.1.2">superscript</csymbol><ci id="S3.p1.7.m7.1.1.2.2.cmml" xref="S3.p1.7.m7.1.1.2.2">𝐐𝐊</ci><ci id="S3.p1.7.m7.1.1.2.3.cmml" xref="S3.p1.7.m7.1.1.2.3">𝖳</ci></apply><apply id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3"><root id="S3.p1.7.m7.1.1.3a.cmml" xref="S3.p1.7.m7.1.1.3"></root><ci id="S3.p1.7.m7.1.1.3.2.cmml" xref="S3.p1.7.m7.1.1.3.2">𝑑</ci></apply></apply><ci id="S3.p1.7.m7.1.2.3.4.cmml" xref="S3.p1.7.m7.1.2.3.4">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">{\bm{{\rm E}}}={\rm softmax}(\frac{{\bm{{\rm Q}}}{\bm{{\rm K}}}^{\mathsf{T}}}{%
\sqrt{d}}){\bm{{\rm V}}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">bold_E = roman_softmax ( divide start_ARG bold_QK start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) bold_V</annotation></semantics></math>, where <math alttext="{\bm{{\rm Q}}}={\bm{{\rm E}}}_{Q}{\bm{{\rm W}}}_{Q}" class="ltx_Math" display="inline" id="S3.p1.8.m8.1"><semantics id="S3.p1.8.m8.1a"><mrow id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">𝐐</mi><mo id="S3.p1.8.m8.1.1.1" xref="S3.p1.8.m8.1.1.1.cmml">=</mo><mrow id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml"><msub id="S3.p1.8.m8.1.1.3.2" xref="S3.p1.8.m8.1.1.3.2.cmml"><mi id="S3.p1.8.m8.1.1.3.2.2" xref="S3.p1.8.m8.1.1.3.2.2.cmml">𝐄</mi><mi id="S3.p1.8.m8.1.1.3.2.3" xref="S3.p1.8.m8.1.1.3.2.3.cmml">Q</mi></msub><mo id="S3.p1.8.m8.1.1.3.1" xref="S3.p1.8.m8.1.1.3.1.cmml">⁢</mo><msub id="S3.p1.8.m8.1.1.3.3" xref="S3.p1.8.m8.1.1.3.3.cmml"><mi id="S3.p1.8.m8.1.1.3.3.2" xref="S3.p1.8.m8.1.1.3.3.2.cmml">𝐖</mi><mi id="S3.p1.8.m8.1.1.3.3.3" xref="S3.p1.8.m8.1.1.3.3.3.cmml">Q</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><eq id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1"></eq><ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">𝐐</ci><apply id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3"><times id="S3.p1.8.m8.1.1.3.1.cmml" xref="S3.p1.8.m8.1.1.3.1"></times><apply id="S3.p1.8.m8.1.1.3.2.cmml" xref="S3.p1.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.3.2.1.cmml" xref="S3.p1.8.m8.1.1.3.2">subscript</csymbol><ci id="S3.p1.8.m8.1.1.3.2.2.cmml" xref="S3.p1.8.m8.1.1.3.2.2">𝐄</ci><ci id="S3.p1.8.m8.1.1.3.2.3.cmml" xref="S3.p1.8.m8.1.1.3.2.3">𝑄</ci></apply><apply id="S3.p1.8.m8.1.1.3.3.cmml" xref="S3.p1.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.3.3.1.cmml" xref="S3.p1.8.m8.1.1.3.3">subscript</csymbol><ci id="S3.p1.8.m8.1.1.3.3.2.cmml" xref="S3.p1.8.m8.1.1.3.3.2">𝐖</ci><ci id="S3.p1.8.m8.1.1.3.3.3.cmml" xref="S3.p1.8.m8.1.1.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">{\bm{{\rm Q}}}={\bm{{\rm E}}}_{Q}{\bm{{\rm W}}}_{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.1d">bold_Q = bold_E start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{{\rm K}}}={\bm{{\rm E}}}_{K}{\bm{{\rm W}}}_{K}" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mrow id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml"><mi id="S3.p1.9.m9.1.1.2" xref="S3.p1.9.m9.1.1.2.cmml">𝐊</mi><mo id="S3.p1.9.m9.1.1.1" xref="S3.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S3.p1.9.m9.1.1.3" xref="S3.p1.9.m9.1.1.3.cmml"><msub id="S3.p1.9.m9.1.1.3.2" xref="S3.p1.9.m9.1.1.3.2.cmml"><mi id="S3.p1.9.m9.1.1.3.2.2" xref="S3.p1.9.m9.1.1.3.2.2.cmml">𝐄</mi><mi id="S3.p1.9.m9.1.1.3.2.3" xref="S3.p1.9.m9.1.1.3.2.3.cmml">K</mi></msub><mo id="S3.p1.9.m9.1.1.3.1" xref="S3.p1.9.m9.1.1.3.1.cmml">⁢</mo><msub id="S3.p1.9.m9.1.1.3.3" xref="S3.p1.9.m9.1.1.3.3.cmml"><mi id="S3.p1.9.m9.1.1.3.3.2" xref="S3.p1.9.m9.1.1.3.3.2.cmml">𝐖</mi><mi id="S3.p1.9.m9.1.1.3.3.3" xref="S3.p1.9.m9.1.1.3.3.3.cmml">K</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1"><eq id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1"></eq><ci id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1.2">𝐊</ci><apply id="S3.p1.9.m9.1.1.3.cmml" xref="S3.p1.9.m9.1.1.3"><times id="S3.p1.9.m9.1.1.3.1.cmml" xref="S3.p1.9.m9.1.1.3.1"></times><apply id="S3.p1.9.m9.1.1.3.2.cmml" xref="S3.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.3.2.1.cmml" xref="S3.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S3.p1.9.m9.1.1.3.2.2.cmml" xref="S3.p1.9.m9.1.1.3.2.2">𝐄</ci><ci id="S3.p1.9.m9.1.1.3.2.3.cmml" xref="S3.p1.9.m9.1.1.3.2.3">𝐾</ci></apply><apply id="S3.p1.9.m9.1.1.3.3.cmml" xref="S3.p1.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.3.3.1.cmml" xref="S3.p1.9.m9.1.1.3.3">subscript</csymbol><ci id="S3.p1.9.m9.1.1.3.3.2.cmml" xref="S3.p1.9.m9.1.1.3.3.2">𝐖</ci><ci id="S3.p1.9.m9.1.1.3.3.3.cmml" xref="S3.p1.9.m9.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">{\bm{{\rm K}}}={\bm{{\rm E}}}_{K}{\bm{{\rm W}}}_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">bold_K = bold_E start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="{\bm{{\rm V}}}={\bm{{\rm E}}}_{V}{\bm{{\rm W}}}_{V}" class="ltx_Math" display="inline" id="S3.p1.10.m10.1"><semantics id="S3.p1.10.m10.1a"><mrow id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml"><mi id="S3.p1.10.m10.1.1.2" xref="S3.p1.10.m10.1.1.2.cmml">𝐕</mi><mo id="S3.p1.10.m10.1.1.1" xref="S3.p1.10.m10.1.1.1.cmml">=</mo><mrow id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml"><msub id="S3.p1.10.m10.1.1.3.2" xref="S3.p1.10.m10.1.1.3.2.cmml"><mi id="S3.p1.10.m10.1.1.3.2.2" xref="S3.p1.10.m10.1.1.3.2.2.cmml">𝐄</mi><mi id="S3.p1.10.m10.1.1.3.2.3" xref="S3.p1.10.m10.1.1.3.2.3.cmml">V</mi></msub><mo id="S3.p1.10.m10.1.1.3.1" xref="S3.p1.10.m10.1.1.3.1.cmml">⁢</mo><msub id="S3.p1.10.m10.1.1.3.3" xref="S3.p1.10.m10.1.1.3.3.cmml"><mi id="S3.p1.10.m10.1.1.3.3.2" xref="S3.p1.10.m10.1.1.3.3.2.cmml">𝐖</mi><mi id="S3.p1.10.m10.1.1.3.3.3" xref="S3.p1.10.m10.1.1.3.3.3.cmml">V</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1"><eq id="S3.p1.10.m10.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1"></eq><ci id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1.2">𝐕</ci><apply id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3"><times id="S3.p1.10.m10.1.1.3.1.cmml" xref="S3.p1.10.m10.1.1.3.1"></times><apply id="S3.p1.10.m10.1.1.3.2.cmml" xref="S3.p1.10.m10.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.3.2.1.cmml" xref="S3.p1.10.m10.1.1.3.2">subscript</csymbol><ci id="S3.p1.10.m10.1.1.3.2.2.cmml" xref="S3.p1.10.m10.1.1.3.2.2">𝐄</ci><ci id="S3.p1.10.m10.1.1.3.2.3.cmml" xref="S3.p1.10.m10.1.1.3.2.3">𝑉</ci></apply><apply id="S3.p1.10.m10.1.1.3.3.cmml" xref="S3.p1.10.m10.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.3.3.1.cmml" xref="S3.p1.10.m10.1.1.3.3">subscript</csymbol><ci id="S3.p1.10.m10.1.1.3.3.2.cmml" xref="S3.p1.10.m10.1.1.3.3.2">𝐖</ci><ci id="S3.p1.10.m10.1.1.3.3.3.cmml" xref="S3.p1.10.m10.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">{\bm{{\rm V}}}={\bm{{\rm E}}}_{V}{\bm{{\rm W}}}_{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.10.m10.1d">bold_V = bold_E start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>. To reduce the time complexity, <cite class="ltx_cite ltx_citemacro_citet">Katharopoulos et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib13" title="">2020</a>)</cite> proposed Linear Transformer by kernel method and associative property of matrix multiplication:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\bm{{\rm E}}}=\left(\phi({\bm{{\rm Q}}})\phi({\bm{{\rm K}}})^{%
\mathsf{T}}\right){\bm{{\rm V}}}=\phi({\bm{{\rm Q}}})\left(\phi({\bm{{\rm K}}}%
)^{\mathsf{T}}{\bm{{\rm V}}}\right)," class="ltx_Math" display="inline" id="S3.E1.m1.5"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.4" xref="S3.E1.m1.5.5.1.1.4.cmml">𝐄</mi><mo id="S3.E1.m1.5.5.1.1.5" xref="S3.E1.m1.5.5.1.1.5.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.5.5.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝐐</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1a" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.4" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4.cmml">ϕ</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1b" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S3.E1.m1.5.5.1.1.1.1.1.1.5" xref="S3.E1.m1.5.5.1.1.1.1.1.1.5.cmml"><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.5.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.5.cmml"><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.5.2.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.5.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝐊</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.5.2.2.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.5.cmml">)</mo></mrow><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.5.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.5.3.cmml">𝖳</mi></msup></mrow><mo id="S3.E1.m1.5.5.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.5.5.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.5.5.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.3.cmml">𝐕</mi></mrow><mo id="S3.E1.m1.5.5.1.1.6" xref="S3.E1.m1.5.5.1.1.6.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mi id="S3.E1.m1.5.5.1.1.2.3" xref="S3.E1.m1.5.5.1.1.2.3.cmml">ϕ</mi><mo id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.2.4.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mo id="S3.E1.m1.5.5.1.1.2.4.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.2.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">𝐐</mi><mo id="S3.E1.m1.5.5.1.1.2.4.2.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.2.cmml">)</mo></mrow><mo id="S3.E1.m1.5.5.1.1.2.2a" xref="S3.E1.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.1.1.2.1.1" xref="S3.E1.m1.5.5.1.1.2.1.1.1.cmml"><mo id="S3.E1.m1.5.5.1.1.2.1.1.2" xref="S3.E1.m1.5.5.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.2.1.1.1" xref="S3.E1.m1.5.5.1.1.2.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.2.1.1.1.2" xref="S3.E1.m1.5.5.1.1.2.1.1.1.2.cmml">ϕ</mi><mo id="S3.E1.m1.5.5.1.1.2.1.1.1.1" xref="S3.E1.m1.5.5.1.1.2.1.1.1.1.cmml">⁢</mo><msup id="S3.E1.m1.5.5.1.1.2.1.1.1.3" xref="S3.E1.m1.5.5.1.1.2.1.1.1.3.cmml"><mrow id="S3.E1.m1.5.5.1.1.2.1.1.1.3.2.2" xref="S3.E1.m1.5.5.1.1.2.1.1.1.3.cmml"><mo id="S3.E1.m1.5.5.1.1.2.1.1.1.3.2.2.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.2.1.1.1.3.cmml">(</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">𝐊</mi><mo id="S3.E1.m1.5.5.1.1.2.1.1.1.3.2.2.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.2.1.1.1.3.cmml">)</mo></mrow><mi id="S3.E1.m1.5.5.1.1.2.1.1.1.3.3" xref="S3.E1.m1.5.5.1.1.2.1.1.1.3.3.cmml">𝖳</mi></msup><mo id="S3.E1.m1.5.5.1.1.2.1.1.1.1a" xref="S3.E1.m1.5.5.1.1.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.5.5.1.1.2.1.1.1.4" xref="S3.E1.m1.5.5.1.1.2.1.1.1.4.cmml">𝐕</mi></mrow><mo id="S3.E1.m1.5.5.1.1.2.1.1.3" xref="S3.E1.m1.5.5.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1"><and id="S3.E1.m1.5.5.1.1a.cmml" xref="S3.E1.m1.5.5.1"></and><apply id="S3.E1.m1.5.5.1.1b.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.5.cmml" xref="S3.E1.m1.5.5.1.1.5"></eq><ci id="S3.E1.m1.5.5.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.4">𝐄</ci><apply id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"><times id="S3.E1.m1.5.5.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.2"></times><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1"><times id="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1"></times><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐐</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.4">italic-ϕ</ci><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.5.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.5.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.5">superscript</csymbol><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐊</ci><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.5.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.5.3">𝖳</ci></apply></apply><ci id="S3.E1.m1.5.5.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.3">𝐕</ci></apply></apply><apply id="S3.E1.m1.5.5.1.1c.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.6.cmml" xref="S3.E1.m1.5.5.1.1.6"></eq><share href="https://arxiv.org/html/2406.09742v1#S3.E1.m1.5.5.1.1.1.cmml" id="S3.E1.m1.5.5.1.1d.cmml" xref="S3.E1.m1.5.5.1"></share><apply id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"><times id="S3.E1.m1.5.5.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2"></times><ci id="S3.E1.m1.5.5.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.3">italic-ϕ</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝐐</ci><apply id="S3.E1.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.2.1.1"><times id="S3.E1.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.2.1.1.1.1"></times><ci id="S3.E1.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2.1.1.1.2">italic-ϕ</ci><apply id="S3.E1.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.2.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝐊</ci><ci id="S3.E1.m1.5.5.1.1.2.1.1.1.3.3.cmml" xref="S3.E1.m1.5.5.1.1.2.1.1.1.3.3">𝖳</ci></apply><ci id="S3.E1.m1.5.5.1.1.2.1.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.2.1.1.1.4">𝐕</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\displaystyle{\bm{{\rm E}}}=\left(\phi({\bm{{\rm Q}}})\phi({\bm{{\rm K}}})^{%
\mathsf{T}}\right){\bm{{\rm V}}}=\phi({\bm{{\rm Q}}})\left(\phi({\bm{{\rm K}}}%
)^{\mathsf{T}}{\bm{{\rm V}}}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.5d">bold_E = ( italic_ϕ ( bold_Q ) italic_ϕ ( bold_K ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ) bold_V = italic_ϕ ( bold_Q ) ( italic_ϕ ( bold_K ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT bold_V ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.11">where <math alttext="\phi(\cdot\;)" class="ltx_Math" display="inline" id="S3.p1.11.m1.1"><semantics id="S3.p1.11.m1.1a"><mrow id="S3.p1.11.m1.1.2" xref="S3.p1.11.m1.1.2.cmml"><mi id="S3.p1.11.m1.1.2.2" xref="S3.p1.11.m1.1.2.2.cmml">ϕ</mi><mo id="S3.p1.11.m1.1.2.1" xref="S3.p1.11.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p1.11.m1.1.2.3.2" xref="S3.p1.11.m1.1.2.cmml"><mo id="S3.p1.11.m1.1.2.3.2.1" stretchy="false" xref="S3.p1.11.m1.1.2.cmml">(</mo><mo id="S3.p1.11.m1.1.1" lspace="0em" rspace="0.280em" xref="S3.p1.11.m1.1.1.cmml">⋅</mo><mo id="S3.p1.11.m1.1.2.3.2.2" stretchy="false" xref="S3.p1.11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.11.m1.1b"><apply id="S3.p1.11.m1.1.2.cmml" xref="S3.p1.11.m1.1.2"><times id="S3.p1.11.m1.1.2.1.cmml" xref="S3.p1.11.m1.1.2.1"></times><ci id="S3.p1.11.m1.1.2.2.cmml" xref="S3.p1.11.m1.1.2.2">italic-ϕ</ci><ci id="S3.p1.11.m1.1.1.cmml" xref="S3.p1.11.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m1.1c">\phi(\cdot\;)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.11.m1.1d">italic_ϕ ( ⋅ )</annotation></semantics></math> is the row-wise kernel function to approximate softmax.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Interaction Fidelity Attention Model</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we introduce the IFA model for lifelong sequence.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Problem Formulation</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.14">For certain user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_u</annotation></semantics></math>, we have a candidate set <math alttext="\mathcal{C}_{u}=\{i_{1},i_{2},\cdots,i_{m}\}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.4"><semantics id="S4.SS1.p1.2.m2.4a"><mrow id="S4.SS1.p1.2.m2.4.4" xref="S4.SS1.p1.2.m2.4.4.cmml"><msub id="S4.SS1.p1.2.m2.4.4.5" xref="S4.SS1.p1.2.m2.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.4.4.5.2" xref="S4.SS1.p1.2.m2.4.4.5.2.cmml">𝒞</mi><mi id="S4.SS1.p1.2.m2.4.4.5.3" xref="S4.SS1.p1.2.m2.4.4.5.3.cmml">u</mi></msub><mo id="S4.SS1.p1.2.m2.4.4.4" xref="S4.SS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S4.SS1.p1.2.m2.4.4.3.3" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml"><mo id="S4.SS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S4.SS1.p1.2.m2.2.2.1.1.1" xref="S4.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.2.2.1.1.1.2" xref="S4.SS1.p1.2.m2.2.2.1.1.1.2.cmml">i</mi><mn id="S4.SS1.p1.2.m2.2.2.1.1.1.3" xref="S4.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.2.m2.4.4.3.3.5" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.2.m2.3.3.2.2.2" xref="S4.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.p1.2.m2.3.3.2.2.2.2" xref="S4.SS1.p1.2.m2.3.3.2.2.2.2.cmml">i</mi><mn id="S4.SS1.p1.2.m2.3.3.2.2.2.3" xref="S4.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.2.m2.4.4.3.3.6" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S4.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S4.SS1.p1.2.m2.1.1.cmml">⋯</mi><mo id="S4.SS1.p1.2.m2.4.4.3.3.7" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.2.m2.4.4.3.3.3" xref="S4.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S4.SS1.p1.2.m2.4.4.3.3.3.2" xref="S4.SS1.p1.2.m2.4.4.3.3.3.2.cmml">i</mi><mi id="S4.SS1.p1.2.m2.4.4.3.3.3.3" xref="S4.SS1.p1.2.m2.4.4.3.3.3.3.cmml">m</mi></msub><mo id="S4.SS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.4b"><apply id="S4.SS1.p1.2.m2.4.4.cmml" xref="S4.SS1.p1.2.m2.4.4"><eq id="S4.SS1.p1.2.m2.4.4.4.cmml" xref="S4.SS1.p1.2.m2.4.4.4"></eq><apply id="S4.SS1.p1.2.m2.4.4.5.cmml" xref="S4.SS1.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.4.4.5.1.cmml" xref="S4.SS1.p1.2.m2.4.4.5">subscript</csymbol><ci id="S4.SS1.p1.2.m2.4.4.5.2.cmml" xref="S4.SS1.p1.2.m2.4.4.5.2">𝒞</ci><ci id="S4.SS1.p1.2.m2.4.4.5.3.cmml" xref="S4.SS1.p1.2.m2.4.4.5.3">𝑢</ci></apply><set id="S4.SS1.p1.2.m2.4.4.3.4.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3"><apply id="S4.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1.1.2">𝑖</ci><cn id="S4.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.3.3.2.2.2.2">𝑖</ci><cn id="S4.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">⋯</ci><apply id="S4.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3.2">𝑖</ci><ci id="S4.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.4c">\mathcal{C}_{u}=\{i_{1},i_{2},\cdots,i_{m}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.4d">caligraphic_C start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT }</annotation></semantics></math> returned from the retrieve stage, and a long user behaviour sequence <math alttext="\mathcal{S}_{u}=\{j_{1},j_{2},\cdots,j_{n}\}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.4"><semantics id="S4.SS1.p1.3.m3.4a"><mrow id="S4.SS1.p1.3.m3.4.4" xref="S4.SS1.p1.3.m3.4.4.cmml"><msub id="S4.SS1.p1.3.m3.4.4.5" xref="S4.SS1.p1.3.m3.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m3.4.4.5.2" xref="S4.SS1.p1.3.m3.4.4.5.2.cmml">𝒮</mi><mi id="S4.SS1.p1.3.m3.4.4.5.3" xref="S4.SS1.p1.3.m3.4.4.5.3.cmml">u</mi></msub><mo id="S4.SS1.p1.3.m3.4.4.4" xref="S4.SS1.p1.3.m3.4.4.4.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.4.4.3.3" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml"><mo id="S4.SS1.p1.3.m3.4.4.3.3.4" stretchy="false" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">{</mo><msub id="S4.SS1.p1.3.m3.2.2.1.1.1" xref="S4.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.2.2.1.1.1.2" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2.cmml">j</mi><mn id="S4.SS1.p1.3.m3.2.2.1.1.1.3" xref="S4.SS1.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.3.m3.4.4.3.3.5" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.3.m3.3.3.2.2.2" xref="S4.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S4.SS1.p1.3.m3.3.3.2.2.2.2" xref="S4.SS1.p1.3.m3.3.3.2.2.2.2.cmml">j</mi><mn id="S4.SS1.p1.3.m3.3.3.2.2.2.3" xref="S4.SS1.p1.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.3.m3.4.4.3.3.6" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S4.SS1.p1.3.m3.1.1" mathvariant="normal" xref="S4.SS1.p1.3.m3.1.1.cmml">⋯</mi><mo id="S4.SS1.p1.3.m3.4.4.3.3.7" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.3.m3.4.4.3.3.3" xref="S4.SS1.p1.3.m3.4.4.3.3.3.cmml"><mi id="S4.SS1.p1.3.m3.4.4.3.3.3.2" xref="S4.SS1.p1.3.m3.4.4.3.3.3.2.cmml">j</mi><mi id="S4.SS1.p1.3.m3.4.4.3.3.3.3" xref="S4.SS1.p1.3.m3.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S4.SS1.p1.3.m3.4.4.3.3.8" stretchy="false" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.4b"><apply id="S4.SS1.p1.3.m3.4.4.cmml" xref="S4.SS1.p1.3.m3.4.4"><eq id="S4.SS1.p1.3.m3.4.4.4.cmml" xref="S4.SS1.p1.3.m3.4.4.4"></eq><apply id="S4.SS1.p1.3.m3.4.4.5.cmml" xref="S4.SS1.p1.3.m3.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.5.1.cmml" xref="S4.SS1.p1.3.m3.4.4.5">subscript</csymbol><ci id="S4.SS1.p1.3.m3.4.4.5.2.cmml" xref="S4.SS1.p1.3.m3.4.4.5.2">𝒮</ci><ci id="S4.SS1.p1.3.m3.4.4.5.3.cmml" xref="S4.SS1.p1.3.m3.4.4.5.3">𝑢</ci></apply><set id="S4.SS1.p1.3.m3.4.4.3.4.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3"><apply id="S4.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2">𝑗</ci><cn id="S4.SS1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2.2">𝑗</ci><cn id="S4.SS1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">⋯</ci><apply id="S4.SS1.p1.3.m3.4.4.3.3.3.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.3.3.3.1.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.3.m3.4.4.3.3.3.2.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3.2">𝑗</ci><ci id="S4.SS1.p1.3.m3.4.4.3.3.3.3.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.4c">\mathcal{S}_{u}=\{j_{1},j_{2},\cdots,j_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.4d">caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_j start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>. In point-wise model such as DIN, we aim to give a score <math alttext="y_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">y</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑦</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for each target item <math alttext="i\in\mathcal{C}_{u}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">i</mi><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">∈</mo><msub id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.5.m5.1.1.3.2" xref="S4.SS1.p1.5.m5.1.1.3.2.cmml">𝒞</mi><mi id="S4.SS1.p1.5.m5.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><in id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></in><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝑖</ci><apply id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.3.2">𝒞</ci><ci id="S4.SS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">i\in\mathcal{C}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_i ∈ caligraphic_C start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> based on the user-wide feature <math alttext="f_{u}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><msub id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">𝑓</ci><ci id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">f_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> (such as user id, age, gender, etc.), item-wide feature <math alttext="f_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><msub id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝑓</ci><ci id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">f_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> (such as item id, category, author id, etc.), cross feature <math alttext="f_{ui}" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1"><semantics id="S4.SS1.p1.8.m8.1a"><msub id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml"><mi id="S4.SS1.p1.8.m8.1.1.2" xref="S4.SS1.p1.8.m8.1.1.2.cmml">f</mi><mrow id="S4.SS1.p1.8.m8.1.1.3" xref="S4.SS1.p1.8.m8.1.1.3.cmml"><mi id="S4.SS1.p1.8.m8.1.1.3.2" xref="S4.SS1.p1.8.m8.1.1.3.2.cmml">u</mi><mo id="S4.SS1.p1.8.m8.1.1.3.1" xref="S4.SS1.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.8.m8.1.1.3.3" xref="S4.SS1.p1.8.m8.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><apply id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m8.1.1.2.cmml" xref="S4.SS1.p1.8.m8.1.1.2">𝑓</ci><apply id="S4.SS1.p1.8.m8.1.1.3.cmml" xref="S4.SS1.p1.8.m8.1.1.3"><times id="S4.SS1.p1.8.m8.1.1.3.1.cmml" xref="S4.SS1.p1.8.m8.1.1.3.1"></times><ci id="S4.SS1.p1.8.m8.1.1.3.2.cmml" xref="S4.SS1.p1.8.m8.1.1.3.2">𝑢</ci><ci id="S4.SS1.p1.8.m8.1.1.3.3.cmml" xref="S4.SS1.p1.8.m8.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">f_{ui}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">italic_f start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and behaviour sequence <math alttext="\mathcal{S}_{u}" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m9.1"><semantics id="S4.SS1.p1.9.m9.1a"><msub id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.9.m9.1.1.2" xref="S4.SS1.p1.9.m9.1.1.2.cmml">𝒮</mi><mi id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><apply id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2">𝒮</ci><ci id="S4.SS1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">\mathcal{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m9.1d">caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>: <math alttext="y_{i}={\rm DIN}(f_{u},f_{i},f_{ui},\{f_{j}\}_{j\in\mathcal{S}_{u}})" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m10.4"><semantics id="S4.SS1.p1.10.m10.4a"><mrow id="S4.SS1.p1.10.m10.4.4" xref="S4.SS1.p1.10.m10.4.4.cmml"><msub id="S4.SS1.p1.10.m10.4.4.6" xref="S4.SS1.p1.10.m10.4.4.6.cmml"><mi id="S4.SS1.p1.10.m10.4.4.6.2" xref="S4.SS1.p1.10.m10.4.4.6.2.cmml">y</mi><mi id="S4.SS1.p1.10.m10.4.4.6.3" xref="S4.SS1.p1.10.m10.4.4.6.3.cmml">i</mi></msub><mo id="S4.SS1.p1.10.m10.4.4.5" xref="S4.SS1.p1.10.m10.4.4.5.cmml">=</mo><mrow id="S4.SS1.p1.10.m10.4.4.4" xref="S4.SS1.p1.10.m10.4.4.4.cmml"><mi id="S4.SS1.p1.10.m10.4.4.4.6" xref="S4.SS1.p1.10.m10.4.4.4.6.cmml">DIN</mi><mo id="S4.SS1.p1.10.m10.4.4.4.5" xref="S4.SS1.p1.10.m10.4.4.4.5.cmml">⁢</mo><mrow id="S4.SS1.p1.10.m10.4.4.4.4.4" xref="S4.SS1.p1.10.m10.4.4.4.4.5.cmml"><mo id="S4.SS1.p1.10.m10.4.4.4.4.4.5" stretchy="false" xref="S4.SS1.p1.10.m10.4.4.4.4.5.cmml">(</mo><msub id="S4.SS1.p1.10.m10.1.1.1.1.1.1" xref="S4.SS1.p1.10.m10.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.10.m10.1.1.1.1.1.1.2" xref="S4.SS1.p1.10.m10.1.1.1.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.10.m10.1.1.1.1.1.1.3" xref="S4.SS1.p1.10.m10.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS1.p1.10.m10.4.4.4.4.4.6" xref="S4.SS1.p1.10.m10.4.4.4.4.5.cmml">,</mo><msub id="S4.SS1.p1.10.m10.2.2.2.2.2.2" xref="S4.SS1.p1.10.m10.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.10.m10.2.2.2.2.2.2.2" xref="S4.SS1.p1.10.m10.2.2.2.2.2.2.2.cmml">f</mi><mi id="S4.SS1.p1.10.m10.2.2.2.2.2.2.3" xref="S4.SS1.p1.10.m10.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.10.m10.4.4.4.4.4.7" xref="S4.SS1.p1.10.m10.4.4.4.4.5.cmml">,</mo><msub id="S4.SS1.p1.10.m10.3.3.3.3.3.3" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.cmml"><mi id="S4.SS1.p1.10.m10.3.3.3.3.3.3.2" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.2.cmml">f</mi><mrow id="S4.SS1.p1.10.m10.3.3.3.3.3.3.3" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.cmml"><mi id="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.2" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.2.cmml">u</mi><mo id="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.1" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.3" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.3.cmml">i</mi></mrow></msub><mo id="S4.SS1.p1.10.m10.4.4.4.4.4.8" xref="S4.SS1.p1.10.m10.4.4.4.4.5.cmml">,</mo><msub id="S4.SS1.p1.10.m10.4.4.4.4.4.4" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.cmml"><mrow id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.2.cmml"><mo id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.2" stretchy="false" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.2.cmml">{</mo><msub id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.cmml"><mi id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.2" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.3" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.3" stretchy="false" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.cmml"><mi id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.2" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.2.cmml">j</mi><mo id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.1" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.1.cmml">∈</mo><msub id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.2" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.2.cmml">𝒮</mi><mi id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.3" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.3.cmml">u</mi></msub></mrow></msub><mo id="S4.SS1.p1.10.m10.4.4.4.4.4.9" stretchy="false" xref="S4.SS1.p1.10.m10.4.4.4.4.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.4b"><apply id="S4.SS1.p1.10.m10.4.4.cmml" xref="S4.SS1.p1.10.m10.4.4"><eq id="S4.SS1.p1.10.m10.4.4.5.cmml" xref="S4.SS1.p1.10.m10.4.4.5"></eq><apply id="S4.SS1.p1.10.m10.4.4.6.cmml" xref="S4.SS1.p1.10.m10.4.4.6"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.4.4.6.1.cmml" xref="S4.SS1.p1.10.m10.4.4.6">subscript</csymbol><ci id="S4.SS1.p1.10.m10.4.4.6.2.cmml" xref="S4.SS1.p1.10.m10.4.4.6.2">𝑦</ci><ci id="S4.SS1.p1.10.m10.4.4.6.3.cmml" xref="S4.SS1.p1.10.m10.4.4.6.3">𝑖</ci></apply><apply id="S4.SS1.p1.10.m10.4.4.4.cmml" xref="S4.SS1.p1.10.m10.4.4.4"><times id="S4.SS1.p1.10.m10.4.4.4.5.cmml" xref="S4.SS1.p1.10.m10.4.4.4.5"></times><ci id="S4.SS1.p1.10.m10.4.4.4.6.cmml" xref="S4.SS1.p1.10.m10.4.4.4.6">DIN</ci><vector id="S4.SS1.p1.10.m10.4.4.4.4.5.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4"><apply id="S4.SS1.p1.10.m10.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.10.m10.1.1.1.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.10.m10.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.10.m10.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.SS1.p1.10.m10.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.10.m10.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.10.m10.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.10.m10.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.10.m10.2.2.2.2.2.2.2">𝑓</ci><ci id="S4.SS1.p1.10.m10.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.10.m10.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.10.m10.3.3.3.3.3.3.cmml" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.3.3.3.3.3.3.1.cmml" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.10.m10.3.3.3.3.3.3.2.cmml" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.2">𝑓</ci><apply id="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.cmml" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.3"><times id="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.1.cmml" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.1"></times><ci id="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.2.cmml" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.2">𝑢</ci><ci id="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.3.cmml" xref="S4.SS1.p1.10.m10.3.3.3.3.3.3.3.3">𝑖</ci></apply></apply><apply id="S4.SS1.p1.10.m10.4.4.4.4.4.4.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.4.4.4.4.4.4.2.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4">subscript</csymbol><set id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.2.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1"><apply id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.1.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.2.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.3.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.1.1.1.3">𝑗</ci></apply></set><apply id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3"><in id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.1.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.1"></in><ci id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.2.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.2">𝑗</ci><apply id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.1.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3">subscript</csymbol><ci id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.2.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.2">𝒮</ci><ci id="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.3.cmml" xref="S4.SS1.p1.10.m10.4.4.4.4.4.4.3.3.3">𝑢</ci></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.4c">y_{i}={\rm DIN}(f_{u},f_{i},f_{ui},\{f_{j}\}_{j\in\mathcal{S}_{u}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.10.m10.4d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = roman_DIN ( italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT , { italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j ∈ caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>. For long sequence, SIM uses a GSU to cut off <math alttext="\mathcal{S}_{u}" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m11.1"><semantics id="S4.SS1.p1.11.m11.1a"><msub id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.11.m11.1.1.2" xref="S4.SS1.p1.11.m11.1.1.2.cmml">𝒮</mi><mi id="S4.SS1.p1.11.m11.1.1.3" xref="S4.SS1.p1.11.m11.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2">𝒮</ci><ci id="S4.SS1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.p1.11.m11.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">\mathcal{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.11.m11.1d">caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> based on the similarity to <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m12.1"><semantics id="S4.SS1.p1.12.m12.1a"><mi id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b"><ci id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.12.m12.1d">italic_i</annotation></semantics></math>: <math alttext="y_{i}={\rm SIM}(f_{u},f_{i},f_{ui},\{f_{j}\}_{j\in\mathcal{S}_{u}})={\rm DIN}(%
f_{u},f_{i},f_{ui},\{f_{j}\}_{j\in{\rm GSU}(\mathcal{S}_{u},i)})" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m13.10"><semantics id="S4.SS1.p1.13.m13.10a"><mrow id="S4.SS1.p1.13.m13.10.10" xref="S4.SS1.p1.13.m13.10.10.cmml"><msub id="S4.SS1.p1.13.m13.10.10.10" xref="S4.SS1.p1.13.m13.10.10.10.cmml"><mi id="S4.SS1.p1.13.m13.10.10.10.2" xref="S4.SS1.p1.13.m13.10.10.10.2.cmml">y</mi><mi id="S4.SS1.p1.13.m13.10.10.10.3" xref="S4.SS1.p1.13.m13.10.10.10.3.cmml">i</mi></msub><mo id="S4.SS1.p1.13.m13.10.10.11" xref="S4.SS1.p1.13.m13.10.10.11.cmml">=</mo><mrow id="S4.SS1.p1.13.m13.6.6.4" xref="S4.SS1.p1.13.m13.6.6.4.cmml"><mi id="S4.SS1.p1.13.m13.6.6.4.6" xref="S4.SS1.p1.13.m13.6.6.4.6.cmml">SIM</mi><mo id="S4.SS1.p1.13.m13.6.6.4.5" xref="S4.SS1.p1.13.m13.6.6.4.5.cmml">⁢</mo><mrow id="S4.SS1.p1.13.m13.6.6.4.4.4" xref="S4.SS1.p1.13.m13.6.6.4.4.5.cmml"><mo id="S4.SS1.p1.13.m13.6.6.4.4.4.5" stretchy="false" xref="S4.SS1.p1.13.m13.6.6.4.4.5.cmml">(</mo><msub id="S4.SS1.p1.13.m13.3.3.1.1.1.1" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.cmml"><mi id="S4.SS1.p1.13.m13.3.3.1.1.1.1.2" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.13.m13.3.3.1.1.1.1.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS1.p1.13.m13.6.6.4.4.4.6" xref="S4.SS1.p1.13.m13.6.6.4.4.5.cmml">,</mo><msub id="S4.SS1.p1.13.m13.4.4.2.2.2.2" xref="S4.SS1.p1.13.m13.4.4.2.2.2.2.cmml"><mi id="S4.SS1.p1.13.m13.4.4.2.2.2.2.2" xref="S4.SS1.p1.13.m13.4.4.2.2.2.2.2.cmml">f</mi><mi id="S4.SS1.p1.13.m13.4.4.2.2.2.2.3" xref="S4.SS1.p1.13.m13.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.13.m13.6.6.4.4.4.7" xref="S4.SS1.p1.13.m13.6.6.4.4.5.cmml">,</mo><msub id="S4.SS1.p1.13.m13.5.5.3.3.3.3" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.cmml"><mi id="S4.SS1.p1.13.m13.5.5.3.3.3.3.2" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.2.cmml">f</mi><mrow id="S4.SS1.p1.13.m13.5.5.3.3.3.3.3" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.cmml"><mi id="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.2" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.2.cmml">u</mi><mo id="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.1" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.3" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.3.cmml">i</mi></mrow></msub><mo id="S4.SS1.p1.13.m13.6.6.4.4.4.8" xref="S4.SS1.p1.13.m13.6.6.4.4.5.cmml">,</mo><msub id="S4.SS1.p1.13.m13.6.6.4.4.4.4" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.cmml"><mrow id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.2.cmml"><mo id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.2" stretchy="false" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.2.cmml">{</mo><msub id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.cmml"><mi id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.2" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.3" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.3" stretchy="false" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.cmml"><mi id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.2" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.2.cmml">j</mi><mo id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.1" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.1.cmml">∈</mo><msub id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.2" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.2.cmml">𝒮</mi><mi id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.3" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.3.cmml">u</mi></msub></mrow></msub><mo id="S4.SS1.p1.13.m13.6.6.4.4.4.9" stretchy="false" xref="S4.SS1.p1.13.m13.6.6.4.4.5.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.13.m13.10.10.12" xref="S4.SS1.p1.13.m13.10.10.12.cmml">=</mo><mrow id="S4.SS1.p1.13.m13.10.10.8" xref="S4.SS1.p1.13.m13.10.10.8.cmml"><mi id="S4.SS1.p1.13.m13.10.10.8.6" xref="S4.SS1.p1.13.m13.10.10.8.6.cmml">DIN</mi><mo id="S4.SS1.p1.13.m13.10.10.8.5" xref="S4.SS1.p1.13.m13.10.10.8.5.cmml">⁢</mo><mrow id="S4.SS1.p1.13.m13.10.10.8.4.4" xref="S4.SS1.p1.13.m13.10.10.8.4.5.cmml"><mo id="S4.SS1.p1.13.m13.10.10.8.4.4.5" stretchy="false" xref="S4.SS1.p1.13.m13.10.10.8.4.5.cmml">(</mo><msub id="S4.SS1.p1.13.m13.7.7.5.1.1.1" xref="S4.SS1.p1.13.m13.7.7.5.1.1.1.cmml"><mi id="S4.SS1.p1.13.m13.7.7.5.1.1.1.2" xref="S4.SS1.p1.13.m13.7.7.5.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.13.m13.7.7.5.1.1.1.3" xref="S4.SS1.p1.13.m13.7.7.5.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS1.p1.13.m13.10.10.8.4.4.6" xref="S4.SS1.p1.13.m13.10.10.8.4.5.cmml">,</mo><msub id="S4.SS1.p1.13.m13.8.8.6.2.2.2" xref="S4.SS1.p1.13.m13.8.8.6.2.2.2.cmml"><mi id="S4.SS1.p1.13.m13.8.8.6.2.2.2.2" xref="S4.SS1.p1.13.m13.8.8.6.2.2.2.2.cmml">f</mi><mi id="S4.SS1.p1.13.m13.8.8.6.2.2.2.3" xref="S4.SS1.p1.13.m13.8.8.6.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.13.m13.10.10.8.4.4.7" xref="S4.SS1.p1.13.m13.10.10.8.4.5.cmml">,</mo><msub id="S4.SS1.p1.13.m13.9.9.7.3.3.3" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.cmml"><mi id="S4.SS1.p1.13.m13.9.9.7.3.3.3.2" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.2.cmml">f</mi><mrow id="S4.SS1.p1.13.m13.9.9.7.3.3.3.3" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.cmml"><mi id="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.2" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.2.cmml">u</mi><mo id="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.1" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.3" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.3.cmml">i</mi></mrow></msub><mo id="S4.SS1.p1.13.m13.10.10.8.4.4.8" xref="S4.SS1.p1.13.m13.10.10.8.4.5.cmml">,</mo><msub id="S4.SS1.p1.13.m13.10.10.8.4.4.4" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.cmml"><mrow id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.2.cmml"><mo id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.2" stretchy="false" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.2.cmml">{</mo><msub id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.cmml"><mi id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.2" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.3" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.3" stretchy="false" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.13.m13.2.2.2" xref="S4.SS1.p1.13.m13.2.2.2.cmml"><mi id="S4.SS1.p1.13.m13.2.2.2.4" xref="S4.SS1.p1.13.m13.2.2.2.4.cmml">j</mi><mo id="S4.SS1.p1.13.m13.2.2.2.3" xref="S4.SS1.p1.13.m13.2.2.2.3.cmml">∈</mo><mrow id="S4.SS1.p1.13.m13.2.2.2.2" xref="S4.SS1.p1.13.m13.2.2.2.2.cmml"><mi id="S4.SS1.p1.13.m13.2.2.2.2.3" xref="S4.SS1.p1.13.m13.2.2.2.2.3.cmml">GSU</mi><mo id="S4.SS1.p1.13.m13.2.2.2.2.2" xref="S4.SS1.p1.13.m13.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS1.p1.13.m13.2.2.2.2.1.1" xref="S4.SS1.p1.13.m13.2.2.2.2.1.2.cmml"><mo id="S4.SS1.p1.13.m13.2.2.2.2.1.1.2" stretchy="false" xref="S4.SS1.p1.13.m13.2.2.2.2.1.2.cmml">(</mo><msub id="S4.SS1.p1.13.m13.2.2.2.2.1.1.1" xref="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.2" xref="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.2.cmml">𝒮</mi><mi id="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.3" xref="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS1.p1.13.m13.2.2.2.2.1.1.3" xref="S4.SS1.p1.13.m13.2.2.2.2.1.2.cmml">,</mo><mi id="S4.SS1.p1.13.m13.1.1.1.1" xref="S4.SS1.p1.13.m13.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p1.13.m13.2.2.2.2.1.1.4" stretchy="false" xref="S4.SS1.p1.13.m13.2.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S4.SS1.p1.13.m13.10.10.8.4.4.9" stretchy="false" xref="S4.SS1.p1.13.m13.10.10.8.4.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.10b"><apply id="S4.SS1.p1.13.m13.10.10.cmml" xref="S4.SS1.p1.13.m13.10.10"><and id="S4.SS1.p1.13.m13.10.10a.cmml" xref="S4.SS1.p1.13.m13.10.10"></and><apply id="S4.SS1.p1.13.m13.10.10b.cmml" xref="S4.SS1.p1.13.m13.10.10"><eq id="S4.SS1.p1.13.m13.10.10.11.cmml" xref="S4.SS1.p1.13.m13.10.10.11"></eq><apply id="S4.SS1.p1.13.m13.10.10.10.cmml" xref="S4.SS1.p1.13.m13.10.10.10"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.10.10.10.1.cmml" xref="S4.SS1.p1.13.m13.10.10.10">subscript</csymbol><ci id="S4.SS1.p1.13.m13.10.10.10.2.cmml" xref="S4.SS1.p1.13.m13.10.10.10.2">𝑦</ci><ci id="S4.SS1.p1.13.m13.10.10.10.3.cmml" xref="S4.SS1.p1.13.m13.10.10.10.3">𝑖</ci></apply><apply id="S4.SS1.p1.13.m13.6.6.4.cmml" xref="S4.SS1.p1.13.m13.6.6.4"><times id="S4.SS1.p1.13.m13.6.6.4.5.cmml" xref="S4.SS1.p1.13.m13.6.6.4.5"></times><ci id="S4.SS1.p1.13.m13.6.6.4.6.cmml" xref="S4.SS1.p1.13.m13.6.6.4.6">SIM</ci><vector id="S4.SS1.p1.13.m13.6.6.4.4.5.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4"><apply id="S4.SS1.p1.13.m13.3.3.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.3.3.1.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m13.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.13.m13.3.3.1.1.1.1.3.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.3">𝑢</ci></apply><apply id="S4.SS1.p1.13.m13.4.4.2.2.2.2.cmml" xref="S4.SS1.p1.13.m13.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.4.4.2.2.2.2.1.cmml" xref="S4.SS1.p1.13.m13.4.4.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.13.m13.4.4.2.2.2.2.2.cmml" xref="S4.SS1.p1.13.m13.4.4.2.2.2.2.2">𝑓</ci><ci id="S4.SS1.p1.13.m13.4.4.2.2.2.2.3.cmml" xref="S4.SS1.p1.13.m13.4.4.2.2.2.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.13.m13.5.5.3.3.3.3.cmml" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.5.5.3.3.3.3.1.cmml" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.13.m13.5.5.3.3.3.3.2.cmml" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.2">𝑓</ci><apply id="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.cmml" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.3"><times id="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.1.cmml" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.1"></times><ci id="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.2.cmml" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.2">𝑢</ci><ci id="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.3.cmml" xref="S4.SS1.p1.13.m13.5.5.3.3.3.3.3.3">𝑖</ci></apply></apply><apply id="S4.SS1.p1.13.m13.6.6.4.4.4.4.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.6.6.4.4.4.4.2.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4">subscript</csymbol><set id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.2.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1"><apply id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.2.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.3.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.1.1.1.3">𝑗</ci></apply></set><apply id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3"><in id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.1.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.1"></in><ci id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.2.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.2">𝑗</ci><apply id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.1.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3">subscript</csymbol><ci id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.2.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.2">𝒮</ci><ci id="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.3.cmml" xref="S4.SS1.p1.13.m13.6.6.4.4.4.4.3.3.3">𝑢</ci></apply></apply></apply></vector></apply></apply><apply id="S4.SS1.p1.13.m13.10.10c.cmml" xref="S4.SS1.p1.13.m13.10.10"><eq id="S4.SS1.p1.13.m13.10.10.12.cmml" xref="S4.SS1.p1.13.m13.10.10.12"></eq><share href="https://arxiv.org/html/2406.09742v1#S4.SS1.p1.13.m13.6.6.4.cmml" id="S4.SS1.p1.13.m13.10.10d.cmml" xref="S4.SS1.p1.13.m13.10.10"></share><apply id="S4.SS1.p1.13.m13.10.10.8.cmml" xref="S4.SS1.p1.13.m13.10.10.8"><times id="S4.SS1.p1.13.m13.10.10.8.5.cmml" xref="S4.SS1.p1.13.m13.10.10.8.5"></times><ci id="S4.SS1.p1.13.m13.10.10.8.6.cmml" xref="S4.SS1.p1.13.m13.10.10.8.6">DIN</ci><vector id="S4.SS1.p1.13.m13.10.10.8.4.5.cmml" xref="S4.SS1.p1.13.m13.10.10.8.4.4"><apply id="S4.SS1.p1.13.m13.7.7.5.1.1.1.cmml" xref="S4.SS1.p1.13.m13.7.7.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.7.7.5.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.7.7.5.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m13.7.7.5.1.1.1.2.cmml" xref="S4.SS1.p1.13.m13.7.7.5.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.13.m13.7.7.5.1.1.1.3.cmml" xref="S4.SS1.p1.13.m13.7.7.5.1.1.1.3">𝑢</ci></apply><apply id="S4.SS1.p1.13.m13.8.8.6.2.2.2.cmml" xref="S4.SS1.p1.13.m13.8.8.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.8.8.6.2.2.2.1.cmml" xref="S4.SS1.p1.13.m13.8.8.6.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.13.m13.8.8.6.2.2.2.2.cmml" xref="S4.SS1.p1.13.m13.8.8.6.2.2.2.2">𝑓</ci><ci id="S4.SS1.p1.13.m13.8.8.6.2.2.2.3.cmml" xref="S4.SS1.p1.13.m13.8.8.6.2.2.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.13.m13.9.9.7.3.3.3.cmml" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.9.9.7.3.3.3.1.cmml" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.13.m13.9.9.7.3.3.3.2.cmml" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.2">𝑓</ci><apply id="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.cmml" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.3"><times id="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.1.cmml" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.1"></times><ci id="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.2.cmml" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.2">𝑢</ci><ci id="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.3.cmml" xref="S4.SS1.p1.13.m13.9.9.7.3.3.3.3.3">𝑖</ci></apply></apply><apply id="S4.SS1.p1.13.m13.10.10.8.4.4.4.cmml" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.10.10.8.4.4.4.2.cmml" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4">subscript</csymbol><set id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.2.cmml" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1"><apply id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.cmml" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.2.cmml" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.3.cmml" xref="S4.SS1.p1.13.m13.10.10.8.4.4.4.1.1.1.3">𝑗</ci></apply></set><apply id="S4.SS1.p1.13.m13.2.2.2.cmml" xref="S4.SS1.p1.13.m13.2.2.2"><in id="S4.SS1.p1.13.m13.2.2.2.3.cmml" xref="S4.SS1.p1.13.m13.2.2.2.3"></in><ci id="S4.SS1.p1.13.m13.2.2.2.4.cmml" xref="S4.SS1.p1.13.m13.2.2.2.4">𝑗</ci><apply id="S4.SS1.p1.13.m13.2.2.2.2.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2"><times id="S4.SS1.p1.13.m13.2.2.2.2.2.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2.2"></times><ci id="S4.SS1.p1.13.m13.2.2.2.2.3.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2.3">GSU</ci><interval closure="open" id="S4.SS1.p1.13.m13.2.2.2.2.1.2.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2.1.1"><apply id="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.2">𝒮</ci><ci id="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.13.m13.2.2.2.2.1.1.1.3">𝑢</ci></apply><ci id="S4.SS1.p1.13.m13.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1.1.1">𝑖</ci></interval></apply></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.10c">y_{i}={\rm SIM}(f_{u},f_{i},f_{ui},\{f_{j}\}_{j\in\mathcal{S}_{u}})={\rm DIN}(%
f_{u},f_{i},f_{ui},\{f_{j}\}_{j\in{\rm GSU}(\mathcal{S}_{u},i)})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.13.m13.10d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = roman_SIM ( italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT , { italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j ∈ caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) = roman_DIN ( italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT , { italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j ∈ roman_GSU ( caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_i ) end_POSTSUBSCRIPT )</annotation></semantics></math>. In our IFA, we input the whole candidate set into the model: <math alttext="\{y_{i}\}_{i\in\mathcal{C}_{u}}={\rm IFA}(f_{u},\{f_{i},f_{ui}\}_{i\in\mathcal%
{C}_{u}},\{f_{j}\}_{j\in\mathcal{S}_{u}})" class="ltx_Math" display="inline" id="S4.SS1.p1.14.m14.4"><semantics id="S4.SS1.p1.14.m14.4a"><mrow id="S4.SS1.p1.14.m14.4.4" xref="S4.SS1.p1.14.m14.4.4.cmml"><msub id="S4.SS1.p1.14.m14.1.1.1" xref="S4.SS1.p1.14.m14.1.1.1.cmml"><mrow id="S4.SS1.p1.14.m14.1.1.1.1.1" xref="S4.SS1.p1.14.m14.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.14.m14.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.14.m14.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p1.14.m14.1.1.1.1.1.1" xref="S4.SS1.p1.14.m14.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.14.m14.1.1.1.1.1.1.2" xref="S4.SS1.p1.14.m14.1.1.1.1.1.1.2.cmml">y</mi><mi id="S4.SS1.p1.14.m14.1.1.1.1.1.1.3" xref="S4.SS1.p1.14.m14.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p1.14.m14.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.14.m14.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.14.m14.1.1.1.3" xref="S4.SS1.p1.14.m14.1.1.1.3.cmml"><mi id="S4.SS1.p1.14.m14.1.1.1.3.2" xref="S4.SS1.p1.14.m14.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p1.14.m14.1.1.1.3.1" xref="S4.SS1.p1.14.m14.1.1.1.3.1.cmml">∈</mo><msub id="S4.SS1.p1.14.m14.1.1.1.3.3" xref="S4.SS1.p1.14.m14.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.14.m14.1.1.1.3.3.2" xref="S4.SS1.p1.14.m14.1.1.1.3.3.2.cmml">𝒞</mi><mi id="S4.SS1.p1.14.m14.1.1.1.3.3.3" xref="S4.SS1.p1.14.m14.1.1.1.3.3.3.cmml">u</mi></msub></mrow></msub><mo id="S4.SS1.p1.14.m14.4.4.5" xref="S4.SS1.p1.14.m14.4.4.5.cmml">=</mo><mrow id="S4.SS1.p1.14.m14.4.4.4" xref="S4.SS1.p1.14.m14.4.4.4.cmml"><mi id="S4.SS1.p1.14.m14.4.4.4.5" xref="S4.SS1.p1.14.m14.4.4.4.5.cmml">IFA</mi><mo id="S4.SS1.p1.14.m14.4.4.4.4" xref="S4.SS1.p1.14.m14.4.4.4.4.cmml">⁢</mo><mrow id="S4.SS1.p1.14.m14.4.4.4.3.3" xref="S4.SS1.p1.14.m14.4.4.4.3.4.cmml"><mo id="S4.SS1.p1.14.m14.4.4.4.3.3.4" stretchy="false" xref="S4.SS1.p1.14.m14.4.4.4.3.4.cmml">(</mo><msub id="S4.SS1.p1.14.m14.2.2.2.1.1.1" xref="S4.SS1.p1.14.m14.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.14.m14.2.2.2.1.1.1.2" xref="S4.SS1.p1.14.m14.2.2.2.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.14.m14.2.2.2.1.1.1.3" xref="S4.SS1.p1.14.m14.2.2.2.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS1.p1.14.m14.4.4.4.3.3.5" xref="S4.SS1.p1.14.m14.4.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.14.m14.3.3.3.2.2.2" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.cmml"><mrow id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.3.cmml"><mo id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.3" stretchy="false" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.3.cmml">{</mo><msub id="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.2" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.3" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.4" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.2" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.2.cmml">f</mi><mrow id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.2" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.2.cmml">u</mi><mo id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.1" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.3" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.3.cmml">i</mi></mrow></msub><mo id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.5" stretchy="false" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.cmml"><mi id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.2" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.2.cmml">i</mi><mo id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.1" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.1.cmml">∈</mo><msub id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.2" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.2.cmml">𝒞</mi><mi id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.3" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.3.cmml">u</mi></msub></mrow></msub><mo id="S4.SS1.p1.14.m14.4.4.4.3.3.6" xref="S4.SS1.p1.14.m14.4.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.14.m14.4.4.4.3.3.3" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.cmml"><mrow id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.2.cmml"><mo id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.2" stretchy="false" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.2.cmml">{</mo><msub id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.cmml"><mi id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.2" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.2.cmml">f</mi><mi id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.3" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.3" stretchy="false" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.cmml"><mi id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.2" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.2.cmml">j</mi><mo id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.1" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.1.cmml">∈</mo><msub id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.2" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.2.cmml">𝒮</mi><mi id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.3" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.3.cmml">u</mi></msub></mrow></msub><mo id="S4.SS1.p1.14.m14.4.4.4.3.3.7" stretchy="false" xref="S4.SS1.p1.14.m14.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.4b"><apply id="S4.SS1.p1.14.m14.4.4.cmml" xref="S4.SS1.p1.14.m14.4.4"><eq id="S4.SS1.p1.14.m14.4.4.5.cmml" xref="S4.SS1.p1.14.m14.4.4.5"></eq><apply id="S4.SS1.p1.14.m14.1.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.1.1.1.2.cmml" xref="S4.SS1.p1.14.m14.1.1.1">subscript</csymbol><set id="S4.SS1.p1.14.m14.1.1.1.1.2.cmml" xref="S4.SS1.p1.14.m14.1.1.1.1.1"><apply id="S4.SS1.p1.14.m14.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m14.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.14.m14.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS1.p1.14.m14.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.14.m14.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS1.p1.14.m14.1.1.1.3.cmml" xref="S4.SS1.p1.14.m14.1.1.1.3"><in id="S4.SS1.p1.14.m14.1.1.1.3.1.cmml" xref="S4.SS1.p1.14.m14.1.1.1.3.1"></in><ci id="S4.SS1.p1.14.m14.1.1.1.3.2.cmml" xref="S4.SS1.p1.14.m14.1.1.1.3.2">𝑖</ci><apply id="S4.SS1.p1.14.m14.1.1.1.3.3.cmml" xref="S4.SS1.p1.14.m14.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.1.1.1.3.3.1.cmml" xref="S4.SS1.p1.14.m14.1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.14.m14.1.1.1.3.3.2.cmml" xref="S4.SS1.p1.14.m14.1.1.1.3.3.2">𝒞</ci><ci id="S4.SS1.p1.14.m14.1.1.1.3.3.3.cmml" xref="S4.SS1.p1.14.m14.1.1.1.3.3.3">𝑢</ci></apply></apply></apply><apply id="S4.SS1.p1.14.m14.4.4.4.cmml" xref="S4.SS1.p1.14.m14.4.4.4"><times id="S4.SS1.p1.14.m14.4.4.4.4.cmml" xref="S4.SS1.p1.14.m14.4.4.4.4"></times><ci id="S4.SS1.p1.14.m14.4.4.4.5.cmml" xref="S4.SS1.p1.14.m14.4.4.4.5">IFA</ci><vector id="S4.SS1.p1.14.m14.4.4.4.3.4.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3"><apply id="S4.SS1.p1.14.m14.2.2.2.1.1.1.cmml" xref="S4.SS1.p1.14.m14.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.14.m14.2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m14.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.14.m14.2.2.2.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.14.m14.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.14.m14.2.2.2.1.1.1.3">𝑢</ci></apply><apply id="S4.SS1.p1.14.m14.3.3.3.2.2.2.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.3.3.3.2.2.2.3.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2">subscript</csymbol><set id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2"><apply id="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.2">𝑓</ci><apply id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3"><times id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.1"></times><ci id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.2.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.2">𝑢</ci><ci id="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply></set><apply id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4"><in id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.1.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.1"></in><ci id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.2.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.2">𝑖</ci><apply id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.1.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3">subscript</csymbol><ci id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.2.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.2">𝒞</ci><ci id="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.3.cmml" xref="S4.SS1.p1.14.m14.3.3.3.2.2.2.4.3.3">𝑢</ci></apply></apply></apply><apply id="S4.SS1.p1.14.m14.4.4.4.3.3.3.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.4.4.4.3.3.3.2.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3">subscript</csymbol><set id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.2.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1"><apply id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.1.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.2.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.2">𝑓</ci><ci id="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.3.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.1.1.1.3">𝑗</ci></apply></set><apply id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3"><in id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.1.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.1"></in><ci id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.2.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.2">𝑗</ci><apply id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.1.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.2.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.2">𝒮</ci><ci id="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.3.cmml" xref="S4.SS1.p1.14.m14.4.4.4.3.3.3.3.3.3">𝑢</ci></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.4c">\{y_{i}\}_{i\in\mathcal{C}_{u}}={\rm IFA}(f_{u},\{f_{i},f_{ui}\}_{i\in\mathcal%
{C}_{u}},\{f_{j}\}_{j\in\mathcal{S}_{u}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.14.m14.4d">{ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i ∈ caligraphic_C start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT = roman_IFA ( italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , { italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i ∈ caligraphic_C start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT , { italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j ∈ caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>, and simplify cross attention to reduce the complexity.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Model Structure</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.9"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.9.1">Embedding Layer.</span> We encode the categorical features <math alttext="f_{x}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">f</mi><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑓</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">f_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> of attribute <math alttext="x" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_x</annotation></semantics></math> into trainable embedding vectors <math alttext="{\bm{{\rm f}}}_{x}\in\mathbb{R}^{1\times d_{x}}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><msub id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.2.2.cmml">𝐟</mi><mi id="S4.SS2.p1.3.m3.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.2.3.cmml">x</mi></msub><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.3.m3.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.cmml"><mn id="S4.SS2.p1.3.m3.1.1.3.3.2" xref="S4.SS2.p1.3.m3.1.1.3.3.2.cmml">1</mn><mo id="S4.SS2.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.3.m3.1.1.3.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.3.3.3.2" xref="S4.SS2.p1.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S4.SS2.p1.3.m3.1.1.3.3.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.3.3.cmml">x</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><in id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></in><apply id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2">𝐟</ci><ci id="S4.SS2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3">𝑥</ci></apply><apply id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3"><times id="S4.SS2.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.1"></times><cn id="S4.SS2.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1.3.3.2">1</cn><apply id="S4.SS2.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S4.SS2.p1.3.m3.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.3.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">{\bm{{\rm f}}}_{x}\in\mathbb{R}^{1\times d_{x}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">bold_f start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. The item-wide feature embeddings of the whole candidate set are denoted as <math alttext="{\bm{{\rm F}}}_{can}=[{\bm{{\rm f}}}_{i_{1}}^{\mathsf{T}},{\bm{{\rm f}}}_{i_{2%
}}^{\mathsf{T}},\cdots,{\bm{{\rm f}}}_{i_{m}}^{\mathsf{T}}]^{\mathsf{T}}\in%
\mathbb{R}^{m\times d_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.4"><semantics id="S4.SS2.p1.4.m4.4a"><mrow id="S4.SS2.p1.4.m4.4.4" xref="S4.SS2.p1.4.m4.4.4.cmml"><msub id="S4.SS2.p1.4.m4.4.4.5" xref="S4.SS2.p1.4.m4.4.4.5.cmml"><mi id="S4.SS2.p1.4.m4.4.4.5.2" xref="S4.SS2.p1.4.m4.4.4.5.2.cmml">𝐅</mi><mrow id="S4.SS2.p1.4.m4.4.4.5.3" xref="S4.SS2.p1.4.m4.4.4.5.3.cmml"><mi id="S4.SS2.p1.4.m4.4.4.5.3.2" xref="S4.SS2.p1.4.m4.4.4.5.3.2.cmml">c</mi><mo id="S4.SS2.p1.4.m4.4.4.5.3.1" xref="S4.SS2.p1.4.m4.4.4.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.4.4.5.3.3" xref="S4.SS2.p1.4.m4.4.4.5.3.3.cmml">a</mi><mo id="S4.SS2.p1.4.m4.4.4.5.3.1a" xref="S4.SS2.p1.4.m4.4.4.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.4.4.5.3.4" xref="S4.SS2.p1.4.m4.4.4.5.3.4.cmml">n</mi></mrow></msub><mo id="S4.SS2.p1.4.m4.4.4.6" xref="S4.SS2.p1.4.m4.4.4.6.cmml">=</mo><msup id="S4.SS2.p1.4.m4.4.4.3" xref="S4.SS2.p1.4.m4.4.4.3.cmml"><mrow id="S4.SS2.p1.4.m4.4.4.3.3.3" xref="S4.SS2.p1.4.m4.4.4.3.3.4.cmml"><mo id="S4.SS2.p1.4.m4.4.4.3.3.3.4" stretchy="false" xref="S4.SS2.p1.4.m4.4.4.3.3.4.cmml">[</mo><msubsup id="S4.SS2.p1.4.m4.2.2.1.1.1.1" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.2" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.2.cmml">𝐟</mi><msub id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.cmml"><mi id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.2" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.2.cmml">i</mi><mn id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.3" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.3.cmml">1</mn></msub><mi id="S4.SS2.p1.4.m4.2.2.1.1.1.1.3" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.4.m4.4.4.3.3.3.5" xref="S4.SS2.p1.4.m4.4.4.3.3.4.cmml">,</mo><msubsup id="S4.SS2.p1.4.m4.3.3.2.2.2.2" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.cmml"><mi id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.2" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.2.cmml">𝐟</mi><msub id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.cmml"><mi id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.2" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.2.cmml">i</mi><mn id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.3" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.3.cmml">2</mn></msub><mi id="S4.SS2.p1.4.m4.3.3.2.2.2.2.3" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.4.m4.4.4.3.3.3.6" xref="S4.SS2.p1.4.m4.4.4.3.3.4.cmml">,</mo><mi id="S4.SS2.p1.4.m4.1.1" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.cmml">⋯</mi><mo id="S4.SS2.p1.4.m4.4.4.3.3.3.7" xref="S4.SS2.p1.4.m4.4.4.3.3.4.cmml">,</mo><msubsup id="S4.SS2.p1.4.m4.4.4.3.3.3.3" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.cmml"><mi id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.2" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.2.cmml">𝐟</mi><msub id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.cmml"><mi id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.2" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.2.cmml">i</mi><mi id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.3" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.3.cmml">m</mi></msub><mi id="S4.SS2.p1.4.m4.4.4.3.3.3.3.3" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.4.m4.4.4.3.3.3.8" stretchy="false" xref="S4.SS2.p1.4.m4.4.4.3.3.4.cmml">]</mo></mrow><mi id="S4.SS2.p1.4.m4.4.4.3.5" xref="S4.SS2.p1.4.m4.4.4.3.5.cmml">𝖳</mi></msup><mo id="S4.SS2.p1.4.m4.4.4.7" xref="S4.SS2.p1.4.m4.4.4.7.cmml">∈</mo><msup id="S4.SS2.p1.4.m4.4.4.8" xref="S4.SS2.p1.4.m4.4.4.8.cmml"><mi id="S4.SS2.p1.4.m4.4.4.8.2" xref="S4.SS2.p1.4.m4.4.4.8.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.4.m4.4.4.8.3" xref="S4.SS2.p1.4.m4.4.4.8.3.cmml"><mi id="S4.SS2.p1.4.m4.4.4.8.3.2" xref="S4.SS2.p1.4.m4.4.4.8.3.2.cmml">m</mi><mo id="S4.SS2.p1.4.m4.4.4.8.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.4.m4.4.4.8.3.1.cmml">×</mo><msub id="S4.SS2.p1.4.m4.4.4.8.3.3" xref="S4.SS2.p1.4.m4.4.4.8.3.3.cmml"><mi id="S4.SS2.p1.4.m4.4.4.8.3.3.2" xref="S4.SS2.p1.4.m4.4.4.8.3.3.2.cmml">d</mi><mi id="S4.SS2.p1.4.m4.4.4.8.3.3.3" xref="S4.SS2.p1.4.m4.4.4.8.3.3.3.cmml">i</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.4b"><apply id="S4.SS2.p1.4.m4.4.4.cmml" xref="S4.SS2.p1.4.m4.4.4"><and id="S4.SS2.p1.4.m4.4.4a.cmml" xref="S4.SS2.p1.4.m4.4.4"></and><apply id="S4.SS2.p1.4.m4.4.4b.cmml" xref="S4.SS2.p1.4.m4.4.4"><eq id="S4.SS2.p1.4.m4.4.4.6.cmml" xref="S4.SS2.p1.4.m4.4.4.6"></eq><apply id="S4.SS2.p1.4.m4.4.4.5.cmml" xref="S4.SS2.p1.4.m4.4.4.5"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.5.1.cmml" xref="S4.SS2.p1.4.m4.4.4.5">subscript</csymbol><ci id="S4.SS2.p1.4.m4.4.4.5.2.cmml" xref="S4.SS2.p1.4.m4.4.4.5.2">𝐅</ci><apply id="S4.SS2.p1.4.m4.4.4.5.3.cmml" xref="S4.SS2.p1.4.m4.4.4.5.3"><times id="S4.SS2.p1.4.m4.4.4.5.3.1.cmml" xref="S4.SS2.p1.4.m4.4.4.5.3.1"></times><ci id="S4.SS2.p1.4.m4.4.4.5.3.2.cmml" xref="S4.SS2.p1.4.m4.4.4.5.3.2">𝑐</ci><ci id="S4.SS2.p1.4.m4.4.4.5.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.5.3.3">𝑎</ci><ci id="S4.SS2.p1.4.m4.4.4.5.3.4.cmml" xref="S4.SS2.p1.4.m4.4.4.5.3.4">𝑛</ci></apply></apply><apply id="S4.SS2.p1.4.m4.4.4.3.cmml" xref="S4.SS2.p1.4.m4.4.4.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.3.4.cmml" xref="S4.SS2.p1.4.m4.4.4.3">superscript</csymbol><list id="S4.SS2.p1.4.m4.4.4.3.3.4.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3"><apply id="S4.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.2">𝐟</ci><apply id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.2">𝑖</ci><cn id="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p1.4.m4.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.1.3">𝖳</ci></apply><apply id="S4.SS2.p1.4.m4.3.3.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.3.3.2.2.2.2.1.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.2">𝐟</ci><apply id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.2.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.2">𝑖</ci><cn id="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.3.cmml" type="integer" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.2.3.3">2</cn></apply></apply><ci id="S4.SS2.p1.4.m4.3.3.2.2.2.2.3.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.3">𝖳</ci></apply><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">⋯</ci><apply id="S4.SS2.p1.4.m4.4.4.3.3.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.3.3.3.3.1.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3">superscript</csymbol><apply id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.1.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.2.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.2">𝐟</ci><apply id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.1.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.2.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.2">𝑖</ci><ci id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.3.3">𝑚</ci></apply></apply><ci id="S4.SS2.p1.4.m4.4.4.3.3.3.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.3">𝖳</ci></apply></list><ci id="S4.SS2.p1.4.m4.4.4.3.5.cmml" xref="S4.SS2.p1.4.m4.4.4.3.5">𝖳</ci></apply></apply><apply id="S4.SS2.p1.4.m4.4.4c.cmml" xref="S4.SS2.p1.4.m4.4.4"><in id="S4.SS2.p1.4.m4.4.4.7.cmml" xref="S4.SS2.p1.4.m4.4.4.7"></in><share href="https://arxiv.org/html/2406.09742v1#S4.SS2.p1.4.m4.4.4.3.cmml" id="S4.SS2.p1.4.m4.4.4d.cmml" xref="S4.SS2.p1.4.m4.4.4"></share><apply id="S4.SS2.p1.4.m4.4.4.8.cmml" xref="S4.SS2.p1.4.m4.4.4.8"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.8.1.cmml" xref="S4.SS2.p1.4.m4.4.4.8">superscript</csymbol><ci id="S4.SS2.p1.4.m4.4.4.8.2.cmml" xref="S4.SS2.p1.4.m4.4.4.8.2">ℝ</ci><apply id="S4.SS2.p1.4.m4.4.4.8.3.cmml" xref="S4.SS2.p1.4.m4.4.4.8.3"><times id="S4.SS2.p1.4.m4.4.4.8.3.1.cmml" xref="S4.SS2.p1.4.m4.4.4.8.3.1"></times><ci id="S4.SS2.p1.4.m4.4.4.8.3.2.cmml" xref="S4.SS2.p1.4.m4.4.4.8.3.2">𝑚</ci><apply id="S4.SS2.p1.4.m4.4.4.8.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.8.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.8.3.3.1.cmml" xref="S4.SS2.p1.4.m4.4.4.8.3.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.4.4.8.3.3.2.cmml" xref="S4.SS2.p1.4.m4.4.4.8.3.3.2">𝑑</ci><ci id="S4.SS2.p1.4.m4.4.4.8.3.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.8.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.4c">{\bm{{\rm F}}}_{can}=[{\bm{{\rm f}}}_{i_{1}}^{\mathsf{T}},{\bm{{\rm f}}}_{i_{2%
}}^{\mathsf{T}},\cdots,{\bm{{\rm f}}}_{i_{m}}^{\mathsf{T}}]^{\mathsf{T}}\in%
\mathbb{R}^{m\times d_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.4d">bold_F start_POSTSUBSCRIPT italic_c italic_a italic_n end_POSTSUBSCRIPT = [ bold_f start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT , bold_f start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT , ⋯ , bold_f start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. The cross feature embeddings are denoted as <math alttext="{\bm{{\rm F}}}_{cro}=[{\bm{{\rm f}}}_{ui_{1}}^{\mathsf{T}},{\bm{{\rm f}}}_{ui_%
{2}}^{\mathsf{T}},\cdots,{\bm{{\rm f}}}_{ui_{m}}^{\mathsf{T}}]^{\mathsf{T}}\in%
\mathbb{R}^{m\times d_{ui}}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.4"><semantics id="S4.SS2.p1.5.m5.4a"><mrow id="S4.SS2.p1.5.m5.4.4" xref="S4.SS2.p1.5.m5.4.4.cmml"><msub id="S4.SS2.p1.5.m5.4.4.5" xref="S4.SS2.p1.5.m5.4.4.5.cmml"><mi id="S4.SS2.p1.5.m5.4.4.5.2" xref="S4.SS2.p1.5.m5.4.4.5.2.cmml">𝐅</mi><mrow id="S4.SS2.p1.5.m5.4.4.5.3" xref="S4.SS2.p1.5.m5.4.4.5.3.cmml"><mi id="S4.SS2.p1.5.m5.4.4.5.3.2" xref="S4.SS2.p1.5.m5.4.4.5.3.2.cmml">c</mi><mo id="S4.SS2.p1.5.m5.4.4.5.3.1" xref="S4.SS2.p1.5.m5.4.4.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.4.4.5.3.3" xref="S4.SS2.p1.5.m5.4.4.5.3.3.cmml">r</mi><mo id="S4.SS2.p1.5.m5.4.4.5.3.1a" xref="S4.SS2.p1.5.m5.4.4.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.4.4.5.3.4" xref="S4.SS2.p1.5.m5.4.4.5.3.4.cmml">o</mi></mrow></msub><mo id="S4.SS2.p1.5.m5.4.4.6" xref="S4.SS2.p1.5.m5.4.4.6.cmml">=</mo><msup id="S4.SS2.p1.5.m5.4.4.3" xref="S4.SS2.p1.5.m5.4.4.3.cmml"><mrow id="S4.SS2.p1.5.m5.4.4.3.3.3" xref="S4.SS2.p1.5.m5.4.4.3.3.4.cmml"><mo id="S4.SS2.p1.5.m5.4.4.3.3.3.4" stretchy="false" xref="S4.SS2.p1.5.m5.4.4.3.3.4.cmml">[</mo><msubsup id="S4.SS2.p1.5.m5.2.2.1.1.1.1" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.2" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.2.cmml">𝐟</mi><mrow id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.cmml"><mi id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.2" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.2.cmml">u</mi><mo id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.1" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.cmml"><mi id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.2" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.2.cmml">i</mi><mn id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.3" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.3.cmml">1</mn></msub></mrow><mi id="S4.SS2.p1.5.m5.2.2.1.1.1.1.3" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.5.m5.4.4.3.3.3.5" xref="S4.SS2.p1.5.m5.4.4.3.3.4.cmml">,</mo><msubsup id="S4.SS2.p1.5.m5.3.3.2.2.2.2" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.cmml"><mi id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.2" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.2.cmml">𝐟</mi><mrow id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.cmml"><mi id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.2" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.2.cmml">u</mi><mo id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.1" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.1.cmml">⁢</mo><msub id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.cmml"><mi id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.2" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.2.cmml">i</mi><mn id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.3" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.3.cmml">2</mn></msub></mrow><mi id="S4.SS2.p1.5.m5.3.3.2.2.2.2.3" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.5.m5.4.4.3.3.3.6" xref="S4.SS2.p1.5.m5.4.4.3.3.4.cmml">,</mo><mi id="S4.SS2.p1.5.m5.1.1" mathvariant="normal" xref="S4.SS2.p1.5.m5.1.1.cmml">⋯</mi><mo id="S4.SS2.p1.5.m5.4.4.3.3.3.7" xref="S4.SS2.p1.5.m5.4.4.3.3.4.cmml">,</mo><msubsup id="S4.SS2.p1.5.m5.4.4.3.3.3.3" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.cmml"><mi id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.2" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.2.cmml">𝐟</mi><mrow id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.cmml"><mi id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.2" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.2.cmml">u</mi><mo id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.1" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.1.cmml">⁢</mo><msub id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.cmml"><mi id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.2" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.2.cmml">i</mi><mi id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.3" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.3.cmml">m</mi></msub></mrow><mi id="S4.SS2.p1.5.m5.4.4.3.3.3.3.3" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.5.m5.4.4.3.3.3.8" stretchy="false" xref="S4.SS2.p1.5.m5.4.4.3.3.4.cmml">]</mo></mrow><mi id="S4.SS2.p1.5.m5.4.4.3.5" xref="S4.SS2.p1.5.m5.4.4.3.5.cmml">𝖳</mi></msup><mo id="S4.SS2.p1.5.m5.4.4.7" xref="S4.SS2.p1.5.m5.4.4.7.cmml">∈</mo><msup id="S4.SS2.p1.5.m5.4.4.8" xref="S4.SS2.p1.5.m5.4.4.8.cmml"><mi id="S4.SS2.p1.5.m5.4.4.8.2" xref="S4.SS2.p1.5.m5.4.4.8.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.5.m5.4.4.8.3" xref="S4.SS2.p1.5.m5.4.4.8.3.cmml"><mi id="S4.SS2.p1.5.m5.4.4.8.3.2" xref="S4.SS2.p1.5.m5.4.4.8.3.2.cmml">m</mi><mo id="S4.SS2.p1.5.m5.4.4.8.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.5.m5.4.4.8.3.1.cmml">×</mo><msub id="S4.SS2.p1.5.m5.4.4.8.3.3" xref="S4.SS2.p1.5.m5.4.4.8.3.3.cmml"><mi id="S4.SS2.p1.5.m5.4.4.8.3.3.2" xref="S4.SS2.p1.5.m5.4.4.8.3.3.2.cmml">d</mi><mrow id="S4.SS2.p1.5.m5.4.4.8.3.3.3" xref="S4.SS2.p1.5.m5.4.4.8.3.3.3.cmml"><mi id="S4.SS2.p1.5.m5.4.4.8.3.3.3.2" xref="S4.SS2.p1.5.m5.4.4.8.3.3.3.2.cmml">u</mi><mo id="S4.SS2.p1.5.m5.4.4.8.3.3.3.1" xref="S4.SS2.p1.5.m5.4.4.8.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.4.4.8.3.3.3.3" xref="S4.SS2.p1.5.m5.4.4.8.3.3.3.3.cmml">i</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.4b"><apply id="S4.SS2.p1.5.m5.4.4.cmml" xref="S4.SS2.p1.5.m5.4.4"><and id="S4.SS2.p1.5.m5.4.4a.cmml" xref="S4.SS2.p1.5.m5.4.4"></and><apply id="S4.SS2.p1.5.m5.4.4b.cmml" xref="S4.SS2.p1.5.m5.4.4"><eq id="S4.SS2.p1.5.m5.4.4.6.cmml" xref="S4.SS2.p1.5.m5.4.4.6"></eq><apply id="S4.SS2.p1.5.m5.4.4.5.cmml" xref="S4.SS2.p1.5.m5.4.4.5"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.4.4.5.1.cmml" xref="S4.SS2.p1.5.m5.4.4.5">subscript</csymbol><ci id="S4.SS2.p1.5.m5.4.4.5.2.cmml" xref="S4.SS2.p1.5.m5.4.4.5.2">𝐅</ci><apply id="S4.SS2.p1.5.m5.4.4.5.3.cmml" xref="S4.SS2.p1.5.m5.4.4.5.3"><times id="S4.SS2.p1.5.m5.4.4.5.3.1.cmml" xref="S4.SS2.p1.5.m5.4.4.5.3.1"></times><ci id="S4.SS2.p1.5.m5.4.4.5.3.2.cmml" xref="S4.SS2.p1.5.m5.4.4.5.3.2">𝑐</ci><ci id="S4.SS2.p1.5.m5.4.4.5.3.3.cmml" xref="S4.SS2.p1.5.m5.4.4.5.3.3">𝑟</ci><ci id="S4.SS2.p1.5.m5.4.4.5.3.4.cmml" xref="S4.SS2.p1.5.m5.4.4.5.3.4">𝑜</ci></apply></apply><apply id="S4.SS2.p1.5.m5.4.4.3.cmml" xref="S4.SS2.p1.5.m5.4.4.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.4.4.3.4.cmml" xref="S4.SS2.p1.5.m5.4.4.3">superscript</csymbol><list id="S4.SS2.p1.5.m5.4.4.3.3.4.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3"><apply id="S4.SS2.p1.5.m5.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.2">𝐟</ci><apply id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3"><times id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.1"></times><ci id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.2">𝑢</ci><apply id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.1.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.2.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.2">𝑖</ci><cn id="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><ci id="S4.SS2.p1.5.m5.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.1.1.3">𝖳</ci></apply><apply id="S4.SS2.p1.5.m5.3.3.2.2.2.2.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.3.3.2.2.2.2.1.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.2">𝐟</ci><apply id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3"><times id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.1"></times><ci id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.2.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.2">𝑢</ci><apply id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.1.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.2.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.2">𝑖</ci><cn id="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.2.3.3.3">2</cn></apply></apply></apply><ci id="S4.SS2.p1.5.m5.3.3.2.2.2.2.3.cmml" xref="S4.SS2.p1.5.m5.3.3.2.2.2.2.3">𝖳</ci></apply><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">⋯</ci><apply id="S4.SS2.p1.5.m5.4.4.3.3.3.3.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.4.4.3.3.3.3.1.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3">superscript</csymbol><apply id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.1.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.2.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.2">𝐟</ci><apply id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3"><times id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.1.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.1"></times><ci id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.2.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.2">𝑢</ci><apply id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.1.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.2.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.2">𝑖</ci><ci id="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.3.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.2.3.3.3">𝑚</ci></apply></apply></apply><ci id="S4.SS2.p1.5.m5.4.4.3.3.3.3.3.cmml" xref="S4.SS2.p1.5.m5.4.4.3.3.3.3.3">𝖳</ci></apply></list><ci id="S4.SS2.p1.5.m5.4.4.3.5.cmml" xref="S4.SS2.p1.5.m5.4.4.3.5">𝖳</ci></apply></apply><apply id="S4.SS2.p1.5.m5.4.4c.cmml" xref="S4.SS2.p1.5.m5.4.4"><in id="S4.SS2.p1.5.m5.4.4.7.cmml" xref="S4.SS2.p1.5.m5.4.4.7"></in><share href="https://arxiv.org/html/2406.09742v1#S4.SS2.p1.5.m5.4.4.3.cmml" id="S4.SS2.p1.5.m5.4.4d.cmml" xref="S4.SS2.p1.5.m5.4.4"></share><apply id="S4.SS2.p1.5.m5.4.4.8.cmml" xref="S4.SS2.p1.5.m5.4.4.8"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.4.4.8.1.cmml" xref="S4.SS2.p1.5.m5.4.4.8">superscript</csymbol><ci id="S4.SS2.p1.5.m5.4.4.8.2.cmml" xref="S4.SS2.p1.5.m5.4.4.8.2">ℝ</ci><apply id="S4.SS2.p1.5.m5.4.4.8.3.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3"><times id="S4.SS2.p1.5.m5.4.4.8.3.1.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.1"></times><ci id="S4.SS2.p1.5.m5.4.4.8.3.2.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.2">𝑚</ci><apply id="S4.SS2.p1.5.m5.4.4.8.3.3.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.4.4.8.3.3.1.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.4.4.8.3.3.2.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.3.2">𝑑</ci><apply id="S4.SS2.p1.5.m5.4.4.8.3.3.3.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.3.3"><times id="S4.SS2.p1.5.m5.4.4.8.3.3.3.1.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.3.3.1"></times><ci id="S4.SS2.p1.5.m5.4.4.8.3.3.3.2.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.3.3.2">𝑢</ci><ci id="S4.SS2.p1.5.m5.4.4.8.3.3.3.3.cmml" xref="S4.SS2.p1.5.m5.4.4.8.3.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.4c">{\bm{{\rm F}}}_{cro}=[{\bm{{\rm f}}}_{ui_{1}}^{\mathsf{T}},{\bm{{\rm f}}}_{ui_%
{2}}^{\mathsf{T}},\cdots,{\bm{{\rm f}}}_{ui_{m}}^{\mathsf{T}}]^{\mathsf{T}}\in%
\mathbb{R}^{m\times d_{ui}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.4d">bold_F start_POSTSUBSCRIPT italic_c italic_r italic_o end_POSTSUBSCRIPT = [ bold_f start_POSTSUBSCRIPT italic_u italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT , bold_f start_POSTSUBSCRIPT italic_u italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT , ⋯ , bold_f start_POSTSUBSCRIPT italic_u italic_i start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. The sequence embeddings are denoted as <math alttext="{\bm{{\rm F}}}_{seq}=[{\bm{{\rm f}}}_{j_{1}}^{\mathsf{T}},{\bm{{\rm f}}}_{j_{2%
}}^{\mathsf{T}},\cdots,{\bm{{\rm f}}}_{j_{n}}^{\mathsf{T}}]^{\mathsf{T}}\in%
\mathbb{R}^{n\times d_{i}}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.4"><semantics id="S4.SS2.p1.6.m6.4a"><mrow id="S4.SS2.p1.6.m6.4.4" xref="S4.SS2.p1.6.m6.4.4.cmml"><msub id="S4.SS2.p1.6.m6.4.4.5" xref="S4.SS2.p1.6.m6.4.4.5.cmml"><mi id="S4.SS2.p1.6.m6.4.4.5.2" xref="S4.SS2.p1.6.m6.4.4.5.2.cmml">𝐅</mi><mrow id="S4.SS2.p1.6.m6.4.4.5.3" xref="S4.SS2.p1.6.m6.4.4.5.3.cmml"><mi id="S4.SS2.p1.6.m6.4.4.5.3.2" xref="S4.SS2.p1.6.m6.4.4.5.3.2.cmml">s</mi><mo id="S4.SS2.p1.6.m6.4.4.5.3.1" xref="S4.SS2.p1.6.m6.4.4.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.4.4.5.3.3" xref="S4.SS2.p1.6.m6.4.4.5.3.3.cmml">e</mi><mo id="S4.SS2.p1.6.m6.4.4.5.3.1a" xref="S4.SS2.p1.6.m6.4.4.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.6.m6.4.4.5.3.4" xref="S4.SS2.p1.6.m6.4.4.5.3.4.cmml">q</mi></mrow></msub><mo id="S4.SS2.p1.6.m6.4.4.6" xref="S4.SS2.p1.6.m6.4.4.6.cmml">=</mo><msup id="S4.SS2.p1.6.m6.4.4.3" xref="S4.SS2.p1.6.m6.4.4.3.cmml"><mrow id="S4.SS2.p1.6.m6.4.4.3.3.3" xref="S4.SS2.p1.6.m6.4.4.3.3.4.cmml"><mo id="S4.SS2.p1.6.m6.4.4.3.3.3.4" stretchy="false" xref="S4.SS2.p1.6.m6.4.4.3.3.4.cmml">[</mo><msubsup id="S4.SS2.p1.6.m6.2.2.1.1.1.1" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.2" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.2.cmml">𝐟</mi><msub id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.cmml"><mi id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.2" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.2.cmml">j</mi><mn id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.3" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.3.cmml">1</mn></msub><mi id="S4.SS2.p1.6.m6.2.2.1.1.1.1.3" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.6.m6.4.4.3.3.3.5" xref="S4.SS2.p1.6.m6.4.4.3.3.4.cmml">,</mo><msubsup id="S4.SS2.p1.6.m6.3.3.2.2.2.2" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.cmml"><mi id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.2" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.2.cmml">𝐟</mi><msub id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.cmml"><mi id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.2" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.2.cmml">j</mi><mn id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.3" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.3.cmml">2</mn></msub><mi id="S4.SS2.p1.6.m6.3.3.2.2.2.2.3" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.6.m6.4.4.3.3.3.6" xref="S4.SS2.p1.6.m6.4.4.3.3.4.cmml">,</mo><mi id="S4.SS2.p1.6.m6.1.1" mathvariant="normal" xref="S4.SS2.p1.6.m6.1.1.cmml">⋯</mi><mo id="S4.SS2.p1.6.m6.4.4.3.3.3.7" xref="S4.SS2.p1.6.m6.4.4.3.3.4.cmml">,</mo><msubsup id="S4.SS2.p1.6.m6.4.4.3.3.3.3" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.cmml"><mi id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.2" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.2.cmml">𝐟</mi><msub id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.cmml"><mi id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.2" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.2.cmml">j</mi><mi id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.3" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.3.cmml">n</mi></msub><mi id="S4.SS2.p1.6.m6.4.4.3.3.3.3.3" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.6.m6.4.4.3.3.3.8" stretchy="false" xref="S4.SS2.p1.6.m6.4.4.3.3.4.cmml">]</mo></mrow><mi id="S4.SS2.p1.6.m6.4.4.3.5" xref="S4.SS2.p1.6.m6.4.4.3.5.cmml">𝖳</mi></msup><mo id="S4.SS2.p1.6.m6.4.4.7" xref="S4.SS2.p1.6.m6.4.4.7.cmml">∈</mo><msup id="S4.SS2.p1.6.m6.4.4.8" xref="S4.SS2.p1.6.m6.4.4.8.cmml"><mi id="S4.SS2.p1.6.m6.4.4.8.2" xref="S4.SS2.p1.6.m6.4.4.8.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.6.m6.4.4.8.3" xref="S4.SS2.p1.6.m6.4.4.8.3.cmml"><mi id="S4.SS2.p1.6.m6.4.4.8.3.2" xref="S4.SS2.p1.6.m6.4.4.8.3.2.cmml">n</mi><mo id="S4.SS2.p1.6.m6.4.4.8.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.6.m6.4.4.8.3.1.cmml">×</mo><msub id="S4.SS2.p1.6.m6.4.4.8.3.3" xref="S4.SS2.p1.6.m6.4.4.8.3.3.cmml"><mi id="S4.SS2.p1.6.m6.4.4.8.3.3.2" xref="S4.SS2.p1.6.m6.4.4.8.3.3.2.cmml">d</mi><mi id="S4.SS2.p1.6.m6.4.4.8.3.3.3" xref="S4.SS2.p1.6.m6.4.4.8.3.3.3.cmml">i</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.4b"><apply id="S4.SS2.p1.6.m6.4.4.cmml" xref="S4.SS2.p1.6.m6.4.4"><and id="S4.SS2.p1.6.m6.4.4a.cmml" xref="S4.SS2.p1.6.m6.4.4"></and><apply id="S4.SS2.p1.6.m6.4.4b.cmml" xref="S4.SS2.p1.6.m6.4.4"><eq id="S4.SS2.p1.6.m6.4.4.6.cmml" xref="S4.SS2.p1.6.m6.4.4.6"></eq><apply id="S4.SS2.p1.6.m6.4.4.5.cmml" xref="S4.SS2.p1.6.m6.4.4.5"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.4.4.5.1.cmml" xref="S4.SS2.p1.6.m6.4.4.5">subscript</csymbol><ci id="S4.SS2.p1.6.m6.4.4.5.2.cmml" xref="S4.SS2.p1.6.m6.4.4.5.2">𝐅</ci><apply id="S4.SS2.p1.6.m6.4.4.5.3.cmml" xref="S4.SS2.p1.6.m6.4.4.5.3"><times id="S4.SS2.p1.6.m6.4.4.5.3.1.cmml" xref="S4.SS2.p1.6.m6.4.4.5.3.1"></times><ci id="S4.SS2.p1.6.m6.4.4.5.3.2.cmml" xref="S4.SS2.p1.6.m6.4.4.5.3.2">𝑠</ci><ci id="S4.SS2.p1.6.m6.4.4.5.3.3.cmml" xref="S4.SS2.p1.6.m6.4.4.5.3.3">𝑒</ci><ci id="S4.SS2.p1.6.m6.4.4.5.3.4.cmml" xref="S4.SS2.p1.6.m6.4.4.5.3.4">𝑞</ci></apply></apply><apply id="S4.SS2.p1.6.m6.4.4.3.cmml" xref="S4.SS2.p1.6.m6.4.4.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.4.4.3.4.cmml" xref="S4.SS2.p1.6.m6.4.4.3">superscript</csymbol><list id="S4.SS2.p1.6.m6.4.4.3.3.4.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3"><apply id="S4.SS2.p1.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.2">𝐟</ci><apply id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.2">𝑗</ci><cn id="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p1.6.m6.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p1.6.m6.2.2.1.1.1.1.3">𝖳</ci></apply><apply id="S4.SS2.p1.6.m6.3.3.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.3.3.2.2.2.2.1.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.2">𝐟</ci><apply id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.2.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.2">𝑗</ci><cn id="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.3.cmml" type="integer" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.2.3.3">2</cn></apply></apply><ci id="S4.SS2.p1.6.m6.3.3.2.2.2.2.3.cmml" xref="S4.SS2.p1.6.m6.3.3.2.2.2.2.3">𝖳</ci></apply><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">⋯</ci><apply id="S4.SS2.p1.6.m6.4.4.3.3.3.3.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.4.4.3.3.3.3.1.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3">superscript</csymbol><apply id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.1.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.2.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.2">𝐟</ci><apply id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.1.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3">subscript</csymbol><ci id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.2.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.2">𝑗</ci><ci id="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.3.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.2.3.3">𝑛</ci></apply></apply><ci id="S4.SS2.p1.6.m6.4.4.3.3.3.3.3.cmml" xref="S4.SS2.p1.6.m6.4.4.3.3.3.3.3">𝖳</ci></apply></list><ci id="S4.SS2.p1.6.m6.4.4.3.5.cmml" xref="S4.SS2.p1.6.m6.4.4.3.5">𝖳</ci></apply></apply><apply id="S4.SS2.p1.6.m6.4.4c.cmml" xref="S4.SS2.p1.6.m6.4.4"><in id="S4.SS2.p1.6.m6.4.4.7.cmml" xref="S4.SS2.p1.6.m6.4.4.7"></in><share href="https://arxiv.org/html/2406.09742v1#S4.SS2.p1.6.m6.4.4.3.cmml" id="S4.SS2.p1.6.m6.4.4d.cmml" xref="S4.SS2.p1.6.m6.4.4"></share><apply id="S4.SS2.p1.6.m6.4.4.8.cmml" xref="S4.SS2.p1.6.m6.4.4.8"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.4.4.8.1.cmml" xref="S4.SS2.p1.6.m6.4.4.8">superscript</csymbol><ci id="S4.SS2.p1.6.m6.4.4.8.2.cmml" xref="S4.SS2.p1.6.m6.4.4.8.2">ℝ</ci><apply id="S4.SS2.p1.6.m6.4.4.8.3.cmml" xref="S4.SS2.p1.6.m6.4.4.8.3"><times id="S4.SS2.p1.6.m6.4.4.8.3.1.cmml" xref="S4.SS2.p1.6.m6.4.4.8.3.1"></times><ci id="S4.SS2.p1.6.m6.4.4.8.3.2.cmml" xref="S4.SS2.p1.6.m6.4.4.8.3.2">𝑛</ci><apply id="S4.SS2.p1.6.m6.4.4.8.3.3.cmml" xref="S4.SS2.p1.6.m6.4.4.8.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.4.4.8.3.3.1.cmml" xref="S4.SS2.p1.6.m6.4.4.8.3.3">subscript</csymbol><ci id="S4.SS2.p1.6.m6.4.4.8.3.3.2.cmml" xref="S4.SS2.p1.6.m6.4.4.8.3.3.2">𝑑</ci><ci id="S4.SS2.p1.6.m6.4.4.8.3.3.3.cmml" xref="S4.SS2.p1.6.m6.4.4.8.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.4c">{\bm{{\rm F}}}_{seq}=[{\bm{{\rm f}}}_{j_{1}}^{\mathsf{T}},{\bm{{\rm f}}}_{j_{2%
}}^{\mathsf{T}},\cdots,{\bm{{\rm f}}}_{j_{n}}^{\mathsf{T}}]^{\mathsf{T}}\in%
\mathbb{R}^{n\times d_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.4d">bold_F start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT = [ bold_f start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT , bold_f start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT , ⋯ , bold_f start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. And the user-wide feature embeddings are <math alttext="{\bm{{\rm f}}}_{u}" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><msub id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">𝐟</mi><mi id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝐟</ci><ci id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">{\bm{{\rm f}}}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">bold_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> repeated <math alttext="m" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m8.1"><semantics id="S4.SS2.p1.8.m8.1a"><mi id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.8.m8.1d">italic_m</annotation></semantics></math> times: <math alttext="{\bm{{\rm F}}}_{u}=[{\bm{{\rm f}}}_{u}^{\mathsf{T}},\cdots,{\bm{{\rm f}}}_{u}^%
{\mathsf{T}}]^{\mathsf{T}}\in\mathbb{R}^{m\times d_{u}}" class="ltx_Math" display="inline" id="S4.SS2.p1.9.m9.3"><semantics id="S4.SS2.p1.9.m9.3a"><mrow id="S4.SS2.p1.9.m9.3.3" xref="S4.SS2.p1.9.m9.3.3.cmml"><msub id="S4.SS2.p1.9.m9.3.3.4" xref="S4.SS2.p1.9.m9.3.3.4.cmml"><mi id="S4.SS2.p1.9.m9.3.3.4.2" xref="S4.SS2.p1.9.m9.3.3.4.2.cmml">𝐅</mi><mi id="S4.SS2.p1.9.m9.3.3.4.3" xref="S4.SS2.p1.9.m9.3.3.4.3.cmml">u</mi></msub><mo id="S4.SS2.p1.9.m9.3.3.5" xref="S4.SS2.p1.9.m9.3.3.5.cmml">=</mo><msup id="S4.SS2.p1.9.m9.3.3.2" xref="S4.SS2.p1.9.m9.3.3.2.cmml"><mrow id="S4.SS2.p1.9.m9.3.3.2.2.2" xref="S4.SS2.p1.9.m9.3.3.2.2.3.cmml"><mo id="S4.SS2.p1.9.m9.3.3.2.2.2.3" stretchy="false" xref="S4.SS2.p1.9.m9.3.3.2.2.3.cmml">[</mo><msubsup id="S4.SS2.p1.9.m9.2.2.1.1.1.1" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.2" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.2.cmml">𝐟</mi><mi id="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.3" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.3.cmml">u</mi><mi id="S4.SS2.p1.9.m9.2.2.1.1.1.1.3" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.9.m9.3.3.2.2.2.4" xref="S4.SS2.p1.9.m9.3.3.2.2.3.cmml">,</mo><mi id="S4.SS2.p1.9.m9.1.1" mathvariant="normal" xref="S4.SS2.p1.9.m9.1.1.cmml">⋯</mi><mo id="S4.SS2.p1.9.m9.3.3.2.2.2.5" xref="S4.SS2.p1.9.m9.3.3.2.2.3.cmml">,</mo><msubsup id="S4.SS2.p1.9.m9.3.3.2.2.2.2" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2.cmml"><mi id="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.2" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.2.cmml">𝐟</mi><mi id="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.3" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.3.cmml">u</mi><mi id="S4.SS2.p1.9.m9.3.3.2.2.2.2.3" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2.3.cmml">𝖳</mi></msubsup><mo id="S4.SS2.p1.9.m9.3.3.2.2.2.6" stretchy="false" xref="S4.SS2.p1.9.m9.3.3.2.2.3.cmml">]</mo></mrow><mi id="S4.SS2.p1.9.m9.3.3.2.4" xref="S4.SS2.p1.9.m9.3.3.2.4.cmml">𝖳</mi></msup><mo id="S4.SS2.p1.9.m9.3.3.6" xref="S4.SS2.p1.9.m9.3.3.6.cmml">∈</mo><msup id="S4.SS2.p1.9.m9.3.3.7" xref="S4.SS2.p1.9.m9.3.3.7.cmml"><mi id="S4.SS2.p1.9.m9.3.3.7.2" xref="S4.SS2.p1.9.m9.3.3.7.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.9.m9.3.3.7.3" xref="S4.SS2.p1.9.m9.3.3.7.3.cmml"><mi id="S4.SS2.p1.9.m9.3.3.7.3.2" xref="S4.SS2.p1.9.m9.3.3.7.3.2.cmml">m</mi><mo id="S4.SS2.p1.9.m9.3.3.7.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.9.m9.3.3.7.3.1.cmml">×</mo><msub id="S4.SS2.p1.9.m9.3.3.7.3.3" xref="S4.SS2.p1.9.m9.3.3.7.3.3.cmml"><mi id="S4.SS2.p1.9.m9.3.3.7.3.3.2" xref="S4.SS2.p1.9.m9.3.3.7.3.3.2.cmml">d</mi><mi id="S4.SS2.p1.9.m9.3.3.7.3.3.3" xref="S4.SS2.p1.9.m9.3.3.7.3.3.3.cmml">u</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.3b"><apply id="S4.SS2.p1.9.m9.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3"><and id="S4.SS2.p1.9.m9.3.3a.cmml" xref="S4.SS2.p1.9.m9.3.3"></and><apply id="S4.SS2.p1.9.m9.3.3b.cmml" xref="S4.SS2.p1.9.m9.3.3"><eq id="S4.SS2.p1.9.m9.3.3.5.cmml" xref="S4.SS2.p1.9.m9.3.3.5"></eq><apply id="S4.SS2.p1.9.m9.3.3.4.cmml" xref="S4.SS2.p1.9.m9.3.3.4"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.4.1.cmml" xref="S4.SS2.p1.9.m9.3.3.4">subscript</csymbol><ci id="S4.SS2.p1.9.m9.3.3.4.2.cmml" xref="S4.SS2.p1.9.m9.3.3.4.2">𝐅</ci><ci id="S4.SS2.p1.9.m9.3.3.4.3.cmml" xref="S4.SS2.p1.9.m9.3.3.4.3">𝑢</ci></apply><apply id="S4.SS2.p1.9.m9.3.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.2.3.cmml" xref="S4.SS2.p1.9.m9.3.3.2">superscript</csymbol><list id="S4.SS2.p1.9.m9.3.3.2.2.3.cmml" xref="S4.SS2.p1.9.m9.3.3.2.2.2"><apply id="S4.SS2.p1.9.m9.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.2">𝐟</ci><ci id="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1.2.3">𝑢</ci></apply><ci id="S4.SS2.p1.9.m9.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.1.1.3">𝖳</ci></apply><ci id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">⋯</ci><apply id="S4.SS2.p1.9.m9.3.3.2.2.2.2.cmml" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.2.2.2.2.1.cmml" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2">superscript</csymbol><apply id="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.cmml" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.2">𝐟</ci><ci id="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2.2.3">𝑢</ci></apply><ci id="S4.SS2.p1.9.m9.3.3.2.2.2.2.3.cmml" xref="S4.SS2.p1.9.m9.3.3.2.2.2.2.3">𝖳</ci></apply></list><ci id="S4.SS2.p1.9.m9.3.3.2.4.cmml" xref="S4.SS2.p1.9.m9.3.3.2.4">𝖳</ci></apply></apply><apply id="S4.SS2.p1.9.m9.3.3c.cmml" xref="S4.SS2.p1.9.m9.3.3"><in id="S4.SS2.p1.9.m9.3.3.6.cmml" xref="S4.SS2.p1.9.m9.3.3.6"></in><share href="https://arxiv.org/html/2406.09742v1#S4.SS2.p1.9.m9.3.3.2.cmml" id="S4.SS2.p1.9.m9.3.3d.cmml" xref="S4.SS2.p1.9.m9.3.3"></share><apply id="S4.SS2.p1.9.m9.3.3.7.cmml" xref="S4.SS2.p1.9.m9.3.3.7"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.7.1.cmml" xref="S4.SS2.p1.9.m9.3.3.7">superscript</csymbol><ci id="S4.SS2.p1.9.m9.3.3.7.2.cmml" xref="S4.SS2.p1.9.m9.3.3.7.2">ℝ</ci><apply id="S4.SS2.p1.9.m9.3.3.7.3.cmml" xref="S4.SS2.p1.9.m9.3.3.7.3"><times id="S4.SS2.p1.9.m9.3.3.7.3.1.cmml" xref="S4.SS2.p1.9.m9.3.3.7.3.1"></times><ci id="S4.SS2.p1.9.m9.3.3.7.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.7.3.2">𝑚</ci><apply id="S4.SS2.p1.9.m9.3.3.7.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3.7.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.7.3.3.1.cmml" xref="S4.SS2.p1.9.m9.3.3.7.3.3">subscript</csymbol><ci id="S4.SS2.p1.9.m9.3.3.7.3.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.7.3.3.2">𝑑</ci><ci id="S4.SS2.p1.9.m9.3.3.7.3.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3.7.3.3.3">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.3c">{\bm{{\rm F}}}_{u}=[{\bm{{\rm f}}}_{u}^{\mathsf{T}},\cdots,{\bm{{\rm f}}}_{u}^%
{\mathsf{T}}]^{\mathsf{T}}\in\mathbb{R}^{m\times d_{u}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.9.m9.3d">bold_F start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ bold_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT , ⋯ , bold_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.2.1">Interactions Between Candidate Set and Sequence.</span> In this part, we propose the key module of our model. We use cross attention with <math alttext="{\bm{{\rm F}}}_{can}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">𝐅</mi><mrow id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">c</mi><mo id="S4.SS2.p2.1.m1.1.1.3.1" xref="S4.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml">a</mi><mo id="S4.SS2.p2.1.m1.1.1.3.1a" xref="S4.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.1.m1.1.1.3.4" xref="S4.SS2.p2.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝐅</ci><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><times id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">𝑐</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3">𝑎</ci><ci id="S4.SS2.p2.1.m1.1.1.3.4.cmml" xref="S4.SS2.p2.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">{\bm{{\rm F}}}_{can}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">bold_F start_POSTSUBSCRIPT italic_c italic_a italic_n end_POSTSUBSCRIPT</annotation></semantics></math> as query and with <math alttext="{\bm{{\rm F}}}_{seq}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">𝐅</mi><mrow id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">s</mi><mo id="S4.SS2.p2.2.m2.1.1.3.1" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">e</mi><mo id="S4.SS2.p2.2.m2.1.1.3.1a" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.2.m2.1.1.3.4" xref="S4.SS2.p2.2.m2.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝐅</ci><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><times id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">𝑠</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3">𝑒</ci><ci id="S4.SS2.p2.2.m2.1.1.3.4.cmml" xref="S4.SS2.p2.2.m2.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">{\bm{{\rm F}}}_{seq}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">bold_F start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT</annotation></semantics></math> as key and value to construct interactions of target items and sequence items:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx2">
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\bm{{\rm F}}}_{c-s}={\rm fastAtten}({\bm{{\rm F}}}_{can},{\bm{{%
\rm F}}}_{seq},{\bm{{\rm F}}}_{seq})," class="ltx_Math" display="inline" id="S4.E2.m1.1"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><msub id="S4.E2.m1.1.1.1.1.5" xref="S4.E2.m1.1.1.1.1.5.cmml"><mi id="S4.E2.m1.1.1.1.1.5.2" xref="S4.E2.m1.1.1.1.1.5.2.cmml">𝐅</mi><mrow id="S4.E2.m1.1.1.1.1.5.3" xref="S4.E2.m1.1.1.1.1.5.3.cmml"><mi id="S4.E2.m1.1.1.1.1.5.3.2" xref="S4.E2.m1.1.1.1.1.5.3.2.cmml">c</mi><mo id="S4.E2.m1.1.1.1.1.5.3.1" xref="S4.E2.m1.1.1.1.1.5.3.1.cmml">−</mo><mi id="S4.E2.m1.1.1.1.1.5.3.3" xref="S4.E2.m1.1.1.1.1.5.3.3.cmml">s</mi></mrow></msub><mo id="S4.E2.m1.1.1.1.1.4" xref="S4.E2.m1.1.1.1.1.4.cmml">=</mo><mrow id="S4.E2.m1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.3.5" xref="S4.E2.m1.1.1.1.1.3.5.cmml">fastAtten</mi><mo id="S4.E2.m1.1.1.1.1.3.4" xref="S4.E2.m1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="S4.E2.m1.1.1.1.1.3.3.3" xref="S4.E2.m1.1.1.1.1.3.3.4.cmml"><mo id="S4.E2.m1.1.1.1.1.3.3.3.4" stretchy="false" xref="S4.E2.m1.1.1.1.1.3.3.4.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml">a</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.3.1a" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3.4" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="S4.E2.m1.1.1.1.1.3.3.3.5" xref="S4.E2.m1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S4.E2.m1.1.1.1.1.2.2.2.2" xref="S4.E2.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E2.m1.1.1.1.1.2.2.2.2.2" xref="S4.E2.m1.1.1.1.1.2.2.2.2.2.cmml">𝐅</mi><mrow id="S4.E2.m1.1.1.1.1.2.2.2.2.3" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.2.2.2.2.3.2" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.2.cmml">s</mi><mo id="S4.E2.m1.1.1.1.1.2.2.2.2.3.1" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.2.2.2.2.3.3" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.3.cmml">e</mi><mo id="S4.E2.m1.1.1.1.1.2.2.2.2.3.1a" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.2.2.2.2.3.4" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.4.cmml">q</mi></mrow></msub><mo id="S4.E2.m1.1.1.1.1.3.3.3.6" xref="S4.E2.m1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S4.E2.m1.1.1.1.1.3.3.3.3" xref="S4.E2.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S4.E2.m1.1.1.1.1.3.3.3.3.2" xref="S4.E2.m1.1.1.1.1.3.3.3.3.2.cmml">𝐅</mi><mrow id="S4.E2.m1.1.1.1.1.3.3.3.3.3" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S4.E2.m1.1.1.1.1.3.3.3.3.3.2" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.2.cmml">s</mi><mo id="S4.E2.m1.1.1.1.1.3.3.3.3.3.1" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.3.3.3.3.3.3" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.3.cmml">e</mi><mo id="S4.E2.m1.1.1.1.1.3.3.3.3.3.1a" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E2.m1.1.1.1.1.3.3.3.3.3.4" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.4.cmml">q</mi></mrow></msub><mo id="S4.E2.m1.1.1.1.1.3.3.3.7" stretchy="false" xref="S4.E2.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><eq id="S4.E2.m1.1.1.1.1.4.cmml" xref="S4.E2.m1.1.1.1.1.4"></eq><apply id="S4.E2.m1.1.1.1.1.5.cmml" xref="S4.E2.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.5.1.cmml" xref="S4.E2.m1.1.1.1.1.5">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.5.2.cmml" xref="S4.E2.m1.1.1.1.1.5.2">𝐅</ci><apply id="S4.E2.m1.1.1.1.1.5.3.cmml" xref="S4.E2.m1.1.1.1.1.5.3"><minus id="S4.E2.m1.1.1.1.1.5.3.1.cmml" xref="S4.E2.m1.1.1.1.1.5.3.1"></minus><ci id="S4.E2.m1.1.1.1.1.5.3.2.cmml" xref="S4.E2.m1.1.1.1.1.5.3.2">𝑐</ci><ci id="S4.E2.m1.1.1.1.1.5.3.3.cmml" xref="S4.E2.m1.1.1.1.1.5.3.3">𝑠</ci></apply></apply><apply id="S4.E2.m1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.3"><times id="S4.E2.m1.1.1.1.1.3.4.cmml" xref="S4.E2.m1.1.1.1.1.3.4"></times><ci id="S4.E2.m1.1.1.1.1.3.5.cmml" xref="S4.E2.m1.1.1.1.1.3.5">fastAtten</ci><vector id="S4.E2.m1.1.1.1.1.3.3.4.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3"><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2">𝐅</ci><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3"><times id="S4.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3">𝑎</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply><apply id="S4.E2.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2.2">𝐅</ci><apply id="S4.E2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3"><times id="S4.E2.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S4.E2.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.2">𝑠</ci><ci id="S4.E2.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.3">𝑒</ci><ci id="S4.E2.m1.1.1.1.1.2.2.2.2.3.4.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2.3.4">𝑞</ci></apply></apply><apply id="S4.E2.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3.2">𝐅</ci><apply id="S4.E2.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3"><times id="S4.E2.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.1"></times><ci id="S4.E2.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.2">𝑠</ci><ci id="S4.E2.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.3">𝑒</ci><ci id="S4.E2.m1.1.1.1.1.3.3.3.3.3.4.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.4">𝑞</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\displaystyle{\bm{{\rm F}}}_{c-s}={\rm fastAtten}({\bm{{\rm F}}}_{can},{\bm{{%
\rm F}}}_{seq},{\bm{{\rm F}}}_{seq}),</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.1d">bold_F start_POSTSUBSCRIPT italic_c - italic_s end_POSTSUBSCRIPT = roman_fastAtten ( bold_F start_POSTSUBSCRIPT italic_c italic_a italic_n end_POSTSUBSCRIPT , bold_F start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT , bold_F start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.3">where <math alttext="{\rm fastAtten}(query,key,value)" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m1.3"><semantics id="S4.SS2.p2.3.m1.3a"><mrow id="S4.SS2.p2.3.m1.3.3" xref="S4.SS2.p2.3.m1.3.3.cmml"><mi id="S4.SS2.p2.3.m1.3.3.5" xref="S4.SS2.p2.3.m1.3.3.5.cmml">fastAtten</mi><mo id="S4.SS2.p2.3.m1.3.3.4" xref="S4.SS2.p2.3.m1.3.3.4.cmml">⁢</mo><mrow id="S4.SS2.p2.3.m1.3.3.3.3" xref="S4.SS2.p2.3.m1.3.3.3.4.cmml"><mo id="S4.SS2.p2.3.m1.3.3.3.3.4" stretchy="false" xref="S4.SS2.p2.3.m1.3.3.3.4.cmml">(</mo><mrow id="S4.SS2.p2.3.m1.1.1.1.1.1" xref="S4.SS2.p2.3.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.3.m1.1.1.1.1.1.2" xref="S4.SS2.p2.3.m1.1.1.1.1.1.2.cmml">q</mi><mo id="S4.SS2.p2.3.m1.1.1.1.1.1.1" xref="S4.SS2.p2.3.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.1.1.1.1.1.3" xref="S4.SS2.p2.3.m1.1.1.1.1.1.3.cmml">u</mi><mo id="S4.SS2.p2.3.m1.1.1.1.1.1.1a" xref="S4.SS2.p2.3.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.1.1.1.1.1.4" xref="S4.SS2.p2.3.m1.1.1.1.1.1.4.cmml">e</mi><mo id="S4.SS2.p2.3.m1.1.1.1.1.1.1b" xref="S4.SS2.p2.3.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.1.1.1.1.1.5" xref="S4.SS2.p2.3.m1.1.1.1.1.1.5.cmml">r</mi><mo id="S4.SS2.p2.3.m1.1.1.1.1.1.1c" xref="S4.SS2.p2.3.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.1.1.1.1.1.6" xref="S4.SS2.p2.3.m1.1.1.1.1.1.6.cmml">y</mi></mrow><mo id="S4.SS2.p2.3.m1.3.3.3.3.5" xref="S4.SS2.p2.3.m1.3.3.3.4.cmml">,</mo><mrow id="S4.SS2.p2.3.m1.2.2.2.2.2" xref="S4.SS2.p2.3.m1.2.2.2.2.2.cmml"><mi id="S4.SS2.p2.3.m1.2.2.2.2.2.2" xref="S4.SS2.p2.3.m1.2.2.2.2.2.2.cmml">k</mi><mo id="S4.SS2.p2.3.m1.2.2.2.2.2.1" xref="S4.SS2.p2.3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.2.2.2.2.2.3" xref="S4.SS2.p2.3.m1.2.2.2.2.2.3.cmml">e</mi><mo id="S4.SS2.p2.3.m1.2.2.2.2.2.1a" xref="S4.SS2.p2.3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.2.2.2.2.2.4" xref="S4.SS2.p2.3.m1.2.2.2.2.2.4.cmml">y</mi></mrow><mo id="S4.SS2.p2.3.m1.3.3.3.3.6" xref="S4.SS2.p2.3.m1.3.3.3.4.cmml">,</mo><mrow id="S4.SS2.p2.3.m1.3.3.3.3.3" xref="S4.SS2.p2.3.m1.3.3.3.3.3.cmml"><mi id="S4.SS2.p2.3.m1.3.3.3.3.3.2" xref="S4.SS2.p2.3.m1.3.3.3.3.3.2.cmml">v</mi><mo id="S4.SS2.p2.3.m1.3.3.3.3.3.1" xref="S4.SS2.p2.3.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.3.3.3.3.3.3" xref="S4.SS2.p2.3.m1.3.3.3.3.3.3.cmml">a</mi><mo id="S4.SS2.p2.3.m1.3.3.3.3.3.1a" xref="S4.SS2.p2.3.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.3.3.3.3.3.4" xref="S4.SS2.p2.3.m1.3.3.3.3.3.4.cmml">l</mi><mo id="S4.SS2.p2.3.m1.3.3.3.3.3.1b" xref="S4.SS2.p2.3.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.3.3.3.3.3.5" xref="S4.SS2.p2.3.m1.3.3.3.3.3.5.cmml">u</mi><mo id="S4.SS2.p2.3.m1.3.3.3.3.3.1c" xref="S4.SS2.p2.3.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m1.3.3.3.3.3.6" xref="S4.SS2.p2.3.m1.3.3.3.3.3.6.cmml">e</mi></mrow><mo id="S4.SS2.p2.3.m1.3.3.3.3.7" stretchy="false" xref="S4.SS2.p2.3.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m1.3b"><apply id="S4.SS2.p2.3.m1.3.3.cmml" xref="S4.SS2.p2.3.m1.3.3"><times id="S4.SS2.p2.3.m1.3.3.4.cmml" xref="S4.SS2.p2.3.m1.3.3.4"></times><ci id="S4.SS2.p2.3.m1.3.3.5.cmml" xref="S4.SS2.p2.3.m1.3.3.5">fastAtten</ci><vector id="S4.SS2.p2.3.m1.3.3.3.4.cmml" xref="S4.SS2.p2.3.m1.3.3.3.3"><apply id="S4.SS2.p2.3.m1.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m1.1.1.1.1.1"><times id="S4.SS2.p2.3.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m1.1.1.1.1.1.1"></times><ci id="S4.SS2.p2.3.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m1.1.1.1.1.1.2">𝑞</ci><ci id="S4.SS2.p2.3.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.3.m1.1.1.1.1.1.3">𝑢</ci><ci id="S4.SS2.p2.3.m1.1.1.1.1.1.4.cmml" xref="S4.SS2.p2.3.m1.1.1.1.1.1.4">𝑒</ci><ci id="S4.SS2.p2.3.m1.1.1.1.1.1.5.cmml" xref="S4.SS2.p2.3.m1.1.1.1.1.1.5">𝑟</ci><ci id="S4.SS2.p2.3.m1.1.1.1.1.1.6.cmml" xref="S4.SS2.p2.3.m1.1.1.1.1.1.6">𝑦</ci></apply><apply id="S4.SS2.p2.3.m1.2.2.2.2.2.cmml" xref="S4.SS2.p2.3.m1.2.2.2.2.2"><times id="S4.SS2.p2.3.m1.2.2.2.2.2.1.cmml" xref="S4.SS2.p2.3.m1.2.2.2.2.2.1"></times><ci id="S4.SS2.p2.3.m1.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.3.m1.2.2.2.2.2.2">𝑘</ci><ci id="S4.SS2.p2.3.m1.2.2.2.2.2.3.cmml" xref="S4.SS2.p2.3.m1.2.2.2.2.2.3">𝑒</ci><ci id="S4.SS2.p2.3.m1.2.2.2.2.2.4.cmml" xref="S4.SS2.p2.3.m1.2.2.2.2.2.4">𝑦</ci></apply><apply id="S4.SS2.p2.3.m1.3.3.3.3.3.cmml" xref="S4.SS2.p2.3.m1.3.3.3.3.3"><times id="S4.SS2.p2.3.m1.3.3.3.3.3.1.cmml" xref="S4.SS2.p2.3.m1.3.3.3.3.3.1"></times><ci id="S4.SS2.p2.3.m1.3.3.3.3.3.2.cmml" xref="S4.SS2.p2.3.m1.3.3.3.3.3.2">𝑣</ci><ci id="S4.SS2.p2.3.m1.3.3.3.3.3.3.cmml" xref="S4.SS2.p2.3.m1.3.3.3.3.3.3">𝑎</ci><ci id="S4.SS2.p2.3.m1.3.3.3.3.3.4.cmml" xref="S4.SS2.p2.3.m1.3.3.3.3.3.4">𝑙</ci><ci id="S4.SS2.p2.3.m1.3.3.3.3.3.5.cmml" xref="S4.SS2.p2.3.m1.3.3.3.3.3.5">𝑢</ci><ci id="S4.SS2.p2.3.m1.3.3.3.3.3.6.cmml" xref="S4.SS2.p2.3.m1.3.3.3.3.3.6">𝑒</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m1.3c">{\rm fastAtten}(query,key,value)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m1.3d">roman_fastAtten ( italic_q italic_u italic_e italic_r italic_y , italic_k italic_e italic_y , italic_v italic_a italic_l italic_u italic_e )</annotation></semantics></math> is the fast attention with linear complexity. In this paper, we adopt Linear Transformer <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib13" title="">2020</a>)</cite> introduced in Section 3.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Interactions in Candidate Set.</span> We also construct interactions between target items in the candidate set by self attention with <math alttext="{\bm{{\rm F}}}_{can}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">𝐅</mi><mrow id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml"><mi id="S4.SS2.p3.1.m1.1.1.3.2" xref="S4.SS2.p3.1.m1.1.1.3.2.cmml">c</mi><mo id="S4.SS2.p3.1.m1.1.1.3.1" xref="S4.SS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p3.1.m1.1.1.3.3" xref="S4.SS2.p3.1.m1.1.1.3.3.cmml">a</mi><mo id="S4.SS2.p3.1.m1.1.1.3.1a" xref="S4.SS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p3.1.m1.1.1.3.4" xref="S4.SS2.p3.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝐅</ci><apply id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3"><times id="S4.SS2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1"></times><ci id="S4.SS2.p3.1.m1.1.1.3.2.cmml" xref="S4.SS2.p3.1.m1.1.1.3.2">𝑐</ci><ci id="S4.SS2.p3.1.m1.1.1.3.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3.3">𝑎</ci><ci id="S4.SS2.p3.1.m1.1.1.3.4.cmml" xref="S4.SS2.p3.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">{\bm{{\rm F}}}_{can}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">bold_F start_POSTSUBSCRIPT italic_c italic_a italic_n end_POSTSUBSCRIPT</annotation></semantics></math> as query, key, and value:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx3">
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\bm{{\rm F}}}_{c-c}={\rm fastAtten}({\bm{{\rm F}}}_{can},{\bm{{%
\rm F}}}_{can},{\bm{{\rm F}}}_{can})," class="ltx_Math" display="inline" id="S4.E3.m1.1"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><msub id="S4.E3.m1.1.1.1.1.5" xref="S4.E3.m1.1.1.1.1.5.cmml"><mi id="S4.E3.m1.1.1.1.1.5.2" xref="S4.E3.m1.1.1.1.1.5.2.cmml">𝐅</mi><mrow id="S4.E3.m1.1.1.1.1.5.3" xref="S4.E3.m1.1.1.1.1.5.3.cmml"><mi id="S4.E3.m1.1.1.1.1.5.3.2" xref="S4.E3.m1.1.1.1.1.5.3.2.cmml">c</mi><mo id="S4.E3.m1.1.1.1.1.5.3.1" xref="S4.E3.m1.1.1.1.1.5.3.1.cmml">−</mo><mi id="S4.E3.m1.1.1.1.1.5.3.3" xref="S4.E3.m1.1.1.1.1.5.3.3.cmml">c</mi></mrow></msub><mo id="S4.E3.m1.1.1.1.1.4" xref="S4.E3.m1.1.1.1.1.4.cmml">=</mo><mrow id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.5" xref="S4.E3.m1.1.1.1.1.3.5.cmml">fastAtten</mi><mo id="S4.E3.m1.1.1.1.1.3.4" xref="S4.E3.m1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1.3.3.3" xref="S4.E3.m1.1.1.1.1.3.3.4.cmml"><mo id="S4.E3.m1.1.1.1.1.3.3.3.4" stretchy="false" xref="S4.E3.m1.1.1.1.1.3.3.4.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml">a</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.3.1a" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3.4" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="S4.E3.m1.1.1.1.1.3.3.3.5" xref="S4.E3.m1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S4.E3.m1.1.1.1.1.2.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.2.cmml">𝐅</mi><mrow id="S4.E3.m1.1.1.1.1.2.2.2.2.3" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.3.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.2.cmml">c</mi><mo id="S4.E3.m1.1.1.1.1.2.2.2.2.3.1" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.3.3" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.3.cmml">a</mi><mo id="S4.E3.m1.1.1.1.1.2.2.2.2.3.1a" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.3.4" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.4.cmml">n</mi></mrow></msub><mo id="S4.E3.m1.1.1.1.1.3.3.3.6" xref="S4.E3.m1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S4.E3.m1.1.1.1.1.3.3.3.3" xref="S4.E3.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.3.3.3.2" xref="S4.E3.m1.1.1.1.1.3.3.3.3.2.cmml">𝐅</mi><mrow id="S4.E3.m1.1.1.1.1.3.3.3.3.3" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.3.3.3.3.2" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.2.cmml">c</mi><mo id="S4.E3.m1.1.1.1.1.3.3.3.3.3.1" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.3.3.3.3.3.3" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.3.cmml">a</mi><mo id="S4.E3.m1.1.1.1.1.3.3.3.3.3.1a" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.3.3.3.3.3.4" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.4.cmml">n</mi></mrow></msub><mo id="S4.E3.m1.1.1.1.1.3.3.3.7" stretchy="false" xref="S4.E3.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><eq id="S4.E3.m1.1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.1.4"></eq><apply id="S4.E3.m1.1.1.1.1.5.cmml" xref="S4.E3.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.5.1.cmml" xref="S4.E3.m1.1.1.1.1.5">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.5.2.cmml" xref="S4.E3.m1.1.1.1.1.5.2">𝐅</ci><apply id="S4.E3.m1.1.1.1.1.5.3.cmml" xref="S4.E3.m1.1.1.1.1.5.3"><minus id="S4.E3.m1.1.1.1.1.5.3.1.cmml" xref="S4.E3.m1.1.1.1.1.5.3.1"></minus><ci id="S4.E3.m1.1.1.1.1.5.3.2.cmml" xref="S4.E3.m1.1.1.1.1.5.3.2">𝑐</ci><ci id="S4.E3.m1.1.1.1.1.5.3.3.cmml" xref="S4.E3.m1.1.1.1.1.5.3.3">𝑐</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3"><times id="S4.E3.m1.1.1.1.1.3.4.cmml" xref="S4.E3.m1.1.1.1.1.3.4"></times><ci id="S4.E3.m1.1.1.1.1.3.5.cmml" xref="S4.E3.m1.1.1.1.1.3.5">fastAtten</ci><vector id="S4.E3.m1.1.1.1.1.3.3.4.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3"><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2">𝐅</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.3">𝑎</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.2">𝐅</ci><apply id="S4.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3"><times id="S4.E3.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.2">𝑐</ci><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.3">𝑎</ci><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.3.4.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.4">𝑛</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3.2">𝐅</ci><apply id="S4.E3.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3"><times id="S4.E3.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.1"></times><ci id="S4.E3.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.2">𝑐</ci><ci id="S4.E3.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.3">𝑎</ci><ci id="S4.E3.m1.1.1.1.1.3.3.3.3.3.4.cmml" xref="S4.E3.m1.1.1.1.1.3.3.3.3.3.4">𝑛</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\displaystyle{\bm{{\rm F}}}_{c-c}={\rm fastAtten}({\bm{{\rm F}}}_{can},{\bm{{%
\rm F}}}_{can},{\bm{{\rm F}}}_{can}),</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.1d">bold_F start_POSTSUBSCRIPT italic_c - italic_c end_POSTSUBSCRIPT = roman_fastAtten ( bold_F start_POSTSUBSCRIPT italic_c italic_a italic_n end_POSTSUBSCRIPT , bold_F start_POSTSUBSCRIPT italic_c italic_a italic_n end_POSTSUBSCRIPT , bold_F start_POSTSUBSCRIPT italic_c italic_a italic_n end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.2">where <math alttext="{\rm fastAtten}(query,key,value)" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m1.3"><semantics id="S4.SS2.p3.2.m1.3a"><mrow id="S4.SS2.p3.2.m1.3.3" xref="S4.SS2.p3.2.m1.3.3.cmml"><mi id="S4.SS2.p3.2.m1.3.3.5" xref="S4.SS2.p3.2.m1.3.3.5.cmml">fastAtten</mi><mo id="S4.SS2.p3.2.m1.3.3.4" xref="S4.SS2.p3.2.m1.3.3.4.cmml">⁢</mo><mrow id="S4.SS2.p3.2.m1.3.3.3.3" xref="S4.SS2.p3.2.m1.3.3.3.4.cmml"><mo id="S4.SS2.p3.2.m1.3.3.3.3.4" stretchy="false" xref="S4.SS2.p3.2.m1.3.3.3.4.cmml">(</mo><mrow id="S4.SS2.p3.2.m1.1.1.1.1.1" xref="S4.SS2.p3.2.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.2.m1.1.1.1.1.1.2" xref="S4.SS2.p3.2.m1.1.1.1.1.1.2.cmml">q</mi><mo id="S4.SS2.p3.2.m1.1.1.1.1.1.1" xref="S4.SS2.p3.2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.1.1.1.1.1.3" xref="S4.SS2.p3.2.m1.1.1.1.1.1.3.cmml">u</mi><mo id="S4.SS2.p3.2.m1.1.1.1.1.1.1a" xref="S4.SS2.p3.2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.1.1.1.1.1.4" xref="S4.SS2.p3.2.m1.1.1.1.1.1.4.cmml">e</mi><mo id="S4.SS2.p3.2.m1.1.1.1.1.1.1b" xref="S4.SS2.p3.2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.1.1.1.1.1.5" xref="S4.SS2.p3.2.m1.1.1.1.1.1.5.cmml">r</mi><mo id="S4.SS2.p3.2.m1.1.1.1.1.1.1c" xref="S4.SS2.p3.2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.1.1.1.1.1.6" xref="S4.SS2.p3.2.m1.1.1.1.1.1.6.cmml">y</mi></mrow><mo id="S4.SS2.p3.2.m1.3.3.3.3.5" xref="S4.SS2.p3.2.m1.3.3.3.4.cmml">,</mo><mrow id="S4.SS2.p3.2.m1.2.2.2.2.2" xref="S4.SS2.p3.2.m1.2.2.2.2.2.cmml"><mi id="S4.SS2.p3.2.m1.2.2.2.2.2.2" xref="S4.SS2.p3.2.m1.2.2.2.2.2.2.cmml">k</mi><mo id="S4.SS2.p3.2.m1.2.2.2.2.2.1" xref="S4.SS2.p3.2.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.2.2.2.2.2.3" xref="S4.SS2.p3.2.m1.2.2.2.2.2.3.cmml">e</mi><mo id="S4.SS2.p3.2.m1.2.2.2.2.2.1a" xref="S4.SS2.p3.2.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.2.2.2.2.2.4" xref="S4.SS2.p3.2.m1.2.2.2.2.2.4.cmml">y</mi></mrow><mo id="S4.SS2.p3.2.m1.3.3.3.3.6" xref="S4.SS2.p3.2.m1.3.3.3.4.cmml">,</mo><mrow id="S4.SS2.p3.2.m1.3.3.3.3.3" xref="S4.SS2.p3.2.m1.3.3.3.3.3.cmml"><mi id="S4.SS2.p3.2.m1.3.3.3.3.3.2" xref="S4.SS2.p3.2.m1.3.3.3.3.3.2.cmml">v</mi><mo id="S4.SS2.p3.2.m1.3.3.3.3.3.1" xref="S4.SS2.p3.2.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.3.3.3.3.3.3" xref="S4.SS2.p3.2.m1.3.3.3.3.3.3.cmml">a</mi><mo id="S4.SS2.p3.2.m1.3.3.3.3.3.1a" xref="S4.SS2.p3.2.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.3.3.3.3.3.4" xref="S4.SS2.p3.2.m1.3.3.3.3.3.4.cmml">l</mi><mo id="S4.SS2.p3.2.m1.3.3.3.3.3.1b" xref="S4.SS2.p3.2.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.3.3.3.3.3.5" xref="S4.SS2.p3.2.m1.3.3.3.3.3.5.cmml">u</mi><mo id="S4.SS2.p3.2.m1.3.3.3.3.3.1c" xref="S4.SS2.p3.2.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m1.3.3.3.3.3.6" xref="S4.SS2.p3.2.m1.3.3.3.3.3.6.cmml">e</mi></mrow><mo id="S4.SS2.p3.2.m1.3.3.3.3.7" stretchy="false" xref="S4.SS2.p3.2.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m1.3b"><apply id="S4.SS2.p3.2.m1.3.3.cmml" xref="S4.SS2.p3.2.m1.3.3"><times id="S4.SS2.p3.2.m1.3.3.4.cmml" xref="S4.SS2.p3.2.m1.3.3.4"></times><ci id="S4.SS2.p3.2.m1.3.3.5.cmml" xref="S4.SS2.p3.2.m1.3.3.5">fastAtten</ci><vector id="S4.SS2.p3.2.m1.3.3.3.4.cmml" xref="S4.SS2.p3.2.m1.3.3.3.3"><apply id="S4.SS2.p3.2.m1.1.1.1.1.1.cmml" xref="S4.SS2.p3.2.m1.1.1.1.1.1"><times id="S4.SS2.p3.2.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.2.m1.1.1.1.1.1.1"></times><ci id="S4.SS2.p3.2.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.2.m1.1.1.1.1.1.2">𝑞</ci><ci id="S4.SS2.p3.2.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.2.m1.1.1.1.1.1.3">𝑢</ci><ci id="S4.SS2.p3.2.m1.1.1.1.1.1.4.cmml" xref="S4.SS2.p3.2.m1.1.1.1.1.1.4">𝑒</ci><ci id="S4.SS2.p3.2.m1.1.1.1.1.1.5.cmml" xref="S4.SS2.p3.2.m1.1.1.1.1.1.5">𝑟</ci><ci id="S4.SS2.p3.2.m1.1.1.1.1.1.6.cmml" xref="S4.SS2.p3.2.m1.1.1.1.1.1.6">𝑦</ci></apply><apply id="S4.SS2.p3.2.m1.2.2.2.2.2.cmml" xref="S4.SS2.p3.2.m1.2.2.2.2.2"><times id="S4.SS2.p3.2.m1.2.2.2.2.2.1.cmml" xref="S4.SS2.p3.2.m1.2.2.2.2.2.1"></times><ci id="S4.SS2.p3.2.m1.2.2.2.2.2.2.cmml" xref="S4.SS2.p3.2.m1.2.2.2.2.2.2">𝑘</ci><ci id="S4.SS2.p3.2.m1.2.2.2.2.2.3.cmml" xref="S4.SS2.p3.2.m1.2.2.2.2.2.3">𝑒</ci><ci id="S4.SS2.p3.2.m1.2.2.2.2.2.4.cmml" xref="S4.SS2.p3.2.m1.2.2.2.2.2.4">𝑦</ci></apply><apply id="S4.SS2.p3.2.m1.3.3.3.3.3.cmml" xref="S4.SS2.p3.2.m1.3.3.3.3.3"><times id="S4.SS2.p3.2.m1.3.3.3.3.3.1.cmml" xref="S4.SS2.p3.2.m1.3.3.3.3.3.1"></times><ci id="S4.SS2.p3.2.m1.3.3.3.3.3.2.cmml" xref="S4.SS2.p3.2.m1.3.3.3.3.3.2">𝑣</ci><ci id="S4.SS2.p3.2.m1.3.3.3.3.3.3.cmml" xref="S4.SS2.p3.2.m1.3.3.3.3.3.3">𝑎</ci><ci id="S4.SS2.p3.2.m1.3.3.3.3.3.4.cmml" xref="S4.SS2.p3.2.m1.3.3.3.3.3.4">𝑙</ci><ci id="S4.SS2.p3.2.m1.3.3.3.3.3.5.cmml" xref="S4.SS2.p3.2.m1.3.3.3.3.3.5">𝑢</ci><ci id="S4.SS2.p3.2.m1.3.3.3.3.3.6.cmml" xref="S4.SS2.p3.2.m1.3.3.3.3.3.6">𝑒</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m1.3c">{\rm fastAtten}(query,key,value)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m1.3d">roman_fastAtten ( italic_q italic_u italic_e italic_r italic_y , italic_k italic_e italic_y , italic_v italic_a italic_l italic_u italic_e )</annotation></semantics></math> is also Linear Transformer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.p4.4.1">Fully-connected Layer.</span>
We concatenate all features <math alttext="{\bm{{\rm F}}}=[{\bm{{\rm F}}}_{c-s},{\bm{{\rm F}}}_{c-c}," class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1b"><mi id="S4.SS2.p4.1.m1.1.1">𝐅</mi><mo id="S4.SS2.p4.1.m1.1.2">=</mo><mrow id="S4.SS2.p4.1.m1.1.3"><mo id="S4.SS2.p4.1.m1.1.3.1" stretchy="false">[</mo><msub id="S4.SS2.p4.1.m1.1.3.2"><mi id="S4.SS2.p4.1.m1.1.3.2.2">𝐅</mi><mrow id="S4.SS2.p4.1.m1.1.3.2.3"><mi id="S4.SS2.p4.1.m1.1.3.2.3.2">c</mi><mo id="S4.SS2.p4.1.m1.1.3.2.3.1">−</mo><mi id="S4.SS2.p4.1.m1.1.3.2.3.3">s</mi></mrow></msub><mo id="S4.SS2.p4.1.m1.1.3.3">,</mo><msub id="S4.SS2.p4.1.m1.1.3.4"><mi id="S4.SS2.p4.1.m1.1.3.4.2">𝐅</mi><mrow id="S4.SS2.p4.1.m1.1.3.4.3"><mi id="S4.SS2.p4.1.m1.1.3.4.3.2">c</mi><mo id="S4.SS2.p4.1.m1.1.3.4.3.1">−</mo><mi id="S4.SS2.p4.1.m1.1.3.4.3.3">c</mi></mrow></msub><mo id="S4.SS2.p4.1.m1.1.3.5">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">{\bm{{\rm F}}}=[{\bm{{\rm F}}}_{c-s},{\bm{{\rm F}}}_{c-c},</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">bold_F = [ bold_F start_POSTSUBSCRIPT italic_c - italic_s end_POSTSUBSCRIPT , bold_F start_POSTSUBSCRIPT italic_c - italic_c end_POSTSUBSCRIPT ,</annotation></semantics></math> <math alttext="{\bm{{\rm F}}}_{u}," class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.1.cmml"><msub id="S4.SS2.p4.2.m2.1.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.1.1.2" xref="S4.SS2.p4.2.m2.1.1.1.1.2.cmml">𝐅</mi><mi id="S4.SS2.p4.2.m2.1.1.1.1.3" xref="S4.SS2.p4.2.m2.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.SS2.p4.2.m2.1.1.1.2" xref="S4.SS2.p4.2.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.1.1.2">𝐅</ci><ci id="S4.SS2.p4.2.m2.1.1.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">{\bm{{\rm F}}}_{u},</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">bold_F start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ,</annotation></semantics></math> <math alttext="{\bm{{\rm F}}}_{cro}]\in\mathbb{R}^{m\times d}" class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1b"><msub id="S4.SS2.p4.3.m3.1.1"><mi id="S4.SS2.p4.3.m3.1.1.2">𝐅</mi><mrow id="S4.SS2.p4.3.m3.1.1.3"><mi id="S4.SS2.p4.3.m3.1.1.3.2">c</mi><mo id="S4.SS2.p4.3.m3.1.1.3.1">⁢</mo><mi id="S4.SS2.p4.3.m3.1.1.3.3">r</mi><mo id="S4.SS2.p4.3.m3.1.1.3.1a">⁢</mo><mi id="S4.SS2.p4.3.m3.1.1.3.4">o</mi></mrow></msub><mo id="S4.SS2.p4.3.m3.1.2" stretchy="false">]</mo><mo id="S4.SS2.p4.3.m3.1.3">∈</mo><mi id="S4.SS2.p4.3.m3.1.4">ℝ</mi><msup id="S4.SS2.p4.3.m3.1.5"><mi id="S4.SS2.p4.3.m3.1.5a"></mi><mrow id="S4.SS2.p4.3.m3.1.5.1"><mi id="S4.SS2.p4.3.m3.1.5.1.2">m</mi><mo id="S4.SS2.p4.3.m3.1.5.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S4.SS2.p4.3.m3.1.5.1.3">d</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">{\bm{{\rm F}}}_{cro}]\in\mathbb{R}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">bold_F start_POSTSUBSCRIPT italic_c italic_r italic_o end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and input <math alttext="{\bm{{\rm F}}}" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m4.1"><semantics id="S4.SS2.p4.4.m4.1a"><mi id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><ci id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">{\bm{{\rm F}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.1d">bold_F</annotation></semantics></math> into a multi-layer perceptron (MLP) to get scores of all candidate items:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}{\bm{{\rm F}}}_{l+1}&amp;=ReLU({\bm{{\rm F}}}_{l}{\bm{{\rm W}}}_{l}+{%
\bm{{\rm b}}}_{l}),\\
{\bm{{\rm y}}}&amp;=\sigma({\bm{{\rm F}}}_{L}{\bm{{\rm w}}}+b),\end{split}" class="ltx_Math" display="block" id="S4.E4.m1.31"><semantics id="S4.E4.m1.31a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E4.m1.31.31.3" rowspacing="0pt"><mtr id="S4.E4.m1.31.31.3a"><mtd class="ltx_align_right" columnalign="right" id="S4.E4.m1.31.31.3b"><msub id="S4.E4.m1.2.2.2.2.2"><mi id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml">𝐅</mi><mrow id="S4.E4.m1.2.2.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E4.m1.2.2.2.2.2.2.1.2" xref="S4.E4.m1.2.2.2.2.2.2.1.2.cmml">l</mi><mo id="S4.E4.m1.2.2.2.2.2.2.1.1" xref="S4.E4.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E4.m1.2.2.2.2.2.2.1.3" xref="S4.E4.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E4.m1.31.31.3c"><mrow id="S4.E4.m1.30.30.2.29.18.16.16"><mrow id="S4.E4.m1.30.30.2.29.18.16.16.1"><mi id="S4.E4.m1.30.30.2.29.18.16.16.1.2"></mi><mo id="S4.E4.m1.3.3.3.3.1.1" xref="S4.E4.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S4.E4.m1.30.30.2.29.18.16.16.1.1"><mi id="S4.E4.m1.4.4.4.4.2.2" xref="S4.E4.m1.4.4.4.4.2.2.cmml">R</mi><mo id="S4.E4.m1.30.30.2.29.18.16.16.1.1.2">⁢</mo><mi id="S4.E4.m1.5.5.5.5.3.3" xref="S4.E4.m1.5.5.5.5.3.3.cmml">e</mi><mo id="S4.E4.m1.30.30.2.29.18.16.16.1.1.2a">⁢</mo><mi id="S4.E4.m1.6.6.6.6.4.4" xref="S4.E4.m1.6.6.6.6.4.4.cmml">L</mi><mo id="S4.E4.m1.30.30.2.29.18.16.16.1.1.2b">⁢</mo><mi id="S4.E4.m1.7.7.7.7.5.5" xref="S4.E4.m1.7.7.7.7.5.5.cmml">U</mi><mo id="S4.E4.m1.30.30.2.29.18.16.16.1.1.2c">⁢</mo><mrow id="S4.E4.m1.30.30.2.29.18.16.16.1.1.1.1"><mo id="S4.E4.m1.8.8.8.8.6.6" stretchy="false">(</mo><mrow id="S4.E4.m1.30.30.2.29.18.16.16.1.1.1.1.1"><mrow id="S4.E4.m1.30.30.2.29.18.16.16.1.1.1.1.1.1"><msub id="S4.E4.m1.30.30.2.29.18.16.16.1.1.1.1.1.1.2"><mi id="S4.E4.m1.9.9.9.9.7.7" xref="S4.E4.m1.9.9.9.9.7.7.cmml">𝐅</mi><mi id="S4.E4.m1.10.10.10.10.8.8.1" xref="S4.E4.m1.10.10.10.10.8.8.1.cmml">l</mi></msub><mo id="S4.E4.m1.30.30.2.29.18.16.16.1.1.1.1.1.1.1">⁢</mo><msub id="S4.E4.m1.30.30.2.29.18.16.16.1.1.1.1.1.1.3"><mi id="S4.E4.m1.11.11.11.11.9.9" xref="S4.E4.m1.11.11.11.11.9.9.cmml">𝐖</mi><mi id="S4.E4.m1.12.12.12.12.10.10.1" xref="S4.E4.m1.12.12.12.12.10.10.1.cmml">l</mi></msub></mrow><mo id="S4.E4.m1.13.13.13.13.11.11" xref="S4.E4.m1.13.13.13.13.11.11.cmml">+</mo><msub id="S4.E4.m1.30.30.2.29.18.16.16.1.1.1.1.1.2"><mi id="S4.E4.m1.14.14.14.14.12.12" xref="S4.E4.m1.14.14.14.14.12.12.cmml">𝐛</mi><mi id="S4.E4.m1.15.15.15.15.13.13.1" xref="S4.E4.m1.15.15.15.15.13.13.1.cmml">l</mi></msub></mrow><mo id="S4.E4.m1.16.16.16.16.14.14" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.17.17.17.17.15.15">,</mo></mrow></mtd></mtr><mtr id="S4.E4.m1.31.31.3d"><mtd class="ltx_align_right" columnalign="right" id="S4.E4.m1.31.31.3e"><mi id="S4.E4.m1.18.18.18.1.1.1" xref="S4.E4.m1.18.18.18.1.1.1.cmml">𝐲</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E4.m1.31.31.3f"><mrow id="S4.E4.m1.31.31.3.30.12.11.11"><mrow id="S4.E4.m1.31.31.3.30.12.11.11.1"><mi id="S4.E4.m1.31.31.3.30.12.11.11.1.2"></mi><mo id="S4.E4.m1.19.19.19.2.1.1" xref="S4.E4.m1.19.19.19.2.1.1.cmml">=</mo><mrow id="S4.E4.m1.31.31.3.30.12.11.11.1.1"><mi id="S4.E4.m1.20.20.20.3.2.2" xref="S4.E4.m1.20.20.20.3.2.2.cmml">σ</mi><mo id="S4.E4.m1.31.31.3.30.12.11.11.1.1.2">⁢</mo><mrow id="S4.E4.m1.31.31.3.30.12.11.11.1.1.1.1"><mo id="S4.E4.m1.21.21.21.4.3.3" stretchy="false">(</mo><mrow id="S4.E4.m1.31.31.3.30.12.11.11.1.1.1.1.1"><mrow id="S4.E4.m1.31.31.3.30.12.11.11.1.1.1.1.1.1"><msub id="S4.E4.m1.31.31.3.30.12.11.11.1.1.1.1.1.1.2"><mi id="S4.E4.m1.22.22.22.5.4.4" xref="S4.E4.m1.22.22.22.5.4.4.cmml">𝐅</mi><mi id="S4.E4.m1.23.23.23.6.5.5.1" xref="S4.E4.m1.23.23.23.6.5.5.1.cmml">L</mi></msub><mo id="S4.E4.m1.31.31.3.30.12.11.11.1.1.1.1.1.1.1">⁢</mo><mi id="S4.E4.m1.24.24.24.7.6.6" xref="S4.E4.m1.24.24.24.7.6.6.cmml">𝐰</mi></mrow><mo id="S4.E4.m1.25.25.25.8.7.7" xref="S4.E4.m1.25.25.25.8.7.7.cmml">+</mo><mi id="S4.E4.m1.26.26.26.9.8.8" xref="S4.E4.m1.26.26.26.9.8.8.cmml">b</mi></mrow><mo id="S4.E4.m1.27.27.27.10.9.9" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.28.28.28.11.10.10">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E4.m1.31b"><apply id="S4.E4.m1.29.29.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.29.29.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E4.m1.29.29.1.1.1.1.1.cmml"><eq id="S4.E4.m1.3.3.3.3.1.1.cmml" xref="S4.E4.m1.3.3.3.3.1.1"></eq><apply id="S4.E4.m1.29.29.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.29.29.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1">𝐅</ci><apply id="S4.E4.m1.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1"><plus id="S4.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1"></plus><ci id="S4.E4.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.2">𝑙</ci><cn id="S4.E4.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S4.E4.m1.2.2.2.2.2.2.1.3">1</cn></apply></apply><apply id="S4.E4.m1.29.29.1.1.1.1.1.1.cmml"><times id="S4.E4.m1.29.29.1.1.1.1.1.1.2.cmml"></times><ci id="S4.E4.m1.4.4.4.4.2.2.cmml" xref="S4.E4.m1.4.4.4.4.2.2">𝑅</ci><ci id="S4.E4.m1.5.5.5.5.3.3.cmml" xref="S4.E4.m1.5.5.5.5.3.3">𝑒</ci><ci id="S4.E4.m1.6.6.6.6.4.4.cmml" xref="S4.E4.m1.6.6.6.6.4.4">𝐿</ci><ci id="S4.E4.m1.7.7.7.7.5.5.cmml" xref="S4.E4.m1.7.7.7.7.5.5">𝑈</ci><apply id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.cmml"><plus id="S4.E4.m1.13.13.13.13.11.11.cmml" xref="S4.E4.m1.13.13.13.13.11.11"></plus><apply id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.2.cmml"><times id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.2.1.cmml"></times><apply id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.2.2.1.cmml">subscript</csymbol><ci id="S4.E4.m1.9.9.9.9.7.7.cmml" xref="S4.E4.m1.9.9.9.9.7.7">𝐅</ci><ci id="S4.E4.m1.10.10.10.10.8.8.1.cmml" xref="S4.E4.m1.10.10.10.10.8.8.1">𝑙</ci></apply><apply id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.2.3.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.2.3.1.cmml">subscript</csymbol><ci id="S4.E4.m1.11.11.11.11.9.9.cmml" xref="S4.E4.m1.11.11.11.11.9.9">𝐖</ci><ci id="S4.E4.m1.12.12.12.12.10.10.1.cmml" xref="S4.E4.m1.12.12.12.12.10.10.1">𝑙</ci></apply></apply><apply id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.29.29.1.1.1.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E4.m1.14.14.14.14.12.12.cmml" xref="S4.E4.m1.14.14.14.14.12.12">𝐛</ci><ci id="S4.E4.m1.15.15.15.15.13.13.1.cmml" xref="S4.E4.m1.15.15.15.15.13.13.1">𝑙</ci></apply></apply></apply></apply><apply id="S4.E4.m1.29.29.1.1.1.2.2.cmml"><eq id="S4.E4.m1.19.19.19.2.1.1.cmml" xref="S4.E4.m1.19.19.19.2.1.1"></eq><ci id="S4.E4.m1.18.18.18.1.1.1.cmml" xref="S4.E4.m1.18.18.18.1.1.1">𝐲</ci><apply id="S4.E4.m1.29.29.1.1.1.2.2.1.cmml"><times id="S4.E4.m1.29.29.1.1.1.2.2.1.2.cmml"></times><ci id="S4.E4.m1.20.20.20.3.2.2.cmml" xref="S4.E4.m1.20.20.20.3.2.2">𝜎</ci><apply id="S4.E4.m1.29.29.1.1.1.2.2.1.1.1.1.cmml"><plus id="S4.E4.m1.25.25.25.8.7.7.cmml" xref="S4.E4.m1.25.25.25.8.7.7"></plus><apply id="S4.E4.m1.29.29.1.1.1.2.2.1.1.1.1.2.cmml"><times id="S4.E4.m1.29.29.1.1.1.2.2.1.1.1.1.2.1.cmml"></times><apply id="S4.E4.m1.29.29.1.1.1.2.2.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.29.29.1.1.1.2.2.1.1.1.1.2.2.1.cmml">subscript</csymbol><ci id="S4.E4.m1.22.22.22.5.4.4.cmml" xref="S4.E4.m1.22.22.22.5.4.4">𝐅</ci><ci id="S4.E4.m1.23.23.23.6.5.5.1.cmml" xref="S4.E4.m1.23.23.23.6.5.5.1">𝐿</ci></apply><ci id="S4.E4.m1.24.24.24.7.6.6.cmml" xref="S4.E4.m1.24.24.24.7.6.6">𝐰</ci></apply><ci id="S4.E4.m1.26.26.26.9.8.8.cmml" xref="S4.E4.m1.26.26.26.9.8.8">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.31c">\begin{split}{\bm{{\rm F}}}_{l+1}&amp;=ReLU({\bm{{\rm F}}}_{l}{\bm{{\rm W}}}_{l}+{%
\bm{{\rm b}}}_{l}),\\
{\bm{{\rm y}}}&amp;=\sigma({\bm{{\rm F}}}_{L}{\bm{{\rm w}}}+b),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.31d">start_ROW start_CELL bold_F start_POSTSUBSCRIPT italic_l + 1 end_POSTSUBSCRIPT end_CELL start_CELL = italic_R italic_e italic_L italic_U ( bold_F start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT bold_W start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) , end_CELL end_ROW start_ROW start_CELL bold_y end_CELL start_CELL = italic_σ ( bold_F start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT bold_w + italic_b ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p4.11">where <math alttext="{\bm{{\rm W}}}_{l}" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m1.1"><semantics id="S4.SS2.p4.5.m1.1a"><msub id="S4.SS2.p4.5.m1.1.1" xref="S4.SS2.p4.5.m1.1.1.cmml"><mi id="S4.SS2.p4.5.m1.1.1.2" xref="S4.SS2.p4.5.m1.1.1.2.cmml">𝐖</mi><mi id="S4.SS2.p4.5.m1.1.1.3" xref="S4.SS2.p4.5.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m1.1b"><apply id="S4.SS2.p4.5.m1.1.1.cmml" xref="S4.SS2.p4.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.5.m1.1.1.1.cmml" xref="S4.SS2.p4.5.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.5.m1.1.1.2.cmml" xref="S4.SS2.p4.5.m1.1.1.2">𝐖</ci><ci id="S4.SS2.p4.5.m1.1.1.3.cmml" xref="S4.SS2.p4.5.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m1.1c">{\bm{{\rm W}}}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m1.1d">bold_W start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\bm{{\rm w}}}" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m2.1"><semantics id="S4.SS2.p4.6.m2.1a"><mi id="S4.SS2.p4.6.m2.1.1" xref="S4.SS2.p4.6.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m2.1b"><ci id="S4.SS2.p4.6.m2.1.1.cmml" xref="S4.SS2.p4.6.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m2.1c">{\bm{{\rm w}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m2.1d">bold_w</annotation></semantics></math> are weight; <math alttext="{\bm{{\rm b}}}_{l}" class="ltx_Math" display="inline" id="S4.SS2.p4.7.m3.1"><semantics id="S4.SS2.p4.7.m3.1a"><msub id="S4.SS2.p4.7.m3.1.1" xref="S4.SS2.p4.7.m3.1.1.cmml"><mi id="S4.SS2.p4.7.m3.1.1.2" xref="S4.SS2.p4.7.m3.1.1.2.cmml">𝐛</mi><mi id="S4.SS2.p4.7.m3.1.1.3" xref="S4.SS2.p4.7.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m3.1b"><apply id="S4.SS2.p4.7.m3.1.1.cmml" xref="S4.SS2.p4.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m3.1.1.1.cmml" xref="S4.SS2.p4.7.m3.1.1">subscript</csymbol><ci id="S4.SS2.p4.7.m3.1.1.2.cmml" xref="S4.SS2.p4.7.m3.1.1.2">𝐛</ci><ci id="S4.SS2.p4.7.m3.1.1.3.cmml" xref="S4.SS2.p4.7.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m3.1c">{\bm{{\rm b}}}_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.7.m3.1d">bold_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="b" class="ltx_Math" display="inline" id="S4.SS2.p4.8.m4.1"><semantics id="S4.SS2.p4.8.m4.1a"><mi id="S4.SS2.p4.8.m4.1.1" xref="S4.SS2.p4.8.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m4.1b"><ci id="S4.SS2.p4.8.m4.1.1.cmml" xref="S4.SS2.p4.8.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.8.m4.1d">italic_b</annotation></semantics></math> are bias; There are <math alttext="L" class="ltx_Math" display="inline" id="S4.SS2.p4.9.m5.1"><semantics id="S4.SS2.p4.9.m5.1a"><mi id="S4.SS2.p4.9.m5.1.1" xref="S4.SS2.p4.9.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m5.1b"><ci id="S4.SS2.p4.9.m5.1.1.cmml" xref="S4.SS2.p4.9.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.9.m5.1d">italic_L</annotation></semantics></math> hidden layers in the MLP and <math alttext="{\bm{{\rm F}}}_{0}={\bm{{\rm F}}}" class="ltx_Math" display="inline" id="S4.SS2.p4.10.m6.1"><semantics id="S4.SS2.p4.10.m6.1a"><mrow id="S4.SS2.p4.10.m6.1.1" xref="S4.SS2.p4.10.m6.1.1.cmml"><msub id="S4.SS2.p4.10.m6.1.1.2" xref="S4.SS2.p4.10.m6.1.1.2.cmml"><mi id="S4.SS2.p4.10.m6.1.1.2.2" xref="S4.SS2.p4.10.m6.1.1.2.2.cmml">𝐅</mi><mn id="S4.SS2.p4.10.m6.1.1.2.3" xref="S4.SS2.p4.10.m6.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS2.p4.10.m6.1.1.1" xref="S4.SS2.p4.10.m6.1.1.1.cmml">=</mo><mi id="S4.SS2.p4.10.m6.1.1.3" xref="S4.SS2.p4.10.m6.1.1.3.cmml">𝐅</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m6.1b"><apply id="S4.SS2.p4.10.m6.1.1.cmml" xref="S4.SS2.p4.10.m6.1.1"><eq id="S4.SS2.p4.10.m6.1.1.1.cmml" xref="S4.SS2.p4.10.m6.1.1.1"></eq><apply id="S4.SS2.p4.10.m6.1.1.2.cmml" xref="S4.SS2.p4.10.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.10.m6.1.1.2.1.cmml" xref="S4.SS2.p4.10.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.10.m6.1.1.2.2.cmml" xref="S4.SS2.p4.10.m6.1.1.2.2">𝐅</ci><cn id="S4.SS2.p4.10.m6.1.1.2.3.cmml" type="integer" xref="S4.SS2.p4.10.m6.1.1.2.3">0</cn></apply><ci id="S4.SS2.p4.10.m6.1.1.3.cmml" xref="S4.SS2.p4.10.m6.1.1.3">𝐅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.10.m6.1c">{\bm{{\rm F}}}_{0}={\bm{{\rm F}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.10.m6.1d">bold_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_F</annotation></semantics></math>; and <math alttext="{\bm{{\rm y}}}\in\mathbb{R}^{m\times 1}" class="ltx_Math" display="inline" id="S4.SS2.p4.11.m7.1"><semantics id="S4.SS2.p4.11.m7.1a"><mrow id="S4.SS2.p4.11.m7.1.1" xref="S4.SS2.p4.11.m7.1.1.cmml"><mi id="S4.SS2.p4.11.m7.1.1.2" xref="S4.SS2.p4.11.m7.1.1.2.cmml">𝐲</mi><mo id="S4.SS2.p4.11.m7.1.1.1" xref="S4.SS2.p4.11.m7.1.1.1.cmml">∈</mo><msup id="S4.SS2.p4.11.m7.1.1.3" xref="S4.SS2.p4.11.m7.1.1.3.cmml"><mi id="S4.SS2.p4.11.m7.1.1.3.2" xref="S4.SS2.p4.11.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p4.11.m7.1.1.3.3" xref="S4.SS2.p4.11.m7.1.1.3.3.cmml"><mi id="S4.SS2.p4.11.m7.1.1.3.3.2" xref="S4.SS2.p4.11.m7.1.1.3.3.2.cmml">m</mi><mo id="S4.SS2.p4.11.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p4.11.m7.1.1.3.3.1.cmml">×</mo><mn id="S4.SS2.p4.11.m7.1.1.3.3.3" xref="S4.SS2.p4.11.m7.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.11.m7.1b"><apply id="S4.SS2.p4.11.m7.1.1.cmml" xref="S4.SS2.p4.11.m7.1.1"><in id="S4.SS2.p4.11.m7.1.1.1.cmml" xref="S4.SS2.p4.11.m7.1.1.1"></in><ci id="S4.SS2.p4.11.m7.1.1.2.cmml" xref="S4.SS2.p4.11.m7.1.1.2">𝐲</ci><apply id="S4.SS2.p4.11.m7.1.1.3.cmml" xref="S4.SS2.p4.11.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m7.1.1.3.1.cmml" xref="S4.SS2.p4.11.m7.1.1.3">superscript</csymbol><ci id="S4.SS2.p4.11.m7.1.1.3.2.cmml" xref="S4.SS2.p4.11.m7.1.1.3.2">ℝ</ci><apply id="S4.SS2.p4.11.m7.1.1.3.3.cmml" xref="S4.SS2.p4.11.m7.1.1.3.3"><times id="S4.SS2.p4.11.m7.1.1.3.3.1.cmml" xref="S4.SS2.p4.11.m7.1.1.3.3.1"></times><ci id="S4.SS2.p4.11.m7.1.1.3.3.2.cmml" xref="S4.SS2.p4.11.m7.1.1.3.3.2">𝑚</ci><cn id="S4.SS2.p4.11.m7.1.1.3.3.3.cmml" type="integer" xref="S4.SS2.p4.11.m7.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.11.m7.1c">{\bm{{\rm y}}}\in\mathbb{R}^{m\times 1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.11.m7.1d">bold_y ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is the prediction. To predict multiple objectives, we use several MLP networks.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="314" id="S4.F2.g1" src="x3.png" width="702"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Illustration of IFA</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">We represent our IFA in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.F2" title="Figure 2 ‣ 4.2. Model Structure ‣ 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>. It is necessary to point out that we only introduce the most important structure for concise representation in this paper. We can add more modules in real-world application, such as self-attention of sequence, MMOE layer <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib18" title="">2018b</a>)</cite>, PEPnet <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib5" title="">2023b</a>)</cite>, LayerNorm and ResNet <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib27" title="">2017</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Optimization</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.3">In this section, we introduce the optimization method. To learn the probability of all candidate items to be clicked by the user <math alttext="p(cli|can)" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">p</mi><mo id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p1.1.m1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.1.m1.1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1.1.cmml"><mrow id="S4.SS3.p1.1.m1.1.1.1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.1.m1.1.1.1.1.1.2.2" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.2.cmml">c</mi><mo id="S4.SS3.p1.1.m1.1.1.1.1.1.2.1" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.1.1.1.2.3" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.3.cmml">l</mi><mo id="S4.SS3.p1.1.m1.1.1.1.1.1.2.1a" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.1.1.1.2.4" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.4.cmml">i</mi></mrow><mo fence="false" id="S4.SS3.p1.1.m1.1.1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p1.1.m1.1.1.1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p1.1.m1.1.1.1.1.1.3.1" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.1.1.1.3.3" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p1.1.m1.1.1.1.1.1.3.1a" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.1.1.1.3.4" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.4.cmml">n</mi></mrow></mrow><mo id="S4.SS3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><times id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2"></times><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑝</ci><apply id="S4.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2"><times id="S4.SS3.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.1"></times><ci id="S4.SS3.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.2">𝑐</ci><ci id="S4.SS3.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.3">𝑙</ci><ci id="S4.SS3.p1.1.m1.1.1.1.1.1.2.4.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.2.4">𝑖</ci></apply><apply id="S4.SS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3"><times id="S4.SS3.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.1"></times><ci id="S4.SS3.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.2">𝑐</ci><ci id="S4.SS3.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.3">𝑎</ci><ci id="S4.SS3.p1.1.m1.1.1.1.1.1.3.4.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">p(cli|can)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_p ( italic_c italic_l italic_i | italic_c italic_a italic_n )</annotation></semantics></math>. We follow <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib19" title="">2018a</a>)</cite> to deal with the sparsity issue by modeling the sequential pattern of <math alttext="candidate\rightarrow impression\rightarrow click" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mrow id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.2.2.cmml">c</mi><mo id="S4.SS3.p1.2.m2.1.1.2.1" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.3" xref="S4.SS3.p1.2.m2.1.1.2.3.cmml">a</mi><mo id="S4.SS3.p1.2.m2.1.1.2.1a" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.4" xref="S4.SS3.p1.2.m2.1.1.2.4.cmml">n</mi><mo id="S4.SS3.p1.2.m2.1.1.2.1b" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.5" xref="S4.SS3.p1.2.m2.1.1.2.5.cmml">d</mi><mo id="S4.SS3.p1.2.m2.1.1.2.1c" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.6" xref="S4.SS3.p1.2.m2.1.1.2.6.cmml">i</mi><mo id="S4.SS3.p1.2.m2.1.1.2.1d" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.7" xref="S4.SS3.p1.2.m2.1.1.2.7.cmml">d</mi><mo id="S4.SS3.p1.2.m2.1.1.2.1e" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.8" xref="S4.SS3.p1.2.m2.1.1.2.8.cmml">a</mi><mo id="S4.SS3.p1.2.m2.1.1.2.1f" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.9" xref="S4.SS3.p1.2.m2.1.1.2.9.cmml">t</mi><mo id="S4.SS3.p1.2.m2.1.1.2.1g" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.2.10" xref="S4.SS3.p1.2.m2.1.1.2.10.cmml">e</mi></mrow><mo id="S4.SS3.p1.2.m2.1.1.3" stretchy="false" xref="S4.SS3.p1.2.m2.1.1.3.cmml">→</mo><mrow id="S4.SS3.p1.2.m2.1.1.4" xref="S4.SS3.p1.2.m2.1.1.4.cmml"><mi id="S4.SS3.p1.2.m2.1.1.4.2" xref="S4.SS3.p1.2.m2.1.1.4.2.cmml">i</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.3" xref="S4.SS3.p1.2.m2.1.1.4.3.cmml">m</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1a" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.4" xref="S4.SS3.p1.2.m2.1.1.4.4.cmml">p</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1b" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.5" xref="S4.SS3.p1.2.m2.1.1.4.5.cmml">r</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1c" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.6" xref="S4.SS3.p1.2.m2.1.1.4.6.cmml">e</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1d" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.7" xref="S4.SS3.p1.2.m2.1.1.4.7.cmml">s</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1e" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.8" xref="S4.SS3.p1.2.m2.1.1.4.8.cmml">s</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1f" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.9" xref="S4.SS3.p1.2.m2.1.1.4.9.cmml">i</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1g" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.10" xref="S4.SS3.p1.2.m2.1.1.4.10.cmml">o</mi><mo id="S4.SS3.p1.2.m2.1.1.4.1h" xref="S4.SS3.p1.2.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.4.11" xref="S4.SS3.p1.2.m2.1.1.4.11.cmml">n</mi></mrow><mo id="S4.SS3.p1.2.m2.1.1.5" stretchy="false" xref="S4.SS3.p1.2.m2.1.1.5.cmml">→</mo><mrow id="S4.SS3.p1.2.m2.1.1.6" xref="S4.SS3.p1.2.m2.1.1.6.cmml"><mi id="S4.SS3.p1.2.m2.1.1.6.2" xref="S4.SS3.p1.2.m2.1.1.6.2.cmml">c</mi><mo id="S4.SS3.p1.2.m2.1.1.6.1" xref="S4.SS3.p1.2.m2.1.1.6.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.6.3" xref="S4.SS3.p1.2.m2.1.1.6.3.cmml">l</mi><mo id="S4.SS3.p1.2.m2.1.1.6.1a" xref="S4.SS3.p1.2.m2.1.1.6.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.6.4" xref="S4.SS3.p1.2.m2.1.1.6.4.cmml">i</mi><mo id="S4.SS3.p1.2.m2.1.1.6.1b" xref="S4.SS3.p1.2.m2.1.1.6.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.6.5" xref="S4.SS3.p1.2.m2.1.1.6.5.cmml">c</mi><mo id="S4.SS3.p1.2.m2.1.1.6.1c" xref="S4.SS3.p1.2.m2.1.1.6.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.6.6" xref="S4.SS3.p1.2.m2.1.1.6.6.cmml">k</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><and id="S4.SS3.p1.2.m2.1.1a.cmml" xref="S4.SS3.p1.2.m2.1.1"></and><apply id="S4.SS3.p1.2.m2.1.1b.cmml" xref="S4.SS3.p1.2.m2.1.1"><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">→</ci><apply id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2"><times id="S4.SS3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1.2.1"></times><ci id="S4.SS3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.2">𝑐</ci><ci id="S4.SS3.p1.2.m2.1.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3">𝑎</ci><ci id="S4.SS3.p1.2.m2.1.1.2.4.cmml" xref="S4.SS3.p1.2.m2.1.1.2.4">𝑛</ci><ci id="S4.SS3.p1.2.m2.1.1.2.5.cmml" xref="S4.SS3.p1.2.m2.1.1.2.5">𝑑</ci><ci id="S4.SS3.p1.2.m2.1.1.2.6.cmml" xref="S4.SS3.p1.2.m2.1.1.2.6">𝑖</ci><ci id="S4.SS3.p1.2.m2.1.1.2.7.cmml" xref="S4.SS3.p1.2.m2.1.1.2.7">𝑑</ci><ci id="S4.SS3.p1.2.m2.1.1.2.8.cmml" xref="S4.SS3.p1.2.m2.1.1.2.8">𝑎</ci><ci id="S4.SS3.p1.2.m2.1.1.2.9.cmml" xref="S4.SS3.p1.2.m2.1.1.2.9">𝑡</ci><ci id="S4.SS3.p1.2.m2.1.1.2.10.cmml" xref="S4.SS3.p1.2.m2.1.1.2.10">𝑒</ci></apply><apply id="S4.SS3.p1.2.m2.1.1.4.cmml" xref="S4.SS3.p1.2.m2.1.1.4"><times id="S4.SS3.p1.2.m2.1.1.4.1.cmml" xref="S4.SS3.p1.2.m2.1.1.4.1"></times><ci id="S4.SS3.p1.2.m2.1.1.4.2.cmml" xref="S4.SS3.p1.2.m2.1.1.4.2">𝑖</ci><ci id="S4.SS3.p1.2.m2.1.1.4.3.cmml" xref="S4.SS3.p1.2.m2.1.1.4.3">𝑚</ci><ci id="S4.SS3.p1.2.m2.1.1.4.4.cmml" xref="S4.SS3.p1.2.m2.1.1.4.4">𝑝</ci><ci id="S4.SS3.p1.2.m2.1.1.4.5.cmml" xref="S4.SS3.p1.2.m2.1.1.4.5">𝑟</ci><ci id="S4.SS3.p1.2.m2.1.1.4.6.cmml" xref="S4.SS3.p1.2.m2.1.1.4.6">𝑒</ci><ci id="S4.SS3.p1.2.m2.1.1.4.7.cmml" xref="S4.SS3.p1.2.m2.1.1.4.7">𝑠</ci><ci id="S4.SS3.p1.2.m2.1.1.4.8.cmml" xref="S4.SS3.p1.2.m2.1.1.4.8">𝑠</ci><ci id="S4.SS3.p1.2.m2.1.1.4.9.cmml" xref="S4.SS3.p1.2.m2.1.1.4.9">𝑖</ci><ci id="S4.SS3.p1.2.m2.1.1.4.10.cmml" xref="S4.SS3.p1.2.m2.1.1.4.10">𝑜</ci><ci id="S4.SS3.p1.2.m2.1.1.4.11.cmml" xref="S4.SS3.p1.2.m2.1.1.4.11">𝑛</ci></apply></apply><apply id="S4.SS3.p1.2.m2.1.1c.cmml" xref="S4.SS3.p1.2.m2.1.1"><ci id="S4.SS3.p1.2.m2.1.1.5.cmml" xref="S4.SS3.p1.2.m2.1.1.5">→</ci><share href="https://arxiv.org/html/2406.09742v1#S4.SS3.p1.2.m2.1.1.4.cmml" id="S4.SS3.p1.2.m2.1.1d.cmml" xref="S4.SS3.p1.2.m2.1.1"></share><apply id="S4.SS3.p1.2.m2.1.1.6.cmml" xref="S4.SS3.p1.2.m2.1.1.6"><times id="S4.SS3.p1.2.m2.1.1.6.1.cmml" xref="S4.SS3.p1.2.m2.1.1.6.1"></times><ci id="S4.SS3.p1.2.m2.1.1.6.2.cmml" xref="S4.SS3.p1.2.m2.1.1.6.2">𝑐</ci><ci id="S4.SS3.p1.2.m2.1.1.6.3.cmml" xref="S4.SS3.p1.2.m2.1.1.6.3">𝑙</ci><ci id="S4.SS3.p1.2.m2.1.1.6.4.cmml" xref="S4.SS3.p1.2.m2.1.1.6.4">𝑖</ci><ci id="S4.SS3.p1.2.m2.1.1.6.5.cmml" xref="S4.SS3.p1.2.m2.1.1.6.5">𝑐</ci><ci id="S4.SS3.p1.2.m2.1.1.6.6.cmml" xref="S4.SS3.p1.2.m2.1.1.6.6">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">candidate\rightarrow impression\rightarrow click</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_c italic_a italic_n italic_d italic_i italic_d italic_a italic_t italic_e → italic_i italic_m italic_p italic_r italic_e italic_s italic_s italic_i italic_o italic_n → italic_c italic_l italic_i italic_c italic_k</annotation></semantics></math>, thus we have <math alttext="p(cli|can)=p(cli|imp)\times p(imp|can)" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.3"><semantics id="S4.SS3.p1.3.m3.3a"><mrow id="S4.SS3.p1.3.m3.3.3" xref="S4.SS3.p1.3.m3.3.3.cmml"><mrow id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.1.3" xref="S4.SS3.p1.3.m3.1.1.1.3.cmml">p</mi><mo id="S4.SS3.p1.3.m3.1.1.1.2" xref="S4.SS3.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p1.3.m3.1.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.3.m3.1.1.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml"><mrow id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.2" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.2.cmml">c</mi><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.3" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.3.cmml">l</mi><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.1a" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.4" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.4.cmml">i</mi></mrow><mo fence="false" id="S4.SS3.p1.3.m3.1.1.1.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.2" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.3" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.1a" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.4" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></mrow><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p1.3.m3.3.3.4" xref="S4.SS3.p1.3.m3.3.3.4.cmml">=</mo><mrow id="S4.SS3.p1.3.m3.3.3.3" xref="S4.SS3.p1.3.m3.3.3.3.cmml"><mrow id="S4.SS3.p1.3.m3.2.2.2.1" xref="S4.SS3.p1.3.m3.2.2.2.1.cmml"><mrow id="S4.SS3.p1.3.m3.2.2.2.1.1" xref="S4.SS3.p1.3.m3.2.2.2.1.1.cmml"><mi id="S4.SS3.p1.3.m3.2.2.2.1.1.3" xref="S4.SS3.p1.3.m3.2.2.2.1.1.3.cmml">p</mi><mo id="S4.SS3.p1.3.m3.2.2.2.1.1.2" xref="S4.SS3.p1.3.m3.2.2.2.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.cmml"><mrow id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.2" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.2.cmml">c</mi><mo id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.1" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.3" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.3.cmml">l</mi><mo id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.1a" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.4" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.4.cmml">i</mi></mrow><mo fence="false" id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.1" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.2" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.1" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.3" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.3.cmml">m</mi><mo id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.1a" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.4" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.4.cmml">p</mi></mrow></mrow><mo id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p1.3.m3.2.2.2.1.2" rspace="0.222em" xref="S4.SS3.p1.3.m3.2.2.2.1.2.cmml">×</mo><mi id="S4.SS3.p1.3.m3.2.2.2.1.3" xref="S4.SS3.p1.3.m3.2.2.2.1.3.cmml">p</mi></mrow><mo id="S4.SS3.p1.3.m3.3.3.3.3" xref="S4.SS3.p1.3.m3.3.3.3.3.cmml">⁢</mo><mrow id="S4.SS3.p1.3.m3.3.3.3.2.1" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.cmml"><mo id="S4.SS3.p1.3.m3.3.3.3.2.1.2" stretchy="false" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.cmml">(</mo><mrow id="S4.SS3.p1.3.m3.3.3.3.2.1.1" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.cmml"><mrow id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.cmml"><mi id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.2" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.2.cmml">i</mi><mo id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.1" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.3" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.3.cmml">m</mi><mo id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.1a" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.4" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.4.cmml">p</mi></mrow><mo fence="false" id="S4.SS3.p1.3.m3.3.3.3.2.1.1.1" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.1.cmml">|</mo><mrow id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.cmml"><mi id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.2" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.1" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.3" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.1a" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.4" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.4.cmml">n</mi></mrow></mrow><mo id="S4.SS3.p1.3.m3.3.3.3.2.1.3" stretchy="false" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.3b"><apply id="S4.SS3.p1.3.m3.3.3.cmml" xref="S4.SS3.p1.3.m3.3.3"><eq id="S4.SS3.p1.3.m3.3.3.4.cmml" xref="S4.SS3.p1.3.m3.3.3.4"></eq><apply id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"><times id="S4.SS3.p1.3.m3.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.2"></times><ci id="S4.SS3.p1.3.m3.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.3">𝑝</ci><apply id="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2"><times id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.1"></times><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.3">𝑙</ci><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.4.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.4">𝑖</ci></apply><apply id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3"><times id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.1"></times><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.3">𝑎</ci><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.4.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply><apply id="S4.SS3.p1.3.m3.3.3.3.cmml" xref="S4.SS3.p1.3.m3.3.3.3"><times id="S4.SS3.p1.3.m3.3.3.3.3.cmml" xref="S4.SS3.p1.3.m3.3.3.3.3"></times><apply id="S4.SS3.p1.3.m3.2.2.2.1.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1"><times id="S4.SS3.p1.3.m3.2.2.2.1.2.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.2"></times><apply id="S4.SS3.p1.3.m3.2.2.2.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1"><times id="S4.SS3.p1.3.m3.2.2.2.1.1.2.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.2"></times><ci id="S4.SS3.p1.3.m3.2.2.2.1.1.3.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.3">𝑝</ci><apply id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2"><times id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.1"></times><ci id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.2">𝑐</ci><ci id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.3">𝑙</ci><ci id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.4.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.2.4">𝑖</ci></apply><apply id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3"><times id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.1"></times><ci id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.3">𝑚</ci><ci id="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.4.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.1.1.1.1.3.4">𝑝</ci></apply></apply></apply><ci id="S4.SS3.p1.3.m3.2.2.2.1.3.cmml" xref="S4.SS3.p1.3.m3.2.2.2.1.3">𝑝</ci></apply><apply id="S4.SS3.p1.3.m3.3.3.3.2.1.1.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1"><csymbol cd="latexml" id="S4.SS3.p1.3.m3.3.3.3.2.1.1.1.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.1">conditional</csymbol><apply id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2"><times id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.1.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.1"></times><ci id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.2.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.2">𝑖</ci><ci id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.3.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.3">𝑚</ci><ci id="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.4.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.2.4">𝑝</ci></apply><apply id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3"><times id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.1"></times><ci id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.2">𝑐</ci><ci id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.3">𝑎</ci><ci id="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.4.cmml" xref="S4.SS3.p1.3.m3.3.3.3.2.1.1.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.3c">p(cli|can)=p(cli|imp)\times p(imp|can)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.3d">italic_p ( italic_c italic_l italic_i | italic_c italic_a italic_n ) = italic_p ( italic_c italic_l italic_i | italic_i italic_m italic_p ) × italic_p ( italic_i italic_m italic_p | italic_c italic_a italic_n )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.4">We use an MLP shown in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.E4" title="In 4.2. Model Structure ‣ 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">4</span></a>) as the impression tower, with the output denoted as <math alttext="{\bm{{\rm y}}}_{imp}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">𝐲</mi><mrow id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p2.1.m1.1.1.3.1" xref="S4.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml">m</mi><mo id="S4.SS3.p2.1.m1.1.1.3.1a" xref="S4.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.1.m1.1.1.3.4" xref="S4.SS3.p2.1.m1.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝐲</ci><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><times id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.1"></times><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">𝑖</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3">𝑚</ci><ci id="S4.SS3.p2.1.m1.1.1.3.4.cmml" xref="S4.SS3.p2.1.m1.1.1.3.4">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">{\bm{{\rm y}}}_{imp}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">bold_y start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT</annotation></semantics></math>; and use another MLP as the click tower, with the output denoted as <math alttext="{\bm{{\rm y}}}_{cli}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">𝐲</mi><mrow id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml"><mi id="S4.SS3.p2.2.m2.1.1.3.2" xref="S4.SS3.p2.2.m2.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p2.2.m2.1.1.3.1" xref="S4.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.2.m2.1.1.3.3" xref="S4.SS3.p2.2.m2.1.1.3.3.cmml">l</mi><mo id="S4.SS3.p2.2.m2.1.1.3.1a" xref="S4.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.2.m2.1.1.3.4" xref="S4.SS3.p2.2.m2.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝐲</ci><apply id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><times id="S4.SS3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3.1"></times><ci id="S4.SS3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.2">𝑐</ci><ci id="S4.SS3.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3">𝑙</ci><ci id="S4.SS3.p2.2.m2.1.1.3.4.cmml" xref="S4.SS3.p2.2.m2.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">{\bm{{\rm y}}}_{cli}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">bold_y start_POSTSUBSCRIPT italic_c italic_l italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Impression labels are denoted as <math alttext="{\bm{{\rm l}}}_{imp}\in\{0,1\}^{m\times 1}" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.2"><semantics id="S4.SS3.p2.3.m3.2a"><mrow id="S4.SS3.p2.3.m3.2.3" xref="S4.SS3.p2.3.m3.2.3.cmml"><msub id="S4.SS3.p2.3.m3.2.3.2" xref="S4.SS3.p2.3.m3.2.3.2.cmml"><mi id="S4.SS3.p2.3.m3.2.3.2.2" xref="S4.SS3.p2.3.m3.2.3.2.2.cmml">𝐥</mi><mrow id="S4.SS3.p2.3.m3.2.3.2.3" xref="S4.SS3.p2.3.m3.2.3.2.3.cmml"><mi id="S4.SS3.p2.3.m3.2.3.2.3.2" xref="S4.SS3.p2.3.m3.2.3.2.3.2.cmml">i</mi><mo id="S4.SS3.p2.3.m3.2.3.2.3.1" xref="S4.SS3.p2.3.m3.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.3.m3.2.3.2.3.3" xref="S4.SS3.p2.3.m3.2.3.2.3.3.cmml">m</mi><mo id="S4.SS3.p2.3.m3.2.3.2.3.1a" xref="S4.SS3.p2.3.m3.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.3.m3.2.3.2.3.4" xref="S4.SS3.p2.3.m3.2.3.2.3.4.cmml">p</mi></mrow></msub><mo id="S4.SS3.p2.3.m3.2.3.1" xref="S4.SS3.p2.3.m3.2.3.1.cmml">∈</mo><msup id="S4.SS3.p2.3.m3.2.3.3" xref="S4.SS3.p2.3.m3.2.3.3.cmml"><mrow id="S4.SS3.p2.3.m3.2.3.3.2.2" xref="S4.SS3.p2.3.m3.2.3.3.2.1.cmml"><mo id="S4.SS3.p2.3.m3.2.3.3.2.2.1" stretchy="false" xref="S4.SS3.p2.3.m3.2.3.3.2.1.cmml">{</mo><mn id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">0</mn><mo id="S4.SS3.p2.3.m3.2.3.3.2.2.2" xref="S4.SS3.p2.3.m3.2.3.3.2.1.cmml">,</mo><mn id="S4.SS3.p2.3.m3.2.2" xref="S4.SS3.p2.3.m3.2.2.cmml">1</mn><mo id="S4.SS3.p2.3.m3.2.3.3.2.2.3" stretchy="false" xref="S4.SS3.p2.3.m3.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S4.SS3.p2.3.m3.2.3.3.3" xref="S4.SS3.p2.3.m3.2.3.3.3.cmml"><mi id="S4.SS3.p2.3.m3.2.3.3.3.2" xref="S4.SS3.p2.3.m3.2.3.3.3.2.cmml">m</mi><mo id="S4.SS3.p2.3.m3.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.3.m3.2.3.3.3.1.cmml">×</mo><mn id="S4.SS3.p2.3.m3.2.3.3.3.3" xref="S4.SS3.p2.3.m3.2.3.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.2b"><apply id="S4.SS3.p2.3.m3.2.3.cmml" xref="S4.SS3.p2.3.m3.2.3"><in id="S4.SS3.p2.3.m3.2.3.1.cmml" xref="S4.SS3.p2.3.m3.2.3.1"></in><apply id="S4.SS3.p2.3.m3.2.3.2.cmml" xref="S4.SS3.p2.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.3.2.1.cmml" xref="S4.SS3.p2.3.m3.2.3.2">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.3.2.2.cmml" xref="S4.SS3.p2.3.m3.2.3.2.2">𝐥</ci><apply id="S4.SS3.p2.3.m3.2.3.2.3.cmml" xref="S4.SS3.p2.3.m3.2.3.2.3"><times id="S4.SS3.p2.3.m3.2.3.2.3.1.cmml" xref="S4.SS3.p2.3.m3.2.3.2.3.1"></times><ci id="S4.SS3.p2.3.m3.2.3.2.3.2.cmml" xref="S4.SS3.p2.3.m3.2.3.2.3.2">𝑖</ci><ci id="S4.SS3.p2.3.m3.2.3.2.3.3.cmml" xref="S4.SS3.p2.3.m3.2.3.2.3.3">𝑚</ci><ci id="S4.SS3.p2.3.m3.2.3.2.3.4.cmml" xref="S4.SS3.p2.3.m3.2.3.2.3.4">𝑝</ci></apply></apply><apply id="S4.SS3.p2.3.m3.2.3.3.cmml" xref="S4.SS3.p2.3.m3.2.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.3.3.1.cmml" xref="S4.SS3.p2.3.m3.2.3.3">superscript</csymbol><set id="S4.SS3.p2.3.m3.2.3.3.2.1.cmml" xref="S4.SS3.p2.3.m3.2.3.3.2.2"><cn id="S4.SS3.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS3.p2.3.m3.1.1">0</cn><cn id="S4.SS3.p2.3.m3.2.2.cmml" type="integer" xref="S4.SS3.p2.3.m3.2.2">1</cn></set><apply id="S4.SS3.p2.3.m3.2.3.3.3.cmml" xref="S4.SS3.p2.3.m3.2.3.3.3"><times id="S4.SS3.p2.3.m3.2.3.3.3.1.cmml" xref="S4.SS3.p2.3.m3.2.3.3.3.1"></times><ci id="S4.SS3.p2.3.m3.2.3.3.3.2.cmml" xref="S4.SS3.p2.3.m3.2.3.3.3.2">𝑚</ci><cn id="S4.SS3.p2.3.m3.2.3.3.3.3.cmml" type="integer" xref="S4.SS3.p2.3.m3.2.3.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.2c">{\bm{{\rm l}}}_{imp}\in\{0,1\}^{m\times 1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.2d">bold_l start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_m × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and click labels are denoted as <math alttext="{\bm{{\rm l}}}_{cli}\in\{0,1\}^{m\times 1}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.2"><semantics id="S4.SS3.p2.4.m4.2a"><mrow id="S4.SS3.p2.4.m4.2.3" xref="S4.SS3.p2.4.m4.2.3.cmml"><msub id="S4.SS3.p2.4.m4.2.3.2" xref="S4.SS3.p2.4.m4.2.3.2.cmml"><mi id="S4.SS3.p2.4.m4.2.3.2.2" xref="S4.SS3.p2.4.m4.2.3.2.2.cmml">𝐥</mi><mrow id="S4.SS3.p2.4.m4.2.3.2.3" xref="S4.SS3.p2.4.m4.2.3.2.3.cmml"><mi id="S4.SS3.p2.4.m4.2.3.2.3.2" xref="S4.SS3.p2.4.m4.2.3.2.3.2.cmml">c</mi><mo id="S4.SS3.p2.4.m4.2.3.2.3.1" xref="S4.SS3.p2.4.m4.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.4.m4.2.3.2.3.3" xref="S4.SS3.p2.4.m4.2.3.2.3.3.cmml">l</mi><mo id="S4.SS3.p2.4.m4.2.3.2.3.1a" xref="S4.SS3.p2.4.m4.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.4.m4.2.3.2.3.4" xref="S4.SS3.p2.4.m4.2.3.2.3.4.cmml">i</mi></mrow></msub><mo id="S4.SS3.p2.4.m4.2.3.1" xref="S4.SS3.p2.4.m4.2.3.1.cmml">∈</mo><msup id="S4.SS3.p2.4.m4.2.3.3" xref="S4.SS3.p2.4.m4.2.3.3.cmml"><mrow id="S4.SS3.p2.4.m4.2.3.3.2.2" xref="S4.SS3.p2.4.m4.2.3.3.2.1.cmml"><mo id="S4.SS3.p2.4.m4.2.3.3.2.2.1" stretchy="false" xref="S4.SS3.p2.4.m4.2.3.3.2.1.cmml">{</mo><mn id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">0</mn><mo id="S4.SS3.p2.4.m4.2.3.3.2.2.2" xref="S4.SS3.p2.4.m4.2.3.3.2.1.cmml">,</mo><mn id="S4.SS3.p2.4.m4.2.2" xref="S4.SS3.p2.4.m4.2.2.cmml">1</mn><mo id="S4.SS3.p2.4.m4.2.3.3.2.2.3" stretchy="false" xref="S4.SS3.p2.4.m4.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S4.SS3.p2.4.m4.2.3.3.3" xref="S4.SS3.p2.4.m4.2.3.3.3.cmml"><mi id="S4.SS3.p2.4.m4.2.3.3.3.2" xref="S4.SS3.p2.4.m4.2.3.3.3.2.cmml">m</mi><mo id="S4.SS3.p2.4.m4.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.4.m4.2.3.3.3.1.cmml">×</mo><mn id="S4.SS3.p2.4.m4.2.3.3.3.3" xref="S4.SS3.p2.4.m4.2.3.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.2b"><apply id="S4.SS3.p2.4.m4.2.3.cmml" xref="S4.SS3.p2.4.m4.2.3"><in id="S4.SS3.p2.4.m4.2.3.1.cmml" xref="S4.SS3.p2.4.m4.2.3.1"></in><apply id="S4.SS3.p2.4.m4.2.3.2.cmml" xref="S4.SS3.p2.4.m4.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.2.3.2.1.cmml" xref="S4.SS3.p2.4.m4.2.3.2">subscript</csymbol><ci id="S4.SS3.p2.4.m4.2.3.2.2.cmml" xref="S4.SS3.p2.4.m4.2.3.2.2">𝐥</ci><apply id="S4.SS3.p2.4.m4.2.3.2.3.cmml" xref="S4.SS3.p2.4.m4.2.3.2.3"><times id="S4.SS3.p2.4.m4.2.3.2.3.1.cmml" xref="S4.SS3.p2.4.m4.2.3.2.3.1"></times><ci id="S4.SS3.p2.4.m4.2.3.2.3.2.cmml" xref="S4.SS3.p2.4.m4.2.3.2.3.2">𝑐</ci><ci id="S4.SS3.p2.4.m4.2.3.2.3.3.cmml" xref="S4.SS3.p2.4.m4.2.3.2.3.3">𝑙</ci><ci id="S4.SS3.p2.4.m4.2.3.2.3.4.cmml" xref="S4.SS3.p2.4.m4.2.3.2.3.4">𝑖</ci></apply></apply><apply id="S4.SS3.p2.4.m4.2.3.3.cmml" xref="S4.SS3.p2.4.m4.2.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.2.3.3.1.cmml" xref="S4.SS3.p2.4.m4.2.3.3">superscript</csymbol><set id="S4.SS3.p2.4.m4.2.3.3.2.1.cmml" xref="S4.SS3.p2.4.m4.2.3.3.2.2"><cn id="S4.SS3.p2.4.m4.1.1.cmml" type="integer" xref="S4.SS3.p2.4.m4.1.1">0</cn><cn id="S4.SS3.p2.4.m4.2.2.cmml" type="integer" xref="S4.SS3.p2.4.m4.2.2">1</cn></set><apply id="S4.SS3.p2.4.m4.2.3.3.3.cmml" xref="S4.SS3.p2.4.m4.2.3.3.3"><times id="S4.SS3.p2.4.m4.2.3.3.3.1.cmml" xref="S4.SS3.p2.4.m4.2.3.3.3.1"></times><ci id="S4.SS3.p2.4.m4.2.3.3.3.2.cmml" xref="S4.SS3.p2.4.m4.2.3.3.3.2">𝑚</ci><cn id="S4.SS3.p2.4.m4.2.3.3.3.3.cmml" type="integer" xref="S4.SS3.p2.4.m4.2.3.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.2c">{\bm{{\rm l}}}_{cli}\in\{0,1\}^{m\times 1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.2d">bold_l start_POSTSUBSCRIPT italic_c italic_l italic_i end_POSTSUBSCRIPT ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_m × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>. The impression loss and the click loss are defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;L_{imp}={\bm{{\rm l}}}_{imp}^{\mathsf{T}}\log{\bm{{\rm y}}}_{imp%
}+({\bm{{\rm 1}}}-{\bm{{\rm l}}}_{imp})^{\mathsf{T}}\log(1-{\bm{{\rm y}}}_{imp%
}),\\
&amp;L_{cli}={\bm{{\rm l}}}_{cli}^{\mathsf{T}}\log({\bm{{\rm y}}}_{imp}\odot{\bm{{%
\rm y}}}_{cli})+({\bm{{\rm 1}}}-{\bm{{\rm l}}}_{cli})^{\mathsf{T}}\log(1-{\bm{%
{\rm y}}}_{imp}\odot{\bm{{\rm y}}}_{cli}),\end{split}" class="ltx_Math" display="block" id="S4.E5.m1.61"><semantics id="S4.E5.m1.61a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E5.m1.61.61.3" rowspacing="0pt"><mtr id="S4.E5.m1.61.61.3a"><mtd id="S4.E5.m1.61.61.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m1.61.61.3c"><mrow id="S4.E5.m1.60.60.2.59.26.26.26"><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1"><msub id="S4.E5.m1.60.60.2.59.26.26.26.1.3"><mi id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml">L</mi><mrow id="S4.E5.m1.2.2.2.2.2.2.1" xref="S4.E5.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E5.m1.2.2.2.2.2.2.1.2" xref="S4.E5.m1.2.2.2.2.2.2.1.2.cmml">i</mi><mo id="S4.E5.m1.2.2.2.2.2.2.1.1" xref="S4.E5.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.2.2.2.2.2.2.1.3" xref="S4.E5.m1.2.2.2.2.2.2.1.3.cmml">m</mi><mo id="S4.E5.m1.2.2.2.2.2.2.1.1a" xref="S4.E5.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.2.2.2.2.2.2.1.4" xref="S4.E5.m1.2.2.2.2.2.2.1.4.cmml">p</mi></mrow></msub><mo id="S4.E5.m1.3.3.3.3.3.3" xref="S4.E5.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.2"><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.2.3"><msubsup id="S4.E5.m1.60.60.2.59.26.26.26.1.2.3.2"><mi id="S4.E5.m1.4.4.4.4.4.4" xref="S4.E5.m1.4.4.4.4.4.4.cmml">𝐥</mi><mrow id="S4.E5.m1.5.5.5.5.5.5.1" xref="S4.E5.m1.5.5.5.5.5.5.1.cmml"><mi id="S4.E5.m1.5.5.5.5.5.5.1.2" xref="S4.E5.m1.5.5.5.5.5.5.1.2.cmml">i</mi><mo id="S4.E5.m1.5.5.5.5.5.5.1.1" xref="S4.E5.m1.5.5.5.5.5.5.1.1.cmml">⁢</mo><mi id="S4.E5.m1.5.5.5.5.5.5.1.3" xref="S4.E5.m1.5.5.5.5.5.5.1.3.cmml">m</mi><mo id="S4.E5.m1.5.5.5.5.5.5.1.1a" xref="S4.E5.m1.5.5.5.5.5.5.1.1.cmml">⁢</mo><mi id="S4.E5.m1.5.5.5.5.5.5.1.4" xref="S4.E5.m1.5.5.5.5.5.5.1.4.cmml">p</mi></mrow><mi id="S4.E5.m1.6.6.6.6.6.6.1" xref="S4.E5.m1.6.6.6.6.6.6.1.cmml">𝖳</mi></msubsup><mo id="S4.E5.m1.60.60.2.59.26.26.26.1.2.3.1" lspace="0.167em">⁢</mo><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.2.3.3"><mi id="S4.E5.m1.7.7.7.7.7.7" xref="S4.E5.m1.7.7.7.7.7.7.cmml">log</mi><mo id="S4.E5.m1.60.60.2.59.26.26.26.1.2.3.3a" lspace="0.167em">⁡</mo><msub id="S4.E5.m1.60.60.2.59.26.26.26.1.2.3.3.1"><mi id="S4.E5.m1.8.8.8.8.8.8" xref="S4.E5.m1.8.8.8.8.8.8.cmml">𝐲</mi><mrow id="S4.E5.m1.9.9.9.9.9.9.1" xref="S4.E5.m1.9.9.9.9.9.9.1.cmml"><mi id="S4.E5.m1.9.9.9.9.9.9.1.2" xref="S4.E5.m1.9.9.9.9.9.9.1.2.cmml">i</mi><mo id="S4.E5.m1.9.9.9.9.9.9.1.1" xref="S4.E5.m1.9.9.9.9.9.9.1.1.cmml">⁢</mo><mi id="S4.E5.m1.9.9.9.9.9.9.1.3" xref="S4.E5.m1.9.9.9.9.9.9.1.3.cmml">m</mi><mo id="S4.E5.m1.9.9.9.9.9.9.1.1a" xref="S4.E5.m1.9.9.9.9.9.9.1.1.cmml">⁢</mo><mi id="S4.E5.m1.9.9.9.9.9.9.1.4" xref="S4.E5.m1.9.9.9.9.9.9.1.4.cmml">p</mi></mrow></msub></mrow></mrow><mo id="S4.E5.m1.10.10.10.10.10.10" xref="S4.E5.m1.10.10.10.10.10.10.cmml">+</mo><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.2.2"><msup id="S4.E5.m1.60.60.2.59.26.26.26.1.1.1.1"><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.1.1.1.1.1"><mo id="S4.E5.m1.11.11.11.11.11.11" stretchy="false">(</mo><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.1.1.1.1.1.1"><mn id="S4.E5.m1.12.12.12.12.12.12" xref="S4.E5.m1.12.12.12.12.12.12.cmml">𝟏</mn><mo id="S4.E5.m1.13.13.13.13.13.13" xref="S4.E5.m1.13.13.13.13.13.13.cmml">−</mo><msub id="S4.E5.m1.60.60.2.59.26.26.26.1.1.1.1.1.1.1.1"><mi id="S4.E5.m1.14.14.14.14.14.14" xref="S4.E5.m1.14.14.14.14.14.14.cmml">𝐥</mi><mrow id="S4.E5.m1.15.15.15.15.15.15.1" xref="S4.E5.m1.15.15.15.15.15.15.1.cmml"><mi id="S4.E5.m1.15.15.15.15.15.15.1.2" xref="S4.E5.m1.15.15.15.15.15.15.1.2.cmml">i</mi><mo id="S4.E5.m1.15.15.15.15.15.15.1.1" xref="S4.E5.m1.15.15.15.15.15.15.1.1.cmml">⁢</mo><mi id="S4.E5.m1.15.15.15.15.15.15.1.3" xref="S4.E5.m1.15.15.15.15.15.15.1.3.cmml">m</mi><mo id="S4.E5.m1.15.15.15.15.15.15.1.1a" xref="S4.E5.m1.15.15.15.15.15.15.1.1.cmml">⁢</mo><mi id="S4.E5.m1.15.15.15.15.15.15.1.4" xref="S4.E5.m1.15.15.15.15.15.15.1.4.cmml">p</mi></mrow></msub></mrow><mo id="S4.E5.m1.16.16.16.16.16.16" stretchy="false">)</mo></mrow><mi id="S4.E5.m1.17.17.17.17.17.17.1" xref="S4.E5.m1.17.17.17.17.17.17.1.cmml">𝖳</mi></msup><mo id="S4.E5.m1.60.60.2.59.26.26.26.1.2.2.3" lspace="0.167em">⁢</mo><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.2.2.2.1"><mi id="S4.E5.m1.18.18.18.18.18.18" xref="S4.E5.m1.18.18.18.18.18.18.cmml">log</mi><mo id="S4.E5.m1.60.60.2.59.26.26.26.1.2.2.2.1a">⁡</mo><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.2.2.2.1.1"><mo id="S4.E5.m1.19.19.19.19.19.19" stretchy="false">(</mo><mrow id="S4.E5.m1.60.60.2.59.26.26.26.1.2.2.2.1.1.1"><mn id="S4.E5.m1.20.20.20.20.20.20" xref="S4.E5.m1.20.20.20.20.20.20.cmml">1</mn><mo id="S4.E5.m1.21.21.21.21.21.21" xref="S4.E5.m1.21.21.21.21.21.21.cmml">−</mo><msub id="S4.E5.m1.60.60.2.59.26.26.26.1.2.2.2.1.1.1.1"><mi id="S4.E5.m1.22.22.22.22.22.22" xref="S4.E5.m1.22.22.22.22.22.22.cmml">𝐲</mi><mrow id="S4.E5.m1.23.23.23.23.23.23.1" xref="S4.E5.m1.23.23.23.23.23.23.1.cmml"><mi id="S4.E5.m1.23.23.23.23.23.23.1.2" xref="S4.E5.m1.23.23.23.23.23.23.1.2.cmml">i</mi><mo id="S4.E5.m1.23.23.23.23.23.23.1.1" xref="S4.E5.m1.23.23.23.23.23.23.1.1.cmml">⁢</mo><mi id="S4.E5.m1.23.23.23.23.23.23.1.3" xref="S4.E5.m1.23.23.23.23.23.23.1.3.cmml">m</mi><mo id="S4.E5.m1.23.23.23.23.23.23.1.1a" xref="S4.E5.m1.23.23.23.23.23.23.1.1.cmml">⁢</mo><mi id="S4.E5.m1.23.23.23.23.23.23.1.4" xref="S4.E5.m1.23.23.23.23.23.23.1.4.cmml">p</mi></mrow></msub></mrow><mo id="S4.E5.m1.24.24.24.24.24.24" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.25.25.25.25.25.25">,</mo></mrow></mtd></mtr><mtr id="S4.E5.m1.61.61.3d"><mtd id="S4.E5.m1.61.61.3e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m1.61.61.3f"><mrow id="S4.E5.m1.61.61.3.60.34.34.34"><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1"><msub id="S4.E5.m1.61.61.3.60.34.34.34.1.4"><mi id="S4.E5.m1.26.26.26.1.1.1" xref="S4.E5.m1.26.26.26.1.1.1.cmml">L</mi><mrow id="S4.E5.m1.27.27.27.2.2.2.1" xref="S4.E5.m1.27.27.27.2.2.2.1.cmml"><mi id="S4.E5.m1.27.27.27.2.2.2.1.2" xref="S4.E5.m1.27.27.27.2.2.2.1.2.cmml">c</mi><mo id="S4.E5.m1.27.27.27.2.2.2.1.1" xref="S4.E5.m1.27.27.27.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.27.27.27.2.2.2.1.3" xref="S4.E5.m1.27.27.27.2.2.2.1.3.cmml">l</mi><mo id="S4.E5.m1.27.27.27.2.2.2.1.1a" xref="S4.E5.m1.27.27.27.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.27.27.27.2.2.2.1.4" xref="S4.E5.m1.27.27.27.2.2.2.1.4.cmml">i</mi></mrow></msub><mo id="S4.E5.m1.28.28.28.3.3.3" xref="S4.E5.m1.28.28.28.3.3.3.cmml">=</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.3"><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1"><msubsup id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1.3"><mi id="S4.E5.m1.29.29.29.4.4.4" xref="S4.E5.m1.29.29.29.4.4.4.cmml">𝐥</mi><mrow id="S4.E5.m1.30.30.30.5.5.5.1" xref="S4.E5.m1.30.30.30.5.5.5.1.cmml"><mi id="S4.E5.m1.30.30.30.5.5.5.1.2" xref="S4.E5.m1.30.30.30.5.5.5.1.2.cmml">c</mi><mo id="S4.E5.m1.30.30.30.5.5.5.1.1" xref="S4.E5.m1.30.30.30.5.5.5.1.1.cmml">⁢</mo><mi id="S4.E5.m1.30.30.30.5.5.5.1.3" xref="S4.E5.m1.30.30.30.5.5.5.1.3.cmml">l</mi><mo id="S4.E5.m1.30.30.30.5.5.5.1.1a" xref="S4.E5.m1.30.30.30.5.5.5.1.1.cmml">⁢</mo><mi id="S4.E5.m1.30.30.30.5.5.5.1.4" xref="S4.E5.m1.30.30.30.5.5.5.1.4.cmml">i</mi></mrow><mi id="S4.E5.m1.31.31.31.6.6.6.1" xref="S4.E5.m1.31.31.31.6.6.6.1.cmml">𝖳</mi></msubsup><mo id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1.2" lspace="0.167em">⁢</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1.1.1"><mi id="S4.E5.m1.32.32.32.7.7.7" xref="S4.E5.m1.32.32.32.7.7.7.cmml">log</mi><mo id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1.1.1a">⁡</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1.1.1.1"><mo id="S4.E5.m1.33.33.33.8.8.8" stretchy="false">(</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1.1.1.1.1"><msub id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1.1.1.1.1.1"><mi id="S4.E5.m1.34.34.34.9.9.9" xref="S4.E5.m1.34.34.34.9.9.9.cmml">𝐲</mi><mrow id="S4.E5.m1.35.35.35.10.10.10.1" xref="S4.E5.m1.35.35.35.10.10.10.1.cmml"><mi id="S4.E5.m1.35.35.35.10.10.10.1.2" xref="S4.E5.m1.35.35.35.10.10.10.1.2.cmml">i</mi><mo id="S4.E5.m1.35.35.35.10.10.10.1.1" xref="S4.E5.m1.35.35.35.10.10.10.1.1.cmml">⁢</mo><mi id="S4.E5.m1.35.35.35.10.10.10.1.3" xref="S4.E5.m1.35.35.35.10.10.10.1.3.cmml">m</mi><mo id="S4.E5.m1.35.35.35.10.10.10.1.1a" xref="S4.E5.m1.35.35.35.10.10.10.1.1.cmml">⁢</mo><mi id="S4.E5.m1.35.35.35.10.10.10.1.4" xref="S4.E5.m1.35.35.35.10.10.10.1.4.cmml">p</mi></mrow></msub><mo id="S4.E5.m1.36.36.36.11.11.11" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.36.36.36.11.11.11.cmml">⊙</mo><msub id="S4.E5.m1.61.61.3.60.34.34.34.1.1.1.1.1.1.1.2"><mi id="S4.E5.m1.37.37.37.12.12.12" xref="S4.E5.m1.37.37.37.12.12.12.cmml">𝐲</mi><mrow id="S4.E5.m1.38.38.38.13.13.13.1" xref="S4.E5.m1.38.38.38.13.13.13.1.cmml"><mi id="S4.E5.m1.38.38.38.13.13.13.1.2" xref="S4.E5.m1.38.38.38.13.13.13.1.2.cmml">c</mi><mo id="S4.E5.m1.38.38.38.13.13.13.1.1" xref="S4.E5.m1.38.38.38.13.13.13.1.1.cmml">⁢</mo><mi id="S4.E5.m1.38.38.38.13.13.13.1.3" xref="S4.E5.m1.38.38.38.13.13.13.1.3.cmml">l</mi><mo id="S4.E5.m1.38.38.38.13.13.13.1.1a" xref="S4.E5.m1.38.38.38.13.13.13.1.1.cmml">⁢</mo><mi id="S4.E5.m1.38.38.38.13.13.13.1.4" xref="S4.E5.m1.38.38.38.13.13.13.1.4.cmml">i</mi></mrow></msub></mrow><mo id="S4.E5.m1.39.39.39.14.14.14" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.40.40.40.15.15.15" xref="S4.E5.m1.40.40.40.15.15.15.cmml">+</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3"><msup id="S4.E5.m1.61.61.3.60.34.34.34.1.2.2.1"><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.2.2.1.1.1"><mo id="S4.E5.m1.41.41.41.16.16.16" stretchy="false">(</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.2.2.1.1.1.1"><mn id="S4.E5.m1.42.42.42.17.17.17" xref="S4.E5.m1.42.42.42.17.17.17.cmml">𝟏</mn><mo id="S4.E5.m1.43.43.43.18.18.18" xref="S4.E5.m1.43.43.43.18.18.18.cmml">−</mo><msub id="S4.E5.m1.61.61.3.60.34.34.34.1.2.2.1.1.1.1.1"><mi id="S4.E5.m1.44.44.44.19.19.19" xref="S4.E5.m1.44.44.44.19.19.19.cmml">𝐥</mi><mrow id="S4.E5.m1.45.45.45.20.20.20.1" xref="S4.E5.m1.45.45.45.20.20.20.1.cmml"><mi id="S4.E5.m1.45.45.45.20.20.20.1.2" xref="S4.E5.m1.45.45.45.20.20.20.1.2.cmml">c</mi><mo id="S4.E5.m1.45.45.45.20.20.20.1.1" xref="S4.E5.m1.45.45.45.20.20.20.1.1.cmml">⁢</mo><mi id="S4.E5.m1.45.45.45.20.20.20.1.3" xref="S4.E5.m1.45.45.45.20.20.20.1.3.cmml">l</mi><mo id="S4.E5.m1.45.45.45.20.20.20.1.1a" xref="S4.E5.m1.45.45.45.20.20.20.1.1.cmml">⁢</mo><mi id="S4.E5.m1.45.45.45.20.20.20.1.4" xref="S4.E5.m1.45.45.45.20.20.20.1.4.cmml">i</mi></mrow></msub></mrow><mo id="S4.E5.m1.46.46.46.21.21.21" stretchy="false">)</mo></mrow><mi id="S4.E5.m1.47.47.47.22.22.22.1" xref="S4.E5.m1.47.47.47.22.22.22.1.cmml">𝖳</mi></msup><mo id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3.3" lspace="0.167em">⁢</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3.2.1"><mi id="S4.E5.m1.48.48.48.23.23.23" xref="S4.E5.m1.48.48.48.23.23.23.cmml">log</mi><mo id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3.2.1a">⁡</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3.2.1.1"><mo id="S4.E5.m1.49.49.49.24.24.24" stretchy="false">(</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3.2.1.1.1"><mn id="S4.E5.m1.50.50.50.25.25.25" xref="S4.E5.m1.50.50.50.25.25.25.cmml">1</mn><mo id="S4.E5.m1.51.51.51.26.26.26" xref="S4.E5.m1.51.51.51.26.26.26.cmml">−</mo><mrow id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3.2.1.1.1.1"><msub id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3.2.1.1.1.1.1"><mi id="S4.E5.m1.52.52.52.27.27.27" xref="S4.E5.m1.52.52.52.27.27.27.cmml">𝐲</mi><mrow id="S4.E5.m1.53.53.53.28.28.28.1" xref="S4.E5.m1.53.53.53.28.28.28.1.cmml"><mi id="S4.E5.m1.53.53.53.28.28.28.1.2" xref="S4.E5.m1.53.53.53.28.28.28.1.2.cmml">i</mi><mo id="S4.E5.m1.53.53.53.28.28.28.1.1" xref="S4.E5.m1.53.53.53.28.28.28.1.1.cmml">⁢</mo><mi id="S4.E5.m1.53.53.53.28.28.28.1.3" xref="S4.E5.m1.53.53.53.28.28.28.1.3.cmml">m</mi><mo id="S4.E5.m1.53.53.53.28.28.28.1.1a" xref="S4.E5.m1.53.53.53.28.28.28.1.1.cmml">⁢</mo><mi id="S4.E5.m1.53.53.53.28.28.28.1.4" xref="S4.E5.m1.53.53.53.28.28.28.1.4.cmml">p</mi></mrow></msub><mo id="S4.E5.m1.54.54.54.29.29.29" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.54.54.54.29.29.29.cmml">⊙</mo><msub id="S4.E5.m1.61.61.3.60.34.34.34.1.3.3.2.1.1.1.1.2"><mi id="S4.E5.m1.55.55.55.30.30.30" xref="S4.E5.m1.55.55.55.30.30.30.cmml">𝐲</mi><mrow id="S4.E5.m1.56.56.56.31.31.31.1" xref="S4.E5.m1.56.56.56.31.31.31.1.cmml"><mi id="S4.E5.m1.56.56.56.31.31.31.1.2" xref="S4.E5.m1.56.56.56.31.31.31.1.2.cmml">c</mi><mo id="S4.E5.m1.56.56.56.31.31.31.1.1" xref="S4.E5.m1.56.56.56.31.31.31.1.1.cmml">⁢</mo><mi id="S4.E5.m1.56.56.56.31.31.31.1.3" xref="S4.E5.m1.56.56.56.31.31.31.1.3.cmml">l</mi><mo id="S4.E5.m1.56.56.56.31.31.31.1.1a" xref="S4.E5.m1.56.56.56.31.31.31.1.1.cmml">⁢</mo><mi id="S4.E5.m1.56.56.56.31.31.31.1.4" xref="S4.E5.m1.56.56.56.31.31.31.1.4.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S4.E5.m1.57.57.57.32.32.32" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.58.58.58.33.33.33">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E5.m1.61b"><apply id="S4.E5.m1.59.59.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E5.m1.59.59.1.1.1.1.1.cmml"><eq id="S4.E5.m1.3.3.3.3.3.3.cmml" xref="S4.E5.m1.3.3.3.3.3.3"></eq><apply id="S4.E5.m1.59.59.1.1.1.1.1.4.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.1.1.4.1.cmml">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1">𝐿</ci><apply id="S4.E5.m1.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.2.2.1"><times id="S4.E5.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E5.m1.2.2.2.2.2.2.1.1"></times><ci id="S4.E5.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E5.m1.2.2.2.2.2.2.1.2">𝑖</ci><ci id="S4.E5.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E5.m1.2.2.2.2.2.2.1.3">𝑚</ci><ci id="S4.E5.m1.2.2.2.2.2.2.1.4.cmml" xref="S4.E5.m1.2.2.2.2.2.2.1.4">𝑝</ci></apply></apply><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.cmml"><plus id="S4.E5.m1.10.10.10.10.10.10.cmml" xref="S4.E5.m1.10.10.10.10.10.10"></plus><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.4.cmml"><times id="S4.E5.m1.59.59.1.1.1.1.1.2.4.1.cmml"></times><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.4.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.1.1.2.4.2.1.cmml">superscript</csymbol><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.4.2.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.1.1.2.4.2.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.4.4.4.4.4.4.cmml" xref="S4.E5.m1.4.4.4.4.4.4">𝐥</ci><apply id="S4.E5.m1.5.5.5.5.5.5.1.cmml" xref="S4.E5.m1.5.5.5.5.5.5.1"><times id="S4.E5.m1.5.5.5.5.5.5.1.1.cmml" xref="S4.E5.m1.5.5.5.5.5.5.1.1"></times><ci id="S4.E5.m1.5.5.5.5.5.5.1.2.cmml" xref="S4.E5.m1.5.5.5.5.5.5.1.2">𝑖</ci><ci id="S4.E5.m1.5.5.5.5.5.5.1.3.cmml" xref="S4.E5.m1.5.5.5.5.5.5.1.3">𝑚</ci><ci id="S4.E5.m1.5.5.5.5.5.5.1.4.cmml" xref="S4.E5.m1.5.5.5.5.5.5.1.4">𝑝</ci></apply></apply><ci id="S4.E5.m1.6.6.6.6.6.6.1.cmml" xref="S4.E5.m1.6.6.6.6.6.6.1">𝖳</ci></apply><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.4.3.cmml"><log id="S4.E5.m1.7.7.7.7.7.7.cmml" xref="S4.E5.m1.7.7.7.7.7.7"></log><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.4.3.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.1.1.2.4.3.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.8.8.8.8.8.8.cmml" xref="S4.E5.m1.8.8.8.8.8.8">𝐲</ci><apply id="S4.E5.m1.9.9.9.9.9.9.1.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1"><times id="S4.E5.m1.9.9.9.9.9.9.1.1.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.1"></times><ci id="S4.E5.m1.9.9.9.9.9.9.1.2.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.2">𝑖</ci><ci id="S4.E5.m1.9.9.9.9.9.9.1.3.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.3">𝑚</ci><ci id="S4.E5.m1.9.9.9.9.9.9.1.4.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.4">𝑝</ci></apply></apply></apply></apply><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.2.cmml"><times id="S4.E5.m1.59.59.1.1.1.1.1.2.2.3.cmml"></times><apply id="S4.E5.m1.59.59.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.1.1.1.1.1.2.cmml">superscript</csymbol><apply id="S4.E5.m1.59.59.1.1.1.1.1.1.1.1.1.1.1.cmml"><minus id="S4.E5.m1.13.13.13.13.13.13.cmml" xref="S4.E5.m1.13.13.13.13.13.13"></minus><cn id="S4.E5.m1.12.12.12.12.12.12.cmml" type="integer" xref="S4.E5.m1.12.12.12.12.12.12">1</cn><apply id="S4.E5.m1.59.59.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E5.m1.14.14.14.14.14.14.cmml" xref="S4.E5.m1.14.14.14.14.14.14">𝐥</ci><apply id="S4.E5.m1.15.15.15.15.15.15.1.cmml" xref="S4.E5.m1.15.15.15.15.15.15.1"><times id="S4.E5.m1.15.15.15.15.15.15.1.1.cmml" xref="S4.E5.m1.15.15.15.15.15.15.1.1"></times><ci id="S4.E5.m1.15.15.15.15.15.15.1.2.cmml" xref="S4.E5.m1.15.15.15.15.15.15.1.2">𝑖</ci><ci id="S4.E5.m1.15.15.15.15.15.15.1.3.cmml" xref="S4.E5.m1.15.15.15.15.15.15.1.3">𝑚</ci><ci id="S4.E5.m1.15.15.15.15.15.15.1.4.cmml" xref="S4.E5.m1.15.15.15.15.15.15.1.4">𝑝</ci></apply></apply></apply><ci id="S4.E5.m1.17.17.17.17.17.17.1.cmml" xref="S4.E5.m1.17.17.17.17.17.17.1">𝖳</ci></apply><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.2.2.2.cmml"><log id="S4.E5.m1.18.18.18.18.18.18.cmml" xref="S4.E5.m1.18.18.18.18.18.18"></log><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.2.2.1.1.1.cmml"><minus id="S4.E5.m1.21.21.21.21.21.21.cmml" xref="S4.E5.m1.21.21.21.21.21.21"></minus><cn id="S4.E5.m1.20.20.20.20.20.20.cmml" type="integer" xref="S4.E5.m1.20.20.20.20.20.20">1</cn><apply id="S4.E5.m1.59.59.1.1.1.1.1.2.2.2.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.1.1.2.2.2.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E5.m1.22.22.22.22.22.22.cmml" xref="S4.E5.m1.22.22.22.22.22.22">𝐲</ci><apply id="S4.E5.m1.23.23.23.23.23.23.1.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1"><times id="S4.E5.m1.23.23.23.23.23.23.1.1.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1.1"></times><ci id="S4.E5.m1.23.23.23.23.23.23.1.2.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1.2">𝑖</ci><ci id="S4.E5.m1.23.23.23.23.23.23.1.3.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1.3">𝑚</ci><ci id="S4.E5.m1.23.23.23.23.23.23.1.4.cmml" xref="S4.E5.m1.23.23.23.23.23.23.1.4">𝑝</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S4.E5.m1.59.59.1.1.1.2.2.cmml"><eq id="S4.E5.m1.28.28.28.3.3.3.cmml" xref="S4.E5.m1.28.28.28.3.3.3"></eq><apply id="S4.E5.m1.59.59.1.1.1.2.2.5.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.5.1.cmml">subscript</csymbol><ci id="S4.E5.m1.26.26.26.1.1.1.cmml" xref="S4.E5.m1.26.26.26.1.1.1">𝐿</ci><apply id="S4.E5.m1.27.27.27.2.2.2.1.cmml" xref="S4.E5.m1.27.27.27.2.2.2.1"><times id="S4.E5.m1.27.27.27.2.2.2.1.1.cmml" xref="S4.E5.m1.27.27.27.2.2.2.1.1"></times><ci id="S4.E5.m1.27.27.27.2.2.2.1.2.cmml" xref="S4.E5.m1.27.27.27.2.2.2.1.2">𝑐</ci><ci id="S4.E5.m1.27.27.27.2.2.2.1.3.cmml" xref="S4.E5.m1.27.27.27.2.2.2.1.3">𝑙</ci><ci id="S4.E5.m1.27.27.27.2.2.2.1.4.cmml" xref="S4.E5.m1.27.27.27.2.2.2.1.4">𝑖</ci></apply></apply><apply id="S4.E5.m1.59.59.1.1.1.2.2.3.cmml"><plus id="S4.E5.m1.40.40.40.15.15.15.cmml" xref="S4.E5.m1.40.40.40.15.15.15"></plus><apply id="S4.E5.m1.59.59.1.1.1.2.2.1.1.cmml"><times id="S4.E5.m1.59.59.1.1.1.2.2.1.1.2.cmml"></times><apply id="S4.E5.m1.59.59.1.1.1.2.2.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.1.1.3.1.cmml">superscript</csymbol><apply id="S4.E5.m1.59.59.1.1.1.2.2.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.1.1.3.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.29.29.29.4.4.4.cmml" xref="S4.E5.m1.29.29.29.4.4.4">𝐥</ci><apply id="S4.E5.m1.30.30.30.5.5.5.1.cmml" xref="S4.E5.m1.30.30.30.5.5.5.1"><times id="S4.E5.m1.30.30.30.5.5.5.1.1.cmml" xref="S4.E5.m1.30.30.30.5.5.5.1.1"></times><ci id="S4.E5.m1.30.30.30.5.5.5.1.2.cmml" xref="S4.E5.m1.30.30.30.5.5.5.1.2">𝑐</ci><ci id="S4.E5.m1.30.30.30.5.5.5.1.3.cmml" xref="S4.E5.m1.30.30.30.5.5.5.1.3">𝑙</ci><ci id="S4.E5.m1.30.30.30.5.5.5.1.4.cmml" xref="S4.E5.m1.30.30.30.5.5.5.1.4">𝑖</ci></apply></apply><ci id="S4.E5.m1.31.31.31.6.6.6.1.cmml" xref="S4.E5.m1.31.31.31.6.6.6.1">𝖳</ci></apply><apply id="S4.E5.m1.59.59.1.1.1.2.2.1.1.1.2.cmml"><log id="S4.E5.m1.32.32.32.7.7.7.cmml" xref="S4.E5.m1.32.32.32.7.7.7"></log><apply id="S4.E5.m1.59.59.1.1.1.2.2.1.1.1.1.1.1.cmml"><csymbol cd="latexml" id="S4.E5.m1.36.36.36.11.11.11.cmml" xref="S4.E5.m1.36.36.36.11.11.11">direct-product</csymbol><apply id="S4.E5.m1.59.59.1.1.1.2.2.1.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.34.34.34.9.9.9.cmml" xref="S4.E5.m1.34.34.34.9.9.9">𝐲</ci><apply id="S4.E5.m1.35.35.35.10.10.10.1.cmml" xref="S4.E5.m1.35.35.35.10.10.10.1"><times id="S4.E5.m1.35.35.35.10.10.10.1.1.cmml" xref="S4.E5.m1.35.35.35.10.10.10.1.1"></times><ci id="S4.E5.m1.35.35.35.10.10.10.1.2.cmml" xref="S4.E5.m1.35.35.35.10.10.10.1.2">𝑖</ci><ci id="S4.E5.m1.35.35.35.10.10.10.1.3.cmml" xref="S4.E5.m1.35.35.35.10.10.10.1.3">𝑚</ci><ci id="S4.E5.m1.35.35.35.10.10.10.1.4.cmml" xref="S4.E5.m1.35.35.35.10.10.10.1.4">𝑝</ci></apply></apply><apply id="S4.E5.m1.59.59.1.1.1.2.2.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E5.m1.37.37.37.12.12.12.cmml" xref="S4.E5.m1.37.37.37.12.12.12">𝐲</ci><apply id="S4.E5.m1.38.38.38.13.13.13.1.cmml" xref="S4.E5.m1.38.38.38.13.13.13.1"><times id="S4.E5.m1.38.38.38.13.13.13.1.1.cmml" xref="S4.E5.m1.38.38.38.13.13.13.1.1"></times><ci id="S4.E5.m1.38.38.38.13.13.13.1.2.cmml" xref="S4.E5.m1.38.38.38.13.13.13.1.2">𝑐</ci><ci id="S4.E5.m1.38.38.38.13.13.13.1.3.cmml" xref="S4.E5.m1.38.38.38.13.13.13.1.3">𝑙</ci><ci id="S4.E5.m1.38.38.38.13.13.13.1.4.cmml" xref="S4.E5.m1.38.38.38.13.13.13.1.4">𝑖</ci></apply></apply></apply></apply></apply><apply id="S4.E5.m1.59.59.1.1.1.2.2.3.3.cmml"><times id="S4.E5.m1.59.59.1.1.1.2.2.3.3.3.cmml"></times><apply id="S4.E5.m1.59.59.1.1.1.2.2.2.2.1.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.2.2.1.2.cmml">superscript</csymbol><apply id="S4.E5.m1.59.59.1.1.1.2.2.2.2.1.1.1.1.cmml"><minus id="S4.E5.m1.43.43.43.18.18.18.cmml" xref="S4.E5.m1.43.43.43.18.18.18"></minus><cn id="S4.E5.m1.42.42.42.17.17.17.cmml" type="integer" xref="S4.E5.m1.42.42.42.17.17.17">1</cn><apply id="S4.E5.m1.59.59.1.1.1.2.2.2.2.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.2.2.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E5.m1.44.44.44.19.19.19.cmml" xref="S4.E5.m1.44.44.44.19.19.19">𝐥</ci><apply id="S4.E5.m1.45.45.45.20.20.20.1.cmml" xref="S4.E5.m1.45.45.45.20.20.20.1"><times id="S4.E5.m1.45.45.45.20.20.20.1.1.cmml" xref="S4.E5.m1.45.45.45.20.20.20.1.1"></times><ci id="S4.E5.m1.45.45.45.20.20.20.1.2.cmml" xref="S4.E5.m1.45.45.45.20.20.20.1.2">𝑐</ci><ci id="S4.E5.m1.45.45.45.20.20.20.1.3.cmml" xref="S4.E5.m1.45.45.45.20.20.20.1.3">𝑙</ci><ci id="S4.E5.m1.45.45.45.20.20.20.1.4.cmml" xref="S4.E5.m1.45.45.45.20.20.20.1.4">𝑖</ci></apply></apply></apply><ci id="S4.E5.m1.47.47.47.22.22.22.1.cmml" xref="S4.E5.m1.47.47.47.22.22.22.1">𝖳</ci></apply><apply id="S4.E5.m1.59.59.1.1.1.2.2.3.3.2.2.cmml"><log id="S4.E5.m1.48.48.48.23.23.23.cmml" xref="S4.E5.m1.48.48.48.23.23.23"></log><apply id="S4.E5.m1.59.59.1.1.1.2.2.3.3.2.1.1.1.cmml"><minus id="S4.E5.m1.51.51.51.26.26.26.cmml" xref="S4.E5.m1.51.51.51.26.26.26"></minus><cn id="S4.E5.m1.50.50.50.25.25.25.cmml" type="integer" xref="S4.E5.m1.50.50.50.25.25.25">1</cn><apply id="S4.E5.m1.59.59.1.1.1.2.2.3.3.2.1.1.1.3.cmml"><csymbol cd="latexml" id="S4.E5.m1.54.54.54.29.29.29.cmml" xref="S4.E5.m1.54.54.54.29.29.29">direct-product</csymbol><apply id="S4.E5.m1.59.59.1.1.1.2.2.3.3.2.1.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.3.3.2.1.1.1.3.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.52.52.52.27.27.27.cmml" xref="S4.E5.m1.52.52.52.27.27.27">𝐲</ci><apply id="S4.E5.m1.53.53.53.28.28.28.1.cmml" xref="S4.E5.m1.53.53.53.28.28.28.1"><times id="S4.E5.m1.53.53.53.28.28.28.1.1.cmml" xref="S4.E5.m1.53.53.53.28.28.28.1.1"></times><ci id="S4.E5.m1.53.53.53.28.28.28.1.2.cmml" xref="S4.E5.m1.53.53.53.28.28.28.1.2">𝑖</ci><ci id="S4.E5.m1.53.53.53.28.28.28.1.3.cmml" xref="S4.E5.m1.53.53.53.28.28.28.1.3">𝑚</ci><ci id="S4.E5.m1.53.53.53.28.28.28.1.4.cmml" xref="S4.E5.m1.53.53.53.28.28.28.1.4">𝑝</ci></apply></apply><apply id="S4.E5.m1.59.59.1.1.1.2.2.3.3.2.1.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.59.59.1.1.1.2.2.3.3.2.1.1.1.3.3.1.cmml">subscript</csymbol><ci id="S4.E5.m1.55.55.55.30.30.30.cmml" xref="S4.E5.m1.55.55.55.30.30.30">𝐲</ci><apply id="S4.E5.m1.56.56.56.31.31.31.1.cmml" xref="S4.E5.m1.56.56.56.31.31.31.1"><times id="S4.E5.m1.56.56.56.31.31.31.1.1.cmml" xref="S4.E5.m1.56.56.56.31.31.31.1.1"></times><ci id="S4.E5.m1.56.56.56.31.31.31.1.2.cmml" xref="S4.E5.m1.56.56.56.31.31.31.1.2">𝑐</ci><ci id="S4.E5.m1.56.56.56.31.31.31.1.3.cmml" xref="S4.E5.m1.56.56.56.31.31.31.1.3">𝑙</ci><ci id="S4.E5.m1.56.56.56.31.31.31.1.4.cmml" xref="S4.E5.m1.56.56.56.31.31.31.1.4">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.61c">\begin{split}&amp;L_{imp}={\bm{{\rm l}}}_{imp}^{\mathsf{T}}\log{\bm{{\rm y}}}_{imp%
}+({\bm{{\rm 1}}}-{\bm{{\rm l}}}_{imp})^{\mathsf{T}}\log(1-{\bm{{\rm y}}}_{imp%
}),\\
&amp;L_{cli}={\bm{{\rm l}}}_{cli}^{\mathsf{T}}\log({\bm{{\rm y}}}_{imp}\odot{\bm{{%
\rm y}}}_{cli})+({\bm{{\rm 1}}}-{\bm{{\rm l}}}_{cli})^{\mathsf{T}}\log(1-{\bm{%
{\rm y}}}_{imp}\odot{\bm{{\rm y}}}_{cli}),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.61d">start_ROW start_CELL end_CELL start_CELL italic_L start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT = bold_l start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT roman_log bold_y start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT + ( bold_1 - bold_l start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT roman_log ( 1 - bold_y start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT ) , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_L start_POSTSUBSCRIPT italic_c italic_l italic_i end_POSTSUBSCRIPT = bold_l start_POSTSUBSCRIPT italic_c italic_l italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT roman_log ( bold_y start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT ⊙ bold_y start_POSTSUBSCRIPT italic_c italic_l italic_i end_POSTSUBSCRIPT ) + ( bold_1 - bold_l start_POSTSUBSCRIPT italic_c italic_l italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT roman_log ( 1 - bold_y start_POSTSUBSCRIPT italic_i italic_m italic_p end_POSTSUBSCRIPT ⊙ bold_y start_POSTSUBSCRIPT italic_c italic_l italic_i end_POSTSUBSCRIPT ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.13">where <math alttext="\odot" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m1.1"><semantics id="S4.SS3.p2.5.m1.1a"><mo id="S4.SS3.p2.5.m1.1.1" xref="S4.SS3.p2.5.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m1.1b"><csymbol cd="latexml" id="S4.SS3.p2.5.m1.1.1.cmml" xref="S4.SS3.p2.5.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m1.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m1.1d">⊙</annotation></semantics></math> means element-wise product, and <math alttext="{\bm{{\rm 1}}}\in\{1\}^{m\times 1}" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m2.1"><semantics id="S4.SS3.p2.6.m2.1a"><mrow id="S4.SS3.p2.6.m2.1.2" xref="S4.SS3.p2.6.m2.1.2.cmml"><mn id="S4.SS3.p2.6.m2.1.2.2" xref="S4.SS3.p2.6.m2.1.2.2.cmml">𝟏</mn><mo id="S4.SS3.p2.6.m2.1.2.1" xref="S4.SS3.p2.6.m2.1.2.1.cmml">∈</mo><msup id="S4.SS3.p2.6.m2.1.2.3" xref="S4.SS3.p2.6.m2.1.2.3.cmml"><mrow id="S4.SS3.p2.6.m2.1.2.3.2.2" xref="S4.SS3.p2.6.m2.1.2.3.2.1.cmml"><mo id="S4.SS3.p2.6.m2.1.2.3.2.2.1" stretchy="false" xref="S4.SS3.p2.6.m2.1.2.3.2.1.cmml">{</mo><mn id="S4.SS3.p2.6.m2.1.1" xref="S4.SS3.p2.6.m2.1.1.cmml">1</mn><mo id="S4.SS3.p2.6.m2.1.2.3.2.2.2" stretchy="false" xref="S4.SS3.p2.6.m2.1.2.3.2.1.cmml">}</mo></mrow><mrow id="S4.SS3.p2.6.m2.1.2.3.3" xref="S4.SS3.p2.6.m2.1.2.3.3.cmml"><mi id="S4.SS3.p2.6.m2.1.2.3.3.2" xref="S4.SS3.p2.6.m2.1.2.3.3.2.cmml">m</mi><mo id="S4.SS3.p2.6.m2.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.6.m2.1.2.3.3.1.cmml">×</mo><mn id="S4.SS3.p2.6.m2.1.2.3.3.3" xref="S4.SS3.p2.6.m2.1.2.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m2.1b"><apply id="S4.SS3.p2.6.m2.1.2.cmml" xref="S4.SS3.p2.6.m2.1.2"><in id="S4.SS3.p2.6.m2.1.2.1.cmml" xref="S4.SS3.p2.6.m2.1.2.1"></in><cn id="S4.SS3.p2.6.m2.1.2.2.cmml" type="integer" xref="S4.SS3.p2.6.m2.1.2.2">1</cn><apply id="S4.SS3.p2.6.m2.1.2.3.cmml" xref="S4.SS3.p2.6.m2.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m2.1.2.3.1.cmml" xref="S4.SS3.p2.6.m2.1.2.3">superscript</csymbol><set id="S4.SS3.p2.6.m2.1.2.3.2.1.cmml" xref="S4.SS3.p2.6.m2.1.2.3.2.2"><cn id="S4.SS3.p2.6.m2.1.1.cmml" type="integer" xref="S4.SS3.p2.6.m2.1.1">1</cn></set><apply id="S4.SS3.p2.6.m2.1.2.3.3.cmml" xref="S4.SS3.p2.6.m2.1.2.3.3"><times id="S4.SS3.p2.6.m2.1.2.3.3.1.cmml" xref="S4.SS3.p2.6.m2.1.2.3.3.1"></times><ci id="S4.SS3.p2.6.m2.1.2.3.3.2.cmml" xref="S4.SS3.p2.6.m2.1.2.3.3.2">𝑚</ci><cn id="S4.SS3.p2.6.m2.1.2.3.3.3.cmml" type="integer" xref="S4.SS3.p2.6.m2.1.2.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m2.1c">{\bm{{\rm 1}}}\in\{1\}^{m\times 1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m2.1d">bold_1 ∈ { 1 } start_POSTSUPERSCRIPT italic_m × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>; <math alttext="{\bm{{\rm y}}}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m3.1"><semantics id="S4.SS3.p2.7.m3.1a"><msub id="S4.SS3.p2.7.m3.1.1" xref="S4.SS3.p2.7.m3.1.1.cmml"><mi id="S4.SS3.p2.7.m3.1.1.2" xref="S4.SS3.p2.7.m3.1.1.2.cmml">𝐲</mi><mi id="S4.SS3.p2.7.m3.1.1.3" xref="S4.SS3.p2.7.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m3.1b"><apply id="S4.SS3.p2.7.m3.1.1.cmml" xref="S4.SS3.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m3.1.1.1.cmml" xref="S4.SS3.p2.7.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.7.m3.1.1.2.cmml" xref="S4.SS3.p2.7.m3.1.1.2">𝐲</ci><ci id="S4.SS3.p2.7.m3.1.1.3.cmml" xref="S4.SS3.p2.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m3.1c">{\bm{{\rm y}}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m3.1d">bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is to predict <math alttext="p(imp|can)" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m4.1"><semantics id="S4.SS3.p2.8.m4.1a"><mrow id="S4.SS3.p2.8.m4.1.1" xref="S4.SS3.p2.8.m4.1.1.cmml"><mi id="S4.SS3.p2.8.m4.1.1.3" xref="S4.SS3.p2.8.m4.1.1.3.cmml">p</mi><mo id="S4.SS3.p2.8.m4.1.1.2" xref="S4.SS3.p2.8.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p2.8.m4.1.1.1.1" xref="S4.SS3.p2.8.m4.1.1.1.1.1.cmml"><mo id="S4.SS3.p2.8.m4.1.1.1.1.2" stretchy="false" xref="S4.SS3.p2.8.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.8.m4.1.1.1.1.1" xref="S4.SS3.p2.8.m4.1.1.1.1.1.cmml"><mrow id="S4.SS3.p2.8.m4.1.1.1.1.1.2" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p2.8.m4.1.1.1.1.1.2.2" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.2.cmml">i</mi><mo id="S4.SS3.p2.8.m4.1.1.1.1.1.2.1" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p2.8.m4.1.1.1.1.1.2.3" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.3.cmml">m</mi><mo id="S4.SS3.p2.8.m4.1.1.1.1.1.2.1a" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p2.8.m4.1.1.1.1.1.2.4" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.4.cmml">p</mi></mrow><mo fence="false" id="S4.SS3.p2.8.m4.1.1.1.1.1.1" xref="S4.SS3.p2.8.m4.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p2.8.m4.1.1.1.1.1.3" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p2.8.m4.1.1.1.1.1.3.2" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p2.8.m4.1.1.1.1.1.3.1" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.8.m4.1.1.1.1.1.3.3" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p2.8.m4.1.1.1.1.1.3.1a" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.8.m4.1.1.1.1.1.3.4" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.4.cmml">n</mi></mrow></mrow><mo id="S4.SS3.p2.8.m4.1.1.1.1.3" stretchy="false" xref="S4.SS3.p2.8.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m4.1b"><apply id="S4.SS3.p2.8.m4.1.1.cmml" xref="S4.SS3.p2.8.m4.1.1"><times id="S4.SS3.p2.8.m4.1.1.2.cmml" xref="S4.SS3.p2.8.m4.1.1.2"></times><ci id="S4.SS3.p2.8.m4.1.1.3.cmml" xref="S4.SS3.p2.8.m4.1.1.3">𝑝</ci><apply id="S4.SS3.p2.8.m4.1.1.1.1.1.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p2.8.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS3.p2.8.m4.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2"><times id="S4.SS3.p2.8.m4.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.1"></times><ci id="S4.SS3.p2.8.m4.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.2">𝑖</ci><ci id="S4.SS3.p2.8.m4.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.3">𝑚</ci><ci id="S4.SS3.p2.8.m4.1.1.1.1.1.2.4.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.2.4">𝑝</ci></apply><apply id="S4.SS3.p2.8.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3"><times id="S4.SS3.p2.8.m4.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.1"></times><ci id="S4.SS3.p2.8.m4.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.2">𝑐</ci><ci id="S4.SS3.p2.8.m4.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.3">𝑎</ci><ci id="S4.SS3.p2.8.m4.1.1.1.1.1.3.4.cmml" xref="S4.SS3.p2.8.m4.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m4.1c">p(imp|can)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m4.1d">italic_p ( italic_i italic_m italic_p | italic_c italic_a italic_n )</annotation></semantics></math>; <math alttext="{\bm{{\rm y}}}_{c}" class="ltx_Math" display="inline" id="S4.SS3.p2.9.m5.1"><semantics id="S4.SS3.p2.9.m5.1a"><msub id="S4.SS3.p2.9.m5.1.1" xref="S4.SS3.p2.9.m5.1.1.cmml"><mi id="S4.SS3.p2.9.m5.1.1.2" xref="S4.SS3.p2.9.m5.1.1.2.cmml">𝐲</mi><mi id="S4.SS3.p2.9.m5.1.1.3" xref="S4.SS3.p2.9.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m5.1b"><apply id="S4.SS3.p2.9.m5.1.1.cmml" xref="S4.SS3.p2.9.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m5.1.1.1.cmml" xref="S4.SS3.p2.9.m5.1.1">subscript</csymbol><ci id="S4.SS3.p2.9.m5.1.1.2.cmml" xref="S4.SS3.p2.9.m5.1.1.2">𝐲</ci><ci id="S4.SS3.p2.9.m5.1.1.3.cmml" xref="S4.SS3.p2.9.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m5.1c">{\bm{{\rm y}}}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.9.m5.1d">bold_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is to predict <math alttext="p(cli|imp)" class="ltx_Math" display="inline" id="S4.SS3.p2.10.m6.1"><semantics id="S4.SS3.p2.10.m6.1a"><mrow id="S4.SS3.p2.10.m6.1.1" xref="S4.SS3.p2.10.m6.1.1.cmml"><mi id="S4.SS3.p2.10.m6.1.1.3" xref="S4.SS3.p2.10.m6.1.1.3.cmml">p</mi><mo id="S4.SS3.p2.10.m6.1.1.2" xref="S4.SS3.p2.10.m6.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p2.10.m6.1.1.1.1" xref="S4.SS3.p2.10.m6.1.1.1.1.1.cmml"><mo id="S4.SS3.p2.10.m6.1.1.1.1.2" stretchy="false" xref="S4.SS3.p2.10.m6.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.10.m6.1.1.1.1.1" xref="S4.SS3.p2.10.m6.1.1.1.1.1.cmml"><mrow id="S4.SS3.p2.10.m6.1.1.1.1.1.2" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p2.10.m6.1.1.1.1.1.2.2" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.2.cmml">c</mi><mo id="S4.SS3.p2.10.m6.1.1.1.1.1.2.1" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p2.10.m6.1.1.1.1.1.2.3" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.3.cmml">l</mi><mo id="S4.SS3.p2.10.m6.1.1.1.1.1.2.1a" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p2.10.m6.1.1.1.1.1.2.4" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.4.cmml">i</mi></mrow><mo fence="false" id="S4.SS3.p2.10.m6.1.1.1.1.1.1" xref="S4.SS3.p2.10.m6.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p2.10.m6.1.1.1.1.1.3" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p2.10.m6.1.1.1.1.1.3.2" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p2.10.m6.1.1.1.1.1.3.1" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.10.m6.1.1.1.1.1.3.3" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.3.cmml">m</mi><mo id="S4.SS3.p2.10.m6.1.1.1.1.1.3.1a" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.10.m6.1.1.1.1.1.3.4" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.4.cmml">p</mi></mrow></mrow><mo id="S4.SS3.p2.10.m6.1.1.1.1.3" stretchy="false" xref="S4.SS3.p2.10.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m6.1b"><apply id="S4.SS3.p2.10.m6.1.1.cmml" xref="S4.SS3.p2.10.m6.1.1"><times id="S4.SS3.p2.10.m6.1.1.2.cmml" xref="S4.SS3.p2.10.m6.1.1.2"></times><ci id="S4.SS3.p2.10.m6.1.1.3.cmml" xref="S4.SS3.p2.10.m6.1.1.3">𝑝</ci><apply id="S4.SS3.p2.10.m6.1.1.1.1.1.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p2.10.m6.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS3.p2.10.m6.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2"><times id="S4.SS3.p2.10.m6.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.1"></times><ci id="S4.SS3.p2.10.m6.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.2">𝑐</ci><ci id="S4.SS3.p2.10.m6.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.3">𝑙</ci><ci id="S4.SS3.p2.10.m6.1.1.1.1.1.2.4.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.2.4">𝑖</ci></apply><apply id="S4.SS3.p2.10.m6.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3"><times id="S4.SS3.p2.10.m6.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.1"></times><ci id="S4.SS3.p2.10.m6.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.SS3.p2.10.m6.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.3">𝑚</ci><ci id="S4.SS3.p2.10.m6.1.1.1.1.1.3.4.cmml" xref="S4.SS3.p2.10.m6.1.1.1.1.1.3.4">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m6.1c">p(cli|imp)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.10.m6.1d">italic_p ( italic_c italic_l italic_i | italic_i italic_m italic_p )</annotation></semantics></math>; <math alttext="{\bm{{\rm y}}}_{i}\odot{\bm{{\rm y}}}_{c}" class="ltx_Math" display="inline" id="S4.SS3.p2.11.m7.1"><semantics id="S4.SS3.p2.11.m7.1a"><mrow id="S4.SS3.p2.11.m7.1.1" xref="S4.SS3.p2.11.m7.1.1.cmml"><msub id="S4.SS3.p2.11.m7.1.1.2" xref="S4.SS3.p2.11.m7.1.1.2.cmml"><mi id="S4.SS3.p2.11.m7.1.1.2.2" xref="S4.SS3.p2.11.m7.1.1.2.2.cmml">𝐲</mi><mi id="S4.SS3.p2.11.m7.1.1.2.3" xref="S4.SS3.p2.11.m7.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p2.11.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.11.m7.1.1.1.cmml">⊙</mo><msub id="S4.SS3.p2.11.m7.1.1.3" xref="S4.SS3.p2.11.m7.1.1.3.cmml"><mi id="S4.SS3.p2.11.m7.1.1.3.2" xref="S4.SS3.p2.11.m7.1.1.3.2.cmml">𝐲</mi><mi id="S4.SS3.p2.11.m7.1.1.3.3" xref="S4.SS3.p2.11.m7.1.1.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m7.1b"><apply id="S4.SS3.p2.11.m7.1.1.cmml" xref="S4.SS3.p2.11.m7.1.1"><csymbol cd="latexml" id="S4.SS3.p2.11.m7.1.1.1.cmml" xref="S4.SS3.p2.11.m7.1.1.1">direct-product</csymbol><apply id="S4.SS3.p2.11.m7.1.1.2.cmml" xref="S4.SS3.p2.11.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.11.m7.1.1.2.1.cmml" xref="S4.SS3.p2.11.m7.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.11.m7.1.1.2.2.cmml" xref="S4.SS3.p2.11.m7.1.1.2.2">𝐲</ci><ci id="S4.SS3.p2.11.m7.1.1.2.3.cmml" xref="S4.SS3.p2.11.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p2.11.m7.1.1.3.cmml" xref="S4.SS3.p2.11.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.11.m7.1.1.3.1.cmml" xref="S4.SS3.p2.11.m7.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.11.m7.1.1.3.2.cmml" xref="S4.SS3.p2.11.m7.1.1.3.2">𝐲</ci><ci id="S4.SS3.p2.11.m7.1.1.3.3.cmml" xref="S4.SS3.p2.11.m7.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m7.1c">{\bm{{\rm y}}}_{i}\odot{\bm{{\rm y}}}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.11.m7.1d">bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊙ bold_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is to predict <math alttext="p(cli|can)" class="ltx_Math" display="inline" id="S4.SS3.p2.12.m8.1"><semantics id="S4.SS3.p2.12.m8.1a"><mrow id="S4.SS3.p2.12.m8.1.1" xref="S4.SS3.p2.12.m8.1.1.cmml"><mi id="S4.SS3.p2.12.m8.1.1.3" xref="S4.SS3.p2.12.m8.1.1.3.cmml">p</mi><mo id="S4.SS3.p2.12.m8.1.1.2" xref="S4.SS3.p2.12.m8.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p2.12.m8.1.1.1.1" xref="S4.SS3.p2.12.m8.1.1.1.1.1.cmml"><mo id="S4.SS3.p2.12.m8.1.1.1.1.2" stretchy="false" xref="S4.SS3.p2.12.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.12.m8.1.1.1.1.1" xref="S4.SS3.p2.12.m8.1.1.1.1.1.cmml"><mrow id="S4.SS3.p2.12.m8.1.1.1.1.1.2" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p2.12.m8.1.1.1.1.1.2.2" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.2.cmml">c</mi><mo id="S4.SS3.p2.12.m8.1.1.1.1.1.2.1" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p2.12.m8.1.1.1.1.1.2.3" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.3.cmml">l</mi><mo id="S4.SS3.p2.12.m8.1.1.1.1.1.2.1a" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p2.12.m8.1.1.1.1.1.2.4" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.4.cmml">i</mi></mrow><mo fence="false" id="S4.SS3.p2.12.m8.1.1.1.1.1.1" xref="S4.SS3.p2.12.m8.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p2.12.m8.1.1.1.1.1.3" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p2.12.m8.1.1.1.1.1.3.2" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p2.12.m8.1.1.1.1.1.3.1" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.12.m8.1.1.1.1.1.3.3" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p2.12.m8.1.1.1.1.1.3.1a" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.12.m8.1.1.1.1.1.3.4" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.4.cmml">n</mi></mrow></mrow><mo id="S4.SS3.p2.12.m8.1.1.1.1.3" stretchy="false" xref="S4.SS3.p2.12.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m8.1b"><apply id="S4.SS3.p2.12.m8.1.1.cmml" xref="S4.SS3.p2.12.m8.1.1"><times id="S4.SS3.p2.12.m8.1.1.2.cmml" xref="S4.SS3.p2.12.m8.1.1.2"></times><ci id="S4.SS3.p2.12.m8.1.1.3.cmml" xref="S4.SS3.p2.12.m8.1.1.3">𝑝</ci><apply id="S4.SS3.p2.12.m8.1.1.1.1.1.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p2.12.m8.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS3.p2.12.m8.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2"><times id="S4.SS3.p2.12.m8.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.1"></times><ci id="S4.SS3.p2.12.m8.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.2">𝑐</ci><ci id="S4.SS3.p2.12.m8.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.3">𝑙</ci><ci id="S4.SS3.p2.12.m8.1.1.1.1.1.2.4.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.2.4">𝑖</ci></apply><apply id="S4.SS3.p2.12.m8.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3"><times id="S4.SS3.p2.12.m8.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.1"></times><ci id="S4.SS3.p2.12.m8.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.2">𝑐</ci><ci id="S4.SS3.p2.12.m8.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.3">𝑎</ci><ci id="S4.SS3.p2.12.m8.1.1.1.1.1.3.4.cmml" xref="S4.SS3.p2.12.m8.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m8.1c">p(cli|can)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.12.m8.1d">italic_p ( italic_c italic_l italic_i | italic_c italic_a italic_n )</annotation></semantics></math>. When inference, we use <math alttext="pITCTR" class="ltx_Math" display="inline" id="S4.SS3.p2.13.m9.1"><semantics id="S4.SS3.p2.13.m9.1a"><mrow id="S4.SS3.p2.13.m9.1.1" xref="S4.SS3.p2.13.m9.1.1.cmml"><mi id="S4.SS3.p2.13.m9.1.1.2" xref="S4.SS3.p2.13.m9.1.1.2.cmml">p</mi><mo id="S4.SS3.p2.13.m9.1.1.1" xref="S4.SS3.p2.13.m9.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.13.m9.1.1.3" xref="S4.SS3.p2.13.m9.1.1.3.cmml">I</mi><mo id="S4.SS3.p2.13.m9.1.1.1a" xref="S4.SS3.p2.13.m9.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.13.m9.1.1.4" xref="S4.SS3.p2.13.m9.1.1.4.cmml">T</mi><mo id="S4.SS3.p2.13.m9.1.1.1b" xref="S4.SS3.p2.13.m9.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.13.m9.1.1.5" xref="S4.SS3.p2.13.m9.1.1.5.cmml">C</mi><mo id="S4.SS3.p2.13.m9.1.1.1c" xref="S4.SS3.p2.13.m9.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.13.m9.1.1.6" xref="S4.SS3.p2.13.m9.1.1.6.cmml">T</mi><mo id="S4.SS3.p2.13.m9.1.1.1d" xref="S4.SS3.p2.13.m9.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.13.m9.1.1.7" xref="S4.SS3.p2.13.m9.1.1.7.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m9.1b"><apply id="S4.SS3.p2.13.m9.1.1.cmml" xref="S4.SS3.p2.13.m9.1.1"><times id="S4.SS3.p2.13.m9.1.1.1.cmml" xref="S4.SS3.p2.13.m9.1.1.1"></times><ci id="S4.SS3.p2.13.m9.1.1.2.cmml" xref="S4.SS3.p2.13.m9.1.1.2">𝑝</ci><ci id="S4.SS3.p2.13.m9.1.1.3.cmml" xref="S4.SS3.p2.13.m9.1.1.3">𝐼</ci><ci id="S4.SS3.p2.13.m9.1.1.4.cmml" xref="S4.SS3.p2.13.m9.1.1.4">𝑇</ci><ci id="S4.SS3.p2.13.m9.1.1.5.cmml" xref="S4.SS3.p2.13.m9.1.1.5">𝐶</ci><ci id="S4.SS3.p2.13.m9.1.1.6.cmml" xref="S4.SS3.p2.13.m9.1.1.6">𝑇</ci><ci id="S4.SS3.p2.13.m9.1.1.7.cmml" xref="S4.SS3.p2.13.m9.1.1.7">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m9.1c">pITCTR</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.13.m9.1d">italic_p italic_I italic_T italic_C italic_T italic_R</annotation></semantics></math> to order all candidate items.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Fast Attention</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Fast attention in Equations (<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.E2" title="In 4.2. Model Structure ‣ 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.E3" title="In 4.2. Model Structure ‣ 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">3</span></a>) is the key component of our IFA to achieve interaction fidelity attention. There are many choices for fast transformer <cite class="ltx_cite ltx_citemacro_citep">(Kitaev et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib14" title="">2020</a>; Beltagy et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib2" title="">2020</a>; Zaheer et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib38" title="">2020</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib29" title="">2020</a>; Lee et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib16" title="">2019</a>; Nguyen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib21" title="">2021</a>; Vyas et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib28" title="">2020</a>; Katharopoulos et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib13" title="">2020</a>)</cite>. In summary, there are three methods to reduce the time complexity of transformer: sampling <cite class="ltx_cite ltx_citemacro_citep">(Kitaev et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib14" title="">2020</a>; Beltagy et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib2" title="">2020</a>; Zaheer et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib38" title="">2020</a>)</cite>, clustering <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib29" title="">2020</a>; Lee et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib16" title="">2019</a>; Nguyen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib21" title="">2021</a>; Vyas et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib28" title="">2020</a>)</cite> and associative property <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib13" title="">2020</a>)</cite>. In this subsection, we discuss the effectiveness of these three methods and give our choice.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.3"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.3.1">Sampling.</span>
Cross attention is to construct <math alttext="mn" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">m</mi><mo id="S4.SS4.p2.1.m1.1.1.1" xref="S4.SS4.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><times id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1"></times><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝑚</ci><ci id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">mn</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_m italic_n</annotation></semantics></math> interactions between query (candidate set with <math alttext="m" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_m</annotation></semantics></math> items) and key (behaviour sequence with <math alttext="n" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.1"><semantics id="S4.SS4.p2.3.m3.1a"><mi id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><ci id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.1d">italic_n</annotation></semantics></math> items), which is computationally expensive, thus an intuitive way is to sample a small part of these interactions. For example, Reformer finds similar key embeddings for each query embedding, and only builds interactions between them <cite class="ltx_cite ltx_citemacro_citep">(Kitaev et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib14" title="">2020</a>)</cite>. Sampling methods are sub-optimal for us since our IFA degenerates into SIM.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p3.1.1">Clustering.</span>
Another way for simplification is to construct coarse-grained interactions by clustering center. One thing need to be pointed out is that besides the methods which cluster embeddings implicitly by clustering algorithm <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib21" title="">2021</a>; Vyas et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib28" title="">2020</a>)</cite>, we also regard Set Transformer <cite class="ltx_cite ltx_citemacro_citep">(Lee et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib16" title="">2019</a>)</cite> and Linformer <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib29" title="">2020</a>)</cite> as clustering methods since they also achieve clustering by attention and matrix multiplication. Clustering methods are also sub-optimal since IFA degenerates into MIND <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib17" title="">2019</a>)</cite> or ComiRec <cite class="ltx_cite ltx_citemacro_citep">(Cen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib3" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p4.1.1">Associative Property.</span>
Sampling and clustering methods all damage the interaction information fidelity (coverage and accuracy) to reduce the time consumption. To increase interaction information fidelity, we try Linear Transformer <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib13" title="">2020</a>)</cite>, which removes the softmax function and utilizes associative property to reduce the complexity (please see Section <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S3" title="3. Preliminary ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">3</span></a> for details). There is no interaction information loss: each query embedding interacts with each key embedding directly and accurately, and all interactions are reserved. We take Linear Transformer as the fast attention in IFA.</p>
</div>
<div class="ltx_para" id="S4.SS4.p5">
<p class="ltx_p" id="S4.SS4.p5.12">However, softmax is used for normalization. Removing it directly makes aggregation explodes and training unstable. Experiments show that IFA does not converge. To address this issue, we design normalization mechanism without locking the multiplication order. Inspired by Graph Convolutional Network (GCN) <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib32" title="">2021</a>)</cite>, we use the degree matrix for normalization and rewrite Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S3.E1" title="In 3. Preliminary ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">1</span></a>):</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx4">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\bm{{\rm E}}}={\bm{{\rm D}}}^{-1}\phi({\bm{{\rm Q}}})\left(\phi(%
{\bm{{\rm K}}})^{\mathsf{T}}{\bm{{\rm V}}}\right)," class="ltx_Math" display="inline" id="S4.E6.m1.3"><semantics id="S4.E6.m1.3a"><mrow id="S4.E6.m1.3.3.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.3" xref="S4.E6.m1.3.3.1.1.3.cmml">𝐄</mi><mo id="S4.E6.m1.3.3.1.1.2" xref="S4.E6.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml"><msup id="S4.E6.m1.3.3.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.3.cmml"><mi id="S4.E6.m1.3.3.1.1.1.3.2" xref="S4.E6.m1.3.3.1.1.1.3.2.cmml">𝐃</mi><mrow id="S4.E6.m1.3.3.1.1.1.3.3" xref="S4.E6.m1.3.3.1.1.1.3.3.cmml"><mo id="S4.E6.m1.3.3.1.1.1.3.3a" xref="S4.E6.m1.3.3.1.1.1.3.3.cmml">−</mo><mn id="S4.E6.m1.3.3.1.1.1.3.3.2" xref="S4.E6.m1.3.3.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo id="S4.E6.m1.3.3.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S4.E6.m1.3.3.1.1.1.4" xref="S4.E6.m1.3.3.1.1.1.4.cmml">ϕ</mi><mo id="S4.E6.m1.3.3.1.1.1.2a" xref="S4.E6.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.1.1.1.5.2" xref="S4.E6.m1.3.3.1.1.1.cmml"><mo id="S4.E6.m1.3.3.1.1.1.5.2.1" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.cmml">(</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">𝐐</mi><mo id="S4.E6.m1.3.3.1.1.1.5.2.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.cmml">)</mo></mrow><mo id="S4.E6.m1.3.3.1.1.1.2b" xref="S4.E6.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E6.m1.3.3.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml"><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml"><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.3.2.2.1" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">𝐊</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.3.2.2.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml">)</mo></mrow><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.cmml">𝖳</mi></msup><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1a" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.4" xref="S4.E6.m1.3.3.1.1.1.1.1.1.4.cmml">𝐕</mi></mrow><mo id="S4.E6.m1.3.3.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.3.3.1.2" xref="S4.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.3b"><apply id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1"><eq id="S4.E6.m1.3.3.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2"></eq><ci id="S4.E6.m1.3.3.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3">𝐄</ci><apply id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1"><times id="S4.E6.m1.3.3.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.2"></times><apply id="S4.E6.m1.3.3.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.1.3.2">𝐃</ci><apply id="S4.E6.m1.3.3.1.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.1.3.3"><minus id="S4.E6.m1.3.3.1.1.1.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.3.3"></minus><cn id="S4.E6.m1.3.3.1.1.1.3.3.2.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.1.3.3.2">1</cn></apply></apply><ci id="S4.E6.m1.3.3.1.1.1.4.cmml" xref="S4.E6.m1.3.3.1.1.1.4">italic-ϕ</ci><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝐐</ci><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1"><times id="S4.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2">italic-ϕ</ci><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝐊</ci><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.3">𝖳</ci></apply><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.4">𝐕</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.3c">\displaystyle{\bm{{\rm E}}}={\bm{{\rm D}}}^{-1}\phi({\bm{{\rm Q}}})\left(\phi(%
{\bm{{\rm K}}})^{\mathsf{T}}{\bm{{\rm V}}}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.3d">bold_E = bold_D start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT italic_ϕ ( bold_Q ) ( italic_ϕ ( bold_K ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT bold_V ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p5.6">where <math alttext="{\bm{{\rm D}}}" class="ltx_Math" display="inline" id="S4.SS4.p5.1.m1.1"><semantics id="S4.SS4.p5.1.m1.1a"><mi id="S4.SS4.p5.1.m1.1.1" xref="S4.SS4.p5.1.m1.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.1.m1.1b"><ci id="S4.SS4.p5.1.m1.1.1.cmml" xref="S4.SS4.p5.1.m1.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.1.m1.1c">{\bm{{\rm D}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.1.m1.1d">bold_D</annotation></semantics></math> is a diagonal degree matrix, and the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS4.p5.2.m2.1"><semantics id="S4.SS4.p5.2.m2.1a"><mi id="S4.SS4.p5.2.m2.1.1" xref="S4.SS4.p5.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.2.m2.1b"><ci id="S4.SS4.p5.2.m2.1.1.cmml" xref="S4.SS4.p5.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.2.m2.1d">italic_i</annotation></semantics></math>-th diagonal element is sum of the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS4.p5.3.m3.1"><semantics id="S4.SS4.p5.3.m3.1a"><mi id="S4.SS4.p5.3.m3.1.1" xref="S4.SS4.p5.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.3.m3.1b"><ci id="S4.SS4.p5.3.m3.1.1.cmml" xref="S4.SS4.p5.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.3.m3.1d">italic_i</annotation></semantics></math>-th row of the matrix <math alttext="\phi({\bm{{\rm Q}}})\phi({\bm{{\rm K}}})^{\mathsf{T}}" class="ltx_Math" display="inline" id="S4.SS4.p5.4.m4.2"><semantics id="S4.SS4.p5.4.m4.2a"><mrow id="S4.SS4.p5.4.m4.2.3" xref="S4.SS4.p5.4.m4.2.3.cmml"><mi id="S4.SS4.p5.4.m4.2.3.2" xref="S4.SS4.p5.4.m4.2.3.2.cmml">ϕ</mi><mo id="S4.SS4.p5.4.m4.2.3.1" xref="S4.SS4.p5.4.m4.2.3.1.cmml">⁢</mo><mrow id="S4.SS4.p5.4.m4.2.3.3.2" xref="S4.SS4.p5.4.m4.2.3.cmml"><mo id="S4.SS4.p5.4.m4.2.3.3.2.1" stretchy="false" xref="S4.SS4.p5.4.m4.2.3.cmml">(</mo><mi id="S4.SS4.p5.4.m4.1.1" xref="S4.SS4.p5.4.m4.1.1.cmml">𝐐</mi><mo id="S4.SS4.p5.4.m4.2.3.3.2.2" stretchy="false" xref="S4.SS4.p5.4.m4.2.3.cmml">)</mo></mrow><mo id="S4.SS4.p5.4.m4.2.3.1a" xref="S4.SS4.p5.4.m4.2.3.1.cmml">⁢</mo><mi id="S4.SS4.p5.4.m4.2.3.4" xref="S4.SS4.p5.4.m4.2.3.4.cmml">ϕ</mi><mo id="S4.SS4.p5.4.m4.2.3.1b" xref="S4.SS4.p5.4.m4.2.3.1.cmml">⁢</mo><msup id="S4.SS4.p5.4.m4.2.3.5" xref="S4.SS4.p5.4.m4.2.3.5.cmml"><mrow id="S4.SS4.p5.4.m4.2.3.5.2.2" xref="S4.SS4.p5.4.m4.2.3.5.cmml"><mo id="S4.SS4.p5.4.m4.2.3.5.2.2.1" stretchy="false" xref="S4.SS4.p5.4.m4.2.3.5.cmml">(</mo><mi id="S4.SS4.p5.4.m4.2.2" xref="S4.SS4.p5.4.m4.2.2.cmml">𝐊</mi><mo id="S4.SS4.p5.4.m4.2.3.5.2.2.2" stretchy="false" xref="S4.SS4.p5.4.m4.2.3.5.cmml">)</mo></mrow><mi id="S4.SS4.p5.4.m4.2.3.5.3" xref="S4.SS4.p5.4.m4.2.3.5.3.cmml">𝖳</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.4.m4.2b"><apply id="S4.SS4.p5.4.m4.2.3.cmml" xref="S4.SS4.p5.4.m4.2.3"><times id="S4.SS4.p5.4.m4.2.3.1.cmml" xref="S4.SS4.p5.4.m4.2.3.1"></times><ci id="S4.SS4.p5.4.m4.2.3.2.cmml" xref="S4.SS4.p5.4.m4.2.3.2">italic-ϕ</ci><ci id="S4.SS4.p5.4.m4.1.1.cmml" xref="S4.SS4.p5.4.m4.1.1">𝐐</ci><ci id="S4.SS4.p5.4.m4.2.3.4.cmml" xref="S4.SS4.p5.4.m4.2.3.4">italic-ϕ</ci><apply id="S4.SS4.p5.4.m4.2.3.5.cmml" xref="S4.SS4.p5.4.m4.2.3.5"><csymbol cd="ambiguous" id="S4.SS4.p5.4.m4.2.3.5.1.cmml" xref="S4.SS4.p5.4.m4.2.3.5">superscript</csymbol><ci id="S4.SS4.p5.4.m4.2.2.cmml" xref="S4.SS4.p5.4.m4.2.2">𝐊</ci><ci id="S4.SS4.p5.4.m4.2.3.5.3.cmml" xref="S4.SS4.p5.4.m4.2.3.5.3">𝖳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.4.m4.2c">\phi({\bm{{\rm Q}}})\phi({\bm{{\rm K}}})^{\mathsf{T}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.4.m4.2d">italic_ϕ ( bold_Q ) italic_ϕ ( bold_K ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT</annotation></semantics></math>. Since <math alttext="\phi({\bm{{\rm Q}}})\phi({\bm{{\rm K}}})^{\mathsf{T}}" class="ltx_Math" display="inline" id="S4.SS4.p5.5.m5.2"><semantics id="S4.SS4.p5.5.m5.2a"><mrow id="S4.SS4.p5.5.m5.2.3" xref="S4.SS4.p5.5.m5.2.3.cmml"><mi id="S4.SS4.p5.5.m5.2.3.2" xref="S4.SS4.p5.5.m5.2.3.2.cmml">ϕ</mi><mo id="S4.SS4.p5.5.m5.2.3.1" xref="S4.SS4.p5.5.m5.2.3.1.cmml">⁢</mo><mrow id="S4.SS4.p5.5.m5.2.3.3.2" xref="S4.SS4.p5.5.m5.2.3.cmml"><mo id="S4.SS4.p5.5.m5.2.3.3.2.1" stretchy="false" xref="S4.SS4.p5.5.m5.2.3.cmml">(</mo><mi id="S4.SS4.p5.5.m5.1.1" xref="S4.SS4.p5.5.m5.1.1.cmml">𝐐</mi><mo id="S4.SS4.p5.5.m5.2.3.3.2.2" stretchy="false" xref="S4.SS4.p5.5.m5.2.3.cmml">)</mo></mrow><mo id="S4.SS4.p5.5.m5.2.3.1a" xref="S4.SS4.p5.5.m5.2.3.1.cmml">⁢</mo><mi id="S4.SS4.p5.5.m5.2.3.4" xref="S4.SS4.p5.5.m5.2.3.4.cmml">ϕ</mi><mo id="S4.SS4.p5.5.m5.2.3.1b" xref="S4.SS4.p5.5.m5.2.3.1.cmml">⁢</mo><msup id="S4.SS4.p5.5.m5.2.3.5" xref="S4.SS4.p5.5.m5.2.3.5.cmml"><mrow id="S4.SS4.p5.5.m5.2.3.5.2.2" xref="S4.SS4.p5.5.m5.2.3.5.cmml"><mo id="S4.SS4.p5.5.m5.2.3.5.2.2.1" stretchy="false" xref="S4.SS4.p5.5.m5.2.3.5.cmml">(</mo><mi id="S4.SS4.p5.5.m5.2.2" xref="S4.SS4.p5.5.m5.2.2.cmml">𝐊</mi><mo id="S4.SS4.p5.5.m5.2.3.5.2.2.2" stretchy="false" xref="S4.SS4.p5.5.m5.2.3.5.cmml">)</mo></mrow><mi id="S4.SS4.p5.5.m5.2.3.5.3" xref="S4.SS4.p5.5.m5.2.3.5.3.cmml">𝖳</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.5.m5.2b"><apply id="S4.SS4.p5.5.m5.2.3.cmml" xref="S4.SS4.p5.5.m5.2.3"><times id="S4.SS4.p5.5.m5.2.3.1.cmml" xref="S4.SS4.p5.5.m5.2.3.1"></times><ci id="S4.SS4.p5.5.m5.2.3.2.cmml" xref="S4.SS4.p5.5.m5.2.3.2">italic-ϕ</ci><ci id="S4.SS4.p5.5.m5.1.1.cmml" xref="S4.SS4.p5.5.m5.1.1">𝐐</ci><ci id="S4.SS4.p5.5.m5.2.3.4.cmml" xref="S4.SS4.p5.5.m5.2.3.4">italic-ϕ</ci><apply id="S4.SS4.p5.5.m5.2.3.5.cmml" xref="S4.SS4.p5.5.m5.2.3.5"><csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.2.3.5.1.cmml" xref="S4.SS4.p5.5.m5.2.3.5">superscript</csymbol><ci id="S4.SS4.p5.5.m5.2.2.cmml" xref="S4.SS4.p5.5.m5.2.2">𝐊</ci><ci id="S4.SS4.p5.5.m5.2.3.5.3.cmml" xref="S4.SS4.p5.5.m5.2.3.5.3">𝖳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.5.m5.2c">\phi({\bm{{\rm Q}}})\phi({\bm{{\rm K}}})^{\mathsf{T}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.5.m5.2d">italic_ϕ ( bold_Q ) italic_ϕ ( bold_K ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT</annotation></semantics></math> cannot be calculated explicitly, we give the deduction of <math alttext="{\bm{{\rm D}}}" class="ltx_Math" display="inline" id="S4.SS4.p5.6.m6.1"><semantics id="S4.SS4.p5.6.m6.1a"><mi id="S4.SS4.p5.6.m6.1.1" xref="S4.SS4.p5.6.m6.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.6.m6.1b"><ci id="S4.SS4.p5.6.m6.1.1.cmml" xref="S4.SS4.p5.6.m6.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.6.m6.1c">{\bm{{\rm D}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.6.m6.1d">bold_D</annotation></semantics></math> based on the definition:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx5">
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\bm{{\rm D}}}={\rm diag}\left(\phi({\bm{{\rm Q}}})\left(\phi({%
\bm{{\rm K}}})^{\mathsf{T}}{\bm{{\rm 1}}}\right)\right)," class="ltx_Math" display="inline" id="S4.E7.m1.3"><semantics id="S4.E7.m1.3a"><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.3" xref="S4.E7.m1.3.3.1.1.3.cmml">𝐃</mi><mo id="S4.E7.m1.3.3.1.1.2" xref="S4.E7.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.3.3.1.1.1" xref="S4.E7.m1.3.3.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.3.cmml">diag</mi><mo id="S4.E7.m1.3.3.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.4.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">𝐐</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.2a" xref="S4.E7.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.1" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">𝐊</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.2" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">𝖳</mi></msup><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1a" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mn id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml">𝟏</mn></mrow><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.3b"><apply id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1"><eq id="S4.E7.m1.3.3.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.2"></eq><ci id="S4.E7.m1.3.3.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.3">𝐃</ci><apply id="S4.E7.m1.3.3.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1"><times id="S4.E7.m1.3.3.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.2"></times><ci id="S4.E7.m1.3.3.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.3">diag</ci><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1"><times id="S4.E7.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.2"></times><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.3">italic-ϕ</ci><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝐐</ci><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1"><times id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.2">italic-ϕ</ci><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">𝐊</ci><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">𝖳</ci></apply><cn id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml" type="integer" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.3c">\displaystyle{\bm{{\rm D}}}={\rm diag}\left(\phi({\bm{{\rm Q}}})\left(\phi({%
\bm{{\rm K}}})^{\mathsf{T}}{\bm{{\rm 1}}}\right)\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.3d">bold_D = roman_diag ( italic_ϕ ( bold_Q ) ( italic_ϕ ( bold_K ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT bold_1 ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p5.11">where <math alttext="{\bm{{\rm 1}}}\in\{1\}^{n\times 1}" class="ltx_Math" display="inline" id="S4.SS4.p5.7.m1.1"><semantics id="S4.SS4.p5.7.m1.1a"><mrow id="S4.SS4.p5.7.m1.1.2" xref="S4.SS4.p5.7.m1.1.2.cmml"><mn id="S4.SS4.p5.7.m1.1.2.2" xref="S4.SS4.p5.7.m1.1.2.2.cmml">𝟏</mn><mo id="S4.SS4.p5.7.m1.1.2.1" xref="S4.SS4.p5.7.m1.1.2.1.cmml">∈</mo><msup id="S4.SS4.p5.7.m1.1.2.3" xref="S4.SS4.p5.7.m1.1.2.3.cmml"><mrow id="S4.SS4.p5.7.m1.1.2.3.2.2" xref="S4.SS4.p5.7.m1.1.2.3.2.1.cmml"><mo id="S4.SS4.p5.7.m1.1.2.3.2.2.1" stretchy="false" xref="S4.SS4.p5.7.m1.1.2.3.2.1.cmml">{</mo><mn id="S4.SS4.p5.7.m1.1.1" xref="S4.SS4.p5.7.m1.1.1.cmml">1</mn><mo id="S4.SS4.p5.7.m1.1.2.3.2.2.2" stretchy="false" xref="S4.SS4.p5.7.m1.1.2.3.2.1.cmml">}</mo></mrow><mrow id="S4.SS4.p5.7.m1.1.2.3.3" xref="S4.SS4.p5.7.m1.1.2.3.3.cmml"><mi id="S4.SS4.p5.7.m1.1.2.3.3.2" xref="S4.SS4.p5.7.m1.1.2.3.3.2.cmml">n</mi><mo id="S4.SS4.p5.7.m1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.p5.7.m1.1.2.3.3.1.cmml">×</mo><mn id="S4.SS4.p5.7.m1.1.2.3.3.3" xref="S4.SS4.p5.7.m1.1.2.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.7.m1.1b"><apply id="S4.SS4.p5.7.m1.1.2.cmml" xref="S4.SS4.p5.7.m1.1.2"><in id="S4.SS4.p5.7.m1.1.2.1.cmml" xref="S4.SS4.p5.7.m1.1.2.1"></in><cn id="S4.SS4.p5.7.m1.1.2.2.cmml" type="integer" xref="S4.SS4.p5.7.m1.1.2.2">1</cn><apply id="S4.SS4.p5.7.m1.1.2.3.cmml" xref="S4.SS4.p5.7.m1.1.2.3"><csymbol cd="ambiguous" id="S4.SS4.p5.7.m1.1.2.3.1.cmml" xref="S4.SS4.p5.7.m1.1.2.3">superscript</csymbol><set id="S4.SS4.p5.7.m1.1.2.3.2.1.cmml" xref="S4.SS4.p5.7.m1.1.2.3.2.2"><cn id="S4.SS4.p5.7.m1.1.1.cmml" type="integer" xref="S4.SS4.p5.7.m1.1.1">1</cn></set><apply id="S4.SS4.p5.7.m1.1.2.3.3.cmml" xref="S4.SS4.p5.7.m1.1.2.3.3"><times id="S4.SS4.p5.7.m1.1.2.3.3.1.cmml" xref="S4.SS4.p5.7.m1.1.2.3.3.1"></times><ci id="S4.SS4.p5.7.m1.1.2.3.3.2.cmml" xref="S4.SS4.p5.7.m1.1.2.3.3.2">𝑛</ci><cn id="S4.SS4.p5.7.m1.1.2.3.3.3.cmml" type="integer" xref="S4.SS4.p5.7.m1.1.2.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.7.m1.1c">{\bm{{\rm 1}}}\in\{1\}^{n\times 1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.7.m1.1d">bold_1 ∈ { 1 } start_POSTSUPERSCRIPT italic_n × 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is used to reduce sum <math alttext="\phi({\bm{{\rm K}}})" class="ltx_Math" display="inline" id="S4.SS4.p5.8.m2.1"><semantics id="S4.SS4.p5.8.m2.1a"><mrow id="S4.SS4.p5.8.m2.1.2" xref="S4.SS4.p5.8.m2.1.2.cmml"><mi id="S4.SS4.p5.8.m2.1.2.2" xref="S4.SS4.p5.8.m2.1.2.2.cmml">ϕ</mi><mo id="S4.SS4.p5.8.m2.1.2.1" xref="S4.SS4.p5.8.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS4.p5.8.m2.1.2.3.2" xref="S4.SS4.p5.8.m2.1.2.cmml"><mo id="S4.SS4.p5.8.m2.1.2.3.2.1" stretchy="false" xref="S4.SS4.p5.8.m2.1.2.cmml">(</mo><mi id="S4.SS4.p5.8.m2.1.1" xref="S4.SS4.p5.8.m2.1.1.cmml">𝐊</mi><mo id="S4.SS4.p5.8.m2.1.2.3.2.2" stretchy="false" xref="S4.SS4.p5.8.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.8.m2.1b"><apply id="S4.SS4.p5.8.m2.1.2.cmml" xref="S4.SS4.p5.8.m2.1.2"><times id="S4.SS4.p5.8.m2.1.2.1.cmml" xref="S4.SS4.p5.8.m2.1.2.1"></times><ci id="S4.SS4.p5.8.m2.1.2.2.cmml" xref="S4.SS4.p5.8.m2.1.2.2">italic-ϕ</ci><ci id="S4.SS4.p5.8.m2.1.1.cmml" xref="S4.SS4.p5.8.m2.1.1">𝐊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.8.m2.1c">\phi({\bm{{\rm K}}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.8.m2.1d">italic_ϕ ( bold_K )</annotation></semantics></math> by multiplication <math alttext="\phi({\bm{{\rm K}}})^{\mathsf{T}}{\bm{{\rm 1}}}" class="ltx_Math" display="inline" id="S4.SS4.p5.9.m3.1"><semantics id="S4.SS4.p5.9.m3.1a"><mrow id="S4.SS4.p5.9.m3.1.2" xref="S4.SS4.p5.9.m3.1.2.cmml"><mi id="S4.SS4.p5.9.m3.1.2.2" xref="S4.SS4.p5.9.m3.1.2.2.cmml">ϕ</mi><mo id="S4.SS4.p5.9.m3.1.2.1" xref="S4.SS4.p5.9.m3.1.2.1.cmml">⁢</mo><msup id="S4.SS4.p5.9.m3.1.2.3" xref="S4.SS4.p5.9.m3.1.2.3.cmml"><mrow id="S4.SS4.p5.9.m3.1.2.3.2.2" xref="S4.SS4.p5.9.m3.1.2.3.cmml"><mo id="S4.SS4.p5.9.m3.1.2.3.2.2.1" stretchy="false" xref="S4.SS4.p5.9.m3.1.2.3.cmml">(</mo><mi id="S4.SS4.p5.9.m3.1.1" xref="S4.SS4.p5.9.m3.1.1.cmml">𝐊</mi><mo id="S4.SS4.p5.9.m3.1.2.3.2.2.2" stretchy="false" xref="S4.SS4.p5.9.m3.1.2.3.cmml">)</mo></mrow><mi id="S4.SS4.p5.9.m3.1.2.3.3" xref="S4.SS4.p5.9.m3.1.2.3.3.cmml">𝖳</mi></msup><mo id="S4.SS4.p5.9.m3.1.2.1a" xref="S4.SS4.p5.9.m3.1.2.1.cmml">⁢</mo><mn id="S4.SS4.p5.9.m3.1.2.4" xref="S4.SS4.p5.9.m3.1.2.4.cmml">𝟏</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.9.m3.1b"><apply id="S4.SS4.p5.9.m3.1.2.cmml" xref="S4.SS4.p5.9.m3.1.2"><times id="S4.SS4.p5.9.m3.1.2.1.cmml" xref="S4.SS4.p5.9.m3.1.2.1"></times><ci id="S4.SS4.p5.9.m3.1.2.2.cmml" xref="S4.SS4.p5.9.m3.1.2.2">italic-ϕ</ci><apply id="S4.SS4.p5.9.m3.1.2.3.cmml" xref="S4.SS4.p5.9.m3.1.2.3"><csymbol cd="ambiguous" id="S4.SS4.p5.9.m3.1.2.3.1.cmml" xref="S4.SS4.p5.9.m3.1.2.3">superscript</csymbol><ci id="S4.SS4.p5.9.m3.1.1.cmml" xref="S4.SS4.p5.9.m3.1.1">𝐊</ci><ci id="S4.SS4.p5.9.m3.1.2.3.3.cmml" xref="S4.SS4.p5.9.m3.1.2.3.3">𝖳</ci></apply><cn id="S4.SS4.p5.9.m3.1.2.4.cmml" type="integer" xref="S4.SS4.p5.9.m3.1.2.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.9.m3.1c">\phi({\bm{{\rm K}}})^{\mathsf{T}}{\bm{{\rm 1}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.9.m3.1d">italic_ϕ ( bold_K ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT bold_1</annotation></semantics></math>, and diag( ) is to generate a diagonal matrix. Please note that we need to select <math alttext="\phi(\;)" class="ltx_Math" display="inline" id="S4.SS4.p5.10.m4.1"><semantics id="S4.SS4.p5.10.m4.1a"><mrow id="S4.SS4.p5.10.m4.1.1" xref="S4.SS4.p5.10.m4.1.1.cmml"><mi id="S4.SS4.p5.10.m4.1.1.2" xref="S4.SS4.p5.10.m4.1.1.2.cmml">ϕ</mi><mo id="S4.SS4.p5.10.m4.1.1.1" xref="S4.SS4.p5.10.m4.1.1.1.cmml">⁢</mo><mrow id="S4.SS4.p5.10.m4.1.1.3.2" xref="S4.SS4.p5.10.m4.1.1.cmml"><mo id="S4.SS4.p5.10.m4.1.1.3.2.1" rspace="0.280em" stretchy="false" xref="S4.SS4.p5.10.m4.1.1.3.1.cmml">(</mo><mo id="S4.SS4.p5.10.m4.1.1.3.2.2" stretchy="false" xref="S4.SS4.p5.10.m4.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.10.m4.1b"><apply id="S4.SS4.p5.10.m4.1.1.cmml" xref="S4.SS4.p5.10.m4.1.1"><times id="S4.SS4.p5.10.m4.1.1.1.cmml" xref="S4.SS4.p5.10.m4.1.1.1"></times><ci id="S4.SS4.p5.10.m4.1.1.2.cmml" xref="S4.SS4.p5.10.m4.1.1.2">italic-ϕ</ci><list id="S4.SS4.p5.10.m4.1.1.3.1.cmml" xref="S4.SS4.p5.10.m4.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.10.m4.1c">\phi(\;)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.10.m4.1d">italic_ϕ ( )</annotation></semantics></math> to make sure that each element of <math alttext="{\bm{{\rm D}}}" class="ltx_Math" display="inline" id="S4.SS4.p5.11.m5.1"><semantics id="S4.SS4.p5.11.m5.1a"><mi id="S4.SS4.p5.11.m5.1.1" xref="S4.SS4.p5.11.m5.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.11.m5.1b"><ci id="S4.SS4.p5.11.m5.1.1.cmml" xref="S4.SS4.p5.11.m5.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.11.m5.1c">{\bm{{\rm D}}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.11.m5.1d">bold_D</annotation></semantics></math> is non negative, such as softplus or ReLU.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Time Complexity</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.4">IFA and SIM are both simplification of DIN. We give the time complexity of processing one target item to demonstrate the efficiency of our proposed method. For DIN, the time consumption of attention with one target item as query and <math alttext="n" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">italic_n</annotation></semantics></math>-length sequence as key and value is <math alttext="O(n)" class="ltx_Math" display="inline" id="S4.SS5.p1.2.m2.1"><semantics id="S4.SS5.p1.2.m2.1a"><mrow id="S4.SS5.p1.2.m2.1.2" xref="S4.SS5.p1.2.m2.1.2.cmml"><mi id="S4.SS5.p1.2.m2.1.2.2" xref="S4.SS5.p1.2.m2.1.2.2.cmml">O</mi><mo id="S4.SS5.p1.2.m2.1.2.1" xref="S4.SS5.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS5.p1.2.m2.1.2.3.2" xref="S4.SS5.p1.2.m2.1.2.cmml"><mo id="S4.SS5.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS5.p1.2.m2.1.2.cmml">(</mo><mi id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">n</mi><mo id="S4.SS5.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS5.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><apply id="S4.SS5.p1.2.m2.1.2.cmml" xref="S4.SS5.p1.2.m2.1.2"><times id="S4.SS5.p1.2.m2.1.2.1.cmml" xref="S4.SS5.p1.2.m2.1.2.1"></times><ci id="S4.SS5.p1.2.m2.1.2.2.cmml" xref="S4.SS5.p1.2.m2.1.2.2">𝑂</ci><ci id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">O(n)</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.2.m2.1d">italic_O ( italic_n )</annotation></semantics></math>. For SIM, the time consumption is <math alttext="O(k)" class="ltx_Math" display="inline" id="S4.SS5.p1.3.m3.1"><semantics id="S4.SS5.p1.3.m3.1a"><mrow id="S4.SS5.p1.3.m3.1.2" xref="S4.SS5.p1.3.m3.1.2.cmml"><mi id="S4.SS5.p1.3.m3.1.2.2" xref="S4.SS5.p1.3.m3.1.2.2.cmml">O</mi><mo id="S4.SS5.p1.3.m3.1.2.1" xref="S4.SS5.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS5.p1.3.m3.1.2.3.2" xref="S4.SS5.p1.3.m3.1.2.cmml"><mo id="S4.SS5.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S4.SS5.p1.3.m3.1.2.cmml">(</mo><mi id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml">k</mi><mo id="S4.SS5.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S4.SS5.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><apply id="S4.SS5.p1.3.m3.1.2.cmml" xref="S4.SS5.p1.3.m3.1.2"><times id="S4.SS5.p1.3.m3.1.2.1.cmml" xref="S4.SS5.p1.3.m3.1.2.1"></times><ci id="S4.SS5.p1.3.m3.1.2.2.cmml" xref="S4.SS5.p1.3.m3.1.2.2">𝑂</ci><ci id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">O(k)</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.3.m3.1d">italic_O ( italic_k )</annotation></semantics></math>, where <math alttext="k\sim\log n" class="ltx_Math" display="inline" id="S4.SS5.p1.4.m4.1"><semantics id="S4.SS5.p1.4.m4.1a"><mrow id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml"><mi id="S4.SS5.p1.4.m4.1.1.2" xref="S4.SS5.p1.4.m4.1.1.2.cmml">k</mi><mo id="S4.SS5.p1.4.m4.1.1.1" xref="S4.SS5.p1.4.m4.1.1.1.cmml">∼</mo><mrow id="S4.SS5.p1.4.m4.1.1.3" xref="S4.SS5.p1.4.m4.1.1.3.cmml"><mi id="S4.SS5.p1.4.m4.1.1.3.1" xref="S4.SS5.p1.4.m4.1.1.3.1.cmml">log</mi><mo id="S4.SS5.p1.4.m4.1.1.3a" lspace="0.167em" xref="S4.SS5.p1.4.m4.1.1.3.cmml">⁡</mo><mi id="S4.SS5.p1.4.m4.1.1.3.2" xref="S4.SS5.p1.4.m4.1.1.3.2.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.1b"><apply id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS5.p1.4.m4.1.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1.1">similar-to</csymbol><ci id="S4.SS5.p1.4.m4.1.1.2.cmml" xref="S4.SS5.p1.4.m4.1.1.2">𝑘</ci><apply id="S4.SS5.p1.4.m4.1.1.3.cmml" xref="S4.SS5.p1.4.m4.1.1.3"><log id="S4.SS5.p1.4.m4.1.1.3.1.cmml" xref="S4.SS5.p1.4.m4.1.1.3.1"></log><ci id="S4.SS5.p1.4.m4.1.1.3.2.cmml" xref="S4.SS5.p1.4.m4.1.1.3.2">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.1c">k\sim\log n</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.4.m4.1d">italic_k ∼ roman_log italic_n</annotation></semantics></math> is the length of the sub-sequence.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.6">For IFA, if we use standard attention, the time complexity of processing <math alttext="m" class="ltx_Math" display="inline" id="S4.SS5.p2.1.m1.1"><semantics id="S4.SS5.p2.1.m1.1a"><mi id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><ci id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.1.m1.1d">italic_m</annotation></semantics></math> target items are <math alttext="O(mn)" class="ltx_Math" display="inline" id="S4.SS5.p2.2.m2.1"><semantics id="S4.SS5.p2.2.m2.1a"><mrow id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml"><mi id="S4.SS5.p2.2.m2.1.1.3" xref="S4.SS5.p2.2.m2.1.1.3.cmml">O</mi><mo id="S4.SS5.p2.2.m2.1.1.2" xref="S4.SS5.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS5.p2.2.m2.1.1.1.1" xref="S4.SS5.p2.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS5.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS5.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS5.p2.2.m2.1.1.1.1.1" xref="S4.SS5.p2.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS5.p2.2.m2.1.1.1.1.1.2" xref="S4.SS5.p2.2.m2.1.1.1.1.1.2.cmml">m</mi><mo id="S4.SS5.p2.2.m2.1.1.1.1.1.1" xref="S4.SS5.p2.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS5.p2.2.m2.1.1.1.1.1.3" xref="S4.SS5.p2.2.m2.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S4.SS5.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS5.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><apply id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1"><times id="S4.SS5.p2.2.m2.1.1.2.cmml" xref="S4.SS5.p2.2.m2.1.1.2"></times><ci id="S4.SS5.p2.2.m2.1.1.3.cmml" xref="S4.SS5.p2.2.m2.1.1.3">𝑂</ci><apply id="S4.SS5.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1.1.1"><times id="S4.SS5.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1.1.1.1.1"></times><ci id="S4.SS5.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS5.p2.2.m2.1.1.1.1.1.2">𝑚</ci><ci id="S4.SS5.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS5.p2.2.m2.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">O(mn)</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.2.m2.1d">italic_O ( italic_m italic_n )</annotation></semantics></math>, and we reduce the time complexity to <math alttext="O(m+n)" class="ltx_Math" display="inline" id="S4.SS5.p2.3.m3.1"><semantics id="S4.SS5.p2.3.m3.1a"><mrow id="S4.SS5.p2.3.m3.1.1" xref="S4.SS5.p2.3.m3.1.1.cmml"><mi id="S4.SS5.p2.3.m3.1.1.3" xref="S4.SS5.p2.3.m3.1.1.3.cmml">O</mi><mo id="S4.SS5.p2.3.m3.1.1.2" xref="S4.SS5.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S4.SS5.p2.3.m3.1.1.1.1" xref="S4.SS5.p2.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS5.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS5.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS5.p2.3.m3.1.1.1.1.1" xref="S4.SS5.p2.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS5.p2.3.m3.1.1.1.1.1.2" xref="S4.SS5.p2.3.m3.1.1.1.1.1.2.cmml">m</mi><mo id="S4.SS5.p2.3.m3.1.1.1.1.1.1" xref="S4.SS5.p2.3.m3.1.1.1.1.1.1.cmml">+</mo><mi id="S4.SS5.p2.3.m3.1.1.1.1.1.3" xref="S4.SS5.p2.3.m3.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S4.SS5.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS5.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.3.m3.1b"><apply id="S4.SS5.p2.3.m3.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1"><times id="S4.SS5.p2.3.m3.1.1.2.cmml" xref="S4.SS5.p2.3.m3.1.1.2"></times><ci id="S4.SS5.p2.3.m3.1.1.3.cmml" xref="S4.SS5.p2.3.m3.1.1.3">𝑂</ci><apply id="S4.SS5.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1.1.1"><plus id="S4.SS5.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1.1.1.1.1"></plus><ci id="S4.SS5.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS5.p2.3.m3.1.1.1.1.1.2">𝑚</ci><ci id="S4.SS5.p2.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS5.p2.3.m3.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.3.m3.1c">O(m+n)</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.3.m3.1d">italic_O ( italic_m + italic_n )</annotation></semantics></math> by linear transformer. In this case, processing one target item costs <math alttext="O(1+n/m)" class="ltx_Math" display="inline" id="S4.SS5.p2.4.m4.1"><semantics id="S4.SS5.p2.4.m4.1a"><mrow id="S4.SS5.p2.4.m4.1.1" xref="S4.SS5.p2.4.m4.1.1.cmml"><mi id="S4.SS5.p2.4.m4.1.1.3" xref="S4.SS5.p2.4.m4.1.1.3.cmml">O</mi><mo id="S4.SS5.p2.4.m4.1.1.2" xref="S4.SS5.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS5.p2.4.m4.1.1.1.1" xref="S4.SS5.p2.4.m4.1.1.1.1.1.cmml"><mo id="S4.SS5.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S4.SS5.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS5.p2.4.m4.1.1.1.1.1" xref="S4.SS5.p2.4.m4.1.1.1.1.1.cmml"><mn id="S4.SS5.p2.4.m4.1.1.1.1.1.2" xref="S4.SS5.p2.4.m4.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS5.p2.4.m4.1.1.1.1.1.1" xref="S4.SS5.p2.4.m4.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.SS5.p2.4.m4.1.1.1.1.1.3" xref="S4.SS5.p2.4.m4.1.1.1.1.1.3.cmml"><mi id="S4.SS5.p2.4.m4.1.1.1.1.1.3.2" xref="S4.SS5.p2.4.m4.1.1.1.1.1.3.2.cmml">n</mi><mo id="S4.SS5.p2.4.m4.1.1.1.1.1.3.1" xref="S4.SS5.p2.4.m4.1.1.1.1.1.3.1.cmml">/</mo><mi id="S4.SS5.p2.4.m4.1.1.1.1.1.3.3" xref="S4.SS5.p2.4.m4.1.1.1.1.1.3.3.cmml">m</mi></mrow></mrow><mo id="S4.SS5.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S4.SS5.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.4.m4.1b"><apply id="S4.SS5.p2.4.m4.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1"><times id="S4.SS5.p2.4.m4.1.1.2.cmml" xref="S4.SS5.p2.4.m4.1.1.2"></times><ci id="S4.SS5.p2.4.m4.1.1.3.cmml" xref="S4.SS5.p2.4.m4.1.1.3">𝑂</ci><apply id="S4.SS5.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1.1.1"><plus id="S4.SS5.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1.1.1.1.1"></plus><cn id="S4.SS5.p2.4.m4.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS5.p2.4.m4.1.1.1.1.1.2">1</cn><apply id="S4.SS5.p2.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS5.p2.4.m4.1.1.1.1.1.3"><divide id="S4.SS5.p2.4.m4.1.1.1.1.1.3.1.cmml" xref="S4.SS5.p2.4.m4.1.1.1.1.1.3.1"></divide><ci id="S4.SS5.p2.4.m4.1.1.1.1.1.3.2.cmml" xref="S4.SS5.p2.4.m4.1.1.1.1.1.3.2">𝑛</ci><ci id="S4.SS5.p2.4.m4.1.1.1.1.1.3.3.cmml" xref="S4.SS5.p2.4.m4.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.4.m4.1c">O(1+n/m)</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.4.m4.1d">italic_O ( 1 + italic_n / italic_m )</annotation></semantics></math> time. In prerank, <math alttext="m\sim 10" class="ltx_Math" display="inline" id="S4.SS5.p2.5.m5.1"><semantics id="S4.SS5.p2.5.m5.1a"><mrow id="S4.SS5.p2.5.m5.1.1" xref="S4.SS5.p2.5.m5.1.1.cmml"><mi id="S4.SS5.p2.5.m5.1.1.2" xref="S4.SS5.p2.5.m5.1.1.2.cmml">m</mi><mo id="S4.SS5.p2.5.m5.1.1.1" xref="S4.SS5.p2.5.m5.1.1.1.cmml">∼</mo><mn id="S4.SS5.p2.5.m5.1.1.3" xref="S4.SS5.p2.5.m5.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.5.m5.1b"><apply id="S4.SS5.p2.5.m5.1.1.cmml" xref="S4.SS5.p2.5.m5.1.1"><csymbol cd="latexml" id="S4.SS5.p2.5.m5.1.1.1.cmml" xref="S4.SS5.p2.5.m5.1.1.1">similar-to</csymbol><ci id="S4.SS5.p2.5.m5.1.1.2.cmml" xref="S4.SS5.p2.5.m5.1.1.2">𝑚</ci><cn id="S4.SS5.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.SS5.p2.5.m5.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.5.m5.1c">m\sim 10</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.5.m5.1d">italic_m ∼ 10</annotation></semantics></math>k and <math alttext="n\sim 10" class="ltx_Math" display="inline" id="S4.SS5.p2.6.m6.1"><semantics id="S4.SS5.p2.6.m6.1a"><mrow id="S4.SS5.p2.6.m6.1.1" xref="S4.SS5.p2.6.m6.1.1.cmml"><mi id="S4.SS5.p2.6.m6.1.1.2" xref="S4.SS5.p2.6.m6.1.1.2.cmml">n</mi><mo id="S4.SS5.p2.6.m6.1.1.1" xref="S4.SS5.p2.6.m6.1.1.1.cmml">∼</mo><mn id="S4.SS5.p2.6.m6.1.1.3" xref="S4.SS5.p2.6.m6.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.6.m6.1b"><apply id="S4.SS5.p2.6.m6.1.1.cmml" xref="S4.SS5.p2.6.m6.1.1"><csymbol cd="latexml" id="S4.SS5.p2.6.m6.1.1.1.cmml" xref="S4.SS5.p2.6.m6.1.1.1">similar-to</csymbol><ci id="S4.SS5.p2.6.m6.1.1.2.cmml" xref="S4.SS5.p2.6.m6.1.1.2">𝑛</ci><cn id="S4.SS5.p2.6.m6.1.1.3.cmml" type="integer" xref="S4.SS5.p2.6.m6.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.6.m6.1c">n\sim 10</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.6.m6.1d">italic_n ∼ 10</annotation></semantics></math>k, thus the time complexity is a constant.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we conduct experiments to demonstrate the effectiveness of our IFA model by comparing it with several state-of-art (SOTA) models on Kuaishou industry data and by online AB test.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experimental Setup</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">In this section, we introduce experimental setups, including datasets, baselines, and evaluation protocols.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Datasets.</span> Considering that we need samples with both candidate set and long sequence, we adopt Kuaishou online streaming data for experiment since no published dataset meets the requirements. As the quantity of candidate items are much larger than that of impressed items, we sample 10% requests as the training samples.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of the streaming data on Kuaishou in a day (10% requests)</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.1" style="width:142.8pt;height:162pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1.1">Attributes</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1.2">Quantity</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.1.2.1.1">User</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.1.2.1.2">144,328,769</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.3.2">
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.3.2.1">Item</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.3.2.2">70,799,315</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.4.3">
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.4.3.1">Request</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.4.3.2">300,713,382</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.5.4">
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.5.4.1">Candidate</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.5.4.2">756,527,143,866</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.6.5">
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.6.5.1">Impression</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.6.5.2">980,126,567</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.7.6">
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.7.6.1">Click</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.7.6.2">608,213,881</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.8.7">
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.8.7.1">Long view</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.8.7.2">478,241,795</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.9.8">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.1.9.8.1">Like</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.1.9.8.2">81,806,840</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">Besides click, we also predict other user actions such as long view and like. We train the model on the streaming data to predict impression from candidate and predict user actions from impression. For each batch of the data, we test the model first for evaluation, and then train the model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Baselines.</span> We compare the following models to demonstrate the effectiveness of our IFA model.</p>
</div>
<div class="ltx_para" id="S5.SS1.p5">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">AvgPooling:</span> This method processes user behaviour sequence by <span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.2">Av</span>era<span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.3">g</span>e <span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.4">Pooling</span>. It is a simple yet effective way to model short behaviour sequence.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">DIN:</span> This <span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.2">D</span>eep <span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.3">I</span>nterest <span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.4">N</span>etwork achieves user-item interaction by performing attention between the target item and the user behaviour sequence <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib42" title="">2018</a>)</cite>. DIN is the SOTA model for short behaviour sequence.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">SIM-hard:</span> This <span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.2">S</span>earch-based <span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.3">I</span>nterest <span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.4">M</span>odel with <span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.5">hard</span> search uses a two-step interaction module instead of the end-to-end attention to reduce the complexity <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib23" title="">2020</a>)</cite>. In the first step, GSU generates a sub-sequence by selecting sequence items with the same category to the target items, and in the second step, ESU conducts the standard attention.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">SIM-soft:</span> In this <span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.2">S</span>earch-based <span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.3">I</span>nterest <span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.4">M</span>odel with <span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.5">soft</span> search, GSU defines similarity by the distance of embeddings <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib23" title="">2020</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i5.p1">
<p class="ltx_p" id="S5.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.1">TWIN:</span> This <span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.2">TW</span>o-stage <span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.3">I</span>nterest <span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.4">N</span>etwork uses a light attention as GSU for better consistency with ESU <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib4" title="">2023a</a>)</cite>. TWIN is the SOTA model for lifelong behaviour sequence.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS1.p6">
<p class="ltx_p" id="S5.SS1.p6.2">In our experiments, the length of the lifelong sequence <math alttext="n=10,000" class="ltx_Math" display="inline" id="S5.SS1.p6.1.m1.2"><semantics id="S5.SS1.p6.1.m1.2a"><mrow id="S5.SS1.p6.1.m1.2.3" xref="S5.SS1.p6.1.m1.2.3.cmml"><mi id="S5.SS1.p6.1.m1.2.3.2" xref="S5.SS1.p6.1.m1.2.3.2.cmml">n</mi><mo id="S5.SS1.p6.1.m1.2.3.1" xref="S5.SS1.p6.1.m1.2.3.1.cmml">=</mo><mrow id="S5.SS1.p6.1.m1.2.3.3.2" xref="S5.SS1.p6.1.m1.2.3.3.1.cmml"><mn id="S5.SS1.p6.1.m1.1.1" xref="S5.SS1.p6.1.m1.1.1.cmml">10</mn><mo id="S5.SS1.p6.1.m1.2.3.3.2.1" xref="S5.SS1.p6.1.m1.2.3.3.1.cmml">,</mo><mn id="S5.SS1.p6.1.m1.2.2" xref="S5.SS1.p6.1.m1.2.2.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.1.m1.2b"><apply id="S5.SS1.p6.1.m1.2.3.cmml" xref="S5.SS1.p6.1.m1.2.3"><eq id="S5.SS1.p6.1.m1.2.3.1.cmml" xref="S5.SS1.p6.1.m1.2.3.1"></eq><ci id="S5.SS1.p6.1.m1.2.3.2.cmml" xref="S5.SS1.p6.1.m1.2.3.2">𝑛</ci><list id="S5.SS1.p6.1.m1.2.3.3.1.cmml" xref="S5.SS1.p6.1.m1.2.3.3.2"><cn id="S5.SS1.p6.1.m1.1.1.cmml" type="integer" xref="S5.SS1.p6.1.m1.1.1">10</cn><cn id="S5.SS1.p6.1.m1.2.2.cmml" type="integer" xref="S5.SS1.p6.1.m1.2.2">000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.1.m1.2c">n=10,000</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.1.m1.2d">italic_n = 10 , 000</annotation></semantics></math> and the length of the sub-sequence/short sequence <math alttext="k=100" class="ltx_Math" display="inline" id="S5.SS1.p6.2.m2.1"><semantics id="S5.SS1.p6.2.m2.1a"><mrow id="S5.SS1.p6.2.m2.1.1" xref="S5.SS1.p6.2.m2.1.1.cmml"><mi id="S5.SS1.p6.2.m2.1.1.2" xref="S5.SS1.p6.2.m2.1.1.2.cmml">k</mi><mo id="S5.SS1.p6.2.m2.1.1.1" xref="S5.SS1.p6.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.p6.2.m2.1.1.3" xref="S5.SS1.p6.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.2.m2.1b"><apply id="S5.SS1.p6.2.m2.1.1.cmml" xref="S5.SS1.p6.2.m2.1.1"><eq id="S5.SS1.p6.2.m2.1.1.1.cmml" xref="S5.SS1.p6.2.m2.1.1.1"></eq><ci id="S5.SS1.p6.2.m2.1.1.2.cmml" xref="S5.SS1.p6.2.m2.1.1.2">𝑘</ci><cn id="S5.SS1.p6.2.m2.1.1.3.cmml" type="integer" xref="S5.SS1.p6.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.2.m2.1c">k=100</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.2.m2.1d">italic_k = 100</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p7">
<p class="ltx_p" id="S5.SS1.p7.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p7.1.1">Evaluation Protocols.</span>
For each sample in the test step, we rank all candidate items for the user and return the top items. We apply area under curve (AUC) to evaluate the recommendation quality. In the test samples, items with user actions are labeled as positive and candidate items without user actions are labeled as negative. In another words, we test the models’ ability of predicting user actions from the whole candidate set.</p>
</div>
<div class="ltx_para" id="S5.SS1.p8">
<p class="ltx_p" id="S5.SS1.p8.1">As that baselines are trained on impressed items traditionally yet IFA is trained on candidate items, IFA has a natural advantage in this task. For fair comparison, we train all models on the scope of candidate set, and all models in the experiment are optimized by ESMM <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib19" title="">2018a</a>)</cite> introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.SS3" title="4.3. Optimization ‣ 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Performance of IFA Model</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">In this section, we compare our IFA models against baselines on online streaming data of Kuaishou and report the result in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.T2" title="Table 2 ‣ 5.2. Performance of IFA Model ‣ 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Performance of all models</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.1" style="width:261.5pt;height:126pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T2.1.1.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.1.2">Impression</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.1.3">Click</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.1.4">Long view</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.1.5">Like</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.1.2.1.1">AvgPooling</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.1.2">0.9361</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.1.3">0.9444</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.1.4">0.9523</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.1.5">0.9506</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.1.3.2.1">DIN</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.3.2.2">0.9409</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.3.2.3">0.9498</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.3.2.4">0.9564</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.3.2.5">0.9561</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.1.4.3.1">SIM_hard</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.3.2">0.9452</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.3.3">0.9556</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.3.4">0.9605</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.3.5">0.9651</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.1.5.4.1">SIM_soft</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.4.2">0.9502</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.4.3">0.9566</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.4.4">0.9642</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.4.5">0.9657</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.1.6.5.1">TWIN</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.5.2">0.9582</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.5.3">0.9632</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.5.4">0.9726</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.5.5">0.9737</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T2.1.1.7.6.1">IFA</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.1.7.6.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.7.6.2.1">0.9788</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.7.6.3.1">0.9815</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.1.7.6.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.7.6.4.1">0.9864</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.1.7.6.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.7.6.5.1">0.9808</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">As shown in the table, AvgPooling achieves shallow user-item interaction hence performs the worst in all models. By performing attention between the target item and behaviour sequence, DIN achieves deep user-item interaction and performs better than AvgPooling. Benefiting from long-term user preference, SIM outperforms DIN obviously. SIM_soft and SIM_hard show similar performance and SIM_soft performs better in most cases. TWIN improves the consistency of GSU and ESU, and achieves further performance improvement.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Though some baselines show competitive performance in experiment, all baselines lose information of the lifelong sequence. By modeling the sequence without any interaction information loss, the proposed IFA achieves the best performance significantly. IFA outperforms the most competitive baseline TWIN 2.06pp for the best case.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Ablation Study</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">In this section, we demonstrate the effectiveness of each component in IFA. There are two important components of IFA:</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1">Full Sequence Modeling (FSM) mechanism shown in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.E2" title="In 4.2. Model Structure ‣ 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>). FSM is the key component of the IFA model. We expand the target item to a candidate set, and then perform efficient cross attention to achieve lossless simplification. To demonstrate the effectiveness of FSM, we replace it with the two-step attention proposed in <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#bib.bib4" title="">2023a</a>)</cite> in the ablation experiment.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1">Relation Aware Modeling (RAM) mechanism shown in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S4.E3" title="In 4.2. Model Structure ‣ 4. Interaction Fidelity Attention Model ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">3</span></a>). RAM is proposed to model the relationship of the candidate items to generate the best recommendation set. To demonstrate the effectiveness of RAM, we remove it in the ablation experiment.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Ablation study of IFA</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T3.1" style="width:279.3pt;height:72pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T3.1.1.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.1.2">Impression</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.1.3">Click</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.1.4">Long view</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.1.5">Like</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.1.2.1.1">IFA</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.2.1.2.1">0.9788</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.2.1.3.1">0.9815</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.2.1.4.1">0.9864</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.2.1.5"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.2.1.5.1">0.9808</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.1.3.2.1">IFA-FSM</th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.1.3.2.2">0.9652</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.1.3.2.3">0.9691</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.1.3.2.4">0.9774</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.1.3.2.5">0.9752</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T3.1.1.4.3.1">IFA-FSM-RAM</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.1.4.3.2">0.9582</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.1.4.3.3">0.9632</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.1.4.3.4">0.9726</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.1.4.3.5">0.9737</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">The result of ablation study is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.T3" title="Table 3 ‣ 5.3. Ablation Study ‣ 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">3</span></a>. As we can see, without FSM, the performance decreases significantly since we fail to model the whole lifelong sequence. By further removing RAM, the performance also decreases since by predicting the preference on each item in a point wise way, we generate the recommendation set greedily, and the result is a local optimal solution. Please note that IFA-FSM-RAM in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.T3" title="Table 3 ‣ 5.3. Ablation Study ‣ 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">3</span></a> is TWIN in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.T2" title="Table 2 ‣ 5.2. Performance of IFA Model ‣ 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Performance of AB test</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">We apply IFA by adding a new model in the industrial recommendation service of Kuaishou, which serves billions of users. We conduct an AB test and report the relative improvements in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.T4" title="Table 4 ‣ 5.4. Performance of AB test ‣ 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">4</span></a>. To show the significance, we also provide acceptance region with p-value is 0.05, and confidence interval is improvement + acceptance region. As represented in the table, IFA achieves significant improvement in many important metrics, especially watch time. IFA not only improves the accuracy, but also improves the diversity significantly. The reason is that compared with SIM, interaction in IFA are not constrained by the category, thus target item with a new category can be returned.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span>Performance of AB test</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T4.1" style="width:230.0pt;height:144pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.1.1.1.1">
<span class="ltx_p" id="S5.T4.1.1.1.1.1.1.1" style="width:48.4pt;">Objective</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.1.1.2.1">
<span class="ltx_p" id="S5.T4.1.1.1.1.2.1.1" style="width:56.9pt;">Improvement</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.1.1.3.1">
<span class="ltx_p" id="S5.T4.1.1.1.1.3.1.1" style="width:85.4pt;">Acceptance region</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.2.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.2.1.1.1">
<span class="ltx_p" id="S5.T4.1.1.2.1.1.1.1" style="width:48.4pt;">Watch time</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.2.1.2.1">
<span class="ltx_p" id="S5.T4.1.1.2.1.2.1.1" style="width:56.9pt;">+0.803%</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T4.1.1.2.1.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.2.1.3.1">
<span class="ltx_p" id="S5.T4.1.1.2.1.3.1.1" style="width:85.4pt;">[-0.10%, 0.10%]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.3.2.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.3.2.1.1">
<span class="ltx_p" id="S5.T4.1.1.3.2.1.1.1" style="width:48.4pt;">Impression</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.3.2.2.1">
<span class="ltx_p" id="S5.T4.1.1.3.2.2.1.1" style="width:56.9pt;">+0.291%</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.3.2.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.3.2.3.1">
<span class="ltx_p" id="S5.T4.1.1.3.2.3.1.1" style="width:85.4pt;">[-0.14%, 0.14%]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.4.3.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.4.3.1.1">
<span class="ltx_p" id="S5.T4.1.1.4.3.1.1.1" style="width:48.4pt;">Like</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.4.3.2.1">
<span class="ltx_p" id="S5.T4.1.1.4.3.2.1.1" style="width:56.9pt;">+0.984%</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.4.3.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.4.3.3.1">
<span class="ltx_p" id="S5.T4.1.1.4.3.3.1.1" style="width:85.4pt;">[-0.36%, 0.37%]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.5.4.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.5.4.1.1">
<span class="ltx_p" id="S5.T4.1.1.5.4.1.1.1" style="width:48.4pt;">Comment</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.5.4.2.1">
<span class="ltx_p" id="S5.T4.1.1.5.4.2.1.1" style="width:56.9pt;">+1.329%</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.5.4.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.5.4.3.1">
<span class="ltx_p" id="S5.T4.1.1.5.4.3.1.1" style="width:85.4pt;">[-0.56%, 0.56%]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.6.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.6.5.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.6.5.1.1">
<span class="ltx_p" id="S5.T4.1.1.6.5.1.1.1" style="width:48.4pt;">Follow</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.6.5.2.1">
<span class="ltx_p" id="S5.T4.1.1.6.5.2.1.1" style="width:56.9pt;">+1.781%</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.6.5.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.6.5.3.1">
<span class="ltx_p" id="S5.T4.1.1.6.5.3.1.1" style="width:85.4pt;">[-0.49%, 0.49%]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.7.6">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.7.6.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.7.6.1.1">
<span class="ltx_p" id="S5.T4.1.1.7.6.1.1.1" style="width:48.4pt;">Share</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.7.6.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.7.6.2.1">
<span class="ltx_p" id="S5.T4.1.1.7.6.2.1.1" style="width:56.9pt;">+0.780%</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S5.T4.1.1.7.6.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.7.6.3.1">
<span class="ltx_p" id="S5.T4.1.1.7.6.3.1.1" style="width:85.4pt;">[-0.86%, 0.86%]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.8.7">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.1.1.8.7.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.8.7.1.1">
<span class="ltx_p" id="S5.T4.1.1.8.7.1.1.1" style="width:48.4pt;">Diversity</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.1.1.8.7.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.8.7.2.1">
<span class="ltx_p" id="S5.T4.1.1.8.7.2.1.1" style="width:56.9pt;">+0.821%</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S5.T4.1.1.8.7.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.1.1.8.7.3.1">
<span class="ltx_p" id="S5.T4.1.1.8.7.3.1.1" style="width:85.4pt;">[-0.05%, 0.05%]</span>
</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">Based on these promising results, we fully launched our IFA. We launched three versions by increasing <math alttext="n" class="ltx_Math" display="inline" id="S5.SS4.p2.1.m1.1"><semantics id="S5.SS4.p2.1.m1.1a"><mi id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><ci id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.1.m1.1d">italic_n</annotation></semantics></math> continuously, and report the accumulate improvement in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.09742v1#S5.T4" title="Table 4 ‣ 5.4. Performance of AB test ‣ 5. Experiments ‣ IFA: Interaction Fidelity Attention for Entire Lifelong Behaviour Sequence Modeling"><span class="ltx_text ltx_ref_tag">4</span></a>. The AB test is observed for 7 days (2023.11.24-2023.11.29) on 10% users or 3 days (2024.02.03-2024.02.05 and 2024.06.10-2024.06.12) on 20% users to get reliable result.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we design an efficient way to model the whole lifelong behaviour sequence in the recommendation task called IFA. To achieve this, we expand the query of attention from a single embedding into an embedding set, and leverage linear transformer to achieve efficient cross attention without any interaction information loss. We also additionally construct the relationship between items in the candidate set to generate the recommendation set as an optimal whole. Offline experiments and online AB test show the effectiveness of IFA.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">For future work, we are interested in solving longer sequence or larger candidate set in the recommendation task. We also have interests in modeling the sequential information of the behaviour sequence by GPT paradigm in IFA. Exploring the power of IFA in more tasks such as search is also a way worth trying .</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beltagy et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Iz Beltagy, Matthew E Peters, and Arman Cohan. 2020.

</span>
<span class="ltx_bibblock">Longformer: The long-document transformer.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.3.1">arXiv preprint arXiv:2004.05150</span> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cen et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yukuo Cen, Jianwei Zhang, Xu Zou, Chang Zhou, Hongxia Yang, and Jie Tang. 2020.

</span>
<span class="ltx_bibblock">Controllable multi-interest framework for recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib3.3.1">KDD</span>. 2942–2951.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib4.3.3.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chenbin Zhang, Zhiyi Fu, Xiaoxue Zang, Lin Guan, Jing Lu, Yiqun Hui, Dewei Leng, Yanan Niu, Yang Song, et al<span class="ltx_text" id="bib.bib4.4.1">.</span> 2023a.

</span>
<span class="ltx_bibblock">TWIN: TWo-stage Interest Network for Lifelong User Behavior Modeling in CTR Prediction at Kuaishou. In <span class="ltx_text ltx_font_italic" id="bib.bib4.5.1">SIGKDD</span>. 3785–3794.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chenbin Zhang, Yiqun Hui, Dewei Leng, Yanan Niu, Yang Song, and Kun Gai. 2023b.

</span>
<span class="ltx_bibblock">Pepnet: Parameter and embedding personalized network for infusing with personalized prior information. In <span class="ltx_text ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</span>. 3795–3804.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Jingyuan Chen, Hanwang Zhang, Xiangnan He, Liqiang Nie, Wei Liu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Attentive Collaborative Filtering: Multimedia Recommendation with Item- and Component-Level Attention. In <span class="ltx_text ltx_font_italic" id="bib.bib6.3.1">SIGIR</span>. 335–344.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He. 2017.

</span>
<span class="ltx_bibblock">DeepFM: A Factorization-Machine based Neural Network for CTR Prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib7.3.1">IJCAI ’17</span>. 1725–1731.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley. 2016.

</span>
<span class="ltx_bibblock">VBPR: Visual Bayesian Personalized Ranking from Implicit Feedback. In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">AAAI</span>. 144–150.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and Chua (2017)</span>
<span class="ltx_bibblock">
Xiangnan He and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Neural Factorization Machines for Sparse Predictive Analytics. In <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">SIGIR</span>. 355–364.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, YongDong Zhang, and Meng Wang. 2020.

</span>
<span class="ltx_bibblock">LightGCN: Simplifying and Powering Graph Convolution Network for Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib10.3.1">SIGIR</span>. 639–648.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Neural Collaborative Filtering. In <span class="ltx_text ltx_font_italic" id="bib.bib11.3.1">WWW</span>. 173–182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">ICDM</span>. 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katharopoulos et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François Fleuret. 2020.

</span>
<span class="ltx_bibblock">Transformers are RNNs: Fast Autoregressive Transformers with Linear Attention. In <span class="ltx_text ltx_font_italic" id="bib.bib13.3.1">ICML</span>. 5156–5165.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kitaev et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Nikita Kitaev, Lukasz Kaiser, and Anselm Levskaya. 2020.

</span>
<span class="ltx_bibblock">Reformer: The Efficient Transformer. In <span class="ltx_text ltx_font_italic" id="bib.bib14.3.1">8th International Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia, April 26-30, 2020</span>. OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koren (2009)</span>
<span class="ltx_bibblock">
Yehuda Koren. 2009.

</span>
<span class="ltx_bibblock">The bellkor solution to the netflix grand prize.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Netflix prize documentation</span> (2009), 1–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Juho Lee, Yoonho Lee, Jungtaek Kim, Adam R. Kosiorek, Seungjin Choi, and Yee Whye Teh. 2019.

</span>
<span class="ltx_bibblock">Set Transformer: A Framework for Attention-based Permutation-Invariant Neural Networks. In <span class="ltx_text ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 36th International Conference on Machine Learning, ICML 2019, 9-15 June 2019, Long Beach, California, USA</span> <span class="ltx_text ltx_font_italic" id="bib.bib16.4.2">(Proceedings of Machine Learning Research)</span>, Vol. 97. PMLR, 3744–3753.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chao Li, Zhiyuan Liu, Mengmeng Wu, Yuchi Xu, Huan Zhao, Pipei Huang, Guoliang Kang, Qiwei Chen, Wei Li, and Dik Lun Lee. 2019.

</span>
<span class="ltx_bibblock">Multi-interest network with dynamic routing for recommendation at Tmall. In <span class="ltx_text ltx_font_italic" id="bib.bib17.3.1">CIKM</span>. 2615–2623.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2018b)</span>
<span class="ltx_bibblock">
Jiaqi Ma, Zhe Zhao, Xinyang Yi, Jilin Chen, Lichan Hong, and Ed H. Chi. 2018b.

</span>
<span class="ltx_bibblock">Modeling Task Relationships in Multi-task Learning with Multi-gate Mixture-of-Experts. In <span class="ltx_text ltx_font_italic" id="bib.bib18.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, KDD 2018, London, UK, August 19-23, 2018</span>. ACM, 1930–1939.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2018a)</span>
<span class="ltx_bibblock">
Xiao Ma, Liqin Zhao, Guan Huang, Zhi Wang, Zelin Hu, Xiaoqiang Zhu, and Kun Gai. 2018a.

</span>
<span class="ltx_bibblock">Entire space multi-task model: An effective approach for estimating post-click conversion rate. In <span class="ltx_text ltx_font_italic" id="bib.bib19.3.1">The 41st International ACM SIGIR Conference on Research &amp; Development in Information Retrieval</span>. 1137–1140.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAuley and Leskovec (2013)</span>
<span class="ltx_bibblock">
Julian McAuley and Jure Leskovec. 2013.

</span>
<span class="ltx_bibblock">Hidden factors and hidden topics: understanding rating dimensions with review text. In <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">RecSys</span>. 165–172.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xuan-Bac Nguyen, Duc Toan Bui, Chi Nhan Duong, Tien D Bui, and Khoa Luu. 2021.

</span>
<span class="ltx_bibblock">Clusformer: A transformer based clustering approach to unsupervised large-scale face and visual landmark recognition. In <span class="ltx_text ltx_font_italic" id="bib.bib21.3.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span>. 10847–10856.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pei et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Changhua Pei, Yi Zhang, Yongfeng Zhang, Fei Sun, Xiao Lin, Hanxiao Sun, Jian Wu, Peng Jiang, Junfeng Ge, Wenwu Ou, and Dan Pei. 2019.

</span>
<span class="ltx_bibblock">Personalized re-ranking for recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib22.3.1">RecSys</span>. 3–11.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pi et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Qi Pi, Guorui Zhou, Yujing Zhang, Zhe Wang, Lejian Ren, Ying Fan, Xiaoqiang Zhu, and Kun Gai. 2020.

</span>
<span class="ltx_bibblock">Search-based user interest modeling with lifelong sequential behavior data for click-through rate prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib23.3.1">CIKM</span>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2011)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2011.

</span>
<span class="ltx_bibblock">Factorization Machines. In <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">ICDM</span>. 995–1000.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2009.

</span>
<span class="ltx_bibblock">BPR: Bayesian personalized ranking from implicit feedback. In <span class="ltx_text ltx_font_italic" id="bib.bib25.3.1">UAI</span>. 452–461.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Duyu Tang, Bing Qin, Ting Liu, and Yuekui Yang. 2015.

</span>
<span class="ltx_bibblock">User Modeling with Neural Network for Review Rating Prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib26.3.1">IJCAI</span>. 1340–1346.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is All you Need. In <span class="ltx_text ltx_font_italic" id="bib.bib27.3.1">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems 2017, December 4-9, 2017, Long Beach, CA, USA</span>. 5998–6008.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vyas et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Apoorv Vyas, Angelos Katharopoulos, and François Fleuret. 2020.

</span>
<span class="ltx_bibblock">Fast transformers with clustered attention. In <span class="ltx_text ltx_font_italic" id="bib.bib28.3.1">Neurips</span>. 21665–21674.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Sinong Wang, Belinda Z. Li, Madian Khabsa, Han Fang, and Hao Ma. 2020.

</span>
<span class="ltx_bibblock">Linformer: Self-Attention with Linear Complexity.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.3.1">CoRR</span> abs/2006.04768 (2020).

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2006.04768" title="">https://arxiv.org/abs/2006.04768</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Le Wu, Peijie Sun, Richang Hong, Yanjie Fu, Xiting Wang, and Meng Wang. 2019.

</span>
<span class="ltx_bibblock">SocialGCN: An Efficient Graph Convolutional Network based Model for Social Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib30.3.1">AAAI</span>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ying et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Rex Ying, Ruining He, Kaifeng Chen, Pong Eksombatchai, William L. Hamilton, and Jure Leskovec. 2018.

</span>
<span class="ltx_bibblock">Graph Convolutional Neural Networks for Web-Scale Recommender Systems. In <span class="ltx_text ltx_font_italic" id="bib.bib31.3.1">KDD</span>. 974–983.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wenhui Yu, Xiao Lin, Jinfei Liu, Junfeng Ge, Wenwu Ou, and Zheng Qin. 2021.

</span>
<span class="ltx_bibblock">Self-propagation graph neural network for recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.3.1">IEEE Transactions on Knowledge and Data Engineering</span> 34, 12 (2021), 5993–6002.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu and Qin (2020a)</span>
<span class="ltx_bibblock">
Wenhui Yu and Zheng Qin. 2020a.

</span>
<span class="ltx_bibblock">Graph Convolutional Network for Recommendation with Low-pass Collaborative Filters. In <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">ICML</span>. 10936–10945.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu and Qin (2020b)</span>
<span class="ltx_bibblock">
Wenhui Yu and Zheng Qin. 2020b.

</span>
<span class="ltx_bibblock">Sampler design for implicit feedback data by noisy-label robust learning. In <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">SIGIR</span>. 861–870.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Wenhui Yu, Huidi Zhang, Xiangnan He, Xu Chen, Li Xiong, and Zheng Qin. 2018.

</span>
<span class="ltx_bibblock">Aesthetic-based Clothing Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib35.3.1">WWW</span>. 649–658.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Wenhui Yu, Zixin Zhang, and Zheng Qin. 2022.

</span>
<span class="ltx_bibblock">Low-Pass Graph Convolutional Network for Recommendation. In <span class="ltx_text ltx_font_italic" id="bib.bib36.3.1">AAAI</span>. 8954–8961.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zadrozny (2004)</span>
<span class="ltx_bibblock">
Bianca Zadrozny. 2004.

</span>
<span class="ltx_bibblock">Learning and evaluating classifiers under sample selection bias. In <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">ICML</span>. 114.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zaheer et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Manzil Zaheer, Guru Guruganesh, Avinava Dubey, Joshua Ainslie, Chris Alberti, Santiago Ontanon, Philip Pham, Anirudh Ravula, Qifan Wang, and Li Yang. 2020.

</span>
<span class="ltx_bibblock">Big Bird: Transformers for Longer Sequences. In <span class="ltx_text ltx_font_italic" id="bib.bib38.3.1">NeurIPS</span>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Fuzheng Zhang, Nicholas Jing Yuan, Defu Lian, Xing Xie, and Wei-Ying Ma. 2016.

</span>
<span class="ltx_bibblock">Collaborative Knowledge Base Embedding for Recommender Systems. In <span class="ltx_text ltx_font_italic" id="bib.bib39.3.1">KDD</span>. 353–362.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yabin Zhang, Wenhui Yu, Erhan Zhang, Xu Chen, Lantao Hu, Peng Jiang, and Kun Gai. 2024.

</span>
<span class="ltx_bibblock">RecGPT: Generative Personalized Prompts for Sequential Recommendation via ChatGPT Training Paradigm. In <span class="ltx_text ltx_font_italic" id="bib.bib40.3.1">DASFAA</span>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Guorui Zhou, Na Mou, Ying Fan, Qi Pi, Weijie Bian, Chang Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Deep interest evolution network for click-through rate prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib41.3.1">AAAI</span>. 5941–5948.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep interest network for click-through rate prediction. In <span class="ltx_text ltx_font_italic" id="bib.bib42.3.1">KDD</span>. 1059–1068.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Jun 14 06:07:19 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
