<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation</title>
<!--Generated on Mon Sep  2 11:44:18 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Sequential Recommendation,  Recommender Systems,  Mamba,  State Space Model (SSM),  State Space Duality (SSD),  Transformer." lang="en" name="keywords"/>
<base href="/html/2409.01192v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S1" title="In SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2" title="In SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>The Proposed Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS1" title="In 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Notations and Definitions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS2" title="In 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>An Overview of the Proposed SSD4Rec</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS3" title="In 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Variable-length Item Sequence Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS4" title="In 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Bidirectional State Space Duality (Bi-SSD) for User Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS4.SSS1" title="In 2.4. Bidirectional State Space Duality (Bi-SSD) for User Modeling ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4.1 </span><span class="ltx_text ltx_font_bold">Structured State Space Duality</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS4.SSS2" title="In 2.4. Bidirectional State Space Duality (Bi-SSD) for User Modeling ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4.2 </span><span class="ltx_text ltx_font_bold">Block Design</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS4.SSS3" title="In 2.4. Bidirectional State Space Duality (Bi-SSD) for User Modeling ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4.3 </span><span class="ltx_text ltx_font_bold">Prediction Layer</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS5" title="In 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span><span class="ltx_text ltx_font_bold">Learning Objective</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS6" title="In 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.6 </span><span class="ltx_text ltx_font_bold">Time Complexity Analysis</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3" title="In SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS1" title="In 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span><span class="ltx_text ltx_font_bold">Experimental Settings</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS1.SSS1" title="In 3.1. Experimental Settings ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span><span class="ltx_text ltx_font_bold">Datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS1.SSS2" title="In 3.1. Experimental Settings ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span><span class="ltx_text ltx_font_bold">Baselines</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS1.SSS3" title="In 3.1. Experimental Settings ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.3 </span><span class="ltx_text ltx_font_bold">Evaluation Metrics</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS1.SSS4" title="In 3.1. Experimental Settings ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.4 </span><span class="ltx_text ltx_font_bold">Hyper-parameter Settings</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS2" title="In 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span><span class="ltx_text ltx_font_bold">Recommendation Performance Comparison</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS3" title="In 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Efficiency Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS4" title="In 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS5" title="In 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Hyper-parameter Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS5.SSS1" title="In 3.5. Hyper-parameter Analysis ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.1 </span><span class="ltx_text ltx_font_bold">Effect of Backward Indicator <math alttext="\beta" class="ltx_Math" display="inline"><semantics><mi>β</mi><annotation-xml encoding="MathML-Content"><ci>𝛽</ci></annotation-xml><annotation encoding="application/x-tex">\beta</annotation><annotation encoding="application/x-llamapun">italic_β</annotation></semantics></math></span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.SS5.SSS2" title="In 3.5. Hyper-parameter Analysis ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.2 </span><span class="ltx_text ltx_font_bold">Effect of Max Sequence Length <math alttext="L" class="ltx_Math" display="inline"><semantics><mi>L</mi><annotation-xml encoding="MathML-Content"><ci>𝐿</ci></annotation-xml><annotation encoding="application/x-tex">L</annotation><annotation encoding="application/x-llamapun">italic_L</annotation></semantics></math></span></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S4" title="In SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S4.SS1" title="In 4. Related Work ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S4.SS2" title="In 4. Related Work ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Structured State Space Models (Mamba)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S5" title="In SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Haohao Qu <math alttext="{\dagger}" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><ci id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">{\dagger}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">†</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.2.id1">The Hong Kong Polytechnic University</span><span class="ltx_text ltx_affiliation_city" id="id5.3.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id6.4.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:haohao.qu@connect.polyu.hk">haohao.qu@connect.polyu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yifeng Zhang <math alttext="{\dagger}" class="ltx_Math" display="inline" id="id2.1.m1.1"><semantics id="id2.1.m1.1a"><mo id="id2.1.m1.1.1" xref="id2.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id2.1.m1.1b"><ci id="id2.1.m1.1.1.cmml" xref="id2.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.1.m1.1c">{\dagger}</annotation><annotation encoding="application/x-llamapun" id="id2.1.m1.1d">†</annotation></semantics></math>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.2.id1">The Hong Kong Polytechnic University</span><span class="ltx_text ltx_affiliation_city" id="id8.3.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id9.4.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yifeng.zhang@connect.polyu.hk">yifeng.zhang@connect.polyu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Liangbo Ning
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">The Hong Kong Polytechnic University</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:BigLemon1123@gmail.com">BigLemon1123@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenqi Fan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">The Hong Kong Polytechnic University</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wenqifan03@gmail.com">wenqifan03@gmail.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qing Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">The Hong Kong Polytechnic University</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:qing-prof.li@polyu.edu.hk">qing-prof.li@polyu.edu.hk</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id19.id1">Sequential recommendation methods are crucial in modern recommender systems for their remarkable capability to understand a user’s changing interests based on past interactions.
However, a significant challenge faced by current methods (e.g., RNN- or Transformer-based models) is to effectively and efficiently capture users’ preferences by modeling long behavior sequences, which impedes their various applications like short video platforms where user interactions are numerous.
Recently, an emerging architecture named <span class="ltx_text ltx_font_bold" id="id19.id1.1">Mamba</span>, built on state space models (SSM) with efficient hardware-aware designs, has showcased the tremendous potential for sequence modeling, presenting a compelling avenue for addressing the challenge effectively.
Inspired by this, we propose a novel generic and efficient sequential recommendation backbone, <span class="ltx_text ltx_font_bold" id="id19.id1.2">SSD4Rec</span>, which explores the seamless adaptation of Mamba for sequential recommendations.
Specifically, SSD4Rec marks the variable- and long-length item sequences with sequence registers and processes the item representations with bidirectional Structured State Space Duality (SSD) blocks.
This not only allows for hardware-aware matrix multiplication but also empowers outstanding capabilities in variable-length and long-range sequence modeling.
Extensive evaluations on four benchmark datasets demonstrate that the proposed model achieves state-of-the-art performance while maintaining near-linear scalability with user sequence length. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ZhangYifeng1995/SSD4Rec" title="">https://github.com/ZhangYifeng1995/SSD4Rec</a>.</p>
</div>
<div class="ltx_keywords">Sequential Recommendation, Recommender Systems, Mamba, State Space Model (SSM), State Space Duality (SSD), Transformer.
</div>
<div class="ltx_acknowledgements">* Corresponding author: Wenqi Fan, Department of Computing, and Department of Management and Marketing, The Hong Kong Polytechnic University. 
<br class="ltx_break"/><math alttext="{\dagger}" class="ltx_Math" display="inline" id="id3.m1.1"><semantics id="id3.m1.1a"><mo id="id3.m1.1.1" xref="id3.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id3.m1.1b"><ci id="id3.m1.1.1.cmml" xref="id3.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id3.m1.1c">{\dagger}</annotation><annotation encoding="application/x-llamapun" id="id3.m1.1d">†</annotation></semantics></math> The authors contribute equally to this paper
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommender systems (RecSys) stand out as a crucial branch in the realm of data mining, offering an essential and powerful solution to alleviate information overload issues and enhance user experiences across a wide array of applications <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib44" title="">2024</a>; Qu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib30" title="">2024a</a>; Fan
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib12" title="">2023</a>)</cite>.
As a prevalent task in practical applications, sequential recommendation strives to capture users’ dynamic preferences and predict the next items that users are likely to interact with based on their historical behaviors, which have been widely used in various domains, such as e-commerce <cite class="ltx_cite ltx_citemacro_citep">(Singer et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib35" title="">2022</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib39" title="">2020</a>)</cite>, streaming media <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib16" title="">2019</a>; Rappaz
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib32" title="">2021</a>)</cite>, and news recommendation <cite class="ltx_cite ltx_citemacro_citep">(Wu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib40" title="">2022</a>)</cite>.
Differing from conventional RecSys <cite class="ltx_cite ltx_citemacro_citep">(Fan
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib9" title="">2022</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib10" title="">2019</a>)</cite>, which generates recommendations solely based on the user-item interaction in a static fashion, the user’s preferences are often dynamic, changing with time and influenced by various factors in the context of sequential recommendation tasks.
For example, after purchasing an iPad, a user might continue to buy related Apple accessories such as the Apple Pencil.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To capture the sequential dynamic interests from the users’ historical interactions, a surge of studies have been proposed to leverage the powerful capabilities of advanced deep learning architectures, including Recurrent Neural Networks (RNNs) <cite class="ltx_cite ltx_citemacro_citep">(Chen
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib4" title="">2018</a>; Ye
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib42" title="">2020</a>; Duan
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib8" title="">2023</a>)</cite> and Transformer <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib22" title="">2018</a>; Sun
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib36" title="">2019</a>)</cite> for sequential recommendations.
For example,
<cite class="ltx_cite ltx_citemacro_citet">Donkers
et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib7" title="">2017</a>)</cite> propose a novel extension of Recurrent Neural Networks tailored for sequential recommendations.
<cite class="ltx_cite ltx_citemacro_citet">Sun
et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib36" title="">2019</a>)</cite> proposes BERT4Rec, which introduces and leverages deep bidirectional self-attention based on Transformer for modeling user behavior sequences.
Despite their prevalence and effectiveness in sequential recommendations, there are still some limitations for existing methods based on various deep learning architectures.
For example, RNN-based recommender systems process users’ historical sequences step by step, requiring the completion of hidden state calculations from the previous time step before making predictions for the next time step, leading to significant time costs.
However, recommendation systems, such as Amazon, often demand real-time recommendations, as excessive delays can diminish user experience and impact company revenue <cite class="ltx_cite ltx_citemacro_citep">(Huang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib20" title="">2015</a>; Ma
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib29" title="">2020</a>)</cite>.
Another prevalent approach, transformer-based RecSys, due to their utilization of self-attention mechanisms, exhibits a quadratic growth in computational complexity as the input sequence length increases.
This implies that such models face challenges in handling users who interact with a large number of items.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Recently, a promising architecture, structured state space models (SSMs) <cite class="ltx_cite ltx_citemacro_citep">(Qu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib31" title="">2024b</a>; Lu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib28" title="">2024</a>; Gu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib15" title="">2021</a>)</cite>, have emerged to efficiently capture complex dependencies in sequential data, becoming a formidable competitor to existing popular deep neural networks.
As one of the most successful SSM variants, <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">Mamba</span> <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib14" title="">2023</a>; Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite> achieves comparable modeling capabilities to Transformers while maintaining linear scalability with sequence length by introducing a Structured State Space Model and corresponding hardware-computational algorithms.
Inspired by the success of Mamba-based models for capturing sequential and contextual information in various domains <cite class="ltx_cite ltx_citemacro_citep">(Qu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib31" title="">2024b</a>)</cite>, such as text summarization <cite class="ltx_cite ltx_citemacro_citep">(Bronnec et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib2" title="">2024</a>; Ren
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib33" title="">2024</a>)</cite>, speech analysis <cite class="ltx_cite ltx_citemacro_citep">(Jiang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib21" title="">2024</a>; Li and Chen, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib24" title="">2024</a>)</cite>, and question-answering systems <cite class="ltx_cite ltx_citemacro_citep">(He
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib18" title="">2024</a>; Lieber
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib25" title="">2024</a>)</cite>, it is appealing to transfer this success from other domains to sequential recommendations to address the aforementioned limitations of existing sequential RecSys.
More specifically, Mamba proposes attention-like matrix multiplication based on the property of Structured State Space Duality (SSD) <cite class="ltx_cite ltx_citemacro_citep">(Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite> to allow SSM to compute parallelly, which can decrease the time consumption of recurrent operations in RNNs.
Moreover, Mamba introduces a Structured State Space Model that circumvents the need for self-attention mechanisms.
With the growth in input length, Mamba maintains linear time complexity, significantly boosting the model’s capabilities in processing long sequence data.
Thus, given their advantages, Mamba provides great opportunities to advance sequential recommendations.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">However, directly applying Mamba to sequential recommendation remains highly challenging, primarily due to two key hurdles.
Due to varying length of users’ historical sequences towards items,
most existing sequential modeling methods need <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">padding</em> or <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">truncation</em> operations for sequences with different lengths in recommender systems, resulting in excessive computational overhead (padding) or the potential loss of critical information that could enhance recommendations (truncation), as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.F2" title="Figure 2 ‣ 2.2. An Overview of the Proposed SSD4Rec ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.
Thus, the first challenge is how to model the dynamic users’ preference with variable- and lone-length historical interaction sequences.
Meanwhile, naive Mamba-based models employ a <em class="ltx_emph ltx_font_italic" id="S1.p4.1.3">left-to-right uni-directional</em> modeling paradigm, which limits the power of hidden representations for items in historical sequences <cite class="ltx_cite ltx_citemacro_citep">(Sun
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib36" title="">2019</a>)</cite>.
Specifically, each item can only encode information from preceding items, making it difficult to capture precise user preferences and achieve optimal performance in sequential recommendations.
This is due to the fact that users’ historical interactions might not follow a rigidly ordered sequence in practice.
Thus, the second challenge is how to capture context from both preceding items and subsequent items within the users’ interaction history.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To address such challenges, in this paper, a Structured State-Space Duality-empowered recommendation framework (<span class="ltx_text ltx_font_bold" id="S1.p5.1.1">SSD4Rec</span>) is proposed based on the advanced Mamba architecture to capture the dynamics underlying variable- and long-length user interaction sequences effectively and efficiently.
A novel strategy is introduced to encode the user’s sequential interactions into a variable-length item sequence without requiring padding and truncation, thereby accommodating an unlimited input window.
Meanwhile, a Bidirectional State Space Duality (Bi-SSD) block based on the Mamba architecture is designed to swallow the numerous item representations and predict corresponding user preferences for proper recommendations.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our major contributions are summarized as follows:
</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We seamlessly integrate the Mamba into the recommendation framework and propose a novel Structured State Space Duality-empowered sequential recommendation (<span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">SSD4Rec)</span>, which utilizes the advantages of Mamba to effectively and efficiently capture the dynamic users’ preferences and accurately generate next-item recommendations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a novel strategy to encode the users’ historical behavior with varying lengths and a Bidirectional Structured State-Space Duality (Bi-SSD) block to capture contextual information for user behavior sequence modeling, effectively addressing the challenges of adapting Mamba for sequential recommendations.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conducted extensive experiments on four commonly used datasets to empirically showcase the efficacy of SSD4Rec, including its superior recommendation performance and its scalability in predicting the preferences of users with variable- and long-length interaction histories.
Specifically, SSD4Rec is 154.62% and 66.21% faster than the representative attention-based and SSM-based methods (i.e., SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib22" title="">2018</a>)</cite> and Mamba4Rec <cite class="ltx_cite ltx_citemacro_citep">(Liu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib26" title="">2024</a>)</cite>), respectively, when training to extract features on user interactions at the length of 200.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">The remainder of this paper is structured as follows.
Section <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2" title="2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> introduces the
proposed approach, which is evaluated in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3" title="3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>.
Then, Section <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S4" title="4. Related Work ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> summarizes the recent development of sequential recommendation and sequence modeling. Finally, conclusions are drawn in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S5" title="5. Conclusion ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>The Proposed Method</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This section will begin by formulating the problem of sequential recommendation.
Then, we provide an overview of the proposed SSD4Rec, followed by a detailed explanation of each model component.
Finally, we will discuss the model training and inference of the proposed SSD4Rec.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="312" id="S2.F1.g1" src="x1.png" width="780"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The overall framework of the proposed SSD4Rec for variable- and long-length sequential recommendation,
which consists of the input construction with variable-length item sequences in a batch and the bidirectional block constructed with State Space Duality (SSD) layers for efficient and effective sequence modeling.</figcaption>
</figure>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Notations and Definitions</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.20">The primary goal of sequential recommendation is to predict the next interaction within a sequence.
Let <math alttext="\mathcal{U}=\{u_{1},u_{2},...,u_{|\mathcal{U}|}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.5"><semantics id="S2.SS1.p1.1.m1.5a"><mrow id="S2.SS1.p1.1.m1.5.5" xref="S2.SS1.p1.1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.5.5.5" xref="S2.SS1.p1.1.m1.5.5.5.cmml">𝒰</mi><mo id="S2.SS1.p1.1.m1.5.5.4" xref="S2.SS1.p1.1.m1.5.5.4.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.5.5.3.3" xref="S2.SS1.p1.1.m1.5.5.3.4.cmml"><mo id="S2.SS1.p1.1.m1.5.5.3.3.4" stretchy="false" xref="S2.SS1.p1.1.m1.5.5.3.4.cmml">{</mo><msub id="S2.SS1.p1.1.m1.3.3.1.1.1" xref="S2.SS1.p1.1.m1.3.3.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.3.3.1.1.1.2" xref="S2.SS1.p1.1.m1.3.3.1.1.1.2.cmml">u</mi><mn id="S2.SS1.p1.1.m1.3.3.1.1.1.3" xref="S2.SS1.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.1.m1.5.5.3.3.5" xref="S2.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.4.4.2.2.2" xref="S2.SS1.p1.1.m1.4.4.2.2.2.cmml"><mi id="S2.SS1.p1.1.m1.4.4.2.2.2.2" xref="S2.SS1.p1.1.m1.4.4.2.2.2.2.cmml">u</mi><mn id="S2.SS1.p1.1.m1.4.4.2.2.2.3" xref="S2.SS1.p1.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.1.m1.5.5.3.3.6" xref="S2.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><mi id="S2.SS1.p1.1.m1.2.2" mathvariant="normal" xref="S2.SS1.p1.1.m1.2.2.cmml">…</mi><mo id="S2.SS1.p1.1.m1.5.5.3.3.7" xref="S2.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.5.5.3.3.3" xref="S2.SS1.p1.1.m1.5.5.3.3.3.cmml"><mi id="S2.SS1.p1.1.m1.5.5.3.3.3.2" xref="S2.SS1.p1.1.m1.5.5.3.3.3.2.cmml">u</mi><mrow id="S2.SS1.p1.1.m1.1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.1.2.cmml"><mo id="S2.SS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.1.cmml">𝒰</mi><mo id="S2.SS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S2.SS1.p1.1.m1.5.5.3.3.8" stretchy="false" xref="S2.SS1.p1.1.m1.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.5b"><apply id="S2.SS1.p1.1.m1.5.5.cmml" xref="S2.SS1.p1.1.m1.5.5"><eq id="S2.SS1.p1.1.m1.5.5.4.cmml" xref="S2.SS1.p1.1.m1.5.5.4"></eq><ci id="S2.SS1.p1.1.m1.5.5.5.cmml" xref="S2.SS1.p1.1.m1.5.5.5">𝒰</ci><set id="S2.SS1.p1.1.m1.5.5.3.4.cmml" xref="S2.SS1.p1.1.m1.5.5.3.3"><apply id="S2.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="S2.SS1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.3.3.1.1.1.2">𝑢</ci><cn id="S2.SS1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.1.m1.4.4.2.2.2.cmml" xref="S2.SS1.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.4.4.2.2.2.2">𝑢</ci><cn id="S2.SS1.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.1.m1.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2">…</ci><apply id="S2.SS1.p1.1.m1.5.5.3.3.3.cmml" xref="S2.SS1.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.5.5.3.3.3.1.cmml" xref="S2.SS1.p1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.1.m1.5.5.3.3.3.2.cmml" xref="S2.SS1.p1.1.m1.5.5.3.3.3.2">𝑢</ci><apply id="S2.SS1.p1.1.m1.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.3"><abs id="S2.SS1.p1.1.m1.1.1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.3.1"></abs><ci id="S2.SS1.p1.1.m1.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1">𝒰</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.5c">\mathcal{U}=\{u_{1},u_{2},...,u_{|\mathcal{U}|}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.5d">caligraphic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT | caligraphic_U | end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="\mathcal{V}=\{v_{1},v_{2},...,v_{|\mathcal{V}}|\}" class="ltx_math_unparsed" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1b"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.1.2">𝒱</mi><mo id="S2.SS1.p1.2.m2.1.3">=</mo><mrow id="S2.SS1.p1.2.m2.1.4"><mo id="S2.SS1.p1.2.m2.1.4.1" stretchy="false">{</mo><msub id="S2.SS1.p1.2.m2.1.4.2"><mi id="S2.SS1.p1.2.m2.1.4.2.2">v</mi><mn id="S2.SS1.p1.2.m2.1.4.2.3">1</mn></msub><mo id="S2.SS1.p1.2.m2.1.4.3">,</mo><msub id="S2.SS1.p1.2.m2.1.4.4"><mi id="S2.SS1.p1.2.m2.1.4.4.2">v</mi><mn id="S2.SS1.p1.2.m2.1.4.4.3">2</mn></msub><mo id="S2.SS1.p1.2.m2.1.4.5">,</mo><mi id="S2.SS1.p1.2.m2.1.1" mathvariant="normal">…</mi><mo id="S2.SS1.p1.2.m2.1.4.6">,</mo><msub id="S2.SS1.p1.2.m2.1.4.7"><mi id="S2.SS1.p1.2.m2.1.4.7.2">v</mi><mrow id="S2.SS1.p1.2.m2.1.4.7.3"><mo fence="false" id="S2.SS1.p1.2.m2.1.4.7.3.1" rspace="0.167em" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.1.4.7.3.2">𝒱</mi></mrow></msub><mo fence="false" id="S2.SS1.p1.2.m2.1.4.8" rspace="0.167em" stretchy="false">|</mo><mo id="S2.SS1.p1.2.m2.1.4.9" stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\mathcal{V}=\{v_{1},v_{2},...,v_{|\mathcal{V}}|\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">caligraphic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT | caligraphic_V end_POSTSUBSCRIPT | }</annotation></semantics></math> be the sets of users and items, respectively.
Each user <math alttext="u_{k}\in\mathcal{U}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><msub id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2.2" xref="S2.SS1.p1.3.m3.1.1.2.2.cmml">u</mi><mi id="S2.SS1.p1.3.m3.1.1.2.3" xref="S2.SS1.p1.3.m3.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS1.p1.3.m3.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><in id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1"></in><apply id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2.2">𝑢</ci><ci id="S2.SS1.p1.3.m3.1.1.2.3.cmml" xref="S2.SS1.p1.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">u_{k}\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ caligraphic_U</annotation></semantics></math> is characterised by a chronologically ordered sequence <math alttext="\mathcal{S}_{k}=[v^{u_{k}}_{1},...,v^{u_{k}}_{t},...,v^{u_{k}}_{L_{k}}]" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.5"><semantics id="S2.SS1.p1.4.m4.5a"><mrow id="S2.SS1.p1.4.m4.5.5" xref="S2.SS1.p1.4.m4.5.5.cmml"><msub id="S2.SS1.p1.4.m4.5.5.5" xref="S2.SS1.p1.4.m4.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.5.5.5.2" xref="S2.SS1.p1.4.m4.5.5.5.2.cmml">𝒮</mi><mi id="S2.SS1.p1.4.m4.5.5.5.3" xref="S2.SS1.p1.4.m4.5.5.5.3.cmml">k</mi></msub><mo id="S2.SS1.p1.4.m4.5.5.4" xref="S2.SS1.p1.4.m4.5.5.4.cmml">=</mo><mrow id="S2.SS1.p1.4.m4.5.5.3.3" xref="S2.SS1.p1.4.m4.5.5.3.4.cmml"><mo id="S2.SS1.p1.4.m4.5.5.3.3.4" stretchy="false" xref="S2.SS1.p1.4.m4.5.5.3.4.cmml">[</mo><msubsup id="S2.SS1.p1.4.m4.3.3.1.1.1" xref="S2.SS1.p1.4.m4.3.3.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.3.3.1.1.1.2.2" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.2.cmml">v</mi><mn id="S2.SS1.p1.4.m4.3.3.1.1.1.3" xref="S2.SS1.p1.4.m4.3.3.1.1.1.3.cmml">1</mn><msub id="S2.SS1.p1.4.m4.3.3.1.1.1.2.3" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.cmml"><mi id="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.2" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.2.cmml">u</mi><mi id="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.3" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.4.m4.5.5.3.3.5" xref="S2.SS1.p1.4.m4.5.5.3.4.cmml">,</mo><mi id="S2.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS1.p1.4.m4.5.5.3.3.6" xref="S2.SS1.p1.4.m4.5.5.3.4.cmml">,</mo><msubsup id="S2.SS1.p1.4.m4.4.4.2.2.2" xref="S2.SS1.p1.4.m4.4.4.2.2.2.cmml"><mi id="S2.SS1.p1.4.m4.4.4.2.2.2.2.2" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.2.cmml">v</mi><mi id="S2.SS1.p1.4.m4.4.4.2.2.2.3" xref="S2.SS1.p1.4.m4.4.4.2.2.2.3.cmml">t</mi><msub id="S2.SS1.p1.4.m4.4.4.2.2.2.2.3" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.cmml"><mi id="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.2" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.2.cmml">u</mi><mi id="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.3" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.4.m4.5.5.3.3.7" xref="S2.SS1.p1.4.m4.5.5.3.4.cmml">,</mo><mi id="S2.SS1.p1.4.m4.2.2" mathvariant="normal" xref="S2.SS1.p1.4.m4.2.2.cmml">…</mi><mo id="S2.SS1.p1.4.m4.5.5.3.3.8" xref="S2.SS1.p1.4.m4.5.5.3.4.cmml">,</mo><msubsup id="S2.SS1.p1.4.m4.5.5.3.3.3" xref="S2.SS1.p1.4.m4.5.5.3.3.3.cmml"><mi id="S2.SS1.p1.4.m4.5.5.3.3.3.2.2" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.2.cmml">v</mi><msub id="S2.SS1.p1.4.m4.5.5.3.3.3.3" xref="S2.SS1.p1.4.m4.5.5.3.3.3.3.cmml"><mi id="S2.SS1.p1.4.m4.5.5.3.3.3.3.2" xref="S2.SS1.p1.4.m4.5.5.3.3.3.3.2.cmml">L</mi><mi id="S2.SS1.p1.4.m4.5.5.3.3.3.3.3" xref="S2.SS1.p1.4.m4.5.5.3.3.3.3.3.cmml">k</mi></msub><msub id="S2.SS1.p1.4.m4.5.5.3.3.3.2.3" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.cmml"><mi id="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.2" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.2.cmml">u</mi><mi id="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.3" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.4.m4.5.5.3.3.9" stretchy="false" xref="S2.SS1.p1.4.m4.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.5b"><apply id="S2.SS1.p1.4.m4.5.5.cmml" xref="S2.SS1.p1.4.m4.5.5"><eq id="S2.SS1.p1.4.m4.5.5.4.cmml" xref="S2.SS1.p1.4.m4.5.5.4"></eq><apply id="S2.SS1.p1.4.m4.5.5.5.cmml" xref="S2.SS1.p1.4.m4.5.5.5"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.5.5.5.1.cmml" xref="S2.SS1.p1.4.m4.5.5.5">subscript</csymbol><ci id="S2.SS1.p1.4.m4.5.5.5.2.cmml" xref="S2.SS1.p1.4.m4.5.5.5.2">𝒮</ci><ci id="S2.SS1.p1.4.m4.5.5.5.3.cmml" xref="S2.SS1.p1.4.m4.5.5.5.3">𝑘</ci></apply><list id="S2.SS1.p1.4.m4.5.5.3.4.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3"><apply id="S2.SS1.p1.4.m4.3.3.1.1.1.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1">subscript</csymbol><apply id="S2.SS1.p1.4.m4.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.1.1.1.2.1.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.1.1.1.2.2.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.2">𝑣</ci><apply id="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.1.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.3">subscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.2.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.2">𝑢</ci><ci id="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.3.cmml" xref="S2.SS1.p1.4.m4.3.3.1.1.1.2.3.3">𝑘</ci></apply></apply><cn id="S2.SS1.p1.4.m4.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.3.3.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">…</ci><apply id="S2.SS1.p1.4.m4.4.4.2.2.2.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2">subscript</csymbol><apply id="S2.SS1.p1.4.m4.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.4.4.2.2.2.2.1.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.4.m4.4.4.2.2.2.2.2.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.2">𝑣</ci><apply id="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.1.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.2.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.2">𝑢</ci><ci id="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.3.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2.2.3.3">𝑘</ci></apply></apply><ci id="S2.SS1.p1.4.m4.4.4.2.2.2.3.cmml" xref="S2.SS1.p1.4.m4.4.4.2.2.2.3">𝑡</ci></apply><ci id="S2.SS1.p1.4.m4.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2">…</ci><apply id="S2.SS1.p1.4.m4.5.5.3.3.3.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.5.5.3.3.3.1.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3">subscript</csymbol><apply id="S2.SS1.p1.4.m4.5.5.3.3.3.2.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.5.5.3.3.3.2.1.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3">superscript</csymbol><ci id="S2.SS1.p1.4.m4.5.5.3.3.3.2.2.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.2">𝑣</ci><apply id="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.1.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.3">subscript</csymbol><ci id="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.2.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.2">𝑢</ci><ci id="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.3.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.4.m4.5.5.3.3.3.3.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.5.5.3.3.3.3.1.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.4.m4.5.5.3.3.3.3.2.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.3.2">𝐿</ci><ci id="S2.SS1.p1.4.m4.5.5.3.3.3.3.3.cmml" xref="S2.SS1.p1.4.m4.5.5.3.3.3.3.3">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.5c">\mathcal{S}_{k}=[v^{u_{k}}_{1},...,v^{u_{k}}_{t},...,v^{u_{k}}_{L_{k}}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.5d">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = [ italic_v start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , … , italic_v start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>,
where <math alttext="v^{u_{k}}_{t}\in\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mrow id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><msubsup id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2.2.2" xref="S2.SS1.p1.5.m5.1.1.2.2.2.cmml">v</mi><mi id="S2.SS1.p1.5.m5.1.1.2.3" xref="S2.SS1.p1.5.m5.1.1.2.3.cmml">t</mi><msub id="S2.SS1.p1.5.m5.1.1.2.2.3" xref="S2.SS1.p1.5.m5.1.1.2.2.3.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2.2.3.2" xref="S2.SS1.p1.5.m5.1.1.2.2.3.2.cmml">u</mi><mi id="S2.SS1.p1.5.m5.1.1.2.2.3.3" xref="S2.SS1.p1.5.m5.1.1.2.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.5.m5.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><in id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1"></in><apply id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.2.1.cmml" xref="S2.SS1.p1.5.m5.1.1.2">subscript</csymbol><apply id="S2.SS1.p1.5.m5.1.1.2.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.2.2.1.cmml" xref="S2.SS1.p1.5.m5.1.1.2">superscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.2.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2.2.2">𝑣</ci><apply id="S2.SS1.p1.5.m5.1.1.2.2.3.cmml" xref="S2.SS1.p1.5.m5.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.2.2.3.1.cmml" xref="S2.SS1.p1.5.m5.1.1.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.2.3.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2.2.3.2">𝑢</ci><ci id="S2.SS1.p1.5.m5.1.1.2.2.3.3.cmml" xref="S2.SS1.p1.5.m5.1.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S2.SS1.p1.5.m5.1.1.2.3.cmml" xref="S2.SS1.p1.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">v^{u_{k}}_{t}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_v start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_V</annotation></semantics></math> represents the item that <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">u</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝑢</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> has interacted with at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_t</annotation></semantics></math>, and <math alttext="L_{k}&gt;1" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mrow id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><msub id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml"><mi id="S2.SS1.p1.8.m8.1.1.2.2" xref="S2.SS1.p1.8.m8.1.1.2.2.cmml">L</mi><mi id="S2.SS1.p1.8.m8.1.1.2.3" xref="S2.SS1.p1.8.m8.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS1.p1.8.m8.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.cmml">&gt;</mo><mn id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><gt id="S2.SS1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1"></gt><apply id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.2.1.cmml" xref="S2.SS1.p1.8.m8.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.2.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2.2">𝐿</ci><ci id="S2.SS1.p1.8.m8.1.1.2.3.cmml" xref="S2.SS1.p1.8.m8.1.1.2.3">𝑘</ci></apply><cn id="S2.SS1.p1.8.m8.1.1.3.cmml" type="integer" xref="S2.SS1.p1.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">L_{k}&gt;1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT &gt; 1</annotation></semantics></math> denotes the interaction sequence length for user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><msub id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">u</mi><mi id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">𝑢</ci><ci id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, which may vary from user to user.
Notably, for typical sequential recommendation methods, the input sequence length will be uniformed into a fixed hyper-parameter <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><mi id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><ci id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">italic_L</annotation></semantics></math> using the special padding token and truncation.
Specifically, if <math alttext="L_{k}&lt;L" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><mrow id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><msub id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2.2" xref="S2.SS1.p1.11.m11.1.1.2.2.cmml">L</mi><mi id="S2.SS1.p1.11.m11.1.1.2.3" xref="S2.SS1.p1.11.m11.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS1.p1.11.m11.1.1.1" xref="S2.SS1.p1.11.m11.1.1.1.cmml">&lt;</mo><mi id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><lt id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1.1"></lt><apply id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.2.1.cmml" xref="S2.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2.2">𝐿</ci><ci id="S2.SS1.p1.11.m11.1.1.2.3.cmml" xref="S2.SS1.p1.11.m11.1.1.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">L_{k}&lt;L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT &lt; italic_L</annotation></semantics></math>, the sequence is modified to <math alttext="S_{k}^{L}=[pad,...,pad,v^{u_{k}}_{1},...,v^{u_{k}}_{L_{k}}]" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m12.6"><semantics id="S2.SS1.p1.12.m12.6a"><mrow id="S2.SS1.p1.12.m12.6.6" xref="S2.SS1.p1.12.m12.6.6.cmml"><msubsup id="S2.SS1.p1.12.m12.6.6.6" xref="S2.SS1.p1.12.m12.6.6.6.cmml"><mi id="S2.SS1.p1.12.m12.6.6.6.2.2" xref="S2.SS1.p1.12.m12.6.6.6.2.2.cmml">S</mi><mi id="S2.SS1.p1.12.m12.6.6.6.2.3" xref="S2.SS1.p1.12.m12.6.6.6.2.3.cmml">k</mi><mi id="S2.SS1.p1.12.m12.6.6.6.3" xref="S2.SS1.p1.12.m12.6.6.6.3.cmml">L</mi></msubsup><mo id="S2.SS1.p1.12.m12.6.6.5" xref="S2.SS1.p1.12.m12.6.6.5.cmml">=</mo><mrow id="S2.SS1.p1.12.m12.6.6.4.4" xref="S2.SS1.p1.12.m12.6.6.4.5.cmml"><mo id="S2.SS1.p1.12.m12.6.6.4.4.5" stretchy="false" xref="S2.SS1.p1.12.m12.6.6.4.5.cmml">[</mo><mrow id="S2.SS1.p1.12.m12.3.3.1.1.1" xref="S2.SS1.p1.12.m12.3.3.1.1.1.cmml"><mi id="S2.SS1.p1.12.m12.3.3.1.1.1.2" xref="S2.SS1.p1.12.m12.3.3.1.1.1.2.cmml">p</mi><mo id="S2.SS1.p1.12.m12.3.3.1.1.1.1" xref="S2.SS1.p1.12.m12.3.3.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p1.12.m12.3.3.1.1.1.3" xref="S2.SS1.p1.12.m12.3.3.1.1.1.3.cmml">a</mi><mo id="S2.SS1.p1.12.m12.3.3.1.1.1.1a" xref="S2.SS1.p1.12.m12.3.3.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p1.12.m12.3.3.1.1.1.4" xref="S2.SS1.p1.12.m12.3.3.1.1.1.4.cmml">d</mi></mrow><mo id="S2.SS1.p1.12.m12.6.6.4.4.6" xref="S2.SS1.p1.12.m12.6.6.4.5.cmml">,</mo><mi id="S2.SS1.p1.12.m12.1.1" mathvariant="normal" xref="S2.SS1.p1.12.m12.1.1.cmml">…</mi><mo id="S2.SS1.p1.12.m12.6.6.4.4.7" xref="S2.SS1.p1.12.m12.6.6.4.5.cmml">,</mo><mrow id="S2.SS1.p1.12.m12.4.4.2.2.2" xref="S2.SS1.p1.12.m12.4.4.2.2.2.cmml"><mi id="S2.SS1.p1.12.m12.4.4.2.2.2.2" xref="S2.SS1.p1.12.m12.4.4.2.2.2.2.cmml">p</mi><mo id="S2.SS1.p1.12.m12.4.4.2.2.2.1" xref="S2.SS1.p1.12.m12.4.4.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.p1.12.m12.4.4.2.2.2.3" xref="S2.SS1.p1.12.m12.4.4.2.2.2.3.cmml">a</mi><mo id="S2.SS1.p1.12.m12.4.4.2.2.2.1a" xref="S2.SS1.p1.12.m12.4.4.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.p1.12.m12.4.4.2.2.2.4" xref="S2.SS1.p1.12.m12.4.4.2.2.2.4.cmml">d</mi></mrow><mo id="S2.SS1.p1.12.m12.6.6.4.4.8" xref="S2.SS1.p1.12.m12.6.6.4.5.cmml">,</mo><msubsup id="S2.SS1.p1.12.m12.5.5.3.3.3" xref="S2.SS1.p1.12.m12.5.5.3.3.3.cmml"><mi id="S2.SS1.p1.12.m12.5.5.3.3.3.2.2" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.2.cmml">v</mi><mn id="S2.SS1.p1.12.m12.5.5.3.3.3.3" xref="S2.SS1.p1.12.m12.5.5.3.3.3.3.cmml">1</mn><msub id="S2.SS1.p1.12.m12.5.5.3.3.3.2.3" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.cmml"><mi id="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.2" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.2.cmml">u</mi><mi id="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.3" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.12.m12.6.6.4.4.9" xref="S2.SS1.p1.12.m12.6.6.4.5.cmml">,</mo><mi id="S2.SS1.p1.12.m12.2.2" mathvariant="normal" xref="S2.SS1.p1.12.m12.2.2.cmml">…</mi><mo id="S2.SS1.p1.12.m12.6.6.4.4.10" xref="S2.SS1.p1.12.m12.6.6.4.5.cmml">,</mo><msubsup id="S2.SS1.p1.12.m12.6.6.4.4.4" xref="S2.SS1.p1.12.m12.6.6.4.4.4.cmml"><mi id="S2.SS1.p1.12.m12.6.6.4.4.4.2.2" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.2.cmml">v</mi><msub id="S2.SS1.p1.12.m12.6.6.4.4.4.3" xref="S2.SS1.p1.12.m12.6.6.4.4.4.3.cmml"><mi id="S2.SS1.p1.12.m12.6.6.4.4.4.3.2" xref="S2.SS1.p1.12.m12.6.6.4.4.4.3.2.cmml">L</mi><mi id="S2.SS1.p1.12.m12.6.6.4.4.4.3.3" xref="S2.SS1.p1.12.m12.6.6.4.4.4.3.3.cmml">k</mi></msub><msub id="S2.SS1.p1.12.m12.6.6.4.4.4.2.3" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.cmml"><mi id="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.2" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.2.cmml">u</mi><mi id="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.3" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.12.m12.6.6.4.4.11" stretchy="false" xref="S2.SS1.p1.12.m12.6.6.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.6b"><apply id="S2.SS1.p1.12.m12.6.6.cmml" xref="S2.SS1.p1.12.m12.6.6"><eq id="S2.SS1.p1.12.m12.6.6.5.cmml" xref="S2.SS1.p1.12.m12.6.6.5"></eq><apply id="S2.SS1.p1.12.m12.6.6.6.cmml" xref="S2.SS1.p1.12.m12.6.6.6"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.6.6.6.1.cmml" xref="S2.SS1.p1.12.m12.6.6.6">superscript</csymbol><apply id="S2.SS1.p1.12.m12.6.6.6.2.cmml" xref="S2.SS1.p1.12.m12.6.6.6"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.6.6.6.2.1.cmml" xref="S2.SS1.p1.12.m12.6.6.6">subscript</csymbol><ci id="S2.SS1.p1.12.m12.6.6.6.2.2.cmml" xref="S2.SS1.p1.12.m12.6.6.6.2.2">𝑆</ci><ci id="S2.SS1.p1.12.m12.6.6.6.2.3.cmml" xref="S2.SS1.p1.12.m12.6.6.6.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.12.m12.6.6.6.3.cmml" xref="S2.SS1.p1.12.m12.6.6.6.3">𝐿</ci></apply><list id="S2.SS1.p1.12.m12.6.6.4.5.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4"><apply id="S2.SS1.p1.12.m12.3.3.1.1.1.cmml" xref="S2.SS1.p1.12.m12.3.3.1.1.1"><times id="S2.SS1.p1.12.m12.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.12.m12.3.3.1.1.1.1"></times><ci id="S2.SS1.p1.12.m12.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.12.m12.3.3.1.1.1.2">𝑝</ci><ci id="S2.SS1.p1.12.m12.3.3.1.1.1.3.cmml" xref="S2.SS1.p1.12.m12.3.3.1.1.1.3">𝑎</ci><ci id="S2.SS1.p1.12.m12.3.3.1.1.1.4.cmml" xref="S2.SS1.p1.12.m12.3.3.1.1.1.4">𝑑</ci></apply><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">…</ci><apply id="S2.SS1.p1.12.m12.4.4.2.2.2.cmml" xref="S2.SS1.p1.12.m12.4.4.2.2.2"><times id="S2.SS1.p1.12.m12.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.12.m12.4.4.2.2.2.1"></times><ci id="S2.SS1.p1.12.m12.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.12.m12.4.4.2.2.2.2">𝑝</ci><ci id="S2.SS1.p1.12.m12.4.4.2.2.2.3.cmml" xref="S2.SS1.p1.12.m12.4.4.2.2.2.3">𝑎</ci><ci id="S2.SS1.p1.12.m12.4.4.2.2.2.4.cmml" xref="S2.SS1.p1.12.m12.4.4.2.2.2.4">𝑑</ci></apply><apply id="S2.SS1.p1.12.m12.5.5.3.3.3.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.5.5.3.3.3.1.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3">subscript</csymbol><apply id="S2.SS1.p1.12.m12.5.5.3.3.3.2.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.5.5.3.3.3.2.1.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3">superscript</csymbol><ci id="S2.SS1.p1.12.m12.5.5.3.3.3.2.2.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.2">𝑣</ci><apply id="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.1.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.3">subscript</csymbol><ci id="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.2.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.2">𝑢</ci><ci id="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.3.cmml" xref="S2.SS1.p1.12.m12.5.5.3.3.3.2.3.3">𝑘</ci></apply></apply><cn id="S2.SS1.p1.12.m12.5.5.3.3.3.3.cmml" type="integer" xref="S2.SS1.p1.12.m12.5.5.3.3.3.3">1</cn></apply><ci id="S2.SS1.p1.12.m12.2.2.cmml" xref="S2.SS1.p1.12.m12.2.2">…</ci><apply id="S2.SS1.p1.12.m12.6.6.4.4.4.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.6.6.4.4.4.1.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4">subscript</csymbol><apply id="S2.SS1.p1.12.m12.6.6.4.4.4.2.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.6.6.4.4.4.2.1.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4">superscript</csymbol><ci id="S2.SS1.p1.12.m12.6.6.4.4.4.2.2.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.2">𝑣</ci><apply id="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.1.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.3">subscript</csymbol><ci id="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.2.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.2">𝑢</ci><ci id="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.3.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.12.m12.6.6.4.4.4.3.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.6.6.4.4.4.3.1.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.3">subscript</csymbol><ci id="S2.SS1.p1.12.m12.6.6.4.4.4.3.2.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.3.2">𝐿</ci><ci id="S2.SS1.p1.12.m12.6.6.4.4.4.3.3.cmml" xref="S2.SS1.p1.12.m12.6.6.4.4.4.3.3">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.6c">S_{k}^{L}=[pad,...,pad,v^{u_{k}}_{1},...,v^{u_{k}}_{L_{k}}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.6d">italic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT = [ italic_p italic_a italic_d , … , italic_p italic_a italic_d , italic_v start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>, with the number of padding instances equal to <math alttext="(L-L_{k})" class="ltx_Math" display="inline" id="S2.SS1.p1.13.m13.1"><semantics id="S2.SS1.p1.13.m13.1a"><mrow id="S2.SS1.p1.13.m13.1.1.1" xref="S2.SS1.p1.13.m13.1.1.1.1.cmml"><mo id="S2.SS1.p1.13.m13.1.1.1.2" stretchy="false" xref="S2.SS1.p1.13.m13.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.13.m13.1.1.1.1" xref="S2.SS1.p1.13.m13.1.1.1.1.cmml"><mi id="S2.SS1.p1.13.m13.1.1.1.1.2" xref="S2.SS1.p1.13.m13.1.1.1.1.2.cmml">L</mi><mo id="S2.SS1.p1.13.m13.1.1.1.1.1" xref="S2.SS1.p1.13.m13.1.1.1.1.1.cmml">−</mo><msub id="S2.SS1.p1.13.m13.1.1.1.1.3" xref="S2.SS1.p1.13.m13.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.13.m13.1.1.1.1.3.2" xref="S2.SS1.p1.13.m13.1.1.1.1.3.2.cmml">L</mi><mi id="S2.SS1.p1.13.m13.1.1.1.1.3.3" xref="S2.SS1.p1.13.m13.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S2.SS1.p1.13.m13.1.1.1.3" stretchy="false" xref="S2.SS1.p1.13.m13.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><apply id="S2.SS1.p1.13.m13.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1.1"><minus id="S2.SS1.p1.13.m13.1.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1.1.1.1"></minus><ci id="S2.SS1.p1.13.m13.1.1.1.1.2.cmml" xref="S2.SS1.p1.13.m13.1.1.1.1.2">𝐿</ci><apply id="S2.SS1.p1.13.m13.1.1.1.1.3.cmml" xref="S2.SS1.p1.13.m13.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.13.m13.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.13.m13.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.13.m13.1.1.1.1.3.2">𝐿</ci><ci id="S2.SS1.p1.13.m13.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.13.m13.1.1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">(L-L_{k})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.13.m13.1d">( italic_L - italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>.
In contrast, if <math alttext="L_{k}&gt;L" class="ltx_Math" display="inline" id="S2.SS1.p1.14.m14.1"><semantics id="S2.SS1.p1.14.m14.1a"><mrow id="S2.SS1.p1.14.m14.1.1" xref="S2.SS1.p1.14.m14.1.1.cmml"><msub id="S2.SS1.p1.14.m14.1.1.2" xref="S2.SS1.p1.14.m14.1.1.2.cmml"><mi id="S2.SS1.p1.14.m14.1.1.2.2" xref="S2.SS1.p1.14.m14.1.1.2.2.cmml">L</mi><mi id="S2.SS1.p1.14.m14.1.1.2.3" xref="S2.SS1.p1.14.m14.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS1.p1.14.m14.1.1.1" xref="S2.SS1.p1.14.m14.1.1.1.cmml">&gt;</mo><mi id="S2.SS1.p1.14.m14.1.1.3" xref="S2.SS1.p1.14.m14.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m14.1b"><apply id="S2.SS1.p1.14.m14.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1"><gt id="S2.SS1.p1.14.m14.1.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1.1"></gt><apply id="S2.SS1.p1.14.m14.1.1.2.cmml" xref="S2.SS1.p1.14.m14.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m14.1.1.2.1.cmml" xref="S2.SS1.p1.14.m14.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.14.m14.1.1.2.2.cmml" xref="S2.SS1.p1.14.m14.1.1.2.2">𝐿</ci><ci id="S2.SS1.p1.14.m14.1.1.2.3.cmml" xref="S2.SS1.p1.14.m14.1.1.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.14.m14.1.1.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m14.1c">L_{k}&gt;L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.14.m14.1d">italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT &gt; italic_L</annotation></semantics></math>, the sequence is truncated into <math alttext="S_{k}^{L}=[v^{u_{k}}_{(L_{k}-L)},...,v^{u_{k}}_{L_{k}}]" class="ltx_Math" display="inline" id="S2.SS1.p1.15.m15.4"><semantics id="S2.SS1.p1.15.m15.4a"><mrow id="S2.SS1.p1.15.m15.4.4" xref="S2.SS1.p1.15.m15.4.4.cmml"><msubsup id="S2.SS1.p1.15.m15.4.4.4" xref="S2.SS1.p1.15.m15.4.4.4.cmml"><mi id="S2.SS1.p1.15.m15.4.4.4.2.2" xref="S2.SS1.p1.15.m15.4.4.4.2.2.cmml">S</mi><mi id="S2.SS1.p1.15.m15.4.4.4.2.3" xref="S2.SS1.p1.15.m15.4.4.4.2.3.cmml">k</mi><mi id="S2.SS1.p1.15.m15.4.4.4.3" xref="S2.SS1.p1.15.m15.4.4.4.3.cmml">L</mi></msubsup><mo id="S2.SS1.p1.15.m15.4.4.3" xref="S2.SS1.p1.15.m15.4.4.3.cmml">=</mo><mrow id="S2.SS1.p1.15.m15.4.4.2.2" xref="S2.SS1.p1.15.m15.4.4.2.3.cmml"><mo id="S2.SS1.p1.15.m15.4.4.2.2.3" stretchy="false" xref="S2.SS1.p1.15.m15.4.4.2.3.cmml">[</mo><msubsup id="S2.SS1.p1.15.m15.3.3.1.1.1" xref="S2.SS1.p1.15.m15.3.3.1.1.1.cmml"><mi id="S2.SS1.p1.15.m15.3.3.1.1.1.2.2" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.2.cmml">v</mi><mrow id="S2.SS1.p1.15.m15.1.1.1.1" xref="S2.SS1.p1.15.m15.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.15.m15.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.15.m15.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.15.m15.1.1.1.1.1" xref="S2.SS1.p1.15.m15.1.1.1.1.1.cmml"><msub id="S2.SS1.p1.15.m15.1.1.1.1.1.2" xref="S2.SS1.p1.15.m15.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.15.m15.1.1.1.1.1.2.2" xref="S2.SS1.p1.15.m15.1.1.1.1.1.2.2.cmml">L</mi><mi id="S2.SS1.p1.15.m15.1.1.1.1.1.2.3" xref="S2.SS1.p1.15.m15.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS1.p1.15.m15.1.1.1.1.1.1" xref="S2.SS1.p1.15.m15.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS1.p1.15.m15.1.1.1.1.1.3" xref="S2.SS1.p1.15.m15.1.1.1.1.1.3.cmml">L</mi></mrow><mo id="S2.SS1.p1.15.m15.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.15.m15.1.1.1.1.1.cmml">)</mo></mrow><msub id="S2.SS1.p1.15.m15.3.3.1.1.1.2.3" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.cmml"><mi id="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.2" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.2.cmml">u</mi><mi id="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.3" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.15.m15.4.4.2.2.4" xref="S2.SS1.p1.15.m15.4.4.2.3.cmml">,</mo><mi id="S2.SS1.p1.15.m15.2.2" mathvariant="normal" xref="S2.SS1.p1.15.m15.2.2.cmml">…</mi><mo id="S2.SS1.p1.15.m15.4.4.2.2.5" xref="S2.SS1.p1.15.m15.4.4.2.3.cmml">,</mo><msubsup id="S2.SS1.p1.15.m15.4.4.2.2.2" xref="S2.SS1.p1.15.m15.4.4.2.2.2.cmml"><mi id="S2.SS1.p1.15.m15.4.4.2.2.2.2.2" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.2.cmml">v</mi><msub id="S2.SS1.p1.15.m15.4.4.2.2.2.3" xref="S2.SS1.p1.15.m15.4.4.2.2.2.3.cmml"><mi id="S2.SS1.p1.15.m15.4.4.2.2.2.3.2" xref="S2.SS1.p1.15.m15.4.4.2.2.2.3.2.cmml">L</mi><mi id="S2.SS1.p1.15.m15.4.4.2.2.2.3.3" xref="S2.SS1.p1.15.m15.4.4.2.2.2.3.3.cmml">k</mi></msub><msub id="S2.SS1.p1.15.m15.4.4.2.2.2.2.3" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.cmml"><mi id="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.2" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.2.cmml">u</mi><mi id="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.3" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS1.p1.15.m15.4.4.2.2.6" stretchy="false" xref="S2.SS1.p1.15.m15.4.4.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m15.4b"><apply id="S2.SS1.p1.15.m15.4.4.cmml" xref="S2.SS1.p1.15.m15.4.4"><eq id="S2.SS1.p1.15.m15.4.4.3.cmml" xref="S2.SS1.p1.15.m15.4.4.3"></eq><apply id="S2.SS1.p1.15.m15.4.4.4.cmml" xref="S2.SS1.p1.15.m15.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.4.4.4.1.cmml" xref="S2.SS1.p1.15.m15.4.4.4">superscript</csymbol><apply id="S2.SS1.p1.15.m15.4.4.4.2.cmml" xref="S2.SS1.p1.15.m15.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.4.4.4.2.1.cmml" xref="S2.SS1.p1.15.m15.4.4.4">subscript</csymbol><ci id="S2.SS1.p1.15.m15.4.4.4.2.2.cmml" xref="S2.SS1.p1.15.m15.4.4.4.2.2">𝑆</ci><ci id="S2.SS1.p1.15.m15.4.4.4.2.3.cmml" xref="S2.SS1.p1.15.m15.4.4.4.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.15.m15.4.4.4.3.cmml" xref="S2.SS1.p1.15.m15.4.4.4.3">𝐿</ci></apply><list id="S2.SS1.p1.15.m15.4.4.2.3.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2"><apply id="S2.SS1.p1.15.m15.3.3.1.1.1.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1">subscript</csymbol><apply id="S2.SS1.p1.15.m15.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.3.3.1.1.1.2.1.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.15.m15.3.3.1.1.1.2.2.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.2">𝑣</ci><apply id="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.1.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.3">subscript</csymbol><ci id="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.2.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.2">𝑢</ci><ci id="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.3.cmml" xref="S2.SS1.p1.15.m15.3.3.1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.15.m15.1.1.1.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1.1.1"><minus id="S2.SS1.p1.15.m15.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1.1.1.1.1"></minus><apply id="S2.SS1.p1.15.m15.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.15.m15.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.15.m15.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.15.m15.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.15.m15.1.1.1.1.1.2.2">𝐿</ci><ci id="S2.SS1.p1.15.m15.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.15.m15.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.15.m15.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.15.m15.1.1.1.1.1.3">𝐿</ci></apply></apply><ci id="S2.SS1.p1.15.m15.2.2.cmml" xref="S2.SS1.p1.15.m15.2.2">…</ci><apply id="S2.SS1.p1.15.m15.4.4.2.2.2.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2">subscript</csymbol><apply id="S2.SS1.p1.15.m15.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.4.4.2.2.2.2.1.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.15.m15.4.4.2.2.2.2.2.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.2">𝑣</ci><apply id="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.1.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.2.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.2">𝑢</ci><ci id="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.3.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.15.m15.4.4.2.2.2.3.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.4.4.2.2.2.3.1.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.15.m15.4.4.2.2.2.3.2.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.3.2">𝐿</ci><ci id="S2.SS1.p1.15.m15.4.4.2.2.2.3.3.cmml" xref="S2.SS1.p1.15.m15.4.4.2.2.2.3.3">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m15.4c">S_{k}^{L}=[v^{u_{k}}_{(L_{k}-L)},...,v^{u_{k}}_{L_{k}}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.15.m15.4d">italic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT = [ italic_v start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_L ) end_POSTSUBSCRIPT , … , italic_v start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>.
To represent items efficiently, it is common practice to use an embedding table <math alttext="\mathcal{Q}=\{\mathbf{q}_{1},\mathbf{q}_{2},...,\mathbf{q}_{|\mathcal{V}|}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.16.m16.5"><semantics id="S2.SS1.p1.16.m16.5a"><mrow id="S2.SS1.p1.16.m16.5.5" xref="S2.SS1.p1.16.m16.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.16.m16.5.5.5" xref="S2.SS1.p1.16.m16.5.5.5.cmml">𝒬</mi><mo id="S2.SS1.p1.16.m16.5.5.4" xref="S2.SS1.p1.16.m16.5.5.4.cmml">=</mo><mrow id="S2.SS1.p1.16.m16.5.5.3.3" xref="S2.SS1.p1.16.m16.5.5.3.4.cmml"><mo id="S2.SS1.p1.16.m16.5.5.3.3.4" stretchy="false" xref="S2.SS1.p1.16.m16.5.5.3.4.cmml">{</mo><msub id="S2.SS1.p1.16.m16.3.3.1.1.1" xref="S2.SS1.p1.16.m16.3.3.1.1.1.cmml"><mi id="S2.SS1.p1.16.m16.3.3.1.1.1.2" xref="S2.SS1.p1.16.m16.3.3.1.1.1.2.cmml">𝐪</mi><mn id="S2.SS1.p1.16.m16.3.3.1.1.1.3" xref="S2.SS1.p1.16.m16.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.16.m16.5.5.3.3.5" xref="S2.SS1.p1.16.m16.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.16.m16.4.4.2.2.2" xref="S2.SS1.p1.16.m16.4.4.2.2.2.cmml"><mi id="S2.SS1.p1.16.m16.4.4.2.2.2.2" xref="S2.SS1.p1.16.m16.4.4.2.2.2.2.cmml">𝐪</mi><mn id="S2.SS1.p1.16.m16.4.4.2.2.2.3" xref="S2.SS1.p1.16.m16.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.16.m16.5.5.3.3.6" xref="S2.SS1.p1.16.m16.5.5.3.4.cmml">,</mo><mi id="S2.SS1.p1.16.m16.2.2" mathvariant="normal" xref="S2.SS1.p1.16.m16.2.2.cmml">…</mi><mo id="S2.SS1.p1.16.m16.5.5.3.3.7" xref="S2.SS1.p1.16.m16.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.16.m16.5.5.3.3.3" xref="S2.SS1.p1.16.m16.5.5.3.3.3.cmml"><mi id="S2.SS1.p1.16.m16.5.5.3.3.3.2" xref="S2.SS1.p1.16.m16.5.5.3.3.3.2.cmml">𝐪</mi><mrow id="S2.SS1.p1.16.m16.1.1.1.3" xref="S2.SS1.p1.16.m16.1.1.1.2.cmml"><mo id="S2.SS1.p1.16.m16.1.1.1.3.1" stretchy="false" xref="S2.SS1.p1.16.m16.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.16.m16.1.1.1.1" xref="S2.SS1.p1.16.m16.1.1.1.1.cmml">𝒱</mi><mo id="S2.SS1.p1.16.m16.1.1.1.3.2" stretchy="false" xref="S2.SS1.p1.16.m16.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S2.SS1.p1.16.m16.5.5.3.3.8" stretchy="false" xref="S2.SS1.p1.16.m16.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m16.5b"><apply id="S2.SS1.p1.16.m16.5.5.cmml" xref="S2.SS1.p1.16.m16.5.5"><eq id="S2.SS1.p1.16.m16.5.5.4.cmml" xref="S2.SS1.p1.16.m16.5.5.4"></eq><ci id="S2.SS1.p1.16.m16.5.5.5.cmml" xref="S2.SS1.p1.16.m16.5.5.5">𝒬</ci><set id="S2.SS1.p1.16.m16.5.5.3.4.cmml" xref="S2.SS1.p1.16.m16.5.5.3.3"><apply id="S2.SS1.p1.16.m16.3.3.1.1.1.cmml" xref="S2.SS1.p1.16.m16.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.16.m16.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.16.m16.3.3.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.16.m16.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.16.m16.3.3.1.1.1.2">𝐪</ci><cn id="S2.SS1.p1.16.m16.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.16.m16.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.16.m16.4.4.2.2.2.cmml" xref="S2.SS1.p1.16.m16.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.16.m16.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.16.m16.4.4.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.16.m16.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.16.m16.4.4.2.2.2.2">𝐪</ci><cn id="S2.SS1.p1.16.m16.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.16.m16.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.16.m16.2.2.cmml" xref="S2.SS1.p1.16.m16.2.2">…</ci><apply id="S2.SS1.p1.16.m16.5.5.3.3.3.cmml" xref="S2.SS1.p1.16.m16.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.16.m16.5.5.3.3.3.1.cmml" xref="S2.SS1.p1.16.m16.5.5.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.16.m16.5.5.3.3.3.2.cmml" xref="S2.SS1.p1.16.m16.5.5.3.3.3.2">𝐪</ci><apply id="S2.SS1.p1.16.m16.1.1.1.2.cmml" xref="S2.SS1.p1.16.m16.1.1.1.3"><abs id="S2.SS1.p1.16.m16.1.1.1.2.1.cmml" xref="S2.SS1.p1.16.m16.1.1.1.3.1"></abs><ci id="S2.SS1.p1.16.m16.1.1.1.1.cmml" xref="S2.SS1.p1.16.m16.1.1.1.1">𝒱</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m16.5c">\mathcal{Q}=\{\mathbf{q}_{1},\mathbf{q}_{2},...,\mathbf{q}_{|\mathcal{V}|}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.16.m16.5d">caligraphic_Q = { bold_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_q start_POSTSUBSCRIPT | caligraphic_V | end_POSTSUBSCRIPT }</annotation></semantics></math> for the item base <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS1.p1.17.m17.1"><semantics id="S2.SS1.p1.17.m17.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.17.m17.1.1" xref="S2.SS1.p1.17.m17.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m17.1b"><ci id="S2.SS1.p1.17.m17.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m17.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.17.m17.1d">caligraphic_V</annotation></semantics></math>, where <math alttext="\mathbf{q}_{j}" class="ltx_Math" display="inline" id="S2.SS1.p1.18.m18.1"><semantics id="S2.SS1.p1.18.m18.1a"><msub id="S2.SS1.p1.18.m18.1.1" xref="S2.SS1.p1.18.m18.1.1.cmml"><mi id="S2.SS1.p1.18.m18.1.1.2" xref="S2.SS1.p1.18.m18.1.1.2.cmml">𝐪</mi><mi id="S2.SS1.p1.18.m18.1.1.3" xref="S2.SS1.p1.18.m18.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m18.1b"><apply id="S2.SS1.p1.18.m18.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.1.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1">subscript</csymbol><ci id="S2.SS1.p1.18.m18.1.1.2.cmml" xref="S2.SS1.p1.18.m18.1.1.2">𝐪</ci><ci id="S2.SS1.p1.18.m18.1.1.3.cmml" xref="S2.SS1.p1.18.m18.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m18.1c">\mathbf{q}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.18.m18.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is a latent dense vector with dimensionality <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.p1.19.m19.1"><semantics id="S2.SS1.p1.19.m19.1a"><mi id="S2.SS1.p1.19.m19.1.1" xref="S2.SS1.p1.19.m19.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.19.m19.1b"><ci id="S2.SS1.p1.19.m19.1.1.cmml" xref="S2.SS1.p1.19.m19.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.19.m19.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.19.m19.1d">italic_d</annotation></semantics></math> for item <math alttext="v_{j}" class="ltx_Math" display="inline" id="S2.SS1.p1.20.m20.1"><semantics id="S2.SS1.p1.20.m20.1a"><msub id="S2.SS1.p1.20.m20.1.1" xref="S2.SS1.p1.20.m20.1.1.cmml"><mi id="S2.SS1.p1.20.m20.1.1.2" xref="S2.SS1.p1.20.m20.1.1.2.cmml">v</mi><mi id="S2.SS1.p1.20.m20.1.1.3" xref="S2.SS1.p1.20.m20.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.20.m20.1b"><apply id="S2.SS1.p1.20.m20.1.1.cmml" xref="S2.SS1.p1.20.m20.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.20.m20.1.1.1.cmml" xref="S2.SS1.p1.20.m20.1.1">subscript</csymbol><ci id="S2.SS1.p1.20.m20.1.1.2.cmml" xref="S2.SS1.p1.20.m20.1.1.2">𝑣</ci><ci id="S2.SS1.p1.20.m20.1.1.3.cmml" xref="S2.SS1.p1.20.m20.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.20.m20.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.20.m20.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.2">In general, a typical sequential recommendation method, denoted as <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S2.SS1.p2.2.1">SeqRec</span>, analyzes the input sequence to capture user preferences and computes item ranking scores by performing the inner product between the predicted user preference and item embeddings.
For user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><msub id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">u</mi><mi id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝑢</ci><ci id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, such a process can be formulated as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{p}}_{k}" class="ltx_Math" display="inline" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><msub id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mover accent="true" id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.2.2" xref="S2.E1.m1.1.1.2.2.cmml">𝐩</mi><mo id="S2.E1.m1.1.1.2.1" xref="S2.E1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1">subscript</csymbol><apply id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"><ci id="S2.E1.m1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.2.1">^</ci><ci id="S2.E1.m1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.2.2">𝐩</ci></apply><ci id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle\hat{\mathbf{p}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">over^ start_ARG bold_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\textbf{SeqRec}(\mathcal{S}^{L}_{k})," class="ltx_Math" display="inline" id="S2.E1.m2.1"><semantics id="S2.E1.m2.1a"><mrow id="S2.E1.m2.1.1.1" xref="S2.E1.m2.1.1.1.1.cmml"><mrow id="S2.E1.m2.1.1.1.1" xref="S2.E1.m2.1.1.1.1.cmml"><mi id="S2.E1.m2.1.1.1.1.3" xref="S2.E1.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E1.m2.1.1.1.1.2" xref="S2.E1.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E1.m2.1.1.1.1.1" xref="S2.E1.m2.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E1.m2.1.1.1.1.1.3" xref="S2.E1.m2.1.1.1.1.1.3a.cmml">SeqRec</mtext><mo id="S2.E1.m2.1.1.1.1.1.2" xref="S2.E1.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m2.1.1.1.1.1.1.1" xref="S2.E1.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m2.1.1.1.1.1.1.1.1" xref="S2.E1.m2.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m2.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝒮</mi><mi id="S2.E1.m2.1.1.1.1.1.1.1.1.3" xref="S2.E1.m2.1.1.1.1.1.1.1.1.3.cmml">k</mi><mi id="S2.E1.m2.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m2.1.1.1.1.1.1.1.1.2.3.cmml">L</mi></msubsup><mo id="S2.E1.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m2.1.1.1.2" xref="S2.E1.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m2.1b"><apply id="S2.E1.m2.1.1.1.1.cmml" xref="S2.E1.m2.1.1.1"><eq id="S2.E1.m2.1.1.1.1.2.cmml" xref="S2.E1.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E1.m2.1.1.1.1.3.cmml" xref="S2.E1.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E1.m2.1.1.1.1.1.cmml" xref="S2.E1.m2.1.1.1.1.1"><times id="S2.E1.m2.1.1.1.1.1.2.cmml" xref="S2.E1.m2.1.1.1.1.1.2"></times><ci id="S2.E1.m2.1.1.1.1.1.3a.cmml" xref="S2.E1.m2.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S2.E1.m2.1.1.1.1.1.3.cmml" xref="S2.E1.m2.1.1.1.1.1.3">SeqRec</mtext></ci><apply id="S2.E1.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E1.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E1.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m2.1.1.1.1.1.1.1.1.2.2">𝒮</ci><ci id="S2.E1.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m2.1.1.1.1.1.1.1.1.2.3">𝐿</ci></apply><ci id="S2.E1.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m2.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m2.1c">\displaystyle=\textbf{SeqRec}(\mathcal{S}^{L}_{k}),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m2.1d">= SeqRec ( caligraphic_S start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r_{k}" class="ltx_Math" display="inline" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><msub id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mi id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">r</mi><mi id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2">𝑟</ci><ci id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle r_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\hat{\mathbf{p}}_{k}\cdot\mathcal{Q}," class="ltx_Math" display="inline" id="S2.E2.m2.1"><semantics id="S2.E2.m2.1a"><mrow id="S2.E2.m2.1.1.1" xref="S2.E2.m2.1.1.1.1.cmml"><mrow id="S2.E2.m2.1.1.1.1" xref="S2.E2.m2.1.1.1.1.cmml"><mi id="S2.E2.m2.1.1.1.1.2" xref="S2.E2.m2.1.1.1.1.2.cmml"></mi><mo id="S2.E2.m2.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E2.m2.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.3.cmml"><msub id="S2.E2.m2.1.1.1.1.3.2" xref="S2.E2.m2.1.1.1.1.3.2.cmml"><mover accent="true" id="S2.E2.m2.1.1.1.1.3.2.2" xref="S2.E2.m2.1.1.1.1.3.2.2.cmml"><mi id="S2.E2.m2.1.1.1.1.3.2.2.2" xref="S2.E2.m2.1.1.1.1.3.2.2.2.cmml">𝐩</mi><mo id="S2.E2.m2.1.1.1.1.3.2.2.1" xref="S2.E2.m2.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S2.E2.m2.1.1.1.1.3.2.3" xref="S2.E2.m2.1.1.1.1.3.2.3.cmml">k</mi></msub><mo id="S2.E2.m2.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m2.1.1.1.1.3.1.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m2.1.1.1.1.3.3" xref="S2.E2.m2.1.1.1.1.3.3.cmml">𝒬</mi></mrow></mrow><mo id="S2.E2.m2.1.1.1.2" xref="S2.E2.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.1b"><apply id="S2.E2.m2.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1"><eq id="S2.E2.m2.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E2.m2.1.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E2.m2.1.1.1.1.3.cmml" xref="S2.E2.m2.1.1.1.1.3"><ci id="S2.E2.m2.1.1.1.1.3.1.cmml" xref="S2.E2.m2.1.1.1.1.3.1">⋅</ci><apply id="S2.E2.m2.1.1.1.1.3.2.cmml" xref="S2.E2.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.1.1.3.2.1.cmml" xref="S2.E2.m2.1.1.1.1.3.2">subscript</csymbol><apply id="S2.E2.m2.1.1.1.1.3.2.2.cmml" xref="S2.E2.m2.1.1.1.1.3.2.2"><ci id="S2.E2.m2.1.1.1.1.3.2.2.1.cmml" xref="S2.E2.m2.1.1.1.1.3.2.2.1">^</ci><ci id="S2.E2.m2.1.1.1.1.3.2.2.2.cmml" xref="S2.E2.m2.1.1.1.1.3.2.2.2">𝐩</ci></apply><ci id="S2.E2.m2.1.1.1.1.3.2.3.cmml" xref="S2.E2.m2.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S2.E2.m2.1.1.1.1.3.3.cmml" xref="S2.E2.m2.1.1.1.1.3.3">𝒬</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.1c">\displaystyle=\hat{\mathbf{p}}_{k}\cdot\mathcal{Q},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m2.1d">= over^ start_ARG bold_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⋅ caligraphic_Q ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.9">where <math alttext="\hat{\mathbf{p}}_{k}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m1.1"><semantics id="S2.SS1.p2.3.m1.1a"><msub id="S2.SS1.p2.3.m1.1.1" xref="S2.SS1.p2.3.m1.1.1.cmml"><mover accent="true" id="S2.SS1.p2.3.m1.1.1.2" xref="S2.SS1.p2.3.m1.1.1.2.cmml"><mi id="S2.SS1.p2.3.m1.1.1.2.2" xref="S2.SS1.p2.3.m1.1.1.2.2.cmml">𝐩</mi><mo id="S2.SS1.p2.3.m1.1.1.2.1" xref="S2.SS1.p2.3.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS1.p2.3.m1.1.1.3" xref="S2.SS1.p2.3.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m1.1b"><apply id="S2.SS1.p2.3.m1.1.1.cmml" xref="S2.SS1.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m1.1.1.1.cmml" xref="S2.SS1.p2.3.m1.1.1">subscript</csymbol><apply id="S2.SS1.p2.3.m1.1.1.2.cmml" xref="S2.SS1.p2.3.m1.1.1.2"><ci id="S2.SS1.p2.3.m1.1.1.2.1.cmml" xref="S2.SS1.p2.3.m1.1.1.2.1">^</ci><ci id="S2.SS1.p2.3.m1.1.1.2.2.cmml" xref="S2.SS1.p2.3.m1.1.1.2.2">𝐩</ci></apply><ci id="S2.SS1.p2.3.m1.1.1.3.cmml" xref="S2.SS1.p2.3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m1.1c">\hat{\mathbf{p}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m1.1d">over^ start_ARG bold_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> denotes the preference representation of user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m2.1"><semantics id="S2.SS1.p2.4.m2.1a"><msub id="S2.SS1.p2.4.m2.1.1" xref="S2.SS1.p2.4.m2.1.1.cmml"><mi id="S2.SS1.p2.4.m2.1.1.2" xref="S2.SS1.p2.4.m2.1.1.2.cmml">u</mi><mi id="S2.SS1.p2.4.m2.1.1.3" xref="S2.SS1.p2.4.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m2.1b"><apply id="S2.SS1.p2.4.m2.1.1.cmml" xref="S2.SS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m2.1.1.1.cmml" xref="S2.SS1.p2.4.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m2.1.1.2.cmml" xref="S2.SS1.p2.4.m2.1.1.2">𝑢</ci><ci id="S2.SS1.p2.4.m2.1.1.3.cmml" xref="S2.SS1.p2.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m2.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m2.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="r_{k}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m3.1"><semantics id="S2.SS1.p2.5.m3.1a"><msub id="S2.SS1.p2.5.m3.1.1" xref="S2.SS1.p2.5.m3.1.1.cmml"><mi id="S2.SS1.p2.5.m3.1.1.2" xref="S2.SS1.p2.5.m3.1.1.2.cmml">r</mi><mi id="S2.SS1.p2.5.m3.1.1.3" xref="S2.SS1.p2.5.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m3.1b"><apply id="S2.SS1.p2.5.m3.1.1.cmml" xref="S2.SS1.p2.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m3.1.1.1.cmml" xref="S2.SS1.p2.5.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m3.1.1.2.cmml" xref="S2.SS1.p2.5.m3.1.1.2">𝑟</ci><ci id="S2.SS1.p2.5.m3.1.1.3.cmml" xref="S2.SS1.p2.5.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m3.1c">r_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m3.1d">italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a score distribution of user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m4.1"><semantics id="S2.SS1.p2.6.m4.1a"><msub id="S2.SS1.p2.6.m4.1.1" xref="S2.SS1.p2.6.m4.1.1.cmml"><mi id="S2.SS1.p2.6.m4.1.1.2" xref="S2.SS1.p2.6.m4.1.1.2.cmml">u</mi><mi id="S2.SS1.p2.6.m4.1.1.3" xref="S2.SS1.p2.6.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m4.1b"><apply id="S2.SS1.p2.6.m4.1.1.cmml" xref="S2.SS1.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m4.1.1.1.cmml" xref="S2.SS1.p2.6.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m4.1.1.2.cmml" xref="S2.SS1.p2.6.m4.1.1.2">𝑢</ci><ci id="S2.SS1.p2.6.m4.1.1.3.cmml" xref="S2.SS1.p2.6.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m4.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m4.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> over all items in the item base <math alttext="\mathcal{Q}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m5.1"><semantics id="S2.SS1.p2.7.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.7.m5.1.1" xref="S2.SS1.p2.7.m5.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m5.1b"><ci id="S2.SS1.p2.7.m5.1.1.cmml" xref="S2.SS1.p2.7.m5.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m5.1c">\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m5.1d">caligraphic_Q</annotation></semantics></math>.
This distribution is used to generate a ranked list of items representing the most likely interactions for user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m6.1"><semantics id="S2.SS1.p2.8.m6.1a"><msub id="S2.SS1.p2.8.m6.1.1" xref="S2.SS1.p2.8.m6.1.1.cmml"><mi id="S2.SS1.p2.8.m6.1.1.2" xref="S2.SS1.p2.8.m6.1.1.2.cmml">u</mi><mi id="S2.SS1.p2.8.m6.1.1.3" xref="S2.SS1.p2.8.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m6.1b"><apply id="S2.SS1.p2.8.m6.1.1.cmml" xref="S2.SS1.p2.8.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m6.1.1.1.cmml" xref="S2.SS1.p2.8.m6.1.1">subscript</csymbol><ci id="S2.SS1.p2.8.m6.1.1.2.cmml" xref="S2.SS1.p2.8.m6.1.1.2">𝑢</ci><ci id="S2.SS1.p2.8.m6.1.1.3.cmml" xref="S2.SS1.p2.8.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m6.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m6.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> at step <math alttext="L+1" class="ltx_Math" display="inline" id="S2.SS1.p2.9.m7.1"><semantics id="S2.SS1.p2.9.m7.1a"><mrow id="S2.SS1.p2.9.m7.1.1" xref="S2.SS1.p2.9.m7.1.1.cmml"><mi id="S2.SS1.p2.9.m7.1.1.2" xref="S2.SS1.p2.9.m7.1.1.2.cmml">L</mi><mo id="S2.SS1.p2.9.m7.1.1.1" xref="S2.SS1.p2.9.m7.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.9.m7.1.1.3" xref="S2.SS1.p2.9.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m7.1b"><apply id="S2.SS1.p2.9.m7.1.1.cmml" xref="S2.SS1.p2.9.m7.1.1"><plus id="S2.SS1.p2.9.m7.1.1.1.cmml" xref="S2.SS1.p2.9.m7.1.1.1"></plus><ci id="S2.SS1.p2.9.m7.1.1.2.cmml" xref="S2.SS1.p2.9.m7.1.1.2">𝐿</ci><cn id="S2.SS1.p2.9.m7.1.1.3.cmml" type="integer" xref="S2.SS1.p2.9.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m7.1c">L+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.9.m7.1d">italic_L + 1</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>An Overview of the Proposed SSD4Rec</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Mamba models have recently demonstrated significant achievements across diverse domains, owing to their exceptional ability to capture intricate dynamics in long sequence modeling <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib14" title="">2023</a>; Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite>.
By introducing advanced Structured State Space Models with hardware-aware expansions, Mamba facilitates attention-like modeling capabilities while maintaining a linear complexity in computing.
Motivated by these advancements, this paper proposes to explore Mamba’s potential for effective and efficient sequential recommendations.
Specifically, unlike the conventional sequential recommendation methods based on RNN or Transformer architecture, the proposed SSD4Rec is designed to handle variable-length item sequences seamlessly without requiring padding or truncation, thereby ensuring that the model receives complete information and retains essential knowledge.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.F1" title="Figure 1 ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, the proposed model consists of two key modules, namely variable-length item sequence construction and Bidirectional Structured State Space Duality (Bi-SSD) for user modeling.
The first module aims to tackle the core challenge of managing variable-length sequences from diverse users within a certain batch.
Meanwhile, the proposed block enables attention-like content-aware interaction modeling while upholding linear complexity in computation.
Further elaboration on the proposed method will be provided in the upcoming sections.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="642" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Compared to the typical sequential recommendation input with a fixed sequence length, the proposed input construction strategy achieves the seamless adaptation of Mamba to sequential recommendations, thus avoiding information loss and additional computation.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Variable-length Item Sequence Construction</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">The typical sequential recommendation methods (e.g., RNN-based and Transformer-based) perform padding or truncation operations to have fixed-length historical sequences of users’ behaviors for the input of sequential architectures within a mini batch <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib22" title="">2018</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib3" title="">2021</a>)</cite>.
However, such fixed-length inputs suffer from intrinsic limitations, such as missing information and additional computational burdens for existing deep learning sequential recommendation methods, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.F2" title="Figure 2 ‣ 2.2. An Overview of the Proposed SSD4Rec ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.
These limitations can lead to sub-optimal performance in capturing users’ preferences for various modern web applications, such as e-commerce and social media platforms, where user interactions are significantly diverse.
To address the problem, we introduce a novel strategy to encode user interactions of varying lengths within a mini-batch.
More specifically, within a batch, the proposed strategy combines item sequences of varying lengths into an extended integrated sequence and subsequently introduces <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.1">segment registers</em> to facilitate user-aware interaction understanding.
Similar to the positional embeddings utilized in visual tasks for location-aware modeling, these registers delineate different segments of the integrated sequence originating from particular users.
By doing so, a standardized batch input can be built, encapsulating different item sequences from diverse users without the need for padding or truncation.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.4">Formally, given <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mi id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><ci id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_K</annotation></semantics></math> users in the <math alttext="b" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_b</annotation></semantics></math>-th batch <math alttext="\mathcal{U}_{b}=\{u_{1},...,u_{k},...,u_{K}\}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.5"><semantics id="S2.SS3.p2.3.m3.5a"><mrow id="S2.SS3.p2.3.m3.5.5" xref="S2.SS3.p2.3.m3.5.5.cmml"><msub id="S2.SS3.p2.3.m3.5.5.5" xref="S2.SS3.p2.3.m3.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.3.m3.5.5.5.2" xref="S2.SS3.p2.3.m3.5.5.5.2.cmml">𝒰</mi><mi id="S2.SS3.p2.3.m3.5.5.5.3" xref="S2.SS3.p2.3.m3.5.5.5.3.cmml">b</mi></msub><mo id="S2.SS3.p2.3.m3.5.5.4" xref="S2.SS3.p2.3.m3.5.5.4.cmml">=</mo><mrow id="S2.SS3.p2.3.m3.5.5.3.3" xref="S2.SS3.p2.3.m3.5.5.3.4.cmml"><mo id="S2.SS3.p2.3.m3.5.5.3.3.4" stretchy="false" xref="S2.SS3.p2.3.m3.5.5.3.4.cmml">{</mo><msub id="S2.SS3.p2.3.m3.3.3.1.1.1" xref="S2.SS3.p2.3.m3.3.3.1.1.1.cmml"><mi id="S2.SS3.p2.3.m3.3.3.1.1.1.2" xref="S2.SS3.p2.3.m3.3.3.1.1.1.2.cmml">u</mi><mn id="S2.SS3.p2.3.m3.3.3.1.1.1.3" xref="S2.SS3.p2.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.p2.3.m3.5.5.3.3.5" xref="S2.SS3.p2.3.m3.5.5.3.4.cmml">,</mo><mi id="S2.SS3.p2.3.m3.1.1" mathvariant="normal" xref="S2.SS3.p2.3.m3.1.1.cmml">…</mi><mo id="S2.SS3.p2.3.m3.5.5.3.3.6" xref="S2.SS3.p2.3.m3.5.5.3.4.cmml">,</mo><msub id="S2.SS3.p2.3.m3.4.4.2.2.2" xref="S2.SS3.p2.3.m3.4.4.2.2.2.cmml"><mi id="S2.SS3.p2.3.m3.4.4.2.2.2.2" xref="S2.SS3.p2.3.m3.4.4.2.2.2.2.cmml">u</mi><mi id="S2.SS3.p2.3.m3.4.4.2.2.2.3" xref="S2.SS3.p2.3.m3.4.4.2.2.2.3.cmml">k</mi></msub><mo id="S2.SS3.p2.3.m3.5.5.3.3.7" xref="S2.SS3.p2.3.m3.5.5.3.4.cmml">,</mo><mi id="S2.SS3.p2.3.m3.2.2" mathvariant="normal" xref="S2.SS3.p2.3.m3.2.2.cmml">…</mi><mo id="S2.SS3.p2.3.m3.5.5.3.3.8" xref="S2.SS3.p2.3.m3.5.5.3.4.cmml">,</mo><msub id="S2.SS3.p2.3.m3.5.5.3.3.3" xref="S2.SS3.p2.3.m3.5.5.3.3.3.cmml"><mi id="S2.SS3.p2.3.m3.5.5.3.3.3.2" xref="S2.SS3.p2.3.m3.5.5.3.3.3.2.cmml">u</mi><mi id="S2.SS3.p2.3.m3.5.5.3.3.3.3" xref="S2.SS3.p2.3.m3.5.5.3.3.3.3.cmml">K</mi></msub><mo id="S2.SS3.p2.3.m3.5.5.3.3.9" stretchy="false" xref="S2.SS3.p2.3.m3.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.5b"><apply id="S2.SS3.p2.3.m3.5.5.cmml" xref="S2.SS3.p2.3.m3.5.5"><eq id="S2.SS3.p2.3.m3.5.5.4.cmml" xref="S2.SS3.p2.3.m3.5.5.4"></eq><apply id="S2.SS3.p2.3.m3.5.5.5.cmml" xref="S2.SS3.p2.3.m3.5.5.5"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.5.5.5.1.cmml" xref="S2.SS3.p2.3.m3.5.5.5">subscript</csymbol><ci id="S2.SS3.p2.3.m3.5.5.5.2.cmml" xref="S2.SS3.p2.3.m3.5.5.5.2">𝒰</ci><ci id="S2.SS3.p2.3.m3.5.5.5.3.cmml" xref="S2.SS3.p2.3.m3.5.5.5.3">𝑏</ci></apply><set id="S2.SS3.p2.3.m3.5.5.3.4.cmml" xref="S2.SS3.p2.3.m3.5.5.3.3"><apply id="S2.SS3.p2.3.m3.3.3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS3.p2.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.3.m3.3.3.1.1.1.2.cmml" xref="S2.SS3.p2.3.m3.3.3.1.1.1.2">𝑢</ci><cn id="S2.SS3.p2.3.m3.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS3.p2.3.m3.3.3.1.1.1.3">1</cn></apply><ci id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">…</ci><apply id="S2.SS3.p2.3.m3.4.4.2.2.2.cmml" xref="S2.SS3.p2.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.4.4.2.2.2.1.cmml" xref="S2.SS3.p2.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S2.SS3.p2.3.m3.4.4.2.2.2.2.cmml" xref="S2.SS3.p2.3.m3.4.4.2.2.2.2">𝑢</ci><ci id="S2.SS3.p2.3.m3.4.4.2.2.2.3.cmml" xref="S2.SS3.p2.3.m3.4.4.2.2.2.3">𝑘</ci></apply><ci id="S2.SS3.p2.3.m3.2.2.cmml" xref="S2.SS3.p2.3.m3.2.2">…</ci><apply id="S2.SS3.p2.3.m3.5.5.3.3.3.cmml" xref="S2.SS3.p2.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.5.5.3.3.3.1.cmml" xref="S2.SS3.p2.3.m3.5.5.3.3.3">subscript</csymbol><ci id="S2.SS3.p2.3.m3.5.5.3.3.3.2.cmml" xref="S2.SS3.p2.3.m3.5.5.3.3.3.2">𝑢</ci><ci id="S2.SS3.p2.3.m3.5.5.3.3.3.3.cmml" xref="S2.SS3.p2.3.m3.5.5.3.3.3.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.5c">\mathcal{U}_{b}=\{u_{1},...,u_{k},...,u_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.5d">caligraphic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> of varying interaction lengths, they can be characterized by their item sequences <math alttext="\{\mathcal{S}_{1},\mathcal{S}_{k},...,\mathcal{S}_{K}\}" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.4"><semantics id="S2.SS3.p2.4.m4.4a"><mrow id="S2.SS3.p2.4.m4.4.4.3" xref="S2.SS3.p2.4.m4.4.4.4.cmml"><mo id="S2.SS3.p2.4.m4.4.4.3.4" stretchy="false" xref="S2.SS3.p2.4.m4.4.4.4.cmml">{</mo><msub id="S2.SS3.p2.4.m4.2.2.1.1" xref="S2.SS3.p2.4.m4.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.4.m4.2.2.1.1.2" xref="S2.SS3.p2.4.m4.2.2.1.1.2.cmml">𝒮</mi><mn id="S2.SS3.p2.4.m4.2.2.1.1.3" xref="S2.SS3.p2.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.p2.4.m4.4.4.3.5" xref="S2.SS3.p2.4.m4.4.4.4.cmml">,</mo><msub id="S2.SS3.p2.4.m4.3.3.2.2" xref="S2.SS3.p2.4.m4.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.4.m4.3.3.2.2.2" xref="S2.SS3.p2.4.m4.3.3.2.2.2.cmml">𝒮</mi><mi id="S2.SS3.p2.4.m4.3.3.2.2.3" xref="S2.SS3.p2.4.m4.3.3.2.2.3.cmml">k</mi></msub><mo id="S2.SS3.p2.4.m4.4.4.3.6" xref="S2.SS3.p2.4.m4.4.4.4.cmml">,</mo><mi id="S2.SS3.p2.4.m4.1.1" mathvariant="normal" xref="S2.SS3.p2.4.m4.1.1.cmml">…</mi><mo id="S2.SS3.p2.4.m4.4.4.3.7" xref="S2.SS3.p2.4.m4.4.4.4.cmml">,</mo><msub id="S2.SS3.p2.4.m4.4.4.3.3" xref="S2.SS3.p2.4.m4.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.4.m4.4.4.3.3.2" xref="S2.SS3.p2.4.m4.4.4.3.3.2.cmml">𝒮</mi><mi id="S2.SS3.p2.4.m4.4.4.3.3.3" xref="S2.SS3.p2.4.m4.4.4.3.3.3.cmml">K</mi></msub><mo id="S2.SS3.p2.4.m4.4.4.3.8" stretchy="false" xref="S2.SS3.p2.4.m4.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.4b"><set id="S2.SS3.p2.4.m4.4.4.4.cmml" xref="S2.SS3.p2.4.m4.4.4.3"><apply id="S2.SS3.p2.4.m4.2.2.1.1.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.2.2.1.1.1.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1">subscript</csymbol><ci id="S2.SS3.p2.4.m4.2.2.1.1.2.cmml" xref="S2.SS3.p2.4.m4.2.2.1.1.2">𝒮</ci><cn id="S2.SS3.p2.4.m4.2.2.1.1.3.cmml" type="integer" xref="S2.SS3.p2.4.m4.2.2.1.1.3">1</cn></apply><apply id="S2.SS3.p2.4.m4.3.3.2.2.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.3.3.2.2.1.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2">subscript</csymbol><ci id="S2.SS3.p2.4.m4.3.3.2.2.2.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2.2">𝒮</ci><ci id="S2.SS3.p2.4.m4.3.3.2.2.3.cmml" xref="S2.SS3.p2.4.m4.3.3.2.2.3">𝑘</ci></apply><ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">…</ci><apply id="S2.SS3.p2.4.m4.4.4.3.3.cmml" xref="S2.SS3.p2.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.4.4.3.3.1.cmml" xref="S2.SS3.p2.4.m4.4.4.3.3">subscript</csymbol><ci id="S2.SS3.p2.4.m4.4.4.3.3.2.cmml" xref="S2.SS3.p2.4.m4.4.4.3.3.2">𝒮</ci><ci id="S2.SS3.p2.4.m4.4.4.3.3.3.cmml" xref="S2.SS3.p2.4.m4.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.4c">\{\mathcal{S}_{1},\mathcal{S}_{k},...,\mathcal{S}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.4d">{ caligraphic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , … , caligraphic_S start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math>, correspondingly.
In our case, the embeddings of these item sequences are concatenated into an extended integrated sequence, as expressed in</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx2">
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{E}_{b}=[\underbrace{\mathcal{E}_{u_{1}},...,\mathcal{E}_%
{u_{k}},...,\mathcal{E}_{u_{K}}}_{\text{$b$-th batch with size $K$}}]," class="ltx_Math" display="inline" id="S2.E3.m1.8"><semantics id="S2.E3.m1.8a"><mrow id="S2.E3.m1.8.8.1" xref="S2.E3.m1.8.8.1.1.cmml"><mrow id="S2.E3.m1.8.8.1.1" xref="S2.E3.m1.8.8.1.1.cmml"><msub id="S2.E3.m1.8.8.1.1.3" xref="S2.E3.m1.8.8.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.8.8.1.1.3.2" xref="S2.E3.m1.8.8.1.1.3.2.cmml">ℰ</mi><mi id="S2.E3.m1.8.8.1.1.3.3" xref="S2.E3.m1.8.8.1.1.3.3.cmml">b</mi></msub><mo id="S2.E3.m1.8.8.1.1.2" xref="S2.E3.m1.8.8.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.8.8.1.1.1.1" xref="S2.E3.m1.8.8.1.1.1.2.cmml"><mo id="S2.E3.m1.8.8.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.8.8.1.1.1.2.1.cmml">[</mo><munder id="S2.E3.m1.8.8.1.1.1.1.1" xref="S2.E3.m1.8.8.1.1.1.1.1.cmml"><munder accentunder="true" id="S2.E3.m1.7.7" xref="S2.E3.m1.7.7.cmml"><mrow id="S2.E3.m1.7.7.5.5" xref="S2.E3.m1.7.7.5.6.cmml"><msub id="S2.E3.m1.5.5.3.3.1" xref="S2.E3.m1.5.5.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.5.3.3.1.2" xref="S2.E3.m1.5.5.3.3.1.2.cmml">ℰ</mi><msub id="S2.E3.m1.5.5.3.3.1.3" xref="S2.E3.m1.5.5.3.3.1.3.cmml"><mi id="S2.E3.m1.5.5.3.3.1.3.2" xref="S2.E3.m1.5.5.3.3.1.3.2.cmml">u</mi><mn id="S2.E3.m1.5.5.3.3.1.3.3" xref="S2.E3.m1.5.5.3.3.1.3.3.cmml">1</mn></msub></msub><mo id="S2.E3.m1.7.7.5.5.4" xref="S2.E3.m1.7.7.5.6.cmml">,</mo><mi id="S2.E3.m1.3.3.1.1" mathvariant="normal" xref="S2.E3.m1.3.3.1.1.cmml">…</mi><mo id="S2.E3.m1.7.7.5.5.5" xref="S2.E3.m1.7.7.5.6.cmml">,</mo><msub id="S2.E3.m1.6.6.4.4.2" xref="S2.E3.m1.6.6.4.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.6.6.4.4.2.2" xref="S2.E3.m1.6.6.4.4.2.2.cmml">ℰ</mi><msub id="S2.E3.m1.6.6.4.4.2.3" xref="S2.E3.m1.6.6.4.4.2.3.cmml"><mi id="S2.E3.m1.6.6.4.4.2.3.2" xref="S2.E3.m1.6.6.4.4.2.3.2.cmml">u</mi><mi id="S2.E3.m1.6.6.4.4.2.3.3" xref="S2.E3.m1.6.6.4.4.2.3.3.cmml">k</mi></msub></msub><mo id="S2.E3.m1.7.7.5.5.6" xref="S2.E3.m1.7.7.5.6.cmml">,</mo><mi id="S2.E3.m1.4.4.2.2" mathvariant="normal" xref="S2.E3.m1.4.4.2.2.cmml">…</mi><mo id="S2.E3.m1.7.7.5.5.7" xref="S2.E3.m1.7.7.5.6.cmml">,</mo><msub id="S2.E3.m1.7.7.5.5.3" xref="S2.E3.m1.7.7.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.7.7.5.5.3.2" xref="S2.E3.m1.7.7.5.5.3.2.cmml">ℰ</mi><msub id="S2.E3.m1.7.7.5.5.3.3" xref="S2.E3.m1.7.7.5.5.3.3.cmml"><mi id="S2.E3.m1.7.7.5.5.3.3.2" xref="S2.E3.m1.7.7.5.5.3.3.2.cmml">u</mi><mi id="S2.E3.m1.7.7.5.5.3.3.3" xref="S2.E3.m1.7.7.5.5.3.3.3.cmml">K</mi></msub></msub></mrow><mo id="S2.E3.m1.7.7.6" xref="S2.E3.m1.7.7.6.cmml">⏟</mo></munder><mrow id="S2.E3.m1.2.2.2a" xref="S2.E3.m1.2.2.2ab.cmml"><mi id="S2.E3.m1.1.1.1.1.1.m1.1.1" xref="S2.E3.m1.1.1.1.1.1.m1.1.1.cmml">b</mi><mtext id="S2.E3.m1.2.2.2aa" xref="S2.E3.m1.2.2.2ab.cmml">-th batch with size </mtext><mi id="S2.E3.m1.2.2.2.2.2.m2.1.1" xref="S2.E3.m1.2.2.2.2.2.m2.1.1.cmml">K</mi></mrow></munder><mo id="S2.E3.m1.8.8.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E3.m1.8.8.1.2" xref="S2.E3.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.8b"><apply id="S2.E3.m1.8.8.1.1.cmml" xref="S2.E3.m1.8.8.1"><eq id="S2.E3.m1.8.8.1.1.2.cmml" xref="S2.E3.m1.8.8.1.1.2"></eq><apply id="S2.E3.m1.8.8.1.1.3.cmml" xref="S2.E3.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.1.1.3.1.cmml" xref="S2.E3.m1.8.8.1.1.3">subscript</csymbol><ci id="S2.E3.m1.8.8.1.1.3.2.cmml" xref="S2.E3.m1.8.8.1.1.3.2">ℰ</ci><ci id="S2.E3.m1.8.8.1.1.3.3.cmml" xref="S2.E3.m1.8.8.1.1.3.3">𝑏</ci></apply><apply id="S2.E3.m1.8.8.1.1.1.2.cmml" xref="S2.E3.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.8.8.1.1.1.2.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.8.8.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.7.7.cmml" xref="S2.E3.m1.7.7"><ci id="S2.E3.m1.7.7.6.cmml" xref="S2.E3.m1.7.7.6">⏟</ci><list id="S2.E3.m1.7.7.5.6.cmml" xref="S2.E3.m1.7.7.5.5"><apply id="S2.E3.m1.5.5.3.3.1.cmml" xref="S2.E3.m1.5.5.3.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.3.1.1.cmml" xref="S2.E3.m1.5.5.3.3.1">subscript</csymbol><ci id="S2.E3.m1.5.5.3.3.1.2.cmml" xref="S2.E3.m1.5.5.3.3.1.2">ℰ</ci><apply id="S2.E3.m1.5.5.3.3.1.3.cmml" xref="S2.E3.m1.5.5.3.3.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.3.1.3.1.cmml" xref="S2.E3.m1.5.5.3.3.1.3">subscript</csymbol><ci id="S2.E3.m1.5.5.3.3.1.3.2.cmml" xref="S2.E3.m1.5.5.3.3.1.3.2">𝑢</ci><cn id="S2.E3.m1.5.5.3.3.1.3.3.cmml" type="integer" xref="S2.E3.m1.5.5.3.3.1.3.3">1</cn></apply></apply><ci id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1.1">…</ci><apply id="S2.E3.m1.6.6.4.4.2.cmml" xref="S2.E3.m1.6.6.4.4.2"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.4.4.2.1.cmml" xref="S2.E3.m1.6.6.4.4.2">subscript</csymbol><ci id="S2.E3.m1.6.6.4.4.2.2.cmml" xref="S2.E3.m1.6.6.4.4.2.2">ℰ</ci><apply id="S2.E3.m1.6.6.4.4.2.3.cmml" xref="S2.E3.m1.6.6.4.4.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.4.4.2.3.1.cmml" xref="S2.E3.m1.6.6.4.4.2.3">subscript</csymbol><ci id="S2.E3.m1.6.6.4.4.2.3.2.cmml" xref="S2.E3.m1.6.6.4.4.2.3.2">𝑢</ci><ci id="S2.E3.m1.6.6.4.4.2.3.3.cmml" xref="S2.E3.m1.6.6.4.4.2.3.3">𝑘</ci></apply></apply><ci id="S2.E3.m1.4.4.2.2.cmml" xref="S2.E3.m1.4.4.2.2">…</ci><apply id="S2.E3.m1.7.7.5.5.3.cmml" xref="S2.E3.m1.7.7.5.5.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.5.5.3.1.cmml" xref="S2.E3.m1.7.7.5.5.3">subscript</csymbol><ci id="S2.E3.m1.7.7.5.5.3.2.cmml" xref="S2.E3.m1.7.7.5.5.3.2">ℰ</ci><apply id="S2.E3.m1.7.7.5.5.3.3.cmml" xref="S2.E3.m1.7.7.5.5.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.5.5.3.3.1.cmml" xref="S2.E3.m1.7.7.5.5.3.3">subscript</csymbol><ci id="S2.E3.m1.7.7.5.5.3.3.2.cmml" xref="S2.E3.m1.7.7.5.5.3.3.2">𝑢</ci><ci id="S2.E3.m1.7.7.5.5.3.3.3.cmml" xref="S2.E3.m1.7.7.5.5.3.3.3">𝐾</ci></apply></apply></list></apply><ci id="S2.E3.m1.2.2.2ab.cmml" xref="S2.E3.m1.2.2.2a"><mrow id="S2.E3.m1.2.2.2a.cmml" xref="S2.E3.m1.2.2.2a"><mi id="S2.E3.m1.1.1.1.1.1.m1.1.1.cmml" mathsize="70%" xref="S2.E3.m1.1.1.1.1.1.m1.1.1">b</mi><mtext id="S2.E3.m1.2.2.2aa.cmml" mathsize="70%" xref="S2.E3.m1.2.2.2a">-th batch with size </mtext><mi id="S2.E3.m1.2.2.2.2.2.m2.1.1.cmml" mathsize="70%" xref="S2.E3.m1.2.2.2.2.2.m2.1.1">K</mi></mrow></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.8c">\displaystyle\mathcal{E}_{b}=[\underbrace{\mathcal{E}_{u_{1}},...,\mathcal{E}_%
{u_{k}},...,\mathcal{E}_{u_{K}}}_{\text{$b$-th batch with size $K$}}],</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.8d">caligraphic_E start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = [ under⏟ start_ARG caligraphic_E start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , caligraphic_E start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , caligraphic_E start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT italic_b -th batch with size italic_K end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p2.10">where <math alttext="\mathcal{E}_{u_{k}}\in\mathbb{R}^{L_{k}\times D}" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m1.1"><semantics id="S2.SS3.p2.5.m1.1a"><mrow id="S2.SS3.p2.5.m1.1.1" xref="S2.SS3.p2.5.m1.1.1.cmml"><msub id="S2.SS3.p2.5.m1.1.1.2" xref="S2.SS3.p2.5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.5.m1.1.1.2.2" xref="S2.SS3.p2.5.m1.1.1.2.2.cmml">ℰ</mi><msub id="S2.SS3.p2.5.m1.1.1.2.3" xref="S2.SS3.p2.5.m1.1.1.2.3.cmml"><mi id="S2.SS3.p2.5.m1.1.1.2.3.2" xref="S2.SS3.p2.5.m1.1.1.2.3.2.cmml">u</mi><mi id="S2.SS3.p2.5.m1.1.1.2.3.3" xref="S2.SS3.p2.5.m1.1.1.2.3.3.cmml">k</mi></msub></msub><mo id="S2.SS3.p2.5.m1.1.1.1" xref="S2.SS3.p2.5.m1.1.1.1.cmml">∈</mo><msup id="S2.SS3.p2.5.m1.1.1.3" xref="S2.SS3.p2.5.m1.1.1.3.cmml"><mi id="S2.SS3.p2.5.m1.1.1.3.2" xref="S2.SS3.p2.5.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.p2.5.m1.1.1.3.3" xref="S2.SS3.p2.5.m1.1.1.3.3.cmml"><msub id="S2.SS3.p2.5.m1.1.1.3.3.2" xref="S2.SS3.p2.5.m1.1.1.3.3.2.cmml"><mi id="S2.SS3.p2.5.m1.1.1.3.3.2.2" xref="S2.SS3.p2.5.m1.1.1.3.3.2.2.cmml">L</mi><mi id="S2.SS3.p2.5.m1.1.1.3.3.2.3" xref="S2.SS3.p2.5.m1.1.1.3.3.2.3.cmml">k</mi></msub><mo id="S2.SS3.p2.5.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p2.5.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.p2.5.m1.1.1.3.3.3" xref="S2.SS3.p2.5.m1.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m1.1b"><apply id="S2.SS3.p2.5.m1.1.1.cmml" xref="S2.SS3.p2.5.m1.1.1"><in id="S2.SS3.p2.5.m1.1.1.1.cmml" xref="S2.SS3.p2.5.m1.1.1.1"></in><apply id="S2.SS3.p2.5.m1.1.1.2.cmml" xref="S2.SS3.p2.5.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m1.1.1.2.1.cmml" xref="S2.SS3.p2.5.m1.1.1.2">subscript</csymbol><ci id="S2.SS3.p2.5.m1.1.1.2.2.cmml" xref="S2.SS3.p2.5.m1.1.1.2.2">ℰ</ci><apply id="S2.SS3.p2.5.m1.1.1.2.3.cmml" xref="S2.SS3.p2.5.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m1.1.1.2.3.1.cmml" xref="S2.SS3.p2.5.m1.1.1.2.3">subscript</csymbol><ci id="S2.SS3.p2.5.m1.1.1.2.3.2.cmml" xref="S2.SS3.p2.5.m1.1.1.2.3.2">𝑢</ci><ci id="S2.SS3.p2.5.m1.1.1.2.3.3.cmml" xref="S2.SS3.p2.5.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS3.p2.5.m1.1.1.3.cmml" xref="S2.SS3.p2.5.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m1.1.1.3.1.cmml" xref="S2.SS3.p2.5.m1.1.1.3">superscript</csymbol><ci id="S2.SS3.p2.5.m1.1.1.3.2.cmml" xref="S2.SS3.p2.5.m1.1.1.3.2">ℝ</ci><apply id="S2.SS3.p2.5.m1.1.1.3.3.cmml" xref="S2.SS3.p2.5.m1.1.1.3.3"><times id="S2.SS3.p2.5.m1.1.1.3.3.1.cmml" xref="S2.SS3.p2.5.m1.1.1.3.3.1"></times><apply id="S2.SS3.p2.5.m1.1.1.3.3.2.cmml" xref="S2.SS3.p2.5.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m1.1.1.3.3.2.1.cmml" xref="S2.SS3.p2.5.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.SS3.p2.5.m1.1.1.3.3.2.2.cmml" xref="S2.SS3.p2.5.m1.1.1.3.3.2.2">𝐿</ci><ci id="S2.SS3.p2.5.m1.1.1.3.3.2.3.cmml" xref="S2.SS3.p2.5.m1.1.1.3.3.2.3">𝑘</ci></apply><ci id="S2.SS3.p2.5.m1.1.1.3.3.3.cmml" xref="S2.SS3.p2.5.m1.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m1.1c">\mathcal{E}_{u_{k}}\in\mathbb{R}^{L_{k}\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m1.1d">caligraphic_E start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the sequence of item embeddings <math alttext="\{\mathbf{q}_{1}^{u_{k}},...,\mathbf{q}_{L_{k}}^{u_{k}}\}" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m2.3"><semantics id="S2.SS3.p2.6.m2.3a"><mrow id="S2.SS3.p2.6.m2.3.3.2" xref="S2.SS3.p2.6.m2.3.3.3.cmml"><mo id="S2.SS3.p2.6.m2.3.3.2.3" stretchy="false" xref="S2.SS3.p2.6.m2.3.3.3.cmml">{</mo><msubsup id="S2.SS3.p2.6.m2.2.2.1.1" xref="S2.SS3.p2.6.m2.2.2.1.1.cmml"><mi id="S2.SS3.p2.6.m2.2.2.1.1.2.2" xref="S2.SS3.p2.6.m2.2.2.1.1.2.2.cmml">𝐪</mi><mn id="S2.SS3.p2.6.m2.2.2.1.1.2.3" xref="S2.SS3.p2.6.m2.2.2.1.1.2.3.cmml">1</mn><msub id="S2.SS3.p2.6.m2.2.2.1.1.3" xref="S2.SS3.p2.6.m2.2.2.1.1.3.cmml"><mi id="S2.SS3.p2.6.m2.2.2.1.1.3.2" xref="S2.SS3.p2.6.m2.2.2.1.1.3.2.cmml">u</mi><mi id="S2.SS3.p2.6.m2.2.2.1.1.3.3" xref="S2.SS3.p2.6.m2.2.2.1.1.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS3.p2.6.m2.3.3.2.4" xref="S2.SS3.p2.6.m2.3.3.3.cmml">,</mo><mi id="S2.SS3.p2.6.m2.1.1" mathvariant="normal" xref="S2.SS3.p2.6.m2.1.1.cmml">…</mi><mo id="S2.SS3.p2.6.m2.3.3.2.5" xref="S2.SS3.p2.6.m2.3.3.3.cmml">,</mo><msubsup id="S2.SS3.p2.6.m2.3.3.2.2" xref="S2.SS3.p2.6.m2.3.3.2.2.cmml"><mi id="S2.SS3.p2.6.m2.3.3.2.2.2.2" xref="S2.SS3.p2.6.m2.3.3.2.2.2.2.cmml">𝐪</mi><msub id="S2.SS3.p2.6.m2.3.3.2.2.2.3" xref="S2.SS3.p2.6.m2.3.3.2.2.2.3.cmml"><mi id="S2.SS3.p2.6.m2.3.3.2.2.2.3.2" xref="S2.SS3.p2.6.m2.3.3.2.2.2.3.2.cmml">L</mi><mi id="S2.SS3.p2.6.m2.3.3.2.2.2.3.3" xref="S2.SS3.p2.6.m2.3.3.2.2.2.3.3.cmml">k</mi></msub><msub id="S2.SS3.p2.6.m2.3.3.2.2.3" xref="S2.SS3.p2.6.m2.3.3.2.2.3.cmml"><mi id="S2.SS3.p2.6.m2.3.3.2.2.3.2" xref="S2.SS3.p2.6.m2.3.3.2.2.3.2.cmml">u</mi><mi id="S2.SS3.p2.6.m2.3.3.2.2.3.3" xref="S2.SS3.p2.6.m2.3.3.2.2.3.3.cmml">k</mi></msub></msubsup><mo id="S2.SS3.p2.6.m2.3.3.2.6" stretchy="false" xref="S2.SS3.p2.6.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m2.3b"><set id="S2.SS3.p2.6.m2.3.3.3.cmml" xref="S2.SS3.p2.6.m2.3.3.2"><apply id="S2.SS3.p2.6.m2.2.2.1.1.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m2.2.2.1.1.1.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1">superscript</csymbol><apply id="S2.SS3.p2.6.m2.2.2.1.1.2.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m2.2.2.1.1.2.1.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1">subscript</csymbol><ci id="S2.SS3.p2.6.m2.2.2.1.1.2.2.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1.2.2">𝐪</ci><cn id="S2.SS3.p2.6.m2.2.2.1.1.2.3.cmml" type="integer" xref="S2.SS3.p2.6.m2.2.2.1.1.2.3">1</cn></apply><apply id="S2.SS3.p2.6.m2.2.2.1.1.3.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m2.2.2.1.1.3.1.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.6.m2.2.2.1.1.3.2.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1.3.2">𝑢</ci><ci id="S2.SS3.p2.6.m2.2.2.1.1.3.3.cmml" xref="S2.SS3.p2.6.m2.2.2.1.1.3.3">𝑘</ci></apply></apply><ci id="S2.SS3.p2.6.m2.1.1.cmml" xref="S2.SS3.p2.6.m2.1.1">…</ci><apply id="S2.SS3.p2.6.m2.3.3.2.2.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m2.3.3.2.2.1.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2">superscript</csymbol><apply id="S2.SS3.p2.6.m2.3.3.2.2.2.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m2.3.3.2.2.2.1.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2">subscript</csymbol><ci id="S2.SS3.p2.6.m2.3.3.2.2.2.2.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.2.2">𝐪</ci><apply id="S2.SS3.p2.6.m2.3.3.2.2.2.3.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m2.3.3.2.2.2.3.1.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.2.3">subscript</csymbol><ci id="S2.SS3.p2.6.m2.3.3.2.2.2.3.2.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.2.3.2">𝐿</ci><ci id="S2.SS3.p2.6.m2.3.3.2.2.2.3.3.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS3.p2.6.m2.3.3.2.2.3.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m2.3.3.2.2.3.1.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.3">subscript</csymbol><ci id="S2.SS3.p2.6.m2.3.3.2.2.3.2.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.3.2">𝑢</ci><ci id="S2.SS3.p2.6.m2.3.3.2.2.3.3.cmml" xref="S2.SS3.p2.6.m2.3.3.2.2.3.3">𝑘</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m2.3c">\{\mathbf{q}_{1}^{u_{k}},...,\mathbf{q}_{L_{k}}^{u_{k}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m2.3d">{ bold_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , … , bold_q start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT }</annotation></semantics></math> for user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS3.p2.7.m3.1"><semantics id="S2.SS3.p2.7.m3.1a"><msub id="S2.SS3.p2.7.m3.1.1" xref="S2.SS3.p2.7.m3.1.1.cmml"><mi id="S2.SS3.p2.7.m3.1.1.2" xref="S2.SS3.p2.7.m3.1.1.2.cmml">u</mi><mi id="S2.SS3.p2.7.m3.1.1.3" xref="S2.SS3.p2.7.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m3.1b"><apply id="S2.SS3.p2.7.m3.1.1.cmml" xref="S2.SS3.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m3.1.1.1.cmml" xref="S2.SS3.p2.7.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.7.m3.1.1.2.cmml" xref="S2.SS3.p2.7.m3.1.1.2">𝑢</ci><ci id="S2.SS3.p2.7.m3.1.1.3.cmml" xref="S2.SS3.p2.7.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m3.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.7.m3.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> with the sequence length of <math alttext="L_{k}" class="ltx_Math" display="inline" id="S2.SS3.p2.8.m4.1"><semantics id="S2.SS3.p2.8.m4.1a"><msub id="S2.SS3.p2.8.m4.1.1" xref="S2.SS3.p2.8.m4.1.1.cmml"><mi id="S2.SS3.p2.8.m4.1.1.2" xref="S2.SS3.p2.8.m4.1.1.2.cmml">L</mi><mi id="S2.SS3.p2.8.m4.1.1.3" xref="S2.SS3.p2.8.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m4.1b"><apply id="S2.SS3.p2.8.m4.1.1.cmml" xref="S2.SS3.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m4.1.1.1.cmml" xref="S2.SS3.p2.8.m4.1.1">subscript</csymbol><ci id="S2.SS3.p2.8.m4.1.1.2.cmml" xref="S2.SS3.p2.8.m4.1.1.2">𝐿</ci><ci id="S2.SS3.p2.8.m4.1.1.3.cmml" xref="S2.SS3.p2.8.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m4.1c">L_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.8.m4.1d">italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathcal{E}_{b}\in\mathbb{R}^{1\times(\sum L)\times D}" class="ltx_Math" display="inline" id="S2.SS3.p2.9.m5.1"><semantics id="S2.SS3.p2.9.m5.1a"><mrow id="S2.SS3.p2.9.m5.1.2" xref="S2.SS3.p2.9.m5.1.2.cmml"><msub id="S2.SS3.p2.9.m5.1.2.2" xref="S2.SS3.p2.9.m5.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.9.m5.1.2.2.2" xref="S2.SS3.p2.9.m5.1.2.2.2.cmml">ℰ</mi><mi id="S2.SS3.p2.9.m5.1.2.2.3" xref="S2.SS3.p2.9.m5.1.2.2.3.cmml">b</mi></msub><mo id="S2.SS3.p2.9.m5.1.2.1" xref="S2.SS3.p2.9.m5.1.2.1.cmml">∈</mo><msup id="S2.SS3.p2.9.m5.1.2.3" xref="S2.SS3.p2.9.m5.1.2.3.cmml"><mi id="S2.SS3.p2.9.m5.1.2.3.2" xref="S2.SS3.p2.9.m5.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS3.p2.9.m5.1.1.1" xref="S2.SS3.p2.9.m5.1.1.1.cmml"><mn id="S2.SS3.p2.9.m5.1.1.1.3" xref="S2.SS3.p2.9.m5.1.1.1.3.cmml">1</mn><mo id="S2.SS3.p2.9.m5.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p2.9.m5.1.1.1.2.cmml">×</mo><mrow id="S2.SS3.p2.9.m5.1.1.1.1.1" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.cmml"><mo id="S2.SS3.p2.9.m5.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.cmml">(</mo><mstyle id="S2.SS3.p2.9.m5.1.1.1.1.1.1" scriptlevel="-1" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.cmml"><mrow id="S2.SS3.p2.9.m5.1.1.1.1.1.1a" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.cmml"><mo id="S2.SS3.p2.9.m5.1.1.1.1.1.1.1" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.1.cmml">∑</mo><mi id="S2.SS3.p2.9.m5.1.1.1.1.1.1.2" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.2.cmml">L</mi></mrow></mstyle><mo id="S2.SS3.p2.9.m5.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS3.p2.9.m5.1.1.1.2a" rspace="0.222em" xref="S2.SS3.p2.9.m5.1.1.1.2.cmml">×</mo><mi id="S2.SS3.p2.9.m5.1.1.1.4" xref="S2.SS3.p2.9.m5.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.9.m5.1b"><apply id="S2.SS3.p2.9.m5.1.2.cmml" xref="S2.SS3.p2.9.m5.1.2"><in id="S2.SS3.p2.9.m5.1.2.1.cmml" xref="S2.SS3.p2.9.m5.1.2.1"></in><apply id="S2.SS3.p2.9.m5.1.2.2.cmml" xref="S2.SS3.p2.9.m5.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m5.1.2.2.1.cmml" xref="S2.SS3.p2.9.m5.1.2.2">subscript</csymbol><ci id="S2.SS3.p2.9.m5.1.2.2.2.cmml" xref="S2.SS3.p2.9.m5.1.2.2.2">ℰ</ci><ci id="S2.SS3.p2.9.m5.1.2.2.3.cmml" xref="S2.SS3.p2.9.m5.1.2.2.3">𝑏</ci></apply><apply id="S2.SS3.p2.9.m5.1.2.3.cmml" xref="S2.SS3.p2.9.m5.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m5.1.2.3.1.cmml" xref="S2.SS3.p2.9.m5.1.2.3">superscript</csymbol><ci id="S2.SS3.p2.9.m5.1.2.3.2.cmml" xref="S2.SS3.p2.9.m5.1.2.3.2">ℝ</ci><apply id="S2.SS3.p2.9.m5.1.1.1.cmml" xref="S2.SS3.p2.9.m5.1.1.1"><times id="S2.SS3.p2.9.m5.1.1.1.2.cmml" xref="S2.SS3.p2.9.m5.1.1.1.2"></times><cn id="S2.SS3.p2.9.m5.1.1.1.3.cmml" type="integer" xref="S2.SS3.p2.9.m5.1.1.1.3">1</cn><apply id="S2.SS3.p2.9.m5.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.9.m5.1.1.1.1.1"><sum id="S2.SS3.p2.9.m5.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.1"></sum><ci id="S2.SS3.p2.9.m5.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.9.m5.1.1.1.1.1.1.2">𝐿</ci></apply><ci id="S2.SS3.p2.9.m5.1.1.1.4.cmml" xref="S2.SS3.p2.9.m5.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.9.m5.1c">\mathcal{E}_{b}\in\mathbb{R}^{1\times(\sum L)\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.9.m5.1d">caligraphic_E start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × ( ∑ italic_L ) × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> represents the integrated embedding sequence in the <math alttext="b" class="ltx_Math" display="inline" id="S2.SS3.p2.10.m6.1"><semantics id="S2.SS3.p2.10.m6.1a"><mi id="S2.SS3.p2.10.m6.1.1" xref="S2.SS3.p2.10.m6.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.10.m6.1b"><ci id="S2.SS3.p2.10.m6.1.1.cmml" xref="S2.SS3.p2.10.m6.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.10.m6.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.10.m6.1d">italic_b</annotation></semantics></math>-th batch.
To delineate separate interactions, we incorporate segment registers based on user identifiers (IDs) with the integrated batch input.
The registers can be written by
</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx3">
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{R}_{b}=\{[u_{1},...,u_{1}]^{L_{1}},...[u_{k},...,u_{k}]^%
{L_{k}},...,[u_{K},...,u_{K}]^{L_{K}}\}," class="ltx_Math" display="inline" id="S2.E4.m1.5"><semantics id="S2.E4.m1.5a"><mrow id="S2.E4.m1.5.5.1" xref="S2.E4.m1.5.5.1.1.cmml"><mrow id="S2.E4.m1.5.5.1.1" xref="S2.E4.m1.5.5.1.1.cmml"><msub id="S2.E4.m1.5.5.1.1.5" xref="S2.E4.m1.5.5.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.5.5.1.1.5.2" xref="S2.E4.m1.5.5.1.1.5.2.cmml">ℛ</mi><mi id="S2.E4.m1.5.5.1.1.5.3" xref="S2.E4.m1.5.5.1.1.5.3.cmml">b</mi></msub><mo id="S2.E4.m1.5.5.1.1.4" xref="S2.E4.m1.5.5.1.1.4.cmml">=</mo><mrow id="S2.E4.m1.5.5.1.1.3.3" xref="S2.E4.m1.5.5.1.1.3.4.cmml"><mo id="S2.E4.m1.5.5.1.1.3.3.4" stretchy="false" xref="S2.E4.m1.5.5.1.1.3.4.cmml">{</mo><msup id="S2.E4.m1.5.5.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.5.5.1.1.1.1.1.2.2" xref="S2.E4.m1.5.5.1.1.1.1.1.2.3.cmml"><mo id="S2.E4.m1.5.5.1.1.1.1.1.2.2.3" stretchy="false" xref="S2.E4.m1.5.5.1.1.1.1.1.2.3.cmml">[</mo><msub id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">u</mi><mn id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E4.m1.5.5.1.1.1.1.1.2.2.4" xref="S2.E4.m1.5.5.1.1.1.1.1.2.3.cmml">,</mo><mi id="S2.E4.m1.1.1" mathvariant="normal" xref="S2.E4.m1.1.1.cmml">…</mi><mo id="S2.E4.m1.5.5.1.1.1.1.1.2.2.5" xref="S2.E4.m1.5.5.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E4.m1.5.5.1.1.1.1.1.2.2.2" xref="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.2" xref="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.2.cmml">u</mi><mn id="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.3" xref="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S2.E4.m1.5.5.1.1.1.1.1.2.2.6" stretchy="false" xref="S2.E4.m1.5.5.1.1.1.1.1.2.3.cmml">]</mo></mrow><msub id="S2.E4.m1.5.5.1.1.1.1.1.4" xref="S2.E4.m1.5.5.1.1.1.1.1.4.cmml"><mi id="S2.E4.m1.5.5.1.1.1.1.1.4.2" xref="S2.E4.m1.5.5.1.1.1.1.1.4.2.cmml">L</mi><mn id="S2.E4.m1.5.5.1.1.1.1.1.4.3" xref="S2.E4.m1.5.5.1.1.1.1.1.4.3.cmml">1</mn></msub></msup><mo id="S2.E4.m1.5.5.1.1.3.3.5" xref="S2.E4.m1.5.5.1.1.3.4.cmml">,</mo><mrow id="S2.E4.m1.5.5.1.1.2.2.2" xref="S2.E4.m1.5.5.1.1.2.2.2.cmml"><mi id="S2.E4.m1.5.5.1.1.2.2.2.4" mathvariant="normal" xref="S2.E4.m1.5.5.1.1.2.2.2.4.cmml">…</mi><mo id="S2.E4.m1.5.5.1.1.2.2.2.3" xref="S2.E4.m1.5.5.1.1.2.2.2.3.cmml">⁢</mo><msup id="S2.E4.m1.5.5.1.1.2.2.2.2" xref="S2.E4.m1.5.5.1.1.2.2.2.2.cmml"><mrow id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.3.cmml"><mo id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.3" stretchy="false" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.3.cmml">[</mo><msub id="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1" xref="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.cmml"><mi id="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.2" xref="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml">u</mi><mi id="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.3" xref="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.4" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.3.cmml">,</mo><mi id="S2.E4.m1.2.2" mathvariant="normal" xref="S2.E4.m1.2.2.cmml">…</mi><mo id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.5" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.3.cmml">,</mo><msub id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.2" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.2.cmml">u</mi><mi id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.3" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.6" stretchy="false" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.3.cmml">]</mo></mrow><msub id="S2.E4.m1.5.5.1.1.2.2.2.2.4" xref="S2.E4.m1.5.5.1.1.2.2.2.2.4.cmml"><mi id="S2.E4.m1.5.5.1.1.2.2.2.2.4.2" xref="S2.E4.m1.5.5.1.1.2.2.2.2.4.2.cmml">L</mi><mi id="S2.E4.m1.5.5.1.1.2.2.2.2.4.3" xref="S2.E4.m1.5.5.1.1.2.2.2.2.4.3.cmml">k</mi></msub></msup></mrow><mo id="S2.E4.m1.5.5.1.1.3.3.6" xref="S2.E4.m1.5.5.1.1.3.4.cmml">,</mo><mi id="S2.E4.m1.4.4" mathvariant="normal" xref="S2.E4.m1.4.4.cmml">…</mi><mo id="S2.E4.m1.5.5.1.1.3.3.7" xref="S2.E4.m1.5.5.1.1.3.4.cmml">,</mo><msup id="S2.E4.m1.5.5.1.1.3.3.3" xref="S2.E4.m1.5.5.1.1.3.3.3.cmml"><mrow id="S2.E4.m1.5.5.1.1.3.3.3.2.2" xref="S2.E4.m1.5.5.1.1.3.3.3.2.3.cmml"><mo id="S2.E4.m1.5.5.1.1.3.3.3.2.2.3" stretchy="false" xref="S2.E4.m1.5.5.1.1.3.3.3.2.3.cmml">[</mo><msub id="S2.E4.m1.5.5.1.1.3.3.3.1.1.1" xref="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.cmml"><mi id="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.2" xref="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.2.cmml">u</mi><mi id="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.3" xref="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.3.cmml">K</mi></msub><mo id="S2.E4.m1.5.5.1.1.3.3.3.2.2.4" xref="S2.E4.m1.5.5.1.1.3.3.3.2.3.cmml">,</mo><mi id="S2.E4.m1.3.3" mathvariant="normal" xref="S2.E4.m1.3.3.cmml">…</mi><mo id="S2.E4.m1.5.5.1.1.3.3.3.2.2.5" xref="S2.E4.m1.5.5.1.1.3.3.3.2.3.cmml">,</mo><msub id="S2.E4.m1.5.5.1.1.3.3.3.2.2.2" xref="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.cmml"><mi id="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.2" xref="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.2.cmml">u</mi><mi id="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.3" xref="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.3.cmml">K</mi></msub><mo id="S2.E4.m1.5.5.1.1.3.3.3.2.2.6" stretchy="false" xref="S2.E4.m1.5.5.1.1.3.3.3.2.3.cmml">]</mo></mrow><msub id="S2.E4.m1.5.5.1.1.3.3.3.4" xref="S2.E4.m1.5.5.1.1.3.3.3.4.cmml"><mi id="S2.E4.m1.5.5.1.1.3.3.3.4.2" xref="S2.E4.m1.5.5.1.1.3.3.3.4.2.cmml">L</mi><mi id="S2.E4.m1.5.5.1.1.3.3.3.4.3" xref="S2.E4.m1.5.5.1.1.3.3.3.4.3.cmml">K</mi></msub></msup><mo id="S2.E4.m1.5.5.1.1.3.3.8" stretchy="false" xref="S2.E4.m1.5.5.1.1.3.4.cmml">}</mo></mrow></mrow><mo id="S2.E4.m1.5.5.1.2" xref="S2.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.5b"><apply id="S2.E4.m1.5.5.1.1.cmml" xref="S2.E4.m1.5.5.1"><eq id="S2.E4.m1.5.5.1.1.4.cmml" xref="S2.E4.m1.5.5.1.1.4"></eq><apply id="S2.E4.m1.5.5.1.1.5.cmml" xref="S2.E4.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.5.1.cmml" xref="S2.E4.m1.5.5.1.1.5">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.5.2.cmml" xref="S2.E4.m1.5.5.1.1.5.2">ℛ</ci><ci id="S2.E4.m1.5.5.1.1.5.3.cmml" xref="S2.E4.m1.5.5.1.1.5.3">𝑏</ci></apply><set id="S2.E4.m1.5.5.1.1.3.4.cmml" xref="S2.E4.m1.5.5.1.1.3.3"><apply id="S2.E4.m1.5.5.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1">superscript</csymbol><list id="S2.E4.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.2.2"><apply id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.2">𝑢</ci><cn id="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E4.m1.5.5.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">…</ci><apply id="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.2">𝑢</ci><cn id="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.E4.m1.5.5.1.1.1.1.1.2.2.2.3">1</cn></apply></list><apply id="S2.E4.m1.5.5.1.1.1.1.1.4.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.1.1.4.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.1.1.1.4.2.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.4.2">𝐿</ci><cn id="S2.E4.m1.5.5.1.1.1.1.1.4.3.cmml" type="integer" xref="S2.E4.m1.5.5.1.1.1.1.1.4.3">1</cn></apply></apply><apply id="S2.E4.m1.5.5.1.1.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2"><times id="S2.E4.m1.5.5.1.1.2.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.3"></times><ci id="S2.E4.m1.5.5.1.1.2.2.2.4.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.4">…</ci><apply id="S2.E4.m1.5.5.1.1.2.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2">superscript</csymbol><list id="S2.E4.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.2"><apply id="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.2">𝑢</ci><ci id="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.1.1.1.1.3">𝑘</ci></apply><ci id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">…</ci><apply id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.2">𝑢</ci><ci id="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.2.2.2.3">𝑘</ci></apply></list><apply id="S2.E4.m1.5.5.1.1.2.2.2.2.4.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.2.2.2.2.4.1.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.4">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.2.2.2.2.4.2.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.4.2">𝐿</ci><ci id="S2.E4.m1.5.5.1.1.2.2.2.2.4.3.cmml" xref="S2.E4.m1.5.5.1.1.2.2.2.2.4.3">𝑘</ci></apply></apply></apply><ci id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4">…</ci><apply id="S2.E4.m1.5.5.1.1.3.3.3.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.3.3.3.3.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3">superscript</csymbol><list id="S2.E4.m1.5.5.1.1.3.3.3.2.3.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.2.2"><apply id="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.1.1.1">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.2">𝑢</ci><ci id="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.1.1.1.3">𝐾</ci></apply><ci id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3">…</ci><apply id="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.1.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.2.2.2">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.2.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.2">𝑢</ci><ci id="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.3.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.2.2.2.3">𝐾</ci></apply></list><apply id="S2.E4.m1.5.5.1.1.3.3.3.4.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.4"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.3.3.3.4.1.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.4">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.3.3.3.4.2.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.4.2">𝐿</ci><ci id="S2.E4.m1.5.5.1.1.3.3.3.4.3.cmml" xref="S2.E4.m1.5.5.1.1.3.3.3.4.3">𝐾</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.5c">\displaystyle\mathcal{R}_{b}=\{[u_{1},...,u_{1}]^{L_{1}},...[u_{k},...,u_{k}]^%
{L_{k}},...,[u_{K},...,u_{K}]^{L_{K}}\},</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.5d">caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = { [ italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , … [ italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , … , [ italic_u start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUPERSCRIPT } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p2.15">where <math alttext="[u_{k},...,u_{k}]^{L_{k}}" class="ltx_Math" display="inline" id="S2.SS3.p2.11.m1.3"><semantics id="S2.SS3.p2.11.m1.3a"><msup id="S2.SS3.p2.11.m1.3.3" xref="S2.SS3.p2.11.m1.3.3.cmml"><mrow id="S2.SS3.p2.11.m1.3.3.2.2" xref="S2.SS3.p2.11.m1.3.3.2.3.cmml"><mo id="S2.SS3.p2.11.m1.3.3.2.2.3" stretchy="false" xref="S2.SS3.p2.11.m1.3.3.2.3.cmml">[</mo><msub id="S2.SS3.p2.11.m1.2.2.1.1.1" xref="S2.SS3.p2.11.m1.2.2.1.1.1.cmml"><mi id="S2.SS3.p2.11.m1.2.2.1.1.1.2" xref="S2.SS3.p2.11.m1.2.2.1.1.1.2.cmml">u</mi><mi id="S2.SS3.p2.11.m1.2.2.1.1.1.3" xref="S2.SS3.p2.11.m1.2.2.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS3.p2.11.m1.3.3.2.2.4" xref="S2.SS3.p2.11.m1.3.3.2.3.cmml">,</mo><mi id="S2.SS3.p2.11.m1.1.1" mathvariant="normal" xref="S2.SS3.p2.11.m1.1.1.cmml">…</mi><mo id="S2.SS3.p2.11.m1.3.3.2.2.5" xref="S2.SS3.p2.11.m1.3.3.2.3.cmml">,</mo><msub id="S2.SS3.p2.11.m1.3.3.2.2.2" xref="S2.SS3.p2.11.m1.3.3.2.2.2.cmml"><mi id="S2.SS3.p2.11.m1.3.3.2.2.2.2" xref="S2.SS3.p2.11.m1.3.3.2.2.2.2.cmml">u</mi><mi id="S2.SS3.p2.11.m1.3.3.2.2.2.3" xref="S2.SS3.p2.11.m1.3.3.2.2.2.3.cmml">k</mi></msub><mo id="S2.SS3.p2.11.m1.3.3.2.2.6" stretchy="false" xref="S2.SS3.p2.11.m1.3.3.2.3.cmml">]</mo></mrow><msub id="S2.SS3.p2.11.m1.3.3.4" xref="S2.SS3.p2.11.m1.3.3.4.cmml"><mi id="S2.SS3.p2.11.m1.3.3.4.2" xref="S2.SS3.p2.11.m1.3.3.4.2.cmml">L</mi><mi id="S2.SS3.p2.11.m1.3.3.4.3" xref="S2.SS3.p2.11.m1.3.3.4.3.cmml">k</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.11.m1.3b"><apply id="S2.SS3.p2.11.m1.3.3.cmml" xref="S2.SS3.p2.11.m1.3.3"><csymbol cd="ambiguous" id="S2.SS3.p2.11.m1.3.3.3.cmml" xref="S2.SS3.p2.11.m1.3.3">superscript</csymbol><list id="S2.SS3.p2.11.m1.3.3.2.3.cmml" xref="S2.SS3.p2.11.m1.3.3.2.2"><apply id="S2.SS3.p2.11.m1.2.2.1.1.1.cmml" xref="S2.SS3.p2.11.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.11.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.p2.11.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.11.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.p2.11.m1.2.2.1.1.1.2">𝑢</ci><ci id="S2.SS3.p2.11.m1.2.2.1.1.1.3.cmml" xref="S2.SS3.p2.11.m1.2.2.1.1.1.3">𝑘</ci></apply><ci id="S2.SS3.p2.11.m1.1.1.cmml" xref="S2.SS3.p2.11.m1.1.1">…</ci><apply id="S2.SS3.p2.11.m1.3.3.2.2.2.cmml" xref="S2.SS3.p2.11.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.11.m1.3.3.2.2.2.1.cmml" xref="S2.SS3.p2.11.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p2.11.m1.3.3.2.2.2.2.cmml" xref="S2.SS3.p2.11.m1.3.3.2.2.2.2">𝑢</ci><ci id="S2.SS3.p2.11.m1.3.3.2.2.2.3.cmml" xref="S2.SS3.p2.11.m1.3.3.2.2.2.3">𝑘</ci></apply></list><apply id="S2.SS3.p2.11.m1.3.3.4.cmml" xref="S2.SS3.p2.11.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p2.11.m1.3.3.4.1.cmml" xref="S2.SS3.p2.11.m1.3.3.4">subscript</csymbol><ci id="S2.SS3.p2.11.m1.3.3.4.2.cmml" xref="S2.SS3.p2.11.m1.3.3.4.2">𝐿</ci><ci id="S2.SS3.p2.11.m1.3.3.4.3.cmml" xref="S2.SS3.p2.11.m1.3.3.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.11.m1.3c">[u_{k},...,u_{k}]^{L_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.11.m1.3d">[ italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the ID-based register of length <math alttext="L_{k}" class="ltx_Math" display="inline" id="S2.SS3.p2.12.m2.1"><semantics id="S2.SS3.p2.12.m2.1a"><msub id="S2.SS3.p2.12.m2.1.1" xref="S2.SS3.p2.12.m2.1.1.cmml"><mi id="S2.SS3.p2.12.m2.1.1.2" xref="S2.SS3.p2.12.m2.1.1.2.cmml">L</mi><mi id="S2.SS3.p2.12.m2.1.1.3" xref="S2.SS3.p2.12.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.12.m2.1b"><apply id="S2.SS3.p2.12.m2.1.1.cmml" xref="S2.SS3.p2.12.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.12.m2.1.1.1.cmml" xref="S2.SS3.p2.12.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.12.m2.1.1.2.cmml" xref="S2.SS3.p2.12.m2.1.1.2">𝐿</ci><ci id="S2.SS3.p2.12.m2.1.1.3.cmml" xref="S2.SS3.p2.12.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.12.m2.1c">L_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.12.m2.1d">italic_L start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> for user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS3.p2.13.m3.1"><semantics id="S2.SS3.p2.13.m3.1a"><msub id="S2.SS3.p2.13.m3.1.1" xref="S2.SS3.p2.13.m3.1.1.cmml"><mi id="S2.SS3.p2.13.m3.1.1.2" xref="S2.SS3.p2.13.m3.1.1.2.cmml">u</mi><mi id="S2.SS3.p2.13.m3.1.1.3" xref="S2.SS3.p2.13.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.13.m3.1b"><apply id="S2.SS3.p2.13.m3.1.1.cmml" xref="S2.SS3.p2.13.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.13.m3.1.1.1.cmml" xref="S2.SS3.p2.13.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.13.m3.1.1.2.cmml" xref="S2.SS3.p2.13.m3.1.1.2">𝑢</ci><ci id="S2.SS3.p2.13.m3.1.1.3.cmml" xref="S2.SS3.p2.13.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.13.m3.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.13.m3.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
It is important to note that these registers do not possess a corresponding embedding; rather, they are employed to indicate the sequence computation to the SSD-based sequential recommendation.
As a result, the integrated sequence and its registers are combined and utilized as the model input <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S2.SS3.p2.14.m4.1"><semantics id="S2.SS3.p2.14.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.14.m4.1.1" xref="S2.SS3.p2.14.m4.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.14.m4.1b"><ci id="S2.SS3.p2.14.m4.1.1.cmml" xref="S2.SS3.p2.14.m4.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.14.m4.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.14.m4.1d">caligraphic_X</annotation></semantics></math> in the <math alttext="b" class="ltx_Math" display="inline" id="S2.SS3.p2.15.m5.1"><semantics id="S2.SS3.p2.15.m5.1a"><mi id="S2.SS3.p2.15.m5.1.1" xref="S2.SS3.p2.15.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.15.m5.1b"><ci id="S2.SS3.p2.15.m5.1.1.cmml" xref="S2.SS3.p2.15.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.15.m5.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.15.m5.1d">italic_b</annotation></semantics></math>-th batch:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx4">
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{X}=(\mathcal{E}_{b},\mathcal{R}_{b})." class="ltx_Math" display="inline" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1.4" xref="S2.E5.m1.1.1.1.1.4.cmml">𝒳</mi><mo id="S2.E5.m1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E5.m1.1.1.1.1.2.2" xref="S2.E5.m1.1.1.1.1.2.3.cmml"><mo id="S2.E5.m1.1.1.1.1.2.2.3" stretchy="false" xref="S2.E5.m1.1.1.1.1.2.3.cmml">(</mo><msub id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S2.E5.m1.1.1.1.1.2.2.4" xref="S2.E5.m1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E5.m1.1.1.1.1.2.2.2" xref="S2.E5.m1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1.2.2.2.2" xref="S2.E5.m1.1.1.1.1.2.2.2.2.cmml">ℛ</mi><mi id="S2.E5.m1.1.1.1.1.2.2.2.3" xref="S2.E5.m1.1.1.1.1.2.2.2.3.cmml">b</mi></msub><mo id="S2.E5.m1.1.1.1.1.2.2.5" stretchy="false" xref="S2.E5.m1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.1.1.1.2" lspace="0em" xref="S2.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><eq id="S2.E5.m1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.3"></eq><ci id="S2.E5.m1.1.1.1.1.4.cmml" xref="S2.E5.m1.1.1.1.1.4">𝒳</ci><interval closure="open" id="S2.E5.m1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2"><apply id="S2.E5.m1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.2">ℰ</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.3">𝑏</ci></apply><apply id="S2.E5.m1.1.1.1.1.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.2.2.2.1.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.2">ℛ</ci><ci id="S2.E5.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E5.m1.1.1.1.1.2.2.2.3">𝑏</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle\mathcal{X}=(\mathcal{E}_{b},\mathcal{R}_{b}).</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">caligraphic_X = ( caligraphic_E start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.1">In adopting this strategy, we transform the problem of batch processing sequences of varying lengths into a long sequence modeling task and leverage the capabilities of Mamba to address this issue effectively.
This strategy contributes to constructing a variable-length input for each batch without requiring padding or truncation, guaranteeing that the model receives comprehensive information from all user interactions.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4. </span>Bidirectional State Space Duality (Bi-SSD) for User Modeling</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.2">With the substantial length of the constructed input <math alttext="\mathcal{X}=(\mathcal{E}_{b},\mathcal{R}_{b})" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.2"><semantics id="S2.SS4.p1.1.m1.2a"><mrow id="S2.SS4.p1.1.m1.2.2" xref="S2.SS4.p1.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.1.m1.2.2.4" xref="S2.SS4.p1.1.m1.2.2.4.cmml">𝒳</mi><mo id="S2.SS4.p1.1.m1.2.2.3" xref="S2.SS4.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S2.SS4.p1.1.m1.2.2.2.2" xref="S2.SS4.p1.1.m1.2.2.2.3.cmml"><mo id="S2.SS4.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S2.SS4.p1.1.m1.2.2.2.3.cmml">(</mo><msub id="S2.SS4.p1.1.m1.1.1.1.1.1" xref="S2.SS4.p1.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.1.m1.1.1.1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S2.SS4.p1.1.m1.1.1.1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S2.SS4.p1.1.m1.2.2.2.2.4" xref="S2.SS4.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="S2.SS4.p1.1.m1.2.2.2.2.2" xref="S2.SS4.p1.1.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.1.m1.2.2.2.2.2.2" xref="S2.SS4.p1.1.m1.2.2.2.2.2.2.cmml">ℛ</mi><mi id="S2.SS4.p1.1.m1.2.2.2.2.2.3" xref="S2.SS4.p1.1.m1.2.2.2.2.2.3.cmml">b</mi></msub><mo id="S2.SS4.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S2.SS4.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.2b"><apply id="S2.SS4.p1.1.m1.2.2.cmml" xref="S2.SS4.p1.1.m1.2.2"><eq id="S2.SS4.p1.1.m1.2.2.3.cmml" xref="S2.SS4.p1.1.m1.2.2.3"></eq><ci id="S2.SS4.p1.1.m1.2.2.4.cmml" xref="S2.SS4.p1.1.m1.2.2.4">𝒳</ci><interval closure="open" id="S2.SS4.p1.1.m1.2.2.2.3.cmml" xref="S2.SS4.p1.1.m1.2.2.2.2"><apply id="S2.SS4.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1.2">ℰ</ci><ci id="S2.SS4.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.1.1.1.3">𝑏</ci></apply><apply id="S2.SS4.p1.1.m1.2.2.2.2.2.cmml" xref="S2.SS4.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS4.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS4.p1.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS4.p1.1.m1.2.2.2.2.2.2">ℛ</ci><ci id="S2.SS4.p1.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS4.p1.1.m1.2.2.2.2.2.3">𝑏</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.2c">\mathcal{X}=(\mathcal{E}_{b},\mathcal{R}_{b})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.2d">caligraphic_X = ( caligraphic_E start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT )</annotation></semantics></math> and the diverse user information it contains, the primary challenge arises in the computation process.
In this context, RNN-based methods face challenges in training efficiency due to their lack of parallel computing capabilities, resulting in underutilization of the computational power offered by GPUs.
Moreover, as the sequence length expands, the complexity of Transformer-based methods escalates in quadratic time, leading to a notable increase in computing expenses.
Thus, instead of processing all items in a recurrent format or calculating their attention scores,
we propose to utilize a promising sequence modeling architecture, i.e., structured state-space models (SSMs), especially Mamba <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib14" title="">2023</a>; Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite>, to handle the lengthy input sequence for the sequential recommendation.
Specifically, inspired by the most advanced mamba framework based on state space duality (SSD) layers <cite class="ltx_cite ltx_citemacro_citep">(Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite>, our proposed SSD4Rec is capable of executing block-based matrix multiplications on the extended input sequence <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><ci id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">caligraphic_X</annotation></semantics></math>, allowing segments associated with different users to be computed concurrently.
Furthermore, due to the complexities and variability of real-world behaviors, users’ historical interactions might not adhere to a strictly ordered sequence in practice <cite class="ltx_cite ltx_citemacro_citep">(Sun
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib36" title="">2019</a>)</cite>.
However, naive Mamba methods adhere to a left-to-right unidirectional modeling approach, constraining its modeling capabilities in such scenarios.
To this end, we propose to integrate reverse information from user interaction histories to construct a bidirectional block, enhancing Mamba’s capacity for comprehensive recommendations.
In order to elucidate further, we will explain how SSD4Rec processes the integrated input sequence leveraging the structured state-space duality property and detail the construction of the bidirectional block in the subsequent sub-sections.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.4.1. </span><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS1.1.1">Structured State Space Duality</span>
</h4>
<div class="ltx_para" id="S2.SS4.SSS1.p1">
<p class="ltx_p" id="S2.SS4.SSS1.p1.9">To enable classical state space models the capabilities of content-aware modeling and efficient computation, Mamba <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib14" title="">2023</a>; Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite> introduces a selection mechanism to make state matrices become functions of model input and proposes hardware-aware algorithms based on the property of Structured State-Space Duality.
In general, a standardized SSM with structured state space duality processes an input <math alttext="\mathbf{x}\in\mathbb{R}^{K\times L\times D}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.1.m1.1"><semantics id="S2.SS4.SSS1.p1.1.m1.1a"><mrow id="S2.SS4.SSS1.p1.1.m1.1.1" xref="S2.SS4.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS4.SSS1.p1.1.m1.1.1.2" xref="S2.SS4.SSS1.p1.1.m1.1.1.2.cmml">𝐱</mi><mo id="S2.SS4.SSS1.p1.1.m1.1.1.1" xref="S2.SS4.SSS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS4.SSS1.p1.1.m1.1.1.3" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS4.SSS1.p1.1.m1.1.1.3.2" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.SSS1.p1.1.m1.1.1.3.3" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.cmml"><mi id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.2" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.2.cmml">K</mi><mo id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.3" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.3.cmml">L</mi><mo id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.4" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.1.m1.1b"><apply id="S2.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1"><in id="S2.SS4.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.1"></in><ci id="S2.SS4.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.2">𝐱</ci><apply id="S2.SS4.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3"><times id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.1"></times><ci id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.2">𝐾</ci><ci id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.3">𝐿</ci><ci id="S2.SS4.SSS1.p1.1.m1.1.1.3.3.4.cmml" xref="S2.SS4.SSS1.p1.1.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.1.m1.1c">\mathbf{x}\in\mathbb{R}^{K\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.1.m1.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> and its corresponding state matrices <math alttext="\mathbf{A}\in\mathbb{R}^{K\times L\times D\times N}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.2.m2.1"><semantics id="S2.SS4.SSS1.p1.2.m2.1a"><mrow id="S2.SS4.SSS1.p1.2.m2.1.1" xref="S2.SS4.SSS1.p1.2.m2.1.1.cmml"><mi id="S2.SS4.SSS1.p1.2.m2.1.1.2" xref="S2.SS4.SSS1.p1.2.m2.1.1.2.cmml">𝐀</mi><mo id="S2.SS4.SSS1.p1.2.m2.1.1.1" xref="S2.SS4.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS4.SSS1.p1.2.m2.1.1.3" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS4.SSS1.p1.2.m2.1.1.3.2" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.SSS1.p1.2.m2.1.1.3.3" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.cmml"><mi id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.2" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.2.cmml">K</mi><mo id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.3" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.3.cmml">L</mi><mo id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.4" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.4.cmml">D</mi><mo id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.5" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.5.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.2.m2.1b"><apply id="S2.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1"><in id="S2.SS4.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.1"></in><ci id="S2.SS4.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.2">𝐀</ci><apply id="S2.SS4.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3"><times id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.1.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.1"></times><ci id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.2.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.2">𝐾</ci><ci id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.3.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.3">𝐿</ci><ci id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.4.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.4">𝐷</ci><ci id="S2.SS4.SSS1.p1.2.m2.1.1.3.3.5.cmml" xref="S2.SS4.SSS1.p1.2.m2.1.1.3.3.5">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.2.m2.1c">\mathbf{A}\in\mathbb{R}^{K\times L\times D\times N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.2.m2.1d">bold_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_L × italic_D × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{B}\in\mathbb{R}^{K\times L\times N}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.3.m3.1"><semantics id="S2.SS4.SSS1.p1.3.m3.1a"><mrow id="S2.SS4.SSS1.p1.3.m3.1.1" xref="S2.SS4.SSS1.p1.3.m3.1.1.cmml"><mi id="S2.SS4.SSS1.p1.3.m3.1.1.2" xref="S2.SS4.SSS1.p1.3.m3.1.1.2.cmml">𝐁</mi><mo id="S2.SS4.SSS1.p1.3.m3.1.1.1" xref="S2.SS4.SSS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S2.SS4.SSS1.p1.3.m3.1.1.3" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S2.SS4.SSS1.p1.3.m3.1.1.3.2" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.SSS1.p1.3.m3.1.1.3.3" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.cmml"><mi id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.2" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.2.cmml">K</mi><mo id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.3" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.3.cmml">L</mi><mo id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.4" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.4.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.3.m3.1b"><apply id="S2.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1"><in id="S2.SS4.SSS1.p1.3.m3.1.1.1.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.1"></in><ci id="S2.SS4.SSS1.p1.3.m3.1.1.2.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.2">𝐁</ci><apply id="S2.SS4.SSS1.p1.3.m3.1.1.3.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3"><times id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.1.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.1"></times><ci id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.2.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.2">𝐾</ci><ci id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.3.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.3">𝐿</ci><ci id="S2.SS4.SSS1.p1.3.m3.1.1.3.3.4.cmml" xref="S2.SS4.SSS1.p1.3.m3.1.1.3.3.4">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.3.m3.1c">\mathbf{B}\in\mathbb{R}^{K\times L\times N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.3.m3.1d">bold_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_L × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{C}\in\mathbb{R}^{K\times L\times N}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.4.m4.1"><semantics id="S2.SS4.SSS1.p1.4.m4.1a"><mrow id="S2.SS4.SSS1.p1.4.m4.1.1" xref="S2.SS4.SSS1.p1.4.m4.1.1.cmml"><mi id="S2.SS4.SSS1.p1.4.m4.1.1.2" xref="S2.SS4.SSS1.p1.4.m4.1.1.2.cmml">𝐂</mi><mo id="S2.SS4.SSS1.p1.4.m4.1.1.1" xref="S2.SS4.SSS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS4.SSS1.p1.4.m4.1.1.3" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.cmml"><mi id="S2.SS4.SSS1.p1.4.m4.1.1.3.2" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.SSS1.p1.4.m4.1.1.3.3" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.cmml"><mi id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.2" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.2.cmml">K</mi><mo id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.3" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.3.cmml">L</mi><mo id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.4" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.4.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.4.m4.1b"><apply id="S2.SS4.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1"><in id="S2.SS4.SSS1.p1.4.m4.1.1.1.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.1"></in><ci id="S2.SS4.SSS1.p1.4.m4.1.1.2.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.2">𝐂</ci><apply id="S2.SS4.SSS1.p1.4.m4.1.1.3.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3"><times id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.1.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.1"></times><ci id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.2.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.2">𝐾</ci><ci id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.3.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.3">𝐿</ci><ci id="S2.SS4.SSS1.p1.4.m4.1.1.3.3.4.cmml" xref="S2.SS4.SSS1.p1.4.m4.1.1.3.3.4">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.4.m4.1c">\mathbf{C}\in\mathbb{R}^{K\times L\times N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.4.m4.1d">bold_C ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_L × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> to generate an output sequence <math alttext="\mathbf{y}\in\mathbb{R}^{K\times L\times D}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.5.m5.1"><semantics id="S2.SS4.SSS1.p1.5.m5.1a"><mrow id="S2.SS4.SSS1.p1.5.m5.1.1" xref="S2.SS4.SSS1.p1.5.m5.1.1.cmml"><mi id="S2.SS4.SSS1.p1.5.m5.1.1.2" xref="S2.SS4.SSS1.p1.5.m5.1.1.2.cmml">𝐲</mi><mo id="S2.SS4.SSS1.p1.5.m5.1.1.1" xref="S2.SS4.SSS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S2.SS4.SSS1.p1.5.m5.1.1.3" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S2.SS4.SSS1.p1.5.m5.1.1.3.2" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.SSS1.p1.5.m5.1.1.3.3" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.cmml"><mi id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.2" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.2.cmml">K</mi><mo id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.3" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.3.cmml">L</mi><mo id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.4" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.5.m5.1b"><apply id="S2.SS4.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1"><in id="S2.SS4.SSS1.p1.5.m5.1.1.1.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.1"></in><ci id="S2.SS4.SSS1.p1.5.m5.1.1.2.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.2">𝐲</ci><apply id="S2.SS4.SSS1.p1.5.m5.1.1.3.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3"><times id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.1.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.1"></times><ci id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.2.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.2">𝐾</ci><ci id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.3.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.3">𝐿</ci><ci id="S2.SS4.SSS1.p1.5.m5.1.1.3.3.4.cmml" xref="S2.SS4.SSS1.p1.5.m5.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.5.m5.1c">\mathbf{y}\in\mathbb{R}^{K\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.5.m5.1d">bold_y ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>,
where <math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.6.m6.1"><semantics id="S2.SS4.SSS1.p1.6.m6.1a"><mi id="S2.SS4.SSS1.p1.6.m6.1.1" xref="S2.SS4.SSS1.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.6.m6.1b"><ci id="S2.SS4.SSS1.p1.6.m6.1.1.cmml" xref="S2.SS4.SSS1.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.6.m6.1d">italic_K</annotation></semantics></math>, <math alttext="L" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.7.m7.1"><semantics id="S2.SS4.SSS1.p1.7.m7.1a"><mi id="S2.SS4.SSS1.p1.7.m7.1.1" xref="S2.SS4.SSS1.p1.7.m7.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.7.m7.1b"><ci id="S2.SS4.SSS1.p1.7.m7.1.1.cmml" xref="S2.SS4.SSS1.p1.7.m7.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.7.m7.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.7.m7.1d">italic_L</annotation></semantics></math>, <math alttext="D" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.8.m8.1"><semantics id="S2.SS4.SSS1.p1.8.m8.1a"><mi id="S2.SS4.SSS1.p1.8.m8.1.1" xref="S2.SS4.SSS1.p1.8.m8.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.8.m8.1b"><ci id="S2.SS4.SSS1.p1.8.m8.1.1.cmml" xref="S2.SS4.SSS1.p1.8.m8.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.8.m8.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.8.m8.1d">italic_D</annotation></semantics></math>, and <math alttext="N" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.9.m9.1"><semantics id="S2.SS4.SSS1.p1.9.m9.1a"><mi id="S2.SS4.SSS1.p1.9.m9.1.1" xref="S2.SS4.SSS1.p1.9.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.9.m9.1b"><ci id="S2.SS4.SSS1.p1.9.m9.1.1.cmml" xref="S2.SS4.SSS1.p1.9.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.9.m9.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.9.m9.1d">italic_N</annotation></semantics></math> represent the batch size, sequence length, input dimension, and hidden dimension.
This process can be expressed by</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx5">
<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}" class="ltx_Math" display="inline" id="S2.E6.m1.1"><semantics id="S2.E6.m1.1a"><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">bold_y</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\textbf{SSM}(\mathbf{A},\mathbf{B},\mathbf{C})(\mathbf{x})=%
\mathbf{M}\mathbf{x}," class="ltx_Math" display="inline" id="S2.E6.m2.5"><semantics id="S2.E6.m2.5a"><mrow id="S2.E6.m2.5.5.1" xref="S2.E6.m2.5.5.1.1.cmml"><mrow id="S2.E6.m2.5.5.1.1" xref="S2.E6.m2.5.5.1.1.cmml"><mi id="S2.E6.m2.5.5.1.1.2" xref="S2.E6.m2.5.5.1.1.2.cmml"></mi><mo id="S2.E6.m2.5.5.1.1.3" xref="S2.E6.m2.5.5.1.1.3.cmml">=</mo><mrow id="S2.E6.m2.5.5.1.1.4" xref="S2.E6.m2.5.5.1.1.4.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E6.m2.5.5.1.1.4.2" xref="S2.E6.m2.5.5.1.1.4.2a.cmml">SSM</mtext><mo id="S2.E6.m2.5.5.1.1.4.1" xref="S2.E6.m2.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S2.E6.m2.5.5.1.1.4.3.2" xref="S2.E6.m2.5.5.1.1.4.3.1.cmml"><mo id="S2.E6.m2.5.5.1.1.4.3.2.1" stretchy="false" xref="S2.E6.m2.5.5.1.1.4.3.1.cmml">(</mo><mi id="S2.E6.m2.1.1" xref="S2.E6.m2.1.1.cmml">𝐀</mi><mo id="S2.E6.m2.5.5.1.1.4.3.2.2" xref="S2.E6.m2.5.5.1.1.4.3.1.cmml">,</mo><mi id="S2.E6.m2.2.2" xref="S2.E6.m2.2.2.cmml">𝐁</mi><mo id="S2.E6.m2.5.5.1.1.4.3.2.3" xref="S2.E6.m2.5.5.1.1.4.3.1.cmml">,</mo><mi id="S2.E6.m2.3.3" xref="S2.E6.m2.3.3.cmml">𝐂</mi><mo id="S2.E6.m2.5.5.1.1.4.3.2.4" stretchy="false" xref="S2.E6.m2.5.5.1.1.4.3.1.cmml">)</mo></mrow><mo id="S2.E6.m2.5.5.1.1.4.1a" xref="S2.E6.m2.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S2.E6.m2.5.5.1.1.4.4.2" xref="S2.E6.m2.5.5.1.1.4.cmml"><mo id="S2.E6.m2.5.5.1.1.4.4.2.1" stretchy="false" xref="S2.E6.m2.5.5.1.1.4.cmml">(</mo><mi id="S2.E6.m2.4.4" xref="S2.E6.m2.4.4.cmml">𝐱</mi><mo id="S2.E6.m2.5.5.1.1.4.4.2.2" stretchy="false" xref="S2.E6.m2.5.5.1.1.4.cmml">)</mo></mrow></mrow><mo id="S2.E6.m2.5.5.1.1.5" xref="S2.E6.m2.5.5.1.1.5.cmml">=</mo><mi id="S2.E6.m2.5.5.1.1.6" xref="S2.E6.m2.5.5.1.1.6.cmml">𝐌𝐱</mi></mrow><mo id="S2.E6.m2.5.5.1.2" xref="S2.E6.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m2.5b"><apply id="S2.E6.m2.5.5.1.1.cmml" xref="S2.E6.m2.5.5.1"><and id="S2.E6.m2.5.5.1.1a.cmml" xref="S2.E6.m2.5.5.1"></and><apply id="S2.E6.m2.5.5.1.1b.cmml" xref="S2.E6.m2.5.5.1"><eq id="S2.E6.m2.5.5.1.1.3.cmml" xref="S2.E6.m2.5.5.1.1.3"></eq><csymbol cd="latexml" id="S2.E6.m2.5.5.1.1.2.cmml" xref="S2.E6.m2.5.5.1.1.2">absent</csymbol><apply id="S2.E6.m2.5.5.1.1.4.cmml" xref="S2.E6.m2.5.5.1.1.4"><times id="S2.E6.m2.5.5.1.1.4.1.cmml" xref="S2.E6.m2.5.5.1.1.4.1"></times><ci id="S2.E6.m2.5.5.1.1.4.2a.cmml" xref="S2.E6.m2.5.5.1.1.4.2"><mtext class="ltx_mathvariant_bold" id="S2.E6.m2.5.5.1.1.4.2.cmml" xref="S2.E6.m2.5.5.1.1.4.2">SSM</mtext></ci><vector id="S2.E6.m2.5.5.1.1.4.3.1.cmml" xref="S2.E6.m2.5.5.1.1.4.3.2"><ci id="S2.E6.m2.1.1.cmml" xref="S2.E6.m2.1.1">𝐀</ci><ci id="S2.E6.m2.2.2.cmml" xref="S2.E6.m2.2.2">𝐁</ci><ci id="S2.E6.m2.3.3.cmml" xref="S2.E6.m2.3.3">𝐂</ci></vector><ci id="S2.E6.m2.4.4.cmml" xref="S2.E6.m2.4.4">𝐱</ci></apply></apply><apply id="S2.E6.m2.5.5.1.1c.cmml" xref="S2.E6.m2.5.5.1"><eq id="S2.E6.m2.5.5.1.1.5.cmml" xref="S2.E6.m2.5.5.1.1.5"></eq><share href="https://arxiv.org/html/2409.01192v1#S2.E6.m2.5.5.1.1.4.cmml" id="S2.E6.m2.5.5.1.1d.cmml" xref="S2.E6.m2.5.5.1"></share><ci id="S2.E6.m2.5.5.1.1.6.cmml" xref="S2.E6.m2.5.5.1.1.6">𝐌𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m2.5c">\displaystyle=\textbf{SSM}(\mathbf{A},\mathbf{B},\mathbf{C})(\mathbf{x})=%
\mathbf{M}\mathbf{x},</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m2.5d">= SSM ( bold_A , bold_B , bold_C ) ( bold_x ) = bold_Mx ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{s.t.}~{}\mathbf{M}" class="ltx_Math" display="inline" id="S2.E7.m1.1"><semantics id="S2.E7.m1.1a"><mrow id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml"><mtext id="S2.E7.m1.1.1.2" xref="S2.E7.m1.1.1.2a.cmml">s.t.</mtext><mo id="S2.E7.m1.1.1.1" lspace="0.330em" xref="S2.E7.m1.1.1.1.cmml">⁢</mo><mi id="S2.E7.m1.1.1.3" xref="S2.E7.m1.1.1.3.cmml">𝐌</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.1b"><apply id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1"><times id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"></times><ci id="S2.E7.m1.1.1.2a.cmml" xref="S2.E7.m1.1.1.2"><mtext id="S2.E7.m1.1.1.2.cmml" xref="S2.E7.m1.1.1.2">s.t.</mtext></ci><ci id="S2.E7.m1.1.1.3.cmml" xref="S2.E7.m1.1.1.3">𝐌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.1c">\displaystyle\text{s.t.}~{}\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.1d">s.t. bold_M</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{bmatrix}(\mathbf{C}^{0})^{\top}\mathbf{A}^{0:0}\mathbf{B}%
^{0}&amp;&amp;&amp;\\
(\mathbf{C}^{1})^{\top}\mathbf{A}^{1:0}\mathbf{B}^{0}&amp;(\mathbf{C}^{1})^{\top}%
\mathbf{A}^{1:1}\mathbf{B}^{1}&amp;&amp;\\
...&amp;...&amp;...&amp;\\
(\mathbf{C}^{j})^{\top}\mathbf{A}^{j:0}\mathbf{B}^{0}&amp;(\mathbf{C}^{j})^{\top}%
\mathbf{A}^{j:1}\mathbf{B}^{1}&amp;...&amp;(\mathbf{C}^{j})^{\top}\mathbf{A}^{j:i}%
\mathbf{B}^{i}\\
\end{bmatrix}," class="ltx_Math" display="inline" id="S2.E7.m2.2"><semantics id="S2.E7.m2.2a"><mrow id="S2.E7.m2.2.2.1" xref="S2.E7.m2.2.2.1.1.cmml"><mrow id="S2.E7.m2.2.2.1.1" xref="S2.E7.m2.2.2.1.1.cmml"><mi id="S2.E7.m2.2.2.1.1.2" xref="S2.E7.m2.2.2.1.1.2.cmml"></mi><mo id="S2.E7.m2.2.2.1.1.1" xref="S2.E7.m2.2.2.1.1.1.cmml">=</mo><mrow id="S2.E7.m2.1.1a.3" xref="S2.E7.m2.1.1a.2.cmml"><mo id="S2.E7.m2.1.1a.3.1" xref="S2.E7.m2.1.1a.2.1.cmml">[</mo><mtable columnspacing="5pt" id="S2.E7.m2.1.1.1.1" rowspacing="0pt" xref="S2.E7.m2.1.1.1.1.cmml"><mtr id="S2.E7.m2.1.1.1.1a" xref="S2.E7.m2.1.1.1.1.cmml"><mtd id="S2.E7.m2.1.1.1.1b" xref="S2.E7.m2.1.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E7.m2.1.1.1.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐂</mi><mn id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msup><mo id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E7.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S2.E7.m2.1.1.1.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.2.cmml">𝐀</mi><mrow id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.2.cmml">0</mn><mo id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mn id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.3.cmml">0</mn></mrow></msup><mo id="S2.E7.m2.1.1.1.1.1.1.1.1.2a" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.1.1.1.1.4" xref="S2.E7.m2.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E7.m2.1.1.1.1.1.1.1.1.4.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.4.2.cmml">𝐁</mi><mn id="S2.E7.m2.1.1.1.1.1.1.1.1.4.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.4.3.cmml">0</mn></msup></mrow></mtd><mtd id="S2.E7.m2.1.1.1.1c" xref="S2.E7.m2.1.1.1.1.cmml"></mtd><mtd id="S2.E7.m2.1.1.1.1d" xref="S2.E7.m2.1.1.1.1.cmml"></mtd><mtd id="S2.E7.m2.1.1.1.1e" xref="S2.E7.m2.1.1.1.1.cmml"></mtd></mtr><mtr id="S2.E7.m2.1.1.1.1f" xref="S2.E7.m2.1.1.1.1.cmml"><mtd id="S2.E7.m2.1.1.1.1g" xref="S2.E7.m2.1.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.2.2.1.1" xref="S2.E7.m2.1.1.1.1.2.2.1.1.cmml"><msup id="S2.E7.m2.1.1.1.1.2.2.1.1.1" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml">𝐂</mi><mn id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E7.m2.1.1.1.1.2.2.1.1.1.3" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.3.cmml">⊤</mo></msup><mo id="S2.E7.m2.1.1.1.1.2.2.1.1.2" xref="S2.E7.m2.1.1.1.1.2.2.1.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.2.2.1.1.3" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.cmml"><mi id="S2.E7.m2.1.1.1.1.2.2.1.1.3.2" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.2.cmml">𝐀</mi><mrow id="S2.E7.m2.1.1.1.1.2.2.1.1.3.3" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.cmml"><mn id="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.2" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.2.cmml">1</mn><mo id="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.1.cmml">:</mo><mn id="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.3" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.3.cmml">0</mn></mrow></msup><mo id="S2.E7.m2.1.1.1.1.2.2.1.1.2a" xref="S2.E7.m2.1.1.1.1.2.2.1.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.2.2.1.1.4" xref="S2.E7.m2.1.1.1.1.2.2.1.1.4.cmml"><mi id="S2.E7.m2.1.1.1.1.2.2.1.1.4.2" xref="S2.E7.m2.1.1.1.1.2.2.1.1.4.2.cmml">𝐁</mi><mn id="S2.E7.m2.1.1.1.1.2.2.1.1.4.3" xref="S2.E7.m2.1.1.1.1.2.2.1.1.4.3.cmml">0</mn></msup></mrow></mtd><mtd id="S2.E7.m2.1.1.1.1h" xref="S2.E7.m2.1.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.3.3.2.1" xref="S2.E7.m2.1.1.1.1.3.3.2.1.cmml"><msup id="S2.E7.m2.1.1.1.1.3.3.2.1.1" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.cmml"><mo id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.2" stretchy="false" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.cmml">(</mo><msup id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.2.cmml">𝐂</mi><mn id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.3" stretchy="false" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E7.m2.1.1.1.1.3.3.2.1.1.3" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.3.cmml">⊤</mo></msup><mo id="S2.E7.m2.1.1.1.1.3.3.2.1.2" xref="S2.E7.m2.1.1.1.1.3.3.2.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.3.3.2.1.3" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.cmml"><mi id="S2.E7.m2.1.1.1.1.3.3.2.1.3.2" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.2.cmml">𝐀</mi><mrow id="S2.E7.m2.1.1.1.1.3.3.2.1.3.3" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.cmml"><mn id="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.2" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.2.cmml">1</mn><mo id="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.1.cmml">:</mo><mn id="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.3" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S2.E7.m2.1.1.1.1.3.3.2.1.2a" xref="S2.E7.m2.1.1.1.1.3.3.2.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.3.3.2.1.4" xref="S2.E7.m2.1.1.1.1.3.3.2.1.4.cmml"><mi id="S2.E7.m2.1.1.1.1.3.3.2.1.4.2" xref="S2.E7.m2.1.1.1.1.3.3.2.1.4.2.cmml">𝐁</mi><mn id="S2.E7.m2.1.1.1.1.3.3.2.1.4.3" xref="S2.E7.m2.1.1.1.1.3.3.2.1.4.3.cmml">1</mn></msup></mrow></mtd><mtd id="S2.E7.m2.1.1.1.1i" xref="S2.E7.m2.1.1.1.1.cmml"></mtd><mtd id="S2.E7.m2.1.1.1.1j" xref="S2.E7.m2.1.1.1.1.cmml"></mtd></mtr><mtr id="S2.E7.m2.1.1.1.1k" xref="S2.E7.m2.1.1.1.1.cmml"><mtd id="S2.E7.m2.1.1.1.1l" xref="S2.E7.m2.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.7.1.1" mathvariant="normal" xref="S2.E7.m2.1.1.1.1.7.1.1.cmml">…</mi></mtd><mtd id="S2.E7.m2.1.1.1.1m" xref="S2.E7.m2.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.7.2.1" mathvariant="normal" xref="S2.E7.m2.1.1.1.1.7.2.1.cmml">…</mi></mtd><mtd id="S2.E7.m2.1.1.1.1n" xref="S2.E7.m2.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.7.3.1" mathvariant="normal" xref="S2.E7.m2.1.1.1.1.7.3.1.cmml">…</mi></mtd><mtd id="S2.E7.m2.1.1.1.1o" xref="S2.E7.m2.1.1.1.1.cmml"></mtd></mtr><mtr id="S2.E7.m2.1.1.1.1p" xref="S2.E7.m2.1.1.1.1.cmml"><mtd id="S2.E7.m2.1.1.1.1q" xref="S2.E7.m2.1.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.4.4.1.1" xref="S2.E7.m2.1.1.1.1.4.4.1.1.cmml"><msup id="S2.E7.m2.1.1.1.1.4.4.1.1.1" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.cmml"><mo id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.2.cmml">𝐂</mi><mi id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.3.cmml">j</mi></msup><mo id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E7.m2.1.1.1.1.4.4.1.1.1.3" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.3.cmml">⊤</mo></msup><mo id="S2.E7.m2.1.1.1.1.4.4.1.1.2" xref="S2.E7.m2.1.1.1.1.4.4.1.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.4.4.1.1.3" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.cmml"><mi id="S2.E7.m2.1.1.1.1.4.4.1.1.3.2" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.2.cmml">𝐀</mi><mrow id="S2.E7.m2.1.1.1.1.4.4.1.1.3.3" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.cmml"><mi id="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.2" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.2.cmml">j</mi><mo id="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.1.cmml">:</mo><mn id="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.3" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.3.cmml">0</mn></mrow></msup><mo id="S2.E7.m2.1.1.1.1.4.4.1.1.2a" xref="S2.E7.m2.1.1.1.1.4.4.1.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.4.4.1.1.4" xref="S2.E7.m2.1.1.1.1.4.4.1.1.4.cmml"><mi id="S2.E7.m2.1.1.1.1.4.4.1.1.4.2" xref="S2.E7.m2.1.1.1.1.4.4.1.1.4.2.cmml">𝐁</mi><mn id="S2.E7.m2.1.1.1.1.4.4.1.1.4.3" xref="S2.E7.m2.1.1.1.1.4.4.1.1.4.3.cmml">0</mn></msup></mrow></mtd><mtd id="S2.E7.m2.1.1.1.1r" xref="S2.E7.m2.1.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.5.5.2.1" xref="S2.E7.m2.1.1.1.1.5.5.2.1.cmml"><msup id="S2.E7.m2.1.1.1.1.5.5.2.1.1" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.cmml"><mo id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.2" stretchy="false" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.cmml">(</mo><msup id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.2.cmml">𝐂</mi><mi id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.3.cmml">j</mi></msup><mo id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.3" stretchy="false" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E7.m2.1.1.1.1.5.5.2.1.1.3" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.3.cmml">⊤</mo></msup><mo id="S2.E7.m2.1.1.1.1.5.5.2.1.2" xref="S2.E7.m2.1.1.1.1.5.5.2.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.5.5.2.1.3" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.cmml"><mi id="S2.E7.m2.1.1.1.1.5.5.2.1.3.2" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.2.cmml">𝐀</mi><mrow id="S2.E7.m2.1.1.1.1.5.5.2.1.3.3" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.cmml"><mi id="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.2" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.2.cmml">j</mi><mo id="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.1.cmml">:</mo><mn id="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.3" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S2.E7.m2.1.1.1.1.5.5.2.1.2a" xref="S2.E7.m2.1.1.1.1.5.5.2.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.5.5.2.1.4" xref="S2.E7.m2.1.1.1.1.5.5.2.1.4.cmml"><mi id="S2.E7.m2.1.1.1.1.5.5.2.1.4.2" xref="S2.E7.m2.1.1.1.1.5.5.2.1.4.2.cmml">𝐁</mi><mn id="S2.E7.m2.1.1.1.1.5.5.2.1.4.3" xref="S2.E7.m2.1.1.1.1.5.5.2.1.4.3.cmml">1</mn></msup></mrow></mtd><mtd id="S2.E7.m2.1.1.1.1s" xref="S2.E7.m2.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.6.6.4.1" mathvariant="normal" xref="S2.E7.m2.1.1.1.1.6.6.4.1.cmml">…</mi></mtd><mtd id="S2.E7.m2.1.1.1.1t" xref="S2.E7.m2.1.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.6.6.3.1" xref="S2.E7.m2.1.1.1.1.6.6.3.1.cmml"><msup id="S2.E7.m2.1.1.1.1.6.6.3.1.1" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.cmml"><mo id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.2" stretchy="false" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.cmml">(</mo><msup id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.2.cmml">𝐂</mi><mi id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.3.cmml">j</mi></msup><mo id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.3" stretchy="false" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E7.m2.1.1.1.1.6.6.3.1.1.3" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.3.cmml">⊤</mo></msup><mo id="S2.E7.m2.1.1.1.1.6.6.3.1.2" xref="S2.E7.m2.1.1.1.1.6.6.3.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.6.6.3.1.3" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.cmml"><mi id="S2.E7.m2.1.1.1.1.6.6.3.1.3.2" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.2.cmml">𝐀</mi><mrow id="S2.E7.m2.1.1.1.1.6.6.3.1.3.3" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.cmml"><mi id="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.2" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.2.cmml">j</mi><mo id="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.1.cmml">:</mo><mi id="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.3" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.3.cmml">i</mi></mrow></msup><mo id="S2.E7.m2.1.1.1.1.6.6.3.1.2a" xref="S2.E7.m2.1.1.1.1.6.6.3.1.2.cmml">⁢</mo><msup id="S2.E7.m2.1.1.1.1.6.6.3.1.4" xref="S2.E7.m2.1.1.1.1.6.6.3.1.4.cmml"><mi id="S2.E7.m2.1.1.1.1.6.6.3.1.4.2" xref="S2.E7.m2.1.1.1.1.6.6.3.1.4.2.cmml">𝐁</mi><mi id="S2.E7.m2.1.1.1.1.6.6.3.1.4.3" xref="S2.E7.m2.1.1.1.1.6.6.3.1.4.3.cmml">i</mi></msup></mrow></mtd></mtr></mtable><mo id="S2.E7.m2.1.1a.3.2" xref="S2.E7.m2.1.1a.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E7.m2.2.2.1.2" xref="S2.E7.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m2.2b"><apply id="S2.E7.m2.2.2.1.1.cmml" xref="S2.E7.m2.2.2.1"><eq id="S2.E7.m2.2.2.1.1.1.cmml" xref="S2.E7.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S2.E7.m2.2.2.1.1.2.cmml" xref="S2.E7.m2.2.2.1.1.2">absent</csymbol><apply id="S2.E7.m2.1.1a.2.cmml" xref="S2.E7.m2.1.1a.3"><csymbol cd="latexml" id="S2.E7.m2.1.1a.2.1.cmml" xref="S2.E7.m2.1.1a.3.1">matrix</csymbol><matrix id="S2.E7.m2.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1"><matrixrow id="S2.E7.m2.1.1.1.1a.cmml" xref="S2.E7.m2.1.1.1.1"><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1"><times id="S2.E7.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐂</ci><cn id="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.2">𝐀</ci><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3"><ci id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.1">:</ci><cn id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.2">0</cn><cn id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.3">0</cn></apply></apply><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.4.2">𝐁</ci><cn id="S2.E7.m2.1.1.1.1.1.1.1.1.4.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.1.1.1.1.4.3">0</cn></apply></apply><cerror id="S2.E7.m2.1.1.1.1b.cmml" xref="S2.E7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1c.cmml" xref="S2.E7.m2.1.1.1.1">missing-subexpression</csymbol></cerror><cerror id="S2.E7.m2.1.1.1.1d.cmml" xref="S2.E7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1e.cmml" xref="S2.E7.m2.1.1.1.1">missing-subexpression</csymbol></cerror><cerror id="S2.E7.m2.1.1.1.1f.cmml" xref="S2.E7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1g.cmml" xref="S2.E7.m2.1.1.1.1">missing-subexpression</csymbol></cerror></matrixrow><matrixrow id="S2.E7.m2.1.1.1.1h.cmml" xref="S2.E7.m2.1.1.1.1"><apply id="S2.E7.m2.1.1.1.1.2.2.1.1.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1"><times id="S2.E7.m2.1.1.1.1.2.2.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.2"></times><apply id="S2.E7.m2.1.1.1.1.2.2.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.2.2.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1">superscript</csymbol><apply id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.2">𝐂</ci><cn id="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.1.1.1.3">1</cn></apply><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.2.2.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.1.3">top</csymbol></apply><apply id="S2.E7.m2.1.1.1.1.2.2.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.2.2.1.1.3.1.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.2.2.1.1.3.2.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.2">𝐀</ci><apply id="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.3"><ci id="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.1">:</ci><cn id="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.2.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.2">1</cn><cn id="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.2.2.1.1.3.3.3">0</cn></apply></apply><apply id="S2.E7.m2.1.1.1.1.2.2.1.1.4.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.2.2.1.1.4.1.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.4">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.2.2.1.1.4.2.cmml" xref="S2.E7.m2.1.1.1.1.2.2.1.1.4.2">𝐁</ci><cn id="S2.E7.m2.1.1.1.1.2.2.1.1.4.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.2.2.1.1.4.3">0</cn></apply></apply><apply id="S2.E7.m2.1.1.1.1.3.3.2.1.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1"><times id="S2.E7.m2.1.1.1.1.3.3.2.1.2.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.2"></times><apply id="S2.E7.m2.1.1.1.1.3.3.2.1.1.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.3.3.2.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1">superscript</csymbol><apply id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.2">𝐂</ci><cn id="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.1.1.1.3">1</cn></apply><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.3.3.2.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.1.3">top</csymbol></apply><apply id="S2.E7.m2.1.1.1.1.3.3.2.1.3.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.3.3.2.1.3.1.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.3.3.2.1.3.2.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.2">𝐀</ci><apply id="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.3"><ci id="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.1.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.1">:</ci><cn id="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.2.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.2">1</cn><cn id="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.3.3.2.1.3.3.3">1</cn></apply></apply><apply id="S2.E7.m2.1.1.1.1.3.3.2.1.4.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.4"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.3.3.2.1.4.1.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.4">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.3.3.2.1.4.2.cmml" xref="S2.E7.m2.1.1.1.1.3.3.2.1.4.2">𝐁</ci><cn id="S2.E7.m2.1.1.1.1.3.3.2.1.4.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.3.3.2.1.4.3">1</cn></apply></apply><cerror id="S2.E7.m2.1.1.1.1i.cmml" xref="S2.E7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1j.cmml" xref="S2.E7.m2.1.1.1.1">missing-subexpression</csymbol></cerror><cerror id="S2.E7.m2.1.1.1.1k.cmml" xref="S2.E7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1l.cmml" xref="S2.E7.m2.1.1.1.1">missing-subexpression</csymbol></cerror></matrixrow><matrixrow id="S2.E7.m2.1.1.1.1m.cmml" xref="S2.E7.m2.1.1.1.1"><ci id="S2.E7.m2.1.1.1.1.7.1.1.cmml" xref="S2.E7.m2.1.1.1.1.7.1.1">…</ci><ci id="S2.E7.m2.1.1.1.1.7.2.1.cmml" xref="S2.E7.m2.1.1.1.1.7.2.1">…</ci><ci id="S2.E7.m2.1.1.1.1.7.3.1.cmml" xref="S2.E7.m2.1.1.1.1.7.3.1">…</ci><cerror id="S2.E7.m2.1.1.1.1n.cmml" xref="S2.E7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1o.cmml" xref="S2.E7.m2.1.1.1.1">missing-subexpression</csymbol></cerror></matrixrow><matrixrow id="S2.E7.m2.1.1.1.1p.cmml" xref="S2.E7.m2.1.1.1.1"><apply id="S2.E7.m2.1.1.1.1.4.4.1.1.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1"><times id="S2.E7.m2.1.1.1.1.4.4.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.2"></times><apply id="S2.E7.m2.1.1.1.1.4.4.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.4.4.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1">superscript</csymbol><apply id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.2">𝐂</ci><ci id="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.1.1.1.3">𝑗</ci></apply><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.4.4.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.1.3">top</csymbol></apply><apply id="S2.E7.m2.1.1.1.1.4.4.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.4.4.1.1.3.1.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.4.4.1.1.3.2.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.2">𝐀</ci><apply id="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.3"><ci id="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.1.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.1">:</ci><ci id="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.2.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.2">𝑗</ci><cn id="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.4.4.1.1.3.3.3">0</cn></apply></apply><apply id="S2.E7.m2.1.1.1.1.4.4.1.1.4.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.4"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.4.4.1.1.4.1.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.4">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.4.4.1.1.4.2.cmml" xref="S2.E7.m2.1.1.1.1.4.4.1.1.4.2">𝐁</ci><cn id="S2.E7.m2.1.1.1.1.4.4.1.1.4.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.4.4.1.1.4.3">0</cn></apply></apply><apply id="S2.E7.m2.1.1.1.1.5.5.2.1.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1"><times id="S2.E7.m2.1.1.1.1.5.5.2.1.2.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.2"></times><apply id="S2.E7.m2.1.1.1.1.5.5.2.1.1.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.5.5.2.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1">superscript</csymbol><apply id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.2">𝐂</ci><ci id="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.1.1.1.3">𝑗</ci></apply><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.5.5.2.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.1.3">top</csymbol></apply><apply id="S2.E7.m2.1.1.1.1.5.5.2.1.3.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.5.5.2.1.3.1.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.5.5.2.1.3.2.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.2">𝐀</ci><apply id="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.3"><ci id="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.1.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.1">:</ci><ci id="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.2.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.2">𝑗</ci><cn id="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.5.5.2.1.3.3.3">1</cn></apply></apply><apply id="S2.E7.m2.1.1.1.1.5.5.2.1.4.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.4"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.5.5.2.1.4.1.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.4">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.5.5.2.1.4.2.cmml" xref="S2.E7.m2.1.1.1.1.5.5.2.1.4.2">𝐁</ci><cn id="S2.E7.m2.1.1.1.1.5.5.2.1.4.3.cmml" type="integer" xref="S2.E7.m2.1.1.1.1.5.5.2.1.4.3">1</cn></apply></apply><ci id="S2.E7.m2.1.1.1.1.6.6.4.1.cmml" xref="S2.E7.m2.1.1.1.1.6.6.4.1">…</ci><apply id="S2.E7.m2.1.1.1.1.6.6.3.1.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1"><times id="S2.E7.m2.1.1.1.1.6.6.3.1.2.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.2"></times><apply id="S2.E7.m2.1.1.1.1.6.6.3.1.1.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.6.6.3.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1">superscript</csymbol><apply id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.2">𝐂</ci><ci id="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.1.1.1.3">𝑗</ci></apply><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.6.6.3.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.1.3">top</csymbol></apply><apply id="S2.E7.m2.1.1.1.1.6.6.3.1.3.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.6.6.3.1.3.1.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.6.6.3.1.3.2.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.2">𝐀</ci><apply id="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.3"><ci id="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.1.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.1">:</ci><ci id="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.2.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.2">𝑗</ci><ci id="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.3.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.3.3.3">𝑖</ci></apply></apply><apply id="S2.E7.m2.1.1.1.1.6.6.3.1.4.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.4"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.6.6.3.1.4.1.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.4">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.6.6.3.1.4.2.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.4.2">𝐁</ci><ci id="S2.E7.m2.1.1.1.1.6.6.3.1.4.3.cmml" xref="S2.E7.m2.1.1.1.1.6.6.3.1.4.3">𝑖</ci></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m2.2c">\displaystyle=\begin{bmatrix}(\mathbf{C}^{0})^{\top}\mathbf{A}^{0:0}\mathbf{B}%
^{0}&amp;&amp;&amp;\\
(\mathbf{C}^{1})^{\top}\mathbf{A}^{1:0}\mathbf{B}^{0}&amp;(\mathbf{C}^{1})^{\top}%
\mathbf{A}^{1:1}\mathbf{B}^{1}&amp;&amp;\\
...&amp;...&amp;...&amp;\\
(\mathbf{C}^{j})^{\top}\mathbf{A}^{j:0}\mathbf{B}^{0}&amp;(\mathbf{C}^{j})^{\top}%
\mathbf{A}^{j:1}\mathbf{B}^{1}&amp;...&amp;(\mathbf{C}^{j})^{\top}\mathbf{A}^{j:i}%
\mathbf{B}^{i}\\
\end{bmatrix},</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m2.2d">= [ start_ARG start_ROW start_CELL ( bold_C start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_A start_POSTSUPERSCRIPT 0 : 0 end_POSTSUPERSCRIPT bold_B start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT end_CELL start_CELL end_CELL start_CELL end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL ( bold_C start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_A start_POSTSUPERSCRIPT 1 : 0 end_POSTSUPERSCRIPT bold_B start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT end_CELL start_CELL ( bold_C start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_A start_POSTSUPERSCRIPT 1 : 1 end_POSTSUPERSCRIPT bold_B start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT end_CELL start_CELL end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL … end_CELL start_CELL … end_CELL start_CELL … end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL ( bold_C start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_A start_POSTSUPERSCRIPT italic_j : 0 end_POSTSUPERSCRIPT bold_B start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT end_CELL start_CELL ( bold_C start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_A start_POSTSUPERSCRIPT italic_j : 1 end_POSTSUPERSCRIPT bold_B start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT end_CELL start_CELL … end_CELL start_CELL ( bold_C start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_A start_POSTSUPERSCRIPT italic_j : italic_i end_POSTSUPERSCRIPT bold_B start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT end_CELL end_ROW end_ARG ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS1.p1.22">where <math alttext="\mathbf{M}^{ji}=(\mathbf{C}^{j})^{\top}\mathbf{A}^{j:i}\mathbf{B}^{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.10.m1.1"><semantics id="S2.SS4.SSS1.p1.10.m1.1a"><mrow id="S2.SS4.SSS1.p1.10.m1.1.1" xref="S2.SS4.SSS1.p1.10.m1.1.1.cmml"><msup id="S2.SS4.SSS1.p1.10.m1.1.1.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.cmml"><mi id="S2.SS4.SSS1.p1.10.m1.1.1.3.2" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.2.cmml">𝐌</mi><mrow id="S2.SS4.SSS1.p1.10.m1.1.1.3.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.3.cmml"><mi id="S2.SS4.SSS1.p1.10.m1.1.1.3.3.2" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.3.2.cmml">j</mi><mo id="S2.SS4.SSS1.p1.10.m1.1.1.3.3.1" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS4.SSS1.p1.10.m1.1.1.3.3.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.3.3.cmml">i</mi></mrow></msup><mo id="S2.SS4.SSS1.p1.10.m1.1.1.2" xref="S2.SS4.SSS1.p1.10.m1.1.1.2.cmml">=</mo><mrow id="S2.SS4.SSS1.p1.10.m1.1.1.1" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.cmml"><msup id="S2.SS4.SSS1.p1.10.m1.1.1.1.1" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.cmml"><mrow id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.2" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.2.cmml">𝐂</mi><mi id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msup><mo id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S2.SS4.SSS1.p1.10.m1.1.1.1.2" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.2.cmml">⁢</mo><msup id="S2.SS4.SSS1.p1.10.m1.1.1.1.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.cmml"><mi id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.2" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.2.cmml">𝐀</mi><mrow id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.cmml"><mi id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.2" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.2.cmml">j</mi><mo id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.1.cmml">:</mo><mi id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.3.cmml">i</mi></mrow></msup><mo id="S2.SS4.SSS1.p1.10.m1.1.1.1.2a" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.2.cmml">⁢</mo><msup id="S2.SS4.SSS1.p1.10.m1.1.1.1.4" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.4.cmml"><mi id="S2.SS4.SSS1.p1.10.m1.1.1.1.4.2" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.4.2.cmml">𝐁</mi><mi id="S2.SS4.SSS1.p1.10.m1.1.1.1.4.3" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.4.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.10.m1.1b"><apply id="S2.SS4.SSS1.p1.10.m1.1.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1"><eq id="S2.SS4.SSS1.p1.10.m1.1.1.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.2"></eq><apply id="S2.SS4.SSS1.p1.10.m1.1.1.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.10.m1.1.1.3.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS1.p1.10.m1.1.1.3.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.2">𝐌</ci><apply id="S2.SS4.SSS1.p1.10.m1.1.1.3.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.3"><times id="S2.SS4.SSS1.p1.10.m1.1.1.3.3.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.3.1"></times><ci id="S2.SS4.SSS1.p1.10.m1.1.1.3.3.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.3.2">𝑗</ci><ci id="S2.SS4.SSS1.p1.10.m1.1.1.3.3.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S2.SS4.SSS1.p1.10.m1.1.1.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1"><times id="S2.SS4.SSS1.p1.10.m1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.2"></times><apply id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1">superscript</csymbol><apply id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.2">𝐂</ci><ci id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply><csymbol cd="latexml" id="S2.SS4.SSS1.p1.10.m1.1.1.1.1.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.1.3">top</csymbol></apply><apply id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.2">𝐀</ci><apply id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3"><ci id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.1">:</ci><ci id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.2">𝑗</ci><ci id="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S2.SS4.SSS1.p1.10.m1.1.1.1.4.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.10.m1.1.1.1.4.1.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.4">superscript</csymbol><ci id="S2.SS4.SSS1.p1.10.m1.1.1.1.4.2.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.4.2">𝐁</ci><ci id="S2.SS4.SSS1.p1.10.m1.1.1.1.4.3.cmml" xref="S2.SS4.SSS1.p1.10.m1.1.1.1.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.10.m1.1c">\mathbf{M}^{ji}=(\mathbf{C}^{j})^{\top}\mathbf{A}^{j:i}\mathbf{B}^{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.10.m1.1d">bold_M start_POSTSUPERSCRIPT italic_j italic_i end_POSTSUPERSCRIPT = ( bold_C start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_A start_POSTSUPERSCRIPT italic_j : italic_i end_POSTSUPERSCRIPT bold_B start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> represents the mapping of the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.11.m2.1"><semantics id="S2.SS4.SSS1.p1.11.m2.1a"><mi id="S2.SS4.SSS1.p1.11.m2.1.1" xref="S2.SS4.SSS1.p1.11.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.11.m2.1b"><ci id="S2.SS4.SSS1.p1.11.m2.1.1.cmml" xref="S2.SS4.SSS1.p1.11.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.11.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.11.m2.1d">italic_i</annotation></semantics></math>-th token in the input sequence <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.12.m3.1"><semantics id="S2.SS4.SSS1.p1.12.m3.1a"><mi id="S2.SS4.SSS1.p1.12.m3.1.1" xref="S2.SS4.SSS1.p1.12.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.12.m3.1b"><ci id="S2.SS4.SSS1.p1.12.m3.1.1.cmml" xref="S2.SS4.SSS1.p1.12.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.12.m3.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.12.m3.1d">bold_x</annotation></semantics></math> to the <math alttext="j" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.13.m4.1"><semantics id="S2.SS4.SSS1.p1.13.m4.1a"><mi id="S2.SS4.SSS1.p1.13.m4.1.1" xref="S2.SS4.SSS1.p1.13.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.13.m4.1b"><ci id="S2.SS4.SSS1.p1.13.m4.1.1.cmml" xref="S2.SS4.SSS1.p1.13.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.13.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.13.m4.1d">italic_j</annotation></semantics></math>-th token in the output <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.14.m5.1"><semantics id="S2.SS4.SSS1.p1.14.m5.1a"><mi id="S2.SS4.SSS1.p1.14.m5.1.1" xref="S2.SS4.SSS1.p1.14.m5.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.14.m5.1b"><ci id="S2.SS4.SSS1.p1.14.m5.1.1.cmml" xref="S2.SS4.SSS1.p1.14.m5.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.14.m5.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.14.m5.1d">bold_y</annotation></semantics></math>; (<math alttext="\mathbf{A}^{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.15.m6.1"><semantics id="S2.SS4.SSS1.p1.15.m6.1a"><msup id="S2.SS4.SSS1.p1.15.m6.1.1" xref="S2.SS4.SSS1.p1.15.m6.1.1.cmml"><mi id="S2.SS4.SSS1.p1.15.m6.1.1.2" xref="S2.SS4.SSS1.p1.15.m6.1.1.2.cmml">𝐀</mi><mi id="S2.SS4.SSS1.p1.15.m6.1.1.3" xref="S2.SS4.SSS1.p1.15.m6.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.15.m6.1b"><apply id="S2.SS4.SSS1.p1.15.m6.1.1.cmml" xref="S2.SS4.SSS1.p1.15.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.15.m6.1.1.1.cmml" xref="S2.SS4.SSS1.p1.15.m6.1.1">superscript</csymbol><ci id="S2.SS4.SSS1.p1.15.m6.1.1.2.cmml" xref="S2.SS4.SSS1.p1.15.m6.1.1.2">𝐀</ci><ci id="S2.SS4.SSS1.p1.15.m6.1.1.3.cmml" xref="S2.SS4.SSS1.p1.15.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.15.m6.1c">\mathbf{A}^{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.15.m6.1d">bold_A start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{B}^{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.16.m7.1"><semantics id="S2.SS4.SSS1.p1.16.m7.1a"><msup id="S2.SS4.SSS1.p1.16.m7.1.1" xref="S2.SS4.SSS1.p1.16.m7.1.1.cmml"><mi id="S2.SS4.SSS1.p1.16.m7.1.1.2" xref="S2.SS4.SSS1.p1.16.m7.1.1.2.cmml">𝐁</mi><mi id="S2.SS4.SSS1.p1.16.m7.1.1.3" xref="S2.SS4.SSS1.p1.16.m7.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.16.m7.1b"><apply id="S2.SS4.SSS1.p1.16.m7.1.1.cmml" xref="S2.SS4.SSS1.p1.16.m7.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.16.m7.1.1.1.cmml" xref="S2.SS4.SSS1.p1.16.m7.1.1">superscript</csymbol><ci id="S2.SS4.SSS1.p1.16.m7.1.1.2.cmml" xref="S2.SS4.SSS1.p1.16.m7.1.1.2">𝐁</ci><ci id="S2.SS4.SSS1.p1.16.m7.1.1.3.cmml" xref="S2.SS4.SSS1.p1.16.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.16.m7.1c">\mathbf{B}^{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.16.m7.1d">bold_B start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{C}^{i}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.17.m8.1"><semantics id="S2.SS4.SSS1.p1.17.m8.1a"><msup id="S2.SS4.SSS1.p1.17.m8.1.1" xref="S2.SS4.SSS1.p1.17.m8.1.1.cmml"><mi id="S2.SS4.SSS1.p1.17.m8.1.1.2" xref="S2.SS4.SSS1.p1.17.m8.1.1.2.cmml">𝐂</mi><mi id="S2.SS4.SSS1.p1.17.m8.1.1.3" xref="S2.SS4.SSS1.p1.17.m8.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.17.m8.1b"><apply id="S2.SS4.SSS1.p1.17.m8.1.1.cmml" xref="S2.SS4.SSS1.p1.17.m8.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.17.m8.1.1.1.cmml" xref="S2.SS4.SSS1.p1.17.m8.1.1">superscript</csymbol><ci id="S2.SS4.SSS1.p1.17.m8.1.1.2.cmml" xref="S2.SS4.SSS1.p1.17.m8.1.1.2">𝐂</ci><ci id="S2.SS4.SSS1.p1.17.m8.1.1.3.cmml" xref="S2.SS4.SSS1.p1.17.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.17.m8.1c">\mathbf{C}^{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.17.m8.1d">bold_C start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>) denote the state matrices for the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.18.m9.1"><semantics id="S2.SS4.SSS1.p1.18.m9.1a"><mi id="S2.SS4.SSS1.p1.18.m9.1.1" xref="S2.SS4.SSS1.p1.18.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.18.m9.1b"><ci id="S2.SS4.SSS1.p1.18.m9.1.1.cmml" xref="S2.SS4.SSS1.p1.18.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.18.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.18.m9.1d">italic_i</annotation></semantics></math>-th token, derived through linear projection from the corresponding token embedding; and <math alttext="\mathbf{A}^{j:i}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.19.m10.1"><semantics id="S2.SS4.SSS1.p1.19.m10.1a"><msup id="S2.SS4.SSS1.p1.19.m10.1.1" xref="S2.SS4.SSS1.p1.19.m10.1.1.cmml"><mi id="S2.SS4.SSS1.p1.19.m10.1.1.2" xref="S2.SS4.SSS1.p1.19.m10.1.1.2.cmml">𝐀</mi><mrow id="S2.SS4.SSS1.p1.19.m10.1.1.3" xref="S2.SS4.SSS1.p1.19.m10.1.1.3.cmml"><mi id="S2.SS4.SSS1.p1.19.m10.1.1.3.2" xref="S2.SS4.SSS1.p1.19.m10.1.1.3.2.cmml">j</mi><mo id="S2.SS4.SSS1.p1.19.m10.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S2.SS4.SSS1.p1.19.m10.1.1.3.1.cmml">:</mo><mi id="S2.SS4.SSS1.p1.19.m10.1.1.3.3" xref="S2.SS4.SSS1.p1.19.m10.1.1.3.3.cmml">i</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.19.m10.1b"><apply id="S2.SS4.SSS1.p1.19.m10.1.1.cmml" xref="S2.SS4.SSS1.p1.19.m10.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p1.19.m10.1.1.1.cmml" xref="S2.SS4.SSS1.p1.19.m10.1.1">superscript</csymbol><ci id="S2.SS4.SSS1.p1.19.m10.1.1.2.cmml" xref="S2.SS4.SSS1.p1.19.m10.1.1.2">𝐀</ci><apply id="S2.SS4.SSS1.p1.19.m10.1.1.3.cmml" xref="S2.SS4.SSS1.p1.19.m10.1.1.3"><ci id="S2.SS4.SSS1.p1.19.m10.1.1.3.1.cmml" xref="S2.SS4.SSS1.p1.19.m10.1.1.3.1">:</ci><ci id="S2.SS4.SSS1.p1.19.m10.1.1.3.2.cmml" xref="S2.SS4.SSS1.p1.19.m10.1.1.3.2">𝑗</ci><ci id="S2.SS4.SSS1.p1.19.m10.1.1.3.3.cmml" xref="S2.SS4.SSS1.p1.19.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.19.m10.1c">\mathbf{A}^{j:i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.19.m10.1d">bold_A start_POSTSUPERSCRIPT italic_j : italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is the product of the state matrix <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.20.m11.1"><semantics id="S2.SS4.SSS1.p1.20.m11.1a"><mi id="S2.SS4.SSS1.p1.20.m11.1.1" xref="S2.SS4.SSS1.p1.20.m11.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.20.m11.1b"><ci id="S2.SS4.SSS1.p1.20.m11.1.1.cmml" xref="S2.SS4.SSS1.p1.20.m11.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.20.m11.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.20.m11.1d">bold_A</annotation></semantics></math> from <math alttext="j" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.21.m12.1"><semantics id="S2.SS4.SSS1.p1.21.m12.1a"><mi id="S2.SS4.SSS1.p1.21.m12.1.1" xref="S2.SS4.SSS1.p1.21.m12.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.21.m12.1b"><ci id="S2.SS4.SSS1.p1.21.m12.1.1.cmml" xref="S2.SS4.SSS1.p1.21.m12.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.21.m12.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.21.m12.1d">italic_j</annotation></semantics></math> to <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p1.22.m13.1"><semantics id="S2.SS4.SSS1.p1.22.m13.1a"><mi id="S2.SS4.SSS1.p1.22.m13.1.1" xref="S2.SS4.SSS1.p1.22.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p1.22.m13.1b"><ci id="S2.SS4.SSS1.p1.22.m13.1.1.cmml" xref="S2.SS4.SSS1.p1.22.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p1.22.m13.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p1.22.m13.1d">italic_i</annotation></semantics></math>.
Given such a formulation, the structured state-space model allows for block-based matrix multiplication, thus achieving attention-like content-aware modeling and subquadratic-time computation.</p>
</div>
<div class="ltx_para" id="S2.SS4.SSS1.p2">
<p class="ltx_p" id="S2.SS4.SSS1.p2.6">Building upon this insight, we further take advantage of the state space duality property for our variable- and long-length user interaction sequence.
Unlike the standard formulation mentioned above, we propose to perform the block-based matrix multiplications concurrently for each user sequence in the integrated input <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.1.m1.1"><semantics id="S2.SS4.SSS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS1.p2.1.m1.1.1" xref="S2.SS4.SSS1.p2.1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.1.m1.1b"><ci id="S2.SS4.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS4.SSS1.p2.1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.1.m1.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.1.m1.1d">caligraphic_X</annotation></semantics></math>.
Thanks to the use of segment registers, the model can retrieve corresponding structured matrix <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.2.m2.1"><semantics id="S2.SS4.SSS1.p2.2.m2.1a"><mi id="S2.SS4.SSS1.p2.2.m2.1.1" xref="S2.SS4.SSS1.p2.2.m2.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.2.m2.1b"><ci id="S2.SS4.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS4.SSS1.p2.2.m2.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.2.m2.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.2.m2.1d">bold_M</annotation></semantics></math> and item sequence <math alttext="\mathcal{E}\in\mathbb{R}^{1\times(\sum L)\times D}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.3.m3.1"><semantics id="S2.SS4.SSS1.p2.3.m3.1a"><mrow id="S2.SS4.SSS1.p2.3.m3.1.2" xref="S2.SS4.SSS1.p2.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS1.p2.3.m3.1.2.2" xref="S2.SS4.SSS1.p2.3.m3.1.2.2.cmml">ℰ</mi><mo id="S2.SS4.SSS1.p2.3.m3.1.2.1" xref="S2.SS4.SSS1.p2.3.m3.1.2.1.cmml">∈</mo><msup id="S2.SS4.SSS1.p2.3.m3.1.2.3" xref="S2.SS4.SSS1.p2.3.m3.1.2.3.cmml"><mi id="S2.SS4.SSS1.p2.3.m3.1.2.3.2" xref="S2.SS4.SSS1.p2.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS4.SSS1.p2.3.m3.1.1.1" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.cmml"><mn id="S2.SS4.SSS1.p2.3.m3.1.1.1.3" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.3.cmml">1</mn><mo id="S2.SS4.SSS1.p2.3.m3.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.2.cmml">×</mo><mrow id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.cmml"><mo id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.2" stretchy="false" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><mstyle id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1" scriptlevel="-1" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.cmml"><mrow id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1a" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.cmml"><mo id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.1" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.1.cmml">∑</mo><mi id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.2" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.2.cmml">L</mi></mrow></mstyle><mo id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS4.SSS1.p2.3.m3.1.1.1.2a" rspace="0.222em" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.2.cmml">×</mo><mi id="S2.SS4.SSS1.p2.3.m3.1.1.1.4" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.3.m3.1b"><apply id="S2.SS4.SSS1.p2.3.m3.1.2.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.2"><in id="S2.SS4.SSS1.p2.3.m3.1.2.1.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.2.1"></in><ci id="S2.SS4.SSS1.p2.3.m3.1.2.2.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.2.2">ℰ</ci><apply id="S2.SS4.SSS1.p2.3.m3.1.2.3.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.2.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p2.3.m3.1.2.3.1.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.2.3">superscript</csymbol><ci id="S2.SS4.SSS1.p2.3.m3.1.2.3.2.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.2.3.2">ℝ</ci><apply id="S2.SS4.SSS1.p2.3.m3.1.1.1.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.1.1"><times id="S2.SS4.SSS1.p2.3.m3.1.1.1.2.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.2"></times><cn id="S2.SS4.SSS1.p2.3.m3.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.3">1</cn><apply id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1"><sum id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.1"></sum><ci id="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.1.1.1.2">𝐿</ci></apply><ci id="S2.SS4.SSS1.p2.3.m3.1.1.1.4.cmml" xref="S2.SS4.SSS1.p2.3.m3.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.3.m3.1c">\mathcal{E}\in\mathbb{R}^{1\times(\sum L)\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.3.m3.1d">caligraphic_E ∈ blackboard_R start_POSTSUPERSCRIPT 1 × ( ∑ italic_L ) × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> for computation.
Formally, given an input <math alttext="\mathcal{X}=(\mathcal{E}_{b},\mathcal{R}_{b})" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.4.m4.2"><semantics id="S2.SS4.SSS1.p2.4.m4.2a"><mrow id="S2.SS4.SSS1.p2.4.m4.2.2" xref="S2.SS4.SSS1.p2.4.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS1.p2.4.m4.2.2.4" xref="S2.SS4.SSS1.p2.4.m4.2.2.4.cmml">𝒳</mi><mo id="S2.SS4.SSS1.p2.4.m4.2.2.3" xref="S2.SS4.SSS1.p2.4.m4.2.2.3.cmml">=</mo><mrow id="S2.SS4.SSS1.p2.4.m4.2.2.2.2" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.3.cmml"><mo id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.3" stretchy="false" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.3.cmml">(</mo><msub id="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1" xref="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.2" xref="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.3" xref="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.4" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.3.cmml">,</mo><msub id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.2" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.2.cmml">ℛ</mi><mi id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.3" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.3.cmml">b</mi></msub><mo id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.5" stretchy="false" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.4.m4.2b"><apply id="S2.SS4.SSS1.p2.4.m4.2.2.cmml" xref="S2.SS4.SSS1.p2.4.m4.2.2"><eq id="S2.SS4.SSS1.p2.4.m4.2.2.3.cmml" xref="S2.SS4.SSS1.p2.4.m4.2.2.3"></eq><ci id="S2.SS4.SSS1.p2.4.m4.2.2.4.cmml" xref="S2.SS4.SSS1.p2.4.m4.2.2.4">𝒳</ci><interval closure="open" id="S2.SS4.SSS1.p2.4.m4.2.2.2.3.cmml" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.2"><apply id="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.2">ℰ</ci><ci id="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS4.SSS1.p2.4.m4.1.1.1.1.1.3">𝑏</ci></apply><apply id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.cmml" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.1.cmml" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.2.cmml" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.2">ℛ</ci><ci id="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.3.cmml" xref="S2.SS4.SSS1.p2.4.m4.2.2.2.2.2.3">𝑏</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.4.m4.2c">\mathcal{X}=(\mathcal{E}_{b},\mathcal{R}_{b})</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.4.m4.2d">caligraphic_X = ( caligraphic_E start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT )</annotation></semantics></math> involving <math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.5.m5.1"><semantics id="S2.SS4.SSS1.p2.5.m5.1a"><mi id="S2.SS4.SSS1.p2.5.m5.1.1" xref="S2.SS4.SSS1.p2.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.5.m5.1b"><ci id="S2.SS4.SSS1.p2.5.m5.1.1.cmml" xref="S2.SS4.SSS1.p2.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.5.m5.1d">italic_K</annotation></semantics></math> users in the <math alttext="b" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.6.m6.1"><semantics id="S2.SS4.SSS1.p2.6.m6.1a"><mi id="S2.SS4.SSS1.p2.6.m6.1.1" xref="S2.SS4.SSS1.p2.6.m6.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.6.m6.1b"><ci id="S2.SS4.SSS1.p2.6.m6.1.1.cmml" xref="S2.SS4.SSS1.p2.6.m6.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.6.m6.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.6.m6.1d">italic_b</annotation></semantics></math>-th batch, the parallel SSD-based computation process can be formulated as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx6">
<tbody id="S2.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}=\textbf{SSM}(\mathbf{A},\mathbf{B},\mathbf{C})(%
\mathcal{X})" class="ltx_Math" display="inline" id="S2.E8.m1.4"><semantics id="S2.E8.m1.4a"><mrow id="S2.E8.m1.4.5" xref="S2.E8.m1.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m1.4.5.2" xref="S2.E8.m1.4.5.2.cmml">ℱ</mi><mo id="S2.E8.m1.4.5.1" xref="S2.E8.m1.4.5.1.cmml">=</mo><mrow id="S2.E8.m1.4.5.3" xref="S2.E8.m1.4.5.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.4.5.3.2" xref="S2.E8.m1.4.5.3.2a.cmml">SSM</mtext><mo id="S2.E8.m1.4.5.3.1" xref="S2.E8.m1.4.5.3.1.cmml">⁢</mo><mrow id="S2.E8.m1.4.5.3.3.2" xref="S2.E8.m1.4.5.3.3.1.cmml"><mo id="S2.E8.m1.4.5.3.3.2.1" stretchy="false" xref="S2.E8.m1.4.5.3.3.1.cmml">(</mo><mi id="S2.E8.m1.1.1" xref="S2.E8.m1.1.1.cmml">𝐀</mi><mo id="S2.E8.m1.4.5.3.3.2.2" xref="S2.E8.m1.4.5.3.3.1.cmml">,</mo><mi id="S2.E8.m1.2.2" xref="S2.E8.m1.2.2.cmml">𝐁</mi><mo id="S2.E8.m1.4.5.3.3.2.3" xref="S2.E8.m1.4.5.3.3.1.cmml">,</mo><mi id="S2.E8.m1.3.3" xref="S2.E8.m1.3.3.cmml">𝐂</mi><mo id="S2.E8.m1.4.5.3.3.2.4" stretchy="false" xref="S2.E8.m1.4.5.3.3.1.cmml">)</mo></mrow><mo id="S2.E8.m1.4.5.3.1a" xref="S2.E8.m1.4.5.3.1.cmml">⁢</mo><mrow id="S2.E8.m1.4.5.3.4.2" xref="S2.E8.m1.4.5.3.cmml"><mo id="S2.E8.m1.4.5.3.4.2.1" stretchy="false" xref="S2.E8.m1.4.5.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E8.m1.4.4" xref="S2.E8.m1.4.4.cmml">𝒳</mi><mo id="S2.E8.m1.4.5.3.4.2.2" stretchy="false" xref="S2.E8.m1.4.5.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.4b"><apply id="S2.E8.m1.4.5.cmml" xref="S2.E8.m1.4.5"><eq id="S2.E8.m1.4.5.1.cmml" xref="S2.E8.m1.4.5.1"></eq><ci id="S2.E8.m1.4.5.2.cmml" xref="S2.E8.m1.4.5.2">ℱ</ci><apply id="S2.E8.m1.4.5.3.cmml" xref="S2.E8.m1.4.5.3"><times id="S2.E8.m1.4.5.3.1.cmml" xref="S2.E8.m1.4.5.3.1"></times><ci id="S2.E8.m1.4.5.3.2a.cmml" xref="S2.E8.m1.4.5.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.4.5.3.2.cmml" xref="S2.E8.m1.4.5.3.2">SSM</mtext></ci><vector id="S2.E8.m1.4.5.3.3.1.cmml" xref="S2.E8.m1.4.5.3.3.2"><ci id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1">𝐀</ci><ci id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.2.2">𝐁</ci><ci id="S2.E8.m1.3.3.cmml" xref="S2.E8.m1.3.3">𝐂</ci></vector><ci id="S2.E8.m1.4.4.cmml" xref="S2.E8.m1.4.4">𝒳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.4c">\displaystyle\mathcal{F}=\textbf{SSM}(\mathbf{A},\mathbf{B},\mathbf{C})(%
\mathcal{X})</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.4d">caligraphic_F = SSM ( bold_A , bold_B , bold_C ) ( caligraphic_X )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\mathbf{M}_{1}\mathcal{E}_{u_{1}},...,\mathbf{M}_{K}\mathcal{E}%
_{u_{K}})," class="ltx_Math" display="inline" id="S2.E8.m2.2"><semantics id="S2.E8.m2.2a"><mrow id="S2.E8.m2.2.2.1" xref="S2.E8.m2.2.2.1.1.cmml"><mrow id="S2.E8.m2.2.2.1.1" xref="S2.E8.m2.2.2.1.1.cmml"><mi id="S2.E8.m2.2.2.1.1.4" xref="S2.E8.m2.2.2.1.1.4.cmml"></mi><mo id="S2.E8.m2.2.2.1.1.3" xref="S2.E8.m2.2.2.1.1.3.cmml">=</mo><mrow id="S2.E8.m2.2.2.1.1.2.2" xref="S2.E8.m2.2.2.1.1.2.3.cmml"><mo id="S2.E8.m2.2.2.1.1.2.2.3" stretchy="false" xref="S2.E8.m2.2.2.1.1.2.3.cmml">(</mo><mrow id="S2.E8.m2.2.2.1.1.1.1.1" xref="S2.E8.m2.2.2.1.1.1.1.1.cmml"><msub id="S2.E8.m2.2.2.1.1.1.1.1.2" xref="S2.E8.m2.2.2.1.1.1.1.1.2.cmml"><mi id="S2.E8.m2.2.2.1.1.1.1.1.2.2" xref="S2.E8.m2.2.2.1.1.1.1.1.2.2.cmml">𝐌</mi><mn id="S2.E8.m2.2.2.1.1.1.1.1.2.3" xref="S2.E8.m2.2.2.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.E8.m2.2.2.1.1.1.1.1.1" xref="S2.E8.m2.2.2.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E8.m2.2.2.1.1.1.1.1.3" xref="S2.E8.m2.2.2.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m2.2.2.1.1.1.1.1.3.2" xref="S2.E8.m2.2.2.1.1.1.1.1.3.2.cmml">ℰ</mi><msub id="S2.E8.m2.2.2.1.1.1.1.1.3.3" xref="S2.E8.m2.2.2.1.1.1.1.1.3.3.cmml"><mi id="S2.E8.m2.2.2.1.1.1.1.1.3.3.2" xref="S2.E8.m2.2.2.1.1.1.1.1.3.3.2.cmml">u</mi><mn id="S2.E8.m2.2.2.1.1.1.1.1.3.3.3" xref="S2.E8.m2.2.2.1.1.1.1.1.3.3.3.cmml">1</mn></msub></msub></mrow><mo id="S2.E8.m2.2.2.1.1.2.2.4" xref="S2.E8.m2.2.2.1.1.2.3.cmml">,</mo><mi id="S2.E8.m2.1.1" mathvariant="normal" xref="S2.E8.m2.1.1.cmml">…</mi><mo id="S2.E8.m2.2.2.1.1.2.2.5" xref="S2.E8.m2.2.2.1.1.2.3.cmml">,</mo><mrow id="S2.E8.m2.2.2.1.1.2.2.2" xref="S2.E8.m2.2.2.1.1.2.2.2.cmml"><msub id="S2.E8.m2.2.2.1.1.2.2.2.2" xref="S2.E8.m2.2.2.1.1.2.2.2.2.cmml"><mi id="S2.E8.m2.2.2.1.1.2.2.2.2.2" xref="S2.E8.m2.2.2.1.1.2.2.2.2.2.cmml">𝐌</mi><mi id="S2.E8.m2.2.2.1.1.2.2.2.2.3" xref="S2.E8.m2.2.2.1.1.2.2.2.2.3.cmml">K</mi></msub><mo id="S2.E8.m2.2.2.1.1.2.2.2.1" xref="S2.E8.m2.2.2.1.1.2.2.2.1.cmml">⁢</mo><msub id="S2.E8.m2.2.2.1.1.2.2.2.3" xref="S2.E8.m2.2.2.1.1.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m2.2.2.1.1.2.2.2.3.2" xref="S2.E8.m2.2.2.1.1.2.2.2.3.2.cmml">ℰ</mi><msub id="S2.E8.m2.2.2.1.1.2.2.2.3.3" xref="S2.E8.m2.2.2.1.1.2.2.2.3.3.cmml"><mi id="S2.E8.m2.2.2.1.1.2.2.2.3.3.2" xref="S2.E8.m2.2.2.1.1.2.2.2.3.3.2.cmml">u</mi><mi id="S2.E8.m2.2.2.1.1.2.2.2.3.3.3" xref="S2.E8.m2.2.2.1.1.2.2.2.3.3.3.cmml">K</mi></msub></msub></mrow><mo id="S2.E8.m2.2.2.1.1.2.2.6" stretchy="false" xref="S2.E8.m2.2.2.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E8.m2.2.2.1.2" xref="S2.E8.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m2.2b"><apply id="S2.E8.m2.2.2.1.1.cmml" xref="S2.E8.m2.2.2.1"><eq id="S2.E8.m2.2.2.1.1.3.cmml" xref="S2.E8.m2.2.2.1.1.3"></eq><csymbol cd="latexml" id="S2.E8.m2.2.2.1.1.4.cmml" xref="S2.E8.m2.2.2.1.1.4">absent</csymbol><vector id="S2.E8.m2.2.2.1.1.2.3.cmml" xref="S2.E8.m2.2.2.1.1.2.2"><apply id="S2.E8.m2.2.2.1.1.1.1.1.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1"><times id="S2.E8.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.1"></times><apply id="S2.E8.m2.2.2.1.1.1.1.1.2.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m2.2.2.1.1.1.1.1.2.1.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E8.m2.2.2.1.1.1.1.1.2.2.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.2.2">𝐌</ci><cn id="S2.E8.m2.2.2.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.E8.m2.2.2.1.1.1.1.1.2.3">1</cn></apply><apply id="S2.E8.m2.2.2.1.1.1.1.1.3.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m2.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m2.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.3.2">ℰ</ci><apply id="S2.E8.m2.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E8.m2.2.2.1.1.1.1.1.3.3.1.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E8.m2.2.2.1.1.1.1.1.3.3.2.cmml" xref="S2.E8.m2.2.2.1.1.1.1.1.3.3.2">𝑢</ci><cn id="S2.E8.m2.2.2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.E8.m2.2.2.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S2.E8.m2.1.1.cmml" xref="S2.E8.m2.1.1">…</ci><apply id="S2.E8.m2.2.2.1.1.2.2.2.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2"><times id="S2.E8.m2.2.2.1.1.2.2.2.1.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.1"></times><apply id="S2.E8.m2.2.2.1.1.2.2.2.2.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m2.2.2.1.1.2.2.2.2.1.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E8.m2.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.2.2">𝐌</ci><ci id="S2.E8.m2.2.2.1.1.2.2.2.2.3.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.2.3">𝐾</ci></apply><apply id="S2.E8.m2.2.2.1.1.2.2.2.3.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E8.m2.2.2.1.1.2.2.2.3.1.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.3">subscript</csymbol><ci id="S2.E8.m2.2.2.1.1.2.2.2.3.2.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.3.2">ℰ</ci><apply id="S2.E8.m2.2.2.1.1.2.2.2.3.3.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E8.m2.2.2.1.1.2.2.2.3.3.1.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.3.3">subscript</csymbol><ci id="S2.E8.m2.2.2.1.1.2.2.2.3.3.2.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.3.3.2">𝑢</ci><ci id="S2.E8.m2.2.2.1.1.2.2.2.3.3.3.cmml" xref="S2.E8.m2.2.2.1.1.2.2.2.3.3.3">𝐾</ci></apply></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m2.2c">\displaystyle=(\mathbf{M}_{1}\mathcal{E}_{u_{1}},...,\mathbf{M}_{K}\mathcal{E}%
_{u_{K}}),</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m2.2d">= ( bold_M start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT caligraphic_E start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , bold_M start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT caligraphic_E start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{s.t.}~{}~{}\mathbf{M}_{k}^{ji}" class="ltx_Math" display="inline" id="S2.E9.m1.1"><semantics id="S2.E9.m1.1a"><mrow id="S2.E9.m1.1.1" xref="S2.E9.m1.1.1.cmml"><mtext id="S2.E9.m1.1.1.2" xref="S2.E9.m1.1.1.2a.cmml">s.t.</mtext><mo id="S2.E9.m1.1.1.1" lspace="0.660em" xref="S2.E9.m1.1.1.1.cmml">⁢</mo><msubsup id="S2.E9.m1.1.1.3" xref="S2.E9.m1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.3.2.2" xref="S2.E9.m1.1.1.3.2.2.cmml">𝐌</mi><mi id="S2.E9.m1.1.1.3.2.3" xref="S2.E9.m1.1.1.3.2.3.cmml">k</mi><mrow id="S2.E9.m1.1.1.3.3" xref="S2.E9.m1.1.1.3.3.cmml"><mi id="S2.E9.m1.1.1.3.3.2" xref="S2.E9.m1.1.1.3.3.2.cmml">j</mi><mo id="S2.E9.m1.1.1.3.3.1" xref="S2.E9.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E9.m1.1.1.3.3.3" xref="S2.E9.m1.1.1.3.3.3.cmml">i</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.1.cmml" xref="S2.E9.m1.1.1"><times id="S2.E9.m1.1.1.1.cmml" xref="S2.E9.m1.1.1.1"></times><ci id="S2.E9.m1.1.1.2a.cmml" xref="S2.E9.m1.1.1.2"><mtext id="S2.E9.m1.1.1.2.cmml" xref="S2.E9.m1.1.1.2">s.t.</mtext></ci><apply id="S2.E9.m1.1.1.3.cmml" xref="S2.E9.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.3">superscript</csymbol><apply id="S2.E9.m1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.3.2.1.cmml" xref="S2.E9.m1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.1.1.3.2.2.cmml" xref="S2.E9.m1.1.1.3.2.2">𝐌</ci><ci id="S2.E9.m1.1.1.3.2.3.cmml" xref="S2.E9.m1.1.1.3.2.3">𝑘</ci></apply><apply id="S2.E9.m1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.3.3"><times id="S2.E9.m1.1.1.3.3.1.cmml" xref="S2.E9.m1.1.1.3.3.1"></times><ci id="S2.E9.m1.1.1.3.3.2.cmml" xref="S2.E9.m1.1.1.3.3.2">𝑗</ci><ci id="S2.E9.m1.1.1.3.3.3.cmml" xref="S2.E9.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">\displaystyle\text{s.t.}~{}~{}\mathbf{M}_{k}^{ji}</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.1d">s.t. bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j italic_i end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\mathbf{C}_{k}^{j})^{\top}\mathbf{A}_{k}^{j}...\mathbf{A}_{k}^{%
i+1}\mathbf{B}_{k}^{i}," class="ltx_Math" display="inline" id="S2.E9.m2.1"><semantics id="S2.E9.m2.1a"><mrow id="S2.E9.m2.1.1.1" xref="S2.E9.m2.1.1.1.1.cmml"><mrow id="S2.E9.m2.1.1.1.1" xref="S2.E9.m2.1.1.1.1.cmml"><mi id="S2.E9.m2.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E9.m2.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E9.m2.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.cmml"><msup id="S2.E9.m2.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.cmml"><mrow id="S2.E9.m2.1.1.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E9.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E9.m2.1.1.1.1.1.1.1.1.1" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐂</mi><mi id="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S2.E9.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S2.E9.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E9.m2.1.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S2.E9.m2.1.1.1.1.1.2" xref="S2.E9.m2.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="S2.E9.m2.1.1.1.1.1.3" xref="S2.E9.m2.1.1.1.1.1.3.cmml"><mi id="S2.E9.m2.1.1.1.1.1.3.2.2" xref="S2.E9.m2.1.1.1.1.1.3.2.2.cmml">𝐀</mi><mi id="S2.E9.m2.1.1.1.1.1.3.2.3" xref="S2.E9.m2.1.1.1.1.1.3.2.3.cmml">k</mi><mi id="S2.E9.m2.1.1.1.1.1.3.3" xref="S2.E9.m2.1.1.1.1.1.3.3.cmml">j</mi></msubsup><mo id="S2.E9.m2.1.1.1.1.1.2a" xref="S2.E9.m2.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E9.m2.1.1.1.1.1.4" mathvariant="normal" xref="S2.E9.m2.1.1.1.1.1.4.cmml">…</mi><mo id="S2.E9.m2.1.1.1.1.1.2b" xref="S2.E9.m2.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="S2.E9.m2.1.1.1.1.1.5" xref="S2.E9.m2.1.1.1.1.1.5.cmml"><mi id="S2.E9.m2.1.1.1.1.1.5.2.2" xref="S2.E9.m2.1.1.1.1.1.5.2.2.cmml">𝐀</mi><mi id="S2.E9.m2.1.1.1.1.1.5.2.3" xref="S2.E9.m2.1.1.1.1.1.5.2.3.cmml">k</mi><mrow id="S2.E9.m2.1.1.1.1.1.5.3" xref="S2.E9.m2.1.1.1.1.1.5.3.cmml"><mi id="S2.E9.m2.1.1.1.1.1.5.3.2" xref="S2.E9.m2.1.1.1.1.1.5.3.2.cmml">i</mi><mo id="S2.E9.m2.1.1.1.1.1.5.3.1" xref="S2.E9.m2.1.1.1.1.1.5.3.1.cmml">+</mo><mn id="S2.E9.m2.1.1.1.1.1.5.3.3" xref="S2.E9.m2.1.1.1.1.1.5.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.E9.m2.1.1.1.1.1.2c" xref="S2.E9.m2.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="S2.E9.m2.1.1.1.1.1.6" xref="S2.E9.m2.1.1.1.1.1.6.cmml"><mi id="S2.E9.m2.1.1.1.1.1.6.2.2" xref="S2.E9.m2.1.1.1.1.1.6.2.2.cmml">𝐁</mi><mi id="S2.E9.m2.1.1.1.1.1.6.2.3" xref="S2.E9.m2.1.1.1.1.1.6.2.3.cmml">k</mi><mi id="S2.E9.m2.1.1.1.1.1.6.3" xref="S2.E9.m2.1.1.1.1.1.6.3.cmml">i</mi></msubsup></mrow></mrow><mo id="S2.E9.m2.1.1.1.2" xref="S2.E9.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m2.1b"><apply id="S2.E9.m2.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1"><eq id="S2.E9.m2.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E9.m2.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E9.m2.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1"><times id="S2.E9.m2.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1.2"></times><apply id="S2.E9.m2.1.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E9.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.2">𝐂</ci><ci id="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.E9.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><csymbol cd="latexml" id="S2.E9.m2.1.1.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S2.E9.m2.1.1.1.1.1.3.cmml" xref="S2.E9.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.3.1.cmml" xref="S2.E9.m2.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E9.m2.1.1.1.1.1.3.2.cmml" xref="S2.E9.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.3.2.1.cmml" xref="S2.E9.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m2.1.1.1.1.1.3.2.2.cmml" xref="S2.E9.m2.1.1.1.1.1.3.2.2">𝐀</ci><ci id="S2.E9.m2.1.1.1.1.1.3.2.3.cmml" xref="S2.E9.m2.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S2.E9.m2.1.1.1.1.1.3.3.cmml" xref="S2.E9.m2.1.1.1.1.1.3.3">𝑗</ci></apply><ci id="S2.E9.m2.1.1.1.1.1.4.cmml" xref="S2.E9.m2.1.1.1.1.1.4">…</ci><apply id="S2.E9.m2.1.1.1.1.1.5.cmml" xref="S2.E9.m2.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.5.1.cmml" xref="S2.E9.m2.1.1.1.1.1.5">superscript</csymbol><apply id="S2.E9.m2.1.1.1.1.1.5.2.cmml" xref="S2.E9.m2.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.5.2.1.cmml" xref="S2.E9.m2.1.1.1.1.1.5">subscript</csymbol><ci id="S2.E9.m2.1.1.1.1.1.5.2.2.cmml" xref="S2.E9.m2.1.1.1.1.1.5.2.2">𝐀</ci><ci id="S2.E9.m2.1.1.1.1.1.5.2.3.cmml" xref="S2.E9.m2.1.1.1.1.1.5.2.3">𝑘</ci></apply><apply id="S2.E9.m2.1.1.1.1.1.5.3.cmml" xref="S2.E9.m2.1.1.1.1.1.5.3"><plus id="S2.E9.m2.1.1.1.1.1.5.3.1.cmml" xref="S2.E9.m2.1.1.1.1.1.5.3.1"></plus><ci id="S2.E9.m2.1.1.1.1.1.5.3.2.cmml" xref="S2.E9.m2.1.1.1.1.1.5.3.2">𝑖</ci><cn id="S2.E9.m2.1.1.1.1.1.5.3.3.cmml" type="integer" xref="S2.E9.m2.1.1.1.1.1.5.3.3">1</cn></apply></apply><apply id="S2.E9.m2.1.1.1.1.1.6.cmml" xref="S2.E9.m2.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.6.1.cmml" xref="S2.E9.m2.1.1.1.1.1.6">superscript</csymbol><apply id="S2.E9.m2.1.1.1.1.1.6.2.cmml" xref="S2.E9.m2.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E9.m2.1.1.1.1.1.6.2.1.cmml" xref="S2.E9.m2.1.1.1.1.1.6">subscript</csymbol><ci id="S2.E9.m2.1.1.1.1.1.6.2.2.cmml" xref="S2.E9.m2.1.1.1.1.1.6.2.2">𝐁</ci><ci id="S2.E9.m2.1.1.1.1.1.6.2.3.cmml" xref="S2.E9.m2.1.1.1.1.1.6.2.3">𝑘</ci></apply><ci id="S2.E9.m2.1.1.1.1.1.6.3.cmml" xref="S2.E9.m2.1.1.1.1.1.6.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m2.1c">\displaystyle=(\mathbf{C}_{k}^{j})^{\top}\mathbf{A}_{k}^{j}...\mathbf{A}_{k}^{%
i+1}\mathbf{B}_{k}^{i},</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m2.1d">= ( bold_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_A start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT … bold_A start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i + 1 end_POSTSUPERSCRIPT bold_B start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS1.p2.10">where <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.7.m1.1"><semantics id="S2.SS4.SSS1.p2.7.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS1.p2.7.m1.1.1" xref="S2.SS4.SSS1.p2.7.m1.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.7.m1.1b"><ci id="S2.SS4.SSS1.p2.7.m1.1.1.cmml" xref="S2.SS4.SSS1.p2.7.m1.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.7.m1.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.7.m1.1d">caligraphic_F</annotation></semantics></math> is the intermediate output of an SSD layer, which will be passed as the input sequence to the next SSD layer. <math alttext="\mathbf{M}_{k}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.8.m2.1"><semantics id="S2.SS4.SSS1.p2.8.m2.1a"><msub id="S2.SS4.SSS1.p2.8.m2.1.1" xref="S2.SS4.SSS1.p2.8.m2.1.1.cmml"><mi id="S2.SS4.SSS1.p2.8.m2.1.1.2" xref="S2.SS4.SSS1.p2.8.m2.1.1.2.cmml">𝐌</mi><mi id="S2.SS4.SSS1.p2.8.m2.1.1.3" xref="S2.SS4.SSS1.p2.8.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.8.m2.1b"><apply id="S2.SS4.SSS1.p2.8.m2.1.1.cmml" xref="S2.SS4.SSS1.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p2.8.m2.1.1.1.cmml" xref="S2.SS4.SSS1.p2.8.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS1.p2.8.m2.1.1.2.cmml" xref="S2.SS4.SSS1.p2.8.m2.1.1.2">𝐌</ci><ci id="S2.SS4.SSS1.p2.8.m2.1.1.3.cmml" xref="S2.SS4.SSS1.p2.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.8.m2.1c">\mathbf{M}_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.8.m2.1d">bold_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{E}_{u_{k}}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.9.m3.1"><semantics id="S2.SS4.SSS1.p2.9.m3.1a"><msub id="S2.SS4.SSS1.p2.9.m3.1.1" xref="S2.SS4.SSS1.p2.9.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS1.p2.9.m3.1.1.2" xref="S2.SS4.SSS1.p2.9.m3.1.1.2.cmml">ℰ</mi><msub id="S2.SS4.SSS1.p2.9.m3.1.1.3" xref="S2.SS4.SSS1.p2.9.m3.1.1.3.cmml"><mi id="S2.SS4.SSS1.p2.9.m3.1.1.3.2" xref="S2.SS4.SSS1.p2.9.m3.1.1.3.2.cmml">u</mi><mi id="S2.SS4.SSS1.p2.9.m3.1.1.3.3" xref="S2.SS4.SSS1.p2.9.m3.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.9.m3.1b"><apply id="S2.SS4.SSS1.p2.9.m3.1.1.cmml" xref="S2.SS4.SSS1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p2.9.m3.1.1.1.cmml" xref="S2.SS4.SSS1.p2.9.m3.1.1">subscript</csymbol><ci id="S2.SS4.SSS1.p2.9.m3.1.1.2.cmml" xref="S2.SS4.SSS1.p2.9.m3.1.1.2">ℰ</ci><apply id="S2.SS4.SSS1.p2.9.m3.1.1.3.cmml" xref="S2.SS4.SSS1.p2.9.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p2.9.m3.1.1.3.1.cmml" xref="S2.SS4.SSS1.p2.9.m3.1.1.3">subscript</csymbol><ci id="S2.SS4.SSS1.p2.9.m3.1.1.3.2.cmml" xref="S2.SS4.SSS1.p2.9.m3.1.1.3.2">𝑢</ci><ci id="S2.SS4.SSS1.p2.9.m3.1.1.3.3.cmml" xref="S2.SS4.SSS1.p2.9.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.9.m3.1c">\mathcal{E}_{u_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.9.m3.1d">caligraphic_E start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> represent the structured matrix and item sequence for user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS4.SSS1.p2.10.m4.1"><semantics id="S2.SS4.SSS1.p2.10.m4.1a"><msub id="S2.SS4.SSS1.p2.10.m4.1.1" xref="S2.SS4.SSS1.p2.10.m4.1.1.cmml"><mi id="S2.SS4.SSS1.p2.10.m4.1.1.2" xref="S2.SS4.SSS1.p2.10.m4.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS1.p2.10.m4.1.1.3" xref="S2.SS4.SSS1.p2.10.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS1.p2.10.m4.1b"><apply id="S2.SS4.SSS1.p2.10.m4.1.1.cmml" xref="S2.SS4.SSS1.p2.10.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS1.p2.10.m4.1.1.1.cmml" xref="S2.SS4.SSS1.p2.10.m4.1.1">subscript</csymbol><ci id="S2.SS4.SSS1.p2.10.m4.1.1.2.cmml" xref="S2.SS4.SSS1.p2.10.m4.1.1.2">𝑢</ci><ci id="S2.SS4.SSS1.p2.10.m4.1.1.3.cmml" xref="S2.SS4.SSS1.p2.10.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS1.p2.10.m4.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS1.p2.10.m4.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
By adopting this approach, SSD4Rec implements batch processing of user interaction sequences with varying lengths.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.4.2. </span><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS2.1.1">Block Design</span>
</h4>
<div class="ltx_para" id="S2.SS4.SSS2.p1">
<p class="ltx_p" id="S2.SS4.SSS2.p1.1">By leveraging the state space duality (SSD) layer as the foundational component, we construct a network architecture tailored to address the sequential recommendation task, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.F1" title="Figure 1 ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.
First, in addition to the standard sequential information concerning user behaviors, we propose integrating reverse insights from the interaction history by constructing a bidirectional architecture on top of the unidirectional SSD layer.
In which, we introduce a weighted indicator <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.1.m1.1"><semantics id="S2.SS4.SSS2.p1.1.m1.1a"><mi id="S2.SS4.SSS2.p1.1.m1.1.1" xref="S2.SS4.SSS2.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.1.m1.1b"><ci id="S2.SS4.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS4.SSS2.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.1.m1.1d">italic_β</annotation></semantics></math>, to regulate the message integration between the forward and backward sequence modeling, expressed as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx7">
<tbody id="S2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}^{\prime}=\mathcal{F}_{\rm forward}+\beta*\mathcal{F}_%
{\rm backward}," class="ltx_Math" display="inline" id="S2.E10.m1.1"><semantics id="S2.E10.m1.1a"><mrow id="S2.E10.m1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml"><msup id="S2.E10.m1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.1.1.1.1.2.2" xref="S2.E10.m1.1.1.1.1.2.2.cmml">ℱ</mi><mo id="S2.E10.m1.1.1.1.1.2.3" xref="S2.E10.m1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S2.E10.m1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E10.m1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.3.cmml"><msub id="S2.E10.m1.1.1.1.1.3.2" xref="S2.E10.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.1.1.1.1.3.2.2" xref="S2.E10.m1.1.1.1.1.3.2.2.cmml">ℱ</mi><mi id="S2.E10.m1.1.1.1.1.3.2.3" xref="S2.E10.m1.1.1.1.1.3.2.3.cmml">forward</mi></msub><mo id="S2.E10.m1.1.1.1.1.3.1" xref="S2.E10.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E10.m1.1.1.1.1.3.3" xref="S2.E10.m1.1.1.1.1.3.3.cmml"><mi id="S2.E10.m1.1.1.1.1.3.3.2" xref="S2.E10.m1.1.1.1.1.3.3.2.cmml">β</mi><mo id="S2.E10.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E10.m1.1.1.1.1.3.3.1.cmml">∗</mo><msub id="S2.E10.m1.1.1.1.1.3.3.3" xref="S2.E10.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.1.1.1.1.3.3.3.2" xref="S2.E10.m1.1.1.1.1.3.3.3.2.cmml">ℱ</mi><mi id="S2.E10.m1.1.1.1.1.3.3.3.3" xref="S2.E10.m1.1.1.1.1.3.3.3.3.cmml">backward</mi></msub></mrow></mrow></mrow><mo id="S2.E10.m1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.1b"><apply id="S2.E10.m1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1"><eq id="S2.E10.m1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1"></eq><apply id="S2.E10.m1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.1.1.1.1.2">superscript</csymbol><ci id="S2.E10.m1.1.1.1.1.2.2.cmml" xref="S2.E10.m1.1.1.1.1.2.2">ℱ</ci><ci id="S2.E10.m1.1.1.1.1.2.3.cmml" xref="S2.E10.m1.1.1.1.1.2.3">′</ci></apply><apply id="S2.E10.m1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.3"><plus id="S2.E10.m1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.1.1.1.1.3.1"></plus><apply id="S2.E10.m1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.3.2.1.cmml" xref="S2.E10.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E10.m1.1.1.1.1.3.2.2.cmml" xref="S2.E10.m1.1.1.1.1.3.2.2">ℱ</ci><ci id="S2.E10.m1.1.1.1.1.3.2.3.cmml" xref="S2.E10.m1.1.1.1.1.3.2.3">forward</ci></apply><apply id="S2.E10.m1.1.1.1.1.3.3.cmml" xref="S2.E10.m1.1.1.1.1.3.3"><times id="S2.E10.m1.1.1.1.1.3.3.1.cmml" xref="S2.E10.m1.1.1.1.1.3.3.1"></times><ci id="S2.E10.m1.1.1.1.1.3.3.2.cmml" xref="S2.E10.m1.1.1.1.1.3.3.2">𝛽</ci><apply id="S2.E10.m1.1.1.1.1.3.3.3.cmml" xref="S2.E10.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E10.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E10.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E10.m1.1.1.1.1.3.3.3.2">ℱ</ci><ci id="S2.E10.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E10.m1.1.1.1.1.3.3.3.3">backward</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.1c">\displaystyle\mathcal{F}^{\prime}=\mathcal{F}_{\rm forward}+\beta*\mathcal{F}_%
{\rm backward},</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.1d">caligraphic_F start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = caligraphic_F start_POSTSUBSCRIPT roman_forward end_POSTSUBSCRIPT + italic_β ∗ caligraphic_F start_POSTSUBSCRIPT roman_backward end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS2.p1.7">where <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.2.m1.1"><semantics id="S2.SS4.SSS2.p1.2.m1.1a"><mi id="S2.SS4.SSS2.p1.2.m1.1.1" xref="S2.SS4.SSS2.p1.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.2.m1.1b"><ci id="S2.SS4.SSS2.p1.2.m1.1.1.cmml" xref="S2.SS4.SSS2.p1.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.2.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.2.m1.1d">italic_β</annotation></semantics></math> is a hyper-parameter to balance the contribution of backward sequence modeling.
Empirically, <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.3.m2.1"><semantics id="S2.SS4.SSS2.p1.3.m2.1a"><mi id="S2.SS4.SSS2.p1.3.m2.1.1" xref="S2.SS4.SSS2.p1.3.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.3.m2.1b"><ci id="S2.SS4.SSS2.p1.3.m2.1.1.cmml" xref="S2.SS4.SSS2.p1.3.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.3.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.3.m2.1d">italic_β</annotation></semantics></math> should be set within the range of 0.1 to 0.3.
This bidirectional design encourages the model to learn to reason in a reverse manner, potentially capturing more valuable patterns within the interaction histories.
Notably, to conserve computational resources and GPU memory usage, we can utilize a shared SSD layer for the forward and backward modeling processes.
Second, the utilization of SSD layers enables our model to facilitate hardware-aware computation, i.e., block-based matrix multiplication <cite class="ltx_cite ltx_citemacro_citep">(Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite>, thereby achieving attention-like content-aware modeling while preserving efficient learning.
Moreover, by stacking multiple bidirectional SSD cells, the proposed model can achieve a deeper network structure with an increased number of learnable parameters.
Layer-wise normalization and embedding dropout are further utilized between the stacked cells to improve the model’s robustness and stabilize the learning process.
Finally, the proposed block predicts the representations of user preferences in a specific batch, which are used to calculate the ranking score distributions for Top-K sequential recommendations.
Specifically, given the integrated input <math alttext="\mathcal{X}=\{\mathcal{E}_{b},\mathcal{R}_{b}\}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.4.m3.2"><semantics id="S2.SS4.SSS2.p1.4.m3.2a"><mrow id="S2.SS4.SSS2.p1.4.m3.2.2" xref="S2.SS4.SSS2.p1.4.m3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.4.m3.2.2.4" xref="S2.SS4.SSS2.p1.4.m3.2.2.4.cmml">𝒳</mi><mo id="S2.SS4.SSS2.p1.4.m3.2.2.3" xref="S2.SS4.SSS2.p1.4.m3.2.2.3.cmml">=</mo><mrow id="S2.SS4.SSS2.p1.4.m3.2.2.2.2" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.3.cmml"><mo id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.3" stretchy="false" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.3.cmml">{</mo><msub id="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1" xref="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.2" xref="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.3" xref="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.4" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.3.cmml">,</mo><msub id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.2" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.2.cmml">ℛ</mi><mi id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.3" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.3.cmml">b</mi></msub><mo id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.5" stretchy="false" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.4.m3.2b"><apply id="S2.SS4.SSS2.p1.4.m3.2.2.cmml" xref="S2.SS4.SSS2.p1.4.m3.2.2"><eq id="S2.SS4.SSS2.p1.4.m3.2.2.3.cmml" xref="S2.SS4.SSS2.p1.4.m3.2.2.3"></eq><ci id="S2.SS4.SSS2.p1.4.m3.2.2.4.cmml" xref="S2.SS4.SSS2.p1.4.m3.2.2.4">𝒳</ci><set id="S2.SS4.SSS2.p1.4.m3.2.2.2.3.cmml" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.2"><apply id="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.2.cmml" xref="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.2">ℰ</ci><ci id="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.3.cmml" xref="S2.SS4.SSS2.p1.4.m3.1.1.1.1.1.3">𝑏</ci></apply><apply id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.cmml" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.1.cmml" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2">subscript</csymbol><ci id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.2.cmml" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.2">ℛ</ci><ci id="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.3.cmml" xref="S2.SS4.SSS2.p1.4.m3.2.2.2.2.2.3">𝑏</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.4.m3.2c">\mathcal{X}=\{\mathcal{E}_{b},\mathcal{R}_{b}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.4.m3.2d">caligraphic_X = { caligraphic_E start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT }</annotation></semantics></math> associated with <math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.5.m4.1"><semantics id="S2.SS4.SSS2.p1.5.m4.1a"><mi id="S2.SS4.SSS2.p1.5.m4.1.1" xref="S2.SS4.SSS2.p1.5.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.5.m4.1b"><ci id="S2.SS4.SSS2.p1.5.m4.1.1.cmml" xref="S2.SS4.SSS2.p1.5.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.5.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.5.m4.1d">italic_K</annotation></semantics></math> users in the <math alttext="b" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.6.m5.1"><semantics id="S2.SS4.SSS2.p1.6.m5.1a"><mi id="S2.SS4.SSS2.p1.6.m5.1.1" xref="S2.SS4.SSS2.p1.6.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.6.m5.1b"><ci id="S2.SS4.SSS2.p1.6.m5.1.1.cmml" xref="S2.SS4.SSS2.p1.6.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.6.m5.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.6.m5.1d">italic_b</annotation></semantics></math>-th batch, the proposed Bi-SSD layer outputs the representations of their user preferences <math alttext="\mathcal{P}_{b}=\{\hat{\mathbf{p}}_{1},...,\hat{\mathbf{p}}_{k},...,\hat{%
\mathbf{p}}_{K}\}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.7.m6.5"><semantics id="S2.SS4.SSS2.p1.7.m6.5a"><mrow id="S2.SS4.SSS2.p1.7.m6.5.5" xref="S2.SS4.SSS2.p1.7.m6.5.5.cmml"><msub id="S2.SS4.SSS2.p1.7.m6.5.5.5" xref="S2.SS4.SSS2.p1.7.m6.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS2.p1.7.m6.5.5.5.2" xref="S2.SS4.SSS2.p1.7.m6.5.5.5.2.cmml">𝒫</mi><mi id="S2.SS4.SSS2.p1.7.m6.5.5.5.3" xref="S2.SS4.SSS2.p1.7.m6.5.5.5.3.cmml">b</mi></msub><mo id="S2.SS4.SSS2.p1.7.m6.5.5.4" xref="S2.SS4.SSS2.p1.7.m6.5.5.4.cmml">=</mo><mrow id="S2.SS4.SSS2.p1.7.m6.5.5.3.3" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.4.cmml"><mo id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.4" stretchy="false" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.4.cmml">{</mo><msub id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.cmml"><mover accent="true" id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.cmml"><mi id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.2" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.2.cmml">𝐩</mi><mo id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.1" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.1.cmml">^</mo></mover><mn id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.3" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.5" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.4.cmml">,</mo><mi id="S2.SS4.SSS2.p1.7.m6.1.1" mathvariant="normal" xref="S2.SS4.SSS2.p1.7.m6.1.1.cmml">…</mi><mo id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.6" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.4.cmml">,</mo><msub id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.cmml"><mover accent="true" id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.cmml"><mi id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.2" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.2.cmml">𝐩</mi><mo id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.1" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.3" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.3.cmml">k</mi></msub><mo id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.7" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.4.cmml">,</mo><mi id="S2.SS4.SSS2.p1.7.m6.2.2" mathvariant="normal" xref="S2.SS4.SSS2.p1.7.m6.2.2.cmml">…</mi><mo id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.8" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.4.cmml">,</mo><msub id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.cmml"><mover accent="true" id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.cmml"><mi id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.2" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.2.cmml">𝐩</mi><mo id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.1" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.1.cmml">^</mo></mover><mi id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.3" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.3.cmml">K</mi></msub><mo id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.9" stretchy="false" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.7.m6.5b"><apply id="S2.SS4.SSS2.p1.7.m6.5.5.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5"><eq id="S2.SS4.SSS2.p1.7.m6.5.5.4.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.4"></eq><apply id="S2.SS4.SSS2.p1.7.m6.5.5.5.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.5"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.7.m6.5.5.5.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.5">subscript</csymbol><ci id="S2.SS4.SSS2.p1.7.m6.5.5.5.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.5.2">𝒫</ci><ci id="S2.SS4.SSS2.p1.7.m6.5.5.5.3.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.5.3">𝑏</ci></apply><set id="S2.SS4.SSS2.p1.7.m6.5.5.3.4.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3"><apply id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1">subscript</csymbol><apply id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2"><ci id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.1">^</ci><ci id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.2.2">𝐩</ci></apply><cn id="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS2.p1.7.m6.3.3.1.1.1.3">1</cn></apply><ci id="S2.SS4.SSS2.p1.7.m6.1.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.1.1">…</ci><apply id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2">subscript</csymbol><apply id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2"><ci id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.1">^</ci><ci id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.2.2">𝐩</ci></apply><ci id="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.3.cmml" xref="S2.SS4.SSS2.p1.7.m6.4.4.2.2.2.3">𝑘</ci></apply><ci id="S2.SS4.SSS2.p1.7.m6.2.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.2.2">…</ci><apply id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3">subscript</csymbol><apply id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2"><ci id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.1.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.1">^</ci><ci id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.2.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.2.2">𝐩</ci></apply><ci id="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.3.cmml" xref="S2.SS4.SSS2.p1.7.m6.5.5.3.3.3.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.7.m6.5c">\mathcal{P}_{b}=\{\hat{\mathbf{p}}_{1},...,\hat{\mathbf{p}}_{k},...,\hat{%
\mathbf{p}}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.7.m6.5d">caligraphic_P start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = { over^ start_ARG bold_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , over^ start_ARG bold_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , … , over^ start_ARG bold_p end_ARG start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math>, correspondingly.
The process can be formulated as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx8">
<tbody id="S2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{P}_{b}=\textbf{Bi-SSD}(\mathcal{E}_{b},\mathcal{R}_{b})," class="ltx_Math" display="inline" id="S2.E11.m1.1"><semantics id="S2.E11.m1.1a"><mrow id="S2.E11.m1.1.1.1" xref="S2.E11.m1.1.1.1.1.cmml"><mrow id="S2.E11.m1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.cmml"><msub id="S2.E11.m1.1.1.1.1.4" xref="S2.E11.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E11.m1.1.1.1.1.4.2" xref="S2.E11.m1.1.1.1.1.4.2.cmml">𝒫</mi><mi id="S2.E11.m1.1.1.1.1.4.3" xref="S2.E11.m1.1.1.1.1.4.3.cmml">b</mi></msub><mo id="S2.E11.m1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E11.m1.1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E11.m1.1.1.1.1.2.4" xref="S2.E11.m1.1.1.1.1.2.4a.cmml">Bi-SSD</mtext><mo id="S2.E11.m1.1.1.1.1.2.3" xref="S2.E11.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E11.m1.1.1.1.1.2.2.2" xref="S2.E11.m1.1.1.1.1.2.2.3.cmml"><mo id="S2.E11.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E11.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E11.m1.1.1.1.1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E11.m1.1.1.1.1.1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S2.E11.m1.1.1.1.1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S2.E11.m1.1.1.1.1.2.2.2.4" xref="S2.E11.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E11.m1.1.1.1.1.2.2.2.2" xref="S2.E11.m1.1.1.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E11.m1.1.1.1.1.2.2.2.2.2" xref="S2.E11.m1.1.1.1.1.2.2.2.2.2.cmml">ℛ</mi><mi id="S2.E11.m1.1.1.1.1.2.2.2.2.3" xref="S2.E11.m1.1.1.1.1.2.2.2.2.3.cmml">b</mi></msub><mo id="S2.E11.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E11.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E11.m1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m1.1b"><apply id="S2.E11.m1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1"><eq id="S2.E11.m1.1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.1.3"></eq><apply id="S2.E11.m1.1.1.1.1.4.cmml" xref="S2.E11.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.4.1.cmml" xref="S2.E11.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E11.m1.1.1.1.1.4.2.cmml" xref="S2.E11.m1.1.1.1.1.4.2">𝒫</ci><ci id="S2.E11.m1.1.1.1.1.4.3.cmml" xref="S2.E11.m1.1.1.1.1.4.3">𝑏</ci></apply><apply id="S2.E11.m1.1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.1.2"><times id="S2.E11.m1.1.1.1.1.2.3.cmml" xref="S2.E11.m1.1.1.1.1.2.3"></times><ci id="S2.E11.m1.1.1.1.1.2.4a.cmml" xref="S2.E11.m1.1.1.1.1.2.4"><mtext class="ltx_mathvariant_bold" id="S2.E11.m1.1.1.1.1.2.4.cmml" xref="S2.E11.m1.1.1.1.1.2.4">Bi-SSD</mtext></ci><interval closure="open" id="S2.E11.m1.1.1.1.1.2.2.3.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2"><apply id="S2.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E11.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.1.2">ℰ</ci><ci id="S2.E11.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.1.1.1.1.1.3">𝑏</ci></apply><apply id="S2.E11.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E11.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2.2.2">ℛ</ci><ci id="S2.E11.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E11.m1.1.1.1.1.2.2.2.2.3">𝑏</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.1c">\displaystyle\mathcal{P}_{b}=\textbf{Bi-SSD}(\mathcal{E}_{b},\mathcal{R}_{b}),</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.1d">caligraphic_P start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = Bi-SSD ( caligraphic_E start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS2.p1.9">where <math alttext="\hat{\mathbf{p}}_{k}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.8.m1.1"><semantics id="S2.SS4.SSS2.p1.8.m1.1a"><mrow id="S2.SS4.SSS2.p1.8.m1.1.1" xref="S2.SS4.SSS2.p1.8.m1.1.1.cmml"><msub id="S2.SS4.SSS2.p1.8.m1.1.1.2" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.cmml"><mover accent="true" id="S2.SS4.SSS2.p1.8.m1.1.1.2.2" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.2.cmml"><mi id="S2.SS4.SSS2.p1.8.m1.1.1.2.2.2" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.2.2.cmml">𝐩</mi><mo id="S2.SS4.SSS2.p1.8.m1.1.1.2.2.1" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.SS4.SSS2.p1.8.m1.1.1.2.3" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS4.SSS2.p1.8.m1.1.1.1" xref="S2.SS4.SSS2.p1.8.m1.1.1.1.cmml">∈</mo><msup id="S2.SS4.SSS2.p1.8.m1.1.1.3" xref="S2.SS4.SSS2.p1.8.m1.1.1.3.cmml"><mi id="S2.SS4.SSS2.p1.8.m1.1.1.3.2" xref="S2.SS4.SSS2.p1.8.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS4.SSS2.p1.8.m1.1.1.3.3" xref="S2.SS4.SSS2.p1.8.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.8.m1.1b"><apply id="S2.SS4.SSS2.p1.8.m1.1.1.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1"><in id="S2.SS4.SSS2.p1.8.m1.1.1.1.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.1"></in><apply id="S2.SS4.SSS2.p1.8.m1.1.1.2.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.8.m1.1.1.2.1.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.2">subscript</csymbol><apply id="S2.SS4.SSS2.p1.8.m1.1.1.2.2.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.2"><ci id="S2.SS4.SSS2.p1.8.m1.1.1.2.2.1.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.2.1">^</ci><ci id="S2.SS4.SSS2.p1.8.m1.1.1.2.2.2.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.2.2">𝐩</ci></apply><ci id="S2.SS4.SSS2.p1.8.m1.1.1.2.3.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.2.3">𝑘</ci></apply><apply id="S2.SS4.SSS2.p1.8.m1.1.1.3.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.8.m1.1.1.3.1.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.3">superscript</csymbol><ci id="S2.SS4.SSS2.p1.8.m1.1.1.3.2.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.3.2">ℝ</ci><ci id="S2.SS4.SSS2.p1.8.m1.1.1.3.3.cmml" xref="S2.SS4.SSS2.p1.8.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.8.m1.1c">\hat{\mathbf{p}}_{k}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.8.m1.1d">over^ start_ARG bold_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the predicted representation for user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p1.9.m2.1"><semantics id="S2.SS4.SSS2.p1.9.m2.1a"><msub id="S2.SS4.SSS2.p1.9.m2.1.1" xref="S2.SS4.SSS2.p1.9.m2.1.1.cmml"><mi id="S2.SS4.SSS2.p1.9.m2.1.1.2" xref="S2.SS4.SSS2.p1.9.m2.1.1.2.cmml">u</mi><mi id="S2.SS4.SSS2.p1.9.m2.1.1.3" xref="S2.SS4.SSS2.p1.9.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p1.9.m2.1b"><apply id="S2.SS4.SSS2.p1.9.m2.1.1.cmml" xref="S2.SS4.SSS2.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p1.9.m2.1.1.1.cmml" xref="S2.SS4.SSS2.p1.9.m2.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p1.9.m2.1.1.2.cmml" xref="S2.SS4.SSS2.p1.9.m2.1.1.2">𝑢</ci><ci id="S2.SS4.SSS2.p1.9.m2.1.1.3.cmml" xref="S2.SS4.SSS2.p1.9.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p1.9.m2.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p1.9.m2.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.4.3. </span><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS3.1.1">Prediction Layer</span>
</h4>
<div class="ltx_para" id="S2.SS4.SSS3.p1">
<p class="ltx_p" id="S2.SS4.SSS3.p1.2">Finally, in the prediction layer, SSD4Rec using the
predicted representations to generate the final output prediction scores.
In a specific batch <math alttext="b" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p1.1.m1.1"><semantics id="S2.SS4.SSS3.p1.1.m1.1a"><mi id="S2.SS4.SSS3.p1.1.m1.1.1" xref="S2.SS4.SSS3.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p1.1.m1.1b"><ci id="S2.SS4.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS4.SSS3.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p1.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p1.1.m1.1d">italic_b</annotation></semantics></math> with <math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p1.2.m2.1"><semantics id="S2.SS4.SSS3.p1.2.m2.1a"><mi id="S2.SS4.SSS3.p1.2.m2.1.1" xref="S2.SS4.SSS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p1.2.m2.1b"><ci id="S2.SS4.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS4.SSS3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p1.2.m2.1d">italic_K</annotation></semantics></math> users, the prediction process can be written by</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx9">
<tbody id="S2.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathcal{Y}}_{b}=\text{Softmax}(\mathcal{P}_{b}*\mathcal{Q})," class="ltx_Math" display="inline" id="S2.E12.m1.1"><semantics id="S2.E12.m1.1a"><mrow id="S2.E12.m1.1.1.1" xref="S2.E12.m1.1.1.1.1.cmml"><mrow id="S2.E12.m1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.cmml"><msub id="S2.E12.m1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E12.m1.1.1.1.1.3.2" xref="S2.E12.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.1.1.1.1.3.2.2" xref="S2.E12.m1.1.1.1.1.3.2.2.cmml">𝒴</mi><mo id="S2.E12.m1.1.1.1.1.3.2.1" xref="S2.E12.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E12.m1.1.1.1.1.3.3" xref="S2.E12.m1.1.1.1.1.3.3.cmml">b</mi></msub><mo id="S2.E12.m1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E12.m1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.cmml"><mtext id="S2.E12.m1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.3a.cmml">Softmax</mtext><mo id="S2.E12.m1.1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E12.m1.1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E12.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E12.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E12.m1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E12.m1.1.1.1.1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E12.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="S2.E12.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml">b</mi></msub><mo id="S2.E12.m1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.1.1.1.3.cmml">𝒬</mi></mrow><mo id="S2.E12.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E12.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E12.m1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.1b"><apply id="S2.E12.m1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1"><eq id="S2.E12.m1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.2"></eq><apply id="S2.E12.m1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.3.1.cmml" xref="S2.E12.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E12.m1.1.1.1.1.3.2.cmml" xref="S2.E12.m1.1.1.1.1.3.2"><ci id="S2.E12.m1.1.1.1.1.3.2.1.cmml" xref="S2.E12.m1.1.1.1.1.3.2.1">^</ci><ci id="S2.E12.m1.1.1.1.1.3.2.2.cmml" xref="S2.E12.m1.1.1.1.1.3.2.2">𝒴</ci></apply><ci id="S2.E12.m1.1.1.1.1.3.3.cmml" xref="S2.E12.m1.1.1.1.1.3.3">𝑏</ci></apply><apply id="S2.E12.m1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1"><times id="S2.E12.m1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.2"></times><ci id="S2.E12.m1.1.1.1.1.1.3a.cmml" xref="S2.E12.m1.1.1.1.1.1.3"><mtext id="S2.E12.m1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.1.3">Softmax</mtext></ci><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1"><times id="S2.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.2.2">𝒫</ci><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.2.3">𝑏</ci></apply><ci id="S2.E12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.1.1.3">𝒬</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.1c">\displaystyle\hat{\mathcal{Y}}_{b}=\text{Softmax}(\mathcal{P}_{b}*\mathcal{Q}),</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.1d">over^ start_ARG caligraphic_Y end_ARG start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = Softmax ( caligraphic_P start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ∗ caligraphic_Q ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.SSS3.p1.6">where <math alttext="\hat{\mathcal{Y}}_{b}=\{\hat{\mathbf{y}}_{u_{1}},...,\hat{\mathbf{y}}_{u_{K}}%
\}\in\mathbb{R}^{1\times K\times|\mathcal{V}|}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p1.3.m1.4"><semantics id="S2.SS4.SSS3.p1.3.m1.4a"><mrow id="S2.SS4.SSS3.p1.3.m1.4.4" xref="S2.SS4.SSS3.p1.3.m1.4.4.cmml"><msub id="S2.SS4.SSS3.p1.3.m1.4.4.4" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.cmml"><mover accent="true" id="S2.SS4.SSS3.p1.3.m1.4.4.4.2" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS3.p1.3.m1.4.4.4.2.2" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.2.2.cmml">𝒴</mi><mo id="S2.SS4.SSS3.p1.3.m1.4.4.4.2.1" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.2.1.cmml">^</mo></mover><mi id="S2.SS4.SSS3.p1.3.m1.4.4.4.3" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.3.cmml">b</mi></msub><mo id="S2.SS4.SSS3.p1.3.m1.4.4.5" xref="S2.SS4.SSS3.p1.3.m1.4.4.5.cmml">=</mo><mrow id="S2.SS4.SSS3.p1.3.m1.4.4.2.2" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.3.cmml"><mo id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.3" stretchy="false" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.3.cmml">{</mo><msub id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.cmml"><mover accent="true" id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.cmml"><mi id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.2" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.2.cmml">𝐲</mi><mo id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.1" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.1.cmml">^</mo></mover><msub id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.cmml"><mi id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.2" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.2.cmml">u</mi><mn id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.3" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.4" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.3.cmml">,</mo><mi id="S2.SS4.SSS3.p1.3.m1.2.2" mathvariant="normal" xref="S2.SS4.SSS3.p1.3.m1.2.2.cmml">…</mi><mo id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.5" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.3.cmml">,</mo><msub id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.cmml"><mover accent="true" id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.cmml"><mi id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.2" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.2.cmml">𝐲</mi><mo id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.1" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.1.cmml">^</mo></mover><msub id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.cmml"><mi id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.2" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.2.cmml">u</mi><mi id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.3" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.3.cmml">K</mi></msub></msub><mo id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.6" stretchy="false" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.3.cmml">}</mo></mrow><mo id="S2.SS4.SSS3.p1.3.m1.4.4.6" xref="S2.SS4.SSS3.p1.3.m1.4.4.6.cmml">∈</mo><msup id="S2.SS4.SSS3.p1.3.m1.4.4.7" xref="S2.SS4.SSS3.p1.3.m1.4.4.7.cmml"><mi id="S2.SS4.SSS3.p1.3.m1.4.4.7.2" xref="S2.SS4.SSS3.p1.3.m1.4.4.7.2.cmml">ℝ</mi><mrow id="S2.SS4.SSS3.p1.3.m1.1.1.1" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.cmml"><mn id="S2.SS4.SSS3.p1.3.m1.1.1.1.3" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.3.cmml">1</mn><mo id="S2.SS4.SSS3.p1.3.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.2.cmml">×</mo><mi id="S2.SS4.SSS3.p1.3.m1.1.1.1.4" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.4.cmml">K</mi><mo id="S2.SS4.SSS3.p1.3.m1.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.2.cmml">×</mo><mrow id="S2.SS4.SSS3.p1.3.m1.1.1.1.5.2" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.5.1.cmml"><mo id="S2.SS4.SSS3.p1.3.m1.1.1.1.5.2.1" stretchy="false" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.5.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS3.p1.3.m1.1.1.1.1" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.1.cmml">𝒱</mi><mo id="S2.SS4.SSS3.p1.3.m1.1.1.1.5.2.2" stretchy="false" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.5.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p1.3.m1.4b"><apply id="S2.SS4.SSS3.p1.3.m1.4.4.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4"><and id="S2.SS4.SSS3.p1.3.m1.4.4a.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4"></and><apply id="S2.SS4.SSS3.p1.3.m1.4.4b.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4"><eq id="S2.SS4.SSS3.p1.3.m1.4.4.5.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.5"></eq><apply id="S2.SS4.SSS3.p1.3.m1.4.4.4.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.4"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p1.3.m1.4.4.4.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.4">subscript</csymbol><apply id="S2.SS4.SSS3.p1.3.m1.4.4.4.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.2"><ci id="S2.SS4.SSS3.p1.3.m1.4.4.4.2.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.2.1">^</ci><ci id="S2.SS4.SSS3.p1.3.m1.4.4.4.2.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.2.2">𝒴</ci></apply><ci id="S2.SS4.SSS3.p1.3.m1.4.4.4.3.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.4.3">𝑏</ci></apply><set id="S2.SS4.SSS3.p1.3.m1.4.4.2.3.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2"><apply id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1">subscript</csymbol><apply id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2"><ci id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.1">^</ci><ci id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.2.2">𝐲</ci></apply><apply id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.cmml" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.2">𝑢</ci><cn id="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.3.cmml" type="integer" xref="S2.SS4.SSS3.p1.3.m1.3.3.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS4.SSS3.p1.3.m1.2.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.2.2">…</ci><apply id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2">subscript</csymbol><apply id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2"><ci id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.1">^</ci><ci id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.2.2">𝐲</ci></apply><apply id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3">subscript</csymbol><ci id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.2">𝑢</ci><ci id="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.3.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.2.2.2.3.3">𝐾</ci></apply></apply></set></apply><apply id="S2.SS4.SSS3.p1.3.m1.4.4c.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4"><in id="S2.SS4.SSS3.p1.3.m1.4.4.6.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.6"></in><share href="https://arxiv.org/html/2409.01192v1#S2.SS4.SSS3.p1.3.m1.4.4.2.cmml" id="S2.SS4.SSS3.p1.3.m1.4.4d.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4"></share><apply id="S2.SS4.SSS3.p1.3.m1.4.4.7.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.7"><csymbol cd="ambiguous" id="S2.SS4.SSS3.p1.3.m1.4.4.7.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.7">superscript</csymbol><ci id="S2.SS4.SSS3.p1.3.m1.4.4.7.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.4.4.7.2">ℝ</ci><apply id="S2.SS4.SSS3.p1.3.m1.1.1.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.1.1.1"><times id="S2.SS4.SSS3.p1.3.m1.1.1.1.2.cmml" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.2"></times><cn id="S2.SS4.SSS3.p1.3.m1.1.1.1.3.cmml" type="integer" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.3">1</cn><ci id="S2.SS4.SSS3.p1.3.m1.1.1.1.4.cmml" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.4">𝐾</ci><apply id="S2.SS4.SSS3.p1.3.m1.1.1.1.5.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.5.2"><abs id="S2.SS4.SSS3.p1.3.m1.1.1.1.5.1.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.5.2.1"></abs><ci id="S2.SS4.SSS3.p1.3.m1.1.1.1.1.cmml" xref="S2.SS4.SSS3.p1.3.m1.1.1.1.1">𝒱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p1.3.m1.4c">\hat{\mathcal{Y}}_{b}=\{\hat{\mathbf{y}}_{u_{1}},...,\hat{\mathbf{y}}_{u_{K}}%
\}\in\mathbb{R}^{1\times K\times|\mathcal{V}|}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p1.3.m1.4d">over^ start_ARG caligraphic_Y end_ARG start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = { over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT end_POSTSUBSCRIPT } ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_K × | caligraphic_V | end_POSTSUPERSCRIPT</annotation></semantics></math> represents the predicted probability distributions over the next item in the item set <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p1.4.m2.1"><semantics id="S2.SS4.SSS3.p1.4.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS3.p1.4.m2.1.1" xref="S2.SS4.SSS3.p1.4.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p1.4.m2.1b"><ci id="S2.SS4.SSS3.p1.4.m2.1.1.cmml" xref="S2.SS4.SSS3.p1.4.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p1.4.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p1.4.m2.1d">caligraphic_V</annotation></semantics></math>, and <math alttext="\mathcal{Q}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p1.5.m3.1"><semantics id="S2.SS4.SSS3.p1.5.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS3.p1.5.m3.1.1" xref="S2.SS4.SSS3.p1.5.m3.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p1.5.m3.1b"><ci id="S2.SS4.SSS3.p1.5.m3.1.1.cmml" xref="S2.SS4.SSS3.p1.5.m3.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p1.5.m3.1c">\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p1.5.m3.1d">caligraphic_Q</annotation></semantics></math> denotes the corresponding embeddings for items in <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS4.SSS3.p1.6.m4.1"><semantics id="S2.SS4.SSS3.p1.6.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.SSS3.p1.6.m4.1.1" xref="S2.SS4.SSS3.p1.6.m4.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS3.p1.6.m4.1b"><ci id="S2.SS4.SSS3.p1.6.m4.1.1.cmml" xref="S2.SS4.SSS3.p1.6.m4.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS3.p1.6.m4.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS3.p1.6.m4.1d">caligraphic_V</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5. </span><span class="ltx_text ltx_font_bold" id="S2.SS5.1.1">Learning Objective</span>
</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.1">To learn the parameters of the proposed method SSD4Rec for sequential recommendation, we use a representative objective function, Cross-Entropy (CE) loss, between the predicted probability distributions and the classification labels of corresponding positive items for optimizing the model.
Mathmatically, in a batch with <math alttext="K" class="ltx_Math" display="inline" id="S2.SS5.p1.1.m1.1"><semantics id="S2.SS5.p1.1.m1.1a"><mi id="S2.SS5.p1.1.m1.1.1" xref="S2.SS5.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.1b"><ci id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.1.m1.1d">italic_K</annotation></semantics></math> users, the loss function can be expressed as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx10">
<tbody id="S2.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}=-\sum^{K}_{k=1}\sum^{D}_{d=1}\mathbf{g}_{u_{k},d}\log%
(\hat{\mathbf{y}}_{u_{k},d})," class="ltx_Math" display="inline" id="S2.E13.m1.6"><semantics id="S2.E13.m1.6a"><mrow id="S2.E13.m1.6.6.1" xref="S2.E13.m1.6.6.1.1.cmml"><mrow id="S2.E13.m1.6.6.1.1" xref="S2.E13.m1.6.6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E13.m1.6.6.1.1.3" xref="S2.E13.m1.6.6.1.1.3.cmml">ℒ</mi><mo id="S2.E13.m1.6.6.1.1.2" xref="S2.E13.m1.6.6.1.1.2.cmml">=</mo><mrow id="S2.E13.m1.6.6.1.1.1" xref="S2.E13.m1.6.6.1.1.1.cmml"><mo id="S2.E13.m1.6.6.1.1.1a" xref="S2.E13.m1.6.6.1.1.1.cmml">−</mo><mrow id="S2.E13.m1.6.6.1.1.1.1" xref="S2.E13.m1.6.6.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E13.m1.6.6.1.1.1.1.2" xref="S2.E13.m1.6.6.1.1.1.1.2.cmml"><munderover id="S2.E13.m1.6.6.1.1.1.1.2a" xref="S2.E13.m1.6.6.1.1.1.1.2.cmml"><mo id="S2.E13.m1.6.6.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E13.m1.6.6.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E13.m1.6.6.1.1.1.1.2.3" xref="S2.E13.m1.6.6.1.1.1.1.2.3.cmml"><mi id="S2.E13.m1.6.6.1.1.1.1.2.3.2" xref="S2.E13.m1.6.6.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.E13.m1.6.6.1.1.1.1.2.3.1" xref="S2.E13.m1.6.6.1.1.1.1.2.3.1.cmml">=</mo><mn id="S2.E13.m1.6.6.1.1.1.1.2.3.3" xref="S2.E13.m1.6.6.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E13.m1.6.6.1.1.1.1.2.2.3" xref="S2.E13.m1.6.6.1.1.1.1.2.2.3.cmml">K</mi></munderover></mstyle><mrow id="S2.E13.m1.6.6.1.1.1.1.1" xref="S2.E13.m1.6.6.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E13.m1.6.6.1.1.1.1.1.2" xref="S2.E13.m1.6.6.1.1.1.1.1.2.cmml"><munderover id="S2.E13.m1.6.6.1.1.1.1.1.2a" xref="S2.E13.m1.6.6.1.1.1.1.1.2.cmml"><mo id="S2.E13.m1.6.6.1.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E13.m1.6.6.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E13.m1.6.6.1.1.1.1.1.2.3" xref="S2.E13.m1.6.6.1.1.1.1.1.2.3.cmml"><mi id="S2.E13.m1.6.6.1.1.1.1.1.2.3.2" xref="S2.E13.m1.6.6.1.1.1.1.1.2.3.2.cmml">d</mi><mo id="S2.E13.m1.6.6.1.1.1.1.1.2.3.1" xref="S2.E13.m1.6.6.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S2.E13.m1.6.6.1.1.1.1.1.2.3.3" xref="S2.E13.m1.6.6.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E13.m1.6.6.1.1.1.1.1.2.2.3" xref="S2.E13.m1.6.6.1.1.1.1.1.2.2.3.cmml">D</mi></munderover></mstyle><mrow id="S2.E13.m1.6.6.1.1.1.1.1.1" xref="S2.E13.m1.6.6.1.1.1.1.1.1.cmml"><msub id="S2.E13.m1.6.6.1.1.1.1.1.1.3" xref="S2.E13.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S2.E13.m1.6.6.1.1.1.1.1.1.3.2" xref="S2.E13.m1.6.6.1.1.1.1.1.1.3.2.cmml">𝐠</mi><mrow id="S2.E13.m1.2.2.2.2" xref="S2.E13.m1.2.2.2.3.cmml"><msub id="S2.E13.m1.2.2.2.2.1" xref="S2.E13.m1.2.2.2.2.1.cmml"><mi id="S2.E13.m1.2.2.2.2.1.2" xref="S2.E13.m1.2.2.2.2.1.2.cmml">u</mi><mi id="S2.E13.m1.2.2.2.2.1.3" xref="S2.E13.m1.2.2.2.2.1.3.cmml">k</mi></msub><mo id="S2.E13.m1.2.2.2.2.2" xref="S2.E13.m1.2.2.2.3.cmml">,</mo><mi id="S2.E13.m1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.cmml">d</mi></mrow></msub><mo id="S2.E13.m1.6.6.1.1.1.1.1.1.2" lspace="0.167em" xref="S2.E13.m1.6.6.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E13.m1.5.5" xref="S2.E13.m1.5.5.cmml">log</mi><mo id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1a" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐲</mi><mo id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E13.m1.4.4.2.2" xref="S2.E13.m1.4.4.2.3.cmml"><msub id="S2.E13.m1.4.4.2.2.1" xref="S2.E13.m1.4.4.2.2.1.cmml"><mi id="S2.E13.m1.4.4.2.2.1.2" xref="S2.E13.m1.4.4.2.2.1.2.cmml">u</mi><mi id="S2.E13.m1.4.4.2.2.1.3" xref="S2.E13.m1.4.4.2.2.1.3.cmml">k</mi></msub><mo id="S2.E13.m1.4.4.2.2.2" xref="S2.E13.m1.4.4.2.3.cmml">,</mo><mi id="S2.E13.m1.3.3.1.1" xref="S2.E13.m1.3.3.1.1.cmml">d</mi></mrow></msub><mo id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S2.E13.m1.6.6.1.2" xref="S2.E13.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m1.6b"><apply id="S2.E13.m1.6.6.1.1.cmml" xref="S2.E13.m1.6.6.1"><eq id="S2.E13.m1.6.6.1.1.2.cmml" xref="S2.E13.m1.6.6.1.1.2"></eq><ci id="S2.E13.m1.6.6.1.1.3.cmml" xref="S2.E13.m1.6.6.1.1.3">ℒ</ci><apply id="S2.E13.m1.6.6.1.1.1.cmml" xref="S2.E13.m1.6.6.1.1.1"><minus id="S2.E13.m1.6.6.1.1.1.2.cmml" xref="S2.E13.m1.6.6.1.1.1"></minus><apply id="S2.E13.m1.6.6.1.1.1.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1"><apply id="S2.E13.m1.6.6.1.1.1.1.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.1.1.1.1.2.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2">subscript</csymbol><apply id="S2.E13.m1.6.6.1.1.1.1.2.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.1.1.1.1.2.2.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2">superscript</csymbol><sum id="S2.E13.m1.6.6.1.1.1.1.2.2.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2.2.2"></sum><ci id="S2.E13.m1.6.6.1.1.1.1.2.2.3.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2.2.3">𝐾</ci></apply><apply id="S2.E13.m1.6.6.1.1.1.1.2.3.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2.3"><eq id="S2.E13.m1.6.6.1.1.1.1.2.3.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2.3.1"></eq><ci id="S2.E13.m1.6.6.1.1.1.1.2.3.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.2.3.2">𝑘</ci><cn id="S2.E13.m1.6.6.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.E13.m1.6.6.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E13.m1.6.6.1.1.1.1.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1"><apply id="S2.E13.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E13.m1.6.6.1.1.1.1.1.2.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.1.1.1.1.1.2.2.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2">superscript</csymbol><sum id="S2.E13.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2.2.2"></sum><ci id="S2.E13.m1.6.6.1.1.1.1.1.2.2.3.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2.2.3">𝐷</ci></apply><apply id="S2.E13.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2.3"><eq id="S2.E13.m1.6.6.1.1.1.1.1.2.3.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2.3.1"></eq><ci id="S2.E13.m1.6.6.1.1.1.1.1.2.3.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.2.3.2">𝑑</ci><cn id="S2.E13.m1.6.6.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.E13.m1.6.6.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E13.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1"><times id="S2.E13.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.2"></times><apply id="S2.E13.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E13.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.3.2">𝐠</ci><list id="S2.E13.m1.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2"><apply id="S2.E13.m1.2.2.2.2.1.cmml" xref="S2.E13.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.2.2.1.1.cmml" xref="S2.E13.m1.2.2.2.2.1">subscript</csymbol><ci id="S2.E13.m1.2.2.2.2.1.2.cmml" xref="S2.E13.m1.2.2.2.2.1.2">𝑢</ci><ci id="S2.E13.m1.2.2.2.2.1.3.cmml" xref="S2.E13.m1.2.2.2.2.1.3">𝑘</ci></apply><ci id="S2.E13.m1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1">𝑑</ci></list></apply><apply id="S2.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1"><log id="S2.E13.m1.5.5.cmml" xref="S2.E13.m1.5.5"></log><apply id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2"><ci id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2">𝐲</ci></apply><list id="S2.E13.m1.4.4.2.3.cmml" xref="S2.E13.m1.4.4.2.2"><apply id="S2.E13.m1.4.4.2.2.1.cmml" xref="S2.E13.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S2.E13.m1.4.4.2.2.1.1.cmml" xref="S2.E13.m1.4.4.2.2.1">subscript</csymbol><ci id="S2.E13.m1.4.4.2.2.1.2.cmml" xref="S2.E13.m1.4.4.2.2.1.2">𝑢</ci><ci id="S2.E13.m1.4.4.2.2.1.3.cmml" xref="S2.E13.m1.4.4.2.2.1.3">𝑘</ci></apply><ci id="S2.E13.m1.3.3.1.1.cmml" xref="S2.E13.m1.3.3.1.1">𝑑</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.6c">\displaystyle\mathcal{L}=-\sum^{K}_{k=1}\sum^{D}_{d=1}\mathbf{g}_{u_{k},d}\log%
(\hat{\mathbf{y}}_{u_{k},d}),</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.6d">caligraphic_L = - ∑ start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT ∑ start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d = 1 end_POSTSUBSCRIPT bold_g start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_d end_POSTSUBSCRIPT roman_log ( over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_d end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p1.5">where <math alttext="\mathbf{g}_{u_{k},d}" class="ltx_Math" display="inline" id="S2.SS5.p1.2.m1.2"><semantics id="S2.SS5.p1.2.m1.2a"><msub id="S2.SS5.p1.2.m1.2.3" xref="S2.SS5.p1.2.m1.2.3.cmml"><mi id="S2.SS5.p1.2.m1.2.3.2" xref="S2.SS5.p1.2.m1.2.3.2.cmml">𝐠</mi><mrow id="S2.SS5.p1.2.m1.2.2.2.2" xref="S2.SS5.p1.2.m1.2.2.2.3.cmml"><msub id="S2.SS5.p1.2.m1.2.2.2.2.1" xref="S2.SS5.p1.2.m1.2.2.2.2.1.cmml"><mi id="S2.SS5.p1.2.m1.2.2.2.2.1.2" xref="S2.SS5.p1.2.m1.2.2.2.2.1.2.cmml">u</mi><mi id="S2.SS5.p1.2.m1.2.2.2.2.1.3" xref="S2.SS5.p1.2.m1.2.2.2.2.1.3.cmml">k</mi></msub><mo id="S2.SS5.p1.2.m1.2.2.2.2.2" xref="S2.SS5.p1.2.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS5.p1.2.m1.1.1.1.1" xref="S2.SS5.p1.2.m1.1.1.1.1.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.2.m1.2b"><apply id="S2.SS5.p1.2.m1.2.3.cmml" xref="S2.SS5.p1.2.m1.2.3"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m1.2.3.1.cmml" xref="S2.SS5.p1.2.m1.2.3">subscript</csymbol><ci id="S2.SS5.p1.2.m1.2.3.2.cmml" xref="S2.SS5.p1.2.m1.2.3.2">𝐠</ci><list id="S2.SS5.p1.2.m1.2.2.2.3.cmml" xref="S2.SS5.p1.2.m1.2.2.2.2"><apply id="S2.SS5.p1.2.m1.2.2.2.2.1.cmml" xref="S2.SS5.p1.2.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m1.2.2.2.2.1.1.cmml" xref="S2.SS5.p1.2.m1.2.2.2.2.1">subscript</csymbol><ci id="S2.SS5.p1.2.m1.2.2.2.2.1.2.cmml" xref="S2.SS5.p1.2.m1.2.2.2.2.1.2">𝑢</ci><ci id="S2.SS5.p1.2.m1.2.2.2.2.1.3.cmml" xref="S2.SS5.p1.2.m1.2.2.2.2.1.3">𝑘</ci></apply><ci id="S2.SS5.p1.2.m1.1.1.1.1.cmml" xref="S2.SS5.p1.2.m1.1.1.1.1">𝑑</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.2.m1.2c">\mathbf{g}_{u_{k},d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.2.m1.2d">bold_g start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\hat{\mathbf{y}}_{u_{k},d}" class="ltx_Math" display="inline" id="S2.SS5.p1.3.m2.2"><semantics id="S2.SS5.p1.3.m2.2a"><msub id="S2.SS5.p1.3.m2.2.3" xref="S2.SS5.p1.3.m2.2.3.cmml"><mover accent="true" id="S2.SS5.p1.3.m2.2.3.2" xref="S2.SS5.p1.3.m2.2.3.2.cmml"><mi id="S2.SS5.p1.3.m2.2.3.2.2" xref="S2.SS5.p1.3.m2.2.3.2.2.cmml">𝐲</mi><mo id="S2.SS5.p1.3.m2.2.3.2.1" xref="S2.SS5.p1.3.m2.2.3.2.1.cmml">^</mo></mover><mrow id="S2.SS5.p1.3.m2.2.2.2.2" xref="S2.SS5.p1.3.m2.2.2.2.3.cmml"><msub id="S2.SS5.p1.3.m2.2.2.2.2.1" xref="S2.SS5.p1.3.m2.2.2.2.2.1.cmml"><mi id="S2.SS5.p1.3.m2.2.2.2.2.1.2" xref="S2.SS5.p1.3.m2.2.2.2.2.1.2.cmml">u</mi><mi id="S2.SS5.p1.3.m2.2.2.2.2.1.3" xref="S2.SS5.p1.3.m2.2.2.2.2.1.3.cmml">k</mi></msub><mo id="S2.SS5.p1.3.m2.2.2.2.2.2" xref="S2.SS5.p1.3.m2.2.2.2.3.cmml">,</mo><mi id="S2.SS5.p1.3.m2.1.1.1.1" xref="S2.SS5.p1.3.m2.1.1.1.1.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.3.m2.2b"><apply id="S2.SS5.p1.3.m2.2.3.cmml" xref="S2.SS5.p1.3.m2.2.3"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m2.2.3.1.cmml" xref="S2.SS5.p1.3.m2.2.3">subscript</csymbol><apply id="S2.SS5.p1.3.m2.2.3.2.cmml" xref="S2.SS5.p1.3.m2.2.3.2"><ci id="S2.SS5.p1.3.m2.2.3.2.1.cmml" xref="S2.SS5.p1.3.m2.2.3.2.1">^</ci><ci id="S2.SS5.p1.3.m2.2.3.2.2.cmml" xref="S2.SS5.p1.3.m2.2.3.2.2">𝐲</ci></apply><list id="S2.SS5.p1.3.m2.2.2.2.3.cmml" xref="S2.SS5.p1.3.m2.2.2.2.2"><apply id="S2.SS5.p1.3.m2.2.2.2.2.1.cmml" xref="S2.SS5.p1.3.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m2.2.2.2.2.1.1.cmml" xref="S2.SS5.p1.3.m2.2.2.2.2.1">subscript</csymbol><ci id="S2.SS5.p1.3.m2.2.2.2.2.1.2.cmml" xref="S2.SS5.p1.3.m2.2.2.2.2.1.2">𝑢</ci><ci id="S2.SS5.p1.3.m2.2.2.2.2.1.3.cmml" xref="S2.SS5.p1.3.m2.2.2.2.2.1.3">𝑘</ci></apply><ci id="S2.SS5.p1.3.m2.1.1.1.1.cmml" xref="S2.SS5.p1.3.m2.1.1.1.1">𝑑</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.3.m2.2c">\hat{\mathbf{y}}_{u_{k},d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.3.m2.2d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_d end_POSTSUBSCRIPT</annotation></semantics></math> denote the <math alttext="d" class="ltx_Math" display="inline" id="S2.SS5.p1.4.m3.1"><semantics id="S2.SS5.p1.4.m3.1a"><mi id="S2.SS5.p1.4.m3.1.1" xref="S2.SS5.p1.4.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.4.m3.1b"><ci id="S2.SS5.p1.4.m3.1.1.cmml" xref="S2.SS5.p1.4.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.4.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.4.m3.1d">italic_d</annotation></semantics></math>-th dimensions of the groundtruth distribution and predicted distribution for the user <math alttext="u_{k}" class="ltx_Math" display="inline" id="S2.SS5.p1.5.m4.1"><semantics id="S2.SS5.p1.5.m4.1a"><msub id="S2.SS5.p1.5.m4.1.1" xref="S2.SS5.p1.5.m4.1.1.cmml"><mi id="S2.SS5.p1.5.m4.1.1.2" xref="S2.SS5.p1.5.m4.1.1.2.cmml">u</mi><mi id="S2.SS5.p1.5.m4.1.1.3" xref="S2.SS5.p1.5.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.5.m4.1b"><apply id="S2.SS5.p1.5.m4.1.1.cmml" xref="S2.SS5.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m4.1.1.1.cmml" xref="S2.SS5.p1.5.m4.1.1">subscript</csymbol><ci id="S2.SS5.p1.5.m4.1.1.2.cmml" xref="S2.SS5.p1.5.m4.1.1.2">𝑢</ci><ci id="S2.SS5.p1.5.m4.1.1.3.cmml" xref="S2.SS5.p1.5.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.5.m4.1c">u_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.5.m4.1d">italic_u start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.
Given the loss, we can update our model iteratively in a mini-batch manner.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.6. </span><span class="ltx_text ltx_font_bold" id="S2.SS6.1.1">Time Complexity Analysis</span>
</h3>
<div class="ltx_para" id="S2.SS6.p1">
<p class="ltx_p" id="S2.SS6.p1.8">In general, the typical attention mechanisms require <math alttext="L^{2}N" class="ltx_Math" display="inline" id="S2.SS6.p1.1.m1.1"><semantics id="S2.SS6.p1.1.m1.1a"><mrow id="S2.SS6.p1.1.m1.1.1" xref="S2.SS6.p1.1.m1.1.1.cmml"><msup id="S2.SS6.p1.1.m1.1.1.2" xref="S2.SS6.p1.1.m1.1.1.2.cmml"><mi id="S2.SS6.p1.1.m1.1.1.2.2" xref="S2.SS6.p1.1.m1.1.1.2.2.cmml">L</mi><mn id="S2.SS6.p1.1.m1.1.1.2.3" xref="S2.SS6.p1.1.m1.1.1.2.3.cmml">2</mn></msup><mo id="S2.SS6.p1.1.m1.1.1.1" xref="S2.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.SS6.p1.1.m1.1.1.3" xref="S2.SS6.p1.1.m1.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.1.m1.1b"><apply id="S2.SS6.p1.1.m1.1.1.cmml" xref="S2.SS6.p1.1.m1.1.1"><times id="S2.SS6.p1.1.m1.1.1.1.cmml" xref="S2.SS6.p1.1.m1.1.1.1"></times><apply id="S2.SS6.p1.1.m1.1.1.2.cmml" xref="S2.SS6.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS6.p1.1.m1.1.1.2.1.cmml" xref="S2.SS6.p1.1.m1.1.1.2">superscript</csymbol><ci id="S2.SS6.p1.1.m1.1.1.2.2.cmml" xref="S2.SS6.p1.1.m1.1.1.2.2">𝐿</ci><cn id="S2.SS6.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S2.SS6.p1.1.m1.1.1.2.3">2</cn></apply><ci id="S2.SS6.p1.1.m1.1.1.3.cmml" xref="S2.SS6.p1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.1.m1.1c">L^{2}N</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.1.m1.1d">italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_N</annotation></semantics></math> total floating-point operations (FLOPs) <cite class="ltx_cite ltx_citemacro_citep">(Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite>, where <math alttext="L" class="ltx_Math" display="inline" id="S2.SS6.p1.2.m2.1"><semantics id="S2.SS6.p1.2.m2.1a"><mi id="S2.SS6.p1.2.m2.1.1" xref="S2.SS6.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.2.m2.1b"><ci id="S2.SS6.p1.2.m2.1.1.cmml" xref="S2.SS6.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.2.m2.1d">italic_L</annotation></semantics></math> is the length of sequence input and <math alttext="N" class="ltx_Math" display="inline" id="S2.SS6.p1.3.m3.1"><semantics id="S2.SS6.p1.3.m3.1a"><mi id="S2.SS6.p1.3.m3.1.1" xref="S2.SS6.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.3.m3.1b"><ci id="S2.SS6.p1.3.m3.1.1.cmml" xref="S2.SS6.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.3.m3.1d">italic_N</annotation></semantics></math> is the dimensional size of hidden representations. It can be observed that the computational overhead can quadratically increase with the input size.
The utilized SSD block involves <math alttext="LN^{2}" class="ltx_Math" display="inline" id="S2.SS6.p1.4.m4.1"><semantics id="S2.SS6.p1.4.m4.1a"><mrow id="S2.SS6.p1.4.m4.1.1" xref="S2.SS6.p1.4.m4.1.1.cmml"><mi id="S2.SS6.p1.4.m4.1.1.2" xref="S2.SS6.p1.4.m4.1.1.2.cmml">L</mi><mo id="S2.SS6.p1.4.m4.1.1.1" xref="S2.SS6.p1.4.m4.1.1.1.cmml">⁢</mo><msup id="S2.SS6.p1.4.m4.1.1.3" xref="S2.SS6.p1.4.m4.1.1.3.cmml"><mi id="S2.SS6.p1.4.m4.1.1.3.2" xref="S2.SS6.p1.4.m4.1.1.3.2.cmml">N</mi><mn id="S2.SS6.p1.4.m4.1.1.3.3" xref="S2.SS6.p1.4.m4.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.4.m4.1b"><apply id="S2.SS6.p1.4.m4.1.1.cmml" xref="S2.SS6.p1.4.m4.1.1"><times id="S2.SS6.p1.4.m4.1.1.1.cmml" xref="S2.SS6.p1.4.m4.1.1.1"></times><ci id="S2.SS6.p1.4.m4.1.1.2.cmml" xref="S2.SS6.p1.4.m4.1.1.2">𝐿</ci><apply id="S2.SS6.p1.4.m4.1.1.3.cmml" xref="S2.SS6.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS6.p1.4.m4.1.1.3.1.cmml" xref="S2.SS6.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS6.p1.4.m4.1.1.3.2.cmml" xref="S2.SS6.p1.4.m4.1.1.3.2">𝑁</ci><cn id="S2.SS6.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S2.SS6.p1.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.4.m4.1c">LN^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.4.m4.1d">italic_L italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> total FLOPs, scaling linearly with the sequence length <math alttext="L" class="ltx_Math" display="inline" id="S2.SS6.p1.5.m5.1"><semantics id="S2.SS6.p1.5.m5.1a"><mi id="S2.SS6.p1.5.m5.1.1" xref="S2.SS6.p1.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.5.m5.1b"><ci id="S2.SS6.p1.5.m5.1.1.cmml" xref="S2.SS6.p1.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.5.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.5.m5.1d">italic_L</annotation></semantics></math>.
As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.T1" title="Table 1 ‣ 2.6. Time Complexity Analysis ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, this feature in SSD enables the proposed model to attain reduced computational complexity in various recommendation scenarios characterized by prolonged user interactions, such as news recommendations and social media platforms, where the sequence length <math alttext="L" class="ltx_Math" display="inline" id="S2.SS6.p1.6.m6.1"><semantics id="S2.SS6.p1.6.m6.1a"><mi id="S2.SS6.p1.6.m6.1.1" xref="S2.SS6.p1.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.6.m6.1b"><ci id="S2.SS6.p1.6.m6.1.1.cmml" xref="S2.SS6.p1.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.6.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.6.m6.1d">italic_L</annotation></semantics></math> significantly exceeds the dimensional size <math alttext="N" class="ltx_Math" display="inline" id="S2.SS6.p1.7.m7.1"><semantics id="S2.SS6.p1.7.m7.1a"><mi id="S2.SS6.p1.7.m7.1.1" xref="S2.SS6.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.7.m7.1b"><ci id="S2.SS6.p1.7.m7.1.1.cmml" xref="S2.SS6.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.7.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.7.m7.1d">italic_N</annotation></semantics></math> of hidden representations, i.e., <math alttext="L&gt;&gt;N" class="ltx_Math" display="inline" id="S2.SS6.p1.8.m8.1"><semantics id="S2.SS6.p1.8.m8.1a"><mrow id="S2.SS6.p1.8.m8.1.1" xref="S2.SS6.p1.8.m8.1.1.cmml"><mi id="S2.SS6.p1.8.m8.1.1.2" xref="S2.SS6.p1.8.m8.1.1.2.cmml">L</mi><mo id="S2.SS6.p1.8.m8.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.SS6.p1.8.m8.1.1.1.cmml">&gt;&gt;</mo><mi id="S2.SS6.p1.8.m8.1.1.3" xref="S2.SS6.p1.8.m8.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.8.m8.1b"><apply id="S2.SS6.p1.8.m8.1.1.cmml" xref="S2.SS6.p1.8.m8.1.1"><csymbol cd="latexml" id="S2.SS6.p1.8.m8.1.1.1.cmml" xref="S2.SS6.p1.8.m8.1.1.1">much-greater-than</csymbol><ci id="S2.SS6.p1.8.m8.1.1.2.cmml" xref="S2.SS6.p1.8.m8.1.1.2">𝐿</ci><ci id="S2.SS6.p1.8.m8.1.1.3.cmml" xref="S2.SS6.p1.8.m8.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.8.m8.1c">L&gt;&gt;N</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.8.m8.1d">italic_L &gt; &gt; italic_N</annotation></semantics></math>.
Furthermore, the SSD layer empowers our model to execute Transformer-like matrix multiplications, enhancing efficiency compared to a straightforward selective SSM layer that utilizes the Parallel Associative Scan  <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib14" title="">2023</a>)</cite>.</p>
</div>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Comparison of computational complexity between representative sequential recommendation methods, where ”M.M.” refers to Matrix ”Multiplication”.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S2.T1.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.6.7.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S2.T1.6.7.1.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S2.T1.6.7.1.2">SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib22" title="">2018</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S2.T1.6.7.1.3">Mamba4Rec <cite class="ltx_cite ltx_citemacro_citep">(Liu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib26" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S2.T1.6.7.1.4"><span class="ltx_text ltx_font_bold" id="S2.T1.6.7.1.4.1">SSD4Rec</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.6.8.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S2.T1.6.8.2.1">Architecture</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.6.8.2.2">Attention</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.6.8.2.3">SSM</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.6.8.2.4">SSD</td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S2.T1.3.3.4">Training FLOPs</th>
<td class="ltx_td ltx_align_center" id="S2.T1.1.1.1"><math alttext="L^{2}N" class="ltx_Math" display="inline" id="S2.T1.1.1.1.m1.1"><semantics id="S2.T1.1.1.1.m1.1a"><mrow id="S2.T1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.m1.1.1.cmml"><msup id="S2.T1.1.1.1.m1.1.1.2" xref="S2.T1.1.1.1.m1.1.1.2.cmml"><mi id="S2.T1.1.1.1.m1.1.1.2.2" xref="S2.T1.1.1.1.m1.1.1.2.2.cmml">L</mi><mn id="S2.T1.1.1.1.m1.1.1.2.3" xref="S2.T1.1.1.1.m1.1.1.2.3.cmml">2</mn></msup><mo id="S2.T1.1.1.1.m1.1.1.1" xref="S2.T1.1.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.T1.1.1.1.m1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.m1.1b"><apply id="S2.T1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1"><times id="S2.T1.1.1.1.m1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1.1"></times><apply id="S2.T1.1.1.1.m1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.2.1.cmml" xref="S2.T1.1.1.1.m1.1.1.2">superscript</csymbol><ci id="S2.T1.1.1.1.m1.1.1.2.2.cmml" xref="S2.T1.1.1.1.m1.1.1.2.2">𝐿</ci><cn id="S2.T1.1.1.1.m1.1.1.2.3.cmml" type="integer" xref="S2.T1.1.1.1.m1.1.1.2.3">2</cn></apply><ci id="S2.T1.1.1.1.m1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.m1.1c">L^{2}N</annotation><annotation encoding="application/x-llamapun" id="S2.T1.1.1.1.m1.1d">italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_N</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.2.2.2"><math alttext="LN^{2}" class="ltx_Math" display="inline" id="S2.T1.2.2.2.m1.1"><semantics id="S2.T1.2.2.2.m1.1a"><mrow id="S2.T1.2.2.2.m1.1.1" xref="S2.T1.2.2.2.m1.1.1.cmml"><mi id="S2.T1.2.2.2.m1.1.1.2" xref="S2.T1.2.2.2.m1.1.1.2.cmml">L</mi><mo id="S2.T1.2.2.2.m1.1.1.1" xref="S2.T1.2.2.2.m1.1.1.1.cmml">⁢</mo><msup id="S2.T1.2.2.2.m1.1.1.3" xref="S2.T1.2.2.2.m1.1.1.3.cmml"><mi id="S2.T1.2.2.2.m1.1.1.3.2" xref="S2.T1.2.2.2.m1.1.1.3.2.cmml">N</mi><mn id="S2.T1.2.2.2.m1.1.1.3.3" xref="S2.T1.2.2.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.2.m1.1b"><apply id="S2.T1.2.2.2.m1.1.1.cmml" xref="S2.T1.2.2.2.m1.1.1"><times id="S2.T1.2.2.2.m1.1.1.1.cmml" xref="S2.T1.2.2.2.m1.1.1.1"></times><ci id="S2.T1.2.2.2.m1.1.1.2.cmml" xref="S2.T1.2.2.2.m1.1.1.2">𝐿</ci><apply id="S2.T1.2.2.2.m1.1.1.3.cmml" xref="S2.T1.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.2.2.2.m1.1.1.3.1.cmml" xref="S2.T1.2.2.2.m1.1.1.3">superscript</csymbol><ci id="S2.T1.2.2.2.m1.1.1.3.2.cmml" xref="S2.T1.2.2.2.m1.1.1.3.2">𝑁</ci><cn id="S2.T1.2.2.2.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.2.2.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.2.m1.1c">LN^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.2.2.2.m1.1d">italic_L italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.3.3.3"><math alttext="LN^{2}" class="ltx_Math" display="inline" id="S2.T1.3.3.3.m1.1"><semantics id="S2.T1.3.3.3.m1.1a"><mrow id="S2.T1.3.3.3.m1.1.1" xref="S2.T1.3.3.3.m1.1.1.cmml"><mi id="S2.T1.3.3.3.m1.1.1.2" xref="S2.T1.3.3.3.m1.1.1.2.cmml">L</mi><mo id="S2.T1.3.3.3.m1.1.1.1" xref="S2.T1.3.3.3.m1.1.1.1.cmml">⁢</mo><msup id="S2.T1.3.3.3.m1.1.1.3" xref="S2.T1.3.3.3.m1.1.1.3.cmml"><mi id="S2.T1.3.3.3.m1.1.1.3.2" xref="S2.T1.3.3.3.m1.1.1.3.2.cmml">N</mi><mn id="S2.T1.3.3.3.m1.1.1.3.3" xref="S2.T1.3.3.3.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.3.m1.1b"><apply id="S2.T1.3.3.3.m1.1.1.cmml" xref="S2.T1.3.3.3.m1.1.1"><times id="S2.T1.3.3.3.m1.1.1.1.cmml" xref="S2.T1.3.3.3.m1.1.1.1"></times><ci id="S2.T1.3.3.3.m1.1.1.2.cmml" xref="S2.T1.3.3.3.m1.1.1.2">𝐿</ci><apply id="S2.T1.3.3.3.m1.1.1.3.cmml" xref="S2.T1.3.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.3.3.3.m1.1.1.3.1.cmml" xref="S2.T1.3.3.3.m1.1.1.3">superscript</csymbol><ci id="S2.T1.3.3.3.m1.1.1.3.2.cmml" xref="S2.T1.3.3.3.m1.1.1.3.2">𝑁</ci><cn id="S2.T1.3.3.3.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.3.3.3.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.3.m1.1c">LN^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.3.3.3.m1.1d">italic_L italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S2.T1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S2.T1.6.6.4">Memory</th>
<td class="ltx_td ltx_align_center" id="S2.T1.4.4.1"><math alttext="L^{2}" class="ltx_Math" display="inline" id="S2.T1.4.4.1.m1.1"><semantics id="S2.T1.4.4.1.m1.1a"><msup id="S2.T1.4.4.1.m1.1.1" xref="S2.T1.4.4.1.m1.1.1.cmml"><mi id="S2.T1.4.4.1.m1.1.1.2" xref="S2.T1.4.4.1.m1.1.1.2.cmml">L</mi><mn id="S2.T1.4.4.1.m1.1.1.3" xref="S2.T1.4.4.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.1.m1.1b"><apply id="S2.T1.4.4.1.m1.1.1.cmml" xref="S2.T1.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.4.4.1.m1.1.1.1.cmml" xref="S2.T1.4.4.1.m1.1.1">superscript</csymbol><ci id="S2.T1.4.4.1.m1.1.1.2.cmml" xref="S2.T1.4.4.1.m1.1.1.2">𝐿</ci><cn id="S2.T1.4.4.1.m1.1.1.3.cmml" type="integer" xref="S2.T1.4.4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.1.m1.1c">L^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.4.4.1.m1.1d">italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.5.5.2"><math alttext="LN^{2}" class="ltx_Math" display="inline" id="S2.T1.5.5.2.m1.1"><semantics id="S2.T1.5.5.2.m1.1a"><mrow id="S2.T1.5.5.2.m1.1.1" xref="S2.T1.5.5.2.m1.1.1.cmml"><mi id="S2.T1.5.5.2.m1.1.1.2" xref="S2.T1.5.5.2.m1.1.1.2.cmml">L</mi><mo id="S2.T1.5.5.2.m1.1.1.1" xref="S2.T1.5.5.2.m1.1.1.1.cmml">⁢</mo><msup id="S2.T1.5.5.2.m1.1.1.3" xref="S2.T1.5.5.2.m1.1.1.3.cmml"><mi id="S2.T1.5.5.2.m1.1.1.3.2" xref="S2.T1.5.5.2.m1.1.1.3.2.cmml">N</mi><mn id="S2.T1.5.5.2.m1.1.1.3.3" xref="S2.T1.5.5.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.5.5.2.m1.1b"><apply id="S2.T1.5.5.2.m1.1.1.cmml" xref="S2.T1.5.5.2.m1.1.1"><times id="S2.T1.5.5.2.m1.1.1.1.cmml" xref="S2.T1.5.5.2.m1.1.1.1"></times><ci id="S2.T1.5.5.2.m1.1.1.2.cmml" xref="S2.T1.5.5.2.m1.1.1.2">𝐿</ci><apply id="S2.T1.5.5.2.m1.1.1.3.cmml" xref="S2.T1.5.5.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.T1.5.5.2.m1.1.1.3.1.cmml" xref="S2.T1.5.5.2.m1.1.1.3">superscript</csymbol><ci id="S2.T1.5.5.2.m1.1.1.3.2.cmml" xref="S2.T1.5.5.2.m1.1.1.3.2">𝑁</ci><cn id="S2.T1.5.5.2.m1.1.1.3.3.cmml" type="integer" xref="S2.T1.5.5.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.5.2.m1.1c">LN^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.5.5.2.m1.1d">italic_L italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S2.T1.6.6.3"><math alttext="LN" class="ltx_Math" display="inline" id="S2.T1.6.6.3.m1.1"><semantics id="S2.T1.6.6.3.m1.1a"><mrow id="S2.T1.6.6.3.m1.1.1" xref="S2.T1.6.6.3.m1.1.1.cmml"><mi id="S2.T1.6.6.3.m1.1.1.2" xref="S2.T1.6.6.3.m1.1.1.2.cmml">L</mi><mo id="S2.T1.6.6.3.m1.1.1.1" xref="S2.T1.6.6.3.m1.1.1.1.cmml">⁢</mo><mi id="S2.T1.6.6.3.m1.1.1.3" xref="S2.T1.6.6.3.m1.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.6.6.3.m1.1b"><apply id="S2.T1.6.6.3.m1.1.1.cmml" xref="S2.T1.6.6.3.m1.1.1"><times id="S2.T1.6.6.3.m1.1.1.1.cmml" xref="S2.T1.6.6.3.m1.1.1.1"></times><ci id="S2.T1.6.6.3.m1.1.1.2.cmml" xref="S2.T1.6.6.3.m1.1.1.2">𝐿</ci><ci id="S2.T1.6.6.3.m1.1.1.3.cmml" xref="S2.T1.6.6.3.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.6.3.m1.1c">LN</annotation><annotation encoding="application/x-llamapun" id="S2.T1.6.6.3.m1.1d">italic_L italic_N</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S2.T1.6.9.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S2.T1.6.9.3.1">M.M.</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.6.9.3.2">✓</td>
<td class="ltx_td ltx_border_bb" id="S2.T1.6.9.3.3"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.6.9.3.4">✓</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Experiment</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span><span class="ltx_text ltx_font_bold" id="S3.SS1.1.1">Experimental Settings</span>
</h3>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Basic statistics of benchmark datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.2.1">ML-1M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.3.1">Beauty</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.4.1">Games</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.5.1">KuaiRand</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T2.1.2.1.1">#Users</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.2.1.2">6,040</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.2.1.3">22,363</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.2.1.4">24,303</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.2.1.5">23,951</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.1.3.2.1">#Items</th>
<td class="ltx_td ltx_align_right" id="S3.T2.1.3.2.2">3,416</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.3.2.3">12,101</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.3.2.4">10,673</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.3.2.5">7,111</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.1.4.3.1">#Interactions</th>
<td class="ltx_td ltx_align_right" id="S3.T2.1.4.3.2">999,611</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.4.3.3">198,502</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.4.3.4">231,780</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.4.3.5">1,134,420</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.1.5.4.1">Avg.Length</th>
<td class="ltx_td ltx_align_right" id="S3.T2.1.5.4.2">165.5</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.5.4.3">8.9</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.5.4.4">9.5</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.5.4.5">47.4</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.1.6.5.1">Max.Length</th>
<td class="ltx_td ltx_align_right" id="S3.T2.1.6.5.2">2,314</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.6.5.3">389</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.6.5.4">880</td>
<td class="ltx_td ltx_align_right" id="S3.T2.1.6.5.5">809</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T2.1.7.6.1">Sparsity</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T2.1.7.6.2">95.15%</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T2.1.7.6.3">99.92%</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T2.1.7.6.4">99.91%</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T2.1.7.6.5">99.33%</td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1. </span><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.1.1">Datasets</span>
</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.1">To showcase the efficiency and effectiveness of our proposed approach, we perform extensive experiments across four benchmark datasets: Amazon-Beauty (referred to as <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.p1.1.1">Beauty</span>), Amazon-Video-Games (referred to as <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.p1.1.2">Games</span>), <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.p1.1.3">LastFM</span>, and MovieLens 1M (abbreviated as <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.p1.1.4">ML1M</span>).
The initial two datasets, sourced from the Amazon e-commerce platform<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://nijianmo.github.io/amazon/" title="">https://nijianmo.github.io/amazon/</a></span></span></span>, encapsulate a wide array of user engagements with Beauty and Video Games products.
Moreover, the ML1M<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://grouplens.org/datasets/movielens/1m/" title="">https://grouplens.org/datasets/movielens/1m/</a></span></span></span> dataset comprises a compilation of movie ratings provided by users on the MovieLens platform.
Finally, the KuaiRand dataset<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://kuairand.com/" title="">https://kuairand.com/</a></span></span></span>, retrieved from the recommendation logs of the video-sharing mobile application Kuaishou, includes millions of interactions involving randomly exposed items.
The statistics for these four datasets are outlined in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.T2" title="Table 2 ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.
We follow the leave-one-out policy <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib22" title="">2018</a>)</cite> for training-validation-testing partition.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2. </span><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS2.1.1">Baselines</span>
</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">To demonstrate the superiority of the proposed method, four representative sequential recommendation methods and a recently developed Mamba-based method are used as baselines,
namely <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS2.p1.1.1">Caser</span> <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib37" title="">2018</a>)</cite>: a typical convolution-based sequential recommender;
<span class="ltx_text ltx_font_bold" id="S3.SS1.SSS2.p1.1.2">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib19" title="">2015</a>)</cite>: a RNN-based method constructed by Gated Recurrent Units;
<span class="ltx_text ltx_font_bold" id="S3.SS1.SSS2.p1.1.3">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib36" title="">2019</a>)</cite>: a sequential recommender system based on bidirectional Transformers trained using the BERT-style cloze task;
<span class="ltx_text ltx_font_bold" id="S3.SS1.SSS2.p1.1.4">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib22" title="">2018</a>)</cite>: a representative approach for sequential recommendation leveraging self-attention mechanisms;
and <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS2.p1.1.5">Mamba4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Liu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib26" title="">2024</a>)</cite>: a pioneering model constructed by SSMs.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3. </span><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS3.1.1">Evaluation Metrics</span>
</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.7">To assess the recommendation results’ quality, we employ three commonly utilized evaluation metrics: the top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.1.m1.1"><semantics id="S3.SS1.SSS3.p1.1.m1.1a"><mi id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.1b"><ci id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.1.m1.1d">italic_K</annotation></semantics></math> Hit Ratio (HR@<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.2.m2.1"><semantics id="S3.SS1.SSS3.p1.2.m2.1a"><mi id="S3.SS1.SSS3.p1.2.m2.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m2.1b"><ci id="S3.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.2.m2.1d">italic_K</annotation></semantics></math>), top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.3.m3.1"><semantics id="S3.SS1.SSS3.p1.3.m3.1a"><mi id="S3.SS1.SSS3.p1.3.m3.1.1" xref="S3.SS1.SSS3.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.3.m3.1b"><ci id="S3.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.3.m3.1d">italic_K</annotation></semantics></math> Normalized Discounted Cumulative Gain (NDCG@<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.4.m4.1"><semantics id="S3.SS1.SSS3.p1.4.m4.1a"><mi id="S3.SS1.SSS3.p1.4.m4.1.1" xref="S3.SS1.SSS3.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.4.m4.1b"><ci id="S3.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.4.m4.1d">italic_K</annotation></semantics></math>), and top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.5.m5.1"><semantics id="S3.SS1.SSS3.p1.5.m5.1a"><mi id="S3.SS1.SSS3.p1.5.m5.1.1" xref="S3.SS1.SSS3.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.5.m5.1b"><ci id="S3.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.5.m5.1d">italic_K</annotation></semantics></math> Mean Reciprocal Rank (MRR@<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.6.m6.1"><semantics id="S3.SS1.SSS3.p1.6.m6.1a"><mi id="S3.SS1.SSS3.p1.6.m6.1.1" xref="S3.SS1.SSS3.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.6.m6.1b"><ci id="S3.SS1.SSS3.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS3.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.6.m6.1d">italic_K</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_citep">(Fan
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib11" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib9" title="">2022</a>)</cite>.
Higher scores signify superior recommendation performance.
The average metrics for all users in the test set are provided in the performance comparison.
Furthermore, we specify the values of <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.7.m7.1"><semantics id="S3.SS1.SSS3.p1.7.m7.1a"><mi id="S3.SS1.SSS3.p1.7.m7.1.1" xref="S3.SS1.SSS3.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.7.m7.1b"><ci id="S3.SS1.SSS3.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS3.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.7.m7.1d">italic_K</annotation></semantics></math> as 10 and 20, with 10 serving as the default for ablation experiments.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4. </span><span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.1.1">Hyper-parameter Settings</span>
</h4>
<div class="ltx_para" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.1">Our evaluation is implemented based on PyTorch <span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://pytorch.org/" title="">https://pytorch.org/</a></span></span></span> and RecBole <span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/RUCAIBox/RecBole" title="">https://github.com/RUCAIBox/RecBole</a></span></span></span>.
First, to initialize the proposed Mamba-based block, we designate the model dimension as 256 and the SSM state expansion factor as 64.
Second, the weighted indicator for backward SSD computation <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p1.1.m1.1"><semantics id="S3.SS1.SSS4.p1.1.m1.1a"><mi id="S3.SS1.SSS4.p1.1.m1.1.1" xref="S3.SS1.SSS4.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p1.1.m1.1b"><ci id="S3.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p1.1.m1.1d">italic_β</annotation></semantics></math> is searched from 0.1 to 0.9 in 0.2 increments.
Moreover, the search space for the learning rate includes values of {0.0001, 0.001, 0.01, 0.1}, while for the batch size, we consider {64, 256, 512, 1024, 2048}.
Fourth, the number of Bi-SSD cells is searched from 1 to 3.
To accommodate the baselines, we set fixed sequence lengths of 200 for ML1M and 50 for other datasets.
Furthermore, for a fair comparison, we ensure consistency in the key hyperparameters across models while setting the other default hyperparameters for baseline methods as suggested in their respective papers.
Finally, we employ the Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib23" title="">2014</a>)</cite> optimizer in a mini-batch manner.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span><span class="ltx_text ltx_font_bold" id="S3.SS2.1.1">Recommendation Performance Comparison</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We first compare the recommendation performance between the proposed model and all baselines over the four benchmark datasets.
Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.T3" title="Table 3 ‣ 3.2. Recommendation Performance Comparison ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.T4" title="Table 4 ‣ 3.2. Recommendation Performance Comparison ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> showcase the overall evaluation results.
From the two tables, we can make the following observations.</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">Our proposed SSD4Rec consistently outperforms all the baselines across all datasets regarding NDCG@10&amp;20 and MRR@10&amp;20.
On average, SSD4Rec significantly exceeds the strongest baselines by 6.17% on NDCG@10 and 7.73% on MRR@10 in the KuaiRand dataset.
Such improvement demonstrates the effectiveness of our proposed method and the great potential of exploring the Structured State Space Duality property in sequential recommendations.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">While inferior to the proposed model, Mamba4Rec, in most cases, outperforms the conventional deep learning methods, namely the CNN-based model Caser, RNN-based model GRU4Rec, and Attention-based models BERT4Rec and SASRec.
This highlights the efficacy of Mamba in capturing user behavior dynamics for recommendation purposes.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">Additionally, it is evident that the benefits of the mamba-based models diminish in the datasets characterized by shorter average sequences, i.e., Beauty and Games.
Conversely, their performance excels in datasets like ML1M and KuaiRand, where the average sequence lengths extend to 165.5 and 47.4, respectively.
This disparity in performance can be attributed to Mamba’s exceptional capacity to capture long-range dependencies.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Sequential recommendation performance on the ML1M and Beauty datasets, where NG@K refs to NDCG@K, and the best and second-best results are bold and underlined, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T3.1" style="width:559.5pt;height:125.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-41.8pt,9.4pt) scale(0.87,0.87) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T3.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T3.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T3.1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6" id="S3.T3.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.1.2.1">ML1M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6" id="S3.T3.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.1.3.1">Beauty</span></th>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.1.1">NG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.2.1">NG@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.3.1">MRR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.4.1">MRR@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.5"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.5.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T3.1.1.2.2.6"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.6.1">HR@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.7"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.7.1">NG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.8"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.8.1">NG@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.9"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.9.1">MRR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.10"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.10.1">MRR@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.11"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.11.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T3.1.1.2.2.12"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.2.2.12.1">HR@20</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.1.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.1.3.1.1">Caser</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.2">0.1714</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.3">0.1948</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.4">0.1354</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.5">0.1418</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.6">0.2892</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T3.1.1.3.1.7">0.382</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.8">0.0294</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.9">0.0355</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.10">0.0222</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.11">0.0239</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.12">0.0531</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.3.1.13">0.0774</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.4.2.1">GRU4Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.2">0.1655</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.3">0.1906</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.4">0.1276</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.5">0.1344</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.6">0.2901</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.4.2.7">0.3897</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.8">0.0307</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.9">0.0386</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.10">0.0221</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.11">0.0242</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.12">0.0593</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4.2.13">0.0907</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.5.3.1">BERT4Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.2">0.1846</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.3">0.2082</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.4">0.1441</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.5">0.1506</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.5.3.6.1">0.3171</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.5.3.7">0.4103</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.8">0.0219</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.9">0.0279</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.10">0.0159</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.11">0.0175</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.12">0.0419</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5.3.13">0.0656</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.6.4.1">SASRec</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.2">0.1718</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.3">0.1963</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.4">0.1320</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.5">0.1386</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.6">0.3023</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.6.4.7">0.4000</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.8">0.0395</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.9">0.0480</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.10">0.0261</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.11">0.0284</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.12"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.6.4.12.1">0.0829</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.6.4.13"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.6.4.13.1">0.1168</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.1.7.5.1">Mamba4Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.2.1">0.1847</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.3.1">0.2094</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.4.1">0.1456</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.5.1">0.1523</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.6">0.3124</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T3.1.1.7.5.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.7.1">0.4103</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.8.1">0.0442</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.9.1">0.0501</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.10.1">0.0361</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.7.5.11.1">0.0376</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.12">0.0709</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.7.5.13">0.0942</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T3.1.1.8.6.1">SSD4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.2.1">0.1889</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.3"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.3.1">0.2145</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.4"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.4.1">0.1495</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.5"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.5.1">0.1565</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.8.6.6.1">0.3152</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T3.1.1.8.6.7"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.7.1">0.4194</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.8"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.8.1">0.0452</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.9"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.9.1">0.0520</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.10"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.10.1">0.0363</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.11"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.8.6.11.1">0.0382</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.8.6.12.1">0.0745</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.1.1.8.6.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.1.1.8.6.13.1">0.1015</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Sequential recommendation performance on the Games and KuaiRand datasets, where NG@K refs to NDCG@K, and the best and second-best results are bold and underlined, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T4.1" style="width:559.5pt;height:125.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-41.8pt,9.4pt) scale(0.87,0.87) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T4.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T4.1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6" id="S3.T4.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.1.1.2.1">Games</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6" id="S3.T4.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.1.1.3.1">KuaiRand</span></th>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.1.1">NG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.2.1">NG@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.3.1">MRR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.4.1">MRR@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.5"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.5.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T4.1.1.2.2.6"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.6.1">HR@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.7"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.7.1">NG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.8"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.8.1">NG@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.9"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.9.1">MRR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.10"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.10.1">MRR@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.11"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.11.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T4.1.1.2.2.12"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.2.2.12.1">HR@20</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.1.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T4.1.1.3.1.1">Caser</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.2">0.0460</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.3">0.0587</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.4">0.0330</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.5">0.0364</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.6">0.0891</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.1.1.3.1.7">0.1396</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.8">0.0545</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.9">0.0692</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.10">0.0414</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.11">0.0453</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.12">0.0982</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.3.1.13">0.1571</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.1.4.2.1">GRU4Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.2">0.0520</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.3">0.0654</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.4">0.0373</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.5">0.0409</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.6">0.1011</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.1.4.2.7">0.1543</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.8">0.0563</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.9">0.0722</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.10">0.0426</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.11">0.0470</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.12">0.1017</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.4.2.13">0.1653</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.1.5.3.1">BERT4Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.2">0.0372</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.3">0.0482</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.4">0.0263</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.5">0.0293</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.6">0.0735</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.1.5.3.7">0.1170</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.8">0.0534</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.9">0.0683</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.10">0.0404</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.11">0.0444</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.12">0.0968</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.5.3.13">0.1563</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.1.6.4.1">SASRec</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.2">0.0531</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.3">0.0689</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.4">0.0330</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.5">0.0373</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.6.4.6.1">0.1189</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.1.6.4.7"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.6.4.7.1">0.1817</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.6.4.8.1">0.0567</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.6.4.9.1">0.0733</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.10">0.0426</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.6.4.11.1">0.0471</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.6.4.12.1">0.1040</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.6.4.13"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.6.4.13.1">0.1705</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T4.1.1.7.5.1">Mamba4Rec</th>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.7.5.2.1">0.0605</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.7.5.3.1">0.0738</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.7.5.4.1">0.0461</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.7.5.5.1">0.0497</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.6">0.1081</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.1.1.7.5.7">0.1610</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.8">0.0558</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.9">0.0710</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.7.5.10.1">0.0427</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.11">0.0468</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.12">0.0994</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.1.7.5.13">0.1601</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.1.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T4.1.1.8.6.1">SSD4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.2"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.2.1">0.0610</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.3"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.3.1">0.0740</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.4"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.4.1">0.0461</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.5"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.5.1">0.0497</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.8.6.6.1">0.1102</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T4.1.1.8.6.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.8.6.7.1">0.1617</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.8"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.8.1">0.0602</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.9"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.9.1">0.0759</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.10"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.10.1">0.0460</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.11"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.11.1">0.0503</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.12"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.8.6.12.1">0.1076</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.1.8.6.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.1.1.8.6.13.1">0.1704</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5. </span>Comparison of the computational efficiency on the ML1M dataset, which involves measuring the training time per epoch and the inference time for all test users in seconds (s).</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T5.1" style="width:545.0pt;height:140.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-40.7pt,10.5pt) scale(0.87,0.87) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T5.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.1.1">L=200</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.2.1">N</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.3.1">SASRec*</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.4.1">Mamba4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.5.1">SSD4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T5.1.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.6.1">Imp.*</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.1.1.1.1.7"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.7.1">N=256</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.1.1.1.1.8"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.8.1">L</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1.9"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.9.1">SASRec*</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1.10"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.10.1">Mamba4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1.11"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.11.1">SSD4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1.12"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1.12.1">Imp.*</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.1.1.2.1.1" rowspan="4"><span class="ltx_text" id="S3.T5.1.1.2.1.1.1">Training (s)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.1.1.2.1.2">32</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.1.3">106.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.1.4">44.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.1.5">22.90</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T5.1.1.2.1.6">363.67%</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.1.1.2.1.7" rowspan="4"><span class="ltx_text" id="S3.T5.1.1.2.1.7.1">Training (s)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.1.1.2.1.8">50</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.1.9">42.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.1.10">119.87</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.1.11">29.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.2.1.12">45.69%</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.3.2.1">64</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.2.2">112.43</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.2.3">82.16</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.2.4">24.69</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.3.2.5">355.37%</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.3.2.6">100</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.2.7">69.50</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.2.8">173.78</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.2.9">47.73</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.3.2.10">45.61%</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.4.3.1">128</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.4.3.2">125.24</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.4.3.3">156.45</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.4.3.4">35.86</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.4.3.5">249.25%</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.4.3.6">200</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.4.3.7">161.91</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.4.3.8">326.87</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.4.3.9">74.13</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.4.3.10">118.41%</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.5.4.1">256</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.4.2">161.91</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.4.3">326.87</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.4.4">74.13</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.5.4.5">118.41%</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.5.4.6">400</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.4.7">450.64</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.4.8">687.46</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.4.9">101.51</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.5.4.10">343.94%</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S3.T5.1.1.6.5.1" rowspan="4"><span class="ltx_text" id="S3.T5.1.1.6.5.1.1">Inference (s)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.1.1.6.5.2">32</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.6.5.3">0.158</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.6.5.4">0.061</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.6.5.5">0.039</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T5.1.1.6.5.6">305.13%</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S3.T5.1.1.6.5.7" rowspan="4"><span class="ltx_text" id="S3.T5.1.1.6.5.7.1">Inference (s)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.1.1.6.5.8">50</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.6.5.9">0.057</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.6.5.10">0.217</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.6.5.11">0.057</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.1.6.5.12">0.00%</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.7.6.1">64</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.7.6.2">0.178</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.7.6.3">0.114</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.7.6.4">0.046</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.7.6.5">286.96%</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.7.6.6">100</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.7.6.7">0.111</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.7.6.8">0.272</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.7.6.9">0.089</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.7.6.10">24.72%</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.8.7.1">128</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.8.7.2">0.199</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.8.7.3">0.218</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.8.7.4">0.062</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.1.1.8.7.5">220.97%</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.1.1.8.7.6">200</th>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.8.7.7">0.27</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.8.7.8">0.484</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.8.7.9">0.129</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.1.8.7.10">109.30%</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T5.1.1.9.8.1">256</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.9.8.2">0.27</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.9.8.3">0.484</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.9.8.4">0.129</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T5.1.1.9.8.5">109.30%</td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T5.1.1.9.8.6">400</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.9.8.7">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.9.8.8">1.152</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.9.8.9">0.167</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.1.9.8.10">349.10%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Efficiency Analysis</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.8">In this subsection, we analyze the training and inference efficiency of SSD4Rec compared with two representative sequential recommendation methods, i.e., SASRec and Mamba4Rec.
The evaluation results on the ML1M dataset are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.T5" title="Table 5 ‣ 3.2. Recommendation Performance Comparison ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>.
We can see that the two Mamba-based models, i.e., Mamba4Rec and SSD4Rec are much more efficient compared to the Attention-based SASRec model when <math alttext="N&lt;L=200" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">N</mi><mo id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">&lt;</mo><mi id="S3.SS3.p1.1.m1.1.1.4" xref="S3.SS3.p1.1.m1.1.1.4.cmml">L</mi><mo id="S3.SS3.p1.1.m1.1.1.5" xref="S3.SS3.p1.1.m1.1.1.5.cmml">=</mo><mn id="S3.SS3.p1.1.m1.1.1.6" xref="S3.SS3.p1.1.m1.1.1.6.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><and id="S3.SS3.p1.1.m1.1.1a.cmml" xref="S3.SS3.p1.1.m1.1.1"></and><apply id="S3.SS3.p1.1.m1.1.1b.cmml" xref="S3.SS3.p1.1.m1.1.1"><lt id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"></lt><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑁</ci><ci id="S3.SS3.p1.1.m1.1.1.4.cmml" xref="S3.SS3.p1.1.m1.1.1.4">𝐿</ci></apply><apply id="S3.SS3.p1.1.m1.1.1c.cmml" xref="S3.SS3.p1.1.m1.1.1"><eq id="S3.SS3.p1.1.m1.1.1.5.cmml" xref="S3.SS3.p1.1.m1.1.1.5"></eq><share href="https://arxiv.org/html/2409.01192v1#S3.SS3.p1.1.m1.1.1.4.cmml" id="S3.SS3.p1.1.m1.1.1d.cmml" xref="S3.SS3.p1.1.m1.1.1"></share><cn id="S3.SS3.p1.1.m1.1.1.6.cmml" type="integer" xref="S3.SS3.p1.1.m1.1.1.6">200</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">N&lt;L=200</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_N &lt; italic_L = 200</annotation></semantics></math>, which in line with the discussion in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S2.SS6" title="2.6. Time Complexity Analysis ‣ 2. The Proposed Method ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.6</span></a>, i.e., Mamba enjoys linear scaling in sequence length.
When presented with inputs of substantial dimensions, such as <math alttext="N=256" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">N</mi><mo id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><eq id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1"></eq><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑁</ci><cn id="S3.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">N=256</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_N = 256</annotation></semantics></math>, Mamba4Rec exhibits lower efficiency compared to SASRec, even when <math alttext="L=400&gt;N" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">L</mi><mo id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">=</mo><mn id="S3.SS3.p1.3.m3.1.1.4" xref="S3.SS3.p1.3.m3.1.1.4.cmml">400</mn><mo id="S3.SS3.p1.3.m3.1.1.5" xref="S3.SS3.p1.3.m3.1.1.5.cmml">&gt;</mo><mi id="S3.SS3.p1.3.m3.1.1.6" xref="S3.SS3.p1.3.m3.1.1.6.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><and id="S3.SS3.p1.3.m3.1.1a.cmml" xref="S3.SS3.p1.3.m3.1.1"></and><apply id="S3.SS3.p1.3.m3.1.1b.cmml" xref="S3.SS3.p1.3.m3.1.1"><eq id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"></eq><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝐿</ci><cn id="S3.SS3.p1.3.m3.1.1.4.cmml" type="integer" xref="S3.SS3.p1.3.m3.1.1.4">400</cn></apply><apply id="S3.SS3.p1.3.m3.1.1c.cmml" xref="S3.SS3.p1.3.m3.1.1"><gt id="S3.SS3.p1.3.m3.1.1.5.cmml" xref="S3.SS3.p1.3.m3.1.1.5"></gt><share href="https://arxiv.org/html/2409.01192v1#S3.SS3.p1.3.m3.1.1.4.cmml" id="S3.SS3.p1.3.m3.1.1d.cmml" xref="S3.SS3.p1.3.m3.1.1"></share><ci id="S3.SS3.p1.3.m3.1.1.6.cmml" xref="S3.SS3.p1.3.m3.1.1.6">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">L=400&gt;N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_L = 400 &gt; italic_N</annotation></semantics></math>, showcasing the constraints of Mamba-1 in managing high-dimensional inputs <cite class="ltx_cite ltx_citemacro_citep">(Dao and Gu, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib5" title="">2024</a>)</cite>.
In contract, SSD4Rec achieves superior computational efficiency to SASRec and Mamba4Rec in all the cases.
This superior performance can be attributed to the utilization of the novel SSD layer and the advancing hardware-aware computation algorithm (i.e., the block-based matrix multiplication).
To be specific, when given a lengthy interaction list, i.e., <math alttext="N=32" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">N</mi><mo id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><eq id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1"></eq><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑁</ci><cn id="S3.SS3.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS3.p1.4.m4.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">N=32</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_N = 32</annotation></semantics></math> and <math alttext="L=200" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">L</mi><mo id="S3.SS3.p1.5.m5.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><eq id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1"></eq><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝐿</ci><cn id="S3.SS3.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">L=200</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_L = 200</annotation></semantics></math>, the proposed model is 3.6<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mo id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><times id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">×</annotation></semantics></math> and 3<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1"><semantics id="S3.SS3.p1.7.m7.1a"><mo id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><times id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.1d">×</annotation></semantics></math> faster than the Attention-based method SASRec in the training and inference phases, respectively.
This substantial acceleration underscores a notable enhancement in computational efficiency.
Moreover, even when configured with high-dimensional input sequences, i.e., <math alttext="N=256&gt;L=200" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1"><semantics id="S3.SS3.p1.8.m8.1a"><mrow id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml">N</mi><mo id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">=</mo><mn id="S3.SS3.p1.8.m8.1.1.4" xref="S3.SS3.p1.8.m8.1.1.4.cmml">256</mn><mo id="S3.SS3.p1.8.m8.1.1.5" xref="S3.SS3.p1.8.m8.1.1.5.cmml">&gt;</mo><mi id="S3.SS3.p1.8.m8.1.1.6" xref="S3.SS3.p1.8.m8.1.1.6.cmml">L</mi><mo id="S3.SS3.p1.8.m8.1.1.7" xref="S3.SS3.p1.8.m8.1.1.7.cmml">=</mo><mn id="S3.SS3.p1.8.m8.1.1.8" xref="S3.SS3.p1.8.m8.1.1.8.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><and id="S3.SS3.p1.8.m8.1.1a.cmml" xref="S3.SS3.p1.8.m8.1.1"></and><apply id="S3.SS3.p1.8.m8.1.1b.cmml" xref="S3.SS3.p1.8.m8.1.1"><eq id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3"></eq><ci id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2">𝑁</ci><cn id="S3.SS3.p1.8.m8.1.1.4.cmml" type="integer" xref="S3.SS3.p1.8.m8.1.1.4">256</cn></apply><apply id="S3.SS3.p1.8.m8.1.1c.cmml" xref="S3.SS3.p1.8.m8.1.1"><gt id="S3.SS3.p1.8.m8.1.1.5.cmml" xref="S3.SS3.p1.8.m8.1.1.5"></gt><share href="https://arxiv.org/html/2409.01192v1#S3.SS3.p1.8.m8.1.1.4.cmml" id="S3.SS3.p1.8.m8.1.1d.cmml" xref="S3.SS3.p1.8.m8.1.1"></share><ci id="S3.SS3.p1.8.m8.1.1.6.cmml" xref="S3.SS3.p1.8.m8.1.1.6">𝐿</ci></apply><apply id="S3.SS3.p1.8.m8.1.1e.cmml" xref="S3.SS3.p1.8.m8.1.1"><eq id="S3.SS3.p1.8.m8.1.1.7.cmml" xref="S3.SS3.p1.8.m8.1.1.7"></eq><share href="https://arxiv.org/html/2409.01192v1#S3.SS3.p1.8.m8.1.1.6.cmml" id="S3.SS3.p1.8.m8.1.1f.cmml" xref="S3.SS3.p1.8.m8.1.1"></share><cn id="S3.SS3.p1.8.m8.1.1.8.cmml" type="integer" xref="S3.SS3.p1.8.m8.1.1.8">200</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">N=256&gt;L=200</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">italic_N = 256 &gt; italic_L = 200</annotation></semantics></math>, our model experiences a speedup of exceeding 100% in comparison to SASRec for both the training and inference tasks, underscoring the significance of the hardware-aware computation algorithm employed by SSD.</p>
</div>
<figure class="ltx_table" id="S3.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6. </span>Ablation studies conducted by eliminating the effects of each key component, where NG@10 refs to NDCG@10.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T6.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S3.T6.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.1.1.1">Component</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T6.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.1.2.1">ML1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T6.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T6.1.1.1.3.1">KuaiRand</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.2.2">
<td class="ltx_td ltx_align_center" id="S3.T6.1.2.2.1">NG@10</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.2.2.2">MRR@10</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.2.2.3">NG@10</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.2.2.4">MRR@10</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T6.1.3.3.1">Full</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.3.3.2">0.1889</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.3.3.3">0.1495</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.3.3.4">0.0602</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.3.3.5">0.0460</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.1.4.4.1">w/o Bidirection</th>
<td class="ltx_td ltx_align_center" id="S3.T6.1.4.4.2">0.1869</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.4.4.3">0.1474</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.4.4.4">0.0593</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.4.4.5">0.0454</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.1.5.5.1">w/o Register</th>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.5.2">0.1871</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.5.3">0.1466</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.5.4">0.0545</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.5.5.5">0.0421</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.1.6.6.1">w/o Varlen</th>
<td class="ltx_td ltx_align_center" id="S3.T6.1.6.6.2">0.1852</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.6.6.3">0.1456</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.6.6.4">0.0565</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.6.6.5">0.0434</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T6.1.7.7.1">w PE</th>
<td class="ltx_td ltx_align_center" id="S3.T6.1.7.7.2">0.1736</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.7.7.3">0.1353</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.7.7.4">0.0566</td>
<td class="ltx_td ltx_align_center" id="S3.T6.1.7.7.5">0.0431</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T6.1.8.8.1">1 Layer</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.8.8.2">0.1872</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.8.8.3">0.1483</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.8.8.4">0.0579</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.1.8.8.5">0.0441</td>
</tr>
<tr class="ltx_tr" id="S3.T6.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T6.1.9.9.1">3 Layers</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.1.9.9.2">0.1933</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.1.9.9.3">0.1529</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.1.9.9.4">0.0597</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.1.9.9.5">0.0455</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Ablation Study</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In order to assess the effectiveness of the proposed key components,
we conducted ablation experiments on the ML1M and KuaiRand datasets, where the influence of each component was eliminated separately as follows:</p>
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1">w/o Bidirection: Deactivate the backward SSD layers to eliminate backward information of user interactions.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1">w/o Register: Remove the user-aware segment registers from the model input. By doing so, the model will consider the integrated sequence containing diverse interactions from different users as a successive item list.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i3.p1">
<p class="ltx_p" id="S3.I2.i3.p1.1">w/o Varlen: Deploy a fixed window on the model input through padding and truncation. In contrast to the proposed variable-length input, there is a tendency to lose information from the long-tail user interaction histories.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i4.p1">
<p class="ltx_p" id="S3.I2.i4.p1.1">w PE: Incorporate learnable position embeddings into the item embedding sequences.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">From the ablation results in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.T6" title="Table 6 ‣ 3.3. Efficiency Analysis ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, we can see that each component in our approach contributes to the overall performance since eliminating any of them would result in performance degradation.
Moreover, the results demonstrate that the integration of learnable positional embeddings does not improve the performance, due to the recurrent nature of the Mamba block.
Finally, stacking Mamba layers yields performance improvements on the ML1M dataset with larger, long-sequence user interactions, but it would lead to a linear increase in the model size.
Considering the increased complexity resulting from the stacked layers, we have designated the 2-layer SSD4Rec as our default model for performance evaluations.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Hyper-parameter Analysis</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.2">In SSD4Rec, we introduce two critical hyper-parameters, namely the weighted indicator of backward processing <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><mi id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">italic_β</annotation></semantics></math> and the max length of item sequences <math alttext="L" class="ltx_Math" display="inline" id="S3.SS5.p1.2.m2.1"><semantics id="S3.SS5.p1.2.m2.1a"><mi id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><ci id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">italic_L</annotation></semantics></math>.
Their value sensitivities are evaluated in this section to facilitate the future application of our proposed model.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.1. </span><span class="ltx_text ltx_font_bold" id="S3.SS5.SSS1.1.1">Effect of Backward Indicator <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS5.SSS1.1.1.m1.1"><semantics id="S3.SS5.SSS1.1.1.m1.1b"><mi id="S3.SS5.SSS1.1.1.m1.1.1" xref="S3.SS5.SSS1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.1.1.m1.1c"><ci id="S3.SS5.SSS1.1.1.m1.1.1.cmml" xref="S3.SS5.SSS1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.1.1.m1.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.1.1.m1.1e">italic_β</annotation></semantics></math></span>
</h4>
<div class="ltx_para" id="S3.SS5.SSS1.p1">
<p class="ltx_p" id="S3.SS5.SSS1.p1.2">This hyper-parameter determines the degree to which backward information can propagate through the SSD layer.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.F4" title="Figure 4 ‣ 3.5.1. Effect of Backward Indicator 𝛽 ‣ 3.5. Hyper-parameter Analysis ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> shows the corresponding performance change of SSD4Rec on NDCG@10.
We can find that introducing a small ratio of backward knowledge brings performance improvements.
In most cases, the recommendation performance of our proposed method
improves when <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.1.m1.1"><semantics id="S3.SS5.SSS1.p1.1.m1.1a"><mi id="S3.SS5.SSS1.p1.1.m1.1.1" xref="S3.SS5.SSS1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.1.m1.1b"><ci id="S3.SS5.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS5.SSS1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.1.m1.1d">italic_β</annotation></semantics></math> ¡ 0.3.
The experimental results also reveal that the recommendation performance degrades when the masking ratio <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS5.SSS1.p1.2.m2.1"><semantics id="S3.SS5.SSS1.p1.2.m2.1a"><mi id="S3.SS5.SSS1.p1.2.m2.1.1" xref="S3.SS5.SSS1.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS1.p1.2.m2.1b"><ci id="S3.SS5.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS5.SSS1.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS1.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS1.p1.2.m2.1d">italic_β</annotation></semantics></math> ¿= 0.5, suggesting excessive backward information should be avoided.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F3.sf1.g1" src="x3.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S3.F3.sf1.3.2" style="font-size:80%;">ML1M - NDCG@10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F3.sf2.g1" src="x4.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S3.F3.sf2.3.2" style="font-size:80%;">Beauty - NDCG@10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F3.sf3.g1" src="x5.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.sf3.2.1.1" style="font-size:80%;">(c)</span> </span><span class="ltx_text" id="S3.F3.sf3.3.2" style="font-size:80%;">Games - NDCG@10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F3.sf4.g1" src="x6.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.sf4.2.1.1" style="font-size:80%;">(d)</span> </span><span class="ltx_text" id="S3.F3.sf4.3.2" style="font-size:80%;">KuaiRand - NDCG@10</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>The effect of backward weighted indicator <math alttext="\beta" class="ltx_Math" display="inline" id="S3.F3.2.m1.1"><semantics id="S3.F3.2.m1.1b"><mi id="S3.F3.2.m1.1.1" xref="S3.F3.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.F3.2.m1.1c"><ci id="S3.F3.2.m1.1.1.cmml" xref="S3.F3.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.m1.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.F3.2.m1.1e">italic_β</annotation></semantics></math> under NDCG@10.</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf1.g1" src="x7.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S3.F4.sf1.3.2" style="font-size:80%;">ML1M - NDCG@10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf2.g1" src="x8.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S3.F4.sf2.3.2" style="font-size:80%;">ML1M - MRR@10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf3.g1" src="x9.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf3.2.1.1" style="font-size:80%;">(c)</span> </span><span class="ltx_text" id="S3.F4.sf3.3.2" style="font-size:80%;">KuaiRand - NDCG@10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="149" id="S3.F4.sf4.g1" src="x10.png" width="199"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf4.2.1.1" style="font-size:80%;">(d)</span> </span><span class="ltx_text" id="S3.F4.sf4.3.2" style="font-size:80%;">KuaiRand - MRR@10</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>The effect of max sequence length <math alttext="L" class="ltx_Math" display="inline" id="S3.F4.2.m1.1"><semantics id="S3.F4.2.m1.1b"><mi id="S3.F4.2.m1.1.1" xref="S3.F4.2.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.F4.2.m1.1c"><ci id="S3.F4.2.m1.1.1.cmml" xref="S3.F4.2.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.m1.1d">L</annotation><annotation encoding="application/x-llamapun" id="S3.F4.2.m1.1e">italic_L</annotation></semantics></math> on the ML1M and KuaiRand datasets.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.2. </span><span class="ltx_text ltx_font_bold" id="S3.SS5.SSS2.1.1">Effect of Max Sequence Length <math alttext="L" class="ltx_Math" display="inline" id="S3.SS5.SSS2.1.1.m1.1"><semantics id="S3.SS5.SSS2.1.1.m1.1b"><mi id="S3.SS5.SSS2.1.1.m1.1.1" xref="S3.SS5.SSS2.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.1.1.m1.1c"><ci id="S3.SS5.SSS2.1.1.m1.1.1.cmml" xref="S3.SS5.SSS2.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.1.1.m1.1d">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.1.1.m1.1e">italic_L</annotation></semantics></math></span>
</h4>
<div class="ltx_para" id="S3.SS5.SSS2.p1">
<p class="ltx_p" id="S3.SS5.SSS2.p1.1">To evaluate whether extending sequence lengths benefits our proposed method, we explore hyperparameter values <math alttext="L" class="ltx_Math" display="inline" id="S3.SS5.SSS2.p1.1.m1.1"><semantics id="S3.SS5.SSS2.p1.1.m1.1a"><mi id="S3.SS5.SSS2.p1.1.m1.1.1" xref="S3.SS5.SSS2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.p1.1.m1.1b"><ci id="S3.SS5.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS5.SSS2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.p1.1.m1.1d">italic_L</annotation></semantics></math> within the range of 25, 50, 100, 200 for SSD4Rec on the ML1M and KuaiRand datasets.
As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#S3.F4" title="Figure 4 ‣ 3.5.1. Effect of Backward Indicator 𝛽 ‣ 3.5. Hyper-parameter Analysis ‣ 3. Experiment ‣ SSD4Rec: A Structured State Space Duality Model for Efficient Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, our model demonstrates progressively improved performance for sequential recommendations on both datasets as the maximum sequence length increases.
Notably, by leveraging all user interaction histories and extracting valuable information through the sophisticated selection mechanism introduced by Mamba, our approach excels in scenarios with variable-length inputs.
These results underscore the exceptional performance of SSD4Rec in long-tail sequential recommendation tasks.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Related Work</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Sequential Recommendation</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In general, existing sequential recommendation studies can be divided into two categories <cite class="ltx_cite ltx_citemacro_citep">(Fang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib13" title="">2020</a>)</cite>:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">1) <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Traditional methods</span> employ conventional data mining techniques to obtain the users’ preferences from their historical interactions <cite class="ltx_cite ltx_citemacro_citep">(Davidson
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib6" title="">2010</a>; He
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib17" title="">2017</a>; Twardowski, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib38" title="">2016</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib27" title="">2023</a>; Zhou
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib45" title="">2022</a>)</cite>.
For example,
as a typical Markov chains-based method, TransRec <cite class="ltx_cite ltx_citemacro_citet">He
et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib17" title="">2017</a>)</cite> introduces a novel unified method to model third-order interactions in large-scale sequential prediction tasks by embedding items into a transition space and leveraging translation vectors to capture complex user-item and item-item relationships.
<cite class="ltx_cite ltx_citemacro_citet">Twardowski (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib38" title="">2016</a>)</cite> propose a matrix factorization-based sequential RecSys to capture user behavior dependencies without explicit user identification, utilizing user activity within single sessions as sequences of events to provide recommendations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">2) <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Deep learning-based methods</span> leverage the powerful representation capabilities of deep neural networks to model the users’ preferences based on the user-item interaction history.
For example,
<cite class="ltx_cite ltx_citemacro_citet">Tang and Wang (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib37" title="">2018</a>)</cite> propose a Convolutional Sequence Embedding Recommendation Model for top-N sequential recommendation by embedding users’ interaction sequence into an ”image” into the time and latent space and using convolutional filters to capture the sequential patterns.
<cite class="ltx_cite ltx_citemacro_citet">Zhang
et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib43" title="">2019</a>)</cite> utilize the self-attention mechanisms to estimate the weights for each item within the users’ historical behavior to model the users’ preferences for next-item recommendation.
<cite class="ltx_cite ltx_citemacro_citet">Chen
et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib4" title="">2018</a>)</cite> systematically investigates the impact of temporal information in sequential recommendations by uncovering and incorporating two fundamental temporal patterns of user behaviors, ‘absolute time patterns’ and ‘relative time patterns’, into the memory-augmented neural networks to model user dynamic preferences effectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Structured State Space Models (Mamba)</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Due to Mamba’s powerful sequential modeling capabilities and computational efficiency, numerous studies have applied it across various domains in real-life applications <cite class="ltx_cite ltx_citemacro_citep">(Qu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib31" title="">2024b</a>)</cite>.
For instance,
<cite class="ltx_cite ltx_citemacro_citet">Lieber
et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib25" title="">2024</a>)</cite> proposes a cutting-edge large language model called Jamba that combines Transformer and Mamba layers in a hybrid mixture-of-experts architecture, resulting in a high-performance, memory-efficient model capable of handling long-context sequences effectively.
<cite class="ltx_cite ltx_citemacro_citet">Ruan and Xiang (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib34" title="">2024</a>)</cite> introduce Vision Mamba UNet (VM-UNet), a novel U-shape architecture model for medical image segmentation that leverages State Space Models (SSMs) to address the limitations of CNNs and Transformers by incorporating a Visual State Space (VSS) block to capture extensive contextual information for medical image segmentation.
<cite class="ltx_cite ltx_citemacro_citet">Xing
et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib41" title="">2024</a>)</cite> a pioneering 3D medical image Segmentation Mamba model that leverages the efficiency of State Space Models (SSM) to effectively capture long-range dependencies within whole-volume features at various scales, outperforming Transformer-based methods in whole-volume feature modeling even with high-resolution volume features and achieving superior processing speed and efficacy in medical image segmentation tasks.
For more details on existing works, please refer to a comprehensive survey of mamba <cite class="ltx_cite ltx_citemacro_citep">(Qu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.01192v1#bib.bib31" title="">2024b</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">While existing deep learning-based sequential recommendation methods achieve promising prediction performance, they fail to effectively and efficiently capture user preferences with long-tail interactions.
To tackle these challenges, we propose a novel framework, named SSD4Rec, based on Mamba architecture for sequential recommendation.
To be specific, the proposed SSD4Rec consists of two key modules, i.e., a novel strategy for batch processing of variable-length item sequences and a Bi-SSD block for efficient user behavior sequence modeling.
Specifically, using the bidirectional structure enables a comprehensive information understanding, and the SSD layer equips the model with attention-like learning capabilities and superior computational efficiency.
Through comprehensive experiments on four distinct datasets, we revealed that our model could achieve state-of-the-art sequential recommendation performance while also exhibiting the capacity to achieve fast training and inference.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bronnec et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Florian Le Bronnec, Song
Duong, Mathieu Ravaut, Alexandre
Allauzen, Nancy F Chen, Vincent Guigue,
Alberto Lumbreras, Laure Soulier, and
Patrick Gallinari. 2024.

</span>
<span class="ltx_bibblock">LOCOST: State-Space Models for Long Document
Abstractive Summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">arXiv preprint arXiv:2401.17919</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chen Gao,
Yu Zheng, Yiqun Hui,
Yanan Niu, Yang Song,
Depeng Jin, and Yong Li.
2021.

</span>
<span class="ltx_bibblock">Sequential recommendation with graph neural
networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 44th international
ACM SIGIR conference on research and development in information retrieval</em>.
378–387.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen
et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Xu Chen, Hongteng Xu,
Yongfeng Zhang, Jiaxi Tang,
Yixin Cao, Zheng Qin, and
Hongyuan Zha. 2018.

</span>
<span class="ltx_bibblock">Sequential recommendation with user memory
networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the eleventh ACM
international conference on web search and data mining</em>.
108–116.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao and Gu (2024)</span>
<span class="ltx_bibblock">
Tri Dao and Albert Gu.
2024.

</span>
<span class="ltx_bibblock">Transformers are SSMs: Generalized Models and
Efficient Algorithms Through Structured State Space Duality. In
<em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International Conference on Machine Learning
(ICML)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Davidson
et al<span class="ltx_text" id="bib.bib6.3.3.1">.</span> (2010)</span>
<span class="ltx_bibblock">
James Davidson, Benjamin
Liebald, Junning Liu, Palash Nandy,
Taylor Van Vleet, Ullas Gargi,
Sujoy Gupta, Yu He, Mike
Lambert, Blake Livingston, et al<span class="ltx_text" id="bib.bib6.4.1">.</span>
2010.

</span>
<span class="ltx_bibblock">The YouTube video recommendation system. In
<em class="ltx_emph ltx_font_italic" id="bib.bib6.5.1">Proceedings of the fourth ACM conference on
Recommender systems</em>. 293–296.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Donkers
et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Tim Donkers, Benedikt
Loepp, and Jürgen Ziegler.
2017.

</span>
<span class="ltx_bibblock">Sequential user-based recurrent neural network
recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the eleventh
ACM conference on recommender systems</em>. 152–160.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan
et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jiasheng Duan, Peng-Fei
Zhang, Ruihong Qiu, and Zi Huang.
2023.

</span>
<span class="ltx_bibblock">Long short-term enhanced memory for sequential
recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">World Wide Web</em> 26,
2 (2023), 561–583.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan
et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Wenqi Fan, Xiaorui Liu,
Wei Jin, Xiangyu Zhao,
Jiliang Tang, and Qing Li.
2022.

</span>
<span class="ltx_bibblock">Graph trend filtering networks for recommendation.
In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 45th international ACM SIGIR
conference on research and development in information retrieval</em>.
112–121.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan
et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Wenqi Fan, Yao Ma,
Qing Li, Yuan He, Eric
Zhao, Jiliang Tang, and Dawei Yin.
2019.

</span>
<span class="ltx_bibblock">Graph neural networks for social recommendation.
In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">The world wide web conference</em>.
417–426.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan
et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Wenqi Fan, Yao Ma,
Qing Li, Jianping Wang,
Guoyong Cai, Jiliang Tang, and
Dawei Yin. 2020.

</span>
<span class="ltx_bibblock">A graph neural network framework for social
recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">IEEE Transactions on Knowledge and Data
Engineering</em> 34, 5
(2020), 2033–2047.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan
et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenqi Fan, Xiangyu Zhao,
Lin Wang, Xiao Chen,
Jingtong Gao, Qidong Liu, and
Shijie Wang. 2023.

</span>
<span class="ltx_bibblock">Trustworthy Recommender Systems: Foundations and
Frontiers. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the 29th ACM SIGKDD
Conference on Knowledge Discovery and Data Mining</em>.
5796–5797.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang
et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Hui Fang, Danning Zhang,
Yiheng Shu, and Guibing Guo.
2020.

</span>
<span class="ltx_bibblock">Deep learning for sequential recommendation:
Algorithms, influential factors, and evaluations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">ACM Transactions on Information Systems
(TOIS)</em> 39, 1 (2020),
1–42.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu and Dao (2023)</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao.
2023.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective
state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2312.00752</em>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu
et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Albert Gu, Karan Goel,
and Christopher Ré. 2021.

</span>
<span class="ltx_bibblock">Efficiently modeling long sequences with structured
state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">arXiv preprint arXiv:2111.00396</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Lei Guo, Hongzhi Yin,
Qinyong Wang, Tong Chen,
Alexander Zhou, and Nguyen Quoc
Viet Hung. 2019.

</span>
<span class="ltx_bibblock">Streaming session-based recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 25th ACM SIGKDD international
conference on knowledge discovery &amp; data mining</em>.
1569–1577.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He
et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruining He, Wang-Cheng
Kang, and Julian McAuley.
2017.

</span>
<span class="ltx_bibblock">Translation-based recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the eleventh ACM conference on
recommender systems</em>. 161–169.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He
et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Wei He, Kai Han,
Yehui Tang, Chengcheng Wang,
Yujie Yang, Tianyu Guo, and
Yunhe Wang. 2024.

</span>
<span class="ltx_bibblock">Densemamba: State space models with dense hidden
connection for efficient large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">arXiv preprint arXiv:2403.00818</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Balázs Hidasi,
Alexandros Karatzoglou, Linas Baltrunas,
and Domonkos Tikk. 2015.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural
networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">arXiv preprint arXiv:1511.06939</em>
(2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang
et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Yanxiang Huang, Bin Cui,
Wenyu Zhang, Jie Jiang, and
Ying Xu. 2015.

</span>
<span class="ltx_bibblock">Tencentrec: Real-time stream recommendation in
practice. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 2015 ACM SIGMOD
international conference on management of data</em>. 227–238.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang
et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Xilin Jiang, Cong Han,
and Nima Mesgarani. 2024.

</span>
<span class="ltx_bibblock">Dual-path mamba: Short and long-term bidirectional
selective structured state space models for speech separation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">arXiv preprint arXiv:2403.18257</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and
Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">2018 IEEE international conference on data mining
(ICDM)</em>. IEEE, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma (2014)</span>
<span class="ltx_bibblock">
DP Kingma.
2014.

</span>
<span class="ltx_bibblock">Adam: a method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:1412.6980</em>
(2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Chen (2024)</span>
<span class="ltx_bibblock">
Kai Li and Guo Chen.
2024.

</span>
<span class="ltx_bibblock">Spmamba: State-space model is all you need in
speech separation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2404.02063</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lieber
et al<span class="ltx_text" id="bib.bib25.3.3.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Opher Lieber, Barak Lenz,
Hofit Bata, Gal Cohen,
Jhonathan Osin, Itay Dalmedigos,
Erez Safahi, Shaked Meirom,
Yonatan Belinkov, Shai Shalev-Shwartz,
et al<span class="ltx_text" id="bib.bib25.4.1">.</span> 2024.

</span>
<span class="ltx_bibblock">Jamba: A hybrid transformer-mamba language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.5.1">arXiv preprint arXiv:2403.19887</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu
et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chengkai Liu, Jianghao
Lin, Jianling Wang, Hanzhou Liu, and
James Caverlee. 2024.

</span>
<span class="ltx_bibblock">Mamba4rec: Towards efficient sequential
recommendation with selective state space models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">arXiv preprint arXiv:2403.03900</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib27.3.3.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Langming Liu, Liu Cai,
Chi Zhang, Xiangyu Zhao,
Jingtong Gao, Wanyu Wang,
Yifu Lv, Wenqi Fan, Yiqi
Wang, Ming He, et al<span class="ltx_text" id="bib.bib27.4.1">.</span>
2023.

</span>
<span class="ltx_bibblock">Linrec: Linear attention mechanism for long-term
sequential recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.5.1">Proceedings of
the 46th International ACM SIGIR Conference on Research and Development in
Information Retrieval</em>. 289–299.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chris Lu, Yannick
Schroecker, Albert Gu, Emilio Parisotto,
Jakob Foerster, Satinder Singh, and
Feryal Behbahani. 2024.

</span>
<span class="ltx_bibblock">Structured state space models for in-context
reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Advances in Neural Information Processing
Systems</em> 36 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma
et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yifei Ma, Balakrishnan
Narayanaswamy, Haibin Lin, and Hao
Ding. 2020.

</span>
<span class="ltx_bibblock">Temporal-contextual recommendation in real-time.
In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Proceedings of the 26th ACM SIGKDD international
conference on knowledge discovery &amp; data mining</em>.
2291–2299.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu
et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Haohao Qu, Wenqi Fan,
Zihuai Zhao, and Qing Li.
2024a.

</span>
<span class="ltx_bibblock">TokenRec: Learning to Tokenize ID for LLM-based
Generative Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">arXiv preprint arXiv:2406.10450</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu
et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Haohao Qu, Liangbo Ning,
Rui An, Wenqi Fan, Tyler
Derr, Xin Xu, and Qing Li.
2024b.

</span>
<span class="ltx_bibblock">A Survey of Mamba.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">arXiv preprint arXiv:2408.01129</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rappaz
et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jérémie Rappaz,
Julian McAuley, and Karl Aberer.
2021.

</span>
<span class="ltx_bibblock">Recommendation on live-streaming platforms: Dynamic
availability and repeat consumption. In
<em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the 15th ACM Conference on
Recommender Systems</em>. 390–399.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren
et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Liliang Ren, Yang Liu,
Yadong Lu, Yelong Shen,
Chen Liang, and Weizhu Chen.
2024.

</span>
<span class="ltx_bibblock">Samba: Simple Hybrid State Space Models for
Efficient Unlimited Context Language Modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">arXiv preprint arXiv:2406.07522</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruan and Xiang (2024)</span>
<span class="ltx_bibblock">
Jiacheng Ruan and
Suncheng Xiang. 2024.

</span>
<span class="ltx_bibblock">Vm-unet: Vision mamba unet for medical image
segmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2402.02491</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singer et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Uriel Singer, Haggai
Roitman, Yotam Eshel, Alexander Nus,
Ido Guy, Or Levi, Idan
Hasson, and Eliyahu Kiperwasser.
2022.

</span>
<span class="ltx_bibblock">Sequential modeling with multiple attributes for
watchlist recommendation in e-commerce. In
<em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Proceedings of the Fifteenth ACM international
conference on web search and data mining</em>. 937–946.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun
et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu,
Jian Wu, Changhua Pei,
Xiao Lin, Wenwu Ou, and
Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with
bidirectional encoder representations from transformer. In
<em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the 28th ACM international
conference on information and knowledge management</em>.
1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke
Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized top-n sequential recommendation via
convolutional sequence embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings
of the eleventh ACM international conference on web search and data mining</em>.
565–573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Twardowski (2016)</span>
<span class="ltx_bibblock">
Bartłomiej Twardowski.
2016.

</span>
<span class="ltx_bibblock">Modelling contextual information in session-aware
recommender systems with neural networks. In
<em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the 10th ACM Conference on
Recommender Systems</em>. 273–276.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jianling Wang, Raphael
Louca, Diane Hu, Caitlin Cellier,
James Caverlee, and Liangjie Hong.
2020.

</span>
<span class="ltx_bibblock">Time to Shop for Valentine’s Day: Shopping
Occasions and Sequential Recommendation in E-commerce. In
<em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of the 13th International Conference on
Web Search and Data Mining</em>. 645–653.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu
et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu,
Tao Qi, Chenliang Li, and
Yongfeng Huang. 2022.

</span>
<span class="ltx_bibblock">Is news recommendation a sequential recommendation
task?. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the 45th international
ACM SIGIR conference on research and development in information retrieval</em>.
2382–2386.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xing
et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhaohu Xing, Tian Ye,
Yijun Yang, Guang Liu, and
Lei Zhu. 2024.

</span>
<span class="ltx_bibblock">Segmamba: Long-range sequential modeling mamba for
3d medical image segmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">arXiv preprint arXiv:2401.13560</em>
(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye
et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Wenwen Ye, Shuaiqiang
Wang, Xu Chen, Xuepeng Wang,
Zheng Qin, and Dawei Yin.
2020.

</span>
<span class="ltx_bibblock">Time matters: Sequential recommendation with
complex temporal information. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Proceedings of
the 43rd international ACM SIGIR conference on research and development in
information retrieval</em>. 1459–1468.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang
et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shuai Zhang, Yi Tay,
Lina Yao, Aixin Sun, and
Jake An. 2019.

</span>
<span class="ltx_bibblock">Next item recommendation with self-attentive metric
learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Thirty-third AAAI conference on
artificial intelligence</em>, Vol. 9.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib44.3.3.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zihuai Zhao, Wenqi Fan,
Jiatong Li, Yunqing Liu,
Xiaowei Mei, Yiqi Wang,
Zhen Wen, Fei Wang,
Xiangyu Zhao, Jiliang Tang,
et al<span class="ltx_text" id="bib.bib44.4.1">.</span> 2024.

</span>
<span class="ltx_bibblock">Recommender systems in the era of large language
models (llms).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.5.1">IEEE Transactions on Knowledge and Data
Engineering</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou
et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Yu,
Wayne Xin Zhao, and Ji-Rong Wen.
2022.

</span>
<span class="ltx_bibblock">Filter-enhanced MLP is all you need for sequential
recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Proceedings of the ACM web
conference 2022</em>. 2388–2399.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep  2 11:44:18 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
