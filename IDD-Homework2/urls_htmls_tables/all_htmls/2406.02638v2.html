<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation</title>
<!--Generated on Mon Jun 10 17:12:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.02638v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S1" title="In EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S2" title="In EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S2.SS1" title="In 2 Related Work ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Sequential Recommander with deep learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S2.SS2" title="In 2 Related Work ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>State Space Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S2.SS3" title="In 2 Related Work ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Mamba Block</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3" title="In EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS1" title="In 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Model definition</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS2" title="In 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Framework Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS3" title="In 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Embedding Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS4" title="In 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Bi-directional Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS4.SSS1" title="In 3.4 Bi-directional Modeling ‣ 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.1 </span>Reverse Sequence Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS4.SSS1.Px1" title="In 3.4.1 Reverse Sequence Modeling ‣ 3.4 Bi-directional Modeling ‣ 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title">Rationale for Bi-directional Approach</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS5" title="In 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Filter Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS6" title="In 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Gate Linear Unit</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS7" title="In 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.7 </span>EchoMamba Block</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.SS8" title="In 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.8 </span>Prediction Layer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4" title="In EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4.SS1" title="In 4 Experiments ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4.SS2" title="In 4 Experiments ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Recommendation performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4.SS3" title="In 4 Experiments ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Efficiency performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S5" title="In EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Future work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S6" title="In EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Acknowledgement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#A1" title="In EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Definition</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#A1.SS1" title="In Appendix A Definition ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Hit Ratio (HR)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#A1.SS2" title="In Appendix A Definition ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Normalized Discounted Cumulative Gain (NDCG)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#A1.SS3" title="In Appendix A Definition ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Mean Reciprocal Rank (MRR)</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\UseRawInputEncoding</span><span class="ltx_ERROR undefined" id="p1.2">\WarningFilter</span>
<p class="ltx_p" id="p1.3">latex‘h’ float specifier changed to ‘ht’</p>
</div>
<div class="ltx_para" id="p2">
<p class="ltx_p" id="p2.1">[2,1]<span class="ltx_ERROR undefined" id="p2.1.1">\fnm</span>Shengxin <span class="ltx_ERROR undefined" id="p2.1.2">\sur</span>Zhu</p>
</div>
<div class="ltx_para" id="p3">
<p class="ltx_p" id="p3.1">1]<span class="ltx_ERROR undefined" id="p3.1.1">\orgname</span>Guangdong Provincial Key Laboratory of Interdisciplinary Research and Application for Data Science, BNU-HKBU United International College, <span class="ltx_ERROR undefined" id="p3.1.2">\orgaddress</span><span class="ltx_ERROR undefined" id="p3.1.3">\city</span>Zhuhai <span class="ltx_ERROR undefined" id="p3.1.4">\postcode</span>519087, <span class="ltx_ERROR undefined" id="p3.1.5">\country</span>China
2]<span class="ltx_ERROR undefined" id="p3.1.6">\orgname</span>Research Center for Mathematics, Beijing Normal University, <span class="ltx_ERROR undefined" id="p3.1.7">\orgaddress</span><span class="ltx_ERROR undefined" id="p3.1.8">\street</span>No.18, Jingfeng Road, <span class="ltx_ERROR undefined" id="p3.1.9">\city</span>Zhuhai <span class="ltx_ERROR undefined" id="p3.1.10">\postcode</span>519087, <span class="ltx_ERROR undefined" id="p3.1.11">\state</span>Guangdong, <span class="ltx_ERROR undefined" id="p3.1.12">\country</span>China</p>
</div>
<h1 class="ltx_title ltx_title_document">EchoMamba4Rec: Harmonizing Bidirectional State Space
Models with Spectral Filtering for Advanced Sequential
Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id1.1.id1">\fnm</span>Yuda <span class="ltx_ERROR undefined" id="id2.2.id2">\sur</span>Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:q030026156@mail.uic.edu.cn">q030026156@mail.uic.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id3.1.id1">\fnm</span>Xuxin <span class="ltx_ERROR undefined" id="id4.2.id2">\sur</span>He
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:q030026051@mail.uic.edu.cn">q030026051@mail.uic.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:Shengxin.Zhu@bnu.edu.cn">Shengxin.Zhu@bnu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">Predicting user preferences and sequential dependencies based on historical behavior is the core goal of sequential recommendation. Although attention-based models have shown effectiveness in this field, they often struggle with inference inefficiency due to the quadratic computational complexity inherent in attention mechanisms, especially with long-range behavior sequences. Drawing inspiration from the recent advancements of state space models (SSMs) in control theory, which provide a robust framework for modeling and controlling dynamic systems, we introduce EchoMamba4Rec. Control theory emphasizes the use of SSMs for managing long-range dependencies and maintaining inferential efficiency through structured state matrices. EchoMamba4Rec leverages these control relationships in sequential recommendation and integrates bi-directional processing with frequency-domain filtering to capture complex patterns and dependencies in user interaction data more effectively. Our model benefits from the ability of state space models (SSMs) to learn and perform parallel computations, significantly enhancing computational efficiency and scalability. It features a bi-directional Mamba module that incorporates both forward and reverse Mamba components, leveraging information from both past and future interactions.</p>
<p class="ltx_p" id="id6.id2">Additionally, a filter layer operates in the frequency domain using Fast Fourier Transform (FFT) and learnable filters, followed by an inverse FFT to refine item embeddings and reduce noise. We also integrate Gate Linear Units (GLU) to dynamically control information flow, enhancing the model’s expressiveness and training stability. Experimental results demonstrate that EchoMamba significantly outperforms existing models, providing more accurate and personalized recommendations. This study underscores the potential of integrating bi-directional and frequency-domain techniques with control theory to advance the state-of-the-art in sequential recommendation systems. Our code can be found at https://github.com/wyd0042/EchoMamba4Rec.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>Sequential Recommendation, State Space Models, Bi-directional Processing, Frequency-domain Filtering
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Traditionally, research in recommendation systems has focused mainly on standard collaborative filtering, ranking methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib1" title="">1</a>]</cite> and regression methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib4" title="">4</a>]</cite>. However, the landscape of recommendation systems has evolved significantly in recent years with the advent of deep learning and neural networks. Deep learning-based recommendation systems, such as XDeepFig <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib5" title="">5</a>]</cite> and deep interest models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib7" title="">7</a>]</cite>, have shown better results by effectively capturing complex user-item interactions. Sequential recommendation is crucial in many real-world applications, such as e-commerce, social media <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib8" title="">8</a>]</cite>, medicine and drug system <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib9" title="">9</a>]</cite>,and content streaming platforms <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib10" title="">10</a>]</cite>, where understanding user preferences and sequential dependencies can significantly enhance user experience and engagement. However, the sequential recommendation problem remains a relatively new yet important open research question, and it has proven challenging to leverage time and memory information to improve recommendation performance. Existing models, like those based on Transformers, face computational complexity constraints that limit their scalability and practicality, especially for long-range behavior sequences. Although Transformer models have achieved significant success in the recommendation systems domain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib11" title="">11</a>]</cite>, they face fundamental challenges when handling long sequences. In Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib12" title="">12</a>]</cite>, each token can refer to all preceding tokens during prediction, leading to a quadratic time complexity of O(<math alttext="n^{2}" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><msup id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml"><mi id="S1.p1.1.m1.1.1.2" xref="S1.p1.1.m1.1.1.2.cmml">n</mi><mn id="S1.p1.1.m1.1.1.3" xref="S1.p1.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><apply id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p1.1.m1.1.1.1.cmml" xref="S1.p1.1.m1.1.1">superscript</csymbol><ci id="S1.p1.1.m1.1.1.2.cmml" xref="S1.p1.1.m1.1.1.2">𝑛</ci><cn id="S1.p1.1.m1.1.1.3.cmml" type="integer" xref="S1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">n^{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>) during training, often called the “quadratic bottleneck” <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib13" title="">13</a>]</cite>. Additionally, the key-value (KV) cache calculation in attention models required to store these tokens incurs an O(n) space complexity. This results in increased memory usage, raising the risk of CUDA Out-of-Memory (OOM) errors as memory consumption grows. Thus, exploring efficient and effective sequential recommendation solutions is highly relevant and valuable.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Addressing this performance-efficiency impasse, the state space model (SSM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib15" title="">15</a>]</cite> emerges as a central operator, heralding an era of efficient sequential recommendation. Originating from control theory <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib16" title="">16</a>]</cite>, SSMs are designed to model dynamic systems by representing them with state variables and equations that describe their evolution over time <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib17" title="">17</a>]</cite>. This approach offers significant advantages in maintaining inferential efficiency and managing long-range dependencies via structured state matrices. With a lineage tracing back to alternatives for RNNs and Transformers across various language tasks, the allure of SSM lies in its ability to encapsulate system dynamics accurately while ensuring computational feasibility.This paper is the vanguard in harnessing selective SSMs, particularly Mamba <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib17" title="">17</a>]</cite>—a variant with data-dependent selectivity and efficient hardware-aligned algorithms—for the purpose of sequential recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib18" title="">18</a>]</cite>. The convergence of the Mamba block with novel sequential modeling techniques illustrates a significant leap forward, enhancing the model’s performance without compromising on inferential swiftness. The research delineates the overarching contributions of our EchoMamba4Rec model, demonstrates its supremacy over RNN and attention-based baselines through experimental analysis, and sets the stage for advancing SSM-based models in the recommender system sphere.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The Mamba model employs a state space model (SSM) inspired by control theory to replace the traditional attention mechanism, while retaining multi-layer perceptron (MLP) style projections for computation. This approach allows Mamba to efficiently handle sequential data. The Mamba model has the following three key highlights <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib17" title="">17</a>]</cite>:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Long Sequence Processing</span>: Mamba can process token sequences as long as millions of tokens, which is critical for tasks that require long-term memory.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Fast Inference</span>: Mamba’s inference speed is exceptionally fast, about five times faster than that of Transformer models, which means it can process more data in a shorter time <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib17" title="">17</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Linear Scalability</span>: Mamba has linear scalability with respect to sequence length <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib17" title="">17</a>]</cite>, indicating that as the sequence length increases, the model’s performance does not significantly degrade.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The main contributions of this paper are as follows:
We enhance existing models that utilize Mamba for sequential recommendation by incorporating a Fourier layer and Gate Linear Units (GLU), and by employing bi-directional processing strategies. These improvements bolster the sequence modeling capability while maintaining inference efficiency and address the prevalent effectiveness-efficiency dilemma existing in RNNs and Transformers.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Sequential Recommander with deep learning</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">The evolution of recommendation systems has been significantly influenced by advancements in deep learning, marking a shift towards more personalized and dynamic user experiences. Early neural approaches to sequential recommendation utilized Convolutional Neural Networks (CNNs) and Recurrent Neural Networks (RNNs) to model user behaviors, paving the way for the application of neural networks in this domain. However, these models often grappled with challenges such as catastrophic forgetting and limited ability to handle long-term dependencies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib21" title="">21</a>]</cite>. The introduction of transformer models, with their self-attention mechanisms, represented a leap forward, offering remarkable performance improvements by effectively capturing dynamic user interactions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib22" title="">22</a>]</cite>. CycleTrans has proven successful in dealing with sequential Electronic Health Records (EHR) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib9" title="">9</a>]</cite>, showcasing the potential of transformer-based models in sequential recommendation tasks. Despite their success, attention-based methods encounter inference inefficiency due to the quadratic computational complexity inherent in attention operators, particularly for long user behavior sequences or large-scale datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib18" title="">18</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>State Space Model</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.2">State Space Models (SSM) provide a compelling framework for modeling sequences, offering significant advantages over transformer models due to their linear computational complexity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib14" title="">14</a>]</cite>. Unlike transformers, which exhibit quadratic complexity <math alttext="O(n^{2}\cdot d)" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">O</mi><mo id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><msup id="S2.SS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.2.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.2.cmml">n</mi><mn id="S2.SS2.p1.1.m1.1.1.1.1.1.2.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S2.SS2.p1.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml">⋅</mo><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="S2.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><times id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"></times><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑂</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1"><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1">⋅</ci><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.2">𝑛</ci><cn id="S2.SS2.p1.1.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.3">2</cn></apply><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">O(n^{2}\cdot d)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ⋅ italic_d )</annotation></semantics></math> with respect to sequence length due to their self-attention mechanism, SSM operates with a complexity of <math alttext="O(n\cdot d^{2})" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mrow id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">O</mi><mo id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.2.m2.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.2.m2.1.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.1.1.1.2" xref="S2.SS2.p1.2.m2.1.1.1.1.1.2.cmml">n</mi><mo id="S2.SS2.p1.2.m2.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p1.2.m2.1.1.1.1.1.1.cmml">⋅</mo><msup id="S2.SS2.p1.2.m2.1.1.1.1.1.3" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p1.2.m2.1.1.1.1.1.3.2" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3.2.cmml">d</mi><mn id="S2.SS2.p1.2.m2.1.1.1.1.1.3.3" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S2.SS2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><times id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2"></times><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑂</ci><apply id="S2.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1"><ci id="S2.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1.1">⋅</ci><ci id="S2.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1.2">𝑛</ci><apply id="S2.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3.2">𝑑</ci><cn id="S2.SS2.p1.2.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">O(n\cdot d^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_O ( italic_n ⋅ italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, making them ideal for long sequences.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">In control theory, SSMs are pivotal for representing dynamic systems through state variables, which encapsulate the system’s status at any given time. This representation comprises a set of first-order differential (or difference) equations that describe the evolution of the state vector and an output equation that maps the state vector to observed data
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib23" title="">23</a>]</cite>. These models enable efficient prediction and control of system behavior over time, making them ideal for applications in signal processing, econometrics, and time series analysis
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib24" title="">24</a>]</cite>. The ability to incorporate noise and other disturbances into the model further enhances their applicability in real-world scenarios
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib25" title="">25</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.7">Furthermore, linear state-space control systems are fundamental for the analysis and design of linear control systems, making them ideal for both researchers and students preparing for advanced studies in systems and control theory <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib16" title="">16</a>]</cite>.
The foundational continuous form of SSM is defined by the linear ordinary differential equations:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S1.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h^{\prime}(t)" class="ltx_Math" display="inline" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.2" xref="S2.E1.m1.1.2.cmml"><msup id="S2.E1.m1.1.2.2" xref="S2.E1.m1.1.2.2.cmml"><mi id="S2.E1.m1.1.2.2.2" xref="S2.E1.m1.1.2.2.2.cmml">h</mi><mo id="S2.E1.m1.1.2.2.3" xref="S2.E1.m1.1.2.2.3.cmml">′</mo></msup><mo id="S2.E1.m1.1.2.1" xref="S2.E1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.1.2.3.2" xref="S2.E1.m1.1.2.cmml"><mo id="S2.E1.m1.1.2.3.2.1" stretchy="false" xref="S2.E1.m1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">t</mi><mo id="S2.E1.m1.1.2.3.2.2" stretchy="false" xref="S2.E1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.2.cmml" xref="S2.E1.m1.1.2"><times id="S2.E1.m1.1.2.1.cmml" xref="S2.E1.m1.1.2.1"></times><apply id="S2.E1.m1.1.2.2.cmml" xref="S2.E1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.2.1.cmml" xref="S2.E1.m1.1.2.2">superscript</csymbol><ci id="S2.E1.m1.1.2.2.2.cmml" xref="S2.E1.m1.1.2.2.2">ℎ</ci><ci id="S2.E1.m1.1.2.2.3.cmml" xref="S2.E1.m1.1.2.2.3">′</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle h^{\prime}(t)</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_t )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Ah(t)+Bx(t)," class="ltx_Math" display="inline" id="S2.E1.m2.3"><semantics id="S2.E1.m2.3a"><mrow id="S2.E1.m2.3.3.1" xref="S2.E1.m2.3.3.1.1.cmml"><mrow id="S2.E1.m2.3.3.1.1" xref="S2.E1.m2.3.3.1.1.cmml"><mi id="S2.E1.m2.3.3.1.1.2" xref="S2.E1.m2.3.3.1.1.2.cmml"></mi><mo id="S2.E1.m2.3.3.1.1.1" xref="S2.E1.m2.3.3.1.1.1.cmml">=</mo><mrow id="S2.E1.m2.3.3.1.1.3" xref="S2.E1.m2.3.3.1.1.3.cmml"><mrow id="S2.E1.m2.3.3.1.1.3.2" xref="S2.E1.m2.3.3.1.1.3.2.cmml"><mi id="S2.E1.m2.3.3.1.1.3.2.2" xref="S2.E1.m2.3.3.1.1.3.2.2.cmml">A</mi><mo id="S2.E1.m2.3.3.1.1.3.2.1" xref="S2.E1.m2.3.3.1.1.3.2.1.cmml">⁢</mo><mi id="S2.E1.m2.3.3.1.1.3.2.3" xref="S2.E1.m2.3.3.1.1.3.2.3.cmml">h</mi><mo id="S2.E1.m2.3.3.1.1.3.2.1a" xref="S2.E1.m2.3.3.1.1.3.2.1.cmml">⁢</mo><mrow id="S2.E1.m2.3.3.1.1.3.2.4.2" xref="S2.E1.m2.3.3.1.1.3.2.cmml"><mo id="S2.E1.m2.3.3.1.1.3.2.4.2.1" stretchy="false" xref="S2.E1.m2.3.3.1.1.3.2.cmml">(</mo><mi id="S2.E1.m2.1.1" xref="S2.E1.m2.1.1.cmml">t</mi><mo id="S2.E1.m2.3.3.1.1.3.2.4.2.2" stretchy="false" xref="S2.E1.m2.3.3.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m2.3.3.1.1.3.1" xref="S2.E1.m2.3.3.1.1.3.1.cmml">+</mo><mrow id="S2.E1.m2.3.3.1.1.3.3" xref="S2.E1.m2.3.3.1.1.3.3.cmml"><mi id="S2.E1.m2.3.3.1.1.3.3.2" xref="S2.E1.m2.3.3.1.1.3.3.2.cmml">B</mi><mo id="S2.E1.m2.3.3.1.1.3.3.1" xref="S2.E1.m2.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E1.m2.3.3.1.1.3.3.3" xref="S2.E1.m2.3.3.1.1.3.3.3.cmml">x</mi><mo id="S2.E1.m2.3.3.1.1.3.3.1a" xref="S2.E1.m2.3.3.1.1.3.3.1.cmml">⁢</mo><mrow id="S2.E1.m2.3.3.1.1.3.3.4.2" xref="S2.E1.m2.3.3.1.1.3.3.cmml"><mo id="S2.E1.m2.3.3.1.1.3.3.4.2.1" stretchy="false" xref="S2.E1.m2.3.3.1.1.3.3.cmml">(</mo><mi id="S2.E1.m2.2.2" xref="S2.E1.m2.2.2.cmml">t</mi><mo id="S2.E1.m2.3.3.1.1.3.3.4.2.2" stretchy="false" xref="S2.E1.m2.3.3.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m2.3.3.1.2" xref="S2.E1.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m2.3b"><apply id="S2.E1.m2.3.3.1.1.cmml" xref="S2.E1.m2.3.3.1"><eq id="S2.E1.m2.3.3.1.1.1.cmml" xref="S2.E1.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S2.E1.m2.3.3.1.1.2.cmml" xref="S2.E1.m2.3.3.1.1.2">absent</csymbol><apply id="S2.E1.m2.3.3.1.1.3.cmml" xref="S2.E1.m2.3.3.1.1.3"><plus id="S2.E1.m2.3.3.1.1.3.1.cmml" xref="S2.E1.m2.3.3.1.1.3.1"></plus><apply id="S2.E1.m2.3.3.1.1.3.2.cmml" xref="S2.E1.m2.3.3.1.1.3.2"><times id="S2.E1.m2.3.3.1.1.3.2.1.cmml" xref="S2.E1.m2.3.3.1.1.3.2.1"></times><ci id="S2.E1.m2.3.3.1.1.3.2.2.cmml" xref="S2.E1.m2.3.3.1.1.3.2.2">𝐴</ci><ci id="S2.E1.m2.3.3.1.1.3.2.3.cmml" xref="S2.E1.m2.3.3.1.1.3.2.3">ℎ</ci><ci id="S2.E1.m2.1.1.cmml" xref="S2.E1.m2.1.1">𝑡</ci></apply><apply id="S2.E1.m2.3.3.1.1.3.3.cmml" xref="S2.E1.m2.3.3.1.1.3.3"><times id="S2.E1.m2.3.3.1.1.3.3.1.cmml" xref="S2.E1.m2.3.3.1.1.3.3.1"></times><ci id="S2.E1.m2.3.3.1.1.3.3.2.cmml" xref="S2.E1.m2.3.3.1.1.3.3.2">𝐵</ci><ci id="S2.E1.m2.3.3.1.1.3.3.3.cmml" xref="S2.E1.m2.3.3.1.1.3.3.3">𝑥</ci><ci id="S2.E1.m2.2.2.cmml" xref="S2.E1.m2.2.2">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m2.3c">\displaystyle=Ah(t)+Bx(t),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m2.3d">= italic_A italic_h ( italic_t ) + italic_B italic_x ( italic_t ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle y(t)" class="ltx_Math" display="inline" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.2" xref="S2.E2.m1.1.2.cmml"><mi id="S2.E2.m1.1.2.2" xref="S2.E2.m1.1.2.2.cmml">y</mi><mo id="S2.E2.m1.1.2.1" xref="S2.E2.m1.1.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.1.2.3.2" xref="S2.E2.m1.1.2.cmml"><mo id="S2.E2.m1.1.2.3.2.1" stretchy="false" xref="S2.E2.m1.1.2.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">t</mi><mo id="S2.E2.m1.1.2.3.2.2" stretchy="false" xref="S2.E2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.2.cmml" xref="S2.E2.m1.1.2"><times id="S2.E2.m1.1.2.1.cmml" xref="S2.E2.m1.1.2.1"></times><ci id="S2.E2.m1.1.2.2.cmml" xref="S2.E2.m1.1.2.2">𝑦</ci><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle y(t)</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_y ( italic_t )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Ch(t)," class="ltx_Math" display="inline" id="S2.E2.m2.2"><semantics id="S2.E2.m2.2a"><mrow id="S2.E2.m2.2.2.1" xref="S2.E2.m2.2.2.1.1.cmml"><mrow id="S2.E2.m2.2.2.1.1" xref="S2.E2.m2.2.2.1.1.cmml"><mi id="S2.E2.m2.2.2.1.1.2" xref="S2.E2.m2.2.2.1.1.2.cmml"></mi><mo id="S2.E2.m2.2.2.1.1.1" xref="S2.E2.m2.2.2.1.1.1.cmml">=</mo><mrow id="S2.E2.m2.2.2.1.1.3" xref="S2.E2.m2.2.2.1.1.3.cmml"><mi id="S2.E2.m2.2.2.1.1.3.2" xref="S2.E2.m2.2.2.1.1.3.2.cmml">C</mi><mo id="S2.E2.m2.2.2.1.1.3.1" xref="S2.E2.m2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S2.E2.m2.2.2.1.1.3.3" xref="S2.E2.m2.2.2.1.1.3.3.cmml">h</mi><mo id="S2.E2.m2.2.2.1.1.3.1a" xref="S2.E2.m2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E2.m2.2.2.1.1.3.4.2" xref="S2.E2.m2.2.2.1.1.3.cmml"><mo id="S2.E2.m2.2.2.1.1.3.4.2.1" stretchy="false" xref="S2.E2.m2.2.2.1.1.3.cmml">(</mo><mi id="S2.E2.m2.1.1" xref="S2.E2.m2.1.1.cmml">t</mi><mo id="S2.E2.m2.2.2.1.1.3.4.2.2" stretchy="false" xref="S2.E2.m2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m2.2.2.1.2" xref="S2.E2.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.2b"><apply id="S2.E2.m2.2.2.1.1.cmml" xref="S2.E2.m2.2.2.1"><eq id="S2.E2.m2.2.2.1.1.1.cmml" xref="S2.E2.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S2.E2.m2.2.2.1.1.2.cmml" xref="S2.E2.m2.2.2.1.1.2">absent</csymbol><apply id="S2.E2.m2.2.2.1.1.3.cmml" xref="S2.E2.m2.2.2.1.1.3"><times id="S2.E2.m2.2.2.1.1.3.1.cmml" xref="S2.E2.m2.2.2.1.1.3.1"></times><ci id="S2.E2.m2.2.2.1.1.3.2.cmml" xref="S2.E2.m2.2.2.1.1.3.2">𝐶</ci><ci id="S2.E2.m2.2.2.1.1.3.3.cmml" xref="S2.E2.m2.2.2.1.1.3.3">ℎ</ci><ci id="S2.E2.m2.1.1.cmml" xref="S2.E2.m2.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.2c">\displaystyle=Ch(t),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m2.2d">= italic_C italic_h ( italic_t ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p3.6">where <math alttext="h(t)" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mi id="S2.SS2.p3.1.m1.1.2.2" xref="S2.SS2.p3.1.m1.1.2.2.cmml">h</mi><mo id="S2.SS2.p3.1.m1.1.2.1" xref="S2.SS2.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p3.1.m1.1.2.3.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mo id="S2.SS2.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS2.p3.1.m1.1.2.cmml">(</mo><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">t</mi><mo id="S2.SS2.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.2"><times id="S2.SS2.p3.1.m1.1.2.1.cmml" xref="S2.SS2.p3.1.m1.1.2.1"></times><ci id="S2.SS2.p3.1.m1.1.2.2.cmml" xref="S2.SS2.p3.1.m1.1.2.2">ℎ</ci><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">h(t)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_h ( italic_t )</annotation></semantics></math> represents the latent state, <math alttext="x(t)" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1"><semantics id="S2.SS2.p3.2.m2.1a"><mrow id="S2.SS2.p3.2.m2.1.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><mi id="S2.SS2.p3.2.m2.1.2.2" xref="S2.SS2.p3.2.m2.1.2.2.cmml">x</mi><mo id="S2.SS2.p3.2.m2.1.2.1" xref="S2.SS2.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p3.2.m2.1.2.3.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><mo id="S2.SS2.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS2.p3.2.m2.1.2.cmml">(</mo><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">t</mi><mo id="S2.SS2.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.2.cmml" xref="S2.SS2.p3.2.m2.1.2"><times id="S2.SS2.p3.2.m2.1.2.1.cmml" xref="S2.SS2.p3.2.m2.1.2.1"></times><ci id="S2.SS2.p3.2.m2.1.2.2.cmml" xref="S2.SS2.p3.2.m2.1.2.2">𝑥</ci><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">x(t)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">italic_x ( italic_t )</annotation></semantics></math> the input sequence, and <math alttext="y(t)" class="ltx_Math" display="inline" id="S2.SS2.p3.3.m3.1"><semantics id="S2.SS2.p3.3.m3.1a"><mrow id="S2.SS2.p3.3.m3.1.2" xref="S2.SS2.p3.3.m3.1.2.cmml"><mi id="S2.SS2.p3.3.m3.1.2.2" xref="S2.SS2.p3.3.m3.1.2.2.cmml">y</mi><mo id="S2.SS2.p3.3.m3.1.2.1" xref="S2.SS2.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p3.3.m3.1.2.3.2" xref="S2.SS2.p3.3.m3.1.2.cmml"><mo id="S2.SS2.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S2.SS2.p3.3.m3.1.2.cmml">(</mo><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">t</mi><mo id="S2.SS2.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S2.SS2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><apply id="S2.SS2.p3.3.m3.1.2.cmml" xref="S2.SS2.p3.3.m3.1.2"><times id="S2.SS2.p3.3.m3.1.2.1.cmml" xref="S2.SS2.p3.3.m3.1.2.1"></times><ci id="S2.SS2.p3.3.m3.1.2.2.cmml" xref="S2.SS2.p3.3.m3.1.2.2">𝑦</ci><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">y(t)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m3.1d">italic_y ( italic_t )</annotation></semantics></math> the output, with <math alttext="A" class="ltx_Math" display="inline" id="S2.SS2.p3.4.m4.1"><semantics id="S2.SS2.p3.4.m4.1a"><mi id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.4.m4.1d">italic_A</annotation></semantics></math>, <math alttext="B" class="ltx_Math" display="inline" id="S2.SS2.p3.5.m5.1"><semantics id="S2.SS2.p3.5.m5.1a"><mi id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><ci id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">B</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.5.m5.1d">italic_B</annotation></semantics></math>, and <math alttext="C" class="ltx_Math" display="inline" id="S2.SS2.p3.6.m6.1"><semantics id="S2.SS2.p3.6.m6.1a"><mi id="S2.SS2.p3.6.m6.1.1" xref="S2.SS2.p3.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m6.1b"><ci id="S2.SS2.p3.6.m6.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m6.1c">C</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.6.m6.1d">italic_C</annotation></semantics></math> as learnable matrices.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">To adapt this model for digital computation, it is discretized using a step size <math alttext="\Delta" class="ltx_Math" display="inline" id="S2.SS2.p4.1.m1.1"><semantics id="S2.SS2.p4.1.m1.1a"><mi id="S2.SS2.p4.1.m1.1.1" mathvariant="normal" xref="S2.SS2.p4.1.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><ci id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.1.m1.1d">roman_Δ</annotation></semantics></math>, resulting in:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S1.EGx2">
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h_{t}" class="ltx_Math" display="inline" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><msub id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml">h</mi><mi id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2">ℎ</ci><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle h_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Ah_{t-1}+Bx_{t}," class="ltx_Math" display="inline" id="S2.E3.m2.1"><semantics id="S2.E3.m2.1a"><mrow id="S2.E3.m2.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml"><mrow id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml"><mi id="S2.E3.m2.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.2.cmml"></mi><mo id="S2.E3.m2.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3.m2.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.3.cmml"><mrow id="S2.E3.m2.1.1.1.1.3.2" xref="S2.E3.m2.1.1.1.1.3.2.cmml"><mi id="S2.E3.m2.1.1.1.1.3.2.2" xref="S2.E3.m2.1.1.1.1.3.2.2.cmml">A</mi><mo id="S2.E3.m2.1.1.1.1.3.2.1" xref="S2.E3.m2.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E3.m2.1.1.1.1.3.2.3" xref="S2.E3.m2.1.1.1.1.3.2.3.cmml"><mi id="S2.E3.m2.1.1.1.1.3.2.3.2" xref="S2.E3.m2.1.1.1.1.3.2.3.2.cmml">h</mi><mrow id="S2.E3.m2.1.1.1.1.3.2.3.3" xref="S2.E3.m2.1.1.1.1.3.2.3.3.cmml"><mi id="S2.E3.m2.1.1.1.1.3.2.3.3.2" xref="S2.E3.m2.1.1.1.1.3.2.3.3.2.cmml">t</mi><mo id="S2.E3.m2.1.1.1.1.3.2.3.3.1" xref="S2.E3.m2.1.1.1.1.3.2.3.3.1.cmml">−</mo><mn id="S2.E3.m2.1.1.1.1.3.2.3.3.3" xref="S2.E3.m2.1.1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.E3.m2.1.1.1.1.3.1" xref="S2.E3.m2.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E3.m2.1.1.1.1.3.3" xref="S2.E3.m2.1.1.1.1.3.3.cmml"><mi id="S2.E3.m2.1.1.1.1.3.3.2" xref="S2.E3.m2.1.1.1.1.3.3.2.cmml">B</mi><mo id="S2.E3.m2.1.1.1.1.3.3.1" xref="S2.E3.m2.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E3.m2.1.1.1.1.3.3.3" xref="S2.E3.m2.1.1.1.1.3.3.3.cmml"><mi id="S2.E3.m2.1.1.1.1.3.3.3.2" xref="S2.E3.m2.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.E3.m2.1.1.1.1.3.3.3.3" xref="S2.E3.m2.1.1.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo id="S2.E3.m2.1.1.1.2" xref="S2.E3.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.1b"><apply id="S2.E3.m2.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1"><eq id="S2.E3.m2.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E3.m2.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E3.m2.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.3"><plus id="S2.E3.m2.1.1.1.1.3.1.cmml" xref="S2.E3.m2.1.1.1.1.3.1"></plus><apply id="S2.E3.m2.1.1.1.1.3.2.cmml" xref="S2.E3.m2.1.1.1.1.3.2"><times id="S2.E3.m2.1.1.1.1.3.2.1.cmml" xref="S2.E3.m2.1.1.1.1.3.2.1"></times><ci id="S2.E3.m2.1.1.1.1.3.2.2.cmml" xref="S2.E3.m2.1.1.1.1.3.2.2">𝐴</ci><apply id="S2.E3.m2.1.1.1.1.3.2.3.cmml" xref="S2.E3.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.3.2.3.1.cmml" xref="S2.E3.m2.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.3.2.3.2.cmml" xref="S2.E3.m2.1.1.1.1.3.2.3.2">ℎ</ci><apply id="S2.E3.m2.1.1.1.1.3.2.3.3.cmml" xref="S2.E3.m2.1.1.1.1.3.2.3.3"><minus id="S2.E3.m2.1.1.1.1.3.2.3.3.1.cmml" xref="S2.E3.m2.1.1.1.1.3.2.3.3.1"></minus><ci id="S2.E3.m2.1.1.1.1.3.2.3.3.2.cmml" xref="S2.E3.m2.1.1.1.1.3.2.3.3.2">𝑡</ci><cn id="S2.E3.m2.1.1.1.1.3.2.3.3.3.cmml" type="integer" xref="S2.E3.m2.1.1.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S2.E3.m2.1.1.1.1.3.3.cmml" xref="S2.E3.m2.1.1.1.1.3.3"><times id="S2.E3.m2.1.1.1.1.3.3.1.cmml" xref="S2.E3.m2.1.1.1.1.3.3.1"></times><ci id="S2.E3.m2.1.1.1.1.3.3.2.cmml" xref="S2.E3.m2.1.1.1.1.3.3.2">𝐵</ci><apply id="S2.E3.m2.1.1.1.1.3.3.3.cmml" xref="S2.E3.m2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.3.3.3.1.cmml" xref="S2.E3.m2.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.3.3.3.2.cmml" xref="S2.E3.m2.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.E3.m2.1.1.1.1.3.3.3.3.cmml" xref="S2.E3.m2.1.1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.1c">\displaystyle=Ah_{t-1}+Bx_{t},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m2.1d">= italic_A italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_B italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle y_{t}" class="ltx_Math" display="inline" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><msub id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">y</mi><mi id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">𝑦</ci><ci id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=Ch_{t}," class="ltx_Math" display="inline" id="S2.E4.m2.1"><semantics id="S2.E4.m2.1a"><mrow id="S2.E4.m2.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml"><mrow id="S2.E4.m2.1.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml"><mi id="S2.E4.m2.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.2.cmml"></mi><mo id="S2.E4.m2.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.E4.m2.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.3.cmml"><mi id="S2.E4.m2.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.3.2.cmml">C</mi><mo id="S2.E4.m2.1.1.1.1.3.1" xref="S2.E4.m2.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E4.m2.1.1.1.1.3.3" xref="S2.E4.m2.1.1.1.1.3.3.cmml"><mi id="S2.E4.m2.1.1.1.1.3.3.2" xref="S2.E4.m2.1.1.1.1.3.3.2.cmml">h</mi><mi id="S2.E4.m2.1.1.1.1.3.3.3" xref="S2.E4.m2.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S2.E4.m2.1.1.1.2" xref="S2.E4.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.1b"><apply id="S2.E4.m2.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1"><eq id="S2.E4.m2.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E4.m2.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E4.m2.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.3"><times id="S2.E4.m2.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.1"></times><ci id="S2.E4.m2.1.1.1.1.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.2">𝐶</ci><apply id="S2.E4.m2.1.1.1.1.3.3.cmml" xref="S2.E4.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.3.3.1.cmml" xref="S2.E4.m2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.3.3.2.cmml" xref="S2.E4.m2.1.1.1.1.3.3.2">ℎ</ci><ci id="S2.E4.m2.1.1.1.1.3.3.3.cmml" xref="S2.E4.m2.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.1c">\displaystyle=Ch_{t},</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m2.1d">= italic_C italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p4.5">where <math alttext="A" class="ltx_Math" display="inline" id="S2.SS2.p4.2.m1.1"><semantics id="S2.SS2.p4.2.m1.1a"><mi id="S2.SS2.p4.2.m1.1.1" xref="S2.SS2.p4.2.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m1.1b"><ci id="S2.SS2.p4.2.m1.1.1.cmml" xref="S2.SS2.p4.2.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.2.m1.1d">italic_A</annotation></semantics></math> and <math alttext="B" class="ltx_Math" display="inline" id="S2.SS2.p4.3.m2.1"><semantics id="S2.SS2.p4.3.m2.1a"><mi id="S2.SS2.p4.3.m2.1.1" xref="S2.SS2.p4.3.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m2.1b"><ci id="S2.SS2.p4.3.m2.1.1.cmml" xref="S2.SS2.p4.3.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.3.m2.1d">italic_B</annotation></semantics></math> are modified to <math alttext="A=\exp(\Delta A)" class="ltx_Math" display="inline" id="S2.SS2.p4.4.m3.2"><semantics id="S2.SS2.p4.4.m3.2a"><mrow id="S2.SS2.p4.4.m3.2.2" xref="S2.SS2.p4.4.m3.2.2.cmml"><mi id="S2.SS2.p4.4.m3.2.2.3" xref="S2.SS2.p4.4.m3.2.2.3.cmml">A</mi><mo id="S2.SS2.p4.4.m3.2.2.2" xref="S2.SS2.p4.4.m3.2.2.2.cmml">=</mo><mrow id="S2.SS2.p4.4.m3.2.2.1.1" xref="S2.SS2.p4.4.m3.2.2.1.2.cmml"><mi id="S2.SS2.p4.4.m3.1.1" xref="S2.SS2.p4.4.m3.1.1.cmml">exp</mi><mo id="S2.SS2.p4.4.m3.2.2.1.1a" xref="S2.SS2.p4.4.m3.2.2.1.2.cmml">⁡</mo><mrow id="S2.SS2.p4.4.m3.2.2.1.1.1" xref="S2.SS2.p4.4.m3.2.2.1.2.cmml"><mo id="S2.SS2.p4.4.m3.2.2.1.1.1.2" stretchy="false" xref="S2.SS2.p4.4.m3.2.2.1.2.cmml">(</mo><mrow id="S2.SS2.p4.4.m3.2.2.1.1.1.1" xref="S2.SS2.p4.4.m3.2.2.1.1.1.1.cmml"><mi id="S2.SS2.p4.4.m3.2.2.1.1.1.1.2" mathvariant="normal" xref="S2.SS2.p4.4.m3.2.2.1.1.1.1.2.cmml">Δ</mi><mo id="S2.SS2.p4.4.m3.2.2.1.1.1.1.1" xref="S2.SS2.p4.4.m3.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p4.4.m3.2.2.1.1.1.1.3" xref="S2.SS2.p4.4.m3.2.2.1.1.1.1.3.cmml">A</mi></mrow><mo id="S2.SS2.p4.4.m3.2.2.1.1.1.3" stretchy="false" xref="S2.SS2.p4.4.m3.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.4.m3.2b"><apply id="S2.SS2.p4.4.m3.2.2.cmml" xref="S2.SS2.p4.4.m3.2.2"><eq id="S2.SS2.p4.4.m3.2.2.2.cmml" xref="S2.SS2.p4.4.m3.2.2.2"></eq><ci id="S2.SS2.p4.4.m3.2.2.3.cmml" xref="S2.SS2.p4.4.m3.2.2.3">𝐴</ci><apply id="S2.SS2.p4.4.m3.2.2.1.2.cmml" xref="S2.SS2.p4.4.m3.2.2.1.1"><exp id="S2.SS2.p4.4.m3.1.1.cmml" xref="S2.SS2.p4.4.m3.1.1"></exp><apply id="S2.SS2.p4.4.m3.2.2.1.1.1.1.cmml" xref="S2.SS2.p4.4.m3.2.2.1.1.1.1"><times id="S2.SS2.p4.4.m3.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p4.4.m3.2.2.1.1.1.1.1"></times><ci id="S2.SS2.p4.4.m3.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p4.4.m3.2.2.1.1.1.1.2">Δ</ci><ci id="S2.SS2.p4.4.m3.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p4.4.m3.2.2.1.1.1.1.3">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.4.m3.2c">A=\exp(\Delta A)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.4.m3.2d">italic_A = roman_exp ( roman_Δ italic_A )</annotation></semantics></math> and <math alttext="B=(\Delta A)^{-1}(\exp(\Delta A)-I)\Delta B" class="ltx_Math" display="inline" id="S2.SS2.p4.5.m4.3"><semantics id="S2.SS2.p4.5.m4.3a"><mrow id="S2.SS2.p4.5.m4.3.3" xref="S2.SS2.p4.5.m4.3.3.cmml"><mi id="S2.SS2.p4.5.m4.3.3.4" xref="S2.SS2.p4.5.m4.3.3.4.cmml">B</mi><mo id="S2.SS2.p4.5.m4.3.3.3" xref="S2.SS2.p4.5.m4.3.3.3.cmml">=</mo><mrow id="S2.SS2.p4.5.m4.3.3.2" xref="S2.SS2.p4.5.m4.3.3.2.cmml"><msup id="S2.SS2.p4.5.m4.2.2.1.1" xref="S2.SS2.p4.5.m4.2.2.1.1.cmml"><mrow id="S2.SS2.p4.5.m4.2.2.1.1.1.1" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.cmml"><mo id="S2.SS2.p4.5.m4.2.2.1.1.1.1.2" stretchy="false" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p4.5.m4.2.2.1.1.1.1.1" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.cmml"><mi id="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.2" mathvariant="normal" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.2.cmml">Δ</mi><mo id="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.1" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.3" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.3.cmml">A</mi></mrow><mo id="S2.SS2.p4.5.m4.2.2.1.1.1.1.3" stretchy="false" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S2.SS2.p4.5.m4.2.2.1.1.3" xref="S2.SS2.p4.5.m4.2.2.1.1.3.cmml"><mo id="S2.SS2.p4.5.m4.2.2.1.1.3a" xref="S2.SS2.p4.5.m4.2.2.1.1.3.cmml">−</mo><mn id="S2.SS2.p4.5.m4.2.2.1.1.3.2" xref="S2.SS2.p4.5.m4.2.2.1.1.3.2.cmml">1</mn></mrow></msup><mo id="S2.SS2.p4.5.m4.3.3.2.3" xref="S2.SS2.p4.5.m4.3.3.2.3.cmml">⁢</mo><mrow id="S2.SS2.p4.5.m4.3.3.2.2.1" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.cmml"><mo id="S2.SS2.p4.5.m4.3.3.2.2.1.2" stretchy="false" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.cmml">(</mo><mrow id="S2.SS2.p4.5.m4.3.3.2.2.1.1" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.cmml"><mrow id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.2.cmml"><mi id="S2.SS2.p4.5.m4.1.1" xref="S2.SS2.p4.5.m4.1.1.cmml">exp</mi><mo id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1a" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.2.cmml"><mo id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.2.cmml">(</mo><mrow id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.2" mathvariant="normal" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.2.cmml">Δ</mi><mo id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.1" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.3.cmml">A</mi></mrow><mo id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p4.5.m4.3.3.2.2.1.1.2" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.2.cmml">−</mo><mi id="S2.SS2.p4.5.m4.3.3.2.2.1.1.3" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.3.cmml">I</mi></mrow><mo id="S2.SS2.p4.5.m4.3.3.2.2.1.3" stretchy="false" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.cmml">)</mo></mrow><mo id="S2.SS2.p4.5.m4.3.3.2.3a" xref="S2.SS2.p4.5.m4.3.3.2.3.cmml">⁢</mo><mi id="S2.SS2.p4.5.m4.3.3.2.4" mathvariant="normal" xref="S2.SS2.p4.5.m4.3.3.2.4.cmml">Δ</mi><mo id="S2.SS2.p4.5.m4.3.3.2.3b" xref="S2.SS2.p4.5.m4.3.3.2.3.cmml">⁢</mo><mi id="S2.SS2.p4.5.m4.3.3.2.5" xref="S2.SS2.p4.5.m4.3.3.2.5.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.5.m4.3b"><apply id="S2.SS2.p4.5.m4.3.3.cmml" xref="S2.SS2.p4.5.m4.3.3"><eq id="S2.SS2.p4.5.m4.3.3.3.cmml" xref="S2.SS2.p4.5.m4.3.3.3"></eq><ci id="S2.SS2.p4.5.m4.3.3.4.cmml" xref="S2.SS2.p4.5.m4.3.3.4">𝐵</ci><apply id="S2.SS2.p4.5.m4.3.3.2.cmml" xref="S2.SS2.p4.5.m4.3.3.2"><times id="S2.SS2.p4.5.m4.3.3.2.3.cmml" xref="S2.SS2.p4.5.m4.3.3.2.3"></times><apply id="S2.SS2.p4.5.m4.2.2.1.1.cmml" xref="S2.SS2.p4.5.m4.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m4.2.2.1.1.2.cmml" xref="S2.SS2.p4.5.m4.2.2.1.1">superscript</csymbol><apply id="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1"><times id="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.1"></times><ci id="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.2">Δ</ci><ci id="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.5.m4.2.2.1.1.1.1.1.3">𝐴</ci></apply><apply id="S2.SS2.p4.5.m4.2.2.1.1.3.cmml" xref="S2.SS2.p4.5.m4.2.2.1.1.3"><minus id="S2.SS2.p4.5.m4.2.2.1.1.3.1.cmml" xref="S2.SS2.p4.5.m4.2.2.1.1.3"></minus><cn id="S2.SS2.p4.5.m4.2.2.1.1.3.2.cmml" type="integer" xref="S2.SS2.p4.5.m4.2.2.1.1.3.2">1</cn></apply></apply><apply id="S2.SS2.p4.5.m4.3.3.2.2.1.1.cmml" xref="S2.SS2.p4.5.m4.3.3.2.2.1"><minus id="S2.SS2.p4.5.m4.3.3.2.2.1.1.2.cmml" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.2"></minus><apply id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.2.cmml" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1"><exp id="S2.SS2.p4.5.m4.1.1.cmml" xref="S2.SS2.p4.5.m4.1.1"></exp><apply id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1"><times id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.1"></times><ci id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.2">Δ</ci><ci id="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.1.1.1.1.3">𝐴</ci></apply></apply><ci id="S2.SS2.p4.5.m4.3.3.2.2.1.1.3.cmml" xref="S2.SS2.p4.5.m4.3.3.2.2.1.1.3">𝐼</ci></apply><ci id="S2.SS2.p4.5.m4.3.3.2.4.cmml" xref="S2.SS2.p4.5.m4.3.3.2.4">Δ</ci><ci id="S2.SS2.p4.5.m4.3.3.2.5.cmml" xref="S2.SS2.p4.5.m4.3.3.2.5">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.5.m4.3c">B=(\Delta A)^{-1}(\exp(\Delta A)-I)\Delta B</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.5.m4.3d">italic_B = ( roman_Δ italic_A ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( roman_exp ( roman_Δ italic_A ) - italic_I ) roman_Δ italic_B</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p5">
<p class="ltx_p" id="S2.SS2.p5.1">Enhancements such as the Structured State Space Model (S4) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib15" title="">15</a>]</cite> and Mamba further optimize SSM. S4 introduces a structured approach to the state transition matrix <math alttext="A" class="ltx_Math" display="inline" id="S2.SS2.p5.1.m1.1"><semantics id="S2.SS2.p5.1.m1.1a"><mi id="S2.SS2.p5.1.m1.1.1" xref="S2.SS2.p5.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.m1.1b"><ci id="S2.SS2.p5.1.m1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.1.m1.1d">italic_A</annotation></semantics></math> using HiPPO techniques <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib26" title="">26</a>]</cite>, improving long-range dependency modeling. Mamba extends S4 by incorporating a data-dependent selection mechanism and a hardware-aware parallel algorithm, maintaining linear complexity while enhancing data handling efficiency.</p>
</div>
<div class="ltx_para" id="S2.SS2.p6">
<p class="ltx_p" id="S2.SS2.p6.1">These developments position SSMs as superior for tasks involving long sequences where computational efficiency is paramount, offering Transformer-level performance with greater scalability and lower resource consumption.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Mamba Block</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">The Mamba block emerges as a novel solution to the aforementioned challenges of catastrophic forgetting, limited ability to handle long-term dependencies, and inference inefficiency in long user behavior sequences or large-scale datasets, leveraging the capabilities of state space models (SSMs) for efficient sequential processing. Originating from the structured state space model (S4) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib15" title="">15</a>]</cite>, the Mamba block introduces a data-dependent selective mechanism, enabling the model to adaptively focus on relevant information while filtering out noise <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib27" title="">27</a>]</cite>. This selective SSM, combined with a hardware-aware parallel algorithm, allows for significant improvements in both computational efficiency and model performance, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S2.F1" title="Figure 1 ‣ 2.3 Mamba Block ‣ 2 Related Work ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. The Mamba block’s efficiency is further enhanced by its linear-time complexity in sequence modeling, offering a compelling alternative to the more computationally demanding Transformer and RNN architectures. By incorporating structured state matrices initialized with HiPPO for improved long-range dependency modeling, the Mamba block demonstrates Transformer-quality performance with greater efficiency, particularly in processing long sequences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib18" title="">18</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><svg class="ltx_picture" height="304.61" id="S2.F1.pic1" overflow="visible" version="1.1" width="389.55"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,304.61) matrix(1 0 0 -1 0 0) translate(1.66,0) translate(0,46.44)"><g fill="#F2F2F2"><path d="M 226.38 0 M 226.38 5.53 L 226.38 191.32 C 226.38 194.37 228.86 196.85 231.91 196.85 L 348.8 196.85 C 351.85 196.85 354.33 194.37 354.33 191.32 L 354.33 5.53 C 354.33 2.48 351.85 0 348.8 0 L 231.91 0 C 228.86 0 226.38 2.48 226.38 5.53 Z M 354.33 196.85"></path></g><g fill="#CCFFCC" stroke="#000000"><path d="M 246.06 9.84 L 275.59 9.84 L 285.43 29.53 L 236.22 29.53 Z"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 251.79 14.96)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.07"><span class="ltx_text" id="S2.F1.pic1.4.4.4.1.1">LP</span></foreignobject></g><g fill="#CCFFCC" stroke="#000000"><path d="M 305.12 9.84 L 334.65 9.84 L 344.49 29.53 L 295.28 29.53 Z"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 310.85 14.96)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.07"><span class="ltx_text" id="S2.F1.pic1.5.5.5.1.1">LP</span></foreignobject></g><g fill="#CCCCFF"><path d="M 231.3 45.78 h 59.06 v 18.68 h -59.06 Z"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 245.07 50.39)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="31.52"><span class="ltx_text" id="S2.F1.pic1.6.6.6.1.1">Conv</span></foreignobject></g><g fill="#FFFFFF"><path d="M 272.25 86.61 C 272.25 92.92 267.13 98.03 260.83 98.03 C 254.52 98.03 249.41 92.92 249.41 86.61 C 249.41 80.31 254.52 75.19 260.83 75.19 C 267.13 75.19 272.25 80.31 272.25 86.61 Z M 260.83 86.61"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 256.87 83.64)"><foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math alttext="\sigma" class="ltx_Math" display="inline" id="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_σ</annotation></semantics></math></foreignobject></g><g fill="#FFFFFF"><path d="M 331.3 86.61 C 331.3 92.92 326.19 98.03 319.88 98.03 C 313.57 98.03 308.46 92.92 308.46 86.61 C 308.46 80.31 313.57 75.19 319.88 75.19 C 326.19 75.19 331.3 80.31 331.3 86.61 Z M 319.88 86.61"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 315.93 83.64)"><foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math alttext="\sigma" class="ltx_Math" display="inline" id="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.F1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_σ</annotation></semantics></math></foreignobject></g><g fill="#CCCCFF"><path d="M 231.3 108.77 h 59.06 v 18.68 h -59.06 Z"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 246.8 113.38)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="28.06"><span class="ltx_text" id="S2.F1.pic1.7.7.7.1.1">SSM</span></foreignobject></g><g fill="#FFFFFF"><path d="M 270.67 145.67 C 270.67 151.11 266.26 155.51 260.83 155.51 C 255.39 155.51 250.98 151.11 250.98 145.67 C 250.98 140.23 255.39 135.83 260.83 135.83 C 266.26 135.83 270.67 140.23 270.67 145.67 Z M 260.83 145.67"></path></g><g stroke-width="0.8pt"><path d="M 253.67 152.82 L 267.98 138.51" style="fill:none"></path></g><g stroke-width="0.8pt"><path d="M 267.98 152.82 L 253.67 138.51" style="fill:none"></path></g><g fill="#CCFFCC" stroke="#000000"><path d="M 246.06 187.01 L 275.59 187.01 L 285.43 167.32 L 236.22 167.32 Z"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 251.79 172.44)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.07"><span class="ltx_text" id="S2.F1.pic1.8.8.8.1.1">LP</span></foreignobject></g><path d="M 260.83 64.73 L 260.83 74.92" style="fill:none"></path><path d="M 260.83 98.31 L 260.83 108.49" style="fill:none"></path><path d="M 260.83 127.73 L 260.83 135.55" style="fill:none"></path><path d="M 260.83 155.79 L 260.83 167.32" style="fill:none"></path><path d="M 260.83 29.53 L 260.83 45.5" style="fill:none"></path><path d="M 319.88 29.53 L 319.88 74.92" style="fill:none"></path><path d="M 319.88 98.31 L 319.88 145.67 L 270.95 145.67" style="fill:none"></path><path d="M 260.83 -9.84 L 260.83 9.84" style="fill:none"></path><path d="M 319.88 9.84 L 319.88 4.72 L 260.83 4.72" style="fill:none"></path><path d="M 260.83 187.01 L 260.83 206.06" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 260.83 206.06)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g fill="#FFFFFF"><path d="M 255.51 220.47 C 255.51 226.78 250.4 231.89 244.09 231.89 C 237.79 231.89 232.67 226.78 232.67 220.47 C 232.67 214.17 237.79 209.05 244.09 209.05 C 250.4 209.05 255.51 214.17 255.51 220.47 Z M 244.09 220.47"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 240.14 217.49)"><foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math alttext="\sigma" class="ltx_Math" display="inline" id="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.F1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_σ</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 264.49 216.22)"><foreignobject height="8.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="85.27"><span class="ltx_text" id="S2.F1.pic1.9.9.9.1.1" style="font-size:90%;">SiLU activation</span></foreignobject></g><g fill="#FFFFFF"><path d="M 253.94 248.03 C 253.94 253.47 249.53 257.87 244.09 257.87 C 238.66 257.87 234.25 253.47 234.25 248.03 C 234.25 242.6 238.66 238.19 244.09 238.19 C 249.53 238.19 253.94 242.6 253.94 248.03 Z M 244.09 248.03"></path></g><g stroke-width="0.8pt"><path d="M 236.94 255.19 L 251.25 240.88" style="fill:none"></path></g><g stroke-width="0.8pt"><path d="M 251.25 255.19 L 236.94 240.88" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 273.36 244.92)"><foreignobject height="11.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="67.49"><span class="ltx_text" id="S2.F1.pic1.10.10.10.1.1" style="font-size:90%;">Nonlinearity</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 317.51 -41.82)"><foreignobject height="24.59" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="65.76">
<span class="ltx_inline-block" id="S2.F1.pic1.11.11.11.1.1">
<span class="ltx_p" id="S2.F1.pic1.11.11.11.1.1.1"><span class="ltx_text" id="S2.F1.pic1.11.11.11.1.1.1.1" style="font-size:90%;">Linear</span></span>
<span class="ltx_p" id="S2.F1.pic1.11.11.11.1.1.2">projection</span>
</span></foreignobject></g><g fill="#CCFFCC" stroke="#000000"><path d="M 221.46 -19.69 L 250.98 -19.69 L 260.83 -39.37 L 211.61 -39.37 Z"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 227.19 -34.26)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.07"><span class="ltx_text" id="S2.F1.pic1.12.12.12.1.1">LP</span></foreignobject></g><g fill="#CCFFCC" stroke="#000000"><path d="M 272.64 -39.37 L 302.17 -39.37 L 312.01 -19.69 L 262.8 -19.69 Z"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 278.37 -34.26)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.07"><span class="ltx_text" id="S2.F1.pic1.13.13.13.1.1">LP</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S2.F1.2.1">Mamba block</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib17" title="">17</a>]</cite></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we showcase our proposed framework, EchoMamba4Rec. We start with a high-level overview of the framework, followed by a detailed examination of its technical components. We explain how EchoMamba4Rec builds a sequential recommendation model using an embedding layer, selective state space models, and a prediction layer. Additionally, we cover key components commonly used in sequential recommendation, such as positional embeddings, feed-forward networks, dropout, and layer normalization.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Model definition</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.8">Consider a user set <math alttext="U=\{u_{1},u_{2},\ldots,u_{|U|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.5"><semantics id="S3.SS1.p1.1.m1.5a"><mrow id="S3.SS1.p1.1.m1.5.5" xref="S3.SS1.p1.1.m1.5.5.cmml"><mi id="S3.SS1.p1.1.m1.5.5.5" xref="S3.SS1.p1.1.m1.5.5.5.cmml">U</mi><mo id="S3.SS1.p1.1.m1.5.5.4" xref="S3.SS1.p1.1.m1.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.5.5.3.3" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml"><mo id="S3.SS1.p1.1.m1.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">{</mo><msub id="S3.SS1.p1.1.m1.3.3.1.1.1" xref="S3.SS1.p1.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.3.3.1.1.1.2" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2.cmml">u</mi><mn id="S3.SS1.p1.1.m1.3.3.1.1.1.3" xref="S3.SS1.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.5.5.3.3.5" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.4.4.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.4.4.2.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.cmml">u</mi><mn id="S3.SS1.p1.1.m1.4.4.2.2.2.3" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.5.5.3.3.6" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2" mathvariant="normal" xref="S3.SS1.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS1.p1.1.m1.5.5.3.3.7" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.5.5.3.3.3" xref="S3.SS1.p1.1.m1.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.5.5.3.3.3.2" xref="S3.SS1.p1.1.m1.5.5.3.3.3.2.cmml">u</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml">U</mi><mo id="S3.SS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.1.m1.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.5b"><apply id="S3.SS1.p1.1.m1.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5"><eq id="S3.SS1.p1.1.m1.5.5.4.cmml" xref="S3.SS1.p1.1.m1.5.5.4"></eq><ci id="S3.SS1.p1.1.m1.5.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5.5">𝑈</ci><set id="S3.SS1.p1.1.m1.5.5.3.4.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3"><apply id="S3.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2">𝑢</ci><cn id="S3.SS1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.4.4.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2">𝑢</ci><cn id="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">…</ci><apply id="S3.SS1.p1.1.m1.5.5.3.3.3.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3.2">𝑢</ci><apply id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3"><abs id="S3.SS1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3.1"></abs><ci id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">𝑈</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.5c">U=\{u_{1},u_{2},\ldots,u_{|U|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.5d">italic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT | italic_U | end_POSTSUBSCRIPT }</annotation></semantics></math> and an item set <math alttext="V=\{v_{1},v_{2},\ldots,v_{|V|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.5"><semantics id="S3.SS1.p1.2.m2.5a"><mrow id="S3.SS1.p1.2.m2.5.5" xref="S3.SS1.p1.2.m2.5.5.cmml"><mi id="S3.SS1.p1.2.m2.5.5.5" xref="S3.SS1.p1.2.m2.5.5.5.cmml">V</mi><mo id="S3.SS1.p1.2.m2.5.5.4" xref="S3.SS1.p1.2.m2.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.5.5.3.3" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml"><mo id="S3.SS1.p1.2.m2.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">{</mo><msub id="S3.SS1.p1.2.m2.3.3.1.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.3.3.1.1.1.2" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml">v</mi><mn id="S3.SS1.p1.2.m2.3.3.1.1.1.3" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.5" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.4.4.2.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml">v</mi><mn id="S3.SS1.p1.2.m2.4.4.2.2.2.3" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.6" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" mathvariant="normal" xref="S3.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.2.m2.5.5.3.3.7" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.3.3.3" xref="S3.SS1.p1.2.m2.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.3.3.3.2" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml">v</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">V</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><apply id="S3.SS1.p1.2.m2.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5"><eq id="S3.SS1.p1.2.m2.5.5.4.cmml" xref="S3.SS1.p1.2.m2.5.5.4"></eq><ci id="S3.SS1.p1.2.m2.5.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5.5">𝑉</ci><set id="S3.SS1.p1.2.m2.5.5.3.4.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3"><apply id="S3.SS1.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2">𝑣</ci><cn id="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.4.4.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2">𝑣</ci><cn id="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">…</ci><apply id="S3.SS1.p1.2.m2.5.5.3.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2">𝑣</ci><apply id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><abs id="S3.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝑉</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">V=\{v_{1},v_{2},\ldots,v_{|V|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.5d">italic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT | italic_V | end_POSTSUBSCRIPT }</annotation></semantics></math>. For each user <math alttext="u\in U" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">u</mi><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑢</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">u\in U</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_u ∈ italic_U</annotation></semantics></math>, their interaction sequence in chronological order is denoted as <math alttext="S_{u}=[v_{1},v_{2},\ldots,v_{n_{u}}]" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.4"><semantics id="S3.SS1.p1.4.m4.4a"><mrow id="S3.SS1.p1.4.m4.4.4" xref="S3.SS1.p1.4.m4.4.4.cmml"><msub id="S3.SS1.p1.4.m4.4.4.5" xref="S3.SS1.p1.4.m4.4.4.5.cmml"><mi id="S3.SS1.p1.4.m4.4.4.5.2" xref="S3.SS1.p1.4.m4.4.4.5.2.cmml">S</mi><mi id="S3.SS1.p1.4.m4.4.4.5.3" xref="S3.SS1.p1.4.m4.4.4.5.3.cmml">u</mi></msub><mo id="S3.SS1.p1.4.m4.4.4.4" xref="S3.SS1.p1.4.m4.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.4.4.3.3" xref="S3.SS1.p1.4.m4.4.4.3.4.cmml"><mo id="S3.SS1.p1.4.m4.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.4.m4.4.4.3.4.cmml">[</mo><msub id="S3.SS1.p1.4.m4.2.2.1.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS1.p1.4.m4.2.2.1.1.1.3" xref="S3.SS1.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.4.m4.4.4.3.3.5" xref="S3.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.4.m4.3.3.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.3.3.2.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.2.cmml">v</mi><mn id="S3.SS1.p1.4.m4.3.3.2.2.2.3" xref="S3.SS1.p1.4.m4.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.4.m4.4.4.3.3.6" xref="S3.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S3.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS1.p1.4.m4.4.4.3.3.7" xref="S3.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.4.m4.4.4.3.3.3" xref="S3.SS1.p1.4.m4.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.4.m4.4.4.3.3.3.2" xref="S3.SS1.p1.4.m4.4.4.3.3.3.2.cmml">v</mi><msub id="S3.SS1.p1.4.m4.4.4.3.3.3.3" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p1.4.m4.4.4.3.3.3.3.2" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3.2.cmml">n</mi><mi id="S3.SS1.p1.4.m4.4.4.3.3.3.3.3" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3.3.cmml">u</mi></msub></msub><mo id="S3.SS1.p1.4.m4.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.4.m4.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.4b"><apply id="S3.SS1.p1.4.m4.4.4.cmml" xref="S3.SS1.p1.4.m4.4.4"><eq id="S3.SS1.p1.4.m4.4.4.4.cmml" xref="S3.SS1.p1.4.m4.4.4.4"></eq><apply id="S3.SS1.p1.4.m4.4.4.5.cmml" xref="S3.SS1.p1.4.m4.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.4.5.1.cmml" xref="S3.SS1.p1.4.m4.4.4.5">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.4.5.2.cmml" xref="S3.SS1.p1.4.m4.4.4.5.2">𝑆</ci><ci id="S3.SS1.p1.4.m4.4.4.5.3.cmml" xref="S3.SS1.p1.4.m4.4.4.5.3">𝑢</ci></apply><list id="S3.SS1.p1.4.m4.4.4.3.4.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3"><apply id="S3.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2">𝑣</ci><cn id="S3.SS1.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2.2">𝑣</ci><cn id="S3.SS1.p1.4.m4.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">…</ci><apply id="S3.SS1.p1.4.m4.4.4.3.3.3.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3.2">𝑣</ci><apply id="S3.SS1.p1.4.m4.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3.2">𝑛</ci><ci id="S3.SS1.p1.4.m4.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.3.3.3">𝑢</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.4c">S_{u}=[v_{1},v_{2},\ldots,v_{n_{u}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.4d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="n_{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">n</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑛</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">n_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the length of the sequence. Given the interaction history <math alttext="S_{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">S</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑆</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, the standard task is to predict the next item <math alttext="v_{n_{u}+1}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">v</mi><mrow id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><msub id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2.2" xref="S3.SS1.p1.7.m7.1.1.3.2.2.cmml">n</mi><mi id="S3.SS1.p1.7.m7.1.1.3.2.3" xref="S3.SS1.p1.7.m7.1.1.3.2.3.cmml">u</mi></msub><mo id="S3.SS1.p1.7.m7.1.1.3.1" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑣</ci><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><plus id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.1"></plus><apply id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2.2">𝑛</ci><ci id="S3.SS1.p1.7.m7.1.1.3.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2.3">𝑢</ci></apply><cn id="S3.SS1.p1.7.m7.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">v_{n_{u}+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT</annotation></semantics></math> that user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_u</annotation></semantics></math> will interact with.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Framework Overview</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">As illustrated in the Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S3.F2" title="Figure 2 ‣ 3.2 Framework Overview ‣ 3 Methodology ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, the proposed EchoMamba4Rec is a sequential recommendation model that leverages selective state space models through Mamba blocks. The core element of EchoMamba4Rec is the Mamba layer, which combines a Mamba block with a position-wise feed-forward network. EchoMamba4Rec offers flexibility in its bidirectional architecture: it can be constructed by flexibly combining different types of recurrent neural network (RNN), long short-term memory network (LSTM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib28" title="">28</a>]</cite>, gated recurrent unit (GRU) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib29" title="">29</a>]</cite> and other structures according to task requirements and data characteristics to adapt to different scenarios and data characteristics. Each layer comprises a Mamba block followed by a gate linear unit (GLU), enabling the model to capture both item-specific information and sequential context effectively from the user’s interaction history.</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_inline-block ltx_transformed_outer" id="S3.F2.1" style="width:433.6pt;height:303.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(21.5pt,-15.0pt) scale(1.10988089225805,1.10988089225805) ;"><svg class="ltx_picture" height="378.51" id="S3.F2.1.pic1" overflow="visible" version="1.1" width="535.99"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,378.51) matrix(1 0 0 -1 0 0) translate(165.63,0) translate(0,90.83)"><g fill="#CCCCFF"><path d="M 39.37 -78.74 M 39.37 -73.21 L 39.37 -64.59 C 39.37 -61.53 41.85 -59.06 44.9 -59.06 L 151.95 -59.06 C 155 -59.06 157.48 -61.53 157.48 -64.59 L 157.48 -73.21 C 157.48 -76.26 155 -78.74 151.95 -78.74 L 44.9 -78.74 C 41.85 -78.74 39.37 -76.26 39.37 -73.21 Z M 157.48 -59.06"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 44.98 -72.36)"><foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="106.89"><span class="ltx_text" id="S3.F2.1.pic1.12.12.12.1.1">Embedding Layer</span></foreignobject></g><g fill="#CCCCFF"><path d="M 39.37 255.91 M 39.37 261.44 L 39.37 270.06 C 39.37 273.11 41.85 275.59 44.9 275.59 L 151.95 275.59 C 155 275.59 157.48 273.11 157.48 270.06 L 157.48 261.44 C 157.48 258.38 155 255.91 151.95 255.91 L 44.9 255.91 C 41.85 255.91 39.37 258.38 39.37 261.44 Z M 157.48 275.59"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 48.04 262.29)"><foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="101.16"><span class="ltx_text" id="S3.F2.1.pic1.13.13.13.1.1">Prediction Layer</span></foreignobject></g><g fill="#F2F2F2"><path d="M -15.75 -31.5 M -15.75 -25.96 L -15.75 238.56 C -15.75 241.62 -13.27 244.09 -10.21 244.09 L 191.32 244.09 C 194.37 244.09 196.85 241.62 196.85 238.56 L 196.85 -25.96 C 196.85 -29.02 194.37 -31.5 191.32 -31.5 L -10.21 -31.5 C -13.27 -31.5 -15.75 -29.02 -15.75 -25.96 Z M 196.85 244.09"></path></g><g fill="#F2F2F2"><path d="M -7.87 -39.37 M -7.87 -33.84 L -7.87 230.69 C -7.87 233.74 -5.4 236.22 -2.34 236.22 L 199.19 236.22 C 202.25 236.22 204.72 233.74 204.72 230.69 L 204.72 -33.84 C 204.72 -36.89 202.25 -39.37 199.19 -39.37 L -2.34 -39.37 C -5.4 -39.37 -7.87 -36.89 -7.87 -33.84 Z M 204.72 236.22"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 186.57 247.24)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.56"><span class="ltx_text" id="S3.F2.1.pic1.14.14.14.1.1">x L</span></foreignobject></g><g fill="#FFEB80"><path d="M 151.95 -3.02 L 44.9 -3.02 C 41.85 -3.02 39.37 -5.5 39.37 -8.55 L 39.37 -19.01 C 39.37 -22.06 41.85 -24.54 44.9 -24.54 L 151.95 -24.54 C 155 -24.54 157.48 -22.06 157.48 -19.01 L 157.48 -8.55 C 157.48 -5.5 155 -3.02 151.95 -3.02 Z M 39.37 -24.54"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 62.45 -17.24)"><foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="72.34"><span class="ltx_text" id="S3.F2.1.pic1.15.15.15.1.1">Filter Layer</span></foreignobject></g><g fill="#FFFFB3"><path d="M 137.5 225.95 L 59.36 225.95 C 56.3 225.95 53.82 223.47 53.82 220.42 L 53.82 212.65 C 53.82 209.6 56.3 207.12 59.36 207.12 L 137.5 207.12 C 140.55 207.12 143.03 209.6 143.03 212.65 L 143.03 220.42 C 143.03 223.47 140.55 225.95 137.5 225.95 Z M 53.82 207.12"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 58.43 211.73)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S3.F2.1.pic1.16.16.16.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#ECB3C6"><path d="M 122.42 186.5 L 74.43 186.5 C 71.38 186.5 68.9 184.03 68.9 180.97 L 68.9 173.36 C 68.9 170.3 71.38 167.83 74.43 167.83 L 122.42 167.83 C 125.47 167.83 127.95 170.3 127.95 173.36 L 127.95 180.97 C 127.95 184.03 125.47 186.5 122.42 186.5 Z M 68.9 167.83"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 83.48 172.44)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="29.88"><span class="ltx_text" id="S3.F2.1.pic1.17.17.17.1.1">GLU</span></foreignobject></g><g fill="#FFFFB3"><path d="M 86.31 123.59 L 8.17 123.59 C 5.12 123.59 2.64 121.11 2.64 118.05 L 2.64 110.29 C 2.64 107.23 5.12 104.76 8.17 104.76 L 86.31 104.76 C 89.37 104.76 91.85 107.23 91.85 110.29 L 91.85 118.05 C 91.85 121.11 89.37 123.59 86.31 123.59 Z M 2.64 104.76"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 7.25 109.37)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S3.F2.1.pic1.18.18.18.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#FFFFB3"><path d="M 188.68 123.59 L 110.54 123.59 C 107.48 123.59 105 121.11 105 118.05 L 105 110.29 C 105 107.23 107.48 104.76 110.54 104.76 L 188.68 104.76 C 191.73 104.76 194.21 107.23 194.21 110.29 L 194.21 118.05 C 194.21 121.11 191.73 123.59 188.68 123.59 Z M 105 104.76"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 109.61 109.37)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S3.F2.1.pic1.19.19.19.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#FFCCCC"><path d="M 71.24 72.41 L 23.25 72.41 C 20.19 72.41 17.72 69.93 17.72 66.87 L 17.72 59.11 C 17.72 56.05 20.19 53.58 23.25 53.58 L 71.24 53.58 C 74.29 53.58 76.77 56.05 76.77 59.11 L 76.77 66.87 C 76.77 69.93 74.29 72.41 71.24 72.41 Z M 17.72 53.58"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 24.57 58.19)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="45.74"><span class="ltx_text" id="S3.F2.1.pic1.20.20.20.1.1">Mamba</span></foreignobject></g><g fill="#FFCCCC"><path d="M 173.6 72.41 L 125.61 72.41 C 122.56 72.41 120.08 69.93 120.08 66.87 L 120.08 59.11 C 120.08 56.05 122.56 53.58 125.61 53.58 L 173.6 53.58 C 176.66 53.58 179.13 56.05 179.13 59.11 L 179.13 66.87 C 179.13 69.93 176.66 72.41 173.6 72.41 Z M 120.08 53.58"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 126.93 58.19)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="45.74"><span class="ltx_text" id="S3.F2.1.pic1.21.21.21.1.1">Mamba</span></foreignobject></g><g fill="#FFFFFF"><path d="M 106.3 144.49 C 106.3 148.84 102.77 152.36 98.43 152.36 C 94.08 152.36 90.55 148.84 90.55 144.49 C 90.55 140.14 94.08 136.61 98.43 136.61 C 102.77 136.61 106.3 140.14 106.3 144.49 Z M 98.43 144.49"></path></g><path d="M 149.61 32.28 L 149.61 52.66" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 149.61 52.66)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 72.69 L 47.24 103.84" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 47.24 103.84)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 186.78 L 98.43 206.21" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 206.21)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 32.28 L 47.24 32.28 L 47.24 52.66" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 47.24 52.66)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 -2.74 L 98.43 13.78" style="fill:none"></path><path d="M 98.43 225.2 L 98.43 255.27" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 255.27)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 123.87 L 47.24 144.49 L 89.64 144.49" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 89.64 144.49)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 149.61 123.87 L 149.61 144.49 L 107.21 144.49" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 107.21 144.49)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 136.22 L 98.43 167.87" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 167.87)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 86.61 144.49 L 110.24 144.49" style="fill:none"></path><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 13.78 L 98.43 114.17 L 92.76 114.17" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 92.76 114.17)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 13.78 L 98.43 114.17 L 104.09 114.17" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 104.09 114.17)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 157.48 L 149.61 157.48" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 149.61 157.48 L 149.61 216.54 L 143.94 216.54" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 143.94 216.54)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 -59.06 L 98.43 -25.45" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 -25.45)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 -90.55 L 98.43 -79.38" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 -79.38)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 275.59 L 98.43 286.77" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 286.77)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 13.78 L 47.24 13.78 L 47.24 24.41" style="fill:none"></path><path d="M 98.43 13.78 L 149.61 13.78 L 149.61 24.41" style="fill:none"></path><path d="M 149.61 72.69 L 149.61 103.84" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 149.61 103.84)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 18.63 26.41)"><foreignobject height="11.21" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="57.22"><math alttext="v_{1},v_{2},\ldots,v_{n_{u}}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4"><semantics id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4a"><mrow id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml"><msub id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml"><mi id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml">v</mi><mn id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.4" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml"><mi id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml">v</mi><mn id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.5" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><mi id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">…</mi><mo id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.6" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml"><mi id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml">v</mi><msub id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml"><mi id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2.cmml">n</mi><mi id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3" mathsize="90%" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3.cmml">u</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4b"><list id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3"><apply id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.1.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2">𝑣</ci><cn id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.1.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2">𝑣</ci><cn id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3">2</cn></apply><ci id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">…</ci><apply id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.1.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2">𝑣</ci><apply id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.1.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2">𝑛</ci><ci id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3.cmml" xref="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3">𝑢</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4c">v_{1},v_{2},\ldots,v_{n_{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 122.96 26.41)"><foreignobject height="11.21" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="57.22"><math alttext="v_{n_{u}},\ldots,v_{2},v_{1}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4"><semantics id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4a"><mrow id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml"><msub id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml"><mi id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml">v</mi><msub id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml"><mi id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2.cmml">n</mi><mi id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3.cmml">u</mi></msub></msub><mo id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.4" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><mi id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">…</mi><mo id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.5" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml"><mi id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml">v</mi><mn id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.6" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml"><mi id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml">v</mi><mn id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3" mathsize="90%" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4b"><list id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3"><apply id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.1.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2">𝑣</ci><apply id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.1.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2">𝑛</ci><ci id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3">𝑢</ci></apply></apply><ci id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">…</ci><apply id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.1.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2">𝑣</ci><cn id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3">2</cn></apply><apply id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.1.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2">𝑣</ci><cn id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml" type="integer" xref="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3">1</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4c">v_{n_{u}},\ldots,v_{2},v_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4d">italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 153.95 81.89)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.82"><span class="ltx_text" id="S3.F2.1.pic1.22.22.22.1.1">Reverse</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 153.95 9.05)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.82"><span class="ltx_text" id="S3.F2.1.pic1.23.23.23.1.1">Reverse</span></foreignobject></g><g fill="#F2F2F2"><path d="M 226.38 106.3 M 226.38 111.83 L 226.38 216.91 C 226.38 219.96 228.86 222.44 231.91 222.44 L 364.54 222.44 C 367.6 222.44 370.08 219.96 370.08 216.91 L 370.08 111.83 C 370.08 108.78 367.6 106.3 364.54 106.3 L 231.91 106.3 C 228.86 106.3 226.38 108.78 226.38 111.83 Z M 370.08 222.44"></path></g><g fill="#FFD9B3"><path d="M 324.36 165.64 L 274.07 165.64 C 271.01 165.64 268.53 163.16 268.53 160.11 L 268.53 151.7 C 268.53 148.65 271.01 146.17 274.07 146.17 L 324.36 146.17 C 327.42 146.17 329.89 148.65 329.89 151.7 L 329.89 160.11 C 329.89 163.16 327.42 165.64 324.36 165.64 Z M 268.53 146.17"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 273.14 152.53)"><foreignobject height="10.25" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="52.14"><span class="ltx_text" id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2" style="font-size:70%;">A=<math alttext="{Y}_{t}^{final}{W}_{1}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><msubsup id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml"><mi id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.2" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.2.cmml">Y</mi><mi id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.3" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.3.cmml">t</mi><mrow id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml"><mi id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2.cmml">f</mi><mo id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3.cmml">i</mi><mo id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1a" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.4" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.4.cmml">n</mi><mo id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1b" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.5" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.5.cmml">a</mi><mo id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1c" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.6" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.6.cmml">l</mi></mrow></msubsup><mo id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">⁢</mo><msub id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml">W</mi><mn id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><times id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1"></times><apply id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">superscript</csymbol><apply id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.1.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.2.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.2">𝑌</ci><ci id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.3.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.3">𝑡</ci></apply><apply id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3"><times id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1"></times><ci id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2">𝑓</ci><ci id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3">𝑖</ci><ci id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.4.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.4">𝑛</ci><ci id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.5.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.5">𝑎</ci><ci id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.6.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">subscript</csymbol><ci id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2">𝑊</ci><cn id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">{Y}_{t}^{final}{W}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>+<math alttext="{b}_{1}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1"><semantics id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1a"><msub id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1" xref="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml"><mi id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2" xref="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2.cmml">b</mi><mn id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3" xref="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1b"><apply id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.1.cmml" xref="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1">subscript</csymbol><ci id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2.cmml" xref="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2">𝑏</ci><cn id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3.cmml" type="integer" xref="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1c">{b}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.2.2.2.2.2.2.2.2.2.2.2.m2.1d">italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></span></foreignobject></g><g fill="#ECB3C6"><path d="M 333.05 141.12 L 265.38 141.12 C 262.32 141.12 259.84 138.64 259.84 135.59 L 259.84 124.26 C 259.84 121.2 262.32 118.72 265.38 118.72 L 333.05 118.72 C 336.1 118.72 338.58 121.2 338.58 124.26 L 338.58 135.59 C 338.58 138.64 336.1 141.12 333.05 141.12 Z M 259.84 118.72"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 265.95 125.58)"><foreignobject height="13.18" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="66.52"><span class="ltx_text" id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2" style="font-size:90%;">B=<math alttext="{Y}_{t}^{final}{W}_{2}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><msubsup id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml"><mi id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.2" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.2.cmml">Y</mi><mi id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.3" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.3.cmml">t</mi><mrow id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml"><mi id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2.cmml">f</mi><mo id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3.cmml">i</mi><mo id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1a" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.4" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.4.cmml">n</mi><mo id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1b" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.5" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.5.cmml">a</mi><mo id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1c" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.6" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.6.cmml">l</mi></mrow></msubsup><mo id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">⁢</mo><msub id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml">W</mi><mn id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><times id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1"></times><apply id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">superscript</csymbol><apply id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.1.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.2.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.2">𝑌</ci><ci id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.3.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.3">𝑡</ci></apply><apply id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3"><times id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1"></times><ci id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2">𝑓</ci><ci id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3">𝑖</ci><ci id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.4.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.4">𝑛</ci><ci id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.5.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.5">𝑎</ci><ci id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.6.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">subscript</csymbol><ci id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.2">𝑊</ci><cn id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1c">{Y}_{t}^{final}{W}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>+<math alttext="{b}_{2}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1"><semantics id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1a"><msub id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1" xref="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml"><mi id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2" xref="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2.cmml">b</mi><mn id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3" xref="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1b"><apply id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.1.cmml" xref="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1">subscript</csymbol><ci id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2.cmml" xref="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.2">𝑏</ci><cn id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3.cmml" type="integer" xref="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1c">{b}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.2.2.m2.1d">italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></span></foreignobject></g><g fill="#FFFFFF"><path d="M 350 204.72 C 350 211.03 344.89 216.14 338.58 216.14 C 332.28 216.14 327.16 211.03 327.16 204.72 C 327.16 198.42 332.28 193.3 338.58 193.3 C 344.89 193.3 350 198.42 350 204.72 Z M 338.58 204.72"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 334.63 201.75)"><foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math alttext="\sigma" class="ltx_Math" display="inline" id="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_σ</annotation></semantics></math></foreignobject></g><g fill="#FFFFFF"><path d="M 309.06 204.72 C 309.06 210.16 304.65 214.57 299.21 214.57 C 293.78 214.57 289.37 210.16 289.37 204.72 C 289.37 199.29 293.78 194.88 299.21 194.88 C 304.65 194.88 309.06 199.29 309.06 204.72 Z M 299.21 204.72"></path></g><g stroke-width="0.8pt"><path d="M 292.06 211.88 L 306.37 197.57" style="fill:none"></path></g><g stroke-width="0.8pt"><path d="M 306.37 211.88 L 292.06 197.57" style="fill:none"></path></g><path d="M 299.21 165.92 L 299.21 193.97" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 299.21 193.97)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 234.25 98.43 L 234.25 142.91 L 245.82 142.91" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 245.82 142.91)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 338.86 129.92 L 362.2 129.92" style="fill:none"></path><path d="M 362.2 129.92 L 362.2 204.72 L 350.28 204.72" style="fill:none"></path><path d="M 326.89 204.72 L 309.97 204.72" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 309.97 204.72)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 299.21 214.84 L 299.21 235.58" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 299.21 235.58)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g fill="#FFFFFF"><path d="M 255.51 78.74 C 255.51 85.05 250.4 90.16 244.09 90.16 C 237.79 90.16 232.67 85.05 232.67 78.74 C 232.67 72.43 237.79 67.32 244.09 67.32 C 250.4 67.32 255.51 72.43 255.51 78.74 Z M 244.09 78.74"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 240.14 75.76)"><foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math alttext="\sigma" class="ltx_Math" display="inline" id="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_σ</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 268.78 75.63)"><foreignobject height="11.07" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="92.36"><span class="ltx_text" id="S3.F2.1.pic1.24.24.24.1.1" style="font-size:90%;">Sigmoid function</span></foreignobject></g><g fill="#FFFFFF"><path d="M 253.94 51.18 C 253.94 56.62 249.53 61.02 244.09 61.02 C 238.66 61.02 234.25 56.62 234.25 51.18 C 234.25 45.75 238.66 41.34 244.09 41.34 C 249.53 41.34 253.94 45.75 253.94 51.18 Z M 244.09 51.18"></path></g><g stroke-width="0.8pt"><path d="M 236.94 58.34 L 251.25 44.03" style="fill:none"></path></g><g stroke-width="0.8pt"><path d="M 251.25 58.34 L 236.94 44.03" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 275.01 39.25)"><foreignobject height="23.87" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.91">
<span class="ltx_inline-block" id="S3.F2.1.pic1.25.25.25.1.1">
<span class="ltx_p" id="S3.F2.1.pic1.25.25.25.1.1.1"><span class="ltx_text" id="S3.F2.1.pic1.25.25.25.1.1.1.1" style="font-size:90%;">Element-wise</span></span>
<span class="ltx_p" id="S3.F2.1.pic1.25.25.25.1.1.2"><span class="ltx_text" id="S3.F2.1.pic1.25.25.25.1.1.2.1" style="font-size:90%;">multiplication</span></span>
</span></foreignobject></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 226.38 106.3 L 127.95 169.29" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 226.38 222.44 L 127.95 185.04" style="fill:none"></path></g><g fill="#F2F2F2"><path d="M -157.48 -59.06 M -157.48 -53.52 L -157.48 171.63 C -157.48 174.69 -155 177.17 -151.95 177.17 L -44.9 177.17 C -41.85 177.17 -39.37 174.69 -39.37 171.63 L -39.37 -53.52 C -39.37 -56.58 -41.85 -59.06 -44.9 -59.06 L -151.95 -59.06 C -155 -59.06 -157.48 -56.58 -157.48 -53.52 Z M -39.37 177.17"></path></g><g fill="#ECB3C6"><path d="M -64.59 166.82 L -132.26 166.82 C -135.32 166.82 -137.8 164.34 -137.8 161.29 L -137.8 153.68 C -137.8 150.62 -135.32 148.14 -132.26 148.14 L -64.59 148.14 C -61.53 148.14 -59.06 150.62 -59.06 153.68 L -59.06 161.29 C -59.06 164.34 -61.53 166.82 -64.59 166.82 Z M -137.8 148.14"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -113.37 152.75)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="29.88"><span class="ltx_text" id="S3.F2.1.pic1.26.26.26.1.1">GLU</span></foreignobject></g><g fill="#FFFFB3"><path d="M -59.36 127.53 L -137.5 127.53 C -140.55 127.53 -143.03 125.05 -143.03 121.99 L -143.03 114.23 C -143.03 111.17 -140.55 108.69 -137.5 108.69 L -59.36 108.69 C -56.3 108.69 -53.82 111.17 -53.82 114.23 L -53.82 121.99 C -53.82 125.05 -56.3 127.53 -59.36 127.53 Z M -143.03 108.69"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -138.42 113.31)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S3.F2.1.pic1.27.27.27.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#FFEB80"><path d="M -61.82 80.21 L -135.04 80.21 C -138.09 80.21 -140.57 77.73 -140.57 74.67 L -140.57 67.06 C -140.57 64 -138.09 61.53 -135.04 61.53 L -61.82 61.53 C -58.76 61.53 -56.28 64 -56.28 67.06 L -56.28 74.67 C -56.28 77.73 -58.76 80.21 -61.82 80.21 Z M -140.57 61.53"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -135.96 66.14)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="75.45"><span class="ltx_text" id="S3.F2.1.pic1.28.28.28.1.1">Inverse FFT</span></foreignobject></g><g fill="#D9B3D9"><path d="M -50.5 31.42 L -146.35 31.42 C -149.41 31.42 -151.89 28.94 -151.89 25.89 L -151.89 1.67 C -151.89 -1.38 -149.41 -3.86 -146.35 -3.86 L -50.5 -3.86 C -47.44 -3.86 -44.96 -1.38 -44.96 1.67 L -44.96 25.89 C -44.96 28.94 -47.44 31.42 -50.5 31.42 Z M -151.89 -3.86"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -147.28 0.75)"><foreignobject height="26.06" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="97.7">
<span class="ltx_inline-block" id="S3.F2.1.pic1.29.29.29.1.1">
<span class="ltx_p" id="S3.F2.1.pic1.29.29.29.1.1.1">Multiple</span>
<span class="ltx_p" id="S3.F2.1.pic1.29.29.29.1.1.2">Learnable Filter</span>
</span></foreignobject></g><g fill="#FFEB80"><path d="M -64.59 -30.03 L -132.26 -30.03 C -135.32 -30.03 -137.8 -32.51 -137.8 -35.57 L -137.8 -43.17 C -137.8 -46.23 -135.32 -48.71 -132.26 -48.71 L -64.59 -48.71 C -61.53 -48.71 -59.06 -46.23 -59.06 -43.17 L -59.06 -35.57 C -59.06 -32.51 -61.53 -30.03 -64.59 -30.03 Z M -137.8 -48.71"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -112.45 -44.1)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="28.06"><span class="ltx_text" id="S3.F2.1.pic1.30.30.30.1.1">FFT</span></foreignobject></g><path d="M -98.43 -29.75 L -98.43 -4.78" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 -98.43 -4.78)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M -98.43 31.7 L -98.43 60.61" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 -98.43 60.61)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M -98.43 80.48 L -98.43 107.78" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 -98.43 107.78)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M -98.43 127.8 L -98.43 147.23" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 -98.43 147.23)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M -98.43 -66.93 L -98.43 -49.62" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 -98.43 -49.62)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M -98.43 -66.93 L -165.35 -66.93" style="fill:none"></path><path d="M -165.35 -66.93 L -165.35 118.11 L -143.94 118.11" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 -143.94 118.11)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M -98.43 167.1 L -98.43 192.91 L -97.79 192.91" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 -99.06 192.91)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M -39.37 177.17 L 43.31 -3.94" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M -39.37 -59.06 L 43.31 -19.69" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -87.63 88.28)"><foreignobject height="12.41" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="9.91"><math alttext="\tilde{F}^{l}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1a"><msup id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mover accent="true" id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml"><mi id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.2" mathsize="90%" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml">F</mi><mo id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.1" mathsize="90%" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3" mathsize="90%" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><apply id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2"><ci id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.1">~</ci><ci id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.2">𝐹</ci></apply><ci id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1c">\tilde{F}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1d">over~ start_ARG italic_F end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -87.63 41.04)"><foreignobject height="12.41" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="9.91"><math alttext="\tilde{X}^{l}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1a"><msup id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mover accent="true" id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml"><mi id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.2" mathsize="90%" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml">X</mi><mo id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.1" mathsize="90%" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.3" mathsize="90%" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><apply id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2"><ci id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.1">~</ci><ci id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.2.2">𝑋</ci></apply><ci id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1c">\tilde{X}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1d">over~ start_ARG italic_X end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 -89.43 -21.21)"><foreignobject height="10.93" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="13.51"><math alttext="X^{l}" class="ltx_Math" display="inline" id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1a"><msup id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.2" mathsize="90%" xref="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">X</mi><mi id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.3" mathsize="90%" xref="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑋</ci><ci id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1c">X^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.1.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1d">italic_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></foreignobject></g></g></svg>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S3.F2.3.1">EchoMamba4Rec</span>. The process starts with embedding user information using an recommendation embedding layer. Next, a filter layer was utilized to extracts essential sequence information. This filtered data is then processed by the bi-directional EchoMamba block, handling sequences in both forward and reverse directions. A Gated Linear Unit (GLU) is used to dynamically control information flow, enhancing the model’s expressiveness and stability. The final step involves combining and normalizing the processed data before generating the sequential recommendation output. Compared to Mamba4Rec, our model places greater emphasis on extracting sequence features while reducing noise, thereby improving model accuracy and robustness.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Embedding Layer</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.6">Our method employs an embedding layer to project item IDs into a high-dimensional space. This embedding layer utilizes a learnable embedding matrix <math alttext="\mathbf{E}\in\mathbb{R}^{|V|\times D}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.2" xref="S3.SS3.p1.1.m1.1.2.cmml"><mi id="S3.SS3.p1.1.m1.1.2.2" xref="S3.SS3.p1.1.m1.1.2.2.cmml">𝐄</mi><mo id="S3.SS3.p1.1.m1.1.2.1" xref="S3.SS3.p1.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS3.p1.1.m1.1.2.3" xref="S3.SS3.p1.1.m1.1.2.3.cmml"><mi id="S3.SS3.p1.1.m1.1.2.3.2" xref="S3.SS3.p1.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml"><mrow id="S3.SS3.p1.1.m1.1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.1.3.1.cmml"><mo id="S3.SS3.p1.1.m1.1.1.1.3.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.1.3.1.1.cmml">|</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml">V</mi><mo id="S3.SS3.p1.1.m1.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.SS3.p1.1.m1.1.1.1.2" rspace="0.222em" xref="S3.SS3.p1.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.SS3.p1.1.m1.1.1.1.4" xref="S3.SS3.p1.1.m1.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.2"><in id="S3.SS3.p1.1.m1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.2.1"></in><ci id="S3.SS3.p1.1.m1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.2.2">𝐄</ci><apply id="S3.SS3.p1.1.m1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.2.3.1.cmml" xref="S3.SS3.p1.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.2.3.2.cmml" xref="S3.SS3.p1.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1"><times id="S3.SS3.p1.1.m1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.2"></times><apply id="S3.SS3.p1.1.m1.1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.3.2"><abs id="S3.SS3.p1.1.m1.1.1.1.3.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.3.2.1"></abs><ci id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">𝑉</ci></apply><ci id="S3.SS3.p1.1.m1.1.1.1.4.cmml" xref="S3.SS3.p1.1.m1.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathbf{E}\in\mathbb{R}^{|V|\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">bold_E ∈ blackboard_R start_POSTSUPERSCRIPT | italic_V | × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_D</annotation></semantics></math> denotes the embedding dimension. By applying the embedding layer to the input item sequence <math alttext="S_{u}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">S</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑆</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, we obtain the initial item embeddings <math alttext="\mathbf{H}_{o}\in\mathbb{R}^{n_{u}\times D}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><msub id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2.2" xref="S3.SS3.p1.4.m4.1.1.2.2.cmml">𝐇</mi><mi id="S3.SS3.p1.4.m4.1.1.2.3" xref="S3.SS3.p1.4.m4.1.1.2.3.cmml">o</mi></msub><mo id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml"><msub id="S3.SS3.p1.4.m4.1.1.3.3.2" xref="S3.SS3.p1.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.3.2.2" xref="S3.SS3.p1.4.m4.1.1.3.3.2.2.cmml">n</mi><mi id="S3.SS3.p1.4.m4.1.1.3.3.2.3" xref="S3.SS3.p1.4.m4.1.1.3.3.2.3.cmml">u</mi></msub><mo id="S3.SS3.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p1.4.m4.1.1.3.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><in id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1"></in><apply id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2">𝐇</ci><ci id="S3.SS3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3">𝑜</ci></apply><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3"><times id="S3.SS3.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.1"></times><apply id="S3.SS3.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.2.2">𝑛</ci><ci id="S3.SS3.p1.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.2.3">𝑢</ci></apply><ci id="S3.SS3.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\mathbf{H}_{o}\in\mathbb{R}^{n_{u}\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">bold_H start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="n_{u}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">n</mi><mi id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝑛</ci><ci id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">n_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the number of items in the sequence for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_u</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">To improve robustness and prevent overfitting, we apply dropout to these embeddings. Dropout is a regularization technique that randomly sets a fraction of the input units to zero at each update during training, which helps to prevent the model from becoming too sensitive to the specific weights of neurons. The dropout rate determines the fraction of neurons to drop, typically set between 0.2 and 0.5.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">After applying dropout, we normalize the embeddings using layer normalization. Layer normalization standardizes the activations of the previous layer for each individual data point, which helps stabilize and accelerate training by reducing internal covariate shift. The resulting embeddings <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">bold_H</annotation></semantics></math> are computed as follows:</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{H}=\text{LayerNorm}(\text{Dropout}(\mathbf{H}_{o}))\in\mathbb{R}^{n_{u%
}\times D}." class="ltx_Math" display="block" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml">𝐇</mi><mo id="S3.Ex1.m1.1.1.1.1.4" xref="S3.Ex1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3a.cmml">Dropout</mtext><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐇</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">o</mi></msub><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.5" xref="S3.Ex1.m1.1.1.1.1.5.cmml">∈</mo><msup id="S3.Ex1.m1.1.1.1.1.6" xref="S3.Ex1.m1.1.1.1.1.6.cmml"><mi id="S3.Ex1.m1.1.1.1.1.6.2" xref="S3.Ex1.m1.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="S3.Ex1.m1.1.1.1.1.6.3" xref="S3.Ex1.m1.1.1.1.1.6.3.cmml"><msub id="S3.Ex1.m1.1.1.1.1.6.3.2" xref="S3.Ex1.m1.1.1.1.1.6.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.6.3.2.2" xref="S3.Ex1.m1.1.1.1.1.6.3.2.2.cmml">n</mi><mi id="S3.Ex1.m1.1.1.1.1.6.3.2.3" xref="S3.Ex1.m1.1.1.1.1.6.3.2.3.cmml">u</mi></msub><mo id="S3.Ex1.m1.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.1.1.1.1.6.3.1.cmml">×</mo><mi id="S3.Ex1.m1.1.1.1.1.6.3.3" xref="S3.Ex1.m1.1.1.1.1.6.3.3.cmml">D</mi></mrow></msup></mrow><mo id="S3.Ex1.m1.1.1.1.2" lspace="0em" xref="S3.Ex1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><and id="S3.Ex1.m1.1.1.1.1a.cmml" xref="S3.Ex1.m1.1.1.1"></and><apply id="S3.Ex1.m1.1.1.1.1b.cmml" xref="S3.Ex1.m1.1.1.1"><eq id="S3.Ex1.m1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.1.1.1.1.4"></eq><ci id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3">𝐇</ci><apply id="S3.Ex1.m1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3"><mtext id="S3.Ex1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3"><mtext id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3">Dropout</mtext></ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝐇</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑜</ci></apply></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1c.cmml" xref="S3.Ex1.m1.1.1.1"><in id="S3.Ex1.m1.1.1.1.1.5.cmml" xref="S3.Ex1.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2406.02638v2#S3.Ex1.m1.1.1.1.1.1.cmml" id="S3.Ex1.m1.1.1.1.1d.cmml" xref="S3.Ex1.m1.1.1.1"></share><apply id="S3.Ex1.m1.1.1.1.1.6.cmml" xref="S3.Ex1.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.6.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.6.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2">ℝ</ci><apply id="S3.Ex1.m1.1.1.1.1.6.3.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3"><times id="S3.Ex1.m1.1.1.1.1.6.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3.1"></times><apply id="S3.Ex1.m1.1.1.1.1.6.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.6.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.6.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3.2.2">𝑛</ci><ci id="S3.Ex1.m1.1.1.1.1.6.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3.2.3">𝑢</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.6.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\mathbf{H}=\text{LayerNorm}(\text{Dropout}(\mathbf{H}_{o}))\in\mathbb{R}^{n_{u%
}\times D}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">bold_H = LayerNorm ( Dropout ( bold_H start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT × italic_D end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.3">During both training and inference phases, we aggregate multiple samples into a mini-batch, resulting in input data <math alttext="\mathbf{X}\in\mathbb{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">𝐗</mi><mo id="S3.SS3.p5.1.m1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.2" xref="S3.SS3.p5.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p5.1.m1.1.1.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.3.2" xref="S3.SS3.p5.1.m1.1.1.3.3.2.cmml">B</mi><mo id="S3.SS3.p5.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p5.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p5.1.m1.1.1.3.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.3.cmml">L</mi><mo id="S3.SS3.p5.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p5.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p5.1.m1.1.1.3.3.4" xref="S3.SS3.p5.1.m1.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><in id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1"></in><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">𝐗</ci><apply id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3"><times id="S3.SS3.p5.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.p5.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.2">𝐵</ci><ci id="S3.SS3.p5.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.3">𝐿</ci><ci id="S3.SS3.p5.1.m1.1.1.3.3.4.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">\mathbf{X}\in\mathbb{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">bold_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> for the subsequent Mamba block, where <math alttext="B" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><mi id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><ci id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">italic_B</annotation></semantics></math> represents the batch size and <math alttext="L" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.1"><semantics id="S3.SS3.p5.3.m3.1a"><mi id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><ci id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.1d">italic_L</annotation></semantics></math> is the padded sequence length.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Bi-directional Modeling</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In sequential recommendation systems, it is crucial to capture dependencies and patterns not only from past interactions but also considering future context. That’s what “Echo” comes out. A bi-directional model addresses this by processing sequences from both directions: forward and reverse.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.1 </span>Reverse Sequence Modeling</h4>
<div class="ltx_para" id="S3.SS4.SSS1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.p1.3">To enhance the prediction capability, we propose employing a reverse sequence modeling approach where the interaction sequence for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.1.m1.1"><semantics id="S3.SS4.SSS1.p1.1.m1.1a"><mi id="S3.SS4.SSS1.p1.1.m1.1.1" xref="S3.SS4.SSS1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.1.m1.1b"><ci id="S3.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.1.m1.1d">italic_u</annotation></semantics></math> is processed in reverse order, denoted as <math alttext="S_{u}^{R}=[v_{n_{u}},v_{n_{u}-1},\ldots,v_{1}]" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.2.m2.4"><semantics id="S3.SS4.SSS1.p1.2.m2.4a"><mrow id="S3.SS4.SSS1.p1.2.m2.4.4" xref="S3.SS4.SSS1.p1.2.m2.4.4.cmml"><msubsup id="S3.SS4.SSS1.p1.2.m2.4.4.5" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.4.4.5.2.2" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.2.2.cmml">S</mi><mi id="S3.SS4.SSS1.p1.2.m2.4.4.5.2.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.2.3.cmml">u</mi><mi id="S3.SS4.SSS1.p1.2.m2.4.4.5.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.3.cmml">R</mi></msubsup><mo id="S3.SS4.SSS1.p1.2.m2.4.4.4" xref="S3.SS4.SSS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS4.SSS1.p1.2.m2.4.4.3.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml"><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">[</mo><msub id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.2.cmml">v</mi><msub id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.2" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.2.cmml">n</mi><mi id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.3" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.3.cmml">u</mi></msub></msub><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.5" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.2.cmml">v</mi><mrow id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.cmml"><msub id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.2" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.2.cmml">n</mi><mi id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.3" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.3.cmml">u</mi></msub><mo id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.1" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.1.cmml">−</mo><mn id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.3" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.6" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS4.SSS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS4.SSS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.7" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.2" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.2.cmml">v</mi><mn id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.cmml">1</mn></msub><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.2.m2.4b"><apply id="S3.SS4.SSS1.p1.2.m2.4.4.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4"><eq id="S3.SS4.SSS1.p1.2.m2.4.4.4.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.4"></eq><apply id="S3.SS4.SSS1.p1.2.m2.4.4.5.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.4.4.5.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5">superscript</csymbol><apply id="S3.SS4.SSS1.p1.2.m2.4.4.5.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.4.4.5.2.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.4.4.5.2.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.2.2">𝑆</ci><ci id="S3.SS4.SSS1.p1.2.m2.4.4.5.2.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.2.3">𝑢</ci></apply><ci id="S3.SS4.SSS1.p1.2.m2.4.4.5.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.3">𝑅</ci></apply><list id="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3"><apply id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.2">𝑣</ci><apply id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.2">𝑛</ci><ci id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.3">𝑢</ci></apply></apply><apply id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.2">𝑣</ci><apply id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3"><minus id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.1"></minus><apply id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.2">𝑛</ci><ci id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.2.3">𝑢</ci></apply><cn id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S3.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1">…</ci><apply id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.2">𝑣</ci><cn id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.2.m2.4c">S_{u}^{R}=[v_{n_{u}},v_{n_{u}-1},\ldots,v_{1}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.2.m2.4d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT = [ italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT - 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>. The reverse model predicts the same next item <math alttext="v_{n_{u}+1}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.3.m3.1"><semantics id="S3.SS4.SSS1.p1.3.m3.1a"><msub id="S3.SS4.SSS1.p1.3.m3.1.1" xref="S3.SS4.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS4.SSS1.p1.3.m3.1.1.2" xref="S3.SS4.SSS1.p1.3.m3.1.1.2.cmml">v</mi><mrow id="S3.SS4.SSS1.p1.3.m3.1.1.3" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.cmml"><msub id="S3.SS4.SSS1.p1.3.m3.1.1.3.2" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.2.cmml"><mi id="S3.SS4.SSS1.p1.3.m3.1.1.3.2.2" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.2.2.cmml">n</mi><mi id="S3.SS4.SSS1.p1.3.m3.1.1.3.2.3" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.2.3.cmml">u</mi></msub><mo id="S3.SS4.SSS1.p1.3.m3.1.1.3.1" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS4.SSS1.p1.3.m3.1.1.3.3" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.3.m3.1b"><apply id="S3.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.2">𝑣</ci><apply id="S3.SS4.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.3"><plus id="S3.SS4.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.1"></plus><apply id="S3.SS4.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.SS4.SSS1.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.2.2">𝑛</ci><ci id="S3.SS4.SSS1.p1.3.m3.1.1.3.2.3.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.2.3">𝑢</ci></apply><cn id="S3.SS4.SSS1.p1.3.m3.1.1.3.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.3.m3.1c">v_{n_{u}+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, considering the sequence from the most recent interaction back to the first. This reverse perspective allows the model to capture different dependencies that may be overlooked when only considering the forward sequence.</p>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS1.Px1">
<h5 class="ltx_title ltx_title_paragraph">Rationale for Bi-directional Approach</h5>
<div class="ltx_para" id="S3.SS4.SSS1.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p1.1">The rationale behind using a bi-directional model is twofold:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS1.Px1.p2">
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.SSS1.Px1.p2.1.1">Enhanced Contextual Understanding:</span> by analyzing user behavior from both the start and end of the sequence, the model gains a comprehensive view, capturing patterns that emerge over time and those that are most immediate.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS1.Px1.p3">
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.SSS1.Px1.p3.1.1">Robustness to Sequence Variability:</span> some user behaviors are better understood when the context leading up to and following certain actions is considered. Bi-directional models are more robust to changes in user behavior patterns, providing stability in learning and prediction.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS1.Px1.p4">
<p class="ltx_p" id="S3.SS4.SSS1.Px1.p4.1">The combination of forward and reverse sequence modeling in a bi-directional framework allows for a more nuanced understanding of user interactions, potentially improving the accuracy of the predictions in dynamic recommendation environments.</p>
</div>
</section>
</section>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Filter Layer</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.7">The second reason we named our model EchoMamba4Rec is due to our use of a Fourier Transform-based (FFT) filter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib30" title="">30</a>]</cite> to capture sequential dependencies. In the filter layer, a filtering operation is performed for each feature dimension in the frequency domain, followed by the application of skip connections and layer normalization. Given the input item representation matrix <math alttext="\mathbf{F}^{l}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><mrow id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml"><msup id="S3.SS5.p1.1.m1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.2.cmml"><mi id="S3.SS5.p1.1.m1.1.1.2.2" xref="S3.SS5.p1.1.m1.1.1.2.2.cmml">𝐅</mi><mi id="S3.SS5.p1.1.m1.1.1.2.3" xref="S3.SS5.p1.1.m1.1.1.2.3.cmml">l</mi></msup><mo id="S3.SS5.p1.1.m1.1.1.1" xref="S3.SS5.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS5.p1.1.m1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.3.cmml"><mi id="S3.SS5.p1.1.m1.1.1.3.2" xref="S3.SS5.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS5.p1.1.m1.1.1.3.3" xref="S3.SS5.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS5.p1.1.m1.1.1.3.3.2" xref="S3.SS5.p1.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S3.SS5.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS5.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS5.p1.1.m1.1.1.3.3.3" xref="S3.SS5.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1"><in id="S3.SS5.p1.1.m1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1.1"></in><apply id="S3.SS5.p1.1.m1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.1.1.2.1.cmml" xref="S3.SS5.p1.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS5.p1.1.m1.1.1.2.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2.2">𝐅</ci><ci id="S3.SS5.p1.1.m1.1.1.2.3.cmml" xref="S3.SS5.p1.1.m1.1.1.2.3">𝑙</ci></apply><apply id="S3.SS5.p1.1.m1.1.1.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.1.1.3.1.cmml" xref="S3.SS5.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS5.p1.1.m1.1.1.3.2.cmml" xref="S3.SS5.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS5.p1.1.m1.1.1.3.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3.3"><times id="S3.SS5.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS5.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS5.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS5.p1.1.m1.1.1.3.3.2">𝑛</ci><ci id="S3.SS5.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">\mathbf{F}^{l}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> at layer <math alttext="l" class="ltx_Math" display="inline" id="S3.SS5.p1.2.m2.1"><semantics id="S3.SS5.p1.2.m2.1a"><mi id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><ci id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">italic_l</annotation></semantics></math> (where <math alttext="l=0" class="ltx_Math" display="inline" id="S3.SS5.p1.3.m3.1"><semantics id="S3.SS5.p1.3.m3.1a"><mrow id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml"><mi id="S3.SS5.p1.3.m3.1.1.2" xref="S3.SS5.p1.3.m3.1.1.2.cmml">l</mi><mo id="S3.SS5.p1.3.m3.1.1.1" xref="S3.SS5.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS5.p1.3.m3.1.1.3" xref="S3.SS5.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><apply id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1"><eq id="S3.SS5.p1.3.m3.1.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1.1"></eq><ci id="S3.SS5.p1.3.m3.1.1.2.cmml" xref="S3.SS5.p1.3.m3.1.1.2">𝑙</ci><cn id="S3.SS5.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS5.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">l=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.3.m3.1d">italic_l = 0</annotation></semantics></math> implies <math alttext="\mathbf{F}^{0}=\mathbf{E_{I}}" class="ltx_Math" display="inline" id="S3.SS5.p1.4.m4.1"><semantics id="S3.SS5.p1.4.m4.1a"><mrow id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml"><msup id="S3.SS5.p1.4.m4.1.1.2" xref="S3.SS5.p1.4.m4.1.1.2.cmml"><mi id="S3.SS5.p1.4.m4.1.1.2.2" xref="S3.SS5.p1.4.m4.1.1.2.2.cmml">𝐅</mi><mn id="S3.SS5.p1.4.m4.1.1.2.3" xref="S3.SS5.p1.4.m4.1.1.2.3.cmml">0</mn></msup><mo id="S3.SS5.p1.4.m4.1.1.1" xref="S3.SS5.p1.4.m4.1.1.1.cmml">=</mo><msub id="S3.SS5.p1.4.m4.1.1.3" xref="S3.SS5.p1.4.m4.1.1.3.cmml"><mi id="S3.SS5.p1.4.m4.1.1.3.2" xref="S3.SS5.p1.4.m4.1.1.3.2.cmml">𝐄</mi><mi id="S3.SS5.p1.4.m4.1.1.3.3" xref="S3.SS5.p1.4.m4.1.1.3.3.cmml">𝐈</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><apply id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1"><eq id="S3.SS5.p1.4.m4.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1.1"></eq><apply id="S3.SS5.p1.4.m4.1.1.2.cmml" xref="S3.SS5.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.2.1.cmml" xref="S3.SS5.p1.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.2.2.cmml" xref="S3.SS5.p1.4.m4.1.1.2.2">𝐅</ci><cn id="S3.SS5.p1.4.m4.1.1.2.3.cmml" type="integer" xref="S3.SS5.p1.4.m4.1.1.2.3">0</cn></apply><apply id="S3.SS5.p1.4.m4.1.1.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.3.1.cmml" xref="S3.SS5.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.3.2.cmml" xref="S3.SS5.p1.4.m4.1.1.3.2">𝐄</ci><ci id="S3.SS5.p1.4.m4.1.1.3.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3.3">𝐈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">\mathbf{F}^{0}=\mathbf{E_{I}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.4.m4.1d">bold_F start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT = bold_E start_POSTSUBSCRIPT bold_I end_POSTSUBSCRIPT</annotation></semantics></math>), where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS5.p1.5.m5.1"><semantics id="S3.SS5.p1.5.m5.1a"><mi id="S3.SS5.p1.5.m5.1.1" xref="S3.SS5.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.1b"><ci id="S3.SS5.p1.5.m5.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.5.m5.1d">italic_n</annotation></semantics></math> is the number of items and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS5.p1.6.m6.1"><semantics id="S3.SS5.p1.6.m6.1a"><mi id="S3.SS5.p1.6.m6.1.1" xref="S3.SS5.p1.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.6.m6.1b"><ci id="S3.SS5.p1.6.m6.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.6.m6.1d">italic_d</annotation></semantics></math> is the feature dimension, we first perform a one-dimensional FFT along the item dimension to convert <math alttext="\mathbf{F}^{l}" class="ltx_Math" display="inline" id="S3.SS5.p1.7.m7.1"><semantics id="S3.SS5.p1.7.m7.1a"><msup id="S3.SS5.p1.7.m7.1.1" xref="S3.SS5.p1.7.m7.1.1.cmml"><mi id="S3.SS5.p1.7.m7.1.1.2" xref="S3.SS5.p1.7.m7.1.1.2.cmml">𝐅</mi><mi id="S3.SS5.p1.7.m7.1.1.3" xref="S3.SS5.p1.7.m7.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.7.m7.1b"><apply id="S3.SS5.p1.7.m7.1.1.cmml" xref="S3.SS5.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.7.m7.1.1.1.cmml" xref="S3.SS5.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS5.p1.7.m7.1.1.2.cmml" xref="S3.SS5.p1.7.m7.1.1.2">𝐅</ci><ci id="S3.SS5.p1.7.m7.1.1.3.cmml" xref="S3.SS5.p1.7.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.7.m7.1c">\mathbf{F}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.7.m7.1d">bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> into the frequency domain:</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{X}^{l}=\mathcal{F}(\mathbf{F}^{l})\in\mathbb{C}^{n\times d}," class="ltx_Math" display="block" id="S3.Ex3.m1.1"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml"><msup id="S3.Ex3.m1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.3.2" xref="S3.Ex3.m1.1.1.1.1.3.2.cmml">𝐗</mi><mi id="S3.Ex3.m1.1.1.1.1.3.3" xref="S3.Ex3.m1.1.1.1.1.3.3.cmml">l</mi></msup><mo id="S3.Ex3.m1.1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.3.cmml">ℱ</mi><mo id="S3.Ex3.m1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex3.m1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.1.1.1.1.5" xref="S3.Ex3.m1.1.1.1.1.5.cmml">∈</mo><msup id="S3.Ex3.m1.1.1.1.1.6" xref="S3.Ex3.m1.1.1.1.1.6.cmml"><mi id="S3.Ex3.m1.1.1.1.1.6.2" xref="S3.Ex3.m1.1.1.1.1.6.2.cmml">ℂ</mi><mrow id="S3.Ex3.m1.1.1.1.1.6.3" xref="S3.Ex3.m1.1.1.1.1.6.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.6.3.2" xref="S3.Ex3.m1.1.1.1.1.6.3.2.cmml">n</mi><mo id="S3.Ex3.m1.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex3.m1.1.1.1.1.6.3.1.cmml">×</mo><mi id="S3.Ex3.m1.1.1.1.1.6.3.3" xref="S3.Ex3.m1.1.1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><and id="S3.Ex3.m1.1.1.1.1a.cmml" xref="S3.Ex3.m1.1.1.1"></and><apply id="S3.Ex3.m1.1.1.1.1b.cmml" xref="S3.Ex3.m1.1.1.1"><eq id="S3.Ex3.m1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.1.4"></eq><apply id="S3.Ex3.m1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.3.2">𝐗</ci><ci id="S3.Ex3.m1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.Ex3.m1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><times id="S3.Ex3.m1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2"></times><ci id="S3.Ex3.m1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3">ℱ</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.2">𝐅</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S3.Ex3.m1.1.1.1.1c.cmml" xref="S3.Ex3.m1.1.1.1"><in id="S3.Ex3.m1.1.1.1.1.5.cmml" xref="S3.Ex3.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2406.02638v2#S3.Ex3.m1.1.1.1.1.1.cmml" id="S3.Ex3.m1.1.1.1.1d.cmml" xref="S3.Ex3.m1.1.1.1"></share><apply id="S3.Ex3.m1.1.1.1.1.6.cmml" xref="S3.Ex3.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.6.1.cmml" xref="S3.Ex3.m1.1.1.1.1.6">superscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.6.2.cmml" xref="S3.Ex3.m1.1.1.1.1.6.2">ℂ</ci><apply id="S3.Ex3.m1.1.1.1.1.6.3.cmml" xref="S3.Ex3.m1.1.1.1.1.6.3"><times id="S3.Ex3.m1.1.1.1.1.6.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.6.3.1"></times><ci id="S3.Ex3.m1.1.1.1.1.6.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.6.3.2">𝑛</ci><ci id="S3.Ex3.m1.1.1.1.1.6.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\mathbf{X}^{l}=\mathcal{F}(\mathbf{F}^{l})\in\mathbb{C}^{n\times d},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1d">bold_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = caligraphic_F ( bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ∈ blackboard_C start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.4">where <math alttext="\mathcal{F}(\cdot)" class="ltx_Math" display="inline" id="S3.SS5.p3.1.m1.1"><semantics id="S3.SS5.p3.1.m1.1a"><mrow id="S3.SS5.p3.1.m1.1.2" xref="S3.SS5.p3.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p3.1.m1.1.2.2" xref="S3.SS5.p3.1.m1.1.2.2.cmml">ℱ</mi><mo id="S3.SS5.p3.1.m1.1.2.1" xref="S3.SS5.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS5.p3.1.m1.1.2.3.2" xref="S3.SS5.p3.1.m1.1.2.cmml"><mo id="S3.SS5.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS5.p3.1.m1.1.2.cmml">(</mo><mo id="S3.SS5.p3.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS5.p3.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS5.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS5.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.1b"><apply id="S3.SS5.p3.1.m1.1.2.cmml" xref="S3.SS5.p3.1.m1.1.2"><times id="S3.SS5.p3.1.m1.1.2.1.cmml" xref="S3.SS5.p3.1.m1.1.2.1"></times><ci id="S3.SS5.p3.1.m1.1.2.2.cmml" xref="S3.SS5.p3.1.m1.1.2.2">ℱ</ci><ci id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.1c">\mathcal{F}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.1.m1.1d">caligraphic_F ( ⋅ )</annotation></semantics></math> denotes the one-dimensional FFT, and <math alttext="\mathbf{X}^{l}" class="ltx_Math" display="inline" id="S3.SS5.p3.2.m2.1"><semantics id="S3.SS5.p3.2.m2.1a"><msup id="S3.SS5.p3.2.m2.1.1" xref="S3.SS5.p3.2.m2.1.1.cmml"><mi id="S3.SS5.p3.2.m2.1.1.2" xref="S3.SS5.p3.2.m2.1.1.2.cmml">𝐗</mi><mi id="S3.SS5.p3.2.m2.1.1.3" xref="S3.SS5.p3.2.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.2.m2.1b"><apply id="S3.SS5.p3.2.m2.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.1.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS5.p3.2.m2.1.1.2.cmml" xref="S3.SS5.p3.2.m2.1.1.2">𝐗</ci><ci id="S3.SS5.p3.2.m2.1.1.3.cmml" xref="S3.SS5.p3.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.2.m2.1c">\mathbf{X}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.2.m2.1d">bold_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is a complex tensor representing the spectrum of <math alttext="\mathbf{F}^{l}" class="ltx_Math" display="inline" id="S3.SS5.p3.3.m3.1"><semantics id="S3.SS5.p3.3.m3.1a"><msup id="S3.SS5.p3.3.m3.1.1" xref="S3.SS5.p3.3.m3.1.1.cmml"><mi id="S3.SS5.p3.3.m3.1.1.2" xref="S3.SS5.p3.3.m3.1.1.2.cmml">𝐅</mi><mi id="S3.SS5.p3.3.m3.1.1.3" xref="S3.SS5.p3.3.m3.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.3.m3.1b"><apply id="S3.SS5.p3.3.m3.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.3.m3.1.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS5.p3.3.m3.1.1.2.cmml" xref="S3.SS5.p3.3.m3.1.1.2">𝐅</ci><ci id="S3.SS5.p3.3.m3.1.1.3.cmml" xref="S3.SS5.p3.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.3.m3.1c">\mathbf{F}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.3.m3.1d">bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math>. We then modulate this spectrum by multiplying it with a filter <math alttext="\mathbf{K}\in\mathbb{C}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS5.p3.4.m4.1"><semantics id="S3.SS5.p3.4.m4.1a"><mrow id="S3.SS5.p3.4.m4.1.1" xref="S3.SS5.p3.4.m4.1.1.cmml"><mi id="S3.SS5.p3.4.m4.1.1.2" xref="S3.SS5.p3.4.m4.1.1.2.cmml">𝐊</mi><mo id="S3.SS5.p3.4.m4.1.1.1" xref="S3.SS5.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS5.p3.4.m4.1.1.3" xref="S3.SS5.p3.4.m4.1.1.3.cmml"><mi id="S3.SS5.p3.4.m4.1.1.3.2" xref="S3.SS5.p3.4.m4.1.1.3.2.cmml">ℂ</mi><mrow id="S3.SS5.p3.4.m4.1.1.3.3" xref="S3.SS5.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS5.p3.4.m4.1.1.3.3.2" xref="S3.SS5.p3.4.m4.1.1.3.3.2.cmml">n</mi><mo id="S3.SS5.p3.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS5.p3.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS5.p3.4.m4.1.1.3.3.3" xref="S3.SS5.p3.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.4.m4.1b"><apply id="S3.SS5.p3.4.m4.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1"><in id="S3.SS5.p3.4.m4.1.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1.1"></in><ci id="S3.SS5.p3.4.m4.1.1.2.cmml" xref="S3.SS5.p3.4.m4.1.1.2">𝐊</ci><apply id="S3.SS5.p3.4.m4.1.1.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p3.4.m4.1.1.3.1.cmml" xref="S3.SS5.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS5.p3.4.m4.1.1.3.2.cmml" xref="S3.SS5.p3.4.m4.1.1.3.2">ℂ</ci><apply id="S3.SS5.p3.4.m4.1.1.3.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3"><times id="S3.SS5.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3.1"></times><ci id="S3.SS5.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3.2">𝑛</ci><ci id="S3.SS5.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.4.m4.1c">\mathbf{K}\in\mathbb{C}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.4.m4.1d">bold_K ∈ blackboard_C start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> which is learnable:</p>
</div>
<div class="ltx_para" id="S3.SS5.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{\tilde{X}}^{l}=\mathbf{K}\odot\mathbf{X}^{l}," class="ltx_Math" display="block" id="S3.Ex5.m1.1"><semantics id="S3.Ex5.m1.1a"><mrow id="S3.Ex5.m1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.cmml"><mrow id="S3.Ex5.m1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.cmml"><msup id="S3.Ex5.m1.1.1.1.1.2" xref="S3.Ex5.m1.1.1.1.1.2.cmml"><mover accent="true" id="S3.Ex5.m1.1.1.1.1.2.2" xref="S3.Ex5.m1.1.1.1.1.2.2.cmml"><mi id="S3.Ex5.m1.1.1.1.1.2.2.2" xref="S3.Ex5.m1.1.1.1.1.2.2.2.cmml">𝐗</mi><mo id="S3.Ex5.m1.1.1.1.1.2.2.1" xref="S3.Ex5.m1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.Ex5.m1.1.1.1.1.2.3" xref="S3.Ex5.m1.1.1.1.1.2.3.cmml">l</mi></msup><mo id="S3.Ex5.m1.1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.Ex5.m1.1.1.1.1.3" xref="S3.Ex5.m1.1.1.1.1.3.cmml"><mi id="S3.Ex5.m1.1.1.1.1.3.2" xref="S3.Ex5.m1.1.1.1.1.3.2.cmml">𝐊</mi><mo id="S3.Ex5.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex5.m1.1.1.1.1.3.1.cmml">⊙</mo><msup id="S3.Ex5.m1.1.1.1.1.3.3" xref="S3.Ex5.m1.1.1.1.1.3.3.cmml"><mi id="S3.Ex5.m1.1.1.1.1.3.3.2" xref="S3.Ex5.m1.1.1.1.1.3.3.2.cmml">𝐗</mi><mi id="S3.Ex5.m1.1.1.1.1.3.3.3" xref="S3.Ex5.m1.1.1.1.1.3.3.3.cmml">l</mi></msup></mrow></mrow><mo id="S3.Ex5.m1.1.1.1.2" xref="S3.Ex5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.1b"><apply id="S3.Ex5.m1.1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1"><eq id="S3.Ex5.m1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1.1.1"></eq><apply id="S3.Ex5.m1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex5.m1.1.1.1.1.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.2.2"><ci id="S3.Ex5.m1.1.1.1.1.2.2.1.cmml" xref="S3.Ex5.m1.1.1.1.1.2.2.1">~</ci><ci id="S3.Ex5.m1.1.1.1.1.2.2.2.cmml" xref="S3.Ex5.m1.1.1.1.1.2.2.2">𝐗</ci></apply><ci id="S3.Ex5.m1.1.1.1.1.2.3.cmml" xref="S3.Ex5.m1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.Ex5.m1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.1.1.1.1.3"><csymbol cd="latexml" id="S3.Ex5.m1.1.1.1.1.3.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.1">direct-product</csymbol><ci id="S3.Ex5.m1.1.1.1.1.3.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.2">𝐊</ci><apply id="S3.Ex5.m1.1.1.1.1.3.3.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.1.3.3.1.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.Ex5.m1.1.1.1.1.3.3.2.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.2">𝐗</ci><ci id="S3.Ex5.m1.1.1.1.1.3.3.3.cmml" xref="S3.Ex5.m1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.1c">\mathbf{\tilde{X}}^{l}=\mathbf{K}\odot\mathbf{X}^{l},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.1d">over~ start_ARG bold_X end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = bold_K ⊙ bold_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p5">
<p class="ltx_p" id="S3.SS5.p5.2">where <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS5.p5.1.m1.1"><semantics id="S3.SS5.p5.1.m1.1a"><mo id="S3.SS5.p5.1.m1.1.1" xref="S3.SS5.p5.1.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS5.p5.1.m1.1b"><csymbol cd="latexml" id="S3.SS5.p5.1.m1.1.1.cmml" xref="S3.SS5.p5.1.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p5.1.m1.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p5.1.m1.1d">⊙</annotation></semantics></math> represents element-wise multiplication. The modulated spectrum <math alttext="\mathbf{\tilde{X}}^{l}" class="ltx_Math" display="inline" id="S3.SS5.p5.2.m2.1"><semantics id="S3.SS5.p5.2.m2.1a"><msup id="S3.SS5.p5.2.m2.1.1" xref="S3.SS5.p5.2.m2.1.1.cmml"><mover accent="true" id="S3.SS5.p5.2.m2.1.1.2" xref="S3.SS5.p5.2.m2.1.1.2.cmml"><mi id="S3.SS5.p5.2.m2.1.1.2.2" xref="S3.SS5.p5.2.m2.1.1.2.2.cmml">𝐗</mi><mo id="S3.SS5.p5.2.m2.1.1.2.1" xref="S3.SS5.p5.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS5.p5.2.m2.1.1.3" xref="S3.SS5.p5.2.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.p5.2.m2.1b"><apply id="S3.SS5.p5.2.m2.1.1.cmml" xref="S3.SS5.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p5.2.m2.1.1.1.cmml" xref="S3.SS5.p5.2.m2.1.1">superscript</csymbol><apply id="S3.SS5.p5.2.m2.1.1.2.cmml" xref="S3.SS5.p5.2.m2.1.1.2"><ci id="S3.SS5.p5.2.m2.1.1.2.1.cmml" xref="S3.SS5.p5.2.m2.1.1.2.1">~</ci><ci id="S3.SS5.p5.2.m2.1.1.2.2.cmml" xref="S3.SS5.p5.2.m2.1.1.2.2">𝐗</ci></apply><ci id="S3.SS5.p5.2.m2.1.1.3.cmml" xref="S3.SS5.p5.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p5.2.m2.1c">\mathbf{\tilde{X}}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p5.2.m2.1d">over~ start_ARG bold_X end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is transformed back to the time domain using the inverse FFT to update the sequence representations:</p>
</div>
<div class="ltx_para" id="S3.SS5.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{\tilde{F}}^{l}\leftarrow\mathcal{F}^{-1}(\mathbf{\tilde{X}}^{l})\in%
\mathbb{R}^{n\times d}," class="ltx_Math" display="block" id="S3.Ex7.m1.1"><semantics id="S3.Ex7.m1.1a"><mrow id="S3.Ex7.m1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.cmml"><mrow id="S3.Ex7.m1.1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.cmml"><msup id="S3.Ex7.m1.1.1.1.1.3" xref="S3.Ex7.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.Ex7.m1.1.1.1.1.3.2" xref="S3.Ex7.m1.1.1.1.1.3.2.cmml"><mi id="S3.Ex7.m1.1.1.1.1.3.2.2" xref="S3.Ex7.m1.1.1.1.1.3.2.2.cmml">𝐅</mi><mo id="S3.Ex7.m1.1.1.1.1.3.2.1" xref="S3.Ex7.m1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.Ex7.m1.1.1.1.1.3.3" xref="S3.Ex7.m1.1.1.1.1.3.3.cmml">l</mi></msup><mo id="S3.Ex7.m1.1.1.1.1.4" stretchy="false" xref="S3.Ex7.m1.1.1.1.1.4.cmml">←</mo><mrow id="S3.Ex7.m1.1.1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.1.cmml"><msup id="S3.Ex7.m1.1.1.1.1.1.3" xref="S3.Ex7.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.1.1.1.1.1.3.2" xref="S3.Ex7.m1.1.1.1.1.1.3.2.cmml">ℱ</mi><mrow id="S3.Ex7.m1.1.1.1.1.1.3.3" xref="S3.Ex7.m1.1.1.1.1.1.3.3.cmml"><mo id="S3.Ex7.m1.1.1.1.1.1.3.3a" xref="S3.Ex7.m1.1.1.1.1.1.3.3.cmml">−</mo><mn id="S3.Ex7.m1.1.1.1.1.1.3.3.2" xref="S3.Ex7.m1.1.1.1.1.1.3.3.2.cmml">1</mn></mrow></msup><mo id="S3.Ex7.m1.1.1.1.1.1.2" xref="S3.Ex7.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex7.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex7.m1.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.Ex7.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mo id="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.Ex7.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S3.Ex7.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.1.1.1.1.5" xref="S3.Ex7.m1.1.1.1.1.5.cmml">∈</mo><msup id="S3.Ex7.m1.1.1.1.1.6" xref="S3.Ex7.m1.1.1.1.1.6.cmml"><mi id="S3.Ex7.m1.1.1.1.1.6.2" xref="S3.Ex7.m1.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="S3.Ex7.m1.1.1.1.1.6.3" xref="S3.Ex7.m1.1.1.1.1.6.3.cmml"><mi id="S3.Ex7.m1.1.1.1.1.6.3.2" xref="S3.Ex7.m1.1.1.1.1.6.3.2.cmml">n</mi><mo id="S3.Ex7.m1.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex7.m1.1.1.1.1.6.3.1.cmml">×</mo><mi id="S3.Ex7.m1.1.1.1.1.6.3.3" xref="S3.Ex7.m1.1.1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="S3.Ex7.m1.1.1.1.2" xref="S3.Ex7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.1b"><apply id="S3.Ex7.m1.1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1"><and id="S3.Ex7.m1.1.1.1.1a.cmml" xref="S3.Ex7.m1.1.1.1"></and><apply id="S3.Ex7.m1.1.1.1.1b.cmml" xref="S3.Ex7.m1.1.1.1"><ci id="S3.Ex7.m1.1.1.1.1.4.cmml" xref="S3.Ex7.m1.1.1.1.1.4">←</ci><apply id="S3.Ex7.m1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.1.1.3.1.cmml" xref="S3.Ex7.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.Ex7.m1.1.1.1.1.3.2.cmml" xref="S3.Ex7.m1.1.1.1.1.3.2"><ci id="S3.Ex7.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex7.m1.1.1.1.1.3.2.1">~</ci><ci id="S3.Ex7.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex7.m1.1.1.1.1.3.2.2">𝐅</ci></apply><ci id="S3.Ex7.m1.1.1.1.1.3.3.cmml" xref="S3.Ex7.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.Ex7.m1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1.1.1"><times id="S3.Ex7.m1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.1.1.1.1.1.2"></times><apply id="S3.Ex7.m1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.1.1.1.3.1.cmml" xref="S3.Ex7.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex7.m1.1.1.1.1.1.3.2.cmml" xref="S3.Ex7.m1.1.1.1.1.1.3.2">ℱ</ci><apply id="S3.Ex7.m1.1.1.1.1.1.3.3.cmml" xref="S3.Ex7.m1.1.1.1.1.1.3.3"><minus id="S3.Ex7.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex7.m1.1.1.1.1.1.3.3"></minus><cn id="S3.Ex7.m1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="S3.Ex7.m1.1.1.1.1.1.3.3.2">1</cn></apply></apply><apply id="S3.Ex7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.2"><ci id="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.2.2">𝐗</ci></apply><ci id="S3.Ex7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S3.Ex7.m1.1.1.1.1c.cmml" xref="S3.Ex7.m1.1.1.1"><in id="S3.Ex7.m1.1.1.1.1.5.cmml" xref="S3.Ex7.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2406.02638v2#S3.Ex7.m1.1.1.1.1.1.cmml" id="S3.Ex7.m1.1.1.1.1d.cmml" xref="S3.Ex7.m1.1.1.1"></share><apply id="S3.Ex7.m1.1.1.1.1.6.cmml" xref="S3.Ex7.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.Ex7.m1.1.1.1.1.6.1.cmml" xref="S3.Ex7.m1.1.1.1.1.6">superscript</csymbol><ci id="S3.Ex7.m1.1.1.1.1.6.2.cmml" xref="S3.Ex7.m1.1.1.1.1.6.2">ℝ</ci><apply id="S3.Ex7.m1.1.1.1.1.6.3.cmml" xref="S3.Ex7.m1.1.1.1.1.6.3"><times id="S3.Ex7.m1.1.1.1.1.6.3.1.cmml" xref="S3.Ex7.m1.1.1.1.1.6.3.1"></times><ci id="S3.Ex7.m1.1.1.1.1.6.3.2.cmml" xref="S3.Ex7.m1.1.1.1.1.6.3.2">𝑛</ci><ci id="S3.Ex7.m1.1.1.1.1.6.3.3.cmml" xref="S3.Ex7.m1.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.1c">\mathbf{\tilde{F}}^{l}\leftarrow\mathcal{F}^{-1}(\mathbf{\tilde{X}}^{l})\in%
\mathbb{R}^{n\times d},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.1d">over~ start_ARG bold_F end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ← caligraphic_F start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( over~ start_ARG bold_X end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p7">
<p class="ltx_p" id="S3.SS5.p7.1"><math alttext="\mathcal{F}^{-1}(\cdot)" class="ltx_Math" display="inline" id="S3.SS5.p7.1.m1.1"><semantics id="S3.SS5.p7.1.m1.1a"><mrow id="S3.SS5.p7.1.m1.1.2" xref="S3.SS5.p7.1.m1.1.2.cmml"><msup id="S3.SS5.p7.1.m1.1.2.2" xref="S3.SS5.p7.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p7.1.m1.1.2.2.2" xref="S3.SS5.p7.1.m1.1.2.2.2.cmml">ℱ</mi><mrow id="S3.SS5.p7.1.m1.1.2.2.3" xref="S3.SS5.p7.1.m1.1.2.2.3.cmml"><mo id="S3.SS5.p7.1.m1.1.2.2.3a" xref="S3.SS5.p7.1.m1.1.2.2.3.cmml">−</mo><mn id="S3.SS5.p7.1.m1.1.2.2.3.2" xref="S3.SS5.p7.1.m1.1.2.2.3.2.cmml">1</mn></mrow></msup><mo id="S3.SS5.p7.1.m1.1.2.1" xref="S3.SS5.p7.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS5.p7.1.m1.1.2.3.2" xref="S3.SS5.p7.1.m1.1.2.cmml"><mo id="S3.SS5.p7.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS5.p7.1.m1.1.2.cmml">(</mo><mo id="S3.SS5.p7.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS5.p7.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS5.p7.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS5.p7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p7.1.m1.1b"><apply id="S3.SS5.p7.1.m1.1.2.cmml" xref="S3.SS5.p7.1.m1.1.2"><times id="S3.SS5.p7.1.m1.1.2.1.cmml" xref="S3.SS5.p7.1.m1.1.2.1"></times><apply id="S3.SS5.p7.1.m1.1.2.2.cmml" xref="S3.SS5.p7.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS5.p7.1.m1.1.2.2.1.cmml" xref="S3.SS5.p7.1.m1.1.2.2">superscript</csymbol><ci id="S3.SS5.p7.1.m1.1.2.2.2.cmml" xref="S3.SS5.p7.1.m1.1.2.2.2">ℱ</ci><apply id="S3.SS5.p7.1.m1.1.2.2.3.cmml" xref="S3.SS5.p7.1.m1.1.2.2.3"><minus id="S3.SS5.p7.1.m1.1.2.2.3.1.cmml" xref="S3.SS5.p7.1.m1.1.2.2.3"></minus><cn id="S3.SS5.p7.1.m1.1.2.2.3.2.cmml" type="integer" xref="S3.SS5.p7.1.m1.1.2.2.3.2">1</cn></apply></apply><ci id="S3.SS5.p7.1.m1.1.1.cmml" xref="S3.SS5.p7.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p7.1.m1.1c">\mathcal{F}^{-1}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p7.1.m1.1d">caligraphic_F start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( ⋅ )</annotation></semantics></math> denotes the inverse 1D FFT, converting the complex tensor back into a real number tensor. The operations of FFT and inverse FFT help reduce noise from the logged data, enabling cleaner item embeddings. We incorporate skip connections, layer normalization, and dropout operations to mitigate problems related to gradient vanishing and unstable training:</p>
</div>
<div class="ltx_para" id="S3.SS5.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{\tilde{F}}^{l}=\text{LayerNorm}(\mathbf{F}^{l}+\text{Dropout}(\mathbf{%
\tilde{F}}^{l}))," class="ltx_Math" display="block" id="S3.Ex9.m1.1"><semantics id="S3.Ex9.m1.1a"><mrow id="S3.Ex9.m1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.cmml"><mrow id="S3.Ex9.m1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.cmml"><msup id="S3.Ex9.m1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.Ex9.m1.1.1.1.1.3.2" xref="S3.Ex9.m1.1.1.1.1.3.2.cmml"><mi id="S3.Ex9.m1.1.1.1.1.3.2.2" xref="S3.Ex9.m1.1.1.1.1.3.2.2.cmml">𝐅</mi><mo id="S3.Ex9.m1.1.1.1.1.3.2.1" xref="S3.Ex9.m1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.Ex9.m1.1.1.1.1.3.3" xref="S3.Ex9.m1.1.1.1.1.3.3.cmml">l</mi></msup><mo id="S3.Ex9.m1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex9.m1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex9.m1.1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="S3.Ex9.m1.1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.Ex9.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐅</mi><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msup><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3a.cmml">Dropout</mtext><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐅</mi><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex9.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex9.m1.1.1.1.2" xref="S3.Ex9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m1.1b"><apply id="S3.Ex9.m1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1"><eq id="S3.Ex9.m1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.1.2"></eq><apply id="S3.Ex9.m1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.1.1.3.1.cmml" xref="S3.Ex9.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.Ex9.m1.1.1.1.1.3.2.cmml" xref="S3.Ex9.m1.1.1.1.1.3.2"><ci id="S3.Ex9.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex9.m1.1.1.1.1.3.2.1">~</ci><ci id="S3.Ex9.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex9.m1.1.1.1.1.3.2.2">𝐅</ci></apply><ci id="S3.Ex9.m1.1.1.1.1.3.3.cmml" xref="S3.Ex9.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.Ex9.m1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1"><times id="S3.Ex9.m1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.2"></times><ci id="S3.Ex9.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex9.m1.1.1.1.1.1.3"><mtext id="S3.Ex9.m1.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.3">LayerNorm</mtext></ci><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1"><plus id="S3.Ex9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.2"></plus><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.2">𝐅</ci><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.3">Dropout</mtext></ci><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐅</ci></apply><ci id="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m1.1c">\mathbf{\tilde{F}}^{l}=\text{LayerNorm}(\mathbf{F}^{l}+\text{Dropout}(\mathbf{%
\tilde{F}}^{l})),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex9.m1.1d">over~ start_ARG bold_F end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = LayerNorm ( bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT + Dropout ( over~ start_ARG bold_F end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Gate Linear Unit</h3>
<div class="ltx_para ltx_noindent" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">After the previous section, we process the data through a GLU network, which has a gating mechanism that can selectively retain or discard some parts of the input data, thus effectively suppressing the overfitting phenomenon of the model:</p>
</div>
<div class="ltx_para" id="S3.SS6.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{GLU}(\mathbf{\tilde{F}}^{l})=(\mathbf{\tilde{F}}^{l}\mathbf{W}_{1}+%
\mathbf{b}_{1})\odot\sigma(\mathbf{\tilde{F}}^{l}\mathbf{W}_{2}+\mathbf{b}_{2})," class="ltx_Math" display="block" id="S3.Ex11.m1.1"><semantics id="S3.Ex11.m1.1a"><mrow id="S3.Ex11.m1.1.1.1" xref="S3.Ex11.m1.1.1.1.1.cmml"><mrow id="S3.Ex11.m1.1.1.1.1" xref="S3.Ex11.m1.1.1.1.1.cmml"><mrow id="S3.Ex11.m1.1.1.1.1.1" xref="S3.Ex11.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex11.m1.1.1.1.1.1.3" xref="S3.Ex11.m1.1.1.1.1.1.3a.cmml">GLU</mtext><mo id="S3.Ex11.m1.1.1.1.1.1.2" xref="S3.Ex11.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex11.m1.1.1.1.1.1.1.1" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex11.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex11.m1.1.1.1.1.1.1.1.1" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.Ex11.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐅</mi><mo id="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.Ex11.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S3.Ex11.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex11.m1.1.1.1.1.4" xref="S3.Ex11.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.Ex11.m1.1.1.1.1.3" xref="S3.Ex11.m1.1.1.1.1.3.cmml"><mrow id="S3.Ex11.m1.1.1.1.1.2.1" xref="S3.Ex11.m1.1.1.1.1.2.1.cmml"><mrow id="S3.Ex11.m1.1.1.1.1.2.1.1.1" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S3.Ex11.m1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.cmml"><mrow id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.cmml"><msup id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.cmml"><mover accent="true" id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.2" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml">𝐅</mi><mo id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.1" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.3" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml">l</mi></msup><mo id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.1" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.cmml"><mi id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.2" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.2.cmml">𝐖</mi><mn id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.3" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.1" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.1.cmml">+</mo><msub id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.2" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.3" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.Ex11.m1.1.1.1.1.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex11.m1.1.1.1.1.2.1.2" rspace="0.222em" xref="S3.Ex11.m1.1.1.1.1.2.1.2.cmml">⊙</mo><mi id="S3.Ex11.m1.1.1.1.1.2.1.3" xref="S3.Ex11.m1.1.1.1.1.2.1.3.cmml">σ</mi></mrow><mo id="S3.Ex11.m1.1.1.1.1.3.3" xref="S3.Ex11.m1.1.1.1.1.3.3.cmml">⁢</mo><mrow id="S3.Ex11.m1.1.1.1.1.3.2.1" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.cmml"><mo id="S3.Ex11.m1.1.1.1.1.3.2.1.2" stretchy="false" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.cmml">(</mo><mrow id="S3.Ex11.m1.1.1.1.1.3.2.1.1" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.cmml"><mrow id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.cmml"><msup id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.cmml"><mover accent="true" id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.cmml"><mi id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.2" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.2.cmml">𝐅</mi><mo id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.1" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.3" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.3.cmml">l</mi></msup><mo id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.1" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.1.cmml">⁢</mo><msub id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.cmml"><mi id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.2" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.2.cmml">𝐖</mi><mn id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.3" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="S3.Ex11.m1.1.1.1.1.3.2.1.1.1" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.1.cmml">+</mo><msub id="S3.Ex11.m1.1.1.1.1.3.2.1.1.3" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.cmml"><mi id="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.2" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.2.cmml">𝐛</mi><mn id="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.3" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S3.Ex11.m1.1.1.1.1.3.2.1.3" stretchy="false" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex11.m1.1.1.1.2" xref="S3.Ex11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex11.m1.1b"><apply id="S3.Ex11.m1.1.1.1.1.cmml" xref="S3.Ex11.m1.1.1.1"><eq id="S3.Ex11.m1.1.1.1.1.4.cmml" xref="S3.Ex11.m1.1.1.1.1.4"></eq><apply id="S3.Ex11.m1.1.1.1.1.1.cmml" xref="S3.Ex11.m1.1.1.1.1.1"><times id="S3.Ex11.m1.1.1.1.1.1.2.cmml" xref="S3.Ex11.m1.1.1.1.1.1.2"></times><ci id="S3.Ex11.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex11.m1.1.1.1.1.1.3"><mtext id="S3.Ex11.m1.1.1.1.1.1.3.cmml" xref="S3.Ex11.m1.1.1.1.1.1.3">GLU</mtext></ci><apply id="S3.Ex11.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex11.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex11.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.2"><ci id="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.2.2">𝐅</ci></apply><ci id="S3.Ex11.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex11.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S3.Ex11.m1.1.1.1.1.3.cmml" xref="S3.Ex11.m1.1.1.1.1.3"><times id="S3.Ex11.m1.1.1.1.1.3.3.cmml" xref="S3.Ex11.m1.1.1.1.1.3.3"></times><apply id="S3.Ex11.m1.1.1.1.1.2.1.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1"><csymbol cd="latexml" id="S3.Ex11.m1.1.1.1.1.2.1.2.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.2">direct-product</csymbol><apply id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1"><plus id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.1"></plus><apply id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2"><times id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.1"></times><apply id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.1.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2">superscript</csymbol><apply id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2"><ci id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.1">~</ci><ci id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.2.2">𝐅</ci></apply><ci id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.2.3">𝑙</ci></apply><apply id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.1.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.2.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.2">𝐖</ci><cn id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.2">𝐛</ci><cn id="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.3.cmml" type="integer" xref="S3.Ex11.m1.1.1.1.1.2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.Ex11.m1.1.1.1.1.2.1.3.cmml" xref="S3.Ex11.m1.1.1.1.1.2.1.3">𝜎</ci></apply><apply id="S3.Ex11.m1.1.1.1.1.3.2.1.1.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1"><plus id="S3.Ex11.m1.1.1.1.1.3.2.1.1.1.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.1"></plus><apply id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2"><times id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.1.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.1"></times><apply id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.1.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2">superscript</csymbol><apply id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2"><ci id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.1.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.1">~</ci><ci id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.2.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.2.2">𝐅</ci></apply><ci id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.3.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.2.3">𝑙</ci></apply><apply id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.1.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3">subscript</csymbol><ci id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.2.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.2">𝐖</ci><cn id="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.3.cmml" type="integer" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.2.3.3">2</cn></apply></apply><apply id="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.1.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.3">subscript</csymbol><ci id="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.2.cmml" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.2">𝐛</ci><cn id="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.3.cmml" type="integer" xref="S3.Ex11.m1.1.1.1.1.3.2.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex11.m1.1c">\text{GLU}(\mathbf{\tilde{F}}^{l})=(\mathbf{\tilde{F}}^{l}\mathbf{W}_{1}+%
\mathbf{b}_{1})\odot\sigma(\mathbf{\tilde{F}}^{l}\mathbf{W}_{2}+\mathbf{b}_{2}),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex11.m1.1d">GLU ( over~ start_ARG bold_F end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) = ( over~ start_ARG bold_F end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ⊙ italic_σ ( over~ start_ARG bold_F end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p3">
<p class="ltx_p" id="S3.SS6.p3.7">where <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS6.p3.1.m1.1"><semantics id="S3.SS6.p3.1.m1.1a"><mo id="S3.SS6.p3.1.m1.1.1" xref="S3.SS6.p3.1.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.1.m1.1b"><csymbol cd="latexml" id="S3.SS6.p3.1.m1.1.1.cmml" xref="S3.SS6.p3.1.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.1.m1.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.1.m1.1d">⊙</annotation></semantics></math> represents element-wise multiplication, <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS6.p3.2.m2.1"><semantics id="S3.SS6.p3.2.m2.1a"><mi id="S3.SS6.p3.2.m2.1.1" xref="S3.SS6.p3.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.2.m2.1b"><ci id="S3.SS6.p3.2.m2.1.1.cmml" xref="S3.SS6.p3.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.2.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.2.m2.1d">italic_σ</annotation></semantics></math> is the sigmoid function, <math alttext="\mathbf{W}_{1}" class="ltx_Math" display="inline" id="S3.SS6.p3.3.m3.1"><semantics id="S3.SS6.p3.3.m3.1a"><msub id="S3.SS6.p3.3.m3.1.1" xref="S3.SS6.p3.3.m3.1.1.cmml"><mi id="S3.SS6.p3.3.m3.1.1.2" xref="S3.SS6.p3.3.m3.1.1.2.cmml">𝐖</mi><mn id="S3.SS6.p3.3.m3.1.1.3" xref="S3.SS6.p3.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.3.m3.1b"><apply id="S3.SS6.p3.3.m3.1.1.cmml" xref="S3.SS6.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS6.p3.3.m3.1.1.1.cmml" xref="S3.SS6.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS6.p3.3.m3.1.1.2.cmml" xref="S3.SS6.p3.3.m3.1.1.2">𝐖</ci><cn id="S3.SS6.p3.3.m3.1.1.3.cmml" type="integer" xref="S3.SS6.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.3.m3.1c">\mathbf{W}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.3.m3.1d">bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{W}_{2}" class="ltx_Math" display="inline" id="S3.SS6.p3.4.m4.1"><semantics id="S3.SS6.p3.4.m4.1a"><msub id="S3.SS6.p3.4.m4.1.1" xref="S3.SS6.p3.4.m4.1.1.cmml"><mi id="S3.SS6.p3.4.m4.1.1.2" xref="S3.SS6.p3.4.m4.1.1.2.cmml">𝐖</mi><mn id="S3.SS6.p3.4.m4.1.1.3" xref="S3.SS6.p3.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.4.m4.1b"><apply id="S3.SS6.p3.4.m4.1.1.cmml" xref="S3.SS6.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS6.p3.4.m4.1.1.1.cmml" xref="S3.SS6.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS6.p3.4.m4.1.1.2.cmml" xref="S3.SS6.p3.4.m4.1.1.2">𝐖</ci><cn id="S3.SS6.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS6.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.4.m4.1c">\mathbf{W}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.4.m4.1d">bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are learnable weight matrices, and <math alttext="\mathbf{b}_{1}" class="ltx_Math" display="inline" id="S3.SS6.p3.5.m5.1"><semantics id="S3.SS6.p3.5.m5.1a"><msub id="S3.SS6.p3.5.m5.1.1" xref="S3.SS6.p3.5.m5.1.1.cmml"><mi id="S3.SS6.p3.5.m5.1.1.2" xref="S3.SS6.p3.5.m5.1.1.2.cmml">𝐛</mi><mn id="S3.SS6.p3.5.m5.1.1.3" xref="S3.SS6.p3.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.5.m5.1b"><apply id="S3.SS6.p3.5.m5.1.1.cmml" xref="S3.SS6.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS6.p3.5.m5.1.1.1.cmml" xref="S3.SS6.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS6.p3.5.m5.1.1.2.cmml" xref="S3.SS6.p3.5.m5.1.1.2">𝐛</ci><cn id="S3.SS6.p3.5.m5.1.1.3.cmml" type="integer" xref="S3.SS6.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.5.m5.1c">\mathbf{b}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.5.m5.1d">bold_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}_{2}" class="ltx_Math" display="inline" id="S3.SS6.p3.6.m6.1"><semantics id="S3.SS6.p3.6.m6.1a"><msub id="S3.SS6.p3.6.m6.1.1" xref="S3.SS6.p3.6.m6.1.1.cmml"><mi id="S3.SS6.p3.6.m6.1.1.2" xref="S3.SS6.p3.6.m6.1.1.2.cmml">𝐛</mi><mn id="S3.SS6.p3.6.m6.1.1.3" xref="S3.SS6.p3.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.6.m6.1b"><apply id="S3.SS6.p3.6.m6.1.1.cmml" xref="S3.SS6.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS6.p3.6.m6.1.1.1.cmml" xref="S3.SS6.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS6.p3.6.m6.1.1.2.cmml" xref="S3.SS6.p3.6.m6.1.1.2">𝐛</ci><cn id="S3.SS6.p3.6.m6.1.1.3.cmml" type="integer" xref="S3.SS6.p3.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.6.m6.1c">\mathbf{b}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.6.m6.1d">bold_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are bias terms. <math alttext="\mathbf{\tilde{F}}^{l}" class="ltx_Math" display="inline" id="S3.SS6.p3.7.m7.1"><semantics id="S3.SS6.p3.7.m7.1a"><msup id="S3.SS6.p3.7.m7.1.1" xref="S3.SS6.p3.7.m7.1.1.cmml"><mover accent="true" id="S3.SS6.p3.7.m7.1.1.2" xref="S3.SS6.p3.7.m7.1.1.2.cmml"><mi id="S3.SS6.p3.7.m7.1.1.2.2" xref="S3.SS6.p3.7.m7.1.1.2.2.cmml">𝐅</mi><mo id="S3.SS6.p3.7.m7.1.1.2.1" xref="S3.SS6.p3.7.m7.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS6.p3.7.m7.1.1.3" xref="S3.SS6.p3.7.m7.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.7.m7.1b"><apply id="S3.SS6.p3.7.m7.1.1.cmml" xref="S3.SS6.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS6.p3.7.m7.1.1.1.cmml" xref="S3.SS6.p3.7.m7.1.1">superscript</csymbol><apply id="S3.SS6.p3.7.m7.1.1.2.cmml" xref="S3.SS6.p3.7.m7.1.1.2"><ci id="S3.SS6.p3.7.m7.1.1.2.1.cmml" xref="S3.SS6.p3.7.m7.1.1.2.1">~</ci><ci id="S3.SS6.p3.7.m7.1.1.2.2.cmml" xref="S3.SS6.p3.7.m7.1.1.2.2">𝐅</ci></apply><ci id="S3.SS6.p3.7.m7.1.1.3.cmml" xref="S3.SS6.p3.7.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.7.m7.1c">\mathbf{\tilde{F}}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.7.m7.1d">over~ start_ARG bold_F end_ARG start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> represents the input feature map from the previous layer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p4">
<p class="ltx_p" id="S3.SS6.p4.2">Note: <math alttext="\tilde{F}" class="ltx_Math" display="inline" id="S3.SS6.p4.1.m1.1"><semantics id="S3.SS6.p4.1.m1.1a"><mover accent="true" id="S3.SS6.p4.1.m1.1.1" xref="S3.SS6.p4.1.m1.1.1.cmml"><mi id="S3.SS6.p4.1.m1.1.1.2" xref="S3.SS6.p4.1.m1.1.1.2.cmml">F</mi><mo id="S3.SS6.p4.1.m1.1.1.1" xref="S3.SS6.p4.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS6.p4.1.m1.1b"><apply id="S3.SS6.p4.1.m1.1.1.cmml" xref="S3.SS6.p4.1.m1.1.1"><ci id="S3.SS6.p4.1.m1.1.1.1.cmml" xref="S3.SS6.p4.1.m1.1.1.1">~</ci><ci id="S3.SS6.p4.1.m1.1.1.2.cmml" xref="S3.SS6.p4.1.m1.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p4.1.m1.1c">\tilde{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p4.1.m1.1d">over~ start_ARG italic_F end_ARG</annotation></semantics></math> and <math alttext="\tilde{X}" class="ltx_Math" display="inline" id="S3.SS6.p4.2.m2.1"><semantics id="S3.SS6.p4.2.m2.1a"><mover accent="true" id="S3.SS6.p4.2.m2.1.1" xref="S3.SS6.p4.2.m2.1.1.cmml"><mi id="S3.SS6.p4.2.m2.1.1.2" xref="S3.SS6.p4.2.m2.1.1.2.cmml">X</mi><mo id="S3.SS6.p4.2.m2.1.1.1" xref="S3.SS6.p4.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS6.p4.2.m2.1b"><apply id="S3.SS6.p4.2.m2.1.1.cmml" xref="S3.SS6.p4.2.m2.1.1"><ci id="S3.SS6.p4.2.m2.1.1.1.cmml" xref="S3.SS6.p4.2.m2.1.1.1">~</ci><ci id="S3.SS6.p4.2.m2.1.1.2.cmml" xref="S3.SS6.p4.2.m2.1.1.2">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p4.2.m2.1c">\tilde{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p4.2.m2.1d">over~ start_ARG italic_X end_ARG</annotation></semantics></math> indicate the filtered or modulated versions of the original representations after the filtering operation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.7 </span>EchoMamba Block</h3>
<div class="ltx_para" id="S3.SS7.p1">
<p class="ltx_p" id="S3.SS7.p1.5">The EchoMamba block operates on an input <math alttext="\mathbf{F}^{l}\in\mathbb{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="S3.SS7.p1.1.m1.1"><semantics id="S3.SS7.p1.1.m1.1a"><mrow id="S3.SS7.p1.1.m1.1.1" xref="S3.SS7.p1.1.m1.1.1.cmml"><msup id="S3.SS7.p1.1.m1.1.1.2" xref="S3.SS7.p1.1.m1.1.1.2.cmml"><mi id="S3.SS7.p1.1.m1.1.1.2.2" xref="S3.SS7.p1.1.m1.1.1.2.2.cmml">𝐅</mi><mi id="S3.SS7.p1.1.m1.1.1.2.3" xref="S3.SS7.p1.1.m1.1.1.2.3.cmml">l</mi></msup><mo id="S3.SS7.p1.1.m1.1.1.1" xref="S3.SS7.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS7.p1.1.m1.1.1.3" xref="S3.SS7.p1.1.m1.1.1.3.cmml"><mi id="S3.SS7.p1.1.m1.1.1.3.2" xref="S3.SS7.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS7.p1.1.m1.1.1.3.3" xref="S3.SS7.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS7.p1.1.m1.1.1.3.3.2" xref="S3.SS7.p1.1.m1.1.1.3.3.2.cmml">B</mi><mo id="S3.SS7.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS7.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS7.p1.1.m1.1.1.3.3.3" xref="S3.SS7.p1.1.m1.1.1.3.3.3.cmml">L</mi><mo id="S3.SS7.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS7.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS7.p1.1.m1.1.1.3.3.4" xref="S3.SS7.p1.1.m1.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS7.p1.1.m1.1b"><apply id="S3.SS7.p1.1.m1.1.1.cmml" xref="S3.SS7.p1.1.m1.1.1"><in id="S3.SS7.p1.1.m1.1.1.1.cmml" xref="S3.SS7.p1.1.m1.1.1.1"></in><apply id="S3.SS7.p1.1.m1.1.1.2.cmml" xref="S3.SS7.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS7.p1.1.m1.1.1.2.1.cmml" xref="S3.SS7.p1.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS7.p1.1.m1.1.1.2.2.cmml" xref="S3.SS7.p1.1.m1.1.1.2.2">𝐅</ci><ci id="S3.SS7.p1.1.m1.1.1.2.3.cmml" xref="S3.SS7.p1.1.m1.1.1.2.3">𝑙</ci></apply><apply id="S3.SS7.p1.1.m1.1.1.3.cmml" xref="S3.SS7.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS7.p1.1.m1.1.1.3.1.cmml" xref="S3.SS7.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS7.p1.1.m1.1.1.3.2.cmml" xref="S3.SS7.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS7.p1.1.m1.1.1.3.3.cmml" xref="S3.SS7.p1.1.m1.1.1.3.3"><times id="S3.SS7.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS7.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS7.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS7.p1.1.m1.1.1.3.3.2">𝐵</ci><ci id="S3.SS7.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS7.p1.1.m1.1.1.3.3.3">𝐿</ci><ci id="S3.SS7.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS7.p1.1.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p1.1.m1.1c">\mathbf{F}^{l}\in\mathbb{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p1.1.m1.1d">bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="B" class="ltx_Math" display="inline" id="S3.SS7.p1.2.m2.1"><semantics id="S3.SS7.p1.2.m2.1a"><mi id="S3.SS7.p1.2.m2.1.1" xref="S3.SS7.p1.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p1.2.m2.1b"><ci id="S3.SS7.p1.2.m2.1.1.cmml" xref="S3.SS7.p1.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p1.2.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p1.2.m2.1d">italic_B</annotation></semantics></math> represents the batch size, <math alttext="L" class="ltx_Math" display="inline" id="S3.SS7.p1.3.m3.1"><semantics id="S3.SS7.p1.3.m3.1a"><mi id="S3.SS7.p1.3.m3.1.1" xref="S3.SS7.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p1.3.m3.1b"><ci id="S3.SS7.p1.3.m3.1.1.cmml" xref="S3.SS7.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p1.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p1.3.m3.1d">italic_L</annotation></semantics></math> denotes the sequence length, and <math alttext="D" class="ltx_Math" display="inline" id="S3.SS7.p1.4.m4.1"><semantics id="S3.SS7.p1.4.m4.1a"><mi id="S3.SS7.p1.4.m4.1.1" xref="S3.SS7.p1.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p1.4.m4.1b"><ci id="S3.SS7.p1.4.m4.1.1.cmml" xref="S3.SS7.p1.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p1.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p1.4.m4.1d">italic_D</annotation></semantics></math> signifies the hidden dimension at each time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS7.p1.5.m5.1"><semantics id="S3.SS7.p1.5.m5.1a"><mi id="S3.SS7.p1.5.m5.1.1" xref="S3.SS7.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p1.5.m5.1b"><ci id="S3.SS7.p1.5.m5.1.1.cmml" xref="S3.SS7.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p1.5.m5.1d">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS7.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{X}^{\prime}=\text{Conv1D}(\mathbf{F}^{l})," class="ltx_Math" display="block" id="S3.Ex13.m1.1"><semantics id="S3.Ex13.m1.1a"><mrow id="S3.Ex13.m1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.cmml"><mrow id="S3.Ex13.m1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.cmml"><msup id="S3.Ex13.m1.1.1.1.1.3" xref="S3.Ex13.m1.1.1.1.1.3.cmml"><mi id="S3.Ex13.m1.1.1.1.1.3.2" xref="S3.Ex13.m1.1.1.1.1.3.2.cmml">𝐗</mi><mo id="S3.Ex13.m1.1.1.1.1.3.3" xref="S3.Ex13.m1.1.1.1.1.3.3.cmml">′</mo></msup><mo id="S3.Ex13.m1.1.1.1.1.2" xref="S3.Ex13.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex13.m1.1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex13.m1.1.1.1.1.1.3" xref="S3.Ex13.m1.1.1.1.1.1.3a.cmml">Conv1D</mtext><mo id="S3.Ex13.m1.1.1.1.1.1.2" xref="S3.Ex13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex13.m1.1.1.1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex13.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex13.m1.1.1.1.1.1.1.1.1" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex13.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mi id="S3.Ex13.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S3.Ex13.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex13.m1.1.1.1.2" xref="S3.Ex13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex13.m1.1b"><apply id="S3.Ex13.m1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1"><eq id="S3.Ex13.m1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.1.1.1.1.2"></eq><apply id="S3.Ex13.m1.1.1.1.1.3.cmml" xref="S3.Ex13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex13.m1.1.1.1.1.3.1.cmml" xref="S3.Ex13.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex13.m1.1.1.1.1.3.2.cmml" xref="S3.Ex13.m1.1.1.1.1.3.2">𝐗</ci><ci id="S3.Ex13.m1.1.1.1.1.3.3.cmml" xref="S3.Ex13.m1.1.1.1.1.3.3">′</ci></apply><apply id="S3.Ex13.m1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1.1.1"><times id="S3.Ex13.m1.1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.1.1.1.1.1.2"></times><ci id="S3.Ex13.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex13.m1.1.1.1.1.1.3"><mtext id="S3.Ex13.m1.1.1.1.1.1.3.cmml" xref="S3.Ex13.m1.1.1.1.1.1.3">Conv1D</mtext></ci><apply id="S3.Ex13.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex13.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.2">𝐅</ci><ci id="S3.Ex13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex13.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex13.m1.1c">\mathbf{X}^{\prime}=\text{Conv1D}(\mathbf{F}^{l}),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex13.m1.1d">bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = Conv1D ( bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS7.p3">
<p class="ltx_p" id="S3.SS7.p3.2">It begins by performing linear projections on the input <math alttext="\mathbf{F}^{l}" class="ltx_Math" display="inline" id="S3.SS7.p3.1.m1.1"><semantics id="S3.SS7.p3.1.m1.1a"><msup id="S3.SS7.p3.1.m1.1.1" xref="S3.SS7.p3.1.m1.1.1.cmml"><mi id="S3.SS7.p3.1.m1.1.1.2" xref="S3.SS7.p3.1.m1.1.1.2.cmml">𝐅</mi><mi id="S3.SS7.p3.1.m1.1.1.3" xref="S3.SS7.p3.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS7.p3.1.m1.1b"><apply id="S3.SS7.p3.1.m1.1.1.cmml" xref="S3.SS7.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS7.p3.1.m1.1.1.1.cmml" xref="S3.SS7.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS7.p3.1.m1.1.1.2.cmml" xref="S3.SS7.p3.1.m1.1.1.2">𝐅</ci><ci id="S3.SS7.p3.1.m1.1.1.3.cmml" xref="S3.SS7.p3.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p3.1.m1.1c">\mathbf{F}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p3.1.m1.1d">bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> with an expanded hidden dimension to obtain <math alttext="\mathbf{X}^{\prime}" class="ltx_Math" display="inline" id="S3.SS7.p3.2.m2.1"><semantics id="S3.SS7.p3.2.m2.1a"><msup id="S3.SS7.p3.2.m2.1.1" xref="S3.SS7.p3.2.m2.1.1.cmml"><mi id="S3.SS7.p3.2.m2.1.1.2" xref="S3.SS7.p3.2.m2.1.1.2.cmml">𝐗</mi><mo id="S3.SS7.p3.2.m2.1.1.3" xref="S3.SS7.p3.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS7.p3.2.m2.1b"><apply id="S3.SS7.p3.2.m2.1.1.cmml" xref="S3.SS7.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS7.p3.2.m2.1.1.1.cmml" xref="S3.SS7.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS7.p3.2.m2.1.1.2.cmml" xref="S3.SS7.p3.2.m2.1.1.2">𝐗</ci><ci id="S3.SS7.p3.2.m2.1.1.3.cmml" xref="S3.SS7.p3.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p3.2.m2.1c">\mathbf{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p3.2.m2.1d">bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. This projection is then processed through a 1D convolution and a SiLU activation. The SiLU (Sigmoid Linear Unit) activation function is defined as:</p>
</div>
<div class="ltx_para" id="S3.SS7.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{SiLU}(\mathbf{X}^{\prime})=\mathbf{X}^{\prime}\cdot\sigma(\mathbf{X}^{%
\prime}),\quad\text{where}\quad\sigma(\mathbf{X}^{\prime})=\frac{1}{1+e^{-%
\mathbf{X}^{\prime}}}," class="ltx_Math" display="block" id="S3.Ex15.m1.2"><semantics id="S3.Ex15.m1.2a"><mrow id="S3.Ex15.m1.2.2.1"><mrow id="S3.Ex15.m1.2.2.1.1.2" xref="S3.Ex15.m1.2.2.1.1.3.cmml"><mrow id="S3.Ex15.m1.2.2.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.cmml"><mrow id="S3.Ex15.m1.2.2.1.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.1.cmml"><mtext id="S3.Ex15.m1.2.2.1.1.1.1.1.3" xref="S3.Ex15.m1.2.2.1.1.1.1.1.3a.cmml">SiLU</mtext><mo id="S3.Ex15.m1.2.2.1.1.1.1.1.2" xref="S3.Ex15.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mo id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex15.m1.2.2.1.1.1.1.3" xref="S3.Ex15.m1.2.2.1.1.1.1.3.cmml">=</mo><mrow id="S3.Ex15.m1.2.2.1.1.1.1.2.1" xref="S3.Ex15.m1.2.2.1.1.1.1.2.2.cmml"><mrow id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.cmml"><mrow id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.cmml"><msup id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.cmml"><mi id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.2" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.2.cmml">𝐗</mi><mo id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.3" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.3.cmml">′</mo></msup><mo id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.1.cmml">⋅</mo><mi id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.3" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.3.cmml">σ</mi></mrow><mo id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.2" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml"><mo id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.2" stretchy="false" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.2" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.2.cmml">𝐗</mi><mo id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.3" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.3" stretchy="false" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex15.m1.2.2.1.1.1.1.2.1.2" rspace="1.167em" xref="S3.Ex15.m1.2.2.1.1.1.1.2.2.cmml">,</mo><mtext id="S3.Ex15.m1.1.1" xref="S3.Ex15.m1.1.1a.cmml">where</mtext></mrow></mrow><mspace id="S3.Ex15.m1.2.2.1.1.2.3" width="1em" xref="S3.Ex15.m1.2.2.1.1.3a.cmml"></mspace><mrow id="S3.Ex15.m1.2.2.1.1.2.2" xref="S3.Ex15.m1.2.2.1.1.2.2.cmml"><mrow id="S3.Ex15.m1.2.2.1.1.2.2.1" xref="S3.Ex15.m1.2.2.1.1.2.2.1.cmml"><mi id="S3.Ex15.m1.2.2.1.1.2.2.1.3" xref="S3.Ex15.m1.2.2.1.1.2.2.1.3.cmml">σ</mi><mo id="S3.Ex15.m1.2.2.1.1.2.2.1.2" xref="S3.Ex15.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mo id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.cmml">(</mo><msup id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mi id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.2" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.2.cmml">𝐗</mi><mo id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.3" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.3" stretchy="false" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex15.m1.2.2.1.1.2.2.2" xref="S3.Ex15.m1.2.2.1.1.2.2.2.cmml">=</mo><mfrac id="S3.Ex15.m1.2.2.1.1.2.2.3" xref="S3.Ex15.m1.2.2.1.1.2.2.3.cmml"><mn id="S3.Ex15.m1.2.2.1.1.2.2.3.2" xref="S3.Ex15.m1.2.2.1.1.2.2.3.2.cmml">1</mn><mrow id="S3.Ex15.m1.2.2.1.1.2.2.3.3" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.cmml"><mn id="S3.Ex15.m1.2.2.1.1.2.2.3.3.2" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.2.cmml">1</mn><mo id="S3.Ex15.m1.2.2.1.1.2.2.3.3.1" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.1.cmml">+</mo><msup id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.cmml"><mi id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.2" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.2.cmml">e</mi><mrow id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.cmml"><mo id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3a" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.cmml">−</mo><msup id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.cmml"><mi id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.2" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.2.cmml">𝐗</mi><mo id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.3" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.3.cmml">′</mo></msup></mrow></msup></mrow></mfrac></mrow></mrow><mo id="S3.Ex15.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex15.m1.2b"><apply id="S3.Ex15.m1.2.2.1.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex15.m1.2.2.1.1.3a.cmml" xref="S3.Ex15.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex15.m1.2.2.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1"><eq id="S3.Ex15.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.3"></eq><apply id="S3.Ex15.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1"><times id="S3.Ex15.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1.2"></times><ci id="S3.Ex15.m1.2.2.1.1.1.1.1.3a.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1.3"><mtext id="S3.Ex15.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1.3">SiLU</mtext></ci><apply id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.1.1.1.1.3">′</ci></apply></apply><list id="S3.Ex15.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1"><apply id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1"><times id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.2.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.2"></times><apply id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3"><ci id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.1">⋅</ci><apply id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2">superscript</csymbol><ci id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.2.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.2">𝐗</ci><ci id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.3.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.2.3">′</ci></apply><ci id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.3.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.3.3">𝜎</ci></apply><apply id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1">superscript</csymbol><ci id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.2">𝐗</ci><ci id="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.1.1.2.1.1.1.1.1.3">′</ci></apply></apply><ci id="S3.Ex15.m1.1.1a.cmml" xref="S3.Ex15.m1.1.1"><mtext id="S3.Ex15.m1.1.1.cmml" xref="S3.Ex15.m1.1.1">where</mtext></ci></list></apply><apply id="S3.Ex15.m1.2.2.1.1.2.2.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2"><eq id="S3.Ex15.m1.2.2.1.1.2.2.2.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.2"></eq><apply id="S3.Ex15.m1.2.2.1.1.2.2.1.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.1"><times id="S3.Ex15.m1.2.2.1.1.2.2.1.2.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.1.2"></times><ci id="S3.Ex15.m1.2.2.1.1.2.2.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.1.3">𝜎</ci><apply id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1">superscript</csymbol><ci id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.2">𝐗</ci><ci id="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.1.1.1.1.3">′</ci></apply></apply><apply id="S3.Ex15.m1.2.2.1.1.2.2.3.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3"><divide id="S3.Ex15.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3"></divide><cn id="S3.Ex15.m1.2.2.1.1.2.2.3.2.cmml" type="integer" xref="S3.Ex15.m1.2.2.1.1.2.2.3.2">1</cn><apply id="S3.Ex15.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3"><plus id="S3.Ex15.m1.2.2.1.1.2.2.3.3.1.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.1"></plus><cn id="S3.Ex15.m1.2.2.1.1.2.2.3.3.2.cmml" type="integer" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.2">1</cn><apply id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.1.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3">superscript</csymbol><ci id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.2.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.2">𝑒</ci><apply id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3"><minus id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.1.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3"></minus><apply id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.1.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2">superscript</csymbol><ci id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.2.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.2">𝐗</ci><ci id="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.3.cmml" xref="S3.Ex15.m1.2.2.1.1.2.2.3.3.3.3.2.3">′</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex15.m1.2c">\text{SiLU}(\mathbf{X}^{\prime})=\mathbf{X}^{\prime}\cdot\sigma(\mathbf{X}^{%
\prime}),\quad\text{where}\quad\sigma(\mathbf{X}^{\prime})=\frac{1}{1+e^{-%
\mathbf{X}^{\prime}}},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex15.m1.2d">SiLU ( bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ⋅ italic_σ ( bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) , where italic_σ ( bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = divide start_ARG 1 end_ARG start_ARG 1 + italic_e start_POSTSUPERSCRIPT - bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS7.p5">
<p class="ltx_p" id="S3.SS7.p5.1">The core of the block involves a selective state space model (SSM) with parameters discretized based on the input.</p>
</div>
<div class="ltx_para" id="S3.SS7.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{H}=\text{SSM}(\mathbf{X}^{\prime})," class="ltx_Math" display="block" id="S3.Ex17.m1.1"><semantics id="S3.Ex17.m1.1a"><mrow id="S3.Ex17.m1.1.1.1" xref="S3.Ex17.m1.1.1.1.1.cmml"><mrow id="S3.Ex17.m1.1.1.1.1" xref="S3.Ex17.m1.1.1.1.1.cmml"><mi id="S3.Ex17.m1.1.1.1.1.3" xref="S3.Ex17.m1.1.1.1.1.3.cmml">𝐇</mi><mo id="S3.Ex17.m1.1.1.1.1.2" xref="S3.Ex17.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex17.m1.1.1.1.1.1" xref="S3.Ex17.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex17.m1.1.1.1.1.1.3" xref="S3.Ex17.m1.1.1.1.1.1.3a.cmml">SSM</mtext><mo id="S3.Ex17.m1.1.1.1.1.1.2" xref="S3.Ex17.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex17.m1.1.1.1.1.1.1.1" xref="S3.Ex17.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex17.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex17.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.Ex17.m1.1.1.1.1.1.1.1.1" xref="S3.Ex17.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex17.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex17.m1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mo id="S3.Ex17.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex17.m1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex17.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex17.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex17.m1.1.1.1.2" xref="S3.Ex17.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex17.m1.1b"><apply id="S3.Ex17.m1.1.1.1.1.cmml" xref="S3.Ex17.m1.1.1.1"><eq id="S3.Ex17.m1.1.1.1.1.2.cmml" xref="S3.Ex17.m1.1.1.1.1.2"></eq><ci id="S3.Ex17.m1.1.1.1.1.3.cmml" xref="S3.Ex17.m1.1.1.1.1.3">𝐇</ci><apply id="S3.Ex17.m1.1.1.1.1.1.cmml" xref="S3.Ex17.m1.1.1.1.1.1"><times id="S3.Ex17.m1.1.1.1.1.1.2.cmml" xref="S3.Ex17.m1.1.1.1.1.1.2"></times><ci id="S3.Ex17.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex17.m1.1.1.1.1.1.3"><mtext id="S3.Ex17.m1.1.1.1.1.1.3.cmml" xref="S3.Ex17.m1.1.1.1.1.1.3">SSM</mtext></ci><apply id="S3.Ex17.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex17.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex17.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex17.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex17.m1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="S3.Ex17.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex17.m1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex17.m1.1c">\mathbf{H}=\text{SSM}(\mathbf{X}^{\prime}),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex17.m1.1d">bold_H = SSM ( bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS7.p7">
<p class="ltx_p" id="S3.SS7.p7.5">This discretized SSM generates the state representation <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS7.p7.1.m1.1"><semantics id="S3.SS7.p7.1.m1.1a"><mi id="S3.SS7.p7.1.m1.1.1" xref="S3.SS7.p7.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p7.1.m1.1b"><ci id="S3.SS7.p7.1.m1.1.1.cmml" xref="S3.SS7.p7.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p7.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p7.1.m1.1d">bold_H</annotation></semantics></math>. Finally, <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS7.p7.2.m2.1"><semantics id="S3.SS7.p7.2.m2.1a"><mi id="S3.SS7.p7.2.m2.1.1" xref="S3.SS7.p7.2.m2.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p7.2.m2.1b"><ci id="S3.SS7.p7.2.m2.1.1.cmml" xref="S3.SS7.p7.2.m2.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p7.2.m2.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p7.2.m2.1d">bold_H</annotation></semantics></math> is combined with a residual connection from <math alttext="\mathbf{X}^{\prime}" class="ltx_Math" display="inline" id="S3.SS7.p7.3.m3.1"><semantics id="S3.SS7.p7.3.m3.1a"><msup id="S3.SS7.p7.3.m3.1.1" xref="S3.SS7.p7.3.m3.1.1.cmml"><mi id="S3.SS7.p7.3.m3.1.1.2" xref="S3.SS7.p7.3.m3.1.1.2.cmml">𝐗</mi><mo id="S3.SS7.p7.3.m3.1.1.3" xref="S3.SS7.p7.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS7.p7.3.m3.1b"><apply id="S3.SS7.p7.3.m3.1.1.cmml" xref="S3.SS7.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS7.p7.3.m3.1.1.1.cmml" xref="S3.SS7.p7.3.m3.1.1">superscript</csymbol><ci id="S3.SS7.p7.3.m3.1.1.2.cmml" xref="S3.SS7.p7.3.m3.1.1.2">𝐗</ci><ci id="S3.SS7.p7.3.m3.1.1.3.cmml" xref="S3.SS7.p7.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p7.3.m3.1c">\mathbf{X}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p7.3.m3.1d">bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> after applying SiLU, and a final linear projection delivers the final output <math alttext="\mathbf{Y}_{t}" class="ltx_Math" display="inline" id="S3.SS7.p7.4.m4.1"><semantics id="S3.SS7.p7.4.m4.1a"><msub id="S3.SS7.p7.4.m4.1.1" xref="S3.SS7.p7.4.m4.1.1.cmml"><mi id="S3.SS7.p7.4.m4.1.1.2" xref="S3.SS7.p7.4.m4.1.1.2.cmml">𝐘</mi><mi id="S3.SS7.p7.4.m4.1.1.3" xref="S3.SS7.p7.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS7.p7.4.m4.1b"><apply id="S3.SS7.p7.4.m4.1.1.cmml" xref="S3.SS7.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS7.p7.4.m4.1.1.1.cmml" xref="S3.SS7.p7.4.m4.1.1">subscript</csymbol><ci id="S3.SS7.p7.4.m4.1.1.2.cmml" xref="S3.SS7.p7.4.m4.1.1.2">𝐘</ci><ci id="S3.SS7.p7.4.m4.1.1.3.cmml" xref="S3.SS7.p7.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p7.4.m4.1c">\mathbf{Y}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p7.4.m4.1d">bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS7.p7.5.m5.1"><semantics id="S3.SS7.p7.5.m5.1a"><mi id="S3.SS7.p7.5.m5.1.1" xref="S3.SS7.p7.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p7.5.m5.1b"><ci id="S3.SS7.p7.5.m5.1.1.cmml" xref="S3.SS7.p7.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p7.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p7.5.m5.1d">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS7.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{Y}_{t}=\text{Linear}(\text{SiLU}(\mathbf{H})+\mathbf{X}^{\prime})," class="ltx_Math" display="block" id="S3.Ex19.m1.2"><semantics id="S3.Ex19.m1.2a"><mrow id="S3.Ex19.m1.2.2.1" xref="S3.Ex19.m1.2.2.1.1.cmml"><mrow id="S3.Ex19.m1.2.2.1.1" xref="S3.Ex19.m1.2.2.1.1.cmml"><msub id="S3.Ex19.m1.2.2.1.1.3" xref="S3.Ex19.m1.2.2.1.1.3.cmml"><mi id="S3.Ex19.m1.2.2.1.1.3.2" xref="S3.Ex19.m1.2.2.1.1.3.2.cmml">𝐘</mi><mi id="S3.Ex19.m1.2.2.1.1.3.3" xref="S3.Ex19.m1.2.2.1.1.3.3.cmml">t</mi></msub><mo id="S3.Ex19.m1.2.2.1.1.2" xref="S3.Ex19.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.Ex19.m1.2.2.1.1.1" xref="S3.Ex19.m1.2.2.1.1.1.cmml"><mtext id="S3.Ex19.m1.2.2.1.1.1.3" xref="S3.Ex19.m1.2.2.1.1.1.3a.cmml">Linear</mtext><mo id="S3.Ex19.m1.2.2.1.1.1.2" xref="S3.Ex19.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex19.m1.2.2.1.1.1.1.1" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex19.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex19.m1.2.2.1.1.1.1.1.1" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.cmml"><mtext id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.2a.cmml">SiLU</mtext><mo id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.Ex19.m1.1.1" xref="S3.Ex19.m1.1.1.cmml">𝐇</mi><mo id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex19.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.Ex19.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝐗</mi><mo id="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S3.Ex19.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex19.m1.2.2.1.2" xref="S3.Ex19.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex19.m1.2b"><apply id="S3.Ex19.m1.2.2.1.1.cmml" xref="S3.Ex19.m1.2.2.1"><eq id="S3.Ex19.m1.2.2.1.1.2.cmml" xref="S3.Ex19.m1.2.2.1.1.2"></eq><apply id="S3.Ex19.m1.2.2.1.1.3.cmml" xref="S3.Ex19.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex19.m1.2.2.1.1.3.1.cmml" xref="S3.Ex19.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex19.m1.2.2.1.1.3.2.cmml" xref="S3.Ex19.m1.2.2.1.1.3.2">𝐘</ci><ci id="S3.Ex19.m1.2.2.1.1.3.3.cmml" xref="S3.Ex19.m1.2.2.1.1.3.3">𝑡</ci></apply><apply id="S3.Ex19.m1.2.2.1.1.1.cmml" xref="S3.Ex19.m1.2.2.1.1.1"><times id="S3.Ex19.m1.2.2.1.1.1.2.cmml" xref="S3.Ex19.m1.2.2.1.1.1.2"></times><ci id="S3.Ex19.m1.2.2.1.1.1.3a.cmml" xref="S3.Ex19.m1.2.2.1.1.1.3"><mtext id="S3.Ex19.m1.2.2.1.1.1.3.cmml" xref="S3.Ex19.m1.2.2.1.1.1.3">Linear</mtext></ci><apply id="S3.Ex19.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1"><plus id="S3.Ex19.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2"><times id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.1"></times><ci id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.2a.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.2"><mtext id="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.2.2">SiLU</mtext></ci><ci id="S3.Ex19.m1.1.1.cmml" xref="S3.Ex19.m1.1.1">𝐇</ci></apply><apply id="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.2">𝐗</ci><ci id="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex19.m1.2.2.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex19.m1.2c">\mathbf{Y}_{t}=\text{Linear}(\text{SiLU}(\mathbf{H})+\mathbf{X}^{\prime}),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex19.m1.2d">bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = Linear ( SiLU ( bold_H ) + bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS7.p9">
<p class="ltx_p" id="S3.SS7.p9.1">To further enhance the model, the EchoMamba block employs bidirectional processing. This means it processes sequences in both forward and reverse order. For a given user sequence <math alttext="u=[v_{n_{u}},v_{n_{u}-1},\ldots,v_{1}]" class="ltx_Math" display="inline" id="S3.SS7.p9.1.m1.4"><semantics id="S3.SS7.p9.1.m1.4a"><mrow id="S3.SS7.p9.1.m1.4.4" xref="S3.SS7.p9.1.m1.4.4.cmml"><mi id="S3.SS7.p9.1.m1.4.4.5" xref="S3.SS7.p9.1.m1.4.4.5.cmml">u</mi><mo id="S3.SS7.p9.1.m1.4.4.4" xref="S3.SS7.p9.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS7.p9.1.m1.4.4.3.3" xref="S3.SS7.p9.1.m1.4.4.3.4.cmml"><mo id="S3.SS7.p9.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS7.p9.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS7.p9.1.m1.2.2.1.1.1" xref="S3.SS7.p9.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS7.p9.1.m1.2.2.1.1.1.2" xref="S3.SS7.p9.1.m1.2.2.1.1.1.2.cmml">v</mi><msub id="S3.SS7.p9.1.m1.2.2.1.1.1.3" xref="S3.SS7.p9.1.m1.2.2.1.1.1.3.cmml"><mi id="S3.SS7.p9.1.m1.2.2.1.1.1.3.2" xref="S3.SS7.p9.1.m1.2.2.1.1.1.3.2.cmml">n</mi><mi id="S3.SS7.p9.1.m1.2.2.1.1.1.3.3" xref="S3.SS7.p9.1.m1.2.2.1.1.1.3.3.cmml">u</mi></msub></msub><mo id="S3.SS7.p9.1.m1.4.4.3.3.5" xref="S3.SS7.p9.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS7.p9.1.m1.3.3.2.2.2" xref="S3.SS7.p9.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS7.p9.1.m1.3.3.2.2.2.2" xref="S3.SS7.p9.1.m1.3.3.2.2.2.2.cmml">v</mi><mrow id="S3.SS7.p9.1.m1.3.3.2.2.2.3" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.cmml"><msub id="S3.SS7.p9.1.m1.3.3.2.2.2.3.2" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.cmml"><mi id="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.2" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.2.cmml">n</mi><mi id="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.3" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.3.cmml">u</mi></msub><mo id="S3.SS7.p9.1.m1.3.3.2.2.2.3.1" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.1.cmml">−</mo><mn id="S3.SS7.p9.1.m1.3.3.2.2.2.3.3" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS7.p9.1.m1.4.4.3.3.6" xref="S3.SS7.p9.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS7.p9.1.m1.1.1" mathvariant="normal" xref="S3.SS7.p9.1.m1.1.1.cmml">…</mi><mo id="S3.SS7.p9.1.m1.4.4.3.3.7" xref="S3.SS7.p9.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS7.p9.1.m1.4.4.3.3.3" xref="S3.SS7.p9.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS7.p9.1.m1.4.4.3.3.3.2" xref="S3.SS7.p9.1.m1.4.4.3.3.3.2.cmml">v</mi><mn id="S3.SS7.p9.1.m1.4.4.3.3.3.3" xref="S3.SS7.p9.1.m1.4.4.3.3.3.3.cmml">1</mn></msub><mo id="S3.SS7.p9.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS7.p9.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS7.p9.1.m1.4b"><apply id="S3.SS7.p9.1.m1.4.4.cmml" xref="S3.SS7.p9.1.m1.4.4"><eq id="S3.SS7.p9.1.m1.4.4.4.cmml" xref="S3.SS7.p9.1.m1.4.4.4"></eq><ci id="S3.SS7.p9.1.m1.4.4.5.cmml" xref="S3.SS7.p9.1.m1.4.4.5">𝑢</ci><list id="S3.SS7.p9.1.m1.4.4.3.4.cmml" xref="S3.SS7.p9.1.m1.4.4.3.3"><apply id="S3.SS7.p9.1.m1.2.2.1.1.1.cmml" xref="S3.SS7.p9.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS7.p9.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS7.p9.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS7.p9.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS7.p9.1.m1.2.2.1.1.1.2">𝑣</ci><apply id="S3.SS7.p9.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS7.p9.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS7.p9.1.m1.2.2.1.1.1.3.1.cmml" xref="S3.SS7.p9.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS7.p9.1.m1.2.2.1.1.1.3.2.cmml" xref="S3.SS7.p9.1.m1.2.2.1.1.1.3.2">𝑛</ci><ci id="S3.SS7.p9.1.m1.2.2.1.1.1.3.3.cmml" xref="S3.SS7.p9.1.m1.2.2.1.1.1.3.3">𝑢</ci></apply></apply><apply id="S3.SS7.p9.1.m1.3.3.2.2.2.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS7.p9.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS7.p9.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2.2">𝑣</ci><apply id="S3.SS7.p9.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3"><minus id="S3.SS7.p9.1.m1.3.3.2.2.2.3.1.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.1"></minus><apply id="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.1.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.2">subscript</csymbol><ci id="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.2.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.2">𝑛</ci><ci id="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.3.cmml" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.2.3">𝑢</ci></apply><cn id="S3.SS7.p9.1.m1.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.SS7.p9.1.m1.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S3.SS7.p9.1.m1.1.1.cmml" xref="S3.SS7.p9.1.m1.1.1">…</ci><apply id="S3.SS7.p9.1.m1.4.4.3.3.3.cmml" xref="S3.SS7.p9.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS7.p9.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS7.p9.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS7.p9.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS7.p9.1.m1.4.4.3.3.3.2">𝑣</ci><cn id="S3.SS7.p9.1.m1.4.4.3.3.3.3.cmml" type="integer" xref="S3.SS7.p9.1.m1.4.4.3.3.3.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p9.1.m1.4c">u=[v_{n_{u}},v_{n_{u}-1},\ldots,v_{1}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p9.1.m1.4d">italic_u = [ italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT - 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>, the model captures dependencies from both directions. The forward sequence is processed as described above. For the reverse sequence, we define:</p>
</div>
<div class="ltx_para" id="S3.SS7.p10">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{X}^{\prime}_{rev}=\text{Conv1D}(\mathbf{F}^{l}_{rev})," class="ltx_Math" display="block" id="S3.Ex21.m1.1"><semantics id="S3.Ex21.m1.1a"><mrow id="S3.Ex21.m1.1.1.1" xref="S3.Ex21.m1.1.1.1.1.cmml"><mrow id="S3.Ex21.m1.1.1.1.1" xref="S3.Ex21.m1.1.1.1.1.cmml"><msubsup id="S3.Ex21.m1.1.1.1.1.3" xref="S3.Ex21.m1.1.1.1.1.3.cmml"><mi id="S3.Ex21.m1.1.1.1.1.3.2.2" xref="S3.Ex21.m1.1.1.1.1.3.2.2.cmml">𝐗</mi><mrow id="S3.Ex21.m1.1.1.1.1.3.3" xref="S3.Ex21.m1.1.1.1.1.3.3.cmml"><mi id="S3.Ex21.m1.1.1.1.1.3.3.2" xref="S3.Ex21.m1.1.1.1.1.3.3.2.cmml">r</mi><mo id="S3.Ex21.m1.1.1.1.1.3.3.1" xref="S3.Ex21.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex21.m1.1.1.1.1.3.3.3" xref="S3.Ex21.m1.1.1.1.1.3.3.3.cmml">e</mi><mo id="S3.Ex21.m1.1.1.1.1.3.3.1a" xref="S3.Ex21.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex21.m1.1.1.1.1.3.3.4" xref="S3.Ex21.m1.1.1.1.1.3.3.4.cmml">v</mi></mrow><mo id="S3.Ex21.m1.1.1.1.1.3.2.3" xref="S3.Ex21.m1.1.1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S3.Ex21.m1.1.1.1.1.2" xref="S3.Ex21.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex21.m1.1.1.1.1.1" xref="S3.Ex21.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex21.m1.1.1.1.1.1.3" xref="S3.Ex21.m1.1.1.1.1.1.3a.cmml">Conv1D</mtext><mo id="S3.Ex21.m1.1.1.1.1.1.2" xref="S3.Ex21.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex21.m1.1.1.1.1.1.1.1" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex21.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.Ex21.m1.1.1.1.1.1.1.1.1" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐅</mi><mrow id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mo id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.1a" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.4" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.4.cmml">v</mi></mrow><mi id="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.Ex21.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex21.m1.1.1.1.2" xref="S3.Ex21.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex21.m1.1b"><apply id="S3.Ex21.m1.1.1.1.1.cmml" xref="S3.Ex21.m1.1.1.1"><eq id="S3.Ex21.m1.1.1.1.1.2.cmml" xref="S3.Ex21.m1.1.1.1.1.2"></eq><apply id="S3.Ex21.m1.1.1.1.1.3.cmml" xref="S3.Ex21.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex21.m1.1.1.1.1.3.1.cmml" xref="S3.Ex21.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex21.m1.1.1.1.1.3.2.cmml" xref="S3.Ex21.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex21.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex21.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex21.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex21.m1.1.1.1.1.3.2.2">𝐗</ci><ci id="S3.Ex21.m1.1.1.1.1.3.2.3.cmml" xref="S3.Ex21.m1.1.1.1.1.3.2.3">′</ci></apply><apply id="S3.Ex21.m1.1.1.1.1.3.3.cmml" xref="S3.Ex21.m1.1.1.1.1.3.3"><times id="S3.Ex21.m1.1.1.1.1.3.3.1.cmml" xref="S3.Ex21.m1.1.1.1.1.3.3.1"></times><ci id="S3.Ex21.m1.1.1.1.1.3.3.2.cmml" xref="S3.Ex21.m1.1.1.1.1.3.3.2">𝑟</ci><ci id="S3.Ex21.m1.1.1.1.1.3.3.3.cmml" xref="S3.Ex21.m1.1.1.1.1.3.3.3">𝑒</ci><ci id="S3.Ex21.m1.1.1.1.1.3.3.4.cmml" xref="S3.Ex21.m1.1.1.1.1.3.3.4">𝑣</ci></apply></apply><apply id="S3.Ex21.m1.1.1.1.1.1.cmml" xref="S3.Ex21.m1.1.1.1.1.1"><times id="S3.Ex21.m1.1.1.1.1.1.2.cmml" xref="S3.Ex21.m1.1.1.1.1.1.2"></times><ci id="S3.Ex21.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex21.m1.1.1.1.1.1.3"><mtext id="S3.Ex21.m1.1.1.1.1.1.3.cmml" xref="S3.Ex21.m1.1.1.1.1.1.3">Conv1D</mtext></ci><apply id="S3.Ex21.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex21.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.2">𝐅</ci><ci id="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.Ex21.m1.1.1.1.1.1.1.1.1.3.4">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex21.m1.1c">\mathbf{X}^{\prime}_{rev}=\text{Conv1D}(\mathbf{F}^{l}_{rev}),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex21.m1.1d">bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_v end_POSTSUBSCRIPT = Conv1D ( bold_F start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_v end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS7.p11">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{H}_{rev}=\text{SSM}(\mathbf{X}^{\prime}_{rev})," class="ltx_Math" display="block" id="S3.Ex23.m1.1"><semantics id="S3.Ex23.m1.1a"><mrow id="S3.Ex23.m1.1.1.1" xref="S3.Ex23.m1.1.1.1.1.cmml"><mrow id="S3.Ex23.m1.1.1.1.1" xref="S3.Ex23.m1.1.1.1.1.cmml"><msub id="S3.Ex23.m1.1.1.1.1.3" xref="S3.Ex23.m1.1.1.1.1.3.cmml"><mi id="S3.Ex23.m1.1.1.1.1.3.2" xref="S3.Ex23.m1.1.1.1.1.3.2.cmml">𝐇</mi><mrow id="S3.Ex23.m1.1.1.1.1.3.3" xref="S3.Ex23.m1.1.1.1.1.3.3.cmml"><mi id="S3.Ex23.m1.1.1.1.1.3.3.2" xref="S3.Ex23.m1.1.1.1.1.3.3.2.cmml">r</mi><mo id="S3.Ex23.m1.1.1.1.1.3.3.1" xref="S3.Ex23.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex23.m1.1.1.1.1.3.3.3" xref="S3.Ex23.m1.1.1.1.1.3.3.3.cmml">e</mi><mo id="S3.Ex23.m1.1.1.1.1.3.3.1a" xref="S3.Ex23.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex23.m1.1.1.1.1.3.3.4" xref="S3.Ex23.m1.1.1.1.1.3.3.4.cmml">v</mi></mrow></msub><mo id="S3.Ex23.m1.1.1.1.1.2" xref="S3.Ex23.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex23.m1.1.1.1.1.1" xref="S3.Ex23.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex23.m1.1.1.1.1.1.3" xref="S3.Ex23.m1.1.1.1.1.1.3a.cmml">SSM</mtext><mo id="S3.Ex23.m1.1.1.1.1.1.2" xref="S3.Ex23.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex23.m1.1.1.1.1.1.1.1" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex23.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.Ex23.m1.1.1.1.1.1.1.1.1" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mo id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.1a" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.4" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.4.cmml">v</mi></mrow><mo id="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.Ex23.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex23.m1.1.1.1.2" xref="S3.Ex23.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex23.m1.1b"><apply id="S3.Ex23.m1.1.1.1.1.cmml" xref="S3.Ex23.m1.1.1.1"><eq id="S3.Ex23.m1.1.1.1.1.2.cmml" xref="S3.Ex23.m1.1.1.1.1.2"></eq><apply id="S3.Ex23.m1.1.1.1.1.3.cmml" xref="S3.Ex23.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex23.m1.1.1.1.1.3.1.cmml" xref="S3.Ex23.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex23.m1.1.1.1.1.3.2.cmml" xref="S3.Ex23.m1.1.1.1.1.3.2">𝐇</ci><apply id="S3.Ex23.m1.1.1.1.1.3.3.cmml" xref="S3.Ex23.m1.1.1.1.1.3.3"><times id="S3.Ex23.m1.1.1.1.1.3.3.1.cmml" xref="S3.Ex23.m1.1.1.1.1.3.3.1"></times><ci id="S3.Ex23.m1.1.1.1.1.3.3.2.cmml" xref="S3.Ex23.m1.1.1.1.1.3.3.2">𝑟</ci><ci id="S3.Ex23.m1.1.1.1.1.3.3.3.cmml" xref="S3.Ex23.m1.1.1.1.1.3.3.3">𝑒</ci><ci id="S3.Ex23.m1.1.1.1.1.3.3.4.cmml" xref="S3.Ex23.m1.1.1.1.1.3.3.4">𝑣</ci></apply></apply><apply id="S3.Ex23.m1.1.1.1.1.1.cmml" xref="S3.Ex23.m1.1.1.1.1.1"><times id="S3.Ex23.m1.1.1.1.1.1.2.cmml" xref="S3.Ex23.m1.1.1.1.1.1.2"></times><ci id="S3.Ex23.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex23.m1.1.1.1.1.1.3"><mtext id="S3.Ex23.m1.1.1.1.1.1.3.cmml" xref="S3.Ex23.m1.1.1.1.1.1.3">SSM</mtext></ci><apply id="S3.Ex23.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex23.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.2">𝐗</ci><ci id="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.Ex23.m1.1.1.1.1.1.1.1.1.3.4">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex23.m1.1c">\mathbf{H}_{rev}=\text{SSM}(\mathbf{X}^{\prime}_{rev}),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex23.m1.1d">bold_H start_POSTSUBSCRIPT italic_r italic_e italic_v end_POSTSUBSCRIPT = SSM ( bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_v end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS7.p12">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex25">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{Y}_{t,rev}=\text{Linear}(\text{SiLU}(\mathbf{H}_{rev})+\mathbf{X}^{%
\prime}_{rev})." class="ltx_Math" display="block" id="S3.Ex25.m1.3"><semantics id="S3.Ex25.m1.3a"><mrow id="S3.Ex25.m1.3.3.1" xref="S3.Ex25.m1.3.3.1.1.cmml"><mrow id="S3.Ex25.m1.3.3.1.1" xref="S3.Ex25.m1.3.3.1.1.cmml"><msub id="S3.Ex25.m1.3.3.1.1.3" xref="S3.Ex25.m1.3.3.1.1.3.cmml"><mi id="S3.Ex25.m1.3.3.1.1.3.2" xref="S3.Ex25.m1.3.3.1.1.3.2.cmml">𝐘</mi><mrow id="S3.Ex25.m1.2.2.2.2" xref="S3.Ex25.m1.2.2.2.3.cmml"><mi id="S3.Ex25.m1.1.1.1.1" xref="S3.Ex25.m1.1.1.1.1.cmml">t</mi><mo id="S3.Ex25.m1.2.2.2.2.2" xref="S3.Ex25.m1.2.2.2.3.cmml">,</mo><mrow id="S3.Ex25.m1.2.2.2.2.1" xref="S3.Ex25.m1.2.2.2.2.1.cmml"><mi id="S3.Ex25.m1.2.2.2.2.1.2" xref="S3.Ex25.m1.2.2.2.2.1.2.cmml">r</mi><mo id="S3.Ex25.m1.2.2.2.2.1.1" xref="S3.Ex25.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.Ex25.m1.2.2.2.2.1.3" xref="S3.Ex25.m1.2.2.2.2.1.3.cmml">e</mi><mo id="S3.Ex25.m1.2.2.2.2.1.1a" xref="S3.Ex25.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.Ex25.m1.2.2.2.2.1.4" xref="S3.Ex25.m1.2.2.2.2.1.4.cmml">v</mi></mrow></mrow></msub><mo id="S3.Ex25.m1.3.3.1.1.2" xref="S3.Ex25.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.Ex25.m1.3.3.1.1.1" xref="S3.Ex25.m1.3.3.1.1.1.cmml"><mtext id="S3.Ex25.m1.3.3.1.1.1.3" xref="S3.Ex25.m1.3.3.1.1.1.3a.cmml">Linear</mtext><mo id="S3.Ex25.m1.3.3.1.1.1.2" xref="S3.Ex25.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex25.m1.3.3.1.1.1.1.1" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex25.m1.3.3.1.1.1.1.1.1" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.cmml"><mtext id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.3a.cmml">SiLU</mtext><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐇</mi><mrow id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.4.cmml">v</mi></mrow></msub><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.2.cmml">+</mo><msubsup id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">𝐗</mi><mrow id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.2" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">r</mi><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.1" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.3.cmml">e</mi><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.1a" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.4" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.4.cmml">v</mi></mrow><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.Ex25.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex25.m1.3.3.1.2" lspace="0em" xref="S3.Ex25.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex25.m1.3b"><apply id="S3.Ex25.m1.3.3.1.1.cmml" xref="S3.Ex25.m1.3.3.1"><eq id="S3.Ex25.m1.3.3.1.1.2.cmml" xref="S3.Ex25.m1.3.3.1.1.2"></eq><apply id="S3.Ex25.m1.3.3.1.1.3.cmml" xref="S3.Ex25.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex25.m1.3.3.1.1.3.1.cmml" xref="S3.Ex25.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.Ex25.m1.3.3.1.1.3.2.cmml" xref="S3.Ex25.m1.3.3.1.1.3.2">𝐘</ci><list id="S3.Ex25.m1.2.2.2.3.cmml" xref="S3.Ex25.m1.2.2.2.2"><ci id="S3.Ex25.m1.1.1.1.1.cmml" xref="S3.Ex25.m1.1.1.1.1">𝑡</ci><apply id="S3.Ex25.m1.2.2.2.2.1.cmml" xref="S3.Ex25.m1.2.2.2.2.1"><times id="S3.Ex25.m1.2.2.2.2.1.1.cmml" xref="S3.Ex25.m1.2.2.2.2.1.1"></times><ci id="S3.Ex25.m1.2.2.2.2.1.2.cmml" xref="S3.Ex25.m1.2.2.2.2.1.2">𝑟</ci><ci id="S3.Ex25.m1.2.2.2.2.1.3.cmml" xref="S3.Ex25.m1.2.2.2.2.1.3">𝑒</ci><ci id="S3.Ex25.m1.2.2.2.2.1.4.cmml" xref="S3.Ex25.m1.2.2.2.2.1.4">𝑣</ci></apply></list></apply><apply id="S3.Ex25.m1.3.3.1.1.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1"><times id="S3.Ex25.m1.3.3.1.1.1.2.cmml" xref="S3.Ex25.m1.3.3.1.1.1.2"></times><ci id="S3.Ex25.m1.3.3.1.1.1.3a.cmml" xref="S3.Ex25.m1.3.3.1.1.1.3"><mtext id="S3.Ex25.m1.3.3.1.1.1.3.cmml" xref="S3.Ex25.m1.3.3.1.1.1.3">Linear</mtext></ci><apply id="S3.Ex25.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1"><plus id="S3.Ex25.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.2"></plus><apply id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1"><times id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.3a.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.3"><mtext id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.3">SiLU</mtext></ci><apply id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝐇</ci><apply id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.4">𝑣</ci></apply></apply></apply><apply id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.2">𝐗</ci><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.2.3">′</ci></apply><apply id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3"><times id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.1"></times><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.2">𝑟</ci><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.3">𝑒</ci><ci id="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.4.cmml" xref="S3.Ex25.m1.3.3.1.1.1.1.1.1.3.3.4">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex25.m1.3c">\mathbf{Y}_{t,rev}=\text{Linear}(\text{SiLU}(\mathbf{H}_{rev})+\mathbf{X}^{%
\prime}_{rev}).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex25.m1.3d">bold_Y start_POSTSUBSCRIPT italic_t , italic_r italic_e italic_v end_POSTSUBSCRIPT = Linear ( SiLU ( bold_H start_POSTSUBSCRIPT italic_r italic_e italic_v end_POSTSUBSCRIPT ) + bold_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r italic_e italic_v end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS7.p13">
<p class="ltx_p" id="S3.SS7.p13.1">The final output combines both forward and reverse sequences:</p>
</div>
<div class="ltx_para" id="S3.SS7.p14">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex27">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{Y}_{t}^{final}=\text{Linear}(\text{Concat}[\mathbf{Y}_{t},\mathbf{Y}_{%
t,rev}])." class="ltx_Math" display="block" id="S3.Ex27.m1.3"><semantics id="S3.Ex27.m1.3a"><mrow id="S3.Ex27.m1.3.3.1" xref="S3.Ex27.m1.3.3.1.1.cmml"><mrow id="S3.Ex27.m1.3.3.1.1" xref="S3.Ex27.m1.3.3.1.1.cmml"><msubsup id="S3.Ex27.m1.3.3.1.1.3" xref="S3.Ex27.m1.3.3.1.1.3.cmml"><mi id="S3.Ex27.m1.3.3.1.1.3.2.2" xref="S3.Ex27.m1.3.3.1.1.3.2.2.cmml">𝐘</mi><mi id="S3.Ex27.m1.3.3.1.1.3.2.3" xref="S3.Ex27.m1.3.3.1.1.3.2.3.cmml">t</mi><mrow id="S3.Ex27.m1.3.3.1.1.3.3" xref="S3.Ex27.m1.3.3.1.1.3.3.cmml"><mi id="S3.Ex27.m1.3.3.1.1.3.3.2" xref="S3.Ex27.m1.3.3.1.1.3.3.2.cmml">f</mi><mo id="S3.Ex27.m1.3.3.1.1.3.3.1" xref="S3.Ex27.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex27.m1.3.3.1.1.3.3.3" xref="S3.Ex27.m1.3.3.1.1.3.3.3.cmml">i</mi><mo id="S3.Ex27.m1.3.3.1.1.3.3.1a" xref="S3.Ex27.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex27.m1.3.3.1.1.3.3.4" xref="S3.Ex27.m1.3.3.1.1.3.3.4.cmml">n</mi><mo id="S3.Ex27.m1.3.3.1.1.3.3.1b" xref="S3.Ex27.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex27.m1.3.3.1.1.3.3.5" xref="S3.Ex27.m1.3.3.1.1.3.3.5.cmml">a</mi><mo id="S3.Ex27.m1.3.3.1.1.3.3.1c" xref="S3.Ex27.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex27.m1.3.3.1.1.3.3.6" xref="S3.Ex27.m1.3.3.1.1.3.3.6.cmml">l</mi></mrow></msubsup><mo id="S3.Ex27.m1.3.3.1.1.2" xref="S3.Ex27.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.Ex27.m1.3.3.1.1.1" xref="S3.Ex27.m1.3.3.1.1.1.cmml"><mtext id="S3.Ex27.m1.3.3.1.1.1.3" xref="S3.Ex27.m1.3.3.1.1.1.3a.cmml">Linear</mtext><mo id="S3.Ex27.m1.3.3.1.1.1.2" xref="S3.Ex27.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex27.m1.3.3.1.1.1.1.1" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.Ex27.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex27.m1.3.3.1.1.1.1.1.1" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.cmml"><mtext id="S3.Ex27.m1.3.3.1.1.1.1.1.1.4" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.4a.cmml">Concat</mtext><mo id="S3.Ex27.m1.3.3.1.1.1.1.1.1.3" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mo id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">𝐘</mi><mi id="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.4" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml">𝐘</mi><mrow id="S3.Ex27.m1.2.2.2.2" xref="S3.Ex27.m1.2.2.2.3.cmml"><mi id="S3.Ex27.m1.1.1.1.1" xref="S3.Ex27.m1.1.1.1.1.cmml">t</mi><mo id="S3.Ex27.m1.2.2.2.2.2" xref="S3.Ex27.m1.2.2.2.3.cmml">,</mo><mrow id="S3.Ex27.m1.2.2.2.2.1" xref="S3.Ex27.m1.2.2.2.2.1.cmml"><mi id="S3.Ex27.m1.2.2.2.2.1.2" xref="S3.Ex27.m1.2.2.2.2.1.2.cmml">r</mi><mo id="S3.Ex27.m1.2.2.2.2.1.1" xref="S3.Ex27.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.Ex27.m1.2.2.2.2.1.3" xref="S3.Ex27.m1.2.2.2.2.1.3.cmml">e</mi><mo id="S3.Ex27.m1.2.2.2.2.1.1a" xref="S3.Ex27.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.Ex27.m1.2.2.2.2.1.4" xref="S3.Ex27.m1.2.2.2.2.1.4.cmml">v</mi></mrow></mrow></msub><mo id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S3.Ex27.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex27.m1.3.3.1.2" lspace="0em" xref="S3.Ex27.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex27.m1.3b"><apply id="S3.Ex27.m1.3.3.1.1.cmml" xref="S3.Ex27.m1.3.3.1"><eq id="S3.Ex27.m1.3.3.1.1.2.cmml" xref="S3.Ex27.m1.3.3.1.1.2"></eq><apply id="S3.Ex27.m1.3.3.1.1.3.cmml" xref="S3.Ex27.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex27.m1.3.3.1.1.3.1.cmml" xref="S3.Ex27.m1.3.3.1.1.3">superscript</csymbol><apply id="S3.Ex27.m1.3.3.1.1.3.2.cmml" xref="S3.Ex27.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex27.m1.3.3.1.1.3.2.1.cmml" xref="S3.Ex27.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.Ex27.m1.3.3.1.1.3.2.2.cmml" xref="S3.Ex27.m1.3.3.1.1.3.2.2">𝐘</ci><ci id="S3.Ex27.m1.3.3.1.1.3.2.3.cmml" xref="S3.Ex27.m1.3.3.1.1.3.2.3">𝑡</ci></apply><apply id="S3.Ex27.m1.3.3.1.1.3.3.cmml" xref="S3.Ex27.m1.3.3.1.1.3.3"><times id="S3.Ex27.m1.3.3.1.1.3.3.1.cmml" xref="S3.Ex27.m1.3.3.1.1.3.3.1"></times><ci id="S3.Ex27.m1.3.3.1.1.3.3.2.cmml" xref="S3.Ex27.m1.3.3.1.1.3.3.2">𝑓</ci><ci id="S3.Ex27.m1.3.3.1.1.3.3.3.cmml" xref="S3.Ex27.m1.3.3.1.1.3.3.3">𝑖</ci><ci id="S3.Ex27.m1.3.3.1.1.3.3.4.cmml" xref="S3.Ex27.m1.3.3.1.1.3.3.4">𝑛</ci><ci id="S3.Ex27.m1.3.3.1.1.3.3.5.cmml" xref="S3.Ex27.m1.3.3.1.1.3.3.5">𝑎</ci><ci id="S3.Ex27.m1.3.3.1.1.3.3.6.cmml" xref="S3.Ex27.m1.3.3.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S3.Ex27.m1.3.3.1.1.1.cmml" xref="S3.Ex27.m1.3.3.1.1.1"><times id="S3.Ex27.m1.3.3.1.1.1.2.cmml" xref="S3.Ex27.m1.3.3.1.1.1.2"></times><ci id="S3.Ex27.m1.3.3.1.1.1.3a.cmml" xref="S3.Ex27.m1.3.3.1.1.1.3"><mtext id="S3.Ex27.m1.3.3.1.1.1.3.cmml" xref="S3.Ex27.m1.3.3.1.1.1.3">Linear</mtext></ci><apply id="S3.Ex27.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1"><times id="S3.Ex27.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.3"></times><ci id="S3.Ex27.m1.3.3.1.1.1.1.1.1.4a.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.4"><mtext id="S3.Ex27.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.4">Concat</mtext></ci><interval closure="closed" id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2"><apply id="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝐘</ci><ci id="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex27.m1.3.3.1.1.1.1.1.1.2.2.2.2">𝐘</ci><list id="S3.Ex27.m1.2.2.2.3.cmml" xref="S3.Ex27.m1.2.2.2.2"><ci id="S3.Ex27.m1.1.1.1.1.cmml" xref="S3.Ex27.m1.1.1.1.1">𝑡</ci><apply id="S3.Ex27.m1.2.2.2.2.1.cmml" xref="S3.Ex27.m1.2.2.2.2.1"><times id="S3.Ex27.m1.2.2.2.2.1.1.cmml" xref="S3.Ex27.m1.2.2.2.2.1.1"></times><ci id="S3.Ex27.m1.2.2.2.2.1.2.cmml" xref="S3.Ex27.m1.2.2.2.2.1.2">𝑟</ci><ci id="S3.Ex27.m1.2.2.2.2.1.3.cmml" xref="S3.Ex27.m1.2.2.2.2.1.3">𝑒</ci><ci id="S3.Ex27.m1.2.2.2.2.1.4.cmml" xref="S3.Ex27.m1.2.2.2.2.1.4">𝑣</ci></apply></list></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex27.m1.3c">\mathbf{Y}_{t}^{final}=\text{Linear}(\text{Concat}[\mathbf{Y}_{t},\mathbf{Y}_{%
t,rev}]).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex27.m1.3d">bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT = Linear ( Concat [ bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_Y start_POSTSUBSCRIPT italic_t , italic_r italic_e italic_v end_POSTSUBSCRIPT ] ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS7.p15">
<p class="ltx_p" id="S3.SS7.p15.1">The final output then passes through a GLU to further refine the features:</p>
</div>
<div class="ltx_para" id="S3.SS7.p16">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex29">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{GLU}(\mathbf{Y}_{t}^{final})=(\mathbf{Y}_{t}^{final}\mathbf{W}_{1}+%
\mathbf{b}_{1})\odot\sigma(\mathbf{Y}_{t}^{final}\mathbf{W}_{2}+\mathbf{b}_{2})." class="ltx_Math" display="block" id="S3.Ex29.m1.1"><semantics id="S3.Ex29.m1.1a"><mrow id="S3.Ex29.m1.1.1.1" xref="S3.Ex29.m1.1.1.1.1.cmml"><mrow id="S3.Ex29.m1.1.1.1.1" xref="S3.Ex29.m1.1.1.1.1.cmml"><mrow id="S3.Ex29.m1.1.1.1.1.1" xref="S3.Ex29.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex29.m1.1.1.1.1.1.3" xref="S3.Ex29.m1.1.1.1.1.1.3a.cmml">GLU</mtext><mo id="S3.Ex29.m1.1.1.1.1.1.2" xref="S3.Ex29.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex29.m1.1.1.1.1.1.1.1" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex29.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.Ex29.m1.1.1.1.1.1.1.1.1" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐘</mi><mi id="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mo id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1a" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.4" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.4.cmml">n</mi><mo id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1b" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.5" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.5.cmml">a</mi><mo id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1c" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.6" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.6.cmml">l</mi></mrow></msubsup><mo id="S3.Ex29.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex29.m1.1.1.1.1.4" xref="S3.Ex29.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.Ex29.m1.1.1.1.1.3" xref="S3.Ex29.m1.1.1.1.1.3.cmml"><mrow id="S3.Ex29.m1.1.1.1.1.2.1" xref="S3.Ex29.m1.1.1.1.1.2.1.cmml"><mrow id="S3.Ex29.m1.1.1.1.1.2.1.1.1" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.cmml"><mo id="S3.Ex29.m1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.cmml"><mrow id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.cmml"><msubsup id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.cmml"><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.2" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml">𝐘</mi><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.3" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.cmml">t</mi><mrow id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.2" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.2.cmml">f</mi><mo id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.3" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.3.cmml">i</mi><mo id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1a" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.4" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.4.cmml">n</mi><mo id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1b" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.5" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.5.cmml">a</mi><mo id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1c" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.6" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.6.cmml">l</mi></mrow></msubsup><mo id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.1" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.cmml"><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.2" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.2.cmml">𝐖</mi><mn id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.3" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.1" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.1.cmml">+</mo><msub id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.2" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.3" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.Ex29.m1.1.1.1.1.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex29.m1.1.1.1.1.2.1.2" rspace="0.222em" xref="S3.Ex29.m1.1.1.1.1.2.1.2.cmml">⊙</mo><mi id="S3.Ex29.m1.1.1.1.1.2.1.3" xref="S3.Ex29.m1.1.1.1.1.2.1.3.cmml">σ</mi></mrow><mo id="S3.Ex29.m1.1.1.1.1.3.3" xref="S3.Ex29.m1.1.1.1.1.3.3.cmml">⁢</mo><mrow id="S3.Ex29.m1.1.1.1.1.3.2.1" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.cmml"><mo id="S3.Ex29.m1.1.1.1.1.3.2.1.2" stretchy="false" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.cmml">(</mo><mrow id="S3.Ex29.m1.1.1.1.1.3.2.1.1" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.cmml"><mrow id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.cmml"><msubsup id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.cmml"><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.2" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.2.cmml">𝐘</mi><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.3" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.3.cmml">t</mi><mrow id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.cmml"><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.2" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.2.cmml">f</mi><mo id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.3" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.3.cmml">i</mi><mo id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1a" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.4" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.4.cmml">n</mi><mo id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1b" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.5" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.5.cmml">a</mi><mo id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1c" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.6" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.6.cmml">l</mi></mrow></msubsup><mo id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.1" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.1.cmml">⁢</mo><msub id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.cmml"><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.2" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.2.cmml">𝐖</mi><mn id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.3" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="S3.Ex29.m1.1.1.1.1.3.2.1.1.1" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.1.cmml">+</mo><msub id="S3.Ex29.m1.1.1.1.1.3.2.1.1.3" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.cmml"><mi id="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.2" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.2.cmml">𝐛</mi><mn id="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.3" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S3.Ex29.m1.1.1.1.1.3.2.1.3" stretchy="false" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex29.m1.1.1.1.2" lspace="0em" xref="S3.Ex29.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex29.m1.1b"><apply id="S3.Ex29.m1.1.1.1.1.cmml" xref="S3.Ex29.m1.1.1.1"><eq id="S3.Ex29.m1.1.1.1.1.4.cmml" xref="S3.Ex29.m1.1.1.1.1.4"></eq><apply id="S3.Ex29.m1.1.1.1.1.1.cmml" xref="S3.Ex29.m1.1.1.1.1.1"><times id="S3.Ex29.m1.1.1.1.1.1.2.cmml" xref="S3.Ex29.m1.1.1.1.1.1.2"></times><ci id="S3.Ex29.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex29.m1.1.1.1.1.1.3"><mtext id="S3.Ex29.m1.1.1.1.1.1.3.cmml" xref="S3.Ex29.m1.1.1.1.1.1.3">GLU</mtext></ci><apply id="S3.Ex29.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.2">𝐘</ci><ci id="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci><ci id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.4">𝑛</ci><ci id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.5">𝑎</ci><ci id="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.6.cmml" xref="S3.Ex29.m1.1.1.1.1.1.1.1.1.3.6">𝑙</ci></apply></apply></apply><apply id="S3.Ex29.m1.1.1.1.1.3.cmml" xref="S3.Ex29.m1.1.1.1.1.3"><times id="S3.Ex29.m1.1.1.1.1.3.3.cmml" xref="S3.Ex29.m1.1.1.1.1.3.3"></times><apply id="S3.Ex29.m1.1.1.1.1.2.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1"><csymbol cd="latexml" id="S3.Ex29.m1.1.1.1.1.2.1.2.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.2">direct-product</csymbol><apply id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1"><plus id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.1"></plus><apply id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2"><times id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.1"></times><apply id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2">superscript</csymbol><apply id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.2">𝐘</ci><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.2.3">𝑡</ci></apply><apply id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3"><times id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.1"></times><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.2">𝑓</ci><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.3">𝑖</ci><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.4.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.4">𝑛</ci><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.5.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.5">𝑎</ci><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.6.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.2.3.6">𝑙</ci></apply></apply><apply id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.2.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.2">𝐖</ci><cn id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.2">𝐛</ci><cn id="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.3.cmml" type="integer" xref="S3.Ex29.m1.1.1.1.1.2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.Ex29.m1.1.1.1.1.2.1.3.cmml" xref="S3.Ex29.m1.1.1.1.1.2.1.3">𝜎</ci></apply><apply id="S3.Ex29.m1.1.1.1.1.3.2.1.1.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1"><plus id="S3.Ex29.m1.1.1.1.1.3.2.1.1.1.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.1"></plus><apply id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2"><times id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.1.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.1"></times><apply id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.1.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2">superscript</csymbol><apply id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.1.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2">subscript</csymbol><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.2.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.2">𝐘</ci><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.3.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.2.3">𝑡</ci></apply><apply id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3"><times id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.1"></times><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.2.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.2">𝑓</ci><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.3.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.3">𝑖</ci><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.4.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.4">𝑛</ci><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.5.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.5">𝑎</ci><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.6.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.2.3.6">𝑙</ci></apply></apply><apply id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.1.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3">subscript</csymbol><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.2.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.2">𝐖</ci><cn id="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.3.cmml" type="integer" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.2.3.3">2</cn></apply></apply><apply id="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.1.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.3">subscript</csymbol><ci id="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.2.cmml" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.2">𝐛</ci><cn id="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.3.cmml" type="integer" xref="S3.Ex29.m1.1.1.1.1.3.2.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex29.m1.1c">\text{GLU}(\mathbf{Y}_{t}^{final})=(\mathbf{Y}_{t}^{final}\mathbf{W}_{1}+%
\mathbf{b}_{1})\odot\sigma(\mathbf{Y}_{t}^{final}\mathbf{W}_{2}+\mathbf{b}_{2}).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex29.m1.1d">GLU ( bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT ) = ( bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ⊙ italic_σ ( bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS7.p17">
<p class="ltx_p" id="S3.SS7.p17.7">Overall, the EchoMamba block leverages input-dependent adaptations and a selective SSM to process sequential information effectively. The parameters of the EchoMamba block consist of an SSM state expansion factor <math alttext="N" class="ltx_Math" display="inline" id="S3.SS7.p17.1.m1.1"><semantics id="S3.SS7.p17.1.m1.1a"><mi id="S3.SS7.p17.1.m1.1.1" xref="S3.SS7.p17.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p17.1.m1.1b"><ci id="S3.SS7.p17.1.m1.1.1.cmml" xref="S3.SS7.p17.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p17.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p17.1.m1.1d">italic_N</annotation></semantics></math>, a kernel size <math alttext="K" class="ltx_Math" display="inline" id="S3.SS7.p17.2.m2.1"><semantics id="S3.SS7.p17.2.m2.1a"><mi id="S3.SS7.p17.2.m2.1.1" xref="S3.SS7.p17.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p17.2.m2.1b"><ci id="S3.SS7.p17.2.m2.1.1.cmml" xref="S3.SS7.p17.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p17.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p17.2.m2.1d">italic_K</annotation></semantics></math> for the convolution, and a block expansion factor <math alttext="E" class="ltx_Math" display="inline" id="S3.SS7.p17.3.m3.1"><semantics id="S3.SS7.p17.3.m3.1a"><mi id="S3.SS7.p17.3.m3.1.1" xref="S3.SS7.p17.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p17.3.m3.1b"><ci id="S3.SS7.p17.3.m3.1.1.cmml" xref="S3.SS7.p17.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p17.3.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p17.3.m3.1d">italic_E</annotation></semantics></math> for input and output linear projections. Selecting the expansion factors <math alttext="N" class="ltx_Math" display="inline" id="S3.SS7.p17.4.m4.1"><semantics id="S3.SS7.p17.4.m4.1a"><mi id="S3.SS7.p17.4.m4.1.1" xref="S3.SS7.p17.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p17.4.m4.1b"><ci id="S3.SS7.p17.4.m4.1.1.cmml" xref="S3.SS7.p17.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p17.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p17.4.m4.1d">italic_N</annotation></semantics></math> and <math alttext="E" class="ltx_Math" display="inline" id="S3.SS7.p17.5.m5.1"><semantics id="S3.SS7.p17.5.m5.1a"><mi id="S3.SS7.p17.5.m5.1.1" xref="S3.SS7.p17.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p17.5.m5.1b"><ci id="S3.SS7.p17.5.m5.1.1.cmml" xref="S3.SS7.p17.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p17.5.m5.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p17.5.m5.1d">italic_E</annotation></semantics></math> involves a tradeoff between capturing complex relationships and training efficiency, where higher <math alttext="N" class="ltx_Math" display="inline" id="S3.SS7.p17.6.m6.1"><semantics id="S3.SS7.p17.6.m6.1a"><mi id="S3.SS7.p17.6.m6.1.1" xref="S3.SS7.p17.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p17.6.m6.1b"><ci id="S3.SS7.p17.6.m6.1.1.cmml" xref="S3.SS7.p17.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p17.6.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p17.6.m6.1d">italic_N</annotation></semantics></math> and <math alttext="E" class="ltx_Math" display="inline" id="S3.SS7.p17.7.m7.1"><semantics id="S3.SS7.p17.7.m7.1a"><mi id="S3.SS7.p17.7.m7.1.1" xref="S3.SS7.p17.7.m7.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS7.p17.7.m7.1b"><ci id="S3.SS7.p17.7.m7.1.1.cmml" xref="S3.SS7.p17.7.m7.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p17.7.m7.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p17.7.m7.1d">italic_E</annotation></semantics></math> increase computational cost.</p>
</div>
<div class="ltx_para" id="S3.SS7.p18">
<p class="ltx_p" id="S3.SS7.p18.1">The EchoMamba block addresses the prevalent effectiveness-efficiency dilemma existing in RNNs and Transformers. The recurrent SSM in the EchoMamba block operates in linear time with respect to the sequence length, making it as efficient as RNNs for inference, achieved by discretized parameters. Additionally, the selection mechanism makes the parameters of SSM data-dependent. This enables EchoMamba4Rec to selectively retain or discard information, which is crucial for capturing the complex dependencies inherent in sequential recommendation tasks. By leveraging the structured state matrix with HiPPO techniques, EchoMamba block effectively models long-range dependencies within user interaction sequences, surpassing the performance of traditional self-attention mechanisms in handling long sequences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib18" title="">18</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.8 </span>Prediction Layer</h3>
<div class="ltx_para" id="S3.SS8.p1">
<p class="ltx_p" id="S3.SS8.p1.1">In the final layer of EchoMamba4Rec, we compute the user’s preference score for the next item <math alttext="v_{n_{u}+1}" class="ltx_Math" display="inline" id="S3.SS8.p1.1.m1.1"><semantics id="S3.SS8.p1.1.m1.1a"><msub id="S3.SS8.p1.1.m1.1.1" xref="S3.SS8.p1.1.m1.1.1.cmml"><mi id="S3.SS8.p1.1.m1.1.1.2" xref="S3.SS8.p1.1.m1.1.1.2.cmml">v</mi><mrow id="S3.SS8.p1.1.m1.1.1.3" xref="S3.SS8.p1.1.m1.1.1.3.cmml"><msub id="S3.SS8.p1.1.m1.1.1.3.2" xref="S3.SS8.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS8.p1.1.m1.1.1.3.2.2" xref="S3.SS8.p1.1.m1.1.1.3.2.2.cmml">n</mi><mi id="S3.SS8.p1.1.m1.1.1.3.2.3" xref="S3.SS8.p1.1.m1.1.1.3.2.3.cmml">u</mi></msub><mo id="S3.SS8.p1.1.m1.1.1.3.1" xref="S3.SS8.p1.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS8.p1.1.m1.1.1.3.3" xref="S3.SS8.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS8.p1.1.m1.1b"><apply id="S3.SS8.p1.1.m1.1.1.cmml" xref="S3.SS8.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS8.p1.1.m1.1.1.1.cmml" xref="S3.SS8.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS8.p1.1.m1.1.1.2.cmml" xref="S3.SS8.p1.1.m1.1.1.2">𝑣</ci><apply id="S3.SS8.p1.1.m1.1.1.3.cmml" xref="S3.SS8.p1.1.m1.1.1.3"><plus id="S3.SS8.p1.1.m1.1.1.3.1.cmml" xref="S3.SS8.p1.1.m1.1.1.3.1"></plus><apply id="S3.SS8.p1.1.m1.1.1.3.2.cmml" xref="S3.SS8.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS8.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS8.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS8.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS8.p1.1.m1.1.1.3.2.2">𝑛</ci><ci id="S3.SS8.p1.1.m1.1.1.3.2.3.cmml" xref="S3.SS8.p1.1.m1.1.1.3.2.3">𝑢</ci></apply><cn id="S3.SS8.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.SS8.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p1.1.m1.1c">v_{n_{u}+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT</annotation></semantics></math> given their interaction history. The computation leverages both the bi-directional processing and the filtered embeddings obtained from previous layers.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS8.p2">
<p class="ltx_p" id="S3.SS8.p2.2">Given the user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS8.p2.1.m1.1"><semantics id="S3.SS8.p2.1.m1.1a"><mi id="S3.SS8.p2.1.m1.1.1" xref="S3.SS8.p2.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS8.p2.1.m1.1b"><ci id="S3.SS8.p2.1.m1.1.1.cmml" xref="S3.SS8.p2.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p2.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p2.1.m1.1d">italic_u</annotation></semantics></math>’s interaction sequence <math alttext="S_{u}=[v_{1},v_{2},\ldots,v_{n_{u}}]" class="ltx_Math" display="inline" id="S3.SS8.p2.2.m2.4"><semantics id="S3.SS8.p2.2.m2.4a"><mrow id="S3.SS8.p2.2.m2.4.4" xref="S3.SS8.p2.2.m2.4.4.cmml"><msub id="S3.SS8.p2.2.m2.4.4.5" xref="S3.SS8.p2.2.m2.4.4.5.cmml"><mi id="S3.SS8.p2.2.m2.4.4.5.2" xref="S3.SS8.p2.2.m2.4.4.5.2.cmml">S</mi><mi id="S3.SS8.p2.2.m2.4.4.5.3" xref="S3.SS8.p2.2.m2.4.4.5.3.cmml">u</mi></msub><mo id="S3.SS8.p2.2.m2.4.4.4" xref="S3.SS8.p2.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS8.p2.2.m2.4.4.3.3" xref="S3.SS8.p2.2.m2.4.4.3.4.cmml"><mo id="S3.SS8.p2.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS8.p2.2.m2.4.4.3.4.cmml">[</mo><msub id="S3.SS8.p2.2.m2.2.2.1.1.1" xref="S3.SS8.p2.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS8.p2.2.m2.2.2.1.1.1.2" xref="S3.SS8.p2.2.m2.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS8.p2.2.m2.2.2.1.1.1.3" xref="S3.SS8.p2.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS8.p2.2.m2.4.4.3.3.5" xref="S3.SS8.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS8.p2.2.m2.3.3.2.2.2" xref="S3.SS8.p2.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS8.p2.2.m2.3.3.2.2.2.2" xref="S3.SS8.p2.2.m2.3.3.2.2.2.2.cmml">v</mi><mn id="S3.SS8.p2.2.m2.3.3.2.2.2.3" xref="S3.SS8.p2.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS8.p2.2.m2.4.4.3.3.6" xref="S3.SS8.p2.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS8.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS8.p2.2.m2.1.1.cmml">…</mi><mo id="S3.SS8.p2.2.m2.4.4.3.3.7" xref="S3.SS8.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS8.p2.2.m2.4.4.3.3.3" xref="S3.SS8.p2.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS8.p2.2.m2.4.4.3.3.3.2" xref="S3.SS8.p2.2.m2.4.4.3.3.3.2.cmml">v</mi><msub id="S3.SS8.p2.2.m2.4.4.3.3.3.3" xref="S3.SS8.p2.2.m2.4.4.3.3.3.3.cmml"><mi id="S3.SS8.p2.2.m2.4.4.3.3.3.3.2" xref="S3.SS8.p2.2.m2.4.4.3.3.3.3.2.cmml">n</mi><mi id="S3.SS8.p2.2.m2.4.4.3.3.3.3.3" xref="S3.SS8.p2.2.m2.4.4.3.3.3.3.3.cmml">u</mi></msub></msub><mo id="S3.SS8.p2.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS8.p2.2.m2.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS8.p2.2.m2.4b"><apply id="S3.SS8.p2.2.m2.4.4.cmml" xref="S3.SS8.p2.2.m2.4.4"><eq id="S3.SS8.p2.2.m2.4.4.4.cmml" xref="S3.SS8.p2.2.m2.4.4.4"></eq><apply id="S3.SS8.p2.2.m2.4.4.5.cmml" xref="S3.SS8.p2.2.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS8.p2.2.m2.4.4.5.1.cmml" xref="S3.SS8.p2.2.m2.4.4.5">subscript</csymbol><ci id="S3.SS8.p2.2.m2.4.4.5.2.cmml" xref="S3.SS8.p2.2.m2.4.4.5.2">𝑆</ci><ci id="S3.SS8.p2.2.m2.4.4.5.3.cmml" xref="S3.SS8.p2.2.m2.4.4.5.3">𝑢</ci></apply><list id="S3.SS8.p2.2.m2.4.4.3.4.cmml" xref="S3.SS8.p2.2.m2.4.4.3.3"><apply id="S3.SS8.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS8.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS8.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS8.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS8.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS8.p2.2.m2.2.2.1.1.1.2">𝑣</ci><cn id="S3.SS8.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS8.p2.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS8.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS8.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS8.p2.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS8.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS8.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS8.p2.2.m2.3.3.2.2.2.2">𝑣</ci><cn id="S3.SS8.p2.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS8.p2.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS8.p2.2.m2.1.1.cmml" xref="S3.SS8.p2.2.m2.1.1">…</ci><apply id="S3.SS8.p2.2.m2.4.4.3.3.3.cmml" xref="S3.SS8.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS8.p2.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS8.p2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS8.p2.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS8.p2.2.m2.4.4.3.3.3.2">𝑣</ci><apply id="S3.SS8.p2.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS8.p2.2.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS8.p2.2.m2.4.4.3.3.3.3.1.cmml" xref="S3.SS8.p2.2.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS8.p2.2.m2.4.4.3.3.3.3.2.cmml" xref="S3.SS8.p2.2.m2.4.4.3.3.3.3.2">𝑛</ci><ci id="S3.SS8.p2.2.m2.4.4.3.3.3.3.3.cmml" xref="S3.SS8.p2.2.m2.4.4.3.3.3.3.3">𝑢</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p2.2.m2.4c">S_{u}=[v_{1},v_{2},\ldots,v_{n_{u}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p2.2.m2.4d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math> and the bi-directionally processed representations, the prediction is formulated as follows:</p>
</div>
<div class="ltx_para" id="S3.SS8.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex31">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="P(v_{n_{u}+1}=v|v_{1},v_{2},\ldots,v_{n_{u}})=\mathbf{e}_{v}^{\top}\mathbf{Y}_%
{t}^{final}," class="ltx_Math" display="block" id="S3.Ex31.m1.2"><semantics id="S3.Ex31.m1.2a"><mrow id="S3.Ex31.m1.2.2.1" xref="S3.Ex31.m1.2.2.1.1.cmml"><mrow id="S3.Ex31.m1.2.2.1.1" xref="S3.Ex31.m1.2.2.1.1.cmml"><mrow id="S3.Ex31.m1.2.2.1.1.1" xref="S3.Ex31.m1.2.2.1.1.1.cmml"><mi id="S3.Ex31.m1.2.2.1.1.1.3" xref="S3.Ex31.m1.2.2.1.1.1.3.cmml">P</mi><mo id="S3.Ex31.m1.2.2.1.1.1.2" xref="S3.Ex31.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex31.m1.2.2.1.1.1.1.1" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex31.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex31.m1.2.2.1.1.1.1.1.1" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.cmml"><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.2" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.2.cmml">v</mi><mrow id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.cmml"><msub id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.cmml"><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.2" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.2.cmml">n</mi><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.3.cmml">u</mi></msub><mo id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.1" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.1.cmml">+</mo><mn id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.3.cmml">1</mn></mrow></msub><mo id="S3.Ex31.m1.2.2.1.1.1.1.1.1.4" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.4.cmml">=</mo><mrow id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.5" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.5.cmml">v</mi><mo fence="false" id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.4" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.4.cmml">|</mo><mrow id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.4.cmml"><msub id="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mn id="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.4" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.2" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml">v</mi><mn id="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.5" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.4.cmml">,</mo><mi id="S3.Ex31.m1.1.1" mathvariant="normal" xref="S3.Ex31.m1.1.1.cmml">…</mi><mo id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.6" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.2" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.2.cmml">v</mi><msub id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.2" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.2.cmml">n</mi><mi id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.3" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.3.cmml">u</mi></msub></msub></mrow></mrow></mrow><mo id="S3.Ex31.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex31.m1.2.2.1.1.2" xref="S3.Ex31.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.Ex31.m1.2.2.1.1.3" xref="S3.Ex31.m1.2.2.1.1.3.cmml"><msubsup id="S3.Ex31.m1.2.2.1.1.3.2" xref="S3.Ex31.m1.2.2.1.1.3.2.cmml"><mi id="S3.Ex31.m1.2.2.1.1.3.2.2.2" xref="S3.Ex31.m1.2.2.1.1.3.2.2.2.cmml">𝐞</mi><mi id="S3.Ex31.m1.2.2.1.1.3.2.2.3" xref="S3.Ex31.m1.2.2.1.1.3.2.2.3.cmml">v</mi><mo id="S3.Ex31.m1.2.2.1.1.3.2.3" xref="S3.Ex31.m1.2.2.1.1.3.2.3.cmml">⊤</mo></msubsup><mo id="S3.Ex31.m1.2.2.1.1.3.1" xref="S3.Ex31.m1.2.2.1.1.3.1.cmml">⁢</mo><msubsup id="S3.Ex31.m1.2.2.1.1.3.3" xref="S3.Ex31.m1.2.2.1.1.3.3.cmml"><mi id="S3.Ex31.m1.2.2.1.1.3.3.2.2" xref="S3.Ex31.m1.2.2.1.1.3.3.2.2.cmml">𝐘</mi><mi id="S3.Ex31.m1.2.2.1.1.3.3.2.3" xref="S3.Ex31.m1.2.2.1.1.3.3.2.3.cmml">t</mi><mrow id="S3.Ex31.m1.2.2.1.1.3.3.3" xref="S3.Ex31.m1.2.2.1.1.3.3.3.cmml"><mi id="S3.Ex31.m1.2.2.1.1.3.3.3.2" xref="S3.Ex31.m1.2.2.1.1.3.3.3.2.cmml">f</mi><mo id="S3.Ex31.m1.2.2.1.1.3.3.3.1" xref="S3.Ex31.m1.2.2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex31.m1.2.2.1.1.3.3.3.3" xref="S3.Ex31.m1.2.2.1.1.3.3.3.3.cmml">i</mi><mo id="S3.Ex31.m1.2.2.1.1.3.3.3.1a" xref="S3.Ex31.m1.2.2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex31.m1.2.2.1.1.3.3.3.4" xref="S3.Ex31.m1.2.2.1.1.3.3.3.4.cmml">n</mi><mo id="S3.Ex31.m1.2.2.1.1.3.3.3.1b" xref="S3.Ex31.m1.2.2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex31.m1.2.2.1.1.3.3.3.5" xref="S3.Ex31.m1.2.2.1.1.3.3.3.5.cmml">a</mi><mo id="S3.Ex31.m1.2.2.1.1.3.3.3.1c" xref="S3.Ex31.m1.2.2.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.Ex31.m1.2.2.1.1.3.3.3.6" xref="S3.Ex31.m1.2.2.1.1.3.3.3.6.cmml">l</mi></mrow></msubsup></mrow></mrow><mo id="S3.Ex31.m1.2.2.1.2" xref="S3.Ex31.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex31.m1.2b"><apply id="S3.Ex31.m1.2.2.1.1.cmml" xref="S3.Ex31.m1.2.2.1"><eq id="S3.Ex31.m1.2.2.1.1.2.cmml" xref="S3.Ex31.m1.2.2.1.1.2"></eq><apply id="S3.Ex31.m1.2.2.1.1.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1"><times id="S3.Ex31.m1.2.2.1.1.1.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.2"></times><ci id="S3.Ex31.m1.2.2.1.1.1.3.cmml" xref="S3.Ex31.m1.2.2.1.1.1.3">𝑃</ci><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1"><eq id="S3.Ex31.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.4"></eq><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.2">𝑣</ci><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3"><plus id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.1"></plus><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2">subscript</csymbol><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.2">𝑛</ci><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.3.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.2.3">𝑢</ci></apply><cn id="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.3.cmml" type="integer" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.5.3.3">1</cn></apply></apply><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.4">conditional</csymbol><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.5.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.5">𝑣</ci><list id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.4.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3"><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><cn id="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.2">𝑣</ci><cn id="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.Ex31.m1.1.1.cmml" xref="S3.Ex31.m1.1.1">…</ci><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.2">𝑣</ci><apply id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.2">𝑛</ci><ci id="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S3.Ex31.m1.2.2.1.1.1.1.1.1.3.3.3.3.3.3">𝑢</ci></apply></apply></list></apply></apply></apply><apply id="S3.Ex31.m1.2.2.1.1.3.cmml" xref="S3.Ex31.m1.2.2.1.1.3"><times id="S3.Ex31.m1.2.2.1.1.3.1.cmml" xref="S3.Ex31.m1.2.2.1.1.3.1"></times><apply id="S3.Ex31.m1.2.2.1.1.3.2.cmml" xref="S3.Ex31.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.3.2.1.cmml" xref="S3.Ex31.m1.2.2.1.1.3.2">superscript</csymbol><apply id="S3.Ex31.m1.2.2.1.1.3.2.2.cmml" xref="S3.Ex31.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.Ex31.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.Ex31.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.Ex31.m1.2.2.1.1.3.2.2.2">𝐞</ci><ci id="S3.Ex31.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.Ex31.m1.2.2.1.1.3.2.2.3">𝑣</ci></apply><csymbol cd="latexml" id="S3.Ex31.m1.2.2.1.1.3.2.3.cmml" xref="S3.Ex31.m1.2.2.1.1.3.2.3">top</csymbol></apply><apply id="S3.Ex31.m1.2.2.1.1.3.3.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.3.3.1.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3">superscript</csymbol><apply id="S3.Ex31.m1.2.2.1.1.3.3.2.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex31.m1.2.2.1.1.3.3.2.1.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3">subscript</csymbol><ci id="S3.Ex31.m1.2.2.1.1.3.3.2.2.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.2.2">𝐘</ci><ci id="S3.Ex31.m1.2.2.1.1.3.3.2.3.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.2.3">𝑡</ci></apply><apply id="S3.Ex31.m1.2.2.1.1.3.3.3.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.3"><times id="S3.Ex31.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.3.1"></times><ci id="S3.Ex31.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.3.2">𝑓</ci><ci id="S3.Ex31.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.3.3">𝑖</ci><ci id="S3.Ex31.m1.2.2.1.1.3.3.3.4.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.3.4">𝑛</ci><ci id="S3.Ex31.m1.2.2.1.1.3.3.3.5.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.3.5">𝑎</ci><ci id="S3.Ex31.m1.2.2.1.1.3.3.3.6.cmml" xref="S3.Ex31.m1.2.2.1.1.3.3.3.6">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex31.m1.2c">P(v_{n_{u}+1}=v|v_{1},v_{2},\ldots,v_{n_{u}})=\mathbf{e}_{v}^{\top}\mathbf{Y}_%
{t}^{final},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex31.m1.2d">italic_P ( italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT = italic_v | italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) = bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS8.p4">
<p class="ltx_p" id="S3.SS8.p4.5">where <math alttext="\mathbf{e}_{v}" class="ltx_Math" display="inline" id="S3.SS8.p4.1.m1.1"><semantics id="S3.SS8.p4.1.m1.1a"><msub id="S3.SS8.p4.1.m1.1.1" xref="S3.SS8.p4.1.m1.1.1.cmml"><mi id="S3.SS8.p4.1.m1.1.1.2" xref="S3.SS8.p4.1.m1.1.1.2.cmml">𝐞</mi><mi id="S3.SS8.p4.1.m1.1.1.3" xref="S3.SS8.p4.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS8.p4.1.m1.1b"><apply id="S3.SS8.p4.1.m1.1.1.cmml" xref="S3.SS8.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS8.p4.1.m1.1.1.1.cmml" xref="S3.SS8.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS8.p4.1.m1.1.1.2.cmml" xref="S3.SS8.p4.1.m1.1.1.2">𝐞</ci><ci id="S3.SS8.p4.1.m1.1.1.3.cmml" xref="S3.SS8.p4.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p4.1.m1.1c">\mathbf{e}_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p4.1.m1.1d">bold_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> represents the embedding of item <math alttext="v" class="ltx_Math" display="inline" id="S3.SS8.p4.2.m2.1"><semantics id="S3.SS8.p4.2.m2.1a"><mi id="S3.SS8.p4.2.m2.1.1" xref="S3.SS8.p4.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS8.p4.2.m2.1b"><ci id="S3.SS8.p4.2.m2.1.1.cmml" xref="S3.SS8.p4.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p4.2.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p4.2.m2.1d">italic_v</annotation></semantics></math> from the item embedding matrix <math alttext="\mathbf{M}_{I}" class="ltx_Math" display="inline" id="S3.SS8.p4.3.m3.1"><semantics id="S3.SS8.p4.3.m3.1a"><msub id="S3.SS8.p4.3.m3.1.1" xref="S3.SS8.p4.3.m3.1.1.cmml"><mi id="S3.SS8.p4.3.m3.1.1.2" xref="S3.SS8.p4.3.m3.1.1.2.cmml">𝐌</mi><mi id="S3.SS8.p4.3.m3.1.1.3" xref="S3.SS8.p4.3.m3.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS8.p4.3.m3.1b"><apply id="S3.SS8.p4.3.m3.1.1.cmml" xref="S3.SS8.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS8.p4.3.m3.1.1.1.cmml" xref="S3.SS8.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS8.p4.3.m3.1.1.2.cmml" xref="S3.SS8.p4.3.m3.1.1.2">𝐌</ci><ci id="S3.SS8.p4.3.m3.1.1.3.cmml" xref="S3.SS8.p4.3.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p4.3.m3.1c">\mathbf{M}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p4.3.m3.1d">bold_M start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathbf{Y}_{t}^{final}" class="ltx_Math" display="inline" id="S3.SS8.p4.4.m4.1"><semantics id="S3.SS8.p4.4.m4.1a"><msubsup id="S3.SS8.p4.4.m4.1.1" xref="S3.SS8.p4.4.m4.1.1.cmml"><mi id="S3.SS8.p4.4.m4.1.1.2.2" xref="S3.SS8.p4.4.m4.1.1.2.2.cmml">𝐘</mi><mi id="S3.SS8.p4.4.m4.1.1.2.3" xref="S3.SS8.p4.4.m4.1.1.2.3.cmml">t</mi><mrow id="S3.SS8.p4.4.m4.1.1.3" xref="S3.SS8.p4.4.m4.1.1.3.cmml"><mi id="S3.SS8.p4.4.m4.1.1.3.2" xref="S3.SS8.p4.4.m4.1.1.3.2.cmml">f</mi><mo id="S3.SS8.p4.4.m4.1.1.3.1" xref="S3.SS8.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS8.p4.4.m4.1.1.3.3" xref="S3.SS8.p4.4.m4.1.1.3.3.cmml">i</mi><mo id="S3.SS8.p4.4.m4.1.1.3.1a" xref="S3.SS8.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS8.p4.4.m4.1.1.3.4" xref="S3.SS8.p4.4.m4.1.1.3.4.cmml">n</mi><mo id="S3.SS8.p4.4.m4.1.1.3.1b" xref="S3.SS8.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS8.p4.4.m4.1.1.3.5" xref="S3.SS8.p4.4.m4.1.1.3.5.cmml">a</mi><mo id="S3.SS8.p4.4.m4.1.1.3.1c" xref="S3.SS8.p4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS8.p4.4.m4.1.1.3.6" xref="S3.SS8.p4.4.m4.1.1.3.6.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS8.p4.4.m4.1b"><apply id="S3.SS8.p4.4.m4.1.1.cmml" xref="S3.SS8.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS8.p4.4.m4.1.1.1.cmml" xref="S3.SS8.p4.4.m4.1.1">superscript</csymbol><apply id="S3.SS8.p4.4.m4.1.1.2.cmml" xref="S3.SS8.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS8.p4.4.m4.1.1.2.1.cmml" xref="S3.SS8.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS8.p4.4.m4.1.1.2.2.cmml" xref="S3.SS8.p4.4.m4.1.1.2.2">𝐘</ci><ci id="S3.SS8.p4.4.m4.1.1.2.3.cmml" xref="S3.SS8.p4.4.m4.1.1.2.3">𝑡</ci></apply><apply id="S3.SS8.p4.4.m4.1.1.3.cmml" xref="S3.SS8.p4.4.m4.1.1.3"><times id="S3.SS8.p4.4.m4.1.1.3.1.cmml" xref="S3.SS8.p4.4.m4.1.1.3.1"></times><ci id="S3.SS8.p4.4.m4.1.1.3.2.cmml" xref="S3.SS8.p4.4.m4.1.1.3.2">𝑓</ci><ci id="S3.SS8.p4.4.m4.1.1.3.3.cmml" xref="S3.SS8.p4.4.m4.1.1.3.3">𝑖</ci><ci id="S3.SS8.p4.4.m4.1.1.3.4.cmml" xref="S3.SS8.p4.4.m4.1.1.3.4">𝑛</ci><ci id="S3.SS8.p4.4.m4.1.1.3.5.cmml" xref="S3.SS8.p4.4.m4.1.1.3.5">𝑎</ci><ci id="S3.SS8.p4.4.m4.1.1.3.6.cmml" xref="S3.SS8.p4.4.m4.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p4.4.m4.1c">\mathbf{Y}_{t}^{final}</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p4.4.m4.1d">bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is the final output of the GLU-enhanced bi-directional blocks for user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS8.p4.5.m5.1"><semantics id="S3.SS8.p4.5.m5.1a"><mi id="S3.SS8.p4.5.m5.1.1" xref="S3.SS8.p4.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS8.p4.5.m5.1b"><ci id="S3.SS8.p4.5.m5.1.1.cmml" xref="S3.SS8.p4.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p4.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p4.5.m5.1d">italic_u</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS8.p5">
<p class="ltx_p" id="S3.SS8.p5.1">The final output <math alttext="\mathbf{Y}_{t}^{final}" class="ltx_Math" display="inline" id="S3.SS8.p5.1.m1.1"><semantics id="S3.SS8.p5.1.m1.1a"><msubsup id="S3.SS8.p5.1.m1.1.1" xref="S3.SS8.p5.1.m1.1.1.cmml"><mi id="S3.SS8.p5.1.m1.1.1.2.2" xref="S3.SS8.p5.1.m1.1.1.2.2.cmml">𝐘</mi><mi id="S3.SS8.p5.1.m1.1.1.2.3" xref="S3.SS8.p5.1.m1.1.1.2.3.cmml">t</mi><mrow id="S3.SS8.p5.1.m1.1.1.3" xref="S3.SS8.p5.1.m1.1.1.3.cmml"><mi id="S3.SS8.p5.1.m1.1.1.3.2" xref="S3.SS8.p5.1.m1.1.1.3.2.cmml">f</mi><mo id="S3.SS8.p5.1.m1.1.1.3.1" xref="S3.SS8.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS8.p5.1.m1.1.1.3.3" xref="S3.SS8.p5.1.m1.1.1.3.3.cmml">i</mi><mo id="S3.SS8.p5.1.m1.1.1.3.1a" xref="S3.SS8.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS8.p5.1.m1.1.1.3.4" xref="S3.SS8.p5.1.m1.1.1.3.4.cmml">n</mi><mo id="S3.SS8.p5.1.m1.1.1.3.1b" xref="S3.SS8.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS8.p5.1.m1.1.1.3.5" xref="S3.SS8.p5.1.m1.1.1.3.5.cmml">a</mi><mo id="S3.SS8.p5.1.m1.1.1.3.1c" xref="S3.SS8.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS8.p5.1.m1.1.1.3.6" xref="S3.SS8.p5.1.m1.1.1.3.6.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS8.p5.1.m1.1b"><apply id="S3.SS8.p5.1.m1.1.1.cmml" xref="S3.SS8.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS8.p5.1.m1.1.1.1.cmml" xref="S3.SS8.p5.1.m1.1.1">superscript</csymbol><apply id="S3.SS8.p5.1.m1.1.1.2.cmml" xref="S3.SS8.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS8.p5.1.m1.1.1.2.1.cmml" xref="S3.SS8.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS8.p5.1.m1.1.1.2.2.cmml" xref="S3.SS8.p5.1.m1.1.1.2.2">𝐘</ci><ci id="S3.SS8.p5.1.m1.1.1.2.3.cmml" xref="S3.SS8.p5.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS8.p5.1.m1.1.1.3.cmml" xref="S3.SS8.p5.1.m1.1.1.3"><times id="S3.SS8.p5.1.m1.1.1.3.1.cmml" xref="S3.SS8.p5.1.m1.1.1.3.1"></times><ci id="S3.SS8.p5.1.m1.1.1.3.2.cmml" xref="S3.SS8.p5.1.m1.1.1.3.2">𝑓</ci><ci id="S3.SS8.p5.1.m1.1.1.3.3.cmml" xref="S3.SS8.p5.1.m1.1.1.3.3">𝑖</ci><ci id="S3.SS8.p5.1.m1.1.1.3.4.cmml" xref="S3.SS8.p5.1.m1.1.1.3.4">𝑛</ci><ci id="S3.SS8.p5.1.m1.1.1.3.5.cmml" xref="S3.SS8.p5.1.m1.1.1.3.5">𝑎</ci><ci id="S3.SS8.p5.1.m1.1.1.3.6.cmml" xref="S3.SS8.p5.1.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS8.p5.1.m1.1c">\mathbf{Y}_{t}^{final}</annotation><annotation encoding="application/x-llamapun" id="S3.SS8.p5.1.m1.1d">bold_Y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> combines both the forward and reverse bi-directional processing results, providing a comprehensive representation of the user’s interaction history. This approach allows the model to effectively capture complex dependencies and improve the accuracy of sequential recommendations.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets.</span> Three datasets contain product reviews and ratings for the “Beauty”, “Video Games” categories on Amazon (<span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.2">Amazon-Beauty</span> and <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.3">Amazon-Video-Games</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib31" title="">31</a>]</cite> and movie ratings from MovieLens (<span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.4">MovieLens-1M</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib32" title="">32</a>]</cite>, which analyzed using the RecBole framework <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib33" title="">33</a>]</cite>. For each user, the interaction sequence is constructed by sorting their interaction records according to their timestamps. Users and items with less than 5 interactions are filtered. The preprocessed statistics of each dataset are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4.T1" title="Table 1 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics of the Amazon Review Datasets for Beauty and Video Games categories and MovieLens Datasets for movie ratings. These datasets provide comprehensive user-item interaction data, facilitating research on sequential recommendation systems. The statistics include the number of users, items, interactions, and the average interaction length per user.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.2.1"># users</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.3.1"># items</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.1"># interactions</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.5.1">Avg. Length</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.2.1.1">MovieLens-1M</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.2">6,040</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.3">3,416</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.4">999,611</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.5">165.4</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.3.2.1">Amazon-Beauty</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.2">22,363</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.3">12,101</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.4">198,502</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.5">8.9</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.1.4.3.1">Amazon-Video-Games</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.4.3.2">14,494</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.4.3.3">6,950</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.4.3.4">132,209</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.4.3.5">9.1</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Hyperparameters.</span> The Adam optimizer is used with a learning rate 0.001. The training batch size is 2048, and the evaluation batch size is 4096. All models use an embedding dimension of 64. And the dropout rate is 0.2.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Baselines.</span> We compare EchoMamba4Rec against several baseline methods, which include RNN-based models like GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib34" title="">34</a>]</cite> and NARM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib35" title="">35</a>]</cite> , as well as attention-based models such as SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib22" title="">22</a>]</cite> and BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib36" title="">36</a>]</cite>, additionally, we assess a range of variants of the Mamba model, including Mamba, Bi-Mamba and Bi-Mambaformer as Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4.F4" title="Figure 4 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4.F4" title="Figure 4 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">Evaluation Metrics.</span> We adopt HR(Hit Ratio) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib37" title="">37</a>]</cite>, NDCG(Normalized Discounted Cumulative Gain) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib38" title="">38</a>]</cite>, and MRR(Mean Reciprocal Rank) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib39" title="">39</a>]</cite> with truncation at 10 as the evaluation metrics. HR@10, NDCG@10, and MRR@10. HR is chosen for its straightforward interpretation and ability to measure recall, reflecting how well the system includes relevant items in the top recommendations. NDCG is selected because it considers both the relevance and the order of recommended items, providing a comprehensive assessment of recommendation quality. MRR emphasizes the ranking accuracy of the first relevant item, making it useful for gauging user satisfaction, especially when users tend to look at the top recommendations. Together, these metrics offer a multidimensional evaluation of the recommendation system’s performance.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F4.1" style="width:195.1pt;"><svg class="ltx_picture" height="264.33" id="S4.F4.1.pic1" overflow="visible" version="1.1" width="219.89"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,264.33) matrix(1 0 0 -1 0 0) translate(8.15,0) translate(0,8.15)"><g fill="#F2F2F2"><path d="M -7.87 0 M -7.87 5.53 L -7.87 230.69 C -7.87 233.74 -5.4 236.22 -2.34 236.22 L 199.19 236.22 C 202.25 236.22 204.72 233.74 204.72 230.69 L 204.72 5.53 C 204.72 2.48 202.25 0 199.19 0 L -2.34 0 C -5.4 0 -7.87 2.48 -7.87 5.53 Z M 204.72 236.22"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 186.57 239.37)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.56"><span class="ltx_text" id="S4.F4.1.pic1.3.3.3.1.1">x L</span></foreignobject></g><g fill="#FFFFB3"><path d="M 137.5 225.95 L 59.36 225.95 C 56.3 225.95 53.82 223.47 53.82 220.42 L 53.82 212.65 C 53.82 209.6 56.3 207.12 59.36 207.12 L 137.5 207.12 C 140.55 207.12 143.03 209.6 143.03 212.65 L 143.03 220.42 C 143.03 223.47 140.55 225.95 137.5 225.95 Z M 53.82 207.12"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 58.43 211.73)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S4.F4.1.pic1.4.4.4.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#ECB3C6"><path d="M 122.42 186.5 L 74.43 186.5 C 71.38 186.5 68.9 184.03 68.9 180.97 L 68.9 173.36 C 68.9 170.3 71.38 167.83 74.43 167.83 L 122.42 167.83 C 125.47 167.83 127.95 170.3 127.95 173.36 L 127.95 180.97 C 127.95 184.03 125.47 186.5 122.42 186.5 Z M 68.9 167.83"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 83.48 172.44)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="29.88"><span class="ltx_text" id="S4.F4.1.pic1.5.5.5.1.1">GLU</span></foreignobject></g><g fill="#FFFFB3"><path d="M 86.31 123.59 L 8.17 123.59 C 5.12 123.59 2.64 121.11 2.64 118.05 L 2.64 110.29 C 2.64 107.23 5.12 104.76 8.17 104.76 L 86.31 104.76 C 89.37 104.76 91.85 107.23 91.85 110.29 L 91.85 118.05 C 91.85 121.11 89.37 123.59 86.31 123.59 Z M 2.64 104.76"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 7.25 109.37)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S4.F4.1.pic1.6.6.6.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#FFFFB3"><path d="M 188.68 123.59 L 110.54 123.59 C 107.48 123.59 105 121.11 105 118.05 L 105 110.29 C 105 107.23 107.48 104.76 110.54 104.76 L 188.68 104.76 C 191.73 104.76 194.21 107.23 194.21 110.29 L 194.21 118.05 C 194.21 121.11 191.73 123.59 188.68 123.59 Z M 105 104.76"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 109.61 109.37)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S4.F4.1.pic1.7.7.7.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#FFCCCC"><path d="M 71.24 72.41 L 23.25 72.41 C 20.19 72.41 17.72 69.93 17.72 66.87 L 17.72 59.11 C 17.72 56.05 20.19 53.58 23.25 53.58 L 71.24 53.58 C 74.29 53.58 76.77 56.05 76.77 59.11 L 76.77 66.87 C 76.77 69.93 74.29 72.41 71.24 72.41 Z M 17.72 53.58"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 24.57 58.19)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="45.74"><span class="ltx_text" id="S4.F4.1.pic1.8.8.8.1.1">Mamba</span></foreignobject></g><g fill="#FFCCCC"><path d="M 173.6 72.41 L 125.61 72.41 C 122.56 72.41 120.08 69.93 120.08 66.87 L 120.08 59.11 C 120.08 56.05 122.56 53.58 125.61 53.58 L 173.6 53.58 C 176.66 53.58 179.13 56.05 179.13 59.11 L 179.13 66.87 C 179.13 69.93 176.66 72.41 173.6 72.41 Z M 120.08 53.58"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 126.93 58.19)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="45.74"><span class="ltx_text" id="S4.F4.1.pic1.9.9.9.1.1">Mamba</span></foreignobject></g><g fill="#FFFFFF"><path d="M 106.3 144.49 C 106.3 148.84 102.77 152.36 98.43 152.36 C 94.08 152.36 90.55 148.84 90.55 144.49 C 90.55 140.14 94.08 136.61 98.43 136.61 C 102.77 136.61 106.3 140.14 106.3 144.49 Z M 98.43 144.49"></path></g><path d="M 149.61 32.28 L 149.61 52.66" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 149.61 52.66)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 72.69 L 47.24 103.84" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 47.24 103.84)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 186.78 L 98.43 206.21" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 206.21)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 32.28 L 47.24 32.28 L 47.24 52.66" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 47.24 52.66)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 -7.87 L 98.43 13.78" style="fill:none"></path><path d="M 98.43 225.2 L 98.43 255.27" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 255.27)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 123.87 L 47.24 144.49 L 89.64 144.49" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 89.64 144.49)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 149.61 123.87 L 149.61 144.49 L 107.21 144.49" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 107.21 144.49)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 136.22 L 98.43 167.87" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 167.87)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 86.61 144.49 L 110.24 144.49" style="fill:none"></path><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 13.78 L 98.43 114.17 L 92.76 114.17" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 92.76 114.17)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 13.78 L 98.43 114.17 L 104.09 114.17" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 104.09 114.17)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 157.48 L 149.61 157.48" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 149.61 157.48 L 149.61 216.54 L 143.94 216.54" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 143.94 216.54)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 13.78 L 47.24 13.78 L 47.24 24.41" style="fill:none"></path><path d="M 98.43 13.78 L 149.61 13.78 L 149.61 24.41" style="fill:none"></path><path d="M 149.61 72.69 L 149.61 103.84" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 149.61 103.84)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 18.63 26.41)"><foreignobject height="11.21" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="57.22"><math alttext="v_{1},v_{2},\ldots,v_{n_{u}}" class="ltx_Math" display="inline" id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4"><semantics id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4a"><mrow id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml"><msub id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml"><mi id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml">v</mi><mn id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.4" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml"><mi id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml">v</mi><mn id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.5" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><mi id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">…</mi><mo id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.6" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml"><mi id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml">v</mi><msub id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml"><mi id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2.cmml">n</mi><mi id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3" mathsize="90%" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3.cmml">u</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4b"><list id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3"><apply id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.1.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2">𝑣</ci><cn id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.1.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2">𝑣</ci><cn id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3">2</cn></apply><ci id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">…</ci><apply id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.1.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3">subscript</csymbol><ci id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2">𝑣</ci><apply id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.1.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2">𝑛</ci><ci id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3.cmml" xref="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3">𝑢</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4c">v_{1},v_{2},\ldots,v_{n_{u}}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 122.96 26.41)"><foreignobject height="11.21" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="57.22"><math alttext="v_{n_{u}},\ldots,v_{2},v_{1}" class="ltx_Math" display="inline" id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4"><semantics id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4a"><mrow id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml"><msub id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml"><mi id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml">v</mi><msub id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml"><mi id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2.cmml">n</mi><mi id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3.cmml">u</mi></msub></msub><mo id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.4" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><mi id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">…</mi><mo id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.5" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml"><mi id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml">v</mi><mn id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.6" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml"><mi id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml">v</mi><mn id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3" mathsize="90%" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4b"><list id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3"><apply id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.1.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2">𝑣</ci><apply id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.1.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2">𝑛</ci><ci id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3">𝑢</ci></apply></apply><ci id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">…</ci><apply id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.1.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2">𝑣</ci><cn id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3">2</cn></apply><apply id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.1.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3">subscript</csymbol><ci id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2">𝑣</ci><cn id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml" type="integer" xref="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3">1</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4c">v_{n_{u}},\ldots,v_{2},v_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4d">italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 153.95 81.89)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.82"><span class="ltx_text" id="S4.F4.1.pic1.10.10.10.1.1">Reverse</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 153.95 9.05)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.82"><span class="ltx_text" id="S4.F4.1.pic1.11.11.11.1.1">Reverse</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S4.F4.1.2.1">Bi-Mamba4Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib40" title="">40</a>]</cite></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F4.2" style="width:195.1pt;"><svg class="ltx_picture" height="303.7" id="S4.F4.2.pic1" overflow="visible" version="1.1" width="219.89"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,303.7) matrix(1 0 0 -1 0 0) translate(8.15,0) translate(0,47.52)"><g fill="#F2F2F2"><path d="M -7.87 -39.37 M -7.87 -33.84 L -7.87 230.69 C -7.87 233.74 -5.4 236.22 -2.34 236.22 L 199.19 236.22 C 202.25 236.22 204.72 233.74 204.72 230.69 L 204.72 -33.84 C 204.72 -36.89 202.25 -39.37 199.19 -39.37 L -2.34 -39.37 C -5.4 -39.37 -7.87 -36.89 -7.87 -33.84 Z M 204.72 236.22"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 186.57 239.37)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.56"><span class="ltx_text" id="S4.F4.2.pic1.3.3.3.1.1">x L</span></foreignobject></g><g fill="#FF9999"><path d="M 151.95 -3.09 L 44.9 -3.09 C 41.85 -3.09 39.37 -5.57 39.37 -8.63 L 39.37 -18.93 C 39.37 -21.99 41.85 -24.46 44.9 -24.46 L 151.95 -24.46 C 155 -24.46 157.48 -21.99 157.48 -18.93 L 157.48 -8.63 C 157.48 -5.57 155 -3.09 151.95 -3.09 Z M 39.37 -24.46"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 50.26 -17.16)"><foreignobject height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="97.09"><span class="ltx_text" id="S4.F4.2.pic1.4.4.4.1.1">Attention Layer</span></foreignobject></g><g fill="#FFFFB3"><path d="M 137.5 225.95 L 59.36 225.95 C 56.3 225.95 53.82 223.47 53.82 220.42 L 53.82 212.65 C 53.82 209.6 56.3 207.12 59.36 207.12 L 137.5 207.12 C 140.55 207.12 143.03 209.6 143.03 212.65 L 143.03 220.42 C 143.03 223.47 140.55 225.95 137.5 225.95 Z M 53.82 207.12"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 58.43 211.73)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S4.F4.2.pic1.5.5.5.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#ECB3C6"><path d="M 122.42 186.5 L 74.43 186.5 C 71.38 186.5 68.9 184.03 68.9 180.97 L 68.9 173.36 C 68.9 170.3 71.38 167.83 74.43 167.83 L 122.42 167.83 C 125.47 167.83 127.95 170.3 127.95 173.36 L 127.95 180.97 C 127.95 184.03 125.47 186.5 122.42 186.5 Z M 68.9 167.83"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 83.48 172.44)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="29.88"><span class="ltx_text" id="S4.F4.2.pic1.6.6.6.1.1">GLU</span></foreignobject></g><g fill="#FFFFB3"><path d="M 86.31 123.59 L 8.17 123.59 C 5.12 123.59 2.64 121.11 2.64 118.05 L 2.64 110.29 C 2.64 107.23 5.12 104.76 8.17 104.76 L 86.31 104.76 C 89.37 104.76 91.85 107.23 91.85 110.29 L 91.85 118.05 C 91.85 121.11 89.37 123.59 86.31 123.59 Z M 2.64 104.76"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 7.25 109.37)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S4.F4.2.pic1.7.7.7.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#FFFFB3"><path d="M 188.68 123.59 L 110.54 123.59 C 107.48 123.59 105 121.11 105 118.05 L 105 110.29 C 105 107.23 107.48 104.76 110.54 104.76 L 188.68 104.76 C 191.73 104.76 194.21 107.23 194.21 110.29 L 194.21 118.05 C 194.21 121.11 191.73 123.59 188.68 123.59 Z M 105 104.76"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 109.61 109.37)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="79.99"><span class="ltx_text" id="S4.F4.2.pic1.8.8.8.1.1">Add &amp; Norm</span></foreignobject></g><g fill="#FFCCCC"><path d="M 71.24 72.41 L 23.25 72.41 C 20.19 72.41 17.72 69.93 17.72 66.87 L 17.72 59.11 C 17.72 56.05 20.19 53.58 23.25 53.58 L 71.24 53.58 C 74.29 53.58 76.77 56.05 76.77 59.11 L 76.77 66.87 C 76.77 69.93 74.29 72.41 71.24 72.41 Z M 17.72 53.58"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 24.57 58.19)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="45.74"><span class="ltx_text" id="S4.F4.2.pic1.9.9.9.1.1">Mamba</span></foreignobject></g><g fill="#FFCCCC"><path d="M 173.6 72.41 L 125.61 72.41 C 122.56 72.41 120.08 69.93 120.08 66.87 L 120.08 59.11 C 120.08 56.05 122.56 53.58 125.61 53.58 L 173.6 53.58 C 176.66 53.58 179.13 56.05 179.13 59.11 L 179.13 66.87 C 179.13 69.93 176.66 72.41 173.6 72.41 Z M 120.08 53.58"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 126.93 58.19)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="45.74"><span class="ltx_text" id="S4.F4.2.pic1.10.10.10.1.1">Mamba</span></foreignobject></g><g fill="#FFFFFF"><path d="M 106.3 144.49 C 106.3 148.84 102.77 152.36 98.43 152.36 C 94.08 152.36 90.55 148.84 90.55 144.49 C 90.55 140.14 94.08 136.61 98.43 136.61 C 102.77 136.61 106.3 140.14 106.3 144.49 Z M 98.43 144.49"></path></g><path d="M 149.61 32.28 L 149.61 52.66" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 149.61 52.66)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 72.69 L 47.24 103.84" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 47.24 103.84)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 186.78 L 98.43 206.21" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 206.21)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 32.28 L 47.24 32.28 L 47.24 52.66" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 47.24 52.66)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 -2.82 L 98.43 13.78" style="fill:none"></path><path d="M 98.43 225.2 L 98.43 255.27" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 255.27)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 47.24 123.87 L 47.24 144.49 L 89.64 144.49" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 89.64 144.49)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 149.61 123.87 L 149.61 144.49 L 107.21 144.49" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 107.21 144.49)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 136.22 L 98.43 167.87" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 167.87)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 86.61 144.49 L 110.24 144.49" style="fill:none"></path><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 13.78 L 98.43 114.17 L 92.76 114.17" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 92.76 114.17)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 13.78 L 98.43 114.17 L 104.09 114.17" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(1.0 0.0 0.0 1.0 104.09 114.17)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 98.43 157.48 L 149.61 157.48" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 149.61 157.48 L 149.61 216.54 L 143.94 216.54" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(-1.0 0.0 0.0 -1.0 143.94 216.54)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 -47.24 L 98.43 -25.38" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 98.43 -25.38)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><path d="M 98.43 13.78 L 47.24 13.78 L 47.24 24.41" style="fill:none"></path><path d="M 98.43 13.78 L 149.61 13.78 L 149.61 24.41" style="fill:none"></path><path d="M 149.61 72.69 L 149.61 103.84" style="fill:none"></path><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.32pt" transform="matrix(0.0 1.0 -1.0 0.0 149.61 103.84)"><path d="M -1.66 2.21 C -1.52 1.38 0 0.14 0.42 0 C 0 -0.14 -1.52 -1.38 -1.66 -2.21" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 18.63 26.41)"><foreignobject height="11.21" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="57.22"><math alttext="v_{1},v_{2},\ldots,v_{n_{u}}" class="ltx_Math" display="inline" id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4"><semantics id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4a"><mrow id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml"><msub id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml"><mi id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml">v</mi><mn id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.4" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml"><mi id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml">v</mi><mn id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.5" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><mi id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">…</mi><mo id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.6" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml"><mi id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml">v</mi><msub id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml"><mi id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2.cmml">n</mi><mi id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3" mathsize="90%" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3.cmml">u</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4b"><list id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3"><apply id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.1.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2">𝑣</ci><cn id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.1.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2">𝑣</ci><cn id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3">2</cn></apply><ci id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">…</ci><apply id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.1.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3">subscript</csymbol><ci id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2">𝑣</ci><apply id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.1.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.2">𝑛</ci><ci id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3.cmml" xref="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.3">𝑢</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4c">v_{1},v_{2},\ldots,v_{n_{u}}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.4d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 122.96 26.41)"><foreignobject height="11.21" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="57.22"><math alttext="v_{n_{u}},\ldots,v_{2},v_{1}" class="ltx_Math" display="inline" id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4"><semantics id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4a"><mrow id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml"><msub id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml"><mi id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml">v</mi><msub id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml"><mi id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2.cmml">n</mi><mi id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3.cmml">u</mi></msub></msub><mo id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.4" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><mi id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">…</mi><mo id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.5" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml"><mi id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml">v</mi><mn id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.6" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml">,</mo><msub id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml"><mi id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml">v</mi><mn id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3" mathsize="90%" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4b"><list id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.4.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3"><apply id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.1.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.2">𝑣</ci><apply id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.1.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.2">𝑛</ci><ci id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.2.2.1.1.3.3">𝑢</ci></apply></apply><ci id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.1.1">…</ci><apply id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.1.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.2">𝑣</ci><cn id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.3.3.2.2.3">2</cn></apply><apply id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.1.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3">subscript</csymbol><ci id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2.cmml" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.2">𝑣</ci><cn id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3.cmml" type="integer" xref="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4.4.3.3.3">1</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4c">v_{n_{u}},\ldots,v_{2},v_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.F4.2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.m1.4d">italic_v start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 153.95 81.89)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.82"><span class="ltx_text" id="S4.F4.2.pic1.11.11.11.1.1">Reverse</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 153.95 9.05)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.82"><span class="ltx_text" id="S4.F4.2.pic1.12.12.12.1.1">Reverse</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S4.F4.2.2.1">Bi-Mambaformer4Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib41" title="">41</a>]</cite> </figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Recommendation performance</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Based on the results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4.T2" title="Table 2 ‣ 4.2 Recommendation performance ‣ 4 Experiments ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, the evaluation of models reveals notable trends. RNN-based models, including NARM and GRU4Rec, demonstrate competitive but relatively lower performance compared to attention-based models such as SASRec and BERT4Rec. And the Mamba model variants, outperform both RNN and attention-based models across MovieLens-1M, Amazon-Beauty, and Amazon-Video-Games datasets. Notably, EchoMamba4Rec achieves superior performance compared to baselines based on RNN, Transformer, Mamba and thier hybrid showcasing its effectiveness in capturing intricate user-item interactions and providing accurate recommendations.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Recommendation performance. The best results are bold, and the second-best are underlined.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T2.1" style="width:433.6pt;height:132.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-77.9pt,23.8pt) scale(0.735658009315389,0.735658009315389) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T2.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.2.1">MovieLens-1M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T2.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.3.1">Amazon-Beauty</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T2.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.4.1">Amazon-Video-Games</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.1" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.1.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.2" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.2.1">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T2.1.1.2.2.3" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.3.1">MRR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.4" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.4.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.5" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.5.1">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T2.1.1.2.2.6" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.6.1">MRR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.7" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.7.1">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.8" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.8.1">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.9" style="padding-bottom:2.15277pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.2.2.9.1">MRR@10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.3.1.1">NARM</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.2">0.2884</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.3">0.1445</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.3.1.4">0.1267</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.5">0.0640</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.6">0.0369</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.3.1.7">0.0287</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.8">0.1057</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.9">0.0556</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.10">0.0405</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.4.2.1">GRU4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.2">0.2642</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.3">0.1464</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.4.2.4">0.1106</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.5">0.0664</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.6">0.0365</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.4.2.7">0.0274</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.8">0.1101</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.9">0.0573</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.10">0.0414</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.5.3.1">SASRec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.2">0.2429</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.3">0.1262</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.5.3.4">0.0905</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.5">0.0739</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.6">0.0404</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.5.3.7">0.0302</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.8">0.1203</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.9">0.0561</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.10">0.0366</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.6.4.1">BERT4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.2">0.2910</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.3">0.0979</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.6.4.4">0.0663</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.5">0.0711</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.6.1">0.0426</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.6.4.7">0.0309</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.8">0.1106</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.9">0.0508</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.10">0.0324</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.7.5.1">Mamba4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.2">0.3069</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.7.5.3.1">0.1509</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.7.5.4">0.1223</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.5">0.0621</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.6">0.0369</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.7.5.7">0.0292</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.8">0.1057</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.7.5.9.1">0.0587</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.10">0.0441</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.8.6.1">Bi-Mamba4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.6.2">0.3051</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.6.3">0.1485</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.8.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.8.6.4.1">0.1398</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.8.6.5.1">0.0781</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.6.6">0.0423</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.8.6.7">0.0313</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.6.8">0.1200</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.6.9">0.0580</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.6.10">0.0392</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.1.1.9.7.1">Bi-Mambaformer4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.9.7.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.9.7.2.1">0.3166</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.9.7.3">0.1470</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.9.7.4">0.1106</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.9.7.5">0.0773</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.9.7.6">0.0304</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.9.7.7"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.9.7.7.1">0.0412</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.9.7.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.9.7.8.1">0.1205</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.9.7.9">0.0451</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.9.7.10"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.9.7.10.1">0.0626</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.10.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.1.1.10.8.1">EchoMamba4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.10.8.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.10.8.2.1">0.3215</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.10.8.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.10.8.3.1">0.1529</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.1.1.10.8.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.10.8.4.1">0.1458</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.10.8.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.10.8.5.1">0.0833</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.10.8.6"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.10.8.6.1">0.0438</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.1.1.10.8.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.10.8.7.1">0.0318</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.10.8.8"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.10.8.8.1">0.1254</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.10.8.9"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.10.8.9.1">0.0633</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.1.1.10.8.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.10.8.10.1">0.0445</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Efficiency performance</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#S4.T3" title="Table 3 ‣ 4.3 Efficiency performance ‣ 4 Experiments ‣ EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> shows the efficiency performance of attention-based models, Mamba4Rec, and EchoMamba4Rec in detail. All measurements were conducted on an RTX 4090 GPU using the Amazon-Video Games dataset. EchoMamba4Rec exhibits superior performance in terms of training time per epoch, while the GPU memory cost is close to that of Mamba. These results demonstrate that EchoMamba4Rec achieves better efficiency when controlling memory usage compared to attention-based models and Mamba.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Efficiency performance on amazon-video games</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.2.1">GPU memory (GB)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.3.1">Training time (s)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.4.1">Inference time (s)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.2.1.1">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.2.1.2">6.58</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.2.1.3">163.543</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.4">0.3015</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.3.2.1">BERT4Rec</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.3.2.2">6.68</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.3.2.3">215.800</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.2.4">0.3218</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.4.3.1">Mamba4Rec</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.4.3.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.4.3.2.1">1.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.4.3.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.4.3.3.1">98.759</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.3.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.4.3.4.1">0.0305</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.1.5.4.1">EchoMamba4Rec</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.1.5.4.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.5.4.2.1">1.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.5.4.3.1">70.187</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.1.5.4.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.5.4.4.1">0.0252</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Future work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In future work, we plan to explore the following directions to further enhance the capabilities and applicability of the EchoMamba4Rec model:</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Advanced Filtering Techniques:</span> investigate the integration of additional advanced filtering methods, such as wavelet transforms <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib42" title="">42</a>]</cite> and adaptive filtering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib43" title="">43</a>]</cite>, to improve the model’s ability to capture complex and nuanced patterns in user behavior sequences.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">Cross-Domain Evaluation:</span> test the EchoMamba4Rec model on a wider range of datasets from different domains, such as e-commerce, streaming services, and social media <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib8" title="">8</a>]</cite>, to evaluate its generalizability and robustness across various application scenarios.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p4">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">Real-Time Implementation:</span> explore the feasibility of implementing EchoMamba4Rec in real-time recommendation systems to assess its performance in a live environment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib44" title="">44</a>]</cite>, focusing on response time and scalability.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p5">
<p class="ltx_p" id="S5.p5.1"><span class="ltx_text ltx_font_bold" id="S5.p5.1.1">User Privacy and Fairness:</span> investigate the implications of user privacy and fairness in the recommendations generated by EchoMamba4Rec, ensuring that the model adheres to ethical guidelines and provides equitable recommendations for all users <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02638v2#bib.bib45" title="">45</a>]</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Acknowledgement</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">The authors would like to appreciate the support from
the Interdisciplinary Intelligence Super Computer Cen-
ter of Beijing Normal University at Zhuhai.
This work was funded by the Natural Science Foundation of China (12271047); Guangdong Provincial Key Laboratory of Interdisciplinary Research and Application for Data Science, BNU-HKBU United International College (2022B1212010006); UIC research grant (R0400001-22; UICR0400008-21; UICR0400036-21CTL; UICR04202405-21); Guangdong College Enhancement and Innovation Program (2021ZDZX1046).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.1.1">
<span class="ltx_bibblock"><span class="ltx_ERROR undefined" id="bib.1.1.1.1">\bibcommenthead</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2018]</span>
<span class="ltx_bibblock">
Chen, R.,
Hua, Q.,
Chang, Y.-S.,
Wang, B.,
Zhang, L.,
Kong, X.:
A survey of collaborative filtering-based recommender systems: From traditional methods to hybrid methods based on social networks.
IEEE ACESS
<span class="ltx_text ltx_font_bold" id="bib.bib1.1.1">6</span>,
64301–64320
(2018)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. [2019]</span>
<span class="ltx_bibblock">
Gao, B.,
Zhan, G.,
Wang, H.,
Wang, Y.,
Zhu, S.:
Learning with linear mixed model for group recommendation systems.
In: Proceedings of the 2019 11th International Conference on Machine Learning and Computing,
pp. 81–85
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2020]</span>
<span class="ltx_bibblock">
Chen, Z.,
Zhu, S.,
Niu, Q.,
Zuo, T.:
Knowledge discovery and recommendation with linear mixed model.
IEEE Access
<span class="ltx_text ltx_font_bold" id="bib.bib3.1.1">8</span>,
38304–38317
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2019]</span>
<span class="ltx_bibblock">
Chen, Z.,
Zhu, S.,
Niu, Q.,
Lu, X.:
Censorious young: knowledge discovery from high-throughput movie rating data with lme4.
In: 2019 IEEE 4th International Conference on Big Data Analytics (ICBDA),
pp. 32–36
(2019).
IEEE


</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2021]</span>
<span class="ltx_bibblock">
Xu, B.,
Bu, S.,
Li, X.,
Lin, Y.,
Zhu, S.:
xDeepFIG: An extreme deep model with feature interactions and generation for CTR prediction.
In: Proceedings of the 2021 3rd International Conference on Big-data Service and Intelligent Computation,
pp. 42–51
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2023]</span>
<span class="ltx_bibblock">
Luo, Z.,
Zhang, Y.,
Hu, C.,
Xia, Y.,
Zhu, S.:
Click-through rate prediction models based on interest modeling.
In: Proceedings of the 2023 5th International Conference on Big Data Engineering,
pp. 18–27
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. [2022]</span>
<span class="ltx_bibblock">
Feng, Y.,
Zhu, S.,
Ou, Y.:
Accelerating din model for online CTR prediction with data compression.
In: 2022 7th International Conference on Big Data Analytics (ICBDA),
pp. 84–89
(2022).
IEEE


</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2021]</span>
<span class="ltx_bibblock">
Zhang, J.,
Gao, C.,
Jin, D.,
Li, Y.:
Group-buying recommendation for social e-commerce.
In: 2021 IEEE 37th International Conference on Data Engineering (ICDE),
pp. 1536–1547
(2021).
IEEE


</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2024]</span>
<span class="ltx_bibblock">
Zheng, Y.,
Lin, X.,
Chen, K.,
Zhu, S.:
CycleTrans: a transformer-based clinical foundation model for safer prescription.
In: AAAI 2024 Spring Symposium on Clinical Foundation Models
(2024)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quadrana et al. [2018]</span>
<span class="ltx_bibblock">
Quadrana, M.,
Cremonesi, P.,
Jannach, D.:
Sequence-aware recommender systems.
ACM computing surveys (CSUR)
<span class="ltx_text ltx_font_bold" id="bib.bib10.1.1">51</span>(4),
1–36
(2018)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2023]</span>
<span class="ltx_bibblock">
Liu, L.,
Cai, L.,
Zhang, C.,
Zhao, X.,
Gao, J.,
Wang, W.,
Lv, Y.,
Fan, W.,
Wang, Y.,
He, M., <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">et al.</span>:
Linrec: Linear attention mechanism for long-term sequential recommender systems.
In: Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval,
pp. 289–299
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
Vaswani, A.,
Shazeer, N.,
Parmar, N.,
Uszkoreit, J.,
Jones, L.,
Gomez, A.N.,
Kaiser,  .,
Polosukhin, I.:
Attention is all you need.
In: Advances in Neural Information Processing Systems,
vol. 30
(2017)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keles et al. [2023]</span>
<span class="ltx_bibblock">
Keles, F.D.,
Wijewardena, P.M.,
Hegde, C.:
On the computational complexity of self-attention.
In: International Conference on Algorithmic Learning Theory,
pp. 597–619
(2023).
PMLR


</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamilton [1994]</span>
<span class="ltx_bibblock">
Hamilton, J.D.:
State-space models.
Handbook of Econometrics
<span class="ltx_text ltx_font_bold" id="bib.bib14.1.1">4</span>,
3039–3080
(1994)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. [2021]</span>
<span class="ltx_bibblock">
Gu, A.,
Goel, K.,
Ré, C.:
Efficiently modeling long sequences with structured state spaces.
arXiv preprint arXiv:2111.00396
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al. [2007]</span>
<span class="ltx_bibblock">
Williams, R.L.,
Lawrence, D.A., <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">et al.</span>:
Linear State-space Control Systems.
John Wiley &amp; Sons,
Hoboken, NJ
(2007)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu and Dao [2023]</span>
<span class="ltx_bibblock">
Gu, A.,
Dao, T.:
Mamba: Linear-time sequence modeling with selective state spaces.
arXiv preprint arXiv:2312.00752
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2024]</span>
<span class="ltx_bibblock">
Liu, C.,
Lin, J.,
Wang, J.,
Liu, H.,
Caverlee, J.:
Mamba4rec: Towards efficient sequential recommendation with selective state space models.
arXiv preprint arXiv:2403.03900v1
(2024)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2021]</span>
<span class="ltx_bibblock">
Zhou, H.,
Zhang, S.,
Peng, J.,
Zhang, S.,
Li, J.,
Xiong, H.,
Zhang, W.:
Informer: Beyond efficient transformer for long sequence time-series forecasting.
In: Proceedings of the AAAI Conference on Artificial Intelligence,
vol. 35,
pp. 11106–11115
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al. [2015]</span>
<span class="ltx_bibblock">
Hidasi, B.,
Karatzoglou, A.,
Baltrunas, L.,
Tikk, D.:
Session-based recommendations with recurrent neural networks.
arXiv preprint arXiv:1511.06939
(2015)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et al. [2017]</span>
<span class="ltx_bibblock">
Kirkpatrick, J.,
Pascanu, R.,
Rabinowitz, N.,
Veness, J.,
Desjardins, G.,
Rusu, A.A.,
Milan, K.,
Quan, J.,
Ramalho, T.,
Grabska-Barwinska, A., <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">et al.</span>:
Overcoming catastrophic forgetting in neural networks.
Proceedings of the National Academy of Sciences
<span class="ltx_text ltx_font_bold" id="bib.bib21.2.2">114</span>(13),
3521–3526
(2017)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley [2018]</span>
<span class="ltx_bibblock">
Kang, W.-C.,
McAuley, J.:
Self-attentive sequential recommendation.
In: 2018 IEEE International Conference on Data Mining (ICDM)
(2018).
IEEE


</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalman [1960]</span>
<span class="ltx_bibblock">
Kalman, R.E.:
A new approach to linear filtering and prediction problems
(1960)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ogata and Yang [2002]</span>
<span class="ltx_bibblock">
Ogata, K.,
Yang, Y.:
Modern Control Engineering
vol. 5.
Prentice Hall India,
Englewood Cliffs, NJ
(2002)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ljung [2010]</span>
<span class="ltx_bibblock">
Ljung, L.:
Perspectives on system identification.
Annual Reviews in Control
<span class="ltx_text ltx_font_bold" id="bib.bib25.1.1">34</span>(1),
1–12
(2010)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. [2020]</span>
<span class="ltx_bibblock">
Gu, A.,
Dao, T.,
Ermon, S.,
Rudra, A.,
Ré, C.:
Hippo: Recurrent memory with optimal polynomial projections.
Advances in Neural Information Processing Systems
<span class="ltx_text ltx_font_bold" id="bib.bib26.1.1">33</span>,
1474–1487
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. [2021]</span>
<span class="ltx_bibblock">
Gu, A.,
Goel, K.,
Ré, C.:
Efficiently modeling long sequences with structured state spaces.
arXiv preprint arXiv:2111.00396
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and Schmidhuber [1997]</span>
<span class="ltx_bibblock">
Hochreiter, S.,
Schmidhuber, J.:
Long short-term memory.
Neural computation
<span class="ltx_text ltx_font_bold" id="bib.bib28.1.1">9</span>(8),
1735–1780
(1997)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al. [2014]</span>
<span class="ltx_bibblock">
Chung, J.,
Gulcehre, C.,
Cho, K.,
Bengio, Y.:
Empirical evaluation of gated recurrent neural networks on sequence modeling.
arXiv preprint arXiv:1412.3555
(2014)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2022]</span>
<span class="ltx_bibblock">
Zhou, K.,
Yu, H.,
Zhao, W.X.,
Wen, J.-R.:
Filter-enhanced mlp is all you need for sequential recommendation.
In: Proceedings of the ACM Web Conference 2022,
pp. 2388–2399
(2022)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. [2019]</span>
<span class="ltx_bibblock">
Ni, J.,
Li, J.,
McAuley, J.:
Justifying recommendations using distantly-labeled reviews and fine-grained aspects.
In: Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP),
pp. 188–197
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Umemoto [2022]</span>
<span class="ltx_bibblock">
Umemoto, K.:
Ml-1m++: Movielens-compatible additional preferences for more robust offline evaluation of sequential recommenders.
In: Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management,
pp. 4540–4544
(2022)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2021]</span>
<span class="ltx_bibblock">
Zhao, W.X.,
Mu, S.,
Hou, Y.,
Lin, Z.,
Chen, Y.,
Pan, X.,
Li, K.,
Lu, Y.,
Wang, H.,
Tian, C., <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">et al.</span>:
Recbole: Towards a unified, comprehensive and efficient framework for recommendation algorithms.
In: Proceedings of the 30th Acm International Conference on Information &amp; Knowledge Management,
pp. 4653–4664
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jannach and Ludewig [2017]</span>
<span class="ltx_bibblock">
Jannach, D.,
Ludewig, M.:
When recurrent neural networks meet the neighborhood for session-based recommendation.
In: Proceedings of the Eleventh ACM Conference on Recommender Systems,
pp. 306–310
(2017)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2017]</span>
<span class="ltx_bibblock">
Li, J.,
Ren, P.,
Chen, Z.,
Ren, Z.,
Lian, T.,
Ma, J.:
Neural attentive session-based recommendation.
In: Proceedings of the 2017 ACM on Conference on Information and Knowledge Management,
pp. 1419–1428
(2017)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. [2019]</span>
<span class="ltx_bibblock">
Sun, F.,
Liu, J.,
Wu, J.,
Pei, C.,
Lin, X.,
Ou, W.,
Jiang, P.:
Bert4rec: Sequential recommendation with bidirectional encoder representations from transformer.
In: Proceedings of the 28th ACM International Conference on Information and Knowledge Management,
pp. 1441–1450
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alsini et al. [2020]</span>
<span class="ltx_bibblock">
Alsini, A.,
Huynh, D.Q.,
Datta, A.:
Hit ratio: An evaluation metric for hashtag recommendation.
arXiv preprint arXiv:2010.01258
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeunen et al. [2023]</span>
<span class="ltx_bibblock">
Jeunen, O.,
Potapov, I.,
Ustimenko, A.:
On (normalised) discounted cumulative gain as an offline evaluation metric for top-<math alttext="n" class="ltx_Math" display="inline" id="bib.bib38.1.m1.1"><semantics id="bib.bib38.1.m1.1a"><mi id="bib.bib38.1.m1.1.1" xref="bib.bib38.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="bib.bib38.1.m1.1b"><ci id="bib.bib38.1.m1.1.1.cmml" xref="bib.bib38.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib38.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="bib.bib38.1.m1.1d">italic_n</annotation></semantics></math> recommendation.
arXiv preprint arXiv:2307.15053
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. [2023]</span>
<span class="ltx_bibblock">
Lu, X.,
Wu, J.,
Yuan, J.:
Optimizing reciprocal rank with bayesian average for improved next item recommendation.
In: Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval,
pp. 2236–2240
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. [2024]</span>
<span class="ltx_bibblock">
Liang, A.,
Jiang, X.,
Sun, Y.,
Lu, C.:
Bi-mamba4ts: Bidirectional mamba for time series forecasting.
arXiv preprint arXiv:2404.15772
(2024)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2024]</span>
<span class="ltx_bibblock">
Xu, X.,
Liang, Y.,
Huang, B.,
Lan, Z.,
Shu, K.:
Integrating mamba and transformer for long-short range time series forecasting.
arXiv preprint arXiv:2404.14757
(2024)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Daubechies [1992]</span>
<span class="ltx_bibblock">
Daubechies, I.:
Ten Lectures on Wavelets.
SIAM,
Philadelphia, PA
(1992)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haykin [2002]</span>
<span class="ltx_bibblock">
Haykin, S.:
Adaptive Filter Theory.
Prentice Hall,
Upper Saddle River, NJ, USA
(2002)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong and Bartlett [2008]</span>
<span class="ltx_bibblock">
Hong, Y.,
Bartlett, R.:
Routledge Handbook of Biomechanics and Human Movement Science.
Routledge New York, NY, USA:,
New York, NY, USA
(2008)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kamishima et al. [2012]</span>
<span class="ltx_bibblock">
Kamishima, T.,
Akaho, S.,
Asoh, H.,
Sakuma, J.:
Enhancement of the neutrality in recommendation.
In: Decisions@ RecSys,
pp. 8–14
(2012)


</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Definition</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Hit Ratio (HR)</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Hit Ratio measures the fraction of times the correct item appears in the top <math alttext="N" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">italic_N</annotation></semantics></math> recommended items for each user. It can be formally defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex33">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="HR=\frac{1}{|U|}\sum_{u\in U}\mathbb{I}(\text{rank}(u)\leq N)." class="ltx_Math" display="block" id="A1.Ex33.m1.3"><semantics id="A1.Ex33.m1.3a"><mrow id="A1.Ex33.m1.3.3.1" xref="A1.Ex33.m1.3.3.1.1.cmml"><mrow id="A1.Ex33.m1.3.3.1.1" xref="A1.Ex33.m1.3.3.1.1.cmml"><mrow id="A1.Ex33.m1.3.3.1.1.3" xref="A1.Ex33.m1.3.3.1.1.3.cmml"><mi id="A1.Ex33.m1.3.3.1.1.3.2" xref="A1.Ex33.m1.3.3.1.1.3.2.cmml">H</mi><mo id="A1.Ex33.m1.3.3.1.1.3.1" xref="A1.Ex33.m1.3.3.1.1.3.1.cmml">⁢</mo><mi id="A1.Ex33.m1.3.3.1.1.3.3" xref="A1.Ex33.m1.3.3.1.1.3.3.cmml">R</mi></mrow><mo id="A1.Ex33.m1.3.3.1.1.2" xref="A1.Ex33.m1.3.3.1.1.2.cmml">=</mo><mrow id="A1.Ex33.m1.3.3.1.1.1" xref="A1.Ex33.m1.3.3.1.1.1.cmml"><mfrac id="A1.Ex33.m1.1.1" xref="A1.Ex33.m1.1.1.cmml"><mn id="A1.Ex33.m1.1.1.3" xref="A1.Ex33.m1.1.1.3.cmml">1</mn><mrow id="A1.Ex33.m1.1.1.1.3" xref="A1.Ex33.m1.1.1.1.2.cmml"><mo id="A1.Ex33.m1.1.1.1.3.1" stretchy="false" xref="A1.Ex33.m1.1.1.1.2.1.cmml">|</mo><mi id="A1.Ex33.m1.1.1.1.1" xref="A1.Ex33.m1.1.1.1.1.cmml">U</mi><mo id="A1.Ex33.m1.1.1.1.3.2" stretchy="false" xref="A1.Ex33.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="A1.Ex33.m1.3.3.1.1.1.2" xref="A1.Ex33.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex33.m1.3.3.1.1.1.1" xref="A1.Ex33.m1.3.3.1.1.1.1.cmml"><munder id="A1.Ex33.m1.3.3.1.1.1.1.2" xref="A1.Ex33.m1.3.3.1.1.1.1.2.cmml"><mo id="A1.Ex33.m1.3.3.1.1.1.1.2.2" movablelimits="false" xref="A1.Ex33.m1.3.3.1.1.1.1.2.2.cmml">∑</mo><mrow id="A1.Ex33.m1.3.3.1.1.1.1.2.3" xref="A1.Ex33.m1.3.3.1.1.1.1.2.3.cmml"><mi id="A1.Ex33.m1.3.3.1.1.1.1.2.3.2" xref="A1.Ex33.m1.3.3.1.1.1.1.2.3.2.cmml">u</mi><mo id="A1.Ex33.m1.3.3.1.1.1.1.2.3.1" xref="A1.Ex33.m1.3.3.1.1.1.1.2.3.1.cmml">∈</mo><mi id="A1.Ex33.m1.3.3.1.1.1.1.2.3.3" xref="A1.Ex33.m1.3.3.1.1.1.1.2.3.3.cmml">U</mi></mrow></munder><mrow id="A1.Ex33.m1.3.3.1.1.1.1.1" xref="A1.Ex33.m1.3.3.1.1.1.1.1.cmml"><mi id="A1.Ex33.m1.3.3.1.1.1.1.1.3" xref="A1.Ex33.m1.3.3.1.1.1.1.1.3.cmml">𝕀</mi><mo id="A1.Ex33.m1.3.3.1.1.1.1.1.2" xref="A1.Ex33.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mtext id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.2a.cmml">rank</mtext><mo id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.1" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex33.m1.2.2" xref="A1.Ex33.m1.2.2.cmml">u</mi><mo id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">≤</mo><mi id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="A1.Ex33.m1.3.3.1.2" lspace="0em" xref="A1.Ex33.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex33.m1.3b"><apply id="A1.Ex33.m1.3.3.1.1.cmml" xref="A1.Ex33.m1.3.3.1"><eq id="A1.Ex33.m1.3.3.1.1.2.cmml" xref="A1.Ex33.m1.3.3.1.1.2"></eq><apply id="A1.Ex33.m1.3.3.1.1.3.cmml" xref="A1.Ex33.m1.3.3.1.1.3"><times id="A1.Ex33.m1.3.3.1.1.3.1.cmml" xref="A1.Ex33.m1.3.3.1.1.3.1"></times><ci id="A1.Ex33.m1.3.3.1.1.3.2.cmml" xref="A1.Ex33.m1.3.3.1.1.3.2">𝐻</ci><ci id="A1.Ex33.m1.3.3.1.1.3.3.cmml" xref="A1.Ex33.m1.3.3.1.1.3.3">𝑅</ci></apply><apply id="A1.Ex33.m1.3.3.1.1.1.cmml" xref="A1.Ex33.m1.3.3.1.1.1"><times id="A1.Ex33.m1.3.3.1.1.1.2.cmml" xref="A1.Ex33.m1.3.3.1.1.1.2"></times><apply id="A1.Ex33.m1.1.1.cmml" xref="A1.Ex33.m1.1.1"><divide id="A1.Ex33.m1.1.1.2.cmml" xref="A1.Ex33.m1.1.1"></divide><cn id="A1.Ex33.m1.1.1.3.cmml" type="integer" xref="A1.Ex33.m1.1.1.3">1</cn><apply id="A1.Ex33.m1.1.1.1.2.cmml" xref="A1.Ex33.m1.1.1.1.3"><abs id="A1.Ex33.m1.1.1.1.2.1.cmml" xref="A1.Ex33.m1.1.1.1.3.1"></abs><ci id="A1.Ex33.m1.1.1.1.1.cmml" xref="A1.Ex33.m1.1.1.1.1">𝑈</ci></apply></apply><apply id="A1.Ex33.m1.3.3.1.1.1.1.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1"><apply id="A1.Ex33.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex33.m1.3.3.1.1.1.1.2.1.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="A1.Ex33.m1.3.3.1.1.1.1.2.2.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.2.2"></sum><apply id="A1.Ex33.m1.3.3.1.1.1.1.2.3.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.2.3"><in id="A1.Ex33.m1.3.3.1.1.1.1.2.3.1.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.2.3.1"></in><ci id="A1.Ex33.m1.3.3.1.1.1.1.2.3.2.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.2.3.2">𝑢</ci><ci id="A1.Ex33.m1.3.3.1.1.1.1.2.3.3.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.2.3.3">𝑈</ci></apply></apply><apply id="A1.Ex33.m1.3.3.1.1.1.1.1.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1"><times id="A1.Ex33.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.2"></times><ci id="A1.Ex33.m1.3.3.1.1.1.1.1.3.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.3">𝕀</ci><apply id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1"><leq id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.1"></leq><apply id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2"><times id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.1"></times><ci id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.2a.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.2"><mtext id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.2.2">rank</mtext></ci><ci id="A1.Ex33.m1.2.2.cmml" xref="A1.Ex33.m1.2.2">𝑢</ci></apply><ci id="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex33.m1.3.3.1.1.1.1.1.1.1.1.3">𝑁</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex33.m1.3c">HR=\frac{1}{|U|}\sum_{u\in U}\mathbb{I}(\text{rank}(u)\leq N).</annotation><annotation encoding="application/x-llamapun" id="A1.Ex33.m1.3d">italic_H italic_R = divide start_ARG 1 end_ARG start_ARG | italic_U | end_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT blackboard_I ( rank ( italic_u ) ≤ italic_N ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.4"><math alttext="U" class="ltx_Math" display="inline" id="A1.SS1.p2.1.m1.1"><semantics id="A1.SS1.p2.1.m1.1a"><mi id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><ci id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.1d">italic_U</annotation></semantics></math> is the set of all users. <math alttext="\text{rank}(u)" class="ltx_Math" display="inline" id="A1.SS1.p2.2.m2.1"><semantics id="A1.SS1.p2.2.m2.1a"><mrow id="A1.SS1.p2.2.m2.1.2" xref="A1.SS1.p2.2.m2.1.2.cmml"><mtext id="A1.SS1.p2.2.m2.1.2.2" xref="A1.SS1.p2.2.m2.1.2.2a.cmml">rank</mtext><mo id="A1.SS1.p2.2.m2.1.2.1" xref="A1.SS1.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.p2.2.m2.1.2.3.2" xref="A1.SS1.p2.2.m2.1.2.cmml"><mo id="A1.SS1.p2.2.m2.1.2.3.2.1" stretchy="false" xref="A1.SS1.p2.2.m2.1.2.cmml">(</mo><mi id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml">u</mi><mo id="A1.SS1.p2.2.m2.1.2.3.2.2" stretchy="false" xref="A1.SS1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><apply id="A1.SS1.p2.2.m2.1.2.cmml" xref="A1.SS1.p2.2.m2.1.2"><times id="A1.SS1.p2.2.m2.1.2.1.cmml" xref="A1.SS1.p2.2.m2.1.2.1"></times><ci id="A1.SS1.p2.2.m2.1.2.2a.cmml" xref="A1.SS1.p2.2.m2.1.2.2"><mtext id="A1.SS1.p2.2.m2.1.2.2.cmml" xref="A1.SS1.p2.2.m2.1.2.2">rank</mtext></ci><ci id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">\text{rank}(u)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.2.m2.1d">rank ( italic_u )</annotation></semantics></math> is the rank position of the correct item for user <math alttext="u" class="ltx_Math" display="inline" id="A1.SS1.p2.3.m3.1"><semantics id="A1.SS1.p2.3.m3.1a"><mi id="A1.SS1.p2.3.m3.1.1" xref="A1.SS1.p2.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m3.1b"><ci id="A1.SS1.p2.3.m3.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.3.m3.1d">italic_u</annotation></semantics></math> in the list of recommendations. <math alttext="\mathbb{I}(\cdot)" class="ltx_Math" display="inline" id="A1.SS1.p2.4.m4.1"><semantics id="A1.SS1.p2.4.m4.1a"><mrow id="A1.SS1.p2.4.m4.1.2" xref="A1.SS1.p2.4.m4.1.2.cmml"><mi id="A1.SS1.p2.4.m4.1.2.2" xref="A1.SS1.p2.4.m4.1.2.2.cmml">𝕀</mi><mo id="A1.SS1.p2.4.m4.1.2.1" xref="A1.SS1.p2.4.m4.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.p2.4.m4.1.2.3.2" xref="A1.SS1.p2.4.m4.1.2.cmml"><mo id="A1.SS1.p2.4.m4.1.2.3.2.1" stretchy="false" xref="A1.SS1.p2.4.m4.1.2.cmml">(</mo><mo id="A1.SS1.p2.4.m4.1.1" lspace="0em" rspace="0em" xref="A1.SS1.p2.4.m4.1.1.cmml">⋅</mo><mo id="A1.SS1.p2.4.m4.1.2.3.2.2" stretchy="false" xref="A1.SS1.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.4.m4.1b"><apply id="A1.SS1.p2.4.m4.1.2.cmml" xref="A1.SS1.p2.4.m4.1.2"><times id="A1.SS1.p2.4.m4.1.2.1.cmml" xref="A1.SS1.p2.4.m4.1.2.1"></times><ci id="A1.SS1.p2.4.m4.1.2.2.cmml" xref="A1.SS1.p2.4.m4.1.2.2">𝕀</ci><ci id="A1.SS1.p2.4.m4.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.4.m4.1c">\mathbb{I}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.4.m4.1d">blackboard_I ( ⋅ )</annotation></semantics></math> is the indicator function, which returns 1 if the condition is true and 0 otherwise.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Normalized Discounted Cumulative Gain (NDCG)</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">Normalized Discounted Cumulative Gain assesses the ranking quality of the recommended list by considering the position of the relevant items. It is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex34">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="NDCG=\frac{1}{|U|}\sum_{u\in U}\frac{DCG(u)}{IDCG(u)}." class="ltx_Math" display="block" id="A1.Ex34.m1.4"><semantics id="A1.Ex34.m1.4a"><mrow id="A1.Ex34.m1.4.4.1" xref="A1.Ex34.m1.4.4.1.1.cmml"><mrow id="A1.Ex34.m1.4.4.1.1" xref="A1.Ex34.m1.4.4.1.1.cmml"><mrow id="A1.Ex34.m1.4.4.1.1.2" xref="A1.Ex34.m1.4.4.1.1.2.cmml"><mi id="A1.Ex34.m1.4.4.1.1.2.2" xref="A1.Ex34.m1.4.4.1.1.2.2.cmml">N</mi><mo id="A1.Ex34.m1.4.4.1.1.2.1" xref="A1.Ex34.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="A1.Ex34.m1.4.4.1.1.2.3" xref="A1.Ex34.m1.4.4.1.1.2.3.cmml">D</mi><mo id="A1.Ex34.m1.4.4.1.1.2.1a" xref="A1.Ex34.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="A1.Ex34.m1.4.4.1.1.2.4" xref="A1.Ex34.m1.4.4.1.1.2.4.cmml">C</mi><mo id="A1.Ex34.m1.4.4.1.1.2.1b" xref="A1.Ex34.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="A1.Ex34.m1.4.4.1.1.2.5" xref="A1.Ex34.m1.4.4.1.1.2.5.cmml">G</mi></mrow><mo id="A1.Ex34.m1.4.4.1.1.1" xref="A1.Ex34.m1.4.4.1.1.1.cmml">=</mo><mrow id="A1.Ex34.m1.4.4.1.1.3" xref="A1.Ex34.m1.4.4.1.1.3.cmml"><mfrac id="A1.Ex34.m1.1.1" xref="A1.Ex34.m1.1.1.cmml"><mn id="A1.Ex34.m1.1.1.3" xref="A1.Ex34.m1.1.1.3.cmml">1</mn><mrow id="A1.Ex34.m1.1.1.1.3" xref="A1.Ex34.m1.1.1.1.2.cmml"><mo id="A1.Ex34.m1.1.1.1.3.1" stretchy="false" xref="A1.Ex34.m1.1.1.1.2.1.cmml">|</mo><mi id="A1.Ex34.m1.1.1.1.1" xref="A1.Ex34.m1.1.1.1.1.cmml">U</mi><mo id="A1.Ex34.m1.1.1.1.3.2" stretchy="false" xref="A1.Ex34.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="A1.Ex34.m1.4.4.1.1.3.1" xref="A1.Ex34.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex34.m1.4.4.1.1.3.2" xref="A1.Ex34.m1.4.4.1.1.3.2.cmml"><munder id="A1.Ex34.m1.4.4.1.1.3.2.1" xref="A1.Ex34.m1.4.4.1.1.3.2.1.cmml"><mo id="A1.Ex34.m1.4.4.1.1.3.2.1.2" movablelimits="false" xref="A1.Ex34.m1.4.4.1.1.3.2.1.2.cmml">∑</mo><mrow id="A1.Ex34.m1.4.4.1.1.3.2.1.3" xref="A1.Ex34.m1.4.4.1.1.3.2.1.3.cmml"><mi id="A1.Ex34.m1.4.4.1.1.3.2.1.3.2" xref="A1.Ex34.m1.4.4.1.1.3.2.1.3.2.cmml">u</mi><mo id="A1.Ex34.m1.4.4.1.1.3.2.1.3.1" xref="A1.Ex34.m1.4.4.1.1.3.2.1.3.1.cmml">∈</mo><mi id="A1.Ex34.m1.4.4.1.1.3.2.1.3.3" xref="A1.Ex34.m1.4.4.1.1.3.2.1.3.3.cmml">U</mi></mrow></munder><mfrac id="A1.Ex34.m1.3.3" xref="A1.Ex34.m1.3.3.cmml"><mrow id="A1.Ex34.m1.2.2.1" xref="A1.Ex34.m1.2.2.1.cmml"><mi id="A1.Ex34.m1.2.2.1.3" xref="A1.Ex34.m1.2.2.1.3.cmml">D</mi><mo id="A1.Ex34.m1.2.2.1.2" xref="A1.Ex34.m1.2.2.1.2.cmml">⁢</mo><mi id="A1.Ex34.m1.2.2.1.4" xref="A1.Ex34.m1.2.2.1.4.cmml">C</mi><mo id="A1.Ex34.m1.2.2.1.2a" xref="A1.Ex34.m1.2.2.1.2.cmml">⁢</mo><mi id="A1.Ex34.m1.2.2.1.5" xref="A1.Ex34.m1.2.2.1.5.cmml">G</mi><mo id="A1.Ex34.m1.2.2.1.2b" xref="A1.Ex34.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.Ex34.m1.2.2.1.6.2" xref="A1.Ex34.m1.2.2.1.cmml"><mo id="A1.Ex34.m1.2.2.1.6.2.1" stretchy="false" xref="A1.Ex34.m1.2.2.1.cmml">(</mo><mi id="A1.Ex34.m1.2.2.1.1" xref="A1.Ex34.m1.2.2.1.1.cmml">u</mi><mo id="A1.Ex34.m1.2.2.1.6.2.2" stretchy="false" xref="A1.Ex34.m1.2.2.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex34.m1.3.3.2" xref="A1.Ex34.m1.3.3.2.cmml"><mi id="A1.Ex34.m1.3.3.2.3" xref="A1.Ex34.m1.3.3.2.3.cmml">I</mi><mo id="A1.Ex34.m1.3.3.2.2" xref="A1.Ex34.m1.3.3.2.2.cmml">⁢</mo><mi id="A1.Ex34.m1.3.3.2.4" xref="A1.Ex34.m1.3.3.2.4.cmml">D</mi><mo id="A1.Ex34.m1.3.3.2.2a" xref="A1.Ex34.m1.3.3.2.2.cmml">⁢</mo><mi id="A1.Ex34.m1.3.3.2.5" xref="A1.Ex34.m1.3.3.2.5.cmml">C</mi><mo id="A1.Ex34.m1.3.3.2.2b" xref="A1.Ex34.m1.3.3.2.2.cmml">⁢</mo><mi id="A1.Ex34.m1.3.3.2.6" xref="A1.Ex34.m1.3.3.2.6.cmml">G</mi><mo id="A1.Ex34.m1.3.3.2.2c" xref="A1.Ex34.m1.3.3.2.2.cmml">⁢</mo><mrow id="A1.Ex34.m1.3.3.2.7.2" xref="A1.Ex34.m1.3.3.2.cmml"><mo id="A1.Ex34.m1.3.3.2.7.2.1" stretchy="false" xref="A1.Ex34.m1.3.3.2.cmml">(</mo><mi id="A1.Ex34.m1.3.3.2.1" xref="A1.Ex34.m1.3.3.2.1.cmml">u</mi><mo id="A1.Ex34.m1.3.3.2.7.2.2" stretchy="false" xref="A1.Ex34.m1.3.3.2.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="A1.Ex34.m1.4.4.1.2" lspace="0em" xref="A1.Ex34.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex34.m1.4b"><apply id="A1.Ex34.m1.4.4.1.1.cmml" xref="A1.Ex34.m1.4.4.1"><eq id="A1.Ex34.m1.4.4.1.1.1.cmml" xref="A1.Ex34.m1.4.4.1.1.1"></eq><apply id="A1.Ex34.m1.4.4.1.1.2.cmml" xref="A1.Ex34.m1.4.4.1.1.2"><times id="A1.Ex34.m1.4.4.1.1.2.1.cmml" xref="A1.Ex34.m1.4.4.1.1.2.1"></times><ci id="A1.Ex34.m1.4.4.1.1.2.2.cmml" xref="A1.Ex34.m1.4.4.1.1.2.2">𝑁</ci><ci id="A1.Ex34.m1.4.4.1.1.2.3.cmml" xref="A1.Ex34.m1.4.4.1.1.2.3">𝐷</ci><ci id="A1.Ex34.m1.4.4.1.1.2.4.cmml" xref="A1.Ex34.m1.4.4.1.1.2.4">𝐶</ci><ci id="A1.Ex34.m1.4.4.1.1.2.5.cmml" xref="A1.Ex34.m1.4.4.1.1.2.5">𝐺</ci></apply><apply id="A1.Ex34.m1.4.4.1.1.3.cmml" xref="A1.Ex34.m1.4.4.1.1.3"><times id="A1.Ex34.m1.4.4.1.1.3.1.cmml" xref="A1.Ex34.m1.4.4.1.1.3.1"></times><apply id="A1.Ex34.m1.1.1.cmml" xref="A1.Ex34.m1.1.1"><divide id="A1.Ex34.m1.1.1.2.cmml" xref="A1.Ex34.m1.1.1"></divide><cn id="A1.Ex34.m1.1.1.3.cmml" type="integer" xref="A1.Ex34.m1.1.1.3">1</cn><apply id="A1.Ex34.m1.1.1.1.2.cmml" xref="A1.Ex34.m1.1.1.1.3"><abs id="A1.Ex34.m1.1.1.1.2.1.cmml" xref="A1.Ex34.m1.1.1.1.3.1"></abs><ci id="A1.Ex34.m1.1.1.1.1.cmml" xref="A1.Ex34.m1.1.1.1.1">𝑈</ci></apply></apply><apply id="A1.Ex34.m1.4.4.1.1.3.2.cmml" xref="A1.Ex34.m1.4.4.1.1.3.2"><apply id="A1.Ex34.m1.4.4.1.1.3.2.1.cmml" xref="A1.Ex34.m1.4.4.1.1.3.2.1"><csymbol cd="ambiguous" id="A1.Ex34.m1.4.4.1.1.3.2.1.1.cmml" xref="A1.Ex34.m1.4.4.1.1.3.2.1">subscript</csymbol><sum id="A1.Ex34.m1.4.4.1.1.3.2.1.2.cmml" xref="A1.Ex34.m1.4.4.1.1.3.2.1.2"></sum><apply id="A1.Ex34.m1.4.4.1.1.3.2.1.3.cmml" xref="A1.Ex34.m1.4.4.1.1.3.2.1.3"><in id="A1.Ex34.m1.4.4.1.1.3.2.1.3.1.cmml" xref="A1.Ex34.m1.4.4.1.1.3.2.1.3.1"></in><ci id="A1.Ex34.m1.4.4.1.1.3.2.1.3.2.cmml" xref="A1.Ex34.m1.4.4.1.1.3.2.1.3.2">𝑢</ci><ci id="A1.Ex34.m1.4.4.1.1.3.2.1.3.3.cmml" xref="A1.Ex34.m1.4.4.1.1.3.2.1.3.3">𝑈</ci></apply></apply><apply id="A1.Ex34.m1.3.3.cmml" xref="A1.Ex34.m1.3.3"><divide id="A1.Ex34.m1.3.3.3.cmml" xref="A1.Ex34.m1.3.3"></divide><apply id="A1.Ex34.m1.2.2.1.cmml" xref="A1.Ex34.m1.2.2.1"><times id="A1.Ex34.m1.2.2.1.2.cmml" xref="A1.Ex34.m1.2.2.1.2"></times><ci id="A1.Ex34.m1.2.2.1.3.cmml" xref="A1.Ex34.m1.2.2.1.3">𝐷</ci><ci id="A1.Ex34.m1.2.2.1.4.cmml" xref="A1.Ex34.m1.2.2.1.4">𝐶</ci><ci id="A1.Ex34.m1.2.2.1.5.cmml" xref="A1.Ex34.m1.2.2.1.5">𝐺</ci><ci id="A1.Ex34.m1.2.2.1.1.cmml" xref="A1.Ex34.m1.2.2.1.1">𝑢</ci></apply><apply id="A1.Ex34.m1.3.3.2.cmml" xref="A1.Ex34.m1.3.3.2"><times id="A1.Ex34.m1.3.3.2.2.cmml" xref="A1.Ex34.m1.3.3.2.2"></times><ci id="A1.Ex34.m1.3.3.2.3.cmml" xref="A1.Ex34.m1.3.3.2.3">𝐼</ci><ci id="A1.Ex34.m1.3.3.2.4.cmml" xref="A1.Ex34.m1.3.3.2.4">𝐷</ci><ci id="A1.Ex34.m1.3.3.2.5.cmml" xref="A1.Ex34.m1.3.3.2.5">𝐶</ci><ci id="A1.Ex34.m1.3.3.2.6.cmml" xref="A1.Ex34.m1.3.3.2.6">𝐺</ci><ci id="A1.Ex34.m1.3.3.2.1.cmml" xref="A1.Ex34.m1.3.3.2.1">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex34.m1.4c">NDCG=\frac{1}{|U|}\sum_{u\in U}\frac{DCG(u)}{IDCG(u)}.</annotation><annotation encoding="application/x-llamapun" id="A1.Ex34.m1.4d">italic_N italic_D italic_C italic_G = divide start_ARG 1 end_ARG start_ARG | italic_U | end_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT divide start_ARG italic_D italic_C italic_G ( italic_u ) end_ARG start_ARG italic_I italic_D italic_C italic_G ( italic_u ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.2"><math alttext="DCG(u)" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><mrow id="A1.SS2.p2.1.m1.1.2" xref="A1.SS2.p2.1.m1.1.2.cmml"><mi id="A1.SS2.p2.1.m1.1.2.2" xref="A1.SS2.p2.1.m1.1.2.2.cmml">D</mi><mo id="A1.SS2.p2.1.m1.1.2.1" xref="A1.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS2.p2.1.m1.1.2.3" xref="A1.SS2.p2.1.m1.1.2.3.cmml">C</mi><mo id="A1.SS2.p2.1.m1.1.2.1a" xref="A1.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS2.p2.1.m1.1.2.4" xref="A1.SS2.p2.1.m1.1.2.4.cmml">G</mi><mo id="A1.SS2.p2.1.m1.1.2.1b" xref="A1.SS2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.p2.1.m1.1.2.5.2" xref="A1.SS2.p2.1.m1.1.2.cmml"><mo id="A1.SS2.p2.1.m1.1.2.5.2.1" stretchy="false" xref="A1.SS2.p2.1.m1.1.2.cmml">(</mo><mi id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml">u</mi><mo id="A1.SS2.p2.1.m1.1.2.5.2.2" stretchy="false" xref="A1.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.2"><times id="A1.SS2.p2.1.m1.1.2.1.cmml" xref="A1.SS2.p2.1.m1.1.2.1"></times><ci id="A1.SS2.p2.1.m1.1.2.2.cmml" xref="A1.SS2.p2.1.m1.1.2.2">𝐷</ci><ci id="A1.SS2.p2.1.m1.1.2.3.cmml" xref="A1.SS2.p2.1.m1.1.2.3">𝐶</ci><ci id="A1.SS2.p2.1.m1.1.2.4.cmml" xref="A1.SS2.p2.1.m1.1.2.4">𝐺</ci><ci id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">DCG(u)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">italic_D italic_C italic_G ( italic_u )</annotation></semantics></math> is the Discounted Cumulative Gain for user <math alttext="u" class="ltx_Math" display="inline" id="A1.SS2.p2.2.m2.1"><semantics id="A1.SS2.p2.2.m2.1a"><mi id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><ci id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.2.m2.1d">italic_u</annotation></semantics></math>, calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex35">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="DCG(u)=\sum_{i=1}^{N}\frac{2^{rel_{i}(u)}-1}{\log_{2}(i+1)}." class="ltx_Math" display="block" id="A1.Ex35.m1.5"><semantics id="A1.Ex35.m1.5a"><mrow id="A1.Ex35.m1.5.5.1" xref="A1.Ex35.m1.5.5.1.1.cmml"><mrow id="A1.Ex35.m1.5.5.1.1" xref="A1.Ex35.m1.5.5.1.1.cmml"><mrow id="A1.Ex35.m1.5.5.1.1.2" xref="A1.Ex35.m1.5.5.1.1.2.cmml"><mi id="A1.Ex35.m1.5.5.1.1.2.2" xref="A1.Ex35.m1.5.5.1.1.2.2.cmml">D</mi><mo id="A1.Ex35.m1.5.5.1.1.2.1" xref="A1.Ex35.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="A1.Ex35.m1.5.5.1.1.2.3" xref="A1.Ex35.m1.5.5.1.1.2.3.cmml">C</mi><mo id="A1.Ex35.m1.5.5.1.1.2.1a" xref="A1.Ex35.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="A1.Ex35.m1.5.5.1.1.2.4" xref="A1.Ex35.m1.5.5.1.1.2.4.cmml">G</mi><mo id="A1.Ex35.m1.5.5.1.1.2.1b" xref="A1.Ex35.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex35.m1.5.5.1.1.2.5.2" xref="A1.Ex35.m1.5.5.1.1.2.cmml"><mo id="A1.Ex35.m1.5.5.1.1.2.5.2.1" stretchy="false" xref="A1.Ex35.m1.5.5.1.1.2.cmml">(</mo><mi id="A1.Ex35.m1.4.4" xref="A1.Ex35.m1.4.4.cmml">u</mi><mo id="A1.Ex35.m1.5.5.1.1.2.5.2.2" stretchy="false" xref="A1.Ex35.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex35.m1.5.5.1.1.1" rspace="0.111em" xref="A1.Ex35.m1.5.5.1.1.1.cmml">=</mo><mrow id="A1.Ex35.m1.5.5.1.1.3" xref="A1.Ex35.m1.5.5.1.1.3.cmml"><munderover id="A1.Ex35.m1.5.5.1.1.3.1" xref="A1.Ex35.m1.5.5.1.1.3.1.cmml"><mo id="A1.Ex35.m1.5.5.1.1.3.1.2.2" movablelimits="false" xref="A1.Ex35.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.Ex35.m1.5.5.1.1.3.1.2.3" xref="A1.Ex35.m1.5.5.1.1.3.1.2.3.cmml"><mi id="A1.Ex35.m1.5.5.1.1.3.1.2.3.2" xref="A1.Ex35.m1.5.5.1.1.3.1.2.3.2.cmml">i</mi><mo id="A1.Ex35.m1.5.5.1.1.3.1.2.3.1" xref="A1.Ex35.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="A1.Ex35.m1.5.5.1.1.3.1.2.3.3" xref="A1.Ex35.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.Ex35.m1.5.5.1.1.3.1.3" xref="A1.Ex35.m1.5.5.1.1.3.1.3.cmml">N</mi></munderover><mfrac id="A1.Ex35.m1.3.3" xref="A1.Ex35.m1.3.3.cmml"><mrow id="A1.Ex35.m1.1.1.1" xref="A1.Ex35.m1.1.1.1.cmml"><msup id="A1.Ex35.m1.1.1.1.3" xref="A1.Ex35.m1.1.1.1.3.cmml"><mn id="A1.Ex35.m1.1.1.1.3.2" xref="A1.Ex35.m1.1.1.1.3.2.cmml">2</mn><mrow id="A1.Ex35.m1.1.1.1.1.1" xref="A1.Ex35.m1.1.1.1.1.1.cmml"><mi id="A1.Ex35.m1.1.1.1.1.1.3" xref="A1.Ex35.m1.1.1.1.1.1.3.cmml">r</mi><mo id="A1.Ex35.m1.1.1.1.1.1.2" xref="A1.Ex35.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex35.m1.1.1.1.1.1.4" xref="A1.Ex35.m1.1.1.1.1.1.4.cmml">e</mi><mo id="A1.Ex35.m1.1.1.1.1.1.2a" xref="A1.Ex35.m1.1.1.1.1.1.2.cmml">⁢</mo><msub id="A1.Ex35.m1.1.1.1.1.1.5" xref="A1.Ex35.m1.1.1.1.1.1.5.cmml"><mi id="A1.Ex35.m1.1.1.1.1.1.5.2" xref="A1.Ex35.m1.1.1.1.1.1.5.2.cmml">l</mi><mi id="A1.Ex35.m1.1.1.1.1.1.5.3" xref="A1.Ex35.m1.1.1.1.1.1.5.3.cmml">i</mi></msub><mo id="A1.Ex35.m1.1.1.1.1.1.2b" xref="A1.Ex35.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex35.m1.1.1.1.1.1.6.2" xref="A1.Ex35.m1.1.1.1.1.1.cmml"><mo id="A1.Ex35.m1.1.1.1.1.1.6.2.1" stretchy="false" xref="A1.Ex35.m1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex35.m1.1.1.1.1.1.1" xref="A1.Ex35.m1.1.1.1.1.1.1.cmml">u</mi><mo id="A1.Ex35.m1.1.1.1.1.1.6.2.2" stretchy="false" xref="A1.Ex35.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo id="A1.Ex35.m1.1.1.1.2" xref="A1.Ex35.m1.1.1.1.2.cmml">−</mo><mn id="A1.Ex35.m1.1.1.1.4" xref="A1.Ex35.m1.1.1.1.4.cmml">1</mn></mrow><mrow id="A1.Ex35.m1.3.3.3.2" xref="A1.Ex35.m1.3.3.3.3.cmml"><msub id="A1.Ex35.m1.2.2.2.1.1" xref="A1.Ex35.m1.2.2.2.1.1.cmml"><mi id="A1.Ex35.m1.2.2.2.1.1.2" xref="A1.Ex35.m1.2.2.2.1.1.2.cmml">log</mi><mn id="A1.Ex35.m1.2.2.2.1.1.3" xref="A1.Ex35.m1.2.2.2.1.1.3.cmml">2</mn></msub><mo id="A1.Ex35.m1.3.3.3.2a" xref="A1.Ex35.m1.3.3.3.3.cmml">⁡</mo><mrow id="A1.Ex35.m1.3.3.3.2.2" xref="A1.Ex35.m1.3.3.3.3.cmml"><mo id="A1.Ex35.m1.3.3.3.2.2.2" stretchy="false" xref="A1.Ex35.m1.3.3.3.3.cmml">(</mo><mrow id="A1.Ex35.m1.3.3.3.2.2.1" xref="A1.Ex35.m1.3.3.3.2.2.1.cmml"><mi id="A1.Ex35.m1.3.3.3.2.2.1.2" xref="A1.Ex35.m1.3.3.3.2.2.1.2.cmml">i</mi><mo id="A1.Ex35.m1.3.3.3.2.2.1.1" xref="A1.Ex35.m1.3.3.3.2.2.1.1.cmml">+</mo><mn id="A1.Ex35.m1.3.3.3.2.2.1.3" xref="A1.Ex35.m1.3.3.3.2.2.1.3.cmml">1</mn></mrow><mo id="A1.Ex35.m1.3.3.3.2.2.3" stretchy="false" xref="A1.Ex35.m1.3.3.3.3.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="A1.Ex35.m1.5.5.1.2" lspace="0em" xref="A1.Ex35.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex35.m1.5b"><apply id="A1.Ex35.m1.5.5.1.1.cmml" xref="A1.Ex35.m1.5.5.1"><eq id="A1.Ex35.m1.5.5.1.1.1.cmml" xref="A1.Ex35.m1.5.5.1.1.1"></eq><apply id="A1.Ex35.m1.5.5.1.1.2.cmml" xref="A1.Ex35.m1.5.5.1.1.2"><times id="A1.Ex35.m1.5.5.1.1.2.1.cmml" xref="A1.Ex35.m1.5.5.1.1.2.1"></times><ci id="A1.Ex35.m1.5.5.1.1.2.2.cmml" xref="A1.Ex35.m1.5.5.1.1.2.2">𝐷</ci><ci id="A1.Ex35.m1.5.5.1.1.2.3.cmml" xref="A1.Ex35.m1.5.5.1.1.2.3">𝐶</ci><ci id="A1.Ex35.m1.5.5.1.1.2.4.cmml" xref="A1.Ex35.m1.5.5.1.1.2.4">𝐺</ci><ci id="A1.Ex35.m1.4.4.cmml" xref="A1.Ex35.m1.4.4">𝑢</ci></apply><apply id="A1.Ex35.m1.5.5.1.1.3.cmml" xref="A1.Ex35.m1.5.5.1.1.3"><apply id="A1.Ex35.m1.5.5.1.1.3.1.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="A1.Ex35.m1.5.5.1.1.3.1.1.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1">superscript</csymbol><apply id="A1.Ex35.m1.5.5.1.1.3.1.2.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="A1.Ex35.m1.5.5.1.1.3.1.2.1.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1">subscript</csymbol><sum id="A1.Ex35.m1.5.5.1.1.3.1.2.2.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1.2.2"></sum><apply id="A1.Ex35.m1.5.5.1.1.3.1.2.3.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1.2.3"><eq id="A1.Ex35.m1.5.5.1.1.3.1.2.3.1.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="A1.Ex35.m1.5.5.1.1.3.1.2.3.2.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1.2.3.2">𝑖</ci><cn id="A1.Ex35.m1.5.5.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.Ex35.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="A1.Ex35.m1.5.5.1.1.3.1.3.cmml" xref="A1.Ex35.m1.5.5.1.1.3.1.3">𝑁</ci></apply><apply id="A1.Ex35.m1.3.3.cmml" xref="A1.Ex35.m1.3.3"><divide id="A1.Ex35.m1.3.3.4.cmml" xref="A1.Ex35.m1.3.3"></divide><apply id="A1.Ex35.m1.1.1.1.cmml" xref="A1.Ex35.m1.1.1.1"><minus id="A1.Ex35.m1.1.1.1.2.cmml" xref="A1.Ex35.m1.1.1.1.2"></minus><apply id="A1.Ex35.m1.1.1.1.3.cmml" xref="A1.Ex35.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex35.m1.1.1.1.3.1.cmml" xref="A1.Ex35.m1.1.1.1.3">superscript</csymbol><cn id="A1.Ex35.m1.1.1.1.3.2.cmml" type="integer" xref="A1.Ex35.m1.1.1.1.3.2">2</cn><apply id="A1.Ex35.m1.1.1.1.1.1.cmml" xref="A1.Ex35.m1.1.1.1.1.1"><times id="A1.Ex35.m1.1.1.1.1.1.2.cmml" xref="A1.Ex35.m1.1.1.1.1.1.2"></times><ci id="A1.Ex35.m1.1.1.1.1.1.3.cmml" xref="A1.Ex35.m1.1.1.1.1.1.3">𝑟</ci><ci id="A1.Ex35.m1.1.1.1.1.1.4.cmml" xref="A1.Ex35.m1.1.1.1.1.1.4">𝑒</ci><apply id="A1.Ex35.m1.1.1.1.1.1.5.cmml" xref="A1.Ex35.m1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A1.Ex35.m1.1.1.1.1.1.5.1.cmml" xref="A1.Ex35.m1.1.1.1.1.1.5">subscript</csymbol><ci id="A1.Ex35.m1.1.1.1.1.1.5.2.cmml" xref="A1.Ex35.m1.1.1.1.1.1.5.2">𝑙</ci><ci id="A1.Ex35.m1.1.1.1.1.1.5.3.cmml" xref="A1.Ex35.m1.1.1.1.1.1.5.3">𝑖</ci></apply><ci id="A1.Ex35.m1.1.1.1.1.1.1.cmml" xref="A1.Ex35.m1.1.1.1.1.1.1">𝑢</ci></apply></apply><cn id="A1.Ex35.m1.1.1.1.4.cmml" type="integer" xref="A1.Ex35.m1.1.1.1.4">1</cn></apply><apply id="A1.Ex35.m1.3.3.3.3.cmml" xref="A1.Ex35.m1.3.3.3.2"><apply id="A1.Ex35.m1.2.2.2.1.1.cmml" xref="A1.Ex35.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.Ex35.m1.2.2.2.1.1.1.cmml" xref="A1.Ex35.m1.2.2.2.1.1">subscript</csymbol><log id="A1.Ex35.m1.2.2.2.1.1.2.cmml" xref="A1.Ex35.m1.2.2.2.1.1.2"></log><cn id="A1.Ex35.m1.2.2.2.1.1.3.cmml" type="integer" xref="A1.Ex35.m1.2.2.2.1.1.3">2</cn></apply><apply id="A1.Ex35.m1.3.3.3.2.2.1.cmml" xref="A1.Ex35.m1.3.3.3.2.2.1"><plus id="A1.Ex35.m1.3.3.3.2.2.1.1.cmml" xref="A1.Ex35.m1.3.3.3.2.2.1.1"></plus><ci id="A1.Ex35.m1.3.3.3.2.2.1.2.cmml" xref="A1.Ex35.m1.3.3.3.2.2.1.2">𝑖</ci><cn id="A1.Ex35.m1.3.3.3.2.2.1.3.cmml" type="integer" xref="A1.Ex35.m1.3.3.3.2.2.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex35.m1.5c">DCG(u)=\sum_{i=1}^{N}\frac{2^{rel_{i}(u)}-1}{\log_{2}(i+1)}.</annotation><annotation encoding="application/x-llamapun" id="A1.Ex35.m1.5d">italic_D italic_C italic_G ( italic_u ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG 2 start_POSTSUPERSCRIPT italic_r italic_e italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_u ) end_POSTSUPERSCRIPT - 1 end_ARG start_ARG roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_i + 1 ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p2.7"><math alttext="IDCG(u)" class="ltx_Math" display="inline" id="A1.SS2.p2.3.m1.1"><semantics id="A1.SS2.p2.3.m1.1a"><mrow id="A1.SS2.p2.3.m1.1.2" xref="A1.SS2.p2.3.m1.1.2.cmml"><mi id="A1.SS2.p2.3.m1.1.2.2" xref="A1.SS2.p2.3.m1.1.2.2.cmml">I</mi><mo id="A1.SS2.p2.3.m1.1.2.1" xref="A1.SS2.p2.3.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS2.p2.3.m1.1.2.3" xref="A1.SS2.p2.3.m1.1.2.3.cmml">D</mi><mo id="A1.SS2.p2.3.m1.1.2.1a" xref="A1.SS2.p2.3.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS2.p2.3.m1.1.2.4" xref="A1.SS2.p2.3.m1.1.2.4.cmml">C</mi><mo id="A1.SS2.p2.3.m1.1.2.1b" xref="A1.SS2.p2.3.m1.1.2.1.cmml">⁢</mo><mi id="A1.SS2.p2.3.m1.1.2.5" xref="A1.SS2.p2.3.m1.1.2.5.cmml">G</mi><mo id="A1.SS2.p2.3.m1.1.2.1c" xref="A1.SS2.p2.3.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.p2.3.m1.1.2.6.2" xref="A1.SS2.p2.3.m1.1.2.cmml"><mo id="A1.SS2.p2.3.m1.1.2.6.2.1" stretchy="false" xref="A1.SS2.p2.3.m1.1.2.cmml">(</mo><mi id="A1.SS2.p2.3.m1.1.1" xref="A1.SS2.p2.3.m1.1.1.cmml">u</mi><mo id="A1.SS2.p2.3.m1.1.2.6.2.2" stretchy="false" xref="A1.SS2.p2.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.3.m1.1b"><apply id="A1.SS2.p2.3.m1.1.2.cmml" xref="A1.SS2.p2.3.m1.1.2"><times id="A1.SS2.p2.3.m1.1.2.1.cmml" xref="A1.SS2.p2.3.m1.1.2.1"></times><ci id="A1.SS2.p2.3.m1.1.2.2.cmml" xref="A1.SS2.p2.3.m1.1.2.2">𝐼</ci><ci id="A1.SS2.p2.3.m1.1.2.3.cmml" xref="A1.SS2.p2.3.m1.1.2.3">𝐷</ci><ci id="A1.SS2.p2.3.m1.1.2.4.cmml" xref="A1.SS2.p2.3.m1.1.2.4">𝐶</ci><ci id="A1.SS2.p2.3.m1.1.2.5.cmml" xref="A1.SS2.p2.3.m1.1.2.5">𝐺</ci><ci id="A1.SS2.p2.3.m1.1.1.cmml" xref="A1.SS2.p2.3.m1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.3.m1.1c">IDCG(u)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.3.m1.1d">italic_I italic_D italic_C italic_G ( italic_u )</annotation></semantics></math> is the Ideal Discounted Cumulative Gain for user <math alttext="u" class="ltx_Math" display="inline" id="A1.SS2.p2.4.m2.1"><semantics id="A1.SS2.p2.4.m2.1a"><mi id="A1.SS2.p2.4.m2.1.1" xref="A1.SS2.p2.4.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.4.m2.1b"><ci id="A1.SS2.p2.4.m2.1.1.cmml" xref="A1.SS2.p2.4.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.4.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.4.m2.1d">italic_u</annotation></semantics></math>, which is the maximum possible DCG that can be achieved, calculated by ordering the true relevant items in the optimal ranking.
<math alttext="rel_{i}(u)" class="ltx_Math" display="inline" id="A1.SS2.p2.5.m3.1"><semantics id="A1.SS2.p2.5.m3.1a"><mrow id="A1.SS2.p2.5.m3.1.2" xref="A1.SS2.p2.5.m3.1.2.cmml"><mi id="A1.SS2.p2.5.m3.1.2.2" xref="A1.SS2.p2.5.m3.1.2.2.cmml">r</mi><mo id="A1.SS2.p2.5.m3.1.2.1" xref="A1.SS2.p2.5.m3.1.2.1.cmml">⁢</mo><mi id="A1.SS2.p2.5.m3.1.2.3" xref="A1.SS2.p2.5.m3.1.2.3.cmml">e</mi><mo id="A1.SS2.p2.5.m3.1.2.1a" xref="A1.SS2.p2.5.m3.1.2.1.cmml">⁢</mo><msub id="A1.SS2.p2.5.m3.1.2.4" xref="A1.SS2.p2.5.m3.1.2.4.cmml"><mi id="A1.SS2.p2.5.m3.1.2.4.2" xref="A1.SS2.p2.5.m3.1.2.4.2.cmml">l</mi><mi id="A1.SS2.p2.5.m3.1.2.4.3" xref="A1.SS2.p2.5.m3.1.2.4.3.cmml">i</mi></msub><mo id="A1.SS2.p2.5.m3.1.2.1b" xref="A1.SS2.p2.5.m3.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.p2.5.m3.1.2.5.2" xref="A1.SS2.p2.5.m3.1.2.cmml"><mo id="A1.SS2.p2.5.m3.1.2.5.2.1" stretchy="false" xref="A1.SS2.p2.5.m3.1.2.cmml">(</mo><mi id="A1.SS2.p2.5.m3.1.1" xref="A1.SS2.p2.5.m3.1.1.cmml">u</mi><mo id="A1.SS2.p2.5.m3.1.2.5.2.2" stretchy="false" xref="A1.SS2.p2.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.5.m3.1b"><apply id="A1.SS2.p2.5.m3.1.2.cmml" xref="A1.SS2.p2.5.m3.1.2"><times id="A1.SS2.p2.5.m3.1.2.1.cmml" xref="A1.SS2.p2.5.m3.1.2.1"></times><ci id="A1.SS2.p2.5.m3.1.2.2.cmml" xref="A1.SS2.p2.5.m3.1.2.2">𝑟</ci><ci id="A1.SS2.p2.5.m3.1.2.3.cmml" xref="A1.SS2.p2.5.m3.1.2.3">𝑒</ci><apply id="A1.SS2.p2.5.m3.1.2.4.cmml" xref="A1.SS2.p2.5.m3.1.2.4"><csymbol cd="ambiguous" id="A1.SS2.p2.5.m3.1.2.4.1.cmml" xref="A1.SS2.p2.5.m3.1.2.4">subscript</csymbol><ci id="A1.SS2.p2.5.m3.1.2.4.2.cmml" xref="A1.SS2.p2.5.m3.1.2.4.2">𝑙</ci><ci id="A1.SS2.p2.5.m3.1.2.4.3.cmml" xref="A1.SS2.p2.5.m3.1.2.4.3">𝑖</ci></apply><ci id="A1.SS2.p2.5.m3.1.1.cmml" xref="A1.SS2.p2.5.m3.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.5.m3.1c">rel_{i}(u)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.5.m3.1d">italic_r italic_e italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_u )</annotation></semantics></math> is the relevance score of the item at position <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.p2.6.m4.1"><semantics id="A1.SS2.p2.6.m4.1a"><mi id="A1.SS2.p2.6.m4.1.1" xref="A1.SS2.p2.6.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.6.m4.1b"><ci id="A1.SS2.p2.6.m4.1.1.cmml" xref="A1.SS2.p2.6.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.6.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.6.m4.1d">italic_i</annotation></semantics></math> for user <math alttext="u" class="ltx_Math" display="inline" id="A1.SS2.p2.7.m5.1"><semantics id="A1.SS2.p2.7.m5.1a"><mi id="A1.SS2.p2.7.m5.1.1" xref="A1.SS2.p2.7.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.7.m5.1b"><ci id="A1.SS2.p2.7.m5.1.1.cmml" xref="A1.SS2.p2.7.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.7.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.7.m5.1d">italic_u</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Mean Reciprocal Rank (MRR)</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">Mean Reciprocal Rank evaluates the average of the reciprocal ranks of the first relevant item in the recommended list. It is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex36">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="MRR=\frac{1}{|U|}\sum_{u\in U}\frac{1}{\text{rank}(u)}." class="ltx_Math" display="block" id="A1.Ex36.m1.3"><semantics id="A1.Ex36.m1.3a"><mrow id="A1.Ex36.m1.3.3.1" xref="A1.Ex36.m1.3.3.1.1.cmml"><mrow id="A1.Ex36.m1.3.3.1.1" xref="A1.Ex36.m1.3.3.1.1.cmml"><mrow id="A1.Ex36.m1.3.3.1.1.2" xref="A1.Ex36.m1.3.3.1.1.2.cmml"><mi id="A1.Ex36.m1.3.3.1.1.2.2" xref="A1.Ex36.m1.3.3.1.1.2.2.cmml">M</mi><mo id="A1.Ex36.m1.3.3.1.1.2.1" xref="A1.Ex36.m1.3.3.1.1.2.1.cmml">⁢</mo><mi id="A1.Ex36.m1.3.3.1.1.2.3" xref="A1.Ex36.m1.3.3.1.1.2.3.cmml">R</mi><mo id="A1.Ex36.m1.3.3.1.1.2.1a" xref="A1.Ex36.m1.3.3.1.1.2.1.cmml">⁢</mo><mi id="A1.Ex36.m1.3.3.1.1.2.4" xref="A1.Ex36.m1.3.3.1.1.2.4.cmml">R</mi></mrow><mo id="A1.Ex36.m1.3.3.1.1.1" xref="A1.Ex36.m1.3.3.1.1.1.cmml">=</mo><mrow id="A1.Ex36.m1.3.3.1.1.3" xref="A1.Ex36.m1.3.3.1.1.3.cmml"><mfrac id="A1.Ex36.m1.1.1" xref="A1.Ex36.m1.1.1.cmml"><mn id="A1.Ex36.m1.1.1.3" xref="A1.Ex36.m1.1.1.3.cmml">1</mn><mrow id="A1.Ex36.m1.1.1.1.3" xref="A1.Ex36.m1.1.1.1.2.cmml"><mo id="A1.Ex36.m1.1.1.1.3.1" stretchy="false" xref="A1.Ex36.m1.1.1.1.2.1.cmml">|</mo><mi id="A1.Ex36.m1.1.1.1.1" xref="A1.Ex36.m1.1.1.1.1.cmml">U</mi><mo id="A1.Ex36.m1.1.1.1.3.2" stretchy="false" xref="A1.Ex36.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="A1.Ex36.m1.3.3.1.1.3.1" xref="A1.Ex36.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex36.m1.3.3.1.1.3.2" xref="A1.Ex36.m1.3.3.1.1.3.2.cmml"><munder id="A1.Ex36.m1.3.3.1.1.3.2.1" xref="A1.Ex36.m1.3.3.1.1.3.2.1.cmml"><mo id="A1.Ex36.m1.3.3.1.1.3.2.1.2" movablelimits="false" xref="A1.Ex36.m1.3.3.1.1.3.2.1.2.cmml">∑</mo><mrow id="A1.Ex36.m1.3.3.1.1.3.2.1.3" xref="A1.Ex36.m1.3.3.1.1.3.2.1.3.cmml"><mi id="A1.Ex36.m1.3.3.1.1.3.2.1.3.2" xref="A1.Ex36.m1.3.3.1.1.3.2.1.3.2.cmml">u</mi><mo id="A1.Ex36.m1.3.3.1.1.3.2.1.3.1" xref="A1.Ex36.m1.3.3.1.1.3.2.1.3.1.cmml">∈</mo><mi id="A1.Ex36.m1.3.3.1.1.3.2.1.3.3" xref="A1.Ex36.m1.3.3.1.1.3.2.1.3.3.cmml">U</mi></mrow></munder><mfrac id="A1.Ex36.m1.2.2" xref="A1.Ex36.m1.2.2.cmml"><mn id="A1.Ex36.m1.2.2.3" xref="A1.Ex36.m1.2.2.3.cmml">1</mn><mrow id="A1.Ex36.m1.2.2.1" xref="A1.Ex36.m1.2.2.1.cmml"><mtext id="A1.Ex36.m1.2.2.1.3" xref="A1.Ex36.m1.2.2.1.3a.cmml">rank</mtext><mo id="A1.Ex36.m1.2.2.1.2" xref="A1.Ex36.m1.2.2.1.2.cmml">⁢</mo><mrow id="A1.Ex36.m1.2.2.1.4.2" xref="A1.Ex36.m1.2.2.1.cmml"><mo id="A1.Ex36.m1.2.2.1.4.2.1" stretchy="false" xref="A1.Ex36.m1.2.2.1.cmml">(</mo><mi id="A1.Ex36.m1.2.2.1.1" xref="A1.Ex36.m1.2.2.1.1.cmml">u</mi><mo id="A1.Ex36.m1.2.2.1.4.2.2" stretchy="false" xref="A1.Ex36.m1.2.2.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="A1.Ex36.m1.3.3.1.2" lspace="0em" xref="A1.Ex36.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex36.m1.3b"><apply id="A1.Ex36.m1.3.3.1.1.cmml" xref="A1.Ex36.m1.3.3.1"><eq id="A1.Ex36.m1.3.3.1.1.1.cmml" xref="A1.Ex36.m1.3.3.1.1.1"></eq><apply id="A1.Ex36.m1.3.3.1.1.2.cmml" xref="A1.Ex36.m1.3.3.1.1.2"><times id="A1.Ex36.m1.3.3.1.1.2.1.cmml" xref="A1.Ex36.m1.3.3.1.1.2.1"></times><ci id="A1.Ex36.m1.3.3.1.1.2.2.cmml" xref="A1.Ex36.m1.3.3.1.1.2.2">𝑀</ci><ci id="A1.Ex36.m1.3.3.1.1.2.3.cmml" xref="A1.Ex36.m1.3.3.1.1.2.3">𝑅</ci><ci id="A1.Ex36.m1.3.3.1.1.2.4.cmml" xref="A1.Ex36.m1.3.3.1.1.2.4">𝑅</ci></apply><apply id="A1.Ex36.m1.3.3.1.1.3.cmml" xref="A1.Ex36.m1.3.3.1.1.3"><times id="A1.Ex36.m1.3.3.1.1.3.1.cmml" xref="A1.Ex36.m1.3.3.1.1.3.1"></times><apply id="A1.Ex36.m1.1.1.cmml" xref="A1.Ex36.m1.1.1"><divide id="A1.Ex36.m1.1.1.2.cmml" xref="A1.Ex36.m1.1.1"></divide><cn id="A1.Ex36.m1.1.1.3.cmml" type="integer" xref="A1.Ex36.m1.1.1.3">1</cn><apply id="A1.Ex36.m1.1.1.1.2.cmml" xref="A1.Ex36.m1.1.1.1.3"><abs id="A1.Ex36.m1.1.1.1.2.1.cmml" xref="A1.Ex36.m1.1.1.1.3.1"></abs><ci id="A1.Ex36.m1.1.1.1.1.cmml" xref="A1.Ex36.m1.1.1.1.1">𝑈</ci></apply></apply><apply id="A1.Ex36.m1.3.3.1.1.3.2.cmml" xref="A1.Ex36.m1.3.3.1.1.3.2"><apply id="A1.Ex36.m1.3.3.1.1.3.2.1.cmml" xref="A1.Ex36.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="A1.Ex36.m1.3.3.1.1.3.2.1.1.cmml" xref="A1.Ex36.m1.3.3.1.1.3.2.1">subscript</csymbol><sum id="A1.Ex36.m1.3.3.1.1.3.2.1.2.cmml" xref="A1.Ex36.m1.3.3.1.1.3.2.1.2"></sum><apply id="A1.Ex36.m1.3.3.1.1.3.2.1.3.cmml" xref="A1.Ex36.m1.3.3.1.1.3.2.1.3"><in id="A1.Ex36.m1.3.3.1.1.3.2.1.3.1.cmml" xref="A1.Ex36.m1.3.3.1.1.3.2.1.3.1"></in><ci id="A1.Ex36.m1.3.3.1.1.3.2.1.3.2.cmml" xref="A1.Ex36.m1.3.3.1.1.3.2.1.3.2">𝑢</ci><ci id="A1.Ex36.m1.3.3.1.1.3.2.1.3.3.cmml" xref="A1.Ex36.m1.3.3.1.1.3.2.1.3.3">𝑈</ci></apply></apply><apply id="A1.Ex36.m1.2.2.cmml" xref="A1.Ex36.m1.2.2"><divide id="A1.Ex36.m1.2.2.2.cmml" xref="A1.Ex36.m1.2.2"></divide><cn id="A1.Ex36.m1.2.2.3.cmml" type="integer" xref="A1.Ex36.m1.2.2.3">1</cn><apply id="A1.Ex36.m1.2.2.1.cmml" xref="A1.Ex36.m1.2.2.1"><times id="A1.Ex36.m1.2.2.1.2.cmml" xref="A1.Ex36.m1.2.2.1.2"></times><ci id="A1.Ex36.m1.2.2.1.3a.cmml" xref="A1.Ex36.m1.2.2.1.3"><mtext id="A1.Ex36.m1.2.2.1.3.cmml" xref="A1.Ex36.m1.2.2.1.3">rank</mtext></ci><ci id="A1.Ex36.m1.2.2.1.1.cmml" xref="A1.Ex36.m1.2.2.1.1">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex36.m1.3c">MRR=\frac{1}{|U|}\sum_{u\in U}\frac{1}{\text{rank}(u)}.</annotation><annotation encoding="application/x-llamapun" id="A1.Ex36.m1.3d">italic_M italic_R italic_R = divide start_ARG 1 end_ARG start_ARG | italic_U | end_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG rank ( italic_u ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.2"><math alttext="\text{rank}(u)" class="ltx_Math" display="inline" id="A1.SS3.p2.1.m1.1"><semantics id="A1.SS3.p2.1.m1.1a"><mrow id="A1.SS3.p2.1.m1.1.2" xref="A1.SS3.p2.1.m1.1.2.cmml"><mtext id="A1.SS3.p2.1.m1.1.2.2" xref="A1.SS3.p2.1.m1.1.2.2a.cmml">rank</mtext><mo id="A1.SS3.p2.1.m1.1.2.1" xref="A1.SS3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS3.p2.1.m1.1.2.3.2" xref="A1.SS3.p2.1.m1.1.2.cmml"><mo id="A1.SS3.p2.1.m1.1.2.3.2.1" stretchy="false" xref="A1.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="A1.SS3.p2.1.m1.1.1" xref="A1.SS3.p2.1.m1.1.1.cmml">u</mi><mo id="A1.SS3.p2.1.m1.1.2.3.2.2" stretchy="false" xref="A1.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.1.m1.1b"><apply id="A1.SS3.p2.1.m1.1.2.cmml" xref="A1.SS3.p2.1.m1.1.2"><times id="A1.SS3.p2.1.m1.1.2.1.cmml" xref="A1.SS3.p2.1.m1.1.2.1"></times><ci id="A1.SS3.p2.1.m1.1.2.2a.cmml" xref="A1.SS3.p2.1.m1.1.2.2"><mtext id="A1.SS3.p2.1.m1.1.2.2.cmml" xref="A1.SS3.p2.1.m1.1.2.2">rank</mtext></ci><ci id="A1.SS3.p2.1.m1.1.1.cmml" xref="A1.SS3.p2.1.m1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.1.m1.1c">\text{rank}(u)</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.1.m1.1d">rank ( italic_u )</annotation></semantics></math> is the rank position of the first relevant item for user <math alttext="u" class="ltx_Math" display="inline" id="A1.SS3.p2.2.m2.1"><semantics id="A1.SS3.p2.2.m2.1a"><mi id="A1.SS3.p2.2.m2.1.1" xref="A1.SS3.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p2.2.m2.1b"><ci id="A1.SS3.p2.2.m2.1.1.cmml" xref="A1.SS3.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p2.2.m2.1d">italic_u</annotation></semantics></math> in the list of recommendations.</p>
</div>
</section>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Jun 10 17:12:28 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
