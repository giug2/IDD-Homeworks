<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting</title>
<!--Generated on Fri Aug 23 12:32:17 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2408.13028v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S1" title="In In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S2" title="In In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S3" title="In In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Task Definition</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4" title="In In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4.SS1" title="In 4 Methodology ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Utterance Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4.SS2" title="In 4 Methodology ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Scoring Policy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4.SS3" title="In 4 Methodology ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Policy Iterating</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5" title="In In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS1" title="In 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Datasets and LLM</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS2" title="In 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS3" title="In 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Baselines</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS3.SSS0.Px1" title="In 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title">Random</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS3.SSS0.Px2" title="In 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title">BM25</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS3.SSS0.Px3" title="In 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title">KATE</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS3.SSS0.Px4" title="In 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title">EPR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS3.SSS0.Px5" title="In 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title">BSR</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS4" title="In 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Experimental Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.SS5" title="In 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S6" title="In In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S6.SS1" title="In 6 Analysis ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Different Sizes of Candidates and Training Samples</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S6.SS2" title="In 6 Analysis ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Different Number of Examples in Demonstration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S6.SS3" title="In 6 Analysis ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Comparing with SFT Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S6.SS4" title="In 6 Analysis ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>What Examples are Appropriate for IUR</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S6.SS5" title="In 6 Analysis ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Efficiency of Larger LLM</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S6.SS6" title="In 6 Analysis ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.6 </span>Order of Examples</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S7" title="In In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#A1" title="In In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Example Appendix</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Haowei Du, Dongyan Zhao
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">In-context learning (ICL) of large language models (LLMs) has attracted increasing attention in the community where LLMs
make predictions only based on instructions augmented
with a few examples.
Existing example selection methods for ICL utilize sparse or dense retrievers and derive effective performance. However, these methods do not utilize direct feedback of LLM to train the retriever and the examples selected can not necessarily improve the analogy ability of LLM. To tackle this, we propose our policy-based reinforcement learning framework for example selection (RLS), which consists of a language model (LM) selector and an LLM generator. The LM selector encodes the candidate examples into dense representations and selects the top-k examples into the demonstration for LLM. The outputs of LLM are adopted to compute the reward and policy gradient to optimize the LM selector. We conduct experiments on different datasets and significantly outperform existing example selection methods. Moreover, our approach shows advantages over supervised finetuning (SFT) models in few shot setting. Further experiments show the balance of abundance and the similarity with the test case of examples is important for ICL performance of LLM.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_table" id="S1.T2">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S1.T2.8">
<tr class="ltx_tr" id="S1.T2.8.9">
<td class="ltx_td ltx_border_r ltx_border_t" id="S1.T2.8.9.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.8.9.2"><span class="ltx_text ltx_font_bold" id="S1.T2.8.9.2.1">Utterance</span></td>
</tr>
<tr class="ltx_tr" id="S1.T2.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.1.1.1" rowspan="2"><span class="ltx_text" id="S1.T2.1.1.1.1"><math alttext="u_{1}" class="ltx_Math" display="inline" id="S1.T2.1.1.1.1.m1.1"><semantics id="S1.T2.1.1.1.1.m1.1a"><msub id="S1.T2.1.1.1.1.m1.1.1" xref="S1.T2.1.1.1.1.m1.1.1.cmml"><mi id="S1.T2.1.1.1.1.m1.1.1.2" xref="S1.T2.1.1.1.1.m1.1.1.2.cmml">u</mi><mn id="S1.T2.1.1.1.1.m1.1.1.3" xref="S1.T2.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.1.1.1.1.m1.1b"><apply id="S1.T2.1.1.1.1.m1.1.1.cmml" xref="S1.T2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.1.1.1.1.m1.1.1.1.cmml" xref="S1.T2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.T2.1.1.1.1.m1.1.1.2.cmml" xref="S1.T2.1.1.1.1.m1.1.1.2">𝑢</ci><cn id="S1.T2.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S1.T2.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.1.1.1.1.m1.1c">u_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.1.1.1.1.m1.1d">italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.1.1.2">Hello, I am looking for an expensive</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.10">
<td class="ltx_td ltx_align_center" id="S1.T2.8.10.1">restaurant that serves fusion food.</td>
</tr>
<tr class="ltx_tr" id="S1.T2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.2.2.1" rowspan="2"><span class="ltx_text" id="S1.T2.2.2.1.1"><math alttext="u_{2}" class="ltx_Math" display="inline" id="S1.T2.2.2.1.1.m1.1"><semantics id="S1.T2.2.2.1.1.m1.1a"><msub id="S1.T2.2.2.1.1.m1.1.1" xref="S1.T2.2.2.1.1.m1.1.1.cmml"><mi id="S1.T2.2.2.1.1.m1.1.1.2" xref="S1.T2.2.2.1.1.m1.1.1.2.cmml">u</mi><mn id="S1.T2.2.2.1.1.m1.1.1.3" xref="S1.T2.2.2.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.2.2.1.1.m1.1b"><apply id="S1.T2.2.2.1.1.m1.1.1.cmml" xref="S1.T2.2.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.2.2.1.1.m1.1.1.1.cmml" xref="S1.T2.2.2.1.1.m1.1.1">subscript</csymbol><ci id="S1.T2.2.2.1.1.m1.1.1.2.cmml" xref="S1.T2.2.2.1.1.m1.1.1.2">𝑢</ci><cn id="S1.T2.2.2.1.1.m1.1.1.3.cmml" type="integer" xref="S1.T2.2.2.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.2.2.1.1.m1.1c">u_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.2.2.1.1.m1.1d">italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.2.2.2">I ’m sorry, there are no fusion restaurants</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.11">
<td class="ltx_td ltx_align_center" id="S1.T2.8.11.1">listed in the expensive price range. Would</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.12">
<td class="ltx_td ltx_border_r" id="S1.T2.8.12.1"></td>
<td class="ltx_td ltx_align_center" id="S1.T2.8.12.2">you like to try something else?</td>
</tr>
<tr class="ltx_tr" id="S1.T2.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.3.3.1"><math alttext="u_{3}" class="ltx_Math" display="inline" id="S1.T2.3.3.1.m1.1"><semantics id="S1.T2.3.3.1.m1.1a"><msub id="S1.T2.3.3.1.m1.1.1" xref="S1.T2.3.3.1.m1.1.1.cmml"><mi id="S1.T2.3.3.1.m1.1.1.2" xref="S1.T2.3.3.1.m1.1.1.2.cmml">u</mi><mn id="S1.T2.3.3.1.m1.1.1.3" xref="S1.T2.3.3.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.3.3.1.m1.1b"><apply id="S1.T2.3.3.1.m1.1.1.cmml" xref="S1.T2.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.3.3.1.m1.1.1.1.cmml" xref="S1.T2.3.3.1.m1.1.1">subscript</csymbol><ci id="S1.T2.3.3.1.m1.1.1.2.cmml" xref="S1.T2.3.3.1.m1.1.1.2">𝑢</ci><cn id="S1.T2.3.3.1.m1.1.1.3.cmml" type="integer" xref="S1.T2.3.3.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.3.3.1.m1.1c">u_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.3.3.1.m1.1d">italic_u start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.3.3.2">How about Mediterranean food?</td>
</tr>
<tr class="ltx_tr" id="S1.T2.4.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.4.4.1" rowspan="2"><span class="ltx_text" id="S1.T2.4.4.1.1"><math alttext="u_{3}^{*}" class="ltx_Math" display="inline" id="S1.T2.4.4.1.1.m1.1"><semantics id="S1.T2.4.4.1.1.m1.1a"><msubsup id="S1.T2.4.4.1.1.m1.1.1" xref="S1.T2.4.4.1.1.m1.1.1.cmml"><mi id="S1.T2.4.4.1.1.m1.1.1.2.2" xref="S1.T2.4.4.1.1.m1.1.1.2.2.cmml">u</mi><mn id="S1.T2.4.4.1.1.m1.1.1.2.3" xref="S1.T2.4.4.1.1.m1.1.1.2.3.cmml">3</mn><mo id="S1.T2.4.4.1.1.m1.1.1.3" xref="S1.T2.4.4.1.1.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S1.T2.4.4.1.1.m1.1b"><apply id="S1.T2.4.4.1.1.m1.1.1.cmml" xref="S1.T2.4.4.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.4.4.1.1.m1.1.1.1.cmml" xref="S1.T2.4.4.1.1.m1.1.1">superscript</csymbol><apply id="S1.T2.4.4.1.1.m1.1.1.2.cmml" xref="S1.T2.4.4.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.4.4.1.1.m1.1.1.2.1.cmml" xref="S1.T2.4.4.1.1.m1.1.1">subscript</csymbol><ci id="S1.T2.4.4.1.1.m1.1.1.2.2.cmml" xref="S1.T2.4.4.1.1.m1.1.1.2.2">𝑢</ci><cn id="S1.T2.4.4.1.1.m1.1.1.2.3.cmml" type="integer" xref="S1.T2.4.4.1.1.m1.1.1.2.3">3</cn></apply><times id="S1.T2.4.4.1.1.m1.1.1.3.cmml" xref="S1.T2.4.4.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.4.4.1.1.m1.1c">u_{3}^{*}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.4.4.1.1.m1.1d">italic_u start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.4.4.2">How about Mediterranean food</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.13">
<td class="ltx_td ltx_align_center" id="S1.T2.8.13.1">in expensive price range?</td>
</tr>
<tr class="ltx_tr" id="S1.T2.5.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.5.5.1"><math alttext="e_{1}" class="ltx_Math" display="inline" id="S1.T2.5.5.1.m1.1"><semantics id="S1.T2.5.5.1.m1.1a"><msub id="S1.T2.5.5.1.m1.1.1" xref="S1.T2.5.5.1.m1.1.1.cmml"><mi id="S1.T2.5.5.1.m1.1.1.2" xref="S1.T2.5.5.1.m1.1.1.2.cmml">e</mi><mn id="S1.T2.5.5.1.m1.1.1.3" xref="S1.T2.5.5.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.5.5.1.m1.1b"><apply id="S1.T2.5.5.1.m1.1.1.cmml" xref="S1.T2.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.5.5.1.m1.1.1.1.cmml" xref="S1.T2.5.5.1.m1.1.1">subscript</csymbol><ci id="S1.T2.5.5.1.m1.1.1.2.cmml" xref="S1.T2.5.5.1.m1.1.1.2">𝑒</ci><cn id="S1.T2.5.5.1.m1.1.1.3.cmml" type="integer" xref="S1.T2.5.5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.5.5.1.m1.1c">e_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.5.5.1.m1.1d">italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.5.5.2">How about serving Mediterranean food?</td>
</tr>
<tr class="ltx_tr" id="S1.T2.6.6">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.6.6.1" rowspan="2"><span class="ltx_text" id="S1.T2.6.6.1.1"><math alttext="e_{1}^{*}" class="ltx_Math" display="inline" id="S1.T2.6.6.1.1.m1.1"><semantics id="S1.T2.6.6.1.1.m1.1a"><msubsup id="S1.T2.6.6.1.1.m1.1.1" xref="S1.T2.6.6.1.1.m1.1.1.cmml"><mi id="S1.T2.6.6.1.1.m1.1.1.2.2" xref="S1.T2.6.6.1.1.m1.1.1.2.2.cmml">e</mi><mn id="S1.T2.6.6.1.1.m1.1.1.2.3" xref="S1.T2.6.6.1.1.m1.1.1.2.3.cmml">1</mn><mo id="S1.T2.6.6.1.1.m1.1.1.3" xref="S1.T2.6.6.1.1.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S1.T2.6.6.1.1.m1.1b"><apply id="S1.T2.6.6.1.1.m1.1.1.cmml" xref="S1.T2.6.6.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.6.6.1.1.m1.1.1.1.cmml" xref="S1.T2.6.6.1.1.m1.1.1">superscript</csymbol><apply id="S1.T2.6.6.1.1.m1.1.1.2.cmml" xref="S1.T2.6.6.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.6.6.1.1.m1.1.1.2.1.cmml" xref="S1.T2.6.6.1.1.m1.1.1">subscript</csymbol><ci id="S1.T2.6.6.1.1.m1.1.1.2.2.cmml" xref="S1.T2.6.6.1.1.m1.1.1.2.2">𝑒</ci><cn id="S1.T2.6.6.1.1.m1.1.1.2.3.cmml" type="integer" xref="S1.T2.6.6.1.1.m1.1.1.2.3">1</cn></apply><times id="S1.T2.6.6.1.1.m1.1.1.3.cmml" xref="S1.T2.6.6.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.6.6.1.1.m1.1c">e_{1}^{*}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.6.6.1.1.m1.1d">italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.6.6.2">How about a cheap restaurant</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.14">
<td class="ltx_td ltx_align_center" id="S1.T2.8.14.1">serving Mediterranean food?</td>
</tr>
<tr class="ltx_tr" id="S1.T2.7.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.7.7.1" rowspan="2"><span class="ltx_text" id="S1.T2.7.7.1.1"><math alttext="e_{2}" class="ltx_Math" display="inline" id="S1.T2.7.7.1.1.m1.1"><semantics id="S1.T2.7.7.1.1.m1.1a"><msub id="S1.T2.7.7.1.1.m1.1.1" xref="S1.T2.7.7.1.1.m1.1.1.cmml"><mi id="S1.T2.7.7.1.1.m1.1.1.2" xref="S1.T2.7.7.1.1.m1.1.1.2.cmml">e</mi><mn id="S1.T2.7.7.1.1.m1.1.1.3" xref="S1.T2.7.7.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.7.7.1.1.m1.1b"><apply id="S1.T2.7.7.1.1.m1.1.1.cmml" xref="S1.T2.7.7.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.7.7.1.1.m1.1.1.1.cmml" xref="S1.T2.7.7.1.1.m1.1.1">subscript</csymbol><ci id="S1.T2.7.7.1.1.m1.1.1.2.cmml" xref="S1.T2.7.7.1.1.m1.1.1.2">𝑒</ci><cn id="S1.T2.7.7.1.1.m1.1.1.3.cmml" type="integer" xref="S1.T2.7.7.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.7.7.1.1.m1.1c">e_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.7.7.1.1.m1.1d">italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.7.7.2">Can you recommend a restaurant to me?</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.15">
<td class="ltx_td ltx_align_center" id="S1.T2.8.15.1">I don’t want to spend a lot of money.</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S1.T2.8.8.1" rowspan="3"><span class="ltx_text" id="S1.T2.8.8.1.1"><math alttext="e_{2}^{*}" class="ltx_Math" display="inline" id="S1.T2.8.8.1.1.m1.1"><semantics id="S1.T2.8.8.1.1.m1.1a"><msubsup id="S1.T2.8.8.1.1.m1.1.1" xref="S1.T2.8.8.1.1.m1.1.1.cmml"><mi id="S1.T2.8.8.1.1.m1.1.1.2.2" xref="S1.T2.8.8.1.1.m1.1.1.2.2.cmml">e</mi><mn id="S1.T2.8.8.1.1.m1.1.1.2.3" xref="S1.T2.8.8.1.1.m1.1.1.2.3.cmml">2</mn><mo id="S1.T2.8.8.1.1.m1.1.1.3" xref="S1.T2.8.8.1.1.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S1.T2.8.8.1.1.m1.1b"><apply id="S1.T2.8.8.1.1.m1.1.1.cmml" xref="S1.T2.8.8.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.8.8.1.1.m1.1.1.1.cmml" xref="S1.T2.8.8.1.1.m1.1.1">superscript</csymbol><apply id="S1.T2.8.8.1.1.m1.1.1.2.cmml" xref="S1.T2.8.8.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.8.8.1.1.m1.1.1.2.1.cmml" xref="S1.T2.8.8.1.1.m1.1.1">subscript</csymbol><ci id="S1.T2.8.8.1.1.m1.1.1.2.2.cmml" xref="S1.T2.8.8.1.1.m1.1.1.2.2">𝑒</ci><cn id="S1.T2.8.8.1.1.m1.1.1.2.3.cmml" type="integer" xref="S1.T2.8.8.1.1.m1.1.1.2.3">2</cn></apply><times id="S1.T2.8.8.1.1.m1.1.1.3.cmml" xref="S1.T2.8.8.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.8.8.1.1.m1.1c">e_{2}^{*}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.8.8.1.1.m1.1d">italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.8.8.2">Can you recommend a restaurant to me</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.16">
<td class="ltx_td ltx_align_center" id="S1.T2.8.16.1">in the south part of town? I don’t</td>
</tr>
<tr class="ltx_tr" id="S1.T2.8.17">
<td class="ltx_td ltx_align_center ltx_border_b" id="S1.T2.8.17.1">want to spend a lot of money.</td>
</tr>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>One example from CANARD dataset. <math alttext="u_{1}" class="ltx_Math" display="inline" id="S1.T2.15.m1.1"><semantics id="S1.T2.15.m1.1b"><msub id="S1.T2.15.m1.1.1" xref="S1.T2.15.m1.1.1.cmml"><mi id="S1.T2.15.m1.1.1.2" xref="S1.T2.15.m1.1.1.2.cmml">u</mi><mn id="S1.T2.15.m1.1.1.3" xref="S1.T2.15.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.15.m1.1c"><apply id="S1.T2.15.m1.1.1.cmml" xref="S1.T2.15.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.15.m1.1.1.1.cmml" xref="S1.T2.15.m1.1.1">subscript</csymbol><ci id="S1.T2.15.m1.1.1.2.cmml" xref="S1.T2.15.m1.1.1.2">𝑢</ci><cn id="S1.T2.15.m1.1.1.3.cmml" type="integer" xref="S1.T2.15.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.15.m1.1d">u_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.15.m1.1e">italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-<math alttext="u_{2}" class="ltx_Math" display="inline" id="S1.T2.16.m2.1"><semantics id="S1.T2.16.m2.1b"><msub id="S1.T2.16.m2.1.1" xref="S1.T2.16.m2.1.1.cmml"><mi id="S1.T2.16.m2.1.1.2" xref="S1.T2.16.m2.1.1.2.cmml">u</mi><mn id="S1.T2.16.m2.1.1.3" xref="S1.T2.16.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.16.m2.1c"><apply id="S1.T2.16.m2.1.1.cmml" xref="S1.T2.16.m2.1.1"><csymbol cd="ambiguous" id="S1.T2.16.m2.1.1.1.cmml" xref="S1.T2.16.m2.1.1">subscript</csymbol><ci id="S1.T2.16.m2.1.1.2.cmml" xref="S1.T2.16.m2.1.1.2">𝑢</ci><cn id="S1.T2.16.m2.1.1.3.cmml" type="integer" xref="S1.T2.16.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.16.m2.1d">u_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.16.m2.1e">italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are 2 turns of contextual utterances, <math alttext="u_{3}" class="ltx_Math" display="inline" id="S1.T2.17.m3.1"><semantics id="S1.T2.17.m3.1b"><msub id="S1.T2.17.m3.1.1" xref="S1.T2.17.m3.1.1.cmml"><mi id="S1.T2.17.m3.1.1.2" xref="S1.T2.17.m3.1.1.2.cmml">u</mi><mn id="S1.T2.17.m3.1.1.3" xref="S1.T2.17.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.17.m3.1c"><apply id="S1.T2.17.m3.1.1.cmml" xref="S1.T2.17.m3.1.1"><csymbol cd="ambiguous" id="S1.T2.17.m3.1.1.1.cmml" xref="S1.T2.17.m3.1.1">subscript</csymbol><ci id="S1.T2.17.m3.1.1.2.cmml" xref="S1.T2.17.m3.1.1.2">𝑢</ci><cn id="S1.T2.17.m3.1.1.3.cmml" type="integer" xref="S1.T2.17.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.17.m3.1d">u_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.17.m3.1e">italic_u start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> denotes the incomplete utterance, <math alttext="u_{3}^{*}" class="ltx_Math" display="inline" id="S1.T2.18.m4.1"><semantics id="S1.T2.18.m4.1b"><msubsup id="S1.T2.18.m4.1.1" xref="S1.T2.18.m4.1.1.cmml"><mi id="S1.T2.18.m4.1.1.2.2" xref="S1.T2.18.m4.1.1.2.2.cmml">u</mi><mn id="S1.T2.18.m4.1.1.2.3" xref="S1.T2.18.m4.1.1.2.3.cmml">3</mn><mo id="S1.T2.18.m4.1.1.3" xref="S1.T2.18.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S1.T2.18.m4.1c"><apply id="S1.T2.18.m4.1.1.cmml" xref="S1.T2.18.m4.1.1"><csymbol cd="ambiguous" id="S1.T2.18.m4.1.1.1.cmml" xref="S1.T2.18.m4.1.1">superscript</csymbol><apply id="S1.T2.18.m4.1.1.2.cmml" xref="S1.T2.18.m4.1.1"><csymbol cd="ambiguous" id="S1.T2.18.m4.1.1.2.1.cmml" xref="S1.T2.18.m4.1.1">subscript</csymbol><ci id="S1.T2.18.m4.1.1.2.2.cmml" xref="S1.T2.18.m4.1.1.2.2">𝑢</ci><cn id="S1.T2.18.m4.1.1.2.3.cmml" type="integer" xref="S1.T2.18.m4.1.1.2.3">3</cn></apply><times id="S1.T2.18.m4.1.1.3.cmml" xref="S1.T2.18.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.18.m4.1d">u_{3}^{*}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.18.m4.1e">italic_u start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> denote the golden rewritten utterance, <math alttext="e_{1}/e_{1}^{*}" class="ltx_Math" display="inline" id="S1.T2.19.m5.1"><semantics id="S1.T2.19.m5.1b"><mrow id="S1.T2.19.m5.1.1" xref="S1.T2.19.m5.1.1.cmml"><msub id="S1.T2.19.m5.1.1.2" xref="S1.T2.19.m5.1.1.2.cmml"><mi id="S1.T2.19.m5.1.1.2.2" xref="S1.T2.19.m5.1.1.2.2.cmml">e</mi><mn id="S1.T2.19.m5.1.1.2.3" xref="S1.T2.19.m5.1.1.2.3.cmml">1</mn></msub><mo id="S1.T2.19.m5.1.1.1" xref="S1.T2.19.m5.1.1.1.cmml">/</mo><msubsup id="S1.T2.19.m5.1.1.3" xref="S1.T2.19.m5.1.1.3.cmml"><mi id="S1.T2.19.m5.1.1.3.2.2" xref="S1.T2.19.m5.1.1.3.2.2.cmml">e</mi><mn id="S1.T2.19.m5.1.1.3.2.3" xref="S1.T2.19.m5.1.1.3.2.3.cmml">1</mn><mo id="S1.T2.19.m5.1.1.3.3" xref="S1.T2.19.m5.1.1.3.3.cmml">∗</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S1.T2.19.m5.1c"><apply id="S1.T2.19.m5.1.1.cmml" xref="S1.T2.19.m5.1.1"><divide id="S1.T2.19.m5.1.1.1.cmml" xref="S1.T2.19.m5.1.1.1"></divide><apply id="S1.T2.19.m5.1.1.2.cmml" xref="S1.T2.19.m5.1.1.2"><csymbol cd="ambiguous" id="S1.T2.19.m5.1.1.2.1.cmml" xref="S1.T2.19.m5.1.1.2">subscript</csymbol><ci id="S1.T2.19.m5.1.1.2.2.cmml" xref="S1.T2.19.m5.1.1.2.2">𝑒</ci><cn id="S1.T2.19.m5.1.1.2.3.cmml" type="integer" xref="S1.T2.19.m5.1.1.2.3">1</cn></apply><apply id="S1.T2.19.m5.1.1.3.cmml" xref="S1.T2.19.m5.1.1.3"><csymbol cd="ambiguous" id="S1.T2.19.m5.1.1.3.1.cmml" xref="S1.T2.19.m5.1.1.3">superscript</csymbol><apply id="S1.T2.19.m5.1.1.3.2.cmml" xref="S1.T2.19.m5.1.1.3"><csymbol cd="ambiguous" id="S1.T2.19.m5.1.1.3.2.1.cmml" xref="S1.T2.19.m5.1.1.3">subscript</csymbol><ci id="S1.T2.19.m5.1.1.3.2.2.cmml" xref="S1.T2.19.m5.1.1.3.2.2">𝑒</ci><cn id="S1.T2.19.m5.1.1.3.2.3.cmml" type="integer" xref="S1.T2.19.m5.1.1.3.2.3">1</cn></apply><times id="S1.T2.19.m5.1.1.3.3.cmml" xref="S1.T2.19.m5.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.19.m5.1d">e_{1}/e_{1}^{*}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.19.m5.1e">italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT / italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="e_{2}/e_{2}^{*}" class="ltx_Math" display="inline" id="S1.T2.20.m6.1"><semantics id="S1.T2.20.m6.1b"><mrow id="S1.T2.20.m6.1.1" xref="S1.T2.20.m6.1.1.cmml"><msub id="S1.T2.20.m6.1.1.2" xref="S1.T2.20.m6.1.1.2.cmml"><mi id="S1.T2.20.m6.1.1.2.2" xref="S1.T2.20.m6.1.1.2.2.cmml">e</mi><mn id="S1.T2.20.m6.1.1.2.3" xref="S1.T2.20.m6.1.1.2.3.cmml">2</mn></msub><mo id="S1.T2.20.m6.1.1.1" xref="S1.T2.20.m6.1.1.1.cmml">/</mo><msubsup id="S1.T2.20.m6.1.1.3" xref="S1.T2.20.m6.1.1.3.cmml"><mi id="S1.T2.20.m6.1.1.3.2.2" xref="S1.T2.20.m6.1.1.3.2.2.cmml">e</mi><mn id="S1.T2.20.m6.1.1.3.2.3" xref="S1.T2.20.m6.1.1.3.2.3.cmml">2</mn><mo id="S1.T2.20.m6.1.1.3.3" xref="S1.T2.20.m6.1.1.3.3.cmml">∗</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S1.T2.20.m6.1c"><apply id="S1.T2.20.m6.1.1.cmml" xref="S1.T2.20.m6.1.1"><divide id="S1.T2.20.m6.1.1.1.cmml" xref="S1.T2.20.m6.1.1.1"></divide><apply id="S1.T2.20.m6.1.1.2.cmml" xref="S1.T2.20.m6.1.1.2"><csymbol cd="ambiguous" id="S1.T2.20.m6.1.1.2.1.cmml" xref="S1.T2.20.m6.1.1.2">subscript</csymbol><ci id="S1.T2.20.m6.1.1.2.2.cmml" xref="S1.T2.20.m6.1.1.2.2">𝑒</ci><cn id="S1.T2.20.m6.1.1.2.3.cmml" type="integer" xref="S1.T2.20.m6.1.1.2.3">2</cn></apply><apply id="S1.T2.20.m6.1.1.3.cmml" xref="S1.T2.20.m6.1.1.3"><csymbol cd="ambiguous" id="S1.T2.20.m6.1.1.3.1.cmml" xref="S1.T2.20.m6.1.1.3">superscript</csymbol><apply id="S1.T2.20.m6.1.1.3.2.cmml" xref="S1.T2.20.m6.1.1.3"><csymbol cd="ambiguous" id="S1.T2.20.m6.1.1.3.2.1.cmml" xref="S1.T2.20.m6.1.1.3">subscript</csymbol><ci id="S1.T2.20.m6.1.1.3.2.2.cmml" xref="S1.T2.20.m6.1.1.3.2.2">𝑒</ci><cn id="S1.T2.20.m6.1.1.3.2.3.cmml" type="integer" xref="S1.T2.20.m6.1.1.3.2.3">2</cn></apply><times id="S1.T2.20.m6.1.1.3.3.cmml" xref="S1.T2.20.m6.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.20.m6.1d">e_{2}/e_{2}^{*}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.20.m6.1e">italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT / italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> denote two candidate example pairs of incomplete utterance and rewritten utterance which can be prompted to the LLM. </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S1.T2.22">
<tr class="ltx_tr" id="S1.T2.22.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.22.3.1"><span class="ltx_text ltx_font_bold" id="S1.T2.22.3.1.1">Example</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T2.22.3.2"><span class="ltx_text ltx_font_bold" id="S1.T2.22.3.2.1">Sparse</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T2.22.3.3"><span class="ltx_text ltx_font_bold" id="S1.T2.22.3.3.1">Dense</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.22.3.4"><span class="ltx_text ltx_font_bold" id="S1.T2.22.3.4.1">ROUGE</span></td>
</tr>
<tr class="ltx_tr" id="S1.T2.21.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S1.T2.21.1.1"><math alttext="e_{1}" class="ltx_Math" display="inline" id="S1.T2.21.1.1.m1.1"><semantics id="S1.T2.21.1.1.m1.1a"><msub id="S1.T2.21.1.1.m1.1.1" xref="S1.T2.21.1.1.m1.1.1.cmml"><mi id="S1.T2.21.1.1.m1.1.1.2" xref="S1.T2.21.1.1.m1.1.1.2.cmml">e</mi><mn id="S1.T2.21.1.1.m1.1.1.3" xref="S1.T2.21.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.21.1.1.m1.1b"><apply id="S1.T2.21.1.1.m1.1.1.cmml" xref="S1.T2.21.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.21.1.1.m1.1.1.1.cmml" xref="S1.T2.21.1.1.m1.1.1">subscript</csymbol><ci id="S1.T2.21.1.1.m1.1.1.2.cmml" xref="S1.T2.21.1.1.m1.1.1.2">𝑒</ci><cn id="S1.T2.21.1.1.m1.1.1.3.cmml" type="integer" xref="S1.T2.21.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.21.1.1.m1.1c">e_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.21.1.1.m1.1d">italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T2.21.1.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T2.21.1.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T2.21.1.4">50.0</td>
</tr>
<tr class="ltx_tr" id="S1.T2.22.2">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S1.T2.22.2.1"><math alttext="e_{2}" class="ltx_Math" display="inline" id="S1.T2.22.2.1.m1.1"><semantics id="S1.T2.22.2.1.m1.1a"><msub id="S1.T2.22.2.1.m1.1.1" xref="S1.T2.22.2.1.m1.1.1.cmml"><mi id="S1.T2.22.2.1.m1.1.1.2" xref="S1.T2.22.2.1.m1.1.1.2.cmml">e</mi><mn id="S1.T2.22.2.1.m1.1.1.3" xref="S1.T2.22.2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.T2.22.2.1.m1.1b"><apply id="S1.T2.22.2.1.m1.1.1.cmml" xref="S1.T2.22.2.1.m1.1.1"><csymbol cd="ambiguous" id="S1.T2.22.2.1.m1.1.1.1.cmml" xref="S1.T2.22.2.1.m1.1.1">subscript</csymbol><ci id="S1.T2.22.2.1.m1.1.1.2.cmml" xref="S1.T2.22.2.1.m1.1.1.2">𝑒</ci><cn id="S1.T2.22.2.1.m1.1.1.3.cmml" type="integer" xref="S1.T2.22.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T2.22.2.1.m1.1c">e_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.T2.22.2.1.m1.1d">italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S1.T2.22.2.2">✗</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S1.T2.22.2.3">✗</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S1.T2.22.2.4">55.6</td>
</tr>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>The Rouge score of ChatGLM by use of different examples in prompts. “Sparse” denotes selecting the example by sparse retrieval methods like BM25, “Dense” denotes selecting the example by dense representations by PTM.</figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, there has been a growing focus on multi-turn dialogue modeling <cite class="ltx_cite ltx_citemacro_cite">Choi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib2" title="">2018</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib29" title="">2019</a>); Reddy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib23" title="">2019</a>)</cite>. One of the primary challenges in this field is the tendency of speakers to employ incomplete utterances, such as co-reference or ellipsis, when referring back to entities or concepts that have been mentioned in the dialogue history. <cite class="ltx_cite ltx_citemacro_citet">Su et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib28" title="">2019</a>)</cite> demonstrates that ellipsis and co-reference occur in over 70% of dialogue utterances. To address this phenomenon, the Incomplete Utterance Rewriting (IUR) task, as proposed by <cite class="ltx_cite ltx_citemacro_cite">Pan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib19" title="">2019</a>); Elgohary et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib6" title="">2019</a>)</cite>, aims to rephrase an incomplete utterance into a self-contained utterance that is semantically equivalent and can be comprehended independently, without relying on contextual information.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recent generation-based approaches for IUR tackle this task as a seq2seq problem and gain impressive performances <cite class="ltx_cite ltx_citemacro_cite">Pan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib19" title="">2019</a>); Huang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib10" title="">2021</a>); Inoue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib11" title="">2022</a>)</cite>.
With the increasing ability of LLMs, ICL
has become a new direction for natural language generation, where LLMs
make predictions only depending on contexts augmented
by a few examples (demonstration) without weights updating <cite class="ltx_cite ltx_citemacro_cite">Brown et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib1" title="">2020</a>); Chowdhery et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib3" title="">2022</a>); Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib30" title="">2023</a>)</cite>. However, the performance of ICL is sensitive to the
selection of in-context examples <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib33" title="">2021</a>); Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib17" title="">2021</a>); Dong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib5" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.3">We take a case from TASK dataset in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S1.T2" title="Table 2 ‣ 1 Introduction ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S1.T2" title="Table 2 ‣ 1 Introduction ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">2</span></a>, where the incomplete utterance is “How about Mediterranean food?” and the omitted part is the postpositive attributive “in expensive price range”. By metrics of sparse retrieval methods like BM25 <cite class="ltx_cite ltx_citemacro_cite">Robertson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib25" title="">2009</a>)</cite> or dense retrieval methods like PTM <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib16" title="">2022</a>)</cite>, the example incomplete utterance <math alttext="e_{1}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msub id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">e</mi><mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">𝑒</ci><cn id="S1.p3.1.m1.1.1.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">e_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> as well as its contexts and rewritten utterance should be selected to be in-context examples. However, the performance of LLM for this question with example <math alttext="e_{1}" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><msub id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml"><mi id="S1.p3.2.m2.1.1.2" xref="S1.p3.2.m2.1.1.2.cmml">e</mi><mn id="S1.p3.2.m2.1.1.3" xref="S1.p3.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.cmml" xref="S1.p3.2.m2.1.1">subscript</csymbol><ci id="S1.p3.2.m2.1.1.2.cmml" xref="S1.p3.2.m2.1.1.2">𝑒</ci><cn id="S1.p3.2.m2.1.1.3.cmml" type="integer" xref="S1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">e_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> drops by 5 ROUGE score compared with example <math alttext="e_{2}" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><msub id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml"><mi id="S1.p3.3.m3.1.1.2" xref="S1.p3.3.m3.1.1.2.cmml">e</mi><mn id="S1.p3.3.m3.1.1.3" xref="S1.p3.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><apply id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.cmml" xref="S1.p3.3.m3.1.1">subscript</csymbol><ci id="S1.p3.3.m3.1.1.2.cmml" xref="S1.p3.3.m3.1.1.2">𝑒</ci><cn id="S1.p3.3.m3.1.1.3.cmml" type="integer" xref="S1.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">e_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To directly select the examples that can improve the analogy ability of LLM, we introduce policy based reinforcement learning (RL) into example selection for IUR (RLS). Given a set of candidate examples, we utilize a small-scale language model (LM) to encode the context and incomplete utterance of each example. Intuitively, if a subset of candidate examples leads to increasing performance of LLM for IUR, RLS should
assign high scores to them; the more the performance
increases, the higher the example scores should be. Therefore, we compute the reward by ICL performance and optimize the LM selector with policy gradient.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We conduct experiments on three benchmark datasets in IUR field and compare with existing competitive example selection methods. Our approach outperforms existing methods by about 2 score in CANARD and REWRITE dataset and 10 score in TASK dataset with different metrics including BLEU, ROUGE and F-score.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our contributions can be summarized as:
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S1.p6.1.1">1.</span> We are the first to explore ICL performance of LLM for IUR task and design the effective formulation of demonstration for IUR task.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S1.p6.1.2">2.</span> We introduce policy-based RL into example selection for ICL prompts, which directly utilize the LLM feedback to train the LM selector.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S1.p6.1.3">3.</span> Our approach significantly outperforms existing example selection methods across sparse retrieval and dense retrieval methods. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S1.p6.1.4">4.</span> Our approach shows advantages against SFT models in few shot setting. We explain the improvement comes from the linguistic complexity and abundance, as well as the similarity with the test case of examples.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="373" id="S1.F1.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Method Overview. Our approach consists of an LM example selector and an LLM generator. </figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">There are two main streams of approaches to tackle the task of IUR: edit-based and generation-based. Generation-based models solve this task as a seq2seq problem, which is more relevant to our approach for ICL with LLM. <cite class="ltx_cite ltx_citemacro_citet">Su et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib28" title="">2019</a>)</cite> utilize pointer network to respectively predict the prob of tokens in rewritten utterance from contexts or incomplete utterance.
<cite class="ltx_cite ltx_citemacro_citet">Hao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib9" title="">2021</a>)</cite> formulate the task as sequence tagging to reduce the search space.
<cite class="ltx_cite ltx_citemacro_citet">Huang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib10" title="">2021</a>)</cite> combine a source sequence tagger with
an LSTM-based decoder to maintain grammatical correctness.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Demonstration selection is crucial to ICL and <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib17" title="">2021</a>)</cite> showed that downstream performance can
vary widely depending on the choice of in-context
examples.
<cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib16" title="">2022</a>)</cite> utilize sentence representations of PTM to select the examples with more cosine similarity. <cite class="ltx_cite ltx_citemacro_citet">Sorensen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib27" title="">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Gonen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib7" title="">2022</a>)</cite> argue that mutual information and perplexity are also valuable selection metrics which do not need labeled examples and specific LLM.
<cite class="ltx_cite ltx_citemacro_citet">Levy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib14" title="">2022</a>)</cite> select diverse demonstrations to collectively cover all of the structures required
in the outputs.
<cite class="ltx_cite ltx_citemacro_citet">Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib12" title="">2022</a>)</cite> generate
demonstrations for ICL from
PLM itself to minimize the reliance on the
external demonstration.
<cite class="ltx_cite ltx_citemacro_citet">Rubin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib26" title="">2021</a>)</cite> first build an unsupervised
retriever like BM25 to recall similar
examples as candidates and then construct a supervised
retriever to select demonstrations from candidates
However, these methods fail to directly select the examples into demonstrations that can improve the analogy ability of LLM for IUR task and some useful examples like in table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S1.T2" title="Table 2 ‣ 1 Introduction ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">2</span></a> will be neglected.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Task Definition</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.17">Given the context <math alttext="C" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_C</annotation></semantics></math> and the incomplete utterance <math alttext="U" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">U</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_U</annotation></semantics></math>, we aim to derive the rewritten version <math alttext="R" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_R</annotation></semantics></math> which can be comprehended without the context. The IUR task is to learn a map function <math alttext="f(C,U|\theta)=R" class="ltx_Math" display="inline" id="S3.p1.4.m4.2"><semantics id="S3.p1.4.m4.2a"><mrow id="S3.p1.4.m4.2.2" xref="S3.p1.4.m4.2.2.cmml"><mrow id="S3.p1.4.m4.2.2.1" xref="S3.p1.4.m4.2.2.1.cmml"><mi id="S3.p1.4.m4.2.2.1.3" xref="S3.p1.4.m4.2.2.1.3.cmml">f</mi><mo id="S3.p1.4.m4.2.2.1.2" xref="S3.p1.4.m4.2.2.1.2.cmml">⁢</mo><mrow id="S3.p1.4.m4.2.2.1.1.1" xref="S3.p1.4.m4.2.2.1.1.2.cmml"><mo id="S3.p1.4.m4.2.2.1.1.1.2" stretchy="false" xref="S3.p1.4.m4.2.2.1.1.2.cmml">(</mo><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">C</mi><mo id="S3.p1.4.m4.2.2.1.1.1.3" xref="S3.p1.4.m4.2.2.1.1.2.cmml">,</mo><mrow id="S3.p1.4.m4.2.2.1.1.1.1" xref="S3.p1.4.m4.2.2.1.1.1.1.cmml"><mi id="S3.p1.4.m4.2.2.1.1.1.1.2" xref="S3.p1.4.m4.2.2.1.1.1.1.2.cmml">U</mi><mo fence="false" id="S3.p1.4.m4.2.2.1.1.1.1.1" xref="S3.p1.4.m4.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.p1.4.m4.2.2.1.1.1.1.3" xref="S3.p1.4.m4.2.2.1.1.1.1.3.cmml">θ</mi></mrow><mo id="S3.p1.4.m4.2.2.1.1.1.4" stretchy="false" xref="S3.p1.4.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.p1.4.m4.2.2.2" xref="S3.p1.4.m4.2.2.2.cmml">=</mo><mi id="S3.p1.4.m4.2.2.3" xref="S3.p1.4.m4.2.2.3.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.2b"><apply id="S3.p1.4.m4.2.2.cmml" xref="S3.p1.4.m4.2.2"><eq id="S3.p1.4.m4.2.2.2.cmml" xref="S3.p1.4.m4.2.2.2"></eq><apply id="S3.p1.4.m4.2.2.1.cmml" xref="S3.p1.4.m4.2.2.1"><times id="S3.p1.4.m4.2.2.1.2.cmml" xref="S3.p1.4.m4.2.2.1.2"></times><ci id="S3.p1.4.m4.2.2.1.3.cmml" xref="S3.p1.4.m4.2.2.1.3">𝑓</ci><interval closure="open" id="S3.p1.4.m4.2.2.1.1.2.cmml" xref="S3.p1.4.m4.2.2.1.1.1"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝐶</ci><apply id="S3.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.p1.4.m4.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.p1.4.m4.2.2.1.1.1.1.1.cmml" xref="S3.p1.4.m4.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.p1.4.m4.2.2.1.1.1.1.2.cmml" xref="S3.p1.4.m4.2.2.1.1.1.1.2">𝑈</ci><ci id="S3.p1.4.m4.2.2.1.1.1.1.3.cmml" xref="S3.p1.4.m4.2.2.1.1.1.1.3">𝜃</ci></apply></interval></apply><ci id="S3.p1.4.m4.2.2.3.cmml" xref="S3.p1.4.m4.2.2.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.2c">f(C,U|\theta)=R</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.2d">italic_f ( italic_C , italic_U | italic_θ ) = italic_R</annotation></semantics></math>. ICL with LLM for IUR task needs a set of candidate examples <math alttext="\{y_{1},y_{2},\cdots,y_{N}\}" class="ltx_Math" display="inline" id="S3.p1.5.m5.4"><semantics id="S3.p1.5.m5.4a"><mrow id="S3.p1.5.m5.4.4.3" xref="S3.p1.5.m5.4.4.4.cmml"><mo id="S3.p1.5.m5.4.4.3.4" stretchy="false" xref="S3.p1.5.m5.4.4.4.cmml">{</mo><msub id="S3.p1.5.m5.2.2.1.1" xref="S3.p1.5.m5.2.2.1.1.cmml"><mi id="S3.p1.5.m5.2.2.1.1.2" xref="S3.p1.5.m5.2.2.1.1.2.cmml">y</mi><mn id="S3.p1.5.m5.2.2.1.1.3" xref="S3.p1.5.m5.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.p1.5.m5.4.4.3.5" xref="S3.p1.5.m5.4.4.4.cmml">,</mo><msub id="S3.p1.5.m5.3.3.2.2" xref="S3.p1.5.m5.3.3.2.2.cmml"><mi id="S3.p1.5.m5.3.3.2.2.2" xref="S3.p1.5.m5.3.3.2.2.2.cmml">y</mi><mn id="S3.p1.5.m5.3.3.2.2.3" xref="S3.p1.5.m5.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.p1.5.m5.4.4.3.6" xref="S3.p1.5.m5.4.4.4.cmml">,</mo><mi id="S3.p1.5.m5.1.1" mathvariant="normal" xref="S3.p1.5.m5.1.1.cmml">⋯</mi><mo id="S3.p1.5.m5.4.4.3.7" xref="S3.p1.5.m5.4.4.4.cmml">,</mo><msub id="S3.p1.5.m5.4.4.3.3" xref="S3.p1.5.m5.4.4.3.3.cmml"><mi id="S3.p1.5.m5.4.4.3.3.2" xref="S3.p1.5.m5.4.4.3.3.2.cmml">y</mi><mi id="S3.p1.5.m5.4.4.3.3.3" xref="S3.p1.5.m5.4.4.3.3.3.cmml">N</mi></msub><mo id="S3.p1.5.m5.4.4.3.8" stretchy="false" xref="S3.p1.5.m5.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.4b"><set id="S3.p1.5.m5.4.4.4.cmml" xref="S3.p1.5.m5.4.4.3"><apply id="S3.p1.5.m5.2.2.1.1.cmml" xref="S3.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.2.2.1.1.1.cmml" xref="S3.p1.5.m5.2.2.1.1">subscript</csymbol><ci id="S3.p1.5.m5.2.2.1.1.2.cmml" xref="S3.p1.5.m5.2.2.1.1.2">𝑦</ci><cn id="S3.p1.5.m5.2.2.1.1.3.cmml" type="integer" xref="S3.p1.5.m5.2.2.1.1.3">1</cn></apply><apply id="S3.p1.5.m5.3.3.2.2.cmml" xref="S3.p1.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.3.3.2.2.1.cmml" xref="S3.p1.5.m5.3.3.2.2">subscript</csymbol><ci id="S3.p1.5.m5.3.3.2.2.2.cmml" xref="S3.p1.5.m5.3.3.2.2.2">𝑦</ci><cn id="S3.p1.5.m5.3.3.2.2.3.cmml" type="integer" xref="S3.p1.5.m5.3.3.2.2.3">2</cn></apply><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">⋯</ci><apply id="S3.p1.5.m5.4.4.3.3.cmml" xref="S3.p1.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.4.4.3.3.1.cmml" xref="S3.p1.5.m5.4.4.3.3">subscript</csymbol><ci id="S3.p1.5.m5.4.4.3.3.2.cmml" xref="S3.p1.5.m5.4.4.3.3.2">𝑦</ci><ci id="S3.p1.5.m5.4.4.3.3.3.cmml" xref="S3.p1.5.m5.4.4.3.3.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.4c">\{y_{1},y_{2},\cdots,y_{N}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.4d">{ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_y start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="y_{i}=(C_{i},U_{i},R_{i}),1\leq i\leq n" class="ltx_Math" display="inline" id="S3.p1.6.m6.2"><semantics id="S3.p1.6.m6.2a"><mrow id="S3.p1.6.m6.2.2.2" xref="S3.p1.6.m6.2.2.3.cmml"><mrow id="S3.p1.6.m6.1.1.1.1" xref="S3.p1.6.m6.1.1.1.1.cmml"><msub id="S3.p1.6.m6.1.1.1.1.5" xref="S3.p1.6.m6.1.1.1.1.5.cmml"><mi id="S3.p1.6.m6.1.1.1.1.5.2" xref="S3.p1.6.m6.1.1.1.1.5.2.cmml">y</mi><mi id="S3.p1.6.m6.1.1.1.1.5.3" xref="S3.p1.6.m6.1.1.1.1.5.3.cmml">i</mi></msub><mo id="S3.p1.6.m6.1.1.1.1.4" xref="S3.p1.6.m6.1.1.1.1.4.cmml">=</mo><mrow id="S3.p1.6.m6.1.1.1.1.3.3" xref="S3.p1.6.m6.1.1.1.1.3.4.cmml"><mo id="S3.p1.6.m6.1.1.1.1.3.3.4" stretchy="false" xref="S3.p1.6.m6.1.1.1.1.3.4.cmml">(</mo><msub id="S3.p1.6.m6.1.1.1.1.1.1.1" xref="S3.p1.6.m6.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.6.m6.1.1.1.1.1.1.1.2" xref="S3.p1.6.m6.1.1.1.1.1.1.1.2.cmml">C</mi><mi id="S3.p1.6.m6.1.1.1.1.1.1.1.3" xref="S3.p1.6.m6.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p1.6.m6.1.1.1.1.3.3.5" xref="S3.p1.6.m6.1.1.1.1.3.4.cmml">,</mo><msub id="S3.p1.6.m6.1.1.1.1.2.2.2" xref="S3.p1.6.m6.1.1.1.1.2.2.2.cmml"><mi id="S3.p1.6.m6.1.1.1.1.2.2.2.2" xref="S3.p1.6.m6.1.1.1.1.2.2.2.2.cmml">U</mi><mi id="S3.p1.6.m6.1.1.1.1.2.2.2.3" xref="S3.p1.6.m6.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.p1.6.m6.1.1.1.1.3.3.6" xref="S3.p1.6.m6.1.1.1.1.3.4.cmml">,</mo><msub id="S3.p1.6.m6.1.1.1.1.3.3.3" xref="S3.p1.6.m6.1.1.1.1.3.3.3.cmml"><mi id="S3.p1.6.m6.1.1.1.1.3.3.3.2" xref="S3.p1.6.m6.1.1.1.1.3.3.3.2.cmml">R</mi><mi id="S3.p1.6.m6.1.1.1.1.3.3.3.3" xref="S3.p1.6.m6.1.1.1.1.3.3.3.3.cmml">i</mi></msub><mo id="S3.p1.6.m6.1.1.1.1.3.3.7" stretchy="false" xref="S3.p1.6.m6.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="S3.p1.6.m6.2.2.2.3" xref="S3.p1.6.m6.2.2.3a.cmml">,</mo><mrow id="S3.p1.6.m6.2.2.2.2" xref="S3.p1.6.m6.2.2.2.2.cmml"><mn id="S3.p1.6.m6.2.2.2.2.2" xref="S3.p1.6.m6.2.2.2.2.2.cmml">1</mn><mo id="S3.p1.6.m6.2.2.2.2.3" xref="S3.p1.6.m6.2.2.2.2.3.cmml">≤</mo><mi id="S3.p1.6.m6.2.2.2.2.4" xref="S3.p1.6.m6.2.2.2.2.4.cmml">i</mi><mo id="S3.p1.6.m6.2.2.2.2.5" xref="S3.p1.6.m6.2.2.2.2.5.cmml">≤</mo><mi id="S3.p1.6.m6.2.2.2.2.6" xref="S3.p1.6.m6.2.2.2.2.6.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.2b"><apply id="S3.p1.6.m6.2.2.3.cmml" xref="S3.p1.6.m6.2.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.3a.cmml" xref="S3.p1.6.m6.2.2.2.3">formulae-sequence</csymbol><apply id="S3.p1.6.m6.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1"><eq id="S3.p1.6.m6.1.1.1.1.4.cmml" xref="S3.p1.6.m6.1.1.1.1.4"></eq><apply id="S3.p1.6.m6.1.1.1.1.5.cmml" xref="S3.p1.6.m6.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.5.1.cmml" xref="S3.p1.6.m6.1.1.1.1.5">subscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.5.2.cmml" xref="S3.p1.6.m6.1.1.1.1.5.2">𝑦</ci><ci id="S3.p1.6.m6.1.1.1.1.5.3.cmml" xref="S3.p1.6.m6.1.1.1.1.5.3">𝑖</ci></apply><vector id="S3.p1.6.m6.1.1.1.1.3.4.cmml" xref="S3.p1.6.m6.1.1.1.1.3.3"><apply id="S3.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1.2">𝐶</ci><ci id="S3.p1.6.m6.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p1.6.m6.1.1.1.1.2.2.2.cmml" xref="S3.p1.6.m6.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.6.m6.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.6.m6.1.1.1.1.2.2.2.2">𝑈</ci><ci id="S3.p1.6.m6.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.6.m6.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.p1.6.m6.1.1.1.1.3.3.3.cmml" xref="S3.p1.6.m6.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.3.3.3.1.cmml" xref="S3.p1.6.m6.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.3.3.3.2.cmml" xref="S3.p1.6.m6.1.1.1.1.3.3.3.2">𝑅</ci><ci id="S3.p1.6.m6.1.1.1.1.3.3.3.3.cmml" xref="S3.p1.6.m6.1.1.1.1.3.3.3.3">𝑖</ci></apply></vector></apply><apply id="S3.p1.6.m6.2.2.2.2.cmml" xref="S3.p1.6.m6.2.2.2.2"><and id="S3.p1.6.m6.2.2.2.2a.cmml" xref="S3.p1.6.m6.2.2.2.2"></and><apply id="S3.p1.6.m6.2.2.2.2b.cmml" xref="S3.p1.6.m6.2.2.2.2"><leq id="S3.p1.6.m6.2.2.2.2.3.cmml" xref="S3.p1.6.m6.2.2.2.2.3"></leq><cn id="S3.p1.6.m6.2.2.2.2.2.cmml" type="integer" xref="S3.p1.6.m6.2.2.2.2.2">1</cn><ci id="S3.p1.6.m6.2.2.2.2.4.cmml" xref="S3.p1.6.m6.2.2.2.2.4">𝑖</ci></apply><apply id="S3.p1.6.m6.2.2.2.2c.cmml" xref="S3.p1.6.m6.2.2.2.2"><leq id="S3.p1.6.m6.2.2.2.2.5.cmml" xref="S3.p1.6.m6.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2408.13028v1#S3.p1.6.m6.2.2.2.2.4.cmml" id="S3.p1.6.m6.2.2.2.2d.cmml" xref="S3.p1.6.m6.2.2.2.2"></share><ci id="S3.p1.6.m6.2.2.2.2.6.cmml" xref="S3.p1.6.m6.2.2.2.2.6">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.2c">y_{i}=(C_{i},U_{i},R_{i}),1\leq i\leq n</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.2d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , 1 ≤ italic_i ≤ italic_n</annotation></semantics></math> denotes the i-th example and <math alttext="N" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">italic_N</annotation></semantics></math> denotes the number of candidate examples. For a test case <math alttext="x=(c_{x},u_{x})" class="ltx_Math" display="inline" id="S3.p1.8.m8.2"><semantics id="S3.p1.8.m8.2a"><mrow id="S3.p1.8.m8.2.2" xref="S3.p1.8.m8.2.2.cmml"><mi id="S3.p1.8.m8.2.2.4" xref="S3.p1.8.m8.2.2.4.cmml">x</mi><mo id="S3.p1.8.m8.2.2.3" xref="S3.p1.8.m8.2.2.3.cmml">=</mo><mrow id="S3.p1.8.m8.2.2.2.2" xref="S3.p1.8.m8.2.2.2.3.cmml"><mo id="S3.p1.8.m8.2.2.2.2.3" stretchy="false" xref="S3.p1.8.m8.2.2.2.3.cmml">(</mo><msub id="S3.p1.8.m8.1.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.1.cmml"><mi id="S3.p1.8.m8.1.1.1.1.1.2" xref="S3.p1.8.m8.1.1.1.1.1.2.cmml">c</mi><mi id="S3.p1.8.m8.1.1.1.1.1.3" xref="S3.p1.8.m8.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.p1.8.m8.2.2.2.2.4" xref="S3.p1.8.m8.2.2.2.3.cmml">,</mo><msub id="S3.p1.8.m8.2.2.2.2.2" xref="S3.p1.8.m8.2.2.2.2.2.cmml"><mi id="S3.p1.8.m8.2.2.2.2.2.2" xref="S3.p1.8.m8.2.2.2.2.2.2.cmml">u</mi><mi id="S3.p1.8.m8.2.2.2.2.2.3" xref="S3.p1.8.m8.2.2.2.2.2.3.cmml">x</mi></msub><mo id="S3.p1.8.m8.2.2.2.2.5" stretchy="false" xref="S3.p1.8.m8.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.2b"><apply id="S3.p1.8.m8.2.2.cmml" xref="S3.p1.8.m8.2.2"><eq id="S3.p1.8.m8.2.2.3.cmml" xref="S3.p1.8.m8.2.2.3"></eq><ci id="S3.p1.8.m8.2.2.4.cmml" xref="S3.p1.8.m8.2.2.4">𝑥</ci><interval closure="open" id="S3.p1.8.m8.2.2.2.3.cmml" xref="S3.p1.8.m8.2.2.2.2"><apply id="S3.p1.8.m8.1.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.p1.8.m8.1.1.1.1.1.2">𝑐</ci><ci id="S3.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.p1.8.m8.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.p1.8.m8.2.2.2.2.2.cmml" xref="S3.p1.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.2.2.2.2.2.1.cmml" xref="S3.p1.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.8.m8.2.2.2.2.2.2.cmml" xref="S3.p1.8.m8.2.2.2.2.2.2">𝑢</ci><ci id="S3.p1.8.m8.2.2.2.2.2.3.cmml" xref="S3.p1.8.m8.2.2.2.2.2.3">𝑥</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.2c">x=(c_{x},u_{x})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.2d">italic_x = ( italic_c start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT )</annotation></semantics></math>, we select <math alttext="k" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">italic_k</annotation></semantics></math> examples from the candidate set
and the input to LLM <math alttext="M" class="ltx_Math" display="inline" id="S3.p1.10.m10.1"><semantics id="S3.p1.10.m10.1a"><mi id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p1.10.m10.1d">italic_M</annotation></semantics></math> is the concatenation of the task instruction <math alttext="I" class="ltx_Math" display="inline" id="S3.p1.11.m11.1"><semantics id="S3.p1.11.m11.1a"><mi id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><ci id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.p1.11.m11.1d">italic_I</annotation></semantics></math>, the <math alttext="k" class="ltx_Math" display="inline" id="S3.p1.12.m12.1"><semantics id="S3.p1.12.m12.1a"><mi id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><ci id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p1.12.m12.1d">italic_k</annotation></semantics></math> demonstration examples, and the test case <math alttext="x" class="ltx_Math" display="inline" id="S3.p1.13.m13.1"><semantics id="S3.p1.13.m13.1a"><mi id="S3.p1.13.m13.1.1" xref="S3.p1.13.m13.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><ci id="S3.p1.13.m13.1.1.cmml" xref="S3.p1.13.m13.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.p1.13.m13.1d">italic_x</annotation></semantics></math>. The rewritten utterance of <math alttext="x" class="ltx_Math" display="inline" id="S3.p1.14.m14.1"><semantics id="S3.p1.14.m14.1a"><mi id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><ci id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.p1.14.m14.1d">italic_x</annotation></semantics></math> is generated by <math alttext="M" class="ltx_Math" display="inline" id="S3.p1.15.m15.1"><semantics id="S3.p1.15.m15.1a"><mi id="S3.p1.15.m15.1.1" xref="S3.p1.15.m15.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p1.15.m15.1b"><ci id="S3.p1.15.m15.1.1.cmml" xref="S3.p1.15.m15.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m15.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p1.15.m15.1d">italic_M</annotation></semantics></math>: <math alttext="R_{x}=M[I;(C_{i_{1}},U_{i_{1}},R_{i_{1}});(C_{i_{2}},U_{i_{2}},R_{i_{2}});%
\cdots;\\
(C_{i_{k}},U_{i_{k}},R_{i_{k}});(C_{i_{x}},U_{i_{x}})]" class="ltx_Math" display="inline" id="S3.p1.16.m16.6"><semantics id="S3.p1.16.m16.6a"><mrow id="S3.p1.16.m16.6.6" xref="S3.p1.16.m16.6.6.cmml"><msub id="S3.p1.16.m16.6.6.6" xref="S3.p1.16.m16.6.6.6.cmml"><mi id="S3.p1.16.m16.6.6.6.2" xref="S3.p1.16.m16.6.6.6.2.cmml">R</mi><mi id="S3.p1.16.m16.6.6.6.3" xref="S3.p1.16.m16.6.6.6.3.cmml">x</mi></msub><mo id="S3.p1.16.m16.6.6.5" xref="S3.p1.16.m16.6.6.5.cmml">=</mo><mrow id="S3.p1.16.m16.6.6.4" xref="S3.p1.16.m16.6.6.4.cmml"><mi id="S3.p1.16.m16.6.6.4.6" xref="S3.p1.16.m16.6.6.4.6.cmml">M</mi><mo id="S3.p1.16.m16.6.6.4.5" xref="S3.p1.16.m16.6.6.4.5.cmml">⁢</mo><mrow id="S3.p1.16.m16.6.6.4.4.4" xref="S3.p1.16.m16.6.6.4.4.5.cmml"><mo id="S3.p1.16.m16.6.6.4.4.4.5" stretchy="false" xref="S3.p1.16.m16.6.6.4.4.5.cmml">[</mo><mi id="S3.p1.16.m16.1.1" xref="S3.p1.16.m16.1.1.cmml">I</mi><mo id="S3.p1.16.m16.6.6.4.4.4.6" xref="S3.p1.16.m16.6.6.4.4.5.cmml">;</mo><mrow id="S3.p1.16.m16.3.3.1.1.1.1.3" xref="S3.p1.16.m16.3.3.1.1.1.1.4.cmml"><mo id="S3.p1.16.m16.3.3.1.1.1.1.3.4" stretchy="false" xref="S3.p1.16.m16.3.3.1.1.1.1.4.cmml">(</mo><msub id="S3.p1.16.m16.3.3.1.1.1.1.1.1" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.1.1.2" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.2.cmml">C</mi><msub id="S3.p1.16.m16.3.3.1.1.1.1.1.1.3" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.2" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.2.cmml">i</mi><mn id="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.3" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.p1.16.m16.3.3.1.1.1.1.3.5" xref="S3.p1.16.m16.3.3.1.1.1.1.4.cmml">,</mo><msub id="S3.p1.16.m16.3.3.1.1.1.1.2.2" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.2.2.2" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.2.cmml">U</mi><msub id="S3.p1.16.m16.3.3.1.1.1.1.2.2.3" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.2" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mn id="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.3" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></msub></msub><mo id="S3.p1.16.m16.3.3.1.1.1.1.3.6" xref="S3.p1.16.m16.3.3.1.1.1.1.4.cmml">,</mo><msub id="S3.p1.16.m16.3.3.1.1.1.1.3.3" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.3.3.2" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.2.cmml">R</mi><msub id="S3.p1.16.m16.3.3.1.1.1.1.3.3.3" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.2" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.2.cmml">i</mi><mn id="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.3" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.3.cmml">1</mn></msub></msub><mo id="S3.p1.16.m16.3.3.1.1.1.1.3.7" stretchy="false" xref="S3.p1.16.m16.3.3.1.1.1.1.4.cmml">)</mo></mrow><mo id="S3.p1.16.m16.6.6.4.4.4.7" xref="S3.p1.16.m16.6.6.4.4.5.cmml">;</mo><mrow id="S3.p1.16.m16.4.4.2.2.2.2.3" xref="S3.p1.16.m16.4.4.2.2.2.2.4.cmml"><mo id="S3.p1.16.m16.4.4.2.2.2.2.3.4" stretchy="false" xref="S3.p1.16.m16.4.4.2.2.2.2.4.cmml">(</mo><msub id="S3.p1.16.m16.4.4.2.2.2.2.1.1" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.cmml"><mi id="S3.p1.16.m16.4.4.2.2.2.2.1.1.2" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.2.cmml">C</mi><msub id="S3.p1.16.m16.4.4.2.2.2.2.1.1.3" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.cmml"><mi id="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.2" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.2.cmml">i</mi><mn id="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.3" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.3.cmml">2</mn></msub></msub><mo id="S3.p1.16.m16.4.4.2.2.2.2.3.5" xref="S3.p1.16.m16.4.4.2.2.2.2.4.cmml">,</mo><msub id="S3.p1.16.m16.4.4.2.2.2.2.2.2" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.cmml"><mi id="S3.p1.16.m16.4.4.2.2.2.2.2.2.2" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.2.cmml">U</mi><msub id="S3.p1.16.m16.4.4.2.2.2.2.2.2.3" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.cmml"><mi id="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.2" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.2.cmml">i</mi><mn id="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.3" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.p1.16.m16.4.4.2.2.2.2.3.6" xref="S3.p1.16.m16.4.4.2.2.2.2.4.cmml">,</mo><msub id="S3.p1.16.m16.4.4.2.2.2.2.3.3" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.cmml"><mi id="S3.p1.16.m16.4.4.2.2.2.2.3.3.2" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.2.cmml">R</mi><msub id="S3.p1.16.m16.4.4.2.2.2.2.3.3.3" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.cmml"><mi id="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.2" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.2.cmml">i</mi><mn id="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.3" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.3.cmml">2</mn></msub></msub><mo id="S3.p1.16.m16.4.4.2.2.2.2.3.7" stretchy="false" xref="S3.p1.16.m16.4.4.2.2.2.2.4.cmml">)</mo></mrow><mo id="S3.p1.16.m16.6.6.4.4.4.8" xref="S3.p1.16.m16.6.6.4.4.5.cmml">;</mo><mi id="S3.p1.16.m16.2.2" mathvariant="normal" xref="S3.p1.16.m16.2.2.cmml">⋯</mi><mo id="S3.p1.16.m16.6.6.4.4.4.9" xref="S3.p1.16.m16.6.6.4.4.5.cmml">;</mo><mrow id="S3.p1.16.m16.5.5.3.3.3.3.3" xref="S3.p1.16.m16.5.5.3.3.3.3.4.cmml"><mo id="S3.p1.16.m16.5.5.3.3.3.3.3.4" stretchy="false" xref="S3.p1.16.m16.5.5.3.3.3.3.4.cmml">(</mo><msub id="S3.p1.16.m16.5.5.3.3.3.3.1.1" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.cmml"><mi id="S3.p1.16.m16.5.5.3.3.3.3.1.1.2" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.2.cmml">C</mi><msub id="S3.p1.16.m16.5.5.3.3.3.3.1.1.3" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.cmml"><mi id="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.2" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.2.cmml">i</mi><mi id="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.3" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.3.cmml">k</mi></msub></msub><mo id="S3.p1.16.m16.5.5.3.3.3.3.3.5" xref="S3.p1.16.m16.5.5.3.3.3.3.4.cmml">,</mo><msub id="S3.p1.16.m16.5.5.3.3.3.3.2.2" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.cmml"><mi id="S3.p1.16.m16.5.5.3.3.3.3.2.2.2" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.2.cmml">U</mi><msub id="S3.p1.16.m16.5.5.3.3.3.3.2.2.3" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.cmml"><mi id="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.2" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.2.cmml">i</mi><mi id="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.3" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.3.cmml">k</mi></msub></msub><mo id="S3.p1.16.m16.5.5.3.3.3.3.3.6" xref="S3.p1.16.m16.5.5.3.3.3.3.4.cmml">,</mo><msub id="S3.p1.16.m16.5.5.3.3.3.3.3.3" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.cmml"><mi id="S3.p1.16.m16.5.5.3.3.3.3.3.3.2" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.2.cmml">R</mi><msub id="S3.p1.16.m16.5.5.3.3.3.3.3.3.3" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.cmml"><mi id="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.2" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.2.cmml">i</mi><mi id="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.3" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.3.cmml">k</mi></msub></msub><mo id="S3.p1.16.m16.5.5.3.3.3.3.3.7" stretchy="false" xref="S3.p1.16.m16.5.5.3.3.3.3.4.cmml">)</mo></mrow><mo id="S3.p1.16.m16.6.6.4.4.4.10" xref="S3.p1.16.m16.6.6.4.4.5.cmml">;</mo><mrow id="S3.p1.16.m16.6.6.4.4.4.4.2" xref="S3.p1.16.m16.6.6.4.4.4.4.3.cmml"><mo id="S3.p1.16.m16.6.6.4.4.4.4.2.3" stretchy="false" xref="S3.p1.16.m16.6.6.4.4.4.4.3.cmml">(</mo><msub id="S3.p1.16.m16.6.6.4.4.4.4.1.1" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.cmml"><mi id="S3.p1.16.m16.6.6.4.4.4.4.1.1.2" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.2.cmml">C</mi><msub id="S3.p1.16.m16.6.6.4.4.4.4.1.1.3" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.cmml"><mi id="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.2" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.2.cmml">i</mi><mi id="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.3" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.3.cmml">x</mi></msub></msub><mo id="S3.p1.16.m16.6.6.4.4.4.4.2.4" xref="S3.p1.16.m16.6.6.4.4.4.4.3.cmml">,</mo><msub id="S3.p1.16.m16.6.6.4.4.4.4.2.2" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.cmml"><mi id="S3.p1.16.m16.6.6.4.4.4.4.2.2.2" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.2.cmml">U</mi><msub id="S3.p1.16.m16.6.6.4.4.4.4.2.2.3" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.cmml"><mi id="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.2" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.2.cmml">i</mi><mi id="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.3" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.3.cmml">x</mi></msub></msub><mo id="S3.p1.16.m16.6.6.4.4.4.4.2.5" stretchy="false" xref="S3.p1.16.m16.6.6.4.4.4.4.3.cmml">)</mo></mrow><mo id="S3.p1.16.m16.6.6.4.4.4.11" stretchy="false" xref="S3.p1.16.m16.6.6.4.4.5.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.16.m16.6b"><apply id="S3.p1.16.m16.6.6.cmml" xref="S3.p1.16.m16.6.6"><eq id="S3.p1.16.m16.6.6.5.cmml" xref="S3.p1.16.m16.6.6.5"></eq><apply id="S3.p1.16.m16.6.6.6.cmml" xref="S3.p1.16.m16.6.6.6"><csymbol cd="ambiguous" id="S3.p1.16.m16.6.6.6.1.cmml" xref="S3.p1.16.m16.6.6.6">subscript</csymbol><ci id="S3.p1.16.m16.6.6.6.2.cmml" xref="S3.p1.16.m16.6.6.6.2">𝑅</ci><ci id="S3.p1.16.m16.6.6.6.3.cmml" xref="S3.p1.16.m16.6.6.6.3">𝑥</ci></apply><apply id="S3.p1.16.m16.6.6.4.cmml" xref="S3.p1.16.m16.6.6.4"><times id="S3.p1.16.m16.6.6.4.5.cmml" xref="S3.p1.16.m16.6.6.4.5"></times><ci id="S3.p1.16.m16.6.6.4.6.cmml" xref="S3.p1.16.m16.6.6.4.6">𝑀</ci><list id="S3.p1.16.m16.6.6.4.4.5.cmml" xref="S3.p1.16.m16.6.6.4.4.4"><ci id="S3.p1.16.m16.1.1.cmml" xref="S3.p1.16.m16.1.1">𝐼</ci><vector id="S3.p1.16.m16.3.3.1.1.1.1.4.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3"><apply id="S3.p1.16.m16.3.3.1.1.1.1.1.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.1.1.1.1.1.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.1.1.1.1.1.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.2">𝐶</ci><apply id="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.p1.16.m16.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.p1.16.m16.3.3.1.1.1.1.2.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.1.1.1.2.2.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.1.1.1.2.2.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.2">𝑈</ci><apply id="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.p1.16.m16.3.3.1.1.1.1.3.3.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.1.1.1.3.3.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.1.1.1.3.3.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.2">𝑅</ci><apply id="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.2">𝑖</ci><cn id="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.3.3">1</cn></apply></apply></vector><vector id="S3.p1.16.m16.4.4.2.2.2.2.4.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.3"><apply id="S3.p1.16.m16.4.4.2.2.2.2.1.1.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.2.2.2.2.1.1.1.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1">subscript</csymbol><ci id="S3.p1.16.m16.4.4.2.2.2.2.1.1.2.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.2">𝐶</ci><apply id="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.1.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.2.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.2">𝑖</ci><cn id="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.3.cmml" type="integer" xref="S3.p1.16.m16.4.4.2.2.2.2.1.1.3.3">2</cn></apply></apply><apply id="S3.p1.16.m16.4.4.2.2.2.2.2.2.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.2.2.2.2.2.2.1.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.16.m16.4.4.2.2.2.2.2.2.2.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.2">𝑈</ci><apply id="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.1.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.2.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.2">𝑖</ci><cn id="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.p1.16.m16.4.4.2.2.2.2.2.2.3.3">2</cn></apply></apply><apply id="S3.p1.16.m16.4.4.2.2.2.2.3.3.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.2.2.2.2.3.3.1.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3">subscript</csymbol><ci id="S3.p1.16.m16.4.4.2.2.2.2.3.3.2.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.2">𝑅</ci><apply id="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.1.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.3">subscript</csymbol><ci id="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.2.cmml" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.2">𝑖</ci><cn id="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.3.cmml" type="integer" xref="S3.p1.16.m16.4.4.2.2.2.2.3.3.3.3">2</cn></apply></apply></vector><ci id="S3.p1.16.m16.2.2.cmml" xref="S3.p1.16.m16.2.2">⋯</ci><vector id="S3.p1.16.m16.5.5.3.3.3.3.4.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.3"><apply id="S3.p1.16.m16.5.5.3.3.3.3.1.1.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.5.5.3.3.3.3.1.1.1.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1">subscript</csymbol><ci id="S3.p1.16.m16.5.5.3.3.3.3.1.1.2.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.2">𝐶</ci><apply id="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.1.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.3">subscript</csymbol><ci id="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.2.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.2">𝑖</ci><ci id="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.3.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.p1.16.m16.5.5.3.3.3.3.2.2.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.5.5.3.3.3.3.2.2.1.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2">subscript</csymbol><ci id="S3.p1.16.m16.5.5.3.3.3.3.2.2.2.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.2">𝑈</ci><apply id="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.1.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.3">subscript</csymbol><ci id="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.2.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.2">𝑖</ci><ci id="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.3.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.2.2.3.3">𝑘</ci></apply></apply><apply id="S3.p1.16.m16.5.5.3.3.3.3.3.3.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.5.5.3.3.3.3.3.3.1.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3">subscript</csymbol><ci id="S3.p1.16.m16.5.5.3.3.3.3.3.3.2.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.2">𝑅</ci><apply id="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.1.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.3">subscript</csymbol><ci id="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.2.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.2">𝑖</ci><ci id="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.3.cmml" xref="S3.p1.16.m16.5.5.3.3.3.3.3.3.3.3">𝑘</ci></apply></apply></vector><interval closure="open" id="S3.p1.16.m16.6.6.4.4.4.4.3.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.2"><apply id="S3.p1.16.m16.6.6.4.4.4.4.1.1.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.6.6.4.4.4.4.1.1.1.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1">subscript</csymbol><ci id="S3.p1.16.m16.6.6.4.4.4.4.1.1.2.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.2">𝐶</ci><apply id="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.1.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.3">subscript</csymbol><ci id="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.2.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.2">𝑖</ci><ci id="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.3.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.1.1.3.3">𝑥</ci></apply></apply><apply id="S3.p1.16.m16.6.6.4.4.4.4.2.2.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.6.6.4.4.4.4.2.2.1.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2">subscript</csymbol><ci id="S3.p1.16.m16.6.6.4.4.4.4.2.2.2.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.2">𝑈</ci><apply id="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.1.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.3">subscript</csymbol><ci id="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.2.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.2">𝑖</ci><ci id="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.3.cmml" xref="S3.p1.16.m16.6.6.4.4.4.4.2.2.3.3">𝑥</ci></apply></apply></interval></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m16.6c">R_{x}=M[I;(C_{i_{1}},U_{i_{1}},R_{i_{1}});(C_{i_{2}},U_{i_{2}},R_{i_{2}});%
\cdots;\\
(C_{i_{k}},U_{i_{k}},R_{i_{k}});(C_{i_{x}},U_{i_{x}})]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.16.m16.6d">italic_R start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT = italic_M [ italic_I ; ( italic_C start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_R start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ; ( italic_C start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_R start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ; ⋯ ; ( italic_C start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_R start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ; ( italic_C start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ]</annotation></semantics></math>, <span class="ltx_text ltx_markedasmath" id="S3.p1.17.1">;</span> denotes concatenation of texts. So the key of ICL to solve IUR task is to select the appropriate examples.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.2">We approach the example selection as a sequential decision-making problem.
State space: the sequence of selected demonstration examples <math alttext="y_{i_{1}},y_{i_{2}},\cdots,y_{i_{k}}" class="ltx_Math" display="inline" id="S4.p1.1.m1.4"><semantics id="S4.p1.1.m1.4a"><mrow id="S4.p1.1.m1.4.4.3" xref="S4.p1.1.m1.4.4.4.cmml"><msub id="S4.p1.1.m1.2.2.1.1" xref="S4.p1.1.m1.2.2.1.1.cmml"><mi id="S4.p1.1.m1.2.2.1.1.2" xref="S4.p1.1.m1.2.2.1.1.2.cmml">y</mi><msub id="S4.p1.1.m1.2.2.1.1.3" xref="S4.p1.1.m1.2.2.1.1.3.cmml"><mi id="S4.p1.1.m1.2.2.1.1.3.2" xref="S4.p1.1.m1.2.2.1.1.3.2.cmml">i</mi><mn id="S4.p1.1.m1.2.2.1.1.3.3" xref="S4.p1.1.m1.2.2.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.p1.1.m1.4.4.3.4" xref="S4.p1.1.m1.4.4.4.cmml">,</mo><msub id="S4.p1.1.m1.3.3.2.2" xref="S4.p1.1.m1.3.3.2.2.cmml"><mi id="S4.p1.1.m1.3.3.2.2.2" xref="S4.p1.1.m1.3.3.2.2.2.cmml">y</mi><msub id="S4.p1.1.m1.3.3.2.2.3" xref="S4.p1.1.m1.3.3.2.2.3.cmml"><mi id="S4.p1.1.m1.3.3.2.2.3.2" xref="S4.p1.1.m1.3.3.2.2.3.2.cmml">i</mi><mn id="S4.p1.1.m1.3.3.2.2.3.3" xref="S4.p1.1.m1.3.3.2.2.3.3.cmml">2</mn></msub></msub><mo id="S4.p1.1.m1.4.4.3.5" xref="S4.p1.1.m1.4.4.4.cmml">,</mo><mi id="S4.p1.1.m1.1.1" mathvariant="normal" xref="S4.p1.1.m1.1.1.cmml">⋯</mi><mo id="S4.p1.1.m1.4.4.3.6" xref="S4.p1.1.m1.4.4.4.cmml">,</mo><msub id="S4.p1.1.m1.4.4.3.3" xref="S4.p1.1.m1.4.4.3.3.cmml"><mi id="S4.p1.1.m1.4.4.3.3.2" xref="S4.p1.1.m1.4.4.3.3.2.cmml">y</mi><msub id="S4.p1.1.m1.4.4.3.3.3" xref="S4.p1.1.m1.4.4.3.3.3.cmml"><mi id="S4.p1.1.m1.4.4.3.3.3.2" xref="S4.p1.1.m1.4.4.3.3.3.2.cmml">i</mi><mi id="S4.p1.1.m1.4.4.3.3.3.3" xref="S4.p1.1.m1.4.4.3.3.3.3.cmml">k</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.4b"><list id="S4.p1.1.m1.4.4.4.cmml" xref="S4.p1.1.m1.4.4.3"><apply id="S4.p1.1.m1.2.2.1.1.cmml" xref="S4.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.2.2.1.1.1.cmml" xref="S4.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.p1.1.m1.2.2.1.1.2.cmml" xref="S4.p1.1.m1.2.2.1.1.2">𝑦</ci><apply id="S4.p1.1.m1.2.2.1.1.3.cmml" xref="S4.p1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.p1.1.m1.2.2.1.1.3.1.cmml" xref="S4.p1.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.p1.1.m1.2.2.1.1.3.2.cmml" xref="S4.p1.1.m1.2.2.1.1.3.2">𝑖</ci><cn id="S4.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S4.p1.1.m1.2.2.1.1.3.3">1</cn></apply></apply><apply id="S4.p1.1.m1.3.3.2.2.cmml" xref="S4.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.3.3.2.2.1.cmml" xref="S4.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.p1.1.m1.3.3.2.2.2.cmml" xref="S4.p1.1.m1.3.3.2.2.2">𝑦</ci><apply id="S4.p1.1.m1.3.3.2.2.3.cmml" xref="S4.p1.1.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.p1.1.m1.3.3.2.2.3.1.cmml" xref="S4.p1.1.m1.3.3.2.2.3">subscript</csymbol><ci id="S4.p1.1.m1.3.3.2.2.3.2.cmml" xref="S4.p1.1.m1.3.3.2.2.3.2">𝑖</ci><cn id="S4.p1.1.m1.3.3.2.2.3.3.cmml" type="integer" xref="S4.p1.1.m1.3.3.2.2.3.3">2</cn></apply></apply><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">⋯</ci><apply id="S4.p1.1.m1.4.4.3.3.cmml" xref="S4.p1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S4.p1.1.m1.4.4.3.3.1.cmml" xref="S4.p1.1.m1.4.4.3.3">subscript</csymbol><ci id="S4.p1.1.m1.4.4.3.3.2.cmml" xref="S4.p1.1.m1.4.4.3.3.2">𝑦</ci><apply id="S4.p1.1.m1.4.4.3.3.3.cmml" xref="S4.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.p1.1.m1.4.4.3.3.3.1.cmml" xref="S4.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.p1.1.m1.4.4.3.3.3.2.cmml" xref="S4.p1.1.m1.4.4.3.3.3.2">𝑖</ci><ci id="S4.p1.1.m1.4.4.3.3.3.3.cmml" xref="S4.p1.1.m1.4.4.3.3.3.3">𝑘</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.4c">y_{i_{1}},y_{i_{2}},\cdots,y_{i_{k}}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.4d">italic_y start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ⋯ , italic_y start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="k" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_k</annotation></semantics></math> denotes the number of selected examples.
Action space: select the next example given the current selection result and insert the concatenation of its contexts, incomplete utterance and rewritten utterance into demonstrations.
Policy: We utilize transformer architecture to model the probability of each example in the candidate set to be selected into the demonstration.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Utterance Encoder</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.5">We make use of BERT <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib4" title="">2018</a>)</cite> to encode the semantic and syntactic information of utterances. For each example in the candidate set and the current test case, the input to PTM is the concatenation of contexts and incomplete utterance, which is separated by “[SEP]” token. The hidden state corresponding to “[CLS]” token is used to represent the case.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{S_{i}}" class="ltx_Math" display="inline" id="S4.E1.m1.1"><semantics id="S4.E1.m1.1a"><msub id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><mi id="S4.E1.m1.1.1.2" xref="S4.E1.m1.1.1.2.cmml">𝐒</mi><mi id="S4.E1.m1.1.1.3" xref="S4.E1.m1.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.2.cmml" xref="S4.E1.m1.1.1.2">𝐒</ci><ci id="S4.E1.m1.1.1.3.cmml" xref="S4.E1.m1.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\displaystyle\mathbf{S_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.1d">bold_S start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{BERT}([CLS;c_{i},SEP,u_{i}])" class="ltx_Math" display="inline" id="S4.E1.m2.1"><semantics id="S4.E1.m2.1a"><mrow id="S4.E1.m2.1.1" xref="S4.E1.m2.1.1.cmml"><mi id="S4.E1.m2.1.1.3" xref="S4.E1.m2.1.1.3.cmml"></mi><mo id="S4.E1.m2.1.1.2" xref="S4.E1.m2.1.1.2.cmml">=</mo><mrow id="S4.E1.m2.1.1.1" xref="S4.E1.m2.1.1.1.cmml"><mi id="S4.E1.m2.1.1.1.3" xref="S4.E1.m2.1.1.1.3.cmml">𝐁𝐄𝐑𝐓</mi><mo id="S4.E1.m2.1.1.1.2" xref="S4.E1.m2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m2.1.1.1.1.1" xref="S4.E1.m2.1.1.1.cmml"><mo id="S4.E1.m2.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m2.1.1.1.cmml">(</mo><mrow id="S4.E1.m2.1.1.1.1.1.1.4" xref="S4.E1.m2.1.1.1.1.1.1.5.cmml"><mo id="S4.E1.m2.1.1.1.1.1.1.4.5" stretchy="false" xref="S4.E1.m2.1.1.1.1.1.1.5.cmml">[</mo><mrow id="S4.E1.m2.1.1.1.1.1.1.1.1" xref="S4.E1.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m2.1.1.1.1.1.1.1.1.2" xref="S4.E1.m2.1.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S4.E1.m2.1.1.1.1.1.1.1.1.1" xref="S4.E1.m2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E1.m2.1.1.1.1.1.1.1.1.3" xref="S4.E1.m2.1.1.1.1.1.1.1.1.3.cmml">L</mi><mo id="S4.E1.m2.1.1.1.1.1.1.1.1.1a" xref="S4.E1.m2.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E1.m2.1.1.1.1.1.1.1.1.4" xref="S4.E1.m2.1.1.1.1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S4.E1.m2.1.1.1.1.1.1.4.6" xref="S4.E1.m2.1.1.1.1.1.1.5.cmml">;</mo><msub id="S4.E1.m2.1.1.1.1.1.1.2.2" xref="S4.E1.m2.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E1.m2.1.1.1.1.1.1.2.2.2" xref="S4.E1.m2.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="S4.E1.m2.1.1.1.1.1.1.2.2.3" xref="S4.E1.m2.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E1.m2.1.1.1.1.1.1.4.7" xref="S4.E1.m2.1.1.1.1.1.1.5.cmml">,</mo><mrow id="S4.E1.m2.1.1.1.1.1.1.3.3" xref="S4.E1.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E1.m2.1.1.1.1.1.1.3.3.2" xref="S4.E1.m2.1.1.1.1.1.1.3.3.2.cmml">S</mi><mo id="S4.E1.m2.1.1.1.1.1.1.3.3.1" xref="S4.E1.m2.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E1.m2.1.1.1.1.1.1.3.3.3" xref="S4.E1.m2.1.1.1.1.1.1.3.3.3.cmml">E</mi><mo id="S4.E1.m2.1.1.1.1.1.1.3.3.1a" xref="S4.E1.m2.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E1.m2.1.1.1.1.1.1.3.3.4" xref="S4.E1.m2.1.1.1.1.1.1.3.3.4.cmml">P</mi></mrow><mo id="S4.E1.m2.1.1.1.1.1.1.4.8" xref="S4.E1.m2.1.1.1.1.1.1.5.cmml">,</mo><msub id="S4.E1.m2.1.1.1.1.1.1.4.4" xref="S4.E1.m2.1.1.1.1.1.1.4.4.cmml"><mi id="S4.E1.m2.1.1.1.1.1.1.4.4.2" xref="S4.E1.m2.1.1.1.1.1.1.4.4.2.cmml">u</mi><mi id="S4.E1.m2.1.1.1.1.1.1.4.4.3" xref="S4.E1.m2.1.1.1.1.1.1.4.4.3.cmml">i</mi></msub><mo id="S4.E1.m2.1.1.1.1.1.1.4.9" stretchy="false" xref="S4.E1.m2.1.1.1.1.1.1.5.cmml">]</mo></mrow><mo id="S4.E1.m2.1.1.1.1.1.3" stretchy="false" xref="S4.E1.m2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m2.1b"><apply id="S4.E1.m2.1.1.cmml" xref="S4.E1.m2.1.1"><eq id="S4.E1.m2.1.1.2.cmml" xref="S4.E1.m2.1.1.2"></eq><csymbol cd="latexml" id="S4.E1.m2.1.1.3.cmml" xref="S4.E1.m2.1.1.3">absent</csymbol><apply id="S4.E1.m2.1.1.1.cmml" xref="S4.E1.m2.1.1.1"><times id="S4.E1.m2.1.1.1.2.cmml" xref="S4.E1.m2.1.1.1.2"></times><ci id="S4.E1.m2.1.1.1.3.cmml" xref="S4.E1.m2.1.1.1.3">𝐁𝐄𝐑𝐓</ci><list id="S4.E1.m2.1.1.1.1.1.1.5.cmml" xref="S4.E1.m2.1.1.1.1.1.1.4"><apply id="S4.E1.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.1.1.1.1.1.1.1.1"><times id="S4.E1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m2.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E1.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m2.1.1.1.1.1.1.1.1.2">𝐶</ci><ci id="S4.E1.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m2.1.1.1.1.1.1.1.1.3">𝐿</ci><ci id="S4.E1.m2.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E1.m2.1.1.1.1.1.1.1.1.4">𝑆</ci></apply><apply id="S4.E1.m2.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E1.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E1.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m2.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="S4.E1.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E1.m2.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E1.m2.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m2.1.1.1.1.1.1.3.3"><times id="S4.E1.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E1.m2.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E1.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E1.m2.1.1.1.1.1.1.3.3.2">𝑆</ci><ci id="S4.E1.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E1.m2.1.1.1.1.1.1.3.3.3">𝐸</ci><ci id="S4.E1.m2.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E1.m2.1.1.1.1.1.1.3.3.4">𝑃</ci></apply><apply id="S4.E1.m2.1.1.1.1.1.1.4.4.cmml" xref="S4.E1.m2.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.E1.m2.1.1.1.1.1.1.4.4.1.cmml" xref="S4.E1.m2.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="S4.E1.m2.1.1.1.1.1.1.4.4.2.cmml" xref="S4.E1.m2.1.1.1.1.1.1.4.4.2">𝑢</ci><ci id="S4.E1.m2.1.1.1.1.1.1.4.4.3.cmml" xref="S4.E1.m2.1.1.1.1.1.1.4.4.3">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m2.1c">\displaystyle=\mathbf{BERT}([CLS;c_{i},SEP,u_{i}])</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m2.1d">= bold_BERT ( [ italic_C italic_L italic_S ; italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_S italic_E italic_P , italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{S_{x}}" class="ltx_Math" display="inline" id="S4.E2.m1.1"><semantics id="S4.E2.m1.1a"><msub id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml"><mi id="S4.E2.m1.1.1.2" xref="S4.E2.m1.1.1.2.cmml">𝐒</mi><mi id="S4.E2.m1.1.1.3" xref="S4.E2.m1.1.1.3.cmml">𝐱</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.2.cmml" xref="S4.E2.m1.1.1.2">𝐒</ci><ci id="S4.E2.m1.1.1.3.cmml" xref="S4.E2.m1.1.1.3">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\displaystyle\mathbf{S_{x}}</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.1d">bold_S start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{BERT}([CLS;c_{x},SEP,u_{x}]" class="ltx_math_unparsed" display="inline" id="S4.E2.m2.1"><semantics id="S4.E2.m2.1a"><mrow id="S4.E2.m2.1b"><mo id="S4.E2.m2.1.1">=</mo><mi id="S4.E2.m2.1.2">𝐁𝐄𝐑𝐓</mi><mrow id="S4.E2.m2.1.3"><mo id="S4.E2.m2.1.3.1" stretchy="false">(</mo><mrow id="S4.E2.m2.1.3.2"><mo id="S4.E2.m2.1.3.2.1" stretchy="false">[</mo><mi id="S4.E2.m2.1.3.2.2">C</mi><mi id="S4.E2.m2.1.3.2.3">L</mi><mi id="S4.E2.m2.1.3.2.4">S</mi><mo id="S4.E2.m2.1.3.2.5">;</mo><msub id="S4.E2.m2.1.3.2.6"><mi id="S4.E2.m2.1.3.2.6.2">c</mi><mi id="S4.E2.m2.1.3.2.6.3">x</mi></msub><mo id="S4.E2.m2.1.3.2.7">,</mo><mi id="S4.E2.m2.1.3.2.8">S</mi><mi id="S4.E2.m2.1.3.2.9">E</mi><mi id="S4.E2.m2.1.3.2.10">P</mi><mo id="S4.E2.m2.1.3.2.11">,</mo><msub id="S4.E2.m2.1.3.2.12"><mi id="S4.E2.m2.1.3.2.12.2">u</mi><mi id="S4.E2.m2.1.3.2.12.3">x</mi></msub><mo id="S4.E2.m2.1.3.2.13" stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E2.m2.1c">\displaystyle=\mathbf{BERT}([CLS;c_{x},SEP,u_{x}]</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m2.1d">= bold_BERT ( [ italic_C italic_L italic_S ; italic_c start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , italic_S italic_E italic_P , italic_u start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.4">where <math alttext="c_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">c</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑐</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="u_{i}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">u</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑢</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as well as <math alttext="c_{x}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">c</mi><mi id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝑐</ci><ci id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">c_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_c start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="u_{x}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">u</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑢</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">u_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_u start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> denote the context and the incomplete utterance of i-th candidate example and the current test case. To be consistent with the inference, we do not include the rewritten utterance into representing each case.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Scoring Policy</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.4">With the representation of each case, we model the probability of each candidate case to be selected as in-context examples by metrics of cosine similarity:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p_{i}" class="ltx_Math" display="inline" id="S4.E3.m1.1"><semantics id="S4.E3.m1.1a"><msub id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><mi id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml">p</mi><mi id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2">𝑝</ci><ci id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\displaystyle p_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{exp(e_{i})}{\sum_{1\leq j\leq N}exp(e_{j})}" class="ltx_Math" display="inline" id="S4.E3.m2.2"><semantics id="S4.E3.m2.2a"><mrow id="S4.E3.m2.2.3" xref="S4.E3.m2.2.3.cmml"><mi id="S4.E3.m2.2.3.2" xref="S4.E3.m2.2.3.2.cmml"></mi><mo id="S4.E3.m2.2.3.1" xref="S4.E3.m2.2.3.1.cmml">=</mo><mstyle displaystyle="true" id="S4.E3.m2.2.2" xref="S4.E3.m2.2.2.cmml"><mfrac id="S4.E3.m2.2.2a" xref="S4.E3.m2.2.2.cmml"><mrow id="S4.E3.m2.1.1.1" xref="S4.E3.m2.1.1.1.cmml"><mi id="S4.E3.m2.1.1.1.3" xref="S4.E3.m2.1.1.1.3.cmml">e</mi><mo id="S4.E3.m2.1.1.1.2" xref="S4.E3.m2.1.1.1.2.cmml">⁢</mo><mi id="S4.E3.m2.1.1.1.4" xref="S4.E3.m2.1.1.1.4.cmml">x</mi><mo id="S4.E3.m2.1.1.1.2a" xref="S4.E3.m2.1.1.1.2.cmml">⁢</mo><mi id="S4.E3.m2.1.1.1.5" xref="S4.E3.m2.1.1.1.5.cmml">p</mi><mo id="S4.E3.m2.1.1.1.2b" xref="S4.E3.m2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m2.1.1.1.1.1" xref="S4.E3.m2.1.1.1.1.1.1.cmml"><mo id="S4.E3.m2.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E3.m2.1.1.1.1.1.1" xref="S4.E3.m2.1.1.1.1.1.1.cmml"><mi id="S4.E3.m2.1.1.1.1.1.1.2" xref="S4.E3.m2.1.1.1.1.1.1.2.cmml">e</mi><mi id="S4.E3.m2.1.1.1.1.1.1.3" xref="S4.E3.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E3.m2.1.1.1.1.1.3" stretchy="false" xref="S4.E3.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E3.m2.2.2.2" xref="S4.E3.m2.2.2.2.cmml"><msub id="S4.E3.m2.2.2.2.2" xref="S4.E3.m2.2.2.2.2.cmml"><mo id="S4.E3.m2.2.2.2.2.2" xref="S4.E3.m2.2.2.2.2.2.cmml">∑</mo><mrow id="S4.E3.m2.2.2.2.2.3" xref="S4.E3.m2.2.2.2.2.3.cmml"><mn id="S4.E3.m2.2.2.2.2.3.2" xref="S4.E3.m2.2.2.2.2.3.2.cmml">1</mn><mo id="S4.E3.m2.2.2.2.2.3.3" xref="S4.E3.m2.2.2.2.2.3.3.cmml">≤</mo><mi id="S4.E3.m2.2.2.2.2.3.4" xref="S4.E3.m2.2.2.2.2.3.4.cmml">j</mi><mo id="S4.E3.m2.2.2.2.2.3.5" xref="S4.E3.m2.2.2.2.2.3.5.cmml">≤</mo><mi id="S4.E3.m2.2.2.2.2.3.6" xref="S4.E3.m2.2.2.2.2.3.6.cmml">N</mi></mrow></msub><mrow id="S4.E3.m2.2.2.2.1" xref="S4.E3.m2.2.2.2.1.cmml"><mi id="S4.E3.m2.2.2.2.1.3" xref="S4.E3.m2.2.2.2.1.3.cmml">e</mi><mo id="S4.E3.m2.2.2.2.1.2" xref="S4.E3.m2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E3.m2.2.2.2.1.4" xref="S4.E3.m2.2.2.2.1.4.cmml">x</mi><mo id="S4.E3.m2.2.2.2.1.2a" xref="S4.E3.m2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E3.m2.2.2.2.1.5" xref="S4.E3.m2.2.2.2.1.5.cmml">p</mi><mo id="S4.E3.m2.2.2.2.1.2b" xref="S4.E3.m2.2.2.2.1.2.cmml">⁢</mo><mrow id="S4.E3.m2.2.2.2.1.1.1" xref="S4.E3.m2.2.2.2.1.1.1.1.cmml"><mo id="S4.E3.m2.2.2.2.1.1.1.2" stretchy="false" xref="S4.E3.m2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S4.E3.m2.2.2.2.1.1.1.1" xref="S4.E3.m2.2.2.2.1.1.1.1.cmml"><mi id="S4.E3.m2.2.2.2.1.1.1.1.2" xref="S4.E3.m2.2.2.2.1.1.1.1.2.cmml">e</mi><mi id="S4.E3.m2.2.2.2.1.1.1.1.3" xref="S4.E3.m2.2.2.2.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E3.m2.2.2.2.1.1.1.3" stretchy="false" xref="S4.E3.m2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m2.2b"><apply id="S4.E3.m2.2.3.cmml" xref="S4.E3.m2.2.3"><eq id="S4.E3.m2.2.3.1.cmml" xref="S4.E3.m2.2.3.1"></eq><csymbol cd="latexml" id="S4.E3.m2.2.3.2.cmml" xref="S4.E3.m2.2.3.2">absent</csymbol><apply id="S4.E3.m2.2.2.cmml" xref="S4.E3.m2.2.2"><divide id="S4.E3.m2.2.2.3.cmml" xref="S4.E3.m2.2.2"></divide><apply id="S4.E3.m2.1.1.1.cmml" xref="S4.E3.m2.1.1.1"><times id="S4.E3.m2.1.1.1.2.cmml" xref="S4.E3.m2.1.1.1.2"></times><ci id="S4.E3.m2.1.1.1.3.cmml" xref="S4.E3.m2.1.1.1.3">𝑒</ci><ci id="S4.E3.m2.1.1.1.4.cmml" xref="S4.E3.m2.1.1.1.4">𝑥</ci><ci id="S4.E3.m2.1.1.1.5.cmml" xref="S4.E3.m2.1.1.1.5">𝑝</ci><apply id="S4.E3.m2.1.1.1.1.1.1.cmml" xref="S4.E3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m2.1.1.1.1.1.1.1.cmml" xref="S4.E3.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m2.1.1.1.1.1.1.2.cmml" xref="S4.E3.m2.1.1.1.1.1.1.2">𝑒</ci><ci id="S4.E3.m2.1.1.1.1.1.1.3.cmml" xref="S4.E3.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E3.m2.2.2.2.cmml" xref="S4.E3.m2.2.2.2"><apply id="S4.E3.m2.2.2.2.2.cmml" xref="S4.E3.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.2.1.cmml" xref="S4.E3.m2.2.2.2.2">subscript</csymbol><sum id="S4.E3.m2.2.2.2.2.2.cmml" xref="S4.E3.m2.2.2.2.2.2"></sum><apply id="S4.E3.m2.2.2.2.2.3.cmml" xref="S4.E3.m2.2.2.2.2.3"><and id="S4.E3.m2.2.2.2.2.3a.cmml" xref="S4.E3.m2.2.2.2.2.3"></and><apply id="S4.E3.m2.2.2.2.2.3b.cmml" xref="S4.E3.m2.2.2.2.2.3"><leq id="S4.E3.m2.2.2.2.2.3.3.cmml" xref="S4.E3.m2.2.2.2.2.3.3"></leq><cn id="S4.E3.m2.2.2.2.2.3.2.cmml" type="integer" xref="S4.E3.m2.2.2.2.2.3.2">1</cn><ci id="S4.E3.m2.2.2.2.2.3.4.cmml" xref="S4.E3.m2.2.2.2.2.3.4">𝑗</ci></apply><apply id="S4.E3.m2.2.2.2.2.3c.cmml" xref="S4.E3.m2.2.2.2.2.3"><leq id="S4.E3.m2.2.2.2.2.3.5.cmml" xref="S4.E3.m2.2.2.2.2.3.5"></leq><share href="https://arxiv.org/html/2408.13028v1#S4.E3.m2.2.2.2.2.3.4.cmml" id="S4.E3.m2.2.2.2.2.3d.cmml" xref="S4.E3.m2.2.2.2.2.3"></share><ci id="S4.E3.m2.2.2.2.2.3.6.cmml" xref="S4.E3.m2.2.2.2.2.3.6">𝑁</ci></apply></apply></apply><apply id="S4.E3.m2.2.2.2.1.cmml" xref="S4.E3.m2.2.2.2.1"><times id="S4.E3.m2.2.2.2.1.2.cmml" xref="S4.E3.m2.2.2.2.1.2"></times><ci id="S4.E3.m2.2.2.2.1.3.cmml" xref="S4.E3.m2.2.2.2.1.3">𝑒</ci><ci id="S4.E3.m2.2.2.2.1.4.cmml" xref="S4.E3.m2.2.2.2.1.4">𝑥</ci><ci id="S4.E3.m2.2.2.2.1.5.cmml" xref="S4.E3.m2.2.2.2.1.5">𝑝</ci><apply id="S4.E3.m2.2.2.2.1.1.1.1.cmml" xref="S4.E3.m2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.1.1.1.1.1.cmml" xref="S4.E3.m2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E3.m2.2.2.2.1.1.1.1.2.cmml" xref="S4.E3.m2.2.2.2.1.1.1.1.2">𝑒</ci><ci id="S4.E3.m2.2.2.2.1.1.1.1.3.cmml" xref="S4.E3.m2.2.2.2.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m2.2c">\displaystyle=\frac{exp(e_{i})}{\sum_{1\leq j\leq N}exp(e_{j})}</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m2.2d">= divide start_ARG italic_e italic_x italic_p ( italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT 1 ≤ italic_j ≤ italic_N end_POSTSUBSCRIPT italic_e italic_x italic_p ( italic_e start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e_{i}" class="ltx_Math" display="inline" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><msub id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><mi id="S4.E4.m1.1.1.2" xref="S4.E4.m1.1.1.2.cmml">e</mi><mi id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1">subscript</csymbol><ci id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1.2">𝑒</ci><ci id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle e_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{|\mathbf{S_{i}WS_{x}}|}{\|\mathbf{S_{i}}\|*\|\mathbf{S_{x}%
}\|}" class="ltx_Math" display="inline" id="S4.E4.m2.3"><semantics id="S4.E4.m2.3a"><mrow id="S4.E4.m2.3.4" xref="S4.E4.m2.3.4.cmml"><mi id="S4.E4.m2.3.4.2" xref="S4.E4.m2.3.4.2.cmml"></mi><mo id="S4.E4.m2.3.4.1" xref="S4.E4.m2.3.4.1.cmml">=</mo><mstyle displaystyle="true" id="S4.E4.m2.3.3" xref="S4.E4.m2.3.3.cmml"><mfrac id="S4.E4.m2.3.3a" xref="S4.E4.m2.3.3.cmml"><mrow id="S4.E4.m2.1.1.1.1" xref="S4.E4.m2.1.1.1.2.cmml"><mo id="S4.E4.m2.1.1.1.1.2" stretchy="false" xref="S4.E4.m2.1.1.1.2.1.cmml">|</mo><mrow id="S4.E4.m2.1.1.1.1.1" xref="S4.E4.m2.1.1.1.1.1.cmml"><msub id="S4.E4.m2.1.1.1.1.1.2" xref="S4.E4.m2.1.1.1.1.1.2.cmml"><mi id="S4.E4.m2.1.1.1.1.1.2.2" xref="S4.E4.m2.1.1.1.1.1.2.2.cmml">𝐒</mi><mi id="S4.E4.m2.1.1.1.1.1.2.3" xref="S4.E4.m2.1.1.1.1.1.2.3.cmml">𝐢</mi></msub><mo id="S4.E4.m2.1.1.1.1.1.1" xref="S4.E4.m2.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E4.m2.1.1.1.1.1.3" xref="S4.E4.m2.1.1.1.1.1.3.cmml"><mi id="S4.E4.m2.1.1.1.1.1.3.2" xref="S4.E4.m2.1.1.1.1.1.3.2.cmml">𝐖𝐒</mi><mi id="S4.E4.m2.1.1.1.1.1.3.3" xref="S4.E4.m2.1.1.1.1.1.3.3.cmml">𝐱</mi></msub></mrow><mo id="S4.E4.m2.1.1.1.1.3" stretchy="false" xref="S4.E4.m2.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S4.E4.m2.3.3.3" xref="S4.E4.m2.3.3.3.cmml"><mrow id="S4.E4.m2.2.2.2.1.1" xref="S4.E4.m2.2.2.2.1.2.cmml"><mo id="S4.E4.m2.2.2.2.1.1.2" stretchy="false" xref="S4.E4.m2.2.2.2.1.2.1.cmml">‖</mo><msub id="S4.E4.m2.2.2.2.1.1.1" xref="S4.E4.m2.2.2.2.1.1.1.cmml"><mi id="S4.E4.m2.2.2.2.1.1.1.2" xref="S4.E4.m2.2.2.2.1.1.1.2.cmml">𝐒</mi><mi id="S4.E4.m2.2.2.2.1.1.1.3" xref="S4.E4.m2.2.2.2.1.1.1.3.cmml">𝐢</mi></msub><mo id="S4.E4.m2.2.2.2.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E4.m2.2.2.2.1.2.1.cmml">‖</mo></mrow><mo id="S4.E4.m2.3.3.3.3" rspace="0.222em" xref="S4.E4.m2.3.3.3.3.cmml">∗</mo><mrow id="S4.E4.m2.3.3.3.2.1" xref="S4.E4.m2.3.3.3.2.2.cmml"><mo id="S4.E4.m2.3.3.3.2.1.2" stretchy="false" xref="S4.E4.m2.3.3.3.2.2.1.cmml">‖</mo><msub id="S4.E4.m2.3.3.3.2.1.1" xref="S4.E4.m2.3.3.3.2.1.1.cmml"><mi id="S4.E4.m2.3.3.3.2.1.1.2" xref="S4.E4.m2.3.3.3.2.1.1.2.cmml">𝐒</mi><mi id="S4.E4.m2.3.3.3.2.1.1.3" xref="S4.E4.m2.3.3.3.2.1.1.3.cmml">𝐱</mi></msub><mo id="S4.E4.m2.3.3.3.2.1.3" stretchy="false" xref="S4.E4.m2.3.3.3.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m2.3b"><apply id="S4.E4.m2.3.4.cmml" xref="S4.E4.m2.3.4"><eq id="S4.E4.m2.3.4.1.cmml" xref="S4.E4.m2.3.4.1"></eq><csymbol cd="latexml" id="S4.E4.m2.3.4.2.cmml" xref="S4.E4.m2.3.4.2">absent</csymbol><apply id="S4.E4.m2.3.3.cmml" xref="S4.E4.m2.3.3"><divide id="S4.E4.m2.3.3.4.cmml" xref="S4.E4.m2.3.3"></divide><apply id="S4.E4.m2.1.1.1.2.cmml" xref="S4.E4.m2.1.1.1.1"><abs id="S4.E4.m2.1.1.1.2.1.cmml" xref="S4.E4.m2.1.1.1.1.2"></abs><apply id="S4.E4.m2.1.1.1.1.1.cmml" xref="S4.E4.m2.1.1.1.1.1"><times id="S4.E4.m2.1.1.1.1.1.1.cmml" xref="S4.E4.m2.1.1.1.1.1.1"></times><apply id="S4.E4.m2.1.1.1.1.1.2.cmml" xref="S4.E4.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m2.1.1.1.1.1.2.1.cmml" xref="S4.E4.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m2.1.1.1.1.1.2.2.cmml" xref="S4.E4.m2.1.1.1.1.1.2.2">𝐒</ci><ci id="S4.E4.m2.1.1.1.1.1.2.3.cmml" xref="S4.E4.m2.1.1.1.1.1.2.3">𝐢</ci></apply><apply id="S4.E4.m2.1.1.1.1.1.3.cmml" xref="S4.E4.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m2.1.1.1.1.1.3.1.cmml" xref="S4.E4.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m2.1.1.1.1.1.3.2.cmml" xref="S4.E4.m2.1.1.1.1.1.3.2">𝐖𝐒</ci><ci id="S4.E4.m2.1.1.1.1.1.3.3.cmml" xref="S4.E4.m2.1.1.1.1.1.3.3">𝐱</ci></apply></apply></apply><apply id="S4.E4.m2.3.3.3.cmml" xref="S4.E4.m2.3.3.3"><times id="S4.E4.m2.3.3.3.3.cmml" xref="S4.E4.m2.3.3.3.3"></times><apply id="S4.E4.m2.2.2.2.1.2.cmml" xref="S4.E4.m2.2.2.2.1.1"><csymbol cd="latexml" id="S4.E4.m2.2.2.2.1.2.1.cmml" xref="S4.E4.m2.2.2.2.1.1.2">norm</csymbol><apply id="S4.E4.m2.2.2.2.1.1.1.cmml" xref="S4.E4.m2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.2.1.1.1.1.cmml" xref="S4.E4.m2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E4.m2.2.2.2.1.1.1.2.cmml" xref="S4.E4.m2.2.2.2.1.1.1.2">𝐒</ci><ci id="S4.E4.m2.2.2.2.1.1.1.3.cmml" xref="S4.E4.m2.2.2.2.1.1.1.3">𝐢</ci></apply></apply><apply id="S4.E4.m2.3.3.3.2.2.cmml" xref="S4.E4.m2.3.3.3.2.1"><csymbol cd="latexml" id="S4.E4.m2.3.3.3.2.2.1.cmml" xref="S4.E4.m2.3.3.3.2.1.2">norm</csymbol><apply id="S4.E4.m2.3.3.3.2.1.1.cmml" xref="S4.E4.m2.3.3.3.2.1.1"><csymbol cd="ambiguous" id="S4.E4.m2.3.3.3.2.1.1.1.cmml" xref="S4.E4.m2.3.3.3.2.1.1">subscript</csymbol><ci id="S4.E4.m2.3.3.3.2.1.1.2.cmml" xref="S4.E4.m2.3.3.3.2.1.1.2">𝐒</ci><ci id="S4.E4.m2.3.3.3.2.1.1.3.cmml" xref="S4.E4.m2.3.3.3.2.1.1.3">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m2.3c">\displaystyle=\frac{|\mathbf{S_{i}WS_{x}}|}{\|\mathbf{S_{i}}\|*\|\mathbf{S_{x}%
}\|}</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m2.3d">= divide start_ARG | bold_S start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT bold_WS start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT | end_ARG start_ARG ∥ bold_S start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT ∥ ∗ ∥ bold_S start_POSTSUBSCRIPT bold_x end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.3">where <math alttext="\|.\|" class="ltx_math_unparsed" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1b"><mo id="S4.SS2.p1.1.m1.1.1" rspace="0.0835em">∥</mo><mo id="S4.SS2.p1.1.m1.1.2" lspace="0.0835em" rspace="0.0835em">.</mo><mo id="S4.SS2.p1.1.m1.1.3" lspace="0.0835em">∥</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\|.\|</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">∥ . ∥</annotation></semantics></math> denotes L2 norm, <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_N</annotation></semantics></math> denotes the number of candidate examples. We sample <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_k</annotation></semantics></math> demonstration examples according to the probability computed.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.1">
<tr class="ltx_tr" id="S4.T3.1.1">
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T3.1.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.2">CANARD</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3">TASK</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.4">REWRITE</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.1.2.1">Language</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.2.2">English</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.2.3">English</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.4">Chinese</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.1.3.1"># Train</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.3.2">32K</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.3.3">2.2K</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.4">18K</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.1.4.1"># Dev</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.4.2">4K</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.4.3">0.5K</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.4">2K</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.1.5.1"># Test</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.5.2">6K</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.5.3">NA</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.5.4">NA</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.1.6.1">Con. len</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.6.2">85.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.6.3">52.6</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.4">17.7</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.1.7.1">Cur. len</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.7.2">7.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.7.3">9.4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.7.4">6.5</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T3.1.8.1">Rew. len</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.8.2">11.6</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.8.3">11.3</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.8.4">10.5</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span> Statistics of datasets. “Con. len”, “Cur. len”, “Rew. len” denote the length of contexts, incomplete utterance and rewritten utterance respectively.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Policy Iterating</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Intuitively, if a subset of candidate examples leads to increasing performance of LLM to rewrite the current incomplete utterance, RLS should assign high scores to them; the more the performance
increases, the higher the example scores should be. For each case in training set, we input the demonstration formulated as section <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S3" title="3 Task Definition ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">3</span></a> containing the examples selected by the current policy into the LLM. The performance metrics of outputs from the LLM against the golden rewritten utterance are utilized as the rewards of the policy.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.5">To maximum the expected rewards of the current policy, we compute the gradient of policy as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\nabla E_{s\sim p(s)}R(s)" class="ltx_Math" display="inline" id="S4.Ex1.m1.2"><semantics id="S4.Ex1.m1.2a"><mrow id="S4.Ex1.m1.2.3" xref="S4.Ex1.m1.2.3.cmml"><mrow id="S4.Ex1.m1.2.3.2" xref="S4.Ex1.m1.2.3.2.cmml"><mo id="S4.Ex1.m1.2.3.2.1" rspace="0.167em" xref="S4.Ex1.m1.2.3.2.1.cmml">∇</mo><mrow id="S4.Ex1.m1.2.3.2.2" xref="S4.Ex1.m1.2.3.2.2.cmml"><msub id="S4.Ex1.m1.2.3.2.2.2" xref="S4.Ex1.m1.2.3.2.2.2.cmml"><mi id="S4.Ex1.m1.2.3.2.2.2.2" xref="S4.Ex1.m1.2.3.2.2.2.2.cmml">E</mi><mrow id="S4.Ex1.m1.1.1.1" xref="S4.Ex1.m1.1.1.1.cmml"><mi id="S4.Ex1.m1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.3.cmml">s</mi><mo id="S4.Ex1.m1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.2.cmml">∼</mo><mrow id="S4.Ex1.m1.1.1.1.4" xref="S4.Ex1.m1.1.1.1.4.cmml"><mi id="S4.Ex1.m1.1.1.1.4.2" xref="S4.Ex1.m1.1.1.1.4.2.cmml">p</mi><mo id="S4.Ex1.m1.1.1.1.4.1" xref="S4.Ex1.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S4.Ex1.m1.1.1.1.4.3.2" xref="S4.Ex1.m1.1.1.1.4.cmml"><mo id="S4.Ex1.m1.1.1.1.4.3.2.1" stretchy="false" xref="S4.Ex1.m1.1.1.1.4.cmml">(</mo><mi id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml">s</mi><mo id="S4.Ex1.m1.1.1.1.4.3.2.2" stretchy="false" xref="S4.Ex1.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S4.Ex1.m1.2.3.2.2.1" xref="S4.Ex1.m1.2.3.2.2.1.cmml">⁢</mo><mi id="S4.Ex1.m1.2.3.2.2.3" xref="S4.Ex1.m1.2.3.2.2.3.cmml">R</mi></mrow></mrow><mo id="S4.Ex1.m1.2.3.1" xref="S4.Ex1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.Ex1.m1.2.3.3.2" xref="S4.Ex1.m1.2.3.cmml"><mo id="S4.Ex1.m1.2.3.3.2.1" stretchy="false" xref="S4.Ex1.m1.2.3.cmml">(</mo><mi id="S4.Ex1.m1.2.2" xref="S4.Ex1.m1.2.2.cmml">s</mi><mo id="S4.Ex1.m1.2.3.3.2.2" stretchy="false" xref="S4.Ex1.m1.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.2b"><apply id="S4.Ex1.m1.2.3.cmml" xref="S4.Ex1.m1.2.3"><times id="S4.Ex1.m1.2.3.1.cmml" xref="S4.Ex1.m1.2.3.1"></times><apply id="S4.Ex1.m1.2.3.2.cmml" xref="S4.Ex1.m1.2.3.2"><ci id="S4.Ex1.m1.2.3.2.1.cmml" xref="S4.Ex1.m1.2.3.2.1">∇</ci><apply id="S4.Ex1.m1.2.3.2.2.cmml" xref="S4.Ex1.m1.2.3.2.2"><times id="S4.Ex1.m1.2.3.2.2.1.cmml" xref="S4.Ex1.m1.2.3.2.2.1"></times><apply id="S4.Ex1.m1.2.3.2.2.2.cmml" xref="S4.Ex1.m1.2.3.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.3.2.2.2.1.cmml" xref="S4.Ex1.m1.2.3.2.2.2">subscript</csymbol><ci id="S4.Ex1.m1.2.3.2.2.2.2.cmml" xref="S4.Ex1.m1.2.3.2.2.2.2">𝐸</ci><apply id="S4.Ex1.m1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1"><csymbol cd="latexml" id="S4.Ex1.m1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.2">similar-to</csymbol><ci id="S4.Ex1.m1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.3">𝑠</ci><apply id="S4.Ex1.m1.1.1.1.4.cmml" xref="S4.Ex1.m1.1.1.1.4"><times id="S4.Ex1.m1.1.1.1.4.1.cmml" xref="S4.Ex1.m1.1.1.1.4.1"></times><ci id="S4.Ex1.m1.1.1.1.4.2.cmml" xref="S4.Ex1.m1.1.1.1.4.2">𝑝</ci><ci id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">𝑠</ci></apply></apply></apply><ci id="S4.Ex1.m1.2.3.2.2.3.cmml" xref="S4.Ex1.m1.2.3.2.2.3">𝑅</ci></apply></apply><ci id="S4.Ex1.m1.2.2.cmml" xref="S4.Ex1.m1.2.2">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.2c">\displaystyle\nabla E_{s\sim p(s)}R(s)</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.2d">∇ italic_E start_POSTSUBSCRIPT italic_s ∼ italic_p ( italic_s ) end_POSTSUBSCRIPT italic_R ( italic_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int\nabla(p(s)R(s))ds" class="ltx_Math" display="inline" id="S4.Ex2.m1.4"><semantics id="S4.Ex2.m1.4a"><mrow id="S4.Ex2.m1.4.4" xref="S4.Ex2.m1.4.4.cmml"><mi id="S4.Ex2.m1.4.4.3" xref="S4.Ex2.m1.4.4.3.cmml"></mi><mo id="S4.Ex2.m1.4.4.2" xref="S4.Ex2.m1.4.4.2.cmml">=</mo><mstyle displaystyle="true" id="S4.Ex2.m1.4.4.1" xref="S4.Ex2.m1.4.4.1.cmml"><mrow id="S4.Ex2.m1.4.4.1a" xref="S4.Ex2.m1.4.4.1.cmml"><mo id="S4.Ex2.m1.4.4.1.2" xref="S4.Ex2.m1.4.4.1.2.cmml">∫</mo><mrow id="S4.Ex2.m1.4.4.1.1" xref="S4.Ex2.m1.4.4.1.1.cmml"><mrow id="S4.Ex2.m1.4.4.1.1.1.1" xref="S4.Ex2.m1.4.4.1.1.1.2.cmml"><mo id="S4.Ex2.m1.3.3" xref="S4.Ex2.m1.3.3.cmml">∇</mo><mrow id="S4.Ex2.m1.4.4.1.1.1.1.1" xref="S4.Ex2.m1.4.4.1.1.1.2.cmml"><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S4.Ex2.m1.4.4.1.1.1.2.cmml">(</mo><mrow id="S4.Ex2.m1.4.4.1.1.1.1.1.1" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S4.Ex2.m1.4.4.1.1.1.1.1.1.2" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.2.cmml">p</mi><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.1.1" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex2.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml">s</mi><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.1.1a" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex2.m1.4.4.1.1.1.1.1.1.4" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.4.cmml">R</mi><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.1.1b" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex2.m1.4.4.1.1.1.1.1.1.5.2" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.1.5.2.1" stretchy="false" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S4.Ex2.m1.2.2" xref="S4.Ex2.m1.2.2.cmml">s</mi><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.1.5.2.2" stretchy="false" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S4.Ex2.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.4.4.1.1a" xref="S4.Ex2.m1.4.4.1.1.cmml">⁡</mo><mrow id="S4.Ex2.m1.4.4.1.1.2" xref="S4.Ex2.m1.4.4.1.1.2.cmml"><mi id="S4.Ex2.m1.4.4.1.1.2.2" xref="S4.Ex2.m1.4.4.1.1.2.2.cmml">d</mi><mo id="S4.Ex2.m1.4.4.1.1.2.1" xref="S4.Ex2.m1.4.4.1.1.2.1.cmml">⁢</mo><mi id="S4.Ex2.m1.4.4.1.1.2.3" xref="S4.Ex2.m1.4.4.1.1.2.3.cmml">s</mi></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.4b"><apply id="S4.Ex2.m1.4.4.cmml" xref="S4.Ex2.m1.4.4"><eq id="S4.Ex2.m1.4.4.2.cmml" xref="S4.Ex2.m1.4.4.2"></eq><csymbol cd="latexml" id="S4.Ex2.m1.4.4.3.cmml" xref="S4.Ex2.m1.4.4.3">absent</csymbol><apply id="S4.Ex2.m1.4.4.1.cmml" xref="S4.Ex2.m1.4.4.1"><int id="S4.Ex2.m1.4.4.1.2.cmml" xref="S4.Ex2.m1.4.4.1.2"></int><apply id="S4.Ex2.m1.4.4.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1"><apply id="S4.Ex2.m1.4.4.1.1.1.2.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1"><ci id="S4.Ex2.m1.3.3.cmml" xref="S4.Ex2.m1.3.3">∇</ci><apply id="S4.Ex2.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1"><times id="S4.Ex2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.1"></times><ci id="S4.Ex2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1">𝑠</ci><ci id="S4.Ex2.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S4.Ex2.m1.4.4.1.1.1.1.1.1.4">𝑅</ci><ci id="S4.Ex2.m1.2.2.cmml" xref="S4.Ex2.m1.2.2">𝑠</ci></apply></apply><apply id="S4.Ex2.m1.4.4.1.1.2.cmml" xref="S4.Ex2.m1.4.4.1.1.2"><times id="S4.Ex2.m1.4.4.1.1.2.1.cmml" xref="S4.Ex2.m1.4.4.1.1.2.1"></times><ci id="S4.Ex2.m1.4.4.1.1.2.2.cmml" xref="S4.Ex2.m1.4.4.1.1.2.2">𝑑</ci><ci id="S4.Ex2.m1.4.4.1.1.2.3.cmml" xref="S4.Ex2.m1.4.4.1.1.2.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.4c">\displaystyle=\int\nabla(p(s)R(s))ds</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.4d">= ∫ ∇ ( italic_p ( italic_s ) italic_R ( italic_s ) ) italic_d italic_s</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int p(s)\nabla(log(p(s))R(s))ds" class="ltx_Math" display="inline" id="S4.Ex3.m1.5"><semantics id="S4.Ex3.m1.5a"><mrow id="S4.Ex3.m1.5.5" xref="S4.Ex3.m1.5.5.cmml"><mi id="S4.Ex3.m1.5.5.3" xref="S4.Ex3.m1.5.5.3.cmml"></mi><mo id="S4.Ex3.m1.5.5.2" xref="S4.Ex3.m1.5.5.2.cmml">=</mo><mstyle displaystyle="true" id="S4.Ex3.m1.5.5.1" xref="S4.Ex3.m1.5.5.1.cmml"><mrow id="S4.Ex3.m1.5.5.1a" xref="S4.Ex3.m1.5.5.1.cmml"><mo id="S4.Ex3.m1.5.5.1.2" xref="S4.Ex3.m1.5.5.1.2.cmml">∫</mo><mrow id="S4.Ex3.m1.5.5.1.1" xref="S4.Ex3.m1.5.5.1.1.cmml"><mi id="S4.Ex3.m1.5.5.1.1.3" xref="S4.Ex3.m1.5.5.1.1.3.cmml">p</mi><mo id="S4.Ex3.m1.5.5.1.1.2" xref="S4.Ex3.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.5.5.1.1.4.2" xref="S4.Ex3.m1.5.5.1.1.cmml"><mo id="S4.Ex3.m1.5.5.1.1.4.2.1" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.cmml">(</mo><mi id="S4.Ex3.m1.1.1" xref="S4.Ex3.m1.1.1.cmml">s</mi><mo id="S4.Ex3.m1.5.5.1.1.4.2.2" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.cmml">)</mo></mrow><mo id="S4.Ex3.m1.5.5.1.1.2a" lspace="0.167em" xref="S4.Ex3.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.5.5.1.1.1" xref="S4.Ex3.m1.5.5.1.1.1.cmml"><mrow id="S4.Ex3.m1.5.5.1.1.1.1.1" xref="S4.Ex3.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.Ex3.m1.4.4" xref="S4.Ex3.m1.4.4.cmml">∇</mo><mrow id="S4.Ex3.m1.5.5.1.1.1.1.1.1" xref="S4.Ex3.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.1.1.2.cmml">(</mo><mrow id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.3.cmml">l</mi><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.4" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.4.cmml">o</mi><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2a" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.5" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.5.cmml">g</mi><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2b" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.Ex3.m1.2.2" xref="S4.Ex3.m1.2.2.cmml">s</mi><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2c" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.6" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.6.cmml">R</mi><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2d" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.7.2" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.7.2.1" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.Ex3.m1.3.3" xref="S4.Ex3.m1.3.3.cmml">s</mi><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.7.2.2" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex3.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m1.5.5.1.1.1a" xref="S4.Ex3.m1.5.5.1.1.1.cmml">⁡</mo><mrow id="S4.Ex3.m1.5.5.1.1.1.2" xref="S4.Ex3.m1.5.5.1.1.1.2.cmml"><mi id="S4.Ex3.m1.5.5.1.1.1.2.2" xref="S4.Ex3.m1.5.5.1.1.1.2.2.cmml">d</mi><mo id="S4.Ex3.m1.5.5.1.1.1.2.1" xref="S4.Ex3.m1.5.5.1.1.1.2.1.cmml">⁢</mo><mi id="S4.Ex3.m1.5.5.1.1.1.2.3" xref="S4.Ex3.m1.5.5.1.1.1.2.3.cmml">s</mi></mrow></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.5b"><apply id="S4.Ex3.m1.5.5.cmml" xref="S4.Ex3.m1.5.5"><eq id="S4.Ex3.m1.5.5.2.cmml" xref="S4.Ex3.m1.5.5.2"></eq><csymbol cd="latexml" id="S4.Ex3.m1.5.5.3.cmml" xref="S4.Ex3.m1.5.5.3">absent</csymbol><apply id="S4.Ex3.m1.5.5.1.cmml" xref="S4.Ex3.m1.5.5.1"><int id="S4.Ex3.m1.5.5.1.2.cmml" xref="S4.Ex3.m1.5.5.1.2"></int><apply id="S4.Ex3.m1.5.5.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1"><times id="S4.Ex3.m1.5.5.1.1.2.cmml" xref="S4.Ex3.m1.5.5.1.1.2"></times><ci id="S4.Ex3.m1.5.5.1.1.3.cmml" xref="S4.Ex3.m1.5.5.1.1.3">𝑝</ci><ci id="S4.Ex3.m1.1.1.cmml" xref="S4.Ex3.m1.1.1">𝑠</ci><apply id="S4.Ex3.m1.5.5.1.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1.1"><apply id="S4.Ex3.m1.5.5.1.1.1.1.2.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1"><ci id="S4.Ex3.m1.4.4.cmml" xref="S4.Ex3.m1.4.4">∇</ci><apply id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1"><times id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.3">𝑙</ci><ci id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.4">𝑜</ci><ci id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.5.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.5">𝑔</ci><apply id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1"><times id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.Ex3.m1.2.2.cmml" xref="S4.Ex3.m1.2.2">𝑠</ci></apply><ci id="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.6.cmml" xref="S4.Ex3.m1.5.5.1.1.1.1.1.1.1.6">𝑅</ci><ci id="S4.Ex3.m1.3.3.cmml" xref="S4.Ex3.m1.3.3">𝑠</ci></apply></apply><apply id="S4.Ex3.m1.5.5.1.1.1.2.cmml" xref="S4.Ex3.m1.5.5.1.1.1.2"><times id="S4.Ex3.m1.5.5.1.1.1.2.1.cmml" xref="S4.Ex3.m1.5.5.1.1.1.2.1"></times><ci id="S4.Ex3.m1.5.5.1.1.1.2.2.cmml" xref="S4.Ex3.m1.5.5.1.1.1.2.2">𝑑</ci><ci id="S4.Ex3.m1.5.5.1.1.1.2.3.cmml" xref="S4.Ex3.m1.5.5.1.1.1.2.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.5c">\displaystyle=\int p(s)\nabla(log(p(s))R(s))ds</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.5d">= ∫ italic_p ( italic_s ) ∇ ( italic_l italic_o italic_g ( italic_p ( italic_s ) ) italic_R ( italic_s ) ) italic_d italic_s</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=E_{s\sim p(s)}\nabla log(p(s))R(s)" class="ltx_Math" display="inline" id="S4.Ex4.m1.4"><semantics id="S4.Ex4.m1.4a"><mrow id="S4.Ex4.m1.4.4" xref="S4.Ex4.m1.4.4.cmml"><mi id="S4.Ex4.m1.4.4.3" xref="S4.Ex4.m1.4.4.3.cmml"></mi><mo id="S4.Ex4.m1.4.4.2" xref="S4.Ex4.m1.4.4.2.cmml">=</mo><mrow id="S4.Ex4.m1.4.4.1" xref="S4.Ex4.m1.4.4.1.cmml"><msub id="S4.Ex4.m1.4.4.1.3" xref="S4.Ex4.m1.4.4.1.3.cmml"><mi id="S4.Ex4.m1.4.4.1.3.2" xref="S4.Ex4.m1.4.4.1.3.2.cmml">E</mi><mrow id="S4.Ex4.m1.1.1.1" xref="S4.Ex4.m1.1.1.1.cmml"><mi id="S4.Ex4.m1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.3.cmml">s</mi><mo id="S4.Ex4.m1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.2.cmml">∼</mo><mrow id="S4.Ex4.m1.1.1.1.4" xref="S4.Ex4.m1.1.1.1.4.cmml"><mi id="S4.Ex4.m1.1.1.1.4.2" xref="S4.Ex4.m1.1.1.1.4.2.cmml">p</mi><mo id="S4.Ex4.m1.1.1.1.4.1" xref="S4.Ex4.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S4.Ex4.m1.1.1.1.4.3.2" xref="S4.Ex4.m1.1.1.1.4.cmml"><mo id="S4.Ex4.m1.1.1.1.4.3.2.1" stretchy="false" xref="S4.Ex4.m1.1.1.1.4.cmml">(</mo><mi id="S4.Ex4.m1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.cmml">s</mi><mo id="S4.Ex4.m1.1.1.1.4.3.2.2" stretchy="false" xref="S4.Ex4.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S4.Ex4.m1.4.4.1.2" lspace="0.167em" xref="S4.Ex4.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.Ex4.m1.4.4.1.4" xref="S4.Ex4.m1.4.4.1.4.cmml"><mo id="S4.Ex4.m1.4.4.1.4.1" rspace="0.167em" xref="S4.Ex4.m1.4.4.1.4.1.cmml">∇</mo><mrow id="S4.Ex4.m1.4.4.1.4.2" xref="S4.Ex4.m1.4.4.1.4.2.cmml"><mi id="S4.Ex4.m1.4.4.1.4.2.2" xref="S4.Ex4.m1.4.4.1.4.2.2.cmml">l</mi><mo id="S4.Ex4.m1.4.4.1.4.2.1" xref="S4.Ex4.m1.4.4.1.4.2.1.cmml">⁢</mo><mi id="S4.Ex4.m1.4.4.1.4.2.3" xref="S4.Ex4.m1.4.4.1.4.2.3.cmml">o</mi><mo id="S4.Ex4.m1.4.4.1.4.2.1a" xref="S4.Ex4.m1.4.4.1.4.2.1.cmml">⁢</mo><mi id="S4.Ex4.m1.4.4.1.4.2.4" xref="S4.Ex4.m1.4.4.1.4.2.4.cmml">g</mi></mrow></mrow><mo id="S4.Ex4.m1.4.4.1.2a" xref="S4.Ex4.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.Ex4.m1.4.4.1.1.1" xref="S4.Ex4.m1.4.4.1.1.1.1.cmml"><mo id="S4.Ex4.m1.4.4.1.1.1.2" stretchy="false" xref="S4.Ex4.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.Ex4.m1.4.4.1.1.1.1" xref="S4.Ex4.m1.4.4.1.1.1.1.cmml"><mi id="S4.Ex4.m1.4.4.1.1.1.1.2" xref="S4.Ex4.m1.4.4.1.1.1.1.2.cmml">p</mi><mo id="S4.Ex4.m1.4.4.1.1.1.1.1" xref="S4.Ex4.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex4.m1.4.4.1.1.1.1.3.2" xref="S4.Ex4.m1.4.4.1.1.1.1.cmml"><mo id="S4.Ex4.m1.4.4.1.1.1.1.3.2.1" stretchy="false" xref="S4.Ex4.m1.4.4.1.1.1.1.cmml">(</mo><mi id="S4.Ex4.m1.2.2" xref="S4.Ex4.m1.2.2.cmml">s</mi><mo id="S4.Ex4.m1.4.4.1.1.1.1.3.2.2" stretchy="false" xref="S4.Ex4.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex4.m1.4.4.1.1.1.3" stretchy="false" xref="S4.Ex4.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex4.m1.4.4.1.2b" xref="S4.Ex4.m1.4.4.1.2.cmml">⁢</mo><mi id="S4.Ex4.m1.4.4.1.5" xref="S4.Ex4.m1.4.4.1.5.cmml">R</mi><mo id="S4.Ex4.m1.4.4.1.2c" xref="S4.Ex4.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.Ex4.m1.4.4.1.6.2" xref="S4.Ex4.m1.4.4.1.cmml"><mo id="S4.Ex4.m1.4.4.1.6.2.1" stretchy="false" xref="S4.Ex4.m1.4.4.1.cmml">(</mo><mi id="S4.Ex4.m1.3.3" xref="S4.Ex4.m1.3.3.cmml">s</mi><mo id="S4.Ex4.m1.4.4.1.6.2.2" stretchy="false" xref="S4.Ex4.m1.4.4.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.4b"><apply id="S4.Ex4.m1.4.4.cmml" xref="S4.Ex4.m1.4.4"><eq id="S4.Ex4.m1.4.4.2.cmml" xref="S4.Ex4.m1.4.4.2"></eq><csymbol cd="latexml" id="S4.Ex4.m1.4.4.3.cmml" xref="S4.Ex4.m1.4.4.3">absent</csymbol><apply id="S4.Ex4.m1.4.4.1.cmml" xref="S4.Ex4.m1.4.4.1"><times id="S4.Ex4.m1.4.4.1.2.cmml" xref="S4.Ex4.m1.4.4.1.2"></times><apply id="S4.Ex4.m1.4.4.1.3.cmml" xref="S4.Ex4.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.1.3.1.cmml" xref="S4.Ex4.m1.4.4.1.3">subscript</csymbol><ci id="S4.Ex4.m1.4.4.1.3.2.cmml" xref="S4.Ex4.m1.4.4.1.3.2">𝐸</ci><apply id="S4.Ex4.m1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1"><csymbol cd="latexml" id="S4.Ex4.m1.1.1.1.2.cmml" xref="S4.Ex4.m1.1.1.1.2">similar-to</csymbol><ci id="S4.Ex4.m1.1.1.1.3.cmml" xref="S4.Ex4.m1.1.1.1.3">𝑠</ci><apply id="S4.Ex4.m1.1.1.1.4.cmml" xref="S4.Ex4.m1.1.1.1.4"><times id="S4.Ex4.m1.1.1.1.4.1.cmml" xref="S4.Ex4.m1.1.1.1.4.1"></times><ci id="S4.Ex4.m1.1.1.1.4.2.cmml" xref="S4.Ex4.m1.1.1.1.4.2">𝑝</ci><ci id="S4.Ex4.m1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1">𝑠</ci></apply></apply></apply><apply id="S4.Ex4.m1.4.4.1.4.cmml" xref="S4.Ex4.m1.4.4.1.4"><ci id="S4.Ex4.m1.4.4.1.4.1.cmml" xref="S4.Ex4.m1.4.4.1.4.1">∇</ci><apply id="S4.Ex4.m1.4.4.1.4.2.cmml" xref="S4.Ex4.m1.4.4.1.4.2"><times id="S4.Ex4.m1.4.4.1.4.2.1.cmml" xref="S4.Ex4.m1.4.4.1.4.2.1"></times><ci id="S4.Ex4.m1.4.4.1.4.2.2.cmml" xref="S4.Ex4.m1.4.4.1.4.2.2">𝑙</ci><ci id="S4.Ex4.m1.4.4.1.4.2.3.cmml" xref="S4.Ex4.m1.4.4.1.4.2.3">𝑜</ci><ci id="S4.Ex4.m1.4.4.1.4.2.4.cmml" xref="S4.Ex4.m1.4.4.1.4.2.4">𝑔</ci></apply></apply><apply id="S4.Ex4.m1.4.4.1.1.1.1.cmml" xref="S4.Ex4.m1.4.4.1.1.1"><times id="S4.Ex4.m1.4.4.1.1.1.1.1.cmml" xref="S4.Ex4.m1.4.4.1.1.1.1.1"></times><ci id="S4.Ex4.m1.4.4.1.1.1.1.2.cmml" xref="S4.Ex4.m1.4.4.1.1.1.1.2">𝑝</ci><ci id="S4.Ex4.m1.2.2.cmml" xref="S4.Ex4.m1.2.2">𝑠</ci></apply><ci id="S4.Ex4.m1.4.4.1.5.cmml" xref="S4.Ex4.m1.4.4.1.5">𝑅</ci><ci id="S4.Ex4.m1.3.3.cmml" xref="S4.Ex4.m1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.4c">\displaystyle=E_{s\sim p(s)}\nabla log(p(s))R(s)</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m1.4d">= italic_E start_POSTSUBSCRIPT italic_s ∼ italic_p ( italic_s ) end_POSTSUBSCRIPT ∇ italic_l italic_o italic_g ( italic_p ( italic_s ) ) italic_R ( italic_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=E_{s\sim p(s)}\sum_{t=1}^{K}\nabla log(p(a_{t}|s_{t}))(\sum_{t=1%
}^{K}R(a_{t},s_{t}))" class="ltx_Math" display="inline" id="S4.Ex5.m1.3"><semantics id="S4.Ex5.m1.3a"><mrow id="S4.Ex5.m1.3.3" xref="S4.Ex5.m1.3.3.cmml"><mi id="S4.Ex5.m1.3.3.4" xref="S4.Ex5.m1.3.3.4.cmml"></mi><mo id="S4.Ex5.m1.3.3.3" xref="S4.Ex5.m1.3.3.3.cmml">=</mo><mrow id="S4.Ex5.m1.3.3.2" xref="S4.Ex5.m1.3.3.2.cmml"><msub id="S4.Ex5.m1.3.3.2.4" xref="S4.Ex5.m1.3.3.2.4.cmml"><mi id="S4.Ex5.m1.3.3.2.4.2" xref="S4.Ex5.m1.3.3.2.4.2.cmml">E</mi><mrow id="S4.Ex5.m1.1.1.1" xref="S4.Ex5.m1.1.1.1.cmml"><mi id="S4.Ex5.m1.1.1.1.3" xref="S4.Ex5.m1.1.1.1.3.cmml">s</mi><mo id="S4.Ex5.m1.1.1.1.2" xref="S4.Ex5.m1.1.1.1.2.cmml">∼</mo><mrow id="S4.Ex5.m1.1.1.1.4" xref="S4.Ex5.m1.1.1.1.4.cmml"><mi id="S4.Ex5.m1.1.1.1.4.2" xref="S4.Ex5.m1.1.1.1.4.2.cmml">p</mi><mo id="S4.Ex5.m1.1.1.1.4.1" xref="S4.Ex5.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S4.Ex5.m1.1.1.1.4.3.2" xref="S4.Ex5.m1.1.1.1.4.cmml"><mo id="S4.Ex5.m1.1.1.1.4.3.2.1" stretchy="false" xref="S4.Ex5.m1.1.1.1.4.cmml">(</mo><mi id="S4.Ex5.m1.1.1.1.1" xref="S4.Ex5.m1.1.1.1.1.cmml">s</mi><mo id="S4.Ex5.m1.1.1.1.4.3.2.2" stretchy="false" xref="S4.Ex5.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S4.Ex5.m1.3.3.2.3" xref="S4.Ex5.m1.3.3.2.3.cmml">⁢</mo><mrow id="S4.Ex5.m1.3.3.2.2" xref="S4.Ex5.m1.3.3.2.2.cmml"><mstyle displaystyle="true" id="S4.Ex5.m1.3.3.2.2.3" xref="S4.Ex5.m1.3.3.2.2.3.cmml"><munderover id="S4.Ex5.m1.3.3.2.2.3a" xref="S4.Ex5.m1.3.3.2.2.3.cmml"><mo id="S4.Ex5.m1.3.3.2.2.3.2.2" movablelimits="false" xref="S4.Ex5.m1.3.3.2.2.3.2.2.cmml">∑</mo><mrow id="S4.Ex5.m1.3.3.2.2.3.2.3" xref="S4.Ex5.m1.3.3.2.2.3.2.3.cmml"><mi id="S4.Ex5.m1.3.3.2.2.3.2.3.2" xref="S4.Ex5.m1.3.3.2.2.3.2.3.2.cmml">t</mi><mo id="S4.Ex5.m1.3.3.2.2.3.2.3.1" xref="S4.Ex5.m1.3.3.2.2.3.2.3.1.cmml">=</mo><mn id="S4.Ex5.m1.3.3.2.2.3.2.3.3" xref="S4.Ex5.m1.3.3.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex5.m1.3.3.2.2.3.3" xref="S4.Ex5.m1.3.3.2.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex5.m1.3.3.2.2.2" xref="S4.Ex5.m1.3.3.2.2.2.cmml"><mrow id="S4.Ex5.m1.3.3.2.2.2.4" xref="S4.Ex5.m1.3.3.2.2.2.4.cmml"><mo id="S4.Ex5.m1.3.3.2.2.2.4.1" lspace="0.167em" rspace="0.167em" xref="S4.Ex5.m1.3.3.2.2.2.4.1.cmml">∇</mo><mrow id="S4.Ex5.m1.3.3.2.2.2.4.2" xref="S4.Ex5.m1.3.3.2.2.2.4.2.cmml"><mi id="S4.Ex5.m1.3.3.2.2.2.4.2.2" xref="S4.Ex5.m1.3.3.2.2.2.4.2.2.cmml">l</mi><mo id="S4.Ex5.m1.3.3.2.2.2.4.2.1" xref="S4.Ex5.m1.3.3.2.2.2.4.2.1.cmml">⁢</mo><mi id="S4.Ex5.m1.3.3.2.2.2.4.2.3" xref="S4.Ex5.m1.3.3.2.2.2.4.2.3.cmml">o</mi><mo id="S4.Ex5.m1.3.3.2.2.2.4.2.1a" xref="S4.Ex5.m1.3.3.2.2.2.4.2.1.cmml">⁢</mo><mi id="S4.Ex5.m1.3.3.2.2.2.4.2.4" xref="S4.Ex5.m1.3.3.2.2.2.4.2.4.cmml">g</mi></mrow></mrow><mo id="S4.Ex5.m1.3.3.2.2.2.3" xref="S4.Ex5.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="S4.Ex5.m1.2.2.1.1.1.1.1" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.Ex5.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex5.m1.2.2.1.1.1.1.1.1" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.Ex5.m1.2.2.1.1.1.1.1.1.3" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.3.cmml">p</mi><mo id="S4.Ex5.m1.2.2.1.1.1.1.1.1.2" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex5.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex5.m1.3.3.2.2.2.3a" xref="S4.Ex5.m1.3.3.2.2.2.3.cmml">⁢</mo><mrow id="S4.Ex5.m1.3.3.2.2.2.2.1" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.cmml"><mo id="S4.Ex5.m1.3.3.2.2.2.2.1.2" stretchy="false" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.Ex5.m1.3.3.2.2.2.2.1.1" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.cmml"><munderover id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3a" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.cmml"><mo id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.2" movablelimits="false" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.2.cmml">∑</mo><mrow id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.cmml"><mi id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.2" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.2.cmml">t</mi><mo id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.1" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.1.cmml">=</mo><mn id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.3" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.3" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.cmml"><mi id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.4" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.4.cmml">R</mi><mo id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.3" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.3" stretchy="false" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.3.cmml">(</mo><msub id="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.2" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.2.cmml">a</mi><mi id="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.3" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.4" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.3.cmml">,</mo><msub id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.2" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.2.cmml">s</mi><mi id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.3" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.5" stretchy="false" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex5.m1.3.3.2.2.2.2.1.3" stretchy="false" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex5.m1.3b"><apply id="S4.Ex5.m1.3.3.cmml" xref="S4.Ex5.m1.3.3"><eq id="S4.Ex5.m1.3.3.3.cmml" xref="S4.Ex5.m1.3.3.3"></eq><csymbol cd="latexml" id="S4.Ex5.m1.3.3.4.cmml" xref="S4.Ex5.m1.3.3.4">absent</csymbol><apply id="S4.Ex5.m1.3.3.2.cmml" xref="S4.Ex5.m1.3.3.2"><times id="S4.Ex5.m1.3.3.2.3.cmml" xref="S4.Ex5.m1.3.3.2.3"></times><apply id="S4.Ex5.m1.3.3.2.4.cmml" xref="S4.Ex5.m1.3.3.2.4"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.4.1.cmml" xref="S4.Ex5.m1.3.3.2.4">subscript</csymbol><ci id="S4.Ex5.m1.3.3.2.4.2.cmml" xref="S4.Ex5.m1.3.3.2.4.2">𝐸</ci><apply id="S4.Ex5.m1.1.1.1.cmml" xref="S4.Ex5.m1.1.1.1"><csymbol cd="latexml" id="S4.Ex5.m1.1.1.1.2.cmml" xref="S4.Ex5.m1.1.1.1.2">similar-to</csymbol><ci id="S4.Ex5.m1.1.1.1.3.cmml" xref="S4.Ex5.m1.1.1.1.3">𝑠</ci><apply id="S4.Ex5.m1.1.1.1.4.cmml" xref="S4.Ex5.m1.1.1.1.4"><times id="S4.Ex5.m1.1.1.1.4.1.cmml" xref="S4.Ex5.m1.1.1.1.4.1"></times><ci id="S4.Ex5.m1.1.1.1.4.2.cmml" xref="S4.Ex5.m1.1.1.1.4.2">𝑝</ci><ci id="S4.Ex5.m1.1.1.1.1.cmml" xref="S4.Ex5.m1.1.1.1.1">𝑠</ci></apply></apply></apply><apply id="S4.Ex5.m1.3.3.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2"><apply id="S4.Ex5.m1.3.3.2.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.3.1.cmml" xref="S4.Ex5.m1.3.3.2.2.3">superscript</csymbol><apply id="S4.Ex5.m1.3.3.2.2.3.2.cmml" xref="S4.Ex5.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.3.2.1.cmml" xref="S4.Ex5.m1.3.3.2.2.3">subscript</csymbol><sum id="S4.Ex5.m1.3.3.2.2.3.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.3.2.2"></sum><apply id="S4.Ex5.m1.3.3.2.2.3.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.3.2.3"><eq id="S4.Ex5.m1.3.3.2.2.3.2.3.1.cmml" xref="S4.Ex5.m1.3.3.2.2.3.2.3.1"></eq><ci id="S4.Ex5.m1.3.3.2.2.3.2.3.2.cmml" xref="S4.Ex5.m1.3.3.2.2.3.2.3.2">𝑡</ci><cn id="S4.Ex5.m1.3.3.2.2.3.2.3.3.cmml" type="integer" xref="S4.Ex5.m1.3.3.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex5.m1.3.3.2.2.3.3.cmml" xref="S4.Ex5.m1.3.3.2.2.3.3">𝐾</ci></apply><apply id="S4.Ex5.m1.3.3.2.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2"><times id="S4.Ex5.m1.3.3.2.2.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.3"></times><apply id="S4.Ex5.m1.3.3.2.2.2.4.cmml" xref="S4.Ex5.m1.3.3.2.2.2.4"><ci id="S4.Ex5.m1.3.3.2.2.2.4.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.4.1">∇</ci><apply id="S4.Ex5.m1.3.3.2.2.2.4.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.4.2"><times id="S4.Ex5.m1.3.3.2.2.2.4.2.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.4.2.1"></times><ci id="S4.Ex5.m1.3.3.2.2.2.4.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.4.2.2">𝑙</ci><ci id="S4.Ex5.m1.3.3.2.2.2.4.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.4.2.3">𝑜</ci><ci id="S4.Ex5.m1.3.3.2.2.2.4.2.4.cmml" xref="S4.Ex5.m1.3.3.2.2.2.4.2.4">𝑔</ci></apply></apply><apply id="S4.Ex5.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1"><times id="S4.Ex5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S4.Ex5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.3">𝑝</ci><apply id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S4.Ex5.m1.3.3.2.2.2.2.1.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1"><apply id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3">superscript</csymbol><apply id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3">subscript</csymbol><sum id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.2"></sum><apply id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3"><eq id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.1"></eq><ci id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.2">𝑡</ci><cn id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.3.cmml" type="integer" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.3.3">𝐾</ci></apply><apply id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2"><times id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.3"></times><ci id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.4.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.4">𝑅</ci><interval closure="open" id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2"><apply id="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.2">𝑎</ci><ci id="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.2">𝑠</ci><ci id="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex5.m1.3c">\displaystyle=E_{s\sim p(s)}\sum_{t=1}^{K}\nabla log(p(a_{t}|s_{t}))(\sum_{t=1%
}^{K}R(a_{t},s_{t}))</annotation><annotation encoding="application/x-llamapun" id="S4.Ex5.m1.3d">= italic_E start_POSTSUBSCRIPT italic_s ∼ italic_p ( italic_s ) end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∇ italic_l italic_o italic_g ( italic_p ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ( ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_R ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{n}\sum_{i=1}^{n}\sum_{t=1}^{K}\nabla log(p(a_{i,t}|s_{i%
,t}))(\sum_{t=1}^{K}R(a_{i,t},s_{i,t}))" class="ltx_Math" display="inline" id="S4.Ex6.m1.10"><semantics id="S4.Ex6.m1.10a"><mrow id="S4.Ex6.m1.10.10" xref="S4.Ex6.m1.10.10.cmml"><mi id="S4.Ex6.m1.10.10.4" xref="S4.Ex6.m1.10.10.4.cmml"></mi><mo id="S4.Ex6.m1.10.10.3" xref="S4.Ex6.m1.10.10.3.cmml">=</mo><mrow id="S4.Ex6.m1.10.10.2" xref="S4.Ex6.m1.10.10.2.cmml"><mstyle displaystyle="true" id="S4.Ex6.m1.10.10.2.4" xref="S4.Ex6.m1.10.10.2.4.cmml"><mfrac id="S4.Ex6.m1.10.10.2.4a" xref="S4.Ex6.m1.10.10.2.4.cmml"><mn id="S4.Ex6.m1.10.10.2.4.2" xref="S4.Ex6.m1.10.10.2.4.2.cmml">1</mn><mi id="S4.Ex6.m1.10.10.2.4.3" xref="S4.Ex6.m1.10.10.2.4.3.cmml">n</mi></mfrac></mstyle><mo id="S4.Ex6.m1.10.10.2.3" xref="S4.Ex6.m1.10.10.2.3.cmml">⁢</mo><mrow id="S4.Ex6.m1.10.10.2.2" xref="S4.Ex6.m1.10.10.2.2.cmml"><mstyle displaystyle="true" id="S4.Ex6.m1.10.10.2.2.3" xref="S4.Ex6.m1.10.10.2.2.3.cmml"><munderover id="S4.Ex6.m1.10.10.2.2.3a" xref="S4.Ex6.m1.10.10.2.2.3.cmml"><mo id="S4.Ex6.m1.10.10.2.2.3.2.2" movablelimits="false" xref="S4.Ex6.m1.10.10.2.2.3.2.2.cmml">∑</mo><mrow id="S4.Ex6.m1.10.10.2.2.3.2.3" xref="S4.Ex6.m1.10.10.2.2.3.2.3.cmml"><mi id="S4.Ex6.m1.10.10.2.2.3.2.3.2" xref="S4.Ex6.m1.10.10.2.2.3.2.3.2.cmml">i</mi><mo id="S4.Ex6.m1.10.10.2.2.3.2.3.1" xref="S4.Ex6.m1.10.10.2.2.3.2.3.1.cmml">=</mo><mn id="S4.Ex6.m1.10.10.2.2.3.2.3.3" xref="S4.Ex6.m1.10.10.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex6.m1.10.10.2.2.3.3" xref="S4.Ex6.m1.10.10.2.2.3.3.cmml">n</mi></munderover></mstyle><mrow id="S4.Ex6.m1.10.10.2.2.2" xref="S4.Ex6.m1.10.10.2.2.2.cmml"><mstyle displaystyle="true" id="S4.Ex6.m1.10.10.2.2.2.3" xref="S4.Ex6.m1.10.10.2.2.2.3.cmml"><munderover id="S4.Ex6.m1.10.10.2.2.2.3a" xref="S4.Ex6.m1.10.10.2.2.2.3.cmml"><mo id="S4.Ex6.m1.10.10.2.2.2.3.2.2" movablelimits="false" xref="S4.Ex6.m1.10.10.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.Ex6.m1.10.10.2.2.2.3.2.3" xref="S4.Ex6.m1.10.10.2.2.2.3.2.3.cmml"><mi id="S4.Ex6.m1.10.10.2.2.2.3.2.3.2" xref="S4.Ex6.m1.10.10.2.2.2.3.2.3.2.cmml">t</mi><mo id="S4.Ex6.m1.10.10.2.2.2.3.2.3.1" xref="S4.Ex6.m1.10.10.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.Ex6.m1.10.10.2.2.2.3.2.3.3" xref="S4.Ex6.m1.10.10.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex6.m1.10.10.2.2.2.3.3" xref="S4.Ex6.m1.10.10.2.2.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex6.m1.10.10.2.2.2.2" xref="S4.Ex6.m1.10.10.2.2.2.2.cmml"><mrow id="S4.Ex6.m1.10.10.2.2.2.2.4" xref="S4.Ex6.m1.10.10.2.2.2.2.4.cmml"><mo id="S4.Ex6.m1.10.10.2.2.2.2.4.1" lspace="0.167em" rspace="0.167em" xref="S4.Ex6.m1.10.10.2.2.2.2.4.1.cmml">∇</mo><mrow id="S4.Ex6.m1.10.10.2.2.2.2.4.2" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.cmml"><mi id="S4.Ex6.m1.10.10.2.2.2.2.4.2.2" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.2.cmml">l</mi><mo id="S4.Ex6.m1.10.10.2.2.2.2.4.2.1" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.1.cmml">⁢</mo><mi id="S4.Ex6.m1.10.10.2.2.2.2.4.2.3" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.3.cmml">o</mi><mo id="S4.Ex6.m1.10.10.2.2.2.2.4.2.1a" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.1.cmml">⁢</mo><mi id="S4.Ex6.m1.10.10.2.2.2.2.4.2.4" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.4.cmml">g</mi></mrow></mrow><mo id="S4.Ex6.m1.10.10.2.2.2.2.3" xref="S4.Ex6.m1.10.10.2.2.2.2.3.cmml">⁢</mo><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1.1" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.cmml">p</mi><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.Ex6.m1.2.2.2.4" xref="S4.Ex6.m1.2.2.2.3.cmml"><mi id="S4.Ex6.m1.1.1.1.1" xref="S4.Ex6.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex6.m1.2.2.2.4.1" xref="S4.Ex6.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex6.m1.2.2.2.2" xref="S4.Ex6.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo fence="false" id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="S4.Ex6.m1.4.4.2.4" xref="S4.Ex6.m1.4.4.2.3.cmml"><mi id="S4.Ex6.m1.3.3.1.1" xref="S4.Ex6.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex6.m1.4.4.2.4.1" xref="S4.Ex6.m1.4.4.2.3.cmml">,</mo><mi id="S4.Ex6.m1.4.4.2.2" xref="S4.Ex6.m1.4.4.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex6.m1.10.10.2.2.2.2.3a" xref="S4.Ex6.m1.10.10.2.2.2.2.3.cmml">⁢</mo><mrow id="S4.Ex6.m1.10.10.2.2.2.2.2.1" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.cmml"><mo id="S4.Ex6.m1.10.10.2.2.2.2.2.1.2" stretchy="false" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.cmml"><munderover id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3a" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.cmml"><mo id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.2" movablelimits="false" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.2.cmml">∑</mo><mrow id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.cmml"><mi id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.2" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.2.cmml">t</mi><mo id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.1" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.1.cmml">=</mo><mn id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.3" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.3" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.cmml"><mi id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.4" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.4.cmml">R</mi><mo id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.3" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.3" stretchy="false" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.3.cmml">(</mo><msub id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1.2" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1.2.cmml">a</mi><mrow id="S4.Ex6.m1.6.6.2.4" xref="S4.Ex6.m1.6.6.2.3.cmml"><mi id="S4.Ex6.m1.5.5.1.1" xref="S4.Ex6.m1.5.5.1.1.cmml">i</mi><mo id="S4.Ex6.m1.6.6.2.4.1" xref="S4.Ex6.m1.6.6.2.3.cmml">,</mo><mi id="S4.Ex6.m1.6.6.2.2" xref="S4.Ex6.m1.6.6.2.2.cmml">t</mi></mrow></msub><mo id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.4" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.3.cmml">,</mo><msub id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2.2" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2.2.cmml">s</mi><mrow id="S4.Ex6.m1.8.8.2.4" xref="S4.Ex6.m1.8.8.2.3.cmml"><mi id="S4.Ex6.m1.7.7.1.1" xref="S4.Ex6.m1.7.7.1.1.cmml">i</mi><mo id="S4.Ex6.m1.8.8.2.4.1" xref="S4.Ex6.m1.8.8.2.3.cmml">,</mo><mi id="S4.Ex6.m1.8.8.2.2" xref="S4.Ex6.m1.8.8.2.2.cmml">t</mi></mrow></msub><mo id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.5" stretchy="false" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex6.m1.10.10.2.2.2.2.2.1.3" stretchy="false" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex6.m1.10b"><apply id="S4.Ex6.m1.10.10.cmml" xref="S4.Ex6.m1.10.10"><eq id="S4.Ex6.m1.10.10.3.cmml" xref="S4.Ex6.m1.10.10.3"></eq><csymbol cd="latexml" id="S4.Ex6.m1.10.10.4.cmml" xref="S4.Ex6.m1.10.10.4">absent</csymbol><apply id="S4.Ex6.m1.10.10.2.cmml" xref="S4.Ex6.m1.10.10.2"><times id="S4.Ex6.m1.10.10.2.3.cmml" xref="S4.Ex6.m1.10.10.2.3"></times><apply id="S4.Ex6.m1.10.10.2.4.cmml" xref="S4.Ex6.m1.10.10.2.4"><divide id="S4.Ex6.m1.10.10.2.4.1.cmml" xref="S4.Ex6.m1.10.10.2.4"></divide><cn id="S4.Ex6.m1.10.10.2.4.2.cmml" type="integer" xref="S4.Ex6.m1.10.10.2.4.2">1</cn><ci id="S4.Ex6.m1.10.10.2.4.3.cmml" xref="S4.Ex6.m1.10.10.2.4.3">𝑛</ci></apply><apply id="S4.Ex6.m1.10.10.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2"><apply id="S4.Ex6.m1.10.10.2.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.3"><csymbol cd="ambiguous" id="S4.Ex6.m1.10.10.2.2.3.1.cmml" xref="S4.Ex6.m1.10.10.2.2.3">superscript</csymbol><apply id="S4.Ex6.m1.10.10.2.2.3.2.cmml" xref="S4.Ex6.m1.10.10.2.2.3"><csymbol cd="ambiguous" id="S4.Ex6.m1.10.10.2.2.3.2.1.cmml" xref="S4.Ex6.m1.10.10.2.2.3">subscript</csymbol><sum id="S4.Ex6.m1.10.10.2.2.3.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2.3.2.2"></sum><apply id="S4.Ex6.m1.10.10.2.2.3.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.3.2.3"><eq id="S4.Ex6.m1.10.10.2.2.3.2.3.1.cmml" xref="S4.Ex6.m1.10.10.2.2.3.2.3.1"></eq><ci id="S4.Ex6.m1.10.10.2.2.3.2.3.2.cmml" xref="S4.Ex6.m1.10.10.2.2.3.2.3.2">𝑖</ci><cn id="S4.Ex6.m1.10.10.2.2.3.2.3.3.cmml" type="integer" xref="S4.Ex6.m1.10.10.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex6.m1.10.10.2.2.3.3.cmml" xref="S4.Ex6.m1.10.10.2.2.3.3">𝑛</ci></apply><apply id="S4.Ex6.m1.10.10.2.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2"><apply id="S4.Ex6.m1.10.10.2.2.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex6.m1.10.10.2.2.2.3.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3">superscript</csymbol><apply id="S4.Ex6.m1.10.10.2.2.2.3.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex6.m1.10.10.2.2.2.3.2.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3">subscript</csymbol><sum id="S4.Ex6.m1.10.10.2.2.2.3.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3.2.2"></sum><apply id="S4.Ex6.m1.10.10.2.2.2.3.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3.2.3"><eq id="S4.Ex6.m1.10.10.2.2.2.3.2.3.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3.2.3.1"></eq><ci id="S4.Ex6.m1.10.10.2.2.2.3.2.3.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3.2.3.2">𝑡</ci><cn id="S4.Ex6.m1.10.10.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.Ex6.m1.10.10.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex6.m1.10.10.2.2.2.3.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.3.3">𝐾</ci></apply><apply id="S4.Ex6.m1.10.10.2.2.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2"><times id="S4.Ex6.m1.10.10.2.2.2.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.3"></times><apply id="S4.Ex6.m1.10.10.2.2.2.2.4.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.4"><ci id="S4.Ex6.m1.10.10.2.2.2.2.4.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.4.1">∇</ci><apply id="S4.Ex6.m1.10.10.2.2.2.2.4.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2"><times id="S4.Ex6.m1.10.10.2.2.2.2.4.2.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.1"></times><ci id="S4.Ex6.m1.10.10.2.2.2.2.4.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.2">𝑙</ci><ci id="S4.Ex6.m1.10.10.2.2.2.2.4.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.3">𝑜</ci><ci id="S4.Ex6.m1.10.10.2.2.2.2.4.2.4.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.4.2.4">𝑔</ci></apply></apply><apply id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1"><times id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3">𝑝</ci><apply id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><list id="S4.Ex6.m1.2.2.2.3.cmml" xref="S4.Ex6.m1.2.2.2.4"><ci id="S4.Ex6.m1.1.1.1.1.cmml" xref="S4.Ex6.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex6.m1.2.2.2.2.cmml" xref="S4.Ex6.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><list id="S4.Ex6.m1.4.4.2.3.cmml" xref="S4.Ex6.m1.4.4.2.4"><ci id="S4.Ex6.m1.3.3.1.1.cmml" xref="S4.Ex6.m1.3.3.1.1">𝑖</ci><ci id="S4.Ex6.m1.4.4.2.2.cmml" xref="S4.Ex6.m1.4.4.2.2">𝑡</ci></list></apply></apply></apply><apply id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1"><apply id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3">superscript</csymbol><apply id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3">subscript</csymbol><sum id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.2"></sum><apply id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3"><eq id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.1"></eq><ci id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.2">𝑡</ci><cn id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.3.cmml" type="integer" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.3.3">𝐾</ci></apply><apply id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2"><times id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.3"></times><ci id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.4.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.4">𝑅</ci><interval closure="open" id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.3.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2"><apply id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.1.1.1.1.2">𝑎</ci><list id="S4.Ex6.m1.6.6.2.3.cmml" xref="S4.Ex6.m1.6.6.2.4"><ci id="S4.Ex6.m1.5.5.1.1.cmml" xref="S4.Ex6.m1.5.5.1.1">𝑖</ci><ci id="S4.Ex6.m1.6.6.2.2.cmml" xref="S4.Ex6.m1.6.6.2.2">𝑡</ci></list></apply><apply id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.Ex6.m1.10.10.2.2.2.2.2.1.1.2.2.2.2.2">𝑠</ci><list id="S4.Ex6.m1.8.8.2.3.cmml" xref="S4.Ex6.m1.8.8.2.4"><ci id="S4.Ex6.m1.7.7.1.1.cmml" xref="S4.Ex6.m1.7.7.1.1">𝑖</ci><ci id="S4.Ex6.m1.8.8.2.2.cmml" xref="S4.Ex6.m1.8.8.2.2">𝑡</ci></list></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex6.m1.10c">\displaystyle=\frac{1}{n}\sum_{i=1}^{n}\sum_{t=1}^{K}\nabla log(p(a_{i,t}|s_{i%
,t}))(\sum_{t=1}^{K}R(a_{i,t},s_{i,t}))</annotation><annotation encoding="application/x-llamapun" id="S4.Ex6.m1.10d">= divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∇ italic_l italic_o italic_g ( italic_p ( italic_a start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ) ) ( ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_R ( italic_a start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.4">where <math alttext="K" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_K</annotation></semantics></math> denotes the number of demonstration examples, <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_n</annotation></semantics></math> denote the size of training set and <math alttext="R(a_{i,t},s_{i,t})" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.6"><semantics id="S4.SS3.p2.3.m3.6a"><mrow id="S4.SS3.p2.3.m3.6.6" xref="S4.SS3.p2.3.m3.6.6.cmml"><mi id="S4.SS3.p2.3.m3.6.6.4" xref="S4.SS3.p2.3.m3.6.6.4.cmml">R</mi><mo id="S4.SS3.p2.3.m3.6.6.3" xref="S4.SS3.p2.3.m3.6.6.3.cmml">⁢</mo><mrow id="S4.SS3.p2.3.m3.6.6.2.2" xref="S4.SS3.p2.3.m3.6.6.2.3.cmml"><mo id="S4.SS3.p2.3.m3.6.6.2.2.3" stretchy="false" xref="S4.SS3.p2.3.m3.6.6.2.3.cmml">(</mo><msub id="S4.SS3.p2.3.m3.5.5.1.1.1" xref="S4.SS3.p2.3.m3.5.5.1.1.1.cmml"><mi id="S4.SS3.p2.3.m3.5.5.1.1.1.2" xref="S4.SS3.p2.3.m3.5.5.1.1.1.2.cmml">a</mi><mrow id="S4.SS3.p2.3.m3.2.2.2.4" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml"><mi id="S4.SS3.p2.3.m3.1.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p2.3.m3.2.2.2.4.1" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.3.m3.2.2.2.2" xref="S4.SS3.p2.3.m3.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.SS3.p2.3.m3.6.6.2.2.4" xref="S4.SS3.p2.3.m3.6.6.2.3.cmml">,</mo><msub id="S4.SS3.p2.3.m3.6.6.2.2.2" xref="S4.SS3.p2.3.m3.6.6.2.2.2.cmml"><mi id="S4.SS3.p2.3.m3.6.6.2.2.2.2" xref="S4.SS3.p2.3.m3.6.6.2.2.2.2.cmml">s</mi><mrow id="S4.SS3.p2.3.m3.4.4.2.4" xref="S4.SS3.p2.3.m3.4.4.2.3.cmml"><mi id="S4.SS3.p2.3.m3.3.3.1.1" xref="S4.SS3.p2.3.m3.3.3.1.1.cmml">i</mi><mo id="S4.SS3.p2.3.m3.4.4.2.4.1" xref="S4.SS3.p2.3.m3.4.4.2.3.cmml">,</mo><mi id="S4.SS3.p2.3.m3.4.4.2.2" xref="S4.SS3.p2.3.m3.4.4.2.2.cmml">t</mi></mrow></msub><mo id="S4.SS3.p2.3.m3.6.6.2.2.5" stretchy="false" xref="S4.SS3.p2.3.m3.6.6.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.6b"><apply id="S4.SS3.p2.3.m3.6.6.cmml" xref="S4.SS3.p2.3.m3.6.6"><times id="S4.SS3.p2.3.m3.6.6.3.cmml" xref="S4.SS3.p2.3.m3.6.6.3"></times><ci id="S4.SS3.p2.3.m3.6.6.4.cmml" xref="S4.SS3.p2.3.m3.6.6.4">𝑅</ci><interval closure="open" id="S4.SS3.p2.3.m3.6.6.2.3.cmml" xref="S4.SS3.p2.3.m3.6.6.2.2"><apply id="S4.SS3.p2.3.m3.5.5.1.1.1.cmml" xref="S4.SS3.p2.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.5.5.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.5.5.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.5.5.1.1.1.2.cmml" xref="S4.SS3.p2.3.m3.5.5.1.1.1.2">𝑎</ci><list id="S4.SS3.p2.3.m3.2.2.2.3.cmml" xref="S4.SS3.p2.3.m3.2.2.2.4"><ci id="S4.SS3.p2.3.m3.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1.1">𝑖</ci><ci id="S4.SS3.p2.3.m3.2.2.2.2.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2">𝑡</ci></list></apply><apply id="S4.SS3.p2.3.m3.6.6.2.2.2.cmml" xref="S4.SS3.p2.3.m3.6.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.6.6.2.2.2.1.cmml" xref="S4.SS3.p2.3.m3.6.6.2.2.2">subscript</csymbol><ci id="S4.SS3.p2.3.m3.6.6.2.2.2.2.cmml" xref="S4.SS3.p2.3.m3.6.6.2.2.2.2">𝑠</ci><list id="S4.SS3.p2.3.m3.4.4.2.3.cmml" xref="S4.SS3.p2.3.m3.4.4.2.4"><ci id="S4.SS3.p2.3.m3.3.3.1.1.cmml" xref="S4.SS3.p2.3.m3.3.3.1.1">𝑖</ci><ci id="S4.SS3.p2.3.m3.4.4.2.2.cmml" xref="S4.SS3.p2.3.m3.4.4.2.2">𝑡</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.6c">R(a_{i,t},s_{i,t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.6d">italic_R ( italic_a start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the reward computed by inputing the current examples selected <math alttext="s_{i,t}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.2"><semantics id="S4.SS3.p2.4.m4.2a"><msub id="S4.SS3.p2.4.m4.2.3" xref="S4.SS3.p2.4.m4.2.3.cmml"><mi id="S4.SS3.p2.4.m4.2.3.2" xref="S4.SS3.p2.4.m4.2.3.2.cmml">s</mi><mrow id="S4.SS3.p2.4.m4.2.2.2.4" xref="S4.SS3.p2.4.m4.2.2.2.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p2.4.m4.2.2.2.4.1" xref="S4.SS3.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.4.m4.2.2.2.2" xref="S4.SS3.p2.4.m4.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.2b"><apply id="S4.SS3.p2.4.m4.2.3.cmml" xref="S4.SS3.p2.4.m4.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.2.3.1.cmml" xref="S4.SS3.p2.4.m4.2.3">subscript</csymbol><ci id="S4.SS3.p2.4.m4.2.3.2.cmml" xref="S4.SS3.p2.4.m4.2.3.2">𝑠</ci><list id="S4.SS3.p2.4.m4.2.2.2.3.cmml" xref="S4.SS3.p2.4.m4.2.2.2.4"><ci id="S4.SS3.p2.4.m4.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1">𝑖</ci><ci id="S4.SS3.p2.4.m4.2.2.2.2.cmml" xref="S4.SS3.p2.4.m4.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.2c">s_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.2d">italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to LLM for i-th case in training set.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.2">To reduce the generation time cost of LLM, we simplify the computation of <math alttext="\sum_{t=1}^{K}R(a_{i,t},s_{i,t})" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.6"><semantics id="S4.SS3.p3.1.m1.6a"><mrow id="S4.SS3.p3.1.m1.6.6" xref="S4.SS3.p3.1.m1.6.6.cmml"><msubsup id="S4.SS3.p3.1.m1.6.6.3" xref="S4.SS3.p3.1.m1.6.6.3.cmml"><mo id="S4.SS3.p3.1.m1.6.6.3.2.2" xref="S4.SS3.p3.1.m1.6.6.3.2.2.cmml">∑</mo><mrow id="S4.SS3.p3.1.m1.6.6.3.2.3" xref="S4.SS3.p3.1.m1.6.6.3.2.3.cmml"><mi id="S4.SS3.p3.1.m1.6.6.3.2.3.2" xref="S4.SS3.p3.1.m1.6.6.3.2.3.2.cmml">t</mi><mo id="S4.SS3.p3.1.m1.6.6.3.2.3.1" xref="S4.SS3.p3.1.m1.6.6.3.2.3.1.cmml">=</mo><mn id="S4.SS3.p3.1.m1.6.6.3.2.3.3" xref="S4.SS3.p3.1.m1.6.6.3.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p3.1.m1.6.6.3.3" xref="S4.SS3.p3.1.m1.6.6.3.3.cmml">K</mi></msubsup><mrow id="S4.SS3.p3.1.m1.6.6.2" xref="S4.SS3.p3.1.m1.6.6.2.cmml"><mi id="S4.SS3.p3.1.m1.6.6.2.4" xref="S4.SS3.p3.1.m1.6.6.2.4.cmml">R</mi><mo id="S4.SS3.p3.1.m1.6.6.2.3" xref="S4.SS3.p3.1.m1.6.6.2.3.cmml">⁢</mo><mrow id="S4.SS3.p3.1.m1.6.6.2.2.2" xref="S4.SS3.p3.1.m1.6.6.2.2.3.cmml"><mo id="S4.SS3.p3.1.m1.6.6.2.2.2.3" stretchy="false" xref="S4.SS3.p3.1.m1.6.6.2.2.3.cmml">(</mo><msub id="S4.SS3.p3.1.m1.5.5.1.1.1.1" xref="S4.SS3.p3.1.m1.5.5.1.1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.5.5.1.1.1.1.2" xref="S4.SS3.p3.1.m1.5.5.1.1.1.1.2.cmml">a</mi><mrow id="S4.SS3.p3.1.m1.2.2.2.4" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml"><mi id="S4.SS3.p3.1.m1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p3.1.m1.2.2.2.4.1" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.1.m1.2.2.2.2" xref="S4.SS3.p3.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.SS3.p3.1.m1.6.6.2.2.2.4" xref="S4.SS3.p3.1.m1.6.6.2.2.3.cmml">,</mo><msub id="S4.SS3.p3.1.m1.6.6.2.2.2.2" xref="S4.SS3.p3.1.m1.6.6.2.2.2.2.cmml"><mi id="S4.SS3.p3.1.m1.6.6.2.2.2.2.2" xref="S4.SS3.p3.1.m1.6.6.2.2.2.2.2.cmml">s</mi><mrow id="S4.SS3.p3.1.m1.4.4.2.4" xref="S4.SS3.p3.1.m1.4.4.2.3.cmml"><mi id="S4.SS3.p3.1.m1.3.3.1.1" xref="S4.SS3.p3.1.m1.3.3.1.1.cmml">i</mi><mo id="S4.SS3.p3.1.m1.4.4.2.4.1" xref="S4.SS3.p3.1.m1.4.4.2.3.cmml">,</mo><mi id="S4.SS3.p3.1.m1.4.4.2.2" xref="S4.SS3.p3.1.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo id="S4.SS3.p3.1.m1.6.6.2.2.2.5" stretchy="false" xref="S4.SS3.p3.1.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.6b"><apply id="S4.SS3.p3.1.m1.6.6.cmml" xref="S4.SS3.p3.1.m1.6.6"><apply id="S4.SS3.p3.1.m1.6.6.3.cmml" xref="S4.SS3.p3.1.m1.6.6.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.6.6.3.1.cmml" xref="S4.SS3.p3.1.m1.6.6.3">superscript</csymbol><apply id="S4.SS3.p3.1.m1.6.6.3.2.cmml" xref="S4.SS3.p3.1.m1.6.6.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.6.6.3.2.1.cmml" xref="S4.SS3.p3.1.m1.6.6.3">subscript</csymbol><sum id="S4.SS3.p3.1.m1.6.6.3.2.2.cmml" xref="S4.SS3.p3.1.m1.6.6.3.2.2"></sum><apply id="S4.SS3.p3.1.m1.6.6.3.2.3.cmml" xref="S4.SS3.p3.1.m1.6.6.3.2.3"><eq id="S4.SS3.p3.1.m1.6.6.3.2.3.1.cmml" xref="S4.SS3.p3.1.m1.6.6.3.2.3.1"></eq><ci id="S4.SS3.p3.1.m1.6.6.3.2.3.2.cmml" xref="S4.SS3.p3.1.m1.6.6.3.2.3.2">𝑡</ci><cn id="S4.SS3.p3.1.m1.6.6.3.2.3.3.cmml" type="integer" xref="S4.SS3.p3.1.m1.6.6.3.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.1.m1.6.6.3.3.cmml" xref="S4.SS3.p3.1.m1.6.6.3.3">𝐾</ci></apply><apply id="S4.SS3.p3.1.m1.6.6.2.cmml" xref="S4.SS3.p3.1.m1.6.6.2"><times id="S4.SS3.p3.1.m1.6.6.2.3.cmml" xref="S4.SS3.p3.1.m1.6.6.2.3"></times><ci id="S4.SS3.p3.1.m1.6.6.2.4.cmml" xref="S4.SS3.p3.1.m1.6.6.2.4">𝑅</ci><interval closure="open" id="S4.SS3.p3.1.m1.6.6.2.2.3.cmml" xref="S4.SS3.p3.1.m1.6.6.2.2.2"><apply id="S4.SS3.p3.1.m1.5.5.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.5.5.1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.5.5.1.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.5.5.1.1.1.1.2">𝑎</ci><list id="S4.SS3.p3.1.m1.2.2.2.3.cmml" xref="S4.SS3.p3.1.m1.2.2.2.4"><ci id="S4.SS3.p3.1.m1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS3.p3.1.m1.2.2.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S4.SS3.p3.1.m1.6.6.2.2.2.2.cmml" xref="S4.SS3.p3.1.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.6.6.2.2.2.2.1.cmml" xref="S4.SS3.p3.1.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S4.SS3.p3.1.m1.6.6.2.2.2.2.2.cmml" xref="S4.SS3.p3.1.m1.6.6.2.2.2.2.2">𝑠</ci><list id="S4.SS3.p3.1.m1.4.4.2.3.cmml" xref="S4.SS3.p3.1.m1.4.4.2.4"><ci id="S4.SS3.p3.1.m1.3.3.1.1.cmml" xref="S4.SS3.p3.1.m1.3.3.1.1">𝑖</ci><ci id="S4.SS3.p3.1.m1.4.4.2.2.cmml" xref="S4.SS3.p3.1.m1.4.4.2.2">𝑡</ci></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.6c">\sum_{t=1}^{K}R(a_{i,t},s_{i,t})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.6d">∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_R ( italic_a start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> by replacing with <math alttext="R(a_{i,K},s_{i,K})" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.6"><semantics id="S4.SS3.p3.2.m2.6a"><mrow id="S4.SS3.p3.2.m2.6.6" xref="S4.SS3.p3.2.m2.6.6.cmml"><mi id="S4.SS3.p3.2.m2.6.6.4" xref="S4.SS3.p3.2.m2.6.6.4.cmml">R</mi><mo id="S4.SS3.p3.2.m2.6.6.3" xref="S4.SS3.p3.2.m2.6.6.3.cmml">⁢</mo><mrow id="S4.SS3.p3.2.m2.6.6.2.2" xref="S4.SS3.p3.2.m2.6.6.2.3.cmml"><mo id="S4.SS3.p3.2.m2.6.6.2.2.3" stretchy="false" xref="S4.SS3.p3.2.m2.6.6.2.3.cmml">(</mo><msub id="S4.SS3.p3.2.m2.5.5.1.1.1" xref="S4.SS3.p3.2.m2.5.5.1.1.1.cmml"><mi id="S4.SS3.p3.2.m2.5.5.1.1.1.2" xref="S4.SS3.p3.2.m2.5.5.1.1.1.2.cmml">a</mi><mrow id="S4.SS3.p3.2.m2.2.2.2.4" xref="S4.SS3.p3.2.m2.2.2.2.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p3.2.m2.2.2.2.4.1" xref="S4.SS3.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.2.m2.2.2.2.2" xref="S4.SS3.p3.2.m2.2.2.2.2.cmml">K</mi></mrow></msub><mo id="S4.SS3.p3.2.m2.6.6.2.2.4" xref="S4.SS3.p3.2.m2.6.6.2.3.cmml">,</mo><msub id="S4.SS3.p3.2.m2.6.6.2.2.2" xref="S4.SS3.p3.2.m2.6.6.2.2.2.cmml"><mi id="S4.SS3.p3.2.m2.6.6.2.2.2.2" xref="S4.SS3.p3.2.m2.6.6.2.2.2.2.cmml">s</mi><mrow id="S4.SS3.p3.2.m2.4.4.2.4" xref="S4.SS3.p3.2.m2.4.4.2.3.cmml"><mi id="S4.SS3.p3.2.m2.3.3.1.1" xref="S4.SS3.p3.2.m2.3.3.1.1.cmml">i</mi><mo id="S4.SS3.p3.2.m2.4.4.2.4.1" xref="S4.SS3.p3.2.m2.4.4.2.3.cmml">,</mo><mi id="S4.SS3.p3.2.m2.4.4.2.2" xref="S4.SS3.p3.2.m2.4.4.2.2.cmml">K</mi></mrow></msub><mo id="S4.SS3.p3.2.m2.6.6.2.2.5" stretchy="false" xref="S4.SS3.p3.2.m2.6.6.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.6b"><apply id="S4.SS3.p3.2.m2.6.6.cmml" xref="S4.SS3.p3.2.m2.6.6"><times id="S4.SS3.p3.2.m2.6.6.3.cmml" xref="S4.SS3.p3.2.m2.6.6.3"></times><ci id="S4.SS3.p3.2.m2.6.6.4.cmml" xref="S4.SS3.p3.2.m2.6.6.4">𝑅</ci><interval closure="open" id="S4.SS3.p3.2.m2.6.6.2.3.cmml" xref="S4.SS3.p3.2.m2.6.6.2.2"><apply id="S4.SS3.p3.2.m2.5.5.1.1.1.cmml" xref="S4.SS3.p3.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.5.5.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.5.5.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.5.5.1.1.1.2.cmml" xref="S4.SS3.p3.2.m2.5.5.1.1.1.2">𝑎</ci><list id="S4.SS3.p3.2.m2.2.2.2.3.cmml" xref="S4.SS3.p3.2.m2.2.2.2.4"><ci id="S4.SS3.p3.2.m2.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1">𝑖</ci><ci id="S4.SS3.p3.2.m2.2.2.2.2.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2">𝐾</ci></list></apply><apply id="S4.SS3.p3.2.m2.6.6.2.2.2.cmml" xref="S4.SS3.p3.2.m2.6.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.6.6.2.2.2.1.cmml" xref="S4.SS3.p3.2.m2.6.6.2.2.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.6.6.2.2.2.2.cmml" xref="S4.SS3.p3.2.m2.6.6.2.2.2.2">𝑠</ci><list id="S4.SS3.p3.2.m2.4.4.2.3.cmml" xref="S4.SS3.p3.2.m2.4.4.2.4"><ci id="S4.SS3.p3.2.m2.3.3.1.1.cmml" xref="S4.SS3.p3.2.m2.3.3.1.1">𝑖</ci><ci id="S4.SS3.p3.2.m2.4.4.2.2.cmml" xref="S4.SS3.p3.2.m2.4.4.2.2">𝐾</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.6c">R(a_{i,K},s_{i,K})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.6d">italic_R ( italic_a start_POSTSUBSCRIPT italic_i , italic_K end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_i , italic_K end_POSTSUBSCRIPT )</annotation></semantics></math>. That is, in the process of selecting examples, we do not input the intermediate demonstrations into LLM to derive the reward. Instead, after selecting all the K examples, we input the final demonstration to LLM. To reduce the variance of learning process, we modify the reward by subtracting a baseline score, which will not affect the gradient. In practice, we compute the ICL performance with randomly selecting examples as the baseline score for IUR task. So the gradient can be simplified as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
<tbody id="S4.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\nabla E_{s\sim p(s)}R(s)" class="ltx_Math" display="inline" id="S4.Ex7.m1.2"><semantics id="S4.Ex7.m1.2a"><mrow id="S4.Ex7.m1.2.3" xref="S4.Ex7.m1.2.3.cmml"><mrow id="S4.Ex7.m1.2.3.2" xref="S4.Ex7.m1.2.3.2.cmml"><mo id="S4.Ex7.m1.2.3.2.1" rspace="0.167em" xref="S4.Ex7.m1.2.3.2.1.cmml">∇</mo><mrow id="S4.Ex7.m1.2.3.2.2" xref="S4.Ex7.m1.2.3.2.2.cmml"><msub id="S4.Ex7.m1.2.3.2.2.2" xref="S4.Ex7.m1.2.3.2.2.2.cmml"><mi id="S4.Ex7.m1.2.3.2.2.2.2" xref="S4.Ex7.m1.2.3.2.2.2.2.cmml">E</mi><mrow id="S4.Ex7.m1.1.1.1" xref="S4.Ex7.m1.1.1.1.cmml"><mi id="S4.Ex7.m1.1.1.1.3" xref="S4.Ex7.m1.1.1.1.3.cmml">s</mi><mo id="S4.Ex7.m1.1.1.1.2" xref="S4.Ex7.m1.1.1.1.2.cmml">∼</mo><mrow id="S4.Ex7.m1.1.1.1.4" xref="S4.Ex7.m1.1.1.1.4.cmml"><mi id="S4.Ex7.m1.1.1.1.4.2" xref="S4.Ex7.m1.1.1.1.4.2.cmml">p</mi><mo id="S4.Ex7.m1.1.1.1.4.1" xref="S4.Ex7.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S4.Ex7.m1.1.1.1.4.3.2" xref="S4.Ex7.m1.1.1.1.4.cmml"><mo id="S4.Ex7.m1.1.1.1.4.3.2.1" stretchy="false" xref="S4.Ex7.m1.1.1.1.4.cmml">(</mo><mi id="S4.Ex7.m1.1.1.1.1" xref="S4.Ex7.m1.1.1.1.1.cmml">s</mi><mo id="S4.Ex7.m1.1.1.1.4.3.2.2" stretchy="false" xref="S4.Ex7.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S4.Ex7.m1.2.3.2.2.1" xref="S4.Ex7.m1.2.3.2.2.1.cmml">⁢</mo><mi id="S4.Ex7.m1.2.3.2.2.3" xref="S4.Ex7.m1.2.3.2.2.3.cmml">R</mi></mrow></mrow><mo id="S4.Ex7.m1.2.3.1" xref="S4.Ex7.m1.2.3.1.cmml">⁢</mo><mrow id="S4.Ex7.m1.2.3.3.2" xref="S4.Ex7.m1.2.3.cmml"><mo id="S4.Ex7.m1.2.3.3.2.1" stretchy="false" xref="S4.Ex7.m1.2.3.cmml">(</mo><mi id="S4.Ex7.m1.2.2" xref="S4.Ex7.m1.2.2.cmml">s</mi><mo id="S4.Ex7.m1.2.3.3.2.2" stretchy="false" xref="S4.Ex7.m1.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex7.m1.2b"><apply id="S4.Ex7.m1.2.3.cmml" xref="S4.Ex7.m1.2.3"><times id="S4.Ex7.m1.2.3.1.cmml" xref="S4.Ex7.m1.2.3.1"></times><apply id="S4.Ex7.m1.2.3.2.cmml" xref="S4.Ex7.m1.2.3.2"><ci id="S4.Ex7.m1.2.3.2.1.cmml" xref="S4.Ex7.m1.2.3.2.1">∇</ci><apply id="S4.Ex7.m1.2.3.2.2.cmml" xref="S4.Ex7.m1.2.3.2.2"><times id="S4.Ex7.m1.2.3.2.2.1.cmml" xref="S4.Ex7.m1.2.3.2.2.1"></times><apply id="S4.Ex7.m1.2.3.2.2.2.cmml" xref="S4.Ex7.m1.2.3.2.2.2"><csymbol cd="ambiguous" id="S4.Ex7.m1.2.3.2.2.2.1.cmml" xref="S4.Ex7.m1.2.3.2.2.2">subscript</csymbol><ci id="S4.Ex7.m1.2.3.2.2.2.2.cmml" xref="S4.Ex7.m1.2.3.2.2.2.2">𝐸</ci><apply id="S4.Ex7.m1.1.1.1.cmml" xref="S4.Ex7.m1.1.1.1"><csymbol cd="latexml" id="S4.Ex7.m1.1.1.1.2.cmml" xref="S4.Ex7.m1.1.1.1.2">similar-to</csymbol><ci id="S4.Ex7.m1.1.1.1.3.cmml" xref="S4.Ex7.m1.1.1.1.3">𝑠</ci><apply id="S4.Ex7.m1.1.1.1.4.cmml" xref="S4.Ex7.m1.1.1.1.4"><times id="S4.Ex7.m1.1.1.1.4.1.cmml" xref="S4.Ex7.m1.1.1.1.4.1"></times><ci id="S4.Ex7.m1.1.1.1.4.2.cmml" xref="S4.Ex7.m1.1.1.1.4.2">𝑝</ci><ci id="S4.Ex7.m1.1.1.1.1.cmml" xref="S4.Ex7.m1.1.1.1.1">𝑠</ci></apply></apply></apply><ci id="S4.Ex7.m1.2.3.2.2.3.cmml" xref="S4.Ex7.m1.2.3.2.2.3">𝑅</ci></apply></apply><ci id="S4.Ex7.m1.2.2.cmml" xref="S4.Ex7.m1.2.2">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex7.m1.2c">\displaystyle\nabla E_{s\sim p(s)}R(s)</annotation><annotation encoding="application/x-llamapun" id="S4.Ex7.m1.2d">∇ italic_E start_POSTSUBSCRIPT italic_s ∼ italic_p ( italic_s ) end_POSTSUBSCRIPT italic_R ( italic_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{n}\sum_{i=1}^{n}\sum_{t=1}^{K}\nabla log(p(a_{i,t}|s_{i%
,t}))R(a_{i,K},s_{i,K})" class="ltx_Math" display="inline" id="S4.Ex8.m1.11"><semantics id="S4.Ex8.m1.11a"><mrow id="S4.Ex8.m1.11.11" xref="S4.Ex8.m1.11.11.cmml"><mi id="S4.Ex8.m1.11.11.5" xref="S4.Ex8.m1.11.11.5.cmml"></mi><mo id="S4.Ex8.m1.11.11.4" xref="S4.Ex8.m1.11.11.4.cmml">=</mo><mrow id="S4.Ex8.m1.11.11.3" xref="S4.Ex8.m1.11.11.3.cmml"><mstyle displaystyle="true" id="S4.Ex8.m1.11.11.3.5" xref="S4.Ex8.m1.11.11.3.5.cmml"><mfrac id="S4.Ex8.m1.11.11.3.5a" xref="S4.Ex8.m1.11.11.3.5.cmml"><mn id="S4.Ex8.m1.11.11.3.5.2" xref="S4.Ex8.m1.11.11.3.5.2.cmml">1</mn><mi id="S4.Ex8.m1.11.11.3.5.3" xref="S4.Ex8.m1.11.11.3.5.3.cmml">n</mi></mfrac></mstyle><mo id="S4.Ex8.m1.11.11.3.4" xref="S4.Ex8.m1.11.11.3.4.cmml">⁢</mo><mrow id="S4.Ex8.m1.11.11.3.3" xref="S4.Ex8.m1.11.11.3.3.cmml"><mstyle displaystyle="true" id="S4.Ex8.m1.11.11.3.3.4" xref="S4.Ex8.m1.11.11.3.3.4.cmml"><munderover id="S4.Ex8.m1.11.11.3.3.4a" xref="S4.Ex8.m1.11.11.3.3.4.cmml"><mo id="S4.Ex8.m1.11.11.3.3.4.2.2" movablelimits="false" xref="S4.Ex8.m1.11.11.3.3.4.2.2.cmml">∑</mo><mrow id="S4.Ex8.m1.11.11.3.3.4.2.3" xref="S4.Ex8.m1.11.11.3.3.4.2.3.cmml"><mi id="S4.Ex8.m1.11.11.3.3.4.2.3.2" xref="S4.Ex8.m1.11.11.3.3.4.2.3.2.cmml">i</mi><mo id="S4.Ex8.m1.11.11.3.3.4.2.3.1" xref="S4.Ex8.m1.11.11.3.3.4.2.3.1.cmml">=</mo><mn id="S4.Ex8.m1.11.11.3.3.4.2.3.3" xref="S4.Ex8.m1.11.11.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex8.m1.11.11.3.3.4.3" xref="S4.Ex8.m1.11.11.3.3.4.3.cmml">n</mi></munderover></mstyle><mrow id="S4.Ex8.m1.11.11.3.3.3" xref="S4.Ex8.m1.11.11.3.3.3.cmml"><mstyle displaystyle="true" id="S4.Ex8.m1.11.11.3.3.3.4" xref="S4.Ex8.m1.11.11.3.3.3.4.cmml"><munderover id="S4.Ex8.m1.11.11.3.3.3.4a" xref="S4.Ex8.m1.11.11.3.3.3.4.cmml"><mo id="S4.Ex8.m1.11.11.3.3.3.4.2.2" movablelimits="false" xref="S4.Ex8.m1.11.11.3.3.3.4.2.2.cmml">∑</mo><mrow id="S4.Ex8.m1.11.11.3.3.3.4.2.3" xref="S4.Ex8.m1.11.11.3.3.3.4.2.3.cmml"><mi id="S4.Ex8.m1.11.11.3.3.3.4.2.3.2" xref="S4.Ex8.m1.11.11.3.3.3.4.2.3.2.cmml">t</mi><mo id="S4.Ex8.m1.11.11.3.3.3.4.2.3.1" xref="S4.Ex8.m1.11.11.3.3.3.4.2.3.1.cmml">=</mo><mn id="S4.Ex8.m1.11.11.3.3.3.4.2.3.3" xref="S4.Ex8.m1.11.11.3.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex8.m1.11.11.3.3.3.4.3" xref="S4.Ex8.m1.11.11.3.3.3.4.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex8.m1.11.11.3.3.3.3" xref="S4.Ex8.m1.11.11.3.3.3.3.cmml"><mrow id="S4.Ex8.m1.11.11.3.3.3.3.5" xref="S4.Ex8.m1.11.11.3.3.3.3.5.cmml"><mo id="S4.Ex8.m1.11.11.3.3.3.3.5.1" lspace="0.167em" rspace="0.167em" xref="S4.Ex8.m1.11.11.3.3.3.3.5.1.cmml">∇</mo><mrow id="S4.Ex8.m1.11.11.3.3.3.3.5.2" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.cmml"><mi id="S4.Ex8.m1.11.11.3.3.3.3.5.2.2" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.2.cmml">l</mi><mo id="S4.Ex8.m1.11.11.3.3.3.3.5.2.1" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.1.cmml">⁢</mo><mi id="S4.Ex8.m1.11.11.3.3.3.3.5.2.3" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.3.cmml">o</mi><mo id="S4.Ex8.m1.11.11.3.3.3.3.5.2.1a" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.1.cmml">⁢</mo><mi id="S4.Ex8.m1.11.11.3.3.3.3.5.2.4" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.4.cmml">g</mi></mrow></mrow><mo id="S4.Ex8.m1.11.11.3.3.3.3.4" xref="S4.Ex8.m1.11.11.3.3.3.3.4.cmml">⁢</mo><mrow id="S4.Ex8.m1.9.9.1.1.1.1.1.1" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex8.m1.9.9.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.3" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.3.cmml">p</mi><mo id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.2" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.Ex8.m1.2.2.2.4" xref="S4.Ex8.m1.2.2.2.3.cmml"><mi id="S4.Ex8.m1.1.1.1.1" xref="S4.Ex8.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex8.m1.2.2.2.4.1" xref="S4.Ex8.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex8.m1.2.2.2.2" xref="S4.Ex8.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo fence="false" id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="S4.Ex8.m1.4.4.2.4" xref="S4.Ex8.m1.4.4.2.3.cmml"><mi id="S4.Ex8.m1.3.3.1.1" xref="S4.Ex8.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex8.m1.4.4.2.4.1" xref="S4.Ex8.m1.4.4.2.3.cmml">,</mo><mi id="S4.Ex8.m1.4.4.2.2" xref="S4.Ex8.m1.4.4.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex8.m1.9.9.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex8.m1.11.11.3.3.3.3.4a" xref="S4.Ex8.m1.11.11.3.3.3.3.4.cmml">⁢</mo><mi id="S4.Ex8.m1.11.11.3.3.3.3.6" xref="S4.Ex8.m1.11.11.3.3.3.3.6.cmml">R</mi><mo id="S4.Ex8.m1.11.11.3.3.3.3.4b" xref="S4.Ex8.m1.11.11.3.3.3.3.4.cmml">⁢</mo><mrow id="S4.Ex8.m1.11.11.3.3.3.3.3.2" xref="S4.Ex8.m1.11.11.3.3.3.3.3.3.cmml"><mo id="S4.Ex8.m1.11.11.3.3.3.3.3.2.3" stretchy="false" xref="S4.Ex8.m1.11.11.3.3.3.3.3.3.cmml">(</mo><msub id="S4.Ex8.m1.10.10.2.2.2.2.2.1.1" xref="S4.Ex8.m1.10.10.2.2.2.2.2.1.1.cmml"><mi id="S4.Ex8.m1.10.10.2.2.2.2.2.1.1.2" xref="S4.Ex8.m1.10.10.2.2.2.2.2.1.1.2.cmml">a</mi><mrow id="S4.Ex8.m1.6.6.2.4" xref="S4.Ex8.m1.6.6.2.3.cmml"><mi id="S4.Ex8.m1.5.5.1.1" xref="S4.Ex8.m1.5.5.1.1.cmml">i</mi><mo id="S4.Ex8.m1.6.6.2.4.1" xref="S4.Ex8.m1.6.6.2.3.cmml">,</mo><mi id="S4.Ex8.m1.6.6.2.2" xref="S4.Ex8.m1.6.6.2.2.cmml">K</mi></mrow></msub><mo id="S4.Ex8.m1.11.11.3.3.3.3.3.2.4" xref="S4.Ex8.m1.11.11.3.3.3.3.3.3.cmml">,</mo><msub id="S4.Ex8.m1.11.11.3.3.3.3.3.2.2" xref="S4.Ex8.m1.11.11.3.3.3.3.3.2.2.cmml"><mi id="S4.Ex8.m1.11.11.3.3.3.3.3.2.2.2" xref="S4.Ex8.m1.11.11.3.3.3.3.3.2.2.2.cmml">s</mi><mrow id="S4.Ex8.m1.8.8.2.4" xref="S4.Ex8.m1.8.8.2.3.cmml"><mi id="S4.Ex8.m1.7.7.1.1" xref="S4.Ex8.m1.7.7.1.1.cmml">i</mi><mo id="S4.Ex8.m1.8.8.2.4.1" xref="S4.Ex8.m1.8.8.2.3.cmml">,</mo><mi id="S4.Ex8.m1.8.8.2.2" xref="S4.Ex8.m1.8.8.2.2.cmml">K</mi></mrow></msub><mo id="S4.Ex8.m1.11.11.3.3.3.3.3.2.5" stretchy="false" xref="S4.Ex8.m1.11.11.3.3.3.3.3.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex8.m1.11b"><apply id="S4.Ex8.m1.11.11.cmml" xref="S4.Ex8.m1.11.11"><eq id="S4.Ex8.m1.11.11.4.cmml" xref="S4.Ex8.m1.11.11.4"></eq><csymbol cd="latexml" id="S4.Ex8.m1.11.11.5.cmml" xref="S4.Ex8.m1.11.11.5">absent</csymbol><apply id="S4.Ex8.m1.11.11.3.cmml" xref="S4.Ex8.m1.11.11.3"><times id="S4.Ex8.m1.11.11.3.4.cmml" xref="S4.Ex8.m1.11.11.3.4"></times><apply id="S4.Ex8.m1.11.11.3.5.cmml" xref="S4.Ex8.m1.11.11.3.5"><divide id="S4.Ex8.m1.11.11.3.5.1.cmml" xref="S4.Ex8.m1.11.11.3.5"></divide><cn id="S4.Ex8.m1.11.11.3.5.2.cmml" type="integer" xref="S4.Ex8.m1.11.11.3.5.2">1</cn><ci id="S4.Ex8.m1.11.11.3.5.3.cmml" xref="S4.Ex8.m1.11.11.3.5.3">𝑛</ci></apply><apply id="S4.Ex8.m1.11.11.3.3.cmml" xref="S4.Ex8.m1.11.11.3.3"><apply id="S4.Ex8.m1.11.11.3.3.4.cmml" xref="S4.Ex8.m1.11.11.3.3.4"><csymbol cd="ambiguous" id="S4.Ex8.m1.11.11.3.3.4.1.cmml" xref="S4.Ex8.m1.11.11.3.3.4">superscript</csymbol><apply id="S4.Ex8.m1.11.11.3.3.4.2.cmml" xref="S4.Ex8.m1.11.11.3.3.4"><csymbol cd="ambiguous" id="S4.Ex8.m1.11.11.3.3.4.2.1.cmml" xref="S4.Ex8.m1.11.11.3.3.4">subscript</csymbol><sum id="S4.Ex8.m1.11.11.3.3.4.2.2.cmml" xref="S4.Ex8.m1.11.11.3.3.4.2.2"></sum><apply id="S4.Ex8.m1.11.11.3.3.4.2.3.cmml" xref="S4.Ex8.m1.11.11.3.3.4.2.3"><eq id="S4.Ex8.m1.11.11.3.3.4.2.3.1.cmml" xref="S4.Ex8.m1.11.11.3.3.4.2.3.1"></eq><ci id="S4.Ex8.m1.11.11.3.3.4.2.3.2.cmml" xref="S4.Ex8.m1.11.11.3.3.4.2.3.2">𝑖</ci><cn id="S4.Ex8.m1.11.11.3.3.4.2.3.3.cmml" type="integer" xref="S4.Ex8.m1.11.11.3.3.4.2.3.3">1</cn></apply></apply><ci id="S4.Ex8.m1.11.11.3.3.4.3.cmml" xref="S4.Ex8.m1.11.11.3.3.4.3">𝑛</ci></apply><apply id="S4.Ex8.m1.11.11.3.3.3.cmml" xref="S4.Ex8.m1.11.11.3.3.3"><apply id="S4.Ex8.m1.11.11.3.3.3.4.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4"><csymbol cd="ambiguous" id="S4.Ex8.m1.11.11.3.3.3.4.1.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4">superscript</csymbol><apply id="S4.Ex8.m1.11.11.3.3.3.4.2.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4"><csymbol cd="ambiguous" id="S4.Ex8.m1.11.11.3.3.3.4.2.1.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4">subscript</csymbol><sum id="S4.Ex8.m1.11.11.3.3.3.4.2.2.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4.2.2"></sum><apply id="S4.Ex8.m1.11.11.3.3.3.4.2.3.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4.2.3"><eq id="S4.Ex8.m1.11.11.3.3.3.4.2.3.1.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4.2.3.1"></eq><ci id="S4.Ex8.m1.11.11.3.3.3.4.2.3.2.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4.2.3.2">𝑡</ci><cn id="S4.Ex8.m1.11.11.3.3.3.4.2.3.3.cmml" type="integer" xref="S4.Ex8.m1.11.11.3.3.3.4.2.3.3">1</cn></apply></apply><ci id="S4.Ex8.m1.11.11.3.3.3.4.3.cmml" xref="S4.Ex8.m1.11.11.3.3.3.4.3">𝐾</ci></apply><apply id="S4.Ex8.m1.11.11.3.3.3.3.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3"><times id="S4.Ex8.m1.11.11.3.3.3.3.4.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.4"></times><apply id="S4.Ex8.m1.11.11.3.3.3.3.5.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.5"><ci id="S4.Ex8.m1.11.11.3.3.3.3.5.1.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.5.1">∇</ci><apply id="S4.Ex8.m1.11.11.3.3.3.3.5.2.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2"><times id="S4.Ex8.m1.11.11.3.3.3.3.5.2.1.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.1"></times><ci id="S4.Ex8.m1.11.11.3.3.3.3.5.2.2.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.2">𝑙</ci><ci id="S4.Ex8.m1.11.11.3.3.3.3.5.2.3.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.3">𝑜</ci><ci id="S4.Ex8.m1.11.11.3.3.3.3.5.2.4.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.5.2.4">𝑔</ci></apply></apply><apply id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1"><times id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.2"></times><ci id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.3">𝑝</ci><apply id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><list id="S4.Ex8.m1.2.2.2.3.cmml" xref="S4.Ex8.m1.2.2.2.4"><ci id="S4.Ex8.m1.1.1.1.1.cmml" xref="S4.Ex8.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex8.m1.2.2.2.2.cmml" xref="S4.Ex8.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><list id="S4.Ex8.m1.4.4.2.3.cmml" xref="S4.Ex8.m1.4.4.2.4"><ci id="S4.Ex8.m1.3.3.1.1.cmml" xref="S4.Ex8.m1.3.3.1.1">𝑖</ci><ci id="S4.Ex8.m1.4.4.2.2.cmml" xref="S4.Ex8.m1.4.4.2.2">𝑡</ci></list></apply></apply></apply><ci id="S4.Ex8.m1.11.11.3.3.3.3.6.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.6">𝑅</ci><interval closure="open" id="S4.Ex8.m1.11.11.3.3.3.3.3.3.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.3.2"><apply id="S4.Ex8.m1.10.10.2.2.2.2.2.1.1.cmml" xref="S4.Ex8.m1.10.10.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.Ex8.m1.10.10.2.2.2.2.2.1.1.1.cmml" xref="S4.Ex8.m1.10.10.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.Ex8.m1.10.10.2.2.2.2.2.1.1.2.cmml" xref="S4.Ex8.m1.10.10.2.2.2.2.2.1.1.2">𝑎</ci><list id="S4.Ex8.m1.6.6.2.3.cmml" xref="S4.Ex8.m1.6.6.2.4"><ci id="S4.Ex8.m1.5.5.1.1.cmml" xref="S4.Ex8.m1.5.5.1.1">𝑖</ci><ci id="S4.Ex8.m1.6.6.2.2.cmml" xref="S4.Ex8.m1.6.6.2.2">𝐾</ci></list></apply><apply id="S4.Ex8.m1.11.11.3.3.3.3.3.2.2.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.11.11.3.3.3.3.3.2.2.1.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.3.2.2">subscript</csymbol><ci id="S4.Ex8.m1.11.11.3.3.3.3.3.2.2.2.cmml" xref="S4.Ex8.m1.11.11.3.3.3.3.3.2.2.2">𝑠</ci><list id="S4.Ex8.m1.8.8.2.3.cmml" xref="S4.Ex8.m1.8.8.2.4"><ci id="S4.Ex8.m1.7.7.1.1.cmml" xref="S4.Ex8.m1.7.7.1.1">𝑖</ci><ci id="S4.Ex8.m1.8.8.2.2.cmml" xref="S4.Ex8.m1.8.8.2.2">𝐾</ci></list></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex8.m1.11c">\displaystyle=\frac{1}{n}\sum_{i=1}^{n}\sum_{t=1}^{K}\nabla log(p(a_{i,t}|s_{i%
,t}))R(a_{i,K},s_{i,K})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex8.m1.11d">= divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∇ italic_l italic_o italic_g ( italic_p ( italic_a start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ) ) italic_R ( italic_a start_POSTSUBSCRIPT italic_i , italic_K end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_i , italic_K end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{n}\sum_{i=1}^{n}R(a_{i,K},s_{i,K})\sum_{t=1}^{K}\nabla
log%
(p(a_{i,t}|s_{i,t}))" class="ltx_Math" display="inline" id="S4.Ex9.m1.11"><semantics id="S4.Ex9.m1.11a"><mrow id="S4.Ex9.m1.11.11" xref="S4.Ex9.m1.11.11.cmml"><mi id="S4.Ex9.m1.11.11.5" xref="S4.Ex9.m1.11.11.5.cmml"></mi><mo id="S4.Ex9.m1.11.11.4" xref="S4.Ex9.m1.11.11.4.cmml">=</mo><mrow id="S4.Ex9.m1.11.11.3" xref="S4.Ex9.m1.11.11.3.cmml"><mstyle displaystyle="true" id="S4.Ex9.m1.11.11.3.5" xref="S4.Ex9.m1.11.11.3.5.cmml"><mfrac id="S4.Ex9.m1.11.11.3.5a" xref="S4.Ex9.m1.11.11.3.5.cmml"><mn id="S4.Ex9.m1.11.11.3.5.2" xref="S4.Ex9.m1.11.11.3.5.2.cmml">1</mn><mi id="S4.Ex9.m1.11.11.3.5.3" xref="S4.Ex9.m1.11.11.3.5.3.cmml">n</mi></mfrac></mstyle><mo id="S4.Ex9.m1.11.11.3.4" xref="S4.Ex9.m1.11.11.3.4.cmml">⁢</mo><mrow id="S4.Ex9.m1.11.11.3.3" xref="S4.Ex9.m1.11.11.3.3.cmml"><mstyle displaystyle="true" id="S4.Ex9.m1.11.11.3.3.4" xref="S4.Ex9.m1.11.11.3.3.4.cmml"><munderover id="S4.Ex9.m1.11.11.3.3.4a" xref="S4.Ex9.m1.11.11.3.3.4.cmml"><mo id="S4.Ex9.m1.11.11.3.3.4.2.2" movablelimits="false" xref="S4.Ex9.m1.11.11.3.3.4.2.2.cmml">∑</mo><mrow id="S4.Ex9.m1.11.11.3.3.4.2.3" xref="S4.Ex9.m1.11.11.3.3.4.2.3.cmml"><mi id="S4.Ex9.m1.11.11.3.3.4.2.3.2" xref="S4.Ex9.m1.11.11.3.3.4.2.3.2.cmml">i</mi><mo id="S4.Ex9.m1.11.11.3.3.4.2.3.1" xref="S4.Ex9.m1.11.11.3.3.4.2.3.1.cmml">=</mo><mn id="S4.Ex9.m1.11.11.3.3.4.2.3.3" xref="S4.Ex9.m1.11.11.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex9.m1.11.11.3.3.4.3" xref="S4.Ex9.m1.11.11.3.3.4.3.cmml">n</mi></munderover></mstyle><mrow id="S4.Ex9.m1.11.11.3.3.3" xref="S4.Ex9.m1.11.11.3.3.3.cmml"><mi id="S4.Ex9.m1.11.11.3.3.3.5" xref="S4.Ex9.m1.11.11.3.3.3.5.cmml">R</mi><mo id="S4.Ex9.m1.11.11.3.3.3.4" xref="S4.Ex9.m1.11.11.3.3.3.4.cmml">⁢</mo><mrow id="S4.Ex9.m1.10.10.2.2.2.2.2" xref="S4.Ex9.m1.10.10.2.2.2.2.3.cmml"><mo id="S4.Ex9.m1.10.10.2.2.2.2.2.3" stretchy="false" xref="S4.Ex9.m1.10.10.2.2.2.2.3.cmml">(</mo><msub id="S4.Ex9.m1.9.9.1.1.1.1.1.1" xref="S4.Ex9.m1.9.9.1.1.1.1.1.1.cmml"><mi id="S4.Ex9.m1.9.9.1.1.1.1.1.1.2" xref="S4.Ex9.m1.9.9.1.1.1.1.1.1.2.cmml">a</mi><mrow id="S4.Ex9.m1.2.2.2.4" xref="S4.Ex9.m1.2.2.2.3.cmml"><mi id="S4.Ex9.m1.1.1.1.1" xref="S4.Ex9.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex9.m1.2.2.2.4.1" xref="S4.Ex9.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex9.m1.2.2.2.2" xref="S4.Ex9.m1.2.2.2.2.cmml">K</mi></mrow></msub><mo id="S4.Ex9.m1.10.10.2.2.2.2.2.4" xref="S4.Ex9.m1.10.10.2.2.2.2.3.cmml">,</mo><msub id="S4.Ex9.m1.10.10.2.2.2.2.2.2" xref="S4.Ex9.m1.10.10.2.2.2.2.2.2.cmml"><mi id="S4.Ex9.m1.10.10.2.2.2.2.2.2.2" xref="S4.Ex9.m1.10.10.2.2.2.2.2.2.2.cmml">s</mi><mrow id="S4.Ex9.m1.4.4.2.4" xref="S4.Ex9.m1.4.4.2.3.cmml"><mi id="S4.Ex9.m1.3.3.1.1" xref="S4.Ex9.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex9.m1.4.4.2.4.1" xref="S4.Ex9.m1.4.4.2.3.cmml">,</mo><mi id="S4.Ex9.m1.4.4.2.2" xref="S4.Ex9.m1.4.4.2.2.cmml">K</mi></mrow></msub><mo id="S4.Ex9.m1.10.10.2.2.2.2.2.5" stretchy="false" xref="S4.Ex9.m1.10.10.2.2.2.2.3.cmml">)</mo></mrow><mo id="S4.Ex9.m1.11.11.3.3.3.4a" xref="S4.Ex9.m1.11.11.3.3.3.4.cmml">⁢</mo><mrow id="S4.Ex9.m1.11.11.3.3.3.3" xref="S4.Ex9.m1.11.11.3.3.3.3.cmml"><mstyle displaystyle="true" id="S4.Ex9.m1.11.11.3.3.3.3.2" xref="S4.Ex9.m1.11.11.3.3.3.3.2.cmml"><munderover id="S4.Ex9.m1.11.11.3.3.3.3.2a" xref="S4.Ex9.m1.11.11.3.3.3.3.2.cmml"><mo id="S4.Ex9.m1.11.11.3.3.3.3.2.2.2" movablelimits="false" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.2.cmml">∑</mo><mrow id="S4.Ex9.m1.11.11.3.3.3.3.2.2.3" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.cmml"><mi id="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.2" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.2.cmml">t</mi><mo id="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.1" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.1.cmml">=</mo><mn id="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.3" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex9.m1.11.11.3.3.3.3.2.3" xref="S4.Ex9.m1.11.11.3.3.3.3.2.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex9.m1.11.11.3.3.3.3.1" xref="S4.Ex9.m1.11.11.3.3.3.3.1.cmml"><mrow id="S4.Ex9.m1.11.11.3.3.3.3.1.3" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.cmml"><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.3.1" lspace="0.167em" rspace="0.167em" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.1.cmml">∇</mo><mrow id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.cmml"><mi id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.2" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.2.cmml">l</mi><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.1" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.1.cmml">⁢</mo><mi id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.3" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.3.cmml">o</mi><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.1a" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.1.cmml">⁢</mo><mi id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.4" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.4.cmml">g</mi></mrow></mrow><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.2" xref="S4.Ex9.m1.11.11.3.3.3.3.1.2.cmml">⁢</mo><mrow id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.cmml"><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.2" stretchy="false" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.cmml"><mi id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.3" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.3.cmml">p</mi><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.2" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2.2" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2.2.cmml">a</mi><mrow id="S4.Ex9.m1.6.6.2.4" xref="S4.Ex9.m1.6.6.2.3.cmml"><mi id="S4.Ex9.m1.5.5.1.1" xref="S4.Ex9.m1.5.5.1.1.cmml">i</mi><mo id="S4.Ex9.m1.6.6.2.4.1" xref="S4.Ex9.m1.6.6.2.3.cmml">,</mo><mi id="S4.Ex9.m1.6.6.2.2" xref="S4.Ex9.m1.6.6.2.2.cmml">t</mi></mrow></msub><mo fence="false" id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3.2" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="S4.Ex9.m1.8.8.2.4" xref="S4.Ex9.m1.8.8.2.3.cmml"><mi id="S4.Ex9.m1.7.7.1.1" xref="S4.Ex9.m1.7.7.1.1.cmml">i</mi><mo id="S4.Ex9.m1.8.8.2.4.1" xref="S4.Ex9.m1.8.8.2.3.cmml">,</mo><mi id="S4.Ex9.m1.8.8.2.2" xref="S4.Ex9.m1.8.8.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.3" stretchy="false" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex9.m1.11b"><apply id="S4.Ex9.m1.11.11.cmml" xref="S4.Ex9.m1.11.11"><eq id="S4.Ex9.m1.11.11.4.cmml" xref="S4.Ex9.m1.11.11.4"></eq><csymbol cd="latexml" id="S4.Ex9.m1.11.11.5.cmml" xref="S4.Ex9.m1.11.11.5">absent</csymbol><apply id="S4.Ex9.m1.11.11.3.cmml" xref="S4.Ex9.m1.11.11.3"><times id="S4.Ex9.m1.11.11.3.4.cmml" xref="S4.Ex9.m1.11.11.3.4"></times><apply id="S4.Ex9.m1.11.11.3.5.cmml" xref="S4.Ex9.m1.11.11.3.5"><divide id="S4.Ex9.m1.11.11.3.5.1.cmml" xref="S4.Ex9.m1.11.11.3.5"></divide><cn id="S4.Ex9.m1.11.11.3.5.2.cmml" type="integer" xref="S4.Ex9.m1.11.11.3.5.2">1</cn><ci id="S4.Ex9.m1.11.11.3.5.3.cmml" xref="S4.Ex9.m1.11.11.3.5.3">𝑛</ci></apply><apply id="S4.Ex9.m1.11.11.3.3.cmml" xref="S4.Ex9.m1.11.11.3.3"><apply id="S4.Ex9.m1.11.11.3.3.4.cmml" xref="S4.Ex9.m1.11.11.3.3.4"><csymbol cd="ambiguous" id="S4.Ex9.m1.11.11.3.3.4.1.cmml" xref="S4.Ex9.m1.11.11.3.3.4">superscript</csymbol><apply id="S4.Ex9.m1.11.11.3.3.4.2.cmml" xref="S4.Ex9.m1.11.11.3.3.4"><csymbol cd="ambiguous" id="S4.Ex9.m1.11.11.3.3.4.2.1.cmml" xref="S4.Ex9.m1.11.11.3.3.4">subscript</csymbol><sum id="S4.Ex9.m1.11.11.3.3.4.2.2.cmml" xref="S4.Ex9.m1.11.11.3.3.4.2.2"></sum><apply id="S4.Ex9.m1.11.11.3.3.4.2.3.cmml" xref="S4.Ex9.m1.11.11.3.3.4.2.3"><eq id="S4.Ex9.m1.11.11.3.3.4.2.3.1.cmml" xref="S4.Ex9.m1.11.11.3.3.4.2.3.1"></eq><ci id="S4.Ex9.m1.11.11.3.3.4.2.3.2.cmml" xref="S4.Ex9.m1.11.11.3.3.4.2.3.2">𝑖</ci><cn id="S4.Ex9.m1.11.11.3.3.4.2.3.3.cmml" type="integer" xref="S4.Ex9.m1.11.11.3.3.4.2.3.3">1</cn></apply></apply><ci id="S4.Ex9.m1.11.11.3.3.4.3.cmml" xref="S4.Ex9.m1.11.11.3.3.4.3">𝑛</ci></apply><apply id="S4.Ex9.m1.11.11.3.3.3.cmml" xref="S4.Ex9.m1.11.11.3.3.3"><times id="S4.Ex9.m1.11.11.3.3.3.4.cmml" xref="S4.Ex9.m1.11.11.3.3.3.4"></times><ci id="S4.Ex9.m1.11.11.3.3.3.5.cmml" xref="S4.Ex9.m1.11.11.3.3.3.5">𝑅</ci><interval closure="open" id="S4.Ex9.m1.10.10.2.2.2.2.3.cmml" xref="S4.Ex9.m1.10.10.2.2.2.2.2"><apply id="S4.Ex9.m1.9.9.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex9.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.9.9.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex9.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S4.Ex9.m1.9.9.1.1.1.1.1.1.2">𝑎</ci><list id="S4.Ex9.m1.2.2.2.3.cmml" xref="S4.Ex9.m1.2.2.2.4"><ci id="S4.Ex9.m1.1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex9.m1.2.2.2.2.cmml" xref="S4.Ex9.m1.2.2.2.2">𝐾</ci></list></apply><apply id="S4.Ex9.m1.10.10.2.2.2.2.2.2.cmml" xref="S4.Ex9.m1.10.10.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.10.10.2.2.2.2.2.2.1.cmml" xref="S4.Ex9.m1.10.10.2.2.2.2.2.2">subscript</csymbol><ci id="S4.Ex9.m1.10.10.2.2.2.2.2.2.2.cmml" xref="S4.Ex9.m1.10.10.2.2.2.2.2.2.2">𝑠</ci><list id="S4.Ex9.m1.4.4.2.3.cmml" xref="S4.Ex9.m1.4.4.2.4"><ci id="S4.Ex9.m1.3.3.1.1.cmml" xref="S4.Ex9.m1.3.3.1.1">𝑖</ci><ci id="S4.Ex9.m1.4.4.2.2.cmml" xref="S4.Ex9.m1.4.4.2.2">𝐾</ci></list></apply></interval><apply id="S4.Ex9.m1.11.11.3.3.3.3.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3"><apply id="S4.Ex9.m1.11.11.3.3.3.3.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.11.11.3.3.3.3.2.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2">superscript</csymbol><apply id="S4.Ex9.m1.11.11.3.3.3.3.2.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.11.11.3.3.3.3.2.2.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2">subscript</csymbol><sum id="S4.Ex9.m1.11.11.3.3.3.3.2.2.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.2"></sum><apply id="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.3"><eq id="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.1"></eq><ci id="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.2">𝑡</ci><cn id="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.3.cmml" type="integer" xref="S4.Ex9.m1.11.11.3.3.3.3.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex9.m1.11.11.3.3.3.3.2.3.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.2.3">𝐾</ci></apply><apply id="S4.Ex9.m1.11.11.3.3.3.3.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1"><times id="S4.Ex9.m1.11.11.3.3.3.3.1.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.2"></times><apply id="S4.Ex9.m1.11.11.3.3.3.3.1.3.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3"><ci id="S4.Ex9.m1.11.11.3.3.3.3.1.3.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.1">∇</ci><apply id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2"><times id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.1"></times><ci id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.2">𝑙</ci><ci id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.3.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.3">𝑜</ci><ci id="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.4.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.3.2.4">𝑔</ci></apply></apply><apply id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1"><times id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.2"></times><ci id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.3.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.3">𝑝</ci><apply id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.2.2">𝑎</ci><list id="S4.Ex9.m1.6.6.2.3.cmml" xref="S4.Ex9.m1.6.6.2.4"><ci id="S4.Ex9.m1.5.5.1.1.cmml" xref="S4.Ex9.m1.5.5.1.1">𝑖</ci><ci id="S4.Ex9.m1.6.6.2.2.cmml" xref="S4.Ex9.m1.6.6.2.2">𝑡</ci></list></apply><apply id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex9.m1.11.11.3.3.3.3.1.1.1.1.1.1.1.3.2">𝑠</ci><list id="S4.Ex9.m1.8.8.2.3.cmml" xref="S4.Ex9.m1.8.8.2.4"><ci id="S4.Ex9.m1.7.7.1.1.cmml" xref="S4.Ex9.m1.7.7.1.1">𝑖</ci><ci id="S4.Ex9.m1.8.8.2.2.cmml" xref="S4.Ex9.m1.8.8.2.2">𝑡</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex9.m1.11c">\displaystyle=\frac{1}{n}\sum_{i=1}^{n}R(a_{i,K},s_{i,K})\sum_{t=1}^{K}\nabla
log%
(p(a_{i,t}|s_{i,t}))</annotation><annotation encoding="application/x-llamapun" id="S4.Ex9.m1.11d">= divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_R ( italic_a start_POSTSUBSCRIPT italic_i , italic_K end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_i , italic_K end_POSTSUBSCRIPT ) ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∇ italic_l italic_o italic_g ( italic_p ( italic_a start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.2">With the policy gradient computed, we optimize the parameters of policy model defined in section <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4.SS2" title="4.2 Scoring Policy ‣ 4 Methodology ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">4.2</span></a>. We compute the performance on validation set to control the termination of iterating process. In practice, we sample a small subset from the original training dataset to compose the candidate example set <math alttext="C" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><mi id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><ci id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">italic_C</annotation></semantics></math> and another disjoint subset to form <math alttext="T" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.1"><semantics id="S4.SS3.p4.2.m2.1a"><mi id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.1d">italic_T</annotation></semantics></math> to train our RLS algorithm.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T4.1">
<tr class="ltx_tr" id="S4.T4.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T4.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T4.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T4.1.1.2">ROUGE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S4.T4.1.1.3">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T4.1.1.4">F-score</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.1.1">RL</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.2.1">R1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.3.1">R2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.4.1">B1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.5"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.5.1">B2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.6"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.6.1">B3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.7"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.7.1">B4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.8"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.8.1">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.9"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.9.1">F2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.10"><span class="ltx_text ltx_font_bold" id="S4.T4.1.2.10.1">F3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T4.1.3.1">Random</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.2">52.41</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.3">54.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.4">38.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.5">48.40</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.6">40.80</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.7">35.08</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.8">29.70</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.9">25.03</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.10">17.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.11">14.26</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.4.1">BM25</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.2">53.92</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.3">56.16</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.4">40.14</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.5">51.03</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.6">43.05</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.7">37.03</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.8">31.44</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.9">30.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.10">20.19</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.11">15.62</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.5.1">KATE</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.2">53.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.3">55.24</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.4">39.61</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.5">49.31</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.6">41.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.7">35.82</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.8">30.47</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.9">28.99</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.5.10">19.51</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.11">15.23</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.6.1">EPR</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.2">54.08</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.3">56.26</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.4">40.23</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.5">51.59</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.6">43.54</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.7">37.51</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.8">31.91</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.9">29.59</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.6.10">19.96</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.11">15.62</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.7.1">BSR</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.2">54.28</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.3">56.39</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.4">40.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.5">51.99</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.6">44.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.7">38.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.8">32.44</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.9">29.61</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.7.10">20.15</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.7.11">15.90</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.2.1">55.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.3.1">57.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.4.1">42.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.5"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.5.1">53.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.6"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.6.1">45.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.7"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.7.1">39.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.8"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.8.1">34.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.9"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.9.1">29.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T4.1.8.10"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.10.1">20.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T4.1.8.11"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.11.1">16.46</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span> ICL Evaluations of ChatGLM with 5-shot demonstrations on CANARD dataset. Our approach significantly outperforms existing example selection methods, where p-values of ROUGE, BLEU and F-score are smaller
than 0.001.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T5">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T5.1">
<tr class="ltx_tr" id="S4.T5.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T5.1.1.1" rowspan="3"><span class="ltx_text" id="S4.T5.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="6" id="S4.T5.1.1.2">TASK</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S4.T5.1.1.3">REWRITE</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T5.1.2.1">ROUGE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T5.1.2.2">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T5.1.2.3">ROUGE</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T5.1.2.4">BLEU</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.1.1">RL</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.2.1">R1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.3.1">R2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.4.1">B1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.5.1">B2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.6.1">B3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.7"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.7.1">RL</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.8"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.8.1">R1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.9"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.9.1">R2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.10"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.10.1">B1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.3.11"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.11.1">B2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.12"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.12.1">B3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T5.1.4.1">Random</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.2">44.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.3">45.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.4">31.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.5">34.1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.6">28.6</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.7">25.3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.8">64.4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.9">66.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.10">54.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.11">61.2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.4.12">55.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.4.13">49.7</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.5.1">BM25</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.2">46.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.3">47.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.4">34.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.5">33.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.6">27.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.7">24.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.8">64.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.9">67.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.10">55.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.11">65.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.12">60.1</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.13">54.7</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.6.1">KATE</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.2">45.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.3">47.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.4">34.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.5">33.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.6">28.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.7">25.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.8">63.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.9">65.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.10">53.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.11">61.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.12">55.9</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.6.13">50.2</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.7.1">EPR</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.2">49.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.3">50.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.4">37.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.5">35.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.6">30.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.7">27.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.8">65.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.9">68.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.10">56.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.11">66.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.12">61.1</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.13">55.8</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.8.1">BSR</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.2">49.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.3">51.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.4">37.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.5">35.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.6">29.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.7">26.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.8">65.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.9">68.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.10">56.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.11">65.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.12">60.1</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.8.13">54.7</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.9">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.2.1">57.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.3.1">57.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.4.1">45.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.5.1">43.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.6.1">38.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.7"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.7.1">35.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.8"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.8.1">66.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.9"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.9.1">68.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.10"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.10.1">56.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.11"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.11.1">67.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.9.12"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.12.1">61.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T5.1.9.13"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.13.1">56.4</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span> ICL Evaluations of ChatGLM with 5-shot demonstrations on Task and REWRITE dataset. Our approach significantly outperforms existing example selection methods, where p-values of ROUGE, BLEU and F-score are smaller
than 0.001.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets and LLM</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Following <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib18" title="">2020</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citet">Inoue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib11" title="">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib32" title="">2022</a>)</cite> we conduct experiments on three benchmark datasets across different languages and domains in IUR field. CANARD dataset <cite class="ltx_cite ltx_citemacro_cite">Elgohary et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib6" title="">2019</a>)</cite> includes English conversational question answering; TASK dataset <cite class="ltx_cite ltx_citemacro_cite">Quan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib21" title="">2019</a>)</cite> contains task-oriented English dialogues; REWRITE dataset <cite class="ltx_cite ltx_citemacro_cite">Su et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib28" title="">2019</a>)</cite> is composed of open-domain Chinese dialogues.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">We choose ChatGLM-6B<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/THUDM/ChatGLM-6B</span></span></span> as the LLM <math alttext="f_{M}" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><msub id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><mi id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml">f</mi><mi id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2">𝑓</ci><ci id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">f_{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> which does not conduct parameter updating. ChatGLM is a bilingual large language model pretrained by supervised finetuning, instruction tuning and human feedback reinforcement learning, which is suitable for our bilingual datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Metrics</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Following <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib18" title="">2020</a>); Inoue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib11" title="">2022</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib32" title="">2022</a>)</cite> , we utilize BLEU <cite class="ltx_cite ltx_citemacro_cite">Papineni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib20" title="">2002</a>)</cite>, ROUGE <cite class="ltx_cite ltx_citemacro_cite">Lin (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib15" title="">2004</a>)</cite> and F-score to evaluate the IUR task.
BLEU and ROUGE focus on the overall quality of the rewritten utterance and F-score concentrate more on words from the context (important words) which are argued to be harder to copy <cite class="ltx_cite ltx_citemacro_cite">Pan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib19" title="">2019</a>); Inoue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib11" title="">2022</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Baselines</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We compare our approaches with competitive example selection methods as follows:</p>
</div>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Random</h4>
<div class="ltx_para" id="S5.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px1.p1.1">In this baseline, we randomly select the examples from candidate set to formulate the demonstration.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">BM25</h4>
<div class="ltx_para" id="S5.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px2.p1.1"><cite class="ltx_cite ltx_citemacro_cite">Robertson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib25" title="">2009</a>)</cite> In this baseline, first we utilize SpaCy NLP tools <cite class="ltx_cite ltx_citemacro_cite">Vasiliev (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib31" title="">2020</a>)</cite> to stem words in the context and incomplete utterance of each case. Then BM25 method is adopted to estimate the relevance of examples to a given test case. The top-k relevant examples are selected to formulate the demonstration. It belongs to the sparse retrieval methods.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">KATE</h4>
<div class="ltx_para" id="S5.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px3.p1.1"><cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib16" title="">2022</a>)</cite> make use of SBERT <cite class="ltx_cite ltx_citemacro_cite">Reimers and Gurevych (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib24" title="">2019</a>)</cite> to select examples which are semantically similar to the test sample and build a kNN-based unsupervised retriever. It belongs to the dense retrieval methods.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">EPR</h4>
<div class="ltx_para" id="S5.SS3.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px4.p1.1"><cite class="ltx_cite ltx_citemacro_citet">Rubin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib26" title="">2021</a>)</cite> assume the unsupervised retriever can act as the guide to the LM retriever and propose a two-stage approach. It first builds an unsupervised
retriever (e.g., BM25) to recall surface similar
examples as candidates and then constructs a supervised
retriever EPR to select demonstrations from candidates. It can be seen as a combination of sparse and dense retrieval methods.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS3.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">BSR</h4>
<div class="ltx_para" id="S5.SS3.SSS0.Px5.p1">
<p class="ltx_p" id="S5.SS3.SSS0.Px5.p1.1"><cite class="ltx_cite ltx_citemacro_citet">Gupta et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib8" title="">2023</a>)</cite>
propose a novel framework for
selecting sets of maximally informative demonstrations for the salient aspects of the test input,
e.g., reasoning patterns, entities, etc. Examples selected using this framework are informative about
the test input and help the LLM understand and
perform the task</p>
</div>
<div class="ltx_para" id="S5.SS3.SSS0.Px5.p2">
<p class="ltx_p" id="S5.SS3.SSS0.Px5.p2.1">However, these methods fail to directly utilize the feedback by LLM and the examples selected can not necessarily improve the analogy ability of LLM.</p>
</div>
<figure class="ltx_table" id="S5.T6">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T6.1">
<tr class="ltx_tr" id="S5.T6.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T6.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T6.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T6.1.1.2">ROUGE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T6.1.1.3">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T6.1.1.4">F-score</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.1.1">RL</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.2.1">R1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.3.1">R2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.4"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.4.1">B1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.5"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.5.1">B2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.6"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.6.1">B3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.7"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.7.1">B4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.8"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.8.1">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.2.9"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.9.1">F2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.2.10"><span class="ltx_text ltx_font_bold" id="S5.T6.1.2.10.1">F3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T6.1.3.1">Ours (100-100)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.2">54.22</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.3">56.13</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.4">40.86</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.5">51.08</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.6">43.49</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.7">37.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.8">32.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.9">28.60</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.3.10">20.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.11">16.08</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T6.1.4.1">Ours (100-500)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.2">55.08</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.3">56.51</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.4">41.81</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.5">51.77</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.6">44.62</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.7">39.06</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.8">33.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.9">27.17</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.4.10">20.18</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.11">16.59</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T6.1.5.1">Ours (500-100)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.2">54.12</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.3">56.29</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.4">40.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.5">51.49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.6">43.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.7">37.74</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.8">32.22</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.9">29.82</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.5.10">20.29</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.5.11">15.90</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.6">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.1">Ours (500-500)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.2.1">55.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.3.1">57.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.4"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.4.1">42.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.5"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.5.1">53.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.6"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.6.1">45.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.7"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.7.1">39.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.8"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.8.1">34.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.9"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.9.1">30.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.6.10"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.10.1">20.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T6.1.6.11"><span class="ltx_text ltx_font_bold" id="S5.T6.1.6.11.1">16.46</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span> Evaluations of ChatGLM with different sizes of candidates and training samples on CANARD dataset. “500-100” denotes experiments with 500 candidates and 100 training samples, and so on.</figcaption>
</figure>
<figure class="ltx_table" id="S5.T7">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T7.1">
<tr class="ltx_tr" id="S5.T7.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T7.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T7.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T7.1.1.2">ROUGE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T7.1.1.3">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T7.1.1.4">F-score</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.1.1">RL</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.2.1">R1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.3.1">R2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.4.1">B1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.5"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.5.1">B2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.6"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.6.1">B3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.7"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.7.1">B4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.8"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.8.1">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.9"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.9.1">F2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.2.10"><span class="ltx_text ltx_font_bold" id="S5.T7.1.2.10.1">F3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T7.1.3.1">EPR-3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.2">53.91</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.3">55.92</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.4">40.14</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.5">51.44</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.6">43.47</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.7">37.45</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.8">31.86</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.9">29.15</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.3.10">20.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.3.11">15.83</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T7.1.4.1">Ours-3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.2">54.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.3">56.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.4">41.22</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.5">49.45</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.6">42.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.7">37.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.8">32.53</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.9">29.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.4.10">20.15</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.4.11">16.03</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T7.1.5.1">EPR-4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.2">54.12</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.3">56.27</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.4">40.45</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.5">51.36</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.6">43.40</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.7">37.37</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.8">31.76</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.9">29.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.5.10">20.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.5.11">15.59</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T7.1.6.1">Ours-4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.2">55.11</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.3">57.29</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.4">41.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.5">52.71</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.6">44.81</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.7">38.84</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.8">33.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.9"><span class="ltx_text ltx_font_bold" id="S5.T7.1.6.9.1">30.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.6.10"><span class="ltx_text ltx_font_bold" id="S5.T7.1.6.10.1">21.12</span></td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.6.11"><span class="ltx_text ltx_font_bold" id="S5.T7.1.6.11.1">16.75</span></td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T7.1.7.1">EPR-5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.2">54.08</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.3">56.26</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.4">40.23</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.5">51.59</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.6">43.54</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.7">37.51</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.8">31.91</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.9">29.59</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.7.10">19.96</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.7.11">15.62</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S5.T7.1.8.1">Ours-5</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.8.2.1">55.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.8.3.1">57.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.8.4.1">42.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.5"><span class="ltx_text ltx_font_bold" id="S5.T7.1.8.5.1">53.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.6"><span class="ltx_text ltx_font_bold" id="S5.T7.1.8.6.1">45.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.7"><span class="ltx_text ltx_font_bold" id="S5.T7.1.8.7.1">39.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.8"><span class="ltx_text ltx_font_bold" id="S5.T7.1.8.8.1">34.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.9">29.52</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.8.10">20.59</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T7.1.8.11">16.46</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span> Evaluations of ChatGLM with different numbers of examples in the demonstration on CANARD dataset. “EPR-3” denotes the baseline EPR with 3 examples in the demonstration.</figcaption>
</figure>
<figure class="ltx_table" id="S5.T8">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T8.1">
<tr class="ltx_tr" id="S5.T8.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T8.1.1.1">Model</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T8.1.1.2">F1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T8.1.1.3">F2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.1.1.4">F3</td>
</tr>
<tr class="ltx_tr" id="S5.T8.1.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T8.1.2.1">QUEEN</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T8.1.2.2">20.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T8.1.2.3">13.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.1.2.4">11.59</td>
</tr>
<tr class="ltx_tr" id="S5.T8.1.3">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S5.T8.1.3.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T8.1.3.2">29.52</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T8.1.3.3">20.59</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T8.1.3.4">16.46</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span> Comparing with SFT model in few-shot setting.</figcaption>
</figure>
<figure class="ltx_table" id="S5.T9">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T9.1">
<tr class="ltx_tr" id="S5.T9.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T9.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T9.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T9.1.1.2">Incomplete</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T9.1.1.3">Rewritten</td>
</tr>
<tr class="ltx_tr" id="S5.T9.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T9.1.2.1.1">Length</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.2.2"><span class="ltx_text ltx_font_bold" id="S5.T9.1.2.2.1">POS</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.2.3"><span class="ltx_text ltx_font_bold" id="S5.T9.1.2.3.1">Chunk</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.2.4"><span class="ltx_text ltx_font_bold" id="S5.T9.1.2.4.1">Length</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.2.5"><span class="ltx_text ltx_font_bold" id="S5.T9.1.2.5.1">POS</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.1.2.6"><span class="ltx_text ltx_font_bold" id="S5.T9.1.2.6.1">Chunk</span></td>
</tr>
<tr class="ltx_tr" id="S5.T9.1.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T9.1.3.1">BSR</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.3.2">8.55</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.3.3">6.29</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.3.4">2.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.3.5">11.91</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T9.1.3.6">7.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T9.1.3.7">3.45</td>
</tr>
<tr class="ltx_tr" id="S5.T9.1.4">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S5.T9.1.4.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T9.1.4.2"><span class="ltx_text ltx_font_bold" id="S5.T9.1.4.2.1">10.81</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T9.1.4.3"><span class="ltx_text ltx_font_bold" id="S5.T9.1.4.3.1">6.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T9.1.4.4"><span class="ltx_text ltx_font_bold" id="S5.T9.1.4.4.1">3.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T9.1.4.5"><span class="ltx_text ltx_font_bold" id="S5.T9.1.4.5.1">13.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T9.1.4.6"><span class="ltx_text ltx_font_bold" id="S5.T9.1.4.6.1">7.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T9.1.4.7"><span class="ltx_text ltx_font_bold" id="S5.T9.1.4.7.1">4.03</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span> Complexity and abundance of example selected. “Incomplete” denotes the metrics of incomplete utterance.“Rewritten” denotes the metrics of rewritten utterance,
“Length”, “POS”, and “Chunk” denote utterance length, number of POS types and number of text chunks respectively.
</figcaption>
</figure>
<figure class="ltx_table" id="S5.T10">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T10.1">
<tr class="ltx_tr" id="S5.T10.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T10.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T10.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T10.1.1.2">ROUGE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T10.1.1.3">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T10.1.1.4">F-score</td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.1.1">RL</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.2"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.2.1">R1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.3"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.3.1">R2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.4"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.4.1">B1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.5"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.5.1">B2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.6"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.6.1">B3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.7"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.7.1">B4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.8"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.8.1">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.2.9"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.9.1">F2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T10.1.2.10"><span class="ltx_text ltx_font_bold" id="S5.T10.1.2.10.1">F3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T10.1.3.1">Length</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.2">50.84</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.3">52.13</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.4">37.17</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.5">46.76</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.6">39.41</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.7">33.89</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.8">28.67</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.9">19.95</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T10.1.3.10">14.46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T10.1.3.11">11.99</td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T10.1.4.1">POS</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.2">52.17</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.3">53.77</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.4">38.69</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.5">47.92</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.6">40.44</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.7">34.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.8">29.46</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.9">23.89</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.4.10">17.09</td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.4.11">13.92</td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T10.1.5.1">Chunk</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.2">53.68</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.3">55.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.4">40.34</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.5">52.09</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.6">44.68</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.7">38.86</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.8">33.29</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.9">24.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T10.1.5.10">18.15</td>
<td class="ltx_td ltx_align_center" id="S5.T10.1.5.11">14.90</td>
</tr>
<tr class="ltx_tr" id="S5.T10.1.6">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.2"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.2.1">55.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.3"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.3.1">57.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.4"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.4.1">42.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.5"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.5.1">53.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.6"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.6.1">45.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.7"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.7.1">39.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.8"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.8.1">34.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.9"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.9.1">29.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T10.1.6.10"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.10.1">20.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T10.1.6.11"><span class="ltx_text ltx_font_bold" id="S5.T10.1.6.11.1">16.46</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span> ICL Evaluations of ChatGLM with 5-shot demonstrations on CANARD dataset.</figcaption>
</figure>
<figure class="ltx_table" id="S5.T11">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T11.1">
<tr class="ltx_tr" id="S5.T11.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T11.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T11.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T11.1.1.2">ROUGE</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T11.1.1.3">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T11.1.1.4">F-score</td>
</tr>
<tr class="ltx_tr" id="S5.T11.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.1.1">RL</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.2"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.2.1">R1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.3"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.3.1">R2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.4"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.4.1">B1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.5"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.5.1">B2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.6"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.6.1">B3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.7"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.7.1">B4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.8"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.8.1">F1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.2.9"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.9.1">F2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T11.1.2.10"><span class="ltx_text ltx_font_bold" id="S5.T11.1.2.10.1">F3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T11.1.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T11.1.3.1">Random</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.2">78.07</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.3">79.34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.4">66.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.5">69.05</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.6">64.15</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.7">60.26</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.8">56.35</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.9">52.86</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.3.10">43.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T11.1.3.11">38.14</td>
</tr>
<tr class="ltx_tr" id="S5.T11.1.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T11.1.4.1">BSR</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.2">80.13</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.3">81.24</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.4">68.78</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.5">73.54</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.6">67.37</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.7">65.42</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.8">59.78</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.9">56.16</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T11.1.4.10">48.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T11.1.4.11">44.89</td>
</tr>
<tr class="ltx_tr" id="S5.T11.1.5">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.2"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.2.1">82.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.3"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.3.1">84.04</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.4"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.4.1">70.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.5"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.5.1">79.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.6"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.6.1">73.81</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.7"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.7.1">69.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.8"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.8.1">65.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.9"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.9.1">62.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T11.1.5.10"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.10.1">52.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T11.1.5.11"><span class="ltx_text ltx_font_bold" id="S5.T11.1.5.11.1">47.30</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span> ICL Evaluations of gpt3.5 with 5-shot demonstrations on TASK dataset.</figcaption>
</figure>
<figure class="ltx_table" id="S5.T12">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T12.1">
<tr class="ltx_tr" id="S5.T12.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T12.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T12.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T12.1.1.2">ROUGE</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T12.1.1.3">BLEU</td>
</tr>
<tr class="ltx_tr" id="S5.T12.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T12.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T12.1.2.1.1">R1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T12.1.2.2"><span class="ltx_text ltx_font_bold" id="S5.T12.1.2.2.1">R2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T12.1.2.3"><span class="ltx_text ltx_font_bold" id="S5.T12.1.2.3.1">B1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T12.1.2.4"><span class="ltx_text ltx_font_bold" id="S5.T12.1.2.4.1">B2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.1.2.5"><span class="ltx_text ltx_font_bold" id="S5.T12.1.2.5.1">B3</span></td>
</tr>
<tr class="ltx_tr" id="S5.T12.1.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T12.1.3.1">BSR</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T12.1.3.2">51.6</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T12.1.3.3">37.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T12.1.3.4">35.2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T12.1.3.5">29.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T12.1.3.6">26.4</td>
</tr>
<tr class="ltx_tr" id="S5.T12.1.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T12.1.4.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T12.1.4.2">57.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T12.1.4.3">45.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T12.1.4.4">43.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T12.1.4.5">38.3</td>
<td class="ltx_td ltx_align_center" id="S5.T12.1.4.6">35.2</td>
</tr>
<tr class="ltx_tr" id="S5.T12.1.5">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S5.T12.1.5.1">Ours(r)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T12.1.5.2">57.6</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T12.1.5.3">44.5</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T12.1.5.4">43.3</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T12.1.5.5">38.6</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T12.1.5.6">34.9</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 12: </span> ICL Evaluations of example orders with ChatGLM on TASK dataset.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Experimental Details</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.2">Following <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib16" title="">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Rubin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib26" title="">2021</a>)</cite> we utilize SentenceBERT <cite class="ltx_cite ltx_citemacro_cite">Reimers and Gurevych (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib24" title="">2019</a>)</cite> as LM selector for English datasets and bert-base-Chinese for Chinese datasets. The sizes of candidate example set <math alttext="C" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><mi id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><ci id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">italic_C</annotation></semantics></math> and training set <math alttext="T" class="ltx_Math" display="inline" id="S5.SS4.p1.2.m2.1"><semantics id="S5.SS4.p1.2.m2.1a"><mi id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><ci id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.1d">italic_T</annotation></semantics></math> are 500. The learning rate is set to be 1e-5. The task instruction in section <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S3" title="3 Task Definition ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">3</span></a> is designed as “Rewrite an incomplete utterance into an utterance which is semantically equivalent but self-contained to be understood without context. The sentence structure and expression should be consistent.” for English dataset and its translated version for Chinese dataset.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Results</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4.T4" title="Table 4 ‣ 4.3 Policy Iterating ‣ 4 Methodology ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">4</span></a>, our approach outperforms all the baselines by about 1.2-1.7 ROUGE score, 1.3-2.5 BLEU score, 0.4 F2 score and 0.6 F3 score in CANARD dataset. It demonstrates the efficiency of directly utilizing feedback by LLM and RL policy gradient to train the LM selector. With the examples selected by our method, the performances of LLM are significantly improved. Our model not only improves the overall quality of utterance rewritten, but also captures the important words from the context.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1">Compared with Random selecting examples, both BM25 and KATE baselines derive better performance. It shows the textual similarity captured by sparse retrieval like BM25 and the semantic similarity captured by KATE can help select better examples to prompt the LLM for IUR task.
EPR and BSR show an overall better performance compared with the sole sparse or dense retrieval methods. It demonstrates the combination of sparse or dense retrieval can capture both the textual and semantic similarity between candidate examples and the test case. The examples selected are better prompts to LLM for IUR task.
Compared with EPR, BSR behaves a better performance across different metrics. BM25 behaves as the effective supervision for the LM retriever and releasing the constraint can improve the example selection furthermore.</p>
</div>
<div class="ltx_para" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1">In TASK dataset, our approach outperforms all the baselines by about
6.3-7.5 ROUGE score and 7.6-8.2 BLEU score. Compared with CANARD dataset, TASK contains more complex and diverse dialogue topics. It demonstrates the efficiency of utilizing direct LLM feedback to train the LM retriever and select examples to prompt the LLM for IUR task.
In REWRTTE dataset, our approach outperforms all the baselines by about 0.6 ROUGE and BLEU score, which shows our stable efficiency with different languages.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Analysis</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this part, first we explore our performance with different sizes of candidate set and training set. Then we probe the effect of different numbers of examples in demonstrations. Furthermore, we compare our approach with the SFT method in few shot setting. Finally, we explore the reason why examples selected by our approach can improve the analogy ability of LLM.</p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Different Sizes of Candidates and Training Samples</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.5">In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4.T4" title="Table 4 ‣ 4.3 Policy Iterating ‣ 4 Methodology ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">4</span></a>, the number of candidates <math alttext="\#C" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.1"><semantics id="S6.SS1.p1.1.m1.1a"><mrow id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml"><mi id="S6.SS1.p1.1.m1.1.1.2" mathvariant="normal" xref="S6.SS1.p1.1.m1.1.1.2.cmml">#</mi><mo id="S6.SS1.p1.1.m1.1.1.1" xref="S6.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.p1.1.m1.1.1.3" xref="S6.SS1.p1.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"><times id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1.1"></times><ci id="S6.SS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2">#</ci><ci id="S6.SS1.p1.1.m1.1.1.3.cmml" xref="S6.SS1.p1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">\#C</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.1d"># italic_C</annotation></semantics></math> and training samples <math alttext="\#T" class="ltx_Math" display="inline" id="S6.SS1.p1.2.m2.1"><semantics id="S6.SS1.p1.2.m2.1a"><mrow id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml"><mi id="S6.SS1.p1.2.m2.1.1.2" mathvariant="normal" xref="S6.SS1.p1.2.m2.1.1.2.cmml">#</mi><mo id="S6.SS1.p1.2.m2.1.1.1" xref="S6.SS1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S6.SS1.p1.2.m2.1.1.3" xref="S6.SS1.p1.2.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><apply id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1"><times id="S6.SS1.p1.2.m2.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1"></times><ci id="S6.SS1.p1.2.m2.1.1.2.cmml" xref="S6.SS1.p1.2.m2.1.1.2">#</ci><ci id="S6.SS1.p1.2.m2.1.1.3.cmml" xref="S6.SS1.p1.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">\#T</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.2.m2.1d"># italic_T</annotation></semantics></math> are 500. In this part, we do further experiments with <math alttext="\mathbf{\#C}=100,\mathbf{\#T}=100" class="ltx_Math" display="inline" id="S6.SS1.p1.3.m3.2"><semantics id="S6.SS1.p1.3.m3.2a"><mrow id="S6.SS1.p1.3.m3.2.2.2" xref="S6.SS1.p1.3.m3.2.2.3.cmml"><mrow id="S6.SS1.p1.3.m3.1.1.1.1" xref="S6.SS1.p1.3.m3.1.1.1.1.cmml"><mrow id="S6.SS1.p1.3.m3.1.1.1.1.2" xref="S6.SS1.p1.3.m3.1.1.1.1.2.cmml"><mi id="S6.SS1.p1.3.m3.1.1.1.1.2.2" mathvariant="normal" xref="S6.SS1.p1.3.m3.1.1.1.1.2.2.cmml">#</mi><mo id="S6.SS1.p1.3.m3.1.1.1.1.2.1" xref="S6.SS1.p1.3.m3.1.1.1.1.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.3.m3.1.1.1.1.2.3" xref="S6.SS1.p1.3.m3.1.1.1.1.2.3.cmml">𝐂</mi></mrow><mo id="S6.SS1.p1.3.m3.1.1.1.1.1" xref="S6.SS1.p1.3.m3.1.1.1.1.1.cmml">=</mo><mn id="S6.SS1.p1.3.m3.1.1.1.1.3" xref="S6.SS1.p1.3.m3.1.1.1.1.3.cmml">100</mn></mrow><mo id="S6.SS1.p1.3.m3.2.2.2.3" xref="S6.SS1.p1.3.m3.2.2.3a.cmml">,</mo><mrow id="S6.SS1.p1.3.m3.2.2.2.2" xref="S6.SS1.p1.3.m3.2.2.2.2.cmml"><mrow id="S6.SS1.p1.3.m3.2.2.2.2.2" xref="S6.SS1.p1.3.m3.2.2.2.2.2.cmml"><mi id="S6.SS1.p1.3.m3.2.2.2.2.2.2" mathvariant="normal" xref="S6.SS1.p1.3.m3.2.2.2.2.2.2.cmml">#</mi><mo id="S6.SS1.p1.3.m3.2.2.2.2.2.1" xref="S6.SS1.p1.3.m3.2.2.2.2.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.3.m3.2.2.2.2.2.3" xref="S6.SS1.p1.3.m3.2.2.2.2.2.3.cmml">𝐓</mi></mrow><mo id="S6.SS1.p1.3.m3.2.2.2.2.1" xref="S6.SS1.p1.3.m3.2.2.2.2.1.cmml">=</mo><mn id="S6.SS1.p1.3.m3.2.2.2.2.3" xref="S6.SS1.p1.3.m3.2.2.2.2.3.cmml">100</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.3.m3.2b"><apply id="S6.SS1.p1.3.m3.2.2.3.cmml" xref="S6.SS1.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.p1.3.m3.2.2.3a.cmml" xref="S6.SS1.p1.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S6.SS1.p1.3.m3.1.1.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1.1.1"><eq id="S6.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1.1.1.1"></eq><apply id="S6.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="S6.SS1.p1.3.m3.1.1.1.1.2"><times id="S6.SS1.p1.3.m3.1.1.1.1.2.1.cmml" xref="S6.SS1.p1.3.m3.1.1.1.1.2.1"></times><ci id="S6.SS1.p1.3.m3.1.1.1.1.2.2.cmml" xref="S6.SS1.p1.3.m3.1.1.1.1.2.2">#</ci><ci id="S6.SS1.p1.3.m3.1.1.1.1.2.3.cmml" xref="S6.SS1.p1.3.m3.1.1.1.1.2.3">𝐂</ci></apply><cn id="S6.SS1.p1.3.m3.1.1.1.1.3.cmml" type="integer" xref="S6.SS1.p1.3.m3.1.1.1.1.3">100</cn></apply><apply id="S6.SS1.p1.3.m3.2.2.2.2.cmml" xref="S6.SS1.p1.3.m3.2.2.2.2"><eq id="S6.SS1.p1.3.m3.2.2.2.2.1.cmml" xref="S6.SS1.p1.3.m3.2.2.2.2.1"></eq><apply id="S6.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S6.SS1.p1.3.m3.2.2.2.2.2"><times id="S6.SS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S6.SS1.p1.3.m3.2.2.2.2.2.1"></times><ci id="S6.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S6.SS1.p1.3.m3.2.2.2.2.2.2">#</ci><ci id="S6.SS1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S6.SS1.p1.3.m3.2.2.2.2.2.3">𝐓</ci></apply><cn id="S6.SS1.p1.3.m3.2.2.2.2.3.cmml" type="integer" xref="S6.SS1.p1.3.m3.2.2.2.2.3">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.3.m3.2c">\mathbf{\#C}=100,\mathbf{\#T}=100</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.3.m3.2d"># bold_C = 100 , # bold_T = 100</annotation></semantics></math>; <math alttext="\mathbf{\#C}=100,\mathbf{\#T}=500" class="ltx_Math" display="inline" id="S6.SS1.p1.4.m4.2"><semantics id="S6.SS1.p1.4.m4.2a"><mrow id="S6.SS1.p1.4.m4.2.2.2" xref="S6.SS1.p1.4.m4.2.2.3.cmml"><mrow id="S6.SS1.p1.4.m4.1.1.1.1" xref="S6.SS1.p1.4.m4.1.1.1.1.cmml"><mrow id="S6.SS1.p1.4.m4.1.1.1.1.2" xref="S6.SS1.p1.4.m4.1.1.1.1.2.cmml"><mi id="S6.SS1.p1.4.m4.1.1.1.1.2.2" mathvariant="normal" xref="S6.SS1.p1.4.m4.1.1.1.1.2.2.cmml">#</mi><mo id="S6.SS1.p1.4.m4.1.1.1.1.2.1" xref="S6.SS1.p1.4.m4.1.1.1.1.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.4.m4.1.1.1.1.2.3" xref="S6.SS1.p1.4.m4.1.1.1.1.2.3.cmml">𝐂</mi></mrow><mo id="S6.SS1.p1.4.m4.1.1.1.1.1" xref="S6.SS1.p1.4.m4.1.1.1.1.1.cmml">=</mo><mn id="S6.SS1.p1.4.m4.1.1.1.1.3" xref="S6.SS1.p1.4.m4.1.1.1.1.3.cmml">100</mn></mrow><mo id="S6.SS1.p1.4.m4.2.2.2.3" xref="S6.SS1.p1.4.m4.2.2.3a.cmml">,</mo><mrow id="S6.SS1.p1.4.m4.2.2.2.2" xref="S6.SS1.p1.4.m4.2.2.2.2.cmml"><mrow id="S6.SS1.p1.4.m4.2.2.2.2.2" xref="S6.SS1.p1.4.m4.2.2.2.2.2.cmml"><mi id="S6.SS1.p1.4.m4.2.2.2.2.2.2" mathvariant="normal" xref="S6.SS1.p1.4.m4.2.2.2.2.2.2.cmml">#</mi><mo id="S6.SS1.p1.4.m4.2.2.2.2.2.1" xref="S6.SS1.p1.4.m4.2.2.2.2.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.4.m4.2.2.2.2.2.3" xref="S6.SS1.p1.4.m4.2.2.2.2.2.3.cmml">𝐓</mi></mrow><mo id="S6.SS1.p1.4.m4.2.2.2.2.1" xref="S6.SS1.p1.4.m4.2.2.2.2.1.cmml">=</mo><mn id="S6.SS1.p1.4.m4.2.2.2.2.3" xref="S6.SS1.p1.4.m4.2.2.2.2.3.cmml">500</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.4.m4.2b"><apply id="S6.SS1.p1.4.m4.2.2.3.cmml" xref="S6.SS1.p1.4.m4.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.p1.4.m4.2.2.3a.cmml" xref="S6.SS1.p1.4.m4.2.2.2.3">formulae-sequence</csymbol><apply id="S6.SS1.p1.4.m4.1.1.1.1.cmml" xref="S6.SS1.p1.4.m4.1.1.1.1"><eq id="S6.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S6.SS1.p1.4.m4.1.1.1.1.1"></eq><apply id="S6.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S6.SS1.p1.4.m4.1.1.1.1.2"><times id="S6.SS1.p1.4.m4.1.1.1.1.2.1.cmml" xref="S6.SS1.p1.4.m4.1.1.1.1.2.1"></times><ci id="S6.SS1.p1.4.m4.1.1.1.1.2.2.cmml" xref="S6.SS1.p1.4.m4.1.1.1.1.2.2">#</ci><ci id="S6.SS1.p1.4.m4.1.1.1.1.2.3.cmml" xref="S6.SS1.p1.4.m4.1.1.1.1.2.3">𝐂</ci></apply><cn id="S6.SS1.p1.4.m4.1.1.1.1.3.cmml" type="integer" xref="S6.SS1.p1.4.m4.1.1.1.1.3">100</cn></apply><apply id="S6.SS1.p1.4.m4.2.2.2.2.cmml" xref="S6.SS1.p1.4.m4.2.2.2.2"><eq id="S6.SS1.p1.4.m4.2.2.2.2.1.cmml" xref="S6.SS1.p1.4.m4.2.2.2.2.1"></eq><apply id="S6.SS1.p1.4.m4.2.2.2.2.2.cmml" xref="S6.SS1.p1.4.m4.2.2.2.2.2"><times id="S6.SS1.p1.4.m4.2.2.2.2.2.1.cmml" xref="S6.SS1.p1.4.m4.2.2.2.2.2.1"></times><ci id="S6.SS1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S6.SS1.p1.4.m4.2.2.2.2.2.2">#</ci><ci id="S6.SS1.p1.4.m4.2.2.2.2.2.3.cmml" xref="S6.SS1.p1.4.m4.2.2.2.2.2.3">𝐓</ci></apply><cn id="S6.SS1.p1.4.m4.2.2.2.2.3.cmml" type="integer" xref="S6.SS1.p1.4.m4.2.2.2.2.3">500</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.4.m4.2c">\mathbf{\#C}=100,\mathbf{\#T}=500</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.4.m4.2d"># bold_C = 100 , # bold_T = 500</annotation></semantics></math>; <math alttext="\mathbf{\#C}=500,\mathbf{\#T}=100" class="ltx_Math" display="inline" id="S6.SS1.p1.5.m5.2"><semantics id="S6.SS1.p1.5.m5.2a"><mrow id="S6.SS1.p1.5.m5.2.2.2" xref="S6.SS1.p1.5.m5.2.2.3.cmml"><mrow id="S6.SS1.p1.5.m5.1.1.1.1" xref="S6.SS1.p1.5.m5.1.1.1.1.cmml"><mrow id="S6.SS1.p1.5.m5.1.1.1.1.2" xref="S6.SS1.p1.5.m5.1.1.1.1.2.cmml"><mi id="S6.SS1.p1.5.m5.1.1.1.1.2.2" mathvariant="normal" xref="S6.SS1.p1.5.m5.1.1.1.1.2.2.cmml">#</mi><mo id="S6.SS1.p1.5.m5.1.1.1.1.2.1" xref="S6.SS1.p1.5.m5.1.1.1.1.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.5.m5.1.1.1.1.2.3" xref="S6.SS1.p1.5.m5.1.1.1.1.2.3.cmml">𝐂</mi></mrow><mo id="S6.SS1.p1.5.m5.1.1.1.1.1" xref="S6.SS1.p1.5.m5.1.1.1.1.1.cmml">=</mo><mn id="S6.SS1.p1.5.m5.1.1.1.1.3" xref="S6.SS1.p1.5.m5.1.1.1.1.3.cmml">500</mn></mrow><mo id="S6.SS1.p1.5.m5.2.2.2.3" xref="S6.SS1.p1.5.m5.2.2.3a.cmml">,</mo><mrow id="S6.SS1.p1.5.m5.2.2.2.2" xref="S6.SS1.p1.5.m5.2.2.2.2.cmml"><mrow id="S6.SS1.p1.5.m5.2.2.2.2.2" xref="S6.SS1.p1.5.m5.2.2.2.2.2.cmml"><mi id="S6.SS1.p1.5.m5.2.2.2.2.2.2" mathvariant="normal" xref="S6.SS1.p1.5.m5.2.2.2.2.2.2.cmml">#</mi><mo id="S6.SS1.p1.5.m5.2.2.2.2.2.1" xref="S6.SS1.p1.5.m5.2.2.2.2.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.5.m5.2.2.2.2.2.3" xref="S6.SS1.p1.5.m5.2.2.2.2.2.3.cmml">𝐓</mi></mrow><mo id="S6.SS1.p1.5.m5.2.2.2.2.1" xref="S6.SS1.p1.5.m5.2.2.2.2.1.cmml">=</mo><mn id="S6.SS1.p1.5.m5.2.2.2.2.3" xref="S6.SS1.p1.5.m5.2.2.2.2.3.cmml">100</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.5.m5.2b"><apply id="S6.SS1.p1.5.m5.2.2.3.cmml" xref="S6.SS1.p1.5.m5.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.p1.5.m5.2.2.3a.cmml" xref="S6.SS1.p1.5.m5.2.2.2.3">formulae-sequence</csymbol><apply id="S6.SS1.p1.5.m5.1.1.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1"><eq id="S6.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1"></eq><apply id="S6.SS1.p1.5.m5.1.1.1.1.2.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.2"><times id="S6.SS1.p1.5.m5.1.1.1.1.2.1.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.2.1"></times><ci id="S6.SS1.p1.5.m5.1.1.1.1.2.2.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.2.2">#</ci><ci id="S6.SS1.p1.5.m5.1.1.1.1.2.3.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.2.3">𝐂</ci></apply><cn id="S6.SS1.p1.5.m5.1.1.1.1.3.cmml" type="integer" xref="S6.SS1.p1.5.m5.1.1.1.1.3">500</cn></apply><apply id="S6.SS1.p1.5.m5.2.2.2.2.cmml" xref="S6.SS1.p1.5.m5.2.2.2.2"><eq id="S6.SS1.p1.5.m5.2.2.2.2.1.cmml" xref="S6.SS1.p1.5.m5.2.2.2.2.1"></eq><apply id="S6.SS1.p1.5.m5.2.2.2.2.2.cmml" xref="S6.SS1.p1.5.m5.2.2.2.2.2"><times id="S6.SS1.p1.5.m5.2.2.2.2.2.1.cmml" xref="S6.SS1.p1.5.m5.2.2.2.2.2.1"></times><ci id="S6.SS1.p1.5.m5.2.2.2.2.2.2.cmml" xref="S6.SS1.p1.5.m5.2.2.2.2.2.2">#</ci><ci id="S6.SS1.p1.5.m5.2.2.2.2.2.3.cmml" xref="S6.SS1.p1.5.m5.2.2.2.2.2.3">𝐓</ci></apply><cn id="S6.SS1.p1.5.m5.2.2.2.2.3.cmml" type="integer" xref="S6.SS1.p1.5.m5.2.2.2.2.3">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.5.m5.2c">\mathbf{\#C}=500,\mathbf{\#T}=100</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.5.m5.2d"># bold_C = 500 , # bold_T = 100</annotation></semantics></math> and freeze other hyperparameters respectively. In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.T6" title="Table 6 ‣ BSR ‣ 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">6</span></a>, generally, with more candidates and training samples, our approach will select better examples for the demonstration. With 100 candidates and 100 training samples, our approach beats random selection by about 2.0 ROUGE score, 2.5 BLEU score and 2.0 F-score. It is also comparable to the competitive baseline BSR with 500 candidates and training samples. It shows the efficiency to utilize direct LLM feedback to train the LM retriever.
Compared with setting 100-500, our approach outperforms by about 0.7 ROUGE score, 0.8 BLEU score and 0.9 F-score. It demonstrates our ability to select better examples to improve the analogy ability of LLM With more candidates.
Compared with setting 500-100, our approach outperforms by about 1.4 ROUGE score, 1.9 BLEU score and 0.2 F-score. It shows more training samples improve the selection of our approach from the candidate set for IUR task.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Different Number of Examples in Demonstration</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4.T4" title="Table 4 ‣ 4.3 Policy Iterating ‣ 4 Methodology ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">4</span></a>, we conduct the experiments with 5-shot demonstrations. In this part, we do further experiments with 3-shot and 4-shot demonstrations. In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.T7" title="Table 7 ‣ BSR ‣ 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">7</span></a>, generally with more examples in the demonstration, our approach improves the ICL performance of LLM for IUR task. Especially, with more demonstration examples, our approach derives more improvement compared with the competitive baseline EPR. It demonstrates the efficiency of our RLS by directly utilizing LLM feedback to train the LM retriever and improve the ICL performance of LLM.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Comparing with SFT Model</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">In this part, we compare our approach with the existing state-of-the-art QUEEN <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib18" title="">2020</a>)</cite> in IUR field. QUEEN tackles IUR task by finetuning PTM <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib4" title="">2018</a>)</cite> and constructing the word edit matrix. Different from QUEEN , our approach utilizes LM as a proxy to select appropriate examples and parameters of the answer generator ChatGLM are fixed. To keep a fair comparison, we assign the candidate set and training set in our approach as the training set of QUEEN.
In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.T8" title="Table 8 ‣ BSR ‣ 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">8</span></a>, our approach QUEEN by 9.2 F1 score, 7.3 F2 score and 4.9 F3 score. F-score concentrate on the words from the context, which are argued to be harder to copy <cite class="ltx_cite ltx_citemacro_cite">Pan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib19" title="">2019</a>)</cite>. It shows our efficiency to capture important words from the context to rewrite the incomplete utterance. Considering our RLS approach does not depend on the LLM server (ChatGLM in our experiments), it is promising for our approach to derive better results for IUR task with stronger LLM.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>What Examples are Appropriate for IUR</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">In this part, we explore the reason why examples selected by our approach serve as better demonstrations for the LLM to solve IUR task.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">We assume that other than the textual and semantic similarity of examples with the current test case, the complexity and abundance of examples in the demonstrations also matter for IUR task.
We evaluate the complexity and abundance of examples by three metrics of incomplete utterance and rewritten utterance: 1. the length of utterance; 2. the number of Part Of Speech (POS) tagging types <cite class="ltx_cite ltx_citemacro_cite">Kumawat and Jain (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib13" title="">2015</a>)</cite>. 3. the number of text chunks <cite class="ltx_cite ltx_citemacro_cite">Ramshaw and Marcus (<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#bib.bib22" title="">1999</a>)</cite>. We assume the examples are more complex and abundant with longer utterances, more POS tag types and more text chunks. In practice, we adopt SpaCy to do POS tagging and text chunking.
In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.T9" title="Table 9 ‣ BSR ‣ 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">9</span></a>, the examples selected by our policy-based RL framework have longer utterances, more POS types and more text chunks though without explicit assignment, We argue that the complexity and abundance of examples in the demonstration are important to improve the analogy ability of LLM.</p>
</div>
<div class="ltx_para" id="S6.SS4.p3">
<p class="ltx_p" id="S6.SS4.p3.1">What if we select the examples only by metrics of complexity and abundance?
To address this issue, we select examples from the candidate set to construct the demonstration by metrics of the length of utterance, the number of POS types, the number of text chunks respectively and conduct the experiments on CANARD dataset.
In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.T10" title="Table 10 ‣ BSR ‣ 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">10</span></a>, if selecting the examples only by the metric of number of text chunks, the ICL results will drop by about 2.1 ROUGE score, 0.9 BLEU score, 2.9 F-score on CANARD dataset. It will drop more if selecting the examples only by the metric of utterance length or POS types. It shows only selecting examples by complexity and abundance, the LLM performance will not necessarily improve. Balancing the abundance and the similarity with the test case of examples is important to improve the ICL ability of LLM. Our approach attains the balance of complexity and abundance, as well as semantic similarity with the test case without explicit assignment.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5 </span>Efficiency of Larger LLM</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">In this part, we conduct the experiments by applying our approach with gpt3.5 in TASK dataset. In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.T11" title="Table 11 ‣ BSR ‣ 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">11</span></a>, our RLS outperforms random selecting examples by about 4.4 ROUGE score, 9.5 BLEU score and 9.4 F-score in TASK dataset. It demonstrates the efficiency of directly utilizing LLM feedback to train the LM retriever with policy-based RL and improve the analogy ability of larger LLM. With the emergence of larger LLM, it is promising for our approach to select appropriate examples to improve the ICL performance of LLM.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.6 </span>Order of Examples</h3>
<div class="ltx_para" id="S6.SS6.p1">
<p class="ltx_p" id="S6.SS6.p1.1">In this part, we probe the effect of the order of examples in the demonstration. We arrange examples in the demonstration by the order of sampling with Eq.<a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S4.E3" title="In 4.2 Scoring Policy ‣ 4 Methodology ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">3</span></a> or the reverse order and conduct the experiments on TASK dataset. Table <a class="ltx_ref" href="https://arxiv.org/html/2408.13028v1#S5.T12" title="Table 12 ‣ BSR ‣ 5.3 Baselines ‣ 5 Experiments ‣ In-Context Learning with Reinforcement Learning for Incomplete Utterance Rewriting"><span class="ltx_text ltx_ref_tag">12</span></a> shows if arranging the examples by the reverse order of sampling, our approach shows comparable performance . It demonstrates the stable efficiency of our directly selecting the examples that can improve the analogy ability of LLM by policy gradient.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">Existing example selection methods fail to directly utilize the LLM feedback to choose appropriate examples in the demonstration. We propose a novel and effective example selection framework by directly adopting the LLM feedback to train the LM selector with policy-based RL. Our approach significantly improves the ICL performance of LLM for IUR tasks.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Limitations</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">we propose our novel and effective example selection framework by directly adopting the LLM feedback to train the LM selector with policy-based RL and demonstrate our efficiency on three benchmark datasets in this field. Though only utilizing the LLM ChatGLM-7B and gpt3.5, we will conduct experiments with diverse kinds of LLMs in future research.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. 2020.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in neural information processing systems</em>, 33:1877–1901.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al. (2018)</span>
<span class="ltx_bibblock">
Eunsol Choi, He He, Mohit Iyyer, Mark Yatskar, Wen-tau Yih, Yejin Choi, Percy Liang, and Luke Zettlemoyer. 2018.

</span>
<span class="ltx_bibblock">Quac: Question answering in context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:1808.07036</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhery et al. (2022)</span>
<span class="ltx_bibblock">
Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, Hyung Won Chung, Charles Sutton, Sebastian Gehrmann, et al. 2022.

</span>
<span class="ltx_bibblock">Palm: Scaling language modeling with pathways.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2204.02311</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2018.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:1810.04805</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2022)</span>
<span class="ltx_bibblock">
Qingxiu Dong, Lei Li, Damai Dai, Ce Zheng, Zhiyong Wu, Baobao Chang, Xu Sun, Jingjing Xu, and Zhifang Sui. 2022.

</span>
<span class="ltx_bibblock">A survey for in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2301.00234</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elgohary et al. (2019)</span>
<span class="ltx_bibblock">
Ahmed Elgohary, Denis Peskov, and Jordan Boyd-Graber. 2019.

</span>
<span class="ltx_bibblock">Can you unpack that? learning to rewrite questions-in-context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Can You Unpack That? Learning to Rewrite Questions-in-Context</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gonen et al. (2022)</span>
<span class="ltx_bibblock">
Hila Gonen, Srini Iyer, Terra Blevins, Noah A Smith, and Luke Zettlemoyer. 2022.

</span>
<span class="ltx_bibblock">Demystifying prompts in language models via perplexity estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2212.04037</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. (2023)</span>
<span class="ltx_bibblock">
Shivanshu Gupta, Sameer Singh, and Matt Gardner. 2023.

</span>
<span class="ltx_bibblock">Coverage-based example selection for in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2305.14907</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao et al. (2021)</span>
<span class="ltx_bibblock">
Jie Hao, Linfeng Song, Liwei Wang, Kun Xu, Zhaopeng Tu, and Dong Yu. 2021.

</span>
<span class="ltx_bibblock">Rast: Domain-robust dialogue rewriting as sequence tagging.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 4913–4924.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2021)</span>
<span class="ltx_bibblock">
Mengzuo Huang, Feng Li, Wuhe Zou, and Weidong Zhang. 2021.

</span>
<span class="ltx_bibblock">Sarg: A novel semi autoregressive generator for multi-turn incomplete utterance restoration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 35, pages 13055–13063.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Inoue et al. (2022)</span>
<span class="ltx_bibblock">
Shumpei Inoue, Tsungwei Liu, Nguyen Hong Son, and Minh-Tien Nguyen. 2022.

</span>
<span class="ltx_bibblock">Enhance incomplete utterance restoration by joint learning token extraction and text generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2204.03958</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2022)</span>
<span class="ltx_bibblock">
Hyuhng Joon Kim, Hyunsoo Cho, Junyeob Kim, Taeuk Kim, Kang Min Yoo, and Sang-goo Lee. 2022.

</span>
<span class="ltx_bibblock">Self-generated in-context learning: Leveraging auto-regressive language models as a demonstration generator.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2206.08082</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumawat and Jain (2015)</span>
<span class="ltx_bibblock">
Deepika Kumawat and Vinesh Jain. 2015.

</span>
<span class="ltx_bibblock">Pos tagging approaches: A comparison.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">International Journal of Computer Applications</em>, 118(6).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levy et al. (2022)</span>
<span class="ltx_bibblock">
Itay Levy, Ben Bogin, and Jonathan Berant. 2022.

</span>
<span class="ltx_bibblock">Diverse demonstrations improve in-context compositional generalization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2212.06800</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin (2004)</span>
<span class="ltx_bibblock">
Chin-Yew Lin. 2004.

</span>
<span class="ltx_bibblock">Rouge: A package for automatic evaluation of summaries.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Text summarization branches out</em>, pages 74–81.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022)</span>
<span class="ltx_bibblock">
Haokun Liu, Derek Tam, Mohammed Muqeeth, Jay Mohta, Tenghao Huang, Mohit Bansal, and Colin A Raffel. 2022.

</span>
<span class="ltx_bibblock">Few-shot parameter-efficient fine-tuning is better and cheaper than in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Advances in Neural Information Processing Systems</em>, 35:1950–1965.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Jiachang Liu, Dinghan Shen, Yizhe Zhang, Bill Dolan, Lawrence Carin, and Weizhu Chen. 2021.

</span>
<span class="ltx_bibblock">What makes good in-context examples for gpt-<math alttext="3" class="ltx_Math" display="inline" id="bib.bib17.1.m1.1"><semantics id="bib.bib17.1.m1.1a"><mn id="bib.bib17.1.m1.1.1" xref="bib.bib17.1.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="bib.bib17.1.m1.1b"><cn id="bib.bib17.1.m1.1.1.cmml" type="integer" xref="bib.bib17.1.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="bib.bib17.1.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="bib.bib17.1.m1.1d">3</annotation></semantics></math>?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.2.1">arXiv preprint arXiv:2101.06804</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Qian Liu, Bei Chen, Jian-Guang Lou, Bin Zhou, and Dongmei Zhang. 2020.

</span>
<span class="ltx_bibblock">Incomplete utterance rewriting as semantic segmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2009.13166</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. (2019)</span>
<span class="ltx_bibblock">
Zhufeng Pan, Kun Bai, Yan Wang, Lianqiang Zhou, and Xiaojiang Liu. 2019.

</span>
<span class="ltx_bibblock">Improving open-domain dialogue systems via multi-turn incomplete utterance restoration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pages 1824–1833.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Papineni et al. (2002)</span>
<span class="ltx_bibblock">
Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing Zhu. 2002.

</span>
<span class="ltx_bibblock">Bleu: a method for automatic evaluation of machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 40th annual meeting of the Association for Computational Linguistics</em>, pages 311–318.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quan et al. (2019)</span>
<span class="ltx_bibblock">
Jun Quan, Deyi Xiong, Bonnie Webber, and Changjian Hu. 2019.

</span>
<span class="ltx_bibblock">Gecor: An end-to-end generative ellipsis and co-reference resolution model for task-oriented dialogue.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:1909.12086</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramshaw and Marcus (1999)</span>
<span class="ltx_bibblock">
Lance A Ramshaw and Mitchell P Marcus. 1999.

</span>
<span class="ltx_bibblock">Text chunking using transformation-based learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Natural language processing using very large corpora</em>, pages 157–176.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddy et al. (2019)</span>
<span class="ltx_bibblock">
Siva Reddy, Danqi Chen, and Christopher D Manning. 2019.

</span>
<span class="ltx_bibblock">Coqa: A conversational question answering challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Transactions of the Association for Computational Linguistics</em>, 7:249–266.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reimers and Gurevych (2019)</span>
<span class="ltx_bibblock">
Nils Reimers and Iryna Gurevych. 2019.

</span>
<span class="ltx_bibblock">Sentence-bert: Sentence embeddings using siamese bert-networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:1908.10084</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robertson et al. (2009)</span>
<span class="ltx_bibblock">
Stephen Robertson, Hugo Zaragoza, et al. 2009.

</span>
<span class="ltx_bibblock">The probabilistic relevance framework: Bm25 and beyond.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Foundations and Trends® in Information Retrieval</em>, 3(4):333–389.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rubin et al. (2021)</span>
<span class="ltx_bibblock">
Ohad Rubin, Jonathan Herzig, and Jonathan Berant. 2021.

</span>
<span class="ltx_bibblock">Learning to retrieve prompts for in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2112.08633</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sorensen et al. (2022)</span>
<span class="ltx_bibblock">
Taylor Sorensen, Joshua Robinson, Christopher Michael Rytting, Alexander Glenn Shaw, Kyle Jeffrey Rogers, Alexia Pauline Delorey, Mahmoud Khalil, Nancy Fulda, and David Wingate. 2022.

</span>
<span class="ltx_bibblock">An information-theoretic approach to prompt engineering without ground truth labels.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2203.11364</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2019)</span>
<span class="ltx_bibblock">
Hui Su, Xiaoyu Shen, Rongzhi Zhang, Fei Sun, Pengwei Hu, Cheng Niu, and Jie Zhou. 2019.

</span>
<span class="ltx_bibblock">Improving multi-turn dialogue modelling with utterance rewriter.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:1906.07004</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Kai Sun, Dian Yu, Jianshu Chen, Dong Yu, Yejin Choi, and Claire Cardie. 2019.

</span>
<span class="ltx_bibblock">Dream: A challenge data set and models for dialogue-based reading comprehension.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Transactions of the Association for Computational Linguistics</em>, 7:217–231.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al. 2023.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2302.13971</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vasiliev (2020)</span>
<span class="ltx_bibblock">
Yuli Vasiliev. 2020.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Natural language processing with Python and spaCy: A practical introduction</em>.

</span>
<span class="ltx_bibblock">No Starch Press.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Yong Zhang, Zhitao Li, Jianzong Wang, Ning Cheng, and Jing Xiao. 2022.

</span>
<span class="ltx_bibblock">Self-attention for incomplete utterance rewriting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">ICASSP 2022-2022 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, pages 8047–8051. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2021)</span>
<span class="ltx_bibblock">
Zihao Zhao, Eric Wallace, Shi Feng, Dan Klein, and Sameer Singh. 2021.

</span>
<span class="ltx_bibblock">Calibrate before use: Improving few-shot performance of language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">International Conference on Machine Learning</em>, pages 12697–12706. PMLR.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Example Appendix</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">This is an appendix.</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Aug 23 12:32:17 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
